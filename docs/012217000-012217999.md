# StackOverflow 问答 12217000-12217999

# jquery - jQuery：无法获取 div 的内容

> ID：12217001
> 
> 赞同：0
> 
> 时间：2012-08-31T14:05:02.583
> 
> 标签：jquery, ajax, get

我有一个 div，其中包含从使用 AJAX 的文件加载的文本。当页面加载并且内容也加载时，我想提醒 divs 内容。我不工作。

```
var cnt = $('#htmlmsg2').get(); 
var page = $('#htmlmsg').text();
alert(+cnt+'\n'+page); 
```

我还有另一个 div 也有动态内容，但它不是从文件中加载的。警报的这部分工作完美。

我尝试了 .get,.html,.text (!) 函数，但没有任何效果。

我也尝试将文本加载到另一个 div，并尝试达到该目标，但失败了：我以后无法从任何 div 访问加载的内容。它总是给我'NaN'。

有任何想法吗？

身体是这样的：

```
<div id="htmlmsg"></div>
<div id="container">
<div id="header"></div>
<div id="bodycontainer"><div id="htmlmsg2">loaded text from ajax, wich can not be reached somehow</div>
</div> 
```

```
$.ajax({
  url: "pages/start.php",
  contentType:'application/x-www-form-urlencoded; charset=UTF-8',
  cache: false
}).done(function( html ) {

  $("#webtext").append(html);
  $("#htmlmsg2").html(html);
}); 
```

这就是我加载内容的方式。（这很好用！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:12:45.607

实际上，AJAX $.get() 的工作方式不同：

```
$.get(
    url: 'mypage.html',
    params: { key1: 'hello', key2: 'world' },
    success: (data) {
        $('#mydiv').html(data);
        alert(data);
    }
); 
```

如果您只想加载页面：

```
$('#mydiv').load('mypage.html', function() {
    alert('It works!');
});

$('#mydiv').load('mypage.html'); 
```

**更新：**

它可能无法获取 div 的内容，因为 AJAX 发生在 DOM 加载之后，因此您需要在`success`块内添加代码。

# jquery - 使函数适用于使用 ajax 动态添加的元素

> ID：12217006
> 
> 赞同：0
> 
> 时间：2012-08-31T14:05:14.803
> 
> 标签：jquery, jquery-plugins, jquery-selectors

如何使 jquery 函数适用于首次运行后添加的元素，但不适用于动态添加的元素。

代码：

```
jQuery(function() {
   jQuery.support.placeholder = false;
   test = document.createElement('input');
   if('placeholder' in test) jQuery.support.placeholder = true;
});

$(function() {
   var active = document.activeElement;
   if(!$.support.placeholder) { 
      $(':text').focus(function () {
         if ($(this).attr('placeholder') != '' && $(this).val() == $(this).attr('placeholder')) {
            $(this).val('');
            if($(this).hasClass("dcphc")===true){$(this).removeClass('dcph');}
            else if($(this).hasClass("dcphmgc")===true){$(this).removeClass('dcphmg');}
            else if($(this).hasClass("dcphlgc")===true){$(this).removeClass('dcphlg');}
         }
      }).blur(function () {
         if ($(this).attr('placeholder') != '' && ($(this).val() == '' || $(this).val() == $(this).attr('placeholder'))) {
            $(this).val($(this).attr('placeholder'));
            if($(this).hasClass("dcphc")===true){$(this).addClass('dcph');}
            else if($(this).hasClass("dcphmgc")===true){$(this).addClass('dcphmg');}
            else if($(this).hasClass("dcphlgc")===true){$(this).addClass('dcphlg');}
         }
      });
      }
      else{
        $(':text').blur(function () {
         if ($(this).attr('placeholder') != '' && ($(this).val() == '' || $(this).val() == $(this).attr('placeholder'))) {
            $(this).val("");
         }
      }); 
      }
      $(':text').blur();
      $(active).focus();
});

function ref_dcph(w){
      var active = document.activeElement;
      if(!$.support.placeholder) { 
      $(w).focus(function () {
         if ($(this).attr('placeholder') != '' && $(this).val() == $(this).attr('placeholder')) {
            $(this).val('');
            if($(this).hasClass("dcphc")===true){$(this).removeClass('dcph');}
            else if($(this).hasClass("dcphmgc")===true){$(this).removeClass('dcphmg');}
            else if($(this).hasClass("dcphlgc")===true){$(this).removeClass('dcphlg');}
         }
      }).blur(function () {
         if ($(this).attr('placeholder') != '' && ($(this).val() == '' || $(this).val() == $(this).attr('placeholder'))) {
            $(this).val($(this).attr('placeholder'));
            if($(this).hasClass("dcphc")===true){$(this).addClass('dcph');}
            else if($(this).hasClass("dcphmgc")===true){$(this).addClass('dcphmg');}
            else if($(this).hasClass("dcphlgc")===true){$(this).addClass('dcphlg');}
         }
      });
      }
      else{
        $(w).blur(function () {
         if ($(this).attr('placeholder') != '' && ($(this).val() == '' || $(this).val() == $(this).attr('placeholder'))) {
            $(this).val("");
         }
      }); 
      }
      $(w).blur();
      $(active).focus();
} 
```

第一个函数起作用，第二个 ref_dcph （参考 dom 控制占位符）是第一个函数的副本，但我每次添加具有特定标识符的新元素时都使用它，而不是输入或 textarea 以便我不必须对已附加该功能的项目进行解除绑定。

我需要对第一个进行修改，以便它也可以在新的动态元素上运行，我不明白如何使用“on”。

- 此外，从 dom 中删除并再次添加的元素会发生什么（具有相同的 id - 也是相同的元素） - 如果你想做 $(elem).click(功能（）{}）; 你必须通过 unbind - 否则点击加倍。

我想知道如何进行第一次扭曲，并检查之前的 focus() 或 blur() 是否附加到被检测为动态生成的同一元素，如果是这种情况，则不要再次附加 focus() 和模糊（）。因为我在页面上有从 dom 中删除然后再次添加的元素，这些元素涉及输入或带有占位符的文本区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:37:14.280

```
 $("body").on("blur", ":text", function(event){}); 
```

# ios - 本地通知是否可以跟踪特定地点的 GPS（纬度和经度）？

> ID：12217007
> 
> 赞同：0
> 
> 时间：2012-08-31T14:05:26.073
> 
> 标签：ios, mkmapview, cllocationmanager, uilocalnotification

使用 LocalNotification 我们可以追踪特定的位置，当我们进入该区域时，我应该得到通知吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:51:53.887

这可以通过使用 iOS 4.0 以来内置的区域监控来完成。

```
[locationController startMonitoringForRegion:region]; 
```

这将触发两种方法之一，具体取决于您是进入还是退出该区域。

```
-didEnterRegion
-didExitRegion 
```

从这里，您可以触发警报（如果在前台）或本地通知（如果在后台），并在通知中传递您想要的任何信息。

有很多教程可以帮助您完成设置。只需查找 CLLocationManager、CLRegion 以及与它们关联的区域监控方法。很简单的。

# google-app-engine - Google App Engine 中的实体可以具有相同的键名吗？

> ID：12217013
> 
> 赞同：2
> 
> 时间：2012-08-31T14:05:50.707
> 
> 标签：google-app-engine

我有一个名为 MyModel 的模型，我像这样创建它

```
x = MyModel(key_name = 'hello', parent = parentKey) 
```

问题是，是否可以拥有另一个具有相同键名但父级不同的实体？

```
z = MyModel(key_name = 'hello', parent = differentParentKey) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:17:46.100

是的，这完全没问题，您也可以考虑使用[get_or_insert()](https://developers.google.com/appengine/docs/python/datastore/modelclass#Model_get_or_insert)。但是，只要父母不同，这两种情况都不会成为问题。

# c - 进入do while循环

> ID：12217014
> 
> 赞同：12
> 
> 时间：2012-08-31T14:05:51.553
> 
> 标签：c, loops, nested-loops

打破嵌套循环会发生什么？

假设以下代码：

```
for(int x = 0; x < 10; x++)
{
    do {
        if(x == 4)
            break;
        x++;
    } while(x != 1);
} 
```

遇到 break 语句、for 循环或 do while 循环时哪个循环会退出？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-31T14:06:56.310

总是打破最里面的`break`循环。

> 6.8.6.3
> 
> break 语句终止执行最小的封闭 switch 或**迭代**语句。

* * *

如果您想跳出两个循环，请在之后使用标签`for`并使用[goto 跳转](http://xkcd.com/292/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-31T14:16:31.997

或者，如果您不想使用，可以使用标志`goto`：

```
int flag = 0;

for(int x = 0; x < 10; x++)
{
    do {
        if(x == 4) {
            flag = 1;
            break;
        }
        x++;
    } while(x != 1);

if(flag) 
   break; // To break the for loop
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:08:16.153

Break 将杀死最近/最里面的包含中断的循环。在您的示例中，break 将终止 do-while，并且控制跳回到 for() 循环，并简单地启动 for() 的下一次迭代。

但是，由于您在 do() 和 for() 循环中都修改了 x，因此执行会有些不稳定。一旦外部 X 达到 5，您将产生一个无限循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:09:12.443

while 将中断，for 循环将继续运行。

# html - 不规则形状的 DOM 元素

> ID：12217016
> 
> 赞同：1
> 
> 时间：2012-08-31T14:05:54.793
> 
> 标签：html, css

如何用 HTML 或 CSS 制作它们？

例如： [http ://draw.to/D11KGJr](http://draw.to/D11KGJr)

我听说过 map 标签，但它似乎只生成一个不可见的可点击区域，您不能在其上应用 CSS 属性，如边框或背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:08:46.857

如果你在谈论那幅画：它是一个`canvas`元素。

请参阅此处获取教程：[https ://developer.mozilla.org/en-US/docs/Canvas_tutorial](https://developer.mozilla.org/en-US/docs/Canvas_tutorial)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:08:07.333

这是可能的 - 在限制范围内，并且仅在较新的浏览器上 - 使用 CSS3 技术。例如，请参阅这个[CSS3 Twitter Fail Whale](http://www.subcide.com/experiments/fail-whale/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:12:32.877

这使用了 canvas 元素。

规格： [http ://www.w3.org/TR/2011/WD-html5-20110525/the-canvas-element.html#the-canvas-element](http://www.w3.org/TR/2011/WD-html5-20110525/the-canvas-element.html#the-canvas-element)

基于一种特定浏览器实现的文档：[https ://developer.mozilla.org/en-US/docs/HTML/Canvas](https://developer.mozilla.org/en-US/docs/HTML/Canvas)

非正式文档：[http](http://diveintohtml5.info/canvas.html) ://diveintohtml5.info/canvas.html和[http://www.html5canvastutorials.com/](http://www.html5canvastutorials.com/)

对于非矩形元素还有其他方法，如果您可以详细说明您的具体要求，可能更适合您的实际需要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:54:30.837

除了像其他人建议的那样使用 CSS 3 技术外，您还可以在 HTML 文档中嵌入 SVG。

[jsFiddle](http://jsfiddle.net/sn3Z9/)

```
<!doctype html>
<html>
  <!-- <head> ... -->
  <body>
    Taken from <a href="http://commons.wikimedia.org/wiki/File:SVG_example7.svg?uselang=de">http://commons.wikimedia.org/wiki/File:SVG_example7.svg?uselang=de</a>, thanks to <a href="http://commons.wikimedia.org/wiki/User_talk:Sarang?uselang=de">Sarang</a>!
    <hr />
    <svg xmlns="http://www.w3.org/2000/svg" width="304" height="290">
      <path d="M2,111h300 l-242.7,176.3 92.7-285.3 92.7,285.3z" fill="#FB2" stroke="#B00" stroke-width="4" stroke-linejoin="round"/>
    </svg>
  </body>
</html> 
```

# php - 根据列名将查询拆分为多个数组

> ID：12217017
> 
> 赞同：2
> 
> 时间：2012-08-31T14:05:53.940
> 
> 标签：php, mysql, arrays, split, mysqli

我想运行一个查询，从数据库中获取所有数据，然后将数据拆分为每列的数组。有了这个我打算动态填充html。我对 php 不是很有经验，可以使用一些帮助来帮助我根据查询所在的列将查询放入多个数组中。

示例：对于列名，我想要一个数组`$itemName[]`，它将包含按升序排列的每个项目名称。然后对于图像列，我希望`$itemImage[]`每个图像/图像 url 以相同的顺序排列。

有了这个，我计划运行一个 for 循环，随着 x 的增加，它将遍历每个 diff 数组并从指定位置拉出。我的数据库中没有空值，所以我不需要担心。

感谢您在根据列名将查询写入多个数组时给我的任何帮助。

```
 $mPos = array(mPos1, mPos2, mPos3, mPos4);

    for (x=0; x<4; x++){

    echo "<div class="$mPos[x]"> <div class="$mPos[x] . '_1'">"$title[x]"</div><div class="$mPos1 . '_2'">"$image[x]"</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:13:02.643

以这种方式分开对我来说仍然没有意义，但你去吧。

由于您没有提供数据库/表结构，我将假设您的 db 表具有以下列：

```
itemId | itemName | itemImage | itemDescription 
```

在 PHP 中，您循环遍历结果行并填充您的数组，例如

```
foreach ( $result AS $row ) {
  $itemNames[$row->itemId] = $row->itemName;
  $itemImages[$row->itemId] = $row->itemImage;
  $itemDescriptions[$row->itemId] = $row->itemDescription;
} 
```

编辑：在问题被更新并且现在包括 HTML 输出之后，我建议这样的事情。

```
foreach ( $result AS $row ) {
  $items[$row->itemId] = array(
    'name' => $row->itemName,
    'image' => $row->itemImage,
    'description' => $row->itemDescription,
    'price' => $row->itemPrice,
    'link' => $row->itemLink,
  );
}
$x = 0;
while ($x<4) {
  $x++;
  $item = array_shift($items);
  echo '<div class="mPos'.$x.'"> 
    <div class="mPos'.$x.'_1">"'.$item['name'].'"</div>
    <div class="mPos'.$x.'_2">"'.$item['price'].'"</div>
    <div class="mPos'.$x.'_3"><a href="'.$item['link'].'">
      <img src="'.$item['image'].'" /></a>
    </div>
  </div>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:10:24.213

```
$sth = $dbh->prepare("SELECT itemName, itemImage FROM myTable");
$sth->execute();
$result = $sth->fetchAll();

$myArr = array();
foreach($result as $row){
    foreach($row as $colName => $colVal){
         $myArr[$colName][] => $colVal;
    }
}
echo '<pre>';
print_r($myArr);
echo '</pre>'; 
```

尽管我确实对您从设计角度实际处理此问题的方式存有疑虑。

# solr - 具有空格或多个单词的概念的同义词

> ID：12217024
> 
> 赞同：11
> 
> 时间：2012-08-31T14:06:22.083
> 
> 标签：solr

我不知道如何处理包含空格的同义词！我有以下配置：

SOLR 配置文件

```
<fieldType ... >
  <analyzer type="index">
    <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
            <filter class="solr.WordDelimiterFilterFactory" 
                            catenateWords="1" 
                            preserveOriginal="1"
                            splitOnCaseChange="1"
                            generateWordParts="1" 
                            generateNumberParts="1"         
                            catenateNumbers="1" 
                            catenateAll="1" 
                            />
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.EdgeNGramFilterFactory" minGramSize="2" maxGramSize="30" side="front"/>
  </analyzer>
  <analyzer type="query">    
    <charFilter class="solr.MappingCharFilterFactory" mapping="mapping-ISOLatin1Accent.txt"/>
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.LengthFilterFactory" min="2" max="70" />
    <filter class="solr.SynonymFilterFactory" synonyms="syn.txt" ignoreCase="true" expand="true"/>
    <filter class="solr.LowerCaseFilterFactory"/>
 </analyzer>
</fieldType> 
```

我的文件：syn.txt

```
st., st => saint
istambul => istanbul
airport, apt => aéroport
NYC => New York
pt., pt => port
brussels => bruxelles 
```

除同义词外，一切正常：

```
"NYC => New York" 
```

我做了一些研究，发现以下内容：

> 请记住，虽然 SynonymFilter 很乐意处理包含多个单词的同义词（即：“sea biscuit, sea biscit, seabiscuit”）
> 
> 处理此类同义词的推荐方法是在索引时扩展同义词。这是因为在查询时可能会出现两个潜在问题：
> 
> Lucene QueryParser 在将任何文本提供给分析器之前在空白处进行标记，因此如果一个人搜索单词 sea biscit，分析器将分别给出单词“sea”和“biscit”，并且不会知道它们匹配同义词.
> 
> 短语搜索（即：“sea biscit”）将导致 QueryParser 将整个字符串传递给分析器，但如果 SynonymFilter 配置为扩展同义词，那么当 QueryParser 从分析器获取返回的令牌结果列表时，它将构造一个不会产生预期效果的 MultiPhraseQuery。
> 
> 这是因为分析器可用于指示两个术语占据相同位置的机制有限：无法指示“短语”与术语占据相同位置。
> 
> 对于我们的示例，生成的 MultiPhraseQuery 将是“(sea | sea | seabiscuit) (biscuit | biscit)”，这与文档中出现的“seabiscuit”的简单情况不匹配

所以我尝试更改我的配置文件并在索引处添加我的过滤器，但它不起作用。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T18:55:01.667

您正在使用`=>`.

Solr[文档](https://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.SynonymFilterFactory)说

> 显式映射匹配“=>”的 LHS 上的任何标记序列，并*替换*为 RHS 上的所有替代项。这些类型的映射忽略架构中的 expand 参数。

所以我猜如果你搜索`NYC`你什么都得不到，因为它`New York`在索引时被替换了。

相反，您可以尝试将它们声明为等效的同义词吗？即喜欢 `NYC, New York`而不是`NYC => New York`。

那么我相信你可以搜索其中任何一个，结果都会是一样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-25T23:36:18.313

问题是当第一个短语中的单词数少于第二个短语中的单词数时，solr 同义词往往会导致问题。发生这种情况时，令牌会溢出到其他令牌的位置。

**我有一个解决这个问题的方法**，但它需要在索引和查询时 两次使用**solr.SynonymFilterFactory 。**

像这样 ：

```
<filter class="solr.SynonymFilterFactory" synonyms="multi_word_conversion.txt" 
ignoreCase="true" expand="true" />

<filter class="solr.SynonymFilterFactory" synonyms="layor_two_syns.txt" 
ignoreCase="true" expand="true"/> 
```

在第一个过滤器中，您将拥有：New York => New_York

在第二个过滤器中：NYC => New_York

现在搜索纽约将返回包含 NYC 和反之亦然的结果。

最后一点：**除非在索引和查询时间，否则此 will 方法将不起作用。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-20T13:56:26.827

关于

```
st., st => saint 
```

我认为你应该这样做：

```
st. => saint
st => saint 
```

关于

```
NY => New York 
```

我面临着类似的问题并得出结论，这是因为解析是在同义词替换之前完成的，这可能会在多词时引起问题。我发现可以在 SynonymFactory 中包含一个解析器：

```
<filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true" tokenizerFactory="solr.KeywordTokenizerFactory" /> 
```

我刚刚测试了它，我得到了更好的结果，但还没有达到预期的效果。奇怪的是，当添加 KeywordTokenizerFactory 似乎会产生积极影响时，添加 WhitespaceTokenizerFactory 或 StandardTokenizerFactory 似乎并没有改变任何东西。

顺便说一句，如果不使用带状疱疹，这应该已经没问题了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-29T20:48:20.027

根据 Pr Shadoko 的回答：

查看您的分析仪的工作方式，例如

```
http://localhost/solr/analysis/field?analysis.fieldvalue=EXAMPLE-KEYWORDS&q=EXAMPLE-KEYWORD%203&analysis.fieldname=EXAMPLEFIELD&analysis.showmatch=true 
```

analysis/field 是一个开箱即用的请求处理程序（位于 solrconfig.xml 中）。 [在这里](http://lucene.apache.org/solr/4_3_0/solr-core/org/apache/solr/handler/FieldAnalysisRequestHandler.html)你可以找到它的参数列表。（“analysis.query”对我不起作用，所以我不得不使用“q”）

由于 SynonymFilter 在匹配任何同义词之前解析（剪切）传入的文本，因此多词同义词不会受到打击。诀窍是告诉 SynonymFilter 采用一个解析器，它实际上不解析：keywordTokenizer

```
<filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true" tokenizerFactory="solr.KeywordTokenizerFactory" /> 
```

无论如何，这种方法感觉像是一种 hack，我无法估计副作用（可扩展性，...） - 所以要小心！

# ios - NSMutableArray 在最后一个索引处插入对象

> ID：12217026
> 
> 赞同：1
> 
> 时间：2012-08-31T14:06:26.390
> 
> 标签：ios, nsmutablearray

我正在尝试将 NSDictionary 的对象内容复制到 NSMutableArray，并且我正在使用以下代码：

```
 // Use when fetching binary data
             NSData *responseData = [request responseData];

             // View the data returned - should be ready for parsing.
             resultsDictionary = [responseData objectFromJSONData];
             NSLog(@"ResultsDictionary:%@", resultsDictionary);

             self.OnlineObjects = [[[NSMutableArray alloc] init] autorelease];

             for (NSDictionary * dataDict in resultsDictionary) {
                 [OnlineObjects insertObject:dataDict atIndex:0];
             }

             NSLog(@"OnlineObjects:%@", OnlineObjects); 
```

这是有效的，因为我从字典中获取所有对象，但是对象顺序已经反转，第一个对象现在是最后一个...

如何告诉 insertObject 在最后一个索引处添加对象？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:13:01.347

您可以改用该`addObject:`方法。

要摆脱哈希顺序问题`allKeys`，请对数组进行排序，然后使用元素作为键以正确顺序获取对象。

详细示例（对于整数键）：

```
NSArray *indices = [[resultsDictionary allKeys] sortedArrayUsingComparator:^(id obj1, id obj2) {
    if ( [obj1 intValue] > [obj2 intValue] ) {
        return (NSComparisonResult)NSOrderedDescending;
    }
    if ( [obj1 intValue] < [obj2 intValue] ) {
        return (NSComparisonResult)NSOrderedAscending;
    }
    return (NSComparisonResult)NSOrderedSame;
}];

for (int i = 0; i < [indices count]; i++) {
    NSDictionary *obj = [resultsDictionary objectForKey:[indices objectAtIndex:i]];
    [OnlineObjects addObject:obj];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:08:18.893

NSDictionary 中元素的顺序是未定义的，您不知道从字典中检索它们的顺序。对数组进行排序的唯一方法是在字典中的所有值都传输到数组后对其进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:11:35.380

你应该知道的两件事：

1.  `NSDictionary`是一个键值容器，不保证对象的顺序。使用此数据结构读取时，您无法确保插入顺序保持不变。如果顺序对您很重要，请检查其他策略，但不要依赖`NSDictionary`于此。
2.  您有几种方法可以提取键和数据的信息：`allKeys`和`allValues`. 使用它们而不是创建自己的。

# python - 如何在 Python 中传递 5 秒后返回函数？

> ID：12217027
> 
> 赞同：8
> 
> 时间：2012-08-31T14:06:25.447
> 
> 标签：python, function, time

我想编写一个无论如何都会在 5 秒后返回的函数：

```
def myfunction():
    while passed_time < 5_seconds:
        do1()
        do2()
        do3()
        .
        .
    return 
```

我的意思是，这个函数只运行 5 秒，5 秒后，它应该结束，并继续执行其他函数：

```
myfunction()
otherfunction()   ----> This should start 5 seconds after myfunction() is executed. 
```

此致

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T14:10:05.483

你可以做：

```
def myfunction():
    start = time.time()
    while time.time() < start + 5:
        do1()
        do2()
        do3() 
```

请注意，这将*在至少*5 秒后停止 - 如果`do1`、`do2`、 和`do3`每个需要 3 秒，则此函数将需要 9 秒。

* * *

`myFunction`如果你想在这些电话之间切断，你可以这样做：

```
def myfunction():
    todo = itertools.cycle([do1, do2, do3])
    start = time.time()
    while time.time() < start + 5:
        todo.next()() 
```

这种情况需要6s

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T14:22:03.063

如果您的函数的执行时间有可能比触发这些函数的时间间隔长，则您必须在另一个线程或进程中启动这些函数。

示例`threading`：

```
import time
import sys
from threading import Thread

def f1():
    print "yo!!"
    time.sleep(6)

def f2():
    print "boring."
    time.sleep(2)

if __name__ == "__main__":
    threads = []
    try:
        for f in [f1, f2]:
            t = Thread(target=f)
            t.start()
            threads.append(t)
            time.sleep(5)
    except KeyboardInterrupt:
        sys.exit(0)
    finally:
        [t.join() for t in threads] 
```

我理解这个问题的方式是，您不一定需要在 5 秒后终止/结束一个功能。您的主要目标是以 5 秒的间隔启动函数。如果您需要在一段时间后“杀死”函数，使用线程这将不是一件容易的事：[有没有办法在 Python 中杀死一个线程？](https://stackoverflow.com/questions/323972/is-there-any-way-to-kill-a-thread-in-python)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T20:42:20.963

你也可以这样做：

```
import time 
start=time.time()   

stuff={1:do1,2:do2,3:do3,...}
i=1

while time.time() <= start+5:
    stuff[i]()
    i+=1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T21:36:48.813

从您定义问题的方式来看，我认为这是使用基于生成器的协同程序的好情况。也就是说，每次完成其处理步骤（例如or ）时更改`myFunction`为 s 的生成器，并从检查时间的循环中运行它。`yield``do1``do2`

这是一个重复运行单个`somework`函数的简单实现，但您可以轻松调用不同的函数，甚至直接在`myFunction`生成器中工作：

```
import time

def somework():
    print "Doing some work!"
    time.sleep(2)

def myFunction():
    try:
        print "Started myFunction()"
        yield somework()
        yield somework()
        yield somework()
        yield somework()
        yield somework()
        print "Done with myFunction()"
    except GeneratorExit:
        print "Exiting myFunction() early!"

def main():
    start = time.time()
    gen = myFunction()
    for _ in gen:
        if time.time() > start+5:
            gen.close(); 
```

使用这种结构有一些好处：

1.  首先，`myFunction`可以选择它`yield`在外循环的位置，这样它就不会在意外的时间被杀死。如果它正在操作一些外部数据结构，您可以确保它始终以一致的状态产生所有内容。
2.  其次，`myFunction`如果有用的话，可以产生中间值。上面的示例代码产生`None`（因为这是返回值，`somework`但您可以轻松更改。主循环将最新产生的值放入`_`变量中（未使用），但您可以重命名该变量并在超时时使用它的值如果你想阻止。
3.  最后，通过捕获`GeneratorExit`异常，`myFunction`可以在它关闭之前运行它需要的任何清理代码。

# python - Django：用户配置文件创建表单

> ID：12217029
> 
> 赞同：0
> 
> 时间：2012-08-31T14:06:31.443
> 
> 标签：python, django, forms, models

据我了解，扩展`User`Django 模型的标准方法是实现`profiles`.

这非常适合我，因为我有 3 种类型的配置文件（3 个不同的`Model`子类），它们都基于`User`唯一性和身份验证模型。

但是，我无法确定实现用户创建表单的最佳方式。我是不是该...

1.  使用 mixins：继承一个`ModelForm`with`model=User`和一个 with `model=Profile`，手动覆盖`save()`并`clean()`调用基类的方法并执行外键分配。

2.  使用组合：继承`Form`和手动实例化管理两个`ModelForms`.

3.  分别实例化表单，并`save()`以手动排序的方式。

4.  我没有想到的最佳方式。

我会很感激一个（但最小的）实现，所以我可以确定我做出了正确的调用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T18:26:49.527

您可以编写一个表单，作为 Profile 模型和 contrib User 模型的组合 ModelForm。为此，需要对 init 上的表单 kwargs 进行一些操作。看到这个片段：[http ://djangosnippets.org/snippets/2081/](http://djangosnippets.org/snippets/2081/)

# html - 无法在 html5 中使用 Kineticjs

> ID：12217033
> 
> 赞同：0
> 
> 时间：2012-08-31T14:06:42.537
> 
> 标签：html, canvas, draggable, kineticjs

我想使用 Kinetic js 库来在画布上的图像中制作拖动和调整大小的效果。所以我正在关注这个例子[http://www.html5canvastutorials.com/labs/html5-canvas-drag-and-drop-resize-and-invert-images/](http://www.html5canvastutorials.com/labs/html5-canvas-drag-and-drop-resize-and-invert-images/)

假设我的html是这样的：

```
.....
<div id="container"></div>
..... 
```

然后在加载时我这样做：

```
$(document).ready(function() {  
    loadImage()
});

function loadImage(){

imageObj = new Image();      
imageObj.onload  = function(){
    var stage = new Kinetic.Stage("container", 578, 200);
    var layer = new Kinetic.Layer();   

    var x = stage.width / 2 - 200 / 2;
    var y = stage.height / 2 - 137 / 2;

    var image = new Kinetic.Image({
        image: imageObj,
        x: x,
        y: y
    });

    image.draggable(true);

    // add cursor styling
    image.on("mouseover", function(){
        document.body.style.cursor = "pointer";
    });
    image.on("mouseout", function(){
        document.body.style.cursor = "default";
    });
    layer.add(image);
    stage.add(layer);
};
imageObj.src = 'myImage.png';
} 
```

但我得到的是这条消息：

“未捕获的 TypeError：无法调用未定义的方法 'appendChild'”指的是我认为在容器 div 中。可能是什么问题呢？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:21:29.840

尝试 setDraggable：

```
image.setDraggable(true); 
```

但是，不得不问，为什么不使用 Kinetic 的画布构造函数呢？如果您直接操作画布，我相信您无法使用此库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T08:33:54.573

构造函数调用不正确。

尝试

> ```
> var stage = new Kinetic.Stage({
>       container: 'container',
>       width: 578,
>       height: 363
> }); 
> ```

对于拖动部分，您可以使您的图层可拖动

> ```
> var layer = new Kinetic.Layer({draggable: true}); 
> ```

你可以在这个[小提琴中看到一个基本的例子](http://jsfiddle.net/jbalsas/dVWxG/)

# asp.net - 根据 DropDownList 的选择填充几个文本框

> ID：12217038
> 
> 赞同：0
> 
> 时间：2012-08-31T14:06:57.620
> 
> 标签：asp.net, drop-down-menu

我`DropDownList`从数据库中填充了一个。

当我在 中选择一个项目时`DropDownList`，我想调用一个过程并将 DropDownList 的值传递给调用过程以查询数据库以填充几个文本框。

这该怎么做？

程序代码：

```
protected void PopulateTextBoxes()
{
    SqlDataReader MyReader;
    SqlConnection Conn;
    SqlParameter TourIdParam;

    string strConnection = ConfigurationManager.ConnectionStrings["ChinatowndbConnString"].ConnectionString;

    Conn = new SqlConnection(strConnection);

    SqlCommand MyCommand = new SqlCommand();

    MyCommand.CommandText = "SELECT TourId, TName, TDetails FROM Chinatowndb.dbo.Tour Where TourId = @TourIdp";
    MyCommand.CommandType = CommandType.Text;
    MyCommand.Connection = Conn;

    TourIdParam = new SqlParameter();
    TourIdParam.ParameterName = "@TourIdp";
    TourIdParam.SqlDbType = SqlDbType.Int;
    TourIdParam.Direction = ParameterDirection.Input;
    TourIdParam.Value = ddlTour.SelectedItem.Value;

    MyCommand.Parameters.Add(TourIdParam);

    MyCommand.Connection.Open();
    MyReader = MyCommand.ExecuteReader(CommandBehavior.CloseConnection);

    while (MyReader.Read())
    {
        tbTourName.Text = (string)MyReader["TName"];
        tbTourDetails.Text = (string)MyReader["TDetails"];
        lblTourId.Text = Convert.ToString(MyReader["TourId"]);
    }
} 
```

要填充的代码`DropDownBox`：

```
private void PopulateTour()
{

    DataTable dtTour = new DataTable();

    string strConnection = ConfigurationManager.ConnectionStrings["ChinatowndbConnString"].ConnectionString;

    using (SqlConnection con = new SqlConnection(strConnection))
    {

        try
        {
            SqlDataAdapter adapter = new SqlDataAdapter("SELECT TourId, TName FROM Chinatowndb.dbo.Tour", con);
            adapter.Fill(dtTour);

            ddlTour.DataSource = dtTour;
            ddlTour.DataValueField = "TourId";
            ddlTour.DataTextField = "TName";
            ddlTour.DataBind();
        }
        catch (Exception ex)
        {
            // Handle the error
        }

    }

    // Add the initial item
    ddlTour.Items.Insert(0, new ListItem("<Select Tour>", "0"));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:14:34.290

您需要为 HTML 中的选择更改添加事件处理程序

```
<asp:DropDownList id="ddlTour"
     AutoPostBack="True"
     OnSelectedIndexChanged="ddlTour_SelectedIndexChanged"
     runat="server"> 
```

并在您的代码中处理事件

```
 void ddlTour_SelectedIndexChanged(Object sender, EventArgs e)
  {
        // Call the method that gets the current item from the dropdown and fills the textboxes
        PopulateTextBoxes();
  } 
```

# cocos2d-iphone - 令人困惑的 box2d 力量

> ID：12217041
> 
> 赞同：1
> 
> 时间：2012-08-31T14:07:04.637
> 
> 标签：cocos2d-iphone, box2d-iphone

![在此处输入图像描述](../Images/209551cfdae8fd0b77e34fb0b53efe21.png)

你好朋友。这是我的演示游戏屏幕截图。这里我使用三个按钮。右下按钮用于跳跃，左下按钮用于左右移动。

我有一些问题 1) 我应该使用 linearImpuls 作为跳跃体吗？2）对于左右移动我施加了哪些类型的力？？？

请告诉我，我对使用 linearImpuls、applyforce 和 linearVelocity 感到困惑。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T05:23:35.970

跳跃你使用 LinerImpulse

```
b2Vec2 locationWorld;
 locationWorld = b2Vec2(0.0f,8.0f);
 double Force= _body->GetMass();
  _body->ApplyLinearImpulse(Force*locationWorld, _body->GetWorldCenter()); 
```

向左移动也使用它，但是`b2Vec2(5.0f,0.0f)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:12:32.673

对于向左/向右移动，您可以使用速度。当您需要停止角色时，只需将速度设置为 (0.f, 0.f)。对于跳跃使用冲动。如果你的 b2World 有重力，它会自己计算跳跃轨迹。

# wcf - 从 Javascript (jQuery) 调用 WIF (SAML) 保护的 WCF REST 服务

> ID：12217043
> 
> 赞同：4
> 
> 时间：2012-08-31T14:07:14.030
> 
> 标签：wcf, rest, wif, saml, adfs

我开始怀疑这是否可能，但我希望有人比我对机制有更深入的了解。

我们计划在使用 ADFS 保护的 SharePoint 网站中托管纯 JavaScript 表单。此表单需要调用 WCF REST 服务。我们希望能够在 WCF 服务中使用从 ADFS 发给用户的相同 FedAuth cookie / SAML 令牌进行身份验证，但到目前为止，我还没有真正找到使用 javascript 传递它的方法。

因此，为了分解它，您如何从 javascript 调用 WIF/SAML 保护的 WCF REST 服务？

# java - 如何确定空行？

> ID：12217047
> 
> 赞同：38
> 
> 时间：2012-08-31T14:07:24.700
> 
> 标签：java, apache-poi

如何使用 Apache POI 确定 .xls 文档中的空行？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-05-06T16:23:18.510

我在我的 POI 项目中使用了以下方法，并且运行良好。它是 zeller 解决方案的变体。

```
public static boolean isRowEmpty(Row row) {
    for (int c = row.getFirstCellNum(); c < row.getLastCellNum(); c++) {
        Cell cell = row.getCell(c);
        if (cell != null && cell.getCellType() != Cell.CELL_TYPE_BLANK)
            return false;
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2015-02-11T10:19:52.367

行迭代器仅返回包含数据的行，但是如果它们完全为空，则按行索引进行迭代，`getRow(index)` 返回`null`

解决方案：

直到 POI 版本 3.14（感谢 Sergii Lisnychyi）：

```
private boolean checkIfRowIsEmpty(Row row) {
    if (row == null) {
        return true;
    }
    if (row.getLastCellNum() <= 0) {
        return true;
    }
    for (int cellNum = row.getFirstCellNum(); cellNum < row.getLastCellNum(); cellNum++) {
        Cell cell = row.getCell(cellNum);
        if (cell != null && cell.getCellType() != Cell.CELL_TYPE_BLANK && StringUtils.isNotBlank(cell.toString())) {
            return false;
        }
    }
    return true;
} 
```

从 POI 版本 3.15 到 4.2（`int getCellType()`已弃用）：

```
 private boolean checkIfRowIsEmpty(Row row) {
    if (row == null) {
        return true;
    }
    if (row.getLastCellNum() <= 0) {
        return true;
    }
    for (int cellNum = row.getFirstCellNum(); cellNum < row.getLastCellNum(); cellNum++) {
        Cell cell = row.getCell(cellNum);
        if (cell != null && cell.getCellTypeEnum() != CellType.BLANK && StringUtils.isNotBlank(cell.toString())) {
            return false;
        }
    }
    return true;
} 
```

从 POI 版本 4（`CellTypeEnum getCellTypeEnum()`将返回 Enum 而非 int）：

```
private boolean checkIfRowIsEmpty(Row row) {
    if (row == null) {
        return true;
    }
    if (row.getLastCellNum() <= 0) {
        return true;
    }
    for (int cellNum = row.getFirstCellNum(); cellNum < row.getLastCellNum(); cellNum++) {
        Cell cell = row.getCell(cellNum);
        if (cell != null && cell.getCellTypeEnum() != CellType.BLANK && StringUtils.isNotBlank(cell.toString())) {
            return false;
        }
    }
    return true;
} 
```

从 POI 版本 5.1（CellTypeEnum getCellTypeEnum() 重命名为 getCellType()）：

```
private boolean checkIfRowIsEmpty(Row row) {
    if (row == null) {
        return true;
    }
    if (row.getLastCellNum() <= 0) {
        return true;
    }
    for (int cellNum = row.getFirstCellNum(); cellNum < row.getLastCellNum(); cellNum++) {
        Cell cell = row.getCell(cellNum);
        if (cell != null && cell.getCellType() != CellType.BLANK && StringUtils.isNotBlank(cell.toString())) {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-31T14:12:16.623

您必须遍历行中的所有单元格并检查它们是否都是空的。不知道还有什么解决办法...

```
 short c;
 for (c = lastRow.getFirstCellNum(); c <= lastRow.getLastCellNum(); c++) {
     cell = lastRow.getCell(c);
     if (cell != null && lastRow.getCell(c).getCellType() != HSSFCell.CELL_TYPE_BLANK) {
          nonBlankRowFound = true;
     }
 } 
```

代码来自[这里](http://affy.blogspot.co.uk/2004/04/poi-optimization-eliminating-trailing.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-11-15T13:55:17.293

是的，但是如果在某些**行**中，我们将在某个**单元格**= **" "**中包含另一个单元格中的空值。这种方法会更好：

```
 boolean isEmptyRow(Row row){
     boolean isEmptyRow = true;
         for(int cellNum = row.getFirstCellNum(); cellNum < row.getLastCellNum(); cellNum++){
            Cell cell = row.getCell(cellNum);
            if(cell != null && cell.getCellType() != Cell.CELL_TYPE_BLANK && StringUtils.isNotBlank(cell.toString())){
            isEmptyRow = false;
            }    
         }
     return isEmptyRow;
   } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-31T15:01:51.957

假设您想检查行`n`是否为空，请记住 Apache POI 中的行是从零开始的，而不是从一开始的，您需要类似：

```
 Row r = sheet.getRow(n-1); // 2nd row = row 1
 boolean hasData = true;

 if (r == null) {
    // Row has never been used
    hasData = false;
 } else {
    // Check to see if all cells in the row are blank (empty)
    hasData = false;
    for (Cell c : r) {
       if (c.getCellType() != Cell.CELL_TYPE_BLANK) {
         hasData = true;
         break;
       }
    }
 } 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-01-19T06:12:06.217

**如果您使用的是 apache-poi [4+]：**

那么下面的方法对你有用。由于建议的其他方法对我不起作用，我不得不这样做。

```
public static boolean isRowEmpty(Row row) {
    boolean isEmpty = true;
    DataFormatter dataFormatter = new DataFormatter();
    if(row != null) {
        for(Cell cell: row) {
            if(dataFormatter.formatCellValue(cell).trim().length() > 0) {
                isEmpty = false;
                break;
            }
        }
    }
    return isEmpty;
} 
```

当单元格为或时，该方法`dataFormatter.formatCellValue(cell)`将返回。`""``empty / ZERO length string``null``BLANK`

供您参考的导入语句：

```
import org.apache.poi.ss.usermodel.DataFormatter;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Cell; 
```

希望这可以帮助！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-05-17T10:45:14.240

```
boolean isEmptyRow(Row row) {
    boolean isEmpty=true;
    String data="";
    for(Cell cell:row) {
        data=data.concat(cell.getStringCellValue());
    }
    if(!data.trim().isEmpty()) {
        isEmpty=false;
    }
    return isEmpty;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-01T11:33:24.833

尝试使用 if(iterator.hasNext)

```
Row nextRow = null;
Cell nextCell = null;
Iterator<Row> iterator = firstSheet.rowIterator();
if(iterator.hasNext) {
    return true;
}
else {
    return false;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-31T14:24:37.193

获取 CellReference 的实例并在实例上使用 formatAsString()。将其与空字符串进行比较

`

```
if("".equals(cellRef.formatAsString())){
     System.out.println("this is an empty cell");
   }else{
      System.out.println("Cell value : "+cellRef.formatAsString());
   } 
```

`参考：[http ://www.javabeat.net/2007/10/apache-poi-reading-excel-sheet-using-java/](http://www.javabeat.net/2007/10/apache-poi-reading-excel-sheet-using-java/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-18T11:41:09.000

**Row == null**在我的情况下是有效的。

```
int total_row = mySheet.getLastRowNum();
int current_row = 0;
HSSFRow hssf_Row;

while (current_row <= total_row) {
    hssf_Row = mySheet.getRow(current_row);
    if (hssf_Row == null) Log.d("empty row","row=" + String.valueOf(current_row));
    current_row++;
} 
```

# powershell - 在PowerShell中一次通过MSMQ一条消息

> ID：12217053
> 
> 赞同：2
> 
> 时间：2012-08-31T14:07:44.937
> 
> 标签：powershell, msmq

我目前正在尝试编写一个脚本，该脚本将通过消息队列并删除/发送到另一个子队列，如果某个字符串在正文中。

在我目前正在尝试实现的伪代码中

```
$queue = 'My Queue'
foreach($message in $queue)
    {
    if ($message.body.Contains("matchstring")
        {
         $message.delete OR $message.movequeue
         }
    } 
```

我目前在 powershell 中使用 [Reflection.Assembly]::LoadWithPartialName("System.Messaging") 但我不确定它是否包含我需要的所有功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T15:33:09.843

您可以在 PowerShell 中执行此操作。下面是一些简单的代码，可以帮助您开始并连接到队列：

```
$queuePath = ("Direct=OS:SERVER\private$\PRIVATEQUEUE")
$queue = New-Object System.Messaging.MessageQueue $queuePath
$queue.GetAllMessages() 
```

使用 $queue | gm 和 MSDN 将您带到您需要的地方。

# c# - 打开/关闭音乐按钮 Console.Beep

> ID：12217054
> 
> 赞同：4
> 
> 时间：2012-08-31T14:07:49.617
> 
> 标签：c#, console, beep

我有一个按钮，上面写着音乐开/关。

使用以下`Console.Beep()`代码：

```
private void button1_Click(object sender, EventArgs e)
{
    Console.Beep(659, 125);
    Console.Beep(659, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(523, 125);
    Console.Beep(659, 125);
    Thread.Sleep(125);
    Console.Beep(784, 125);
    Thread.Sleep(375);
    Console.Beep(392, 125);
    Thread.Sleep(375);
    Console.Beep(523, 125);
    Thread.Sleep(250);
    Console.Beep(392, 125);
    Thread.Sleep(250);
    Console.Beep(330, 125);
    Thread.Sleep(250);
    Console.Beep(440, 125);
    Thread.Sleep(125);
    Console.Beep(494, 125);
    Thread.Sleep(125);
    Console.Beep(466, 125);
    Thread.Sleep(42);
    Console.Beep(440, 125);
    Thread.Sleep(125);
    Console.Beep(392, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(125);
    Console.Beep(784, 125);
    Thread.Sleep(125);
    Console.Beep(880, 125);
    Thread.Sleep(125);
    Console.Beep(698, 125);
    Console.Beep(784, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(125);
    Console.Beep(523, 125);
    Thread.Sleep(125);
    Console.Beep(587, 125);
    Console.Beep(494, 125);
    Thread.Sleep(125);
    Console.Beep(523, 125);
    Thread.Sleep(250);
    Console.Beep(392, 125);
    Thread.Sleep(250);
    Console.Beep(330, 125);
    Thread.Sleep(250);
    Console.Beep(440, 125);
    Thread.Sleep(125);
    Console.Beep(494, 125);
    Thread.Sleep(125);
    Console.Beep(466, 125);
    Thread.Sleep(42);
    Console.Beep(440, 125);
    Thread.Sleep(125);
    Console.Beep(392, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(125);
    Console.Beep(784, 125);
    Thread.Sleep(125);
    Console.Beep(880, 125);
    Thread.Sleep(125);
    Console.Beep(698, 125);
    Console.Beep(784, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(125);
    Console.Beep(523, 125);
    Thread.Sleep(125);
    Console.Beep(587, 125);
    Console.Beep(494, 125);
    Thread.Sleep(375);
    Console.Beep(784, 125);
    Console.Beep(740, 125);
    Console.Beep(698, 125);
    Thread.Sleep(42);
    Console.Beep(622, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(415, 125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Thread.Sleep(125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Console.Beep(587, 125);
    Thread.Sleep(250);
    Console.Beep(784, 125);
    Console.Beep(740, 125);
    Console.Beep(698, 125);
    Thread.Sleep(42);
    Console.Beep(622, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(698, 125);
    Thread.Sleep(125);
    Console.Beep(698, 125);
    Console.Beep(698, 125);
    Thread.Sleep(625);
    Console.Beep(784, 125);
    Console.Beep(740, 125);
    Console.Beep(698, 125);
    Thread.Sleep(42);
    Console.Beep(622, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(415, 125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Thread.Sleep(125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Console.Beep(587, 125);
    Thread.Sleep(250);
    Console.Beep(622, 125);
    Thread.Sleep(250);
    Console.Beep(587, 125);
    Thread.Sleep(250);
    Console.Beep(523, 125);
    Thread.Sleep(1125);
    Console.Beep(784, 125);
    Console.Beep(740, 125);
    Console.Beep(698, 125);
    Thread.Sleep(42);
    Console.Beep(622, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(415, 125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Thread.Sleep(125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Console.Beep(587, 125);
    Thread.Sleep(250);
    Console.Beep(784, 125);
    Console.Beep(740, 125);
    Console.Beep(698, 125);
    Thread.Sleep(42);
    Console.Beep(622, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(698, 125);
    Thread.Sleep(125);
    Console.Beep(698, 125);
    Console.Beep(698, 125);
    Thread.Sleep(625);
    Console.Beep(784, 125);
    Console.Beep(740, 125);
    Console.Beep(698, 125);
    Thread.Sleep(42);
    Console.Beep(622, 125);
    Thread.Sleep(125);
    Console.Beep(659, 125);
    Thread.Sleep(167);
    Console.Beep(415, 125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Thread.Sleep(125);
    Console.Beep(440, 125);
    Console.Beep(523, 125);
    Console.Beep(587, 125);
    Thread.Sleep(250);
    Console.Beep(622, 125);
    Thread.Sleep(250);
    Console.Beep(587, 125);
    Thread.Sleep(250);
    Console.Beep(523, 125);
    Thread.Sleep(625);
} 
```

我的问题是如何告诉按钮在再次单击时关闭音乐，然后在再次单击时重新打开音乐等等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T14:40:50.130

我不习惯编写完整的代码来回答问题，但考虑到我现在有多无聊，再加上播放的音乐，我无法抑制制作小型状态机的冲动。

```
public class Player
{
    private Thread Thread { get; set; }

    private ManualResetEventSlim Mutex { get; set; }

    public Player()
    {
        this.Mutex = new ManualResetEventSlim(false);

        this.Thread = new Thread(this.PlayThread);
        this.Thread.Start();
    }

    public void Play()
    {
        this.Mutex.Set();
    }

    public void Stop()
    {
        this.Mutex.Reset();
    }

    private static IEnumerable<Action> PlaySong()
    {
        yield return () => Console.Beep(659, 125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(523, 125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(784, 125);
        yield return () => Thread.Sleep(375);
        yield return () => Console.Beep(392, 125);
        yield return () => Thread.Sleep(375);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(392, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(330, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(440, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(494, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(466, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(440, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(392, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(784, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(880, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(698, 125);
        yield return () => Console.Beep(784, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(587, 125);
        yield return () => Console.Beep(494, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(392, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(330, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(440, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(494, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(466, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(440, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(392, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(784, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(880, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(698, 125);
        yield return () => Console.Beep(784, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(587, 125);
        yield return () => Console.Beep(494, 125);
        yield return () => Thread.Sleep(375);
        yield return () => Console.Beep(784, 125);
        yield return () => Console.Beep(740, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(415, 125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Console.Beep(587, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(784, 125);
        yield return () => Console.Beep(740, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(698, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(625);
        yield return () => Console.Beep(784, 125);
        yield return () => Console.Beep(740, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(415, 125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Console.Beep(587, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(587, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(1125);
        yield return () => Console.Beep(784, 125);
        yield return () => Console.Beep(740, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(415, 125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Console.Beep(587, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(784, 125);
        yield return () => Console.Beep(740, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(698, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(625);
        yield return () => Console.Beep(784, 125);
        yield return () => Console.Beep(740, 125);
        yield return () => Console.Beep(698, 125);
        yield return () => Thread.Sleep(42);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(659, 125);
        yield return () => Thread.Sleep(167);
        yield return () => Console.Beep(415, 125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(125);
        yield return () => Console.Beep(440, 125);
        yield return () => Console.Beep(523, 125);
        yield return () => Console.Beep(587, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(622, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(587, 125);
        yield return () => Thread.Sleep(250);
        yield return () => Console.Beep(523, 125);
        yield return () => Thread.Sleep(625);
    }

    private void PlayThread()
    {
        foreach (var action in PlaySong())
        {
            if (!this.Mutex.IsSet)
            {
                this.Mutex.Wait();
            }

            action();
        }
    }
} 
```

用法：实例化 Player 类。使用 Play 方法播放，使用 Stop 方法停止。理想情况下，您必须在完成歌曲后处理互斥锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:18:42.620

@Steve B 在评论中的内容是正确的方法。您可能想查看[Timer Class](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)，因为它很容易使用，并且会帮助您实现他的建议/您正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:25:16.343

请参阅此线程：[如何在新线程中运行一些简单的代码？](https://stackoverflow.com/questions/363377/c-sharp-how-do-i-run-a-simple-bit-of-code-in-a-new-thread)

您需要将音乐作为 UI 本身的单独线程运行。

# c++ - 如何在 C++ 中创建类列表

> ID：12217061
> 
> 赞同：0
> 
> 时间：2012-08-31T14:08:21.333
> 
> 标签：c++, oop, list, class

我的部分任务是创建一个类，其中包含两个其他类的两个列表并创建“大 4”（构造函数、复制构造函数、运算符 =、析构函数）

这是我所做的：

```
using namespace std;

class A{...};
class B{...};

class C{
  list<A> a;
  list<B> b;
  public:
    C();
    ~C();
    C(const C& c);
    void operator=(const C& c);
};

C::C(){
  //How to allocate memory for a and b?
}

C::~C(){
  //How to free the memory?
}

C::C(const C& c){
  a=c.a;
  b=c.b;
}

void operator=(const C& c){
  if(&c==this) return;
  // how do I delete a and b?
  a=c.a;
  b=c.b;
} 
```

您能否清除我不理解的内容（如代码中的注释）。如果我没有正确地做任何事情，也给建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:11:51.793

由于您使用的是值（`std::list`值），因此无事可做。您的构造函数将自动调用`std::list`构造函数，从而分配所需的任何资源。你的析构函数会调用`std::list`析构函数，它会释放它获取的资源。

如果您持有指向列表的指针（ie）或指针列表（） - 或两者都有（ ），您*将*需要一些额外的工作。`std::list<A> *a;``std::list<A*> a;'``std::list<A*> *a;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:14:31.147

> //如何为a和b分配内存？

您不需要自己分配内存。因为你在堆栈上分配你的成员变量。当有人实例化您的课程时，它会自动设置。

> //如何释放内存？

您不需要自己释放内存。出于同样的原因。当 scop 结束时，您的堆栈变量将自动释放。

> // 如何删除 a 和 b？

为什么需要删除 a 和 b ？您正在将数据从其他对象复制到此对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:27:05.047

您的变量正在使用自动存储类，它们不需要显式删除。

你的赋值运算符

```
void operator=(const& C rhs); 
```

不应该返回无效。// 因为这不是内置类型所做的，并且阻止了赋值链接。

例如

```
int x, y, z;
x = y = z = 0; 
```

看起来你试图用你的评论来实现移动语义

```
// how do I delete a and b? 
```

您的分配操作员应该复制状态，或者您应该记录它使用非标准行为。例如移动语义、boost::noncopyable 等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T15:23:58.900

如果您使用 std::list，您的 A 或 B 类应该：1 可以在堆栈上分配，堆 2 不能是单例对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T16:56:12.877

随着移动构造器的出现，它现在是六巨头。在这里学习并了解所有细节，您将获得类样板硕士学位。

```
#include <list>

class A {};
class B {};

class C{
  std::list<A> a;
  std::list<B> b;
  public:
    typedef std::list<A>::size_type size_type;
    explicit C(size_type sz =0);
    virtual ~C();
    C(const C& c);

    // Specialize external swap. Necessary for assignment operator below,
    // and for ADL (argument-dependant lookup).
    friend void swap(C& first, C& second); 

    // Assignment-operator. Note that the argument "other" is passed by value.
    // This is the copy-and-swap idiom (best practice).
    C& operator=(C other);  // NOTE WELL. Passed by value

    // move-constructor - construct-and-swap idiom (best practice)
    C(C&& other);

};

C::C(size_type sz) : a(sz), b(sz) {}

C::~C(){}

C::C(const C& c) :a(c.a), b(c.b){}

void swap(C& first, C& second) {
        // enable ADL (best practice)
        using std::swap; 
        swap(first.a, second.a);
        swap(first.b, second.b);
}

// Assignment-operator. Note that the argument "other" is passed by value.
// This is the copy-and-swap idiom (best practice).
C& C::operator=(C other) {
    swap(*this, other); // Uses specialized swap above.
    return *this;
} 

// move-constructor - construct-and-swap idiom (best practice)
C::C(C&& other): a(0) , b(0) {
    swap(*this, other);
} 
```

# c# - DirectoryEntry 页面大小限制

> ID：12217066
> 
> 赞同：0
> 
> 时间：2012-08-31T14:08:48.940
> 
> 标签：c#, .net, active-directory

下面的代码工作得很好，但是发生的事情是代码将结果限制为 1500 个用户，而我们有超过 1500 个用户。我要做的是检索属于特定组的所有用户的列表。我知道`DirectorySearcher`有一个 PageSize 设置但是，我无法找到设置 DirectoryEntry PageSize 的方法仍然只会拉该组的成员。

有人知道改变页面大小的方法吗？或者也许如何以另一种适应页面大小的方式拉动特定组的成员？

```
DirectoryEntry dEntryhighlevel = new DirectoryEntry("LDAP://CN=Users,OU=MyOu,OU=Clients,OU=Home,DC=bridgeTech,DC=net");
foreach (object dn in dEntryhighlevel.Properties["member"])
{
    DirectoryEntry singleEntry = new DirectoryEntry("LDAP://" + dn);
    DirectorySearcher dSearcher = new DirectorySearcher(singleEntry);
    //filter just user objects
    dSearcher.SearchScope = SearchScope.Base;
    //dSearcher.Filter = "(&(objectClass=user)(dn=" + dn + "))";
    //dSearcher.PageSize = 1000;
    SearchResult singleResult = null;
    singleResult = dSearcher.FindOne();
    if (singleResult != null)
    {
        string Last_Name = singleResult.Properties["sn"][0].ToString();
        string First_Name = singleResult.Properties["givenname"][0].ToString();
        string userName = singleResult.Properties["samAccountName"][0].ToString();
        string Email_Address = singleResult.Properties["mail"][0].ToString();
        OriginalList.Add(Last_Name + "|" + First_Name + "|" + userName + "|" + Email_Address);
    }
    singleEntry.Close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T20:27:00.080

这最近出现在另一个线程中：[Always getting 1500 member of distribution list using PowerShell](https://stackoverflow.com/questions/11984305/always-getting-1500-member-of-distribution-list-using-powershell/12099712#12099712)

简而言之，您想使用远程检索来获取成员资格。这是旨在帮助您获取具有> 1500个值的大型属性的机制。

当我们讨论这个话题时，我想预测一下你的下一个话题。:) 根据您使用的 API，读取组的成员资格会产生缺失的结果。如果您“接近金属”并使用 LDAP API，您会发现由于主要组成员身份而导致组中的用户丢失。在解决远程检索问题后，我会用您使用的任何方法对此进行测试，以确保您不会错过任何人。有关此的更多信息：[当成员属性不起作用时，从活动目录中检索组成员/成员资格](https://stackoverflow.com/questions/11262049/retrieving-group-members-membership-from-active-directory-when-members-attrib-do/11271696#11271696)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:34:13.340

我目前正在做类似的事情，并注意到您的代码与我的代码略有不同。使用以下代码结构，我没有遇到任何结果有限的问题：

```
DirectoryEntry dEntryhighlevel = new DirectoryEntry("LDAP://CN=Users,OU=MyOu,OU=Clients,OU=Home,DC=bridgeTech,DC=net");
DirectorySearcher dSearcher = new DirectorySearcher();
//filter just user objects
dSearcher.Filter = "(objectClass=user)";
dSearcher.PageSize = 1000;
SearchResultCollection resultCollection = dirSearcher.FindAll();
foreach (SearchResult userResults in resultCollection )
{
    string Last_Name = userResults .Properties["sn"][0].ToString();
    string First_Name = userResults .Properties["givenname"][0].ToString();
    string userName = userResults .Properties["samAccountName"][0].ToString();
    string Email_Address = userResults .Properties["mail"][0].ToString();
    OriginalList.Add(Last_Name + "|" + First_Name + "|" + userName + "|" + Email_Address);
} 
```

那应该返回您的所有用户。您需要在您 `dSearcher.Filter`的系统中使用 LDAP 搜索模式，以便将用户范围缩小到特定组 -[请参阅此链接](https://stackoverflow.com/questions/1032351/how-to-write-ldap-query-to-test-if-user-is-member-of-a-group)以获取更多帮助。

# mysql - Rails 3 connection.execute IN 语句参数数组语法

> ID：12217069
> 
> 赞同：2
> 
> 时间：2012-08-31T14:08:55.313
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, sql-parametrized-query

我有一个关于我想使用的 Rails 3 ActiveRecord::Base.connection.execute 方法和参数的语法问题。我已经为此奋斗了几个小时，但似乎在互联网上找不到这个特定问题的任何答案。

数据库是 MySQL。

我需要通过带有 IN 条件语句的 SELECT 创建一个临时表，其中 IN 应该检查的值列表是一个参数 - rails Array。代码如下所示：

```
arr = [1,2,3]
ActiveRecord::Base.connection.execute("CREATE TEMPORARY TABLE things SELECT * FROM objects WHERE objects.id IN #{arr}") 
```

我得到一个 MySQL 语法错误！

```
ActiveRecord::Base.connection.execute("CREATE TEMPORARY TABLE things SELECT * FROM objects WHERE objects.id IN #{(arr)}") 
```

又是 MySQL 语法错误！

```
ActiveRecord::Base.connection.execute("CREATE TEMPORARY TABLE things SELECT * FROM objects WHERE objects.id IN (#{arr})") 
```

MySQL 语法错误

上面的尝试对应了这个问答： [How to execute absolute parameterized SQL in rails](https://stackoverflow.com/questions/4556672/how-to-execute-arbitrary-parameterized-sql-in-rails)

我什至尝试以 find_by_sql 的方式使用，但仍然出现错误：

```
ActiveRecord::Base.connection.execute(["CREATE TEMPORARY TABLE things SELECT * FROM objects WHERE objects.id IN (:ids)",{:ids => arr }]) - obviously, I get an MySQL error. 
```

我错过了一些明显的东西吗？请帮忙！我正是需要这种方式（例如，创建具有完全这种条件的临时表），否则基于此的更复杂的查询将不起作用。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-24T15:07:31.310

这是另一个使用 Rails 查询清理的选项

```
arr = [1,2,3]
query = "SELECT * FROM objects where id IN (?)"
query = ActiveRecord::Base.send :sanitize_sql_array, [query, arr]
ActiveRecord::Base.connection.execute(query) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:42:07.973

如果你转换`arr.to_s`你得到`"[1, 2, 3]"`.

我认为`arr.join(', ')`应该工作。

```
ActiveRecord::Base.connection.execute("CREATE TEMPORARY TABLE things SELECT * FROM objects WHERE objects.id IN (#{arr.join(', ')})") 
```

# java - 为什么/何时应该使用泛型方法？

> ID：12217073
> 
> 赞同：5
> 
> 时间：2012-08-31T14:09:12.620
> 
> 标签：java, oop, generics

学习Java，我遇到了*泛型方法*。

```
public <T> void foo(T variable) { } 
```

也就是说，一个方法接受一个未确定类型的参数（á la PHP？）。然而，我无法看到这将是一个好的解决方案 - 特别是因为我在从松散的语言中爱上了强类型语言之后。

有什么理由使用泛型方法吗？如果有，什么时候？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:32:49.823

那些来自 Java 5 背景之前的人都知道，将对象存储在 Collection 中，然后在使用它之前将其转换回正确的 Type 是多么不方便。泛型可以防止这些。它提供编译时类型安全，并确保您只在集合中插入正确的类型，并避免在运行时出现 ClassCastException。

所以它提供了编译时类型安全和强制转换。当您想要编写具有复杂方法签名的复杂 API 时，它会在编写 API 和使用 API 时为您节省很多时间，并且可以防止编写大量代码来转换部分并在编译时捕获错误。只需看一下`java.util.Collection`包并查看源代码。

作为开发人员，我总是希望编译器在编译时捕获我的错误，并在我想要编译它时通知我，然后我将修复我的错误，并且在运行时不会有很多与类型安全相关的错误。

欲了解更多信息，请参阅：

*   [http://javarevisited.blogspot.com/2011/09/generics-java-example-tutorial.html](http://javarevisited.blogspot.com/2011/09/generics-java-example-tutorial.html)
*   [http://javarevisited.blogspot.com/2012/06/10-interview-questions-on-java-generics.html](http://javarevisited.blogspot.com/2012/06/10-interview-questions-on-java-generics.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T14:11:24.493

除其他外，泛型为您提供了一种提供模板的方法——即您想做同样的事情，唯一的区别是类型。

例如，查看[List API](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)，您将看到方法

`add(E e)`

对于您声明的每个相同类型的列表，方法的唯一不同之处`add`在于进入列表的事物的类型。这是泛型有用的一个主要例子。（在将泛型引入 Java 之前，您将声明一个列表，并且您可以将任何内容添加到列表中，但您必须在检索对象时强制转换它）

更具体地说，您可能需要 2 个 ArrayList 实例，一个采用 type1，一个采用 type2。`add`对于每个列表（因为两个列表都是`ArrayList`实例），列表代码将执行相同的操作，执行相同的代码，对吗？所以唯一不同的是列表中的内容。

（正如@michael 指出的那样，`add`不是泛型方法的真实示例，但链接的API 中有真正的泛型方法，并且概念是相同的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:15:30.577

一般来说，泛型函数没有什么非强类型的。类型在编译时被解析和检查。它不是未定类型，它是一系列可能的类型之一（这些类型可以受到限制，在您的示例中它们不是）。在编译时它是已知和决定的。

正如 hvgotcodes 所说，Collections API 包含许多很好的使用示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-26T19:00:18.970

通用概念的主要目标是：

*   为集合提供类型安全，以便它们只能保存一种特定类型的对象。
*   解决类型转换问题。

要仅保存 String 类型的对象，可以声明 ArrayList 的通用版本，如下所示：

> ArrayList l = new ArrayList ();

要了解更多信息： http: [//algovalley.com/java/generics.php](http://algovalley.com/java/generics.php)

# php - 用变量计算下拉值

> ID：12217075
> 
> 赞同：0
> 
> 时间：2012-08-31T14:09:20.133
> 
> 标签：php, javascript, html

我在互联网上的任何地方都找不到解决方案。我有一个带有可变“价格”的代码和一个包含在内的下拉列表。

下拉列表的值为 1-40。当价值改变时，总价格应该立即改变。如在同一行中，如在最终总价中。

```
enter code here

 function calc(){
  one = document.getElementById("price1").childNodes.item(1).childNodes.item(1).value;
  two = parseFloat(document.getElementById("price1").childNodes.item(5).textContent.replace("€",""))
  document.getElementById("price1").childNodes.item(9).textContent =  one * two;
}
<tr id="price1">
        <td><?php include('optie.php');?></td>
        <td><strong>3-gangen traiteurmenu</strong><br>
            (incl. brood en boter)<br>******<br>
            Creme van gerookte paling<br>******<br>
            Gestoofde hertensukade met aardappelgratin, rodekool en een stoofpeertje.<br>******<br>
            Kerstbal van witte en pure chocolade en een vanillesaus.<br><hr>
            </td>
        <td><?php $prijs1= "16.50";?> &euro;<?php  echo $prijs1; ?></td>
        <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&euro;</td>
        <td id="Total"></td> 
    </tr> 
```

我在上面添加了这段代码，这正确计算了第一个下拉菜单。但是现在，我必须能够做到这 13 次，所有的下拉菜单

我现在知道它必须用 java 来完成，因为那是一种动态语言。

提前致谢！

碧玉

在 option.php 下

```
porties <select>
        <option value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        <option value="37">37</option>
        <option value="38">38</option>
        <option value="39">39</option>
        <option value="40">40</option>                                            
    </select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:16:12.450

PHP 是**服务器端代码**。

这意味着一旦您看到您的网站在浏览器中呈现，它已经从服务器交付，现在是“客户端”。PHP 无法运行客户端。

如果您右键单击并查看源代码，您将看到您的所有 PHP 代码已被 HTML 和纯文本替换。

所以你需要的是一种客户端编程语言，比如 Javascript。大多数人不再使用纯 JavaScript。这是因为不同的浏览器对 javascript 的解释不同。最流行的跨浏览器 JavaScript 库称为[jquery](http://jquery.com/)。

下载 jquery，将其包含在您的网站中，方法是将此代码放在头部：

```
<script type="text/javascript" src="/path/to/jquery.js"></script> 
```

现在您可以编写一些跨浏览器兼容的 javascript。

所以要做你想做的事，你需要在选择下拉菜单上检测“更改”事件。您可以使用`change()`jQuery 中的函数来执行此操作。

这是一个 jsfiddle 让你上路：http: [//jsfiddle.net/GmC3K/](http://jsfiddle.net/GmC3K/)

如果您对 jquery 有任何疑问，祝您好运！;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:15:27.167

您应该使用 Javascript 来实现这一点。

方法是将更改事件附加到下拉控件。因此，无论何时更改，都会更新显示价格的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T13:59:14.577

```
 function calc(){
  a = document.getElementById("price1").childNodes.item(1).childNodes.item(1).value;
  aa = parseFloat(document.getElementById("price1").childNodes.item(5).textContent.replace("€",""))
  z = document.getElementById("price1").childNodes.item(9).textContent =  Math.round(a * aa *100)/100;

  b = document.getElementById("price2").childNodes.item(1).childNodes.item(1).value;
  bb = parseFloat(document.getElementById("price2").childNodes.item(5).textContent.replace("€",""))
  zz = document.getElementById("price2").childNodes.item(9).textContent =  Math.round(b * bb *100)/100;

  c = document.getElementById("price3").childNodes.item(1).childNodes.item(1).value;
  cc = parseFloat(document.getElementById("price3").childNodes.item(5).textContent.replace("€",""))
  zzz = document.getElementById("price3").childNodes.item(9).textContent =  Math.round(c * cc *100)/100;

  d = document.getElementById("price4").childNodes.item(1).childNodes.item(1).value;
  dd = parseFloat(document.getElementById("price4").childNodes.item(5).textContent.replace("€",""))
  zzzz = document.getElementById("price4").childNodes.item(9).textContent =  Math.round(d * dd *100)/100;

  e = document.getElementById("price5").childNodes.item(1).childNodes.item(1).value;
  ee = parseFloat(document.getElementById("price5").childNodes.item(5).textContent.replace("€",""))
  zzzzzzzzzzz=document.getElementById("price5").childNodes.item(9).textContent =  Math.round(e * ee * 100)/100;

  f = document.getElementById("price6").childNodes.item(1).childNodes.item(1).value;
  ff = parseFloat(document.getElementById("price6").childNodes.item(5).textContent.replace("€",""))
  zzzzz = document.getElementById("price6").childNodes.item(9).textContent =  Math.round(f * ff *100)/100;

  g = document.getElementById("price6").childNodes.item(1).childNodes.item(1).value;
  gg = parseFloat(document.getElementById("price6").childNodes.item(5).textContent.replace("€",""))
  zzzzzzzzzzzz=document.getElementById("price6").childNodes.item(9).textContent =  Math.round(g * gg *100)/100;

  h = document.getElementById("price7").childNodes.item(1).childNodes.item(1).value;
  hh = parseFloat(document.getElementById("price7").childNodes.item(5).textContent.replace("€",""))
  zzzzzz = document.getElementById("price7").childNodes.item(9).textContent =  Math.round(h * hh *100)/100;

  i = document.getElementById("price8").childNodes.item(1).childNodes.item(1).value;
  ii = parseFloat(document.getElementById("price8").childNodes.item(5).textContent.replace("€",""))
  zzzzzzz = document.getElementById("price8").childNodes.item(9).textContent =  Math.round(i * ii *100)/100;

  j = document.getElementById("price9").childNodes.item(1).childNodes.item(1).value;
  jj = parseFloat(document.getElementById("price9").childNodes.item(5).textContent.replace("€",""))
  zzzzzzzz = document.getElementById("price9").childNodes.item(9).textContent =  Math.round(j * jj *100)/100;

  k = document.getElementById("price10").childNodes.item(1).childNodes.item(1).value;
  kk = parseFloat(document.getElementById("price10").childNodes.item(5).textContent.replace("€",""))
  zzzzzzzzz = document.getElementById("price10").childNodes.item(9).textContent =  Math.round(k * kk *100)/100;

  l = document.getElementById("price11").childNodes.item(1).childNodes.item(1).value;
  ll = parseFloat(document.getElementById("price11").childNodes.item(5).textContent.replace("€",""))
  zzzzzzzzzz = document.getElementById("price11").childNodes.item(9).textContent =  Math.round(l * ll *100)/100;

  document.getElementById("total").childNodes.item(9).textContent =  Math.round((z + zz + zzz + zzzz + zzzzz + zzzzzz + zzzzzzz + zzzzzzzz + zzzzzzzzz + zzzzzzzzzz + zzzzzzzzzzz + zzzzzzzzzzzz )*100)/100;

} 
```

也许不是最漂亮的代码，但它可以工作:)

# jquery - jQuery - 删除 HTML 中的自闭合标签

> ID：12217078
> 
> 赞同：2
> 
> 时间：2012-08-31T14:09:24.533
> 
> 标签：jquery, html, replace, kentico

我正在为一个由几个包含链接列表的 jQuery 手风琴组成的网站进行导航，如下所示：

```
<ul class="menu">
    <li>
        <h3>Header 1</h3>
        <ul>
            <li class="menuItem">Link 1</li>
            <li class="menuItem">Link 2</li>
            <li class="menuItem">Link 3</li>
        </ul>
    </li>
    <li>
        <h3>Header 2</h3>
        <ul>
            <li class="menuItem">Link 4</li>
            <li class="menuItem">Link 5</li>
            <li class="menuItem">Link 6</li>
        </ul>
    </li>
</ul> 
```

由于某种原因，该网站所基于的 CMS 将任何空列表设置为自闭合`<li>`标签，如下所示：

```
<ul class="menu">
    <li>
        <h3>Header 1</h3>
        <ul>
            <li class="menuItem">Link 1</li>
            <li class="menuItem">Link 2</li>
            <li class="menuItem">Link 3</li>
        </ul>
    </li>
    <li />
</ul> 
```

我想知道是否有一种方法可以`<li />`使用 jQuery 从 HTML 中查找和删除所有标签。谢谢！

**编辑：**我忘了提，这只出现在 IE7 中。在 IE8/9 中，浏览器具有`<li></li>`HTML，但它不会将这些标签呈现为任何内容。该`<li />`标签会影响 IE7 中的布局（看起来它被呈现为块元素，因此它会将其下方的内容向下推）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T14:11:38.337

`$('li:empty')`将找到所有空`<li>`标签。然后`.remove()`应该核对他们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-31T14:12:03.717

```
$("li:empty").remove(); 
```

[`:empty`选择器文档](http://api.jquery.com/empty-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:54:14.317

出于某种原因，没有一个修复程序在 IE6 中有效，尽管它们在所有其他浏览器中都有效。为了让 IE6 中的所有内容都能正常工作，我在`<li>`'s 中添加了一个类并`$('#xyz').remove();`在正文中使用以摆脱标签。

# neo4j - 具有多个起始节点的 neo4j 密码性能

> ID：12217086
> 
> 赞同：1
> 
> 时间：2012-08-31T14:09:45.000
> 
> 标签：neo4j, cypher

[http://console.neo4j.org/r/8mkc4z](http://console.neo4j.org/r/8mkc4z)

在上面的grpah中，查询的目的

```
start n=node(1) match n-[:KNOWS]->m-[:KNOWS]->p where p.name='Cypher' return n, m, p 
```

就是找到 m，这样 Neo 知道 m，m 知道 Cypher。

通过以下查询也可以实现相同的目的 -

```
start n=node(1), p=node(4) match n-[:KNOWS]->m-[:KNOWS]->p return n, m, p 
```

第一个使用 where 条件，第二个使用多个起始节点。

从性能的角度来看，哪一个应该运行得更快，并且可能在什么场景下运行。

我遇到了多个起始节点的性能问题，而我认为，逻辑上将其作为起始节点而不是条件应该更快的地方。

是否有根据不同场景使用哪种方法的规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:29:21.590

到目前为止，我们一直致力于加密语言，在 1.8 中添加了更新功能。

在 Neo4j 1.9 中，我们将关注密码性能。

到目前为止，具有单个起点的模式匹配器比具有多个起点的模式匹配器更快。尽管如此，如果仅在事后进行过滤（例如在您的第一个查询中），它们的执行速度可能仍然较慢（取决于结果量）。

但这将在下一个版本的过程中改变。我认为到目前为止我能给你的最好的提示是用你的真实数据集来分析查询（如果你还没有预期的数据，请编写数据生成器）。

# java - 在JAVA中的文件行末尾添加特定字符串

> ID：12217087
> 
> 赞同：0
> 
> 时间：2012-08-31T14:09:49.727
> 
> 标签：java, string, file, line, add

*我想*我的问题很简单：

**给定一个*data.txt*文件，如何在java中逐行添加一些字符串？**我不想删除内容，只是在行尾添加一些字符串。你能告诉我一个简单的代码吗？

例如，给定*data.txt*文件：

```
aaa bbb ccc
eee fff ggg 
```

运行java程序后的结果：

```
aaa bbb ccc ddd
eee fff ggg hhh 
```

* * *

**附加问题：**是否有一种简单的方法可以在给定文件的行中“插入”一些字符串？如果是的话，怎么做呢？结果：

```
aaa 111 bbb ccc
eee fff 222 ggg 
```

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T11:01:16.823

我不知道有一种简单的方法可以做到这一点，但是有一种相当复杂的方法可以做到这一点，即从文件中读取文本，对其进行编辑，然后用编辑后的文本覆盖文件。首先，您需要将文件逐行读取到数组中：

```
package addtext;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
/**
 *
 * @author Dan300
 */
public class AddText {

    File yourFile = new File("YourFileHere.txt"); //add the name of your file in the brackets
    int numLines; //this will store the number of lines in the file
    String[] lines; //the lines of text that make up the file will be stored here

    public AddText() {
        numLines = getNumberLines(yourFile);
        lines = new String[numLines];//here we set the size of the array to be the same as the number of lines in the file
        for(int count = 0; count < numLines; count++) {
            lines[count] = readLine(count,yourFile);//here we set each string in the array to be each new line of the file
        }

        doSomethingToStrings();
    }

public static void main(String[] args) {
        new AddText();
    } 
```

上面的代码基本上通过调用下面的方法（返回文件中文本的行数）来设置一个数组以包含与文件中的行数一样多的字符串...：

```
public int getNumberLines(File aFile) {
    int numLines = 0;
    try {

        BufferedReader input =  new BufferedReader(new FileReader(aFile));
            try {
                String line = null;

                while (( line = input.readLine()) != null){ //ReadLine returns the contents of the next line, and returns null at the end of the file.
                    numLines++;
                }
  }
  finally {
    input.close();
  }
}
catch (IOException ex){
  ex.printStackTrace();
}
    return numLines;
} 
```

...然后通过为每一行调用此方法来设置数组以包含文件中的文本：

```
public String readLine(int lineNumber, File aFile) {
        String lineText = "";
        try {

            BufferedReader input =  new BufferedReader(new FileReader(aFile));
                try {
                     for(int count = 0; count < lineNumber; count++) {
                        input.readLine();  //ReadLine returns the contents of the next line, and returns null at the end of the file.
                     }
                     lineText = input.readLine();
      }
      finally {
        input.close();
      }
    }
    catch (IOException ex){
      ex.printStackTrace();
    }
        return lineText;
    } 
```

阅读完文本文件后，您现在需要使用`.concat()`将两个字符串连接在一起的方法对字符串做一些事情。此代码将执行问题中的示例：

```
public void doSomethingToStrings() {
        try {

            lines[0] = lines[0].concat(" ddd"); //this joins the two strings lines[0] and " ddd"

        } catch (ArrayIndexOutOfBoundsException ex) { // I have added a try{}catch{} block so that if there is not as many lines in the file as expected, the code will still continue.

        }
        try {
            lines[1] = lines[1].concat(" hhh");
        } catch (ArrayIndexOutOfBoundsException ex) {

        }

        try {

            writeFile(yourFile);

        } catch (FileNotFoundException ex) {

        } catch (IOException ex) {
            Logger.getLogger(AddText.class.getName()).log(Level.SEVERE, null, ex);
        }

    } 
```

在此之后，它调用`writeFile()`将数组写入文件的方法。如果您想让代码更灵活，您可能希望添加另一个构造函数来将不同的数组写入文件：

```
public void writeFile(File aFile) throws FileNotFoundException, IOException {
        if (aFile == null) {
      throw new IllegalArgumentException("File should not be null.");
    }
    if (!aFile.exists()) {
      throw new FileNotFoundException ("File does not exist: " + aFile);
    }
    if (!aFile.isFile()) {
      throw new IllegalArgumentException("Should not be a directory: " + aFile);
    }
    if (!aFile.canWrite()) {
      throw new IllegalArgumentException("File cannot be written: " + aFile);
    }

    BufferedWriter output = new BufferedWriter(new FileWriter(aFile));
    try {
        for(int count = 0; count < numLines; count++) {
            output.write(lines[count]);
            if(count != numLines-1) {// This makes sure that an extra new line is not inserted at the end of the file
                output.newLine();
            }

        }

    }
    finally {
      output.close();
    }
    } 
```

要回答您的第二个问题，可以在一行中插入一个或多个单词，方法是使用`StringTokenizer`将字符串拆分为单词，然后在文本行中插入一个新单词。StringTokenizer 将字符串拆分为单词，调用 $Tokenizer1.nextToken() 返回字符串中的下一个单词。这是一个示例，其结果在您的问题中指定：

```
public void doSomethingElseToStrings() {
        try{
        StringTokenizer splitString1 = new StringTokenizer(lines[0]);
        newLines[0] = splitString1.nextToken();
        for(int count=0;count<=splitString1.countTokens();count++) {
            if(count == 0) {
            newLines[0] = newLines[0].concat(" 111");
        }
            newLines[0] = newLines[0].concat(" ");
            newLines[0] = newLines[0].concat(splitString1.nextToken());

        }
        } catch(ArrayIndexOutOfBoundsException ex) {

        }

        try {
        StringTokenizer splitString2 = new StringTokenizer(lines[1]);
        newLines[1] = splitString2.nextToken();
        for(int count=0;count<=splitString2.countTokens();count++) {
            if(count == 1) {
            newLines[1] = newLines[1].concat(" 222");
        }
            newLines[1] = newLines[1].concat(" ");
            newLines[1] = newLines[1].concat(splitString2.nextToken());

        }
        } catch(ArrayIndexOutOfBoundsException ex) {

        }

        try {

            writeFile(yourFile);

        } catch (FileNotFoundException ex) {

        } catch (IOException ex) {
            Logger.getLogger(AddText.class.getName()).log(Level.SEVERE, null, ex);
        }
    } 
```

但是，要使其与其余代码一起使用，您必须编辑这些部分：

```
public class AddText {  
    String[] newLines; // <<add
    File yourFile = new File("YourFileHere.txt"); //add the name of your file in the brackets
    int numLines; 
    String[] lines; 

public AddText() {
...
//doSomethingToStrings();  <<delete
doSomethingElseToStrings(); //  <<add
}

public void writeFile(File aFile) throws FileNotFoundException, IOException {
...
//output.write(lines[count]); <<delete
output.write(newLines[count]); //  <<add
...
} 
```

使用该`doSomethingToStrings()`方法更改文件：

```
aaa bbb ccc
eee fff ggg
(other text) 
```

对此：

```
aaa bbb ccc ddd
eee fff ggg hhh
(other text remains the same) 
```

使用该`doSomethingElseToStrings()`方法将文件更改为：

```
aaa 111 bbb ccc
ddd eee 222 fff
(other text remains the same) 
```

我希望这对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T11:16:20.497

以下是使用[Guava](http://guava-libraries.googlecode.com)的方法：

```
List<String> lines = Files.readLines(new File("myfile.txt"), Charsets.UTF_8);

StringBuilder output = new StringBuilder();

for(String line : lines) {
    String newLine = addNeededStringToLine(line);
    output.append(newLine);
}

Files.write(output, new File("myfile2.txt"), Charsets.UTF_8); 
```

就那么简单

关于插入行，您可以简单地将整行拆分为单独的字符串，然后在它们之间放置要插入的值。使用类似的东西：

```
 String line = "a b c" ;
    String[] split = line.split(" ");

    for (int i = 0; i < split.length; i++) {
        String string = split[i];
        System.out.println(string);
        if(string.equals("b")) {
            //some insterting 
        }
    } 
```

参考：

*   [`Files.readLines(File, Charset)`](http://guava-libraries.googlecode.com/svn/trunk/javadoc/com/google/common/io/Files.html#readLines%28java.io.File%2C%20java.nio.charset.Charset%29)

*   [`Files.write(CharSequence, File, Charset)`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Files.html#write%28java.lang.CharSequence,%20java.io.File,%20java.nio.charset.Charset%29)

# iphone - 在目标 c 中以编程方式设置属性值

> ID：12217089
> 
> 赞同：0
> 
> 时间：2012-08-31T14:09:59.163
> 
> 标签：iphone, objective-c, ios, properties

我有一个文件 Variables.m 用于存储我可以在我的应用程序中的所有类中使用的属性。现在我想为 A 类中的一个属性（比如用户名）设置一个值，并且我希望它对我的应用程序中的所有其他类（B、C、D、E ..）都可用，就像一个常量. IE。一旦他们在 B 类中初始化了一个变量对象（比如 var），如果他们发出 var.username，他们应该得到我在 A 类中设置的用户名。

实际上，我不想硬编码用户名值，而是想以编程方式设置它并让所有类看到我刚刚设置的值。每当我导航到一个类时，我可以在不传递变量对象的情况下实现这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:25:50.097

或者，您可以使用`NSUserDefaults`

在 A 类中设置变量：

```
NSString *usernameToSave = @"John Doe";
[[NSUserDefaults standardUserDefaults] setObject:usernameToSave forKey:@"userName"]; 
```

读取任何类中的变量：

```
NSString *userName = [[NSUserDefaults standardUserDefaults] objectforKey:@"userName"]; 
```

除了简单之外，这还具有（或不具有）在应用程序重新启动时保持不变的优点。

它的缺点是不是很安全；**[对于密码等，您应该使用此处](https://developer.apple.com/library/ios/#documentation/security/Conceptual/keychainServConcepts/iPhoneTasks/iPhoneTasks.html)**描述的钥匙串服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:17:07.410

创建一个单例类，该类为您希望存储的项目提供适当的 getter 和 setter。

然后，您可以从任何其他类中引用该单个实例。

例如，在您的变量类中创建一个类方法，如下所示：

```
 +(Variables*)sharedVariables{
        static Variables *myVariables = nil;
        if (myVariables != nil){
             return myVariables;
        }
       myVariables = [[Variables alloc]init];
       return myVariables;
    } 
```

如果你想要一个更好的实现，那么谷歌目标 C 单例类实现。

:)

要从其他类中使用它，您只需键入：

```
[Variables sharedVariables].whatever 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:18:37.953

You can use Singleton pattern. Like this.

```
@interface MySingleton : NSObject 
{
    NSString *username;
}
@property (nonatomic, retain) NSString *username;
+ (MySingleton *) sharedInstance;

@end

@implementation MySingleton
@synthesyse username;
static MySingleton *sMySingleton = nil;

+ (MySingleton *) sharedInstance
{
    @synchronized(self)
    {
        if (sMySingleton == nil)
        {
            sMySingleton = [NSAllocateObject([self class], 0, NULL) init];
        }
    }    
    return sMySingleton;
}

@end 
```

# windows - 在操作系统之间安全地共享本地 git 存储库

> ID：12217090
> 
> 赞同：1
> 
> 时间：2012-08-31T14:10:04.923
> 
> 标签：windows, git, ubuntu

我的计算机上安装了两个操作系统，其中一个通用的单独驱动器用于存储我的本地 git 存储库。从两个操作系统（Windows 7 和 Ubuntu 12）访问相同的物理本地存储库是否安全？

我下载了最新版本的 git，但每个操作系统的版本号都不同。Windows 有 1.7.11，Ubuntu 有 1.7.9.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:22:01.663

是的，它是安全的

git 内部存储格式定义明确，操作系统文件系统层需要非常努力地颠覆它，以使其在从不同操作系统访问时失败。

# tfs - 如何使用 tf 命令行登录 Azure 上的 tfs 服务器

> ID：12217094
> 
> 赞同：1
> 
> 时间：2012-08-31T14:10:20.123
> 
> 标签：tfs, tf-cli, azure-devops

我们尝试使用 tf 命令行在 TFS 上连接我们。

当我们连接时一切正常，但是当我们尝试连接到 TFS 服务器时，它不起作用。我们收到了一条询问我们凭据的消息提示，如果我们在提示中登录，之后一切都会正常工作。但是，如果我们尝试使用下面的命令行连接，我们总是会收到消息“您无权访问 TFS 服务器”。

我需要准确说明我们在 Azure 中使用 TFS，并且我们尝试使用 Windows Live 帐户登录。

```
C:\Users\Administrator>tf workspace /server:https://xxx.TFSURL.com /new site
TfsWorskpace -login:xxx@xxxx.com,password
TF30063: You are not authorized to access https://xxx.TFSURL.com/.
TF30063: You are not authorized to access https://xxx.TFSURL.com/. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T16:00:33.557

您需要在您的 TFS 预览帐户上启用基本身份验证支持。

查看[2012 年 8 月 27 日](http://tfspreview.com/en-us/home/news/2012/aug-27/)更新到 TFS 预览版的发行说明，了解如何设置它的分步说明。

# jquery - 如何单击链接并获取其颜色？

> ID：12217098
> 
> 赞同：10
> 
> 时间：2012-08-31T14:10:32.403
> 
> 标签：jquery, css, jquery-selectors, anchor

好的，所以这听起来很简单，使用 jquery 的“点击”功能。

问题是我想要链接的原始颜色而不是它的悬停颜色 - 例如，如果链接是绿色的，悬停状态为橙色，我要抓住绿色。

我已经尽我所能并在[小提琴中展示了它](http://jsfiddle.net/sVDYe/3/)

有人有什么想法吗？

**编辑：**抱歉，但正如许多鹰眼已经发现（感谢他们指出）绿色实际上是“rgb（0,128,0）”，而不是 rgb（0,255,0），如我原来的小提琴。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-31T14:14:28.347

将其存储在[jQuery 的`data`](http://api.jquery.com/data/)对象中：

```
$('a').each(function() {
    $(this).data('color', $(this).css('color') );
})
.click(function() {
    alert( $(this).data('color') );
}); 
```

这是你的小提琴：http: [//jsfiddle.net/sVDYe/4/](http://jsfiddle.net/sVDYe/4/)

* * *

为了获得更好的性能，我会在循环中使用[静态方法。](http://api.jquery.com/jQuery.data/)[他们更快](http://jsperf.com/jquery-method-vs-static)：

```
$('a').each(function() {
    $.data(this, 'color', $.css(this, 'color') );
}); 
```

这是小提琴：http: [//jsfiddle.net/sVDYe/13/](http://jsfiddle.net/sVDYe/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:21:23.943

试试下面的方法..

**演示**：http: [//jsfiddle.net/sVDYe/33/](http://jsfiddle.net/sVDYe/33/)

```
$("a").click(function(e) {
    e.preventDefault();
    var tmpLink =$(this).clone();
    tmpLink.appendTo($(this).parent());    
    var acolor = tmpLink.css("color");
    tmpLink.remove();

    if (acolor == 'rgb(255, 165, 0)') {
        alert('wrong color - its ORANGE =' + acolor);
    } else if (acolor == 'rgb(0, 128, 0)') {
        alert('CORRECT color - its GREEN =' + acolor);
    }
}); 
```

正如[pimvdb](https://stackoverflow.com/questions/12217098/how-to-click-on-a-link-and-get-its-color/12217307#comment16366398_12217098)指出的那样。绿色是`RGB(0,128,0)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:22:26.513

像这样试试

[http://jsfiddle.net/dadviegas/hfHBh/](http://jsfiddle.net/dadviegas/hfHBh/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:23:32.503

您可以使用 Jquery 而不是 css 处理颜色更改并将其存储：

[http://jsfiddle.net/sVDYe/20/](http://jsfiddle.net/sVDYe/20/)

```
var hoverColor;

$("a").hover(function () {
  hoverColor = $(this).css("color");
  $(this).css("color", 'orange');
}, function () {
  $(this).css("color", 'green');
});

$("a").click(function (e) {
  e.preventDefault();
  var acolor = hoverColor;
  if (acolor == 'rgb(255, 165, 0)') {
    alert('wrong color - its ORANGE =' + acolor);
  } else if (acolor == 'rgb(0, 128, 0)') {
    alert('CORRECT color - its GREEN =' + acolor);
  }
}); 
```

还有绿色是

> RGB(0, 128, 0)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-31T14:19:45.717

check this it will work for sure

```
<script>
    $("a").click(function () {
      $(this).toggleClass("colorclass");
    });
</script> 
```

# php - Welle's Wilder Accumulative Swing Index PHP 计算 - 无法返回正确的值

> ID：12217105
> 
> 赞同：0
> 
> 时间：2012-08-31T14:10:54.140
> 
> 标签：php, charts, stocks

我正在尝试获取 aapl 股票图表的累积摆动指数。我正在使用这个计算作为参考。

[http://www.barchart.com/education/std_studies.php?what=int_swing&hideheader=true#study](http://www.barchart.com/education/std_studies.php?what=int_swing&hideheader=true#study)

这是我到目前为止所写的。这应该返回 252.09 但我无法让它工作。

```
$asi[0] = -78.75
$ht = 584; // High today
$lt = 574.25; // low
$ct = 584.00; // close
$ot = 578; // open

$hy = 574; // High yesterday
$ly = 565.61;
$cy = 569.05;
$oy = 571.67;

$k = max(($hy-$ct),($ly-$ct));

$abc = array(($ht-$cy), ($lt-$cy), ($ht-$lt));
$max = max($abc);
$r = 0;
if($max == $abc[0]){
    $r = ($ht-$cy)-.5*($lt-$cy)+.25*($cy-$oy);
}elseif($max == $abc[1]){
    $r = ($lt-$cy)-.5*($ht-$cy)+.25*($cy-$oy);
}elseif($max == $abc[2]){
    $r = ($ht-$lt)+.25*($cy-$oy);
}else{
    echo "Error in welles accumulative swing index";
    exit;
}

$l = 3 //period;

$val = 50 * (($cy - $ct) + .5 *($cy - $oy) + .25*($ct-$ot)) / $r * $k / $l;

$asi[] = $asi[$i-1] + $val; 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:13:43.760

我试图逐个符号地新实现这个索引并得到不同的结果（swing：-248.7032967033）。可能是您的控制值错误？

那是我的代码：

```
class Swing
{
    public function calculate($high_price, $low_price, $close_price, $open_price, $t)
    {
        // (Ct-1 - Ct)
        $summand0 = ($close_price[$t-1] - $close_price[$t]);
        // 0.5(Ct-1 - Ot-1)
        $summand1 = 0.5 * ($close_price[$t-1] - $open_price[$t-1]);
        // 0.25(Ct - Ot)
        $summand2 = 0.25 * ($close_price[$t] - $open_price[$t]);

        $limit_move_default = 3.0;

        $r = $this->get_r_value($high_price, $low_price, $close_price, $open_price, $t);
        $k = $this->get_k_value($high_price, $low_price, $close_price, $t);

        $factor0 = 50.0 * ($summand0 + $summand1 + $summand2) / $r;
        $factor1 = $k / $limit_move_default;

        // SWING = 50 * ((Ct-1 - Ct)+ 0.5(Ct-1 - Ot-1)+ 0.25(Ct - Ot))/ R * K / M
        return $factor0 * $factor1;
    }

    public function get_k_value($high_price, $low_price, $close_price, $t)
    {
        // K= MAX(| Ht-Ct-1|, | Lt-Ct-1|)
        return max(
            abs($high_price[$t] - $close_price[$t-1]),
            abs($low_price[$t] - $close_price[$t-1]));
    }

    public function get_r_value($high_price, $low_price, $close_price, $open_price, $t)
    {
        // A. |Ht-Ct-1|
        $a = abs($high_price[$t] - $close_price[$t-1]);
        // B. |Lt-Ct-1|
        $b = abs($low_price[$t] - $close_price[$t-1]);
        // C. |Ht-Lt|
        $c = abs($high_price[$t] - $low_price[$t]);

        $max_value = max($a, $b, $c);

        $d = abs($high_price[$t] - $low_price[$t]);

        if($a == $max_value)
            // R= (| Ht-Ct-1|)-.5(| Lt-Ct-1|)+.25(| Ct-1-Ot-1|)
            return $a - 0.5 *  $b + 0.25 *  $d;

        if($b == $max_value)
            // R= (| Lt-Ct-1|)-.5(| Ht-Ct-1|)+.25(| Ct-1-Ot-1|)
            return  $b - 0.5 * $a + 0.25 *  $d;

        if($c == $max_value)
            // R= (| Ht-Lt|)+.25(| Ct-1-Ot-1|)
            return $c + 0.25 *  $d;
    }
};

$swing = new Swing();

$high_price = array(574.0, 584.0);
$low_price = array(565.61, 574.25);
$close_price = array(569.05, 584.0);
$open_price = array(571.67, 578.0);

$value = $swing->calculate($high_price, $low_price, $close_price, $open_price, 1);
echo("swing: $value \n"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-03T20:42:17.337

$d 看起来不对。

应该是 abs($close_price[$t-1] - $open_price[$t-1]);

# selenium - 使用 Selenium Webdriver 获取超时

> ID：12217113
> 
> 赞同：2
> 
> 时间：2012-08-31T14:11:32.550
> 
> 标签：selenium, webdriver, selenium-webdriver

我正在使用 Selenium WebDriver，它工作正常，今天如果我使用下面的代码或收到错误，我会超时`Unable to find element with id == //*[@id='ctl00_ContentPlaceHolder1_AddControl1_txtName']`

我尝试使用这个：

```
 public IWebElement GetElementId(string id)
    {
        //return Driver.FindElement(By.Id(id));
        Driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(TimeOut));
        return Driver.FindElement(By.Id(id));
    } 
```

并尝试了这个：

```
public IWebElement GetElementId(string id)
{
    WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(10));
    IWebElement category = wait.Until<IWebElement>((d) =>
    {
        return d.FindElement(By.Id(el_id));
    });
} 
```

我仍然不知道如何避免超时或未找到元素错误

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T15:40:17.613

尝试使用 FluentWait 类：

```
public WebElement fluentWait( final By locator ) {
    Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
        .withTimeout(30, TimeUnit.SECONDS)
        .pollingEvery(5, TimeUnit.SECONDS)
   .ignoring(NoSuchElementException.class, StaleElementReferenceException.class);

    // use a "custom" ExpectedCondition
    WebElement foo = wait.until( new Function<WebDriver, WebElement>() {
        public WebElement apply( WebDriver driver ) {
            return driver.findElement( locator );
        }
    });
    // usually use one of the built-in ExpectedCondtions
    // WebElement foo = wait.until(
    //     ExpectedConditions.visibilityOfElementLocated( locator );
    return  foo;
}; 
```

[您可以在此处](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/ui/FluentWait.html)阅读有关流利等待的信息

或者，如果您找到正确的定位器，则不彻底检查。

希望这对你有帮助）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T07:21:30.490

您正在使用 xpath，但在 findElement 中您正在使用 By.Id 将其更改为

```
By.xpath("//*[@id='ctl00_ContentPlaceHolder1_AddeCardControl1_txtName']")

                        OR

By.id("ctl00_ContentPlaceHolder1_AddeCardControl1_txtName") 
```

如果它仍然显示超时错误，请尝试在 xpath 中指定元素名称，例如

```
//div[@id='element_id'] 
```

因为像这样指定

```
//*[@id='ctl00_ContentPlaceHolder1_AddeCardControl1_txtName'] 
```

搜索所有元素的 id 属性可能会花费一些时间，因此如果您指定特定元素，则搜索时间将最小化。

如果它不起作用，请检查您的 xpath 是否正确。

# c# - 在 ASP.net 的 In-Proc 模式下可以存储的数据有什么限制？

> ID：12217118
> 
> 赞同：0
> 
> 时间：2012-08-31T14:11:35.477
> 
> 标签：c#, asp.net, asp.net-mvc, iis-7

有多种模式可以将会话数据存储在 ASP.net C# 应用程序中。其中之一是 InProc 模式。InProc 模式下可以保存的最大数据量的限制是多少？这是可配置的限制吗？

编辑：我知道这可能不酷，甚至听起来亵渎神明，但我处于一种独特的情况，我可能需要在会话中存储 10MB 文件。一次可能有几十个。因此问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:21:29.747

这是一个好问题还是一个可怕的问题取决于您是尝试为大量“瘦”会话（好的）计划容量还是计划将大量数据放入会话（坏）。

IIS 允许私有内存控制和虚拟内存控制。默认情况下这是无限的；如果您确实设置了限制，它可用于触发应用程序池回收。回收应用程序池可能是不可取的，例如 1000 个用户登录，达到内存限制，站点重新启动和每个人的[会话数据丢失](https://stackoverflow.com/questions/4277944/is-it-possible-to-recycle-iis-application-pools-without-losing-user-sessions)。请求限制可能更合适。

请记住，“为进程保留的数据存储量仅受操作系统可以在磁盘上获取的空间量的限制。” （[参考](http://blogs.msdn.com/b/ericlippert/archive/2009/06/08/out-of-memory-does-not-refer-to-physical-memory.aspx)）但是一旦你分页到磁盘，性能就会受到严重影响。@RB 关于导致大量网络流量的进程外“胖”会话的评论也是恰当的。

需要注意的是，[MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)提供了更精细的大小/过期控制。它与ASP.Net 使用的[非常相似。](http://msdn.microsoft.com/en-us/library/dd985642)根据您对 10MB 文件的评论，我建议您查看此选项。它将像会话一样在进程中运行（并且仍然受到与会话相同的内存限制），但您可以在一定程度上[控制它。](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.trim.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:14:02.680

您可以为 IIS7 中的每个应用程序池配置内存限制。但是我不确定您是否可以详细配置会话状态内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:14:29.540

会话中数据的长度或大小没有限制，只要服务器或主机有可用的内存即可。

# iphone - 自定义滚动指示器

> ID：12217120
> 
> 赞同：4
> 
> 时间：2012-08-31T14:11:39.127
> 
> 标签：iphone, objective-c, ios

有没有办法在 UIScrollView 中自定义滚动指示器（垂直或水平）。例如，更改它在滚动视图中的颜色或位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-07T11:10:22.530

首先，您必须在 Interface Builder 中取消选中 showVerticalIndicator 和 showHorizo​​ntallIndicator。

然后在`viewDidLoad`方法中添加：

```
[super viewDidLoad];    
self.scrollViewBarImgView = [[UIImageView alloc] init];
UIImage *imgBar = [UIImage imageNamed:@"scroller.png"];
[self.scrollViewBarImgView setImage:imgBar];
CGRect frame = scrollViewBarImgView.frame;
frame.size.width = 8;
frame.size.height = 60;
frame.origin.x = 312;
frame.origin.y = 0;
[self.scrollViewBarImgView setFrame:frame];

[self.tableView addSubview:scrollViewBarImgView]; 
```

然后在`- (void)scrollViewDidScroll`方法中：

```
CGPoint offset = scrollView.contentOffset;
CGRect frame = self.scrollViewBarImgView.frame;

float fact = (cellHeight*numberOfRow+ indicatorBarHeight) / tableViewHeight;

frame.origin.y = offset.y + (offset.y/fact);

[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.1];
[self.scrollViewBarImgView setFrame:frame];
[UIView commitAnimations]; 
```

这对我有用。

# javascript - 来自字符串离散域的连续色标？

> ID：12217121
> 
> 赞同：9
> 
> 时间：2012-08-31T14:11:38.993
> 
> 标签：javascript, d3.js, heatmap

我正在实现一个热图，其中单元格背景颜色由 d3 色标确定。一些值是分类的；它们的值可以是 N 个不同的任意字符串类型类别，例如 [“6TH”、“7TH”、“5TH”、“4TH”]。

给定一个起始颜色 d3.rgb("blue") 和一个结束颜色 d3.rgb("red")，如何构建将离散的字符串域映射到连续颜色范围的色标？

我试过了

```
var scale = d3.scale.ordinal()
    .domain(["6TH", "7TH", "5TH", "4TH"])
    .rangeBands( [ d3.rgb("blue"), d3.rgb("red") ] ); 
```

这显然是行不通的。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-31T21:22:43.937

首先，我会考虑使用现成的 Colorbrewer 量表之一；请参阅[colorbrewer2.org](http://colorbrewer2.org)。这些也可以在 D3 的 git 存储库中作为 JavaScript 和 CSS 文件使用；见[lib/colorbrewer](https://github.com/mbostock/d3/tree/master/lib/colorbrewer)。例如，如果您的域中有四个离散值，并且您想要一个红蓝发散量表，您可以说：

```
var color = d3.scale.ordinal()
    .domain(["6TH", "7TH", "5TH", "4TH"])
    .range(colorbrewer.RdBu[4]); 
```

（在此之前你也需要一个`<script src="colorbrewer.js"></script>`地方。） Colorbrewer 有各种精心设计的顺序、发散和分类色标。

如果您坚持滚动自己的色标，我强烈建议在[L*a*b* 或 HCL 颜色空间](http://bl.ocks.org/3014589)中进行插值以获得准确的感知。您可以使用[d3.interpolateLab](https://github.com/mbostock/d3/wiki/Transitions#wiki-d3_interpolateLab)或[d3.interpolateHcl](https://github.com/mbostock/d3/wiki/Transitions#wiki-d3_interpolateHcl)执行此操作。例如，`d3.interpolateLab("red", "blue")(.5)`返回介于红色和蓝色之间的颜色。

要计算序数比例范围的颜色，您可以使用插值器，或者您可能会发现临时线性比例更方便。例如：

```
var categories = ["6TH", "7TH", "5TH", "4TH"];

var color = d3.scale.ordinal()
    .domain(categories)
    .range(d3.range(categories.length).map(d3.scale.linear()
      .domain([0, categories.length - 1])
      .range(["red", "blue"])
      .interpolate(d3.interpolateLab))); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T15:00:36.290

你有正确的想法，你只需要处理每个 R/G/B 颜色通道。例如，在 vanilla JavaScript 中，您可以执行以下操作：

```
var a = [255, 0, 0], // First color
    b = [0, 0, 255], // Other color
    bands = 5,       // Bands is the length of your domain
    i, 
    delta = [];      // Difference between color in each channel

// Compute difference between each color
for (i = 0; i < 4; i++){
  delta[i] = (a[i] - b[i]) / (bands + 1);
}

// Use that difference to create your bands
for (i = 0; i <= bands + 1; i++){
  var r = Math.round(a[0] - delta[0] * i);
  var g = Math.round(a[1] - delta[1] * i);
  var b = Math.round(a[2] - delta[2] * i);
  console.log("<div style='background-color: #" + dec2hex(r) + dec2hex(g) + dec2hex(b) + "'>Band " + i + "</div>");
}

// A helper function for formatting
function dec2hex(i) {
  return (i+0x100).toString(16).substr(-2).toUpperCase();
} 
```

根据[d3 文档](https://github.com/mbostock/d3/wiki/Colors)`r`，您可以使用颜色对象的、`g`和`b`属性提取每个颜色通道：

> `# d3.rgb(color)`
> 
> 通过解析指定的颜色字符串构造新的 RGB 颜色。如果 color 不是字符串，则强制转换为字符串；因此，此构造函数还可用于创建现有颜色的副本，或强制将 d3.hsl 颜色转换为 RGB。
> 
> ...
> 
> 生成的颜色存储为 [0,255] 范围内的红色、绿色和蓝色整数通道值。通道可用作返回对象的 r、g 和 b 属性。

因此，在上面示例的顶部，您可以说：

```
var myColor = d3.rgb("blue"),
    a = [myColor.r, myColor.g, myColor.b],
... 
```

这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-09T17:35:43.850

您始终可以链接序数比例和线性比例。

第一个比例将从您的离散值创建可量化的值，第二个比例将在色标上插入这些值。

像这样的东西：

```
// Your categories
var data = ["6TH", "7TH", "5TH", "4TH"],

  // Define ordinal to linear scale...
  ordinal = d3.scale.ordinal().domain(data).rangePoints([0, 1]),

  // ...and linear to color scale
  linear = d3.scale.linear().domain([0, 1]).range([d3.rgb("blue"), d3.rgb("red")]);

// Now define your artificial 'compound' scale
function scale(d) {
  return linear(ordinal(d));
}

// And then use it on your D3 code
d3.selectAll('div')
  .data(data)
  .enter()
  .append('div')
  .style('background', scale) // <- et voilà ;)
  .text(function(d) {
    return d;
  });
```

```
div {
  color: white;
  width: 3em;
  padding: 1em;
  margin: .2em
  text-align: center;
  font-family: Arial, Helvetica, sans-serif;
  font-weight: bold
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
```

# android - 侦听更新并从服务器安装

> ID：12217122
> 
> 赞同：7
> 
> 时间：2012-08-31T14:11:44.343
> 
> 标签：android, android-intent, apk, updates

1.  首先我有一个服务器。我检查服务器是否有任何`new apk`文件我下载并尝试安装。
2.  如果服务器有，`new version of apk file`那么我想**更新我的 .apk 文件**。
3.  我想在**没有用户交互的情况下安装/更新**。这可能吗？
4.  如果需要用户交互，那么我该如何安装/更新 .apk 文件。

我对此没有更多的想法。

```
 Intent intent = new Intent(Intent.ACTION_VIEW);
             intent.setDataAndType(Uri.fromFile(new File(Environment.getExternalStorageDirectory() + "/download/" + "jarviz.apk")), "application/vnd.android.package-archive");
             intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

但这不起作用。当我调试时，我看不到任何错误，但它没有安装。我该怎么做。抱歉英语不好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T09:30:49.603

我以这种方式解决了这个问题。

```
String vsName=Environment.getExternalStorageDirectory().getAbsolutePath()+"/download/";
File file = new File(vsName, "jarviz.apk");
System.out.println(":"+file);
Intent install=new Intent(Intent.ACTION_VIEW);
install.setDataAndType(Uri.fromFile(file), "application/vnd.android.package-archive");
install.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(install); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:21:07.497

您的代码几乎是正确的，但您刚刚创建了意图。您还需要触发它以产生任何效果：

```
startActivity(intent); 
```

并确保按照您的意图将您的`jarviz.apk`确实下载到外部存储上的文件夹。`download/`

# java - 现有的 Java Web App 和 Spring STS (Spring 3)

> ID：12217124
> 
> 赞同：1
> 
> 时间：2012-08-31T14:11:55.500
> 
> 标签：java, spring, spring-mvc, sts-springsourcetoolsuite

是否可以将我一直在从事的项目导入 Spring STS 并将 STS 为轻松进行 Spring 开发而提供的所有好东西应用到项目中？例如，我希望能够采用这个目前不是 Spring MVC 应用程序的现有项目，并将其视为创建为 Spring MVC 模板（有点像将项目包装在 STS MVC 模板中）。我希望这是有道理的 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:33:46.400

据我所知，您不能仅通过将现有项目导入 STS 来用 Spring 好东西装饰现有项目。

您可以做的最好的事情是导入并添加 Spring 项目性质。这可以通过右键单击项目并选择 来找到`Spring Tools --> Add Spring Project nature`。

# php - 如何使用输入回发文本区域？

> ID：12217125
> 
> 赞同：0
> 
> 时间：2012-08-31T14:12:02.473
> 
> 标签：php, javascript, urlencode, url-encoding

我有一个带有一些文本区域的 HTML / Javascript 页面。用户正在使用 enter 输入他们的文本以创建新行。问题出在表单通过 ajax（具有 jQuery 的功能）提交给 PHP 时。收到文本但没有输入。

你如何将输入从 HTML textarea 传递给 PHP？

在这种情况下，我在 POST 中。

textarea内容如下

> 自卫队
> 
> 嗬嗬
> 
> "
> 
> '
> 
> ``
> 
> ||
> 
> @£¢¤¬¦²³³

但是 PHP 收到以下信息：

> asdféè ï"'``||@£¢¤¬¦²³³

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:15:00.690

You're probably not converting newlines into breaklines:

```
echo nl2br($_POST['myTextArea']); 
```

And to make it safe for output:

```
echo nl2br( htmlentities( $_POST['myTextArea'], ENT_QUOTES, "utf-8" ) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:14:42.233

`enter keys`正在保存，但它们被保留为不会`\n`在 HTML 中显示为换行符。您需要`nl2br()`在网页中显示内容。这会将`\n`换行符转换为`<br>`并在浏览器中正确显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:54:09.817

这是我用来解决此问题的 PHP 函数：

```
rawurldecode(utf8_decode($_POST['myTextArea'])) 
```

# c# - 任务 ContinueWith() 未更新 UI 线程上的光标

> ID：12217139
> 
> 赞同：5
> 
> 时间：2012-08-31T14:12:51.893
> 
> 标签：c#, task

我正在开发一个 WPF 应用程序，我只是想在任务运行之前和之后更改光标。我有这个代码：

```
this.Cursor = Cursors.Wait;

Task.Factory.StartNew(() => PerformMigration(legacyTrackerIds)).ContinueWith(_ => this.Cursor = Cursors.Arrow); 
```

光标确实变为等待光标，但在任务完成后它不会变回箭头。如果我在 ContinueWith() 方法中放置一个断点，它就会被命中。但光标不会变回箭头。为什么？

这是我尝试的旧方法。光标变回箭头，但我不想等待（）的任务。

```
this.Cursor = Cursors.Wait;

Task.Factory.StartNew(() => PerformMigration(legacyTrackerIds)).Wait();

this.Cursor = Cursors.Arrow; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T14:14:21.070

光标更改需要在 UI 线程上完成。您可以使用带有任务调度程序[的 ContinueWith 的重载：](http://msdn.microsoft.com/en-us/library/dd321428)

```
var uiScheduler = TaskScheduler.FromCurrentSynchronizationContext(); 

Task.Factory
  .StartNew(() => PerformMigration(legacyTrackerIds))
  .ContinueWith(_ => this.Cursor = Cursors.Arrow, uiScheduler); 
```

或者使用[Dispatcher.Invoke](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke.aspx)方法：

```
Task.Factory
  .StartNew(() => PerformMigration(legacyTrackerIds))
  .ContinueWith(_ => { Dispatcher.Invoke(() => { this.Cursor = Cursors.Arrow; }); }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:14:53.573

我认为您需要使用正确的同步上下文：

```
this.Cursor = Cursors.Wait; 

var uiScheduler = TaskScheduler.FromCurrentSynchronizationContext()); 

Task.Factory.StartNew(() => PerformMigration(legacyTrackerIds))
            .ContinueWith(_ => this.Cursor = Cursors.Arrow, uiScheduler); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T14:15:28.877

问题是延续需要在 UI 线程中运行。目前它正在后台线程中完成。

添加`TaskScheduler.FromCurrentSynchronizationContext()`到第二个参数`ContinueWith`以使其在 UI 线程中运行。

# javascript - 使用 Javascript 的单选按钮列表，每个列表选项返回自定义文本

> ID：12217142
> 
> 赞同：1
> 
> 时间：2012-08-31T14:13:00.090
> 
> 标签：javascript, wordpress, tinymce, radio-button

我正在为 Wordpress 制作一个自定义 TinyMCE 按钮，部分 Javascript 代码如下所示：

```
(function() {
    tinymce.create('tinymce.plugins.Green', {
        init : function(ed, url) {
            ed.addButton('green', {
                title : 'Prompt Text',
                image : url+'/images/btn_green.jpg',
                onclick : function() {                    
                    var prompt_text = prompt("Green Button", "Green Button Text");
                    var caret = "caret_pos_holder";
                    var insert = "<div>" + prompt_text + "</div><span id="+caret+"></span>";
                    if (prompt_text != null && prompt_text != 'undefined')
                    {
                        ed.execCommand('mceInsertContent', false, insert);
                        ed.selection.select(ed.dom.select('span#caret_pos_holder')[0]); //select the span
                        ed.dom.remove(ed.dom.select('span#caret_pos_holder')[0]); //remove the span
                    }
                }
            });
        },
        createControl : function(n, cm) {
            return null;
        },
    });
    tinymce.PluginManager.add('green', tinymce.plugins.Green);
})(); 
```

我想删除 prompt_text 函数并添加一个单选按钮列表，其中出现一个窗口，用户可以选择列表中的一个选项。并且每个列表项都应该有其独特的`insert`. **这怎么可能？**

例如，窗口应该有一个包含三个选项的列表：*Tea、Coffee、Water*。

如果用户选择 Coffee，它应该插入文本：`Coffee wakes you up`。

我对 Javascript 的了解非常有限，这阻止了我解决这个问题。但是，我认为这只能通过创建 jQuery 表单来实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T10:32:01.850

为此，您需要编写一个自己的插件。您应该查看开发人员 tinymce 构建并查看源代码，尤其是 searchreplace 插件。该插件使用 tinymce 弹出窗口，用户可以选择多个设置。我建议你复制那个插件，根据你的需要调整它并删除所有你不需要的东西。

# cocoa - NSTextField 中的文本标记

> ID：12217144
> 
> 赞同：0
> 
> 时间：2012-08-31T14:13:09.253
> 
> 标签：cocoa, nstextfield, nstextview, nstokenfield

我正在尝试创建一个 NSTextField 以允许批量重命名某些文件。该字段应该允许插入一些标记来自定义每个文件名。NSTokenField 的问题是 1）它修剪空白，这应该是允许的，2）它没有足够的功能来混合令牌和纯文本，例如，它应该识别令牌的开头，即使实际样式是纯文本。

现在我想子类化 NSTextField 或 NSTextView 来手动绘制我的标记，但是我怎样才能让每个标记都像单个字符一样？我可以以某种方式添加带有一些文本的 NSCell 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:25:50.750

“1）它修剪应该允许的空白” - 我认为这可以使用委托方法进行定制。

“2）......即使实际样式是纯文本，它也应该识别标记的开头” - 标记是标记。它*应该*是完全匹配或非令牌，因为您的用户实际上可能有一个令牌的子字符串作为对上帝诚实的文字。

# php - 无法在 codeigniter 中发布简单的表单日期

> ID：12217161
> 
> 赞同：0
> 
> 时间：2012-08-31T14:13:47.433
> 
> 标签：php, html, codeigniter

我敢肯定这是一个简单的忽略，但它在短时间内让我很头疼。

我试图从这个视图发布数据：

```
<?php
if (!$this->tank_auth->is_logged_in()) 
    {
        echo "<a href='index.php/auth/login'>Login</a>";
    } else { ?>
<form method="POST" action="create_community">
    <label>Community Name: </label><input type="text" name="communityname" value="231"/><br>
    <label>Description: </label><br><textarea name="communitydesc"></textarea><br>
    <label>Image Location(URL): </label><input type="text" name="imageloc"/><br>
    <input type="radio" name="privacy" value="public" /> public<br />
    <input type="radio" name="privacy" value="private" /> private<br />
    <input type="radio" name="privacy" value="business" /> business<br />
    <input type='submit'/>
</form>        
<?php    }
?> 
```

创建控制器如下：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Create extends CI_Controller {

    function __construct()
    {
        parent::__construct();

        $this->load->library('tank_auth');
        $this->load->library('encrypt');
        $this->load->library('session');

        $this->load->model('topbar_model');
        $this->load->model('left_model');
        $this->load->model('right_model');
        /*
        $this->load->model('right_model');
        $this->load->model('left_model');
        $this->load->model('topic_model');
        */
        $this->load->helper('url');
        $this->load->helper('form_helper');
        $this->load->helper('form');

        $this->load->helper(array('form', 'url'));
    $this->load->library('form_validation');
        $this->load->library('security');
        $this->load->library('tank_auth');
        $this->lang->load('tank_auth');
    }

    public function index()
    {
            $this->load->view('create_community');
    }

    public function create_community()
        {
            $this->load->view('templates/head');
            echo "testing"; 
            print_r($this->input->post());
        }

} 
```

create_community 显示“测试”但不显示帖子。我也尝试过发布个人输入内容，但一无所获。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:38:09.127

相信 $this->input->get_post() 是一个方法调用，而不是一个类变量，所以你不能像 $_POST[] 那样处理。

如果您想使用 POST 进行传统的表单处理，请使用标准的 $_POST[] assoc。数组，但请注意可能会包含一个 CSRF 字段，并且您需要处理。

另外，我不知道您是如何路由的，但您的表单操作不应该是“create/create_community”，除非您此时为所有呼叫路由“创建”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:16:43.427

```
public function create_community()
{
        var_dump($this->input->post());
} 
```

# c - 指向 const 指针的 const 指针

> ID：12217165
> 
> 赞同：2
> 
> 时间：2012-08-31T14:13:55.917
> 
> 标签：c, pointers, constants

我正在使用一些内存指针。我不想使用散列定义，请把讨论放在一边。我只想知道为什么这不能编译：

```
#include <stdio.h>

static const unsigned long *const pMemAddrA = (unsigned long *) 0x00000200ul;
static const unsigned long *const pMemAddrB = pMemAddrA;

int main (void)
{
    printf("%x", (unsigned int) pMemAddrB);
    return 0;
} 
```

编译器输出 gcc：

```
||=== TestConst, Debug ===|
 ...main.c|4|error: initializer element is not constant|
||=== Build finished: 1 errors, 0 warnings ===| 
```

编辑：

阅读答案后，我很高兴知道如何解决这个问题。

但是我不明白为什么这是一个问题。据我所知，静态内存是在程序启动时分配的。我知道如果变量“活”在不同的文件中，并且编译器不能保证变量的分配顺序，就会出现问题。但是，如果两个变量都“存在”在同一个文件中 - 就像两个变量都存在于同一个函数中一样 - 我认为编译器可以确保按照文件中声明的变量的顺序分配内存，因此我不会不明白为什么声明和初始化指向另一个 const 指针的 const 指针是一个问题。如果有人能启发我，我会很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:19:26.630

您的指针具有文件范围，因此初始化程序必须是常量表达式。`pMemAddrA`不是常量表达式，因此不能用于使用静态存储初始化变量。

它可用于在块范围内初始化变量，因此如果将声明移到内部`main`（并至少使第二个非静态），它将编译：

```
#include <stdio.h>

int main (void)
{

    const unsigned long *const pMemAddrA = (unsigned long *) 0x00000200ul;
    const unsigned long *const pMemAddrB = pMemAddrA;

    printf("%x", (unsigned int) pMemAddrB);
    return 0;
} 
```

如果必须在文件范围内声明这两个指针，则无法防止重复初始化表达式，

```
static const unsigned long *const pMemAddrA = (unsigned long *) 0x00000200ul;
static const unsigned long *const pMemAddrB = (unsigned long *) 0x00000200ul; 
```

或`#define`ing它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:19:36.607

你没有描述什么“不起作用”，但我猜你的意思是这条线

```
static const unsigned long *const pMemAddrB = pMemAddrA; 
```

产生错误

```
error: initializer element is not constant 
```

.

解决方案是确实这个初始化器不被认为是常数。相反，`pMemAddrA`会留出一个内存区域，并将值`0x00000200ul`写入其中。从那以后，它是一个存在于内存中某处的值，而不是一个常量表达式。

根据您想要执行的操作，您可以添加另一个指针间接，例如

```
static const unsigned long *const * const pMemAddrB = &pMemAddrA; 
```

`*pMemAddrB`并使用而不是访问它`pMemAddrB`。

# java - 圆弧方程 - 了解速度？

> ID：12217168
> 
> 赞同：0
> 
> 时间：2012-08-31T14:14:06.253
> 
> 标签：java, math, opengl

我在某个位置画了一个圆圈。我可以将速度设置为 10f 很好地移动它，但是当它开始转圈时它变得非常快。它显然没有以（单位/秒）移动，我不确定发生了什么。我认为`archSpeed`需要采用弧度或其他方式，这会减慢速度 - 但仍然不正确。这是我基于的圆弧方程：

```
s = r * theta 
```

以下是我正在使用的功能：

```
private void moveOut(double deltaTime)
{
    SetPosition(x += direction * speed * deltaTime, y, 0);

    if (x - (direction * GetWidth() / 2f) >= centerX + radius + GetWidth() / 2f)
    {
        //onOutside = true;
    }

    Log.d(TAG, "moving out");
}

private void circleCenter(double deltaTime)
{
    float angleSpeed = (float) (radius * (speed * Math.PI / 180) * deltaTime);
    currentAngle += angleSpeed;

    if (currentAngle >= 2 * Math.PI)
    {
        currentAngle = (float) (2 * Math.PI - currentAngle);
    }

    SetPosition(centerX + radius * FloatMath.cos(currentAngle), centerY + radius * FloatMath.sin(currentAngle), 0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:23:17.370

你的`angleSpeed`公式看起来不对。

我会先说我在那段时间旅行的距离是多少。你已经知道的答案是`speed*deltaTime`。现在你有一个距离，你可以通过使用弧形论坛来计算角度`arclength = radius*angle`。所以`angle = arclength/radius`。

把这两个放在一起得到

```
angle = speed*deltaTime/radius 
```

当然，这将以弧度为单位。

从本质上讲，这归结为您乘以半径而不是除以它的事实（以单位来查看它会有助于发现这一点，但这超出了编程论坛的范围）。

# c# - 带有代替触发器的实体框架

> ID：12217169
> 
> 赞同：7
> 
> 时间：2012-08-31T14:14:06.707
> 
> 标签：c#, entity-framework, triggers

我将 EF 与 SQL Server 数据库一起使用。我`Instead Of Insert`为该视图创建了一个视图和一个触发器，如下所示：

```
insert into Target (value, someFk) 
select value, 4 from inserted
select id from Target where @@ROWCOUNT > 0 and id = scope_identity() 
```

我将视图映射到 EF edmx。当我尝试添加实体时，调用时出现以下异常`SaveChanges()`：

> *无法更新 EntitySet 'TargetView'，因为它具有 DefiningQuery 并且元素中不存在支持当前操作的元素。*

该视图在映射中标记了一个标识列。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:24:41.003

如果您使用 xml 编辑器打开 EDMX 文件，在定义 TargetView 的部分中，您将有一些类似于以下的 xml；

```
<EntitySet Name=".."  
           EntityType=".." 
           store:Type="Views" 
           store:Schema=".." 
           store:Name="..">
<DefiningQuery>SELECT ....</DefiningQuery> 
```

您需要更改此 xml 部分才能进行 CRUD 操作；

```
<EntitySet Name=".."  
           EntityType=".."  
           store:Type="Tables" 
           Schema=".." /> 
```

# delphi - 如何下载 ask.fm 特定用户墙源代码以及所有问题和答案？

> ID：12217170
> 
> 赞同：4
> 
> 时间：2012-08-31T14:14:06.887
> 
> 标签：delphi, delphi-7

我正在尝试从用户个人资料中下载所有问题和答案，但是有一个问题，如果用户有大量问题，我必须单击“显示更多”以展开该列表。例如，如果我尝试下载这个人的问题和答案：[http](http://ask.fm/UnaRamekic) ://ask.fm/UnaRamekic （随机选择），我只会得到那些显示的，那些在我点击显示更多后显示的不是用获取请求检索的。我怎样才能得到ICS 或 Indy 组件的所有问题。谢谢。

我的代码：

```
procedure TForm1.sButton1Click(Sender: TObject);
begin
With HttpCli1 do begin
    URL            := sedit1.Text;
    RequestVer     := '1.1';
    RcvdStream := TMemoryStream.Create;
    try
        Get;
    except
        ShowMessage('There has been an error , check your internet connection !');
        RcvdStream.Free;
        Exit;
    end;

    RcvdStream.Seek(0,0);
    Memo1.Lines.LoadFromStream(RcvdStream);
    RcvdStream.Free;
 end;
 end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T22:56:13.500

单独使用 Indy 或 ICS 将无法做到这一点。您最初看到的正是您拉取 HTTP 请求时正在下载的内容。

如果您查看页面的 HTML 源代码，您会看到“查看更多”按钮附加了一个 JavaScript 事件处理程序，该处理程序向服务器发出 AJAX 请求，从中提取更多数据，并将其应用于页。如果你想做同样的事情，你的代码需要至少解析出足够的东西以获得正确的 AJAX 参数，然后像任何其他 HTTP 请求一样从你的 Indy 或 ICS 代码向服务器发出请求，并处理回来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T23:00:39.490

***警告：***

这种方法是蹩脚的，而且相当危险。它与“显示更多”按钮类似地发布表单数据，但它使用一个 while 循环（接收所有页面），该循环重复直到找到响应中的确切常量（在代码中它是`LastPageResponse`常量），所以当响应内容页面将在一段时间内更改，并且该常量不会出现在响应中，您会发现自己处于无限循环中。

在`GetAllQuestions`函数中，您可以指定：

*   AUser - 是 URL 中斜杠后的用户名
*   AFromDate - 是您想要从中获取结果的开始日期时间
*   AStartPage - 是您想要从中获取结果的 AFromDate 日期时间的起始页面

该`GetAllQuestions`函数返回一个基本用户的页面，后跟换行符分隔的内容，范围从基本页面到您指定的时间和页面中的所有页面。忘了注意，您需要以不同于基本页面的方式解析的附加内容，因为它不是 HTML 内容。

```
uses
  IdHTTP;

implementation

function GetAllQuestions(const AUser: string; AFromDate: TDateTime;
  AStartPage: Integer = 1): string;
var
  Response: string;
  LastPage: Integer;
  TimeString: string;
  HTTPClient: TIdHTTP;
  Parameters: TStrings;
const
  LineBreaks = sLineBreak + sLineBreak;
  LastPageResponse = '$("#more-container").hide();';
begin
  Result := '';
  HTTPClient := TIdHTTP.Create(nil);
  try
    Result := HTTPClient.Get('http://ask.fm/' + AUser) + LineBreaks;
    Parameters := TStringList.Create;
    try
      LastPage := AStartPage;
      TimeString := FormatDateTime('ddd mmm dd hh:nn:ss UTC yyyy', AFromDate);
      Parameters.Add('time=' + TimeString);
      Parameters.Add('page=' + IntToStr(LastPage));
      while LastPage <> -1 do
      begin
        Parameters[1] := 'page=' + IntToStr(LastPage);
        Response := HTTPClient.Post('http://ask.fm/' + AUser + '/more',
          Parameters);
        if Copy(Response, Length(Response) - Length(LastPageResponse) + 1,
          MaxInt) = LastPageResponse
        then
          LastPage := -1
        else
          LastPage := LastPage + 1;
        Result := Result + Response + LineBreaks;
      end;
    finally
      Parameters.Free;
    end;
  finally
    HTTPClient.Free;
  end;
end; 
```

以及用法：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  try
    Memo1.Text := GetAllQuestions('TLama', Now);
  except
    on E: Exception do
      ShowMessage(E.Message);
  end;
end; 
```

# slickgrid - slickgrid 在过滤器打开时选择行会忘记以前的选择

> ID：12217173
> 
> 赞同：0
> 
> 时间：2012-08-31T14:14:18.930
> 
> 标签：slickgrid

我有一个很大的列表，我在其中实现了过滤。我希望用户能够选择一些行，过滤列表，选择更多，更改过滤器，选择更多，并保留所有选择。

我正在关注这个例子： http: [//mleibman.github.com/SlickGrid/examples/example4-model.html](http://mleibman.github.com/SlickGrid/examples/example4-model.html)

请按照以下步骤查看我的问题：

1.  点击第 0 行
2.  按住 Shift 并单击第 10 行。现在选择第 0 到第 10 行。
3.  将滑块向上移动大约 90%，因此仅显示 0 - 10 行中的几行。（对我来说，2、6 和 8 仍然显示并且仍然被选中。）
4.  Ctrl-单击未选择的行（对我来说，第 29 行）
5.  将过滤器滑回零。

现在看到了这个问题。对我来说，只选择了第 2、6、8 和 29 行。我希望 0 到 10 和 29 保持选中状态。有没有获得这种行为的选项？如果没有，有人可以推荐一种可能有效的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T13:45:57.330

诀窍是：

1.  为每个选定的行保存一些指示
2.  在构建过滤数据时，请注意在数组中选择了哪些行
3.  在“setGridData”之后调用“setSelectedRows”

这是执行此操作的代码。

```
// filter grid without harming selection
// grid: a SlickGrid Object
// filter: a function that receieves a "data row" and returns true if it meets the filter
function filterGrid(grid,filter) {
    var oldline;
    var olddata=grid.getData();
    var oldselection=grid.getSelectedRows()

    var newline=0;
    var newdata=[];
    var newselection=[];

    for (oldline=0; oldline<olddata.length ; oldline++ ) {
      if (filter(olddata[oldline]) {
        newdata.push(olddata[oldline]);
        if (oldselection.indexOf(oldline)>-1) { // note on condition: ECMA5 - in IE8 you will need to loop
          newselection.push(newline);
          newline++;
        }
      }
    }

    grid.setData(newdata);
    grid.setSelectedRows(newselection);
    grid.updateRowCount();
    grid.render();      
} 
```

请注意，此代码不会保留未通过过滤器的选定行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-31T11:09:07.757

这个问题已经在[Github](https://github.com/mleibman/SlickGrid/pull/718)上解决了。

*   首先，添加一个变量来存储 id。
    *   var selectedIds=[];
*   二、修改syncGridSelection
    *   DataView.syncGridSelection(grid, true, true, function(syncIds) { selectedIds = syncIds;});

# c# - Linq OrderBy 不排序原始集合吗？

> ID：12217175
> 
> 赞同：6
> 
> 时间：2012-08-31T14:14:27.210
> 
> 标签：c#, winforms, linq, linq-to-sql

我第一次使用 Linq To Sql 作为我的数据库层，我遇到了一个问题。基本上，我有一个允许用户创建预定义作业的表单。一个预定义的作业可以有许多预定义的作业项。例如，预定义的工作可能类似于换油。预定义的工作项目将是石油、劳动力等。在我的数据库中，PredefinedJobs 是一个表，PredefinedJobItems 是另一个表，其外键返回 PredefinedJobs。我有一个用于添加预定义作业的表单，该表单具有支持该表单的 Linq-to-Sql 类作为类变量。表单上有一个 ListView，显示所有作业项。一项新功能要求我在 ListView 中跟踪项目的位置。例如，如果我的项目 ListView 如下所示，请注意顺序：

```
Qty          Name          Desc          ItemOrder
4            Oil           Penzoil       0
1            Labor                       1 
```

因为这些项目是通过子窗体添加的，所以我不想提供对 ListView 的访问。因此，我创建了下面的方法，试图创建 ItemOrder 并对 PredefinedJob Linq to Sql 对象上的集合进行排序。List 上的 OrderBy 函数似乎并未实际对 PredefinedJob 上的集合进行排序。维护 Linq to Sql 集合（即 PredefinedJob.fkJobItems）的顺序的最佳方法是什么？或者，将我的 ListView 的引用传递到子表单中，将项目添加到我可以访问 selectedIndex 的作业中会更好吗？

```
 private SortAndOrderItems(List<PredefinedJobsItem> items)
    {
        var nextItemOrderNumber = items.Max(max => max.ItemOrder) + 1;
        foreach (var item in items)
        {
            if (item.ItemOrder == null)
            {
                item.ItemOrder = nextItemOrderNumber;
                nextItemOrderNumber++;
            }
        }
        items.OrderBy(i => i.ItemOrder).ToList();
    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T14:33:42.880

`OrderBy`创建一个新查询，该查询在执行时不会更改您的原始列表。

为什么不只是 的[`Sort`](http://msdn.microsoft.com/en-us/library/w56d4y5z.aspx)方法`List`？

```
items.Sort((a, b) => a.ItemOrder.CompareTo(b.ItemOrder)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:33:26.463

我想你在找**[`List<>.Sort`](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)**

```
class Cmp : IComparer<PredefinedJobsItem>
{
    public int Compare(PredefinedJobsItem x, PredefinedJobsItem y)
    {
        return x.ItemOrder.CompareTo(y.ItemOrder);
    }
}

var comparison = new Cmp();
items.Sort(comparison); 
```

# objective-c - 多重减少增加应用程序

> ID：12217177
> 
> 赞同：0
> 
> 时间：2012-08-31T14:14:28.787
> 
> 标签：objective-c, xcode, development-environment

我已按照本教程进行操作： [http ://www.thetutorialblog.com/cocoa-objective-c/creating-a-basic-ipad-application/](http://www.thetutorialblog.com/cocoa-objective-c/creating-a-basic-ipad-application/)

但现在我的应用程序中需要多个该功能。我知道我可以为彼此编写代码，但这会花费我很长时间。有谁知道我怎样才能更轻松地做到这一点？

我想要这样：

```
- 0 +    - 0 +
- 0 +    - 0 +
- 0 +    - 0 +
- 0 +    - 0 +
- 0 +    - 0 +
- 0 +    - 0 +
- 0 +    - 0 +
- 0 +    - 0 + 
```

但更多...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:28:21.187

打开`TutorialViewController.xib`。从库中拖动多个标签和多个按钮。
将这两个步骤应用于所有按钮和标签
1\. 按住 Control 并单击 File's Owner 对象并将其拖到标签上，然后选择 currentNumber；// 对于所有标签
2\. 现在从减号和加号按钮转到文件的所有者对象，并为减号按钮选择 decrementNumber，为加号减号和加号按钮选择 incrementNumber。// 所有按钮

# c# - 无法使用 Fakes 程序集构建项目

> ID：12217182
> 
> 赞同：13
> 
> 时间：2012-08-31T14:14:44.880
> 
> 标签：c#, unit-testing, microsoft-fakes

我已经在我的 Visual Studio 2012 单元测试项目中添加了一个 Fakes 程序集，对应于我的应用程序项目（被测系统），如[Peter Provost 的文章中所述](http://www.peterprovost.org/blog/2012/04/15/visual-studio-11-fakes-part-1)。但是，由于生成的 Fakes 代码中存在未解析的类型引用，该项目将不再构建：

```
The type or namespace name 'FieldDefinition' does not exist in the namespace 'bc::ProductStudio' (are you missing an assembly reference?)
[C:\Users\arvek\Projects\Project\Project.Tests\obj\Debug\Fakes\bc\f.csproj]
C:\Users\arvek\Projects\Project\Project.Tests\f.cs 
```

这里出了什么问题？据我所知，这应该可以正常工作，所以在我看来，Fakes 设施中存在错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-04-21T04:46:23.967

这个错误也存在于 VS2013 中。[链接](http://connect.microsoft.com/VisualStudio/feedback/details/809792/could-not-load-project-assembly-for-microsoft-fakes-generation)到 MSDN 错误。

*解决方法：*****从 FakeAssemblies 文件夹中删除文件 .messages。****

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T16:35:53.747

该错误很可能是由于伪造的程序集触发的 Fakes 中的错误。我已将问题提交给 Microsoft。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-10T05:06:33.133

可以帮助您诊断问题的一种选择是为您的假货打开诊断。在您的 .fakes 文件上。

```
<Fakes xmlns="http://schemas.microsoft.com/fakes/2011" Diagnostic="true" Verbosity="Noisy"> 
```

此外，请确保您的“MSBuild 项目构建输出详细程度”设置为诊断。您可以在工具 -> 选项 -> 项目和解决方案 -> 构建和运行中找到它。

重建你的测试项目，现在你的输出窗口应该充满信息，包括任何失败的假货

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-26T08:32:11.860

删除**Fakes**文件夹将解决此问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-15T05:11:50.560

你不会相信这一点，但我只需在文件中添加一个新行，删除该新行，然后保存实际上是未修改的文件，就可以让假货再次工作。在下一次构建之后，一切都很好。

让你走的东西……嗯……**

# module - 如何实现 Prestashop 前端控制器

> ID：12217183
> 
> 赞同：1
> 
> 时间：2012-08-31T14:14:44.503
> 
> 标签：module, controller, seo, prestashop

对不起我的英语不好。

我正在开发一个 Prestashop 模块来在前端的一个块中列出服务。该模块已完成，但这使用了丑陋的 URL，例如“ [http://www.mysite.com/modules/servicescatalog/showservicedata.php?srvId=1](http://www.mysite.com/modules/servicescatalog/showservicedata.php?srvId=1) ”

这个模块的客户写信给我，让这个 URL 对 SEO 友好，比如“ [http://www.mysite.com/modules/servicescatalog/showservicedata/service-1](http://www.mysite.com/modules/servicescatalog/showservicedata/service-1) ”

在谷歌搜索我认为解决方案是实现一个前端控制器，但我不知道如何管理它。有谁知道如何实施？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T17:05:32.530

只需在模块文件夹中创建一个新的 .htaccess 文件

.htacces 示例

```
<IfModule mod_rewrite.c>
# URL rewriting module activation
RewriteEngine on
RewriteRule ^showservicedata/service-([0-9]+)$ showservicedata.php?srvId=$1 [L]
</IfModule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T07:54:29.593

如果你想制作`SEO url`你的模块，然后去`Preference tab > SEO & URL`添加新的。使用您想要的设置模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-15T14:36:47.987

看看这里。它有关于添加自定义前端控制器的详细说明。

[https://www.prestashop.com/forums/topic/342774-add-custom-php-page-prestashop-16/](https://www.prestashop.com/forums/topic/342774-add-custom-php-page-prestashop-16/)

# java - 像 PHP 中的私有 void 函数（整数 [] a，字符串 str = ""）

> ID：12217184
> 
> 赞同：6
> 
> 时间：2012-08-31T14:14:49.070
> 
> 标签：java, php

> **可能重复：**
> [Java 是否支持默认参数值？](https://stackoverflow.com/questions/997482/does-java-support-default-parameter-values)

有没有可能做这样的事情

```
private void function(Integer[] a, String str = "") 
```

就像在 PHP 中一样。如果我不提供 str，它将是空的。在 PHP 中它是可能的，在 JAVA 中它给了我错误。或者这里唯一的解决方案是创建两个这样的方法？

```
private void function(Integer[] a, String str)
private void function(Integer[] a) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:16:16.540

确切地说，除了：

```
private void function(Integer[] a, String str) {
    // ...
}

private void function(Integer[] a) {
    function(a, "");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:19:03.433

声明你的方法`var agrs`

`private void function(Integer[] a, String... s)`

请记住，var args 应该始终是方法的最后一个参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:16:09.510

是的，您必须使用第二种方法。

```
private void function(Integer[] a, String str)
private void function(Integer[] a) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:16:20.827

这确实是实现这一目标的唯一方法，没有使用[**可变长度方法参数列表**](http://www.deitel.com/articles/java_tutorials/20060106/VariableLengthArgumentLists.html)。

**例子：**

```
private void function(Integer[] a, String... str) {

  for( String s : str )
  {
    System.out.println("String: " + s);
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T14:16:58.573

类似于这篇文章：

[Java 是否支持默认参数值？](https://stackoverflow.com/questions/997482/does-java-support-default-parameter-values)

Java 不处理此功能。

# java - 带有 JOCL 的 Java OpenCL：什么是直接缓冲区？

> ID：12217199
> 
> 赞同：0
> 
> 时间：2012-08-31T14:15:31.423
> 
> 标签：java, opencl, jocl

当我在 clEnqueueReadBuffer 上进行试验时，我遇到了一个异常：

线程“main”中的异常 java.lang.IllegalArgumentException：只能使用指向直接缓冲区的指针执行非阻塞读取操作

在这条线上：

```
 ec.add(clEnqueueReadBuffer(commandQueue, zCacheMem, false, 0, Sizeof.cl_int*numWords, zCachePtr, 0 , null, readEvents[0])); 
```

其中 zCacheMem 是 cl_mem，zCachePtr 指向一个 int[]

我找不到任何解释此错误的文档。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-11T18:08:31.623

是的，您需要使用 ByteBuffer.allocateDirect() 分配缓冲区，或者使用 JOCL 的分配器函数。

如果将 java 分配的数组（如 byte[] 或 int[] 包装到 Buffer 中，它将不起作用。

直接缓冲区可能直接映射到设备的地址空间。这些以某种方式在 JVM 之外。

非直接缓冲区在 Java 堆中分配并由 JVM 管理（并受垃圾收集器等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:17:28.610

Direct [ByteBuffer](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html)是一种在本机内存和 Java 之间有效地交换数据的常用方法。实际上，它们是 malloc 内存的包装器。

# r - 如何选择行组并存储到变量？

> ID：12217200
> 
> 赞同：3
> 
> 时间：2012-08-31T14:15:33.517
> 
> 标签：r

我目前使用以下代码输入 csv 文件，根据一列绘制数据点并将 CpK 数存储到变量中。此代码用于计算整个数据集的 CpK，并且图表也适用。我现在正在寻找计算数据集中每个月的 CpK 数（不需要绘图）。我查看了 data.table 文档以及其他 R 文档，但我很难只选择每个月的数据。

**当前代码：（**我可以用一个公式计算 CpK，但我故意将其分解）

```
mydf <- read.csv('ID35.csv', header = TRUE, sep=",")
date <- strptime(mydf$DATETIME, "%Y/%m/%d %H:%M:%S")
plot(date,mydf$AVG,xlab='Date',ylab='AVG',main='Data')
abline(h=mydf$MIN,col=3,lty=1)
abline(h=mydf$MAX,col=3,lty=1)
grid(NULL,NULL,col="black")
legend("topright", legend = c(" ", " "), text.width = strwidth("1,000,000"), lty = 1:2, xjust = 1, yjust = 1, title = "Points")
myavg <-mean(mydf$AVG, na.rm=TRUE)
newds <- (mydf$AVG - myavg)^2
newsum <- sum(newds, na.rm=TRUE)
N <- length(mydf$AVG) - 1
newN <- 1/N
total <- newN*newsum
sigma <- total^(1/2)
USL <- mean(mydf$MAX, na.rm=TRUE)
LSL <- mean(mydf$MIN, na.rm=TRUE)
cpk <- min(((USL-myavg)/(3*sigma)),((myavg-LSL)/(3*sigma)))
cpk 
```

这是数据集的样子（日期格式已经完成）：

mydf（仅 24/1000 行）：

```
Code           DATETIME AVG MIN TARG_AVG MAX
N9 2012/04/10 14:03:37   0.2647     0.22     0.25     0.27
NA 2012/03/30 07:48:17   0.2589     0.22     0.25     0.27
NB 2012/03/24 19:23:08   0.2912     0.22     0.25     0.27
NB 2012/03/25 16:10:17   0.2659     0.22     0.25     0.27
NC 2012/04/10 00:58:29   0.2622     0.22     0.25     0.27
ND 2012/04/14 18:32:52   0.2600     0.22     0.25     0.27
NG 2012/04/21 14:47:47   0.2671     0.22     0.25     0.27
NH 2012/04/09 20:31:17   0.2648     0.22     0.25     0.27
NL 2012/04/24 07:28:17   0.2527     0.22     0.25     0.27
NP 2012/04/23 13:26:50   0.2640     0.22     0.25     0.27
NQ 2012/04/14 20:30:42   0.2590     0.22     0.25     0.27
NS 2012/05/02 09:09:52   0.2651     0.22     0.25     0.27
NU 2012/05/04 13:07:49   0.2688     0.22     0.25     0.27
NV 2012/05/19 23:07:08   0.2716     0.22     0.25     0.27
NX 2012/05/03 02:00:13   0.2670     0.22     0.25     0.27
NY 2012/05/04 12:56:52   0.2680     0.22     0.25     0.27
NZ 2012/05/06 10:05:38   0.2697     0.22     0.25     0.27
O0 2012/05/07 22:01:11   0.2675     0.22     0.25     0.27
O3 2012/06/21 18:09:47   0.2606     0.22     0.25     0.27
04 2012/06/21 18:47:36   0.2545     0.22     0.25     0.27
51 2012/07/24 21:13:08   0.2541     0.22     0.25     0.27
O5 2012/07/26 16:54:09   0.2575     0.22     0.25     0.27
O6 2012/07/20 02:42:29   0.2603     0.22     0.25     0.27
OD 2012/08/25 20:56:55   0.2559     0.22     0.25     0.27
OH 2012/08/28 10:30:11   0.2372     0.22     0.25     0.27 
```

从上面的表格中，我只关心两列是 DATETIME 和 AVG。一旦我有了每个月的新“myavg”变量，我就可以使用相同的公式来计算 CpK 数。我认为变量名称可能类似于“2012/08”我认为代码应该类似于：

```
for(each month mydf$DATETIME) (date like 2012/04*,2012/05*)
monthavg <-(mydf$AVG, na.rm=TRUE) 
```

有没有办法将每个月的 CpK 数字存储在我可以访问的变量中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:15:35.433

```
aggregate(mydf$AVG, list(month=months(as.Date(mydf$DATETIME))), mean)

#    month         x
# 1  April 0.2618125
# 2 August 0.2465500
# 3   July 0.2573000
# 4   June 0.2575500
# 5  March 0.2720000
# 6    May 0.2682429 
```

# php - 在 PHP 代码中获取日期选择器的值

> ID：12217201
> 
> 赞同：-1
> 
> 时间：2012-08-31T14:15:33.793
> 
> 标签：php, javascript, date

我有一个包含日期选择器的表单。日期选择器工作正常，但是当我想将其值提交给 PHP 脚本时，它不会显示。这是我的 HTML 代码的相关部分：

```
<body>
    <form action="sub.php" method="post">
        <h2>JsDatePick's Javascript Calendar usage example</h2>

        Look at the comments on the HTML source to fully understand how this very simple example works.

        <input type="text" size="12" id="inputField" name="inputField" />
        <input type="submit" value="submit">
    </form>
</body> 
```

我想从`inputField`这个脚本中选择日期值：

```
<?php
    echo $date=$_POST['inputField'];
?> 
```

那么你们能告诉我如何从 HTML 到 PHP 脚本中获取这个值吗？我没有显示日期选择器的代码，因为它工作正常。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:24:38.187

```
<?php
    $date = $_POST['inputField'];
    echo $date;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-16T22:05:43.463

这是日期选择器

```
<form action="" method="POST">
  <input type="date" name="date">
  <input type="submit" name="submit" value="submit">
</form> 
```

您需要启动和运行的所有 PHP 代码就是这个

```
<?php
  if(isset($_POST['submit'])) {
      $date = $_POST['date'];
      echo $date;
  }

?> 
```

此代码 `$date = $_POST['date'];`获取日期选择器的值

这段代码`echo $date;`会打印出您选择的日期

# c++ - C++：ios::app 在 fstream 中不需要 ios::out

> ID：12217202
> 
> 赞同：0
> 
> 时间：2012-08-31T14:15:35.883
> 
> 标签：c++, fstream

前几天我正在使用文件流对象中的标志进行测试

我做到了。

```
fstream binf("h.txt", ios::app);
binf << "hey"; 
```

使用fstream，因为我没有使用`ios::out`，所以输出操作不应该起作用，但它确实起作用了

我注意到输出操作`ios::app`仅适用于但如果我使用任何其他标志而没有`ios::out`它不起作用

谁能告诉我为什么我只能在`ios::app`不使用的情况下输出到文件`ios::out`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:18:22.787

好吧，附加意味着写作，这是我能想到的最长的解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:21:35.637

使用`app`暗示`out`。

该标准规定`app`和`out|app`具有相同的结果，相当于 C fopen in mode `"a"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:04:55.887

这个答案更特定于编译器，但令人惊讶的是：-

* * *

> **VS 2010** `fstream` :- **ios_base::out 标志已设置**

```
explicit basic_ofstream(const char *_Filename,
        ios_base::openmode _Mode = ios_base::out,
        int _Prot = (int)ios_base::_Openprot)
        : _Mybase(&_Filebuffer)
        {   
        if (_Filebuffer.open(_Filename, _Mode | ios_base::out, _Prot) == 0)
            _Myios::setstate(ios_base::failbit);
        } 
```

* * *

> **GCC 4.5** `fstream` :- **ios_base::out 标志再次已设置**

```
explicit
      basic_ofstream(const char* __s,
             ios_base::openmode __mode = ios_base::out|ios_base::trunc)
      : __ostream_type(), _M_filebuf()
      {
    this->init(&_M_filebuf);
    this->open(__s, __mode);
      }

void
      open(const char* __s,
       ios_base::openmode __mode = ios_base::out | ios_base::trunc)
      {
    if (!_M_filebuf.open(__s, __mode | ios_base::out))
      this->setstate(ios_base::failbit);
    else
      this->clear();
      } 
```

更有趣的是，只有`ios_base::in`最后一位是一个。这`1`表示`ios_base::in`即使举起旗帜也能保持其身份`ios_base::out`。

# python - 为什么 Python 中的某些列表方法只适用于已定义的变量？

> ID：12217203
> 
> 赞同：3
> 
> 时间：2012-08-31T14:15:50.750
> 
> 标签：python, list, python-2.7

```
>>> a = [1, 2, 3]
>>> a.append(4)
>>> a
[1, 2, 3, 4] 
```

但：

```
>>> [1, 2, 3].append(4)
>>> 
```

为什么[`list`](http://docs.python.org/tutorial/datastructures.html)Python 中的方法（例如`insert`和`append`）只适用于已定义的变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T14:16:52.790

在第二个示例中，没有打印任何内容，因为`append`在列表上调用了 （**请注意实际上执行了附加**），返回`None`。

或者，您应该提到这`a.append(4)`也给了您一个空白行（如您的第一个示例所示），并且第一个代码示例的最终输出是表达式结果的`a`表示，而不是`a.append('4')`表达式。

在这两种情况下，调用后都不会打印任何内容`append`，因为它是`None`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-31T14:17:10.617

`list.append`返回`None`。 `a.append('4')`也没有打印任何东西，因为返回的东西`None`不会在交互式解释器中打印任何东西......

请注意，您的第二个方法调用*确实有效*。它附加`'4'`到列表中，您将永远看不到它，因为您会立即失去在您创建的列表中拥有的任何句柄。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-31T14:20:58.187

它确实有效。它只是不打印任何东西，就像不打印任何东西一样`a.append(4)`。只是因为您将列表保存为变量，您才能显示其新值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:21:12.070

并不是列表方法仅适用于已定义的变量。就是 list的指定方法***append***在更改相关列表的内部状态时总是返回 None 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T14:20:08.913

Another way to concatenate lists:

```
>>> [1, 2, 3] + [4]
[1, 2, 3, 4] 
```

Note that in this case, a new list is created and returned. `list.append` adds an item to an existing list and does not return anything.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-31T14:23:28.740

该函数仅适用于已定义的变量，因为这就是它的缩进工作方式。从[python 文档](http://docs.python.org/tutorial/datastructures.html)中：

> list.append(x)
> 
> 在列表末尾添加一个项目；相当于`a[len(a):] = [x]`。

请注意，在返回值并且函数不会引发异常的意义上，它确实“起作用”。但是结果会丢失，因为您没有参考修改后的列表。

* * *

顺便说一句，一些语言强制命名约定以明确函数修改给定对象。例如，Ruby 和 Scheme 会附加一个`!`- 所以在这种情况下该函数可能会被调用`append!`。这样的命名约定有助于使函数的意图更加清晰。

# facebook-social-plugins - 社交登录个人资料图片大小

> ID：12217204
> 
> 赞同：1
> 
> 时间：2012-08-31T14:15:53.813
> 
> 标签：facebook-social-plugins, user-profile

我正在尝试从社交网站（如 google、facebook、linkedin 等）获得不同的图像尺寸...

我只有关于 facebook 的数据 .. [https://graph.facebook.com/](https://graph.facebook.com/) /picture?type=SIZE ,

方形 小 正常 大

但是对于 google、twitter、LinkedIn，我们如何才能获得不同的图像尺寸呢？

谢谢，维杰

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T22:58:55.533

Linkedin 个人资料图片大小为 80x80。您可以通过此调用检索原始照片尺寸：`http://api.linkedin.com/v1/people/~/picture-urls::(original)`请注意，这可以是任何尺寸，因此您需要在您身边进行缩放，但图像是用户上传的原始图像。

Twitter 个人资料图片大小为：

*   更大 - 73 像素 x 73 像素
*   正常 - 48 像素 x 48 像素
*   迷你 - 24 像素 x 24 像素
*   原始 - 未定义。这将是图像最初上传的大小。原始图像的文件大小可能非常大，因此请谨慎使用此参数。

（来源：[https](https://dev.twitter.com/docs/api/1/get/users/profile_image/:screen_name) ://dev.twitter.com/docs/api/1/get/users/profile_image/:screen_name ）

使用 Google+，您可以通过以下调用获得所需大小的个人资料图片：`https://plus.google.com/s2/photos/profile/<user_id>?sz=<your_desired_size>`

# c# - 在 Silverlight 应用程序中使用相对路径访问客户端 Bin 中文件的正确方法

> ID：12217215
> 
> 赞同：0
> 
> 时间：2012-08-31T14:16:23.743
> 
> 标签：c#, .net, silverlight-5.0, relative-path, bin

我有一个从silverlight 应用程序的客户端调用的WCF 服务，我向它传递了一个字符串文件名参数和一个包含xml 的字符串参数。在服务方法中，我构造了一个包含 xml 字符串的 XDocument 实例，然后将其保存到服务器上 ClientBin 文件夹中的一个文件中。我一直在使用绝对路径，现在正在尝试切换到相对路径，但不确定如何正确执行。我的代码如下所示：

```
public void WriteXmlToServer(string filename,string xmlString)
{
    //xml document to hold the information for the group that is registered
    XDocument xDoc = new XDocument(XDocument.Parse(xmlString.ToString())); 

    XDocument DataInFile = new XDocument();

    try
    {
        xDoc.Save(Path.Combine("..\\ClientBin\\", filename));
        //the complete absolute path to the .xml file ->C:\Users\Me\Documents\Visual Studio 11\Projects\SL_xMonitor_Frontend_RefactorV1_Backup82212\SL_xMonitor_Frontend_RefactorV1.sln       
    }
    catch (FileNotFoundException e)
    {     
        Console.WriteLine(e.InnerException.ToString());
    }
} 
```

我目前收到此异常消息：

```
System.IO.DirectoryNotFoundException was unhandled by user code
  HResult=-2147024893
  Message=Could not find a part of the path 'C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\ClientBin\ServerGroups.xml'. 
```

有人可以指导我在 Silverlight 应用程序中使用客户端 bin 中文件的相对路径的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T16:51:50.287

尝试单一`.`而不是`..`as`..`意味着在下降到所需目录之前备份一个目录级别，其中 as`.`意味着从当前目录开始，然后下降到所需目录。

# css - 流体布局的 Em 与 px 设置

> ID：12217217
> 
> 赞同：0
> 
> 时间：2012-08-31T14:16:29.063
> 
> 标签：css, fonts, em

我正在阅读有关最佳字体大小和布局大小的信息……并且我正在研究 em 而不是 px。

据我了解，如果我像这样制作CSS；

```
html {
font-size: 16px;
}

body {
    font-size: 1em;
} 
```

它将强制浏览器使 16px = 1em，这将使我能够通过计算所需的像素/16 来执行宽度和高度属性，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:21:56.090

几乎所有浏览器都将默认字体大小设置为 16px。

因此，如果您只是在您的 body 标签上设置 font-size:100% ，那么您将是金色的。

这是一个很好的网站，我用它来根据您的基本尺寸计算字体大小：

[http://riddle.pl/emcalc/](http://riddle.pl/emcalc/)

在设置选项卡中，只需将其更改为 16px 即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:32:07.620

你是对的，@Billy Moat 也是如此。

通过在 HTML 元素上显式声明 16px 值，您并没有真正获得任何收益——浏览器无论如何都倾向于这样做。

您可以使用的另一个技巧是“62.5%”技巧。

如果您声明：

```
body { font-size: 62.5% } 
```

您可以在 em 中进行进一步的声明，以整齐地映射到像素测量值。例如：

```
h1 { font-size: 3em; /* equals 30px */ }
h2 { font-size: 2.4em; /* equals 24px */ }
.nav { width: 50.5em /* equals 505px */ } 
```

那是因为 10/16 = .625。因此，通过这个技巧，您可以重新调整您的测量值，而不必在以后处理 16px 基数时进行数学运算。

这种方法的唯一技巧是，一旦为元素声明了字体大小，所有子元素的 em 值都必须基于该父元素的值（所有相对测量单位都是如此）。

# java - FileService中的变量锁是什么意思？

> ID：12217221
> 
> 赞同：1
> 
> 时间：2012-08-31T14:16:43.400
> 
> 标签：java, google-app-engine

[FileService.html#openReadChannel](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/files/FileService.html#openReadChannel%28com.google.appengine.api.files.AppEngineFile,%20boolean%29)中的变量布尔*锁*是什么意思？

当我尝试使用*false*时，我得到了一个非法状态异常，而当我使用*true*时，我没有得到任何异常。我正在尝试上传文件。

这个论点有什么作用？我已经阅读了文档，但没有理解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:19:00.233

根据该页面，它说

> lock - 是否应该锁定文件以进行独占访问？

因此，它基本上会询问您是否应该是唯一可以访问它的人。

如果您使用`false`，那么您可能会在其他人有权访问时尝试写入它。我假设在几乎所有情况下，您都需要`true`，因为通常一次只有一个进程写入文件。

# wso2 - 丰富要插入消息正文的中介者无效对象类型

> ID：12217227
> 
> 赞同：1
> 
> 时间：2012-08-31T14:16:58.963
> 
> 标签：wso2, wso2esb

错误：丰富中介 要插入消息正文的无效对象类型

尝试丰富消息时，这是代理配置：

```
<proxy xmlns="http://ws.apache.org/ns/synapse" name="Database" transports="https,http" statistics="disable" trace="disable" startOnLoad="true">
   <target>
      <inSequence>
         <dblookup>
            <connection>
               <pool>
                  <password>1234</password>
                  <user>root</user>
                  <url>jdbc:mysql://localhost:3306/new_db</url>
                  <driver>com.mysql.jdbc.Driver</driver>
               </pool>
            </connection>
            <statement>
               <sql>select * from users where name="rik"</sql>
               <result name="client_expiration" column="expiration" />
               <result name="client_id" column="id" />
               <result name="client_name" column="name" />
            </statement>
         </dblookup>
         <log level="custom">
            <property name="returned value for client_expiration is :" expression="get-property('client_expiration')" />
            <property name="returned value for client_id is :" expression="get-property('client_id')" />
            <property name="returned value for client_name is :" expression="get-property('client_name')" />
         </log>
         <property name="property1" expression="get-property('client_expiration')" scope="default" />
         <enrich>
            <source type="property" property="property1" />
            <target type="body" action="sibling" />
         </enrich>
         <sequence key="getback" />
      </inSequence>
   </target>
</proxy> 
```

和序列配置（但不应该是这里的问题）：

```
<sequence xmlns="http://ws.apache.org/ns/synapse" name="getback">
   <header name="To" action="remove" />
   <property name="RESPONSE" value="true" scope="default" />
   <send />
   <log level="full" />
</sequence> 
```

提前谢谢了！！

**编辑**：日志有效，但消息无效。这是日志文件：

```
[2012-09-03 09:44:28,853]  INFO - LogMediator returned value for client_expirati
on is : = 2012-08-30, returned value for client_id is : = 1, returned value for
client_name is : = rik
[2012-09-03 09:44:28,854] ERROR - EnrichMediator Invalid Object type to be inser
ted into message body
[2012-09-03 09:44:28,856]  INFO - LogMediator To: , WSAction: urn:mediate, SOAPA
ction: urn:mediate, MessageID: urn:uuid:f0035921-8b6a-48db-a9a4-78be2687336d, Di
rection: response, Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Enve
lope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body /><
/soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T15:58:18.983

有这样的丰富调解员并尝试

```
<enrich>
            <source type="custom" xpath="get-property('property1')"/>
            <target type="body" action="sibling"/>
        </enrich> 
```

# android - com.android.nfc_extras 的文档？

> ID：12217231
> 
> 赞同：4
> 
> 时间：2012-08-31T14:17:09.670
> 
> 标签：android, nfc

显然，如果您有一部有根电话，您可以利用它`com.android.nfc_extras`来访问卡模拟（[ICS 4.0.4 上的安全元素访问控制](https://stackoverflow.com/questions/10494726/secure-element-access-control-on-ics-4-0-4/10506299#10506299)）等功能。

我知道这是一个非官方的 API，但是否有任何文档（官方或非官方）？或者另一方面，卡模拟是否比我意识到的要复杂得多？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T22:40:47.540

请记住，访问安全元件和进行卡模拟实际上是两件不同的事情。安全元件基本上是封闭的；你不能修改它。使用`com.android.nfc_extras`您可以通过安全元件打开或关闭卡模拟。而已。

您可以从您的应用程序将 APDU 发送到安全元素，例如与`IsoDep`标签通信（在 NFC 堆栈的较低级别部分，两者都使用相同的代码路径）。参见例如[http://nelenkov.blogspot.nl/2012/08/accessing-embedded-secure-element-in.html](http://nelenkov.blogspot.nl/2012/08/accessing-embedded-secure-element-in.html)以获得如何做的一个很好的解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T18:17:38.320

没有文档。如果您想深入研究此 API，我建议您直接查看源代码。它并不多，只是实现和定义 API 的两个文件。例如，您可以在此处获取副本：

[http://source-android.frandroid.com/frameworks/base/nfc-extras/java/com/android/nfc_extras/](http://source-android.frandroid.com/frameworks/base/nfc-extras/java/com/android/nfc_extras/)

在 API 中，您会发现 ExecutionEnvironment、Routes 等概念。不要让这些概念迷惑您。最后，您可以使用 NfcExtras 界面执行以下操作：

*   通过设置使用 ROUTE_ON_WHEN_SCREEN_ON 创建的路由来打开卡仿真。

*   通过设置“关闭”路由关闭卡仿真。

*   与嵌入式安全元件交换数据。

而已！其余的只是让事情看起来比实际更大的 API 糖。

一些额外的警告：

*   如果要调用函数，则需要将应用程序列入 /etc 中的 nfcee_access.xml 文件的白名单。如果您不将自己列入白名单，您将获得访问冲突异常。

*   您无法区分手机中的嵌入式安全元件或支持 NFC 的 UICC。

*   无法与手机中支持 NFC 的 UICC 通话。您只能与嵌入式安全元件（即带有 NXP 芯片组的手机的 SmartMX 芯片）交谈。与 UICC 本身的通信只能通过 ISO7816 接口通过 RID 接口进行，而且这 - 如果可能的话 - 是专有的。

*   最后但同样重要的是：不能保证 NfcExtras 接口会做任何事情。界面是谷歌钱包用的，但移动支付市场是细分的，大家自己煲汤。我知道至少有一家大型移动支付提供商完全忽略了 NfcExtras 界面，将其禁用并使用他自己的隐藏机制来打开和关闭。

# ios - 字典数组或带数组的字典？

> ID：12217236
> 
> 赞同：0
> 
> 时间：2012-08-31T14:17:22.210
> 
> 标签：ios, json, nsarray, nsdictionary, nsjsonserialization

这是我的 php 页面中的 json。这是一个字典数组还是只是一个字典，里面有一个键和字典？我认为这是第二种选择，但我不确定，因为我得到了相互冲突的选择。一旦它在 xcode 调试器中显示，结构也会改变吗？

```
{
    "slots": {
        "2012-08-31 00:00:00 America/Los_Angeles": [
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-30 17:00:00 America/Los_Angeles",
                "end": "2012-08-30 17:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-30 17:30:00 America/Los_Angeles",
                "end": "2012-08-30 18:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": false,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-30 18:00:00 America/Los_Angeles",
                "end": "2012-08-31 00:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": false,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 00:00:00 America/Los_Angeles",
                "end": "2012-08-31 08:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 08:00:00 America/Los_Angeles",
                "end": "2012-08-31 08:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 08:30:00 America/Los_Angeles",
                "end": "2012-08-31 09:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 09:00:00 America/Los_Angeles",
                "end": "2012-08-31 09:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 09:30:00 America/Los_Angeles",
                "end": "2012-08-31 10:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": false,
                "isReserved": true,
                "label": "Joe Smith",
                "begin": "2012-08-31 10:00:00 America/Los_Angeles",
                "end": "2012-08-31 12:30:00 America/Los_Angeles",
                "span": 5
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 12:30:00 America/Los_Angeles",
                "end": "2012-08-31 13:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 13:00:00 America/Los_Angeles",
                "end": "2012-08-31 13:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 13:30:00 America/Los_Angeles",
                "end": "2012-08-31 14:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 14:00:00 America/Los_Angeles",
                "end": "2012-08-31 14:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 14:30:00 America/Los_Angeles",
                "end": "2012-08-31 15:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 15:00:00 America/Los_Angeles",
                "end": "2012-08-31 15:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 15:30:00 America/Los_Angeles",
                "end": "2012-08-31 16:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 16:00:00 America/Los_Angeles",
                "end": "2012-08-31 16:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 16:30:00 America/Los_Angeles",
                "end": "2012-08-31 17:00:00 America/Los_Angeles",
                "span": 1
            }
        ],
        "2012-09-01 00:00:00 America/Los_Angeles": [
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 17:00:00 America/Los_Angeles",
                "end": "2012-08-31 17:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 17:30:00 America/Los_Angeles",
                "end": "2012-08-31 18:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": false,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-08-31 18:00:00 America/Los_Angeles",
                "end": "2012-09-01 00:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": false,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 00:00:00 America/Los_Angeles",
                "end": "2012-09-01 08:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 08:00:00 America/Los_Angeles",
                "end": "2012-09-01 08:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 08:30:00 America/Los_Angeles",
                "end": "2012-09-01 09:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 09:00:00 America/Los_Angeles",
                "end": "2012-09-01 09:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 09:30:00 America/Los_Angeles",
                "end": "2012-09-01 10:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 10:00:00 America/Los_Angeles",
                "end": "2012-09-01 10:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 10:30:00 America/Los_Angeles",
                "end": "2012-09-01 11:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 11:00:00 America/Los_Angeles",
                "end": "2012-09-01 11:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 11:30:00 America/Los_Angeles",
                "end": "2012-09-01 12:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 12:00:00 America/Los_Angeles",
                "end": "2012-09-01 12:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 12:30:00 America/Los_Angeles",
                "end": "2012-09-01 13:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 13:00:00 America/Los_Angeles",
                "end": "2012-09-01 13:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 13:30:00 America/Los_Angeles",
                "end": "2012-09-01 14:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 14:00:00 America/Los_Angeles",
                "end": "2012-09-01 14:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 14:30:00 America/Los_Angeles",
                "end": "2012-09-01 15:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 15:00:00 America/Los_Angeles",
                "end": "2012-09-01 15:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 15:30:00 America/Los_Angeles",
                "end": "2012-09-01 16:00:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 16:00:00 America/Los_Angeles",
                "end": "2012-09-01 16:30:00 America/Los_Angeles",
                "span": 1
            },
            {
                "isPending": false,
                "isReservable": true,
                "isReserved": false,
                "label": "&nbsp;",
                "begin": "2012-09-01 16:30:00 America/Los_Angeles",
                "end": "2012-09-01 17:00:00 America/Los_Angeles",
                "span": 1
            }
        ]
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:20:53.427

看看这里： http: [//www.json.org/](http://www.json.org/)

基本上你有一个字典`slots`，里面有多个对象。键看起来是这样的东西`2012-08-31 00:00:00 America/Los_Angeles`。这些键包含字典数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:22:11.253

您能做的最好的事情就是尝试一下！你会比在这里问更少的时间！无论如何，你有：

```
 - dictionary, with a "slot" key that has an associated value:
    - dictionary, with a "2012-08-31 00:00:00 America/Los_Angeles" key that that has an associated value:
       - array, containing objects:
          - dictionary1
          - dictionary2
          - .... 
```

因此，例如，要访问第二个元素的 isPending 属性：

```
[[[[dict objectForKey:@"slot"] objectForKey:@"2012-08-31 00:00:00 America/Los_Angeles"] objectAtIndex:1] valueForKey:@"isPending"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:20:10.180

The `[` and `]` around the dictionaries seems to suggest it's an array of dictionaries.

Or rather, an `Array` inside a `Dictionary` inside a `Dictionary`. The first paragraph only addresses the innermost structures.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:30:34.843

您可能会发现在此处使用 NSLog 进行调试很有用。

假设你想知道你的类是 NSArray、Dictionary 还是其他类。一旦你传递了 JSON 数据。要查看您返回的内容，只需将其注销。

```
[NSLog(@" JSON data is kind of class %@", [NSStringFromClass([jsonData Class]); 
```

这将告诉您 json 数据是什么类。

您也可以使用相同的方法来确定下一项是字典还是像这样的数组

```
[NSLog(@" JSON data is kind of class %@",  [NSStringFromClass([[jsonData objectAtIndex:i]Class]); 
```

但纯粹从观察来看，我会说你有一本字典数组字典

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-31T17:13:31.487

这是我的做法。

```
for (NSString *slotKey in myslots.allKeys) {
    NSDictionary *slot = [myslots valueForKey:slotKey];
        NSArray *tests = [myslots objectForKey:slotKey];
    for (NSDictionary *myDict in tests){
        NSLog(@"%@", [myDict objectForKey:@"begin"]); 
    }
    } 
```

# jquery - 在 Tumblr 上用砖石破坏无限卷轴

> ID：12217242
> 
> 赞同：4
> 
> 时间：2012-08-31T14:17:42.137
> 
> 标签：jquery, html, scroll, tumblr, infinite

我正在研究一个 tumblr 主题，我试图将砖石与无限滚动结合起来。虽然砖石工程，但只要我添加无限滚动，事情就会开始破裂。第二页内容出现在第一页内容的后面，当我单击“下一页”时，它会将我带到第 2 页，而不是在第 1 页底部加载新元素。

我尝试通读无限滚动和砖石文档，查看 StackOverflow 上的类似问题，并使用我的 HTML 结构和 Javascript 设置，但到目前为止我一点运气都没有。有人可以看看我的代码并让我知道我做错了什么吗？我想要发生的是当用户单击“下一页”时，页面 2 中的新元素会加载到底部。

这是我的测试 tumblr 网址：[http](http://masoninfinite.tumblr.com/) : //masoninfinite.tumblr.com/，这是我的代码的 pastebin：http: [//pastebin.com/KnbxNnES](http://pastebin.com/KnbxNnES)，我也会在下面发布。我非常感谢我能得到的任何帮助。

```
<html>
<head>
    <title>{Title}</title>
    <link rel="shortcut icon" href="{Favicon}">
    <link rel="alternate" type="application/rss+xml" href="{RSS}">
    {block:Description}
        <meta name="description" content="{MetaDescription}" />
    {/block:Description}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
    <script src="http://static.tumblr.com/bpwficy/Ahjm97maz/masonry.js"></script>
    <script type="text/javascript" src="http://codysherman.com/tools/infinite-scrolling/code"></script>

    <script>

    $(function(){

      var $container = $('#container');

      $container.imagesLoaded( function(){
        $container.masonry({
          itemSelector : '.post',
          columnWidth : 300,
          gutterWidth: 30,
          isAnimated: true
        });
      });

          $container.infinitescroll({
            navSelector  : '.navigation',    // selector for the paged navigation 
            nextSelector : '.nav-previous a',  // selector for the NEXT link (to page 2)
            itemSelector : '#container .post',     // selector for all items you'll retrieve
            },

            // call Masonry as a callback
                function( newElements ) {
                    var $newElems = $( newElements ).css({ opacity: 0 });
                    // ensure that images load before adding to masonry layout
                    $newElems.imagesLoaded(function(){
                    // show elems now they're ready
                    $newElems.animate({ opacity: 1 });
                    $container.masonry( 'appended', $newElems, true ); 
                });
            }
          );
        });

</script>

    <style>

    #container { border: 1px solid blue; width: 960px; margin: 0px auto; }

    .post { margin-bottom: 20px; border: 1px solid red; width: 300px; background: #ccc; }

    img { width: 200px; height: 200px; }

    </style>
</head>
<body>
    <h1>{Title}</h1>

    {block:Description}
        <p id="description">{Description}</p>
    {/block:Description}

    <div id="container">
            <div class = "autopagerize_page_element" >
    <ol id="posts">
        {block:Posts}
            {block:Text}
                <li class="post text">
                    {block:Title}
                        <h3><a href="{Permalink}">{Title}</a></h3>
                    {/block:Title}

                    {Body}
                </li>
            {/block:Text}

            {block:Photo}
                <li class="post photo">
                    <img src="{PhotoURL-500}" alt="{PhotoAlt}"/>

                    {block:Caption}
                        <div class="caption">{Caption}</div>
                    {/block:Caption}
                </li>
            {/block:Photo}

            {block:Photoset}
                <li class="post photoset">
                    {Photoset-500}

                    {block:Caption}
                        <div class="caption">{Caption}</div>
                    {/block:Caption}
                </li>
            {/block:Photoset}

            {block:Quote}
                <li class="post quote">
                    "{Quote}"

                    {block:Source}
                        <div class="source">{Source}</div>
                    {/block:Source}
                </li>
            {/block:Quote}

            {block:Link}
                <li class="post link">
                    <a href="{URL}" class="link" {Target}>{Name}</a>

                    {block:Description}
                        <div class="description">{Description}</div>
                    {/block:Description}
                </li>
            {/block:Link}

            {block:Chat}
                <li class="post chat">
                    {block:Title}
                        <h3><a href="{Permalink}">{Title}</a></h3>
                    {/block:Title}

                    <ul class="chat">
                        {block:Lines}
                            <li class="{Alt} user_{UserNumber}">
                                {block:Label}
                                    <span class="label">{Label}</span>
                                {/block:Label}

                                {Line}
                            </li>
                        {/block:Lines}
                    </ul>
                </li>
            {/block:Chat}

            {block:Video}
                <li class="post video">
                    {Video-500}

                    {block:Caption}
                        <div class="caption">{Caption}</div>
                    {/block:Caption}
                </li>
            {/block:Video}

            {block:Audio}
                <li class="post audio">
                    {AudioPlayerBlack}

                    {block:Caption}
                        <div class="caption">{Caption}</div>
                    {/block:Caption}
                </li>
            {/block:Audio}
        {/block:Posts}
    </ol>
    </div>

    </div>

    <p id="footer">
    <div class="navigation">
        {block:PreviousPage}
            <a href="{PreviousPage}">&#171; Previous</a>
        {/block:PreviousPage}

        {block:NextPage}
        <div class="nav-previous">
            <a href="{NextPage}">Next &#187;</a>
        </div>
        {/block:NextPage}
    </div>

        <a href="/archive">Archive</a>
    </p>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:55:07.130

想通了我的问题，我准备打自己耳光。

我使用了一些 Tumblr 特定的无限滚动代码（http://codysherman.com/tools/infinite-scrolling/code），而不是来自infinite-scroll.com 的实际无限滚动代码。

# c# - 将自定义的 Linq-2-SQL 迁移到实体框架

> ID：12217243
> 
> 赞同：5
> 
> 时间：2012-08-23T12:46:04.197
> 
> 标签：c#, entity-framework, linq

我在 .net 3.5 中有一个基于 Linq-2-SQL 的数据层。我们正在考虑迁移到 .Net 4。很快。当我们开始最初的开发时，我对将 EF 用于数据层很感兴趣，但发现它在 .Net 3.5 中并不是一个真正的选项。现在我们正在升级，我正在重新考虑。

我意识到 .Net4 仍然支持 L2S，但是我很想切换到更活跃的开发领域，以便将来验证一个可能在相当长一段时间内成为业务核心的系统。（我的理解是基于诸如“我们说我们将改进它的核心 (L2S) 并在有意义的地方添加客户请求但实体框架将是主要关注点。”来自 Damien Guard 在[这篇文章](http://damieng.com/blog/2009/06/01/linq-to-sql-changes-in-net-40)的评论中的陈述.

更复杂的是，我们对 L2S 实现做了一些修改：

*   我们对 .tt 生成文件进行了相当程度的定制，并稍微定制了 L2ST4。
*   我们将存储过程用于所有 CRUD 操作（我们自动生成），因为这允许我们根据需要打开/关闭特定表上的细粒度审计跟踪。

我知道我们使用的其他大部分内容都可以，因为我自己在 EF4 中完成了它（实际上很多都是在 EF4 数据库上开始的），但我想知道上述自定义是否会问题。

所以：

*   我们还能有一个定制的 .tt 类型生成系统（或类似的东西）吗？
*   我们仍然可以将我们自己定义的存储过程用于 CRUD 吗？

注意：如果我们使用 EF，我可能会使用 Database First 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:29:51.300

> 我们还能有一个定制的 .tt 类型生成系统（或类似的东西）吗？

是的。在 VS 2012 中，您可以使用[`DbContext`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbcontext%28v=vs.103%29.aspx)生成器，该生成器使用 T4 模板来生成您的`DbContext`持久性无知的类。

添加它并将其指向您的 edmx 文件后，您可以修改模板以自定义输出。

如果您使用的是 VS.NET 2010，则可以[从 Visual Studio Gallery 安装 EF 5.x DbContext Generator for C# extension](http://visualstudiogallery.msdn.microsoft.com/da740968-02f9-42a9-9ee4-1a9a06d896a2)以安装模板生成器并将其添加到 VS.NET 的“添加项目”菜单中。

> 我们仍然可以将我们自己定义的存储过程用于 CRUD 吗？

是的，这只是将概念模型（您在 edmx 文件中使用的内容）映射到物理模型（数据库的表示）的问题。在映射中，您将指定存储过程，而不是动态完成它。

[Julie Lerman 在 MSDN 文档中标题为“实体框架中的存储过程](http://msdn.microsoft.com/en-us/data/gg699321.aspx)”的部分详细介绍了如何将 CRUD 操作映射到存储过程。

# php - MYSQL PHP脚本抛出语法错误

> ID：12217246
> 
> 赞同：1
> 
> 时间：2012-08-31T14:17:51.060
> 
> 标签：php, mysql, syntax

这是一个小的代码示例，它给了我一个 MySQL 语法错误。Connect.php 正在连接到正确的数据库，并且可以与其他项目和代码一起使用。我知道 connect.php 中的代码是正确的。它给了我一个 MySQL 语法错误。它没有提供比这更详细的信息：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以`key`在第 1 行的 'keys WHERE ='xxxxxxxxxxxx''附近使用正确的语法

我从主项目中提取了这个小代码示例，它仍然抛出错误。

```
<?php
    require "connect.php";          
    $keyCheck = mysql_query("SELECT * FROM keys WHERE `key`='".$_POST['betakey']."'" , $con);

    if (!$keyCheck) {
        echo mysql_error();
        exit;
    } else {
        $keyRows = mysql_num_rows($keyCheck);
    if ($keyRows == 0) {
        echo "This key is invalid!";
        exit;
    }
?> 
```

**编辑：**我让管理员重命名表，你们帮我解决了一些潜在的安全隐患。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T14:20:16.893

I'm fairly sure `keys` is a reserved word. In any case, you should always enclose database, table and column names in backticks. Not just "sometimes" as you have in this example. Always.

[Source](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html).

# ruby-on-rails - 选择一个随机的回形针附件

> ID：12217249
> 
> 赞同：0
> 
> 时间：2012-08-31T14:18:00.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有“foo”控制器，除此之外还有 3 个回形针附加图像。

foo.image1、foo.image2 和 foo.image3

在视图中呈现每次重新加载页面时都会刷新的随机附件的最佳方法是什么？

- 编辑 - -

好的，这不是很优雅的代码，但至少避免使用 send 并服务于我的目的。

```
 @a = foo.image1(:thumb) 
    @b = foo.image2(:thumb)
    @c = foo.image3(:thumb)

    @rand = ([@a, @b, @c].sample) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:37:10.583

在您的控制器中，您可以执行以下操作：

```
@image = foo.send([:image1, :image2, :image3].sample) 
```

这样做是随机选择（采样）与图像名称相对应的符号，然后发送该符号`foo`以执行。结果存储在实例变量中，然后可以在您的视图中使用。

只要每次有人点击你的动作时都这样做（例如，如果它在一个`show`动作中或其他东西中），那么它总是会随机选择一个新图像，即使在刷新时也是如此。

# ruby - 从对象中存储和检索变量

> ID：12217254
> 
> 赞同：3
> 
> 时间：2012-08-31T14:18:25.703
> 
> 标签：ruby

我想从对象中存储和检索一些变量。例如在`a`

```
a = "a" 
```

到目前为止，我找到了两种可能的方法。

*   使用`instance_variable_set`和`instance_variable_get`

    ```
    a.instance_variable_set(:@x, 10)
    a.instance_variable_get(:@x) # => 10 
    ```

*   或者只是使用`instance_eval`

    ```
    a.instance_eval { @y = 5 }
    a.instance_eval { @y } # => 5 
    ```

第二种方法对我来说看起来更短更简单，如果我更喜欢这个，我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T14:22:28.700

速度不是一切，但是......该`instance_variable_set`方法比使用`instance_eval`. 如果您有兴趣，这里有一个基准：[https ://gist.github.com/1268188](https://gist.github.com/1268188)

这是另一篇文章，它给出了尽可能避免使用的另一个很好的理由`instance_eval`：[Alex Kliuchnikau on instance_eval](https://stackoverflow.com/a/9038663/1177119)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:57:42.677

如果没有充分的理由（例如元编程），最好避免使用 instance_variable_get(set)，因为它会**破坏封装**。您可以参考 ruby​​-doc: 从而使课程作者试图提供适当封装的努力受挫。

而使用 instance_eval 的最佳实践是编写 DSL 样式：

假设你有一个带有实例方法的 Engineer 类：program、play 和 sleep。所以，

```
sb = Engineer.new

sb.program
sb.play
sb.sleep

# is equivalent to
sb.instance_eval do
  program
  play
  sleep
end 
```

在这种情况下，它更短:)

# windows-phone-7 - 在 windows phone 7 设备上使用下划线模板引擎的可能问题

> ID：12217260
> 
> 赞同：1
> 
> 时间：2012-08-31T14:18:56.703
> 
> 标签：windows-phone-7, backbone.js, underscore.js, zepto

有人对使用 windows phone 7 的 underscore.js 内置模板引擎有问题吗？

当涉及到这一行时，我的应用程序停止运行：

```
var Template = {
         loadingWheel:        _.template($("#loading_wheel").html())
}; 
```

将执行该行之前的 alert() ，之后不会发生 alert() ，所以我认为这是关于下划线模板的事情。我已经尝试将 Template 重命名为其他名称，我想这与保留名称或其他内容无关。

#loading_wheel 是一个内联脚本标签模板，如下所示：

```
<script type="text/template" id="loading_wheel">
  <div class="loading">
    <img src="/images/loading.gif" />
   </div>
</script> 
```

嗯，很简单，不是吗？

我正在使用 Backbone.js 0.9.2、Underscore.js 1.3.3 和 Zepto 1.0。该应用程序适用于多个 iO 4+5、Android 2.3、2.6、4.0、4.1 和黑莓设备。只是 Windows Phone 7 没有显示任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T15:43:09.803

事实证明，问题不是下划线特定的，而是由 zepto 框架引起的，显然不支持 windows phone 浏览器。

这就是这行代码失败的原因：

```
 _.template($("#loading_wheel").html()) 
```

使用 jquery 可以正常工作（但会多加载 65KB）。

# .htaccess - .htaccess mod_rewrite with multiple variable in url

> ID：12217261
> 
> 赞同：0
> 
> 时间：2012-08-31T14:18:57.947
> 
> 标签：.htaccess, mod-rewrite

I'm using a search that create a query string for MySQL and show the result. The thing is that the query doesn't have the same length of variable each time a search is made.

I was wondering if in .htaccess it's possible to make a mod_rewrite depending on how much variable I throw at it.

Instead of having this in the URL

```
results.php?var1=something&var2=something&var3=..... 
```

I get this

```
results/var1/something/var2/something/var3/something... 
```

But remember that the numbers of vars can change depending on which checkboxes are checked by the user on the search form.

I hope it's clear if not I'll try to add more example.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:42:11.780

在文档根目录的 htaccess 文件中尝试此操作：

```
RewriteEngine on
RewriteRule ^results/([^/]+)/([^/]+)(.*)$ /results/$3?$1=$2 [L,QSA]
RewriteRule ^results/$ /results.php [L,QSA,R] 
```

只要`/var/something`URI 中有对，第一条规则就会循环，并不断将它们附加到查询字符串中。当最终没有更多对时，将`results/`被重写为`results.php`.

# sql-server-2008 - SQL query to find out third highest salary involving two tables

> ID：12217262
> 
> 赞同：0
> 
> 时间：2012-08-31T14:18:58.607
> 
> 标签：sql-server-2008

I have two tables:

**Persons:**

```
empid(primary key)
firstname
lastname
email

```

**Details:**

```
Did(primary key)
salary
designation
empid

```

Now I want to select firstname, lastname, salary of the employee with the 3rd highest salary.

KEEP IT SIMPLE SINCE I AM A BEGINNER.

Also it would be great if you can suggest me a site where I can find SQL query exercises with solutions (I do not need an online interpreter, I have SQL Server 2008 to practice on ), I have completed w3schools (which was awesome) but I need exercises now, I tried sql.ex.ru but it was not that helpful.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:24:51.070

这里有一个小技巧。它的作用是在每一行上添加一个序列号或行号，按薪水排序。然后它只选择第三个：

```
select FirstName, LastName, Salary
from (select p.FirstName, p.LastName, d.salary,
             row_number() over (order by salary desc) as seqnum
      from persons p join
           details d
           on p.empid = d.empid
     ) t
where seqnum = 3 
```

row_number() 函数执行此计算。这是一个非常有用的功能，您可以将其添加到您的 SQL 知识中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:26:24.417

尝试这个：

```
SELECT   top 1 P.*,a.salary 
FROM     Persons p
JOIN
         (select top 3 empid,salary from Details order by salary desc)a
ON       p.empid=a.empid
ORDER BY p.salary 
```

或者

```
;WITH CTE AS
 (SELECT *,
         ROW_NUMBER() OVER (ORDER BY SALARY DESC) AS ROW_NUM
 FROM DETAILS)
 SELECT * 
 FROM  PERSONS P
 JOIN  CTE C
 ON    P.EMPID=C.EMPID
 where c.ROW_NUM=3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:39:11.280

```
SELECT TOP 1 persons.FirstName, persons.LastName, Salary 
FROM persons inner join Details
ON persons.empid=Details.empid 
where Salary not in(SELECT TOP 2 Salary from Details ORDER BY Salary DESC)
order by Salary desc 
```

# python - Assign steps/instructions to loop python

> ID：12217266
> 
> 赞同：0
> 
> 时间：2012-08-31T14:18:59.867
> 
> 标签：python

I have a text file in which i list instructions (e.g. go to website, click on link). What i want to do is complete each action in `[data]` according to the steps in `[steps]`. Now, i already have a mechanism to extract the files, but am not able to do each action based on each step.

File parsing:

```
file_name = "testdata.txt"
with open(file_name) as f:
      pre_data,post_data =[s.strip() for s in (f.read()).split("[data]")]
post_data_lines = post_data.splitlines()
headers = post_data_lines[0].split()
headers2 = [s.replace("_"," ").strip() for s in headers]
for line in post_data_lines[1:]:
    tmpline  = []
    pos = 0
    for itm in headers:
        tmpline.append(line[pos:pos+len(itm)])
        pos += len(itm)+1

    print dict(zip(headers2,tmpline)) 
```

This is what the text file looks like:

```
[Steps]
step1 = WebAddress
step2 = Tab
step3 = SecurityType
step4 = Criteria
step5 = Date
Step6 = Click1
step7 = Results
step8 = Download
[data]
WebAddress___________________________ Destination___________ Tab_____________ SecurityType___________________________________________________ Criteria___ Date_______ Click1_ Results_ Download    
https://mbsdisclosure.fanniemae.com/  q:\\%s\\raw\\fnmapool  Advanced Search  Interim MBS: Single-Family                                      Issue Date  09/01/2012  Search  100      CSV XML
https://mbsdisclosure.fanniemae.com/  q:\\%s\\raw\\fnmapool  Advanced Search  Preliminary Mega: Fannie Mae/Ginnie Mae backed Adjustable Rate  Issue Date  09/01/2012  Search  100      CSV XML
https://mbsdisclosure.fanniemae.com/  q:\\%s\\raw\\fnmapool  Advanced Search  Preliminary Mega: Fannie Mae/Ginnie Mae backed Fixed Rate       Issue Date  09/01/2012  Search  100      CSV XML 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:29:31.020

下面的所有伪代码...

这是你想要做的吗？

```
class StairMaster(object):
    def step1(self,data):
        pass
    def step2(self,data):
        pass

for line in testdata_dicts:
    dispatcher = StairMaster()
    for i in range(1,8):
        step = "step%s" % i
        data = line[step]
        result = getattr( dispatcher , step )( data ) 
```

或者这是你想要做的：

```
instructions = dict( 'what the steps are' )
for line in testdata_dicts:
    for i in range(1,MAX_STEPS):
        step = "step%s" % i 
        if instructions[step] == 'DOWNLOAD':
            download()
        elif instructions[step] == 'UPLOAD':
            upload()
        ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T00:27:13.550

你没有说你的代码是如何破坏的——那会有所帮助。

我试图看看你的代码做了什么，并观察到列的读取方式偏离了 3 个位置。这是由于`\\`每行中的三个。但是我不知道您提供的输入文本是否准确，并且您确实最终得到了该文本。让我知道。

```
...
header_names = [s.replace("_"," ").strip() for s in headers]
for line in post_data_lines[1:]:
    columns  = []
    column_start = 0
    print 'line %r.' % line
    for header in headers:
        column = line[column_start:column_start+len(header)]
        print 'read column %r.' % column
        print 'used header %r.' % header
        columns.append('%s' % column)
        column_start += len(header) + 1
    break 
```

这输出：

```
https://mbsdisclosure.fanniemae.com/  q:\%s\raw\fnmapool  Advanced Search  Interim MBS: Single-Family                                      Issue Date  09/01/2012  Search  100      CSV XML
read column 'https://mbsdisclosure.fanniemae.com/ '.
used header 'WebAddress___________________________'.
read column 'q:\\%s\\raw\\fnmapool  Ad'.
used header 'Destination___________'.
read column 'anced Search  In'.
used header 'Tab_____________'.
read column 'erim MBS: Single-Family                                      Is'.
used header 'SecurityType___________________________________________________'.
read column 'ue Date  09'.
used header 'Criteria___'.
read column '01/2012  Se'.
used header 'Date_______'.
read column 'rch  10'.
used header 'Click1_'.
read column '      CS'.
used header 'Results_'.
read column ' XML'.
used header 'Download'. 
```

您会看到从第二列开始，它减少了 3 个字符。

解决此问题的方法是通过三个下划线缩短写入文件中的 Destination 标头：

```
Destination___________
Destination________ 
```

# python - Python：迭代子二维（嵌套）数组以计算其总和

> ID：12217272
> 
> 赞同：1
> 
> 时间：2012-08-31T14:19:16.200
> 
> 标签：python, lambda

我想实现这个功能：计算图像的平均值（或总和）`rgb`值。更具体地说，图像由元组的二维数组组成。这是我的代码：

```
rgb = [0.0, 0.0, 0.0]
for r in range(0, 3):
    for ii in range(x, x + X_STEP):
        for jj in range(y, y + Y_STEP):
            rgb[r] += src_pix[ii][jj][r]
rgb = map(lambda a: a / X_STEP / Y_STEP, rgb) #this line does not matter, it is just the difference between sum and average 
```

**问题**如何美化它，或者让它更pythonic？也许嵌套`map`仍然不是最好的。我希望它就像使用`itertools`.

这个[链接](https://stackoverflow.com/questions/7164162/nested-for-loops-in-python)提供了一个接近我的问题的解决方案。另一个[链接](https://stackoverflow.com/questions/10713150/sum-of-2d-array-in-python)可能与我的代码重复，但他没有问同样的问题。

非常感谢。

**编辑** 我实际上希望计算一个子二维数组的总和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:38:02.143

看起来您正在使用 PIL。如果是这样，我会为此使用 numpy 。

假设您使用的是 PIL 版本 >= 1.1.6 ，您可以将 PIL 对象转换`src_pix`为 numpy 数组，如下所示：

```
np_pix = numpy.array(srx_pix) 
```

然后只需使用`numpy.sum`：

```
rgb = numpy.sum(np_pix) 
```

或计算平均值（如您上面的代码）：

```
rgb = numpy.mean(np_pix) 
```

对于旧版本的 PIL，请使用`numpy.asarray`.

如果要计算子数组的总和，可以使用*切片*获取该子数组，如下所示：

```
rgb_slice = numpy.mean(np_pix[X_start:X_end,Y_start:Y_end]) 
```

**参考资料**：

*   [PIL 和 numpy](https://stackoverflow.com/questions/384759/pil-and-numpy)（关于此主题的较早的 SO 帖子）

*   [关于数组操作的 Scipy 文档](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html)

# sql - Joining tables with a historical timeline

> ID：12217276
> 
> 赞同：1
> 
> 时间：2012-08-31T14:19:31.217
> 
> 标签：sql, oracle, join, oracle10g

I'm trying to write a join bewteen two tables where a date value in the left table falls into a time slot on the right table. So, for example if I have:

```
TABLE A                      TABLE B
ID    TIMESTMP               ID    TIMESMTP             VALUE
1     8/31/2012 2:00 PM      1     8/30/2012 4:00 AM    A
2     8/29/2012 3:00 PM      1     8/31/2012 1:00 PM    B
3     7/04/2012 5:00 AM      1     8/31/2012 3:00 PM    C
                             2     8/20/2012 1:00 PM    A 
```

The result should be:

```
TABLE C                      
ID    TIMESTMP             VALUE
1     8/31/2012 2:00 PM    B
2     8/29/2012 3:00 PM    A      
3     7/04/2012 5:00 AM    null 
```

I want to find the corresponding record in table B with the max timestamp which is still < the timestamp in table A. If there is not a matching id (outer join) or there are no timestamps in B < the timestamp in A, it should return null.

Thanks!

**UPDATE**

Here is the solution I went with using lead() as suggested by Gordon Linoff:

```
SELECT b.value, a.*
  FROM table_a a
  LEFT OUTER JOIN (
     SELECT id, timestmp, 
            lead(timestmp) over(PARTITION BY id ORDER BY timestmp) AS next_timestmp,
            value FROM table_b
    ) b
  ON a.id = b.id
  AND (a.timestmp >= b.timestmp AND (a.timestmp < b.timestmp OR b.timestmp IS NULL)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:39:34.990

```
with cte as
(
select *,
    ROW_NUMBER() over (partition by id order by timestmp) as rn
from TableB 
)

    select
        v.id, v.timestmp, value

    from
    (       
    select a.id, a.timestmp, MAX(isnull(rn,1) )rn
    from TableA a
        left join cte
        on a.id = cte.id
        and a.timestmp>cte.timestmp
    group by a.id, a.timestmp
    ) v
        left join cte
        on v.id = cte.id
        and v.rn = cte.rn
    order by v.id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:38:09.287

如果这是 sql server 我相信这可以通过外部应用来实现

IE

```
SELECT A.id, A.timestmp, B.value FROM A OUTER APPLY (SELECT TOP 1 value FROM B WHERE id = A.id AND timesmtp < A.timestmp ORDER BY timesmtp DESC) B 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:39:51.373

您可以将其表示为连接，但不能使用“=”。但是，有帮助的是在每一行上都有下一个时间戳。这就是lead()函数派上用场的地方：

```
select a.id, a.timestmp, b.value
from A left outer join
     (select b.*,
             lead(timesmtp) over (partition by id order by timesmtp) as nextTS
      from B
    ) b
    on a.id = b.id and
       a.timestmp >= b.timesmtp and
       a.timestmp < coalesce(nextTS, a.timestmp) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:52:59.737

```
select t.ID, t.Timestamp,B.Value
from
(
select A.ID, A.Timestamp, (SELECT max(B.TimeStamp) 
     FROM B where (B.Timestamp<A.Timestamp) and (B.id=A.Id)
   ) max_date

from A
  ) t
left join B on (t.max_date=B.TimeStamp) and (t.Id=B.ID) 
```

# matplotlib - 我可以自动设置子图的边距吗？

> ID：12217279
> 
> 赞同：0
> 
> 时间：2012-08-31T14:19:41.833
> 
> 标签：matplotlib, margin, subplot

不幸的是，我的地块的边距对于我想在那里设置的文本来说太小了，旋转了 45*：

![在此处输入图像描述](../Images/51c4eac3f45b36068abc7ab7fc492212.png)

如何防止数据点的标签重叠到标题中？如果它是计算出来的最好，所以我不必手动调整它。我怎样才能删除图表周围的所有空白？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:35:21.483

如果您有最新的 matplotlib 版本，可以尝试使用[Tight Layout](http://matplotlib.sourceforge.net/users/tight_layout_guide.html)。否则，您将不得不手动使用`subplots_adjust`.

# oracle - Read in CLOB objects into R as a string value

> ID：12217281
> 
> 赞同：1
> 
> 时间：2012-08-31T14:19:49.060
> 
> 标签：oracle, r, clob, spss

I am looking to read in the data that is stored as a CLOB value in my Oracle database. The contents simply are HTML that renders emails that we send through our CRM application. I want to re-create images of the email to include in my reports on crm performance.

I can successfully read the data into `SPSS` using the following query, which converts the CLOB to a string of length (32750).

```
GET DATA
  /TYPE=ODBC
  /CONNECT='DSN=<MYDSN>;UID=<USER>;PWD=mypassword;Host=myhost;Port=myport;SID='+
    'SID'
  /SQL='SELECT *  FROM mytable'
  /ASSUMEDSTRWIDTH=32750.
CACHE.
EXECUTE.
DATASET NAME clob_query WINDOW=FRONT. 
```

What I am looking to do is perform a similar query but read the data into R. I attempted the following query and got the error below:

```
> SQL <-"SELECT to_char(CONTENT) as content from REL_EMAIL_TEMPLATE"
> ds <- sqlQuery(ch, SQL, as.is=T, stringsAsFactors=F)
> ds
[1] "HY000 22835 [Oracle][ODBC][Ora]ORA-22835: Buffer too small for CLOB to CHAR or BLOB to RAW conversion (actual: 5923, maximum: 4000)\n"
[2] "[RODBC] ERROR: Could not SQLExecDirect 'SELECT to_char(CONTENT) as content from REL_EMAIL_TEMPLATE'" 
```

I am not sure how I can make the "buffer" larger, but figure that because I accomplish this in SPSS that R must be able to do this as well.

Many thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T14:32:06.473

我觉得我必须在发布之前尝试过这个解决方案，但是我回到了这个问题并且能够让它运行。

这次唯一的区别是我只尝试使用`WHERE`子句将 1 条记录拉入 R。

这是我的查询：

```
SQL <- "SELECT TO_CHAR(CONTENT) FROM RELATEMGR.REL_EMAIL_TEMPLATE WHERE primary_key = 1"
body <- sqlQuery(ch, SQL, stringsAsFactors=F) 
```

诡异的。不确定 R 的不同版本是否也很重要，但至少这让我到达了我需要的地方。

只是为了完整起见：

```
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] RODBC_1.3-6

loaded via a namespace (and not attached):
[1] tools_2.15.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:43:58.817

试试这个，我认为 TO_CHAR MAX 大小是 4000：

```
"SELECT dbms_lob.substr(CONTENT, 32767, 1 ) AS content FROM REL_EMAIL_TEMPLATE" 
```

# java - Value not populating for one of the attribute

> ID：12217283
> 
> 赞同：0
> 
> 时间：2012-08-31T14:19:56.997
> 
> 标签：java, list

I am trying to populate the values from couple of attributes and storing all this information in file via below code.

```
 import java.io.FileWriter;
    import java.io.File;
    import java.io.BufferedWriter;
    import java.io.FileInputStream;
    import java.io.FileOutputStream;
    import java.io.*;
    import java.util.List;
    import java.lang.Object;
    import java.lang.String;
    import java.util.ArrayList;

    String appname = "abc";
    String path = "//home/exportfile//";
    String filename = path+"ApplicationExport-"+appname+".txt";
    String ret = "false";

    QueryOptions ops = new QueryOptions();
    Filter [] filters = new Filter[1];
    filters[0] = Filter.eq("application.name", appname);
    ops.add(filters);

    List props = new ArrayList();
    props.add("identity.name");

    //Do search
    Iterator it = context.search(Link.class, ops, props);

    //Build file and export header row
    BufferedWriter out = new BufferedWriter(new FileWriter(filename));
    out.write("IdentityName,UserName,First_Name,Last_Name,WorkforceID,Organization,Email");
    out.newLine();          

    //Iterate Search Results
    if (it!=null)
    {                               
            while ( it.hasNext() ) 
                 {
                    //Get link and create object

                    Object [] record = it.next();
                    String identityName = (String) record[0];
                    Identity user = (Identity) context.getObject(Identity.class, identityName);

                    //Get Identity attributes for export

                    String workforceid = (String) user.getAttribute("workforceID"); 
                    String email = (String) user.getAttribute("mail"); 

                    //Get application attributes for export

                    String userid="";
                    String fn = "";
                    String ln = "";

                    List links = user.getLinks();
                    if (links!=null)
                    {
                            Iterator lit = links.iterator();
                            while (lit.hasNext())
                            {
                                    Link l = lit.next();
                                    String lname = l.getApplicationName();
                                    if (lname.equalsIgnoreCase(appname))
                                    {
                                        if (workforceid != null)
                                    {
                                              userid = (String) l.getAttribute("User Name");
                                              fn = (String) l.getAttribute("First Name");
                                              ln = (String) l.getAttribute("Last Name");

                                              List organizations = l.getAttribute("Allscript_Instance");
                                              for (Object organization : organizations) 
                                             {

                                             // Output file
                                                 out.write(identityName + "," + userid + "," + fn + "," + ln + "," + workforceid + "," + organization + "," + email);
                                                 out.newLine();
                                                 out.flush();

                                             }                                                                                                                                             
                                    }
                            }
                    }        }           
         }             

            ret="true";
    }
    //Close file and return
    out.close();
    return ret; 
```

So while compiling this code, I am getting all the values for the attributes but not for the Email.

```
out.write("IdentityName,UserName,First_Name,Last_Name,WorkforceID,Organization,Email"); 
```

its constantly writing null value in file.

I am not able to figure out where i am making the mistake.any takers and help me out.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:22:25.377

我会假设

```
String email = (String) user.getAttribute("mail"); 
```

是`null`。也许这将是`email`或`user.mail`其他名称。您可以尝试打印属性的名称吗？

# unit-testing - 模拟 addProvider(Class 类)

> ID：12217288
> 
> 赞同：0
> 
> 时间：2012-08-31T14:20:13.400
> 
> 标签：unit-testing, testing, mockito

我正在尝试使用 Mockito。

我有一堂课

```
@Provider
public class SessionProvider  implements InjectableProvider<Bind, Type>{

   @Override
   public ComponentScope getScope() {
      return ComponentScope.PerRequest;
   }

   @Override
   public Injectable getInjectable(ComponentContext ic, Bind bind, Type parameter) {
      return new SessionInjectable();
   }
} 
```

并在调用 getInjectable 时尝试返回 null。

我的用例是这样的

```
public void addProvider(Class<?> klass) {
    providers.add(klass);
}

addProvider(SessionProvider.class); 
```

如何成功模拟 SessionProvider.class？

谢谢

编辑：

我的课是这样的：

```
@Path("message")
@Produces(MediaType.APPLICATION_JSON)
public class MessageResource {

   @POST
   @Path("post")
   public String testPostMessage(@Bind Session session, Message message) {
       return "posted";
   }
} 
```

绑定注释正在使用我的提供程序。但是我当前的框架不接受 SessionProvider 的实例。它正在利用 Class 实例。

顺便说一句，这是一个网络服务。它由我的客户端实现调用。我想用一个模拟会话来测试我的信息。对于每个请求，都会请求一个新请求。这就是该方法接受会话类而不是会话实例的原因。

我真的开始觉得有些不对劲，但在哪里？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:47:18.833

默认情况下模拟返回`null`：

```
SessionProvider sessionProvider = mock(SessionProvider.class);
assertNull(sessionProvider.getInjectable(ic, bind, parameter)); 
```

对于单元测试，您可以`MessageResource`通过调用`testPostMessage`mocks 进行测试：

```
messageResource.testPostMessage(mock(SessionMessage.class), mock(Message.class)); 
```

或者，您可以创建一个`SessionProvider`返回模拟的模拟类`Session`：

```
@Provider
public class MockSessionProvider  implements InjectableProvider<Bind, Type>{
    public Injectable getInjectable(ComponentContext ic, Bind bind, Type parameter) {
      return mock(Session.class);
    }
} 
```

然后在框架上注册它：

```
addProvider(MockSessionProvider.class); 
```

# c++ - 触摸屏Qt应用

> ID：12217290
> 
> 赞同：3
> 
> 时间：2012-08-31T14:20:20.857
> 
> 标签：c++, qt, touchscreen, qpushbutton

我正在用 Qt 开发一个应用程序。我有一个按钮，我正在使用信号/插槽来设置不同的文本。

问题是我想将它与触摸屏一起使用。当我触摸屏幕时，我有坐标。到目前为止，我可以通过按下触摸屏（任何坐标）来更改文本，但只有当我按下按钮时我才知道该怎么做。

如果您有任何想法，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T22:13:04.773

触摸事件通常像鼠标点击一样处理（这取决于您使用的 Qt 驱动程序，但通常以这种方式处理）。所以像往常一样使用[pressed()](http://doc-snapshot.qt-project.org/4.8/qabstractbutton.html#pressed)信号。

# .net - 更改框架后，Visual Studio 无法识别 .Net Micro Framework 模拟器

> ID：12217291
> 
> 赞同：0
> 
> 时间：2012-08-31T14:20:22.370
> 
> 标签：.net, emulation, .net-micro-framework

我为 .Net Micro Framework 4.1 版开发了一个自定义设备模拟器。

在我将目标框架更改为 4.2 之前，这一直正常工作。即使在我将模拟器使用的程序集从 4.1 更新到 4.2 之后，该设备也不会显示为所需框架版本的可用部署选项。它仍然注册为 .net MF 4.1 的模拟器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:20:22.370

在模拟器项目中运行以下命令应该强制更新模拟器注册信息。这必须使用 Visual Studio 命令提示符运行：

```
msbuild /target:RegisterEmulator  /p:Configuration=Debug 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T21:00:51.387

4.1 模拟器无法运行 4.2 二进制文件。您需要将模拟器的项目更改为 4.2 并重建。

可用的仿真器位于 HKEY_CURRENT_USER\Software\Microsoft.NETMicroFramework\4.1\Emulators。

您可以为 4.2 添加相同的密钥

# wpf - 将所有产品和类别（以及子/子/子..）获取到树视图

> ID：12217301
> 
> 赞同：0
> 
> 时间：2012-08-31T14:21:09.950
> 
> 标签：wpf, treeview

我有这样构造的表： ![在此处输入图像描述](../Images/63d80eeb1a18f50b7927f0d5c3fd4174.png)

现在我想将所有类别、子类别、子子类别等添加到我的树视图中，但真的不知道如何构造 sql 查询。有什么建议吗？我在图片上发布的那个表的例子：

```
- ZupyEDIT
- Lody
- Mięso
  - Mięso wieprzowe
  - oi
- RTV
  - Edit
    - Laptopy
    - Komputery stacjonarne
    - Pamięć przenośna
    - Modemy
- GSM modemy 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T18:26:18.757

由于您的所有数据都来自同一个地方（而不是来自不同的结构），因此您很幸运：o）。它或多或少是这样的：

我将假设您在某种层次结构中拥有该数据，我将其命名为“MyRootCategories”，它以根项目的列表开始。还假设每个项目都有一个孩子的集合，我将其命名为“MyChildren”。

创建一个 HierarchicalDataTemplate，作为资源，如下所示：

```
<HierarchicalDataTemplate x:Key="hdt01" ItemsSource="{Binding MyChildren}" >
  <TextBlock Text="{Binding name1}" />
</HierarchicalDataTemplate> 
```

使用列表“MyRootCategories”提供 TreeView 的 ItemsSource。还将 TreeView 的 ItemTemplate 属性设置为指向“hdt01”模板。就这样。

# javascript - 在 OneStepCheckout for Magento 中调用重新加载付款方式？

> ID：12217304
> 
> 赞同：0
> 
> 时间：2012-08-31T14:21:18.900
> 
> 标签：javascript, magento

在页面加载时，geoip 会找到客户来自或至少尝试过的国家/地区，但是如果国家/地区发生更改，则付款方式不会更新。我使用付款限制来设置针对某些国家/地区显示哪些方法的规则。如果我选择另一个国家，然后返回前一个国家，付款方式会更新，一切都很好。

国家/地区的 Ajax 更新当然在 onestepcheckout 中启用。

因此，为了解决这个问题，我查看了 onestepcheckout js 文件，其中包含似乎更新付款方式的 get_save_methods_function。

我的问题是我不确定如何在文档加载时调用此函数。

还有其他方法可以触发更新吗？

插件网站[http://www.onestepcheckout.com/](http://www.onestepcheckout.com/)和演示[http://demo.onestepcheckout.com/](http://demo.onestepcheckout.com/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:28:00.210

实际上，运输和支付模块的工作是完成所有需要的检查。het 如果您使用的是 Apache geoip，您将拥有 $_SERVER，其中包含国家/地区代码。您可以在您的模块中将其拉起，然后查看是否返回费率。

在运输/支付模块中执行此操作将节省大量精力，并且比破解 OPC 更容易测试。

# php - 在 Magento 中扩展/覆盖扩展

> ID：12217308
> 
> 赞同：1
> 
> 时间：2012-08-31T14:21:25.407
> 
> 标签：php, class, magento, magento-1.7

我安装了一个扩展，我想从我的模块中使用它的功能。该扩展中的 postAction 是所有发生的地方。它使用 youtube API 来检索视频信息并将其保存在 Magento EAV 数据模型的多个表中。

我已经创建了一个功能模块来测试 youtube API 功能，只使用一个按钮和一个文本框来发送一些搜索词。但现在我想使用扩展功能自动执行该调用并填写必要的表，而不是从我的代码中手动执行所有操作。

所以我需要（或想要？或必须？）设置对该 postAction 的调用或扩展或覆盖它。我在这里迷路了，我是 Magento 和 PHP 的新手，所以我不清楚该怎么做。

这是我要调用的类：

```
/**
 * Youtube Upload Controller
 */
class AW_Vidtest_YoutubeController extends Mage_Core_Controller_Front_Action {
.....
} 
```

在其中的 postAction 函数：

```
/**
 * Get customer video
 */
public function postAction() {
    $data = new Varien_Object($this->getRequest()->getPost());
....
} 
```

我已经阅读了这些链接上的信息，但我不清楚我必须做什么。遵循`Observer`模式？也许只是自己创建一个`post`呼叫并以某种方式添加`$data`结构以便可以在呼叫中使用它？谢谢

*   [如何覆盖/扩展抽象类？](http://www.magentocommerce.com/boards/viewthread/18494/)
*   [避免扩展冲突](https://stackoverflow.com/questions/3729728/magento-best-way-to-avoid-extension-conflicts)
*   [来自两个不同模块的块覆盖](https://stackoverflow.com/questions/9311828/magento-block-override-from-two-different-modules)
*   [在多个模块中覆盖 magento bloc](https://stackoverflow.com/questions/2161954/overriding-a-magento-block-in-multiple-modules-and-how-to-ignore-the-other-ones)

**编辑：** 这是我到目前为止的代码，由@Francesco 提出建议。该函数`printVideoEntry`是从其他函数调用的，其中一个 for each 现在遍历目录中的前 3 个产品。

```
<?php
class Dts_Videotestimonials_Model_SearchVideo extends Mage_Core_Model_Abstract
{
    public $search_term;
    private $productModel;

    function printVideoEntry($videoEntry, $_product, $tabs = "")
    {
        # get user data
        $user = Mage::getSingleton('admin/session');
        $userName = $user->getUser()->getFirstname();
        $userEmail = $user->getUser()->getEmail();
        $data = array(
            "ProductId" => $_product->getId(),
                        "AuthorEmail" => $userEmail,
                        "AuthorName" => $userName,
                        "VideoLink" => $videoEntry->getVideoWatchPageUrl(),
                        "VideoType"  => "link",
                        "Title" => $videoEntry->getVideoTitle(),
                        "Comment" => "this is a comment"
        );
        $actionUrl = Mage::getUrl('vidtest/youtube/post');
        Mage::app()->getResponse()->setRedirect($actionUrl, $data);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T09:46:19.337

给出一个明确的答案并不容易……这个问题不清楚，因为我们不知道 youtube 扩展是如何工作的。（代码是加密的还是开放的？）

**调用控制器的动作**

如果你只想调用 postAction 你可以使用`_redirect($path, $arguments=array())`方法。（定义在`Mage/Core/Controller/Varien/Action.php`）

1.  `$path`定义为“模块名称/控制器名称”
2.  `$arguments=array()`定义为对参数名称 => 值。

**前任。**

```
$this->_redirect('checkout/cart', array('Pname' => $pValue, ... ); 
```

仅当您从 Controller 调用它时，这才有效...

您可以在此处找到有关 _redirect 的更多信息：[magento _redirect with parameters that have + or /](https://stackoverflow.com/questions/4538422/magento-redirect-with-parameters-that-have-or)

如果您想从模型或任何不同的文件从控制器进行重定向，您将需要以这种方式调用 url：

```
Mage::app()->getResponse()->setRedirect(Mage::getUrl($path, $arguments=array())); 
```

所以上面的例子。变成：

```
Mage::app()->getResponse()->setRedirect(Mage::getUrl('checkout/cart', array('Pname' => $pValue, ... )); 
```

**观察者**

使用观察者意味着向您的模块（观察者）添加一个新模型，并在此类中编写一个在某些事件下执行操作的方法，可能您想调用 yt 扩展的某些模型/方法。

然后你必须在你的 config.xml 中声明这些东西，将你的观察者方法绑定到某个事件（即使在 Magento 中任何适合你的预定义，或者如果你需要你应该创建自己的重写 magento 类......）

**观察者示例**

*   PackageName/ModuleName/Model/Observer.php

    ```
    class PackageName_ModuleName_Model_Observer {

        public function myActionMethod(Varien_Event_Observer $observer) {

            // Code ... 
            // just a very indicative example
            $model = Mage::getModel('youtubeExtension/Model....').method();

        }

    } 
    ```

*   包名/模块名/etc/config.xml

    ```
    <config>
    ....
    <global>
        <events>
            <EventName>
                <observers>
                    <moduleName_observer>
                        <type>singleton</type>
                        <class>PackageName_ModuleName_Model_Observer</class>
                        <method>myActionMethod</method>
                    </moduleName_observer>                         
                </observers>
            </EventName>
        </events>
    </global>
    .... 
    ```

显然`EventName`根据您的包/模块/方法名称更改和所有假名称

最困难的是找到适合您的正确事件......每次您在 magento 代码中看到类似`Mage::dispatchEvent('EventName', Parameters);` 这样的事件都是一个事件。

[您可以在此处](http://www.magentocommerce.com/wiki/5_-_modules_and_development/reference/events)找到默认 Magento 事件列表

希望对你有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T10:51:08.740

试着扩展你的模块类

```
class AW_Vidtest_YoutubeController extends Mage_Core_Controller_Front_Action {
.....
} 
```

示例类 AW1_Vidtest1_YoutubeController1 扩展 AW_Vidtest_YoutubeController { ..... }

其中 AW1_Vidtest1_YoutubeController1 Aw1 是命名空间 Vidtest1 是您的模块名称 YoutubeController1 是您希望使用发布操作的控制器。

希望它对你有用

# sql - SQL INSERT 计算日期之间的 NoOfDays

> ID：12217309
> 
> 赞同：1
> 
> 时间：2012-08-31T14:21:26.080
> 
> 标签：sql, tsql, sql-server-2012

```
 CREATE TABLE "Reservation"(

    ReservationID int IDENTITY (1,1) NOT NULL,
    CustomerID int NOT NULL,
    RoomNo int NOT NULL,
    CheckInDate date NULL,
    CheckOutDate date NULL,
    NoOfDays int NULL,

    CONSTRAINT PK_Reservation PRIMARY KEY(ReservationID),

    CONSTRAINT FK_Reservation_Customers_CustID FOREIGN KEY(CustomerID)  
        REFERENCES dbo.Customers(CustomerID),

    CONSTRAINT FK_Reservation_Rooms_RoomNo FOREIGN KEY(RoomNo)
        REFERENCES dbo.Rooms(RoomNo)
)

INSERT Reservation(CustomerID,RoomNo,CheckInDate,CheckOutDate,NoOfDays)
        VALUES(1,101,'2012-01-01','2012-01-30',DATEDIFF(NoOfDays,'CheckInDate','CheckOutDate')) 
```

有人可以告诉我如何计算“CheckInDate”和“CheckOutDate”之间的天数，然后在 NoOfDays 的插入语句中使用这个值。很难解释我希望你明白我在这里想要达到的目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:22:21.837

更新：

试试这个：

```
INSERT Reservation(CustomerID,RoomNo,CheckInDate,CheckOutDate,NoOfDays)
    VALUES(1,101,'2012-01-01','2012-01-30',DATEDIFF(day,'2012-01-01','2012-01-30')); 
```

[SQL小提琴](http://www.sqlfiddle.com/#!6/0eb58/1)

# javascript - 在 IE9 下提取 IFrame 的 XML 内容

> ID：12217321
> 
> 赞同：2
> 
> 时间：2012-08-31T14:22:15.753
> 
> 标签：javascript, xml, internet-explorer, iframe

我从一个星期以来一直在处理这个问题

我想知道做一些非常简单的事情：

提取 iframe 中包含的 XML 内容并在父文档中使用它（*在我的情况下，将 XML 发送到 ActiveX 以获取签名*）

这是一个可以找到迷你 [项目 zip的 url](http://goo.gl/7EkvL)

我的目标浏览器是*IE9/10*。

**父文件**：

```
 <!-- Main hero unit for a primary marketing message or call to action -->
        <div class="hero-unit">
            <h1>Parapheur 5.0</h1>
            <div class="alert-block">Please use buttons for actions</div>
            <div class="btn-group">
                <a class="btn btn-success btn-mini" onclick="javascript:expandViewport('viewport1');">Expand viewport &raquo;</a>
                <a class="btn btn-info btn-mini" onclick="javascript:collapseViewport('viewport1');">Collapse viewport &raquo;</a>
                <a class="btn btn-primary btn-mini" onclick="javascript:extractXml('#viewport1');">Extract XML &raquo;</a>
            </div>
            <div class="alert-block"></div>
            <iframe id="viewport1" src="xml/data.xml" width="1024px" height=""></iframe>
            <div class="alert-block"></div>
        </div>
        <div id="content" class="alert-info"></div> 
```

**应用程序.js**：

```
function extractXml(id,content) {
console.log("Starting extraction of XML from within IFrame : " + id);
/*
var lastIndexOfSlash = document.getElementById(id).src.lastIndexOf("/");
var doc = document.getElementById(id).src.substring(lastIndexOfSlash);
$.get('xml/'+doc,function(xml){
                    console.log(xml);
                });
*/
console.log($(id).contentDocument);} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T15:14:38.820

似乎在 IE9 下从 iframe 加载 xml 的唯一方法是执行以下代码行。

```
document.getElementById("viewport1").contentWindow.document.firstChi‌​ld.nextSibling.textContent 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T11:49:50.467

您可以在 IE9 中访问 iframe xml，如下所示。

```
var frameIE = document.getElementById("yourIframeElementID");
var textXml = frameIE.contentWindow.document.firstChild.innerText;//Get the text
var regex = new RegExp('- <', 'g');
textXml = textXml.replace(regex, "<");
var xml = $.parseXML(textXml);//Use jquery to parse xml
xml = $(responseData);
//Now u can use this xml object to find xml nodes inside it using jquery... 
```

我在使用时必须使用这种方法`<meta http-equiv="X-UA-Compatible" content="IE=8" />`。在这种情况下，IE9在兼容模式下工作，甚至不允许访问`window.frames.<your_frame_name>.document.XMLDocument`，`$("#iframeId").contents()`也不工作。

如果你没有`<meta http-equiv="X-UA-Compatible"... />`标签，你可以使用下面的代码：

```
var contents = window.frames.your_frame_name.document.XMLDocument;
var xml = $(contents);
//use this 'xml' object to access its nodes using jquery. 
```

但要使上述所有工作正常，您的框架必须指向同一来源或域中的资源。

# c# - 多线程奇怪

> ID：12217325
> 
> 赞同：3
> 
> 时间：2012-08-31T14:22:24.347
> 
> 标签：c#, .net, multithreading, wcf, task-parallel-library

我正在开发一个 WCF 客户端/服务器应用程序，客户端通过将调用包装在其中`Task.Factory.StartNew`并在 WCF 调用返回时使用延续调用用户提供的委托来异步调用服务器。服务器操作在向客户端返回响应之前执行（除其他外）一些串行 I/O。该服务还利用 BlockingCollection 将这些请求排入队列，确保它们一次执行一个，以避免串行端口争用。就目前而言，该应用程序运行得非常好，即使客户端快速连续地向服务器发出大量请求。

现在，该应用程序还可以配置为以“直接”模式运行，其中客户端直接引用服务器端程序集（出于性能原因，如果客户端和服务器位于同一台 PC 上）。在这种情况下，客户端使用服务类的实例（而不是 ChannelFactory 创建的代理）并使用相同的异步`Task.Factory.StartNew`帮助器直接调用其操作方法。

在这种“直接”模式下，我发现服务器端执行似乎运行缓慢（它错过了串行端口数据），就好像它以某种方式被中断了一样。我可以通过将客户端任务更改为使用来“修复”它`TaskCreationOptions.LongRunning`。不幸的是，这会在“WCF 模式”下破坏应用程序，这似乎会遇到同样的缓慢问题。

现在，我可以简单地包含 TaskCreationOptions（或不包含），具体取决于应用程序使用的“模式”，但我想首先了解为什么会发生这种情况。有任何想法吗？

**编辑**：当客户端一个接一个地向服务器发送十几个请求时，我注意到应用程序启动期间的问题，在`for`环形。在此之后，客户端每半秒轮询一次服务器 - 这不受问题的影响，其他两个同时运行客户端和服务器端的线程计时器也不受影响（其中一个每 65 毫秒触发一次！）。我看到一篇文章说线程池将创建新线程，直到达到最小线程数，之后它将创建的线程数限制为每 500 毫秒一个。这与我的问题的症状相匹配，因为我看到大约每半秒出现一次缓慢。我将重构我的客户端代码以避免快速连续多次访问服务器，这是一种耻辱。我真的很想一个接一个地触发所有这些请求，然后在服务器处理完回调委托后处理结果。但是有了这个线程池“

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:45:27.613

如果切换到 LongRunning 解决了它，这意味着当 LongRunning 未设置时，任务框架正在选择使用线程池，或者甚至可能根本不使用单独的线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:43:51.487

您可以运行一些性能工具或附加计时器来找出瓶颈所在。或者在命名管道上使用 WCF 模式。(http://msdn.microsoft.com/en-us/library/ms733769.aspx)

# css - 为什么“顶部：50%”不起作用？

> ID：12217332
> 
> 赞同：0
> 
> 时间：2012-08-31T14:22:36.450
> 
> 标签：css

我想要页面中心的加载动画。这是本作的风格`<div id="loading">`

```
#loading{
    position: absolute;
    top: 50%;
    left: 50%;
} 
```

但它不在中心，我不知道为什么。[这](http://jsfiddle.net/ahmadalli/skq7Y/)是加载的 jsfiddle 页面。有谁能够帮助我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:23:55.637

```
#loading{
    position: absolute;
    top: 50%;
    left: 50%;
    margin-top: -25px;  /* half of your element's height */
    margin-left: -25px; /* half of your element's width */
} 
```

[**演示**](http://jsfiddle.net/skq7Y/3/)

您可能想阅读有关[垂直居中技术](http://blog.themeforest.net/tutorials/vertical-centering-with-css/)的更多信息（在您的情况下是方法 2）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:26:36.983

使用`top`and`left`时，它会偏移左上角。 `bottom`并`left`偏移左下角。

基本上，你不是告诉浏览器#loading 的中心应该居中，而是左上角应该居中。

* * *

编辑：水平居中 div 的一种更有前途的方法是使用`margin: 0 auto;`. 这样你就不必处理 div 的宽度。

我不知道有任何单行 CSS 垂直执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:23:47.870

因为您没有考虑加载微调器的高度和宽度，因此它会有点 - 小于 - 顶部和左侧的 50%。

每个人都击败了我到下一部分，但是是的，你总是`divide / 2`你的 div/image/etc 的高度和宽度，这使得*负*上边距和左边距。

在你的情况下，图像是 50px 宽和高，除以 2，繁荣，你想使用 -25px

```
margin-top: -25px;
margin-left:-25px; 
```

这是一篇关于[**负边距技巧的好文章**](http://web.enavu.com/snippets/centering-a-div-vertically-and-horizontally-via-pure-css-or-with-js/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:24:34.217

干得好：

[http://jsfiddle.net/skq7Y/5/](http://jsfiddle.net/skq7Y/5/)

# python - 在 Python 中调用递归函数的问题

> ID：12217333
> 
> 赞同：1
> 
> 时间：2012-08-31T14:22:38.763
> 
> 标签：python, recursion

我错过了一些关于递归如何在 Python 中工作的信息。我已经采用以下方法来标记一个句子：

```
def extractIngredientInfo(ingredientLine, sectionTitle):

    print 'extractIngredientInfo' + ingredientLine

    # set-up some default values for variables that will contains the extracted datas
    usmeas             = 'N.A'
    othermeas          = 'N.A'

    p_ingredientalt     = re.compile('\(or\s(.*?)\)')
    malt = p_ingredientalt.search(ingredientLine)
    if malt:
        ingredientAlt = malt.group(1)
        ingredientLine = ingredientLine.replace(malt.group(0), '').strip()
        print 'NEW LINE TO TREAT(ALT)' + ingredientLine
        extractIngredientInfo(ingredientLine, sectionTitle)
        usmeas,othermeas = extractOneIngredientInfo(ingredientAlt)
        print 'MALT'
        ingredient 
        yield usmeas, othermeas
        #return;

    p_ingredientpurpose = re.compile('\(for\s(.*?)\)') 
    mpurpose = p_ingredientpurpose.search(ingredientLine)
    if mpurpose:
        ingredientPurpose = mpurpose.group(1)
        ingredientLine = ingredientLine.replace(mpurpose.group(0), '').strip()
        print 'NEW LINE TO TREAT(FOR)' + ingredientLine
        extractIngredientInfo(ingredientLine, sectionTitle)
        usmeas,othermeas = extractOneIngredientInfo(ingredientPurpose)
        print 'MPURPOSE'
        yield usmeas,othermeas
        #return;

    usmeas,othermeas = extractOneIngredientInfo(ingredientLine)
    print 'FINAL'
    yield usmeas, othermeas 
```

当我调用这个函数时，我有一个匹配项，`malt`它应该导致立即调用递归函数`extractIngredientInfo`，但这从来没有发生过（我没有看到第二次调用`print 'extractIngredientInfo' + ingredientLine`。有什么具体原因没有发生?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:27:35.300

我认为这与您实际上并没有递归地使用函数的输出这一事实有关。很难说你想用它做什么，但你可能想用它*做点什么*。例如：

```
 for res in  extractIngredientInfo(...,...):
     yield res 
```

而不仅仅是：

```
extractIngredientInfo(...,...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:39:58.080

您的函数返回一个生成器，因为它使用`yield`语句。生成器会*暂停*，直到您请求下一个值。

这意味着生成器函数在您调用`.next()`它之前不会做任何事情，或者将其用作循环中的迭代器：

```
>>> def foo():
...     print 'Foo called'
...     yield 'bar'
...     print 'Still in foo'
...     yield 'baz'
... 
>>> foogen = foo()
>>> foogen.next()
Foo called
'bar'
>>> foogen.next()
Still in foo
'baz'
>>> for val in foo():
...     pass
... 
Foo called
Still in foo 
```

*请注意，在我调用**generator*之前，该消息`Foo called`是如何打印的。*`.next()`*

您只调用递归函数，但会返回一个生成器，然后您将其丢弃。代码本身永远不会被执行，因为它被搁置了。而是循环遍历结果：

```
for res in extractIngredientInfo(ingredientLine, sectionTitle):
    yield res 
```

现在您实际上迭代了嵌套生成器函数的结果，并将它们传递给调用者（外部嵌套生成器函数的使用者）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:44:15.000

您必须注意如何[在生成器函数中使用递归](https://stackoverflow.com/questions/248830/python-using-a-recursive-algorithm-as-a-generator)。你必须小心你的生成器函数产生了什么。

```
def gen_f(n):
    for i in xrange(n):
        yield "hello"

def recursive_f(n):
    yield "hello"
    if n>0: for line in recursive_f(n-1): yield line
    # the above line is the tricky one, you might be tempted to
    # yield recursive_f(n-1) # but it won't work. 
```

两者都是**等效**的，您可以调用它们的一种方法是：

```
for yield_statement in gen_f(10): print yield_statement 
```

# history - 如何在 VMS 上列出历史命令？

> ID：12217334
> 
> 赞同：1
> 
> 时间：2012-08-31T14:22:38.540
> 
> 标签：history, vms, openvms

如何在 VMS 上列出历史命令？

在 linx 上，我们可以使用“历史”。

我在 VMS 上找不到相应的命令。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T14:24:36.757

您要查找的命令是`RECALL /ALL`. 请参阅这个OpenVMS 命令及其 UNIX 等效命令的[便捷列表。](http://www.physnet.uni-hamburg.de/physnet/vms-unix-commands.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T09:45:29.210

您可以使用 Recall/all 它为您提供以下格式的最后一个缓冲区命令

*   42 帮助
*   第43章
*   44组验证
*   第45章
*   46 创建 mydcl.com

现在您可以使用再次运行

```
recall 42
ie 
help 
```

并且与 unix "!pattern" 一样，它运行的最后一个命令与 OpenVMS RECALL PATTERN 示例中的模式相同

```
$ recall s 
```

结果是

```
$ set verify = procedure 
```

# android - 在 Spring 3.0 失败中将刷新模式设置为 AUTO

> ID：12217336
> 
> 赞同：1
> 
> 时间：2012-08-31T14:22:45.013
> 
> 标签：android, spring, hibernate

我正在使用 Spring 3.0 rest、hibernate 3 和 Android 4。尝试在我的数据库表中添加用户时，事情停止工作。在帖子上设置的对象，使用 Android 和 Spring 3.1 始终为空。这是在服务器端，在 Spring 控制器中：

```
@Transactional(readOnly = false)
@RequestMapping(value = "/user/add/", method = RequestMethod.POST, 
        headers = "Accept=application/json,text/html,application/xhtml+xml,application/xml",
        consumes ="{MediaType.APPLICATION_JSON_VALUE}", produces = "{MediaType.APPLICATION_JSON_VALUE}")
public @ResponseBody
User registerUser(@ModelAttribute("user") User user, HttpServletResponse response) throws IOException {

    return userService.saveUser(user);
} 
```

此处用户始终为 null 并在 db 中插入当然..null 值。

从 Android 这就是我发送对象的方式：

```
try {
        RestTemplate restTemplate = new RestTemplate();
        GenericEntityWithJson getEntityHeader = new GenericEntityWithJson();
        HttpEntity<Taxi> entityHeader = getEntityHeader
                .getHttpEntityWithJsonHeaders(user);
        response = restTemplate.postForObject(url, entityHeader, User.class);
    } catch (Exception e) {
        System.out.println("register error: " + e.getMessage());
    } 
```

我的 persistence.xml 代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

    <!-- Load in application properties reference -->
    <bean id="applicationProperties" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="classpath:be/taximobile/rest/resources/database.properties"/>
    </bean>

        <bean id="mysqlDataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="${db.driverClassName}" />
        <property name="url" value="${db.url}" />
        <property name="username" value="${db.username}" />
        <property name="password" value="${db.password}" />
    </bean>

<!-- Hibernate SessionFactory -->
   <bean id="sessionFactory"
      class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
      <property name="dataSource">
         <ref local="mysqlDataSource" />
      </property>

      <property name="annotatedClasses">
         <list>
            <value>be.taximobile.rest.bean.Client</value>
            <value>be.taximobile.rest.bean.Taxi</value>
            <value>be.taximobile.rest.bean.ClientCommand</value>
            <value>be.taximobile.rest.bean.TaxiFeatures</value>
         </list>
      </property>
      <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">
                    org.hibernate.dialect.MySQLDialect
                </prop>
                <prop key="hibernate.hbm2ddl.auto">create</prop>
                <prop key="lazy">true</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.format_sql">true</prop>
                <prop key="hibernate.generate_statistics">true</prop>
                <prop key="hibernate.use_sql_comments">true</prop>
            </props>
        </property>
   </bean>

    <!-- Configure Transaction manager for a single Hibernate SessionFactory(because we are using one database source only, and so a single Session Factory) -->
    <bean id="transactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
         <property name="sessionFactory" ref="sessionFactory" />
         <property name="rollbackOnCommitFailure" value="true" />
    </bean>

    <bean id="hibernateTemplate" class="org.springframework.orm.hibernate3.HibernateTemplate">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <!-- define DAO and Service beans -->
    <bean id="clientDao" class="be.taximobile.rest.persistence.ClientDAOImpl">
        <property name="hibernateTemplate" ref="hibernateTemplate" />
    </bean>

    <bean id="featureDao" class="be.taximobile.rest.persistence.FeatureDAOImpl">
        <property name="hibernateTemplate" ref="hibernateTemplate" />
    </bean>

    <bean id="orderDao" class="be.taximobile.rest.persistence.OrderDAOImpl">
        <property name="hibernateTemplate" ref="hibernateTemplate" />
    </bean>

    <bean id="taxiDao" class="be.taximobile.rest.persistence.TaxiDAOImpl">
        <property name="hibernateTemplate" ref="hibernateTemplate" />
    </bean>

    <bean id="orderService"
        class="be.taximobile.rest.services.OrderServiceImpl"  >
        <property name="orderDao">
            <ref bean="orderDao" />
        </property>
    </bean>

    <bean id="taxiService"
        class="be.taximobile.rest.services.TaxiServiceImpl"  >
        <property name="taxiDao">
            <ref bean="taxiDao" />
        </property>
        <property name="featureDao">
            <ref bean="featureDao" />
        </property>
    </bean>

    <bean id="featureService"
        class="be.taximobile.rest.services.FeatureServiceImpl"  >
        <property name="featureDao">
            <ref bean="featureDao" />
        </property>
    </bean>

    <bean id="clientService"
        class="be.taximobile.rest.services.ClientServiceImpl"  >
        <property name="clientDao">
            <ref bean="clientDao" />
        </property>
    </bean>

    <!-- end

    <bean name="openSessionInViewInterceptor"
        class="org.springframework.orm.hibernate3.support.OpenSessionInViewInterceptor">
        <property name="sessionFactory">
            <ref bean="sessionFactory" />
        </property>
        <property name="flushModeName" value="FLUSH_AUTO" />
    </bean> -->
</beans> 
```

Servlet.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc" 
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <!-- To enable autodetection of such annotated controllers, you add component scanning to your configuration. -->
    <context:component-scan base-package="be.taximobile.rest.controller" />

    <!-- hibernate configuration
    <import resource="TaxiMobileBackend-persistence.xml" />-->

    <!-- To enable @RequestMapping process on type level and method level -->

    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
       <property name="messageConverters">
           <list>
               <ref bean="jsonConverter" />
       <ref bean="marshallingConverter" />
           </list>
       </property>
    </bean>

    <bean id="jsonConverter" 
                class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
       <property name="supportedMediaTypes" value="application/json" />
    </bean>

    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />

    <bean id="marshallingConverter" class="org.springframework.http.converter.xml.MarshallingHttpMessageConverter">
      <constructor-arg ref="jaxbMarshaller" />
      <property name="supportedMediaTypes" value="application/xml"/>
    </bean>

    <!-- JAXB2 marshaller. Automagically turns beans into xml -->
    <bean id="jaxbMarshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
        <property name="classesToBeBound">
            <list>
                <value>be.taximobile.rest.bean.Client</value>
                <value>be.taximobile.rest.bean.Taxi</value>
                <value>be.taximobile.rest.bean.ClientCommand</value>
                <value>be.taximobile.rest.bean.TaxiFeatures</value>
            </list>
        </property>
    </bean>

    <!-- Mape views -->
    <bean id="jsonview" class="org.springframework.web.servlet.view.xml.MarshallingView">
      <constructor-arg ref="jaxbMarshaller" />
    </bean>

    <bean id="taxis" class="org.springframework.web.servlet.view.xml.MarshallingView">
      <constructor-arg ref="jaxbMarshaller" />
    </bean>

    <bean id="orders" class="org.springframework.web.servlet.view.xml.MarshallingView">
      <constructor-arg ref="jaxbMarshaller" />
    </bean>

    <bean id="taxi" class="org.springframework.web.servlet.view.xml.MarshallingView">
      <constructor-arg ref="jaxbMarshaller" />
    </bean>

    <bean id="client" class="org.springframework.web.servlet.view.xml.MarshallingView">
      <constructor-arg ref="jaxbMarshaller" />
    </bean>

    <bean id="order" class="org.springframework.web.servlet.view.xml.MarshallingView">
      <constructor-arg ref="jaxbMarshaller" />
    </bean>

    <!-- end -->

     <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">  
           <property name="contentType" value="text/plain"/>  
      </bean>

    <bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <property name="mediaTypes">
            <map>
                <entry key="json" value="application/json"/>
                <!-- 
                <entry key="xml" value="application/xml"/>
                <entry key="html" value="text/html"/>
                 -->
            </map>
        </property>
        <property name="viewResolvers">
            <list>
                <bean class="org.springframework.web.servlet.view.BeanNameViewResolver"/>
                <bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">
                    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
                    <property name="prefix" value="/WEB-INF/jsp/"/>
                    <property name="suffix" value=".jsp"/>
                </bean>
            </list>
        </property>
    </bean>

    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
        <property name="messageConverters">
            <list>
                <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter" />
            </list>
        </property>
    </bean>

    <!-- Controllers -->
    <bean id="taxiController" class="be.taximobile.rest.controller.TaxiController">
        <property name="taxiService" ref="taxiService" />
    </bean>

    <bean id="clientController" class="be.taximobile.rest.controller.ClientController">
        <property name="clientService" ref="clientService" />
    </bean> 

    <bean id="orderController" class="be.taximobile.rest.controller.OrderController">
        <property name="orderService" ref="orderService" />
        <property name="taxiService" ref="taxiService" />
    </bean>

    <bean id="featuresController" class="be.taximobile.rest.controller.TaxiFeaturesController">
        <property name="featureService" ref="featureService" />
    </bean>
</beans> 
```

WEB.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_1.xsd"
    metadata-complete="true">

    <display-name>be.taximobile.rest</display-name>

    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>

    <!-- The context params that read by ContextLoaderListener  -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/TaxiMobileBackend-context.xml
        </param-value>
    </context-param>

    <!-- This listener will load other application context file in addition to springweb-servlet.xml -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>TaxiMobileBackend</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>TaxiMobileBackend</servlet-name>
        <url-pattern>/service/*</url-pattern>
    </servlet-mapping>

    <jsp-config>
        <taglib>
            <taglib-uri>http://java.sun.com/jsp/jstl/core</taglib-uri>
            <taglib-location>/WEB-INF/tags/c.tld</taglib-location>
        </taglib>
    </jsp-config>
     <context-param>
        <param-name>log4jConfigLocation</param-name>
        <param-value>/WEB-INF/log4j.properties</param-value>
    </context-param>

     <listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
     </listener>

     <filter>
      <filter-name>hibernateFilter</filter-name>
      <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
      <init-param>
         <param-name>sessionFactoryBeanName</param-name>
         <param-value>sessionFactory</param-value>         
      </init-param>      
    </filter>

     <filter-mapping>
       <filter-name>hibernateFilter</filter-name>
        <url-pattern>/*</url-pattern>
      </filter-mapping>

</web-app> 
```

在发布操作之前，我的对象`user`具有值。我在客户端没有收到任何错误，它直接到服务器之一，但它到达为空。我根本不明白这一点，尝试使用@RequestBody，它甚至没有进入我的控制器方法。你以前有没有遇到过这个，任何想法都会很棒。以前有人遇到过这个错误吗？我现在真的不知道该尝试什么了。谢谢！

# objective-c - 如何删除为编辑目的创建的临时 NSManagedObjectContext

> ID：12217338
> 
> 赞同：0
> 
> 时间：2012-08-31T14:22:49.340
> 
> 标签：objective-c, core-data, nsmanagedobjectcontext

在 iOS COreData 应用程序中，我尝试了仅用于编辑对象的临时上下文。

由于存在错误，我丢弃了 iOS 5 引入的 parentContext，所以它只是一个普通的上下文，具有通常的保存通知机制，用于与主上下文合并。

这似乎有效，但我不确定一点：

我有一个为我构建上下文的工厂，而不是从控制器传递到控制器。临时上下文仅用于编辑目的，并且因为我不是一直在编辑实体，所以我的理解（可能是错误的）是必须在工作完成后立即删除它以释放资源。

所以重新假设，如何删除临时上下文？还是需要保留以供以后重用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:17:34.993

如果您使用 ARC，您所要做的就是确保没有引用 MOC。换句话说，如果你在某处保留一个指向它的指针，请将其设置为 nil。否则，当您停止引用 MOC 时，它应该很容易被销毁。

几种简单的方法来确保...

1.  在仪器中，跟踪 MOC 对象以查看它们何时是 alloc/dealloc。

2.  子类化`NSManagedObjectContext`并覆盖 init/dealloc——确保调用 super——除了 dealloc——在 ARC 中不起作用。然后你可以追踪它

3.  在 -[NSManagedObjectContext dealloc] 处设置断点并看到它消失

4.  添加具有 dealloc 的关联对象（通过`objc_setAssociatedObject`），以便您可以查看 MOC 何时被释放

5.  设置对 MOC 的 __weak 引用并观察它变为 nil

6.  许多其他选择...

底线是有很多方法可以“跟踪”您的 MOC 被破坏（或不被破坏）。

如果您使用 ARC，您所要做的就是确保没有其他对象持有对您的 MOC 的引用，并且它会像所有其他对象一样消失在日落中。

我的 #1 建议是我唯一按偏好订购的建议。如果您已经知道如何使用 Instruments，这将是小菜一碟。

如果您不知道如何使用工具，那么您绝对应该使用选项#1，因为我不知道有一个更有价值的开发工具（除了编译器本身）可以在 Apple 平台上进行开发。

-- 当然，在不使用 ARC 时同样适用 -- 但您必须手动获取正确的引用计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:18:09.283

我编写了这段简短的代码，负责将上下文更改传播到其他上下文：

假设：

```
@property (nonatomic, strong) NSDictionary* threadsDictionary; 
```

以下是如何获取托管对象（每个线程）：

```
- (NSManagedObjectContext *) managedObjectContextForThread {

// Per thread, give one back
NSString* threadName = [NSString stringWithFormat:@"%d",[NSThread currentThread].hash];

NSManagedObjectContext * existingContext = [self.threadsDictionary objectForKey:threadName];
if (existingContext==nil){
    existingContext = [[NSManagedObjectContext alloc] init];
    [existingContext setPersistentStoreCoordinator: [self persistentStoreCoordinator]];
    [self.threadsDictionary setValue:existingContext forKey:threadName];
}

return existingContext; 
```

}

在您的全局管理器的 init 方法中的某个时刻（我使用了单例）：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(backgroundContextDidSave:)                                                    name:NSManagedObjectContextDidSaveNotification                                                   object:nil]; 
```

然后接收保存通知并传播到所有其他托管上下文对象：

```
- (void)backgroundContextDidSave:(NSNotification *)notification {
    /* Make sure we're on the main thread when updating the main context */
    if (![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(backgroundContextDidSave:)
                               withObject:notification
                            waitUntilDone:NO];
        return;
    }

    /* merge in the changes to the main context */
    for (NSManagedObjectContext* context in [self.threadsDictionary allValues]){
            [context mergeChangesFromContextDidSaveNotification:notification];
    }
} 
```

（为清楚起见，删除了其他一些方法）

# c - C中的排序程序

> ID：12217341
> 
> 赞同：0
> 
> 时间：2012-08-31T14:23:02.163
> 
> 标签：c, sorting

我是 C 新手，我没有使用像“struct”这样的对象的习惯。我正在尝试提高一个简单程序的速度：假设输入由两个列表组成：一个是 N 个元素，另一个是 M 个元素。我想知道第二个列表的每个元素，如果它出现在第一个列表中，则输出为 1，否则返回为 0。最后，输出按第二个列表元素的输入顺序出现。

所以我首先尝试使用 qsort() 对两个列表进行排序，然后比较每个列表，但我的程序输出异常结果。例如，如果我将 M 固定为 2，我会输出 4 个数字！所以这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>

//this function detects if the element 'input' is appears in the 
//first list called 'c'
//The output returns 0 if not, and the '(i+1)th' place 'input' 
//appears in 'c'

int search(int input,int a, int N,int c[N]){
    int i;
    int res=0;

for(i=a;i<N;i++){
        if(input==c[N-1-i]){res=i+1;break;}
        else{}
    }
    return res;
}

//Since we sort each list and since we want the output to appear 
//in the order each element  the second list's elements were input,
//we define a 'Spec' to keep in mind each index of the second list's 
//elements
struct Spec{
    int val;
    int ind;
};

//function qsort() uses to sort the first list 'c'
int compare (int* a, int* b)
{
    return ( *a - *b );
}

//function qsort() uses to sort the second list called 'd'
int comp(const void* a, const void* b)
{

    const struct Spec *A = (const struct Spec*) a;
    const struct Spec *B = (const struct Spec*) b;
    return A->val - B->val;
}

int main()
{
    int i;

    //the size of the first list 'c'
    int N;
    scanf("%d",&N);
    int rank=0;

    //declaring and sorting the first list 'c'
    int c[N];
    for(i = 0; i < N; ++i)
    {scanf("%d", &c[i]);}
    qsort (c, N, sizeof(int),compare);

    //the size of the second list 'd'
    int M;
    scanf("%d",&M);

    //declaring and sorting the second list 'd'
    struct Spec* d;
    d = (struct Spec*)calloc(M, sizeof(struct Spec));
    for(i = 0; i < M; i++)
    {scanf("%d", &d[i].val);}

    //initialize the index of the input's elements order 
    for(i = 0; i < M; i++)
    {d[i].ind=i;}

    qsort (d, N, sizeof(struct Spec), comp);

    //the output will be stored in 'f'
    int f[M];

    //if the following condition is verified, the the output must 
    //always be 0
    if((d[0].val>c[N-1])||(d[M-1].val<c[0])){
        for(i=0;i<M;i++){printf("0");printf("\n");}
    }

    else{
    for (i=0;i<M;i++){

        //the output is stored in 'f', and the index to respect 
        //input's order is then 'd[i].ind'
        if((d[i].val<c[0])){f[d[i].ind]=0;}
        //if the following condition is verified, the the output must always be 0 for the last 'M-i' outputs

        else if((d[i].val>c[N-1]))
             {
             int j;
             for(j=i;j<M;j++)
                {
                f[d[j].ind]=0;
                }
             break;
             }

        else{
                //if an element 'd[i]' of the second list 'd' 
                //appears in the first list 'c', then the output 
                //stored in 'f' will be '1' and the size of the 
                //matching (betwenn 'c' and 'd') search can be 
                //truncated from the first 'rank-1' elements
                if(search(d[i].val,rank,N,c)>0){
                rank=search(d[i].val,rank,N,c)-1;
                f[d[i].ind]=1;
                }
            else{f[d[i].ind]=0;}
            }
       }
    }

    //printing the output
    for(i=0;i<M;i++){
        printf("%d",f[i]);
        printf("\n");
    }

} 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:43:27.707

您的问题 - 正如您在额外输出的帖子中所述 - 是由打印循环的放置引起的。您应该将它移到最后一个“else”语句中。

您首先测试 D 的所有元素是否在 C 中的所有元素之外（更大或更小）。如果是，则打印所有零。这很好，但最后你再次打印 F ，这是额外输出的来源。

现在，开始处理您的代码格式......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T16:07:33.097

阅读您的描述和您提供的源代码，您似乎正在执行以下操作。

首先，您读入一个值列表，这些值是一种常量，您想知道它们是否出现在另一个列表中。这是搜索列表。

接下来，您读入一个值列表，您想知道第二个列表中有多少以及其中哪些也在第一个列表中。这是 ValueExist 列表。

为了使搜索过程更容易，您对 SearchFor 值列表进行排序，以便在比较 ValueExist 列表中的特定项目时，只要找到匹配项，或者您发现 SearchFor 列表中的当前项目与您进行比较ValueExist 列表中的当前项目小于 ValueExist 列表中的当前项目 您找到了匹配项，如果它们相等，或者 ValueExist 列表中的值不在 SearchFor 列表中，因为 SearchFor 中的当前比较项目list 小于 ValueExist 列表中当前项的值。

因此，进行匹配的例程如下所示：

```
#include <stdio.h>
#include <stdlib.h>

//this function detects if the element 'input' is appears in the 
//first list called 'c'
//The output returns 0 if not, and the '(i+1)th' place 'input' 
//appears in 'c'

//Since we sort each list and since we want the output to appear 
//in the order each element  the second list's elements were input,
//we define a 'Spec' to keep in mind each index of the second list's 
//elements
struct Spec {
    int iValue;
    int iIndex;
};

//function qsort() uses to sort the first list 'c'
int compare (void *a, void *b)
{
    return ( *(int *)a - *(int *)b );
}

//function qsort() uses to sort the second list called 'd'
int comp(const void* a, const void* b)
{

    const struct Spec *A = (const struct Spec*) a;
    const struct Spec *B = (const struct Spec*) b;
    return (A->iValue - B->iValue);
}

int main()
{
    int i, iExist;

    //the size of the first list 'c'
    int N;
    printf ("Enter number of values for SearchFor list\n");
    scanf("%d",&N);
    int rank=N;

    //declaring and sorting the first list 'c'
    int SearchFor[N];
    for(i = 0; i < N; ++i)
    {
        printf ("Enter value for index %d\n", i);
        scanf("%d", &SearchFor[i]);
    }
   qsort (SearchFor, N, sizeof(int), compare);

    //the size of the second list 'd'
    int M;
    printf ("\nEnter number of values to search for\n");
    scanf("%d",&M);

    //declaring and sorting the second list 'd'
    struct Spec* ValueExist = (struct Spec*)calloc(M, sizeof(struct Spec));
    for (i = 0; i < M; i++) {
        // remember the original index for this value
        ValueExist[i].iIndex = i;
        // get the value for this index
        printf ("Enter value for index %d\n", i);
        scanf("%d", &ValueExist[i].iValue);
    }

    qsort (ValueExist, M, sizeof(struct Spec), comp);

    for (iExist = 0; iExist < M; iExist++) {
       for (i = 0; i < N; i++) {
          if (ValueExist[iExist].iValue == SearchFor[i]) {
             // value found
             printf ("Value of %d at index %d found.\n", ValueExist[iExist].iValue, ValueExist[iExist].iIndex);
             break;
           } else if (ValueExist[iExist].iValue < SearchFor[i]) {
              break;
           }
        }
     }
     return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:42:23.230

要加快代码速度，请将现有的 search() 函数替换为[Binary Search](http://en.wikipedia.org/wiki/Binary_search_algorithm)。

此外，请查看代码行`if((d[i].val<c[0])){f[d[i].ind]=0;}`并验证您希望比较的`c[0]`不是`c[i]`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-31T14:40:32.860

您的代码无法编译成功，因为“N”不能是 vari int c[N];

# c++ - c ++ Boost asio错误：没有共享密码

> ID：12217346
> 
> 赞同：2
> 
> 时间：2012-08-31T14:23:26.860
> 
> 标签：c++, boost, ssl, boost-asio

我目前正在使用 boost asio 设置 RESTful API。

通过 HTTP 从客户端连接可以正常工作。但是，如果我尝试通过 HTTPS 连接，我会在服务器端收到错误消息：“没有共享密码”。该错误似乎来自 openssl 实现，但我不知道该怎么做。我的第一个猜测是没有设置密码算法，但我看不出如何在 asio.

这是我在代码中输入的内容以及发生错误的位置：

```
auto acceptHandler = boost::bind(&self::onAccept, this, connection,
                                 boost::asio::placeholders::error);
connection->async_accept(m_acceptor, acceptHandler);

m_sslContext.set_options(
        context::default_workarounds | context::no_sslv2 | context::single_dh_use);
m_sslContext.use_certificate_file(filename, context::pem);
m_sslContext.use_private_key_file(filename, context::pem); 
```

有人以前有过这个或让它工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T10:18:38.023

我遇到了同样的问题并以这种方式解决了。您必须为您的服务器生成私钥和证书文件。这是这样做的程序：

```
// Generate a new ssl private key :
$openssl genrsa -out privkey.pem 1024

// Create a certificate signing request using your new key
$openssl req -new -key privkey.pem -out certreq.csr

// Self-sign your CSR with your own private key:
$openssl x509 -req -days 3650 -in certreq.csr -signkey privkey.pem -out newcert.pem

// Install the signed certificate and private key for use by an ssl server
// This allows you to use a single file for certificate and private key
$( openssl x509 -in newcert.pem; cat privkey.pem ) > server.pem

// If you use a dh temp file :
$openssl dhparam -outform PEM -out dh512.pem 512 
```

然后，将`server.pem`和`dh512.pem`文件复制到您的服务器执行目录中。

如果您使用 tmp dh 文件，您还必须添加这行代码`m_sslContext.use_tmp_dh_file("dh512.pem");`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-25T08:23:46.627

`boost::asio::ssl::context`将未配置的对象提供给对象构造函数时出现相同的错误`boost::asio::ssl::stream`，然后将其用作接受的结果套接字：

```
server()
    : m_acceptor(/*args*/)
    , m_context(boost::asio::ssl::context::tlsv1_server)
    , m_stream(m_io_service, m_context)
{
    // `m_context` configuring, BUT `m_stream` is unaffected
    m_acceptor.async_accept(m_stream.lowest_layer(), accept_result_handler);
}
// run somewhere `m_io_service.run()`, or other processor of `async` operations. 
```

在实际接受连接并在其上处理握手之后，握手处理程序接收`boost::system::error_code`值为 336109761 和 message `no shared cipher`。

所以首先创建和配置`boost::asio::ssl::context`，然后`boost::asio::ssl::stream`用它构建：

```
typedef boost::asio::ip::tcp::socket socket_type;
typedef boost::asio::ssl::stream<socket_type> stream_type;

std::shared_ptr<stream_type> m_stream;

server()
    : m_acceptor(/*args*/)
    , m_context(boost::asio::ssl::context::tlsv1_server)
{
    // `m_context` configuring
    m_stream = std::make_shared<stream_type>(m_io_service, m_context);
    m_acceptor.async_accept(m_stream->lowest_layer(), accept_result_handler);
} 
```

并且不要忘记为每个新连接创建新流，上下文可以相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-14T12:16:19.287

正如@asiocity 指出的那样，重要的部分是在初始化 ssl::stream**之前****完全配置**ssl::context 。

 **很难在初始化列表中同时初始化它们，同时仍然推迟 ssl::stream 直到 ssl::context 完全配置。

我使用的一种方法是子类化 ssl::context 并覆盖构造函数，以便在初始化 ssl::stream 之前可以在初始化列表中对其进行完全配置。

例如

```
class server_context : public boost::asio::ssl::context {
  public: server_context(boost::asio::ssl::context::method m, std::string certfile);
}; 
```

...

```
server_context::server_context(boost::asio::ssl::context::method m, std::string certfile)
: boost::asio::ssl::context(m)
{
  use_private_key_file(certfile);
  use_certificate_chain_file(certfile);
} 
```

...

```
class myclass {
  private:
    server_context : ssl_context_;
    boost::asio::ssl::stream<boost::asio::ip::tcp::socket&> stream_;
  public:
    myclass(boost::asio::ip::tcp::socket&, std::string certfile); 
```

...

```
myclass::myclass(std::string certfile) 
: ssl_context_(boost::asio::ssl::context::sslv23, certfile),
  stream_(socket, ssl_context_) 
{
  ...
} 
```

然而，避免 shared_ptr 似乎需要做很多工作

我希望/希望有一些构造函数-mixin/模板技巧，它允许我只使用自定义初始化列表而不是子类来做到这一点。**

# javascript - 在标记弹出窗口中显示 Flash 内容

> ID：12217350
> 
> 赞同：0
> 
> 时间：2012-08-31T14:23:32.150
> 
> 标签：javascript, javascript-framework, leaflet

我尝试通过 Leaflet 在弹出窗口中添加 swf 对象：

```
var swfContent = '<object><embed src="StrobeMediaPlayback.swf" type="application/x-shockwave-flash" ... 
marker.bindPopup(swfContent); 
```

但是当点击标记时会出现空的弹出窗口。是否有可能在带有 Leaflet 的弹出窗口中显示 swf 内容？（在 Openlayers 的帮助下没问题）

提前致谢

# sd-card - SPI模式下的SD卡写入速度

> ID：12217358
> 
> 赞同：3
> 
> 时间：2012-08-31T14:24:29.933
> 
> 标签：sd-card, microcontroller, spi, fat32, lpc

我有一张通过 SPI 模式连接到微控制器的 SD 卡（或 SDHC 卡）。我正在使用[Chan 的 FAT](http://elm-chan.org/fsw/ff/00index_e.html)库。我向它写入来自 8192 字节缓冲区的数据（由于 RAM 不足，缓冲区不能更大）。这种写入是定期执行的。通常，在缓冲区再次填充之前，写入已准备好。但是偶尔（也取决于缓冲区填充速度）会出现问题，并且在必须写入新缓冲区之前写入尚未准备好，从而导致数据丢失。

顺便说一句，扇区大小也设置为 8192 字节，但其他似乎没有影响。

可以用范围监控写作，并表明有时写作需要很长时间。例如，比平时长四倍。

这里发生了什么，也许我该如何防止这种情况发生？这与读取、修改、写入序列有关吗？我需要外部 RAM 缓冲区吗？还是有更好的方法来提高性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:38:42.077

不是软件原因，但[闪存](http://en.wikipedia.org/wiki/Flash_memory)从根本上具有不同的写入时间。原因是执行写入所需的电压经过仔细平衡。太高会造成永久性损坏，太低可能无法改变数值。后者是自动处理的，结果只是“轻微”的口吃。然而，这种口吃对你来说似乎太长了，因为你的缓冲区很小。

解决方案？我们过去使用过昂贵[的单级](http://en.wikipedia.org/wiki/Multi-level_cell#Single-level_cell)(SLC) SD 卡。即使是现在，我们仍坚持对所有固件版本进行认证。我们当然不会在现货市场上购买 SD 卡。

# python - 如何使用 python API 将元字段添加到 Shopify 集合？

> ID：12217359
> 
> 赞同：3
> 
> 时间：2012-08-31T14:24:30.393
> 
> 标签：python, shopify

我正在使用 shopify Python API。只有一个简短的教程

[http://wiki.shopify.com/Using_the_shopify_python_api](http://wiki.shopify.com/Using_the_shopify_python_api)

它不包括任何关于元字段的内容。我不确定如何将 shopify API 转换为 Python API 的命令。具体来说，我想知道如何将元字段添加到 Shopify 资源中，例如添加到自定义集合中。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:45:19.773

元字段有两个[前缀选项](http://wiki.shopify.com/Using_the_shopify_python_api#Prefix_Options)`resource`和，`resource_id`否则它们就像其他资源一样。

所以API文档中的create [Metafield create](http://api.shopify.com/metafield.html#create)动作可以如下执行。

```
metafield = Metafield({'value_type': 'integer', 'namespace': 'inventory', 'value': 25, 'key': 'warehouse', 'resource': 'products', 'resource_id': 632910392})
metafield.save() 
```

资源上还有一个 add_metafield 方法，可以采用元字段将上面的内容简化为以下内容。

```
product = Product.find(632910392)
metafield = Metafield({'value_type': 'integer', 'namespace': 'inventory', 'value': 25, 'key': 'warehouse'})
product.add_metafield(metafield) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-31T14:27:49.720

[这里](http://api.shopify.com/metafield.html)有关于在 Shopify API 中使用元字段的 API文档。

# .net - 你怎么知道在 DocumentViewer 上点击了哪个 PageView？

> ID：12217367
> 
> 赞同：1
> 
> 时间：2012-08-31T14:24:47.763
> 
> 标签：.net, wpf, documentviewer

很明显，如果只有一个页面可见，但如果多个页面可见，你怎么知道用户点击了哪个页面？我查看了它的属性，并没有真正突出。即使我找到一种方法一次只显示一页，也没关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:38:23.000

您可以尝试 IsMouseCaptured 属性。我在 MSDN 上找到了这个...

[MSDN 上的 UIElement.IsMouseCaptured](http://msdn.microsoft.com/en-us/library/system.windows.uielement.ismousecaptured%28v=vs.85%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T16:14:24.070

我进行了输入命中测试并将其变成了 FixedPage。如果这是空的，显然没有点击页面。然后我浏览了 DocumentViewer 中的每个 FixedPage 并找到了匹配的页面。

# mysql - 使用 Active Record 在 CodeIgniter 中的查询中的 DATE_FORMAT 不起作用

> ID：12217368
> 
> 赞同：3
> 
> 时间：2012-08-31T14:24:48.773
> 
> 标签：mysql, codeigniter, activerecord, codeigniter-2

编码器。我在这里遇到了一个小问题，找不到解决方案。我正在使用 CI 中的 Active Record 构建查询。这是查询的代码：

```
 $this->db->select("u.id AS user_id, u.email, p.display_name, p.first_name, p.last_name, s.status_id, s.message");
    $this->db->select("DATE_FORMAT(s.created_at, `Publicado el %d/%m/%Y a las %h:%i %p`) AS created_at", FALSE);

 $this->db->join($this->_table_users . ' u', 'u.id = s.user_id');
 $this->db->join($this->_table_profiles . ' p', 'p.user_id = u.id');

 $this->db->where_in('user_id', $str);
 $this->db->where('deleted', 0);

 $this->db->from($this->_table . ' s');

 $this->db->order_by('s.created_at', 'desc'); 
```

但我收到了这个错误：

> 错误号：1054
> 
> '字段列表'中的未知列'Publicado el %d/%m/%Y a las %h:%i %p'
> 
> 选择`u`。作为用户ID `id`，。, . , . , . , . , . , DATE_FORMAT(s.created_at, ) AS created_at FROM ( s, ) JOIN > u ON 。= 。加入p 。= 。WHERE IN ('5726, 2, 10293') AND = 0 ORDER BY 。描述限制 2`u``email``p``display_name``p``first_name``p``last_name``s``status_id``s``message``Publicado el > %d/%m/%Y a las %h:%i %p``default_status``default_status``default_users``u``id``default_s``user_id``default_profiles``p``user_id``u``id``user_id``deleted``s``created_at`

有谁知道我可以在这个查询中使用 DATE_FORMAT 吗？有趣的是与纯 SQL 工作相同的查询编写 干杯并提前感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T14:32:03.923

添加 FALSE 作为 SELECT 语句中的第二个参数。您可能还必须在 WHERE 子句中执行类似的操作。

一些要查看的链接：

[http://ellislab.com/forums/viewthread/74206/#368778](http://ellislab.com/forums/viewthread/74206/#368778)

[http://ellislab.com/forums/viewthread/206962/#963061](http://ellislab.com/forums/viewthread/206962/#963061)

[http://ellislab.com/codeigniter/user-guide/helpers/date_helper.html](http://ellislab.com/codeigniter/user-guide/helpers/date_helper.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T02:46:49.117

纠正您的选择

```
$this->db->select("u.id AS user_id, u.email, p.display_name, p.first_name, p.last_name, s.status_id, s.message");
$this->db->select("DATE_FORMAT(s.created_at, `%d/%m/%Y`) AS created_at", FALSE);

$this->db->join($this->_table_users . ' u', 'u.id = s.user_id');
$this->db->join($this->_table_profiles . ' p', 'p.user_id = u.id');

$this->db->where_in('user_id', $str);
$this->db->where('deleted', 0);

$this->db->from($this->_table . ' s');

$this->db->order_by('s.created_at', 'desc'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-09T21:58:12.660

对我有用的一个技巧是将日期格式字符串放在括号内。例如替换

```
DATE_FORMAT(`pf_Partido`.`fecha`,'%d-%m-%Y') 
```

经过

```
DATE_FORMAT(`pf_Partido`.`fecha`,('%d-%m-%Y')) 
```

在您的情况下，代码将是

```
$this->db->select("DATE_FORMAT(s.created_at, ('Publicado el %d/%m/%Y a las %h:%i %p')) AS created_at"); 
```

*- 迟到总比不到好*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T17:14:59.957

看返回信息，格式'Publicado el > %d/%m/%Y a las %h:%i %p'不能用`传递，codeigniter去掉，需要用'（单引号）来分隔它们。有关更多信息，请参阅： [http ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

# java - struts2 转义命名空间定义

> ID：12217369
> 
> 赞同：0
> 
> 时间：2012-08-31T14:24:51.117
> 
> 标签：java, struts2

在我的 struts.xml （包名称是`website`）中，我有一个包含到子 xml 的内容：

```
<include file="child.xml"/> 
```

`action`我的struts.xml 中也有一个欢迎词：

```
<action name="welcome">
     <result>welcome.jsp</result>
</action> 
```

我的 child.xml 扩展了 struts.xml：

```
<package name="child" namespace="/child" extends="website"> 
```

接下来我想做的是在我的 child.xml 中创建一个重定向到该操作的`welcome`操作。到目前为止，我的 child.xml 中有以下内容，但它不起作用：

```
<action name="">
     <result type="redirectAction">welcome</result>
</action> 
```

我认为它不起作用的原因是因为它`/child/welcome`默认会转到 URL 而不是`/welcome`. 因此，如果可能的话，我需要一种方法来`action`在 child.xml 的定义中转义它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T16:14:18.373

`RedirectAction`结果可以有 Struts2 定义的 2 个特定参数。其中一个是`actionName`，另一个是`namespace`。那么，如果你想在你的包内重定向到它在命名空间之外的一个动作，你必须把以下内容放在你的`child.xml`：

```
<action name="whatever">
    <result type="redirectAction">
        <param name="actionName">welcome</param>
        <param name="namespace">/</param>
    </result>
</action> 
```

`redirectAction` [您可以在此处查看](http://struts.apache.org/2.3.4/docs/redirect-action-result.html)与结果类型相关的所有文档。您有一个完整的示例，说明如何在页面底部重定向到不同的命名空间。

# perl - 期权的价值通常是从零开始的指数还是从一开始的指数？

> ID：12217370
> 
> 赞同：1
> 
> 时间：2012-08-31T14:24:57.260
> 
> 标签：perl, api, indexing

使用“粗体”选项，我可以选择一个应该打印为粗体的元素。我应该对第一个元素（一个）使用“0”还是“1”？

```
my_print( [ 'one', 'two', 'three' ], { bold => 1 } ); 
```

或者

```
my_print( [ 'one', 'two', 'three' ], { bold => 0 } ); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T15:58:40.523

规范的答案是这样的：

![xkcd 163](../Images/7093d4853d0eeaec47defd8a04b43ab8.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-31T14:28:17.300

Perl 中的索引从一开始，`0`所以我建议您也以这种方式实现它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:28:38.517

在 Perl 中，数组通常（但不一定）从零开始，所以第二个例子应该是正确的。但这当然取决于实施。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:38:56.883

好吧，Perl 显然不是唯一一种默认情况下其数组从 0 开始索引的语言，因此您的问题可能看起来相当琐碎。

另一方面，也许我得到了它的原因。可能你的子程序是用类似的东西写的......

```
sub my_print {
  my ($elements_aref, $options_href) = @_;
  if ( $options_href->{bold} ) {
    make_them_bold( $elements_aref->[ $options_href->{bold} ] );
  }
} 
```

...如果要加粗数组的第一个元素，这显然不会加粗。

我仍然认为这是要走的路，有一个修改：将条件更改为

```
 if ( exists $options_href->{bold} ) { ... } 
```

这样一来，您就可以保持阅读您的代码的任何人的理智（理智 = 假设您将数组索引为好人），但会在您的选项检查中取得成功。

# c++ - C++ intrusive_ptr 问题

> ID：12217372
> 
> 赞同：0
> 
> 时间：2012-08-31T14:25:02.210
> 
> 标签：c++, boost, namespaces, smart-pointers, forward-declaration

我想`boost::intrusive_ptr`用于引用我的 class `x::Y`，所以我为and函数添加了一个`references`字段和朋友声明，它们应该在 namespace 中定义。然后，我编写这些函数。像这样：`release``add_ref``boost`

```
namespace x{

    class Y{
        long    references;
        friend void boost::intrusive_ptr_add_ref(x::Y * p);
        friend void boost::intrusive_ptr_release(x::Y * p);
    };
}

namespace boost
{
    void intrusive_ptr_add_ref(x::Y * p)
    {
        ++(p->references);
    }

    void intrusive_ptr_release(x::Y * p)
    {
        if (--(p->references) == 0)
            delete p;
    }
} 
```

代码无法编译，我收到以下错误：

```
test/test6.cpp:8:18: error: ‘boost’ has not been declared
test/test6.cpp:9:18: error: ‘boost’ has not been declared
test/test6.cpp: In function ‘void boost::intrusive_ptr_add_ref(x::Y*)’:
test/test6.cpp:7:11: error: ‘long int x::Y::references’ is private
test/test6.cpp:17:9: error: within this context
test/test6.cpp: In function ‘void boost::intrusive_ptr_release(x::Y*)’:
test/test6.cpp:7:11: error: ‘long int x::Y::references’ is private
test/test6.cpp:22:13: error: within this context 
```

我以为我做了 boost 文档中解释的所有事情，但似乎我做错了什么。哪里有问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:32:19.327

`boost`错误是因为您在该命名空间的任何声明之前引用了类定义中的命名空间。`namespace boost`您可以通过在类定义之前声明来修复它；您还需要声明函数，为此您还需要声明类和命名空间：

```
namespace x {class Y;}
namespace boost
{
    void intrusive_ptr_add_ref(x::Y * p);
    void intrusive_ptr_release(x::Y * p);
} 
```

但是，如果将函数不放在`boost`名称空间中，而是放在包含您的类的名称空间中（即 in `namespace x`）可能会更好。然后`intrusive_ptr`将通过依赖于参数的名称查找找到正确的版本。这不需要在类之前进行任何声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:32:44.880

在这个特定的最小代码中，您似乎遗漏了一些东西

```
namespace x { class Y; }
namespace boost {
        void intrusive_ptr_add_ref(x::Y * p);
        void intrusive_ptr_release(x::Y * p);
} 
```

在一开始的时候。也就是说，前向声明 Y 并声明您的函数。虽然你为什么要经历这种痛苦只是为了将你的函数放入它们不属于的名称空间中，这超出了我的理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:33:36.890

您需要转发声明它们。

如果你的编译器支持 Argument Dependent Lookup，你应该把函数`intrusive_ptr_add_ref`和`intrusive_ptr_release`放入你自己的命名空间中，并在那里声明它们。

```
namespace x{
    void intrusive_ptr_add_ref(x::Y * p);

    void intrusive_ptr_release(x::Y * p);

    class Y{
        long    references;
        friend void boost::intrusive_ptr_add_ref(x::Y * p);
        friend void boost::intrusive_ptr_release(x::Y * p);
    };

    void intrusive_ptr_add_ref(x::Y * p)
    {
        ++(p->references);
    }

    void intrusive_ptr_release(x::Y * p)
    {
        if (--(p->references) == 0)
            delete p;
    }
} 
```

编辑：如果您希望将它们放在 boost 命名空间中，则可以改为通过在类之前使用这两个函数声明来声明 boost 命名空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T14:34:12.297

您可以在 中定义这些函数`namespace x`。但是如果你想在 中声明函数`namespace boost`，请使用类似这样的东西

```
#include <boost/intrusive_ptr.hpp>

namespace x
{
   class Y;
}

namespace boost
{
    void intrusive_ptr_add_ref(x::Y * p);
    /*{
        ++(p->references);
    }*/

    void intrusive_ptr_release(x::Y * p);
    /*{
        if (--(p->references) == 0)
            delete p;
    }*/
}

namespace x{

    class Y{
        long    references;
        friend void boost::intrusive_ptr_add_ref(x::Y * p);
        friend void boost::intrusive_ptr_release(x::Y * p);
    };
}

namespace boost
{
    void intrusive_ptr_add_ref(x::Y * p)
    {
        ++(p->references);
    }

    void intrusive_ptr_release(x::Y * p)
    {
        if (--(p->references) == 0)
            delete p;
    }
} 
```

[http://liveworkspace.org/code/99cb62380019ccb39993f0a9e656eff2](http://liveworkspace.org/code/99cb62380019ccb39993f0a9e656eff2)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T14:29:21.223

如果您在与类相同的命名空间中定义[`intrusive_ptr_add_ref`](http://www.boost.org/libs/smart_ptr/intrusive_ptr.html#Introduction)and ，它将起作用，即在.[`intrusive_ptr_release`](http://www.boost.org/libs/smart_ptr/intrusive_ptr.html#Introduction)`::x::Y``::x`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-31T14:32:35.020

第一个错误表明您没有包含任何提升标头。其余是因为第一个错误导致`friend`声明解析失败。

# objective-c - 将 ABPeoplePickerNavigationController 的显示属性与 ARC 一起使用

> ID：12217374
> 
> 赞同：0
> 
> 时间：2012-08-31T14:25:18.823
> 
> 标签：objective-c

我正在使用在启用 ARC 的 iOS 5+ 项目中截取的这段代码：

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
picker.peoplePickerDelegate = self;
picker.displayedProperties = [NSArray arrayWithObject:[NSNumber numberWithInt:kABPersonAddressProperty]]; 
```

不幸的是，这不起作用，因为它会导致编译错误：

> 架构 armv7 的未定义符号：“_kABPersonAddressProperty”，引用自：…</p>

kABPersonAddressProperty 返回一个`ABPropertyID`基本上是一个的，`int`所以我认为 ARC 不应该关心它。

为什么这不起作用，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T18:00:46.200

只需确保您已通过项目设置下的“构建阶段”选项卡添加了适当的框架。向下滚动到“Link Binary with Libraries”，然后单击 + 图标。

还要确保`#imported`在相应的类中也有适当的 .h 文件。

# android - Android 应用列表列表

> ID：12217381
> 
> 赞同：1
> 
> 时间：2012-08-31T14:25:44.277
> 
> 标签：android, list, listview, listadapter, sqlite

我正在查看其他列表帖子列表，但它们似乎对我的情况没有帮助或可用（也许我只是愚蠢）。无论如何，我正在构建一个需要登录到列表的应用程序，您可以在其中添加一个项目，如果选择该项目，将显示一个新的空列表，可以在其中添加项目。

例如，假设您登录，第一个列表是锻炼列表。该列表包括具有以下字段的项目：

```
workout_list_name_ , 
workout_list_type, and 
workout_list_date. 
```

如果您选择该项目，它会将您带到一个空列表（新活动），您可以在其中添加一个带有字段的项目：

```
item_name , 
item_sets,item_reps, 
item_weight, 
item_completed(boolean value user can change if they have already completed it). 
```

这就是我的问题所在：我有这两个 ListView 都带有`android:id="@+id/android:list"`. 两个 ListView 都使用**SimpleCursorAdapter**来显示我要添加的行的 xml 布局。当我创建锻炼列表并保存它时，它会添加到我的 sqlite 数据库中，但它没有显示在我的 ListView 中。

**如何更改我的 ListView 结构和适配器以显示数据？** 我想摆脱

```
WorkoutList extends ListActivity 
```

并使其仅扩展**Activity**，但我只是不确定如何实现这一点。

**你能帮助我吗？**

这是我的第一个列表的代码：

```
public class WorkoutList extends ListActivity {

Button addNewWorkout;
WorkoutDbAdapter mDbHelper;
public static final int CREATE_WORKOUT = 1;
//public static final int EDIT_WORKOUT = 2;
public static final int SET_WORKOUT = 2;
String dateCreated = null;
Calendar now = null; 
SimpleDateFormat format = null;
ListView myList;

Intent prevIntent ;
String woName,userName;

@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.workout_list);

    addNewWorkout = (Button) findViewById(R.id.btnNewWorkout);
    prevIntent = getIntent();
    userName = prevIntent.getStringExtra("userName");

    // do the work for getting the current time and formatting it
    now = Calendar.getInstance();
    format = new SimpleDateFormat("EEE MMM dd hh:mm aaa");
    dateCreated = format.format(now.getTime());

    mDbHelper = new WorkoutDbAdapter(this);
    mDbHelper.open();

    myList = (ListView)findViewById(R.id.workout_list);

    registerForContextMenu(myList);

    myList.setDivider(getResources().getDrawable(R.color.mainDivider));
    myList.setDividerHeight(1);

    addNewWorkout.setOnClickListener(NewWorkout);

    fillData();
}

OnClickListener NewWorkout = new OnClickListener(){

    public void onClick(View arg0) {

        Intent newWorkout = new Intent();
        newWorkout.setClass(getApplicationContext(), AddWorkout.class);
        newWorkout.putExtra("dateCreated", dateCreated );
        newWorkout.putExtra("userName", userName);
        startActivityForResult(newWorkout, CREATE_WORKOUT);

    }

};
 //===============================================================================
//
@Override
public void onPause(){
    super.onPause();

}

//===============================================================================
//
@Override
public void onResume(){
    super.onResume();
    mDbHelper.open();
}

@Override
public void onDestroy(){
    super.onDestroy();
    mDbHelper.close();
}

//================================================================================
//
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data){
    super.onActivityResult(requestCode, resultCode, data);

        woName = data.getStringExtra("workoutName");

    fillData();
}

//================================================================================
//
// Fill the data for UI rebuilds
private void fillData(){
    Cursor workoutCursor = mDbHelper.fetchAllWorkouts(userName);
    startManagingCursor(workoutCursor);

    String [] from = new String [] {WorkoutDbAdapter.KEY_WORKOUT_NAME,WorkoutDbAdapter.KEY_WORKOUT_CREATED_DATE ,
            WorkoutDbAdapter.KEY_WORKOUT_TYPE};

    int [] to = new int [] {R.id.dateCreatedLabel, R.id.nameLabel, R.id.typeLabel};

    SimpleCursorAdapter workouts = new SimpleCursorAdapter(this, R.layout.workout_row, workoutCursor, from, to);

    myList.setAdapter(workouts);

}

//===============================================================================
//
@Override
public void onCreateContextMenu(ContextMenu menu , View v, ContextMenuInfo menuInfo){
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    menu.setHeaderTitle("Options");
    menu.setHeaderIcon(R.drawable.ic_launcher);
    inflater.inflate(R.menu.list_item_longpress, menu);
}

//===============================================================================
//
@Override
public boolean onContextItemSelected(MenuItem item){
    switch(item.getItemId()){
    case R.id.menu_delete:
        final AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
        AlertDialog.Builder confirmAlert = new AlertDialog.Builder(this)
        .setIcon(R.drawable.ic_launcher)
        .setTitle("Are you Sure?")
        .setMessage("This will permanently delete the workout and all subsequent exercises from your workout list. " +
                        "Are you sure you want to continue?")
        .setPositiveButton("Ok", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                mDbHelper.deleteWorkout(info.id);
                fillData();
            }
        })
        .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                dialog.cancel();                
            }
        });
        confirmAlert.show();
        return true;
    case R.id.menu_cancel:
        return false;
    }
    return super.onContextItemSelected(item);

}

//================================================================================

protected void onListItemClick(ListView myList, View v, int position, final long id){
    super.onListItemClick(myList, v, position, id);
    AlertDialog.Builder dialog = new AlertDialog.Builder(this)
    .setIcon(R.drawable.edit)
    .setTitle("Update Selected Workout")
    .setMessage("Would you like to update the current Workout? Click continue to proceed.")
    .setPositiveButton("Continue", new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface arg0, int arg1) {
            final Intent i = new Intent(getBaseContext(), ExerciseList.class);
        i.putExtra(WorkoutDbAdapter.KEY_ROW_ID, id);
        i.putExtra("workoutName", woName);
        startActivityForResult(i, SET_WORKOUT);

        }
    })
    .setNegativeButton("Back", new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface dialog, int which) {
            dialog.cancel();

        }
    });
    dialog.show();
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T16:49:03.163

我似乎通过另一篇文章找到了自己的答案。我找错地方了，这里是实现`ListView`无的方法的链接`extends ListViewActivity`

[Android如何在不扩展listActivity的情况下为listView使用适配器](https://stackoverflow.com/questions/8267060/android-how-to-use-adapter-for-listview-without-extending-listactivity)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T17:12:08.103

根据您的需求，您的代码看起来很乱，而且很难维护。
仅当屏幕上的唯一内容是您的列表时，您才应该使用 ListActivity，否则不要使用。所以首先摆脱ListActivity。以下是您可以遵循的几个步骤：

*   摆脱 ListActivity。让你类扩展 Activity。
*   为您的活动维护一个 xml 布局，其中将包含您的列表视图和您要显示的其他项目。像这样的东西会起作用：

    ```
    <RelativeLayout 

       xmlns:android="http://schemas.android.com/apk/res/android"
       android:layout_width="fill_parent"
       android:layout_height="fill_parent"
       android:orientation="vertical" >

       <ListView
           android:id="@+id/list"
           android:layout_width="fill_parent"
           android:layout_height="fill_parent"
           android:cacheColorHint="#00000000" />
    </RelativeLayout> 
    ```

*   为第一个（主）listView 创建一个项目列表（数组、列表等）。使用这些项目创建一个适配器并将其设置为列表适配器。

*   对于此列表中的不同项目，创建不同的空列表集（数组、列表等）。
*   设置此 ListView 的单击侦听器并实现其 onClick 方法。
*   在 onClick 方法中，根据项目的位置创建一个具有相应空列表（数组、列表等）的适配器，并将其设置为当前列表视图的适配器。
*   现在将项目添加到此列表并在列表适配器上调用 notifyDataSetChanged() 以使用当前添加的项目更新列表。

# ios - 是否可以在 OpenGL ES 2.0 / iOS 上渲染到 8 位纹理帧缓冲区？

> ID：12217382
> 
> 赞同：2
> 
> 时间：2012-08-31T14:25:45.293
> 
> 标签：ios, opengl-es-2.0, framebuffer

我需要将某些内容渲染到屏幕外缓冲区，并通过调用将像素读回“CPU 内存” `glReadPixels`。我的代码在 Windows 下编译为普通 OpenGL 时效果很好，但是为了让它在 iOS 中的 OpenGL ES 2.0 下运行，我不得不用一个替换`GL_ALPHA`（或`GL_LUMINANCE`）纹理`GL_RGBA`，这意味着

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA,  width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL); 
```

代替

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_ALPHA,  width, height, 0, GL_ALPHA, GL_UNSIGNED_BYTE, NULL); 
```

我无法使用 8 位纹理运行代码。

但是由于我不需要此渲染的全色，因此每个像素额外的 3 个字节都被浪费了。在我再次尝试之前，这里是我的问题：

**有没有人成功地在屏幕外渲染到 8 位纹理并将字节读回 CPU 内存？有可能吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T05:47:13.127

将 glRenderbufferStorage 格式设置为 GL_R8_EXT，将 glReadPixels/glTexImage2D 格式设置为 GL_RED_EXT。

[http://www.khronos.org/registry/gles/extensions/EXT/EXT_texture_rg.txt](http://www.khronos.org/registry/gles/extensions/EXT/EXT_texture_rg.txt)

[http://developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniPhoneOS/Articles/iOS5.html#//apple_ref/doc/uid/TP30915195-SW47](http://developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniPhoneOS/Articles/iOS5.html#//apple_ref/doc/uid/TP30915195-SW47)

编辑：我已经对此进行了测试，它可以工作，但仅适用于 A5 及更高版本（iPad2/3/4/mini、iPhone4S/5、iPod touch 第 5 代）。不幸的是，它在最需要它的 A4 和更早版本（iPhone4、iPod touch 第 4 代、3GS、iPad1）上不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-10T00:03:38.037

要使其在 OpenGL 3.0 中运行，您可以使用 GL_R8 作为缓冲区：

```
glGenFramebuffers(1, &_framebuffer);
glBindFramebuffer(GL_FRAMEBUFFER, _framebuffer);

glGenRenderbuffers(1, &_renderBuffer);
glBindRenderbuffer(GL_RENDERBUFFER, _renderBuffer);
glRenderbufferStorage(GL_RENDERBUFFER, GL_R8, 640, 480);
glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0,
                          GL_RENDERBUFFER, _renderBuffer);

GLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER) ;
if(status != GL_FRAMEBUFFER_COMPLETE) {
  NSLog(@"failed to make complete framebuffer object %x", status);
} 
```

# java - 泛型方法的类型参数有什么作用？

> ID：12217383
> 
> 赞同：2
> 
> 时间：2012-08-31T14:25:45.360
> 
> 标签：java, guava

我很感兴趣为什么这段代码会产生语法错误，说 ImmutableMap 无法解析为类型：

```
ImmutableMap<String, String> advice = ImmutableMap<String, String>.builder()
                    .put(KEY1, VAL1)
                    .put(KEY2, VAL2)
                    .build(); 
```

虽然此代码按预期工作：

```
ImmutableMap<String, String> advice = ImmutableMap.<String, String>builder()
                    .put(KEY1, VAL1)
                    .put(KEY2, VAL2)
                    .build(); 
```

这个时期并没有像我的心理模型应该去的那样，我希望有人能解释为什么这个时期的“方法方面”会发生。我正在使用 Guava 的 ImmutableMap，但我认为它并不完全相关。我认为它与泛型有关，但我不确定是什么，我不确定如何搜索以找到更好的答案，因为我不知道这个概念会被称为什么。

编辑：作为参考，[ImmutableMap](https://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/collect/ImmutableMap.java#128)有这一行`builder()`

```
public static <K, V> Builder<K, V> builder() {
    return new Builder<K, V>();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T14:28:47.323

builder() 是一个静态方法，它具有与之关联的泛型类型，而不是它定义的类。它将类似于

```
public static <K,V> ImmutableMap.Builder<K,V> builder() { ... } 
```

注意：`<K, V>`这里与类的泛型类型没有任何关系。（不一定是通用的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:28:15.670

由于 Java 实现泛型的方式，通过类型擦除（转换）而不是扩展，实际上只`ImmutableMap`加载了一个类。因此，它的静态`builder`方法需要解决特定的泛型重载。将变量声明`advice`为`ImmutableMap<String, String>`编译器的语法糖，然后在调用**实例**方法时假定相关的重载`advice`。但是静态方法调用`ImmutableMap`必须单独指定。这就是为什么泛型出现在点的方法一侧的原因。

这在通过扩展实现泛型的语言（例如 C#）中会有所不同，其中每个泛型映射类型将作为单独的类型加载到 CLR 中，因此`ImmutableMap<String, String>`具有不同静态方法的不同类型将用于`ImmutableMap<Foo, Bar>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T09:48:37.647

很难找到有关此概念的信息，因为它有点晦涩难懂。我不得不搜索 Angelika Langer 的伟大泛型常见问题解答一段时间才能找到它，即使我知道它......

无论如何，它被称为“显式类型参数规范”，当您想要显式指定泛型方法的类型参数时使用它，通常是因为编译器无法从上下文推断它（例如，在链接方法调用时），或者因为您想要帮助编译器在各种重载之间进行选择：

[http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#FAQ402](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#FAQ402)

有关类型参数推断的更多信息：

[http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#FAQ400](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TechnicalDetails.html#FAQ400)

# python - 如何从字符串“long”创建一个 numpy dtype？

> ID：12217385
> 
> 赞同：3
> 
> 时间：2012-08-31T14:25:59.620
> 
> 标签：python, types, numpy

我有一个包含字符串“long”的变量。如何从这个字符串创建一个与 long 类型等效的 numpy dtype 对象？我有一个包含许多数字和相应类型的文件。`int`等都`float`没有问题，只是`long`不起作用。我不想`long -> int32`在我的代码中硬编码一些替换。

```
>>> np.dtype('long')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: data type not understood 
```

另外：有没有办法从纯python中的字符串创建变量类型？我的意思是，我想要 的倒数`int.__name__`，它将类型名称转换为字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T14:29:37.230

在这种特殊情况下，我认为您可以使用`getattr`从`numpy`模块本身获取它：

```
>>> import numpy as np
>>> np.dtype('long')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: data type not understood 
```

但：

```
>>> getattr(np, 'long')
<type 'long'>
>>> np.dtype(getattr(np, 'long'))
dtype('int64')
>>> np.dtype(getattr(np, 'int'))
dtype('int32')
>>> np.dtype(getattr(np, 'float64'))
dtype('float64')
>>> np.dtype(getattr(np, 'float'))
dtype('float64') 
```

# python - python - 在类和函数中使用变量的最佳实践

> ID：12217386
> 
> 赞同：1
> 
> 时间：2012-08-31T14:26:00.803
> 
> 标签：python, variables, global-variables

我正在编写大量代码，但我对在 python 类及其函数中使用变量的最佳方式没有足够的经验，所以我想我会征求一些意见。这是我如何做到的一个例子

```
class MyClass():
    vara = 'Class Variable A'

    def __init__(self):
        self.varb = 'Class instantiation Variable B'

    def a(self):
        varc = 2
        vard = 3

        print 'def a function variables unchanged', varc, vard

        MyClass.vara = 'Class Variable A now changed by def a'

    def b(self):
        print self.varb
        self.varb = 'Class instantiation Variable B now changed by def b'
        print self.varb

if __name__ == "__main__":
    print MyClass.vara

    a = MyClass()
    a.a()
    a.b()

    print MyClass.vara

    a.a() 
```

这给出了这个结果

```
Class Variable A
def a function variables unchanged 2 3
Class instantiation Variable B
Class instantiation Variable B now changed by def b
Class Variable A now changed by def a
def a function variables unchanged 2 3 
```

我在 django 中的应用程序正在使用一个具有大约 25 个函数的类。它是一个测试应用程序，每个函数都代表一个 API 调用。每个 API 调用都会根据结果给出一些变量，我需要这些变量由函数设置以供其他函数使用 - 换句话说，我需要由其他函数调用这些局部函数变量。我想知道做到这一点的最佳方法。

在上面的示例中，我可以使用类中的函数设置类变量 vara，通过这样做`MyClass.vara = 'something'`或者我可以设置实例化构造函数中的变量， `__init__`. 然后我可以使用任何函数调用这些变量。

有什么更好的方法，或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:31:12.477

不确定我是否完全明白你的要求，但如果我理解正确，答案是这取决于你想做什么。`vara`如果您希望为整个类存储一次，则应在类上设置属性（如在您的 中）。如果您想为每个实例设置一个单独的属性，您应该在`__init__`（如您的）中的实例上设置它。`varb`

如果您有一个可变对象（如列表）作为属性的值，则差异会变得更加明显。见下文：

```
>>> class Foo(object):
...     classVar = []
...     def __init__(self):
...         self.instVar = []
>>> f = Foo()
>>> g = Foo()
>>> f.classVar
[]
>>> f.instVar
[]
>>> g.classVar
[]
>>> g.instVar
[]
>>> f.instVar.append(1)
>>> f.instVar
[1]
>>> g.instVar
[]
>>> f.classVar.append(1)
>>> f.classVar
[1]
>>> g.classVar
[1] 
```

请注意，在最后一点，变异`f.classVar`也受影响`g.classVar`。因为这是一个类属性，所以它在类的所有实例之间共享。实例属性 ( `instVar`) 对于每个实例都是独立的。

# c# - 在 ac# 应用程序中打开本地网络上的 .chm 文件

> ID：12217387
> 
> 赞同：2
> 
> 时间：2012-08-31T14:26:08.760
> 
> 标签：c#, html, chm, helpfile

在我的代码中，我尝试使用以下代码从本地网络打开一个帮助文件（.chm）

```
private void helpToolStripMenuItem_Click(object sender, EventArgs e)
{
    Help.ShowHelp(this, @"\\server\Helpfiles\HelpFiles.chm");
} 
```

如果我想在我的应用程序之外打开这个 .chm，出于安全原因，我需要先向我的注册表添加一个密钥。

我认为这也适用于我的应用程序，但它仍然说已取消。

如何打开这个 .chm 文件及其内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:33:38.320

您需要更改机器上的一项安全设置。我使用以下 .reg 文件来进行修改：

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\HTMLHelp\1.x\ItssRestrictions]
"MaxAllowedZone"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\HTMLHelp\1.x\ItssRestrictions]
"MaxAllowedZone"=dword:00000001 
```

在此处阅读所有相关信息：http: [//support.microsoft.com/kb/896358](http://support.microsoft.com/kb/896358)

# jquery - 每次加载页面时，jQuery 移动页面高度都会意外增加

> ID：12217388
> 
> 赞同：1
> 
> 时间：2012-08-31T14:26:09.040
> 
> 标签：jquery, html, jquery-mobile

我真的没有很多信息可以在这里传递，所以如果它太开放了，我很抱歉。

基本上我正在制作一个 jQuery 移动应用程序，每次打开页面（AJAX，不是外部）时，页面 div 的高度都会增加 134px。

我注意到尝试将两个包含 div 的高度设置为加载页面的 50% 高度。我注意到每次加载页面时两个 div 都变得越来越大：

```
var h = $('#storeLocatorMapDisplay').height(); 
$("#map_canvas").css("height", .5*h);
$("#mapLegend").css("height", .5*h);
alert(h); 
```

所以无论如何，我决定以像素为单位设置两个 div 的高度，但是每次访问页面时，“h”高度仍然增加 134px。

希望我不会在这里遗漏一些明显的东西？？？：/

谢谢

# objective-c - 带有项目列表（按钮）的圆形 uiscrollview

> ID：12217396
> 
> 赞同：1
> 
> 时间：2012-08-31T14:26:57.607
> 
> 标签：objective-c, ios, scrollview

我正在尝试使用按钮列表获得圆形滚动，按钮宽度应该是动态的（不固定）。我厌倦了 iCarousel，但问题是它接受 itemWidth 作为静态，这将影响轮播视图中的所有项目。所以有些标题是重叠的，有些标题之间的空间太大。我需要项目宽度应该是动态的。

任何人都可以帮助做同样的事情。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:42:07.163

iCarousel 支持用于显示每个“卡片”的视图中的任何尺寸：

```
- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{
} 
```

您将不得不为每张卡片生成不同的视图（并且肯定会以某种方式缓存它们）。

# c++ - 设置断点，但没有命中断点

> ID：12217399
> 
> 赞同：1
> 
> 时间：2012-08-31T14:27:15.087
> 
> 标签：c++, gdb, chromium

我已经在本地构建了 Chromium，并且正在尝试使用 GDB 对其进行调试。出于某种原因，某些断点似乎没有命中。例如，当我这样做时

```
b InjectedScriptBase::makeEvalCall 
```

GDB 提示

```
Make breakpoint pending on future shared library load? (y or [n]) y
Breakpoint 1 (InjectedScriptBase::makeEvalCall) pending. 
```

但是当触发相关代码时，没有命中断点。

我究竟做错了什么？我目前假设相关符号是在运行时加载的，但我应该单独加载它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:20:50.643

根据[Chromium 消息来源](http://src.chromium.org/multivm/trunk/webkit/Source/WebCore/inspector/InjectedScriptBase.cpp)，这个函数有相当长的签名：

```
void InjectedScriptBase::makeEvalCall(ErrorString* errorString, ScriptFunctionCall& function, RefPtr<TypeBuilder::Runtime::RemoteObject>* objectResult, TypeBuilder::OptOutput<bool>* wasThrown) 
```

所以在设置断点时使用 Tab 补全是值得的。尝试以下操作：

```
b 'InjectedScriptBase::makeEvalCall 
```

并按 Tab 键以自动完成函数名称。gdb 应该为您查找符号表和自动完成函数名称。然后你应该能够设置断点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:33:37.750

确保您有足够的内存来调试 Chromium。或者尝试在另一台内存更大的机器上调试它。

# qt - 在 Qt 中以 unix 样式获取退出目录路径

> ID：12217400
> 
> 赞同：1
> 
> 时间：2012-08-31T14:27:15.413
> 
> 标签：qt, qt4

当我使用

```
QString mydir = QFileDialog::getExistingDirectory(this, "Select the directory","/Home"); 
```

我得到路径为 D:\Myfolder 但我需要它的 unix 风格，即像这样的 D:/Myfolder，我该怎么做？

当我使用 getfilename（用于获取文件路径）时，它对我有利，即 unix 风格，但为什么 Qt 工程师没有为 getExistingDirectory 做同样的事情？有什么解决方法吗？

我在 Windows 7 上

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:51:08.897

您可以使用 QDir::fromNativeSeparators() 将其转换为 unix 样式。我在我的项目中这样做。

例如：
`QString myUnixPath = QDir::fromNativeSeparators("C:\\some\\path\\");`

# jquery - 使用 JQuery 或 Javascript 检测任何 AJAX 调用/请求

> ID：12217401
> 
> 赞同：1
> 
> 时间：2012-08-31T14:27:18.143
> 
> 标签：jquery, ajax, asp.net-mvc, custom-server-controls

我有一个问题，我需要能够检测通用 ASP.NET 页面上的 AJAX 调用。但是，此页面是自动生成的，因此我无法向其中添加任何尚未生成的代码或脚本管理器。

我基本上需要一种使用 JQuery 或通用 JavaScript 检测通用 AJAX 调用的方法。我也无法添加进行 ajax 调用的代码。所以它需要尽可能通用，并且能够检测 AJAX 调用。

我已经尝试过 ajaxComplete JQuery 函数，但这不起作用，因为 ajax 调用没有分配给它们的开始或停止。

我有这个问题的原因是因为我有一个用 C# ASP.NET 编写的服务器控件及其页面插件，并且需要检测页面上的 AJAX 查询。但是我不能修改页面的内容，只能修改控件。

这可能吗？有任何想法吗？

编辑：

最后我们用另一种方式解决了这个问题。毕竟我们不需要检测 AJAX 调用。相反，当我们的控件加载时，我们会加载 JavaScript，并且我们将 JQuery 文档就绪函数与页面加载函数包装在一起，如下所示：

```
function pageLoad() {
    $(document).ready(function () {
        stuff();
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:50:16.540

不确定它是否适合您，但唯一的解决方案是，

```
jQuery(document.body).ajaxStart(function(){
    // start ajax call
}).ajaxStop(function(){
    // end ajax call
}); 
```

# tomcat - WebSockets 在 Tomcat 7 上不起作用

> ID：12217402
> 
> 赞同：2
> 
> 时间：2012-08-31T14:27:19.880
> 
> 标签：tomcat, websocket, tomcat7

我在 32 位 Windows XP 和 64 位 Debian 6.0.5 Linux 上安装了 Apache Tomcat 7.0.29，并尝试使用 websocket 示例。但它们运行不正确。我什至无法连接到服务器。

使用 echo 示例（选择消息 API）并按下 Connect 按钮没有任何反应。但 20 秒后，日志文本区域中出现“WebSocket 连接关闭”消息。但正如其他文章所述，这是一个已知问题。

在使用自制的 websocket 应用程序并尝试连接服务器时，我注意到打印了 MessageInbound#onOpen 方法的日志语句，因此调用了该方法。但是，浏览器 Javascript 部分中的 onopen 回调没有触发。但是在终止 tomcat 实例之后直接调用客户端 onopen，紧接着是 onclose。

有没有人可以确认这个或类似的行为？或者有没有人得到在 Tomcat 7 上工作的 websocket 示例？谢谢你的帮助。

**更新：**我为我自己创建的示例应用程序添加了代码。

这是服务器部分，WebSocketTestServlet.java：

```
import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.CharBuffer;

import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServletRequest;

import org.apache.catalina.websocket.MessageInbound;
import org.apache.catalina.websocket.StreamInbound;
import org.apache.catalina.websocket.WebSocketServlet;
import org.apache.catalina.websocket.WsOutbound;

@WebServlet(value = "/websocket", loadOnStartup = 1)
public class WebSocketTestServlet extends WebSocketServlet
{
    private static final long serialVersionUID = 1L;

    @Override
    protected StreamInbound createWebSocketInbound(String subProtocol, HttpServletRequest request)
    {
        return new WebSocketTestInbound();
    }

    public static final class WebSocketTestInbound extends MessageInbound
    {
        @Override
        protected void onOpen(WsOutbound outbound)
        {
            System.out.println("WebSocketTestServlet#onOpen");
        }

        @Override
        protected void onClose(int status)
        {
            System.out.println("WebSocketTestServlet#onClose");
        }

        @Override
        protected void onBinaryMessage(ByteBuffer message) throws IOException
        {
            System.out.println("WebSocketTestServlet#onBinaryMessage received: " + message);
        }

        @Override
        protected void onTextMessage(CharBuffer message) throws IOException
        {           
            System.out.println("WebSocketTestServlet#onTextMessage received: " + message);
        }
    }
} 
```

这里是唯一的 JSF facelet main.xhtml：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html">

    <h:head>
        <title>Test suite</title>
        <script type="text/javascript">

        var ws = null;

        function connect()
        {
            var wsUrl = $('#id_wsUrl');
            var wsMsg = $('#id_wsMsg');
            var wsSnd = $('#id_wsSnd');
            var wsCon = $('#id_wsCon');
            var url = wsUrl.val();

            // Connect
            if (ws == null)
            {
                if (window.WebSocket)
                    ws = new WebSocket(url);
                else if (window.MozWebSocket)
                    ws = new MozWebSocket(url);
                else
                {
                    alert('WebSocket not supported by this browser');
                    return;
                }

                ws.onopen = function()
                {
                    alert('Connection opened!');
                    wsMsg.removeAttr('disabled');
                    wsSnd.removeAttr('disabled');
                    wsUrl.attr('disabled', 'disabled');
                    wsCon.val('Disconnect');
                };

                ws.onclose = function()
                {
                    alert('Connection closed!');
                    wsMsg.attr('disabled', 'disabled');
                    wsSnd.attr('disabled', 'disabled');
                    wsUrl.removeAttr('disabled');
                    wsCon.val('Connect');
                };

                ws.onmessage = function(event)
                {
                    console.log('Inbound message: ' + event.data);
                    alert('Inbound message: ' + event.data);
                };

                ws.onerror = function()
                {
                    alert('Connection error!!!');
                };
            }
            // Disconnect
            else
            {
                ws.close();
                ws = null;
            }
        }

        function sendMessage()
        {
            if (ws)
            {
                var wsMsg = $('#id_wsMsg');
                var data = wsMsg.val();
                wsMsg.val('');

                if (data.length > 0)
                    ws.send(data);
            }
        }

        </script>
    </h:head>
    <h:outputScript target="head" library="js" name="jquery-1.8.0.js" />
    <h:body>
        <h1>WebSocket tests</h1>
        <h:panelGrid columns="2">
            <h:outputLabel for="id_wsUrl" value="WebSocket server URL:" />
            <h:panelGroup>
                <h:inputText id="id_wsUrl" style="width: 250px;" value="ws://localhost:8080/Testapp/websocket" />
                <h:commandButton type="button" id="id_wsCon" value="Connect" onclick="connect();" />
            </h:panelGroup>
            <h:outputLabel for="id_wsMsg" value="WebSocket outbound message" />
            <h:panelGroup>
                <h:inputText id="id_wsMsg" style="width: 250px;" value="" disabled="true" />
                <h:commandButton type="button" id="id_wsSnd" value="Send" disabled="true" onclick="sendMessage();" />
            </h:panelGroup>
        </h:panelGrid>
    </h:body>
</html> 
```

我不知道如何，但我希望它有助于获得代码。

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-12-19T09:46:42.477

`WebSocketServlet`现在不推荐使用扩展，即使在 Tomcat 7 中也是如此。由于 Tomcat **7.0.47**提供了标准，这意味着您可以通过使用类上的注释`javax.websocket-api`轻松创建 websocket 端点。[确保将依赖项设置为提供](https://stackoverflow.com/questions/20092563/websocket-example-wont-work/20423905#20423905)。`@ServerEndpoint`

尝试直接启动 Tomcat，因为在 Apache 或 IIS 之后作为代理运行也会导致问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-30T11:53:38.643

首先，确保你的tomcat版本支持websocket。我建议使用 7.0.42 或更高版本。

比第二个，你可以参考这个**[websocket 的示例代码](https://gist.github.com/chitan/3063774)**来开始使用。它的退出很简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-22T10:12:00.320

到 \apache-tomcat-server-folder\lib\ 并复制 tomcat7-websocket.jar、websocket-api.jar 并粘贴到项目的构建路径中并删除所有以前的 websocket jar。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T12:49:39.147

我没有使用 Apache Tomcat WebSocket 实现。但是，当我之前看到这种类型的错误时，它通常表明客户端正在尝试连接到没有启用 WebSocket 升级的常规 HTTP 服务器端点。这可能与您的 Tomcat 配置（web.xml）有关，而不是与服务器代码本身有关。

换句话说，您的客户端正在尝试连接，`ws://localhost:8080/Testapp/websocket`但您的服务器可能未配置为在该位置响应 WebSocket 升级。也许它实际上是`ws://localhost:8080/websocket`或`ws://localhost:8080/Testapp/websocket.do`。

# ruby-on-rails - has_many through rails 的所有记录

> ID：12217403
> 
> 赞同：2
> 
> 时间：2012-08-31T14:27:25.077
> 
> 标签：ruby-on-rails, ruby

我是 RoR 的初学者，最近自己使用指南进行了一些编码。我目前被困在一个点上，并且已经做了一些谷歌搜索以找到原因，但没有运气。有人可以帮我吗？

我的场景：

```
class Enum < ActiveRecord::Base
  establish_connection :common
  attr_accessible :name, :description, :updated_at
  has_many :enumlists
  has_many :enumvalues, :through => :enumlists
  validates :name, presence: true, length: { maximum:20}
  validates :description, length: {maximum: 100}
end

class Enumlist < ActiveRecord::Base
  establish_connection :common
  belongs_to :enums
  belongs_to :enumvalues
  attr_accessible :updated_at
end

class Enumvalue < ActiveRecord::Base
  establish_connection :common
  attr_accessible :category, :description, :updated_at
  has_many :enumlists
  has_many :enums, :through => :enumlists
end 
```

迁移条目是：

```
class CreateEnums < ActiveRecord::Migration
  def change
    create_table :enums do |t|
        t.string :name, :limit=>20
        t.string :description, :limit=>100
        t.timestamps
    end
    add_index :enums, [:name], :unique => true

    create_table :enumvalues do |t|
      t.string :category, :limit=>50
      t.string :description, :limit=>50
      t.timestamps
    end

    create_table :enumlists do |t|
        t.integer :enum_id
        t.integer :enumvalue_id
        t.timestamps
    end
    add_index :enumlists, [:enum_id, :enumvalue_id], :unique => true
  end
end 
```

现在，我想在控制器中查看所有枚举及其值。从我看到的示例中，我可以执行*Enum.find(params[:id]).enumlists*，但是我找不到使用链接表获取所有枚举的方法。我显然在这里遗漏了一些简单的东西，但我无法弄清楚它是什么..

谢谢..

**更新：**我可以使用 @enums = Enum.includes(:enumlists) 并且它确实返回正确的条目，但是我无法更深一层.. 即 @enums = Enum.includes(:enumlists, :enumvalues) 然后使用 @ enums.enumlists.enumvalues 获取所有枚举值的列表。

```
To help, the data is structured as below:
Enums:
-----------------------------------------------------------------------------------
id           name              description
-----------------------------------------------------------------------------------
1            App1 OS            Operating systems for Application 1
2            App2 OS            Operating systems for Application 2

Enumvalues:
-----------------------------------------------------------------------------------
id           category              description
-----------------------------------------------------------------------------------
1            Operating Systems     AIX
2            Operating Systems     Linux
3            Operating Systems     Windows

Enumlists:
-----------------------------------------------------------------------------------
id           enum_id              enumvalue_id
-----------------------------------------------------------------------------------
1            1                    1
2            1                    2
3            2                    1

What i need in the output is:
enums = [ [1, [Operating Sysetms, AIX, Operating Systems, Linux], 2,[Operating Sysetms, AIX] ] 
```

**更新：**

> 以下应该工作。
> 
> ```
> @enums = Enum.includes({:enumlists => :enumvalues}) 
> ```
> 
> 请注意，名称 enum_lists 和 enum_values 会更符合 Ruby 的习惯

@AlexBlakemore - 谢谢。您的输入让我相信模型中存在问题，一旦我发现它，您的方法和我之前使用的方法似乎都运行良好..

我想我找到了失败的原因。这是由于类 Enumlist 的定义不正确。应该是

```
class Enumlist < ActiveRecord::Base
  establish_connection :common
  belongs_to :enum   <-- Renamed to enum instead of enums
  belongs_to :enumvalue <-- Renamed to enumvalue instead of enumvalues
  attr_accessible :updated_at
end 
```

进行上述更改后，我尝试使用以下方式链接表格，并且它们都可以正常工作.. Method1：

```
@enums = Enum.includes(:enumlists, :enumvalues)
  [1m[36mEnum Load (0.4ms)[0m  [1mSELECT `enums`.* FROM `enums` [0m
  [1m[35mEnumlist Load (0.3ms)[0m  SELECT `enumlists`.* FROM `enumlists` WHERE `enumlists`.`enum_id` IN (1, 2)
  [1m[36mEnumvalue Load (0.3ms)[0m  [1mSELECT `enumvalues`.* FROM `enumvalues` WHERE `enumvalues`.`id` IN (1, 2)[0m
@enums = Enum.includes(:enumlists, :enumvalues)
[#<Enum id: 1, name: "WMB OS", description: "Operating System (WMB)", created_at: "2000-01-01 09:00:00", updated_at: "2000-01-01 09:00:00">, #<Enum id: 2, name: "4690 OS", description: "Operating System (DEC)", created_at: "2008-01-01 09:00:00", updated_at: "2008-01-01 09:00:00">] 
```

方法2：使用@AlexBlakemore 的建议，我也得到了类似的输出。

```
@enums = Enum.includes({:enumvalues=>:enumlists})
  [1m[36mEnum Load (0.2ms)[0m  [1mSELECT `enums`.* FROM `enums` [0m
  [1m[35mEnumlist Load (0.3ms)[0m  SELECT `enumlists`.* FROM `enumlists` WHERE `enumlists`.`enum_id` IN (1, 2)
[#<Enum id: 1, name: "WMB OS", description: "Operating System (WMB)", created_at: "2000-01-01 09:00:00", updated_at: "2000-01-01 09:00:00">, #<Enum id: 2, name: "4690 OS", description: "Operating System (DEC)", created_at: "2008-01-01 09:00:00", updated_at: "2008-01-01 09:00:00">]
  [1m[36mEnumvalue Load (0.6ms)[0m  [1mSELECT `enumvalues`.* FROM `enumvalues` WHERE `enumvalues`.`id` IN (1, 2)[0m
  [1m[35mEnumlist Load (0.4ms)[0m  SELECT `enumlists`.* FROM `enumlists` WHERE `enumlists`.`enumvalue_id` IN (1, 2) 
```

没有错误，所以很明显，这两种方法都在填充列表。但是当我尝试访问枚举列表/枚举值时，我得到了 NoMethodError。我尝试了各种组合，没有一个有效..

```
@enums.enumlists
@enums.enumlist
@enums.enumvalues
@enums.enumvalue 
```

不知道这里缺少什么..有什么建议吗？一旦我让它工作，我可以确认上述两种方法中的哪一种返回正确的结果。手指交叉！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:21:14.193

下面应该告诉 ActiveRecord 在获取枚举时急切地获取枚举列表和枚举值。

```
@enums = Enum.includes({:enumlists => :enumvalues}) 
```

请注意，名称 enum_lists 和 enum_values 会更符合 Ruby 的习惯

或者你可以试试

```
@enums = Enum.includes(:enumvalues) 
```

如果您真的只是想拥有一个 has_and_belongs_to_many 关联。(HABTM)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T08:05:10.230

好的..这是解决问题的方法。

第一个错误是连接表以单数形式链接表名，因此连接被破坏。即表格模型应如下所示。它包含对我在查询中发布的原始模型的 3 处更改。一个。将连接表字段重命名为使用单数形式。湾。正如@Alex 所建议的那样，原始表名已重命名为更具标志性的 ruby​​ ctinteger 将其更改为 t.reference 以使其明确。

```
class Enum < ActiveRecord::Base
  establish_connection :common
  attr_accessible :name, :description, :updated_at
  has_many :enum_lists
  has_many :enum_values, :through => :enum_lists
  validates :name, presence: true, length: { maximum:20}
  validates :description, length: {maximum: 100}
end

class Enum_list < ActiveRecord::Base
  establish_connection :common
  belongs_to :enum   <-- Renamed to enum instead of enums
  belongs_to :enum_value <-- Renamed to enum_value instead of enum_values
  attr_accessible :updated_at
end

class Enum_value < ActiveRecord::Base
  establish_connection :common
  attr_accessible :category, :description, :updated_at
  has_many :enum_lists
  has_many :enums, :through => :enum_lists
end 
```

第二个问题是我试图在控制器中使用 find(:all) 来获得结果。相反，它可以使用以下方法之一轻松完成

```
@enums = Enum.includes(:enum_lists, :enum_values) or 
@enums = Enum.includes(:enum_values) or 
@enums = Enum.includes({:enum_lists => :enum_values}), 
```

记住每次使用产生的查询数量。

最后一个问题是我无法使用@enums.enum_lists 在 ruby​​ 控制台上打印值。这宁愿需要在循环中写入以打印值。因此，我在视图中编写了以下代码以将枚举名称及其对应值打印为：

```
<% @enums.each do |enum| %>
<h4><%= enum.name %></h4>
<table width="100%">
  <tr class="<%= cycle('odd','even', :name=>"line") %>"><td>Description</td><td><%= enum.description %></td></tr>
  <table>
    <% enum.enum_values.each do |enum_value| %>
      <tr class="<%= cycle('odd','even', :name=>"line") %>"><td><%=  enum_value.category %></td><td><%=  enum_value.description %></td></tr>
    <% end %>
      <tr class="<%= cycle('odd','even', :name=>"line") %>"><td colspan="2"><span class="greyed">Last updated <%= time_ago_in_words(enum.updated_at) %> ago</span></td></tr>
  </table>
</table> 
```

非常感谢@Alex 的投入.. !! 我可以继续我的 RoR 工作！

# xml - CRM 2011 高级查找 - 获取 XML - 导入以进行修改的查找

> ID：12217404
> 
> 赞同：6
> 
> 时间：2012-08-31T14:27:27.537
> 
> 标签：xml, dynamics-crm-2011

是否有某种方法可以从 CRM“高级查找”编辑 XML 文件，然后将其带回更改？

当我在一个字段类型（例如 zipcode = 45211）上有很多值要插入时，我已经厌倦了使用 Advanced find 并且想要一种方法来加快进程而不将其交给编写它的人SQL。

所以我的想法是使用“Advance Find”创建查询的开头，然后使用 Download Fetch XML 导出该查询，然后修改 XML 文件，（不确定如何或是否可以完成下一部分>>）然后导入该 XML文件返回到 CRM 以用于我的新查询或替换相关的 XML 文件，无论它可能位于何处。

对 XML 的示例更改：

```
 <filter type="or">
        <condition attribute="address1_postalcode" operator="like" value="45211%" />
        <condition attribute="address1_postalcode" operator="like" value="45213%" />
        <condition attribute="address1_postalcode" operator="like" value="45219%" />
        etc…
    </filter> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T18:35:52.877

您必须创建一个实用程序来更新视图并允许您手动编辑 XML。我认为创建所述实用程序不会太难，但是没有办法通过 UI 本身来完成。请参阅此链接：[http ://social.microsoft.com/Forums/en/crm/thread/fd4bdbad-dd81-4507-a8e3-23cc35ff53f3](http://social.microsoft.com/Forums/en/crm/thread/fd4bdbad-dd81-4507-a8e3-23cc35ff53f3)

（您可能会弄乱导入视图，但我对此表示怀疑）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T07:07:52.940

您需要为这个问题编写一个（控制台？）应用程序。使用[`SavedQuery`实体](http://technet.microsoft.com/en-us/library/gg334263.aspx)检索高级查找查询并设置 FetchXML 字段，将 id 设置为新的 GUID，将 Name 设置为适当的标签并创建新的高级查找记录。

# devexpress - DevExpress GridView 计算列与 ObjectDataSource

> ID：12217405
> 
> 赞同：0
> 
> 时间：2012-08-31T14:27:33.167
> 
> 标签：devexpress, objectdatasource, aspxgridview

我有一个绑定到 ObjectDataSource 的 GridView，它返回 MyDto 的一些实例。一切正常，除了在列中我想显示在 MyDto 中计算的值（通过只读属性），这会在编辑过程中引起一些问题。编辑模式是内联的。

我在 EditFormSettings 中设置了该列只读属性 = True 和 Visible = False，但是当我插入新行并按更新 ObjectDataSource 时抛出异常“ObjectDataSource 'MyDataSource'中的 DataObjectTypeName 属性指定的类型的'CalculatedValue'属性是只读的，不能设置它的值。”

我不明白为什么 GridView 试图更新只读值。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:33:16.283

出现问题是因为 GridView 会自动尝试更新每个绑定的列，无论是否只读（只读是从用户角度来看的尊重）。

我已经为插入空模板的计算列编辑了 EditItemTemplate。通过这种方式，我在编辑模式下什么也看不到，并且 GridView 不会尝试更新只读属性，并且我在显示模式下看到（自动创建的）绑定模板（具有计算值）。

# jquery - 从 HTML 字符串中获取父级

> ID：12217409
> 
> 赞同：1
> 
> 时间：2012-08-31T14:27:46.360
> 
> 标签：jquery, html-table

我有一个动态创建的表行，所以我无法控制添加任何 id 或类。该行可以以任何顺序出现在表格中。每行仅包含列 (td)。

**2012 年 8 月 31 日更新 18:55**

这是 html 的外观示例

```
<table id="ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList">
   <tr>
      <td>
         <p>
         <span style="font-size:1.1em"><span id="ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList_ctl00_lblCourseInfoTypeText" style="font-weight:bold;">Subject Area</span></span>
         <br />
         <span id="ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList_ctl00_lblCourseInfoText">BS, AP</span>
         </p>
      </td>
   </tr>
   <tr>
      <td>
         <p>
         <span style="font-size:1.1em"><span id="ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList_ctl01_lblCourseInfoTypeText" style="font-weight:bold;">Course Content</span></span>
         <br />
         <span id="ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList_ctl01_lblCourseInfoText">some more text</span>
         </p>
      </td>
   </tr>
</table> 
```

有没有办法可以隐藏“主题区域”出现的行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:31:14.453

使用`.closest('tr')`，它将抓取`<tr>`DOM 树的下一个标签：

```
$('#ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList_ctl00_lblCourseInfoTypeText').closest('tr').hide(); 
```

代替`.hide()`, 您可以使用`.slideUp()`,`.fadeOut()`或`.remove()`等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:33:49.100

Dunhamzzz 是对的，最接近的作品很棒（+1）。

附带说明一下，ASP.NET 网络表单生成的动态 ID 名称绝对是荒谬的，而且在`<%= Whatever.ClientID %>`你的 JS 内部（混合后端和前端）的想法对我来说是荒谬的。

只需使用*from end*选择器，以保持 JS 干净。

```
$('[id$="lblCourseInfoTypeText"]').closest('tr').hide();
// ^= means search from the end - and voila 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T18:15:38.790

我可能是错的，但我想我可以回答我自己的问题：S

```
$("#ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList tr:contains('Subject Area')").hide(); 
```

这更有选择性，不太可能捕捉到我们真正想要的任何其他“主题区域”实例。

```
$("#ctl00_MainContentPlaceholder_ctl00_CourseInfoTextList span:contains('Subject Area')").closest('tr').hide(); 
```

发现 contains 函数是这里的关键，所以谢谢大家 :)

# javascript - jQuery Click 事件仅适用于横向 (iPhone)

> ID：12217421
> 
> 赞同：0
> 
> 时间：2012-08-31T14:28:18.090
> 
> 标签：javascript, jquery, wordpress, drop-down-menu, responsive-design

我被要求在工作中修补一个写得很糟糕的响应式网站，并且被 jQuery click 事件的问题难住了。

该事件在 iPhone 上的横向模式下运行良好，但在纵向模式下它什么也不做。

这是jQuery：

```
if (width <= 480) {
    function menu(e) {
        e.PreventDefault();
        $('#menu-item-93 .sub-menu').slideToggle('fast');
    }

    $('.nav-cont').addEventListener('click', menu(e));
    $('.nav-cont').addEventListener('touchstart', menu(e));
} 
```

以及与 header.php 文件相关的部分（我是否提到过，这是一个 Wordpress 站点）

```
<nav id="main" class="main clearboth">
    <?php 
        wp_nav_menu( array( 
            'sort_column' => 'menu_order', 
            'theme_location' => 'primary', 
            'after'=>'<img src="'.template_url('images/button/link-445x68.png').'" class="show-480" />'
        ) );
    ?>
</nav>
<div class="nav-cont">
    <div class="nav-text show-480">NAVIGATION</div>
    <img class="nav-button show-480" src="<?php echo template_url('images/button/navigation-closed-nt-445x52.png');?>" />
</div> 
```

任何人都知道为什么这个触摸事件只在横向模式下触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T14:05:52.553

最终通过查看在该网站上工作的旧开发机构留下的多个 javascript 文件解决了这个问题。我发现这个选择器上有多个相互矛盾的点击处理程序实例。我删除了其他人并bam，它起作用了。

它甚至以我最初打算让它使用基本的方式工作

```
$('.nav-cont').click(function() {
}); 
```

事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:39:03.077

这些行：

```
$('.nav-cont').addEventListener('click', menu(e));
$('.nav-cont').addEventListener('touchstart', menu(e)); 
```

应该：

```
$('.nav-cont').addEventListener('click', menu);
$('.nav-cont').addEventListener('touchstart', menu); 
```

甚至：

```
$('.nav-cont').on('click', menu);
$('.nav-cont').on('touchstart', menu); 
```

当前代码将调用`menu`函数的结果添加到事件处理程序中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:33:49.007

您的代码以`if (width <= 480) {`. 这看起来可以是有效的纵向但不是横向，这就是问题所在。

# jquery - UL问题的宽度，css宽度不起作用

> ID：12217423
> 
> 赞同：0
> 
> 时间：2012-08-31T14:28:22.223
> 
> 标签：jquery, css, html, width

我的例子是： http: [//www.interfaithmedical.com/sfish/example.html](http://www.interfaithmedical.com/sfish/example.html)

它包含一个 html 标签：

```
<ul class="sf-menu"> 
```

我想将 UL 的宽度精确地拉伸到 960 像素。每个 LI 都被均匀拉伸，并且能够将其放入 DIV 中而无需任何填充。我尝试向主 UL 添加宽度：

```
.sf-menu ul {
    position: absolute;
    top: -999em;
    width: 960px;
} 
```

但是它的宽度没有设置为 960px。width: 属性似乎无效。

这是 HTML 文件：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">  
  <head>
    <title>A very basic Superfish menu example</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <link rel="stylesheet" type="text/css" href="css/superfish.css" media="screen">
    <script src="http://code.jquery.com/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/hoverIntent.js"></script>
    <script type="text/javascript" src="js/superfish.js"></script>
    <script type="text/javascript">
      // initialise plugins
      jQuery(function () {
        jQuery('ul.sf-menu').superfish();
      });
    </script>
  </head>

  <body>
    <div style="width: 960px; height: 2.2em; border: 1px solid blue;">
      <ul class="sf-menu">
        <li class="current"> <a href="#a">Medical Services</a>
          <ul>
            <li><a href="#aa">Behavioral Health</a></li>
            <li><a href="#aa">Clinical Labrotary</a></li>
            <li><a href="#aa">Dentistry</a></li>
            <li><a href="#aa">Emergency</a></li>
            <li><a href="#aa">Gynecology</a></li>
            <li><a href="#aa">Medicine</a></li>
            <li><a href="#aa">Pastoral</a></li>
            <li><a href="#aa">Pediatrics</a></li>
            <li><a href="#aa">Physical Medicine & Rehab</a></li>
            <li><a href="#aa">Radiology</a></li>
            <li><a href="#aa">Surgery</a></li>
            <li><a href="#aa">Women's Health</a></li>
            <li><a href="#aa">Other Services</a></li>
          </ul>
        </li>

        <li class="current"> <a href="#a">About Us</a>
          <ul>
            <li><a href="#aa">Behavioral Health</a></li>
            <li><a href="#aa">Clinical Labrotary</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
          </ul>
        </li>

        <li class="current"> <a href="#a">Medical Educations</a>
          <ul>
            <li><a href="#aa">Behavioral Health</a></li>
            <li><a href="#aa">Clinical Labrotary</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
          </ul>
        </li>

        <li class="current"> <a href="#a">Patients & Visitors</a>
          <ul>
            <li><a href="#aa">Behavioral Health</a></li>
            <li><a href="#aa">Clinical Labrotary</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
            <li><a href="#aa">menu item that is quite long</a></li>
          </ul>
        </li>

        <li><a href="findDoctors.php" class="navlink">Find a Doctor</a></li>
        <li><a href="contactUs.php" class="navlink">Contact Us</a></li>
      </ul>
    </div>
  </body>
</html> 
```

这是 CSS 文件 superfish.css：

```
/*** ESSENTIAL STYLES ***/
* {
    padding: 0;
    margin: 0;
}

.sf-menu, .sf-menu * {
    margin: 0;
    padding: 0;
    list-style: none;
}

.sf-menu {
    line-height: 1.0;
}

.sf-menu ul {
    position: absolute;
    top: -999em;
    width: 10em;
 /* left offset of submenus need to match (see below) 10em */
}

#trt {
    width: 20em;
}

.sf-menu ul li {
    width: 100%;
}

.sf-menu li:hover {
    visibility: inherit;
 /* fixes IE7 'sticky bug' */
}

.sf-menu li {
    float: left;
    position: relative;
}

.sf-menu a {
    display: block;
    position: relative;
}

.sf-menu li:hover ul,
    .sf-menu li.sfHover ul {
    left: 0;
    top: 2.2em;
 /* match top ul list item height */
    z-index: 99;
}

ul.sf-menu li:hover li ul,
    ul.sf-menu li.sfHover li ul {
    top: -999em;
}

ul.sf-menu li li:hover ul,
    ul.sf-menu li li.sfHover ul {
    left: 10em;
 /* match ul width */
    top: 0;
}

ul.sf-menu li li:hover li ul,
    ul.sf-menu li li.sfHover li ul {
    top: -999em;
}

ul.sf-menu li li li:hover ul,
    ul.sf-menu li li li.sfHover ul {
    left: 10em;
 /* match ul width */
    top: 0;
}

    /*** DEMO SKIN ***/
.sf-menu {
    float: left;
    margin-bottom: 1em;
}

.sf-menu a {
    border-left: 1px solid #fff;
    border-top: 1px solid #CFDEFF;
    padding: .75em 1em;
    text-decoration: none;
}

.sf-menu a, .sf-menu a:visited {
 /* visited pseudo selector so IE6 applies text colour*/
    color: #FFFFFF;
    font-family: Verdana;
    font-size: 13px;
}

.sf-menu li {
    background: #1B83EF;
}

.sf-menu li li {
    background: #1B83EF;
}

.sf-menu li:hover, .sf-menu li.sfHover,
    .sf-menu a:focus, .sf-menu a:hover, .sf-menu a:active {
    background: #12ACFC;
    outline: 0;
}

    /*** arrows **/
.sf-menu a.sf-with-ul {
    padding-right: 2.25em;
    min-width: 1px;
 /* trigger IE7 hasLayout so spans position accurately */
}

.sf-sub-indicator {
    position: absolute;
    display: block;
    right: .75em;
    top: 1.05em;
 /* IE6 only */
    width: 10px;
    height: 10px;
    text-indent: -999em;
    overflow: hidden;
    background: url('../images/arrows-ffffff.png') no-repeat -10px -100px;
 /* 8-bit indexed alpha png. IE6 gets solid image only */
}

a > .sf-sub-indicator {
  /* give all except IE6 the correct values */
    top: .8em;
    background-position: 0 -100px;
 /* use translucent arrow for modern browsers*/
}
    /* apply hovers to modern browsers */
a:focus > .sf-sub-indicator,
    a:hover > .sf-sub-indicator,
    a:active > .sf-sub-indicator,
    li:hover > a > .sf-sub-indicator,
    li.sfHover > a > .sf-sub-indicator {
    background-position: -10px -100px;
 /* arrow hovers for modern browsers*/
}

    /* point right for anchors in subs */
.sf-menu ul .sf-sub-indicator {
    background-position: -10px 0;
}

.sf-menu ul a > .sf-sub-indicator {
    background-position: 0 0;
}
    /* apply hovers to modern browsers */
.sf-menu ul a:focus > .sf-sub-indicator,
    .sf-menu ul a:hover > .sf-sub-indicator,
    .sf-menu ul a:active > .sf-sub-indicator,
    .sf-menu ul li:hover > a > .sf-sub-indicator,
    .sf-menu ul li.sfHover > a > .sf-sub-indicator {
    background-position: -10px 0;
 /* arrow hovers for modern browsers*/
}

    /*** shadows for all but IE6 ***/
.sf-shadow ul {
    background: url('../images/shadow.png') no-repeat bottom right;
    padding: 0 8px 9px 0;
    -moz-border-radius-bottomleft: 17px;
    -moz-border-radius-topright: 17px;
    -webkit-border-top-right-radius: 17px;
    -webkit-border-bottom-left-radius: 17px;
}

.sf-shadow ul.sf-shadow-off {
    background: transparent;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:38:27.040

继续将问题分解成更简单和更简单的部分，直到它开始正常工作。删除不必要的代码以创建最简单的`<ul><li></li></ul>`列表，然后删除 CSS 文件中不必要的 CSS。找出阻碍宽度属性生效的原因是一个排除过程。可能是 superfish 中的某些东西覆盖了您的宽度属性。

您的 CSS 中有许多语法错误。要找出 superfish 与您的 CSS 代码不兼容的确切性质，您必须简化它并删除语法错误。CSS 非常宽容，它可以让你把废话放在那里，它会尝试解释它。在这种情况下，你有不与其他人对齐的花括号。必须回到基础并删除语法错误。

# coldfusion - ColdFusion 10 不适用于 Amazon Elastic Beanstalk

> ID：12217424
> 
> 赞同：0
> 
> 时间：2012-08-31T14:28:23.713
> 
> 标签：coldfusion, amazon-elastic-beanstalk, coldfusion-10

我正在尝试将 ColdFusion 10 部署到 AWS ElasticBeanstalk 服务，但库存配置失败。我正在尝试创建一个 x64 Tomcat 6 环境。

您是否知道需要进行哪些更改才能允许通过 Amazone Elastic Beanstalk 部署 ColdFusion 10，同时允许 SES 链接等库存配置？谢谢！

**例外**

```
 SEVERE: Parse error in application web.xml file at jndi:/localhost/WEB-INF/web.xml
org.xml.sax.SAXParseException; systemId: jndi:/localhost/WEB-INF/web.xml; lineNumber: 500; columnNumber: 23; Error at (500, 23: Invalid <url-pattern> *.cfml/* in servlet mapping
    at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2806)
    at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2832)
    at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1141)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:604)
    at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.endNamespaceScope(XMLDTDValidator.java:2102)
    at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.handleEndElement(XMLDTDValidator.java:2053)
    at com.sun.org.apache.xerces.internal.impl.dtd.XMLDTDValidator.endElement(XMLDTDValidator.java:927)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanEndElement(XMLDocumentFragmentScannerImpl.java:1759)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2915)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:625)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:488)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:819)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:748)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1208)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:525)
    at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1642)
    at org.apache.catalina.startup.ContextConfig.applicationWebConfig(ContextConfig.java:365)
    at org.apache.catalina.startup.ContextConfig.start(ContextConfig.java:1076)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:261)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4612)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779) 
```

...

**web.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">
<web-app id="adobe_coldfusion">
    <display-name>WARTest</display-name>
    <description>Adobe ColdFusion 10</description>
    <context-param id="coldfusion_context_1">
        <param-name>cftags</param-name>
        <param-value>/WEB-INF/cftags</param-value>
        <description>Path to search for built-in tags. Relative to application root.
            This parameter can only be one path element.</description>
    </context-param>
    <context-param id="coldfusion_context_2">
        <param-name>coldfusion.compiler.outputDir</param-name>
        <param-value>/WEB-INF/cfclasses</param-value>
        <description>This is the directory where we will place compiled
            pages. It must be relative to the webapp root.</description>
    </context-param>
    <context-param id="coldfusion_context_4">
        <param-name>cfx.registry.nativelibrary</param-name>
        <param-value>cfregistry</param-value>
        <description>Native library that implements CFX_REGISTRY.
            Used on Windows only.</description>
    </context-param>
    <context-param id="coldfusion_context_5">
        <param-name>cfx.report.nativelibrary</param-name>
        <param-value>cfreport</param-value>
        <description>Native library that implements CFX_REPORT.
            Used on Windows only.</description>
    </context-param>
    <context-param id="coldfusion_context_88">
        <param-name>cf.class.path</param-name>
        <param-value>
            ./WEB-INF/../../../classes,./WEB-INF/../../lib/updates,./WEB-INF/../../lib,./WEB-INF/flex/jars,./WEB-INF/cfform/jars,./WEB-INF/../../lib/axis2</param-value>
    </context-param>
    <context-param id="coldfusion_context_89">
        <param-name>cf.lib.path</param-name>
        <param-value>./WEB-INF/../../lib</param-value>
    </context-param>

    <!-- CF Monitoring Filter  -->
    <filter>
        <filter-name>CFMonitoringFilter</filter-name>
        <filter-class>coldfusion.bootstrap.BootstrapFilter</filter-class>
        <init-param>
            <param-name>filter.class</param-name>
            <param-value>coldfusion.monitor.event.MonitoringServletFilter</param-value>
        </init-param>
    </filter>

    <!-- Cache Filter for cfform swfs -->
    <filter>
        <filter-name>CFCacheFilter</filter-name>
        <filter-class>coldfusion.bootstrap.BootstrapFilter</filter-class>
        <init-param>
            <param-name>filter.class</param-name>
            <param-value>flex.server.j2ee.cache.CacheFilter</param-value>
        </init-param>
    </filter>

    <!-- Request Control Filter for Flash Remoting servlets-->
    <filter>
        <filter-name>FlashRemotingControlFilter</filter-name>
        <filter-class>coldfusion.bootstrap.BootstrapFilter</filter-class>
        <init-param>
            <param-name>filter.class</param-name>
            <param-value>coldfusion.filter.FlashRequestControlFilter</param-value>
        </init-param>
    </filter>

    <!-- WSRP portlet Filter for wsrp producer -->
    <filter>
        <filter-name>WSRPFilter</filter-name>
        <filter-class>coldfusion.bootstrap.BootstrapFilter</filter-class>
        <init-param>
            <param-name>filter.class</param-name>
            <param-value>coldfusion.portlet.wsrp.ProviderImpl</param-value>
        </init-param>
    </filter>

    <!-- CF ClickJacking deny protection Filter  -->
    <filter>
        <filter-name>CFClickJackFilterDeny</filter-name>
        <filter-class>coldfusion.bootstrap.BootstrapFilter</filter-class>
        <init-param>
            <param-name>filter.class</param-name>
            <param-value>coldfusion.filter.ClickjackingProtectionFilter</param-value>
        </init-param>
        <init-param>
            <param-name>mode</param-name>
            <param-value>DENY</param-value>
        </init-param>
    </filter>

    <!-- CF ClickJacking same origiin protection Filter  -->
    <filter>
        <filter-name>CFClickJackFilterSameOrigin</filter-name>
        <filter-class>coldfusion.bootstrap.BootstrapFilter</filter-class>
        <init-param>
            <param-name>filter.class</param-name>
            <param-value>coldfusion.filter.ClickjackingProtectionFilter</param-value>
        </init-param>
        <init-param>
            <param-name>mode</param-name>
            <param-value>SAMEORIGIN</param-value>
        </init-param>
    </filter>

    <!-- CF ClickJacking Filter mapppings starts. For ColdFusion Administrator we are allowing sameorigiin frames. Use Deny or some other mode of this filter as appropriate for the application and add required url pattern
    -->
    <filter-mapping>
        <filter-name>CFClickJackFilterSameOrigin</filter-name>
        <url-pattern>/CFIDE/administrator/*</url-pattern>
    </filter-mapping>
    <!-- End CF ClickJacking Filter mappings -->

    <!-- CF Monitoring Filter mappings
     When new servlets registered in web.xml, it must be ensured that
     filter mappings are added for this filter as required.
     Note that the MessageBrokerServlet for the Flex 2 Gateway is not
     included here. This is because Flex appears to batch invocations
     for methods invoked close to one another, resulting in the filter
     being missed for all batched invocations other than the first.
    -->
    <filter-mapping>
        <filter-name>CFMonitoringFilter</filter-name>
        <servlet-name>FlashGateway</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>CFMonitoringFilter</filter-name>
        <servlet-name>CFFormGateway</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>CFMonitoringFilter</filter-name>
        <servlet-name>CfmServlet</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>CFMonitoringFilter</filter-name>
        <servlet-name>CFCServlet</servlet-name>
    </filter-mapping>
    <filter-mapping>
        <filter-name>CFMonitoringFilter</filter-name>
        <servlet-name>CFRestServlet</servlet-name>
    </filter-mapping>
    <!-- End CF Monitoring Filter mappings -->

    <!-- Request Control Filter for Flash Remoting servlets -->
    <filter-mapping>
        <filter-name>FlashRemotingControlFilter</filter-name>
        <servlet-name>MessageBrokerServlet</servlet-name>
    </filter-mapping>

    <filter-mapping>
        <filter-name>FlashRemotingControlFilter</filter-name>
        <servlet-name>FlashGateway</servlet-name>
    </filter-mapping>
    <!-- end request control filters -->

    <!-- Cache Filter for cfform swfs -->
    <filter-mapping>
        <filter-name>CFCacheFilter</filter-name>
        <servlet-name>CFSwfServlet</servlet-name>
    </filter-mapping>

   <!-- WSRP portlet Filter for wsrp producer -->
   <filter-mapping>
    <filter-name>WSRPFilter</filter-name>
    <servlet-name>WSRPProducer</servlet-name>
   </filter-mapping>    

    <listener>
        <listener-class>coldfusion.bootstrap.HttpFlexSessionBootstrap</listener-class>
    </listener>

    <!-- Message Broker Servlet, wrapped in a ColdFusion specific class -->
    <servlet>
        <servlet-name>MessageBrokerServlet</servlet-name>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param>
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.flex.ColdFusionMessageBrokerServlet</param-value>
        </init-param>
        <init-param>
            <param-name>services.configuration.file</param-name>
            <param-value>/WEB-INF/flex/services-config.xml</param-value>
        </init-param>
        <load-on-startup>11</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>CFSwfServlet</servlet-name>
        <display-name>SWF Retreiver</display-name>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param>
            <param-name>servlet.class</param-name>
            <param-value>flex.server.j2ee.SwfServlet</param-value>
        </init-param>
        <load-on-startup>5</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>CFMxmlServlet</servlet-name>
        <display-name>MXML Processor</display-name>
        <description>Servlet wrapper for the Mxml Compiler</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param>
            <param-name>servlet.class</param-name>
            <param-value>flex.compiler.MxmlServlet</param-value>
        </init-param>
        <load-on-startup>2</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>CFForbiddenServlet</servlet-name>
        <display-name>Prevents access to *.as files</display-name>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param>
            <param-name>servlet.class</param-name>
            <param-value>flex.server.j2ee.ForbiddenServlet</param-value>
        </init-param>
    </servlet>
    <!-- end flash forms settings -->

    <servlet id="coldfusion_servlet_1">
        <servlet-name>ColdFusionStartUpServlet</servlet-name>
        <display-name>Coldfusion MX Startup Servlet</display-name>
        <description>Initializes ColdFusion</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_1034013110641">
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.server.j2ee.CFStartUpServlet</param-value>
        </init-param>
        <init-param id="InitParam_1034013110642">
            <param-name>cfRootDir</param-name>
            <param-value>./WEB-INF/cfusion</param-value>
        </init-param>
        <init-param id="InitParam_1034013110643">
            <param-name>appServer</param-name>
            <param-value>J2EE</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet id="coldfusion_servlet_11">
        <servlet-name>FlashGateway</servlet-name>
        <display-name>Flash Gateway</display-name>
        <description>Allows flash to connect to CFML and CFC templates.</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_103401311064890">
            <param-name>servlet.class</param-name>
            <param-value>flashgateway.controller.GatewayServlet</param-value>
        </init-param>
        <init-param id="InitParam_1034013110642x">
            <param-name>cfRootDir</param-name>
            <param-value>./WEB-INF/cfusion</param-value>
        </init-param>
        <init-param>
            <param-name>gateway.configuration.file</param-name>
            <param-value>/WEB-INF/gateway-config.xml</param-value>
        </init-param>
        <init-param>
            <param-name>whitelist.configuration.file</param-name>
            <param-value>/WEB-INF/gateway-config.xml</param-value>
        </init-param>
        <init-param>
            <param-name>whitelist.parent.node</param-name>
            <param-value>gateway-config</param-value>
        </init-param>
        <init-param id="InitParam_1034013110643a">
            <param-name>appServer</param-name>
            <param-value>J2EE</param-value>
        </init-param>
        <load-on-startup>11</load-on-startup>
    </servlet>
    <servlet id="coldfusion_servlet_12">
        <servlet-name>CFFormGateway</servlet-name>
        <display-name>CFFormGateway</display-name>
        <description>Allows flash forms to connect to CFML and CFC templates.</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_103401311064891">
            <param-name>servlet.class</param-name>
            <param-value>flashgateway.controller.GatewayServlet</param-value>
        </init-param>
        <init-param id="InitParam_1034013110642y">
            <param-name>cfRootDir</param-name>
            <param-value>./WEB-INF/cfusion</param-value>
        </init-param>
        <init-param>
            <param-name>gateway.configuration.file</param-name>
            <param-value>/WEB-INF/cfform-gateway-config.xml</param-value>
        </init-param>
        <init-param>
            <param-name>whitelist.configuration.file</param-name>
            <param-value>/WEB-INF/cfform-gateway-config.xml</param-value>
        </init-param>
        <init-param>
            <param-name>whitelist.parent.node</param-name>
            <param-value>gateway-config</param-value>
        </init-param>
        <init-param id="InitParam_1034013110643b">
            <param-name>appServer</param-name>
            <param-value>J2EE</param-value>
        </init-param>
        <load-on-startup>12</load-on-startup>
    </servlet>

    <servlet id="coldfusion_servlet_3">
        <servlet-name>CfmServlet</servlet-name>
        <display-name>CFML Template Processor</display-name>
        <description>Compiles and executes CFML pages and tags</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_1034013110656ert">
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.CfmServlet</param-value>
        </init-param>
        <load-on-startup>4</load-on-startup>
    </servlet>
    <servlet id="coldfusion_servlet_4">
        <servlet-name>GraphServlet</servlet-name>
        <display-name>GraphServlet</display-name>
        <description>Serves up graph data</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_1034013110657xx">
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.graph.GraphServlet</param-value>
        </init-param>
    </servlet>
    <servlet id="coldfusion_servlet_5">
        <servlet-name>CFCServlet</servlet-name>
        <display-name>CFC Processor</display-name>
        <description>Compiles and executes CF web components</description>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_1034013110657ax">
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.xml.rpc.CFCServlet</param-value>
       </init-param>
        <load-on-startup>10</load-on-startup>
    </servlet>

        <!-- Used in calling OnServerStart, so this should be the last one to get initialized -->
        <servlet id="coldfusion_servlet_1001">
            <servlet-name>ServerCFCServlet</servlet-name>
            <display-name>OnServerStart Servlet</display-name>
            <description>Invokes OnServerStart</description>
            <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
            <init-param id="InitParam_1034013110613">
                <param-name>servlet.class</param-name>
                <param-value>coldfusion.cfc.ServerCFCServlet</param-value>
            </init-param>
            <init-param id="InitParam_1034013110614">
                <param-name>cfRootDir</param-name>
                <param-value>./WEB-INF/cfusion</param-value>
            </init-param>
            <load-on-startup>1001</load-on-startup>
        </servlet>

        <!-- begin REST -->
        <servlet id="coldfusion_servlet_6">
            <servlet-name>CFRestServlet</servlet-name>
            <display-name>Rest Processor</display-name>
            <description>Starts and configures rest web components</description>
            <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
            <init-param id="InitParam_1034013110657rs">
                <param-name>servlet.class</param-name>
                <param-value>coldfusion.rest.servlet.CFRestServlet</param-value>
            </init-param>
            <init-param>
                <param-name>com.sun.jersey.spi.container.ContainerRequestFilters</param-name>
                <param-value>coldfusion.rest.servlet.CFUriConnegFilter;coldfusion.rest.servlet.CFRequestFilter</param-value>
            </init-param>
            <init-param>
                <param-name>com.sun.jersey.spi.container.ContainerResponseFilters</param-name>
                <param-value>coldfusion.rest.servlet.CFResponseFilter</param-value>
            </init-param>
            <load-on-startup>11</load-on-startup>
        </servlet>
        <!-- end REST -->

    <!-- begin RDS -->
    <servlet id="coldfusion_servlet_8789">
        <servlet-name>RDSServlet</servlet-name>
        <display-name>RDS Servlet</display-name>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param id="InitParam_103401311065856789">
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.rds.RdsFrontEndServlet</param-value>
        </init-param>
    </servlet>
    <!-- end RDS -->

    <servlet>
        <servlet-name>CFFileServlet</servlet-name>
        <display-name>Serves files for cfpresentation,cfreport,captcha etc</display-name>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param>
            <param-name>servlet.class</param-name>
            <param-value>coldfusion.util.CFFileServlet</param-value>
        </init-param>
    </servlet>

     <!-- WSRP producer servlet.. -->
    <servlet>
        <servlet-name>WSRPProducer</servlet-name>
        <servlet-class>coldfusion.bootstrap.BootstrapServlet</servlet-class>
        <init-param>
            <param-name>servlet.class</param-name>
            <param-value>org.apache.axis.transport.http.AxisServlet</param-value>
        </init-param>
        <load-on-startup>101</load-on-startup>
    </servlet>

    <!-- Flash Remoting/Flex mapping -->
    <servlet-mapping id="coldfusion_mapping_0">
        <servlet-name>MessageBrokerServlet</servlet-name>
        <url-pattern>/flex2gateway/*</url-pattern>
    </servlet-mapping>

    <!-- start flex2
    <servlet-mapping>
        <servlet-name>FlexMxmlServlet</servlet-name>
        <url-pattern>*.mxml</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>FlexInternalServlet</servlet-name>
        <url-pattern>/flex-internal/*</url-pattern>
    </servlet-mapping>    
    end flex2 -->

    <servlet-mapping id="coldfusion_mapping_1">
        <servlet-name>FlashGateway</servlet-name>
        <url-pattern>/flashservices/gateway/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_2">
        <servlet-name>GraphServlet</servlet-name>
        <url-pattern>/CFIDE/GraphData</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_3">
        <servlet-name>CfmServlet</servlet-name>
        <url-pattern>*.cfm</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_4">
        <servlet-name>CFCServlet</servlet-name>
        <url-pattern>*.cfc</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_5">
        <servlet-name>CfmServlet</servlet-name>
        <url-pattern>*.cfml</url-pattern>
    </servlet-mapping>
    <!-- Please leave these .cfm/* mappings in.
          They are included to support Search Engine Safe (SES) URL types. 
    -->
    <!-- begin SES -->
    <servlet-mapping id="coldfusion_mapping_6">
        <servlet-name>CfmServlet</servlet-name>
        <url-pattern>*.cfml/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_7">
        <servlet-name>CfmServlet</servlet-name>
        <url-pattern>*.cfm/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_8">
        <servlet-name>CFCServlet</servlet-name>
        <url-pattern>*.cfc/*</url-pattern>
    </servlet-mapping>
    <!-- end SES -->
    <!-- begin RDS -->
    <servlet-mapping id="coldfusion_mapping_9">
        <servlet-name>RDSServlet</servlet-name>
        <url-pattern>/CFIDE/main/ide.cfm</url-pattern>
    </servlet-mapping>
    <!-- end RDS -->
    <servlet-mapping id="coldfusion_mapping_10">
        <servlet-name>CFCServlet</servlet-name>
        <url-pattern>*.jws</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_11">
        <servlet-name>GraphServlet</servlet-name>
        <url-pattern>/CFIDE/GraphData.cfm</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_12">
        <servlet-name>CFCServlet</servlet-name>
        <url-pattern>*.cfr</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_13">
        <servlet-name>CFFormGateway</servlet-name>
        <url-pattern>/CFFormGateway/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_14">
        <servlet-name>CFFileServlet</servlet-name>
        <url-pattern>/CFFileServlet/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping id="coldfusion_mapping_15">
        <servlet-name>CFRestServlet</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>CFForbiddenServlet</servlet-name>
        <url-pattern>*.hbmxml</url-pattern>
    </servlet-mapping>

    <!-- start flash form settings -->
    <servlet-mapping>
        <servlet-name>CFInternalServlet</servlet-name>
        <url-pattern>/cfform-internal/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>CFSwfServlet</servlet-name>
        <url-pattern>*.cfswf</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>CFForbiddenServlet</servlet-name>
        <url-pattern>*.as</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>CFForbiddenServlet</servlet-name>
        <url-pattern>*.sws</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>CFForbiddenServlet</servlet-name>
        <url-pattern>*.swc</url-pattern>
    </servlet-mapping>
    <!-- end flash form settings -->

   <!--  WSRP producer servlet mapping.. -->
   <servlet-mapping>
        <servlet-name>WSRPProducer</servlet-name>
        <url-pattern>/WSRPProducer/*</url-pattern>
   </servlet-mapping>

    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>

    <distributable/>

    <welcome-file-list id="WelcomeFileList_1034013110672">
        <welcome-file>index.cfm</welcome-file>
        <welcome-file>index.html</welcome-file>
        <welcome-file>index.htm</welcome-file>
    </welcome-file-list>

    <!-- start flex2
    <taglib>
        <taglib-uri>FlexTagLib</taglib-uri>
        <taglib-location>/WEB-INF/lib/cf-bootstrap-for-flex.jar</taglib-location>
    </taglib>
    end flex2 -->

</web-app> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T08:37:27.837

根据[这个线程](https://stackoverflow.com/questions/26732/invalid-url-pattern-servlet-mapping-in-tomcat-6-0)，该模式在 servlet 规范中是不合法的：您可以以 * 开头或结尾，但不能使用多个。JRun 倾向于支持这种映射风格，但 tomcat 不支持。雷洛也有同样的问题

[Adobe 已修改其 Tomcat 版本](http://blogs.coldfusion.com/post.cfm/what-s-the-deal-with-tomcat-in-coldfusion-10)以支持这些模式。

我能找到的所有示例都建议向特定文件添加额外的 servlet 映射，例如 foo/index.cfm/*地方。

我能想到的其他选项是使用[Tuckey 重写过滤器](http://tuckey.org/urlrewrite/)将您的 SES URL 映射到常规 URL 参数。

或者，您可以更改为 Tomcat7 实例并修改您的 web.xml 以引用 tomcat7 支持的 servlet 规范版本 3。Servlet 3 规范允许在 servlet 映射中使用正则表达式，这应该允许您正确支持 SES 映射。

发帖让我们知道你的进展情况。

# sql - 如何创建用于在 SQL 后端的多个表中输入复杂相关数据的结构

> ID：12217425
> 
> 赞同：0
> 
> 时间：2012-08-31T14:28:24.513
> 
> 标签：sql, database, database-design

我正在构建一个处理服务和硬件产品的订单和发票系统。简化后的表结构的一部分如下所示。（现实生活中的表要多一个数量级）：

我想从标准订单列表中选择一个订单，即与公司规模相关的订单，并在具有正确关系的适当表格中创建与此标准表格相关的所有各种产品的订单表格。例如：我为一家 5 人的小公司选择了计算机和配件的标准订单。订单已创建，OrderItem 行也已链接到订单和产品。

**客户（一方的子集）**

```
Customer_ID（PK、FK 到 Party） 
顾客姓名
...
```

**命令**

```
Order_ID (PK)
Customer_ID（FK 到客户）
订购日期
订单号
...
```

**订单项**

```
Order_ID (PK, FK to Order)
Product_ID（PK、FK 到产品）
数量
...
```

**产品**

```
Product_ID (PK)
产品名称
价格
信息
...
```

这个例子很容易编程，但是当有十个相互关联的表需要更新时——我不确定什么是最好的策略。

最好从以下位置获取生产表中的数据：

1）一组模板表，或多或少是生产数据的镜像，相互关联的方式与它们相同，但只包含通用数据（标准）而没有日期列等？

2) 将模板存储在生产数据表中，使用额外的字段来表示它们？这会在这些行中创建很多空列，例如关于日期等。

3）使用其他一些编程方法并使用它。就像根据选择的模板调用不同存储过程的表一样！？

4）？？？

希望这是可以理解的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T17:47:20.087

我认为您以错误的方式思考问题。您应该做的是创建一个满足小型企业客户需求的产品包。

所以你可以在产品之间添加自连接表

产品捆绑表

Product-ID1 整数非空引用产品 (product_id) Product_ID2 整数非空检查(!= Product-ID1) 引用产品 (product_id)

主键 ( Product-ID1 , Product_ID2 ) qty integer not null check (> 0) ....

现在您可以创建一个产品表条目，该条目引用其组成产品的产品表

# google-app-engine - maven-gae-plugin 0.9.4: no version available for org.codehaus.plexus:plexus-archiver:jar--帮我解释一下bug的解决方法

> ID：12217427
> 
> 赞同：1
> 
> 时间：2012-08-31T14:28:30.927
> 
> 标签：google-app-engine, maven, maven-gae-plugin

此错误已在 github 上关闭， [https://github.com/maven-gae-plugin/maven-gae-plugin/issues/39](https://github.com/maven-gae-plugin/maven-gae-plugin/issues/39) 但是我不明白它的修复，当我执行 gae 目标（如 mvn gae）时：更新它总是给我同样的问题。任何人都可以根据它的修复来解释这个问题的根本原因吗？

为了您的信息，我在这里复制粘贴原始问题及其修复：

> > 从今天早上开始，我继续收到此错误：
> 
> 无法在项目 gui 上执行目标 net.kindleit:maven-gae-plugin:0.9.4:unpack (execution2)：目标 net.kindleit 的执行 execution2:maven-gae-plugin:0.9.4:unpack failed: Plugin net。 kindleit:maven-gae-plugin:0.9.4 或其依赖项之一无法解析：无法收集 net.kindleit:maven-gae-plugin:jar:0.9.4 () 的依赖项：没有可用于 org 的版本。 codehaus.plexus:plexus-archiver:jar:[1.2,3.0) 在指定范围内
> 
> ..我现在被这个插件卡住了！

解决方法是：

> ..我在我使用的命令中添加了“-U”选项：mvn clean verify..它变成：mvn -U clean verify

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T19:28:17.107

如果它可以帮助某人，这是我对错误“没有可用于 org.codehaus.plexus:plexus-archiver:jar:[1.2,3.0) 的版本”的解决方案。

我更改了 gae-plugin 的 pom 配置：

```
<plugin>
    <groupId>net.kindleit</groupId>
    <artifactId>maven-gae-plugin</artifactId>
    <version>0.9.4</version>
    <dependencies>
        <dependency>
            <groupId>org.codehaus.plexus</groupId>
            <artifactId>plexus-archiver</artifactId>
            <version>2.1.2</version>
        </dependency>
    </dependencies>
</plugin> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T05:48:30.733

Maven repos 中提供的 GAE 运行时总是落后于官方 SDK。目前官方 SDK 是 1.7.1，但[GAE 运行时只有 1.7.0](http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22net.kindleit%22%20AND%20a%3A%22gae-runtime%22)。这就是您的 unpack 命令失败的原因 - 它找不到您请求的运行时版本。

# php - symfony2 自定义表单选择选项

> ID：12217431
> 
> 赞同：15
> 
> 时间：2012-08-31T14:28:44.267
> 
> 标签：php, symfony, symfony-forms

我正在尝试做一个简单的表单来添加一个带有名称和颜色的活动。

所以我想制作一个包含一些颜色数组的列表，现在它正在工作我有颜色的名称。
我可以将任何属性添加到我的选择标签：

```
$form = $this->createFormBuilder($myclass)
->add('Colors','choice',array('label'=>'select some colors',
            'multiple'=>true,
            'choices'=>array(1=>'red', 2=>'blue', 3=>'green'),
            'attr'=>array('style'=>'width:300px', 'customattr'=>'customdata')
            )); 
```

输出将是这样的：

```
<select name="select" style="width: 300px;" multiple="multiple" customattr="customdata">
   <option value="1">red</option>
   <option value="2">blue</option>
   <option value="3">green</option>
</select> 
```

但是我怎样才能将`selected="selected"`我想要的任何属性添加到我的选择选项中？像这样：

```
<select name="select" style="width: 300px;" multiple="multiple" customattr="customdata">
   <option style="background-color: #F00;" value="1" selected="selected">red</option>
   <option style="background-color: #00F;" value="2" selected="selected">blue</option>
   <option style="background-color: #0F0;" value="3">green</option>
</select> 
```

我的问题是：如何通过 symfony FormBuilder为`option`标签（而不是标签）添加自定义属性。**注意：**我不想使用 JavaScript。我想使用 symfony2 FormBuilder 来自定义我的选择选项。`select`

 *** * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T07:25:52.167

通常，字段的默认数据由对象中存储的值决定。例如，如果

```
class MyClass
{
    private $Colors = array(1, 2);
} 
```

那么条目“1”和“2”（带有标签“red”和“green”）将默认显示为选中状态。您还可以将此值存储在对象中，然后再将其传递给表单：

```
$myObject->Colors = array(1, 2);

$form = $this->createFormBuilder($myObject)
    ... 
```

最后一种可能性是通过传递“数据”选项来覆盖存储在对象中的默认值：

```
$builder->add('Colors', 'choice', array(
    'label' => 'select some colors',
    'multiple' => true,
    'choices' => array(1 => 'red', 2 => 'blue', 3 => 'green'),
    'attr' => array('style' => 'width:300px', 'customattr' => 'customdata'),
    'data' => array(1, 2),
)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T06:15:19.500

使用此处描述的数据选项 fo selected="selected" ： [http ://symfony.com/doc/current/reference/forms/types/field.html](http://symfony.com/doc/current/reference/forms/types/field.html)

在你的情况下可能是这样的

```
$form = $this->createFormBuilder($myclass)
->add('Colors','choice',array('label'=>'select some colors',
            'multiple'=>true,
            'choices'=>array(1=>'red', 2=>'blue', 3=>'green'),
            'attr'=>array('style'=>'width:300px', 'customattr'=>'customdata'),
            'data'=> 1
            )); 
```

新元素是将选择数组的编号设置为选定属性的**数据**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:35:53.603

symfony 中的每一个都`Field`继承自[abstract field type](http://symfony.com/doc/current/reference/forms/types/field.html)，它有一个`data`选项，您可以在其中传递默认选项。

顺便说一句，不要传递`style`东西，对于自定义 attrs 使用[`data-*`](http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-28T03:25:44.993

看起来 Symfony 2.7 将添加支持以使这更容易：

[https://github.com/symfony/symfony/pull/14050](https://github.com/symfony/symfony/pull/14050)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-08T07:09:50.463

为了在选项上添加您的自定义属性，基于该选项的值，请考虑使用[ChoiceType](http://symfony.com/doc/current/reference/forms/types/choice.html)字段`choice_attr`的选项。

例如，如果您想将 json 编码的实体传递给选项，您可以使用如下内容：

```
'choice_attr' => function($val, $key) {
   return ['data-object' => json_encode($val)];
}, 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-10T06:23:05.547

添加表单类方法 Symfony\Component\Form\AbstractType::finishView

```
public function finishView(FormView $view, FormInterface $form, array $options)
{
    parent::finishView($view, $form, $options);

    $additionalAttributes = array();

    // myMethod - method $choice, returns a value that is to be substituted into the attribute
    foreach ($view->children['orders']->vars['choices'] as $id => $choice) {
        $additionalAttributes[$id] = array(
            'data-cost' => $this->propertyAccessor->getValue($choice->data, 'myMethod'),
            'disabled' => 'disabled',
        );
    }

    foreach ($view->children['orders']->children as $id => $child) {
        $child->vars['attr'] = array_replace(
            isset($child->vars['attr']) ? $child->vars['attr'] : array(),
            $additionalAttributes[$id]
        );
    }
} 
```

[Symfony2 Form – 在选择字段类型中添加属性标签选项](http://zeka.kiev.ua/symfony2-form-%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B0%D1%82%D1%80%D0%B8%D0%B1%D1%83%D1%82%D0%B0-%D0%B2-%D1%82%D0%B5%D0%B3-option-%D0%B2-%D0%BF%D0%BE%D0%BB%D0%B5-%D1%82/)**

# c - AC算法找到两个二维四边形的交点？

> ID：12217435
> 
> 赞同：5
> 
> 时间：2012-08-31T14:28:58.050
> 
> 标签：c, algorithm, geometry, computational-geometry

我有一个四边形类型，定义为：

```
typedef struct __point {
    float x;
    float y;
} point_t;

typedef struct __quad {
    point_t p1;
    point_t p2;
    point_t p3;
    point_t p4;
} quad_t; 
```

如果我在同一平面上有两个这样的四边形，我希望能够计算出这些四边形的交点。例如，如果我们有**四边形 A**和**四边形 B**，如果 B 的任何点落在 A 之外，算法应该产生一个四边形，其点如下图所示（*A 为红色，B 为紫色*）：

![例子](../Images/b53fa34c7857d0fbf3192e65ac9b6d71.png)

**编辑：**点*的顺序并不*重要，因为我稍后将使用这些点来构造一个将在 A 内绘制的四边形。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:03:54.717

如果这样做的唯一原因是绘制生成的多边形，为什么不使用 GPU 为您完成工作 - 毕竟您使用的是 OpenGL。因此，与其纠结于如何构建交叉点，不如执行以下操作：-

```
Set Z values of Polygon A and Polygon B to some constant

Set Z test to no testing (always write Z regardless)

Disable Z test
Enable Z writes
Disable colour writes
Render Polygon A

Set Z test to z equal

Enable Z test
Disable Z write
Enable colour write
Render Polygon B 
```

嘿 presto，交叉多边形！

如果您将自己限制在 OpenGL 4 并使用各种可用的着色器，您可能会提高效率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:38:01.597

不是一个完整的实现，但是：

1.  编写一个例程找到两条线段的交点，`intersect_segment`

    ```
    bool segments_intersect(
        point_t a0, point_t a1,
        point_t b0, point_t b1,
        /*out*/ point_t* intersection
    ) 
    ```

2.  在 quad 例程中写一个点，`point_in_quad`

    ```
    bool point_in_quad(point_t p, quad_t q) 
    ```

3.  应用于`segments_intersect`每对分段，其中第一个在红色四边形中，第二个在紫色中（总共 16 次测试）

    ```
    point_t temp;
    if(segments_intersect(red.p1, red.p2, purple.p1, purple.p2, &temp)))
        found_point(temp);
    if(segments_intersect(red.p1, red.p2, purple.p2, purple.p3, &temp))
        found_point(temp);
    if(segments_intersect(red.p1, red.p2, purple.p3, purple.p4, &temp))
        found_point(temp);

    //10 more

    if(segments_intersect(red.p4, red.p1, purple.p2, purple.p3, &temp))
        found_point(temp);
    if(segments_intersect(red.p4, red.p1, purple.p3, purple.p4, &temp))
        found_point(temp);
    if(segments_intersect(red.p4, red.p1, purple.p4, purple.p1, &temp))
        found_point(temp); 
    ```

4.  应用于`point_in_quad`测试紫色四边形的红色四边形中的每个点：

    ```
    if(point_in_quad(red.p1, purple)) found_point(red.p1);
    if(point_in_quad(red.p2, purple)) found_point(red.p2);
    if(point_in_quad(red.p3, purple)) found_point(red.p3);
    if(point_in_quad(red.p4, purple)) found_point(red.p4); 
    ```

5.  应用于`point_in_quad`测试红色四边形的紫色四边形中的每个点：

    ```
    if(point_in_quad(purple.p1, red)) found_point(purple.p1);
    if(point_in_quad(purple.p2, red)) found_point(purple.p2);
    if(point_in_quad(purple.p3, red)) found_point(purple.p3);
    if(point_in_quad(purple.p4, red)) found_point(purple.p4); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:47:36.870

*   四边形是否保证不会自相交？
*   四边形是否保证是凸的？

如果它们是凸的，那么我相信任何相交都会产生一个最多有八个顶点的多边形。如果它们可能不是凸的，则最终可以得到两个分离的多边形作为交集。

假设是凸的，我相信（但尚未验证）结果中的顶点集将是线交点集加上包含在另一个输入四边形中的任一输入四边形的顶点集。然后，交点将成为这些顶点的（凸）外壳。

在这一点上，这只是有效地获得这些集合的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T16:33:39.700

对于凸多边形，我建议：

[1：用分离轴法](http://www.geometrictools.com/Documentation/MethodOfSeparatingAxes.pdf)检查相交的事实（快速）

2：从 O'Rourke 书中查找与算法的交集[（可用 C 代码）](http://cs.smith.edu/~orourke/books/compgeom.html)

# c# - 在 Word 文档关闭时运行代码

> ID：12217437
> 
> 赞同：1
> 
> 时间：2012-08-31T14:29:07.597
> 
> 标签：c#

当一个word文档在c#中关闭时，有什么方法可以运行代码？例如，我想在我的桌面上关闭一个 word 文档时显示一个消息框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:48:45.223

您可以使用`Marshal.GetActiveObject`

```
Application word = (Application)Marshal.GetActiveObject("Word.Application");
if(word == null)
{
   Console.Write("Your word is not started");
} 
```

Msdn：http: [//msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getactiveobject.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getactiveobject.aspx)

# c# - 在 Windows Phone 应用程序中使用 C# 编辑/更新 xml

> ID：12217445
> 
> 赞同：1
> 
> 时间：2012-08-31T14:29:49.373
> 
> 标签：c#, windows-phone-7

我打算创建一个读取本地 xml 文件的 windows phone 应用程序（c# & XML），在文本框中发布数据，然后用户可以更改数据并保存 xml 文件。我需要一些关于如何做到这一点的指导（不是代码，只是想法）。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:36:39.993

如果 XML 文件具有预定义的架构，您最好使用 xsd.exe 命令将该架构导入您的应用程序。然后，您可以将本地 XML 文件反序列化为内存对象，编辑该对象的属性和字段，然后将内存对象序列化回磁盘。

参考：

*   [XSD 参考](http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=vs.100%29.aspx)
*   [序列化和反序列化 XML](http://geekswithblogs.net/paulwhitblog/archive/2007/07/20/114076.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T12:18:04.447

要使用以下隔离和 LINQ 参考和指南。

LINQ [http://msdn.microsoft.com/en-us/library/bb397933](http://msdn.microsoft.com/en-us/library/bb397933)

隔离 [http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.aspx](http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:32:47.290

你的意思是像 XmlWriter 这样的东西？这是一篇关于它的好文章[http://www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-XML-files-using-XmlWriter](http://www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-XML-files-using-XmlWriter)。

如果这对您不起作用，请回帖。

# java - 从字符串数组创建一个文本文件

> ID：12217448
> 
> 赞同：-2
> 
> 时间：2012-08-31T14:30:11.647
> 
> 标签：java, android, file

```
 String strFileContent="";    
    Log.e(TAG, "Error loading image file names333");
    StringBuilder contents = new StringBuilder();///

    for (int i = 0; i < x.length; i++) {
        ///strFileContent += ""+x[i]+",";
        contents.append(x[i]);///
    contents.append(System.getProperty("line.separator"));///
    }
    strFileContent=contents.toString();/// 
```

```
String file = "scores8"; 
```

java或android：如何从字符串数组x []每行一个元素创建一个文本文件？？？什么类型的文件不使用 ext 或 txt 或...？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:41:34.150

您可以在 Apache Commons IO 中使用[FileUtils ：](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#writeLines%28java.io.File,%20java.util.Collection%29)

```
FileUtils.writeLines(new File("file.txt"), Arrays.asList(array)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:35:22.907

```
String[] array = {...};
File file = new File("FilePath");
PrintWriter pw = new PrintWriter(file, true);
for(String s : array) pw.println(s);
pw.close(); 
```

# cakephp - CakePHP：使用时内容/数据来自什么 - > Content For Layout

> ID：12217453
> 
> 赞同：0
> 
> 时间：2012-08-31T14:30:42.907
> 
> 标签：cakephp

我对 CakePHP 还是有点陌生​​，但我知道对它的工作原理有一个很好的基本了解，但是我发现了一些我似乎无法找到答案的东西。

我一直在到处寻找一个，但我仍然迷路了。

当您调用 $content_for_layout 时，CakePHP 从哪里获取数据。

我已经从其他人那里接管了一个项目，它被设置在许多页面上，但我似乎在 app 文件夹中找不到任何东西。我已经搜索了所有控制器，我发现它的唯一地方是当它在他们自己的视图文件中的屏幕上回显时。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:40:36.790

`$content_for_layout`从当前控制器/动作的特定视图文件中填充。查看`app/views`文件夹（`app/View`对于 CakePHP 2），您将看到与控制器直接相关的文件夹列表，然后在每个文件夹中都有一堆`.ctp`与控制器操作相关的文件。

默认 URL 结构`/controller/action/params`如下：

```
URL: /products/view/12
View file: `app/views/products/view.ctp`

URL: /users/index
View file: `app/views/users/index.ctp`

Sometimes there is a prefix (for admin areas and such, this goes at the start of the URL like so:
URL: /admin/products/edit/12
View file: `app/views/products/admin_edit.ctp` 
```

希望这可以帮助。您的 URL 结构可能已被路由更改，在这种情况下，请深入`config/routes.php`了解正在调用的控制器/动作以及视图文件是什么。如果您在使用 CakePHP 时遇到任何问题，请阅读[本书的 MVC 部分](http://book.cakephp.org)（请务必使用正确的版本）。

# javascript - JavaScript 1.7 区分数组和对象的迭代器

> ID：12217458
> 
> 赞同：0
> 
> 时间：2012-08-31T14:31:13.813
> 
> 标签：javascript, firefox, iterator

以下代码引用了 Firefox 特定的 JavaScript 1.7 实现，其中包含数组理解和迭代器/生成器。请注意，在撰写本文时，Webkit 浏览器（Chrome、Safari）尚不支持“Iterator”、“yield”和数组解析，并且似乎仅适用于 Firefox 的 JavaScript 引擎（Google、liberateme）。

*注意：ECMAScript Harmony 可能会对语法带来新的变化，并可能使这篇文章过时*

```
var myobject = {'foo':5,'bar':10};
var myarray = [10,20,30];

for (var i in it) {
console.log(i);
} 
```

## 代码：

### JavaScript：

```
//if var it = Iterator(myobject);
['foo',5]
['bar',10]
//if var it = Iterator(myarray);
[0,10]
[1,20]
[2,30] 
```

似乎 JS 1.7 迭代器总是返回一个“键”和一个“值”（无论键是实际的对象键还是数组的索引。与 Python 相比，迭代器足够聪明，如果它只返回 1 个值）是一个数组。

### Python：

```
#if it = iter(myobject);
[foo,5]
[bar,10]
#if it = iter(myarray);
10,
20,
30 
```

所以问题是，当我尝试移植 Python 到 JavaScript 函数时，为什么 Iterator() 和 iter() 不做同样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:31:13.813

## 回答：

为了将代码从 Python 函数/库移植到 JavaScript，假设 Iterator() 和 iter() 做同样的事情有点令人沮丧，只是意识到（它们略有不同，导致开发人员不得不有时滚动他们自己的迭代器/生成器函数（使用'yield'）*。

例如，假设我们想要滚动 python 的 items() 函数，该函数是 dict 对象的原生函数。

```
var items = items = function(object) {
        var list = [];
        for (var i in object) {
            list.push([i,object[i]]);
        }
        return list;
    }; 
```

items() 在传递*myobject* JavaScript 对象时工作得很好（当然，我使用的是嵌套数组而不是元组）。

```
items(myobject);
//[['foo':5],['bar':10]] 
```

然而，在为 items(myobject) 构造迭代器时，我们实际上是在迭代一个列表，所以我们想要制作一个只产生第二个索引的自定义生成器来重现 Python 的功能：

```
 var arrayIterator = function(array){ 
    for (var i in iter) {
            yield i[1];//iterate over the non-index portion of the array iterable.
        }

    }

arrayIterator(items(myobject))

['foo',5]
['bar',10] 
```

请注意，这里实际上有一些冗余。请注意

```
Iterator(myobject) = arrayIterator(items(myobject)) 
```

所以最后，请注意您正在迭代的内容，看看您是否可以通过避免调用最终成为彼此相反的函数来加快调用速度。

我希望所有这些都是事实准确的——如果我错了，请纠正我。

# python - 合并字典而不覆盖，而是在键相等时增加值

> ID：12217461
> 
> 赞同：2
> 
> 时间：2012-08-31T14:31:30.770
> 
> 标签：python, dictionary, merge

有没有办法在不盲目覆盖同一键值的情况下更新（）字典？例如，如果我找到它，我希望在我的策略中为同一个键添加值，如果找不到键则连接。

```
d1 = {'eggs':3, 'ham':2, 'toast':1}
d2 = {'eggs':2,'ham':1}

dresult = d1.myUpdate(d2)

print dresult 
{'eggs':5,'ham':3,'toast':1} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T14:36:12.417

您可以为此使用[计数器（在 python 2.7 中引入）：](http://docs.python.org/library/collections.html#collections.Counter)

```
from collections import Counter
d1 = {'eggs':3, 'ham':2, 'toast':1}
d2 = {'eggs':2,'ham':1}
dresult = Counter(d1) + Counter(d2)  #Counter({'eggs': 5, 'ham': 3, 'toast': 1}) 
```

如果你需要一个适用于 python2.5+ 的版本，a`defaultdict`也可以工作（虽然不是很好）：

```
from collections import defaultdict    
d1 = {'eggs':3, 'ham':2, 'toast':1}
d2 = {'eggs':2,'ham':1}
d = defaultdict(int)
dresult.update(d1)
for k,v in d2.items():
   dresult[k] += v 
```

尽管您可以实现等效的python2。？结果使用字典的`setdefault`方法...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-31T14:36:56.473

使用计数器：

```
from collections import Counter
d1 = Counter({'eggs':3, 'ham':2, 'toast':1})
d2 = Counter({'eggs':2,'ham':1})
print d1 + d2 
```

# python - 从文件中读取的变量是否与硬编码字符串不同？

> ID：12217462
> 
> 赞同：0
> 
> 时间：2012-08-31T14:31:36.697
> 
> 标签：python, selenium, proxy

看到这个代码

```
PROXY_HOST, PROXY_PORT = choice(proxies).rstrip().split(":")

fp = webdriver.FirefoxProfile()

# Direct = 0, Manual = 1, PAC = 2, AUTODETECT = 4, SYSTEM = 5
fp.set_preference("network.proxy.type", 1)

fp.set_preference("network.proxy.http", PROXY_HOST)
fp.set_preference("network.proxy.http_port", PROXY_PORT)
fp.set_preference("network.proxy.ftp", PROXY_HOST)
fp.set_preference("network.proxy.ftp_port", PROXY_PORT)
fp.set_preference("network.proxy.ssl", PROXY_HOST)
fp.set_preference("network.proxy.ssl_port", PROXY_PORT) 
```

proxies 是 form 中的代理列表`123.123.123.123:1234\n`。奇怪的是，如果我对这两个变量进行硬编码`PROXY_HOST`并且`PROXY_PORT`它将使用代理，如果我尝试从我喜欢的文件中读取它

```
with open("proxies.txt") as f:
    proxies = f.readlines() 
```

代理设置被忽略。如果我打印这两个变量，它们是正确的但未使用。

那么有什么我看不到的吗，硬编码 ip 和端口或从文件/列表中读取它有什么不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:35:34.813

`readlines`保留每一行的行尾字符。如果端口设置为，例如，这可能会导致代理设置静默失败`"1234\n"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:39:54.117

这是一个如何正确调试问题。看看`proxies`这个列表是硬编码`proxies`的还是你从文件中读取的。最好的方法是使用 . 打印两个变量`repr()`。你会看到不同。解决方法很简单：从文件中读取端口后，仍然是字符串，需要转换为整数。当你硬编码它时，你首先将它定义为一个整数。

# c# - 单选按钮 OnCheckedChanged 未触发两次

> ID：12217465
> 
> 赞同：0
> 
> 时间：2012-08-31T14:31:44.343
> 
> 标签：c#, asp.net, radio-button

列表视图的项目模板内有一个单选按钮。我在列表视图与组名属性混淆时遇到了一些问题，并使用自定义单选按钮来克服这个问题（http://www.codeproject.com/Articles/7960/How-to-group-RadioButtons）。

当我单击单选按钮时，事件会正确触发。当我点击一个单选按钮*之后*，事件仍然只触发一次，但它应该触发两次。

我查看了源代码，似乎每个控件都分配了回发事件。

```
<tr>
                                    <td class="name">
                                        <span id="cph1_lvOptions_lvGuideSpecOptionGroupOptions_21_lblOptionName_0">None</span>

                                    </td>
                                    <td class="available">

                                    </td>
                                    <td class="available">
                                        <input id="cph1_lvOptions_lvGuideSpecOptionGroupOptions_21_rbOption_0" type="radio" value="ctl00$cph1$lvOptions$ctrl21$lvGuideSpecOptionGroupOptions$ctrl0$rbOption" onclick="javascript:setTimeout(&#39;__doPostBack(\&#39;ctl00$cph1$lvOptions$ctrl21$lvGuideSpecOptionGroupOptions$ctrl0$rbOption\&#39;,\&#39;\&#39;)&#39;, 0)" name="Paralleling Switchgear" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="name">
                                        <span id="cph1_lvOptions_lvGuideSpecOptionGroupOptions_21_lblOptionName_1">EGP UL 891</span>

                                    </td>
                                    <td class="available">

                                    </td>
                                    <td class="available">
                                        <input id="cph1_lvOptions_lvGuideSpecOptionGroupOptions_21_rbOption_1" type="radio" value="ctl00$cph1$lvOptions$ctrl21$lvGuideSpecOptionGroupOptions$ctrl1$rbOption" onclick="javascript:setTimeout(&#39;__doPostBack(\&#39;ctl00$cph1$lvOptions$ctrl21$lvGuideSpecOptionGroupOptions$ctrl1$rbOption\&#39;,\&#39;\&#39;)&#39;, 0)" name="Paralleling Switchgear" />
                                    </td>
                                </tr> 
```

关于可能导致这种情况的任何想法？我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:39:27.663

如果您查看生成的 javascript，您会看到回发发生在 onclick 事件中。onclick 事件仅针对您实际单击的单选按钮触发，而不是为失去焦点的按钮触发。

真的，我认为这是你想要的行为。否则，每次更改单选按钮选项时，您都必须与服务器进行两次往返，这会使您的页面痛苦地无响应。在您的事件处理程序中，只需检查新的选中单选按钮是什么，而不是依赖第二次回发。

# phpstorm - 如何让 PhpStorm 建议预定义的输入变量列表？

> ID：12217466
> 
> 赞同：1
> 
> 时间：2012-08-31T14:31:44.850
> 
> 标签：phpstorm

我如何`PhpStorm`建议输入变量？

在 Java/C# 等（使用 VS/Eclipse）中，当我有一个接收`enum`-input-variable 的函数时，例如：

```
void func(SomeEnum var); 
```

每当我输入`func(`时，编辑器都会建议所有可用的枚举（类型`SomeEnum`）。当我有一组预定义的输入选项（如 DB 表）时，我会在 PHP 中寻找同样的功能。

也许使用`Intellilang`这些`@`标签（PHPDocs？）我可以预定义这样的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T16:19:00.253

目前，您无法在这方面限制代码完成的可能选项：PHP 根本没有类似于 Enum 的“东西”。您可以做的唯一限制是受预期参数类型的限制（例如`int`，当参数需要一个 时，不会提供变量`array`）。

我认为这将是寻找的正确票：http: [//youtrack.jetbrains.com/issue/WI-854](http://youtrack.jetbrains.com/issue/WI-854)，也许是[http://youtrack.jetbrains.com/issue/WI-3623](http://youtrack.jetbrains.com/issue/WI-3623)

相关类型（用于数组索引完成）：http: [//youtrack.jetbrains.com/issue/WI-3423](http://youtrack.jetbrains.com/issue/WI-3423)

# vim - 在vim中取消突出显示列

> ID：12217469
> 
> 赞同：-1
> 
> 时间：2012-08-31T14:31:55.250
> 
> 标签：vim, highlighting

我在一个新系统上使用 vim 7.3，并且在编辑长行文件时注意到一些非常烦人的事情。vim 突出显示第 80 列之后的所有文本。当然，我可以看到这可能很方便，但我想将其关闭。它似乎不是 colorcolumn 设置 - 我可以打开它并看到由原始突出显示突出显示的单个列仍然存在。

这是一个屏幕截图：

![](../Images/d9a9a27fcf3b92ea45eff8c77c289cfa.png)

有人可以请教吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:39:34.727

Vim 默认不这样做：这可能是[这个老把戏](http://vim.wikia.com/wiki/VimTip810)的变种。检查您的`~/.vimrc`和 ftplugins。

# c# - LINQ to Entities 无法识别该方法，并且该方法无法转换为存储表达式

> ID：12217471
> 
> 赞同：3
> 
> 时间：2012-08-31T14:31:56.393
> 
> 标签：c#, linq, entity-framework

这是我写的 Linq to Entities 声明。

```
public static List<Model.User> GetNearestUsers(int userid,int count,ref Model.HangoutDBEntities context)
    {
        Model.Location myLocation=GetCurrentLocation(userid,ref context);

        return context.Locations.Where(o => EntityFunctions.DiffMinutes(DateTime.Now, o.DateTimeStamp) <= 30).OrderBy(o => Core.Location.Distance.CalculateDistance(myLocation.Latitude, myLocation.Longitude, o.Latitude, o.Longitude)).Select(o => o.User).ToList();
    } 
```

这是CalculateDistance方法

```
public static double CalculateDistance(decimal lat1,decimal lon1,decimal lat2,decimal lon2)
    {
        try
        {
            var R = 6371; // Radius of the earth in km
            var dLat = DegreeToRadian((double)(lat2 - lat1));  // Javascript functions in radians
            var dLon = DegreeToRadian((double)(lon2 - lon1));
            var a = Math.Sin(dLat / 2) * Math.Sin(dLat / 2) +
                    Math.Cos(DegreeToRadian((double)lat1)) * Math.Cos(DegreeToRadian((double)lat2)) *
                    Math.Sin(dLon / 2) * Math.Sin(dLon / 2);
            var c = 2 * Math.Atan2(Math.Sqrt(a), Math.Sqrt(1 - a));
            var d = R * c; // Distance in km

            return (double)d;
        }
        catch
        {
            return 0.0;
        }
    }

    public static double DegreeToRadian(double angle)
    {
        return Math.PI * angle / 180.0;
    } 
```

请让我知道是否有任何解决方法。我得到一个例外

> LINQ to Entities 无法识别方法 'Double CalculateDistance(System.Decimal, System.Decimal, System.Decimal, System.Decimal)' 方法，并且此方法无法转换为存储表达式。

我知道自定义函数不适用于 Linq 2 实体，但我不知道解决方法。你能帮帮我吗？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:37:03.750

将数据加载到列表中，然后对列表执行计算

```
 var origList = context.Locations.Where(o => EntityFunctions.DiffMinutes(DateTime.Now, o.DateTimeStamp) <= 30).ToList()

 var orderedList = origList.OrderBy(o => Core.Location.Distance.CalculateDistance(myLocation.Latitude, myLocation.Longitude, o.Latitude, o.Longitude)).Select(o => o.User).ToList(); 
```

或者;

```
context.Locations
    .Where(o => EntityFunctions.DiffMinutes(DateTime.Now, o.DateTimeStamp) <= 30).ToList()
        .OrderBy(o => Core.Location.Distance.CalculateDistance(myLocation.Latitude, myLocation.Longitude, o.Latitude, o.Longitude))
            .Select(o => o.User).ToList(); 
```

需要注意的是 where 子句之后的 ToList。

调用 ToList() 后，数据被加载到内存中，排序成为 Linq To Objects 的任务

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T14:48:48.073

看看[https://stackoverflow.com/a/5971677/292787](https://stackoverflow.com/a/5971677/292787)

> 您可以定义一个自定义方法...，并告诉 Entity Framework 如何将该方法转换为 SQL

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-13T17:46:49.473

我最近不得不解决这个问题。诀窍是对大多数语句（Math.Pow 除外）使用 System.Data.Entity.SqlServer 中的 SqlFunctions 而不是 System.Math。

备用 LINQ 样式（from/where/let/orderby 等）很有用，因为 let 关键字允许您分解问题并保持可读性。

```
var closestLocation = await (
    from q in qryable
    where q.LAT.HasValue && q.LONG.HasValue
    // Convert derees to radians (pi / 180 = 0.01745...)
    let dbLatitudeRadians = q.LAT.Value * 0.0174532925199433
    let dbLongitudeRadians = q.LONG.Value * 0.0174532925199433
    let requestLatitudeRadians = requestLatitude * 0.0174532925199433
    let requestLongitudeRadians = requestLongitude * 0.0174532925199433
    let deltaLatitudeRadians = requestLatitudeRadians - dbLatitudeRadians
    let deltaLongitudeRadians = requestLongitudeRadians - dbLongitudeRadians
    let sinHalfLatitudeDistance = SqlFunctions.Sin(deltaLatitudeRadians / 2) ?? 0.0
    let sinHalfLongitudeDistance = SqlFunctions.Sin(deltaLongitudeRadians / 2) ?? 0.0
    let cosThisLatitude = SqlFunctions.Cos(dbLatitudeRadians) ?? 0.0
    let cosThatLatitude = SqlFunctions.Cos(requestLatitudeRadians) ?? 0.0
    let expr = Math.Pow(sinHalfLatitudeDistance, 2) + cosThisLatitude * cosThatLatitude * Math.Pow(sinHalfLongitudeDistance, 2)
    let sqrtExpr = Math.Pow(expr, 0.5)
    let sqrt1MinusExpr = Math.Pow(1 - expr, 0.5)
    let distanceInMeters = 6376500 * 2 * SqlFunctions.Atan2(sqrtExpr, sqrt1MinusExpr)
    orderby distanceInMeters
    select q
).FirstOrDefaultAsync(cancellationToken).ConfigureAwait(false); 
```

# .net - 如何替换异常？

> ID：12217474
> 
> 赞同：1
> 
> 时间：2012-08-31T14:32:09.410
> 
> 标签：.net, unit-testing, mocking, nsubstitute

我想替换一个异常和它的字段。

像这样的东西：

```
var webExcetion = Substitute.For<WebException>();
webExcetion.Response.Returns(httpWebResponse);
substituteForHttp.GetResponse(Arg.Any<string>()).Returns(x => { throw webExcetion; }); 
```

此代码由 NSubstitute 引发 Castle.Proxies.ExceptionProxy 或 NSubstitute.Exceptions.CouldNotSetReturnException。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T23:23:04.770

该类`WebException`没有虚拟成员，因此 NSubstitute 不能用它做很多事情（它通过使用 Castle DynamicProxy 创建派生类型的实例来工作，然后通过覆盖所有虚拟成员将实例更改为替代工作）。

在这种情况下，使用 real 来解决这个问题应该没问题`WebException`：

```
WebException webException = 
    new WebException("test", null, webExceptionStatus, httpWebResponse); 
```

这将根据需要将`Response`属性设置`httpWebResponse`为。

希望这可以帮助。

# php - @mysqli_select_db -- 访问被拒绝

> ID：12217476
> 
> 赞同：1
> 
> 时间：2012-08-31T14:32:16.337
> 
> 标签：php, mysql, database, function

我想用来`@mysqli_select_db()`在两个数据库之间切换。

两个数据库都有完全相同的用户，但是当我运行这个函数时，我得到一个`access denied`错误。

怎么了？

**更新：**问题解决了。我在`@mysqli_select_db()`. 无论如何感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:33:50.070

`access denied`表示您用来连接数据库服务器的用户根本不允许访问您要切换到的数据库。用于`GRANT`扩展用户的权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:37:19.327

请从 MySQL 中查看此[列表。](http://dev.mysql.com/doc/refman/5.1/en/access-denied.html)此特定错误消息可能有多种原因。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-31T14:55:56.630

问题解决了。我在`@mysqli_select_db()`.

# jquery - Chrome 和 Firefox 给出不同的结果 json for( key in result)

> ID：12217480
> 
> 赞同：0
> 
> 时间：2012-08-31T14:32:21.743
> 
> 标签：jquery, json, firefox, google-chrome

我有这个代码：

```
$.get('http://mapit.mysociety.org/areas/'+ulo, function(response) {

                        console.log(response);

                        var areaList = [];

                        for (var k in response) {
                                 var obj = response[k];
                                 areaList.push(obj);
                                 console.log(response[k]);

                            }
                        var len = areaList.length; 
```

在 Chrome 中，效果很好，例如，将 +ulo 更改为 wembley。

在 Chrome 开发工具上，我根据标题对象下的两个 console.log 获取对象：

> 对象 index_fb.js：41 [对象 all_names：对象代码：对象国家：“E”国家名称：“英格兰”generation_high：18 generation_low：1 id：8258 名称：“Wembley Central”parent_area：2488 类型：“LBW”type_name：“ London borough ward" **原型**：对象

但是，在Firefox中也是如此，我在Firebug中得到了这个：

> {“8258”：{“parent_area”：2488，“generation_high”：18，“all_names”：{}，“id”：8258，“codes”：{“ons”：“00AEHE”，“gss”：“E05000104 ", "unit_id": "11458"}, "name": "Wembley Central", "country": "E", "type_name": "London borough ward", "generation_low": 1, "country_name": "England ", "类型": "LBW"}}

index_fb.js（第 41 行）

{

index_fb.js（第 48 行）

"

index_fb.js（第 48 行）

8

index_fb.js（第 48 行）

2

index_fb.js（第 48 行）

5

index_fb.js（第 48 行）

8

index_fb.js（第 48 行）

"

index_fb.js（第 48 行）

：

index_fb.js（第 48 行）

index_fb.js（第 48 行）

{

index_fb.js（第 48 行）

"

index_fb.js（第 48 行）

p

index_fb.js（第 48 行）

一个

index_fb.js（第 48 行）

r

index_fb.js（第 48 行）

e

index_fb.js（第 48 行）

n

index_fb.js（第 48 行）

吨

index_fb.js（第 48 行）

_

index_fb.js（第 48 行）

一个

index_fb.js（第 48 行）

r

index_fb.js（第 48 行）

e

index_fb.js（第 48 行）

一个

index_fb.js（第 48 行）

"

index_fb.js（第 48 行）

：

index_fb.js（第 48 行）

index_fb.js（第 48 行）

2

index_fb.js（第 48 行）

4

index_fb.js（第 48 行）

8

index_fb.js（第 48 行）

8

index_fb.js（第 48 行）

等等等等

因此，Console.log(response) 是正确的，但它似乎包含以下每个字母：

```
for (var k in response) { 
```

k = Firefox 中的数字，与 chrome 一样，它将 k 处理为整数 8​​258。

我如何解决这个问题，使其适用于两者？

谢谢

**编辑**

这是新代码：仍然是同样的问题：

```
$.get('http://mapit.mysociety.org/areas/'+ulo, function(response)  {

                        console.log(response);

                        var areaList = [];

                        for (var k in response) {

                            if (response.hasOwnProperty(k)) { 
                                 var obj = response[k];
                                 areaList.push(obj);
                                 }
                            } 
```

我也尝试过，但我是否需要将 Get 包装到 $.ajax 中以确保它知道返回了 json。该应用程序在将 ajax 用于非安全源时存在问题。

到目前为止没有快乐:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:50:58.240

Firefox 认为您的对象是一个字符串。您应该指定`dataType:"json"`检索正确的 JSON 对象，您将能够枚举哪些属性。Jquery 允许您通过以下的最终参数设置数据类型`$.get`：

```
$.get(url,successFunction,"json") 
```

# ruby-on-rails - 在 Ruby 中使用 Rails 测试语法

> ID：12217483
> 
> 赞同：2
> 
> 时间：2012-08-31T14:32:30.753
> 
> 标签：ruby-on-rails, ruby, unit-testing

像大多数人一样，我在 Ruby 之前学习过 Rails，现在我想更好地了解 Ruby。
我正在制作一些脚本，我想测试它们。
我很惊讶不能在普通的 ruby​​ 脚本中使用 Rails 的测试语法。以下代码不起作用：

```
require "test/unit"
class MyTest < Test::Unit::TestCase
  test "one plus one should be equal to two" do
    assert_equal 1 + 1, 2
  end
end

# Error: wrong number of arguments (1 for 2) (ArgumentError) 
```

您必须改用此代码：

```
require "test/unit"
class MyTest < Test::Unit::TestCase
  def one_plus_one_should_be_equal_to_two
    assert_equal 1 + 1, 2
  end
end 
```

这对我来说似乎不太可读。
是否可以在纯 Ruby 脚本中使用“声明性”语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:32:30.753

根据 Rails 的 API，该`test`方法在[ActiveSupport::Testing::Declarative](http://api.rubyonrails.org/classes/ActiveSupport/Testing/Declarative.html#method-i-test)模块中定义，并使用一种元编程来添加新的测试方法。

如果你还没有安装 Rails gem，你可以安装 activesupport gem：

```
gem install activesupport 
```

现在你只需要 require 它并使你的类继承自`ActiveSupport::TestCase`.
这是完整的代码：

```
require "test/unit"
require "active_support"
class MyTest < ActiveSupport::TestCase
  test "one plus one should be equal to two" do
    assert_equal 1 + 1, 2
  end
end 
```

# gwt - GWT SuggestBox 自定义非文本编辑器

> ID：12217490
> 
> 赞同：0
> 
> 时间：2012-08-31T14:32:48.057
> 
> 标签：gwt

在我的应用程序中，我有十几个地方需要显示国家/地区建议框。建议框的所有代码（包括自定义的创建`SuggestOracle`、它的初始化和各种处理程序）占用了大约 100 行，并且在整个项目中复制它对我来说似乎非常核心。所以我决定编写一个自定义`CountrySuggestBox`，它扩展`SuggestBox`了自己的自定义结构，`SuggestOracle`并自己完成了所有的点击/按键处理。在此之后，我打算只写一些东西`@UiFiled(provided=true) CountrySuggestBox = new CountrySuggestBox(countryList);`并完成它。但为此，我还需要 CountrySuggestBox 来实现`LeafValueEditor<Country>`我做不到的，因为 SuggestBox 实现了 HasText 并且这些接口彼此不“喜欢”。

那么如何`CountrySuggestBox`在不使用它的类中编写自定义编辑器方法的情况下制作国家类型属性的编辑器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:38:27.533

**更喜欢组合而不是继承。**

扩展（或简单地实现`CountrySuggestBox`）并包装. 然后你可以把它变成一个or （连同or ）`Composite``IsWidget``SuggestBox``LeafValueEditor<Country>``IsEditor<LeafValueEditor<Country>>``TakesValue<Country>``HasValue<Country>`

# jquery - 滚动上的 jQuery 加载 - 在滚动到显示块时淡入表格行。无休止的滚动

> ID：12217491
> 
> 赞同：0
> 
> 时间：2012-08-31T14:32:48.327
> 
> 标签：jquery, jquery-ui, scroll

这是否可能没有 PHP、SQL、.NET 等，只需要 jQuery、HMTL 和 CSS。

我有一个表格，而不是分页，我希望能够在向下滚动页面时加载其他行，类似于 Facebook 和 Twitter。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:38:55.973

你可能想检查这个 [http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)

从插件页面引用：“你不需要编写任何自定义后端的东西来启用这个功能！”

# shiro - 如何使用 Shiro 对用户进行身份验证？

> ID：12217495
> 
> 赞同：4
> 
> 时间：2012-08-31T14:32:53.890
> 
> 标签：shiro

我一遍又一遍地讨论如何让用户使用 Shiro 登录，但似乎仍然缺少一个重要的部分：shiro 如何根据存储的用户名和密码验证给定的用户名和密码？我想出的最多的是`It is each Realm's responsibility to match submitted credentials with those stored in the Realm's backing data store` [从这里](http://shiro.apache.org/realm.html#Realm-authentication)。但是这是怎么做到的呢？

以下是我尝试过的，但结果仍然是无效的身份验证。

登录控制器

```
@RequestMapping(value = "/login.htm", method = RequestMethod.POST)
protected ModelAndView onSubmit(HttpServletRequest request, HttpServletResponse response, Object cmd, BindException errors) throws Exception {

    LoginCommand command = (LoginCommand) cmd;
    UsernamePasswordToken token = new UsernamePasswordToken(command.getUsername(), command.getPassword());
    System.out.println("onSubmit");
    System.out.println(token.getUsername());
    System.out.println(token.getPassword());

    try
    {
        SecurityUtils.getSubject().login(token);
    } catch (AuthenticationException e) {
        errors.reject("error.invalidLogin", "The username or password was not correct.");
    }

    if (errors.hasErrors()) {
        return showForm(request, response, errors);
    } else {
        return new ModelAndView("accessTest");
    }
} 
```

领域

```
protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authcToken) throws AuthenticationException {
    UsernamePasswordToken token = (UsernamePasswordToken) authcToken;

    System.out.println("doGetAuthenticationInfo");
    System.out.println(user.getUsername());
    System.out.println(user.getPassword());

    // user is a test object in place of a database
    if( user != null ) {
        return new SimpleAuthenticationInfo(user.getUsername(), user.getPassword(), getName());
    } else {
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:20:32.953

发现了答案。这是一个愚蠢的。我复制了一些示例代码，他们将凭据匹配器设置为 HashedCredentialsMatcher。我没有做任何散列，所以它不起作用。删除了 setCredentialsMatcher 并且它起作用了。

# javascript - 当我在 Javascript 中提供的参数超过函数所需的参数时会发生什么？

> ID：12217497
> 
> 赞同：3
> 
> 时间：2012-08-31T14:32:59.367
> 
> 标签：javascript

认为 -

```
function noname(a, b) {
//code
} 
```

我给 -

```
noname(4,5,6,7); 
```

那时会发生什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T14:33:40.310

附加参数将被忽略。

然而，它们将作为`arguments`伪数组的一部分提供，例如`arguments[2]`, `arguments[3]`。

如果您提供的变量*少于*所需的变量，那么缺少的变量将是`undefined`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:42:21.253

正如 Alnitak 所说，它们成为，`undefined`因为它们没有任何约束力，除非如说明：`arguments[i]`被使用`。

`.length`一个好的做法是首先使用所有函数上可用的方法来测试函数声明了多少原始参数。

`noname.length === 2 // in your case`

这样可以更轻松地保存任何其他参数（以防万一我们可能想要使用它们）

[**jsFiddle 演示**](http://jsfiddle.net/R9sg7/)

```
function noname (a, b) {
    console.log('Original parameters in this function: ' + noname.length);

    var additionalParameters = [];

    if (arguments.length > noname.length) {
        for (i = 0; i < arguments.length - noname.length; i++) {
            // We need to start arguments off at index: 2 in our case
            // The first 0 & 1 parameters are a, b

            additionalParameters[i] = arguments[i + noname.length];
            // These of course will be saved starting at 0 index on additionalParameters
        }
    }

    console.log(additionalParameters);
}

noname(1, 2, 3, 4, 5); 
```

​</p>

# android - 在 2 个活动之间传递位图

> ID：12217502
> 
> 赞同：0
> 
> 时间：2012-08-31T14:33:24.440
> 
> 标签：android, android-activity, bitmap, share

我一直在尝试解决这个问题 2 小时，但我还没有找到解决方案。

我的活动可以选择使用相机 API 拍照或浏览图库中的图像。我可以获取图像并将其显示在**相同的活动**中，但问题是我在其他活动中也需要它。

据我所知，最好的方法是将图像存储在 SD 卡中，但我已经尝试过这样做，但我只会遇到错误和错误。

你能帮我一把吗？

谢谢！

```
 public void onClick(View arg0) {

    // TODO Auto-generated method stub
    switch(arg0.getId()){

        case R.id.save:

            if (et.getText() !=null && thumbnail != null){

                 TableRow tr = new TableRow(this);
                 ImageView view = new ImageView(this);
                 TextView view2 = new TextView(this);
                 Button view3 = new Button(this);
                 view3.setOnClickListener(this);

                 view3.setId(i);

                 view.setImageBitmap(thumbnail);
                 view.setPadding(1, 5, 0, 0);
                 view.setScaleType(ImageView.ScaleType.CENTER_INSIDE);

                 Calendar c = Calendar.getInstance();
                 SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd");

                 titulo[i]=""+et.getText();
                 mensaje[i]=""+et1.getText();
                 fotos[i]=thumbnail;

                 view2.setText(titulo[i] +"                 "+ dateFormat.format(c.getTime()) );

                 view2.setGravity(Gravity.CENTER_VERTICAL);
                 view2.setPadding(5, 0, 0, 0);
                 i++;

                 view3.setGravity(Gravity.RIGHT);
                 view3.setGravity(Gravity.CENTER_VERTICAL);

                 DisplayMetrics metrics = new DisplayMetrics();
                 getWindowManager().getDefaultDisplay().getMetrics(metrics);

                 tr.addView(view, metrics.widthPixels/3, 150);
                 tr.addView(view2, metrics.widthPixels/2, 150);
                 tr.addView(view3, metrics.widthPixels/6, 20);
                 tl.addView (tr, 0);

                 final Toast toastMensaje = Toast.makeText(getApplicationContext(),
                            "Tu entrada se cargó correctamente", Toast.LENGTH_SHORT);
                    toastMensaje.setGravity(Gravity.CENTER, 0, 0);
                    toastMensaje.show();

                    et.setText("");
                    et1.setText("");
                    i1.setVisibility(View.GONE);

            }

            else{

                final Toast toastMensaje = Toast.makeText(getApplicationContext(),
                        "Tienes que añadir un título y una foto", Toast.LENGTH_LONG);
                toastMensaje.setGravity(Gravity.CENTER, 0, 0);
                toastMensaje.show();

            }

        break;

        case R.id.photo:

            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);  
            startActivityForResult(cameraIntent, CAMERA_PIC_REQUEST);

        break;

        case R.id.gallery:

            Intent intent = new Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
             startActivityForResult(intent, TFRequestCodes);

        break;

        default:

            Intent openActivity = new Intent(Second.this, Recuerdos.class);
            openActivity.putExtra("titulo", titulo[arg0.getId()]);
            openActivity.putExtra("mensaje", mensaje[arg0.getId()]);
            openActivity.putExtra("URI", selectedImage);

            startActivity(openActivity);

        break;

    }

}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
    if (requestCode == CAMERA_PIC_REQUEST && resultCode == RESULT_OK) {  
        // do something  

        thumbnail = (Bitmap) data.getExtras().get("data");
        i1.setImageBitmap(thumbnail);

    }  

    else if (requestCode == TFRequestCodes && resultCode == RESULT_OK) {  
        // do something

        selectedImage = data.getData();
        String[] filePathColumn = {MediaStore.Images.Media.DATA};

        Cursor cursor = getContentResolver().query(selectedImage, filePathColumn, null, null, null);
        cursor.moveToFirst();

        int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
        String filePath = cursor.getString(columnIndex);
        cursor.close();

        thumbnail = BitmapFactory.decodeFile(filePath);
        i1.setImageBitmap(thumbnail);

    }  

}  

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:38:32.230

您宁愿传递图像 URI 而不是图像数据。

在该`onActivityResult()`方法中，您可以获取图像 URI：

```
Uri imageUri = data.getData(); 
```

然后，您可以在启动时将此 uri 传递给其他活动：

```
 Intent intent = new Intent(context, MyNextActivity.class);
    intent.setData(imageUri);
    startActivity(intent); 
```

在下一个活动中，您可以检索此 URI：

```
Uri imageUri = getIntent().getData(); 
```

然后在 ImageView 中显示图像：

```
imageView.setImageURI(imageUri); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:37:33.183

试试这个代码，

在您的 FirstActivity 中，

```
 Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.icon);

        Intent intent = new Intent();
        intent.setClass(AndroidPassingBitmap.this, AndroidReceiveBitmap.class);
        intent.putExtra("Bitmap", bitmap);
        startActivity(intent); 
```

在 SecondActivity 中，

```
Bitmap bitmap = (Bitmap)this.getIntent().getParcelableExtra("Bitmap");
  ImageView viewBitmap = (ImageView)findViewById(R.id.bitmapview);

  viewBitmap.setImageBitmap(bitmap); 
```

# c++ - 用前瞻解决模糊的 boost::spirit::qi 语法

> ID：12217515
> 
> 赞同：3
> 
> 时间：2012-08-31T14:34:01.580
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi

我想要一个名称-值对列表。每个列表都以“.”结尾。和停产。每个名称-值对由“:”分隔。每对都用';'分隔 在列表中。例如

```
NAME1: VALUE1; NAME2: VALUE2; NAME3: VALUE3.<EOL> 
```

我遇到的问题是这些值包含“。” 最后一个值总是消耗“。” 在 EOL。我可以使用某种前瞻来确保最后一个'。在 EOL 被区别对待之前？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T12:11:37.633

我创建了一个样本，大概看起来像你所拥有的。调整在以下行中：

```
value = lexeme [ *(char_ - ';' - ("." >> (eol|eoi))) ]; 
```

请注意如何`- ("." >> (eol|eoi)))`表示：排除任何`.`紧随其后的 *end-of-line*或*end-of-input*。

测试用例（也位于[http://liveworkspace.org/code/949b1d711772828606ddc507acf4fb4b](http://liveworkspace.org/code/949b1d711772828606ddc507acf4fb4b)上）：

```
const std::string input = 
    "name1: value 1; other name : value #2.\n" 
    "name.sub1: value.with.periods; other.sub2: \"more fun!\"....\n";
bool ok = doParse(input, qi::blank); 
```

输出：

```
parse success
data: name1 : value 1 ; other name  : value #2 . 
data: name.sub1 : value.with.periods ; other.sub2 : "more fun!"... . 
```

完整代码：

```
#include <boost/fusion/adapted.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/karma.hpp>
#include <map>
#include <vector>

namespace qi    = boost::spirit::qi;
namespace karma = boost::spirit::karma;
namespace phx   = boost::phoenix;

typedef std::map<std::string, std::string> map_t;
typedef std::vector<map_t> maps_t;

template <typename It, typename Skipper = qi::space_type>
    struct parser : qi::grammar<It, maps_t(), Skipper>
{
    parser() : parser::base_type(start)
    {
        using namespace qi;

        name  = lexeme [ +~char_(':') ];
        value = lexeme [ *(char_ - ';' - ('.' >> (eol|eoi))) ];
        line  = ((name >> ':' >> value) % ';') >> '.';
        start = line % eol;
    }

  private:
    qi::rule<It, std::string(), Skipper> name, value;
    qi::rule<It, map_t(), Skipper> line;
    qi::rule<It, maps_t(), Skipper> start;
};

template <typename C, typename Skipper>
    bool doParse(const C& input, const Skipper& skipper)
{
    auto f(std::begin(input)), l(std::end(input));

    parser<decltype(f), Skipper> p;
    maps_t data;

    try
    {
        bool ok = qi::phrase_parse(f,l,p,skipper,data);
        if (ok)   
        {
            std::cout << "parse success\n";
            for (auto& line : data)
                std::cout << "data: " << karma::format_delimited((karma::string << ':' << karma::string) % ';' << '.', ' ', line) << '\n';
        }
        else    std::cerr << "parse failed: '" << std::string(f,l) << "'\n";

        //if (f!=l) std::cerr << "trailing unparsed: '" << std::string(f,l) << "'\n";
        return ok;
    } catch(const qi::expectation_failure<decltype(f)>& e)
    {
        std::string frag(e.first, e.last);
        std::cerr << e.what() << "'" << frag << "'\n";
    }

    return false;
}

int main()
{
    const std::string input = 
        "name1: value 1; other name : value #2.\n" 
        "name.sub1: value.with.periods; other.sub2: \"more fun!\"....\n";
    bool ok = doParse(input, qi::blank);

    return ok? 0 : 255;
} 
```

# c# - 在哪种情况下应该选择 Silverlight 或 ASP.NET MVC

> ID：12217516
> 
> 赞同：0
> 
> 时间：2012-08-31T14:34:10.583
> 
> 标签：c#, web-applications

微软提供了两种工具，我猜它们被认为可以解决特定问题。所以我的问题是：让我选择一种或另一种技术的关键点是什么？

作为一个子问题，当你对 C# 和桌面应用程序有很好的了解但没有 web 应用程序的经验时，ASP.Net MVC 的学习曲线是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:35:28.330

如果您希望您的应用程序可以在任何平台上运行，请选择 MVC。Silverlight 仅适用于支持它的平台。所以这意味着没有手机。我不了解你，但这会让我担心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T15:02:57.913

它们都是很棒的平台，我都使用它们，包括 WPF。然而，Silverlight 未来可能不会获得大量社区/Microsoft 支持。所以你需要在你的决策过程中考虑到这一点。另一方面，MVC 得到了开发社区和微软的大力支持。另外，根据我的经验，找到 MVC 人才比 Silverlight 更容易。

由于您没有或几乎没有 Web 经验，因此 MVC 的学习曲线可能有点困难。如果您的桌面体验是 winforms，那么由于 XAML 学习曲线，转换到 Silverlight 也将很困难。此外，如果这对您很重要，Silverlight 路由可能有助于过渡到 Metro XAML/C# 堆栈。

如果我站在你的立场上并且必须在两者之间做出决定，我会选择 MVC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:38:06.230

在MVC方面，学习资源非常好。我将从[教程](http://www.asp.net/mvc/tutorials)开始。这些将帮助您了解 Microsoft 的 MVC 实现，尽管在网站开发（HTML、CSS、JavaScript）本身方面不太有用。

但是，由于您的应用程序只能在内部在 IE9 上使用，并且您有 XAML 经验，所以我会选择 Silverlight。

# c# - 正则表达式替换转义字符c#

> ID：12217519
> 
> 赞同：-1
> 
> 时间：2012-08-31T14:34:13.220
> 
> 标签：c#, regex

**这是html：**

```
<font color="#000fff" size="1" face="Arial">Genuine Windows® 7 Home Premium (64-bit)</font> 
```

**这就是我想要转换的：**

```
[color="#000fff"]Genuine Windows® 7 Home Premium (64-bit)[/color] 
```

**这是我尝试过的：**

```
var post = Regex.Replace(post, "<font color=\"([a-fA-F0-9\\#]+)\">(.*?)</font>",
                                 m => "[color=\"" + m.Groups[1].Value + "\"]" + m.Groups[2].Value + "[/color]"); 
```

它不匹配。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T14:36:07.290

不，因为你没有满足`size="1" face="Arial"`. 尝试这个：

```
"<font color=\"([a-fA-F0-9\\#]+)\"[^>]*>(.*?)</font>" 
```

（注意添加`[^>]*`以捕获开始字体标签中的所有其他内容）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:44:59.833

您的解决方法是：

```
using System;
using System.Text.RegularExpressions;

public class Test
{
  public static void Main()
  {
    string post = "<font color=\"#000fff\" size=\"1\" face=\"Arial\">Genuine Windows® 7 Home Premium (64-bit)</font>";
    post = Regex.Replace(post, "<font color=\"([a-fA-F0-9\\#]+)\"[^>]*>(.*?)</font>", 
      m => "[color=\"" + m.Groups[1].Value + "\"]" + m.Groups[2].Value + "[/color]");
    Console.WriteLine(post);
  }
} 
```

[在此处](http://ideone.com/mm9E3)测试此代码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-31T14:50:51.063

**更新：**修复了性能瓶颈。看到它[**在行动**](http://regexr.com?320s0)。

**寻找：**

```
<font.*?color="([^"]*)"[^>]*>([^<]*)</font> 
```

***注意：*** *这假设颜色属性肯定存在。*

**代替：**

```
[color=$1]$2[/color] 
```

# c - 将几个依赖库链接到我的“裸机”C 应用程序中

> ID：12217526
> 
> 赞同：2
> 
> 时间：2012-08-31T14:34:45.043
> 
> 标签：c, gcc, embedded, arm, static-libraries

我正在 ST ARM-Cortex-M3 上开发裸机 C 应用程序。我还开发了可用于所有这些应用程序的库。

我曾经使用 Keil ARM-MDK，但想改用 GNU-GCC。因此，我下载了最新版本的 GCC 并开始重新编译代码。

尽管已经回答了与此类似的问题，但它并没有解决我的问题，因此我发布了我的问题。

我有以下问题：Lib_Flash 有一个函数 Read_Flash()。Lib_AppCfg 在 Lib_Flash 中链接，因为它使用 Read_Flash()。我的应用程序（App）链接在 Lib_Flash 和 Lib_AppCfg 中。应用程序还使用 Read_Flash() 进行一些特定的 FLASH 检查。在 Keil MDK-ARM 中它运行良好。使用 GCC，在构建使用 Lib_AppCfg 的函数时，我收到错误消息，指出 Read_Flash() 是“未定义的引用”。我不确定问题出在哪里。是在构建 Lib_Appcfg 的链接中还是在我链接 App 时出现问题？

请指教。如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:40:28.583

在我看来，您的库中存在排序问题。一些链接器将重新扫描命令行上的所有库，直到所有引用都被解析（或无法解析）。其他链接器沿链接线顺序工作。

特别是，这意味着如果库 A 定义了一个符号 SYM_A 和库 B 之后库 A 引用了这个符号，它不会在第二种类型的链接器上解析，并且您的链接将失败。

要解决此问题，您可以执行以下一项或多项操作

1.  重新排序库
2.  必要时在链接线上复制库
3.  重构您的库，使它们之间不存在相互依赖关系（即 A 引用符号 SYMB，它在 B 中定义，但 B 引用 SYMA）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T20:16:18.200

默认情况下，GNU 链接器按命令行上列出的顺序搜索库一次。因此，如果列表中后面的库引用了早期库或目标文件中定义的符号，则无法解析。

简单的解决方案是使用库分组；这会导致链接器重复搜索库列表，直到无法解析更多的 synbols。如果您单独调用链接器 (ld)，则链接器选项为：

```
--start-group _Flash _AppCfg --end-group 
```

或替代形式

```
-( _Flash _AppCfg -) 
```

有关详细信息，请参阅[GNU 链接器手册](http://sourceware.org/binutils/docs-2.22/ld/Options.html#Options)。如果通过 gcc 间接驱动链接器，则通过[-Wl 选项](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)传递链接器选项，例如：

```
-Wl,-(,_Flash,_AppCfg,-) 
```

我认为。

# c++ - strncat & strncpy 帮助 c++

> ID：12217528
> 
> 赞同：2
> 
> 时间：2012-08-31T14:34:47.620
> 
> 标签：c++, buffer, cstring

所以我的任务是：

> 使用`strncpy`和中的`strncat`函数`#include<cstring>`，实现一个函数
> 
> ```
> void concat(const char a[ ], const char b[ ], char result[ ],
>                  int result_maxlength) 
> ```
> 
> 将字符串`a`和`b`缓冲区连接起来`result`。确保不要超出结果。它可以容纳`result_maxlength`字符，不包括`\0`终止符。（也就是说，缓冲区有 `buffer_maxlength + 1`可用的字节。）一定要提供一个 '\0' 终止符。

我的解决方案（到目前为止）如下，但我不知道我做错了什么。当我实际运行程序时，我不仅会收到运行时检查失败 2 错误，而且我不确定应该在哪里添加`\0`终止​​符，或者即使我应该使用`strncat`而不是`strncpy`. 希望有人能引导我朝着正确的方向前进。是的，这就是硬件。这就是为什么我说只要引导我朝着正确的方向前进，这样我就可以尝试弄清楚：p

```
#include <iostream>
#include <cstring>
using namespace std;

void concat(const char a[ ], const char b[ ], char result[ ], int result_maxlength);

int main()
{
    char a[] = "Woozle";
    char b[] = "Heffalump";
    char c[5];
    char d[10];
    char e[20];

    concat(a, b, c, 5);
    concat(a, b, d, 10);
    concat(a, b, e, 20);
    cout << c << "\n";
    cout << d << "\n";
    cout << e << "\n";

    return 0;
}

void concat(const char a[ ], const char b[ ], char result[ ], int result_maxlength)
{    
    strncat(result, a, result_maxlength);
    strncat(result, b, result_maxlength);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:38:04.930

至少你`result`在第一个之前是未初始化`strncat`的`concat`。

*编辑*：是的，正如 Michael Burr 指出的那样，你的结果大小应该随着你的进步而改变，并从一开始就计算出来。实际上，您选择的名称具有误导性，因为它是源的最大大小，而不是目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:38:38.350

The last argument to `strncat()` represents the *remaining* space available in the buffer - not the full size of the buffer.

Also note that that argument includes the spot that the terminating null character will need, so you'll need to account for that since the spec for `concat()` is otherwise.

Finally, according to the `concat()` spec, the result placed in the buffer should not be concatenated to the existing contents of the buffer (those contents should be replaced). Also, make sure you test that your function properly handles a zero length `result_maxlength` argument being passed in.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:47:27.417

1.  strncpy from a to result (whatever is smaller, lenght of a or result_maxlength)
2.  strncat from b to **remaining** of result (whatever is smaller, lenght of b or result_maxlength- lenght of a)

3.  before every return just put a \0 at last position `result[result_maxlength-1] ='\0';`

It's actually not specified WHAT to do if result is too short, should you add trailing 0 or not. I guess you'd better terminate that string.

tip : remaining of result is `result+strlen(a)`

# android - 显示 AlertDialog 框时出现“WindowManager$BadTokenException”？

> ID：12217530
> 
> 赞同：0
> 
> 时间：2012-08-31T14:34:56.600
> 
> 标签：android, android-alertdialog, broadcast

我正在尝试在我的应用程序中使用 BroadcastReceiver 获取互联网连接状态。如果没有可用的互联网，我想显示一个警报对话框。

这是我的广播接收器：

```
 public class ConnectivityChangedReceiver extends BroadcastReceiver{

  @Override
  public void onReceive( Context context, Intent intent )
  {
    ConnectivityManager connectivityManager = (ConnectivityManager) context.getSystemService( Context.CONNECTIVITY_SERVICE );
    NetworkInfo networkInfo = connectivityManager.getActiveNetworkInfo();
    if (networkInfo != null && networkInfo.isConnected()) {
    } else {
        showInternetAlertDialog(context);
    }
  }

  public void showInternetAlertDialog(Context context){
        AlertDialog.Builder builder = new AlertDialog.Builder(context);
        builder.setMessage("You have no internet connection.")
                    .setPositiveButton("Retry", new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                                dialog.dismiss();
                            }
                        }
                    });
        builder.show();
        return;
    }    
 } 
```

我也在清单中定义了这个接收器。我已经在清单中定义了访问网络状态的权限。

```
 <receiver android:name="com.lisnx.service.ConnectivityChangedReceiver"
        android:label="NetworkConnection">
        <intent-filter>
            <action android:name="android.net.conn.CONNECTIVITY_CHANGE"/>
        </intent-filter>
    </receiver> 
```

但是当互联网消失并且 AlertDialog 框尝试打开时，我得到以下异常：

```
 10-19 16:25:21.474 E/AndroidRuntime( 6864): android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application

  10-19 16:25:21.474 E/AndroidRuntime( 6864):     at android.view.ViewRoot.setView(ViewRoot.java:509)

  10-19 16:25:21.474 E/AndroidRuntime( 6864):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)

  10-19 16:25:21.474 E/AndroidRuntime( 6864):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)

  10-19 16:25:21.474 E/AndroidRuntime( 6864):     at android.app.Dialog.show(Dialog.java:241) 
```

我认为这是一个上下文问题，但我无法找出究竟是什么问题。请帮助我。任何解决方案将不胜感激。提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:02:17.193

这是不可能`AlertDialog`从`BroadCast Receiver.`

您必须从广播接收器开始一些活动，并且在该活动中您必须显示 AlertDialog。

您可以将对话框主题设置为活动，也可以为该活动提供透明布局。

**编辑 ：**

确保您使用`FLAG_ACTIVITY_NEW_TASK`意图标志开始新活动。

# java - 创建没有参数命名空间的 SOAP Web 服务

> ID：12217531
> 
> 赞同：2
> 
> 时间：2012-08-31T14:34:58.493
> 
> 标签：java, soap, jax-ws

首先这是我想要做的：我想创建一个 web 服务，`void doSomething(ParamType value);`它在接收到 SOAP 消息时调用一个 java 函数

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
    <soapenv:Header/>
    <soapenv:Body>
        <paramType>
            <elem>test</elem>
        </paramType>
    </soapenv:Body>
</soapenv:Envelope> 
```

请注意 paramType 缺少的命名空间。

我创建了以下类来包含 doSomething 函数：

```
@WebService(name = "doSomethingPort", targetNamespace = "http://www.tim.org/nsClass/")
@SOAPBinding(parameterStyle = SOAPBinding.ParameterStyle.BARE)
public class DoSomethingImpl {

    @WebMethod(action = "http://sap.com/xi/WebService/soap1.1")
    @Oneway
    public void doSomething(
            @WebParam(name = "paramType", targetNamespace = "http://www.tim.org/nsParam/", partName = "value") 
            ParamType value) 
    {
        System.out.println("Hallo Welt");
    }
} 
```

和下面的类来保存参数：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "", namespace="http://www.tim.org/nsXMLType/")
@XmlRootElement(name="paramType", namespace="http://www.tim.org/nsXMLRootElem/")
public class ParamType {

    @XmlElement(required = true)
    protected String elem;

    public String getElem() {
        return elem;
    }

    public void setElem(String value) {
        this.elem = value;
    }
} 
```

网络服务开始于：

```
Endpoint.publish( "http://localhost:8090/services", new DoSomethingImpl()); 
```

一些测试后的结果是：这个 web 服务接受 paramType 有命名空间的消息：`<nsp:paramType xmlns:nsp="http://www.tim.org/nsParam/">`

当我在参数上留下 targetNamepace 声明时，他使用 DoSomethingImpl 类上的 targetNamespace ( `http://www.tim.org/nsClass/`)

删除那里的命名空间会导致 web 服务从他的包名创建一个命名空间。

有人知道我如何让网络服务接受该消息吗？我更愿意修复/重新配置我现有的 web 服务，但我会接受其他方式来接受消息并调用 doSomething 函数。

# java - 通过我的 java 代码导出数据库

> ID：12217532
> 
> 赞同：4
> 
> 时间：2012-08-31T14:34:58.430
> 
> 标签：java, mysql, mysqldump

我想使用我的 java 代码导出我的 MySQL 数据库。但我还没有找到任何办法。我想要做的是在我的应用程序中有一个按钮作为“导出数据库”。单击该按钮时，我的数据库应导出到指定路径。我使用了以下代码，但它不起作用：

```
 Runtime runtime = Runtime.getRuntime();
 runtime.exec("C:\\Program Files\\MySql\\MySql Server 5.5\\bin\\mysqldump -u root -p myDatabase> D:\\backup.sql"); 
```

我该怎么做这个任务。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T15:17:19.787

备份：

```
/******************************************************/
//Database Properties
/******************************************************/
String dbName = “dbName”;
String dbUser = “dbUser”;
String dbPass = “dbPass”;

/***********************************************************/
// Execute Shell Command
/***********************************************************/
String executeCmd = “”;
executeCmd = “mysqldump -u “+dbUser+” -p”+dbPass+” “+dbName+” -r backup.sql”;
}
Process runtimeProcess =Runtime.getRuntime().exec(executeCmd);
int processComplete = runtimeProcess.waitFor();
if(processComplete == 0){

out.println(“Backup taken successfully”);

} else {

out.println(“Could not take mysql backup”);

} 
```

恢复：

```
/******************************************************/
//Database Properties
/******************************************************/
String dbName = “dbName”;
String dbUser = “dbUser”;
String dbPass = “dbPass”;

/***********************************************************/
// Execute Shell Command
/***********************************************************/
String executeCmd = “”;

executeCmd = new String[]{“/bin/sh”, “-c”, “mysql -u” + dbUser+ ” -p”+dbPass+” ” + dbName+ ” < backup.sql” };

}
Process runtimeProcess =Runtime.getRuntime().exec(executeCmd);
int processComplete = runtimeProcess.waitFor();
if(processComplete == 0){

out.println(“success”);

} else {

out.println(“restore failure”);

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-31T14:39:40.533

两个问题：

*   -p 和密码之间的空格
*   可执行文件路径内的空间

喜欢这个：

```
 runtime.exec(new String[]{"C:\\Program Files\\MySql\\MySql Server 5.5\\bin\\mysqldump", "-u", "root", "-pmyDatabase" "> D:\\backup.sql"}); 
```

请注意，如果您对 runtime.exec 有疑问，您应该查看可以从返回的[Process](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Process.html)获得的流。发生错误时不查看这些流有点像抛出异常时不查看异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T06:57:02.093

你可以试试这个。

```
 public void actionPerformed(ActionEvent evt)
    {
    private String m_MySqlPath=""; 
    ResultSet res=null;
    res = DBHandler.getInstance().executeQuery("select @@basedir",null);

          while(res.next())
          {
              m_MySqlPath=res.getString(1) ;
          }

          m_MySqlPath = m_MySqlPath.replace("\\Data\\", "\\bin\\");

    if (exportDB.isSelected()
    {    
    try {

          String executeCmd = m_MySqlPath + "\\mysqldump -u " + DB_USER
          +" -p" + DB_PASSWORD + " " + DB_NAME + " -r " + "\""+FilePath + "\\"
          + FileName+"\"";

        Process runtimeProcess = Runtime.getRuntime().exec(executeCmd, null);

        BufferedReader r=new BufferedReader(new InputStreamReader(runtimeProcess.getInputStream()));
        String s;
        while((s=r.readLine())!=null)
        {
            System.out.println(s);
        }

        return true;

    }
    catch (final Exception ex) {
        ex.printstackTrace();
        return false;
    }
} 
```

# c# - 动态调整自定义 ComboBox C# 的 DropDownHeight

> ID：12217533
> 
> 赞同：1
> 
> 时间：2012-08-31T14:35:08.367
> 
> 标签：c#, .net-4.0, combobox, treeview

我有一个自定义 ComboBox，里面有一个 TreeView（从[这里](http://blogs.msdn.com/b/jfoscoding/archive/2005/03/03/384430.aspx)的代码修改），并且在让 DropDownHeight 正确显示所有内容时遇到问题。我不仅无法获得正确的初始 DropDownHeight（尝试设置为 treeview.height），而且我还希望它在打开树时调整大小以显示没有滚动条的所有内容。这可能吗？如果您需要更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:56:45.577

您提供的链接中的这段代码应该可以工作：

```
private void ShowDropDown() 
{
   if (dropDown != null)
   {
      treeViewHost.Width = DropDownWidth;
      treeViewHost.Height = DropDownHeight;
      dropDown.Show(this, 0, this.Height);
   }
} 
```

ComboBox 会根据其呈现的内容自动调整自身大小。

# python - 我可以在 AssertionError 上强制调试 python 吗？

> ID：12217537
> 
> 赞同：13
> 
> 时间：2012-08-31T14:35:24.370
> 
> 标签：python, python-3.x, assert, pdb

假设我有一个 python 程序，其中 assert 已用于定义事情应该如何，并且我想用 read-eval-loop 捕获异常而不是`AssertionError`被抛出。

当然，我本来可以

```
if (reality!=expectation):
    print("assertion failed");
    import pdb; pdb.set_trace(); 
```

但这在代码中比普通的`assert(reality==expectation)`.

我本可以在顶层`pdb.set_trace()`调用一个块，但是我会丢失所有失败的上下文，对吗？`except:`（我的意思是，可以从异常对象中恢复堆栈跟踪，但不能从参数值等中恢复）

有没有类似`--magic`命令行标志的东西可以将 python3 解释器变成我需要的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-31T14:45:00.517

主要取自[这个伟大的片段](http://code.activestate.com/recipes/65287-automatically-start-the-debugger-on-an-exception/)：

```
import sys

def info(type, value, tb):
    if hasattr(sys, 'ps1') or not sys.stderr.isatty() or type != AssertionError:
        # we are in interactive mode or we don't have a tty-like
        # device, so we call the default hook
        sys.__excepthook__(type, value, tb)
    else:
        import traceback, pdb
        # we are NOT in interactive mode, print the exception...
        traceback.print_exception(type, value, tb)
        print
        # ...then start the debugger in post-mortem mode.
        pdb.pm()

sys.excepthook = info 
```

当你用这个初始化你的代码时，所有`AssertionError`的 s 都应该调用 pdb。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-31T14:44:52.123

看看[鼻子](http://nose.readthedocs.org)项目。您可以将它与[--pdb 选项](http://nose.readthedocs.org/en/latest/usage.html#cmdoption--pdb)一起使用，以便在出现错误时进入调试器。

# c# - 我真的需要在 Win-RT 应用程序中使用 SuspsensionManager

> ID：12217554
> 
> 赞同：1
> 
> 时间：2012-08-31T14:36:14.073
> 
> 标签：c#, .net, windows-8, windows-runtime

我的 ViewModel 会根据需要自行加载其状态，并在发生变化时保存其部分状态。

Windows RT 应用程序有一个叫做 SuspsensionManager 的东西。这似乎仅在挂起和激活的事件上加载和保存状态。我个人更喜欢我的模型，它易于理解，并且仅按需在我的视图模型上保存和加载单个属性。

那么我真的需要 SuspsensionManager 吗？它似乎在用 Frame 做一些事情，我无法完全理解。是否可以完全删除 SessionManager？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:46:39.303

如果您在谈论 SuspsensionManager 类，不，您不必使用它。它是 Visual Studio 项目模板提供的便利类，由 LayoutAwarePage 基类使用，该基类又被各种页面模板使用，如“基本页面”、“拆分页面”、“项目页面”、“项目详细信息页面” ”、“分组项目页面”和“组详细信息页面”。

LayoutAwarePage 添加了对导航和生命周期事件的保存状态（使用 SuspensionManager）的支持，以及对 Snapped 和 Filled 视觉状态的支持，甚至是基本的 ViewModel 实现。

在向应用添加新页面时，您可以选择使用“空白页面”模板。然后，您可以随意实现自己的会话状态、视觉状态、MVVM 等。

# ruby-on-rails - Rails，建模公司/员工关系

> ID：12217555
> 
> 赞同：1
> 
> 时间：2012-08-31T14:36:17.820
> 
> 标签：ruby-on-rails

我一直在考虑这个问题，虽然它看起来很简单，但我似乎无法真正“正确”地理解它。我有，基本上，是两个类，公司和员工。它被设置为一个公司有_许多员工，并且员工属于一个公司。我也使用 STI，所以我有公司 < 用户和员工 < 用户。这一切都已经足够好了。现在，员工只能做两件事：查看自己的个人资料并进行更新。另一方面，公司可以创造员工。在应用程序中，这是创建员工的唯一方法。我的问题是我想让它尽可能简单，同时考虑我可能会在某个时候制作一个 API。所以我的问题是什么被认为是好的做法？我应该让员工成为公司下的嵌套资源吗？我应该在公司命名空间下创建员工资源吗？我是否应该将所有操作保留在 employees_controller 中，然后使用权限允许公司访问它们？似乎我尝试的一切最终都感觉“不对劲”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:04:24.890

根据您的要求，似乎有两种类型的用户：普通用户（不是员工）和员工。Rails 模型之间有一个`belongs_to`和`has_many`关系。因此，对于公司，您可以这样做：

```
class Company < ActiveRecord::Base
   has_many :users, :dependent => :destroy

class User < ActiveRecord::Base
   attr_accessible :is_employee
   belongs_to : company 
```

在`User`模型中，有一个`is_employee`存储布尔值的列名。这样，您可以同时拥有雇员和非雇员。在 中`Company`，如果`Company`被破坏，它`Users`就会消失。

关于这些关系的更多文档可以在这里找到：http: [//api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

# java - 如何在运行时从 Jasper Report 中抛出异常（使用 iReport for IDE） - XML 数据源上的数据验证

> ID：12217556
> 
> 赞同：3
> 
> 时间：2012-08-31T14:36:17.477
> 
> 标签：java, exception, jasper-reports, ireport, validation

对于基于`XML`数据源的报告....

如果传入了错误数据，最好使用诸如`variableXYZ`is之类的信息性消息使报告失败，`0`而不是在运行时出现除以零错误。

或者，`variableXYZ`必须指定而不是 a`NPE`或默认值。在某些情况下，没有不会误导的良好默认值。

有没有办法验证来自`XML`数据源的数据并抛出异常或以某种方式通知用户传入的数据无效？

我用 else 部分尝试了三元运算符，例如：

```
throw new RuntimeException("VariableXYZ is invalid: 0") 
```

但是在评估表达式时它会死掉。

> 263：意外令牌：throw @ 第 263 行，第 49 列。

最后，我想在没有脚本的情况下执行此操作，就像 stock 的一部分一样`iReport`。这可能吗？是否有其他好的方法来验证导致正确错误消息的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-18T10:00:47.250

我不相信这是可能的。

JasperReports 环境中使用的表达式实际上是“Java 表达式”（至少当您使用 Java 作为报表语言时）。根据[Java教程](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/expressions.html)：

> 表达式是由变量、运算符和方法调用组成的构造，这些构造根据语言的语法构造，计算结果为单个值。

所以基本上，你不能将`throw`结构评估为一个值。你不能写`myVar = throw RuntimeException("...");`。

但同时您可以在表达式中调用方法，因此也许您可以在类路径中添加一个引发错误的方法，例如。

# postgresql - 在不创建临时表的情况下加入数组 unnest 的输出

> ID：12217557
> 
> 赞同：4
> 
> 时间：2012-08-31T14:36:21.760
> 
> 标签：postgresql, postgresql-9.1, plpgsql, unnest, set-returning-functions

我在 UDF 中有一个查询（如下所示），它`unnest()`是一个整数数组并连接它，我在我的 pgplsql UDF 中创建了一个本地临时表，因为我知道这是有效的。是否可以`unnest`直接在查询中使用来执行连接，而不必创建临时表？

```
CREATE OR REPLACE FUNCTION search_posts(
    forum_id_ INTEGER,
    query_    CHARACTER VARYING,
    offset_ INTEGER DEFAULT NULL,
    limit_ INTEGER DEFAULT NULL,
    from_date_ TIMESTAMP WITHOUT TIME ZONE DEFAULT NULL,
    to_date_ TIMESTAMP WITHOUT TIME ZONE DEFAULT NULL,
    in_categories_ INTEGER[] DEFAULT '{}'
    )
RETURNS SETOF forum_posts AS $$
DECLARE
    join_string CHARACTER VARYING := ' ';
    from_where_date CHARACTER VARYING := ' ';
    to_where_date CHARACTER VARYING := ' ';
    query_string_ CHARACTER VARYING := ' ';
    offset_str_ CHARACTER VARYING := ' ';
    limit_str_ CHARACTER VARYING := ' ';
BEGIN
    IF NOT from_date_ IS NULL THEN
        from_where_date := ' AND fp.posted_at > ''' || from_date_ || '''';
    END IF;

    IF NOT to_date_ IS NULL THEN
        to_where_date := ' AND fp.posted_at < ''' || to_date_ || '''';
    END IF;

    IF NOT offset_ IS NULL THEN
        offset_str_ := ' OFFSET ' || offset_; 
    END IF;

    IF NOT limit_ IS NULL THEN
        limit_str_ := ' LIMIT ' || limit_;
    END IF;

    IF NOT limit_ IS NULL THEN
    END IF;

    CREATE LOCAL TEMP TABLE un_cat(id) ON COMMIT DROP AS (select * from unnest(in_categories_)) ;

    if in_categories_ != '{}' THEN
        join_string := ' INNER JOIN un_cat uc ON uc.id = fp.category_id ' ;
    END IF;
s
    query_string_ := '
    SELECT fp.*
    FROM forum_posts fp' ||
        join_string
    ||
    'WHERE fp.forum_id = ' || forum_id_ || ' AND
    to_tsvector(''english'',fp.post_text) @@ to_tsquery(''english'','''|| query_||''')' || 
        from_where_date || 
        to_where_date ||
        offset_str_ ||
        limit_str_ 
    ||  ';';

    RAISE NOTICE '%', query_string_;

    RETURN QUERY
    EXECUTE query_string_;
END;
$$ LANGUAGE plpgsql;

select * from search_posts(forum_id_:=1, query_:='scout & rampage', in_categories_ := '{71}'); 
```

我想这样做的原因是[我希望能够查看查询计划，而不必求助于查看服务器日志中的自动解释输出](https://dba.stackexchange.com/questions/23355/postgres-query-plan-of-a-udf-invocation-written-in-pgpsql)。本地临时表可以防止这种情况。即，我无法复制粘贴结果查询并逐字执行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T15:40:07.237

> 是否可以`unnest()`直接在查询中使用来执行连接，而不必创建临时表？

是的，而且效率更高：

```
SELECT *
FROM   tbl t
JOIN   unnest('{10,11,12}'::int[]) AS x(tbl_id) USING (tbl_id); 
```

# css - Spring Security UI 将所有内容移到顶部

> ID：12217560
> 
> 赞同：0
> 
> 时间：2012-08-31T14:36:30.250
> 
> 标签：css, grails, spring-security

我正在使用 Spring 安全 UI，每次添加

```
<r:require module="register"/>
<r:layoutResources/> 
```

（这应该为 Spring Security UI 添加样式）

在我的 auth 文件的头上，它将我的页面从很好地居中移到左上角

有任何想法吗？

我知道它与 reset.css 文件有关，但每次我更改它时，它也会更改登录字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:30:11.747

我不喜欢这种居中页面的方式，但在插件的 reset.css 文件中将此代码添加到底部。

```
html {
margin: 0 auto;
width: 1024px;
} 
```

# javascript - div 单击调整 iframe 或底层 div 的大小？

> ID：12217561
> 
> 赞同：0
> 
> 时间：2012-08-31T14:36:32.377
> 
> 标签：javascript, html, iframe, click

我没有得到对 div 点击的响应只需要知道我在做什么错 [http://jsfiddle.net/7nF2t/​​76/](http://jsfiddle.net/7nF2t/76/) 谢谢

```
<div id="click"><br></div>

$('#click').click(function(){
  alert('yes');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:39:11.550

在添加活动之前，您需要确保文档准备就绪，例如：

```
 $(document).ready(function() {
   $('#click').click(function() { alert('yes'); }
 }); 
```

该死的，没看到jsfiddle。xdazz 是对的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:39:08.510

您`.onclick`在 jsfiddle中使用，请`.click`改用。

*[演示。](http://jsfiddle.net/7nF2t/82/)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:49:46.283

首先，如果这是 jQuery，你必须使用`.click`许多人所说的。并且#alpha 不是一个类，它是一个 ID，我在这里更改了你的 CSS、脚本和 HTML：http: [//jsfiddle.net/7nF2t/​​89 /](http://jsfiddle.net/7nF2t/89/)

```
<div id="alpha" class="alpha">
    <iframe id="iframe" src="http://time.is"></iframe>
</div>
<div id="click"><br></div>​

<script>
$(document).ready(function() {
    $('#click').click(function(){
      alert('yes');
      $('#alpha').removeClass('alpha').addClass('alphas');
     });
});
</script>​

#click {
    z-index:2;
    margin-top:-200px;
    height:200px;
    width:200px;
    background-color:#888;
    opacity:0.48;
    filter:alpha(opacity=48);
}
.alpha {
  -webkit-transition: all 0.3s ease-out; 
     -moz-transition: all 0.3s ease-out; 
       -o-transition: all 0.3s ease-out; 
          transition: all 0.3s ease-out; 

    -moz-transform:scale(0.25);
    -moz-transform-origin:0 0;
    -o-transform:scale(0.25);
    -o-transform-origin:0 0;
    -webkit-transform:scale(0.25);
    -webkit-transform-origin:0 0 
}

.alphas {
    opacity:0.38;
    filter:alpha(opacity=38);

    -webkit-transform: scale(1.5);
       -moz-transform: scale(1.5);
        -ms-transform: scale(1.5);
         -o-transform: scale(1.5);
            transform: scale(1.5);
}

​ 
```

# proxy - 如果在代理后面，检票模式窗口为空

> ID：12217566
> 
> 赞同：0
> 
> 时间：2012-08-31T14:36:57.433
> 
> 标签：proxy, wicket

嗨，你们这些天才！

从代理后面使用网站时，是否有人遇到过模态窗口内容的问题？遗憾的是，我无法提供有关代理配置的任何详细信息。（这是一家外国公司的代理。）

我可以告诉你，它是一个 Squid 代理，并且在 Wicket 的 ajax 调试窗口或服务器日志中没有明确的错误。代理管理员还说日志中没有任何内容。Wicket 实际上返回一个空 div 以显示在模态窗口的内容中：

```
<div id="contentd" style="display:none"></div> 
```

这是我和检票口之间没有代理时返回的内容：

```
<div id="content10">
  <form>
      <table align="center" cellspacing="5px" width="100%">
          <tr>
              <td colspan="2" align="center">
                  <span><p>Möchten Sie den Monitor wirklich löschen?</p></span>
              </td>
          </tr>
          <tr>
              <td align="center">
                  <input type="button" value="Ok" class="button" id="confirm15" onclick="var wcall=wicketAjaxGet('?wicket:interface=:1:uniModal:content:confirm::IBehaviorListener:0:-1',function() { }.bind(this),function() { }.bind(this), function() {return Wicket.$('confirm15') != null;}.bind(this));return !wcall;">
              </td>
              <td align="center">
                  <input type="button" value="Abbrechen" class="button" id="confirmNot16" onclick="var wcall=wicketAjaxGet('?wicket:interface=:1:uniModal:content:confirmNot::IBehaviorListener:0:-1',function() { }.bind(this),function() { }.bind(this), function() {return Wicket.$('confirmNot16') != null;}.bind(this));return !wcall;">
              </td>
          </tr>
      </table>
  </form>
</div> 
```

（对不起这个可怕的肮脏的html代码，不是我的工作。^^）

我的猜测是代理捕获了应该到达检票口但永远不会到达的参数。我打开了 org.apache.wicket 的调试，但找不到任何看起来有用的东西。有人知道即时解决方案或有任何想法如何进一步研究吗？在 DEBUG 日志没有显示任何内容之后，我几乎没有想法了。

也许有人可以从检票口日志中读出一些东西：

*   在没有代理的情况下工作 - [http://pastebin.com/Agi2JMJM](http://pastebin.com/Agi2JMJM)
*   不使用代理 - [http://pastebin.com/hfzXDHtq](http://pastebin.com/hfzXDHtq)

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T23:27:55.563

既然我知道了细节，实际的解决方案就很简单了。Wicket 在处理模态窗口时使用两个自定义标题：

*   wicket-ajax
*   以检票口为中心的元素

如果没有这些标题，检票口似乎无法识别正确的模态框架对象或类似对象。该公司的代理服务器阻止了所有未列入白名单的标头。在调整代理服务器以允许上面的标题之后，一切都像一个魅力一样工作。

# haskell - Haskell：如何将多个实例放在同一个模块中？

> ID：12217569
> 
> 赞同：4
> 
> 时间：2012-08-31T14:37:02.723
> 
> 标签：haskell

假设我有以下代码：

```
import Data.List.Ordered

data Person = Person String String
     deriving (Show, Eq)

main :: IO ()
main = print . show . sort $ [(Person "Isaac" "Newton"), (Person "Johannes" "Kepler")] 
```

在同一个模块中，我希望能够按名字和姓氏对列表进行排序。显然我不能这样做：

```
instance Ord Person where
         compare (Person _ xLast) (Person _ yLast) = compare xLast yLast

instance Ord Person where
         compare (Person xFirst _) (Person yFirst _) = compare xFirst yFirst 
```

那么，我有哪些选择？

[此页面](http://www.haskell.org/haskellwiki/Multiple_instances)提到“您可以通过将类型包装在新类型中并将所有必需的实例提升到该新类型来实现这一点。” 有人可以举个例子吗？

有没有更好的办法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-31T14:49:11.097

newtype 方法是：

```
newtype ByFirstname = ByFirstname { unByFirstname :: Person }

instance Ord ByFirstname where
  -- pattern matching on (ByFirstname (Person xFirst _)) etc
  compare [...] = [...]

newtype ByLastname = ByLastname { unByLastname :: Person }

instance Ord ByLastname where
  -- as above 
```

那么排序函数将类似于：

```
sortFirstname = map unByFirstname . sort . map ByFirstname 
```

同样对于`ByLastname`.

* * *

更好的方法是使用`sortBy`,`compare`和`on`, 用于检索名字和姓氏的函数。IE

```
sortFirstname = sortBy (compare `on` firstName) 
```

（关于这一点，可能值得为`Person`ie 使用记录类型，`data Person = Person { firstName :: String, lastName :: String }`甚至可以免费获得访问器函数。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-31T18:01:06.800

您不想定义多个`Ord`实例只是为了按不同的顺序排序。您只需要使用该`sortBy`函数，该函数将显式比较函数作为其参数。

巧妙的技巧：如果您使用记录类型来定义您的`Person`类型、导入`Data.Function`（它为您提供`on`功能）和`Data.Monoid`，您可以使用一些巧妙的技巧来使这更加简洁和容易：

```
import Data.Function (on)
import Data.Monoid (mappend)
import Data.List (sortBy)

data Person = Person { firstName :: String, lastName :: String }

instance Show Person where
    show p = firstName p ++ " " ++ lastName p

exampleData = [ Person "Mary" "Smith"
              , Person "Joe" "Smith"
              , Person "Anuq" "Katig"
              , Person "Estanislao" "Martínez"
              , Person "Barack" "Obama" ]
-- 
-- The "on" function allows you to construct comparison functions out of field
-- accessors:
--
--     compare `on` firstName :: Person -> Person -> Ordering
--     
-- That expression evaluates to something equivalent to this:
--
--    (\x y -> compare (firstName x) (firstName y))
--
sortedByFirstName = sortBy (compare `on` firstName) exampleData
sortedByLastName = sortBy (compare `on` lastName) exampleData

--
-- The "mappend" function allows you to combine comparison functions into a
-- composite one.  In this one, the comparison function sorts first by lastName,
-- then by firstName:
--
sortedByLastNameThenFirstName = sortBy lastNameFirstName exampleData
    where lastNameFirstName = 
              (compare `on` lastName) `mappend` (compare `on` firstName) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-31T14:45:09.237

该页面提到的原因`newtype`是，对于给定类型，您不能拥有同一类的两个实例。好吧，您*可以*但不在同一范围内，这通常是一个非常糟糕的主意。有关更多信息，请参阅[孤立实例](http://www.haskell.org/haskellwiki/Orphan_instance)（正如 CA McCann 指出的那样，这与孤立实例无关。我包含该链接是因为它很好地描述了为什么重复实例（即使在表面上有效的情况下）是一个坏主意。）。

一个例子`newtype`是：

```
 newtype SortFirst = SF Person

instance Ord Person where
         compare (Person _ xLast) (Person _ yLast) = compare xLast yLast

instance Ord SortFirst where
         compare (SF (Person xFirst _)) (SF (Person yFirst _)) = compare xFirst yFirst 
```

然后，当您想按名字排序时，您必须这样做：

```
sort (map SF persons) 
```

这不是很方便，因此最好使用`sortBy`将比较函数作为参数的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-31T14:46:13.777

似乎所有函数`Data.List.Ordered`都有“by”变体，让您提供比较函数而不是使用`Ord`实例。如果没有一个明显的“标准”排序，那不是一个糟糕的选择。

然后，您有责任确保任何给定的列表始终与一致的比较功能一起使用，但是，这是*各种*有趣错误的潜在来源。

如果我需要使用各种排序来处理许多有序列表，而不是大惊小怪地`newtype`包装和展开——这非常乏味——我会考虑使用一种数据类型来将列表与其比较函数捆绑在一起，然后定义代理函数使用带有相关比较的“by”函数。

# jquery - jQuery Full Calendar 不显示来自 url 的事件，但也没有错误

> ID：12217571
> 
> 赞同：0
> 
> 时间：2012-08-31T14:37:12.630
> 
> 标签：jquery, fullcalendar

我正在尝试使用带有 JSON url 选项的[jQuery Full Calendar](http://arshaw.com/fullcalendar/)插件，但它没有抛出任何错误，但事件也没有显示。我无法弄清楚问题可能是什么。

**完整的日历电话：**

```
$('#calendar').fullCalendar({                                                                                           
    aspectRatio: 1.3,                                                                                                                                                                                                                   
    defaultView: 'agendaWeek',                                                                                          
    slotMinutes: 15,                                                                                                    
    editable: true,                                                                                                     
    allDaySlot:false,                                                                                                   
    events: '/appt/appointments/json_event_source'                                                                                                                 
}); 
```

**来自 URL 的示例响应**

```
[
  {
    "id": "2",
    "title": "Adrian Adams",
    "start": "1346339700",
    "end": "1346340600"
   },
   {
     "id": "3",
     "title": null,
     "start": "1346166000",
     "end": "1346169600"
   },
   {
     "id": "4",
     "title": "asdfEditeda asdf",
     "start": "1346335200",
     "end": "1346335200"
   },
   {
     "id": "5",
     "title": "asdfEditeda asdf",
     "start": "1346335200",
     "end": "1346335200"
   },
   {
     "id": "6",
     "title": "asdfEditeda asdf",
     "start": "1346335200",
     "end": "1346339700"
   }
] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:06:10.117

事件对象中的`title`属性是必需的，不能是`null`（如在您的第二个事件中）。我将其更改为空字符串，日历渲染得很好。

看看这个：http: [//jsfiddle.net/100thGear/M8RRR/](http://jsfiddle.net/100thGear/M8RRR/)

您可能希望向服务器端代码添加验证，以不返回没有标题的对象。

让我知道这是否有帮助！

# java - Android：访问安全的 xml 文件

> ID：12217577
> 
> 赞同：0
> 
> 时间：2012-08-31T14:37:30.630
> 
> 标签：java, android, xml, http-post, http-get

我多次使用 xml 解析器，但现在唯一的事情是存储 xml 文件的服务器要求输入用户名和密码（我有它们），但我如何使用 httpGet 或 httpPost 登录。

提前致谢。

（PS：用户名和密码始终相同）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:44:19.847

我认为您需要知道如何在 android 中进行 HTTP 身份验证。

阅读[这个问题](https://stackoverflow.com/questions/1968416/how-to-do-http-authentication-in-android)。在那里，您将学习如何在 android 中进行 HTTP 身份验证。

编辑：[在这里](https://stackoverflow.com/questions/3463723/determining-web-http-authentication-methods)查看如何确定所需的身份验证类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:44:45.867

[BalusC](https://stackoverflow.com/users/157882/balusc)`java.net.URLConnection`在以下链接中很好地描述了使用

[使用 java.net.URLConnection 触发和处理 HTTP 请求](https://stackoverflow.com/questions/2793150/how-to-use-java-net-urlconnection-to-fire-and-handle-http-requests)

在该线程之后，您可以轻松地发送 httpGet 或 httpPost 并登录到服务器。

# email - 更改 JBoss Mail 服务的默认配置时出现问题

> ID：12217579
> 
> 赞同：2
> 
> 时间：2012-08-31T14:37:41.717
> 
> 标签：email, jakarta-ee, jboss

现在我必须迁移一个应用程序。

**基本配置：**

1.  JBOSS 5.1.0 正式版
2.  接缝 2.2.0.GA
3.  JBPM 3.2.2
4.  RichFaces 3.3.1.GA
5.  休眠 3.3.1.GA
6.  操作系统：Debian/Linux

应用程序已部署在具有自己配置的 JBoss 服务器上。在旧机器上，有用于发送消息的后缀（本地主机，端口 25）。

在新机器上我有不同的主机和端口。

我现在在*components.xml*中有什么：

```
<mail:mail-session session-jndi-name="java:/Mail" /> 
```

我的*mail-service.xml*：

```
<mbean code="org.jboss.mail.MailService"
     name="jboss:service=Mail">
<attribute name="JNDIName">java:/Mail</attribute>
<attribute name="User">XXX</attribute>
<attribute name="Password">XXX</attribute>
<attribute name="Configuration">
  <!-- A test configuration -->
  <configuration>
    <!-- Change to your mail server prototocol -->
    <property name="mail.store.protocol" value="pop3"/>
    <property name="mail.transport.protocol" value="smtp"/>

    <!-- Change to the user who will receive mail  -->
    <property name="mail.user" value="XXX"/>

    <!-- Change to the mail server  -->
    <property name="mail.pop3.host" value="localhost"/>

    <!-- Change to the SMTP gateway server -->
    <property name="mail.smtp.host" value="XXX"/>
    <property name="mail.smtp.auth" value="true"></property>
    <property name="mail.smtp.ssl.enable" value="false"></property>
    <property name="mail.smtp.port" value="587"/>

    <property name="mail.smtp.connectiontimeout" value="20000"></property>
    <property name="mail.smtp.timeout" value="20000"></property>

    <!-- The mail server port -->

    <!-- Change to the address mail will be from  -->
    <property name="mail.from" value="XXX"/>

    <!-- Enable debugging output from the javamail classes -->
    <property name="mail.debug" value="true"/>
  </configuration>
</attribute>
<depends>jboss:service=Naming</depends> 
```

我只对发送消息感兴趣。

但仍然：

```
javax.mail.MessagingException: Could not connect to SMTP host: localhost, port: 25;

nested exception is:
    java.net.ConnectException: Connection refused
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1282)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:370)
    at javax.mail.Service.connect(Service.java:275)
    at javax.mail.Service.connect(Service.java:156)
    at javax.mail.Service.connect(Service.java:105)
    at javax.mail.Transport.send0(Transport.java:168)
    at javax.mail.Transport.send(Transport.java:98)
    <xxx>
Caused by: java.net.ConnectException: Connection refused
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at java.net.Socket.connect(Socket.java:478)
    at com.sun.mail.util.SocketFetcher.createSocket(SocketFetcher.java:232)
    at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:189)
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1250)
    ... 59 more 
```

当然连接被拒绝，因为应用程序仍然指向 localhost:25。我尝试使用 grep 查找其他配置、分配等。邮件服务已启动（jmx-console 信息）。它看起来仍然像应用程序没有正确配置但使用默认值.. 有什么问题？

PS：我不是JBoss的专家。我在此托管服务器上没有 root 帐户。

# android - Android AccountManager getAuthToken 中 authTokenType 的值是什么？

> ID：12217582
> 
> 赞同：0
> 
> 时间：2012-08-31T14:37:59.727
> 
> 标签：android, facebook, accountmanager

适用于 Android 的 Facebook 应用程序为 AccountManager 提供了一个身份验证器。我正在尝试使用 getAuthToken 方法获取访问令牌，但我不知道参数 authTokenType 的可能值是什么。此参数有哪些可用值？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T01:09:12.150

您应该不可能通过 Facebook 的 Authenticator 获得访问令牌，因为这将构成一个相当严重的安全漏洞。

相反，您应该使用此处描述的单点登录 api：[https ://developers.facebook.com/docs/mobile/android/build/#enablesso](https://developers.facebook.com/docs/mobile/android/build/#enablesso)

那里的入门说明非常好。

如果您真的想要 facebook 使用的 authTokenType 值，您可能可以通过将手机植根并从身份验证数据库中读取它来获得它。但是，我认为这不会让您读取任何访问令牌，并且绝对不建议出于合法的商业目的这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-06T17:23:07.193

仅供参考，反编译 Facebook 应用程序 APK 显示 getAuthToken 方法的服务器部分未实现。

您需要使用 Facebook SDK。

# php - 检索所有 FDF 字段会使服务器崩溃

> ID：12217589
> 
> 赞同：0
> 
> 时间：2012-08-31T14:38:08.600
> 
> 标签：php, fdf

我想从我用 pdftk 生成的 fdf 文件中检索所有字段。不幸的是，php网站上提供的示例使apache崩溃......

我有这个：

```
$infdf = fdf_open($fdf_file);
for ($field = fdf_next_field_name($infdf); $field != ""; $field = fdf_next_field_name($infdf, $field))
{
    echo "field: $field\n";
}
fdf_close($infdf); 
```

关于崩溃原因的任何建议？

谢谢！

# javascript - 循环遍历元素 jquery 选择器

> ID：12217591
> 
> 赞同：2
> 
> 时间：2012-08-31T14:38:10.910
> 
> 标签：javascript, jquery

我必须选择包含 id 属性和具有“child-of-”值的类属性的元素，并遍历选择器返回的元素。

到目前为止，我可以写：

```
$('.child-of-').each(function(){
...
}); 
```

这将选择所有具有包含子元素类但也没有 id 的元素。有些元素具有该类但没有任何 id 属性。那么我如何选择具有“id”属性且 id 具有某些值并且还具有子类的元素。?

例如

```
 <div id="any1" class="child-of-"></div>
 <div id="any2" class="child-of-"></div>
 <div class="child-of-"></div> 
```

只有具有 id 属性的 div 必须被选中。即示例中的前两个 div。第三个没有 id 属性值，因此不应选择

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:40:08.800

您可以使用`attribute selector`.

```
$('.child-of-[id]').each(function(){
    ...
}); 
```

[小提琴](http://jsfiddle.net/cwZer/1/)

* * *

如果您的课程以您开始，`child-of-`您可以使用`attribute starts with`选择器：

```
$('[class^="child-of-"][id]').each(function(){
    ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:52:09.590

```
$('[id].child-of-').each(function(){
    ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:43:44.137

您可以使用此选择器：

```
$('#child-of-.child-of-').each(function(){
    ...
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:49:27.023

要获取属性值，您将使用属性选择器：

```
$('[id*="child-of-"][class*="child-of-"]').each(function... 
```

子字符串属性选择器 - [http://api.jquery.com/attribute-contains-selector/](http://api.jquery.com/attribute-contains-selector/)

# c# - 2 个列表 - 选中匹配元素的复选框 - C# MVC

> ID：12217599
> 
> 赞同：0
> 
> 时间：2012-08-31T14:38:39.023
> 
> 标签：c#, asp.net-mvc, list, loops, logic

我有 2 个不同类型的列表 -

列表列表

db 表的结构如下

```
Product
-----------
ProductID - PK
Name
Description
Price
OwnerID - FK
...

SelectedProducts
---------------
SelectedProductID - PK
ProductID - FK
Active 
```

所以我有一个页面，用户可以在其中显示产品列表，他们可以选择部分或全部产品。我现在正在尝试创建一个显示完整产品列表的编辑页面，但检查已选择产品的复选框。

我尝试了以下方法，但是两者都给了我某种形式的重复项-

**方法 1** 这种方法给了我一个产品列表，然后因为已经选择的产品而复制这些产品。

```
 <div style="margin-left: 10px; margin-top: 10px;">
    <% foreach (var product in Model.Products) { %>
        <% foreach (var p in Model.SelectedProducts)
           { %>
           <% if (p.ProductID == product.ProductID)
              { %>
                <div style="float: left; line-height: 18px; padding: 2px; margin: 2px; vertical-align: middle;
                        border: 1px solid grey; width: 282px;">
                        <input type="checkbox" name="PRODUCT_<%: product.Name %>" value="<%: ViewData["PRODUCT_" + product.ProductID] %>" checked="checked" style="vertical-align: middle; padding-left: 5px;" />
                        <%: Html.Truncate(product.Name, 35) %>
                </div>
                <% } %>
            <% } %>
            <div style="float: left; line-height: 18px; padding: 2px; margin: 2px; vertical-align: middle;
                    border: 1px solid grey; width: 282px;">
                    <input type="checkbox" name="PRODUCT_<%: product.Name %>" value="<%: ViewData["PRODUCT_" + product.ProductID] %>" style="vertical-align: middle; padding-left: 5px;" />
                    <%: Html.Truncate(product.Name, 35) %>
            </div>
        <% } %>        
    </div> 
```

**方法二**

```
<div style="margin-left: 10px; margin-top: 10px;">
        <% foreach (var product in Model.Products) { %>
            <% foreach (var p in Model.SelectedProducts)
               { %>
               <% if (p.ProductID == product.ProductID)
                  { %>
        <div style="float: left; line-height: 18px; padding: 2px; margin: 2px; vertical-align: middle;
                        border: 1px solid grey; width: 282px;">
                        <input type="checkbox" name="PRODUCT_<%: product.Name %>" value="<%: ViewData["PRODUCT_" + product.ProductID] %>" style="vertical-align: middle; padding-left: 5px;" />
                        <%: Html.Truncate(product.Name, 35) %>
          </div>
        <% } else { %>
         <div style="float: left; line-height: 18px; padding: 2px; margin: 2px; vertical-align: middle; border: 1px solid grey; width: 282px;">
         <input type="checkbox" name="PRODUCT_<%: product.Name %>" value="<%: ViewData["PRODUCT_" + product.ProductID] %>" checked="checked" style="vertical-align: middle; padding-left: 5px;" />
                      <%: Html.Truncate(product.Name, 35) %>
                    </div>
                <% } %>
            <% } %>
        <% } %>        
    </div> 
```

我知道这只是一个愚蠢的逻辑错误，但我可以用一双新的眼睛来做！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:48:08.047

如果您删除内部循环，而只是针对您选择的产品列表测试外部循环中的每个项目，那么您应该很高兴：

```
<div style="margin-left: 10px; margin-top: 10px;">
        <% foreach (var product in Model.Products) { %>
        <% if (Model.SelectedProducts.Exists(x => x.ProductId == product.ProductId))
                  { %>
        <div style="float: left; line-height: 18px; padding: 2px; margin: 2px; vertical-align: middle;
                        border: 1px solid grey; width: 282px;">
                        <input type="checkbox" name="PRODUCT_<%: product.Name %>" value="<%: ViewData["PRODUCT_" + product.ProductID] %>" style="vertical-align: middle; padding-left: 5px;" />
                        <%: Html.Truncate(product.Name, 35) %>
          </div>
        <% } else { %>
         <div style="float: left; line-height: 18px; padding: 2px; margin: 2px; vertical-align: middle; border: 1px solid grey; width: 282px;">
         <input type="checkbox" name="PRODUCT_<%: product.Name %>" value="<%: ViewData["PRODUCT_" + product.ProductID] %>" checked="checked" style="vertical-align: middle; padding-left: 5px;" />
                      <%: Html.Truncate(product.Name, 35) %>
                    </div>
                <% } %>
            <% } %>
        <% } %>        
    </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:57:57.030

试试这个：

```
 foreach (var product in Model.Products) {
       if (Model.SelectedProducts.Any(i => i.ProductID == product.Id))
      {
       //Your code
      }
      else
      {
       //Your code
      }
    } 
```

# ios - iPhone - 应用程序卸载通知

> ID：12217603
> 
> 赞同：2
> 
> 时间：2012-08-31T14:38:50.420
> 
> 标签：ios, apple-push-notifications, uninstallation

当我的 iOS 应用程序被卸载时，如何从 App Store 或 APN 获得通知？

另外，如果我为卸载我的应用程序的设备发送推送通知，会发生什么？苹果会禁止这种流氓推送通知吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T15:01:23.970

您的应用程序无法知道它是否已被卸载。我也不相信苹果会告诉你你的应用程序是否被卸载。

[Apple 推送通知服务的反馈服务](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html#//apple_ref/doc/uid/TP40008194-CH101-SW3)确实提供了一种方法来了解设备是否无法接收通知。但是，这并不能保证设备已被卸载，只能保证无论出于何种原因，它都无法接收推送通知。

> 如果提供者尝试向应用程序发送推送通知，但该应用程序不再存在于设备上，则设备会将该事实报告给 Apple Push Notification Service。这种情况经常发生在用户卸载应用程序时。如果设备报告应用程序的交付尝试失败，APNs 需要某种方式通知提供者，以便它可以避免向该设备发送通知。这样做可以减少不必要的消息开销并提高整体系统性能。
> 
> 为此，Apple Push Notification Service 包含一个反馈服务，APN 会不断更新每个应用程序的失败交付尝试设备列表。

# c# - 在 C# wpf 应用程序中编辑/查看 postgresql 表

> ID：12217604
> 
> 赞同：1
> 
> 时间：2012-08-31T14:38:54.227
> 
> 标签：c#, .net, wpf, postgresql

我需要创建一种通过 C# WPF 样式应用程序查看和编辑 postgresql 表的方法。是否可以在 DataGrid 控件中执行此操作？到目前为止，我在.NET框架中找到了一个名为SqlDataAdapter的类，它可以在DataSet对象中返回查询结果，并在DataSet发生变化时适当地更新db中的数据。但我认为这仅适用于 Microsoft Sequel Server。这对 PostgreSql 有用吗？是否可以将 DataSet 绑定到 Datagrid？

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:47:22.583

[npgsql](http://npgsql.projects.postgresql.org/)是我一直使用的。它使用相同的接口，因此`SqlDataAdapter`您将拥有一个`NpgsqlDataAdapter`功能相同的接口。从那里，您可以填充您的`DataTable`or`DataSource`并将其绑定到您的`DataGrid`.

# magento - Observer.php 中的公共函数 catalogCategoryCollectionLoadAfter ($observer) 是什么意思

> ID：12217614
> 
> 赞同：-2
> 
> 时间：2012-08-31T14:39:25.197
> 
> 标签：magento

谁能告诉我**Observer.php**`catalogCategoryCollectionLoadAfter()`中的含义

 **```
public function catalogCategoryCollectionLoadAfter ($observer) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:08:42.953

我用谷歌搜索了你。它是隐藏空类别。

您也可以 google - 右键单击​​ catalogCategoryCollectionLoadAfter，用 google 搜索，然后，在列表顶部，您会看到这里发生了什么。**

# regex - 支持环视和布尔“和”的正则表达式库

> ID：12217621
> 
> 赞同：0
> 
> 时间：2012-08-31T14:39:45.320
> 
> 标签：regex

我需要一个支持布尔值和环视的正则表达式程序/库/任何东西。我发现的唯一支持布尔“和”的库是 dk.brics： [http ://www.brics.dk/automaton/doc/index.html?dk/brics/automaton/RegExp.html](http://www.brics.dk/automaton/doc/index.html?dk/brics/automaton/RegExp.html)

然而，这个库不支持环视，而且添加支持似乎并非易事。

当然，有许多库支持环视，但我还没有找到任何支持布尔“和”的库。

我会对实际可以运行正则表达式、库、程序等的任何东西感到满意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:51:47.553

从理论上讲，您不能使用否定检查和 OR 实现来获得与您正在寻找的 AND 相同的功能吗？在这种情况下，我知道 .Net 的正则表达式解析器支持 OR 和正负向前看和向后看。要检查某项是否匹配 A 和 B，请检查它是否不匹配（不匹配 A | 不匹配 B）。

# python - SQLAlchemy M2M 关系查询

> ID：12217625
> 
> 赞同：2
> 
> 时间：2012-08-31T14:39:56.080
> 
> 标签：python, sqlalchemy

我有以下模型，我正在尝试列出在用户组中具有组的所有最新 DocumentVersions。

```
class User(Base, BaseModel):
    __tablename__ = 'users'
    id = Column(Integer, primary_key=True)
    email = Column(Unicode(EMAIL_LENGTH), unique=True, nullable=False)
    full_name = Column(Unicode(FULL_NAME_LENGTH), nullable=False)
    deleted = Column(Boolean, nullable=False, default=False)

    document_versions = relationship(
        'DocumentVersion', 
        backref="author")

class Group(Base, BaseModel):
    __tablename__ = 'groups'
    __table_args__ = (UniqueConstraint('name','company_id'),)
    id = Column(Integer, primary_key=True)
    name = Column(Unicode(60), nullable=False)
    deleted = Column(Boolean, nullable=False, default=False)

    # Companies have many groups
    company_id = Column(
            Integer,
            ForeignKey('companies.id'),
            nullable=False)
    roles = relationship("Role",
            primaryjoin="Group.id==Role.group_id",
            backref="group")
    users = relationship("User",
            secondary=group_user,
            backref="groups")

document_version_group = Table(
        "document_version_groups",
        Base.metadata,
        Column('group_id', Integer, ForeignKey('groups.id')),
        Column('document_version_id', Integer, ForeignKey('document_versions.id')))

class DocumentVersion(Base, BaseModel):
    __tablename__ = 'document_versions'
    id = Column(Integer, primary_key=True)
    document_id = Column(
            Integer,
            ForeignKey('documents.id'),
            nullable=False)

    author_id = Column(
            Integer,
            ForeignKey('users.id'),
            nullable=False)
    groups = relationship(
            "Group",
            secondary=document_version_group,
            lazy='dynamic', # This is newly added just now
            backref="document_versions")
    status = Column(
            Enum(
                "draft",
                "review",
                "approval",
                "declined",
                "approved",
                name="status"),
            default="draft",
            nullable=False) 
```

我尝试了以下方法，但没有成功（注意 document_version 以零组返回）

```
>>> docs = session.query(DocumentVersion).filter(Document.company == user.company).filter(Group.id.in_([g.id for g in user.groups])).all()

2012-08-31 15:14:19,651 INFO  [sqlalchemy.engine.base.Engine][MainThread] SELECT document_versions.id AS document_versions_id, document_versions.document_id AS document_versions_document_id, document_versions.document_current_draft_id AS document_versions_document_current_draft_id, document_versions.document_current_active_id AS document_versions_document_current_active_id, document_versions.author_id AS document_versions_author_id, document_versions.status AS document_versions_status, document_versions.major_version AS document_versions_major_version, document_versions.minor_version AS document_versions_minor_version 
FROM document_versions, documents, groups 
WHERE %(param_1)s = documents.company_id AND groups.id IN (%(id_1)s)
2012-08-31 15:14:19,651 INFO  [sqlalchemy.engine.base.Engine][MainThread] {'id_1': 1, 'param_1': 1}

>>> [d.groups.all() for d in docs]

2012-08-31 15:15:29,996 INFO  [sqlalchemy.engine.base.Engine][MainThread] SELECT groups.id AS groups_id, groups.name AS groups_name, groups.deleted AS groups_deleted, groups.company_id AS groups_company_id 
FROM groups, document_version_groups 
WHERE %(param_1)s = document_version_groups.document_version_id AND groups.id = document_version_groups.group_id
2012-08-31 15:15:29,996 INFO  [sqlalchemy.engine.base.Engine][MainThread] {'param_1': 1}
2012-08-31 15:15:29,998 INFO  [sqlalchemy.engine.base.Engine][MainThread] SELECT groups.id     AS groups_id, groups.name AS groups_name, groups.deleted AS groups_deleted, groups.company_id AS groups_company_id 
FROM groups, document_version_groups 
WHERE %(param_1)s = document_version_groups.document_version_id AND groups.id = document_version_groups.group_id
2012-08-31 15:15:29,998 INFO  [sqlalchemy.engine.base.Engine][MainThread] {'param_1': 2}
[[], [<project.models.Group object at 0x27ead50>]] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T04:12:31.900

假设这个 SQL 给出了正确的结果：

```
SELECT *
FROM document_versions
WHERE
    EXISTS (
        SELECT 1
        FROM documents
        WHERE
            document_versions.document_id = documents.id
            AND documents.company_id = :company_id
    )
    AND EXISTS (
        SELECT 1
        FROM document_version_groups
        WHERE
            document_versions.id = document_version_groups.document_version_id
            AND document_version_groups.group_id IN :group_ids
    ) 
```

那么下面的 SQLAlchemy 表达式应该可以工作：

```
session.query(DocumentVersion).filter(and_(
    DocumentVersion.document.has(compay=user.company),
    DocumentVersion.groups.any(
        Group.id.in_([g.id for g in user.groups])
    ),
)).all() 
```

注意关系属性`DocumentVersion.document`和的显式使用`DocumentVersion.groups`。没有它们，查询将只包含一堆不相关的表，从而给你错误的肯定结果。

# flash - 动态文本无法更改

> ID：12217627
> 
> 赞同：0
> 
> 时间：2012-08-31T14:40:00.547
> 
> 标签：flash, dynamic, actionscript, textfield

我在 Flash 中制作了一个预加载屏幕，我有一个包含 progressBar 和 progressText MC-s 的预加载器 MovieClip，它们都是由我创建的，在 preLoader 类中我使用如下代码：

```
... ldrInf.addEventListener(ProgressEvent.PROGRESS, onProgress); ...

private function onProgress(e:ProgressEvent):void {
        var percent:Number = e.bytesLoaded / e.bytesTotal;
        progressBar.scaleX = percent;           
        progressText.text = Math.floor(percent * 100).toString() + "%";
    } 
```

缩放效果很好，但文本没有改变，我设置了“自动声明阶段实例”，我有一个这样的错误（我不知道它必须对我的问题做些什么，但无论如何）：**ReferenceError：错误＃ 1065: 变量 Font1 未定义。**

如果我为 ProgressText MC 创建一个类，则会收到错误消息：**1119：通过静态类型 ProgressText 的引用访问可能未定义的属性文本。**我知道这是因为，好吧，我的类中没有**text**属性，但是 text 变量是我想的文本字段的某种内置变量，所以我认为我可能不必定义它。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T21:37:49.470

在我看来，您尝试嵌入字体未成功。如果您可以在设置实例的位置发布代码，这将很有用`TextFormat`，`TextField`尽管您可以尝试将字体直接设置为“Arial”或完全注释掉该行以排除问题的原因。

如果您想为您创建一个自定义类`TextField`（尽管尚不清楚在这种情况下是否完全有必要），您需要`TextField`在自定义类中扩展该类（在这种情况下它将继承该`TextField.text`属性）或实现一个 setter您自己在`TextField`作为类属性存储的实例上设置文本。

**扩展 TextField（继承）示例：**

```
package 
{
    import flash.text.TextField;

    public class CustomTextField extends TextField
    {
        public function CustomTextField()
        {

        }

        override public function set text(value:String):void
        {
            // could do custom stuff here or omit override altogether if it isn't required
            value = "custom " + value;

            super.text = value;
        }
    }
} 
```

**TextField 属性（组成）示例：**

```
package 
{
    import flash.text.TextField;

    public class CustomTextField extends Sprite
    {
        private var textField:TextField = new TextField();

        public function CustomTextField()
        {
            this.addChild(textField);
        }

        public function setText(value:String):void
        {
            textField.text = value;
        }
    }
} 
```

# svg - 将 XPS 转换为 SVG

> ID：12217629
> 
> 赞同：5
> 
> 时间：2012-08-31T14:40:09.393
> 
> 标签：svg, xps

有没有直接快速的方法将[XPS（XML 纸张规范）](http://en.wikipedia.org/wiki/Open_XML_Paper_Specification)文件转换为[SVG](http://en.wikipedia.org/wiki/Scalable_Vector_Graphics)格式？

我可以将 XPS 转换为 PDF，然后使用[inkscape](http://inkscape.org/)将它们转换为 SVG。但是 PDF->SVG 步骤非常耗时，尽管此过程似乎不消耗 CPU。

我的理解是因为 XPS 是一种基于矢量的格式，将其转换为另一种基于矢量的格式（如 SVG）必须是可行的，并且比将基于光栅的格式（尽管我不完全确定 pdf 只是光栅基础）转换为基于矢量的格式要快得多格式。

顺便说一句，目标是在浏览器中显示基于矢量的图像，我有 XPS 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-01-09T16:13:52.330

[libgxps](https://github.com/GNOME/libgxps)读取 XPS 并可以创建 SVG 文件。

我用命令在 Cygwin 上试了一下`xpstosvg`，效果很好。

# ruby-on-rails - HABTM 关联 Insert_sql

> ID：12217630
> 
> 赞同：3
> 
> 时间：2012-08-31T14:40:14.193
> 
> 标签：ruby-on-rails, ruby-on-rails-3

导轨 3.2.3，红宝石 1.9.3p194

尝试使用与 HABTM 关联的子项目保存项目时，我覆盖了默认生成的 SQL，并调用了母项目和每个关联子项目的 Name 属性。如何正确指定关联的子项目名称？#{record.Name}，如示例中所示，导致 NameError: undefined local variable or method `record' for #

```
has_and_belongs_to_many :subproject, :class_name => "Project",
:join_table => "project_subproject", :foreign_key => "projectname", :association_foreign_key => "subprojectname",
:finder_sql => proc { %{SELECT `project`.* FROM `project` INNER JOIN `project_subproject` ON `project`.`name` = `project_subproject`.`subprojectname` WHERE `project_subproject`.`projectname` = '#{self.Name}' } },
#TODO: find correct expression for insert sql
:insert_sql =>  proc { %{INSERT INTO `project_subproject` (`projectname`, `subprojectname`) VALUES ( "#{self.Name}","#{record.Name}" )} } 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T15:19:24.560

从 Rails 3.1 解决。发行说明：

以前，has_and_belongs_to_many 关联上的 :insert_sql 和 :delete_sql 允许您调用 'record' 来获取插入或删除的记录。这现在作为参数传递给 proc。

因此：

```
:insert_sql =>  proc { |record| %{INSERT INTO `project_subproject` (`projectname`, `subprojectname`) VALUES ( "#{self.Name}","#{record.Name}" )} } 
```

# c# - 如何在视图中使用 GroupBy 数据 - ASP.NET MVC 4

> ID：12217631
> 
> 赞同：0
> 
> 时间：2012-08-31T14:40:14.827
> 
> 标签：c#, entity-framework, group-by, asp.net-mvc-4

我有以下 LINQ 代码。

```
public List<IGrouping<Guid, ProfileImage>> GetAllUser()
{
    return _profileImageRepository.QueryProfileImage()
        .GroupBy(g => g.UserId)
        .ToList();
} 
```

这个想法是它将检索所有用户的个人资料图片，但如果用户有多个图像，则只返回最后一个图像。

我不确定它是否正确，但这不是我最大的问题。

在我的控制器中，我有以下代码。

```
_homeViewModel.ProfileImages = _profileImageService.GetAllUser(); 
```

视图模型：

```
public List<IGrouping<Guid, ProfileImage>> ProfileImages { get; set; } 
```

我的大问题是，我如何在我的视图中使用它，以便我可以打印正确的信息。

当我查看即时 Windows 中的数据时，它看起来像这样：

```
Model.ProfileImages
Count = 2
    [0]: {System.Data.Objects.ELinq.InitializerMetadata.Grouping<System.Guid,Zipr.Models.ProfileImage>}
    [1]: {System.Data.Objects.ELinq.InitializerMetadata.Grouping<System.Guid,Zipr.Models.ProfileImage>} 
```

我试图这样做：

```
<ul>
    @foreach (var image in Model.ProfileImages)
    {
        <li>
            <img src="@Url.Content(String.Format("~/Content/uploads/thumbs/{0}", image.ThumbPath))" alt="" />
        </li>
    }
</ul> 
```

任何人都有解决方案如何访问我的 Properties ThumbPath 等等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:46:36.620

您似乎对 ID 不感兴趣；所以改变这个以返回一个列表`ProfileImage`

```
public List<ProfileImage> GetAllUser()
{
    return _profileImageRepository.QueryProfileImage()
        .GroupBy(g => g.UserId)
        .Select(u => u.First() } 
        .ToList();
} 
```

现在，当您的视图在图像上循环时，它实际上会得到一个`ProfileImage`Object 而不是 an 的实例`IGrouping`

# c# - 在 C# 中调用事件处理程序

> ID：12217632
> 
> 赞同：8
> 
> 时间：2012-08-31T14:40:21.353
> 
> 标签：c#, events

我一直在尝试学习如何在 C# 中使用事件处理程序，但我无法弄清楚 handler(this, e) 在以下代码中的作用：

```
public event EventHandler ThresholdReached;

protected virtual void OnThresholdReached(EventArgs e)
{
    EventHandler handler = ThresholdReached;
    if (handler != null)
    {
        handler(this, e);
    }
} 
```

是否尝试使用事件 (e) 调用事件处理程序方法 (this)？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T14:41:42.603

它调用在事件上注册的所有已注册事件侦听器`ThresholdReached`。

`handler != null`检查确保至少有一个侦听器注册到该事件。

在 C# 6.0 及更高版本中，您可以使用[Null Propagation](https://msdn.microsoft.com/en-us/magazine/dn802602.aspx)：

```
handler?.Invoke(this, e); 
```

* * *

`handler(this, e)`将调用每个注册的事件监听器。事件侦听器在操作员的帮助下`+=`订阅，并通过操作员取消订阅`-=`该事件。

`this`是否可以让事件侦听器知道谁引发了 ThresholdReached 事件。谁是事件的发送者。

`e`是事件参数，它也被传递到侦听器方法中，它可以包含有关 ThresholdReached 事件的更多有用信息，例如达到*哪个*阈值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:44:16.167

它`ThresholdReached`使用参数 sender=this 和 eventarguments = e 引发事件。其实跟下面是一样的；

```
public event EventHandler ThresholdReached;

protected virtual void OnThresholdReached(EventArgs e)
{
    if (ThresholdReached != null)
    {
        ThresholdReached(this, e);
    }
} 
```

如果该事件有任何监听者；它只会调用侦听器代表；

```
this.ThresholdReached += new EventHandler(Form1_ThresholdReached); 
```

然后，当引发此事件时，`Form1_ThresholdReached`将使用`this`和`e`参数调用函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:31:01.763

您的示例中的代码将所有已注册的处理程序复制到局部变量`handler`，检查调用列表是否不为空，并使用参数`this`和调用复制的调用列表的所有成员`e`。

您获得当前调用列表的快照的原因是[委托是不可变的](http://smellegantcode.wordpress.com/2008/05/11/delegates-are-immutable/)。您将获得对当前多播委托的引用，并且当添加或删除处理程序时，支持字段指向从两个不可变的委托创建的新委托。

将调用列表复制到局部变量的通常原因是某种形式的线程安全：处理程序可以在通常的空值检查（检查调用列表不为空）和实际调用之间取消订阅：这样你可能意外触发没有处理程序的事件，并且`NullReferenceException`会抛出 a。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:41:42.733

> 是否尝试使用事件 (e) 调用事件处理程序方法 (this)？

不，不是字面意思。它使用`EventArgs`e 调用事件处理程序并`this`用作发送者。也可能是：

```
if (ThresholdReached != null)
{
    ThresholdReached(this, e);
} 
```

或者，为了规避空检查：

```
public event EventHandler ThresholdReached = delegate { };

protected virtual void OnThresholdReached(EventArgs e)
{
    ThresholdReached(this, e);
} 
```

但是，正如@Oded 所指出的，第一部分不是线程安全的，因为`EventHandler handler = ThresholdReached`创建了处理程序的副本，这在[这个问题](https://stackoverflow.com/questions/2582052/c-sharp-event-handlers-not-thread-safe)中得到了更好的解释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T14:43:08.893

`handler`指您的`ThresholdReached`活动。因此，如果有人订阅`ThresholdReached`事件，他们注册的处理程序将使用参数`this`和`e`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-31T14:43:37.450

它正在触发`ThresholdReached`事件。传递对自身的引用，`this`. 在 中传递有关事件的参数`e`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-31T14:52:13.527

对处理程序的调用表示另一个对象或类中的函数调用。创建对象时，您将能够编写如下所示的一段代码：

```
obj.ThreasholdReached += new EventHandler(someFunction); 
```

`someFunction`在那个类中将像这样定义

```
public someFunction(object sender, EventArgs e) {...} 
```

原始对象中的`OnThreasholdReached`函数是将事件发布到已将函数分配给 ThreasholdReached 处理程序的任何其他类。用作中间人`handler`是完全不必要的额外步骤。你还在说`if ThreasholdReached != null`，是一样的。

总结：这行代码`handler(this, e)`实际上是对`someFunction(object sender, EventArgs e)`已分配给对象的 ThreasholdReached 事件的任何订阅者的调用。

# asp.net-mvc - ASP.NET MVC WebApi：没有为此对象定义无参数构造函数

> ID：12217636
> 
> 赞同：8
> 
> 时间：2012-08-31T14:40:29.750
> 
> 标签：asp.net-mvc, asp.net-web-api, ninject, unit-of-work

我有一个想要实现工作单元模式的 ASP.NET MVC 4 应用程序。

在我的 Web 项目中，我有：

IocConfig.cs

```
using System.Web.Http;
using NinjectMVC.Data;
using NinjectMVC.Data.Contracts;
using Ninject;

namespace NinjectMVC
{
    public class IocConfig
    {
        public static void RegisterIoc(HttpConfiguration config)
        {
            var kernel = new StandardKernel(); // Ninject IoC

            // These registrations are "per instance request".
            // See http://blog.bobcravens.com/2010/03/ninject-life-cycle-management-or-scoping/

            kernel.Bind<RepositoryFactories>().To<RepositoryFactories>()
                .InSingletonScope();

            kernel.Bind<IRepositoryProvider>().To<RepositoryProvider>();
            kernel.Bind<INinjectMVCUow>().To<NinjectMVCUow>();

            // Tell WebApi how to use our Ninject IoC
            config.DependencyResolver = new NinjectDependencyResolver(kernel);
        }
    }
} 
```

全球.asax

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Http;
using System.Web.Mvc;
using System.Web.Optimization;
using System.Web.Routing;

namespace NinjectMVC
{
    // Note: For instructions on enabling IIS6 or IIS7 classic mode, 
    // visit http://go.microsoft.com/?LinkId=9394801

    public class MvcApplication : System.Web.HttpApplication
    {
        protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();

            // Tell WebApi to use our custom Ioc (Ninject)
            IocConfig.RegisterIoc(GlobalConfiguration.Configuration);   

            WebApiConfig.Register(GlobalConfiguration.Configuration);
            FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            BundleConfig.RegisterBundles(BundleTable.Bundles);
            AuthConfig.RegisterAuth();
        }
    }
} 
```

人员控制器.cs

```
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Web.Http;
using NinjectMVC.Data.Contracts;
using NinjectMVC.Model;

namespace NinjectMVC.Controllers
{
    public class PersonsController : ApiControllerBase
    {
        public PersonsController(INinjectMVCUow uow)
        {
            Uow = uow;
        }

        #region OData Future: IQueryable<T>
        //[Queryable]
        // public IQueryable<Person> Get()
        #endregion

        // GET /api/persons
        public IEnumerable<Person> Get()
        {
            return Uow.Persons.GetAll()
                .OrderBy(p => p.FirstName);
        }

        // GET /api/persons/5
        public Person Get(int id)
        {
            var person = Uow.Persons.GetById(id);
            if (person != null) return person;
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        }

        // OData: GET /api/persons/?firstname=\'Hans\''
        // With OData query syntax we would not need such methods
        // /api/persons/getbyfirstname?value=Joe1
        [ActionName("getbyfirstname")]
        public Person GetByFirstName(string value)
        {
            var person = Uow.Persons.GetAll()
                .FirstOrDefault(p => p.FirstName.StartsWith(value));

            if (person != null) return person;
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        }

        // Update an existing person
        // PUT /api/persons/
        public HttpResponseMessage Put(Person person)
        {
            Uow.Persons.Update(person);
            Uow.Commit();
            return new HttpResponseMessage(HttpStatusCode.NoContent);
        }

    }
} 
```

当我尝试上网时：http: [//www.domain.com/Persons/Get](http://www.domain.com/Persons/Get)我得到：

**没有为此对象定义无参数构造函数。**

有什么我错过的吗？我将不胜感激任何帮助。

这是项目的 zip 文件，以便更好地参考：

[http://filebin.ca/E6aoOkaUpbQ/NinjectMVC.zip](http://filebin.ca/E6aoOkaUpbQ/NinjectMVC.zip)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T14:56:56.957

Wep.API 使用不同于`IDependencyResolver`MVC 的框架。

当您使用它时，`HttpConfiguration.DependencyResolver`它仅适用于 ApiControllers。但你的`ApiControllerBase`派生自`Controller`...

所以你`ApiControllerBase`应该继承自`ApiController`.

在您的 ApiBaseController.cs 中更改它：

```
public abstract class ApiControllerBase : ApiController
{
} 
```

如果您想将依赖项注入到`Controller`您需要使用的常规派生类中（在您的 IocConfig 中）：

```
System.Web.Mvc.DependencyResolver.SetResolver(new NinjectMvcDependencyResolver(container)); 
```

请注意，在这种情况下，您不能使用 your `NinjectDependencyResolver`，因为它用于`ApiControllers`.

所以你需要一个不同`NinjectMvcDependencyResolver`的应该实现 的`System.Web.Mvc.IDependencyResolver`。

```
public class NinjectMvcDependencyResolver: NinjectDependencyScope,
                                           System.Web.Mvc.IDependencyResolver
{
    private IKernel kernel;

    public NinjectDependencyResolver(IKernel kernel)
        : base(kernel)
    {
        this.kernel = kernel;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-12T14:35:39.690

我知道这是一个旧线程，但这可能对某人有用。:) 就我而言，它缺少`DependencyResolver`on `NinjectWebCommon.cs`。我关注了这篇[文章](http://nodogmablog.bryanhogan.net/2016/04/web-api-2-and-ninject-how-to-make-them-work-together/)，一切正常。

```
RegisterServices(kernel);
GlobalConfiguration.Configuration.DependencyResolver = new NinjectDependencyResolver(kernel);
return kernel; 
```

# c# - 数据绑定到 Expression Blend 中的自定义控件

> ID：12217640
> 
> 赞同：0
> 
> 时间：2012-08-31T14:40:40.703
> 
> 标签：c#, custom-controls, expression-blend

我在表达式 Blend 中创建了一个自定义控件并添加了一个属性。我在 Blend 中找到了该属性，但创建数据绑定的选项不可用。我必须做什么才能通过 Blend 添加数据绑定？

代码属性：

```
 public string TileText
    {
        get { return this.labelTileText.Text; }
        set { this.labelTileText.Text = value; }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:00:03.017

如果要对自定义控件的属性启用数据绑定，则需要为该属性创建依赖项属性。

物业：

```
public string TileText { 
     get { return this.labelTileText.Text; } 
     set { this.labelTileText.Text = value; } 
} 
```

依赖属性：

```
public static readonly DependencyProperty TileTextProperty = DependencyProperty.Register(
"TileText", typeof(String), typeof(ClassName), new UIPropertyMetadata("default value", callBack)); 
```

然后你应该实现那个 callBack 函数，只要 'TileText' 属性发生变化就会被调用。

# ruby-on-rails - 在生成 mass_assignment 错误之前使用 Hash#exclude 排除控制器操作中的嵌套表单字段？

> ID：12217641
> 
> 赞同：0
> 
> 时间：2012-08-31T14:40:45.403
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我目前在我的销售控制器中有一个创建操作，如下所示：

```
def create
    @sale = Sale.new(params[:sale].except(:vehicles_attributes))
    if @sale.save
      redirect_to @sale, :notice => "Successfully created sale."
    else
      render :action => 'new'
    end
end 
```

目的是排除一些仅用于填充链接选择且不应提交的属性（它们没有列）。

使用上面的控制器代码，我发现参数仍然包含`"sale"=>{"vehicles_attributes"=>{"0"=>{"make"=>"","model"=>""}}}`，所以我似乎错过了控制器代码中的某些内容。

编辑：经过更多的挖掘，我发现在我的异常代码有机会删除不应该由表单发送的参数之前，mass_assignment 异常正在触发，所以我回到了第一个问题。

如何确保在收到 mass_assignment 错误之前删除不应由表单发送的字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:51:38.287

据我所知，mass_assignment 错误应该在`new`通话期间发生，所以你的方式应该可行。虽然我从来没有使用过这种`except`方法。您是否尝试过使用该`reject!`方法？

```
def create
  params[:sale].reject! { |k, v| k == :vehicles_attributes }
  @sale = Sale.new(params[:sale])
  if @sale.save
    redirect_to @sale, :notice => "Successfully created sale."
  else
    render :action => 'new'
  end
end 
```

如果您需要保留它，`:vehicles_attributes`您还可以使用该`reject`方法（没有爆炸），它为您提供一个副本，而不是从原始哈希中删除它。

# c - 调用 strcpy 后尝试释放内存导致程序崩溃

> ID：12217644
> 
> 赞同：2
> 
> 时间：2012-08-31T14:40:55.533
> 
> 标签：c, microcontroller, lpc

我知道这里有很多人抱怨 strcpy，但我没有找到任何使用搜索来解决我遇到的问题的东西。

首先，调用 strcpy 本身不会导致任何类型的崩溃/分段错误。其次，代码包含在一个函数中，我第一次调用这个函数时它工作得很好。它只在第二次通过时崩溃。

我正在用 LPC1788 微控制器编程；内存非常有限，所以我明白为什么 malloc 之类的东西可能会失败，但不是免费的。

函数 trimMessage() 包含代码，该函数的目的是在大字符串数组变得太大时删除它的一部分。

```
void trimMessage()
{
  int trimIndex;
  // currMessage is a globally declared char array that has already been malloc'd
  // and written to.
  size_t msgSize = strlen(currMessage);

  // Iterate through the array and find the first newline character. Everything
  // from the start of the array to this character represents the oldest 'message'
  // in the array, to be got rid of.
  for(int i=0; i < msgSize; i++)
  {
    if(currMessage[i] == '\n')
    {
      trimIndex = i;
      break;
    }
  }
  // e.g.: "\fProgram started\r\nHow are you?\r".
  char *trimMessage = (char*)malloc((msgSize - trimIndex - 1) * sizeof(char));

  trimMessage[0] = '\f';

  // trimTimes = the number of times this function has been called and fully executed.
  // freeing memory just below is non-sensical, but it works without crashing.
  //if(trimTimes == 1) { printf("This was called!\n"); free(trimMessage); }
  strcpy(&trimMessage[1], &currMessage[trimIndex+1]);

  // The following line will cause the program to crash. 
  if(trimTimes == 1) free(trimMessage);
  printf("trimMessage: >%s<\n", trimMessage);

  // Frees up the memory allocated to currMessage from last iteration
  // before assigning new memory.
  free(currMessage);
  currMessage = malloc((msgSize - trimIndex + 1) * sizeof(char));

  for(int i=0; i < msgSize - trimIndex; i++)
  {
    currMessage[i] = trimMessage[i];
  }

  currMessage[msgSize - trimIndex] = '\0';
  free(trimMessage);
  trimMessage = NULL;

  messageCount--;
  trimTimes++;
} 
```

感谢所有帮助过的人。该功能现在可以正常工作。对于那些问我为什么要打印出我刚刚释放的数组的人，那只是为了表明问题发生在 strcpy 之后，并排除了它之后出现的任何其他代码。

最终代码在这里，以防它对遇到类似问题的任何人有用：

```
void trimMessage()
{
  int trimIndex;
  size_t msgSize = strlen(currMessage);

  char *newline = strchr(currMessage, '\n'); 
  if (!newline) return;
  trimIndex = newline - currMessage;

  // e.g.: "\fProgram started\r\nHow are you?\r".
  char *trimMessage = malloc(msgSize - trimIndex + 1);

  trimMessage[0] = '\f';
  strcpy(&trimMessage[1], &currMessage[trimIndex+1]);

  trimMessage[msgSize - trimIndex] = '\0';

  // Frees up the memory allocated to currMessage from last iteration
  // before assigning new memory.
  free(currMessage);
  currMessage = malloc(msgSize - trimIndex + 1);

  for(int i=0; i < msgSize - trimIndex; i++)
  {
    currMessage[i] = trimMessage[i];
  }

  currMessage[msgSize - trimIndex] = '\0';
  free(trimMessage);

  messageCount--;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T14:49:01.697

如果堆损坏或传递给它一个无效的指针，free 就会崩溃。

看着那个，我认为你的第一个 malloc 是几个字节短。您需要为空终止符保留一个字节，并且要复制到偏移量 1，因此您需要为此保留另一个字节。所以将会发生的是，您的副本将在下一个堆块开始时覆盖信息（通常用于下一个堆块的长度以及是否使用它的指示，但这取决于您的 RTL ）。

当您下一次执行 free 时，它​​可能会尝试合并任何空闲块。不幸的是，您已经损坏了下一个块的标题，此时它会变得有点疯狂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:58:45.143

比较这两行代码（当然，我已经重新调整了第二行）：

```
char *trimMessage = (char*)malloc((msgSize - trimIndex - 1) * sizeof(char));
      currMessage =        malloc((msgSize - trimIndex + 1) * sizeof(char)); 
```

除了强制转换方面的不必要差异（一致性很重要；您使用的两种样式中的哪一种无关紧要，但不要在同一代码中同时使用这两种样式）之外，长度上有 2 个字节的差异。第二个比第一个更可能是正确的。

在第一种情况下，您分配的 2 个字节太少，并且副本覆盖了一些`malloc()`等人依赖的控制信息，因此`free()`崩溃是因为您损坏了它管理的内存。

在这种情况下，问题不在于`strcpy()`计算错误。

破坏内存的问题之一是受害者代码（发现问题的代码）通常与导致问题的代码相距甚远。

* * *

这个循环：

```
for(int i=0; i < msgSize; i++)
{
  if(currMessage[i] == '\n')
  {
    trimIndex = i;
    break;
  }
} 
```

可以替换为：

```
char *newline = strchr(currMessage, '\n');
if (newline == 0)
    ...deal with no newline in the current messages...
trimIndex = newline - currMessage; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:02:39.400

在调用之前添加此代码`malloc()`：

```
// we need the destination buffer to be large enough for the '\f' character, plus
//      the remaining string, plus the null terminator
printf("Allocating: %d  Need: %d\n", (msgSize - trimIndex - 1), 1 + strlen(&currMessage[trimIndex+1]) + 1); 
```

我认为它会告诉你问题。

一次又一次地证明，手动计算缓冲区大小可能容易出错。有时您必须这样做，但有时您可以让函数处理那些容易出错的方面：

```
// e.g.: "\fProgram started\r\nHow are you?\r".
char *trimMessage = strdup( &currMessage[trimIndex]);

if (trimMessage && (trimMessage[0] == '\n')) {
    trimMessage[0] = '\f';
} 
```

如果您的运行时没有`strdup()`，它很容易实现（[http://snipplr.com/view/16919/strdup/](http://snipplr.com/view/16919/strdup/)）。

作为最后的编辑，这里有一个替代方案，`trimMessage()`我认为它是等价的：

```
void trimMessage()
{
  char *newline = strchr(currMessage, '\n'); 
  if (!newline) return;

  memmove( currMessage, newline, strlen(newline) + 1);

  currMessage[0] = '\f';    // replace '\n'

  messageCount--;
} 
```

# ruby - 从 Heroku 应用程序中访问当前的 git 提交号

> ID：12217645
> 
> 赞同：6
> 
> 时间：2012-08-31T14:41:00.437
> 
> 标签：ruby, git, heroku, sinatra, buildpack

我知道[slug 编译器](https://devcenter.heroku.com/articles/slug-compiler)在创建 heroku slug 时会删除`.git`目录，但是有没有办法配置 Heroku，以便我可以从我的脚本中访问当前正在运行的 git 提交号？

我希望能够在我的 sinatra 应用程序（在 Heroku 中运行）上有一个小链接，上面写着“运行[版本 e72fb274a0](http://link.to/commit/e72fb274a0e72fb274a0e72fb274a0e72fb274a037502be7) ”（或类似的东西）。如何检索它，或强制 slug 编译器将其添加到环境变量中？

**进步：**

我认为最好的方法是制作一个自定义 buildpack，在删除 .git 目录之前将 git commit 版本号写入 heroku slug。

我已经尝试过这样做（请参阅[我的 ruby​​ buildpack 的分支](https://github.com/jphastings/heroku-buildpack-ruby)），但我添加的行 -[第 23 行](https://github.com/jphastings/heroku-buildpack-ruby/blob/master/Rakefile#L23)- 似乎没有完成这项工作。Heroku 看到并使用了新的 buildpack，但似乎没有将文件写入 slug。

任何人都知道为什么我的自定义 buildpack 没有按预期工作？

谢谢，

J.P

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-02-25T12:20:52.017

几个选项...

# `SOURCE_VERSION`环境变量*（构建时）*

自 2015 年 4 月 1 日起，有一个`SOURCE_VERSION`环境变量可用于在 Heroku 上运行的构建。对于 git-pushed 构建，这是正在构建的源的 git commit SHA-1：

[https://devcenter.heroku.com/changelog-items/630](https://devcenter.heroku.com/changelog-items/630)

*（感谢@srtech[指出这一点](https://stackoverflow.com/a/29425999/438886)！）*

[我在构建中使用该变量](https://github.com/guardian/gu-who/blob/3e453c6/build.sbt#L11)的示例- 如果您查看部署的应用程序提供的 HTML，您会看到提交 ID 出现在最底部附近的 HTML 注释中：[https://gu-who。 herokuapp.com/](https://gu-who.herokuapp.com/)

# `/etc/heroku/dyno`元数据文件*（运行时）*

Heroku 具有**beta**功能，可以将`/etc/heroku/dyno`元数据文件写入正在运行的测功机上。如果您通过电子邮件发送支持，您可能会被添加到测试版中。这是 Heroku 自己使用它的地方：

[https://github.com/heroku/fix/blob/6c8ab7a/lib/heroku_dyno_metadata.rb](https://github.com/heroku/fix/blob/6c8ab7a/lib/heroku_dyno_metadata.rb)

内容如下所示：

```
{
   "dyno":{
      "physical_id":"161bfad9-9e83-40b7-b385-78305db2f168",
      "size":1,
      "name":"run.7145"
   },
   "app":{
      "id":null
   },
   "release":{
      "id":50,
      "commit":"2c3a0b24069af49b3de35b8e8c26765c1dba9ff0",
      "description":null
   }
} 
```

..`release.commit`你所追求的领域也是如此。我曾经使用这种方法，直到`SOURCE_VERSION`变量可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-02T16:50:09.010

在 2018 年，这就是您想要的： [https ://devcenter.heroku.com/articles/dyno-metadata](https://devcenter.heroku.com/articles/dyno-metadata)

```
heroku labs:enable runtime-dyno-metadata -a <app name> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:06:23.080

您可以在部署存储此信息之前运行脚本（可能在 YAML 上）

使用这些 a = `ls` （注意不是'“撇号”符号是 `“inverse accute” 符号）
a 变量将具有此 bash 命令的结果，
因此您可以执行 git = `git log` 然后找到您想要的信息并存储它。因此，您以后可以检索它。

这有帮助吗？

# javascript - 有一些关于 Javascript 继承的东西我无法理解

> ID：12217648
> 
> 赞同：4
> 
> 时间：2012-08-31T14:41:09.990
> 
> 标签：javascript, prototype, prototype-programming, prototypal-inheritance

我正在阅读来自 Mozilla 开发者网络[的面向对象 JavaScript 简介](https://developer.mozilla.org/en-US/docs/Introduction_to_Object-Oriented_JavaScript)，是时候在开始使用 node.js 之前学习如此严肃的 Javascript。

无论如何，继承对我来说似乎很模糊。从文档中复制并粘贴：

```
// define the Person Class
function Person() {}

Person.prototype.walk = function(){
  alert ('I am walking!');
};
Person.prototype.sayHello = function(){
  alert ('hello');
}; 
```

这很容易，但是`Student`继承会使事情变得复杂。有没有其他人认为以下三个陈述本质上做同样的事情？

```
// define the Student class
function Student() {
  // Call the parent constructor
  Person.call(this);
}

// inherit Person
Student.prototype = new Person();

// correct the constructor pointer because it points to Person
Student.prototype.constructor = Student; 
```

我理解第一个（调用父构造函数），因为它与 Java、PHP 等非常相似。但随后问题开始了。

为什么需要调用`Student.prototype` ~~and`Student.prototype.constructor`~~？

需要一个明确的解释。为什么这个代码：

```
// define the Student class
function Student() {
  // Call the parent constructor
  Person.call(this);
}

var student1 = new Student(); 
```

继承还不够吗？

**编辑**：关于构造函数，这里已经回答[了](https://stackoverflow.com/questions/8453887/why-is-it-necessary-to-set-the-prototype-constructor)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:58:44.973

这不起作用：

```
function Student() {
  Person.call(this);
}

var student1 = new Student(); 
```

因为的原型属性在实例`Person`上不可用。仅使用特定值（即实例）调用。但是这个函数是完全空的——所以在这里它什么都不做。除了无用的呼叫之外，没有其他任何关系。`Student``Person.call(this)``Person``this``Student``Person``Student``Person``Person`

要获得`Person`的功能，`.prototype`分配是必要的。

前：

```
<a Student instance>
  its prototype: Student.prototype, with all student functions
    its prototype: Object.prototype 
```

后：

```
<a Student instance>
  its prototype: <a Person instance>, with all student functions if you add them
    its prototype: Person.prototype, with all person functions
      its prototype: Object.prototype 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:50:06.183

如果您使用的是 Node.js，我建议您研究 ECMAScript 5 对象创建方法。[MDN 有一个页面在这里可能是一个很好的指南](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Inheritance_Revisited)。另请参阅[John Resig](http://ejohn.org/blog/ecmascript-5-objects-and-properties/)对新方法的概述。当来自像 Java 这样的经典 OO 语言时，很难理解原型继承。祝你好运！

# actionscript-3 - AS3 计算特定坐标内的 TUIO 点

> ID：12217649
> 
> 赞同：2
> 
> 时间：2012-08-31T14:41:16.603
> 
> 标签：actionscript-3, tracking, kinect, counting

我正在使用 Kinect 为 LED 地板编写一个 Flash 应用程序来跟踪 tuio 点。互动分为三个区域。当特定区域的 tuio 点数比任何其他区域多时，它会向另一个应用程序发送消息，触发照片流（现在不重要）...

我想知道计算这些点的最佳方法是什么。三个不同的容器可以做到吗？如果是这样，每个容器如何有效地“包含”这些点。我正在考虑绘制三个不同的矩形并创建某种函数来计算每个矩形坐标内的点。我只是无法真正了解如何将某些点与特定区域或 DisplayObject 结合。

有什么想法吗？谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:05:07.230

将点放在另一个容器中就像将弹珠放在气球中一样；点会移动，但气球的边界会伸展以容纳弹珠。除非这是您正在寻找的行为，否则不要将点作为矩形的父级。

假设矩形的特定布局，您的目标是计算重叠每个矩形的点数。虽然您当然可以走几何/三角计算的路线来确定重叠（如果您的几何更复杂，例如三角形或 n 边对象），您可能只需使用[getObjectsUnderPoint()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/IChildList.html#getObjectsUnderPoint%28%29)和[Point就可以摆脱帧堆栈对象](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/geom/Point.html)..

```
var point:Point = new Point(tuioX, tuioY);
var stack:Array = getObjectsUnderPoint(point); 
```

检查 3 个区域中每个区域的数组，您就会得到答案。:)

# json.net - Metro 风格应用程序：JSON 对象反序列化错误、REST 服务

> ID：12217651
> 
> 赞同：0
> 
> 时间：2012-08-31T14:41:17.290
> 
> 标签：json.net, deserialization, bing-maps

> 元素“:item”包含映射到名称“http://schemas.microsoft.com/search/local/ws/rest/v1:Route”的类型的数据。反序列化器不知道映射到此名称的任何类型。考虑使用 DataContractResolver 或将与“Route”对应的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将其添加到已知类型列表中传递给 DataContractSerializer 的类型。

* * *

添加 [DataContract(Namespace = "http://schemas.microsoft.com/search/local/ws/rest/v1", Name = "Location")] ro Resource 类后，我得到了这个异常：

期待状态'元素'..遇到名称为''，命名空间''的'文本'

* * *

[链接： http](http://dev.virtualearth.net/REST/V1/Routes?wp.0=37.779160067439079,-122.42004945874214&wp.1=32.715685218572617,-117.16172486543655&key=BingMapsKey) ://dev.virtualearth.net/REST/V1/Routes?wp.0=37.779160067439079,-122.42004945874214&wp.1=32.715685218572617,-117.16172486543655&key=BingMapsKey

```
 [KnownType(typeof(double[]))]
    [DataContract]
    public class ActualEnd
    {
        [DataMember(Name = "type")]
        public string type { get; set; }
        [DataMember(Name = "coordinates")]
        public List<double> coordinates { get; set; }
    }

    [KnownType(typeof(double[]))]
    [DataContract]
    public class ActualStart
    {
        [DataMember(Name = "type")]
        public string type { get; set; }
        [DataMember(Name = "coordinates")]
        public List<double> coordinates { get; set; }
    }

    [KnownType(typeof(int[]))]
    [KnownType(typeof(string[]))]
    [DataContract]
    public class Detail
    {
        [DataMember(Name = "compassDegrees")]
        public int compassDegrees { get; set; }
        [DataMember(Name = "endPathIndices")]
        public List<int> endPathIndices { get; set; }
        [DataMember(Name = "maneuverType")]
        public string maneuverType { get; set; }
        [DataMember(Name = "mode")]
        public string mode { get; set; }
        [DataMember(Name = "roadType")]
        public string roadType { get; set; }
        [DataMember(Name = "startPathIndices")]
        public List<int> startPathIndices { get; set; }
        [DataMember(Name = "names")]
        public List<string> names { get; set; }
    }

    [DataContract]
    public class Instruction
    {
        [DataMember(Name = "maneuverType")]
        public string maneuverType { get; set; }
        [DataMember(Name = "text")]
        public string text { get; set; }
    }

    [KnownType(typeof(double[]))]
    [DataContract]
    public class ManeuverPoint
    {
        [DataMember(Name = "type")]
        public string type { get; set; }
        [DataMember(Name = "coordinates")]
        public List<double> coordinates { get; set; }
    }

    [DataContract]
    public class Hint
    {
        [DataMember(Name = "hintType")]
        public object hintType { get; set; }
        [DataMember(Name = "text")]
        public string text { get; set; }
    }

    [KnownType(typeof(Detail[]))]
    [KnownType(typeof(Instruction))]
    [KnownType(typeof(Hint[]))]
    [KnownType(typeof(ManeuverPoint))]
    [KnownType(typeof(string[]))]
    [DataContract]
    public class ItineraryItem
    {
        [DataMember(Name = "compassDirection")]
        public string compassDirection { get; set; }
        [DataMember(Name = "details")]
        public List<Detail> details { get; set; }
        [DataMember(Name = "exit")]
        public string exit { get; set; }
        [DataMember(Name = "iconType")]
        public string iconType { get; set; }
        [DataMember(Name = "instruction")]
        public Instruction instruction { get; set; }
        [DataMember(Name = "maneuverPoint")]
        public ManeuverPoint maneuverPoint { get; set; }
        [DataMember(Name = "sideOfStreet")]
        public string sideOfStreet { get; set; }
        [DataMember(Name = "tollZone")]
        public string tollZone { get; set; }
        [DataMember(Name = "towardsRoadName")]
        public string towardsRoadName { get; set; }
        [DataMember(Name = "transitTerminus")]
        public string transitTerminus { get; set; }
        [DataMember(Name = "travelDistance")]
        public double travelDistance { get; set; }
        [DataMember(Name = "travelDuration")]
        public int travelDuration { get; set; }
        [DataMember(Name = "travelMode")]
        public string travelMode { get; set; }
        [DataMember(Name = "signs")]
        public List<string> signs { get; set; }
        [DataMember(Name = "hints")]
        public List<Hint> hints { get; set; }
    }

    [KnownType(typeof(ActualEnd))]
    [KnownType(typeof(ActualStart))]
    [KnownType(typeof(ItineraryItem[]))]
    [DataContract]
    public class RouteLeg
    {
        [DataMember(Name = "actualEnd")]
        public ActualEnd actualEnd { get; set; }
        [DataMember(Name = "actualStart")]
        public ActualStart actualStart { get; set; }
        [DataMember(Name = "itineraryItems")]
        public List<ItineraryItem> itineraryItems { get; set; }
        [DataMember(Name = "travelDistance")]
        public double travelDistance { get; set; }
        [DataMember(Name = "travelDuration")]
        public int travelDuration { get; set; }
    }

    [KnownType(typeof(RouteLeg[]))]
    [KnownType(typeof(double[]))]
    [DataContract(Namespace = "http://schemas.microsoft.com/search/local/ws/rest/v1", Name = "Location")]
    public class Resource
    {
        [DataMember(Name = "__type")]
        public string __type { get; set; }
        [DataMember(Name = "id")]
        public List<double> bbox { get; set; }
        public string id { get; set; }
        [DataMember(Name = "distanceUnit")]
        public string distanceUnit { get; set; }
        [DataMember(Name = "durationUnit")]
        public string durationUnit { get; set; }
        [DataMember(Name = "routeLegs")]
        public List<RouteLeg> routeLegs { get; set; }
        [DataMember(Name = "travelDistance")]
        public double travelDistance { get; set; }
        [DataMember(Name = "travelDuration")]
        public int travelDuration { get; set; }
    }

    [KnownType(typeof(Resource[]))]
    [DataContract]
    public class ResourceSet
    {
        [DataMember(Name = "estimatedTotal")]
        public int estimatedTotal { get; set; }
        [DataMember(Name = "resources")]
        public List<Resource> resources { get; set; }
    }

    [KnownType(typeof(ResourceSet[]))]
    [DataContract]
    public class RootObject
    {
        [DataMember(Name = "authenticationResultCode")]
        public string authenticationResultCode { get; set; }
        [DataMember(Name = "brandLogoUri")]
        public string brandLogoUri { get; set; }
        [DataMember(Name = "copyright")]
        public string copyright { get; set; }
        [DataMember(Name = "resourceSets")]
        public List<ResourceSet> resourceSets { get; set; }
        [DataMember(Name = "statusCode")]
        public int statusCode { get; set; }
        [DataMember(Name = "statusDescription")]
        public string statusDescription { get; set; }
        [DataMember(Name = "traceId")]
        public string traceId { get; set; }
    }

    public async void MakeRequest(string requestUrl)
    {
        try
        {
            HttpWebRequest request = WebRequest.Create(requestUrl) as HttpWebRequest;
            using (HttpWebResponse response = await request.GetResponseAsync() as HttpWebResponse)
            {
                if (response.StatusCode != HttpStatusCode.OK)
                    throw new Exception(string.Format(
                    "Server error(HTTP {0}:{1}.",
                    response.StatusCode,
                    response.StatusDescription));
                DataContractJsonSerializer jsonSerializer = new DataContractJsonSerializer(typeof(RootObject));
                object objResponse = jsonSerializer.ReadObject(response.GetResponseStream());
                root = (RootObject)objResponse;      
            }
        }
        catch (Exception ex)
        {
            ThrowException(ex);
        }
    } 
```

问题在这里：

```
 "estimatedTotal": 1,
  "resources": [
    {
      "__type": "Route:http:\/\/schemas.microsoft.com\/search\/local\/ws\/rest\/v1",
      "bbox": [
        32.715692,
        -122.420697,
        37.827532,
        -117.161052
      ], 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T12:12:14.403

看看这篇博文：[http ://rbrundritt.wordpress.com/2012/01/06/bing-maps-rest-service-net-libraries/](http://rbrundritt.wordpress.com/2012/01/06/bing-maps-rest-service-net-libraries/)

它具有序列化 REST 服务所需的所有库。对于您看到的错误，您需要创建一个名为 Route 的类并将其标记为资源类上的已知类型。

例如：

```
[DataContract]
[KnownType(typeof(Location))]
[KnownType(typeof(Route))]
public class Resource 
```

# android - Android 4.0 中的 RemoteControlClient 是什么？

> ID：12217652
> 
> 赞同：8
> 
> 时间：2012-08-31T14:41:18.347
> 
> 标签：android, android-4.0-ice-cream-sandwich

我知道 StackOverflow 的规则，因此事先为提出这样一个*主观问题而道歉。*

我尝试了[文档](http://developer.android.com/reference/android/media/RemoteControlClient.html)，但它说的是：

> RemoteControlClient 允许公开旨在由能够显示元数据、艺术品和媒体传输控制按钮的遥控器使用的信息。
> 
> 远程控制客户端对象与媒体按钮事件接收器相关联。在通过 registerRemoteControlClient(RemoteControlClient) 注册 RemoteControlClient 之前，此事件接收器必须先前已向 registerMediaButtonEventReceiver(ComponentName) 注册。

**我不知道其他人，但对我来说，这么多的文档对于像"RemoteControlClient"**这样一个很酷的名字来说是不够的。

我为此搜索了很多论坛，但不幸的是，我仍然不清楚这个概念。

如果有人帮助我理解它，它是如何工作的，最重要的是，它的全部功能，我将不胜感激。

提前感谢并道歉提出主观问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-31T14:49:05.357

[http://developer.android.com/about/versions/android-4.0.html](http://developer.android.com/about/versions/android-4.0.html)

> 新的 RemoteControlClient 允许媒体播放器启用来自远程控制客户端的播放控制，例如设备锁定屏幕。媒体播放器还可以公开有关当前正在播放的媒体的信息，以便在遥控器上显示，例如曲目信息和专辑封面。

以及有关该主题的更多段落。

它还指出：

> 有关示例实现，请参阅[Random Music Player](http://developer.android.com/resources/samples/RandomMusicPlayer/index.html)，它提供了兼容性逻辑，以便在 Android 4.0 设备上启用远程控制客户端，同时继续支持回到 Android 2.1 的设备。

# wpf - 强制验证绑定在 WPF 中未选择的 tabItems 上的控件的规则

> ID：12217653
> 
> 赞同：4
> 
> 时间：2012-08-31T14:41:20.183
> 
> 标签：wpf, validation, data-binding, wpf-controls

在我的规范示例中，我有两个选项卡，第一个带有按钮，第二个带有绑定到验证规则的文本框。单击按钮时会发生一个操作，该操作应导致验证失败，因此会触发 Validation.Error 事件。但是，该事件只会在我单击第二个选项卡时触发。

这对我来说如此重要的原因是我有一个跨多个选项卡发生复杂验证的表单，我想突出显示那些包含错误的选项卡 - 我特别想在表单首次加载时显示错误。

我已经使用[了一种技术](http://graemehill.ca/forcing-form-validation-in-wpf-before-user-input)来强制在表单加载时触发验证，但我只是不知道为什么当表单加载时它不会在单击按钮时触发。

我的测试用例的 XAML：

```
<Window x:Class="WpfApplication1.TabsDemo"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1"
        Title="Tabs" Height="300" Width="300" Validation.Error="Window_Error">

    <TabControl Grid.Row="0">
        <TabItem>
            <TabItem.Header>First</TabItem.Header>
                <StackPanel Margin="5">
                    <Button Click="Button_Click">Clear the second textbox</Button>
                </StackPanel>
        </TabItem>

        <TabItem>
            <TabItem.Header>MyDataItem</TabItem.Header>
            <TextBox>
                <TextBox.Text>
                    <local:ValidationBinding Path="MyDataItem" UpdateSourceTrigger="LostFocus">
                        <local:ValidationBinding.ValidationRules>
                            <local:ValidateText />
                        </local:ValidationBinding.ValidationRules>
                    </local:ValidationBinding>
                </TextBox.Text>
            </TextBox>
        </TabItem>
    </TabControl>
</Window> 
```

我背后的代码：

```
using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;

namespace WpfApplication1
{
    public partial class TabsDemo : Window
    {
        public TabsDemo()
        {
            InitializeComponent();
            DataContext = new MyViewModel();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            (DataContext as MyViewModel).MyDataItem = String.Empty;
        }

        private void Window_Error(object sender, ValidationErrorEventArgs e)
        {
            MessageBox.Show("Validation Error : " + e.Error.RuleInError);
        }
    }

    public class MyViewModel : INotifyPropertyChanged
    {       
        public event PropertyChangedEventHandler PropertyChanged;
        private string _myDataItem = "Default Value";
        public string MyDataItem
        {
            get { return _myDataItem; }
            set
            {
                if (_myDataItem != value)
                {
                    _myDataItem = value;
                    NotifyPropertyChanged(new PropertyChangedEventArgs("MyDataItem"));
                }
            }
        }

        private void NotifyPropertyChanged(PropertyChangedEventArgs args)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, args);
        }
    }
} 
```

为了完整起见，这里是验证绑定标记扩展：

```
using System;
using System.Collections.ObjectModel;
using System.Diagnostics;
using System.Globalization;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Markup;

namespace WpfApplication1
{
    public class ValidationBinding : MarkupExtension
    {
        private readonly Binding _binding = new Binding();
        private DependencyObject _dependencyObject;
        private DependencyProperty _dependencyProperty;

        public ValidationBinding()
        {
            _binding.ValidatesOnDataErrors = true;
            _binding.ValidatesOnExceptions = true;
            _binding.NotifyOnValidationError = true;
        }

        public ValidationBinding(string path)
        {
            _binding.Path = new PropertyPath(path);
        }

        public override object ProvideValue(IServiceProvider serviceProvider)
        {
            var valueTarget = serviceProvider.GetService(typeof(IProvideValueTarget)) as IProvideValueTarget;
            _dependencyObject = valueTarget.TargetObject as DependencyObject;
            _dependencyProperty = valueTarget.TargetProperty as DependencyProperty;

            var element = _dependencyObject as FrameworkElement;
            if (element != null)
            {
                if (element.IsLoaded)
                    ForceValidation();
                else
                    element.Loaded += (sender, args) => ForceValidation();
            }
            else
            {
                ForceValidation();
            }
            Debug.WriteLine("MarkupExtension.ProvideValue called for element " + element.Name);
            return _binding.ProvideValue(serviceProvider);
        }

        private void ForceValidation()
        {
            BindingOperations.GetBindingExpression(_dependencyObject, _dependencyProperty).UpdateSource();
        }

        public object FallbackValue
        {
            get { return _binding.FallbackValue; }
            set { _binding.FallbackValue = value; }
        }

        public string StringFormat
        {
            get { return _binding.StringFormat; }
            set { _binding.StringFormat = value; }
        }

        public object TargetNullValue
        {
            get { return _binding.TargetNullValue; }
            set { _binding.TargetNullValue = value; }
        }

        public string BindingGroupName
        {
            get { return _binding.BindingGroupName; }
            set { _binding.BindingGroupName = value; }
        }

        public Collection<ValidationRule> ValidationRules
        {
            get { return _binding.ValidationRules; }
        }

        public bool ValidatesOnExceptions
        {
            get { return _binding.ValidatesOnExceptions; }
            set { _binding.ValidatesOnExceptions = value; }
        }

        public bool ValidatesOnDataErrors
        {
            get { return _binding.ValidatesOnDataErrors; }
            set { _binding.ValidatesOnDataErrors = value; }
        }

        public PropertyPath Path
        {
            get { return _binding.Path; }
            set { _binding.Path = value; }
        }

        public string XPath
        {
            get { return _binding.XPath; }
            set { _binding.XPath = value; }
        }

        public BindingMode Mode
        {
            get { return _binding.Mode; }
            set { _binding.Mode = value; }
        }

        public UpdateSourceTrigger UpdateSourceTrigger
        {
            get { return _binding.UpdateSourceTrigger; }
            set { _binding.UpdateSourceTrigger = value; }
        }

        public bool NotifyOnSourceUpdated
        {
            get { return _binding.NotifyOnSourceUpdated; }
            set { _binding.NotifyOnSourceUpdated = value; }
        }

        public bool NotifyOnTargetUpdated
        {
            get { return _binding.NotifyOnTargetUpdated; }
            set { _binding.NotifyOnTargetUpdated = value; }
        }

        public bool NotifyOnValidationError
        {
            get { return _binding.NotifyOnValidationError; }
            set { _binding.NotifyOnValidationError = value; }
        }

        public IValueConverter Converter
        {
            get { return _binding.Converter; }
            set { _binding.Converter = value; }
        }

        public object ConverterParameter
        {
            get { return _binding.ConverterParameter; }
            set { _binding.ConverterParameter = value; }
        }

        public CultureInfo ConverterCulture
        {
            get { return _binding.ConverterCulture; }
            set { _binding.ConverterCulture = value; }
        }

        public object Source
        {
            get { return _binding.Source; }
            set { _binding.Source = value; }
        }

        public RelativeSource RelativeSource
        {
            get { return _binding.RelativeSource; }
            set { _binding.RelativeSource = value; }
        }

        public string ElementName
        {
            get { return _binding.ElementName; }
            set { _binding.ElementName = value; }
        }

        public bool IsAsync
        {
            get { return _binding.IsAsync; }
            set { _binding.IsAsync = value; }
        }

        public object AsyncState
        {
            get { return _binding.AsyncState; }
            set { _binding.AsyncState = value; }
        }

        public bool BindsDirectlyToSource
        {
            get { return _binding.BindsDirectlyToSource; }
            set { _binding.BindsDirectlyToSource = value; }
        }

        public UpdateSourceExceptionFilterCallback UpdateSourceExceptionFilter
        {
            get { return _binding.UpdateSourceExceptionFilter; }
            set { _binding.UpdateSourceExceptionFilter = value; }
        }
    }
} 
```

# python - python - 返回函数时装饰器位置之间的差异

> ID：12217660
> 
> 赞同：-1
> 
> 时间：2012-08-31T14:41:40.713
> 
> 标签：python, decorator

装饰器的这两个位置之间有区别吗？

```
def a():
    @decorator_function # HERE
    def b():
        pass
    return b

@decorator_function # OR HERE ?
c = a() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T14:43:04.323

你试过这个吗？第二个不是有效的语法。所以是的，区别在于第一个有效，第二个无效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:56:37.147

正如 BrenBren 所说，您的代码不起作用。无论如何，首先，装饰器语法只是语法糖。

```
@deco
def func():
    pass 
```

相当于

```
def func():
    pass
func = deco(func) 
```

所以即使假设语法正确，第一个例子是装饰封闭的函数`b()`，而第二个例子是装饰闭包`a()`。所以：

```
@deco
def a():
    def b():
        pass 
```

是相同的

```
def a():
    def b():
        pass
a = deco(a) 
```

和

```
def a():
    @deco
    def b():
        pass 
```

是相同的

```
def a():
    def b():
        pass
    b = deco(b) 
```

# c++ - opencv 错误：当我校准相机时，convert.cpp (opencv) 中的断言失败

> ID：12217666
> 
> 赞同：1
> 
> 时间：2012-08-31T14:42:03.117
> 
> 标签：c++, visual-studio-2010, opencv, windows-7, camera-calibration

我尝试校准相机（opencv 2.3.1、VS 2010 和 Windows 7），但是当我编译我的程序时，出现一个 opencv 错误

> “断言失败：<src.size==dst.size && src.channels<>dst.channels<>> 在未知函数中，文件 ....modules \core\src\convert.cpp，第 1277 行”。

这里是代码的一部分，

```
CvMat* image_points      = cvCreateMat(n_boards*board_total,2,CV_32FC1);
CvMat* object_points     = cvCreateMat(n_boards*board_total,3,CV_32FC1);
CvMat* point_counts      = cvCreateMat(n_boards,1,CV_32SC1);
CvMat* intrinsic_matrix  = cvCreateMat(3,3,CV_32FC1);
CvMat* distortion_coeffs = cvCreateMat(4,1,CV_32FC1);

for ( int ig = 0; ig< n_boards; ig++ ) 
{ 

image= cvLoadImage(names[ig],CV_LOAD_IMAGE_COLOR);  // load image

cvNamedWindow("imageessai", 1);
cvShowImage("imageessai", image);
cvWaitKey(0);
cvDestroyWindow("imageessai");

for (int ik=0; ik<n_boards; ik++)

{       
int found = cvFindChessboardCorners(image, board_sz, corners,        &corner_count,CV_CALIB_CB_ADAPTIVE_THRESH | CV_CALIB_CB_FILTER_QUADS );
cvFindCornerSubPix(gray_image, corners, corner_count, cvSize(11,11),cvSize(-1,-1), cvTermCriteria( CV_TERMCRIT_ITER+CV_TERMCRIT_EPS, 30, 0.1 ));
cvDrawChessboardCorners(image, board_sz, corners, corner_count, found); 

        if( corner_count == board_total ) 
        {

            step= ig*board_total;
            for( int i=step,j=0  ; j<board_total; j++, i++)
                        {

        CV_MAT_ELEM(*image_points, float,i,0) = corners[j].x;
        CV_MAT_ELEM(*image_points, float,i,1) = corners[j].y;
        CV_MAT_ELEM(*object_points,float,i,0) = (float) j/board_w;
        CV_MAT_ELEM(*object_points,float,i,1) = (float) (j%board_w);
        CV_MAT_ELEM(*object_points,float,i,2)=0.0f;
                            }

        CV_MAT_ELEM (*point_counts, int,ig,0) = board_total;  

    printf("\n %d successful Snapshots out of %d collected.\n",ig+1,n_boards);

            }   
    } 

CvMat* object_points2  = cvCreateMat(n_boards*board_total,3,CV_32FC1);
CvMat* image_points2   = cvCreateMat(n_boards*board_total,2,CV_32FC1);
CvMat* point_counts2   = cvCreateMat(n_boards,1,CV_32SC1);

for(int i = 0; i<n_boards*board_total; ++i)
{
  CV_MAT_ELEM( *image_points2, float, i, 0) =CV_MAT_ELEM( *image_points, float, i, 0);
  CV_MAT_ELEM( *image_points2, float,i,1)  =CV_MAT_ELEM( *image_points, float, i, 1);
  CV_MAT_ELEM(*object_points2, float, i, 0) = CV_MAT_ELEM(*object_points, float, i,0) ;
  CV_MAT_ELEM( *object_points2, float, i, 1)= CV_MAT_ELEM(*object_points, float, i,1) ;
  CV_MAT_ELEM( *object_points2, float, i, 2)= CV_MAT_ELEM(*object_points, float, i,2) ;
} 

for(int i=0; i<n_boards; ++i)
{ 
    CV_MAT_ELEM( *point_counts2, int, i, 0)=CV_MAT_ELEM(*point_counts,int,i,0);         

}
cvReleaseMat(&object_points);
cvReleaseMat(&image_points);
cvReleaseMat(&point_counts);

CV_MAT_ELEM( *intrinsic_matrix, float, 0, 0 ) = 1.0f;
CV_MAT_ELEM( *intrinsic_matrix, float, 1, 1 ) = 1.0f;
CvMat* rvec = cvCreateMat(n_boards,3,CV_32F);//matrice de rotation
CvMat* tvec = cvCreateMat(n_boards,3,CV_32F);//matrice de translation
CvMat* H = cvCreateMat(1,3,CV_32FC1);

cvCalibrateCamera2(object_points2, image_points2, point_counts2,  sizeim, intrinsic_matrix, distortion_coeffs, rvec, tvec,0 );

cvFindHomography(object_points2,image_points2,H,0,3,NULL); 
```

我试图解决这个问题很多次，请我需要帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:42:09.537

（我打开我的评论作为答案，因为 Nabiha 可能无法用 1 个代表回答评论。）

您似乎将错误类型（错误数量的通道）的图像传递给 cv 函数之一。从你的描述很难说，但我猜它发生在 cvCalibrateCamera2 或 cvFindHomograpy 中。

断言听起来也像是运行时错误，而不是编译时错误。

如果是运行时错误，则必须检查传递给这些函数的图像是否具有正确的设置（通道、相同大小等）。这是编译器无法为您检查的，因为这些参数是动态的。

您可以有条不紊地注释一些函数（以调试您的代码）并查看您的程序是否仍然有效，以防您无法通过调试器找出代码在哪里中断。隔离调用后，请检查文档以了解它期望的图像参数，您应该在正确的轨道上解决这个问题。

校准是一个多步骤过程（抓取图像、提取特征、计算单应性、计算相机的内在和外在参数）。理解（数学方面）也很棘手，所以不要放弃。OpenCV 校准功能通常工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T22:40:39.717

调试按钮未激活，解决方案项目的重新扫描按钮未激活，因此无法编译或调试程序示例\cpp\calibration.cpp

# android - 为什么我的微调器看起来不像微调器？

> ID：12217668
> 
> 赞同：4
> 
> 时间：2012-08-31T14:42:04.583
> 
> 标签：android, android-layout, android-spinner

我有一个看起来非常丑陋的微调器，如下所示： [![这是我的形象](../Images/9055b4f2d28ebe4fee1b1dd9ee6c1946.png)](https://i.stack.imgur.com/VidLr.png)

当我点击它看起来好一点： [![这是我的形象](../Images/89ef1c498088badbf8efb5bdf74eeb93.png)](https://i.stack.imgur.com/KZ0gN.png)

但是，在默认情况下，它甚至看起来都不像一个微调器。知道如何改善它的外观吗？

这是代码：

```
adapter=new SpinAdapter(this,com.Orange.R.layout.spinnerrowlist,spinnerInfo);
adapter.setDropDownViewResource(com.Orange.R.layout.multiline_spinner_dropdown_item);
previousVisitCommentsSpinner.setAdapter(adapter); 
```

**spinnerrowlist.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="5dp"
    android:layout_marginRight="5dp"
    android:background="#FFFFFF"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/textview_spinner1"
        style="?android:attr/spinnerItemStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:paddingLeft="5dp"
        android:layout_alignParentLeft="true"
        android:textColor="@drawable/textorange_selected" />

    <TextView
        android:id="@+id/textview_spinner2"
        style="?android:attr/spinnerItemStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="5dp"
        android:layout_toRightOf="@+id/textview_spinner1"
        android:paddingLeft="5dp"
        android:textColor="@drawable/textorange_selected" />

    <TextView
        android:id="@+id/textview_spinner3"
        style="?android:attr/spinnerItemStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:paddingLeft="5dp"
        android:textColor="@drawable/textorange_selected" />

</RelativeLayout> 
```

这是微调器：

```
<Spinner
    android:id="@+id/previousVisitComments"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="10dp"
    android:layout_below="@+id/previousvisit"
    android:layout_marginTop="15dp"
    android:background="@drawable/spinner_selector"
    android:textColor="@color/medium_orange"
    android:textAppearance="?android:attr/textAppearanceMedium"
    /> 
```

**微调器中的项目应该在同一行，这就是我使用水平布局的原因！** 谢谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:25:41.277

> 微调器中的项目应该在同一行，这就是我使用水平布局的原因！

问题是您正试图将大量文​​本压缩到一个狭窄的区域。但是，您有两种选择：

**首先**使用你所拥有的，只需将`layout_toLeftOf`属性添加到`textview_spinner2`：

```
<TextView
    android:id="@+id/textview_spinner2"
    style="?android:attr/spinnerItemStyle"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="5dp"
    android:layout_toLeftOf="@+id/textview_spinner3"
    android:layout_toRightOf="@+id/textview_spinner1"
    android:paddingLeft="5dp" /> 
```

您还说您正在使用`a horizontal layout`但 RelativeLayout 没有属性`orientation`，所以这一行什么都不做：

```
android:orientation="horizontal" 
```

子元素的组织由各个属性决定，例如：`layout_toLeftOf`、`layout_toRightOf`、`layout_above`等。

**其次**，如果您的 RelativeLayout 表现得不守规矩，并且您有一个像这样的简单布局，您可以随时切换到 LinearLayout：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="5dp"
    android:layout_marginRight="5dp" >

    <TextView
        android:id="@+id/textview_spinner1"
        style="?android:attr/spinnerItemStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="0"
        android:textColor="@drawable/textorange_selected" />

    <TextView
        android:id="@+id/textview_spinner2"
        style="?android:attr/spinnerItemStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:paddingLeft="5dp"
        android:textColor="@drawable/textorange_selected" />

    <TextView
        android:id="@+id/textview_spinner3"
        style="?android:attr/spinnerItemStyle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="0"
        android:paddingLeft="5dp"
        android:textColor="@drawable/textorange_selected" />

</LinearLayout> 
```

现在 Spinner 中的所有列都没有重叠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T01:50:09.987

您可以在 Java 代码中尝试 (android.R.layout.simple_spinner_dropdown_item)。而不是这个（com.Orange.R.layout.multiline_spinner_dropdown_item）希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:03:55.407

尝试添加这个

```
android:layout_toRightOf="@+id/textview_spinner1 
```

您还可以添加以下内容以查看是否有所不同

```
android:layout_below 
```

让我知道情况如何:)

# django - Django - 时间范围小部件

> ID：12217675
> 
> 赞同：2
> 
> 时间：2012-08-31T14:42:27.157
> 
> 标签：django, jquery-ui, jquery-ui-slider, django-widget

我想使用[jQueryUI Slider](http://jqueryui.com/demos/slider/#range-vertical)作为允许配置营业时间的小部件。

所以我做了这个模型：

```
WEEKDAYS = [
  (1, _("Monday")),
  (2, _("Tuesday")),
  (3, _("Wednesday")),
  (4, _("Thursday")),
  (5, _("Friday")),
  (6, _("Saturday")),
  (7, _("Sunday")),
]

class OpeningHours(models.Model)
    comp = models.ForeignKey('Company')
    weekday = models.IntegerField(choices=WEEKDAYS, unique=True)
    from_hour = models.TimeField()
    to_hour = models.TimeField()

class Company(models.Model):
    name = models.CharField(max_length=100)
    logo = models.FileField(upload_to='company_logos') 
```

我知道执行控制器的标记，例如：

```
<div class="slider-block">
    <div class="slider-end">18:00</div>
    <div class="slider"></div>
    <div class="slider-start">08:00</div>
    <div class="slider-day">Tue</div>
</div> 
```

这给出了类似的东西（带有一些额外的 css/js）

![在此处输入图像描述](../Images/a16d2487d22b60dd19f21ebf116cbd95.png)

但我无法将它实现为表单小部件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T07:09:21.980

感谢@YujiTomita 的评论，这是我的解决方案：

基本思想是生成一个带有隐藏输入的表单集，其中之一是调用一些 css/javascript。
并且 javascript 将填充这些值。

**小部件**

```
class OpeningHoursWidget(forms.HiddenInput):
    class Media:
        js = (
            'https://ajax.googleapis.com/[...]jquery-ui.min.js',
            'js/business_hours.js',
        )
        css = {'all': (
            'https://ajax.googleapis.com/[...]jquery-ui.custom.css',
            'css/business_hours.css',
        )} 
```

**形式**

```
class UserOpeningHoursForm(forms.ModelForm):
    class Meta:
        model = OpeningHours
        fields = ('weekday', 'from_hour', 'to_hour')
        widgets = {
            'weekday': forms.HiddenInput(attrs={'class': 'hours-weekday'}),
            'from_hour': OpeningHoursWidget(attrs={'class': 'hours-start'}),
            'to_hour': forms.HiddenInput(attrs={'class': 'hours-end'}),
        } 
```

**看法**

```
UserOpeningHoursFormSet = formset_factory(UserOpeningHoursForm, extra=0)
obj['formset'] = UserOpeningHoursFormSet(initial=hours) 
```

**模板**

```
 <div id="slider-block-hidden">
        <div class="slider-end"></div>
        <div class="slider"></div>
        <div class="slider-start"></div>
        <div class="slider-day"></div>
    </div>
{{ formset.media }}
{% for hours in formset %}
    <div class="slider-block">
    {{ hours }}
    </div>
{% endfor %} 
```

**javascript**（带 jquery）

```
$(function() {
    days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    $('.slider-block').each(function () {
        start = $(this).find('.hours-start').val();
        end = $(this).find('.hours-end').val();
        day_id = $(this).find('.hours-weekday').val();
        hidden_slider = $('#slider-block-hidden').clone();
        $(this).append(hidden_slider.find('.slider-end').text(end));
        $(this).append((slider = hidden_slider.find('.slider')));
        $(this).append(hidden_slider.find('.slider-start').text(start));
        $(this).append(hidden_slider.find('.slider-day').text(days[day_id]));
        slider.slider({
            orientation: "vertical",
            range: true,
            min: 0,
            max: 1440,
            step: 15,
            values: [ ttm(start), ttm(end) ],
            slide: function( event, ui ) {
                $(this).siblings('.slider-start').text(mtt(ui.values[0]));
                $(this).siblings('.slider-end').text(mtt(ui.values[1]));
            }
        });
    });
}); 
```

`ttm()`并且`mtt()`是用于分钟时间转换/格式化的函数

**css**

```
#slider-block-hidden {
    display: none;
}

.slider-block {
    text-align: center;
    display: inline-block;
    margin: 10px;
}

.slider {
    margin: 10px;
    height: 150px;
} 
```

也许有一种方法可以对小部件的渲染进行子类化以避免大量的 javascript。

# java - 我该如何拆分这个？

> ID：12217678
> 
> 赞同：3
> 
> 时间：2012-08-31T14:42:29.910
> 
> 标签：java, split

我想在java中拆分函数。但是效果不好。

```
 String mystring = "ersin#$gulbahar#$ev";
 String [] scripts=  mystring.split("#$"); //it does not split. 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T14:44:09.037

```
String mystring = "ersin#$gulbahar#$ev";
String[] scripts = mystring.split("#\\$");
System.out.println(Arrays.toString(scripts)); 
```

**输出：**

```
[ersin, gulbahar, ev] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:45:26.537

试试这个：

```
mystring.split("#\\$") 
```

split 方法使用正则表达式来拆分文本，$ 字符在正则表达式中具有其他含义

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:47:29.470

`split`以正则表达式为参数，`$`是正则表达式中的特殊字符，意思是“匹配字符串的结尾”。

由于您要匹配文字`$`，而不是字符串的结尾，因此您需要使用反斜杠对其进行转义：`mystring.split("#\\$");`应该可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:44:12.460

在您的表达式中转义 $： split() 将正则表达式作为参数！常见问题...

# sharepoint - 使用 VBA 打开 Sharepoint Excel 文件

> ID：12217680
> 
> 赞同：1
> 
> 时间：2012-08-31T14:42:35.790
> 
> 标签：sharepoint, excel, vba

我在 Excel 中使用 VBA 循环浏览共享点站点上的文件并打开所有 Excel 文件。

该代码在我第一次运行 Excel 时会崩溃，但是，如果我随后重新打开它，它就可以正常工作。

是否有任何已知问题？

谢谢。

编辑：这是代码：

```
Sub Refresh()

    With Application
        .ScreenUpdating = False
        .DisplayAlerts = False

        Dim fso As FileSystemObject
        Dim fldr As Folder
        Dim f As File
        Dim wb As Workbook

        Set fso = New FileSystemObject
        Set fldr = fso.GetFolder(SharePointSite)

        For Each f In fldr.Files

            Set wb = Workbooks.Open(SharePointURL & f.Name)

        Next f

        Set wb = Nothing
        Set fldr = Nothing
        Set fso = Nothing

        .DisplayAlerts = True
        .ScreenUpdating = True
    End With

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-09T14:01:01.707

尝试使用 WebDAV 地址访问代码中的库，而不是将文档库映射到驱动器号。这样，如果宏被分发，没有人将依赖于将“Z：”驱动器映射到特定位置

将您的 FilePath 变量设置为等于这样的字符串（对 HTTPS 站点使用 @SSL）：

`\\sharepoint.site.com@SSL\DavWWWRoot\site1\usersite\Book2\Shared%20Documents`

如果您要直接访问文本文件，请按如下方式设置：

`\\sharepoint.site.com@SSL\DavWWWRoot\site1\usersite\Book2\Shared%20Documents \Test_Text1.txt`

请查看[此博客文章](http://whitepages.unlimitedviz.com/2010/12/unc-path-naming-for-files-stored-on-sharepoint-2/)以获取有关检索 WebDAV 路径的完整说明。

# android - 带有 AndroidFragments 的 onSaveInstanceState 上的 NullPointerException

> ID：12217681
> 
> 赞同：6
> 
> 时间：2012-08-31T14:42:37.617
> 
> 标签：android, nullpointerexception, android-fragments

当我离开 FragmentActivity 并转到 ListActivity 时，我收到 NullPointerException。在我得到强制关闭之前，我实际上开始看到列表。但是 LogCat 指的是我刚刚来自的 Activity。

LogCat 是这样说的：

```
08-31 07:38:53.356: E/AndroidRuntime(8134): FATAL EXCEPTION: main
08-31 07:38:53.356: E/AndroidRuntime(8134): java.lang.NullPointerException
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.support.v4.app.FragmentManagerImpl.saveFragmentBasicState(FragmentManager.java:1576)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.support.v4.app.FragmentManagerImpl.saveAllState(FragmentManager.java:1617)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.support.v4.app.FragmentActivity.onSaveInstanceState(FragmentActivity.java:481)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at com.---.myApp.MasterCat.onSaveInstanceState(MasterCat.java:119)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.Activity.performSaveInstanceState(Activity.java:1137)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.Instrumentation.callActivityOnSaveInstanceState(Instrumentation.java:1215)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.ActivityThread.performStopActivityInner(ActivityThread.java:3077)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.ActivityThread.handleStopActivity(ActivityThread.java:3136)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.ActivityThread.access$900(ActivityThread.java:142)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1235)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.os.Looper.loop(Looper.java:137)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at android.app.ActivityThread.main(ActivityThread.java:4928)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at java.lang.reflect.Method.invokeNative(Native Method)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at java.lang.reflect.Method.invoke(Method.java:511)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
08-31 07:38:53.356: E/AndroidRuntime(8134):     at dalvik.system.NativeStart.main(Native Method) 
```

MasterCat 中的第 119 行是：

```
@Override
public void onSaveInstanceState(Bundle savedInstanceState) {
    super.onSaveInstanceState(savedInstanceState);
} 
```

我不确定要显示什么其他代码，请告诉我。我的基本设置包含 4 个静态内部类，它们都是父级内部的所有片段`FragmentActivity`（使用支持库）。它使用标签和viewpager。

编辑，更多代码：

```
public class MasterCat extends FragmentActivity implements
        ActionBar.TabListener {

    SectionsPagerAdapter mSectionsPagerAdapter;
    ViewPager mViewPager;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragment_layout);
        mSectionsPagerAdapter = new SectionsPagerAdapter(
                getSupportFragmentManager());
        final ActionBar actionBar = getActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        mViewPager = (ViewPager) findViewById(R.id.viewpager);
        mViewPager.setAdapter(mSectionsPagerAdapter);
        mViewPager
                .setOnPageChangeListener(
                    new ViewPager.SimpleOnPageChangeListener() {

                    @Override
                    public void onPageSelected(int position) {
                        actionBar.setSelectedNavigationItem(position);
                    }
                });
        for (int i = 0; i < mSectionsPagerAdapter.getCount(); i++) {
            actionBar.addTab(actionBar.newTab()
                    .setText(mSectionsPagerAdapter.getPageTitle(i))
                    .setTabListener(this));
        }
    }

    public void onTabUnselected(ActionBar.Tab tab,
            FragmentTransaction fragmentTransaction) {}

    @Override
    public void onSaveInstanceState(Bundle savedInstanceState) {
        super.onSaveInstanceState(savedInstanceState);
    }

    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);
    }

    public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
        mViewPager.setCurrentItem(tab.getPosition());
    }

    public void onTabReselected(ActionBar.Tab tab,
            FragmentTransaction fragmentTransaction) {}

    public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            Fragment f = null;
            switch (position) {
            case 0:
            {
                f = new MasterFrag();
                Bundle args = new Bundle();
                f.setArguments(args);
                break;
            }
            case 1:
            {
                f = new FeaturedFrag();
                Bundle args = new Bundle();
                f.setArguments(args);
                break;
            }
            case 2:
            {
                f = new TopFrag();
                Bundle args = new Bundle();
                f.setArguments(args);
                break;
            }
            case 3:
            {
                f = new NewFrag();
                Bundle args = new Bundle();
                f.setArguments(args);
                break;
            }
            default:
                throw new IllegalArgumentException("not this many fragments: "
                    + position);
            }
            return f;
        }

        @Override
        public int getCount() {
            return 4;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            switch (position) {
            case 0:
                return getString(R.string.mastercattab1).toUpperCase();
            case 1:
                return getString(R.string.mastercattab2).toUpperCase();
            case 2:
                return getString(R.string.mastercattab3).toUpperCase();
            case 3:
                return getString(R.string.mastercattab4).toUpperCase();
            }
            return null;
        }
    }
} 
```

一个典型的片段有这样的轮廓：

```
public static class FeaturedFrag extends Fragment {

    public FeaturedFrag() {}

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.rateithome, container, false);
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-31T16:53:06.280

看起来这是[Android 支持库中的一个已知错误](https://groups.google.com/d/msg/actionbarsherlock/B3QOI3j2DPo/lpEFbjODWkEJ)。幸运的是，它已被修补。

要修复错误：

1.  使用 SDK Manager 更新到最新版本的支持库
2.  `android-support-v4.jar`将应用程序文件夹中的文件替换为`libs/`您刚刚下载的新版本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T16:01:54.127

尝试这个：

```
public void onSaveInstanceState(Bundle savedInstanceState) {

if (savedInstanceState != null) 
   {
      super.onSaveInstanceState(savedInstanceState);
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-29T12:29:00.070

如果您只是想要一个快速的**解决方法**，请将其添加到您的片段代码中：

```
@Override
public void onSaveInstanceState(Bundle outState) {
    // Workaround to avoid NPE from support library bug:
    setUserVisibleHint(false);

    super.onSaveInstanceState(outState);
} 
```

该`setUserVisibleHint`属性确实只是优化的提示，不会给您带来任何麻烦，请参阅[Android 参考文档](http://developer.android.com/reference/android/support/v4/app/Fragment.html#setUserVisibleHint%28boolean%29)。

当然，从长远来看，更新[由 theisenp 回答](https://stackoverflow.com/a/12219557/2560665)的支持库可能更可取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-09T06:52:56.753

我想你用过这种风格 AppTheme.NoActionBar

在清单文件和 java 类中，您正在使用操作栏，这就是它导致崩溃的原因。

你能告诉我你的清单文件和style.xml吗

# ios - facebook 如何调用原生 iOS 应用程序？

> ID：12217683
> 
> 赞同：0
> 
> 时间：2012-08-31T14:42:45.707
> 
> 标签：ios, facebook, native

我想知道 facebook 本机应用程序如何调用我的本机 iOS 应用程序。Facebook 需要应用程序包 ID、应用商店 ID 和 url 后缀（可选）。我想知道的是：facebook如何处理这些信息并打开我的原生应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:47:05.203

它使用[自定义 URL 方案](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW18)。

您基本上要做的是为您的应用程序定义一个“url”，以便您可以从操作系统中的任何位置访问它（使用该 URL）。例如，当它打开 Safari 对您进行身份验证时，FB 所做的就是将您的应用程序的自定义 url 指定为回调 URL，因此当它完成时，它会调用该 url 并将其重定向回您的应用程序。

您可以通过为您的应用设置自定义 URL、启动 Safari 并输入该 URL 来测试这一点。它将直接跳转到您的应用程序。

[你可以在这里](http://www.coronalabs.com/blog/2011/12/22/using-app-url-schemes-in-ios/)阅读更多关于它的信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-31T14:46:25.773

您无需进行任何设置即可让 Facebook 应用程序将您发送回您自己的应用程序。SDK 会自动执行此操作。

在您的 Facebook 应用程序（在 Facebook 开发人员中心）中设置应用程序包 ID 允许 Facebook 应用程序将用户立即送回您的应用程序，如果他们之前已经授予您的应用程序的权限。这只是一个不错的功能，但并非所有功能都可以正常工作。

# php - 无法在 ajax 调用中发布绝对文件路径 - 无论我做什么，它都会回退斜杠

> ID：12217685
> 
> 赞同：0
> 
> 时间：2012-08-31T14:42:58.127
> 
> 标签：php, javascript, jquery, encoding, uri

下面是我的 javascript 函数，它通过 post 进行 ajax 调用。它将文件位置和文件内容发送到保存文件的 php 页面。这个想法是，用户可以通过浏览器管理小型应用程序的配置文件模板，而不是手动登录到远程服务器，进行编辑，然后将编辑提交回 src 控件以被拉入每个应用程序（这在页面上都是自动化的）此 ajax 调用将数据发布到）。

我的问题是fileloc。我无法让我的 ajax 调用发布 fileloc 并保持 dir 结构完整。我已经尝试了 escape()、encodeURI()、encodeURIComponent() 和 JQuery 的这些函数的版本。无论如何，我的 fileloc 在 saveConfigTemplates.php 页面上显示为：“D:TestPHPconfigurationautomationtemplatesservernamefilename.cfg”。我已经尝试过 php 的解码，但它没有任何区别......就像帖子丢失了所有编码并将单斜杠视为转义字符一样。让我发疯，任何建议表示赞赏。

```
function saveFile(){
        var fileContents = $("#fileContent").val(); 
        alert(fileContents);
        var fileloc = "D:\TestPHP\configuration\automation\templates\servername\filename.cfg";
        var fileconts = "fileloc="+encodeURIComponent(fileloc)+"&fileconts="+fileContents;

            $.ajax({
            type: "POST",
            url: "saveConfigTemplates.php",
            data: fileconts,
            success: function(data) {
                alert(data);

             }
            });

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:45:26.570

转义反斜杠：

```
var fileloc = "D:\\TestPHP\\configuration\\automation\\templates\\servername\\filename.cfg"; 
```

# javascript - 通过更改 div 的背景图像来制作动画

> ID：12217688
> 
> 赞同：2
> 
> 时间：2012-08-31T14:43:07.440
> 
> 标签：javascript, html

我们试图通过一系列图像更改 div 元素的背景并重复循环来模拟动画。有四个 533x800 8 位 PNG 图像，每个图像大小约为 110KB。运行一个 JavaScript 函数`setInterval`，它每 300 毫秒将 div 背景更改为下一个图像。我认为这对浏览器来说不是一项繁重的任务，但结果发现延迟太多了。尤其是在移动设备上。您建议有什么更好的方法来实现这一目标？下面是改变背景的 JS (jquery) 函数。谢谢

```
function changeBackground() {
    if ( typeof changeBackground.counter == 'undefined' ) {
        changeBackground.counter = 1;
        changeBackground.backObject = $('#body');
    }

    if ( changeBackground.counter == 5 )
        changeBackground.counter = 1;

    changeBackground.backObject.css( 'background-image', "url(graphics/" + changeBackground.counter + ".png)" );
    ++changeBackground.counter;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:49:58.513

通过将所有四个图像彼此相邻放置来创建一个大型复合背景图像。然后每 300 毫秒加载背景并更改其位置（因此它显示四个“帧”之一），而不是每次都加载新背景

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:05:15.087

*正如[CalMlynarczyk](https://stackoverflow.com/users/691501/calmlynarczyk)所提议的，我将我的评论作为答案发布。*

你应该只用这些图像制作一个动画 GIF。这将导致只加载一个图像并且不需要 javascript（这意味着它也适用于禁用 javascript）。

关于透明度，GIF 支持它，但仅以布尔方式（像素是否 100% 透明，而 PNG-24 支持 alpha 透明度，其值介于 0% 和 100% 之间）。此外，还有许多免费提供该服务的在线动画 GIF 生成器。从一个动画 GIF 中提取动画 GIF 的时间不应超过 5 分钟。

只有这么多图像，使用 GIMP（开源，免费）创建 GIF 也相当容易。如果您保存工作文件，您可以轻松地重新排序图像序列或更改帧之间的时间。

# jquery - 如何检测我的用户何时观看视频（也来自外部来源）

> ID：12217690
> 
> 赞同：2
> 
> 时间：2012-08-31T14:43:17.710
> 
> 标签：jquery, asp.net

我正在寻求实现类似[可汗学院](http://www.khanacademy.org/)的积分系统，但我不知道如何检测我的用户何时观看视频。

我正在使用 jQuery 和 ASP.NET。这些视频未托管在我的服务器上，并且来自各种来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:47:55.963

对于视频和其他媒体等媒体，通常播放器本身具有内置回调功能，允许您在播放开始和/或结束时触发事件。如果您使用的是 HTML5 视频播放器，您将更多地接触 javascript。拥有具有回调支持的多功能播放器的好处在于，媒体文件的托管位置无关紧要，重要的是播放器本身发生了什么事件。

如果您要这样做，您可以在视频开始时触发一个 javascript 函数，该函数记录用户视频已开始的事件，将其跟踪为“当前正在观看”，然后在完成后同样将其标记为完全观看的视频

现在，在观看视频的同时，您可能希望使用 javascript 来检测页面焦点丢失...例如，他们是标签离开还是转到计算机上的其他窗口。等等（<--谷歌这些类型的问题：[JavaScript / jQuery：测试窗口是否有焦点](https://stackoverflow.com/questions/3479734/test-if-window-has-focus)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T21:29:20.170

[免费的 Video.js 项目](http://videojs.com/docs/api/)允许您使用 Javascript 以编程方式控制页面上播放的视频并与之交互，无论它们是托管 HTML5、Flash 还是 YouTube 视频。

您可以为名为“timeupdate”的 JavaScript 事件添加一个侦听器，该事件将在视频播放时每 15-250 毫秒触发一次。

# ruby - 在红帽奇怪的错误中查找显卡数量

> ID：12217692
> 
> 赞同：0
> 
> 时间：2012-08-31T14:43:32.980
> 
> 标签：ruby, split

所以我知道如何找到显卡的数量，但是在我写的一个 ruby​​ 脚本中，我有一个小方法来确定它：

```
def getNumCards
    _numGpu = %x{lspci | grep VGA}.split("\n").size
end 
```

但是已经确定我需要搜索 3D 和 VGA，所以我将其更改为：

```
def getNumCards
    _numGpu = %x{lspci | grep "VGA\|3D"}.split("\n").size
end 
```

但是当我运行第二个时，我发现它返回 0。如果我在命令行上自己运行命令，它会显示 3 个视频卡（1 个板载 VGA 卡和两个作为 3D 卡的 Tesla NVIDIA 卡）。我不确定拆分部分中发生的事情可能会搞砸一些事情。

任何帮助都是极好的！

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:55:20.247

人grep：

```
-E, --extended-regexp
...
egrep is the same as grep -E. 
```

所以，`egrep`应该有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T17:09:11.197

我会以两种方式之一来获取此信息。

几乎纯命令行版本将是：

```
def getNumCards
  `lspci | grep -P '\b(?:VGA|3D)\b' | wc -l`.to_i
end 
```

这让操作系统可以完成几乎所有的工作，除了最终转换为整数。

`-P '\b(?:VGA|3D)\b'`是一个 Perl 正则表达式，它表示“找到一个断词，然后查找 VGA 或 3D，然后是另一个断词”。这将有助于避免由于目标嵌入其他字符串而导致的任何命中。

more-Ruby 版本是：

```
def getNumCards
  `lspci`.split("\n").grep(/\b(?:VGA|3D)\b/).count
end 
```

它做同样的事情，只是全部在 Ruby 中。

# coldfusion - 转换为 JSON 时为冷融合结构保留大小写

> ID：12217698
> 
> 赞同：4
> 
> 时间：2012-08-31T14:44:07.927
> 
> 标签：coldfusion

使用数组表示法在用于保留键大小写的结构中创建键。

```
<cfset var response = structNew()>
<cfset response[ "error" ] = 0>
<cfset response[ "message" ] = "">
<!--- this worked when converting this struct to a JSON 
```

因此，当我实际将一些数据放入结构时：

```
<cfset response.error = 1>
<cfset response.message = "There was an error inserting the record..."> 
```

当我看到萤火虫控制台出现这种情况时，我感到很惊讶：

`{"MESSAGE":"There was an error inserting the record...","ERROR":1}`

请注意，这些信息是我期望看到的。

我知道如果我会使用`<cfset response.error = 0>`, 将它转换为 JSON 时不会保留这种情况，但这在过去对我有用。我是在做错什么我看不到的事情还是在 CF10 中做了什么改变？

编辑：

在所有回复都回来之前，我尝试了每个人所说的。

```
<cfset response["error"] = 1>
<cfset response["message"] = "There was an error inserting the record..."> 
```

它奏效了。所以，我猜他们改变了`serializeJSON`CF10 的工作方式。

很高兴知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T15:01:47.057

我相信如果您继续使用括号表示法，它将继续正常工作。我猜要多打字，但应该可以。如果这是对 CF9 的更改，但您可能需要提交错误报告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T15:03:08.307

如果您继续使用括号表示法而不是点表示法来引用结构键，那么在使用`serializeJSON()`.

然而，在 CF9 上进行测试后，无论我使用括号还是点表示法，它似乎都可以正常工作。这可能是 CF9 和 10 之间的差异，并且正如 Ray 建议的那样，您可能需要为其提交错误报告。

这是我在 CF9 中所做的：

```
<cfset response = structNew()>
<cfset response[ "error" ] = 0>
<cfset response[ "message" ] = "">
<!--- this worked when converting this struct to a JSON --->

<cfoutput>#serializeJSON(response)#</cfoutput><br /><br />

<!--- This outputs {"message":"","error":0} --->

<cfset response.error = 1>
<cfset response.message = "There was an error inserting the record...">

<cfoutput>#serializeJSON(response)#</cfoutput>
<!--- This outputs {"message":"There was an error inserting the record...","error":1} ---> 
```

# snmp - 如何使用 SNMP 获取连接到交换机的设备的 MAC 或 IP 地址？

> ID：12217708
> 
> 赞同：5
> 
> 时间：2012-08-31T14:44:28.783
> 
> 标签：snmp

使用 SNMP，如何获取连接到交换机每个端口的设备的 MAC 地址？我们正在使用 HP ProCurve 开关。

我尝试使用 OID dot1dTpFdbPort 但这似乎给了我与交换机通信的每个设备的 MAC 地址，而不仅仅是连接到它。

我正在尝试在列表中找到可以为我提供端口 1-48 的 OID，并且对于每个端口，连接到该端口的设备的 MAC（或 IP 地址）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:45:48.080

非常感谢 raz3r 的回答。它就像一个魅力！

从您的 linux 服务器：

> $ snmpwalk -v 1 -c 公共 xxx.xxx.xxx.xxx 1.3.6.1.2.1.17.4.3.1.2 | grep“整数：11”

（端口号 11）

将返回 ：

> SNMPv2-SMI::mib-2.17.4.3.1.2.44.118.138.64.143.95 = 整数：11
> SNMPv2-SMI::mib-2.17.4.3.1.2.56.170.60.108.174.57 = 整数：11
> SNMPv2-SMI::mib -2.17.4.3.1.2.104.181.153.172.54.237 = 整数：11
> SNMPv2-SMI::mib-2.17.4.3.1.2.120.172.192.143.226.236 = 整数：11
> SNMPv2-SMI::mib-2.17.4.3.1.2 .124.195.161.20.109.76 = 整数：11
> SNMPv2-SMI::mib-2.17.4.3.1.2。**152.75.225.59.127.180** = 整数：11

然后您可以执行此操作来查找连接的 Mac 地址：

> $ snmpwalk -v 1 -c 公共 xxx.xxx.xxx.xxx 1.3.6.1.2.1.17.4.3.1.1 | grep "152.75.225.59.127.180"

返回mac地址：

> SNMPv2-SMI::mib-2.17.4.3.1.1.152.75.225.59.127.180 = 十六进制字符串：**98 4B E1 3B 7F B4**

您可以制作一个 script.sh 来执行此操作...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T12:54:05.690

你快到了:) dot1dTpFdbPort 正是你要找的东西，你唯一需要的是一个指向真实端口索引的链接。

首先，取 dot1dTpFdbPort 给出的值。

现在使用您之前获取的值查询 dot1dBasePortIfIndex。

让我们举个例子：

```
snmpwalk -v 2c -c xxx 192.168.x.x 1.3.6.1.2.1.17.4.3.1.1

SNMPv2-SMI::mib-2.17.4.3.1.1.0.2.253.255.213.15 = Hex-STRING: XX XX XX XX XX XX

snmpwalk -v 2c -c xxx 192.168.x.x 1.3.6.1.2.1.17.4.3.1.2

SNMPv2-SMI::mib-2.17.4.3.1.2.0.2.253.255.213.15 = INTEGER: 22

# Notice the 22 :)

snmpwalk -v 2c -c xxx 192.168.x.x 1.3.6.1.2.1.17.1.4.1.2.22

SNMPv2-SMI::mib-2.17.1.4.1.2.22 = INTEGER: 10122 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-14T12:17:12.897

Netsnmp`snmptable`在这里可能更具可读性。

示例`dot1dTpFdb`表检索：

```
snmptable  -M +.  -m +ALL -v 2c -c public  -Ci  192.168.x.x    BRIDGE-MIB::dot1dTpFdbTable
   index dot1dTpFdbAddress dot1dTpFdbPort dot1dTpFdbStatus
'..?...'   98:4B:E1:3B:7F:B4           13          learned
// other rows snipped for brevity 
```

示例`dot1dBasePort`表检索：

```
snmptable  -M +.  -m +ALL -v 2c -c public  -Ci  192.168.x.x   BRIDGE-MIB::dot1dBasePortTable
 index dot1dBasePort dot1dBasePortIfIndex    dot1dBasePortCircuit dot1dBasePortDelayExceededDiscards dot1dBasePortMtuExceededDiscards
    13            13                10113 SNMPv2-SMI::zeroDotZero                                  0                                0
// other rows snipped for brevity 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-14T11:24:26.237

试试这个直接在 HEX 中获得 MAC 地址：

```
snmpwalk -OX -v 2c -c public xxx.xxx.xxx.xxx 1.3.6.1.2.1.17.4.3.1.2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-03T19:15:37.537

```
#!/bin/bash
# This should iterate thru each active port. 
HOST=xxx.xxx.xxx.xxx ## Change this to the ip address of the switch
echo
snmpwalk -v 1 -c public "$HOST" 1.3.6.1.2.1.17.4.3.1.1 | grep "$" |awk -- '{print $4":"$5":"$6":"$7":"$8":"$9}' 
```

# javascript - 是否有类似 ExtJS 4 的“普通”网站框架？

> ID：12217709
> 
> 赞同：0
> 
> 时间：2012-08-31T14:44:38.410
> 
> 标签：javascript, frameworks

我喜欢 ExtJS4 仅使用 JavaScript 的方法，它允许我创建和操作 RIA-web-apps 而无需接触任何 CSS/HTML，而且 MVC 也可以保持一切井井有条。

“普通”网站有类似的东西吗？

我查看了诸如 ember.js、qooxdoo、jquery、batman.js、kickstrap 等之类的东西，但它们看起来都像是一大堆 HTML/CSS/JS，所以当网站变得一定复杂时，它们可能都会开始失败.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:49:30.393

你可能会感兴趣： [dojotoolkit.org](http://dojotoolkit.org)

您所说的“正常”网站到底是什么意思？

# jquery - 点击时无法触发 jQuery 验证插件

> ID：12217711
> 
> 赞同：1
> 
> 时间：2012-08-31T14:44:44.030
> 
> 标签：jquery, validation

除非我输入文本和标签到下一个，否则我无法让我的表单验证在下面做出响应。单击不同的字段或点击提交什么都不做，我希望它在所有情况下都能响应。老实说，这是我第一次将 jquery 用于比启用或禁用类更复杂的事情，所以我可能在某处犯了一个基本错误。然而，我无法弄清楚它是什么。

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>

<script type="text/javascript">
    //form validation 
   $(document).ready(function() {
       $("#form").validate({
            rules: {
                organization: {
                    required: true,
                    minlength: 2,
                    },
                firstname: {
                    required: true,
                    minlength: 2,
                    },
                lastname: {
                    required: true,
                    minlength: 2,
                    },
                email: {
                    required: true,
                    email: true,
                    },
                phone: {
                    required: true,
                    minlength: 10,
                    number: true,
                    },
            },
            messages: {
                organization: "Please enter a valid organization name",
                firstname: "Please enter your first name",
                lastname: "Please enter your last name",
                email: "Please enter a valid email address",
                phone: "Please enter a valid phone number",
            },
        });         
   });
</script>
</head>
<body>
<div id="form_container">
    <div id="form_title">REQUEST INFO</div>
    <form id="form" name="form_container" action="#">
        <!-- fields -->
        <input id="organization" type="text" name="organization" minlength="2" />
        <input id="firstname" type="text" name="firstname" minlength="2" />
        <input id="lastname" type="text"  name="lastname" minlength="2" />
        <input id="email" type="text" name="email" />
        <input id="phone" type="text" name="phone" />
        <!-- submit button -->
        <input type="button" id="button" name="submit" type="submit" value="submit" > 
    </form>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:51:59.233

您的提交按钮上有 2 个类型属性

```
<input type="button" id="button" name="submit" type="submit" value="submit" > 
```

改成这个

```
<input id="button" name="submit" type="submit" value="submit" /> 
```

这将导致按钮提交表单，并以您期望的方式触发验证插件。此外，您的验证配置对象在一些地方（在每个子对象的最后一个字段之后）有一些额外的尾随逗号，这可能会使一些旧浏览器（尤其是 IE）出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:03:43.793

看看`.focusin()`和`.focusout()`jQuery 事件方法。您可能想要查看的另一件事是`.submit()`方法，如果您打算在访问者单击“提交”按钮时进行更多验证，然后再实际执行提交。

如果您需要更多指导或进一步的解释/示例，请告诉我。祝你好运！:)

# sql-server - SQL Server 没有“捕捉”我的异常

> ID：12217715
> 
> 赞同：0
> 
> 时间：2012-08-31T14:44:58.760
> 
> 标签：sql-server, transactions, try-catch

我有一个简单的 TRY CATCH，在下面的查询中嵌入了 TRANSACTION。
我在查询中输入了错误的列名：`ItemID1`在运行查询时的第二个`UPDATE`中`TRANSACTION`
，我收到以下严重性高于 10 的错误消息：

> 消息 207，级别 16，状态 1，第 xxx 行无效的列名称“ItemID1”。

第一次`UPDATE`成功运行（我希望它会`ROLLBACK`）。
这表明它从未进入`CATCH`区块。
根据我的理解，`CATCH`捕获了 10 以上严重性的错误。这个是严重性 16，因此它应该已经捕获了它。任何想法为什么`CATCH`从未被执行？

```
BEGIN TRY
    IF OBJECT_ID('tempdb..#MyTempTable') IS NOT NULL 
        DROP TABLE #MyTempTable
    CREATE TABLE #MyTempTable
        (
          ObjectID UNIQUEIDENTIFIER , OrgID NVARCHAR(20)
        )

    INSERT  INTO #MyTempTable
            SELECT  ObjectTable1.ObjectID AS ObjectID ,OrgID 
            FROM    ObjectTable1 WITH ( NOLOCK ) INNER JOIN Org WITH ( NOLOCK ) ON ObjectTable1.OrgID = Org.OrgID
            WHERE   OrgID IN ('Blah1', 'Blah2')

    INSERT  INTO #MyTempTable
            SELECT  ObjectTable2.ObjectID AS ObjectID, OrgID
            FROM    ObjectTable2 WITH ( NOLOCK ) INNER JOIN Org WITH ( NOLOCK ) ON ObjectTable2.OrgID = Org.OrgID
            WHERE   OrgID IN ('Blah3', 'Blah4')

    SELECT  * FROM #MyTempTable

    BEGIN TRANSACTION
        UPDATE  ObjectTable1 
        SET ItemID = NULL FROM ObjectTable1 INNER JOIN #MyTempTable ON #MyTempTable.ObjectID = ObjectTable1.ObjectID
        PRINT 'Updated ' + CAST(@@ROWCOUNT AS VARCHAR(20)) + ' Objects in ObjectTable1'

        UPDATE  ObjectTable2
        SET     ItemID = (ItemID1 + 1) FROM ObjectTable2 INNER JOIN #MyTempTable ON #MyTempTable.ObjectID = ObjectTable2.ObjectID
        PRINT 'Updated ' + CAST(@@ROWCOUNT AS VARCHAR(20)) + ' Objects in ObjectTable2'
    COMMIT
    DROP TABLE #MyTempTable
END TRY

BEGIN CATCH
    IF @@TRANCOUNT > 0 
        ROLLBACK
    DROP TABLE #MyTempTable

    DECLARE @ErrMsg NVARCHAR(4000) ,
        @ErrSeverity INT
    SELECT  @ErrMsg = ERROR_MESSAGE() ,
            @ErrSeverity = ERROR_SEVERITY()
    RAISERROR(@ErrMsg, @ErrSeverity, 1)
END CATCH 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:53:28.707

TRY-CATCH 不会捕获对象名称解析错误。[从这里的](http://msdn.microsoft.com/en-us/library/ms175976.aspx)MSDN 文章：

> 以下类型的错误发生在与 TRY...CATCH 构造相同的执行级别时，不会由 CATCH 块处理：
> 
> *   编译错误，例如语法错误，阻止批处理运行。
> *   在语句级重新编译期间发生的错误，例如由于延迟名称解析而在编译后发生的对象名称解析错误。

# php - 将调用的 PHP 页面返回的值附加到表中

> ID：12217719
> 
> 赞同：1
> 
> 时间：2012-08-31T14:45:11.827
> 
> 标签：php, jquery, html-table, append

在我的 PHP 主页中，我有一个表格，我在其中输入了一些值用作标题。该页面的代码是：

```
<form  method="post" action="<?php echo $_SERVER['PHP_SELF'] ;?>">
<table id="npc" cellspacing="10">
    <tr>
        <td> Building</td>
        <td> Level</td>
        <td> Lumber</td>
        <td> Clay</td>
        <td> Iron</td>
        <td> Crop</td>
    <tr>
</table>
</form> 
```

我正在使用 jQuery 和 AJAX 来调用**res.php**。jQuery代码是：

```
$.ajax(
                {

                    url: "res.php", 
                    type: "POST",
                    data: data,     
                    success: function (data) {
                        $('#npc').html(data);
                    }
                }); 
```

在 res.php 页面中，我使用传递的参数从数据库中检索数据。然后我在表格中显示它`id="npc"`。

**res.php**页面的内容是：

```
$result = mysql_query($query) or die('Error in Child Table!');

while( $data = mysql_fetch_assoc($result))
{
echo '<tr><td>'. $building. '</td><td>'. $level. '</td><td>'. $data['lumber']. '</td><td>'.$data['clay']. '</td><td>'. $data['iron']. '</td><td>'. $data['crop'].'</td></tr>';
} 
```

但是由于某种原因，它没有将数据附加到表的末尾，`id="npc"`而是删除了以前的数据，然后显示了新的数据。

如何保留以前的数据并将新数据附加到表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:47:24.203

使用`append()`而不是`html()`.

```
 $('#npc').append(data); // use .find('tbdoy') if required 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:47:32.390

而是`$('#npc').html(data);`尝试`$('#npc').append(data);`

# c# - 在javascript中设置innerHTML并从C#获取

> ID：12217724
> 
> 赞同：3
> 
> 时间：2012-08-31T14:45:28.397
> 
> 标签：c#, innerhtml

我有两个标签：

```
 <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
  <asp:Label ID="Label2" runat="server" Text="Label"></asp:Label> 
```

我通过javascript设置innerHTML：

```
document.getElementById('Label1').innerHTML = position.lat();
document.getElementById('Label2').innerHTML = position.lng(); 
```

如何在代码隐藏中获取这些标签值？我尝试：

```
TextBox2.Text = Label1.Text; 
```

**更新**：我需要获取图钉位置：

```
 <artem:GoogleMap ID="GoogleMap1" runat="server" 
    EnableMapTypeControl="False" MapType="Roadmap" >        
  </artem:GoogleMap>      
  <artem:GoogleMarkers ID="GoogleMarkers1" runat="server" 
    TargetControlID="GoogleMap1" onclientpositionchanged="handlePositionChanged">
  </artem:GoogleMarkers> 
  <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
  <asp:Label ID="Label2" runat="server" Text="Label"></asp:Label>

<script type="text/javascript">
  var list = document.getElementById("Label1");
  function handlePositionChanged(sender, e) {
    printEvent("Position Changed", sender, e);
  }
  function printEvent(name, sender, e) {
    var position = e.latLng || sender.markers[e.index].getPosition();
    document.getElementById('Label1').innerHTML = position.lat();
    document.getElementById('Label2').innerHTML = position.lng();
  }
</script>

protected void Button1_Click(object sender, EventArgs e)
{
    TextBox2.Text = Label1.Text;// return value: Label
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T15:03:48.550

您无法访问服务器端的值。您将不得不为此使用隐藏字段：

```
<asp:HiddenField ID="Hidden1" runat="server" /> 
```

通过执行以下操作在 Hidden 字段中设置 innerHtml 值：

```
document.getElementById('<%= Hidden1.ClientID %>').value = position.lat(); 
```

然后，您可以通过执行以下操作从服务器端访问它：

```
TextBox1.Text = Hidden1.Value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-04T17:52:27.557

采取如下所示的隐藏字段

```
<asp:HiddenField ID="hdnBody" ClientIDMode="Static" runat="server" /> 
```

然后在 Jquery 中设置它的值，如下所示

```
<script>
function GetEmailID() {
    var bodyHtml = $("#editor").html();

    $("#hdnBody").val(bodyHtml);  
}
</script> 
```

并在后面的代码中执行此操作以获取它

```
string body = hdnBody.Value; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:04:47.120

您无法使用`Label`控件执行此操作，因为当页面回发时，标签的内容不会发布到服务器。您将需要使用各种输入控件。可能隐藏的输入将是您最好的选择。

# javascript - socket.io cookie 解析握手错误

> ID：12217725
> 
> 赞同：3
> 
> 时间：2012-08-31T14:45:30.760
> 
> 标签：javascript, parsing, cookies, socket.io

当 socket.io 查找会话时，我收到握手错误，因为 cookie 的 id 与数据库中的不匹配。我正在使用 Express3、mongodb、connect-mongodb 和 socket.io v0.9.10

例如，来自 socket.io 代码的 console.log(data.sessionID) 的结果将打印出：

`s:eFFkUnQXWdTO7GBRDc11No/a.U6voj5QnxKs1skq766nO7/qJvPEJA73KaQM67qNEs/k`

但是当我查看数据库上的会话集合时，我得到以下_id：

```
"_id" : "eFFkUnQXWdTO7GBRDc11No/a", 
```

如您所见，这对应于 s: 之后和句点之前的 data.sessionID。我尝试使用两种不同的 cookie 解析器。下面解析器的代码来自 express 3 中包含的 cookie 模块。我不确定每个 cookie ID 是否都遵循这种模式，所以我不知道我是否应该自己再次解析结果，或者我是否有什么东西做错了。

```
exports.parseCookie = function(str) {
var obj = {}
var pairs = str.split(/[;,] */);
var encode = encodeURIComponent;
var decode = decodeURIComponent;

pairs.forEach(function(pair) {
    var eq_idx = pair.indexOf('=')
    var key = pair.substr(0, eq_idx).trim()
    var val = pair.substr(++eq_idx, pair.length).trim();

    // quoted values
    if ('"' == val[0]) {
        val = val.slice(1, -1);
    }

    // only assign once
    if (undefined == obj[key]) {
        obj[key] = decode(val);
    }
});

return obj; 
```

};

下面的代码给了我一个握手错误，因为“connect.sid”属性与数据库中的 id 属性不匹配。

```
io.set('authorization', function (data, accept) {

    if (data.headers.cookie) {
        data.cookie = utils.parseCookie(data.headers.cookie);
        data.sessionID = data.cookie['connect.sid'];
        // **************** //
        console.log(data.sessionID);
        // **************** //
        sessionStore.get(data.sessionID, function (err, session) {
            if (err || ! session) {
                accept('Error', false);
            } else {
                data.session = session;
                data.session.url = data.headers.referer;
                accept(null, true);
            }
        });
    } else {
       return accept('No cookie transmitted.', false);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T15:16:31.337

我遇到了同样的问题，虽然您的解决方案有效，但您使用的 parseCookie 函数来自旧版本的 connect。connect 中的新代码现在对 cookie 进行签名，即句点后的额外字符。

在对 express 和 connect 进行了一番折腾之后，我想出了以下代码。虽然它依赖于一些私有 API 函数 connect (utils.parseSignedCookies)，但它至少使用与生成 cookie 相同的代码来解析 cookie，因此对 cookie 的未来变化应该不太敏感创建和解析。

```
/* cookie: the cookie string from the request headers
 * sid: the session 'key' used with express.session()
 * secret: the session 'secret' used with express.session()
 */
function parseSessionCookie(cookie, sid, secret) {
  var cookies = require('express/node_modules/cookie').parse(cookie)
    , parsed = require('express/node_modules/connect/lib/utils').parseSignedCookies(cookies, secret)
    ;
  return parsed[sid] || null;
}

socketIO.set('authorization', function(data, accept) {
  var sid = parseSessionCookie(data.headers.cookie, 'express.sid', 'secret');
  if (sid) {
    sessionStore.get(sid, function(err, session) {
      if (err || !session) {
        accept('Error', false);
      } else {
        data.session = session;
        accept(null, true);
      }
    });
  } else {
    return accept('No cookie transmitted.', false);
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T08:01:25.200

似乎 sessionStore 键现在是较短的 uid(24)-only 版本，不再是存储在 cookie 中的“长”版本。

目前我通过执行简单的 split('.')[0] 来检索 uid(24) 部分来修复它： data.sessionID = cookie['express.sid'].split('.')[0] ;

# java - 如何通过 Spring Social Facebook 发送请求

> ID：12217728
> 
> 赞同：3
> 
> 时间：2012-08-31T14:45:55.727
> 
> 标签：java, facebook, spring, facebook-graph-api, spring-social

我一直在为 Facebook 挖掘 Spring Social (1.0.2.RELEASE)。我不知道如何通过 spring social 发送 apprequest。我已经在 facebook 上有一个带有键和东西的应用程序。我可以获取朋友等，但不能向特定的 facebook 用户发送 apprequest。真的很感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-02T06:23:56.977

以下示例应该可以解决问题 - 即创建一个应用访问令牌，然后使用 FacebookTemplate 创建请求，该模板已使用创建的应用访问令牌进行初始化

```
// retrieve app access token
RestTemplate restTemplate = new RestTemplate();
String result = restTemplate.getForObject("https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=<app_id>&client_secret=<app_secret>",  String.class);
String appAccessToken = result.replaceAll("access_token=", "");

// create the request       
FacebookTemplate appRequestTemplate = new FacebookTemplate(appAccessToken);
String userId = "1234567890";
MultiValueMap<String, Object> requestData = new LinkedMultiValueMap<String, Object>();
requestData.set("message", "Sending a request through to you...");
String resultOfApprequest = appRequestTemplate.publish(userId, "apprequests", requestData); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T15:41:15.820

根据 Facebook 文档，应用程序请求通过 POST 发送到 Graph API 给用户。请参阅此处的“创建”部分：

[https://developers.facebook.com/docs/reference/api/user/#apprequests](https://developers.facebook.com/docs/reference/api/user/#apprequests)

Spring Social Facebook 有一个 GraphApi 类，它有两种发送 POST 的方法，“publish()”尝试从响应中提取 id，“post()”不：

[http://static.springsource.org/spring-social-facebook/docs/1.0.x/api/org/springframework/social/facebook/api/GraphApi.html](http://static.springsource.org/spring-social-facebook/docs/1.0.x/api/org/springframework/social/facebook/api/GraphApi.html)

因此，您可能需要按照以下方式拨打电话：

```
Map<String, Object> requestData = new HashMap<String, Object>();
requestData.put("message", "My app's request message");
String requestId = graphApi.publish(userId, "apprequests", requestData); 
```

# jquery - 在输入更改时更改 css

> ID：12217729
> 
> 赞同：0
> 
> 时间：2012-08-31T14:46:01.673
> 
> 标签：jquery, css, iframe

**为什么它适用于“红色”**

```
var inputButtonColor = $('input#button-color');

inputButtonColor.change(function() {
  var inputButtonColorValue = inputButtonColor.val();
  alert(inputButtonColorValue);
  $('input.write-review').css({"background-color": "red" });
}); 
```

[http://jsfiddle.net/f4ngg/2/](http://jsfiddle.net/f4ngg/2/)

**这不是“inputButtonColor.val()”**

```
var inputButtonColor = $('input#button-color');

inputButtonColor.change(function() {
  var inputButtonColorValue = inputButtonColor.val();
  alert(inputButtonColorValue);
  $('input.write-review').css({"background-color": inputButtonColorValue });
}); 
```

[http://jsfiddle.net/f4ngg/1/](http://jsfiddle.net/f4ngg/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:48:14.607

您需要删除双引号之外的变量，否则它将被视为字符串。更正后的行：

```
 $('iframe').contents().find('input.write-review').css({"background-color": inputButtonColor.val()}); 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:22:36.827

您将颜色代码作为文本框的输入，如果要将其更改为颜色，则必须`#`在颜色代码之前添加。

所以代码将是：

```
var inputButtonColor = $('input#button-color');

inputButtonColor.change(function() {
  var inputButtonColorValue = inputButtonColor.val();
  alert(inputButtonColorValue);
  $('input.write-review').css({"background-color": "#" + inputButtonColor.val() });
}); 
```

[**演示**](http://jsfiddle.net/f4ngg/4/)

# codeigniter - CodeIgniter - 将复选框数组插入数据库的说明

> ID：12217730
> 
> 赞同：0
> 
> 时间：2012-08-31T14:46:03.667
> 
> 标签：codeigniter

我是 CodeIgniter 的新手并使用数组。我试图将每个复选框的值放入数据库中的同一行。我知道我需要遍历数组，但是我不知道如何告诉它在数据库中的相应标题下写入值。这是我尝试过的，但它为所有选项将 0 写入数据库。感谢任何花时间回答我的问题的人。

//看法

```
<input type="text" name="name" /> Name
<input type="checkbox" value="1" name="options[]" /> Option 1
<input type="checkbox" value="2" name="options[]" /> Option 2
<input type="checkbox" value="3" name="options[]" /> Option 3
<input type="checkbox" value="4" name="options[]" /> Option 4 
```

//控制器

```
//require at least 1 checkbox
$this->form_validation->set_rules('name', 'Name', 'required');
$this->form_validation->set_rules('options[]', 'Options', 'required');

//not sure how to do this part, 
//some how get values to the corresponding "option"
$name = $this->input->post('name');
$option1 = $this->input->post('options[0]');
$option2 = $this->input->post('options[1]');
$option3 = $this->input->post('options[2]');
$option4 = $this->input->post('options[3]');

//insert to database
$this->load->model('add', 'add_model');
$this->add_model->create_person($name, $option1, $option2, $option3, $option4); 
```

//数据库

| 编号 | 姓名 | 选项1 | 选项2 | 选项3 | 选项4 |

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T16:09:20.090

我个人会有不同的命名复选框，并会在发送表单之前在视图中通过 jQuery 进行验证，但这里的代码将为您指明正确的方向。

当您提交表单时，选项数组将包含您在表单上选择的元素。如果未选中任何复选框，则数组将为空，因此您的代码：

```
$option3 = $this->input->post('options[2]'); 
```

将尝试获取空数组的第三个元素。

您需要遍历现有元素并将这些值分配给您的变量。您可以使用以下代码来做到这一点：

```
$myArr = array(1 => 0, 2 => 0, 3 => 0, 4 => 0);   //set all the variables to 0
foreach($_POST['options'] as $checked)          //loop throught the selected options
{
    $myArr[$checked] = $checked;                     //assign to corresponding array element                            
}

$this->add_model->create_person($name, $myArr[1], $myArr[2], $myArr[3], $myArr[4]); 
```

上面的代码不是特别优雅，但我希望它会对你有所帮助

# .net - 如何在 PDF 表单字段中加粗特定文本*然后使用 iTextSharp 展平表单*？

> ID：12217732
> 
> 赞同：1
> 
> 时间：2012-08-31T14:46:03.283
> 
> 标签：.net, pdf, itextsharp, rtf

给定一个已指定字段的 PDF 表单，我希望能够在其中一个表单字段中放置类似的内容：

> 罗德里戈，你**不是**父亲！

使用 iTextSharp，我可以使用富文本值完成此操作（尽管有点费力），并根据[此答案](https://stackoverflow.com/a/4412527/15486)传入表示具有适当粗体标记的内容的 XML 。

但是，根据相同的答案（以及我的第一手经验），完成此操作后，您无法锁定+展平表单（以防止进一步编辑）。不幸的是，在这种情况下这也是必要的。

[前面提到的答案](https://stackoverflow.com/a/4412527/15486)的作者提到，这可以通过“[使用 Javascript] 在打开表单时重置字段值以强制 Acrobat/Reader 为您构建外观 [s] 来解决。

**如何将 Javascript 代码添加到 PDF（最好通过 iTextSharp 本身，尽管我们*可以*在文件本身的后端执行），以便在打开表单时执行它以强制 PDF 阅读器构建外观为你？**

此外，这是否允许我们不必说`GenerateAppearances = false`，从而允许我们锁定和展平表格？

如果没有，**除了 iTextSharp 之外，是否还有其他东西可以让我们将表单字段中的某些单词加粗，但也可以锁定和展平表单以防止我们完成后的未来编辑？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T19:21:52.570

我发现有一种方法可以实现这个目标，尽管不是通过任何特别优雅的方式（据我所知）。

您这样做的方法是使用 iTextSharp*直接在现有表单域上编写一个文本域*。

这里的主要警告是 pdf 基本上不再成为一种形式，所以如果你需要*阅读*表单域的内容，你就会被淹没。

另一方面，如果表单字段基本上被用作一个简单的指南来帮助告诉 iTextSharp 将文本放在 pdf 的哪个位置（并且仅用于输出），那么这可能会起作用。

```
using (FileStream filestream = new FileStream(outputpath, FileMode.CreateNew, FileAccess.Write))
{
    var stamper = new PdfStamper(reader, filestream);

    var acroFields = stamper.AcroFields;

    string fieldName = "Field Name";
    var fieldPositions = acroFields.GetFieldPositions(fieldName);

    var helveticaBold = FontFactory.GetFont(FontFactory.HELVETICA_BOLD, 14);
    var helveticaRegular = FontFactory.GetFont(FontFactory.HELVETICA, 14);

    List<Chunk> chunks = new List<Chunk>();

    chunks.Add(new Chunk("Rodrigo, you are ", helveticaRegular));
    chunks.Add(new Chunk("NOT", helveticaBold));
    chunks.Add(new Chunk(" the father!", helveticaRegular));

    Phrase currentPhrase = new Phrase();

    foreach (Chunk chunk in chunks)
    {
        currentPhrase.Add(chunk);
    }

    foreach (var currentPosition in fieldPositions)
    {
        PdfContentByte currentCanvas = stamper.GetOverContent(currentPosition.page);

        ColumnText currentColumnText = new ColumnText(currentCanvas);

        currentColumnText.SetSimpleColumn(currentPhrase, currentPosition.position.Left,
                                          currentPosition.position.Bottom, currentPosition.position.Right,
                                          currentPosition.position.Top, 13, Element.ALIGN_LEFT);
        currentColumnText.Go();
    }

    stamper.FormFlattening = true;
    stamper.Close();
} 
```

# php - 在两种情况下使用变量

> ID：12217734
> 
> 赞同：0
> 
> 时间：2012-08-31T14:46:05.740
> 
> 标签：php, variables, conditional-statements

我在处理第二种情况下的一种情况下的变量时遇到问题。我有类似的东西：

```
<form name="exampleForm" method="post">
...
<input type="submit" name="firstSubmit" value="Send">
<input type="submit" name="secondSubmit" value="Show">
</form>

<?php
if(isset($_POST['firstSubmit'])) {

 function a() {
  $a = 5;
  $b = 6;
  $c = $a + $b;
  echo "The result is $c";
  return $c;
 }

 $functionOutput = a();
}

if(isset($_POST['secondSubmit'])) {

 echo $functionOutput;
}
?> 
```

当我需要使用`$functionOutput`第一个条件的变量时，我总是会收到一条错误消息（未定义的变量）。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:48:47.260

我不确定您到底要做什么，但是当您按下第二个按钮时，变量`$functionOutput`未定义为第一个条件`false`是跳过整个部分。

请注意，脚本一结束，变量就会丢失。您可以查看[会话](http://php.net/manual/en/features.sessions.php)并使用会话变量来解决这个问题，但这在一定程度上取决于您想要做什么。

要使用会话，您必须将整个 php 块移动到开始输出 html 之前的位置并执行以下操作：

```
<?php
session_start();

if(isset($_POST['firstSubmit'])) {

 function a() {
  $a = 5;
  $b = 6;
  $c = $a + $b;
  return $c;
 }

 $_SESSION['output'] = a();
}

// start html output
?>
<doctype .....
<html ....

// and where you want to echo
if(isset($_POST['firstSubmit'])) {
  echo "The result is {$_SESSION['output']}";
}

if(isset($_POST['secondSubmit'])) {

 echo $_SESSION['output'];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:48:30.020

```
<?php
$functionOutput = "";

if(isset($_POST['firstSubmit'])) {

 function a() {
  $a = 5;
  $b = 6;
  $c = $a + $b;
  echo "The result is $c";
  return $c;
 }

 $functionOutput = a();
}

if(isset($_POST['secondSubmit'])) {

 echo $functionOutput;
}
?> 
```

应该修复它。发生这种情况是因为您在第一个 IF 语句中声明了 $functionOutput。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:52:13.600

As`$functionOutput`在您调用时未初始化`if(isset($_POST['secondSubmit']))`

```
<?php
if(isset($_POST['firstSubmit'])) {

 function a() {
  $a = 5;
  $b = 6;
  $c = $a + $b;
  echo "The result is $c";
  return $c;
 }

 $functionOutput = a();
}
$functionOutput='12';//intialize
if(isset($_POST['secondSubmit'])) {

 echo $functionOutput;
}
?> 

         **OR**

<?php
if(isset($_POST['firstSubmit'])) {

 function a() {
  $a = 5;
  $b = 6;
  $c = $a + $b;
  echo "The result is $c";
  return $c;
 }

 $functionOutput = a();
}

if(isset($_POST['secondSubmit'])) {
 function a() {
  $a = 5;
  $b = 6;
  $c = $a - $b;
  echo "The result is $c";
  return $c;
 }

 $functionOutput = a();
 echo $functionOutput;
}
?> 
```

# c# - 从 CSV 设置变量类型

> ID：12217736
> 
> 赞同：-6
> 
> 时间：2012-08-31T14:46:18.620
> 
> 标签：c#, linq

```
var csv =
    from line in File.ReadAllLines("C:/file.csv")
    let customerRecord = line.Split(',')
    select new Customer()
        {
            contactID = customerRecord[0],
            surveyDate = customerRecord[1],
            project = customerRecord[2],
            projectCode = customerRecord[3]
        };

public class Customer
    {
        public string contactID { get; set; }
        public string surveyDate { get; set; }
        public string project { get; set; }
        public string projectCode { get; set; }
    } 
```

我希望能够将其`surveyDate`作为 a读取`DateTime`，以便将其与`DateTime`我加入 csv 文件的其他字段进行比较。

我尝试`surveyDate`在课堂上设置为 Date.Time，并尝试在 select 语句中对其进行转换，但都失败并出现以下错误：

> FormatException：字符串未被识别为有效的 DateTime。从索引 0 开始有一个未知单词。

我必须使用 csv 文件，所以我无法将数据添加到 sql server。

> contactID,responseDate,project,projectID
> 1,6/4/2009,0-3 月,1
> 2,6/11/2009,0-3 月,1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:49:56.620

您需要在读取和更改类型时对其进行解析。我不确定你一开始是如何尝试的。另外，`DateTime.ParseExact`如果您知道格式，请使用。

```
var csv =
    from line in File.ReadAllLines("C:/file.csv")
    let customerRecord = line.Split(',')
    select new Customer()
        {
            contactID = customerRecord[0],
            surveyDate = **DateTime.Parse(**customerRecord[1]**)**,
            project = customerRecord[2],
            projectCode = customerRecord[3]
        };

public class Customer
{
    public string contactID { get; set; }
    public **DateTime** surveyDate { get; set; }
    public string project { get; set; }
    public string projectCode { get; set; }
}
```

从您刚刚发布的错误来看，我认为它可能是双引号。尝试修剪引号：

```
DateTime.Parse(customerRecord[1].Trim('"')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:23:19.453

对...因为您永远无法知道来自 CSV 的输入是什么，所以您不能总是尝试将字符串隐式转换为 DateTime，并且因为您想在选择一种方法中转换字符串是一种扩展方法。

```
 public static class StringExtensions
  {
    public static DateTime TryParseDate(this string strToParse)
    {
      DateTime dt = new DateTime();
      DateTime.TryParse(strToParse, out dt);
      return dt;
    }
  } 
```

然后，当您要在选择中进行转换时，请执行以下操作：

```
 var csv = from line in File.ReadAllLines("C:/file.csv")
            let customerRecord = line.Split(',')
            select new Customer()
                {
                  contactID = customerRecord[0],
                  surveyDate = customerRecord[1].TryParseDate(),
                  project = customerRecord[2],
                  projectCode = customerRecord[3]
                }; 
```

你有你自己的方法。希望这对您有所帮助和工作。

您要解析的字符串将传递给该方法，然后您可以处理它并返回有效的日期时间，处理不正确的输入。

[http://msdn.microsoft.com/en-us/library/bb383977.aspx](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

请参阅此链接以获取说明

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:49:04.073

> 我尝试在课堂上将surveyDate 设置为Date.Time，并尝试在select 语句中对其进行转换，但都失败了。

那么你需要两者都做。您需要更改属性类型（最好同时修复命名以遵循约定）*并*更改设置它的位置，可能使用`DateTime.ParseExact`，指定格式和可能的不变文化。

（我假设您知道文件中日期的格式 - 我*强烈*建议您使用，`DateTime.ParseExact`而不是让框架尝试各种格式，直到找到一种有效的格式。）

*编辑：现在我们已经看到了文件，*看起来你想要

 *```
DateTime.ParseExact(text, "d/M/yyyy", CultureInfo.InvariantCulture) 
```

或者：

```
DateTime.ParseExact(text, "M/d/yyyy", CultureInfo.InvariantCulture) 
```

...但我们不知道是哪个，因为我们不知道“2009 年 6 月 4 日”是指 4 月 6 日还是 6 月 4 日。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:54:51.670

改变后就是`Customer`这样：`SurveyDate``DateTime`

```
select new Customer()
    {
        contactID = customerRecord[0],
        surveyDate = DateTime.Parse(customerRecord[1]),
        project = customerRecord[2],
        projectCode = customerRecord[3]
    }; 
```

您可能需要使用`Parse`或`ParseExact`采用格式字符串的形式，以确保结果正确。该格式字符串取决于文件中使用的格式。

或者，您可以在 Customer 上创建一个`Parse`静态方法：

```
public class Customer
{
    public string contactID { get; set; }
    public DateTime surveyDate { get; set; }
    public string project { get; set; }
    public string projectCode { get; set; }
    public static Customer Parse(string line)
    {
       var parts = line.Split(',');
       return new Customer{
         contactID = parts[0],
         surveyDate = DateTime.Parse(customerRecord[1]),
         project = customerRecord[2],
         projectCode = customerRecord[3]
      };
}; 
```

然后：

```
var csv =
  from line in File.ReadLines("C:/file.csv")
  select Customer.Parse(line); 
```

`Customer`如果从这样的格式化字符串中获取 a 在您的代码中不止一次发生，这将具有优势。`Customer`如果这是您唯一这样做的地方，它会不必要地充满杂物。请注意，我更喜欢`ReadLines`一次`ReadAllLines`获得一条线，而不是在开始生产客户之前阅读整个内容。

顺便说一句，.NET 约定倾向于属性名称大写。`SurveyDate`而不是`surveyDate`等

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-31T14:48:42.563

您应该将`customerRecord[1]`字符串转换为`DateTime`.

```
var csv =
    from line in File.ReadAllLines("C:/file.csv")
    let customerRecord = line.Split(',')
    select new Customer()
        {
            contactID = customerRecord[0],
            surveyDate = DateTime.Parse(customerRecord[1]),
            project = customerRecord[2],
            projectCode = customerRecord[3]
        };

public class Customer
    {
        public string contactID { get; set; }
        public DateTime surveyDate { get; set; }
        public string project { get; set; }
        public string projectCode { get; set; }
    } 
```*

# c++ - 同步 1 个生产者和多个消费者（多线程）

> ID：12217739
> 
> 赞同：0
> 
> 时间：2012-08-31T14:46:27.363
> 
> 标签：c++, linux, multithreading

我想实现生产者-消费者场景，其中有一个生产者线程和多个消费者线程。让我具体说一下，生产者线程需要定期（例如，5 秒）创建一组对象，而消费者线程需要消耗这些对象。

我不确定如何定期创建一组对象以及如何同步多个消费者。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:52:27.787

你到底有什么问题？传统上，工作队列由条件锁保护；如果多个“消费者”正在等待同一个锁，那么他们中只有一个会成功获得它。但是，不要抓取整个队列，而应该只从其中抓取一个对象，将其从队列中删除，然后在处理作业之前释放锁。

至于定期创建作业，这是您使用的任何库中的计时器类的作业。如果您正在等待输入，则 select() 和 poll() 调用具有超时值；如果你什么都不做，你可以调用 [u]sleep()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:08:18.683

我不会详细说明所有代码，但您可以为此使用互斥锁和条件变量（以及链表）。基本模式是生产者执行以下操作：

```
loop_forever
    wait_until_interval_has_elapsed
    lock_the_mutex
        append_an_item_to_the_list
        signal_the_condvar // can be outside the mutex
    unlock_the_mutex 
```

每个消费者都会：

```
loop_forever
    lock_the_mutex
        while(list_is_empty)
            wait_the_condvar
        remove_an_item_from_the_list
    unlock_the_mutex
    process_the_item 
```

您也可以使用互斥锁和信号量来实现：

```
loop_forever
    wait_until_interval_has_elapsed
    lock_the_mutex
        append_an_item_to_the_list
    unlock_the_mutex
    post_the_semaphore

loop_forever
    wait_the_semaphore
    lock_the_mutex
        remove_an_item_from_the_list
    unlock_the_mutex
    process_the_item 
```

就目前而言，这稍微简单一些，但是一旦您决定添加一种机制来告诉消费者完成他们正在做的事情并退出，您可能最好使用条件变量，因为您可以“广播”它。信号量因易于误用而享有盛誉，这就是 C++11 没有信号量的原因。不过，Posix 确实如此，所以在 linux 上您可以选择。公平地说，几乎所有其他多线程操作系统也是如此。

在线程具有不同优先级的情况下，mutex/condvar 对也可能比信号量提供更好的行为。与互斥锁不同，信号量没有“所有者”，因此优先级继承等技术是不可能的。

使用`wait_until_interval_has_elapsed`计时器或睡眠功能 - 请注意，除非您在实时系统上，否则您永远无法确定您将能够在特定时间运行，只能确定您会在特定时间或之后被唤醒.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:10:12.577

您将需要一种方法来告诉消费者线程有可用的新对象。这是一个示例（我没有包括`#include`s）：

```
#define NUM_CONSUMERS 2

static int objects[4]; //The place for produced objects
static pthread_mutex_t cond_mut = PTHREAD_MUTEX_INITIALIZER;
static pthread_cond_t cond = PTHREAD_COND_INITIALIZER;

void* producer_func(void* arg);
void* consumer_func(void* arg);

int main(int argc, char** argv) {
  pthread_t producer;
  pthread_t consumers[NUM_CONSUMERS];
  int res;
  void* zero = 0;
  res = pthread_create(&producer, NULL, producer_func, zero); 
  for(int i = 0; i < NUM_CONSUMERS; i++) {
    res = pthread_create(&consumers[i], NULL, consumer_func, zero);
  }
}

void* producer(void* arg) {
  while(1) {
    objects[0] = 0;
    objects[1] = 1;
    objects[2] = 2;
    objects[3] = 3;
    pthread_mutex_lock(&cond_mut);
    pthread_cond_signal(&cond);
    pthread_mutex_unlock(&cond_mut);
    sleep(5);
  }
}

void* consumer(void* arg) {
  while(1) {
    pthread_mutex_lock(&cond_mut);
    pthread_cond_wait(&cond);
    pthread_mutex_unlock(&cond_mut);
    //Process objects here 
  }
} 
```

# sql-server-2005 - 在存储过程中省略参数值时，希望它为所有值显示

> ID：12217740
> 
> 赞同：2
> 
> 时间：2012-08-31T14:46:28.800
> 
> 标签：sql-server-2005

在存储过程中，当未指定参数值时，我希望它显示列中所有值的结果。

我尝试了如下代码，但如果我在执行时将参数 field1 留空，它将不起作用并要求提供 field1 值。

```
create procedure procedurename
declare @startdate datetime, @enddate endtime, @field1 varchar(15)

select * from table1
where field1 = @xyz or @xyz is null
and date between @startdate and @enddate

execute procedurename @startdate = '01/07/2012', @enddate = '31/07/2012' 
```

*[我省略了 field1 值，因此它应该显示两个日期之间 field1 列中所有值的结果]*，但它要求提供参数值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:55:53.567

如果要在调用中省略该字段，则需要在过程的声明中提供默认值。

```
create procedure procedurename (
    @startdate datetime, 
    @enddate endtime, 
    @field1 varchar(15) = NULL
)
AS
... 
```

# xpages - Dojo 内容窗格和 ssjs

> ID：12217742
> 
> 赞同：0
> 
> 时间：2012-08-31T14:46:36.880
> 
> 标签：xpages

我有一个内容窗格，我正在加载一些动态内容 - 一些字段和一个按钮。单击按钮时，不执行 ssjs。为简单起见，我只是设置了一个 sessionScope 变量并且它没有被设置。如果我将窗格内容设为静态，那么 ssjs 会正常触发。

所以问题是如果它被动态加载到dojo内容窗格中，应该是一个执行ssjs工作的按钮吗？

这个应用程序没有使用 ExtLib。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:26:27.283

我很确定这不会起作用，因为 dijit.layout.ContentPane 不会加载脚本。您应该使用[dojox.layout.ContentPane](http://dojotoolkit.org/reference-guide/1.8/dojox/layout/ContentPane.html)并将属性“executeScript”设置为 true。然后它应该正确加载并触发所有操作。

# sql - 条件选择的 SQL 语法

> ID：12217744
> 
> 赞同：1
> 
> 时间：2012-08-31T14:46:44.507
> 
> 标签：sql, sql-server

我正在尝试从三个表中选择数据。我的逻辑应该是这样的：

基本上从由表 A 中的列确定的两个表之一中选择。

```
Select a.orderid , 
if (a.ordertable= b) then b.order_info
else 
 c.order_info 
where 
a.order_id = b.order_id or a.order_id = c.order_id 
```

任何指针？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T14:49:42.213

利用`CASE`

```
SELECT a.orderid,
    CASE
        WHEN a.ordertable = b.? THEN b.order_info
        ELSE c.order_info
    END
FROM sparkles
WHERE a.order_id = b.order_id OR a.order_id = c.order_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:49:44.437

想到的是两个子查询，它们联合在一起以从每个表中获取结果：

```
select *
from ((select b.order_info
       from b join
            a
            on a.order_id = b.order_id and
               a.ordertable = 'b'
      )
      union all
      (select c.order_info
       from c join
            a
            on a.order_id = c.order_id and
               c.ordertable = 'c'
     )
    ) t 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:54:08.830

假设表 b 或 c 中的行可能存在也可能不存在，我认为你需要这个：

```
select  a.orderid,
        case 
            when a.ordertable = 'b' then b.order_info
            else c.order_info
        end as order_info
from    a
left 
join    b
        on a.orderid = b.orderid
left 
join    c
        on a.orderid = c.orderid 
```

# iphone - iPhone开发：倒放动画

> ID：12217745
> 
> 赞同：0
> 
> 时间：2012-08-31T14:46:53.323
> 
> 标签：iphone, objective-c, ios, animation, uiviewcontroller

在我的应用程序中有一个动画。当我按下按钮时，将执行动画（假设一个框从左向右移动。）并且 ViewController 由“pushViewContreller”更改。我想要的是当我从 secondViewController 使用 popViewController 时，应该打开 firstViewController 并且框应该从右向左移动（反向操作）。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T12:02:17.457

如果你想移动一个盒子，那么你可以使用这个代码。首先让两个 CGRect 说 CGRect left 和 CGRect right 。

然后在 firstViewController 的 viewWillAppear 中编写这段代码。

```
 CGRect left = //Your left side Frame
        CGRect right = //Your right side frame
        if (CGRectContainsPoint(right, YourObject.center))
        {

             [UIView animateWithDuration:0.3 animations:^{

                 [YourObject setFrame:left];

             }];
        } 
```

在这段代码中，viewWillAppear 会在你每次弹出 secondViewController 时调用，如果你的盒子在右边，它会制作向左移动的动画。

在按钮上单击编写此代码

```
 CGRect left = //Your left side Frame
        [UIView animateWithDuration:0.3 animations:^{

             [YourObject setFrame:left];

        }]; 
```

希望您在使用此代码后会感到高兴........

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:51:40.720

在导航之前，保存盒子的开始位置和结束位置，当你回来时将盒子从结束位置移动到开始位置。

# asp.net - 我如何决定在视图状态中存储什么？

> ID：12217748
> 
> 赞同：5
> 
> 时间：2012-08-31T14:47:06.960
> 
> 标签：asp.net, viewstate

我一直在编写一堆通用的 ASP.NET 控件，而我似乎无法理解的一件事是何时将值存储在视图状态中，以及何时假设不存储是可以的。

一方面，将控件的整个状态存储在视图状态中是有意义的，包括以下属性：

*   用户输入的文本框值（或任何表单数据）
*   高度或页面大小等配置选项
*   甚至控件是如何组成的——例如存储构建网格视图的所有数据，或者网格本身。

忽略性能，你可以在视图状态中推动的越多越好，因为这意味着控件在回发中的行为将完全相同，并且永远不会“意外”恢复一个值或“忘记”它被禁用。但是视图状态不是免费的。存储所有内容意味着控件现在将输出 HTML 及其所有内部属性以创建该 HTML，这几乎总是输出的两倍以上。

我的问题不是关于性能，而是关于策略。**我决定将属性置于视图状态中的标准是什么？**我在想一些事情：

> 如果用户无法更改属性，那么服务器将始终显式设置它，因此可以将其置于视图状态之外。即使对于类似的东西`color=red`，用户也不会直接设置此属性；他们将单击其他地方的按钮，间接设置此属性。该按钮或其所有者应保持状态，而不是呈现红色的控件。

这个逻辑意味着应该进入视图状态的唯一属性是：

1.  像这样的表单元素`<input>`（并且`Request.Form[c.UniqueID]`仍然可以避免）
2.  用户可以直接在控件上以交互方式控制的属性。

这个逻辑有意义吗？它似乎很弱，我想听听专家的更多信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T14:50:51.657

用于`ViewState`控件工作不需要的东西。

`ControlState`即使 ViewState 被禁用，也可用于您的控件正常工作所必需的内容。

第一次请求页面时，初始值和控件层次结构（甚至 html 控件）被编译到临时 ASP.NET 文件中。因此，当它们从未更改时，它们不需要存储在任何地方（甚至 ViewState 也不会保存它们）。

控件仅存储在页面生命周期（自 以来）`ViewState`期间发生更改的属性。`TrackViewState`更改状态的控件是“脏”的。例如，如果您更改`TextBox1.Text`page_load，[`ViewState.IsItemDirty("TextBox1.Text")`](http://msdn.microsoft.com/en-us/library/system.web.ui.statebag.isitemdirty.aspx)将返回 true。这些值将存储在 ViewState 中。

看看 [这里](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)和[这里](http://msdn.microsoft.com/en-us/library/ms972976.aspx)。（我真的建议阅读这两篇文章）

[控制状态与视图状态示例](http://msdn.microsoft.com/en-us/library/1whwt1k7%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T14:55:51.917

查看 MSDN 上的这篇文章，涵盖何时、何地以及如何使用 ASP.NET 中提供的大量状态管理选项，为方便起见，下面发布了视图状态部分 - 检查您的要求与优缺点应该指导您在案例中的使用根据具体情况：

整篇文章在这里：http: [//msdn.microsoft.com/en-us/library/z1hkazw7 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/z1hkazw7(v=vs.100).aspx)

视图状态摘录：

> **查看状态**
> 
> Web 窗体页面提供 ViewState 属性作为内置结构，用于在同一页面的多个请求之间自动保留值。视图状态作为页面中的隐藏字段进行维护。有关详细信息，请参阅 ASP.NET 状态管理概述。
> 
> 当页面回发给自身时，您可以使用视图状态在往返过程中存储您自己的页面特定值。例如，如果您的应用程序正在维护特定于用户的信息（即在页面中使用但不一定是任何控件的一部分的信息），您可以将其存储在视图状态中。
> 
> **使用视图状态的优点是：**
> 
> 不需要服务器资源视图状态包含在页面代码中的结构中。
> 
> 简单实现视图状态不需要任何自定义编程即可使用。默认情况下，维护控件的状态数据是打开的。
> 
> 增强的安全功能 视图状态中的值经过散列、压缩和编码以用于 Unicode 实现，这提供了比使用隐藏字段更高的安全性。
> 
> **使用视图状态的缺点是：**
> 
> 性能注意事项 因为视图状态存储在页面本身中，所以存储较大的值会导致页面在用户显示和发布时变慢。这对于带宽通常是限制的移动设备尤其重要。
> 
> 设备限制 移动设备可能没有存储大量视图状态数据的内存容量。
> 
> 潜在的安全风险视图状态存储在页面的一个或多个隐藏字段中。尽管视图状态以散列格式存储数据，但它仍然可以被篡改。如果直接查看页面输出源，则可以看到隐藏字段中的信息，从而产生潜在的安全问题。有关详细信息，请参阅 ASP.NET Web 应用程序安全性和 Web 应用程序的基本安全实践。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:50:02.653

我认为您担心视图状态膨胀是正确的，但是您还有哪些其他选择？如果你不在那里存储你的变量数据，你会把它放在哪里？（您可能希望考虑删除一些配置项——也许不要让用户更改这么多属性）。

# javascript - 在 MVC3 中使用 AJAX 从控制器中检索数据

> ID：12217750
> 
> 赞同：0
> 
> 时间：2012-08-31T14:47:16.637
> 
> 标签：javascript, jquery, ajax, asp.net-mvc-3, setinterval

对于我的公司，我们正在为一个发票系统构建一个 Web 应用程序，该系统使用类似于 Facebook 的通知栏，用户可以在其中下拉一个菜单，该菜单显示系统上的交易状态以及未完成交易的总数旁边显示。详情请看图片。

[http://img210.imageshack.us/img210/4379/alertdrop.png](http://img210.imageshack.us/img210/4379/alertdrop.png)

我们正在使用下拉菜单中的表的以下代码检索数据：

```
<table id="alertDropTable" style="margin-top:10px;">

    @{
        Dictionary<string, int> dic = ViewBag.statusCount;
        if (dic != null)
        {
            for (int i = 0; i < dic.Count; i++)
            {
                if (dic.Values.ElementAt(i) > 0)
                {
                    <tr>
                        <td width="100%" style="padding-bottom:4px; padding-top:4px; padding-left:10px; padding-right:10px; vertical-align:middle;">
                            You have <strong><a style="background-color:#878787; border-radius:5px; color:White; padding:3px;">@dic.Values.ElementAt(i)</a></strong> @dic.Keys.ElementAt(i) transaction(s).
                        </td>
                    </tr>
                }
            }
        }
    }

</table> 
```

以下是跨度，显示总数：

```
<div style="float: left;">
    <a href="javascript:;" onmouseover="document.alert.src='@Url.Content("~/Content/images/alert_notification_hover.png")'" onmouseout="document.alert.src='@Url.Content("~/Content/images/alert_notification.png")'" onclick="toggle('notificationDrop');"><img src="@Url.Content("~/Content/images/alert_notification.png")" name="alert" alt="alert"/></a>

            @{
                Dictionary<string, int> dicheader = ViewBag.statusCount;
                int diccount = 0;
                if (dicheader != null)
                {
                    for (int i = 0; i < dicheader.Count; i++)
                    {
                        if (dicheader.Values.ElementAt(i) > 0)
                        {
                            diccount = diccount + @dicheader.Values.ElementAt(i);
                        }
                    }
                }
            }

    </div>

    <div id="alertTotalDiv" style="float:left;margin-top:6px; margin-left:5px;"><span id="alertTotal" style="vertical-align:middle; background-color:#878787; border-radius:5px; color:White; font-family:Georgia; font-size:20px; padding:3px; padding-left:5px; padding-right:5px;margin-top:0px;">@diccount</span></div> 
```

此代码当前存储在全局“_layout.cshtml”文件中。请原谅代码的粗糙，这是一个非常早期的版本。但是，这在检索页面加载数据方面效果很好。但是，系统要求这些信息每隔几秒自动更新一次，而无需刷新整个页面。本质上，调用控制器以带回当前数据并使用当前值更新`<table>`和。`<span>`

我被要求创建一个 Ajax 函数，该函数从“AlertController”中检索数据并相应地更新视图。请在下面找到此控制器的内容：

```
public class AlertController : Controller
{

    /// <summary>
    /// Gets or sets the user service contract.
    /// </summary>
    /// <value>The user service contract.</value>
    public IUserServiceContract UserServiceContract { get; set; }

    /// <summary>
    /// Initializes a new instance of the <see cref="BaseController"/> class.
    /// </summary>
    protected AlertController()
    {
        this.UserServiceContract = Gateway.Instance.Resolve<IUserServiceContract>();

    }

    /// <summary>
    /// Get the AlertTypes
    /// </summary>
    /// <returns></returns>
    public virtual void ViewAlerts()
    {
        Gateway.Instance.Logger.LogInfo(string.Format("Overview Controller View:    Fetching list of alerts."));

        try
        {
            if (this.UserServiceContract != null)
            {
                var allAnnouncements = this.UserServiceContract.GetAnnoucements();
                var userAlertSettings = this.UserServiceContract.GetUserAlert();

                ViewBag.statusCount = userAlertSettings;
                ViewBag.announcements = allAnnouncements.ToList();
            }
        }
        catch (Exception ex)
        {
            Gateway.Instance.Logger.LogInfo(ex);
            throw new Exception(string.Format("Home Controller View Error:  {0} occured while fetching alerts.", ex.Message), ex);
        }
    } 
```

我被难住了，但得到了以下 Ajax 函数示例，该函数用于完全执行不同的任务，以帮助我：

```
$.ajax({
    url: '@Url.Action("ViewAlerts", "Alerts")',
    data: { ownerIds: ownerIds },
    traditional: true,
    dataType: 'json',
    success: function (result) {
        for (i = 0; i < ownerIds.length; i++) {
            $(".ownersTable tr[id='tablerow+" + ownerIds[i] + "']").remove();
        }
    },
    error: function (xhr, ajaxOptions, thrownError) {
        $("#confirmDiv").alertModal({
            heading: '@Language.Fail',
            body: '@Language.AlertRemoveOwnerFailed' + thrownError
        });
    }
}); 
```

到目前为止，我唯一设法开始工作的是一个设置间隔函数，它每 5 秒发出一次警报！

对此有何指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:03:11.267

好的，这就是你需要做的，首先：

```
$.ajax({
    url: '@Url.Action("ViewAlerts", "Alerts")', 
    data: { ownerIds: ownerIds },
    traditional: true,
    dataType: 'json',
    success: function (result) {
        for (i = 0; i < ownerIds.length; i++) {
            $(".ownersTable tr[id='tablerow+" + ownerIds[i] + "']").remove();
        }
    },
    error: function (xhr, ajaxOptions, thrownError) {
        $("#confirmDiv").alertModal({
            heading: '@Language.Fail',
            body: '@Language.AlertRemoveOwnerFailed' + thrownError
        });
    }
}); 
```

为什么 Url.Action 在引号中？只需输入@Url.Action ...我没有看到引用的理由，它可能会打断你的电话。

其次，不要使用 ViewBag。它不应该真正用于保存“数据”（在我看来）。你应该使用一个模型。所以这是你可以做的：

将您想要更新的页面部分创建为“部分视图”，该部分视图被强类型化到包含状态和公告以及您需要的任何其他内容的模型中。

使用 Jquery 来“加载”将获取数据并返回此“部分视图”的 Controller 方法，并将其加载到屏幕示例上的 Div 中：

```
$('#div-to-load-into').load('/myactionurl/', function () { //Do something when done }); 
```

然后调用您的控制器，获取数据并返回带有您创建的模型的局部视图！

祝你好运！

---编辑---你应该在上面做，因为它会更容易和更快（如果你重新设计你会很快理解，但这里是如何做你想做的事情的想法）

这是你需要知道的，

**url**是 Ajax 将要调用的操作。你需要把 url: '/controller/action'

**data**是您发送给该操作的数据 { parameter-name: parameter } 在您的情况下，您似乎没有发送数据，因为您只轮询刷新，因此您不需要包含此

**dataType**是您期望返回的数据，它可以是 'html' 或 'json' ，在你的情况下你什么都不返回，因为你使用了 'ViewBag'

**如果成功调用了 ajax 调用并且没有错误，则成功**将被调用，结果在“结果”中，在你的情况下你没有结果，因为你使用了视图包。

现在我不能保证这会奏效，因为我从未尝试过：

```
function(result)
{
var updated_values = @Html.Raw(Json.Encode(ViewBag.AlertStatus)) 
} 
```

在 ajax 上的成功函数中试试这个，这可能会也可能不会。老实说，我不知道 ViewBag 是否会有更新的值。此时，您只需将表值替换为新值！你必须在javascript中完成所有这些，我建议查看Jquery中的'appendTo'，'replaceWith'，'html'等函数来弄清楚如何做到这一点。

```
$.ajax({
    url: 'controller/action', 
    success: function (result) {
        var alert_info = @Html.Raw(Json.Encode(ViewBag.AlertStatus)) 
    },
    error: function (xhr, ajaxOptions, thrownError) {
        //error handling
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:04:10.000

```
(function checkStatus() {
  $.ajax({
    url: '@Url.Action("ViewAlerts", "Alerts")', 
    data: { ownerIds: ownerIds },     
    traditional: true,     
    dataType: 'json',
    success: function (result) 
    {         
      for (i = 0; i < ownerIds.length; i++) 
       {             
         $(".ownersTable tr[id='tablerow+" + ownerIds[i] + "']").remove();
       }     
    },
    complete: function() {
      // Schedule the next request when the current one's complete
      setTimeout(checkStatus, 5000);
    }
  });
})(); 
```

[如何定期触发 AJAX 请求？](https://stackoverflow.com/questions/5052543/how-to-fire-ajax-request-periodically)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T16:46:22.310

为了从动作中获取数据到 JavaScript，你的动作必须返回数据。现在，您的“动作”并不是真正的动作，因为它返回`void`并设置`ViewBag`属性，这些属性无法通过 JavaScript 访问。因此，您的操作需要更像：

```
[HttpGet]
public ActionResult Alerts()
{
    IEnumerable alerts;
    // ...code which gets data into alerts
    return JsonResult(alerts);
} 
```

显然我不知道您的域，所以我不知道您将如何构造返回的数据，但基础知识就在那里。该`$.ajax`调用将指向操作路线（在这种情况下，可能是`'/Alert/Alerts'`）。该`success`函数将具有`data`带有适当对象数组的参数。从那里您将使用数据更新您的 DOM。

# php - 查询中的随机项

> ID：12217751
> 
> 赞同：1
> 
> 时间：2012-08-31T14:47:17.800
> 
> 标签：php, mysql, random

我有一个包含 16000 行的数据库。我想随机抓取 400 行。

我将如何完成这项任务？我会在 Sql 中做吗？或者选择所有 16000 行，然后将随机的 400 转储到数组中？

我是 PHP 和编程新手..

谢谢你的帮助。

```
$result = mysql_query ('SELECT * FROM AllImages') or die ('Error query: '.mysql_error ()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:48:45.057

`SELECT * FROM AllImages order by RAND() limit 400`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-31T14:48:48.180

```
SELECT ... ORDER BY RAND() LIMIT 400 
```

此外，`mysql_*`已弃用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:49:17.300

你可以试试这个：

```
$result = mysql_query ('SELECT * FROM AllImages ORDER BY RAND() LIMIT 400'); 
```

尽管如果您有很多行，这不是很好的解决方案

# internet-explorer - 带有 IE 登录的 VBA/VBscripting 自动 Web Scraping 循环

> ID：12217761
> 
> 赞同：4
> 
> 时间：2012-08-31T14:47:46.043
> 
> 标签：internet-explorer, vbscript

我一直在尝试编写一个脚本，该脚本将在渲染网站上抓取某个字段/标签。该网站使用我在 Excel 的列列表中的搜索参数呈现。大约 20 个会增长的项目。在研究了如何使用 vbscripts 进行网络抓取之后，我遇到的问题是如何在不中断的情况下执行 20 次。这是我的代码。

Excel 栏

```
1492565
1528417
1529041
1530688
1492038
1492319
1492972
1508824
1513351
1514724
1514750
1518526
1520627
1520706
1520979
1523367
1523563 
```

脚本：主子（从 excel 输入字段获取用户/通行证，通过特定列上的行设置循环。只吐回一个 msgbox，直到我可以让循环工作。然后我将它输出到另一列

```
Sub WebScraper()
    'itg on mainWS start row 6, column 5
    'itg status column column 19
    'declare variables
    Dim url As String
    Dim ITGNUMBER As Long
    Dim user As String
    Dim pwd As String

    'set variables
    url = "https://website/itg/web/knta/crt/RequestDetail.jsp?REQUEST_ID="
    Set oMainWS = ActiveWorkbook.Worksheets("MainWS")
    Set oITGStatusWS = ActiveWorkbook.Worksheets("ITGStatus")
    user = ""
    pwd = ""

    user = oITGStatusWS.ITGusername.Value
    pwd = oITGStatusWS.ITGpassword.Value

    If user = "" Or pwd = "" Then
        MsgBox ("You must enter username/password before continuing")
        Exit Sub
    End If

    'log in
    Set objIE = FirstIEConnect(user, pwd)

    'start row is 6
    RowCounter = 58
    ColumnCounter = 5
    ITGStatusColumn = 16
    Do Until IsEmpty(oMainWS.Cells(RowCounter, 5).Value)
        'get ITG number
        currentITGNumber = oMainWS.Cells(RowCounter, 5).Value
        MsgBox (currentITGNumber)
        'get remote status
        currentITGStatus = getITGStatusFunction(objIE.Application, Str(currentITGNumber))
        MsgBox (currentITGStatus)

        'paste into column 19
        'oMainWS.Cells(RowCounter, 19).Value = currentITGStatus

        'increment counter
        RowCounter = RowCounter + 1
        currentITGStatus = ""
        currentITGNumber = ""
    Loop
    quitIE (objIE.Application)
End Sub 
```

子退出IE对象清理，有一个javascript函数可以注销用户。

```
Sub quitIE(obj As Object)
    obj.Navigate ("javascript: closeChildWindowsAndLogout();")
    obj.Quit
End Sub 
```

从谷歌得到这个子，用来等待 IE 对象准备好。这实际上在循环中失败了很多。On Do While IE.Busy:Loop。就挂了。

```
Sub Wait(obj As Object)
    Do While obj.Busy: Loop
    Do While obj.readyState <> 4:   Loop
     Application.Wait (Now + TimeValue("0:00:01"))
End Sub 
```

该网站需要登录，用户/密码来自第一个子。该子程序创建 IE 对象，导航到登录页面并将用户/密码插入到`Document.logon.UserName`和`Document.logon.Password`中。最后提交。

```
Function FirstIEConnect(user As String, pwd As String)
    loginURL = "https://website/Logon.jsp"
    Set IE = CreateObject("InternetExplorer.Application")
    IE.Visible = False
    IE.Navigate loginURL
    Wait (IE.Application)
    With IE.Document.logon
      .UserName.Value = user
      .Password.Value = pwd
      .submit
    End With

    Set FirstIEConnect = IE
End Function 
```

这是实际的网页抓取功能。要求用户从上面登录到 IE 对象。在 url GET 请求中输入 num 以呈现特定页面。最后`responseText`根据 ElementID 抓取

```
Function getITGStatusFunction(obj, num)
    On Error Resume Next
    'set url and num
    url = "https://website/RequestDetail.jsp?REQUEST_ID=" & num

    obj.Navigate url
    Wait (obj.Application)
    responseText = obj.Document.getElementByID("DRIVEN_STATUS_ID").innerHTML

    getStatusFunction = responseText

End Function 
```

同样，问题是我在尝试从不同的子程序和函数传递 IE 对象时不断收到对象错误。

期望：我希望脚本循环遍历包含唯一数字的 excel 中的列信息。将这些数字一一获取，并将它们一一附加到搜索 URL。页面加载后，将`ElementID(DRIVEN_STATUS_ID)`. 最终获取该值并将其输出到另一列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:17:56.833

只是在黑暗中拍摄，但这听起来像当您尝试设置值时 HTML 尚未完全加载。尝试使用更长的等待值。通常 3-4 秒就可以了。

或者您可以创建一个新变量并设置一个循环，直到设置对象：

```
Dim obj_testVariable as Object

Do Until Not obj_testVariable Is Nothing
   set obj_testVariable = obj.Document.getElementByID("DRIVEN_STATUS_ID")
Loop

responseText = obj_testVariable.innerHTML

set obj_testVariable = Nothing 
```

（未经测试）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T16:05:34.907

`Wait (IE)`正在传递`IE.Name`而不是对象。要传递对象，请使用`IE.Application`.

Tim Williams 的评论也是正确的，省略括号也会导致对象被传递。所以`Wait IE`代替`Wait (IE)`也会起作用。但我认为`Wait IE.Application`只是为了明确使用更安全。显然，你决定。

如果您要更新等待功能，它仍然无法解决问题，但问题出在哪里会更明显。 `Function Wait(IE as object)`当您尝试调用说明需要对象的函数时失败。

这一点应该很明显，但不要传递`IE`，传递`IE.Application`所有实例，除非您实际上只想要对象的名称。

顺便说一句，这些`Set variable = IE`行很好，因为关键字`Set`清楚地表明您想要该对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-04T01:32:46.207

这是我的`IEWait`功能：

```
Dim IE As Object

Function IEWait(t As Long)

  Do While IE.Busy
    Application.Wait DateAdd("s", t, Now)
  Loop

End Function 
```

然后，您可以在子例程中调用此函数：

```
IEWait (1)
Do Until IE.readyState = READYSTATE_COMPLETE: DoEvents: Loop 
```

仅`IEWait (1)`在您只需要提交某些内容时使用。当您需要等待加载新页面时，请使用上述两行。这将需要一些时间，但只是玩玩。祝你好运。

# python - Django ORM 是否具有等效于 SQLAlchemy 的混合属性？

> ID：12217763
> 
> 赞同：7
> 
> 时间：2012-08-31T14:47:55.960
> 
> 标签：python, database, django, orm, sqlalchemy

在[SQLAlchemy](http://docs.sqlalchemy.org/en/rel_0_7/index.html)中，[混合属性](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/hybrid.html)是应用于 ORM 映射类的[属性或方法，](https://stackoverflow.com/questions/6618002/python-property-versus-getters-and-setters)

```
class Interval(Base):
    __tablename__ = 'interval'

    id = Column(Integer, primary_key=True)
    start = Column(Integer, nullable=False)
    end = Column(Integer, nullable=False)

    def __init__(self, start, end):
        self.start = start
        self.end = end

    @hybrid_property
    def length(self):
        return self.end - self.start

    @hybrid_method
    def contains(self,point):
        return (self.start <= point) & (point < self.end)

    @hybrid_method
    def intersects(self, other):
        return self.contains(other.start) | self.contains(other.end) 
```

这允许在类和实例级别有不同的行为，从而使使用相同代码评估 SQL 语句变得更简单，

```
>>> i1 = Interval(5, 10)
>>> i1.length
5

>>> print Session().query(Interval).filter(Interval.length > 10)
SELECT interval.id AS interval_id, interval.start AS interval_start,
interval."end" AS interval_end
FROM interval
WHERE interval."end" - interval.start > :param_1 
```

现在在[Django](https://docs.djangoproject.com/en/1.4/topics/db/models/)中，如果我在模型上有一个属性，

```
class Person(models.Model):
    first_name = models.CharField(max_length=50)
    last_name = models.CharField(max_length=50)

    def _get_full_name(self):
        "Returns the person's full name."
        return '%s %s' % (self.first_name, self.last_name)
    full_name = property(_get_full_name) 
```

据我[了解](https://stackoverflow.com/questions/4754283/django-query-based-on-dynamic-property)，我*不能*执行以下操作，

```
Person.objects.filter(full_name="John Cadengo") 
```

Django中是否有相当于SQLAlchemy的混合属性？如果没有，是否有一个常见的解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:10:55.787

没错，您不能基于 python 属性应用 django 查询集过滤器，因为过滤器在数据库级别上运行。似乎 Django 中没有与 SQLAlchemy 的混合属性等效的东西。

请看[这里](https://stackoverflow.com/questions/7557288/django-queryset-filter-question)和[这里](https://stackoverflow.com/questions/1205375/filter-by-property)，可能会帮助您找到解决方法。但是，我认为没有通用的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-04-03T23:45:07.137

一种可能的快速解决方法是实现一些描述符，该描述符将通过注释应用表达式。像这样的东西：

```
from django.db import models
from django.db.models import functions

class hybrid_property:
    def __init__(self, func):
        self.func = func
        self.name = func.__name__
        self.exp = None

    def __get__(self, instance, owner):
        if instance is None:
            return self
        return self.func(instance)

    def __set__(self, instance, value):
        pass

    def expression(self, exp):
        self.exp = exp
        return self

class HybridManager(models.Manager):
    def get_queryset(self):
        qs = super().get_queryset()
        for name, value in vars(qs.model).items():
            if isinstance(value, hybrid_property) and value.exp is not None:
                qs = qs.annotate(**{name: value.exp(qs.model)})
        return qs

class TestAttribute(models.Model):
    val1 = models.CharField(max_length=256)
    val2 = models.CharField(max_length=256)

    objects = HybridManager()

    @hybrid_property
    def vals(self):
        return f"{self.val1} {self.val2}"

    @vals.expression
    def vals(cls):
        return functions.Concat(models.F("val1"), models.Value(" "), models.F("val2"))

class HybridTests(TestCase):
    def setUp(self) -> None:
        self.test_attr = TestAttribute.objects.create(val1="val1", val2="val2")

    def test_access(self):
        self.assertTrue(TestAttribute.objects.exists())
        self.assertEqual(self.test_attr.vals, f"{self.test_attr.val1} {self.test_attr.val2}")
        self.assertTrue(TestAttribute.objects.filter(vals=f"{self.test_attr.val1} {self.test_attr.val2}").exists())
        self.assertTrue(TestAttribute.objects.filter(vals__iexact=f"{self.test_attr.val1} {self.test_attr.val2}").exists()) 
```

# java - 如何在android中发出具有多个属性的ksoap2请求？

> ID：12217769
> 
> 赞同：2
> 
> 时间：2012-08-31T14:48:20.350
> 
> 标签：java, android, request, ksoap2, propertyinfo

我必须提出以下soap请求，但我们无法成功，我尝试了几种方法都失败了，我总是得到一个空白字段作为响应。

请求应如下所示：

```
POST /service.asmx HTTP/1.1
Host: host
Content-Type: text/xml; charset=utf-8
Content-Length: length
SOAPAction: "SOAPAction"

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <GetQuickParkEvents xmlns="NAMESPACE">
      <User>
        <ID>int</ID>
        <Name>string</Name>
        <UserName>string</UserName>
        <Password>string</Password>
      </User>
      <Filter>
        <TimeSpan>
          <Since>dateTime</Since>
          <To>dateTime</To>
        </TimeSpan>
        <Reg>string</Reg>
        <Nalog>string</Nalog>
        <Status>string</Status>
        <Value>string</Value>
      </Filter>
    </GetQuickParkEvents>
  </soap:Body>
</soap:Envelope> 
```

我现在有这个代码：

```
public static Object vrati_ds(String id, String name, String username, String password, String since, String to, String reg, String korisnik, String nalog, String nameString status, String value){
    try{
        SoapObject _client = new SoapObject(Konstante.NAMESPACE1, Konstante.METHOD_NAME);
        _client.addProperty("ID", id);
        _client.addProperty("Name", name);
        _client.addProperty("UserName", username);
        _client.addProperty("Password", password);
        _client.addProperty("Since", since);
        _client.addProperty("To", to);
        _client.addProperty("Reg", reg);
        _client.addProperty("Korisnik_app", korisnik);
        _client.addProperty("Nalog", nalog);
        _client.addProperty("Status", status);
        _client.addProperty("Value", value);
        SoapSerializationEnvelope _envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        _envelope.dotNet = true;
        _envelope.setOutputSoapObject(_client);
        HttpTransportSE _ht = new HttpTransportSE(Konstante.URL1);
        _ht.call(Konstante.SOAP_ACTION, _envelope);
        return _envelope.getResponse();
    } catch(Exception e) {
        return null;
    }
} 
```

如果有人可以帮助我，我提前感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T12:00:08.027

现在我手动硬编码 xml 请求，所以如果有人可以提供帮助，这里是有效的源代码：

```
public static Object getEvent2(int id, String name, String username, String password, String since, String to, 
        String reg, String nalog, String status, String value ) throws Exception {

    String response= null;
    String xml = null;

    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(Konstante.URL);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.encodingStyle = SoapSerializationEnvelope.ENC;

    String bodyOut = "<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">";
    bodyOut += "<soap:Body><"+Konstante.EVENS_METHOD_NAME+" xmlns=\"" + Konstante.NAMESPACE + "\">";
    bodyOut += "<User><ID>" + id + "</ID><Name>" + name + "</Name><UserName>";
    bodyOut += username + "</UserName><Password>" + password + "</Password></User>";
    bodyOut += "<Filter><TimeSpan><Since>" + since + "+02:00" + "</Since><To>" + to + "+02:00" +"</To></TimeSpan>";
    bodyOut += "<Reg>" + reg + "</Reg><Nalog>" + nalog + "</Nalog><Status>" + status + "</Status><Value>" + value + "</Value></Filter>";
    bodyOut += "</"+Konstante.EVENS_METHOD_NAME+"></soap:Body></soap:Envelope>";

    xml = bodyOut;

    StringEntity se = new StringEntity(xml, HTTP.UTF_8);
    se.setContentType("text/xml");
    httpPost.addHeader(Konstante.EVENS_SOAP_ACTION, Konstante.URL);
    httpPost.setEntity(se);

    HttpResponse httpResponse = httpClient.execute(httpPost);
    HttpEntity resEntity = httpResponse.getEntity();
    response = EntityUtils.toString(resEntity);

    return response;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-23T08:10:03.713

我也遇到了同样的问题。似乎信封对 SOAP 长度有限制，不允许大于 500……不确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-07T11:05:25.200

有点晚了，但这里有一个答案。基于[此提示](http://simpligility.github.io/ksoap2-android/tips.html)，您可以遵循一些示例。对于您的情况，我相信这应该有效：

```
 SoapObject request = new SoapObject(Konstante.NAMESPACE1, "GetQuickParkEvents");

SoapObject user = new SoapObject(Konstante.NAMESPACE1, "User");
user.addProperty("ID", "int");
user.addProperty("Name", "string");
user.addProperty("UserName", "UserName");
user.addProperty("Password", "Password");

SoapObject filter = new SoapObject(Konstante.NAMESPACE1, "Filter");

SoapObject timeSpan = new SoapObject(Konstante.NAMESPACE1, "TimeSpan");
timeSpan.addProperty("Since", "dateTime");
timeSpan.addProperty("To", "dateTime");

filter.addSoapObject(timeSpan);
filter.addProperty("Reg", "string");
filter.addProperty("Nalog", "string");
filter.addProperty("Status", "string");
filter.addProperty("Value", "string");

request.addSoapObject(user);
request.addSoapObject(filter); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T15:36:43.313

这是 ksoap2 教程：

[http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks#sending/receiving_array_of_complex_types_or_primitives](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks#sending/receiving_array_of_complex_types_or_primitives)

如果您需要更具体的帮助，请发布您当前的代码。

# linux - 需要修复小循环错误

> ID：12217773
> 
> 赞同：0
> 
> 时间：2012-08-31T14:48:37.423
> 
> 标签：linux, loops, if-statement, for-loop, while-loop

嗨，我的循环有问题，它在意外标记“fi”附近显示语法错误我不知道小问题在哪里，但我需要我的 if 循环和我的 for 循环才能工作：

```
if [ var1 == true ] then 
 for ip in $(seq 90 254); do ping -c 1 188.118.28.$ip;
done
fi 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:52:29.473

您缺少“；” 在那之前”

```
if [ var1 == true ]; then 
    for ip in $(seq 90 254); do ping -c 1 188.118.28.$ip; 
    done
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:05:04.563

这对我有用：

```
if $var1; then
  for ip in $(seq 90 254); do ping -c 1 188.118.28.$ip;
  done;
fi 
```

为了完整起见：我这样设置 var1 ：

```
var1=true 
```

# python - Python OSError：打开的文件太多

> ID：12217775
> 
> 赞同：2
> 
> 时间：2012-08-31T14:48:44.187
> 
> 标签：python, windows-xp, python-2.7

我在 Windows XP 上使用 Python 2.7。

我的脚本依赖 tempfile.mkstemp 和 tempfile.mkdtemp 来创建大量具有以下模式的文件和目录：

```
_,_tmp = mkstemp(prefix=section,dir=indir,text=True)

<do something with file>

os.close(_) 
```

运行脚本总是会引发以下错误（尽管确切的行号发生了变化等）。脚本尝试打开的实际文件会有所不同。

```
OSError: [Errno 24] Too many open files: 'path\\to\\most\\recent\\attempt\\to\\open\\file' 
```

关于如何调试它的任何想法？另外，如果您想了解更多信息，请告诉我。谢谢！

**编辑：**

这是一个使用示例：

```
out = os.fdopen(_,'w')
out.write("Something")
out.close()

with open(_) as p:
    p.read() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T17:04:21.833

`_`您调用时存储的值可能与`os.close(_)`创建临时文件时存储的值不同。尝试分配给命名变量而不是`_`.

如果您可以提供一个非常小的代码片段来演示错误，如果对您和我们都有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:55:20.737

为什么不使用[tempfile.NamedTemporaryFile](http://docs.python.org/library/tempfile.html#tempfile.NamedTemporaryFile)`delete=False`？这允许您使用 python 文件对象，这是一个好处。此外，它可以用作上下文管理器（它*应该*负责确保文件正确关闭的所有细节）：

```
with tempfile.NamedTemporaryFile('w',prefix=section,dir=indir,delete=False) as f:
     pass #Do something with the file here. 
```

# android - ExpandableListView expandGroup

> ID：12217778
> 
> 赞同：3
> 
> 时间：2012-08-31T14:48:45.353
> 
> 标签：android, android-layout, android-widget, expandablelistview

我正在尝试为 ExpandableListView 的展开和折叠设置动画。我的目标是 API 级别 15，因此可以使用方法 expandGroup `(int groupPos, boolean animate)`。但是，它不会为组的扩展设置动画。我的代码如下：

```
m_expandList.setOnGroupClickListener(new OnGroupClickListener(){
            public boolean onGroupClick(ExpandableListView parent, View v, int groupPosition, long id)
            {
                if(m_expandList.isGroupExpanded(groupPosition))
                {
                    m_expandList.collapseGroup(groupPosition);
                }
                else
                {
                    m_expandList.expandGroup(groupPosition,true);
                }
                return true; 
            }
        }); 
```

以下是布局的摘录：

```
<ExpandableListView
    android:id="@+id/ExpList"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_below="@id/MainLabel"   
    android:layout_above="@id/button1"     
    android:choiceMode="multipleChoice"/> 
```

我认为这可能是因为没有正确使用 API 或者遗漏了什么？

另外，为什么collapseGroup 没有相同的方法（我的意思是还包括动画布尔）？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T11:49:29.563

可能有点晚了，但是当您扩展该组的孩子的高度超过可用空间的组时，会触发扩展动画。

动画实际上是列表视图向下滚动以适应孩子的高度。这也是为什么折叠时没有动画的原因。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:39:14.217

删除侦听器（如果您仅将其用于扩展-折叠组）。这已经是`ExpandableListView`实际动画的默认行为。

# postgresql - Postgres 从动态 sql 字符串创建本地临时表（在提交删除时）

> ID：12217782
> 
> 赞同：6
> 
> 时间：2012-08-31T14:48:57.460
> 
> 标签：postgresql, user-defined-functions, plpgsql, postgresql-9.1

我有一个在 postgres UDF 中生成的查询字符串，我想把它的结果放在一个临时表中以执行连接（我正在使用`LIMIT`and `OFFSET`，我不想加入其他 ttables 只是为了结束砍最后关闭数据——即查询计划中的 LIMIT 运算符）。我尝试使用以下语句创建临时表。

```
CREATE LOCAL TEMP TABLE query_result ON COMMIT DROP AS EXECUTE query_string_; 
```

但我收到以下错误通知：

```
********** Error **********

ERROR: prepared statement "query_string_" does not exist
SQL state: 26000
Context: SQL statement "CREATE LOCAL TEMP TABLE query_result ON COMMIT DROP AS EXECUTE query_string_"
PL/pgSQL function "search_posts_unjoined" line 48 at SQL statement 
```

此外，我尝试准备声明，但我也无法正确使用语法。

有问题的UDF是：

```
CREATE OR REPLACE FUNCTION search_posts_unjoined(
    forum_id_ INTEGER,
    query_    CHARACTER VARYING,
    offset_ INTEGER DEFAULT NULL,
    limit_ INTEGER DEFAULT NULL,
    from_date_ TIMESTAMP WITHOUT TIME ZONE DEFAULT NULL,
    to_date_ TIMESTAMP WITHOUT TIME ZONE DEFAULT NULL,
    in_categories_ INTEGER[] DEFAULT '{}'
    )
RETURNS SETOF forum_posts AS $$
DECLARE
    join_string CHARACTER VARYING := ' ';
    from_where_date CHARACTER VARYING := ' ';
    to_where_date CHARACTER VARYING := ' ';
    query_string_ CHARACTER VARYING := ' ';
    offset_str_ CHARACTER VARYING := ' ';
    limit_str_ CHARACTER VARYING := ' ';
BEGIN
    IF NOT from_date_ IS NULL THEN
        from_where_date := ' AND fp.posted_at > ''' || from_date_ || '''';
    END IF;

    IF NOT to_date_ IS NULL THEN
        to_where_date := ' AND fp.posted_at < ''' || to_date_ || '''';
    END IF;

    IF NOT offset_ IS NULL THEN
        offset_str_ := ' OFFSET ' || offset_; 
    END IF;

    IF NOT limit_ IS NULL THEN
        limit_str_ := ' LIMIT ' || limit_;
    END IF;

    IF NOT limit_ IS NULL THEN
    END IF;

    CREATE LOCAL TEMP TABLE un_cat(id) ON COMMIT DROP AS (select * from unnest(in_categories_)) ;

    if in_categories_ != '{}' THEN
        join_string := ' INNER JOIN un_cat uc ON uc.id = fp.category_id ' ;
    END IF;

    query_string_ := '
    SELECT fp.*
    FROM forum_posts fp' ||
        join_string
    ||
    'WHERE fp.forum_id = ' || forum_id_ || ' AND
    to_tsvector(''english'',fp.post_text) @@ to_tsquery(''english'','''|| query_||''')' || 
        from_where_date || 
        to_where_date ||
        offset_str_ ||
        limit_str_ 
    ||  ';';

    CREATE LOCAL TEMP TABLE query_result ON COMMIT DROP AS EXECUTE query_string_;

    RAISE NOTICE '%', query_string_;

    RETURN QUERY
    EXECUTE query_string_;
END;
$$ LANGUAGE plpgsql; 
```

当有问题的语句被删除时，它就会起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T15:27:33.447

改用：

```
EXECUTE '
CREATE TEMP TABLE query_result ON COMMIT DROP AS '|| query_string_; 
```

*   `EXECUTE`整个声明。
    语法形式`CREATE TABLE foo AS EXECUTE <query>`无效。

*   `LOCAL`只是一个噪音词，在这种情况下被忽略。

手册中的更多[细节](http://www.postgresql.org/docs/current/interactive/sql-createtableas.html)。

# sqlite - SQLite 共享缓存

> ID：12217784
> 
> 赞同：0
> 
> 时间：2012-08-31T14:49:02.653
> 
> 标签：sqlite

我有一个巨大的（>10GB）sqlite 数据库，它在许多（最多 CPU 核心数）进程（相同的可执行文件）之间共享。这是一个专门的应用程序，所以 RAM 不是问题，我想在内存中缓存尽可能多的数据库。我已经发现[`PRAGMA cache_size;`](http://www.sqlite.org/pragma.html#pragma_cache_size)并且我正在成功使用它，但这会使 RAM 使用不成比例，因为许多进程中的每一个都有自己的私有缓存。

现在，我找到了[SQLite 共享缓存模式](http://www.sqlite.org/sharedcache.html)，但我看不出这是否适用于不同的进程或仅适用于一个进程中的线程。我已经运行了一些测试来确认后者，但我不确定我是否做错了什么，或者是否需要做其他事情来完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:23:31.993

该页面解释说“可以在整个进程中共享相同的缓存”。

理论上，您可以尝试配置您的操作系统，以便将整个数据库保存在文件缓存中。

如果单个查询中的数据量很小，那么使用客户端/服务器数据库可能是值得的，这样缓存只需要在服务器进程中完成。

# javascript - jquery scrollTo 不工作

> ID：12217792
> 
> 赞同：5
> 
> 时间：2012-08-31T14:49:28.523
> 
> 标签：javascript, jquery, jquery-plugins, scroll, scrollto

我只是想滚动到浏览器窗口中的特定 DOM 元素或绝对位置，但它不起作用。这是我的代码：

```
$(window)._scrollable();
$('#scene_01_down').click(function(){
    $(window).scrollTo(2000,1000);
}); 
```

这是插件的文档：

[http://flesler.blogspot.com/2007/10/jqueryscrollto.html](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-31T14:52:09.153

你真的需要那个插件吗？

```
$("html,body").animate({
    scrollTop: 2000,
    scrollLeft: 1000
}); 
```

要滚动到特定元素：

```
var offset = $("#someElement").offset();
$("html,body").animate({
    scrollTop: offset.top,
    scrollLeft: offset.left
}); 
```

[**演示。**](http://jsfiddle.net/karim79/ZdKyk/)

# database - 我可以应用哪些优化来加快此查询的速度？

> ID：12217797
> 
> 赞同：0
> 
> 时间：2012-08-31T14:49:45.263
> 
> 标签：database, optimization, query-optimization

我正在为我工​​作的公司创建一个简单的业务分析应用程序，并拥有一个 100mb 的 csv 文件，其中包含过去 6 年的销售交易，我已将其解析为多个数据库。

我想在我的应用程序中显示的数据之一是每位客户每天的营业额和利润，所以我有一个如下所示的 while 循环：

```
while(start_date < current_date)
    {
        SELECT SUM(profit), SUM(turnover) FROM sales WHERE date = @date
    } 
```

因此，我在一个有几十万行的表上运行该查询，每天的次数与 6 年来每天的客户次数一样多。

我总是被引导相信可以在数据库中执行的任何工作都应该是 - 这就是我使用 SUM 查询来汇总列的原因。

我还能做哪些其他优化？目前它正在占用......好吧，我不能告诉你，因为它已经在一个 8GB 四核服务器上运行了最后一个小时，看起来它在 2-3% 左右。

我正在使用 SQL Server Compact Edition，它是 C#/.NET 中的一个 winforms 应用程序，但 db 显然是这里的瓶颈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:03:41.660

我只会运行这个（修改过的）查询一次并遍历结果集。它应该更快。

```
SELECT 
    customer, date, SUM(profit), SUM(turnover) 
FROM 
    sales 
WHERE 
    date < current_date 
GROUP BY 
    customer, date
ORDER BY
    customer, date

for each (row in resultset) {
    //process customer/date
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:52:19.887

尝试引入汇总表，您将在其中获得每日统计信息。每当您向销售表添加更多数据时，更新该汇总表 [使用触发器或应用程序逻辑]。

# php - FuelPHP ORM 模块/包交互/Hooks

> ID：12217802
> 
> 赞同：3
> 
> 时间：2012-08-31T14:49:59.177
> 
> 标签：php, orm, hook, fuelphp

我正在寻找一种让模块与使用 FuelPHP 的其他模块中的 ORM 模型进行交互的方法。

例如，如果我有一个名为 的模块`products`，它将带有一些默认行为，即从产品表中选择产品等。这很好。

我试图解决的问题是允许可能存在或可能不总是存在的模块/包与产品模块进行交互。

例如，如果我启用了一个`inventory`模块，它需要在产品模型中动态添加一个关系，以允许`Model_Product::find()->get()`扩展以在必要时检索库存信息。所以上面的代码可以改为

```
Model_Product::find()->related('inventory')->get() 
```

这演示了另一个问题，即在未加载清单模块时调用`related('inventory')`代码将引发异常（并反过来创建关系）。

从概念上讲，我正在努力寻找一种让模块交互的方法。

我相信我可以通过在模型中创建类似于以下的方法来解决第一个问题

```
public static function _init()
{
     $data = array(
          '_has_many' => static::$_has_many,
          [...]
     );

     $additional_relationships = \Event::trigger('event_name', $data, 'array');

     foreach($additional_relationships as $key => $value)
     {
          static::$$key = $value;
     }
} 
```

但这似乎不太理想。它也没有解决第二个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T12:01:38.370

你这里有点鸡和蛋的情况。你可以设计一个拉系统（就像你建议的那样）或一个推系统（就像我会做的那样），但两者都只会捕获那个特定时刻的状态。这一挑战需要随着模型的加载而不断更新。

也许你可以用一个中间类来解决它。让这个类定义一个通知事件，该事件由每个加载的模型触发，并传递该模型的关系信息。让每个模型注册一个更新事件回调，以便通知器可以在新信息进入时更新模型。通知器还应该能够传递它在加载模型之前收集的所有数据。保持一切同步将是一个相当大的挑战。

如果您使用相关模型运行查询但该模型不可访问（即未定义关系），所有这些都不会阻止异常。

# ios - 如何以编程方式关闭 UITextView 中的自动更正弹出框？

> ID：12217805
> 
> 赞同：0
> 
> 时间：2012-08-31T14:50:02.230
> 
> 标签：ios, cocoa-touch, uitextview, uitextinput

我正在自己做一些自定义的自动完成的东西`insertText:`，但是如果有一个可见的自动更正建议，视图就会进入一个奇怪的状态。

如果我使用`[textView unmarkText]`，它会关闭自动更正弹出窗口——但它接受自动更正（这很糟糕）。有没有办法以编程方式*拒绝*自动更正建议？

我目前的“解决方案”有效，但它很粗俗，而且我没有理由认为它会在未来继续有效。有一个更好的方法吗？

```
- (void)dismissAutocorrectSuggestionForTextView:(UITextView *)textView {
    NSRange range = textView.selectedRange;
    textView.text = textView.text;
    textView.selectedRange = range;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-22T13:10:09.777

我尝试了与您类似的方法，但是以这种方式设置 textView 的文本会导致 textView 不必要地滚动（我的 textView 包含相当多的文本）。我的解决方案涉及以非动画方式恢复 contentOffset。它并不比你所拥有的更优雅，但至少它可以帮助那些需要处理更长文本的人。

至于它是否会在未来继续工作，我从 iOS 4 开始尝试过这样的事情，并且它继续工作到 iOS 6。

```
- (void)rejectAutoCorrectSuggestionInTextView:(UITextView *)textView
{
    if ([textView isFirstResponder])
    {
        NSString *original = textView.text;
        NSRange originalRange = textView.selectedRange;
        CGPoint originalOffset = textView.contentOffset;

        // Force any pending autocorrection to be applied
        [textView resignFirstResponder];
        [textView becomeFirstResponder];

        NSString *final = textView.text;

        if (![original isEqualToString:final])
        {
            textView.text = original;
            textView.selectedRange = originalRange;
            [textView setContentOffset:originalOffset animated:NO];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-31T18:53:43.680

I just encountered this issue myself. This solution works well:

```
[textView.inputDelegate textWillChange:textView];
[textView.inputDelegate textDidChange:textView]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-31T22:44:14.177

您的原始解决方案很接近。尝试以下操作：

```
- (void)dismissAutocorrectSuggestionForTextView:(UITextView *)textView {
    NSRange rangeCopy = textView.selectedRange;
    NSString *textCopy = textView.text.copy;
    [textView resignFirstResponder];
    [textView becomeFirstResponder];
    [textView setText:textCopy];
    [textView setSelectedRange:rangeCopy];
} 
```

背靠背调用 resign/become first responder 会导致文本视图立即接受挂起的自动更正，但不会真正关闭键盘（尝试一下，你会感到惊讶）。这肯定适用于 iOS 6 和 iOS 7。接受自动更正后，您将文本和选定范围重置为自动更正之前的状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-30T14:23:46.927

如果不需要从文本视图中退出第一响应者，并且您可以作为委托附加到文本视图，则可以实现方法

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text 
```

并`return NO`在特定情况下。例如，您可以尝试以下操作：

```
@implementation
{
    BOOL _denyReplacements;
}

//////////////

- (void)dismissAutocorrectSuggestionForTextView:(UITextView *)textView {
    NSRange rangeCopy = textView.selectedRange;
    NSRange fakeRange = rangeCopy;
    fakeRange.location--;
    _denyReplacements = YES;
    [textView unmarkText];
    [textView setSelectedRange:fakeRange];
    [textView setSelectedRange:rangeCopy];
    _denyReplacements = NO;
}

- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
     return !_denyReplacements;
} 
```

当文本视图选择更改时，自动完成会尝试接受当前建议，但文本视图会在进行替换之前咨询此方法。为什么要这样做而不是仅仅辞职/成为第一响应者的一个例子是，当您在`textViewDidBeginEditing`和/或`textViewDidEndEditing`方法中有一些逻辑时，例如，当您解除自动更正时您不希望执行这些逻辑。

# php - php联系我们表单问题

> ID：12217806
> 
> 赞同：0
> 
> 时间：2012-08-31T14:50:03.857
> 
> 标签：php, jquery

我创建了一个联系我们表单，它应该简单且最重要的是安全，因此用户无法输入要在服务器端执行的代码：

```
<?php

$userips = ($_SERVER['X_FORWARDED_FOR']) ? $_SERVER['X_FORWARDED_FOR'] : $_SERVER['REMOTE_ADDR'];

$ips = $userips;

// Clean up the input values
foreach($_POST as $key => $value) {
  if(ini_get('magic_quotes_gpc'))
    $_POST[$key] = stripslashes($_POST[$key]);

  $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key]));
}

// Assign the input values to variables for easy reference
$name = $_POST["name"];
$email = $_POST["email"];
$reason = $_POST["reason"];
$message = $_POST["message"];

mail($to, $subject, $message, $headers);

// Send the email
$to = "test@testsite.com";
$subject = "From: $name . " Reason: " . $reason";
$message = "$message" . "\n\n\n==-   Sent from the website with IP Address: " . $ips . "   -==";;
$headers = "From: $email";

$send_contact=mail($to,$subject,$message,$header);

header("Location: http://www.testsite.com");

// Check, if message sent to your email
// display message "We've recived your information"
// if($send_contact){
// echo "We've recived your contact information";
// }
// else {
// echo "ERROR";
// }
?> 
```

上面的代码能完成这项工作吗？或者我是否缺少确保安全设置到位的代码？

**编辑** 我有以下检查电子邮件有效性的 Jquery 脚本：

```
'email' : function() {

    $('body').append('<div id="emailInfo" class="info"></div>');

    var emailInfo = $('#emailInfo');
    var ele = $('#email');
    var pos = ele.offset();

    emailInfo.css({
        top: pos.top-3,
        left: pos.left+ele.width()+15
    });

    var patt = /^.+@.+[.].{2,}$/i;

    if(!patt.test(ele.val())) {
        jVal.errors = true;
            emailInfo.html('<img src=theImages/xMark.png title="Please enter a valid email address" alt="Please enter a valid email address" />').show();
            ele.removeClass('normal').addClass('wrong');                    
    } else {
            emailInfo.html('<img src=theImages/checkMark.gif />').show();
            ele.removeClass('wrong').addClass('normal');
    }
}, 
```

使用上面的代码，我可以在 php 代码中将 ELSE 语句留空吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:52:52.053

您需要注意的是[电子邮件注入](http://www.w3schools.com/php/php_secure_mail.asp)。您可以使用以下方法对它们进行防御：

```
filter_var($email, FILTER_SANITIZE_EMAIL) 
```

您的脚本有许多错误，包括解析错误：

```
<?php

$userips = ($_SERVER['X_FORWARDED_FOR']) ? $_SERVER['X_FORWARDED_FOR'] : $_SERVER['REMOTE_ADDR'];

$ips = $userips;

// Clean up the input values
foreach($_POST as $key => $value) {
  if(ini_get('magic_quotes_gpc'))
    $_POST[$key] = stripslashes($_POST[$key]);

  $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key]));
}

// Assign the input values to variables for easy reference
$name = $_POST["name"];
$email = $_POST["email"];
$reason = $_POST["reason"];
$message = $_POST["message"];

if(filter_var($email, FILTER_SANITIZE_EMAIL)){
    // Send the email
    $to = "test@testsite.com";
    $subject = "From: $name Reason: $reason";
    $message = "$message" . "\n\n\n==-   Sent from the website with IP Address: " . $ips . "   -==";;
    $headers = "From: $email";

    $send_contact=mail($to,$subject,$message,$headers);
    header("Location: http://www.testsite.com");
}
else{
    echo 'Bold!';
}
?> 
```

# android - 如何在 ListView 中显示光标数据（使用加载器）之前对其进行操作？

> ID：12217814
> 
> 赞同：4
> 
> 时间：2012-08-31T14:50:26.133
> 
> 标签：android, database, android-listview, android-cursorloader

my 的每一项都`SherlockListFragment`包含 3 个`TextView`：一个名字和两个数字。数据来自`objective`我的数据库表，其结构如下：

```
CREATE TABLE objective (
    _id INTEGER PRIMARY KEY,
    id_project INTEGER NOT NULL,
    activity_code INTEGER NOT NULL,
    day_duration INTEGER NOT NULL,
    week_frequency INTEGER NOT NULL,
    FOREIGN KEY(id_project) REFERENCES project(id_project)
); 
```

此外，我已经读过应该通过使用加载器来从游标填充列表（特别是在使用数据库时，因为它可能是一个非常慢的操作）。我[在 stackoverflow 上](https://stackoverflow.com/a/7422343/615882)`SimpleCursorLoader`找到了一个类，但它直接将数据映射到一个字段。

这不是我真正想要的，因为如您所见，在我的`objective`桌子上我有一个`activity_code`. 所以我想用一个字符串替换它（我有一个枚举，它列出了我所有的活动代码，并为每个活动代码返回一个字符串资源标识符）。

你知道我如何在数据显示在`TextView`s 之前对其进行操作吗？

这是我的`SherlockListFragment`

```
public class ObjectivesDisplayFragment extends SherlockListFragment implements LoaderManager.LoaderCallbacks<Cursor>
{
    private Activity activity;
    private SimpleCursorAdapter adapter;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) 
    {
        return inflater.inflate(R.layout.objectives_display, container, false);
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState)
    {
        super.onActivityCreated(savedInstanceState);
        activity = getActivity();

        String[] columns = new String[] { "activity_code", "day_duration", "week_frequency" };
        int[] to = new int[] { R.id.activityName, R.id.objectiveDuration, R.id.objectiveFrequency };

        getLoaderManager().initLoader(0x01, null, this);

        adapter = new SimpleCursorAdapter(activity.getApplicationContext(), R.layout.objective_row, null, columns, to, SimpleCursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);
        setListAdapter(adapter);
    }

    public Loader<Cursor> onCreateLoader(int arg0, Bundle arg1) {
        return new SimpleCursorLoader(activity) {
            @Override
            public Cursor loadInBackground() {
                DatabaseHelper dbHelper = DatabaseHelper.getInstance(activity);

                String query = "SELECT _id, activity_code, day_duration, week_frequency FROM objective WHERE id_project = ?";
                String[] args = new String[] { "1" }; // projectId
                Cursor results = dbHelper.getReadableDatabase().rawQuery(query, args);

                return results;
            }
        };
    }

    public void onLoadFinished(Loader<Cursor> arg0, Cursor cursor) {
        adapter.swapCursor(cursor);
    }

    public void onLoaderReset(Loader<Cursor> arg0) {
        adapter.swapCursor(null);
    }
} 
```

编辑：我不需要在 SimpleCursorLoader > loadInBackground 中关闭游标和数据库，对吗？否则无法读取数据。那么关闭操作是自动处理的还是我需要在其他地方自己做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T18:39:47.510

我想这可能对你有用：

```
adapter.setViewBinder(new ViewBinder(){
        @Override
        public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
            String label = "Inactive";

            if(columnIndex == 4) {
                if(cursor.getInt(columnIndex) == 1) {
                    label = "Active";
                }

                TextView tv = (TextView) view.findViewById(R.id.status);
                tv.setText(label);

                return true;
            }

            return false;
        }
    });

    setListAdapter(adapter); 
```

背景信息：我在表中有一个外键列（整数），并希望在填充到列表视图时解析为它的字符串值（来自链接表）。列位于第 4 个索引（集合中的第 5 列），因此只需使用 setViewBinder() 来操作所需的列。

此外，我的布局有 5 个文本视图来显示光标的 5 个字段。这里还值得注意的一件事是，当使用“if”条件来捕获列索引时，请确保每个条件块都必须包含“return true”。在这种情况下，解释器达到“return false” - 意味着您的字段没有被操纵。

我确信上面的代码块非常简单易懂。

# python - 带有可变数据的正则表达式 - ply.lex

> ID：12217816
> 
> 赞同：3
> 
> 时间：2012-08-31T14:50:31.633
> 
> 标签：python, lexer, ply

我正在使用 python 模块`ply.lex`编写词法分析器。我得到了一些用正则表达式指定的标记，但现在我卡住了。我有一个`list of Keywords`应该是的人`token`。`data`是一个包含大约 1000 个关键字的列表，这些关键字应该都被识别为一种关键字。这可以是例如：`_Function1 _UDFType2`等等。列表中的所有单词都由空格分隔，就是这样。我只是想让词法分析器识别这个列表中的单词，这样它就会返回一个类型为“KEYWORD”的标记。

```
data = 'Keyword1 Keyword2 Keyword3 Keyword4'
def t_KEYWORD(t):
    # ... r'\$' + data ??
    return t

text = '''
Some test data

even more

$var = 2231

$[]Test this 2.31 + / &
'''

autoit = lex.lex()
autoit.input(text)
while True:
    tok = autoit.token()
    if not tok: break
    print(tok) 
```

所以我试图将变量添加到该正则表达式中，但它没有用。我总是得到： `No regular expression defined for rule 't_KEYWORD'`。

先感谢您！约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T17:03:20.390

正如@DSM 建议的那样，您可以使用[TOKEN 装饰器](http://www.dabeaz.com/ply/ply.html#ply_nn14)。`cat`用于查找类似or `dog`is 的标记的正则表达式`'cat|dog'`（即，单词由`'|'`而不是空格分隔）。所以试试：

```
from ply.lex import TOKEN
data = data.split() #make data a list of keywords

@TOKEN('|'.join(data))
def t_KEYWORD(t):
    return t 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:53:11.030

`ply.lex`使用正则表达式的文档字符串。*请注意，您定义令牌的顺序定义了它们的优先级，这通常很重要。*

.

**顶部**的文档字符串不能是表达式，因此您需要逐个令牌定义进行此令牌定义。

我们可以在解释器中测试：

```
def f():
    "this is " + "my help"  #not a docstring :(
f.func_doc #is None
f.func_doc = "this is " + "my help" #now it is! 
```

因此这应该有效：

```
def t_KEYWORD(token):
    return token
t_KEYWORD.func_doc=r'REGULAR EXPRESSION HERE' #can be an expression 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:16:43.310

不确定这是否适用于 ply，但 docstring 是`__doc__`函数的属性，因此如果您编写一个接受字符串表达式并将其设置为`__doc__`函数属性的装饰器 ply 可能会使用它。

# javascript - 在重定向到之前使用 JavaScript 测试 WordPress 页面是否存在

> ID：12217821
> 
> 赞同：3
> 
> 时间：2012-08-31T14:50:43.587
> 
> 标签：javascript, html, wordpress, web-applications, redirect

我的链接如下所示：

```
 http://localhost:8081/wordpress/?p=535 
```

如何使用 JavaScript 重定向到此页面？我不熟悉`?`语法，但我觉得我应该能够发送带有帖子 ID 的某种请求？

就像是：

```
redirect("p="+postid); 
```

只是打电话`window.Location`对我不起作用，因为如果帖子不存在，那么我希望能够做其他事情。另外，我不希望它直接指向本地主机。它需要指向网站的根目录...

那么更像这样：

```
if (request("p="+postid) exists) {
    redirect("p="+postid);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-31T14:51:57.657

```
document.location.href = "http://localhost:8081/wordpress/?p=535"; 
```

如果你想先检查页面是否存在，你可以这样做：

```
var addr = "/wordpress/?p=535"; // here with a relative url
$.ajax({
    type: 'HEAD',
    url: addr,
    success: function() {
        document.location.href = addr;
    }
}); 
```

这将发出 HEAD 请求（因此没有内容下载）以检查页面是否存在，并且只有在正常时才更改当前位置。

*请注意，如果您愿意，您可以在没有 jQuery 的情况下执行此操作，如果需要，我让您确定确切的语法。*

但这只有在两个页面都来自同一个域时才有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T14:52:16.027

```
window.location.href = "http://localhost:8081/wordpress/?p=535"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T14:51:42.173

```
window.location = "http://localhost:8081/wordpress/?p=535"; 
```

更新：-在评论之后
虽然这不是应该使用的技巧，但可以
尝试向 url 发送一个 ajax 请求，如果它成功返回一些内容重定向，如果有`404`错误，则执行其他操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T14:53:21.127

您可以像这样将可变的帖子 ID 添加到该位置：

```
var postID = 535;
window.location = "http://localhost:8081/wordpress/?p="+postID; 
```

* * *

现在您已经更新了您的问题，我认为这显然不是 JavaScript 的工作。如果你想检查一个页面是否存在，你应该在服务器端进行检查，因为只有服务器端代码才能访问你的数据库，在那里它可以检查特定的帖子 ID 是否实际存在。

当然，您可以编写一些 AJAX 接口，其中 JavaScript 关闭并查询服务器端代码以查看帖子是否存在，然后您将得到您的答案并采取相应的行动——但这似乎真的这个问题过于复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T14:54:35.527

要将用户发送到另一个 URL，请使用

```
window.location.href = 'http://localhost:8081/wordpress/?p=535' 
```

“？”之后的内容 是 URL 的一部分，旨在由服务器端程序处理。

# blackberry - 连接到 localhost 的黑莓模拟器 DNS 错误

> ID：12217826
> 
> 赞同：0
> 
> 时间：2012-08-31T14:51:16.737
> 
> 标签：blackberry, blackberry-simulator, blackberry-eclipse-plugin, blackberry-jde

我发现当我在网络上并在端口 8095 上连接到我的本地主机（glassfish）时（更改了端口号），我的模拟器连接起来又快又容易，但是没有网络，它不会连接并弹出这个“DNS 错误”，而连接到同一个 glassfish 服务器。我的 MDS 已启动且未配置代理。那么您认为问题出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T23:30:10.830

你试过127.0.0.1吗？无论如何，这就是“localhost”应该解决的问题。

# firefox - Youtube iframe 没有全屏按钮

> ID：12217827
> 
> 赞同：5
> 
> 时间：2012-08-31T14:51:18.373
> 
> 标签：firefox, google-chrome, youtube

也许是星期五下午开始，但由于某种原因，我似乎无法在嵌入的 Youtube 视频上显示全屏按钮。我所做的只是复制从 Youtube 视频生成的共享代码：

```
<iframe width="560" height="315" src="http://www.youtube.com/embed/hFoQVx8ZcHo?rel=0" frameborder="0" allowfullscreen></iframe> 
```

因此，例如使用此代码[http://jsfiddle.net/chricholson/v8sjL/](http://jsfiddle.net/chricholson/v8sjL/)我看到：

![在此处输入图像描述](../Images/1f34946afba631489d5724a111eb5ba4.png)

我发现一些文章说 URL 错误`/v/[code]`，而不是`/embed/[code]`直接从 Youtube 复制，我认为我会安全。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-03T09:33:59.517

看来我需要进行一些更改，最终代码：

```
<iframe width="560" height="315" src="http://www.youtube.com/embed/hFoQVx8ZcHo?rel=0&fs=1" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>​ 
```

首先，URL需要`&fs=1`，这会触发按钮显示。此外，`webkitallowfullscreen`还`mozallowfullscreen`需要说明这些解决浏览器特定问题的明显方法。

我确实发现了一件有趣的事情，尽管有工作代码，但这个示例不能通过 jsfiddle 工作，大概与 iframe 内部有关。请参阅[http://jsfiddle.net/mrchris2013/v8sjL/5/](http://jsfiddle.net/mrchris2013/v8sjL/5/)了解我的意思。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-14T12:34:11.223

解决了...！如果您在主 HTML 中的 iframe(jsfiddle) 中有 iframe(youtube)，则需要定义

`webkitallowfullscreen mozallowfullscreen allowfullscreen`

到两个 iframe 以使其正常工作.....

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T21:45:42.607

全屏选项回来了，希望我必须`&fs=1`在链接末尾删除。

```
<iframe width="1280" height="720" src="http://www.youtube.com/embed/doXntJaJ-nQ" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> 
```

# php - fgets() 在 socket_select 之后返回空字符串

> ID：12217828
> 
> 赞同：2
> 
> 时间：2012-08-31T14:51:24.730
> 
> 标签：php, sockets

我对套接字有一个相当特殊的问题。设置的基础是一个用​​ PHP 编写的分叉套接字服务器。（我知道，PHP，嘘等）

一个非常基本的代码示例是......

```
$controlSockets = stream_socket_pair();
$pid = pcntl_fork();
if($pid == -1)
    throw new Exception("Fork error");
else if($pid) {
     fclose($controlSockets[0]);

     while(true) { 
          $read = array($controlSockets[1]);
          $write = array();
          $except = array();

          // Sleep for half a second if there's nothing to read
          while(stream_select($read, $write, $except, 0, 500000) > 0) { 
               $r = fgets($controlSockets[1]);
               echo "'$r'\n read from socket."; // This outputs ''
          }

          // Re-set the read array as stream_select alters the array
          $read = array($controlSockets[1]);
     }

} else {
     fclose($controlSockets[1]);
     // do some work ...
     sleep(5);
     // end of work ...
     $result = 'blah';
     fputs($controlSockets[0], $result);
     exit;
} 
```

现在，问题是即使套接字包含在读取集合中，但它返回一个空字符串，据我所知，这永远不会发生，除非达到 feof，或者实际上有一些内容。在执行的前 5 秒内没有。

不过，发送过来的实际内容很好。

关于发生了什么的任何线索？

（上面的代码是伪代码，不知道实际示例是否有效，但这是发生了什么的大体思路）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:11:31.203

几点：

*   您指定超时 500 毫秒，但不发送输入 5 秒，所以选择应该真的超时并返回零。
*   您不检查从 中返回的错误，根据[文档](http://php.net/manual/en/function.stream-select.php)（信号中断，例如）``stream_select()`，这应该类似于下面的内容：

    `if (false === ($num_changed_streams = stream_select(...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:12:33.330

您的代码通过错误条件吹。如果`fgets`失败，你仍然输出。如果套接字关闭，您可能希望`stream_select`失败，但它不会。它只会告诉您需要检查套接字。

我得到：

```
'blah'
 read from socket.''
 read from socket.''
 [... repeats] 
```

# iphone - 从相机胶卷和共享打开图像时，文件大小报告不同

> ID：12217832
> 
> 赞同：1
> 
> 时间：2012-08-31T14:51:43.950
> 
> 标签：iphone, ios

我有一个应用程序可以拍照并将其保存到相机胶卷和一个显示保存在我的库中的图像的视图。

我已经实施了一个共享选项。当我从我的库中打开一张图片（取自相机胶卷）并使用共享选项通过电子邮件发送它时，它说该图片为 10Mb。

如果从相机胶卷发送相同的图像，则显示为 1.2Mb。当我在笔记本电脑上打开两个图像时，文件大小不同。

有人知道为什么会这样吗？为了减少从我的应用程序发送的文件大小，我有什么遗漏吗？

下面是分享功能的代码：

```
- (IBAction)share:(id)sender {

    NSArray *activityItems = @[self.imageView.image];

    UIActivityViewController *activityViewController = [[UIActivityViewController alloc] initWithActivityItems:activityItems applicationActivities:nil];

    activityViewController.excludedActivityTypes = @[UIActivityTypePostToWeibo, UIActivityTypeAssignToContact ];

    [self presentViewController:activityViewController animated:YES completion:NULL];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T06:54:14.087

您的库中存在的图像是原始图像，并且尺寸最大。

您可以调整它的大小以使其更小。

# javascript - 错误：NETWORK_ERR：海豚移动浏览器上的 XMLHttpRequest 异常 101

> ID：12217833
> 
> 赞同：1
> 
> 时间：2012-08-31T14:51:44.900
> 
> 标签：javascript, xmlhttprequest, mobile-browser

我正在发送一个请求以从服务器获取 xml 响应，为此我在 javascript 中尝试了这段简单的代码

```
 xmlhttp=new XMLHttpRequest();  
    var req = "test.xml";
    xmlhttp.open("GET",req,false);
    xmlhttp.send();    //this line throws the error 
```

现在，这适用于桌面浏览器甚至 Android 浏览器，但是当我从一些 Java 手机的浏览器中尝试时，我们会收到以下错误：

错误：NETWORK_ERR：XMLHttpRequest 异常 101

请注意，错误是由上面 4 行中的最后一行引发的，而不是在我们调用`new XMLHttprequest`或打开连接时引发的。

我也试过`xmlhttp.send(null);`但没有帮助

send() 失败的原因可能是什么？

# ruby-on-rails - Rails - 命名空间 Css 不工作

> ID：12217852
> 
> 赞同：0
> 
> 时间：2012-08-31T14:52:43.537
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试在我的 Web 应用程序中实现一个管理命名空间。**它在我的本地机器上运行良好，**但是当我尝试部署应用程序时，我的 css 都没有工作。我试过

> rake 资产：预编译

我已经重新启动了服务器。我的结构看起来像这样

*   应用程序

    *   资产

        *   样式表

            . 应用程序.css

            *   行政

                *   my_admin.css

与 Javascripts 相同的结构。在我使用的布局文件中

```
 <%= stylesheet_link_tag    "admin/my_admin" %>
 <%= javascript_include_tag "admin/my_admin" %> 
```

当我运行我的应用程序时，它工作正常，但我的 css 和 javascript 都不存在..在我的浏览器检查器中，它说 my_admin css 和 javascript not found.Any help??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:15:21.077

在生产中你可能有

```
config.assets.compile = false 
```

在你的`config/environment/production.rb`. 这可以防止资产管道在生产中像在开发中那样按需编译脚本。

您需要指定任何`.js`或`.css`您想要预编译的资产，它们不是`application.js`or `application.css`。

将以下内容添加到您的`config/environment/production.rb`

```
config.assets.precompile += ["admin/my_admin.css", "admin/my_admin.js"] 
```

并且运行`rake assets:precompile`应该为您放入那些已编译的资产`public/assets`。

# jquery - 提取 json 响应值

> ID：12217854
> 
> 赞同：-1
> 
> 时间：2012-08-31T14:52:52.130
> 
> 标签：jquery, asp.net, json

我有一个调用 WCF 服务的 jQuery Ajax 函数。服务调用成功：

```
 function WCFJSON() {
        var now = new Date();
        var getFromDate = dateToWcf(new Date(now - (60000 * 1440)));

        var userid = "1";
        m_Type = "POST";
        m_Url = "https://dev-04.boldgroup.int/ManitouDashboard/DashboardProxyService.svc/GetStats"
        m_Data = '{"getFromDate": "' + getFromDate + '", "getValueList": [1, 2, 3, 7]}';
        m_DataType = "json";
        m_ProcessData = true;
        CallService();
    }  

    function CallService() {
    $.ajax({
        type: m_Type,           //GET or POST or PUT or DELETE verb                  
        url: m_Url,                 //Location of the service   
        data: m_Data,
        dataType: m_DataType,   //Expected data format from server                  
        processdata: m_ProcessData, //True or False
        crossdomain: true,    
        contentType: "application/json",             
        success: function (msg) {   //On Successfull service call                      
            ServiceSucceeded(msg);
        },
        error: function (jqXHR, textStatus, errorThrown) {
            ServiceFailed("jqXHT: " + jqXHR.result + "Text Status: " + textStatus + " Error Thrown: " + errorThrown );
        } // When Service call fails              
    });
} 
```

我可以看到原始 json 响应字符串是使用 fiddler 填充的，如何提取 json 响应中返回的值？我想将值存储在 javascript 中的列表或数组中。感谢您对此的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T14:55:24.393

您可以使用[JSON2 之](https://github.com/douglascrockford/JSON-js)类的东西将您的响应转换为 JSON Array 对象，然后您可以像其他任何数组对象一样调用它，
您的响应将是这样的

```
"[{\"name\":\"Qpirate\"},{\"name\":\"Qpirate\"}]" 
```

并使用 JSON2 文件

```
var returnedMsg = JSON.parse(msg); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:58:22.367

下面的问题给出了如何访问属性的一个很好的例子。

[使用变量键访问 JavaScript 对象中的值](https://stackoverflow.com/questions/922544/using-variable-keys-to-access-values-in-json-objects)

# javascript - 表单输入验证

> ID：12217857
> 
> 赞同：0
> 
> 时间：2012-08-31T14:53:11.220
> 
> 标签：javascript, forms, validation, web

好的，我一直在浏览 Google 并尝试了不同的代码，但它们并不是我真正需要的代码。所以这是我的问题，我有一个 JavaScript 可以验证我的输入字段。它工作得很好，但唯一的问题是在网站领域。我希望它检查输入框中的值是否在末尾包含“.com”，否则会导致错误。请问有人可以帮我吗？只需要知道如何处理缺少的语句.. 这是我的代码..

```
var website=document.forms["reg"]["site"].value;
if (website==null || website=="")
{
    alert("Website field must be filled out");
    return false;
} 
```

如您所见，如果值为空，它将显示错误。所以如上所述，我要检查“.com”是否必须存在于输入框的值中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:22:09.220

您不需要正则表达式来检查字符串是否是您的值的一部分。您的测试可能如下所示：

```
if (website.indexOf('.com') != -1) {
... 
```

如果要使用正则表达式，请确保它是正确的。 `/\.com/.test(website)`将测试是否存在“.com”，`/\.com$/.test(website)`并将测试您的值是否位于网站末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:59:19.230

使用 Regexp 对象中的测试方法

就像是：

``siteRE=/.com$/;`
`siteRE.test(inputValue);`` 

这将返回一个布尔值，告诉您它是否通过。将 i 添加到正则表达式的末尾以不区分大小写。

更多信息在这里.... [http://www.w3schools.com/jsref/jsref_regexp_test.asp](http://www.w3schools.com/jsref/jsref_regexp_test.asp)

问候。

# python - 使用 Twisted Python SMTP 对 DATA 的自定义响应？

> ID：12217858
> 
> 赞同：0
> 
> 时间：2012-08-31T14:53:11.563
> 
> 标签：python, smtp, twisted

如何使用 Twisted 的 SMTP 指定自定义错误代码/对 DATA 命令的响应？在代码中的 eomReceived 中，我想用自定义字符串返回失败。现在，我可以返回一个带有 errback 集的 Deferred()，它会返回一个 550 代码，但我无法指定响应字符串，并且在我的日志中得到一个未处理的错误。

```
class ConsoleMessageDelivery:
    implements(smtp.IMessageDelivery)

    def receivedHeader(self, helo, origin, recipients):
        myHostname, clientIP = helo
        headerValue = "by %s from %s with ESMTP ; %s" % (myHostname, clientIP, smtp.rfc822date())
        # email.Header.Header used for automatic wrapping of long lines
        return "Received: %s" % Header(headerValue)

    def validateFrom(self, helo, origin):
        # All addresses are accepted
        return origin

    def validateTo(self, user):
        if user.dest.local == "console":
            return lambda: ConsoleMessage()
        raise smtp.SMTPBadRcpt(user)

class ConsoleMessage:
    implements(smtp.IMessage)

    def __init__(self):
        self.lines = []

    def lineReceived(self, line):
        self.lines.append(line)

    def eomReceived(self):
        # do something here, return defer.succeed(None) on success
        # right now on error, I do the following:
        d = defer.Deferred()
        d.errback("An error occurred")
        return d

    def connectionLost(self):
        # There was an error, throw away the stored lines
        self.lines = None

class ConsoleSMTPFactory(smtp.SMTPFactory):
    protocol = smtp.ESMTP

    def __init__(self, *a, **kw):
        smtp.SMTPFactory.__init__(self, *a, **kw)
        self.delivery = ConsoleMessageDelivery()

    def buildProtocol(self, addr):
        p = smtp.SMTPFactory.buildProtocol(self, addr)
        p.delivery = self.delivery
        return p 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T19:10:13.480

你需要：

*   ESTMP 子类
*   在您的子类上实现 do_DATA（参见 twisted.mail.smtp.SMTP 示例）

SMTP 基类的 lineReceived 将接收您的行，将其传递给 state_COMMAND（假设它处于命令状态），它将查找以 do_ 开头的方法以传递该行的其余部分。

# java - 如何在sqlite中搜索数据库中的特定字符串

> ID：12217862
> 
> 赞同：0
> 
> 时间：2012-08-31T14:53:38.740
> 
> 标签：java, android, sqlite, search

我想搜索数据库中存在的特定关键字并将它们展示出来。

这是我的搜索类代码：

```
String s = kw.getText().toString();

sqlhandler show = new sqlhandler(this);
show.open();
String rname = show.getName(s);
show.close();
tv.setText(rname); 
```

这是我的数据库类：

```
public String getName(String kw) {

    String[] columns = new String[] {NAME, APRICE, DPRICE, VENDOR, KEYWORD };

    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, "DPRICE like " + "'%"+ kw+"%'", null, null, null, null);

    String sresult = "";

    int iname = c.getColumnIndex(NAME);
    int iap = c.getColumnIndex(APRICE);
    int idp = c.getColumnIndex(DPRICE);
    int ivendor = c.getColumnIndex(VENDOR);

    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()) {
        sresult = sresult + c.getString(iname)+ " "+c.getString(iap)
            + "  " + c.getString(idp) + "  " + c.getString(ivendor)
        + "\n";
    }

    return sresult;
} 
```

我的问题是什么？每次我运行它时，我都会不断接近。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T16:04:41.680

由于您尚未发布 LogCat，我只能*猜测*，但您的 WHERE 子句看起来很可疑：

```
"DPRICE like ..." 
```

我假设`DPRICE`是一个变量，而不是实际的列名：

```
DPRICE + " like ..." 
```

* * *

另外我有几点建议：

*   使用该`selectionArgs`参数可以防止[SQL 注入攻击](http://www.imperva.com/resources/glossary/sql_injection.html)。
*   考虑使用[ListView 和 SimpleCursorAdapter](http://thinkandroid.wordpress.com/2010/01/09/simplecursoradapters-and-listviews/)来显示您的数据。
*   仅选择您正在使用的列。
*   使用 while 循环而不是 for 循环来遍历 Cursor（您的 for 循环所做的工作是必要工作的三倍）。

全部一起：

```
public String getName(String kw) {
    String[] columns = new String[] {NAME, APRICE, DPRICE, VENDOR};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, DPRICE + " like ?", new String[] {"'%" + kw + "%'"}, null, null, null, null);

    int iname = c.getColumnIndex(NAME);
    int iap = c.getColumnIndex(APRICE);
    int idp = c.getColumnIndex(DPRICE);
    int ivendor = c.getColumnIndex(VENDOR);

    // moveToNext() returns true when there is more data to read 
    //     or false when the cursor isAfterLast()
    StringBuilder builder = new StringBuilder();
    while (c.moveToNext()) {
        builder.append(c.getString(iname).append(" ")
               .append(c.getString(iap).append("  ")
               .append(c.getString(idp).append("  ")
               .append(c.getString(ivendor).append("\n");
    }

    return builder.toString();
} 
```

这是一个关于如何使用具有自定义布局的 ListView 来显示来自数据库的信息的[教程。](http://thinkandroid.wordpress.com/2010/01/09/simplecursoradapters-and-listviews/)

# sharepoint - 代码访问文档库强制登录 [更新]

> ID：12217863
> 
> 赞同：0
> 
> 时间：2012-08-31T14:53:49.537
> 
> 标签：sharepoint, sharepoint-2010

我有从 Sharepoint 2010 文档库中提取一些图像的代码。当我登录并测试一切正常时，但当它发布时，它会强制登录屏幕。

这是踢球者：如果我通过普通 HTML 引用图像，则发布的页面不需要登录。只有当我尝试将图像拉入并将它们的列表构建到 asp:literal 控件中时。

据我所知，列表上的权限允许匿名阅读。某处有问题。请帮忙！

下面是我正在使用的代码：

```
public void GetBanners() {

string strCode = "";

using (SPSite oSite = SPContext.Current.Site) {

    SPList oList = oSite.AllWebs[0].Lists["MainPage Banner Library"];
    SPView lv = oList.Views["All Pictures"];
    SPListItemCollection lic = oList.GetItems(lv);

    foreach (SPListItem li in lic) {
        if(li["Enabled"] is bool && (bool)li["Enabled"] == true) {
            if(li["URL"] is string && li["URL"].ToString() != "") {
                strCode = strCode + "<a href=\"" + GetURL(li["URL"].ToString()) + "\" target=\"_blank\"><img src=\"/MainPage Banner Library/" + li["Name"].ToString() + "\" alt=\" \" /></a>";
            } else {
                strCode = strCode + "<img src=\"/MainPage Banner Library/" + li["Name"].ToString() + "\" alt=\" \" />";
            }

        }
    }   
}
ltBanners.Text = strCode;
} 
```

更新：Aquila 的回答是这样的。我最终将第一行更改为 SPWeb oSite = SPContext.Current.Site.RootWeb; 而不是“SPSite oSite = SPContext.Current.Site”，它工作得很好。以下是新代码：

公共无效GetBanners（）{

```
string strCode = "";

    SPWeb oSite = SPContext.Current.Site.RootWeb;
    SPList oList = oSite.Lists["MainPage Banner Library"];
    SPView lv = oList.Views["All Pictures"];
    SPListItemCollection lic = oList.GetItems(lv);

    foreach (SPListItem li in lic) {
        if(li["Enabled"] is bool && (bool)li["Enabled"] == true) {
            if(li["URL"] is string && li["URL"].ToString() != "") {
                strCode = strCode + "<a href=\"" + GetURL(li["URL"].ToString()) + "\" target=\"_blank\"><img src=\"/MainPage Banner Library/" + li["Name"].ToString() + "\" alt=\" \" /></a>";
            } else {
                strCode = strCode + "<img src=\"/MainPage Banner Library/" + li["Name"].ToString() + "\" alt=\" \" />";
            }

        }
    }   

ltBanners.Text = strCode; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T07:54:54.587

这可能`SPList oList = oSite.AllWebs[0].Lists["MainPage Banner Library"];`是导致您的问题的行，因为这需要读取网络的所有列表，然后进行标题比较以返回您所追求的列表。

尝试使用`SPList oList = oSite.AllWebs[0].Lists[ListGUID];`或`SPList oList = oSite.AllWebs[0].GetList(ServerRelativeListURL);`。

引用[MSDN - 处理大型文件夹和列表](http://msdn.microsoft.com/en-us/library/ee557257.aspx)

> 只要有可能，通过使用列表的 GUID 或 URL 作为键来获取对列表的引用。
> 
> 您可以使用列表的 GUID 或显示名称作为索引器从 SPWeb.Lists 属性中检索 SPList 对象。使用 SPWeb.Lists[GUID] 和 SPWeb.GetList(strURL) 总是优于使用 SPWeb.Lists[strDisplayName]。最好使用 GUID，因为它是唯一的、永久的，并且只需要一次数据库查找。显示名称索引器检索站点中所有列表的名称，然后与它们进行字符串比较。如果您有一个列表 URL 而不是 GUID，则可以在检索列表之前使用 SPWeb 中的 GetList 方法在内容数据库中查找列表的 GUID。

# sql - 停止 SQL 在 JOIN 中两次返回相同的结果

> ID：12217864
> 
> 赞同：1
> 
> 时间：2012-08-31T14:53:50.050
> 
> 标签：sql

我已经将几个表连接在一起以获取我想要的数据，但是由于我是 SQL 新手，所以我无法弄清楚如何停止多次返回数据。

她的 SQL 语句；

```
SELECT
   T.url,
   T.ID,

   S.status,
   S.ID,

   E.action,
   E.ID,
   E.timestamp

FROM tracks T, status S, events E
WHERE S.ID AND T.ID = E.ID

ORDER BY E.timestamp DESC 
```

返回的数据是这样的；

```
+----------------------------------------------------------------+
| URL | ID | Status | ID | action               | ID | timestamp |
+----------------------------------------------------------------+
| T.1 | 4  | hello  | 4  | has uploaded a track | 4  | time      |
| T.2 | 3  | bye    | 3  | has some news        | 3  | time      |
| t.1 | 4  | more   | 4  | has some news        | 4  | time      |
+----------------------------------------------------------------+ 
```

这是一个非常基本的示例，但确实概述了发生的情况。如果您查看第三行，则当状态不同时，URL 会重复。

这就是我想要发生的事情；

```
+-------------------------------------------------------+
| URL or Status | ID | action               | timestamp |
+-------------------------------------------------------+
| T.1           | 4  | has uploaded a track | time      |
| hello         | 3  | has some news        | time      |
| bye           | 4  | has some news        | time      |
+-------------------------------------------------------+ 
```

请注意，当操作上传曲目时，会显示 url（在本例中模拟的是 T.1）。这个非常重要。在触发状态或轨道插入时插入事件表中的操作。如果插入了新曲目，则操作是“已上传曲目”，您猜它是什么状态。此时，ID 和时间戳也被插入到事件表中。

**注意：**查询中有更多表，实际上还有 3 个，但为了简单起见，我将它们省略了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:31:41.090

不要使用 20 年过时的语法。尽管许多 RDBMS 支持`FROM a, b, c`样式语法，但我使用过的所有系统都已弃用它。 *（我还没有处理所有事情，但强烈建议不要使用这种风格。）*

而是使用 ANSI-92 标准`JOIN`语法。那就更难搞错了……

```
SELECT
  *
FROM
  status S
INNER JOIN
  tracks T
    ON T.ID = S.ID
INNER JOIN
  events E
    ON E.ID = S.ID
ORDER BY
  E.timestamp DESC 
```

此外，您的示例数据表明您在表 S 中有以下内容...

```
 Status | ID
--------+----
 hello  | 4
 bye    | 3
 more   | 4 
```

`ID = 4`有两行。如果您真的希望 T 中的每一行只连接 S 中的一行，您应该选择哪一行？应该删除一个，还是您有其他一些逻辑/条件可以用来选择两者之一？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:55:56.030

改变这个

```
WHERE S.ID AND T.ID = E.ID 
```

对此

```
WHERE S.ID = E.ID AND T.ID = E.ID 
```

**更新**

有些人对使用隐式连接表示法非常敏感。为了安抚这些人并作为更好的做法，您应该使用明确`JOIN`的陈述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:37:20.880

尝试使用分组；

```
SELECT T1.url, T1.id, S1.estatus, S1.id, E1.action, E1.id, E1.timestamp FROM t T1, s S1, e E1 WHERE S1.id AND T1.id = E1.id GROUP BY S1.id ORDER BY E1.timestamp DESC; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T16:45:25.873

感谢所有的答案，他们帮助了很多。我已经使用 PHP 中的 if 语句进行了一个有效的查询并操纵了结果。

这里是;

```
SELECT 
T.url AS track_url,

S.status,

E.action,
E.ID,
E.timestamp,

A.name,
A.url AS artist_url

FROM events E

LEFT JOIN 
TRACKS T
ON T.ID = E.ID AND E.action = 'has uploaded a track.'

LEFT JOIN  
STATUS S
ON S.ID = E.ID AND E.action = 'has some news.'

LEFT JOIN 
ARTISTS A
ON A.ID = E.ID

ORDER BY E.timestamp DESC 
```

它的结果是很多`NULL`列，但这很好，因为它可以工作！如果`ID`尚未上传曲目，则相关列是`NULL`并且同样适用于查询的其他位。`ID`不会重复，因为仅选择`ID`了事件表中的 。

如果您发现我可能忽略的任何问题，请大声疾呼！

# python - sql，将从第一个表中获得的行值匹配到第二个表的列名，没有循环

> ID：12217865
> 
> 赞同：3
> 
> 时间：2012-08-31T14:53:49.290
> 
> 标签：python, sql, performance, sqlite

如果有人可以解决以下问题，这对我真的很有帮助。我有两张桌子和一个要求-

**所需的 SQL 脚本：**

在不使用循环的情况下，一个高效的 SQL 脚本将从第一个表获得的行值 (sampleID) 与第二个表的列名 (X2、X4、X8...) 匹配，并获得给定 Gene_ID 的值（例如 NFYA）。

**预期结果：**

```
X1  15.2856
X10 18.2201
X14 13.3406
. .
. . 
```

**tableone（行 X 列：135 X 32）**

表描述（部分行和列）

```
+-------+--------------------+--------+----------+-------+---------+
| Batch | filename_generate  | pcode  | SampleID | check | Diagnos |
+-------+--------------------+--------+----------+-------+---------+
| B     | cufflinks_out_2_B  | 01-111 | X2       | TRUE  | RH      |
| D     | cufflinks_out_4D   | 01-163 | X4       | TRUE  | RH      |
| B     | cufflinks_out_5_B  | 01-166 | X5       | TRUE  | RH      |
| D     | cufflinks_out_6D   | 02-007 | X6       | TRUE  | RH      |
| C     | cufflinks_out_8C   | 02-012 | X8       | TRUE  | RH      |
| C     | cufflinks_out_9C   | 02-014 | X9       | TRUE  | RH      |
| B     | cufflinks_out_10_B | 02-017 | X10      | TRUE  | RH      |
| B     | cufflinks_out_13_B | 02-030 | X13      | TRUE  | ON     |
| D     | cufflinks_out_14D  | 02-031 | X14      | TRUE  | RH      |
| B     | cufflinks_out_15B  | 02-037 | X15      | TRUE  | RH      |
| C     | cufflinks_out_16C  | 02-038 | X16      | TRUE  | IS     |
| B     | cufflinks_out_17_B | 02-041 | X17      | TRUE  | ON     |
| B     | cufflinks_out_19_B | 02-050 | X19      | TRUE  | ON     |
| B     | cufflinks_out_20_B | 02-056 | X20      | TRUE  | RH      |
+-------+--------------------+--------+----------+-------+---------+ 
```

**tabletwo（行 X 列：56000 X 137）**

表格描述（部分行和列）

```
+-----------------+----------+---------+---------+----------+----------+----------+----------+---------+
|   Ensembl_ID    | Gene_ID  |   X1    |   X10   |   X13    |   X14    |   X15    |   X16    |   X17   |
+-----------------+----------+---------+---------+----------+----------+----------+----------+---------+
| ENSG00000000003 | TSPAN6   | 1.388   | 0.443   | 0.563    | 0.350    | 0.390    | 0.220    | 0.528   | 
| ENSG00000000005 | TNMD     | 0       | 0       | 0        | 0        | 0        | 0        | 0       |
| ENSG00000000419 | DPM1     | 34.309  | 40.2635 | 28.8669  | 21.0556  | 18.1733  | 22.0223  | 25.4352 |
| ENSG00000000457 | SCYL3    | 7.84987 | 9.35551 | 7.45483  | 7.1601   | 6.53686  | 7.26445  | 6.30419 |
| ENSG00000000460 | C1orf112 | 2.36851 | 3.76825 | 3.10324  | 2.0262   | 1.84606  | 3.01185  | 3.02763 |
| ENSG00000000938 | FGR      | 227.024 | 222.578 | 247.124  | 234.995  | 255.226  | 265.288  | 323.6   |
| ENSG00000000971 | CFH      | 3.17952 | 3.60279 | 1.68429  | 3.74301  | 2.10637  | 0.763278 | 1.78278 |
| ENSG00000001036 | FUCA2    | 16.5566 | 19.1703 | 25.5005  | 18.5244  | 20.7771  | 18.353   | 25.2364 |
| ENSG00000001084 | GCLC     | 9.45121 | 16.1362 | 12.6239  | 13.1074  | 10.6472  | 18.9938  | 12.8249 |
| ENSG00000001167 | NFYA     | 15.2856 | 18.2201 | 12.4789  | 13.3406  | 15.0146  | 13.2608  | 11.5385 |
| ENSG00000001460 | C1orf201 | 1.64558 | 1.93322 | 0.7927   | 1.71796  | 2.27997  | 0.938738 | 1.3911  |
| ENSG00000001461 | NIPAL3   | 14.6073 | 14.1772 | 11.1503  | 12.5077  | 15.1269  | 13.6     | 11.227  |
| ENSG00000001497 | LAS1L    | 14.4519 | 15.3965 | 11.8901  | 16.8572  | 16.7174  | 14.6004  | 15.7266 |
+-----------------+----------+---------+---------+----------+----------+----------+----------+---------+ 
```

**用python编写的脚本，模块使用sqlite3**

我正在添加完整的代码..如果你能在这里帮助我会很好..提前谢谢！

```
import os, sys, time
import sqlite3   
import apsw  
disk_db = apsw.Connection('sampleinfogenotype.db')  
memcon=apsw.Connection(":memory:")  
with memcon.backup("main",disk_db, "main") as backup:  
    backup.step() # copy whole database in one go  

mdata=memcon.cursor()  
for row in memcon.cursor().execute("SELECT tableone.SampleID from tableone WHERE   tableone.Diagnos=='RH'"):
    sampleID_row=str(row[0])  
    sqlscript="SELECT "+sampleID_row+ " FROM tabletwo WHERE tabletwo.Gene_ID=='NFYA'"  
    data=memdata.execute(sqlscript).fetchall()[0]  
    print sampleID_row,data[0]  
memcon.close()  
disk_db.close() 
```

它给出了预期的结果，但它很耗时，因为有一个循环！是否有一个有效的 sql 脚本或方法......任何信息都会有帮助..提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:11:14.067

您不需要一遍又一遍地重新查询第二个表，您只需检索一行并将其用作查找表。如果您使用像检索一行一样简单的[`sqlite3.Row`行工厂](http://docs.python.org/library/sqlite3.html#sqlite3.Row)：

```
memcon.row_factory = sqlite3.Row
memdata.execute("select * from tabletwo where tabletwo.Gene_ID == 'NFYA'")
nfya_row = memdata.fetchone()

memdata.execute("SELECT tableone.SampleID from tableone WHERE tableone.Diagnos=='RH'")
for row in memdata:
    sampleID = row['SampleID']
    print sampleID, nfya_row[sampleID] 
```

该`nfya_row`值现在包含一个`sqlite3.Row`对象，其键是列名。现在循环遍历`tabelone`结果时，您可以直接查找任何给定列的值。

如果您改用该`apsw`模块，则没有简单的现成行工厂返回字典，但您可以轻松地自己为一行构建字典：

```
memdata.execute("select * from tabletwo where tabletwo.Gene_ID == 'NFYA'")
nfya_row = {desc[0]: column for desc, column in zip(memdata.getdescription(), memdata.next())}

memdata.execute("SELECT tableone.SampleID from tableone WHERE tableone.Diagnos=='RH'")
for row in memdata:
    sampleID = row[0]
    print sampleID, nfya_row[sampleID] 
```

# database-normalization - 试图拥有一个标准化的交易卡数据库

> ID：12217866
> 
> 赞同：1
> 
> 时间：2012-08-31T14:53:54.693
> 
> 标签：database-normalization

我一直在研究数据规范化，但不太了解如何将其应用于我正在设置的卡片数据库。每张卡都来自一组，并且该组有一个符号。既然这两个东西对于该系列中的每张牌都是相同的，那么它应该构成它自己的桌子吗？是否所有牌都应该放在一张大桌子上，而不考虑设置？

此外，是否有理由不将每组的卡片放在以符号命名的表中，并将组的名称放在一列中？

我对此很陌生，所以如果我需要更具体或只是闭嘴让我知道。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:15:14.030

这取决于你想要什么样的正常形式。

考虑一个看起来像这样的卡片表，主键是`(Name, Set)`：

```
Card:
| Name   | Set   | Symbol |
---------------------------
| Card 1 | Set 1 | 1      |
| Card 2 | Set 1 | 1      |
| Card 3 | Set 1 | 1      |
| Card 1 | Set 2 | 2      |
| Card 2 | Set 2 | 2      | 
```

该表采用[第一范式](http://en.wikipedia.org/wiki/First_normal_form)(1NF)。然而，它不是[第二范式](http://en.wikipedia.org/wiki/Second_normal_form)(2NF)，因为 的值`Symbol`取决于 的值`Set`，并且`(Set)`是主键的真子集。

正如您在问题中所说，如果您想要 2NF，则需要创建一个单独的`Set`表：

```
Card:
| Name   | Set   |
------------------
| Card 1 | Set 1 |
| Card 2 | Set 1 |
| Card 3 | Set 1 |
| Card 1 | Set 2 |
| Card 2 | Set 2 |

Set:
| Name  | Symbol |
------------------
| Set 1 | 1      |
| Set 2 | 2      | 
```

这些表现在都在 2NF（和 3NF、BCNF、4NF，...）中。

至于您问题的第二部分，您这样做而不是将所有列都放在一个表中的原因是双重的：

*   **使更改更容易。**如果你想改变一个集合的属性，你只需要更新表格中的一行`Set`，而不是更新那个集合中的所有卡片。
*   **减少数据损坏的可能性。**set 和 symbol 之间存在真正的依赖关系，但第一个表并没有强制执行这一点。这意味着数据库将很乐意让您进入损坏状态，其中同一组中的卡具有不同的符号。在第二组表中，这不可能发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T15:17:29.050

我也不确定我是否理解这个问题，但我建议您将所有卡片放在一张大桌子上，不要将它们分成不同的桌子用于不同的系列。

您想要的是唯一标识该卡的 Id (cardId)。然后有一个 setId 和一个 symbolId。

然后你的牌桌看起来像：

CardId,SetId,SymbolId,描述

1 , 1 , 2, 一张很棒的卡片

2 , 2 , 2, 另一张甜蜜的卡片

* * *

您可以使该表变得庞大，并且能够超快速地计算/分离任何组或符号的牌。然后，您只需要一个查找表来告诉您 SetId 1 是什么以及 2 是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:02:32.690

我不太确定我是否理解您的问题，但如果我想建立一个数据库 TCG，我将有一个包含所有卡片和相应信息的表。我只假设 YGO 卡用于此，因为它们是众所周知的。

在“卡片”表中，您将有一个自增的“卡片 ID”、卡片名称、卡片描述、卡片符号、效果 ID、等级、攻击值和防御价值。所有这些都与“卡片相关”。

这些集合本身在一个 1:1 的表中，它将任意数量的卡链接到玩家 ID。

因此，假设玩家 ataylor 在他的系列中有三只蓝眼白龙，他将在该表中有三个条目，所有条目都具有相同的卡片/玩家组合......每个都代表一张卡片。

那是你想知道的吗？

# machine-learning - 如果 ROC 曲线中的误报率不以 1.0 结尾，是否可以？

> ID：12217868
> 
> 赞同：6
> 
> 时间：2012-08-31T14:54:01.493
> 
> 标签：machine-learning, information-retrieval, false-positive, roc

我有以下 ROC 曲线：

![ROC曲线](../Images/2565caa36990b46594c1c1acd9d4c771.png)

它不会以 1.0 结束，因为我的预测包括零，例如

预测 = [0.9, 0.1, 0.8, 0.0]

对于 ROC 曲线，我采用 top-k 预测，首先是 {0.9}，然后是 {0.9, 0.8} 等。如果预测中不再有 > 0 的值，则预测不再随着 k 的增加而改变。

所以我不能得到一个真正的负值为零，并且由于误报率为 fp/(fp+tn)，曲线在达到 1 之前就结束了。

现在，我是否也应该人为地使用零进行预测，或者如果曲线就这样结束就可以了吗？使用零也感觉不对。还是我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T15:51:27.527

ROC 曲线显示了在将阈值设置为不同值时，假阳性和假阴性之间可能的权衡。在一个极端情况下，您可以将阈值设置得如此之低，以至于将所有内容都标记为阳性，从而得到 0 的误报率和 1 的误报率。在另一个极端情况下，您可以将阈值设置得如此之高，以至于将所有内容都标记为作为阴性，给你一个假阴性率 1 和一个假阳性率 0。

虽然这些退化情况在实践中没有用，但它们在理论上仍然是有效的权衡，并且是 ROC 曲线的正常部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-06T02:51:53.653

是的当然！正如 Antimony 之前提到的，ROC 曲线用于显示假阳性率和真阳性率之间的权衡。我记得，有一次我在数据上训练了一个神经网络，并且在我运行模型的 90% 的时间内，我的误报率都为 0（因为 fp 为 0）。太棒了！因为我的 TPR 大部分时间都是 1，所以我的 ROC 曲线有点奇怪，因为它主要是 y 轴（TPR 轴）上的一些点。

您的模型运行良好，因为您的 FPR 没有超出某些特定值。

让我举个例子，对于特定的输入变量，我的模型如下工作： 预测输出：[0.97, 5.78E-4, 6.15E-4] 实际输出：[1.0, 0.0, 0.0]

您可以看到该模型的预测非常完美，因为第一个值是对应类别 1 的预测值，很容易与其他两个值区分开来。另外，因为其他两个值，我的意思是 [5.78E-4, 6.15E-4]，与 0.97 相比非常小。对于每个截止值，0.97 将映射到 1，另外两个值映射到 0。我们可以看到，无论截止值是多少，TPR 都很高，FPR 为零。

# android - Android完成（）活动不工作

> ID：12217871
> 
> 赞同：1
> 
> 时间：2012-08-31T14:54:15.057
> 
> 标签：android

当我使用`finish();`"The method finish() is undefined for the type SaveImageTask" 时，我的代码中出现此错误。我是否遗漏了一些声明或任何东西。有人可以指导我吗？

```
 public class SaveImageTask extends AsyncTask<String , String , String> {

            private Context context;
            private ProgressDialog pDialog;

            boolean bCancelled=false;
            public SaveImageTask(Context context) {
                this.context = context;
            }

            @Override
            protected void onPreExecute() {
                // TODO Auto-generated method stub

                super.onPreExecute();

                pDialog = new ProgressDialog(context);
                pDialog.setIndeterminate(false);
                pDialog.setCancelable(true);
                pDialog.setOnCancelListener(cancelListener);
                pDialog.show();

            }

            @Override
            protected String doInBackground(String... args) {
                // TODO Auto-generated method stub

                // MY STUFF
                return null;   
            }

            @Override
            protected void onPostExecute(String args) {
                // TODO Auto-generated method stub

                pDialog.dismiss();

            }

            OnCancelListener cancelListener=new OnCancelListener(){
                @Override
                public void onCancel(DialogInterface arg0){
                    bCancelled=true;
                    SaveImageTask.this.finish(); // <<----"The method finish() is undefined for the type SaveImageTask"
                }
            };

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T14:56:21.720

利用`SaveImageTask.this.finish();`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T15:08:06.840

只需使用，

```
(Activity(context)).finish(); 
```

**编辑：**

实际上，您必须将上下文转换为活动上下文，

然后你可以使用`finish()`Activity的方法，

就像是，

```
private Activity context;

public SaveImageTask(Context context) {
                this.context = (Activity)context;
            } 
```

现在，只是

```
context.finish(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-31T15:02:14.670

```
 OnCancelListener cancelListener=new OnCancelListener(){
                @Override
                public void onCancel(DialogInterface arg0){
                    bCancelled=true;
                    finish(); // <<----"The method finish() is undefined for the type new DialogInterface.OnCancelListener(){}"
                }
            }; 
```

你在这里创建一个`anonymous class`。只有外部类的最终变量和方法才能在匿名类中直接访问。[`Activity`'s`finish`](http://developer.android.com/reference/android/app/Activity.html#finish%28%29)不是最终方法。您需要做的是引用“外部”类，它是一个`Activity`并调用它`finish()`

`ActivityName.this.finish()`

注意：您不能像`ActivityName.finish()`引用活动对象那样进行静态调用`this`。

# ruby-on-rails - Ruby on Rails：如何使用 send_file 下载文件并仍然显示视图

> ID：12217873
> 
> 赞同：2
> 
> 时间：2012-08-31T14:54:31.930
> 
> 标签：ruby-on-rails, sendfile

我正在发送一封电子邮件，其中包含可下载小册子的链接。

这是我的下载操作

```
def download
    @thing = Thing.find_using_slug(params[:id])

    send_file @thing.brochure.path, 
        :type => 'application/pdf', 
        :filename => "#{@thing.name}_brochure.pdf"
end 
```

当用户单击电子邮件中的链接时，它开始下载，然后他们留下一个空白屏幕。我想呈现一个登陆页面并仍然发送文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:01:51.953

将电子邮件中的链接指向登录页面的操作可能是一个更好的主意，可能会`?dl`附加查询字符串之类的内容。

登陆页面操作可以有条件地检查`params.include?(:dl)`，如果找到，则将如下所示的 Javascript 附加到`<head>`登陆页面 HTML 的 中。

```
window.onload = function() {
  setTimeout(function() {
    window.location = 'URL TO DOWNLOAD ACTION HERE';
  }, 2000);
} 
```

如果用户禁用了 Javascript 或不想等待 2 秒进行重定向，则最好**在**登录页面上提供链接*（同样，以存在`?dl`查询字符串为条件） 。*

# java - 2D 游戏 - 渲染时或在另一个线程中的计算？

> ID：12217878
> 
> 赞同：0
> 
> 时间：2012-08-31T14:54:53.510
> 
> 标签：java, multithreading, 2d, render, libgdx

我目前正在将 LibGDX 用于 Android 项目，但我认为无论您使用什么框架/库或语言，这个问题的答案都会很有用。

我在 Internet 上找到的所有教程（针对 LibGDX）都会在`render()`调用整个应用程序的方法时以及在绘制每个实体之前进行计算，就像移动实体一样。我认为这可能是必要的，因为例如，如果您有一个对象在`render()`调用方法时应该以 3m/s 的速度移动，您将执行类似`position.y = velocity.y * deltaTime`的操作，以便根据对象的速度进行移动。

但是像 -> AI 控制的对象应该遵循什么路径才能不撞墙或根据玩家的动作进行计算呢？在 2D 中，甚至在 3D 中，可能会有很多计算、算术运算等......结果与 t 无关，`deltaTime`也不需要知道它。此外，这可能会减慢渲染速度，因此在某些功能不是很强大的手机或平板电脑上运行应用程序时。

那么这种类型的计算应该在渲染时进行还是仅在另一个线程需要时进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:44:33.333

实际上，您通常*只*希望在显示线程中呈现特定于渲染的内容。显然，这本身仍然是相当激烈的。然而，像在物理模拟中更新一个单元的位置、AI 计算等，应该在一个单独的线程中（取决于系统资源和架构，一个一个）——你希望渲染线程尽可能快。

还有一种叫做关注点分离的东西——如果你既要更新对象在屏幕上的位置（重新绘制），又要在同一个线程中移动它，那么它会做*两*件事，这*可能*会使未来的修改/维护更加困难。

请注意，如果您*正在*执行多线程架构，您的设置将需要有一些方法来确保您在渲染它们时不会更新它们，否则您可能会得到一些奇怪的结果。

# php - 托管服务提供商因 AJAX 请求而阻止用户

> ID：12217879
> 
> 赞同：2
> 
> 时间：2012-08-31T14:54:54.770
> 
> 标签：php, javascript, ajax, asynchronous, ddos

我制作了一个[聊天系统](http://www.robinj.be/Chat/)，可以处理 AJAX 请求。仅在几分钟到半小时的聊天后，我的托管服务提供商开始阻止人们，这可能是因为它将 AJAX 请求视为未遂 (D)DoS 攻击。

我最好的选择是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T14:59:57.907

显然，您已经构建了 ajax 聊天以在每次 ajax 调用时加载所有消息。这对服务器来说太重了。

正如@Daniil 所指出的，您最好使用 websockets（例如 pusher 或 slanger）来传达实时消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T14:58:39.493

1.  当您需要实时处理数据时，请使用 websockets。
2.  如果您仍想使用 AJAX，请不要对您的脚本发出太多请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T14:58:07.513

使用不那么糟糕的主机？

更严重的是，确保发送的 AJAX 请求的数量是合理的（每 5 秒一个应该没问题）。确保您的主机实际上允许诸如聊天之类的高活动，因为大多数共享主机可能不会。

根据您的需要，您可能想要获得 VDS 甚至是完整的专用服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T15:13:22.147

1.  移出到不同的主机。
2.  优化代码。

这不可能是防火墙问题，因为您说它在被阻止之前可以工作半小时。这可能是您的托管公司迫使您转向更昂贵的套餐的借口。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-08-31T22:36:43.307

[长轮询](https://stackoverflow.com/a/333884/1639699)？

我并不是建议您不要使用 websockets 或服务器发送事件之类的东西，但是，如果由于某种原因您无法使用，那么我想您可以尝试通过不立即关闭它们来减少 AJAX 请求的数量做。

# java - 配置文件的位置

> ID：12217880
> 
> 赞同：1
> 
> 时间：2012-08-31T14:54:58.363
> 
> 标签：java, netbeans

我有一个文本文件。它有配置信息。此文件应保留在外部，以便随时更改此文件的内容。运行时，应从中读取内容。我正在使用 netbeans，我尝试使用 ClassLoader，在我构建之后，dist 文件夹没有 config_text.txt 文件。有没有办法做到这一点，就像我们在netbeans中添加库文件（jar）一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:17:02.953

你怎么读？如果该文件在您的项目根目录中（例如 build.xml 所在的位置），您可以像访问它一样访问它`File f = new File("my file.txt");`- 但 NB 不会将它移动到 do ist 文件夹中。

顺便提一句。building 不会将任何文件添加到 dist 文件夹中，而是将 libs 和您的 jar 添加到 dist 文件夹中。也许您可以尝试更改 ant 脚本。也来看看吧`build.xml`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T03:35:15.040

我经常使用该`user.home`属性来创建配置文件。就我而言，我检查该文件是否存在于`user.home`目录中。如果没有，那么我从我的应用程序中导出一个副本，或者将默认属性写入文件。您可能想尝试这种方法。使用该`user.home`目录也可以使其跨平台保持一致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:37:41.047

如果您将文件添加到 NetBeans 项目目录中的“src”文件夹中，那么它应该自动放置在 dist 文件夹和您构建的任何 jar 中的相同相对位置。无论如何，它对我有用，我正在运行 Windows 7x64 和 NetBeans 7.1.2 例如将文件放在：

> *NetBeansProjects\PROJECT_NAME\src\PACKAGE_NAME\config_text.txt

应该自动把文件放在这里：

> *\NetBeansProjects\PROJECT_NAME\build\classes\PACKAGE_NAME\config_text.txt

然后，您可以使用 getResource() 方法访问它。

编辑：

可能是您运行“清洁和构建”而不仅仅是“构建”吗？第一个将删除“dist”文件夹中的所有内容并重新生成内容，第二个将重新创建您的 Jar 并将其他文件（例如 config_text.txt）保留在原处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T16:49:12.523

```
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.Properties;

public class ConfigHandler {

    private static final String PROPERTIES_FILE = "/home/myConfigFile.properties";
    private static final Properties PROPERTIES = new Properties();

    static {
        loadPropertyFile(PROPERTIES_FILE);
    }

    private static void loadPropertyFile(final String path) {
        InputStream is = null;
        try {
            is = new FileInputStream(path);
            PROPERTIES.load(is);
        } catch (IOException e) {
            throw new RuntimeException("Failed to load property file", e);
        } finally {
            if (is != null) {
                try {
                    is.close();
                } catch (IOException ex) {
                }
            }
        }
    }

    public void reLoadPropertyFile() throws IOException {
        loadPropertyFile(PROPERTIES_FILE);
    }

    public static String getProperty(String key) {
        return PROPERTIES.getProperty(key);
    }
} 
```

要在代码中的任何位置读取配置值：

```
String somePropertyValue = ConfigHandler.getProperty("someProperty"); 
```

要重新加载配置文件： `ConfigHandler.reLoadPropertyFile();`

# node.js - 未调用Nodejs Passport身份验证回调

> ID：12217881
> 
> 赞同：22
> 
> 时间：2012-08-31T14:55:13.260
> 
> 标签：node.js, passport.js

使用 Nodejs Passport，我正在使用以下代码测试发生错误情况时会发生什么：

```
passport.use(new LocalStrategy(
  function(username, password, done) {
    // asynchronous verification, for effect...
    process.nextTick(function () {
      findByUsername(username, function(err, user) {
    console.log('in auth function');
      return done('errortest');
        if (err) { return done(err); }
        if (!user) {
          return done(null, false, { message: 'Unknown user ' + username });
        }
        if (user.password != password) {
          return done(null, false, { message: 'Invalid password' });
        }
        return done(null, user);
      })
    });
  }
));

app.get('/logintest', function(req, res, next) {
console.log('before authenticate');
  passport.authenticate('local', function(err, user, info) {
console.log('authenticate callback');
    if (err) { return res.send({'status':'err','message':err.message}); }
    if (!user) { return res.send({'status':'fail','message':info.message}); }
    req.logIn(user, function(err) {
      if (err) { return res.send({'status':'err','message':err.message}); }
      return res.send({'status':'ok'});
    });
  })(req, res, next);
}); 
```

使用路由 /logintest?username=bob&password=s 我希望在控制台中看到，“在验证之前”然后是“在验证函数中”然后是“验证回调”，但它只显示前两个，然后是“errortest”和“errortest” " 显示在浏览器中。

我也尝试过`return done({'message':'test'});`，“[object Object]”显示在控制台和浏览器中。

这是不能正常工作还是我错过了什么？

编辑：根据 Jared Hanson 的响应，将此错误处理函数作为第三个参数添加到 app.get() 允许我捕获错误并返回适当的 json：

```
...
    })(req, res, next);
  },
  function(err, req, res, next) {
    // failure in login test route
    return res.send({'status':'err','message':err.message});
  }); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-31T15:23:24.267

您完全理解它，并且它按预期工作。

如果发生任何错误，Passport 会立即`next()`显示该错误。您可以使用错误处理中间件（详情：[http ://expressjs.com/guide/error-handling.html](http://expressjs.com/guide/error-handling.html)如果您想以自定义方式处理该错误，

自定义回调主要用于处理身份验证成功或失败 ( `user`== `false`)。错误，如 DB 连接等，不会传递回回调，有利于上述错误处理中间件。我考虑过改变这一点，但还没有找到令人信服的理由。但是，如果您有上述未涵盖的用例，请告诉我。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-19T06:05:59.337

`bodyparser.json()`引起了我的问题，我通过按路线（特别是在护照路线上）设置它来修复它，如下所示：

```
app.post('/login', bodyParser.urlencoded({ extended: true }), function (req, res, next) {
          passport.authenticate('local', function (err, user, info) {
               if (err) { return next(err) }
               if (!user) {
                    console.log('bad');
                    req.session.messages = [info.message];
                    return res.redirect('/login')
               }
               req.logIn(user, function (err) {
                    console.log('good');
                    if (err) { return next(err); }
                    return res.redirect('/');
               });
          })(req, res, next);
     }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-06T06:29:08.017

我有同样的问题。然后放，

```
const bodyParser=require('body-parser');
app.use(bodyParser.urlencoded({extended:false}));
app.use(bodyParser.json()); 
```

# java - Htmlunit 中的 HtmlAnchor click() 函数不起作用

> ID：12217889
> 
> 赞同：2
> 
> 时间：2012-08-31T14:55:32.730
> 
> 标签：java, javascript, htmlunit

我正在尝试使用 HtmlUnit 自动浏览网站。我需要在此过程中按一些按钮。首先，我用这个 xml 构建一个按钮的 HtmlAnchor 对象：

```
<a href="dog.php">
  <img src="http://images.hand.co.uk/Pic/site_images/hand/Myper/MyOrder/images/DogRed.gif" width="75" height="31" border="0" alt="1 adds"/>
</a> 
```

当我使用 click() 方法单击它时效果很好。然后我被移动到另一个页面，其中有我需要单击以显示所需内容的链接。点击后我没有移动到另一个页面，它只是一个 Java 脚本函数触发。

这是第二个链接的锚点：

```
<a style="color: black; font-weight: bold;" href="javascript:show_me('DogDetails.php?DogID=2445485', 2445485, 800);">
  details
</a> 
```

对于这两个元素，我使用 HtmlAnchor 对象及其 click() 方法。但是该方法对第二个元素根本没有任何作用。

我也尝试过使用内置在 HtmlUnit 中的 JavaScript 引擎，但没有成功。如何单击与 HtmlUnit 平台的持久链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:05:13.300

最可能的问题是 HtmlUnit 没有等待 JavaScript 完成运行。HtmlUnit FAQ 建议 3 个解决方法：http: [//htmlunit.sourceforge.net/faq.html#AJAXDoesNotWork](http://htmlunit.sourceforge.net/faq.html#AJAXDoesNotWork)。

其中，最巧妙的解决方案是让您`WebClient`等待 AJAX 请求完成：

```
webClient.setAjaxController(new NicelyResynchronizingAjaxController()); 
```

我发现有些网站在后台线程上运行 AJAX 是一个聪明的技巧——这意味着`NicelyResynchronizingAjaxController`它不会等待它完成，因为它只监视主 UI 线程。[这里](https://stackoverflow.com/a/5723773/607861)有一个很好的答案，它解释了如何等待所有线程而不仅仅是主线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-11T12:59:50.860

我有一个类似的问题，尝试了几种方法来等待 javascript 在后台运行，但没有成功。

我有半点心思切换到 Selenium，但在 WebClient 上禁用 CSS 后它“自行解决了”：

```
WebClient.getOptions().setCssEnabled(false); 
```

每当我们重新启用 CSS 时，.click() 就会停止工作。

我的锚是：

```
<div class="my-anchor's-parent-class"/>
  <a href="javascript:void(0) class="text" id="buttonSearch" style="display: block;">Search</a>
</div> 
```

它有一些 JQuery 将 .click() 处理程序附加到它，它根据我的锚的父级的“类”属性采取行动：

```
 $('.my-anchor's-parent-class').each(function () {
        $(this).children('a').click(function () {
          // if parent has another given class appended, call .myFunction(this)
          // else, call other function
        });
    }); 
```

# vb.net - 使用代码删除创建的控件？

> ID：12217890
> 
> 赞同：1
> 
> 时间：2012-08-31T14:55:34.970
> 
> 标签：vb.net

这是我写的：

```
Public Class Form1

Public Sub Label1_MouseHover(sender As Object, e As System.EventArgs) Handles Label1.MouseHover
Dim Label2 As New Label
Label2.Location = New Point(158, 87)
Label2.Text = "lol"
Me.Controls.Add(Label2)
End Sub

Public Sub Label1_MouseLeave(sender As Object, e As System.EventArgs) Handles Label1.MouseLeave
Me.Controls.Remove(Label2)
End Sub
End Class 
```

所以，当我将鼠标放在另一个标签上时，我想创建一个新标签，当我用鼠标离开标签时，我希望新创建的控件消失。使用此代码，它说：“'Label2' 未声明。由于其保护级别，它可能无法访问。” 可能是因为 Label2 实际上并没有在注册表中，直到我在运行程序时创建它。那么有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:01:06.260

该变量`Label2`对于声明它的函数是本地的 - 这意味着您只能在此函数内访问它。您可以在模块级别使用变量（如果您也不想在其他模块中使用它，请将其声明为私有）。请参阅 Visual Basic文章中的 MSDN[范围。](http://msdn.microsoft.com/en-us/library/1t0wsc67.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:01:23.187

您的问题是范围。Label2 的声明在 label1.mousehover 的事件处理程序中，因此在 label1.mouseleave 的事件处理程序期间它不会存在。

您可能可以通过创建标签并将其设置为不可见，然后在事件处理程序中操作其可见性和文本来更好地完成您想要的事情。

# c++ - 混合架构？

> ID：12217891
> 
> 赞同：1
> 
> 时间：2012-08-31T14:55:45.463
> 
> 标签：c++, architecture, fortran, linker-errors

我有一个用于我的 C++ 程序的 Fortran DLL，在该程序中`LNK2001`出现错误。

我检查了 Fortran DLL 构建，它应该是 64 位的，而我的 C++ 代码是 32 位的。

这是我的链接器错误的问题吗？（之所以问这个问题，是因为我已经检查以确保将 fortran 库正确添加到我的项目中）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T15:00:04.047

您不能在一个可执行文件中组合 32 位和 64 位。

# java - Java、DynamoDB：是否可以自定义编组一个集合？

> ID：12217907
> 
> 赞同：5
> 
> 时间：2012-08-31T14:57:16.453
> 
> 标签：java, spring, amazon-web-services, amazon-dynamodb

我需要注释一个具有`Set<UUID>`属性的类。编组一个标量`UUID`很好，我可以使用`@DynamoDBMarshalling`注释来指定我的转换器，一切正常。

当尝试在 a 上使用相同的转换器时`Set<UUID>`，我得到“DynamoDBMappingException: Expected SS in value”。我尝试创建一个期望的自定义​​转换器`Set<UUID>`，但同样的问题仍然存在。

是否可以自定义编组集？

```
@DynamoDBTable(tableName="djones-test")
public class UUIDRecommendation {
    private UUID id;
    private Set<UUID> recommendations;

    @DynamoDBHashKey
    @DynamoDBMarshalling(marshallerClass=UuidConverter.class)
    public UUID getId() {
        return id;
    }

    public void setId(UUID id) {
        this.id = id;
    }

    //Neither this nor UuidConverter.class work here    
    @DynamoDBMarshalling(marshallerClass=SetUuidConverter.class)
    public Set<UUID> getRecommendations() {
        return recommendations;
    }

    public void setRecommendations(Set<UUID> recommendations) {
        this.recommendations = recommendations;
    }
} 
```

这是堆栈跟踪：

```
com.amazonaws.services.dynamodb.datamodeling.DynamoDBMappingException: Expected SS in value {SS: [1a841b97-ab9d-4425-a2c0-f9a81bebf0b4, 1a841b97-ab9d-4425-a2c0-f9a81bebf0b4, 1a841b97-ab9d-4425-a2c0-f9a81bebf0b4], } when invoking public void com.company.model.UUIDRecommendation.setRecommendations(java.util.Set)
    at com.amazonaws.services.dynamodb.datamodeling.SUnmarshaller.typeCheck(SUnmarshaller.java:26)
    at com.amazonaws.services.dynamodb.datamodeling.DynamoDBMapper.setValue(DynamoDBMapper.java:329)
    at com.amazonaws.services.dynamodb.datamodeling.DynamoDBMapper.marshallIntoObject(DynamoDBMapper.java:302)
    at com.amazonaws.services.dynamodb.datamodeling.DynamoDBMapper.load(DynamoDBMapper.java:253)
    at com.amazonaws.services.dynamodb.datamodeling.DynamoDBMapper.load(DynamoDBMapper.java:196)
    at com.mendeley.service.data.DynamoRecommendedItemsDataServiceTest.testObjectMapper(DynamoRecommendedItemsDataServiceTest.java:65)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T10:26:22.610

试试这个。它处理 getter/setter 内的编组/解组。我使用类似的技术来存储包含 JSON，但在我的代码中将`Set<String>`其作为 a 访问。`Set<CustomObject>`我不理会 getter/setter，而是使用方便的方法。

这是修改后的版本：

```
@DynamoDBTable(tableName="djones-test")
public class UUIDRecommendation {
    private String id;
    // custom object representation in JVM
    private Set<UUID> recommendations;

    private static final JsonMarshaller<UUID> UUID_MARSHALLER = new JsonMarshaller<UUID>();

    @DynamoDBHashKey(attributeName="id")
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }

    // Set<String> holding JSON in DynamoDB
    @DynamoDBAttribute(attributeName="recommendations")
    public Set<String> getRecommendations() {
        if (recommendations != null) {
            Set<String> jsonSet = new HashSet<String>(recommendations.size());
            for (UUID recommendation : recommendations) {
                String json = UUID_MARSHALLER.marshall(recommendation);
                jsonSet.add(json);
            }
            return jsonSet;
        } else {
            return null;
        }
    }
    public void setRecommendations(Set<String> jsonSet) {
        if (jsonSet != null) {
            recommendations = new HashSet<UUID>(jsonSet.size());
            for (String json : jsonSet) {
                UUID recommendation = UUID_MARSHALLER.unmarshall(UUID.class, json);
                recommendations.add(recommendation);
            }
        }
    }

    // convenience methods
    @DynamoDBIgnore
    public UUID convenienceMethod(UUID recommendation) {
        return null;
    }

    // custom object
    public class UUID {

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T15:04:54.733

哦，亲爱的 - 看起来客户编组是*不可能*的。AWS 开发工具包经过硬编码，仅处理单个字符串值 (SUnmarshaller())。

AWS SDK 1.3.13 中的 DynamoDBReflector，第 185 行：

```
if ( isCustomMarshaller(getter) ) {
    unmarshaller = new SUnmarshaller() {

        @Override
        public Object unmarshall(AttributeValue value) {
            return getCustomMarshalledValue(toReturn, getter, value);
        }
    };
} 
```

**更新**

作为一个完全肮脏的黑客，我通过复制/粘贴整个类来拼凑一些东西:(这就是为什么私有静态最终实用程序服务*不好*，而依赖注入*很好*。

这将起作用，因此您可以将一个客户转换器（`UuidConverter`在我的情况下）用于返回`UUID`实例*或* `Set<UUID>`实例的 getter。

我添加了一个名为 getCustomMarshalledValueSet 的方法，它遍历 value.getSS() 返回的 List，为每个调用自定义编组器，并将结果添加到它返回的 Set 中。

```
 @SuppressWarnings({ "rawtypes", "unchecked" })
    private <T> T getCustomMarshalledValueSet(T toReturn, Method getter, AttributeValue value) {
    DynamoDBMarshalling annotation = getter.getAnnotation(DynamoDBMarshalling.class);
    Class<? extends DynamoDBMarshaller<? extends Object>> marshallerClass = annotation.marshallerClass();

    DynamoDBMarshaller marshaller;
    try {
        marshaller = marshallerClass.newInstance();
    } catch (InstantiationException e) {
        throw new DynamoDBMappingException("Couldn't instantiate marshaller of class " + marshallerClass, e);
    } catch (IllegalAccessException e) {
        throw new DynamoDBMappingException("Couldn't instantiate marshaller of class " + marshallerClass, e);
    }

    Set<T> set = new HashSet<T>();

    for (String part : value.getSS()) {
        set.add((T) marshaller.unmarshall(getter.getReturnType(), part));
    }

    return (T) set;
} 
```

此外，更改了 getArgumentUnmarshaller 以在条件之前进行 isCollection 检查以决定使用哪种类型的解组器，并更改了自定义编组器块以选择正确的排序。

```
 if (isCustomMarshaller(getter)) {
                if (isCollection) {
                    unmarshaller = new SSUnmarshaller() {

                        @Override
                        public Object unmarshall(AttributeValue value) {
                            return getCustomMarshalledValueSet(toReturn, getter, value);
                        }
                    };
                } else {
                    unmarshaller = new SUnmarshaller() {

                        @Override
                        public Object unmarshall(AttributeValue value) {
                            return getCustomMarshalledValue(toReturn, getter, value);
                        }
                    };
                }

            } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-28T16:42:35.930

[请参阅此拉取请求](https://github.com/aws/aws-sdk-java/pull/64)，我附加了一个修改版本的 DynamoDBReflector，它处理一组任意对象的序列化/反序列化。我已经使用了一段时间，效果很好。

# jquery - 使用 ASP.NET MVC 和 jQuery 仅刷新更新的行

> ID：12217910
> 
> 赞同：2
> 
> 时间：2012-08-31T14:57:28.227
> 
> 标签：jquery, html, asp.net-mvc-3, jquery-ui, jquery-plugins

我是 ASP.NET MVC 和 jQuery 的新手，正在尝试做一些经典的事情。我的需要是通过弹出编辑表单提供 CRUD 功能。

我创建了一个表格并显示数据。我有一个局部视图渲染每个表行，索引视图在循环中调用它：

```
<tbody>
@foreach (var item in Model)
{
    @Html.Partial("_OrderRow", item)
}
</tbody> 
```

每行都有一个编辑按钮，当我单击它时，会打开一个 jQuery 弹出表单并加载编辑表单。当我单击更新按钮时，它会成功执行操作（使用 ajax 请求）并返回一个 JsonResult，其中包括使用更新的项目呈现的部分视图（_OrderRow）：

```
 [HttpPost]
    public JsonResult OrderEdit(OrderViewModel order)
    {
        if (ModelState.IsValid)
        {
            Order ord = OrderMapper.MapToEntity(order);

            db.Orders.Attach(ord);
            db.ObjectStateManager.ChangeObjectState(ord, EntityState.Modified);
            db.SaveChanges();

            return Json(new { Success = true, ObjectId = order.Id, Html = RenderPartialViewToString("_OrderRow", order) }, JsonRequestBehavior.DenyGet);
        }

        return Json(new { Success = false, Object = order }, JsonRequestBehavior.DenyGet);
    } 
```

因此，在客户端的 updateSuccess 函数中，我有更新项目的 HTML。

之后，我只需使用 jQuery 获取相应的表格行，然后使用 replaceWith 将其替换为我的最新表格行。

到目前为止，这种情况运行良好。但我的问题是它不会改变实际的 HTML，它只会操纵 DOM。因此，如果我在尝试刷新表格（样式、分页等）时使用一些表格插件（如 DataTables、TableSorter 等），它们会忽略我的新表格行。因为实际的 HTML 包含旧的。

当我插入新行或删除时，我似乎会遇到同样的问题。

我更喜欢这种方式，因为它不依赖任何插件（尽可能）并控制我的视图。因此，任何帮助将不胜感激。

谢谢。

# android - 支持android分辨率屏幕：了解

> ID：12217911
> 
> 赞同：0
> 
> 时间：2012-08-31T14:57:41.400
> 
> 标签：android, image, resolution, dpi

尽管我已经阅读了 2 次，但我并不真正了解 DP 度量。

假设我有一张图像，它的分辨率是：400 X 400 PX。

我想把它作为我的应用程序的背景图片。我将相同的图像放在不同的可绘制文件夹（ldpi，mdpi，...）

图像会拉伸吗？我不知道图像在不同的可绘制文件夹上应该是什么分辨率，所以它适合设备。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T15:06:30.390

你的基础密度是`mdpi`。`mdpi`因此，您的 400x400 dp 图像将仅在设备上按原样呈现。如果你想要相同的尺寸`ldpi`，你必须将你的图像按比例缩放`0.75`。对于`hdpi`您的图像需要`1.5`大几倍，对于`xhdpi`设备来说，`2.0`是您的`mdpi`.

就像`mdpi`你的基础一样，我总是在开发时将drawables放在`res/drawable-mdpi`文件夹中。一旦我准备好发布代码，我就会将`hdpi`资源添加到`res/drawables-hdpi`. 我个人并不关心`ldpi`设备，因为我的目标设备几乎没有比密度低的设备`mdpi`，如果有人会拥有这样的设备，那么我对 android 框架进行缩减感到满意。但是升级是另一回事-您总是会得到不好的结果（模糊的图像），因为您根本无法在没有伪像的情况下从较小的位图制作更大的位图（不，CSI 谎言；）-您根本没有足够的数据，因此您必须进行推断。所以最好自己提供合适的drawables，否则你的最终用户会抱怨，你的应用程序可能看起来不像它应该的那么好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T15:06:52.427

这个想法是显示图像的实际物理尺寸将根据屏幕分辨率而有所不同。

在 mdpi 设备上，屏幕密度约为 1.5 dpi（每英寸点数），这意味着您的 400 像素宽图像将测量 2.5 英寸。

如果您希望图像在 hdpi 设备上的大小大致相同（例如 250 dpi），那么您必须提供 625 像素宽的图像（2.5*250）。您应将图像放入`drawable-hdpi`文件夹中。

有关不同密度的说明，请参阅[此页面](http://developer.android.com/guide/practices/screens_support.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:53:48.280

在设计应在多个设备上运行的应用程序时，需要注意两个重要参数：

*   尺寸（设备的物理尺寸）
*   设备密度

大小：android 中设备的大小不是定义为唯一的物理值，而是定义为一个范围。
它们是：小、正常、大和超大。

密度：密度也被定义为一个范围。
它们是：ldpi、mdpi、hdpi 和 xhdpi。

![在此处输入图像描述](../Images/b4a6d54e3e277ac71bb631dd1134fde3.png)

为了处理尺寸，您需要使用多个布局，每个类别的尺寸一个，并且您需要为每个布局的视图的高度和宽度使用不同的 dp 值，因为小型和大型设备的尺寸不会一样。

对于处理密度，您需要为不同的屏幕密度使用不同的绘图，即您需要将不同密度的绘图放置在不同的绘图文件夹中。
例如：
这些是特定可绘制对象的分辨率

*   36x36 用于低密度（放置在 drawable-ldpi 中）
*   48x48 用于中等密度（放置在 drawable-mdpi 中）
*   72x72 用于高密度（放置在 drawable-hdpi 中）
*   96x96 用于超高密度（放置在 drawable-xhdpi 中）

这种分辨率变化的比率为 3:4:6:8(ldpi:mdpi:hdpi:xhdpi)

如需进一步阅读，您可以参考这个 android 开发者的链接：http:
[//developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

# jquery - 在新插入的 PHP 内容上绑定 .click 到 toggleClass("hidden")。事件冒泡？

> ID：12217914
> 
> 赞同：1
> 
> 时间：2012-08-31T14:57:44.530
> 
> 标签：jquery, ajax, binding, event-bubbling

**编辑：**感谢KK，我能够解决这个问题！正确工作的代码在帖子的底部。

我对 JavaScript 和 jQuery 很陌生，几天来我一直在努力解决这个问题，但我不会放弃！

我的所有函数都在 $(function () { 下，所以它们都加载到准备好的 DOM 上。我有一个工作按钮，可以从 .php 页面加载内容，然后新加载的内容有另一个按钮，当clicked 应该做一些基本的事情，比如从 iFrame 中删除“隐藏”类。

下面是第一个按钮（我删除了 e.preventDefault 以防万一）

```
$(function() {
  $('.top5').click( function(e) {
    $("#currentactivity").html('<img src="./images/loading.gif" alt="loading" />').show();
    var url= "index.php";
    $.post(url, {q:$(this).attr('value')}, function(data){
      $("#currentactivity").html(data).show();
    });
  });
}); 
```

以下是第二个按钮的两次尝试，均无效。

```
// using .live()
  $('body').live("click", function(event) {
    if ($(event.target).hasClass("missionopen") {
      var $target = $('#missioniframe');
      if $target.hasClass("hidden") {
        $target.toggleClass("hidden");
      }
    });
  });

// Just plain event bubbling (Since body is already loaded?)
  $('body').click(function(event) {
    if ($(event.target).hasClass('missionopen')) {
      $('#missioniframe').toggleClass('hidden');
    }
  }); 
```

这里是 button1、button2（从 php 加载）和 iframe HTML 代码片段。

```
<a href="#" class="top5" value="1"><img src="./images/qstata.png" /></a> 

<a href='#' class='missionopen' value='1'><img class='missionhero' src='./images/bluebutton1.png' /></a>

<iframe src='missioniframe.html' class='hidden' id='missioniframe' frameborder='0' scrolling='no' ></iframe> 
```

**工作代码：由 KK 提供**

```
 $('body').on("click", ".missionopen", function(e) {
    $('#missioniframe').toggleClass("hidden");
    e.preventDefault();
  }); 
```

# facebook - ios5 - 使用 Facebook 进行登录视图

> ID：12217916
> 
> 赞同：-1
> 
> 时间：2012-08-31T14:57:59.653
> 
> 标签：facebook, ios5, login

我正在开发一个应用程序，我必须使用 facebook 进行身份验证，然后在成功进行身份验证后，我想允许用户继续使用该应用程序。
我正在寻求有关如何执行此操作的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:16:24.243

为了让您的用户在 Facebook 上使用您的应用程序，您必须在 Facebook 上注册它（请参阅[此处](https://developers.facebook.com/apps)的“创建新应用程序” ）。

这将为您的应用程序分配一个密码和一个 ID 代码，您可以使用它们与 iOS、JavaScript 或 PHP API 一起完成身份验证过程。

有关详细信息，请参见此处： [https](https://developers.facebook.com/ios/) ://developers.facebook.com/ios/ （如果您正在构建原生 iOS 应用程序） [https://developers.facebook.com/docs/guides/mobile/web/](https://developers.facebook.com/docs/guides/mobile/web/)（如果您'正在构建一个 Web 应用程序并将其打包用于 iOS）

# ruby-on-rails - 删除 红宝石字符串中的行

> ID：12217919
> 
> 赞同：2
> 
> 时间：2012-08-31T14:58:08.823
> 
> 标签：ruby-on-rails, ruby

在我的表单中，我有一个 textarea 字段，用户可以在其中输入数据并按“Enter”来放置换行符并继续输入数据。

当我从数据库中检索数据时，我需要删除所有换行符并将该数据存储在一个 JavaScript 数组中。

在下面的示例中，我正在检索一个注释（其中包含几个换行符`<br/>`）并存储在一个名为“exp_from_db”的数组中

```
exp_from_db[1]= '<%= note.NOTE_VALUE %>'; 
```

我的问题是如何`<%= note.NOTE_VALUE %>`在将其存储在 javascript 数组中之前删除这些换行符。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T15:06:02.623

如果字符串`<br/>`及其变体*( `<br>`, `<br />`, `<br >`)*是您想要删除的全部，`gsub`是一种方法

```
note.NOTE_VALUE.gsub(/<br\s*\/?>/, '') 
```

如果你*总是*想去掉这个，你可以`NOTE_VALUE`在 ActiveRecord 类中修改 getter

```
def NOTE_VALUE
  read_attribute("NOTE_VALUE").gsub(/<br(\s*\/)?>/, '')
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T15:14:25.463

```
note.NOTE_VALUE.gsub(/\<br\s*\/?\>/, "") 
```

将删除所有出现`<br />`的：`<br/>`或`<br>`.

在 irb 中试试这个例子：

```
puts "text<br /> some text <br>another text<br/>".gsub(/\<br\s*\/?\>/, "") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:06:34.647

看看[http://www.ruby-doc.org/core-1.9.3/String.html#method-i-gsub](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-gsub)

您可以执行以下操作：

```
parsed_string = exp_from_db[1].gsub(/<br\/>/, '') 
```

这应该用空白字符串替换 br 标记的任何实例，从而将它们删除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T15:09:48.713

如果你使用 Rails，你有两个选择：

*   如果您**确定**您的 DB 值不包含其他 HTML 标记（或者确实包含，但您不在乎它们是否被擦除），您可以简单地执行以下操作：`strip_tags(note.NOTE_VALUE)`，但您必须注意这会擦除任何 HTML字符串中的标签，不仅是出现`<br/>`次数。

*   或者，您可以简单地使用 gsub 来摆脱这些：`note.NOTE_VALUE.gsub(/<br\s*\/?>/, '')`. *请注意，此正则表达式在标签自动关闭之前考虑了可能的空格/换行符/制表符`br`。*

# html - 溢出：隐藏移动 div 里面

> ID：12217921
> 
> 赞同：2
> 
> 时间：2012-08-31T14:58:16.697
> 
> 标签：html, overflow, hidden, move

我遇到了一个我无法解释的事情，我在这里或谷歌都没有找到答案。

我有以下代码：（头部和其他结构在这里被截断了......）

```
<link rel="stylesheet" type="text/css" href="style.css">

<div id="wrapper">
    <div id="ajaxdiv">
        <div id="page0">
            <p>000000000 Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti.</p>
        </div>
    </div>
</div> 
```

这个CSS：

```
#container {
    width: 800px;
    margin: 0 auto;
}
#wrapper {
    overflow: hidden;
}

#ajaxdiv {
    background-color: #e3e3e3;
    height: 500px;
    width: 800px;
    position: relative;
} 
```

现在的问题是，通过“溢出：隐藏”行 在我的包装器里面的 div，即 ajaxdiv 被移位。它向下移动了大约 10-20 像素，我不知道为什么会这样。

有人有解释吗？

# objective-c - 在 iOS 上更改时间格式和时区？

> ID：12217925
> 
> 赞同：0
> 
> 时间：2012-08-31T14:58:43.913
> 
> 标签：objective-c, ios, timezone

我有一个当前从服务器解析数据的应用程序。在数据中，有各种事件的各种日期。问题是应用程序将是国际化的，所以我希望当日期通过 xml 文件从服务器下载到手机时位于正确的区域。

我拥有的所有日期都在 GMT+2 中。我的日期格式是（示例）：`21:45 31-08-2012 GMT+2`

如果用户的手机处于不同的时区，例如 GMT+4 ，是否有可能自动更改时间以便用户可以看到正确的时间？这会如何以编程方式看待？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:12:48.647

一种常见的做法是使用 UNIX EPOCH（没有时区信息）从/向您的客户端传送信息。然后可以在使用特定语言环境显示日期时完成转换：

```
[NSDate dateWithTimeIntervalSince1970:ephochValue]; 
```

# node.js - Mongoose 查询嵌入文档

> ID：12217930
> 
> 赞同：3
> 
> 时间：2012-08-31T14:58:53.310
> 
> 标签：node.js, mongodb, mongoose

我用 Mongoose 定义了以下模式：

```
var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var ObjectId = Schema.Types.ObjectId;

var New = new Schema({
    _id: ObjectId,
    lang: String,
    formatted: Boolean,
    downloaded: Date,
    content: {
        title: String,
        link: String,
        description: String,
        meta: String,
        author: String
    }
});

module.exports = New; 
```

我正在尝试执行以下查询：

```
NewsModel.find({'lang':'en', 'content.link':'test'}).exec(callback); 
```

查询没有响应并且它永远不会进入回调函数。这很奇怪，因为这种类型的查询（搜索两个字符串字段）在我定义的另一个模式中工作得很好，但在这个模式中不行。另一种Schema更简单，没有任何嵌入文档。

奇怪的是，以下工作：

```
NewsModel.find({'lang':'en', 'formatted':true}).exec(callback); 
```

是否有任何架构错误？知道我做错了什么吗？

非常感谢你，

路易斯·卡帕。

* * *

**[更新]**

我试过你的建议，但没有办法。我认为只有两种选择：

**1.**我贴的Schema有问题。

**2.** Mongoose 在查询嵌入复杂参数的文档时遇到问题，例如另一个文档。

我使用过 MongoDB shell、MongoDB Java Driver 和 Spring MongoDB Data，这是我第一次遇到这种奇怪的行为。

我测试过的查询是：

```
NewsModel.find({'lang':'en', 'content.link':'test'}).exec(callback);
NewsModel.find({'lang':'en'}).where('content.link').equals('test').exec(callback);
NewsModel.find({'content.link':'test'}).where('lang').equals('en').exec(callback);
NewsModel.find({'content.link':'test'}).exec(callback); //  That demonstrates that Mongoose has problems with subelements.
NewsModel.find().where('content.link').equals('test').exec(callback); // This one too. 
```

还有一个与 MongoDB shell 完美配合的示例：

```
db.news.find({ 'content.link': /test/, lang: 'en' }) 
```

我担心 Mongoose 不会返回零结果的空响应。相反，它通过等待和等待响应来保持应用程序处于待机状态，并且**永远不会进入**回调函数。

有任何想法吗？你经历过类似的事情吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T11:37:29.197

**解决**

这是 Mongoose 的查询性能错误。我有一个包含大约 100K 文档的测试集合，可以对这些文档执行查询，而且我还没有使用“lang”和“content.link”定义复合索引。查询延迟太多，Mongoose 或 MongoDB 没有发出任何超时警告或错误消息。定义复合索引后，查询工作正常但是......

1.  查询工作正常，在 MongoDB shell 中执行它们。我不知道为什么 Mongoose 这么慢。也许涉及的序列化-反序列化-验证过程会产生延迟。

2.  即使没有定义任何索引，我也无法相信这个简单的查询在一个只有 100K 文档的简单测试集合中表现如此糟糕。MongoDB 本身会消耗大量资源来快速处理查询和响应。老实说，我对 MongoDB - Mongoose 的期望更高。

我的建议/建议：

注意索引配置。

如果您想快速搜索，请查看任何 Node.js Apache Solr 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:12:50.907

在第一个查询中，链接属性不在文档的“根”，您要搜索“content.link”而不是“链接”（我不知道当前的猫鼬版本是否支持“. “在嵌入的文档中查找某些内容）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:18:55.627

你不想

```
NewsModel.find({'lang':'en', 'content.link':'test'}).exec(callback); 
```

查询您的嵌入式文档？

看到这个答案：

[通过 Mongoose、Node.js、MongodDB 中的特定属性查找嵌入式文档](https://stackoverflow.com/questions/5772982/finding-an-embedded-document-by-a-specific-property-in-mongoose-node-js-mongod)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T16:22:39.563

```
NewsModel.find({'lang':'en', 'content.link':'test'}).exec(callback); 
```

可能正在尝试查找名称为“content.link”而不是“内容”的字段，请尝试

```
NewModel.where('lang').equals('en')  
        .where('content').link.equals('test') 
        .exec(callback) 
```

# javascript - ES5“严格”和 arguments.callee

> ID：12217933
> 
> 赞同：7
> 
> 时间：2012-08-31T14:59:06.993
> 
> 标签：javascript, ecmascript-5

> **可能重复：**
> [为什么在 JavaScript 中不推荐使用 arguments.callee.caller 属性？](https://stackoverflow.com/questions/103598/why-was-the-arguments-callee-caller-property-deprecated-in-javascript)

在 ES5 严格模式下（即`"use strict"`）`arguments.callee`，引用当前函数的变量不再可用。

对于递归函数，使用函数自己的名称显然是明智的。但是，有时我可能想使用`arguments.callee`(ie `.length`, `.prototype`) 的属性而不必使用当前函数的名称。

谁能解释通过删除它（据称）解决了什么明显的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T15:15:12.253

从[这里](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/Strict_mode?redirectlocale=en-US&redirectslug=JavaScript/Strict_mode)。

> arguments.callee 极大地阻碍了像内联函数这样的优化，因为如果访问 arguments.callee，必须能够提供对未内联函数的引用。

# winforms - 从基本的“已发布”visual studio winforms 应用程序部署时文件存储在哪里？

> ID：12217936
> 
> 赞同：1
> 
> 时间：2012-08-31T14:59:12.867
> 
> 标签：winforms, visual-studio-2010, publish

我在 Visual Studio 中创建了一个基本的 CRUD Winforms 应用程序，并使用 Build -> Publish Data 生成的 .exe 将其部署到另一台 PC。我的应用程序解决方案中的数据库和任何其他文件将存储在目标计算机上的什么位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T13:13:16.567

您所描述的是“一键发布”。

当您通过“一键式”运行应用程序时，它实际上是从临时文件夹（通常在 C:\Users\?\AppData 中）运行的，您可以通过查看任务管理器（在属性下）来判断这一点。

这样当应用程序更新时，新的安装文件会从一个全新的位置运行，这使得应用程序看起来好像是从服务器上重新运行的（实际上并非如此，它只是在下载客户端文件）。

数据库文件不同。如果您希望用户拥有自己的本地客户端数据库，那么在 Visual Studio 的解决方案文件中引用该数据库将确保一键复制该数据库。**但是**，由于我在第一段中解释的内容 - 每次应用程序更新时，都会复制一个新数据库，并且在上次部署中创建/更新/删除的任何数据库记录都将丢失。

一种更常见的方法是通过“一键式”部署客户端文件，并将数据库托管在服务器上，客户端通过 App.config 中提供的连接字符串进行连接。因此，您只需维护一个数据库，任何客户端更新都不会影响数据库版本控制。

# jquery - 带有轮播的下拉菜单

> ID：12217937
> 
> 赞同：0
> 
> 时间：2012-08-31T14:59:15.497
> 
> 标签：jquery, css, drop-down-menu, overflow, carousel

所以我用jQuery写了一个轮播，但我想在轮播中有下拉菜单。问题是我正在使用一个容器来保存溢出设置为隐藏的旋转木马。这可以防止下拉菜单显示。有任何想法吗？

这是[一个链接](http://www.fox.temple.edu/carousel/)，您可以在其中看到我在说什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:17:49.823

溢出：隐藏不能被覆盖。您可以尝试将按钮包装在具有溢出：隐藏和外部子列表的父级中，但是然后将按钮与其子菜单对齐将成为问题。在这种情况下，Javascript 可以提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:48:36.223

而不是使用`overflow:hidden`，您应该使用新的“micro clearfix”。

去这里： http: [//nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)

在您的标记中，只需在您的容器上添加类“cf”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:53:43.033

好吧，我通过包装溢出的容器来修复它：隐藏在另一个具有固定高度的 div 中。

# jquery - 无法使用 jquery 显示表单

> ID：12217939
> 
> 赞同：0
> 
> 时间：2012-08-31T14:59:24.297
> 
> 标签：jquery, forms

我是 jquery 的新手，我知道我的问题很简单。我想显示一个表格。这是我的jQuery函数：

```
function display_form(s_date)
  {    
        $('#addEvent').show();    
  } 
```

这是它的名称：

```
 $(document).ready(function() {
       $('#calendar').fullCalendar({ 

        dayClick: function(date, allDay, jsEvent, view)
            {   
                date_format = $.fullCalendar.formatDate(date,"yyyy-MM-dd HH:mm:ss");
                    display_form(date_format);
                    return false;
                 },
        events: 'https://www.google.com/calendar/feeds/myLogin%40gmail.com/public/basic'

    });
}); 
```

它不起作用。当我点击一天时，什么也没有发生。[我在http://jsfiddle.net/PytEU/](http://jsfiddle.net/PytEU/)上尝试了代码（直接 display_form 没有调用）并且它有效。也许有人有答案？谢谢您的帮助

这是我的表格：

```
<div>
<form id="addEvent" action="" method="post" >
 // my form
</form>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:15:09.443

在你的 css 文件中

```
#formHolder {
   display: none;
} 
```

将持有表单的 div 设置为具有上面的 id ...

```
<div id="formHolder">
    <form id="addEvent" action="" method="post" >
         // my form
     </form>
</div> 
```

用于显示表单的 jquery 应该类似于（其中 .clickme 是可点击元素的类，例如链接等）

```
$('.clickMe').click(function(){
    $('#formHolder).show('fast');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T13:15:43.230

我将表单放在与 jquery 函数相同的文件中，并且它可以工作。我不知道这是否是最好的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T16:11:29.810

jsFiddle 上的代码：http: [//jsfiddle.net/kam2001/hNC66/](http://jsfiddle.net/kam2001/hNC66/)

```
$(document).ready(function(){
$("#addEvent").show('slow')
});      

$(document).ready(function() {
 $('#calendar').fullCalendar({ 

  dayClick: function(date, allDay, jsEvent, view)
      {   
      date_format = $.fullCalendar.formatDate(date,"yyyy-MM-dd HH:mm:ss");
      display_form(date_format);
      return false;
      },
  events: 'https://www.google.com/calendar/feeds/myLogin%40gmail.com/public/basic'

});
}); 
```

# html - 如何在css3中将箭头图像添加到我的导航栏

> ID：12217940
> 
> 赞同：0
> 
> 时间：2012-08-31T14:59:24.280
> 
> 标签：html, css, html-lists

如何在导航栏中添加向下箭头符号图像以指示子菜单打开`

```
<ul class="navigation">
    <li> 
    <a href="#"> parent </a> 
            <ul>  
            <li> <a href="#"> child 1 </a></li>
            <li> <a href="#"> chil2 </a></li>
            <li> <a href="#"> child3 </a></li>
            <li> <a href="#"> child4</a></li>
            <li> <a href="#"> child5</a></li>
            <li> <a href="#"> child6 </a></li>
            <li> <a href="#"> child7 </a></li>
            </ul>
     </li>` 
```

我的列表是这样制作的，我希望父母用向下箭头图像指示它下面有子列表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:18:55.960

给`li`有一个子菜单的类。像这样 ：

**HTML：**

```
 <ul class="navigation">
        <li class="sub-menu"> 
        <a href="#"> parent </a> 
                <ul>  
                <li> <a href="#"> child 1 </a></li>
                <li> <a href="#"> chil2 </a></li>
                <li> <a href="#"> child3 </a></li>
                <li> <a href="#"> child4</a></li>
                <li> <a href="#"> child5</a></li>
                <li> <a href="#"> child6 </a></li>
                <li> <a href="#"> child7 </a></li>
                </ul>
         </li> 
```

**CSS：**

```
.sub-menu
{
list-style-image:url('sqpurple.gif');
} 
```

[**演示**](http://jsfiddle.net/kuheb/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:07:14.340

无法对您的问题发表评论，因此我将其发布为答案。

网上有很多 CSS 菜单代码。一个简单的谷歌搜索会给你很多结果。如果您无法使用 css 添加图像并且您没有提供任何示例代码来显示您想要的内容，那么我建议您使用类似[http://cssmenumaker.com/的内容](http://cssmenumaker.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:13:59.820

当你想要一个箭头时，想象一个`div`有一些边框宽度的箭头。现在，如果将高度和宽度减小为 0，则仅保留边框。如果它们是不同的颜色，请考虑边界的交叉点，因为没有宽度或高度，它们将被缩小为三角形。所以像：

```
<!DOCTYPE html>
<html>  
<head>
<style>
div { width: 0px; height: 0px; border-left: 5px solid black; border-top: 5px solid transparent; border-right: 5px solid transparent; border-bottom: 5px solid transparent; }
</style>
</head>
<body>
<div></div>
</body>
</html> 
```

# asp.net-mvc - 我应该将 ASP.NET MVC 引用为 NuGet 包吗？

> ID：12217948
> 
> 赞同：4
> 
> 时间：2012-08-31T14:59:43.857
> 
> 标签：asp.net-mvc, asp.net-mvc-4, nuget

我有一个过去从 2.0 升级到 3.0 的 ASP.NET MVC 应用程序，现在我想将它升级到 4.0。

我尝试在 VS2012 中创建一个新的 ASP.NET MVC 4 项目，似乎 ASP.NET MVC 本身现在是一个 NuGet 包。

我应该像在新项目模板中那样以 NuGet 包的形式引用它，还是只像 2.0 和 3.0 之前的工具更新（单独的程序集）那样引用它？

我的服务器安装了 ASP.NET MVC 4，因此在 /Bin 中安装 MVC dll 似乎是在浪费空间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-31T15:01:02.173

`NuGet`现在是要走的路。如果您仍在手动处理程序集，我担心您做错了。

您绝对应该通过`NuGet`软件包安装它。当出现新的更新时，这将使您不会头疼。NuGet 知道如何正确管理包依赖项，也就是说，它还会更新您在项目中安装的所有其他包，以使其与最新的`ASP.NET MVC`. 在这种特定情况下，事情真的在向好的方向发展！:)

# java - 从 Java 中的父类复制字段

> ID：12217952
> 
> 赞同：18
> 
> 时间：2012-08-31T14:59:57.867
> 
> 标签：java, inheritance

我有一个关于 Java 类字段的问题。

我有两个 Java 类：Parent 和 Child

```
class Parent{
    private int a;
    private boolean b;
    private long c;

    // Setters and Getters
    .....
}

class Child extends Parent {
    private int d;
    private float e;

    // Setters and Getters
    .....
} 
```

现在我有一个`Parent`类的实例。有什么方法可以创建`Child`类的实例并复制父类的所有字段，而无需一一调用setter？

我不想这样做：

```
 Child child = new Child();
   child.setA(parent.getA());
   child.setB(parent.getB());
   ...... 
```

此外，`Parent`没有自定义构造函数，我无法在其上添加构造函数。

请给你意见。

非常感谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-31T15:10:17.693

您是否尝试过使用 apache lib？

```
BeanUtils.copyProperties(child, parent) 
```

[http://commons.apache.org/beanutils/apidocs/org/apache/commons/beanutils/BeanUtils.html](http://commons.apache.org/beanutils/apidocs/org/apache/commons/beanutils/BeanUtils.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-03-25T14:18:34.300

你可以使用反射，我会这样做并且对我来说很好：

```
 public Child(Parent parent){
    for (Method getMethod : parent.getClass().getMethods()) {
        if (getMethod.getName().startsWith("get")) {
            try {
                Method setMethod = this.getClass().getMethod(getMethod.getName().replace("get", "set"), getMethod.getReturnType());
                setMethod.invoke(this, getMethod.invoke(parent, (Object[]) null));

            } catch (NoSuchMethodException | SecurityException | IllegalAccessException | IllegalArgumentException | InvocationTargetException ex) {
                //not found set
            }
        }
    }
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:05:24.103

你试过做这个适当的反思吗？从技术上讲，您一一调用设置器，但您不需要知道它们的所有名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T15:03:46.117

您可以将您的字段设置`protected`为私有字段，并直接在子类上访问它们。这有帮助吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-31T15:05:07.083

您可以创建一个`Child`接受 Parent 的构造函数。但是在那里，您必须一一设置所有值（但您可以直接访问子属性，无需设置）。

有一种反射的解决方法，但它只会增加复杂性。你不希望它只是为了节省一些打字。

# variables - 变量 cfform 值 - 嵌套井号

> ID：12217953
> 
> 赞同：4
> 
> 时间：2012-08-31T14:59:59.427
> 
> 标签：variables, loops, coldfusion, nested

我遇到了问题。我正在使用 cfoutput 在表单中运行查询结果。有一些动态命名的cfselect，即entry_1、entry_2 等。然后将它们与url 中的记录计数一起传递到actionpage，我想将它们插入到带有cfloop 的数据库中。

```
<cfloop from="1" to="#url.Count#" index="i">  
<cfquery name="id_#i#" datasource="xxx">Insert Into table1(entry_level) Values(#form.entry_#i##)</cfquery>  
</cfloop> 
```

而且每次都会抛出错误。我试过使用数组格式，但我仍然无法让它工作。请帮忙！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-31T15:09:26.760

您不能以这种方式构造动态结构选择器。您可以执行以下操作来获得相同的结果。

因此，使用以下数据：

```
<cfset url.count = 3>
<cfset form.entry_1 = 1>
<cfset form.entry_2 = 2>
<cfset form.entry_3 = 3> 
```

像这样的东西会起作用 -

```
<cfloop from="1" to="#url.Count#" index="i">  
  <cfquery name="id_#i#" datasource="xxx">
    Insert Into table1(entry_level) Values(#form['entry_' & i]#)
  </cfquery>  
</cfloop> 
```

ColdFusion 基本上为您提供了两种访问结构值的方法，或者通过 . 符号或通过括号。如果您尝试通过动态键访问结构，则必须使用方括号。

顺便说一句，稍微好一点的是：

```
 <cfloop from="1" to="#url.Count#" index="i">  
      <cfquery name="id_#i#" datasource="xxx">
        Insert Into table1(entry_level) Values(<cfqueryparam value="#form['entry_' & i]#">)
      </cfquery>  
    </cfloop> 
```

cfQueryParam 自动对条目进行转义，因此您不必担心 SQL 注入攻击。它还可以使查询稍微更有效率。

# java - rtsp客户端不响应服务器

> ID：12217955
> 
> 赞同：0
> 
> 时间：2012-08-31T15:00:00.783
> 
> 标签：java, sockets, rtsp

我正在编写一个 RTSP 服务器。当我等待来自客户端的标头时，我的服务器收到：

```
OPTIONS rtsp://192.168.1.147:55555 RTSP/1.0
CSeq: 2
User-Agent: LibVLC/2.0.1 (LIVE555 Streaming Media v2011.12.23) 
```

readLine() 在这个地方返回 null。然后我发送：

```
bw.write("RTSP/1.0 200 OK" + CRLF);
bw.write("Supported: play.basic, con.persistent");
bw.write("CSeq: " + RTSPSeqNb + CRLF);
bw.write("Session: " + RTSP_ID + CRLF);
bw.write("Public: SETUP, PLAY, TEARDOWN" + CRLF+CRLF);
bw.flush(); 
```

where CRLF = "\r\n" 但是没有任何响应。我的问题：为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:30:04.307

您`CRLF`之前是否忘记附加到第二行`CSeq`？然后可以用[wireshark](http://www.wireshark.org)回答很多网络“为什么”的问题。

# forms - 如果从特定链接导航到，如何使表单自动选择

> ID：12217957
> 
> 赞同：0
> 
> 时间：2012-08-31T15:00:01.993
> 
> 标签：forms, post, hyperlink

对不起。我不确定如何总结我正在寻找的内容，所以我将解释一下情况。

我有一个带有 2 个链接（A 和 B）的页面，它们都采用相同的形式。

什么是最简单的方法：

如果表单是从链接 A 导航到的，则选择此框并将此值放在文本字段中。

如果表单是从链接 B 导航到的，则选择不同的框并在文本字段中输入不同的值。

如果有人能指出我正确的方向，我将不胜感激。

////编辑 - 这是我的代码/////

html页面上的链接：

```
<a href="/donation_form.php" name="A" id="A" target="_blank">
<a href="/donation_form.php" name="B" id="B" target="_blank"> 
```

php表单的代码：

```
<input type="checkbox" name="preferred_referral" value="Preferred" > Preferred <br>             
<input type="checkbox" name="prestige_referral" value="Prestige" > Prestige <br>

<?
$form->addElement('text','amount_fees','Total Amount: $');
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:07:04.577

节拍方法是在您导航到表单页面时传递一个参数，然后对其进行检索和操作。例如，pageA 将指向 form.html?fromPage=A 和 pageB 指向 form.html?fromPage=B 然后根据 fromPage 参数修改表单。例如，这可以在服务器端或使用 JavaScript 的客户端完成。

# python - 如何在 Python Pandas 中用另一个数据框替换和添加数据框元素？

> ID：12217960
> 
> 赞同：5
> 
> 时间：2012-08-31T15:00:12.083
> 
> 标签：python, pandas

假设我有两个数据框 'df_a' & 'df_b' ，它们都具有相同的索引结构和列，但一些内部数据元素是不同的：

```
>>> df_a
           sales cogs
STK_ID QT           
000876 1   100  100
       2   100  100
       3   100  100
       4   100  100
       5   100  100
       6   100  100
       7   100  100

>>> df_b
           sales cogs
STK_ID QT           
000876 5    50   50
       6    50   50
       7    50   50
       8    50   50
       9    50   50
       10   50   50 
```

现在我想用具有相同（索引，列）坐标的 df_b 元素替换 df_a 的元素，并附加 df_b 的（索引，列）坐标超出 df_a 范围的元素。就像将补丁 'df_b' 添加到 'df_a' ：

```
>>> df_c = patch(df_a,df_b)
           sales cogs
STK_ID QT           
000876 1   100  100
       2   100  100
       3   100  100
       4   100  100
       5    50   50
       6    50   50
       7    50   50
       8    50   50
       9    50   50
       10   50   50 
```

如何编写'patch(df_a,df_b)'函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:16:22.313

试试这个：

```
df_c = df_a.reindex(df_a.index | df_b.index)
df_c.ix[df_b.index] = df_b 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T19:33:32.670

要使用来自另一个数据帧的值（甚至是整行）填补一个数据帧中的空白，请查看[df.combine_first()](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.combine_first.html)内置方法。

```
In [34]: df_b.combine_first(df_a)
Out[34]: 
           sales  cogs
STK_ID QT             
000876 1     100   100
       2     100   100
       3     100   100
       4     100   100
       5      50    50
       6      50    50
       7      50    50
       8      50    50
       9      50    50
       10     50    50 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-31T15:37:37.770

类似于 BrenBarn 的答案，但更灵活：

```
# reindex both to union of indices
df_ar = df_a.reindex(df_a.index | df_b.index)
df_br = df_b.reindex(df_a.index | df_b.index)

# replacement criteria can be put in this lambda function
combiner = lambda: x, y: np.where(y < x, y, x)
df_c = df_ar.combine(df.br, combiner) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-17T03:08:48.483

我在同一个问题上苦苦挣扎，之前答案中的代码在我的数据框中不起作用。他们有 2 个索引列，并且重新索引操作会在奇怪的地方产生 NaN 值（如果有人愿意调试它，我会发布数据框内容）。

我找到了一个替代解决方案。我正在恢复这个线程，希望这对其他人有用：

```
# concatenate df_a and df_b
df_c = concat([dfbd,dfplanilhas])

# clears the indexes (turns the index columns into regular dataframe columns)
df_c.reset_index(inplace='True')

# removes duplicates keeping the last occurence (hence updating df_a with values from df_b)
df_c.drop_duplicates(subset=['df_a','df_b'], take_last='True', inplace='True') 
```

不是一个非常优雅的解决方案，但似乎有效。

我希望 df.update 很快得到一个 join='outer' 选项......

# vb.net - 井字游戏中的随机无限循环

> ID：12217964
> 
> 赞同：0
> 
> 时间：2012-08-31T15:00:28.590
> 
> 标签：vb.net

所以我一直在尝试为编程课做一个井字游戏，老师没用。:l

当我运行程序时，10 次中有 8 次；当我玩并让网格几乎充满时，它会冻结。这有点难以解释，我真的很累。我希望有人能帮帮忙。：秒

代码：

```
 Private Sub ChooseBox()
    Dim num As Integer
    Dim Random As New Random
    num = Random.Next(0, 10)

    If Grid_1.Text <> "" And Grid_2.Text <> "" And Grid_3.Text <> "" And Grid_4.Text <> "" And Grid_5.Text <> "" And Grid_6.Text <> "" And Grid_7.Text <> "" And Grid_8.Text <> "" And Grid_9.Text <> "" Then
        gStatus = "Tie"
        Me.Text = "Tic Tac Toe - Nobody won!"
    Else
        If num = 1 And Grid_1.Text = "" Then
            Grid_1.Text = compChar : turnIs = "Player"
        ElseIf num = 2 And Grid_2.Text = "" Then
            Grid_2.Text = compChar : turnIs = "Player"
        ElseIf num = 3 And Grid_3.Text = "" Then
            Grid_3.Text = compChar : turnIs = "Player"
        ElseIf num = 4 And Grid_4.Text = "" Then
            Grid_4.Text = compChar : turnIs = "Player"
        ElseIf num = 5 And Grid_5.Text = "" Then
            Grid_5.Text = compChar : turnIs = "Player"
        ElseIf num = 6 And Grid_6.Text = "" Then
            Grid_6.Text = compChar : turnIs = "Player"
        ElseIf num = 7 And Grid_7.Text = "" Then
            Grid_7.Text = compChar : turnIs = "Player"
        ElseIf num = 8 And Grid_7.Text = "" Then
            Grid_8.Text = compChar : turnIs = "Player"
        ElseIf num = 9 And Grid_9.Text = "" Then
            Grid_9.Text = compChar
        Else : ChooseBox()
        End If
    End If
End Sub

Private Sub CheckResult()

    'First Column is filled
    If Grid_1.Text = compChar And Grid_2.Text = compChar And Grid_3.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_1.Text = playerChar And Grid_2.Text = playerChar And Grid_3.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'Second Column is filled
    If Grid_4.Text = compChar And Grid_5.Text = compChar And Grid_6.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_4.Text = playerChar And Grid_5.Text = playerChar And Grid_6.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'Third Column is filled
    If Grid_7.Text = compChar And Grid_8.Text = compChar And Grid_9.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_7.Text = playerChar And Grid_8.Text = playerChar And Grid_9.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'First Row is filled
    If Grid_1.Text = compChar And Grid_4.Text = compChar And Grid_7.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_1.Text = playerChar And Grid_4.Text = playerChar And Grid_7.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'Second Row is filled
    If Grid_2.Text = compChar And Grid_5.Text = compChar And Grid_8.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_2.Text = playerChar And Grid_5.Text = playerChar And Grid_8.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'Third Row is filled
    If Grid_3.Text = compChar And Grid_6.Text = compChar And Grid_9.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_3.Text = playerChar And Grid_6.Text = playerChar And Grid_9.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'Diagonal Upwards is filled
    If Grid_1.Text = compChar And Grid_5.Text = compChar And Grid_9.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_1.Text = playerChar And Grid_5.Text = playerChar And Grid_9.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If

    'Diagonal Downwards is filled
    If Grid_3.Text = compChar And Grid_5.Text = compChar And Grid_7.Text = compChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Computer Wins!"
    ElseIf Grid_3.Text = playerChar And Grid_5.Text = playerChar And Grid_7.Text = playerChar Then
        gStatus = "Won"
        Me.Text = "Tic Tac Toe - Player Wins!"
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:17:39.253

我看到的三个问题：

```
num = Random.Next(0, 10) 
```

Random.Next 是包含下限和不包含上限的。这意味着计算机可以在此处滚动 0。这不会导致循环，但有点浪费，因为您从不接受条件中的 0。

```
ElseIf num = 9 And Grid_9.Text = "" Then
    Grid_9.Text = compChar 
```

在这里，您的模式不包括将控制权返回给 Player。我希望计算机在这种情况下会转两圈。

```
ElseIf num = 8 And Grid_7.Text = "" Then
    Grid_8.Text = compChar : turnIs = "Player" 
```

现在这是可能的循环问题。请注意，当计算机滚动 8 时，您正在检查网格 7 的内容。因此，如果网格 8 是最后一个空间，您将始终陷入另一个 ChooseBox() 调用。循环永远不会解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:18:24.057

你已经为可能的无限选择情况做好了准备。您最好使用包含每个单元格数量的列表：

```
Dim cells As New List(Of String)()
cells.Add("1")
cells.Add("2")
...
cells.Add("9") 
```

然后，当您用完特定单元格时，将其从列表中删除。

```
ElseIf num = 5 And Grid_5.Text = "" Then
    Grid_5.Text = compChar
    turnIs = "Player"
    cells.RemoveAt(num - 1)  ' Remove the cell at the index in the List
ElseIf num = 6 And Grid_6.Text = "" Then
    ... 
```

这将允许您使用您选择的随机数进行迭代：

```
Dim Random As New Random
num = Random.Next(0, cells.Count - 1)  ' This will only allow choices within range 
```

这样，无论何时`ChooseBox()`调用该方法，您都可以确保随机选择的任何索引都是可用的。这也可能减少对`Text = ""`检查的需求。

*注意：为了可读性，忘记`:`字符允许您在一行中有多行代码也是一个好主意。除非该行是单数指令或条件 then 指令，否则最终只会使代码变得庞大。*

# python - 如何使用 pip 安装/卸载到特定的 python 文件夹？

> ID：12217965
> 
> 赞同：0
> 
> 时间：2012-08-31T15:00:29.413
> 
> 标签：python, pip, directory

我有一个特定的 python2.7 文件夹，我想在其中使用 pip 安装软件包。默认的python安装是python 2.6

我设法用`<python2.7Folder>/pip -t ... numpy`. 问题是它使用默认的 python 2.6 库编译，而不是它不起作用。当我尝试从 python 2.7 运行 numpy 时，我得到了这个：`undefined symbol: _PyUnicodeUCS4_IsWhitespace ... expectable`。

所以我尝试卸载它，但不能这样做，因为它试图从默认的 python 安装中卸载它。

```
File "/usr/local/lib/python2.6/dist-packages/pip-1.1-py2.6.egg/pip/req.py", line 410, in uninstall
    raise UninstallationError("Cannot uninstall requirement %s, not installed" % (self.name,)) 
```

问题是：

*   我怎样才能首先从特定的文件夹中卸载 numpy 包，从特定的 python 路径。
*   如何使用 python 的特定路径重新安装 numpy，这个 itme 包括？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:16:13.197

要在 Python2.7 下安装库，您需要“2.7”版本的 pip。换句话说，pip 必须使用`python2.7`它自己。

您可以使用以下命令检查 pip 使用的是哪个 python 版本：

```
$ head -1 `which pip`
#!/home/lbolla/.virtualenvs/work/bin/python2 
```

无论如何，我强烈建议您使用[virtualenv](http://www.virtualenv.org/en/latest/index.html)，这样您就可以在每次需要时创建一个新的虚拟环境，并且不会用包污染 python 的系统目录。

最后，您应该能够卸载`pip`使用安装的软件包：`pip uninstall <package>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:28:37.227

如果您创建 virtulenv 并在那里做所有事情，那就更好了。

例如，如果你想为 python 2.6 安装 numpy，你应该做这样的事情

* * *

$easy_install-2.6 虚拟环境

$virtualenv-2.6 python26

$source python26/bin/激活

$easy_install numpy 或 $ pip install numpy

* * *

# boost-spirit - boost::spirit::qi 前瞻匹配字符串中的最后一次出现

> ID：12217969
> 
> 赞同：2
> 
> 时间：2012-08-31T15:00:58.100
> 
> 标签：boost-spirit, boost-spirit-qi

是否可以使用 boost::spirit::qi 解析以下内容？

```
 A_B       --> (A, B)
 A_B_C     --> (A_B, C)
 A_B_C_D   --> (A_B_C, D)
 A_B_C_D_E --> (A_B_C_D, E) 
```

我想生成规则，以便我可以匹配字符串中的最后一个 '_' 并在其上拆分字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T12:40:53.633

这看起来像一个奇怪的语法，并且对于专门的功能来说是一个更好的工作（特别是因为源“令牌”在您的示例中实际上非常短）。

但是，事不宜迟，您可以使用 Spirit 执行以下操作：

```
name  = lexeme [ +(graph - '_') ]; // or just char_("ABCDEFG") if it's that simple
entry = lexeme [ raw [ +(name >> '_') ] >> name ]; 
```

再次，在[http://liveworkspace.org/code/15d970571a61dd39faedc8b7231ef67d上查看代码](http://liveworkspace.org/code/15d970571a61dd39faedc8b7231ef67d)

```
// #define BOOST_SPIRIT_DEBUG
#include <boost/fusion/adapted.hpp>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/karma.hpp>
#include <map>

namespace qi    = boost::spirit::qi;
namespace karma = boost::spirit::karma;
namespace phx   = boost::phoenix;

typedef std::map<std::string, std::string> pairs_t;

template <typename It, typename Skipper = qi::space_type>
    struct parser : qi::grammar<It, pairs_t(), Skipper>
{
    parser() : parser::base_type(start)
    {
        using namespace qi;

        name  = lexeme [ +(graph - '_') ]; // or just char_("ABCDEFG") if it's that simple
        entry = lexeme [ raw [ +(name >> '_') ] >> name ];
        start = *entry;
        BOOST_SPIRIT_DEBUG_NODE(name);
        BOOST_SPIRIT_DEBUG_NODE(entry);
        BOOST_SPIRIT_DEBUG_NODE(start);
    }

  private:
    qi::rule<It, std::string()> name;
    qi::rule<It, std::pair<std::string, std::string>(), Skipper> entry;
    qi::rule<It, pairs_t(), Skipper> start;
};

template <typename C, typename Skipper>
    bool doParse(const C& input, const Skipper& skipper)
{
    auto f(std::begin(input)), l(std::end(input));

    parser<decltype(f), Skipper> p;
    pairs_t data;

    try
    {
        bool ok = qi::phrase_parse(f,l,p,skipper,data);
        if (ok)   
        {
            std::cout << "parse success\n";
            std::cout << "data: " << karma::format_delimited(karma::auto_ % ';', ' ', data) << '\n';
        }
        else    std::cerr << "parse failed: '" << std::string(f,l) << "'\n";

        if (f!=l) std::cerr << "trailing unparsed: '" << std::string(f,l) << "'\n";
        return ok;
    } catch(const qi::expectation_failure<decltype(f)>& e)
    {
        std::string frag(e.first, e.last);
        std::cerr << e.what() << "'" << frag << "'\n";
    }

    return false;
}

int main()
{
    const std::string input = "A_B A_B_C A_B_C_D A_B_C_D_E";
    bool ok = doParse(input, qi::blank);

    return ok? 0 : 255;
} 
```

# javascript - 表格上 MVC 中的自定义工具提示 - 每行显示数据

> ID：12217972
> 
> 赞同：0
> 
> 时间：2012-08-31T15:01:09.197
> 
> 标签：javascript, asp.net-mvc, model-view-controller, tooltip

我正在努力获得一个直观的工具提示，以便在我的 MVC 应用程序中按行显示。

```
 @foreach (var item in Model)
{

    int countSDOL = (item.sdolDetails.Count(i => i.userid == item.id));
    int workFlow = (item.workflows.Count(i => i.actionOutstanding == true));     
    @Html.HiddenFor(modelItem => item.id)
    <tr style="@(workFlow > 0 ? "Background-color:#87BEF5" : "")">
    <td>
         @if (workFlow > 0)
            {     

                <button id="quickButton" class="classname" value="@item.id" data-task-id="@item.id">Actions</button>
            }
    </td>
    <td>
             <div class="tooltip">
               @foreach (var role in item.userRoles)
               {
                    <div title="">
                    @Html.DisplayFor(roles => role.role.roleDescription) 
                    </div>
               }                        
          </div>  
     </td>
      <td>
            @Html.DisplayFor(modelItem => item.title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.forename)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.surname)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.employeeNumber)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.sdolInitiation)
        </td>
        <td align="center">
            @if (item.trainingTrackerPassed.Equals(true))
            {
                <img src="../../Content/tick.png" />
            }
            else
            {
                <img src="../../Content/cross.PNG" />
            }
        </td>
        <td align="center">
        @if (item.userValid.Equals(true))
        {
                <img src="../../Content/tick.png" />
        }
        else
        {
                <img src="../../Content/cross.PNG" />
        }

        </td>
        <td align="left">
            @Html.ActionLink("Details", "Details", new { id = item.id }) |
            @Html.ActionLink("Roles", "Index", "Roles", new { id = item.id }, null) |
           @if (countSDOL == 0)
           {
            @Html.ActionLink("SDOL", "Create", new { id = item.id }, null)                                       
           }
           else
           {
            @Html.ActionLink("SDOL", "Sdol", new { id = item.id }, null)   
           }        
        </td>
        <td>
         <a id="download_now">show</a>   
        </td>
    </tr>

} 
```

以上是我的看法。注意其中嵌套的@foreach。这会为表中的每一行显示为该行分配的角色列表。

我真正需要做的是将这个包含角色描述的 div 显示为每行的工具提示。我尝试下载和使用 jquery 工具并设法让它显示工具提示，但它只适用于表格的第一行。随后的每一行都不会显示工具提示。查看他们网站上的示例，只有整个表格的工具提示一个值的示例..有没有人完成我想要实现的目标？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T08:46:43.617

当您将鼠标悬停在该行时，title 属性将向您显示一个工具提示。如果您想要一个更可定制的工具提示，周围有一些 jquery/javascript 工具提示脚本。

[http://jqueryui.com/tooltip/](http://jqueryui.com/tooltip/)

Jquery ui tooltip 是一个非常容易实现的工具提示，并且有很多选项可以自定义行为。

要使用：

1：获取jquery ui和jquery脚本或cdn链接并放入您的页面2：为每个需要工具提示的元素设置标题以及工具提示内容3：使用jquery选择器查找您希望工具提示显示的元素4 ：使用选择器上的工具提示功能

```
$("#IWantAllTitlesInThisIdAsTooltips").tooltip() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-11T19:19:15.377

Html.DisplayFor 不使用@title 参数显示工具提示。而是使用这个（附加信息是工具提示）：

```
 <td>
                    <div id=j>
                        @Html.DisplayFor(modelItem => item.AdditionalInfoShort)
                        </div>

                        <noscript  id=i>@Html.DisplayFor(modelItem => item.AdditionalInfo)</noscript>

                </td> 
```

以及下面的使用JavaScript方法

```
 <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="/resources/demos/style.css">
    <script>
    $(document).tooltip({
        items: "#j",
        content: function() {
            return $(this).closest('td').children("#i").text();
        }
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-02T03:08:35.477

```
 @foreach (var item in Model)
    {
        <tr>
            <td>
                <input type="text" value="@item.ICID" hidden>
                <span title='@item.ICName'>@Html.DisplayFor(modelItem => item.ICName)</span>
            </td>
        </tr>
     } 
```

在 Display 元素周围应用 Span 标签，并将 Tooltip 名称传递给 Span 标签中的 title 属性。

# jquery - jQuery：停止一个函数并再次调用它

> ID：12217985
> 
> 赞同：1
> 
> 时间：2012-08-31T15:02:14.093
> 
> 标签：jquery

我目前正在为 iPad 开发一个小型 webapp。现在我正在使用[touchslider](http://touchslider.com)。对于一个小的“缩放功能”，我使用切换功能来显示和隐藏一些 div。现在我想停止触摸滑块，这样用户就不能滑动幻灯片。但直到用户切换 #zoom1 -按钮，此时滑块应该再次可用。我尝试取消绑定，停止并启动滑块，但似乎我走错了路......

```
$(".touchslider15").touchSlider({
container: this,
duration: 350, 
delay: 3000, 
margin: 0,
mouseTouch: true,
autoplay: false, 
viewport: ".touchslider-viewport15"}); 

$("#zoom1").toggle(function(){
$('#header').hide();
$(".touchslider15").unbind('touchSlider', touchSlider);
},function(){ 
    $('#header').show();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:10:08.183

看起来是这样的：

```
var state=true;

$(".touchslider15").touchSlider({
    container: this,
    duration: 350, 
    delay: 3000, 
    margin: 0,
    mouseTouch: true,
    autoplay: false, 
    viewport: ".touchslider-viewport15"
}); 

$("#zoom1").on('click', function() {
    $(".touchslider15").data("touchslider")[state?'stop':'start']();
    $("#header").toggle(!state);
    state=!state;
}); 
```

**编辑**：不确定它会起作用，但你可以尝试：

```
$("#zoom1").on('click', function() {
    if (state) {
        var elem = $(".touchslider15").clone(false);
        $(".touchslider15").replaceWith(elem);
    }else{
        $(".touchslider15").touchSlider({
            container: this,
            duration: 350, 
            delay: 3000, 
            margin: 0,
            mouseTouch: true,
            autoplay: false, 
            viewport: ".touchslider-viewport15"
        }); 
    }
    $("#header").toggle(!state);
    state=!state;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T08:38:32.080

代替

```
 $("#zoom1").on('click', function() {
    if (state) { 
```

尝试

```
$("#zoom1").one('click', function() {
    if (state) { 
```

# jenkins - 在另一个主的散热器中显示一个 Jenkins 主的构建结果？

> ID：12217991
> 
> 赞同：1
> 
> 时间：2012-08-31T15:02:30.913
> 
> 标签：jenkins

我们有一个构建项目的 Jenkins 主构建服务器。我们有另一个 Jenkins 主构建服务器在大屏幕上显示“散热器”视图。

我们可以在第二个的散热器视图上显示第一个主的构建结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T14:17:30.873

我们也有同样的需求。似乎没有直接执行此操作的 Jenkins 支持或插件。所以我最终创建了一个小的 bash 脚本，它轮询其他 Jenkins 主 API 以反映构建状态。我们将其设置为每 10 分钟触发一次。你需要安装 curl 和 jq 来运行它：

像这样运行它：`./jenkins_monitor.sh https://jenkins.example.com/job/my-job-name/`

```
#!/bin/bash
# Remote Jenkins job monitoring script that polls the API to mirror the job status
# Useful for pulling status of jobs on other Jenkins servers into a Walldisplay

JOB_URL="$1"

if [ "$JOB_URL" == "" ]; then
    echo "Usage: $0 http://{jenkins-server}/job/{job-name}"
    exit
fi

JOB_DATA=`curl --fail --insecure --silent --show-error 2>&1 "${JOB_URL}/lastBuild/api/json"`
JOB_RESULT=`echo $JOB_DATA|jq .result 2>/dev/null`

if [ "$JOB_RESULT" == "" ]; then
    echo "Error when retrying Jenkins job info:"
    echo $JOB_DATA
    exit 1
fi

echo "Job status is: ${JOB_RESULT}"

if [ "$JOB_RESULT" == '"FAILURE"' ]; then
    echo "Remote job failed"
    exit 1
elif [ "$JOB_RESULT" == 'null' ]; then
    echo "Remote job is building"
else
    echo "Job seems to be fine"
fi 
```

# java - 将 Jsoup 与 Java 反射结合使用

> ID：12217994
> 
> 赞同：0
> 
> 时间：2012-08-31T15:02:34.077
> 
> 标签：java, reflection, jsoup

我想动态调用 jsoup 中的方法。这是我的用例，我实际上是在 jsoup 中调用多个 select dom 方法来遍历内部，例如，

```
Document doc = Jsoup.connect("http://test.com").get();
String companyName = doc.select("div[class=\"_name\"]").select("span[class="\_name\"]").text(); 
```

我可以动态实现相同的效果吗？

```
Document doc = Jsoup.connect("http://test.com").get();
String pattern = "select("div[class=\"_name\"]").select("span[class="\_name\"]").text()";
String companyName = doc.pattern; 
```

我知道我们可以使用反射来实现，但不确定如何实现这种行为，因为模式字符串将是动态的并且可能有 n 个 dom 选择器。

让我知道上述动力是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:23:03.673

是的，这是可能的，您所要做的就是重复调用`select()`Document 对象上的方法，直到您枚举了所有选择器，然后调用该`text()`方法。

您甚至可以将所有选择器合二为一，因为`select(div[class=foo]).select(span[class=bar]).text()`相当于`select(div[class=foo] span[class=bar]).text()`可以简化为`select(div.foo span.bar).text()`

因此，也许您甚至可以丢弃整个反射事物并动态创建正确且直接的选择器来满足您的需求。

```
 Document doc = Jsoup.connect("http://test.com").get();
  String companyName = doc.select("div.foo span.bar").text(); 
```

这是使用链接：

```
Document doc = Jsoup.connect("http://test.com").get();
List<String> criterias = Arrays.asList("div.foo", "span.bar");
Document tmpDoc = doc;
for (String criteria: criterias) {
    if (tmpDoc != null)
        tmpDoc = tmpDoc.select(criteria);
}
// now you have traversed the whole criterias just get the text
String companyName = tmpDoc.text(); 
```

否则，这与使用反射相同：

```
Document doc = Jsoup.connect("http://test.com").get();
List<String> criterias = Arrays.asList("div.foo", "span.bar");
Method select = doc.getClass().getMethod("select", String.class);
Document tmpDoc = doc;
for (String criteria: criterias) {
    if (tmpDoc != null)
        tmpDoc = (Document)select.invoke(tmpDoc, new Object[] {criteria});
}
// now you have traversed the whole criterias just get the text
String companyName = tmpDoc.text(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T15:22:51.900

如果您只想支持*n 个 dom 选择器，*那么您实际上不需要反射，因为您可以将它们组合在一个选择器字符串中：

```
Document doc = Jsoup.connect("http://test.com").get();
String pattern = "div[class=\"_name\"] span[class=\"_name\"]"; // Just separate with spaces
String companyName = doc.select(pattern).text(); 
```

# iphone - UIUserInterfaceIdiomPhone 也适用于 iPod touch？

> ID：12217997
> 
> 赞同：3
> 
> 时间：2012-08-31T15:02:50.983
> 
> 标签：iphone, ios, ipad, ipod-touch

对不起，愚蠢的问题，但我在任何地方都没有找到好的答案。

如果我检查 UIUserInterfaceIdiomPhone 我得到 YES iPhone 和 iPod touch？

我是说：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation == UIInterfaceOrientationPortrait);
    }
    return YES;
} 
```

仅对 iPad 返回 YES，对 iPhone 和 iPod 返回纵向？

我开发了一个 iPhone 应用程序，现在我将其更改为通用的。它几乎完成了，我不想改变我所有的“如果”。（我自己没有真正的 iPod touch 来测试它）。

谢谢，马克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T15:07:21.067

是的，iPod touch 在这方面被视为 iPhone。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-31T15:18:05.650

该宏主要用于区分 iPad 和 iPhone 或 iPod 的屏幕大小。
由于 iPhone 和 iPod 具有相同的屏幕尺寸，因此都属于电话类别。iPhone 和 iPod`UIUserInterfaceIdiomPhone`也是如此，iPad 也是如此。 有关更多信息，您可以阅读[苹果文档](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIDevice_Class/Reference/UIDevice.html#//apple_ref/doc/c_ref/UIUserInterfaceIdiomPhone)。`YES`
`NO`