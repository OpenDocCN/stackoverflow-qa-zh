# StackOverflow 问答 1008000-1008999

# c# - 使用 C# 和扩展方法从数组中获取从 i 到 j 的一系列元素

> ID：1008000
> 
> 赞同：0
> 
> 时间：2009-06-17T15:59:33.327
> 
> 标签：c#, .net, linq, arrays, extension-methods

我有一个`Array<string>`. 我必须将所有元素从`i`to `j`。如何使用扩展方法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T16:02:09.287

试试下面的。

```
public static IEnumerable<T> GetRange<T>(this IEnumerable<T> enumerable, int start, int end) {
  return enumerable.Skip(start).Take(end-start); 
} 
```

然后你可以做

```
Array<string> arr = GetSomeArray();
var res = arr.GetRange(i,j); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T16:02:27.117

```
var result = myStringArray.Skip(i).Take(j-i); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T16:03:55.697

您可以只使用[ArraySegment<T>](http://msdn.microsoft.com/en-us/library/1hsbd92d.aspx)。

如果您需要将其作为 . 返回`IEnumerable<T>`，则已列出的使用 Skip/Take 的选项将非常有效。

# trending - 当 x 轴使用日期时计算趋势线

> ID：1008003
> 
> 赞同：2
> 
> 时间：2009-06-17T16:00:16.650
> 
> 标签：trending

关于在散点图上计算趋势线的帖子（[如何计算图表的趋势线？](https://stackoverflow.com/questions/43224/how-do-i-calculate-a-trendline-for-a-graph)）非常有帮助，但我很好奇如何在 x 轴为 a 的图表上找到趋势线DateTime 字段，而不是整数。例如，考虑随时间绘制邮件列表订阅者数量图表的情况：

1 月 1 日：100 名订阅者
1 月 2 日：105 名订阅者
1 月 5 日：120 名订阅者
1 月 10 日：117 名订阅者
等...

我遇到的问题是找出其中的“运行”（delta x）部分......因为间隔不会均匀分布，我们不能只假设每次测量之间只有一个时间单位. 我有一种预感，我必须计算出某种规模，但我被困在那里。

谁能解释当 x 轴是 DateTime 字段时如何计算趋势线？（如果您发布代码示例，C#、VB.NET 或 Java 将不胜感激！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T16:02:31.220

您始终可以将日期转换为整数

网络给出了这个例子：

```
DateTime given = new DateTime(2008, 7, 31, 10, 0, 0);
TimeSpan t = given.Subtract(new DateTime(1970, 1, 1, 0, 0, 0, 0));
long unixTime = (long) t.TotalSeconds; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T16:03:42.687

你必须做一种线性插值。您需要将日期和时间转换为线性比例。好消息是你可以选择这个规模。因此，请计算自您的情节开始以来已经过去了多少分钟、几秒钟或几小时。然后，您可以将其用作“运行”部分。

在您的示例中，我们可以休息几天：

1 月 1 日：0 天，100 位订阅者 1 月 2 日：1 天，105 位订阅者 1 月 5 日：4 天，120 位订阅者 1 月 10 日：9 天，117 位订阅者

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:10:05.633

即使您的样本间隔不均匀，您的趋势线仍然可以有一个恒定的“运行”。

例如，您可以选择 1 周的间隔。在这种情况下，取 1 月 1、2 和 5 日的平均订阅人数，并在 1 月 7 日绘制一个点。接下来取 1 月 10 日和 13 日的平均值，并在 1 月 14 日绘制一个点。等等。

如果您有大量历史数据，请使用 1 个月的间隔，或者每季度更适合您的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T16:22:31.483

指定一个起始日期并将其视为 x = 1。如果您想更具体，请选择小时或 8 小时周期。

```
The first day:
jan 1, 2006 -> x = 1
45 days later
February 13th?? -> x = 45
2 years later:
jan 1, 2008 -> x = 730 
```

# sorting - 亚音速寻呼顺序问题

> ID：1008014
> 
> 赞同：0
> 
> 时间：2009-06-17T16:01:34.200
> 
> 标签：sorting, subsonic, custompaging

我有一个数据网格，我在 Subsonic 框架中 使用自定义分页选项（参考： [http ://subsonicproject.com/querying/webcast-using-paging/）。](http://subsonicproject.com/querying/webcast-using-paging/)

我还有一个按状态过滤数据的下拉菜单。这通过 addwhere 调用添加到查询中。

数据按州 ASC 排序，然后按城市 ASC 排序。

当没有选择任何状态时，数据似乎排序良好，因此没有将 addwhere 添加到子句中。但是，如果您选择的状态有足够的记录导致分页启动，那么某些记录会乱序显示。我还注意到，当前页面上的最后几条记录似乎总是显示在网格中间的某个位置。

loadgrid 的代码片段：

```
 Dim qry As New SubSonic.Query( {myTableSchema} )
    If ddlStates.SelectedValue.Trim.ToLower <> "all states" Then
        qry.AddWhere("state", ddlStates.SelectedValue.Trim)
    End If
    qry.ORDER_BY("state", "ASC").ORDER_BY("city", "ASC")
    qry.PageSize = ddlDisplay.SelectedValue
    qry.PageIndex = pageNumber
    gvOrganizers.DataSource = qry.ExecuteDataSet
    gvOrganizers.DataBind() 
```

The problem doesn't seem to appear when a state is selected and there is only 1 page of data. 默认 ddlDisplay 设置为每页 100 条记录，但即使选择 50 或 25 也会出现错误。

使用亚音速 2.1.0.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-15T00:24:26.347

使用**qry.OrderAsc(New String(){"state asc, city asc"})**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-05T15:30:15.717

`PAGING_VIEW_SQL`模板中似乎有一个错误（`SqlProvider.cs`第 1702 行）。这是片段：

```
...
SELECT _indexID = IDENTITY(int, 1, 1), {1} INTO #temp FROM {0} WHERE 1 = 0
INSERT INTO #temp ({1}) SELECT {1} FROM {0} {2} {3}

SELECT * FROM #temp
WHERE _indexID BETWEEN ((@Page - 1) * @PageSize + 1) AND (@Page * @PageSize)

--clean up  
DROP TABLE #temp", where {3} represents serialized order-by-collection. 
```

您可以看到，首先排序的数据被排序并插入到临时表中，但随后检索到所需的页面而无需再次排序。最终导致为请求的页面获取正确的数据，但没有正确排序。

第二个`select`需要修改，以便从临时表中获取数据时数据的顺序正确。像这样：

```
SELECT * FROM #temp    
WHERE _indexID BETWEEN ((@Page - 1) * @PageSize + 1) AND (@Page * @PageSize) {3} 
```

然后当然是重新编译代码然后你就走了:-)

# c++ - C++ 单例设计模式

> ID：1008019
> 
> 赞同：838
> 
> 时间：2009-06-17T16:02:22.563
> 
> 标签：c++, design-patterns, singleton

最近，我遇到了 C++ 单例设计模式的实现/实现。它看起来像这样（我从现实生活的例子中采用了它）：

```
// a lot of methods are omitted here
class Singleton
{
   public:
       static Singleton* getInstance( );
       ~Singleton( );
   private:
       Singleton( );
       static Singleton* instance;
}; 
```

从这个声明中，我可以推断出实例字段是在堆上启动的。这意味着有内存分配。对我来说完全不清楚的是何时释放内存？还是有错误和内存泄漏？执行起来好像有问题。

我的主要问题是，如何以正确的方式实施它？

* * *

## 回答 #1

> 赞同：1283
> 
> 时间：2009-06-17T16:49:58.803

在 2008 年，我提供了 Singleton 设计模式的 C++98 实现，它是惰性求值、保证破坏、非技术线程安全的：
[谁能给我提供一个 C++ 中的 Singleton 示例？](https://stackoverflow.com/questions/270947/can-any-one-provide-me-a-sample-of-singleton-in-c/271104#271104)

这是 Singleton 设计模式的更新 C++11 实现，它是惰性求值、正确销毁和[线程安全的](https://stackoverflow.com/a/449823/52074)。

```
class S
{
    public:
        static S& getInstance()
        {
            static S    instance; // Guaranteed to be destroyed.
                                  // Instantiated on first use.
            return instance;
        }
    private:
        S() {}                    // Constructor? (the {} brackets) are needed here.

        // C++ 03
        // ========
        // Don't forget to declare these two. You want to make sure they
        // are inaccessible(especially from outside), otherwise, you may accidentally get copies of
        // your singleton appearing.
        S(S const&);              // Don't Implement
        void operator=(S const&); // Don't implement

        // C++ 11
        // =======
        // We can use the better technique of deleting the methods
        // we don't want.
    public:
        S(S const&)               = delete;
        void operator=(S const&)  = delete;

        // Note: Scott Meyers mentions in his Effective Modern
        //       C++ book, that deleted functions should generally
        //       be public as it results in better error messages
        //       due to the compilers behavior to check accessibility
        //       before deleted status
}; 
```

关于何时使用单例，请参阅这篇文章：（不经常）
[单例：应该如何使用](https://stackoverflow.com/questions/86582/singleton-how-should-it-be-used)

请参阅这两篇关于初始化顺序以及如何应对的文章：
[静态变量初始化顺序](https://stackoverflow.com/questions/211237/c-static-variables-initialisation-order/211307#211307)
[查找 C++ 静态初始化顺序问题](https://stackoverflow.com/questions/335369/finding-c-static-initialization-order-problems/335746#335746)

请参阅描述生命周期的这篇文章：
[C++ 函数中静态变量的生命周期是多少？](https://stackoverflow.com/questions/246564/what-is-the-lifetime-of-a-static-variable-in-a-c-function)

请参阅这篇讨论单例的一些线程含义的文章：
[单例实例声明为 GetInstance 方法的静态变量，它是线程安全的吗？](https://stackoverflow.com/questions/449436/singleton-instance-declared-as-static-variable-of-getinstance-method/449823#449823)

请参阅这篇解释为什么双重检查锁定在 C++ 上不起作用的文章：
[C++ 程序员应该了解哪些常见的未定义行为？](https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviour-that-c-programmer-should-know-about/367690#367690)
[Dobbs 博士：C++ 和双重检查锁定的危险：第一部分](http://www.drdobbs.com/cpp/c-and-the-perils-of-double-checked-locki/184405726)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-06-17T16:06:12.123

作为一个单例，你通常不希望它被破坏。

当程序终止时，它将被拆除并释放，这是单例的正常行为。如果您希望能够显式清理它，可以很容易地向类添加一个静态方法，允许您将其恢复到干净状态，并在下次使用时重新分配它，但这超出了 a 的范围“经典”单身人士。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2009-06-17T16:10:55.573

您可以避免内存分配。有很多变体，在多线程环境中都有问题。

我更喜欢这种实现方式（实际上，我更喜欢这种说法并不正确，因为我尽可能避免使用单例）：

```
class Singleton
{
private:
   Singleton();

public:
   static Singleton& instance()
   {
      static Singleton INSTANCE;
      return INSTANCE;
   }
}; 
```

它没有动态内存分配。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2016-10-31T06:56:15.847

[@Loki Astari 的回答](https://stackoverflow.com/a/1008289/3807729)非常好。

但是，有时对于多个静态对象，您需要能够保证在使用*单例*的所有静态对象不再需要它之前，不会破坏*单例。*

在这种情况下，即使在程序结束时调用了静态析构函数，`std::shared_ptr`也可以用来为所有用户保持*单例*活动：

```
class Singleton
{
public:
    Singleton(Singleton const&) = delete;
    Singleton& operator=(Singleton const&) = delete;

    static std::shared_ptr<Singleton> instance()
    {
        static std::shared_ptr<Singleton> s{new Singleton};
        return s;
    }

private:
    Singleton() {}
}; 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-06-17T16:15:51.093

另一种非分配选择：`C`根据需要创建一个单例，例如 class ：

```
singleton<C>() 
```

使用

```
template <class X>
X& singleton()
{
    static X x;
    return x;
} 
```

这和 Cătălin 的答案在当前 C++ 中都不是自动线程安全的，但会在 C++0x 中。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-02-12T14:02:46.330

我没有在答案中找到 CRTP 实现，所以这里是：

```
template<typename HeirT>
class Singleton
{
public:
    Singleton() = delete;

    Singleton(const Singleton &) = delete;

    Singleton &operator=(const Singleton &) = delete;

    static HeirT &instance()
    {
        static HeirT instance;
        return instance;
    }
}; 
```

要使用从这里继承你的类，比如：`class Test : public Singleton<Test>`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-05-08T12:14:14.667

这是一个简单的实现。

```
#include <Windows.h>
#include <iostream>

using namespace std;

class SingletonClass {

public:
    static SingletonClass* getInstance() {

    return (!m_instanceSingleton) ?
        m_instanceSingleton = new SingletonClass : 
        m_instanceSingleton;
    }

private:
    // private constructor and destructor
    SingletonClass() { cout << "SingletonClass instance created!\n"; }
    ~SingletonClass() {}

    // private copy constructor and assignment operator
    SingletonClass(const SingletonClass&);
    SingletonClass& operator=(const SingletonClass&);

    static SingletonClass *m_instanceSingleton;
};

SingletonClass* SingletonClass::m_instanceSingleton = nullptr;

int main(int argc, const char * argv[]) {

    SingletonClass *singleton;
    singleton = singleton->getInstance();
    cout << singleton << endl;

    // Another object gets the reference of the first object!
    SingletonClass *anotherSingleton;
    anotherSingleton = anotherSingleton->getInstance();
    cout << anotherSingleton << endl;

    Sleep(5000);

    return 0;
} 
```

每次只创建一个对象，并且每次都返回此对象引用。

```
SingletonClass instance created!
00915CB8
00915CB8 
```

这里 00915CB8 是单例对象的内存位置，在程序运行期间相同，但（通常！）每次程序运行时都不同。

注意这不是线程安全的。你必须确保线程安全。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-06-18T08:25:10.367

已接受答案中的解决方案有一个明显的缺点 - 在控件离开函数后调用单例的析构`main()`函数。当在内部分配一些依赖对象时，确实可能存在问题`main`。

我在尝试在 Qt 应用程序中引入 Singleton 时遇到了这个问题。我决定，我所有的设置对话框都必须是单例，并采用了上面的模式。不幸的是，Qt 的主类`QApplication`是在`main`函数的堆栈上分配的，当没有应用程序对象可用时，Qt 禁止创建/销毁对话框。

这就是为什么我更喜欢堆分配的单例。我为所有单例提供了显式`init()`和`term()`方法，并在内部调用它们`main`。因此，我可以完全控制单例创建/销毁的顺序，并且我保证无论是否有人调用，都会创建单例`getInstance()`。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2019-11-20T06:48:39.990

我们最近在我的 EECS 课上讨论了这个话题。如果您想详细查看讲义，请访问[http://umich.edu/~eecs381/lecture/IdiomsDesPattsCreational.pdf](http://umich.edu/%7Eeecs381/lecture/IdiomsDesPattsCreational.pdf)。这些笔记（以及我在此答案中给出的引文）由我的教授 David Kieras 创建。

我知道有两种方法可以正确创建 Singleton 类。

**第一种方式：**

以类似于您在示例中的方式实现它。至于销毁，“单例通常会在程序运行期间持续存在；大多数操作系统会在程序终止时恢复内存和大多数其他资源，因此有理由不担心这一点。”

但是，最好在程序终止时进行清理。因此，您可以使用辅助静态 SingletonDestructor 类来执行此操作，并将其声明为 Singleton 中的朋友。

```
class Singleton {
public:
  static Singleton* get_instance();

  // disable copy/move -- this is a Singleton
  Singleton(const Singleton&) = delete;
  Singleton(Singleton&&) = delete;
  Singleton& operator=(const Singleton&) = delete;
  Singleton& operator=(Singleton&&) = delete;

  friend class Singleton_destroyer;

private:
  Singleton();  // no one else can create one
  ~Singleton(); // prevent accidental deletion

  static Singleton* ptr;
};

// auxiliary static object for destroying the memory of Singleton
class Singleton_destroyer {
public:
  ~Singleton_destroyer { delete Singleton::ptr; }
};

// somewhere in code (Singleton.cpp is probably the best place) 
// create a global static Singleton_destroyer object
Singleton_destoyer the_destroyer; 
```

Singleton_destroyer 将在程序启动时创建，并且“当程序终止时，所有全局/静态对象都被运行时库关闭代码（由链接器插入）销毁，因此 the_destroyer 将被销毁；它的析构函数将删除 Singleton，运行它的破坏者。”

**第二种方式**

这称为 Meyers Singleton，由 C++ 向导 Scott Meyers 创建。只需以不同的方式定义 get_instance() 即可。现在您还可以摆脱指针成员变量。

```
// public member function
static Singleton& Singleton::get_instance()
{
  static Singleton s;
  return s;
} 
```

这很简洁，因为返回的值是引用的，您可以使用`.`语法而不是`->`访问成员变量。

“编译器会自动构建第一次通过声明创建's'的代码，而不是此后，然后在程序终止时删除静态对象。”

还要注意，使用 Meyers Singleton，“如果对象在终止时相互依赖，您可能会陷入非常困难的境地——Singleton 相对于其他对象什么时候消失？但对于简单的应用程序，这很好用。”

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-04-10T11:19:08.590

有没有人提到`std::call_once`和`std::once_flag`？大多数其他方法——包括双重检查锁定——都被破坏了。

单例模式实现中的一个主要问题是安全初始化。唯一安全的方法是使用同步屏障保护初始化序列。但这些障碍本身需要安全启动。`std::once_flag`是获得保证安全初始化的机制。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-01-11T21:11:31.763

如果要在堆中分配对象，为什么不使用唯一指针。由于我们使用的是唯一指针，因此内存也将被释放。

```
class S
{
    public:
        static S& getInstance()
        {
            if( m_s.get() == 0 )
            {
              m_s.reset( new S() );
            }
            return *m_s;
        }

    private:
        static std::unique_ptr<S> m_s;

        S();
        S(S const&);            // Don't Implement
        void operator=(S const&); // Don't implement
};

std::unique_ptr<S> S::m_s(0); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-07-12T10:18:24.020

C++11 线程安全实现：

```
 #include <iostream>
 #include <thread>

 class Singleton
 {
     private:
         static Singleton * _instance;
         static std::mutex mutex_;

     protected:
         Singleton(const std::string value): value_(value)
         {
         }
         ~Singleton() {}
         std::string value_;

     public:
         /**
          * Singletons should not be cloneable.
          */
         Singleton(Singleton &other) = delete;
         /**
          * Singletons should not be assignable.
          */
         void operator=(const Singleton &) = delete;

         //static Singleton *GetInstance(const std::string& value);
         static Singleton *GetInstance(const std::string& value)
         {
             if (_instance == nullptr)
             {
                 std::lock_guard<std::mutex> lock(mutex_);
                 if (_instance == nullptr)
                 {
                     _instance = new Singleton(value);
                 }
             }
             return _instance;
         }

         std::string value() const{
             return value_;
         }
 };

 /**
  * Static methods should be defined outside the class.
  */
 Singleton* Singleton::_instance = nullptr;
 std::mutex Singleton::mutex_;

 void ThreadFoo(){
     std::this_thread::sleep_for(std::chrono::milliseconds(10));
     Singleton* singleton = Singleton::GetInstance("FOO");
     std::cout << singleton->value() << "\n";
 }

 void ThreadBar(){
     std::this_thread::sleep_for(std::chrono::milliseconds(1000));
     Singleton* singleton = Singleton::GetInstance("BAR");
     std::cout << singleton->value() << "\n";
 }

 int main()
 {
     std::cout <<"If you see the same value, then singleton was reused (yay!\n" <<
                 "If you see different values, then 2 singletons were created (booo!!)\n\n" <<
                 "RESULT:\n";
     std::thread t1(ThreadFoo);
     std::thread t2(ThreadBar);
     t1.join();
     t2.join();
     std::cout << "Complete!" << std::endl;

     return 0;
 } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-06-17T16:14:23.620

它确实可能是从堆中分配的，但是没有来源就无法知道。

典型的实现（取自我已经在 emacs 中的一些代码）是：

```
Singleton * Singleton::getInstance() {
    if (!instance) {
        instance = new Singleton();
    };
    return instance;
}; 
```

...然后依靠超出范围的程序进行清理。

如果您在必须手动完成清理的平台上工作，我可能会添加手动清理例程。

这样做的另一个问题是它不是线程安全的。在多线程环境中，两个线程可以在任何一个有机会分配新实例之前通过“if”（所以两者都会）。如果您仍然依赖程序终止来清理，这仍然不是什么大不了的事。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-11-06T15:27:01.777

除了此处的其他讨论之外，可能值得注意的是，您可以拥有全局性，而无需将使用限制在一个实例中。例如，考虑引用计数的情况......

```
struct Store{
   std::array<Something, 1024> data;
   size_t get(size_t idx){ /* ... */ }
   void incr_ref(size_t idx){ /* ... */}
   void decr_ref(size_t idx){ /* ... */}
};

template<Store* store_p>
struct ItemRef{
   size_t idx;
   auto get(){ return store_p->get(idx); };
   ItemRef() { store_p->incr_ref(idx); };
   ~ItemRef() { store_p->decr_ref(idx); };
};

Store store1_g;
Store store2_g; // we don't restrict the number of global Store instances 
```

现在在函数内部的某个地方（例如`main`），您可以执行以下操作：

```
auto ref1_a = ItemRef<&store1_g>(101);
auto ref2_a = ItemRef<&store2_g>(201); 
```

refs 不需要存储指向它们各自的指针，`Store`因为该信息是在编译时提供的。您也不必担心`Store`的生命周期，因为编译器要求它是全局的。如果确实只有一个实例，`Store`那么这种方法就没有开销；对于不止一个实例，编译器在代码生成方面是否聪明。如有必要，`ItemRef`该类甚至可以成为一个`friend`（`Store`你可以有模板化的朋友！）。

如果`Store`它本身是一个模板类，那么事情会变得更加混乱，但仍然可以使用这个方法，也许通过实现一个具有以下签名的帮助类：

```
template <typename Store_t, Store_t* store_p>
struct StoreWrapper{ /* stuff to access store_p, e.g. methods returning 
                       instances of ItemRef<Store_t, store_p>. */ }; 
```

用户现在可以`StoreWrapper`为每个全局实例创建一个类型（和全局实例）`Store`，并始终通过其包装实例访问存储（因此忘记了使用所需的模板参数的血腥细节`Store`）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-08-05T15:37:51.510

这是一个使用[CRTP的可](https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)[模拟单例](https://github.com/canonical/multipass/blob/7d3de5fb1a4402b4438dae4806677fdd6c776450/include/multipass/singleton.h)。它依赖[一个小助手](https://github.com/canonical/multipass/blob/7d3de5fb1a4402b4438dae4806677fdd6c776450/include/multipass/private_pass_provider.h)在任何时候（最多）强制执行单个对象。要在程序执行上强制执行单个对象，请删除重置（我们发现这对测试很有用）。

A`ConcreteSinleton`可以这样实现：

```
class ConcreteSingleton : public Singleton<ConcreteSingleton>
{
public:
  ConcreteSingleton(const Singleton<ConcreteSingleton>::PrivatePass&)
      : Singleton<StandardPaths>::Singleton{pass}
  {}

  // ... concrete interface
  int f() const {return 42;}

}; 
```

然后与

```
ConcreteSingleton::instance().f(); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-04-01T08:42:05.310

这是关于对象生命周期管理的。假设您的软件中有多个单例。他们依赖于 Logger 单例。在应用程序销毁期间，假设另一个单例对象使用 Logger 记录其销毁步骤。你必须保证 Logger 应该最后被清理。因此，也请查看这篇论文： [http ://www.cs.wustl.edu/~schmidt/PDF/ObjMan.pdf](http://www.cs.wustl.edu/~schmidt/PDF/ObjMan.pdf)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-11-20T06:30:33.233

我的实现类似于 Galik 的。不同之处在于我的实现允许共享指针清理分配的内存，而不是保留内存直到应用程序退出并清理静态指针。

```
#pragma once

#include <memory>

template<typename T>
class Singleton
{
private:
  static std::weak_ptr<T> _singleton;
public:
  static std::shared_ptr<T> singleton()
  {
    std::shared_ptr<T> singleton = _singleton.lock();
    if (!singleton) 
    {
      singleton.reset(new T());
      _singleton = singleton;
    }

    return singleton;
  }
};

template<typename T>
std::weak_ptr<T> Singleton<T>::_singleton; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-01-09T18:37:41.727

您的代码是正确的，只是*您没有在 class 之外声明实例指针*。静态变量的内部类声明在 C++ 中不被视为声明，但是在**C#**或**Java**等其他语言中允许这样做。

```
class Singleton
{
   public:
       static Singleton* getInstance( );
   private:
       Singleton( );
       static Singleton* instance;
};
Singleton* Singleton::instance; //we need to declare outside because static variables are global 
```

你要知道，Singleton 实例*不需要我们手动删除*。我们在整个程序中都需要它的一个对象，所以*在程序执行结束时，它会被自动释放。*

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-06-20T17:07:58.747

这是我对如何做正确的单例（和其他重要的静态对象）的看法：[https ://github.com/alex4747-pub/proper_singleton](https://github.com/alex4747-pub/proper_singleton)

概括：

1.  使用静态初始化列表在正确的时间实例化单例：进入main之后和启用多线程之前
2.  添加小的改进以使其对单元测试友好。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-01-27T16:52:14.457

我想在这里展示另一个 C++ 中的单例示例。使用模板编程是有意义的。此外，从不可复制且不可移动的类派生单例类是有意义的。下面是它在代码中的样子：

```
#include<iostream>
#include<string>

class DoNotCopy
{
protected:
    DoNotCopy(void) = default;
    DoNotCopy(const DoNotCopy&) = delete;
    DoNotCopy& operator=(const DoNotCopy&) = delete;
};

class DoNotMove
{
protected:
    DoNotMove(void) = default;
    DoNotMove(DoNotMove&&) = delete;
    DoNotMove& operator=(DoNotMove&&) = delete;
};

class DoNotCopyMove : public DoNotCopy,
    public DoNotMove
{
protected:
    DoNotCopyMove(void) = default;
};

template<class T>
class Singleton : public DoNotCopyMove
{
public:
    static T& Instance(void)
    {
        static T instance;
        return instance;
    }

protected:
    Singleton(void) = default;
};

class Logger final: public Singleton<Logger>
{
public:
    void log(const std::string& str) { std::cout << str << std::endl; }
};

int main()
{
    Logger::Instance().log("xx");
} 
```

拆分为 NotCopyable 和 NotMovable 类允许您更具体地定义单例（有时您想要移动单个实例）。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-06-26T04:39:00.330

它将类的实例化限制为一个对象。当需要一个对象来协调整个系统的动作时，这很有用

```
class Singleton {
private:
    int data;
    static Singleton* instance;
    Singleton();
public:
    static Singleton* getInstance();
};
Singleton* Singleton::instance = 0;
Singleton::Singleton()
{
    this->data = 0;
    cout << "constructor called.." << endl;
}

Singleton* Singleton::getInstance() {
    if (!instance) {
        instance = new Singleton();
        return instance;
    }
}
int main() {
    Singleton *s = s->getInstance();
    Singleton *s1 =s1->getInstance();
    } 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2011-10-17T22:06:18.000

上面链接的论文描述了双重检查锁定的缺点是编译器可能会在调用对象的构造函数之前为对象分配内存并设置指向分配内存地址的指针。在 c++ 中很容易使用分配器手动分配内存，然后使用构造调用来初始化内存。使用这种方法，双重检查锁定工作得很好。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2014-01-18T19:05:14.330

```
#define INS(c) private:void operator=(c const&){};public:static c& I(){static c _instance;return _instance;} 
```

例子：

```
 class CCtrl
    {
    private:
        CCtrl(void);
        virtual ~CCtrl(void);

    public:
        INS(CCtrl); 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2018-09-11T07:23:23.237

简单的单例类，这一定是你的头类文件

```
#ifndef SC_SINGLETON_CLASS_H
#define SC_SINGLETON_CLASS_H

class SingletonClass
{
    public:
        static SingletonClass* Instance()
        {
           static SingletonClass* instance = new SingletonClass();
           return instance;
        }

        void Relocate(int X, int Y, int Z);

    private:
        SingletonClass();
        ~SingletonClass();
};

#define sSingletonClass SingletonClass::Instance()

#endif 
```

像这样访问你的单例：

```
sSingletonClass->Relocate(1, 2, 5); 
```

# java - 如何序列化 Java 类的静态数据成员？

> ID：1008023
> 
> 赞同：35
> 
> 时间：2009-06-17T16:02:40.080
> 
> 标签：java, serialization, static-members

我们序列化对象的时候，静态成员是不序列化的，但是如果我们需要这样做，有什么办法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-17T16:12:13.747

第一个问题是为什么需要序列化静态成员？

静态成员与类相关联，而不是与实例相关联，因此在序列化实例时包含它们是没有意义的。

第一个解决方案是使这些成员不是静态的。或者，如果这些成员在原始类和目标类（相同的类，但可能不同的运行时环境）中相同，则根本不要序列化它们。

我对如何跨静态成员发送有一些想法，但我首先需要查看用例，因为在所有情况下都意味着更新目标类，我还没有找到这样做的充分理由。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-06-17T16:33:00.543

伙计们，静态并不意味着不可变。例如，我可能想序列化整个计算状态（是的，包括静态字段——计数器等），以便稍后在 JVM 和/或主机重新启动后恢复。

如前所述，正确的答案是使用 Externalizable，而不是 Serializable 接口。然后你可以完全控制你外化的内容和方式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-12-06T19:32:03.733

这是静态字段的序列化：newBookingNumber。

```
class Booking implements Serializable
{

    /**
     * Generated serial version ID.
     */

    private static final long serialVersionUID = 5316748056989930874L;

    // To hold new booking number.
    private static int newBookingNumber = 0;

    // The booking number.
    private int bookingNumber;

    /* 
     * Default serializable fields of a class are defined to be 
     * the non-transient and non-static fields. So, we have to 
     * write and read the static field separately.
     */
    private void writeObject(ObjectOutputStream oos)
        throws IOException 
    {
        oos.defaultWriteObject();
        oos.writeObject(new Integer(newBookingNumber));
    }

    private void readObject(ObjectInputStream ois)
    throws ClassNotFoundException, IOException 
    {
        ois.defaultReadObject();
        newBookingNumber = (Integer)ois.readObject();
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-17T16:22:20.923

您可以通过实现来控制序列化：

```
private void writeObject(ObjectOutputStream out) throws IOException;

private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException; 
```

有序列化的完整描述[http://java.sun.com/developer/technicalArticles/Programming/serialization/](http://java.sun.com/developer/technicalArticles/Programming/serialization/)。

正如其他答案所说，序列化静态数据并没有真正意义，因为它是对象而不是您正在序列化的类，并且需要这样做闻起来就像您的代码对我有其他问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T16:26:35.257

好的答案和评论——不要这样做。但是怎么做？

您最好创建一个对象来保存所有“静态”。该对象可能也应该具有您的类中的任何静态方法。

你的类的每个实例都可以容纳另一个类——或者如果你真的需要，你可以让它成为任何成员都可以访问的单例。

在你做了这个重构之后，你会发现它应该一直这样做。您甚至可能会发现，以前在 subconsicionce 级别上困扰您的一些设计约束已经消失。

您可能会发现此解决方案还解决了您尚未注意到的其他序列化问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-09-05T11:15:02.593

您可以执行此操作，而无需在每次更改字段时手动更新您的课程。如果您希望静态成员可以轻松访问应用程序中的设置，但也希望保存这些设置，您可能希望这样做。在这种情况下，您还希望可以选择随心所欲地应用它们，而不是默认加载，因为这里的其他解决方案需要，因为它们是静态的。这允许出于显而易见的原因回滚设置。

基本上，使用字段方法获取类中的所有成员，然后将这些字段的全名映射到内容。由于 Field 本身不可序列化，因此需要全名。序列化此映射，并恢复它以获取保存的设置。

谜题的第二部分是 apply() 类型的函数。这通过映射，并将它可以应用于静态类。

您还必须确保静态成员的内容本身是可序列化的。

希望从这个示例类中可以看出，静态成员可以很容易地保存和返回。我将让实现者来担心类的 UID、安全措施等。 isSameAs() 用于单元测试。AppSettings 是包含您希望序列化的所有静态字段的类。

```
public class AppSettingsReflectorSaver implements Serializable {

HashMap<String, Object> genericNamesAndContents = new HashMap<String, Object>();
private AppSettingsReflectorSaver() {
}

static AppSettingsReflectorSaver createAppSettingsSaver() {
    AppSettingsReflectorSaver ret = new AppSettingsReflectorSaver();
    ret.copyAppSettings();
    return ret;
}

private void copyAppSettings() {
    Field[] fields = AppSettings.class.getFields();
    for (Field field : fields) {
        mapContentsForSerialization(field);
    }
}

private void mapContentsForSerialization(Field field) {
    try {
        Object fieldContents = field.get(AppSettings.class);
        genericNamesAndContents.put(field.toGenericString(), fieldContents);
    } catch (IllegalArgumentException ex) {
        Logger.getLogger(AppSettingsReflectorSaver.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        Logger.getLogger(AppSettingsReflectorSaver.class.getName()).log(Level.SEVERE, null, ex);
    }
}

boolean isSameAs(AppSettingsReflectorSaver now) {
    for( String thisKey : genericNamesAndContents.keySet()){
        boolean otherHasThisKey = now.genericNamesAndContents.containsKey(thisKey);
        Object thisObject = genericNamesAndContents.get(thisKey);
        Object otherObject = now.genericNamesAndContents.get(thisKey);
        boolean otherHasThisValue = thisObject.equals(otherObject);
        if (!otherHasThisKey || !otherHasThisValue){
            return false;
        }
    }
    return true;
}

void applySavedSettingsToStatic() {
    Field[] fields = AppSettings.class.getFields();
    for (Field field : fields) {
        if (!genericNamesAndContents.containsKey(field.toGenericString())){
            continue;
        }
        Object content = genericNamesAndContents.get(field.toGenericString() );
        try {
            field.set(AppSettings.class, content);
        } catch (IllegalArgumentException ex) {
            Logger.getLogger(AppSettingsReflectorSaver.class.getName()).log(Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            Logger.getLogger(AppSettingsReflectorSaver.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
} 
```

}

这是我的第一篇文章-放轻松：P〜

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T16:13:59.283

静态成员属于类，而不属于单个对象。

您应该重新考虑您的数据结构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-27T04:31:52.920

是的，我们可以序列化静态变量。但是我们可以编写自己的`writeObject()`and `readObject()`。我认为这可以解决问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-09T11:56:17.207

要实现紧凑的实现，请在您的类中实现 readObject 和 writeObject 调用 defaultReadObject 和 defaultWriteObject 方法，这些方法在处理正常序列化的那些方法中，然后继续序列化和反序列化您需要的任何其他字段。

问候， GK

# emacs - 如何同步 Emacs 包和设置？

> ID：1008036
> 
> 赞同：9
> 
> 时间：2009-06-17T16:04:13.200
> 
> 标签：emacs, synchronization

我在家里和工作中都有 emacs。如果我添加新包，如何同步它们？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T19:34:41.980

我使用 git 来保存我的配置，并将依赖于平台/机器的部分拆分为单独的文件，并根据机器的名称加载它们。[你可以在这里](http://github.com/alexott/emacs-configs/tree/master)看到我的配置

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T06:50:59.910

或者，您可以安装[Dropbox](http://www.getdropbox.com)并将您的 emacs 配置放在 Dropbox 目录中。这与[SyncFirefoxBookmarks](http://wiki.getdropbox.com/TipsAndTricks/SyncFirefoxBookmarks)的想法相同。您`.emacs`只需参考保管箱目录中的文件。

在 Linux 上，您甚至可以更轻松一些，您只需将您的文件复制`~/.emacs.d`到保管箱目录并创建一个链接即可。你可以跳过`.emacs`并直接使用`~/.emacs.d/init.el`（参见[Emacs 手册 - 初始化文件](http://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html#Init-File)）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T16:07:58.020

我会使用 git/cvs/subversion/etc。存储库，并简单地使用版本控制系统来允许您更新两个地方的文件/目录。

关于以这种方式使用集市的问题有一个[答案。](https://stackoverflow.com/questions/993707/bazaar-how-put-files-from-different-locations-in-one-repository/995218#995218)该答案很好地解释了要使用的目录结构，以便清楚所有包和初始化文件的去向。

至于如何/在哪里存储存储库，我不知道最好的答案。如果您经常连接工作（通过 VPN 或其他方式），那么我建议您在工作中托管存储库。如果没有，那么您可以使用[sourceforge.net](http://sourceforge.net/)或其他类似的网站 - 但您会将所有内容都暴露给世界......也许这部分问题最好在[serverfault.com](https://serverfault.com/)上提出。

# python - 如何测试 Genshi 流中是否存在字符串？

> ID：1008038
> 
> 赞同：0
> 
> 时间：2009-06-17T16:04:19.957
> 
> 标签：python, stream, genshi

我正在为 Trac 开发一个插件，并通过操作 Genshi 流将一些 javascript 插入到呈现的 HTML 中。

我需要测试一个javascript函数是否已经在HTML中，如果它被一个新版本覆盖，如果不是，那么将它添加到HTML中。

如何执行搜索以查看该功能是否已经存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:35:49.870

啊哈！！我首先尝试从流中删除函数来解决这个问题：

```
stream = stream | Transformer('.//head/script["functionName()"]').remove() 
```

然后添加更新/新版本：

```
stream = stream | Transformer('.//head').append(tag.script(functionNameCode, type="text/javascript")) 
```

# c# - 无法在 C# 中实例化 COM 组件 - 错误 80070002

> ID：1008040
> 
> 赞同：4
> 
> 时间：2009-06-17T16:04:36.603
> 
> 标签：c#, com, interop, com-interop

我正在尝试在我的机器上实例化一个 Windows Media Player COM 对象：

```
Guid mediaPlayerClassId = new Guid("47ac3c2f-7033-4d47-ae81-9c94e566c4cc");
Type mediaPlayerType = Type.GetTypeFromCLSID(mediaPlayerClassId);
Activator.CreateInstance(mediaPlayerType); // <-- this line throws 
```

执行最后一行时，出现以下错误：

```
System.IO.FileNotFoundException was caught
  Message="Retrieving the COM class factory for component with CLSID {47AC3C2F-7033-4D47-AE81-9C94E566C4CC} failed due to the following error: 80070002."
  Source="mscorlib"
  StackTrace:
       at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandle& ctor, Boolean& bNeedSecurityCheck)
       at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean fillCache)
       at System.RuntimeType.CreateInstanceImpl(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean fillCache)
       at System.Activator.CreateInstance(Type type, Boolean nonPublic)
       at System.Activator.CreateInstance(Type type)
       at MyStuff.PreviewFile(String filePath) in F:\Trunk\PreviewHandlerHosting\PreviewHandlerHost.cs:line 60
  InnerException: 
```

相同的代码适用于其他开发人员机器和最终用户机器。出于某种原因，它只在我的机器上失败。可能是什么原因？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T16:08:19.097

80070002 是文件未找到错误。

我的猜测是您的机器缺少依赖项。尝试通过depends.exe 运行com 组件，看看是否安装了所有必需的库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T16:06:58.817

嗯，0x80070002 表示找不到文件，所以我会检查一下 COM 注册中指向的 DLL 是否确实存在于您的机器上

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-01T15:38:06.703

进一步可能有用的信息。我们在加载 .net 组件的经典 asp web 应用程序中看到了这个问题。一个应用程序很好，另一个不是。同一台机器？那么给了什么？我们没有收到有关未能加载 com 组件的正确错误，只是错误号 0x80070002。

最终，只需将损坏的应用程序的应用程序池设置为与正常工作的应用程序相同即可解决此问题。关于应用程序池的某些事情意味着无法正确加载组件，相同的身份等（iis 6）。

该组件的注册表中有一堆旧版本号，但是 regasm 总是这样做，清理起来很糟糕，我们甚至不得不编写一个小工具来在开发机器上的版本号之间移动时将它们全部删除。但在这种情况下，这些版本号不是问题。

结论：听起来像是权限问题，但我知道什么..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-13T05:12:05.910

如果应用程序池崩溃，可能会发生此错误。如果最终有任何函数或对象初始化重复，您可以检查您的代码。这可能会导致内存泄漏并最终导致应用程序池崩溃

# ms-access - 将字段从文本转换为日期/时间时，MS 访问错误的日期格式

> ID：1008042
> 
> 赞同：6
> 
> 时间：2009-06-17T16:04:45.790
> 
> 标签：ms-access, date, format, textfield

我有一个访问数据库，其中所有日期都以 mm/dd 格式存储在文本字段中（例如：3/13/2009 12:20:36 AM）

我想将该字段转换为日期/时间，但访问将其格式化为 dd/mm，这样如果日期大于 12，则转换的日期可能是错误的。

以文本形式存储在数据库中时的当前格式示例：

```
2009 年 3 月 12 日晚上 11:32:40
2009 年 3 月 13 日晚上 11:32:40

```

如果我只是将此字段的数据类型从表格的设计视图从文本转换为日期/时间日期类型，我会得到以下信息：

```
2009 年 3 月 12 日晚上 11:32:40
2009 年 13 月 3 日晚上 11:32:40

```

我将如何修复存储的值？我不太关心日期将显示的格式，因为我可以轻松更改它的外观，但是让它们正确地从文本转换为日期/时间已被证明是棘手的。

最好我想直接从访问中修复它，但如果需要，我可以从 C# 中修复它。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T16:24:36.520

如果这是一个本地 Access 应用程序，它使用系统的日期时间格式，因此在 Windows 中更改本地化设置以使用 MM/DD 将使 Access 以这种方式转换，除非这已在应用程序的某处被覆盖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T17:51:22.063

Format(CDate("3/13/2009 11:32:40 PM"), "mm/dd/yyyy" 会给你 03/13/2009

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T01:56:26.233

您对当前的问题已经有了很好的答案，但是您似乎正在以 dmy 格式运行您的系统。因此，您应该注意以下事项。

SQL 语句要求日期要么完全明确，要么采用 mm/dd/yy 或 mm/dd/yyyy 格式。否则，Access/Jet 将尽最大努力根据正在使用的具体日期来解释结果未知的日期。您不能假设您正在使用的系统正在使用这些日期格式。因此，您应该使用以下网页中的逻辑。

以美国#mm/dd/yyyy# 格式返回日期 [http://www.mvps.org/access/datetime/date0005.htm](http://www.mvps.org/access/datetime/date0005.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T16:31:19.343

Access 中的导入功能具有不错的日期解析功能，并且可以让您指定多种不同的格式。不确定如何最好地将其应用于 Access 中已有的内容 - 一种快速方法可能是将数据复制到 Excel，然后重新导入。

# sql - LINQ to SQL 和附加子对象

> ID：1008045
> 
> 赞同：4
> 
> 时间：2009-06-17T16:05:23.107
> 
> 标签：sql, linq

我正在编写一个类，它将（希望）允许通过 LINQ to SQL 层操作数据，而不必知道您正在使用哪些单个对象。到目前为止，它适用于级联选择和插入，但我很难进行更新。

这是我正在使用的保存方法：

```
if ((long)entity.GetType().GetProperty(GetPrimaryKeyName(entity)).GetValue(entity, null) == 0)
            {
                Context.GetTable(entity.GetType()).InsertOnSubmit(entity);
            }
            else
            {
                Context.GetTable(entity.GetType()).Attach(entity, true);
            }

            foreach (PropertyInfo property in entity.GetType().GetProperties())
            {
                if (property.PropertyType.IsGenericType && property.PropertyType.GetGenericTypeDefinition() == typeof(EntitySet<>))
                {
                    IEnumerable children = (IEnumerable)property.GetValue(entity, null);
                    foreach (object child in children)
                    {
                        Save(child);
                    }
                }
            } 
```

这一直有效，直到我有一个子对象作为更新的一部分。例如，如果我传入一个带有 Address 子对象的 Customer 对象，该对象需要更新而不是插入，一旦我附加 Customer 对象，我现在的 EntitySet 中有两个 Address 对象——从数据库中提取的一个，和新的。然后，当它尝试附加第一个地址子对象时，我得到一个异常“无法附加已经存在的实体”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T04:20:45.447

您可以在附加父实体之前附加子实体吗？这会阻止附加问题吗？

只需使用反射来获取所有`EntityRef`对象，并将`Entity`每个对象的属性附加到相应的表中。

# vba - 是否可以使用 Word 2007 VBA 更改标记字段的字段功能？

> ID：1008046
> 
> 赞同：0
> 
> 时间：2009-06-17T16:05:33.623
> 
> 标签：vba, field, word-2007

我想做以下事情：

在 Word 2007 中，将光标放在字段上（或标记该字段）并调用宏来编辑该字段的字段功能。（添加一些字符串）。

我什至感谢一些提示谷歌的术语。

我使用了宏记录器并得到以下信息：

```
WordBasic.FormatField Field:="CITATION Gro05 \p 9 \l 1031" 
```

这显然创造了一个新领域，但从这里开始呢？

为了获得选定的字段，我想到了这样的事情：

```
If Selection.Type = WdFieldType Then ... 
```

我希望有人给我一些提示：）再见理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:01:36.483

```
Selection.Range.Fields 
```

将为您提供当前选择中的字段集合。

# asp.net - DSN 到连接字符串？

> ID：1008047
> 
> 赞同：9
> 
> 时间：2009-06-17T16:05:52.687
> 
> 标签：asp.net, odbc, connection-string, dsn

我们有一个使用数据库的 ASP.NET 网站，我们希望能够使用连接字符串来访问该数据库。我们已经成功地设置了一个 DSN 来连接到这个 DB，但我似乎无法发现使用连接字符串的正确魔法。

有没有一种直接的方法可以将 DSN 中的值转换为连接字符串？我知道从 UI 来看，没有一个明显的答案……每个 db 供应商都提供不同的 UI 来根据他们的需要创建 DSN。然而，我希望在 UI 下它可能只是在做一些事情，比如在幕后创建一个连接字符串，我可以看看它，看看我做错了什么。这有希望吗？如果是这样，有关如何获取我需要的信息的任何指示？

（我已访问 connectionstrings.com 以尝试确保我的连接字符串格式正确，但似乎没有任何效果......这就是为什么我要尝试这种奇怪的 translate-from-dsn 技巧。）

**编辑：**我一定不清楚的是我们不想有一个 DSN 条目。我们已经创建了一个，并且暂时使用了它，但是我们希望能够摆脱它并使用**没有**dsn 的连接字符串。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T18:18:08.320

如果您可以使用 OLEDB，那么您可以创建一个[UDL 文件](http://msdn.microsoft.com/en-us/library/e38h511e(VS.71).aspx)。只需创建一个新的文本文档，`test.udl`然后双击。填写对话框，然后使用记事本将其打开。瞧——这是你的连接字符串。

ODBC 有点难——您可以从 ODBC 管理器创建文件 DSN，也可以在注册表中`HKLM\Software\ODBC\ODBC.INI\<DSN Name>`查找系统 DSN。您最终会得到一些名称/值对。您应该能够将它们转换为连接字符串。将`\\Driver`列出实际的 DLL，因此您需要从`HKLM\Software\ODBC\ODBC Data Sources\\<DSN Name>`.

如果您可以为 ODBC 使用 OLEDB 提供程序，那么您可以使用 UDL 技巧并让它也从 ODBC 文件 DSN 构建连接字符串。ODBC 连接字符串将位于 UDL 的扩展属性中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T16:11:27.023

如果您已经创建了 DSN，那么 DSN**就是**ConnectionString ！

您可以简单地使用`DSN=<YourDSNName>`并将其传递给 OdbcConnection 对象。

例如，使用 C#：

```
string dsnName = "DSN=MyDSN";
using (OdbcConnection conn = new OdbcConnection(dsnName))
{
  conn.Open();
} 
```

或者，您可以使用[`OdbcConnectionStringBuilder`](http://msdn.microsoft.com/en-us/library/system.data.odbc.odbcconnectionstringbuilder(loband).aspx)该类并设置其`DSN`属性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-22T19:04:32.470

扩展 Mark Brackett 关于注册表的回答：对于 64 位 Windows 上的 32 位 ODBC，注册表路径为 HKLM\Software\Wow6432Node\ODBC\ODBC.INI\

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-31T21:14:03.963

就我而言，足以：

*   删除标题
*   用分号替换所有新行
*   使用大括号作为组分隔符

这是由 ODBC 数据源管理员创建的我的 DSN 文件（第 3 个选项卡 - 文件 DSN）

```
[ODBC]
DRIVER=MySQL ODBC 5.3 ANSI Driver
UID=MyUserName
PORT=3306
DATABASE=mydatabasename
SERVER=localhost 
```

这是我的连接字符串的样子：

```
DRIVER={MySQL ODBC 5.3 ANSI Driver};UID=MyUserName;PORT=3306;DATABASE=mydatabasename;SERVER=localhost 
```

# algorithm - 概率散列——有这样的事情吗？

> ID：1008052
> 
> 赞同：7
> 
> 时间：2009-06-17T16:06:33.437
> 
> 标签：algorithm, data-structures

假设您想实现一个点击跟踪器，您希望只计算一次来自任何 IP 地址的链接的点击，但链接和客户端的数量非常大，您不想保留每个 IP 的表格 -点击。假设您可能需要将其作为针对每次点击实时运行的内容的一部分，并且不希望每次点击都针对大表进行查找。

是否存在诸如“概率散列”或“有损散列”之类的东西来查看 IP 是否可能在一个集合中，但您不关心是否存在一定的错误率，因为您想节省资源？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-17T16:08:52.513

你可能（ab？）使用[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)来做这样的事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T16:55:05.930

假设 IPv4 地址，搜索空间为 2 ^(32)。每个 IP 地址不需要超过 1 位（0 == 不访问，1 == 访问）。如果不考虑存储开销，这将需要 512 MB (2 ^(29) ) 来存储。因此，一个简单的实现将分配一个 512 MB 数组（或一个有 2 ^(29)行的表，每个存储一个字节，或 2 个^(27)行，每个存储一个 32 位整数，或 2 个^(26)行，每个存储一个 64 位整数，或者...）

您可以通过将其变成一棵树来针对稀疏人口进行优化。

定义 2 ^(*x*)位的“页面”大小。您将一次为一页分配存储空间。

将您的搜索空间 (2 ^(32) ) 除以您的页面大小。这是表示搜索空间中每个可能地址所需的总页数。

然后，要确定您的哈希是否命中，您将首先确定页面是否存在，如果存在，是否设置了页面中的适当位。要缓存地址，首先要确定页面是否存在；如果没有，您将创建它。接下来，您将设置适当的位。

这很容易适应数据库表。您只需要两列：一个页面索引和一个二进制数组。当您分配一个页面时，您只需在表中存储一个具有正确页面索引和一个空二进制数组的行。

例如，对于 1024 位的页面大小（最多产生 2 ^(22 个)页面），您可以像这样构造您的表：

```
CREATE TABLE VisitedIPs(
    PageIndex int         NOT NULL PRIMARY KEY,
    PageData  binary(128) NOT NULL
) 
```

要检查 IP 是否已访问，您将使用类似于（伪代码）的代码：

```
uint ip = address.To32Bit();

string sql =
    "SELECT PageData " +
    "FROM VisitedIPs " +
    "WHERE PageIndex = " + (ip >> 10);

byte[] page = (byte[])GetFromDB(sql);

byte b = page[(ip & 0x3FF) >> 3];

bool hasVisited = (b & (1 << (ip & 7)) != 0; 
```

IP访问过的设置类似：

```
uint ip = address.To32Bit();

string sql =
    "SELECT PageData " +
    "FROM VisitedIPs " +
    "WHERE PageIndex = " + (ip >> 10);

byte[] page = (byte[])GetFromDB(sql);

page[(ip & 0x3FF) >> 3] |= (1 << (ip & 7));

sql =
    "UPDATE VisitedIPs " +
    "SET PageData = @pageData " +
    "WHERE PageIndex = " + (ip >> 10);

ExecSQL(sql, new SqlParam("@pageData", page)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T16:23:46.380

根据[**鸽巢原理**](http://en.wikipedia.org/wiki/Pigeonhole_principle)，所有散列都是有损的。不可避免地，您试图将 N 个东西塞进 M 个插槽（其中 N >> M）。您需要做的只是不处理冲突情况并选择足够大的哈希表。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T16:10:26.850

当然！决定你能负担得起多少个“垃圾箱”（每个垃圾箱一个），比​​如 N；将 IP 地址散列为一串位 B；取 B 模 N。您可以计算意外碰撞的概率（使用一些近似值，例如，假设所有散列 IP 地址形成同样可能的位串 B）并相应地确定 N，如果您对您可以接受的最大意外碰撞概率有限制应用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T17:10:10.047

开始截断位。

当可能的 2^n 中有 2^(n/2) 个事物时，哈希冲突的概率变为 50%。IP 地址为 2^32，因此当容器中有 2^16 个项目时，发生冲突的可能性为 50%。

感觉舒服就减少。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T16:13:14.307

整数 (ipv4) 或字符串 (ipv6) 散列没有冲突处理，使用散列值（模散列表大小）作为位图数组的索引。

# c - Windows下访问Gnu C库

> ID：1008065
> 
> 赞同：0
> 
> 时间：2009-06-17T16:07:42.203
> 
> 标签：c, windows, include

我正在尝试编译我在 Windows 命令行中使用 cl.exe 从 Internet 下载的 C 程序。该文件包括gnu C 库文件如getopt.h 和unistd.h，在Windows 下默认不可用。我怎样才能访问这些（同时仍然使用 cl.exe 编译器）。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T16:10:43.623

getopt.h 和 unistd.h 不是库 - 它们是头文件。即使您拥有它们，它们对您也毫无用处，因为您还需要实际的二进制库（.LIB 或 .a 文件）。顾名思义， unistd.h 文件包含特定于 Unix 的函数声明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T16:14:03.980

对于 getopt.h，您可以使用[xgetopt](http://www.codeproject.com/KB/cpp/xgetopt.aspx)。如果您对更改编译器感兴趣，总会有 MingW。否则，您可能必须编写自己的 getopt.h 或 unistd.h。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T16:33:00.853

文件 getopt.h 和 unistd.h 是头文件。最好使用像 MINGW32 这样的 gnu 兼容编译器。由于替换这些文件通常不足以让您的库在 Windows 编译器下编译和运行。如果您仍想使用 cl.exe，请将“unistd.h”替换为“windows.h”并从 Internet 获取与 win32 兼容的“getopt”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T16:20:44.400

总是有[cygwin](http://www.cygwin.com/) - 使用包含文件并与`cygwin1.dll`库链接，这是他们的[常见问题解答](http://cygwin.com/faq/faq-nochunks.html#faq.programming.msvs-mingw)条目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T17:45:33.757

`getopt.c`从[MinGW](http://www.mingw.org/)将相当简单地移植到 MS C（我已经用 VS2005 完成了这个）。您可以从 MinGW 网站获得它。 [这篇 Stackoverflow 帖子](https://stackoverflow.com/questions/341817/is-there-a-replacement-for-unistd-h-for-windows-visual-c)`unistd.h`讨论了在 MS C 编译器上的替代。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T16:19:07.740

unistd.h 是[标准 C 包含文件](http://www.opengroup.org/onlinepubs/009695399/basedefs/unistd.h.html)。如果您使用的任何编译器都没有提供它，我会感到震惊。你确定它不存在吗？

# javascript - 为什么在托管 Web 浏览器中无法加载 Javascript 控件？

> ID：1008066
> 
> 赞同：2
> 
> 时间：2009-06-17T16:07:51.470
> 
> 标签：javascript, internet-explorer, winapi, com

不幸的是，我们不得不在我们的 Windows 桌面应用程序中使用用于网页的 JavaScript 控件。为此，我们在应用程序中托管 Internet Explorer，并告诉它导航到本地网页。然后我们得到脚本引擎的IDispatch接口，并用它与控件进行交互。网页看起来像这样：

```
<html>
  <head>
    <script src="third party website url" type="text/javascript"></script>
  </head>
  <body onload="OurApp.OnLoad()">
  </body>
</html> 
```

（为了清楚起见，我省略了一些标签和属性。）我们将“OurApp”对象添加到脚本引擎的命名空间。它是一个 IDispatch 接口，允许脚本回调到我们的应用程序中。在我们应用程序的 OnLoad() 方法中，我们构造了控件定义的各种 JavaScript 对象。

**问题：** 在 99% 的情况下，这种设置效果很好。不幸的是，在某些客户机器上，我们的 OnLoad() 方法在脚本引擎中找不到任何预期的方法。这就像来自第三方网站的 JavaScript 要么没有加载，要么不允许运行。对于许多客户，我们通过更改 Internet Explorer 中的安全设置解决了这个问题。但是现在我们有一些客户的安全设置似乎是正确的，但我们仍然遇到问题。

作为一个额外的皱纹，如果我像上面那样创建一个网页并让客户在他的机器上打开它，他会得到一个弹出栏，要求他授权活动内容，然后一旦他同意，一切都会正常工作。（在此页面中，我已将 OurApp.OnLoad() 调用替换为一些执行相同操作的 JavaScript。）这与我在我的机器上遇到的行为相同，但我们的应用程序在这里运行良好。我们在客户的机器上根本没有收到任何错误消息（尽管也许我们只是没有在正确的地方寻找）。

所以，我很难过。任何想法或建议将不胜感激。

**更新** 我们终于设法解决了这个问题。问题是我们将不受支持的语言环境传递给第三方网站。在这种情况下，它们作为空脚本返回，而不是紧密匹配或合理的默认值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T16:11:52.747

很难 100% 确定问题出在哪里，但如果我猜测的话，我会说这可能与客户 IT 部门使用某些安全策略、代理、类似性质的东西锁定他们的机器有关。您是否与遇到此问题的客户 IT 部门讨论过这些问题？

您是否连接到与托管 IE 控件中的 :80 不同的端口上的远程页面？我对 IE COM 了解不多，但是否有可能以编程方式获取错误、警告和类似性质的东西？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T11:35:41.920

您可能想要实现自己的安全管理器：

[http://msdn.microsoft.com/en-us/library/ms537182(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms537182(VS.85).aspx)

# excel - Excel：用匹配的行填充工作表

> ID：1008067
> 
> 赞同：1
> 
> 时间：2009-06-17T16:07:54.683
> 
> 标签：excel, vba

我有一个 Excel 工作簿，用于按项目跟踪任务。每个项目在工作簿中都有自己的工作表。

在每个工作表中，每个工作项都有一行，第一列包含分配工作项的人员姓名。这些行不按名称排序。

我想创建一个工作表，该工作表将自动遍历每个工作表（活动工作表除外）并拉入分配给某个人的所有行。

任何人都知道可以为我解决这个问题的 VBA 宏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:44:34.500

这应该让你开始：

```
Option Explicit

'// change this name to generate a report for a different user //'
Const activeUser = "Alex"

'// change these values to fit your data //'
Const maxTasks = 100
Const maxCols = 10

Public Sub BuildSummary()
    Dim projectIndex As Integer
    Dim projectSheet As Worksheet
    Dim taskIndex As Integer
    Dim summaryRow As Integer

    summaryRow = 1
    For projectIndex = 1 To ActiveWorkbook.Worksheets.Count
        Set projectSheet = ActiveWorkbook.Worksheets(projectIndex)
        If projectSheet.Index <> ActiveSheet.Index Then

            '// insert a row with the name of the project //'
            ActiveSheet.Cells(summaryRow, 1).Value = projectSheet.Name
            summaryRow = summaryRow + 1

            '// search for the active user in each task //'
            For taskIndex = 1 To maxTasks
                If projectSheet.Cells(taskIndex, 2).Value = activeUser Then

                    '// copy the relevant rows to the summary sheet //'
                    projectSheet.Range(projectSheet.Cells(taskIndex, 1), _
                        projectSheet.Cells(taskIndex, maxCols)).Copy
                    ActiveSheet.Range(ActiveSheet.Cells(summaryRow, 1), _
                        ActiveSheet.Cells(summaryRow, maxCols)).Select
                    ActiveSheet.Paste
                    summaryRow = summaryRow + 1
                End If
            Next taskIndex
        End If
    Next projectIndex

    ActiveSheet.Cells(1, 1).Select
End Sub 
```

# c# - 部署具有功能的 webpart

> ID：1008069
> 
> 赞同：0
> 
> 时间：2009-06-17T16:08:07.943
> 
> 标签：c#, sharepoint

如何在功能中部署 Web 部件？

我有我的 webpart 作为 MyWebPart.cs 文件。

我有一个用于其他用途的功能。我只是想知道我是否可以将此 Webpart 与该功能一起部署。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T16:39:22.317

我发现最简单的方法是使用[WSPBuilder](http://www.codeplex.com/wspbuilder)之类的工具。这与 Visual Studio 集成，并允许您创建具有功能的新 Web 部件。

试试这个并合并您已经编写的现有代码和功能。我保证与手动执行所有操作相比，它会为您节省大量时间。

[VSeWSS](http://www.microsoft.com/downloads/details.aspx?FamilyID=B2C0B628-5CAB-48C1-8CAE-C34C1CCBDC0A)也可以完成这项工作，但我从未发现它这么容易使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T21:11:32.500

所以我想你需要帮助来通过一个特性部署一个 webpart。这是如何做到这一点的。

在您的 elements.xml 文件（在功能中）添加一个模块，例如：

```
<Elements  xmlns="http://schemas.microsoft.com/sharepoint/">  
  <Module Name="WebParts" List="113" Url="_catalogs/wp" Path="DWP">
    <File Url="MyWebpart.webpart" Type="GhostableInLibrary">
      <Property Name="Group" Value="MyWebPartGroup"></Property>
    </File>
  </Module>
</Elements> 
```

***路径***(DWP) 是功能中存储实际 .webpart 文件的文件夹，它可能如下所示：

```
<webParts>
  <webPart xmlns="http://schemas.microsoft.com/WebPart/v3">
    <metaData>
      <type name="Full class name, Full 4-part assembly name" />
      <importErrorMessage>Import error message</importErrorMessage>
    </metaData>
    <data>
      <properties>
        <property name="Title" type="string">My webpart</property>
        <property name="Description" type="string">Description of WP</property>
      </properties>
    </data>
  </webPart>
</webParts> 
```

使用 wsp builder 将其打包到 wsp 中，使安全控件和 DLL 部署等变得更加容易，所以使用它...

# asp.net - 遍历 CssStyleCollection

> ID：1008088
> 
> 赞同：1
> 
> 时间：2009-06-17T16:11:21.673
> 
> 标签：asp.net

我正在尝试遍历 ASP.NET 中控件的 Style 属性。这是 CssStyleCollection 类型，在[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.cssstylecollection.aspx)上有一个参考页面。

该页面上有一些示例代码用于遍历集合并获取集合中每个项目的键和值。它看起来像这样：

```
IEnumerator keys = MyText.Style.Keys.GetEnumerator();

while (keys.MoveNext())
{
  String key = (String)keys.Current;
  dr = dt.NewRow();
  dr[0] = key;
  dr[1] = MyText.Style[key];
  dt.Rows.Add(dr);
} 
```

我尝试在代码中使用第一行，但编译器一直说我需要为泛型类型 IEnumerator 指定类型参数。鉴于我正在尝试使用 Microsoft 本身的示例代码，我有点困惑！

有人能帮我遍历 CssStyleCollection 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:31:17.617

尝试如下迭代：

```
foreach (string key in MyText.Style.Keys)
    {
        dr = dt.NewRow();
        dr[0] = key;
        dr[1] = MyText.Style[key];
        dt.Rows.Add(dr);
    } 
```

# c# - C# 获取枚举值

> ID：1008090
> 
> 赞同：31
> 
> 时间：2009-06-17T16:11:37.397
> 
> 标签：c#, .net, string, enums

我有一个包含以下内容的枚举（例如）：

*   英国，
*   美国，
*   法国，
*   葡萄牙

在我的代码中，我使用**Country.UnitedKingdom**但如果我将它分配给一个**字符串**，我希望它的值为**UK**。

 **这可能吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-17T16:14:55.620

您不能将枚举值分配给开头的字符串。您必须调用`ToString()`，这将转换`Country.UnitedKingdom`为“UnitedKingdom”。

两个选项建议自己：

*   创建一个`Dictionary<Country, string>`
*   一个 switch 语句
*   用一个属性装饰每个值，并用反射加载它

对他们每个人的评论...

**示例代码`Dictionary<Country,string>`**

```
using System;
using System.Collections.Generic;

enum Country
{
    UnitedKingdom, 
    UnitedStates,
    France,
    Portugal
}

class Test
{
    static readonly Dictionary<Country, string> CountryNames =
        new Dictionary<Country, string>
    {
        { Country.UnitedKingdom, "UK" },
        { Country.UnitedStates, "US" },
    };

    static string ConvertCountry(Country country) 
    {
        string name;
        return (CountryNames.TryGetValue(country, out name))
            ? name : country.ToString();
    }

    static void Main()
    {
        Console.WriteLine(ConvertCountry(Country.UnitedKingdom));
        Console.WriteLine(ConvertCountry(Country.UnitedStates));
        Console.WriteLine(ConvertCountry(Country.France));
    }
} 
```

您可能希望将逻辑`ConvertCountry`放入扩展方法中。例如：

```
// Put this in a non-nested static class
public static string ToBriefName(this Country country) 
{
    string name;
    return (CountryNames.TryGetValue(country, out name))
        ? name : country.ToString();
} 
```

然后你可以写：

```
string x = Country.UnitedKingdom.ToBriefName(); 
```

正如评论中提到的，默认的字典比较器将涉及拳击，这是不理想的。对于一次性的，我会忍受它，直到我发现它是一个瓶颈。如果我为多个枚举执行此操作，我会编写一个可重用的类。

**切换语句**

我同意[yshuditelu 的回答](https://stackoverflow.com/questions/1008090/c-enum-values/1008116#1008116)，建议在相对较少的情况下使用`switch`声明。但是，由于每种情况都将是一个单独的语句，因此我会针对这种情况亲自更改我的编码风格，以保持代码紧凑但可读：

```
public static string ToBriefName(this Country country) 
{
    switch (country)
    {
        case Country.UnitedKingdom:  return "UK";
        case Country.UnitedStates:   return "US";
        default:                     return country.ToString();
    }
} 
```

您可以为此添加更多案例而不会变得太大，并且很容易将您的视线从枚举值转移到返回值。

**`DescriptionAttribute`**

[Rado](https://stackoverflow.com/questions/1008090/c-enum-values/1008139#1008139)关于可重用代码的观点`DescriptionAttribute`是一个很好的观点，但在这种情况下，我建议不要在每次需要获取值时都使用反射。我可能会编写一个通用静态类来保存一个查找表（可能是一个`Dictionary`，可能带有评论中提到的自定义比较器）。扩展方法不能在泛型类中定义，所以你最终可能会得到类似的东西：

```
public static class EnumExtensions
{
    public static string ToDescription<T>(this T value) where T : struct
    {
        return DescriptionLookup<T>.GetDescription(value);
    }

    private static class DescriptionLookup<T> where T : struct
    {
        static readonly Dictionary<T, string> Descriptions;

        static DescriptionLookup()
        {
            // Initialize Descriptions here, and probably check
            // that T is an enum
        }

        internal static string GetDescription(T value)
        {
            string description;
            return Descriptions.TryGetValue(value, out description)
                ? description : value.ToString();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-06-17T16:22:19.050

我更喜欢在我的枚举上使用[DescriptionAttribute 。](http://msdn.microsoft.com/en-us/library/system.componentmodel.descriptionattribute.aspx)然后，您可以使用以下代码从枚举中获取该描述。

```
enum MyCountryEnum
{    
    [Description("UK")]
    UnitedKingdom = 0,    

    [Description("US")]
    UnitedStates = 1,    

    [Description("FR")]
    France = 2,    

    [Description("PO")]
    Portugal = 3
}

public static string GetDescription(this Enum value)
{
    var type = value.GetType();

    var fi = type.GetField(value.ToString());

    var descriptions = fi.GetCustomAttributes(typeof(DescriptionAttribute), false) as DescriptionAttribute[];

    return descriptions.Length > 0 ? descriptions[0].Description : value.ToString();
}

public static SortedDictionary<string, T> GetBoundEnum<T>() where T : struct, IConvertible
{
    // validate.
    if (!typeof(T).IsEnum)
    {
        throw new ArgumentException("T must be an Enum type.");
    }

    var results = new SortedDictionary<string, T>();

    FieldInfo[] fieldInfos = typeof(T).GetFields();

    foreach (var fi in fieldInfos)
    {

        var value = (T)fi.GetValue(fi);
        var description = GetDescription((Enum)fi.GetValue(fi));

        if (!results.ContainsKey(description))
        {
            results.Add(description, value);
        }
    }
    return results;
} 
```

然后为了得到我的绑定枚举列表，它只是一个调用

```
GetBoundEnum<MyCountryEnum>() 
```

要获取单个枚举的描述，您只需使用这样的扩展方法

```
string whatever = MyCountryEnum.UnitedKingdom.GetDescription(); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-17T16:17:13.683

您可以创建一个扩展方法`public static string ToShortString(this Country country)`。在该方法中，您可以使用 Jon 建议的静态 Dictionary，也可以简单地使用 switch case。

例子：

```
public static class CountryExtensions
{
    public static string ToShortString( this Country target )
    {
        switch (target) {
            case Country.UnitedKingdom:
                return "UK";
            case Country.UnitedStates:
                return "US";
            case Country.France:
                return "FR";
            case Country.Portugal:
                return "PT";
            default:
                return "None";
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-17T16:16:46.303

伪代码：

```
enum MyCountryEnum
{
    UnitedKingdom = 0,
    UnitedStates = 1,
    France = 2,
    Portugal = 3,
}

string[] shortCodes = new string[] {"UK", "US", "FR", "PO"};

MyCountryEnum enumValue = MyCountryEnum.UnitedKingdom;
string code = shortCodes[enumValue]; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T16:47:38.117

另一种未提及的可能性是这样的：

```
public class Country
{
    public static readonly Country UnitedKingdom = new Country("UK");
    public static readonly Country UnitedStates = new Country("US");
    public static readonly Country France = new Country("FR");
    public static readonly Country Protugal = new Country("PT");

    private Country(string shortName)
    {
        ShortName = shortName;
    }

    public string ShortName { get; private set; }
} 
```

从这一点开始，您可以添加更多属性，但要注意向类添加了多少，以及添加了多少静态成员，因为它添加的内存膨胀可能会使其不值得。

我不认为在很多情况下这种策略是最好的方法，但在尝试将属性或属性添加到您希望能够本质上视为枚举的东西时，这是一个需要注意的选项。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-02T09:20:27.447

我不得不暂时离开这个项目的工作，然后回到它，我有片刻的灵感。

我创建了一个像这样的新类，而不是枚举：

```
public class Country
{
    public const string UnitedKingdom = "UK";
    public const string France = "F";
} 
```

这样我就可以在我的代码中使用 Country.UnitedKingdom 并且将使用值“UK”。

我只是发布这个答案作为替代解决方案。

尼尔

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-17T16:21:07.600

只需使用[DescriptionAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.descriptionattribute(VS.71).aspx)

如果您只需要获取枚举值的字符串表示形式，则无需创建字典。看这个[例子](http://blog.waynehartman.com/articles/84.aspx)

[编辑] 哦......忘了提到它比字典更可重用，因为您只需要一个通用 util 类来帮助获取描述，然后您需要做的就是在下次添加枚举值时添加 DescriptionAttribute或者您创建一个具有相同要求的新枚举。在字典/开关解决方案中，一旦你有许多枚举类型，它就更难维护并且变得混乱。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-01-28T05:50:02.280

我试图提交对 Scott Ivey 答案的编辑，但被拒绝了，这是另一个答案。我相对较小的编辑：

1) 我修复了 Alex 的`System.ArgumentException: Field 'value__' defined on type 'MyClass.EnumHelperTest+MyCountryEnum' is not a field on the target object which is of type 'System.Reflection.RtFieldInfo'.`Got it from [here](http://www.distribucon.com/blog/GettingMembersOfAnEnumViaReflection.aspx)错误。

2）添加了一个`return`，这样你就可以实际复制/粘贴它并且它会起作用。

3) 将 SortedDictionary 更改为 Dictionary，因为 SortedDictionary 总是按键排序，在本例中为字符串 Description。没有理由按字母顺序排列描述。事实上，对它进行排序会破坏枚举的原始顺序。Dictionary 也不保留枚举顺序，但至少它不像 SortedDictionary 那样暗示顺序。

```
enum MyCountryEnum
{    
    [Description("UK")]
    UnitedKingdom = 0,    

    [Description("US")]
    UnitedStates = 1,    

    [Description("FR")]
    France = 2,    

    [Description("PO")]
    Portugal = 3
}

public static string GetDescription(this Enum value)
{
    var type = value.GetType();

    var fi = type.GetField(value.ToString());

    var descriptions = fi.GetCustomAttributes(typeof(DescriptionAttribute), false) as DescriptionAttribute[];

    return descriptions.Length > 0 ? descriptions[0].Description : value.ToString();
}

public static Dictionary<string, T> GetBoundEnum<T>() where T : struct, IConvertible
{
    // validate.
    if (!typeof(T).IsEnum)
    {
        throw new ArgumentException("T must be an Enum type.");
    }

    var results = new Dictionary<string, T>();

    FieldInfo[] fieldInfos = typeof(T).GetFields(BindingFlags.Public | BindingFlags.Static);

    foreach (var fi in fieldInfos)
    {

        var value = (T)fi.GetValue(fi);
        var description = GetDescription((Enum)fi.GetValue(fi));

        if (!results.ContainsKey(description))
        {
            results.Add(description, value);
        }
    }
    return results;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-17T16:25:36.163

每当我看到一个枚举时，我都觉得应该重构代码。为什么不创建一个 Country 类并添加方法来解决您试图绕过的一些障碍。给枚举赋值是一种更大的代码味道。

为什么投反对票？我认为使用多态方法比使用枚举更好，这一点已被广泛接受。当您可以改用 ValueObject 设计时，使用枚举的理由为零。

这是关于该主题的一篇很好的博客文章：http: [//devpinoy.org/blogs/cruizer/archive/2007/09/12/enums-are-evil.aspx](http://devpinoy.org/blogs/cruizer/archive/2007/09/12/enums-are-evil.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-17T16:22:10.267

```
var codes = new Dictionary<Country, string>() 
        { { Country.UnitedKingdom, "UK" },
        { Country.UnitedStates, "US" },
        { Country.France, "FR" } };
Console.WriteLine(codes[Country.UnitedStates]); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-17T16:38:12.553

以下解决方案有效（编译并运行）。我看到两个问题：

1.  您必须确保枚举是同步的。（自动化测试可以为您做到这一点。）

2.  您将依赖枚举在 .NET 中不是类型安全的事实。

    ```
    enum Country
    {
        UnitedKingdom = 0,
        UnitedStates = 1,
        France = 2,
        Portugal = 3
    }

    enum CountryCode
    {
        UK = 0,
        US = 1,
        FR = 2,
        PT = 3
    }

    void Main()
    {
        string countryCode = ((CountryCode)Country.UnitedKingdom).ToString();
        Console.WriteLine(countryCode);
        countryCode = ((CountryCode)Country.Portugal).ToString();
        Console.WriteLine(countryCode);
    } 
    ```**

# c# - 如何让 NLog 写入数据库

> ID：1008093
> 
> 赞同：39
> 
> 时间：2009-06-17T16:12:09.783
> 
> 标签：c#, web-config, nlog

我试图让 NLog 记录到我的数据库日志表中，但无济于事。我确定我的连接字符串是正确的，因为它与我的 web.config 中其他地方使用的相同。写入文件工作正常，所以我知道这不仅仅是 NLog，而且一定是我做错了。下面是我的 NLog 配置：

```
<!-- NLOG CONFIGURATION -->
  <nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <targets>
      <target name="file" xsi:type="File" fileName="${basedir}/logs/Log ${shortdate}.txt" layout="${longdate} ${callsite} ${level}: ${message} ${exception:format=Message,StackTrace} ${stacktrace}" />
      <target type="Database" name="database" connectionstring="MyConnectionString">
        <commandText>
          insert into MyLog ([CreateDate], [Origin], [LogLevel], [Message], [Exception], [StackTrace]) values (@createDate, @origin, @logLevel, @message, @exception, @stackTrace);
        </commandText>
        <parameter name="@createDate" layout="${longdate}"/>
        <parameter name="@origin" layout="${callsite}"/>
        <parameter name="@logLevel" layout="${level}"/>
        <parameter name="@message" layout="${message}"/>
        <parameter name="@exception" layout="${exception:format=Message,StackTrace}"/>
        <parameter name="@stackTrace" layout="${stacktrace}"/>
      </target>
    </targets>
    <rules>
      <logger name="*" writeTo="file"/>
      <logger name="*" appendTo="database"/>
      <!--<logger name="*" writeTo="mail" minlevel="Error"/>-->
    </rules>
  </nlog> 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-06-17T16:19:48.643

尝试将以下内容放入您的 nlog 标记中：

```
<nlog throwExceptions="true" internalLogFile="c:\nlog.txt" internalLogLevel="Debug" /> 
```

这可能有助于确定问题所在

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T16:17:21.110

NLog 允许记录框架本身的内部。

为 NLog启用“[内部日志记录的调试级别](https://github.com/NLog/NLog/wiki/Internal-Logging)”，看看出了什么问题。

# java-me - j2me 闪屏

> ID：1008098
> 
> 赞同：1
> 
> 时间：2009-06-17T16:13:53.030
> 
> 标签：java-me, splash-screen

如何为我的 j2me 应用程序构建基于图像的启动画面？

我已经有一个应用程序，我需要一个启动屏幕来附加它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T16:16:50.407

J2ME 没有默认的“启动屏幕”方法，它只显示一张图片几秒钟，然后继续下一个显示。如果你真的想要，你可以利用时间在后台加载一些其他的东西。

[这是 Sun 关于启动画面的教程](http://java.sun.com/developer/J2METechTips/2001/tt0820.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T19:07:07.803

你可以使用这样的东西：

```
class SplashScreenSwitcher extends Thread {  

    private Display display;
    private Displayable splashScreen;
    private Displayable nextScreen;

    public SplashScreenSwitcher(Display display, Displayable splashScreen, Displayable nextScreen) {
         this.display = display;
         this.splashScreen = splashScreen;
         this.nextScreen = nextScreen;
    }

    public void run() {
         display.setCurrent(splashScreen);
         try {
              Thread.sleep(2000); //Here you set needed time or make a constant
         } catch (Exception ex) {}
         display.setCurrent(nextScreen);
    }
} 
```

所以，你所做的只是创建这个类的一个新实例并启动线程。

# c# - SharePoint SPSite 处理

> ID：1008099
> 
> 赞同：4
> 
> 时间：2009-06-17T16:13:53.717
> 
> 标签：c#, sharepoint, dispose, spsite

我的场景是在 SPJobDefinition 的 Execute 方法中，我想遍历 Web 应用程序中的每个 SPSite。所以我有以下代码：

```
foreach (SPSite site in this.WebApplication.Sites)
{
  ...
} 
```

问题是，我需要处理每个站点吗？我通常遵循的规则是仅在我自己新建时才将其处理或放入 using 中。Sites 属性是否实际上包含完整构造的站点对象，我将在此代码中仅引用它。如果是这样，那么处置这些站点将是危险的，因为我正在修改另一个可能需要它们的对象。或者相反的是 Sites 属性是否根据请求构造对象。在这种情况下，我有责任处理它们吗？

另外，如果我确实需要这样做，我该如何处理它们。在这种情况下我不能使用 using ，并且在 foreach 中调用 dispose 会破坏枚举吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T16:34:42.430

是的你是。[请参阅最佳实践：使用 SharePoint 对象模型时的常见编码问题](http://msdn.microsoft.com/en-us/library/bb687949.aspx#WSS3CodingSharePointOM_CodeNotWrittentobeScalable)中的“编写可扩展到大量用户的应用程序” 。正确的模式是：

```
foreach (SPSite site in this.WebApplication.Sites)
{
  try
  {
    ...
  }
  finally
  {
    site.Dispose();
  }
} 
```

调用 dispose 不会破坏枚举。它只是清理对象使用的非托管内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T10:28:34.580

这里的指导 [http://www.sharepointdevwiki.com/display/public/When+to+Dispose+SharePoint+objects](http://www.sharepointdevwiki.com/display/public/When+to+Dispose+SharePoint+objects)

表明

```
//loop through each sub site
for (int i = 0; i <= rootweb.Webs.Count; i++)
{
  using (SPWeb subweb = rootweb.Webs[i])
  {
    //do stuff
  }
} 
```

是这个问题的首选解决方案。

还有一个工具可以让你在你的解决方案上运行，以检查你是否做对了。 [http://code.msdn.microsoft.com/SPDisposeCheck](http://code.msdn.microsoft.com/SPDisposeCheck)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T23:20:24.147

看这里 -[最佳实践：使用一次性 Windows SharePoint Services 对象](http://msdn.microsoft.com/en-us/library/aa973248.aspx)

# javascript - 'this' 对项目的引用在 ie 中点击错误

> ID：1008103
> 
> 赞同：1
> 
> 时间：2009-06-17T16:14:07.397
> 
> 标签：javascript, internet-explorer-7, prototypejs

对于下面的代码，我在 IE 中遇到了一些问题。传递给函数的第二个参数应该是对单击的项目的引用。这在 FF 和 Safari 中运行良好，但是当我在 IE7 中测试它时出错。IE 似乎获取了该元素（如控制台中所示），但每当我尝试对它做任何事情时，我都会收到错误消息：

“对象不支持此属性或方法”

谢谢您的帮助。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
</head>
<body>  
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/prototype/1.6.0.3/prototype.js"></script>
<script type='text/javascript' src='http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js'></script>   
<script language="javascript" type="text/javascript">   
    var Test = {            
        doIt: function(str, btn) {  
            console.log(str);
            console.log(btn);               
            if (btn.hasClassName('red')) {
                console.log('has red');         
            } else {
                console.log('doesn\'t');
            }           
        }   
    };  
</script>   
<a href="#" onClick="Test.doIt('hello', this)" class="red">Test</a> 
</body></html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T16:19:34.870

问题是 btn 没有自动拥有该方法`hasClassName`- 这是一个原型扩展。

要[使用原型扩展函数扩展您的元素，请](http://www.prototypejs.org/api/utility/dollar)在顶部添加以下行 `doIt()`：

```
btn = $(btn); // Extends element with Prototype functions. 
```

您的代码应该从那里开始工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T16:19:38.443

这是因为在使用 Prototype 时，在 IE 中加载页面时，不会使用 Prototype 函数自动扩展元素，它们特别必须通过`$()`调用来使用这些方法扩展元素。将此添加到函数的顶部以使其在 IE 中工作。

```
doIt : function(str, btn) {
    btn = $(btn);
} 
```

**编辑：**澄清一下，在 IE 7 (iirc) 及以下 HTML 元素以外的所有浏览器中，HTML 元素将自动进行原型设计，但在 IE <= 7 中，它们必须通过该`$()`函数才能应用这些原型。

# jquery-ui - Jquery Tabs：微调器选项不起作用

> ID：1008110
> 
> 赞同：4
> 
> 时间：2009-06-17T16:15:14.107
> 
> 标签：jquery-ui, jquery

当远程页面加载到选项卡中时，我需要一个 ajax 动画。

我在用

```
$('#tabs2').tabs({ spinner: ''<img src="../../Content/images/Jquery/spinner.gi'' }); 
```

甚至`$('#tabs2').tabs({ spinner: 'Loading..' });`也不行...

虽然选项卡功能正在运行，但动画不起作用......

我正在使用 JQuery 主题滚轮文件。非常感谢您的帮助。非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T15:13:45.193

抱歉问题解决了。我在`<span>`标签中放了一个标签。在 Jquery 支持讨论中找到了解决方案。[http://docs.jquery.com/Discussion](http://docs.jquery.com/Discussion)

例如

```
<li><a href="../URL">**<span>Text to display in Tabs</span></a></li>
<li><a href="tabdiv">**<span>Text to display in Tabs</span></a></li> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-06T20:14:16.093

如果微调器不适合你（它不适合我），试试这个：

```
$("#tabs").tabs({ 
                beforeLoad: function (event, ui) {
                    ui.panel.text('Retrieving data...');
                }
            }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T16:31:42.273

发布的第一个代码片段看起来不正确。它应该是：

```
$('#tabs2').tabs({ spinner: '<img src="../../Content/images/Jquery/spinner.gif"/>' }); 
```

假设“#tabs2”指的是容器选项卡而不是单个选项卡之一，第二个片段应该可以正常工作。

请编辑您的问题并发布标签的相关 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T16:33:12.087

jquery.ui 选项卡的微调器选项仅在使用 ajax 加载远程内容时使用。您确定您使用的是 ajax 模式，而不是简单地使用标签显示和隐藏页面上的现有内容吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-22T18:07:48.903

我无法弄清楚答案是什么，所以再一次，如果有人也无法弄清楚。

在加载过程中不是选项卡的内容被替换，而是选项卡标题。您需要做的就是将标签标题放入跨度标签

前：

```
<ul >
 <li><a href="link.html" >Users</a></li>
</ul> 
```

后

```
<ul >
 <li><a href="link.html" ><span>Users</span></a></li>
</ul> 
```

选项卡标题必须用 span 包围，如您所见，用户变为`<span>Users</span>`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-19T02:43:35.620

在选项卡链接的文本周围添加一个可以解决问题。Sumanta 的解决方案是正确的，但我不确定您是否需要其中的两个星号。

# c# - 获取远程服务器的准确时间

> ID：1008111
> 
> 赞同：7
> 
> 时间：2009-06-17T16:15:17.910
> 
> 标签：c#, .net, time

在 C# 中，如何查询远程服务器的当前时间？

类似的功能

```
net time \\servername 
```

但返回一个包含秒数的日期戳。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T16:21:09.690

您可以使用[NetRemoteTOD](http://msdn.microsoft.com/en-us/library/aa370612(VS.85).aspx)功能。

[来自http://bytes.com/groups/net-c/246234-netremotetod-usage](http://bytes.com/groups/net-c/246234-netremotetod-usage)的示例：

```
// The pointer.
IntPtr pintBuffer = IntPtr.Zero;

// Get the time of day.
int pintError = NetRemoteTOD(@"\\sony_laptop", ref pintBuffer);

// Get the structure.
TIME_OF_DAY_INFO pobjInfo = (TIME_OF_DAY_INFO)
Marshal.PtrToStructure(pintBuffer, typeof(TIME_OF_DAY_INFO));

// Free the buffer.
NetApiBufferFree(pintBuffer); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T16:19:04.043

您可以尝试在端口 13 上获取白天：

```
System.Net.Sockets.TcpClient t = new System.Net.Sockets.TcpClient ("yourmachineHOST", 13);
System.IO.StreamReader rd = new System.IO.StreamReader (t.GetStream ()); 
Console.WriteLine (rd.ReadToEnd ());
rd.Close();
t.Close(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-10-27T03:50:31.383

下面是一个更完整的实现。

用法：`DateTime? now = RemoteTOD.GetNow(@"\\ServerName");`

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;

//https://docs.microsoft.com/en-us/windows/desktop/api/lmremutl/nf-lmremutl-netremotetod
public static class RemoteTOD {

    // Important: CharSet must be Unicode otherwise error 2184 is returned
    [DllImport("netapi32.dll", SetLastError=true, CharSet=CharSet.Unicode)]
    private static extern int NetRemoteTOD(String UncServerName, ref IntPtr BufferPtr);

    [DllImport("netapi32.dll")]
    private static extern void NetApiBufferFree(IntPtr bufptr);

    public static DateTime? GetNow(String serverName, bool throwException = false) {
        IntPtr ptrBuffer = IntPtr.Zero;
        int result = NetRemoteTOD(serverName, ref ptrBuffer);
        if (result != 0) {
            if (throwException)
                throw new Win32Exception(Marshal.GetLastWin32Error());
            return null;
        }

        TIME_OF_DAY_INFO tod = (TIME_OF_DAY_INFO) Marshal.PtrToStructure(ptrBuffer, typeof(TIME_OF_DAY_INFO));
        NetApiBufferFree(ptrBuffer); // must be freed using NetApiBufferFree according to the documentation

        //DateTime d0 = new DateTime(1970,1,1);
        //d0 = d0.AddSeconds(tod.elapsedt);
        DateTime nowUtc = new DateTime(tod.year, tod.month, tod.day, tod.hour, tod.minute, tod.second, 10 * tod.hunds);
        DateTime now = nowUtc.ToLocalTime();
        return now;
    }
}

[StructLayout(LayoutKind.Sequential)]
public struct TIME_OF_DAY_INFO {

    ///<summary>The number of seconds since 00:00:00, January 1, 1970, GMT.</summary>
    public int elapsedt;

    ///<summary>The number of milliseconds from an arbitrary starting point (system reset). Typically, this member is read twice,
    ///once when the process begins and again at the end. To determine the elapsed time between the process's start and finish,
    ///you can subtract the first value from the second.</summary>
    public int msecs;

    ///<summary>The current hour. Valid values are 0 through 23.</summary>
    public int hour;

    ///<summary>The current minute. Valid values are 0 through 59.</summary>
    public int minute;

    ///<summary>The current second. Valid values are 0 through 59.</summary>
    public int second;

    ///<summary>The current hundredth second (0.01 second). Valid values are 0 through 99.</summary>
    public int hunds;

    ///<summary>The time zone of the server. This value is calculated, in minutes, from Greenwich Mean Time (GMT). For time zones
    ///west of Greenwich, the value is positive; for time zones east of Greenwich, the value is negative. A value of –1 indicates
    ///that the time zone is undefined.</summary>
    public int timezone;

    ///<summary>The time interval for each tick of the clock. Each integral integer represents one ten-thousandth second (0.0001 second).</summary>
    public int tinterval;

    ///<summary>The day of the month. Valid values are 1 through 31.</summary>
    public int day;

    ///<summary>The month of the year. Valid values are 1 through 12.</summary>
    public int month;

    ///<summary>The year.</summary>
    public int year;

    ///<summary>The day of the week. Valid values are 0 through 6, where 0 is Sunday, 1 is Monday, and so on.</summary>
    public int weekday;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T16:22:03.760

Windows 时间服务实现 NTP。这是[NTP 客户端的 C# 实现](http://dotnet-snippets.com/dns/c-simple-network-time-ntp-protocol-client-SID571.aspx)。使用它的 Windows GUI 可以在[Simple Network Time Protocol Client](http://www.bocan.ro/sntpclient)中找到。这是瓦勒·博坎的作品。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-11T11:39:38.090

使用 Reed Copsey (& David Laing) 答案中的[C# NTP 客户端](http://dotnet-snippets.com/dns/c-simple-network-time-ntp-protocol-client-SID571.aspx)，您可以使用以下方法从域控制器/NTP 服务器获取时间“现在”标记（以毫秒为单位）：

```
InternetTime.SNTPClient sntp = new InternetTime.SNTPClient("ntp1.ja.net");
sntp.Connect(false); // true to update local client clock
DateTime dt = sntp.DestinationTimestamp.AddMilliseconds(sntp.LocalClockOffset);
string timeStampNow = dt.ToString("dd/MM/yyyy HH:mm:ss.fff"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-10T08:16:48.723

[简单网络时间协议客户端](http://www.bocan.ro/sntpclient)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-25T16:25:06.703

**如果您可以使用 UNC 路径访问远程系统的文件系统**（例如`\\remotehost\foo\bar`; 例如使用 Windows Explorer），您可以使用以下解决方法检索远程日期时间，**即使它不是 Windows 系统也是如此。**创建一个虚拟文件，读取它的写入时间并将其丢弃。它也适用于本地主机。

```
public DateTime filesystemDateTime(string path)
{
    //create temp file
    string tempFilePath = Path.Combine(path, "lampo.tmp");
    using (File.Create(tempFilePath)) { }
    //read creation time and use it as current source filesystem datetime
    DateTime dt = new FileInfo(tempFilePath).LastWriteTime;
    //delete temp file
    File.Delete(tempFilePath);

    return dt;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-27T11:03:07.233

```
class RemoteSystemTime 
    {
        static void Main(string[] args)
        {
            try
            {
                string machineName = "vista-pc";

                System.Diagnostics.Process proc = new System.Diagnostics.Process();
                proc.StartInfo.UseShellExecute = false;
                proc.StartInfo.RedirectStandardOutput = true;
                proc.StartInfo.FileName = "net";
                proc.StartInfo.Arguments = @"time \\" + machineName;
                proc.Start();
                proc.WaitForExit();

                List<string> results = new List<string>();
                while (!proc.StandardOutput.EndOfStream)
                {
                    string currentline = proc.StandardOutput.ReadLine();
                    if (!string.IsNullOrEmpty(currentline))
                    {
                        results.Add(currentline);
                    }
                }

                string currentTime = string.Empty;
                if (results.Count > 0 && results[0].ToLower().StartsWith(@"current time at \\" +                                               machineName.ToLower() + " is "))
                {
                    currentTime = results[0].Substring((@"current time at \\" + machineName.ToLower() + " is                             ").Length);

                    Console.WriteLine(DateTime.Parse(currentTime));
                    Console.ReadLine();
                }

            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
                Console.ReadLine();
            }
        } 
```

# msbuild - 巡航控制 - 如何在巡航控制中执行批处理文件以及如何使用巡航控制在不同的文件夹中发布

> ID：1008118
> 
> 赞同：1
> 
> 时间：2009-06-17T16:17:23.763
> 
> 标签：msbuild, cruisecontrol.net, batch-file

1.在巡航控制中执行批处理文件时出现以下错误：

```
<exception><![CDATA[ThoughtWorks.CruiseControl.Core.Tasks.BuilderException: Command Line Build timed out (after 600 seconds) 
```

我使用的代码是

```
 <exec>
    <executable>D:\DITBUILT.bat</executable>
 </exec> 
```

2.我想使用巡航控制在不同的文件夹中发布..我正在使用代码...我无法在不同的文件夹中发布

```
<executable>C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\MSBuild.exe</executable>
<workingDirectory>D:\Cas_CC\SourceCode\PolandSME-MAIN\SRC\UI</workingDirectory>
<projectFile>CAS.sln</projectFile>
<buildArgs> /p:Configuration=Release /p:Platform="Any CPU" </buildArgs>      
<targets>Build</targets>
<logger>ThoughtWorks.CruiseControl.MsBuild.XmlLogger,D:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll</logger> 
```

请帮帮我

1.  如何使用巡航控制在不同的文件夹中发布
2.  如何使用巡航控制执行批处理文件...

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T19:31:30.113

使用 cmd.exe 作为可执行文件并使用“/c D:\DITBUILT.bat”作为参数可以解决您在批处理文件中遇到的错误？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-04T13:27:12.817

我建议使用带有 NANT 的巡航控制。

```
<tasks>
      <nant>
        <executable>C:\Nant\Nant0.86\bin\nant.exe</executable>
        <baseDirectory>.</baseDirectory>
        <buildFile>C:\NANT_SCRIPTS\build.xml</buildFile>
        <targetList>
          <target>YourProject_Publish</target>
        </targetList>
        <buildTimeoutSeconds>2000</buildTimeoutSeconds>
      </nant>
    </tasks> 
```

在您的 build.xml 文件中，您可以使用 NANT 命令来执行您的 bat 文件或几乎执行其他任何操作。它也支持 3.5 框架。

```
 <exec program="C:\NANT_SCRIPTS\publish\YourProject.bat" />
    <delete dir="${web01}\yourSite.com\WebFolder" />
    <copy todir="${web01}\yourSite.com\WebFolder" >
      <fileset basedir="C:\CruiseControl\ProjectFolders\YourProject\Website" >
        <include name="*.aspx" />
        <include name="*.config" />
        <include name="*.master" />
        <include name="*.asax" />
        <include name="*.ascx" />
        <include name="*.sitemap" />
      </fileset>
    </copy> 
```

# c++ - 代码块的 Boost 库设置

> ID：1008119
> 
> 赞同：5
> 
> 时间：2009-06-17T16:17:27.177
> 
> 标签：c++, ide, codeblocks

如何在 Codeblocks(Windows) 中使用 boost 库？从 boost 站点下载库后我需要做什么？任何想法，建议，指针？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T16:26:00.670

以下是使用 Code::Blocks 设置 Boost的[说明](http://wiki.codeblocks.org/index.php?title=BoostWindowsQuickRef)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:21:56.337

对于只有 Boost 类的头文件（这是大多数类），您需要做的就是将 Boost inclide 目录的基础添加到项目的包含路径中。该目录将被称为 boost_1_37_0 之类的名称。然后你可以这样说：

```
#include <boost/shared_ptr.hpp> 
```

对于实际需要编译库的 Boost 设备，您可能需要查看[http://nuwen.net/mingw.html](http://nuwen.net/mingw.html)，它提供了一个完整的 MinGW 环境，包括 Boost 和其他一些有用的东西。

# java - 用于调试和错误的不同 log4j 布局？

> ID：1008122
> 
> 赞同：6
> 
> 时间：2009-06-17T16:18:50.783
> 
> 标签：java, configuration, logging, log4j

在 log4j 中，有没有办法让 logger.error("") 和 logger.debug("") 包含不同的输出布局？

我希望错误包括方法名称和行号，这两者都会降低应用程序的性能。

编辑：

添加 apache-log4j-extras 后，以下配置文件有效。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd" >

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">

    <appender name="WARNINGS" class="org.apache.log4j.DailyRollingFileAppender">
        <param name="File" value="warnings.log"/>
        <param name="DatePattern" value="'.'yyyy-MM-dd"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d{yyyy-MMM-dd HH:mm:ss} %-5p %c - %m%n%n"/>
        </layout>
        <filter class="org.apache.log4j.filter.LevelRangeFilter">
            <param name="LevelMin" value="DEBUG"/>
            <param name="LevelMax" value="WARN"/>
        </filter>
    </appender>

    <appender name="ERRORS" class="org.apache.log4j.DailyRollingFileAppender">
        <param name="File" value="errors.log"/>
        <param name="DatePattern" value="'.'yyyy-MM-dd"/>
        <layout class="org.apache.log4j.PatternLayout">
            <!-- %M for method name , %L for line number  -->
            <param name="ConversionPattern" value="%d{yyyy-MMM-dd HH:mm:ss} %-5p %c %M %L - %m%n%n"/>
        </layout>
        <filter class="org.apache.log4j.filter.LevelRangeFilter">
            <param name="LevelMin" value="ERROR"/>
            <param name="LevelMax" value="FATAL"/>
        </filter>
    </appender>

    <logger name="com.foo.bar">
        <appender-ref ref="WARNINGS"/>
        <appender-ref ref="ERRORS"/>
    </logger>

</log4j:configuration> 
```

此代码用于测试

```
// goes to errors.txt
     log.error("error");
//goes to warnings.txt
     log.warn("warn"); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T16:30:31.620

在您的 log4j.xml 配置中，您可以创建两个附加程序，每个附加程序使用一个[LevelMatchFilter](https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/varia/LevelMatchFilter.html)，每个附加程序都有一个单独的模式输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T16:26:35.117

我只会设置两个不同的记录器。一个叫ERROR，一个叫DEBUG。然后您可以轻松设置不同的输出布局，并且只调用 ERROR.error 或 DEBUG.debug。

# javascript - 如何通过 Javascript 在 Flowplayer 中更改视频（并立即开始播放）？

> ID：1008125
> 
> 赞同：4
> 
> 时间：2009-06-17T16:19:08.863
> 
> 标签：javascript, flowplayer

无论当前是否加载和播放视频，它都应该更改视频并开始播放。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T16:57:26.520

请参阅下面的示例，其中 api 是您的 flowplayer 实例，而 replaceclip 是您要开始电镀的实例

```
var api = flashembed("player", {src:'FlowPlayerDark.swf'}, {config: ...}});
var replaceclip = {'url':'myvideo.mp4', 'autoplay':true};

<button onClick="api.playClip(replaceclip)">Play</button> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T03:40:40.400

在 Github 中查看我的示例[https://github.com/Teaonly/android-eye/blob/master/assets/droideye.js](https://github.com/Teaonly/android-eye/blob/master/assets/droideye.js)

```
var initAudioPlayer = function () {
    // install flowplayer into container
    // http://flash.flowplayer.org/

    $f("player", "flowplayer-3.2.15.swf", {
        plugins: {
            controls: {
                fullscreen: false,
                height: 30,
                autoHide: false,
                play: false,
            }
        },
        clip: {
            autoPlay: false,
            url: "stream/live.mp3",
        }
    });

    audioPlayer = $f();
};

var newClip = {'url':'stream/live.mp3?id='+audioCount,'autoplay':true};
audioCount ++;
audioPlayer.play(newClip); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-09T17:12:41.080

```
 $f().play([{url:'yourmovie.flv'}]); 
```

通过这种方式，您可以在 Ajax 中动态更改视频。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T16:59:46.423

[您可以在此处查看](http://flowplayer.org/documentation/api/index.html)flowplayer 的 javascript api

具体来说，您可能需要查看 flowplayer 对象“Clip”和“Player”

# c++ - XXX.exe 不是有效的 Win32 应用程序

> ID：1008126
> 
> 赞同：2
> 
> 时间：2009-06-17T16:19:17.193
> 
> 标签：c++, 64-bit, windows-server-2008

配置：Windows 服务器 2008 x64。

软件是跨平台c++ 64位。

以前的安装程序默认要求用户安装到

c:\Program 文件 (x86)\company\version

对于上一个版本，我使用路径覆盖更改了安装程序以安装到

c:\Program Files\公司\版本

为我们做测试的人说，新安装到 c:\Program Files\ 子进程不会启动。覆盖安装到 c:\Program Files (x86)\xxx 一切运行正常。转到 cmd.exe 并从 C:\Program Files\xxx 运行会给出“yyy.exe 不是有效的 Win32 应用程序”错误。同样，这不是 c:\Program Files (x86) 的问题。

客户也安装到默认位置并得到相同的错误。

我的构建/开发机器没有显示任何这些错误。它运行服务器 2008（和 Visual Studio Express）的演示版本，从不更新，也从不重新启动。

附加在 Program Files 上的“x86”有什么特别之处吗？

笔记：

这在我的开发机器上不是问题，它也是服务器 2008 x86_64。

dubin /headers 清楚地表明这些程序是 64 位的。

在这一点上没有答案。解决方法是只安装到 Program Files (x86) 或其他地方并完成它。将放入一个用户不应安装到 Program Files 的常见问题解答（如果内容变为核，他们将查看常见问题解答）。

这可能是安装程序的问题，它可能是“quack.exe”的经典案例，但适用于“程序文件”。我通常讨厌窗户是有充分理由的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T16:40:42.833

Program Files (x86) 目录是安装 32 位程序的位置。当运行 32 位应用程序时，%ProgramFiles% 环境变量[设置](http://msdn.microsoft.com/en-us/library/aa384274.aspx)为 C:\Program Files (x86)\（默认情况下；这实际上可能位于不同的驱动器上）。

你确定这个程序被编译为 64 位吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:07:29.037

也许exe在该特定配置中以某种方式在32位中找到了一个dll？例如，当某人设法用 32 位 dll 弄乱他的 64 位目录时。

请记住，未加载库的 dll 也会在启动时加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:37:47.327

我认为这与应用程序的清单有关。你有没有以某种方式改变这个？当我在编译器之间来回切换时，我遇到了同样的错误。vc9 (vs2008) 创建了一个清单，当我们在 .net 2003 上编译时，我们通常不会使用它。

# biztalk - BizTalk Server 的市场前景如何？

> ID：1008132
> 
> 赞同：1
> 
> 时间：2009-06-17T16:20:25.073
> 
> 标签：biztalk

我正在公司接受 BizTalk 服务器培训。

我在 Microsoft 和开源（如 PHP）方面拥有近 6 年的经验，主要是在 Web 应用程序中。

为我未来的职业学习 Biztalk 服务器是否有意义？

简而言之，它会帮助我改善我的个人资料吗？

请建议/建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:24:49.333

学习任何活跃且充满活力的技术都将对您和您的事业有所帮助。我看不出这在任何方面都可以被定性为负面因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:37:00.107

即使这个特定的产品不再使用，了解它打算解决的问题和一般方法也是有用的。不过，不要太在意细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T11:20:54.007

我从事 BizTalk 服务器开发已有多年，它无疑帮助我成为 SOA / Contract first / Loosley 耦合应用程序风潮的早期采用者，这种风潮席卷了整个行业……为什么？好吧，因为作为 BizTalk 开发人员，我们一直在做这些事情。这对我们来说并不新鲜。

所以是的，学习它。它根本不会对您造成任何伤害！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T01:12:27.040

您可能想查看[BizTalk Server 2009 中的新功能](http://www.microsoft.com/biztalk/en/us/whats-new.aspx)。它还没有死。

# sql - 如何使用 SQL 查询汇总访问次数？

> ID：1008136
> 
> 赞同：0
> 
> 时间：2009-06-17T16:20:59.423
> 
> 标签：sql, date, time, count

我正在尝试过滤 SQL 数据库。

每行代表一个用户，我关注的主列标题为 last_visited 并格式化为… 2009-06-17 12:15:32。

过去一天/一周/一个月有多少用户访问过？

像：

```
SELECT COUNT(*) AS USERS_TODAY
FROM parts_users
Where updated_at > (NOW()-7) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T16:22:27.957

那么是列文本还是日期时间？如果是前者：

```
SELECT COUNT(*) AS USERS_TODAY 
FROM parts_users
WHERE CONVERT(datetime, updated_at, 120) > DATEADD(day, -7, GETDATE()) 
```

如果是后者，则省略 CONVERT。

或者，您可能会发现类似的东西很有用：

```
SELECT CONVERT(datetime, LEFT(updated_at, 10), 120) AS DATE_ONLY,
       COUNT(*) AS USERS_TODAY 
FROM parts_users
WHERE CONVERT(datetime, updated_at, 120) > DATEADD(day, -7, GETDATE())
GROUP BY CONVERT(datetime, LEFT(updated_at, 10), 120) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:41:23.707

[如何在 iReport 中使用 SQL 查询同一项目的多个 SUM](https://stackoverflow.com/questions/1002639/how-to-query-multiple-sums-of-the-same-item-using-sql-in-ireport/1002660#1002660)

```
SELECT
  SUM(case when (NOW()-1) <= datetime then 1 else 0 end) as 'today',
  SUM(case when (NOW()-7) <= datetime then 1 else 0 end) as 'thisweek',
  COUNT(*) as 'thismonth'
FROM
  table
WHERE
  (NOW()-30) <= datetime AND datetime <= NOW() 
```

# .net - 使用 Google Analytics Data API 按国家/地区过滤

> ID：1008138
> 
> 赞同：0
> 
> 时间：2009-06-17T16:21:04.947
> 
> 标签：.net, google-analytics

我正在尝试使用 Google Analytics Data API 来获取按国家/地区过滤的数据。我正在使用[http://google-gdata.googlecode.com/svn/trunk/](http://google-gdata.googlecode.com/svn/trunk/)上的 .NET 库，只要我不尝试按国家/地区过滤，它就可以很好地工作。

这工作正常：

```
const string dataFeedUrl = "https://www.google.com/analytics/feeds/data"; 

var query = new DataQuery(dataFeedUrl);
query.Ids = this.ProfileID;
query.GAStartDate = this.FromDate;
query.GAEndDate = this.ToDate;
query.Metrics = "ga:newVisits,ga:visitors";

DataFeed dataFeed = this.AnalyticsService.Query(query); 
```

但是，如果我在 Query 调用之前添加它：

```
query.Filters = string.Format("ga:country=={0}", this.Country);
query.Dimensions = "ga:country"; 
```

...我得到这个例外：

```
System.Exception {Google.GData.Client.GDataRequestException}
"Execution of request failed: https://www.google.com/analytics/feeds/data?dimensions=ga:country&end-date=2009-06-17&filters=ga:country==Denmark&ids=ga:xxx&metrics=ga:newVisits,ga:visitors&start-date=2009-05-18" 
```

我尝试手动将 == 转义为 %3D%3D 但这没有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T07:15:06.423

我终于找到了 ResponseString 并看到了这条消息：

```
"Illegal combination of dimensions and metrics" 
```

显然，我一直在尝试获取不可用的数据。在查看文档中的[查询验证图表](http://code.google.com/apis/analytics/docs/gdata/gdataReferenceDimensionsMetrics.html#queryValidation)时，这确实有意义。

# asp.net - 为什么 IIS 不提供 aspx 页面？

> ID：1008151
> 
> 赞同：9
> 
> 时间：2009-06-17T16:22:33.200
> 
> 标签：asp.net, iis, iis-6, windows-server-2003

我正在 IIS 下将 ASP.NET 应用程序部署到 Windows Server 2003

IIS 可以正常提供 html 页面，但是当我尝试提供 IIS 页面时找不到页面

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-17T16:27:31.060

您可能需要为 ASP.NET 应用程序“注册”IIS。以管理员身份运行命令“%systemroot%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis -i”。此外，您可能需要通过 IIS 管理控制台将您的网站转换为应用程序。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-17T16:24:54.900

默认情况下，IIS 在 IIS6 中禁用了 ASP 支持。

> 运行 Microsoft® Windows® Server 2003 家族成员的服务器支持应用程序服务器功能，其中 Microsoft ASP.NET 作为一个选项，您可以在配置应用程序服务器角色时启用它。要将 ASP.NET Web 应用程序部署到生产服务器，您必须确保在分发应用程序之前在生产服务器上启用 ASP.NET 和 Internet 信息服务 (IIS) 角色。

有关启用它的说明，请参见此处：http: [//www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/9fc367dd-5830-4ba3-a3c9-f84aa08edffa.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/9fc367dd-5830-4ba3-a3c9-f84aa08edffa.mspx?mfr=true)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-12T02:36:46.907

其他可能的原因可能是 Web 服务扩展，其中 ASP.NET 版本可能已被禁用。我[在此处](https://stackoverflow.com/questions/1552409/newly-installed-iis-aspx-page-not-getting-displayed)的另一篇文章解释了解决此问题的步骤。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T16:25:25.273

1.  确保正确安装了正确的 .NET 框架
2.  确保启用 ASP.NET 扩展
3.  在网站属性的 ASP.NET 选项卡下，确保设置了正确的版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-10T17:22:24.763

在遇到同样的问题并尝试上述所有方法后没有任何运气。我们为 Windows 2003 重新安装了 SP2，这解决了我们的问题。我也看到这个问题用其他答案解决了几次。大多数情况下，只需重新安装 .Net 2.0 即可解决问题，但这次不行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-27T15:05:51.443

为了将来参考，这也可能是问题：

Windows Server 64 位上的 IIS 只能在 32 位或 64 位模式下运行。

简而言之，您需要：

1) 运行 adsutil.vbs 以在 win 64 上启用 32 位 asp.net 应用程序

2）重新注册IIS调用aspnet_regiis.exe

3) 重新打开 IIS 管理器，进入 Web 服务扩展列表并确保 ASP.Net 版本 {2/4.xxx} (32-bit) 设置为允许

（如果您想在两个版本上运行 asp.net 应用程序，您可能需要为 Framework 2.0 和 4.0 执行步骤 2 和 3）

完整的详细信息在以下链接中：http: [//support.microsoft.com/kb/894435](http://support.microsoft.com/kb/894435)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-12T16:40:38.873

另一个未来参考，以防这对使用类似路径的任何人都有帮助。

我的 ASP.NET 应用程序的后端是 MySql 而不是 Sql Server，这对我来说意味着有一个 mysql 连接器，我的 IIS 没有提供 .aspx 文件的原因是因为在我的开发环境中我使用的是不同版本的 MySql连接器比安装在我的生产环境中的连接器，我更新了生产服务器上的 MySql 连接器以匹配我在开发环境中使用的版本，它工作得很好。

# c# - .NET 查询生成器组件

> ID：1008154
> 
> 赞同：6
> 
> 时间：2009-06-17T16:22:52.513
> 
> 标签：c#, .net, sql, components, uicomponents

任何人都可以推荐一个免费的 .NET 库，它允许您在 Windows 窗体应用程序中向您的用户公开 SQL 查询构建器？我希望我的用户能够运行相对直接的 SELECT 语句，包括一些 JOINS 和其他多表操作，而无需深入了解 SQL 的真正本质。

谢谢，斯威尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-11-01T08:34:33.897

如果您仍在寻找这样的组件，您可能应该看看 [EasyQuery.NET：http://devtools.korzh.com/query-builder-net-winforms/](http://devtools.korzh.com/query-builder-net-winforms/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T17:37:27.437

[报表生成器](http://msdn.microsoft.com/en-us/library/ms155933.aspx)是 SQL Server Reporting Services 的一部分，它可以让您完成所有这些以及更多工作。您也可以设置非 MSSQL 数据源。我们让非开发人员一直使用它来创建带有联接、分组等的报表，而无需 SQL 代码。

该许可证包含在 SQL Server Workgroup 及更高版本中。我不知道这对你来说是否足够“免费”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-18T16:56:54.307

您可以使用[Aspose.Report AdHoc.WinForms](http://www.aspose.com/community/files/51/.net-components/aspose.report-for-.net/default.aspx)组件（它不是免费的）。它不需要运行 SQL 服务器，可以很好地处理多个表，并且还能够进行自动表连接。

看看 Aspose 网站上的组件演示。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-08-05T11:15:38.867

您可以使用**CodeEngine.Framework**类来选择、插入、更新、删除操作

# mercurial - Mercurial diff：忽略尾随空格？

> ID：1008164
> 
> 赞同：8
> 
> 时间：2009-06-17T16:25:12.077
> 
> 标签：mercurial, diff, whitespace

我在一个非常不幸的环境中工作，几乎不担心被称为“尾随空白”的深层邪恶......但是，唉，开明的 Mercurial 坚持通过差异中的红色突出显示警告我，该代码我将检查包含这个邪恶的东西。

那么，有没有办法告诉 Mercurial 忽略差异中的尾随空格？

我已经尝试了所有明显的`--ignore-*`命令，但它们似乎什么也没做。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T16:42:37.683

放入您的[hgrc](http://www.selenic.com/mercurial/hgrc.5.html)文件：

```
[color]
diff.trailingwhitespace = none 
```

[在ColorExtension wiki 页面](https://www.mercurial-scm.org/wiki/ColorExtension)上阅读有关自定义配色方案的更多信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-01T02:32:39.010

[https://www.mercurial-scm.org/bts/issue127](https://www.mercurial-scm.org/bts/issue127)跟踪该`-w`选项无法按预期工作的事实。

# php - PHPMotion - 如果我只是在.flv 中上传，是否需要 ffmpeg 等？

> ID：1008187
> 
> 赞同：1
> 
> 时间：2009-06-17T16:30:31.527
> 
> 标签：php, video, ffmpeg, mpeg, motion

我的共享主机不允许我安装ffmpeg和一些类似的库，如果我只是在flv中上传它会起作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T16:52:09.707

只要您从 PHPmotion 脚本链接到 FLV，就可以。

意见：找一个允许 ffmpeg 的主机，因为这会给潜在用户编码自己的 FLV 文件带来很大的负担。

# javascript - 如何让 Visual Studio 从错误列表导航到正确的行？

> ID：1008194
> 
> 赞同：0
> 
> 时间：2009-06-17T16:31:37.297
> 
> 标签：javascript, visual-studio, navigation

我创建了一个脚本，作为构建后步骤运行，它运行 jslint 并缩小我的 javascript 和 css 文件。我已格式化输出，使其显示在 Visual Studio 的“错误列表”中，并正确填充了文件、行和列字段。

问题是，如果我双击一个错误，它只会将我带到正确的文件，而不是正确的行。它根本不在文件中导航（因此，如果我已经打开了文件，并且我的光标在第 500 行，并且我单击第 200 行的错误，它会转到该文件，但会留下光标在第 500 行）。如果文件没有打开，它会打开它，但将光标放在第一行。

行号是正确的（如果我在 Visual Studio 中滚动到该行，则会出现违规代码）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:17:30.707

您的输出格式必须与 C# 编译器相同。在一些 c# 代码中输入一个错误，然后在“输出”窗口中查看它的输出。你必须是在同一个地方的行号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:37:02.523

对于那些想要查看输出的人：

C:\projects\MyProject\trunk\csharp\MyProject\clientsrc\blackbirdjs\blackbird.js(308,6)：错误 JsLint：缺少分号。

上一个答案是正确的，但不幸的是没有帮助，因为我的输出已经正确并显示在正确的列中（IE 行号出现在错误列表的行号列中，所以 Visual Studio 肯定会解析它） .

另请注意， http: [//msdn.microsoft.com/en-us/library/yxkt8b26.aspx](http://msdn.microsoft.com/en-us/library/yxkt8b26.aspx)略有错误。该页面看起来您可以在文件名和行号之间有空格（即“blackbird.js (308, 6):”，但实际上您不能。

所以无论如何，我的回答是，我不知道为什么，但是（我根本没有改变格式，我正在研究其他东西一段时间）它“刚刚开始工作”。:-(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-14T17:40:16.143

答案是：将正斜杠 (/) 替换为反斜杠 (\)。

格式错误：

```
Ragtime/Security/Role.ts(152,13): error TS2339: Property 'Is' does not exist on type 'typeof Ragtime'. 
```

良好的格式：

```
Ragtime\Security\Role.ts(152,13): error TS2339: Property 'Is' does not exist on type 'typeof Ragtime'. 
```

# jboss - 如何为 JBoss 4.2.2.GA 中的 EJB 指定与默认值不同的 jndi 名称？

> ID：1008198
> 
> 赞同：3
> 
> 时间：2009-06-17T16:31:54.163
> 
> 标签：jboss, ejb-3.0, jndi

默认情况下，bean 的 jndi 名称似乎基于包含它的耳朵。名为 MyBean my-app.ear 的 EJB 将具有名称“my-app/MyBean/local”。

如何以声明方式更改该行为？我希望 jndi 名称为“something-else/MyBean/local”。它必须是声明性的，而不是带有注释 b/c 我无法修改 MyBean.java 的源；我只有一个罐子，我将它包装到耳朵中以进行部署。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T12:40:52.777

你可以在 jboss.xml 中提供这个

[http://docs.jboss.org/ejb3/app-server/reference/build/reference/en/html/jboss_deployment_descriptor.html](http://docs.jboss.org/ejb3/app-server/reference/build/reference/en/html/jboss_deployment_descriptor.html)

jndi-name 元素就是你想要的。

例子：

```
<jboss>
   <enterprise-beans>
      <service>
         <ejb-class>org.jboss.ejb3.test.service.ServiceSix</ejb-class>
         <local>org.jboss.ejb3.test.service.ServiceSixLocal</local>
         <remote>org.jboss.ejb3.test.service.ServiceSixRemote</remote>
         <management>org.jboss.ejb3.test.service.ServiceSixManagement</management>
         <jndi-name>serviceSix/remote</jndi-name>
         <local-jndi-name>serviceSix/local</local-jndi-name>
      </service>
   </enterprise-beans>
</jboss> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T14:01:05.113

我对 EJB3 不是很熟悉（就我而言，这太迟了），但是使用 EJB2，您可以通过修改 EJB JAR 的 META-INF 中的 jboss.xml 描述符来做到这一点。具体来说，您修改 EJB 定义的元素。

如果这不适用于 EJB3（并且我意识到 EJB3 是描述符精简版），我很抱歉，请不要对我投反对票 :)

# c++-cli - 互操作性 Cpluspluss_CLI_ManagedArray <--> Array

> ID：1008209
> 
> 赞同：-1
> 
> 时间：2009-06-17T16:33:14.147
> 
> 标签：c++-cli, interop, clr

如何转换 c++/CLI 数组和本机 c++ 数组之间的互操作性，反之亦然。

数组^ Cpluspluss_CLI_ManagedArray;

unsigned char* UnmanagedArray;

我找到了 System::Runtime::InteropServices::Marshal; (IntPtr) 对于像我这样的初学者来说，有很多信息（对 CLI）所以我不确定该使用哪个。

谢谢

拉吉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:55:27.043

// 非托管到托管...

IntPtr ptr((unsigned char*)UnmanagedArray);

数组<字节>^Cpluspluss_CLI_ManagedArray = gcnew array(UnmanagedArrayLength);

Marshal::Copy(ptr, Cpluspluss_CLI_ManagedArray, 0, UnmanagedArrayLength);

// 非托管到托管... [见这篇文章](https://stackoverflow.com/questions/1012396/arraybyte-to-unsigned-char-marshall-class-interop-issue)

# css - 重复图像有问题

> ID：1008211
> 
> 赞同：1
> 
> 时间：2009-06-17T16:33:19.967
> 
> 标签：css, html

在一个只有 HTML 和 CSS 的网站上工作。我对此很陌生。我有一个页眉、正文和页脚，我想重复这些以填满页面。想想[envato.com](http://envato.com)。

这是我到目前为止的一些示例代码。

CSS：

```
.blkside {
z-index:99;
background-image: url(/images/blkside.jpg);
background-repeat: repeat-x;
top:0px;
right:85px;
position: absolute;
} 
```

相应的 HTML：

```
<div class="blkside"><img src="/images/blkside.jpg"></div> 
```

这只是我拥有的 div 之一。3 水平重复，1 垂直重复。从我的搜索来看，这一切看起来都是正确的代码，但没有正确显示。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:39:24.410

下面的简单示例。

```
<div class="repeat"></div>

.repeat {
    background:url(/images/blkside.jpg) top left repeat-x;
    height:200px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:27:47.117

在整个页面背景上重复图像的代码是：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<title>this is the title of the web page</title>

<style type="text/css">

body
{
background-image:
url(full link to your image goes here);
background-repeat: repeat-xy;
}

</style>

</head>
<body>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:39:56.607

您需要在 div （高度/宽度）上设置测量值，一旦在 css 中定义图像，您也不需要将其放入 html

# com - ClearCase : 使用 CAL 列出目录 (ls) 的内容

> ID：1008220
> 
> 赞同：2
> 
> 时间：2009-06-17T16:35:18.200
> 
> 标签：com, list, automation, directory, clearcase

在 ClearCase 中，您可以使用“cleartool ls”列出目录的内容。

我的问题是如何使用 CAL（ClearCase 自动化层）做同样的事情。我更喜欢 COM API 的原因是我不必解析“ls”的输出。

到目前为止，我能够成功获取 VOB 和视图，但我没有找到任何列出内容的方法。

到目前为止我的代码：

```
IClearCase cc = new ApplicationClass();
CCVOB vob = cc.get_VOB("\\VOB-name");
CCView view = cc.get_View("ViewTag"); 
```

感谢您的帮助。

我用 C# 为那些感兴趣的人写了 VonC 的答案。

```
string[] files = Directory.GetFiles("View path here", "*.*", SearchOption.AllDirectories);
foreach (string file in files)
{
    try
    {
            CCVersion ver = cc.get_Version(file);
            Console.WriteLine(ver.Path);
    }
    catch(Exception) {/*the file is not versioned*/}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T16:46:40.210

也许这是一个好的开始：

```
Set CC = Wscript.CreateObject("ClearCase.Application") 
Set DirVer = CC.Version(".") 
Set FSO = CreateObject("Scripting.FileSystemObject") 
Set Folder = FSO.GetFolder(DirVer.Path) 
Wscript.Echo "Files under source control: " 
For Each File in Folder.Files 
     On Error Resume Next 
     Set Ver = CC.Version(File.Name) 
     If Err.Number = 0 Then 
           Wscript.Echo Ver.ExtendedPath 
     End If 
Next 
```

这个想法是使用`ICCVersion`方法来尝试访问文件的版本。如果它没有返回错误，它确实是一个版本化文件。

* * *

> 现在我知道该文件是版本化的，我该如何删除它（rmname）。

**不要使用 RemoveVersion()**：
不可恢复地删除版本（相当于`cleartool rmver`）
警告！这是一个潜在的破坏性操作。因为CAL在任何情况下都不会提示用户输入，所以`RemoveVersion`调用时没有确认步骤。调用`RemoveVersion`相当于`cleartool rmver`使用`-force`选项运行。

而是使用**`RemoveName`from the `ICCElement`interface**。

# excel - 在不循环的情况下更改范围内单元格的值

> ID：1008221
> 
> 赞同：0
> 
> 时间：2009-06-17T16:35:35.363
> 
> 标签：excel, excel-2007

嗨，可以在不使用循环或额外代码的情况下将包含特定值的单元格更改为另一个单元格（Excel 中是否有任何内置函数）？

例如在 Excel 2007 中我有一个范围 (A1:B3)

```
 A    B    C
  1   -1    56   100
  2   100   45   1
  3   34   -999  0 
```

现在我想将单元格的值更改为 7，如果它包含 100，那么现在我们的范围变为

```
 A    B    C
  1   -1    56   7
  2    7    45   1
  3   34   -999  0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T16:46:33.297

编辑 Excel 2007：

首页->编辑->查找和选择->替换。另请参阅 IF 功能，您可以使用类似的东西在另一张纸上创建副本

```
=IF(A1= 7,100, A1) 
```

并拖动右上角以创建所有单元格的副本（它会自动更改公式以使用 B1 等）

# javascript - javascript 的最佳实践大小写样式是什么？为什么？

> ID：1008230
> 
> 赞同：24
> 
> 时间：2009-06-17T16:38:18.107
> 
> 标签：javascript, variables, function, casing

很难找到有关 javascript 信息的一个方面是大小写实践。通过套管实践，我的意思是应该为哪些元素（构造函数、私有函数、公共函数）使用哪种套管样式（即驼峰式大小写、帕斯卡大小写等）。

我听到的唯一规则来自 Douglas Crockford 在 YUI 剧院的讲座，指出构造函数应该是唯一以大写字母开头的函数。

除此之外，人们在 javascript 中遵循的大小写标准似乎并不多。

有谁知道 javascript 的任何大小写最佳实践，以及为什么使用它们是合理的？

您的 .js 文件是否也遵循套管样式？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-17T16:42:12.583

我更喜欢 PascalCase 用于构造函数，而 camelCase 用于其他一切。这就是 JS 标准库使用的风格，嗯……到目前为止我见过的每个 JS 框架 :)

我对从 web 提供的所有文件使用 all_lowercase 命名约定。有*一些*不区分大小写的文件系统。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-17T16:53:32.110

核心语言将 InitialCaps 用于构造函数（例如 Object、Date、Number、RegExp），将 camelCase 用于方法和属性（例如 something.toString()、quantity.valueOf()、regexp.ignoreCase）。DOM 规范和实现也遵循这个约定（例如 HTMLElement.setAttribute()）。因此，采用相同的约定是最有意义的，或者你会以一种可怕的混合风格结束，比如：

```
var number_of_fish_requested = document.getElementById("fish").value;
var fish_count = parseInt(number_of_fish_requested, 10); 
```

这变得完全令人困惑，不仅是打字，更重要的是，阅读。

（你花在阅读代码、调试或修改代码上的时间，比你一开始写代码的时间还要多。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-02T18:43:34.490

到目前为止，我所看到的是非常多样化的套管标准。

就我而言，我使用 C# 样式来编写我的 JavaScript 代码。我经常使用类（以及函数作为类，并且通常没有独立的函数。）所以，我使用 PascalCase 来表示类名、公共方法、属性和所有全局变量，并使用 camelCase 来表示参数、局部变量和私有函数。这以某种方式反映了我的常见环境，有助于区分变量范围。我还倾向于将我的类函数保存在与我的 ClassName 同名的单独文件中（ClassName.js、ClassName.min.js）。

这是关于我的方法。

我还注意到 Java 程序员遵循 Java 规则（并且写作风格类似于 Java 语言）。Ruby on Rails 程序员遵循自己的命名标准，例如`underscore_separated_var_name`.

此外，正如您所提到的，在非常流行的框架中命名时有大量使用 pascalCase 的趋势，这些框架的作者来自不同的社区，如 Linux/开源社区和微软开发人员（jQuery、knockout.js、JSJaC 等）

我应该注意到，当涉及到 JS 时，这些方法都不是错误的或正确的。命名约定和文件结构的主要目的是可读性。如果您始终如一，那么您和您的其他开发人员将很快理解并继续使用您的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T16:46:12.830

除了构造函数，我更喜欢 camelCase。原因（我相信这也是 Crockford 先生建议这样做的原因）是因为在其他语言中，例如 Java，约定是大写你的类，这就是构造函数的用途。

那是我的 0.02 美元。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T17:06:16.573

所有带有下划线分隔符的小写字母最容易阅读；它遵循自然语言。“Best”会让你陷入一场圣战；现实情况是，案例并不像其他设计问题那么重要，但这是一个容易引起两极分化的话题。

```
ALongButNotReallyReadableIdentifier
an_even_longer_but_completely_readable_identifier 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-27T09:32:22.400

公认的答案是正确的，但也有一些例外。在 window.JSON 和 window.XMLHttpRequest 中，术语大写。

大多数人也将 PascalCase 用于 Javascript 中的枚举类型对象和其中的大写值。有时命名空间也在 PascalCase 中完成。

示例：MyCompany.Web.UI.MyComponent.ThemeOption = { 黑色：0，银色：1，蓝色：2}

# asp.net - 嵌入式 Adob e Acrobat PDF 窃取焦点

> ID：1008232
> 
> 赞同：2
> 
> 时间：2009-06-17T16:39:04.783
> 
> 标签：asp.net, pdf, activex, acrobat

我通过继承 AxHost 并将 Acrobat 传递`guid("ca8a9780-280d-11cf-a24d-444553540000")`给基本构造函数，将 Adob​​e Acrobat 嵌入到我们的 c# 程序中。要加载 pdf，我调用`InvokeMember("LoadFile")`. 我遇到的问题是在调用“LoadFile”并加载 PDF 之后，Acrobat 将焦点放在我们的表单中。作为 Acrobat 显然开始在另一个线程上加载，将焦点调用到以前具有焦点的控件上，并不能解决问题。那么有人知道如何防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-11T13:26:05.167

试试下面的片段......

```
 this.Refresh();
        axAcroPDF1.Focus();
        axAcroPDF1.SendToBack();

        **AnyControl**.Focus();
        this.Refresh(); 
```

# apache-flex - Flex：MXML“组件”和MXML“模块”有什么区别？

> ID：1008245
> 
> 赞同：14
> 
> 时间：2009-06-17T16:43:17.650
> 
> 标签：apache-flex, mxml

正如标题所示，“组件”（New –> MXML 组件）和“模块”（新建 –> MXML 模块）有什么区别？

谢谢，大卫

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-18T00:24:23.860

模块被编译成 SWF 并在运行时使用 ModuleLoader 加载，而 MXML 组件被编译成应用程序。来自 Flex 文档：

> 模块是可以由应用程序加载和卸载的 SWF 文件。它们不能独立于应用程序运行，但任何数量的应用程序都可以共享模块。
> 
> 模块让您可以将应用程序拆分为多个部分或模块。主应用程序或外壳程序可以在需要时动态加载它需要的其他模块。它在启动时不必加载所有模块，如果用户不与它们交互，它也不必加载任何模块。当应用程序不再需要某个模块时，它可以卸载该模块以释放内存和资源。[...]
> 
> 模块类似于运行时共享库​​ (RSL)，因为它们将代码从应用程序分离到单独加载的 SWF 文件中。模块比 RSL 灵活得多，因为模块可以在运行时加载和卸载，并且可以在没有应用程序的情况下进行编译。

希望有帮助！

# iphone - 如何创建具有透明背景的 UITableViewCell

> ID：1008246
> 
> 赞同：74
> 
> 时间：2009-06-17T16:43:55.903
> 
> 标签：iphone, cocoa-touch, uitableview

我正在尝试将 a 的背景颜色设置`UITableViewCell`为透明。但似乎没有任何效果。我在里面有一些图像/按钮`tableViewCell`，我想让白色`grouptableview`背景消失以获得图像和按钮的“浮动”效果（就好像它们不在里面一样`tableview`）。

知道如何实现吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-06-18T00:13:27.300

如果其他两个选项都不起作用，试试这个

```
UIView *backView = [[[UIView alloc] initWithFrame:CGRectZero] autorelease];
backView.backgroundColor = [UIColor clearColor];
cell.backgroundView = backView; 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-10-21T20:36:56.133

这实际上在 UITableViewCell 的文档中得到了回答。因此，虽然您必须在控件上设置透明度，但*必须*按照以下设置实际的单元格背景颜色。

> "注意：如果要更改单元格的背景颜色（通过 UIView 声明的 backgroundColor 属性设置单元格的背景颜色），您必须在委托的 tableView:willDisplayCell:forRowAtIndexPath: 方法中进行，而不是在tableView:cellForRowAtIndexPath: 数据源的。更改组样式表视图中单元格的背景颜色在 iOS 3.0 中的效果与以前版本的操作系统不同。现在它会影响圆角矩形内的区域它之外的区域。”

[https://developer.apple.com/documentation/uikit/uitableviewcell](https://developer.apple.com/documentation/uikit/uitableviewcell)

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-06-17T18:04:25.380

从这些文章开始以正确设置背景颜色：

[http://howtomakeiphoneapps.com/2009/03/how-to-add-a-nice-background-image-to-your-grouped-table-view/](http://howtomakeiphoneapps.com/2009/03/how-to-add-a-nice-background-image-to-your-grouped-table-view/)

[http://pessoal.org/blog/2009/02/25/customizing-the-background-border-colors-of-a-uitableview/](http://pessoal.org/blog/2009/02/25/customizing-the-background-border-colors-of-a-uitableview/)

然后尝试以下所有行：

```
[[cell contentView] setBackgroundColor:[UIColor clearColor]];
[[cell backgroundView] setBackgroundColor:[UIColor clearColor]];
[cell setBackgroundColor:[UIColor clearColor]]; 
```

UITableViewCell 中隐藏的视图不止一个。这应该使您的方式变得清晰。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2011-11-14T17:55:16.957

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{

    cell.backgroundColor = [UIColor clearColor];
    cell.backgroundView.backgroundColor = [UIColor clearColor];
} 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-02-04T11:07:11.907

**我有一个简单的解决方案**

**Objective-c**版本：

```
cell.backgroundColor = [UIColor clearColor]; 
```

**斯威夫特**版本：

```
cell.backgroundColor = UIColor.clearColor() 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-08-24T09:03:34.397

默认情况下，你的 UITableViewCell 的背景是白色的。这样做`myCell.backgroundColor = [UIColor clearColor];`会使你的 UITableViewCell 透明但你不会感觉到区别，因为 UITableView （你的 UITableViewCell 的竞争者）默认情况下也有白色背景。

如果您想查看 UIView 背景，则必须使单元格和表格背景透明：

```
myTableView.backgroundColor = [UIColor clearColor];
myTableCell.backgroundColor = [UIColor clearColor]; 
```

马丁马加基安

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-27T06:42:48.750

我有一个问题，我的自定义 tableviewcell 背景图像被白色标签背景覆盖，我尝试了一切，最后在 viewWillAppear 中设置背景以清除颜色就成功了。

```
 - (void)viewWillAppear:(BOOL)animated
    {
[super viewWillAppear:animated];
    self.tableView.backgroundColor = [UIColor clearColor]; // if this is not here, cell background image is covered with a white rectangle :S
    } 
```

在 rowForCellAtIndexPath 我设置了背景图片：

```
 if(!cell) {
    cell = [[[UITableViewCell alloc] initWithFrame: ...
    UIImageView *cellBG = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"cellbg.jpg"]];
    [cell setBackgroundView:cellBG];
    [cellBG release];
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-24T18:01:06.513

如果您使用故事板，请确保取消选中原型 UITableViewCells 的“不透明”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-05T18:23:42.167

有3个步骤：

1.  cell.contentView.backgroundColor = UIColor.clear
2.  在绘图部分的属性检查器中取消选中表视图单元格的不透明复选框。这可以通过单击情节提要中的表格视图单元原型并打开属性检查器来找到。向下滚动，您会找到它。
3.  从与步骤 2 相同的位置的下拉列表中选择背景作为清除颜色。
4.  运行你的应用

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-08T06:47:28.343

**Swift 5.1**的解决方案

 **```
let cell = tableView.dequeueReusableCell(withIdentifier: "cellIdentifier", for: indexPath)
cell.backgroundColor = UIColor.clear 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-11-11T16:34:02.537

在拔掉我大部分头发后，这对于 xCode 13 / Swift 5.1 来说非常简单。有两件事需要改变。

在您的 numberOfRowsInSection 中，添加：

**tableView.backgroundColor = UIColor.clear**

所以它看起来像这样：

```
 func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        tableView.backgroundColor = UIColor.clear
        return 40
    } 
```

然后在你的 cellForRowAt 中，添加：

**单元格？.backgroundColor = UIColor.clear**

所以它看起来像：

```
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    let cell = tableView.dequeueReusableCell(withIdentifier: "cell")
    cell?.backgroundColor = UIColor.clear
    return cell!
} 
```

就是这样。当它起作用时，简直不敢相信我的眼睛。:)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-06-12T23:13:06.440

这是我在 Swift 4.1 中的解决方案：

```
override func viewDidLoad() {
    super.viewDidLoad()
    tableView.backgroundView = UIImageView(image: "Image")
}

override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
    cell.backgroundColor = UIColor.clear
{ 
```**

# oracle - 如何使用创建或替换？

> ID：1008248
> 
> 赞同：117
> 
> 时间：2009-06-17T16:44:20.787
> 
> 标签：oracle, oracle10g, ddl

我是否正确理解 CREATE OR REPLACE 基本上意味着“如果对象存在，则删除它，然后以任何一种方式创建它？”

如果是这样，我做错了什么？这有效：

```
CREATE TABLE foo (id NUMBER,
title VARCHAR2(4000) DEFAULT 'Default Title') 
```

这不会（ORA-00922：缺少或无效选项）：

```
CREATE OR REPLACE TABLE foo (id NUMBER,
title VARCHAR2(4000) DEFAULT 'Default Title') 
```

我在做傻事吗？我似乎无法找到有关此语法的太多文档。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-06-17T16:48:58.693

这适用于函数、过程、包、类型、同义词、触发器和视图。

**更新：**

第三次更新帖子后，我将重新表述：

> 这不适用于表:)

是的，有关于这种语法的文档[**，**](http://download.oracle.com/docs/cd/B14117_01/server.101/b10759/statements_7002.htm#i2095331)并且没有.`REPLACE``CREATE TABLE`

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-06-18T02:05:42.907

语法的好处之一是您可以确保 a`CREATE OR REPLACE`永远不会导致您丢失数据（您将丢失的最多的是代码，希望您将其存储在源代码控制中的某个地方）。

表的等效语法是 ALTER，这意味着您必须显式枚举所需的确切更改。

**编辑：** 顺便说一句，如果您需要在脚本中执行 DROP + CREATE，并且您不关心虚假的“对象不存在”错误（当 DROP 找不到表时），您可以这样做这：

```
BEGIN
  EXECUTE IMMEDIATE 'DROP TABLE owner.mytable';
EXCEPTION
  WHEN OTHERS THEN
    IF sqlcode != -0942 THEN RAISE; END IF;
END;
/ 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-06-17T16:49:06.103

Oracle 中没有创建或替换表。

你必须：

```
删除表 foo；
创建表 foo (....);

```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-17T16:50:49.067

`CREATE OR REPLACE`只能用于函数、过程、类型、视图或包 - 它不适用于表。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-03-15T21:11:37.540

以下脚本应该在 Oracle 上发挥作用：

```
BEGIN
  EXECUTE IMMEDIATE 'drop TABLE tablename';
EXCEPTION
  WHEN OTHERS THEN
    IF sqlcode != -0942 THEN RAISE; 
    END IF;
END; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-17T16:50:26.277

不适用于表格，仅适用于函数等。

这是一个带有一些[示例](http://www.psoug.org/reference/functions.html)的站点。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-04-19T15:43:35.667

不使用异常的 oracle 数据库的有用过程（在某些情况下，您必须将 user_tables 替换为 dba_tables 和/或限制查询中的表空间）：

```
create or replace procedure NG_DROP_TABLE(tableName varchar2)
is
   c int;
begin
   select count(*) into c from user_tables where table_name = upper(tableName);
   if c = 1 then
      execute immediate 'drop table '||tableName;
   end if;
end; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-08-22T15:10:49.800

```
-- To Create or Replace a Table we must first silently Drop a Table that may not exist
DECLARE
  table_not_exist EXCEPTION;
  PRAGMA EXCEPTION_INIT (table_not_exist , -00942);
BEGIN
   EXECUTE IMMEDIATE('DROP TABLE <SCHEMA>.<TABLE NAME> CASCADE CONSTRAINTS');
   EXCEPTION WHEN table_not_exist THEN NULL;
END;
/ 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-24T06:22:24.497

如果您在代码中进行操作，则首先使用查询 SELECT table_name FROM user_tables WHERE table_name = 'XYZ' 检查数据库中的表

如果找到记录，则截断表，否则创建表

像创建或替换一样工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-01-12T00:50:48.990

您可以使用 CORT ( [www.softcraftltd.co.uk/cort](http://www.softcraftltd.co.uk/cort) )。该工具允许在 Oracle 中创建或替换表。看起来像：

```
create /*# or replace */ table MyTable(
  ... -- standard table definition
); 
```

它保存数据。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-08T18:48:57.793

所以我一直在使用它并且效果很好： - 它更像是 DROP IF EXISTS 但可以完成工作

```
DECLARE
       VE_TABLENOTEXISTS EXCEPTION;
PRAGMA EXCEPTION_INIT(VE_TABLENOTEXISTS, -942);

    PROCEDURE DROPTABLE(PIS_TABLENAME IN VARCHAR2) IS
              VS_DYNAMICDROPTABLESQL VARCHAR2(1024);
                    BEGIN
                       VS_DYNAMICDROPTABLESQL := 'DROP TABLE ' || PIS_TABLENAME;  
                    EXECUTE IMMEDIATE VS_DYNAMICDROPTABLESQL;

                    EXCEPTION
                        WHEN VE_TABLENOTEXISTS THEN
                             DBMS_OUTPUT.PUT_LINE(PIS_TABLENAME || ' NOT EXIST, SKIPPING....');
                        WHEN OTHERS THEN
                             DBMS_OUTPUT.PUT_LINE(SQLERRM);
                    RAISE;
                    END DROPTABLE;

    BEGIN
      DROPTABLE('YOUR_TABLE_HERE');
END DROPTABLE;
/ 
```

希望这有帮助 另请参考： [PL/SQL Developer 中的 PLS-00103 错误](https://stackoverflow.com/questions/41001686/pls-00103-error-in-pl-sql-developer)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-06-22T03:45:46.687

“创建或替换表”是不可能的。正如其他人所说，您可以编写一个过程和/或立即使用开始执行（...）。因为我没有看到如何（重新）创建表的答案，所以我将脚本作为答案。

PS：根据 jeffrey-kemp 提到的内容：下面的脚本不会保存您要删除的表中已经存在的数据。由于存在丢失数据的风险，我们公司只允许修改生产环境中已有的表，不允许删除表。通过使用 drop table 语句，您迟早会让公司警察站在您的办公桌前。

```
--Create the table 'A_TABLE_X', and drop the table in case it already is present
BEGIN
EXECUTE IMMEDIATE 
'
CREATE TABLE A_TABLE_X
(
COLUMN1 NUMBER(15,0),
COLUMN2  VARCHAR2(255 CHAR),
COLUMN3  VARCHAR2(255 CHAR)
)';

EXCEPTION
WHEN OTHERS THEN
  IF SQLCODE != -955 THEN -- ORA-00955: object name already used
     EXECUTE IMMEDIATE 'DROP TABLE A_TABLE_X';
  END IF;
END; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-20T11:41:18.443

我会做这样的事情

```
 begin
     for i in (select table_name from user_tables where table_name = 'FOO') loop
        execute immediate 'drop table '||i.table_name;
     end loop;
  end;

  execute immediate 'CREATE TABLE FOO (id NUMBER,
                                       title VARCHAR2(4000)) '; 
```

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2009-06-17T17:09:48.800

如果这是针对 MS SQL.. 无论表是否已经存在，以下代码将始终运行。

```
if object_id('mytablename') is not null //has the table been created already in the db
Begin
     drop table mytablename
End

Create table mytablename (... 
```

# c# - .NET 2.0 WinForm 打印屏幕

> ID：1008249
> 
> 赞同：0
> 
> 时间：2009-06-17T16:44:24.483
> 
> 标签：c#, .net, winforms, printing

我想打印一个对话框的图像，好像使用了 [alt][Print Scrn]。该框架是否允许以编程方式完成此操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T16:49:33.700

[Graphics.CopyFromScreen(..)](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.copyfromscreen.aspx)方法应该可以满足您的需要。

这是我在网上找到的一个很好的示例：

[http://www.geekpedia.com/tutorial181_Capturing-screenshots-using-Csharp.html](http://www.geekpedia.com/tutorial181_Capturing-screenshots-using-Csharp.html)

**编辑：**代码示例：（我将其创建为扩展方法）

```
public static class FormExtensions
{
    public static void SaveAsImage(this Form form, string fileName, ImageFormat format)
    {
        var image = new Bitmap(form.Width, form.Height);
        using (Graphics g = Graphics.FromImage(image))
        {
            g.CopyFromScreen(form.Location, new Point(0, 0), form.Size);
        }
        image.Save(fileName, format);
    }
} 
```

可以使用：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        this.SaveAsImage("foo.bmp", ImageFormat.Bmp);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:51:59.223

您可能会做的是使用具有 Windows 功能的现有 DLL。看起来您需要获取一些关键命令或使用表单按钮执行此操作，并使用 User32.dll。由于互操作有时会很痛苦，我在这里找到了一个资源，可以帮助你做你想做的事：

[http://www.cornetdesign.com/2005/04/screen-print-capture-in-c-using_08.html](http://www.cornetdesign.com/2005/04/screen-print-capture-in-c-using_08.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:43:43.337

如果您真的只想要对话框，请使用[Control.DrawToBitmap](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx)从中获取 BMP 图像。

# java - JPA/Hibernate 查询返回过时的结果

> ID：1008252
> 
> 赞同：4
> 
> 时间：2009-06-17T16:44:50.803
> 
> 标签：java, hibernate, jpa, jakarta-ee, persistence

我正在使用**EXTENDED** Persistent Context，因为它允许我在对象上延迟加载一对多关系，并且在我将对象与持久上下文“合并”之前也不需要 SELECT。

我有一个 DummyObject：

1.  “上次更新”日期字段

2.  一对多的关系

此对象通过调用在一个 JVM 中每**5秒更新一次。**`em.merge(DummyObject)`

在另一个 JVM 中，我查询 DummyObject 执行如下调用

```
em.createQuery("from DummyObject").getResultList(); 
```

我也每**5**秒执行一次此查询。

问题是，查询产生的对象在连续调用后都有第一个查询的时间戳，即使 Hibernate 正在生成正确的 SQL 语句（当我有语句登录时），并且数据库正在获取更新正确（我已经验证）。

我也尝试过使用@Version 进行各种乐观锁定，但无济于事。（看评论）

另一件事是，这在以下情况下确实可以正常工作：

1.  我将 PersistentContextType 更改为**TRANSACTIONAL** （不允许我懒惰地加载 ONE-MANY 关系）

2.  在执行上述查询之前，我进行了 EntityManager.clear() 调用（这也不允许我懒惰地加载 ONE-MANY 关系）。

为什么我的查询返回陈旧数据？我**没有**启用二级缓存或查询缓存。

难道我做错了什么？有什么我可以通过 query.setHint( , ) 设置的吗？

也许我不正确理解“**扩展**”与**交易**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T18:10:48.777

休眠会话正在缓存持久对象。因此，因为您在一个 JVM (A) 中进行修改并在另一个 JVM(B) 中读取，所以需要刷新 B 的会话以查看更改。您可以打开一个新会话或驱逐/刷新持久对象。您还可以跨两个 JVM 复制会话，这可能会解决您的问题。或者您可以尝试更改查询以仅返回您需要的“DummyObject”片段，并且仅在需要时读取持久对象。您也可以尝试无状态会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:52:05.777

有趣的。对我来说，您的持久性上下文中的实体实例似乎没有使用查询结果进行更新。这可能是设计使然 - 您可能会通过执行查询意外地覆盖本地更改。

更糟糕的是，JPA 中无法分离单个实例。您要么清除整个上下文，要么不清除。所以这也不是一个可能的解决方案。

类中有一个`refresh()`方法可以`PersistanceContext`从数据库中获取更改并相应地更新实体实例。但我可以看到这可能不适用于实际实现。所以我的答案是：你可能无法让它工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T22:19:22.707

您是否尝试过在获取之前执行 flush() ？

# java - 使用 ThreadPoolExecutor 取消 SwingWorker

> ID：1008258
> 
> 赞同：1
> 
> 时间：2009-06-17T16:46:17.353
> 
> 标签：java, multithreading, swing, threadpool

我正在使用线程池大小为 1 的 ThreadPoolExecutor 来顺序执行摇摆工作人员。我遇到了一个特殊情况，即一个事件到达，它创建了一个执行一些客户端-服务器通信的 swing worker，然后更新 ui（在 done() 方法中）。

当用户触发（单击项目）某些事件但如果发生许多事件时，这可以正常工作。但这发生了，所以我需要取消所有当前正在运行和计划的工作人员。问题是支持 ThreadPoolExecutor 的队列不知道 SwingWorker 取消过程（至少看起来是这样）。所以预定的工人会被取消，但已经在运行的工人不会。

所以我添加了一个类型的并发队列，`<T extends SwingWorker>`它保存所有工作人员的引用，只要它们没有被取消，并且当新事件到达时，它会在队列中的所有 SwingWorkers 上调用 .cancel(true) 并将新的 SwingWorker 提交给 ThreadPoolExecutor。

摘要： SwingWorkers 是在具有单个线程的 ThreadPoolExecutor 中创建和执行的。只有最后提交的工作人员才应该运行。

有没有其他方法可以解决这个问题，或者这样做是否“可以”？

只是好奇...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-20T18:53:40.223

创建仅执行最后一个传入 Runnable 的单线程 ThreadPoolExecutor 的一种方法是子类化一个合适的队列类并覆盖所有添加方法以在添加新的 runnable 之前清除队列。然后将该队列设置为 ThreadPoolExecutor 的工作队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T14:35:05.067

为什么需要 ThreadPoolExecutor 来完成这种工作？

你有多少不同 SwingWorkers 的来源？因为如果源只是一个，你应该使用不同的方法。

例如，您可以定义一个处理一种工作线程的类，并将其链接到一种项目，用户可以在该项目上触发操作并在该类内部关心线程的单个实例应该运行的事实（例如使用完成任务后清除的单例实例）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:46:12.320

除了使用 SwingWorker 之外，您是否可以不使用 ThreadPoolExecutor 来执行客户端-服务器通信，然后调用 SwingUtilities.invokeLater 来使用结果更新 UI？这对我来说似乎更干净一些，并且可以确保事件和 UI 更新仍然按顺序处理。

当您向执行者提交任务时，您可以保留对它们的 Future 实例的引用，以便您可以在需要时取消任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-31T15:57:22.197

让我看看我是否正确理解了这个问题。您有一个 FIFO 任务队列，其中只有最旧的任务正在运行。每个任务完成后都需要更新 UI。但是如果某个用户事件进来了，所有的任务都需要被取消——也就是正在运行的任务需要被取消，尚未运行的任务需要从队列中移除。是对的吗？

假设是这样，我不会使用，`SwingWorker`因为您只需要一个工作线程，而不是每个任务一个。`FutureTask`应该足够了（假设您重写`done()`以进行必要的调用`SwingUtilities.invokeLater()`并进行 UI 更新）。

如果你取消 a `FutureTask`，那么即使它的`run()`方法被调用，它也不会做任何事情。因此，您可以`FutureTask`安全地将 s 提交给`ExecutorService`知道即使执行程序尝试运行它们，取消也会起作用。

我怀疑一个足够好的解决方案只是保留所有`FutureTasks`可能需要取消的列表，并在用户事件出现时将它们全部取消。`ExecutorService`仍然会尝试运行它们，但基本上不会-操作。您需要确保已从列表中删除已完成的任务，并且您需要确保列表已更新并以线程安全的方式使用（可能来自将任务放在的同一线程`ExecutorService`），但这不应该是太难。

我只用了一个小时就把下面的代码搞砸了，我不敢打赌它是正确的，但你明白了。:)

```
/** Untested code! Use at own risk. */
public class SwingTaskExecutor {

    // ////////////////////////////////////////////////////////////
    // Fields

    private final ExecutorService execSvc = Executors.newFixedThreadPool(1);

    private final Lock listLock = new ReentrantLock();
    private final List<ManagedSwingTask<?>> activeTasks = 
            new ArrayList<ManagedSwingTask<?>>();

    // ////////////////////////////////////////////////////////////
    // Public methods

    public <T> Future<T> submit(SwingTask<T> task) {
        ManagedSwingTask<T> managedTask = new ManagedSwingTask<T>(task);
        addToActiveTasks(managedTask);
        execSvc.submit(managedTask);
        return managedTask;
    }

    public void cancelAllTasks() {
        listLock.lock();
        try {
            for (ManagedSwingTask<?> t: activeTasks) {
                t.cancel(true);
            }
            activeTasks.clear();
        } finally {
            listLock.unlock();
        }
    }

    // ////////////////////////////////////////////////////////////
    // Private methods

    private <T> void addToActiveTasks(ManagedSwingTask<T> managedTask) {
        listLock.lock();
        try {
            activeTasks.add(managedTask);
        } finally {
            listLock.unlock();
        }
    }

    // ////////////////////////////////////////////////////////////
    // Helper classes

    private class ManagedSwingTask<T> extends FutureTask<T> {

        private final SwingTask<T> task;

        ManagedSwingTask(SwingTask<T> task) {
            super(task);
            this.task = task;
        }

        @Override
        public void cancel(boolean mayInterruptIfRunning) {
            try {
                task.cancel();
            } finally {
                super.cancel(mayInterruptIfRunning);
            }
        }

        @Override
        protected void done() {
            removeFromActiveTasks();
            updateUIIfDone();
        }

        private void removeFromActiveTasks() {
            listLock.lock();
            try {
                activeTasks.remove(this);
            } finally {
                listLock.unlock();
            }
        }

        private void updateUIIfDone() {
            if (isDone()) {
                SwingUtilities.invokeLater(new Runnable() {
                    @Override
                    public void run() {
                        task.updateUI();
                    }
                });
            }
        }
    }

    public static interface SwingTask<T> extends Callable<T> {

        /** Called from the EDT if task completes successfully */
        void updateUI();

        /** Hook in case there's task-specific cancellation to be done*/
        void cancel();
    }
} 
```

反正就是这样。

如果您想更加确定，则可以关闭并更换`ExecutorService`，但这可能没有必要。

# visual-studio-2008 - VS2008调试时改变结构成员的顺序

> ID：1008266
> 
> 赞同：1
> 
> 时间：2009-06-17T16:47:03.437
> 
> 标签：visual-studio-2008, debugging

我正在尝试对齐在 c++ 中创建的 ac# struct 中的一些数据。我知道我少了几个字节，但我不知道在哪里，因为 VS 按字母顺序组织成员，而不是结构中出现的顺序（明确定义）。

是否可以在显示结构值的调试对话框中更改成员的显示顺序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T16:55:19.363

通过以下命令在 cdb 中打开您的二进制文件（来自 Windows 调试工具）：

```
cdb -z \path\to\your\yourlibrary.dll 
```

然后运行

```
dt yourlibrary!NameOfYourStruct 
```

这将准确地告诉您结构的布局方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T16:57:54.057

也许你可以[`DebuggerDisplay`](http://msdn.microsoft.com/en-us/library/x810d419.aspx)为你的结构使用一个聪明的属性。

# c++ - 在 C++ 中通过引用传递临时对象时如何避免显式调用构造函数？

> ID：1008272
> 
> 赞同：0
> 
> 时间：2009-06-17T16:48:01.050
> 
> 标签：c++, pass-by-reference

假设我有一堂课：

```
class String
{
public:
     String(char *str);
}; 
```

还有两个功能：

```
void DoSomethingByVal(String Str);
void DoSomethingByRef(String &Str); 
```

如果我这样调用 DoSomethingByVal：

```
DoSomethingByVal("My string"); 
```

编译器发现它应该创建一个临时 String 对象并调用 char* 构造函数。

但是，如果我尝试以相同的方式使用 DoSomethingByRef，我会收到“无法将参数从 'char *' 转换为 'String &'”错误。

相反，我必须显式创建一个实例：

```
DoSomethingByRef(String("My string")); 
```

这可能会让人讨厌。

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T16:52:13.623

您需要通过 const 引用传递：

为了：

```
void DoSomethingByVal(String Str); 
```

在这种情况下，编译器首先创建一个临时变量。然后将临时变量复制构造到参数中。

为了：

```
void DoSomethingByRef(String const& Str); 
```

在这种情况下，编译器会创建一个临时变量。但是临时变量不能绑定到引用，它们只能绑定到 const 引用，因此无法调用您的原始函数。请注意，std::string objects 构造函数采用 const 引用是复制构造函数的参数，这就是为什么第一个版本可以作为临时对象仅绑定到复制构造函数的 const 引用参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T16:52:32.937

嗯，我不确定是否

```
void DoSomethingByRef(String &Str);
DoSomethingByRef(String("My string")); 
```

实际上会编译。右值不能绑定到对非 const 的引用（因为对非 const 的引用表明您将修改该值，而修改临时值没有意义）。你确定你没有做：

```
String str("My string");
DoSomethingByRef(str); 
```

如果您希望 DoSomethingByVal 采用右值，则参数必须是对 const 的引用：

```
void DoSomethingByRef(const String &Str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:52:47.943

制作：

DoSomethingByRef(const String &str);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T16:55:30.500

“我的字符串”不是字符串，它是一个 c 字符串，一个 char*，如果你愿意的话。您需要将该 c-string 放入 String 对象，然后您可以通过引用传递新的 String 对象。

另一点，您已经传递了一个 char*... 这非常轻量级，只是一个指针。为什么要担心通过引用传递新对象？只需在该构造函数中从堆中分配一个新对象并将 c 字符串复制到其中。

# wpf - 带有 MultiTriggers 的 SourceName

> ID：1008277
> 
> 赞同：2
> 
> 时间：2009-06-17T16:48:47.413
> 
> 标签：wpf, xaml, triggers, multitrigger

是否可以使用 a`MultiTrigger`来评估多个元素的属性？它不在模板中，而是在用户控件/窗口中。

例子：

```
<CheckBox x:Name="checkBox1" />
<CheckBox x:Name="checkBox2" />

<CustomControl>
   <CustomControl.ContentTemplate>
              <DataTemplate>
                        <DataTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition
                                        SourceName="checkBox1"
                                        Property="IsChecked"
                                        Value="False" />
                                    <Condition
                                        SourceName="checkBox2"
                                        Property="IsChecked"
                                        Value="True" />
                                </MultiTrigger.Conditions>
                                <MultiTrigger.Setters>
                                    <Setter
                                        Property="Visibility"
                                        Value="Collapsed" />
                                </MultiTrigger.Setters>
                            </MultiTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
</CustomControl.ContentTemplate> 
```

在正常情况`Trigger`下，我们可以使用 sourceName 来触发这些复选框控件中的任何一个上的属性，但是`MultiTrigger`当它尝试查找这些控件时，我会遇到构建错误。

[注意：这里](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/b59822de-21ea-4a74-a115-3860241ba6b1)提到了我使用 a`DataTemplate`而不是 a的原因`Style`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T23:58:02.523

您确实可以使用源名称，但您的 DataTemplate 似乎没有正确定义。我已尝试填写您的示例，该示例似乎有效：

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:sys="clr-namespace:System;assembly=mscorlib">
    <Grid>
        <Grid.Resources>
            <DataTemplate DataType="{x:Type sys:String}">
                <StackPanel>
                    <TextBlock x:Name="textBlock" Text="{Binding}"></TextBlock>
                    <CheckBox x:Name="checkBox1" />
                    <CheckBox x:Name="checkBox2" />
                </StackPanel>
                <DataTemplate.Triggers>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition
                                SourceName="checkBox1"
                                Property="IsChecked"
                                Value="False" />
                            <Condition
                                SourceName="checkBox2"
                                Property="IsChecked"
                                Value="True" />
                        </MultiTrigger.Conditions>
                        <MultiTrigger.Setters>
                            <Setter
                            TargetName="textBlock"
                                Property="Visibility"
                                Value="Collapsed" />
                        </MultiTrigger.Setters>
                    </MultiTrigger>
                </DataTemplate.Triggers>

            </DataTemplate>
        </Grid.Resources>
        <ContentControl>
            <sys:String>Foo</sys:String>
        </ContentControl>
    </Grid>
</Page> 
```

问题似乎是您没有**在**DataTemplate 中定义 CheckBox，这是它们需要的地方。

# mysql - 排序规则的非法混合 MySQL 错误

> ID：1008287
> 
> 赞同：136
> 
> 时间：2009-06-17T16:49:53.403
> 
> 标签：mysql, sql, mysql-error-1267

我在处理大量数据时遇到了这个奇怪的错误......

```
Error Number: 1267

Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8_general_ci,COERCIBLE) for operation '='

SELECT COUNT(*) as num from keywords WHERE campaignId='12' AND LCASE(keyword)='hello again æ˜” ã‹ã‚‰ ã‚ã‚‹ å ´æ‰€' 
```

我能做些什么来解决这个问题？我可以以某种方式转义字符串以便不会发生此错误，还是我需要以某种方式更改我的表编码，如果是这样，我应该将其更改为什么？

* * *

## 回答 #1

> 赞同：311
> 
> 时间：2009-06-17T16:59:11.090

```
SET collation_connection = 'utf8_general_ci'; 
```

然后为您的数据库

```
ALTER DATABASE your_database_name CHARACTER SET utf8 COLLATE utf8_general_ci;

ALTER TABLE your_table_name CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci; 
```

MySQL 有时会无缘无故地潜入瑞典语。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2018-04-23T11:08:03.680

```
CONVERT(column1 USING utf8) 
```

解决了我的问题。其中 column1 是给我这个错误的列。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-17T16:59:44.723

您应该将表编码和连接编码都设置为`UTF-8`：

```
ALTER TABLE keywords CHARACTER SET UTF8; -- run once 
```

和

```
SET NAMES 'UTF8';
SET CHARACTER SET 'UTF8'; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-11T08:16:04.837

使用以下语句表示错误

如果表中有数据，请注意备份数据。

```
ALTER TABLE your_table_name CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci;
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-08T02:30:12.747

我的表最初是用**CHARSET=latin1**创建的。在表转换为**utf8**之后，一些列没有被转换，但这并不是很明显。您可以尝试运行`SHOW CREATE TABLE my_table;`并查看未转换的列或仅使用以下查询修复有问题的列上的不正确字符集（根据您的需要更改 varchar 长度和 CHARSET 和 COLLATE）：

```
 ALTER TABLE `my_table` CHANGE `my_column` `my_column` VARCHAR(10) CHARSET utf8 
 COLLATE utf8_general_ci NULL; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-02-19T17:05:55.290

我发现 using`cast()`对我来说是最好的解决方案：

```
cast(Format(amount, "Standard") AS CHAR CHARACTER SET utf8) AS Amount 
```

还有一个`convert()`功能。更多细节在[这里](https://dev.mysql.com/doc/refman/8.0/en/cast-functions.html)

[这里的](https://docs.oracle.com/cd/E17952_01/mysql-5.1-en/charset-convert.html)另一个资源

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-12T11:29:47.240

一般来说，最好的方法是更改​​表排序规则。但是，我有一个旧应用程序，并且无法真正估计结果是否有副作用。因此，我尝试以某种方式将字符串转换为解决排序规则问题的其他格式。我发现工作是通过将字符串转换为其字符的十六进制表示来进行字符串比较。在数据库上，这是使用`HEX(column).`PHP 完成的，您可以使用此函数：

```
public static function strToHex($string)
{
    $hex = '';
    for ($i=0; $i<strlen($string); $i++){
        $ord = ord($string[$i]);
        $hexCode = dechex($ord);
        $hex .= substr('0'.$hexCode, -2);
    }
    return strToUpper($hex);
} 
```

在进行数据库查询时，必须先将原始 UTF8 字符串转换为 iso 字符串（例如`utf8_decode()`在 PHP 中使用），然后才能在数据库中使用它。由于排序规则类型，数据库内部不能包含 UTF8 字符，因此比较应该有效，尽管这会更改原始字符串（转换 ISO 字符集中不存在的 UTF8 字符会导致 ? 或这些字符被完全删除）。只需确保在将数据写入数据库时​​，使用相同的 UTF8 到 ISO 转换。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-12T09:04:57.740

将表格的字符集改为utf8

> ALTER TABLE your_table_name 转换为字符集 utf8

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-07-11T03:26:41.863

我的用户帐户没有按照[此解决方案](https://stackoverflow.com/a/1008336/2223027)中的建议更改数据库和表的权限。

如果像我一样，您不关心[字符排序规则](https://en.wikipedia.org/wiki/Character_collation)（您使用的是 '=' 运算符），则可以应用反向修复。在您的 SELECT 之前运行它：

```
SET collation_connection = 'latin1_swedish_ci'; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-22T17:21:06.603

在最重要的答案中列出您的更正后，更改服务器的默认设置。

在您的“ **/etc/my.cnf.d/server.cnf** ”或它所在的任何位置中，将默认值添加到**[mysqld]**部分，使其看起来像这样：

```
[mysqld]
character-set-server=utf8
collation-server=utf8_general_ci 
```

来源：[https ://dev.mysql.com/doc/refman/5.7/en/charset-applications.html](https://dev.mysql.com/doc/refman/5.7/en/charset-applications.html)

# javascript - IE 中的“无效参数”错误，行号不存在

> ID：1008290
> 
> 赞同：9
> 
> 时间：2009-06-17T16:50:02.297
> 
> 标签：javascript, internet-explorer, debugging

我在 IE 6 中收到以下错误：

```
Line: 454  
Char: 13  
Error: Invalid Argument  
Code: 0  
URL: xxxxx/Iframe1.aspx 
```

而且我一辈子都找不到导致这种情况的原因。

这只发生在我有一个包含多个 IFrame 的主页的情况下，并且它只发生在我有一个特定的 IFrame（错误消息中的 URL 指向的那个）并且 IFrame 在加载。
我已经把它缩小到那里，但我仍然找不到更具体的东西......

有问题的 IFrame 在其 HTML 中没有 454 行，它引用的任何 JS 文件也没有。

我尝试将 VS 作为调试器附加到 iexplore.exe，当错误发生时它会中断，但随后告诉我“当前位置没有可用的源代码”...

关于如何追逐这个有什么建议吗？

* * *

更新：我通过蛮力发现了这个问题，基本上，将所有内容注释掉并随机取消注释......
但问题仍然存在：当 IE 报告错误的行号/文件时，找到错误所在的合理方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T17:43:30.530

IE's Javascript engine is disgusting when it comes to debugging. You can try enabling script debugging in the Advanced Options, and then if you have Visual Studio installed it will jump to the place of error... if you're lucky. Other times you don't get anything, especially if the code was eval()'ed.

Another thing about these line numbers is that it doesn't reflect which file the error is happening in. I've had cases where the line number was actually correct, but it was in a linked .js file, not the main file.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T20:34:18.927

尝试使用 Microsoft Script Debugger 或 DebugBar ( [http://www.debugbar.com](http://www.debugbar.com) )，它可能会为您提供一些更好的 IE6 调试工具。他们总是帮助我使用 IE6。

此外，这是否发生在任何较新版本的 IE 中或仅在 IE6 中？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T17:03:14.907

如果没有实时示例，几乎不可能对此进行调试，但在 Internet Explorer 中经常导致“无效参数”错误的一件事是尝试为样式属性设置不正确的值。

所以像：

```
document.getElementById("foo").style.borderWidth = bar + "px"; 
```

当 "bar" 的值为 null、未定义或字符串 "grandma" 时，将导致它，因为 "grandmapx" 不是borderWidth 样式属性的有效值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-10T13:55:48.653

IE9有浏览器模式。

打开开发人员工具，然后在控制台中选择您要模拟的版本，重新加载出现错误的页面，控制台将显示行号和错误所在的正确文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T17:46:25.313

I run into this problem a lot too, and I've also resorted to commenting everything out until I find the problem. One thing that I find to be useful is to add a try/catch block to every javascript method. Sometimes I add an alert to tell what method the error came from. Still tedious, but easier than trial and error commenting. And if you add them every time you write a new method it saves a lot of time in the event errors like those occur.

```
function TestMethod()
{
    try
    {
        //whatever
    }
    catch (ex)
    {
        ShowError(ex.description);
        //alert("TestMethod");
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-10T16:29:10.867

给其他读者的说明：我最近遇到了这个“无效的论点”。IE7-9 报错，最终发现是因为我使用 setTimeout/setInterval 的方式。

这是错误的，在 IE 中：

```
var Thing = {};
Thing.myFunc = function() { ... };
setTimeout(Thing.myFunc, 1000); 
```

相反，将回调包装在匿名函数中，如下所示：

```
var Thing = {};
Thing.myFunc = function() { ... };
setTimeout(function() { Thing.myFunc(); }, 1000); 
```

并且不再有“无效参数”错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-11T02:34:04.610

另一种可能：

我在家里和工作中的两台计算机之间做很多开发，所以我经常给自己发电子邮件或从服务器下载页面来处理。最近我意识到Vista有一种习惯，当某些文件以某种方式下载时，会单方面对某些文件应用块，而不会通知我它正在这样做。

结果是，例如，一个 HTML 页面想要访问其标题中的 .js 文件，但它没有访问本地文件的权限。在这种情况下，你在 .js 文件中写什么并不重要，浏览器甚至永远不会读取它，并且`Line: 0`会导致一个令人讨厌的错误。

因此，在梳理代码是否有错误之前，请检查 HTML 页面的属性，并查看它是否未被操作系统阻止......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-07T02:09:42.787

就像 NickFitz 指出的那样，样式是我的代码的一个问题。

```
document.getElementById('sums<%= event.id %>').style.border='1px solid #3b3b3b;' 
```

我删除了边框样式，我的 IE 问题消失了。

# php - 使用 AJAX 来回发送信息

> ID：1008291
> 
> 赞同：4
> 
> 时间：2009-06-17T16:50:05.870
> 
> 标签：php, javascript, jquery, ajax

使用$.post，你可以向服务器发送信息，但是当你需要从服务器接收信息时怎么办？

信息如何从可以由 php 变量保存的方式变为可以由 javascript 变量保存的方式，反之亦然？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T17:01:22.663

这与您的问题更相关：http: [//docs.jquery.com/Ajax/jQuery.post](http://docs.jquery.com/Ajax/jQuery.post)

提示请求 test.php 的结果（HTML 或 XML，取决于返回的内容）。

```
$.post("test.php", function(data){
  alert("Data Loaded: " + data);
}); 
```

使用额外的数据有效负载（HTML 或 XML，取决于返回的内容）发出请求 test.php 的结果。

```
$.post("test.php", { name: "John", time: "2pm" },
  function(data){
    alert("Data Loaded: " + data);
  }); 
```

获取 test.php 页面内容，将其存储在 XMLHttpResponse 对象中并应用 process() JavaScript 函数。

```
$.post("test.php", { name: "John", time: "2pm" },
  function(data){
    process(data);
  }, "xml"); 
```

获取已经以json格式返回的test.php页面内容("John","time"=>"2pm")); ?>)

```
$.post("test.php", { func: "getNameAndTime" },
  function(data){
    alert(data.name); // John
    console.log(data.time); //  2pm
  }, "json"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T16:52:34.293

签出[`json_encode()`](http://us.php.net/json_encode)和[`json_decode()`](http://us.php.net/json_decode)。[这些现在是 PHP 的一部分，允许您在 PHP 数组和关联数组（或 stdClass 对象）和 javascript 数组或对象（作为JSON](http://www.json.org/)文字）之间来回切换。

本质上，您可以执行`echo json_encode($all_my_php_data);`并取回 javascript 对象，而不是返回 xml 或 html。

如果您将“json”作为 $.post() 的类型参数传递，您的成功回调将包含您在 PHP 脚本中回显的 JSON 对象。

[$.post() 文档](http://docs.jquery.com/Ajax/jQuery.post)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:02:42.037

然后你需要接收服务器发回的内容。您只需使用 'data' 参数为 $.post 定义回调函数。例如：

```
$.post('/index.php', { key: 'value' }, function(data) { alert(data); }); 
```

您可以指定返回值的类型，以便 jQuery 可以自动处理它。如果你从 PHP 脚本返回 JSON 值，那么你应该在最后添加额外的参数：

```
$.post('/index.php', { key: 'value' }, function(data) {
    alert(data.someItem);
  }, 'json'); 
```

但是如果你需要从 PHP 服务器获取数据而不先 POST 或 GET 任何东西，那么你需要实现 Comet。但这是一个多一点的工作:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:03:25.250

[jQuery.post](http://docs.jquery.com/Ajax/jQuery.post)函数的“[回调](http://en.wikipedia.org/wiki/Callback_(computer_science))”部分是您想要查看的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T17:14:41.430

在 http 中，您执行从客户端（Web 浏览器中的 JavaScript）到服务器的请求，然后处理后者返回的信息。您可以选择在两种通信中以何种方式表示信息。

使用 AJAX（可能通过 jQuery）时，您可以向 php 处理程序发出请求，该处理程序负责将信息返回给浏览器，通常格式化为[JSON](http://www.json.org)文字（您可以使用 json_encode() 对响应进行编码，如建议的那样布赖恩）。最终，您将在客户端（例如使用 jQuery）解析它以获得一个 javascript 对象。

（ $.post( url, [data], [callback], [type] ) 函数将自动解析响应并将其交给回调函数，其签名应为 callback(data, textStatus) ，其中*数据*被解析object 和*textStatus*报告成功或失败状态（[jQuery.post](http://docs.jquery.com/Ajax/jQuery.post)）。

# javascript - jQuery 加载 - Google 可视化页面

> ID：1008294
> 
> 赞同：0
> 
> 时间：2009-06-17T16:50:39.927
> 
> 标签：javascript, jquery, google-visualization

我有一个带有几个链接和一个 div 的页面，在我将加载其他内容的同一页面上。其中一些内容是谷歌可视化图表。

就像测试一样，我弹出了谷歌折线图代码。该页面可以自行加载，但是当我尝试将其加载到 div 中（使用 jQuery）时，它不起作用。Firefox 说从 google.com 传输数据并且什么都不做，而 IE 6 有一个 JS 错误说`google`未定义。

我不明白为什么这会是一个问题，但该页面位于 Intranet 上...如果这有助于故障排除。

感谢您提前提供的所有帮助..

这是将 mainContent.html 文件加载到 div 中的代码。

```
 <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $("#A2W").click(function(){
                $("#loadContent").load("mainContent.html");
            });
        }); 
    </script> 
```

mainContent.html 的内容

```
<html>
  <head>
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["linechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Year');
        data.addColumn('number', 'Sales');
        data.addColumn('number', 'Expenses');
        data.addRows(4);
        data.setValue(0, 0, '2004');
        data.setValue(0, 1, 1000);
        data.setValue(0, 2, 400);
        data.setValue(1, 0, '2005');
        data.setValue(1, 1, 1170);
        data.setValue(1, 2, 460);
        data.setValue(2, 0, '2006');
        data.setValue(2, 1, 860);
        data.setValue(2, 2, 580);
        data.setValue(3, 0, '2007');
        data.setValue(3, 1, 1030);
        data.setValue(3, 2, 540);

        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, {width: 400, height: 240, legend: 'bottom', title: 'Company Performance'});
      }
    </script>
  </head>

  <body>
    <div id="chart_div"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:10:29.920

试图将整个 HTML 页面填充到 div 中，而 div 已经是 HTML 页面的一部分，这是灾难的根源。您将完成浏览器尝试找出如何处理所有错误位置的内容。以您刚刚插入的 <head> 元素为例 - 它应该尝试向上移动它吗？它不能停留在原地，因为这没有任何意义。如果将它移动到原来的 <html> 下，它应该替换现有的 <head> 元素吗？

那么 <body> 呢？它已经有了一个 <body>；它应该扔掉吗？啊，但它不能，因为那样它会丢弃 <div> 内的 <html> 内的 <body> ...

可以说，当你做这样的事情时，浏览器的行为是完全未定义的，它可能只是绝望地举起手，什么也不做。

# asp.net - 如何确定页面上是否启用了控件？

> ID：1008308
> 
> 赞同：2
> 
> 时间：2009-06-17T16:53:04.793
> 
> 标签：asp.net

我在 aspx 页面上的面板中有一个文本框。

如果未启用 textBox，我需要禁用 RequiredFieldValidator。

如果面板被禁用，并且 TextBox.Enabled 为 True，则页面上的文本框被禁用（这很好。）

那么，如果 Enabled 属性不可靠，我如何才能知道页面上的 TextBox 是否被禁用呢？

请注意，我需要一个通用的解决方案，因为可能有许多嵌套级别的容器，并且容器并不总是面板。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T17:01:22.193

您可以在控件层次结构中进行递归搜索，如果控件已启用并且其所有祖先也已启用，则您的控件已启用。

```
bool IsControlEnabled (WebControl control)
{
    if (!(control.Parent is WebControl)) 
        return control.Enabled;

    return control.Enabled && 
        IsControlEnabled(control.Parent as WebControl);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T16:57:20.437

您如何禁用容器控件？禁用容器时是否有不能禁用`Textbox`和`RequiredFieldValidator`控件的原因？

# textbox - 富文本框保存文件

> ID：1008312
> 
> 赞同：0
> 
> 时间：2009-06-17T16:54:12.560
> 
> 标签：textbox, rtf

从富文本框中保存 .rtf 文件时，不会保留文件方向，谁能给我解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-19T15:38:43.277

打印机设置未编码在 rtf 文件中（它们仅描述文本的基本格式信息）。

# jquery - 使用 JQuery 隐藏表格列

> ID：1008320
> 
> 赞同：0
> 
> 时间：2009-06-17T16:56:13.340
> 
> 标签：jquery, optimization, performance

此方法用于根据元数据 json 对象的集合隐藏表中的列。表中的每列都有一个对象。目前在一个有约 500 行和约 15 列且隐藏 6 列的表上，此方法需要约 2 秒才能执行。

我正在尝试优化它以使其更快。有什么建议么？

```
function hideHiddenColumns() {
  if (tableMetaData.length) {
    for (var index = 0; index < tableMetaData.length; index++) {
      var item = tableMetaData[index];
      if (!item.DisplayFlag) {
        $table.find('th:nth-child(' + (index + 1) + '), td:nth-child(' + (index + 1) + ')').hide();
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:21:07.287

我不确定`$table`从哪里来，但是好的旧 DOM 而不是复杂的 jQuery 选择器怎么样：

```
$table.each( function() {
  var rows = this.rows;
  var rowCount = rows.length;

  for (var i = 0; i < rowCount; i++) {
    var cells = rows[i].cells;
    if (cells.length > index) {
      $(cells[index]).hide();
    }
  }
}); 
```

显然，这意味着表格中不存在合并的单元格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T17:39:28.727

使用普通的 JS，就像 Tomalak 建议的那样。您还可以`for`使用以下方法优化循环`while`：

```
var item, i = tableMetaData.length;
while (i--) {
  item = tableMetaData[i];
  // do what's gotta be done
} 
```

反向`while`循环曾经是迄今为止最快的循环结构。随着最新 JS 引擎的最新改进，差异不再那么大了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-19T07:17:46.227

这是一种显示和隐藏 HTML 表格列的方法：[jQuery - Tables - Show and Hide Columns](http://tokenposts.blogspot.com/2011/05/jquery-tables-show-and-hide-columns.html)

# silverlight - Silverlight 动画问题

> ID：1008321
> 
> 赞同：0
> 
> 时间：2009-06-17T16:56:14.883
> 
> 标签：silverlight, animation

假设我有以下 XAML 片段，我的困惑是 Storyboard.TargetProperty 的值的含义是什么？即“(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)”的意思。

```
 <DoubleAnimationUsingKeyFrames Storyboard.TargetName="p1" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" BeginTime="00:00:00">
            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
            <SplineDoubleKeyFrame KeyTime="00:00:00.2500000" Value="1"/>
            <SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
        </DoubleAnimationUsingKeyFrames> 
```

...

```
 <Path Height="2.75" Width="2.75" Data="M2.75,1.375 C2.75,2.1343915 2.1343915,2.75 1.375,2.75 C0.61560845,2.75 0,2.1343915 0,1.375 C0,0.61560845 0.61560845,0 1.375,0 C2.1343915,0 2.75,0.61560845 2.75,1.375 z" Fill="#FF9F9B9B" Stretch="Fill" Stroke="#FF000000" StrokeThickness="0" Canvas.Left="7" Canvas.Top="14" x:Name="p1">
            <Path.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </Path.RenderTransform>
        </Path> 
```

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:23:37.190

Storyboard.TargetProperty 指定要随时间变化的特定属性。

如果你自己写，你可以这样说：

```
 <DoubleAnimationUsingKeyFrames Storyboard.TargetName="myRectange"
 Storyboard.TargetProperty="Width" BeginTime="00:00:00">
                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                    <SplineDoubleKeyFrame KeyTime="00:00:00.2500000" Value="1"/>
                    <SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
            </DoubleAnimationUsingKeyFrames> 
```

并简化了很多事情。在上面的示例中，您将随时间更改矩形的“宽度”属性。Blend以其无限的所见即所得方式使定位更加复杂。

在您的示例中，对矩形应用了变换，并且您正在随时间更改该变换。

澄清：Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" 是一个 PropertyPath。它指定将随时间更改的属性。在这个例子中，我们的目标是 Rectangle's->RenderTransforms->first child (the ScaleTransform)->Scale X property。这就是我们所说的将会改变的方式。关键帧指定该值如何随时间变化。

需要记住的一点：变换是静态变化。应用 2 的 ScaleX，物体在 X 维度上翻倍。但是随着时间的推移没有任何变化（屏幕上没有任何变化）。为此，您需要一个动画来随时间改变变换。

hth，埃里克

# python - Windows 上线程和 PyGTK 的执行顺序

> ID：1008322
> 
> 赞同：1
> 
> 时间：2009-06-17T16:56:41.233
> 
> 标签：python, windows, multithreading, pygtk

我在 Windows 上遇到线程和 PyGTK 问题。根据[PyGTK FAQ](http://faq.pygtk.org/index.py?req=show&file=faq21.003.htp)（和我自己的实验），从子线程可靠地更新 GUI 的唯一方法是使用该`gobject.idle_add`函数。但是，不能保证何时调用此函数。我如何保证在`gobject.idle_add`它指向的函数之后调用后面的行？

非常简单和人为的例子：

```
import gtk
import gobject
from threading import Thread

class Gui(object):
    def __init__(self):
        self.button = gtk.Button("Click")
        self.button.connect("clicked", self.onButtonClicked)
        self.textEntry = gtk.Entry()
        self.content = gtk.HBox()
        self.content.pack_start(self.button)
        self.content.pack_start(self.textEntry)
        self.window = gtk.Window()
        self.window.connect("destroy", self.quit)
        self.window.add(self.content)
        self.window.show_all()

    def onButtonClicked(self, button):
        Thread(target=self.startThread).start()

    def startThread(self):
        #I want these next 2 lines to run in order
        gobject.idle_add(self.updateText)
        print self.textEntry.get_text()

    def updateText(self):
        self.textEntry.set_text("Hello!")

    def quit(self, widget):
        gtk.main_quit()

gobject.threads_init()
x = Gui()
gtk.main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T10:59:31.553

不要尝试从线程更新或访问您的 GUI。你只是自找麻烦。例如，“ `get_text`”在线程中工作*的*事实几乎是一个意外。您可能可以在 GTK 中依赖它——尽管我什至不确定——但在其他 GUI 工具包中您将无法这样做。

如果你有真正需要在线程中做的事情，你应该在启动线程*之前*从 GUI 获取你需要的数据，然后使用 更新来自线程的 GUI `idle_add`，如下所示：

```
import time
import gtk
import gobject
from threading import Thread

w = gtk.Window()
h = gtk.HBox()
v = gtk.VBox()
addend1 = gtk.Entry()
h.add(addend1)
h.add(gtk.Label(" + "))
addend2 = gtk.Entry()
h.add(addend2)
h.add(gtk.Label(" = "))
summation = gtk.Entry()
summation.set_text("?")
summation.set_editable(False)
h.add(summation)
v.add(h)
progress = gtk.ProgressBar()
v.add(progress)
b = gtk.Button("Do It")
v.add(b)
w.add(v)
status = gtk.Statusbar()
v.add(status)
w.show_all()

def hardWork(a1, a2):
    messages = ["Doing the hard work to add %s to %s..." % (a1, a2),
                "Oof, I'm working so hard...",
                "Almost done..."]
    for index, message in enumerate(messages):
        fraction = index / float(len(messages))
        gobject.idle_add(progress.set_fraction, fraction)
        gobject.idle_add(status.push, 4321, message)
        time.sleep(1)
    result = a1 + a2
    gobject.idle_add(summation.set_text, str(result))
    gobject.idle_add(status.push, 4321, "Done!")
    gobject.idle_add(progress.set_fraction, 1.0)

def addthem(*ignored):
    a1 = int(addend1.get_text())
    a2 = int(addend2.get_text())
    Thread(target=lambda : hardWork(a1, a2)).start()

b.connect("clicked", addthem)
gtk.gdk.threads_init()
gtk.main() 
```

如果你真的，绝对需要在线程中间从 GUI 读取数据（这是一个非常糟糕的主意，不要这样做 - 你会陷入非常令人惊讶的死锁，尤其是在程序关闭时）有Twisted 中的一个实用程序，[blockingCallFromThread](http://twistedmatrix.com/documents/8.2.0/api/twisted.internet.threads.html#blockingCallFromThread)，它将为您完成艰苦的工作。你可以像这样使用它：

```
from twisted.internet.gtk2reactor import install
install()
from twisted.internet import reactor

from twisted.internet.threads import blockingCallFromThread
from threading import Thread

import gtk

w = gtk.Window()
v = gtk.VBox()
e = gtk.Entry()
b = gtk.Button("Get Text")

v.add(e)
v.add(b)
w.add(v)

def inThread():
    print 'Getting value'
    textValue = blockingCallFromThread(reactor, e.get_text)
    print 'Got it!', repr(textValue)

def kickOffThread(*ignored):
    Thread(target=inThread).start()

b.connect("clicked", kickOffThread)
w.show_all()

reactor.run() 
```

如果您想了解魔术是如何工作的，您可以随时[阅读源代码](http://twistedmatrix.com/trac/browser/trunk/twisted/internet/threads.py#L89)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:04:14.360

您可以将这两个函数包装到另一个函数中并在此函数上调用 idle_add：

```
def update_and_print(self):
        self.updateText()
        print self.textEntry.get_text()

def startThread(self):
        gobject.idle_add(self.update_and_print) 
```

# c# - 参数中有二进制数据的 COM 事件

> ID：1008326
> 
> 赞同：0
> 
> 时间：2009-06-17T16:57:24.197
> 
> 标签：c#, c++, com, events

我正在尝试使用 C++ 和 ATL 开发一个 COM 对象，供 C++ 和 C# Windows Mobile 客户端使用。COM 对象包含了连接到我们的服务器并使用我们的专有协议发送/接收数据的所有逻辑。我在想出与 C# 和 C++ 一起正常工作的 OnReceive 事件时遇到了一些困难。

我已经定义了这样的事件函数：

HRESULT OnReceive(BYTE* pBuffer, LONG lSize);

但是当我在 C# 或对象浏览器中查看该函数时，结果如下：

OnReceive(ref byte pBuffer, int lSize);

我如何将“ref byte”视为 C# 中的指针？如何将二进制数据传递给 OnReceive 并允许 C++ 和 C# 客户端访问二进制数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T19:24:20.860

您基本上有两个选择：使用 BYTE 的 SAFEARRAY 或将数据填充到 BSTR 中。后者虽然丑陋，但曾经是将二进制数据传递给 VB6 组件的*默认方法。*虽然我从未尝试过，但我想它也应该适用于 .Net。

# java - 如何以编程方式访问 IPTV 服务器？

> ID：1008331
> 
> 赞同：3
> 
> 时间：2009-06-17T16:58:09.797
> 
> 标签：java, networking, udp, iptv

我的大学目前正在运行 IPTV 试验。要访问该服务，您需要安装 VLC 媒体播放器，并通过它运行从大学内部网下载的文件，每个文件代表一个频道。

文件格式为：

```
#EXTM3U
#EXTINF:0,ITV2
udp://@238.255.0.6:2001 
```

我将其识别为 M3U 播放列表文件。幸运的是，该文件指定了托管服务的服务器的 IP 地址、访问它的端口以及协议，在本例中为 UDP。

我的问题是，我怎样才能以编程方式访问该服务？客户端是否与服务器进行了特定的握手？看到它可以通过 VLC 媒体播放器轻松访问，由于没有使用专有协议，访问数据肯定是微不足道的吗？

我对以编程方式访问 Internet 不太了解。我知道在 Java`Port`中可以构建一个 UDP 模型。我会很感激 Java 中的答案，但任何类似的语言都绰绰有余。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-20T05:46:03.693

它们是交换机级别的特殊握手，它告诉交换机您是多播组的一部分，因此您也将收到数据包。

Bellow 是一个在 Java 中注册和接收 UDP 套接字的示例：

```
 // join a Multicast group and send the group salutations

 InetAddress group = InetAddress.getByName("228.5.6.7");
 MulticastSocket s = new MulticastSocket(6789);
 s.joinGroup(group);
 // get their responses!
 byte[] buf = new byte[1000];
 DatagramPacket recv = new DatagramPacket(buf, buf.length);
 s.receive(recv);
 ...
 // OK, I'm done talking - leave the group...
 s.leaveGroup(group); 
```

[j2ee 指南](http://www.j2ee.me/j2se/1.4.2/docs/api/java/net/MulticastSocket.html)中的示例。

您需要做的是加入多播组，然后只接收数据包并将它们写入文件，然后我会假设 MPEG2、MPEG4 或者发送的流将是您机器上的一个文件，应该可以通过另一个文件播放程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T06:19:36.557

您可能想查看[VLC 的 Java](http://wiki.videolan.org/Java_bindings)绑定。这将使您通过 Java 编程接口控制 VLC。您可以从 Java 中获得 VLC 的所有优点！此外，您还可以使用[其他几个 API 绑定](http://wiki.videolan.org/ExternalAPI)和[接口](http://wiki.videolan.org/Interface)来玩 VLC。

# asp.net-mvc - 子域上的 Asp.Net MVC，标准 MVC 应用程序提供 404

> ID：1008335
> 
> 赞同：0
> 
> 时间：2009-06-17T16:59:07.347
> 
> 标签：asp.net-mvc, subdomain, http-status-code-404

我正在尝试在子域上部署我的 MVC 应用程序，不幸的是我收到 404 错误。

我试图找出是否是 MVC 本身无法处理托管在子域上。

我上传了您在开始一个新项目时获得的标准裸 MVC webapp。索引页面加载，但所有其他需要基于 url 的实际路由的页面都给出 404。

我需要更改什么才能在子域上使用 MVC。

（这一切都设置在 IIS 7.5 服务器上作为单独的网站）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:35:08.563

我在共享托管服务提供商处遇到了这个问题。我必须让他们在 iis7 中将应用程序池更改为“集成模式”而不是“经典”模式才能正常工作。不知道为什么，还没有真正研究过 IIS7

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:19:11.033

这是通过 URL 重写解析子域以指向子文件夹的共享主机吗？

MVC 不关心域名是什么。我已经将它与几个不同的子域一起使用，但它们不在将重写到子文件夹的主机类型上。

# c++ - Boost.Python 和 Python 异常

> ID：1008343
> 
> 赞同：4
> 
> 时间：2009-06-17T16:59:54.427
> 
> 标签：c++, boost-python

如何让 boost.python 代码知道 python 异常？

例如，

```
int test_for(){
  for(;;){
  }
  return 0;
} 
```

如果我将它导出到 python，它不会在 Ctrl-C 上中断。我认为其他例外不会以这种方式起作用。

这是一个玩具示例。我真正的问题是我有一个可能需要数小时才能计算的 C 函数。我想打断它，例如，如果它需要更多的时间。但我不想杀死python实例，在函数内被调用。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:18:09.460

在您的 C 或 C++ 代码中，为 SIGINT 安装一个设置全局标志的信号处理程序，并让您的长时间运行的函数定期检查该标志并在设置标志时提前返回。或者，您可以使用 Python C API 引发 Python 异常，而不是提前返回：请参阅[此处](http://www.python.org/doc/2.5.2/api/exceptionHandling.html)的 PyErr_SetInterrupt 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:02:21.297

我不确定 boost.python 是否有解决方案 - 您可能必须自己处理这个问题。在这种情况下，它与传统的信号处理没有什么不同。简单的解决方案是拥有一个由信号处理程序更改的全局变量，并[定期检查该变量](http://www.gnu.org/s/libc/manual/html_node/Defining-Handlers.html#Defining-Handlers)。另一种解决方案是使用 setjmp/longjmp，但我认为第一种方法在适用时是最好的，因为它简单且更易于维护。

请注意，这是特定于 unix 的 - 我不知道这在 Windows 上是如何工作的。

# c# - System.Diagnostics.Stopwatch 在 Elapsed... 属性中返回负数

> ID：1008345
> 
> 赞同：22
> 
> 时间：2009-06-17T17:00:15.660
> 
> 标签：c#, stopwatch

秒表可以返回负值是正常行为吗？下面的代码示例可用于重现它。

```
 while (true)
        {
            Stopwatch sw = new Stopwatch();
            sw.Start();
            sw.Stop();

            if (sw.ElapsedMilliseconds < 0)
                Debugger.Break();

        } 
```

我可以重现负数的唯一地方是我的虚拟机（由 Hyper-V 在 8 核机器上托管）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T17:06:59.457

这是一个[错误](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=94083&wa=wsignin1.0)。它似乎并没有引起太多关注，所以我建议跟进该报告。

[令人鼓舞](https://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=94083)的解决方法似乎是忽略负值：

```
long elapsedMilliseconds = Math.Max(0, stopwatch.ElapsedMilliseconds); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-09-22T19:01:25.367

我使用 Reflector 反编译了 .NET 2.0 和 .NET 4.0 中的 Stopwatch 类，然后比较了它们之间的差异以了解它是如何修复的。除了添加新的 Restart 方法之外，我发现的唯一不同之处在于：

```
public void Stop()
{
    if (this.isRunning)
    {
        long num2 = GetTimestamp() - this.startTimeStamp;
        this.elapsed += num2;
        this.isRunning = false;
// THE NEXT 4 LINES ARE NEW IN .NET 4.0:
        if (this.elapsed < 0L)
        {
            this.elapsed = 0L;
        }
    }
} 
```

因此，如果值为负数，基本上他们在 Stop 方法中将 elapsed 设置为 0。恕我直言，仍然存在错误：

1.  如果用户在停止秒表之前读取了任何 Elapsed 属性怎么办？你可能仍然会得到一个负值。
2.  重置为 0 是不正确的。*必须经过一段*时间，即使只有几微秒！
3.  它无法处理我和其他人报告的异常大的正消逝值。

**编辑：** 不幸的是，#2 和#3 超出了 .NET Framework 的能力：

这是问题的核心：来自 MSDN 上的[QueryPerformanceCounter](http://msdn.microsoft.com/en-us/library/ms644904%28VS.85%29.aspx)，这是 Stopwatch 类使用的 API：

> 在多处理器计算机上，调用哪个处理器并不重要。但是，由于基本输入/输出系统 (BIOS) 或硬件抽象层 (HAL) 中的错误，您可能会在不同的处理器上获得不同的结果。要指定线程的处理器亲和性，请使用 SetThreadAffinityMask 函数。

不要只使用 .NET 4.0 秒表并假设问题已解决。事实并非如此，除非您希望他们破坏您的线程亲和力，否则他们对此无能为力。从秒表类文档：

> 在多处理器计算机上，线程运行在哪个处理器上并不重要。但是，由于 BIOS 或硬件抽象层 (HAL) 中的错误，您可以在不同的处理器上获得不同的计时结果。要为线程指定处理器关联，请使用 ProcessThread.ProcessorAffinity 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-22T18:02:13.770

[Microsoft Connect Bug](https://connect.microsoft.com/VisualStudio/feedback/details/94083/stopwatch-returns-negative-elapsed-time)上的“Closed as Fixed”解决方案必须意味着他们在 .NET 4 中修复了它。我已经在我的桌面和 VM 上运行了几分钟的重现代码并且没有得到负值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-12-07T16:13:01.347

我发现在 VM 中获得正确经过时间的唯一解决方法是（VB）：

```
Dim tstart AS DateTime = Now
...executing code...
Dim telapsed = (Now - tstart).TotalMilliseconds 
```

# sql - SQL 中的列列表

> ID：1008354
> 
> 赞同：-2
> 
> 时间：2009-06-17T17:02:09.213
> 
> 标签：sql, sql-server, tsql

输入：

```
名称 ID

N1 1
N1 3
N1 4
N1 7
N2 2
N2 1
N2 8
N2 5
N3 4
N3 8
N3 5
N3 3
N4 7
N4 7
N4 7
N4 8

```

输出：

```
名称1 名称2 名称3 名称4
----------------------
  N1 N2 N3 N4
   1 2 4 7
   3 1 8 7
   4 8 5 7
   7 5 3 8

```

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T04:13:39.660

我认为您的问题没有明确定义，但这里有一个解决方案：

```
--CREATE TABLE so1008354 (
--  Name1 VARCHAR(10)
--  ,Name2 VARCHAR(10)
--  ,Name3 VARCHAR(10)
--  ,Name4 VARCHAR(10)
--)
--
--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( 'N1', 'N2', 'N3', 'N4' ) 
--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '1', '2', '4', '7' ) 
--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '3', '1', '8', '7' ) 
--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '4', '8', '5', '7' ) 
--INSERT INTO so1008354 (Name1, Name2, Name3, Name4) VALUES ( '7', '5', '3', '8' ) 

SELECT  *
FROM    so1008354

--
;
WITH    unpvt
          AS ( SELECT   col1,
                        col2
               FROM     so1008354 UNPIVOT ( col2 FOR col1 IN ( [Name1], [Name2], [Name3], [Name4] ) ) AS unpvt
             ) ,
        XLate
          AS ( SELECT   col1 AS NameList_pre,
                        col2 AS NameList
               FROM     unpvt
               WHERE    col2 LIKE 'N%'
             ) ,
        Data
          AS ( SELECT   col1 AS NameList_pre,
                        col2 AS Tokens
               FROM     unpvt
               WHERE    col2 NOT LIKE 'N%'
             )
    SELECT  XLate.NameList,
            Data.Tokens
    FROM    Data
            INNER JOIN XLate ON XLate.NameList_pre = Data.NameList_pre
    ORDER BY XLate.NameList,
            Data.Tokens 
```

这给出了结果：

```
Name1      Name2      Name3      Name4
---------- ---------- ---------- ----------
N1         N2         N3         N4
1          2          4          7
3          1          8          7
4          8          5          7
7          5          3          8

(5 row(s) affected)

NameList   Tokens
---------- ----------
N1         1
N1         3
N1         4
N1         7
N2         1
N2         2
N2         5
N2         8
N3         3
N3         4
N3         5
N3         8
N4         7
N4         7
N4         7
N4         8

(16 row(s) affected) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:08:42.560

你不能这样做，因为根据微软帮助文档：

::= (aggregate_function (value_column) FOR pivot_column IN ())

因此，除非您正在执行某种聚合函数，否则您不会只使用枢轴函数获取列的枢轴。

但是，您可以使用普通的 select 和 case 语句对上述数据进行透视。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:42:01.827

```
Select N1, N2, N3, N4
from
(select N_Column, N_Values from [your_table]) p
PIVOT MIN(Tokens)
FOR NameList IN ([N1],[N2],[N3],[N4])
) pvt 
```

我从您的原始表 [your_table] 中调用了列 N_column 和 N_Values 不确定实际名称。

如果你使用 min, max 你可以聚合任何值，因为只有一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:45:20.637

这并不漂亮，但我为此使用了一个案例陈述，但标题需要预先确定。

```
SELECT CASE heading
WHEN 'N1' THEN value END AS 'N1'
, CASE heading WHEN 'N2' THEN value END AS 'N2'
, CASE heading WHEN 'N3' THEN value END AS 'N3'
, CASE heading WHEN 'N4' THEN value END AS 'N4' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T18:28:09.630

这称为 EAV 设计。如果您期望大量数据，您的性能将非常差。如果是这种情况，您可能希望切换到以 N1 N2 N3 N4 作为列的表，放弃当前的设计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T04:16:47.680

select 'N1' , Name1 from your_able where name1 <> 'N1' union

select 'N2' , Name2 from your_able where name2 <> 'N2'

联盟

select 'N3' , Name3 from your_able where name3 <> 'N3'

联盟

select 'N4' , Name4 from your_able where name4 <> 'N4'

-- 该表未规范化，因此使用了这种 sql。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T20:16:30.833

这有效，但前提是 N1...N4 都具有相同数量的令牌。

```
SELECT 'N1' AS 'Name1', 'N2' AS 'Name2', 'N3' AS 'Name3', 'N4' AS 'Name4'

UNION ALL

SELECT 
        CAST(t1.Tokens AS varchar), 
        CAST(t2.Tokens AS varchar), 
        CAST(t3.Tokens AS varchar), 
        CAST(t4.Tokens AS varchar)

     FROM (

        (SELECT Tokens, ROW_NUMBER() OVER(ORDER BY Tokens) AS rownum FROM so2 WHERE NameList = 'N1') t1
         JOIN (SELECT Tokens, ROW_NUMBER() OVER(ORDER BY Tokens) AS rownum FROM so2 WHERE NameList = 'N2') t2 ON t1.rownum = t2.rownum
         JOIN (SELECT Tokens, ROW_NUMBER() OVER(ORDER BY Tokens) AS rownum FROM so2 WHERE NameList = 'N3') t3 ON t1.rownum = t3.rownum
         JOIN (SELECT Tokens, ROW_NUMBER() OVER(ORDER BY Tokens) AS rownum FROM so2 WHERE NameList = 'N4') t4 ON t1.rownum = t4.rownum
    ) 
```

# php - 检索插入行的索引

> ID：1008359
> 
> 赞同：1
> 
> 时间：2009-06-17T17:03:17.060
> 
> 标签：php, mysql

我正在尝试为我正在处理的项目保留数据库表并使其正常化，但我遇到了问题。我试图弄清楚如何将一行插入到表中，然后找出 auto_incremented`id`列的值设置为，以便我可以将其他数据插入到另一个表中。我知道有一些功能，例如`mysql_insert_id`“获取从先前的 INSERT 操作生成的 ID”。但是，如果我没记错的话`mysql_insert_id`，只返回最后一次操作的 ID。因此，如果站点有足够的流量，这不一定会返回您想要的查询的 ID，因为在您插入行并查找 ID 之间可能已经运行了另一个查询。`mysql_insert_id`这种理解正确吗？非常感谢任何有关如何执行此操作的建议。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T17:06:29.520

`LAST_INSERT_ID()`有会话范围。

它将返回当前会话中插入的标识值。

如果您不在`INSERT`and之间插入任何行`LAST_INSERT_ID`，那么它将正常工作。

请注意，尽管对于多个值插入，它将返回插入的第一行的标识，而不是最后一行：

```
INSERT
INTO    mytable (identity_column)
VALUES  (NULL)

SELECT  LAST_INSERT_ID()

--
1

INSERT
INTO    mytable (identity_column)
VALUES  (NULL), (NULL)

/* This inserts rows 2 and 3 */

SELECT  LAST_INSERT_ID()

--
2

/* But this returns 2, not 3 */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:08:17.023

**你可以：**

A. 假设不会有问题并使用 mysql_insert_id

**或者**

B. 在行中包含时间戳，并在插入另一个表之前检索最后插入的 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:09:03.620

对此的一般解决方案是做以下两件事之一：

1.  创建一个执行插入的过程查询，然后检索最后插入的 id（使用，即 LAST_INSERT_ID()）并将其作为查询的输出返回。

2.  进行插入，再进行一次插入，其中 id 值类似于 (select myid from table where somecolumnval='val')

2b。或者使选择显式和独立，然后使用该值执行其他插入。

第一个的缺点是您必须为每种情况编写一个过程。第二个的缺点是一些数据库引擎不接受这一点，并且它会使您的代码混乱，并且如果您必须在多个列上执行 where 可能会很慢。

这假设您的调用之间可能存在您无法控制的插入。如果您有明确的控制权，则上述其他解决方案之一可能会更好。

# javascript - 在大循环中使用什么具有更高的性能：.indexOf(str) 或 .match(regex)？

> ID：1008364
> 
> 赞同：2
> 
> 时间：2009-06-17T17:04:07.107
> 
> 标签：javascript, regex, arrays, match, indexof

我的页面上有这个array.prototype，它似乎占用了很多处理时间：

```
 Array.prototype.findInArray = function(searchStr) {
          var returnArray = false;
          for (i=0; i<this.length; i++) {
            if (typeof(searchStr) == 'function') {
              if (searchStr.test(this[i])) {
                if (!returnArray) { returnArray = [] }
                returnArray.push(i);
              }
            } else {
              var regexp = new RegExp(".*" + searchStr + ".*");
              if (this[i].match(regexp)) {
                if (!returnArray) { returnArray = [] }
                returnArray.push(i);
              }
            }
          }
          return returnArray;
        } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T17:10:12.230

首先，你知道你不必在两边都有“.*”，对吧？默认情况下，正则表达式将匹配字符串中的任何位置。其次，如果您只是在搜索一个常量字符串，并且不需要使用正则表达式提供的任何高级东西，那么使用`.indexOf()`. 另外，这样您就不必担心转义具有特殊含义的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:09:44.977

正则表达式可以有很大的不同。我想一个简单的、精心设计的正则表达式可能会比 indexOf() 运行得更快或更快。另一方面，一个复杂的正则表达式需要更多的时间，因为它需要做更多的工作。

您还有一个浏览器实现问题，使事情变得模糊不清。如果没有编写一个定时循环来测量每个浏览器根据您的特定需求进行每种类型的检测所花费的时间，您就无法真正得到可靠的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:29:19.977

更糟糕的是，您在循环的每次迭代中创建一个新的正则表达式对象——在循环外定义一次，或者将其作为参数传递。

此外，对于这种用途，**test**比**match**更好更快。

# audio - 在关闭声音的情况下嵌入 YouTube

> ID：1008373
> 
> 赞同：7
> 
> 时间：2009-06-17T17:05:07.620
> 
> 标签：audio, youtube

必须如何更改下面的代码才能在关闭声音的情况下嵌入这个 YouTube？

```
<embed src="http://www.youtube.com/v/etnh6_omu0w&hl&rel=1&autoplay=1&sound=1" type="application/x-shockwave-flash" 
allowscriptaccess="always" allowfullscreen="true" width="200"></embed> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T17:11:30.980

这是应该的代码：

您还需要将其包含在此代码所在的同一文件夹中：

[SWFObject.js](http://swfobject.googlecode.com/files/swfobject_2_2.zip)

那只是一些帮助代码，我不会担心。

代码：

```
 <script type="text/javascript" src="swfobject.js"></script>    
  <div id="ytapiplayer">
    You need Flash player 8+ and JavaScript enabled to view this video.
  </div>

  <script type="text/javascript">

    var params = { allowScriptAccess: "always" };
    var atts = { id: "myytplayer" };
    swfobject.embedSWF("http://www.youtube.com/v/FSz_a_yx9hA&hl&enablejsapi=1&playerapiid=ytplayer", 
                       "ytapiplayer", "425", "356", "8", null, null, params, atts);

    function onYouTubePlayerReady(playerId) {
        ytplayer = document.getElementById("myytplayer");
        ytplayer.mute();
    }

  </script> 
```

好的，我测试了该代码，我知道它可以工作，所以如果您有任何问题，请告诉我，祝您黑客愉快！

在此处获取文档：[YouTube Embedded Player Javascript API 参考](http://code.google.com/apis/youtube/js_api_reference.html#GettingStarted)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T03:05:03.600

~~它在我的网络浏览器中不起作用。~~它说我的 Flash 播放器应该是版本 8+ 但我使用的是带有 javascript 的 Flash Player 9。我在 Firefox 3.11 和 IE 7 上都进行了测试。

我意识到，Flash 播放器在 Firefox 上的支持有点问题（多次更新播放器），一些 Flash 电影可能仍然没有出现（空白），但在 IE 上应该可以正常工作。~~但不在您的示例代码中..~~ 更正：它适用于我的 IE 7。但不适用于 Firefox 3.11。我想知道，为什么 flash player/SWFObject 不能与最近的 firefox 相处。您是否有任何调整或建议可以使 Firefox 3 能够很好地播放*所有*swf？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T05:56:05.707

嵌入标签上可能有一个音量参数： [链接](http://www.htmlcodetutorial.com/embeddedobjects/_EMBED.html)

# bash - 如何将文件保持在 N 行以下？

> ID：1008374
> 
> 赞同：0
> 
> 时间：2009-06-17T17:05:16.793
> 
> 标签：bash

我有一个应该有最新的 N 个条目的日志。如果文件大了几次，没有问题。

我的第一次尝试是定期运行：

```
tail -n 20 file.log > file.log 
```

不幸的是，这只会清空文件。我可以：

```
tail -n 20 file.log > .file.log; mv .file.log file.log 
```

但是，这似乎很混乱。有没有更好的办法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T17:09:25.740

听起来您正在寻找[logrotate](http://teklimbu.wordpress.com/2007/10/16/managing-your-linuxunix-log-files-using-logrotate/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T17:21:20.157

我同意，logrotate 可能是你需要的。如果您仍然需要命令行解决方案，这将完成工作。Ex 是一个行编辑器。除了在 shell 脚本中使用之外，没有人再使用行编辑器了。语法适用于 Sh/Ksh/Bash shell。我认为在 C shell 中也是如此。

```
ex log.001 << HERE
$
-20
1,-1d
w
q
HERE 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T17:18:03.483

[logrotate](http://www.linuxconfig.org/Logrotate)，`size=xxx`其中 xxx 是 20 行的近似大小，可能是`delaycompress`为了保持前一个也可读。

# ant - 如何使用 Ant 远程启动/停止 Tomcat 服务

> ID：1008377
> 
> 赞同：1
> 
> 时间：2009-06-17T17:05:43.110
> 
> 标签：ant

我正在关注这个链接（[http://raibledesigns.com/wiki/Wiki.jsp?page=TomcatAntTasks](http://raibledesigns.com/wiki/Wiki.jsp?page=TomcatAntTasks)）试图弄清楚如何远程启动/停止 tomcat 服务，目前我收到一个错误，说没有可以找到 taskdef 类。我已经安装了ant，我还缺少什么？该链接是启动/停止tomcat服务的好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:55:51.027

You need to put the catalina-ant.jar in your ant's lib directory. It comes with Tomcat.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-08T06:01:24.743

使用 ANT，您不需要外部任务。;)

只需使用 SSHExec 任务来启动和停止（服务或 shell）和 SCP 任务来复制 WAR（或任何东西）。

快速、原生、干净！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-15T16:17:45.023

你改变了蚂蚁罐子的路径吗？

```
<taskdef file="tomcatTasks.properties">
     <classpath>
        <pathelement path="${tomcat.home}/lib/catalina-ant.jar"/>
     </classpath>
</taskdef> 
```

在 tomcat 6 上没有服务器文件夹。

# ruby-on-rails - Ruby中的覆盖模块？

> ID：1008387
> 
> 赞同：0
> 
> 时间：2009-06-17T17:07:16.570
> 
> 标签：ruby-on-rails, ruby

我有这个代码`vendor/{engine}/app/helpers/application_helper.rb`：

```
module ApplicationHelper
  def application_title()
    "Foo"
  end

  def other_method()
    # ...
  end
end 
```

这在`app/helpers/application_helper.rb`：

```
module ApplicationHelper
  def application_title()
    "Bar"
  end
end 
```

从我的应用程序调用时，我按预期得到“Bar” `application_title()`，但我的应用程序看不到`other_method()`. 如何修改`ApplicationHelper`以解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:58:25.760

我不能肯定这就是 Rails 中的问题，但我的猜测是离题不远。对于 Rails 应用程序，最后的“修复”可能不容易应用。

首先，目录列表：

```
> ls -R
.:
bar_then_foo.rb  bar_then_foo2.rb  foo_then_bar.rb  lib_foo  lib_fubar

./lib_foo:
helper.rb

./lib_fubar:
helper.rb 
```

辅助模块：

```
> cat lib_foo/helper.rb 
module Helper
  def foo
    puts "foo"
  end

  def bar
    puts "bar"
  end
end

> cat lib_fubar/helper.rb 
module Helper
  def foo
    puts "foo-bar"
  end
end 
```

红宝石代码：

```
> cat bar_then_foo.rb 
$LOAD_PATH.unshift File.dirname(__FILE__) + '/lib_fubar'
$LOAD_PATH.unshift File.dirname(__FILE__) + '/lib_foo'

require 'helper'

class FoobieDoo
  include Helper
end

f = FoobieDoo.new
f.foo
f.bar

> cat foo_then_bar.rb 
$LOAD_PATH.unshift File.dirname(__FILE__) + '/lib_foo'
$LOAD_PATH.unshift File.dirname(__FILE__) + '/lib_fubar'

require 'helper'

class FoobieDoo
  include Helper
end

f = FoobieDoo.new
f.foo
f.bar 
```

还有一些输出：

```
> ruby bar_then_foo.rb 
foo
bar

> ruby foo_then_bar.rb 
foo-bar
foo_then_bar.rb:12: undefined method 'bar' for #<FoobieDoo:0x1042e93c> (NoMethodError) 
```

因此 Ruby 从末尾开始搜索 $LOAD_PATH 并在找到匹配项后立即停止。

让我们试试别的东西：

```
> cat bar_then_foo2.rb 
$LOAD_PATH.unshift File.dirname(__FILE__) + '/lib_fubar'
$LOAD_PATH.unshift File.dirname(__FILE__) + '/lib_foo'

require 'helper'
load "lib_fubar/helper.rb"

class FoobieDoo
  include Helper
end

f = FoobieDoo.new
f.foo
f.bar

> ruby bar_then_foo2.rb 
foo-bar
bar 
```

想要的结果？

也许您可以修改`app/helpers/application_helper.rb`以在 LOAD_PATH 中搜索其他 application_helper.rb 文件并加载它们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T11:02:13.397

我认为问题在于您希望引擎中的助手覆盖主应用程序中的助手。我相信这在 Engines 插件中有效，但在 Rails 2.3 中没有引入此功能。

来自[http://rails-engines.org/news/2009/02/02/engines-in-rails-2-3/](http://rails-engines.org/news/2009/02/02/engines-in-rails-2-3/)

> 代码混合
> 
> Rails 2.3 不会尝试做引擎插件所做的任何“代码混合”。对于那些不知道的人，这是让您的应用程序覆盖控制器或助手中的单个方法的功能，而无需将整个文件从插件复制到您的应用程序中。
> 
> 我不能肯定地说，但我怀疑这个特性是否会进入 Rails 本身，老实说，我认为这可能是一件好事。虽然代码混合机制非常简洁，但还有其他方法可以覆盖更典型的 Rubyish 方法的实现，并且涉及的魔法更少。我会尽快在这里发布一些示例。

希望这可以帮助。

# java - 寻找开源 Java 帮助 API

> ID：1008396
> 
> 赞同：4
> 
> 时间：2009-06-17T17:09:20.797
> 
> 标签：java, api, open-source, chm

我正在开发一个用 Java 编写的应用程序。
我想让用户阅读应用程序的“帮助”。

我基本上是在寻找Microsoft chm的**Java 免费开源等效项。**我希望它支持“查找”和树状结构。

我愿意自己编写一个组件，但我想知道在尝试重新发明轮子之前是否已经存在现有的替代方案......

有没有可用的选项？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T17:12:23.880

查看由[JSR 97定义的](http://jcp.org/en/jsr/detail?id=97)[JavaHelp](https://javahelp.dev.java.net/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-06T17:10:42.293

您是否看过[http://www.pdfhelp.org](http://www.pdfhelp.org)，它提供了基于 PDF 的免费替代方案？

# web-services - 为什么 JAX-WS 在每次 WS 调用时都获取 WSDL？

> ID：1008401
> 
> 赞同：4
> 
> 时间：2009-06-17T17:09:50.687
> 
> 标签：web-services, netbeans, wsdl, jax-ws

我正在使用 NetBeans 和 JAX-WS，我看到每次调用 WS 时都会获取 WSDL。有没有办法避免这种情况？有什么配置吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T11:31:11.803

It is due to the support for late-binding and the myriad of configuration options that WS-Policy and other WSDL features bring to the table.

See the [JAX-WS RI FAQ](http://jax-ws.java.net/faq/index.html#wsdl_at_runtime).

For the trivial case, yes it is a bit silly and adds some overhead. Once you get into a complex environment with multiple implementations running with slightly different configurations, it makes complete sense.

# asp.net - 如何缓存 IQueryable 对象？

> ID：1008404
> 
> 赞同：4
> 
> 时间：2009-06-17T17:10:11.763
> 
> 标签：asp.net, linq, caching, iqueryable

我有这个方法可以为“UserStatus”表中的所有行返回一个 Linq-to-SQL 查询：

```
public IQueryable<BLL.Entity.UserStatus> GetAll()
{
    var query = from e in _SelectDataContext.UserStatus
                select new BLL.Entity.UserStatus
                {
                    UserStatusId = e.UserStatusId,
                    Enum = e.Enum,
                    Name = e.Name
                };

    return query;
} 
```

这只是一个几乎不会改变的查找表，所以我想缓存结果。我可以将它转换为 a`List<>`并缓存它，但我更愿意返回一个 IQueryable 对象，因为类中的其他方法依赖于它。任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T17:16:00.477

可能`query.ToList().AsQueryable()`是你的解决方案？肯定不是最好的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T17:23:42.417

你不能真正做到这一点—— Querable 更像是一个指针而不是数据。如果您正在缓存，那么您正在缓存数据，因此您需要加载数据。Yapiskan 有正确的想法——缓存生成的 ToList() 并将其带回 AsQueryable()。

请注意，缓存列表没有 DataContext，因此您的查询选项将仅限于加载到列表中的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T17:27:21.787

我不得不问你真正想要缓存什么？查询还是结果？

如果它的结果​​那么上面的建议是有意义的，但如果你想缓存查询以供以后使用，那么我可以建议使用 CompiledQuery 然后将它存储在某个地方......

这是一篇关于[CompiledQuery](http://blogs.msdn.com/wriju/archive/2009/05/05/linq-to-sql-understanding-compiled-query.aspx)以及如何使用它的文章。

同样，这一切都取决于您是否希望查询已被执行......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:12:35.253

查看企业库[缓存应用程序块](http://msdn.microsoft.com/en-us/library/dd203226.aspx)。这是一个非常好的通用缓存架构。

# http - 如何拦截客户端机器的 HTTP 请求和响应（就像提琴手一样）

> ID：1008409
> 
> 赞同：16
> 
> 时间：2009-06-17T17:10:50.390
> 
> 标签：http, networking, proxy

我认为拦截请求的唯一方法是使用代理，但 fiddler 可以以某种方式拦截 HTTP 请求和响应，而无需在任何浏览器上进行任何配置。

引擎盖下发生了什么？

你知道任何图书馆可以做到这一点吗？（任何语言）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-20T16:44:32.150

Fiddler*是*一个代理，用 C# 编写并包装基本套接字。

它在运行时使用适当的 API 调用向 WinINET 注册，并以相同的方式分离。大多数浏览器会自动检测 WinINET 代理设置并使用它。Firefox 没有，这就是当前版本的 Fiddler 安装 Firefox 插件的原因。

-埃里克法 [MSFT]

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-17T17:16:06.200

Fiddler 实际上确实使用了代理。我相信安装程序会自动将 IE 配置为使用 Fiddler 的代理。您还可以将其他浏览器配置为通过相同的代理，这样 Fiddler 也会分析它们的网络流量。

更多信息[在这里](http://www.fiddler2.com/Fiddler/help/hookup.asp)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-17T17:14:26.687

我不知道提琴手是如何做到的，但可以通过Windows上的[分层服务提供程序来完成。](http://en.wikipedia.org/wiki/Layered_Service_Provider)

来自维基百科：

“分层服务提供程序 (LSP) 是 Microsoft Windows Winsock 2 服务提供程序接口 (SPI) 的一项功能。分层服务提供程序是一个 DLL，它使用 Winsock API 将自身插入 TCP/IP 堆栈。一旦进入堆栈，分层服务提供商可以拦截和修改入站和出站 Internet 流量。它允许处理发生在 Internet 和访问 Internet 的应用程序（例如 Web 浏览器、电子邮件客户端等）之间的所有 TCP/IP 流量。 "

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T17:13:51.337

可能在混杂模式下运行网络接口。这就是 WireShark 能够监控网络流量并显示它的方式。

更多信息：[http ://en.wikipedia.org/wiki/Promiscuous_mode](http://en.wikipedia.org/wiki/Promiscuous_mode)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T17:18:06.400

来自 MSDN 关于[扩展提琴手的说明](http://msdn.microsoft.com/en-us/library/bb250446.aspx#ie_introfiddler_topic6)

> Fiddler 支持 JScript .NET 事件处理引擎，允许用户自动修改 HTTP 请求或响应。该引擎可以在 Fiddler 用户界面 (UI) 中修改会话的视觉外观，以引起对错误的注意或从列表中完全删除不感兴趣的会话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T17:19:17.273

我猜你不想听到你可以在 Web 服务器而不是客户端（如果它在本地）中拦截它们，或者可以使用 WPAC（代理自动配置）。

另一种选择是使用像 SocksCap 这样的软件，它“调试”浏览器（或网络服务器）进程，每当他调用一些 winsock 函数时，它们就会拦截它并调用他们自己的代码。

执行此类操作的库（在已调试进程上拦截库调用）是[detours](http://research.microsoft.com/en-us/projects/detours/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T17:23:55.677

另一种选择是使用类似[Wireshark](http://www.wireshark.org/)的东西。[以下内容来自http://www.wireshark.org/](http://www.wireshark.org/)上的“关于”页面

> Wireshark 是世界上最重要的网络协议分析仪，并且是许多行业和教育机构事实上（通常是法律上）的标准。
> 
> ## 特征
> 
> Wireshark 具有丰富的功能集，其中包括：
> 
> *   深入检查数百种协议，并不断添加更多协议
> *   实时捕获和离线分析
> *   标准三窗格数据包浏览器
> *   多平台：在 Windows、Linux、OS X、Solaris、FreeBSD、NetBSD 和许多其他平台上运行
> *   可以通过 GUI 或通过 TTY 模式 TShark 实用程序浏览捕获的网络数据
> *   业内最强大的显示过滤器
> *   丰富的 VoIP 分析
> *   读/写许多不同的捕获文件格式：tcpdump (libpcap)、Pcap NG、Catapult DCT2000、Cisco Secure IDS iplog、Microsoft Network Monitor、Network General Sniffer®（压缩和未压缩）、Sniffer® Pro 和 NetXray®、Network Instruments Observer , NetScreen snoop, Novell LANalyzer, RADCOM WAN/LAN Analyzer, Shomiti/Finisar Surveyor, Tektronix K12xx, Visual Networks Visual UpTime, WildPackets EtherPeek/TokenPeek/AiroPeek 等等
> *   捕获使用 gzip 压缩的文件可以即时解压缩
> *   实时数据可以从以太网、IEEE 802.11、PPP/HDLC、ATM、蓝牙、USB、令牌环、帧中继、FDDI 等读取（取决于您的平台）
> *   对许多协议的解密支持，包括 IPsec、ISAKMP、Kerberos、SNMPv3、SSL/TLS、WEP 和 WPA/WPA2
> *   可以将着色规则应用于数据包列表，以进行快速、直观的分析
> *   输出可以导出为 XML、PostScript®、CSV 或纯文本

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-17T23:03:07.753

在没有代理的情况下拦截流量的另一种方法是在受支持的设备上使用 WCCP。

[http://www.cisco.com/en/US/docs/ios/11_2/feature/guide/wccp.html](http://www.cisco.com/en/US/docs/ios/11_2/feature/guide/wccp.html)

# apache-flex - 从分层数据结构中的子字段计算的父数据

> ID：1008415
> 
> 赞同：1
> 
> 时间：2009-06-17T17:12:37.110
> 
> 标签：apache-flex, parent-child, hierarchical-data

在 flex 3 中，我有一个分层数据结构。我想在树中显示它的内容。我的问题是我有从子节点计算数据的节点。如果子节点的数据发生更改，如何构建层次结构以自动更改这些父节点？例如：

*   每个节点都有一个警告标志。如果某些子警告标志更改为真，那么父警告标志应自动更改设置为真。
*   节点整数字段是子整数字段的总和，如果任何子整数字段发生变化，父整数字段会立即“计算”总和。

是否有一个简单的解决方案可以自动发生良好的结构更改，或者我必须制作一些自定义功能？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T17:28:45.217

我们通过遵循以下模式来做到这一点：

1.  在父类上创建计算值的方法，并使其与事件绑定。
2.  在父级中，为子集合更改时添加事件侦听器。为此，子集合应该是 ArrayCollection 或类似的。
3.  拦截更改事件时，为步骤 1 中提到的方法引发（或有条件地引发）附加到 Bindable 元数据的事件。

这应该会导致任何正在查看父级聚合属性的 UI 都会在子级更新时更新。

这是一个例子：

```
public class Parent
{
    private var children:ArrayCollection = new ArrayCollection();

    public function Parent()
    {
        children.addEventListener(
            CollectionEvent.COLLECTION_CHANGE, 
            function(evt:CollectionEvent):void
            {
                if (...)
                {
                    dispatchEvent(new Event("warningStateChanged"));
                }
            }
        );
    }

    [Bindable("warningStateChanged")]
    public function containsWarnings():Boolean
    {
        for each (var child:Child in children)
        {
            if (child.hasWarning)
            {
                return true;
            }
        }
        return false;
    }
} 
```

# javascript - javascript关键事件的问题

> ID：1008418
> 
> 赞同：0
> 
> 时间：2009-06-17T17:13:05.643
> 
> 标签：javascript, events

我想响应用户击键，我可以这样做，但是当用户击键并且焦点位于地址栏上`Enter`时，我不想响应事件。`Enter`当焦点位于地址栏中时，我无法弄清楚如何阻止我的关键事件处理程序执行。

注意：页面刷新，但我的处理程序首先被调用。

请不要告诉我当焦点在地址栏中时不要做动作，我知道，告诉我如何检查焦点不在地址栏中，谢谢

好的，我知道了，它是 keyup 事件，而不是 keydown，这就是造成这种情况的原因，感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T17:21:09.097

如果用户的焦点在地址栏上并且用户点击了`Enter`键，您将无法阻止它，并且您的事件处理程序甚至不应该运行（尽管页面将重新加载）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:24:41.137

在原型中，您可以将 keylisteners 附加到文档

```
Event.observe(document, 'keypress', function(event){
   if event.keycode == Event.KEY_RETURN { 
       //DO STUFF
   }
}); 
```

所以只关注文档中发生的按键

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:27:24.220

您不能阻止事件处理程序触发。你可以做的是检查焦点在哪里，只在你想要的时候触发，例如当焦点在地址栏上时不触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:34:49.220

在 Firefox 和 Chrome（目前只有两个我必须测试）上，当键盘焦点位于位置栏并按下键时，keydown 和 keypress 事件都不会触发`Enter`。当页面再次加载时，keyup 事件触发，因为我释放它的速度不够快。

所以我想你可以坚持使用 keydown 和/或 keypress 事件，或者跟踪 keydown 事件并忽略任何之前没有 keydown 的 keyup 事件。

# reporting-services - Reporting Services 2008 - 长子报表导致分页

> ID：1008432
> 
> 赞同：4
> 
> 时间：2009-06-17T17:16:42.347
> 
> 标签：reporting-services, ssrs-2008

[与此问题类似](https://stackoverflow.com/questions/461782/ssrs-report-get-rid-of-page-breaks-in-report)，但我有一份“主”报告，其中包含许多子报告。一切都很好，直到其中一个子报表在呈现时（例如，PDF）将占用>页面上剩余的空间。在这种情况下，分页符使子报表在新页面上开始。有时，当一个报表只占用一页的一点空间时，这看起来非常尴尬，然后因为以下子报表太长而中断到下一页。有什么建议么？这不是宽度/边距问题，因为当所有子报表都很短时，它看起来很好。此外，我正在使用 HTML 占位符，并且我没有在子报表上设置任何边距，也没有检查任何这些：

*   在之前添加分页符
*   后添加分页符
*   如果可能，将内容保留在单个页面上

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-24T19:08:30.260

检查 MS 文章[KB938943](http://support.microsoft.com/default.aspx/kb/938943)，我无法解决这个问题...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-14T14:55:27.343

在 Reporting Services 2008 中，**子报表**上有一个名为**KeepTogether**的新属性。这在 2005 年始终是正确的，没有办法改变它。2008 年，我们在摆脱空白和空白页方面取得了巨大成功（图表上的动态高度属性除外，但那是另一张票）。

还要检查**网格**、**矩形**等上的**KeepTogether**。当您不希望它们保持在一起时，将它们全部设置为 False。

 ***** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:00:24.863

子报表中是否有任何分组指定分页符？如果是这样，这可能会导致分页。无论“主”报告中的设置如何。****

# memory-leaks - jmap 在 Windows Server 2003 上不起作用

> ID：1008435
> 
> 赞同：0
> 
> 时间：2009-06-17T17:17:40.880
> 
> 标签：memory-leaks, jvm, heap-memory

jmap 在 XP 上对我来说很好用。但是当我尝试执行命令时，它会抛出错误

没有足够的存储空间来处理。

我使用了以下命令

jmap -dump:format=b,file=heap1.bin 。

请注意，tomcat 在 windows 服务器上作为服务运行。

我在windows xp上也试过了，没有问题。

有任何想法吗？？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-25T20:58:54.553

如果您通过 RDP 执行此操作，您可能需要将 RDP 作为 /console 或 /admin 进入机器，即

```
mstsc /admin 
```

或者

```
mstsc /console 
```

在一台 Windows 2003 服务器上，我需要使用`mstsc /admin`; 另一方面，`mstsc /console`工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-22T20:18:45.523

连接控制台会话解决了这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-05T15:03:57.940

我在 win2k3 机器上遇到了类似的错误，我使用以下方法解决了这个错误：

```
mstsc /admin /v:<hostname> 
```

# php - 如何使用 yum 轻松地将 posix 支持添加到 PHP？

> ID：1008436
> 
> 赞同：20
> 
> 时间：2009-06-17T17:17:53.610
> 
> 标签：php, posix, packages, centos, yum

我正在运行 CentOS 5.2 并使用 yum 来管理软件包。我在安装 php-posix 时运气不佳，但几乎 100% 确信它是一个真实且可用的软件包……在某个地方。有人安装成功了吗？

FWIW，我正在使用以下内容：

`sudo yum install -y php-posix`

**更新：**我意识到这可能是我的主机 (Slicehost) 的问题，因为我实际上为我的 PHP 版本 (5.2.9) 启用了 cli、posix 和 pcntl

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-12-02T00:02:19.450

虽然问题是针对 centos，但请注意，对于 fedora，该`php-posix`软件包是由`php-process` [fedora 11](http://forums.famillecollet.com/viewtopic.php?id=35)提供的。我认为这种变化也会在某个时候影响到 centos。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T17:31:00.583

您可以尝试查看它是否在测试存储库中。

查看它是否在该存储库中。

```
yum --disablerepo=\* --enablerepo=c5-testing list available \*php\* 
```

并安装它。

```
yum --enablerepo=c5-testing install php-posix 
```

但请注意，它所需的 PHP 版本可能比您当前拥有的更高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-03T05:03:49.340

这对我有用，我对 symfony 有问题。

[http://blog.myee.web.id/warning-the-posix_isatty-is-available-failed-install-and-enable-the-php_posix-extension-used-to-colorized-the-cli-output/](http://blog.myee.web.id/warning-the-posix_isatty-is-available-failed-install-and-enable-the-php_posix-extension-used-to-colorized-the-cli-output/)

我希望为你工作。谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:49:29.383

我正在运行 CentOS 5.3。包含的 PHP 已经内置了 Posix 函数。您可能找到也可能没有找到[POSIX 函数的介绍文档](http://us3.php.net/manual/en/intro.posix.php)（这表明这些函数在 Windows 中不可用）。您是否尝试过使用特定功能但它不起作用？

```
 <?php print_r(posix_uname()) ?> 
```

在它自己的文件中为我工作。

# silverlight - MVVM, Animations and Commanding - 启动动画的最佳方式？

> ID：1008440
> 
> 赞同：6
> 
> 时间：2009-06-17T17:18:36.883
> 
> 标签：silverlight, design-patterns, animation, mvvm

用户喜欢动画。请参阅 iphone 以获得一个很好的示例 :) 用户在 iphone 中所做的一切都会启动动画。

输入 MVVM 和 Commanding（我正在专门考虑 Silverlight 2）。用户操作通过命令触发事件，我们坐在 ViewModel 中思考如何为用户触发漂亮的动画......

有一些可能性，但我不觉得其中任何一个特别有品味。

*   有点MVP。让 View 实现一个接口，然后让 VM 在视图上调用一个方法来启动动画。
*   在 Silverlight 3 中，动作/行为可能是一种答案，但我正在尝试找出 SL 2 的最佳方法。
*   从您更新（通过计时器）绑定属性以使事情发生的虚拟机中制作曲奇动画......非常尴尬。

有没有人用一种方法取得了很好的成功？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:22:51.403

通常我使用事件从 Silverlight 2 中的视图模型中触发动画

# c++ - 这是什么意思？

> ID：1008449
> 
> 赞同：0
> 
> 时间：2009-06-17T17:20:39.830
> 
> 标签：c++

这：

```
typedef HRESULT (*PFN_HANDLE)(ClassName&); 
```

它是这样使用的：

```
DWORD ClassName::Wait(PFN_HANDLE pfnh_foo)
{
  while (!done) {
    waitCode = WaitForMultipleObjects(paramA, paramB, paramC, paramD)

    if (waitCode == WAIT_OBJECT_0)
    {
      pfnh_foo(*this);
    }
    else
      done;
  }
  return waitCode;
} 
```

似乎 Wait 在到达 WaitForMultipleObjects 时除了阻塞之外什么都不做，然后再做这个奇怪的 pfnh_foo 事情，要么循环回来再次等待，要么退出

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T17:25:46.423

您的`wait()`函数基本上[等待多个对象](http://msdn.microsoft.com/en-us/library/ms687025(VS.85).aspx)，然后如果等待成功（由返回值指示），则使用[函数指针](http://en.wikipedia.org/wiki/Function_pointer) 调用函数。`PFN_HANDLE``WAIT_OBJECT_0`

```
pfnh_foo(*this); 
```

这使用参数 *this 调用 pfnh_foo 指向的函数。

假设我们有功能：

```
HRESULT someFunction(ClassName& myClassInstance)
{
//blah .. blah
} 
```

将像这样调用等待：

```
PFN_HANDLE pfnh_foo = &someFunction;  //function pointer to someFunction
wait(pfnh_foo); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T17:25:59.263

pfnh_foo 是一个函数指针 - 它正在运行一个函数，以您的类作为参数

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T17:26:28.623

WAIT_OBJECT_0 是您正在等待的第一个句柄，如果是，它执行 pfnh_foo，对于任何其他等待句柄，它都会退出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T17:26:56.813

它使用原型定义了一个指向函数的函数指针：

```
HRESULT someFunction(ClassName &) 
```

然后它获取传入的函数并使用当前对象作为参数调用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T17:27:44.097

pfnh_foo 是一个函数指针。您可以使用普通变量等函数。

typedef HRESULT (*PFN_HANDLE)(ClassName&) 表示 PFN_HANDLE 是一个指向签名函数的指针：

HRESULT foo(ClassName&)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-17T17:27:56.937

这是线程同步代码。
在我看来 ClassName:Wait 在单独的线程中运行并等待指定对象之一发出信号，在调用回调之前它是空闲的
它被用来避免竞争条件

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-17T17:29:12.427

这是一种相互排斥的机制，或者是一种在竞争资源之间进行合作的手段……因此需要“等待”对象。

编辑：维基百科对互斥有很好的介绍，并涉及一些基本问题、算法和数据结构。如果您不熟悉互斥原则，那么值得一读。

[http://en.wikipedia.org/wiki/Mutual_exclusion](http://en.wikipedia.org/wiki/Mutual_exclusion)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T17:49:37.557

所以我可以删除函数指针并在那时直接调用函数。只有当 WaitforMulitpleObject 在 Wait() 中返回时，如果有多个函数需要处理任何已签名的对象，则使用函数指针才有意义。

IE。

```
HRESULT Foo(ClassName& myClass);
HRESULT Bar(ClassName& myClass);

anotherFunction(...)
{
  Wait(Foo);
  Wiat(Bar);
} 
```

# c# - 还有其他更快的方法吗

> ID：1008451
> 
> 赞同：0
> 
> 时间：2009-06-17T17:20:58.083
> 
> 标签：c#, excel, excel-2007, vba

下面的代码执行以下操作：它需要一个范围，然后在一个范围内找到不同的值，并将它们存储在一个 d_distinct 数组中，同样为每个不同的值创建不同的颜色，然后使用 Excel.FormatCondition 它为范围着色.. .（我目前的范围是A1：HM232）

```
for (int t = 0; t < d_distinct.Length; t++ )
{                        
    Excel.FormatCondition cond =
        (Excel.FormatCondition)range.FormatConditions.Add(
        Excel.XlFormatConditionType.xlCellValue,
        Excel.XlFormatConditionOperator.xlEqual, 
        "="+d_distinct[t],
        mis, mis, mis, mis, mis);
    cond.Interior.PatternColorIndex = 
        Excel.Constants.xlAutomatic;
    cond.Interior.TintAndShade = 0;
    cond.Interior.Color = ColorTranslator.ToWin32(c[t]);
    cond.StopIfTrue = false;                        
} 
```

但这工作太慢了......用户将不得不坐下来等待大约一分钟......我就是这样做的，否则如果我用一行代码简单地这样做（它的颜色非常快）

```
range.FormatConditions.AddColorScale(3); 
```

我将无法请求单元格的颜色...（我可以在一个范围内有十多个不同的值）

你能帮我让我的第一种方式更快地工作吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T02:00:35.693

尝试在代码运行时关闭屏幕更新，然后再将其重新打开。在 VBA 中，这将是：

```
Application.ScreenUpdating = False
// do stuff
Application.ScreenUpdating = True 
```

由于您没有使用 VBA，请尝试[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.screenupdating(office.11](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel._application.screenupdating(office.11).aspx) ​​).aspx以获得指导

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T02:06:40.113

您是否尝试过使用 OpenXML SDK 来处理 Office 2007？我已经将它用于单词，发现它比使用 vba 或 COM 快得多。尝试[版本 2.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en)或[1.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=AD0B72FB-4A1D-4C52-BDB5-7DD7E816D046&displaylang=en)。我认为 2.0 仍然是 CTP。不过，在我的书中比 vba 更直观。否则，屏幕更新技巧可能是最简单的事情。

# batch-file - How to make by-turn start of .exe files using the .bat-script

> ID：1008454
> 
> 赞同：0
> 
> 时间：2009-06-17T17:21:10.970
> 
> 标签：batch-file, scripting

I have directory structure:

```
DIR
|-component_name
  |-source
  |-setup.exe
|-another_component_name
  |-source
  |-setup.exe
|-yet_another_component_name
  |-source
  |-setup.exe

and so on... 
```

In every directory like "component_name" I have `setup.exe` file which installs current component to the palette component in Delphi. I need to make `DIR/setup.bat` file that would make by-turn start of `setup.exe` in every component directory in `DIR`.

Thank you in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:33:25.040

**example:**

```
for /f %%i in ('dir /s /b setup.exe') do (
%%i
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:16:55.843

I'm guessing that when you say "by-turn" you mean "one after the other" (i.e., execute the first setup.exe, let it complete, execute the second setup.exe, let it complete, etc).

If setup.exe is **console-based**, then you can just call your .EXEs directly. Each setup.exe will attach to the .BAT file's console window, thus blocking its execution until setup.exe completes. Similar to the for-loop example given by [Bubbafat](https://stackoverflow.com/questions/1008454/how-to-make-by-turn-start-of-exe-files-using-the-bat-script/1008502#1008502):

```
for /f %%i in ('dir /b /s setup.exe') do %%i 
```

However, if setup.exe is **gui-based**, then you'll have to use the CALL command. This will cause the .BAT file to wait for the called process to terminate before executing any more commands:

```
for /f %%i in ('dir /b /s setup.exe') do call %%i 
```

* * *

Now, if I misunderstood you and your EXEs are console-based and you want to execute them all at the same time without waiting for each to complete in turn, then you can use the START command. This will open a new console window for each EXE.

```
for /f %%i in ('dir /b /s setup.exe') do start %%i 
```

* * *

NB: Changed from "for /r" type loop to "for /f" since it will only return existing paths (unlike "for /r", which generates paths that may not exist).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:32:42.373

I think you are asking "how do I run every setup.exe in my directory tree?".

If the list is known ahead of time you can just create a batch file that runs the programs one after another. E.g.

```
component_name\setup.exe
another_component_name\setup.exe
yet_another_component_name\setup.exe 
```

But if the list is not static, and the order they run is not important, then you can use a for loop in a batch file like this:

```
for /F %i in ('dir /B /S *.log') do %i 
```

To preview what this would do add an "echo" before the last "%i" like:

```
for /F %i in ('dir /B /S *.log') do echo %i 
```

If this is not what you meant please clarify what you are asking as it is not clear.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:43:39.500

Use this:

```
for /r %i in (setup.exe) do %i 
```

(or, if you embed it into a .bat file, remember to double the % signs)

# asp.net - 如何从服务器端关闭 jQuery（iFrame）thickbox？

> ID：1008464
> 
> 赞同：2
> 
> 时间：2009-06-17T17:24:14.287
> 
> 标签：asp.net, jquery, server-side, thickbox

如何从服务器端关闭 jQuery 厚框 - 我想让厚框（框架样式）从服务器中的一行关闭 - 当一个动作完成时等。

我使用thickbox 来显示文件上传对话框，一旦上传完成，我想从服务器后面的代码中关闭thickbox（就像使用“关闭”或Esc 键一样）。

此外，当我执行 Reponse.Redirect 时，它会在厚框中打开，我如何将整个内容重定向到新页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:57:38.900

凯，你知道吗？我什至不会费心等待对该评论的回应。

**这个问题没有神奇的解决方案。没有代码片段就足够了。这个问题纯粹是概念性的，你还有一个概念要学习。**

这里的概念是如何使 Javascript 和服务器端编码协同工作以发挥您的优势。**它们是两种截然不同的生物，从服务器端执行客户端任务将不起作用。**

这个问题有很多不同的方法。假设（因为您没有提供任何细节）一旦在厚箱中提交了表单，您希望关闭厚箱。很公平。我的方法是创建一个`close_this_thickbox()`函数，将它放在我的 .js 文件中，然后，一旦提交表单，就可以打印结果页面`<script>close_this_thickbox()</script>`。

*（对于最终用户来说，更简洁的解决方案可能是让表单通过 AJAX 提交，然后`close_this_thickbox`作为回调，但这对于这里的讨论来说听起来有点太花哨了。）*

与上述概念类似的方法是获得所需效果*的唯一方法。*您必须创建客户端代码，然后让服务器端打印对所述代码的调用。

至于应用于整个窗口的服务器端重定向，同样，如果没有相同的方法，这种情况就不会发生。除了使用内置的服务器端重定向方法外，您还**必须**调用一段脚本来产生您想要的效果，例如`<script>top.location = 'http://example.com'</script>`. 没有服务器端解决方案是可能的。

希望您能成功应用此概念，并祝您在 Web 开发之旅中好运。有什么需要澄清的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:49:53.250

如果我理解你在问什么是正确的......

您不能从服务器端与 javascript 交互。两者相互独立。无论您在服务器上做什么，已经呈现的 javascript 都不会改变。你想'关闭'它以便在页面加载时关闭它吗？但是如果它已经加载了，你在服务器上做的任何事情都不会关闭它。

其次，如果您在带有asp的服务器上使用response.redirect，并且它被javascript调用，那么您只是在ajax请求中重定向内容。您必须从客户端重新加载才能更改当前脚本。

如果我假设不正确，请纠正我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-26T19:34:34.557

我打算发布一个类似的问题，然后找到了这个帖子，所以我想我会添加它。这是详细信息。

在我的母版页中，我得到了触发厚盒的以下链接

```
<a runat="server" href="~/users/login.aspx?TB_iframe=true&height=160&width=260" class="thickbox">login</a> 
```

这是我 login.aspx 页面的 HTML

```
<div runat="server" id="divAuthenticate" style="margin: 0px 10px 0px 10px;">
  <div class="row">
  <asp:label runat="server" associatedcontrolid="txtUserEmailAddress" text="Email Address"/>
  <asp:textbox runat="server" id="txtUserEmailAddress" cssclass="defaultTxt" width="260px" />
  </div>
  <div class="row">
  <asp:label runat="server" associatedcontrolid="txtUserPassword" text="Password" />
  <asp:textbox runat="server" id="txtUserPassword" cssclass="defaultTxt" width="260px" />
  </div>
  <div class="row">
  <asp:label id="lblMsg" runat="server" forecolor="Red" />
  </div>
  <div class="row" style="text-align:right;">
  <asp:button runat="server" id="cmdLogin" cssclass="button" text="login" />
  </div>
</div>

  <div id="divContinue" style="margin: 40px;" runat="server" visible="false">
  <asp:button runat="server" id="cmdContinue" cssclass="button" text="Continue..." onclientclick="self.parent.tb_remove();self.parent.location.reload(true);"  />
  </div> 
```

我的 login.aspx 页面背后的代码如下

```
 Protected Sub cmdLogin_Click(ByVal sender As Object, ByVal e As EventArgs) Handles cmdLogin.Click

    If users.authenticate(txtUserEmailAddress.Text, txtUserPassword.Text) = sqlHelpers.userCommand.success Then

        'store the username so that next time around we can load it to the username textbox
        Dim cookie As New HttpCookie("username")
        cookie.Values.Add("userName", txtUserEmailAddress.Text)
        cookie.Expires = DateTime.Now.AddDays(5)
        Response.Cookies.Add(cookie)

        FormsAuthentication.SetAuthCookie(txtUserEmailAddress.Text, True)

        divAuthenticate.Visible = False
        divContinue.Visible = True

    Else
        lblMsg.Text = "invalid username or password!"

    End If
End Sub 
```

因此，当用户成功通过身份验证时，我只需隐藏一个 div 并显示另一个。另一个包含关闭厚盒并重新加载父级的继续按钮。现在这不是最好的解决方案，但它希望有人可以提供一些代码，这些代码会在成功提交任务后触发自动关闭厚盒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-27T19:26:13.117

这是你需要的吗？

```
OnClick="self.parent.tb_remove();self.parent.location.href = 'Checkout.aspx';" 
```

我想我正在做类似的事情。Checkout 按钮在厚框中，当点击 checkout 时，它会重定向到 Checkout.aspx

# c# - 重载 Stack.Push？

> ID：1008472
> 
> 赞同：1
> 
> 时间：2009-06-17T17:26:10.090
> 
> 标签：c#

我正在尝试通过递归扫描和收集文件将 FileInfo 详细信息添加到我的 xml 文件中。但是，我遇到了一些麻烦，我不太确定如何解决这个问题。

这是我的代码：

```
public static class ScanAndSerialize
{
    public static void Serialize()
    {
        List<string> dirs = FileHelper.GetFilesRecursive(@"s:\project\");

        XmlSerializer SerializeObj = new XmlSerializer(dirs.GetType());
        string sDay = DateTime.Now.ToString("MMdd");
        string fileName = string.Format(@"s:\project\{0}_file.xml", sDay);
        TextWriter WriteFileStream = new StreamWriter(fileName);
        SerializeObj.Serialize(WriteFileStream, dirs);
        WriteFileStream.Close();

    }
}

static class FileHelper
{
    public static List<string> GetFilesRecursive(string b)
    {
        List<string> result = new List<string>();

        Stack<string> stack = new Stack<string>();
        stack.Push(b);

        while (stack.Count > 0)
        {
            string dir = stack.Pop();

            try
            {
                result.AddRange(Directory.GetFiles(dir, "*.*"));

                foreach (string dn in Directory.GetDirectories(dir))
                {
                    DirectoryInfo dirInfo = new DirectoryInfo(@"s:\project\");
                    dirInfo.Name.ToString();
                    dirInfo.Attributes.ToString();
                    dirInfo.CreationTime.ToString();
                    dirInfo.Exists.ToString();
                    dirInfo.LastAccessTime.ToString();
                    dirInfo.LastWriteTime.ToString();

                    stack.Push(dn);                    

                }

            }
            catch
            {

            }
        }
        return result;

    }

} 
```

}

好的，我遇到错误的地方是我试图获取 dirInfo.Name.ToString() 和其他代码行，并以某种方式将它们合并到呈现带有这些详细信息的 XML 文件中。错误是我尝试过的 Push 不能重载：

```
stack.Push(dn, dirInfo.Name.ToString(), dirInfo.Attributes.ToString().....) 
```

有人有什么想法吗？我是在倒退吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T17:31:56.213

我不确定这里发生了什么......首先， Directory.GetFiles 已经可以递归地获取所有文件：

```
Directory.GetFiles(path, "*.*", SearchOptions.AllDirectories); 
```

GetDirectories 可以做同样的事情。从您的代码来看，您的函数名为 GetFiles 但它正在获取目录？

其次，为了将信息推送到堆栈上，为什么不使用`Stack<FileInfo>`or `Stack<DirectoryInfo>`，然后在编写 XML 文件、读取所需信息并将其写入 XML 时手动弹出每个？

**编辑：**这是一个更简单的例子。我假设您正在尝试从目录中获取所有文件（递归）并输出有关它们的信息。我将把你的两个函数组合在一起（因为已经存在一个好的 GetFiles）。

```
using System.Xml;

public static void WriteXMLForAllFiles(string directory, string outputFilePath)
{
    XmlWriterSettings settings = new XmlWriterSettings();
    settings.Indent = true;

    XmlWriter writer = XmlTextWriter.Create(outputFilePath, settings);

    writer.WriteStartDocument();
    writer.WriteStartElement("Files");

    foreach( string file in Directory.GetFiles(directory, "*.*", SearchOptions.AllDirectories) )
    {
        FileInfo fileInfo = new FileInfo(file);
        writer.WriteStartElement("file");

        writer.WriteAttributeString("path", file);
        writer.WriteAttributeString("creationTime", fileInfo.CreationTimeUtc.ToString());
        writer.WriteAttributeString("lastWriteTime", fileInfo.LastWriteTimeUtc.ToString());

        writer.WriteEndElement();
    }

    writer.WriteEndElement();
    writer.WriteEndDocument();
    writer.Close();
} 
```

在我查看了你的代码之后，你没有使用 Stack<> 做任何事情，所以忽略它。如果您想要一个与原始代码相关的示例：

```
public static List<FileInfo> GetFilesRecursive(string b)
{
    List<FileInfo> fileList = new List<FileInfo>();

    foreach( string file in Directory.GetFiles(directory, "*.*", SearchOptions.AllDirectories) )
    {
        fileList.Add(new FileInfo(file));
    }

    return fileList;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:34:07.253

**更新**修复错误

只需使用 a`Stack<DirectoryInfo>`而不是 a`Stack<string>`

```
public static class ScanAndSerialize
{
    public static void Serialize()
    {
        List<string> dirs = FileHelper.GetFilesRecursive(@"s:\project\");
        XmlSerializer SerializeObj = new XmlSerializer(dirs.GetType());
        string sDay = DateTime.Now.ToString("MMdd");
        string fileName = string.Format(@"s:\project\{0}_file.xml", sDay);
        TextWriter WriteFileStream = new StreamWriter(fileName);
        SerializeObj.Serialize(WriteFileStream, dirs);
        WriteFileStream.Close();

    }
}

static class FileHelper
{
    public static List<string> GetFilesRecursive(string b)
    {
        List<string> result = new List<string>();

        var stack = new Stack<DirectoryInfo>();
        stack.Push(new DirectoryInfo (b));

        while (stack.Count > 0)
        {
            var actualDir = stack.Pop();
            string dir = actualDir.FullName;

            try
            {
                result.AddRange(Directory.GetFiles(dir, "*.*"));

                foreach (string dn in Directory.GetDirectories(dir))
                {
                    DirectoryInfo dirInfo = new DirectoryInfo(dn);
                    dirInfo.Name.ToString();
                    dirInfo.Attributes.ToString();
                    dirInfo.CreationTime.ToString();
                    dirInfo.Exists.ToString();
                    dirInfo.LastAccessTime.ToString();
                    dirInfo.LastWriteTime.ToString();

                    stack.Push(dirInfo);

                }

            }
            catch
            {

            }
        }
        return result;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:33:19.783

封装您要存储的信息，然后从中制作堆栈：

```
public class TraversalData {
  // All the info you'd like to keep track of.
  public string Name;
  public string Attributes;
  // ...
}

Stack<TraversalData> data = ...

// ...

foreach (string dn in Directory.GetDirectories(dir)) {
  // Make a TraversalData out of the information you want to store.
  TraversalData td = // ...

  data.Push(td);
} 
```

# iphone - 为什么我的 iPhone 应用程序在 1 小时后立即崩溃？

> ID：1008493
> 
> 赞同：1
> 
> 时间：2009-06-17T17:30:10.880
> 
> 标签：iphone

我的 iPhone 应用程序在 1 小时过去后立即崩溃（我正在使用开发省配置文件）。开发prov profile有什么限制吗？它与内存泄漏有关吗？但为什么正好是 1 小时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:16:18.277

*   将 iphone 连接到 Organizer “XCode--> Window menu --> Organizer”。
*   检查崩溃日志。

-编辑错过了您正在开发应用程序的那部分，在调试模式下运行应用程序并检查调试器控制台，输入 - **bt** 以回溯堆栈。

# java - 在 Java 中将 iCal 转换为 HTML 或纯文本

> ID：1008497
> 
> 赞同：7
> 
> 时间：2009-06-17T17:31:14.077
> 
> 标签：java, icalendar

我正在寻找一个 Java API 来将 ICS（又名 iCal）附件转换为格式良好的 HTML 或纯文本以供显示。理想情况下，它将能够处理：

*   将日期转换为指定的时区。
*   将重复模式扩展为人类可读的句子。
*   单个文件中的多个 VCALENDAR 记录。

我在看 iCal4j，它有一个很好的 DOM 解析器，但除了 iCal 之外没有其他方法可以序列化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:48:15.313

我没有找到 ical4j 的更好替代品。我使用它相当成功。不幸的是，正如您所指出的，它所做的只是绑定到 XML，没有其他方法可以将其输出到其他东西。您可以在创建后遍历 DOM 并输出相关文本 - 虽然这看起来有点奇怪，因为您想要的只是文本/html，但我遇到了同样的问题，最后只是解析了 XML。

iCal4j API 有点奇怪，您可能希望放松解析并启用 Outlook/Notes 兼容性来帮助您。您可以编写自己的 Parser 并以这种`net.fortuna.ical4j.data.CalendarParser`方式实现必要的信息并将其提取为纯文本。我认为默认值`net.fortuna.ical4j.data.CalendarParserImpl`是大约 500 行代码，你也可以破解它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T23:39:56.107

抱歉，伙计，如果您四处搜索却一无所获，那么您肯定有一套独特的要求，是时候进行创新了。

拿走你所拥有的，想出一些想法，然后尝试一下，工作就来了！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-03T01:44:20.097

我制作了一个输出纯文本的 iCalendar API。所有日历元素（VCALENDAR、VEVENT 等）都有一个 toContent() 方法，可以生成纯文本。将多个 VCalendar 对象转换为一个长字符串真的很容易。例如：

```
 List<VCalendar> calendars = new ArrayList<VCalendar>();
   // add VCalendars here
   // then concated the text of each into one long string
   String allContent = calendars.stream()
       .map(v -> v.toContent())
       .collect(Collectors.joining(System.lineSeparator())); 
```

要导入多个 VCalendar，您只需使用 processITIPMethod 方法通过 PUBLISH 方法导入它们。它可以处理VCalendar objects.String 的列表。

如果你想要 HTML，你必须自己做。

您可以在[http://jfxtras.org/上查看](http://jfxtras.org/)

您可以在[https://github.com/JFXtras/jfxtras/tree/8.0/jfxtras-icalendarfx下载它](https://github.com/JFXtras/jfxtras/tree/8.0/jfxtras-icalendarfx)

# jpa - 支持两个 JPA 实现是否可行或推荐？

> ID：1008499
> 
> 赞同：1
> 
> 时间：2009-06-17T17:31:34.480
> 
> 标签：jpa

我们有一个正在开发的应用程序，我们正在考虑支持两种不同的 JPA 实现。

目前我们正在使用 openjpa 并且有经过良好测试的代码。

我换了toplink，运行测试，发现一堆失败。

你会认为因为 JPA 是一个标准，所以不应该有任何差异！

支持两个 JPA 实现的基本原理是我们可以在多个应用服务器上运行。

因此，首先，实现和服务器之间是否存在一对一的映射。例如，我可以在 WAS 上使用 toplink，或者在 Glassfish 上使用 openjpa 吗？

在我进一步调查各种故障之前的第二个问题是，JPA 规范是否如此广泛以至于无法支持两种实现？我是否应该费心尝试使代码与两者一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T14:02:52.343

不，这不是真的 - 应用程序服务器不强制执行任何 JPA 实现，您应该能够将 OpenJPA 与各种应用程序服务器一起使用。就像您可以在任何可以使用任何其他 JPA 实现的地方使用 Hibernate 一样。是的，在事情变得正确之前，您可能需要完成一些 jar 冲突和故障排除......

不，让您的代码适用于两个或多个 JPA 实现并非不切实际。但是这种没有具体需要的练习的目的是相当不切实际的。一般来说，您最好选择最能满足您的要求的 JPA 实现......但是，我可以再次想象，当交替使用不同的 JPA 实现时可能成为必要的情况：客户要求、许可限制、不同的数据库支持、不同的平台支持（例如移动、嵌入式等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T18:01:09.613

通常，JPA 实现是规范的超集。如果您小心地尽量减少对供应商特定功能的依赖，则应用程序应该是可移植的。

但在实践中，实现之间可能存在细微差别，这使得应用程序很难真正跨 JPA。

在我看来，最好尽可能地坚持标准，以便移植到其他 JPA 实现时只需进行最少的更改。如果您在特定环境中为特定公司开发应用程序，那么针对多个 JPA 实现对其进行测试没有多大意义，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-07T19:16:22.323

当我们使用 TopLink Essentials 并迁移到 EclipseLink 时，我们注意到了同样的事情。尽管 EclipseLink 基于相同的代码库，但我们的代码在很多地方都出现了问题！

我们发现大多数情况是由于 TopLink Essentials 没有完全遵守 JPA 规范（例如本机查询返回向量列表等）。我希望 EclipseLink 和 Hibernate 之间的可移植性会更好，但可能并不完美。

在某些时候，您可能想要使用一些供应商特定的扩展，例如缓存。出于这个原因，我建议选择 JPA 提供程序并首先仅使用 JPA 规范中指定的功能。如果一段时间后您仍然对特定提供商感到满意，请坚持下去并开始利用供应商特定的功能。

我不认为您选择的应用程序服务器会限制您的 JPA 选项，反之亦然。至少我不知道有任何限制。

# asp.net - 在 JavaScript 中获取 TreeView 选定的节点

> ID：1008508
> 
> 赞同：1
> 
> 时间：2009-06-17T17:34:12.027
> 
> 标签：asp.net, javascript, treeview

我正在寻找一种方法来使用 javascript 简单地了解 TreeView 中的选定节点。假设父子关系中有 n 个节点，那么我想在 javascript 中获取所选节点的值，以便我可以操作和处理在 javascript 中选择的值，而不是执行整页回发来获取所选节点用户在 ASP.Net 中选择的树节点。

是否有任何替代方法可以知道节点以及节点是否有任何子节点或父节点（如果有的话）

这是我用来创建和填充 TreeView 的示例，对于没有示例的最后一条评论感到抱歉，这是完整示例

```
protected void Page_Load(object sender, EventArgs e)
    {
        如果（！IsPostBack）
        {
            树节点 t_Node;
            使用 (OleDbConnection con = new OleDbConnection())
            {
                使用（数据集 t_DS = 新数据集（））
                {
                    使用 (OleDbCommand myCommand = new OleDbCommand())
                    {
                        OleDbDataAdapter t_DA;
                        con.ConnectionString = "Provider=SQLOLEDB;Data Source = .; Initial Catalog = NorthWind; User ID = sa; Password = ";
                        myCommand.CommandText = "select EmployeeID, FirstName + ' ' + LastName As Name from Employees Order by EmployeeID";
                        myCommand.Connection = con;
                        尝试
                        {
                            con.Open();
                            t_DA = new OleDbDataAdapter(myCommand);
                            t_DA.填充（t_DS）；
                            foreach（t_DS.Tables[0].Rows 中的 DataRow t_DR）
                            {
                                t_Node = new TreeNode(t_DR["Name"].ToString(), t_DR["EmployeeID"].ToString());
                                TreeView1.Nodes.Add(t_Node);
                            }

                        }
                        捕捉（例外前）
                        {
                            Response.Write(String.Format("有一个错误{0}", ex));
                        }
                        最后
                        {
                            con.Close();
                        }
                    }
                }
            }
        }
    }

```

寻找有利的答复

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T17:38:13.817

您将拥有一个名为 {TreeView name}_Data 的对象。所有多汁的部分都在那里。要获取选定的节点，您需要 selectedNodeID 属性。例如，如果你有一个名为 Products 的 TreeView，那么试试这个：

```
var selectedItem = Products_Data.selectedNodeID.value;
var selectedNode = Document.getElementById(selectedItem); 
```

# c++ - 如何有效地合并两个 BST？

> ID：1008513
> 
> 赞同：27
> 
> 时间：2009-06-17T17:35:44.070
> 
> 标签：c++, algorithm, data-structures, merge, binary-search-tree

**如何合并两个保持 BST 属性的二叉搜索树？**

如果我们决定从一棵树中取出每个元素并将其插入另一个元素，则此方法的复杂`O(n1 * log(n2))`性为另一棵树（比如）。在这个操作之后，只有一个 BST 有节点。`n1``T1``n2``T2``n1 + n2`

我的问题是：我们能比 O(n1 * log(n2)) 做得更好吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-18T00:14:33.117

纳夫的回答有更多细节：

*   将 BST 展平为排序列表是 O(N)
    *   这只是整个树上的“有序”迭代。
    *   两者都做是 O(n1+n2)
*   将两个排序列表合并为一个排序列表是 O(n1+n2)。
    *   保持指向两个列表头部的指针
    *   选择较小的头并推进它的指针
    *   这就是合并排序的合并工作原理
*   从排序列表创建完美平衡的 BST 是 O(N)
    *   请参阅下面的代码片段了解算法[1]
    *   在我们的例子中，排序列表的大小为 n1+n2。所以 O(n1+n2)
    *   结果树将是二进制搜索列表的概念 BST

三步 O(n1+n2) 导致 O(n1+n2)

对于相同数量级的n1和n2，这优于O(n1 * log(n2))

[1] 从排序列表创建平衡 BST 的算法（在 Python 中）：

```
def create_balanced_search_tree(iterator, n):
    if n == 0:
        return None
    n_left = n//2
    n_right = n - 1 - n_left
    left = create_balanced_search_tree(iterator, n_left)
    node = iterator.next()
    right = create_balanced_search_tree(iterator, n_right)
    return {'left': left, 'node': node, 'right': right} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-17T17:43:17.473

*   Flatten trees into sorted lists.
*   Merge sorted lists.
*   Create tree out of merged list.

IIRC, that is O(n1+n2).

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-17T17:43:11.153

将两棵树展平为排序列表，合并列表然后创建一个新树怎么样？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-27T21:08:19.630

乔纳森，

排序后，我们有一个长度为 n1+n2 的列表。用它构建二叉树需要 log(n1+n2) 时间。这与归并排序相同，只是在每个递归步骤中，我们不会像归并排序算法那样拥有 O(n1+n2) 项。所以时间复杂度是log(n1+n2)。

现在整个问题的复杂度是O(n1+n2)。

如果两个列表的大小相当，我也会说这种方法很好。如果大小无法比较，那么最好将小树的每个节点都插入到大树中。这将花费 O(n1*log(n2)) 时间。例如，如果我们有两棵树，一棵大小为 10，另一棵大小为 1024。这里 n1+n2 = 1034，其中 n1log(n2) = 10*10 = 100。所以方法必须取决于两棵树的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-30T10:12:43.920

O(n1 * log(n2)) 是平均情况，即使我们有 2 将任何未排序的列表合并到 BST 中。我们没有利用列表是排序列表或 BST 的事实。

根据我的说法，假设一个 BST 有 n1 个元素，另一个有 n2 个元素。现在将一个 BST 转换为 O(n1) 中的排序数组列表 L1。

合并 BST(BST, Array)

if (Array.size == 0) return BST if(Array.size ==1) 在 BST 中插入元素。返回 BST；

在数组中找到左元素< BST.rootnode 和右元素>=BST.rootnode 的索引，即Index。if(BST.rootNode.leftNode ==null ) //ie No left node { 将 Index 到 0 的所有数组插入到 BST 的左边 } else { Merged BST(BST.leftNode, Array{0 to Index}) }

if(BST.rootNode.rightNode ==null)//ie No right node { 将Index到Array.size的数组全部插入BST的右边} else { Merged BST(BST.rightNode, Array{Index to Array.size} ) }

返回 BST。

每次我们对数组和 BST 进行分区以处理子问题时，该算法将花费 << 时间而不是 O(n1 * log(n2))。

* * *

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-08T06:04:48.700

这个想法是使用迭代中序遍历。我们为两个 BST 使用两个辅助堆栈。由于我们需要以排序形式打印元素，所以每当我们从任何树中获得较小的元素时，我们都会打印它。如果元素更大，则我们将其推回堆栈以进行下一次迭代。

# c++ - 在关闭 Qt 4.5 应用程序时，Visual Studio 报告它已检测到内存泄漏

> ID：1008514
> 
> 赞同：1
> 
> 时间：2009-06-17T17:36:05.737
> 
> 标签：c++, visual-studio-2008, memory-leaks, qt4

我正在使用 Visual Studio 2008 在 Windows 上构建 Qt 4.5 应用程序。每当我在调试模式下运行我的应用程序然后将其关闭时，Visual Studio 都会在输出窗格中打印以下内容：

> 检测到内存泄漏！
> 转储对象 ->
> {696512} 位于 0x01981AB0 的普通块，24 字节长。
> 数据：< > 00 CD CD CD 00 00 00 00 00 00 00 00 00 00 00 00
> {696511} 正常块位于 0x02E59B70，12 字节长。
> 数据：<U2g U2g> B0 1A 98 01 E8 55 32 67 E8 55 32 67

并且输出报告了数百个这样的块。在使用 Qt 4 的模型/视图框架时，我特别注意到了这一点。Qt 实际上是否存在内存泄漏，或者是否存在 Visual Studio 误报泄漏的情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T17:04:06.557

内存泄漏信息由调试窗口运行时提供。您的程序可以交互和配置它。

大括号`{696512}`中的数字是分配订单号。如果这个数字总是相同的，那么你可以通过将数字传递给这个分配来设置一个断点[`_CrtSetBreakAlloc`](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/crtsetbreakalloc?view=msvc-170)。再次在调试器中运行程序，当泄漏的内存被分配时，调试器将停止。

在 main 中尽早调用此函数。如果数字并不总是相同，请尝试用减少的代码重现内存泄漏，直到它总是相同。

有关详细信息，请参阅[使用 CRT 库查找内存泄漏](https://docs.microsoft.com/en-us/visualstudio/debugger/finding-memory-leaks-using-the-crt-library?view=vs-2022)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-27T15:26:55.140

我有机会使用 DevPartner 来分析我的项目。令人惊讶的是，它报告了 QtGuid4.dll 和 QtCored4.dll 中的内存泄漏；但是，在手动查看每个案例后，我发现它们都是误报。

附带说明一下，使用 Qt 的代码中没有报告内存泄漏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T08:37:25.757

确保您在 Qt-way 中使用动态内存，例如

```
#include <QObject>
#include <QString>

class MyClass : public QObject
{
public: 
MyClass (const QString& text, QObject *parent = 0);
...
};

int main()
{
QObject parent;
MyClass *a;
a = new MyClass ("foo", &parent);
...
} 
```

(c) Johan Thelin，“Qt 开发基础”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-04T12:37:33.297

我认为当内存泄漏检测器在 QT 进行清理之前检查泄漏时会发生这种情况。我通过将我的 qtmaind.lib、QtCored4.lib、QtGuid4.lib、QtOpenGLd4.lib 等移动到 VS 项目设置对话框中链接器依赖项框的底部来解决了这个问题。

# hibernate - 具有业务密钥相等性的级联更新：Hibernate 最佳实践？

> ID：1008519
> 
> 赞同：1
> 
> 时间：2009-06-17T17:37:26.017
> 
> 标签：hibernate

我是 Hibernate 的新手，虽然确实有很多示例可供查看，但这里似乎有很大的灵活性，以至于有时很难将所有选项缩小到最好的做事方式。我已经在一个项目上工作了一段时间，尽管阅读了很多书籍、文章和论坛，但我仍然有些头疼。任何资深的建议将不胜感激。

所以，我有一个模型，涉及两个类，从父到子具有一对多的关系。每个类都有一个代理主键和一个唯一受约束的复合业务键。

```
<class name="Container">
    <id name="id" type="java.lang.Long">
        <generator class="identity"/>
    </id>
    <properties name="containerBusinessKey" unique="true" update="false">
        <property name="name" not-null="true"/>
        <property name="owner" not-null="true"/>
    </properties>
    <set name="items" inverse="true" cascade="all-delete-orphan">
        <key column="container" not-null="true"/>
        <one-to-many class="Item"/>
    </set>
</class>

<class name="Item">
    <id name="id" type="java.lang.Long">
        <generator class="identity"/>
    </id>
    <properties name="itemBusinessKey" unique="true" update="false">
        <property name="type" not-null="true"/>
        <property name="color" not-null="true"/>
    </properties>
    <many-to-one name="container" not-null="true" update="false"
                 class="Container"/>
</class> 
```

这些映射背后的 bean 和你想象的一样无聊——没什么特别的。考虑到这一点，请考虑以下代码：

```
Container c = new Container("Things", "Me");
c.addItem(new Item("String", "Blue"));
c.addItem(new Item("Wax", "Red"));

Transaction t = session.beginTransaction();
session.saveOrUpdate(c);
t.commit(); 
```

第一次一切正常，并且 the`Container`和 its `Item`s 都保持不变。但是，如果再次执行上述代码块，Hibernate 会`ConstraintViolationException`为 "name" 和 "owner" 列抛出 --duplicate 值。因为新`Container`实例有一个空标识符，Hibernate 假定它是一个未保存的瞬态实例。这是意料之中的，但不是所希望的。由于持久对象和瞬态`Container`对象具有相同的业务键值，我们真正想要的是发出更新。

很容易让 Hibernate 相信我们的新`Container`实例与旧实例相同。通过快速查询，我们可以获得`Container`我们想要更新的标识符，并将我们的瞬态对象的标识符设置为匹配。

```
Container c = new Container("Things", "Me");
c.addItem(new Item("String", "Blue"));
c.addItem(new Item("Wax", "Red"));

Query query = session.createSQLQuery("SELECT id FROM Container" + 
                                     "WHERE name = ? AND owner = ?");
query.setString(0, c.getName());
query.setString(1, c.getOwner());
BigInteger id = (BigInteger)query.uniqueResult();
if (id != null) {
    c.setId(id.longValue());
}

Transaction t = session.beginTransaction();
session.saveOrUpdate(c);
t.commit(); 
```

`Container`这几乎满足了 Hibernate，但是由于从to Item 级联的一对多关系，对于子对象`ConstraintViolationException`也抛出了同样的问题。`Item`

我的问题是：在这种情况下，最佳做法是什么？强烈推荐使用代理主键，也推荐使用业务键相等。然而，当您将这两个建议一起付诸实践时，Hibernate 的两个最大便利——saveOrUpdate 和级联操作——似乎变得几乎完全无用。在我看来，我只有两个选择：

*   手动获取并设置映射中每个对象的标识符。这显然是可行的，但即使是中等大小的模式，这也是很多额外的工作，Hibernate 似乎很容易做到这一点。
*   编写一个自定义拦截器来获取和设置每个操作的对象标识符。这看起来比第一个选项更干净，但相当笨拙，而且在我看来，您应该编写一个覆盖 Hibernate 的默认行为的插件来遵循推荐设计的映射，这似乎是错误的。

有没有更好的办法？我是否做出了完全错误的假设？我希望我只是错过了一些东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:47:40.307

在添加孩子之前加载容器（无论如何这是一个好主意），这样您就可以利用“设置”行为。当您将项目添加到容器时，它不会被添加。

哦，您还需要确保在 Item 中覆盖 equals 和 hashcode 以确保事情按您期望的方式工作。

所以...

```
Query query = session.createSQLQuery("FROM Container " + 
                                     "WHERE name = ? AND owner = ?");
query.setString(0, "Things");
query.setString(1, "Me");
Container c = (BigInteger)query.uniqueResult();

c.addItem(new Item("String", "Blue"));
c.addItem(new Item("Wax", "Red"));

Transaction t = session.beginTransaction();
session.saveOrUpdate(c);
t.commit(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-17T17:59:18.447

这两个建议（代理主键，业务主键）冲突，因为它们被推荐用于不同的上下文。使用代理主键的面向对象编程似乎做得更好。Hibernate 期望您进行面向对象的编程，因为 Hibernate 的目的是允许您进行面向对象的编程，同时透明地将对象持久保存到数据库中。

# c# - 编辑预编译的通用处理程序 .ashx 的输出

> ID：1008521
> 
> 赞同：0
> 
> 时间：2009-06-17T17:37:56.420
> 
> 标签：c#, asp.net

我继承了一个使用在通用处理程序 (ashx) 中创建的 javascript 的预编译网站。我需要修改js，但我没有源，只有预编译的库。目前，我们只是在 ashx 上做一个 http 请求，修改结果，然后直接在网站上输出：

```
<script runat="server">
    protected string getJs()
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(new Uri(Request.Url, "/js.ashx"));
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        StreamReader sr = new StreamReader(response.GetResponseStream());
        return = sr.ReadToEnd().Replace("old stuff", "new stuff");
    }
</script>

<script type="text/javascript">
    <%= getJs() %>
</script> 
```

这似乎是一种非常迂回的方式。无论如何都可以在不请求页面本身的情况下修改通用处理程序的输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T18:00:10.863

如果您可以访问实际的`dll`. 请参阅[convert-il-to-c-code](https://stackoverflow.com/questions/648051/converting-il-to-c-code)和类似的 SO 问题。

使用[.NET Reflector](http://www.red-gate.com/products/reflector/)，您可能有一个可行的 (C#) 版本的`js.ashx`. 可以（希望）稍微修改此源以直接调用或更好地生成所需的 Javascript。

# random - sed 替换随机数

> ID：1008529
> 
> 赞同：0
> 
> 时间：2009-06-17T17:40:04.920
> 
> 标签：random, sed, numbers, replace, sh

我需要让 sed 替换很多文件中的一些 url。每个文件都有以下内容

```
 http://www.expample.com/file.php?id=xxxxxxx 
```

其中`xxxxx`包括随机数，每个文件中的随机深度，如

```
file 1

_h**p://www.expample.com/file.php?id=xx

file 2

_h**p://www.expample.com/file.php?id=xxxxxxxx 
```

等提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:49:25.857

As the comments say you will need to tell us what you want to replace them with.

But in the mean time something to chew on

```
sed s/id\=[0-9]+/id\=/     file*.* 
```

if they are hex digits

```
sed s/id\=[0-9A-Fa-f]+/id\=/     file*.* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T17:46:44.380

```
sed -e "s/(http:\/\/www\.example\.com\/file\.php\?id=\d+)([^\d]|$)/YOUR_REPLACEMENT\2" 
```

should do it... Untested though, I'm sitting at a sed-less Windows box right now.

# ruby-on-rails - javan-whenever 不使用 Capistrano deploy 编写 crontab

> ID：1008530
> 
> 赞同：4
> 
> 时间：2009-06-17T17:40:28.943
> 
> 标签：ruby-on-rails, cron, capistrano, whenever-capistrano

每当在使用 ec2 on rails 创建的 ec2 实例上运行时，我一直在尝试获取。

当我使用 Capistrano 进行部署时，它表明 crontab 已写入，但是当我登录服务器并运行 crontab -l 时，它似乎没有被更改。

如果我进入发布文件夹并手动运行 --write-crontab 然后运行 ​​crontab -l - 它会正确更新。

有什么想法可能导致这种情况吗？

Capistrano 没有指出任何错误，因此不确定如何调试，尝试了十亿次排列和组合，但没有任何变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-21T01:22:49.990

你应该能够在你的 cap 部署文件中只需要 when capistrano 命令，如下所示：

需要'无论何时/capistrano'

如果您使用的是捆绑器，则还需要添加它：

set :whenever_command, '捆绑执行时'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T03:23:24.140

```
命名空间：部署做
  desc "写入 crontab 文件"
  任务 :write_crontab, :roles => [:db_admin] 做  
    运行“cd #{release_path} && sudo -u root 每当 --write-crontab #{application}”
  结尾  
结尾

```

或者，只要可以帮助解决这个问题，显然还有一个 -user 选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T06:25:58.207

这与 OP 无关，但根据这个[问题](https://github.com/javan/whenever/issues/214)，Capistrano 2.11.1 需要每当 0.7.3 才能解决问题。

# c++ - 这个 C++ 宏有什么作用？

> ID：1008534
> 
> 赞同：1
> 
> 时间：2009-06-17T17:41:38.910
> 
> 标签：c++, operators, macros

这是为 MSVC

```
#define Get64B(hi, lo) ((((__int64)(hi)) << 32) | (unsigned int)(lo)) 
```

具体来说，'operator <<' 的作用是什么？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-17T17:43:36.723

<< 是左移运算符。此宏旨在从两个 32 位值生成 64 位值，使用第一个参数作为新值的高 32 位，第二个参数作为新值的低 32 位。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T17:44:07.457

它接受两个 32 位整数并返回一个 64 位整数，第一个参数为高 32 位，第二个参数为低 32 位。

<< 是左移运算符。它采用高 32 位，将它们移位，然后将结果与低位进行或运算。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T17:44:11.527

operator << 是二元左移运算符。它将 int64 变量 hi 左移 32 位。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T17:46:01.633

AakashM 是正确的。写成方法可能更容易理解

```
__int64 Get64B(__int32 hi, __int32 lo) {
  __int64 combined = hi;
  combined = combined << 32;  // Shift the value 32 bits left.  Combined
                              // now holds all of hi on the left 32 bits
  combined = combined | lo;   // Low 32 bits now equal to lo
  return combined;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T17:44:33.820

它将 hi 的值向左移动 32 位。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T17:44:59.403

那是左移运算符，其标准含义（对于数字类型）是将位向左移动

```
int a = 1;
int b = a << 3; // b is now 1000 binary, 8 decimal 
```

该代码从两个 32 位数字中创建一个 64 位数字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T17:46:52.523

使用两个 32 位 int 返回一个 64 位 int，一个用作 de hi 顺序字节，第二个用作低顺序字节。

hi << 32 将整数转换为 64 位 int 的高位字节。例子：

Get64B (11111111111111110000000000000000, 00000000000000001111111111111111)

返回 1111111111111111000000000000000000000000000000001111111111111111

因为 11111111111111110000000000000000 << 32 返回

1111111111111111000000000000000000000000000000000000000000000000

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-17T17:48:27.497

返回两个 8、16、32 或 64 位整数的 64 位整数。这更安全：hi << 32 | 罗

# php - PHP 会话过期重定向

> ID：1008535
> 
> 赞同：0
> 
> 时间：2009-06-17T17:42:01.670
> 
> 标签：php

> **可能重复：**
> [会话超时或空闲时自动重定向用户……](https://stackoverflow.com/questions/1003001/automatically-re-direct-a-user-when-session-times-out-or-goes-idle)

我有一个登录系统，会话过期，但他们需要刷新页面才能再次显示登录屏幕。相反，我的用户输入数据并点击提交以发现他们已被注销。

会话过期后，有什么方法可以使页面自动重定向到登录页面？

谢谢！

**编辑：：：**

通过查看发现的先前提出的问题，我已使用此应用程序的已接受答案[。](https://stackoverflow.com/questions/1003001/automatically-re-direct-a-user-when-session-times-out-or-goes-idle)谢谢大家的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:50:06.713

您可以使用[元刷新](http://en.wikipedia.org/wiki/Meta_refresh)标签，例如 10 分钟后重定向：

```
<meta http-equiv="refresh" content="600;url=http://example.com/" /> 
```

这不是处理会话到期的非常用户友好的方式，尤其是对于您突出显示的用例。

更好的技术是使用 Javascript 通过获取 keypress 和 mousemove 事件来跟踪用户活动。每分钟，如果有一些活动，就触发一个 XMLHttpRequest 以保持会话处于活动状态。

假设您的会话在 10 分钟后过期，并且此 JS 注意到该时间没有用户活动，它可以在您的页面中的横幅内提醒用户他们的会话已过期并提供重新建立会话的方法等。

这样，执行数据输入或（无论表格用于什么）的人在花时间时不会丢失会话，并且如果他们离开办公桌吃午饭也不会被重定向！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:10:03.047

PHP 函数 ini_get 可用于在页面创建时读取会话生命周期。
JavaScript 可用于在会话过期后执行重定向。

```
// javascript 
var logout = function () {
   //redirect code
};
setTimeout(logout, <%= 1000 * (int)ini_get("session.gc_maxlifetime") %>); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:49:52.563

您可以使用 javascript 定期检查会话是否已过期，如果已过期则重定向。实现取决于您的身份验证系统的详细信息，但基本上包括将会话的到期时间传递给页面，然后将到期时间与当前时间进行比较，直到会话到期。

编辑：示例

我使用prototype.js，所以如果你使用其他框架（或者只是原始JS），你将不得不适应它。

`<input type="hidden" id="expiration" value="<?php echo(time() + SESSION_TTL) ?>" />`

```
<script type="text/javascript">
  new PeriodicalExecuter(function(pe) {
    if(getTime() >= parseInt($('expiration'))) {
      window.location = "http://session.expired.com"
    }
  }
</script> 
```

应该按照你想要的去做一些事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T18:23:23.133

我也采用了 Javascript 解决方案。我们的登录页面破坏了会话，所以我们有一个计时器，在每次页面加载时重置为零。如果该计时器到期，它会重定向到登录页面，这会破坏会话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T18:25:21.833

好吧，最好将用户使用您的表单发送的数据暂时保存，用户有机会再次登录，然后被重定向到他来自的页面，该页面已经填充了旧数据。必须输入两次数据（或者如果您正在处理某事，则在一段时间后让页面本身重定向）是相当烦人的。

如果您想重定向而不保留页面上输入的数据，您至少应该向用户显示他在页面过期之前还剩下多少时间。使用 JavaScript 应该是一个不错的选择。

# security - 当数据是 URL 编码时，HTTP GET 的安全性如何？

> ID：1008539
> 
> 赞同：7
> 
> 时间：2009-06-17T17:43:17.333
> 
> 标签：security, httpwebrequest, get, xmlhttprequest, url-encoding

如果数据是 URL 编码的，那么通过 HTTP GET 发送登录凭据是否足够安全？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-17T17:44:25.787

一点也不。URL 编码很容易可逆。您应该加密传输层（即使用 HTTPS）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-17T17:48:01.677

否 - URL 编码旨在确保您尝试通过 GET 请求发送的所有字符实际上都可以到达另一端。

它实际上被设计为易于编码和解码，以便为传输准备数据，而不是为了安全。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T17:56:44.580

URL 编码不是任何类型的加密，它只是准备要通过网络发送的字符串。

如果您的数据很敏感，那么 GET 应该是完全没有问题的。这是什么原因？

1.  显而易见的，每个偷看 URL 栏的人都会看到数据
2.  数据将留在它通过的每个代理日志中
3.  如果用户离开该站点，则下一个站点将在其日志/网络统计信息 (REFERER) 中记录该 URL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T17:46:43.927

URLEncoding 用于编码/传输，而不是安全性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T17:46:55.377

一点都不安全。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T17:47:07.623

请阅读[URL 编码的目的](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm)

> URL 规范 (RFC 1738, Dec. '94) 提出了一个问题，因为它将 URL 中允许的字符的使用限制为 US-ASCII 字符集的有限子集。
> 
> 另一方面，HTML 允许在文档中使用整个 ISO-8859-1 (ISO-Latin) 字符集范围 - 而 HTML4 扩展了允许范围以包括所有 Unicode 字符集。对于非 ISO-8859-1 字符（Unicode 集中 FF 十六进制/255 十进制以上的字符），它们不能在 URL 中使用，因为没有安全的方法来指定 URL 内容中的字符集信息然而 [RFC2396.]
> 
> URL 应该在 HTML 文档中的任何地方进行编码，其中引用 URL 以导入对象（A、APPLET、AREA、BASE、BGSOUND、BODY、EMBED、FORM、FRAME、IFRAME、ILAYER、IMG、ISINDEX、INPUT、LAYER、LINK 、OBJECT、SCRIPT、SOUND、TABLE、TD、TH 和 TR 元素。）

安全不是这里的重点。如前所述，应在需要时使用 HTTPS。

# c# - HtmlTextWriter 到字符串 - 我忽略了什么吗？

> ID：1008551
> 
> 赞同：13
> 
> 时间：2009-06-17T17:44:28.143
> 
> 标签：c#, asp.net

也许我做错了这一切（如果我错了，请告诉我），但我正在用一个看起来非常简单的概念来撞墙。

此渲染覆盖来自用户控件。

```
protected override void Render(HtmlTextWriter writer)
{
    string htmlAboutToBeRendered = writer.GetWhatHasBeenWrittenToTheWriterSoFar();

    // Do something nefarious, yet unrelated with htmlAboutToBeRendered
} 
```

这似乎有一种明显的方法可以做到这一点，但我似乎找不到它。

任何人都可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-17T17:46:40.243

试试这个：

```
protected override void RenderContents(HtmlTextWriter output)  
{  
   StringBuilder sb = new StringBuilder();  
   HtmlTextWriter htw = new HtmlTextWriter(new System.IO.StringWriter(sb,   
   System.Globalization.CultureInfo.InvariantCulture));  
   foreach (Control ctrl in Controls)  
   {  
      ctrl.RenderControl(htw);  
   }  
  string strContents = sb.ToString(); 
```

}

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T17:50:14.730

您可以从 HttpTextWriter 派生并覆盖 OnTagRender、OnAttributeRender 和 OnStyleRender 方法，并在呈现标签时对其进行修改。OnTagRender 的 MSDN 文档显示了在渲染期间修改标记的示例：

[http://msdn.microsoft.com/en-us/library/system.web.ui.htmltextwriter.ontagrender.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.htmltextwriter.ontagrender.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:33:03.600

使用反射的替代方法：

```
private string GetString(HtmlTextWriter writer) 
{
   // the flags to see the internal properties of the writer
   System.Reflection.BindingFlags flags = System.Reflection.BindingFlags.Default;
   flags |= System.Reflection.BindingFlags.NonPublic;
   flags |= System.Reflection.BindingFlags.Instance;
   flags |= System.Reflection.BindingFlags.FlattenHierarchy;
   flags |= System.Reflection.BindingFlags.Public;

   // get the information about the internal TextWriter object
   System.Reflection.FieldInfo baseWriter = writer.GetType().GetField("writer", flags);

   // use that info to create a StringWriter
   System.IO.StringWriter reflectedWriter = (System.IO.StringWriter)baseWriter.GetValue(writer);

   // now we get a StringBuilder!
   StringBuilder builder = reflectedWriter.GetStringBuilder();

   return builder.ToString();
} 
```

然后使用字符串和 StringBuilder 重新创建 HtmlTextWriter 就很简单了。

这是使用我从Egg​​headCafe上[Tom Spink 和 Rotsey 之间的对话中获得的一些线索构建的](http://www.eggheadcafe.com/conversation.aspx?messageid=30193041&threadid=30193041)

# c# - 将 ListView 导出为 CSV

> ID：1008556
> 
> 赞同：3
> 
> 时间：2009-06-17T17:45:09.250
> 
> 标签：c#, winforms, listview, csv

有谁知道从 ListView 导出的不错的 CSV 导出工具？我需要进行项目更新，而功能蠕变意味着我没有时间自己实现这个最终功能。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-17T19:10:44.367

我想说这不是一个大功能，除非你有一些非常奇怪的要求......但在这种情况下，可能没有任何外部工具可以帮助你。

这是我解决问题的方法：

```
class ListViewToCSV
{
    public static void ListViewToCSV(ListView listView, string filePath, bool includeHidden)
    {
        //make header string
        StringBuilder result = new StringBuilder();
        WriteCSVRow(result, listView.Columns.Count, i => includeHidden || listView.Columns[i].Width > 0, i => listView.Columns[i].Text);

        //export data rows
        foreach (ListViewItem listItem in listView.Items)
            WriteCSVRow(result, listView.Columns.Count, i => includeHidden || listView.Columns[i].Width > 0, i => listItem.SubItems[i].Text);

        File.WriteAllText(filePath, result.ToString());
    }

    private static void WriteCSVRow(StringBuilder result, int itemsCount, Func<int, bool> isColumnNeeded, Func<int, string> columnValue)
    {
        bool isFirstTime = true;
        for (int i = 0; i < itemsCount; i++)
        {
            if (!isColumnNeeded(i))
                continue;

            if (!isFirstTime)
                result.Append(",");
            isFirstTime = false;

            result.Append(String.Format("\"{0}\"", columnValue(i)));
        }
        result.AppendLine();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:28:44.870

[FileHelpers](http://filehelpers.sourceforge.net/)是一个不错的库，可能只是你今天最好的朋友

# python - 我正在编辑的文件名

> ID：1008557
> 
> 赞同：2
> 
> 时间：2009-06-17T17:45:14.350
> 
> 标签：python, vim

我正在编辑 ~/Documents 中的文件。但是，我的工作目录在其他地方，比如 ~/Desktop。

我正在编辑的文件是一个 Python 脚本。我有兴趣做一个像......

：！Python

无需做

:!python ~/Documents/script.py

那可能吗？如果是这样，命令是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T17:48:58.523

试试： !python %

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T18:19:26.277

我经常映射一个键来为我做这件事。我通常使用 F5 键，因为它在 vim 中默认没有与之关联的命令。

我喜欢使用的映射是：

```
:map <F5> :w<CR>:!python % 2>&1 \| tee /var/tmp/robertw/results<CR> 
```

这也将确保您在运行之前已经写出了脚本。在将 stderr 复制到 stdout 之后，它还会在临时文件中捕获任何输出。

如果你做了一个：

```
:set autoread 
```

和一个：

```
:sb /var/tmp/robertw/results 
```

您将完成显示两个缓冲区。一个包含脚本，另一个包含输出，包括。错误，来自您的脚本。通过设置 autoread 显示输出的窗口将在按下 v 键后自动加载。

要记住的一个技巧是使用 cntl-ww 在窗口和映射之间切换，因为它引用 % （当前文件）仅在光标位于包含 Python 脚本的窗口中时才起作用。

我发现这确实减少了我的代码、测试、调试周期时间。

# asp.net - Silverlight 图像查看器控制建议

> ID：1008560
> 
> 赞同：2
> 
> 时间：2009-06-17T17:45:49.997
> 
> 标签：asp.net, silverlight, image, png

任何人都可以建议一个可用于显示图像的良好控件（最有可能是png，并且它始终是我可以指定的一种类型）。这些图像仅在服务器端可用，因此我不必担心客户端上传任何内容。只是在服务器上显示图像。

## 该控件需要具有以下功能：

1.  放大/缩小图像和平移缩放图像的能力。
2.  旋转图像
3.  通过图像来回翻页
4.  图像区域设置为任何大小（例如 200x400），图像适合控制大小，具有缩放功能以提高分辨率。
5.  在图像中定义默认缩放级别和位置。
6.  能够全屏图像控制

## 很高兴拥有以下功能：

1.  在原始图像上叠加一些类型的图像（如线条、框、注释等）
2.  开源

我更喜欢使用某种类型的 Silverlight 控件。

**编辑：**做了更多的调查，我发现silverlight控件的一些功能真的很有用，比如扩展到全屏。页面上的控件很小，并且允许使用全屏图像控件的按钮是一大优势。我仍然无法找到一个可以做我需要的一切的人。

**编辑：**现在只寻找 Silverlight 选项。我已更新标题和说明以反映更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T07:44:16.760

ShineDraw.com 比较了 6 个 silverlight 和 flash 图像旋转器。它解释了它们如何使用一些代码和示例。源代码可用。你绝对应该看看那些：

[http://www.shinedraw.com/3d-illusion/6-new-silverlight-image-rotators/](http://www.shinedraw.com/3d-illusion/6-new-silverlight-image-rotators/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:54:36.590

[也许这些用于图像的 jQuery 插件](http://www.noupe.com/ajax/37-more-shocking-jquery-plugins.html)之一的组合可能会有所帮助。

也许 Slider Gallery 和 Crop 的组合可能会有所帮助。您必须自己将它们合并到一个控件中，但这是一个步骤。如果您关心幻灯片模型中的另一个图像查看器，请尝试[Gian Carlo Mingati 编写的这个 jQuery slideViewer](http://www.gcmingati.net/wordpress/wp-content/lab/jquery/imagestrip/imageslide-plugin.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-24T23:05:43.277

我最终从头开始滚动我自己的 Silverlight 控件。效果非常好，所有动画类型功能的外观和感觉都令人惊叹，您可以使用这些功能来操作从按钮按下到图像等所有内容。我能够进行用户想要的大量自定义。

Silverlight 给我留下了深刻的印象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:52:11.623

我不确定您要显示什么类型的图像，但这个问题有一些答案：

[在 Web 上预览 TIF 文档 (.Net C#)](https://stackoverflow.com/questions/939221/previewing-tif-documents-on-the-web-net-c/939809#939809)

此外，Silverlight：[跨平台嵌入式大图像查看器](https://stackoverflow.com/questions/451621/cross-platform-embeddable-large-image-viewer)

根据您所显示的内容以及您是否可以做出假设，[Microsoft Office Document Imaging Viewer](http://www.microsoft.com/downloads/details.aspx?FamilyID=8f93e445-b1cf-4477-a373-e17417d616bc&displaylang=en)是一种便宜的、可嵌入浏览器的选项（即，如果您的用户都拥有 Office 2003 或更高版本，则免费）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-27T22:44:37.517

试试 vectorlight.net 工具包。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-27T22:46:17.593

请查看 DeepZoom，它具有令人印象深刻的缩放功能。至于其他事情，您可能可以自己实现它们:)

# mysql - 在 Mysql 中存储 URL 的最有效方法？

> ID：1008563
> 
> 赞同：13
> 
> 时间：2009-06-17T17:46:15.300
> 
> 标签：mysql

我想在 MySql 中存储大量 URL 并在列上创建一个唯一索引。如果我将列设为 utf8，那么我将被限制为 varchar(333)，这不足以容纳我的一些 URL。如果我将列声明为 latin1，那么我会得到完整的 1000 个字符（不认为我需要那么多）。但是，我必须对 URL 进行编码，并始终与编码的 URL 保持一致。有没有更好的方法来管理大量 URL？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T21:08:14.113

三种好方法：

1) 使用 TEXT 而不是 VARCHAR。为确保唯一性，您还必须创建一个单独的 VARCHAR 列来存储 MD5() 或 SHA1() 哈希并添加 UNIQUE 或 PRIMARY 索引。这有一个额外的磁盘搜索来检索 URL 的不幸后果，但取决于您的用例，这可能是好的。

2) 使用带有二进制排序规则的 VARCHAR 并使用 COMPRESS() 压缩 URL。

3）我在输入前两个时忘记了第三个。呜呜……

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T17:56:07.810

您可能会想到的一件事是将 URL 的主机名和协议部分存储在单独的表中，并通过密钥引用它。这也可以在以后证明对于获取特定主机的所有 URL 以及帮助解决您的字符串长度问题很有用。

例如：

```
PROTOCOLS
-----------------------
PROTOCOL_ID   INTEGER
PROTOCOL      VARCHAR(10)    (i.e., http, https, ftp, etc.)

HOSTS
-----------------------
id       BIGINT
hostname varchar(256)   

URL
-----------------------
PROTOCOL      INTEGER  FK to PROTOCOLS
HOSTNAME      BIGINT   FK to HOSTS
QUERY_STRING  VARCHAR(333) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:52:18.020

我知道的最常见的做法是使用带有冲突控制的哈希算法，只需使用某种快速的单向编码，这将在 URL 上产生非常低的冲突。

尝试砍掉你知道在所有 url 中都相同的部分（即 HTTP://、www 等）如果 url 都是你的域的一部分，也把它砍掉。

否则，我会重新考虑这个问题，并尝试找到一种不同的方式来完成你想要完成的任何事情。我认为拥有一组独特的 URL 确实可以解决其他一些问题。

# xml - 是否有正当理由在内部将数据保存为 XML？

> ID：1008564
> 
> 赞同：6
> 
> 时间：2009-06-17T17:46:20.947
> 
> 标签：xml, language-agnostic, anti-patterns

在我工作的这些年里，我注意到了一种我认为是反模式的明显趋势：将内部数据维护为大的 XML 字符串。尽管两个最严重的违规者非常相似，但我已经看到了很多不同的方法。

## 网络服务

第一个应用程序是 Web 服务，它提供对 SQL 数据库中潜在的大量数据的访问。在启动时，它或多或少地从数据库中提取所有数据，并将其作为 XML 存储在内存中。（三次。）此应用程序的所有者称其为缓存。我称之为慢，因为在解决这个问题时遇到的每一个性能问题都可以直接追溯到这个东西。（这是一个公司环境，毫无疑问，客户端会因为性能故障而不是服务而受到指责。）这个应用程序确实使用了 XML DOM。

## 进口商

第二个应用程序读取作为从第三方数据库导出的结果而生成的 XML 文件。目标是将这些数据导入专有系统（归我们所有）。执行此操作的应用程序读取整个 XML 文件，并在整个导入序列中维护至少两个、有时多达四个 XML 文件的副本。请注意，数据可以在导入之前进行操作、转换和配置，因此导入器在其整个生命周期内都拥有 XML 格式的数据。不出所料，当提供一个中等大小的 XML 文件时，这个导入器就会爆炸。此应用程序仅将 XML DOM 用于其中一个副本，其余的都是原始 XML 字符串。

我对常识的理解表明，XML*不是*一种在内存中保存数据的好格式，而是数据在输出/传输时应转换为 XML，并在读入和导入时转换为内部数据结构。问题是，我经常遇到完全忽略可伸缩性问题的生产代码，并且为此付出了*大量*额外的努力。（这些应用程序中字符串解析的庞大数量令人恐惧。）

这是一个常见的失败，没有为其他人遇到的工作应用正确的工具吗？还是只是我运气不好？还是我错过了一些非常明显和*好的*情况，在这些情况下将大量数据存储在内存中作为 XML 是正确的和好的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T17:54:26.707

存储在内存中的任何数据都应该在类中。我们谈论的数据量越大，这一点就越重要。Xml 是一种非常臃肿的格式，会降低性能。XML 应该只用于在应用程序之间传输数据。恕我直言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T17:50:54.060

不，我同意。对于您的第一个示例，数据库应该处理几乎所有的缓存，因此将所有数据存储在程序内存中是错误的。这适用于它是否以 XML 或其他方式存储在内存中。

其次，您应该尽快将 XML 转换为有用的表示形式，可能是数据库，然后以这种方式使用它。只有当它是少量数据时，才适合将内存中的所有工作作为 XmlDocument（例如使用 XPath）来完成。字符串解析应该非常谨慎地使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:01:11.563

@Matthew Flaschen 提出了一个很好的观点。我想补充一点，当您加入任何现有项目时，您可能会发现一些您不同意的设计和实施决策。

我们都一直在学习新事物，我们都会犯错误。虽然我同意这似乎是一个“duh”类型的问题，但我确信其他开发人员正在尝试通过缓存的概念来优化代码。

关键是，有时它需要一种温和的方法来说服人们，尤其是开发人员，改变他们的方式。这不是编码问题，而是人员问题。您需要找到一种方法让这些开发人员相信您建议的这些更改并不意味着他们无能。

我建议同意他们的观点，即缓存可能是一个好主意，但您希望通过它来加速功能。创建一个快速演示，与旧方法相比，您的（更合乎逻辑的）实现如何工作。很难与显着的速度改进争论。只是要小心直接攻击他们在对话中实施的方式。你需要这些人与你一起工作。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T17:58:34.657

我也同意，而且我确实认为有些运气不好。

...但是抓住了一根稻草，我可以看到将数据存储为 XML 的唯一用途是用于自动化单元测试，其中 XML 提供了一种模拟测试数据的简单方法。不过，绝对不值得。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T17:58:36.667

我发现我必须这样做才能与旧版 COM 对象进行交互。COM 对象可以采用 xml 或类。填充类的每个成员的互操作开销太大了，处理 xml 是一个更快的选择。我们本可以让 ac# 类与 COM 类相同，但在我们的时间范围内真的很难做到。所以xml它是。并不是说这将是一个好的设计决策，但在处理大型数据结构的互操作时，这是我们能做到的最快的。

我不得不说我们在 C# 端使用了 LinqtoXML，所以使用起来稍微容易一些。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T18:01:22.640

OOP 和数据库呢？Xml 有它的用途，但是（如您所见）将它用于一切可能会出现问题。

数据库可以允许索引、事务等，这将加快您的数据访问

在大多数情况下，对象更易于使用，它们可以更好地了解您的域等。

我不反对使用 xml，但它就像模式一样，它们是一种工具，我们应该了解何时何地使用它们，而不是爱上它们并尝试在任何地方使用它们......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T18:04:46.127

格雷格，

在几个应用程序中，我确实或多或少地遵循了您描述的模式：

编辑：没有划痕。我从未将 XML 存储为字符串（或多个字符串）。我只是将它解析成一个 DOM 并使用它。那很有帮助。

我已将 XML 源代码导入 DOM（Microsoft Parser）并将它们保存在那里以进行所有必需的处理。我很清楚 DOM 导致的内存开销，但我发现该方法仍然非常有用。

*   处理过程中的一些检查需要随机访问数据。selectPath 语句可以很好地用于此目的。

*   DOM 节点可以作为参数在应用程序中来回传递。另一种方法是编写包装每种类型对象的类，并随着 XML 模式的发展对其进行更新。这是一个可怜的（VB6 / VBA）人的多态性方法。

*   将 XSLT 转换应用于 DOM 的全部或部分是轻而易举的事

*   文件 I/O 也由 DOM 处理（xmldoc.save...）

对象的链接列表将消耗相当数量的内存并需要更多代码。我必须自己编写所有搜索和 I/O 功能。

我所认为的反模式实际上是应用程序的旧版本，其中 XML 或多或少被手动解析为结构数组。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T18:19:22.390

对于大量数据，答案是否定的，没有充分的理由将数据直接作为 XML 字符串存储在内存中。

但是，这里有一个由 Alex Brown 撰写的有趣[演示文稿](http://www.xmlprague.cz/2009/presentations/Alex-Brown-High-performance-XML-theory-and-practice.pdf)，介绍了如何以更有效的方式将 XML 保存在内存中。作为“冰冻的溪流”。

[这里](http://www.xmlprague.cz/index.html)还有一段视频，以及 XML 布拉格 2009 上的其他演示文稿。

[链接文本](http://www.xmlprague.cz/2009/presentations/Alex-Brown-High-performance-XML-theory-and-practice.pdf)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-20T10:41:11.117

一般来说，我会尝试使用独立于 XML 序列化的内部数据模型。

但是，在我看来，在**一种情况下使用 XML 作为内部数据结构是有意义的**：如果您的数据模型需要捕获其格式可以由第 3 方扩展的层次关系，并且如果您的应用程序需要在保留扩展的同时转发此数据信息。

举个例子，[伐木工人日志框架](https://fedorahosted.org/lumberjack/)：这个想法是有一个基于 XML 的事件数据模型，其中每个应用程序都可以提供有关事件的分层信息（警告、错误等）。该框架负责收集事件并将它们分发给适当的处理程序。第 3 方可以轻松定义自己对格式的添加，并提供适当的生成器和处理程序。

这里重要的部分是框架必须将 XML 与所有 XML 信息完整地从生成器转发到处理程序。**在这种情况下，实现一个捕获所有必要信息的内部数据结构会导致大多数 XML 本身的重新实现。**因此，使用适当的 DOM 框架进行内部数据表示是有意义的。

# c# - IoC 和 ASP.NET MVC 视图

> ID：1008573
> 
> 赞同：1
> 
> 时间：2009-06-17T17:47:08.607
> 
> 标签：c#, asp.net-mvc, inversion-of-control

有没有让我的 IoC 解决对视图的依赖的好方法？我有自己的基于 Castle Windsor 的 IoC 解析器。我有一个`IResourceService`我想在我的视图中访问以解析一些字符串的权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-26T02:29:37.013

我会采用扩展方法，然后在其中解决我的依赖关系：

```
public static class LocalizationExtentions
{
  public static string Localize(this HtmlHelper html, string resource)
  {
    var localize = IoC.Resolve<ILocalize>();
    return localize.For(resource);
  }
} 
```

在我看来：

```
<h1><%= Html.Localize("MainTitle") %></h1> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T18:46:44.750

您能否在控制器中解决它，然后将其放入 ViewModel 以访问已解决的实例？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:32:28.817

我不使用 Winsor，但我认为当您使用带有代码隐藏的视图时，可以使用 setter 注入。为什么要解决对视图的依赖？这听起来像是一件奇怪的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T20:15:57.700

您能否使用包装器，并在该包装器内直接要求 Windsor 为您解决服务。然后从您的角度来看，只需使用 ResourceHelper 类将所有内容传递给您的已解决服务？您可以像在视图中使用 HtmlHelper 类一样使用 ResourceHelper 类。

```
public interface IInjectionWrapper
{
    T Resolve<T>();
    object Resolve(Type service, object view);
    object Resolve(Type service);
}

public class WindsorWrapper: IInjectionWrapper
{
    private readonly static IWindsorContainer windsor;

    static WindsorWrapper()
    {
        string config = ConfigurationManager.AppSettings["WindsorConfig"];
        FileResource resource = new FileResource(config);

        windsor = new WindsorContainer(new XmlInterpreter(resource));
    }

    public T Resolve<T>()
    {
        T result = windsor.Resolve<T>();

        return result;
    }

    public object Resolve(Type service)
    {
        return windsor.Resolve(service);
    }
}

public interface IResourceService
{
    string LookupString(string key);
}

public class ResourceHelper : IResourceService
{
    private IResourceService _resources;

    public ResourceHelper()
    {
        IInjectionWrapper ioc = new WindsorWrapper();
        _resources = ioc.Reslove<IResourceService>();
    }

    public string LookupString(string key)
    {
        return _resources.LookupString(key);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T20:27:53.383

你愿意下载源代码，做一些小的修改并使用它吗？如果是这样，您可以通过对 Web 表单视图引擎进行一些小的更改来做到这一点，以便在构建管理器创建已编译的页面对象之后，您可以进行属性注入。

否则，除非您创建一个基本控制器并覆盖操作执行方法并注入视图数据，否则它会变得很难看。

* * *

**编辑**

[http://aspnet.codeplex.com/sourcecontrol/changeset/view/23011?projectName=aspnet#266535](http://aspnet.codeplex.com/sourcecontrol/changeset/view/23011?projectName=aspnet#266535)

是处理创建页面实例的文件，在对 viewInstance 进行空检查之后，您可以要求您的服务定位器进行属性注入。

# svn - 有没有办法可视化整个 SVN 存储库？

> ID：1008576
> 
> 赞同：8
> 
> 时间：2009-06-17T17:47:37.137
> 
> 标签：svn, repository, maintenance

我有一个 SVN 存储库，其中有多个项目，每个项目下面都有一个标签/分支/主干结构，如下所示：

项目 1
- 主干
- 标签
- 分支

项目 2
- 树干
- 标签
- 分支

这持续了约 40 个项目。我想做的是清理任何可能存在的废弃分支，但是我不知道有一种方法可以可视化整个存储库树。如果可以避免的话，我真的不想手动浏览每个分支。是否有任何独立工具可以完成此任务？

**编辑：**我意识到 TortoiseSVN、Cornerstone 和类似工具确实允许可视化存储库浏览。然而，我真正想要的是一种同时查看整个结构的方法。有点像如果您可以针对存储库本身运行 TortoiseSVN 的修订图并查看所有项目完全扩展。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-09-17T10:44:18.493

您还可以查看[Gource——](http://gource.io/)一个用于 Subversion 的毫无意义的性感 OpenGL 可视化。它对于可视化 repo 如何随时间变化以及不同的贡献者如何影响项目的不同部分特别有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T17:59:59.600

如果您愿意在该工具上投入一些钱并拥有漂亮的视觉效果，则可以使用鱼眼。否则检查 sventon; 它做基础。

鱼眼[http://www.atlassian.com/software/fisheye/features/repository.jsp](http://www.atlassian.com/software/fisheye/features/repository.jsp) 斯文顿[http://sventon.org/](http://sventon.org/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-17T17:55:05.753

```
svn ls -R [svn://|http://|file://]url/to/repository 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T19:01:43.150

Trac 产品（开源）还提供了存储库的图形视图。（在许多其他功能中）

[Trac 开源项目](http://trac.edgewall.org/)

[追踪源浏览器](http://trac.edgewall.org/browser)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T17:52:11.360

这取决于您正在运行的操作系统。

我主要使用 Mac OS X，所以我选择的 SVN 客户端是[Cornerstone](http://www.zennaware.com/)。这个应用程序在可视化存储库的结构和注释方面做得非常出色。GUI 非常流畅、直观且易于使用。

如果您使用的是 Windows，我不太了解哪个客户端是最好的，但我听说大多数人使用[TortoiseSVN](http://tortoisesvn.tigris.org/)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-17T17:56:25.783

我使用 GUI 客户端来管理我的 SVN 存储库，但我发现另一个非常有用的工具是[WebSVN](http://www.websvn.info/)。这是一个基于 PHP 的应用程序，用于查看您的存储库。它有一个流畅的界面，并为您的源代码提供语法突出显示。您可以为其提供存储库的父路径，以便您可以查看那里的存储库并快速浏览它们以查看内容。由于显而易见的原因，它实际上不能在存储库上运行命令，但是一旦你知道你想要做什么，你就可以使用命令行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T18:05:14.253

除了 Andrew 的 WebSVN 建议之外，我还会推荐[ViewVC](http://www.viewvc.org/download.html)。我向人们解释说，WebSVN 更像是一个 bean counter 的工具，而 ViewVC 更适合开发人员以更有效的方式寻求更详细的信息。当然，这有点开玩笑，但是如果您比较这两种产品，您就会明白我的意思。我已经在我的组织中部署了两者。

# php - Temporary permission to view photos and albums

> ID：1008579
> 
> 赞同：2
> 
> 时间：2009-06-17T17:48:12.487
> 
> 标签：php, mysql, authentication, permissions

I'm making a gallery website. Photos and albums should be hidden from the public by default, but the owner can share a public URL if he wants. I also want to use short URLs for this.

I'm trying to figure out the best way to do this. At first I thought I could have a MySQL table with the short URL code (something like `Zneg8rjK`), and the full URL (`/album/5/`). When the user visits this link (`mysite.com/Zneg8rjK`) it would set a session variable which is just a hash of `/album/5` plus a salt, and then it redirects them to the full URL. Then on that page I can just rehash the current page and check if it's in their session or not. No problem... but what happens when they click on a photo in that album? It breaks down.

So, the next solution I thought of was that I should store a secret key with each album and each photo, and then have a public address like `/album/5/secretkey`. The short URL could just point to this instead. But then how do I give the user to permission to view all the photos in the album? Should I just link each photo to point to the secret version of the photo URL instead, but only if they accessed the album via the secret album URL? My concern is that I want to keep the secret keys/URLs out of the address bar as much as possible so that users don't accidentally share it with people they shouldn't... but it's not a huge concern if there aren't any better solutions.

Thoughts?

* * *

Wait a sec, do I even need to hash the URL? There's no way for clients to modify session variables is there?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T17:58:09.697

I guess it depends a bit on how you check permissions - I'd suggest having a key for a whole album, and a key for individual photo's.

The redirect thing in the first part of your post actually doesn't sound that bad to me, only you'd have to check the supplied key in the session against 2 valid options - one for the individual photo, and one for the album that contains that photo. If either one validates, show the photo (instead of 'break down').

Hope this helps!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:05:44.160

您可能想要像上面的人说的那样做这两个键。您可能不想限制通过 mysite.com/hashhere 之类的 URL 进行访问，而是应该让短 URL 能够包含哈希，因此如果他们有正确的哈希，无论他们转到哪个链接，他们都可以查看它.

为了使其更加安全，请让画廊的所有者也可以选择刷新哈希密钥，以便如果他们与用户共享并且有人发布了公共 URL 或其他内容，他们可以再次将其锁定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T00:01:16.853

好的，这就是我正在做的事情：

```
$result = mysql_safe_query('SELECT * FROM short_urls WHERE short=%s', $_GET['p']);
if(mysql_num_rows($result)> 0) {
    $url = mysql_fetch_assoc($result);
    $_SESSION['permissions'][$url['long']] = true;
    redirect($url['long']);
} 
```

这会将权限保存在会话变量中并将用户重定向到正确的页面。然后在照片页面上我这样做：

```
if(array_key_exists('/photo/'.$photo_id, $_SESSION['permissions'])
    || array_key_exists('/album/'.$photo['album_id'], $_SESSION['permissions'])) {
    $can_see = true;
} 
```

但我仍然不确定我对此有何感想。如果在某个时候我希望我的短 URL 指向`/photo/5/some_other_param`怎么办？它会正确地重定向用户，但会在权限数组中存储错误的变量。我想我应该做的是在我的`short_urls`表中添加另一列，指定它应该放入权限数组中的确切内容，是吗？

* * *

实际上，无论如何我认为我更喜欢这个解决方案。这样，甚至不是每个短 URL 都必须设置权限。新代码：

```
if(isset($url['perm_key'])) $_SESSION['permissions'][$url['perm_key']] = true; 
```

# c# - InvalidOperationException when calling SaveChanges in .NET Entity framework

> ID：1008582
> 
> 赞同：14
> 
> 时间：2009-06-17T17:48:20.570
> 
> 标签：c#, .net, entity-framework

I'm trying to learn how to use the Entity framework but I've hit an issue I can't solve. What I'm doing is that I'm walking through a list of Movies that I have and inserts each one into a simple database.

This is the code I'm using

```
private void AddMovies(DirectoryInfo dir)
{
    MovieEntities db = new MovieEntities();
    foreach (DirectoryInfo d in dir.GetDirectories())
    {
        Movie m = new Movie { Name = d.Name, Path = dir.FullName };
        db.AddToMovies(movie);
    }
    db.SaveChanges();
} 
```

When I do this I get an exception at db.SaveChanges() that read.

> The changes to the database were committed successfully, but an error occurred while updating the object context. The ObjectContext might be in an inconsistent state. Inner exception message: AcceptChanges cannot continue because the object's key values conflict with another object in the ObjectStateManager. Make sure that the key values are unique before calling AcceptChanges.

I haven't been able to find out what's causing this issue. My database table contains three columns
Id int autoincrement
Name nchar(255)
Path nchar(255)

Update: I Checked my edmx file and the SSDL section have the StoreGeneratedPattern="Identity" as suggested. I also followed the blog post and tried to add ClientAutoGenerated="true" and StoreGenerated="true" in the CSDL as suggested there. This resulted in compile errors ( Error 5: The 'ClientAutoGenerated' attribute is not allowed.). Since the blog post is from 2006 and it has a link to a follow up post I assume it's been changed.

However, I cannot read the followup post since it seems to require an msdn account.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T20:28:33.650

我找到了解决方案。

发生的事情是，当我创建表时，我忘记添加主键并将（Is Identity）属性设置为yes。然后我创建了我的实体模型并得到了这个错误。

我回去修复了我的数据库表，但我仍然遇到了奇怪的异常。最终解决问题的是删除实体并在表修复后重新创建它。

没有更多的例外:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-03-16T19:33:49.293

上次我尝试了以下代码，我说它工作正常

```
bs.SuspendBinding();
Data.SaveChanges();
bs.ResumeBinding(); 
```

我今天想告诉你的重要事情是：

1-如果我们使用上面的代码来暂停绑定，我们必须做更多的代码来修复很多场景，比如集合中的索引丢失和主从绑定

2-如果我们使用下面的代码而不是上面的代码，我们将看到异常消失，一切都会好起来的，不需要编写更多代码

```
 Data.SaveChanges(System.Data.Objects.SaveOptions.None); 
```

我希望这可以解决您的类似问题

谢谢朋友

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T18:09:24.497

此异常似乎告诉您在 Id 列中的几行中具有相等的值，该列应该只有唯一值，因为它是键列。Entity Framework 可以通过两种方式处理此类列：您（客户端）生成唯一值，或者服务器生成唯一值。在您的情况下，允许服务器生成自动增量密钥似乎是合乎逻辑的。

您是否`StoreGeneratedPattern`在 SSDL 文件中为 Id 列设置了密钥？

这是[这篇博文](http://blogs.msdn.com/dsimmons/archive/2006/08/27/727219.aspx)中的一个例子：

```
<EntityType Name="rooms" Key="id">
    <Property Name="id" Type="int" Nullable="false" 
              StoreGeneratedPattern="Identity" />
    <Property Name="name" Type="nvarchar" Nullable="false" MaxLength="50" />
</EntityType> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-19T09:18:00.670

```
System.Data.Objects.SaveOptions.None 
```

这解决了问题，但我想知道 uning none 或其他选项之间有什么区别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-24T17:55:57.660

如果你有一个 bindingsource 绑定，你应该调用suspendbinding：

```
 bs.SuspendBinding();
        Data.SaveChanges();
        bs.ResumeBinding(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-13T14:12:59.690

检查您的任何实体中是否缺少主键，如果是，则创建它们，并执行“从数据库中更新模型”

这应该解决问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-10T04:42:01.603

我在跨越三个级别的表关系中遇到了类似的问题，例如 Customer->Order->Order-Details 和 oracle 12C Auto-ID Trigger 用于密钥生成。插入使用`SaveChanges()`被抛出`System.InvalidOperationException`。

解决方案：增强功能`SaveChanges(System.Data.Objects.SaveOptions.None)`可以防止系统`EntityKeys`在对象图的状态下使用临时的，从而避免结果异常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-16T16:45:42.087

还要检查您是否将另一列的“Is Identity”属性设置为“yes”，并且您正在向其中插入重复的值。

# python - 在 Python 中查找和合并数据

> ID：1008587
> 
> 赞同：1
> 
> 时间：2009-06-17T17:49:09.617
> 
> 标签：python, string, file

我有 3 个文本文件

1.  多行`value1<tab>value2`（也许 600 行）
2.  更多行`value2<tab>value3`（也许 1000 行）
3.  更多行`value2<tab>value4`（可能是 2000 年）

并非所有行都匹配，有些行会缺少一个或多个 val。我想获取文件 1，读取它并在文件 2 和 3 中查找相应的值，然后将输出写为 - 例如

```
value1<tab>value2<tab>value3<tab>value4
value1<tab>value2<tab>blank <tab>value4 
```

即通过打印一些文本来指示该值丢失

在 awk 中，我可以通过预先将文件读入数组然后 END 并逐步完成它们来开始。但我想使用 Python (3) 来实现可移植性。我使用 MS Access 和链接表在 pc 上执行此操作，但每次使用此方法都会有时间损失。

在字典或列表中理解这一点的所有努力都让我感到困惑。我现在似乎拥有每一本 Python 书籍！

非常感谢任何可以提供建议的人。（如果有兴趣，它是 arp、mac 和供应商代码）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T18:01:14.790

未经测试：

```
f1 = open("file1.txt")
f2 = open("file2.txt")
f3 = open("file3.txt")

v1 = [line.split() for line in f1]
# dict comprehensions following, these need Python 3
v2 = {vals[0]:vals[1] for vals in line.split() for line in f2}
v3 = {vals[0]:vals[1] for vals in line.split() for line in f3}

for v in v1:
  print( v[0] + "\t" + v[1] + "\t" + v2.get(v[1],"blank ") + "\t" + v3.get(v[1],"blank ") ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T18:00:45.027

从这个开始。

```
def loadDictionaryFromAFile( aFile ):
    dictionary = {}
    for line in aFile:
        fields = line.split('\t')
        dictionary[fields[0]]= fields

dict2 = loadDictionaryFromAFile( open("file2","r" )
dict3 = loadDictionaryFromAFile( open("file3","r" )

for line in open("file1","r"):
    fields = line.split("/t")
    d2= dict2.get( fields[0], None )
    d3= dict3.get( fields[0], None )
    print fields, d2, d3 
```

您可能希望对其进行自定义以更改输出的格式。

# iphone - is there a notification when "slide to unlock" has occurred

> ID：1008595
> 
> 赞同：1
> 
> 时间：2009-06-17T17:50:24.373
> 
> 标签：iphone, unlock

I have an iphone game that plays background music using AVSoundPlayer - when someone locks the iphone the music stops which is fine. But when someone unlocks it, I don't want my music to start playing again while you're staring at the "slide to unlock" screen - I want it to start playing once you've actually slid the button and the app is visible again - is there some way to detect this? (I've tried applicationDidBecomeActive but that fires when the phone is unlocked but not when your app is visible yet...)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:26:28.683

你可以试试 viewWillAppear。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:20:35.113

```
- (void)applicationDidBecomeActive:(UIApplication *)application; 
```

当您的应用程序激活时发送

SO适用于您的问题的另一个答案：

[只要我不关闭 iPhone，applicationWillTerminate 就可以工作](https://stackoverflow.com/questions/704789/applicationwillterminate-works-as-long-as-i-dont-switch-off-the-iphone/716912#716912)

# c# - 在 WinForm 上旋转 PDF 视图

> ID：1008596
> 
> 赞同：1
> 
> 时间：2009-06-17T17:50:28.757
> 
> 标签：c#, .net, winforms, pdf, acrobat

我必须在 winform 中显示 PDF（.net 2.0 框架上的 c#）。目前，我使用的是 Adob​​e 提供的 ActiveX PDF 控件。我必须禁用整个控件，以便用户无法通过右键单击或热键打印或保存。不幸的是，许多文档需要旋转（只是查看，而不是永久保存）。我想让他们通过按下按钮控件来旋转视图。我已经尝试启用控件，然后使用 SendKeys 和 SendInput 以编程方式发送热键（ctrl shift +），但时间问题使其成为不可行的解决方案。

我在适当的 Adob​​e 板上询问过，他们说不可能我的所有客户都只安装阅读器版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-03T13:24:14.893

只需旋转控件。将控件放在面板中并旋转面板或其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T18:14:42.570

我不认为您可以对 PDF 进行控制以防止保存和打印？

# php - 在 JSP 中加密，在 PHP 中解密

> ID：1008601
> 
> 赞同：2
> 
> 时间：2009-06-17T17:51:16.993
> 
> 标签：php, jsp, encryption

我正在尝试实现从用 JAVA 编写的应用程序到另一个用 PHP 编写的 Web 应用程序的单点登录链接。

我想要一种在 .JSP 中加密用户名然后在 PHP 中解密的方法。

我需要找到与允许此功能匹配的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T17:57:00.727

加密算法、块模式和填充只需要定义相同。PHP 拥有自己的一组 mcrypt 库，支持许多常见的对称加密算法。尽管如果可能的话，我建议使用不同的令牌（如系统）来共享身份验证。

拥有一个仅对该会话有效而不对该用户有效的唯一令牌，然后将其存储在您的 php 和 jsp 页面都可以访问的服务器端数据库中。这样就不需要进行解密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T17:57:07.420

选择任何公开可用的加密方法。加密只是一种算法，在大多数情况下应该可以用任何语言实现它。

没有真正适用于 PHP 而不是 JSP 的加密，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T17:59:25.340

您可以使用 AES 加密。

*   PHP - mcrypt 库或 phpseclib
*   Java - JCE（从 v1.4.2 开始在 JRE 中构建）

或其他一些 crypt 解决方案，两者都有库。

# c - 如何防止网络端口在程序崩溃时保持打开状态

> ID：1008608
> 
> 赞同：4
> 
> 时间：2009-06-17T17:52:12.920
> 
> 标签：c, network-programming, crash, ports

我上学期学习了计算机网络，并为我的项目在 linux 中进行了一些 C 编程（使用 gcc）。我一直遇到的一件非常乏味的事情是，如果我的程序崩溃或停止（然后我必须按 Ctrl+C 来杀死它），网络端口仍然会保持打开状态大约一分钟。所以如果我想立即再次运行程序，我必须先进入头文件，更改端口，重新制作程序，然后最后运行它。显然，这很快就会变得非常乏味。

有什么方法可以配置它，一旦进程被杀死，端口就会立即释放？通过 linux 中的某些设置，或者在我的程序的 makefile 中，甚至在 C 中以编程方式？

**编辑：我指的是在编写服务器并选择特定端口来托管程序时。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T17:55:03.087

设置`SO_REUSEADDR`套接字上的选项。

```
int yes = 1;
setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int)); 
```

来自[Beej 的网络编程指南](http://beej.us/guide/bgnet/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:04:12.790

我敢打赌大约需要两分钟 :) 正如@Cogsy 所说，`SO_REUSEADDR`套接字选项是你的朋友。让自己熟悉 TCP 状态，这`TIME_WAIT`是导致您出现问题的状态：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T17:58:36.963

我假设您正在编写的程序是服务器，因此您需要使用已知端口。如果是这种情况，您应该使用 Cogsy 指出的套接字上的 SO_REUSE_ADDR 选项。

另一方面，如果你正在编写一个客户端软件，那么你应该避免选择一个特定的端口，让系统给你一个随机的端口。

# c# - 使用 xor 的 GetHashCode() 问题

> ID：1008633
> 
> 赞同：11
> 
> 时间：2009-06-17T17:58:35.920
> 
> 标签：c#, .net, gethashcode

我的理解是，您通常应该将 xor 与 GetHashCode() 一起使用来生成一个 int，以通过其值（而不是通过其引用）来识别您的数据。这是一个简单的例子：

```
class Foo
{
    int m_a;
    int m_b;

    public int A
    {
        get { return m_a; }
        set { m_a = value; }
    }

    public int B
    {
        get { return m_b; }
        set { m_b = value; }
    }

    public Foo(int a, int b)
    {
        m_a = a;
        m_b = b;
    }

    public override int GetHashCode()
    {
        return A ^ B;
    }

    public override bool Equals(object obj)
    {
        return this.GetHashCode() == obj.GetHashCode();
    }
} 
```

这个想法是，我想根据属性 A 和 B 的值将 Foo 的一个实例与另一个实例进行比较。如果 Foo1.A == Foo2.A 和 Foo1.B == Foo2.B，那么我们就有相等性。

**这是问题所在：**

```
Foo one = new Foo(1, 2);
Foo two = new Foo(2, 1);

if (one.Equals(two)) { ... }  // This is true! 
```

这些都为 GetHashCode() 生成值 3，导致 Equals() 返回 true。显然，这是一个简单的示例，并且只有两个属性，我可以简单地比较 Equals() 方法中的各个属性。但是，对于更复杂的类，这将很快失控。

我知道有时只设置一次哈希码并始终返回相同的值是很有意义的。但是，对于需要评估相等性的可变对象，我认为这是不合理的。

**在实现 GetHashCode() 时处理可以轻松互换的属性值的最佳方法是什么？**

> ### 也可以看看
> 
> [覆盖 System.Object.GetHashCode 的最佳算法是什么？](https://stackoverflow.com/questions/263400/what-is-the-best-algorithm-for-an-overridden-system-object-gethashcode)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-17T18:05:28.247

首先 - 不要仅根据 GetHashCode() 实现 Equals() - 即使对象不相等，哈希码有时也会发生冲突。

GetHashCode() 的合约包括以下内容：

*   不同的哈希码意味着对象绝对不相等
*   相同的哈希码意味着对象*可能*相等（但可能不相等）

Andrew Hare 建议我合并他的回答：

我建议您阅读[此解决方案](https://stackoverflow.com/questions/263400/what-is-the-best-algorithm-for-an-overridden-system-object-gethashcode)（顺便说一下，由我们自己的[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)提供）以“更好”地计算哈希码。

> 不，以上内容相对较慢，并没有太大帮助。有些人使用 XOR（例如 a ^ b ^ c），但我更喜欢 Josh Bloch 的“Effective Java”中显示的那种方法：
> 
> ```
> public override int GetHashCode()
> {
>     int hash = 23;
>     hash = hash*37 + craneCounterweightID;
>     hash = hash*37 + trailerID;
>     hash = hash*37 + craneConfigurationTypeCode.GetHashCode();
>     return hash;
> } 
> ```
> 
> 23 和 37 是互质的任意数。
> 
> 与 XOR 方法相比，上述方法的好处是，如果您的类型具有两个经常相同的值，则对这些值进行异或运算将始终给出相同的结果 (0)，而上述方法将区分它们，除非您非常不走运。

正如上面的片段中提到的，您可能还想查看[Joshua Bloch 的书 Effective Java，](https://rads.stackoverflow.com/amzn/click/com/0321356683)其中包含对该主题的很好的处理（哈希码讨论也适用于 .NET）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:04:08.717

Andrew 发布了一个很好的示例来生成更好的哈希码，但也请记住，您不应该使用哈希码作为相等性检查，因为它们不能保证是唯一的。

举一个简单的例子来说明为什么这是一个双重对象。它比 int 具有更多可能的值，因此不可能为每个双精度数设置唯一的 int。散列实际上只是第一步，在需要快速找到键的情况下使用，例如通过首先比较散列，可以排除大部分可能的键，只有具有匹配散列的键需要花费完全相等检查（或其他[冲突解决](http://en.wikipedia.org/wiki/Hash_table#Collision_resolution)方法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:06:45.283

散列总是涉及冲突，您必须处理它（fe，比较散列值，如果它们相等，则精确比较类内的值以确保类相等）。

使用简单的 XOR，您会遇到很多冲突。如果您想要更少，请使用一些数学函数将值分布在不同的位上（位移、与素数相乘等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T18:07:17.730

阅读[可变对象的覆盖 GetHashCode？C#](https://stackoverflow.com/questions/873654/overriding-gethashcode-for-mutable-objects-c)并考虑实现`IEquatable<T>`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T18:16:13.643

有几个更好的哈希实现。 例如[FNV 哈希。](http://bretm.home.comcast.net/~bretm/hash/6.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T18:09:03.530

出于好奇，因为哈希码通常不是比较的好主意，只执行以下代码会不会更好，或者我错过了什么？

```
public override bool Equals(object obj)
{
    bool isEqual = false;
    Foo otherFoo = obj as Foo;
    if (otherFoo != null)
    {
        isEqual = (this.A == otherFoo.A) && (this.B == otherFoo.B);
    }
    return isEqual;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-30T23:54:08.380

哈希的快速生成和良好分布

```
public override int GetHashCode()
{
    return A.GetHashCode() ^ B.GetHashCode();         // XOR
} 
```

# linq-to-sql - ...不是外键列，不能在这里使用？

> ID：1008641
> 
> 赞同：0
> 
> 时间：2009-06-17T18:00:06.477
> 
> 标签：linq-to-sql, dynamic-data, asp.net-dynamic-data

我在 SQL 中有两个视图，并在 Linq to SQL 中创建了它们的映射。

这两个视图在 Ticket.ProblemCode 和 Problem.Code 之间有一个可以正常工作的关联

当我尝试在 Ticket.ProblemCode 上设置 UIHint("ForeignKey") 并运行网页时，出现错误：

'ProblemCode' 不是外键列，不能在此处使用。

有谁知道为什么？更重要的是，如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:06:43.550

请参阅 ASP.NET 论坛上的此帖子： [http ://forums.asp.net/t/1254559.aspx](http://forums.asp.net/t/1254559.aspx)

另外，您说您在 Linq to SQL 中创建了关联。数据库中是否存在实际的 PK/FK 约束，还是仅在您的 dbml 中表示？

# entity-framework - 在实体框架中，如何指定关联的条件？

> ID：1008646
> 
> 赞同：3
> 
> 时间：2009-06-17T18:01:12.763
> 
> 标签：entity-framework

我有一个带有关联表的关系模型。但是除了相关的键之外，这个表还有一个标志。我想定义两个关联：一个标志为真，另一个为假。EF 设计器可以向实体添加条件，但不能向关联添加条件。

关联表如下所示：

```
UserPrivilege
-------------
UserId int (FK1)
PrivilegeId int (FK2)
IsGranted bit 
```

我想在用户实体和特权实体之间创建两个关联：PrivilegesGranted 和 PrivilegesDenied。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T22:24:00.640

您不能直接通过设计器执行此操作。

但这在 XML 中使用 DefiningQuery 和 Create and Delete sprocs 是可能的。有关更多信息，请参阅我博客上的这篇旧文章：[Associations with Payloads](http://blogs.msdn.com/alexj/archive/2008/02/26/associations-with-payloads-closing-the-loop.aspx)。

唯一有点有趣的是我假设 PK 只是 UserId 和 PrivilegeId，这意味着不能同时授予和拒绝用户的特定权限。

所以如果你写这样的代码：

```
Privilege p = user.Granted.First();
user.Granted.Remove(p);
user.Denied.Add(p);
ctx.SaveChanges(); 
```

更新顺序很重要。因为您对两个关联都使用了 DefiningQuery，所以 EF 不知道它们是相关的，并且它需要先删除，然后才能进行更新。

所以你最终可能会违反PK。

解决此问题的一种方法是在每个关联的插入和删除存储过程中，您基本上可以让它们更改用户和权限对的当前行，如果存在则使用正确的 IsGranted 值更新它，如果不创建它，即让它成为一个更新。

让我知道你怎么去这里

亚历克斯

# module - 模块化设计

> ID：1008653
> 
> 赞同：0
> 
> 时间：2009-06-17T18:03:41.120
> 
> 标签：module

我有两个独立的函数，bar() 和 foo()。我的程序的执行流程应该如下：

输入 -> bar() -> foo() -> 输出

目前，我在同一开发团队的一个队友在 bar() 函数内部进行了 foo() 调用，这破坏了模块化设计。虽然从模块化设计的角度来看，将 bar() 和 foo() 调用包装在一个名为 procedure() 的包装器函数中会更好，但在程序堆栈上添加额外的函数开销方面是否会花费任何性能？我计划将过程函数封装如下：

```
procedure(inputs)
{
    bar();
    foo();
} 
```

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T18:10:12.017

函数调用的开销（尤其是局部变量很少）是如此之小，以至于它甚至不值得考虑。另外，一个好的编译器会在适当的地方内联调用。我一直认为好的工程应该是最高优先级，因为从好的设计中获得的整体效率通常比优化小东西和让整体设计一团糟要好。

# php - 在 php 中使用模板数据创建一个新的 CSV 文件

> ID：1008658
> 
> 赞同：0
> 
> 时间：2009-06-17T18:04:28.110
> 
> 标签：php, csv

我正在尝试编写一个 php 脚本，它将采用现有的 csv 文件，并使用该文件的值打开它以进行编辑。

```
<?PHP
$file_handle = fopen("test.csv", "r");
while (!feof($file_handle) ) {
$line_of_text = fgetcsv($file_handle, 100000);
echo "<textarea name=textarea id=textarea cols=40 rows=4>$line_of_text[0]</textarea>";
echo "<textarea name=textarea id=textarea cols=40 rows=4>$line_of_text[1]</textarea>";
echo "</br></br>";
}
fclose($file_handle);
?> 
```

那没那么难。在它变得毛茸茸的地方，我还需要能够使用相同的模板数据添加额外的行。我可以想到如何做到这一点，基于用户选择的值的某种计数，它将呈现上述数据（加上换行符）x 次。我只是不知道该怎么做。顺便说一句，有问题的 csv 文件有 25 列，为了节省空间，我只放了前 2 列。

此外，一旦呈现所有这些数据，我需要将其全部（所有行）保存到新的 csv 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T23:23:17.307

提供更用户友好的输入方法会更容易吗？例如，包含与您的 CSV 文件匹配的列和行的表？然后让每个单元格成为输入框。使用 PHP 魔法`name="cell[0][1]"`确保您以友好的数组形式获得结果。然后如果他们愿意，可以使用 jQuery 添加一行

```
$('#add-row-button').bind('click', function() {

    var rowHtml = $('#csv-table tbody tr:first').html();

    $('#csv-table tbody tr:last').after(rowHtml);

{); 
```

然后遍历数组，再次将其保存为 CSV。

# flash - 使用动作脚本将 swf 转换为 jpg

> ID：1008660
> 
> 赞同：0
> 
> 时间：2009-06-17T18:04:34.460
> 
> 标签：flash

是否可以使用 actionscript 将 swf 转换为图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:21:33.870

你的问题需要更多细节。所以我会做一些假设。

我假设您想拍摄 SWF 的当前状态的快照，然后将其保存为图像文件。你没有告诉我们你想把图像保存在哪里，例如在服务器上，在用户本地机器上，或者甚至把它保存在闪存等里面，所以我真的不能帮你太多。

获取 SWF 的快照非常容易。你想要的是 BitmapData 类。这个功能应该有帮助。只需将一个对 DisplayObject（可以是舞台）的引用传递给它，它就会返回 BitmapData 对象。

```
function snapClip(clip:DisplayObject):BitmapData
{
    var bmpData:BitmapData = new BitmapData(stage.width, stage.height, true, 0);
    bmpData.draw( clip, new Matrix() );
    return bmpData;
}

var bmpData:BitmapData = snapClip( stage ); 
```

从那里您可以将 BitmapData 添加到舞台，如下所示：

```
var mc:MovieClip = new MovieClip();
mc.addChild( new Bitmap(bmpData) );
addChild(mc); 
```

或者您可以将您的 BitmapData 编码为 JPEG 格式：

```
import com.adobe.images.JPGEncoder;
var jpgEncoder:JPGEncoder = new JPGEncoder(85);
var jpgStream:ByteArray = jpgEncoder.encode(bmpData); 
```

从这里，要将其保存到服务器，您需要将 byteArray 发送到可以处理保存的服务器端脚本。

以下是一些可能有帮助的链接：

*   [拍摄影片剪辑快照](http://jobemakar.blogspot.com/2007/05/taking-movieclip-snapshot.html)
*   [如何正确地将任何内容绘制到 BitmapData](http://www.quasimondo.com/archives/000670.php)
*   [使用 AS3 Jpeg 编码器](http://henryjones.us/articles/using-the-as3-jpeg-encoder)
*   [在 AS3 中上传 BitmapData 快照到服务器](http://www.quietless.com/kitchen/upload-bitmapdata-snapshot-to-server-in-as3/)

# tfs - TFS 上的访问被拒绝 - PendChange 权限

> ID：1008664
> 
> 赞同：15
> 
> 时间：2009-06-17T18:05:10.137
> 
> 标签：tfs, tfvc

当我尝试从 TFS 签出文件时，我收到错误 TF14098：访问被拒绝用户 [用户名] 需要 [路径] 的 PendChange 权限。

我已将用户添加到贡献者组，但它仍然不允许他们签出文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T18:08:18.853

有时，权限同步可能需要一些时间。

[http://msdn.microsoft.com/en-us/library/ms400712.aspx#doesnottake](http://msdn.microsoft.com/en-us/library/ms400712.aspx#doesnottake)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-12-03T20:47:41.170

这是令人沮丧的愚蠢。因此，如果您遇到类似的问题，但找不到需要更改的实际权限，并且似乎无法通过 IDE 找到这些权限的设置位置，那是因为您需要通过以下方式实际**访问权限右键单击项目并选择 Advanced->Security，而不是 Team->Team Project Settings/Team Project Collection Settings->Security**。您也可以使用 tf 命令行执行此操作，使用 tf 特殊 tf 命令，但我对此有疑问。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-22T14:40:21.037

如果系统已经知道您修改的用户（或 AD 安全组），则更改应该是即时的。同步只在相反的情况下发挥作用：一个安全组已经允许 PendChange，然后 Windows 管理员向该组添加了一个新用户。TFS 在下一次计划同步期间与活动目录对话之前不会知道更改。

您看到的最可能的原因是权限继承。即使用户被明确地允许一个权限，任何适用于他的拒绝 ACL 都会覆盖它。例如，在父项上设置的 ACL 可能会被继承。类似地，如果用户是两个组的成员（例如贡献者和读者），他可能会使用冲突的 ACL——而拒绝总是会获胜。

此外，继承模型在 2008 SP1 中略有改变。看：

*   [http://blogs.msdn.com/mohamedg/archive/2009/03/23/deny-revisited.aspx](http://blogs.msdn.com/mohamedg/archive/2009/03/23/deny-revisited.aspx)
*   [http://blogs.msdn.com/dstfs/archive/2008/12/12/how-to-allow-access-to-a-child-folder-without-allowing-access-to-the-parent-folder-在-tfs-source-control.aspx](http://blogs.msdn.com/dstfs/archive/2008/12/12/how-to-allow-access-to-a-child-folder-without-allowing-access-to-the-parent-folder-in-tfs-source-control.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-31T16:34:43.103

使用 tf perm 和 tfs ui 我发现该`PendChange`权限是通过在 TFS 2015 的安全选项卡中将指定的用户组 Checkout 权限授予项目的根目录来授予的。

`PendChange`= 签出权限

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-26T20:53:49.277

从子分支合并到父分支时，我遇到了同样的问题。不允许项目管理员组本身的成员合并到该分支。

使用“tf perm”检查后，确保该组的该分支没有拒绝权限。

在检查了很多地方后，发现该分支中有一个删除结帐归因于开发人员。使用“在源代码管理中查找”-> 状态“-> 结帐查找找到了这个。

后来发现有权访问该分支的开发人员在离开公司之前曾试图删除该分支（作为清理的一部分）。我撤消了该更改（通过选择结帐使用撤消）和 Presto！合并开始起作用。

我仍然不确定这是怎么发生的，也不知道原因。但是对于在合并中遇到此问题的任何人，请检查一次所有结帐，如果您发现某些结帐（例如删除）很奇怪，请撤消并重试。这可能是一个原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-10T19:25:33.940

就我而言，下面的这个链接运行良好

[http://ravendra.wordpress.com/2010/06/04/tf14098-access-denied-user-user-needs-pendchange-permissions-for-source-control-folder/](http://ravendra.wordpress.com/2010/06/04/tf14098-access-denied-user-user-needs-pendchange-permissions-for-source-control-folder/)

“这基本上会告诉你所有用户/组的列表并获得他们的许可。从这个列表中检查你是成员的任何组是否被 PendChange 拒绝或直接拒绝你。如果是，那么采取必要的步骤来删除它。

这里要注意的是拒绝总是优先。假设您是 TFS Admin 的成员（允许所有权限）和项目阅读器（除了 PendChange 被拒绝），那么阅读器的 PendChange 将优先，您将不被允许删除。”

**更新：**

对于 TFS 2012，使用“ [VS2012 的开发人员命令提示符](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/z51z7zy0(v=vs.100))”并检查：[https ://msdn.microsoft.com/en-us/library/0dsd05ft(v=vs.100).aspx](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2010/0dsd05ft(v=vs.100))

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-27T06:40:29.433

从 TFS 中的团队项目中删除读者权限，这将阻止编辑文件。

我已经在 TFS2013 中检查了这个并且工作正常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-15T10:40:52.377

问题解决了。

TFS UI->administer->project->manage project security->转到版本控制选项卡->选择角色。

如果用户无法签入和回滚需要提供读取和&签入和签出的权限，需要在那里允许。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2011-06-21T20:04:55.330

在我的场景中，当我被添加到项目的管理员组时，此错误已修复。

# security - HTTP POST 的安全性如何？

> ID：1008668
> 
> 赞同：75
> 
> 时间：2009-06-17T18:05:31.430
> 
> 标签：security, post, httpwebrequest, xmlhttprequest

POST 是否足够安全以发送登录凭据？

还是**必须**使用 SSL 连接？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-06-17T18:06:14.317

**SSL 是必须的。**

POST 方法并不比 GET 更安全，因为它也可以通过网络未加密发送。

SSL 将覆盖整个 HTTP 通信，并对客户端和服务器之间传输的 HTTP 数据进行加密。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-06-17T18:23:48.030

`<shameless plug>`我有一篇[博客文章](http://jasonmbaker.wordpress.com/2009/05/10/http-and-you/)详细介绍了 HTTP 请求的外观以及 GET 请求与 POST 请求的比较。为简洁起见，GET：

```
GET /?page=123 HTTP/1.1 CRLF
Host: jasonmbaker.wordpress.com CRLF
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_6; en-us) AppleWebKit/525.27.1 (KHTML, like Gecko) Version/3.2.1 Safari/525.27.1 CRLF
Connection: close CRLF 
```

和发布：

```
POST / HTTP/1.1 CRLF
Host: jasonmbaker.wordpress.com CRLF
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_6; en-us) AppleWebKit/525.27.1 (KHTML, like Gecko) Version/3.2.1 Safari/525.27.1 CRLF
Connection: close CRLF
CRLF
page=123 
```

（CRLF 只是一个换行符）

如您所见，从如何形成请求的角度来看，唯一的区别*是 POST 请求使用 POST 一词，并且表单数据是在请求正文中发送的，而不是在 URI 中发送的。因此，使用 HTTP POST 是隐蔽的安全性。如果你想保护数据，你应该使用 SSL。

`*`请注意，还有[*其他*区别](http://jasonmbaker.wordpress.com/2009/04/29/make-sure-you-use-the-right-method/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-17T18:06:38.263

这取决于您的情况，截获凭证会花费多少人？

如果它只是一个软件问答网站的登录，那么 SSL 可能不是必需的，如果它是一个在线银行网站或您存储信用卡数据，那么它是必要的。
这是一项业务而非技术决策。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-17T18:11:30.627

HTTP POST 未加密，它可以被网络嗅探器、代理拦截或在具有自定义日志记录级别的服务器日志中泄露。是的，POST 比 GET 好，因为 POST 数据通常不由*代理*或服务器记录，但它并不*安全*。要保护密码或其他机密数据，您必须在 POST 之前使用 SSL 或加密数据。另一种选择是在浏览器中使用摘要式身份验证（请参阅 RFC 2617）。请记住，（本地）加密不足以防止重放攻击，您必须在加密之前连接随机数和其他数据（例如领域）（请参阅 RFC 2617，了解如何在 Digest Auth 中完成）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-17T18:06:15.283

SSL 是必须的:)

HTTP Post 以纯文本形式传输。例如，下载并使用 Fiddler 观察 HTTP 流量。您可以在那里轻松查看整个帖子（或通过 WireShark 之类的网络流量监视器）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-17T18:06:20.617

它不安全。可以像 GET 一样轻松地嗅探 POST。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-17T18:06:18.620

不...POST 根本不够安全。SSL 是必须的。

POST 仅有效地隐藏查询字符串中的参数。任何查看浏览器和端点之间流量的人仍然可以获取这些参数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-17T18:21:08.957

最安全的方法是根本不发送凭据。

如果您使用[Digest Authentication](http://en.wikipedia.org/wiki/Digest_access_authentication)，那么 SSL**不是**必须的。

（注意：我并不是说基于 HTTP 的摘要式身份验证总是比使用基于 HTTPS 的 POST 更安全）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-17T18:06:50.353

POST 是明文。

安全连接是必须的。

这就是为什么它被称为安全连接。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-17T18:07:45.157

单独的 POST 请求并不安全，因为所有数据都以纯文本形式“移动”。

您需要 SSL，以使其安全。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-17T18:07:52.737

不，使用 SSL。

使用 POST 时，除非使用 SSL，否则值仍以纯文本形式提交。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-17T18:08:48.727

HTTP GET 和 HTTP POST 之间的唯一区别是数据的编码方式。在这两种情况下，它都以纯文本形式发送。

为了为登录凭据提供任何类型的安全性，HTTPS 是必须的。

您也不需要昂贵的证书来提供 HTTPS。有许多提供商会以大约 20 美元的价格颁发非常基本的证书。更昂贵的包括身份验证，这是电子商务网站更关心的问题。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-07-11T07:48:43.410

请看这篇很棒的文章：

**防止恶意 POST 请求**

[https://perishablepress.com/protect-post-requests/](https://perishablepress.com/protect-post-requests/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-17T18:08:26.370

如果您使用未加密的 HTTP 连接，则 POST 数据以纯文本形式发送。如果这足够安全取决于您的使用情况（提示：不是）。

如果服务器、客户端机器和它们之间的所有机器都是受控的、完全受信任的网络的一部分，那么这可能没问题。

在这些非常有限的情况之外（有时甚至在其中）纯文本身份验证正在自找麻烦。

# c# - 重复登录脚本

> ID：1008669
> 
> 赞同：0
> 
> 时间：2009-06-17T18:05:43.037
> 
> 标签：c#, .net, network-programming

好的，所以我在 C# 中编写了一个重复的登录“工人”类，我遇到了一些障碍。我想，我背后的逻辑是完美无缺的！:(

但是，我一生都无法弄清楚为什么它会在第一次出现而不是在重复时触发:(

```
namespace Lab.Core.BackgroundWorker {
    using Lab.Core;
    using Lab.Core.Net;

    using System;
    using System.Collections;
    using System.Collections.Generic;
    using System.Text;
    using System.Threading;
    using System.Windows.Forms;

    public class MultiLogon : IWorker {
        private static Hashtable LoggedOnUsers = new Hashtable();
        private Thread _worker = null;
        //private Thread m_UsersUpdate = null;

        public delegate Boolean AddUserToCollectionDelegate(String user, String computer);
        public delegate void ClearCollectionDelegate(String user);
        public delegate Boolean IsUserLoggedInDelegate(String user);

        public Boolean AddUserToCollection(String user, String computer) {
            int retVal = MultiLogon.LoggedOnUsers.Count + 1;
            if (String.IsNullOrEmpty(user) || String.IsNullOrEmpty(computer))
                return false;
            if (!MultiLogon.LoggedOnUsers.ContainsKey(user))
                MultiLogon.LoggedOnUsers.Add(user, computer);

            return (MultiLogon.LoggedOnUsers.Count == retVal);
        }

        public void ClearCollection() {
            if (MultiLogon.LoggedOnUsers.Count > 0)
                MultiLogon.LoggedOnUsers.Clear();
        }

        public Boolean IsUserLoggedIn(String user) {
            if (String.IsNullOrEmpty(user))
                return false;
            return (LoggedOnUsers.Contains(user));
        }

        #region IWorker Members

        public void Run(object obj) {
            AddUserToCollectionDelegate add = new AddUserToCollectionDelegate(AddUserToCollection);
            //ClearCollectionDelegate clear = new ClearCollectionDelegate(ClearCollection);
            //IsUserLoggedInDelegate isLogged = new IsUserLoggedInDelegate(IsUserLoggedIn);

            while (true) {
                foreach (Computer c in ComputerList.Instance)
                    if (!add.Invoke(c.UserName, c.MachineName)) {
                        // duplicate! or not? :/
                        // Credit (through adoption of code) goes to:
                        //  http://bytes.com/groups/net-c/263778-quickly-finding-duplicates-arraylist#post1059834
                        foreach (DictionaryEntry item in MultiLogon.LoggedOnUsers) {
                            MessageBox.Show((String)item.Key, (String)item.Value);
                            //NetworkMessage.Send((String)item.Value, String.Format("It is against lab policy to share your account with anyone other than yourself or use someone else's account! Logout immediately or further action will be taken. Your action has been logged."));
                            //OffenseManager.Instance.AddOffense((String)item.Key, null, String.Format("Account sharing - Computer: {0}", item.Value), false);
                        }
                    }
                Thread.Sleep(750);
            }
        }

        public void Start() {
            _worker = new Thread(new ParameterizedThreadStart(Run));
            _worker.IsBackground = true;
            _worker.Start();
        }

        public void Stop() {
            if (_worker.IsAlive)
                _worker.Abort();
        }

        #endregion
    }
} 
```

为长代码文件道歉。我不知道要粘贴什么来帮助你们帮助我。：/

提前致谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:11:44.960

可能是线程竞争条件。
当您搜索/插入集合时，您是否尝试过锁定集合？
我不相信 Hashtable 是线程安全的。

你可能想放一个

```
lock(this) {
} 
```

阻止任何访问哈希表的东西。

# svn - SVN - 无法将分支合并回主干 - 许多树冲突

> ID：1008681
> 
> 赞同：55
> 
> 时间：2009-06-17T18:06:57.467
> 
> 标签：svn, merge, tree-conflict

我有一个我认为很简单的场景 - 使用 TortoiseSVN：

1）我创建了一个应用程序的分支（B2）（用于实现图像精灵和 JAWR）。

2) 测试和开发在主干上正常进行。

3) 在过去的几天里，我通过以下方式重新建立了几次分支：

3.1) 将主干（按修订范围）合并到我的 branch-b2 工作副本，解决合并期间的冲突。

3.2）（在测试了分支-b2之后），我提交了重新建立的分支-b2。

这一切都如我所料。但是将分支合并回主干对我来说很重要：

4) 在分支-b2 中提交所有更新之后；我确保在主干和分支 b2 上进行 SVN 更新。

5）然后，我尝试将分支b2中的（修订范围）合并到主干中。但是，对于任何已添加到主干的新文件，然后在我重新设置它时添加到 branch-b2，我都会遇到树冲突。我不确定解决这些冲突的正确方法是什么。

我见过的最典型的建议是从主干中删除树冲突文件，然后合并分支；或者删除整个主干，将分支文件复制过来，然后将它们作为新版本提交到主干中。这两个选项似乎都不是一个好主意——第一个很痛苦，而且它们似乎都会丢失文件修订历史。

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-06-17T18:32:47.127

听起来您正在使用 1.5 之前的合并样式并尝试将分支重新集成到主干中。在这种情况下，您要做的是首先确保所有主干更改都已合并到分支中，然后不是将分支范围合并到指向主干的工作副本，而是要合并“FROM trunk @HEAD TO branch@HEAD”，工作副本指向主干。在本质上：

“给我所有我需要使主干与分支相同的更改”。

如果您已经将所有主干更改合并到分支，则此方法有效，因为主干和分支之间的唯一区别是在分支中所做的更改。

有道理？:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-07T15:33:10.910

我调查了同样的问题。它是 Tortoise SVN 1.6.5 中的“功能”。TortoiseSVN 1.5 与我们的存储库 (SVN 1.5) 配合得很好。TortoiseSVN 1.6.5 变基时将主线中的文件添加为 NEW（不保存合并历史）。
并且重新集成分支导致将这些文件视为与主线冲突。

我通过使用 TortoiseSVN 1.6“重新集成分支”的特性解决了这个问题。它专门用于功能分支。

——阿列克谢·科尔森

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-14T16:34:18.867

这里有更多信息可以为@Rytmis 回答做出贡献，这有助于我保持直截了当。

使主干完全像分支或标签的高级步骤：

1.  从行李箱结帐。
2.  使用主干的工作副本，从主干合并到分支/标签。
3.  犯罪。

示例 'svn' 命令行命令：

```
svn checkout <trunk url>
cd trunk
svn merge <trunk url> <branch/tag url>
svn commit -m "<message>" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-23T18:17:18.000

我无法真正弄清楚上述解决方案是如何工作的，所以我的工作方式有所不同。首先，我确保分支包含来自主干的所有更改。

1）我得到了一个新的后备箱副本。2）我使用 tortoise svn export 将分支导出到一个临时位置。3）我使用 Windows 资源管理器将整个分支树复制到主干并覆盖了所有文件 4）我在 tortoise 上使用了检查更改命令并包含所有未修订的文件复选框。5）我选择了所有文件并单击添加。

您应该使用尚未构建的解决方案，以便未修订的文件不包含输出。

我等不及我们升级到 1.5+

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T10:05:19.247

使用 TortoiseSVN 选择“合并一系列版本”选项时选择要合并的版本。这将防止每次合并操作再次出现相同文件的树冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-28T06:41:08.383

我想我解决了这个问题。1.右键单击您合并的“分支”。2\. 单击 Tortoise SVN >> 合并 3\. “合并一系列修订”和下一步 4\. !!!检查“反向合并”！！！, URL to Merge from "branch", 具体范围"recently merge revision", and Next 5\. Next 6\. SVN Commite

之后我可以从分支合并到主干。

# c# - 在 IronPython 中重新声明 .net 类

> ID：1008686
> 
> 赞同：1
> 
> 时间：2009-06-17T18:08:02.457
> 
> 标签：c#, ironpython, monkeypatching

谁能告诉我是否可以在 IronPython 中重新声明一个 C# 类？如果我有一个 C# 类，我可以从 IronPython 中对其进行猴子补丁吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T18:39:09.397

您可以从 IronPython 进行猴子补丁，但 IPy 是唯一会尊重您的更改的环境；即，如果您尝试从 IronPython 模拟 File.Create，这对于任何 IPy 代码都可以正常工作，但如果您调用名为 File.Create 的 C# 方法，它将得到真实的，而不是模拟的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-01T04:49:44.377

你不能从 IronPython 猴子补丁。IronPython 处理所有 .NET 类就像 CPython 处理内置类型一样：它们不能被猴子修补。另一方面，IronRuby 确实支持这一点。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-17T18:20:26.867

为什么要重新声明？[将其子类化](http://www.voidspace.org.uk/ironpython/dynamically_compiling.shtml)或创建一个全新的类不是更有意义吗？

编辑：澄清一下，我认为您真正需要的是适当的控制反转（IOC）框架，例如[Castle Windsor](http://www.castleproject.org/container/index.html)。基本上，你有一个数据库接口，然后配置 IOC 框架以注入一个用于生产的真实数据库，以及用于测试的模拟数据库。

# asp.net - “读取 XML 数据时已超出最大字符串内容长度配额 (8192)”通过 mexAddress 名字对象调用 WCF

> ID：1008691
> 
> 赞同：6
> 
> 时间：2009-06-17T18:08:44.390
> 
> 标签：asp.net, wcf

我正在尝试通过 mex 从经典 ASP 页面调用 WCF 服务。我已经使用[MSDN](http://msdn.microsoft.com/en-us/library/ms729739.aspx)上的详细信息进行了通话，但是如果我传回超过 8K 的数据量，我会收到异常说明：

> 读取 XML 数据时已超出最大字符串内容长度配额 (8192)。可以通过更改创建 XML 阅读器时使用的 XmlDictionaryReaderQuotas 对象的 MaxStringContentLength 属性来增加此配额...

在 .NET 客户端中对此的修复非常简单：您可以调整客户端配置以与 readerQuotas 部分绑定，包括增加配额。但是，由于我正在构建一个服务名字对象以传递给 ASP 中的 GetObject 调用，因此我无权访问要编辑的配置。如果它是一个 VB6 应用程序，我可以使用 dllhost.exe.config，但事实并非如此。bindingConfiguration 节点（和子节点）似乎不是我可以在名字对象字符串中设置的参数。

关于如何在 ASP 上下文中影响此参数的任何想法？带有下面引用的名字对象字符串的 ASP 片段：

```
 Dim strXml, moniker, objProxy

   moniker="service:mexAddress='http://localhost/SomeApp/SomeServices/SomeService.svc/mex', "
   moniker=moniker + "address='http://localhost/SomeApp/SomeServices/SomeService.svc',"
   moniker=moniker + "contract=ISomeService, contractNamespace=http://foo.com, "
   moniker=moniker + "binding=WSHttpBinding_ISomeService, bindingNamespace=http://foo.com"

   Set objProxy = GetObject(moniker)

   strXml = objProxy.DoWork("foo", "bar") 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T20:57:49.913

尝试在服务器端的 wcf 绑定配置中设置 maxStringContentLength。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T01:05:28.447

据我了解，service:mexAddress 名字对象实际上在 COM 接口后面使用了 WCF 客户端。如果是这种情况，那么您可以将 WCF 配置存储在名为 «foo».exe.config 的文件中，其中 «foo» 被替换为可执行文件的名称。

如果您在 IIS6 或 IIS7 中运行 ASP，则运行 ASP 的 EXE 可能是 w3wp.exe，这意味着您需要将配置放入名为 w3wp.exe.config 的文件中，该文件位于目录 c:\Windows \system32\inetsrv。

# javascript - window.onerror 在 Firefox 中未触发

> ID：1008692
> 
> 赞同：17
> 
> 时间：2009-06-17T18:08:44.857
> 
> 标签：javascript, jquery, firefox, onerror

我正在尝试创建一个 javascript 错误日志记录基础设施。

我正在尝试设置`window.onerror`为我的错误处理程序。它可以在 IE 6 中运行，但是当我在 Firefox 中运行它时，它会遇到一些冲突的`onerror`方法。

```
var debug = true;

MySite.Namespace.ErrorLogger.prototype = {

   //My error handling function.  
   //If it's not in debug mode, I should get an alert telling me the error.
   //If it is, give a different alert, and let the browser handle the error.
   onError: function(msg, url, lineNo) {
        alert('onError: ' + msg);
        if (!debug) {
            alert('not debug mode');
            return true;
        }
        else {
            alert(msg);
            return false;
        }
    }
}

//Document ready handler (jQuery shorthand)
$(function() {
    log = $create(MySite.Namespace.ErrorLogger);

    window.onerror = log.onError;

    $(window).error(function(msg, url, line) {
        log.onError(msg, url, line);
    });
}); 
```

如果我使用`setTimeout("eval('a')", 1);`where ' `a`' is an undefined 变量，我的错误处理程序就是被触发的（它有效）。但是，我的错误记录器需要捕获客户端访问网站时抛出的所有错误，而不仅仅是一个地方的错误代码。

该代码位于从网站的基本页面 (C#) 调用的 .js 页面上。该站点还使用 jQuery，因此我有一个覆盖 jQuery 绑定函数的函数，该函数在 Firefox 3 和 IE 6 中都可以正常工作。

我知道 Firefox 看到了错误，因为它同时出现在错误控制台和 Firebug 中，但*我的* `window.onerror`函数仍然没有被调用。

关于如何覆盖 Firefox 正在做什么的任何想法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-17T19:42:36.690

以下内容在 IE 6 和 Firefox 3.0.11 中经过测试和工作：

```
<html>
<head>
<title>Title</title>
</head>
<body>
    <script type="text/javascript">
    window.onerror = function (msg, url, num) {
        alert(msg + ';' + url + ';' + num);
        return true;
    }
    </script>
    <div>
    ...content...
    </div>
    <script type="text/javascript">
    blah;
    </script>
</body>
</html> 
```

如果您正在加载的其他一些 JavaScript 库也将其自身附加到`window.onerror`您可以这样做：

```
<script type="text/javascript">
function addHandler(obj, evnt, handler) {
    if (obj.addEventListener) {
        obj.addEventListener(evnt.replace(/^on/, ''), handler, false);
    // Note: attachEvent fires handlers in the reverse order they
    // were attached. This is the opposite of what addEventListener
    // and manual attachment do.
    //} else if (obj.attachEvent) {
    //    obj.attachEvent(evnt, handler);
    } else {
        if (obj[evnt]) {
            var origHandler = obj[evnt];
            obj[evnt] = function(evt) {
                origHandler(evt);
                handler(evt);
            }
        } else {
            obj[evnt] = function(evt) {
                handler(evt);
            }
        }
    }
}
addHandler(window, 'onerror', function (msg, url, num) {
    alert(msg + ';' + url + ';' + num);
    return true;
});
addHandler(window, 'onerror', function (msg, url, num) {
    alert('and again ' + msg + ';' + url + ';' + num);
    return true;
});
</script> 
```

以上允许您附加任意数量的`onerror`处理程序。如果已经有一个现有的自定义`onerror`处理程序，它将调用那个，然后是你的。

请注意，`addHandler()`可用于将多个处理程序绑定到任何事件：

```
addHandler(window, 'onload', function () { alert('one'); });
addHandler(window, 'onload', function () { alert('two'); });
addHandler(window, 'onload', function () { alert('three'); }); 
```

这段代码是新的，有些实验性的。我不能 100% 确定[addEventListener](https://developer.mozilla.org/en/DOM/element.addEventListener)是否完全按照手动附件所做的那样，并且正如评论的那样，[attachEvent](http://msdn.microsoft.com/en-us/library/ms536343.aspx)以与它们附加的相反顺序触发处理程序（因此您会在上面的示例中看到“三、二、一”）。虽然不一定是“错误”或“不正确”，但它与其他代码的`addHandler`作用相反，因此可能导致浏览器之间的行为不一致，这就是我删除它的原因。

编辑：

这是一个完整的测试用例来演示 onerror 事件：

```
<html>
<head>
<title>Title</title>
</head>
<body>
<script type="text/javascript">
function addHandler(obj, evnt, handler) {
    if (obj.addEventListener) {
        obj.addEventListener(evnt.replace(/^on/, ''), handler, false);
    } else {
        if (obj[evnt]) {
            var origHandler = obj[evnt];
            obj[evnt] = function(evt) {
                origHandler(evt);
                handler(evt);
            }
        } else {
            obj[evnt] = function(evt) {
                handler(evt);
            }
        }
    }
}
addHandler(window, 'onerror', function (msg, url, num) {
    alert(msg + ';' + url + ';' + num);
    return true;
});
</script>
<div>
...content...
</div>
<script type="text/javascript">
blah;
</script>
</body>
</html> 
```

将上述代码放入 test.htm 并从本地 idks 加载到 Internet Explorer 时，您应该会看到一个对话框，上面写着`'blah' is undefined;undefined;undefined`.

当上述代码放入 test.htm 并从本地磁盘加载到 Firefox 3.0.11（以及本次编辑的最新 3.5 - Gecko/20090616）中时，您应该会看到一个显示`[object Event];undefined;undefined`. 如果这没有发生，那么您的 Firefox 副本配置不正确或损坏。我只能建议您删除 Firefox，删除您的本地配置文件（有关如何找到您的配置文件的信息可[在此处](http://support.mozilla.com/en-US/kb/Profiles)获得）并重新安装最新版本并再次测试。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-17T19:26:44.367

请记住从任何自定义 window.onerror 处理程序返回**true**，否则 firefox 无论如何都会处理它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-26T12:02:38.163

jQuery 1.3.x 中似乎存在一个未解决的错误 (#3982) - [jQuery.error 事件获取不正确的参数](http://dev.jquery.com/ticket/3982)。最后一次更新是 2 个月前的评论：

> 考虑到错误事件的疯狂程度以及使用频率，我同意删除对它的支持是最容易的。我已经在文档中添加了一条注释，因为它无论如何都不起作用。

我想我会自己设置 window.onerror ，类似于格兰特发布的内容。此外，[FireFox：addEventListener 与。window.onerror](http://bytes.com/groups/javascript/571238-firefox-addeventlistener-vs-window-onerror)提到*“element.addEventListener”，导致错误不会激活“window.onerror”*。

# wpf - 从 WinForms BackgroundWorker 创建 WPF 窗口

> ID：1008696
> 
> 赞同：3
> 
> 时间：2009-06-17T18:09:11.627
> 
> 标签：wpf, backgroundworker

我有一个 WPF dll，其中包含许多 Window 类并公开显示这些窗口的方法。

我还有一个单独的 WinForms 项目，它在 BackgroundWorker 组件的 DoWork 方法中调用 WPF 项目中的这些方法之一。

在实例化 WPF 窗口的代码行中，我收到以下运行时错误：

> 调用线程必须是 STA，因为许多 UI 组件都需要这个。

谷歌搜索让我进入了[这个讨论](http://www.eggheadcafe.com/conversation.aspx?messageid=31268816&threadid=31268816)。（事实证明，除了 Stack Overflow，Jon Skeet 还回答了其他网站上的问题！）他链接到[这篇文章](http://msdn.microsoft.com/en-us/magazine/cc163328.aspx)，其中指出

> BackgroundWorker 组件适用于 WPF ...

那篇文章还提到了使用 DispatcherObject 类，但我不明白如何使它工作，我宁愿继续使用我的 BackgroundWorker 组件。

作为测试用例，我想出了以下代码来重现错误。在 WPF 类库中，这里是 Window1.xaml.vb 中的代码

```
Partial Public Class Window1

    Public Shared Function ShowMe() As Boolean?
        Dim w = New Window1 'Error appears on this line.
        Return w.ShowDialog()
    End Function

End Class 
```

在 WinForms 应用程序中，这里是 Form1.vb 中的代码

```
Imports System.ComponentModel

Public Class Form1

    Private WithEvents worker As BackgroundWorker
    Private Sub doWord(ByVal sender As Object, ByVal e As DoWorkEventArgs) Handles worker.DoWork
        WpfLibrary.Window1.ShowMe()
    End Sub
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        worker = New BackgroundWorker
        worker.RunWorkerAsync()
    End Sub
End Class 
```

即使将 BackgroundWorker 组件放在 Window1.xaml.vb 本身中，也会发生相同的错误。那么，那篇文章是不是错了，我真的不能将 BackgroundWorker 与 WPF 一起使用？或者我还需要做些什么才能让它工作吗？

如果 BackgroundWorker 不起作用，那么我将如何替换上面 Form1.vb 中的代码以使用 Dispatcher 呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T18:16:44.890

您*可以*在 WPF 中使用后台工作人员，这不是您的问题。

您的问题是您无法在 winform 或 WPF 应用程序中执行从主 UI 线程外部更新 UI 的任何任务，并且 BackgroundWorker 的 DoWork 方法在不同的线程中运行。

因此，您必须在启动 BackgroundWorker 之前或在其 RunWorkerCompleted 事件中，在 BackgroundWorker 的后台线程之外打开新窗口。

在不知道打开窗口的调用周围的代码的情况下，我很难提供进一步的建议，但我希望这能为您指明正确的方向。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T18:21:47.923

您的工作人员还可以创建自己的线程，将该线程标记为 STA，然后调用`Thread.Join()`以等待它终止。然后，您将能够在新线程上创建并显示窗口（尽管请注意，如果不使用 Dispatcher，其他线程将无法与其交互）。

C# 中的示例：

```
Thread workerThread = new Thread(ShowMyWindow);
workerThread.SetApartmentState(ApartmentState.STA);
workerThread.Start();
workerThread.Join(); 
```

进而：

```
private void ShowMyWindow()
{
    WpfLibrary.Window1.ShowMe()
} 
```

# android - 多个 android GridViews 不会 wrap_content

> ID：1008703
> 
> 赞同：2
> 
> 时间：2009-06-17T18:11:28.037
> 
> 标签：android, android-layout, android-gridview

我有一个`Activity`显示 5 `GridViews`。这些中的每一个都由一个跨越屏幕宽度的背景`GridViews`划分。`TextView`代表一卷书，网格中的`GridViews`每个项目是一个`Button`代表一卷中的一本书。

所有的`GridViews`和`TextViews`坐在里面`RelativeLayout`。有些卷有很多书，而另一些则只有几本书，所以我一直在尝试获取单独的网格视图`wrap_content`并占用他们显示所有书籍所需的所有空间，但没有运气。将`View`空间平均分配给每个`GridViews`，隐藏大部分书籍。我在下面有我的 xml 布局。谁能告诉我如何完成这项工作？

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:as="http://schemas.android.com/apk/res/edu.byu.scriptures"  
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <RelativeLayout android:id="@+id/gridNavBar"
        android:layout_height="44px"
        android:layout_width="fill_parent"
        android:background="@drawable/bgnd_1_44"
        android:paddingBottom="0px">
        <Button
            android:id="@+id/homeButton"
            android:layout_height="wrap_content"
            android:layout_width="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:layout_marginLeft="5px"
            android:text="Home"
                android:textSize="14sp"
                android:textColor="#fff"
                android:shadowColor="#444"
                android:shadowRadius="1"
                android:shadowDx="1"
                android:shadowDy="-1"
                android:background="@drawable/generic_button_xml"/>
    <TextView android:id="@+id/bookRef"
        android:text="Books"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:textColor="#fff"
        android:textSize="18sp"
        android:textStyle="bold"
        android:shadowColor="#444"
        android:shadowRadius="1"
        android:shadowDx="1"
        android:shadowDy="-1"
        />
</RelativeLayout>
<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_below="@id/gridNavBar">
    <RelativeLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">   
            <TextView
                android:gravity="top"
                android:id="@+id/vol1DividerBar"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="Volume 1"
                android:textColor="#000"
                android:background="@drawable/volume_divider"
                android:layout_centerHorizontal="true"
                android:layout_alignParentTop="true"/>
            <GridView 
                android:layout_weight="1"
                android:id="@+id/vol1Grid"
                android:layout_width="fill_parent" 
                android:layout_height="fill_parent"
                android:numColumns="auto_fit"
                android:verticalSpacing="0dp"
                android:horizontalSpacing="0dp"
                android:layout_below="@id/vol1DividerBar"/>
            <TextView
                android:layout_weight="1"
                android:id="@+id/vol2DividerBar"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="Volume 2"
                android:textColor="#000"
                android:background="@drawable/volume_divider"
                android:layout_below="@id/vol1Grid"/>
            <GridView
                android:layout_weight="1"
                android:id="@+id/vol2Grid"
                android:layout_width="fill_parent" 
                android:layout_height="wrap_content"
                android:numColumns="auto_fit"
                android:verticalSpacing="0dp"
                android:horizontalSpacing="0dp"
                android:layout_below="@id/vol2DividerBar"/>
            <TextView
                android:layout_weight="1"
                android:id="@+id/vol3DividerBar"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="Volume 3"
                android:textColor="#000"
                android:background="@drawable/volume_divider"
                android:layout_below="@id/vol2Grid"/>
            <GridView
                android:layout_weight="1" 
                android:id="@+id/vol3Grid"
                android:layout_width="fill_parent" 
                android:layout_height="wrap_content"
                android:numColumns="auto_fit"
                android:verticalSpacing="0dp"
                android:horizontalSpacing="0dp"
                android:layout_below="@id/vol3DividerBar"/>
            <TextView
                android:layout_weight="1"
                android:id="@+id/vol4DividerBar"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="The Doctrine and Covenants"
                android:textColor="#000"
                android:background="@drawable/volume_divider"
                android:layout_below="@id/vol3Grid"/>
            <GridView
                android:layout_weight="1"
                android:id="@+id/vol4Grid"
                android:layout_width="fill_parent" 
                android:layout_height="wrap_content"
                android:numColumns="auto_fit"
                android:verticalSpacing="0dp"
                android:horizontalSpacing="0dp"
                android:layout_below="@id/vol4DividerBar"/>
            <TextView
                android:layout_weight="1"
                android:id="@+id/vol5DividerBar"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="The Pearl of Great Price"
                android:textColor="#000"
                android:background="@drawable/volume_divider"
                android:layout_below="@id/vol4Grid"/>
            <GridView
                android:layout_weight="1"
                android:id="@+id/vol5Grid"
                android:layout_width="fill_parent" 
                android:layout_height="wrap_content"
                android:numColumns="auto_fit"
                android:verticalSpacing="0dp"
                android:horizontalSpacing="0dp"
                android:layout_below="@id/vol5DividerBar"/>
        </RelativeLayout>
</ScrollView>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:26:07.523

尝试分配 GridView 权重 = 0.5。几天前我面临同样的情况。布局的一个简单改变对我有用。只需在我的 GridView 的左右添加两个空视图，权重 = 1，并为 GridView 分配 0.5 权重。例如。

```
<LinearLayout 
    android:layout_width="fill_parent"
    android:gravity="center"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <View
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1" />

    <GridView
        android:id="@+id/myGridView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="0.5"
        android:numColumns="2"
        android:scrollbars="none"
        android:verticalSpacing="10dp" >
    </GridView>

    <View
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1" />
</LinearLayout> 
```

`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-02-27T10:17:09.323

设置两者

```
android:layout_width="wrap_content"
android:layout_height="wrap_content" 
```

所有 Gridview 中的标记。

# wcf - WCF WebInvoke 响应格式

> ID：1008706
> 
> 赞同：5
> 
> 时间：2009-06-17T18:12:17.287
> 
> 标签：wcf, rest, responseformat

我有 WCF restul 服务，我想让用户选择他们想要的请求格式，我有装饰

```
 [OperationContract]
    [WebInvoke(Method = "GET", 
        ResponseFormat = WebMessageFormat.Xml, 
        BodyStyle = WebMessageBodyStyle.Wrapped, 
        UriTemplate = "getstreamurl?ch={ch}&format=xml")]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "getstreamurl?ch={ch}&format=json")] 
```

首先，有没有办法在运行时指定 ResponseFormat 并将格式作为方法的参数？从阅读中我不这么认为......好吧接下来的事情上面的代码没问题并且可以工作，但是我有一个问题，我希望能够指定一个默认值，所以当没有通过格式争论时我只是默认但如果我这样装饰

```
 [WebInvoke(Method = "GET", 
        ResponseFormat = WebMessageFormat.Xml, 
        BodyStyle = WebMessageBodyStyle.Wrapped, 
        UriTemplate = "getstreamurl?ch={ch})]

    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "getstreamurl?ch={ch}&format=json")] 
```

XML 是默认的，如果我尝试通过浏览器调用服务方法，它会告诉我：

> UriTemplateTable 不支持具有与模板 'getstreamurl?ch={ch}' 等效路径但具有不同查询字符串的多个模板，其中查询字符串不能全部通过文字值消除歧义。有关更多详细信息，请参阅 UriTemplateTable 的文档

它们显然可以区分开来，但似乎 WCF 只是在阅读论点，仅此而已……有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T21:08:35.970

不，我认为您不能在运行时以编程方式执行此操作。**如果从您的服务公开两个不同的端点，您当然可以**做什么——一个返回 XML，另一个返回 JSON，然后以编程方式选择从客户端应用程序调用哪个端点。

马克

**更新：**正如 Steve Michelotti 正确指出的那样，现在可以在 WCF 4.0 中实现 JSON 和 XML 之间的这种自动切换。WCF 4.0 具有改进的 REST 支持，其中还包括基于 HTTP 接受标头的格式消息选择功能。

有关 WCF 4.0 新功能的详细信息，请参阅：[开发人员对 WCF 4.0 的介绍](http://msdn.microsoft.com/en-us/library/ee354381.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-30T13:45:49.033

如果您的休息服务配置为自动选择响应类型，您可以执行此操作。

然后在客户端请求中只需添加所需的标头 Accept: application/json

# sql - 查询中的 Oracle 和 SQLServer 函数评估

> ID：1008709
> 
> 赞同：5
> 
> 时间：2009-06-17T18:13:14.693
> 
> 标签：sql, sql-server, oracle, rdbms

假设我在 Oracle 中的**select**或**where**子句上有一个函数调用，如下所示：

```
select a, b, c, dbms_crypto.hash(utl_raw.cast_to_raw('HELLO'),3)
  from my_table 
```

可以为 MS SQLServer 构建一个类似的示例。

每种情况下的预期行为是什么？

是否会为表中的每一行调用一次**HASH**函数，或者 DBMS 会足够聪明地只调用一次函数，因为它是一个具有常量参数且没有*副作用*的函数？

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T19:11:19.607

Oracle 的答案是视情况而定。除非该函数被标记为“确定性”，否则将为选定的每一行调用该函数，在这种情况下它只会被调用一次。

```
CREATE OR REPLACE PACKAGE TestCallCount AS
    FUNCTION StringLen(SrcStr VARCHAR) RETURN INTEGER;
    FUNCTION StringLen2(SrcStr VARCHAR) RETURN INTEGER DETERMINISTIC;
    FUNCTION GetCallCount RETURN INTEGER;
    FUNCTION GetCallCount2 RETURN INTEGER;
END TestCallCount;

CREATE OR REPLACE PACKAGE BODY TestCallCount AS
    TotalFunctionCalls INTEGER := 0;
    TotalFunctionCalls2 INTEGER := 0;

    FUNCTION StringLen(SrcStr VARCHAR) RETURN INTEGER AS
    BEGIN
        TotalFunctionCalls := TotalFunctionCalls + 1;
        RETURN Length(SrcStr);
    END;
    FUNCTION GetCallCount RETURN INTEGER AS
    BEGIN
        RETURN TotalFunctionCalls;
    END;

    FUNCTION StringLen2(SrcStr VARCHAR) RETURN INTEGER DETERMINISTIC AS
    BEGIN
        TotalFunctionCalls2 := TotalFunctionCalls2 + 1;
        RETURN Length(SrcStr);
    END;
    FUNCTION GetCallCount2 RETURN INTEGER AS
    BEGIN
        RETURN TotalFunctionCalls2;
    END;

END TestCallCount;

SELECT a,TestCallCount.StringLen('foo') FROM(
    SELECT 0 as a FROM dual
    UNION
    SELECT 1 as a FROM dual
    UNION
    SELECT 2 as a FROM dual
);

SELECT TestCallCount.GetCallCount() AS TotalFunctionCalls FROM dual; 
```

输出：

```
A                      TESTCALLCOUNT.STRINGLEN('FOO') 
---------------------- ------------------------------ 
0                      3                              
1                      3                              
2                      3                              

3 rows selected

TOTALFUNCTIONCALLS     
---------------------- 
3                      

1 rows selected 
```

所以在第一种情况下，StringLen() 函数被调用了 3 次。现在当使用 StringLen2() 执行时，表示确定性：

```
SELECT a,TestCallCount.StringLen2('foo') from(
    select 0 as a from dual
    union
    select 1 as a from dual
    union
    select 2 as a from dual
);

SELECT TestCallCount.GetCallCount2() AS TotalFunctionCalls FROM dual; 
```

结果：

```
A                      TESTCALLCOUNT.STRINGLEN2('FOO') 
---------------------- ------------------------------- 
0                      3                               
1                      3                               
2                      3                               

3 rows selected

TOTALFUNCTIONCALLS     
---------------------- 
1                      

1 rows selected 
```

所以 StringLen2() 函数只被调用一次，因为它被标记为确定性的。

对于未标记为确定性的函数，您可以通过如下修改查询来解决此问题：

```
select a, b, c, hashed
  from my_table
cross join (
  select dbms_crypto.hash(utl_raw.cast_to_raw('HELLO'),3) as hashed from dual
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T19:10:38.767

对于 SQL Server，它将针对每一行进行评估。

通过运行该函数一次并分配给一个变量并在查询中使用该变量，您会变得更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T19:46:09.770

简短的回答....这取决于。

如果函数正在访问数据，ORACLE 不知道每一行是否都相同，因此，它需要查询每一行。例如，如果您的函数只是一个总是返回相同值的格式化程序，那么您可以打开缓存（将其标记为确定性），这可能允许您只执行一次函数调用。

您可能想要研究的是 ORACLE WITH 子查询：

> WITH query_name 子句允许您为子查询块分配名称。然后，您可以通过指定查询名称来引用查询中多个位置的子查询块。Oracle 通过将查询名称视为内联视图或临时表来优化查询

我从[这里](http://www.psoug.org/reference/with.html)得到了引用的文本，其中有很多例子。

# c# - 如何使用 MVC 和 WebForms 配置和调试 Web 应用程序

> ID：1008712
> 
> 赞同：1
> 
> 时间：2009-06-17T18:14:00.853
> 
> 标签：c#, asp.net-mvc, debugging, webforms

我有一个正在转换为 MVC 1.0 的现有 ASP.NET Web 应用程序。该网站一开始只有一个目标。然而，随着时间的推移，我们的赞助商要求更多的功能，很明显，由于新的要求，MVC 将是我们的最佳途径。在过去的几个月里，我涉足了 MVC，并且很好地掌握了它的所有工作原理。我现在面临的问题是，我们现有的 Web 应用程序的核心是大量使用*仅*在 ASP.NET WebForms 中工作的第 3 方工具。

我正在研究的解决方案是在服务器上运行两个 Web 应用程序。一个应用程序将是我们现有的 WebForms 应用程序，仅用于公开上述第 3 方工具的功能。另一个应用程序将是我们的主要门户，它将充当新站点。当用户希望与第 3 方工具交互时，我希望能够在将用户链接到其他应用程序的适当视图上加载 iFrame，然后允许他们与 WebForms 站点交互。这听起来很疯狂吗？

我现在面临的第一个问题是如何配置我的解决方案使 MVC 应用程序与 WebForms 应用程序对话。每次我运行解决方案时，都会为两个应用程序分配一个不同的端口号，我无法弄清楚如何正确配置我的 iFrame“src”属性。当然，我不能将 WebForms 应用程序添加到我的 MVC 应用程序的引用中，所以我很难过！

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:35:30.353

如果端口问题是唯一的问题，您可以在 IIS 中的固定虚拟应用程序下运行它们。

但是 ASP.NET 开发服务器还具有将端口固定为特定数字而不是每次都随机化的功能。

# java - wsdl java导入问题

> ID：1008715
> 
> 赞同：1
> 
> 时间：2009-06-17T18:14:46.237
> 
> 标签：java, wsdl

```
import com.premiereconnect.premconn.FaxNumberAvailableListRequest;
import com.premiereconnect.premconn.FaxNumberAvailableListResult;
import com.premiereconnect.premconn.GroupListResult;
import com.premiereconnect.premconn.UserCreateRequest;
import com.premiereconnect.premconn.UserCreateResult;
import com.premiereconnect.premconn.UserUpdateRequest;
import com.premiereconnect.premconn.UserUpdateResult; 
```

以上导入的类在 wsdl 文件中.. 如何生成包“comm.premiereconnect.premconn”.... 还给出了 wsdl 文件的 url... 如何生成/解决此导入问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:17:32.473

如果您有[J2EE 5 SDK](http://java.sun.com/javaee/downloads/?intcmp=1282)或[JDK 6](http://java.sun.com/javase/downloads/?intcmp=1281)，它们会附带一个名为[wsimport](http://java.sun.com/javase/6/docs/technotes/tools/share/wsimport.html)的工具，可用于从 wsdl 文件或 url 生成 JAX-WS 代理类。

```
wsimport -s src -d build -p com.premiereconnect.premconn -keep my.wsdl 
```

将处理 my.wsdl 并在包中创建源文件`src/com/priemiereconnect/premconn`和二进制文件`build/com/premiereconnect/premconn``com.premiereconnect.premconn`

my.wsdl 可以是 url 或文件。

*巧合*的是，上面使用的目录是 Eclipse 用于其项目的源文件和二进制文件的目录。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T06:43:39.610

我试图从 wsdl 链接生成 java 类，它给出了解析错误......所以它与 wsdl 文件有关吗？

[

```
~/workspace/provisioning_tool_1.0.0_dev_dist/ProvisioningTool$]wsimport.exe -s src -d build -p com.premiereconnect.premconn -keep http://premconn.premiereconnect.com/2007/09/AM?WSDL

        parsing WSDL...

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1055 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1051 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1063 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1059 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1071 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1067 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1079 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1075 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1087 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1083 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1095 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1091 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1103 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1099 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1111 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1107 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1119 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1115 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1127 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1123 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1135 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1131 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1143 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1139 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1151 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1147 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1159 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1155 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1167 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1163 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1175 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        [ERROR] Failed to generate Java signature: duplicate parameter names parameter. Use JAXWS binding customization to rename the wsdl:part "parameter"
        line 1171 of file:/D:/Profiles/pdk473/workspace/Provisioning%20Tool/test.wsdl

        Failed to parse the WSDL. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T18:50:32.900

在 WSDL 上使用 Axis 的 WSDL2Java 来创建类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T20:56:58.490

正如 stevedbrown 所说， [WSDL2Java](http://ws.apache.org/axis/java/user-guide.html#WSDL2JavaBuildingStubsSkeletonsAndDataTypesFromWSDL)将为您完成这项工作:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-30T02:33:51.493

使用 axis2-1.5.5\bin\wsdl2java 或 apache-cxf-2.5.2\bin\wsdl2java -autoNameResolution 可以解决您的问题。但是，我不知道这个名称冲突的底层。

# windows - 谁拥有 Windows 中的文件句柄？

> ID：1008723
> 
> 赞同：4
> 
> 时间：2009-06-17T18:16:54.157
> 
> 标签：windows, file, handle

你如何发现哪个进程对文件有一个打开的句柄？具体来说，您如何以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:51:11.310

可能有它的API，我不知道。如果有，它可能是内核中的 API。

另一种可能性（抱歉含糊不清，但我现在要回答这个问题，以防其他人发布更好的答案）是没有（记录的）API，并且执行此操作的程序通过使用未记录的知识来做到这一点句柄的内容，和/或句柄（当被视为指针时）指向的内存：例如，我找到[了 A Process' Kernel Object Handle Table](http://book.51cto.com/art/200808/87776.htm)，我认为那（人们说他们有逆向工程未记录的内存结构）是我记得几年前在 Softice 手册中阅读的内容。

寻找更多信息的地方可能是[File System Filter Drivers](http://www.microsoft.com/whdc/driver/filterdrv/default.mspx)。

另一种（也许更好）的方法可能是使用`depends`或`dumpbin /imports`尝试查看相关的 Sysinternals 程序正在使用哪些 API。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-17T18:19:48.053

Sysinternals 的流程浏览器会告诉您这一点。

# html - 单选按钮在 ie 和 chrome 中消失

> ID：1008725
> 
> 赞同：6
> 
> 时间：2009-06-17T18:17:04.873
> 
> 标签：html, css, internet-explorer, google-chrome, radio-button

下面是样式表

```
 select,input ,td a {border:1px solid green; width:25%;height:25px;font-size:20px;margin-  left:.1em;}
input.myradio {border:none;width:0%;height:0%;font-size:0%;} 
```

下面是html

```
<td><input class="myradio"  type="radio" name="poolstatus" value="Add">Add</input><td> 
```

它在 Firefox 中很完美，但 chrome 和 IE 没有显示单选按钮？为什么这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T18:23:50.403

这是因为您已将单选按钮设置为 0% 高 - 即 0px - 不存在。

您可以通过将高度和宽度设置为“自动”来覆盖它，这将重置它们（除非在样式表的其他地方有更具体的规则）

```
input.myradio {
  border:none;
  width:auto;
  height:auto;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T18:20:59.457

我的猜测是 input.myradio 类中的“width:0%;height:0%”。你需要一个宽度和高度。

试试这个：

```
input.myradio {border:none;width:1em;height:1em;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:20:33.230

为什么要为它们指定 0% 的高度和宽度？我猜这就是 IE 和 Chrome 不显示单选按钮的原因，因为它们的大小为 0 像素。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-02-16T10:28:11.667

您需要将单选按钮放在`<form>`标签内，它们将出现在 Chrome 和 IE 中：

```
<form><input type="radio" /></form> 
```

# c++ - 仅使用关键部分的 Win32 读/写锁

> ID：1008726
> 
> 赞同：9
> 
> 时间：2009-06-17T18:17:19.320
> 
> 标签：c++, multithreading, winapi, critical-section

作为工作项目的一部分，我必须使用 Win32 api 在 C++ 中实现读/写锁。所有现有的解决方案都使用在执行期间需要上下文切换的内核对象（信号量和互斥体）。这对我的应用程序来说太慢了。

如果可能的话，我想只使用关键部分来实现一个。锁不必是进程安全的，只有线程安全的。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T18:47:22.190

如果您可以针对 Vista 或更高版本，您应该使用内置的[SRWLock 的](http://msdn.microsoft.com/en-us/library/aa904937(VS.85).aspx). 它们像临界区一样是轻量级的，在没有争用时完全是用户模式。

Joe Duffy 的博客最近有一些关于实现不同类型的非阻塞读取器/写入器锁的[条目。](http://www.bluebytesoftware.com/blog/2009/06/05/AScalableReaderwriterSchemeWithOptimisticRetry.aspx)这些锁确实会旋转，因此如果您打算在持有锁的同时做大量工作，它们将不合适。代码是 C#，但应该可以直接移植到本机。

您可以使用临界区和事件来实现读取器/写入器锁——您只需要保持足够的状态以仅在必要时发出事件信号以避免不必要的内核模式调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T18:51:06.363

我认为如果不使用至少一个内核级对象（Mutex 或 Semaphore）就无法做到这一点，因为您需要内核的帮助才能使调用进程阻塞，直到锁可用。

关键部分确实提供了阻塞，但 API 太有限了。例如，您无法获取 CS，发现读锁可用但没有写锁，然后等待其他进程完成读取（因为如果其他进程具有临界区，它将阻塞其他错误的读取器，如果它不会那么你的进程不会阻塞，而是旋转，燃烧 CPU 周期。）

但是，您可以做的是使用自旋锁并在出现争用时回退到互斥锁。临界区本身就是以这种方式实现的。我将采用现有的关键部分实现，并用单独的读写器计数替换 PID 字段。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-10-18T14:47:43.390

老问题，但这是应该工作的。它不依赖于争论。如果读者很少或没有争用，他们会产生有限的额外成本，因为`SetEvent`被称为惰性（查看编辑历史以获取没有此优化的更重量级版本）。

```
#include <windows.h>

typedef struct _RW_LOCK {
    CRITICAL_SECTION countsLock;
    CRITICAL_SECTION writerLock;
    HANDLE noReaders;
    int readerCount;
    BOOL waitingWriter;
} RW_LOCK, *PRW_LOCK;

void rwlock_init(PRW_LOCK rwlock)
{
    InitializeCriticalSection(&rwlock->writerLock);
    InitializeCriticalSection(&rwlock->countsLock);

    /*
     * Could use a semaphore as well.  There can only be one waiter ever,
     * so I'm showing an auto-reset event here.
     */
    rwlock->noReaders = CreateEvent (NULL, FALSE, FALSE, NULL);
}

void rwlock_rdlock(PRW_LOCK rwlock)
{
    /*
     * We need to lock the writerLock too, otherwise a writer could
     * do the whole of rwlock_wrlock after the readerCount changed
     * from 0 to 1, but before the event was reset.
     */
    EnterCriticalSection(&rwlock->writerLock);
    EnterCriticalSection(&rwlock->countsLock);
    ++rwlock->readerCount;
    LeaveCriticalSection(&rwlock->countsLock);
    LeaveCriticalSection(&rwlock->writerLock);
}

int rwlock_wrlock(PRW_LOCK rwlock)
{
    EnterCriticalSection(&rwlock->writerLock);
    /*
     * readerCount cannot become non-zero within the writerLock CS,
     * but it can become zero...
     */
    if (rwlock->readerCount > 0) {
        EnterCriticalSection(&rwlock->countsLock);

        /* ... so test it again.  */
        if (rwlock->readerCount > 0) {
            rwlock->waitingWriter = TRUE;
            LeaveCriticalSection(&rwlock->countsLock);
            WaitForSingleObject(rwlock->noReaders, INFINITE);
        } else {
            /* How lucky, no need to wait.  */
            LeaveCriticalSection(&rwlock->countsLock);
        }
    }

    /* writerLock remains locked.  */
}

void rwlock_rdunlock(PRW_LOCK rwlock)
{
    EnterCriticalSection(&rwlock->countsLock);
    assert (rwlock->readerCount > 0);
    if (--rwlock->readerCount == 0) {
        if (rwlock->waitingWriter) {
            /*
             * Clear waitingWriter here to avoid taking countsLock
             * again in wrlock.
             */
            rwlock->waitingWriter = FALSE;
            SetEvent(rwlock->noReaders);
        }
    }
    LeaveCriticalSection(&rwlock->countsLock);
}

void rwlock_wrunlock(PRW_LOCK rwlock)
{
    LeaveCriticalSection(&rwlock->writerLock);
} 
```

您可以通过使用单个来降低读者的成本`CRITICAL_SECTION`：

*   `countsLock`替换为`writerLock`rdlock 和 rdunlock

*   `rwlock->waitingWriter = FALSE`在 wrunlock 中删除

*   wrlock的身体变成了

    ```
    EnterCriticalSection(&rwlock->writerLock);
    rwlock->waitingWriter = TRUE;
    while (rwlock->readerCount > 0) {
        LeaveCriticalSection(&rwlock->writerLock);
        WaitForSingleObject(rwlock->noReaders, INFINITE);
        EnterCriticalSection(&rwlock->writerLock);
    }
    rwlock->waitingWriter = FALSE;

    /* writerLock remains locked.  */ 
    ```

然而，这不公平，所以我更喜欢上述解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T18:26:26.903

看看“ [Windows 上的并发编程](https://rads.stackoverflow.com/amzn/click/com/032143482X)”一书，它有很多不同的读写器锁参考示例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T18:29:45.977

查看英特尔[线程构建块中的](http://www.threadingbuildingblocks.org/)[spin_rw_mutex](http://software.intel.com/en-us/blogs/2009/04/02/shared-access-with-tbb-readwrite-locks/) ...

> `spin_rw_mutex`严格在用户领域并使用自旋等待进行阻塞

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-25T00:48:33.680

这是一个老问题，但也许有人会发现这很有用。[我们为 Windows](https://github.com/NeoSmart/RWLock)开发了一个高性能[的开源`RWLock`](https://github.com/NeoSmart/RWLock)软件，如果可用，它会自动使用`SRWLock` [提到的 Vista+ Michael](https://stackoverflow.com/a/1008891/17027)，否则会退回到用户空间实现。

作为额外的奖励，它有四种不同的“口味”（尽管您可以坚持基本的，这也是最快的），每种都提供更多的同步选项。它从`RWLock()`不可重入的基础开始，仅限于单进程同步，并且不会将读/写锁交换为具有重入支持和读/写降级的成熟的跨进程 IPC RWLock。

如前所述，它们会在可能的情况下动态切换到 Vista+ slim 读写锁以获得最佳性能，但您根本不必担心这一点，因为它会退回到 Windows XP 及其上的完全兼容实现。同类。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T18:23:58.780

如果您已经知道**仅**使用互斥锁的解决方案，您应该能够将其修改为使用临界区。

我们使用两个关键部分和一些计数器滚动我们自己的。它符合我们的需求——我们的作者数量非常少，作者优先于读者，等等。我不能自由发表我们的文章，但可以说没有互斥锁和信号量是可能的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-06T15:12:51.683

这是我能想到的最小的解决方案：

[http://www.baboonz.org/rwlock.php](http://www.baboonz.org/rwlock.php)

并逐字粘贴：

```
/** A simple Reader/Writer Lock.

This RWL has no events - we rely solely on spinlocks and sleep() to yield control to other threads.
I don't know what the exact penalty is for using sleep vs events, but at least when there is no contention, we are basically
as fast as a critical section. This code is written for Windows, but it should be trivial to find the appropriate
equivalents on another OS.

**/
class TinyReaderWriterLock
{
public:
    volatile uint32 Main;
    static const uint32 WriteDesireBit = 0x80000000;

    void Noop( uint32 tick )
    {
        if ( ((tick + 1) & 0xfff) == 0 )     // Sleep after 4k cycles. Crude, but usually better than spinning indefinitely.
            Sleep(0);
    }

    TinyReaderWriterLock()                 { Main = 0; }
    ~TinyReaderWriterLock()                { ASSERT( Main == 0 ); }

    void EnterRead()
    {
        for ( uint32 tick = 0 ;; tick++ )
        {
            uint32 oldVal = Main;
            if ( (oldVal & WriteDesireBit) == 0 )
            {
                if ( InterlockedCompareExchange( (LONG*) &Main, oldVal + 1, oldVal ) == oldVal )
                    break;
            }
            Noop(tick);
        }
    }

    void EnterWrite()
    {
        for ( uint32 tick = 0 ;; tick++ )
        {
            if ( (tick & 0xfff) == 0 )                                     // Set the write-desire bit every 4k cycles (including cycle 0).
                _InterlockedOr( (LONG*) &Main, WriteDesireBit );

            uint32 oldVal = Main;
            if ( oldVal == WriteDesireBit )
            {
                if ( InterlockedCompareExchange( (LONG*) &Main, -1, WriteDesireBit ) == WriteDesireBit )
                    break;
            }
            Noop(tick);
        }
    }

    void LeaveRead()
    {
        ASSERT( Main != -1 );
        InterlockedDecrement( (LONG*) &Main );
    }
    void LeaveWrite()
    {
        ASSERT( Main == -1 );
        InterlockedIncrement( (LONG*) &Main );
    }
}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-23T19:55:01.590

我只使用关键部分编写了以下代码。

```
class ReadWriteLock {
    volatile LONG writelockcount;
    volatile LONG readlockcount;
    CRITICAL_SECTION cs;
public:
    ReadWriteLock() {
        InitializeCriticalSection(&cs);
        writelockcount = 0;
        readlockcount = 0;
    }
    ~ReadWriteLock() {
        DeleteCriticalSection(&cs);
    }
    void AcquireReaderLock() {        
    retry:
        while (writelockcount) {
            Sleep(0);
        }
        EnterCriticalSection(&cs);
        if (!writelockcount) {
            readlockcount++;
        }
        else {
            LeaveCriticalSection(&cs);
            goto retry;
        }
        LeaveCriticalSection(&cs);
    }
    void ReleaseReaderLock() {
        EnterCriticalSection(&cs);
        readlockcount--;
        LeaveCriticalSection(&cs);
    }
    void AcquireWriterLock() {
        retry:
        while (writelockcount||readlockcount) {
            Sleep(0);
        }
        EnterCriticalSection(&cs);
        if (!writelockcount&&!readlockcount) {
            writelockcount++;
        }
        else {
            LeaveCriticalSection(&cs);
            goto retry;
        }
        LeaveCriticalSection(&cs);
    }
    void ReleaseWriterLock() {
        EnterCriticalSection(&cs);
        writelockcount--;
        LeaveCriticalSection(&cs);
    }
}; 
```

要执行旋转等待，请使用 Sleep(0) 注释这些行。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-12-23T16:31:50.573

在这里查看我的实现：

[https://github.com/coolsoftware/LockLib](https://github.com/coolsoftware/LockLib)

VRWLock 是一个 C++ 类，它实现了单写 - 多读逻辑。

还可以查看测试项目 TestLock.sln。

UPD。下面是读写器的简单代码：

```
LONG gCounter = 0;

// reader

for (;;) //loop
{
  LONG n = InterlockedIncrement(&gCounter); 
  // n = value of gCounter after increment
  if (n <= MAX_READERS) break; // writer does not write anything - we can read
  InterlockedDecrement(&gCounter);
}
// read data here
InterlockedDecrement(&gCounter); // release reader

// writer

for (;;) //loop
{
  LONG n = InterlockedCompareExchange(&gCounter, (MAX_READERS+1), 0); 
  // n = value of gCounter before attempt to replace it by MAX_READERS+1 in InterlockedCompareExchange
  // if gCounter was 0 - no readers/writers and in gCounter will be MAX_READERS+1
  // if gCounter was not 0 - gCounter stays unchanged
  if (n == 0) break;
}
// write data here
InterlockedExchangeAdd(&gCounter, -(MAX_READERS+1)); // release writer 
```

VRWLock 类支持自旋计数和线程特定的引用计数，允许释放终止线程的锁。

# forms - 如何在基于请求范围 bean 中的值呈现表单时提交表单

> ID：1008727
> 
> 赞同：2
> 
> 时间：2009-06-17T18:17:48.447
> 
> 标签：forms, jsf, rendering

我在我的小程序中发现了一个问题，我想知道是否有人对如何尽可能最好地解决这个问题有任何提示或建议。

我有请求范围内的 bean testBean。它包含以下内容：

```
public class testBean {

private boolean internal = false; 
private String input = "";

public String internalTrue() {
    System.out.println("Set internal true");
    setInternal(true);
    return null;
}
public String submitForm() {
    System.out.println("");
    return null;
}
public boolean isInternal() {
    return internal;
}
public void setInternal(boolean internal) {
    this.internal = internal;
}
public String getInput() {
    return input;
}
public void setInput(String input) {
    this.input = input;
} 
```

}

我的文件welcomeJSF.jsp 包含以下内容：

```
 <f:view>
        <h:form>
            <h:commandButton value="Set internal true" action="#{testBean.internalTrue}" />
        </h:form>
        <h:panelGrid columns="1" rendered="#{testBean.internal}">
            <h:form>
                <h:outputText value="JavaServer Faces" /><h:inputText value="#{testBean.input}" />
                <h:commandButton value="Go" action="#{testBean.submitForm}" />
            </h:form>
        </h:panelGrid>
    </f:view> 
```

当我运行应用程序时，我显示了“设置内部为真”按钮。我点击它，然后我看到我有“Go”按钮的表单。单击“Go”不会触发我的 bean 中的方法，很可能是因为该字段实际上不再在服务器上呈现，因此它不会运行该方法。有什么聪明的解决方案吗？

在此先感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:11:37.990

面板的孩子永远不会解码输入，因为它的*渲染*属性在应用请求值阶段总是评估为*假。*从安全的角度来看，这是一件明智的事情。

[![替代文字](../Images/10144faac8828b17885474b81f568486.png)](https://i.stack.imgur.com/ho1kj.gif)
[（来源：[ibm.com](http://www.ibm.com/developerworks/java/library/j-jsf2/basic-lifecycle.gif)）]

* * *

您可以做的一件事是利用 JSF 组件在视图的生命周期内保持状态这一事实。

新豆：

```
public class TestBean {

  private String input = null;
  private UIComponent panel;

  public String internalTrue() {
    panel.setRendered(true);
    return null;
  }

  public String submitForm() {
    panel.setRendered(false);
    System.out.println("submitForm");
    return null;
  }

  public UIComponent getPanel() { return panel; }
  public void setPanel(UIComponent panel) { this.panel = panel; }

  public String getInput() { return input; }
  public void setInput(String input) { this.input = input; }

} 
```

绑定到 bean 的新视图：

```
 <f:view>
    <h:form>
      <h:commandButton value="Set internal true"
        action="#{testBean.internalTrue}" />
    </h:form>
    <h:panelGrid binding="#{testBean.panel}" columns="1"
      rendered="false">
      <h:form>
        <h:outputText value="JavaServer Faces" />
        <h:inputText value="#{testBean.input}" />
        <h:commandButton value="Go" action="#{testBean.submitForm}" />
      </h:form>
    </h:panelGrid>
  </f:view> 
```

*在panelGrid*上使用[binding](http://java.sun.com/javaee/5/docs/tutorial/doc/bnatg.html#bnatl)属性将导致在创建/恢复视图时调用*setPanel 。*

 *** * *

请注意，您可能需要进行一些测试，具体取决于您的实现和/或库的[StateManager](http://java.sun.com/javaee/5/docs/api/javax/faces/application/StateManager.html)在请求之间存储视图的方式（这又可能受*javax.faces.STATE_SAVING_METHOD*初始化参数的影响）。视图可能存储在表单中的隐藏字段中，在会话中以视图 ID 为键（这可能会导致与多个浏览器窗口发生冲突），在会话中以由 GET 或 JSF 导航创建的唯一 ID 为键，或者通过一些完全自定义的机制。该框架的可插拔特性使其具有通用性，但在这种情况下，这意味着您需要仔细检查您的实现的行为方式。**

# ruby-on-rails - 数组到 Active Record 模型

> ID：1008729
> 
> 赞同：2
> 
> 时间：2009-06-17T18:17:59.600
> 
> 标签：ruby-on-rails, arrays, activerecord

我想在视图中显示具体（今天）一天的任务。这些任务的估计时间必须每天总计 6 小时。

在模型中我有这个方法：

```
def self.tasks_for_today
  total_time = 0
  r = Array.new
  all(:conditions => "finished = 0").each do | t |
    total_time += t.estimated_time
    r << t if total_time <= 6
  end  
  r 
end 
```

并且工作正常，但我需要“r”变量作为任务模型的实例，而不是 Array 类的实例......

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:39:08.053

您可能已经做的一个重构是对未完成的任务使用[named_scoped](http://railscasts.com/episodes/108-named-scope)：

```
class Shirt < ActiveRecord::Base
  named_scope :unfinished, :conditions => {:finished => false}
end 
```

你真的不想返回一个实例（一个实例意味着一个任务）。

您也许可以订购您的任务，[获得一个运行总和](http://www.1keydata.com/sql/sql-running-totals.html)，然后只返回运行总和低于 6 的任务。我必须考虑更多，但如果你这样做，你最终会使用您选择的数据库引擎提供的[find_by_sql和 SQL 魔法。](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002557)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:25:53.303

您的方法将返回一个任务数组，并且 Task.all 也返回一个任务数组。尝试一下：

```
>> Task.all.class
=> Array 
```

使用任何数组，您都可以执行以下操作：

```
t.first
t.each {|a| ... } 
```

你到底想对你的结果做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T15:07:47.863

谢谢大家，这是我的错误，该方法可以满足我的要求...

这是最终代码：

```
def self.tasks_for_today
  total_time = 0
  r = Array.new
  all(:conditions => "finished = 0").each do | t |
    total_time += t.estimated_time
    total_time <= 6 ? r << t : break
  end
  r
end 
```

# windows - 在哪里存储所有用户的注册表数据

> ID：1008734
> 
> 赞同：5
> 
> 时间：2009-06-17T18:19:32.390
> 
> 标签：windows, registry, uac

我想在 Windows 注册表中的所有用户之间共享少量数据。用于登录到机器的任何用户或机器上的服务之间的共享**读写访问。**有没有可以做到这一点的地方？我曾尝试使用“HKEY_USERS\.DEFAULT\Software\”，但这似乎被 Vista UAC 规则阻止了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-23T22:56:10.890

您可以将所有用户数据放在`HKEY_LOCAL_MACHINE`配置单元中，但您需要调整密钥的权限，以使其可被所有用户写入，正如您的问题所述。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T18:24:12.010

`HKEY_LOCAL_MACHINE`应该是用户之间存储数据的地方。这里有一个很好的简短解释[，](http://www.computerperformance.co.uk/vista/vista_registry_structure.htm)关于哪些文件夹/配置单元用于什么。

# sql - 我的 Rails 查询开始变得复杂，我应该切换到原始 SQL 查询吗？你做什么工作？

> ID：1008740
> 
> 赞同：7
> 
> 时间：2009-06-17T18:20:32.590
> 
> 标签：sql, ruby-on-rails, activerecord

我的 Rails 应用程序开始需要复杂的查询。我应该开始使用原始 SQL 查询吗？Rails 社区的趋势是什么？

**更新：**

我现在没有书面查询，我想在开始之前问这个问题。但这是我想做的一个例子：

我有分类的书。我想说-

```
Give me all books that were: 
-created_at (added to store) between date1 and date2
-updated_at before date3
-joined with books that exist in shopping carts right now 
```

我还没有编写查询，但我认为 rails 版本将是这样的：

```
books_to_consider = Book.find(:all, 
                       :conditions => "created_at <= '#{date2}' AND created_at >= '#{date1}' AND updated_at <= '#{date3}'",
                       :joins => "as b inner join carts as c on c.book_id = b.id") 
```

我并不是说 ActiveRecord 不能处理这个查询，但是为了可读性而使用原始 SQL 是否更容易被接受（或者可能还有其他我不知道的限制）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T18:57:02.283

总体思路是尽可能坚持`ActiveRecord`生成的查询，**仅在必要时**使用 SQL 片段。明确支持 SQL 片段，因为它的创建者`ActiveRecord`意识到 SQL 不能被完全抽象掉。

使用`find`没有 SQL 片段的方法通常会获得更好的可维护性。鉴于您的示例，请尝试：

```
Book.find(:all,
  :conditions => ["created_at >= ? AND created_at <= ? AND updated_at <= ?", 
                  date1, date2, date3]
  :include => :carts) 
```

如果您添加到模型中，`:inlude => :carts`它将执行连接。如您所见，不必涉及太多 SQL。甚至输入的引用和转义也可以留给 Rails，同时仍然使用 SQL 文字来处理and运算符。`has_many :carts``Book``>=``<=`

再进一步，您可以使其更加清晰：

```
class Book < AciveRecord::Base
  # Somewhere in your Book model:
  named_scope :created_between, lambda { |start_date, end_date|
    { :conditions => { :created_at => start_date..end_date } }
  }
  named_scope :updated_before, lambda { |date|
    { :conditions => ["updated_at <= ?", date] }
  }
  # ...
end

Book.created_between(date1, date2).updated_before(date3).find(:all,
  :include => :carts) 
```

**更新：** s 的重点`named_scope`当然是*重用*条件。由您决定将一组条件放在命名范围内是否有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T19:33:57.160

就像 molf 所说的 :include 一样，.find() 具有急切加载子项的优势。此外，还有几个插件，如分页，将包装查找功能。您必须使用 .find() 才能使用插件。

如果您有一个非常复杂的 sql 查询，请记住 .find() 使用您的确切参数字符串。您可以随时注入自己的 sql 代码：

> :conditions => ["id in union (select * from table...

不要忘记 .find() 有很多可选参数

*   :conditions - SQL 片段，例如“administrator = 1”、[“user_name = ?”、user_name ] 或 [“user_name = :user_name”、{ :user_name => user_name }]。请参阅介绍中的条件。
*   :order - 类似“created_at DESC, name”的 SQL 片段。
*   :group - 应将结果分组的属性名称。使用 GROUP BY SQL 子句。
*   :have - 与 +:group+ 结合使用，可用于过滤 GROUP BY 返回的记录。使用 HAVING SQL 子句。
*   :limit - 一个整数，确定应返回的行数限制。
*   :offset - 一个整数，确定应从何处获取行的偏移量。所以在 5 处，它将跳过第 0 到第 4 行。
*   :joins - 用于附加连接的 SQL 片段，例如“LEFT JOIN comments ON comments.post_id = id”（很少需要），以与 :include 选项相同的形式命名关联，这将在关联表上执行 INNER JOIN (s)，或包含字符串和命名关联的混合数组。如果该值是一个字符串，那么这些记录将以只读方式返回，因为它们的属性与表的列不对应。通过 :readonly => false 覆盖。
*   :include - 命名应该一起加载的关联。命名的符号是指已定义的关联。请参阅关联下的即时加载。
*   :select - 默认情况下，这是“*”，如“SELECT * FROM”，但可以更改，例如，如果您想要进行连接但不包括连接的列。获取带有 SELECT SQL 片段的字符串（例如“id, name”）。
*   :from - 默认情况下，这是类的表名，但可以更改为备用表名（甚至是数据库视图的名称）。
*   :readonly - 将返回的记录标记为只读，这样它们就不能被保存或更新。
*   :lock - 一个 SQL 片段，如“FOR UPDATE”或“LOCK IN SHARE MODE”。:lock => true 给出连接的默认排他锁，通常是“FOR UPDATE”。

来源：http : [//api.rubyonrails.org/classes/ActiveRecord/Base.html#M002553](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#M002553)

# c# - 在 C# 中将文本添加到文件的开头和结尾

> ID：1008742
> 
> 赞同：6
> 
> 时间：2009-06-17T18:20:36.803
> 
> 标签：c#, xml, file-io

我有一个处理一系列“xml”文件的过程。我将 xml 放在引号中的原因是文件中的文本没有导致无效 xml 的根元素。在我的处理中，我想纠正这个问题并打开每个文件，在每个文件的开头和结尾添加一个根节点，然后将其关闭。这是我的想法，但这涉及打开文件、读取整个文件、标记节点，然后将整个文件写出。这些文件的大小可能超过 20 MB。

```
 foreach (FileInfo file in files)
        {
            //open the file
            StreamReader sr = new StreamReader(file.FullName);

            // add the opening and closing tags
            string text = "<root>" + sr.ReadToEnd() + "<root>";
            sr.Close();

            // now open the same file for writing
            StreamWriter sw = new StreamWriter(file.FullName, false);
            sw.Write(text);
            sw.Close();
        } 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T18:24:57.123

为避免将整个文件保存在内存中，请重命名原始文件，然后使用`StreamReader`. 然后打开原始文件名`StreamWriter`以创建一个新文件。

将`<root>`前缀写入文件，然后将数据以大块的形式从读取器复制到写入器。传输完所有数据后，编写结束符`</root>`（如果您希望它是 XML，请注意正斜杠）。然后关闭这两个文件并删除重命名的原始文件。

```
char[] buffer = new char[10000];

string renamedFile = file.FullName + ".orig";
File.Move(file.FullName, renamedFile);

using (StreamReader sr = new StreamReader(renamedFile))
using (StreamWriter sw = new StreamWriter(file.FullName, false))
{
    sw.Write("<root>");

    int read;
    while ((read = sr.Read(buffer, 0, buffer.Length)) > 0)
        sw.Write(buffer, 0, read);

    sw.Write("</root>");
}

File.Delete(renamedFile); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T18:53:59.120

20 MB 并不算多，但是当您将其作为字符串读取时，它将使用大约 40 MB 的内存。这也不是很多，但它是您不需要做的处理。您可以将其作为原始字节处理以减少内存使用，并避免对数据进行解码和重新编码：

```
byte[] start = Encoding.UTF8.GetBytes("<root>");
byte[] ending = Encoding.UTF8.GetBytes("</root>");

byte[] data = File.ReadAllBytes(file.FullName);

int bom = (data[0] == 0xEF) ? 3 : 0;

using (FileStream s = File.Create(file.FullName)) {
   if (bom > 0) {
      s.Write(data, 0, bom);
   }
   s.Write(start, 0, start.Length);
   s.Write(data, bom, data.Length - bom);
   s.Write(ending, 0, ending.Length);
} 
```

如果您需要更多地减少内存使用，请按照 Earwicker 的建议使用第二个文件。

编辑：
添加了处理 BOM（字节顺序标记）的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T18:24:19.653

我看不到任何真正的改进......这有点令人遗憾。由于无法“移动”文件，因此您始终必须移动整个文件中的字节以在顶部注入任何内容。

通过使用原始流而不是必须将流实际解析为文本的 StreamReader，您可能会发现一些性能优势。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T18:42:14.147

如果您不想在 C# 中执行此操作，则可以在命令行或批处理文件中轻松处理。

```
ECHO ^<root^> > outfile.xml
TYPE temp.xml >> outfile.xml
ECHO ^</root^> >> outfile.xml 
```

这将假设您有一些现有的过程来获取可以挂钩的数据文件。

# ruby-on-rails - 如何避免 ruby 中的错误回滚迁移？

> ID：1008744
> 
> 赞同：1
> 
> 时间：2009-06-17T18:20:58.427
> 
> 标签：ruby-on-rails, migration, rollback

我在迁移中的“self.drop”中有一个错误，因此我无法回滚该迁移。我如何从头开始并从迁移 001 开始构建？另外，有没有办法在不丢失我的数据的情况下做到这一点（它只是测试，但仍然......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T10:22:29.743

您可以注释 self.down 迁移中的所有语句并回滚到以前的数据库版本。

然后在迁移之前使用 gui/web db 客户端手动应用更改以匹配 db 模式。

之后您将能够再次运行迁移并且您的数据不会丢失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:13:59.503

```
rake db:drop
rake db:create
rake db:migrate 
```

它将重置您的数据库并运行所有迁移。如果您不想丢失数据，可以使用插件[yaml_db](http://github.com/adamwiggins/yaml_db/tree/master)保存它：

```
rake db:data:dump  # stores all data in db/data.yml
...
rake db:data:load  # loads db/data.yml to database 
```

如果您在迁移中遇到错误，您可以对其进行编辑，然后尝试回滚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-09T19:07:45.623

我意识到这是一个老问题，但恕我直言仍然相关。如果你想从头开始重新创建你的数据库，一个不回滚并重新运行迁移，一个只做

```
rake db:setup 
```

这将使用所有迁移的当前组合状态删除、创建和填充数据库。这是因为，绝对在大型系统中，运行所有迁移可能不再有效。但是，运行`schema.rb`将始终有效。

我的建议也是尽可能避免回滚迁移，除非您刚刚创建迁移并希望在将迁移推送到您的团队或任何部署之前进行一些添加/错字/修复。

# java - 使用 CompositeKey 的休眠示例 OneToMany

> ID：1008748
> 
> 赞同：4
> 
> 时间：2009-06-17T18:21:23.713
> 
> 标签：java, hibernate, orm

您能给我一个针对以下情况的 Hibernate 映射示例：

1.  `foo`具有简单主键 ( ) 的父表 ( `foo_id`)
2.  `bar`具有复合键的子表（ ）

    a) 父表的外键 ( `foo_id`)

    b)`item`字符串类型的 key()

3.  许多孩子只有一个父母
4.  父类将有一个子对象列表
5.  当父类被保存、更新、删除时，更改将级联到子类

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T20:46:46.403

我还没有完全按照您的要求完成，但这可能会让您朝着正确的方向前进。我认为它应该工作。本页更详细[地](http://docs.jboss.org/hibernate/stable/annotations/reference/en/html_single/#d0e1700)解释了这些注释。

```
@Entity
public class Foo {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    public Long getId(){

    }
    ...
    @OneToMany(mappedBy="foo")
    public Collection<Bar> getBars() {

    }

...
}

@Entity
@IdClass(BarPk.class)
public class Bar implements Serializable {
    @ManyToOne
    @JoinColumn(name="foo")
    @Id
    public Foo getFoo() {
        return foo;
    }

    @Column(name="key", length=255)
    @Id
    public String getKey(){

    }

}

@Embeddable
public class BarPk implements Serializable {
    public Foo getFoo() {
        return foo;
    }
    public void setFoo(Foo foo) {

    }
    public String getKey(){
    ...
    }   

    public void setKey(String key){
    ...
    }     

    //you must include equals() and hashcode()    
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T06:22:00.450

是的，您应该使用以下映射

@Entity 公共类父 {

```
@Id
private Integer id;

@CollectionOfElements
@JoinTable(
    name="Child",
    joinColumn=@JoinColumn(name="PARENT_ID"))
@IndexColumn("childIndex")
private List<Child> childList = new ArrayList<Child>(); 
```

}

注意 @CollectionOfElements 和 IndexColumn 是 Hibernate 特定的注释，而不是 JPA 1.0 规范。JPA 2.0 将介绍它们。

@Embeddable 公共类子 {

```
// @Embeddable class does not contains identifiers 
// child class specific property's 
```

}

所以下面的代码可以正常工作

父母父母=新父母（）；

parent.getChildList().add(new Child()); parent.getChildList().add(new Child()); // 其他孩子

session.save（父）；// 一个父母和两个孩子将被保存

这个问题的缺点是 @CollectionOfElements 注释只适用于 @Embeddadble 类，而不是实体类。如果您想要一个子类作为实体类，我想看看解决方案。不可能同时将 @Entity 和 @Embeddable 注释应用于一个类。

问候 Arthur Ronald FD Garcia（Java 程序员） Natal/RN - 巴西

# linux - 在 Bash/Sh 等中用于 Shell 脚本的 IDE / Emacs 模式

> ID：1008750
> 
> 赞同：20
> 
> 时间：2009-06-17T18:21:49.470
> 
> 标签：linux, bash, emacs, scripting, gnu

我将 Emacs 用于 shell 脚本。我知道我在某处读到了一些模式，可以更轻松地在 Emacs 上编写 Shell 脚本（代码完成、自动完成、括号匹配、语法高亮、检查语法），但找不到它。简而言之，我想把 Emacs 变成一个 Bash IDE。

此外，是否有任何其他工具/IDE 可以使 GNU/Linux Shell 上的脚本编写更容易？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-17T18:24:48.823

嗯，有一个内置的 shell 模式可以进行语法高亮，如果它还没有打开，`M-x shell-script-mode`它会为你做。

关于使脚本编写更容易的工具。有一个[bash shell 调试器](http://bashdb.sourceforge.net/)，所以如果你用 bash 编程，那会很有帮助。

当然还有[eshell](http://www.emacswiki.org/emacs/CategoryEshell)，一个用 Emacs lisp 编写的 shell，因此您可以从 lisp、自动完成和 emacs lisp 调试器中获得您期望的所有语法突出显示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:30:40.720

我不认为 shell 脚本有任何代码完成模式，至少在 Emacs 中没有。（我实际上从来没有觉得有必要。）但是，在交互式运行时，bash 支持完成（该包称为“bash-completion”或类似的东西）。这为许多 shell 命令提供了制表符补全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T05:32:30.083

VIM 世界的另一个 IDE：

插件[bash-support.vim](http://vim.sourceforge.net/scripts/script.php?script_id=365)

[屏幕截图](http://lug.fh-swf.de/vim/vim-bash/screenshots-en.html)

[在线帮助文​​件](http://lug.fh-swf.de/vim/vim-doc/bashsupport.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-29T14:01:15.107

## 我知道这是旧帖子，但我想分享我的设置。

我有同样的问题，现在我在我的 .emacs 文件中使用下面的代码来自动完成 sh/bash 代码。

```
(require 'auto-complete)
(require 'auto-complete-config)
(ac-config-default) 
```

如果您使用最新版本的 Emacs，语法高亮应该已经可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-29T18:38:24.343

[Griffon](http://griffon.lasotel.fr/en/)是专门为 BASH 脚本设计的 IDE。它的功能包括自动完成、语法高亮、错误检测等。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2019-09-29T01:32:06.633

我对 Emacs 不是很熟悉，但我相信它并不方便。如我所见，好的ide总是可以做到：

1.  跳转到声明
2.  查找参考资料
3.  代码大纲和显示符号
4.  突出显示事件
5.  代码完成

所以我会推荐 Jetbrain Idea（带有 bashsupport 插件）和 Visual Studio Code（带有 bash ide 和 shell 格式扩展）。

ps：

bashsupport - [https://plugins.jetbrains.com/plugin/4230-bashsupport/](https://plugins.jetbrains.com/plugin/4230-bashsupport/)

bash ide - [https://marketplace.visualstudio.com/items?itemName=mads-hartmann.bash-ide-vscode](https://marketplace.visualstudio.com/items?itemName=mads-hartmann.bash-ide-vscode)

# jquery - jquery 不会调用 pagemethods

> ID：1008751
> 
> 赞同：0
> 
> 时间：2009-06-17T18:21:51.217
> 
> 标签：jquery, pagemethods

我希望 jquery 成功返回对 pagemethod 的调用结果。我已经复制了每个示例，一个字母一个字母，并将其粘贴到我的网络项目中，但无济于事。

我已经在 VS 2005 和 2008 上尝试过示例 - 没有任何效果。我试过上面的例子 - nada。我在看什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:51:04.040

我不确定这是否有帮助，但前段时间我在启用 Firebug 附加组件时从 FireFox（3.5 beta）调用 PageMethods 时遇到了问题。在禁用 Firebug 的情况下，它可以工作。

从那时起，Firebug 和 Firefox 有了更新，现在它可以工作了。

# ruby-on-rails - 在 solaris 10 上部署 ruby on rails 应用程序

> ID：1008752
> 
> 赞同：2
> 
> 时间：2009-06-17T18:22:00.983
> 
> 标签：ruby-on-rails, ruby, solaris

目前有没有人在 solaris 10 机器上部署 rails 应用程序？如果是这样，你能给我简要介绍一下你必须做些什么来让它启动和运行吗？

我是一名 Web 开发人员，我在一个封闭的环境中工作，他们使用的是 sun solaris 服务器，所有这些服务器都仅供防火墙后面的内部使用。我绝不是 solaris 管理员类型，而且这里的 solaris 管理员类型对 ruby​​/rails 没有任何知识，也没有兴趣学习。

在 OS/X、Linux（OpenSuse、Ubuntu、Fedora）和 Windows 中启动和运行 ruby​​ on rails 开发环境没有问题。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T09:54:05.217

看起来[Phusion 的](http://modrails.com)Apache 2 乘客模块支持 Solaris。

[Johannes Fahrenkrug](http://www.springenwerk.com)于 2009 年 3 月编写了一个教程，其中介绍了[将 Ruby on Rails 部署到 Solaris 10 以及 Passenger 和 Ruby Enterprise Edition](http://www.springenwerk.com/2009/03/passenger-and-ruby-enterprise-edition.html)。

还有[这篇文章](http://www.cubiclemuses.com/cm/articles/2009/04/09/rails-passenger-open-solaris-ec2/)讨论了部署到 Open Solaris。虽然 Open Solaris 和 Solaris 不是同一种野兽，但它可能有一些您需要的指针。

# java - 如何更改 jtable 中的默认停止编辑行为

> ID：1008757
> 
> 赞同：2
> 
> 时间：2009-06-17T18:23:20.963
> 
> 标签：java, jtable, cells

当您在 jtable 中编辑单元格时，该值仅在焦点发生更改或按 Enter 时才会变为永久值（例如，如果您将单元格值从“abc”更改为“xyz”并关闭窗口，则编辑将丢失） . 当用户停止编辑时，如何使编辑永久化？

我想我们必须在编辑单元格值时更新单元格值，但我不确定如何。任何帮助表示赞赏！

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-25T03:59:26.897

```
// tell JTable to stop editing and save any changes when the table
// loses focus. This means edits will be saved when clicking on 
// another component, eg: button.
table.putClientProperty("terminateEditOnFocusLost", Boolean.TRUE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:48:28.037

我会在单元格上设置一个 ActionListener，在每次击键后将单元格的值保存到一个变量中（假设单元格有焦点）。然后，无论窗口发生什么，这个变量仍将包含当前单元格中的任何内容。很简单。

# asp.net - Silverlight 调试期间的 Web 服务超时

> ID：1008771
> 
> 赞同：4
> 
> 时间：2009-06-17T18:25:01.133
> 
> 标签：asp.net, silverlight, web-services

所以我正在单步执行我的代码，现在我再次运行该项目以移动到另一个断点。但是我的项目并没有继续，而是崩溃说我已经超过了 web 服务的超时限制。

如何增加 Web 服务的超时限制以停止收到这些异常？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T19:41:40.747

您需要在**Web.config**和**ServiceReferences.ClientConfig**文件中指定元素的`openTimeout`、`sendTimeout`和属性。`receiveTimeout``closeTimeout``<binding>`

 ****例如：

```
<binding name="..." ... openTimeout="01:00:00" sendTimeout="01:00:00" receiveTimeout="01:00:00" closeTimeout="01:00:00">
    <security mode="Transport" />
</binding> 
```

如果这回答了您的问题，请“将其标记为答案”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T11:54:57.657

我在 Silverlight 端捕获了超时异常，因此我可以在抛出异常后继续调试。****

# apache-flex - 测量中不包括组件尺寸

> ID：1008774
> 
> 赞同：1
> 
> 时间：2009-06-17T18:25:39.930
> 
> 标签：apache-flex

我有一个自定义组件，它基本上是`VBox`带有 a`Label`和 a 的`TextField`。

```
<mx:VBox width="50%">
    <mx:Label width="100%"/>
    <mx:TextField width="100%"/>
</mx:VBox> 
```

基本上，我想要的是将其中两个`VBox`es 放在 a 上`HBox`，每个都将占用 50% - 他们的孩子`Label`，`TextField`应该遵守这一点。

如果我将`Label`and`TextField`的宽度都设置为 100%，并且`Label`文本不适合，则默认行为是扩展`VBox`宽度 - 我不希望这种情况发生。应该始终占据宽度的`TextField`100%，并且我希望`Label`将 显式设置为 的宽度`TextField`，因此文本将被截断并且不会扩展 VBox 宽度。

有没有办法告诉标签只服从`VBox`（或`TextField`）宽度而不包括在`VBox`宽度的测量中？

不确定我是否清楚。：） 提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:58:32.467

这并不像我想的那么容易。一开始我想建议 maxWidth 但它不能与标签一起正常工作。但是我刚刚测试了这个：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
        <![CDATA[
            import mx.controls.TextInput;
            import mx.controls.Label;
            private function onTextChanged(event:Event):void {
                var currentText:String = TextInput(event.target).text;
                var shortened:Boolean = false;
                // adding 30 to leave some space for ...
                while ( lbl.measureText(currentText).width > (lbl.width-30) ) {
                    currentText = currentText.substr(0,currentText.length-1);
                    shortened = true;
                }
                lbl.text = currentText + ((shortened) ? "..." : "" );
            }
        ]]>
    </mx:Script>
    <mx:VBox width="50%">
        <mx:Label id="lbl" width="100%" />
        <mx:TextInput width="100%" change="onTextChanged(event);" />
    </mx:VBox>
</mx:WindowedApplication> 
```

它可能不是以您期望的方式（只是归因）编写的，但它可以满足您的需求。如果这不是解决方案，您可以考虑以下列方式扩展标签。克里特自定义标签：

radekg/MyLabel.as

```
package radekg {
    import mx.controls.Label;

    public class MyLabel extends Label {
        public function MyLabel() {
            super();
        }

        private var _myText:String;

        override public function get text():String {
            return _myText;
        }

        override public function set text(value:String):void {
            if ( value != null && initialized ) {
                // store the copy so the getter returns original text
                _myText = value;
                // shorten:
                var shortened:Boolean = false;
                while ( measureText(value).width > (width-30) ) {
                    value = value.substr(0,value.length-1);
                    shortened = true;
                }
                super.text = value + ((shortened) ? "..." : "");
            }
        }
    }
} 
```

并像这样使用它：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    xmlns:controls="radekg.*">
    <mx:VBox width="50%">
        <controls:MyLabel width="100%" id="lbl" text="{ti.text}" />
        <mx:TextInput width="100%" id="ti" />
        <mx:Button label="Display label text" click="mx.controls.Alert.show(lbl.text)" />
    </mx:VBox>
</mx:WindowedApplication> 
```

这可以简单地与绑定一起使用。一旦您在文本输入中键入很长的文本并且标签显示...单击按钮。您会注意到 text() getter 返回原始文本。

希望这可以帮助。

# ssl - 这对于传递密码是否可以接受？

> ID：1008779
> 
> 赞同：0
> 
> 时间：2009-06-17T18:26:44.767
> 
> 标签：ssl, md5, security

我有一个网站，要求用户使用用户名和密码对自己进行身份验证。我想使用 SSL，但我没有 SSL 证书。但我会做一些我认为还可以的事情。

我的网站主要基于 AJAX 并且*需要*JavaScript，否则将无法正常工作。

当用户尝试登录时，我使用 AJAX 查询数据库以查找该用户名的盐，如果没有找到随机盐（以防止人们知道是否存在具有该用户名的用户） . 然后，使用 JavaScript 的 MD5 函数，我在客户端对密码进行 4K 次哈希和加盐（就像 Linux 在使用 MD5 进行密码哈希时所做的那样）客户端，然后我将该哈希以纯文本形式传递给服务器。然后，这个哈希值会再被哈希几次，并与数据库中的内容进行检查。

这安全吗？如果没有，我怎样才能在不为大部分内部网站的 SSL 证书支付现金的情况下保护它？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T18:29:03.560

不，它不安全。中间人可以窥探散列值并稍后将其呈现给您，从而错误地验证了自己。

要对某人进行身份验证，您必须证明他们知道一个秘密。通过未加密通道传递的任何内容都不是秘密。

使用 SSL。[您可以免费获得 Firefox 接受的](https://stackoverflow.com/questions/292732/self-signed-ssl-cert-or-ca/292754#292754)证书，并且可以向 IE 用户提供有关将新 CA 添加到其受信任根的说明。[开箱即用的所有浏览器都接受的证书](https://stackoverflow.com/questions/34968/cheapest-ssl-certificates)很便宜，我认为每年 30 美元。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T18:34:30.493

最好的选择是：

*   使用[StartCom](http://cert.startcom.org/)签署的证书（免费）。*最新版本的 Firefox 和Safari*原生支持。使用 IE 的用户可以将 CA 添加到他们的受信任根列表中。
*   使用自签名证书并将其分发给您的用户以添加到他们的浏览器中。

正如其他人所提到的，您的解决方案并不安全。与以明文形式向服务器发送密码相比，它没有任何改进。主要原因：

*   从客户端以明文形式发送并直接用于身份验证的任何内容都容易受到中间人攻击和窃听攻击。在您建议的解决方案中，如果您知道散列密码，则可以登录。将密码作为散列发送没有区别。
*   鉴权后，数据仍然是明文发送的，所以很容易被嗅探。
*   [MD5全是洞](http://www.win.tue.nl/hashclash/rogue-ca/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T18:33:08.390

您可以免费制作自己的 SSL 证书，一般用户不会信任它，但您可以信任它。

通过使用 JavaScript 和未加密的传输层，您打开了有人抓取您发送到服务器的哈希的可能性，更不用说给出您如何对密码/用户名进行哈希处理的确切蓝图。

这实际上取决于该应用程序的安全性有多重要。如果非常重要，请放弃 Ajax，并选择 SSL 证书并使用 HTTPS 层。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T19:03:52.023

您的解决方案可以重放攻击。直接在浏览器和 Web 服务器之间尝试[Digest Authentication (RFC 2617)。](http://en.wikipedia.org/wiki/Digest_access_authentication)

# php - 简单的正则表达式 PHP

> ID：1008780
> 
> 赞同：1
> 
> 时间：2009-06-17T18:27:20.957
> 
> 标签：php, regex

我有一个字符串，我需要查看它是否包含以下“_archived”。

我正在使用以下内容：

```
preg_match('(.*)_archived$',$string); 
```

但得到：

```
Warning: preg_match() [function.preg-match]: Unknown modifier '_' in /home/storrec/classes/class.main.php on line 70 
```

我是正则表达式的新手，所以这可能很容易。

或者我应该使用更简单的东西，比如

```
strstr($string, "_archived"); 
```

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T18:31:01.030

strstr($string, "_archived");

对于您描述的问题，这将变得更容易。

正如经常引用的那样

> 有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。- 杰米扎温斯基

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T18:30:38.800

strstr 在这种情况下就足够了，但要解决您的问题，您需要在正则表达式中添加分隔符。定界符是开始和结束正则表达式的特殊字符，如下所示：

```
preg_match('/_archived/',$string); 
```

分隔符可以是很多不同的字符，但通常的选择是 /、# 和 !。来自 PHP 手册：

> 任何字符都可以用作分隔符，只要它不是字母数字、反斜杠 () 或空字节即可。如果必须在表达式本身中使用分隔符，则需要使用反斜杠对其进行转义。从 PHP 4.0.4 开始，您还可以使用 Perl 样式的 ()、{}、[] 和 <> 匹配分隔符。

[在此处](http://se.php.net/manual/en/regexp.reference.php)阅读有关 PHP 正则表达式语法的所有信息。

[您可以在此处的 PHP 手册](http://se.php.net/manual/en/pcre.examples.php)中看到一些有效（和无效）模式的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:30:11.610

您只需要一些分隔符，例如用 / 括起模式

```
preg_match('/_archived$/',$string); 
```

Perl 正则表达式允许您使用任何分隔符，如果您的正则表达式使用 / 很多，这很方便。我经常发现自己使用大括号，例如：

```
preg_match('{_archived$}',$string); 
```

另外，请注意，您不需要 (.*) 位，因为您没有捕获“_archived”之前的位，您只是在测试字符串是否以它结尾（末尾的 $ 符号与字符串的结尾）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T18:31:01.233

如果您要查找的只是一个字符串是否包含一个字符串，那么请务必使用简单版本。但您也可以简单地执行以下操作：

```
preg_match('/_archived/', $string); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T18:30:21.017

尝试：

```
preg_match('/(.*)_archived$/',$string); 
```

如果您只是检查字符串是否存在于 $string 中，那么 strstr 对您来说应该足够了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T18:30:27.800

我认为 strstr() 或 strpos() 会更好地找到这样的东西。您得到的错误是由于您的正则表达式周围没有任何分隔符。尝试使用

```
"/(.*)_archived$/" 
```

或者

```
"#(.*)_archived$#". 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T18:34:49.573

...可能是实现这一点的最佳方式。你是对的，正则表达式是矫枉过正的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T19:07:56.990

当你有一个你正在寻找的特定字符串时，使用正则表达式有点矫枉过正。您可以在这里使用 PHP 的标准字符串搜索功能之一。

strstr 函数可以工作，但传统的 PHP 智慧（阅读：神话、传说、迷信、[手册](http://us3.php.net/strstr)）说使用 strpos 函数会产生更好的性能。即，类似

```
if(strpos($string, '_archived') !== false) {
} 
```

您需要在此处使用真正的不等式运算符，因为 strpos 在它的大海捞针开始处找到一根针时会返回“0”。有关这方面的更多信息，请参阅[手册](http://us3.php.net/strpos)。

至于您的问题，PHP 的正则表达式引擎希望您用一组分隔符将您的正则表达式字符串括起来，这些分隔符可以是许多不同字符之一（“/”或“|”或“(”或“{”或"#", or ...). PHP 引擎认为你想要一个正则表达式

```
.* 
```

带有一组模式修饰符，它们是

```
_archived$ 
```

因此，将来，当您使用正则表达式时，请尝试类似

```
//equivilant
preg_match('/(.*)_archived$/i',$string);
preg_match('{(.*)_archived$}i',$string);
preg_match('#(.*)_archived$#i',$string); 
```

“/”、“#”和“{}”字符是您的分隔符。它们不在匹配中使用，它们用于告诉引擎“这些字符之间的任何内容都是我的正则表达式。末尾的“i”是一个模式修饰符，表示不区分大小写。没有必要，但我将它包含在这里，以便您可以看到模式修饰符的外观，并帮助您理解为什么首先需要分隔符。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-11T11:17:27.380

[如果您使用T-Regx](https://t-regx.com)，则不必记住分隔符

```
pattern('_archived$')->matches($string) 
```

# java - 是否可以指定 JVM ( 或 IDE ) 使用哪个网络接口

> ID：1008781
> 
> 赞同：14
> 
> 时间：2009-06-17T18:27:57.540
> 
> 标签：java, networking

情况是这样的，我的 macbook pro 中有两个网络接口。一个是静态定义的以太网接口，另一个是 DHCP 配置的无线接口。

我试图弄清楚如何配置特定的 java 项目以仅使用我的静态连接接口，而不是简单地通过 JVM 或通过我的 IDEA ( IntelliJ 8 ) 选择列表中的第一个

我已经设法通过一个 vmware 实例实现了这一点，在该实例中，我的虚拟环境仅从我的有线接口提供，但是这个广告性能问题以及在 windows / osx 之间翻转的一般头痛。

到目前为止，我一直无法找到让我指定使用哪个 nic 的 jvm 属性，也没有看到定义它的 IntelliJ 文档。如果有人对如何尽可能轻松地解决此问题有任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T18:34:25.017

`java.net.Socket`有一个构造函数，它指定要绑定到哪个本地 IP 地址，并且由于每个网络接口都有自己的 IP 地址，因此您可以使用它。

但是从a`java.net.Socket`到更高级别的协议（例如HTTP）完全是另一回事，但您没有指定那将是什么。

我不知道这样做的 JVM 级别的方法，遗憾的是，只是上面的编程方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T18:34:21.367

用于通信的 NIC 由操作系统根据可访问任何地址的最佳“路由”来选择。位于 NIC 驱动程序之上的应用程序无法选择特定的 NIC。只有在侦听绑定在特定地址的端口时才能接近，这仅适用于运行服务器的情况。

您可以尝试修改特定于 NIC 的路由的“度量”，以强制操作系统更喜欢它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-19T06:24:04.330

是的，您可以通过以下方式指定：

```
int port= 52000; //some free port

MulticastSocket msocket = new MulticastSocket(port);

msocket.setInterface(InetAddress.getByName("172.16.30.205")); 
```

我的 PC 的 IP 地址之一在哪里`172.16.30.205`，我想通过接口进行通信。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-06T13:53:27.333

这可能会有所帮助： [识别网络接口示例](http://java.sun.com/docs/books/tutorial/networking/nifs/definition.html "识别网络接口示例")

*“[I]如果您有偏好或需要指定要使用的 NIC，您可以在系统中查询相应的接口，并在您要使用的接口上找到地址。”*

# scala - 使用 Scala 中的可变参数

> ID：1008783
> 
> 赞同：55
> 
> 时间：2009-06-17T18:28:18.443
> 
> 标签：scala, variadic-functions

我正在撕扯头发，试图弄清楚如何执行以下操作：

```
def foo(msf: String, o: Any, os: Any*) = {
    println( String.format(msf, o :: List(os:_*)) )
} 
```

我必须用 an`o`和 an`os` `Seq`分别声明方法是有原因的。基本上，我最终得到了使用单个对象参数（类型`List` ）调用的格式方法。尝试：

```
def foo(msf: String, o: Any, os: Any*) = {
    println( String.format(msf, (o :: List(os:_*))).toArray )
} 
```

给我类型错误：

> 找到：数组[任何]
> 
> 需要 Seq[java.lang.Object]

我尝试过强制转换，它编译但失败的原因与第一个示例几乎相同。当我尝试

```
println(String.format(msg, (o :: List(os:_*)) :_* )) 
```

这无法编译隐式转换歧义（`any2ArrowAssoc`和`any2stringadd`）

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-06-17T18:37:22.017

```
def foo(msf: String, o: AnyRef, os: AnyRef*) = 
  println( String.format(msf, (o :: os.toList).toArray : _* )) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-18T19:46:32.703

```
def foo(msf: String, o: AnyRef, os: AnyRef*) =
  println( String.format(msf, o :: os.toList : _* ) ) 
```

或者

```
def foo(msf: String, o: AnyRef, os: AnyRef*) =
      println( msf format (o :: os.toList : _* ) ) 
```

我更喜欢后者，尽管它不支持 locale*。

*   Scala 2.8 确实支持 RichString 格式的语言环境。

# c# - C#：将字符串数组划分为 N 个实例的最简洁方法

> ID：1008785
> 
> 赞同：19
> 
> 时间：2009-06-17T18:28:45.370
> 
> 标签：c#, arrays, string, loops

我知道如何以一种丑陋的方式做到这一点，但我想知道是否有更优雅和简洁的方法。

我有一个电子邮件地址的字符串数组。假设字符串数组是任意长度的——它可能有几个项目，也可能有很多项目。我想构建另一个由字符串数组中的 50 个电子邮件地址组成的字符串，直到数组末尾，并在每 50 个电子邮件地址之后调用发送操作，在 Send() 方法中使用 50 个地址的字符串。

更普遍的问题是做这种事情的最干净/最清晰的方法是什么。我有一个解决方案，它是我学习 VBScript 的遗产，但我敢打赌 C# 中有更好的方法。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-06-17T19:06:52.983

你要优雅简洁，我给你优雅简洁：

```
var fifties = from index in Enumerable.Range(0, addresses.Length) 
              group addresses[index] by index/50;
foreach(var fifty in fifties)
    Send(string.Join(";", fifty.ToArray()); 
```

当你不需要的时候，为什么要搞乱那些糟糕的循环代码呢？您想将事物按 50*分组，然后按 50 分组。* 这就是组操作员的用途！

更新：评论者 MoreCoffee 询问这是如何工作的。假设我们想三人一组，因为这样更容易输入。

```
var threes = from index in Enumerable.Range(0, addresses.Length) 
              group addresses[index] by index/3; 
```

假设有九个地址，索引从 0 到 8

这个查询是什么意思？

`Enumerable.Range`是从零开始的九个数字的范围，所以`0, 1, 2, 3, 4, 5, 6, 7, 8`.

范围变量`index`依次采用这些值中的每一个。

然后我们检查每个对应`addresses[index]`的并将其分配给一个组。

我们将它分配到哪个组？要分组`index/3`。在 C# 中整数算术向零舍入，因此索引 0、1 和 2 在除以 3 时变为 0。索引 3、4、5 在除以 3 时变为 1。索引 6、7、8 变为 2。

因此，我们将和分配给第 0 组，`addresses[0]`将和分配给第 1 组，依此类推。`addresses[1]``addresses[2]``addresses[3]``addresses[4]``addresses[5]`

查询的结果是三组的序列，每组是三项的序列。

那有意义吗？

还要记住，*查询表达式*的结果是*代表此操作的查询*。在循环执行之前，它不会*执行*操作。`foreach`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-17T18:39:49.893

似乎类似于这个问题：[Split a collection into n parts with LINQ?](https://stackoverflow.com/questions/438188/split-a-collection-into-n-parts-with-linq)

*Hasan Khan*的答案的修改版本应该可以解决问题：

```
public static IEnumerable<IEnumerable<T>> Chunk<T>(
    this IEnumerable<T> list, int chunkSize)
{
    int i = 0;
    var chunks = from name in list
                 group name by i++ / chunkSize into part
                 select part.AsEnumerable();
    return chunks;
} 
```

使用示例：

```
var addresses = new[] { "a@example.com", "b@example.org", ...... };

foreach (var chunk in Chunk(addresses, 50))
{
    SendEmail(chunk.ToArray(), "Buy V14gr4");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T18:44:32.053

听起来输入由一个大数组中的单独电子邮件地址字符串组成，而不是一个字符串中的多个电子邮件地址，对吧？在输出中，每个批次都是一个组合字符串。

```
string[] allAddresses = GetLongArrayOfAddresses();

const int batchSize = 50;

for (int n = 0; n < allAddresses.Length; n += batchSize)
{
    string batch = string.Join(";", allAddresses, n, 
                      Math.Min(batchSize, allAddresses.Length - n));

    // use batch somehow
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T18:57:45.543

假设您使用的是 .NET 3.5 和 C# 3，这样的事情应该可以很好地工作：

```
string[] s = new string[] {"1", "2", "3", "4"....};

for (int i = 0; i < s.Count(); i = i + 50)
{
    string s = string.Join(";", s.Skip(i).Take(50).ToArray());
    DoSomething(s);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T18:39:41.657

我将遍历数组并使用 StringBuilder 创建列表（我假设它由 ; 分隔，就像您使用电子邮件一样）。只需在您达到 mod 50 或结束时发送。

```
void Foo(string[] addresses)
{
    StringBuilder sb = new StringBuilder();

    for (int i = 0; i < addresses.Length; i++)
    {
        sb.Append(addresses[i]);
        if ((i + 1) % 50 == 0 || i == addresses.Length - 1)
        {
            Send(sb.ToString());
            sb = new StringBuilder();
        }
        else
        {
            sb.Append("; ");
        }
    }
}

void Send(string addresses)
{
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T18:36:38.727

我认为我们需要对这份清单的具体内容有更多的了解，才能给出明确的答案。现在我假设它是一个以分号分隔的电子邮件地址列表。如果是这样，您可以执行以下操作来获取分块列表。

```
public IEnumerable<string> DivideEmailList(string list) {
  var last = 0;
  var cur = list.IndexOf(';');
  while ( cur >= 0 ) {
    yield return list.SubString(last, cur-last);
    last = cur + 1;
    cur = list.IndexOf(';', last);
  }
}

public IEnumerable<List<string>> ChunkEmails(string list) {
  using ( var e = DivideEmailList(list).GetEnumerator() ) {
     var list = new List<string>();
     while ( e.MoveNext() ) {
       list.Add(e.Current);
       if ( list.Count == 50 ) {
         yield return list;
         list = new List<string>();
       }
     }
     if ( list.Count != 0 ) {
       yield return list;
     }
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-11T23:01:34.590

我认为这足够简单和快速。下面的示例将长句子分为 15 个部分，但是您可以将批量大小作为参数传递以使其动态。这里我只是使用“/n”进行划分。

```
 private static string Concatenated(string longsentence)
 {
     const int batchSize = 15;
     string concatanated = "";
     int chanks = longsentence.Length / batchSize;
     int currentIndex = 0;
     while (chanks > 0)
     {
         var sub = longsentence.Substring(currentIndex, batchSize);
         concatanated += sub + "/n";
         chanks -= 1;
         currentIndex += batchSize;
     }
     if (currentIndex < longsentence.Length)
     {
         int start = currentIndex;
         var finalsub = longsentence.Substring(start);
         concatanated += finalsub;
     }
     return concatanated;
 } 
```

这显示了拆分操作的结果。

```
 var parts = Concatenated(longsentence).Split(new string[] { "/n" }, StringSplitOptions.None); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-26T10:22:40.433

基于[Eric 回答的](https://stackoverflow.com/a/1008974/1475331)扩展方法：

```
public static IEnumerable<IEnumerable<T>> SplitIntoChunks<T>(this T[] source, int chunkSize)
{
    var chunks = from index in Enumerable.Range(0, source.Length)
                 group source[index] by index / chunkSize;

    return chunks;
}

public static T[][] SplitIntoArrayChunks<T>(this T[] source, int chunkSize)
{
    var chunks = from index in Enumerable.Range(0, source.Length)
                 group source[index] by index / chunkSize;

    return chunks.Select(e => e.ToArray()).ToArray();
} 
```

# ssl - 如何将 OpenSSL 与 WinSock 一起使用？

> ID：1008798
> 
> 赞同：7
> 
> 时间：2009-06-17T18:30:56.787
> 
> 标签：ssl, openssl, winsock

我已经在网上搜索并没有找到任何关于这个的...

有没有人有使用 WinSock 和 OpenSSL 的简单代码示例？我正在寻找一个简单的 Visual C++ 2005 或更高版本的代码示例，它创建并打开一个 winsock 连接并使用 OpenSSL 应用必要的 SSL 设置并适当地释放所有资源。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T07:39:00.663

早在 2002 年，我为 Windows Developer Magazine 写了一篇文章，展示了如何使用 OpenSSL 为 MFC 的 CAsyncSocket 提供 SSL。[代码和文章](http://www.serverframework.com/asynchronousevents/2010/10/using-openssl-with-asynchronous-sockets.html)可能会对您有所帮助，尽管它确实比您可能需要的更进一步，因为主要关注点不是 winsock 集成，而是将 OpenSSL 与异步 winsock 一起使用。我以此作为[将 OpenSSL 与基于 I/O 完成的高性能 winsock 服务器集成](http://www.serverframework.com/products---the-free-framework.html)的基础。

# java - 将符号、重音字母转换为英文字母

> ID：1008802
> 
> 赞同：140
> 
> 时间：2009-06-17T18:31:24.447
> 
> 标签：java, unicode, special-characters, diacritics

问题是，如您所知，[Unicode 图表中](http://www.ssec.wisc.edu/~tomw/java/unicode.html)有数千个字符，我想将所有相似的字符转换为英文字母表中的字母。

例如，这里有一些转换：

```
ҥ->H
Ѷ->V
Ȳ->Y
Ǭ->O
Ƈ->C
tђє Ŧค๓เℓy --> the Family
... 
```

我看到字母 A/a 有 20 多个版本。而且我不知道如何对它们进行分类。它们看起来就像大海捞针。

unicode 字符的完整列表位于[http://www.ssec.wisc.edu/~tomw/java/unicode.html](http://www.ssec.wisc.edu/~tomw/java/unicode.html) 或[http://unicode.org/charts/charindex.html](http://unicode.org/charts/charindex.html)。只需尝试向下滚动并查看字母的变化。

如何使用 Java 转换所有这些？请帮我 ：（

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2009-07-31T22:06:03.700

从[如何从 .NET 中的字符串中删除变音符号（口音）重新发布我的帖子？](https://stackoverflow.com/questions/249087/how-do-i-remove-diacritics-accents-from-a-string-in-net)

此方法在 java 中运行良好*（纯粹是为了删除变音符号也就是重音符号）*。

它基本上将所有重音字符转换为它们的去重音字符，然后是它们的组合变音符号。现在您可以使用正则表达式去除变音符号。

```
import java.text.Normalizer;
import java.util.regex.Pattern;

public String deAccent(String str) {
    String nfdNormalizedString = Normalizer.normalize(str, Normalizer.Form.NFD); 
    Pattern pattern = Pattern.compile("\\p{InCombiningDiacriticalMarks}+");
    return pattern.matcher(nfdNormalizedString).replaceAll("");
} 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-11-03T13:28:05.087

从版本开始，它是[Apache Commons Lang](https://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/StringUtils.html#stripAccents%28java.lang.String%29)的一部分。3.0。

```
org.apache.commons.lang3.StringUtils.stripAccents("Añ"); 
```

返回`An`

另请参阅[http://www.drillio.com/en/software-development/java/removing-accents-diacritics-in-any-language/](http://www.drillio.com/en/software-development/java/removing-accents-diacritics-in-any-language/)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-06-17T20:18:12.157

试图“全部转换”是解决问题的错误方法。

首先，您需要了解您正在尝试做的事情的局限性。正如其他人所指出的那样，变音符号的存在是有原因的：它们本质上是该语言字母表中的唯一字母，具有自己的含义/声音等：删除这些标记与替换英文单词中的随机字母相同。这是在您考虑西里尔语言和其他基于脚本的文本（例如阿拉伯语）之前，这些文本根本无法“转换”为英语。

如果您出于某种原因*必须*转换字符，那么解决此问题的唯一明智方法是首先缩小手头任务的范围。考虑输入的来源 - 如果您正在为“西方世界”编写应用程序（使用尽可能好的短语），那么您不太可能需要解析阿拉伯字符。同样，Unicode 字符集包含数百个数学和图形符号：用户没有（简单的）方法可以直接输入这些符号，因此您可以假设它们可以被忽略。

通过采取这些逻辑步骤，您可以减少可能要解析的字符数，以使基于字典的查找/替换操作可行。然后它就变成了创建字典的少量稍微无聊的工作，以及执行替换的微不足道的任务。如果您的语言支持本机 Unicode 字符（如 Java 那样）并正确优化静态结构，那么这种查找和替换往往会非常快。

这来自于开发允许最终用户搜索包含变音字符的书目数据的应用程序的经验。查找数组（在我们的例子中）可能需要 1 个工作日才能生成，以涵盖所有西欧语言的所有变音符号。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-09-09T08:50:27.777

由于将“家庭”变成“tђє Ŧค๓เℓy”的编码实际上是随机的，并且不遵循任何可以通过所涉及的 Unicode 代码点信息解释的算法，因此没有通用的方法来解决这个算法。

您需要将 Unicode 字符映射到它们相似的拉丁字符。您可能可以通过对表示 Unicode 代码点的实际字形进行一些智能机器学习来做到这一点。但我认为为此付出的努力将大于手动构建该映射。特别是如果您有大量可以从中构建映射的示例。

澄清一下：实际上可以通过Unicode数据解决一些替换（正如其他答案所证明的那样），但是有些字母与它们相似的拉丁字符没有合理的关联。

例子：

*   “ђ”（U+0452 CYRILLIC SMALL LETTER DJE）与“d”的关系比与“h”的关系更大，但用于表示“h”。
*   “Ŧ”（U+0166 LATIN CAPITAL LETTER T WITH STROKE）与“T”（顾名思义）有些相关，但用于表示“F”。
*   "ค" (U+0E04 THAI CHARACTER KHO KHWAI) 根本与任何拉丁字符无关，在您的示例中用于表示“a”

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-04-12T13:23:35.450

字符串测试：ÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝß

测试：

*   [Apache Commons Lang3](https://commons.apache.org/proper/commons-lang/)的输出：AAAAAAÆCEEEEIIIIÐNOOOOOØUUUUYß
*   [ICU4j](https://mvnrepository.com/artifact/com.ibm.icu/icu4j)的输出：AAAAAÆCEEEEIIIIÐNOOOOOØUUUUYß
*   [JUnidecode](https://github.com/gcardone/junidecode)的输出：AAAAAAECEEEEIIIIDNOOOOOOUUUUUss（Ý 问题和另一个[问题](https://github.com/gcardone/junidecode/issues/2)）
*   [Unidecode](https://github.com/xuender/unidecode)的输出：AAAAAAECEEEEIIIIDNOOOOOOUUUUYss

**最后的选择是最好的。**

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-11-10T06:13:57.563

原始请求已经得到答复。

但是，我为那些可能正在寻找通用音译代码以在 Java 中将任何字符集音译为拉丁语/英语的人发布以下答案。

音译的朴素含义：最终形式/目标字符集的翻译字符串听起来像是原始形式的字符串。如果我们想将任何字符集音译为拉丁语（英文字母），那么 ICU4（Java 中的 ICU4J 库）将完成这项工作。

这是java中的代码片段：

```
 import com.ibm.icu.text.Transliterator; //ICU4J library import

    public static String TRANSLITERATE_ID = "NFD; Any-Latin; NFC";
    public static String NORMALIZE_ID = "NFD; [:Nonspacing Mark:] Remove; NFC";

    /**
    * Returns the transliterated string to convert any charset to latin.
    */
    public static String transliterate(String input) {
        Transliterator transliterator = Transliterator.getInstance(TRANSLITERATE_ID + "; " + NORMALIZE_ID);
        String result = transliterator.transliterate(input);
        return result;
    } 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-17T22:33:32.943

如果需要转换“òéışöç->oeisoc”，您可以使用这个起点：

```
public class AsciiUtils {
    private static final String PLAIN_ASCII =
      "AaEeIiOoUu"    // grave
    + "AaEeIiOoUuYy"  // acute
    + "AaEeIiOoUuYy"  // circumflex
    + "AaOoNn"        // tilde
    + "AaEeIiOoUuYy"  // umlaut
    + "Aa"            // ring
    + "Cc"            // cedilla
    + "OoUu"          // double acute
    ;

    private static final String UNICODE =
     "\u00C0\u00E0\u00C8\u00E8\u00CC\u00EC\u00D2\u00F2\u00D9\u00F9"             
    + "\u00C1\u00E1\u00C9\u00E9\u00CD\u00ED\u00D3\u00F3\u00DA\u00FA\u00DD\u00FD" 
    + "\u00C2\u00E2\u00CA\u00EA\u00CE\u00EE\u00D4\u00F4\u00DB\u00FB\u0176\u0177" 
    + "\u00C3\u00E3\u00D5\u00F5\u00D1\u00F1"
    + "\u00C4\u00E4\u00CB\u00EB\u00CF\u00EF\u00D6\u00F6\u00DC\u00FC\u0178\u00FF" 
    + "\u00C5\u00E5"                                                             
    + "\u00C7\u00E7" 
    + "\u0150\u0151\u0170\u0171" 
    ;

    // private constructor, can't be instanciated!
    private AsciiUtils() { }

    // remove accentued from a string and replace with ascii equivalent
    public static String convertNonAscii(String s) {
       if (s == null) return null;
       StringBuilder sb = new StringBuilder();
       int n = s.length();
       for (int i = 0; i < n; i++) {
          char c = s.charAt(i);
          int pos = UNICODE.indexOf(c);
          if (pos > -1){
              sb.append(PLAIN_ASCII.charAt(pos));
          }
          else {
              sb.append(c);
          }
       }
       return sb.toString();
    }

    public static void main(String args[]) {
       String s = 
         "The result : È,É,Ê,Ë,Û,Ù,Ï,Î,À,Â,Ô,è,é,ê,ë,û,ù,ï,î,à,â,ô,ç";
       System.out.println(AsciiUtils.convertNonAscii(s));
       // output : 
       // The result : E,E,E,E,U,U,I,I,A,A,O,e,e,e,e,u,u,i,i,a,a,o,c
    }
} 
```

JDK 1.6 提供了可用于此任务的 java.text.Normalizer 类。

[在此处](http://www.rgagnon.com/javadetails/java-0456.html)查看示例

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-06-17T18:49:31.890

将任意 Unicode “转换”为 ASCII 的问题在于字符的含义取决于文化。例如，说德语的人应该将“ß”转换为“ss”，而说英语的人可能会将其转换为“B”。

再加上 Unicode 具有相同字形的多个代码点这一事实。

结果是，这样做的唯一方法是创建一个包含每个 Unicode 字符和您想要将其转换为的 ASCII 字符的大表。您可以通过将带有重音符号的字符规范化为规范化形式 KD 来采取捷径，但并非所有字符都规范化为 ASCII。此外，Unicode 没有定义字形的哪些部分是“重音”。

这是执行此操作的应用程序的一小段摘录：

```
switch (c)
{
    case 'A':
    case '\u00C0':  //  À LATIN CAPITAL LETTER A WITH GRAVE
    case '\u00C1':  //  Á LATIN CAPITAL LETTER A WITH ACUTE
    case '\u00C2':  //  Â LATIN CAPITAL LETTER A WITH CIRCUMFLEX
    // and so on for about 20 lines...
        return "A";
        break;

    case '\u00C6'://  Æ LATIN CAPITAL LIGATURE AE
        return "AE";
        break;

    // And so on for pages...
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-06-17T19:14:07.793

您可以尝试使用`unidecode`，它可以作为[ruby​​ gem](http://rubyforge.org/projects/unidecode/)和[cpan 上的 perl 模块使用](http://search.cpan.org/~sburke/Text-Unidecode-0.04/lib/Text/Unidecode.pm)。本质上，它就像一个巨大的查找表，其中每个 unicode 代码点都与一个 ascii 字符或字符串相关。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-06-27T12:04:57.840

没有简单或通用的方法来做你想做的事，因为这只是你的主观意见，这些字母看起来像你想要转换成的拉丁字母。它们实际上是独立的字母，具有自己独特的名称和声音，只是表面上看起来像拉丁字母。

如果你想要这种转换，你必须根据你认为非拉丁字母应该转换成的拉丁字母来创建自己的翻译表。

（如果您只想删除变音符号，此线程中有一些答案：[How do I remove diacritics (accents) from a string in .NET？](https://stackoverflow.com/questions/249087/how-do-i-remove-diacritics-accents-from-a-string-in-net)但是您描述了一个更普遍的问题）

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-08-14T22:11:46.353

我迟到了，但是今天遇到这个问题后，我发现这个答案非常好：

```
String asciiName = Normalizer.normalize(unicodeName, Normalizer.Form.NFD)
    .replaceAll("[^\\p{ASCII}]", ""); 
```

参考： [https ://stackoverflow.com/a/16283863](https://stackoverflow.com/a/16283863)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-06-26T10:50:43.413

以下课程可以解决问题：

```
org.apache.lucene.analysis.miscellaneous.ASCIIFoldingFilter 
```

# d - 如何在 D 2.0 中使用 pure

> ID：1008803
> 
> 赞同：10
> 
> 时间：2009-06-17T18:31:54.350
> 
> 标签：d, pure-function

在玩 D 2.0 时，我发现了以下问题：

示例 1：

```
pure string[] run1()
{
   string[] msg;
   msg ~= "Test";
   msg ~= "this.";
   return msg;
} 
```

这可以按预期编译和工作。

当我尝试将字符串数组包装在一个类中时，我发现我无法让它工作：

```
class TestPure
{
    string[] msg;
    void addMsg( string s )
    {
       msg ~= s;
    }
};

pure TestPure run2()
{
   TestPure t = new TestPure();
   t.addMsg("Test");
   t.addMsg("this.");
   return t;
} 
```

此代码不会编译，因为 addMsg 函数不纯。我无法使该函数成为纯函数，因为它会更改 TestPure 对象。我错过了什么吗？或者这是一个限制？

以下确实编译：

```
pure TestPure run3()
{
    TestPure t = new TestPure();
    t.msg ~= "Test";
    t.msg ~= "this.";
    return t;
} 
```

~= 运算符不会被实现为 msg 数组的不纯函数吗？为什么编译器在 run1 函数中没有抱怨呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-07T21:15:58.390

从 v2.050 开始，D 也放宽了`pure`接受所谓的“弱纯”函数的定义。这是指“[不读取或写入任何全局可变状态](http://digitalmars.com/d/2.0/function.html#pure-functions)”的函数。弱纯函数**与**函数式语言意义上的纯函数不同。唯一的关系是他们制作了真正的纯函数，也就是“强纯”函数能够调用弱函数，就像 OP 的例子一样。

有了这个，`addMsg` *可以*标记为 (weakly) `pure`，因为只有局部变量`this.msg`被改变：

```
class TestPure
{
    string[] msg;
    pure void addMsg( string s )
    {
       msg ~= s;
    }
}; 
```

当然，现在你可以不加修改地使用 (strongly)`pure`功能`run2`。

```
pure TestPure run2()
{
   TestPure t = new TestPure();
   t.addMsg("Test");
   t.addMsg("this.");
   return t;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T04:19:46.793

其他人已经指出 addMsg 不是纯的，也不能是纯的，因为它会改变对象的状态。

使其变得纯粹的唯一方法是封装您所做的更改。最简单的方法是通过返回突变，有两种方法可以实现。

首先，你可以这样做：

```
class TestPure
{
    string[] msg;
    pure TestPure addMsg(string s)
    {
        auto r = new TestPure;
        r.msg = this.msg.dup;
        r.msg ~= s;
        return r;
    }
} 
```

您需要复制前一个数组，因为在纯函数内部，this 引用实际上是 const。请注意，您可以通过分配最终大小的新数组然后复制自己的元素来更好地进行复制。你可以像这样使用这个函数：

```
pure TestPure run3()
{
    auto t = new TestPure;
    t = t.addMsg("Test");
    t = t.addMsg("this.");
    return t;
} 
```

这样，突变被限制在每个纯函数中，变化通过返回值传递出去。

编写 TestPure 的另一种方法是使成员 const 并在将其传递给构造函数之前执行所有突变：

```
class TestPure
{
    const(string[]) msg;
    this()
    {
        msg = null;
    }
    this(const(string[]) msg)
    {
        this.msg = msg;
    }
    pure TestPure addMsg(string s)
    {
        return new TestPure(this.msg ~ s);
    }
} 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T18:36:43.720

请查看纯函数的定义：

*   [http://en.wikipedia.org/wiki/Pure_function](http://en.wikipedia.org/wiki/Pure_function)
*   [http://www.digitalmars.com/d/2.0/function.html#pure-functions](http://www.digitalmars.com/d/2.0/function.html#pure-functions)

> 纯函数是对相同参数产生相同结果的函数。为此，一个纯函数：
> 
> *   具有所有不变或隐式可转换为不变的参数
> *   不读取或写入任何全局可变状态

使用纯函数的效果之一是它们可以安全地并行化。但是，并行执行函数的多个实例并不安全，因为它们可能同时修改类实例，从而导致同步问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T22:05:21.957

我*认为*您的代码在概念上是正确的。但是，您可能已经发现编译器的语义分析不如您的大脑的情况。

考虑类的源不可用的情况。在这种情况下，编译器将无法告诉`addMsg`您只修改成员变量，因此它不允许您从纯函数中调用它。

为了在您的情况下允许它，它必须对这种类型的使用进行特殊情况处理。添加的每个特殊情况规则都会使语言更加复杂（或者，如果未记录，则使其不那么可移植）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-17T18:42:30.560

只是预感，但这个函数并不总是返回相同的结果。

看，它返回对某个对象的引用，虽然该对象将始终包含相同的数据，但多次调用相同函数返回的对象并不相同；也就是说，它们没有相同的内存地址。

当您返回对该对象的引用时，您实际上是在返回一个内存地址，这在多次调用中会有所不同。

另一种思考方式是，返回值的一部分是对象的内存地址，它依赖于一些全局状态，如果一个函数的输出依赖于全局状态，那么它就不是纯的。见鬼，它甚至不必依赖它；只要一个函数读取一个全局状态，那么它就不是纯粹的。通过调用“新”，您正在阅读全局状态。

# php - PHP RegExp 某些字符

> ID：1008808
> 
> 赞同：1
> 
> 时间：2009-06-17T18:33:10.793
> 
> 标签：php, regex

什么是摆脱除字母、数字、双引号和连字符之外的所有字符的好方法。这是我到目前为止得到的。

```
$test = preg_replace('#[^a-zA-Z0-9"-]#',' ',$string); 
```

有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T18:35:30.773

您的正则表达式与您将要找到的解决方案一样好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:36:03.033

您可以使用 \d 来匹配数字，使用标志 i 来匹配不区分大小写的 az。

```
$test = preg_replace('#[^a-z\d\w"-]#i','',$string); 
```

这是 php 正则表达式语法参考：[http ://se.php.net/manual/en/regexp.reference.php](http://se.php.net/manual/en/regexp.reference.php)

# c# - 使用 C# 将文件“即时”写入客户端

> ID：1008810
> 
> 赞同：7
> 
> 时间：2009-06-17T18:33:27.237
> 
> 标签：c#, asp.net

我正在使用 C# 和 ASP.NET 2.5。

我想要一种简单的方法来即时生成一个“文件”（假设这个例子是一个 csv 文件）并将其传输到客户端，而无需实际将其写入服务器文件系统。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T18:33:45.113

经过一番搜索和反复试验，我开发了以下内容。它似乎完全符合要求。它应该很容易适应 PHP 或任何其他服务器端软件，因为它主要涉及修改标头。

```
protected void streamToResponse()
{
    Response.Clear();
    Response.AddHeader("content-disposition", "attachment; filename=testfile.csv");
    Response.AddHeader("content-type", "text/csv");

    using(StreamWriter writer = new StreamWriter(Response.OutputStream))
    {
        writer.WriteLine("col1,col2,col3");
        writer.WriteLine("1,2,3");
    }
    Response.End();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:36:12.177

我还可以建议，如果你有文本以外的东西，比如二进制，你可以使用 Response.WriteBinary() 方法

我经常即时创建 JPG，使用 Bitmap.Save() 方法将其写入 MemoryStream，然后使用 .ToArray() 将 MemoryStream 转换为 byte[] 数组，然后使用 Response.WriteBinary() 该数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T18:36:01.333

使用 MemoryStream 类：

[http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)

# stored-procedures - EXECUTE IMMEDIATE 与 USING 子句给出错误

> ID：1008816
> 
> 赞同：0
> 
> 时间：2009-06-17T18:34:26.640
> 
> 标签：stored-procedures, oracle10g, dynamic-sql

全部，

一般来说，我对存储过程很陌生，但我特别在 Oracle 中苦苦挣扎。我已经创建了一个非常简单的示例来说明我要完成的工作，但这个简化版本仍然出现同样的错误。

示例存储过程如下：

```
CREATE OR REPLACE PROCEDURE ashish_test
AUTHID CURRENT_USER IS
BEGIN
     DECLARE
          v_tab     VARCHAR2(50);
          v_strSQL  VARCHAR2(50);
     BEGIN
          v_strSQL := 'SELECT * FROM :1';
          v_tab    := 'ex.emp';
          EXECUTE IMMEDIATE v_strSQL USING v_tab;
     END;
END; 
```

当我使用 调用上述存储过程`CALL ashish_test()`时，我得到：

[错误消息 http://web1.twitpic.com/img/12831839-06a3ea536df5d5a0a839eb83d9e59d25.4a3936b8-scaled.jpg](http://web1.twitpic.com/img/12831839-06a3ea536df5d5a0a839eb83d9e59d25.4a3936b8-scaled.jpg)

根据[这篇文章](http://www.mcs.csueastbay.edu/support/oracle/doc/10.2/appdev.102/b14261/dynamic.htm)（查看示例 7-1），`USING`关键字应将其中的编号占位符 ( `:1`)替换为`v_strSQL`存储在 中的值`v_tab`。但是，我不断收到无效表错误。我猜这是因为由于`EXECUTE IMMEDIATE`某种原因无法用值替换占位符，但我不确定为什么会这样。有谁知道我是否在这里做一些愚蠢的事情？

我在 Oracle 10g 数据库上运行它并使用 PL/SQL Developer。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:52:22.113

USING 子句仅适用于绑定变量（即您将在选择语句中使用列名的位置），而不适用于表名。典型用法如下所示：

```
Select col1 from table1 where col2 = :a 
```

如果要使用变量表名，请使用以下内容：

```
 v_tab    := 'ex.emp';
         v_strSQL := 'SELECT * FROM ' || v_tab;
         EXECUTE IMMEDIATE v_strSQL; 
```

# sql - 使用 Transact-SQL 查找特定子字符串

> ID：1008819
> 
> 赞同：0
> 
> 时间：2009-06-17T18:34:41.680
> 
> 标签：sql, sql-server

我需要从以下形式的字符串中提取特定的子字符串：

```
foo=abc;bar=def;baz=ghi 
```

例如，我如何从该字符串中获取“bar”的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:40:42.107

您可以使用[charindex](http://msdn.microsoft.com/en-us/library/ms186323.aspx)和[substring](http://msdn.microsoft.com/en-us/library/ms187748.aspx)。例如，要搜索“baz”的值：

```
declare @str varchar(128)
set @str = 'foo=abc;bar=def;baz=ghi'

-- Make sure @str starts and ends with a ;
set @str = ';' + @str + ';'

select substring(@str, 
    charindex(';baz=',@str) + len(';baz='),
    charindex('=',@str,charindex(';baz=',@str)) - charindex(';baz=',@str) - 1) 
```

或者对于字符串开头的“foo”的值：

```
select substring(@str, 
    charindex(';foo=',@str) + len(';foo='),
    charindex('=',@str,charindex(';foo=',@str)) - charindex(';foo=',@str) - 1) 
```

这是一个完成此任务的 UDF（受 BlackTigerX 的回答启发的更具可读性的版本）：

```
create function dbo.FindValueInString(
    @search varchar(256),
    @name varchar(30))
returns varchar(30)
as
begin
    declare @name_start int
    declare @name_length int
    declare @value_start int
    declare @value_end int

    set @search = ';' + @search

    set @name_start = charindex(';' + @name + '=',@search)
    if @name_start = 0
        return NULL

    set @name_length = len(';' + @name + '=')
    set @value_start = @name_start + @name_length
    set @value_end = charindex(';', @search, @value_start)

    return substring(@search, @value_start, @value_end - @value_start)
end 
```

如您所见，这在 Sql Server 中并不容易 :) 最好在客户端语言中执行此操作，或者规范化您的数据库，以便子字符串进入它们自己的列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T19:05:26.857

我有一个适用于这个问题的通用解决方案：

```
CREATE FUNCTION [dbo].[fn_StringBetween]
(
    @BaseString varchar(max),
    @StringDelim1 varchar(max),
    @StringDelim2 varchar(max)
)
RETURNS varchar(max)
AS
BEGIN
    DECLARE @at1 int
    DECLARE @at2 int
    DECLARE @rtrn varchar(max)

    SET @at1 = CHARINDEX(@StringDelim1, @BaseString)
    IF @at1 > 0
    BEGIN
        SET @rtrn = SUBSTRING(@BaseString, @at1
         + LEN(@StringDelim1), LEN(@BaseString) - @at1)
        SET @at2 = CHARINDEX(@StringDelim2, @rtrn)
        IF @at2 > 0
            SET @rtrn = LEFT(@rtrn, @at2 - 1)
    END

    RETURN @rtrn
END 
```

所以如果你运行（只需在开始和结束时用';'包装你的原始字符串）：

```
PRINT dbo.fn_StringBetween(';foo=abc;bar=def;baz=ghi;', ';bar=', ';') 
```

你会得到'def'返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:26:59.577

这是假设字符串将具有相同的字符串格式，只需将列名替换为 'foo=abc;bar=def;baz=ghi'

```
select substring('foo=abc;bar=def;baz=ghi',patindex('%bar=%','foo=abc;bar=def;baz=ghi')+4, len('foo=abc;bar=def;baz=ghi')-patindex('%;baz=%','foo=abc;bar=def;baz=ghi')-4) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T18:38:19.800

查看 PATINDEX 函数。它具有通配符匹配，应该可以帮助您..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T18:55:31.257

你可以使用这个功能

```
alter function FindValue(@txt varchar(200), @find varchar(200)) 
returns varchar(200)
as
begin
declare 
    @firstPos int,
    @lastPos int

select @firstPos = charindex(@find, @txt), @lastPos = charindex(';', @txt, @firstPos+5)

select @lastPos = len(@txt)+1 where @lastPos = 0

return substring(@txt, @firstPos+len(@find)+1, @lastPos-@firstPos-len(@find)-1)
end

select dbo.FindValue('foo=abc;bar=def;baz=ghi', 'bar') 
```

更新：没有使用@find 的长度

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-05-18T07:09:33.430

这可以通过简单的方式实现

```
DECLARE  @str VARCHAR(30)

DECLARE  @start INT

SET @str='foo=abc;bar=def;baz=ghi'

SET @start=CHARINDEX('bar',@str)

PRINT SUBSTRING(@str,@start,3) 
```

# html - 为什么 Firefox 会在我的 div 上放置一个水平滚动条？

> ID：1008823
> 
> 赞同：2
> 
> 时间：2009-06-17T18:35:16.780
> 
> 标签：html, css, linux, firefox

我有一个非常简单的测试用例：

```
<html>
  <body>
    <div style="border:2px solid black; overflow: auto;">
      x
    </div>
  </body>
</html> 
```

当我渲染它时，我得到一个水平滚动条！

我一直在为 Linux 使用 FF 3.0.3，并认为这可能是一个浏览器错误，所以我升级到 FF 3.5b4（最新的候选版本）。仍然发生。

这应该发生吗？我应该提交错误报告吗？有谁知道一种解决方法（编辑：允许我继续使用溢出：自动）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T18:37:07.120

这是你的溢出风格。更改为溢出隐藏以删除滚动条。

乔什

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T19:17:12.170

overflow:auto 不应该有滚动条，除非内容实际上超出了包含元素的边缘。这是 Firefox 的 Linux 版本中的一个错误。请参阅以下[错误报告](https://bugzilla.mozilla.org/show_bug.cgi?id=397367)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:39:00.987

我会提交一个错误报告。它不会在我的版本（对于 Windows）上呈现这种方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T18:44:52.693

可能是你`div`碰巧有`width:100%`，因此当你添加边框时会溢出？

# c# - 我应该使用什么数据类型来表示 C# 中的钱？

> ID：1008826
> 
> 赞同：56
> 
> 时间：2009-06-17T18:35:42.583
> 
> 标签：c#

在 C# 中，我应该使用什么数据类型来表示货币金额？十进制？漂浮？双倍的？我想考虑：精度，四舍五入等。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-06-17T18:36:29.430

使用[`System.Decimal`](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)：

> Decimal 值类型表示从正数 79,228,162,514,264,337,593,543,950,335 到负数 79,228,162,514,264,337,593,543,950,335 的十进制数。 ***Decimal 值类型适用于需要大量有效整数和小数位数且无舍入错误的财务计算。***Decimal 类型不会消除舍入的需要。相反，它最大限度地减少了由于四舍五入引起的错误。

[`System.Single`( `float`)](http://msdn.microsoft.com/en-us/library/system.single.aspx)和[`System.Double`( `double`)](http://msdn.microsoft.com/en-us/library/system.single.aspx)都不是~~足够精确~~能够表示高精度浮点数而不会出现舍入误差。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T18:39:07.070

如果您使用 SQL，请在数据库中使用小数和货币。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T18:37:53.577

[十进制](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)是你想要的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T18:54:42.410

在 C# 中，Decimal 类型实际上是一个结构，其中包含所有以 10 为底的数学和比较操作的重载函数，因此它的舍入误差较小。另一方面，浮点数（和双精度数）类似于二进制的科学记数法。因此，当您知道所需的精度时，十进制类型会更准确。

运行此程序以查看 2 的准确性差异：

```
using System;
using System.Collections.Generic;
using System.Text;

namespace FloatVsDecimal
{
    class Program
    {
        static void Main(string[] args) 
        {
            Decimal _decimal = 1.0m;
            float _float = 1.0f;
            for (int _i = 0; _i < 5; _i++)
            {
                Console.WriteLine("float: {0}, decimal: {1}", 
                                _float.ToString("e10"), 
                                _decimal.ToString("e10"));
                _decimal += 0.1m;
                _float += 0.1f;
            }
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-19T08:57:30.380

考虑[为 CLR 使用 Money 类型](http://moneytype.codeplex.com/)。它是一种自定义值类型（结构），还支持货币并处理四舍五入问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-26T08:19:13.280

在 C# 中，您应该使用“ **Decimal** ”来表示货币金额。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-17T04:37:53.277

对于快速而肮脏的事情，任何浮点原始类型都可以。

`float`和的问题`double`在于，它们都不能准确地表示 1/10，有时会导致惊人的万亿分之一美分。您可能听说过臭名昭著的 10¢ + 20¢。更实际地，尝试计算三件商品的 6% 销售税，每件税前价值为 39.99 美元。

此外，`float`并且`double`具有像负无穷大和 NaN 这样的值，它们对于代表金钱毫无用处。因此`decimal`，可以精确表示 1/10 似乎是最佳选择。

但是，`decimal`它不包含有关我们正在处理的货币的任何信息。例如，29.89 美元的金额是否等于 29.89 欧元？29.89 美元 > 29.89 欧元？如何确保这些金额以正确的货币符号显示？

如果这些细节对您的程序很重要，那么您应该使用第三方库或创建自己的`CurrencyAmount`类（或任何您想调用的类）。

但如果这类事情对程序无关紧要，你可以只使用浮点类型。或者甚至可能是整数（例如，我在 Java 中的二十一点实现要求玩家输入整数的赌注）。

# java - iBATOR classPathEntry，可以设置为相对于项目吗？

> ID：1008831
> 
> 赞同：1
> 
> 时间：2009-06-17T18:36:35.250
> 
> 标签：java, ibatis

遵循本教程时，我真正有疑问的一件事是 classPathEntry：[http ://blog.agdunn.net/?p=313](http://blog.agdunn.net/?p=313)

请注意，他的条目硬连接到 mysql-connector jar 的完整路径：

在这种情况下，有没有办法将项目根指定为变量？

例子：

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:43:57.857

我不确定我是否理解你的问题？！您想知道是否可以消除 mysql-connector 的绝对指定路径吗？

如果是这样，[ibator 文档](http://ibatis.apache.org/docs/tools/ibator/)会有所帮助。[从文档](http://ibatis.apache.org/docs/tools/ibator/configreference/classPathEntry.html)：

> `<classPathEntry>`元素_
> 
> 此元素是可选的，如果您在 Ibator 外部设置类路径（例如使用 java 命令的 -cp 参数），则不需要此元素。

这表明如果您将 mysql-connector 添加到类路径的其他位置（例如您的启动脚本），您可以不这样做。

# jquery - 需要 jquery 星级评分插件帮助

> ID：1008834
> 
> 赞同：0
> 
> 时间：2009-06-17T18:36:52.503
> 
> 标签：jquery, asp.net-mvc

我正在从 www.fyneworks.com/jquery/star-rating/ 添加星级插件，我发现文档相当晦涩。可能只是我找错了地方，这对我来说并不罕见。

我们在一个 asp.net MVC 应用程序上，我想在 3 个不同的页面中添加星级对象。在“创建评级”页面上，我想实现 5 星评级，但我想隐藏或消除“删除”图标。换句话说，当我给用户评分的机会时，我希望将其默认为 3 星，并且只允许他们投票 1 - 5。我不希望他们能够提交零评分. 单选按钮背后的概念将处理此问题，但“删除”选项会覆盖此选项。
这是我目前拥有的代码。

```
 <td>
            <strong>
                <label for="Rating">
                    Rating:</label></strong>
        </td>
        <td valign="top" width="180">
            <input name="rating" type="radio" class="star" value="1" />
            <input name="rating" type="radio" class="star" value="2" />
            <input name="rating" type="radio" class="star" value="3" checked="checked" />
            <input name="rating" type="radio" class="star" value="4" />
            <input name="rating" type="radio" class="star" value="5" />
        </td> 
```

这是我的第一篇文章，所以我希望这是在协议范围内，我还有关于同一个 jquery 的另一个问题，我不知道是否应该创建一个单独的问题或在此处添加它。现在我将在此处添加它，如果这是错误的，请告诉我，我将创建它作为一个单独的问题。

在应用程序的另一个页面上，我想显示每个实体的多个评论以及评级。我看不出这应该怎么做。我有一个 foreach 循环显示每条评论的星级，但我的循环将所有评级的所有星星放在评论列表的顶部。换句话说，如果特定实体有 6 个评级，则显示 30 颗星 (6 x 5)，后跟 6 条摘要行。我假设我必须以某种方式动态更改循环中输入名称的名称，以获取与其摘要行关联的不同对象。这是代码：

```
<table>
<% foreach (var review in Model.Reviews)
   { %>
       <tr>
        <% if (!Model.IsSingleBusiness)
           { %>
               <td> 
                   <%= Html.ActionLink(Html.Encode(review.Title), "Details", new { id = review.ReviewId, eId = Model.Entity.EntityId })%>   
               </td>
         <% } %>
           <td valign="top">
               <%= Html.ActionLink("Details", "Details", new { id = review.ReviewId, eId = Model.Entity.EntityId })%>
               <br />Rating: <%= Html.Encode(review.Rating)%>
                    <input name="rating" type="radio" class="star" disabled="disabled" />
                    <input name="rating" type="radio" class="star" disabled="disabled" />
                    <input name="rating" type="radio" class="star" disabled="disabled" />
                    <input name="rating" type="radio" class="star" disabled="disabled" />
                    <input name="rating" type="radio" class="star" disabled="disabled" />
               <br />By: <%= Html.Encode(review.Reviewer.FullName)%>
           </td>
           <td valign="top">
               <%= Html.ActionLink(Html.Encode(review.Title), "Details", new { id = review.ReviewId, eId = Model.Entity.EntityId })%>
           </td>
       </tr>
<% } %>

</table> 
```

在此先感谢您的帮助。

鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-17T13:27:47.597

您可以使用插件的设置参数来禁用取消按钮：

```
$.fn.rating.options = { required: true }; 
```

*要在页面上使用“star”类但没有*取消按钮的所有单选按钮上启用插件：

```
$(function(){
    $.fn.rating.options = { required: true };
    $('.star').rating({
        callback: function(value, link) {
            // To submit the form automatically:
            // this.form.submit();
            // To submit the form via ajax:
            $(this.form).ajaxSubmit();
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T19:33:29.780

查看插件的代码，在第一个对象中，您有函数 .each() 在其中您有用于创建取消按钮的代码，它被注释为“// Create 'cancel' button” - 注释代码如下。应该关闭取消按钮。要设置为默认 3 星，请通过在 firebug 中运行此代码并更改您需要的内容来查看此代码的行为方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-24T11:56:45.993

还有这个：

```
$(function(){
$('.star').rating({
    required: true,
    callback: function(value, link) {
        // To submit the form automatically:
        // this.form.submit();
        // To submit the form via ajax:
        $(this.form).ajaxSubmit();
    }
}); 
```

});

# excel - 有没有其他写范围的方法

> ID：1008838
> 
> 赞同：1
> 
> 时间：2009-06-17T18:37:30.130
> 
> 标签：excel, excel-2007, excel-formula, worksheet-function

嗨，例如，我必须在我的公式中写下这个

```
 Sheet1!A1:HM232 
```

有没有其他写法（例如只使用数字，没有任何字母）

```
 Sheet1!Cells[1,1]:Cells[232,221] 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T18:43:30.400

是的。在 Excel 参数中切换到 R1C1 表示法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T18:57:49.007

在 VBA 中，您可以像这样引用：

```
Set R = Sheets("Sheet1").Range(Cells(1, 1), Cells(232, 231)) 
```

在工作表中，您可以使用以下公式，它只要求您具有初始单元格引用（作为“A1”样式引用）：

```
=SUM(OFFSET(A1,0,0,232,221)) 
```

# asp.net - 为什么我的 ASP.NET 页面在没有发送任何身份验证标头的情况下返回“200 OK”？

> ID：1008839
> 
> 赞同：2
> 
> 时间：2009-06-17T18:37:41.457
> 
> 标签：asp.net, authentication, keep-alive, httpconnection

### 笔记：

> 与以前的修订版相比，这个问题的范围扩大了。我试图简化这个问题，以便任何人都可以轻松地复制它。

使用[Fiddler](http://www.fiddler2.com/fiddler2/)，我可以在从 HTTP 请求中删除我的标头后将任意请求重播到我的默认页面`Authorization`，并且我能够获得`200 OK`包含有效数据的响应。

### 赏金更新

以下是重现此确切行为的步骤：

**1.**在 ASP.NET 中创建一个“新网站”，随意命名为“InsecureWebsite”

**2.**编辑`web.config`以拒绝所有未经身份验证的用户：

```
<authentication mode="Windows" />
  <authorization>
    <deny users="?"/>
  <allow users="*"/>
</authorization> 
```

**3.**将网站发布到 DEV 服务器上的任意目录，并为应用程序创建一个虚拟目录

**4.**确保应用程序已启用脚本访问 (.ASP) 和集成 Windows 身份验证

**5.**打开[Fiddler](http://www.fiddler2.com/fiddler2/)抓取流量

**6.在您喜欢的浏览器中加载页面并查看**[Fiddler](http://www.fiddler2.com/fiddler2/)中的“Inspectors”选项卡，您将看到类似于以下内容的请求：

```
获取/不安全网站/ HTTP/1.1
主机：dev.subdomain.example.com
用户代理：Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1) Gecko/20090624 Firefox/3.5 (.NET CLR 3.5.30729)
接受：text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
接受语言：en-us,en;q=0.5
接受编码：gzip,deflate
接受字符集：ISO-8859-1,utf-8;q=0.7,*;q=0.7
保活：300
连接：保持活动
授权：NTLM
{Base64 编码的认证数据}

```

初始请求`Default.aspx`将返回 a `401 Unauthorized`，将进行协商，然后最终返回 a `200 OK`。

然后，在 Fiddler 中，我可以`Authorization`直接从重播的请求中删除标头，`Default.aspx`并且仍然获得`200 OK`. 这怎么可能？

## 解决方案

事实证明，Fiddler 在发出请求时使用相同的底层连接，因此一旦连接通过身份验证，同一连接上的任何请求也将被验证为与初始请求相同的用户。您可以在此处在 Fiddler 中关闭此功能：

[Fiddler 选项截图 http://john.cognitivedelay.com/images/fiddler-options.gif](http://john.cognitivedelay.com/images/fiddler-options.gif)

一旦取消选中，来自 Fiddler 的任何重放请求都将返回 a`401 Unauthorized`我所期望的。

感谢所有提供时间回复的人！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-15T06:16:47.313

编辑：每个更新的问题：

您是在 Fiddler 本身中进行回放，还是直接连接到网络服务器？可能是 Fiddler 正在重用现有的 HTTP 连接（它可以作为代理）......我认为 IWA 可能会将整个连接标记为已验证，而不仅仅是当前请求，这意味着未来的任何请求都在同一连接重用第一次协商的授权和身份验证...

原答案：试试

```
[WebMethod(EnableSession=true)]  
[PrincipalPermission(SecurityAction.Demand, Authenticated=true)] 
```

看看这是否有帮助？

（可能`[PrincipalPermission(SecurityAction.Demand, Role="myDevRole")]`如果这更适合你......）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-16T15:56:05.817

Ajax 调用是在现有已验证会话的新线程上完成的，这就是您在标头中看不到任何验证信息的原因。会话已通过身份验证。

您可以通过引用 System.Threading.Thread.CurrentPrincipal.Identity.Name 获取经过身份验证的用户的身份，然后将其传递给任何角色管理例程：

```
[WebMethod(EnableSession = true)]   
public static string WhoAmI()
{
    // Return the identity of the authenticated windows user.
    Return System.Threading.Thread.CurrentPrincipal.Identity.Name;
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-16T16:36:27.357

在本地开发机器上使用 Windows 身份验证，每个请求都将来自经过身份验证的用户。所以，拒绝用户=“？” 永远不会在本地拒绝任何请求。

如果您在远程 IIS 计算机上点击此操作，您未通过身份验证或将使用表单身份验证，则在您成功请求 Default.aspx 或页面方法之前需要进行身份验证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-13T15:04:43.517

将此属性添加到 web 方法 `[PrincipalPermissionAttribute( SecurityAction.Demand, Role = "myDevRole" )]`。

然后在 Global.asax 事件 Application_AuthenticateRequest 上，您可以确保当前线程用户已正确验证 - 即采取必要措施避免欺诈 cookie 或会话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T18:50:37.817

您可以潜在地将身份验证信息添加到消息的标题中，然后在 web 方法中对自己进行身份验证。

或者你可以试试[这样](http://rickgaribay.net/archive/2007/04/04/recipe-wcf-basichttpbinding-with-windows-authentication.aspx) 或[这样](http://forums.asp.net/t/1407216.aspx)

# java - 这两种说法有区别吗？

> ID：1008850
> 
> 赞同：3
> 
> 时间：2009-06-17T18:39:27.570
> 
> 标签：java, types, floating-point, primitive

1.  `float ff = 1.2f;`
2.  `Float fo = new Float(1.2f);`
3.  `double fg = 3.2d;`
4.  `Double fh = new Double(2.1d);`

我可以在 (1) 和 (3) 之间或 (2) 和 (4) 之间使用 '=' 吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-17T18:41:07.533

是的。

1.  制作一个称为“float”的普通旧数据类型（AKA 原始类型）。
2.  创建一个名为 Float 的 Java 对象，该对象包含恰好与 (1) 相同的值

回答编辑问题：

你会看见

1.  如果您尝试，“可能会丢失精度”消息`ff = fg`。
2.  如果您尝试“不兼容的类型” `fo = fh`。
3.  `fg = ff`可以正常工作（浮动适合双倍）。
4.  `fh = fo`仍然会给你一个“不兼容的类型”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T18:40:29.547

是的，2 创建了一个对象。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-17T18:41:26.240

是的，第一个是原始类型，第二个是包装原始浮点类型功能的装箱类，例如，我们需要第二个用于集合。在您不得不处理大量类型转换之前（我认为直到 Java 1.5），现在包装类的存在具有这些功能。更多信息。[这里](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T18:40:59.827

是的。第一个声明原始类型的变量`float`并将其初始化为 1.2。

而第二个声明一个引用类型的变量`Float`，创建一个类型的对象，`Float`然后为该变量分配一个引用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T18:58:01.297

new Float(1.2f)每次都会创建一个*新的 Float 对象，消耗内存。*

如果您使用工厂方法[Float.valueOf(1.2f)](http://java.sun.com/javase/6/docs/api/java/lang/Long.html#valueOf(long))，JVM 可能会为相同的值重用现有的 Float 对象实例。只有当还没有具有相同值的 Float 实例时，它才能创建一个新的对象实例。

通常你会想要使用 Float.valueOf(1.2f) 而不是 new Float(1.2f)。

另请注意，原语和对象使用等于运算符**==**的工作方式不同。

```
float x1 = 1.2f;
float x2 = 1.2f;

x1 == x2  // true

Float f1 = new Float(1.2f);
Float f2 = new Float(1.2f);

f1 == f2 // false 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T18:41:49.687

是的，原始类型不能为 NULL，对象可以。Float 对象还附加了一堆有用的实用功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-11T17:20:43.050

1.  有了这个声明，您就有了一个原始类型 float 并为其分配了一个值。原始类型是不由其他数据类型组成的数据类型，不能进一步拆分（简单解释一下）。原始类型通常是内置类型。

2.  在这种情况下，您创建了一个对象，它在内部由较小的数据类型组成，还包含方法。

原始类型浮点数和对象类型之间的主要区别在于原始数据只是一种数据格式，没有属性或方法。

3=1 可以正常工作，休息不行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T20:22:41.057

在实际应用中，我建议你不要使用 float 或 Float，它不是很准确，而且几乎不是正确的解决方案，而是使用 double 或 Double。

# asp.net - 电子邮件申请问题

> ID：1008856
> 
> 赞同：0
> 
> 时间：2009-06-17T18:40:04.480
> 
> 标签：asp.net

我创建了一些网络表单，允许用户填写他们的数据。之后，信息被处理并插入到数据库中，随后会向我发送一封后续电子邮件，让我知道谁注册了。

问题是我在所有这些网络表单上使用不同的电子邮件地址。

我想要的是某种仪表板电子邮件应用程序，我可以在其中查看从一个中心点发送给我的所有电子邮件。

我认为 Thunderbird 允许您接收来自不同帐户的多封电子邮件。这样的事情甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T18:42:09.123

您可以配置几乎任何电子邮件应用程序以接收来自多个帐户的邮件。Thunderbird 和 Outlook（不是 Outlook Express）一样。只需完成添加帐户的正常过程，然后继续在不同的电子邮件地址下添加另一个帐户。

这里有一个链接，介绍如何在[Thunderbird](http://www.askdavetaylor.com/how_do_i_create_multiple_accounts_in_mozilla_thunderbird.html)上执行此操作。

# python - Popen.communicate() 抛出 OSError: "[Errno 10] No child processes"

> ID：1008858
> 
> 赞同：10
> 
> 时间：2009-06-17T18:40:15.103
> 
> 标签：python, linux

我正在尝试启动一个子进程并使用 subprocess 模块从 Python 在 Linux 上获取其输出：

```
#!/usr/bin/python2.4
import subprocess

p = subprocess.Popen(['ls', '-l', '/etc'],
                   stdout=subprocess.PIPE,
                   stderr=subprocess.PIPE)
out, err = p.communicate() 
```

但是，我遇到了一些问题：有时， p.communicate() 会抛出

```
OSError: [Errno 10] No child processes 
```

什么会导致此异常？这里是否有任何可能导致片状的不确定性或竞争条件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-10-01T09:16:34.890

你在脚本中拦截 SIGCHLD 吗？如果你是，那么 Popen 将不会按预期运行，因为它依赖于它自己的信号处理程序。

您可以通过注释掉 Popen 调用然后运行来检查 SIGCHLD 处理程序：

```
strace python <your_script.py> | grep SIGCHLD 
```

如果您看到类似以下内容：

```
rt_sigaction(SIGCHLD, ...) 
```

那么，你就有麻烦了。您需要在调用 Popen 之前禁用处理程序，然后在通信完成后重置它（这可能会引入竞争条件，所以要小心）。

```
signal.signal(SIGCHLD, handler)
...
signal.signal(SIGCHLD, signal.SIG_DFL)
'''
now you can go wild with Popen. 
WARNING!!! during this time no signals will be delivered to handler
'''
...
signal.signal(SIGCHLD, handler) 
```

有一个关于此的python错误报告，据我所知尚未解决：

[http://bugs.python.org/issue9127](http://bugs.python.org/issue9127)

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T20:32:03.470

您可能会遇到这里提到的错误：http: [//bugs.python.org/issue1731717](http://bugs.python.org/issue1731717)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-23T19:35:22.963

我使用我的主目录中内置的 Python 2.6.4 遇到了这个问题（因为我不想升级机器上的“内置”Python）。

我通过替换`subprocess.Popen()`为 (the deprecated)来解决它`os.popen3()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-29T05:18:29.447

我无法在我的 Python (2.4.6-1ubuntu3) 上重现这一点。你是如何运行你的脚本的？这种情况多久发生一次？

# c# - 禁用或隐藏保存/打印预览对话框弹出窗口

> ID：1008862
> 
> 赞同：0
> 
> 时间：2009-06-17T18:40:43.790
> 
> 标签：c#, .net, winforms, winforms-interop

我正在使用放置在 winform 上的 ActiveX 控件。当用户尝试保存或打印时，它总是会首先显示一个对话框；我想要么立即关闭对话框，要么一开始就不显示它。

有问题的控件不会引发任何事件，让我知道他们按下了什么按钮，所以我无法通过寻找“on_print”通知来取消它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-02T04:44:21.480

每当处理 WM_ENTERIDLE 并完成工作时，我最终只是通过 SendKey() 发送转义。肮脏的黑客，但它的工作。

# language-agnostic - 有没有一种聪明的方法可以将纯文本列表解析为 HTML？

> ID：1008863
> 
> 赞同：0
> 
> 时间：2009-06-17T18:40:50.030
> 
> 标签：language-agnostic, list, text-parsing

## 问题：有没有一种*聪明的方法*可以将纯文本列表解析为 HTML？

或者，我们必须求助于深奥的递归方法，还是纯粹的蛮力？

我一直在想这个有一段时间了。在我自己的沉思中，我一次又一次地回到蛮力和奇怪的递归方法……但它似乎总是*那么*笨拙。应该有更好的方法吧？

那么聪明的方法是什么？

### 假设

有必要设置一个场景，所以这些是我的假设。

1.  列表可以嵌套 3 层深（至少），无序或有序列表。列表类型和深度由其前缀控制：

    1.  前缀后面有一个必填空格。
    2.  列表深度由前缀中有多少非空格字符控制；`*****`将嵌套五个列表深。
    3.  列表类型由字符类型强制执行，`*`或者`-`为无序列表，`#`为无序列表。
2.  项目仅由 1 个`\n`字符分隔。（让我们假设两个连续的换行符符合一个“组”、一个段落、div 或其他一些 HTML 标记，如 Markdown 或 Textile。）

3.  列表类型可以自由混合。

4.  输出应为有效的 HTML 4，最好以`</li>`s结尾

5.  可以根据需要使用或不使用 Regex 进行解析。

### 示例标记

```
* List
*# List
** List
**# List
** List

# List
#* List
## List
##* List
## List 
```

### 期望的输出

为便于阅读而进行了一些分解，但它应该是一个有效的变体（请记住，我只是很好地间隔了它！）：

```
<ul>
  <li>List</li>
  <li>
    <ol><li>list</li></ol>
    <ul><li>List</li></ul>
  </li>
  <li>List</li>
  <li>
    <ol><li>List</li></ol>
  </li>
  <li>List</li>
</ul>

<ol>
  <li>List</li>
  <li>
    <ul><li>list</li></ul>
    <ol><li>List</li></ol>
  </li>
  <li>List</li>
  <li>
    <ul><li>List</li></ul>
  </li>
  <li>List</li>
</ol> 
```

## 总之

你*是怎么*做到的？我真的很想了解处理不可预测的递归列表的好方法，因为它让我觉得任何人都可以纠缠不清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:37:35.227

我见过的最好的解释来自 Mark Jason Dominus 的 Higher-Order Perl。全文可在[http://hop.perl.plover.com/book/](http://hop.perl.plover.com/book/)在线获取。

尽管这些示例都在 Perl 中，但每个区域背后的逻辑分解都很棒。

[第 8 章](http://hop.perl.plover.com/book/pdf/08Parsing.pdf)（！PDF 链接）专门介绍解析。尽管本书中的课程有些相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T19:54:00.317

带有一些pythonic概念的逐行解决方案：

```
cur = ''
for line in lines():
    prev = cur
    cur, text = split_line_into_marker_and_remainder(line)
    if cur && (cur == prev) :
         print '</li><li>'
    else :
         nprev, ncur = kill_common_beginning(prev, cur)
         for c in nprev: print '</li>' + ((c == '#') ? '</ol>' : '</ul>') 
         for c in ncur:  print           ((c == '#') ? '<ol>'  : '<ul>' )  + '<li>'
    print text 
```

它是这样工作的：为了处理该行，我将前一行的标记与该行的标记进行比较。

我使用了一个虚构的函数 `split_line_into_marker_and_remainder`，它返回两个结果，标记`cur`和文本本身。将其实现为具有 3 个参数、一个输入和 2 个输出字符串的 C++ 函数很简单。

核心是一个虚构的函数，它会去掉和`kill_common_beginning`的重复部分 。之后，我需要关闭保留在前一个标记中的所有内容并打开保留在当前标记中的所有内容。我可以通过替换、将字符映射到字符串或循环来做到这一点。`prev``cur`

这三行在 C++ 中将非常简单：

```
char * saved = prev;
for (; *prev && (*prev == *cur);  prev++, cur++ ); // "kill_common_beginning"
while (*prev) *(prev++) == '#' ? ...
while (*cur)  *(cur++) == '#' ? ...
cur = saved; 
```

但是请注意，有一种特殊情况：当缩进没有改变时，这些行不会输出任何内容。如果我们在列表之外，那很好，但在列表中就不行了：所以在这种情况下，我们应该`</li><li>`手动输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T18:58:24.980

### 基本迭代技术：

1.  一个正则表达式或其他一些简单的解析器，可以识别列表的格式，捕获每个列表项（包括那些具有额外缩进级别的项）。
2.  跟踪当前缩进级别的计数器。
3.  迭代每个捕获的逻辑，写出`<li>`s 并插入适当的开始/结束标签 ( `<ol></ol>`, `<ul></ul>`) 并在当前缩进级别大于或小于前一个缩进级别时递增/递减缩进计数器。

* * *

**编辑：**这是一个简单的表达式，可能会对您进行一些调整：每个匹配项都是一个顶级列表，有两组命名捕获，标记（字符计数是缩进级别，最后一个字符表示所需的列表类型) 和列表项文本。

```
(?:(?:^|\n)[\t ]*(?<marker>[*#]+)[\t ]*(?<text>[^\n\r]+)\r*(?=\n|$))+ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T13:54:42.980

这是我自己的解决方案，它似乎是 Shog9 的建议（他的正则表达式的变体，Ruby 不支持命名匹配）和 Ilya 的迭代方法的混合体。我的工作语言是 Ruby。

一些值得注意的事情：我使用了一个基于堆栈的系统，“String#scan(pattern)”实际上只是一个“匹配所有”方法，它返回一个匹配数组。

```
def list(text)
  # returns [['*','text'],...]
  parts = text.scan(/(?:(?:^|\n)([#*]+)[\t ]*(.+)(?=\n|$))/)

  # returns ul/ol based on the byte passed in
  list_type = lambda { |c| (c == '*' ? 'ul' : 'ol') }

  prev = []
  tags = [list_type.call(parts[0][0][0].chr)]
  result = parts.inject("<#{tags.last}><li>") do |output,newline|
    unless prev.count == 0
      # the following comparison says whether added or removed,
      # this is the "how much"
      diff = (prev[0].length - newline[0].length).abs
      case prev[0].length <=> newline[0].length
        when -1: # new tags to add
          part = ((diff > 1) ? newline[0].slice(-1 - diff,-1) : newline[0][-1].chr)
          part.each_char do |c|
            tags << list_type.call(c)
            output << "<#{tags.last}><li>"
          end
        when 0: # no new tags... but possibly changed
          if newline[0] == prev[0]
            output << '</li><li>'
          else
            STDERR.puts "Bad input string: #{newline.join(' ')}"
          end
        when 1: # tags removed
          diff.times{ output << "</li></#{tags.pop}>" }
          output << '</li><li>'
      end
    end

    prev = newline
    output + newline[1]
  end

  tags.reverse.each { |t| result << "</li></#{t}>" }
  result
end 
```

值得庆幸的是，这段代码确实可以工作并生成有效的 HTML。结果确实比我预期的要好。它甚至不觉得笨拙。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T18:44:33.287

看看[纺织](http://en.wikipedia.org/wiki/Textile_(markup_language))。

它有多种语言版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T18:46:01.503

这就是你如何使用正则表达式*和*循环来做到这一点（`^`代表换行符，代表结束行`$`）：

```
do { 
    ^#anything$ -> <ol><li>$^anything</li></ol>$
    ^*anything$ -> <ul><li>$^anything</li></ul>$
} while any of those above applies

do {
    </ol><ol> -> 
    </ul><ul> -> 
    </li><li> -> 
} while any of those above applies 
```

这使得它比简单的正则表达式简单得多。它的工作方式：你首先扩展每一行，就好像它是孤立的一样，然后吃掉额外的列表标记。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-19T22:59:43.777

试试[明胶](http://wiki.github.com/knipknap/Gelatin/)。语法定义可能是 5 行或更少。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T05:43:11.597

# 这个 Perl 程序是这方面的第一次尝试。

```
#! /usr/bin/env perl
use strict;
use warnings;
use 5.010;

my $data = [];
while( my $line = <> ){
  last if $line =~ /^[.]{3,3}$/;
  my($nest,$rest) = $line =~ /^([\#*]*)\s+(.*)$/x;
  my @nest = split '', $nest;

  if( @nest ){
    recourse($data,$rest,@nest);
  }else{
    push @$data, $line;
  }
}

de_recourse($data);

sub de_recourse{
  my($ref) = @_;
  my %de_map = (
    '*' => 'ul',
    '#' => 'ol'
  );

  if( ref $ref ){
    my($type,@elem) = @$ref;
    if( ref $type ){
      for my $elem (@$ref){
        de_recourse($elem);
      }
    }else{
      $type = $de_map{$type};

      say "<$type>";
      for my $elem (@elem){
        say "<li>";
        de_recourse($elem);
        say "</li>"
      }
      say "</$type>";
    }
  }else{
    print $ref;
  }
}

sub recourse{
  my($last_ref,$str,@nest) = @_;
  die unless @_ >= 2;
  die unless ref $last_ref;
  my $nest = shift @nest;

  if( @_ == 2 ){
    push @$last_ref, $str;
    return;
  }

  my $previous = $last_ref->[-1];
  if( ref $previous ){
    if( $previous->[0] eq $nest ){
      recourse( $previous,$str,@nest );
      return;
    }
  }

  my $new_ref = [ $nest ];
  push @$last_ref, $new_ref;
  recourse( $new_ref, $str, @nest );
} 
```

*希望能帮助到你*

# .net - 创建一个简单的 POP3 *SERVER*

> ID：1008865
> 
> 赞同：3
> 
> 时间：2009-06-17T18:41:02.887
> 
> 标签：.net, sockets, pop3

有大量关于在 .net 中制作 POP3 客户端的 Google 示例，但我想制作一个简单的自定义 POP3 服务/服务器来从自定义数据库中检索用户的电子邮件。是否有任何组件或示例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T18:51:58.483

这是一个[开源 .NET POP3 服务器](http://www.lumisoft.ee/lsWWW/ENG/Products/Mail_Server/mail_index_eng.aspx?type=info)。既然你提到你是套接字编程的新手，这里也有一个[教程](http://www.developerfusion.com/article/3918/socket-programming-in-c-part-1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T18:44:20.807

我很久以前创建了[这个模拟 smtp 服务器。](http://code.msdn.microsoft.com/fakesmtpservice)您可以使用该代码开始并对其进行一些“真正的逻辑”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T18:45:35.373

[这里](http://www.devarticles.com/c/a/Delphi-Kylix/Creating-a-POP3-Server/)有一个 Delphi 示例，可以帮助您入门。抽出 POP3 规范的基本部分并写入这些部分应该不会太难 -[此处](http://www.kewl.lu/articles/pop3)为 Telnet 命令的相关信息。

同样，[此处的 RFC](http://www.freesoft.org/CIE/RFC/1725/index.htm)更详细地描述了该协议。

# ado.net - MARS 与 NextResult

> ID：1008867
> 
> 赞同：1
> 
> 时间：2009-06-17T18:41:10.810
> 
> 标签：ado.net, sql-server-mars

我通过从多个表中收集数据来补充我的业务对象，例如，

```
从 CaDataTable 中选择 *；
从 NyDataTable 中选择 *；
从 WaDataTable 中选择 *；

```

等等...（C# 3.5，SQL Server 2005）

我一直在使用批次：

```
 void BatchReader()
    {
        string sql = "Select * From CaDataTable" +
                     "Select * From NyDataTable" +
                     "Select * From WaDataTable";

        string connectionString = GetConnectionString();
        using (SqlConnection conn = new SqlConnection(connectionString)) {
            conn.Open();
            SqlCommand cmd = new SqlCommand(sql, conn);
            using (SqlDataReader reader = cmd.ExecuteReader()) {
                do {
                    while (reader.Read()) {
                        ReadRecords(reader);
                    }
                } while (reader.NextResult());
            }
        }
    } 
```

我还对同一个连接使用了多个命令：

```
 void MultipleCommandReader()
    {
        string connectionString = GetConnectionString();
        string sql;
        SqlCommand cmd;
        using (SqlConnection conn = new SqlConnection(connectionString)) {
            conn.Open();  

            sql = "Select * From CaDataTable";
            cmd = new SqlCommand(sql, conn);
            using (SqlDataReader reader = cmd.ExecuteReader()) {
                while (reader.Read()) {
                    ReadRecords(reader);
                }
            }

            sql = "Select * From NyDataTable";
            cmd = new SqlCommand(sql, conn);
            using (SqlDataReader reader = cmd.ExecuteReader()) {
                while (reader.Read()) {
                    ReadRecords(reader);
                }
            }

            sql = "Select * From WaDataTable";
            cmd = new SqlCommand(sql, conn);
            using (SqlDataReader reader = cmd.ExecuteReader()) {
                while (reader.Read()) {
                    ReadRecords(reader);
                }
            }
        }
    } 
```

这些技术中的一种是否明显优于另一种？另外，如果我在第二种方法中使用 MARS 会有收益吗？换句话说，是不是像在连接字符串中设置 MultipleActiveResultSets=True 一样简单，并收获很大的好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T18:48:39.190

如果每个表中的数据结构都相同，我会这样做：

```
Select *, 'Ca' Source From CaDataTable
union all
Select *, 'Ny' Source From NyDataTable
union all
Select *, 'Wa' Source From WaDataTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:07:13.883

如果没有实际安排这两个版本的时间，您只能推测....

我希望版本 1 (BatchReader) 会更快，因为您只需要一次往返数据库。版本 2 需要三个不同的往返行程 - 每个执行一次查询。

但再说一遍：你只能*真正*判断你是否测量。

马克

哦，PS：当然，在现实生活中，它也有助于限制返回的列，例如，不要使用`SELECT *`而是使用`SELECT (list of fields)`并保持该字段列表尽可能短。

# c# - 如何创建一个比其父进程寿命更长的进程

> ID：1008886
> 
> 赞同：13
> 
> 时间：2009-06-17T18:45:41.333
> 
> 标签：c#, windows, process

我正在尝试为我开发的平台启动一个外部更新程序应用程序。我想启动此更新程序的原因是因为我的配置实用程序处理平台的更新和许可证配置，它与将部署更新的文件夹中的其他程序集共享依赖关系。因此，虽然我可以重命名配置实用程序并在部署更新时覆盖它，但我无法重命名或覆盖它所依赖的 DLL。因此，外部更新程序应用程序。

我正在处理配置实用程序中的所有更新收集逻辑，然后尝试启动更新程序来处理实际的文件复制/覆盖操作。显然，由于正在使用的文件问题，我需要在更新程序启动后立即退出配置实用程序。

我遇到的问题是我正在使用标准 Process.Start 启动更新程序的方法，一旦配置实用程序退出，更新程序进程也会被终止。

有什么方法可以创建一个比其父进程寿命更长的进程，或者启动一个可以在启动它的程序之外运行的外部应用程序？

编辑：

显然，在我的更新程序应用程序中，我错误地计算了传递给它的命令行参数的数量。因此，更新程序将立即退出。我将此误解为启动器应用程序正在杀死“子”进程，而实际上并非如此。

下面的答案是正确的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-17T18:52:08.313

您看到的问题似乎有不同的原因，因为当您的应用程序退出时，`Process`该类不会终止任何开始使用的进程。`Process.Start`

查看这个简单的示例程序，计算器将保持打开状态：

```
using System.Diagnostics;

class Program
{
    static void Main(string[] args)
    {
        Process.Start(@"C:\windows\system32\calc.exe");
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T18:50:32.480

启动程序退出时，启动的进程没有理由`Process.Start`自动终止。我的猜测是你在更新程序中做了一些奇怪的事情。

我以前写过一个更新程序来做这种事情，而且很好。

例如：

启动器.cs：

```
using System;
using System.Diagnostics;

class Launcher
{
    static void Main()
    {
        Console.WriteLine("Launching launchee");
        Process.Start("Launchee.exe");
        Console.WriteLine("Launched. Exiting");
    }
} 
```

Launchee.cs：

```
using System;
using System.Threading;

class Launchee
{
    static void Main()
    {
        Console.WriteLine("       I've been launched!");
        Thread.Sleep(5000);
        Console.WriteLine("       Exiting...");
    }
} 
```

分别编译它们，然后运行 ​​Launcher.exe。“启动”过程肯定比启动器持续时间更长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T18:59:07.677

只是我模糊的记忆中的一个想法，但我似乎记得前一阵子讨论过，当从 Form 调用 Process.Start 方法时，生成的进程具有某种依赖性（不确定是什么、为什么或如何，记忆是有点雾）。

为了处理它，设置了一个标志，在主窗体/应用程序退出后实际从应用程序的 Main() 方法调用，如果从 Main() 方法启动进程，一切都很好。

只是一个想法，就像我说的，这纯粹是凭记忆，但这里发布的一些示例都是从控制台应用程序的 Main() 方法调用的，似乎有点慢。

希望一切都适合你。

# c - 有没有比在 C 中使用 #ifdef 更简单的方法？

> ID：1008888
> 
> 赞同：1
> 
> 时间：2009-06-17T18:46:37.090
> 
> 标签：c, debugging, assertions

据我了解，assert 是 C 语言中的一个宏，如果您在编译时使用它但将其禁用，则不会有开销（我不知道这可能不正确）。对我来说，问题是我想做的是将所有变量传递给我的函数并打印出该输出，但前提是我希望启用调试。这是我到目前为止所拥有的：

```
int exampleFunction (int a, int b)
{
  #ifdef debugmode
  printf("a = %i, b = %i", a, b);
  #endif 
} 
```

我想知道是否有任何更简单（且不那么丑陋）的方法来做这样的事情。xdebug for php 有这个功能，我发现它在调试时为我节省了大量时间，所以我想为每个函数都这样做。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-17T18:50:17.177

试试这个：

```
#ifdef debugmode
#define DEBUG(cmd) cmd
#else
#define DEBUG(cmd)
#endif

DEBUG(printf("a = %i, b = %i", a, b)); 
```

现在，如果你已经`debugmode`定义，你会得到你的打印语句。否则，它永远不会出现在二进制文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T19:01:59.123

使用 GCC，我真的很喜欢添加每个文件：

```
#if 0
#define TRACE(pattern,args...)   fprintf(stderr,"%s:%s/%u" pattern "\n",__FILE__,__FUNCTION__,__LINE__,##args)
#else
#define TRACE(dummy,args...)
#endif 
```

然后在代码中：

```
i++;
TRACE("i=%d",i); 
```

`i`只有当我激活文件顶部的 TRACE() 宏时才会打印。效果非常好，而且它会打印它发生的源文件、行和函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:55:55.640

```
if (MY_DEBUG_DEFINE) {
        do_debug_stuff();
} 
```

任何半体面的编译器都会优化该块。请注意，您需要定义`MY_DEBUG_DEFINE`为布尔值（即 0 或非 0）。

```
#define MY_DEBUG_DEFINE defined(NDEBUG) 
```

如果您碰巧以最大警告级别进行编译，则此技巧可避免*未引用的参数*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T19:17:42.043

使用不支持它的预处理器获取可变参数的解决方法

```
#define DEBUG

#ifdef DEBUG
#define trace(args) printf args
#else
#define trace(args)
#endif

int dostuff(int value)
{

    trace(("%d", value));

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T18:51:31.607

您可以将 PRINTF_IF_DEBUGGING 定义为

```
#ifndef NDEBUG
#define PRINTF_IF_DEBUGGING(X) printf(X)
#else
#define PRINTF_IF_DEBUGGING(X)
#endif 
```

这会将#ifdefs 集中在一个地方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T19:04:23.940

好吧，这里给出的 PRINT_DEBUG 类型宏的问题在于它们只允许一个参数。对于正确的 printf()，我们需要几个，但 C 宏（目前）不允许可变参数。

因此，要实现这一目标，我们必须发挥创造力。

```
#ifdef debugmode
     #define PRINTF   printf
#else
     #define PRINTF    1 ? NULL : printf
#endif 
```

然后，当您在非调试模式下编写时`PRINTF("a = %i, b = %i", a, b);`，它将（有效地）呈现为：

```
 if (true) NULL;
 else printf("a = %i, b = %i", a, b); 
```

编译器很高兴，但 printf 永远不会执行，如果编译器很亮（即任何现代 C 编译器），将永远不会生成 printf() 的代码，因为编译器将认识到永远无法采用路径.

但是请注意，参数仍将被评估，因此如果它们有任何副作用（即 ++x 或函数调用），它们的代码可能会生成（但不会执行）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-17T15:45:50.283

我还会打印一些其他 C 预处理器标志，它们可以帮助您跟踪问题

```
printf("%s:%d {a=%i, b=%i}\n", __FILE__, __LINE__, a, b); 
```

# database - EMR（电子病历）标准记录格式？

> ID：1008897
> 
> 赞同：10
> 
> 时间：2009-06-17T18:48:43.980
> 
> 标签：database, medical, openehr

一些同事和我正在启动一个 EMR 项目（电子病历）。我过去听到过关于标准记录格式的讨论（最近更多），以方便在适当时将记录（HIPAA）从一个设施转移到另一个设施。有人看过这方面的信息吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-17T19:07:31.907

您可以查看 HL7 以了解系统之间的互操作性 ( [http://www.hl7.org/](http://www.hl7.org/) )。可以传递患者人口统计信息和文本注释。我离开 EMR 领域太久了，不知道最近是否有任何标准组织做了任何有趣的事情。保持语义的标准格式是一个非常非常困难的问题。请参阅 SnoMed ( [http://www.nlm.nih.gov/research/umls/Snomed/snomed_main.html](http://www.nlm.nih.gov/research/umls/Snomed/snomed_main.html) ) 了解一项长期运行的本体论工作——这仅仅是丰富交换格式的开始。

一个与新兴 EMR 供应商共事数年的人的警告……这是一项非常艰难的业务。大型医疗系统的销售周期实际上可能需要数年时间，而小型医疗系统所需的手动操作量做法会迅速侵蚀利润。与现有实践管理系统的集成是非标准的，即使这些供应商另有声明也是如此。越来越多的问题比比皆是。我不确定这是一个没有资金的初创企业进入的明智空间。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T00:56:13.343

我认为将 HL7 视为您似乎的意思的标准是错误的。它是高度定制的，并且从一个客户到另一个客户可能会有很大的不同。这是具有太大灵活性的标准之一。

我建议您阅读该标准（这需要您花费一些时间），然后尝试找到一个使用该标准的开发人员社区。向他们询问恐怖故事，并为您将听到的内容做好准备。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-15T13:30:57.377

晚了一个月，但是...

拍摄的标准绝对是HL7。它用于许多领域，因此具有高度可定制性，但有一个明确定义的医疗保健标准。无论您选择何种系统，每条消息（ACK、DSR MCF）、段（PID、PV1、OBR、MSH 等）、序列和事件类型（A08、A12、A36）都有特定的含义。

我们在连接 MiSYS、Statlan、Oacis、Epic、MUSE、GE Centricity/Lastword 和其他在我们使用的系统之间发送 DICOM、ADT、PACS 信息时没有遇到问题。这些系统中的大多数都将设置一个接口引擎，以便在需要时调整消息，因此必须添加一种方法来过滤 HL7 消息，因为它们通过您的系统，并且当它们到达下游时。

即使会有一个新的互操作性“总统标准”，而且我会冒险猜测它无论如何都会是 HL7，我会使用 HL7 消息传递来构建系统，因为这是目前行业接受的标准。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-21T06:00:27.743

在解决互操作性的同时，您不应该只关心交换格式，本地存储格式也应该标准化，以简化到交换格式的转换，反之亦然。

openEHR 是一种很好的存储格式，它比 HL7 v2、v3 和 CDA 更具表现力，因此可以轻松转换为任何一种格式。规范是开放的，在这里： http: [//openehr.org/programs/specification/releases/1.0.2](http://openehr.org/programs/specification/releases/1.0.2)

对于交换格式，HL7 v2、v3 和 CDA 中的任何一个都很好。还要考虑 CCR 和 CCD。 [http://www.aafp.org/practice-management/health-it/astm.html](http://www.aafp.org/practice-management/health-it/astm.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-14T08:06:25.473

如果您想跳出 HL7 思维并寻找具有指定记录格式而不是记录提取消息交换格式的综合 EMR 或 EHR，请查看 openEHR，[http://www.openehr.org/](http://www.openehr.org/)。ISO 13606 提取标准（几乎）是 openEHR 的一个子集。您还将在 Java、.NET、Ruby、Python、Groovy 等中找到不同成熟度的开源参考库和 openEHR 实现。

一些组织还生产 HL7 工件，例如 CDA，作为基于 openEHR 的 EHR/EMR 系统的输出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T19:14:02.597

看看 Continuity of Care Record--IIRC，这就是 Google Health 用于输入的内容。它不是 HL7 系列标准（有一个与之竞争的 HL7 系列标准——不记得它叫什么）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-23T21:43:57.467

在政府规定格式并要求依法使用之前，可能不会有标准的病历格式。

如果没有社会化的国家医疗保健，这几乎肯定不会发生。所以实际上是零机会。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-12T15:49:52.643

它的正确答案，但我认为一些关于 emr 的有意义使用的补充......官员宣布“有意义的使用”，EHR 认证标准上周，CMS 发布了定义电子健康记录“有意义使用”的拟议法规，路透社报道（Wutkowski /Heavey，路透社，2009 年 12 月 31 日）。

此外，国家健康 IT 协调员办公室发布了一项临时最终规则，描述了 EHR 技术所需的认证标准（Simmons，HealthLeaders Media，2009 年 12 月 31 日）。

根据 2009 年联邦经济刺激计划，证明有效使用认证 EHR 的医疗保健提供者将有资格通过 Medicaid 和 Medicare 获得奖励金。

在这两项法规于 1 月 13 日在联邦公报上公布后，官员们将提供 60 天的公众评议期。关于 EHR 认证的临时最终规则计划在公布后 30 天生效（Goedert，健康数据管理，12/30 /09)。[http://www.myemrstimulus.com/](http://www.myemrstimulus.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T01:17:26.890

这是一个非常困难的问题，因为数据收集从 MD 开始，他们知道的唯一编码（ICD 和 CPT）都是关于计费的，而不是任何可能在提供商之间使用的东西（尤其是可以持有 MD 的形式）承担法律责任）。他们甚至讨厌那么多文书工作。

除此之外，HIPAA 规定患者而非提供者拥有数据这一事实。并不是说如果他们拥有它，他们就可以理解它或用它做任何有用的事情。

祝你好运。无论发生什么，都将是政府胁迫的结果，恕我直言，这将是一个漫长的过程。

有趣的是，可靠医疗信息的一个来源原来是 VA（因为他们没有付款和法律责任的对抗性问题。）去看看。不过，对于任何现有数据和一些动力的标准来说，这可能是一个很好的起点。[这是另一个带有一些信息的问题。](https://stackoverflow.com/questions/256876/tips-for-learning-mumps-m-cache)

# java - 使用 Spring Web Flow 和 JSF 在一个页面上验证多个表单

> ID：1008898
> 
> 赞同：1
> 
> 时间：2009-06-17T18:48:46.757
> 
> 标签：java, spring, jsf, spring-webflow

我正在尝试使用 JSF 来验证 Spring Web Flows 中的两种不同形式。

问题是 validateAllOnClick 似乎触发了页面上的每个客户端验证器。

如果我还删除了 validateALlOnClick，将 processIds 设置为我要验证的 ID、输入 ID 或验证器 ID 的表单只会导致任何客户端验证器都不会触发。保持 validateAllOnClick 并在提交按钮上设置 processIds 会导致所有客户端验证器触发。

如何使用 Spring Web Flow 和具有多种表单的 JSF 进行客户端验证？

```
 <ui:define name="content">
        <div id="main-content">

        <div id="system">       
        <div class="leftcolumn">
        <ui:fragment>
        <h:form id="testForm">
            <div class="admin-title">User Management</div>
            <div class="system-panel"><span class="header">Add a new
            user</span>
            <table>

                <tr>
                    <td><h:outputLabel for="first_names" value="First Name:" /></td>
                    <td><sf:clientTextValidator required="true"
                        invalidMessage="Please enter user\'s first name " id="requiredFirstName">
                        <h:inputText id="first_names" required="true" />
                    </sf:clientTextValidator></td>
                </tr>
                <tr>
                    <td><h:outputLabel for="last_name" value="Last Name:" /></td>
                    <td><sf:clientTextValidator required="true"
                        invalidMessage="Please enter user\'s last name " id="requiredLastName">
                        <h:inputText id="last_name" required="true" />
                    </sf:clientTextValidator></td>
                </tr>
                <tr>
                    <td><h:outputLabel for="email" value="Email:" /></td>
                    <td><sf:clientTextValidator required="true"
                        invalidMessage="Please enter user\'s e-mail address" id="requiredEmail">
                        <h:inputText id="email" required="true" />
                    </sf:clientTextValidator></td>

                </tr>
                <tr>
                    <td>Set password to last name:<br />
                    (in lower case)</td>

                    <td><h:selectBooleanCheckbox id="init_password" value="true" />
                    </td>
                </tr>
                <tr>
                    <td colspan="2" align="right">
                    <div id="password" class='hide_password'><h:outputLabel
                        for="password" value="Password:" /> <h:inputText id="password" />

                    </div>
                    </td>
                </tr>
            </table>
            <sf:validateAllOnClick>
                <sf:commandButton id="addNewUserAction" action="addUser"
                    value="Add New User" processIds="requiredEmail, requiredLastName, requiredFirstName, email" />
                    </sf:validateAllOnClick>
    </div>

        </h:form> </ui:fragment>

        <ui:fragment>
            <h:form id="akeemForm">
                <div class="system-panel"><span class="header">Reset
                User's Password</span>
                <table>
                    <tr>
                        <td><h:outputLabel for="resetPasswordEmail" value="Email:" /></td>
                        <td><sf:clientTextValidator required="true"
                            invalidMessage="Please enter user\'s e-mail address" id="requiredEmail1" >
                            <h:inputText id="resetPasswordEmail" />
                        </sf:clientTextValidator></td>
                    </tr>
                    <tr>
                        <td><h:outputLabel for="resetPasswordPassword"
                            value="Password:" /></td>
                        <td><sf:clientTextValidator required="true"
                            invalidMessage="Please enter user\'s new password" id="requiredEmail2" >
                            <h:inputText id="resetPasswordPassword" />
                        </sf:clientTextValidator></td>
                    </tr>
                    <tr>
                        <td><h:outputLabel for="resetPasswordNotify"
                            value="Email User Their New Password:" /></td>
                        <td><h:selectBooleanCheckbox id="resetPasswordNotify"
                            value="true" /></td>
                    </tr>
                </table>

                    <sf:commandButton id="changeUserPasswordAction"
                        processIds="*" action="changeUserPassword"
                        value="Reset Password" />
        </div>
            </h:form>
        </ui:fragment> <h:form>
            <div class="system-panel"><span class="header">Manage
            User Profile</span>
            <table width="100%">
                <tr>

                    <td><h:outputLabel value="Search" /></td>
                    <td><h:inputText /></td>
                </tr>
            </table>
            <h:commandButton action="searchUser" value="Search" /></div>
        </h:form></div>
        <div class="rightcolumn">
        <div class="admin-title">Title Management</div>

        <h:form>
            <div class="system-panel"><span class="header">Add A
            Title</span> <br />
            <br />
            <h:commandButton id="addTitle"
                value='Start Process for Adding a Title' action="addTitle" /></div>

        </h:form>

        <div class="system-panel"><span class="header">Edit A
        Title</span> <!--<h:form>-->
        <table width="100%">
            <tr>
                <td class='td_name'>Book title:</td>
                <td><h:form>
                    <h:selectOneMenu id="currentSelectedBook"
                        value="#{bookSelector.selectedBook}">
                        <f:selectItems value="#{bookSelector.options}" />
                    </h:selectOneMenu>

                    <h:commandButton id="cmdButton" value="Go to book Dashboard"
                        action="updateBook" />

                </h:form></td>
            </tr>
        </table>
        <!--        <h:commandButton value="Go to the Edit Title interface" action="updateBook" />
    </h:form>   --></div>

        <h:form
            onsubmit="return confirm('Are you sure you want to delete this book?')">

            <div class="system-panel"><span class="header">Delete A
            Title</span>
            <table width="100%">
                <tr>
                    <td class='td_name'>Book title:</td>
                    <td>Book Select Here</td>
                </tr>
            </table>
            <h:commandButton value="Delete" action="deleteTitle" /></div>

        </h:form> <br />

        <div class="system-panel"><span class="header">Title
        Reports</span>
        <ul>
            <li>Titles without ISBNs or Billing Divisions - <h:form>
                <h:commandLink value="View Report" action="missingBillingIsbn" />
            </h:form></li>
        </ul>
        </div>

        </div>
        </div>

        <div class="clearer"></div>

        </div>
    </ui:define>
</ui:composition> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-26T13:08:36.967

您可以通过将所有这些表单制作为 t:subforms 来进行简单的重构（T 标签是指与 JSF 配合良好的战斧库），然后将所有这些子表单包含在

完成后，您可以使用 t:commandbutton 调用选择性子表单。

此语句可帮助您使用一个按钮（有选择地）提交多个表单。查看以下文档。 [http://myfaces.apache.org/tomahawk-project/tomahawk12/tagdoc/t_subform.html](http://myfaces.apache.org/tomahawk-project/tomahawk12/tagdoc/t_subform.html)

同样在 JSF 中，要验证组件不要忘记使用 required="true" 属性，否则验证不会真正启动。

我希望这会有所帮助。

# c++ - 早期绑定的缺点是什么？

> ID：1008903
> 
> 赞同：0
> 
> 时间：2009-06-17T18:49:38.520
> 
> 标签：c++

[早期绑定与后期绑定：比较优缺点是什么？](https://stackoverflow.com/questions/367411/early-binding-vs-late-binding-what-are-the-comparative-benefits-and-disadvantag)...........

我没有找到任何可以帮助我的东西..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:53:46.813

我通常不认为使用早期绑定的语言在任何方面处于不利地位。我想早期绑定的一个缺点是你在执行时对元编程之类的东西不太灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:55:50.130

阅读第二个答案，我认为其中的这些引用很重要：

> 后期绑定有一个巨大的优势：您提到的延展性/可维护性/可扩展性。
> 
> ... 易于开发是一件大事。它最大限度地减少了昂贵的程序员时间——而且你的开发团队越大，它就变得越重要。您需要在这与使用后期绑定语言获得的灵活性之间取得平衡。

与程序员时间相比，硬件便宜（特别是随着时间的推移，随着程序员成本的增加，硬件只会变得更便宜）。

如果您只是在做较小的程序，您可以事先轻松地计划好所有事情，那么差别不大，但是一旦您获得由许多组件组成的较大程序，使用后期绑定增加的灵活性就变得非常明显了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:27:59.317

动态绑定有助于更灵活和可扩展的软件架构，例如 – 并非所有设计决策都需要在系统开发的初始阶段知道，即它们可能会推迟到运行时 – 扩展系统不需要完整的源代码，即, 只有标头和目标代码 这有助于灵活性和可扩展性 – 灵活性 = '轻松将现有组件重新组合到新配置中' - 可扩展性 = “轻松添加新组件”</p>

但早期绑定不会......

# response.redirect - response.redirect 不重定向，只是回发到当前页面

> ID：1008904
> 
> 赞同：2
> 
> 时间：2009-06-17T18:49:40.110
> 
> 标签：response.redirect

我有一个手动调用回发的 JavaScript 函数： __doPostBack('ctl00$searchButton', '');

上面的 searchButton 位于母版页上，并且连接了一个 onclick 事件。在活动结束时，我将重定向到另一个页面。当从 JS 调用回发时，此重定向失败。当 onclick 正常触发时，它可以正常工作。我正在远离自动触发，以便执行一些大大减少 HTML 标记的客户端操作。我尝试用 Server.Transfer 替换 Response.Redirect，但没有成功。

这里有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T20:45:52.523

我建议启动一个调试会话并在该页面的 Load() 方法上设置一个断点并查看执行路径是什么。

此外，尝试使用 HTTP 代理（用于 FireFox 插件的 HttpFox，用于 OS 级别代理的 Charles 代理）以查看重定向的确切作用。

# visual-studio-2008 - 在 Windows Vista 中从 Windows 服务启动新进程

> ID：1008905
> 
> 赞同：0
> 
> 时间：2009-06-17T18:49:45.413
> 
> 标签：visual-studio-2008

调用时，我正在用 C# 3.0 编写 Windows 服务

```
 p = new System.Diagnostics.Process();
            p.StartInfo.FileName = aFileName;
            p.StartInfo.Verb = "Print";
            p.StartInfo.CreateNoWindow = true;
            p.Start(); 
```

Start() 不会启动进程，也不会打印在 aFileName 参数中传递的指定文档。

如何从 Windows 服务启动进程？我正在运行 Windows Vista 操作系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:08:22.390

我相信这是因为启动该过程需要服务与桌面交互，默认情况下，服务中不允许这样做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:33:02.763

我曾经使用网页将上传的文件发送到打印机以将它们转换为 pdf。这就是我用来运行我的进程的方法。

```
try
{
  processInfo = new System.Diagnostics.ProcessStartInfo();
  processInfo.CreateNoWindow = true;
  processInfo.FileName = aFileName;
  processInfo.Arguments = "";
  processInfo.UseShellExecute = true;
  processInfo.Verb = "Print";
  processInfo.WorkingDirectory = "c:\\temp";
  System.Diagnostics.Process process = new System.Diagnostics.Process();
  process.StartInfo = processInfo;
  process.Start();
  while (process.HasExited == false)
  {
  }
}
catch (Exception ex)
{  
  throw new Exception("Died in launch process:" + ex.Message, ex.InnerException);
} 
```

关于 while 语句的注释。在我看来，该进程会在我的函数结束时终止，所以我使用 while 让它保持活动状态，直到它完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-30T20:59:18.873

简而言之，您必须使用 Windows API 来查询用户的令牌，然后在用户空间中启动该进程。我没有时间处理或查找示例代码，但基本上您需要使用以下 API 调用：

GetActiveConsoleSessionId 获取活动的 Windows 控制台会话，WTSQueryUserToken 查询用户的令牌，CreateEnvironmentBlock 为该用户创建一个 EnvironmentBlock，然后利用 CreateProcessAsUser 将进程启动到用户空间。

那里可能有一个示例（可能在 MSDN 上），但这应该可以为您提供所需的起始电话。

# c# - 原始页面上的 global.asax Application_Error 报告

> ID：1008917
> 
> 赞同：0
> 
> 时间：2009-06-17T18:51:32.633
> 
> 标签：c#, asp.net, exception

我想我知道答案，但是是否可以让 global.asax Application_Error 事件修改原始页面上的文本框而不将客户端移动到其他页面？类似：异常 exp = Server.GetLastError().GetBaseException(); System.Data.SqlClient.SqlException sqlex;

```
if (exp is System.Data.SqlClient.SqlException) {
  sqlex = (System.Data.SqlClient.SqlException) exp;
  if (sqlex.Number == 50000) {
    if (HttpContext.Current.CurrentHandler is Page) {
      Page p = (Page) HttpContext.Current.CurrentHandler;
      Control c = p.FindControl("ErrorText");
      if (c != null && c is Label) {
        ((Label) c).Text = exp.Message;
        Server.ClearError();
        return;
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T18:58:22.530

如果你想这样做，那么你应该使用页面本身的“OnError”事件。

# svn - 为什么我不能将 psd (Photoshop) 文件提交到 SVN？

> ID：1008918
> 
> 赞同：5
> 
> 时间：2009-06-17T18:51:33.087
> 
> 标签：svn, visualsvn-server

我试图将 psd 文件提交到 svn，但它没有让我这样做。

错误信息：

> 提交失败（详细信息如下）：PUT of '/svn/.../!svn/wrk/243a5d81-c1c1-f545-8346-5e8399121cb4/Design.psd'：无法发送请求正文：已建立的连接被主机中的软件。（[http://...](http://..)）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-01-22T13:29:28.983

您需要确保您使用最新的 VisualSVN 服务器和 svn 客户端版本，并且您的防病毒、防火墙、代理、网络没有问题。请注意，有时防病毒软件可能会导致此类问题，只有完全卸载防病毒软件会有所帮助。因此，您可能需要联系您的防病毒软件、防火墙或代理的支持以寻求帮助。

*   在客户端，将用户工作副本的位置添加到防病毒排除项中，并将您的 SVN 客户端也添加到排除项中。

*   如果您在服务器计算机上运行防病毒应用程序，则应确保防病毒不会触及 VisualSVN 服务器服务和存储库。在某些情况下，防病毒应用程序、活动防火墙和流量扫描程序也倾向于拦截普通的 HTTP 流量和 HTTPS 流量，并可能导致乍一看与连接或性能相关的问题。

    请确保防病毒软件不会接触到和来自 VisualSVN 服务器的流量，将存储库和 VisualSVN 服务器服务的位置添加到防病毒软件的排除（例外）列表中。您应该将存储库根目录（默认情况下为 C:\Repositories\）和这些服务添加到防病毒的排除（例外）列表中，以便其实时保护不会干扰：

    *   %VISUALSVN_SERVER%bin\VisualSVNServer.exe
    *   %VISUALSVN_SERVER%bin\vdfssvc.exe
    *   %VISUALSVN_SERVER%bin\vsvnjobsvc.exe
    *   %VISUALSVN_SERVER%bin\vrepocfgsvc.exe

顺便说一句，现代 VisualSVN 服务器版本具有丰富的 Web 界面，它支持查看 PSD (Adobe Photoshop) 和 AI (Adobe Illustrator) 文件以及 DOCX (Microsoft Word) 和 PDF。[**在演示服务器上试用该功能**](https://demo-server.visualsvn.com/!/#documents)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-18T05:50:19.417

这完全取决于连接速度和您要提交的文件的大小。如果您的连接速度较慢，请尝试在除 svn 进程之外没有人使用互联网时提交。它可能有助于 svn 使用互联网连接的所有带宽。

毕竟，如果你有同样的问题，你应该像下面的代码一样更新你的 VisualSVN 服务器中的 custom-httpd.conf 文件：

```
Timeout 300000
KeepAlive On
MaxKeepAliveRequests 0
KeepAliveTimeout 500000 
```

# c# - 如何从 .NET 中具有重复列名的连接表中读取 SELECT * 的结果

> ID：1008920
> 
> 赞同：3
> 
> 时间：2009-06-17T18:51:45.753
> 
> 标签：c#, join

我是一名 PHP/MySQL 开发人员，正在慢慢涉足 C#/SQL Server 领域，但在读取连接两个表的 SQL Server 查询时，我在 C# 中遇到了问题。

给定两张表：

表A：

```
int:id
VARCHAR(50):name
int:b_id 
```

表B：

```
int:id
VARCHAR(50):name 
```

并给出查询

```
SELECT * FROM TableA,TableB WHERE TableA.b_id = TableB.id; 
```

现在在 C# 中，我通常以以下方式读取查询数据：

```
SqlDataReader data_reader= sql_command.ExecuteReader();
data_reader["Field"]; 
```

除了在这种情况下，我需要区分 TableA 的名称列和 TableB 的名称列。

在 PHP 中，我只会相应地询问“TableA.name”或“TableB.name”字段，但是当我尝试类似

```
data_reader["TableB.name"]; 
```

在 C# 中，我的代码出错了。

如何解决这个问题？以及如何在 C# 中读取多个表的查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T18:56:24.203

结果集只看到返回的数据/列名，而不是基础表。将您的查询更改为类似

```
SELECT TableA.Name as Name_TA, TableB.Name as Name_TB from ... 
```

然后你可以参考这样的字段：

```
data_reader["Name_TA"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-14T15:35:05.110

对于那些发帖说使用“SELECT *”是错误的，我强烈不同意你的看法。现实世界中有许多需要 SELECT * 的情况。您关于其“错误”使用的绝对陈述可能会导致某人误入歧途，这是一个合法的解决方案。

这里的问题不在于使用 SELECT *，而在于[ADO.NET](https://en.wikipedia.org/wiki/ADO.NET)中的约束。

正如 OP 所指出的，在 PHP 中，您可以通过“TABLE.COLUMN”语法对数据行进行索引，这也是原始 SQL 处理列名冲突的方式：

> SELECT table1.ID, table2.ID FROM table1, table;

为什么 DataReader 没有以这种方式实现我不知道......

也就是说，要使用的解决方案可以通过以下方式动态构建您的 SQL 语句：

*   查询您从中选​​择的表的架构
*   通过遍历架构中的列名来构建您的 SELECT 子句

通过这种方式，您可以构建如下所示的查询，而无需知道您选择的表的架构中当前存在哪些列

> SELECT TableA.Name as Name_TA, TableB.Name as Name_TB from ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T19:16:17.633

您可以尝试按索引（数字）而不是键读取值。

```
name = data_reader[4]; 
```

您将不得不进行实验以查看数字如何对应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T19:18:35.117

欢迎来到真实的世界。在现实世界中，我们不使用“SELECT *”。如果需要，请指定您想要的列、来自哪些表以及使用哪个别名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-06T02:10:06.363

虽然最好使用列列表来删除重复的列，但如果出于任何原因想要 *****，那么只需使用

```
rdr.item("duplicate_column_name") 
```

这将返回第一列的值，因为内部连接将在两个相同的列中具有相同的值，因此这将完成任务。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-17T19:21:55.903

理想情况下，您不应该在数据库模式中使用重复的列名。因此，如果您可以重命名架构以使其名称不冲突。

该规则是针对这种情况的。一旦你完成了你的连接，它只是一个新的记录集，而且通常表名也随之而来。

# iphone - 我的 iPhone Simulator 3.0 地址簿是空的！

> ID：1008924
> 
> 赞同：2
> 
> 时间：2009-06-17T18:52:11.073
> 
> 标签：iphone, cocoa-touch, ios-simulator, addressbook

有人知道如何用 Johnny Appleseed 等重新填充我的 Simlator 的通讯录吗？或者，我自己的数据。没关系..只是它现在不知何故是空的，对测试无用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-27T02:52:55.260

我的经常丢失。没有押韵或理由。

我将 /Users/[your user name/Library/Application Support/iPhone Simulator/User/Library/AddressBook/AddressBook.* 的副本备份到安全的地方，并在丢失时将其复制回来。

这也是拥有多个地址簿进行测试的好策略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-19T08:13:01.837

从 iPhone 模拟器菜单中选择“重置内容和设置”听起来不错，但这正是您不小心删除默认联系人的方式。

这样做之后，用户目录将在您的垃圾箱中。正如上面提到的 Jeff Schilling，您只需将其放回您的**/Users/[您的用户名]/Library/Application Support/iPhone Simulator/**目录中，您就会得到您的地址。

如果您的目标是清除您编写的首选项文件或类似文件，您将在该用户目录中找到它，进一步深入到**Applications/[您的应用程序的唯一 ID]/[此处某处取决于您的应用程序所写的内容] /**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T18:53:41.540

您是否尝试过重置固件？在某处的菜单中有一个选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-12T00:01:46.520

请参阅我在 iPhone 模拟器博客文章[中使用您自己的通讯录。](http://0xced.blogspot.com/2009/01/using-your-own-address-book-in-iphone.html)

正如我在那里所说，只需运行脚本即可在模拟器中获取您自己的通讯录：

```
#!/bin/bash

cd ~/Library/Application\ Support/MobileSync/Backup
backup=`ls -t1 | sed -n '1p'` # most recent backup
for f in "$backup"/*.mdinfo; do
    grep -q "Library/AddressBook/AddressBook.sqlitedb" $f
    if [ $? -eq 0 ]; then
        addressbook=`basename $f .mdinfo`
        cp -v "`pwd`/$backup/$addressbook.mddata" ~/Library/Application\ Support/iPhone\ Simulator/User/Library/AddressBook/AddressBook.sqlitedb
        exit $?
    fi
done

echo "Address Book not found in iPhone backup" >&2
exit 1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-02T20:55:03.447

这对我有用。它从未加密的 iPhone 备份中提取您的通讯录数据。适用于非越狱手机。

*   退出 iOS 模拟器
*   下载[iPhone/iPod Touch 备份提取器](http://supercrazyawesome.com/)
*   运行它，然后选择最后一个选项“iOS 文件”
*   在桌面上创建一个文件夹并将所有文件提取到该文件夹
*   完成后，转到您的提取文件夹并导航到 Library/AddressBook
*   将两个文件（AddressBook.sqlitedb 和 AddressBookImages.sqlitedb）复制到：~/Library/Application Support/iPhone Simulator/{SDK}/Library/AddressBook
*   在 iOS 模拟器中运行联系人应用程序

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-26T17:10:41.737

我意识到这是一个相当老的线程，但我发现自己处于类似的情况，我需要用示例联系人（Johnny Appleseed 等）重新填充我的模拟器的通讯录

这是执行此操作的最快方法：

1.  在 iOS 模拟器运行的情况下，右键单击图标，然后单击选项 > 在 Finder 中显示
2.  右键单击 iOS Simulator 图标并选择 Show Package Contents
3.  在新的 finder 窗口中，浏览到文件夹 Resources > Sample.SimulatorContent > Library

在那里你会找到一个地址簿文件夹。使用它来替换用户的地址簿文件夹 ~/Library/Application Support/iPhone Simulator/{SDK}/Library/

重新启动 iOS 模拟器后，转到您的地址簿，您将再次找到示例联系人、Johnny Appleseed 和朋友。

# xslt - 选择具有默认命名空间的节点

> ID：1008930
> 
> 赞同：2
> 
> 时间：2009-06-17T18:53:48.607
> 
> 标签：xslt, xpath, namespaces

我有一个 XML 文档，其中使用了许多不同的名称空间和一个要验证的模式。该模式要求所有元素都是“合格的”，我认为这意味着它们需要具有完整的 QNames 而没有空命名空间。

然而，这个巨大的 XML 文档中的一些元素只使用了默认名称空间，在这个文档中是空白的。自然，他们无法通过模式验证。

我正在尝试编写一个 XSLT，它将选择没有命名空间的节点，并为它们分配一个具有与其他节点相同前缀的特定节点。例如：

```
<x:doc xmlns:x="http://thisns.com/">
  <x:node @x:property="true">
     this part passes validation
  </x:node>
  <node property="false">
     this part does not pass validation
  </node>
</x:doc> 
```

我尝试添加`xmlns="http://thisns.com/"`到文档的根节点，但这与架构验证器不一致。关于如何完成这项工作的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T19:15:09.570

```
<!-- Identity transform by default -->
<xsl:template match="node() | @*">
  <xsl:copy>
    <xsl:apply-templates select="node() | @*"/>
  </xsl:copy>
</xsl:template>
<!-- Override identity transform for elements with blank namespace -->
<xsl:template match="*[namespace-uri() = '']">    
  <xsl:element name="{local-name()}" namespace="http://thisns.com/">
    <xsl:apply-templates select="node() | @*"/>
  </xsl:element>
</xsl:template>
<!-- Override identity transform for attributes with blank namespace -->
<xsl:template match="@*[namespace-uri() = '']">
  <xsl:attribute name="{local-name()}" namespace="http://thisns.com/"><xsl:value-of  select="."/></xsl:attribute>
</xsl:template> 
```

这将给出类似于以下的结果：

```
<x:doc xmlns:x="http://thisns.com/">
  <x:node x:property="true">
    this part passes validation
  </x:node>
  <node xp_0:property="false" xmlns="http://thisns.com/" xmlns:xp_0="http://thisns.com/">
     this part does not pass validation
  </node>
</x:doc> 
```

请注意，第二个 <node> 仍然没有命名空间前缀，但由于 xmlns= 属性，它现在被视为同一命名空间的一部分。

# java - 对于几乎没有空闲时间的人来说，玩 GWT 的最快方法是什么？

> ID：1008932
> 
> 赞同：1
> 
> 时间：2009-06-17T18:54:39.977
> 
> 标签：java, gwt, frameworks

我认为这个主题几乎涵盖了它。我不是网络程序员（我是程序员），我想写一些玩网络应用程序，我真的没有很多空闲时间。那么启动和运行 GWT 的最快方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T19:05:54.280

我会说 Google 的[GWT Quick Start](http://code.google.com/webtoolkit/gettingstarted.html)。也就是说，如果您还不熟悉该语言，那么学习一些 Java 技能将是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T13:46:57.287

StockWatcher[应用程序](http://code.google.com/webtoolkit/tutorials/1.6/gettingstarted.html)教程几乎一步一步地涵盖了您作为初学者需要尝试并了解 GWT 的所有内容（前提是您了解一点 JAVA）。

这是[GWT 快速入门](http://code.google.com/webtoolkit/gettingstarted.html)文档的一部分（其他人也提到过），您可以在其中找到大量其他示例和资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:38:16.747

选择一个与您想要的类似的应用程序，然后逐个修改它......

# flash - 为什么我不能用另一个替换此示例中的影片剪辑？

> ID：1008934
> 
> 赞同：0
> 
> 时间：2009-06-17T18:54:42.740
> 
> 标签：flash

[http://www.sephiroth.it/tutorials/flashPHP/print_screen/page002.php](http://www.sephiroth.it/tutorials/flashPHP/print_screen/page002.php)

在此代码中，如果我将影片剪辑替换为不同的剪辑，它将不起作用。
我究竟做错了什么？

* * *

### 代码：

```
function print_me(){
    video_mc.pause()    // first pause the playing video
    pn = new PrintScreen(); // initialize the PrintScreen class
    pn.addListener( listener ); // assign a listener
    pn.print(_root, 0, 0, 500, 210) // copy the _root
    loader.label = "computing... 0%"
    loader.open(true, true, true);  // open a loader
} 
```

这调用了影片剪辑，但是当我用任何其他影片剪辑替换它时，它不会调用 PHP。

```
listener.onComplete = function(target:MovieClip, load_var:LoadVars){
    loader.label = "sending to php..."
    load_var.send("files/pixels.php", "_blank", "POST")
    loader.close()
} 
```

我觉得有些东西丢失了，或者我无法正确理解作者试图解释的内容。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-06-17T19:08:39.783

video_mc.pause() 这是移动剪辑的简单暂停

您的代码是什么原因导致该页面中的脚本本身并不能说明您的问题

# c# - 有什么工具可以从 XML 创建一个类以进行反序列化？

> ID：1008953
> 
> 赞同：2
> 
> 时间：2009-06-17T19:00:01.700
> 
> 标签：c#, .net, xml, xml-serialization

我有这个 XML 文件，我想将它反序列化为一个对象。但我不想输入它的类定义。有什么工具可以为我创建类的 C# 代码，从示例数据中推断数据类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T19:03:03.397

是的。开箱即用，您可以使用 xsd.exe 从 XML 生成 XSD 文件。您还可以使用此工具从 XSD 文件生成类。

它生成的代码是有限的，这就是为什么有一些第三方工具介入的原因。

其中两个工具包括 LiquidXML（收费）和 CodeXS（免费）。我们使用 CodeXS，因为它是免费且可扩展的。我们已经扩展了很多。

**编辑：** CodeXS 有一个[在线工具](http://www.bware.biz/default.htm?http%3A//www.bware.biz/DotNet/Tools/CodeXS/WebClient/GenerateInput.aspx)。只需给它一个 XSD。它为您生成课程。他们还有一个可扩展的[命令行工具](http://www.bware.biz/default.htm?http%3A//www.bware.biz/DotNet/Tools/CodeXS/WebClient/GenerateInput.aspx)（源代码），不需要您将 XSD 发送到他们的 Web 服务。我们将其用作预构建步骤。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T19:18:45.443

Liquid Technologies 为此提供了一个很好的工具（数据绑定）[http://www.liquid-technologies.com/](http://www.liquid-technologies.com/)。您确实需要定义一个模式，而不是让这样的工具从样本数据中“推断”它。

我们发现 Liquid 的好处之一是它还可以为 Java、C++、C#、VBA 等生成代码。所有这些都非常一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T19:03:33.443

查看[LINQ-to-XSD](http://linqtoxsd.codeplex.com/)

它要求您为 XML 编写一个模式，但是直接转换为对象非常好。

# c++ - windows上的进程间通信

> ID：1008957
> 
> 赞同：4
> 
> 时间：2009-06-17T19:01:17.830
> 
> 标签：c++, windows, ipc, tcl

我有一个在 Windows 上运行的 TCL 脚本。我需要与在不同进程中运行的旧 vc++ 6 应用程序通信。我需要有2路沟通。在 Linux 中我会使用 dbus，但我应该为 windows 使用什么 IPC 策略？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T19:03:16.953

[Boost.interprocess](http://www.boost.org/doc/libs/1_39_0/doc/html/interprocess.html)有多种方式，例如 C++ 的共享内存和消息传递。您总是可以从那里开始，看看什么与您的脚本兼容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T19:06:11.270

[命名管道怎么](http://msdn.microsoft.com/en-us/library/aa365590(VS.85).aspx)样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T19:10:41.107

普通的旧套接字在 Windows（和 Linux，以及所有实现 TCP/IP 的地方）的 TCL 中工作得很好：）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T09:54:05.430

Windows 上的 Tcl 具有内置的 dde ​​支持（请参阅 dde ​​命令的文档），如果其他应用程序支持它，这可能会有所帮助。另一种选择是 TWAPI (Tcl Windows API) 扩展，它具有将键盘和鼠标输入发送到另一个应用程序的功能，请参见[http://twapi.magicsplat.com/input.html](http://twapi.magicsplat.com/input.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T19:07:53.560

来自 MSDN 的选项列表：http: [//msdn.microsoft.com/en-us/library/aa365574 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa365574(VS.85).aspx)

如果你想要更“进取”的东西，还有[Windows Message Queue](http://msdn.microsoft.com/en-us/library/ms711472.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T20:21:29.543

从 Tcl 的角度来看，如果您的 VC6 应用程序允许，最简单的方法是让 TCL 启动 VC 应用程序，然后使用标准输入和标准输出进行通信。如果这不可能，Tcl socket 命令允许您与另一个进程建立 TCP 套接字连接。

有关第一个的详细信息，请参见[此处](https://stackoverflow.com/questions/267420/tcl-two-way-communication-between-threads-in-windows)，有关套接字的一些信息，请参见[此处。](http://www.tcl.tk/man/tcl8.4/TclCmd/socket.htm)

# c# - C#如何将放置变量添加到资源字符串中

> ID：1008966
> 
> 赞同：12
> 
> 时间：2009-06-17T19:05:13.597
> 
> 标签：c#, resources

这应该很容易，但找不到任何解释。

假设我在 console.writeln 上写了一些东西，比如：

`console.writeln("Jim is a {0} ", xmlscript);`

假设我想将字符串“Jim is..”转换为全局 resource.resx 中的资源字符串。这将是：

`jimstring jim is a {0}`

我会在代码中将其称为

`console.writeln(Resources.jimstring)`

如何将放置变量（`xmlscript`）（这就是它们的名称？）放入console.writeln的资源字符串中？

谢谢，

鲍勃

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-17T19:13:38.713

正如 Jeff Johnson 在他的回答中提到的，它与原始的 Console.WriteLine() 基本完全相同。资源字符串只是一个字符串。因此，您引用资源文件并进行格式化。

如果您需要它用于控制台以外的其他东西，您可以使用 String.Format()：

```
 var newString = String.Format(resources.jimstring, xmlscript); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-17T19:06:57.663

```
Console.WriteLine(Resources.jimstring, xmlscript); 
```

Console.WriteLine 采用其他格式参数，这些参数将替换 Resources.jimstring 字符串中的 {0}。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/828t9b9h.aspx](http://msdn.microsoft.com/en-us/library/828t9b9h.aspx)

# asp.net - 预期的 Jquery 对象

> ID：1008971
> 
> 赞同：0
> 
> 时间：2009-06-17T19:06:01.190
> 
> 标签：asp.net, jquery

有人能告诉我为什么 Jquery 在这一点上出错了吗？

```
 <script type="text/javascript" language="javascript">
        var myLayout; 
       // a var is required because this page utilizes: 
       // myLayout.allowOverflow() method
        $(document).ready(function() {
            myLayout = $('body').layout({
            // enable showOverflow on west-pane 
            // so popups will overlap north pane
            // west__showOverflowOnHover: true
           });
       });
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:03:06.430

才发现问题。

我忽略了我的网站的位置。

我把它放在 c:\Projects\MySites\JohnsonCo.sln

请注意，它不在 wwwroot 目录中！也就是说，**c:\Inetpub\wwwroot**

我猜 IIS 配置不正确，这就是为什么脚本 src 属性（）中没有任何目录规范起作用的原因。

我以为我永远不会回答我自己的问题，但我想我只是回答了。感谢您的投入，感谢那些回复的人！

谢谢，柏辽兹

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T19:12:46.127

除非您有自己的自定义插件扩展。`$('body').layout()`不是有效的 jQuery 函数。

**编辑：**我假设您正在使用这个[插件](http://layout.jquery-dev.net/documentation.html#Example)。确保`<script>`插件的标签包含在包含 jQuery 之后，而不是相反。这很可能是错误的来源。

例子：

```
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery.layout.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:13:32.647

我的猜测是因为布局不是 body 或 jQuery 对象的函数……但是除非你真的给我们一个错误，否则它并没有特别的帮助。

# sorting - 选择排序 - 最小值/最大值索引

> ID：1008982
> 
> 赞同：0
> 
> 时间：2009-06-17T19:08:11.140
> 
> 标签：sorting

我正在查看[cprogramming.com](http://www.cprogramming.com/tutorial/computersciencetheory/sorting2.html)上的选择排序算法 ，我想我在实现中发现了一个错误。

如果你通过算法工作，有一个名为“index_of_min”的变量，我认为应该是“index_of_max”（因为当我测试它时，它是从最大到最小排序的）。

认为这是一个错字或小错误，我查看了其他一些网站，如[wikipedia](http://en.wikipedia.org/wiki/Selection_sort)和一些鲜为人知的网站，如[geekpedia](http://www.geekpedia.com/tutorial288_Selection-Sort-Algorithm-in-Java.html)。似乎它们被称为最小索引。

当我通过调试器运行它时，在我看来它真的是最大值的索引。我在某个地方犯了错误吗？

编辑：正如 Svante 指出的，只有 cprogramming 实现是错误的。维基百科和 Geekpidia 很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T19:26:13.370

wikipedia 和 geekpedia 站点似乎是正确的，cprogramming.com 实现实际上有一个错误；这：

```
if (array[index_of_min] < array[y])
  { index_of_min = y; } 
```

顺序颠倒了，应该是：

```
if (array[y] < array[index_of_min])
  { index_of_min = y; } 
```

另一种解决方法是调用变量`index_of_max`，但我希望排序算法能够从最小到最大排序，如果大多数程序员都认同这种期望（我认为），那么最小惊讶原则就需要上述修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:28:16.203

你说的对。该网站的代码（如下所示）不正确。

```
for(int x = 0; x < n; x++)
    {
        int index_of_min = x;
        for(int y = x; y < n; y++)
        {
            if(array[index_of_min] < array[y])    /* Here's the problem */
            {
                index_of_min = y;
            }
        }
        int temp = array[x];
        array[x] = array[index_of_min];
        array[index_of_min] = temp;
    } 
```

在内循环结束时**`for(int y=x; y<n; y++)`**，变量 ,**`index_of_min`**保存*最大值*的索引。假设它被*设计为从***最大到最小**对数组进行排序，这是一个**命名不佳的变量**。

如果您希望数组从**最小到最大**排序（正如人们所期望的那样），您需要**反转 if 语句**：

```
if (array[y] < array[index_of_min])
{
    index_of_min = y;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:29:05.407

我刚刚阅读了代码，但看起来你是对的：要么`index_of_min`命名错误，要么比较是倒退的。

它并不像在几个地方看到这个错误那样奇怪。很可能每个都是从一个共同的来源复制的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T19:45:25.390

来自 Cprogramming.com “它的工作原理是选择数组的最小（或最大，如果你想从大到小排序）元素并将其放在数组的开头”所以他们让它从大到小排序，代码没有错误，变量命名也没有，index_of_min 跟踪数组 (0) 中的起点，然后在该数组中向前移动。即 index_of_min 保持最小的索引值。不要将它与该索引处的值混淆。

# c# - 实现文件从.net winforms 应用程序拖到桌面？

> ID：1008984
> 
> 赞同：12
> 
> 时间：2009-06-17T19:08:37.927
> 
> 标签：c#, .net, drag-and-drop

我有一个文件列表，它们的名称在列表框中，其内容存储在 SQL 表中，并希望我的应用程序的用户能够选择列表框中的一个或多个文件名并将它们拖到桌面，从而产生桌面上的实际文件。我找不到任何有关如何执行此操作的文档。任何人都可以解释或指出解释吗？

稍后添加：我已经能够通过处理 DragLeave 事件来完成这项工作。在其中，我在一个临时目录中创建了一个文件，该文件具有选定的名称和从 SQL Server 中提取的内容。然后我将文件的路径放入对象中：

```
var files = new string[1];
files[0] = "full path to temporary file";
var dob = new DataObject();    
dob.SetData(DataFormats.FileDrop, files);
DoDragDrop(dob, DragDropEffects.Copy); 
```

但这似乎非常低效和笨拙，我还没有找到摆脱累积临时文件的好方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T19:40:54.213

我可以帮助你一些。这里有一些代码可以让你从列表框中拖出一些东西，当它放在桌面上时，它会创建一个存在于你机器上的文件到桌面的副本。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        this.listBox1.Items.Add("foo.txt");
        this.listBox1.MouseDown += new MouseEventHandler(listBox1_MouseDown);
        this.listBox1.DragOver += new DragEventHandler(listBox1_DragOver);
    }

    void listBox1_DragOver(object sender, DragEventArgs e)
    {
        e.Effect = DragDropEffects.Copy;
    }

    void listBox1_MouseDown(object sender, MouseEventArgs e)
    {
        string[] filesToDrag = 
        {
            "c:/foo.txt"
        };
        this.listBox1.DoDragDrop(new DataObject(DataFormats.FileDrop, filesToDrag), DragDropEffects.Copy);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T19:45:02.957

以下是一些样板，可帮助您确定何时开始拖动操作：

```
private Rectangle _DragRect;

private void MyDragSource_MouseDown(object sender, MouseEventArgs e) {
   Size dragsize = SystemInformation.DragSize;
   _DragRect = new Rectangle(new Point(e.X - (dragsize.Width / 2), e.Y - (dragsize.Height / 2)), dragsize);
}

private void MyDragSource_MouseMove(object sender, MouseEventArgs e) {
   if (e.Button == MouseButtons.Left) {
      if (_DragRect != Rectangle.Empty && !_DragRect.Contains(e.X, e.Y)) { 
         // the mouse has moved outside of the drag-rectangle.  Start drag operation

         MyDragSource.DoDragDrop(.....)
      }
   }
}

private void MyDragSource_MouseUp(object sender, MouseEventArgs e) {
   _DragRect = Rectangle.Empty; // reset
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-02T09:08:51.370

[我通过在 C# 中将传输虚拟文件扩展到 Windows 资源管理器](http://www.codeproject.com/Articles/23139/Transferring-Virtual-Files-to-Windows-Explorer-in)找到了更好的解决方案`System.Windows.Forms.DataObject`

还在 StackOverFlow 上找到了一些线程，这些线程可能有助于
[将大型虚拟文件从 C# 拖放到 Windows 资源管理器](https://stackoverflow.com/questions/12410114/drag-and-drop-large-virtual-files-from-c-sharp-to-windows-explorer)

# winforms - Winforms .net 2.0：将文本框绑定到父属性

> ID：1008986
> 
> 赞同：0
> 
> 时间：2009-06-17T19:09:05.883
> 
> 标签：winforms, data-binding, .net-2.0

我有一个强类型的数据集，有两个数据表：父和子，有一个以您期望的方式链接它们的关系（例如，父母有很多孩子）。

在我的孩子详细信息表单上，我显示了很多关于当前孩子的信息，带有如下绑定调用：

```
me.txtBirthDate.DataBindings.add(New Windows.Forms.Binding("Text", MyDataset, "Child.Birthdate")) 
```

但我也想显示一些关于孩子父母的信息——比如父母的名字。我努力了：

```
me.txtParentName.DataBindings.add(New Windows.Forms.Binding("Text", MyDataset, "Child.Parent.Name")) 
```

和

```
me.txtParentName.DataBindings.add(New Windows.Forms.Binding("Text", MyDataset, "Parent.Name")) 
```

但这些都会导致一个空白文本框。

我当然可以将父属性直接放在子数据表上并用底层数据库表之间的连接结果填充它们，但如果可能的话，我想避免这种情况（我的真实应用程序每个只涉及几个父有很多孩子，我不想移动这么多不必要的数据）。

那可能吗？

非常感谢！

-罗伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T19:17:45.447

我通常在和控件`BindingSource`之间使用a。`DataSet`使用这种方法时，如果我有控件要绑定到不同表中的相关行，我创建一个新的`BindingSource`，它指向相关行（他的`DataSource`属性是原始的`BindingSource`，他`DataMember`的是父表），然后将其他控件绑定到 2nd `BindingSource`。

我通常在设计器视图中完成这一切，它只是`BindingSource`在我进行时创建这些对象。

希望有帮助。

# dll - 查找嵌入式 DLL 资源

> ID：1008988
> 
> 赞同：0
> 
> 时间：2009-06-17T19:09:18.690
> 
> 标签：dll, resources, decompiling

我正在使用反编译器查看我不久前构建的 DLL，因为我不再拥有原始源代码。我想看看资源字符串的具体值是多少，但我似乎找不到它们。我嵌入了资源文件，所以我想我可以反编译 DLL 并查看字符串，但它在任何地方都找不到。我应该检查的任何地方或者这是不可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T19:17:22.793

最后使用 Reflector 并看到了我需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-05T19:13:01.293

像[XN 资源编辑器](http://www.wilsonc.demon.co.uk/d10resourceeditor.htm)这样的工具是否适合您？

# caching - Apache 反向缓存代理 - 为什么不缓存？

> ID：1008990
> 
> 赞同：8
> 
> 时间：2009-06-17T19:09:37.427
> 
> 标签：caching, apache2, reverse-proxy

我正在尝试为广告图形（GIF、JPEG、SWF）服务设置反向缓存代理。代理工作正常并将请求发送到源服务器，但我似乎无法弄清楚为什么内容没有被缓存。我当前的配置如下。目标是缓存与`/ca/`URI 前缀匹配的所有请求。源服务器正在使用干净的 URL 提供文件，没有文件扩展名，`max-age=1`在源服务器标头上设置了缓存控制周。

```
ProxyRequests Off
<Proxy *>
 Order deny,allow
 Allow from all
</Proxy>
<IfModule mod_disk_cache.c>
 CacheEnable disk /
 CacheRoot "/var/cache/mod_proxy"
 CacheDirLevels 3
 CacheDirLength 5
 CacheIgnoreCacheControl On 
</IfModule>

RewriteCond %{REQUEST_URI} ^/ca/*
RewriteRule ^/(.*)$ http://origin.webserver.com/$1 [P,L] 
```

目前，我看到的唯一实际发生的缓存是在代理服务器上访问的本地文件，我正在寻找我缺少的内容，以便从源服务器获取要缓存的内容。

我想知道它是否与`mod_cache`不缓存有关，因为内容是从源服务器获取的，而不是在磁盘上的某个位置上。

我正在寻找一种方法来强制缓存与该前缀匹配的所有请求。

PS看起来我遇到了这个确切的问题： http: [//mail-archives.apache.org/mod_mbox/httpd-users/200901.mbox/%3C497F6ED3.7080606@gmail.com%3E](http://mail-archives.apache.org/mod_mbox/httpd-users/200901.mbox/%3C497F6ED3.7080606@gmail.com%3E)。我将检查我的权限并查看调试消息……</p>

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T21:14:40.013

添加这些指令似乎启动了缓存机制。我认为这与从源服务器发送的过期和缓存控制标头有关，因为我使用 Symfony/PHP5 而不是直接从文件系统提供图像。

```
<IfModule mod_disk_cache.c>
    CacheEnable 磁盘 /
    CacheRoot "/var/cache/mod_proxy"
    CacheDirLevels 3
    缓存目录长度 5
    CacheIgnoreCacheControl 开启
    CacheMaxFileSize 100000000
    CacheIgnoreNoLastMod On
    CacheMaxExpire 1209600
    CacheIgnoreQueryString 开启
</IfModule>

```

# apache-flex - ModuleBase 与 Module

> ID：1008996
> 
> 赞同：1
> 
> 时间：2009-06-17T19:11:47.407
> 
> 标签：apache-flex, actionscript, module

有谁知道何时使用 mx.modules.ModuleBase 而不是 mx.modules.Module？我看到的文档对每个文档的设计目的不是很清楚。他们所说的“与框架交互”到底是什么意思？它只是归结为视觉与非视觉组件吗？显然，不与“框架”交互的 BaseModule 不会很有用，因此 BaseModule 的任何实际子类都可能以某种能力与框架交互。我的猜测是 Adob​​e 提供了 ModuleBase，以便开发人员可以扩展所需的最少代码量，以便在运行时将某些内容加载到 vm 中。有任何想法吗？谢谢

*Flex 开发人员指南 pg.990*

> 扩展 Module 类与使用 MXML 文件中的标记相同。如果你的模块与框架交互，你应该扩展这个类；这通常意味着它将对象添加到显示列表或以其他方式与可见对象交互。

...他们继续说

> 如果您的模块不包含任何框架代码，您可以创建一个扩展 ModuleBase 的类。如果您使用 ModuleBase 类，您的模块通常会比使用基于 Module 类的模块小，因为它没有任何框架类依赖项。

* * *

很酷，谢谢大家。是的，我也读过这些评论。由于我在过去几个月中使用过 Flex 模块，我相信我最初的解释是相当接近的“......Adobe 提供了 ModuleBase，以便开发人员可以扩展所需的最少代码量，以便在运行时将某些东西加载到 vm 中。” 我觉得文档的解释太笼统了。例如，我有几个“与框架交互”的 ModuleBase 类。它们本身不是可视组件——而是利用各种框架类在我的应用程序中履行一种服务角色。我认为对 ModuleBase 更准确的描述是“如果您的模块不是 DisplayObject 则从 ModuleBase 扩展”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T16:55:30.170

ModuleBase 用于非弹性模块。

Module 用于基于 flex 的模块。如果您在模块中使用任何 flex 组件，这是给您的。或者，如果您打算在 flex 应用程序中使用该模块，您可能也想要这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-21T12:07:36.190

根据 ModuleBase.as 文件中的评论：

> 基于 ActionScript 的可动态加载模块的基类。如果您编写仅 ActionScript 的模块，则应扩展此类。如果使用`<mx:Module>`MXML 文件中的标记编写基于 MXML 的模块，则改为扩展 Module 类。

...并在 Module.as 中：

> 如果您的模块不包含任何框架代码，您可以创建一个扩展 ModuleBase 类的类。如果您使用 ModuleBase 类，您的模块通常会比创建基于 Module 类的模块小，因为它没有任何框架类依赖项。

所以基本上，如果你正在编写一个 MXML 组件，或者如果你正在使用 flex 框架类，那么你应该使用 Module 类。否则，ModuleBase 更合适。

# iphone - iPhone SDK：带有“animationImages”问题的长动画

> ID：1008997
> 
> 赞同：0
> 
> 时间：2009-06-17T19:11:53.867
> 
> 标签：iphone, xcode, animation

我一直在尝试在 xcode 中设置动画很长一段时间，起初我开始尝试为 100 个 1000x1000 pngs 设置动画，但这些图像对于 iphone 来说太大了，现在我正在尝试为 100 个 320x480 pngs 设置动画，看起来动画直到大约 40 帧，然后应用程序崩溃，那么，还有其他动画方法不会这样做吗？这可能只是因为这段代码加载了太多的图像供 iphone 处理，还有其他方法可以让应用程序停止崩溃吗？或者我可以进一步优化这段代码吗？（顺便说一下，我是 iphone 平台的新手，所以在回答时请记住）

```
- (IBAction)startClick1:(id)sender{

spud123.animationImages = [NSArray arrayWithObjects:
                          [UIImage imageNamed: @"spud1230000.png"],
                          [UIImage imageNamed: @"spud1230001.png"],
                          [UIImage imageNamed: @"spud1230002.png"],
                          [UIImage imageNamed: @"spud1230003.png"],
                          [UIImage imageNamed: @"spud1230004.png"],
                          [UIImage imageNamed: @"spud1230005.png"],
                          [UIImage imageNamed: @"spud1230006.png"],
                          [UIImage imageNamed: @"spud1230007.png"],
                          [UIImage imageNamed: @"spud1230008.png"],
                          [UIImage imageNamed: @"spud1230009.png"],
                          [UIImage imageNamed: @"spud1230010.png"],
                          [UIImage imageNamed: @"spud1230011.png"],
                          [UIImage imageNamed: @"spud1230012.png"],
                          [UIImage imageNamed: @"spud1230013.png"],
                          [UIImage imageNamed: @"spud1230014.png"],
                          [UIImage imageNamed: @"spud1230015.png"],
                          [UIImage imageNamed: @"spud1230016.png"],
                          [UIImage imageNamed: @"spud1230017.png"],
                          [UIImage imageNamed: @"spud1230018.png"],
                          [UIImage imageNamed: @"spud1230019.png"],
                          [UIImage imageNamed: @"spud1230020.png"],
                          [UIImage imageNamed: @"spud1230021.png"],
                          [UIImage imageNamed: @"spud1230022.png"],
                          [UIImage imageNamed: @"spud1230023.png"],
                          [UIImage imageNamed: @"spud1230024.png"],
                          [UIImage imageNamed: @"spud1230025.png"],
                          [UIImage imageNamed: @"spud1230026.png"],
                          [UIImage imageNamed: @"spud1230027.png"],
                          [UIImage imageNamed: @"spud1230028.png"],
                          [UIImage imageNamed: @"spud1230029.png"],
                          [UIImage imageNamed: @"spud1230030.png"],
                          [UIImage imageNamed: @"spud1230031.png"],
                          [UIImage imageNamed: @"spud1230032.png"],
                          [UIImage imageNamed: @"spud1230033.png"],
                          [UIImage imageNamed: @"spud1230034.png"],
                          [UIImage imageNamed: @"spud1230035.png"],
                          //and so on to 100
                          nil];

[spud123 setAnimationRepeatCount:1];
spud123.animationDuration =5.7;
[spud123 startAnimating]; 
```

}

Ps：我试过 NSTimer，但我无法停止重复动画

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T20:18:33.247

这不是动画问题，而是设计问题。

首先，只需一步一步计算应用程序的内存需求：解压缩时，每个 PNG 使用 614400 字节。所以其中一百个使用 61440000 字节：超过 60 兆字节。对手机的期望有点高。

如果你真的需要为每一帧显示不同的图像，你应该使用视频。视频有很多技术可以在顺序显示大量大图像时压缩图像并减少处理和内存需求。

如果您需要这是一个具有更多控制权的动画，我建议您需要分析正在移动的内容并仅对其进行动画处理 - 绘制单个背景，然后在其上为较小的图像制作动画。

最后，如果这种方法不起作用，您将不得不[学习 OpenGL](http://iphonedevelopment.blogspot.com/2009/05/opengl-es-from-ground-up-table-of.html)才能获得所需的性能。

在不了解您的应用程序的情况下，很难提出建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-22T03:56:25.510

您需要仔细考虑您的应用程序内存使用情况，但只是为了让您知道选项，我已经成功使用了基于[http://www.modejong.com/iPhone/PNGAnimatorDemo.zip](http://www.modejong.com/iPhone/PNGAnimatorDemo.zip)的修改类，可以在第一代iPad 硬件，处理 15fps 全屏 (1024x768) png 动画。但请注意您的应用程序包大小。这绝对不是大多数应用程序的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T03:57:06.450

通常动画中的帧非常相似。因此，一种潜在的解决方案是加载一些图像……然后使用 OpenGL 为它们设置动画。这适用于，比如说，一个球弹跳。不确定您正在制作哪些图像。

# c# - 使用 typemock 进行链接

> ID：1008999
> 
> 赞同：0
> 
> 时间：2009-06-17T19:12:24.583
> 
> 标签：c#, mocking, typemock

我只是从嘲笑开始，我正在尝试一些我认为应该很简单的东西。

我有一个类可以读取 Google 日历数据。首先，它创建一个`CalendarService`对象，然后调用`Query`该对象，接收 a`EventFeed`并迭代 的 Item 集合`AtomEntryCollection`。我希望这一切都被嘲笑，因为我不希望我的测试发送任何网络请求。我试着用

```
var service = MockManager.Mock<CalendarService>();
var events = MockManager.MockAll<EventFeed>();
var entries = MockManager.MockAll<AtomEntryCollection>();
service.ExpectAndReturn("Query", events.MockedInstance);
events.ExpectGet("Entries", entries.MockedInstance);
entries.ExpectGetAlways("Count", 3); 
```

但是一旦`service.Query()`使用从该方法返回的对象，我的测试就会失败。我知道在第 5 行`entries.MockedInstance`中仍然为 null，因此将`ExpectAndReturn`null 记录为返回值 - 那我该怎么办？如何设置模拟以返回有效的模拟对象，而不是空值？

注意 - 我正在编写一个 .NET 2.0 项目，所以我不能使用 Isolator 功能（我认为）。那会帮助我吗？或者也许切换到 Rhino 或 MOQ 会更容易？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T06:18:28.543

首先，如果你使用旧的 API，你应该使用 MockObject，而不是 Mock。Mock 用于稍后在被测代码中创建的对象，MockObject 用于现在创建的对象。

但是为什么要使用旧的 API？我推荐的最好方法是在 .Net 3.5 中编写测试，这样你就可以两全其美。在这种情况下，您的设置如下所示：

```
var service = Isolate.Fake.Instance();
```

```
Isolate.WhenCalled(() => service.Query().Count).WillReturn(3);
```

```
var events = Isolate.Fake.Instance();
```

```
Isolate.WhenCalled(() => events.Entries.Count).WillReturn(3);
```

但是，如果您很难使用 2.0 no Lambda 语法，它看起来是这样的：

```
var service = Isolate.Fake.Instance();
```

```
Isolate.WhenCalled(delegate { return service.Query().Count; }).WillReturn(3);
```

```
事件 = Isolate.Fake.Instance();
```

```
Isolate.WhenCalled(delegate { return events.Entries.Count; }).WillReturn(3);
```

请参阅此[链接](http://blog.typemock.com/2008/10/how-to-use-isolator-new-api-in-vs2005.html)，了解如何设置 VS2005 测试以使用 AAA API。