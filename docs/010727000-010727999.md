# StackOverflow 问答 10727000-10727999

# sql - 如何通过函数运行所有表单提交的数据

> ID：10727000
> 
> 赞同：1
> 
> 时间：2012-05-23T20:01:28.683
> 
> 标签：sql, asp-classic, sql-injection

在经典的 ASP 中，有没有一种简单的方法来清理所有表单提交的输入？这是我的消毒功能：

```
function dbsafe(data)
data = replace(data,";","")
data = replace(data,"'","")
data = replace(data,"â€”","")
data = replace(data,"/*","")
data = replace(data,"*/","")
data = replace(data,"*","")
data = replace(data,"/","")
data = replace(data,"xp_","")
end function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:08:35.857

我会考虑使用参数化查询。攻击者最终会想到您忘记删除的内容。

这是参数化查询的链接：http: [//support.microsoft.com/kb/200190](http://support.microsoft.com/kb/200190)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:25:56.883

我发现 IIS 团队的这篇博客文章似乎运行良好：

[http://blogs.iis.net/nazim/archive/2008/04/28/filtering-sql-injection-from-classic-asp.aspx](http://blogs.iis.net/nazim/archive/2008/04/28/filtering-sql-injection-from-classic-asp.aspx)

# javascript - jQuery $(document).ready () 触发两次

> ID：10727002
> 
> 赞同：75
> 
> 时间：2012-05-23T20:01:33.420
> 
> 标签：javascript, jquery, jquery-events, document-ready

我一直在网上搜索，试图找出这里发生了什么，但我无法得到具体的答案。

我的网站上有一个`$(document).ready`可以多次运行的接缝，无论其中的代码如何。

我已经阅读了关于 jQuery 的错误报告，`.ready`如果您的语句中出现异常，该事件将如何触发两次。但是，即使我有以下代码，它仍然会运行两次：

```
$(document).ready(function() {
    try{    
        console.log('ready');
        }
    catch(e){
        console.log(e);
    }
}); 
```

在控制台中，我看到的只是“准备就绪”记录了两次。是否有可能另一个带有异常的 .ready 会导致问题？我的理解是所有 .ready 标签都是相互独立的，但我似乎找不到它在哪里发挥作用？

这是该网站的主要内容：

```
<head>
<title>${path.title}</title>
<meta name="Description" content="${path.description}" />
<link href="${cssHost}${path.pathCss}" rel="stylesheet" type="text/css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript" charset="utf-8"><!----></script>
<script src="media/js/fancybox/jquery.fancybox.pack.js" type="text/javascript" ><!-- --></script>
<script src="/media/es/jobsite/js/landing.js" type="text/javascript" ><!-- --></script>
<script src="/media/es/jobsite/js/functions.js" type="text/javascript"><!-- -->    </script>
<script src="/media/es/jobsite/js/jobParsing.js" type="text/javascript" charset="utf-8"><!----></script>
<script src="/media/es/jobsite/js/queryNormilization.js" type="text/javascript" charset="utf-8"><!----></script>
<script src="${jsHost}/js/jquery/jquery.metadata.js" type="text/javascript" charset="utf-8"><!----></script>
<script src="${jsHost}/js/jquery/jquery.form.js" type="text/javascript" charset="utf-8"><!----></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.7/jquery.validate.min.js" type="text/javascript" charset="utf-8"><!----></script>
<script src="${jsHost}/js/jquery.i18n.properties-min.js" type="text/javascript" charset="utf-8"><!----></script>

<script type="text/javascript" charset="utf-8">

function updateBannerLink() {
    var s4 = location.hash.substring(1);
    $("#banner").attr('href','http://INTELATRACKING.ORG/?a=12240&amp;c=29258&amp;s4='+s4+'&amp;s5=^');
}

</script>
</head> 
```

不注意 JSP 变量，但正如您所见，我只调用了 functions.js 文件一次（这是 .ready 函数存在的地方）

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-23T20:04:52.467

就绪事件不能触发两次。很可能发生的情况是您的代码正在移动或操纵包含代码的元素，导致浏览器重新执行脚本块。

这可以通过在结束标记中`<head>`或之前包含脚本标记**而不**使用. 使用具有相同的效果。`</body>`**`$('body').wrapInner();``$('body').html($('body').html().replace(...));`**

 *** * *

## 回答 #2

> 赞同：42
> 
> 时间：2014-02-20T11:21:43.287

这也发生在我身上，但我意识到由于合并错误，该脚本被包含了两次。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2012-05-23T20:33:32.133

这发生在我使用 KendoUI 时...调用弹出窗口会导致`document.ready`事件多次触发。简单的解决方案是设置一个全局标志，使其只运行一次：

```
var pageInitialized = false;
$(function()
{
    if(pageInitialized) return;
    pageInitialized = true;
    // Put your init logic here.
}); 
```

这有点hack-ish，但它有效。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-02-26T23:33:12.743

确保您没有两次包含 JS 文件。那是我的情况

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-25T18:52:30.813

您可以考虑使用

```
window.onload 
```

代替

```
$(document).ready 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-23T20:21:07.313

尝试把它放在你的functions.js中以防止它被执行两次：

```
var checkit = window.check_var;
if(checkit === undefined){ //file never entered. the global var was not set.
    window.check_var = 1;
}
else {
    //your functions.js content 
} 
```

但是，我建议您仔细研究一下，看看您第二次打电话到哪里。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-03T08:58:24.837

当我尝试刷新部分时，我遇到了类似的问题。我调用了返回 ActionResult 而不是返回 PartialViewResult。ActionResult 导致我的 ready() 运行两次。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-25T13:37:19.007

当您在 html 中添加两次相同的控制器时，可能会遇到此问题。
例如：
[js]

```
app.controller('AppCtrl', function ($scope) {
 $(document).ready(function () {
        alert("Hello");
        //this will call twice 
    });
}); 
```

[html]

```
//controller mentioned for the first time
<md-content ng-controller="AppCtrl">
    //some thing
</md-content>

//same controller mentioned again 
<md-content ng-controller="AppCtrl">
    //some thing
</md-content> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-05-11T21:13:50.863

我今天有一个类似的问题。在我的情况下， A`<button type="submit">`导致`$(document).ready(...)`事件再次触发。更改代码`<button type="button">`为我解决了这个问题。

[提交按钮后再次调用 document.ready 函数](https://stackoverflow.com/questions/45632009/document-ready-function-called-again-after-submit-button "提交按钮后再次调用 document.ready 函数？")？在stackoverflow上了解更多细节。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-07-17T15:35:31.363

在我的情况下， $(document).ready 由于 CSS 错误而触发了两次，请检查您的 CSS 的任何部分是否有`background-image: url('');`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-24T11:35:06.983

如果 iframe 没有显示任何内容并且用于其他原因（例如上传文件而不重新加载），您可以执行以下操作：

```
<iframe id="upload_target" name="upload_target" style="width:0;height:0;border:0px solid #fff;"></iframe> 
```

请注意，不包含 src 会阻止文档上的第二个就绪触发器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-07T22:25:11.297

我在 window.load 函数执行了两次时遇到了这个问题：原因是因为我在主页中引用了相同的 javascript 文件以及 .net 用户控件。当我删除主页中的引用时，加载函数只执行了一次。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-03-06T12:02:30.477

今天早上我遇到了这种情况......在仔细检查了我最近操作的 jquery 模态表单中的一些 html 代码后，我发现我不小心删除了一个关闭表标记。我还没有花时间完全理解为什么会导致**document.ready 函数被调用两次**，但确实如此。添加结束表标签解决了这个问题。

jQuery JavaScript Library v1.8.3（是的，它是一个遗留应用程序）**

# python - 条件测试/回调机制

> ID：10727003
> 
> 赞同：1
> 
> 时间：2012-05-23T20:01:42.897
> 
> 标签：python, callback, conditional-statements

`True`我需要一个简单的类或函数，它接受一个测试（返回or的可调用对象`False`）和一个在测试时调用的函数`True`，可能在不同的线程中完成整个事情。像这样的东西：

```
nums = []
t = TestClass(test=(lambda: len(nums) > 5),
              func=(lambda: sys.stdout.write('condition met'))

for n in range(10):
    nums.append(n)
    time.sleep(1) 

#after 6 loops, the message gets printed on screen. 
```

任何帮助表示赞赏。（拜托，不要太复杂，因为我还是初学者）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:13:33.500

您认为您可能需要一个单独的线程来检查后台条件是正确的。在这个单独的线程中，您还必须决定要检查的频率（还有其他方法可以做到这一点，但这种方式需要对您显示的代码进行最少的更改）。

我的回答只是使用一个函数，但如果你愿意，你可以轻松地使用一个类：

```
from threading import Thread
import time
import sys    

def myfn(test, callback):

    while not test():  # check if the first function passed in evaluates to True
        time.sleep(.001)  # we need to wait to give the other thread time to run.
    callback() # test() is True, so call callback.

nums = []

t = Thread(target=myfn, args=(lambda: len(nums) > 5, 
           lambda: sys.stdout.write('condition met')))
t.start() # start the thread to monitor for nums length changing

for n in range(10):
    nums.append(n)
    print nums  # just to show you the progress
    time.sleep(1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:59:52.430

不完全确定您在问什么，但我认为这应该可以帮助您入门。

```
def test_something(condition, action, *args, **kwargs):
  if condition():
    action(*args, **kwargs)

def print_success():
  print 'Success'

def test_one():
  return True

test_something(test_one, print_success) 
```

# powershell - 句号 '.' 是什么意思？操作员在powershell中做什么？

> ID：10727006
> 
> 赞同：35
> 
> 时间：2012-05-23T20:01:51.300
> 
> 标签：powershell, syntax, operators

这是一个奇怪的问题。通常，当我从 powershell 执行外部命令时，我会使用这样的`&`运算符：

```
& somecommand.exe -p somearguments 
```

但是，今天我遇到了`.`这样使用的运算符：

```
.$env:systemdrive\chocolatey\chocolateyinstall\chocolatey.cmd install notepadplusplus 
```

在这种情况下，时间段的用途是什么？我不明白。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-09T20:51:09.370

这 ”。” [dot sourcing 运算符](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7#dot-sourcing-operator-)将发送和接收来自您调用的其他脚本的变量。“&”[调用运算符](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7#call-operator-)将​​只发送变量。

例如，考虑以下情况：

脚本 1 (call-operator.ps1):

```
clear

$funny = "laughing"

$scriptpath = split-path -parent $MyInvocation.MyCommand.Definition
$filename = "laughing.ps1"

"Example 1:" # Call another script. Variables are passed only forward.

& $scriptpath\$filename

"Example 2:" # Call another script. Variables are passed backwards and forwards.

. $scriptpath\$filename
$variableDefinedInOtherScript 
```

脚本 2 (laughing.ps1):

```
# This is to test the passing of variables from call-operator.ps1

"I am $funny so hard. Passing variables is so hilarious."

$variableDefinedInOtherScript = "Hello World!" 
```

创建两个脚本并只运行第一个。你会看到“。” 点源运算符发送和接收变量。

两者都有其用途，所以要有创意。例如，如果您想修改另一个脚本中的变量值，同时保留当前脚本中的原始值，“&”调用运算符会很有用。有点保障。;)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-07-16T10:47:20.780

**简而言之：** 它是一种特殊运算符，用于实现常规运算符无法实现的功能。这个特定的运算符`.`实际上有两个截然不同的特殊运算符用例。

**长：**

与任何其他语言、脚本或其他语言一样，PowerShell 脚本也支持许多不同类型的运算符来帮助操作值。这些常规运营商包括：

*   算术
*   任务
*   比较
*   逻辑的
*   重定向
*   项目清单
*   拆分和加入
*   类型
*   一元

但是，PowerShell 还支持所谓的**特殊运算符**，用于执行其他类型的运算符无法执行的任务。

这些**特殊运算符**包括：

*   `@()`数组子表达式运算符
*   `&`呼叫接线员
*   `[ ]`演员表操作员
*   `,`逗号运算符
*   `.`点源运营商
*   `-f`格式运算符
*   `[ ]`索引运算符
*   `|`管道操作员
*   `.`属性取消引用运算符
*   `..`范围运算符
*   `::`静态成员运算符
*   `$( )`子表达式运算符

`.` **点源运算符：**在此上下文中用于允许脚本在当前范围内运行，本质上允许将脚本创建的任何函数、别名和变量添加到当前脚本中。

**例子：**

```
. c:\scripts.sample.ps1 
```

**请注意**，特殊运算符的此应用`.`后跟一个空格，以将其与`.`表示当前目录的 ( ) 符号区分开来

**例子：**

```
. .\sample.ps1 
```

`.` **属性取消引用操作符：**允许访问一个对象的属性和方法，`.`通过指示字符左侧的表达式`.`是一个对象，而右侧的表达式是一个对象成员（属性或方法）。

**例子：**

```
$myProcess.peakWorkingSet  
(get-process PowerShell).kill() 
```

**免责声明和来源：**

在查看 PowerShell 脚本时，我遇到了同样的问题，我试图扩展其功能集并在研究答案时来到这里。但是，我设法使用Microsoft 开发网络上的[这篇精彩文章找到了我的答案，并辅以 IT Pro 对相同想法](https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/about/about_operators)[的](http://windowsitpro.com/powershell/windows-powershell-operators)进一步扩展。

干杯。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-23T20:05:46.883

点是呼叫运算符：

```
$a = "Get-ChildItem" 
. $a # (executes Get-ChildItem in the current scope) 
```

但是，在您的情况下，我看不到它的作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T20:08:57.140

.Period 或 .full stop 用于对象属性；喜欢

```
$CompSys.TotalPhysicalMemory 
```

见这里： http: [//www.computerperformance.co.uk/powershell/powershell_syntax.htm#Operators_](http://www.computerperformance.co.uk/powershell/powershell_syntax.htm#Operators_)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-13T17:26:46.153

这个答案是对 David Brabant 和他的评论者已经提供的答案稍加扩展。虽然这些言论都是真实和中肯的，但有些东西被遗漏了。

`&`调用外部命令时使用的 OP是不必要的。省略 the`&`不会有任何影响（以他的用法为例）。的目的`&`是允许调用名称为（字符串）表达式的值的命令。通过使用`&`上述内容，powershell 然后（基本上）将后续参数视为字符串，其中第一个是`&`适当调用的命令名称。如果`&`省略了，powershell 会将行中的第一项**作为**要执行的命令。

但是，`.`第二个示例中的**是**必要的（尽管正如其他人所指出的，`&`在这种情况下也可以正常工作）。没有它，命令行将以变量 access ( `$env:systemdrive`) 开头，因此 powershell 会期望某种形式的表达式。但是，紧随变量引用的是一个裸文件路径，它不是有效的表达式，会产生错误。通过在行首使用`.`（或`&`），它现在被视为一个命令（因为开头看起来不像一个有效的表达式）并且参数被处理为可扩展字符串（`" "`）。因此，命令行被视为

```
. "$env:systemdrive\chocolatey\chocolateyinstall\chocolatey.cmd" "install" "notepadplusplus" 
```

第一个参数已`$env:systemdrive`代入其中，然后`.`调用由此命名的程序。

注意：关于 powershell 如何处理命令行参数的完整描述比这里给出**的**要复杂得多。这个版本被缩减为回答问题所需的基本部分。查看[about_Parsing](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parsing?view=powershell-7.1)以获得全面的描述。它不完整，但应该涵盖大多数正常使用。在 stackoverflow 和 github（powershell 现在所在的位置）上还有其他帖子，涵盖了官方文档中未列出的一些看似古怪的行为。另一个有用的资源是[about_Operators](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7.1)，虽然这还不是很完整。一个例子是`.`，`&`当调用除 powershell 脚本/cmdlet 之外的其他东西时，根本没有提及。

# wpf - MultiValueConverter 的结果可以自己转换吗？

> ID：10727008
> 
> 赞同：1
> 
> 时间：2012-05-23T20:01:57.607
> 
> 标签：wpf, ivalueconverter, imultivalueconverter

我的 WPF 应用程序中有一个表单，我必须添加一个编辑按钮。现在，表单始终处于编辑模式，没有“查看模式”。但是，由于各种原因，我需要将控件保持在视图模式，直到用户单击编辑按钮，然后隐藏编辑按钮并在其位置显示一个保存按钮。

我的表单已经有一个`DependencyProperty`名为的布尔值`CanModify`，当用户的权限授予他们编辑表单中显示的记录的权利时，这是真的。我正在添加一个`DependencyProperty`名为的新布尔值`InEditMode`，默认为 false。隐藏和启用按钮非常简单，但是`ComboBox`如果用户无法编辑记录，或者如果他们可以编辑并且表单处于查看模式，我想隐藏这个控件。为此，我需要将两个布尔属性的 AND 运算结果一起转换，然后将其转换为一个`Visibility`值。

我已经有了一个实现`IValueConverter`bool 并将其转换为`Visibility`. 我刚刚编写了一个实现的类，该类`IMultiConverter`接受一个布尔数组并将它们与运算一起（或对它们进行运算，具体取决于参数的值）。

我想做的是获取结果`IMultiConverter`并通过`IValueConverter`将结果转换为`Visibility`. 我可以这样做吗？或者我最好在新的代码中执行 AND `DependencyProperty`？

托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T17:28:12.170

您确实可以链接转换器，我自己的示例尚未处理 MultiValueConverters 但实现`LinkedMultiValueConverter`. 这种方法的缺点之一是您必须重新创建当前必须使用提供的属性的任何转换器。

git://github.com/pmacn/ValueConverters.WP8.git

或者

[https://github.com/pmacn/ValueConverters.WP8](https://github.com/pmacn/ValueConverters.WP8)

然后你会做以下

```
<con:LinkedConverter x:Name="MyFancyLinkedConverter">
    <con:BooleanInversionConverter />
    <con:BooleanToVisibilityConverter />
</con:LinkedConverter> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:33:03.220

您不能链接转换器。

而是将您的 MultiValueConverter 更改为采用字符串参数“bool”或“visibility”。根据参数返回布尔或可见性对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T14:06:15.053

因为你不能链接转换器，所以我在我的类中添加了另一个布尔属性。我将方法添加到新属性所依赖的两个属性中，当它们发生变化时会调用它们。这些重新计算新属性的值。然后我使用我原来的布尔到可见性转换器来显示或隐藏有问题的控件。

# html - 在 Internet Explorer 上更改 href

> ID：10727011
> 
> 赞同：1
> 
> 时间：2012-05-23T20:02:16.970
> 
> 标签：html, internet-explorer, debugging, internet-explorer-9

如果有人使用 IE 打开它，我想更改我的 html 页面中的值“href”。起初我尝试使用按钮，但最终目标是没有它。

这就是我所拥有的：

```
 <script type="text/javascript">
function myFunction()
{
var oldHTML = document.getElementById('troca').href="http://player.vimeo.com/video/39640718?title=0&amp;byline=0&amp;portrait=0"
var newHTML = document.getElementById('troca').href="http://www.youtube.com/embed/VwjI7ICgcJ0?rel=0";
if (navigator.appName!='Microsoft Internet Explorer')
  {
  **//what action i have to put in here?**
  }
document.getElementById("troca").innerHTML=x;
}
</script>

</head>

<body>
<p>clique, se for internet explorer nao vai trocar nada!</p>

<button onclick="myFunction()">Troca</button>

<br/><br/>

<iframe id="troca" src="http://player.vimeo.com/video/39640718?title=0&amp;byline=0&amp;portrait=0" width="910" height="512" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>

</body> 
```

有人知道我必须在其中添加什么来更改代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:11:13.980

如果不想使用 JS，可以使用[条件注释：](http://davidwalsh.name/ie-conditional-comments)

```
<!--[if IE]> hello ie user! <![endif]-->
<![if !IE]>
hello non-ie user!
<![endif]> 
```

这是关于 IE 条件注释语法的[小提琴](http://jsfiddle.net/eXZYL/2/)和[另一个链接。](http://www.javascriptkit.com/howto/cc2.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:13:54.660

只需`document.getElementById('troca').src=`使用新值再次调用。只要知道浏览器可以而且确实会谎报他们的 appName。IE 往往是 Microsoft Internet Explorer，但几乎所有其他东西都被标识为 Netscape。

`iframe`s 没有一个`href`，只有一个`src`。

# java - 不同的集合取决于列值

> ID：10727012
> 
> 赞同：0
> 
> 时间：2012-05-23T20:02:17.527
> 
> 标签：java, sql, postgresql, mybatis

这是我为 MyBatis 配置的 XML 配置的一部分。

```
<sql id="selectElementWithAttributes">
    SELECT
    e.id as id,
    e.title as title,
    e.type as type,
    e.date as date,
    e.ownerid as ownerid,
    a.attributeid as attributeid,
    a.value as value,
    a.type as a_type
    FROM
    test_element as a
    LEFT JOIN
    test_elementattributes as a
    ON
    e.id
    = a.parentid
</sql> 
```

现在我使用 resultMap 将列映射到我的对象。

```
<resultMap type="Element" id="rmElement">
    <id property="id" column="id" />
    <result property="title" column="title" />
    <result property="type" column="type" />
    <result property="date" column="date" />
    <result property="ownerid" column="ownerid" />
    <collection property="attributes" ofType="Attribute">
        <id property="{id=parentid,attributeid=attributeid}" />
        <result property="key" column="attributeid" />
        <result property="value" column="value" />
    </collection>
</resultMap> 
```

问题是，我必须在我的 Element 对象中进行集合。两个集合都包含属性。区别在于属性的类型（映射到 a_type）。根据这种类型，我喜欢在集合 1 或集合 2 中使用属性。我玩弄了鉴别器，但并不真正理解我在做什么，它不起作用......

这是想法，但是如何根据 a_type 切换集合？

```
<resultMap type="Element" id="rmElement">
    <id property="id" column="id" />
    <result property="title" column="title" />
    <result property="type" column="type" />
    <result property="date" column="date" />
    <result property="ownerid" column="ownerid" />
    <collection property="attributes" ofType="Attribute">
        <id property="{id=parentid,attributeid=attributeid}" />
        <result property="key" column="attributeid" />
        <result property="value" column="value" />
    </collection>
    <collection property="attributesOther" ofType="Attribute">
        <id property="{id=parentid,attributeid=attributeid}" />
        <result property="key" column="attributeid" />
        <result property="value" column="value" />
    </collection>
</resultMap> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:52:59.780

从来没有用过这个东西，所以只是一个想法。修改查询返回两组属性，然后在读取端过滤掉NULL？

```
<sql id="selectElementWithAttributes">
    SELECT
    e.id as id,
    e.title as title,
    e.type as type,
    e.date as date,
    e.ownerid as ownerid,
    CASE WHEN a.type = 'attribute1' THEN a.attributeid ELSE NULL END as attribute1id,
    CASE WHEN a.type = 'attribute2' THEN a.attributeid ELSE NULL END as attribute2id,
    a.value as value,
    a.type as a_type
    FROM
    test_element as a
    LEFT JOIN
    test_elementattributes as a
    ON
    e.id
    = a.parentid
</sql> 
```

然后将您的两个不同的集合放在属性 1 和属性 2 的结果图中。两个集合都将获得完整的集合，但不属于集合的属性的值将为 NULL。或者，如果 NULL 是合法值，则使用不同的标志。如果有一种方法可以跳过将 NULL 放入集合中，那就更好了。

也许是一个愚蠢的建议，但谁知道呢？也许暗示不同的方法？[哦，除了显而易见的：创建两个查询]

# batch-file - 使用 Imagemagick 在批处理文件中减少太多图像

> ID：10727024
> 
> 赞同：0
> 
> 时间：2012-05-23T20:03:36.073
> 
> 标签：batch-file, imagemagick

我使用 ImageMagick 对图像执行命令行操作，例如调整大小、降低质量等。

但是，我遇到了这个脚本的问题：

```
SETLOCAL ENABLEDELAYEDEXPANSION
@echo off
REM Make the Modified folder, to store resized images. 
if not exist %CD%\Mod MKDIR %CD%\Mod

REM loop through all files in working directory with extensions of .bin
for /r %CD% %%G in (*.bin) do ( 
  set FILENAME=%%~nG

  echo !FILENAME!.bin conversion beginning...
  echo Beginning conversions...
  echo Convert to TIF

  REM rename the bin file with a .TIF extension. 
  copy !FILENAME!.bin  !FILENAME!.tif
  echo resizing image....
  REM convert the tif and resize it to 25%. This is where it reduces to almost nothing!
  convert !FILENAME!.tif -resize 25% !FILENAME!.tif
  echo Renaming file...
  REM rename file to say it had been modified
  ren !FILENAME!.tif !FILENAME!-mod.tif
  echo Copying file...
  REM copy the file to the Mod directory.
  copy /y !FILENAME!-mod.tif %CD%\Mod
  echo Cleaning up...
  REM cleanup.
  DEL !FILENAME!-mod.tif
  echo Moving on to next file...

) 
```

如果我从命令行运行调整图像大小的命令，它可以正常工作，并将图像减小到估计的大小。在脚本中，它缩小到非常小的尺寸，我们谈论的是从大约 2500x5000 降低到 25x25，或类似的东西。这真的很奇怪，因为我正在执行完全相同的语句，尽管方式不同。

我最初认为是 for 循环在起作用，但我逐步通过它，边走边暂停，并随着那一次执行调整大小，确保它不是 for 循环不断将图像大小调整 25% 直到它是太小了，不能走得更远。

为什么它减少这么小，我该如何解决？

编辑 1：它转换 bin 文件的原因是因为所有 BIN 文件实际上都是 TIF 文件，无论出于何种原因，这些文件都已使用 bin 扩展名重命名。它们实际上是图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:30:09.543

我猜你需要用另一个 % 来逃避 % 所以 25% 变成 25%%

# javascript - javascript通行证

> ID：10727025
> 
> 赞同：37
> 
> 时间：2012-05-23T20:03:38.053
> 
> 标签：javascript, python, exception, exception-handling

javascript中是否有类似于python'pass'的东西？

我想做的javascript相当于：

```
try:
  # Something that throws exception
catch:
  pass 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-05-23T20:06:28.347

[`pass`是 Python 中的空操作。](http://docs.python.org/release/2.5.2/ref/pass.html)你需要它来处理空块，因为

```
try:
    # Something that throws exception
catch:

# continue other stuff 
```

[是语法错误](http://ideone.com/W13ic)。在 JavaScript 中，您可以只使用一个空`catch`块。

```
try {
    // Something that throws exception
}
catch (e) {} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-05-23T20:06:35.090

有，这里是：

没错，什么都没有：

```
try {
    somethingThatThrowsAnException();
} catch (e) {
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-02T22:28:42.827

> 我想做的javascript相当于：
> 
> ```
> try:
>   # Something that throws exception
> catch:
>   pass 
> ```

Python 没有 try/catch。它有尝试/除外。所以用 替换`catch`，`except`我们会有这个：

```
try {
  //     throw any exception
} catch(err) {} 
```

catch 后面的空代码块相当于 Python 的`pass`.

**最佳实践**

然而，人们可能会对这个问题有一点不同的解释。假设您想采用与 Python 的 try/except 块相同的语义。Python 的异常处理更加细致入微，可以让您指定要捕获的错误。

实际上，仅捕获特定错误类型被认为是最佳实践。

因此，Python 的最佳实践版本是，因为您只想捕获准备处理的异常，并避免隐藏错误：

```
try:
    raise TypeError
except TypeError as err:
    pass 
```

您可能应该对适当的错误类型进行子类化，标准 Javascript 没有非常丰富的异常层次结构。我之所以选择`TypeError`它是因为它与 Python 的`TypeError`.

为了在 Javascript 中遵循相同的语义，我们首先[必须捕获所有错误](http://www.ecma-international.org/ecma-262/5.1/#sec-12.14)，因此我们需要对此进行调整的控制流。所以我们需要`pass`用 if 条件判断错误是否不是我们想要的错误类型。缺少 else 控制流是`TypeError`. 使用这段代码，理论上，所有其他类型的错误都应该浮出水面并被修复，或者至少被识别出来以进行额外的错误处理：

```
try {                                 // try:
  throw TypeError()                   //     raise ValueError
} catch(err) {                        // # this code block same behavior as
  if (!(err instanceof TypeError)) {  // except ValueError as err:
    throw err                         //     pass
  } 
} 
```

欢迎评论！

# encryption - 如何在 DNN 中加密用户配置文件

> ID：10727028
> 
> 赞同：0
> 
> 时间：2012-05-23T20:03:54.097
> 
> 标签：encryption, dotnetnuke

我是 DotNetNuke 的新手并使用 DNN 6.x。

我想加密用户配置文件中的所有数据，以便如果有人窃取数据库，他将无法使用我的用户配置文件。

是否有任何模块可用于执行此操作或替代模块是什么。

我遇到的一件事是 TDE，但 SQLServerExpress2008 不支持此功能。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:10:02.557

如果您不打算使用 SQL Server Enterprise 之类的东西，您将不得不自己编写一个用户提供程序（或让承包商为您完成），为您进行加密和解密。

加密用户数据可能是一项艰巨的任务，并且根据您的操作方式，该过程可能会给您的系统带来负担。我会仔细考虑您是否真的需要加密数据。也许您可以致电另一个对活动目录等配置文件更安全的提供商。

# php - 如何从会话中读取值

> ID：10727032
> 
> 赞同：0
> 
> 时间：2012-05-23T20:04:07.430
> 
> 标签：php, session, server-side

每次用户登录时，我的 Web 应用程序都会设置会话。我检查了会话是否在[http://mydomain.com/sessionfolder](http://mydomain.com/sessionfolder)目录中正确设置。但我无法获得这些会话值。

例如，在根目录 ('/') 中的 'member_check.php' 中，

```
echo "Your name is = ".$_SESSION['membername']; 
```

我得到**'你的名字是（空白）'**

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:45:22.003

您是否尝试过手动设置会话保存路径？当我使用学校提供的服务器时，由于服务器上的一些设置，我总是必须自己设置它。

以下行应包含在`session_start();`

`session_save_path('your_path_here');`

不要忘记创建文件夹并将文件夹权限设置为每个人都可以读取和写入..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:49:17.610

在脚本的顶部，您必须初始化会话：

```
if ( ! session_id())
{
    session_start();
} 
```

# python - django cmsplugin-blog 用 whoose 搜索 haystack 的索引

> ID：10727040
> 
> 赞同：2
> 
> 时间：2012-05-23T20:05:13.793
> 
> 标签：python, django, search, django-haystack, django-cms

我想用 cmsplugin-blog 为一个简单的 django cms 主页添加搜索功能。

但是只有与 django-cms-facetsearch 一起使用的搜索索引。但是 facetsearch 需要 solr，我不想只为几个 cms-pages 和 blogentries 运行 solr 服务器。我只想将 haystack 与 whoosh 一起使用，因为它的配置非常简单。

cmsplugin-blog 模型是否有多语言搜索索引？还是我必须自己写？

感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:28:53.087

对于使用 haystack、django-cms、cmsplugin-blog 和其他一些应用程序的设置，我也遇到了同样的问题。

我刚刚为 cmsplugin-blog 和 haystack 创建了一个自定义搜索索引，灵感来自 django-cms-search 中用于常规 CMS 页面的索引。看看它，它可以帮助您创建自己的。

```
from haystack import indexes
from haystack import site
from cmsplugin_blog.models import Entry, EntryTitle
from cms.models.pluginmodel import CMSPlugin
from django.utils.encoding import force_unicode
import re

def _strip_tags(value):
    """
    Returns the given HTML with all tags stripped.

    This is a copy of django.utils.html.strip_tags, except that it adds some
    whitespace in between replaced tags to make sure words are not erroneously
    concatenated.
    """
    return re.sub(r'<[^>]*?>', ' ', force_unicode(value))

class BlogIndex(indexes.SearchIndex):
    text = indexes.CharField(document=True)
    url = indexes.CharField(stored=True, indexed=False, model_attr='get_absolute_url')
    title = indexes.CharField(stored=True, indexed=False)
    pub_date = indexes.DateTimeField(model_attr='pub_date', null=True)

    def get_model(self):
        return Entry

    def index_queryset(self):
        """Used when the entire index for model is updated."""
        return self.get_model().objects.filter(is_published=True)

    def prepare_title(self, obj):
        return EntryTitle.objects.filter(entry=obj)[0]

    def prepare_text(self, obj):
        title = EntryTitle.objects.filter(entry=obj)[0]
        placeholder_plugins = CMSPlugin.objects.filter(placeholder__in=obj.placeholders.all())
        text = force_unicode(title)
        plugins = list(placeholder_plugins)
        for base_plugin in plugins:
            instance, plugin_type = base_plugin.get_plugin_instance()
            if instance is None:
                # this is an empty plugin
                continue
            if hasattr(instance, 'search_fields'):
                text += u' '.join(force_unicode(_strip_tags(getattr(instance, field, ''))) for field in instance.search_fields)
            if getattr(instance, 'search_fulltext', False) or getattr(plugin_type, 'search_fulltext', False):
                text += _strip_tags(instance.render_plugin(context=RequestContext(request))) + u' '
        return text

site.register(Entry, BlogIndex) 
```

稍后我会考虑在 github 上放一个带有此搜索索引的防弹版本的 cmsplugin-blog 的分支。在有帮助的地方随意使用它。

# asp-classic - 在空行上报告错误

> ID：10727047
> 
> 赞同：-1
> 
> 时间：2012-05-23T20:05:38.273
> 
> 标签：asp-classic, vbscript

今天下午我真的很难过，做了很多搜索都无济于事。我收到错误

“对象不支持此属性或方法 /admin/Upload1_20120508JB.asp，第 91 行”

从以下代码：

```
 90 wf = fso2.CreateTextFile(sWriteFilePath)
        91 
        92 If fso1.FileExists(sReadFilePath) Then ... 
```

第 91 行为空白，第 90 行按预期工作，文件在正确的位置创建。有没有人见过这样的事情？如果是这样，解决方案是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:09:21.350

将对象分配给变量时，必须使用**Set 。**

（请参阅[此处](https://stackoverflow.com/q/10725000/603855)了解今天对于 VBScript 的此功能来说是糟糕的一天。）

# android - isSessionValid() 返回 true，实际上不是

> ID：10727057
> 
> 赞同：1
> 
> 时间：2012-05-23T20:06:52.543
> 
> 标签：android, facebook, facebook-opengraph, facebook-android-sdk

嘿奇怪的问题在这里。

我正在检查用户是否是有效的 access_token，如果不是我授权。现在我正在使用这段代码：

```
 mPrefs = getSharedPreferences("Facebook", MODE_PRIVATE);
        String access_token = mPrefs.getString("access_token", null);
        long expires = mPrefs.getLong("access_expires", 0);
        if(access_token != null) {
            facebook.setAccessToken(access_token);
        }
        if(expires != 0) {
            facebook.setAccessExpires(expires);
        }

        if(!facebook.isSessionValid()) {
            // preform authorize dialog

            }
            else
            {
             //break into pentagon
            } 
```

并`isSessionValid()`返回它是有效的。之后我向 Open Graph 发出请求，该请求返回：

```
 {"error":{
"type":"OAuthException",
"message":"Error validating access token: Session has expired at unix time 1337364000.
 The current unix time is 1337802012.",
"error_subcode":463,
"code":190}} 
```

这让我很困惑。 [这个](https://stackoverflow.com/a/8647062/1026199)答案建议提问者使用过时的 SDK 源，这在我的情况下**不是**问题。

所以我检查了 Facbook SDK 的源代码，这是方法：

```
 public boolean isSessionValid() {
    return (getAccessToken() != null) &&
            ((getAccessExpires() == 0) ||
                    (System.currentTimeMillis() < getAccessExpires()));
} 
```

这让我认为这与我在模拟器上运行应用程序的事实有关，因为它的时间与实际时间不同，但这对我来说没有意义，也许我错了，如果我'我错了，这就是问题我该如何解决？

如果不是，有谁知道可能导致此问题的原因？

# ruby - 为什么 Rails 生成器不为特定模型创建属性和方法？

> ID：10727058
> 
> 赞同：1
> 
> 时间：2012-05-23T20:06:54.453
> 
> 标签：ruby, ruby-on-rails-3, attributes, generator, sti

我的应用程序中有两个使用 STI 的模型：Entry 和 Sugar，它们非常简单。

参赛作品：

```
# == Schema Information
#
# Table name: entries
#
#  id         :integer         not null, primary key
#  created_at :datetime        not null
#  updated_at :datetime        not null
#  user_id    :integer
#  type       :string(255)
#

class Entry < ActiveRecord::Base
  # attr_accessible :title, :body
  belongs_to :user
end 
```

糖（请注意注释宝石中缺少`amount`架构信息）：

```
# == Schema Information
#
# Table name: entries
#
#  id         :integer         not null, primary key
#  created_at :datetime        not null
#  updated_at :datetime        not null
#  user_id    :integer
#  type       :string(255)
#

class Sugar < Entry
  attr_accessible :amount
end 
```

我通过运行创建了 Sugar 模型`rails g model Sugar amount:integer`，然后将其编辑为 Entry 模型的子类。生成的迁移创建了一个金额列：

```
class CreateSugars < ActiveRecord::Migration
  def change
    create_table :sugars do |t|
      t.integer :amount

      t.timestamps
    end
  end
end 
```

该列存在于我的数据库中：

```
bridges_development=# \d sugars
                                     Table "public.sugars"
   Column   |            Type             |                      Modifiers                      
------------+-----------------------------+-----------------------------------------------------
 id         | integer                     | not null default nextval('sugars_id_seq'::regclass)
 amount     | integer                     | 
 created_at | timestamp without time zone | not null
 updated_at | timestamp without time zone | not null
Indexes:
    "sugars_pkey" PRIMARY KEY, btree (id) 
```

但是，“数量”属性和/或方法似乎不存在。这是一个例子：

```
1.9.2-p290 :002 > s.amount = 2
NoMethodError: undefined method `amount=' for #<Sugar:0xb84041c> (...)

1.9.2-p290 :003 > s = Sugar.new(:amount => 2)
ActiveRecord::UnknownAttributeError: unknown attribute: amount (...) 
```

为什么不提供`amount`属性和相关方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:21:48.533

当您从使 rails 使用 STI（单表继承）的条目中继承糖时

在此方案中，所有类都存储在基类的表（条目）中，类型列存储子类的名称。因为它们都共享同一张表，所以它们也共享相同的属性：根本不会使用sugars 表

如果你不想要这个，你可以让 entry 成为一个抽象类

```
class Entry < ActiveRecord::Base
  self.abstract_class = true
end 
```

在这种情况下，将没有条目表，但会有一个糖表（并且每个条目的其他子类都有一个）。

另一种方法是将Entry 和Sugar 应该共享的代码放入一个模块中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:21:16.627

STI 的想法是 N 个模型 - 1 个表。`Sugar`实际上是访问表`entries`，没有属性`amount`。

# java - JUnit 断言数组在不相等时是相等的

> ID：10727060
> 
> 赞同：3
> 
> 时间：2012-05-23T20:07:00.320
> 
> 标签：java, arrays, junit

我有一个正在使用 JUnit 测试的合并排序函数。以下是我的一个测试用例：

```
@Test
    //test using randomly generated numbers
    public void MergeSortTest002()
    {
        long seed = System.currentTimeMillis();
        Random rng = new Random(seed);
        Integer[] TestArray = new Integer[1000];
        int MAX_VALUE = Integer.MAX_VALUE;

        for(int i=0; i<1000; i++) {
            //this will generate positive and negative numbers from
            // -MAX_VALUE/2 to +MAX_VALUE/2
            Integer newNum = rng.nextInt(MAX_VALUE/2) - MAX_VALUE;
            TestArray[i] = newNum;
        }

        Integer[] correctArray = TestArray;
        Arrays.sort(correctArray);
        MergeSort.mergeSort(TestArray);

        Assert.assertArrayEquals(correctArray,TestArray);
    } 
```

奇怪的是，即使我注释掉调用`mergeSort`函数的行，测试仍然通过。

我认为正在发生两件事之一：要么`assertArrayEquals`不关心元素的顺序（不太可能），当我复制`TestArray`到时`correctArray`，它是通过引用复制的，因此调用`Arrays.sort`也是`correctArray`排序`TestArray`。

谁能确认两者中的哪一个正在发生，解决方案应该是什么？是否有一种`Assert`记住顺序的方法，或者有没有一种方法可以在不编写显式 for 循环的情况下按值复制数组而不是引用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T20:09:21.810

问题就在这里：

```
Integer[] correctArray = TestArray; 
```

您正在复制对数组的*引用*，而不是数组的*内容*。

要修复，将该行更改为：

```
Integer[] correctArray = TestArray.clone(); 
```

# javascript - jQuery fx 速度是不同的速度

> ID：10727061
> 
> 赞同：0
> 
> 时间：2012-05-23T20:07:00.570
> 
> 标签：javascript, jquery

我知道这类似于另一个堆栈溢出帖子，但它没有回答我的问题[jquery .animate different speed](https://stackoverflow.com/questions/1902027/jquery-animate-different-speeds)

这是我的js

```
$.fx.speeds._default = 1000;

$(function () {
    $("#tabs").tabs();
});

function social() {
    $(document).ready(function () {
        $(".info7").hide();
        $("#social_media").show("fade");
        $("#hide").show();
    });
}

function social_hide() {
    $(document).ready(function () {
        $(".info7").show();
        $("#social_media").hide("fade");
        $("#hide").hide();
    });
}

<!--
if (screen.width <= 800) {
    document.location = "iphone-website.php";
}
//-->

//tipsy popup code

$(function () {
    $('.info').tipsy({fade:true, gravity:'s', fallback:"Use the different search engines to find what you're looking for, These search engines search leagucraft.com and mobafire.com for the information you need."});
    $('.info2').tipsy({fade:true, gravity:'s', fallback:"Click this to open the search engine box in another window."});
    $('.info3').tipsy({fade:true, gravity:'s', fallback:"You can put your user name here instead."});
    $('.info4').tipsy({fade:true, gravity:'s', fallback:"League of Legends InfoMatic Blog."});
    $('.info5').tipsy({fade:true, gravity:'s', fallback:"League of Legends InfoMatic Facebook page."});
    $('.info6').tipsy({fade:true, gravity:'s', fallback:"This website is mobile browser friendly!"});
    $('.info7').tipsy({fade:true, gravity:'s', fallback:"Click here to show the social media buttons."});
    $('.info8').tipsy({fade:true, gravity:'s', fallback:"Click here to hide the social media buttons."});
});

function init() {
    $(document).ready(function () {
        $("body").show("fade");
    });
} 
```

出于某种原因，即使我把 $.fx.speeds._default = 1000; 在每个 jquery 函数或 w/e 背后，它们的速度仍然不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:11:52.220

动画使用计时器来避免阻塞 UI 并模拟“异步事件”。

根据[J.Resig 的帖子](http://ejohn.org/blog/how-javascript-timers-work/)

> 如果计时器被阻止立即执行，它将被延迟到下一个可能的执行点（这将比所需的延迟更长）。

因此，计时器*并不精确*

# security - 绕过选择数字证书并向用户显示密码提示

> ID：10727063
> 
> 赞同：3
> 
> 时间：2012-05-23T20:07:03.740
> 
> 标签：security, authentication, smartcard, digital-certificate, cac

我现在正在使用 ac#.net 应用程序，通过允许用户选择他们的数字证书并输入他们的密码，我的智能卡身份验证工作正常。但是，我想取消允许用户选择他们的证书并自动为他们选择一个证书（每个用户都有相同的证书）。这样一来，当用户尝试进入该站点时，他们只会看到一个 pin 提示。关于如何去做这件事的任何想法？所有与我一起工作的用户都使用 Internet Explorer 7，并拥有带有 ActivIdentity 和 Tumbleweed 的工作站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T04:27:57.847

编写一个 Java 小程序以使用 PKCS#11 包装器在客户端完成这项工作，或者，如果您可以限制用户使用 IE，则创建并使用 ActiveX。我已经做到了。对于 ActiveX，您必须对其进行数字签名才能将其声明为安全的 ActiveX。

这不是直接的任务，但我发现 Java 小程序更容易实现。缺点是 JRE（Java 运行时环境）应该已经安装在客户端并且可以很好地与浏览器配合使用。用户还必须在第一次运行时授予小程序连接到他的智能卡的权限。

# java - 从 XStream 中的父 List<> 对象生成的删除/替换/组合标签

> ID：10727067
> 
> 赞同：0
> 
> 时间：2012-05-23T20:07:29.953
> 
> 标签：java, serialization, xml-serialization, xstream

我正在使用 XStream 将 java 对象转换为对应的 XML。

一个这样的对象包含一个`List<Window> windows`变量，该变量在生成时显示：

```
<windows>
    <Window>
                  <WindowType>Monthly</WindowType>
                  <WindowBegin>
                    <Month>null</Month>
                    <Day>null</Day>
                  </WindowBegin>
                  <WindowEnd>
                    <Month>null</Month>
                    <Day>null</Day>
                  </WindowEnd>
    </Window>
    <Window>
    ....
    </Window>
</windows> 
```

我想知道是否可以阻止生成 List<> 父标记，如下所示：

```
 <Window>
                      <WindowType>Monthly</WindowType>
                      <WindowBegin>
                        <Month>null</Month>
                        <Day>null</Day>
                      </WindowBegin>
                      <WindowEnd>
                        <Month>null</Month>
                        <Day>null</Day>
                      </WindowEnd>
        </Window>
        <Window>
        ....
        </Window> 
```

[此问题](https://stackoverflow.com/questions/8754807/remove-xml-tag-during-xstream-parsing)使用 string.replace，但如果此列表位于另一个需要清理的对象中，则会在 xml 中留下空白。速度是重中之重，所以如果可能的话，我在 XStream 内部寻找一种方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:41:58.577

可能我没有正确表达问题，但我找到的解决方案（通过 XStream）并没有完全删除标签，而是使用隐式命名将父标签与其子标签结合起来。感谢[@Blaise Doughan 的](https://stackoverflow.com/users/383861/blaise-doughan)优秀[教程](http://blog.bdoughan.com/2010/10/how-does-jaxb-compare-to-xstream.html)。

前任）

列表窗口；将序列化为：

```
<windows>
    <Window>
                  <WindowType>Monthly</WindowType>
                  <WindowBegin>
                    <Month>null</Month>
                    <Day>null</Day>
                  </WindowBegin>
                  <WindowEnd>
                    <Month>null</Month>
                    <Day>null</Day>
                  </WindowEnd>
    </Window>
    <Window>
    ....
    </Window>
</windows> 
```

但补充：

```
@XStreamImplicit(itemFieldName="Window")
List<Window> windows; 
```

将序列化为：

```
 <Window>
                      <WindowType>Monthly</WindowType>
                      <WindowBegin>
                        <Month>null</Month>
                        <Day>null</Day>
                      </WindowBegin>
                      <WindowEnd>
                        <Month>null</Month>
                        <Day>null</Day>
                      </WindowEnd>
        </Window>
        <Window>
        ....
        </Window> 
```

# jquery - 切换 背景图片

> ID：10727070
> 
> 赞同：0
> 
> 时间：2012-05-23T20:07:34.447
> 
> 标签：jquery, css, class, html-lists, background-image

我有一个带有 LI 项目的 UL，这些项目构成了我的链接。每个链接都有一个“linkItem”类和“roomActive”或“roomInactive”来显示适当的 BG 图像，以及传递给我的函数以显示单击了哪个 LI 项目的 ID。

我正在尝试使用以下代码来完成此操作。

```
$(".roomLink")[id].removeClass('roomActive').addClass('roomInactive'); 
```

当我运行它时，我得到一个错误，上面写着“Uncaught TypeError: Object # has no method 'removeClass'”

我还尝试使用 jQuery .css("background") 并返回“Uncaught TypeError: Object # has no method 'css'”

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:09:37.947

尝试如下，

```
$(".roomLink").eq(id).removeClass('roomActive').addClass('roomInactive'); 
```

**假设** `id`是`li`你想要removeClass 和addClass 的索引。这个假设是基于你使用它的方式。（如索引）

您的代码`$(".roomLink")[id]`是一个 dom 对象，它没有`addClass/removeClass`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:10:02.423

尝试`$($(".roomLink")[id]).removeClass`.....它可能会说，因为当您索引对象数组时返回的不是 jquery 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:10:11.640

如果元素上有 id，则按 id：

```
$("#" + id).removeClass('roomActive').addClass('roomInactive'); 
```

但是如果你将点击处理程序直接绑定到 li 那么你可以这样做：

```
$(".roomLink").click(function(){ 
    $(this).removeClass('roomActive').addClass('roomInactive');
}); 
```

你可以像这样玩css：

```
$(this).css("background-image","url(imageurl)"); 
```

您需要传递 css 属性名称和值，就像您将其放在样式表中一样

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:10:24.873

当您访问一个元素时，`[]`您返回的是 DOM 元素，而不是 jQuery 对象。改为尝试`eq(id)`（假设 id 是索引）。

如果您在单击另一个链接时尝试切换类，那么这样的方法效果很好。

```
$('li').click( function() {
    //swap inactive class in for currently active link item
    $('li.active').removeClass('active').addClass('inactive');
    //add active class to the clicked one
    $(this).removeClass('inactive').addClass('active');
}); 
```

# php - PHP 表单提交未定义的值

> ID：10727071
> 
> 赞同：2
> 
> 时间：2012-05-23T20:07:39.597
> 
> 标签：php, html, forms

就像我的标题所说，我的电子邮件表单在电子邮件中提交“未定义”。让我从一些代码开始......

HTML：

```
<form action="contactform.php" method="post" enctype="multipart/form-data" name="contact">
        <input name="name" type="text" value="Name" onfocus="if(this.value=='Name') this.value='';" />
        <input name="email" type="text" value="Email address" onfocus="if(this.value=='Email address') this.value='';" />
        <input name="phonemodel" type="text" value="Phone model" onfocus="if(this.value=='Phone model') this.value='';" />
        <textarea name="comments" cols="" rows="" style="height:130px;" onfocus="if(this.value=='Type your message here.') this.value='';" >Type your message here.</textarea>
        <input type="image" name="button" value="Submit" src="../media/btn_play_submit.png" style="margin-right:5px; margin-top:12px;" />
</form> 
```

PHP：

```
<?php
  if(isset($_POST['name'])) {

    $to = 'MYEMAILHERE';
    $headers = "From: blahblahblah\r\n";
    $subject = "Online Contact Submission Received\r\n";

    $name = $_POST['name'];
    $email = $_POST['email'];
    $phone = $_POST['phonemodel'];
    $comments = $_POST['comments'];

    $message .= "Name: " . $name . "\r\n";
    $message .= "Email: " . $email . "\r\n";
    $message .= "Phone Model: " . $phone . "\r\n";
    $message .= "Comments: " . $comments . "\r\n";

    mail($to, $subject, $message, $headers);
  }
?> 
```

我收到的电子邮件看起来像这样（是的，我在字段中输入了文本......）：

```
Name: undefined
Email: undefined
Phone Model:
Comments: undefined 
```

我注意到的第一件事：“电话模型”不像其他人那样说“未定义”。其次，为什么其他人说未定义而不是我输入的文字？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T20:16:43.710

尝试改变

`$message .= "Name: " . $name . "\r\n";`

到

`$message = "Name: " . $name . "\r\n";`

编辑：下面的示例：

```
if(isset($_POST['name'])) {
    var_dump($_POST);
    exit; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:23:47.217

尝试删除标题和主题后的换行符“\r\n”，它们可能与邮件功能有关。

```
$headers = "From: blahblahblah\r\n";
$subject = "Online Contact Submission Received\r\n"; 
```

到：

```
$headers = "From: blahblahblah";
$subject = "Online Contact Submission Received"; 
```

如果不这样做，转储您的 $_POST 数组并检查它是否获取表单处理程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:37:24.313

首先简单地打印这些变量以缩小问题范围。当它没有正确打印时。尝试使用 GET 代替 $_POST['xxx'] -> $_GET['xxx'], method='post' -> method='get' 当然这不是你想要的，只是为了确保。

网络服务器中有一些选项可以禁用 GET 和/或 POST。您是否在新的未配置服务器上进行测试？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T20:40:12.313

## 更新

看来您正在使用 HTML 和 PHP 以外的东西来运行您的网站/表单。在您的脚本之前，是否有任何其他库（无论是 PHP 还是 Javascript）可能会触及这个问题？

## 原来的

除非您按照[文档](http://www.w3.org/TR/html4/interact/forms.html#h-17.13.3.3)提交，否则您应该将表单更改`enctype`为。`application/x-www-form-urlencoded``files, non-ASCII data, and binary data`

`multipart/form-data`否则会给你奇怪的行为。至少，这是我明确的经验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-24T05:48:54.090

除了上述所有解决方案，您还可以`placeholder="text you want to display"`使用`onfocus="if(this.value=='Name') this.value='';"`. 那里的值可能出了问题....

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T19:28:27.987

修复。事实证明，在使用 PHP 之前，它通过了一些 jQuery 和 AJAX，这是导致我所有问题的原因。

这就是当你被投入到一个项目并且不太理解它时会发生的事情。：/

谢谢大家。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-09T16:45:16.873

当您引用本地文件时，请按以下顺序放置这些引用：

*   移动端 CSS

    jQuery核心的JS

    jQuery 移动端的 JS。

不合适会导致这个错误

**正确**：

```
<script src="jquery-1.7.1.min.js"> 
 <script type="text/javascript" src="jq-all-debug.js"> 

        <script src="jquery.mobile-1.1.1.min.js"> 
```

**错误**：

```
 <script src="jquery-1.7.1.min.js"> 

<script src="jquery.mobile-1.1.1.min.js"> 

                <script type="text/javascript" src="jq-all-debug.js"> 
```

# jquery - JQuery/Flash：使用 .swf 和 JQuery 屏幕移动 div 时不会更新

> ID：10727075
> 
> 赞同：0
> 
> 时间：2012-05-23T20:08:27.357
> 
> 标签：jquery, flash

我有一个持有 swf 的容器 div。如果我使用以下方法移动它：

```
$("#flashDivContent").css('top','618px'); 
```

除非我做一些强制重绘的事情，比如调整浏览器的大小，否则什么都不会发生。然后它跳到它应该跳的地方。如果我使用最有效的动画，但是除非我执行调整浏览器大小之类的操作，否则它不会移动到动画的最后一步。似乎浏览器不会在不调整浏览器大小的情况下重绘 Flash 播放器。有什么方法可以强制重绘或欺骗浏览器认为它需要重绘？

# 更新

这是功能。有两个部分。它需要一个布尔值。如果布尔值为真，则 Flash div 会在屏幕外显示动画。如果它是假的，那么闪光灯应该只是跳出屏幕。

```
var status = "flash";
function toggleFlex(animate){
if(status=="flash"){
    status="unity";
    if(animate){
        $("#flashDivContent").animate({top:'618px'},1000,function(){
            //Animate Done
        });
    } else {
        $("#flashDivContent").css({'top':'618px'});
            //Animate Done
        });
    }
} else {
    status="flash";
    if(animate){
        $("#flashDivContent").animate({top:'0px'},1000,function(){
            //Animate Done
        });
    } else {
        $("#flashDivContent").css({'top':'0px'});
            //Animate Done
        });
    }
} 
```

}

# sql - 使用某种范围功能的 SQL 查询 - 将下拉增量值匹配到数据库

> ID：10727076
> 
> 赞同：0
> 
> 时间：2012-05-23T20:08:30.467
> 
> 标签：sql, select, range, option, between

不知道解决这个难题时要搜索什么。不问世界……只问方向，除非你觉得很慷慨。这将非常难以解释。

我的网站有带有测量值的下拉菜单。选择宽度 x 高度下拉列表时，它会检查数据库的价格。目前，宽度和高度在数据库中是特定的，例如 24、28、32、36。所以我只是将查询循环中的测量值拉到我的列表中……瞧，它匹配并回显价格……但是……

现在我发现列出的测量值需要以 1" 为增量。所以，我只有一个包含特定测量值的数据库，但我需要整个测量范围。

我真的必须进入数据库并手动输入 24 英寸、25 英寸、26 英寸、27 英寸......的相同价格以及 28 英寸、29 英寸、30 英寸、31 英寸......的相同价格吗？这次做几百种产品？

或者是否有一个 SQL 技巧允许我选择最小和最大测量值，在下拉列表中列出它们，然后匹配那些 1" 增量测量值之一，这与 DATABASE 所说的不完全一样......但介于两者之间（例如) 24" 和 28"。

希望这不会太令人困惑，谢谢。

多亏了 Gordon，这比预期的要容易得多。我把它弄得比它应该做的更复杂。

有效的代码：

```
SELECT * FROM price_dimensions WHERE prodid = '".$_POST['prodid']."' AND height >= '".$_POST['heightX']."' AND width >= '".$_POST['widthX']."' ORDER BY height ASC, width ASC LIMIT 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:22:39.160

`between`只要您更改表结构，它确实与. 您的问题基本上是您有一个值，您需要找出它介于哪两个值之间。

反过来，这意味着您需要在数据库中存储*两个*值，最小值和最大值。以您的示例为例，您的表格可能如下所示：

```
+------------+-----------+------------+-------+
| 产品编号 | 最小值 | 最大值 | 价格 |
+------------+-----------+------------+-------+
| 1 | 24 | 27 | 75.13 |
| 1 | 28 | 31 | 83.55 |
+------------+-----------+------------+-------+
```

您需要对`product_id, min_value`. 您还需要确保每个相同的`product_id`存在`max_value`不少于等于任何。`min_value``productid`

然后，您选择数据的查询将变为：

```
select price
  from my_table
 where product_id = :product_id
   and :value between min_value and max_value 
```

顺便说一句，您之前可能不需要循环。如果可能，请始终在单个查询中执行某些操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:31:00.870

我想你可以只插入你想要的行。这是一些伪代码：

```
insert into t
    select t.width+1, price
    from t

insert into t
    select t.width+2, price
    from t

insert into t
    select t.width+3, price
    from t 
```

如果价格确实相同，您也许可以只查询最接近的值，小于或等于或大于或等于给定的宽度。

# asp.net-mvc - 5 分钟后 IE 超时

> ID：10727077
> 
> 赞同：0
> 
> 时间：2012-05-23T20:08:33.770
> 
> 标签：asp.net-mvc, internet-explorer, http, networking, httpresponse

我们有一个 Web 应用程序，它进行一些计算并将文件返回给客户端。当计算时间少于 5 分钟时，在 IE 和 Chrome 上一切正常，我们得到文件，但如果计算时间超过 5 分钟，IE 超时并显示“Internet Explorer 无法显示网页”消息，Chrome 继续运行并最终得到来自服务器的文件。

我尝试更改注册表设置，例如 WinInet 的 KeepAliveTimeout、ReceiveTimeout、ServerInfoTimeout，但没有帮助。单击“诊断连接问题”按钮显示“Windows 收到一条 HTTPerror 消息：403（禁止）来自”消息，我认为这是因为它尝试在没有凭据的情况下再次访问该站点并失败。使用 fiddler 时，请求以 504 状态终止并显示此消息“ReadResponse() failed: The server did not return a response for this request.” 有趣的是，我曾经观察到，如果 Fiddler 正在运行，即使 Chrome 也会超时（虽然还没有通过重新运行来验证这一点。）

这是一个使用 MVC 框架的 ASP.Net Web 应用程序。

我花了相当多的时间，但还没有找到解决方案。任何有用的指针都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:11:00.997

从[KB181050](http://support.microsoft.com/kb/181050)

> 您通常可以将长流程分解成更小的部分。或者，服务器可以返回状态数据以更新用户有关该过程的信息。另外，您可以创建一个基于消息或异步方式的长服务器进程，以便在提交作业后立即返回给用户，然后在长进程完成后通知用户。

换句话说，创建一个并在服务器接受请求后立即用“处理”值`<div>`填充它。然后，每当您完成处理时`<div>`，使用 ajax 或 javascript 更新结果。`<div>`

# sbt - “传递解析器”如何与 SBT 一起使用？

> ID：10727079
> 
> 赞同：7
> 
> 时间：2012-05-23T20:08:37.600
> 
> 标签：sbt, ivy

我有以下项目构建：

```
import sbt._
import Keys._

object ProjectBuild extends Build {

  val buildVersion = "0.1-SNAPSHOT"

  val delvingReleases = "Delving Releases Repository" at "http://development.delving.org:8081/nexus/content/repositories/releases"
  val delvingSnapshots = "Delving Snapshot Repository" at "http://development.delving.org:8081/nexus/content/repositories/snapshots"
  val delvingRepository = if (buildVersion.endsWith("SNAPSHOT")) delvingSnapshots else delvingReleases

  lazy val root = Project(
    id = "basex-scala-client",
    base = file(".")
  ).settings(

    organization := "eu.delving",
    version := buildVersion,

    resolvers += "BaseX Repository" at "http://files.basex.org/maven",

    libraryDependencies += "org.basex"  %     "basex" % "7.2.1",
    libraryDependencies += "org.specs2" %%    "specs2" % "1.7.1" %  "test",

    publishTo := Some(delvingRepository),

    credentials += Credentials(Path.userHome / ".ivy2" / ".credentials"),

    publishMavenStyle := true
  )

} 
```

当我将生成的库包含在另一个项目中时，如下所示：

```
 "eu.delving"         %% "basex-scala-client"         % "0.1-SNAPSHOT" 
```

我尝试构建该项目，我收到一个错误提示我找不到该项目引用的“org.basex % basex % 7.2.1”库。

我必须去“客户端”项目中添加解析器才能找到库。有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-18T16:31:28.730

没有传递解析器，因此构建用户需要知道所有传递库依赖项的所有解析器。这种方法的好处是，在开源项目上，它鼓励项目发布到与已知解析器相连的已知存储库之一。

对于企业使用，您可以防止您的流量流向图中某些依赖项引入的未知位置。

要在组织内共享解析器设置，您可以创建一个组织范围的插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-09T01:06:12.607

在过去的 7 年 10 个月中，这种情况是否发生了变化？我在自定义存储库中有一个传递库依赖项。对于它的直接客户端，我指定了一个解析器，并且存储库在发布时被写入客户端的 pom 文件。客户的客户似乎没有使用该信息来查找传递库。我必须“手动在上游添加解析器”。

# python - 如何覆盖通过 ctypes _fields_ 创建的（可能是多维的）数组的 __setitem__ 方法？

> ID：10727080
> 
> 赞同：1
> 
> 时间：2012-05-23T20:08:38.290
> 
> 标签：python, ctypes

我在 Python 3.2.2 中使用 ctypes 来封装一些 C 数据结构。最终目标是当结构的数据内容被修改时，能够拥有一个包装 C 结构通知的对象。

代表代码：

```
from ctypes import *

class Comm(Structure):
    def __init__(self):
        self.attributes_updated = False

    def __setattr__(self, name, value):
        super(Comm, self).__setattr__('attributes_updated', True)
        super(Comm, self).__setattr__(name, value)

class MyCStruct(Comm):
    _fields_ = [('number', c_int),
                ('array', c_int*5)]

    def __init__(self):
        Comm.__init__(self) 
```

这适用于任何简单的数据属性，如“数字”。

```
>>> s = MyCStruct()
>>> s.attributes_updated
False
>>> s.value = 123
>>> s.attributes_updated
True 
```

由于`__setattr__`不会通过索引表示法访问 `array`属性来调用它，因此我想覆盖`__setitem__`C 结构中作为数组的那些成员的属性。据推测，那时我需要包含对包含对象的引用，以便`attributes_updated`可以更改包含对象的变量，但我还没有达到能够以方便的方式捕获对数组属性的访问的地步我可以捕获对简单属性的访问。有没有办法对 ctypes 通过`_fields_`变量创建的可索引对象执行此操作？是否可以`__setitem__`覆盖`s.array`？可能有更好的方法来做这件事吗？

理想情况下，这会发生：

```
>>> s = MyCStruct()
>>> s.attributes_updated
False
>>> s.array[2] = 456
>>> s.attributes_updated
True 
```

编辑后续问题：

多维数组呢？

```
class MyCStruct(Comm):
    _fields_ = [('number', c_int),
                ('array', (c_int*5)*2] 
```

我错误地期待下面的答案，它非常适用于一维数组，对于任意嵌套的数组也是如此。应该有一种方法可以递归地生成代理对象，以对多维数组执行相同的操作，是吗？语法逃脱了我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:39:02.097

我认为一个很好的解决方案是返回一个代理对象而不是数组，然后它可以处理对数组的访问。可能是这样的：

```
from ctypes import *

class ArrayProxy(object):
    def __init__(self, array, struct):
        self.array = array
        self.struct = struct

    def __setitem__(self, i, val):
        self.array[i] = val
        self.struct.attributes_updated = True

    def __getitem__(self, i):
        item = self.array[i]
        if issubclass(type(item), Array):
            # handle multidimensional arrays
            return ArrayProxy(item, self.struct)
        return item

class Comm(Structure):
    def __init__(self):
        self.attributes_updated = False

    def __setattr__(self, name, value):
        super(Comm, self).__setattr__('attributes_updated', True)
        super(Comm, self).__setattr__(name, value)

    def __getattribute__(self, name):
        attr = super(Comm, self).__getattribute__(name)
        if issubclass(type(attr), Array):
            return ArrayProxy(attr, self)
        return attr

class MyCStruct(Comm):
    _fields_ = [('number', c_int),
                ('array', c_int*5),
                ('multiarray', c_int*2*1),]

    def __init__(self):
        Comm.__init__(self)

s = MyCStruct()
print s.array
# <__main__.ArrayProxy object at 0x1b1f3d0> 
print s.attributes_updated
# False
s.array[0] = 1
print s.attributes_updated
# True

s2 = MyCStruct()
s2.multiarray[0][0] = 1
print s2.attributes_updated
# True 
```

# objective-c - ios dev ABMultiValueRemoveValueAndLabelAtIndex 返回 true 但不起作用

> ID：10727084
> 
> 赞同：0
> 
> 时间：2012-05-23T20:08:58.790
> 
> 标签：objective-c, ios, addressbook

我想从通讯录联系人中删除特定的电话号码。

它“似乎”起作用，因为它返回 true，但事实并非如此。

拜托，有人可以帮我吗？这太棒了！

```
ABAddressBookRef ab = ABAddressBookCreate();
 ABRecordRef record = ABAddressBookGetPersonWithRecordID(ab,[myID intValue]);
     NSError *error = NULL;

ABMultiValueRef phoneNumbers = ABRecordCopyValue(record,kABPersonPhoneProperty);

for(CFIndex i=0; i < ABMultiValueGetCount(phoneNumbers); i++){
      NSString *phoneNumber = (NSString *)ABMultiValueCopyValueAtIndex(phoneNumbers,i);
      //ckDebug(@"phoneNumber = %@", phoneNumber);

      if ([[oDict objectForKey:@"value"] isEqualToString:phoneNumber]) {

              BOOL didRemove = ABMultiValueRemoveValueAndLabelAtIndex(ABMultiValueCreateMutableCopy(phoneNumbers),i);
              ckDebug(@"didRemove = %@\n", (didRemove ? @"TRUE" : @"FALSE"));

              //and save it!
              BOOL didSave = ABAddressBookSave(ab, (CFErrorRef *) error);

              ckDebug(@"didSave = %@\n", (didSave ? @"TRUE" : @"FALSE"));
              if (error) {
                  ckDebug(@"ABAddressBookSaveError = %@", error);
              }
      }
      [phoneNumber release];
}
CFRelease(ab); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T08:46:25.953

所以解决方案是：

创建 MultiValueRef 的 MutableCopy，然后从那里删除值并将副本设置回记录并保存...

像这样：

```
ABAddressBookRef ab = ABAddressBookCreate();
    ABRecordRef record = ABAddressBookGetPersonWithRecordID(ab,[myID intValue]);
    NSError *error = NULL;

    ABMultiValueRef phoneNumbers = ABRecordCopyValue(record,kABPersonPhoneProperty);
    ABMutableMultiValueRef phoneNumberMV = ABMultiValueCreateMutableCopy(phoneNumbers);

    for(CFIndex i=0; i < ABMultiValueGetCount(phoneNumberMV); i++){
        NSString *phoneNumber = (NSString *)ABMultiValueCopyValueAtIndex(phoneNumberMV,i);
        //ckDebug(@"phoneNumber = %@", phoneNumber);

        if ([[oDict objectForKey:@"value"] isEqualToString:phoneNumber]) {
            //now delete it!!! ;-)
            /*
            ckDebug(@"phoneNumbers = %@",phoneNumbers);
            ckDebug(@"index = %d", i);
            */
            BOOL didRemove = ABMultiValueRemoveValueAndLabelAtIndex(phoneNumberMV,i);
            ckDebug(@"didRemove = %@\n", (didRemove ? @"TRUE" : @"FALSE"));

            BOOL didSet = ABRecordSetValue(record, kABPersonPhoneProperty, phoneNumberMV, nil);
            ckDebug(@"didSet = %@\n", (didSet ? @"TRUE" : @"FALSE"));

            //and save it!
            BOOL didSave = ABAddressBookSave(ab, (CFErrorRef *) error);

            ckDebug(@"didSave = %@\n", (didSave ? @"TRUE" : @"FALSE"));
            if (error) {
                ckDebug(@"ABAddressBookSaveError = %@", error);
            }
        }
        [phoneNumber release];
    }
    CFRelease(ab); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T23:15:22.687

您从电话号码字段的*副本*中删除电话号码，但从不使用修改后的列表更新记录。你需要先打电话`ABRecordSetValue`，然后再打电话`ABAddressBookSave`。

# javascript - 在通过 AJAX 加载的 DOM 中运行动态注入的 javascript（尝试使用 history.js 对网站进行 ajaxify）

> ID：10727086
> 
> 赞同：5
> 
> 时间：2012-05-23T20:09:03.870
> 
> 标签：javascript, dom, pushstate, history.js, html5-history

我有一个基本上具有页眉、页脚和正文视图的 Web 应用程序。我正在使用 history.js 库和 HTML5 pushstate 对网站进行 ajaxifying，但我遇到的问题之一是在将 javascript 插入 DOM 时让嵌入式 javascript 运行。

几乎我所有的 javascript 都包含在 jQuery(function(){ ... }) 中（文档就绪加载器）

有谁知道处理这个问题的好策略？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T21:07:34.450

如果我理解您，您的“页面”只是您动态加载的 HTML 的容器。在该 HTML 中，您有当前不执行的 JavaScript 脚本块。那是对的吗？它们是在页面脚本中还是在新脚本文件的链接中？

无论如何，我认为这回答了您的问题：[如何执行动态加载的 JavaScript 块？](https://stackoverflow.com/questions/75943/how-do-you-execute-a-dynamically-loaded-javascript-block)

我自己的想法：

除非您的容器非常通用，因此无法知道您可能需要什么 JavaScript，否则最简单的方法可能是手动将所有 JavaScript 附加到您的容器页面，以便它与容器一起加载，可能会缩小并连接成单个文件。

如果您需要动态加载脚本，但您知道它们是什么，您可以使用 jQuery 使用 .getScript() 或 .ajax() 来实现。我认为这个页面很好地说明了事情，[http://www.electrictoolbox.com/jquery-dynamically-load-javascript-file/](http://www.electrictoolbox.com/jquery-dynamically-load-javascript-file/)。

同样，如果您在获取 html 块之前不知道需要哪些脚本，您可能会解析 html 以获取脚本链接，并通过添加到页面的新脚本元素手动附加它们。例如，如果页面不存在，下面的脚本会将 jQuery 添加到页面中。

```
(function () {

    if (typeof(jQuery) == "undefined") {
        var headID = document.getElementsByTagName("head")[0];         
        var newScript = document.createElement('script');
        newScript.type = 'text/javascript';
        newScript.id = 'myjQuery';
        newScript.src = 'http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js';
        headID.appendChild(newScript);
    }

    window.addEventListener('load', function (e)  {

        //make jQuery calls here.

    }, false);

})(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-23T21:17:23.027

使用[.on](http://api.jquery.com/on/)，我不打算解释该函数的所有行为，但只需几句话：

通过 dom 上的冒泡元素工作，例如，您将“onclick”绑定到一个 div，您可以将其设置为他的部分或全部孩子有 x 行为

# ruby-on-rails - 如何在 Rails 3.1 中的 CSS 中调用图像资产路径

> ID：10727094
> 
> 赞同：1
> 
> 时间：2012-05-23T20:09:34.500
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我在我的 CSS 文件中调用背景图像时遇到问题。该问题仅发生在生产中。我花了很多时间在谷歌上搜索，并编写了以下代码的许多变体，但我的生产站点似乎根本不想渲染它。以下代码有什么问题？

```
background: url(<%= image_path 'magnifyingglass.png' %>); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:15:56.923

您可能会遇到与资产管道中的预编译资产相关的生产问题。在部署生产之前检查您的配置并运行 rake assets:precompile。

[http://guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html)

# mysql - MySQL 我不希望我的 SUM CASE 为 Null

> ID：10727101
> 
> 赞同：0
> 
> 时间：2012-05-23T20:10:01.247
> 
> 标签：mysql, database

我正在使用 MySQL 数据库，并且我有一个很大的 mysql_query，除了这一行之外，它工作得很好。

```
SELECT game_id, 
COALESCE(
SUM(CASE WHEN game_score = 1 THEN 1 ELSE 0 END) 
- 
SUM(CASE WHEN game_score = 0 THEN 1 ELSE 0 END), 0) AS score 
FROM .... 
WHERE .... 
GROUP BY .... 
```

这一行几乎返回了我想要的所有数字，但它们与我不使用该`COALESCE`函数时的数字相同。当有game_score` 字段
时，我希望此语句返回 0 。 我的代码哪里出错了？ `game_id that has an empty`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:56:18.830

你也可以像这样使用解码功能---

```
SELECT game_id, 
SUM(DECODE(game_score, null, 0, 0, -1, 1, 0)) AS score 
FROM .... 
WHERE .... 
GROUP BY .... 
```

我已经检查了此查询是否有效，
希望它对您有所帮助....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:13:39.187

添加

```
when game_score is null then ... 
```

## 编辑

```
SELECT game_id, case when game_score is null then 0 else
                SUM(CASE WHEN game_score = 1 THEN 1 ELSE 0 END) 
                -
                SUM(CASE WHEN game_score = 0 THEN 1 ELSE 0 END) end AS score 
FROM games
group by ... 
```

请参阅此[SQLFiddle 示例](http://sqlfiddle.com/#!2/bcde5/4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:24:25.087

Use the COALESCE function around your field name in your statements instead of surrounding the SUM function:

```
SUM(CASE COALESCE(game_score,0) WHEN 1 THEN 1 ELSE 0 END) - SUM(CASE COALESCE(game_score,0) WHEN 0 THEN 1 ELSE 0 END) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:24:55.867

The problem is that game_id can have an empty game_score field in one row and a valid one in another. Your code picks up the valid one and returns non-null.

Fix this problem by looking for this case explicitly, as the first argument to coalesce: SELECT game_id, (CASE WHEN count(*) <> count(game_score) then NULL ELSE COALESCE(SUM(CASE WHEN game_score = 1 THEN 1 ELSE 0 END), . . .

I'm not sure what the coalesce is trying to do. It seems to be adding one for a bunch of different game_scores. Can you use one of the following instead:

```
COUNT(game_score) ?

SUM(case when game_score between 1 and xx then 1 else 0 end) ? 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T20:16:04.163

使用`is null`喜欢

```
CASE WHEN game_score = 1 THEN 1 
when game_score is null THEN 0
ELSE 0 END 
```

# java - 修改 JTable 中不同行的单元格编辑器

> ID：10727103
> 
> 赞同：4
> 
> 时间：2012-05-23T20:10:11.207
> 
> 标签：java, swing, jtable

我有`JTable`以下列：

行号 | 元素 | 数量

并且`JButton`每次单击时都会添加行。Element 列有一个自定义`JComboBox`单元格编辑器，其中填充了来自数据库的元素。但是我需要执行以下操作：

`JComboBox`假设我在表的第一行中有这些元素： Element1 Element2 Element3

我从第一行中选择 Element2 `JComboBox`，然后继续添加另一行。此新行不得在其`JComboBox`. 并且前（第一）行不得显示在第二行中选择的元素，依此类推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T13:21:11.103

我认为了解`Set<Element>`. 因此，@mKorbel 引用了相关[讨论](https://forums.oracle.com/forums/thread.jspa?threadID=2390422&tstart=0)，提出了可扩展性的重要问题。在这种情况下，问题提出了一个`List<DefaultCellEditor>`，什么时候可以使用*更*简单的渲染器。

在这里， a`CellEditor`可以管理 a `List<DefaultComboBoxModel<Element>>`，为当前正在编辑的行选择正确的组合模型并`setModel()`在编辑器组件上调用。随着每个新表格行的添加，编辑器将添加一个新元素`List`并根据需要调整现有元素。我预计复杂度会随着*O(n ² )*的增长而增长，其中*n*是`Set`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:08:50.167

像这样创建一个自定义 CustomCellEditor。

```
final JComboBox<String> comboBox = new JComboBox<String>();
table.getColumnModel().getColumn(1).setCellEditor(new CustomCellEditor(comboBox){
    @Override
    public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row, int column) {
         DefaultComboBoxModel<String> model = (DefaultComboBoxModel<String>) comboBox.getModel();
         model.removeAllElements();
         {//Add what you need according the row.
             model.addElement("X");
             model.addElement("Y");
             model.addElement("Z");
         }
         return super.getTableCellEditorComponent(table, value, isSelected, row, column);
   }
}); 
```

# java - Android app，如何登录网站并显示信息？

> ID：10727112
> 
> 赞同：0
> 
> 时间：2012-05-23T20:10:47.463
> 
> 标签：java, android, asp.net, login, web-scraping

我正在尝试构建一个 android 应用程序，它将登录到一个网站，从网站上抓取特定于用户的数据，然后在移动屏幕上很好地格式化这些数据。

我注意到我自己有几个类似的问题，在阅读了一些文档之后，我仍然对如何解决这个问题感到非常困惑。

**以下是我所知道**
的我要登录的站点使用 asp.net，而 login.aspx 使用 POST 作为登录表单。
该网站没有 API
也没有单点登录

我对 Android*非常*陌生，充其量是一个新手 JAVA 程序员。有人可以帮我开辟我需要做的研究路径，以便编写这个应用程序吗？我觉得我最需要帮助来连接网站和获取数据，我将能够自己弄清楚布局和格式。

我非常愿意研究和阅读任何必要的东西，但我想尽量减少任何最终会导致更多混乱的无关信息。

预先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:24:19.590

For the purpose of accessing the website all you need to know about is HTTP. It doesn't matter whether your target website is built with PHP or ASP etc. As you're only concern is how to communicate with the website through HTTP which is independent of technology used by the website. You can try wikipedia for descriptions of these methods.

It might be worthwhile reading the [Java URL tutorials for how to use Java classes](http://docs.oracle.com/javase/tutorial/networking/urls/index.html). As regards extracting the data itself you might want to read up on Parsers. This [link](http://www.mkyong.com/java/how-to-read-xml-file-in-java-dom-parser/) might give you some first ideas.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T11:15:24.130

我会使用[Jsoup](http://jsoup.org/) API。我已经发布了很多关于这个问题的主题。这可能会帮助您登录。我不知道android如何管理SSL证书。所以你必须自己研究。但这就是一个好的开始。

[用于 HTTPS 抓取的 Jsoup Cookie](https://stackoverflow.com/questions/7139178/jsoup-cookies-for-https-scraping/10533366#10533366)

# android - 最佳实践：AdMob 广告在顶部还是底部？

> ID：10727114
> 
> 赞同：3
> 
> 时间：2012-05-23T20:11:00.120
> 
> 标签：android, ios

所以，我只是将 AdMob 集成到我的应用程序中。现在，我想知道是将广告放在屏幕顶部还是底部。

从美学上讲，我认为应用程序在屏幕底部的广告看起来更好。

然而，我心中的小恶魔认为，如果我将它们放在顶部，那么人们更有可能错误地点击广告（从而增加我的点击次数），因为那是我有操作栏的地方。

当然，真正想要点击广告的人会点击它们，无论我将它们放在哪里。

任何人都可以分享他们在这方面的经验吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T20:34:55.293

[AdMob 发布商指南](https://support.google.com/admob/answer/1307237?hl=en)涵盖以下内容：

> 广告不应放置在非常靠近按钮或用户在与您的应用程序交互时可能不小心点击的任何其他对象的下方或下方。

并且：

> 广告不应放置在用户会随意点击或将手指放在屏幕上的区域。对于涉及此类交互的应用程序，我们建议在标题或结束页上实施我们的广告。

正如其他人所提到的，将广告放置在**不会**被意外击中的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T20:23:21.000

当然，人们更有可能点击您的广告（无意或有意），但您的客户满意度也可能会下降（尤其是当有人不小心点击了您的广告时）。当广告影响应用程序的可用性时，用户很可能会删除您的应用程序，从而导致零收入。

如果你真的需要在你的应用中加入广告，我会把它们放在用户最不可能不小心点击它们的地方。由于 iPhone 的屏幕并没有那么大，因此在可视性方面这不会产生任何严重影响。（我个人不喜欢任何使用广告的应用程序，尤其是 AdMob 广告，但这是个人说明）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:23:29.700

对于许多最新款手机上的软按钮，我认为将您的广告放在屏幕顶部不会增加您的点击率，因为用户很可能会不小心触摸到屏幕底部的广告。

选择您认为广告看起来更好的地方（很可能是底部）。

# sql-injection - tcl变量sql注入检查

> ID：10727115
> 
> 赞同：0
> 
> 时间：2012-05-23T20:11:05.980
> 
> 标签：sql-injection, tcl

我有一个通过隐藏输入字段传递的 tcl 变量 $value。什么是一个好的正则表达式来检查 SQL 注入。

我希望它只允许数字以防万一。

我希望它在另一种情况下只允许字符。

数字和字符都在另一种情况下。

在所有 3 种情况下，我不希望包含任何特殊字符

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T20:36:08.853

```
switch $case {
  case1 {set regex {^[[:digit:]]+$}}
  case2 {set regex {^[[:alpha:]]+$}}
  case3 {set regex {^[[:alnum:][:space:]]+$}}
  default {error "what case is this?"}
}
if {! [regexp $regex $value]} {
  error "invalid value: value"
} 
```

删除不匹配的字符

```
switch $case {
  case1 {set regex {\D}}
  case2 {set regex {[^[:alpha:]]}}
  case3 {set regex {[^[:alnum:][:space:]]}}
}
set safe_value [regsub -all $regex $value ""] 
```

请参阅 Tcl 手册页以了解[regexp](http://www.tcl.tk/man/tcl8.5/TclCmd/regexp.htm)、[regsub](http://www.tcl.tk/man/tcl8.5/TclCmd/regsub.htm)和[re_syntax](http://www.tcl.tk/man/tcl8.5/TclCmd/re_syntax.htm)

# android - Android 开发工具 (ADT) 插件拒绝在 Eclipse 上安装

> ID：10727117
> 
> 赞同：1
> 
> 时间：2012-05-23T20:11:12.107
> 
> 标签：android, eclipse-plugin, adt

我看过许多与我所问的类似的帖子，但似乎没有一个真正回答与 Windows 相关的问题。

我的问题是 ADT 插件不会安装在 Eclipse 中。我使用的是最新版本的 Eclipse，所以这应该不是问题。Android SDK 和 Manager 也安装得很好。我在带有 x64 Eclipse 的 Windows 7 x64 上。开发者工具的其他 3 个部分，包括 Android DDMS、Hierarchy Viewer 和 Traceview 安装得很好。错误代码如下：

`Cannot complete the install because one or more required items could not be found. Software being installed: Android Development Tools 18.0.0.v201203301601-306762 (com.android.ide.eclipse.adt.feature.group 18.0.0.v201203301601-306762)`

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T05:22:15.803

您需要转到“安装新软件”并选择“可用软件站点”。

那里添加： [http://download.eclipse.org/releases/indigo](http://download.eclipse.org/releases/indigo)和[http://download.eclipse.org/eclipse/updates/3.7](http://download.eclipse.org/eclipse/updates/3.7)。

之后，当您尝试安装 ADT 插件时，它应该可以工作。

这适用于 Ubuntu 12.10 上的 Eclipse 3.8 (Indigo)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T20:14:32.287

我经历了地狱的七个圈子，直到我解决了这个问题。对我有用的是我安装了**旧**版本的 Eclipse，Helios。

如果您更喜欢使用现有版本，可以尝试一些方法：

*   以管理员身份运行 Eclipse
*   按照官网的[疑难解答](http://developer.android.com/sdk/eclipse-adt.html#troubleshooting)
*   在 Eclipse 首选项中的“可用软件站点”中，确保选中 Galileo 和所有其他相关站点
*   确保您在面向 Java EE 开发人员的 Eclipse IDE 上运行，而不是 Classic（不确定这一点，但在某处阅读）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-06T22:56:44.417

您可以将 eric.itzhak 归结为他最后一个单一的银弹答案：

*   “确保您在面向 Java EE 开发人员的 Eclipse IDE 上运行，而不是在 Classic 上运行”

# java - 如何在给定文本中找到给定单词的所有排列？

> ID：10727118
> 
> 赞同：10
> 
> 时间：2012-05-23T20:11:13.610
> 
> 标签：java, string, algorithm

这是一个面试问题（电话屏幕）：编写一个函数（用 Java 编写）来查找给定文本中出现的给定单词的所有排列。例如，对于 word`abc`和 text `abcxyaxbcayxycab`，函数应该返回`abc, bca, cab`.

我会这样回答这个问题：

*   显然，我可以遍历给定单词的所有排列并使用标准`substring`函数。然而，编写代码来生成所有单词排列可能很困难（对我来说现在）。

*   遍历单词大小的所有文本子字符串，对每个子字符串进行排序并将其与“排序”的给定单词进行比较更容易。我可以立即编写这样的函数。

*   我可能可以修改一些子字符串搜索算法，但我现在不记得这些算法了。

你会如何回答这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T20:42:12.887

从算法上讲，这可能不是最有效的解决方案，但从类设计的角度来看，它是干净的。该解决方案采用比较“排序”给定单词的方法。

如果一个单词包含相同数字中的相同字母，我们可以说它是另一个单词的排列。这意味着您可以将单词从 a 转换`String`为 a `Map<Character,Integer>`。这种转换将具有复杂性 O(n)，其中 n 是 的长度`String`，假设您的`Map`实现中的插入成本为 O(1)。

它将包含在单词中找到的所有字符作为键，`Map`并将字符的频率作为值。

**例子**。*abbc 转换为`[a->1, b->2, c->1]`*

*bacb 转换为`[a->1, b->2, c->1]`*

因此，如果您必须知道两个单词是否是另一个单词的排列，您可以将它们都转换为映射，然后调用`Map.equals`.

然后，您必须遍历文本字符串并将转换应用于您要查找的单词长度相同的所有子字符串。

**Inerdial 提出的改进**

这种方法可以通过以“滚动”方式更新地图来改进。

即，如果您在`i=3`OP 中的示例 haystack 中的索引处匹配（子字符串`xya`），则地图将为`[a->1, x->1, y->1]`. 在大海捞针中前进时，减少 的字符数`haystack[i]`，增加 的字符数`haystack[i+needle.length()]`。

（删除零以确保`Map.equals()`有效，或者只是实现自定义比较。）

**Max 提出的改进**

如果我们也引入`matchedCharactersCnt`变量呢？在干草堆的开始它将是`0`。每次您将地图更改为所需值时 - 您都会增加变量。每次您将其更改为偏离所需值时 - 您都会减少变量。每次迭代检查变量是否等于针的长度。如果是 - 您已经找到了匹配项。它会比每次比较完整的地图要快。

Max提供的伪代码：

```
needle = "abbc"
text = "abbcbbabbcaabbca"

needleSize = needle.length()
//Map of needle character counts
targetMap = [a->1, b->2, c->1]

matchedLength = 0
curMap = [a->0, b->0, c->0]
//Initial map initialization
for (int i=0;i<needle.length();i++) {
    if (curMap.contains(haystack[i])) {
        matchedLength++
        curMap[haystack[i]]++
    }
}

if (matchedLength == needleSize) {
    System.out.println("Match found at: 0");
}

//Search itself
for (int i=0;i<haystack.length()-needle.length();i++) {
    int targetValue1 = targetMap[haystack[i]]; //Reading from hashmap, O(1)
    int curValue1 = curMap[haystack[i]]; //Another read
    //If we are removing beneficial character
    if (targetValue1 > 0 && curValue1 > 0 && curValue1 <= targetValue1) {       
        matchedLength--;
    }
    curMap[haystack[i]] = curValue1 + 1; //Write to hashmap, O(1)

    int targetValue2 = targetMap[haystack[i+needle.length()]] //Read
    int curValue2 = curMap[haystack[i+needle.length()]] //Read
    //We are adding a beneficial character
    if (targetValue2 > 0 && curValue2 < targetValue2) { //If we don't need this letter at all, the amount of matched letters decreases
        matchedLength++;
    }
    curMap[haystack[i+needle.length()]] = curValue2 + 1; //Write

    if (matchedLength == needleSize) {
        System.out.println("Match found at: "+(i+1));
    }
}

//Basically with 4 reads and 2 writes which are 
//independent of the size of the needle,
//we get to the maximal possible performance: O(n) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T21:38:47.053

要找到字符串的排列，您可以使用数论。但是您必须提前了解该算法背后的“理论”，然后才能使用该算法回答问题。

有一种方法可以使用素数计算字符串的哈希值。相同字符串的每个排列都会给出相同的哈希值。所有其他不是排列的字符串组合将给出一些其他哈希值。

哈希值由 c [1] * p [1] + c [2] * p [2] + ... + c [n] * p [n]计算 ，其中 c [i]是字符串中当前字符的唯一值，其中 p [i]是唯一素数c [i]字符的数值。

这是实现。

```
public class Main {
    static int[] primes = new int[] { 2, 3, 5, 7, 11, 13, 17, 
        19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 
        73, 79, 83, 89, 97, 101, 103 };

    public static void main(String[] args) {        
        final char[] text = "abcxaaabbbccyaxbcayaaaxycab"
            .toCharArray();     
        char[] abc = new char[]{'a','b','c'};       
        int match = val(abc);                   
        for (int i = 0; i < text.length - 2; i++) {
            char[] _123 = new char[]{text[i],text[i+1],text[i+2]};          
            if(val(_123)==match){
                System.out.println(new String(_123) );      
            }
        }
    }   
    static int p(char c) {
        return primes[(int)c - (int)'a'];
    }   
    static int val(char[] cs) {
        return 
        p(cs[0])*(int)cs[0] + p(cs[1])*(int)cs[1] + p(cs[2])*(int)cs[2];        
    }
} 
```

它的输出是： abc bca cab

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T21:34:17.840

您应该能够一次完成此操作。首先构建一个包含您要搜索的单词中所有字符的地图。所以最初地图包含`[a, b, c]`.

现在，一次一个字符地浏览文本。在伪代码中，循环看起来像这样。

```
found_string = "";
for each character in text
    if character is in map
        remove character from map
        append character to found_string
        if map is empty
            output found_string
            found_string = ""
            add all characters back to map
        end if
    else
        // not a permutation of the string you're searching for
        refresh map with characters from found_string
        found_string = ""
    end if
end for 
```

如果您想要唯一的匹配项，请更改输出步骤，以便将找到的字符串添加到地图中。这将消除重复。

存在包含重复字母的单词的问题。如果这是一个问题，请将键作为字母，将值作为计数。“移除”一个角色意味着减少它在地图中的数量。如果计数变为 0，则该角色实际上已从地图中移除。

所写的算法不会找到重叠的事件。也就是说，给定文本`abcba`，它只会找到`abc`. 如果要处理重叠事件，可以修改算法，以便在找到匹配项时，将索引减一减去找到的字符串的长度。

那是一个有趣的谜题。谢谢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T21:48:52.910

第二种方法对我来说似乎很优雅，应该完全可以接受。我认为它的比例是`O(M * N log N)`，其中`N`是字长和`M`文本长度。

我可以想出一个更复杂的`O(M)`算法：

1.  计算单词中每个字符的出现次数
2.  对文本的前 N（即`length(word)`）个字符执行相同的操作
3.  减去两个频率向量，得到`subFreq`
4.  计算 中非零的数量`subFreq`，产生`numDiff`
5.  如果`numDiff`等于 0，则存在匹配
6.  通过更新文本中的第一个和最后一个字符来更新`subFreq`并在恒定时间内更新`numDiff`
7.  转到 5 直到到达文本的末尾

**编辑**：看到已经发布了几个类似的答案。该算法的大部分等效于其他人建议的滚动频率计数。我卑微的补充还以滚动方式更新差异的数量，产生一种`O(M+N)`算法而不是一个算法`O(M*N)`。

**EDIT2**：刚刚看到Max在评论中基本上提出了这个建议，所以布朗尼指向他。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T22:05:28.953

这段代码应该可以完成工作：

```
import java.util.ArrayList;
import java.util.List;

public class Permutations {
    public static void main(String[] args) {
        final String word = "abc";
        final String text = "abcxaaabbbccyaxbcayxycab";
        List<Character> charsActuallyFound = new ArrayList<Character>();
        StringBuilder match = new StringBuilder(3);

        for (Character c : text.toCharArray()) {
            if (word.contains(c.toString()) && !charsActuallyFound.contains(c)) {
                charsActuallyFound.add(c);
                match.append(c);
                if (match.length()==word.length())
                {
                    System.out.println(match);
                    match = new StringBuilder(3);
                    charsActuallyFound.clear();
                }
            } else {
                match = new StringBuilder(3);
                charsActuallyFound.clear();
            }
        }
    }
} 
```

charsActuallyFound 列表用于跟踪已在循环中找到的字符。需要避免数学运算“aaa”“bbb”“ccc”（由我添加到您指定的文本中）。

经过进一步思考，我认为我的代码只有在给定单词没有重复字符的情况下才有效。上面的代码正确打印

```
abc
bca
cab 
```

但是如果您搜索“aaa”这个词，则不会打印任何内容，因为每个字符不能匹配超过一次。受 Jim Mischel 回答的启发，我编辑了我的代码，并以此结尾：

```
import java.util.ArrayList;
import java.util.List;

public class Permutations {
    public static void main(String[] args) {
        final String text = "abcxaaabbbccyaxbcayaaaxycab";

        printMatches("aaa", text);
        printMatches("abc", text);
    }

    private static void printMatches(String word, String text) {
        System.out.println("matches for "+word +" in "+text+":");

        StringBuilder match = new StringBuilder(3);
        StringBuilder notYetFounds=new StringBuilder(word);

        for (Character c : text.toCharArray()) {
            int idx = notYetFounds.indexOf(c.toString());
            if (idx!=-1) {
               notYetFounds.replace(idx,idx+1,"");

                match.append(c);
                if (match.length()==word.length())
                {
                    System.out.println(match);
                    match = new StringBuilder(3);
                    notYetFounds=new StringBuilder(word);
                }
            } else {
                match = new StringBuilder(3);
                notYetFounds=new StringBuilder(word);
            }
        }
        System.out.println();
    }

} 
```

这给了我以下输出：

```
matches for aaa in abcxaaabbbccyaxbcayaaaxycab:
aaa
aaa

matches for abc in abcxaaabbbccyaxbcayaaaxycab:
abc
bca
cab 
```

做了一些基准测试，上面的代码在 4.5 秒内在 36M 的随机字符串中找到了 30815 个“abc”匹配项。正如吉姆已经说过的，感谢这个谜题......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-23T21:34:24.637

这就是我要做的 - 设置一个标志数组，其中一个元素等于 0 或 1，以指示 STR 中的该字符是否已匹配

将第一个结果字符串 RESULT 设置为空。

对于 TEXT 中的每个字符 C：

将等于 STR 长度的数组 X 设置为全零。

对于 STR 中的每个字符 S：如果 C 是 STR 中的第 JTH 个字符，并且 X[J] == 0，则设置 X[J] <= 1 并将 C 添加到 RESULT。如果 RESULT 的长度等于 STR，则将 RESULT 添加到排列列表中，并将 X[] 的元素再次设置为零。

如果 C 不是 STR 中具有 X[J]==0 的任何字符 J，则再次将 X[] 的元素设置为零。

# iphone - 定位 UIViewController 包含子项

> ID：10727123
> 
> 赞同：0
> 
> 时间：2012-05-23T20:11:33.303
> 
> 标签：iphone, ios, ipad, uiviewcontroller

我正在阅读文档：

> 您需要决定视图控制器一次可以显示多少个子级，何时显示这些子级，**以及它们出现在视图控制器的视图层次结构中的什么位置。**

但是我应该在哪种方法中定位视图控制器子视图？假设我在容器中有两个 UIViewController，我想要一个挨着另一个.. 我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:48:11.013

在我的一篇文章中，我演示了如何使用 UIViewController Containment 创建一个简单的仪表板应用程序。

[http://www.highoncoding.com/Articles/848_Creating_iPad_Dashboard_Using_UIViewController_Containment.aspx](http://www.highoncoding.com/Articles/848_Creating_iPad_Dashboard_Using_UIViewController_Containment.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:33:41.517

这取决于您可能遇到的情况。如果您需要在第一次显示视图时显示所有子视图，则在 viewDidLoad（如果使用 xib 或 nib）或 loadView（如果以编程方式完成）中添加视图控制器和视图。如果您需要按需显示子视图控制器，例如在触摸按钮之后，那么您可以在单独的方法中添加子视图控制器和关联的视图。

您需要像布局任何其他子视图一样布局子视图控制器的视图。请记住，视图控制器包含只是允许您模块化代码的另一种方式。

查看此链接，该链接有助于解释如何添加子视图控制器： [Animate change of view controllers without using navigation controller stack, subviews or modal controllers?](https://stackoverflow.com/questions/8146253/animate-change-of-view-controllers-without-using-navigation-controller-stack-su/8198515#8198515)

这是一个简单的示例项目，展示了如何添加子视图控制器：[https ://github.com/toolmanGitHub/stackedViewControllers](https://github.com/toolmanGitHub/stackedViewControllers)

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:15:29.443

每个子视图控制器都有一个`view`属性。当您将这些视图添加到您自己的视图时，您可以设置它们的框架。

# python - 为什么 Tkinter Entry 的 get 函数什么都不返回？

> ID：10727131
> 
> 赞同：27
> 
> 时间：2012-05-23T20:12:16.357
> 
> 标签：python, python-3.x, tkinter, get, tkinter-entry

我正在尝试使用一个`Entry`字段来获取手动输入，然后使用该数据。

我发现的所有来源都声称我应该使用该`get()`功能，但我还没有找到一个简单的工作迷你示例，我无法让它工作。

我希望有人能告诉我我做错了什么。这是一个迷你文件：

```
from tkinter import *

master = Tk()

Label(master, text="Input: ").grid(row=0, sticky=W)

entry = Entry(master)
entry.grid(row=0, column=1)

content = entry.get()
print(content)  # does not work

mainloop() 
```

这给了我一个`Entry`可以输入的字段，但是一旦输入数据，我就无法对数据做任何事情。

我怀疑我的代码不起作用，因为最初`entry`是空的。但是，一旦输入数据，我如何访问输入数据呢？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-05-23T23:00:55.993

看起来您可能对何时运行命令感到困惑。在您的示例中，您`get`在 GUI 有机会显示在屏幕上之前调用该方法（这发生在您调用`mainloop`.

尝试添加一个调用该`get`方法的按钮。如果您将应用程序编写为一个类，这会容易得多。例如：

```
import tkinter as tk

class SampleApp(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)
        self.entry = tk.Entry(self)
        self.button = tk.Button(self, text="Get", command=self.on_button)
        self.button.pack()
        self.entry.pack()

    def on_button(self):
        print(self.entry.get())

app = SampleApp()
app.mainloop() 
```

运行程序，输入条目小部件，然后单击按钮。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-23T20:17:18.817

您也可以使用`StringVar`变量，即使它不是绝对必要的：

```
v = StringVar()

e = Entry(master, textvariable=v)
e.pack()

v.set("a default value")
s = v.get() 
```

有关更多信息，请参阅[*effbot.org*](http://effbot.org/)上的[此页面](http://effbot.org/tkinterbook/entry.htm)。[](http://effbot.org/)

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-12T15:20:04.720

一个没有类的简单例子：

```
from tkinter import *    
master = Tk()

# Create this method before you create the entry
def return_entry(en):
    """Gets and prints the content of the entry"""
    content = entry.get()
    print(content)  

Label(master, text="Input: ").grid(row=0, sticky=W)

entry = Entry(master)
entry.grid(row=0, column=1)

# Connect the entry with the return button
entry.bind('<Return>', return_entry) 

mainloop() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-02T21:15:20.293

*

```
master = Tk()
entryb1 = StringVar

Label(master, text="Input: ").grid(row=0, sticky=W)

Entry(master, textvariable=entryb1).grid(row=1, column=1)

b1 = Button(master, text="continue", command=print_content)
b1.grid(row=2, column=1)

def print_content():
    global entryb1
    content = entryb1.get()
    print(content)

master.mainloop() 
```

你做错的不是把它放在一个定义函数中，然后你没有使用`.get`你设置的文本变量的函数。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-10-15T09:13:21.160

您需要在其中放置一个文本变量，以便您可以使用`set()`and`get()`方法：

```
var=StringVar()
x= Entry (root,textvariable=var) 
```*

# c# - 实体 id 的条件映射，使用代码映射和没有流畅的 nhibernate 的 nhibernate

> ID：10727132
> 
> 赞同：2
> 
> 时间：2012-05-23T20:12:17.097
> 
> 标签：c#, nhibernate, nhibernate-mapping, convention, mapping-by-code

我正在尝试将流利的 nhibernate 转换为 3.2 中的代码映射（Loquacious），现在使用 3.3 的 nhibernate。

我遇到的问题是 Id 列的条件映射取决于类型。

我现在正在使用与此类似的东西，它假设实体 id 是 guid 类型。

```
var mapper = new ConventionModelMapper ( );
mapper.BeforeMapClass += ( modelInspector, type, map ) =>
{
    map.Id ( k =>
    {
       k.Generator ( Generators.GuidComb );
       k.Column ( type.Name + "Id" );
    } );
}; 
```

如何配置/设置实体何时使用字符串（默认为已分配）？

我是否必须为所有不使用 guid 作为 id 的实体覆盖自定义映射？

# c - OpenSSL RSA：无法加密/解密超过 16 个字节的消息

> ID：10727133
> 
> 赞同：7
> 
> 时间：2012-05-23T20:12:18.267
> 
> 标签：c, openssl, rsa, public-key-encryption

我正在开发一个使用 OpenSSL 进行基本 RSA 加密和解密的简单程序。它适用于小消息（<16 字节），但在此之上的任何事情都失败了。我知道公钥加密的一个限制是您不能加密任何超过密钥大小的东西。就我而言，我使用的是 1024 位密钥，所以我应该有 128 字节可以使用（由于填充可能会稍微少一些），对吗？如果是这样，那不是我正在经历的。

这是我的程序的输出，有 15 个字节：

```
Generating RSA keypair...done.
Message to encrypt: 0123456789ABCDE
16 bytes encrypted
Decrypted message: 0123456789ABCDE 
```

并且有 16 个字节：

```
Generating RSA keypair...done.
Message to encrypt: 0123456789ABCDEF
16 bytes encrypted
140153837057696:error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad     decrypt:evp_enc.c:467:
Decrypted message: (null) 
```

看来无论如何，一共只加密了16个字节。

我的加密功能（已更新修复）：

```
unsigned char* rsa_seal(EVP_PKEY *pub_key, unsigned char *msg, size_t **enc_msg_len, unsigned char **sym_key, int *sym_key_len, unsigned char **iv) {
    size_t msg_len = strlen((char*)msg);
    unsigned char *encrypt = malloc(EVP_PKEY_size(pub_key));

    EVP_CIPHER_CTX *ctx = malloc(sizeof(EVP_CIPHER_CTX));
    EVP_CIPHER_CTX_init(ctx);

    *sym_key = malloc(EVP_PKEY_size(pub_key));
    *iv = malloc(EVP_MAX_IV_LENGTH);

    **enc_msg_len = 0;

    if(!EVP_SealInit(ctx, EVP_aes_128_cbc(), sym_key, sym_key_len, *iv, &pub_key, 1)) {
        ERR_print_errors_fp(stderr);
        encrypt = NULL;
        goto return_free;
    }

    if(!EVP_SealUpdate(ctx, encrypt, (int*)*enc_msg_len, msg, (int)msg_len)) {
        ERR_print_errors_fp(stderr);
        encrypt = NULL;
        goto return_free;
    }

    if(!EVP_SealFinal(ctx, encrypt, (int*)*enc_msg_len)) {
        ERR_print_errors_fp(stderr);
        encrypt = NULL;
        goto return_free;
    }

    return_free:
    EVP_CIPHER_CTX_cleanup(ctx);
    free(ctx);
    ctx = NULL;

    return encrypt;
} 
```

对应的解密函数（用fix更新）：

```
char* rsa_open(EVP_PKEY *pri_key, unsigned char *enc_msg, size_t *enc_msg_len, unsigned char *sym_key, int sym_key_len, unsigned char *iv) {
    size_t dec_len = 0;
    unsigned char *decrypt = malloc((*enc_msg_len) + EVP_MAX_IV_LENGTH);
    if(decrypt == NULL) return NULL;

    EVP_CIPHER_CTX *ctx = malloc(sizeof(EVP_CIPHER_CTX));
    EVP_CIPHER_CTX_init(ctx);

    if(!EVP_OpenInit(ctx, EVP_aes_128_cbc(), sym_key, sym_key_len, iv, pri_key)) {
        ERR_print_errors_fp(stderr);
        decrypt = NULL;
        goto return_free;
    }

    if(!EVP_OpenUpdate(ctx, decrypt, (int*)&dec_len, enc_msg, (int)*enc_msg_len)) {
        ERR_print_errors_fp(stderr);
        decrypt = NULL;
        goto return_free;
    }

    if(!EVP_OpenFinal(ctx, decrypt, (int*)&dec_len)) {
        ERR_print_errors_fp(stderr);
        decrypt = NULL;
        goto return_free;
    }

    decrypt[dec_len] = '\0';

    return_free:
    EVP_CIPHER_CTX_cleanup(ctx);
    free(ctx);
    ctx = NULL;

    return (char*)decrypt;
} 
```

密钥生成函数：

```
int rsa_init(EVP_PKEY **rsa_keypair) {
    EVP_PKEY_CTX *ctx = EVP_PKEY_CTX_new_id(EVP_PKEY_RSA, NULL);

    if(!EVP_PKEY_keygen_init(ctx)) {
        ERR_print_errors_fp(stderr);
        return -1;
    }

    if(!EVP_PKEY_CTX_set_rsa_keygen_bits(ctx, KEY_LENGTH)) {
        ERR_print_errors_fp(stderr);
        return -1;
    }

    if(!EVP_PKEY_keygen(ctx, rsa_keypair)) {
        ERR_print_errors_fp(stderr);
        return -1;
    }

    EVP_PKEY_CTX_free(ctx);

    return 0;
} 
```

最后，我的主要内容：

```
int main() {
    EVP_PKEY      *rsa_keypair = NULL; // RSA keypair 
    char          msg[BUFFER];         // Message to encrypt
    unsigned char *encrypt = NULL;     // Encrypted message
    char          *decrypt = NULL;     // Decrypted message

    // Generate key pair
    printf("Generating RSA keypair...");
    if(rsa_init(&rsa_keypair) == -1) {
        fprintf(stderr, "\nError generating RSA keypair.\n");
        exit(1);
    }
    printf("done.\n");

    // Get the message to encrypt
    printf("Message to encrypt: ");
    fgets(msg, BUFFER-1, stdin);
    msg[strlen(msg)-1] = '\0';

    // Load error strings in anticipation of error
    ERR_load_crypto_strings();

    // Encrypt the message
    size_t *encrypt_len = malloc(sizeof(size_t));
    unsigned char *sym_key = NULL;
    unsigned char *iv = NULL;
    int sym_key_len;
    encrypt = rsa_seal(rsa_keypair, (unsigned char*)msg, &encrypt_len, &sym_key, &sym_key_len, &iv);
    printf("%d bytes encrypted\n", (int)*encrypt_len);

    // Decrypt it
    decrypt = rsa_open(rsa_keypair, (unsigned char*)encrypt, (size_t*)encrypt_len, sym_key, sym_key_len, iv);
    printf("Decrypted message: %s\n", decrypt);

    free(encrypt);
    free(decrypt);
    free(encrypt_len);
    free(sym_key);
    free(iv);
    EVP_PKEY_free(rsa_keypair);

    return 0;
} 
```

任何帮助是极大的赞赏！谢谢你。

编辑：正如下面的数学所指出的，我的错误的答案似乎隐藏在 OpenSSL 中：[https ://www.openssl.org/docs/crypto/EVP_EncryptInit.html#](https://www.openssl.org/docs/crypto/EVP_EncryptInit.html#)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T08:26:52.600

这是因为您没有正确处理、和中的`out`和`outl`参数。`EVP_SealUpdate()``EVP_SealFinal()``EVP_OpenUpdate()``EVP_OpenFinal()`

每个`EVP_XxxxUpdate()`and`EVP_XxxxFinal()`调用都将有助于输出缓冲区。`outl`因此，您需要通过将每个返回的总和每次都提供预期的缓冲区（缓冲区的开始 + 已处理的字节）来跟踪密封/打开过程。

```
unsigned char* rsa_seal(...)
{
  ...
  **enc_msg_len = 0;

  EVP_SealUpdate(ctx, encrypt + **enc_msg_len, &outl, msg, (int)msg_len);
  **enc_msg_len += outl;

  EVP_SealFinal(ctx, encrypt + **enc_msg_len, &outl);
  **enc_msg_len += outl;
  ...
}

char* rsa_open(...)
{
  ...
  dec_len = 0;

  EVP_OpenUpdate(ctx, decrypt + dec_len, &outl, enc_msg, (int)*enc_msg_len);
  dec_len += outl;

  EVP_OpenFinal(ctx, decrypt + dec_len, &outl);
  dec_len += outl;
  ...
} 
```

该程序正在使用 15 字节缓冲区，因为在这种情况下，`EVP_XxxxUpdate()`调用返回 0 `outl`（没有足够的数据来密封/打开一个块），从而将问题隐藏在代码逻辑中。

*注意：*数据不是使用 RSA 密钥直接加密，而是使用生成的对称密钥（在您的情况下为 AES-128）。这就是块大小为 16 字节的原因。

# php - Open/Closed 原则 - 如何调用新版本？

> ID：10727135
> 
> 赞同：12
> 
> 时间：2012-05-23T20:12:22.573
> 
> 标签：php, oop, open-closed-principle

我正在尝试掌握开放/封闭原则（在我的 PHP 案例中，但这并不会真正产生影响）。

我理解它的方式是一个类**永远不会**开放修改。仅用于错误修复。如果我想向该类添加新代码，那么我必须创建一个新代码并扩展“旧”类。这是我可以添加新代码的唯一方法。

在某种程度上，我可以看到这样做的好处。因为基本上你创建了某种版本控制系统，旧代码总是可以工作，但你也可以随时尝试使用新类。

但这在实践中如何运作？我的意思是，假设我有以下课程：

```
class MyObject
{
    public function doSomething()
    {
        echo 'Im doing something';
    }
} 
```

所以我可能在某个地方实例化了这个类：

```
$obj = new MyObject(); 
```

但后来我决定在该对象中使用另一种方法是件好事。所以我也可以做点别的。根据 OCP，我无法修改课程。所以我必须创建一个新的，延伸到旧的，对吗？

第一个问题。我如何称呼新班级？因为它实际上并不是一个完整的新对象。喜欢。用户对象是用户对象。我不能仅仅因为它需要另一种方法就突然给它起一个完全不同的名字。无论如何，我创建了新类：

```
class MyNewObject extends MyObject
{
    public function doSomethingElse()
    {
        echo 'Im doing something else now';
    }
} 
```

现在这也意味着我必须更改实例化“MyObject”类的代码行并将其替换为“MyNewObject”类，对吧..？如果这在不止一个地方完成，那么我必须搜索我的源代码......（想想控制器类中的一个方法，它几乎总是使用'​​new'关键字来实例化某些类）。

这同样适用于继承。我必须找到继承旧类的每个类，并且必须用新类替换它。

* * *

所以基本上我的问题是：

您如何命名具有新方法的新类？只是因为我添加了一些新功能，并不意味着我可以给这个类一个全新的名字......

如果“旧”类是从多个地方实例化（或继承）的呢？然后我必须找到所有这些地方......哪里有收获？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:32:57.547

我会争辩说，通过添加一个函数，你并没有修改类的行为。

在您的应用程序中当前正在调用 doSomething() 的所有实例中，只需将 doSomethingElse() 添加到类中将不起作用。由于您没有更改 doSomething()，因此行为与以前相同。

一旦您确定您的 doSomething() 实现在某些情况下没有削减它，您就可以扩展该类并覆盖 doSometing()。再一次，原来的行为仍然和往常一样，但现在你也有了一个新的 doSomething() 可以使用。

我意识到这违背了开放/封闭的严格定义，但这是现实世界，这就是我在代码中解释该原则的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:59:06.270

开放封闭原则并非旨在用作一种版本控制系统。如果您确实需要对课程进行更改，请继续进行这些更改。您无需创建新类并更改所有实例化旧类的位置。

开放封闭原则的要点是，设计良好的系统不应要求您更改现有功能以添加新功能。如果要向系统添加新类，则无需搜索所有代码来查找需要引用该类或有特殊情况的位置。

如果您的类的设计不够灵活，无法处理一些新功能，那么请务必更改您的类中的代码。但是，当您更改代码时，请使其灵活，以便您将来可以在不更改代码的情况下处理类似的更改。它是一种设计策略，而不是一套阻止你做出改变的手铐。有了良好的设计决策，随着时间的推移，当您向系统添加新功能时，您现有的代码将需要越来越少的更改。这是一个迭代的过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:22:24.010

您需要在调用父类的构造函数的 MyNewObject 类中创建一个构造函数：

```
function __construct() {

    parent::__construct();

} 
```

这样，您可以实例化新类，并且仍然可以访问扩展类的所有功能。

然后，您还可以覆盖父类中的任何函数（只要它没有被标记为 final）。

所以你可以这样做：

```
$newObj = new MyNewObject();

$newObj->doSomething();

$newObj->doSomethingElse(); 
```

# winapi - 微软在 Excel 中使用的 PDF 库是否可供外界使用？

> ID：10727139
> 
> 赞同：6
> 
> 时间：2012-05-23T20:12:51.323
> 
> 标签：winapi, pdf, pdf-generation

Excel 2010（和 Word 2010，可能还有其他）能够直接保存为 PDF：

![在此处输入图像描述](../Images/b78aece7ea0954645a629159a0f27c27.png)

他们在[不](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CHYQFjAA&url=http://www.bullzip.com/products/pdf/info.php&ei=7UO9T9qJPMXs2QXS6OmiDw&usg=AFQjCNGjJSQtlBOF5mNvye6asSvdoRP1lw&sig2=c5bRbLUwvCGDX0m-pXgM9g) [安装](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CH0QFjAB&url=http://sourceforge.net/projects/pdfcreator/&ei=7UO9T9qJPMXs2QXS6OmiDw&usg=AFQjCNH8WJ3bow67eCjeG-gQ-xpeyLniEg&sig2=Kn4A2Vsg2_LYfvF5wN_DIg) [“PDF 打印机”](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=8&ved=0CI8BEBYwBw&url=http://pdfprinter.com/&ei=7UO9T9qJPMXs2QXS6OmiDw&usg=AFQjCNF-MVJerGTSZmvsKzloKmLLN_bbzA&sig2=XRwFsn3O_oDpQDKdj33f2w)[的](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CH8QFjAC&url=http://www.cutepdf.com/&ei=7UO9T9qJPMXs2QXS6OmiDw&usg=AFQjCNFAloTzoYbYBLjfEYvNA9q4-GyADQ&sig2=NrWgnfF41xJpXmWaw_aLiw) 情况下打印它。

微软用来生成 PDF 的 PDF 库是否可供外界使用？

*   COM 对象？
*   一个codeplex开源项目？

**tl;dr：** Microsoft 如何从本机 Win32 应用程序创建 PDF？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:14:08.923

ABCpdf 吹嘘微软使用他们的产品。不知道微软如何以及在哪里使用它，但它确实似乎是一个不错的 pdf 库。

[http://www.websupergoo.com/aboutus.htm](http://www.websupergoo.com/aboutus.htm)

# python - 如何使用我的 GPU 加速网络训练？

> ID：10727140
> 
> 赞同：1
> 
> 时间：2012-05-23T20:12:59.757
> 
> 标签：python, neural-network, gpu, pybrain

我想知道是否有办法使用我的 GPU 来加速 PyBrain 中的网络训练。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:15:10.780

除非 PyBrain 是为此而设计的，否则你可能做不到。

如果您还没有，您可能想尝试在 PyPy 下运行您的训练器——对于某些工作负载，它比 CPython 快得多。也许这是其中的工作负载之一。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T06:30:00.207

结帐 Pylearn2：[https ://github.com/lisa-lab/pylearn2](https://github.com/lisa-lab/pylearn2)

这是一个较新的库，可以通过 cuda-convnet 在带有 CUDA 的 GPU 上运行。

# javascript - Internet Explorer JQuery 错误

> ID：10727142
> 
> 赞同：0
> 
> 时间：2012-05-23T20:13:13.040
> 
> 标签：javascript, jquery, internet-explorer, error-handling

我正在使用 JQuery min 1.4.2。我有一个函数，它遍历几个表并添加一个带有数字的类：

```
$("#reportArea table", this).each(function(i){
$(this).addClass("table-" + i);
}); 
```

出于某种原因，这会在 IE 8 和 IE9 中引发错误，但是，在 Firefox 和 Chrome 中，当我打开控制台时，我看不到任何错误。IE中的错误是：

```
Message: Invalid argument.
Line: 48
Char: 1
Code: 0
URI: /js/jquery-min.js 
```

如果我查看 IE 调试器中的第 48 行，我会看到：

```
a[b]=d}if(c.nodeName(a,"form")&&a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue; etc.. 
```

我也尝试将我的代码改写为这个，但仍然得到同样的错误：

```
$('#reportArea table:eq(0)').addClass('table-0');
$('#reportArea table:eq(1)').addClass('table-1'); 
```

奇怪的是，该类仍然被添加到 IE 中的表中。

请注意，我会手动添加类，但它是一个 JSP 报告页面，我无权访问控制该页面的特定模板。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-23T20:32:09.450

```
$("#reportArea table", this).each(...
                       ^^^^ 
```

这里有什么`this`？它应该是一个[DOM 上下文](http://api.jquery.com/jQuery/#jQuery1)。我认为您的选择器不需要它，因为 id （应该）是唯一的。如果您没有在特定函数中调用该函数，则[`this`关键字](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)可能会引用全局对象并因此导致错误。

# asp.net-mvc - 后台任务/作业/进程，在 asp.net MVC 3 中

> ID：10727145
> 
> 赞同：2
> 
> 时间：2012-05-23T20:13:17.430
> 
> 标签：asp.net-mvc, asp.net-mvc-3, backgroundworker, observers

我不知道从哪里开始或用什么来解决这两个问题：

1.  我有一个用户模型和一个事件模型（足球比赛、卡丁车比赛等）。我希望当用户创建新事件时发送和电子邮件给其他用户。

2.  我需要“一些东西”，比如说每 15 分钟检查一次，从数据库中删除所有已经结束的事件（例如：昨天的事件）。

我知道在 Ruby on Rails 中，有观察者和后台工作者，在 MVC3 中有类似的东西吗？还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T06:05:37.427

这类任务更适合从单独的进程（例如 Windows 服务）中完成。您应该[避免在 Web 应用程序中使用后台任务](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:26:00.377

我建议使用[Quartz.net](http://quartznet.sourceforge.net/)作为强大的解决方案，因为它是功能齐全的开源作业调度系统，可用于从最小的应用程序到大型企业系统。

更多信息：[带有 asp.net mvc 的作业调度程序](https://stackoverflow.com/questions/2628214/job-scheduler-with-asp-net-mvc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-09T16:06:36.900

确实存在风险。但有时我们必须采用此选项，尤其是当我们在紧迫的时间内实施作业队列时。如果您不熟悉 Windows 服务，则需要了解这些内容。

以下为我工作，（.NET 4.5.2）。一旦我调用`InitiateLongRunningProcess`控制器，它就会启动一个长时间运行的进程并返回视图，而无需等待长时间运行的作业。

```
public ActionResult InitiateLongRunningProcess(Emails emails)
{
    if (ModelState.IsValid)
    {
       HostingEnvironment.QueueBackgroundWorkItem(ct => LongRunningProcessAsync(emails.Email));
       return RedirectToAction("Index", "Home");
    }

    return View(user);
} 
```

阅读 Hanselman [HowToRunBackgroundTasksInASPNET的这篇精彩文章](http://www.hanselman.com/blog/HowToRunBackgroundTasksInASPNET.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-18T10:39:01.120

很晚了，但你应该考虑看看[http://hangfire.io/](http://hangfire.io/)。它是一个了不起的库，并提供了一个完整的 UI 来管理作业 :)

# oracle - 发送电子邮件时如何保留 UTF8 字符？

> ID：10727147
> 
> 赞同：0
> 
> 时间：2012-05-23T20:13:23.373
> 
> 标签：oracle, utf-8, plsql

甲骨文 11g。PL/SQL。Oracle 使用 AL32UTF8。

```
LastName
--------
Manaña 
```

Oracle 中 ñ 的 unicode 值为 (00F1)，ascii 值为 (0241)。当我在电子邮件中发送此值时。电子邮件内容为“manan?a”。十六进制的电子邮件值为 (3F)。

**问题：当我通过电子邮件发送时，如何保留我的“ñ”？**

这是选择转储：

```
 select dump(last_name) => [Typ=1 Len=7: 77,97,110,97,195,177,97] 
```

当我发送电子邮件时，我调用 package.mail 这是那个片段

```
 last_name := 'Manaña'
 packagename.mail(recipient ==>'emailrecipeint@blah.com',
                    subject ==>'Email Subject',
                    message ==>last_name);

PROCEDURE mail(sender     IN VARCHAR2 default 'non-reply@company.edu',
   recipients IN VARCHAR2,
   subject    IN VARCHAR2,
   message    IN VARCHAR2) IS
   conn utl_smtp.connection;
   userid varchar2(256);
    globalname varchar2(256);
  BEGIN    
    conn := begin_mail(sender, recipients, subject);
    select global_name into globalname from global_name;
    select user into userid from dual;
    write_text(conn, message);
    end_mail(conn);
   END; 
```

**这是package.write_text**的片段

 **```
 PROCEDURE write_text(conn    IN OUT NOCOPY utl_smtp.connection,
                         message IN VARCHAR2) IS
    BEGIN  
     utl_smtp.write_data(conn, message);
    END; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:23:26.953

邮件基本上是 7 位的。要发送 7 位文本/纯文本以外的任何内容，请使用 MIME 对其进行封装和编码。在您的情况下， declare`Content-Type: text/plain; charset="utf-8"`和`Content-Transfer-Encoding: quoted-printable`. 然后，如果您当然需要对文本进行 QP 编码；您的语言可能为此提供了一个库。（自己动手并不难，但这通常是个坏主意。）**

# c# - 如果一个结构不能继承另一个类或结构，为什么 Int32 有一个 ToString() 方法？

> ID：10727151
> 
> 赞同：22
> 
> 时间：2012-05-23T20:13:37.297
> 
> 标签：c#, .net, inheritance, struct

```
int a = 2;

Console.WriteLine(a.ToString()); // displays 2

// definition of ToString() here - public override string ToString(); 
```

现在，这是我的一些理解：

1.  .net 中的所有类都有一个方法，该方法是从该类`ToString()`继承的。`Object`
2.  结构不能从类或其他结构派生。`int`是一个 type 的结构，它从它实现的接口中`Int32`获取几个[With Parameters] 方法。`ToString()`
3.  struct中还有一个`ToString()`[without params] 函数`Int32`

根据[http://msdn.microsoft.com/en-us/library/system.int32.tostring.aspx](http://msdn.microsoft.com/en-us/library/system.int32.tostring.aspx)，

> struct Int32 覆盖 ValueType.ToString() 方法

如果一个结构不能继承某个类或结构，你能解释一下这个`ToString()`方法是如何可用的`Int32`吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-23T20:16:06.080

> 如果一个结构不能继承某个类或结构，

这不是真的。所有结构（以及内置值类型，如`System.Int32`,`System.Single`等）总是隐式继承自[`System.ValueType`](http://msdn.microsoft.com/en-us/library/system.valuetype.aspx)（反过来，继承自`System.Object`）。

但是，您不能创建一个继承自*其他任何东西*的结构。

这在 C# 语言规范 4.1.1 中有明确说明：

> 4.1.1 System.ValueType 类型
> 
> 所有值类型都隐式继承自 System.ValueType 类，而后者又继承自类对象。任何类型都不可能从值类型派生，因此值类型是隐式密封的（第 10.1.1.2 节）。

然后，稍后（4.1.3） struct 被显式定义为值类型：

> 4.1.3 结构类型
> 
> 结构类型是可以声明常量、字段、方法、属性、索引器、运算符、实例构造函数、静态构造函数和嵌套类型的值类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:17:23.467

`Int32`implements [`IFormattable`](http://msdn.microsoft.com/en-us/library/system.iformattable.aspx)，它定义了`ToString`方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T15:53:34.420

从 ValueType 派生的类型的每个定义实际上在运行时定义了两种不同类型的东西：一种堆对象（它派生自并`ValueType`反过来从`Object`'不包含任何嵌入的类型信息，而是要求使用它的代码必须有其他方式知道它是什么）。堆对象类型的实例包含存储位置类型的字段，以及尝试访问的代码`this`将访问该字段。如果值类型被隐式或显式转换为引用类型的存储位置，系统将创建一个具有适当类型的新堆对象，并将该值类型的所有公共和私有字段复制到堆对象内的相应字段。如果堆对象被强制转换为值类型存储位置，则堆对象中的所有公共和私有字段都将被复制到值类型存储位置。

如果尝试在`Object`值类型的堆对象上使用任何方法或接口方法，则该方法将像任何其他堆对象方法一样被调用。如果尝试在值类型的存储位置上进行，对于除 之外的任何方法`GetType`，编译器将生成一个特殊的“受约束”操作码，它将存储位置的类型通知运行时并指示运行时调用适合该类型的方法。由于编译器将具有可用的存储位置类型，并且运行时可以使用它来找到适当的方法，因此可以直接在存储位置上调用适当的方法，而不必先创建新的堆对象。 `GetType`是一个值得注意的例外；因为它通过检查嵌入在对象中的类型信息来工作，所以它只能对嵌入了类型信息的事物起作用。因此，它的参数将在调用之前转换为堆对象形式；`GetType`然后将能够检查该堆对象的嵌入类型信息。

# c# - C# 命令中的 PowerShell

> ID：10727153
> 
> 赞同：1
> 
> 时间：2012-05-23T20:13:41.227
> 
> 标签：c#, powershell

我对 PowerShell 完全陌生，并且对它的一些命令语法感到困惑。我一直在寻找谷歌；但是，我发现的一些语法，例如

```
Send-Keys "%(ea)Testing{Enter}{F5}" 
```

有我似乎无法摆脱的错误。

说我打开计算器

```
var script = @" 
                Start-Process calc.exe
            ";

powerShell.AddScript(script);          
powerShell.Invoke(); 
```

如何为字段输入值并发送击键？也就是说，输入 5，按 - 键，输入 6，然后按 ENTER 键？

或者更好的是，如何使用 PowerShell 输入某个股票代码（这不是默认的文本字段），然后按 Enter 搜索它？（打开 firefox.exe 后，导航到 www.yahoo.com）

感谢您的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:23:16.097

```
Key                  SendKeys
BACKSPACE            {BACKSPACE}, {BS}, or {BKSP}   
BREAK                {BREAK}   
CAPS LOCK            {CAPSLOCK}   
DEL or DELETE        {DELETE} or {DEL}   
DOWN ARROW           {DOWN}   
END                  {END}   
ENTER                {ENTER} or ~   
ESC                  {ESC}   
HELP                 {HELP}   
HOME                 {HOME}   
INS or INSERT        {INSERT} or {INS}   
LEFT ARROW           {LEFT}   
NUM LOCK             {NUMLOCK}   
PAGE DOWN            {PGDN}   
PAGE UP              {PGUP}   
PRINT SCREEN         {PRTSC}   
RIGHT ARROW          {RIGHT}   
SCROLL LOCK          {SCROLLLOCK}   
TAB                  {TAB}   
UP ARROW             {UP}   
SHIFT                +                 
CONTROL              ^                 
ALT                  %                 
BACKSPACE            {BACKSPACE}, {BS}, or {BKSP} 
```

要记住的一件事是应用程序启动需要一段时间，您可能会在计算器准备好之前发送您的密钥。

尝试类似：

```
add-type -AssemblyName microsoft.VisualBasic
add-type -AssemblyName System.Windows.Forms

Calc

start-sleep -Milliseconds 500

[Microsoft.VisualBasic.Interaction]::AppActivate("Calc")
[System.Windows.Forms.SendKeys]::SendWait("1{ADD}1=") 
```

这应该让你从谷歌得到一个报价：

```
 $IE=new-object -com internetexplorer.application
 $IE.navigate2("https://www.google.co.uk/finance?client=ob&q=NASDAQ:MSFT")
 $IE.visible=$true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:46:41.080

我无法访问 www.yahoo.com，因为它会自动将我重定向到 uk.yahoo.com。

但是，我可以访问[http://finance.yahoo.com](http://finance.yahoo.com)并完全按照您的意愿行事。

有点难看并且依赖于页面布局，但它似乎正在工作：

```
add-type -AssemblyName microsoft.VisualBasic
add-type -AssemblyName System.Windows.Forms

& 'C:\Program Files (x86)\Mozilla Firefox\firefox.exe' -url http://finance.yahoo.com

start-sleep 3

[System.Windows.Forms.SendKeys]::SendWait("{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}{TAB}FB{ENTER}") 
```

# c++ - C++11 lambda 的参数/存储类型

> ID：10727158
> 
> 赞同：11
> 
> 时间：2012-05-23T20:14:21.063
> 
> 标签：c++, lambda, c++11, closures

在 C++11 中，如何声明一个将 lambda 表达式作为参数的函数？我可以在网上找到大量用于声明 lambda 或将它们作为模板参数的资源，但我真正想做的是能够将 lambda 用作易于声明的回调处理程序，类似于通过闭包实现的功能在 JavaScript 和 Objective-C 中的代码块中。

本质上，我想用 lambda 替换的经典 C++ 构造类似于：

```
class MyCallback {
public:
    virtual ~MyCallback() {}
    virtual void operator(int arg) = 0;
};

void registerCallback(const std::shared_ptr<MyCallback> &);

void foo(void) {
    int a, b, c;
    class LocalCallback: public MyCallback {
        int a, b, c;
    public:
        LocalCallback(int a, int b, int c): a(a), b(b), c(c) {}
        void operator(int arg) { std::cout << (a+b+c)*arg << std::endl; }
    };
    registerCallback(std::shared_ptr<MyCallback>(new LocalCallback(a,b,c)));
} 
```

这将被简化为：

```
void registerCallback(/* WHAT GOES HERE? */);

void foo(void) {
    int a, b, c;
    registerCallback([=](int arg){std::cout << (a+b+c)*arg << std::endl; })
} 
```

那么，我写了`/* WHAT GOES HERE? */`什么？

编辑：这是为了存储回调以便稍后回调，而不是立即使用和调用它。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-23T20:18:24.070

通常`const std::function<void(int)> &`或`std::function<void(int)>`。

我不确定是否`std::function`应该通过 const 引用或值传递的判断是什么。可能按价值计算是可以的，特别是因为无论如何你都要复制它来存储。

如果在所有语法中间不清楚，它`void(int)`是一个函数类型，`std::function<T>`大致意思是“一个与 T 类型的函数具有相同签名的函子”。

Lambda 本身具有*匿名*类型。没有办法命名你的 lambda 表达式的类型，并且具有相同签名的不同 lambda 表达式的类型是不同的：

```
auto foo = [=](int arg){std::cout << (a+b+c)*arg << std::endl; };
auto bar = [=](int arg){std::cout << (a+b+c)*arg << std::endl; };
// foo and bar have different types, accessible as decltype(foo), decltype(bar) 
```

因此需要`std::function`，它基本上是一个类型擦除包装器，用于将具有相同签名的不同仿函数聚集到一个通用类型中。它是带有模板的静态多态性与您需要的动态多态性之间的桥梁，如果您想注册一个回调，将其存储以备后用，然后在不“记住”原始类型的情况下调用它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T20:16:33.753

```
void registerCallback(const std::function<void(int)>& callback); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-23T21:31:04.030

考虑使用函数模板。有很多很好的理由，例如重载时的更好行为（重载`std::function`是痛苦的）：

```
template<typename Functor>
void registerCallback(Functor&& functor); 
```

（您也可以接受参数为`Functor functor`，这不是太重要。）

如果代码需要`functor`稍后存储，*那么*它可能会保存在`std::function`. 您要避免的地方`std::function`是函数参数。

# java - Swing 图像显示优化

> ID：10727160
> 
> 赞同：4
> 
> 时间：2012-05-23T20:14:34.060
> 
> 标签：java, image, swing

我正在显示图像`Swing`。我在图像（一堆`drawRect()`调用）上绘图并刷新屏幕。图像是恒定的，但在顶部绘制的对象不是。有什么办法可以避免随时重绘图像吗？既然图形卡可能会显示图像，那么假设`drawRect()`调用是瓶颈是否安全？我每帧绘制多达 20,000 个调用（但通常不超过 3000 个）。

**编辑：**确实是 rect 调用减慢了它的速度，并且可以通过删除透明度通道来加快速度。话虽如此，加快速度并包括透明度仍然会很好。代码不能真正变得更简单，所以我希望通过做一些不同的事情会有所帮助。

```
public void paintComponent(Graphics g) {
    super.paintComponent(g) ;
    //grid or walkers
    g.drawImage(image, 0, 0, null);

    for(Walker w : walkArray){
        g.setColor(new Color(255,255-w.data[3], 0, w.data[2]));
        g.drawRect(w.data[0], w.data[1], 1, 1);
    }       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:38:51.210

这与上下文无关，但是您可以在预先计算的调色板中查找颜色，而不是`Color`在每个循环中创建 a 的实例吗？也许这可以稍微提高性能。

编辑：例如，此处使用 a[作为](https://stackoverflow.com/a/2124507/230513)`List<Integer>`RGB 查找表，[此处](https://stackoverflow.com/a/7298492/230513)`Queue<Color>`使用a 。

# android - android在拨打电话或发送短信时返回错误

> ID：10727167
> 
> 赞同：2
> 
> 时间：2012-05-23T20:15:23.827
> 
> 标签：android

android在拨打电话或发送短信时返回错误，它说“ `internal processing. please retry to later`”我知道这听起来语法不正确，但这正是拨打电话时显示错误的方式。关于错误含义或如何修复的任何想法问题 ？其他一切正常，wifi 连接到互联网，信号满格，电话网络的名称在那里。任何想法或建议将不胜感激。

# sql - SQL Azure 上的计划任务

> ID：10727169
> 
> 赞同：2
> 
> 时间：2012-05-23T20:15:31.137
> 
> 标签：sql, azure, task, azure-sql-database, schedule

实际上，我每天都在寻找一个系统来在精确的时间完成一项任务。这个任务是删除数据库中的一些条目。我有一个 Web 角色和一个 Sql Azure 数据库。我找到了一些教程，但没有什么非常有效和简单的。有人可以帮助我吗？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:20:29.017

看看这个 SO post [Scheduled Tasks with Sql Azure?](https://stackoverflow.com/questions/6057851/scheduled-tasks-with-sql-azure) .

到目前为止，SQL Server 中还没有与 SQL 作业相当的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T00:21:47.967

如果您愿意使用服务来执行此任务调度，则购买自己的工作人员角色的替代解决方案是使用支持此功能的[Cotega 。](http://www.cotega.com)例如，您可以安排它定期[启动存储过程。](http://cotega.com/docs/sql_azure_scheduled_job)

完全披露，我从事这项服务。

# c++ - C++：是否建议创建自己的 String 类？

> ID：10727171
> 
> 赞同：4
> 
> 时间：2012-05-23T20:15:46.953
> 
> 标签：c++, string, class

我正在看一本 C++ 教程书，作者说大多数 C++ 编译器都包含一个 String 类库，但即使有，还是建议创建自己的 String 类。不幸的是，作者没有说明原因。有没有人不同意/同意，为什么？

我正在使用 Xcode 并且提供的 String 类对我来说似乎很好，但话又说回来，我只使用了几个小时，所以我不知道这些限制。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T20:19:26.817

听起来你有一本旧书。

C++ 标准库包含`std::string`该类，您应该使用它，而不是自己发明并修复已在广泛使用的库中遇到和修复的错误。

由于您是初学者，是的，您应该尝试实施自己的方法，因为它会教给您很多东西。只是不要在任何“真实”项目中使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:19:35.087

> 建议创建自己的 String 类

我相信作者建议创建你自己的`String`类，作为一个很好的编程练习来培养你的技能。

`String`暗示为实际生产代码或非学术代码创建自己的类是荒谬的（至少可以说）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T20:19:58.727

C++ 没有`String`类。但是有一个`std::string`类涵盖了基本的字符串功能，并且被标准保证存在。要使用它，您需要`#include <string>`.

如果您发现自己需要比 中提供的更多功能`std::string`，您可以随时添加对字符串进行操作的免费函数。还有第三方字符串实现（MS's `CString`， RogueWave's `RWCstring`），但如果你只是做一些基本的事情，我个人认为它们不是很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T20:20:02.590

标准库的`std::string`类缺少字符串类中常见的许多功能，包括拆分字符串、匹配正则表达式、转换为整数等。我认为完全重写`std::string`类不是一个好主意（除非它与您的根本不兼容）需要），但是将类子`std::string`类化以提供其中一些功能会很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T21:31:04.460

出于某些原因，您可能想要创建自己的字符串类，例如，您可能想要创建一个不可变的字符串类，其函数针对创建新的派生字符串而不是修改现有字符串进行了优化，因为它们有时可以更好地处理大量多线程代码。但是，如果您正在阅读一本初学者的书，这当然不是您需要做的事情，并且可能至少应该重新考虑三遍。

正如人们所说，std::string 用于 99.9% 的事情。

# xml - Spring Batch 需要跳过无效的xml记录

> ID：10727172
> 
> 赞同：1
> 
> 时间：2012-05-23T20:15:54.440
> 
> 标签：xml, spring-batch

我们有一个业务需求来处理尽可能多的文件，然后移动

如果记录 98 中有 100 条记录的文件中存在错误，我们希望能够处理到该点并跳过文件的其余部分，继续下一个文件。

我们正在处理 MultiResourcePartitioner 中的文件。

```
<batch:step id="processXMLstep"> 
<batch:tasklet  transaction-manager="transactionManager">
<batch:chunk reader="myXmlItemReader" processor="myProcessor
   Writer="myDBWriter" commit-interval="100"  skip-limit="10000">
<batch:skippable-exception-classes>
<batch:include class="java.lang.Exception"/>
</batch:skippable-exception-classes> 
</batch:chunk>
<batch:listeners>
<batch:listener ref="myFileNameListener" /> 
</batch:listeners>
</batch:tasklet>
<batch:end on="FAILED"/>
</batch:step> 
```

阅读器正在使用 StaxEventItemReader。

我已向侦听器添加了 onProcessError()、onReadError()、onSkipInProcess()、onSkipInRead()、onSkipInWrite() 和 onWriteError() 方法。我可以看到代码命中 OnReadError() 方法（取决于 XML 错误，onSkipInRead() 方法）。

我可以在 OnReadError() 中做些什么来强制作业跳过文件的其余部分并移动到下一个文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T12:24:36.583

这里的问题与 StaxEventItemReader 中默认的 doRead() 方法引发的异常有关。我们必须编写一个自定义版本来检查特定的 XML 异常，然后将其作为自定义异常抛出（在 skippable-excpection-classes 中使用该自定义异常）。

这是自定义 doRead() 的示例：

```
 @Override
protected xmlObject doRead() throws CustomXmlException {
    try {
        return super.doRead();
    } catch (Exception e) {
        if (e instanceof DataAccessResourceFailureException) {
            Throwable cause = e.getCause();
            if (cause instanceof XMLStreamException) {
                throw new CustomXmlException(e.getMessage());
            }
        }
        if(e instanceof NonTransientResourceException) {
            e.printStackTrace();
        }
        e.printStackTrace();
        return null;
    }
} 
```

这是xml中的步骤：

```
 <batch:step id="processXMLstep"> 
    <batch:tasklet  transaction-manager="transactionManager">
        <batch:chunk reader="myXmlItemReader" processor="myProcessor" 
                 writer="myWriter" commit-interval="100" skip-limit="10000">
            <batch:skippable-exception-classes>
                <batch:include class="gov.irs.saas.etl.exception.CustomXmlException" /> 
            </batch:skippable-exception-classes> 
        </batch:chunk>
        <batch:listeners>
            <batch:listener ref="myFileNameListener" /> 
        </batch:listeners>
    </batch:tasklet>
    <batch:end on="FAILED"/>
</batch:step> 
```

这似乎解决了之前会使作业崩溃的 XML 错误（元素上缺少开始标记，以及缺少最后一个 xml 结束标记的截断文件）。

# c++ - Damerau–Levenshtein distance (Edit Distance with Transposition) c 实现

> ID：10727174
> 
> 赞同：12
> 
> 时间：2012-05-23T20:15:58.907
> 
> 标签：c++, string, string-matching, levenshtein-distance

我在 C++ 中实现了 Damerau-Levenshtein 距离，但它没有为输入（pantera，aorta）提供正确的 o/p，正确的 o/p 为 4，但我的代码给出了 5.....

```
int  editdist(string s,string t,int n,int m) 
{
    int d1,d2,d3,cost;
    int i,j;
    for(i=0;i<=n;i++) 
    {
        for(j=0;j<=m;j++)
        {
          if(s[i+1]==t[j+1]) 
              cost=0;
          else
              cost=1;
          d1=d[i][j+1]+1;
          d2=d[i+1][j]+1;
          d3=d[i][j]+cost;
          d[i+1][j+1]=minimum(d1,d2,d3);
          if(i>0 && j>0 && s[i+1]==t[j] && s[i]==t[j+1] )   //transposition
          {
              d[i+1][j+1]=min(d[i+1][j+1],d[i-1][j-1]+cost);
          }
        }
    }
    return d[n+1][m+1]; 
} 
```

我没有看到任何错误。有人能找到代码的问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T16:35:55.903

帖子中的算法不计算 Damerau-Levenshtein 距离。在[维基百科文章中](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)，该算法被定义为最佳字符串对齐距离。

DL 距离算法的 java 实现可以在另一个[SO 帖子](https://stackoverflow.com/a/6035519/1328439)中找到。

要获得正确的 OSA 距离值，请将`-`下面标有的线更改为标有的线`+`

```
 int  editdist(string s,string t,int n,int m) 
 {
     int d1,d2,d3,cost;
     int i,j;
     for(i=0;i<=n;i++) 
     {
         for(j=0;j<=m;j++)
         {
-          if(s[i+1]==t[j+1]) 
+          if(s[i+1]==t[j+1]) 
              cost=0;
           else
              cost=1;
           d1=d[i][j+1]+1;
           d2=d[i+1][j]+1;
           d3=d[i][j]+cost;
           d[i+1][j+1]=minimum(d1,d2,d3);
-          if(i>0 && j>0 && s[i+1]==t[j] && s[i]==t[j+1] )   //transposition
+          if(i>0 && j>0 && s[i]==t[j-1] && s[i-1]==t[j] )   //transposition
           {
               d[i+1][j+1]=min(d[i+1][j+1],d[i-1][j-1]+cost);
           }
         }
     }
     return d[n+1][m+1]; 
 } 
```

看起来好像代码是从用编程语言编写的程序中复制的，其中数组索引默认从 1 开始。因此，所有对距离数组元素的引用`d`都增加了。但是，对字符串中字符的引用是对基于 0 的数组的引用，因此不应更新它们。

要计算距离，必须正确初始化距离数组：

```
for( i = 0; i < n + 1; i++)
      d[i][0] = i;
for( j = 1; j < m + 1; j++)
      d[0][j] = j; 
```

既然你得到了答案 5，那么你的距离数组可能已经正确初始化了。

由于上述算法不计算 DL 距离，因此这里是 DL 算法的 C 实现的草图（源自带有 java impl 的 SO 帖子。源自 Wikipedia 文章中的 ActionScript impl。）。

```
#define d(i,j) dd[(i) * (m+2) + (j) ]
#define min(x,y) ((x) < (y) ? (x) : (y))
#define min3(a,b,c) ((a)< (b) ? min((a),(c)) : min((b),(c)))
#define min4(a,b,c,d) ((a)< (b) ? min3((a),(c),(d)) : min3((b),(c),(d)))

int dprint(int* dd, int n,int m){
 int i,j;
 for (i=0; i < n+2;i++){
    for (j=0;j < m+2; j++){
        printf("%02d ",d(i,j));
    }
    printf("\n");
 }
 printf("\n");
 return 0;
}

int dldist2(char *s, char* t, int n, int m) {
    int *dd;
    int i, j, cost, i1,j1,DB;
    int INFINITY = n + m;
    int DA[256 * sizeof(int)];

    memset(DA, 0, sizeof(DA));

    if (!(dd = (int*) malloc((n+2)*(m+2)*sizeof(int)))) {
      return -1;
    }

    d(0,0) = INFINITY;
    for(i = 0; i < n+1; i++) {
      d(i+1,1) = i ;
      d(i+1,0) = INFINITY;
    }
    for(j = 0; j<m+1; j++) {
      d(1,j+1) = j ;
      d(0,j+1) = INFINITY;
    }      
    dprint(dd,n,m);

    for(i = 1; i< n+1; i++) {
      DB = 0;
      for(j = 1; j< m+1; j++) {
        i1 = DA[t[j-1]];
        j1 = DB;
        cost = ((s[i-1]==t[j-1])?0:1);
        if(cost==0) DB = j;
        d(i+1,j+1) =
          min4(d(i,j)+cost,
              d(i+1,j) + 1,
              d(i,j+1)+1, 
              d(i1,j1) + (i-i1-1) + 1 + (j-j1-1));
      }
      DA[s[i-1]] = i;
      dprint(dd,n,m);
    }
    cost = d(n+1,m+1);
    free(dd);
    return cost;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-05-11T11:38:56.900

这是我的这个算法的 C++ 版本：

```
int damerau_levenshtein_distance(std::string p_string1, std::string p_string2)
{
    int l_string_length1 = p_string1.length();
    int l_string_length2 = p_string2.length();
    int d[l_string_length1+1][l_string_length2+1];

    int i;
    int j;
    int l_cost;

    for (i = 0;i <= l_string_length1;i++)
    {
        d[i][0] = i;
    }
    for(j = 0; j<= l_string_length2; j++)
    {
        d[0][j] = j;
    }
    for (i = 1;i <= l_string_length1;i++)
    {
        for(j = 1; j<= l_string_length2; j++)
        {
            if( p_string1[i-1] == p_string2[j-1] )
            {
                l_cost = 0;
            }
            else
            {
                l_cost = 1;
            }
            d[i][j] = std::min(
            d[i-1][j] + 1,                  // delete
            std::min(d[i][j-1] + 1,         // insert
            d[i-1][j-1] + l_cost)           // substitution
            );
            if( (i > 1) && 
            (j > 1) && 
            (p_string1[i-1] == p_string2[j-2]) && 
            (p_string1[i-2] == p_string2[j-1])
            ) 
            {
            d[i][j] = std::min(
            d[i][j],
             d[i-2][j-2] + l_cost   // transposition
            );
            }
        }
    }
    return d[l_string_length1][l_string_length2];
} 
```

# maven - 声纳不阅读 Jacoco 报告

> ID：10727177
> 
> 赞同：2
> 
> 时间：2012-05-23T20:16:05.877
> 
> 标签：maven, build, code-coverage, jacoco

我有一个项目，其集成测试由 maven-failsafe-plugin 运行，单元测试由 maven-surefire-plugin 运行。

我使用 jacoco 生成覆盖率报告：

```
<properties>
    <coverage.reports.dir>${project.build.directory}/coverage-reports</coverage.reports.dir>
    <sonar.jacoco.reportPath>${coverage.reports.dir}/jacoco-unit.exec</sonar.jacoco.reportPath>
    <sonar.jacoco.itReportPath>${coverage.reports.dir}/jacoco-it.exec</sonar.jacoco.itReportPath>
</properties>

[...]

        <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>0.5.7.201204190339</version>
            <executions>
                <execution>
                    <phase>pre-integration-test</phase>
                    <goals>
                        <goal>prepare-agent</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <propertyName>jacoco.agent.argLine</propertyName>
                <destFile>${sonar.jacoco.itReportPath}</destFile>
                <dataFile>${sonar.jacoco.itReportPath}</dataFile>
            </configuration>
        </plugin>

[...]

    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-failsafe-plugin</artifactId>
          <version>2.5</version>
          <configuration>
              <argLine>${jacoco.agent.argLine}</argLine> 
          </configuration>
    </plugin>

[...]

<profile>
  <id>dev</id>
  <properties>
    <sonar.core.codeCoveragePlugin>jacoco</sonar.core.codeCoveragePlugin>
    <sonar.dynamicAnalysis>reuseReports</sonar.dynamicAnalysis>
  </properties>
</profile>

[...] 
```

当我运行 mvn install 时，成功生成了 Jacoco 覆盖率报告。

但是当我运行 mvn -mvn -Pdev sonar:sonar 时，Sonar 使用 Cobertura 插件而不是 Jacoco。

我努力了：

1）在Sonar设置中将jacoco设置为默认覆盖插件[无效]

2) 在命令行中提供 Jacoco 参数（例如，-Dsonar.core.codeCoveragePlugin=jacoco）[效果不佳]

有人有什么主意吗？谢谢。

顺便说一句，我正在使用声纳 2.8

# c# - 将 8.3 文件名转换为长文件名

> ID：10727182
> 
> 赞同：2
> 
> 时间：2012-05-23T20:16:31.997
> 
> 标签：c#, .net, filenames

有一个以 8.3 短格式显示路径的网络位置。我需要将这些转换为长格式以便在 UNIX 上使用。

由于它是一个网络位置，我需要它需要使用 UNC 路径。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:20:59.423

将 short 转换为 long 的答案[只是谷歌搜索](http://csharparticles.blogspot.com/2005/07/long-and-short-file-name-conversion-in.html)。这[仅适用于 Windows Vista 及更高版本](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx)（以及可能带有某些服务包的 XP）上的 UNC 路径。

```
using System;
using System.Runtime.InteropServices;
using System.Text;

public class _Main
{
    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    public static extern int GetLongPathName(
        string path,
        StringBuilder longPath,
        int longPathLength
        );

    public static void Main()
    {
        StringBuilder longPath = new StringBuilder(255);
        GetLongPathName(@"\\?\UNC\server\d$\MYTEMP~1\RESOUR~1\sql.txt", longPath, longPath.Capacity);
        Console.WriteLine(longPath.ToString());
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-23T10:51:30.670

即使使用 UNC 路径，这也适用于我：

```
string shortName = @"\\MyComputer\c$\PROGRA~1";
string longName = new FileInfo(shortName).FullName; 
// ==> longname: \\MyComputer\c$\Program Files 
```

# powershell - 有没有办法让我在 powershell 运行时以编程方式获取 Powershell 输入和输出？

> ID：10727184
> 
> 赞同：2
> 
> 时间：2012-05-23T20:16:34.247
> 
> 标签：powershell, powershell-2.0, powershell-1.0

我有一个场景，我需要将 powershell 命令的命令和输出转发到另一个进程进行日志记录和处理。

我希望这个控制台尽可能接近 powershell，因此不希望将它简单地托管在另一个控制台程序中。

还有 start-transcript，但这似乎是缓冲的。我需要逐行获取控制台输出。

如果有办法让我在 System.Management.Automation.Internal.Host.InternalHostUserInterface 调用中的 WriteLine 期间在 powershell 主机上设置一个委托，那也是可行的。

这样做的最佳方法是什么？

更新（2012 年 5 月 29 日）：我愿意不遗余力地做到这一点：

```
FieldInfo internaluiref = host.GetType().GetField("internalUIRef", BindingFlags.NonPublic | BindingFlags.Instance);
object valuecontainer = internaluiref.GetValue(host);
FieldInfo objectrefvalue = valuecontainer.GetType().GetField("_oldValue", BindingFlags.NonPublic | BindingFlags.Instance);
PSHostUserInterface internalHostUserInterface = (PSHostUserInterface)objectrefvalue.GetValue(valuecontainer);
FieldInfo externalUI = internalHostUserInterface.GetType().GetField("externalUI", BindingFlags.NonPublic | BindingFlags.Instance);
PSHostUserInterface externalHostUserInterface = (PSHostUserInterface)externalUI.GetValue(internalHostUserInterface);
HostUserInterfaceProxy indirector = new HostUserInterfaceProxy(externalHostUserInterface);
externalUI.SetValue(internalHostUserInterface, indirector); 
```

这使我能够获得分类的输出流信息。

任何想法如何获得输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:49:57.120

不要将*格式化*输出与原始输出混淆。任何到达主机接口的东西都已经被转换成一个字符串。如果您想要从 powershell 脚本返回的实际对象，请在此处查看我的其他答案，了解如何从 C# 中执行的脚本块流式传输输出：

[如何流式传输以编程方式执行的 ScriptBlock 的输出？](https://stackoverflow.com/questions/5183389/how-to-stream-the-output-of-a-programmatically-executed-scriptblock)

# javascript - 将 AJAX 流保存为 PDF 文件

> ID：10727185
> 
> 赞同：0
> 
> 时间：2012-05-23T20:16:37.587
> 
> 标签：javascript, ajax, pdf, xmlhttprequest

我正在尝试将 XMLHTTPRequest 的结果保存到 PDF 文件中。

我正在与我正在调用的服务器进行通信，以获取格式化为 PDF 数据的一大块数据。我正在使用 XMLHTTPRequets 登录到服务器，然后发出一个搜索请求，然后创建一个 PDF，该 PDF 通过 XMLHTTPRequest 流回给我。

我需要将该结果保存为 PDF，以便稍后在 Acrobat 中打开它。

当我将响应文本保存到文件时，结果不是有效的 PDF。该请求正在对流执行某些操作，使其作为 PDF 无效。

我无法控制该服务器，因此我无法让它发回指向临时有效 PDF 文件的链接。

有办法解决吗？有没有办法将该流编码为有效的 PDF 文件？

我正在为该应用程序使用 Javascript。

谢谢

埃雷兹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:22:26.110

您可以做的是从您的 http 服务器返回一个 xml 文件，如下所示：

```
<resp><![CDATA[YOURPDFSTREAM]]></resp> 
```

他们检索 RESP 节点来构建您的 pdf 文件。

不要忘记以所需的编码格式对您的流进行编码。

# android - HttpURLConnection 似乎没有在 Android 上使用缓存

> ID：10727189
> 
> 赞同：1
> 
> 时间：2012-05-23T20:16:55.640
> 
> 标签：android, httpclient, network-protocols, httpresponse, httpurlconnection

我最近将我的应用程序从使用 AndroidHTTPClient 切换到使用 HttpURLConnection。我正在尝试使 HttpURLConnection 的缓存功能起作用，但没有成功。

这是我执行 Http 请求的代码

```
 URL url = new URL(currentURL);

    ResultAndUrl result = null;
    final HttpURLConnection httpUrlConnection = (HttpURLConnection) urll.openConnection();
    httpUrlConnection.setUseCaches(true);
    try {
        InputStream in = new BufferedInputStream(httpUrlConnection.getInputStream());
        result = new ResultAndUrl();
        result.result = convertStreamToString(in);
        result.url = currentURL;
    } catch (final Exception e) {
        try {
            Log.e("NETWORK", e.getMessage());
        } catch (Exception ee) {

        }
    } finally {
        try {
            httpUrlConnection.disconnect();
        } catch (Exception e) {
        }
    } 
```

同样在我的应用程序类中，我有

```
public void enableHttpResponseCache() {
    final long httpCacheSize = 10 * 1024 * 1024; // 10 MiB
    final File httpCacheDir = new File(getCacheDir(), "http");
    try {
        Class.forName("android.net.http.HttpResponseCache")
            .getMethod("install", File.class, long.class)
            .invoke(null, httpCacheDir, httpCacheSize);
    } catch (Exception httpResponseCacheNotAvailable) {
        try{
            HttpResponseCache.install(httpCacheDir, httpCacheSize); // Library that implements HttpResponseCache for pre-ICS phones
        } catch(Exception e){
        }
    }
} 
```

然而，即使对于 ICS 手机，也没有发生过缓存命中，而且缓存似乎根本没有做任何事情。你能告诉我我做错了什么，或者错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T16:04:46.333

[http://pastebin.com/i60a90wv](http://pastebin.com/i60a90wv)

上面链接中的“更新”方法是使用 http 线程池、https 和 http 帖子的示例代码。因此，除了建议上述评论中的链接外，我还在 android 中使用了它们。

更多代码（来自 HttpConnectionPost 类的可运行代码：

```
 public void run() {
//      Log.d(TAG, "run ENTRY instance"  +entry.toString());
        handler.sendMessage(Message.obtain(handler, HttpConnection.DID_START));
        HttpParams params = new BasicHttpParams();
        HttpConnectionParams.setConnectionTimeout(params, 40 * 1000);
        HttpConnectionParams.setSoTimeout(params, 20 * 1000);
        HttpProtocolParams.setVersion(params, HttpVersion.HTTP_1_1);

        httpClient = new DefaultHttpClient(MyConnectionManager.getInstance(), params);
//      HttpConnectionParams.setSoTimeout(httpClient.getParams(), 25000);
        httpClient.addRequestInterceptor(new HttpRequestInterceptor() {
            public void process(
                    final HttpRequest request, 
                    final HttpContext context) throws HttpException, IOException {
                if (!request.containsHeader("Authorization")) {
                    request.addHeader("Authorization", "OAuth " +ClientCustomSSL.getInstance().getToken());
                }
            }

        }); 
        try {
            HttpResponse response = null;
            switch (method) {

            case POST:
                HttpPost httpPost = new HttpPost(url);
                if (data != null){
                    System.out.println(" post data not null ");
                    httpPost.setEntity(new StringEntity(data));
                }
                if (entry != null){
                    ContentProducer cp = new ContentProducer() {
                        public void writeTo(OutputStream outstream) throws IOException {

                             ExtensionProfile ep = new ExtensionProfile();
                             ep.addDeclarations(entry);
                             XmlWriter xmlWriter = new XmlWriter(new OutputStreamWriter(outstream, "UTF-8"));
                             entry.generate(xmlWriter, ep);
                             xmlWriter.flush();
                        }
                    };
                    httpPost.setEntity(new EntityTemplate(cp));
                }
                httpPost.addHeader("GData-Version", "2");
                httpPost.addHeader("X-HTTP-Method-Override", "PATCH");
                httpPost.addHeader("If-Match", "*");
                httpPost.addHeader("Content-Type", "application/xml");
                response = httpClient.execute(httpPost);

                break;
            }
            if (method < BITMAP)
                processEntity(response.getEntity());
        } catch (Exception e) {
            handler.sendMessage(Message.obtain(handler,
                    HttpConnection.DID_ERROR, e));
        }
        MyConnectionManager.getInstance().didComplete(this);
    } 
```

# apache - htaccess 重写规则没有 R 标志创建外部重定向

> ID：10727190
> 
> 赞同：2
> 
> 时间：2012-05-23T20:16:57.937
> 
> 标签：apache, .htaccess, redirect

我正在做我认为是简单的 .htaccess 重写以创建更好的 url。我想要这样的网址：

```
http://my-site.com/design/design-name/ 
```

像这样替换网址：

```
http://my-site.com/store?design=design-name 
```

所以我将此规则添加到我的 .htaccess 中：

```
RewriteEngine On
RewriteRule ^design/(.+) http://my-site.com/store?design=$1 [L] 
```

但是，它的行为就好像有一个 R 标志和**外部**重定向（更改浏览器地址栏中的 url）。重定向工作正常，但它不应该只是使用我正在使用的规则进行**内部重定向吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T19:53:52.933

安萨里是正确的。[如此处](http://www.webmasterworld.com/apache/3784628.htm)所述，在目标 URL 中包含域名会将其转换为 302 重定向。改变

```
RewriteRule ^design/(.+) http://my-site.com/store?design=$1 [L] 
```

到

```
RewriteRule ^design/(.+) store?design=$1 [L] 
```

它应该可以正常工作。

# java - 如何创建可以保留在内存中并可供所有其他类访问的类的对象？

> ID：10727191
> 
> 赞同：0
> 
> 时间：2012-05-23T20:16:59.947
> 
> 标签：java, android

我解析一个 html 文档并将数据保存在类中。我如何从不同的类访问该类而无需再次启动它，因为我想使用该类的一个版本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:06:42.893

为什么不将其设置为静态变量？

公共静态 HtmlData 数据；

私人无效解析（）{···数据=结果；}

// 现在您可以通过调用 HtmlData.data 在代码中的任何位置使用数据对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T10:54:53.583

正如您在评论中所说，单例将是要走的路。单例持有并管理自己的实例，因此您可以将同一个实例返回给所有请求它的人。

口号“依赖注入”，最佳实践，而不是直接通过静态访问调用工厂，将实例保存在您需要的类中的私有属性中，并以集中的方式使用公共设置器“注入依赖”，同时初始化您的应用。

# wordpress - 向 WordPress 导航菜单添加额外字段

> ID：10727204
> 
> 赞同：0
> 
> 时间：2012-05-23T20:18:08.037
> 
> 标签：wordpress

有没有办法可以在 WordPress 导航菜单中添加额外的字段？我知道您可以添加描述，但是添加其他字段呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:39:35.760

除了管理员中提供的字段之外，您还想要哪些其他字段？导航菜单只有： - 名称 - 链接 - 链接标题

# jquery-ui - AngularJS - jQuery UI - 绑定问题

> ID：10727207
> 
> 赞同：8
> 
> 时间：2012-05-23T20:18:47.307
> 
> 标签：jquery-ui, angularjs

我目前正在将一个大型应用程序移植到一个基于 HTML5 的 Web 应用程序 - 我已经开始在 AngularJS 中构建应用程序并享受 AngularJS 框架的强大功能 - 我目前遇到一个问题：

我有一个指令，它给了我一个 jQuery Datepicker，但是与模型的绑定似乎不起作用。

[http://jsfiddle.net/9BRNf/](http://jsfiddle.net/9BRNf/)

我可能误解了指令的工作方式，并想看看我是否可以修补这部分我对框架的理解。我已经浏览了大量示例（包括 github 上的 angularui 项目，但仍然不明白为什么绑定没有发生）

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-20T06:00:28.347

对于那些在谷歌上搜索这个问题的人（就像我一样），将 jQuery UI 日期选择器与 Angular 绑定的更简单方法是这样做......

```
$.datepicker.setDefaults({
    // When a date is selected from the picker
    onSelect: function(newValue) {
        if (window.angular && angular.element)
            // Update the angular model
            angular.element(this).controller("ngModel").$setViewValue(newValue);
    }
}); 
```

只需将它放在您的初始化代码*之前。*`.datepicker()`

*（取自我在这里发布的另一个答案：[https](https://stackoverflow.com/a/17206242/195835) ://stackoverflow.com/a/17206242/195835 ）*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T18:41:37.513

首先，您使用 angularjs 真是太好了，它是一个很好的框架。不久前开始了一个分支项目，以处理诸如包装 jquery-ui 和创建 ui 模块之类的事情。

下面是 Peter Bacon Darwin 实现的链接。

[https://github.com/angular-ui/angular-ui/tree/master/modules/directives/date](https://github.com/angular-ui/angular-ui/tree/master/modules/directives/date)

- 担

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T01:02:01.563

angular-ui datepicker 不适用于 Angular 1.0.0，所以我重写了它。我的 fork 使您能够设置日期在输入中的格式以及如何将其保存回模型。

代码： [https:](https://gist.github.com/2967979) //gist.github.com/2967979 jsFiddle：http: [//jsfiddle.net/m8L8Y/8/](http://jsfiddle.net/m8L8Y/8/)（它缺少 jquery-ui 样式但工作方式相同）

* * *

```
// Code inspired by angular-ui https://github.com/angular-ui/angular-ui/blob/master/modules/directives/date/src/date.js
/*
Features:
* via the ui-date attribute:
    * Ability to say how model is parsed into a date object
    * Ability to say how input's value is parsed into a date object
    * Ability to say how a date object is saved to the model
    * Ability to say how a date object is displayed in the input
* via the ui-date-picker attribute
    * Ability to directly configure the jQuery-ui datepicker
*/

angular.module('ui.directives', [])
    .directive('uiDate', function () {
        return {
            require: '?ngModel',
            //scope: {},
            link: function ($scope, element, attrs, ngModel) {
                // Date Handling Functions
                var dateHandler = $.extend({ model: {}, view: {} }, $scope.$eval(attrs.uiDate));

                // This will attempt to use preferredParser to parse a date.
                function defaultDateParse(date, preferredParser) {
                    if (!preferredParser)
                        return new Date(date);
                    return preferredParser(date);
                }

                // This will attempt to use preferredFormatter to format a date, otherwise use 'mm/dd/yy'.
                function defaultDateFormatter(date, preferredFormatter) {
                    if (!preferredFormatter)
                        preferredFormatter = "mm/dd/yy";

                    if (typeof preferredFormatter == 'string')
                        return $.datepicker.formatDate(preferredFormatter, date);
                    else
                        return preferredFormatter(date);
                }

                // Functions for Parsing & Formatting on the Model & View
                function parseDateFromModel(date) {
                    return defaultDateParse(date, dateHandler.model.parse)
                }
                function parseDateFromView(date) {
                    return defaultDateParse(date, dateHandler.view.parse)
                }
                function formatDateForModel(date) {
                    return defaultDateFormatter(date, dateHandler.model.format)
                }
                function formatDateForView(date) {
                    return defaultDateFormatter(date, dateHandler.view.format)
                }

                var defaultDateViewFormat = (
                    typeof dateHandler.view.format == 'string'
                    ? dateHandler.view.format
                    : 'mm/dd/yy'
                )

                // Initialize the jQuery-ui datePicker
                var datePickerSettings = $.extend({ dateFormat: defaultDateViewFormat }, $scope.$eval(attrs.uiDatePicker))
                var oldOnSelect = datePickerSettings.onSelect;
                datePickerSettings.onSelect = function (dateVal) {
                    $scope.$apply(function () {
                        element.focus().val(dateVal);
                        updateModel();
                    })
                    if (oldOnSelect)
                        oldOnSelect.apply(this, arguments)
                }

                element.datepicker(datePickerSettings);

                if (ngModel) {
                    // Specify how UI should be updated
                    ngModel.$render = function () {
                        element.val(ngModel.$viewValue || '');
                    };

                    // Listen for change events to enable binding
                    element.bind('blur keyup change', function () {
                        $scope.$apply(updateModel);
                    });

                    // Write data to the model
                    function updateModel() {
                        ngModel.$setViewValue(element.val());
                    }

                    // Convert the model into a string value
                    ngModel.$formatters.push(function (v) {
                        if (v != "" && v != null)
                            return formatDateForView(parseDateFromModel(v));
                        return null;
                    });

                    // Convert the string value into the model
                    ngModel.$parsers.push(function (v) {
                        if (v != "" && v != null)
                            return formatDateForModel(parseDateFromView(v))
                        return null;
                    });
                }

            }
        };
    }) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T21:08:45.977

类似于 praveepd（使用他们的作为基础），但这将包括深度模型选择。

[http://jsfiddle.net/c8PMa/](http://jsfiddle.net/c8PMa/)

```
var myApp = angular.module('myApp', ['myApp.directives']);

function MainCtrl($scope) {

    $scope.deepValue = {
        fromDate: null,
        toDate: null
    }

}

angular.module('myApp.directives', [])
  .directive('myDatepicker', function() {
    return function(scope, element, attrs) {     

       element.datepicker({
         changeYear : true,
         changeMonth : true,
         appendText : '(yyyy-mm-dd)',
         dateFormat : 'yy-mm-dd', 
                onSelect: function(dateText) {                    
                    var mdlAttr = $(this).attr('ng-model').split(".");

                    if (mdlAttr.length > 1) {

                        var objAttr = mdlAttr[mdlAttr.length-1];
                        var s = scope[mdlAttr[0]];

                        for (var i=0; i < mdlAttr.length-2; i++) {
                            s = s[mdlAttr[i]];
                        }

                        s[objAttr] = dateText;
                    } else {
                        scope[mdlAttr[0]] = dateText;
                    }

                    scope.$apply();
                }                
        });

    }
});​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-16T12:36:10.623

[http://jsfiddle.net/9BRNf/74/](http://jsfiddle.net/9BRNf/74/)这里是解决方案:)

代码：

```
 var myApp = angular.module('myApp', ['myApp.directives']);

    function MainCtrl() {

    }

    angular.module('myApp.directives', [])
      .directive('myDatepicker', function() {
          return {
             require: '?ngModel',
                link: function (scope, element, attrs, ngModelCtrl) {
          element.datepicker({
             changeYear : true,
             changeMonth : true,
             appendText : '(yyyy-mm-dd)',
             dateFormat : 'yy-mm-dd',
              onSelect: function(date) {
                  ngModelCtrl.$setViewValue(date);
                            scope.$apply();
              }
          });
        }
      }

  }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-25T09:19:13.420

我刚刚修剪了代码，看看这个：http: [//jsfiddle.net/YU5mV/](http://jsfiddle.net/YU5mV/)

**HTML**

```
<input id="date1" value="1/1/1980"  ng-model="fromDate" my-datepicker />
<input id="date2" value="1/1/1980" ng-model="toDate" my-datepicker /> 
```

**JavaScript**

```
angular.module('myApp.directives', [])
  .directive('myDatepicker', function() {
    return function(scope, element, attrs) {     

       element.datepicker({
         changeYear : true,
         changeMonth : true,
         appendText : '(yyyy-mm-dd)',
         dateFormat : 'yy-mm-dd', 
            onSelect: function(dateText) {                    
                var mdlAttr = $(this).attr('ng-model');
                scope[mdlAttr] = dateText;                    
                scope.$apply();                                                   
            }                
        });

    }
  }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-23T01:53:05.870

老问题，但这是我在谷歌搜索中的第一个命中。无论如何，我使用了使用 jquery 和 angular 指令一起工作的双日期选择器，所以我想我会分享以帮助其他尝试这样做的人。

这是它的笨拙：

[http://plnkr.co/edit/veEmtCM3ZnQAhGTn5EGy?p=preview](http://plnkr.co/edit/veEmtCM3ZnQAhGTn5EGy?p=preview)

基本上它使用 json 初始化表单。datepickers 有他们自己的条件，如 mindate 等。如果 true = 禁用日历上的星期日，则第一个选择框会启用它们。

单击“完成”时，视图模型会更新。这是其中一个日期选择器的一些代码：

**html:**

```
<input id="StartDate" data-ng-model="viewModel.startdate" date-from /> 
```

**指令**：

```
app.directive('dateFrom', function() {
    return function (scope, element, attrs) {
        var doDate = $('#EndDate');
        element.datepicker({
          dateFormat: 'dd-M-yy', showOtherMonths: true, 
          selectOtherMonths: true, minDate: '0',
          beforeShowDay: function (date) {
              var day = date.getDay();
              console.log(scope.nosunday);
              if (scope.nosunday === 'true') return [(day !== 0), '']; // disable sundays
              else return [true, ''];
          },
          onSelect: function (selectedDate) {
              var toDate = new Date(element.datepicker("getDate"));
              toDate.setDate(toDate.getDate() + 1);
              doDate.datepicker('option', 'minDate', toDate);
              scope.viewModel.startdate = selectedDate;
              scope.viewModel.enddate = doDate.val();
          }
        });
    }
}) 
```

随意进一步优化它。如果您这样做，请发表带有分叉的评论：)

# visual-studio-2010 - 是否可以为来自 Visual Studio 安装项目中的合并模块的文件创建快捷方式？

> ID：10727216
> 
> 赞同：0
> 
> 时间：2012-05-23T20:19:34.460
> 
> 标签：visual-studio-2010, setup-project, merge-module

我在 Visual Studio 2010 中有一个安装和部署项目，它使用一些合并模块来安装我的程序运行所需的一些依赖项。其中一个 MSM 文件包含一个可执行文件，我想在“程序文件”菜单中创建一个快捷方式。这是可能的还是这（我继续学习......）安装和部署项目的另一个烦人的限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:49:30.143

您不能将快捷方式链接到合并模块文件。但是，快捷方式目标是[格式化的](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368609%28v=vs.85%29.aspx)。因此，您可以简单地使用将解析为合并模块文件路径的格式化值。

例如，快捷方式目标可以是这样的：

```
[ProgramFilesFolder][Manufacturer]\[ProductName]\myFile.exe 
```

只有当它的目标存在于磁盘上时，才会创建这种类型的快捷方式。

# xml - 如何将步骤 1 中 XML 响应节点的值分配给 soapUI 中步骤 2 中的属性？

> ID：10727218
> 
> 赞同：0
> 
> 时间：2012-05-23T20:19:36.380
> 
> 标签：xml, soapui

我有一个soapUI 测试步骤，可以在我的数据库中创建一个对象。我返回的 XML 响应包含一个我需要在下一步中引用的节点，即我需要键 'guid' 之后的值

```
<flex.messaging.io.amf.ASObject serialization="custom">
  <unserializable-parents/>
  <map>
    <default>
      <loadFactor>0.75</loadFactor>
      <threshold>48</threshold>
    </default>
    <int>64</int>
    <int>28</int>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <null/>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <object-array/>
    <string>key</string>
    <flex.messaging.io.amf.ASObject serialization="custom">
      <unserializable-parents/>
      <map>
        <default>
          <loadFactor>0.75</loadFactor>
          <threshold>12</threshold>
        </default>
        <int>16</int>
        <int>3</int>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
      </map>
      <flex.messaging.io.amf.ASObject>
        <default>
          <inHashCode>false</inHashCode>
          <inToString>false</inToString>
          <namedType>package/class</namedType>
        </default>
      </flex.messaging.io.amf.ASObject>
    </flex.messaging.io.amf.ASObject>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <boolean>value</boolean>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <flex.messaging.io.amf.ASObject serialization="custom">
      <unserializable-parents/>
      <map>
        <default>
          <loadFactor>0.75</loadFactor>
          <threshold>12</threshold>
        </default>
        <int>16</int>
        <int>5</int>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
        <string>key</string>
        <boolean>value</boolean>
      </map>
      <flex.messaging.io.amf.ASObject>
        <default>
          <inHashCode>false</inHashCode>
          <inToString>false</inToString>
          <namedType>package/class</namedType>
        </default>
      </flex.messaging.io.amf.ASObject>
    </flex.messaging.io.amf.ASObject>
    <string>guid</string>
    <string>818f40db-c217-46ed-a6a2-7c830d894a95</string>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <null/>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <string>value</string>
    <string>key</string>
    <null/>
    <string>key</string>
    <null/>
  </map>
  <flex.messaging.io.amf.ASObject>
    <default>
      <inHashCode>false</inHashCode>
      <inToString>false</inToString>
      <namedType>package/class</namedType>
    </default>
  </flex.messaging.io.amf.ASObject>
</flex.messaging.io.amf.ASObject> 
```

我已经看到了关于这个主题的各种问题，但似乎没有一个对我有用，我相信由于我错误地理解了soapUI 期望的语法。

如果测试步骤一称为“stepOne”并且我需要在“stepTwo”中引用 XML 响应，为什么：

def temp = context.expand('${stepOne#Response//map[1]/string[27]}');

...不行。我假设我错误地引用了响应。我什至会在下一步中找到一种引用整个响应的方法。然后我可以搜索它并使用 groovy 找到我需要的值。

我应该尝试进行财产转让吗？如果是这样，源将是 stepOne，响应将是 ResponseAsXml，目标将是 stepTwo，但我真的不想将整个 xml 分配给属性，我只想分配我需要的节点（map [1] /字符串[27]）。

@Sebi-是的，我已经尝试过了，我已经无数次浏览了这个页面。我可以将整个响应转移到 TestCase 级别的临时属性，但我似乎无法在脚本窗口中构建代码以正确引用此属性......这就是我现在拥有的 ' def temp = ${#TestCaseName# tempProperty} ' 但这不起作用。我想把整个 xml 带进来，这样我就可以处理我需要的节点并不总是“map”中的第 27 个“string”的情况。我在声明命名空间时也遇到了麻烦（请参阅 xml 结构） soapUI 教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T10:08:52.297

是的，我们改为使用**Property Transfer TestStep**！

> 但我真的不想将整个 xml 分配给一个属性，我只想分配我需要的节点

在源选择框下方，您有一个输入框。在那里，您可以编写要传输的节点的 XPath 表达式。

你可以在这里找到一个很好的教程：http: [//www.soapui.org/Functional-Testing/transfering-property-values.html](http://www.soapui.org/Functional-Testing/transfering-property-values.html)

# c# - 动态创建匹配的正则表达式模式

> ID：10727219
> 
> 赞同：0
> 
> 时间：2012-05-23T20:19:46.157
> 
> 标签：c#, asp.net, regex

```
using Visual.Web.Developer.2010.Express; 
```

N00b 在这里，
我在泡菜.. 我正在尝试创建一个具有 2 个文本区域的 Web 应用程序，用户可以在其中输入 2 个名称列表（为了识别，这些文本区域是`aT2`和 `aT1`）..`aT2`包含名称，并`aT1`包含相同的名称，但我已根据自己的喜好稍微更改了它们。事情是`aT2`包含`aT1`没有的名称（这意味着我想排除那些在我过滤后不存在的名称`aT2`）基本上搜索`aT2`以查看哪些匹配。

这里有一些`aT1`：

```
ABC9910A
ABC42554
LOW3381
BD6210HFP
NWP448A1S
OTT123A04NS 
```

这里有一些`aT2`：

```
APPLEMACHINE    Y   ABC9910AIMAP
APPLEMACHINE    Y   ABC42554AIRAJZ
BANANABOI   Y   LOW33811CBZ
LLBLEAD TECHN   Y   NWP448A1S3LWXFTMA1
LLBLEAD TECHN   Y   OTT123A04NS4NSGATMA1 
```

我要问的是如何为每个项目动态创建一个新的正则表达式模式`aT1`？你看到第一个项目如何`aT1`匹配第一个项目`aT2`？它们几乎总是不会像那样排列...但是为正则表达式动态创建一个搜索模式以搜索`aT2`“aT1”中的每个项目。如果有匹配项，它将打印出之前的整行文本文本区域中的换行符..我足够具体吗？这甚至可能吗？
提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:24:34.510

我认为 RegEx 模式对于您的要求可能有点矫枉过正。您可能想看看简单地使用[Contains](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx)。

# java - 使用 UTF-8 将 Java 对象序列化为字符串

> ID：10727220
> 
> 赞同：2
> 
> 时间：2012-05-23T20:19:48.113
> 
> 标签：java

我正在尝试编写一个函数，该函数使用 UTF-8 编码将 Java 对象序列化为字符串。这是我的实现：

```
public static String serializeToString(DefaultMutableTreeNode tree) {
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    try {
        ObjectOutput out = new ObjectOutputStream(byteArrayOutputStream);
        out.writeObject(tree);
        return byteArrayOutputStream.toString("UTF-8");
    } catch (IOException e) {
        return null;
    }
} 
```

但是，它似乎不起作用。我试图将生成的字符串传递到只接受 UTF-8 编码但因编码问题错误而失败的数据库中。

我的问题是：

1.  我的实施有什么问题？
2.  如何检查结果字符串是否为 UTF-8？

非常感谢

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:49:22.370

这不是一个好主意，任意二进制数组并不总是转换为有效的 UTF-8 序列。您应该将数组作为二进制 blob 放入数据库中，或者将数组转换为具有类似 Base64 编码的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:26:33.683

> 我正在尝试编写一个函数，该函数使用 UTF-8 编码将 Java 对象序列化为字符串。

是的......好吧，您的代码*实际上*正在做的是将对象序列化为字节，然后告诉`String`构造函数“这些字节是某些 Unicode 代码点的有效 UTF-8 编码”。问题是（一般来说）它们不是……当 UTF-8 解码器尝试将它们转换为 Java 字符串中使用的 UTF-16 表示时，它会发现无效的序列并将它们替换为“无效字符”代码点。

如果要将任意字节表示为 Java 字符串，则需要使用 base64 编码之类的东西。一个更好的主意是将字节作为 Blob 放入数据库中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:57:47.170

你一定会在你的字符串中得到不可打印的字符，而数据库根本不喜欢这些字符。Java ByteArrayOutputStream 文档暗示它可能会将不可打印的字符重新编码为可打印的，但是，查看代码，我看不出它除了停止程序并出现错误之外什么都做。我也看不到你将来会用这样的字符串做什么。

一个字节的 256 个可能值中只有一部分（大约四分之一）是有效的 ASCII 字符。大多数数据库不会将它们作为字符串的一部分。因此你的错误信息。（Unicode 和 UTF-8 有同样的问题。）

我曾经通过将每 6 位转换为包含可打印字符的字节将二进制数据转换为可打印字符，从而将二进制数据存储在数据库中。但是我使用了简单的 ASCII 编码，并编写了代码将字符转换*回*二进制。然后我能够将二进制数据存储在数据库字符列中并稍后检索它。我是被迫的。我不建议你这样做。

如果您想查看“字符串”的外观，只需将每个字节打印为整数并将其与 ASCII 表进行比较。您可能会看到问题，而无需考虑 Unicode 的优点。

# android - 在我的 LinearLayout 上画一些东西？

> ID：10727225
> 
> 赞同：2
> 
> 时间：2012-05-23T20:20:05.493
> 
> 标签：android

我正在扩展线性布局：

```
public class MyLinearLayout extends LinearLayout {
    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);

        Paint paint = new Paint();
        paint.setColor(0xFFFF0000);
        canvas.drawLine(0, 0, getWidth(), getHeight(), paint);
    }
} 
```

如果布局有子元素，上面的红线不应该画在上面吗？考虑如下布局：

```
<MyLinearLayout>
    <ImageView />
</MyLinearLayout> 
```

我希望在子 ImageView 上方绘制红线。但它被画在它下面。我假设在 super.onDraw() 行完成后所有子绘图都已完成。

有没有办法在所有子绘图完成后到达画布并在上面画一些东西？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T20:24:35.540

除非您调用，否则布局不会绘制`setWillNotDraw(false);`。他们这样做是出于效率原因。

**编辑**：

`onDraw()`真正的意思是只允许您`Canvas`在绘图操作发生之前修改。它实际上并没有绘制。你想要做的是`draw()`像这样覆盖：

```
@Override
protected void draw(Canvas canvas) {
    super.draw(canvas);

    Paint paint = new Paint();
    paint.setColor(0xFFFF0000);
    canvas.drawLine(0, 0, getWidth(), getHeight(), paint);
} 
```

调用 super 将绘制视图中的所有子项。然后它将绘制所有线条。我仍然相信你需要`setWillNotDraw(false)`被召唤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T16:16:31.963

我正在重写我的答案，因为我没有看到你在画布上绘制的代码行。

像其他一些图形环境一样，画布是反转的。所以调用 getHeight() 实际上是在底部画线。而是打电话

```
 canvas.drawLine( 0, 0, getWidth(), 0, paint); 
```

这意味着在顶部画线，横跨视图的宽度。

此外，调用 super first 会在任何自定义绘画之前先绘制孩子，这样你就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-10T18:02:07.063

如果你有一个 LinearLayout 并且你需要：

1.  首先绘制所有子元素，例如按钮、图像视图
2.  然后，在这些组件之上，直接在画布上绘制一些东西。

    你可以试试这个：

    ```
    公共类 YourClass 扩展了 LinearLayout
    {
    @覆盖
    受保护的无效dispatchDraw（帆布画布）
    {
        super.dispatchDraw(画布);

    `// do your custom drawings afterwards

    canvas.drawCircle...
    canvas.drawLine...` 
    ```

# android - 自定义 Honeycomb 操作栏上的“完成”按钮样式

> ID：10727226
> 
> 赞同：3
> 
> 时间：2012-05-23T20:20:06.880
> 
> 标签：android, android-3.0-honeycomb

检查列表中的项目后，希望自定义操作栏左上角的“完成”按钮（高度、背景和文本颜色）。HTC Jetstream 应用的绿色风格不是我想要的。

我需要在哪里应用我需要的样式？

# css - Twitter脚本在div中不起作用

> ID：10727232
> 
> 赞同：0
> 
> 时间：2012-05-23T20:20:32.873
> 
> 标签：css, html, twitter

IM 对 html/css 等非常陌生，我试图将 twitter 提要嵌套到 div 中，但我无法让它出现在 div 容器中

```
<div id="leftmaincontainer"> <m3>Up and Coming Gigs</m3> <br />
<br />
<script src="http://widgets.twimg.com/j/2/widget.js" charset="utf-8"></script>
<script>
new TWTR.Widget({
  version: 2,
  type: 'profile',
  rpp: 4,
  interval: 30000,
  width: 250,
  height: 300,
  theme: {
    shell: {
      background: '#333333',
      color: '#ffffff'
    },
    tweets: {
      background: '#000000',
      color: '#ffffff',
      links: '#eb0707'
    }
  },
  features: {
    scrollbar: false,
    loop: false,
    live: false,
    behavior: 'all'
  }
}).render().setUser('The_Buzz_band').start();
</script> <m4>Giggy gigs</m4> </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:30:05.863

您的 div**在**div 容器内。您可以在此处使用 jsfiddle 验证这一点：http: [//jsfiddle.net/LQH8E/](http://jsfiddle.net/LQH8E/)

我使用了您粘贴的完全相同的代码。

为了便于查看，我制作了 div 的背景，`blue`以便您可以看到它包含的内容。

也许你想用这个 div 做点什么，也许是给它设置样式、居中或其他什么，但没有意识到你实际上拥有 div 中的所有内容？

我为您做了一个小风格的示例：http: [//jsfiddle.net/LQH8E/1/](http://jsfiddle.net/LQH8E/1/)使用您提供的相同 HTML。

# c# - 如何知道谁拥有 ReaderWriterLockSlim？

> ID：10727243
> 
> 赞同：4
> 
> 时间：2012-05-23T20:21:28.970
> 
> 标签：c#, .net, multithreading, deadlock, readerwriterlockslim

我正在编写一个广泛使用多线程的应用程序。一些线程使用 ReaderWriterLockSlim 共享一个 observablecollection。

我不时遇到死锁，我需要知道在死锁时哪个线程持有锁。我怎么知道这个？我查看了对象属性，没有明显的东西。目前我只知道哪些线程正在等待锁。

谢谢你的帮助！

编辑：当然，我说的是在调试时找到它，并提供所有可用的调试信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:30:00.317

在死锁期间，只需查看线程调试面板中的当前线程，查看调用堆栈，您就会发现哪个线程获得了锁。

如果您需要知道代码中的线程 id，您可以随时将其静态保存，或者从 readerwriterlockslim 继承并添加线程属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T19:50:42.040

这就是我的意思。
只需跟踪锁定和解锁，当您遇到死锁时，系统将停止，最后一个“Enter”将指向锁定线程的方向。

```
public class ReaderWriterLockSlimExtended : ReaderWriterLockSlim
{
    private Thread m_currentOwnerThread = null;
    private object m_syncRoot = new object();

    public Thread CurrentOwnerThread
    {
        get
        {
            lock (m_syncRoot)
            {
                return m_currentOwnerThread;
            }
        }
    }

    public Thread CurrentOwnerThreadUnsafe
    {
        get
        {
            return m_currentOwnerThread;
        }
    }

    public new void EnterWriteLock()
    {
        lock (m_syncRoot)
        {
            base.EnterWriteLock();
            m_currentOwnerThread = Thread.CurrentThread;
        }
        Debug.WriteLine("Enter Write Lock - Current Thread : {0} ({1})", CurrentOwnerThread.Name, CurrentOwnerThread.ManagedThreadId);
    }

    public new void ExitWriteLock()
    {
        Debug.WriteLine("Exit Write Lock - Current Thread : {0} ({1})", CurrentOwnerThread.Name, CurrentOwnerThread.ManagedThreadId);
        lock (m_syncRoot)
        {
            m_currentOwnerThread = null; //Must be null before exit!
            base.ExitWriteLock();
        }
    }  
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T20:43:29.477

您总是可以尝试在锁定之前和之后跟踪线程 ID，这样您就可以记录发生了什么以及谁锁定了它以及何时锁定。您可以写入文件或仅检查调试器输出窗口以查看所有跟踪。我相信您可以使用跟踪断点（Breakpoint -> When Hit...）而不是真正的跟踪代码来在输出窗口中快速获取一些东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T21:12:58.447

`ReaderWriterLockSlim`没有密封，因此您可以将其子类化并以这种方式附加您需要的任何信息。问题是有用的方法不是虚拟的，所以你不能覆盖它们。但是，除了捕获调用该方法的线程之外，您还可以添加自己的方法，例如调用`EnterReadLockDebug`和在幕后。这不是一个很好的解决方案，因为您必须更改所有呼叫站点。但是，如果使用调试器太麻烦，那么这可能是一个合理的选择。`ExitReadLockDebug``EnterReadLock``ExitReadLock`

使用条件编译的主题有很多变化。您可以检测 Debug vs. Release 构建，并根据激活的构建配置注入必要的调试逻辑。Debug 激活时注入调试信息，Release 激活时省略。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T12:54:23.370

这是我结束的代码，以供将来参考：

```
using System;
using System.Threading;

namespace Utils
{
public class ReaderWriterLockSlim2
{
    #region Attributes

    private readonly TimeSpan _maxWait;
    private readonly ReaderWriterLockSlim _lock;

    #endregion

    #region Properties

    public int CurrentWriteOwnerId { get; private set; }
    public string CurrentWriteOwnerName { get; private set; }

    #endregion

    #region Public Methods

    public ReaderWriterLockSlim2(LockRecursionPolicy policy, TimeSpan maxWait)
    {
        _maxWait = maxWait;
        _lock = new ReaderWriterLockSlim(policy);
    }

    public void EnterWriteLock()
    {
        if (!_lock.TryEnterWriteLock(_maxWait))
        {
            throw new TimeoutException(string.Format("Timeout while waiting to enter a WriteLock. Lock adquired by Id {0} - Name {1}", this.CurrentWriteOwnerId, this.CurrentWriteOwnerName));
        }
        else
        {
            this.CurrentWriteOwnerId = Thread.CurrentThread.ManagedThreadId;
            this.CurrentWriteOwnerName = Thread.CurrentThread.Name; 
        }
    }

    public void ExitWriteLock()
    {
        _lock.ExitWriteLock();
        this.CurrentWriteOwnerId = 0;
        this.CurrentWriteOwnerName = null;  
    }

    public void EnterReadLock()
    {
        _lock.EnterReadLock();
    }

    public void ExitReadLock()
    {
        _lock.ExitReadLock();
    }

    #endregion
}
} 
```

# css - 如何使 CSS 三角形（带边框）跨浏览器兼容

> ID：10727244
> 
> 赞同：2
> 
> 时间：2012-05-23T20:21:32.710
> 
> 标签：css, cross-browser, flowchart

我能够创建一个简洁的流程图，如下所示：http: [//jsfiddle.net/R8Gx3/3/](http://jsfiddle.net/R8Gx3/3/)

但是，主要浏览器（Chrome、Firefox、IE）的呈现并不一致。

关于如何以更可靠的方式实现相同效果的任何想法？

显然我可以使用图像，但我更喜欢 CSS，因为在 CSS 中编辑颜色更容易（而不是创建新图像）。

我不能只使用三角形字符，因为元素后面有纹理背景，所以我需要透明度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:30:36.173

我认为放置 UTF-8 三角形会更好，一端两个，另一端一个，而不是依赖于边界黑客。

[http://www.fileformat.info/info/unicode/char/25bc/browsertest.htm](http://www.fileformat.info/info/unicode/char/25bc/browsertest.htm)

[http://en.wikipedia.org/wiki/Geometric_Shapes](http://en.wikipedia.org/wiki/Geometric_Shapes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:04:02.720

对于现代浏览器，您可以使用 CSS 转换（*对于 9 及以上版本的 IE*）

所以你制作一个带有上/右边框的盒子并将其旋转 45 度。

这样，您可以简化 html，只需使用和应用箭头`:after`（`:before`每个*都是提示之一*）

演示在[http://jsfiddle.net/gaby/FJEFP/1/](http://jsfiddle.net/gaby/FJEFP/1/)

# javascript - 如何确保 Facebook 应用程序始终在 apps.facebook.com 上运行

> ID：10727247
> 
> 赞同：2
> 
> 时间：2012-05-23T20:21:53.570
> 
> 标签：javascript, facebook

我有一个带有 Web 模板的基本画布 Facebook 应用程序。我试图确保该应用程序始终在 Facebook 下运行，但最终失败了。

我第一次登录应用程序时收到签名请求，但之后由于我在 Web 模板上运行，我无法从 Facebook 获得任何反馈。

我尝试了一些javascript代码，例如

```
if (window == top) { goHome(); } 
```

检查该网站是否在 Facebook 框架下，但我无法获得顶级 Facebook 框架位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:23:37.820

试试这个

```
if (parent.location.href == self.location.href) {

            window.location.href = "https://url to app";
        } 
```

# wpf - WPF ComboBox 下拉菜单不显示

> ID：10727248
> 
> 赞同：0
> 
> 时间：2012-05-23T20:21:53.863
> 
> 标签：wpf, wpf-controls

我在让 WPF 组合框显示下拉部分时遇到问题。组合框呈现，但是当我单击向下箭头时，组合框中的值不显示。我可以使用箭头在不同的值之间导航。

我的 XAML 看起来像这样：

```
 <ComboBox Text="Is not open" Margin="14,14,0,0" Height="20" Width="150" IsEditable="True" IsEnabled="True">
        <ComboBoxItem  Name="cbi1">Item1</ComboBoxItem>
        <ComboBoxItem  Name="cbi2">Item2</ComboBoxItem>
        <ComboBoxItem  Name="cbi3">Item3</ComboBoxItem>
    </ComboBox> 
```

我错过了一个设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:04:13.100

是的，您可能正在对 ComboBoxes 应用一种样式，该样式正在改变 ComboBox 控件的 ListBox 部分。如果您正在编辑 ComboBox 的 ControlTemplate，Expression Blend 会很有帮助。如果您需要有关 ComboBox ControlTemplate 的帮助，请告诉我们。

# c++ - 如何在 C++ 中接受连接之前获取客户端 IP 地址

> ID：10727249
> 
> 赞同：7
> 
> 时间：2012-05-23T20:21:58.533
> 
> 标签：c++, sockets, ip

我正在学习 c++ 套接字编程...服务器程序绑定到套接字并开始侦听连接请求...好的，现在如何列出侦听请求的 IP 地址？我知道我可以在接受连接后获取 IP 地址，但可以说我不想接受来自特定 IP 地址的连接......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T22:46:47.733

仅在 Windows 上，您可以使用 WinSock2[`WSAAccept()`](https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsaaccept)函数的条件回调功能在接受连接之前访问客户端信息，甚至在接受连接之前拒绝连接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T20:25:35.367

就标准套接字 API 而言，这是无法做到的。在我所知道的所有平台上，系统实际上在应用程序有机会监控未决请求**之前****接受**连接（即用 SYN+ACK TCP 数据报响应） 。

 *** * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T20:30:53.467

为了获得最佳性能，这将通过在网络堆栈中进行过滤来解决，但这样做的细节将取决于操作系统（这不是套接字接口的一部分，您的应用程序通常甚至可能没有配置网络的权限以这种方式堆叠。）

另一个机会是在 之后`accept`，此时连接已经在 TCP 级别上被接受（CONNECT ACK）。

我不认为你可以在你喜欢的中间阶段做到这一点。然而，无论如何，这与之后做这件事并没有太大的不同`accept`。**

# java - 如何使用泛型动态覆盖超类函数

> ID：10727251
> 
> 赞同：3
> 
> 时间：2012-05-23T20:22:19.457
> 
> 标签：java, generics

如果您有一个位于 jar 文件中的基类，如下所示：

```
public class A {

public void awesome(int i){

}

} 
```

...由这些类（也在 jar 中）扩展，如下所示：

```
public class A1 extends A {

@Override
public void awesome(int i){

}

} 
```

和

```
public class A2 extends A {

@Override
public void awesome(int i){

}

} 
```

...是否可以以通用方式覆盖基本功能？

假设有一个通过匿名内部类添加的实现——你能编码这样整个匿名内部实现只出现一次吗？所以而不是：

```
public class Test {

public static void main(String args[]){

    A1 mySpecialA1 = new A1(){
        @Override
        public void awesome(int i){
            //awesome implementation
        }
    };

    A2 mySpecialA2 = new A2(){
        @Override
        public void awesome(int i){
            //awesome implementation
        }
    };
}

} 
```

...你可以拥有（这是它崩溃的地方）：

```
public class SpecialAFactory {

public static <T extends A> getSpecialA(){
    return new T(){
        @Override
        public void awesome(int i){
            //only once
        }
    };
}

} 
```

因此，最终您将传入要获取其新匿名实例的子类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:27:20.700

虽然你不能用泛型来做到这一点，但有一个简单、易于理解的解决方案可以让你避免在这种情况下重复代码：

```
public class Test {

public static void main(String args[]){

    A1 mySpecialA1 = new A1(){
        @Override
        public void awesome(int i){
            awesomeImplementation(i);
        }
    };

    A2 mySpecialA2 = new A2(){
        @Override
        public void awesome(int i){
            awesomeImplementation(i);
        }
    };
}

private static void awesomeImplementation(int i) {
    //awesome implementation
}

} 
```

# javascript - Javascript展开/折叠

> ID：10727252
> 
> 赞同：1
> 
> 时间：2012-05-23T20:22:22.137
> 
> 标签：javascript, jquery, html, expand, collapse

我对 Javascript 很陌生。我一直试图弄清楚这一点，但似乎无法解决。所以我的问题是...

**我需要在代码中做什么，以便当您打开“一”并单击“二”时，“一”下面的内容会折叠？**

HTML：

```
<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<title>Help!</title>

</head>
<body>

<div>
<a href="#" id="1" class="title" name="1">one</a>
</div> 
<div id="workdiv1" class="workdiv" style="display:none">content 1
</div> 
</div> 

<div class="storybottom">
<a href="#" id="2" class="title" name="2">two</a>
</div> 
<div id="workdiv2" class="workdiv" style="display:none">content 2
</div> 
</div> 

<div class="storybottom">
<a href="#" id="3" class="title" name="3">three</a>
</div> 
<div id="workdiv3" class="workdiv" style="display:none">content 3
</div> 
</div> 

<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script>
    $(document).ready(function() { 
        $('#work').hide(); 

        $('a.title').click(function() { 
            var id = $(this).attr('id'); 
            $('#workdiv' + id).toggle(150); 
            return false; 
        }); 
    }); 
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:27:50.197

```
 $('a.title').click(function(){
      var target = $(this).closest('div').next('div');
      var mode = target.is(':visible');
      target.siblings('div.workdiv').hide();
      if(!mode) target.show(); else target.hide();
 }); 
```

像这样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:33:18.790

[http://jsfiddle.net/jbabey/kSQfy/1/](http://jsfiddle.net/jbabey/kSQfy/1/)

```
$(document).ready(function() {
    $('a.title').click(function() {
        var correspondingDiv = $(this).parent().next('div');

        if (!correspondingDiv.is(':hidden')) {
            return;
        }

        // hide other divs
        $('.workdiv').hide(150);

        // show this one
        correspondingDiv.toggle(150);
    }); 
}); ​ 
```

# android - Android：orderBy仅使用第一个数字

> ID：10727255
> 
> 赞同：0
> 
> 时间：2012-05-23T20:22:25.307
> 
> 标签：android, sorting, sql-order-by

我正在创建一个 SQLite 数据库，可以在其中为一个月中的特定日期创建条目。我为天数做了一个专栏。这些条目是随机顺序的，所以我想对它们进行排序。但是当我使用 orderBy 时，它只按第一个数字对数字进行排序。示例：挂单是 (2,31,5,21,16,9,7)。然后，当我对其进行排序时，我得到了顺序（16、2、21、31、5、7、9）。有没有办法解决这个问题？

我的进入码

```
 public void createEntry(int id, int month, int day, int start_hour, int start_min, int stop_hour, int stop_min) 
        {
        ContentValues cv = new ContentValues();
        ourDatabase.beginTransaction();
        cv.put(ROW_ID, id);
        cv.put(MONTH,month);
        cv.put(DAY,day);
        cv.put(START_HOUR,start_hour);
        cv.put(START_MIN,start_min);
        cv.put(STOP_HOUR,stop_hour);
        cv.put(STOP_MIN,stop_min);
        ourDatabase.insert(DATABASE_TABLE, null, cv);
        ourDatabase.setTransactionSuccessful();
        ourDatabase.endTransaction();
    } 
```

还有我对数据进行排序的代码

```
 public ArrayList<String> getDays(){
        String[] columns = new String[]{MONTH, DAY, START_HOUR, START_MIN, STOP_HOUR, STOP_MIN};
        Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, DAY);
        c.moveToLast();
        ArrayList<String> navne = new ArrayList<String>();
        for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
            Log.d("Entry", c.getString(1));
            navne.add(c.getString(1)+": "+c.getString(2)+":"+c.getString(3)+" - "+c.getString(4)+":"+c.getString(5));
        }
        return navne;

            public void onCreate(SQLiteDatabase db) {
            // TODO Auto-generated method stub
            db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" + 
                    ROW_ID + " TEXT NOT NULL, " +
                    MONTH + " TEXT NOT NULL, " +
                    DAY + " TEXT NOT NULL, " +
                    START_HOUR + " TEXT NOT NULL, " +
                    START_MIN+ " TEXT NOT NULL, " +
                    STOP_HOUR + " TEXT NOT NULL, " +
                    STOP_MIN + " TEXT NOT NULL);"
                    );

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:26:38.090

您没有显示表格的定义。DAY 列是数字还是字符串？如果它是一个字符串，您会看到这种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:28:40.767

它按字母顺序排列。尝试：

```
ORDER BY ABS(column_name) ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T13:05:57.383

如果您将字段声明为 TEXT，则 ORDER BY 子句的工作方式与字段是字符串一样。如果你想要一个数字顺序，你需要像 INTEGER 或 LONG 一样声明它。

# php - 如何清理和验证联系表格以在屏幕上打印和通过电子邮件发送

> ID：10727257
> 
> 赞同：0
> 
> 时间：2012-05-23T20:22:27.217
> 
> 标签：php, html, forms, security, validation

我想知道这些预防措施是否足够。

我有一个像这样的 html 表单`index.php`：

```
<form action="<?php echo $_SERVER['PHP_SELF'];?>" method="post">
    <select name="Alimento">
        <option value="someValue">An option</option>
    </select>
    Nombre*:<?php echo $error['name'];?><br /><input type="text" name="fname" value="<?php echo $name; ?>"/><br />
    Mail*:<?php echo $error['mail'];?><br /><input type="text" name="mail" value="<?php echo $mail; ?>"/><br />
    <input id="botonComprar" type="image" src="img/comprar.png" name="submit" width="126" height="42">
</form> 
```

现在在文件的顶部我有：

```
if($_SERVER['REQUEST_METHOD'] == "POST") {
    $alimento = filter_input(INPUT_POST, 'Alimento', FILTER_SANITIZE_SPECIAL_CHARS);
    $name = filter_input(INPUT_POST, 'fname', FILTER_SANITIZE_SPECIAL_CHARS);
    $mail    = filter_input(INPUT_POST, 'mail', FILTER_VALIDATE_EMAIL);

    if($name == '') {
        $error['name'] = '<span class="errorMsg"> Ingrese su nombre</span>';

    }
    if($mail == '') {
        $error['mail'] = '<span class="errorMsg"> Ingrese su mail</span>';
    }
    if($phone == '') {
        $error['phone'] = '<span class="errorMsg"> Ingrese su tel&eacute;fono</span>';
    }
... 
```

我后来这样做：

```
if(empty($error)){
    mail($mail, $subject, $alimento, $headers);
} 
```

这当然是简化的，但它显示了它的要点。

所以我的问题是：

*   我的代码中是否有任何重大漏洞被忽略？
*   变量是否可以安全地作为表单中的值回显？
    *   我这样做是为了避免丢失填写的输入，这种方法正确吗？
*   电子邮件是否正确验证？有什么办法可以利用邮件功能？
*   我应该使用`htmlspecialchars`and`$alimento`吗`$name`？
    *   是否有任何理由使用其他电子邮件验证技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-10-01T19:42:05.067

> 我的代码中是否有任何重大漏洞被忽略？

这里有很多 XSS 漏洞。值得注意的是，`<form action="<?php echo $_SERVER['PHP_SELF'];?>"`反射型 XSS 攻击向量（可能与社会工程结合使用）。

此外， `mail($mail, $subject, $alimento, $headers);`如果`$headers`是基于用户输入提供的，您可能会发现自己容易受到[远程代码执行](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)的影响。

> 我应该使用`htmlspecialchars`and`$alimento`吗`$name`？

是`ENT_QUOTES | ENT_HTML5`的，用输出而不是输入代替默认值。

# linux - 错误 TR 命令宽度 :punct: param

> ID：10727258
> 
> 赞同：0
> 
> 时间：2012-05-23T20:22:31.343
> 
> 标签：linux, bash, unix, tr

我有以下命令：

```
cat original.txt | tr [:upper:] [:lower:] | tr -d [:digit:] | 
tr -d [:punct:] > preproces.txt 
```

系统返回以下错误。

> 翻译时，replaceString 中可能出现的唯一字符类是 'upper' 和 'lower'

问题是：

```
tr -d [:punct:] 
```

这个问题的解决方案是什么？

我搜索了 Google 和 StackOverflow 并没有找到这个问题的答案。

微小的编辑（但对剪切和粘贴很重要）：在 [:punct:] 之前将 '--d' 更改为 '-d'，'--d' 被渲染为 '\342\200\223d' 并且渲染的差异几乎肉眼看不见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:56:40.440

当您尝试以下操作时，您只会收到您所说的消息：

```
tr '[:alpha:]' '[:digit:]' 
```

我能够使用

```
tr -d '[:punct:]' 
```

删除标点符号没有问题。例如：

```
$ echo "tr '[:alpha:]' [:digit:] <chkit.sh" | tr -d '[:punct:]'
tr alpha digit chkitsh
$ 
```

这是针对 x86/64 的 RHEL 5（`tr`版本 'tr (GNU coreutils) 5.97'）。

您可能会注意到我将参数 括`tr`在引号中（单或双都可以，尽管单通常更安全）。如果您的目录中有任何单字母文件名，您可能会遇到 shell 将方括号解释为字符类并将这些名称传递给`tr`. 假设你有一个文件`p`：

```
tr [:upper:] [:lower:] 
```

该命令是现在`tr p [:lower:]`。您得到的错误略有不同，但可能与您的问题有关。小心使用 shell 元字符；报价是你的朋友。

请注意，双方括号不是解决方案的一部分：

```
$ echo "tr -d '[[:alpha:]]' <chkit.sh" | tr -d '[[:alpha:]]'        
 - '::' <.
$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:27:51.950

尝试以下命令：

```
tr '[:upper:]' '[:lower:]' < original.txt  |
    tr -d '[:digit:]' |
    tr –d '[:punct:]' > preproces.txt 
```

这避免了臭名昭著的*无用 cat*：

[http://iki.fi/era/unix/award.html](http://iki.fi/era/unix/award.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-21T10:38:53.777

如果您`tr`不支持`[:digit:]`和`[:punct:]`字符类，则必须明确指定它们。

```
tr '[:upper:]' '[:lower:]' < original.txt  |
    tr -d '0-9!"#$%&'"'"'()*+,./:;<=>?@[\\]^_`{|}~-' > preproces.txt 
```

`tr -d`（将两个命令合并为一个的重构也可以`tr -d '[:digit:][:punct:]'`在原始命令中完成。）

[的定义`[:punct:]`是从[http://www.regular-expressions.info/posixbrackets.html](http://www.regular-expressions.info/posixbrackets.html)获得的——我没有尝试任何验证，尽管我稍微重构了它以使其与`tr`此处出现的 shell 上下文兼容。]

# c# - 如果用户刚刚更改密码，则显示网页

> ID：10727261
> 
> 赞同：-2
> 
> 时间：2012-05-23T20:22:39.080
> 
> 标签：c#

我正在使用目录服务来获取用户更改密码的最后日期。如果此日期在 5 分钟内，我想在用户登录时显示特定网页。例如，系统会提示用户更改密码。在更改 Windows 密码后他们登录，因为更改是在 5 分钟的时间范围内，用户将看到 google.com。如果用户明天注销并重新登录，则不会发生任何事情。以下是我有但没有奏效的一些想法。

```
if(datepasswordchanged < datepasswordchanged.AddMinutes(5)) 
```

然而，这每次都会发生。

我也有

```
if(DateTime.Now.AddMinutes(-5) == datepasswordchanged) 
```

但是，这只会发生在恰好 5 分钟前。我怎么能指定一个范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:27:36.130

```
if(DateTime.Now < datepasswordchanged.AddMinutes(5)) 
```

将是“如果当前时间在变量时间之后不到五分钟。”

# oracle - oracle分配表权限

> ID：10727263
> 
> 赞同：0
> 
> 时间：2012-05-23T20:22:57.000
> 
> 标签：oracle

在 Oracle 中，表“MyTable”归“User1”所有，如何将表访问权限授予另一个用户，比如“User2”？

在 SQL Server 中，我们有一些应用程序访问权限，Oracle 有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:26:49.687

You can grant `SELECT` privileges (or `INSERT`, `UPDATE`, `DELETE`, and a few others like `REFERENCES`) to a user

```
GRANT SELECT 
   ON user1.MyTable
   TO user2 
```

It would be more common, though, to create a role, grant the privileges to the role, and then grant the role to whatever users need it, i.e.

```
CREATE ROLE user1_select;

GRANT SELECT 
   ON user1.MyTable
   TO user1_select;

GRANT user1_select
   TO user2; 
```

That makes it easier in the future to grant a single role to more users and to ensure that all the users with a specific job function have the same set of roles rather than trying to make sure that you've granted everyone access to exactly the same set of objects.

# twitter - 找到哪些用户收藏了特定推文的最有效方法是什么？

> ID：10727265
> 
> 赞同：5
> 
> 时间：2012-05-23T20:22:58.393
> 
> 标签：twitter

使用 Twitter API，找到哪些用户最喜欢特定推文的最有效方法是什么？并且还可以回顾性地做到这一点，或者必须在最喜欢之前挖掘流？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T20:33:45.980

来自[twitter api 文档](https://dev.twitter.com/docs/faq)：

> 目前，收藏计数不能作为 REST、流或搜索 API 中的推文对象的一部分使用。当经过身份验证的用户收藏推文或收藏他们的推文时，用户流和站点流都流式传输事件。使用这些经过身份验证的流 API，您可以实时统计收藏夹。这是目前唯一可扩展的统计喜爱活动的方法。

这意味着您应该使用支持在这些事件发生时实时流式传输这些事件的[用户流](https://dev.twitter.com/docs/streaming-apis/streams/user)或[站点流。](https://dev.twitter.com/docs/streaming-apis/streams/site)这些事件指示被收藏的推文和收藏它的用户。

# android - 针对多个平台的 AVD

> ID：10727267
> 
> 赞同：0
> 
> 时间：2012-05-23T20:23:09.723
> 
> 标签：android, eclipse, calendar, android-4.0-ice-cream-sandwich, avd

我找到了很多关于从我的 min-SDK 版本到我的 target-SDK 定位各种 Android 版本的在线资源。这包括执行反射或包装类之类的操作，以测试可能仅在我所针对的更高 Android 版本中可用的高级功能。

我不知道如何让它在 Eclipse 中工作。具体来说，我遇到的问题是，如果我选择与我的目标 SDK 匹配的项目构建目标，那么 Eclipse 将不允许我选择具有较低 Android 版本的 AVD 进行调试/测试。因此，我无法测试反射技巧以确保它们适用于向后兼容。选择最低项目构建目标的替代方法意味着我无法引用任何仅在最新 Android 版本中可用的高级类/方法而不会出现编译器错误。

组织 Eclipse Android 项目以使多个版本工作的正确方法是什么？

（PS 我正在尝试使用旧的、未记录的日历访问技巧以及新的 ICS 日历 API。）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:33:41.660

project.properties 包括您的构建目标。将此设置为 android-15（最新 API）。在清单中将 min-sdk 设置为您支持的最小 sdk，例如 8 (froyo)。这是最低 API，它只会在 API 大于或等于此的设备上启动。

确保测试所有低于目标的 API，因为某些方法可能不起作用。一个例子是 Honeycomb 中引入的 ActionBar - 它不适用于低于 Honeycomb 的 API。

# javascript - 如何检测 Javascript 中的数字键盘输入

> ID：10727268
> 
> 赞同：6
> 
> 时间：2012-05-23T20:23:10.113
> 
> 标签：javascript

我想让 Javascript 仅从数字键盘的 Enter 键而不是通常的 Enter 键响应 keypress 或 keydown 事件。[根据jQuery keypress docs 中](http://api.jquery.com/keypress/)的演示，它们似乎都生成了相同的事件数据，所以我不确定这是否可能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T20:24:53.290

They do generate the same keystroke data, at the level of abstraction that JavaScript has access to. Remember, JavaScript lives in a sandbox (the browser) and has no direct access to the underlying hardware (there are plenty of platforms that don't have a numeric keypad at all, but do have a browser).

This cannot be done.

EDIT:

Support for this has been added for some browsers but does not seem to be universal (see the other answer).

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-04-20T10:36:37.283

现在可以将小键盘 Enter 检测为单独的键。使用 KeyboardEvent.location 属性。这样，您可以首先检查键码 13，然后检查键是否在数字键盘上，这决定了数字键盘的输入。

[https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/location](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/location)

例子：

```
 window.onkeydown=function(ev)
    {
         var e= ev || window.event,
         key = e.keyCode
         if ((key===13) && (e.location===3)) {
            console.log("got ya");
            console.log(e.location);
         }
   } 
```

# css - css @font-face 在 FF 中没有工作

> ID：10727272
> 
> 赞同：0
> 
> 时间：2012-05-23T20:23:24.850
> 
> 标签：css, fonts

我的自定义字体没有在 FF 中应用。这在 Coda（我的开发应用程序）中确实有效。而且在 Safari 中...

CSS：

```
@font-face {
  font-family: MyScriptFont;
  src: url('fonts/giddyup.ttf');
}
/* IE9+ */
@font-face {
  font-family: MyScriptFont;
  src: url('fonts/giddyup.eot');
    }
    #tagCommon {
    font-family: 'MyScriptFont', Arial, Helvetica, sans-serif;
    font-size: 52px;
    position:relative;
    padding-top:22px;
} 
```

的HTML：

```
<div id="tagCommon"></div> 
```

该网站是[http://tntplants.site11.com/](http://tntplants.site11.com/)。当您在右侧的顶部框中键入字母时，它应该是左侧的 giddyup 脚本字体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:56:53.343

所有主要浏览器都决定采用他们选择支持的字体格式：

*   Internet Explorer 仅支持 EOT
*   Mozilla 浏览器支持 OTF 和 TTF
*   Safari 和 Opera 支持 OTF、TTF 和 SVG
*   Chrome 支持 TTF 和 SVG。

因此，要获得完整且适当的支持，您需要在声明 face-face 时遵循一定的结构：

**CSS FONT-FACE 例如**

```
@font-face {
    font-family: 'GiddyupWebRegular';
    src: url('giddyup-webfont.eot');
    src: url('giddyup-webfont.eot?#iefix') format('embedded-opentype'),
         url('giddyup-webfont.woff') format('woff'),
         url('giddyup-webfont.ttf') format('truetype'),
         url('giddyup-webfont.svg#GiddyupWebRegular') format('svg');
    font-weight: normal;
    font-style: normal;

} 
```

请参阅[此处的工作示例！](http://dl.dropbox.com/u/76169930/stackoverflow/question/10727272/giddyup-demo.html)

在此处下载生成的带有字体和 CSS 的 CSS [！](http://dl.dropbox.com/u/76169930/stackoverflow/question/10727272/webfontkit-20120523-164327.zip)

**上面的链接**是使用字体代码生成器生成的，您上传字体并为您弹出代码：

[字体松鼠](http://www.fontsquirrel.com/fontface/generator)

有关更多信息，请阅读MDN 中的[这篇文章](https://developer.mozilla.org/en/CSS/@font-face)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:51:18.340

交换您的 CSS 声明 - 将 TTF 放在 EOT 之后。例如

```
/* IE9+ */
@font-face {
  font-family: MyScriptFont;
  src: url('fonts/giddyup.eot');

@font-face {
  font-family: MyScriptFont;
  src: url('fonts/giddyup.ttf');
}
    }
    #tagCommon {
    font-family: 'MyScriptFont', Arial, Helvetica, sans-serif;
    font-size: 52px;
    position:relative;
    padding-top:22px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:54:58.847

我要做的第一件事是将字体堆栈从 Font Squirrel 切换到一个

```
@font-face {
    font-family: 'Name';
    src: url('Name.eot');
    src: url('Name.eot?#iefix') format('embedded-opentype'),
        url('Namet.woff') format('woff'),
        url('Name.ttf') format('truetype'),
        url('Name.svg#Name') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:56:30.127

`MyScriptFont`不一样`'MyScriptFont'`。

将您的 font-family 声明更改`#tagCommon`为`MyScriptFont`或将其更改`@font-face`为`'MyScriptFont'`.

```
@font-face {
  font-family: 'MyScriptFont';
  src: url('fonts/giddyup.ttf');
}
/* IE9+ */
@font-face {
  font-family: 'MyScriptFont';
  src: url('fonts/giddyup.eot');
}
#tagCommon {
    font-family: 'MyScriptFont', Arial, Helvetica, sans-serif;
    font-size: 52px;
    position:relative;
    padding-top:22px;
} 
```

# java - 用 Arrays.asList 初始化 List<>

> ID：10727280
> 
> 赞同：43
> 
> 时间：2012-05-23T20:24:10.393
> 
> 标签：java, arrays, list, collections, array-initialization

为什么会这样：

```
String[] array = {"a", "b", "c"};
List<String> list = Arrays.asList(array); 
```

但这不会：

```
List<String> list = Arrays.asList({"a","b","c"}); 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-05-23T20:25:17.357

这是仅在构造和分配数组时可用的简写。

```
String[] array = {"a", "b", "c"}; 
```

你可以这样做：

```
List<String> list = Arrays.asList("a","b","c"); 
```

`asList`可以采用“vararg”参数。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-23T20:44:42.247

您的问题是为什么一个有效而另一个无效，对吗？

嗯，原因是它`{"a","b","c"}` *不是一个有效的 Java 表达式*，因此编译器不能接受它。

您似乎暗示的是您想要传递数组初始化程序而不提供[完整的数组创建表达式](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.10)（JLS 15.10）。

正如其他人指出的那样，正确的数组创建表达式是：

```
String[] array = {"a", "b", "c"}; 
```

如[JLS 10.6 Array Initializers](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.6)中所述，或

```
String[] array = new String[]{"a", "b", "c"}; 
```

如[JLS 15.10 Array Creation Expressions](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.10)中所述。

第二个对于内联很有用，因此您可以直接传递它而不是数组变量。

由于`asList`in 中的方法`Arrays`使用可变参数，并且可变参数表达式被映射到数组，因此您可以传递一个内联数组，如下所示：

```
List<String> list = Arrays.asList(new String[]{"a", "b", "c"}); 
```

或者简单地传递将自动映射到数组的变量参数：

```
List<String> list = Arrays.asList("a","b","c"); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-23T20:25:25.737

你可以试试

```
List<String> list = Arrays.asList(new String[] {"a","b","c"}); 
```

# java - Simplify a complex regular expression

> ID：10727283
> 
> 赞同：6
> 
> 时间：2012-05-23T20:24:20.810
> 
> 标签：java, regex

I am looking for a way to simplify a regular expression which consists of values (e.g. 12345), relation signs (<,>,<=,>=) and junctors (&,!). E.g. the expression:

```
>= 12345 & <=99999 & !55555 
```

should be matched. I have this regular expression:

```
(^<=|^<= | ^>= | ^>= |^<|^>|^< |^> |^)((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
```

I am especially unhappy with the repetition of <=, >=, <, > at the beginning and end of the expression. I would be glad to get a hint how to make it simpler e.g. look ahead, look back.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:25:03.823

从您的正则表达式开始，您可以执行以下简化步骤：

```
 (^<=|^<= | ^>= | ^>= |^<|^>|^< |^> |^)((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
```

1.  将锚移出交替

    ```
    ^(<=|<= |>= |>= |<|>|< |> |)((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
    ```

    为什么锚点之前有空格？（删除）

2.  将以下空格移到外部并使其可选

    ```
    ^(<=|<=|>=|>=|<|>|<|>|) ?((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
    ```

3.  删除交替中的重复项

    ```
    ^(<=|>=|<|>|) ?((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
    ```

4.  最后的空替代将匹配空字符串 ==> 此替代是可选的

    ```
    ^((<=|>=|<|>)? ?)?((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
    ```

5.  使等号可选并删除重复项

    ```
    ^((<|>)=? ?)?((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
    ```

6.  可以用字符类替换单个字符的交替

    ```
    ^([<>]=? ?)?((!|)([0-9]{1,5}))( & > | & < |& >=|&>=|&<=||&<=|&>=|&<|&>|&| &| & |$))* 
    ```

7.  最后用交替做类似的事情，你最终会得到这样的结果：

    ```
    ^([<>]=? ?)?((!|)([0-9]{1,5}))( ?(& ?([<>]=?)?)?|$) 
    ```

这是未经测试的，我没有改变语义（我认为是这样），但我只是在编辑器中这样做了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:33:46.710

怎么样

`[<>]=?|\d{1,5}|[&!\|]`

这会照顾你的 > / >= / < / <= 重复。似乎对我有用。

让我知道这是否回答了您的问题或需要工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:33:32.547

您可以将所有空格设为可选（带有问号），这样您就不必明确列出所有可能性。您还可以将等式/不等式符号分组到字符集中 ([ ])。

像这样，我认为

```
(^[<>]=?\s?)((!|)([0-9]{1,5}))(\s?&\s?[<>]=?\s|$)* 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:39:14.767

我有一个两步程序。首先通过连接器断开，然后检查各个部分。

```
final String expr = ">= 12345 & <=99999 & !55555".replaceAll("\\s+", "");
for (String s : expr.split("[|&]"))
  if (!s.matches("([<>]=?|=|!)?\\d+")) { System.out.println("Invalid"); return; }
System.out.println("Valid"); 
```

但是我们仍然在猜测您是在谈论验证还是其他内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T20:50:18.413

您似乎花费了很多精力来匹配可选空间。像`\s?`(0 - 1) 或`\s*`(0 - many) 这样的东西会更好。

此外，被某物分隔的重复项目总是很困难。最好为“事物”制作一个正则表达式以简化重复。

```
limit = '\s*([<>]=?|!)\s*\d{1,5}\s*'
one_or_more = '^' + limit + '(&' + limit + ')*$' 
```

或者，扩展：

```
^\s*([<>]=?|!)\s*\d{1,5}\s*(&\s*([<>]=?|!)\s*\d{1,5}\s*)*$ 
```

另外，`!`如果我理解正确，它是“关系符号”而不是“连接符”。

（对于提倡使用“真正的”解析器的人来说，上面的结构`one_or_more`- 可能是您最终实现 & 分隔列表的方式；如果您可以在语言中使用字符串连接，则不需要解析器） .

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T20:56:45.460

这就是你想要的：

```
^(\s*([<>]=?)?\s*!?\d{1,5}\s*(&|$))* 
```

这些 sum 子表达式的解释应该可以帮助您理解整个事情：

`\s*`: 0 个或多个空格
`([<>]=?)?`: 一个`<`或`>`符号可选地后跟一个`=`, 全部可选
`!?`: 和可选`!`
`\d{1,5}`: 1-5 位
`(&|$)`: 一个`&`或字符串的结尾

# jqplot - 带 jqplot 的组合线和条

> ID：10727285
> 
> 赞同：8
> 
> 时间：2012-05-23T20:24:30.903
> 
> 标签：jqplot

是否可以使用 jqplot 显示“覆盖”条形图的折线图？

我在堆叠的条形图中添加了一个系列，并将渲染器更改为 $.jqplot.LineRender。这显示为一条线，但它被添加到堆积的数量中。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T10:30:16.030

是的，它可以用`jqPlot`.

此处提供了一个示例，展示了如何在单个图上显示条形图和折线图[，请参见顶部的第三个图](http://www.jqplot.com/deploy/dist/examples/rotated-tick-labels.html)。

[在这里，我制作了一个示例，以在单个图上显示折线图和堆积条形图。](http://jsfiddle.net/Boro/ZbHsD/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-27T11:09:38.397

我在 jsFiddle 上添加[了这个例子](http://jsfiddle.net/uWdbJ/)，我希望这对你有用。它还显示了绘制分界线和区域以获得更好表示的可能性。

![在此处输入图像描述](../Images/351600087b70c743f9eb29c71a468f15.png)

此页面上有一篇关于此主题的文章：[http ://www.meccanismocomplesso.org/en/mean-mode-median-barchart/](http://www.meccanismocomplesso.org/en/mean-mode-median-barchart/)

```
. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-25T05:44:16.387

```
 series:[
              {
                    color:'#0070c0',
                    label : 'Barchart',
                    renderer:$.jqplot.BarRenderer,
                    rendererOptions: {
                          barPadding: 0,
                          barMargin: 0
                    },
                    pointLabels: { show: true }
              },
       {
                    yaxis: 'y2axis',
                    color: '#ff0000',
                    label : 'Line chart ',
                    renderer:$.jqplot.LineRenderer,
                    rendererOptions: {
                          barPadding: 0,
                          barMargin: 0
                    }
              }
        ] 
```

它将绘制折线图和条形图

# java - Why does the STAX parser think this is valid XML 1.0 but not 1.1?

> ID：10727288
> 
> 赞同：5
> 
> 时间：2012-05-23T20:24:36.490
> 
> 标签：java, xml, xml-parsing, stax

In the following code example, I use the STaX parser to parse a piece of XML. If I run the xml10 through it, it works as expected. The xml11 string (which is the same, except for the xml version) - it throws a NullPointerException. I'm running this on a Mac using JDK 1.6.

```
import javax.xml.namespace.QName;
import javax.xml.stream.XMLInputFactory;
import javax.xml.stream.XMLStreamConstants;
import javax.xml.stream.XMLStreamReader;
import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.io.StringReader;
import java.util.Stack;

/**
 */
public class StaxSucks {

    static String xml10 ="<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n"+
                        "<anElement/>";

    static String xml11 ="<?xml version=\"1.1\" encoding=\"utf-8\" ?>\n"+
            "<anElement/>";

    static void parse(InputStream is) throws Exception{
        final XMLInputFactory factory = XMLInputFactory.newInstance();
        factory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);
        final XMLStreamReader xmlStreamReader = factory.createXMLStreamReader(is);
        Stack<QName> XMLDEPTH = new Stack<QName>();
        int eventType = xmlStreamReader.next();
        while(eventType != XMLStreamConstants.END_DOCUMENT){
            if(XMLStreamConstants.START_ELEMENT == eventType){
                QName eventName = xmlStreamReader.getName();
                XMLDEPTH.push(eventName);
            }else if(XMLStreamConstants.END_ELEMENT == eventType){
                //ends should always match the starts.
                QName eventName = xmlStreamReader.getName();
                if(XMLDEPTH.peek().equals(eventName)){
                    XMLDEPTH.pop();
                }else{
                    System.out.println("Hit an end with a non-matching beginning:"+eventName);
                }
            } else{
                System.out.println("Hit event type:"+eventType);
            }
            eventType = xmlStreamReader.next();
        }
        System.out.println("Stack is empty:"+XMLDEPTH.empty());

    }

    public static void main(String[] args) throws Exception{
        System.out.println("Starting XML1.0");
        InputStream is = new ByteArrayInputStream(xml10.getBytes("utf8"));
        parse(is);
        System.out.println("Starting XML1.1");
        is = new ByteArrayInputStream(xml11.getBytes("utf8"));
        parse(is);
    }
} 
```

Stack Trace:

```
Exception in thread "main" java.lang.NullPointerException
    at com.sun.org.apache.xerces.internal.impl.XML11NSDocumentScannerImpl.scanStartElement(XML11NSDocumentScannerImpl.java:351)
    at com.sun.org.apache.xerces.internal.impl.XML11NSDocumentScannerImpl$NS11ContentDriver.scanRootElementHook(XML11NSDocumentScannerImpl.java:889)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:3104)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:922)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)
    at com.sun.org.apache.xerces.internal.impl.XML11NSDocumentScannerImpl.next(XML11NSDocumentScannerImpl.java:852)
    at com.sun.org.apache.xerces.internal.impl.XMLStreamReaderImpl.next(XMLStreamReaderImpl.java:554)
    at StaxSucks.parse(StaxSucks.java:46)
    at StaxSucks.main(StaxSucks.java:74) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:41:24.410

嗨，这是 Sun/Oracle JDK 中 stax 实现损坏的案例，IBM JDK 工作正常，或者您甚至可以只使用最新的 Xerces jar 就可以了。

您可以从以下位置下载 xerces jar：http: [//xerces.apache.org/mirrors.cgi#binary](http://xerces.apache.org/mirrors.cgi#binary)

```
dims@dims-laptop-520:~/test$ /usr/lib/jvm/java-6-sun/bin/java -cp . StaxSucks
Starting XML1.0
Stack is empty:true
Starting XML1.1
Exception in thread "main" java.lang.NullPointerException
    at com.sun.org.apache.xerces.internal.impl.XML11NSDocumentScannerImpl.scanStartElement(XML11NSDocumentScannerImpl.java:351)
    at com.sun.org.apache.xerces.internal.impl.XML11NSDocumentScannerImpl$NS11ContentDriver.scanRootElementHook(XML11NSDocumentScannerImpl.java:889)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:3104)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:922)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)
    at com.sun.org.apache.xerces.internal.impl.XML11NSDocumentScannerImpl.next(XML11NSDocumentScannerImpl.java:852)
    at com.sun.org.apache.xerces.internal.impl.XMLStreamReaderImpl.next(XMLStreamReaderImpl.java:554)
    at StaxSucks.parse(StaxSucks.java:26)
    at StaxSucks.main(StaxSucks.java:54)
dims@dims-laptop-520:~/test$ java -cp .:xercesImpl.jar:xml-apis.jar StaxSucks
Starting XML1.0
Stack is empty:true
Starting XML1.1
Stack is empty:true 
```

# c# - LINQ TO XML Solution

> ID：10727289
> 
> 赞同：1
> 
> 时间：2012-05-23T20:24:44.663
> 
> 标签：c#, linq-to-xml

```
<Root xmlns="http://tempuri.org/DataSourceSchemaConfig.xsd">
 <Node>
  <Name>Peter</Name>
 </Node>
 <Node>
  <Name>John</Name>
 </Node>
</Root> 
```

How do I get List of Names?

I've was trying this, but it doesn't work, where is my mistake?

```
 var lists = from node in nodes.Descendants()
                        where node.Name.LocalName.Equals("Node")
                        select node.Elements("Name").First().Value; 
```

L.B SOLUTION WORKS ONLY IF I REMOVE xmlns="http://tempuri.org/DataSourceSchemaConfig.xsd" from my ROOT tag.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T20:30:39.927

```
 XDocument xDoc = XDocument.Load(....);
 var names = xDoc.Descendants("Name").Select(x => x.Value); 
```

- 编辑 -

```
XDocument xDoc = XDocument.Load(....);
XNamespace ns = XNamespace.Get("http://tempuri.org/DataSourceSchemaConfig.xsd");
var names = xDoc.Descendants(ns+"Name").Select(x => x.Value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:38:43.500

尝试这个：

```
var lists = (from node in nodesxml.Root.Descendants("Node")
                     select new
                     {Name = node.Element("Name").Value}).ToList(); 
```

其中 nodesxml 是您的 XDocument

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:58:08.490

另一个解决方案（不是 LINQ，但可以工作，与命名空间无关）：

```
 XmlDocument doc = new XmlDocument();
 doc.LoadXml(xmlstring);
 XmlNodeList nlist = doc.SelectNodes("/*[local-name(.)='Root']/*[local-name(.)='Node']/*[local-name(.)='Name']/text()");
 var list = new List<string>(nlist.Cast<XmlNode>().Select(x => x.Value)); 
```

该 XPath 负责 DefaultNamespace 问题，因为您不能使用 XmlNamespaceManager 来指定默认命名空间。

# c# - Validating a Gridview inside of a UserControl

> ID：10727295
> 
> 赞同：0
> 
> 时间：2012-05-23T20:25:09.980
> 
> 标签：c#, asp.net, validation, gridview

1.  I have an aspx page inside of which I have an user control and inside that I have a grid view. `ASPX -> ASCX -> GridView` (the gridview has controls dropdownlist, textbox , checkbox)
2.  The controls in the gridview are enabled or disabled based on the checkbox on the aspx page. If the checkbox on the aspx is checked then the bunch of columns are enabled.
3.  To save these changes to database there is a button on aspx page which saves the data.

Validation:
When the save button is pressed I need to validate the grid view. The validation is little tricky there is drop down list textbox and checkbox in each of the row.
(dropdown -REQUIRED && textbox - REQUIRED) OR Checkbox is Checked.

I wanted to know what are the best possible options to validate this, I tried javascript but they do not want to do client side validation. If I use custom validation with validation group that should do it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:30:15.597

Use [User Input Validators](http://msdn.microsoft.com/en-us/library/ms972961.aspx), which will cause validation to fire when you click the Save button (assuming you set `CausesValidation` on the button to `true`). You can even use a `ValidationSummary` control to display all of your errors in a concise list format.

Validation is very easy with ASP.NET, just google around for "ASP.NET validation" and you'll get a lot of material.

# ios - 将当前线程 NSRunLoop 设置为以某种模式运行直到我决定停止它的正确方法是什么？

> ID：10727306
> 
> 赞同：10
> 
> 时间：2012-05-23T20:25:54.353
> 
> 标签：ios, uiscrollview, nsrunloop

我想模仿 UIScrollView 行为，当您拖动 scrollView 时，当前线程 RunLoop 模式更改为 UITrackingRunLoopMode，并在您停止拖动时返回 NSDefaultRunLoopMode。

不过，我想用我自己的课程来做这件事，在视图中拖动......现在我正在使用这段代码

```
while (_draggingView && [[NSRunLoop currentRunLoop] runMode:UITrackingRunLoopMode beforeDate:[NSDate distantFuture]]); 
```

当我停止拖动时，_draggingView 变为 nil，因此我停止在该模式下循环。有没有更优雅/更好的方法来做到这一点？

UIScrollView 是如何做到的？输入源？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T18:08:41.583

您可以使用[`CFRunLoopStop`](http://developer.apple.com/library/ios/DOCUMENTATION/CoreFoundation/Reference/CFRunLoopRef/Reference/reference.html#//apple_ref/c/func/CFRunLoopStop)来强制运行循环返回。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [super touchesEnded:touches withEvent:event];
    CFRunLoopStop(CFRunLoopGetMain());
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-29T12:13:16.450

您可以使用*减速*方法。

```
- (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView 
```

在我们拖动滚动视图后，它开始减速，所以，这些方法可能对你有用。

# android - 向 Listview 添加重新排序

> ID：10727307
> 
> 赞同：0
> 
> 时间：2012-05-23T20:25:57.020
> 
> 标签：android

Android sdk 有一个示例记事本应用程序，该应用程序将笔记保存在数据库中。我注意到缺少的一件事是重新排序项目，有没有一种简单的方法可以添加？如何在数据库中设置排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:28:32.223

这个想法是`ListView`不会重新排序基础数据。相反，数据以正确的顺序呈现。因此，如果您在使用 SQLite 中使用`ORDER BY`子句，那么您`SELECT`将是正确的选择。当您添加某些内容时，会刷新基础数据以刷新您的列表。

# android - 使用外部 Android 应用程序作为动态片段

> ID：10727309
> 
> 赞同：0
> 
> 时间：2012-05-23T20:26:06.640
> 
> 标签：android, dynamic, android-fragments

我已经阅读了几篇关于使用片段事务动态更改片段的文章，但它们显示了实例化片段类并在事务中使用它。但是如何加载不属于拥有项目的片段，而是外部应用程序（它们都是 FragmentActivities）。

我拥有的是一个“主”应用程序，它很像电子邮件收件箱，但“收件箱”可能有*n*种不同类型的“消息”。我有一个“main”支持的应用程序包名称列表（我从 packageManager 动态发现它们），所以我知道我点击了什么样的“消息”，然后我触发了一个 Intent（使用包名称）到加载其外部应用程序。我要做的是将该外部应用程序加载到双片段布局中。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:36:37.890

> 但是如何加载不属于拥有项目的片段，而是外部应用程序（它们都是 FragmentActivities）。

这是不可能的，对不起。

# javascript - handling a compute intensive operation

> ID：10727310
> 
> 赞同：5
> 
> 时间：2012-05-23T20:26:14.337
> 
> 标签：javascript

I'm writing a web based application (large cargo aircraft weight and balance) in which the user enters pallet weights. When an individual pallet weight is entered, a number of checks have to be made to determine if that weight can be accepted. The checks are all relatively trivial in terms of compute cycles required; one is not. As I understand it, JavaScript is single-threaded, which I take to mean that if the user starts to enter a weight in another pallet position, he's going to be locked out until the previous weight is fully processed.

I can't afford to have the user waiting every time he enters a weight (which they don't have to do at the moment as the app currently doesn't make that last check properly). Currently I'm thinking of not doing the final compute-intensive step until all weights are entered and the user signifies so by clicking on a button. However, this will deprive the user of immediate feedback as to which weight initially triggered the problem, a problem in which multiple weights may contribute, and which is going to be hard to sort out if they have to wait until the last.

My Google searches on the topic have been somewhat useful, but I'm asking here for possible ideas for an up-to-date solution to the dilemma. Any suggestions are most welcome. The context of the problem can be observed by going to [http://terryliittschwager.com/WB/JWB.php](http://terryliittschwager.com/WB/JWB.php) and selecting an aircraft.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:28:01.733

如果您想做客户端，我建议您研究 WebWorkers。它们在与主 (DOM) JS 线程不同的线程上运行。并非所有浏览器都支持（当然），但目前在 Chrome、FF、Safari 和 IE 10 中受支持。

编辑：[WebWorkers](https://developer.mozilla.org/En/Using_web_workers)的 MDN是一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:30:40.823

您可以将 Ajax 用于长的一个，而 javascript 用于其余的。或者如果可能的话，分解计算，一次做一点。 [http://www.sitepoint.com/multi-threading-javascript/](http://www.sitepoint.com/multi-threading-javascript/)

# visual-studio-2010 - No idea how to conditionally link static libraries in Visual Studio outside of preprocessor macros in a file

> ID：10727311
> 
> 赞同：0
> 
> 时间：2012-05-23T20:26:17.067
> 
> 标签：visual-studio-2010, visual-c++, build, build-process

I'm using Visual Studio 2010 on Windows 7\. My project is written in C++.

There is a header file that has a lot of preprocessor logic to determine what version of a particular static library to link. It also prints a message to the build window. Well, as you can imagine, in the world of C++, everything ends up including everything, and this file gets parsed for just about every object file; the build window is flooded with the noise of the inefficiency of a file that contains boiler plate that better belongs in a make file.

I'd like to move this logic somehwere more logical, and where it only gets parsed once. I was thinking the pre-link custom build step. I've figured out all the conditional logic that is valid in build step syntax, but I don't know the command that would tell the linker "link this static library".

Is there a better way to conditionally link static libraries? What is the command I am missing to make it happen?

Note, I'm not in a position to include 3rd party build tools. No cmake, no incredibuild, none of their ilk. I'm trying to do this better as a solution native to VS, or I'll be stuck keeping it the way it is.

Thanks.

# jquery - Creating and Editing of Object with Multiple Dynamic Collections - DRY Principle

> ID：10727312
> 
> 赞同：0
> 
> 时间：2012-05-23T20:26:24.477
> 
> 标签：jquery, asp.net-mvc-3, user-interface

I have the following class...

```
public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public IList<SizeOption> SizeOptions { get; set; }
    public IList<ColorOption> ColorOptions { get; set; }
    public IList<Product> SimilarProduct  { get; set; }
} 
```

I won't elaborate on the details of each of those additional classes. What is important is that a `Product` contains multiple properties that are child collections.

I'm developing an ASP.NET MVC3 (Razor) web application to help manage these products.

The UI must function in such a way that I have one area for editing the low level product details (Id, Name, Price, etc.) followed by separate areas below for each child collection on Product. (the client wants to manage everything about a product in one screen).

Those areas each have an "Add" button, which creates a new dynamic row with textboxes and various select/checkbox elements so the user can specify options for that object. The user can add/remove these rows of child objects as much as they need to...this is all happening client side with the help of jQuery. Nothing is saved until they submit the form.

**What I'm having trouble with is how best to design the layers involved.**

Currently, I have a partial view for the Edit Form which is used by the `Add Product` and `Edit Product` views. This partial view leverages JavaScript functions to create the dynamic rows. The markup for those dynamic rows is created in these functions in this fashion:

```
var newRow = $('<tr>').append(...) // etc.
table.append(newRow); 
```

The problem with this approach, is that when I load the `Edit Product` view, I'm writing the existing child rows using MVC by iterating over the Model's child collections and outputting HTML markup for the rows. For example...

```
@foreach(var sizeOption in Model.SizeOptions)
{
     <tr>... etc.</tr>
} 
```

This means that I'm duplicating the UI for the rows...I don't like this. I've tried serializing the Model to Json, and calling the client functions based on the data in the Json object, to keep the UI code in one place, but this produces visible latency, which I also do not like.

Lastly, to keep MVC Happy, when the form is finally posted, I iterate the HTML tables and update the Name attributes of the form elements to be in the form of `Product.SizeOptions[0].PropertyName` so that the MVC View Engine will give a fully hydrated View Model as an argument for my Action methods.

Ultimately I'm looking for advice on how to handle this type of dynamic adding/editing in a scalable and maintainable fashion.

Thanks in advance for the help!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:30:20.177

您可能会发现[以下博客文章](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)很有趣。在其中 Steven Sanderson 说明了一种很好的技术，它允许在 ASP.NET MVC 中动态编辑可变长度列表。它使用自定义帮助器，允许生成输入字段的正确名称，以便默认模型绑定器能够在提交表单时成功检索值。就添加行而言，他使用 AJAX 调用控制器操作，该操作呈现部分视图，该部分视图只是添加到 DOM 中。

# yii - Yii：为 CRM 使用 cform 对象的子表单/嵌套表单

> ID：10727319
> 
> 赞同：0
> 
> 时间：2012-05-23T20:26:53.690
> 
> 标签：yii

我正在尝试制作一个简单的CRM。我有一个联系人模型，我希望它的表单与多个模型（地址、电话、电子邮件）嵌套，类似于 Google 在其联系人部分中的模型。

我已经阅读了 Yii 的相关教程（特别是[http://www.yiiframework.com/doc/guide/1.1/en/form.builder#creating-a-nested-form](http://www.yiiframework.com/doc/guide/1.1/en/form.builder#creating-a-nested-form)）以及类似的问题（http:// /stackoverflow.com/questions/6720209/multi-model-forms-in-yii）。这些教程对我来说有点模糊。

我试图了解我是否在使用 cform 子表单来实现此应用程序的正确轨道上，或者是否有更好的方法。最后，您能否提供有关此实现的概述逻辑，即一般步骤，这些步骤将为我提供所需的信息，以便通过 Google 完成我的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T00:30:16.863

在一些帮助下想通了。Yii 教程在他们的博客教程中有一个类似（不一样，但相似）的实现，带有一个“嵌套”表单：[http](http://www.yiiframework.com/doc/blog/) ://www.yiiframework.com/doc/blog/ 。本教程向您展示了如何插入表单 (renderPartial) 和不同模型的视图。在这种情况下，评论表单和帖子下方的评论。

# c# - C# MVC 3 验证在特定视图上失败

> ID：10727320
> 
> 赞同：4
> 
> 时间：2012-05-23T20:27:08.437
> 
> 标签：c#, asp.net-mvc-3, entity-framework-4, razor, validation

这是我在这里发布的第一个问题，如果有任何遗漏，请原谅我。我会更新任何要求的信息。

**解释**

我正在开发我的第一个 C#.Net MVC-3 应用程序。我正在使用 Entity Framework 4.0 和 Razor 视图引擎。

对于大多数视图，我使用包含部分类实例的视图模型。该部分类派生自 EF 类，并包含这些类成员的数据注释。这很顺利，现在我所有使用该视图模型的视图都对受影响的文本框进行了验证。例子：

*部分类：*

```
[MetadataType(typeof(DataPackageMetaData))]
public partial class DataPackage
{
    //empty
}

public class DataPackageMetaData
{
    [Required]
    [StringLength(50)]
    public string DataPackageID { get; set; }

    ... (a lot more stuff like this) ...
} 
```

*视图模型：*

```
public class PackageInfo
{
    // Registration Package information
    public DataPackage package { get; set; }
    public Reviewer reviewer { get; set; }
    public PackageTracking trackingSave { get; set; }

    <...>

    //Constructor
    public PackageInfo()
    {
        package = new DataPackage();
        reviewer = new Reviewer();
        trackingSave = new PackageTracking();
    }
} 
```

所以，所有这些东西的验证都是“有效的”。在视图（实际上是局部视图的一部分）中，我只放了一个“TextBoxFor”。然后如果验证失败，则会以红色发布一条漂亮的错误消息：

*看法：*

```
@Html.TextBoxFor(model => Model.package.DataPackageID, new { @class = "short", @id = "DataPackageID" })
@Html.ValidationMessageFor(model => Model.package.DataPackageID, "The Data Package ID is required and cannot be longer than 50 characters") 
```

**问题**

我现在遇到的问题是我已经转移到程序的报告方面，我想要一个可以传递“DateIn”和“DateOut”表单值（除其他外）的新 ViewModel，以便自定义报告查询可以是生成。我希望能够验证 DateIn 和 DateOut 值确实是日期值。出于某种原因，这不起作用。

*视图模型：*

```
public class PackageVals
{
    < ... >

    // Date value for formatted "Date In" value
    [DataType(DataType.Date)]
    [DisplayName("Date In")]
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy}", ApplyFormatInEditMode = true)]
    [Required]
    public DateTime DateIn { get; set; }

    // Date value for formatted "Date Out" value
    [DataType(DataType.Date)]
    [DisplayName("Date Out")]
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy}", ApplyFormatInEditMode = true)]
    [Required]
    public DateTime DateOut { get; set; }

    <... more stuff ...>
} 
```

*看法*

```
@Html.TextBoxFor(model => Model.DateIn, new { @class = "small", @id = "DateIn"})
@Html.ValidationMessageFor(model => Model.DateIn, "A valid date must be entered in the format mm/dd/yyyy.")
<...>
@Html.TextBoxFor(model => Model.DateOut, new { @class = "small", @id = "DateOut"})
@Html.ValidationMessageFor(model => Model.DateOut, , "A valid date must be entered in the format mm/dd/yyyy.") 
```

请注意，在所有情况下，我都使用部分视图，然后嵌入到其他视图中。应用程序的报告生成部分有几个不同的视图，几乎所有视图都需要“DateIn”和“DateOut”表单值。

我已经没有什么可以看的了，也没有时间看它们了。现在，我只是在 Controller 中错误地捕获错误的日期值并传回一个空 ViewModel 以防止用户看到黄屏死机.

我知道验证是基于 jQuery 的，但我认为我在那里没有做任何可能导致问题的事情。这是我的整个 jQuery 脚本：

*jQuery 脚本*

```
$(document).ready(function () {
    // Purple box autocomplete Stuff
    $("#Product").autocomplete({ source: '/SharedFunctions/AutoFillProduct' });
    $("#ActiveIngredient").autocomplete({ source: '/SharedFunctions/AutoFillActiveIngredient' });
    $("#Applicant").autocomplete({ source: '/SharedFunctions/AutoFillApplicant' });

    // Purple box autocomplete Stuff
    $("#DataType").autocomplete({ source: '/SharedFunctions/AutoFillDataType' });

    // Purple Box datepicker stuff
    $("#DateReceived").datepicker({ dateFormat: "mm/dd/yy" });
    $("#OutDate").datepicker({ dateFormat: "mm/dd/yy" });

    // Silver box datepicker stuff; Also used by Reports
    $("#DateIn").datepicker({ dateFormat: "mm/dd/yy" });
    $("#DateOut").datepicker({ dateFormat: "mm/dd/yy" });

    // Alternate table row colors
    $("table.center > tbody tr:even").css("background-color", "#F2F8FF");
}); 
```

你能给我的任何帮助来解决这个问题都会很棒。让我知道您是否还有其他需要。

再次感谢。

**附加信息**

我想澄清一下，以防有任何混淆：我有两个 ViewModel：第一个 ViewModel（称为 PackageInfo）包含从实体框架模型创建的对象的实例。PackageInfo 中的值正在通过内置的“简单”MVC 验证在视图中正确验证。

第二个 ViewModel（称为 PackageVals）包含 DateTime 值。PackageVals 中的值未在视图中进行验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:19:48.643

使您的 DateTime 值可以为空。如果您需要它们，请确保它们具有必需的属性。

如果您的对象不能为空，那么您需要一个与数据模型分开的视图模型。ViewModel 允许您根据视图的需要对其进行自定义，而不管数据模型的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:28:44.050

问题最终出现在控制器中，这是我上面没有发布的唯一代码。我想如果我最初发布了它，那么@Mystere Man 或任何其他好心试图帮助我的人都会立即拿起它。

发生的事情是我将 Controller 函数的参数设为 FormCollection 变量而不是模型变量，因此数据被传入而没有根据模型的验证进行检查。

这是有效的代码：

```
 [HttpPost]
    public ActionResult RptPkgsRecd(PackageVals model)
    {
        ViewBag.CurrentPage = "reports";
        try
        {
            if (ModelState.IsValid)
            {
                PackageVals pv = new PackageVals();
                pv.dps = regpacksRepository.GetSubmitted(model.datePass.DateIn, model.datePass.DateOut).ToList();
                return View(pv);
            }
            else
            {
                PackageVals pv = null;
                return View(pv);
            }
        }
        catch(SystemException ex)
        {
            var error = ex.ToString();
            this.ModelState.AddModelError(error, ex);
            PackageVals pv = null;
            return View(pv);
        }
    } 
```

# jquery - 带有嵌套对象的 AJAX 请求到 Spring MVC 控制器

> ID：10727324
> 
> 赞同：0
> 
> 时间：2012-05-23T20:27:18.917
> 
> 标签：jquery, ajax, json, hibernate, spring-mvc

我有 Spring MVC Web 应用程序。我想使用休眠和 AJAX。有两个实体：Item 和 CatalogItem。实体 CatalogItem 包含一些字段和对 Item 的引用。

是否可以使用 AJAX 创建 CatalogItem？使用普通对象我没有问题，但是使用嵌套.. 我想要这样的东西： 来自 jQuery 的 POST-request：

```
$.ajax({
    'type': 'POST',
    'url': myurl,
    'contentType': 'application/json',
    'data': JSON.stringify({'count':10,'deliveryTime':'2012-12-12T12:12:12',
    'itemId':{'name':'name','price':100,'description':'qwerty'}}),
    'dataType': 'json',
    'success': function(){
        //
    }
}); 
```

在弹簧控制器中：

```
@RequestMapping(value = "/add", method = RequestMethod.POST)
public void addItem(@RequestBody CatalogItem catalogItem) {
    catalogDAO.addCatalogItem(catalogItem);
} 
```

但这不起作用。它抛出

```
[Request processing failed; nested exception is org.hibernate.PropertyValueException: not-null property references a null or transient value: entities.CatalogItem.itemId] with root cause
org.hibernate.PropertyValueException: not-null property references a null or transient value: entities.CatalogItem.itemId 
```

你能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:36:28.637

您试图在没有先保存项目的情况下保存 CatalogItem。

如果没有看到你的映射，很难说别的。

阅读有关[级联](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/#entity-hibspec-cascade)的 Hibernate 文档。

# javascript - 输入焦点时隐藏标签

> ID：10727326
> 
> 赞同：2
> 
> 时间：2012-05-23T20:27:34.070
> 
> 标签：javascript, jquery, focus, label, show-hide

我有一个带有标签覆盖输入的表单。如下图所示

![截屏](../Images/b7f1474231cbbceb379a9fbf8793e760.png)

下面是一个相同的代码示例。

```
<label for="edit-submitted-name--2">
Name
<span class="form-required" title="This field is required.">*</span>
</label>
<input id="edit-submitted-name--2" class="form-text required" type="text" maxlength="128" size="35" value="" name="submitted[name]"> 
```

每次用户关注输入时，我都想使用 jquery 并隐藏标签。标签仅在输入为空或输入未聚焦时才可见。

```
 $("input").focus(function () {
          //hide the label corresponding to this input
     }); 
```

如何使用 jquery 选择与此输入对应的标签？

**注意：**我无法更改 html 中的任何内容，因为它是由 Drupal 中的模块生成的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T20:30:45.280

占位符属性是这项工作的正确工具：

```
<input id="edit-submitted-name--2" class="form-text required" type="text" maxlength="128" size="35" placeholder="Name *" name="submitted[name]"> 
```

[http://www.w3schools.com/html5/att_input_placeholder.asp](http://www.w3schools.com/html5/att_input_placeholder.asp)

但不要忘记无标签输入字段是不好的做法。占位符应被视为提示。它们不是标签的替代品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:32:18.350

从当前元素中选择上一个元素。

```
$(this).prev("label").hide(); 
```

和

```
$(this).prev("label").show(); 
```

但是，这不是 label 元素的目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:31:25.737

Remy Bach 创建了 Super Labels 可以满足您的需求，我会使用他的代码，但如果您正在寻找稍微不同的东西，那么您可以使用他的代码作为模板。

[https://github.com/remybach/jQuery.superLabels](https://github.com/remybach/jQuery.superLabels)

# ios - 如何从 iOS 的白名单中接受自签名服务器证书？

> ID：10727328
> 
> 赞同：6
> 
> 时间：2012-05-23T20:27:36.753
> 
> 标签：ios, nsurlconnection, ssl-certificate

我正在尝试在 NSURLConnection 中接受自签名证书，就像我之前的许多人一样。问题是我只想接受来自我信任的证书白名单中的证书。我会解决如何接受一个证书。这是到目前为止我在 NSURLConnectionDelegate 中的代码：

```
- (void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {
    if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) {
        NSString *thePath = [[NSBundle mainBundle] pathForResource:@"trusted" ofType:@"der"];
        NSData *certData = [[NSData alloc] initWithContentsOfFile:thePath];
        CFDataRef myCertData = (__bridge_retained CFDataRef)certData;
        SecCertificateRef myCert = SecCertificateCreateWithData(NULL, myCertData);
        SecPolicyRef myPolicy = SecPolicyCreateBasicX509();
        SecCertificateRef certArray[1] = { myCert };
        CFArrayRef myCerts = CFArrayCreate(NULL, (void *)certArray, 1, NULL);
        SecTrustRef myTrust;
        OSStatus status = SecTrustCreateWithCertificates(myCerts, myPolicy, &myTrust);

        SecTrustResultType trustResult;
        if (status == noErr) {
            status = SecTrustEvaluate(myTrust, &trustResult);
        }
        BOOL trusted = NO;

        if (trustResult == kSecTrustResultUnspecified) {
            // I never get here.  Instead, trustResult is always kSecTrustResultRecoverableTrustFailure
            trusted = YES; 
        }

        if (trusted) {
            [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]
                 forAuthenticationChallenge:challenge];
        } else {
            [challenge.sender performDefaultHandlingForAuthenticationChallenge:challenge];
        }
        CFRelease(myTrust);
        CFRelease(myCerts);
        CFRelease(myPolicy);
        CFRelease(myCert);
        CFRelease(myCertData);
    } else {
        [challenge.sender performDefaultHandlingForAuthenticationChallenge:challenge];
    }
} 
```

正如您在评论中看到的那样，我实际上从未得到 kSecTrustResultUnspecified，这是我期望得到的。我验证了我的证书是正确的，并且格式正确（DER）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-23T21:39:55.533

好的，想通了。事实证明，您只需要检查服务器信任，并实际使用证书数据。

```
- (void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {
    BOOL trusted = NO;
    if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) {
        NSString *thePath = [[NSBundle mainBundle] pathForResource:@"trusted" ofType:@"der"];
        NSData *certData = [[NSData alloc] initWithContentsOfFile:thePath];
        CFDataRef certDataRef = (__bridge_retained CFDataRef)certData;
        SecCertificateRef cert = SecCertificateCreateWithData(NULL, certDataRef);
        SecPolicyRef policyRef = SecPolicyCreateBasicX509();
        SecCertificateRef certArray[1] = { cert };
        CFArrayRef certArrayRef = CFArrayCreate(NULL, (void *)certArray, 1, NULL);
        SecTrustRef serverTrust = challenge.protectionSpace.serverTrust;
        SecTrustSetAnchorCertificates(serverTrust, certArrayRef);
        SecTrustResultType trustResult;
        SecTrustEvaluate(serverTrust, &trustResult);
        trusted = (trustResult == kSecTrustResultUnspecified);
        CFRelease(certArrayRef);
        CFRelease(policyRef);
        CFRelease(cert);
        CFRelease(certDataRef);
    }
    if (trusted) {
        [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust] forAuthenticationChallenge:challenge];
    } else {
        [challenge.sender performDefaultHandlingForAuthenticationChallenge:challenge];
    }
} 
```

# ios - 使用 Build Phase 中的文件预处理 Info.plist

> ID：10727329
> 
> 赞同：2
> 
> 时间：2012-05-23T20:27:46.913
> 
> 标签：ios, xcode, xcode4

我正在尝试使用从构建阶段运行的脚本生成的文件对我的 Info.plist 进行预处理。由于文件在编译开始时不存在，我收到警告“C Preprocessor Error: 'file' file not found”。当然，该文件将在需要时存在。有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T06:49:51.350

生成的文件需要在目标启动之前存在。解决方法是创建另一个目标，其唯一目的是生成预处理前缀文件。

假设您的主要目标是“foo”，并使用 Xcode 4.3：

*   添加目标 -> 其他 -> 聚合（这会创建一个空目标）
*   添加“运行脚本”阶段
*   在 foo 的构建阶段，将新目标引用为目标依赖项

来自[Marcus S. Zarra](https://stackoverflow.com/users/10673/marcus-s-zarra)的[这篇博](http://www.cimgf.com/2011/02/20/revisiting-git-tags-and-building/)文。

# d3.js - d3.js 标签云：设置文本大小范围

> ID：10727334
> 
> 赞同：1
> 
> 时间：2012-05-23T20:27:53.667
> 
> 标签：d3.js

[来自 Json/array 的 d3.js Tag Cloud 大小](https://stackoverflow.com/questions/10692276/d3-js-tag-cloud-size-from-a-json-array)的另一个问题？

```
var jWord = ["abc","def","ghi","jkl"];
var jCount = [2, 5, 3, 8];

  d3.layout.cloud().size([650, 140])
      .words(d3.zip(jWord, jCount).map(function(d) {
        return {text: d[0], size: d[1]};
      }))
      .rotate(function() { return 0; })
      //.rotate(function() { return ~~(Math.random() * 2) * 90; })
      .fontSize(function(d) { return d.size; })
      .on("end", draw)
      .start(); 
```

现在我使用 jCount 的原始值作为 textsize。假设 jCount 可能会有所不同，我想设置一个大小范围（最小 10 像素到 50 像素）。

```
var maxCount = d3.max(jCount);
var s = d3.scale.linear().domain([10,50]),range([0, maxCount)]); 
```

然后我变了

```
 .words(d3.zip(jWord, jCount).map(function(d) {
    return {text: d[0], size: s};
  })) 
```

我将“size:s”部分更改为许多其他可能猜到的形式，但它不起作用。我仍然熟悉 d3.js/jquery/svg 语法，所以现在我真的不知道如何设置它。请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:57:27.593

`s`是将域映射到范围的函数。所以将行更改为

```
.words(d3.zip(jWord, jCount).map(function(d) {
  return {text: d[0], size: s(d[1]) };
})) 
```

您还需要在定义中交换`.domain`和（并将逗号更改为点）——设置输入范围和输出范围。`.range``s``.domain``.range`

# postgresql - AFTER INSERT 在单独的事务中触发？

> ID：10727335
> 
> 赞同：15
> 
> 时间：2012-05-23T20:27:57.317
> 
> 标签：postgresql, transactions, triggers

触发器（用 pl/ PGsql`AFTER INSERT`编写的函数）会在与原始插入不同的事务中触发吗？

我担心的是触发器是否遇到某种异常。
可以回滚触发器而不影响原始插入吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-23T20:39:06.197

所有 PostgreSQL 触发器在与触发它们的事务相同的事务中执行。

**编辑**：您还可以使用`LISTEN`+`NOTIFY`将消息从触发器发送到在事务之外执行的代码。在这种情况下，消息将仅在成功提交时传递。侦听器中的错误不会回滚触发事务。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-24T02:37:33.653

触发过程与关联的触发事件在**同一事务中运行。**但是触发过程的效果可以单独回滚。

您必须将[异常处理](http://www.postgresql.org/docs/9.1/static/plpgsql-control-structures.html#PLPGSQL-ERROR-TRAPPING)添加到后触发器。

# asp.net-mvc - JsonResult 的自定义模型元数据提供程序

> ID：10727344
> 
> 赞同：1
> 
> 时间：2012-05-23T20:28:58.133
> 
> 标签：asp.net-mvc, actionresult, modelmetadataprovider

我通过从`DataAnnotationsModelMetadataProvider`. `GetMetadataforProperty`自定义提供程序包含和的覆盖实现`CreateMetadata`。

当我`ActionResult`从我的控制器类方法返回时，我的自定义元数据提供程序的代码将被执行。但是，如果我返回`JsonResult`，则不会命中自定义元数据提供程序代码。

我错过了什么吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T17:07:19.517

这是 MVC 框架的正确行为，您所要求的实际上没有意义。

当您`JsonResult`从控制器返回时，您只是告诉 MVC 将 JSON 格式的内容直接发送到响应。此时，您的控制器操作方法已经完成了所需的一切。

但是，如果您返回一个`ActionResult`类型`ViewResult`，则在将任何内容写入响应之前需要进行进一步的处理。渲染视图时需要提供元数据中的信息，因此框架将调用元数据提供程序为您的视图提供所需的信息。

因此，当您返回时未调用您的元数据提供程序的原因`JsonResult`是因为它不是必需的。

我建议查看[这篇](https://stackoverflow.com/a/8081091/577417)文章，它提供了指向 MVC 管道图的链接，这将帮助您了解正在发生的事情。

# javascript - Phonegap - 在 xcode 中配置调试和发布版本

> ID：10727347
> 
> 赞同：4
> 
> 时间：2012-05-23T20:29:09.477
> 
> 标签：javascript, xcode, cordova

如何根据我是否为调试或发布配置了 xcode 将不同的变量传递到我的 phonegap javascript 中？最具体地说，现在我希望能够切换应用程序是连接到我的本地开发服务器还是连接到真正的云服务器。

一个选项是，如果JavaScript只能检测到发生了哪种构建类型，那么我可以将这两个URL存储在.js代码中并适当地选择。

如果有一些地方可以在 Xcode 中存储不同的 url 会更好一些，比如可能在 a`.plist`或其他东西中——我对 XCode 或 Objective-C（因此 phonegap）不是很好，所以我不知道这是否是什至一个正常的做法。

理想情况下，我只需更改 javascript 和 IDE 配置即可做到这一点。如果我需要更改 Objective-C 中的任何内容，答案必须非常具体地说明要做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T06:24:47.150

在 XCode 中，我们为每个应用程序都有目标。默认情况下，每个应用程序都有一个目标。

使用 xCode 中的内置选项复制目标。所以一个用于本地测试，另一个用于实时模式。您也可以在此处使两个目标都处于发布模式。

xCode 中的每个目标都有单独的 .plist 文件，用于定义一些设置，并且是的，它们具有共同的代码库。现在将本地服务器 url 放在 target_test 的 plist 中，将真实服务器 url 放在 target_live 的 plist 中。

您的代码应在运行时从相应的 plist 中读取。

[看一看](https://stackoverflow.com/questions/5355958/where-is-upgrade-target-for-ipad-in-xcode4)

# jquery - 为每个 $.ajax() 单独设置 jQuery.ajaxSetup()

> ID：10727349
> 
> 赞同：2
> 
> 时间：2012-05-23T20:29:21.990
> 
> 标签：jquery, ajax

如何为不同的 AJAX 请求设置不同的设置 (jQuery.ajaxSetup())？

我想做的是“链接”每个 AJAX 调用做不同的 ajaxSetup()。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T20:32:56.543

重点[`$.ajaxSetup()`](http://api.jquery.com/jQuery.ajaxSetup/)是通过 jQuery 在全球范围内为所有 ajax 调用创建默认设置。如果要覆盖设置，只需在特定的 ajax 调用中指定它们。

例如，在您的代码早期的某个地方，定义您的`$.ajaxSetup()`：

```
$.ajaxSetup({
    type: 'POST'
    , cache: false
    , contentType: 'application/json'
    , dataType: 'json'
    , error: function (a, b, c) {
        //default error handling
        console.log(a, b, c);       
    }
}); 
```

然后，当您想使用 a 覆盖时`GET`，请执行以下操作：

```
$.ajax(myUrl, {
    type: 'GET'
    , data: myData
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T20:39:18.370

也许您只是想使用[$.extend](http://api.jquery.com/jQuery.extend/)将您的输入合并到您设置的一些不同的默认值中。例如：

```
var settings1 = {
    type:"GET",
    url:"something.php"
};

var settings2 = {
    type:"POST",
    url: "somethingelse.php"
}

$.ajax($.extend(true, settings1, {
    data: {key: val}
}));

$.ajax($.extend(true, settings2, {
    data: {key: val}
})); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:35:27.320

您可以创建单独的对象并使用这些对象来创建您传入的选项`$.ajax`。

```
var ajaxSetup1 = {
    type: "POST",
    dataType: "html"
}
$.ajax( $.extend( ajaxSetup1, {"url","mypage.php"} ) ); 
```

这当然可以包装在一个私有方法中以供重用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:33:19.357

您是否阅读过 jquery.com 上有关 .ajax() 的文档？令人惊讶的是它需要多少不同的设置（作为参数）。
您很有可能可以在 .ajax() 中执行您想要的操作，而无需调用 .ajaxSetup()。

# xpath - xpath 节点集是否包含另一个

> ID：10727350
> 
> 赞同：2
> 
> 时间：2012-05-23T20:29:30.623
> 
> 标签：xpath, xslt-1.0

我的 xslt 1.0 模板中有两个变量，每个变量都包含一个节点集（使用 xpath 选择）。我想确定一个变量中的节点集是否包含在另一个变量中的节点集中。例如，假设我有一个包含嵌套部分的章节。我想看看是否`$b`包含在`$a`：

```
<xsl:variable name="a" select="chapter//section" />
<xsl:variable name="b" select="chapter//section" /> 
```

我试图获得节点集的交集，看看是否`$a`是两者共享的第一个公共元素`$a`，`$b`但这不起作用：

```
<xsl:if test="$a/ancestor-or-self::*[count(.|$b) = count($b/ancestor::*)][1] = $a"> 
```

添加一些上下文。我正在使用此 xslt 为 html 页面树创建一个选项卡式界面，我要解决的问题是将 class="current" 放在正确的选项卡上。通过测试每个部分以查看它是否是选项卡部分的子部分，它会获得 class="current"，因此选项卡将被设置为看起来好像它在顶部。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:37:08.243

我认为您可以简单地使用`count($a) = count($a|$b)`. 如果 $b 中有任何节点不在 $a 中，则计数将不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T02:14:54.103

扩展迈克尔凯的好答案：

**当一个节点`$n`属于一个节点集`$ns`**？

如果一个节点属于一个节点集，那么该节点与该节点集的并集不会导致更大的节点集——因此并集中的节点数不能更大（实际上必须是等于）比原始节点集中的节点数。

**要使用 XPath 表达式表达这一点**：

```
 count($n | $ns) = count($ns) 
```

**现在，同样的逻辑告诉我们，`$ns1``$ns2`**当两个节点集的并集不包含比更大的节点集更多的元素时，节点集是节点集的子集**：**

```
count($ns1 | $ns2) = count($ns2) 
```

**如果我们想测试是否`$ns1`是 的*真正*子集`$ns2`**：

```
 count($ns1 | $ns2) = count($ns2)
   and
    count($ns2) > count(ns1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T19:23:55.377

我能够使用不同的方法解决问题。我测试每个祖先元素，`$b`看它是否具有相同的 xml:id 为`$a`：

```
<xsl:if test="boolean($b/ancestor-or-self::[@xml:id=$a/@xml:id])"> 
```

虽然这没有使用交集，但它确实告诉是否`$a`包含`$b`。

# objective-c - 使用 NSPasteboard 剪切和粘贴文件

> ID：10727354
> 
> 赞同：0
> 
> 时间：2012-05-23T20:29:41.137
> 
> 标签：objective-c, cocoa, copy-paste, appkit, nspasteboard

我们应该如何使用 剪切和粘贴文件`NSPasteboard`？目前我通过写入和读取文件 URL 来实现复制和粘贴。cut 的问题是，在我将 URL 写入粘贴板之后，我必须删除该文件。当我尝试粘贴该文件时，它不再存在并且我无法复制它。我应该在粘贴板上写点别的吗？我也想过将文件复制到一个临时隐藏的位置，但这似乎有点低效。还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-01T19:14:27.610

您可以使用`kPasteboardTypeFilePromiseContent`. 在这种情况下，拖动源负责将文件写入目标，因此您可以移动文件而不是复制它。

来自的文档`Pasteboard.h`：

```
/*
 *  Pasteboard File Promising
 *  
 *  Summary:
 *    With the FSSpec type being deprecated and removed for 64 bit it is necessary
 *    to introduce a replacement for kDragFlavorTypePromiseHFS. The replacement comes
 *    in the form of two new Uniform Type Identifiers specifically for use with the
 *    pasteboard and promised files. Like the old HFS promise mechanism, the new UTI
 *    based method still requires a multistage handshake between sender and receiver
 *    but the process is somewhat simplified.
 *    
 *    Order of operations on copy or drag
 *    
 *    1) The sender promises kPasteboardTypeFileURLPromise for a file yet to be created.
 *    2) The sender adds kPasteboardTypeFilePromiseContent containing the UTI describing
 *          the file's content.
 *    
 *    Order of operations on paste or drop
 *    
 *    3) The receiver asks for kPasteboardTypeFilePromiseContent to decide if it wants the file.
 *    4) The receiver sets the paste location with PasteboardSetPasteLocation.
 *    5) The receiver asks for kPasteboardTypeFileURLPromise.
 *    6) The sender's promise callback for kPasteboardTypeFileURLPromise is called.
 *    7) The sender uses PasteboardCopyPasteLocation to retrieve the paste location, creates the file
 *          and keeps its kPasteboardTypeFileURLPromise promise.
 *
 *    Automatic translation support has been added so clients operating in the modern
 *    kPasteboardTypeFileURLPromise and kPasteboardTypeFilePromiseContent world can continue
 *    to communicate properly with clients using the traditional kDragFlavorTypePromiseHFS and
 *    kDragPromisedFlavor model.
 */ 
```

样本：

```
@implementation NSPasteboard (DestinationFolder)

- (NSURL*)pasteLocation
{
    NSURL* fileURL = nil;
    PasteboardRef pboardRef = NULL;
    PasteboardCreate((CFStringRef)[self name], &pboardRef);
    if (pboardRef != NULL) {
        PasteboardSynchronize(pboardRef);
        PasteboardCopyPasteLocation(pboardRef, (CFURLRef*)&fileURL);
        CFRelease(pboardRef);
    }
    return [fileURL autorelease];
}

- (void)setPasteLocation:(NSURL *)url
{
    PasteboardRef pboardRef = NULL;
    PasteboardCreate((CFStringRef)[self name], &pboardRef);
    if (pboardRef != NULL) {
        PasteboardSynchronize(pboardRef);
        PasteboardSetPasteLocation(pboardRef, (CFURLRef)url);
        CFRelease(pboardRef);
    }
}

@end 
```

# ios - 如何在带有圆角的超级视图中翻转非全屏 UIView？

> ID：10727356
> 
> 赞同：3
> 
> 时间：2012-05-23T20:29:44.640
> 
> 标签：ios, core-animation

我正在翻转 UIView，类似于 Weather 应用程序的页面翻转。但是，视图不是全屏的，并且超级视图具有圆角。问题是在翻转动画期间，超级视图的圆角用黑色填充到方角。

这是我设置角落的方式：

```
self.view.layer.cornerRadius = 15.0f;
self.view.clipsToBounds = YES; 
```

这是我翻转视图的方式（保留`frontView`和`backView`保留）：

```
UIView *toView;
UIView *fromView;
UIViewAnimationOptions animationType;

if (toFront) {
    toView = self.frontView;
    fromView = self.backView;
    animationType = UIViewAnimationOptionTransitionFlipFromLeft;
} else {
    toView = self.backView;
    fromView = self.frontView;
    animationType = UIViewAnimationOptionTransitionFlipFromRight;
}

[UIView transitionFromView:self.fromView
                    toView:self.toView
                  duration:1
                   options:animationType
                completion:nil]; 
```

当我这样做时，`self.view`'s 的圆角用黑色填充到它们的矩形角边缘。这可以避免吗？我认为我对 Core Animation 的了解不足以解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:23:59.140

如果您需要在 Core Animation 中执行此操作，您可以通过将动画与替换视图分开来完成。这不是不可能的困难。如何做到这一点的描述和一些示例代码如下：

# 替换视图

例如，可以使用以下方法替换视图：

```
[UIView transitionFromView:self.fromView
                    toView:self.toView
                  duration:0.0
                   options:UIViewAnimationOptionTransitionNone
                completion:nil]; 
```

# 动画翻转

困难的部分显然是动画（如果您以前从未做过，请将两者放在一起）。

## 只显示两个视图的前面

由于您想将这两个视图翻转，就好像它们是一张纸的两侧一样，您不希望它们中的任何一个在它们背对时出现。这是通过在*两个*图层上设置`doubleSided`属性来完成的。（不是双面意味着是单面）。`NO`

 *## 翻转

您希望将前视图的变换从恒等变换（无变换）动画化为围绕 y 轴旋转 180 度的变换（朝后），以便它从左到右翻转。

同时，您希望将后视图的变换*从*-180 度旋转动画化到恒等变换。这将使翻转。这两个动画都可以作为“基本”动画完成：

```
CABasicAnimation *flipAnimation = [CABasicAnimation animationWithKeyPath:@"transform"];
[flipAnimation setFromValue:[NSValue valueWithCATransform3D:CATransform3DIdentity]]; // No rotation
[flipAnimation setToValue:[NSValue valueWithCATransform3D:CATransform3DMakeRotation(M_PI, 0,1,0)]]; // Rotate PI around Y
[flipAnimation setFillMode:kCAFillModeBoth];
[flipAnimation setRemoveOnCompletion:NO];
[flippingView layer] addAnimation:flipAnimation forKey:@"myFlipAnimation"]; 
```

然后，您为另一个视图执行相同类型的动画。（填充模式防止动画完成后跳回原来的状态）

# 把它们放在一起

由于您希望两个动画同时运行，并希望在动画完成时运行视图替换代码，您可以使用动画事务。这也将允许您配置两个动画在一个地方的外观：

```
[CATransaction begin];
[CATransaction setAnimationDuration:2.0]; // 2 seconds
[CATransaction setAnimationTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
[CATransaction setCompletionBlock:^{
    // Your view replacing code here...
}];
// Add the animations to both views here...
[CATransaction commit]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-17T17:46:52.413

这就是我最后写的。似乎工作正常，但是，当然，自己测试一下。

注意事项：

*   您应该在调用此方法之前添加您正在制作动画的视图。

*   该方法不会删除任何视图，因此如有必要，请使用完成块删除它们。

*   该方法也不会修改视图的“图层模型”值，因此它们将与动画后保持相同。

`

```
+ (void)flipRight:(BOOL)flipRight fromView:(UIView *)fromView toView:(UIView *)toView duration:(NSTimeInterval)duration completion:(void (^)(void))completionBlock {

// Save original values
BOOL fromViewDoubleSided = fromView.layer.doubleSided;
BOOL toViewDoubleSided = toView.layer.doubleSided;
BOOL fromViewUserInteractionEnabled = fromView.userInteractionEnabled;
BOOL toViewUserInteractionEnabled = toView.userInteractionEnabled;

// We don't want to see the other side of the layer
fromView.layer.doubleSided = NO;
toView.layer.doubleSided = NO;

// We don't want user to fire off animation while its already going
fromView.userInteractionEnabled = NO;
toView.userInteractionEnabled = NO;

[CATransaction begin];

[CATransaction setCompletionBlock:^{

    // Restore original values
    fromView.layer.doubleSided = fromViewDoubleSided;
    toView.layer.doubleSided = toViewDoubleSided;
    fromView.userInteractionEnabled = fromViewUserInteractionEnabled;
    toView.userInteractionEnabled = toViewUserInteractionEnabled;

    if (completionBlock) completionBlock();
}];

CATransform3D flipOutTransform3D = CATransform3DMakeRotation(M_PI, 0,1,0);
flipOutTransform3D.m34 = 1.0/(300.0*(flipRight ? -1 : 1));
CABasicAnimation *flipOutAnimation = [CABasicAnimation animationWithKeyPath:@"transform"];
flipOutAnimation.fromValue = [NSValue valueWithCATransform3D:CATransform3DIdentity];
flipOutAnimation.toValue = [NSValue valueWithCATransform3D:flipOutTransform3D];
flipOutAnimation.duration = duration;

CATransform3D flipInTransform3D = CATransform3DMakeRotation(M_PI, 0,1,0);
flipInTransform3D.m34 = 1.0/(300.0*(flipRight ? 1 : -1));
CABasicAnimation *flipInAnimation = [CABasicAnimation animationWithKeyPath:@"transform"];
flipInAnimation.fromValue = [NSValue valueWithCATransform3D:flipInTransform3D];
flipInAnimation.toValue = [NSValue valueWithCATransform3D:CATransform3DIdentity];
flipInAnimation.duration = duration;

[fromView.layer addAnimation:flipOutAnimation forKey:@"flipOutAnimation"];
[toView.layer addAnimation:flipInAnimation forKey:@"flipInAnimation"];

[CATransaction commit];
}; 
```*

# ios - 如何在 NSMutableURLRequest POST 中包含文本字段值

> ID：10727357
> 
> 赞同：0
> 
> 时间：2012-05-23T20:29:49.697
> 
> 标签：ios, xcode, nsmutableurlrequest

我正在开发一个图像上传应用程序。我让上传部分正常工作，并希望在 POST 中包含来自 UITextField 的评论。

UITextField 被命名为`commentText`. `myURL`在 viewDidLoad 中定义。

```
- (IBAction)startUpload {

uploadButton.enabled = NO;
NSData *imageData = UIImageJPEGRepresentation(imageView.image, 0.7);

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:[NSURL URLWithString:myURL]];
[request setHTTPMethod:@"POST"];

//Trying to add comment from uitextfield commentText
NSLog(@"Comment Text: %@", [commentText text]);
NSString *comment = [NSString stringWithFormat:@"comment=%@", [commentText text]];

NSString *boundary = [NSString stringWithString:@"---------------------------94729573838364809882205829479"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"test.jpg\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

//for comment
[body appendData:[comment dataUsingEncoding:NSUTF8StringEncoding]];
//[body appendData:[NSData dataWithBytes: [comment UTF8String] length: [comment length]]];

NSLog(@"comment: %@", comment);
[request addValue:[NSString stringWithFormat:@"%i", [body length]] forHTTPHeaderField:@"Content-Length"];

[request setHTTPBody:body];

NSURLResponse *response;
NSError *error;

NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
NSLog(@"responseData: %@", responseData);
} 
```

大部分代码都是从我读过的不同帖子拼凑而成的，老实说，我对边界一无所知（还）。我试过改变关闭边界，但这没有任何区别。使用 PHP，我检查了 $_POST、$_GET 和 $_REQUEST 值，但注释不存在（它至少会显示在 $_REQUEST 中，不是吗？）。我知道还有其他相同的问题（http://stackoverflow.com/questions/9509419/xcode-easiest-way-to-send-data-from-ios-textfield-for-example-to-a-remote- datab），我读过，但我似乎无法弄清楚。

谢谢，

标记

编辑：我要添加的评论是否需要再次被边界分隔，并且需要为其声明内容类型？或类似的规定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:55:18.707

我将各种字段以及音频数据添加到我的 POST 中，方法如下：

```
 NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@", BASE_URL]];
  NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];

  NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
  NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
  [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

  NSMutableData *requestData = [NSMutableData data];

  for (NSString *key in [voicenoteData allKeys]) {
    if (![key isEqualToString:@"audio_data"]) {            
      [requestData appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
      [requestData appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"\r\n\r\n", key] dataUsingEncoding:NSUTF8StringEncoding]];
      [requestData appendData:[[NSString stringWithFormat:@"%@\r\n", [voicenoteData objectForKey:key]] dataUsingEncoding:NSUTF8StringEncoding]];
    }
  }

  [requestData appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
  [requestData appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"audio_file\"; filename=\"recording.m4a\"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
  [requestData appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
  [requestData appendData:[voicenoteData objectForKey:@"audio_data"]];
  [requestData appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];

  request.HTTPBody = requestData; 
```

# ruby-on-rails - Ruby on rails：每个都适用于循环空数组吗？

> ID：10727359
> 
> 赞同：1
> 
> 时间：2012-05-23T20:30:02.947
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我在第 14 行不断收到 nil:NilClass 的错误 undefined method `comments'。这是有问题的代码。

```
<li>
  <span class="content"><%= micropost.content %></span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
  </span>
  <% if current_user?(micropost.user) %>
    <%= link_to "delete", micropost, method:  :delete,
                                     confirm: "You sure?",
                                     title:   micropost.content %>
  <% end %>

  <h2>Comments</h2>

    <% @micropost.comments.each do |comment| %>
      <p>
        <b>Commenter:</b>
        <%= comment.commenter %>
      </p>

      <p>
        <b>Comment:</b>
        <%= comment.body %>
      </p>
    <% end %>

  <h3>Add a comment:</h3>
  <%= form_for([micropost, micropost.comments.build]) do |f| %>
    <div class="field">
      <%= f.label :commenter %><br />
      <%= f.text_field :commenter %>
    </div>
    <div class="field">
      <%= f.label :body %><br />
      <%= f.text_area :body %>
    </div>
    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %>
</li> 
```

就好像你不能通过一组注释调用循环，因为它是空的。我尝试添加 <% if @micropost.comments.any? $> 在第 13 行，这样如果没有注释，它就不会尝试循环，但是我在第 13 行得到完全相同的错误。我的语法错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T20:32:29.230

替换`@micropost`为`micropost`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:20:30.680

是的，每个都迭代一个空数组，它只是不会真正“迭代”，因为它是空的。

# android - 如何使 Asynctask postExecute 将变量发送回主类

> ID：10727362
> 
> 赞同：1
> 
> 时间：2012-05-23T20:30:10.580
> 
> 标签：android, android-asynctask

我有一个名为 Main.java 的类，它运行 UI。我有另一个名为 VerifyCreds.java 的类，它扩展了 AsyncTask。VerifyCreds 的全部目的是在另一个线程上运行对我的服务器的调用，以免锁定我的 UI。我没有在 Main.java 中子类化它，因为我将有许多其他类将调用服务器，并且我希望它们都使用 VerifyCreds 类来完成它。

我需要做的是将数据从 VerifyCreds.java 传回 Main.java。但是下面的代码出错了。

任何帮助表示赞赏！谢谢！

这是我的 Main.java 代码

```
 package com.coolprograms.zeal;
    <<<imports removed for brevity>>

    public class Main extends Activity 
    {

// Global VAR's
String TAG = "ZEAL";
static Boolean authCode;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);

    //Grab elements
    final EditText userName = (EditText)findViewById(R.id.usernameBOX);
    final EditText userPWD = (EditText)findViewById(R.id.passwordBOX);
    final Button loginBTN = (Button)findViewById(R.id.loginBTTN);

    //Button listener
    loginBTN.setOnClickListener(new View.OnClickListener() 
    {

        @Override
        public void onClick(View v) 
        {
            // Get username and password and add to array
            ArrayList<String> creds = new ArrayList<String>();
            creds.add(userName.getText().toString());
            creds.add(userPWD.getText().toString());

            // Call method that will execute AsyncTask to get creds from server
            verify(creds);  
        }
    });
}

private void verify (ArrayList<String> creds)
{
    // Start AsyncTask to get creds
    new VerifyCredentials(this).execute(creds);
}

public interface credsAuth 
{
    public void authorizedCreds(Boolean authCode);

}

public void verifiedCreds(Context ctx, Boolean serverAuth)
{
    if(serverAuth = true)
    {
        // Move to next screen if we are authorized
        Intent i = new Intent(ctx, Items.class);
        startActivity(i);
    }
}
} 
```

这是 VerifyCreds.java 代码

```
package com.coolprograms.zeal;
<<<imports removed for brevity>>
public class VerifyCredentials extends AsyncTask<ArrayList<String>, Void, Boolean> {

private Context ctx;
ProgressDialog dialog;

public VerifyCredentials(Context applicationContext) 
{
    // TODO Auto-generated constructor stub
    ctx = applicationContext;
    dialog = new ProgressDialog(applicationContext);
}

@Override
protected void onPreExecute()
{
    dialog.setTitle("Please wait");
    dialog.setMessage("Verifying username and password...");
    dialog.show();
}

@Override
protected Boolean doInBackground(ArrayList<String>...creds) 
{   
    //To return
    Boolean serverAnwser = false;

    //Get the creds
    String userID = creds[0].get(0).toString();
    Log.i("ZEAL", "Creds[0]: " + creds[0].get(0).toString());
    String userPWD = creds[0].get(1).toString();
    Log.i("ZEAL", "Creds[1]: " + creds[0].get(1).toString());

    //Get creds from server
    try {
        String serverANW = null;
        URL getCreds = new URL("http://XXX.XXX.XXX.XXX/api/api.php?method=getCreds&id=" + userID + "&pwd=" + userPWD);
        Log.i("ZEAL", "Webservice URL: " + getCreds.toString());

        URLConnection tc = getCreds.openConnection();
        BufferedReader in = new BufferedReader(new InputStreamReader(
                tc.getInputStream()));

        // Get JSON Object
        JSONArray jArray;
        jArray = new JSONArray(in.readLine());

        //Log json object returned
        Log.i("ZEAL", jArray.toString());

        //Check server response
        //for (int i = 0; i < jArray.length(); i++) 
        //{
            JSONObject e = jArray.getJSONObject(0);
            String s = e.getString("RETURN");
            JSONObject jObject = new JSONObject(s);
            serverANW = jObject.getString("RESULT");
            Log.i("ZEAL", "API Result: " + serverANW);
        //}

        if(serverANW.equalsIgnoreCase("True"))
        {
            serverAnwser = true; 
            Log.i("ZEAL", "ServerANW = " + serverANW.toString());
            Log.i("ZEAL", "Setting server anwser to true");
        }
        else
        {
            serverAnwser = false;
            Log.i("ZEAL", "ServerANW = " + serverANW.toString());
            Log.i("ZEAL", "Setting server anwser to false - " + serverAnwser.toString());
        }

    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return serverAnwser;
}

@Override
protected void onPostExecute(final Boolean authCode)
{
    dialog.dismiss();

   // Log what the functions is doing
   Log.d("ZEAL","Server Response: " + authCode.toString());
   Toast.makeText(ctx, "Server says:  " + authCode.toString(), Toast.LENGTH_LONG).show();
   Main m = new Main();
   m.verifiedCreds(m, authCode);

}
} 
```

错误：

```
05-23 15:18:57.190: E/AndroidRuntime(25475): FATAL EXCEPTION: main
05-23 15:18:57.190: E/AndroidRuntime(25475): java.lang.NullPointerException
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.content.ContextWrapper.getPackageName(ContextWrapper.java:127)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.content.ComponentName.<init>(ComponentName.java:75)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.content.Intent.<init>(Intent.java:3174)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at com.coolprograms.zeal.Main.verifiedCreds(Main.java:85)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at com.coolprograms.zeal.VerifyCredentials.onPostExecute(VerifyCredentials.java:117)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at com.coolprograms.zeal.VerifyCredentials.onPostExecute(VerifyCredentials.java:1)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.os.AsyncTask.finish(AsyncTask.java:602)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.os.AsyncTask.access$600(AsyncTask.java:156)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.os.Looper.loop(Looper.java:137)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at android.app.ActivityThread.main(ActivityThread.java:4424)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at java.lang.reflect.Method.invokeNative(Native Method)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at java.lang.reflect.Method.invoke(Method.java:511)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-23 15:18:57.190: E/AndroidRuntime(25475):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T23:05:30.337

您可以创建一个接口，让 Main 实现该接口，将 Main 作为构造函数参数传递给 asynctask 并让它使用您要传回的参数调用 Main。

界面：

```
public interface CredListener() {
  void verify(Boolean status);
} 
```

在类定义中声明 Main 实现了 CredListener

```
class Main extends Activity implements CredListener {
... 
```

VerifyCredentials() 的新构造函数：

```
public VerifyCredentials(CredListener listener, Context applicationContext) 
{
  this.listener = lister; // remember the listener

  ctx = applicationContext;
  dialog = new ProgressDialog(applicationContext);
} 
```

在 onPostExecute(final Boolean authCode) 中将结果提供给侦听器：

```
listener.verify(authCode); 
```

这是 Main 到 VerifyCredentials 的更松散耦合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:38:57.723

您可以将活动作为参数传递给 AsyncTask。在您的主要课程中：

```
private void verify (ArrayList<String> creds)
{
    // Start AsyncTask to get creds
    VerifyCredentials vc = new VerifyCredentials(this);
    vc.mActivity = this;
    vs.execute(creds);
} 
```

将此成员变量添加到您的 VerifyCredentials：

```
public Main mActivity; 
```

在 postExecute() 中调用调用 Activity 的方法：

```
mActivity.verifiedCreds(m, authCode); 
```

我不会推荐这个。我只想在主类中创建一个 VerifyCredentials 子类。

# python - jsonify 未定义 - 内部服务器错误

> ID：10727366
> 
> 赞同：23
> 
> 时间：2012-05-23T20:30:20.957
> 
> 标签：python, json, flask, internal-server-error

使用 Flask 并只想打印一些 JSON 格式的数据，但我不断收到错误消息：

> NameError：未定义全局名称“jsonify”

```
from flask import Flask
from flask import json
app = Flask(__name__)

@app.route("/")
def testJSON():
        x = "Test1"
        y = "Test2"
        return jsonify(a=x,z=y)

if __name__ == "__main__":
        app.debug = True
        app.run() 
```

他们的[文档](http://flask.pocoo.org/docs/api/#returning-json)说我要么需要安装 Python 2.6 要么需要安装 simplejson - 我两者都有。

Python 2.7.3：

> sys.version '2.7.3（默认，2012 年 5 月 9 日，23:42:16）\n[GCC 4.4.3]'

简单的json：

> root@Python:~/PythonScripts# pip install simplejson 要求已经满足（使用--upgrade 升级）： /usr/local/lib/python2.7/site-packages 中的simplejson 清理...

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-05-23T20:39:54.480

`jsonify()` [是一个包含在`flask`模块](https://flask.palletsprojects.com/en/2.0.x/api/#flask.json.jsonify)中的函数。

所以你需要导入它。
将脚本的开头更改为：

```
from flask import jsonify # <- `jsonify` instead of `json` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-20T09:38:42.640

似乎 Jsonify 函数在导入烧瓶时默认包含，但现在当您编写时

```
import flask 
```

它也不会导入 jsonify。您需要做的就是显式导入 jsonify

用这个。

```
import flask
from flask import jsonify 
```

这将为您启用 jsonify 功能

现在，您可能正在使用烧瓶中的其他东西，这可能会一遍又一遍地发生在不同的事情上，所以您可能想要这样做，这将一次性导入 jsonify 和烧瓶的所有其他组件。

```
import flask
from flask import * 
```

# python - Python/Matplotlib 中的文本下划线

> ID：10727368
> 
> 赞同：11
> 
> 时间：2012-05-23T20:30:32.727
> 
> 标签：python, matplotlib, underline

我找不到关于这个主题的另一个线程或文档 - 有没有人成功地在 pythons matplotlib 包中下划线？对于所有其他属性，我使用的语法是这样的：

```
plt.text(0.05, 0.90, 'Parameters: ', fontsize=12) 
```

但是，除了实际将一行编码到文件中之外，我无法弄清楚如何在该文本下划线。

想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T20:57:47.237

Matplotlib 可以使用 LaTeX 处理所有文本，有关更多信息，请参阅文档的[此页面](http://matplotlib.sourceforge.net/users/usetex.html)。在 LaTeX 中为文本加下划线的命令很简单`\underline`。从示例脚本之一的文档字符串中：

> `rc`如果设置了参数 text.usetex ，您可以使用 TeX 渲染所有 matplotlib 文本。这目前适用于后端`agg`和`ps`后端，并且要求您在系统上正确安装[http://matplotlib.sf.net/matplotlib.texmanager.html中描述的 tex 和其他依赖项。](http://matplotlib.sf.net/matplotlib.texmanager.html)第一次运行脚本时，您会看到 tex 和相关工具的大量输出。下一次，运行可能会静默，因为很多信息都缓存在 ~/.tex.cache 中

所以作为一个简单的例子，我们可以做

```
import matplotlib.pyplot as plt
from matplotlib import rc

rc('text', usetex=True)

plt.sunplot(111)

plt.text(0.05, 0.90, r'\underline{Parameters}: ', fontsize=12) 
```

获取带下划线的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-31T15:45:47.900

这是一个老问题，但我实际上需要为不使用 LaTeX 的文本添加下划线，所以我想我会跟进我提出的解决方案，以供可能遇到相同问题的其他人使用。

最终，我的解决方案为有问题的文本对象找到了一个边界框，然后在注释命令中使用 arrowprop 参数，以便在文本下方绘制一条直线。这种方法有一些注意事项，但总的来说我觉得它非常灵活，因为你可以根据需要自定义下划线。

我的解决方案示例如下：

```
import matplotlib.pyplot as plt 
import numpy as np 

def test_plot():
    f = plt.figure()
    ax = plt.gca()
    ax.plot(np.sin(np.linspace(0,2*np.pi,100)))

    text1 = ax.annotate("sin(x)", xy=(.7,.7), xycoords="axes fraction")   
    underline_annotation(text1)

    text2 = ax.annotate("sin(x)", xy=(.7,.6), xycoords="axes fraction",
                        fontsize=15, ha="center")
    underline_annotation(text2)

    plt.show()

def underline_annotation(text):
    f = plt.gcf()
    ax = plt.gca()
    tb = text.get_tightbbox(f.canvas.get_renderer()).transformed(f.transFigure.inverted())
                            # text isn't drawn immediately and must be 
                            # given a renderer if one isn't cached.
                                                    # tightbbox return units are in 
                                                    # 'figure pixels', transformed 
                                                    # to 'figure fraction'.
    ax.annotate('', xy=(tb.xmin,tb.y0), xytext=(tb.xmax,tb.y0),
                xycoords="figure fraction",
                arrowprops=dict(arrowstyle="-", color='k'))
                #uses an arrowprops to draw a straightline anywhere on the axis. 
```

这会产生一个[带下划线的带注释的 sin 示例](https://i.stack.imgur.com/wtTG8.png)。

需要注意的一件事是，如果您想填充下划线或控制线条粗细（请注意，两个注释的线条粗细相同）您必须在“underline_annotation”命令中手动完成，但这是通过arrowprops dict传递更多参数或增加绘制线条的位置很容易做到。

# r - 在 R 中绘制 2D 表格对象时控制轴标签的格式/位置

> ID：10727373
> 
> 赞同：2
> 
> 时间：2012-05-23T20:30:45.940
> 
> 标签：r, formatting, plot, ggplot2

在 R 中绘制二维表格时，我希望更好地控制轴标签的大小和位置，但表格对象的绘制规则似乎与数据框的工作方式不同。为了使我的问题具体化，我在此消息的末尾粘贴了虚假数据，使用`dput()`. 运行该代码将创建在`dept.table`下面的绘图代码中使用的对象。

当您`plot`在 R 中的 2D 表上运行时，它会创建一个马赛克图，如下所示：

```
plot(dept.table, 
     col=c("yellow","blue","red"), 
     las=1, 
     cex=.7, 
     dir=c("h","v"), 
     off=c(8,4)) 
```

我想对该调用创建的图中的轴标签进行三处更改。

首先，交替顶部的“大一”、“大二”等标签的高度，使它们不重叠（我知道我可以缩短它们，但我也想弄清楚这一点以供将来参考，因为缩短标签并不总是很方便）。我想关闭轴标签并使用该`text()`功能手动添加它们。但是，在绘制表格对象时添加`xaxt = 'n'`调用`plot`显然不起作用（R 给出了“额外的参数 'xaxt' 将被忽略”消息）。

另一种选择是通过设置旋转 x 轴标签`las=2`。但是，我更喜欢将标签水平放置以便于阅读。不过，我应该注意，当我设置时`las=2`，“研究生”标签会重叠到绘图区域上。

所以这里有几个问题：

1.  如何关闭 x 轴标签的绘图以便手动添加标签？
2.  更好的是，有没有一种更优雅的方法可以让标签上下交替，这样它们就不会重叠，而不必手动设置每个标签的位置？
3.  如果标签与绘图区域重叠，有没有办法（除了缩短标签）来消除重叠？
4.  有没有办法为 x 轴和 y 轴标签设置不同的文本大小？我想要制作的实际绘图有更多的部门（垂直轴），所以我想为 y 轴使用比 x 轴更小的文本大小。轴文本大小的唯一选项似乎是`cex`，它调整两个轴。有没有办法单独调整每个轴？

5.  y 轴标签左对齐。有没有办法让他们正确合理，所以他们会靠近情节区域？

顺便说一句，虽然我用基本图形制作了这个图，但我很想知道是否有更好的方法可以用 lattice、ggplot2 或其他包来完成。

```
dept.table = structure(c(10, 15, 20, 200, 5, 15, 35, 200, 49, 15, 25, 20, 
250, 5, 12, 34, 150, 30, 50, 108, 75, 800, 32, 39, 135, 400, 
195, 80, 99, 64, 700, 47, 41, 134, 350, 160, 5, 10, 5, 110, 5, 
4, 10, 30, 13), .Dim = c(9L, 5L), .Dimnames = structure(list(
    c("Anthropology", "Economics", "Mathematics", "Business Administration", 
    "Geography", "Special Education, & Deaf Studies", "History", 
    "Kinesiology & Health Science", "Family & Consumer Sciences"
    ), c("Freshman", "Sophomore", "Junior", "Senior", "Graduate Student"
    )), .Names = c("", "")), class = "table") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T23:27:31.827

使用 ggplot 的方法

```
# convert to a data frame
dept_data <- as.data.frame(dept.table) 
```

鉴于您正在尝试绘制比例（不是原始数字）

```
# add proportions
library(plyr)
dept_data_prop <- ddply(dept_data, .(Var1), mutate, prop = Freq /sum(Freq))

library(ggplot2)
ggplot(dept_data_prop, aes(x= Var1, y = prop, colour = Var2, fill = Var2)) + 
  geom_bar() + 
  coord_flip() + 
  facet_wrap(~Var1, scales = 'free', ncol = 1) + 
  opts(strip.background =theme_blank(), strip.text.x = theme_blank(), 
       strip.text.y = theme_text(), axis.ticks = theme_blank(), 
       axis.title.x = theme_blank(), axis.text.x = theme_blank()) + xlab('') + 
  scale_fill_brewer('Student',  type = 'div', palette = 5) + 
  scale_colour_brewer('Student', type = 'div', palette = 5) + 
  scale_x_discrete(expand = c(0,0)) + 
  scale_y_continuous(expand=c(0,0)) 
```

要了解有关可用选项的更多信息，请查看`?opts`

以下改编自[学习r](http://learnr.wordpress.com/2009/03/29/ggplot2_marimekko_mosaic_chart/)

获得与总计数成比例的条形宽度

```
dept_data <- as.data.frame(dept.table)
names(dept_data) <- c('department', 'student', 'count')

dept_prop <- ddply(dept_data, .(department), mutate, 
               prop_department = count / sum(count),
               max_department = cumsum(prop_department),
               min_department = max_department - prop_department,
               total_department = sum(count))

dept_prop <- mutate(dept_prop, prop_total = total_department / sum(count))

dept_prop <- ddply(dept_prop, .(student), mutate, 
   max_total = cumsum(prop_total), 
   min_total = max_total - prop_total)

ggplot(dept_prop, aes(xmin = min_department, xmax = max_department, 
                      ymin = min_total, ymax = max_total)) +
 geom_rect(aes(colour = student, fill =student)) + 
 facet_grid(department~., scales = 'free', space = 'free') +
 opts(strip.background =theme_blank(), 
   strip.text.y = theme_text(hjust = 0.05), axis.ticks = theme_blank(), 
   axis.title.x = theme_blank(), axis.text.x = theme_blank(), 
   axis.title.y = theme_blank(), axis.text.y = theme_blank(), 
   legend.position = 'bottom', legend.justification = 'left',
   panel.border = theme_blank(), panel.background = theme_blank(), 
   panel.grid.major = theme_blank(), panel.grid.minor = theme_blank()) +
   xlab('') + 
 scale_fill_brewer('Student',  palette = 'Set1') + 
 scale_colour_brewer('Student', palette = 'Set1') + 
 scale_x_continuous(expand = c(0, 0)) + 
 scale_y_continuous(expand = c(0, 0)) 
```

# javascript - 框架中用于更轻松地定义 SVG 路径字符串的实用程序？

> ID：10727376
> 
> 赞同：0
> 
> 时间：2012-05-23T20:30:53.757
> 
> 标签：javascript, html, svg

我正在通过 Raphael 框架尝试 svg 功能（它的路径文档在[这里](http://raphaeljs.com/reference.html#Paper.path)）。我发现编写路径字符串非常乏味，因为在创建新路径或查看已编写的路径时，我必须不断查找格式规范。是否有简化此过程的框架？例如，不必编写如下内容：

```
function pathStringForBoxWithQuad(x1, y1, x2, y2) {
    var edgeLength = 8;
    var str = "M " + (x2 + edgeLength) + " " + y1; // move to top right
    str += " L " + x1 + " " + y1; // line to top left
    str += " L " + x1 + " " + y2; // line to bottom left
    str += " L " + (x2 + edgeLength) + " " + y2; // line to bottom right
    str += " Q " + x2 + " " + (y1 + (y2 - y1) / 2) + " " + (x2 + edgeLength) + " " + y1; // quadratic back to top right
    str += " Z";
    return str;
} 
```

您可以编写如下内容，但它会返回相同的字符串：

```
function pathStringForBoxWithQuad(x1, y1, x2, y2) {
    var edgeLength = 8;
    var str = new SVGPathString()
            .moveTo(x2 + edgeLength, y1)
            .lineTo(x1, y1)
            .lineTo(x1, y2)
            .lineTo(x2 + edgeLength, y2)
            .quadTo(x2, (y1 + (y2 - y1) / 2), x2 + edgeLength, y1 );
    return str;
} 
```

流行的框架中是否存在类似于第二种方法的东西？我发现这种类型的路径结构对读者更友好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:48:47.343

你想要的看起来有点类似于SVG Tiny 1.2 中的[SVGPath API ，没有字符串化。](http://www.w3.org/TR/SVGTiny12/svgudom.html#svg__SVGPath)这些路径对象并不是要在序列化上浪费时间，而是要直接分配它们。在所有当前浏览器中，SVGPath API 仅由 Opera AFAIK 实现。

SVG WG 正在考虑改进 SVG2 的路径 API，因此希望将来会有更好的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:44:47.193

我也在寻找类似的东西，但现在我最终使用 Underscore.js 为 SVG 命令创建模板。就像是..

```
var commands = {
    line: _.template('M<%= x1 %>,<%= y1 %> L<%= x2 %>,<%= y2 %>'),
  .....
}
....
commands.line({
    x1: 0,
    y1: 0,

    x2: 0,
    y2: 10        
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:20:27.020

总是有 SVG DOM。

```
 var path = document.getElementById("<pathId>");
  var segments = path.pathSegList; 
```

当您需要创建新的路径段时，您需要使用类似的方法

```
var newSegment = path.createSVGPathSegArcAbs(...) 
```

调用segments.appendItem 或segments.insertItemBefore 添加它。有关详细信息，请参阅[http://www.w3.org/TR/2003/REC-SVG11-20030114/paths.html#DOMInterfaces 。](http://www.w3.org/TR/2003/REC-SVG11-20030114/paths.html#DOMInterfaces)

# c# - 在 Watin 中调用 Javascript

> ID：10727379
> 
> 赞同：4
> 
> 时间：2012-05-23T20:31:19.960
> 
> 标签：c#, javascript, .net, watin

我正在尝试使用 C# eval 调用执行一些 JavaScript。

```
browser.Frames[1].Eval("myFunctionCall(" + Id + ", 1, " + RowNumber + ");"); 
```

它似乎找不到该函数，因为它抛出了一个 'JavaScriptException' “属性 'myFunctionCall' 的值为 null 或未定义，而不是函数对象”

这是背后的故事。
我通过跟踪 JavaScript 发现这是单击感兴趣元素时调用的函数。所以我在浏览器中打开页面并执行这个 JavaScript。加载时，出现上述错误。
我是初学者，我不确定如何调用远程引用的 JavaScript。

总之，我想调用javascript方法。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-08T00:25:14.933

我将首先确保在 WatiN 中使用包含该函数的 JavaScript 时实际加载它。您可以尝试在调用之前声明该函数。

```
Browser.Eval(
  "function myFunctionCall(Id, Num, RowNumber) {" +
  " var a = 0;" +
  " var b = 0;" +
  "}" + 
  "myFunctionCall(" + Id + ", 1, " + RowNumber + ");"); 
```

希望能帮助到你！

此外，请确保该功能可从您的框架中使用。换句话说，框架可以访问该功能。

# php - 使用 imagemagick 太暗/太亮将 dcraw 转换为 jpeg

> ID：10727381
> 
> 赞同：2
> 
> 时间：2012-05-23T20:31:25.840
> 
> 标签：php, image, image-processing, imagemagick, dcraw

我正在使用 dcraw (http://www.cybercom.net/~dcoffin/dcraw/) 来处理相机原始文件并将其传送到 imagemagick 以将其转换为 jpg 以供网络使用。我做了一些不同的测试，jpeg 从来没有像我在 Adob​​e Lightroom 3 中看到的那样产生完全相同的颜色/亮度。即使我只是从 dcraw 做海峡 tiff，tiff 也没有相同的颜色。所以，我认为我需要在命令的绘制部分进行一些调整。

在 jpeg 上复制原始文件的正确颜色和亮度的最佳方法是什么。我目前正在这样做：

```
dcraw -c -w 7_1337801236.orf | convert -compress lzw - 7_1337801236.jpg 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T12:57:31.150

看起来像我一直在打击的同一个 ImageMagick 错误，曾经好的转换命令现在会产生深色 JPEG。我已经等待了几个月的修复，今天当一个新的 IM 版本出现在 Debian Sid 但仍然没有解决问题时，我开始在 IM 网站上阅读很多关于色彩空间的内容。可悲的是，这一切都非常令人头疼，我发现没有明确的说明（我尝试过的所有东西都惨败）如何让我的 JPEG 看起来正常。

然后我发现[这篇文章](https://stackoverflow.com/a/10567629)建议使用一个名为[GraphicsMagick](http://www.graphicsmagick.org/)的分叉项目。所以在 Debian 中，我所要做的就是：

```
apt-get install graphicsmagick-imagemagick-compat 
```

这会引入 graphicsmagick 包并删除 imagemagick，但无需更改我的转换脚本即可无缝运行。快乐的露营者！

HTH某人:)

# sql-server - SQL商业智能工具搭建仪表盘系统监控交易数据库？

> ID：10727382
> 
> 赞同：1
> 
> 时间：2012-05-23T20:31:28.233
> 
> 标签：sql-server, business-intelligence

我们基本上在事务数据库中有两个主要表（组和集合）。使用winform系统，将每行数据记录到数据库中。事务量为每秒 5 行。

现在我们的目标是建立一个仪表板系统来监控事务数据库，主要显示事情的进展情况。我不确定在这种情况下使用 MS SQL BI 工具（如 SSAS、SSIS 和 SSRS）是否有帮助。所以我需要专家的建议。

这是我担心的问题-如果我错了，请纠正我。

1.  频繁从事务数据库中查询数据以获取仪表板将是一个很大的负担 - Pro-BI
2.  为两张表建仓库似乎有点矫枉过正 - Anti-BI

是否有充分的理由使用或不使用 BI 工具？

更新：为了澄清我的问题，我只想知道是否有其他方法可以在没有数据仓库且不影响事务系统的情况下构建仪表板系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T16:09:23.683

在一个项目中，我必须在订单流程中跟踪订单流。我没有在每次需要数据时都点击生产表，而是创建了一个表来保存由行插入触发器填充的结果。

在表格之前，我必须做一个长查询并对结果执行业务逻辑来计算状态。实时速度很慢。该表是预先计算的，允许立即返回数据。

本质上，这就是仓库术语中的事实表，只是我没有使用 ETL 工具填充它。

# facebook - 计算使用 facebook cookie 的用户百分比？

> ID：10727383
> 
> 赞同：0
> 
> 时间：2012-05-23T20:31:39.013
> 
> 标签：facebook, session, cookies, fbml

我正在尝试确定是否有一种方法可以计算访问我们网站的用户的百分比，这些用户的浏览器上已经有 facebook cookie。

我正在尝试确定我们应该在多大程度上致力于将 facebook 的社交功能集成到我们的网站中，并希望了解 facebook 在我们的受众中的影响力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:37:11.983

使用[FB.getLoginStatus](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)您可以计算出有多少人在访问您的网站时登录了 Facebook。您只需查看有多少人拥有`response.status === 'not_authorized'`.

# c# - Form.ShowDialog 在循环中运行时只打开一次

> ID：10727384
> 
> 赞同：0
> 
> 时间：2012-05-23T20:31:57.390
> 
> 标签：c#, .net, winforms, showdialog

我有一个 Form1，当我运行一个循环时，我需要打开另一个表单（Form2）。问题是，当我运行循环时，它仅第一次显示 Form2，然后 Form2 会自动打开和关闭。

为了探测它，我编写了这个简单的代码，但它不起作用：

```
Form2 reg = new Form2();
while (true) 
{
    reg.ShowDialog();
} 
```

在表格 2 中：

```
private void button1_Click(object sender, EventArgs e)
{
    Application.Exit();
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:08:07.883

I think that you are closing your Form2 using the button1\. This executes button1_click which doesn't simply close Form2, it closes the whole Application.

I tried your code and if I close Form2 using the X in the upper right corner it is closed and immediately reopened.

Should this be your problem, you can solve it by just modifying your method like this:

```
private void button1_Click(object sender, EventArgs e)
{
    this.Close();
} 
```

Another solution could be setting the DialogResult property of your button to something different from the default DialogResult.None. In this way when the button is clicked the form is automatically closed, and the value of the property is used as the result of your ShowDialog().

# c# - C# Gridview , TableDefinition,type datetime : 如何将默认 mm/dd/year 更改为 dd/mm/year？

> ID：10727387
> 
> 赞同：0
> 
> 时间：2012-05-23T20:32:15.140
> 
> 标签：c#, asp.net, sql

SqlDatabase、Gridview、SqlDataSource：

默认情况下，在表定义中，数据类型： datetime 是 mm/dd/year 。

有什么方法可以使它成为 dd/mm/year 吗？我可以在 gridview 的控制下做到这一点，但数据库不会接受它，因为它不是默认格式。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:37:27.323

我假设您在日期字段中使用 BoundColumn，并且我假设您知道 DataFormatString 属性？这对你不起作用吗？

如果没有，您可以尝试利用 RowUpdating 事件将新日期值转换为正确的格式。

# ruby-on-rails - Ruby on Rails fields_for 在编辑操作中生成太多字段

> ID：10727391
> 
> 赞同：2
> 
> 时间：2012-05-23T20:32:36.077
> 
> 标签：ruby-on-rails, forms, controller, fields-for

我有一个真正的野兽表单，它本质上是一个五页的销售表单，在创建新表单时一切都很好。但是当您去编辑新表单时，它会重复四次字段和值，有时甚至是 7 次。我不知道编辑操作是如何工作的，它使用与新操作相同的表单部分。但这是我对新操作和编辑操作的控制器操作。

此外，并非每个字段都发生重复，它似乎只发生在有`has_many`关系的部分。

```
 # GET /references/new
  # GET /references/new.json
  def new
    @reference = Reference.new
    @user_id = params[:user_id]
    @reference.build_customer_overview
    @reference.build_solution_description
    @reference.solution_description.deal_details.build
    component = @reference.components.build
    component.servers.build
    component.services.build
    partner = @reference.build_partner
    partner.competitors.build
    partner.contacts.build
    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @reference }
    end
  end

  # GET /references/1/edit
  def edit
    @reference = Reference.find(params[:id])
    @user_id = @reference.user_id
  end 
```

我只是不知道为什么它会在编辑操作中生成额外的字段，希望有更多 Rails 经验的人知道这种行为。

谢谢！

编辑：

这是表单的一部分，其中每个 ruby​​ 块渲染 4 次。

```
 <%= f.fields_for :deal_details do |ff| %>
    <div>
      <%= ff.label :title, 'Customer\'s business/IT needs (why was this solution required)' %>
      <%= ff.hidden_field :title, value: 'business/IT needs' %>
      <br />
      <%= ff.text_area :content %>
    </div>
  <% end %>

  <%= f.fields_for :deal_details do |ff| %>
    <div>
      <%= ff.label :title, 'Description of solution: (including product/services information)' %>
      <%= ff.hidden_field :title, value: 'Description of solution' %>
      <br />
      <%= ff.text_area :content %>
    </div>
  <% end %>

  <%= f.fields_for :deal_details do |ff| %>
    <div>
      <%= ff.label :title, 'Measurable anticipated benefits to the client and/or it\'s end customers: (i.e. this does NOT mean "benefits to")' %>
      <%= ff.hidden_field :title, value: 'Measurable benefits' %>
      <br />
      <%= ff.text_area :content %>
    </div>
  <% end %>

  <%= f.fields_for :deal_details do |ff| %>
    <div>
      <%= ff.label :title, 'Why won? (and why any competitors failed)' %>
      <%= ff.hidden_field :title, value: 'Why won?' %>
      <br />
      <%= ff.text_area :content %>
    </div>
  <% end %> 
```

最后更新：

好的，所以我需要制作一个单独的表格进行编辑，使用一个通用块循环通过数据库。这就是我所拥有的组件

```
 <fieldset>
    <% title = f.object.component_title %>
    <h3><%= f.object.component_title %></h3>
    <%= f.fields_for :servers do |fff| %>
        <% if title == 'psg' %>
          <%= render 'psg_fields', f: fff %>
        <% end %>

        <% if title == 'servers' %>
          <%= render 'server_fields', f: fff %>
        <% end %>

        <% if title == 'storage' %>
          <%= render 'storage_fields', f: fff %>
        <% end %>

        <% if title == 'ipg' %>
          <%= render 'ipg_fields', f: fff %>
        <% end %>

        <% if title == 'software' %>
          <%= render 'software_fields', f: fff %>
        <% end %>

        <% if title == 'services' %>
          <%= render 'service_fields', f: fff %>
        <% end %>

        <% if title == 'financial' %>
          <%= render 'financial_fields', f: fff %>
        <% end %>
    <% end %>
    <%= link_to_add_fields "Add Server", f, :servers, :servers %>
  </fieldset> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T03:51:45.773

当您创建父对象`Reference`时，您似乎正在创建多个交易详细信息。默认情况下，当 fields_for 帮助器用于`has_many`关系时，它将为每个子实例重复 fields_for 块一次（在这种情况下为“deal_detail”）。

要仅显示正确的实例，只需像这样将您的实例添加到 fields_for 中，假设您有一个 deal_detail 实例保存到`@my_deal_detail`

```
<%= f.fields_for :deal_details, @my_deal_detail do |ff| %> 
```

在“has_many”下的[fields_for 文档中](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)有更多信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T21:21:47.850

在制作这样的表单时，我会研究`formtastic`or `simple_form`，它们有一些钩子来帮助管理带有子模型的表单。

假设你想继续你目前正在做的事情。我的猜测是 deal_details 应该`has_one`不是`has_many`关系

# vim - vim 不允许退格

> ID：10727392
> 
> 赞同：34
> 
> 时间：2012-05-23T20:32:41.807
> 
> 标签：vim

文件`foo`有文本：

```
This| is a line. 
```

如果我将光标放在`|`，跳到`insert`模式，然后按`backspace`，什么也不会发生。如果我输入了一些东西，我可以删除我输入的东西，但只能回到插入开始的地方。例如，如果我将光标放在行尾并键入`word`，我可以删除`word`但不能删除`.`它左侧的或任何内容。

这很烦人。这是什么`vim`设置？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-05-23T20:35:27.133

### 解释

“退格”设置控制此行为。

从帮助页面：

```
Influences the working of <BS>, <Del>, CTRL-W and CTRL-U in Insert
mode.  This is a list of items, separated by commas.  Each item allows
a way to backspace over something:

value   effect
indent  allow backspacing over autoindent
eol     allow backspacing over line breaks (join lines)
start   allow backspacing over the start of insert; CTRL-W and CTRL-U
            stop once at the start of insert. 
```

* * *

### 更改退格行为

尝试将以下内容添加到您的`.vimrc`：

```
set backspace=indent,eol,start " backspace over everything in insert mode 
```

同一命令的简写版本：

```
set backspace=2 
```

# c# - 除了类参数的null之外的C#可选参数？

> ID：10727395
> 
> 赞同：10
> 
> 时间：2012-05-23T20:32:45.603
> 
> 标签：c#, .net

这个问题的最佳解决方案是什么？我正在尝试创建一个函数，该函数具有多个类类型的可选参数，其中 null 是一个有意义的值，不能用作默认值。如中，

```
public void DoSomething(Class1 optional1, Class2 optional2, Class3 optional3)
    {
        if (! WasSpecified(optional1)) { optional1 = defaultForOptional1; }
        if (! WasSpecified(optional2)) { optional2 = defaultForOptional2; }
        if (! WasSpecified(optional3)) { optional3 = defaultForOptional3; }

        // ... 做实际的工作 ...
    }

```

我不能使用`Class1 optional1 = null`，因为 null 是有意义的。由于这些可选参数的编译时常量要求，我无法使用某些占位符类实例`Class1 optional1 = defaultForOptional1`，因此我提出了以下选项：

1.  为每个可能的组合提供重载，这意味着此方法有 8 个重载。
2.  为每个可选参数包含一个布尔参数，指示是否使用默认值，我将签名弄乱了。

有没有人为此想出一些聪明的解决方案？

谢谢！

**编辑：**我最终写了一个包装类，所以我不必一直重复`Boolean HasFoo`。

```
 /// <summary>
    /// A wrapper for variables indicating whether or not the variable has
    /// been set.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    public struct Setable<T>
    {
        // According to http://msdn.microsoft.com/en-us/library/aa288208%28v=vs.71%29.aspx,
        // "[s]tructs cannot contain explicit parameterless constructors" and "[s]truct
        // members are automatically initialized to their default values."  That's fine,
        // since Boolean defaults to false and usually T will be nullable.

        /// <summary>
        /// Whether or not the variable was set.
        /// </summary>
        public Boolean IsSet { get; private set; }

        /// <summary>
        /// The variable value.
        /// </summary>
        public T Value { get; private set; }

        /// <summary>
        /// Converts from Setable to T.
        /// </summary>
        /// <param name="p_setable"></param>
        /// <returns></returns>
        public static implicit operator T(Setable<T> p_setable)
        {
            return p_setable.Value;
        }

        /// <summary>
        /// Converts from T to Setable.
        /// </summary>
        /// <param name="p_tee"></param>
        /// <returns></returns>
        public static implicit operator Setable<T>(T p_tee)
        {
            return new Setable<T>
            {
                IsSet = true
              , Value = p_tee
            };
        }
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T20:36:57.357

我至少会*考虑*为参数创建一个新类型：

```
public void DoSomething(DoSomethingOptions options) 
```

... DoSomethingOptions 可能如下所示：

```
public class DoSomethingOptions
{
    private Class1 class1;
    public bool HasClass1 { get; private set; }

    public Class1 Class1 
    {
        get { return class1; }
        set
        {
            class1 = value;
            HasClass1 = true;
        }
    }

    ... for other properties ...
} 
```

然后你可以调用它：

```
DoSomething(new DoSomethingOptions { Class1 = null, Class2 = new Class2() }); 
```

您最终不会得到一组指数级的重载，您仍然可以合理紧凑地调用它。

这类似于`Process`使用`ProcessStartInfo`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T20:33:59.553

> 为每个可能的组合提供重载，这意味着此方法有 8 个重载。

这是我的偏好。它使情况非常清晰和可维护。在内部，您可以映射到单个初始化例程以减少重复代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-23T20:37:16.267

我更喜欢让`null`意思是“什么都没有”，并且有一个`static readonly`type 的成员`Class1`，`Class2`等等 on `Class1`，`Class2`等等。命名`None`。然后，`null`您可以按照最初的意图将 null 用作“无”，而不是有意义。

如果这令人困惑：

```
public class Class1
{
    public static readonly Class1 None = new Class1();
}
public static Class2
{
    public static readonly Class2 None = new Class2();
} 
```

请注意，如果`null`在您的情况下意味着“无”以外的其他内容（如“MissingData”或其他内容），您应该这样命名该成员。另请注意：这对于将来阅读和使用您的代码的其他人来说会更有意义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T20:49:08.073

您可以创建一个`Flags`可以传递的枚举，以标记要使用的类。

```
[Flags]
public enum DoSomethingOptions
{
    None = 0,
    UseClass1 = 1,
    UseClass2 = 2,
    UseClass3 = 4,
    etc..
}

DoSomething(Class1 class1, ..., DoSomethingOptions options = DoSomethingOptions.None) { ... } 
```

然后只需将该枚举传入以标记要使用的类。我确实想知道为什么您`null`以前的意思不是**null**？虽然这可能是一个解决方案，但我真的想说“重新考虑你的设计”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T20:36:36.407

是的，尝试使用一个对象。定义一个封装可能选择的类。在对象中设置选项时，如果它是通过使用原始属性的设置器设置的，则可以将其存储在同一对象中。

一个例子：

```
internal class SettingsHolder
{
    public SettingsHolder()
    {
        IsOriginalPropADefault = true;
    }

    private Class1 originalProp;
    public Class1 OriginalProp
    {
        get
        {
            return originalProp;
        }
        set
        {
            originalProp = value;
            IsOriginalPropADefault = false;
        }
    }

    public bool IsOriginalPropADefault { get; private set; }

} 
```

# tomcat - 从 Maven 插件为嵌入式 Tomcat 配置日志记录

> ID：10727396
> 
> 赞同：21
> 
> 时间：2012-05-23T20:32:47.650
> 
> 标签：tomcat, logging, configuration, maven-plugin

我正在使用 Tomcat7 Maven 插件：

```
<plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat7-maven-plugin</artifactId>
            <version>2.0-beta-1</version>
            <configuration>
                    <update>true</update>
                    <contextFile>${basedir}/conf/context.xml</contextFile>
                    <tomcatUsers>${basedir}/conf/tomcat-users.xml</tomcatUsers>
            </configuration>
 </plugin> 
```

我按如下方式运行我的应用程序（运行嵌入的 tomcat）

> mvn tomcat7:运行

问题：没有 catalina.out 日志文件？

我想打开领域的日志记录，以便我可以调试一些东西。在 ./target/tomcat/log 目录中只有 access_log.* 没有其他日志文件。

我试过弄乱 ./target/tomcat/conf/logging.properties 文件无济于事。

如何为此 Tomcat 配置日志记录？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-09T16:59:43.803

我找到了解决方案，您需要描述日志库的额外依赖项。就我而言，它的[logback](http://logback.qos.ch/)，如果您使用 log4j 只需更改依赖项。它有效......在我的配置下：

```
 <plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat7-maven-plugin</artifactId>
            <version>2.1</version>
            <configuration>
                <path>/myapp</path>
                <extraDependencies>
                    <dependency>
                        <groupId>org.slf4j</groupId>
                        <artifactId>slf4j-api</artifactId>
                        <version>1.7.2</version>
                    </dependency>
                    <dependency>
                        <groupId>org.slf4j</groupId>
                        <artifactId>jul-to-slf4j</artifactId>
                        <version>1.7.2</version>
                    </dependency>
                    <dependency>
                        <groupId>ch.qos.logback</groupId>
                        <artifactId>logback-classic</artifactId>
                        <version>1.0.7</version>
                    </dependency>
                    <dependency>
                        <groupId>ch.qos.logback</groupId>
                        <artifactId>logback-core</artifactId>
                        <version>1.0.7</version>
                    </dependency>
                </extraDependencies>
            </configuration>
        </plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-05T09:24:37.187

我的解决方案是，

```
 String logBackfile  ="....."; //the logback config
            LoggerContext lc = new LoggerContext();

            JoranConfigurator configurator = new JoranConfigurator();  
            configurator.setContext(lc);  
            lc.reset();  
            configurator.doConfigure(logBackfile);
            StatusPrinter.printInCaseOfErrorsOrWarnings(lc); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-31T16:41:27.840

嵌入式 Tomcat Maven 的日志记录配置目前因错误而损坏

[https://issues.apache.org/jira/browse/MTOMCAT-127](https://issues.apache.org/jira/browse/MTOMCAT-127)

解决方法是简单地重定向标准输出，例如：

```
mvn tomcat7:run 2>&1 | tee catalina.out 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-31T20:20:04.887

这只是部分答案，但我让它像这样工作，我的应用程序包含自己的 logback 依赖项（无需声明 extraDependencies）。

这里唯一需要注意的是，当我的应用程序中存在较低级别的错误时（在应用程序加载和/或其他之前），我仍然无法获得所需的 Tomcat catalina.log 输出。使用这种配置，我只得到我的应用程序级别的日志文件（不是我真正想要的 logs/catalina.out）：

```
<plugin>
    <groupId>org.apache.tomcat.maven</groupId>
    <artifactId>tomcat7-maven-plugin</artifactId>
    <version>2.2</version><!-- Tomcat 7.0.47 -->
    <configuration>
        <port>9090</port>
        <path>/${project.artifactId}</path>
        <systemProperties>
            <spring.profiles.active>webService</spring.profiles.active>
            <java.util.logging.config.file>src/integration-test/resources/logback.xml</java.util.logging.config.file>
        </systemProperties>
    </configuration>
    <executions>
        <execution>
            <id>tomcat-run</id>
            <goals>
                <goal>run-war-only</goal>
            </goals>
            <phase>pre-integration-test</phase>
            <configuration>
                <fork>true</fork>
            </configuration>
        </execution>
        <execution>
            <id>tomcat-shutdown</id>
            <goals>
                <goal>shutdown</goal>
            </goals>
            <phase>post-integration-test</phase>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-10-21T19:04:58.743

尝试使用

```
 <tomcatLoggingFile>log.txt</tomcatLoggingFile> 
```

在配置部分。

# javascript - jQuery textarea自动增长，直到行尾/输入才增长

> ID：10727397
> 
> 赞同：3
> 
> 时间：2012-05-23T20:32:53.313
> 
> 标签：javascript, jquery, textarea

有很多关于自动扩展文本区域的主题。仍然没有找到一个我会称之为“完美”的人。我需要的一件事似乎无法解决，一旦用户开始打字，它们就会开始增长。我一直在尝试自己解决这个问题，但没有运气。我不希望文本区域在到达行尾或按下 Enter 之后展开。

[http://jsfiddle.net/mstefanko/Jrpqg/65/](http://jsfiddle.net/mstefanko/Jrpqg/65/)

谢谢！

更新答案：

对于我的情况，我不仅希望文本区域仅在下一行/输入时才扩展。还要缩小没有文字。一个快速的解决方案，除了提供的答案之外，如果 textarea 是空的，我也可以运行 css 高度线。擦除时不会缩小，但至少在擦除所有文本后它会重置高度。

```
 if ($.trim($(this).val()) == "") {
            $(this).css('height', Math.max(shadow.height() + 20, minHeight));
        }
        if(this.scrollHeight  > $this.height()) {
            $(this).css('height', Math.max(shadow.height() + 20, minHeight));
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:55:54.030

添加以下 if 语句：

```
if(this.scrollHeight  > $this.height()) {
    $(this).css('height', Math.max(shadow.height() + 20, minHeight));
} else if($this.height() < shadow.height() + 20) {
    $(this).css('height', Math.max(shadow.height() + 20, minHeight));
} 
```

可能会起作用，或者可能需要更多的按摩才能使其起作用，以按照评论中的要求减小尺寸。

# android - ActionBarImpl 只能与兼容的窗口装饰布局一起使用

> ID：10727399
> 
> 赞同：2
> 
> 时间：2012-05-23T20:32:57.483
> 
> 标签：android, admob

我收到了：

```
ActionBarImpl can only be used with a compatible window decor layout 
```

来自谷歌崩溃报告。奇怪的事实是：我不使用 ActivoBar。事实上，我的应用程序是为 android 2.2 及更高版本编写的。由于 admob 我必须添加

安卓：targetSdkVersion=13

在此之后我不得不添加“android-support-v4.jar”，因为

```
android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" 
```

程序在我的设备和模拟器上运行良好，但在市场发布后： - 400 份关于崩溃的报告。/大约 90% 的应用程序更新/

热点解决问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-11T16:47:08.477

你必须像下面这样设置父属性

```
<style name="myTheme" parent="@android:Theme.Dialog"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T21:16:17.590

嗯。问题是由不同的对话框布局产生的 - 在 android ver 2.2 和 3.2 及更高版本中。进度条的自定义对话框样式产生崩溃。原因是风格上的父属性错误。奇怪但事实。

# objective-c - 防止未使用的符号被剥离

> ID：10727408
> 
> 赞同：5
> 
> 时间：2012-05-23T20:33:27.853
> 
> 标签：objective-c, c, xcode, lldb

我用 C 语言编写了一个函数，我想在调试器中使用它来向 javascript 引擎发送命令。由于此函数未直接在代码中使用，因此链接器会删除此符号。有没有办法将特定功能标记为不被剥离？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T19:53:47.890

找到了！

[http://disanji.net/iOS_Doc/#documentation/DeveloperTools/Conceptual/XcodeBuildSystem/500-Linking/bs_linking.html](http://disanji.net/iOS_Doc/#documentation/DeveloperTools/Conceptual/XcodeBuildSystem/500-Linking/bs_linking.html)

声明应该有

```
__attribute__((used)) 
```

# perl - Perl Net::SMTP::TLS 与代理

> ID：10727413
> 
> 赞同：1
> 
> 时间：2012-05-23T20:33:40.807
> 
> 标签：perl, proxy, smtp

有没有办法通过代理连接到 SMTP 服务器？

我正在使用 Net::SMTP::TLS 模块进行连接：

```
$mailer = new Net::SMTP::TLS(
        'smtp.gmail.com',
        Hello   =>      'smtp.gmail.com',
        Port    =>      587,
        User    =>      $username,
        Password=>      $password); 
```

# c++ - 如果调用某些函数，我可以强制编译器错误吗？

> ID：10727418
> 
> 赞同：14
> 
> 时间：2012-05-23T20:33:47.297
> 
> 标签：c++, visual-studio-2010, visual-c++, compiler-errors, compiler-warnings

我的软件有 v1 和 v2 版本。v1 使用注册表来保存设置，对 GetProfileInt 等进行大量调用。v2 现在使用 sqlite db 来保存设置。

我们目前正在开发两个分支，并将新功能从 v1 合并到 v2 分支。我们目前必须记住更新任何注册表调用以使用新的配置数据库，这已经被错过了几次。

如果在 v2 中使用了任何 GetProfile... 或 WriteProfile... 函数，我想要的是引发编译器错误。

我们在 Visual Studio 2010 中使用 C++。如果没有内置任何内容，我可以使用脚本的输出以某种方式引发编译器错误吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T20:43:54.400

由于这个答案被接受，我不妨包括提问者实际使用的解决方案：

jacobsee 发现了[已弃用的编译指示](http://msdn.microsoft.com/en-us/library/c8xdzzhh(v=vs.80).aspx)

```
#pragma deprecated(GetProfileInt) 
```

* * *

### 原答案：

您可以使用 . 将它们声明为已弃用`__declspec(deprecated)`。它看起来像这样：

```
UINT __declspec(deprecated) WINAPI GetProfileInt(
  __in  LPCTSTR lpAppName,
  __in  LPCTSTR lpKeyName,
  __in  INT nDefault
); 
```

您必须从包含在您关心的每个翻译单元中的标题中执行此操作。这样做会在任何时候包含已弃用声明的翻译单元使用该函数时发出警告。

如果您想要编译器错误并且您的项目尚未将警告视为错误，那么您必须打开它，并且可能修复您一直忽略的所有警告。（无论您是否使用此解决方案，这些都是很好的做法。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:39:51.940

将我的评论推广到答案：

您可以使用宏将它们重新定义为无法编译的内容：

```
#define GetProfile  HAHA_Nice_try_This_will_not_compile!!! 
```

问题是您需要确保它不会（合法地）在您的代码之外被调用。
（所以你应该把宏放在所有包含之后。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-09T22:22:58.670

接受的答案是将函数标记为已弃用，但这并不真正符合问题的要求，原因有两个：

*   它只给出警告，而不是错误。
*   即使您使用的是 v1 代码，它也会发出警告。

有充分的理由想要这样做，但这实际上并不是最初的问题所要求的。

幸运的是，有一种非常简单的方法可以获取问题的要求。如果函数根本不存在，编译器总是会抛出错误。只需将函数放入`#ifndef`.

```
#ifndef V2

void GetProfile()
{
  // Get the profile
}

void WriteProfile()
{
  // Write the profile
}

#endif 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-12-15T10:46:22.397

如果您可以自由地将函数转换为模板，则可以执行以下操作：

```
template <typename...>
struct always_false { static constexpr bool value = false; };

template <typename... Ts>
void never_call_me(Ts&&...)
{
  static_assert(always_false<Ts...>::value,
                "You should have never called this function!");
} 
```

这样做的好处是编译错误将是干净的+您可以提供错误消息。[在此处找到](https://stackoverflow.com/a/34746077/678022)，请参阅该答案以获取有关为什么有效+为什么`always_false`需要的更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T20:38:32.313

如果您有一个常见的#include 文件，您可以向其中添加类似的内容（使用`W`或`A`酌情）。它至少会导致链接器错误（编译器警告/错误将取决于标志）：

```
#define GetProfileIntA InvalidFunctionDoNotCallMe 
```

Windows 已经为 A 或 W 版本定义了`GetProfileInt`宏等功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T20:43:56.167

我相信你可以`#define GetProfileInt(a, b, c) "don't use this";`在`#include`'ing之后`Windows.h`。

由于`GetProfileInt`是用于路由到正确功能的宏，因此这将导致宏重新定义。并且由于`char[]`不能分配给`UINT`, 编译器`error`的 .

这是一个肮脏，肮脏的黑客，但我想洗个澡来讨论它。

# sql-server - 通过连接结果传递给 xml 值方法的参数

> ID：10727422
> 
> 赞同：0
> 
> 时间：2012-05-23T20:34:29.917
> 
> 标签：sql-server, tsql, sqlxml

我正在粉碎视图中的 xml 列，并从该列中提取信息。我的视图当前正在 local-name((/*)[1] 上运行大型 CASE 语句以获取 XML 中根节点的名称，然后我正在钻入 xml 以根据 CASE 获取特定值.

例如

```
CASE xdata.value('local-name((/*)[1])', 'sysname')
WHEN 'Person' THEN xdata.value('(/*/PersonGuid/Personnel/@UserName)[1]', 'varchar(50)')
WHEN 'Component' THEN xdata.value('(/*/ComponentGuid/Component/@Number)[1]', 'varchar(50)')
END 
```

这个案例陈述非常庞大且笨拙。

我试图做的是在 CTE 中构建一个字典，其中包含我在 CASE 中评估的项目，然后是我想提供给 XML value 方法的参数值。例如，对于上面的示例，CTE 字典将包含以下内容（并且 CTE 正确连接到主外部查询中）：

```
;WITH CTE_Selector (TableName, Selector) AS
(
SELECT 'Person', '(/*/PersonGuid/Personnel/@UserName)[1]'
UNION SELECT 'Component' ,'(/*/ComponentGuid/Component/@Number)[1]'
) 
```

当我尝试在我的视图中使用 CTE 来避免 case 语句时，例如：

```
, xdata.value(CTE_Selector.Selector, 'varchar(50)') 
```

我收到以下错误： **XML 数据类型方法“查询”的参数 1 必须是字符串文字。**

所以简而言之，XML value 方法似乎需要一个常量字符串。有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:40:50.447

您不能使用列或变量来代替 XQuery 表达式。您可以在 XQuery 表达式中使用列或变量，但我认为在这种情况下这对您没有多大帮助。

[sql:column()](http://msdn.microsoft.com/en-us/library/ms191214)
[sql:变量()](http://msdn.microsoft.com/en-us/library/ms188254)

您只能使用一次调用 . `value()`像这样。

```
xdata.value('(
              /Person/PersonGuid/Personnel/@UserName,
              /Component/ComponentGuid/Component/@Number
             )[1]', 'varchar(50)') 
```

# java - 在基于文本的刽子手游戏中打印字母

> ID：10727427
> 
> 赞同：0
> 
> 时间：2012-05-23T20:34:59.100
> 
> 标签：java, arrays, text

所以我正在尝试制作一个刽子手游戏，它从单词文件中生成一个随机单词，向用户询问一个字母，然后遍历该单词并在它出现的地方打印字母或打印一个“_”。我知道我的“抱歉没有找到匹配项”现在是不正确的，但是当我打印这个单词时，我无法将最后一个正确的字母保持在适当的位置

```
 import java.util.Scanner;
    import java.util.Random;
    import java.io.*;
    public class hangman

    {
public static void main(String args[])
{

    Scanner hangman = null; 

    try 
    {
        // Create a scanner to read the file, file name is parameter
            hangman = new Scanner (new File("C:\\Users\\Phil\\Desktop\\hangman.txt"));
        } 
    catch (FileNotFoundException e) 
        {
        System.out.println ("File not found!");
        // Stop program if no file found
        System.exit (0);
        }

    String[] list = new String[100];
    int x = 0;

    while(hangman.hasNext())
    {
        list[x] = hangman.nextLine();
        x++;
    }

    Random randWord = new Random();
    String word = "";
    int wordNum = 0;
    boolean stillPlaying = true;

    wordNum = randWord.nextInt(12);
    word = list[wordNum];
    System.out.println("The word has "+word.length()+" letters");

    Scanner letter = new Scanner(System.in);
    String guess = "";

    while(stillPlaying = true)
    {           

        System.out.println("Guess a letter a-z");
        guess = letter.nextLine();
        for(int y = 0; y<word.length(); y++)
        {
            if(word.contains(guess))
            {
                if(guess.equals(word.substring(y,y+1)))
                {
                    System.out.print(guess+" ");
                }
                else
                    System.out.print("_ ");
            }
            else
            {
                System.out.println("Sorry, no matches found");
            }
        }
    }

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:43:23.237

你可能喜欢一个加法数组。即你的 char 数组是 100 个字符长，所以你可以让另一个数组长 100 个项目。第二个数组可以包含 0 和 1。最初将其全部设置为 0，如果位置 array2[x] 中的字母被猜到，则将值设置为 1。这将允许您在第二个数组上使用 for 循环，

```
 for (int i = 0; i < sizeof(array2); i++){
     if (array2[i] == 0)
          print "_";
     else 
          print stringArray[i]
} 
```

上面可能不是正确的代码，但想法应该存在，您只需使用另一个相同大小的数组来跟踪字母，看看它们是被猜到还是未被猜到（1 或 0）。我希望这有帮助

抱歉，这个解决方案是用 C 语言编写的，我没有看到导入，也没有标记我的第一次阅读。

array2 只是一个整数数组，您可以访问类似于字符串数组的元素。

```
for(int i = 0; i < finalString.length; i++){
    if (array2[i] == 0){
        copy "_" to finalString position i;
    }
    else {
        copy stringArray position i to finalString position i;
    }

}
Now you can print finalString and it should show the proper string with _ and letters! 
```

# c# - 如何处理多语言界面？

> ID：10727428
> 
> 赞同：1
> 
> 时间：2012-05-23T20:35:03.863
> 
> 标签：c#, wpf, localization, globalization

我面临的问题主要是控件中的多语言文本占用了多少空间。

这是一个例子。

英语：

![在此处输入图像描述](../Images/6b3c61cccee4ac466e5d70e1063568c9.png)

德语：

![在此处输入图像描述](../Images/886b590829313d33bdb2f81cd2aad5ab.png)

如您所见，德语版本中的文本在控件中跟随，使我的界面无法使用。

注意，这些被输入到标签控件中。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T20:44:58.603

添加这个作为答案，因为我很确定这是你的问题：

不要使用静态布局尺寸，即：

**坏的**

```
Width="500" 
```

**好的**

```
Width="2*"
Width="50%"
Width="Auto" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:50:39.910

是的，你需要期待长字符串。早期测试（即在开发过程中）很重要。

[伪定位](http://en.wikipedia.org/wiki/Pseudo_localization)是在过程早期处理它的有用技术。即，您的“伪定位”文化文本将是“[!!! εNetwork usageğ§ !!!]”，您会很快看到这个布局问题。

通常需要灵活的布局和通常为字符串提供更多空间来容纳国际字符串。

# python - 生产环境中的 django 和 mysql 设置

> ID：10727429
> 
> 赞同：0
> 
> 时间：2012-05-23T20:35:06.873
> 
> 标签：python, mysql, django, mysql-python

我正在尝试在我的生产服务器（Ubuntu 12.04）上设置 mysql。我按照本教程[http://www.saltycrane.com/blog/2008/07/how-set-django-mysql-ubuntu-hardy/](http://www.saltycrane.com/blog/2008/07/how-set-django-mysql-ubuntu-hardy/)然后我运行`python manage.py syncdb`它显示此错误[https://gist.github.com/2777611](https://gist.github.com/2777611)

我还检查了这个[获取“加载 MySQLdb 模块时出错：没有名为 MySQLdb 的模块” - 尝试过以前发布的解决方案](https://stackoverflow.com/questions/2952187/getting-error-loading-mysqldb-module-no-module-named-mysqldb-have-tried-pre)然后我尝试运行`pip install MySQL-python`但没有用，这显示了这个错误[https://gist.github.com/2777629](https://gist.github.com/2777629)

谁能告诉我这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:48:26.677

您可以安装 Ubuntu 存储库中包含的 python MySQL 库：

```
sudo apt-get install python-mysqldb 
```

（在这种情况下你不需要这样做`pip install MySQL-python`）

或者您可以安装 MySQL 开发库，然后尝试该`pip install MySQL-python`技术：

```
sudo apt-get install libmysqlclient-dev 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-16T21:50:36.653

dgel 已经回答了，但我想添加一些东西，这样对初学者来说很容易。起初我建议设置 virtualenv。

然后如果你是 python 2.7 安装

```
pip install mysql-python 
```

或者如果您使用的是 python 3.x

```
pip install mysqlclient 
```

# .htaccess - 如何重写 url 以忽略子目录？

> ID：10727431
> 
> 赞同：0
> 
> 时间：2012-05-23T20:35:21.097
> 
> 标签：.htaccess, mod-rewrite

我有这个网址：

[http://www.example.com/some-annoying-folder/page.html?name=stack+overflow](http://www.example.com/some-annoying-folder/page.html?name=stack+overflow)

但该文件实际上位于根目录中，应如下所示：

[http://www.example.com/page.html?name=stack+overflow](http://www.example.com/page.html?name=stack+overflow)

此外，还有类似的子目录也需要修改。

尽管我使用 htaccess，但我仍然很难适应它。

在此先感谢您的帮助！

更新：

```
RewriteEngine On
Options +FollowSymLinks

RewriteRule .*(schedule.html|tickets.html|venue.html|city.html|concerts.html)$ $1 [L,R=302,QSA,NC]

#BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
#END WordPress 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:07:50.223

给定 OP 的额外输入 - 假设 page1.html 和 page2.html 是两个文件，它们前面有不存在的目录。此规则将解决：

```
RewriteRule .*(page1.html|page2.html)$ $1 [L,R=302,QSA,NC] 
```

如果你有更多这样的文件，你可以简单地将它们添加到上面，用`|`上面的分隔符分隔。

**使用更多信息**编辑修改的规则：****

 **```
RewriteRule .+/(schedule.html|tickets.html|venue.html|city.html|concerts.html)$ $1 [L,R=302,QSA,NC] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:41:06.150

这应该适用于 Apache：

```
RedirectMatch 301 ^/subfolder/$ http://www.example.com/ 
```**

# c# - 返回用户所属的所有 Active Directory 应用程序组的列表

> ID：10727436
> 
> 赞同：1
> 
> 时间：2012-05-23T20:35:52.347
> 
> 标签：c#, .net, windows, active-directory

我想列出用户所属的所有 Active Directory 应用程序组。但我一无所获。

谢谢你的建议。

```
public List<string> GetGroups(string strUserName)
{
        DirectoryEntry objADAM = default(DirectoryEntry);
        // Binding object.          
        DirectoryEntry objGroupEntry = default(DirectoryEntry);
        // Group Results.
        DirectorySearcher objSearchADAM = default(DirectorySearcher);
        // Search object.
        SearchResultCollection objSearchResults = default(SearchResultCollection);
        // Results collection.
        string strPath = null;
        // Binding path.
        List<string> result = new List<string>();
        // Construct the binding string.
        strPath = "LDAP://CHCAD.abc/DC=abc";
        //Change to your ADserver 
        // Get the AD LDS object.
        try
        {
            objADAM = new DirectoryEntry(strPath);
            objADAM.RefreshCache();
        }
        catch (Exception e)
        {
            throw e;
        }
        // Get search object, specify filter and scope,
        // perform search.  
        try
        {
            objSearchADAM = new DirectorySearcher(objADAM);
            objSearchADAM.Filter = "(&(objectClass=group)(samaccountname=" + strUserName + "))";
            objSearchADAM.SearchScope = SearchScope.Subtree;
            objSearchResults = objSearchADAM.FindAll();
        }
        catch (Exception e)
        {
            throw e;
        }
        // Enumerate groups 
        try
        {
            if (objSearchResults.Count != 0)
            {
                foreach (SearchResult objResult in objSearchResults)
                {
                    objGroupEntry = objResult.GetDirectoryEntry();
                    result.Add(objGroupEntry.Name);
                }
            }
            else
            {
                throw new Exception("No groups found");
            }
        }
        catch (Exception e)
        {
            throw new Exception(e.Message);
        }
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T20:43:16.153

如果您使用的是 .NET 3.5 及更高版本，则应查看`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

基本上，您可以定义域上下文并在 AD 中轻松找到用户和/或组：

```
// set up domain context
PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

// find a user - this will search for DN and samAccountName and display name and a few more
UserPrincipal user = UserPrincipal.FindByIdentity(ctx, strUserName);

if(user != null)
{
   // if user is found - get the groups that user belongs to
   PrincipalSearchResult<Principal> authGroups = user.GetAuthorizationGroups();

   List<string> groupNames = new List<string>();

   foreach(Principal group in authGroups)
   {
      // do something with the groups - like add their name to a List<string>
      groupNames.Add(group.Name);  
   }
} 
```

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！

**PS：**否则，如果您无法切换到 S.DS.AM，您应该查看我对另一个处理相同问题的[StackOverflow 问题的回答。](https://stackoverflow.com/questions/1264028/directoryentry-invokegroups-null-not-retrieving-all-groups)基本上只需检查对象的`memberOf`属性`DirectoryEntry`。

# python - 用于调用函数的 Python 管道字符

> ID：10727439
> 
> 赞同：1
> 
> 时间：2012-05-23T20:36:22.000
> 
> 标签：python, pygame, arguments, bitwise-or

只是一个简单的问题。

我见过的一些python函数是这样调用的，例如pygame：

`pygame.display.set_mode((255, 255), FULLSCREEN)`这对我来说似乎很正常。

但是当你想使用多个参数时，你必须使用 |。例如： `pygame.display.set_mode((255, 255), FULLSCREEN | HWSURFACE | DOUBLEBUF)`

您何时以及为什么想要这种电话？我听说它是​​按位 OR 运算符，但似乎仅适用于布尔值。这是如何运作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:42:41.020

它们是不同选项的标志。每个标志只是一个数字，特别是 2 的幂。您使用按位运算符`|`翻转所有您想要的标志的位。一个例子可能会有所帮助：

```
>>> import re
>>> re.VERBOSE
64
>>> re.IGNORECASE
2
>>> re.VERBOSE | re.IGNORECASE
66 
```

所以如果`re`想知道`IGNORECASE`标志是否被设置，只需检查第二位（对于 2^1）是否等于 1。如果是，我们应该忽略大小写。如果它想知道是否是`VERBOSE`，它检查第 7 位（对于 2^6）。通过`or`将 2 和 64 组合在一起，您将得到一个第二位和第七位翻转的数字。

```
>>> 66 & 2
2
>>> 66 & 64
64
>>> 66 & 8
0 
```

我们可以看到 66 触发了 2 和 64 的标志，但不是 8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:52:55.503

*请注意按位 OR*运算符与*布尔 OR*运算符之间的区别：

`|`是按位或运算符，即按位对操作数进行或运算：

```
>>> 1 | 2
3 
```

那是因为 1 个二进制是`001`，2 个二进制是`010`，所以它们每比特的 OR 位是`011`，也就是 3。

`or`是布尔运算符。

```
>>> 1 or 2
1
>>> 0 or 2
2 
```

运算符返回第`or`一个有效值（ 非`0`、、`None`或）`[]``{}`

# c - 优化嵌套循环

> ID：10727440
> 
> 赞同：3
> 
> 时间：2012-05-23T20:36:23.873
> 
> 标签：c, optimization, openmp

我们有一个任务，我们得到了一个效率非常低的程序，我们必须优化代码以使其运行得更快。我已经让他们中的大多数人运行得非常快，除了这两个，这让我非常烦恼，因为它们是非常简单的功能。一种基本上将二维数组中的所有值设置为相同的值，另一种基本上交换两个二维数组的值。这就是问题所在。它们占用的时间最多，但由于它们非常简单，我无法弄清楚如何在不破坏功能的情况下减少它们。而且我知道让他们跑得更快是可能的，因为班上的其他学生已经获得了可笑的加速。有问题的两个是：

```
fSetArray(int rows, int cols, float val)
{
    int i, j;
    F2D *out;
    out = fMallocHandle(rows, cols);

    for(i=0; i<rows; i++)
    for(j=0; j<cols; j++)
        subsref(out,i,j) = val;

    return out;

} 
```

唯一重要的部分是那里的两个循环。基本上，我们有一个具有一定宽度（行）和一定高度（列）的二维数组，我们将所有值设置为 val。但是我看不到消除其中一个循环的方法（这将是加速它的最佳方法）。除非我遗漏了一些明显的东西。如果 cols 和 rows 是相同的数字，这会容易得多。

另一个功能是：

```
fDeepCopy(F2D* in)
{
    int i, j;
    F2D* out;
    int rows, cols;

    rows = in->height;
    cols = in->width;

    out = fMallocHandle(rows, cols);

    for(i=0; i<rows; i++)
    for(j=0; j<cols; j++)
        subsref(out,i,j) = subsref(in,i,j);

    return out;
} 
```

out 数组总是比 in 数组大，所以我们不必担心溢出等问题。这个函数基本上只是交换两个数组的值，但是再一次，因为它太简单了，我不能让它进一步减少。

在任何人说并行化之前，由于样本大小和服务器，创建线程所需的开销实际上会减慢程序的速度。我试过了。因为这两个函数太短了，所以不值得创建线程只在一次并行后杀死它们。

但是作为参考，从技术上讲，这是一个 OpenMP 项目，我们应该使用并行化，但是对于这两个功能，这样做实际上会减慢整个程序的速度。我已经用一个并行的 for 循环来检查它。

编辑：感谢所有给我想法的人！我现在已经启动并运行并全速运行！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:24:38.533

一种优化是循环展开。有时管道需要停止，因为围绕获取索引、更新索引以及将其存储回内存中存在大量活动。这可能是您的多线程实现做得不好的主要原因，所有线程*可能**都*在争夺对索引的访问权。

如果您想重新尝试多线程实现，请让每个线程根据线程数知道它的“偏移量”，并让每个线程处理通过模除法发现的不同余数

```
thread 0 works on i*rows+j % (thread count) = 0
thread 1 works on i*rows+j % (thread count) = 1
(and so on) 
```

如果您不想重新尝试多线程实现，仍然有一些技术可以提高性能。有时，即使是单个线程也会在索引变量上不必要地停顿（因为它会导致处理器管道的低效使用）。要尝试修复此类问题，请将索引增加一个特定数字并在循环中调用该方法次数。

```
fDeepCopy(F2D* in)
{
    int i, j;
    F2D* out;
    int rows, cols;

    rows = in->height;
    cols = in->width;

    out = fMallocHandle(rows, cols);

    for(i=0; i<rows; i++) {
      // rewrite to ensure we don't walk off "4 long" pads
      int j = 0;
      int pads = (cols / 4)*4;
      for(; j < pads; j = j + 4) {
        subsref(out,i,j) = subsref(in,i,j);
        subsref(out,i,j+1) = subsref(in,i,j+1);
        subsref(out,i,j+2) = subsref(in,i,j+2);
        subsref(out,i,j+3) = subsref(in,i,j+3);
      }
      // process the remainders
      for(; j < pads; j++) {
        subsref(out,i,j) = subsref(in,i,j);
      }
    }
    return out;
} 
```

现在 CPU 设计人员变得越来越好，因此您必须实际**分析**您的运行以确定 CPU 是否已经为您进行了此类优化，或者这种技术实际上可能会减慢您的代码速度。

最后，您还可以[利用 SSE 扩展](http://en.wikipedia.org/wiki/Streaming_SIMD_Extensions)，它在适当的条件下可以对存储在 MMX 寄存器中的多个值执行相同的操作。例如，您可以使用汇编内联将两组四个 32 位单精度浮点数打包到 MMX 寄存器中，并一次执行四个浮点的批量加法。

所以，看起来像

```
vec_res.x = v1.x + v2.x;
vec_res.y = v1.y + v2.y;
vec_res.z = v1.z + v2.z;
vec_res.w = v1.w + v2.w; 
```

这将需要八次内存查找、四次加法和四次存储（16 次未优化的操作）可能会替换为

```
movaps xmm0, [v1]          ;xmm0 = v1.w | v1.z | v1.y | v1.x 
addps xmm0, [v2]           ;xmm0 = v1.w+v2.w | v1.z+v2.z | v1.y+v2.y | v1.x+v2.x               
movaps [vec_res], xmm0 
```

只需要三个操作，未优化。

再次，关键是分析，因此您可以检测瓶颈，然后调整您的代码以使它们处于可接受的最低性能范围内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:49:09.987

`memset`应该对第一个功能有所帮助。

# linux - 如何在linux中使用iptables将http和https流量转发到透明代理

> ID：10727443
> 
> 赞同：12
> 
> 时间：2012-05-23T20:36:30.897
> 
> 标签：linux, firewall, iptables, gateway, transparentproxy

我有一个 Ubuntu linux 系统作为网关系统，上面有两个接口。一个接口用于本地网络，一个接口用于互联网。我能够毫无问题地通过它路由流量。我使用两条`iptables`规则从内部接口转发出站流量：

```
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface eth1 -j ACCEPT 
```

我现在需要创建一个`iptables`规则，过滤并重定向通过`eth1`接口离开我的网络的所有 tcp 端口 80 和 443 流量，并将其发送到驻留在 tcp 端口 9090 上的环回接口上的代理服务器。

我一直在搜索，但我找不到一个有效的例子。有没有一种有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T21:09:57.187

```
iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to 9090 
```

HTTPS 不能与透明代理一起使用。有一些技巧，但它没有任何意义并且没用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-07T16:45:08.863

```
iptables -t nat -A PREROUTING -i eth0 -s ! squid-box -p tcp --dport 80 -j DNAT --to squid-box:3128
iptables -t nat -A POSTROUTING -o eth0 -s local-network -d squid-box -j SNAT --to iptables-box
iptables -A FORWARD -s local-network -d squid-box -i eth0 -o eth0 -p tcp --dport 3128 -j ACCEPT 
```

在哪里：

*   **squid-box** : 你的 squid 服务器
*   **local-network**：您的网络（在我的情况下是 192.168.0.0/24）
*   **iptables-box**：您的 iptables 软件所在的位置（通常是网关，在我的情况下为 192.168.1.1）

第一个将数据包从 iptables-box 发送到 squid-box。第二个确保通过 iptables-box 将回复发送回，而不是直接发送给客户端（这非常重要！）。最后一个确保 iptables-box 将适当的数据包转发到 squid-box。它可能不需要。YMMV。请注意，我们指定了“-i eth0”，然后指定了“-o eth0”，分别代表输入接口 eth0 和输出接口 eth0。如果您的数据包在不同的接口上进出，您将需要相应地调整命令。

将这些命令添加到 /etc/rc.d/ 下的相应启动脚本中

来自：[http ://www.tldp.org/HOWTO/TransparentProxy-6.html](http://www.tldp.org/HOWTO/TransparentProxy-6.html)

# r - 在 Sweave 中使用 legend()：这是一个错误吗？

> ID：10727445
> 
> 赞同：3
> 
> 时间：2012-05-23T20:36:53.717
> 
> 标签：r, sweave

现在我正在学习 sweave 来写一个包小插曲。我正在使用传统的 R 图形。奇怪的是，我添加到一个可以正常工作的高级绘图中的图例，否则在我 Sweave 文件时不起作用。这是一个最小的例子：

```
 \documentclass{article}
 \begin{document}
 <<fig=TRUE>>=
 plot(0.5, 0.5, xlim = c(0,1), ylim = c(0,1))
 legend("bottomright", c("data", "summary", "curve", "conf. region"), 
      pch = c(2,1,NA,NA), lwd = c(NA,NA, 2,1))
 @
 \end{document} 
```

R 代码生成（在运行 R 版本 2.15 时）一个点和一个由两个点和两种不同类型的线组成的图例： ![正确的传说](../Images/084b70b90b85ce7c59d2c290e54a6871.png)

在 sweave 中无法生成图例，我只看到一个空框： ![没有传说](../Images/b1c86e00544161e7b0f8fca3f2220dfb.png)

这是一个sweave bug，还是我忽略了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:46:53.067

## 问题

这似乎是一个错误，但它是一个问题，`pdf()`而不是它`Sweave()`本身。

要了解我的意思，请尝试调用`pdf()`. 它产生与上面显示的相同的缺陷图：

```
pdf("pdfPlot.pdf")
    plot(0.5, 0.5, xlim = c(0,1), ylim = c(0,1))
    legend("bottomright", c("data", "summary", "curve", "conf. region"), 
         pch = c(2,1,NA,NA), lwd = c(NA,NA, 2,1))
dev.off() 
```

相比之下，`cairo_pdf()`生成的图看起来还不错：

```
cairo_pdf("cairo_pdfPlot.pdf")
    plot(0.5, 0.5, xlim = c(0,1), ylim = c(0,1))
    legend("bottomright", c("data", "summary", "curve", "conf. region"), 
         pch = c(2,1,NA,NA), lwd = c(NA,NA, 2,1))
dev.off() 
```

## 解决方案1：使用knitr。

如果您愿意切换到`knitr`，则修复此问题很容易。只需添加`dev="cairo_pdf"` 到您的代码块标头（如果您愿意，可以删除`fig=TRUE`），如下所示：

```
<<dev="cairo_pdf">>=
...
...
@ 
```

处理代码就像`library(knitr); knit("myScript.Rnw")`代替当前调用一样简单`Sweave("myScript.Rnw")`

## 解决方案 2：构建您自己的对 \includegraphics{} 的调用。

如果你必须坚持`Sweave()`，做这样的事情会让你解决这个问题：

```
<<results=tex, term=FALSE, echo=FALSE>>=
cairo_pdf("myPlot.pdf", width=5)
    plot(0.5, 0.5, xlim = c(0,1), ylim = c(0,1))
    legend("bottomright", c("data", "summary", "curve", "conf. region"),
         pch = c(2,1,NA,NA), lwd = c(NA,NA, 2,1))
dev.off()
cat("\\includegraphics{myPlot.pdf}\n\n")
@ 
```

# python - macports 使用 python 安装

> ID：10727447
> 
> 赞同：0
> 
> 时间：2012-05-23T20:36:57.803
> 
> 标签：python, macports

对不起，我敢肯定这是一个愚蠢的问题。

我已经成功安装了带有 macports 的 python 2.6。如何使用该版本的python？当我在 term 中键入 python 时显示的版本是 python 2.7。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:43:12.340

使用端口选择命令选择它

1.  列出可供选择的可用 python：

    ```
    port select --list python 
    ```

2.  选择特定端口（例如 python26）：

    ```
    port select python python26 
    ```

但是 python2.6 也会选择特定版本的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:38:01.550

您应该在[Super User](https://superuser.com/)上。

从终端调用它：

python26 Python文件.py

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-23T20:42:36.183

在 Mac 上查找 Python 的一种方法是在命令行中输入：

> 哪条蟒蛇

当我输入这个时，我得到：

> /usr/bin/python

您可以通过键入查看其他蟒蛇

> ls /usr/bin/python*

例如，我看到：

> /usr/bin/python
> 
> /usr/bin/python2.7
> 
> /usr/bin/python-config
> 
> /usr/bin/python2.7-config
> 
> /usr/bin/python2.5
> 
> /usr/bin/pythonw
> 
> /usr/bin/python2.5-config
> 
> /usr/bin/pythonw2.5
> 
> /usr/bin/python2.6
> 
> /usr/bin/pythonw2.6
> 
> /usr/bin/python2.6-config
> 
> /usr/bin/pythonw2.7

然后，您可以通过键入运行 v2.6

> /usr/bin/python2.6

或者，由于 /usr/bin/ 可能在您的路径中，只需：

> python2.6

抱歉，这不完全是 MacPorts 特有的。

# salesforce - Apex - 销售人员 - 使用 apex 保存和检索字段

> ID：10727452
> 
> 赞同：2
> 
> 时间：2012-05-23T20:37:37.437
> 
> 标签：salesforce, apex-code

我只想问是否有开发人员知道如何在字段中保存记录；然后通过视觉的力量找回它。

**场景：**我在自定义对象中有一些字段已在顶点类中更新，即如果我 System.Debug 那些字段，它会向我显示一些值。具体而言，每个帐户的这些值都不同。

**问题：**问题是我可以访问该类中字段的值；但是当我在工作台或 force.com 资源管理器中编写 SOQL 以通过特定帐户 ID 查看自定义对象中的字段值时，它不会显示结果。所以我希望能够将结果保存在字段中，然后使用 SOQL 访问它们。保存它们的全部目的是让我可以使用视觉力进行查询并显示它们。

**我尝试过的：**我尝试创建自定义对象的新实例，然后使用 put 方法保存值，但这不起作用。

```
Abc__c abc = new Abc__c();
abc.account_id__c = Account.id;

abc.Number = 20; 
System.Debug(abc); 
```

这打印出 20。但是当我去工作台时，它没有！任何形式的帮助都非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T20:51:34.910

您需要调用 update 以便将行发送回数据库，例如

```
Abc__c abc = new Abc__c(Id='someExistingRecordId');
abc.account_id__c = Account.id;
abc.Number = 20; 
update abc; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-15T06:28:46.853

除了触发事件之前，您需要执行 DML 操作以反映数据库中的更改。对于触发前你不需要做DML，你可以将值分配给特定的字段，触发前会更新数据库中的值

# python - sqlalchemy：联合查询多个表中的几列有条件

> ID：10727453
> 
> 赞同：1
> 
> 时间：2012-05-23T20:37:39.487
> 
> 标签：python, mysql, sqlalchemy

我正在尝试使 MySQLdb 应用程序的某些部分适应声明性基础中的 sqlalchemy。我只是从 sqlalchemy 开始。

遗留表的定义如下：

```
student: id_number*, semester*, stateid, condition, ...
choice: id_number*, semester*, choice_id, school, program, ...
```

我们每个人都有 3 个表（`student_tmp`, `student_year`, `student_summer`, `choice_tmp`, `choice_year`, `choice_summer`），所以每对（`_tmp`, `_year`, `_summer`）都包含特定时刻的信息。

```
select *
from `student_tmp`
    inner join `choice_tmp` using (`id_number`, `semester`)
```

我的问题是对我来说重要的信息是获得与以下选择等效的信息：

```
SELECT t.*
FROM (
        (
            SELECT st.*, ct.*
            FROM `student_tmp` AS st
                INNER JOIN `choice_tmp` as ct USING (`id_number`, `semester`)
            WHERE (ct.`choice_id` = IF(right(ct.`semester`, 1)='1', '3', '4'))
                AND (st.`condition` = 'A')
        ) UNION (
            SELECT sy.*, cy.*
            FROM `student_year` AS sy
                INNER JOIN `choice_year` as cy USING (`id_number`, `semester`)
            WHERE (cy.`choice_id` = 4)
                AND (sy.`condition` = 'A')
        ) UNION (
            SELECT ss.*, cs.*
            FROM `student_summer` AS ss
                INNER JOIN `choice_summer` as cs USING (`id_number`, `semester`)
            WHERE (cs.`choice_id` = 3)
                AND (ss.`condition` = 'A')
        )
    ) as t
```

`*`用于缩短选择，但实际上我只查询 50 个可用列中的大约 7 列。

此信息有多种用途......“我有新学生吗？我还有给定日期的所有学生吗？在给定日期之后订阅了哪些学生？等等......”这个 select 语句的结果是保存在另一个数据库中。

我有可能通过一个类似视图的类来实现这一点吗？该信息是只读的，因此我不需要能够修改/创建/删除。还是我必须为每个表声明一个类（最终有 6 个类）并且每次我需要查询时，我必须记住过滤？

感谢指点。

*编辑*：我没有对数据库的修改访问权限（我无法创建视图）。两个数据库可能不在同一台服务器上（因此我无法在第二个数据库上创建视图）。

`condition`我担心的是在过滤和之前避免全表扫描`choice_id`。

*编辑 2*：我已经设置了这样的声明性类：

```
class BaseStudent(object):
    id_number = sqlalchemy.Column(sqlalchemy.String(7), primary_key=True)
    semester = sqlalchemy.Column(sqlalchemy.String(5), primary_key=True)
    unique_id_number = sqlalchemy.Column(sqlalchemy.String(7))
    stateid = sqlalchemy.Column(sqlalchemy.String(12))
    condition = sqlalchemy.Column(sqlalchemy.String(3))

class Student(BaseStudent, Base):
    __tablename__ = 'student'

    choices = orm.relationship('Choice', backref='student')

#class StudentYear(BaseStudent, Base):...
#class StudentSummer(BaseStudent, Base):...

class BaseChoice(object):
    id_number = sqlalchemy.Column(sqlalchemy.String(7), primary_key=True)
    semester = sqlalchemy.Column(sqlalchemy.String(5), primary_key=True)
    choice_id = sqlalchemy.Column(sqlalchemy.String(1))
    school = sqlalchemy.Column(sqlalchemy.String(2))
    program = sqlalchemy.Column(sqlalchemy.String(5))

class Choice(BaseChoice, Base):
    __tablename__ = 'choice'

    __table_args__ = (
            sqlalchemy.ForeignKeyConstraint(['id_number', 'semester',],
                [Student.id_number, Student.semester,]),
            )

#class ChoiceYear(BaseChoice, Base): ...
#class ChoiceSummer(BaseChoice, Base): ... 
```

现在，为一组表提供正确 SQL 的查询是：

```
q = session.query(StudentYear, ChoiceYear) \
            .select_from(StudentYear) \
            .join(ChoiceYear) \
            .filter(StudentYear.condition=='A') \
            .filter(ChoiceYear.choice_id=='4')
```

但它抛出一个异常......

```
"Could not locate column in row for column '%s'" % key)
sqlalchemy.exc.NoSuchColumnError: "Could not locate column in row for column '*'"
```

如何使用该查询为自己创建一个可以使用的类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:27:23.080

如果您可以在数据库上创建此视图，那么您只需将视图映射为表即可。请参阅[反射视图](http://docs.sqlalchemy.org/en/rel_0_7/core/schema.html#reflecting-views)。

```
# DB VIEW
CREATE VIEW my_view AS -- @todo: your select statements here

# SA
my_view = Table('my_view', metadata, autoload=True)
# define view object
class ViewObject(object):
    def __repr__(self):
        return "ViewObject %s" % str((self.id_number, self.semester,))
# map the view to the object
view_mapper = mapper(ViewObject, my_view)

# query the view
q = session.query(ViewObject)
for _ in q:
    print _ 
```

如果您无法`VIEW`在数据库级别创建一个，您可以创建一个可选择的并将其映射`ViewObject`到它。下面的代码应该给你的想法：

```
student_tmp = Table('student_tmp', metadata, autoload=True)
choice_tmp = Table('choice_tmp', metadata, autoload=True)
# your SELECT part with the columns you need
qry = select([student_tmp.c.id_number, student_tmp.c.semester, student_tmp.stateid, choice_tmp.school])
# your INNER JOIN condition
qry = qry.where(student_tmp.c.id_number == choice_tmp.c.id_number).where(student_tmp.c.semester == choice_tmp.c.semester)
# other WHERE clauses
qry = qry.where(student_tmp.c.condition == 'A') 
```

您可以像这样创建 3 个查询，然后将它们与[union_all](http://docs.sqlalchemy.org/en/rel_0_7/core/expression_api.html#sqlalchemy.sql.expression.union_all)组合并在映射器中使用生成的查询：

```
view_mapper = mapper(ViewObject, my_combined_qry) 
```

在这两种情况下，您都必须确保在视图上正确定义了 PrimaryKey，并且您可能需要`override`自动加载视图，并明确指定主键（参见上面的链接）。否则，您将收到错误，或者可能无法从查询中获得正确的结果。

* * *

**对 EDIT-2 的回答：**

```
qry = (session.query(StudentYear, ChoiceYear).
        select_from(StudentYear).
        join(ChoiceYear).
        filter(StudentYear.condition == 'A').
        filter(ChoiceYear.choice_id == '4')
        ) 
```

结果将是元组对：`(Student, Choice)`.
但是如果你想为查询创建一个新的映射类，那么你可以像上面的示例一样创建一个可选择的类：

```
student_tmp = StudentTmp.__table__
choice_tmp = ChoiceTmp.__table__
.... (see sample code above) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T06:16:07.487

这是为了展示我最终做了什么，欢迎任何评论。

```
 class JoinedYear(Base):
    __table__ = sqlalchemy.select(
            [
                StudentYear.id_number,
                StudentYear.semester,
                StudentYear.stateid,
                ChoiceYear.school,
                ChoiceYear.program,
                ],
                from_obj=StudentYear.__table__.join(ChoiceYear.__table__),
                ) \
                .where(StudentYear.condition == 'A') \
                .where(ChoiceYear.choice_id == '4') \
                .alias('YearView')
```

我会从那里详细说明...

谢谢@van

# java - Hibernate 4.1.3 多租户空指针异常

> ID：10727458
> 
> 赞同：2
> 
> 时间：2012-05-23T20:38:10.023
> 
> 标签：java, hibernate

我在使用 hibernate 4.1.3 的新多租户功能时遇到了问题 我正在使用带有 JPA2 和 Hibernate 4.1.3 作为提供程序的 Glassfish 3.1。

这是我的persistence.xml

```
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="AuroraServicePU" transaction-type="JTA">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <jta-data-source>jdbc/sqlserver/Aurora</jta-data-source>
        <exclude-unlisted-classes>false</exclude-unlisted-classes>
        <properties>
            <property name="hibernate.show_sql" value="false"/>
            <property name="hibernate.default_batch_fetch_size" value="100"/>
            <property name="hibernate.cache.use_second_level_cache" value="false"/>
            <property name="hibernate.cache.use_query_cache" value="false"/>
            <property name="hibernate.tenant_identifier_resolver" value="org.dna.aurora.web.TenantResolver" />
            <property name="hibernate.multiTenancy" value="DISCRIMINATOR" />
        </properties>
    </persistence-unit>
</persistence> 
```

这是我尝试部署应用程序时遇到的异常。

> INFO：HCANN000001：Hibernate Commons Annotations {4.0.1.Final} INFO：HHH000412：Hibernate Core {4.1.3.Final} INFO：HHH000206：找不到hibernate.properties INFO：HHH000021：字节码提供程序名称：javassist INFO：HHH000204：处理PersistenceUnitInfo [名称：AuroraServicePU ...] 严重：调用类 org.glassfish.persistence.jpa.JPADeployer 准备方法时出现异常严重：准备应用程序时出现异常严重：日志消息为空。java.lang.NullPointerException at org.hibernate.engine.jdbc.internal.JdbcServicesImpl$MultiTenantConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcServicesImpl.java:260) at org.hibernate.engine.jdbc.internal.JdbcServicesImpl.configure(JdbcServicesImpl.java:117) at org.hibernate.service.internal.StandardServiceRegistryImpl。
> 
> 严重：准备应用程序时出现异常

更新：我再次阅读了文档并注意到这个重要的信息和平：

> 鉴别器与分区（鉴别器）方法相关。尝试使用此策略打开没有租户标识符的会话是错误的。这个策略在 Hibernate 4.0 和 4.1 中还没有实现。计划对 5.0 提供支持。

这真的意味着鉴别器策略现在不可用吗？也许这就是整个问题？

任何帮助都会很棒。谢谢你，伊多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:03:38.787

您尚未指定 Hibernate 应如何获取连接。您是否阅读过与此相关的文档？[http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e4583](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e4583)

And specifically: [http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e4658](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e4658) http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html_single/#d5e4702

# javascript - 我正在寻找一种智能方法来检查传递给函数的对象参数

> ID：10727459
> 
> 赞同：5
> 
> 时间：2012-05-23T20:38:10.273
> 
> 标签：javascript

我处于以下情况：

我必须检查传递给函数的对象参数是否有效：

示例：

```
function (opt) {
     if (opt && opt.key && opt.key2) {
         // make something
     }
} 
```

有没有更好的方法来进行这种检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:39:56.810

并不真地。

除非你可以使用`opt.pleaseReadMyMind()`;-)

不过，您可以创建一个方法来检查所有字段的值是否与 不同`null`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:40:35.897

这是最紧凑的方式。

最正确的方法是：

```
if( typeof opt !== "undefined" && typeof opt.key !== "undefined" && typeof opt.key2 !== "undefined") { 
```

但正如你所看到的那样，这是非常拗口的，并不是真正必要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:49:42.523

只需编写一个简单的测试例程来验证给定属性名称列表的对象：

```
// usage: testProps(object to test, [list, of, property, names])
// returns true if object contains all properties
function testProps(obj, props)
{
  if (obj === null)
    return false;

  var i;
  for (i=0; i<props.length; ++i) 
  {
    if (!(props[i] in obj)) 
      return false;
  }
  return true;
} 
```

然后在你的函数中：

```
if (!testProps(obj, ['key', 'key2'])
   return; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:42:16.903

是的，但如果你有很多钥匙要检查，而不仅仅是三个，那只会“更好”。像这样的东西：

```
function opt(opt) {
    for(var i = 0; i<3; i++) {
        if(typeof opt["key"+((i > 0) ? "" : i + 1))] === "undefined") {
            return;
        }
    }

    // create object
} 
```

如果`opt`未定义，它的所有键也将是，所以也有一个隐式检查。

您还可以定义要在数组中检查的变量名称，如下所示：

```
var propsToCheck = ["key", "key1", "key2"];

function(opt) {
    for(var i = 0, ii = propsToCheck.length; i<ii; i++) {
        if(typeof opt[propsToCheck[i]] === "undefined") {
            return;
        }

        // create object
    }
} 
```

并不是一个更好的解决方案，但如果您计划检查三个或四个以上的属性，它确实可以减少输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T20:49:27.367

你总是可以这样做：

```
function validate(o, args) {
    if (typeof(o) == 'object' && args instanceof Array) {
        for (var i = args.length - 1; i >= 0; --i) {
            if (typeof(o[args[i]]) === 'undefined') return false;
        }
        return true;
    } else {
        return false;
    }
}

function myFunction(obj) {
    if (validate(obj, ['foo', 'bar'])) {
        // Your code goes here.
    } else {
        // Object passed to the function did not validate.
    }
} 
```

这是给你的小提琴：http: [//jsfiddle.net/reL2g/](http://jsfiddle.net/reL2g/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T20:55:16.360

你所做的是有效的，但它确实有缺陷。

```
if (opt && opt.key && opt.key2) { 
```

如果`opt.key`有*错误*的值 [0,null,false, 等等]，此检查将失败

在这种情况下，您必须进行 typeof 检查以确保它不是未定义的。

```
if (opt && typeof opt.key !== "undefined" && opt.key2) { 
```

# html - 缩小以适应 div 包含更多元素？

> ID：10727462
> 
> 赞同：1
> 
> 时间：2012-05-23T20:38:35.590
> 
> 标签：html, css

基本问题是：如何在包含其他元素的同时缩小元素以适应元素？

目标是在（居中）图像上有一个（居中）菜单，其宽度和高度应与图像尺寸相关。所有这些都是响应式的，这意味着没有绝对尺寸！

这是示例代码：

```
<div id="menu">
    <img src="picture.jpg" />
    <div id="left">
        test1
    </div>
    <div id="right">
        test2
    </div>
</div> 
```

```
#menu{
position:relative;
display: table; /*tried inline-block as well */
text-align: center;
line-height: 1;
}

#menu img{
height: 90%;
position:relative;
}

#left{
width: 46%;
background-color: #ffcdcc;
float: left;
text-align: right;
}

#clear{
clear: both;
}

#right{
width: 46%;
background-color: #324344;
float: right;
text-align: left;
} 
```

这就是它应该看起来的样子：

```
____________________________________
|                                  |
|  ------------------------------  |
|  |                            |  |
|  |     p i c t u r e          |  |
|  |                            |  |
|  |                            |  |
|  |                            |  |
|  |                            |  |
|  |    left <button> right     |  |
|  |                            |  |
|  ------------------------------  |
|                                  |
------------------------------------ 
```

图片的高/宽比始终相同。它的总大小取决于用户窗口。

我只是不能让“菜单” div 环绕并且“左”和“右” div 可以同时定位。

这甚至可能吗？我什至还没有谈论浏览器兼容性...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:50:16.093

看看这是否有效：http: [//jsfiddle.net/sdvnh/1/](http://jsfiddle.net/sdvnh/1/)

变化：

```
#menu {
display: block;
}

#menu img{
height: 90%;
width: 90%;
} 
```

# c# - 在 C# 中将 24 位 BMP 转换为单色位

> ID：10727463
> 
> 赞同：0
> 
> 时间：2012-05-23T20:38:38.900
> 
> 标签：c#, image-processing

我将如何获取 24 位的 BMP 并将其转换为单色位图？我不担心失去颜色等，我不想使用其他文件格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:52:18.310

基本上有两种方法。您可以使用互操作方法读取原始 BMP 数据并为单色位图写入原始 BMP 数据。有谷歌搜索功能可以做到这一点。

或者，更好的是，您可以使用 ImageMagickObject 使用随机抖动转换图像。

做第二个。

如果你做第一个，你仍然应该使用随机抖动，但你必须手动实现它。

编辑：您问“以下 RGB 值会变成什么”……答案是它们变成了您希望它们变成的样子。你决定。

显而易见的选择是使用严格的阈值，其中小于 X 的任何东西都变成黑色，任何东西都变成白色，或者您可以使用随机抖动。选择两个阈值，黑色阈值`bt`和白色阈值`wt`，这样`0 < bt < wt < 255`。`q`然后为每个点选择一个0.0 之间的随机数。和 1.0。将像素亮度 ( `(r+g+b)/3`) 与 进行比较`(q*(wt-bt)+bt)`。如果大于或等于，则为白色，如果小于或等于黑色。这会给你一个很好的抖动灰度。对于大多数用途，31 和 224 是 bt 和 wt 的好值，但对于摄影图像，0 和 255 可能更好。

# asp.net - 如何将程序生成的 PDF 附加到电子邮件并发送？

> ID：10727464
> 
> 赞同：2
> 
> 时间：2012-05-23T20:38:42.687
> 
> 标签：asp.net, vb.net

我正在尝试读取一个 html 文件并使用 itexsharp 将其转换为 pdf 并通过电子邮件将其作为附件发送：

这是客户端代码

```
<form id="form1" runat="server">
<div>
<img alt="" src="C:\Users\Intern\Documents\Visual Studio  2008\Projects\highChart\highChart\images\279.gif" id="myImg" />

</div>
</form> 
```

服务器端代码

```
 Imports iTextSharp
 Imports iTextSharp.text.pdf
 Imports iTextSharp.text
 Imports System
 Imports System.Text
 Imports System.IO
 Imports System.Net.Mail
 Imports System.Net
 Imports iTextSharp.text.html.simpleparser

 Partial Public Class imagePdf
Inherits System.Web.UI.Page

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Response.ContentType = "application/pdf"
    Response.AddHeader("content-disposition", "attachment;filename=TestPage.pdf")
    Response.Cache.SetCacheability(HttpCacheability.NoCache)
    Dim sw As New StringWriter()
    Dim hw As New HtmlTextWriter(sw)
    Me.Page.RenderControl(hw)

    Dim sr As New StringReader(sw.ToString())
    Dim pdfDoc As New Document(PageSize.A4, 10.0F, 10.0F, 100.0F, 0.0F)
    Dim htmlparser As New HTMLWorker(pdfDoc)
    PdfWriter.GetInstance(pdfDoc, Response.OutputStream)
    pdfDoc.Open()
    htmlparser.Parse(sr)
    pdfDoc.Close()
    Response.Write(pdfDoc)
    Response.[End]()

    Dim file As (( i don't know what to add here ))
    Dim message As New MailMessage()
    message.From = New MailAddress("testApp@somewhereelse.com")
    message.To.Add(New MailAddress("anotheraddres84@hotmail.com"))
    message.Subject = "pdf "
    message.Body = "pdf attached "
    Dim data As New Attachment(File)
    message.Attachments.Add(data)

    Dim client As New SmtpClient()
    client.Host = "smtp.gmail.com"
    client.Credentials = New NetworkCredential("email", "password")
    client.EnableSsl = True
    client.Port = 587
    client.Send(message)
End Sub

End Class 
```

此代码的每个部分都可以正常工作，即 pdf 可以正常工作，电子邮件也可以，但我如何使用 pdf 文件作为附件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T20:49:00.217

将 PDF 存储为文件，然后使用 MailMessage.Attachments 属性将其添加到邮件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:32:22.940

您可以拥有完整路径，如下所示：c:\asdasd\adad\" + filename.pdf

或者您使用 Server.MapPath("/subdir/filename.pdf");

Server.MapPath 为您提供当前目录，即您已经在其中的目录。

# jquery - ajax后jquery ui按钮不会触发

> ID：10727472
> 
> 赞同：0
> 
> 时间：2012-05-23T20:39:08.760
> 
> 标签：jquery, ajax, button, user-interface

当我在页面加载时绑定我的事件时，我运行了这段代码：

```
$('span.removeItem','table').button(); 
```

当我在 ajax 请求的回调中运行它时，它不起作用。尽管它确实正确选择了元素，但它甚至不会在 firebug 控制台中运行。

也试过：

```
$('span.removeItem','table').last().button(); 
```

确保与预先存在的按钮没有冲突

如果这有帮助，则 html 中的表格行：

```
<tr>
        <td class="item">fsdfsdfsdf<span class="removeItem">X</span>
        </td>
        <td class="solution">
            <input itemId="372" solution=""/>
            <span itemId="372" timestamp="1337806132"></span>
        </td>
        <td class="actions">
            <span class="edit hidden">Update</span>
            <span class="save shown">Save</span>
        </td>
</tr> 
```

添加成功回调”：

```
success: function(data) {
                self.addNewItem(data);
        $('span.removeItem','table').last().button();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:21:47.940

在您的 javascript 中，您使用：

```
$('span.removeItem','table').button(); 
```

但是你没有一个最初包含一个类的元素`removeItem`

尝试查看 live()

[http://api.jquery.com/live/](http://api.jquery.com/live/)

# java - 如何编写用于验证客户端的 x509 自定义信任管理器

> ID：10727479
> 
> 赞同：0
> 
> 时间：2012-05-23T20:39:47.870
> 
> 标签：java, spring, spring-mvc, spring-security, x509certificate

我有一个 Web 应用程序，我在其中使用 Spring API 来获取证书中的主体信息以检查有效用户。

假设部署它的应用服务器包含包含 CA 证书的信任库，并将根据请求客户端的证书验证传入请求的真实性，然后才将其发送到应用程序。

因此，我没有验证证书的内容，只是验证了证书中的公用名（主体）部分。现在，如果我想在应用程序中编写自己的信任管理器，以根据 CA 的证书验证证书，我如何在 Spring 中实现相同的目标？

我知道我需要编写自定义信任库管理器并覆盖 checkClientTrusted 方法，但不知道该怎么做以及应该如何配置 Spring 以使用此自定义 Trustmanager.. 有人知道该怎么做吗？

谢谢

诺西布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:44:33.347

您不需要信任经理。您只需要在请求期间获取证书。它可作为请求属性使用：请参阅 Servlet Secification。

您通常在 Internet 上看到的自定义信任管理器实际上是重大的安全漏洞，由不了解问题或他们根本不安全的“解决方案”的含义的人犯下。

# parsing - 确定 Cobol 编码风格

> ID：10727481
> 
> 赞同：2
> 
> 时间：2012-05-23T20:39:54.347
> 
> 标签：parsing, cobol

我正在开发一个解析 Cobol 程序的应用程序。在这些程序中，有些尊重传统的编码风格（第 8 列到第 72 列的程序文本），有些较新，不遵循这种风格。

在我的应用程序中，我需要确定编码风格，以便知道是否应该解析第 72 列之后的内容。

我已经能够确定程序是从第 1 列还是第 8 列开始，但是从第 1 列开始的 prog 也可以遵循第 72 列之后的注释规则。

所以我试图找到允许我确定第 72 列之后的文本是注释还是有效代码的规则。

我找到了一些，但很难说它是否每次都有效：

*   第 72 列后的点，确定句子的结尾，但我担心点也可以在评论中

*   在第 72 列之后找到语句的结束字符：`" ' ) }`

*   在第 71 - 72 - 73 列查找 char，如果没有空格，则查找整个单词，并检查它是关键字还是 var。问题，它可以是 COPY 中的 var 或替换等...

**我想知道您对这些规则有何看法，以及您是否有任何想法可以帮助我确定 Cobol 程序的编码风格。**

*我不需要 API 或其他我可以依赖的可靠规则。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:01:59.080

我认为您需要了解每个程序的 COBOL 编译器。它的文档应该告诉您它使用哪些约定/配置/开关来决定源代码是否在第 72 列结束。

那么....哪个编译器？

如果您认为第 72 列的问题很麻烦，请等到您开始真正解析 COBOL 本身。如果你没有准备好处理语言的词汇问题，那么你可能没有准备好处理句法问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:21:51.593

不会有一种算法可以 100% 确定地做到这一点，因为如果注释可以是任何东西，它们也可以是可编译的 COBOL 代码。所以理论上你可以编写一个程序，如果注释被忽略，则意味着一件事，如果注释被视为 COBOL 的一部分，则完全是另一回事。

但这极不可能。最有可能发生的是，如果您尝试在错误的约定下编译代码，它只会失败。因此，唯一准确的方法是尝试以一种方式编译/解析程序，如果遇到无法理解的行，请切换到另一种样式。当样式已知时，您还可以支持将参数传递给编译器。

您可以尝试使用您所描述的启发式方法，但这永远不会完全准确。他们能给你的最多的是代码是一种或另一种风格的*可能性*，随着他们检查越来越多的代码行，这种可能性会增加。它们可能有助于在开始编译之前帮助您猜测样式，或者用于确定问题何时真的只是代码中的拼写错误。

### 编辑：

关于启发式的想法，很难说。如果有类似`//`或`#`其他语言的标准注释符号，这会容易得多（[实际上，有](http://www.gavilan.edu/csis/languages/comments.html#_Toc53710123)，但听起来你的代码不遵循这个约定）。我唯一能想到的就是检查每一行（或者可能是 99% 的行，不计算空行或用 注释的行`*`）是否在位置 72 之前的某个地方有一个句点。

您不想做的一件事是将任何启发式方法应用于位置 72*之后*的部分。也就是说，您不想检查评论以查看它们是否是有效的 COBOL。您想首先检查您所*知道*的是 COBOL，然后看看它是否可以自行工作。有几个原因：

*   用英文写的评论中可能有句号和引号，所以你的第一个和第二个要点都没有了。
*   自然语言比 COBOL 更难解析。
*   注释中很容易包含 COBOL（也许有人注释掉了该行的先前版本）。
*   注释的一个重要规则是它们永远不应该影响程序的功能。如果更改注释可以更改程序的编译方式，那么您就违反了。

记住所有这些，我的意见是你根本不应该使用启发式方法。除非明确指定，否则您应该始终尝试在两种约定下编译程序。代码有可能在这两种约定下都成功编译，然后你将拥有两个不同的程序，并且无法判断哪个是正确的。

如果发生这种情况，您需要比较两个结果（可能使用哈希或其他东西）以查看它们是否是同一个程序。如果它们相同，那就太好了，但如果不是，则需要强制用户明确选择约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T15:55:28.790

仅基于源代码，没有绝对可靠的方法来确定 COBOL 程序是固定格式还是自由格式。哎呀，有时很难仅根据源代码来识别编程语言。看看这个经典的[多语言](http://ideology.com.au/polyglot/polyglot.txt)- 它在 8 种不同的语言编译器下有效。也就是说，您可以尝试一些可能会更频繁地产生正确答案的启发式方法。

**嵌入在源代码中的编译器指令**

注意确定代码格式的某些编译器指令。不幸的是，每个编译器供应商都使用自己的指令风格。

例如，Microfocus COBOL 使用该 `SOURCEFORMAT`指令。该指令将出现在程序顶部附近，因此可以使用简短的预扫描来找到它。另一方面，OpenCobol 使用`>>SOURCE FORMAT IS FREE`和 `>>SOURCE FORMAT IS FIXED`在自由格式和固定格式之间切换，同一程序的不同部分可以采用不同的格式！

这里的底线是您必须支持多个 COBOL 编译器的约定。

**编译器开关**

也可以使用编译器开关指定源代码格式。在这种情况下，没有具体的线索可以继续。但是，您可以合理地确定整个源程序将是固定的或免费的。你在这里能做的就是猜测。除非程序员想“弄乱你的脑袋”（有些人会这样），否则自由格式的程序将在第 8 列之前使用关键字`IDENTIFICATION DIVISION`or `ID DIVISION`。每个 COBOL 程序都将以这些关键字开头，因此您可以将它们用作锚点在没有嵌入编译器指令的情况下确定代码格式的点。

警告 - 这远非万无一失，但可能是一个好的开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-02T16:20:32.597

大多数 COBOL 编译器将允许您生成和分析后期文本操作阶段。

可以看到文本预处理器的输出（以 OpenCOBOL 为例）

```
cobc -E program.cob 
```

文本操作处理器处理任何 COPY ... REPLACING 编译器指令，以及将 SOURCE FORMAT IS FIXED（包括行继续、字符串文字连接、注释行删除等）转换为编译器词法分析器的实际自由格式需要。许多 OpenCOBOL 工具包（Cross referencer 和 Animator，仅举两个例子）在预处理器通过之后使用源代码。如果您的解析器程序依赖于后处理的源代码文件，我认为您不会失去任何街头信誉。

# c# - 在 MVC3 中使用带有表单的查询字符串

> ID：10727491
> 
> 赞同：2
> 
> 时间：2012-05-23T20:40:37.957
> 
> 标签：c#, asp.net-mvc-3

我有一个带有表单的 MVC3 视图，我想通过查询字符串传入一个参数。这是我的表格

```
@using (Html.BeginForm("LogOn", "Account", new { db = @Request.QueryString["db"] }, FormMethod.Post)) 
```

这是我的控制器

```
[HttpPost]
public ActionResult LogOn(LogOnModel model,string db) 
```

当我单击我的登录按钮并单步执行代码时，参数 db 为空。我像这样传递它：

```
 http://localhost:64632/?db=someValue 
```

我的路线如下所示：

```
routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{db}", // URL with parameters
        new { controller = "Account", action = "LogOn", db = UrlParameter.Optional           } // Parameter defaults
); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:23:02.420

有用。我也在做同样的事情。我可以在 http 帖子上检索查询字符串值：`Request["queryparametername"]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:28:05.023

如果这是您拥有的唯一路线，那么您当前所在的页面大概看起来像“/controller/action/dbValue”。在这种情况下，

```
@Request.QueryString["db"] 
```

不会获取任何东西，因为 db 是一个路由值，它不是查询字符串的一部分。你可以使用

```
@ViewContext.RouteData.Values["db"] 
```

反而。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T20:46:48.080

您的路线预计`db`将成为 url 中的令牌：

```
http://localhost:64632/Account/LogOn/someValue 
```

您可以从控制器中的查询字符串中获取值并将 db 参数存储在 a 中`ViewBag`，它将在您的表单上可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:51:00.680

好吧，这是一个获取方法链接：“http://localhost:64632/?db=someValue”

并且您使用了 HttpPost 属性。

# .htaccess - mod_rewrite：如果 URL 引用文件夹，则参数可见

> ID：10727492
> 
> 赞同：0
> 
> 时间：2012-05-23T20:40:44.373
> 
> 标签：.htaccess, mod-rewrite

我在我的 .htaccess 中使用了以下 RewriteRule，它工作正常。

```
RewriteRule ^(.*)$ index.php?q=$1 [L,QSA] 
```

然而，有一件事情让我很困扰：

*   我有一个名为“文件夹”的子文件夹
*   我请求 URL [http://www.example.com/folder](http://www.example.com/folder)
*   URL 更改为[http://www.example.com/folder/?q=folder](http://www.example.com/folder/?q=folder)

任何其他 URL 都按预期工作，包括 http://www.example.com/folder/

当然，就 GET 变量而言，它并没有什么不同。但是如果参数在浏览器中不可见会更好。我尝试在 index.php 之前添加一个斜杠，但这导致了内部服务器错误。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:50:01.557

在你的 RewriteRule 之前添加这个：

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f 
```

# javascript - 脚手架 Upshot 上下文不调用 webapi？

> ID：10727497
> 
> 赞同：0
> 
> 时间：2012-05-23T20:41:09.723
> 
> 标签：javascript, asp.net-mvc, asp.net-mvc-4, asp.net-web-api, upshot

我正在关注史蒂夫·桑德森（[Steve Sanderson）](http://channel9.msdn.com/Events/TechDays/Techdays-2012-the-Netherlands/2159 "史蒂夫·桑德森")的一个非常简单的教程，看起来脚手架的脚本没有调用我的 webapi：

cshtml代码：

`@(Html.UpshotContext().DataSource<Yoga.Controllers.YogaController>(x => x.GetAllBugs()))`

生成的脚本：

```
upshot.dataSources = upshot.dataSources || {};
upshot.metadata({...});

upshot.dataSources.AllBugs = upshot.RemoteDataSource({ 
    providerParameters: { url: "/api/Yoga/", operationName: "GetAllBugs" },
    entityType: "BugView:#Yoga.Models",
    bufferChanges: false,
    dataContext: undefined,
    mapping: {}
}); 
```

并在页面加载后调用：

```
 $(function() {
        var dataSource = upshot.dataSources.AllBugs;
        dataSource.refresh(function(results)){
        //error here, `result` is an null object
            alert(results);
        });
    }); 
```

我在控制器中的 GetAllBugs() 成员处放置了一个断点，但它从未被击中。

但是，当我直接访问 uri 时，`http://localhost/api/yoga/getallbugs`我得到了预期的结果。（并且断点被击中）

我似乎无法弄清楚脚手架的结果脚本发生了什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T11:52:06.317

试试下面的代码：

```
dataSource.refresh(function (entities, total){
   alert(entities);
}); 
```

另外，进入firebug/开发者控制台的*网络*选项卡，或者启动Fiddler，检查对控制器的请求是否真的被发送。如果已发送，则您的问题出在控制器上，可能未正确映射操作。

# ruby-on-rails - Rails 3 - 在更新之前使用参数检查对象是否有效

> ID：10727498
> 
> 赞同：22
> 
> 时间：2012-05-23T20:41:11.817
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, validation

我有一个非常新手的问题。在更新模型之前，如何使用新参数检查模型对象是否有效？

我想改变它：

```
def update
  @obj = SomeModel.find( params[:id] )

  if @obj.update_attributes( params[:obj] )
    # That have been updated
  else
    # Ups, errors!
  end
end 
```

对于这样的事情：

```
def update
  @obj = SomeModel.find( params[:id] )

  if @obj.valid_with_new_params( params[:obj] )
    @obj.update_attributes( params[:obj] )
  else
    # Ups, errors!
  end
end 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-23T20:48:16.067

要更新属性而不保存它们，您可以使用

```
@obj.assign_attributes( params[:obj] ) 
```

然后检查对象是否有效，您可以调用

```
@obj.valid? 
```

如果对象*无效*，您可以通过调用查看错误（仅在调用之后`.valid?`）

```
@obj.errors 
```

如果对象*是*有效的，你可以通过调用保存它

```
@obj.save 
```

但是，所有这些*通常*都不是必需的。如果对象无效，则 ActiveRecord 不会将对象保存到数据库中，因此当您离开控制器操作时，所有属性更改都会被遗忘。

此外，由于不会将无效记录保存到数据库中，因此您始终可以再次调用 Object.find() 以取回原始对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:47:12.237

您可以调用该`valid?`方法来运行验证。

如果您的某些验证依赖于数据库中其他对象的状态，这并不能保证后续保存会成功。由于与验证无关的原因（例如外键约束），保存也可能失败

我不知道你为什么想要这个模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:45:21.903

如果传递的参数没有生成有效的对象，则不会保存该对象，因此您可以使用自己的方式就好了。`@obj.errors`您可以使用数组查看错误（如果有） 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:46:50.817

[`update_attributes`](http://apidock.com/rails/ActiveRecord/Persistence/update_attributes)方法验证对象，如果对象无效则返回 false。所以，你可以写：

```
if @obj.update_attributes( params[:obj] )
  # That have been update
else
  # Ups, errors!
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T20:49:14.413

答案是你可以定义一个方法

```
def valid_with_new_params(hash)
   self.attributes = hash
   valid?
end 
```

但这将是不必要的，因为如果 obj 成功更新则`@obj.update_attributes(params[:obj])`返回，否则返回。另请注意，该方法在内部运行所有验证，以便 在更新失败时可用。`true``false``update_attributes``@obj``@obj.errors`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-19T08:30:33.187

更新属性而不保存它们

```
@obj.attributes = params[:obj]   0r
@obj.attributes = {:name => “Rob”} 
```

然后检查对象是否有效

```
@obj.valid? 
```

检查是否有任何错误

```
@obj.errors 
```

# vb.net - VB.NET：为数据库访问嵌套“使用”

> ID：10727501
> 
> 赞同：0
> 
> 时间：2012-05-23T20:41:35.163
> 
> 标签：vb.net, ado.net, using

我想知道这是否是一种进行数据访问的好方法，就所有数据库对象被正确关闭和处置而言？例如：

```
Using conn As New SqlConnection(MyConnectionString)
  Using cmd As New SqlCommand("some SQL here", conn)
    ... add parameters ...
    conn.Open()
    Using dr As SqlDataReader = cmd.ExecuteReader()
      While dr.Read()
        ... do stuff ...
      Wend
    End Using
  End Using
End Using 
```

嵌套`Using`是可以接受的做法吗？如果我在 Read() 循环中的某个时刻退出该方法，那么使用`Using`这样的方法是否可以确保所有对象都被正确清理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:45:23.400

`Using``try/finally`保证在隐式块中有序处置。

```
' THE FOLLOWING TRY CONSTRUCTION IS EQUIVALENT TO THE USING BLOCK
Dim resource As New resourceType
Try 
    ' Insert code to work with resource.
Catch ex As Exception
    ' Insert code to process exception.
Finally 
    ' Insert code to do additional processing before disposing of resource.
    resource.Dispose() 
End Try 
```

嵌套使用以类似的方式工作。如果您退出代码块，它将执行该代码`finally`块，并正确处理您的对象。

[http://msdn.microsoft.com/en-US/library/htd05whh(v=VS.80).aspx](http://msdn.microsoft.com/en-US/library/htd05whh(v=VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:46:40.037

要添加，Using 块将“在幕后”添加一个 Try Final 语句。在 finally 语句中，它将在对象上调用 IDisposable.Dispose。换句话说，无论你做什么或发生什么，对象都会被处理掉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:44:04.010

是的，这没关系。IDisposable 对象的 Dispose 方法总是被调用。

PS：在这种情况下，Dispose 方法还包含 Close 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T20:52:32.920

您正在编写 VB.Net，因此这仅部分适用，但对于使用 StyleCop 的 C# 人员来说，像这样的多个[using 语句](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)将导致 StyleCop 中的异常[2202](http://msdn.microsoft.com/en-us/library/ms182334.aspx)。

关于该规则在 stylecop 中的有用性的反对意见的[msdn](http://msdn.microsoft.com/en-us/library/ms182334.aspx)链接中有一个很长的部分。

我不会判断您是否应该在您的 VB.Net 代码中注意 StyleCops 对 C# 的警告。

# scala - Scala 隐式类转换的范围

> ID：10727508
> 
> 赞同：3
> 
> 时间：2012-05-23T20:42:10.827
> 
> 标签：scala, implicit-conversion

Scala 似乎对最大可能的表达式应用了隐式类转换，如下例所示：

```
scala> class B { def b = { println("bb"); true } }
defined class B

scala> class A { def a = { println("aa"); new B } }
defined class A

scala> (new A).a.b
aa
bb
res16: Boolean = true

scala> class XXX(b: => Boolean) { def xxx = 42 }
defined class XXX

scala> implicit def toXXX(b: => Boolean) = new XXX(b)
toXXX: (b: => Boolean)XXX

scala> (new A).a.b.xxx
res18: Int = 42 
```

我对这个事实感到非常高兴，但我的问题是 SLS 的哪一部分指定了这种行为？例如，为什么它不首先评估`(new A).a.b`，`true`而只是对该值应用转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:14:21.373

包含隐式转换的行

```
(new A).a.b.xxx 
```

由编译器（即在编译时）转换为

```
toXXX((new A).a.b).xxx 
```

`-Xprint:typer`如果您在启动 Scala 时使用该选项，我们可以看到这一点。

```
private[this] val res3: Int = $line5.$read.$iw.$iw.toXXX(new $line2.$read.$iw.$iw.A().a.b).xxx; 
```

由于这种转换发生在编译时而不是运行时，因此 Scala 不可能在应用`(new A).a.b`转换`true`之前进行评估。因此，您得到的行为与您刚开始编写的行为完全相同`toXXX((new A).a.b).xxx`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T16:35:57.713

正如 Ryan Hendrickson 在邮件列表中的回答：

[定义] 您正在寻找的第 7.3 节，在应用视图的三种情况的列表中：

1.  在类型为 T 的 e 的选择 em 中，如果选择器不表示 T 的成员。在这种情况下，将搜索适用于 e 并且其结果包含名为 m 的成员的视图 v。搜索与隐式参数的情况一样进行，其中隐式范围是 T 之一。如果找到这样的视图，则选择 em 转换为 v(e).m。

所以编译器只能生成在语义上等同于 v(e).m 的东西，正如你所展示的，当涉及到按名称参数时

```
val x = e
v(x).m 
```

在语义上不等同于`v(e).m`.

# java - 混合并添加静音到音频 Android/Java

> ID：10727510
> 
> 赞同：2
> 
> 时间：2012-05-23T20:42:12.673
> 
> 标签：java, android, audio, mixing

我有 2 个文件。曾经是一个 mp3 被解码为 pcm 到一个流中，我也有一个 wav 被读入 pcm。样本以短数据类型保存。

音频统计：44,100 个样本 * 每个样本 16 位 * 2 个通道 = 1,411,200 位/秒

我需要将 X 秒的静音应用到 mp3 pcm 数据的开头，我这样做是这样的：

```
private short[] mp3Buffer = null;
private short[] wavBuffer = null;
private short[] mixedBuffer = null;

double silenceSamples = (audioInfo.rate * padding) * 2;
for (int i = 0; i < minBufferSize; i++){

    if (silenceSamples > 0 ){

        mp3Buffer[i] = 0; //Add 0 to the buffer as silence

        mixedBuffer[i] = (short)((mp3Buffer[i] + stereoWavBuffer[i])/2);  
        silenceSamples = silenceSamples - 0.5;
    }
    else
        mixedBuffer[i] = (short)((mp3Buffer[i] + stereoWavBuffer[i])/2);
} 
```

音频始终关闭。有时一两秒太快，有时一两秒太慢太慢。我不认为这是时间问题，因为我首先启动音频记录（wav），然后设置启动计时器->启动媒体播放器（已经准备好）->结束计时器并将差异设置为“填充”变量。从 wav 标头中，我也跳过了 44kb。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:28:33.467

我假设您想通过在其中一个流的开头插入填充以某种方式对齐两个音频源？这里有一些问题。

```
mp3Buffer[i] = 0; //Add 0 to the buffer as silence 
```

这不是在开头添加静音，只是将数组中 offest [i] 处的条目设置为 0。下一行：

```
mixedBuffer[i] = (short)((mp3Buffer[i] + stereoWavBuffer[i])/2); 
```

然后只是覆盖这个值。

如果您想以某种方式对齐流，最好的方法不是在任何一个流的开头插入静音，而是在其中一个流与另一个流的偏移处开始混合。此外，最好将它们混合成 32 位浮点数，然后标准化。就像是：

```
 int silenceSamples = (audioInfo.rate * padding) * 2;
            float[] mixedBuffer = new float[minBufferSize + silenceSamples]
    for (int i = 0; i < minBufferSize + silenceSamples; i++){

    if (i < silenceSamples )
    {       
        mixedBuffer[i] = (float) stereoWavBuffer[i];  
    }
    else if(i < minBufferSize)
    {
        mixedBuffer[i] = (float) (stereoWavBuffer[i] + mp3Buffer[i-silenceSamples]);
    }
    else 
    {
        mixedBuffer[i] = (float) (mp3Buffer[i-silenceSamples]);
    } 
```

要对数据进行规范化，您需要遍历混合缓冲区并找到绝对最大值`Math.abs(...)`，然后将数组中的所有值乘以 32,767/largestValue - 这将为您提供一个缓冲区，其中最大值适合回短而无需裁剪。然后遍历您的浮点数组，将每个值移回一个短数组。

我不确定你`minBufferSize`是什么 - 这需要足够大以混合所有数据。

# c# - Web.config 错误（system.serviceModel）

> ID：10727512
> 
> 赞同：2
> 
> 时间：2012-05-23T20:42:15.697
> 
> 标签：c#, .net, wpf, wcf, web-config

任何帮助为什么会发生此错误？

谢谢！！！

> 为 system.serviceModel/behaviors 创建配置节处理程序时出错：无法将扩展元素“cookieManager”添加到此元素。验证扩展是否已在 system.serviceModel/extensions/behaviorExtensions 的扩展集合中注册。参数名称：元素

网络配置

```
<system.serviceModel>
    <behaviors>
      <endpointBehaviors>
        <behavior name="EnableCookieManager">
          <cookieManager/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <extensions>
      <behaviorExtensions>
        <add name="cookieManager" type="App1.Web.Cookie.CookieManagerBehaviorExtension, App1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
      </behaviorExtensions>
    </extensions> 
```

[这个](http://archive.msdn.microsoft.com/wcfcookiemanager/Release/ProjectReleases.aspx?ReleaseId=2240)例子已经用过了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T07:40:22.420

您需要确保类型名称与 typeof(CookieManagerBehaviorExtension).AssemblyQualifiedName 完全相同

此外，如果您使用 WCFService 配置编辑器添加行为扩展，您只需浏览 DLL 和类，然后它将所有正确信息设置到您的配置文件中，以防万一您弄错了？

# installation - 有一种方法可以知道哪个项目正在 wix 上执行安装程序？

> ID：10727513
> 
> 赞同：0
> 
> 时间：2012-05-23T20:42:16.607
> 
> 标签：installation, wix

我有两个共享同一个 .wxi 文件的项目，但是现在，我需要为每个项目采取不同的操作。

有一种方法可以知道哪个项目正在执行安装程序并更改 wxi 文件上的安装程序操作？

例如，一个项目需要快捷方式，第二个不需要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T06:40:10.933

您可以使用[WiX 预处理器](http://wix.sourceforge.net/manual-wix3/preprocessor.htm)来执行此操作：只需在命令行或包含之前的主项目文件中设置一个变量，然后使用*条件语句*添加或删除一些元素。

# c# - HttpWebRequest 获取响应。如何等待响应？

> ID：10727515
> 
> 赞同：1
> 
> 时间：2012-05-23T20:42:18.447
> 
> 标签：c#, httpwebrequest

我正在使用`HttpWebRequest`. 但有时消息似乎发送了两倍、三倍甚至更多，审查所有过程似乎还可以。

我认为唯一的事情是 HttpWebRequest 正在异步工作。

这是我的代码，

```
 public bool sendSmsGateway(string tcDestino, string tcMensaje, string tcTitulo = "")
    {
        bool lReturn = false;
        string contenido = HttpUtility.UrlEncode(tcMensaje);
        string lcTitulo = "SMS Sender";
        if (!String.IsNullOrEmpty(tcTitulo))
        {
            lcTitulo = tcTitulo;
        }
        lcTitulo = HttpUtility.UrlEncode(lcTitulo);
        string fechaEnvio = DateTime.Now.ToString("s"); 
        string url = string.Format(StrSMSGatewayURL, StrSMSGatewayUsuario, StrSMSGatewayPassword, tcDestino, contenido, lcTitulo, fechaEnvio);
        HttpWebRequest enviar = (HttpWebRequest)WebRequest.Create(url);
        string respuesta = new StreamReader(enviar.GetResponse().GetResponseStream()).ReadToEnd();

        StrSMSGatewayRespuesta = respuesta.Trim();
        if (StrSMSGatewayRespuesta  == StrSMSGatewayRespuestaOk.Trim())
        {
            lReturn = true;
        }
        return lReturn;
    } 
```

此代码在循环例程中运行，在以下情况下发送消息并将其标记为已发送：

```
string respuesta = new StreamReader(enviar.GetResponse().GetResponseStream()).ReadToEnd(); 
```

返回正确的代码。

我的问题是..有一种方法可以停止进程，或强制代码等到`(httpWebRequest send the message and get the response)`或 `(timeout succeed)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:04:13.493

[`HttpWebRequest.GetResponse()`是一个同步调用](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.getresponse.aspx)，所以你不需要有不同的机制来阻塞当前线程。如果您使用的是异步方法[`HttpWebRequest.BeginGetResponse()`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetresponse.aspx)，那么您将需要另一种机制来等待异步接收到响应。

如果您要发送多条 SMS 消息，那么这可能是由于您在收到`StrSMSGatewayRespuesta`. 如果您收到错误的代码，但该消息实际上已发送，则该消息很可能会再次发送，因为您将其标记为未发送。

# asp.net - asp.net 母版页中的 Floodlight 代码

> ID：10727516
> 
> 赞同：0
> 
> 时间：2012-05-23T20:42:20.530
> 
> 标签：asp.net, master-pages, tracking

我计划在我的网站中实施 Floodlight 代码。我知道我需要将泛光灯标签放在***正文***标签之后。但是我的网站的设计方式是所有的 aspx 页面都使用一个母版页。由于母版页将包含***正文***标记。如何为每个页面添加 Floodlight 代码？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:21:12.413

您可以在母版页中的 body 标记之后放置一个 Literal 控件，并将其设置在您的 aspx 代码中，即，

在您的母版页中...

```
...
</body>
<asp:Literal id="ltrFloodlightTag" runat="server"></asp:Literal> 
```

然后在使用母版页的 aspx.cs 页面中...

```
protected void Page_Load(object sender, EventArgs e)
{
    ....
    Literal ltrFloodlightTag = (Literal)Master.FindControl("ltrFloodlightTag");
    ltrFloodlightTag.Text = "<img src='http://flodlightstuff/info.aspx?this=123&that=321' width='1px' height='1px' />";
} 
```

同样，您可以只在母版页中使用 img 并简单地从 aspx 设置 src 属性（如果每个页面上都有泛光灯，这可能更有意义）。

我认为这就是您可能会遇到的问题，而且我实际上已经正确理解了 Floodlight 标签的含义！

# java - 将 CLOB 插入 Oracle 数据库

> ID：10727521
> 
> 赞同：4
> 
> 时间：2012-05-23T20:42:43.183
> 
> 标签：java, oracle, jdbc, insert, clob

**我的问题是：**`ORA-01704: string literal too long`使用 s插入（或在查询中执行任何操作）时如何解决错误`CLOB`？

我想要这样的查询：

```
INSERT ALL
   INTO mytable VALUES ('clob1')
   INTO mytable VALUES ('clob2') --some of these clobs are more than 4000 characters...
   INTO mytable VALUES ('clob3')
SELECT * FROM dual; 
```

当我用实际值尝试它时，虽然我`ORA-01704: string literal too long`回来了。这很明显，但是我如何插入 clob（或使用 clob 执行任何语句）？

我试过看这个[问题](https://stackoverflow.com/questions/5549450)，但我认为它没有我想要的东西。我拥有的 clob 在 a 中`List<String>`，我遍历它们以发表声明。我的代码如下：

```
private void insertQueries(String tempTableName) throws FileNotFoundException, DataException, SQLException, IOException {
String preQuery = "  into " + tempTableName + " values ('";
String postQuery = "')" + StringHelper.newline;
StringBuilder inserts = new StringBuilder("insert all" + StringHelper.newline);
List<String> readQueries = getDomoQueries();
for (String query : readQueries) {
  inserts.append(preQuery).append(query).append(postQuery);
}
inserts.append("select * from dual;");

DatabaseController.getInstance().executeQuery(databaseConnectionURL, inserts.toString()); 
```

}

```
public ResultSet executeQuery(String connection, String query) throws DataException, SQLException {
  Connection conn = ConnectionPool.getInstance().get(connection);
  Statement stmt = conn.createStatement();
  ResultSet rs = stmt.executeQuery(query);
  conn.commit();
  ConnectionPool.getInstance().release(conn);
  return rs;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T22:11:48.187

你让它变得复杂。

为列表中的每个 clob 使用 PreparedStatement 和 addBatch()：

```
String sql = "insert  into " + tempTableName + " values (?)";
PreparedStatement stmt = connection.prepareStatement(sql);
for (String query : readQueries) {
  stmt.setCharacterStream(1, new StringReader(query), query.lenght());
  stmt.addBatch();
}
stmt.exececuteBatch(); 
```

没有转义字符串，没有文字长度的问题，不需要创建临时 clob。而且很可能与使用单个 INSERT ALL 语句一样快。

如果您使用的是当前驱动程序（> 10.2），那么我认为 setCharacterStream() 调用和 Reader 的创建也没有必要。一个简单的`setString(1, query)`也很可能会起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T20:52:51.670

您需要使用绑定变量，而不是使用字符串连接构建 SQL 语句。从安全性、性能和健壮性的角度来看，这也将是有益的，因为它将降低 SQL 注入攻击的风险，减少 Oracle 必须花费在 SQL 语句的硬解析上的时间量，并消除潜在的 SQL 注入攻击。是字符串中的一个特殊字符，它会导致生成无效的 SQL 语句（即单引号）。

我希望你想要类似的东西

```
private void insertQueries(String tempTableName) throws FileNotFoundException, DataException, SQLException, IOException {
  String preQuery = "  into " + tempTableName + " values (?)" + StringHelper.newline;
  StringBuilder inserts = new StringBuilder("insert all" + StringHelper.newline);
  List<String> readQueries = getDomoQueries();
  for (String query : readQueries) {
    inserts.append(preQuery);
  }
  inserts.append("select * from dual");

  Connection conn = ConnectionPool.getInstance().get(connection);
  PreparedStatement pstmt = conn.prepareStatement(
        inserts);
  int i = 1;
  for (String query : readQueries) {
    Clob clob = CLOB.createTemporary(conn, false, oracle.sql.CLOB.DURATION_SESSION);
    clob.setString(i, query);
    pstmt.setClob(i, clob);
    i = i + 1;
  }
  pstmt.executeUpdate();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-06T17:04:35.957

BLOB（二进制大对象）和CLOB（字符大对象）是特殊的数据类型，可以以对象或文本的形式保存大块数据。Blob 和 Clob 对象将对象的数据作为流保存到数据库中。

一段代码示例：

```
public class TestDB { 
    public static void main(String[] args) { 
        try { 
            /** Loading the driver */ 
            Class.forName("com.oracle.jdbc.Driver"); 

            /** Getting Connection */ 
            Connection con = DriverManager.getConnection("Driver URL","test","test"); 

            PreparedStatement pstmt = con.prepareStatement("insert into Emp(id,name,description)values(?,?,?)"); 
            pstmt.setInt(1,5); 
            pstmt.setString(2,"Das"); 

            // Create a big CLOB value...AND inserting as a CLOB 
            StringBuffer sb = new StringBuffer(400000); 

            sb.append("This is the Example of CLOB .."); 
            String clobValue = sb.toString(); 

            pstmt.setString(3, clobValue); 
            int i = pstmt.executeUpdate(); 
            System.out.println("Done Inserted"); 
            pstmt.close(); 
            con.close(); 

            // Retrive CLOB values 
            Connection con = DriverManager.getConnection("Driver URL","test","test"); 
            PreparedStatement pstmt = con.prepareStatement("select * from Emp where id=5"); 
            ResultSet rs = pstmt.executeQuery(); 
            Reader instream = null; 

            int chunkSize; 
            if (rs.next()) { 
                String name = rs.getString("name"); 
                java.sql.Clob clob = result.getClob("description") 
                StringBuffer sb1 = new StringBuffer(); 

                chunkSize = ((oracle.sql.CLOB)clob).getChunkSize(); 
                instream = clob.getCharacterStream(); 
                BufferedReader in = new BufferedReader(instream); 
                String line = null; 
                while ((line = in.readLine()) != null) { 
                    sb1.append(line); 
                } 

                if (in != null) { 
                    in.close(); 
                } 

                // this is the clob data converted into string
                String clobdata = sb1.toString();  
            } 
        } catch (Exception e) { 
            e.printStackTrace(); 
        } 
    } 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-14T20:57:26.937

来自[Oracle 文档](http://docs.oracle.com/cd/E14072_01/java.112/e10589/oralob.htm)

您必须牢记以下大数据输入模式的自动切换。输入方式有以下三种：直接绑定、流绑定、LOB绑定。

对于 PL/SQL 语句

setBytes 和 setBinary 流方法对小于 32767 字节的数据使用直接绑定。

setBytes 和 setBinaryStream 方法对大于 32766 字节的数据使用 LOB 绑定。

setString、setCharacterStream 和 setAsciiStream 方法对数据库字符集中小于 32767 字节的数据使用直接绑定。

setString、setCharacterStream 和 setAsciiStream 方法对数据库字符集中大于 32766 字节的数据使用 LOB 绑定。

oracle.jdbc.OraclePreparedStatement 接口中的 setBytesForBlob 和 setStringForClob 方法对任何数据大小都使用 LOB 绑定。

以下是将文件内容放入 PLSQL 过程的输入 CLOB 参数的示例：

```
 public int fileToClob( FileItem uploadFileItem ) throws SQLException, IOException
  {
    //for using stmt.setStringForClob method, turn the file to a big String 
    FileItem item = uploadFileItem;
    InputStream inputStream = item.getInputStream();
    InputStreamReader inputStreamReader = new InputStreamReader( inputStream ); 
    BufferedReader bufferedReader = new BufferedReader( inputStreamReader );    
    StringBuffer stringBuffer = new StringBuffer();
    String line = null;

    while((line = bufferedReader.readLine()) != null) {  //Read till end
        stringBuffer.append(line);
        stringBuffer.append("\n");
    }

    String fileString = stringBuffer.toString();

    bufferedReader.close();         
    inputStreamReader.close();
    inputStream.close();
    item.delete();

    OracleCallableStatement stmt;

    String strFunction = "{ call p_file_to_clob( p_in_clob => ? )}";  

    stmt= (OracleCallableStatement)conn.prepareCall(strFunction);    

    try{    
      SasUtility servletUtility = sas.SasUtility.getInstance();

      stmt.setStringForClob(1, fileString );

      stmt.execute();

    } finally {      
      stmt.close();
    }
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-24T12:58:26.333

我，我喜欢使用 java.sql.* 包中的类，而不是 oracle.* 的东西。对我来说，简单的方法

```
Connection con = ...;
try (PreparedStatement pst = con.prepareStatement(
     "insert into tbl (other_fld, clob_fld) values (?,?)", new String[]{"tbl_id"});
     ) {
        Clob clob = con.createClob();
        readIntoClob(clob, inputStream);
        pst.setString(1, "other");
        pst.setClob(2, clob);
        pst.executeUpdate();
        try (ResultSet rst = pst.getGeneratedKeys()) {
            if (rst == null || !rst.next()) {
                throw new Exception("error with getting auto-generated key");
            }
            id = rst.getBigDecimal(1);
        } 
```

当测试（当前的tomcat，jdbc）投入生产（由于愚蠢的原因卡在Tomcat6中）时停止工作。con.createClob() 由于该版本中未知的原因返回 null，所以我不得不这样做（我花了很长时间才弄清楚，所以我在这里分享......）

```
try (PreparedStatement pst = con.prepareStatement(
         "insert into tbl (other_fld) values (?)", new String[]{"tbl_id"});
     PreparedStatement getClob= con.prepareStatement(
         "select clob_fld from tbl where tbl_id = ? for update");
     ) {
        Clob clob = con.createClob();
        readIntoClob(clob, inputStream);
        pst.setString(1, "other");
        pst.executeUpdate();
        try (ResultSet rst = pst.getGeneratedKeys()) {
            if (rst == null || !rst.next()) {
                throw new Exception("error with getting auto-generated key");
            }
            id = rst.getBigDecimal(1);
        }  

        //  fetch back fresh record, with the Clob
        getClob.setBigDecimal(1, id);
        getClob.execute();
        try (ResultSet rst = getClob.getResultSet()) {
            if (rst == null || !rst.next()) {
                throw new Exception("error with fetching back clob");
            }
            Clob c = rst.getClob(1);
            // Fill in data
            readIntoClob(c, stream);
            // that's all 
        }

    } catch (SQLException) {
       ...
    } 
```

为了完整性，这里是

```
// Read data from an input stream and insert it in to the clob column
private static void readIntoClob(Clob clob, InputStream stream) {
    try (BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(stream))) {
        char[] buffer = new char[CHUNK_BUFFER_SIZE];
        int charsRead;
        try (Writer wr = clob.setCharacterStream(1L)) {
            // Loop for reading of chunk of data and then write into the clob.
            while ((charsRead = bufferedReader.read(buffer)) != -1) {
                wr.write(buffer, 0, charsRead);
            }
        } catch (SQLException | IOException ex) {
            ...
        }

    }
} 
```

这是来自其他地方的SO，谢谢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-02T23:42:00.690

[在github](https://github.com/oracle/oracle-db-examples/blob/master/java/jdbc/BasicSamples/LobBasicSample.java)上查看一些与 CLOB 相关的示例。

# excel - Excel 宏 4.0 事件处理

> ID：10727524
> 
> 赞同：2
> 
> 时间：2012-05-23T20:42:54.000
> 
> 标签：excel, macros, event-handling, excel-4.0

按照这些步骤，您可以在工作簿中创建 Excel 4.0 宏：

1.  右键单击`Sheet1`Excel 工作簿底部的工作表/选项卡（例如 ）。
2.  单击`Insert...`。
3.  选择`MS Excel 4.0 Macro`并点击`OK`。

您将获得一个启用了宏的新工作表“Macro1”。

您如何`SheetSelectionChangeEvent`在代码中处理此工作表的事件？

我能够订阅和处理常规工作表（ 、 等）的这些事件`Sheet1`，`Sheet2`但对于工作`Macro1`表，这些常规事件不会被触发。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:14:41.753

可从此处获得参考：http: [//support.microsoft.com/kb/128185](http://support.microsoft.com/kb/128185)

> ON 函数允许您指定在某个事件发生时要运行的宏。ON 函数打开和关闭此特殊事件处理。通过指定要等待的事件类型（例如重新计算、特定时间或要按下的键，以及事件发生时要运行的宏）来打开 ON 功能。通过使用相同的公式但省略指定要运行的宏的参数来关闭 ON 函数。

```
ON.DATA         Runs a macro when data is entered
ON.DOUBLECLICK  Runs a macro when you double-click any cell or object
                  on the specified document or double-click any item
                  on the specified chart
ON.ENTRY        Runs a macro when a document is recalculated
ON.KEY          Runs a macro when a specified key is pressed
ON.RECALC       Runs a macro when a document is recalculated
ON.SHEET        Runs a macro when a specified sheet is selected
ON.TIME         Runs a macro at a specific time
ON.WINDOW       Runs a macro when you switch to a window 
```

# algorithm - 用于分类的哈希函数

> ID：10727526
> 
> 赞同：1
> 
> 时间：2012-05-23T20:43:08.503
> 
> 标签：algorithm, hash, classification

给定一个已知集合 $A$ 的不同数字 $0 ~ 2^(n+1)-1$。在二进制模式下，它是一个具有 0/1 个元素的 n 维向量。现在对于包含 $m$ 个不同数量的 $A$ 的任意子集 $S$，是否有可能找到一个函数 $f$，使得 $f(S)$ 变为 $0,1,...,m-1 $，而 $f(A\S)$ 不应该落在 $0,1,...,m-1$ 中。函数 $f$ 应该尽可能简单，最好是线性函数。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:26:20.847

您要查找的关键字是[最小完美散列函数](http://en.wikipedia.org/wiki/Perfect_hash_function#Minimal_perfect_hash_function)，是的，[总是可以](http://burtleburtle.net/bob/hash/perfect.html)为给定的**S**构造最小完美散列函数。

# apache - FTP 上传：可以仅限制静态内容

> ID：10727527
> 
> 赞同：1
> 
> 时间：2012-05-23T20:43:09.610
> 
> 标签：apache, ftp

对于实时在线锦标赛，我上传了一堆由我们的锦标赛软件生成的 html 页面。在网络服务器上，我用这些文件做需要做的事情。所以比赛软件被“集成”在我们的网站上。

现在我们希望其他人运行这些锦标赛，然后他们必须上传这些生成的 html/css 文件。通过 http 上传确实是太多的工作 en 需要太多的时间。

我想创建另一个只能访问锦标赛目录的 ftp 帐户。到现在为止还挺好。

但是，我想将上传文件类型限制为 html 和 css 文件，因此他们只能通过 ftp 上传静态内容（我只是偏执，我不希望他们可以上传带有可能危险代码或其他意外文件类型的 php 文件）

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:46:14.447

文件只是字节序列，与扩展无关，危险在于您阅读它们的方式。您必须将上传的文件设置为不可执行并且您是安全的。即使您将.css文件设置为以某种方式上传，您也无法仅通过扩展名检查它是否安全，攻击者可能已经手动更改了扩展名。此外，上传 PHP 文件不会有问题，如果您指定 Apache 不知道的上传文件夹，即不在您的 www 文件夹下。

# ios - AVAssetExportSession 停止进行

> ID：10727530
> 
> 赞同：17
> 
> 时间：2012-05-23T20:43:14.773
> 
> 标签：ios, avfoundation, avassetexportsession

我遇到了 AVAssetExportSession 的问题，其中进度停止增加，但状态仍然显示它正在导出。这实际上是一种非常罕见的情况，大约 99.99% 的时间它都可以完美运行，但我还是想解决这个问题。

所以我开始导出：

```
 exportSession = [[AVAssetExportSession alloc] initWithAsset:composition presetName:AVAssetExportPresetMediumQuality];
    exportSession.videoComposition = videoComposition; 
    exportSession.outputFileType = @"com.apple.quicktime-movie";
    exportSession.outputURL = outputURL;
    [exportSession exportAsynchronouslyWithCompletionHandler:^{
        ...
    }]; 
```

然后让计时器检查进度：

```
 AVAssetExportSessionStatus status = [exportSession status];
    float progress = 0;
    if (status == AVAssetExportSessionStatusExporting) {
        progress = [exportSession progress];
    } else if (status == AVAssetExportSessionStatusCompleted) {
        progress = 1;
    }
    NSLog(@"%d %f", status, progress);
    [delegate processor:self didProgress:progress]; 
```

输出最终看起来像：

```
2012-05-23 14:28:59.494 **********[1899:707] 2 0.125991
2012-05-23 14:28:59.994 **********[1899:707] 2 0.185280
2012-05-23 14:29:00.494 **********[1899:707] 2 0.259393
2012-05-23 14:29:00.994 **********[1899:707] 2 0.326093
2012-05-23 14:29:01.494 **********[1899:707] 2 0.400206
2012-05-23 14:29:01.995 **********[1899:707] 2 0.481729
2012-05-23 14:29:02.495 **********[1899:707] 2 0.541019
2012-05-23 14:29:02.997 **********[1899:707] 2 0.622542
2012-05-23 14:29:03.493 **********[1899:707] 2 0.681832
2012-05-23 14:29:03.995 **********[1899:707] 2 0.763355
2012-05-23 14:29:04.494 **********[1899:707] 2 0.822645
2012-05-23 14:29:04.994 **********[1899:707] 2 0.880082
2012-05-23 14:29:05.493 **********[1899:707] 2 0.880082
2012-05-23 14:29:05.994 **********[1899:707] 2 0.880082
...
2012-05-23 14:43:22.994 **********[1899:707] 2 0.880082
2012-05-23 14:43:23.493 **********[1899:707] 2 0.880082
2012-05-23 14:43:23.994 **********[1899:707] 2 0.880082
2012-05-23 14:43:24.494 **********[1899:707] 2 0.880082 
```

（注意：它不会每次都以相同的百分比停止，完全随机）

从时间戳中可以看出，前 88% 需要 5 秒，然后我让它再运行 13 分钟（完整的视频处理通常不会超过 10 秒），进度没有变化。

目前我唯一的选择是检查进度是否在最后 X 秒内没有改变，然后告诉用户它失败并重试。

有人有想法么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-10T03:29:51.457

在我的情况下，这个问题源于使用异常配置编码的 mp4。但最终苹果代码中的一个错误导致了这个问题。

具体来说，我在 Facebook 上使用 mp4。似乎当 facebook 对视频进行编码时，它会丢弃或移动视频轨道的第一帧。用 ffprobe 检查视频显示：

```
 "r_frame_rate": "722/25",
        "avg_frame_rate": "722/25",
        "time_base": "1/28880",
        "start_pts": 1000,
        "start_time": "0.034626", 
```

0.034626 正是第 2 帧的时间。然而，音轨从 0 开始。

不幸的是，Apple 的 API 没有正确报告赛道的这个开始时间。从 AVAsset 获取 AVAssetTrack 并检查其 timeRange 后，它将开始时间报告为 0。我可能误解了轨道和资产计时的性质，但这似乎是一个错误。

当然，在为导出会话构建视频合成时，我使用了不正确的轨道时间范围。我怀疑，当导出会话在时间 0 时在轨道中查找数据并没有发现任何内容时，它会感到困惑，然后正如我们所见，它只是挂起，甚至不报告错误 - 另一个错误。即使使用 videoCompositionWithPropertiesOfAsset: 创建合成也无济于事。

我还没有尝试使用 AVAssetReader 和 AVAssetWriter 代替 AVAssetExportSession 所以我不知道你是否会遇到同样的情况。直到我有更多时间去探索，我才想出了这个 hack 作为解决方案：

将用于轨道插入和视频指令的时间范围重置为从 1 或 2 帧开始：

```
CMTimeRange videoTimeRange = videoTrack.timeRange;
videoTimeRange.start = CMTimeMake(1, ceil(videoTrack.nominalFrameRate)); 
```

显然，这种 hack 仅适用于视频轨道开始时间不为 0 的特定情况。我猜想通常这个错误是由 AVAssetExportSession 及其相关类不期望的异常媒体编码引起的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T20:47:05.727

我发现了！

您需要设置正确的 layerInstructions：

```
AVMutableCompositionTrack *track = [mixComposition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid];

AVMutableVideoCompositionLayerInstruction * layerInstruction = [AVMutableVideoCompositionLayerInstruction videoCompositionLayerInstructionWithAssetTrack:track];

AVMutableVideoCompositionInstruction * MainInstruction = [AVMutableVideoCompositionInstruction videoCompositionInstruction];
MainInstruction.timeRange = CMTimeRangeMake(kCMTimeZero, allTime);
MainInstruction.layerInstructions = [NSArray arrayWithObject:layerInstruction]; 
```

否则它只是卡住了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T05:46:06.227

我想知道这是否是线程问题 - 如果计时器和导出器最终出现在不同的线程中。（AVFoundation 指南说导出器不能保证在任何特定线程上运行。）

您是否尝试过使用键值观察而不是计时器？

准系统示例：

```
// register for the notification
[exportSession addObserver:someProcessor forKeyPath:@"progress" options:NSKeyValueObservingOptionNew context:NULL]; 
```

然后在你的处理器中：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    // add some checks here
    NSNumber *processNumber = [change objectForKey:NSKeyValueChangeNewKey];
    float process = [processNumber floatValue];
    [delegate processor:self didProgress:progress];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-19T20:49:25.650

我遇到了同样的问题，其他解决方案（如设置 layerInstructions）都没有帮助我。

我重新安排了我的 DispatchQueues 的工作方式，它似乎已经解决了这个问题。具体来说， AVAssetExportSessions 是在具有*相同 AVAsset 的*多个不同（并发）DispatchQueues 上创建的。解决方法是让创建 AVAsset 的队列也（始终）成为创建 AVAssetExportSessions 的队列。我发现从全局 DispatchQueue 调用 AVAssetExportSession.exportAsynchronously() 很好——而且是必要的，如果你想要一个在发生故障时最终超时的计时器。

# asp.net-mvc-3 - 使用 mvc3 下拉列表的 jquery 自动完成

> ID：10727538
> 
> 赞同：4
> 
> 时间：2012-05-23T20:43:40.273
> 
> 标签：asp.net-mvc-3, jquery-ui

我正在使用带有 EF Code First 的 ASP.NET MVC3。我以前没有使用过 jQuery。我想将自动完成功能添加到绑定到我的模型的下拉列表中。下拉列表存储 ID，并显示值。

那么，如何连接 jQuery UI 自动完成小部件以在用户键入时显示值但存储 ID？

我也需要一个视图中的多个自动完成下拉菜单。

我看到了这个插件：[http](http://harvesthq.github.com/chosen/) ://harvesthq.github.com/chosen/但我不确定我想在我的项目中添加更多“东西”。有没有办法用 jQuery UI 做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:33:06.650

**更新**

[我刚刚在 GitHub https://github.com/alfalfastrange/jQueryAutocompleteSample](https://github.com/alfalfastrange/jQueryAutocompleteSample)的文本框中发布了一个示例项目，展示了 jQueryUI 自动完成功能

* * *

我将它与常规 MVC TextBox 一起使用

```
@Html.TextBoxFor(model => model.MainBranch, new {id = "SearchField", @class = "ui-widget TextField_220" }) 
```

这是我的 Ajax 通话片段

它最初检查其内部缓存的正在搜索的项目，如果没有找到，它会触发对我的控制器操作的 Ajax 请求以检索匹配的记录

```
$("#SearchField").autocomplete({
    source: function (request, response) {
        var term = request.term;
        if (term in entityCache) {
            response(entityCache[term]);
            return;
        }
        if (entitiesXhr != null) {
            entitiesXhr.abort();
        }
        $.ajax({
            url: actionUrl,
            data: request,
            type: "GET",
            contentType: "application/json; charset=utf-8",
            timeout: 10000,
            dataType: "json",
            success: function (data) {
                entityCache[term] = term;
                response($.map(data, function (item) {
                    return { label: item.SchoolName, value: item.EntityName, id: item.EntityID, code: item.EntityCode };
                }));
            }
        });
    },
    minLength: 3,
    select: function (event, result) {
        var id = result.item.id;
        var code = result.item.code;
        getEntityXhr(id, code);
    }
}); 
```

这不是所有代码，但您应该能够在这里看到缓存是如何搜索的，然后进行 Ajax 调用，然后对响应做了什么。我有一个`select`部分，所以我可以对选定的值做一些事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:49:51.273

这就是我所做的FWIW。

```
$(document).ready(function () {
    $('#CustomerByName').autocomplete(
    {
        source: function (request, response) {
            $.ajax(
            {
                url: "/Cases/FindByName", type: "GET", dataType: "json",
                data: { searchText: request.term, maxResults: 10 },
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    response($.map(data, function (item) {
                        return {
                            label: item.CustomerName,
                            value: item.CustomerName,
                            id: item.CustomerID
                        }
                    })
                    );
                },

            });
        },
        select: function (event, ui) {
                    $('#CustomerID').val(ui.item.id);
                },
        minLength: 1
    });

}); 
```

效果很好！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-23T21:44:00.127

我已经多次看到这个问题。您可以看到我的一些代码在[级联下拉列表中解决了这个问题，在发布后丢失了选择的项目](https://stackoverflow.com/questions/10728206/cascading-dropdown-loses-select-items-after-post)

这个链接也可能有帮助 - [http://geekswithblogs.net/ranganh/archive/2011/06/14/cascading-dropdownlist-in-asp.net-mvc-3-using-jquery.aspx](http://geekswithblogs.net/ranganh/archive/2011/06/14/cascading-dropdownlist-in-asp.net-mvc-3-using-jquery.aspx)

# database - sqlite 数据库中的唯一 ID 用完

> ID：10727541
> 
> 赞同：2
> 
> 时间：2012-05-23T20:43:43.407
> 
> 标签：database, sqlite, unique, auto-increment

我知道 sqlite 数据库会为插入的每条记录自动生成一个唯一的 ID（自动增量）。

有谁知道在执行替换查询时是否有可能用完 sqlite3 数据库中的系统唯一 ID？

我的意思是数据库中的每条数据都有自己的类型。例如，系统唯一 ID 类似于 int。如果数据库生成的唯一 ID 等于 MAX_INT，它会如何处理下一条记录？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T20:46:20.117

最大可能的 ID 为 9223372036854775807 (2^63 - 1)。在任何情况下，如果找不到新的自增主键，它将返回 SQLITE_FULL。

还有一点很重要。如果您使用 INTEGER PRIMARY KEY，它可以重用之前在表中但已被删除的键。如果你使用 INTEGER PRIMARY KEY AUTOINCREMENT，它永远不能重用一个自动增量键。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T20:47:00.770

[http://www.sqlite.org/autoinc.html](http://www.sqlite.org/autoinc.html)

“如果最大的 ROWID 等于最大可能的整数 (9223372036854775807)，则数据库引擎开始随机选择正候选 ROWID，直到找到以前未使用的 ROWID。如果在合理的尝试次数后找不到未使用的 ROWID，插入操作失败并出现 SQLITE_FULL 错误。如果没有显式插入负 ROWID 值，则自动生成的 ROWID 值将始终大于零。

鉴于 sqlite id 是 64 位的，您可以在接下来的 546 年中每 100 毫秒插入一条新记录，然后再用完（我编造了这些数字；但您明白了）。

# python - 为什么这个正则表达式不能在两个标记之间找到文本？

> ID：10727548
> 
> 赞同：0
> 
> 时间：2012-05-23T20:44:04.307
> 
> 标签：python, regex

```
str = "{u'xlink:href': u'http://ip/goform/XmlApi?op=ip&port=0&target=1', u'id': u'1'}"
print re.search("/href': u'.*?',/", str) 
```

我正在尝试获取以 http:// 开头并以 target=1 结尾的文本，但我没有得到。我的正则表达式错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:53:56.553

是的，我认为您正在寻找错误的东西（如果您想要的是 url）：

```
#!/usr/bin/env python 

import re

if __name__ == '__main__':
    s = "{u'xlink:href': u'http://ip/goform/XmlApi?op=ip&port=0&target=1', u'id': u'1'}"
    m = re.search(r"u'(http://.*?)',", s)
    print m.group(1) 
```

# javascript - 如何使用 knockout.js 显示图像加载微调器

> ID：10727551
> 
> 赞同：6
> 
> 时间：2012-05-23T20:44:41.793
> 
> 标签：javascript, knockout.js

我正在使用淘汰赛来绑定图像列表。在加载图像时设置微调器背景的最佳方法是什么。我有一个微调器类，我可以设置和取消设置背景图像，但想知道是否有一种简单的方法可以使用 knockout.js 绑定到图像完成事件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T21:06:40.820

使用 jquery UI 的小微调器，我有一个绑定处理程序，例如

```
 ko.bindingHandlers.Loading = {
        update: function (element, valueAccessor, allBindingsAccessor) {
            var value = valueAccessor(), allBindings = allBindingsAccessor();
            var valueUnwrapped = ko.utils.unwrapObservable(value);

            if (valueUnwrapped == true)
                $(element).showLoading(); // Make the element visible
            else
                $(element).hideLoading();   // Make the element invisible
        }
    }; 
```

然后像这样使用它

```
<div data-bind="Loading: isLoading" > 
```

因此，基本上，您可以将它绑定到视图模型上可能代表其加载（或忙碌）或不加载的任何内容。

# objective-c - IOS - CoreData - 使用已插入的关系实体插入新实体

> ID：10727559
> 
> 赞同：0
> 
> 时间：2012-05-23T20:45:17.247
> 
> 标签：objective-c, ios, core-data

我有 2 个实体：母亲和孩子。母亲有它的属性和其他的 NSSet 作为孩子。孩子有它的财产和其他的母亲财产。所以有关系 1-n：现在，母亲已经被拯救并坚持了 d。我需要插入一个新的孩子，所以我尝试使用代码：

```
-(void)addChild:(NSString *)name {
    // get Child instance to save
        Child *child = (Child*) [NSEntityDescription insertNewObjectForEntityForName:@"Child" inManagedObjectContext:self.managedObjectContext];
        mother

        // get Mother element to associate
        NSFetchRequest *request = [[NSFetchRequest alloc] init];
        NSEntityDescription *entity = [NSEntityDescription entityForName:@"Mother" inManagedObjectContext:self.managedObjectContext];
        [request setEntity:entity];
        NSPredicate *predicate = [NSPredicate predicateWithFormat:@"mother_desc = %@", @"themothertofind"];
        [request setPredicate:predicate];

        id sortDesc = [[NSSortDescriptor alloc] initWithKey:@"mother_desc" ascending:YES];
        [request setSortDescriptors:[NSArray arrayWithObject:sortDesc]];

        NSError *error = nil;
        NSArray *fetchResults = [self.managedObjectContext executeFetchRequest:request error:&error];
        if (fetchResults == nil) {
            NSLog(@"%@", [error description]);
        }
        else {
        // id mother exist associate to Child
            [child setMother:[fetchResults objectAtIndex:0]];
            NSLog(@"Mother: %@", Child.mother.mother_desc);
        }

        [child setName:name];

        if (![self.managedObjectContext save:&error]) {
            NSLog(@"%@", [error description]);
        }
} 
```

通过日志，我看到了所有数据的一致性。不幸的是，我收到了一个约束异常 (19)。就像 CoreData 尝试再次保存 Mother 对象一样。
有人可以看到代码中的错误在哪里？

谢谢！

```
@class Mother;

@interface Child : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) Mother *mother;

@end 
```

* * *

```
@class Child;

@interface Mother : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSSet *children;
@end

@interface Mother (CoreDataGeneratedAccessors)

- (void)addChildrenObject:(Child *)value;
- (void)removeChildrenObject:(Child *)value;
- (void)addChildren:(NSSet *)values;
- (void)removeChildren:(NSSet *)values;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:00:01.290

与其设置子托管对象的母属性，不如将子添加到母托管对象的子集。但请注意，您不能简单地获取对集合的引用并添加它，您需要使用适当的方法。

假设您正确设置模型，Mother 托管对象应该有一个类似于 addChildObject: 或 addChildrenObject: 的方法。

所以在代码中会看起来沿着以下几行：

```
Mother *mother=[fetchResults objectAtIndex:0];
NSLog(@"mother:  %@, mother);
[mother addChildrenObject: child];
NSLog(@"Mother: %@", child.mother.mother_desc); 
```

请注意，我对您原来的 NSLog 语句进行了更正。您实际上是在要求类的描述，而不是子对象的实例。

无论哪种方式，当使用 Mother 托管对象的方法将项目添加到其子集时，Core data 也会设置孩子的母亲属性的反向关系。

祝你好运。

蒂姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T21:10:28.353

我发现了问题：

在表 zchild 中，我在不使用 CoreData 的情况下添加了记录。

This cause the table z_primarykey (a table auto generated by CoreData) was not updated. In the specific, there is a column "z_max" that must contains the next id to use for the next insertion. In my case those z_max are equals to the id of child already in table and that's the constraint violation.

# vim - 如何使用 vim 键绑定在 Sublime Text 2 中插入垂直文本列？

> ID：10727561
> 
> 赞同：12
> 
> 时间：2012-05-23T20:45:21.923
> 
> 标签：vim, sublimetext2

如何使用 vim 键绑定插入垂直文本列并在 Sublime Text 2 中缩进？

[![Vim 中的垂直文本选择](../Images/38635a54e7b28dc58ab2f0016f318e5f.png)](https://yannesposito.com/Scratch/en/blog/Learn-Vim-Progressively/)
[（来源：[yannesposito.com](http://yannesposito.com/Scratch/img/blog/Learn-Vim-Progressively/rectangular-blocks.gif)）]

我看过[Sublime Text 2 Column Selection Docs](https://www.sublimetext.com/docs/2/column_selection.html)，展示了如何使用`Ctrl`++ ，但是是否可以使用 vim 快捷方式做同样的事情？`Shift``Up`

我[在 Vintage Mode 中使用 Sublime](https://www.sublimetext.com/docs/2/vintage.html)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T17:10:18.130

`Shift`这有点繁琐和额外的击键，但它是可能的：在执行标准 VIM +之前，您只需将选择拆分为多个光标`I`

所以整个例程（在 Mac 上）是：

1.  `V/v`使用+ 动作键选择块

2.  `Command``Shift`+`L`

3.  `V/v`退出视觉模式

4.  您可以移动、插入等多个光标！

* * *

**或者，**您可以做我所做的并通过将 Sublime 的`Shift`++`Control`箭头键绑定更改为`Shift`++`Control`运动键来采用混合方法。

```
[
    { "keys": ["ctrl+shift+j"], "command": "select_lines", "args": {"forward": true} },
    { "keys": ["ctrl+shift+k"], "command": "select_lines", "args": {"forward": false} }
] 
```

`Shift`++`Control`与`K`OS X 的内置“杀死所有行”绑定冲突，但 ST 绑定会覆盖这些绑定，无论如何你都不应该使用那个......它来自 Emacs ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T18:53:28.150

如果您有鼠标，则可以使用鼠标中键单击并拖动以进行视觉块，尽管我从未在 ST2 复古模式中找到用于视觉块的键盘命令。

# c - 无法将参数 1 从“const char *”转换为“LPCWSTR”

> ID：10727568
> 
> 赞同：7
> 
> 时间：2012-05-23T20:45:44.857
> 
> 标签：c, winapi, cross-platform

基本上我有一些简单的代码可以为文件做一些事情，我正在尝试将它移植到 Windows。我有一些看起来像这样的东西：

```
int SomeFileCall(const char * filename){
#ifndef __unix__
    SomeWindowsFileCall(filename);
#endif
#ifdef __unix__
    /**** Some unix only stat code here! ****/
#endif
} 
```

该行`SomeWindowsFileCall(filename);`导致编译器错误： `cannot convert parameter 1 from 'const char *' to 'LPCWSTR'`

如何在不更改`SomeFileCall`原型的情况下解决此问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T22:20:49.333

大多数接受字符串的 Windows API 有两个版本：一个接受字符串，一个接受字符串`char *`（`WCHAR *`后者相当于`wchar_t *`）。

`SetWindowText`例如，实际上是一个宏，可以扩展为`SetWindowTextA`(which take `char *`) 或`SetWindowTextW`(which take `WCHAR *`)。

在您的项目中，听起来所有这些宏都引用了 -W 版本。这由`UNICODE`预处理器宏（如果您在 Visual Studio 中选择“使用 Unicode 字符集”项目选项定义）控制。（Microsoft 的一些 C 和 C++ 运行时库函数也有 ANSI 和宽版本。您获得哪一个由同样`_UNICODE`由该 Visual Studio 项目设置定义的同名宏选择。）

通常，-A 和 -W 函数都存在于库中并且可用，即使您的应用程序是针对 Unicode 编译的。（也有例外；一些较新的功能仅在“宽”版本中可用。）

如果您的 a`char *`包含正确 ANSI 代码页中的文本，您可以显式调用 -A 版本（例如，`SetWindowTextA`）。-A 版本通常是包装器，它们制作字符串参数的宽字符副本并将控制权传递给 -W 版本。

另一种方法是制作您自己的字符串的宽字符副本。您可以使用[MultiByteToWideChar](http://msdn.microsoft.com/en-us/library/windows/desktop/dd319072(v=vs.85).aspx)做到这一点。调用它可能会很棘手，因为您必须管理缓冲区。如果您可以直接调用 -A 版本，那通常更简单并且已经过测试。但是，如果您的`char *`字符串使用 UTF-8 或用户当前 ANSI 代码页以外的任何编码，您应该自己进行转换。

# 奖金信息

-A 后缀代表“ANSI”，这是单字节代码页字符集的常见 Windows 术语。

-W 后缀代表“Wide”（意味着编码单元比单个字节宽）。具体来说，Windows 使用 little-endian UTF-16 处理宽字符串。MSDN 文档简单地称之为“Unicode”，这有点用词不当。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T20:48:56.270

将您的项目配置为使用 ANSI 字符集。（常规 -> 字符集）

[什么是 TCHAR、WCHAR、LPSTR、LPWSTR、LPCTSTR 等。](http://www.codeproject.com/Articles/76252/What-are-TCHAR-WCHAR-LPSTR-LPWSTR-LPCTSTR-etc)

[typedef const wchar_t* LPCWSTR;](http://msdn.microsoft.com/en-us/library/cc230352%28v=prot.10%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-09-18T10:07:39.793

{project properties->advanced->character set->use multi byte character set} 如果你做了这些步骤，你的问题就解决了

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T20:48:08.033

您在 Unicode 模式下使用 WinApi 进行构建，因此所有字符串参数都解析为宽字符串。最简单的解决方法是将 WinApi 更改为 ANSI，否则您需要使用`wchar_t*`其中的内容创建一个`filename`并将其用作参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-08T06:01:20.753

我可以通过将字符集设置为“使用多字节字符集”[项目属性->配置属性->常规->字符集->“使用多字节字符集”来解决此错误

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T21:01:54.867

不确定您使用的是什么编译器，但在 Visual Studio 中，您可以指定默认的 char 类型，无论是 UNICODE 还是多字节。在您的情况下，听起来好像 UNICODE 是默认值，因此最简单的解决方案是检查确定默认 char 类型的特定编译器上的开关，因为它可以为您节省一些工作，否则您最终会添加代码来来回转换UNICODE 可能会增加不必要的开销，而且可能是额外的错误来源。

# jquery - jQuery UI 缩放效果动画边界在动画期间保持静态

> ID：10727569
> 
> 赞同：0
> 
> 时间：2012-05-23T20:45:48.050
> 
> 标签：jquery, jquery-ui

当您单击该框时，它会缩小，只有在它完全消失后，其他框才会移动到它的位置。是否可以改变这种行为，使框开始与按比例缩小的元素大小成比例地移动，从而使过渡看起来更自然？

[http://jsfiddle.net/XuDxR/](http://jsfiddle.net/XuDxR/)

```
<div id="d0">AAAAAA</div>
<div id="d1">AAAAAA</div>
<div id="d2">AAAAAA</div>
<div id="d3">AAAAAA</div>
<div id="d4">AAAAAA</div>​

$('div').on('click', function (e) {
    $(this).effect("scale", {
        mode: 'hide', easing: 'easeOutBounce'
    }, 500);
});
​

div
{
display:inline-block;
    border:1px solid black;
}​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:55:08.900

试试这个：

```
$(this).animate({ width:0,height:0},  
                {
                  duration:500,
                  easing:'easeOutBounce',
                  complete:function(){
                      $(this).css('display','none');
                  }
                }
); 
```

# jquery - 删除带有两个变量Jquery AJAX并确认的mysql行

> ID：10727570
> 
> 赞同：0
> 
> 时间：2012-05-23T20:46:01.280
> 
> 标签：jquery, mysql, sql, ajax, user-interface

我什至不是 javascript 的新手，所以从现在开始你会看到 frankestain 的工作：P。我一直遇到问题，尝试了论坛中找到的所有解决方案，但我似乎无法获得解决方案..

我正在尝试删除具有两列 atomoID 和 upo8ID 的 mysql 行（该表用于将其他表（客户端和案例）中的 id 多链接。

变量 $upo8ID 通过 GET ?recordID=1 在页面中设置。

$atomoID 是一个来自 mysql 的列表（多条记录`<?php echo $row_pelates['AA']`：）

表 'sxes-at-up' 保持它们之间的链接（例如 atomoID = 1 和 upo8ID = 1）

我想在每一行都有一个删除按钮，可以删除两个变量之间的链接。

这是我到目前为止所做的：

php：

```
<?php if(isset($row_pelates['AA'])) { ?>
<table> 
<tr><th>...</th></tr>
<tr><td>...<button id="button3">del</button></tr>
...</table><?php } ?> 
```

jQuery：

```
<script type="text/javascript">
$(document).ready(function() {

$("button#button3").click(function(e) {

e.preventDefault();
$("#dialog3").dialog({
            resizable: false,
            height:170,
            modal: true,
            buttons: {
                "DELETE": function() {

                  var atomoID = $<?php echo $row_pelates['AA']; ?>;
                  var upo8ID = $("#upo8ID").val();
                  var parent = $(this).closest('tr');
                  $.ajax({
                  type: 'get',
                  url: 'delete.php',
                  data: { atomoID: '$atomoID', upo8ID: '$upo8ID' },
                  dataType: "json",
                  beforeSend: function() {
                     parent.animate({'backgroundColor':'#fb6c6c'},300);
                  },
                  success: function() {
                  parent.fadeOut(300,function() {
                  parent.remove();
             });
         }
     });

                    $( this ).dialog( "close" );
                },
                "CANCEL": function() {
                    $( this ).dialog( "close" );
                }
            }
        });

    });

});
</script> 
```

对话框：

```
<div id="dialog3" title="Διαγραφή επαφής" style="display: none;">
    <p>Are you sure you want to delete?</p>
</div> 
```

和 delete.php

```
<?php include("includes/init.php"); ?>

<?php
$atomoID = $_POST[atomoID];
$upo8ID = $_POST[upo8ID];

if (isset($_POST['atomoID'])) {    
   $query = "DELETE FROM sxes-at-up WHERE atomoID = $atomoID AND upo8ID = $upo8ID";

    $result = mysql_query($query);
    if (!$result) die('Invalid query: ' . mysql_error());
    echo "deleted!";
}
?> 
```

我现在有很多错误，但我达到了我目前的限制:(有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T07:07:09.223

我在 delete.php 中有一些错误现在它可以工作了，现在我唯一的问题是我无法使用 jquery 从数组发送数据，例如：我把

```
<?php $atomoID= $row_pelates['AA']?> 
```

`$row_pelates['AA']`表格中显示的数组在哪里 ，

但是单击确认对话框仅获取数组的第一个数字并将其发送到 delete.php

有没有办法在表的每一行中放置一个链接，它将获取正确的数字并将其与 jquery-ajax 一起发送到删除 php？

# c# - 在连接字符串中指定 DB2 查询的模式/实例

> ID：10727575
> 
> 赞同：3
> 
> 时间：2012-05-23T20:46:22.697
> 
> 标签：c#, db2

我正在尝试将默认架构/实例指定为连接字符串（或特定命令）的一部分，因此它不需要成为查询的一部分。

```
OdbcConnection conn = new OdbcConnection("Driver={IBM DB2 ODBC DRIVER}; Database=myDB; Hostname=myHostName; Port=myPort; Protocol=TCPIP; Uid=myID; Pwd=myPW;");
OdbcCommand comm = new OdbcCommand("select count(*) from customers", conn);
conn.Open();
var value = comm.ExecuteScalar();
conn.Close(); 
```

不幸的是，这失败并出现错误：

> 错误 [42S02] [IBM][CLI 驱动程序][DB2] SQL0204N **myID** .customers 是未定义的名称。SQLSTATE=42704。

请注意，它在架构/实例应该在的地方使用**myID 。**如果我明确指定架构/实例：

```
OdbcCommand comm = new OdbcCommand("select count(*) from mySCHEMA.customers", conn); 
```

它按预期工作。我想指定`mySCHEMA`为连接字符串的一部分，类似于使用 MS SQL Server 时的“初始目录”。

经过一堆实验和谷歌搜索，我似乎无法弄清楚。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:26:17.500

哇，这个很明显。我只需要`CurrentSchema=mySCHEMA`在连接字符串中。

[出于某种原因，我在通过http://www.connectionstrings.com/ibm-db2](http://www.connectionstrings.com/ibm-db2)工作后没有立即连接那个点（尝试了各种变体，如 Schema、Default Schema 等）。希望这对将来的某人有所帮助...

# python - 获取 Blobstore 密钥

> ID：10727580
> 
> 赞同：2
> 
> 时间：2012-05-23T20:46:34.063
> 
> 标签：python, google-app-engine, blobstore

我正在阅读有关 Google App Engine 中的 Blobstore 的信息。下面的代码来自示例文档。用户选择要上传的文件并单击提交后，如何将密钥放入 javascript 变量中？我可以在页面上显示它，但我只想保留它以供以后使用。显然，我是 Web 编程的新手。

```
#!/usr/bin/env python
#

import os
import urllib
from google.appengine.ext import blobstore
from google.appengine.ext import webapp
from google.appengine.ext.webapp import blobstore_handlers
from google.appengine.ext.webapp.util import run_wsgi_app

class MainHandler(webapp.RequestHandler):
  def get(self):
    upload_url = blobstore.create_upload_url('/upload')
    self.response.out.write('<html><body>')
    self.response.out.write('<form action="%s" method="POST" enctype="multipart/form-data">' % upload_url)
    self.response.out.write("""Upload File: <input type="file" name="file"><br> <input type="submit"
    name="submit" value="Submit"> </form></body></html>""")

class UploadHandler(blobstore_handlers.BlobstoreUploadHandler):
  def post(self):
    upload_files = self.get_uploads('file')  # 'file' is file upload     field in the form
    blob_info = upload_files[0]
    self.response.out.write('<html><body>')
    self.response.out.write(str(blob_info.key()))
    self.response.out.write('</body><html>')

def main():
  application = webapp.WSGIApplication(
    [('/', MainHandler),
     ('/upload', UploadHandler),
    ], debug=True)
  run_wsgi_app(application)

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:42:52.847

你可以这样做：

```
self.response.out.write("""
<html>
<script>
var blobKey = "%s";
</script>
<body>
...
</body>
</html>""" % (blob_info.key(),) 
```

# ios - 背景音频和 Cordova 1.7

> ID：10727587
> 
> 赞同：1
> 
> 时间：2012-05-23T20:47:17.460
> 
> 标签：ios, cordova

我想在使用 Cordova 1.7 (PhoneGap) for iOS 开发的应用程序的后台播放流式音频。我按照 Joel Dare 网站上的指南启动并运行了流媒体，但他的后台播放技术不起作用，我假设这是因为他使用的是旧版本的 PhoneGap 作为示例。有人可以提供一种使用 1.7 实现此目的的方法吗？

谢谢！

# android - 使用两个 .so 文件启动项目时崩溃

> ID：10727589
> 
> 赞同：1
> 
> 时间：2012-05-23T20:47:30.913
> 
> 标签：android, build, android-ndk, apk

我尝试构建我的项目，它有两个 .so 文件： libTheGame.so liblua.so 两者都在 apk 中，但是当我启动它时项目崩溃：

> 原因：java.lang.IllegalArgumentException：无法加载本机库：/data/data/com.piotrekb.theGame/lib/libTheGame.so

我可以用两者来构建和午餐项目，但没有将lua库添加到TheGame：/但是当我添加时

```
LOCAL_SHARED_LIBRARIES := lua 
```

崩溃发生：/

这是我的 android.mk：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)
LOCAL_ARM_MODE  := arm
LOCAL_MODULE    := lua
LOCAL_SRC_FILES := ./Libs/lua-5.2.0/src/llex.c \
./Libs/lua-5.2.0/src/lapi.c \
./Libs/lua-5.2.0/src/loadlib.c \
./Libs/lua-5.2.0/src/lvm.c \
./Libs/lua-5.2.0/src/lundump.c \
./Libs/lua-5.2.0/src/lauxlib.c \
./Libs/lua-5.2.0/src/lparser.c \
./Libs/lua-5.2.0/src/lgc.c \
./Libs/lua-5.2.0/src/lobject.c \
./Libs/lua-5.2.0/src/lstrlib.c \
./Libs/lua-5.2.0/src/lbaselib.c \
./Libs/lua-5.2.0/src/ldebug.c \
./Libs/lua-5.2.0/src/lmem.c \
./Libs/lua-5.2.0/src/ltable.c \
./Libs/lua-5.2.0/src/loslib.c \
./Libs/lua-5.2.0/src/ldo.c \
./Libs/lua-5.2.0/src/ltablib.c \
./Libs/lua-5.2.0/src/liolib.c \
./Libs/lua-5.2.0/src/ldump.c \
./Libs/lua-5.2.0/src/ldblib.c \
./Libs/lua-5.2.0/src/lstate.c \
./Libs/lua-5.2.0/src/lctype.c \
./Libs/lua-5.2.0/src/lcode.c \
./Libs/lua-5.2.0/src/lcorolib.c \
./Libs/lua-5.2.0/src/lzio.c \
./Libs/lua-5.2.0/src/lmathlib.c \
./Libs/lua-5.2.0/src/lbitlib.c \
./Libs/lua-5.2.0/src/ltm.c \
./Libs/lua-5.2.0/src/lstring.c \
./Libs/lua-5.2.0/src/lopcodes.c \
./Libs/lua-5.2.0/src/linit.c \
./Libs/lua-5.2.0/src/lfunc.c  
LOCAL_LDLIBS    := -lm 
LOCAL_EXPORT_C_INCLUDES := $(LOCAL_PATH)/include
include $(BUILD_SHARED_LIBRARY)

include $(CLEAR_VARS)
LOCAL_C_INCLUDES := -I$(LOCAL_PATH)/Libs/cml-1_0_2 -I$(STLPORT_BASE)/stlport
LOCAL_MODULE    := TheGame

LOCAL_SRC_FILES :=  ./UISystem/UISystem.cpp ./ScriptSystem/ScriptSystem.cpp ./World3D/World3D.cpp ./ResourceSystem/ResourceSystem.cpp ./Renderer/Image.cpp \
 ./Renderer/Model3D.cpp ./LevelSystem/LevelSystem.cpp ./Renderer/ShaderProgram.cpp ./Common/Common.cpp ./Common/Engine.cpp ./Common/InDataBunch.cpp \
 ./Common/OutDataBunch.cpp ./Input/Input.cpp ./Game/Game.cpp ./Renderer/GL20Renderer.cpp \
 ./EntitySystem/EntitySystem.cpp TheGame.cpp 
LOCAL_LDLIBS    := -lm -llog -landroid -lGLESv2 -lEGL
LOCAL_SHARED_LIBRARIES := lua ##this line causes crash
LOCAL_STATIC_LIBRARIES := android_native_app_glue
LOCAL_CFLAGS+=$(LOCAL_C_INCLUDES)
include $(BUILD_SHARED_LIBRARY)
$(call import-module,android/native_app_glue) 
```

你知道我该如何处理这个：/？我研究了类似的问题，但它们对我没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:20:04.810

我有非常相似的问题。最后最终在单独的 mk 文件中编译库。

我认为这个答案可能会对您有所帮助。[Android NDK 链接](https://stackoverflow.com/questions/10593987/android-ndk-linking/10615769#10615769)

# javascript - 关于如何更新导航代码以隐藏和显示隐藏 div 的建议

> ID：10727592
> 
> 赞同：1
> 
> 时间：2012-05-23T20:47:35.520
> 
> 标签：javascript, jquery, html

我目前有一个列表，其中包含一个隐藏/显示隐藏 div 的特定链接。单击链接时，将删除并添加“活动”类，并检查隐藏的 div 以查看它是可见的还是隐藏的，并相应地隐藏/显示。这一切正常，但是，有一个问题。当我单击 Square 时，我想显示 #square，但是当我再次单击它时，我想隐藏 #square 但因为我正在检查 .active，所以无法完成。任何人都可以就如何更新代码提供任何建议以实现这一目标？

**JS**

```
$(document).ready(function(){

    var square = $('#square'),
        test = $('#test');

    square.hide();

    test.find('a').on('click', function(e){

        if( !$(this).hasClass('active') ){

            if ( square.is(':visible') ){
              square.hide();
            }

            var id = $(this).data('id');

            test.find('a').removeClass('active');
            $(this).addClass('active');

            if( id === 'square' ){
              square.show();
            }

        }

        e.preventDefault();
    });        

});​ 
```

**HTML**

```
<ul id="test">
<li><a href="#">Triangle</a></li>
<li><a href="#" data-id="square">Square</a></li>
<li><a href="#">Circle</a></li>
</ul>

<div id="square"></div>​ 
```

小提琴：http: [//jsfiddle.net/xBuUY/](http://jsfiddle.net/xBuUY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:58:19.317

移动这段代码 -- if ( square.is(':visible') ){ square.hide(); 在 hasClass('active') 检查之外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:00:53.337

你的逻辑可以被简化，你想要切换`square`而不考虑类，所以我已经`square`在类测试之外删除了切换。[在这里](http://jsfiddle.net/xBuUY/2/)试试这个小提琴

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:05:06.813

我为你的小提琴做[了一个叉子](http://jsfiddle.net/drublic/Wd5Ha/2/)。除了检查哪个链接应该处于活动状态之外，我已经移动了测试方块是否应该可见的块。已`#square`切换，并且不仅显示了当它已经处于活动状态时它被隐藏的哪些保证。只需测试小提琴。

除此之外，我优化了事件处理程序：它现在使用委托，这比每个链接上的链接处理程序更快。防止链接的冒泡`e.stopPropagation()`。出于性能原因，我在调用任何其他方法或其他任何方法之前添加了它。

# ios - iOS Amazon S3 下载大文件

> ID：10727594
> 
> 赞同：3
> 
> 时间：2012-05-23T20:47:37.813
> 
> 标签：ios, debugging, amazon-s3, amazon-web-services

我对 Amazon S3 很陌生，我很难从 S3 下载大文件。

我每次都成功下载了一个 35MB 的文件，但是当文件的大小真的很大，大约 500 MB - 1.7GB 时，应用程序就会崩溃。

在模拟器上尝试时，我会在下载大约 1GB 后出现无法分配区域错误。

所以我在设备上试了一下。现在它似乎只是在随机时间崩溃并且

设备中没有崩溃报告，因此我在调试这个问题时遇到了问题。

一开始我以为是设备，甚至是模拟器。但我不太确定。

有人提到 S3 框架偶尔会随机超时下载大文件。会是这样吗？

我通过打开一个寻找到最后的数据文件来构建文件，添加数据，然后关闭文件直到下载完成。

我不确定如何调试这个问题。

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T18:16:38.810

我是适用于 iOS 的 AWS 开发工具包的维护者。我们最近修补了 S3GetObjectResponse 以允许将数据直接流式传输到磁盘，而无需将响应数据保存在内存中。

[S3GetObjectResponse.m](https://github.com/amazonwebservices/aws-sdk-for-ios/blob/4bdf4a9dc838d2ed63cc4732865894af3a39e9ed/src/Amazon.S3/Model/S3GetObjectResponse.m)

要启用此功能，您只需在创建请求时设置流：

```
NSOutputStream *outputStream = [[[NSOutputStream alloc] initToFileAtPath:FILE_NAME append:NO] autorelease];
[outputStream open];
S3GetObjectRequest *getObjectRequest = [[[S3GetObjectRequest alloc] initWithKey:FILE_NAME withBucket:BUCKET_NAME] autorelease];
getObjectRequest.outputStream = outputStream;
[s3 getObject:getObjectRequest]; 
```

**更新**：我们在 AWS 移动开发人员博客中添加了一篇关于[使用适用于 iOS 的 AWS 开发工具包下载大文件](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCwQFjAA&url=https://mobile.awsblog.com/post/TxJFT163EJ18CA/Downloading-Large-Files-from-Amazon-S3-with-the-AWS-SDK-for-iOS&ei=SL7uUfjLIcviyAG534CYCw&usg=AFQjCNGOkAikgJOqYWIThr6tMg4x6slWKg&sig2=criniYUdT9WINhz9YTVyNw&bvm=bv.49641647,d.aWc)的帖子，其中包括此信息以及其他提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T09:32:25.573

S3GetObjectRequest 具有 NSMutableData* 主体，其中附加了它下载的所有数据。

对于大文件，随着下载的进行，数据会不断附加，并且超过了 90MB 的 VM 限制，然后应用程序被 iOS 杀死。

快速而肮脏的解决方法是创建自己的 S3GetObjectRequest 和 S3GetObjectResponse 类。AWS 框架根据请求的类名称实例化响应（请求的类名称没有最后 7 个字符“请求”并附加“响应”，并尝试实例化该名称的新类）。

然后覆盖**-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data**以一直释放正文。

这是一个快速而肮脏的修复，因为您仍然有恒定的数据分配、附加然后释放。但是当你处于紧要关头时它会起作用。对于我下载 150-700mb 文件的使用情况，这个简单的 hack 将应用程序的内存使用量平均保持在 2.55mb，+/- 0.2mb。

正如 ASIHTTP 库的作者所说，它不再被维护。

请求 - LargeFileS3GetObjectRequest.h

```
@interface LargeFileS3GetObjectRequest : S3GetObjectRequest
@end 
```

请求 - LargeFileS3GetObjectRequest.m

```
@implementation LargeFileS3GetObjectRequest
@end 
```

响应 - LargeFileS3GetObjectResponse.h

```
@interface LargeFileS3GetObjectResponse : S3GetObjectResponse
@end 
```

响应 - LargeFileS3GetObjectResponse.m

```
@implementation LargeFileS3GetObjectResponse

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    // allow original implementation to send data to delegates
    [super connection:connection didReceiveData:data];

    // release body and set it to NULL so that underlying implementation doesn't
    // append on released object, but instead allocates new one
    [body release];
    body = NULL;
}
@end 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T22:40:09.870

您可能希望通过 ASIHTTPRequest 将数据流式传输到您的应用程序

[http://allseeing-i.com/ASIHTTPRequest/S3](http://allseeing-i.com/ASIHTTPRequest/S3)

```
NSString *secretAccessKey = @"my-secret-access-key";
NSString *accessKey = @"my-access-key";
NSString *bucket = @"my-bucket";
NSString *path = @"path/to/the/object";

ASIS3ObjectRequest *request = [ASIS3ObjectRequest requestWithBucket:bucket key:path];
[request setSecretAccessKey:secretAccessKey];
[request setAccessKey:accessKey];
[request startSynchronous];
if (![request error]) {
    NSData *data = [request responseData];
} else {
    NSLog(@"%@",[[request error] localizedDescription]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-07T08:24:19.480

```
/* Set up the Amazon client */
_s3 = [[AmazonS3Client alloc] initWithAccessKey:k_Amazon_ACCESS_KEY_ID withSecretKey:k_Amazon_SECRET_KEY];
_s3.endpoint = [AmazonEndpoints s3Endpoint:SA_EAST_1];

dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_async(queue, ^{

    /* Open a file stream for the download */
    NSOutputStream *outputStream = [[NSOutputStream alloc] initToFileAtPath:[DOCUMENTS_DIRECTORY stringByAppendingPathComponent:k_Amazon_Video_Local_File_Name] append:NO];
    [outputStream open];

    /* Set up the s3 get object */

    S3GetObjectRequest *getVideoRequest = [[S3GetObjectRequest alloc] initWithKey:k_Amazon_Video_Path withBucket:@""];

    /* Set the stream */

    getVideoRequest.outputStream = outputStream;

    /* Get the response from Amazon */

    S3GetObjectResponse *getObjectResponse = [_s3 getObject:getVideoRequest];

    dispatch_async(dispatch_get_main_queue(), ^{

        if(getObjectResponse.error != nil)
        {
            NSLog(@"S3 Error: %@", getObjectResponse.error);
        }
        else
        {
            NSLog(@"S3 - Video download complete and successful");
            [[NSUserDefaults standardUserDefaults] setBool:YES forKey:k_Amazon_Video_Downloaded];
        }

        [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];

    });
}); 
```

# android - Sqlite 数据库崩溃

> ID：10727596
> 
> 赞同：1
> 
> 时间：2012-05-23T20:47:53.740
> 
> 标签：android, sqlite, listview

有没有办法防止 sqlite db 崩溃？我有一个包含项目的列表视图。当您单击按钮时，所有项目都保存在数据库中。但是当列表中有很多产品并且您在保存按钮上单击非常快时，应用程序会冻结。当我之后检查我的数据库时，所有项目都会被保存多次。

有人知道答案吗？

代码：使用 isProdAlreadyFavorite 我检查数据库是否已经有一个带有 id 的条目...当您单击按钮时，他执行此功能..

```
public void addFavProducten(ArrayList<Product> producten) {
    db = this.getWritableDatabase();

    db.beginTransaction();
    try {
        for (Product product : producten) {
            if (!isProdAlreadyFavorite(product.getProductid())) {
                ContentValues cv = new ContentValues();
                cv.put(Constanten.FAV_PROD_COLUMN_PRODUCTID,
                        product.getProductid());
                db.insert(Constanten.TABLE_FAVPROD, null, cv);
            }
        }
        db.setTransactionSuccessful();
    } catch (Exception e) {
        db.endTransaction();
    } finally {
        db.endTransaction();
        db.close();
    }
} 
```

# java - Spring security openId 支持和用户取消身份验证

> ID：10727597
> 
> 赞同：5
> 
> 时间：2012-05-23T20:47:58.563
> 
> 标签：java, jakarta-ee, spring-security, openid, single-sign-on

我正在尝试处理在通过 openId 提供程序成功进行身份验证后发现我的数据库中没有与用户 openId 标识符关联的帐户的情况。

你能告诉我应该如何处理这种情况吗？现在，我正在显示注册表单并要求用户创建一个帐户。但是，我对用户身份验证状态有疑问，他现在被视为已通过 Spring SecurityContext 类进行身份验证。

在重定向到“注册新用户页面”之前，如何在控制器操作中取消用户身份验证？这种方法是一种好方法还是我应该以其他方式来做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T18:11:38.020

好的，因此 Samuel 的帖子中提到的将身份验证与授权分开确实很有帮助。但是仍然有很多陷阱，我发现取消身份验证仍然是必须的，因为在春季没有简单的方法可以向用户添加新角色。所以最简单的方法是强制用户再次登录，让spring在登录时处理角色分配。

为了在 Spring Security 中取消对**用户**的身份验证，您必须调用：

```
SecurityContextHolder.clearContext(); 
```

作为替代方案，您可以在 UserDetailsS​​ervice 实现中抛出异常（见下文）。它的缺点是您会取消用户身份验证并丢失用户上下文数据，因此在创建新本地帐户的过程中无法将新用户帐户与 openid 帐户匹配。并且您必须在用户登录后使用传统的用户名和密码匹配这些帐户。我的解决方案是在创建新帐户后立即取消用户身份验证。

为了授予用户角色（特权），您必须覆盖 UserDetailsS​​ervice，以防有人发现这很有用，这是我的实现：

```
public final class MyUserDetailsService implements UserDetailsService {
    private final UsersDao usersDao;

    @Autowired
    public UserDetailsServiceImpl(final UsersDao usersDao) {
        this.usersDao = usersDao;
    }

    @Override
    public UserDetails loadUserByUsername(final String username) {      
            UserEntity user = usersDao.getUserByOpenIdIdentifier(username);
            if (user == null) {
                    // there is no such user in our db, we could here throw
                    // an Exception instead then the user would also be deuthenticated 
                    return new User(username, "", new ArrayList<GrantedAuthority>());
            }

            //here we are granting to users roles based on values from db
            final Collection<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();
            authorities.add(new SimpleGrantedAuthority(user.getUserType().toString()));

            final UserDetails result = new User(username, "", authorities);

            return result;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:08:29.490

我认为您可能混合了两个概念：**身份验证**和**授权**。身份验证是知道用户是谁，授权是使用访问某个功能的资源的权利。

在 Spring Security 中，这两个概念是由**authentication-manager**和**access-decision-manager**实现的。

用户在您的数据库中不存在的事实并不是拒绝他的理由是身份：没有取消身份验证！但是经过身份验证可以成为访问决策管理中的一个标准。示例：AuthenticatedVoter。

您不应该接触身份验证，而是自定义 access-decision-manager 以应用以下规则：

*   存在于您的数据库中的用户可以访问除帐户创建功能之外的所有内容
*   数据库中不存在的用户只能访问帐户创建功能。

这都是关于访问管理，而不是身份验证。

阅读更多[http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html#ns-access-manager](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/ns-config.html#ns-access-manager)

PS：spring security的文档并不详尽，但是源码可读性很强。我的建议是检查一下并查看您需要自定义的元素的实现。

# maven-3 - 在 Maven 3 pom.xml 中正确添加存储库

> ID：10727598
> 
> 赞同：2
> 
> 时间：2012-05-23T20:48:01.887
> 
> 标签：maven-3

每次我用 Mavent 构建东西时，我都在为所需的 Maven 工件搜索合适的仓库而苦苦挣扎。现在我正在寻找 spring-aop 的存储库，但找不到。实际的 pom.xml 如下。

我怎样才能正确组装 pom.xml？

谢谢。

```
<repositories>
    <repository>
        <id>springsource-milestone</id>
        <url>http://maven.springframework.org/milestone</url>
    </repository>
    <repository>
        <id>org.springframework.repository.maven</id>
        <name>SpringSource Maven Repository</name>
        <url>http://repository.springframework.org/maven/</url>
        <snapshots>
            <enabled>false</enabled>
        </snapshots>
    </repository>
</repositories>
<dependencies>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>3.8.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>org.springframework.aop</artifactId>
        <version>3.1.1.RELEASE</version>
    </dependency>
</dependencies> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:41:54.783

[该](http://search.maven.org/#artifactdetails%7Corg.springframework%7Cspring-aop%7C3.1.1.RELEASE%7Cjar)工件`spring-aop`存在于 Maven 中央存储库中。

通常大多数已发布的工件都存在于 maven Central 中，无需在`pom.xml`. 您可以为此使用中央存储库的[搜索选项。](http://search.maven.org/)

`spring`在上面的问题中，仅当您正在寻找`milestone`（alpha/beta）版本时，您才需要包含额外的repos。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T06:41:41.713

I would recommend to use a repository manager [instead of added repositories to the pom](http://www.sonatype.com/people/2009/02/why-putting-repositories-in-your-poms-is-a-bad-idea/).

# java - 调用 super() 构造函数应该是构造函数的第一行吗？

> ID：10727601
> 
> 赞同：0
> 
> 时间：2012-05-23T20:48:12.107
> 
> 标签：java, constructor, closures, inner-classes, superclass

调用`super()`构造函数应该是构造函数的第一行吗？如果是，那为什么？为什么在构造函数调用之前不能做一些简单的有限计算，比如构造函数参数计算？

我发现内部类构造函数的情况可以用闭包规范调用：

```
class A {
    class Inner1 {
        Inner1() {
            // do something
        }
    }
}

class B {
    A a1 = new A();
    A a2 = new A();

    class Inner2 extends A.Inner1 {
         Inner2(boolean sel) {
             (sel?a1:a2).super();
         }
    }

} 
```

这个案例表明我们可以为基类构造函数选择封闭实例。为什么选择逻辑应该如此有限？为什么一个人不能写这样的东西

```
if( sel ) {  
    a1.super();
}
else {
    a2.super();
} 
```

**添加**

通过我的问题，我的意思是限制可能类似于以下情况：

```
public class Base {

private final String content;

public Base(String content) {
    this.content = content;
}

public String getContent() {
    return content;
}

}

public class Derived extends Base {

public Derived(String content) {
    super(String.format("Current value of content is %s.", getContent()));
}

} 
```

在后一种情况下，我：

1) 满足`super()`排在第一线的要求

2）违反施工顺序

3) 获得编译器错误“在显式调用构造函数时无法引用实例方法”

那么，为什么我们不能取消“第一线要求”而只依赖最后一个错误呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:52:08.050

是的，`super()`作为构造函数中的第一个调用需要调用。

如此之多，以至于如果您将其排除在外，编译器将（尝试）为您插入调用。要了解其中的原因，您需要了解 Java 设计者的哲学。Gosling 一直属于计算机科学家的阵营，他们认为访问部分初始化的对象是计算机程序中更大的错误来源之一。因此，他设计了一个严格的初始化层次结构来帮助缓解这个问题。你是否同意这个哲学是没有意义的——但重要的是要意识到它在 Java 中的一个重要概念，例如，引用与指针，或真实的有界数组。应该注意的是，即使像 Objective C 这样允许您随时调用初始化的语言，也会竭尽全力强制执行*初始化链接*，除了他们需要通过约定来这样做，而不是严格的语言规则。

我不确定您在示例中试图说明什么 - 但经过多年的 Java 开发后，我怀疑您会发现很多情况下您*确实*需要在调用 super 之前执行逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:53:32.193

在调用该类的构造函数之前，构造函数调用与层次结构中每个类的 super 链接。由于Java中的所有类都继承自对象类，因此每个类都会首先调用Object类的构造函数，原因是对象的内存分配是由Object类的构造函数完成的

# iphone - applicationWillResignActive 时不调用委托

> ID：10727602
> 
> 赞同：1
> 
> 时间：2012-05-23T20:48:14.677
> 
> 标签：iphone, objective-c, delegates, invocation

我有一个推送了一些 ViewController 的应用程序。我登录 JSON 网络服务，获取一些数据并在应用程序处于活动状态时做一些工作。当应用程序关闭或移至后台时，我想注销。

通常这是可行的，我的 JSON 加载器在自己的线程上调用 web 服务，并使用 NSDictionary 和表示调用结果的枚举调用委托。

当我的应用程序使用以下函数发送到后台时，我错过了这个调用：

```
- (void)applicationWillResignActive:(UIApplication *)application
{
    JSONLoader *json = self.startViewController.json;
    NSString *usr_no = [self.startViewController.user.usr_no stringValue];

    //ask json for logoff
    NSString *relativePath = [NSString stringWithFormat:@"users/%@?action=logout", usr_no];
    NSURL *logoutUrl = [NSURL URLWithString:relativePath relativeToURL:kBaseURLString];
    [json loadWithURL:logoutUrl sendResult:kJSONLogoutSuccess];
} 
```

它会注销，但它永远不会到达我必须确保注销成功的代表程序：

```
-(void)updatedDictionaryFromJson:(NSDictionary *)items withResult:(JsonResult)result{

    // do some other stuff..

    if (result == kJSONLogoutSuccess) {
        //user logout was successful
        NSLog(@"got some logout json");
    }
} 
```

为什么应用程序进入后台时没有调用调用，有人有类似的经验吗？应用程序在后台了吗？还是我应该辞职？有什么建议么？

# mysql - 当从 mysql 中的插入后触发器触发更新后触发器时，如何让其工作？

> ID：10727604
> 
> 赞同：0
> 
> 时间：2012-05-23T20:48:23.947
> 
> 标签：mysql, triggers

大家好 ：）！

我会尽量保持它尽可能简单，基本上，我有一个通过 parent_id 列引用自身的表。表中的每一行都可以有一个父级，并且可以通过计数列来计算它有多少个子级。所以基本上我想做的是让触发器在必要时更新每个父行的计数列

问题是当调用插入触发器中的更新操作时会调用更新触发器。然后我得到：

***“一般错误：1442 无法更新存储函数/触发器中的表 'term_taxonomies'，因为它已被调用此存储函数/触发器的语句使用”***。

有任何想法吗？

实际代码：

```
触发器`dbname`.`ai_term_taxonomies`
在 `dbname` 上插入之后。`term_taxonomies`
每一行
开始
    如果 NEW.parent_id 不是 0 那么
        将 term_taxonomies 更新为 termTax SET assocItemCount = (assocItemCount + 1)
        WHERE termTax.term_taxonomy_id = NEW.parent_id;
    万一;

结束$$

创造
触发器`dbname`.`au_term_taxonomies`
更新后`dbname`。`term_taxonomies`
每一行
开始

    如果 NEW.parent_id 不是 OLD.parent_id 那么
        如果 NEW.parent_id 不是 0 那么
            将 term_taxonomies 更新为 termTax SET assocItemCount = (assocItemCount + 1)
            WHERE termTax.term_taxonomy_id = NEW.parent_id;
        万一;
        如果 OLD.parent_id 不是 0 那么
            将 term_taxonomies 更新为 termTax SET assocItemCount = (assocItemCount - 1)
            WHERE termTax.term_taxonomy_id = OLD.parent_id;
        万一;
    万一;

结束$$

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:01:06.190

所有 mysql 触发器都在与触发语句相同的事务中执行。

您希望使用语法进行更新，而不是在基础表上`SET NEW.assocItemCount`执行语句。`UPDATE`

**编辑**：但是，在您的情况下，这是不可能的，因为您正在更新同一个表中的不同行，这是 mysql 触发器中最难做的事情。对不起。

您将不得不更改您的架构。从表中取出，创建一个只包含and`assocItemCount`的新表，并使用查询中的语句更新它。如果查询需要使用您的原始模式，也可以使用连接这两个表的视图来隐藏此详细信息。`term_taxonomy_id``assocItemCount``UPDATE`

或者，如果您的数据库中根本没有`assocItemCount`，您仍然可以在任何查询中计算它，并且您的数据库将比现在更好地标准化。

# .net - IEnumerable.Equals 似乎调用了错误的 Equals 方法

> ID：10727606
> 
> 赞同：5
> 
> 时间：2012-05-23T20:48:39.077
> 
> 标签：.net, vb.net, overloading, equals

我实现了一个 PagedModel 类来包装 IEnumerable，以便为我的 MVC 应用程序中的网格提供分页数据。我使用 Resharper 自动生成的平等代码告诉它检查数据、总行数、页码和页面大小字段。这是课程代码：

```
Public Class PagedModel(Of T)
    Public Property PageSize As Integer
    Public Property PageNumber As Integer
    Public Property ModelData As IEnumerable(Of T)
    Public Property TotalRecords As Integer

    Public Overloads Function Equals(ByVal other As PagedModel(Of T)) As Boolean
        If ReferenceEquals(Nothing, other) Then Return False
        If ReferenceEquals(Me, other) Then Return True
        Return other._PageSize = _PageSize AndAlso other._PageNumber = _PageNumber AndAlso Equals(other._ModelData, _ModelData) AndAlso other._TotalRecords = _TotalRecords
    End Function

    Public Overloads Overrides Function Equals(ByVal obj As Object) As Boolean
        If ReferenceEquals(Nothing, obj) Then Return False
        If ReferenceEquals(Me, obj) Then Return True
        If Not Equals(obj.GetType(), GetType(PagedModel(Of T))) Then Return False
        Return Equals(DirectCast(obj, PagedModel(Of T)))
    End Function

    Public Overrides Function GetHashCode() As Integer
        Dim hashCode As Long = _PageSize
        hashCode = CInt((hashCode * 397) Xor _PageNumber Mod Integer.MaxValue)
        If _ModelData IsNot Nothing Then hashCode = CInt(((hashCode * 397) Xor _ModelData.GetHashCode()) Mod Integer.MaxValue)
        hashCode = CInt((hashCode * 397) Xor _TotalRecords Mod Integer.MaxValue)
        Return CInt(hashCode Mod Integer.MaxValue)
    End Function
End Class 
```

我发现对 Equals(other._ModelData, _ModelData) 的调用很奇特，因为 AFAIK 会检查它是否是同一个对象，而不是包含的项目是否相同。因为无论如何我的测试都失败了，所以我继续将其更改为 other._ModelData.Equals(_ModelData) 但没有成功。然后我在调试时反映到它，发现 other._ModelData.GetType().GetMethod("Equals",{GetType(Object)}).DeclaringType 是 Object！显然，这将导致比较失败。

我想出了一个解决方案来创建一个 EnumerableEquals 方法，该方法比较两个枚举中的每个项目以确认它们是相同的，但它看起来很草率。我可以做些什么来使用正常的 .Equals 方法吗？

```
Private Function EnumerableAreEqual(ByVal a As IEnumerable(Of T), ByVal b As IEnumerable(Of T)) As Boolean
    b = b.ToList() 'avoid multiple query execution
    Return a.All(Function(item) b.Contains(item))
End Function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:05:23.133

您可能想使用[SequenceEqual](http://msdn.microsoft.com/en-us/library/bb348567.aspx)。

```
(new[]{1,2,3}).SequenceEqual(new[]{1,2,3}) // True
(new[]{1,2,3}).SequenceEqual(new[]{3,2,1}) // False
(new[]{1,2,3}).SequenceEqual(new[]{1,2})  // False
(new[]{1,2}).SequenceEqual(new[]{1,2,3})  // False 
```

这将确保两个 IEnumerable 具有相同顺序的相同元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:00:35.770

您不能真正使用“正常” Equals 方法，因为它没有为可枚举定义（即，它不进行元素比较）。你所拥有的很好 (*)，但如果你想使用`Equals`语法，你可以考虑使用 @StriplingWarrior 建议的。

(*) 您的实现并没有真正检查两者是否相等。如果 'a' 的元素比 'b' 多，它将返回 True；此外，如果 'a' 与 'b' 具有相同的元素，但顺序不同，它也会返回 True。如果这对您的场景来说没问题，那就没问题了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T23:25:04.620

通常，对于任意两个任意存储位置`X`和，除非写入，否则`Y`的值`X.Equals(Y)`永远不会改变。虽然不可变集合类型可以覆盖以测试序列相等性，但可变类类型除了测试引用标识（这是默认行为）之外不能做任何事情。`X``Y``Equals``Equals(Object)`

# symfony - Symfony2，如何基于类常量创建下拉菜单？

> ID：10727608
> 
> 赞同：1
> 
> 时间：2012-05-23T20:48:49.013
> 
> 标签：symfony, twig

我有一个具有一些恒定值的类，如下所示：

```
class MyClass
{
    const ACCESS_NONE = 0;

    const ACCESS_SUBMIT = 1;

    const ACCESS_VIEW = 2;

    const ACCESS_APPROVE = 3;
} 
```

如何使用 Symfony2 在我的 twig 文件中创建类似下面的内容：

```
 <select name="someName">
            <option value="ACCESS_NONE">None</option>
            <option value="ACCESS_VIEW">View</option>
            <option value="ACCESS_SUBMIT">Submit</option>
            <option value="ACCESS_APPROVE">Approve</option>
        </select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:08:26.403

正如drupality所说，您可以编写这样的方法：

```
public static function getConstantsChoices()
{
    return array(
        self::ACCESS_NONE => 'None', //or 'ACCESS_NONE' => 'None' if you want the string
        self::ACCESS_VIEW => 'View',
        self::ACCESS_SUBMIT => 'Submit',
        self::ACCESS_APPROVE => 'Approve',
    );
} 
```

如果您使用表格，则可以使用以下选项：

```
->add('name', 'choice', array(
      'choices' => MyClass::getConstantsChoices()
)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:38:04.400

您需要创建具有适当接口的类：

[http://symfony.com/doc/current/reference/forms/types/choice.html#choice-list](http://symfony.com/doc/current/reference/forms/types/choice.html#choice-list)

[接口 API](http://api.symfony.com/master/Symfony/Component/Form/Extension/Core/ChoiceList/ChoiceListInterface.html)

您始终可以手动创建数组，但如果您想在 PHP 中获取常量名称，唯一的方法是反射：

[如何获取常量的名称？](https://stackoverflow.com/questions/1880148/how-to-get-name-of-the-constant)

# php - 基本 PHP $_REQUEST

> ID：10727616
> 
> 赞同：0
> 
> 时间：2012-05-23T20:49:08.203
> 
> 标签：php, datepicker

我对 PHP 相当陌生，以下问题将证明这一点：

我有三个基本`isset()`的它们是：

```
if (isset($_REQUEST['countries'])) {
    echo "yes";
} 
else echo "no";

if  (isset($_REQUEST["depateDate"])) {
    echo "yes";
}
else echo "no";

if (isset($_REQUEST['arrivalDate'])) {
    echo "yes";
}
else echo "no"; 
```

这是表单中的 HTML：

```
<form action="conversionOutputNew.php" method="GET">
    Depart Date:
    <input type="text" id="depateDate" name="depateDate" />

    Arrival Date:
    <input type="text" id="arrivalDate" name="arrivalDate" />

    <select multiple="multiple" name="countries[]" style="height:180px;">
        <option value="United Kingdom">United Kingdom</option>
        <option value="Australia">Australia</option>
</form> 
```

正在发生的事情是正在使用 isset() 验证所选国家/地区，但两个日期都没有。我能想到的唯一可能对日期产生影响的是我有`datepicker()`与之关联的 jQuery UI，但删除它仍然没有帮助。

感谢您的帮助和意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:52:41.903

有可能某些东西会导致发布一个空白值（可能是空格）。由于它们是文本字段，请尝试执行以下操作：

```
if (isset($_REQUEST['departDate']) && !empty($_REQUEST['departDate'])) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:56:03.490

这将测试非空输入并进行验证：

```
// use a suitable format date for preg_match()
if ($arrivalDate = trim($_REQUEST['arrivalDate']) && preg_match('/\d{4}\-\d{2}\-\d{2}/', $arrivalDate)) 
    echo "My arrival date is $arrivalDate";
else
    echo "No valid input"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T20:59:53.643

问题是，在提交表单时，日期已设置（因此，isset 返回 TRUE），但它们是空的。因此，您可以先检查是否为空（使用 empty($variable) php 函数）。

尽管如此，我认为必须设置一些更具体的规则，而不是仅仅依靠 isset。特别是对于日期，您可以使用正则表达式检查特定格式（例如，使用 preg_match 和 /^\d{4}-d{2}-\d{2}$/ 之类的正则表达式（以匹配 YYYY-mm -dd，前面提到的正则表达式可以进一步改进，但这只是一个例子）。

# vb.net - VB.NET 和 LINQ 查询字典

> ID：10727622
> 
> 赞同：3
> 
> 时间：2012-05-23T20:49:30.073
> 
> 标签：vb.net, linq, dictionary

我需要在下面的字典中对 VB.NET 进行简单的 LINQ 查询，但我对这个主题真的很陌生，所以我需要你的帮助。

```
 Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load
        Dim appEnums As New Dictionary(Of Integer, String)

        appEnums.Add(1, "www.eva.com")
        appEnums.Add(2, "www.eva2.com")
        appEnums.Add(4, "www.evanetwork.com")
        appEnums.Add(5, "www.eva3.com")
        appEnums.Add(6, "www.eva4.com")
        appEnums.Add(7, "www.eva5.com")
        appEnums.Add(8, "www.eva6.com")
        appEnums.Add(9, "www.eva1.com")
        appEnums.Add(10, "www.eva7.com")

        Dim startSite As Integer = 1
        Dim mainSite As Integer = 4
        Dim returnSite As Integer = 5
    End Sub 
```

我需要的是在给定这些规则的情况下检索单个网站（字符串类型的字典值）或 NOTHING（如果查询找不到负担得起的结果）：

*   字典键（整数）必须大于 startSite 且不等于 mainSite 或 returnSite（两者都必须从结果中排除）

有什么提示吗？

编辑：感谢到目前为止的回复！我不确定它们是否会起作用，顺便说一句必须测试它们，乍一看有些奇怪。

我自己找到了一个解决方案，并且效果很好（不敢相信），但我认为应该有一种更“优雅”的方式（总是在 vb.net 中）。等待建议:)

```
 Dim resultSite As String

        Try
            resultSite = appEnums.Where(Function(x) x.Key > startSite _
            AndAlso x.Key <> mainSite AndAlso x.Key <> returnSite) _
            .OrderBy(Function(x) x.Key).Select(Function(x) x.Value).First()
        Catch
            resultSite = Nothing
        End Try 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:18:36.723

这是一个稍微精致的 LINQ 语句。

```
Dim resultSite As String =
    appEnums.OrderBy(Function(kvp) kvp.Key)
        .SkipWhile(Function(kvp) kvp.Key <= startSite)
        .Where(Function(kvp) kvp.Key <> mainSite AndAlso kvp.Key <> returnSite)
        .Select(Function(kvp) kvp.Value).FirstOrDefault() 
```

它在两个地方与您的解决方案不同：

*   它`OrderBy`首先使用，以便它可以使用`SkipWhile`
*   它使用`FirstOrDefault`它以避免丑陋的`try/catch`块。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-23T21:06:37.197

当您说单个网站时，您是否只想要符合要求的所有网站中的第一个？

怎么样：

```
dim exclude = new string() {mainSite,returnSite}    

dim result = appEnums.Skip(startSite).Where(function(n) Not exclude.Contains(n.Key)).FirstOrDefault() 
```

# facebook - PhoneGap、Childbrowser 和发布到 Facebook

> ID：10727626
> 
> 赞同：0
> 
> 时间：2012-05-23T20:49:49.270
> 
> 标签：facebook, post, cordova, location, childbrowser

我有一个 PhoneGap 包装的网站，并正在尝试使用 childbrowser 插件来允许某人在 Facebook 上共享链接。链接发布后，我想关闭子浏览器窗口以返回应用程序。

```
cb.onLocationChange = function(loc) { 
    if (loc.indexOf("https://m.facebook.com/profile.php") >= 0) {
        window.plugins.childBrowser.close();
    }
}; 
```

我正在使用 onlocationChange 来检测页面何时更新，但是它没有检测到发布链接和上墙之间的变化。当您在墙上刷新时，childbrowser 将检测到新窗口并正确关闭它。我想找到一种方法来允许 childbrowser 检测 post 事件以关闭窗口，或者类似的方法允许 childbrowser 在不刷新的情况下关闭。

如果可能的话，我也不想添加另一个插件或扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:10:27.947

理想情况下，您需要在每次加载页面时查看完整的 HTML 源代码。我使用自定义版本的 ChildBrowser 插件，使您能够做到这一点（我需要它来执行 Google oAuth2）。即使位置 URL 没有改变，页面的内容也会改变，这可能是您的提示。

## 编辑

我在[GitHub](https://github.com/dda/slavebrowser)上发布了我定制的 CB 插件。

高温高压

# c++ - DwmExtendFrameIntoClientArea 不起作用

> ID：10727627
> 
> 赞同：0
> 
> 时间：2012-05-23T20:49:56.610
> 
> 标签：c++, windows, mfc, aero-glass

我对 WTL 很陌生，这里是我的主对话框的 onCreate 代码

```
int Cwin32_mfcDlg::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CDialogEx::OnCreate(lpCreateStruct) == -1)
        return -1;

    // TODO:  Add your specialized creation code here
    MARGINS mar = {0};
    mar.cyBottomHeight = 100;
    DwmExtendFrameIntoClientArea(m_hWnd,&mar);
    return 0;
} 
```

但是当我尝试编译我的项目时，我得到了这个错误

```
error LNK2019: unresolved external symbol __imp__DwmExtendFrameIntoClientArea@8 referenced in function "public: int __thiscall Cwin32_mfcDlg::OnCreate(struct tagCREATESTRUCTA *)" (?OnCreate@Cwin32_mfcDlg@@QAEHPAUtagCREATESTRUCTA@@@Z) 
```

这是输出：

```
1>------ Build started: Project: win32_mfc, Configuration: Debug Win32 ------
1>Build started 5/24/2012 1:08:43 AM.
1>InitializeBuildStatus:
1>  Touching "Debug\win32_mfc.unsuccessfulbuild".
1>ClCompile:
1>  All outputs are up-to-date.
1>  win32_mfcDlg.cpp
1>ResourceCompile:
1>  All outputs are up-to-date.
1>ManifestResourceCompile:
1>  All outputs are up-to-date.
1>win32_mfcDlg.obj : error LNK2019: unresolved external symbol __imp__DwmExtendFrameIntoClientArea@8 referenced in function "public: int __thiscall Cwin32_mfcDlg::OnCreate(struct tagCREATESTRUCTA *)" (?OnCreate@Cwin32_mfcDlg@@QAEHPAUtagCREATESTRUCTA@@@Z)
1>D:\projects\C++\Projects\Team_projects\Bill\net\ttt\win32_mfc\Debug\win32_mfc.exe : fatal error LNK1120: 1 unresolved externals
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:00.48
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

这是我的 StdAfx.h 代码：

```
// stdafx.h : include file for standard system include files,
// or project specific include files that are used frequently,
// but are changed infrequently

#pragma once

#ifndef _SECURE_ATL
#define _SECURE_ATL 1
#endif

#ifndef VC_EXTRALEAN
#define VC_EXTRALEAN            // Exclude rarely-used stuff from Windows headers
#endif

#include "targetver.h"

#define _ATL_CSTRING_EXPLICIT_CONSTRUCTORS      // some CString constructors will be explicit

// turns off MFC's hiding of some common and often safely ignored warning messages
#define _AFX_ALL_WARNINGS

#include <afxwin.h>         // MFC core and standard components
#include <afxext.h>         // MFC extensions

#include <afxdisp.h>        // MFC Automation classes

#ifndef _AFX_NO_OLE_SUPPORT
#include <afxdtctl.h>           // MFC support for Internet Explorer 4 Common Controls
#endif
#ifndef _AFX_NO_AFXCMN_SUPPORT
#include <afxcmn.h>             // MFC support for Windows Common Controls
#endif // _AFX_NO_AFXCMN_SUPPORT

#include <afxcontrolbars.h>     // MFC support for ribbons and control bars

#include <dwmapi.h>     // DWM APIs

//#ifdef _UNICODE
#if defined _M_IX86
#pragma comment(linker,"/manifestdependency:\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='x86' publicKeyToken='6595b64144ccf1df' language='*'\"")
#elif defined _M_IA64
#pragma comment(linker,"/manifestdependency:\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='ia64' publicKeyToken='6595b64144ccf1df' language='*'\"")
#elif defined _M_X64
#pragma comment(linker,"/manifestdependency:\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='amd64' publicKeyToken='6595b64144ccf1df' language='*'\"")
#else
#pragma comment(linker,"/manifestdependency:\"type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='*' publicKeyToken='6595b64144ccf1df' language='*'\"")
#endif
//#endif 
```

该项目在 MFC 和 Visual Studio 2010 以及 Windows 7 x64 中

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T20:53:20.080

从[`DwmExtendFrameIntoClientArea()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa969512%28v=vs.85%29.aspx)您需要链接到`Dwmapi.lib`.

# php - 富文本消息转换 - php

> ID：10727633
> 
> 赞同：0
> 
> 时间：2012-05-23T20:50:17.820
> 
> 标签：php, html-entities, html-encode, richtext

好的，我一直在用各种编码/解码和 htmlentities() 拉出我的头发，并且必须找到解决方案。我正在处理电子邮件。一些电子邮件如下所示：

该更改详述如下：=0A=0AScott,=0A=0A什么网站...

如何转换 =0A=0A 字符和其他类似字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:55:27.750

```
echo quoted_printable_decode($mailbody); 
```

# python - 来自 osc lib 模块的系统调用

> ID：10727639
> 
> 赞同：0
> 
> 时间：2012-05-23T20:50:40.850
> 
> 标签：python, osc, opensoundcontrol

我正在使用[此处](https://trac.v2.nl/wiki/pyOSC)找到的 OSC 库。我想在收到特定消息时通过 sys.exit() 以编程方式退出程序。

我使用类似以下的东西：

```
oserve = OSC.OSCServer(('localhost', iportarg))
st = threading.Thread(target = oserve.serve_forever)
oserve.addMsgHandler("/logout", logout_handle)

def logout_handle(addr, tags, stuff, source):
    sys.exit() 
```

发出消息 '/logout' 会产生以下错误：

> OSCServer: SystemExit 应来自 localhost:55827 的请求：

有谁知道这是为什么？是否在已被线程锁定的子进程中？似乎 OSC lib/module 不允许我在系统进程仍处于活动状态时发出系统进程。任何想法都会很棒......

谢谢，jml

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:04:22.850

我可以建议一种替代方法，使用标志`done=False`循环，然后通过杀死 st 线程然后退出来进行清理`done`。`True`

```
from gevent import spawn
from gevent.event import AsyncResult
is_done = AsyncResult()
oserve = OSC.OSCServer(('localhost', iportarg))
gl = gevent.spawn(oserve.oserve_forever)
oserve.addMsgHandler("/logout", logout_handle)

def logout_handle():
  global is_done
  is_done.set(True)

terminate_prog = False
while not terminate_prog:
    if is_done.ready():
        terminate_prog = True

st.kill()
sys.exit() 
```

像这样的东西更可取 imo，您可以正确清理资源。

我们正在做的是制作一个两个greenlet都可以与之通信的AsyncResult，主greenlet循环直到它准备好退出监听该异步结果，另一个greenlet有一个钩子，它`logout_handle`最终执行，这表明主greenlet是时候退出了.

# android - 内置安卓相机

> ID：10727642
> 
> 赞同：0
> 
> 时间：2012-05-23T20:50:42.467
> 
> 标签：android, android-camera

我的代码中有什么错误导致这一行中出现 NullPointerException data.getData();

```
Handler handler = new Handler() {

    @Override
    public void handleMessage(Message msg) {
        super.handleMessage(msg);
        pd.dismiss();
        // startActivity(new Intent(LoginActivity.this,
        // CameraActivity.class));
        Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE);

        intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri);
        startActivityForResult(intent,CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
    }
}; 
```

我在线程中使用这个处理程序

并且当捕获图像并使用 onActivityForResult 时会发生异常。

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
if (requestCode == CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE) {
    if (resultCode == RESULT_OK) {
        // Image captured and saved to fileUri specified in the Intent
        Toast.makeText(this, "Image saved to:\n" +
                 data.getData(), Toast.LENGTH_LONG).show();
    } else if (resultCode == RESULT_CANCELED) {
        // User cancelled the image capture
    } else {
        // Image capture failed, advise user
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:31:59.700

检查下面

```
public class Camera extends Activity 
  {
 private static final int CAMERA_REQUEST = 1888;
 private String selectedImagePath;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    Intent cameraIntent = new Intent(ACTION_IMAGE_CAPTURE);
    startActivityForResult(cameraIntent, CAMERA_REQUEST);
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data)
{
    if (resultCode == RESULT_OK) {
        if (requestCode == CAMERA_REQUEST) 
        { 
            Bitmap photo = (Bitmap) data.getExtras().get("data"); 
            ByteArrayOutputStream bytes = new ByteArrayOutputStream();
            photo.compress(Bitmap.CompressFormat.JPEG, 40, bytes);
            Random randomGenerator = new Random();randomGenerator.nextInt();
            String newimagename=randomGenerator.toString()+".jpg";
            File f = new File(Environment.getExternalStorageDirectory()
                                    + File.separator + newimagename);
            try {
                f.createNewFile();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            //write the bytes in file

            try {
                fo = new FileOutputStream(f.getAbsoluteFile());
            } catch (FileNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            try {
                fo.write(bytes.toByteArray());
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
                uri=f.getAbsolutePath(); 
    //this is the url that where you are saved the image
      }

  } 
```

使用**data.getExtras().get("data");**

# javascript - 2 个不同元素的相同外观

> ID：10727644
> 
> 赞同：1
> 
> 时间：2012-05-23T20:50:53.350
> 
> 标签：javascript, jquery, css, jquery-tokeninput

我一直在寻找 jQ 插件，它提供与 StackOverflow 标签相同的结果。使用 Tokeninput 找到了一个。

请查看此链接[http://jsfiddle.net/nXxZW/3/](http://jsfiddle.net/nXxZW/3/)。

现在，看看这个截图：

**铬合金**

![在此处输入图像描述](../Images/0a00e6f6e122f150a7dede05c681b376.png)

**火狐**

![在此处输入图像描述](../Images/2eb26b09708a20f550f8adfdbb3993ec.png)

如您所见，输入文本元素在浏览器上看起来有些不同。

我想要得到的是，`ul`元素的外观`input text`与 CSS 完全相同（我的意思是，宽度、边框、插入阴影等。尝试但无法弄清楚我错过了什么）或插件修改以获得相同的结果在输入文本框中而不是 ul li 结构中（如 Stackoverflow 标签。我认为这有点难以实现。）有什么建议吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:02:52.867

如果它只是您担心的输入字段，请尝试向 mail_credentials 的 CSS 添加宽度、高度和边框属性，如下所示：

```
.mail_credentials{
    padding: 5px 5px 5px;
    margin: 0 15px 10px 20px;
    border: 1px solid #ccc;
    width: 150px;
    height: 14px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:05:59.957

对于两个输入，添加边框：1px solid #ddd; 还有背景：白色；

这将强制输入具有相同的效果

# postgresql - 如何在 heroku 中运行 grails 命令？

> ID：10727648
> 
> 赞同：1
> 
> 时间：2012-05-23T20:51:09.033
> 
> 标签：postgresql, grails, heroku, database-migration

我正在尝试使用 cedar 堆栈将新的 grails 2.0.3 应用程序部署到 heroku。我的应用程序正在使用[数据库迁移插件](http://grails.org/plugin/database-migration)来管理 postgres 模式。在开发中，我可以运行 grails dbm-update 来更新我的模式。在 heroku 中，似乎 grails 不可用。有什么建议么？

我目前的解决方法想法包括尝试从我的本地直接连接到 heroku postgres 并以这种方式运行迁移（不理想，并且不适用于共享数据库），或者可能分叉[heroku grails buildpack](https://github.com/heroku/heroku-buildpack-grails)（似乎过度）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:51:09.707

我已经设法通过直接针对本地机器上的 prod 运行 dbm-update （可以是任何 grails 脚本）来让事情顺利进行。就是这样：

1.  获取您的 heroku pg 实例的凭据。我认为只有使用专用数据库才能做到这一点，而不是共享类型。这可能会随着一些[非常新的 heroku pg 开发](https://postgres.heroku.com/blog/past/2012/5/3/crane_the_new_50_per_month_production_database_/)而改变。

2.  在带有产品详细信息的 datasource.groovy 中创建一个新的环境数据源。我的看起来像：

```
 prodadmin {
        dataSource {
            dbCreate = "none"
            driverClassName = "org.postgresql.Driver"
            dialect = org.hibernate.dialect.PostgreSQLDialect
            url = 'jdbc:postgresql://host:5432/dbname?ssl=true&sslfactory=org.postgresql.ssl.NonValidatingFactory'
            username = 'user'
            password = 'password'
        }
} 

```

有了它，您可以继续使用以下命令在 heroku 中更新您的生产 grails 应用程序的架构：

```
 grails -Dgrails.env=prodadmin dbm-update 

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T00:34:30.550

自动运行功能是为这种情况创建的。请参阅第 4 节中[http://grails-plugins.github.com/grails-database-migration/docs/manual/](http://grails-plugins.github.com/grails-database-migration/docs/manual/)上的“启动时自动运行”部分。

# c# - 下载按钮不显示

> ID：10727650
> 
> 赞同：2
> 
> 时间：2012-05-23T20:51:15.783
> 
> 标签：c#, asp.net, multithreading, dotnetzip

我有一个奇怪的问题..

我正在创建网页的缩略图！我从来没有使用过线程，我有一个问题

我正在使用以下代码

```
protected void GetScreenshot_Click(object sender, EventArgs e)
{
  path = Server.MapPath(FolderID);
  Thread webBrowseThread = new Thread(new ThreadStart(PerformWebBrowseOp));
  webBrowseThread.SetApartmentState(ApartmentState.STA);
  webBrowseThread.Start();
}          

protected void PerformWebBrowseOp()
{
  if(searchedword!='')
  {
    Directory.CreateDirectory(path);
  }

  string path1 = Mypath + "/image.png";
  GeneateScreenshot gn = new GeneateScreenshot();
  Bitmap thumbnail = gn.GenerateScreenshot("http://www.google.com/search?hl=en&q=" + Searchedword, 1024, 768);
  FileStream imageStream = new FileStream(path1, FileMode.Create);
  thumbnail.Save(imageStream, System.Drawing.Imaging.ImageFormat.Png);
  imageStream.Close();
  downloadbutton.Visible=true;
} 
```

现在我的问题是我有一个下载按钮要在创建缩略图时显示..但由于某种原因，下载按钮没有生成或不可见！

我尝试放置在 getscreenshot_click 中，但它甚至在线程开始运行之前和创建缩略图之前就被创建了。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:02:46.620

简短的回答是您不想为网页执行此操作。该网页的设计使得当点击处理程序完成时，它会继续页面生命周期，并且在 ASP 处理完它自己的一堆东西之后，它会将响应发送给客户端。在您的后台线程完成之前，该响应正在发送（或至少已完成，因此无法编辑）。

在 Web 环境中，如果您正在分离另一个线程，您需要假设您将无法在另一个线程中为同一请求编辑任何内容。如果你做的足够快，或者如果你有一个非常慢的服务器，那么它*可能会*工作，但通常不会，而且你永远不能假设它会。

我的猜测是您根本不想创建另一个线程，并且您希望用户等到图像保存后再将控制权返回给用户。

如果接收请求对您来说真的很重要，做一些事情，向用户发送响应，然后在后台线程中发生某些事情后*再次*更新页面，这是可能的，但这是很多工作。（而且真的会从你的服务器中吸走资源。） [这](http://code.msdn.microsoft.com/CSASPNETBackgroundWorker-dda8d7b6/view/SourceCode)是 MSDN 上的一个例子，但我猜在这种情况下它是矫枉过正的，你最好不要打扰。

编辑：根据您的评论，代码需要位于另一个线程中，因为它当前不在 STA 线程中。因此，解决方案是`Join`单击事件处理程序中的该线程，以便在发送响应之前等待它完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T16:03:46.843

解决此问题的最简单方法是使用 webBrowseThread.join() 等到该过程完成，然后说 downloadbutton.visible=true ！

# java - Java：MouseListener、KeyListener 和 PaintComponent 的 JFrame 问题

> ID：10727652
> 
> 赞同：0
> 
> 时间：2012-05-23T20:51:23.960
> 
> 标签：java, jframe, keylistener, paintcomponent, mouselistener

我有一个问题，我的 mouseListener 没有响应。我尝试将 mouseListener 添加到一个对象，将 keyListener 添加到另一个对象，并将paintComponent 添加到另一个对象，然后将所有对象放到 JFrame 上。我的问题是 mouseListener 没有响应，但 keyListener 和 paintComponent 是。这是我的代码：

```
public JFrame frame = new JFrame("JFrame Test");

public static void main(String[]args) {
    new JFrameTest();
}

public JFrameTest() {
    frame.setSize(100, 100);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setResizable(false);
    frame.add(new keys());
    frame.add(new mouse());
    frame.add(new render());
    frame.setVisible(true);
}

@SuppressWarnings("serial")
public class render extends JPanel {
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.fillRect(0, 0, frame.getWidth() / 2, frame.getHeight() / 2);
        repaint();
    }
}

@SuppressWarnings("serial")
public class keys extends JPanel {
    public keys() {
        setFocusable(true);
        addKeyListener(new KeyAdapter() {
            public void keyPressed(KeyEvent e) {
                System.out.println("Key Pressed!");
            }

            public void keyReleased(KeyEvent e) {
                System.out.println("Key Released!");
            }
        });
    }
}

@SuppressWarnings("serial")
public class mouse extends JPanel {
    public mouse() {
        setFocusable(true);
        addMouseListener(new MouseAdapter() {
            public void mousePressed(MouseEvent e) {
                System.out.println("Mouse Pressed!");
            }

            public void mouseReleased(MouseEvent e) {
                System.out.println("Mouse Released!");
            }
        });
    }
} 
```

我确保 mouseListener 和 keyListener 都是 setFocusable(true) 并且 paintComponent 是最后添加的，因此它实际显示。好像我切换了添加 keyListener 对象和 mouseListener 对象的顺序，然后都不起作用。如果您对如何解决它有任何想法，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:00:46.530

我会告诉你问题是什么，JFrame 使用 BroderLayout 作为它的默认布局管理器。因此，当您连续执行 3 次 frame.add() 而不指定添加 JPanel 的位置时，您将连续 3 次覆盖同一个面板。

因此，您添加的最后一件事将在那里。

尝试这个...

```
frame.add(new keys(), BorderLayout.NORTH);
frame.add(new mouse(), BorderLayout.SOUTH);
frame.add(new render(), BorderLayout.CENTER); 
```

顺便说一句，这看起来是一种非常奇怪的编程方式。您最好创建 1 个扩展 JPanel 的类并向其添加键侦听器和鼠标侦听器。并覆盖它的paintComponent() 方法来进行渲染。

# scala - 如何构造 Scala mixin 特征以将返回值转换为扩展类型？

> ID：10727660
> 
> 赞同：0
> 
> 时间：2012-05-23T20:52:08.137
> 
> 标签：scala, type-conversion, mixins

我想混合一个特征，以便我可以使用方法 from 返回我自己的特征类型。例如，

```
> trait M { 
    trait foo {def blah = "foo" }
    def name:foo = { new foo { override def blah = "name"}}}
> trait N extends M { 
    trait bar extends foo {}
    override def name:bar = super.name.asInstanceOf[bar]}
> object t extends N { val baz = name }
> t.name
  java.lang.ClassCastException: M$$anon$1 cannot be cast to N$bar
at N$class.name(<console>:7)
at t$.name(<console>:8)
at t$.<init>(<console>:8)
at t$.<clinit>(<console>)
at .<init>(<console>:10)
at .<clinit>(<console>)
at RequestResult$.<init>(<console>:9)
at RequestResult$.<clinit>(<console>)
at RequestResult$scala_repl_result(<console>)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:616)
at scala.tools.nsc.Interpreter$Request$$anonfun$loadAndRun$1$$anonfun$apply$17.apply(Interpreter.scala:988)
at scala.tools.nsc.Interpreter$Request$$anonfun$l... 
```

我知道我通过使用 OO 以太多的方式考虑这个问题`asInstanceOf`，并且对 Scala 中特征工作方式的基本知识一无所知。我应该如何更改 N 及其子类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T20:57:12.600

`M.name`构造并返回 a `foo`。在`N.name`你打电话`super.name`。由于`super.name`引用`M.name`，`super.name`也构造并返回 a `foo`。然后你拿着它`foo`打电话`.asInstanceOf[bar]`。但这没有任何意义，因为您的代码中没有任何内容构造过 a `bar`，并且虽然 a`bar`是 a `foo`，但 a`foo`不一定是 a `bar`。

如果您真的想`N.name`返回 a `bar`，那么您需要重写`M.name`以便显式构造 a`bar`并返回它。

```
trait N extends M {
  trait bar extends foo {}
  override def name: bar ={
    val f: foo = super.name                // not what we want; it's not a `bar`
    new bar { override def blah = f.blah } // this is actually a `bar`
  }
} 
```

现在我们得到：

```
scala> println(t.name.blah)
name 
```

# android - 如何将 mupdfActivity 转换为片段

> ID：10727665
> 
> 赞同：3
> 
> 时间：2012-05-23T20:52:34.660
> 
> 标签：android, android-activity, fragment, mupdf

我已经在我的项目中成功实现了 mupdf 库。

问题是活动

```
 MuPDFActivity 
```

只显示一个包含 pdf 的窗口。我需要的是将此活动转换为片段，以便我可以同时显示不止一次。

# ruby - 在 Sinatra 中缓存文本文件内容

> ID：10727675
> 
> 赞同：1
> 
> 时间：2012-05-23T20:53:39.387
> 
> 标签：ruby, caching, sinatra

我是 Sinatra 和网络编程的新手，所以使用的一些术语可能不太正确。反正...

我有一个应用程序将 .txt 逐行读取到数组中，然后当您加载 index.html.erb 时，它会随机显示其中一行。我将内容放在文本文件中，而不是直接放入数组中，这样如果我需要添加更多数据，则更容易更新，然后直接添加到数组中并重新部署应用程序。我担心的是它是否在每次加载页面时重新创建数组并重新读取文件。我不知道这种东西在服务器端是如何工作的，或者如何检查它。创建数组的代码如下：

```
before do
  @ways ||= ['']
  if @ways[1].nil?
    File.open('ways.txt', 'r').each_line { |line| @ways << line }
  end
end 
```

然后我的路线：

```
get '/' do
  @way = @ways.sample

  erb :index
end 
```

有没有办法确保这尽可能高效？还是应该完全以其他方式完成？根据 Chrome 开发工具，每页加载传输约 800b。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:26:17.397

您在此处编写的内容确实会在每次请求时将文件读入数组。

*提示：您可以使用`@ways = File.readlines('ways.txt')`*

如果你想缓存这个数组，你可以在应用程序启动时将其作为一个常量，例如：

```
WAYS = File.readlines('ways.txt').map(&:chomp)
get "/" do
  @way = WAYS.sample
  erb :index
end 
```

但是，如果您编辑了文本文件，则需要退出并重新启动服务器。如果您想避免这种情况，您可以在`before`操作中检查文件的修改时间，并且仅在内容发生更改时才更新数组 ( `replace`it)。

*如果您在最后一个建议方面需要帮助，请告诉我，我可以根据需要进行编辑。*

* * *

**编辑**：这是使用常量保存数据并仅在文件更改时重新加载的一种方法：

```
WAYS = { file:'ways.txt', all:[] }
before do
  if WAYS[:updated] != (mtime=File.mtime(WAYS[:file]))
    WAYS[:all].replace File.readlines(WAYS[:file]).map(&:chomp)
    WAYS[:updated] = mtime
  end
end
get "/" do
  @way = WAYS[:all].sample
  erb :index
end 
```

这有点激进——检查每个请求的文件修改时间——但是除了最重的负载或最慢的磁盘之外，性能应该没问题。

另一种解决方案是每隔几分钟启动一个线程以强制检查/更新数组，例如

```
require 'sinatra'

WAYS = { file:'ways.txt', all:[] }
Thread.new do
  loop do
    if WAYS[:updated] != (mtime= File.mtime(WAYS[:file]))
      WAYS[:all].replace File.readlines(WAYS[:file]).map(&:chomp)
      WAYS[:updated] = mtime
    end
    sleep 5 # seconds
  end
end

get '/' do
  WAYS[:all].sample
end 
```

# objective-c - “'BlahDataController' 没有可见的@interface 声明选择器 'aMethod:'”

> ID：10727677
> 
> 赞同：33
> 
> 时间：2012-05-23T20:53:41.993
> 
> 标签：objective-c, xcode, ipad

我的问题的一个简单示例：

“在 BlahDataController.h 中”

```
@interface BlahDataController : NSObject
-(NSString *)aMethod:(NSString *)theString;
@end 
```

“在 BlahDataController.m 中”

```
#import "BlahDataController.h"
@implementation BlahDataController

-(NSString *)aMethod:(NSString *)theString
{
    return @"Something";
}

@end 
```

“在 BobViewController.h 中”

```
@interface BobViewController : NSObject
-(void)aMethodOfSomeSort;
@end 
```

“在 BobViewController.m 中”

```
#import "BobViewController.h"
#import "BlahDataController.h"

@implementation BobViewController

-(void)aMethodOfSomeSort
{
    BlahDataController *blahDataController = [[BlahDataController alloc] init];
    NSLog(@"%@",[blahDataController aMethod:@"Variable"]);
}

@end 
```

在行上“NSLog(@"%@",[blahDataController aMethod:@"Variable"]);" 我收到错误消息：“'BlahDataController' 没有可见的@interface 声明选择器'aMethod:'”

有谁知道为什么会发生这个错误？

-=-=-=-=-=-=-=-=-=-=-

问题是，在我的实际程序中，我有相同的实现，并且它适用于以这种方式创建的数百种方法。但是，每隔一段时间，我就会在新创建的方法上收到此错误。我没有做任何不同的事情。它只是不会承认它是新创造的存在。

-=-=-=-=-=-=-=-=-=-=-

这就是我目前正在解决的问题，虽然我不知道为什么编译器接受这种方式，但不是其他方式：

修改 BobViewController.m：

```
#import "BobViewController.h"
#import "BlahDataController.h"
#import "AnotherDataController.h"

@implementation BobViewController

-(void)aMethodOfSomeSort
{
    BlahDataController *blahDataController = [[BlahDataController alloc] init];
    AnotherDataController *anotherDataController = [[AnotherDataController alloc] init];
    [anotherDataController fixedMethod:blahDataController theString:@"Variable"];
}

@end 
```

“在 AnotherDataController.h 中”

```
@interface AnotherDataController : NSObject
-(void)fixedMethod:(BlahDataController *)blahDataController theString:(NSString *)theString;
@end 
```

“在另一个数据控制器.m 中”

```
#import "AnotherDataController.h"
#import "BlahDataController.h"
@implementation AnotherDataController

-(void)fixedMethod:(BlahDataController *)blahDataController theString:(NSString *)theString
{
    NSLog(@"%@",[blahDataController aMethod:theString]);
}
@end 
```

而且......它工作得很好......所以我想xcode只是无法识别一个类中的方法，并且在另一个类中正常工作......伙计，我不知道为什么会发生这个错误...... .

-=-=-

次要更新：
做整个“xcode dance”并没有解决问题
1）清理构建
2）删除派生数据
3）完全关闭 XCode 并重新打开

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-05-24T19:45:00.263

tl;dr - 项目中某处存在重复文件！去追捕它并无情地摧毁它！

好的，对于所有将来遇到此问题的人；这就是问题所在。

几个月前我制作了 BlahDataController。大约一周前，我重组了项目的文件夹并将 BlahDataController 从名为“Blah”的文件夹移至另一个名为“Data”的文件夹。

当我在“Data”文件夹中更改 BlahDataController 的代码时，我的一个类可以看到更改后的代码，但是，另一个类不能。

最终的问题是，当我移动 BlahDataController 时，它实际上创建了它的副本。所以我在“Data”文件夹中有一个 BlahDataController，在“Blah”文件夹中有一个较旧的 BlahDataController。即使旧的 BlahDataController 不再附加到项目管理器中的项目（xcode 的左侧），物理文件仍然存在于文件夹中的事实导致了这个问题。

删除 BlahDataController 的重复旧副本后，问题已解决。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-02T13:47:10.720

如果有人偶然发现类似的问题，在我的例子中，我使用“查找和替换”功能（忽略大小写）进行了一些重构，我得到了这样的结果：

```
SomeClass* SomeClass = [[SomeClass alloc] init];
[SomeClass instanceMethod]; 
```

它说：“'SomeClass'没有可见的@interface声明方法'alloc'。所以在我的情况下，问题是我将实例变量重命名为大写。解决方案是：

```
SomeClass* someClass = [[SomeClass alloc] init];
[someClass instanceMethod]; 
```

PS：如果可能，我建议使用 Xcode 中的“重构”功能而不是“查找和替换”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-10T13:43:07.880

注意：不是这个确切问题的答案，但我在这里寻找相同的编译器错误。

确保您知道您是在调用实例方法还是静态方法：

@interface 某类

```
+(void) SomeMethod; 
```

对比

```
-(void) SomeMethod; 
```

这些是不同的。

```
[SomeClass SomeMethod]; 
```

对比

```
[[[SomeClass alloc] init] SomeMethod]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-14T12:49:16.393

另请注意，如果

```
"Other Linker Flags" 
```

值设置为

```
-ObjC 
```

根据某些框架的要求，例如 RestKit（RestKits github 页面上的问题：[https](https://github.com/RestKit/RestKit/issues/1153) ://github.com/RestKit/RestKit/issues/1153 ）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-16T00:07:35.800

是的，我遇到了同样的问题。虽然当我更改为免费目标时，我在我的付费目标中完美地工作了这个，但我得到了这个错误。

> 'GameOverScene' 没有可见的@interface 声明选择器mesageToDisplayOnLabel：

*   为了解决这个问题，我的方法调用的拼写与我调用的方法不同。

    -(void)messageToDisplayOnLabel //我在我的方法调用中缺少“消息”中的 s Doh！
    {
    //方法代码
    }

*   检查您正在调用的方法的拼写可能会有所帮助。

# javascript - 是否可以使用 KeyMap 绑定到常规 DOM 元素

> ID：10727679
> 
> 赞同：0
> 
> 时间：2012-05-23T20:53:53.230
> 
> 标签：javascript, extjs, extjs4, extjs4.1

我试过的：

```
 new Ext.util.KeyMap({
        target: 'search',
        eventName: 'itemkeydown',
        binding: [
            {
                key: Ext.EventObject.ESC,
                scope: this,
                fn: function() {
                    console.log('esc');
                },
                defaultEventAction: 'preventDefault'
            }
        ]
    }); 
```

`search`元素的在哪里`id`。虽然它没有绑定到元素 - 我将焦点传递给它，但`ESCAPE`不会触发按下和回调。

我错过了什么？

PS：我也尝试过`Ext.get('search')`，而不是`search`相同的结果。

PPS：`search`元素不是 ExtJS 控件，它是常规的`<input type="text" ...>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T06:36:55.007

这是我的工作代码：

```
var map = new Ext.util.KeyMap({
    target: 'search',
    eventName: 'keydown', // changed from itemkeydown -> keydown
    binding: [{
            key: Ext.EventObject.ESC,
            scope: this,
            fn: function() {
                console.log('esc');
            },
            defaultEventAction: 'preventDefault'
        }
    ]
}); 
```

我的 HTML 元素如下：

```
<input type="text" id="search"/> 
```

`keydown`似乎是 的默认值`eventName`。没有它，代码将起作用。你也可以使用 4.0 风格让它工作：

```
var map = new Ext.util.KeyMap("search", {
    key: Ext.EventObject.ESC,
    handler: function() {
        console.log('esc');
    },
    scope: this,
    defaultEventAction: 'preventDefault'
}); 
```

# mysql - 如何显示来自mysql的随机自动旋转数据？

> ID：10727681
> 
> 赞同：0
> 
> 时间：2012-05-23T20:54:03.113
> 
> 标签：mysql, random, rotation

我的网站上有一个小盒子，上面有智慧语录

我不希望它们以平滑淡入淡出的方式随机出现，而无需重新加载页面

我找到了很多教程，但没有一个解释如何随机显示来自 mysql 的数据（仅来自 xml 或文档中硬编码的文本）

这是我的代码：

```
<?php
    mysql_connect("localhost", "xxxxxx", "xxxxxx") or die(mysql_error());
    mysql_select_db ("xxxxxx") or die(mysql_error());

    $select = mysql_query("SELECT * FROM `randomtext` ORDER BY RAND() LIMIT 1");
    while($row = mysql_fetch_assoc($select)) {
?>              

<div class="wisdom-textbox">
    <p class="font-wisdom">"<?php echo $row ['text']  ?>"</p>
</div> 
```

它会随机工作并且如果我刷新就会改变 - 但我需要该功能使其在几秒钟内旋转到数据库中的另一个随机智慧文本（小褪色不会伤害）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:07:01.610

您不能指望 MySQL 在被要求之前向您发送数据。

你可以做的是要求新的报价。为此，您将不得不再次执行查询。

为了再次执行查询，您必须轮询或使用一些执行查询的计时器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:05:34.327

你为什么不试试 JavaScript，JavaScript Timing Events 在这里真的可以帮助你，我真的不明白你在你的网站上想要做什么，但是去这个 [链接](http://www.w3schools.com/js/js_timing.asp) ，mabye 可以帮助你解决你的问题。祝你好运。

# mysql - 优化 mysql 查询 - 许多内部连接

> ID：10727682
> 
> 赞同：1
> 
> 时间：2012-05-23T20:54:14.323
> 
> 标签：mysql, wordpress

我正在尝试在 wordpress 中优化以下查询，因为返回结果需要将近一分半钟。表关系如下图所示：

![在此处输入图像描述](../Images/8cef661e57c3b1b08d6818a6f1afd161.png)

```
SELECT SQL_CALC_FOUND_ROWS wp_posts . *
    FROM wp_posts
       INNER JOIN wp_term_relationships 
        ON (wp_posts.ID = wp_term_relationships.object_id)
       INNER JOIN wp_term_relationships AS tt1 
        ON (wp_posts.ID = tt1.object_id)
       INNER JOIN wp_term_relationships AS tt2 
        ON (wp_posts.ID = tt2.object_id)
       INNER JOIN wp_term_relationships AS tt3 
        ON (wp_posts.ID = tt3.object_id)
       INNER JOIN wp_term_relationships AS tt4 
        ON (wp_posts.ID = tt4.object_id)
    WHERE 1 = 1
        AND (
            wp_term_relationships.term_taxonomy_id IN (25) 
            OR tt1.term_taxonomy_id IN (26) 
            OR tt2.term_taxonomy_id IN (16) 
            OR tt3.term_taxonomy_id IN (17) 
            OR tt4.term_taxonomy_id IN (18)
        ) 
        AND wp_posts.post_type IN ('product') 
        AND (wp_posts.post_status = 'publish')
    GROUP BY wp_posts.ID
    ORDER BY wp_posts.post_title ASC
    LIMIT 0 , 15 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:04:58.413

我不明白 wp_term_relationships 表上所有内部连接的意义，因为它看起来你正在做的只是寻找一系列值。下面的执行是否相同并执行得更快？

```
SELECT SQL_CALC_FOUND_ROWS wp_posts . *
    FROM wp_posts
       INNER JOIN wp_term_relationships 
        ON (wp_posts.ID = wp_term_relationships.object_id)
    WHERE wp_term_relationships.term_taxonomy_id IN (25, 26, 16, 17, 18) 
        AND wp_posts.post_type = 'product' 
        AND wp_posts.post_status = 'publish'
    GROUP BY wp_posts.ID
    ORDER BY wp_posts.post_title ASC
    LIMIT 0 , 15 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:01:18.027

尝试这个。我认为这会更快。

```
SELECT SQL_CALC_FOUND_ROWS wp_posts . *
FROM wp_posts,
     wp_term_relationships 
WHERE wp_posts.ID = wp_term_relationships.object_id
AND wp_term_relationships.term_taxonomy_id IN (25,26,16,17,18)
AND wp_posts.post_type = 'product' 
AND wp_posts.post_status = 'publish'
GROUP BY wp_posts.ID
ORDER BY wp_posts.post_title ASC
LIMIT 0 , 15 
```

你不需要这么多的 INNER JOINS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:30:14.087

If the idea behind the multiple joins was to retrieve the posts with a corresponding `term_taxonomy_id` of 25 and also 26 and also 17,... (meaning **ALL of the terms** as opposed to ANY of them), you can reuse KayakJim's answer with only one JOIN and add an `HAVING` clause, keeping only the rows that matched with all of the 5 terms.

Here would be the modified query:

```
SELECT SQL_CALC_FOUND_ROWS wp_posts . *
    FROM wp_posts
       INNER JOIN wp_term_relationships 
        ON (wp_posts.ID = wp_term_relationships.object_id)
    WHERE wp_term_relationships.term_taxonomy_id IN (25, 26, 16, 17, 18) 
        AND wp_posts.post_type = 'product' 
        AND wp_posts.post_status = 'publish'
    GROUP BY wp_posts.ID
    HAVING count(*)=5
    ORDER BY wp_posts.post_title ASC
    LIMIT 0 , 15 
```

# outlook - exchange 2003 owa 在 url 字符串中包含用户名/密码

> ID：10727683
> 
> 赞同：1
> 
> 时间：2012-05-23T20:54:23.360
> 
> 标签：outlook, exchange-server, outlook-web-app

我有一个当前正在使用的现有 Microsoft Exchange 2003 OWA 安装：

[https://mail.mydomain.com/exchange/](https://mail.mydomain.com/exchange/)

我有一个使用会话变量来存储用户名和密码的 Web 应用程序。构造包含用户名和密码而不要求他们登录的 URL 字符串的正确语法是什么？我想它会是这样的

[https://mail.mydomain.com/exchange/?username=user&password=pass](https://mail.mydomain.com/exchange/?username=user&password=pass)

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T16:13:07.770

OWA 不会以这种方式接受信用。如果您使用基于表单的身份验证，您可以为它制作 cookie 或发布帖子并模拟用户登录以获取 cookie。如果它使用的是 Windows 集成身份验证，那么您没有太多选择。基本身份验证通过将凭据放入 HTTP 标头中来工作，因此您可以模拟这一点。

# visual-studio-2010 - 在 VS2010 项目中使用 VS11

> ID：10727684
> 
> 赞同：1
> 
> 时间：2012-05-23T20:54:45.720
> 
> 标签：visual-studio-2010, visual-studio-2012

如果我没看错[的](http://msdn.microsoft.com/en-us/library/hh266747%28v=VS.110%29.aspx)话，我应该能够在 VS11 中使用 VS2010 解决方案/项目，而不会对仍在使用 VS2010 的同事产生任何不良影响。

我的项目主要是 c# Winforms 和 ASP.NET Web 服务应用程序。有没有人试过这个设置？它真的奏效了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:10:21.290

是的，它工作正常，我每天都使用 VS11 Beta，而公司其他人则使用 VS2010。

注意，您需要确保 VS2010 用户已应用 Visual Studio 2010 **Service Pack 1**。如果没有，则他们无法打开 VS11 保存的解决方案文件。

这是[官方的 MS 答案](http://msdn.microsoft.com/en-us/library/hh266747%28VS.110%29.aspx)。

我发现了一些警告：

*   **仅**使用未安装 2010 的 VS11 需要我更新许多项目文件，以及对 VS2010 工具（即 sgen）的一些引用。如果您打算使用 VS11，只需将其安装在 VS2010 旁边即可。
*   我们在程序集中有自定义 FXCop 规则。我们需要使用 VS11 重新编译它以使其与 VS11 一起工作。但是我们不能签入它，因为它打破了 2010 年。几个月前我在[MSDN 论坛上问了一个问题以寻求解决方法，但没有得到答复。](http://social.msdn.microsoft.com/Forums/en-US/vseditor/thread/f5d9dcbf-cb42-4ff0-9d06-5bfaec1d3594/#f5d9dcbf-cb42-4ff0-9d06-5bfaec1d3594)

# android - Android - 绘制路径

> ID：10727685
> 
> 赞同：0
> 
> 时间：2012-05-23T20:54:51.937
> 
> 标签：android, google-maps

使用这个例子[在谷歌地图上绘制一条线/路径](https://stackoverflow.com/questions/2176397/drawing-a-line-path-on-google-maps)我不断地从 LogCat 获得以下错误：它似乎找不到类 com.google.android.maps.Mapview - 我已经导入了 com.google.android.maps .MapView 但不知道如何创建这个明显的类 - 有人可以建议吗？谢谢

```
05-23 20:35:46.542: E/dalvikvm(408): Could not find class 'com.google.android.maps.MapView', referenced from method com.geomatrix.direction.MapdirectionActivity.onCreate
05-23 20:35:46.542: W/dalvikvm(408): VFY: unable to resolve check-cast 342 (Lcom/google/android/maps/MapView;) in Lcom/geomatrix/direction/MapdirectionActivity;
05-23 20:35:46.542: D/dalvikvm(408): VFY: replacing opcode 0x1f at 0x0016
05-23 20:35:46.550: D/dalvikvm(408): VFY: dead code 0x0018-0182 in Lcom/geomatrix/direction/MapdirectionActivity;.onCreate (Landroid/os/Bundle;)V
05-23 20:35:46.639: D/AndroidRuntime(408): Shutting down VM
05-23 20:35:46.649: W/dalvikvm(408): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
05-23 20:35:46.679: E/AndroidRuntime(408): FATAL EXCEPTION: main
05-23 20:35:46.679: E/AndroidRuntime(408): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.geomatrix.direction/com.geomatrix.direction.MapdirectionActivity}: android.view.InflateException: Binary XML file line #5: Error inflating class com.geomatrix.direction.MapView
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.os.Looper.loop(Looper.java:123)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.ActivityThread.main(ActivityThread.java:4627)
05-23 20:35:46.679: E/AndroidRuntime(408):  at java.lang.reflect.Method.invokeNative(Native Method)
05-23 20:35:46.679: E/AndroidRuntime(408):  at java.lang.reflect.Method.invoke(Method.java:521)
05-23 20:35:46.679: E/AndroidRuntime(408):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-23 20:35:46.679: E/AndroidRuntime(408):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-23 20:35:46.679: E/AndroidRuntime(408):  at dalvik.system.NativeStart.main(Native Method)
05-23 20:35:46.679: E/AndroidRuntime(408): Caused by: android.view.InflateException: Binary XML file line #5: Error inflating class com.geomatrix.direction.MapView
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:576)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
05-23 20:35:46.679: E/AndroidRuntime(408):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.Activity.setContentView(Activity.java:1647)
05-23 20:35:46.679: E/AndroidRuntime(408):  at com.geomatrix.direction.MapdirectionActivity.onCreate(MapdirectionActivity.java:30)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
05-23 20:35:46.679: E/AndroidRuntime(408):  ... 11 more
05-23 20:35:46.679: E/AndroidRuntime(408): Caused by: java.lang.ClassNotFoundException: com.geomatrix.direction.MapView in loader dalvik.system.PathClassLoader[/data/app/com.geomatrix.direction-1.apk]
05-23 20:35:46.679: E/AndroidRuntime(408):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
05-23 20:35:46.679: E/AndroidRuntime(408):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
05-23 20:35:46.679: E/AndroidRuntime(408):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.createView(LayoutInflater.java:466)
05-23 20:35:46.679: E/AndroidRuntime(408):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565)
05-23 20:35:46.679: E/AndroidRuntime(408):  ... 20 more 
```

有人可以帮忙吗？我会斗鸡眼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T16:49:01.837

我遇到了同样的问题，我发现我的 xml 标签中缺少“google”引用。我最初有它，比如“com.android.maps.MapView”，这显然是错误的。它应该类似于以下内容

```
<com.google.android.maps.MapView
  android:id="@+id/map"
  android:apiKey="mapAPIkey"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:clickable="true"
/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:39:24.410

您是否在清单中包含下一行？

```
<uses-library android:required="true" android:name="com.google.android.maps" /> 
```

并将其放在正确的位置（在开始的应用程序标记之后），例如：

```
<application
    android:hardwareAccelerated="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <uses-library
        android:name="com.google.android.maps"
        android:required="true" />

    <activity ... 
```

# c++ - 使用非 ASCII 注释在 C++ 代码中查找非 ASCII 字符的出现

> ID：10727687
> 
> 赞同：1
> 
> 时间：2012-05-23T20:54:56.397
> 
> 标签：c++, regex

我在注释和字符串中有带有西里尔字符的源代码。MSVC 允许在标识符中使用西里尔字符。如何找到忽略所有注释和字符串的所有西​​里尔字符？我想在不使用 gcc 或脚本的情况下做到这一点，完美地使用简单的正则表达式搜索。找到评论 /*.*?*/ 并不难，但是如何找到评论中没有的东西，而不是 ASCII 字符集中的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:20:19.450

Let's assume that all comments behave like '//'--even the ones that are '/* comment */'--in the sense that once a comment starts you won't have more code after the comment on the same line. Try piping your source file through this:

```
perl -lne 'print $1 if m{^([^/]+)(?:/[/*])?}' 
```

That will get you everything but the comments.

The remaining problem is a function of the character set. If it is Windows-1251, you can look for patterns like this: `'[^\x00-\x7f]+'`

# php - PHP、OOP实战实例

> ID：10727688
> 
> 赞同：1
> 
> 时间：2012-05-23T20:54:57.937
> 
> 标签：php, oop, interface, abstract

我正在学习抽象类和接口之间的区别，但是当您没有实际示例时，很难理解理论解释。我已经读过：通过更新基类，所有继承类都会随着更改而自动更新。另一方面，接口一旦创建就不能更改。如果需要新版本的接口，则必须创建一个全新的接口。如果有人可以为我提供这行的一个实际例子，我将非常感激，祝你一周愉快。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:05:45.760

考虑这个例子。我们有一个可驱动的接口、汽车抽象和一个使用这两者的 Pinto 类。

```
interface Drivable 
{
  public function go();
}

abstract class Automobile 
{
  public $type;

  public function getType() {
    return $this->type;
  }
}

class Pinto
    extends Automobile
    implements Drivable 
{
  public function go() {
    // code to make it go
  }
} 
```

我们可以通过在`Automobile`. 在那里添加的任何新方法都将可用于所有扩展类。

但是，如果我们向 Drivable 接口添加一个方法，我们必须在每个实现它的类中寻找并实现该方法以添加新方法，否则它将无法编译。

例如，假设我们`stop()`向接口添加了一个方法。`Pinto`将立即引发错误，因为它没有`stop`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:01:05.530

接口是可以改变的，你只需要在继承类中实现所有的改变。例如，您正在制作一个 SpaceShip 接口并且您有 CoolEnemyShip、StupidEnemyShip、PlayerShip 并且您已经向 SpaceShip 添加了一个新函数以添加新的东西，例如 Boost() 函数，您必须在 3 实现中实现 Boost() 函数类（CoolEnemyShip、StupidEnemyShip、PlayerShip）

另一方面，如果 SpaceShip 是一个基类，并且您在其中实现了 Boost() 函数，那么所有继承类都将具有 Boost() 函数可用。这是主要区别，您不需要一行代码即可理解它，类比应该对您有足够的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:06:27.157

抽象基类用于创建扩展类将继承的功能。

接口用于定义一组严格的函数，这些函数必须由使用该接口的类实现。

抽象类可以将方法标记为抽象方法有一点重叠，而将实现留给继承类。

# api - 对于未找到某些链接资源的 PUT 操作，HTTP 404 是否是适当的响应？

> ID：10727699
> 
> 赞同：30
> 
> 时间：2012-05-23T20:55:34.557
> 
> 标签：api, http, rest

想象一个 REST Web 服务，您在其中将项目添加到某种类型的容器中。例如，假设我们可以将参与者 #789 添加到事件 #456，如下所示：

```
PUT http://..../api/v1/events/456/attendees/789 
```

如果事件 #456 或参加者 #789 不存在，返回 HTTP 404 是否正确（以及解释问题所在的详细错误有效负载，例如`{ "error" : { "message" : "Event 456 does not exist" , "code" : "404" } }`？

同样，如果我正在创建引用另一个对象的新对象，但另一个对象不存在怎么办？例如，假设我正在位置 #123 创建一个事件

```
PUT http://..../api/v1/event
{ "location": 123, "name": "Party", "date": "2012-05-23", ...etc... } 
```

如果位置 #123 不存在，返回 404（连同响应中的详细信息）是否也正确？如果没有，什么是合适的——只有 400？

根据 HTTP 1.1 规范[http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

> **9.6 PUT** ...如果资源不能通过Request-URI创建或修改，应该给出反映问题性质的适当错误响应

所以这似乎是用 404 响应的好投票。 *但是*由于某种原因，我不能完全确定，用 404 响应 PUT（或 POST）对我来说似乎很奇怪......也许是因为 404 意味着无法找到资源，但在这种情况下，我们的资源实际上是两个其他资源之间的链接，它是这两个无法找到的资源之一。

不要太担心我在这里的确切例子——它们是为了说明这一点而编造的。主要问题是：404 是否是对因未找到链接资源而失败的 PUT 操作的适当响应？

如果您能指出参考资料，那就太好了——我很难找到任何涉及这种详细程度并且足够可信的资料。特别是关于 REST API 设计中资源关系的处理。

**更新的想法**我认为可能第一个示例应该返回 404，第二个不应该。理由是，在第一种情况下，我们添加的资源使用事件 456 和参加者 789 作为复合主键；第二种情况位置只是一个外键。在第二种情况下，应该返回一个错误，但不是 404——可能是 412 Precondition Failed 或者可能只是 400 Bad Request。想法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-23T21:26:44.527

有许多 4xx [HTTP 状态代码](https://www.rfc-editor.org/rfc/rfc7231#section-6.5)。最有可能的是 404 或 409：

> **404 未找到**

> 服务器未找到任何与有效请求 URI 匹配的内容。没有说明这种情况是暂时的还是永久性的。如果服务器通过一些内部可配置的机制知道旧资源永久不可用并且没有转发地址，则应该使用 410 (Gone) 状态代码。当服务器不希望确切地揭示请求被拒绝的原因或没有其他响应适用时，通常使用此状态代码。

> **409 冲突**

> 由于与资源的当前状态冲突，无法完成请求。仅在预期用户可能能够解决冲突并重新提交请求的情况下才允许使用此代码。响应正文应该包含足够的信息让用户识别冲突的来源。理想情况下，响应表示将包含足够的信息供用户或用户代理解决问题；但是，这可能是不可能的，也不是必需的。

> 响应 PUT 请求时最有可能发生冲突。例如，如果正在使用版本控制并且被 PUT 的表示包括对资源的更改，这些更改与早期（第三方）请求所做的更改相冲突，则服务器可能会使用 409 响应来指示它无法完成请求. 在这种情况下，响应表示可能包含两个版本之间的差异列表。

其中任何一个都适合，但我想我会选择 409。404 用于*URI not found*但 409 表示资源的当前状态不允许请求的操作。在您的情况下，该请求无法得到满足，因为有些事情是不允许的。

# javascript - 使用easy xdm定期报告dom属性跨域

> ID：10727703
> 
> 赞同：1
> 
> 时间：2012-05-23T20:55:51.413
> 
> 标签：javascript, iframe, cross-domain, dynamic-resizing

我正在尝试使用easyXDM根据其内容高度动态调整iframe的高度。该代码每 5 秒调用一次检查 iframe 的 body.scrollheight，理论上如果页面高度发生了变化，则 iframe 高度将每 5 秒更新一次。它适用于初始调用 - iframe 甚至可以正确调整大小。问题在于，即使 iframe 内容的高度发生了变化，提供程序也会继续返回内容的原始高度。

编码：

消费者（包含 iframe 的页面）：

```
var socket = new easyXDM.Socket({
remote: "http://remoteDomain.ca/blahblah.html",
container: "embedded",
onMessage: function(message, origin){
    alert(message); //continually alerts "542px" even when body.scrollheight 
                    // has changed
   document.getElementById('iframe').style.height = message + "px";  
   var t = setTimeout(function() {
      socket.postMessage();
   }, 5000);
},
onReady: function() {
    socket.postMessage();
}
}); 
```

提供者（iframe 内容）：

```
var socket = new easyXDM.Socket({
    onMessage: function(message, origin){
        socket.postMessage(document.body.scrollHeight);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T15:00:33.373

After try easyXDM, it finally worked by using another sample: [http://stevesouders.com/misc/test-postmessage.php](http://stevesouders.com/misc/test-postmessage.php)

In source page just:

```
<script type="text/javascript">
    setInterval(function () {
        parent.postMessage(document.body.scrollHeight, '*');
    }, 500);    
</script> 
```

In frame page:

```
<script type="text/javascript">

    if (window.attachEvent) {
        // IE
        window.attachEvent("onmessage", handleMessage);
    }

    if (window.addEventListener) {
        // FF
        window.addEventListener("message", handleMessage, false);
    }

    function handleMessage(e) {
        $("#frameId").attr("height", e.data);
    }

</script>
<iframe id="frameId" src="http://mysourceurl.com.br/" width="100%"
    frameborder="0" scrolling="no"></iframe> 
```

Worked like a charm! My iframe height is refreshed every setInterval interation.

# css - 导航栏中的 Twitter 引导 btn-large

> ID：10727706
> 
> 赞同：2
> 
> 时间：2012-05-23T20:55:58.783
> 
> 标签：css, twitter-bootstrap

我无法在导航栏中找到大小合适的 btn-large 按钮。尝试更改 navbarHeight 和 baseLineHeight 更少的变量，但这没有帮助。按钮比导航栏外使用的按钮小。

```
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a title="" class="btn btn-primary btn-large" href=""><i class="icon-plus-sign icon-white"></i>Add</a>
                <ul class="nav pull-right">
                <li class="divider-vertical">
                <li><a href="">Val</a></span></li>
                <li class="divider-vertical">
                <li><a href="">Val2</a></li>
                <li class="divider-vertical">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">val3<i class="icon-user"></i></a>
                    <ul class="dropdown-menu">
                        <li><a href="">My account</a></li>
                        <li><a href="/accounts/logout/">Log out</a></li>
                    </ul>
                </li>
            </ul>
            </div>
       </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T12:51:07.540

这是设计使然，因为导航栏高度是标准的（以容纳它周围的其他元素）。您可以通过创建自己的类并“强制”显示的填充来覆盖该限制，`.btn-large`如下所示：

```
.navbar .btn-large-navbar {
    padding: 9px 14px;
} 
```

然后您可以将新类添加到您的大按钮中：

```
<a title="" class="btn btn-primary btn-large btn-large-navbar" href=""><i class="icon-plus-sign icon-white"></i>Add</a> 
```

但请记住，由于您正在拉伸导航栏，因此某些元素可能看起来不合适。

演示：http: [//jsfiddle.net/gnEAe/](http://jsfiddle.net/gnEAe/)

# sql - 在检查具有重复值的列时更新列

> ID：10727707
> 
> 赞同：0
> 
> 时间：2012-05-23T20:56:03.073
> 
> 标签：sql, sql-server, min

我正在使用以下语句选择我的数据：

```
select distinct min(revision_number) as revno,po_number 
from PO_HEADER 
group by PO_NUMBER
having MIN(revision_number) > 0; 
```

我得到以下数据：

```
7   30492-SA-EH504
20  30492-PS-SO895
20  30492-RA-DD219
26  30492-SA-KK474
1   30492-BA-AT236
17  30492-RA-DD386
21  30492-PS-FS803
25  30492-PS-WM324
33  30492-SA-NS011 
```

我想在`MIN(REVISION_NUMBER)`不更改任何其他值的情况下将其更新为零。例如，`30492-SA-EH504`具有以下修订的列表：

```
30492-SA-EH504 7
30492-SA-EH504 8
30492-SA-EH504 9
30492-SA-EH504 10 
```

我只想将当前的最小修订版 (7) 更新为零。我尝试了此更新查询，但将它们全部更新为零：

```
update PO_HEADER
set REVISION_NUMBER = '0'
from PO_HEADER
where exists (
select min(revision_number) as revno,po_number 
from PO_HEADER
group by PO_NUMBER
having MIN(revision_number) > 0
); 
```

会选择不同的帮助，还是我需要更复杂的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:05:17.203

这是解决它的另一种方法。您实际上可以更新公用表表达式：

```
with mins as (
  select po_number, revision_number
  from (
  select po_number, revision_number,
    row_number() over (partition by po_number order by revision_number) n
  from Table1
  ) A
  where A.n = 1
)
update mins set revision_number = 0

select * from Table1 
```

**[SQL 小提琴在这里。](http://sqlfiddle.com/#!3/b51d5/1)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:03:44.943

有多种方法可以做到这一点。我更喜欢使用“IN”子句的那个：

```
update PO_HEADER
    set REVISION_NUMBER = '0'
    where (po_header.Revision_NUMBER, po_header.po_number) in 
              (select min(revision_number) as revno, po_number
               from PO_HEADER
               group by PO_NUMBER
               having MIN(revision_number) > 0
              ) 
```

您的原始查询在更新表中的行与条件之间没有任何联系。因此，所有评估为真，因为条件为真（存在行）。我认为上述语法在 mysql 中有效——使用“IN”查找对。如果没有，您可以使用以下方法：

```
update PO_HEADER
    set REVISION_NUMBER = '0'
    from (select min(revision_number) as revno, po_number
          from PO_HEADER
          group by PO_NUMBER
          having MIN(revision_number) > 0
         ) minr
    where po_header.Revision_NUMBER = minr.Revision_NUMBER and
         po_header.po_number = minr.po_number 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:11:42.340

就像是

```
UPDATE poh
  SET poh.RevisionNumber = 0
  FROM POHeader AS poh
  INNER JOIN (select distinct min(revision_number) as revno,po_number 
              from PO_HEADER 
              group by PO_NUMBER
              having MIN(revision_number) > 0) AS poh_rev
  ON poh.PO_Number = poh_rev.PO_Number And poh.RevisionNumber = poh_rev.revno 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T04:53:14.170

```
Update PO_HEADER
Set revision_number = 0
From (
      select distinct min(revision_number) as revno,po_number  
      from PO_HEADER
      group by PO_NUMBER 
      having MIN(revision_number) > 0
      )Z
Where PO_HEADER.revision_number = Z.revno
  and PO_HEADER.po_number = Z.po_number 
```

# html - Box Shadow 在 Chrome 中工作，但在 IE 和 Firefox 中不工作

> ID：10727714
> 
> 赞同：0
> 
> 时间：2012-05-23T20:56:30.593
> 
> 标签：html, firefox, google-chrome, css

我为某个元素编写了一个盒子阴影，它在 Chrome 中运行良好，但在 Firefox 和 Internet Explorer 中不起作用。我的网站有三个 div（页眉、正文、页脚），它们适用于 Chrome 和 Firefox，另外 2 个很好。

这是我的代码：

```
#footer {
background-image:url(../../images/footer-extend.png);
background-repeat: repeat-x;
width: 960px;
border-bottom: 1px solid black;
border-left: 1px solid black;
border-right: 1px solid black;
overflow:hidden;
padding-top: 35px;
padding-left: 10px;
padding-right: 10px;
padding-bottom: 0px;

margin:0 auto;
margin-top: -10px;
margin-bottom: 100px;
/* BOX SHADOW */

-moz-box-shadow: 6px 0 6px  -4px #222, -6px 0 6px  -4px #222, 0px 6px -4px #222;  
-webkit-box-shadow: 6px 0 6px  -4px #222, -6px 0 6px  -4px #222, 0px 6px -4px #222;
box-shadow: 6px 0 6px  -4px #222 , -6px 0 6px  -4px #222, 0px 6px -4px #222; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:42:36.140

`blur`您的 box-shadow在最后一个声明中使用负值。您是否可能遗漏了什么并想使用负面模糊作为传播？

我猜 Firefox 不支持负模糊，这似乎是合法的，因为这没有任何意义。

试试这个（记得将它应用到前缀版本）：

```
box-shadow: 6px 0 6px -4px #222, -6px 0 6px -4px #222, 0 6px 0 -4px #222; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T07:05:02.623

试试这个，这将适用于 Firefox 和 Ie9

```
-moz-box-shadow:10px 10px 5px #000000;
-webkit-box-shadow:10px 10px 5px #000000;
box-shadow:10px 10px 5px #000000; 
```

# django - 是否有用于创建 github 问题的 django 记录器的处理程序？

> ID：10727718
> 
> 赞同：2
> 
> 时间：2012-05-23T20:56:54.380
> 
> 标签：django, logging, github-api

是否有 django 记录器的处理程序在创建日志条目时在 github 上创建问题？如果没有，创造一个有多难？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T15:37:27.747

这不是一个完整的“包含电池”的答案，但是，只要你自己付出一点努力，它就会让你到达那里。

1.  创建[自定义记录器](https://docs.djangoproject.com/en/dev/topics/logging/)
2.  让该自定义记录器在 github 上创建问题（我使用了以下脚本）

创建 Github 问题的脚本：

```
import json
import requests

def make_issue(title, body=None, assignee=None, milestone=None, labels=None):
    '''Create an issue on github.com using the given parameters.'''
    # Authentication for user filing issue (must have read/write access to
    # repository to add issue to)
    username = 'CHANGEME'
    password = 'CHANGEME'
    # The repository to add this issue to
    repo_owner = 'CHANGEME'
    repo_name = 'CHANGEME'
    # Our url to create issues via POST
    url = 'https://api.github.com/repos/%s/%s/issues' % (repo_owner, repo_name)
    # Create an authenticated session to create the issue
    session = requests.session(auth=(username, password))
    # Create our issue
    issue = {'title': title,
             'body': body,
             'assignee': assignee,
             'milestone': milestone,
             'labels': labels}
    # Add the issue to our repository
    r = session.post(url, json.dumps(issue))
    if r.status_code == 201:
        print 'Successfully created Issue "%s"' % title
    else:
        print 'Could not create Issue "%s"' % title
        print 'Response:', r.content

make_issue('Issue Title', 'Body text', 'assigned_user', 3, ['bug']) 
```

# apache - .htaccess 中的条件 SetEnv？

> ID：10727720
> 
> 赞同：22
> 
> 时间：2012-05-23T20:57:06.017
> 
> 标签：apache, .htaccess, pyrocms, setenv

是否可以根据主机名在 .htaccess 文件中设置不同的 SetEnv 变量？

例如，我需要我的`.htaccess`文件具有以下值：

```
SetEnv PYRO_ENV production 
```

在生产盒上，以及...

```
SetEnv PYRO_ENV stage 
```

在分期箱上。该`.htaccess`文件受版本控制，这就是我正在寻找有条件解决方案的原因。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-10-16T00:38:39.760

对于条件设置，有[SetEnvIf](http://httpd.apache.org/docs/current/mod/mod_setenvif.html#setenvif)：

```
SetEnvIf Host ^stage\.example\.com$ PYRO_ENV=stage
SetEnvIf Host ^(www\.)?example\.com$ PYRO_ENV=production 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-05-23T21:07:53.920

您可以使用 mod_rewrite：

```
RewriteEngine on

RewriteCond %{HTTP_HOST} ^stage\.domain\.com$
RewriteRule (.*) $1 [E=PYRO_ENV:stage]

RewriteCond %{HTTP_HOST} ^www\.domain\.com$
RewriteRule (.*) $1 [E=PYRO_ENV:production] 
```

# oracle - PL/SQL 中的文件上传过程

> ID：10727721
> 
> 赞同：0
> 
> 时间：2012-05-23T20:57:10.103
> 
> 标签：oracle, web-applications, plsql

我正在开发一个 PL/SQL Oracle Web 应用程序，我需要创建一个处理文件上传表单的过程。文件上传表单字段名称为`new_photo`. 这是我的代码，但我提交时总是出错。我在网上或 oracle 文档中找不到此任务的任何示例。

错误：

```
Error 6550 calling procedure:

ORA-06550: line 2, column 3:
PLS-00306: wrong number or types of arguments in call to 'INSERT_NEW_PHOTO'
ORA-06550: line 2, column 3:
PL/SQL: Statement ignored

The last SQL statement executed was:

begin
  insert_new_photo(:B1,:B2,:B3,:B4,:B5,:B6,:B7,:B8);
end; 
```

编码：

```
CREATE OR REPLACE PROCEDURE insert_new_photo (new_photo VARCHAR2 DEFAULT NULL) IS
    BEGIN

       -- if the user didn't chose a file to upload
       IF new_photo IS NULL OR LENGTH( new_photo ) = 0
       THEN
       print_page_header;
       print_error( 'Please supply a file name.' );
       print_upload_form;
       --print_page_trailer( TRUE );
       return;
   END IF;

END insert_new_photo;
/ 
```

表格 ：

```
<form action="insert_new_photo" method="post" enctype="multipart/form-data">
<input type="text" name="new_photo"><br>
<input type="submit" value="ok">
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T09:03:12.397

你在使用 mod_plsql 吗？如果是这种情况，我认为您不能将文件直接发布到 PL/SQL proc：您将必须定义一个特定的表并修改相关的 DAD 参数（请参阅[http://docs.oracle.com/cd /E14571_01/portal.1111/e12041/concept.htm#i1005866](http://docs.oracle.com/cd/E14571_01/portal.1111/e12041/concept.htm#i1005866)）。

HTH。

亚历山德罗

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:02:25.060

如果我错了，请纠正我，但您的问题似乎是您在调用该过程时有太多参数

```
insert_new_photo(:B1,:B2,:B3,:B4,:B5,:B6,:B7,:B8); 
```

这里有 8 个参数，过程本身只有一个

```
insert_new_photo (new_photo VARCHAR2 DEFAULT NULL) 
```

# android - 我怎样才能“闪烁”整个表面视图

> ID：10727723
> 
> 赞同：0
> 
> 时间：2012-05-23T20:57:18.310
> 
> 标签：android

在我的 android 应用程序中，我有一个 SurfaceView 来显示相机预览。我得到了它的工作。

但我的问题是如何在这个 SurfaceView 上做一个“眨眼”效果，我想在拍照时给用户一个视觉帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:17:30.797

您可以通过在表面视图顶部有一个不可见的黑色/白色视图来做到这一点。当您希望闪烁时，显示视图并使用处理程序在几毫秒后发布可运行文件，这将使视图再次不可见。

您还可以使用 alpha 动画使其看起来更酷。

# javascript - 为其他域的 iframe 创建内容

> ID：10727726
> 
> 赞同：4
> 
> 时间：2012-05-23T20:57:28.710
> 
> 标签：javascript, iframe, same-origin-policy

对于我们的论文，我们需要开发一个 AdJail 方法的原型，以提供针对恶意广告的安全性。该方法通过将广告脚本放置在具有不同来源的 iframe 中的“影子页面”中来隔离广告脚本。（受同源策略保护）通过将原始页面的内容复制到影子页面，adscript 只能访问发布者允许访问的内容。

问题在于为 shadowpage 创建 iframe。最初，我们实现了这个：

```
if (document.createElement && (iframe = document.createElement('iframe'))) {
        iframe.id = "shadowpage";
        iframe.name = "shadowpage";
        iframe.height = 1400; 
        iframe.width = 1400;
        document.body.appendChild(iframe);
        var shadowScript = document.createElement("script");
        shadowScript.src = "ShadowTunnelScript.js";
        iframe.contentDocument.body.appendChild(shadowScript);
        adUrl = adScript;
} 
```

显然，这不提供同源策略的请求安全性，因为该 iframe 与包含页面具有相同的源。

我们的替代方案如下，将 iframe 的 src 设置为具有不同来源的页面：

```
if (document.createElement && (iframe = document.createElement('iframe'))) {
        iframe.id = "shadowpage";
        iframe.name = "shadowpage";
        iframe.height = 1400; 
        iframe.width = 1400;
        iframe.src = "http://***/AdJail/Shadowpage.html";
        //iframe.style.display = "none";
        document.body.appendChild(iframe);
} 
```

但是在这种情况下，我们原型的用户需要自己在不同的服务器上创建一个影子页面。

我们的问题是：是否可以创建一个不同来源的 iframe，动态生成这个 iframe 的内容，这样用户只需要调用一个库而不需要自己提供 shadowpage。

这是否可以通过首先生成 iframe 的内容然后以某种方式更改 iframe 的来源来实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T13:48:04.130

您可以尝试将值设置为 document.domain 或将 iframe 内容设置为 datauri ：

```
var content=window.btoa('<html>(..)<script>document.domain='sandbox';</script></html>');
iframe.src = "data:text/html;base64,"+content; 
```

# vb.net - 双击时有效的Vb.net exe，但在由jcl运行时无效

> ID：10727729
> 
> 赞同：0
> 
> 时间：2012-05-23T20:57:44.233
> 
> 标签：vb.net, vbscript, directory, jcl

我有一个 VB.net 应用程序，它导入一个名为 resource_NAMEOFEXE.txt 的文件，当我的流阅读器仅将“resource_NAMEOFEXE.txt”作为位置时，它假定为本地位置，我猜，并在用户运行时正确读取文件。

然后我尝试运行一个应该运行 exe 的 jcl 作业，程序无法自动找到本地路径。所以我尝试将本地路径硬编码到exe本身，并且jcl运行和用户运行正确导入的程序。注意：jcl 在大型机上，exe 在服务器上。

```
 //SFARENAM EXEC P2CUCMD                                          
  //SCRIPT   DD *                                                  
  "\\<serverName>\$APPLE\testAndRename.exe"     
  /*                                                               
  //UCMDOPT  DD DISP=SHR,DSN=IC.D2C.UCMDOPT.FILE(UZAO0001)         
//SYSIN    DD *                                                  
 -s       SCRIPT                                                 
   -host    <servername>                        
 -userid  <userid>                                      
 -script  SCRIPT                                                 
 -x       UCMDOPT                                                
 /*                                                               
//SYSOUT   DD  SYSOUT=*                                          
 //SYSPRINT DD  SYSOUT=*                                          
 // 
```

这可能是 JCL 问题，还是我应该以特殊方式格式化 vb.net 位置以询问本地 exe 位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-10T16:44:23.430

调用文件时尝试使用本地路径`.exe`而不是网络路径。

例如，而不是：

```
\\\serverName\$APPLE\testAndRename.exe 
```

利用：

```
C:\something\somewhere\testAndRename.exe 
```

# wpf - 我需要将 observablecollection 添加到 observablecollection 中。

> ID：10727738
> 
> 赞同：0
> 
> 时间：2012-05-23T20:58:38.970
> 
> 标签：wpf, xaml, observablecollection, hierarchicaldatatemplate, radtreeview

这是我的代码以及运行它时的输出。我真的很茫然。任何帮助，将不胜感激。

验证项目类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections.ObjectModel;

namespace ValidationWPF.DataSources
{
   public class ValidationItem : ObservableCollection<ValidationItem>
    {
        public ValidationItem()
        {
            SubItems = new ObservableCollection<ValidationItem>();

        }

        public ObservableCollection<ValidationMessages> Messages
        {
            get;
            set;
        }

        public string item
        {
            get;
            set;
        }

        public IList<ValidationItem> SubItems
        {
            get;
            set;
        }

        public static IList<ValidationItem> GetItems(string name)
        {
            var Validation = new ObservableCollection<ValidationItem>();

            var item = new ValidationItem();
            item.item = "Customer";

            var subItem = new ValidationItem();
            subItem.item = "Name";
            item.SubItems.Add(subItem);

            var Message = new ValidationItem();
            Message.item = new ObservableCollection<ValidationMessages>().ToString();
            subItem.SubItems.Add(Message);

            Validation.Add(item);

            return Validation;

        }
    }
} 
```

VALIDATIONMESSAGES CLASS（需要在Validation Item Class中实现）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections.ObjectModel;

namespace ValidationWPF.DataSources
{
    public class ValidationMessages 
    {
        public ValidationMessages(string Message)
        {
            this.Message = Message;
        }

            public string Message
            {
                get;
                set;
            }

    }
} 
```

验证用户控制 XAML：

```
<UserControl x:Class="ValidationWPF.ValidationUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
             xmlns:local="clr-namespace:ValidationWPF.DataSources"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <UserControl.Resources>

    </UserControl.Resources>
    <Grid x:Name="LayoutRoot" Background="White">

        <telerik:RadTreeView x:Name="radTreeView" Margin="8">
            <telerik:RadTreeView.ItemTemplate>

                <HierarchicalDataTemplate ItemsSource="{Binding SubItems}">
                    <TextBlock Text="{Binding item}" />
                </HierarchicalDataTemplate>

            </telerik:RadTreeView.ItemTemplate>
        </telerik:RadTreeView>

    </Grid>
</UserControl> 
```

输出：

```
Customer
      Name
         Message Below*
    *System.Collections.ObjectModel.ObservableCollection'1[ValidationWPF.DataSources.ValidationMessages] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:30:37.677

您的`item`属性应该是类型`ObservableCollection<ValidationMessages>` 如果不是，那么您应该首先遍历`item`集合并生成一串验证消息，然后再将其分配给 Message.item。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T06:14:23.707

您的输出很好，因为您写道：

```
Message.item = new ObservableCollection<ValidationMessages>().ToString(); 
```

# vb.net - 如何使用 Rally REST API 创建子故事并将其与父用户故事相关联？

> ID：10727739
> 
> 赞同：1
> 
> 时间：2012-05-23T20:58:39.853
> 
> 标签：vb.net, rest, rally

我正在使用 Rally REST API 将来自 Rally 的用户故事数据集成到另一个应用程序中。我了解如何创建故事并将其与工作区、项目和迭代相关联，但如何将其作为子故事插入并将其与另一个父故事相关联。这是我到目前为止所尝试的。

```
Dim restApi As RallyRestApi = RunTimeConfig.GetRallyApi()
Dim djo As New DynamicJsonObject()
djo("Name") = cs.StoryName
djo("Description") = cs.StoryDesc
djo("WorkSpace") = "/workspace/" & pj.WorkspaceID
djo("Project") = "/project/" & pj.ProjectID
djo("Iteration") = "/iteration/" & it.SprintID
djo("Parent") = "/hierarchicalrequirement/" & par.UserStoryID
Dim re As CreateResult = restApi.Create("hierarchicalrequirement", djo) 
```

上面抛出一个 KeyNotFound 异常。

我也尝试先创建故事，然后将其更新如下：

```
Dim toUpdate As New DynamicJsonObject()
toUpdate("Parent") = "/hierarchicalrequirement/" & par.UserStoryID
Dim result As OperationResult = restApi.Update(re.Reference, toUpdate) 
```

这仍然没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:12:36.767

您使用的是哪个版本的 REST API？KeyNotFoundException 可能是早期版本的库中围绕解析错误的错误的结果。可能发生的情况是创建失败但 CreateResult 没有正确解析返回的错误。我建议升级到此处提供的最新版本：

[http://developer.rallydev.com/help/rest-api-net](http://developer.rallydev.com/help/rest-api-net)

# spring - 如果 @Cacheble Spring AOP 应用于同一函数，则不会拦截 AspectJ 方面

> ID：10727745
> 
> 赞同：1
> 
> 时间：2012-05-23T20:59:11.297
> 
> 标签：spring, aop, aspectj, ehcache, spring-aop

我在@Controller 类的函数上定义了两个方面。

一种是@Cacheble（Ehcache Spring注解，使用Spring AOP）。

另一个是计算执行时间的环绕建议。这是一个 AspectJ 编译时方面。

第一次调用该方法时，两个方面都在执行。但是，对于所有后续调用，仅拦截 @Cacheble 方面。另一个建议（计算执行时间）没有被拦截。为什么这没有被拦截？我已经为这两个方面设置了@Order，但这无济于事。

计算执行时间的第二个方面如下

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
@Order(value = 0)
public @interface MonitorPerformance {   
} 
```

Dispathcher-servlet.xml 已
`<ehcache:annotation-driven create-missing-caches="true" cache-manager="ehCacheManager" order="1"/>` 期待您的建议。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:06:55.840

要执行方面，您必须在从容器获取的实例上调用您的方法。是这样吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T09:03:02.577

仅供参考，如果这是带有 spring AOP 的编译时 AspectJ，那么它不会在缓存的结果上执行编译的方面。编译类的字节码直接在方法周围注入。如果 this 在没有调用方法的情况下被代理并返回（这就是 cacheable 所做的），那么自然不会调用后一个方面。

# shell - 回显 shell 脚本中正在运行的命令

> ID：10727748
> 
> 赞同：0
> 
> 时间：2012-05-23T20:59:29.973
> 
> 标签：shell, echo

是否可以在 shell 脚本中回显正在运行的命令？

（没有把 -X 在 sheabang 中打开调试模式。这不是调试过程的一部分）

谢谢

[编辑：更多细节]

假设我有一个这样的脚本：

```
#! /bin/sh

clear
cd ~/home/ 
```

如何将执行的两个命令（`cd`和`clear`）打印到控制台？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T19:27:22.720

在我的版本（Debian Almquist Shell，dash）上，除了获得这种行为`/bin/sh`之外别无他法。`-x`回显命令也是 的*唯一*效果`-x`，所以我认为没有理由不使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:09:25.297

```
echo $0 
```

这将回显命令行中的第一个单词。如果您指定了一个相对路径，例如“./bin/test”，它将显示整个路径，因此您可能需要：

```
echo $(basename $0) 
```

那只会回显“test”，而不是“./bin/test”。

脚本在错误消息中使用 $0 而不是硬编码名称是很常见的，因为可以重命名或从符号链接调用程序。

# sql - sql server中的联合递归查询

> ID：10727749
> 
> 赞同：1
> 
> 时间：2012-05-23T20:59:36.007
> 
> 标签：sql, sql-server, recursive-query

我需要联合两个不同的递归查询。有人认为：

```
with cte1 as
( select....
....
....
)
select * from cte1

union all

with cte2 as
( select....
....
....
)
select * from cte2 
```

我该怎么做？我收到错误：关键字“WITH”附近的语法不正确。

你知道有什么解决方法吗？我试图通过互联网搜索，但我找不到它..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T21:01:35.250

顺序应该是：

```
;WITH Cte1 AS
(
....
),
Cte2 AS
(
....
)
SELECT * FROM Cte1
UNION ALL
SELECT * FROM Cte2 
```

你所有的`CTE`s 都需要在一系列语句的开头。

# html - Chrome 中的 HTML5 Canvas 突然停止工作。为什么？

> ID：10727750
> 
> 赞同：1
> 
> 时间：2012-05-23T20:59:48.683
> 
> 标签：html, google-chrome, canvas

我在这个网站上工作了一段时间，最近开始用新的动画 HTML5 菜单替换我的旧动画 Flash 菜单。到目前为止，我所拥有的只是一些随机四处游荡的彩色球体。我已经有几个星期没有机会工作了，但是当我今天上车时，我注意到我的导航消失了！当我刷新页面（在 Chrome 中）时，整个 Canvas 区域变黑。这只发生在 Chrome 中（在 Firefox 和 Safari 中运行良好），自从几周前它开始工作以来，我没有对任何东西进行任何更改。

有人知道这里发生了什么吗？

编辑：完全忘记包含网址。它是 [http://www.tylergerard.com](http://www.tylergerard.com) 此外，还有很多 javascript 可能是非常错误的。我很感激对此的任何反馈，但这篇文章是关于 Canvas 特定问题的。

# microcontroller - 剥离 4 字节的字符

> ID：10727753
> 
> 赞同：1
> 
> 时间：2012-05-23T20:59:57.933
> 
> 标签：microcontroller, pic, strip, uart, adc

好的！我想制作一个应用程序以在进度条上显示接收到的数据微控制器发送从 0 到 1023 的 adc 值，但我不知道如何制作这个我制作的串口终端：

```
公开课形式1
    将 RSPort 调暗为数组
    委托子 SetTextCallback(ByVal [text] As String)

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As EventArgs) 处理 MyBase.Load
        RSPort = IO.Ports.SerialPort.GetPortNames()
        LBaud.SelectedIndex = 1

        对于 i = 0 到 UBound(RSPort)
            LPort.Items.Add(RSPort(i))
        下一个
        LPort.Text = LPort.Items.Item(0)
        bDisconnect.Enabled = False

    结束子

    Private Sub bConnect_Click(ByVal sender As Object, ByVal e As EventArgs) 处理 bConnect.Click
        SerialPort1.PortName = LPort.Text
        SerialPort1.BaudRate = LBaud.Text
        SerialPort1.Parity = IO.Ports.Parity.None
        SerialPort1.StopBits = IO.Ports.StopBits.One
        SerialPort1.DataBits = 8
        SerialPort1.Open()

        bConnect.Enabled = False
        bDisconnect.Enabled = True

    结束子

    Private Sub bDisconnect_Click(ByVal sender As Object, ByVal e As EventArgs) 处理 bDisconnect.Click
        SerialPort1.Close()
        bConnect.Enabled = True
        bDisconnect.Enabled = False
    结束子

    Private Sub SerialPort1_DataReceived(ByVal sender As Object, ByVal e As System.IO.Ports.SerialDataReceivedEventArgs) 处理 SerialPort1.DataReceived
        ReceivedText(SerialPort1.ReadExisting())
    结束子
    Private Sub ReceivedText(ByVal [text] As String)
        If rtbReceived.InvokeRequired Then
            Dim x As New SetTextCallback(AddressOf ReceivedText)
            调用（x，新对象（）{（文本）}）
        别的
            rtbReceived.Text &= [文本]
        万一
    结束子

    Private Sub LBaud_SelectedIndexChanged(sender As Object, e As EventArgs) 处理 LBaud.SelectedIndexChanged
        如果 SerialPort1.IsOpen = False 那么
            SerialPort1.BaudRate = LBaud.Text
        别的
            MsgBox("仅当端口关闭", vbCritical)
        万一
    结束子

    Private Sub LPort_SelectedIndexChanged(sender As Object, e As EventArgs) 处理 LPort.SelectedIndexChanged
        如果 SerialPort1.IsOpen = False 那么
            SerialPort1.PortName = LPort.Text
        别的
            MsgBox("仅当端口关闭", vbCritical)
        万一
    结束子
结束类
```

查看数据女巫看起来相同这个“1023101509410888085208510828075706520558048704290374”，我想在进度栏中显示这个，但每个数字都是一一收到的......对不起我的英语，我是罗马尼亚人......

# spss - 为空单元格生成平均值

> ID：10727759
> 
> 赞同：1
> 
> 时间：2012-05-23T21:00:41.363
> 
> 标签：spss

我是 SPSS 新手，我正在尝试为空单元格生成平均值（基本上通过用户给出的平均答案填写缺失的信息），我无法让我的示例代码工作（或很好地理解示例）。

```
COMPUTE QOL_puutt = Nmiss(ass, bass, grass, gas). 
```

这部分我明白

```
Do repeat A  = ass1 ass2  ass3\. If ((Missing (A)) & QOL_puutt <= 4) A
= RND(Mean (ass1, ass2, ass3)).  End repeat. 
```

这里出了点问题。我知道 ass1,ass2,ass3 是指单元格（第 3 列）？？？以下是错误代码

```
Error # 4285 in column 15\. Text: ass1 Incorrect variable name: either the name is more than 64 characters, or it is not defined by a previous command. Execution of this command stops.

Error # 4285 in column 15\. Text: ass2 Incorrect variable name: either the name is more than 64 characters, or it is not defined by a previous command. Execution of this command stops.

Error # 4285 in column 15\. Text: ass3 Incorrect variable name: either the name is more than 64 characters, or it is not defined by a previous command. Execution of this command stops 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:12:44.123

由于包装，很难说出代码是什么，但您可以像这样简化它 do repeatA = ass1 ass2 ass3\. 如果缺少（A）A = 平均值（屁股，低音，草，气）。结束重复。

如果缺少所有值，mean 将自动返回 sysmis。如果您想要求一定数量的非缺失值，例如 2，您可以将语句编写为缺少（A）A = mean.2(ass, bass, Grass, gas)。

HTH，乔恩·派克

# pointers - 迭代器与指针类成员？

> ID：10727767
> 
> 赞同：0
> 
> 时间：2012-05-23T21:01:10.833
> 
> 标签：pointers, iterator

我想我刚刚发现了问题（也许没有？），但我想了解原因。以下是代码快照。我试图让它尽可能简单；

```
class FOO
{
public:
    int m_iNum; //sort according to this.
    std::vector<unsigned char>::iterator m_itContents; 
            //filling this contributes to issue with sorting in debug only? 
            //m_Contents does not come into other  sections below at all.
    unsigned char *m_Contents; //using this instead, 
                                       //no asserts or crash in debug.
};

class MyFile
{
public:
    std::vector<FOO> vFoo1; //this gets filled with file data.
};

std::vector<FOO> vFooVirtualList; //class member

int iColumnSel = -1;
int iSortResult1 = 1;
int iSortResult2 = -1;
int iVirtualListCount = 0;

void FillList()
{
    std::vector<Foo>::iterator itFoo;
    itFoo = MyFile->Foo1.begin() ;
    iVirtualListCount = 0;

    vFooVirtualList.clear();
    std::vector<Foo> vTemp;
    vTemp.swap( vFooVirtualList );
    vFooVirtualList.reserve(FileCount); // int filecount 

    for(int i=0;i< FileCount ;i++ ,itFoo++) 
            {
            vFooVirtualList.push_back(*itFoo);
            iVirtualListCount++;
    }
    // Tell the list box to update itself.
    m_List.SetItemCountEx(iVirtualListCount); 
            //m_List is CListCtrl, used as virtual list.
    m_List.Invalidate();
}

void OnLvnGetdispinfoMainframelist(NMHDR *pNMHDR, LRESULT *pResult)
{
    NMLVDISPINFO *pDispInfo = reinterpret_cast<NMLVDISPINFO*>(pNMHDR);
    LV_ITEM* pItem= &(pDispInfo)->item;
    std::vector<FOO>::iterator itFooList;
    itFooList = vFooVirtualList.begin() + pItem->iItem;
    CString str;

    if(pItem->mask & LVIF_TEXT)
    {
        // then display the appropriate column
        switch(pItem->iSubItem)
        {
        case 0:
            str.Format(L"%d",itFooList->m_iNum);  
            lstrcpy(pItem->pszText, str);
            break;

        default:
            break;
        }
    }
    *pResult = 1;
}

//sort by column
void OnLvnColumnclickMainframelist(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMLISTVIEW pNMLV = reinterpret_cast<LPNMLISTVIEW>(pNMHDR);    
    for(iColumnSel = 0; iColumnSel < 1; iColumnSel++)
    {
        if(iColumnSel == pNMLV->iSubItem)
            SortByCol(iColumnSel);
    }
    // Redraw the list.
    m_List.Invalidate();        
    *pResult = 0;
}

//sorting done based only on Num.
int __cdecl CompareByFileNum(const void *elem1, const void *elem2)
{
    int result = 0;
    FOO *Item1 = (FOO*)elem1;
    FOO *Item2 = (FOO*)elem2;

    switch(iColumnSel)
    {
        case 0:
            if(Item1->m_iNum <  Item2->m_iNum)
                result = iSortResult1;
            if(Item1->m_iNum > Item2->im_Num) 
                result = iSortResult2;
            return result;
            break;
        default:
            break;
    }
    return 1;
}

void SortByCol(const int ColIndex)
{
    //fill list. sort. then load another file = crash. Only in debug mode?
    //if list is in proper order, no problem on new file load. otherwise crash.
    qsort( static_cast<void*>(&vFOOVirtualList[0]), iVirtualListCount, sizeof(FOO), CompareByFileNum);
    iSortResult1 = (iSortResult1*-1);
    iSortResult2 = (iSortResult2*-1);
} 
```

想知道迭代器有什么特别需要做的吗？ `FillList()`这里工作正常，除了在第二次调用（即新文件）时，如果虚拟列表的顺序与第一次不同，新文件崩溃，但仅在调试模式下，并且仅当我使用迭代器而不是指针时。在任何一种情况下，我都会得到“ `iterator list corrupted or Unhandled exception at 0x0042c509`”（略有变化）和引用 xutility，分别是第 181 行或第 177 行。

# entity-framework-4 - 使用 EF Code First 将带有基类的对象层次结构加载到会话中

> ID：10727771
> 
> 赞同：1
> 
> 时间：2012-05-23T21:01:27.143
> 
> 标签：entity-framework-4, ef-code-first

正如我在我的问题[Eagerly Load Navigation Property 中`List<OfSomeBaseClass>`](https://stackoverflow.com/questions/10342709/eagerly-load-navigation-property-that-is-listofsomebaseclass)发现的那样，无法使用 EF`.Include()`方法加载派生类的属性（这已被[建议为未来的 EF 功能](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/1249289-include-property-of-derived-classes)）。

我通过迭代包含兄弟类型混合的集合来解决这个问题，分别调用

```
ctx.Entry(myDerivedType).Reference("PropOfDerivedType").Load(); 
```

这会导致对数据库进行许多额外的往返，但至少它可以工作。

现在我需要加载这样的对象层次结构并将其保存在 MVC Web 应用程序的 Session 中。由于`DbContext`不应该是会话的一部分，我*相信*我必须加载对象图`AsNoTracking()`，如下所示：

```
var myGraph = (from my in ctx.MyHierarchyRoot.Include("NonDerivedStuff")
               .AsNoTracking()
               where CONDITION select my).Single(); 
```

**问题 1**

`.AsNoTracking()`如果将对象图存储在Session中，使用是否必要且正确？

然后我继续遍历层次结构中的派生兄弟并尝试像这样加载它们：

```
foreach (SomeBase b in myGraph.SomeCollection)
{
    if (b is SomeConcreteDerivedType)
    {
        ctx.Entry(b).Reference("SomePropertyOfSomeConcreteDerivedType").Load();
    }
} 
```

但是，由于我使用 myGraph 加载`.AsNoTracking()`，我得到：

> 无法为属性“SomePropertyOfSomeConcreteDerivedType”调用成员“Load”，因为上下文中不存在“SomeConcreteDerivedType”类型的实体。要将实体添加到上下文中，请调用 DbSet 的 Add 或 Attach 方法。

**问题2**

假设问题 1 的答案是“是”，如何正确加载派生类型的导航属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T08:58:37.170

> `.AsNoTracking()`如果将对象图存储在Session中，使用是否必要且正确？

有必要确保存储在会话中的实体不包含对上下文的任何引用（并且不需要上下文）。这应该通过在将实体保存到会话之前分离实体来执行，但分离总是会破坏关系。在这种情况下，最简单的解决方法是禁用代理创建（延迟加载和动态更改跟踪将不起作用）。

另一种方法是以正常方式加载实体图并创建图的深度克隆（序列化）。深度克隆始终与上下文完全分离，并且可以安全地存储在会话中。

# regex - vim 替代分支中的子匹配

> ID：10727772
> 
> 赞同：1
> 
> 时间：2012-05-23T21:01:28.940
> 
> 标签：regex, vim

我想使用多个分支进行搜索，并从匹配分支中获取子匹配项以用于替换。

对于这个特定问题，我想抓取完全由 '=' 或 '-' （较小的子集）中的一个字符组成的任何行，其中至少包含 3 个该字符，每个字符的空格条件不同。

所以我使用下面的表达式来匹配它们：

```
^\t\(=\)\{3,}\_$\|[ ]\{5,}^\(-\)\{3,}\_$ 
```

我接下来想做的是在替换中使用子匹配。我以为我可以这样做：

```
:.s/^\t\(=\)\{3,}\_$\|[ ]\{5,}^\(-\)\{3,}\_$/apple\1banana/e 
```

但它似乎只在第一个分支（带有'='）匹配时才有效，而不是第二个分支。我怎样才能使这项工作？我正在寻找一种解决方案，它可以让我使用 20 个分支并且仍然能够从匹配的分支中获取子匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:57:16.243

据我所知，您不需要组。这似乎与您的命令相同（我没有要测试的样本）：

```
:.s/^\t\zs=\ze=\{2,}$\|^[ ]\{5,}\zs-\ze-\{2,}$/apple&banana/e 
```

这会将所有 [-=] 放入替换中：

```
:.s/^\t\zs=\{3,}$\|^[ ]\{5,}\zs-\{3,}$/apple&banana/e 
```

如果您可以分享您需要编辑的文本样本和预期结果，它将更容易测试我所写的内容是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T22:03:10.093

您可以使用零宽度模式和反向引用来做到这一点：

```
\(\%(^\t\)\@<==\{3}\|\%([ ]\{5,}^\)\@<=-\{3}\)\_$ 
```

零宽度模式可让您将模式从匹配某些字符转换为匹配位置。 `\@<=`只是说前面的模式发生在当前位置之前。

`\zs``\%(...\)\@<=`是一种特殊情况，可让您简化任何以to开头的模式`...\zs`。

另一种方法是简单地使用替换中的所有反向引用 - 来自不匹配分支的那些将扩展为空字符串：

```
:.s/^\t\(=\)\{3,}\_$\|[ ]\{5,}^\(-\)\{3,}\_$/apple\1\2banana/e 
```

# backbone.js - 使用 require.config 加载基本模型

> ID：10727773
> 
> 赞同：0
> 
> 时间：2012-05-23T21:01:31.697
> 
> 标签：backbone.js, requirejs

我有一个扩展 Backbone.Model 的基本模型，并在我的所有模型中使用它。我想将它包含在 require.config.paths 中，以便在每个模块中我可以定义（['underscore'，'backbone'，'basemodel']，function（...））。但是，require 无法加载它。

我检查了所有路径，当我在我的定义函数中给出文件的直接路径时，它可以工作......模型/混合/基本模型

不可能在路径中包含模块吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:08:10.943

嗯...如果它不起作用，您是否使用 require.config 设置了路径？至少，您必须设置 baseURL 字段：

```
require.config({
    baseUrl:'/js/',
    paths:{
        text:'lib/3rdparty/text'
    }
}); 
```

然后，如果您有长路径，则可以设置别名路径。

# java - 基于java文本的战争纸牌游戏

> ID：10727775
> 
> 赞同：-7
> 
> 时间：2012-05-23T21:01:37.420
> 
> 标签：java, arrays, text, arraylist

我需要一些帮助在 java 中创建战争纸牌游戏。我对 ArrayLists 非常缺乏经验，我猜这是我需要用来从计算机的卡片数组和用户的卡片数组中添加和删除卡片的东西。

谁能给我一些关于我应该采取的步骤以及我可以用来打印、比较等卡片的 ArrayList 方法的帮助吗？

欢迎使用代码，我对此有点陌生！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:07:07.170

1.  考虑制作某种`Card`可以处理所有花色和值的对象。
2.  创建一个`ArrayList<Card>`来存放卡片。
3.  实现游戏逻辑：
    1.  使用 将 ArrayList 前面的卡片出列`ArrayList.remove(int)`，并使用 将它们入队`ArrayList.add(Object)`。
    2.  考虑在转弯时会发生什么。每个人都`Card`必须有一个重量。
    3.  考虑一下当两张相同重量的牌被放下时会发生什么。那你怎么办呢？

* * *

把这些东西移开。代码可以稍后出现。此外，请查看 Java API 的[`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html); 它会对你有很大帮助。

# javascript - 再次单击时如何将链接的颜色从黑色更改为红色并变回黑色

> ID：10727778
> 
> 赞同：0
> 
> 时间：2012-05-23T21:02:00.387
> 
> 标签：javascript

情况是我有一个从 A 到 Z 的索引，当我点击一个字母时，会显示相应的 div。当再次单击相同的字母时，div 会折叠。

我想要实现的是，当我第一次单击一个字母时，它应该将顶部垂直对齐索引中的字母颜色更改为红色。再次单击时从红色变回黑色。

当单击另一个字母时，我找到的解决方案会重置颜色。所以问题是多个 div 将处于活动状态，并且多个字母应该是红色的。但是，我无法让它工作。

我知道 javascript 是解决方案，但我不是一个好的 Java 编码器。我尝试了 inner/outerHTML 和 getElementbyID 但每次尝试都失败了。

我希望有人能帮帮忙。3 个字母的简短解决方案就足够了。

代码可以在[http://www.webpati.com/index.txt找到](http://www.webpati.com/index.txt)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:29:50.493

只需添加

```
$(this).toggleClass('active'); 
```

到底部附近的 jQuery 单击功能，并添加一个 CSS 规则，例如

```
.slick-toggle { color: black; }
.slick-toggle.active { color: red; } 
```

[jsfiddle](http://jsfiddle.net/AzJk6/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:11:41.937

感谢jsfiddle的回答。在 javascript 的末尾，我把它的代码 - 在下面以粗体显示 - 它工作。

```
jQuery("a.slick-toggle").click(function () {

 if($(this).children("span").text() == "") {

    $(this).children("span").text('');

      } else {

        $(this).children("span").text('Show');

      } 

var id = jQuery(this).attr('id');

jQuery("#slickbox" + id).fadeToggle({

speed:200,easing : "swing"})

**$(this).toggleClass('active');**

return false;

}); 
```

# dependencies - TeamCity 正在构建未更改的依赖项

> ID：10727785
> 
> 赞同：0
> 
> 时间：2012-05-23T21:02:25.703
> 
> 标签：dependencies, teamcity

我是 TeamCity 的新手，遇到了一些麻烦。我有一个构建 Windows Installer (MSI) 包的配置。它对构建合并模块（用于构建 MSI 的东西）的其他配置具有快照依赖关系。即使合并模块的最后一次构建成功并且它们的源代码没有更改，但每次我构建 MSI 时它们仍然会重新构建。如果自上次成功构建以来它们的源代码没有更改，我希望合并模块*不会被重建。*

关于我的情况的说明：

*   在依赖项选项中，我选择“如果有合适的版本，则不要运行新版本”和“仅使用来自合适版本的成功版本”。所有合并模块都成功构建。
*   我们正在使用 Subversion 1.7 和 TeamCity 5.1.5（目前无法轻松升级）。
*   来自存储库中其他地方的不相关更改显示为与我的配置相关联。这可能是问题所在，如果是，如何解决？
*   此处提到的所有构建配置都具有相同的 VCS 根和检出规则。所有 VCS 根都设置为“完全支持（加载更改和签出）”。
*   由于 MSI 中引用了其中一些文件，因此正在检出大部分存储库。
*   让我知道我是否应该在此处包含更多信息。

谁能阐明 TeamCity 如何决定何时需要重建依赖项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:55:05.770

在许多情况下，此问题是由在 Subversion VCS 根目录中选择的“签出，但忽略更改”选项引起的。如果是这种情况，我建议切换到完全外部支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-11T20:25:47.243

编辑依赖项并选择

“如果有合适的版本，请不要运行新版本”

# backbone.js - Backbone - 将thead保留在表格视图中

> ID：10727786
> 
> 赞同：2
> 
> 时间：2012-05-23T21:02:33.173
> 
> 标签：backbone.js

我正在为我的项目使用 Backbone.js。
抱歉，我是 Backbone 新手，因此我可能会遗漏一些非常琐碎的东西。

这是一个 HTML 片段：

```
<table id="notes" class="table">
    <thead>
        <tr><th>title</th><th>comment</th></tr>
    </thead>
    <tbody id="notesTableBody">
    </tbody>
</table> 
```

这是应该在该片段中“注入” HTML 的主干代码：

```
App.view.NoteListView = Backbone.View.extend({

    el:"tbody#notesTableBody",

    initialize:function () {
        this.model.bind("reset", this.render, this);
    },

    render:function (eventName) {
        _.each(this.model.models, function (note) {
            $(this.el).append(new App.view.NoteListItemView({model:note}).render().el);
        }, this);
        return this;
    }

}); 
```

为了清楚起见，我没有粘贴`NoteListItemView`代码，因为我认为它不相关。

我的问题是Backbone渲染的HTML代码如下：

```
<table id="notes" class="table">
    <tbody id="notesTableBody">
    <tr><td>title 1</td><td>comment 1</td></tr>
    </tbody>
</table> 
```

基本上，Backbone 从桌子上移除了头。
我不明白为什么 - 我如何确保 Backbone 不会删除它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:54:24.887

你`NoteListView`不会在它之外写任何东西`el`（例如：http: [//jsfiddle.net/ambiguous/cFvX2/](http://jsfiddle.net/ambiguous/cFvX2/)）所以你的问题在别处。

我的猜测是您正在做与此等效的事情：

```
var v = new App.view.NoteListView;
$('#notes').html(view.render().el); 
```

这将完全用（即's ）替换`#notes`表格的内容。`<tbody>``NoteListView``el`

有几种方法可以解决您的问题。您可以调用`render`并忽略它返回的内容：

```
var v = new App.view.NoteListView;
v.render(); 
```

这几乎就是我的第一个演示小提琴所做的。

或者您可以使用[`id`and`tagName`而不是`el`](http://backbonejs.org/#View-el)：

```
App.view.NoteListView = Backbone.View.extend({
    id: 'notesTableBody',
    tagName: 'tbody',
    initialize:function () {
        this.model.bind("reset", this.render, this);
    },
    render:function (eventName) {
        _.each(this.model.models, function (note) {
            $(this.el).append(new App.view.NoteListItemView({model:note}).render().el);
        }, this);
        return this;
    }
}); 
```

然后[`append`](http://api.jquery.com/append/)视图`el`是`$('#notes')`：

```
var v = new App.view.NoteListView;
$('#notes').append(v.render().el); 
```

演示：http: [//jsfiddle.net/ambiguous/HTAkM/](http://jsfiddle.net/ambiguous/HTAkM/)

您还可以让调用者指定`el`：

```
App.view.NoteListView = Backbone.View.extend({
    initialize:function () {
        this.model.bind("reset", this.render, this);
    },
    render: function(eventName) {
        _.each(this.model.models, function (note) {
            $(this.el).append(new App.view.NoteListItemView({model:note}).render().el);
        }, this);
        return this;
    }
}); 
```

然后`render`进入`el`而不关心`render`' 的返回值：

```
var v = new App.view.NoteListView({ el: $('#notesTableBody') });
v.render(); 
```

演示：http: [//jsfiddle.net/ambiguous/2Ptkp/](http://jsfiddle.net/ambiguous/2Ptkp/)

* * *

当我在这里时，您不再需要`$(this.el)`，最新版本的 Backbone 提供[`this.$el`](http://backbonejs.org/#View-%24el)您的观点：

> **$el** `view.$el`
> 
> 视图元素的缓存 jQuery（或 Zepto）对象。一个方便的参考，而不是一直重新包装 DOM 元素。

如果您的视图正在包装一个集合，您应该使用`this.collection`而不是`this.model`：

```
new SomeView({ collection: some_collection }) 
```

视图特别对待[`collection`选项，就像`model`](http://backbonejs.org/#View-constructor)：

> **构造函数/初始化** `new View([options])`
> 
> [...] 有几个特殊选项，如果通过，将直接附加到视图：`model`、`collection`、`el`、`id`、`className`和。`tagName``attributes`

Backbone 集合也[混合了几个 Underscore 方法，](http://backbonejs.org/#Collection-Underscore-Methods)所以你不需要这么说：

```
_.each(some_collection.models, function(m) { ... }); 
```

您可以`each`在集合上致电：

```
some_collection.each(function(m) { ... }); 
```

此外，如果您要绑定到一个`"reset"`事件：

```
this.model.bind("reset", this.render, this); 
```

你可能希望你在添加更多东西之前`render`清除它：`el`

```
render: function() {
    this.$el.empty();
    this.collection.each(function(note) { ... });
} 
```

如果你不这样做，当你可能打算用新东西替换它的内容时，你会添加更多的东西[`empty`](http://api.jquery.com/empty/)。`el`

# objective-c - 在 Objective-C 中解析 XML。检索特定值

> ID：10727788
> 
> 赞同：0
> 
> 时间：2012-05-23T21:02:39.793
> 
> 标签：objective-c, ios, xml, xml-parsing

我在 XML 中有以下字符串：

```
<Data>
    <Table>
        <Id>44</Id>
        <Name>My Name</Name>
        <Category>My Category</Category>
    </Table>
</Data> 
```

这包含在 NSString 中。我希望以最快的方式将类别转换为 NSString。我看过使用 NSXMLParser。我还查看了 XMLReader。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:20:21.597

实际上，我喜欢使用 XMLReader。

```
NSDictionary *dic = [XMLReader dictionaryForXMLString:xmlString error:nil];

category = [dic valueForKeyPath:@"Data.Table.Category.text"]; 
```

对我来说似乎很干净和简单。

# python - 如何在 Python 中进行迭代？

> ID：10727791
> 
> 赞同：0
> 
> 时间：2012-05-23T21:02:54.320
> 
> 标签：python

有什么办法可以缩短这段代码吗？

```
price1 = input("\nEnter price here: ")
price1 = int(price1)

price2 = input("\nEnter price here: ")
price2 = int(price2)

price3 = input("\nEnter price here: ")
price3 = int(price3)

price4 = input("\nEnter price here: ")
price4 = int(price4)

price5 = input("\nEnter price here: ")
price5 = int(price5)

price6 = input("\nEnter price here: ")
price6 = int(price6)

price7 = input("\nEnter price here: ")
price7 = int(price7)

price8 = input("\nEnter price here: ")
price8 = int(price8)

price9 = input("\nEnter price here: ")
price9 = int(price9)

price10 = input("\nEnter price here: ")
price10 = int(price10)

total = price1 + price2 + price3 + price4 + price5 + price6 + price7 + price8 + price9 + price10
grand_total = (18 * total /100 + total)

print("\nThe total amount weill equil to", grand_total, "(with 18% V.A.T)") 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T21:06:07.180

```
prices = []  # an empty list
for i in range(10):
    price = int(input("\nEnter price here: "))
    prices.append(price)  # append price to list

total = sum(prices) 
```

然后，您可以参考每个单独的价格，例如`prices[index]`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T21:08:19.963

您可以使用累加器值：

```
total = 0
for i in range(10):
    total += int(input("\nEnter price here: "))
grand_total = 18 * total / 100 + total
print("\nThe total amount will equal to", grand_total, "(with 18% V.A.T)") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T21:51:32.713

Protip：避免使用`float`与钱一起工作以避免舍入错误

```
from decimal import Decimal

def get_price():
    return Decimal(input("\nEnter price here: "))

total = sum(get_price() for i in range(10))
grand_total = total * Decimal("1.18") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T21:09:46.283

使用生成器表达式：

```
total = sum( int(raw_input("\nEnter price here: ")) for i in xrange(10) )
grand_total = int(1.18 * total) # intended integer division? 
```

# asp.net-mvc - ASP MVC 组合视图

> ID：10727795
> 
> 赞同：0
> 
> 时间：2012-05-23T21:03:13.787
> 
> 标签：asp.net-mvc

对 ASP MVC 开发来说还是新手。假设我有一个 MusicController，它有 2 个视图：List（显示所有艺术家的列表）和 Highlights（显示 3 个包含所有详细信息的特定专辑）。

我现在想在一个页面上呈现两个视图。1) 最好的方法是什么？部分观点？我是否需要为显示两个部分视图的页面制作单独的控制器？2）假设我想根据所选艺术家更改亮点。如何将该参数传递给带有高亮显示的局部视图？

谢谢你给我一些线索！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:17:14.467

部分意见确实是你想要的。您可能会遇到的一个问题是，有时很难制作既可以作为独立视图又可以嵌入到另一个视图中的局部视图。解决方案是创建一个单独的视图，其中包含所有必要的样板，然后调用（单个）部分视图。那么局部视图既适用于单个页面，也适用于组合页面。

您的聚合视图不需要单独的控制器，但它需要自己的操作。

所以这是我提倡的结构：

在`MusicController`：

```
public ActionResult List() {
  return View();
}
public ActionResult Highlights() {
  return View();
}
public ActionResult ListAndHighlights() {
  return View();
} 
```

`List`和的视图`Highlights`看起来像这样：

```
<div class="anyNecessaryChrome">
  @RenderPartial( "ListPartial" )
</div> 
```

`ListAndHighlights()`看起来像这样：

```
<div class="listChrome">
  @RenderPartial( "ListPartial" )
</div>
<div class="highlightsChrome">
  @RenderPartial( "HighlightsPartial" )
</div> 
```

如果您希望部分视图更新以响应客户端的某些内容，则必须使用 AJAX。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:11:28.777

看看[`Html.RenderAction()`和`Html.RenderPartial()`](http://haacked.com/archive/2009/11/18/aspnetmvc2-render-action.aspx)

或者，我会将艺术家列表作为视图并使用 AJAX 加载亮点。

**为此，您只需要 2 个操作方法**

```
public class ArtistsController {
    public ActionResult Index() {
        return View();
    }
} 
```

**和**

```
public class AlbumsController {
    [HttpGet]
    public JSONResult GetHighlights(int artistId) {
        return JSON(Albums.GetHighlights(artistId), JsonRequestBehavior.AllowGet);
    }
} 
```

**还有一些示例 HTML**

```
<ul id="artists">
   <li><a href="#" data-artist-id="1">Michael Jackson</a></li>
   <li><a href="#" data-artist-id="2">Tom Jones</a></li>
</ul> 
```

**然后您可以使用 jQuery 调用 Highlights 操作方法`$.get`**

```
$("#artists a").click(function(e) {
    var id = $(this).data("artist-id");
    $.get("/Albums/GetHighlights/" + id, function(data) {
        // Populate highlights section with data from server
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:26:12.757

您可以为此创建一个 ViewModel 存储艺术家列表和专辑列表

```
public class ArtistWithHighlights
{
  public Artist Artist { set;get;}
  public IEnumerable<Albums> Albums{ set;get;}
} 
```

并在 Controller 中，为 GET 视图编写一个操作方法。在那个获取所有艺术家和获取专辑属于第一个艺术家。（您可以根据您的要求更改此设置）

```
public ActionResult ArtistsWithHighLights()
{
  List<ArtistWithHighlights> allArtists=new List<ArtistWithHighlights>();
  allArtists=GetAllArtists();

  //If we have atlease one artist in the list, Load the albums for the first one only
  if(allArtists.Count>0)
  {
     allArtists[0].Albums=GetAlbumsForArtist(allArtists[0].Artist.ArtistID);
  }    
  return View(allArtists);       
} 
```

你的强类型视图是这样的

```
@model List<ArtistWithHighlights>

@foreach(var artist in Model)
{
  <a id="@artist.ID" class="artistName">@artist.Name</p>
}
<div id="albums">
  <h3>Highlighted Albums</h3>
  @foreach(var album in Model[0].Albums)
  {
     <p>@album.Name</p>
  }
</div> 
```

为了在选择时获取另一个艺术家的专辑（点击事件），您可以对另一个`Action`方法进行 ajax 调用，该方法返回传递的艺术家 ID 的专辑列表，然后您可以在 div 中显示它。

```
$(function(){
 $(".artistName").click(function(e){
  e.preventDefault();
   var  artistId=$(this.attr("id");
     $("#albums").load("../Albums/"+artistId);
  });
}); 
```

# mysql - 来自三个表的 MySQL 视图

> ID：10727804
> 
> 赞同：1
> 
> 时间：2012-05-23T21:04:13.557
> 
> 标签：mysql, view, many-to-many

我已经阅读了大量的帖子、书籍、观看的视频等，但 SQL JOINS 对我来说从来没有任何意义...... =/

所以这是交易...

三张表：

```
CREATE TABLE IF NOT EXISTS `feature` (  
  `feature_id` INT NOT NULL AUTO_INCREMENT ,  
  `title` VARCHAR(45) NOT NULL ,  
  `description` TEXT NOT NULL ,  
  PRIMARY KEY (`feature_id`) )  
ENGINE = InnoDB;  

CREATE TABLE IF NOT EXISTS `requirement` (  
  `requirement_id` INT NOT NULL AUTO_INCREMENT ,  
  `title` VARCHAR(45) NOT NULL ,  
  `description` TEXT NOT NULL ,  
  PRIMARY KEY (`requirement_id`) ,  
  UNIQUE INDEX `title_UNIQUE` (`title` ASC) )  
ENGINE = InnoDB;  

CREATE TABLE IF NOT EXISTS `feature_requirement` (  
  `fk_feature_id` INT NOT NULL ,  
  `fk_requirement_id` INT NOT NULL ,  
  PRIMARY KEY (`fk_feature_id`, `fk_requirement_id`) ,  
  INDEX `fk_feature_requirement_requirement1` (`fk_requirement_id` ASC) ,  
  INDEX `fk_feature_requirement_feature1` (`fk_feature_id` ASC) )  
ENGINE = InnoDB; 
```

一些功能可能有多个要求，而一些功能将有相同的要求（即，相同的要求适用于多个功能）因此，第三个表用于多对可能关系。

我希望能够选择特定功能的所有要求（通过 feature_id），我正试图将其变成一个 VIEW。

在大量关于“未知列”和“非唯一别名”的错误消息之后；我终于得到了这个工作：

```
CREATE VIEW `project_feature_requirement` AS  
SELECT r.*  
FROM `requirement` `r`  
INNER JOIN `feature_requirement` `fr`  
    on `r`.`requirement_id` = `fr`.`fk_requirement_id`  
INNER JOIN `feature` `f`  
    on `fr`.`fk_feature_id` = `f`.`feature_id` 
```

但是，这只给了我对 SELECT 的需求 ID、标题和描述。……没用的

我有四个其他视图要创建，它们将是相同类型的查询。

任何帮助将不胜感激！

是否有任何免费程序可以查询我的架构并通过“向导”或其他方式运行我以指定我想要哪些表/列以及我想要选择哪些列并为我构建查询？？？也许我终于可以弄清楚是否可以使用这样的实用程序。

再次感谢！托德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:09:49.603

这应该对你有用，但你应该在数据库中处理你的命名约定。在同一个查询中有多个名为 title 的字段可能会造成不必要的混乱：

```
CREATE VIEW `project_feature_requirement` AS  
    SELECT r.*, f.feature_id, f.title as ftitle, f.description as fdesc  
    FROM `requirement` `r`  
    INNER JOIN `feature_requirement` `fr`  
        on `r`.`requirement_id` = `fr`.`fk_requirement_id`  
    INNER JOIN `feature` `f`  
        on `fr`.`fk_feature_id` = `f`.`feature_id` 
```

这可能是编写查询的更清晰且不易出错的方式：

```
SELECT r.*, f.feature_id, f.title as ftitle, f.description as fdesc  
FROM feature_requirement fr 
JOIN requirement r ON r.requirement_id=fr.fk_requirement_id
JOIN feature f on f.feature_id=fr.fk_feature_id 
```

# iis - 如何使用 PowerShell 停止 IIS？

> ID：10727807
> 
> 赞同：11
> 
> 时间：2012-05-23T21:04:31.790
> 
> 标签：iis, powershell

我正在学习 PowerShell 并试图在远程服务器上停止 IIS。

我正在使用以管理员模式启动的 PowerGUI 脚本编辑器。

我有这个代码

```
$service = Get-WmiObject Win32_Service -ComputerName 'myserver'  -Filter "Name='IISAdmin'"
$service
$service.StopService();
$service.State 
```

状态总是以运行状态返回。我不知道为什么它没有停止。

编辑

我在运行时遇到的错误

```
Invoke-Command -ComputerName 'myserver' { Stop-Service IISAdmin } 
```

> 连接到远程服务器失败并显示以下错误消息：客户端无法连接到请求中指定的目标。验证目标上的服务是否正在运行并且正在接受请求。请查阅在目标（最常见的是 IIS 或 WinRM）上运行的 WS-Management 服务的日志和文档。如果目标是 WinRM 服务，在目标上运行以下命令来分析和配置 WinRM 服务：“winrm quickconfig”。有关详细信息，请参阅 about_Remote_Troubleshooting 帮助主题。

编辑2

我发现了这个，它似乎有效。我不知道如何从 Stop-Service 取回信息，所以我不得不使用其他方式将其发送给我。如果你知道怎么做，请告诉我。

```
Stop-Service -Force -InputObject $(Get-Service -Computer myserver -Name IISAdmin)
$service = Get-WmiObject Win32_Service -ComputerName 'myserver '  -Filter "Name='IISAdmin'"
$service.State 
```

这行得通。我不明白为什么。我唯一能想到的是我必须使用 -Force 因为它不会停止服务器，否则也许这是一个原因？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-02-22T14:54:45.790

停止 IIS（如 iis-Manager 中服务器上的“右键单击 > 停止”）：

```
spsv iisadmin,was,w3svc -pa 
```

方法：

```
stop-service -name iisadmin,was,w3svc -passThru # -passThru is optional but basically outputs the result 
```

（替代方案：`gsv iisadmin,was,w3svc |spsv -pa|sasv -pa`重新启动服务并输出结果，但在本例中，第二个 -pa 是可选的！！！仅供参考：gsv=get-service，sasv=start-service，spsv=stop-service，pa=passThru）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-24T12:27:42.900

您可以使用 iisreset 远程停止/重新启动 iis：

```
iisreset [computername] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-23T21:12:43.120

```
Invoke-Command -ComputerName myserver { Stop-Service W3SVC} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T21:09:31.877

尝试使用 PsExec \Server2 -u Administrator -p somePassword IISReset /STOP

或使用 PowerGUI 脚本编辑器

```
$service = Get-WmiObject -computer 'ServerA' Win32_Service -Filter "Name='IISAdmin'"
$service
$service.InvokeMethod('StopService',$Null)
$service.State 
```

尝试使用

```
$server = "servername"
$siteName = "Default Web Site"
$iis = [ADSI]"IIS://$server/W3SVC"
$site = $iis.psbase.children | where { $_.keyType -eq "IIsWebServer" -AND
$_.ServerComment -eq $siteName }
$site.serverstate=3
$site.setinfo() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-17T05:15:07.760

我不喜欢处理 WMI 对象。相反，我建议`iisreset /stop`与 PowerShell 远程处理结合使用。所以，本质上是这样的：

```
Invoke-Command -ComputerName 'myserver' -ScriptBlock { & iisreset /stop } 
```

您也可以换出`/stop`以`/start`在远程服务器上启动 IIS。

如果您不想利用`iisreset.exe`PowerShell 而是使用纯 PowerShell，则可以`W3SVC`改为启动/停止服务：

```
Invoke-Command -ComputerName 'myserver' -ScriptBlock { Stop-Service W3SVC } 
```

并替换`Stop-Service`为`Start-Service`重新启动它。该`W3SVC`服务是 IIS。

# ruby-on-rails - 如何在带有参数的 Rails 助手中迭代产生的块

> ID：10727808
> 
> 赞同：0
> 
> 时间：2012-05-23T21:04:40.973
> 
> 标签：ruby-on-rails, block, yield, helpers

我想将某种逻辑抽象为视图助手。在我看来，这个想法是能够做这样的事情：

```
<ul class="nav">
  <% pages_for_section('over') do |page| %>
    <li><%= page.menu_text %></li>
  <% end %>
</ul> 
```

我目前的方法是让这个助手像这样：

```
def pages_for_section(section_slug, &block)
  out = []

  pages_in_section = @pages.select { |p| p.section.slug == section_slug }
  pages_in_section.each do |page|
    out << yield(page)
  end

  return out
end 
```

具体来说，这`out << yield(page)`部分困扰着我。它有效，但它似乎不是一个非常正确的 DRY 方式。因为，如果我想在我的视图中添加一个变量，我也需要将它添加到块助手和 yield 调用中。

底线：我想通过迭代我的页面将一个变量注入到产生的块中。这是最佳实践还是有更好、更易读的替代方案？

理想情况下。我想做类似的事情：

```
<ul class="nav">
  <% each_page_in_section('over') do %>
    <li><%= page.menu_text %> <%= another_variable %></li>
  <% end %>
</ul> 
```

助手在概念上看起来像这样：

```
def pages_for_section(section_slug, &block)
  pages_in_section = @pages.select { |p| p.section.slug == section_slug }
  pages_in_section.each do |page|
    another_variable = "I'm cool"
    # the `page` and the `another_variable` variable will automatically 
    # be available/copied to the block
    yield
  end
end 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:09:15.907

如果您注入，那么您将在注入块内产生收益。

混乱来自于试图同时屈服于一个块，块中的代码在视图中进行渲染，并返回一个值。我一次只会做一个或另一个。如果您是通过块内的代码进行渲染，则不必担心返回值。

# python - 未找到 Facebook GAE 示例的存储库

> ID：10727814
> 
> 赞同：0
> 
> 时间：2012-05-23T21:05:15.783
> 
> 标签：python, facebook, google-app-engine

请有人为 Google App Engine“与朋友一起运行”的 Facebook 应用程序提供有效链接，因为Facebook 文档中给出[的](https://github.com/facebook/runwithfriends/zipball/master)链接已损坏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:31:30.413

您可以在[https://github.com/fbsamples/runwithfriends/zipball/master](https://github.com/fbsamples/runwithfriends/zipball/master)找到它。

所有样本都可以在[https://github.com/fbsamples/找到](https://github.com/fbsamples/)

# ios - 为什么 FDT 在打包适用于 iOS (.IPA) 的 Adob e AIR 应用程序时显示 Java 堆错误

> ID：10727824
> 
> 赞同：0
> 
> 时间：2012-05-23T21:06:06.177
> 
> 标签：ios, eclipse, air, adobe, fdt

我正在使用 Adob​​e AIR 创建一些 Flash 游戏。我尝试将它编译成 .ipa 文件（在 iPad 设备上运行）。

该项目不大，但也不小（它使用 6 个 swc 库和大量未预编译的代码）。我尝试使用以下两种方法将我的游戏与 Flash FDT 5.5 打包：

*   **快速** - 工作正常，但性能很糟糕；
*   **标准**- 我的编译以以下错误结束：

> 包装失败！打包错误消息：在 adobe.abc.Algorithms$SetMap.get(Algorithms. java:225) 在 adobe.abc.Algorithms.addUses(Algorithms.java:164) 在 adobe.abc.Algorithms.findUses(Algorithms.java:186) 在 adobe.abc.GlobalOptimizer.cp(GlobalOptimizer.java:9381) 在adobe.abc.GlobalOptimizer.dce(GlobalOptimizer.java:9627) 在 adobe.abc.GlobalOptimizer.sccp(GlobalOptimizer.java:4638) 在 adobe.abc.GlobalOptimizer.optimize(GlobalOptimizer.java:3514) 在 adobe.abc.GlobalOptimizer .optimize(GlobalOptimizer.java:2215) 在 adobe.abc.LLVMEmitter.optimizeABCs(LLVMEmitter.java:527) 在 adobe.abc.LLVMEmitter.generateBitcode(LLVMEmitter.java:

我知道这是 Eclipse 开发的常见问题。我试图以标准方式解决这个问题 - >增加java堆大小。如您所见，我设置了 3072M 应该足够了。

当我尝试编译较小的项目时，它工作正常。我不知道现在该怎么办:(。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:08:44.813

经过深入调查，我找到了解决方案。这不是由于任何环境配置，但正如@Alan 所说，Adobe 的打包程序遇到了问题。正如我想的那样，它在“优化”阶段遇到了问题。

这是一个非常有用的论坛主题：[http ://forums.adobe.com/message/4445973#4445973](http://forums.adobe.com/message/4445973#4445973)

我的项目使用的是 NAPE 物理引擎。正如我在那里发现的那样：http: [//deltaluca.me.uk/forum/index.php/m/2148/0ce4c49cc2c79979154c56737d2978a4/](http://deltaluca.me.uk/forum/index.php/m/2148/0ce4c49cc2c79979154c56737d2978a4/)人们遇到编译时间问题。在我的情况下，编译时间是无限的；），以java的内存不足异常结束。解决方案是使用最新的 NAPE 构建，作者对其进行了一些优化。这种“小型优化”使我的项目发挥了作用。

To sum up: if you have similiar problem, just check your code. Try to find some huge functions/methods, which Adobe's packager finds hard to optimalize.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T14:15:52.480

`-Xmx3072M`不是有效的 Eclipse 参数。将您的“eclipse.ini”设置和其他 Java 设置恢复为默认值，它应该可以工作。您可能将其设置得太高，以至于 JVM 的其他部分内存不足。

从堆栈跟踪可以看出，这不是 Eclipse 或 FDT 问题。Adobe 的打包程序遇到了问题。如果默认设置仍然不起作用，请参阅一般情况下为 Java 提供更多内存。如果这不起作用，请慢慢增加 Eclipse 的内存以查看是否有效。

# android - 在一个活动中的两个按钮之间传递数据？

> ID：10727826
> 
> 赞同：0
> 
> 时间：2012-05-23T21:06:07.313
> 
> 标签：android, button, onclick

我的问题是按钮无法传递 int 数据，这是
我想在 TotalKalori 和 bmr 之间进行比较的代码，但似乎 TotalKalori 在上一节中无法解决，它说 TotalKalori 无法解析为变量，我该如何解决这？谢谢

```
package lynn.calculate.KaunterKalori;

 import lynn.calculate.KaunterKalori.R;
 import android.app.Activity;
//import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.TextView;
import android.widget.EditText;

public class CalculateAll extends Activity implements OnClickListener {

//private int TotalKalori;
protected int totalKalori1;
protected int totalKalori2;
protected int totalKalori3;

EditText EstimateCalorie;
TextView TotalKaloriSehari;
TextView totalsarapan;
TextView totallunch;
TextView totaldinner;
TextView calorieneeds;
TextView resultDiff;

public CalculateAll() {

}

@Override
public void onCreate(Bundle savedInstancesState) {
    super.onCreate(savedInstancesState);
    setContentView(R.layout.calculate_all);

    View kiraButton = findViewById(R.id.buttonKiraAll);
    kiraButton.setOnClickListener(this);

    View bezaButton = findViewById(R.id.caloriediff);
    bezaButton.setOnClickListener(this);
    //

    TotalKaloriSehari = (TextView) findViewById(R.id.JumlahKalori);
    totalsarapan = (TextView) findViewById(R.id.sarapantext);
    totallunch = (TextView) findViewById(R.id.lunchtext);
    totaldinner = (TextView) findViewById(R.id.dinnertext);
    EstimateCalorie = (EditText) findViewById(R.id.BMR);
    calorieneeds = (TextView) findViewById(R.id.BMR);
    resultDiff = (TextView) findViewById(R.id.result);

    Bundle extras = getIntent().getExtras();
    if (extras != null) {
        totalKalori1 = extras.getInt("totalBreakfast");
        totalKalori2 = extras.getInt("totalLunch");
        totalKalori3 = extras.getInt("totalDinner");

    }

    totalsarapan.setText(totalKalori1 + "");
    totallunch.setText(totalKalori2 + "");
    totaldinner.setText(totalKalori3 + "");

}

public void onClick(View v) {
    if (v.getId() == R.id.buttonKiraAll) {

     int TotalKalori = calculateTotalKalori(totalKalori1, totalKalori2,
                totalKalori3);
        TotalKaloriSehari.setText(TotalKalori + "");

    }

    if (v.getId()== R.id.caloriediff) {

         int TotalKalori = calculateTotalKalori(totalKalori1, totalKalori2,
                    totalKalori3);

        int nilaikalori = Integer.parseInt(EstimateCalorie.getText()
                .toString());
        //TotalKalori = Integer.parseInt(TotalKaloriSehari.getText().toString());

        int bmr = calculatebmr(nilaikalori);

    //  String deskripsiKalori = describekalori(bmr);

    //  resultDiff.setText("kalori makanan" + TotalKalori + " calori diperlukan " + bmr + "=" + deskripsiKalori);
        resultDiff.setText("kalori makanan = " + TotalKalori + " calori diperlukan = " + bmr);
        }
    } 
        //Intent n = new Intent(this, MainActivity.class);
        //startActivity(n);

        //

private String describekalori(int bmr) {

 if (bmr < TotalKalori ) {
        return "bykkan makan";
    } else if (bmr == TotalKalori) {

        return "kekalkan jumlah kalori ini";

    } else if (bmr > TotalKalori) {

        return "kurangkan pengambilan kalori";

    } else
        return "oiii";

}       

public int calculateTotalKalori(int totalKalori1, int totalKalori2,
        int totalKalori3) {
    return (int) (totalKalori1 + totalKalori2 + totalKalori3);

}

public int calculatebmr(int nilaikalori) {
    return (int) (nilaikalori);
}

}

// the comparison that I can't solve is the 
// the TotalKalori cannot resolved into variable? how do I solve this? thank you
private String describekalori(int bmr) {

 if (bmr < TotalKalori ) {
        return "bykkan makan";
    } else if (bmr == TotalKalori) {

        return "kekalkan jumlah kalori ini";

    } else if (bmr > TotalKalori) {

        return "kurangkan pengambilan kalori";

    } else
        return "oiii";

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:52:23.953

我认为您想在按下**卡路里差异**按钮时将**bmr**传递给**MainActivity 。**在按钮按下时使用以下代码传递数据：

 **```
 Intent n = new Intent(this, MainActivity.class);  
    Bundle bundle = new Bundle();
    bundle.putString(“myValue“,""+bmr);
    n.putExtras(bundle);
    startActivity(n); 
```

现在在您的**MainActivity**中从包中检索您的数据：

```
 Bundle bundle = getIntent().getExtras();
    String retbmr = bundle.getString(“myValue”); 
```

* * *

如果需要，然后解析为整数：

```
int nbmr = Integer.parseInt(retbmr); 
```

或直接作为：

```
int nbmr = Integer.parseInt(bundle.getString(“myValue”)); 
```**

# facebook - FB.Event.subscribe('edge.create') 没有触发

> ID：10727828
> 
> 赞同：1
> 
> 时间：2012-05-23T21:06:29.710
> 
> 标签：facebook, facebook-like, facebook-javascript-sdk

当单击赞框中的赞按钮时，我试图使某些功能发生，但是该功能没有触发（以及控制台中出现两个跨域错误，但我认为这是不相关的。）

基本上我正在使用的代码：

```
<div id="fb-root">
    <fb:like-box href="//www.facebook.com/MYPAGE" width="292" height="290"
     show_faces="true" stream="false" header="true"></fb:like-box>
</div>

<script>
    window.fbAsyncInit = function() {
        FB.init({
            appId: 'MYID',
            status: true,
            cookie: true,
            xfbml: true
        });

        FB.Event.subscribe('edge.create', function (response) {
                alert('You liked the URL: ' + response);
        });
    };

    (function(d) {
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
</script> 
```

当然，MYPAGE 和 MYID 在实际代码中是有效的。95% 的代码只是复制/粘贴，所以我不知道为什么它不起作用。如果这很明显，那么这应该很容易。

任何帮助将不胜感激。

编辑-哦，当然还有 HTML 标签：

```
<html xmlns="http://www.w3.org/1999/xhtml"
 xmlns:fb="http://www.facebook.com/2008/fbml"> 
```

# opengl-es - 如何使用具有位置、texcoord 和 normal 的 VAO

> ID：10727834
> 
> 赞同：0
> 
> 时间：2012-05-23T21:06:43.150
> 
> 标签：opengl-es, opengl-es-2.0

我有一个 Wavefront OBJ Parser 正在运行，但是在花了无数小时试图弄清楚我如何在 OpenGL 中加载数据之后，我最终不得不放弃。

这是代码的构建方式：

```
struct ObjMeshVertex{
    Vector3f pos;
    Vector2f texcoord;
    Vector3f normal;
};

struct ObjMeshFace{
    ObjMeshVertex vertices[3];
};

struct ObjMesh{
    std::vector<ObjMeshFace> faces;
};

ObjMesh myMesh;

for(size_t i = 0; i < faces.size(); ++i){
    ObjMeshFace face;
    for(size_t j = 0; j < 3; ++j){
        face.vertices[j].pos        = positions[faces[i].pos_index[j] - 1];
        face.vertices[j].texcoord   = texcoords[faces[i].tex_index[j] - 1];
        face.vertices[j].normal     = normals[faces[i].nor_index[j] - 1];
    }
    myMesh.faces.push_back(face);
} 
```

通常当我创建一个简单的多维数据集时，数组看起来像这样`{posX, posY, posZ, normX, normY, normZ}`：

并且通过使用偏移量`glVertexAttribPointer`来加载数据非常简单。

但我不知道这是怎么做到的？

编辑设置：

```
 glGenVertexArraysOES(1, &_boxVAO);
    glBindVertexArrayOES(_boxVAO);

    int sizeOfFaces = myMesh.faces.size() * sizeof(ObjMeshFace);
    glGenBuffers(1, &_boxBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, _boxBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeOfFaces, &(myMesh.faces[0]), GL_STATIC_DRAW);

    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(ObjMeshVertex), 0);
    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, sizeof(ObjMeshVertex), (void*)offsetof(ObjMeshVertex, texcoord));        
    glVertexAttribPointer(2, 3, GL_FLOAT, GL_FALSE ,sizeof(ObjMeshVertex), (void*)offsetof(ObjMeshVertex, normal));

    glEnableVertexAttribArray(0);
    glEnableVertexAttribArray(1);
    glEnableVertexAttribArray(2);

    glBindVertexArrayOES(0); 
```

画：

```
glBindVertexArrayOES(_boxVAO);
glDrawArrays(GL_TRIANGLES, 0, indicesize); 
```

其中 indexize = myMesh.faces.size()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T22:19:32.367

如果您只是询问如何将数据发送到 glBufferData，那么您只需获取指向 myMesh 中第一个面的指针，然后在其上调用 glBufferData（假设所有内容都紧凑）。

```
int sizeOfFaces = myMesh.faces.size() * sizeof(ObjMeshFace);
glBufferData(GL_ARRAY_BUFFER, sizeOfFaces, &(myMesh.faces[0]), usage); 
```

然后你可以设置指向这个交错结构的指针：

```
glVertexPointer(3, GL_FLOAT, sizeof(ObjMeshVertex), 0);
glTexCoordPointer(2, GL_FLOAT, sizeof(ObjMeshVertex), (void*)(sizeof(Vector3f)));
glNormalPointer(3, GL_FLOAT, sizeof(ObjMeshVertex), (void*)(sizeof(Vector3f) + sizeof(Vector2f))); 
```

您可能需要检查的一件事是您的结构没有被填充（我不太确定如何启用/禁用它）。

只需仔细检查并断言：

```
sizeof(ObjMeshVertex) == 2 * sizeOf(Vector3f) + sizeOf(Vector2f);
sizeof(ObjMeshFace) == 3 * sizeOf(ObjMeshVertex); 
```

如果这不是真的，您可能需要对结构填充进行一些调整。

# python - 模型中的 Django 表单

> ID：10727840
> 
> 赞同：0
> 
> 时间：2012-05-23T21:07:10.847
> 
> 标签：python, django, forms, model, creation

我正在尝试集成一个名为[Django-Classifieds](https://github.com/saebyn/django-classifieds)的应用程序，但无法弄清楚如何操作某些元素。

该应用程序允许人们通过管理部分创建一个类别和子字段，这些部分将被显示并允许用户在所述类别中创建一个帖子。尽管 Django 管理员允许创建字段：

![DJango 管理员](../Images/1c1a3c43b1abc966a8c69c9ba3f4af0d.png)

并将它们写入数据库：

![在此处输入图像描述](../Images/5f8dc45bd6f41596018a2cdf859c094c.png)

我不知道如何调用这些字段并将它们显示给用户。目前只显示标题字段。我知道使用 ModelForm 将允许我访问这些元素，但我不确定如何将它与 BaseForm 合并（在应用程序中使用，如下所示）：

```
class AdForm(BaseForm):
  def __init__(self, instance, data=None, files=None, auto_id='id_%s', prefix=None,
                         initial=None, error_class=ErrorList, label_suffix=':',
                         empty_permitted=False):

    self.instance = instance
    object_data = ad_to_dict(self.instance)
    self.declared_fields = SortedDict()
    self.base_fields = fields_for_ad(self.instance)

    # if initial was provided, it should override the values from instance
    if initial is not None:
        object_data.update(initial)

    BaseForm.__init__(self, data, files, auto_id, prefix, object_data,
                      error_class, label_suffix, empty_permitted)

  def save(self, commit=True):
    if not commit:
        raise NotImplementedError("AdForm.save must commit it's changes.")

    if self.errors:
        raise ValueError("The ad could not be updated because the data didn't validate.")

    cleaned_data = self.cleaned_data

    # save fieldvalues for self.instance
    fields = field_list(self.instance)

    for field in fields:
        if field.enable_wysiwyg:
            value = unicode(stripHTML(cleaned_data[field.name]))
        else:
            value = unicode(cleaned_data[field.name])

        # strip words in settings.FORBIDDEN_WORDS
        for word in settings.FORBIDDEN_WORDS:
            value = value.replace(word, '')

        # title is stored directly in the ad, unlike all other editable fields
        if field.name == 'title':
            self.instance.title = value
            self.instance.save()
        else:
            # check to see if field.fieldvalue_set has a value with ad=self.instance
            try:
                # if it does, update
                fv = field.fieldvalue_set.get(ad=self.instance)
            except FieldValue.DoesNotExist:
                # otherwise, create a new one
                fv = field.fieldvalue_set.create(ad=self.instance)

            # XXX some ugly price fixing
            if field.name.endswith('price'):
                m = re.match('^\$?(\d{1,3},?(\d{3},?)*\d{3}(\.\d{0,2})?|\d{1,3}(\.\d{0,2})?|\.\d{1,2}?)$', value)
                value = m.group(1)
                value.replace(',', '')
                value = '%.2f' % float(value)

            fv.value = value
            fv.save()

    return self.instance 
```

如何在`AdForm`上面显示所有创建的字段？

任何例子表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:43:26.777

不需要合并 ModelForm，因为 AdForm 类的目的是允许访问这些字段。为了显示添加到数据库中类别的自定义字段，只需将字段添加到适当类别的模板（假设您使用的是应用程序中提供的视图）。分类应用程序中的“基本”类别模板中有这样的示例。

# php - 如何在javascript中读取json？

> ID：10727841
> 
> 赞同：0
> 
> 时间：2012-05-23T21:07:11.773
> 
> 标签：php, javascript, json

你能告诉我如何在 javascript 中读取 json 吗？

我有一个 json 字符串，如下所示

```
 {"person":{"First name":"Dharmalingm","Last name":"Arumugam","Address":{"door number":"123","street":"sample street","city":"sample_city"},"phone number":{"mobile":"0123","landline":"01234","skype":"01235"}}} 
```

我想读**Skype**电话号码

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:09:24.050

如果您从 JSON 字符串开始，请以`1`. 如果你已经有一个 JS 对象，那么跳到`2`.

1.  解析字符串[`JSON.parse()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/parse)用于将 JSON 字符串转换为 JS 对象。要支持[没有原生 JSON 的浏览器](http://caniuse.com/#search=json)，您可以使用[Crockford 的 JSON2 库](https://github.com/douglascrockford/JSON-js)来实现它。

    ```
    var jsondata = JSON.parse('{"person":{"First name":"Dharmalingm","Last name":"Arumugam","Address":{"door number":"123","street":"sample street","city":"sample_city"},"phone number":{"mobile":"0123","landline":"01234","skype":"01235"}}}'); 
    ```

2.  像平常一样从 JS 对象中检索值

    ```
    var skype = jsondata.person['phone number'].skype; 
    ```

这是完整的代码和[示例](http://jsfiddle.net/3cCej/)：

```
var jsondata = JSON.parse('{"person":{"First name":"Dharmalingm","Last name":"Arumugam","Address":{"door number":"123","street":"sample street","city":"sample_city"},"phone number":{"mobile":"0123","landline":"01234","skype":"01235"}}}');

//normally, the dot-notation is used
//but since "phone number" is not a valid key when using dot-notation
//the bracket notation is used
var skype = jsondata.person['phone number'].skype; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T21:10:17.360

这应该让你上路。

```
var o = {"person":{"First name":"Dharmalingm","Last name":"Arumugam","Address":{"door number":"123","street":"sample street","city":"sample_city"},"phone number":{"mobile":"0123","landline":"01234","skype":"01235"}}}

o["person"]["phone number"]["skype"];

/* or */

o.person["phone number"]["skype"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:13:03.933

首先需要将其解析为原生 javascript 对象，在现代浏览器中，这可以通过`JSON.parse(json string here);`. 现在要专门获取Skype号码，您拥有刚刚解析出的对象。假设您通过 分配它`var skypeData = JSON.parse(json string here);`，可以通过 访问人员的Skype号码`skypeData.person['phone number'].skype`。我们必须使用`['phone number']`而不是`person.phone number.skype`因为空间。

# .net - 拦截 FIleSytemCall 以进行删除

> ID：10727844
> 
> 赞同：1
> 
> 时间：2012-05-23T21:07:23.843
> 
> 标签：.net, windows, visual-c++, operating-system

有没有办法在 Windows 执行删除之前检测文件的删除？我找到了 FileSystemWatcher 类，但仅在执行删除操作后才引发事件，但我想在用户/进程选择删除它时捕获删除操作。您可以监视文件系统表，但要寻找更好的方法。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:17:41.470

您需要一个文件系统过滤器驱动程序。但是我强烈建议，如果您不知道答案，您可能不应该这样做。

[http://msdn.microsoft.com/en-us/library/windows/hardware/gg462968.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/gg462968.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:27:59.167

我认为最简单的方法是使用挂钩来获得通知（并最终停止）该过程。它不能在 .NET 中完成，因此您必须`DllImport`使用大量结构和少量函数来 P/Invoke。

`NtSetFileInformation`让我们从（未记录的）函数开始你的工作。当需要删除文件（使用`FileDispositionInformation`结构）时，它是由其他任何东西调用的函数。

现在的问题是如何挂钩该函数（祝你好运，这并不容易）。一个不错的选择是使用[Microsoft Detours](http://www.microsoft.com/about/legal/en/us/intellectualproperty/iplicensing/programs/detours.aspx)。看看[这篇文章](http://www.codeproject.com/Articles/30140/API-Hooking-with-MS-Detours)的例子。它的问题是它不是免费的。另一种解决方案（价格合理并带有 .NET 界面）是[Deviare](http://www.nektra.com/products/deviare-api-hook-windows/download)，但我什至从未尝试过他们的免费版本，所以我不知道它有多好。如果其他人知道一个好的拦截工具......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T08:12:32.320

或者可以尝试**ICopyHook**接口。

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb776049%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776049%28v=vs.85%29.aspx)

在**CopyCallback**方法中，使用wFunc 参数中的**FO_DELETE**来指定删除操作。

*缺点：* 仅防止在 Windows Shell 中删除。

# sql-server - SSAS：按问题排列的周数

> ID：10727845
> 
> 赞同：0
> 
> 时间：2012-05-23T21:07:32.167
> 
> 标签：sql-server, ssas, mdx, ssas-2008

我正在用我的立方体解决这个奇怪的问题

```
 Week No
      1  10  11 2   3  4  5  6  7  8  9  
India
Nepal 
```

我想按顺序出现（升序）

My Week no 是字符串数据类型。我尝试转换为int。问题仍然没有解决。

任何输入都会很棒。

谢谢 ！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:35:55.623

维度中的每个属性都具有以下属性，这些属性定义了属性的排序方式：

*   订购方式
*   按属性排序

按属性排序是包含以下选项的下拉列表：

*   钥匙
*   名称（默认选项）
*   属性键
*   属性名称

选项`Key`意味着属性将根据键值进行排序。**不要忘记排序取决于密钥类型**：

例如，如果 key 是整数，那么排序将是 1、2、3...、11、12。

如果 Key 是字符串，那么排序将是 1, 11, 12, 2, 3 ...

选项`Name`意味着将根据名称值对属性进行排序。

选项`Attribute Key`意味着排序将基于属性“按属性排序”键值中指定的属性。

选项`Attribute Name`意味着排序将基于属性“按属性排序”名称值中指定的属性。

属性`Order By Attribute`允许您在“排序依据”属性中为“属性键”和“属性名称”选项选择属性。

希望它有所帮助。

获取更多信息：[如何在 Analysis Services 中在设计期间订购维度属性](http://www.ssas-info.com/analysis-services-faq/28-design/89-how-do-you-order-dimension-attribute)

# c - 在针对顺序运行进行优化的程序上使用 openMP 后没有性能提升

> ID：10727849
> 
> 赞同：1
> 
> 时间：2012-05-23T21:07:55.177
> 
> 标签：c, performance, parallel-processing, openmp

我已经尽可能多地优化了我的顺序运行功能。当我使用 openMP 时，我发现性能没有任何提升。我在 1 核机器和 8 核机器上试了我的程序，性能是一样的。
将年份设置为 20，我有
1 个核心：1 秒。
8 核：1 秒。

将年份设置为 25 我有
1 个核心：40 秒。
8 核：40 秒。

1核机：我笔记本的intel core 2 duo 1.8 GHz，ubuntu linux
8核机：3.25 GHz，ubuntu linux

我的程序枚举了二叉树的所有可能路径，并在每条路径上做一些工作。所以我的循环大小呈指数增长，我希望 openMP 线程的占用空间为零。在我的循环中，我只减少一个变量。所有其他变量都是只读的。我只使用我写的函数，我认为它们是线程安全的。

我还在我的程序上运行 Valgrind cachegrind。我不完全理解输出，但似乎没有缓存未命中或错误共享。

我编译

```
gcc -O3 -g3 -Wall -c -fmessage-length=0 -lm -fopenmp -ffast-math 
```

我的完整程序如下。很抱歉发布了很多代码。我对 openMP 和 C 都不熟悉，而且我无法在不丢失主要任务的情况下恢复我的代码。

使用 openMP 时如何提高性能？
它们是使程序运行得更快的编译器标志或 C 技巧吗？

测试.c

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <omp.h>
#include "test.h"

int main(){

    printf("starting\n");
    int year=20;
    int tradingdate0=1;

    globalinit(year,tradingdate0);

    int i;
    float v=0;
    long n=pow(tradingdate0+1,year);
    #pragma omp parallel for reduction(+:v)
    for(i=0;i<n;i++)
        v+=pathvalue(i);

    globaldel();
    printf("finished\n");
    return 0;
}

//***function on which openMP is applied
float pathvalue(long pathindex) {
    float value = -ctx.firstpremium;
    float personalaccount = ctx.personalaccountat0;
    float account = ctx.firstpremium;
    int i;
    for (i = 0; i < ctx.year-1; i++) {
        value *= ctx.accumulationfactor;
        double index = getindex(i,pathindex);
        account = account * index;
        double death = fmaxf(account,ctx.guarantee[i]);
        value += qx(i) * death;
        if (haswithdraw(i)){
            double withdraw = personalaccount*ctx.allowed;
            value += px(i) * withdraw;
            personalaccount = fmaxf(personalaccount-withdraw,0);
            account = fmaxf(account-withdraw,0);
        }
    }

    //last year
    double index = getindex(ctx.year-1,pathindex);
    account = account * index;
    value+=fmaxf(account,ctx.guarantee[ctx.year-1]);

    return value * ctx.discountfactor;
}

int haswithdraw(int period){
    return 1;
}

float getindex(int period, long pathindex){
    int ndx = (pathindex/ctx.chunksize[period])%ctx.tradingdate;
    return ctx.stock[ndx];
}

float qx(int period){
    return 0;
}

float px(int period){
    return 1;
}

//****global
struct context ctx;

void globalinit(int year, int tradingdate0){
    ctx.year = year;
    ctx.tradingdate0 = tradingdate0;
    ctx.firstpremium = 1;
    ctx.riskfreerate = 0.06;
    ctx.volatility=0.25;
    ctx.personalaccountat0 = 1;
    ctx.allowed = 0.07;
    ctx.guaranteerate = 0.03;
    ctx.alpha=1;
    ctx.beta = 1;
    ctx.tradingdate=tradingdate0+1;
    ctx.discountfactor = exp(-ctx.riskfreerate * ctx.year);
    ctx.accumulationfactor = exp(ctx.riskfreerate);
    ctx.guaranteefactor = 1+ctx.guaranteerate;
    ctx.upmove=exp(ctx.volatility/sqrt(ctx.tradingdate0));
    ctx.downmove=1/ctx.upmove;

    ctx.stock=(float*)malloc(sizeof(float)*ctx.tradingdate);
    int i;
    for(i=0;i<ctx.tradingdate;i++)
        ctx.stock[i]=pow(ctx.upmove,ctx.tradingdate0-i)*pow(ctx.downmove,i);

    ctx.chunksize=(long*)malloc(sizeof(long)*ctx.year);
    for(i=0;i<year;i++)
        ctx.chunksize[i]=pow(ctx.tradingdate,ctx.year-i-1);

    ctx.guarantee=(float*)malloc(sizeof(float)*ctx.year);
    for(i=0;i<ctx.year;i++)
        ctx.guarantee[i]=ctx.beta*pow(ctx.guaranteefactor,i+1);
}

void globaldel(){
    free(ctx.stock);
    free(ctx.chunksize);
    free(ctx.guarantee);
} 
```

测试.h

```
float pathvalue(long pathindex);
int haswithdraw(int period);
float getindex(int period, long pathindex);
float qx(int period);
float px(int period);
//***global
struct context{
    int year;
    int tradingdate0;
    float firstpremium;
    float riskfreerate;
    float volatility;
    float personalaccountat0;
    float allowed;
    float guaranteerate;
    float alpha;
    float beta;
    int tradingdate;
    float discountfactor;
    float accumulationfactor;
    float guaranteefactor;
    float upmove;
    float downmove;
    float* stock;
    long* chunksize;
    float* guarantee;
};
struct context ctx;
void globalinit();
void globaldel(); 
```

**编辑**我将所有全局变量简化为常量。20 年来，程序运行速度快了两倍（太棒了！）。例如，我尝试设置线程数`OMP_NUM_THREADS=4 ./test`。但这并没有给我带来任何性能提升。
我的 gcc 会有问题吗？

测试.c

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <math.h>
#include <omp.h>
#include "test.h"

int main(){

    starttimer();
    printf("starting\n");
    int i;
    float v=0;

    #pragma omp parallel for reduction(+:v)
    for(i=0;i<numberofpath;i++)
        v+=pathvalue(i);

    printf("v:%f\nfinished\n",v);
    endtimer();
    return 0;
}

//function on which openMP is applied
float pathvalue(long pathindex) {
    float value = -firstpremium;
    float personalaccount = personalaccountat0;
    float account = firstpremium;
    int i;
    for (i = 0; i < year-1; i++) {
        value *= accumulationfactor;
        double index = getindex(i,pathindex);
        account = account * index;
        double death = fmaxf(account,guarantee[i]);
        value += death;
        double withdraw = personalaccount*allowed;
        value += withdraw;
        personalaccount = fmaxf(personalaccount-withdraw,0);
        account = fmaxf(account-withdraw,0);
    }

    //last year
    double index = getindex(year-1,pathindex);
    account = account * index;
    value+=fmaxf(account,guarantee[year-1]);

    return value * discountfactor;
}

float getindex(int period, long pathindex){
    int ndx = (pathindex/chunksize[period])%tradingdate;
    return stock[ndx];
}

//timing
clock_t begin;

void starttimer(){
    begin = clock();
}

void endtimer(){
    clock_t end = clock();
    double elapsed = (double)(end - begin) / CLOCKS_PER_SEC;
    printf("\nelapsed: %f\n",elapsed);
} 
```

测试.h

```
float pathvalue(long pathindex);
int haswithdraw(int period);
float getindex(int period, long pathindex);
float qx(int period);
float px(int period);
//timing
void starttimer();
void endtimer();
//***constant
const int year= 20 ;
const int tradingdate0= 1 ;
const float firstpremium= 1 ;
const float riskfreerate= 0.06 ;
const float volatility= 0.25 ;
const float personalaccountat0= 1 ;
const float allowed= 0.07 ;
const float guaranteerate= 0.03 ;
const float alpha= 1 ;
const float beta= 1 ;
const int tradingdate= 2 ;
const int numberofpath= 1048576 ;
const float discountfactor= 0.301194211912 ;
const float accumulationfactor= 1.06183654655 ;
const float guaranteefactor= 1.03 ;
const float upmove= 1.28402541669 ;
const float downmove= 0.778800783071 ;
const float stock[2]={1.2840254166877414, 0.7788007830714049};
const long chunksize[20]={524288, 262144, 131072, 65536, 32768, 16384, 8192, 4096, 2048, 1024, 512, 256, 128, 64, 32, 16, 8, 4, 2, 1};
const float guarantee[20]={1.03, 1.0609, 1.092727, 1.1255088100000001, 1.1592740743, 1.1940522965290001, 1.2298738654248702, 1.2667700813876164, 1.304773183829245, 1.3439163793441222, 1.384233870724446, 1.4257608868461793, 1.4685337134515648, 1.512589724855112, 1.557967416600765, 1.6047064390987882, 1.6528476322717518, 1.7024330612399046, 1.7535060530771016, 1.8061112346694148}; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-24T11:45:20.693

即使您的程序受益于使用 OpenMP，您也不会看到它，因为您测量了错误的时间。

`clock()`返回在**所有线程**中花费的**总 CPU 时间**。如果您使用四个线程运行并且每个线程运行 1/4 的时间，则仍然会返回相同的值，因为 4*(1/4) = 1。您应该改为测量**挂钟时间**。**`clock()`**

 ****将调用替换`clock()`为`omp_get_wtime()`或`gettimeofday()`。它们都提供高精度的挂钟计时。

*PS为什么周围有这么多人使用`clock()`计时？*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:14:51.537

我没有看到您指定 OpenMP 将使用的核心数量的任何部分。默认情况下，它应该使用它看到的 CPU 数量，但出于我的目的，我总是强制它使用我指定的数量。

在您的 parallel for 构造之前添加此行：

```
#pragma omp parallel num_threads(num_threads)
{
   // Your parallel for follows here
} 
```

...其中`num_threads`是 1 和机器上的内核数之间的整数。

**编辑：** 这是用于构建代码的生成文件。`Makefile`将其放在同一目录中命名的文本文件中。

```
test: test.c test.h
    cc -o $@ $< -O3 -g3 -fmessage-length=0 -lm -fopenmp -ffast-math 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T21:18:29.203

似乎它应该工作。可能您需要指定要使用的线程数。您可以通过设置 OMP_NUM_THREADS 变量来做到这一点。例如，对于使用 4 个线程：

```
OMP_NUM_THREADS=4 ./test 
```

**编辑：**我刚刚编译了代码，并且在更改线程数时观察到显着的加速。****

# google-maps - 更改嵌入的 Google 地图信息气泡中的位置名称

> ID：10727850
> 
> 赞同：2
> 
> 时间：2012-05-23T21:08:13.037
> 
> 标签：google-maps, google-maps-markers

我在我的网站中嵌入了谷歌地图，但我希望能够将信息气泡中的名称更改为除“地址”之外的名称，例如，我想更改信息气泡中的“地址”点击链接，使其显示“聪明的人在这里工作”

```
<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=One+Exchange+Plaza,+26th+Floor+New+York,+NY+10006&amp;aq=&amp;sll=37.0625,-95.677068&amp;sspn=39.371738,86.572266&amp;ie=UTF8&amp;hq=&amp;hnear=1+Exchange+Plaza,+New+York,+10006&amp;t=m&amp;z=14&amp;ll=40.706793,-74.012592&amp;output=embed"></iframe><br /><small><a href="http://maps.google.com/maps?f=q&amp;source=embed&amp;hl=en&amp;geocode=&amp;q=One+Exchange+Plaza,+26th+Floor+New+York,+NY+10006&amp;aq=&amp;sll=37.0625,-95.677068&amp;sspn=39.371738,86.572266&amp;ie=UTF8&amp;hq=&amp;hnear=1+Exchange+Plaza,+New+York,+10006&amp;t=m&amp;z=14&amp;ll=40.706793,-74.012592" style="color:#0000FF;text-align:left">View Larger Map</a></small> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:59:48.070

据我所知[，您必须构建自己的 JavaScript 页面](http://jsfiddle.net/6qYJg/)才能更改该气泡。它只使用基本的 API 组件，但我认为单个标记很麻烦。优点是它是高度可定制的。我只是试图复制原件，省略了方向和搜索链接。

```
<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body { margin: 0; padding: 0; height: 100% }
      #infoContents { color: blue; font-family: Arial, sans-serif; font-size: 12px }
    </style>
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">
      var map;
      var spot = new google.maps.LatLng(40.706793,-74.012592);
      var mapCenter = new google.maps.LatLng(40.712583,-74.00933592);
      var mapOptions = { center: mapCenter, zoom: 14,
        mapTypeId: google.maps.MapTypeId.ROADMAP };

      function initialize() {
        map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
        var iconShadow = new google.maps.MarkerImage(
          "http://www.google.com/mapfiles/ms/micons/msmarker.shadow.png", 
          new google.maps.Size(59,32),
          new google.maps.Point(0,0),
          new google.maps.Point(15,32));

        var marker = new google.maps.Marker({
          map: map,
          position: spot,
          icon: "http://www.google.com/mapfiles/markerA.png",
          shadow: iconShadow
        });

        var infowindow = new google.maps.InfoWindow({
          content: '<div id="infoContents"><b style="font-size: 16px">I am so Smart</b><br><br>1 Exchange Plaza<br>New York, NY 10006</div>'
        });

        infowindow.open(map, marker);
      }

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div id="map_canvas" style="width: 425px; height: 350px;"></div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-23T16:59:31.780

如果您在 2016 年阅读此内容，您可以使用 Google MyMaps 创建地图并节省时间；）

# android - 用android动态显示数据

> ID：10727854
> 
> 赞同：0
> 
> 时间：2012-05-23T21:08:25.853
> 
> 标签：android, android-layout, dynamic, textview

我编写了一个布局文件来显示我从查询数据库中获得的数据。但是，您将如何在文本视图中播放数据？这样做的目的是显示动态内容，而不是资源文件中预定义的静态内容。

我真的不想写

```
 TextView x = new TextView();
 x.setText("...");
 x.setGravity("");
 x... 
```

因为这确实是重复的，我必须重做我想要显示的所有数据，而且我已经将所有内容格式化为 xml 文件。

我的数据库函数调用返回一个 Cursor 对象，我想我可以使用

```
SimpleCursorAdapter(); 
```

但我似乎找不到将其发送到 textview 的文档。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:54:06.923

比如说，你有一个用 id 为**tv的 XML 定义的 TextView**

`TextView t = (TextView) findViewById(R.id.tv);`

并希望在从数据库查询后为其设置文本。

假设您有一个包含两列 A 和 B 的表，并使用如下查询：

```
 String q = "SELECT * FROM table_name where(your_condition)";
  Cursor c = db.rawQuery(q, null); 
```

假设您想使用**A**列的值，可以使用 `c.getString(c.getColumnIndex("A"));`

使用光标 c 如下：

```
 if(c.getCount() == 0)
                  {

            //no data found
                  }
                  else  {
                      String j="";
                      c.moveToFirst();
                      do {
                          String cm = c.getString(c.getColumnIndex("A"));
                                             j = j+cm;   
                          } while (c.moveToNext());
                      c.close(); 
```

现在将此文本设置为您的 TextBox(Dynamic :D )：

```
t.setText(j); 
```

* * *

这是一个完整的示例：我的[数据库项目](http://www.mediafire.com/?569on9rvb4qoa7w)（使用简单的方法），您可以尝试。

# javascript - 在对象上定义 getter，以便所有未定义的属性查找返回“”

> ID：10727855
> 
> 赞同：10
> 
> 时间：2012-05-23T21:08:26.113
> 
> 标签：javascript, node.js

基本上我需要能够做到这一点：

```
var obj = {"foo":"bar"},
    arr = [];
with( obj ){
   arr.push( foo );
   arr.push( notDefinedOnObj ); // fails with 'ReferenceError: notDefinedOnObj is not defined'
}
console.log(arr); // ["bar", ""] <- this is what it should be. 
```

我正在寻找与[`{}.__defineGetter__`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/DefineGetter) or [{get}](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Special/get)等效的“全局” ，以便为所有未定义的属性 getter 返回一个空字符串（请注意，这与 is 的属性不同`undefined`）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T19:50:10.173

您可以创建一个[`Proxy`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Proxy)以在访问未定义的属性时返回一个空字符串。

`app.js`：

```
var obj = {"foo":"bar"},
    arr = [],
    p = Proxy.create({
        get: function(proxy, name) {
            return obj[name] === undefined ? '' : obj[name];
        }
    });
arr.push( p.foo );
arr.push( p.notDefinedOnObj );

console.log(arr); 
```

正如问题作者 David Murdoch 所指出的，如果您使用的是 node v0.6.18（撰写本文时的最新稳定版本），则必须`--harmony_proxies`在运行脚本时传递该选项：

```
$ node --harmony_proxies app.js
[ 'bar', '' ] 
```

请注意，如果您使用 ，此解决方案将不起作用**，**`with`如：

```
var obj = {"foo":"bar"},
    arr = [],
    p = Proxy.create({
        get: function(proxy, name) {
            return obj[name] === undefined ? '' : obj[name];
        }
    });
with ( p ) {
   arr.push( foo ); // ReferenceError: foo is not defined
   arr.push( notDefinedOnObj );
}

console.log(arr); 
```

`with``get`将代理添加到作用域链时似乎没有调用代理的方法。

`Proxy.create()`注意：在本示例中传递给的代理处理程序是*不完整*的。有关更多详细信息，请参阅[代理：常见错误和误解](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Proxy#Common_mistakes_and_misunderstanding)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T21:15:27.277

javascript 中没有全局缺失成员处理程序。您需要引入一个函数来抽象出行为

```
function getOrEmpty(obj, name) {
  if (!obj.hasOwnProperty(name)) {
    return "";
  }
  return obj[name];
}

var obj = {"foo":"bar"},
    arr = [];
arr.push(getOrEmpty(obj, "foo"));
arr.push(getOrEmpty(obj, "someUndefinedProperty"));
console.log(arr); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-02T10:27:09.307

使用 ES6 及更高版本，您可以使用 Proxy，就像建议的接受答案一样。但是如果你被 ES5 卡住，这里有一个答案。

使用 ES5，您必须创建自己的类，就像在这个快速示例中一样

```
function StrictObject() {
  var values = Object.create(null);
  this.set = function (key, value) {
    values[key] = value;
  };
  this.get = function (key) {
    if (!(key in values)) {
      throw new Error("Could not find " + key);
    }
    return values[key];
  };
}
var obj = new StrictObject();

obj.set('dad', 'homer');
console.log(obj.get('dad'));    // homer
console.log(obj.get('uncle'));  // throws error 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-29T18:23:05.733

`Proxy.create`似乎不再是一件事了。

这是一个新的例子：

```
const p = new Proxy({foo:1}, {
    get(obj, name) {
        return Object.hasOwnProperty.call(obj, name) ? obj[name] : '';
    }
})

console.log(p.foo);
console.log(p.bar);
```

你可以 [ab] 使用它来做一些有趣的小事情，比如创建 React 助手：

```
const cc = new Proxy(Object.create(null), {
    get(proxy, name) {
        return ({className,...props}) => React.createElement(name, {className: classcat(className), ...props})
    }
})

<cc.tr className={[theme.tr,theme.hrow]}>...</cc.tr>
// renders: <tr class="datatable_tr--2vnM1 datatable_hrow--_PG2G">...</tr> 
```

# sybase-asa - 是否有列出无效触发器的表？

> ID：10727860
> 
> 赞同：1
> 
> 时间：2012-05-23T21:08:41.707
> 
> 标签：sybase-asa

我正在尝试卸载 Sybase ASA 9 的架构，它一直持续到 90% +，但是在创建触发器时它给了我一个错误：

> `adjusted_amount`没有找到

它没有告诉我哪个触发器正在引用此列。有什么方法可以找到引用此列的触发器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:05:27.800

你可以试试：

```
select trigger_defn from sys.systrigger 
    where trigger_defn like '%adjusted_amount%' 
```

# google-chrome - Google Chrome 错误 - 网页无法正确显示

> ID：10727861
> 
> 赞同：0
> 
> 时间：2012-05-23T21:08:45.177
> 
> 标签：google-chrome, browser, webpage

网页在我的 google chrome 浏览器中显示不正确。不显示按钮中的文本。有时文本会出现乱码。

在我的浏览器（谷歌浏览器）中，这就是 facebook 的样子。- ![在此处输入图像描述](../Images/fe85b0e9f77949cf48f713ad5bd06762.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:13:50.740

您是否尝试清除缓存？如果它在您的另一个浏览器中运行良好，那么您可能应该重新安装 chrome。我的一切都很好，所以我认为这不是 Facebook 的问题

# json - Rails 3.2 - ActiveResource - 使用带有 JSON 的 POST/PUT

> ID：10727862
> 
> 赞同：6
> 
> 时间：2012-05-23T21:08:46.503
> 
> 标签：json, ruby-on-rails-3.2, activeresource, actioncontroller

我一直在看这个一段时间，目前不知所措。我已将问题缩小到与 JSON 相关，并且 JSON 似乎没有以清晰的格式发送。

我们之前使用的是 Rails 3.0.7（我要描述的问题不存在）。我们需要升级 Rails 以利用一些新功能 - 但现在出现了这个问题。在这一点上，我几乎可以肯定这是一个简单的配置或其他东西，但我需要更多的关注它。

我们正在使用 ActiveResource 对象，并且在设置对象的值并保存它（从而进行 PUT）时，我们得到从远程 Web 服务返回的 ab 403:Forbidden。这在 Web 服务层上不是问题。

在创建一个新对象并进行 POST 时，我们得到一个 409:Conflict 返回，因为它试图用默认值更新数据库——这意味着 json 数据没有到达服务——或者不清晰。

我的问题是这在 Rails 3.0.7 中有效，在 3.2.3（或我也尝试过的 3.1.3）中不再有效。我对 JSON 数据以外的建议持开放态度，但我很确定这就是问题所在。

我的 ActiveResource 模型有

```
self.format = :json 
```

我的初始化程序文件之一中有以下内容：

```
ActiveResource::Base.include_root_in_json = false
ActiveSupport::JSON.backend = "json_gem" 
```

感谢您的任何建议！

**更新**

我一直在用 curl 进行测试，并通过以下方式使其工作：

```
curl -H "Content-Type: application/json" -d "{\"userID\":\"xxx\", \"label\":\"doc.test.test\", \"value\":\"1,19\", \"id\":\"-1\"}" -v -X POST http://host:port/usermanagement/users/xxx/prefs 
```

我得到了它的工作，但是

1.  似乎必须明确设置 Content-Type 标头，否则会导致 415:Media Unrecognized 错误

2.  如果我在 ActiveResource 对象中设置 Content-Type 标头，我仍然会收到 409:Conflict 错误 - 这让我相信 JSON 仍然没有正确形成。

**编辑（再次）**

我已经弄清楚 JSON 的问题出在哪里——Rails 将根保留在 JSON 中。因此，而不是将资源作为

```
{"name":"value", "name":"value"} 
```

它正在发送

```
{"ResourceName": {"name":"value", "name":"value"}} 
```

但是，我已设置`include_root_in_json`为 false - 我在初始化程序文件中以及直接在模型本身中都尝试了这个，并且没有更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T19:25:33.440

所以我通过覆盖`to_json`模型中的方法来“修复”这个（解决它）以简单地返回`self.attributes.to_json`

```
class Document < ActiveResource::Base
  self.site += 'user/:user_id'
  self.element_name = "docs"

  def to_json(options={})
    self.attributes.to_json(options)
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-11T03:31:46.367

看起来 ActiveResource::Base.include_root_in_json 在 Rails 3-2-stable（包括 3.2.13）中被破坏了。此问题已在独立的 activeresource 存储库中修复：

```
def to_json(options={})
  super(include_root_in_json ? { :root => self.class.element_name }.merge(options) : options)
end 
```

您可以通过做同样的事情在您的一个初始化程序中对其进行修补。

**更新**：此问题已在 rails 3-2-stable [backport commit中修复](https://github.com/rails/rails/commit/ec55866e398feb1a52701027ab86857b62622ab6#activeresource/lib/active_resource/base.rb)

# php - 转义多个字符串的好习惯

> ID：10727865
> 
> 赞同：0
> 
> 时间：2012-05-23T21:08:50.607
> 
> 标签：php, mysql, string, escaping

一次转义多个字符串（来自 POST 或 GET 的字符串）时，这是一种好习惯吗？

还有什么我应该考虑或做不同的事情吗？我现在有 PDO，但在这段代码中我不想使用它。

```
class Bo extends Db
{
    function clean($cThis)
    {
        $res = array();
        foreach (array_keys($cThis) as $key) {
            $res[$key] = mysql_real_escape_string(addslashes($cThis[$key]));
        }
        return $res;
    }

    function add($info)
    {
        $this->dbConnect();
        $cInfo = $this->clean($info);

        mysql_query("INSERT INTO table (b, c) VALUES ('".$cInfo['b']."', '".$cInfo['c']."')");
        $this->dbDisconnect();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:09:49.480

好的做法是使用[PDO](http://php.net/manual/en/book.pdo.php)和[准备好的语句](http://www.php.net/manual/en/pdo.prepared-statements.php)，*而不是*手动转义字符串并将它们连接到查询中，例如：

```
$db = DB::connect($dsn);
$sth = $db->prepare("INSERT INTO table (b, c) VALUES (?, ?)");
$res = $sth->execute(array($info['b'], $info['c']));
$db->disconnect() 
```

哦，确保`gpc_magic_quotes`也被禁用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:29:22.080

PDO 将是最好的选择，但如果你没有它。有一些模仿`pg_query_params`mysql的方法。它被写成一个类的方法，`$this->dbconn`是返回的连接资源`mysqli_init`。当然，您可以`mysqli`使用适当的`mysql`类似物更改方法。

```
/**
 * Returns the single value of the array mysqli_query_params__parameters
 *
 * @param $at the position of the parameter inside the array mysqli_query_params__parameters
 * @return mixed
 */
public function mysqli_query_params__callback( $at )
{
    return $this->mysqli_query_params__parameters[ $at[1]-1 ];
}

/**
 * Parameterised query implementation for MySQL (similar PostgreSQL's PHP function pg_query_params)
 * Example: mysqli_query_params( "SELECT * FROM my_table WHERE col1=$1 AND col2=$2", array( 42, "It's ok" ), $dbconn );
 *
 * @param $query, $parameters, $datadase
 * @return mixed(resorce, false)
 * @access public
 */
public function mysqli_query_params( $query, $parameters=array(), $database=false )
{
    if( !is_array($parameters) ){
        return false;
    } else {
        if($this->is_assoc($parameters)){
            $parameters = array_values($parameters);
        }
    }

    // Escape parameters as required & build parameters for callback function
    foreach( $parameters as $k=>$v )
    {
        $parameters[$k] = ( is_int( $v ) ? $v : ( NULL===$v ? 'NULL' : "'".mysqli_real_escape_string( $this->dbconn, $v )."'" ) );
    }
    $this->mysqli_query_params__parameters = $parameters;

    // Call using mysqli_query
    if( false === $database )
    {
        $query = preg_replace_callback( '/\$([0-9]+)/', array($this, 'mysqli_query_params__callback'), $query );
        $result = mysqli_query( $this->dbconn, $query );

        if( false === $result )
        {
            $err_msg = mysqli_error($this->dbconn);
            return false;
        } else {
            return $result;
        }
    }
    else
    {
        $query = preg_replace_callback( '/\$([0-9]+)/', array($this, 'mysqli_query_params__callback'), $query );
        $result = mysqli_query( $this->dbconn, $query, $database );

        if( false === $result )
        {
            $err_msg = mysqli_error($this->dbconn);

            return false;
        } else {
            return $result;
        }
    }

    return false;
} 
```

# jquery - 花式盒子根本不工作

> ID：10727868
> 
> 赞同：0
> 
> 时间：2012-05-23T21:09:11.250
> 
> 标签：jquery, fancybox

我试图通过fancybox将缩略图连接到更大的图片。

这就是我在标题中添加文件的方式（我有一个母版页）

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
<link href="css/style-gallery.css" rel="stylesheet" type="text/css" />
<script src="img_fancy/jquery.mousewheel-3.0.4.pack.js" type="text/javascript"></script>
<script src="img_fancy/jquery.easing-1.3.pack.js" type="text/javascript"></script>
<script src="img_fancy/jquery.fancybox-1.3.4.js" type="text/javascript"></script>
<script src="img_fancy/jquery.fancybox-1.3.4.pack.js" type="text/javascript"></script>
<link href="img_fancy/jquery.fancybox-1.3.4.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.4.3.min.js" type="text/javascript"></script> 
```

这是我的缩略图：

```
<div id="galleryContent">
    <%for (int i = 0; i < dt.Rows.Count; i++)
        {%>
        <div class="thumbnail"><a class="photoGallery" href="<%=dtbl_large_pic.Rows[i][1].ToString() %>" ><img src="<%=dt.Rows[i][1].ToString() %>" alt="wedding photo gallery" /></a></div>
        <% } %>

    </div> 
```

这是我的jQuery：

```
 <script type="text/javascript">
        $(document).ready(function () {
            $(".photoGallery").fancybox();

        });

</script> 
```

有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:11:18.557

我的猜测是脚本的顺序包括物质。尝试将 jQuery 放在首位。

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
<link href="css/style-gallery.css" rel="stylesheet" type="text/css" />
<link href="img_fancy/jquery.fancybox-1.3.4.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.4.3.min.js" type="text/javascript"></script>
<script src="img_fancy/jquery.fancybox-1.3.4.js" type="text/javascript"></script>
<script src="img_fancy/jquery.easing-1.3.pack.js" type="text/javascript"></script>
<script src="img_fancy/jquery.mousewheel-3.0.4.pack.js" type="text/javascript"></script>
</asp:Content> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:16:38.820

[fancybox 网站](http://fancybox.net/howto)告诉我们调用脚本的顺序：

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
<link href="css/style-gallery.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/jquery-1.4.3.min.js"></script>
<script type="text/javascript" src="img_fancy/jquery.fancybox-1.3.4.pack.js"></script>
<script type="text/javascript" src="img_fancy/jquery.easing-1.3.pack.js"></script>
<script type="text/javascript" src="img_fancy/jquery.mousewheel-3.0.4.pack.js"></script>
<link rel="stylesheet" href="img_fancy/jquery.fancybox-1.3.4.css" type="text/css" media="screen" /> 
```

我的猜测是您也包括`jquery.fancybox-1.3.4.pack.js`在内`jquery.fancybox-1.3.4.js`？

更新以包含您的文件和文件路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T23:14:30.873

当 fancybox 被初始化时，（假定）绑定到 fancybox 的元素在 DOM 中不存在。它们是通过您设置的`asp`循环 ( `for`) 指令动态添加到文档中的。

Fancybox v1.3.x 不支持动态添加的元素，但是您可以在[此处](https://stackoverflow.com/a/9084293/1055987)找到解决方法。

在您的情况下，调整脚本以匹配您自己的选择器，例如：

```
$("#galleryContent").on("focusin", function(){
 $("a.photoGallery").fancybox({
  // fancybox API options here
 }); // fancybox
}); // on 
```

另请查看参考职位的其他要求。

此外，请遵循所有其他人的建议：

*   首先加载 jQuery
*   加载fancybox.js 或fancybox.pack.js 但不能同时加载
*   不要忘记升级到 jQuery v1.7.x

等等

**注意**：为确保 fancybox 正常工作，硬编码单个链接以便测试它，如下所示：

```
<a class="photoGallery" href="images/image01.jpg">test</a> 
```

# iphone - iOS 5.1 找不到 sqlite 文件

> ID：10727869
> 
> 赞同：0
> 
> 时间：2012-05-23T21:09:14.970
> 
> 标签：iphone, sqlite, path, ios5.1, nsdocumentdirectory

我在查找我的 sqlite 文件时遇到了一些麻烦。当我使用 iOS 5 模拟器运行 de app 时，它运行正常，但是当我在 iOS 5.1 上运行它时，它找不到 sqlite 文件。我正在使用此代码查找文件。

```
- (NSString *) getDatabasePath {
    NSString* databaseName = @"bohn_db.bin.sqlite";
    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDir = [documentPaths objectAtIndex:0];
    return [documentsDir stringByAppendingPathComponent:databaseName];      
} 
```

在 iOS 5 上有效，而在 iOS 5.1 上无效，我尝试将文件从 de main bundle 资源路径复制到文档路径（路径上方），但它不起作用，因为该文件甚至在主要 bunlde 资源中都找不到路径，但文件在那里。iOS 5.1 会发生什么？

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T02:47:07.747

我遇到了同样的问题。在尝试了这么多不同的事情并将数据库从程序中取出并再次添加之后。这一次我确保我检查了“添加目标”。这样做之后，它工作得很好。如果我没有检查它，那么它不会复制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:58:14.070

NSLog 从您的代码中记录数据库路径并手动检查它是否存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T04:17:01.657

从模拟器中删除应用程序并为 getDatabasePath 构建和放置计时器 5 秒。我认为它会起作用。

# matlab - 保存后MATLAB颜色条刻度发生变化

> ID：10727877
> 
> 赞同：1
> 
> 时间：2012-05-23T21:09:48.600
> 
> 标签：matlab, colorbar

我正在更改颜色条的刻度和刻度标签.. 但是，在保存图形 (*.fig) 并重新打开图形后，看起来 MATLAB 将刻度移到了别处。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:51:29.787

它可能有很多东西；第一次尝试：

```
set(fig, 'PaperPositionMode', 'auto'); 
```

如果这不起作用，你将不得不提供更多关于你如何保存它的信息（通过代码或 GUI，什么命令？），甚至可能你如何设置你的刻度 n' 标签。

# linux - 发生错误后如何从后续运行中停止 cron 作业

> ID：10727884
> 
> 赞同：1
> 
> 时间：2012-05-23T21:10:07.623
> 
> 标签：linux, bash, unix, cron

如果 cron 作业在上次运行后未成功退出，有哪些不同的做法可以防止它再次运行？

使用锁定文件合适吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:12:25.717

是的，锁定文件是最简单的解决方案。

# java - 使用 scribe 库将图像发布到 Facebook 页面

> ID：10727887
> 
> 赞同：0
> 
> 时间：2012-05-23T21:10:36.320
> 
> 标签：java, facebook, scribe

我正在尝试使用[scribe](https://github.com/facebook/scribe)库将图像发布到 facebook。我的代码是：

```
String apiKey = "MY_API_KEY";
        String apiSecret = "MY_SECRET_KEY";
        OAuthService service = new ServiceBuilder().provider(FacebookApi.class).apiKey(apiKey)
                .apiSecret(apiSecret)
                .callback("MY_CALL_BACK_URL")
                .build();

        Token accessToken = new Token("MY_ACCESS_TOKEN","");
        OAuthRequest request = new OAuthRequest(Verb.POST, PROTECTED_RESOURCE_URL_STREAM);       
        request.addHeader("Content-Type", "text/html");      
        request.addBodyParameter("message", "Testing auto update.. Please ignore " + new DateTime());           
        //MultiPart for pic
        Multipart mp = new MimeMultipart();
        MimeBodyPart htmlPart = new MimeBodyPart();
        ByteArrayOutputStream out = new ByteArrayOutputStream();    
        try {
            byte[] imagePayLoad = msgBody.getBytes("UTF-8");    //msgBody contains html string   
            byte[] mpByte = new byte[imagePayLoad.length];
            htmlPart.setContent(msgBody, "text/html");
            mp.addBodyPart(htmlPart);           
            //here I get the bytes[] of mp to out
            mp.writeTo(out);
            out.write(mpByte);      

            request.addPayload(mpByte);
        } catch (Exception e) {         
            e.printStackTrace();
        }   
        service.signRequest(accessToken, request);
        Response response = request.send();
        System.out.println("Response");
        System.out.println();    
        System.out.println(response.getCode());
        System.out.println(response.getBody());

    } 
```

但我也得到

```
400
{"error":{"message":"(#100) Missing message or attachment","type":"OAuthException","code":100}} 
```

任何人都可以帮忙，如果我取出 Multipart ，文本“测试自动更新..请我..”更新到 Facebook。我需要上传图片并作为字节[]。

谢谢

我在用：

```
 <dependency>
<groupId>org.scribe</groupId>
<artifactId>scribe</artifactId>
<version>1.3.0</version>
</dependency> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:33:44.470

Scribe 使用其中一个`addBodyParameter`或`addPayload`，而不是两者。看[这个方法](https://github.com/fernandezpablo85/scribe-java/blob/master/src/main/java/org/scribe/model/Request.java#L256-268)。

如果你走这`addPayload`条路，那么我想你也必须弄清楚如何`message`进入多部分。

注意：请求的实际内容的字符串输出（使用[Request#getBodyContents](https://github.com/fernandezpablo85/scribe-java/blob/master/src/main/java/org/scribe/model/Request.java#L244)）会很好。

# svg - 如何在 SVG 上居中引导工具提示？

> ID：10727892
> 
> 赞同：11
> 
> 时间：2012-05-23T21:11:02.327
> 
> 标签：svg, twitter-bootstrap, tooltip

我想将工具提示向右移动几个像素，因此箭头位于光标所在单元格的中心（当前，它位于（0,0），即左上角）。这是我的代码：

```
 $("rect.cell").tooltip({
    title: "hola",
    placement: "top"
  }); 
```

和一张图片： ![在此处输入图像描述](../Images/e60a389c1aba086607a88f24376a1525.png)

理想情况下，我想使用 javascript 来执行此操作，因此如果我更改单元格的大小，我可以更新像素数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-08T22:04:48.677

这是 nachocab 的 getPosition 实现的简单扩展，它支持常规 HTML 元素和 SVG 元素：

```
getPosition: function (inside) {
  var el = this.$element[0]
  var width, height

  if ('http://www.w3.org/2000/svg' === el.namespaceURI) {
      var bbox = el.getBBox()
      width = bbox.width
      height = bbox.height
  } else {
      width = el.offsetWidth
      height = el.offsetHeight
  }

  return $.extend({}, (inside ? {top: 0, left: 0} : this.$element.offset()), {
    'width': width
  , 'height': height
  })
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:12:20.783

它似乎是 SVG 元素的 Firefox/Chrome 中的一个错误（就像我的情况一样）[https://bugzilla.mozilla.org/show_bug.cgi?id=649285](https://bugzilla.mozilla.org/show_bug.cgi?id=649285)

所以我只是从这里更改了 bootstrap-tooltip.js：

```
getPosition: function (inside) {
  return $.extend({}, (inside ? {top: 0, left: 0} : this.$element.offset()), {
    width: this.$element[0].offsetWidth
  , height: this.$element[0].offsetHeight
  })
} 
```

对此：

```
getPosition: function (inside) {
  return $.extend({}, (inside ? {top: 0, left: 0} : this.$element.offset()), {
    width: this.$element[0].getBBox().width
  , height: this.$element[0].getBBox().height
  })
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T04:57:46.283

我发现 Chrome（适当的高度，但位于 svg:rect 元素的最左侧）和 Firefox（适当的高度，完全不正确的 x 位置）中的定​​位是不稳定的。我一直在使用 jQuery 的 svgdom 插件（不确定这是否会影响我的结果），但这是我想出的解决方案：

[https://gist.github.com/2886616](https://gist.github.com/2886616)

这是与组合 boostrap.js 的差异。这是其他人针对引导程序提出的长期休眠问题：

[https://github.com/twitter/bootstrap/issues/2703](https://github.com/twitter/bootstrap/issues/2703)

# iphone - 简单的 iOS 应用程序的数据存储方法是什么？

> ID：10727893
> 
> 赞同：2
> 
> 时间：2012-05-23T21:11:05.033
> 
> 标签：iphone, database, sqlite, database-design, core-data

我正在编写一个天气应用程序，它会根据当前的条件/温度来了解你穿什么，告诉你应该在外面穿什么。我正在收集一些简单的数据并将其存储在设备上。我正在收集：

*   约会时间
*   天气温度
*   天气状况
*   6个整数字段：
    *   头
    *   胸部
    *   手
    *   腿
    *   脚
    *   配饰

我将根据当前的温度/条件查询数据，得到 6 个 int 字段中的值的平均值，以预测用户通常穿什么。

我只保留在 iPhone 上。什么是好的客户端数据存储方法？查询不是太激烈，但我需要查询类型和范围。

我以前没有使用过Core Data。对 MySQL 非常熟悉，但没有接触过 SQLite。同样，为了简单/速度，我想保留这个客户端而不使用数据库。我的目标是进入/退出应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T00:45:41.247

我建议使用 Core Data 或 SQLite。你的权利，这不是很多数据被存储。如果该应用程序是成功的，并且您想扩展您的概念怎么办？

例如：

(1) 你想存储更多的数据

(2) 也许同步数据到服务器

(3) 更改您存储的数据类型

你甚至在你的问题中提到了 QUERY，对我来说这就是你的答案。使用 Core Data，这一切都会变得容易得多。会有一个学习曲线，但学习这个框架将对未来的项目有益。

祝你的项目好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:11:58.897

之前的一张海报推荐使用 Core Data 而不是 SQLite。尽管他们建议这两种选择之一是正确的，但如果您已经熟悉 MySQL 并且正在寻找一个入门/退出应用程序，我建议您使用 SQLite。

Core Data 是一个优秀的框架，但是考虑到你的规范和你以前的经验，有一个学习曲线可能不值得。SQLite 简单、快速且是客户端。此外，您的查询看起来与 MySQL 没有任何不同。

其他海报提到通过 NSUserDefaults 或 NSKeyedArchiver 进行序列化。虽然它们确实使序列化变得简单，但您最终将使用 NSPredicate 滚动您自己的查询代码。这并不难，但同样，它可能是一项新技术，虽然值得，但最好留到下一次。更令人担忧的是，如果您的应用确实开始快速使用大量数据，它们将无法很好地扩展。

关于更普遍的规模，如果您的应用程序确实非常成功，那么请担心它。您始终可以在必要时重构和扩展。

# c# - oracle 表权限

> ID：10727894
> 
> 赞同：0
> 
> 时间：2012-05-23T21:11:15.277
> 
> 标签：c#, oracle

在 Oracle 中，`MYTABLE`所有者是`USER1`并将权限分配给`USER2`. 但在 C# 代码中，`USER2`仍然无法访问该表。

如果我使用`USER1`所有者在 C# 代码中查询此表，它会说：

> 无法执行查询

```
GRANTEE                      OWNER               TABLE_NAME       GRANTOR              PRIVILEGE                              GRANTABLE HIERARCHY 
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------------------------------------- --------- --------- 
USER2                       USER1                MYTABLE         USER1                DELETE                                   NO        NO        
USER2                       USER1                MYTABLE         USER1                SELECT                                   NO        NO        
USER2                       USER1                MYTABLE         USER1                UPDATE                                   NO        NO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:35:44.397

User2 尝试查询表时出现什么错误？User2 发出的确切查询是什么？

最常见的问题是 User2 没有使用模式名称限定表名。默认情况下，User2 需要执行类似的操作

```
SELECT *
  FROM User1.MyTable 
```

如果您不想限定表名，您可以在 User2 的架构中为 User1 的 MyTable 创建同义词

```
CREATE SYNONYM myTable
   FOR User1.MyTable 
```

或者您可以创建一个公共同义词（公共同义词对所有用户可见，尽管它们对权限没有影响）

```
CREATE PUBLIC SYNONYM myTable
   FOR User1.MyTable 
```

或者您可以`current_schema`在连接后为会话设置

```
ALTER SESSION SET current_schema = User1 
```

如果您执行任何这些操作，User2 将能够运行查询

```
SELECT *
  FROM MyTable 
```

并有`MyTable`决心`User2.MyTable`。私有同义词是最小的占用空间——它仅适用于 User2 并且仅适用于`MyTable`. 公共同义词意味着任何被授予权限的人`User1.MyTable`都可以在不使用模式名称限定表名的情况下查询它。更改`current_schema`意味着将来该会话的所有不合格对象引用都将在`User1`架构中而不是当前用户的架构中解析。

# ruby-on-rails - 无法在保龄球应用程序中插入数据库

> ID：10727897
> 
> 赞同：0
> 
> 时间：2012-05-23T21:11:28.157
> 
> 标签：ruby-on-rails

我的申请有问题。有保龄球比赛。其中生成最终结果的名称。我在插入数据库时​​遇到问题

看法：

```
 <%= form_for player_index_path(@player) do |f|%>
<div class="text_field">
    <p>
    <%= f.label "Spelare namn" %>
    <%= f.text_field :name %>
    </p>
    <p> 
    <%= f.submit "Lägg till spelare"%>
    </p>
</div>
  <%end%> 
```

类 Player < ActiveRecord::Base attr_accessible :name belongs_to :result end

控制器：

```
 def create
 @player = Player.new(params[:player])

if @player.save
  render :action => "index"
  else
 render :action => "new"
end        
end 
```

迁移：

```
class CreatePlayers < ActiveRecord::Migration
   def change
   create_table :players do |t|
        t.string "name"
        t.references :results
       t.timestamps
end 
```

结束结束

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:15:35.180

什么版本的 Rails？可以发一下你的模型吗？

如果它是最新版本的 Rails，您必须将您的属性列入白名单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:53:03.307

尝试更换

```
<%= form_for player_index_path(@player) do |f|%> 
```

和

```
<%= form_for @player do |f|%> 
```

# sql - Oracle 11g 透视不同行

> ID：10727901
> 
> 赞同：0
> 
> 时间：2012-05-23T21:11:42.930
> 
> 标签：sql, oracle, oracle11g, distinct, pivot

我有这样的数据：

```
**ATTR_ID**    **ATTR_VAL**
103            E
104            F             
136            E
136            U 
```

我想使用 PIVOT 将数据转换为：

```
**103**     **104**     **136**
E           F           U
E           F           E 
```

在 PIVOT 中使用 MAX() 会产生一条记录。我需要得到这两个记录。一个属性 id 可以有多个属性值。

```
SELECT *
( SELECT ATTR_ID, ATTR_VAL FROM DATA_TABLE )
PIVOT (MAX(ATTR_VAL) FOR ATTR_ID IN (103,104,136)) 
```

我会使用 PIVOT 解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:24:36.647

如果您只想要笛卡尔积

```
SELECT attr_103.attr_val as "103",
       attr_104.attr_val as "104",
       attr_136.attr_val as "136"
  FROM (SELECT attr_id, attr_val
          FROM attr_table
         WHERE attr_id = 103) attr_103
       CROSS JOIN 
       (SELECT attr_id, attr_val
          FROM attr_table
         WHERE attr_id = 104) attr_104
       CROSS JOIN 
       (SELECT attr_id, attr_val
          FROM attr_table
         WHERE attr_id = 136) attr_136 
```

# python - 内置 Python 函数以跳过数据行

> ID：10727905
> 
> 赞同：0
> 
> 时间：2012-05-23T21:11:52.363
> 
> 标签：python, filter

我有一个读取 3GB 大数据文件的脚本，我不需要所有数据，如果满足条件，我想跳过特定的数据行。是否有 Python 函数可以跳过数据文件中的一行数据并继续读取文件？我检查了 3.2 文档，但只找到了一个跳过数据块的函数。

**编辑**

读入这样的数据

```
def read_file(F):      #Function that reads data froma file  
                   #and extracts specific data columns
X = []
Y = []                # Creats Data Lists
Z = []

N =   11912639  # number of lines to be read
f = open(F)           #Opens file
f.readline()          # Strips Header
nlines = islice(f, N) #slices file to only read N lines

for line in nlines:             #Loop Strips empty lines as well as replaces tabs with   space
    if line !='':
        line = line.strip()
        line = line.replace('\t',' ')
        columns = line.split()
        x = columns[0]             # assigns variable to columns
        y = columns[1]
        z = columns[2]
        X.append(x)
        Y.append(y)                #appends data in list
        Z.append(z) 
```

我想做的是在上面的代码中添加一个 if 语句，例如

```
if x > somevalue:
    skipline
else:
    continue 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:14:23.033

如果文件中的行对应于行，则只需使用列表推导：

```
with open(path) as input_file:
    contents = [row for row in input_file if not unwanted(row)] 
```

如果您从一些惰性阅读器而不是默认的逐行文本文件阅读器读取文件，则可能会出现类似的结构。

如果您想懒惰地读取文件，请替换`[]`为。`()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:47:59.990

如果我正确理解您的示例代码，那么您正在寻找的是这样的：

```
for line in nlines:
    line = line.strip()
    if line == '': 
        continue # skip empty lines

    line = line.replace('\t',' ')
    x, y, z = line.split()

    if x > somevalue: 
        continue # skip line if x > somevalue

    X.append(x)
    Y.append(y)
    Z.append(z) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:16:24.023

你可以自己手动完成。

```
for line in file:
    if 'foo' not in line:  
        print 'profiting' 
```

# c# - 使用旧的 ado.net 实现通用存储库模式

> ID：10727910
> 
> 赞同：11
> 
> 时间：2012-05-23T21:12:08.397
> 
> 标签：c#, design-patterns, orm, domain-driven-design, repository-pattern

由于平台限制，我正在尝试使用 ado.net 实现存储库模式。

```
public interface IGenericRepository<T> : IDisposable where T : class
{
    IQueryable<T> GetAll();
    IQueryable<T> FindBy(Expression<Func<T, bool>> predicate);
    void Add(T entity);
    void Delete(T entity);
    void Edit(T entity);
    void Save();
} 
```

如何完成下面的抽象类...？

```
public abstract class GenericRepository<C, T> :
    IGenericRepository<T>
    where T : class
    where C : IDbDataAdapter, new()
{

    private C dbDataAdapter = new C();
    protected C DB
    {
        get { return dbDataAdapter; }
        set { dbDataAdapter = value; }
    }

    public virtual IQueryable<T> GetAll()
    {
        DataTable dt;
        dbDataAdapter.fill(dt);
        IQueryable<T> query = dt....?;
        return query;
    }

    public IQueryable<T> FindBy(System.Linq.Expressions.Expression<Func<T, bool>> predicate)
    {

        IQueryable<T> query = dbDataAdapter.???Set<T>???().Where(predicate);
        return query;
    } 
```

* * *

**更新：**
稍后我将通过固有的这两个接口/类来实现域指定的存储库。

```
public class FooRepository :
    GenericRepository<FooBarEntities, Foo>, IFooRepository {

    public Foo GetSingle(int fooId) {

        var query = GetAll().FirstOrDefault(x => x.FooId == fooId);
        return query;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T21:25:02.760

拥有通用存储库通常不是一个好主意。存储库是一个重要的领域概念，您不想过度概括它，就像您不想概括您的实体一样。通用存储库是 CRUDy 并将焦点从您的域转移。请考虑[Greg Young 的这篇文章](http://codebetter.com/gregyoung/2009/01/16/ddd-the-generic-repository/)。

在相关的说明中，除了使您的代码更少**域**和更多**数据**驱动之外，公开 IQueryable 将引入[紧密耦合。](http://blog.ploeh.dk/2012/03/26/IQueryableIsTightCoupling.aspx)

 ***** * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-01T08:51:20.747

不是很主题，但我有类似的问题，这是我的解决方案（任何人都可以帮忙）

创建身份类：

```
public class Identity
    {
        public int Id { get; set; }
    } 
```

创建实体类：

```
public class Employee: Identity
    {
        public string Name { get; set; }
        public string Surname { get; set; }
        public int Age { get; set; }
    } 
```

存储库接口（也只能使用抽象类）：

```
interface IRepository<T> where T: Identity
    {
        T GetById(int id);
        ICollection<T> GetAll();
        ICollection<T> GetAll(string where);
        void Update(T entity);
        void Insert(T entity);
        bool Delete(T entity);
        bool Delete(ICollection<T> entityes);
    } 
```

创建通用抽象类：

```
public abstract class AbstractRepository<T>: IRepository<T> where T : Identity
    {
        protected abstract string TableName { get; }

        protected abstract T DataRowToModel(DataRow dr);

        protected virtual ICollection<T> DataTableToCollection(DataTable dt)
        {
            if (dt == null)
            {
                return null;
            }
            return dt.AsEnumerable().Select(x => DataRowToModel(x)).ToList();
        }

        public virtual T GetById(int id)
        {
            var query = $"select * from {TableName} where id = {id}";
            //the data access layer is implemented elsewhere
            DataRow dr = DAL.SelectDataRow(query); 
            return DataRowToModel(dr);
        }

        public virtual void Delete(T entity)
        {
            if (entity.Id == 0 )
            {
                return;
            }
            var query = $"delete from {TableName} where id = {entity.Id}";
            DAL.Query(query);
        }

        public virtual void Delete(ICollection<T> entityes)
        {
            var collectionId = IdentityCollectionToSqlIdFormat(entityes);
            if (string.IsNullOrEmpty(collectionId))
            {
                return;
            }
            var query = $"delete from {TableName} where id in ({collectionId})";
            DAL.Query(query);
        }

        public virtual ICollection<T> GetAll()
        {
            var query = $"select * from {TableName}";
            DataTable dt = DAL.SelectDataTable(query);
            return DataTableToCollection(dt);
        }

        public virtual ICollection<T> GetAll(string where)
        {
            var query = $"select * from {TableName} where {where}";
            DataTable dt = DAL.SelectDataTable(query);
            return DataTableToCollection(dt);
        }

        protected virtual string IdentityCollectionToSqlIdFormat(ICollection<T> collection)
        {
            var array = collection.Select(x => x.Id);
            return string.Join(",", array);
        }

        public abstract bool Update(T entity);
        public abstract bool Insert(T entity);
    } 
```

并实现 EmployeeRepository：

```
public class EmployeeRepository : AbstractRepository<Employe>
    {
        protected sealed override string TableName
        {
            get
            {
                return "dbo.Employees";
            }
        }

        protected sealed override Employe DataRowToModel(DataRow dr)
        {
            if (dr == null)
            {
                return null;
            }
            return new Employe
            {
                Id = dr.Field<int>("id"),
                Name = dr.Field<string>("name"),
                Surname = dr.Field<string>("surname"),
                Age = dr.Field<int>("age")

            };
        }

        public override void Insert(Employe entity)
        {
            var query = $@"insert into {TableName} (name, surname, age)
                            values({entity.Name},{entity.Surname},{entity.Age})";
            DAL.Query(query);
        }

        public override bool Update(Employe entity)
        {
            throw new NotImplementedException();
        }
    } 
```

就这样。在代码中使用：

```
 public class SomeService
{
    public void SomeeMethod()
    {
     int employeeId = 10; // for example
     EmployeeRepository repository = new EmployeeRepository();
     Employee employee = repository.GetById(employeeId);
     repository.Delete(employee);
     //...
    }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T15:18:50.863

如果您从一个充满不一致和大量存储过程的遗留数据库出发，并且您正试图将其与 ORM/Repository 模式挂钩，那么您可能会发现自己对实现 Generic Repository 模式感到非常沮丧。

我知道现在通用存储库模式在教程部分很受欢迎，因为许多较新的应用程序让 Entity Framework 和 Active Record 之类的东西创建数据库（请记住，这种风格意味着没有存储过程或很少使用它们）。在这些较新的场景中，数据往往更清晰，并且很容易将其连接到一些通用存储库模式，因为每个实体几乎都有一个 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T21:21:24.577

您正在尝试构建典型 OR 映射器所做的一部分。这是*很多*工作。为什么不直接使用 ORM？****

# c# - C#的for循环中的两个计数器

> ID：10727911
> 
> 赞同：10
> 
> 时间：2012-05-23T21:12:16.223
> 
> 标签：c#, loops, for-loop, counter

嗨找不到它的 C#，我正在尝试类似的东西

```
for (int j = mediumNum; j < hardNum; j++; && int k = 0; k < mediumNum; k++); 
```

但它不起作用。有什么有效的方法？？？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-23T21:15:35.460

如果我理解正确，你想要这个：

`for (int j = mediumNum, k = 0; j < hardNum && k < mediumNum; j++, k++)`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-23T21:17:06.353

使用`while`循环可能会更好地表达您的意图，也许会使代码更易于阅读：

```
int j = mediumNum;
int k = 0;
while (j < hardNum && k < mediumNum)
{
    //...
    j++;
    k++;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-23T21:16:54.937

这就是你想要的

```
for (int j = mediumNum, k = 0; j < hardNum && k < mediumNum; j++, k++) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-23T21:16:17.333

我想知道你是否确定两个循环总是同时终止。如果没有，循环体将不得不考虑这一点。

```
int j;
int k;
for (j = mediumNum, k = 0; j < hardNum && k < mediumNum; j++, k++); 
```

# amazon-ec2 - 我可以从 EC2 AMI 转换为 VHD 吗？

> ID：10727915
> 
> 赞同：3
> 
> 时间：2012-05-23T21:12:26.043
> 
> 标签：amazon-ec2, amazon-ami, ec2-ami, vhd

我可以下载 vhd 格式的 EC2 实例吗？还是以 AMI 格式下载并将其转换为 VHD？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T04:43:47.927

我已经能够成功地将 EC2 移动到 VHD/VHDX 格式。

简单地说，使用 Windows 备份或 Acronis Backup 对卷上的 EC2 实例进行裸机备份。

将文件上传到 Hyper-V 服务器位置或网络位置。

使用 Acronis 异机还原磁盘或 Windows 备份从备份位置（通常是网络）还原计算机。

从 c:\windows\system32\ 中删除 Amazon 专有驱动程序文件（您会在屏幕上看到错误，具体取决于您执行的备份程序）。

祝你好运！我的下一个任务是在不使用 Amazon 支持的情况下将 VHD 迁移到 EC2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T14:44:09.650

[在您仍然发布问题时， Amazon EC2](http://aws.amazon.com/ec2/)仅提供了*VM Import*，但对这个长期请求的功能的初步支持终于在 2012 年 5 月 25 日发布，请参阅介绍性帖子[VM Export Service For Amazon EC2](http://aws.typepad.com/aws/2012/05/vm-export-for-ec2.html)：

> [AWS VM Import](http://aws.amazon.com/ec2/vmimport/)服务使您能够将各种格式的虚拟机导入 Amazon EC2，从而使您能够轻松地从本地虚拟化基础设施迁移到 AWS 云。今天，我们正在为这项服务添加下一个元素。 **您现在可以将之前导入的 EC2 实例导出回您的本地环境**。*[强调我的]*

请注意，**VM Import/Export 仍然仅限于 Microsoft Windows**，具体来说：

> 该服务可以将 Windows Server 2003 (R2) 和 Windows Server 2008 EC2 实例导出到与 VMware ESX 兼容的 VMDK、Microsoft Hyper-V VHD 或 Citrix Xen VHD 映像。我们计划在未来支持更多的操作系统、图像格式和虚拟化平台。

希望后者能很快实现，因为这将显着增加 EC2 的通用性，特别是对于开发场景，尽管有更新和轻量级的[DevOps](http://en.wikipedia.org/wiki/DevOps)方法来解决底层部署问题。

# .net - 计算客户端安装的数量

> ID：10727917
> 
> 赞同：3
> 
> 时间：2012-05-23T21:12:36.617
> 
> 标签：.net, shareware

我正在开发共享软件，我想知道我的产品在用户机器上安装了多少次。我不是在寻找安全或许可问题，但我只是对转换率（安装与注册）感兴趣。我想到了一个简单的 servlet，它将从我的客户使用 UID 调用，并将计算不同的 UID 调用。有谁知道更优雅的解决方案或可以使用的东西？我的客户端软件是用 .NET 编写的。最好的问候塞巴斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-06-04T15:57:19.000

一个有点老的问题，但一年前我也有同样的问题。我也是一名共享软件开发人员，和你一样，我想知道免费安装和付费用户之间的转化率。我的软件在 MacOS 和 Windows 下运行，所以我想要一个跨平台的解决方案。

我最终制定了自己的解决方案。对于 Windows，它是一个 DLL，您可以从应用程序中调用它并将使用数据发送到 Google Analytics（作为共享软件开发人员，您可能已经拥有 Google Analytics 帐户）。我选择 Google Analytics 作为报告平台，因为它是免费的，我的 DLL 也是免费的（目前；我不知道将来）。

更多信息请访问：[https ://www.starmessagesoftware.com/softmeter/sdk-api](https://www.starmessagesoftware.com/softmeter/sdk-api)

发送使用数据非常简单。例子：

```
// don't forget to pick user's consent
bool userGaveConsent = .....(pick from the app settings)....

start("MyApp", "1.0", "Free trial", "Windows edition", "UA-12345-0", userGaveConsent);

// you can send any number and combination of pageViews, screenViews, events, exceptions
sendScreenview("Main screen");
sendEvent("Registration", "User entered registration code", 1 );
sendException("Error while importing a custom file", false);

stop(void); 
```

# powershell - 使用 Power Shell 将页眉和页脚添加到 Word 文档

> ID：10727919
> 
> 赞同：1
> 
> 时间：2012-05-23T21:12:43.950
> 
> 标签：powershell, scripting, ms-word

我正在寻找一种将页眉和页脚插入从 Power Shell 中生成的 Microsoft Word 文档的方法。有没有办法做到这一点？如果是这样，完成此操作所需的一些代码示例是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:38:26.977

```
$Document = "c:\temp\tralala.doc" # Must exist

$Word = New-Object -Com Word.Application
$Word.Visible = $true
$ExistingDoc = $Word.Documents.Open($document)
$Selection = $Word.Selection
$ExistingDoc.ActiveWindow.ActivePane.View.SeekView = 1
$Selection.TypeText("Here is my automated header")
$ExistingDoc.ActiveWindow.ActivePane.View.SeekView = 4
$Selection.TypeText("Here is my automated footer")
$ExistingDoc.Save()
$Word.Quit() 
```

有关 SeekView 的可能值列表，请参见[此处](http://msdn.microsoft.com/en-us/library/aa211923%28v=office.11%29.aspx)。WdSeekView 部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T21:28:06.577

```
# Create a new Word application COM object
$Word = New-Object -ComObject Word.Application;
# Make the Word application visible
$Word.Visible = $true;
# Add a new document to the application
$Doc = $Word.Documents.Add();
# Get the first Section of the Document object
$Section = $Doc.Sections.Item(1);
# Get the header from the Section object
$Header = $Section.Headers.Item(1);
# Get the footer from the Section object
$Footer = $Section.Footers.Item(1);

# Set the text for the header and footer
$Header.Range.Text = "Hey, I'm the header!";
$Footer.Range.Text = "Hey, I'm the footer!";

# Create a Table of Contents (ToC)
$Toc = $Doc.TablesOfContents.Add($Section.Range); 
```

# algorithm - 4xN 多米诺砖的组合数

> ID：10727920
> 
> 赞同：1
> 
> 时间：2012-05-23T21:12:45.527
> 
> 标签：algorithm, dynamic-programming

我想*使用动态编程*找到多米诺砖的 4 x N 区域（4 个单位宽度和 N 个单位高度，N ≥ 1）的可能不同组合的数量。

多米诺砖的大小为 2x1，例如

```
== 
```

对于水平和

```
|
| 
```

对于垂直砖。

现在，

示例 4x1（彼此下方的两块多米诺骨牌）

```
==== 
```

4x2 砖配置示例（共 5 个）

1)

```
||||
|||| 
```

2）（转动右边的两块砖）

```
||==
||== 
```

3)

```
|==|
|==| 
```

4)

```
====
==== 
```

5)

```
==||
==|| 
```

迄今为止已知的唯一组合数

```
4x1 : 1 possibility
4x2 : 5 possibilites
4x3 : 11 possibilites
4x4 : 36 possibilites 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T23:48:32.100

解决一个更普遍的问题。找出平铺 4×N 网格的方法数，其中顶行中的某些位置可能已被占用。将每个位置与 2 的幂相关联，最左边对应 1，第二个 2，第三个 4，最右边 8。设`T(N,k)`4×N 网格的平铺数，其中顶行对应的位置`k`已经被占用。`k == 0`表示没有位置被占用，`k == 6`意味着两个中间位置被占用（6 = 2 + 4）等等。

然后找到转换，当填充顶行的其余部分时，下一行中的哪些模式可以通过多少种方式到达？

例如，如果中间的两个位置都被占用了，那么填充顶行剩余部分的唯一方法是在最左边和最右边的位置垂直放置一个多米诺骨牌，导致

```
|xx|
|  | 
```

以及下一行中两个最外面的位置被占用的配置，对应于`1+8 = 9`，所以`T(N,6) = T(N-1,9)`。而对于`k == 9`，我们从外观开始的情况

```
|  | 
```

我们有两种可能性，

```
|==|     ||||
          || 
```

我们可以通过水平放置一个多米诺骨牌来填补空白，让下一行完全空闲，或者垂直放置两个多米诺骨牌，占据下一行的两个中间位置，所以

```
T(N,9) = T(N-1,0) + T(N-1,6) 
```

使用这些转换来构建`T(n,k)`.

您要查找的值为`T(N,0)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T21:13:47.303

```
F[n] = number of ways to tile a 4-by-n grid
G[n] = number of ways to tile a 4-by-n grid with top-right and bottom-right
    squares uncovered
H[n] = number of ways to tile a 4-by-n grid with bottom-right 2
        squares uncovered
  = number of ways to tile a 4-by-n grid with top-right 2
        squares uncovered
if n >= 2, the right end of any tiling can be
    two vertical dominoes (F[n-1] ways)
    horz, horz vert (H[n-1] ways)
    horz, vert, horz (G[n-1] ways)
    vert, horz, horz (H[n-1] ways)
    4 horizontal dominoes (F[n-2] ways)
 F[n] = F[n-1] + G[n-1] + 2*H[n-1] + F[n-2];
 For G: the right end can be a vertical domino (F[n-1] ways)
        or two horizontal dominoes => top & bottom are horz = G[n-2]
        G[n] = F[n-1] + G[n-2];
 For H: the right end can be a vertical domino (F[n-1] ways)
        or two horizontal dominoes (H[n-1] ways)
        H[n] = F[n-1] + H[n-1];
 F[0] = 1, F[1] = 1, G[0] = 0, G[1] = 1, H[0] = 0, H[1] = 1 
```

希望能帮助到你 ！！

# iphone - iPhone 上的“通话中”扩展状态标题会移动一些视图，但不会移动其他视图（uiscrollview）

> ID：10727924
> 
> 赞同：1
> 
> 时间：2012-05-23T21:13:19.677
> 
> 标签：iphone, ios

在打电话时，如果您导航到我们的应用程序，您会看到一些“混乱”。由于顶部状态视图的大小加倍以指示存在电话并允许快速切换回电话界面，因此屏幕的其余部分向下移动。

出于某种原因，我们的 2 个观点并没有与其他观点发生变化。这可能是巧合，但它们都是 UIScrollView。

由于系统事件（例如扩展的呼叫通知程序），是否需要检查设置以使视图相应地移动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T21:53:05.600

这是通过调整 IB 中的支柱以引用屏幕顶部来解决的。

# sql - 我可以在 SQL Server 中创建一个全局函数吗？

> ID：10727925
> 
> 赞同：9
> 
> 时间：2012-05-23T21:13:20.210
> 
> 标签：sql, sql-server-2008

是否可以在 SQL Server 中创建一个可以在服务器上的任何数据库中使用的函数，而无需添加数据库前缀？

例如，使用此功能：

```
CREATE FUNCTION getDays (@date date)
RETURNS INT
AS
BEGIN

RETURN CASE WHEN MONTH(@date) IN (1, 3, 5, 7, 8, 10, 12) THEN 31
            WHEN MONTH(@date) IN (4, 6, 9, 11) THEN 30
            ELSE CASE WHEN (YEAR(@date) % 4    = 0 AND
                            YEAR(@date) % 100 != 0) OR
                           (YEAR(@date) % 400  = 0)
                      THEN 29
                      ELSE 28
                 END
       END

END 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-23T21:21:24.790

您可以在 master（或其他一些永久数据库）中创建函数，然后在模型数据库中创建同义词：

```
USE model;
GO
CREATE SYNONYM dbo.getDays FOR master.dbo.getDays; 
```

*这将在任何新*数据库中创建该函数的同义词，但对于现有数据库（或将来附加或恢复的数据库），您需要将同义词复制到那里。这将允许您在任何数据库中引用具有两部分名称的对象，而只需存储一份代码副本。

顺便说一句，您的代码可能会更简洁：

```
 RETURN (SELECT DATEPART(DAY, DATEADD(DAY, -1, 
     DATEADD(MONTH, 1, DATEADD(DAY, 1-DAY(@date), @date))))); 
```

所以从顶部开始：

```
USE [master];
GO
DROP FUNCTION dbo.getDays;
GO
CREATE FUNCTION dbo.getDays
(
    @date DATE
)
RETURNS INT
AS
BEGIN
    RETURN (SELECT DATEPART(DAY, DATEADD(DAY, -1, 
         DATEADD(MONTH, 1, DATEADD(DAY, 1-DAY(@date), @date)))));
END
GO 
```

现在在每个数据库中为此创建一个同义词：

```
DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += CHAR(13) + CHAR(10) 
+ 'USE ' + QUOTENAME(name) + ';

IF OBJECT_ID(''dbo.getDays'', ''FN'') IS NOT NULL
  DROP FUNCTION dbo.getDays;

IF OBJECT_ID(''dbo.getDays'', ''SN'') IS NOT NULL
  DROP SYNONYM dbo.getDays

CREATE SYNONYM dbo.getDays FOR master.dbo.getDays;'
 FROM sys.databases WHERE name <> 'master';

PRINT @sql;

EXEC sp_executesql @sql; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T21:18:06.493

尽管在 master 中创建存储过程使它们全局可用，但这不适用于函数。您需要使用三部分命名约定：

```
select <dbname>.<schema>.getDays(...) 
```

为什么微软要让函数不同于存储过程？

# c++ - C ++类中的奇怪构造函数

> ID：10727926
> 
> 赞同：5
> 
> 时间：2012-05-23T21:13:29.960
> 
> 标签：c++, class, constructor

星期六我有一个考试，我正在浏览过去的论文，我遇到了根据 C++ 代码的问题：

```
class Car {
     char *LicencePlate;
     int age;
public:
     Car(const Car &); //this declaration
     ~Car();
} 
```

第 5 行声明的目的是什么？一般来说，这种性质的声明的实现应该提供什么功能？编写在第 5 行执行声明所需的代码，因为它会出现在`Car.cpp`给定信息的文件中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T21:33:58.880

让我们来看看这个。

从名称可以看出，这是一个构造函数。因为它需要一个参数作为对同一类型对象的引用，所以它是一个**复制构造函数**（C++ 命名法）。

如您所知（或不知道），如果您没有复制构造函数，编译器将为您生成一个。编译器生成的复制构造函数执行**浅拷贝**。

### 为什么要实现自己的：

```
class Car {
     char *LicencePlate;
public:
     Car(char* plate, int size)
     {
        LicencePlate = new char[size];
        strcpy(LicencePlate, plate);
     }
     ~Car()
     {
        delete[] LicencePlate;
     }
}; 
```

我已经修改了你的课程以便更好地解释。你的班级现在管理记忆。它为`LicencePlate`. 这是您没有复制构造函数的场景。说你这样做：

```
Car a("abc",3); 
```

*编译器生成*的复制构造函数被调用：

```
Car b(a); 
```

但请记住，这只是一个浅拷贝。所以，实际上，`a.LicencePlate == b.LicencePlate`。**你能看出这有什么问题吗？**

当`a`超出范围时，析构函数被调用并被`a.LicencePlate`删除。`b`但是当超出范围时会遇到未定义的行为，因为`b`' 的析构函数将尝试删除相同的内存（请记住，两个指针指向相同的内存，因为创建了浅拷贝）。

为避免这种情况，您定义自己的复制构造函数：

```
class Car {
     char *LicencePlate;
     int sz;
public:
     Car(char* plate, int size)
     {
        LicencePlate = new char[size+1]();
        strcpy(LicencePlate, plate);
        sz = size;
     }
     Car(const Car& other)
     {
        LicencePlate = new char[other.sz+1]();
        sz = other.sz;
        strcpy(LicencePlate, other.LicencePlate);
     }
     ~Car()
     {
        delete[] LicencePlate;
     }
}; 
```

**三规则**意味着您应该实现一个赋值运算符（您已经有一个复制构造函数和一个析构函数）。这背后的动机是相同的，只有当您分配而不是初始化时问题才会复制：

```
Car a("abc",3);
Car b;
b = a; //assignment - operator= is called 
```

现在我们安全了。`b`，复制时会分配**新的内存**来保存车牌，所以不会发生双重删除。

我更改了代码以证明这一点，但您仍然必须自己将逻辑放入其中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-23T21:15:55.480

它是一个复制构造函数，其目的是制作作为参数给出的对象的精确副本。

我将由您决定如何最好地做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T21:16:37.770

这是一个复制构造函数声明。它需要一个对常量的引用`Car`，这意味着您可以读取传入的值，但不能（没有狡猾的强制转换）写入它。这只是通过复制原始对象来创建新对象的规范方式。您可能希望将 a`strdup`作为实现的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T21:24:29.020

该声明称为复制构造函数。通常，复制构造函数用于将给定实例的新实例构造到类中。

在签名中：

```
Car(const Car &) 
```

“const”意味着传递的实例不能在方法中修改。“&”表示实例通过引用传递到方法中。传入没有“&”（按值传递）的类的实例将使用复制构造函数创建该类的新实例。在声明复制构造函数的情况下，值传递不仅会自我挫败，而且会导致复制构造函数被递归调用，直到遇到堆栈溢出。

进入 cpp 文件的代码应该对传入的实例进行可接受的副本。根据用户场景，以有意义的方式接受。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-23T21:18:05.403

我假设你的意思是 5 号线，那么

```
Car(const Car &); 
```

是一个构造函数，其唯一参数是对另一个 Car 对象的引用。它被标记为 const 以表明构造函数不应该修改给定的汽车。由于它是一个引用，因此您需要检查以确保您没有以某种方式引用正在构造的同一对象：

```
if (this==car){
  return;
} 
```

或类似的东西。

# asp.net - 不允许用户在 ASP.NET 4.0 应用程序上上传文件

> ID：10727928
> 
> 赞同：2
> 
> 时间：2012-05-23T21:13:36.410
> 
> 标签：asp.net, iis, permissions

我正在尝试在 .net 4.0 应用程序中设置一个页面，用户可以在其中上传文件，但我似乎无法设置文件最终应位于的目录的权限以允许这样做。我曾尝试暂时允许所有人完全访问该目录，但无济于事。

我也尝试过允许应用程序池标识（网络服务）对目录具有完全的读/写权限，但这也没有解决它。

我正在使用匿名身份验证，并将用户身份设置为应用程序池身份。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:29:12.303

仔细检查应用程序中的信任级别是否足以使应用程序能够执行写入。

给予应用程序完全信任将做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T10:42:23.650

尝试授予用户 IIS_WPG 访问权限。这将解决问题。

# jquery - jquery，当复选框更改时，我收到两个警报

> ID：10727931
> 
> 赞同：0
> 
> 时间：2012-05-23T21:13:54.453
> 
> 标签：jquery, ajax, mobile, checkbox

我动态生成一个复选框（只有一个），我希望如果选中此复选框，将进行 ajax 调用，以便可以通过 php 文件将值的状态（选中或未选中）保存到数据库中。

我还没有完成 ajax（应该没问题）并用警报对其进行了测试。因此，当用户单击复选框时，会显示警报并选中复选框。但是当用户点击同一页面上的任意位置时，警报会重复出现，并且复选框将被取消选中。然后用户可以点击页面上的另一个元素。怎么了？

继承人的js：

```
function onHeadlinesLoad()
{
var hID = window.localStorage.getItem("headlineID");
window.localStorage.removeItem("headlineID");
window.localStorage.clear();

$.ajax({
       url: "headlines_getter.php?hID=" + hID ,
       success: function(data) {
       if(data){

       $("#headlinescheck").append('<label><input type="checkbox" id="headlinescheck" name="checkbox-1" value="' + hID + '" data-mini="true" /> Yes </label>');

       $("input[type='checkbox']").checkboxradio();
       $("#headlineshome").append(data);
       }
       }
       });

}

$("input[type='checkbox']").live('change',function() {
      alert($("input[type='checkbox']").attr('value'));
 }); 
```

# ruby-on-rails-3 - rails 3 as_json 被覆盖以输出自定义属性名称，漂亮的打印 json 没有转义字符

> ID：10727938
> 
> 赞同：0
> 
> 时间：2012-05-23T21:14:30.317
> 
> 标签：ruby-on-rails-3, json, customization, pretty-print

**Rails v 3.0.11，Ruby v 1.9.3**

以下是我的类，其中包括**ActiveModel::Serializers::JSON**并覆盖**as_json**以输出具有自定义属性名称的 JSON。它使用其他类，如 Cell、Rows 和 Column，这些类又覆盖了自己的 as_json 并包含在其中的**ActiveModel::Serializers::JSON**。

```
class DataObject

include ActiveModel::Serializers::JSON

attr_accessor :rows, :columns, :options

def initialize(rows = [], cols = [], options = {})
  @rows = rows
  @columns = cols
  @options = options
end

def add_row(row)
  @rows << row
end

def add_column(column)
  @columns << column
end

def attributes
  { 'rows' => rows, 'cols' => columns, 'options' => options}
end

def as_json(json_options = {})
  json_hash = {cols: columns, rows: rows}
  json_hash[:p] = options unless options.empty?
  json_hash
end

def create_data
  data = DataObject.new

  data.add_column(Column.new('A', 'New A', 'string'))
  data.add_column(Column.new('B', 'B-label', 'number'))
  data.add_column(Column.new('C', 'Label-C', 'date'))

  row1 = Row.new
  row1.add_cell(Cell.new('first-a'))
  row1.add_cell(Cell.new('first-b', 'First Alphabet B'))
  row1.add_cell(Cell.new('first-c', 'First CCCCC'))
  data.add_row(row1)

  row2 = Row.new
  row2.add_cell(Cell.new('second-a'))
  row2.add_cell(Cell.new('second-b', 'Second Alphabet B'))
  row2.add_cell(Cell.new('second-c', 'Second CCCCC'))
  data.add_row(row2)

  p data.to_json

 end

end 
```

当我像这样从rails控制台测试这个类时：

```
1.9.3dev :001 > dobject = DataObject.new
 => #<DataObject:0xb8fa970 @rows=[], @columns=[], @options={}> 
1.9.3dev :002 > dobject.create_data 
```

我得到以下格式的以下输出：

```
 => "{\"cols\":[{\"id\":\"A\",\"label\":\"New A\",\"type\":\"string\"},{\"id\":\"B\",\"label\":\"B-label\",\"type\":\"number\"},{\"id\":\"C\",\"label\":\"Label-C\",\"type\":\"date\"}],\"rows\":[{\"c\":[{\"v\":\"first-a\"},{\"v\":\"first-b\",\"f\":\"First Alphabet B\"},{\"v\":\"first-c\",\"f\":\"First CCCCC\"}]},{\"c\":[{\"v\":\"second-a\"},{\"v\":\"second-b\",\"f\":\"Second Alphabet B\"},{\"v\":\"second-c\",\"f\":\"Second CCCCC\"}]}]}" 
```

它显示带有转义引号的 JSON，这使得它难以阅读。

*有什么方法可以以可读的方式显示输出，即格式化的 JSON？*

另外，如何覆盖 as_json 以便我可以利用其原始支持的选项，例如 :only、:except 和 :methods 并输出具有所需名称的 JSON 属性？

谢谢 ，

吉涅什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T03:58:43.273

对于可读的 json 输出，这应该有效：

```
puts JSON.pretty_generate(JSON.parse(dobject.create_data)) 
```

# html - 离线缓存优先级？

> ID：10727941
> 
> 赞同：0
> 
> 时间：2012-05-23T21:14:38.213
> 
> 标签：html, offline-caching

我试图弄清楚是否所有页面都应该包含 manifest 属性。据我所见，指定了 manifest 属性并提供动态数据的页面不会显示最新数据，因为它是从 appCache 提供的。如果我在 NETWORK 部分中指定显示动态数据的页面，这些页面仍将由 appCache 提供。我读过的文档并不清楚优先级。有人可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:06:03.360

如果文件最终在应用程序缓存中，它将始终从应用程序缓存中提供。不要将清单文件的引用放在动态页面中，因为它们会被添加到缓存中，唯一能让浏览器加载页面新版本的方法是更新清单文件。

有关此问题和其他问题的更多详细信息，请阅读 Jake Archibald 最近的文章[Application Cache is a Douchebag](http://www.alistapart.com/articles/application-cache-is-a-douchebag/)。

# python - 如何设置具有不同内容类型的 http 标头

> ID：10727942
> 
> 赞同：0
> 
> 时间：2012-05-23T21:14:41.083
> 
> 标签：python, html, http, header, http-headers

我有一个通过 Python 动态创建的网页。它的目的是提供图片，所以第一行设置内容类型：

```
Content-Type: image/png 
```

我想设置 http 标头，特别是缓存控制，但我不太确定内容类型不是 html，所以我确定我不能将 html 样式的标头放入其中。

编辑：代码开始简单：

```
#!/usr/bin/python
# -*- coding: UTF-8 -*-
import string, sys, math, os
print("Content-Type: image/png\n") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:50:59.190

Cache-Control、Content-Type 等是 HTTP 标头，而不是“html 样式标头”。无论内容类型如何，您都可以使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T21:32:44.537

```
import string, sys, math, os
print("Cache-Control: max-age=" + str(86400 * 3650) + ", public")
print("Content-Type: image/png")
print("\n") 
```

这使资源在十年内到期。

# android - 更改图像保存路径

> ID：10727951
> 
> 赞同：0
> 
> 时间：2012-05-23T21:15:30.397
> 
> 标签：android, image, sd-card

我正在保存图像代码...它具有框架布局和叠加图像..它工作得很好，但它保存在根文件夹中，我想将它保存在**sdcard/my_photos**中，这是我的代码：

```
FrameLayout mainLayout = (FrameLayout) findViewById(R.id.frame);
Random fCount = new Random();
int roll = fCount.nextInt(600) + 1;                       
File file = new File(Environment.getExternalStorageDirectory()
    + File.separator + "/ghost" + String.valueOf(roll) +".png" );

Bitmap b = Bitmap.createBitmap(mainLayout.getWidth(),
    mainLayout.getHeight(), Bitmap.Config.ARGB_8888);
Canvas c = new Canvas(b);
mainLayout.draw(c);
FileOutputStream fos = null;
try {
  fos = new FileOutputStream(file);

  if (fos != null) {
    b.compress(Bitmap.CompressFormat.PNG, 90, fos);
    fos.close();
  }
} catch (Exception e) {
  e.printStackTrace();
} 
```

请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:27:35.923

文件 file = new File(Environment.getExternalStorageDirectory() + File.separator + "/ghost" + String.valueOf(roll) +".png" ); 是这里的问题。确保您发送到“新文件（..）”的内容是您要存储照片的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:28:34.587

试试下面的，

```
bool IsDirCreated=false;
File f = new File(Environment.getExternalStorageDirectory()+ File.separator+ "ghost");
if(!f.isDirectory()) 
{
   IsDirCreated=f.mkdirs();
}
else
{
   IsDirCreated=true;
}
if(IsDirCreated==true)
{
        FrameLayout mainLayout = (FrameLayout) findViewById(R.id.frame);
        Random fCount = new Random();
        int roll = fCount.nextInt(600) + 1;                       
        File file = new File(Environment.getExternalStorageDirectory()
    + File.separator + "/ghost/" + String.valueOf(roll) +".png" );

        Bitmap b = Bitmap.createBitmap(mainLayout.getWidth(),
        mainLayout.getHeight(), Bitmap.Config.ARGB_8888);
        Canvas c = new Canvas(b);
        mainLayout.draw(c);
        FileOutputStream fos = null;
        try 
        {
            fos = new FileOutputStream(file);
            if (fos != null) {
            b.compress(Bitmap.CompressFormat.PNG, 90, fos);
            fos.close();
        }
        catch (Exception e) 
        {
          e.printStackTrace();
        }
} 
```

# objective-c - 检查 UIView 是否显示 UIAlertView

> ID：10727957
> 
> 赞同：4
> 
> 时间：2012-05-23T21:15:42.153
> 
> 标签：objective-c, ios, uiview, uialertview, subview

是否可以确定当前 UIView 是否显示 UIAlertView（除了每次创建 UIAlertView 时设置一个变量）。

我在想一些事情

```
 if ([self.view.subviews containsObject:UIAlertView]) { ... } 
```

但这显然行不通。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-24T05:42:07.937

**这在 iOS7 及更高版本中不起作用。**

~~**[alertView Show]**我猜在主窗口上添加子视图。~~

 ~~```
for (UIWindow* window in [UIApplication sharedApplication].windows){
    for (UIView *subView in [window subviews]){
        if ([subView isKindOfClass:[UIAlertView class]]) {
            NSLog(@"has AlertView");
        }else {
            NSLog(@"No AlertView");
        }
    }
} 
```~~  ~~* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-01-16T22:52:07.583

我认为它会起作用：

```
-(BOOL) doesAlertViewExist 
{
    if ([[UIApplication sharedApplication].keyWindow isMemberOfClass:[UIWindow class]])
    {
        return NO;//AlertView does not exist on current window
    }
    return YES;//AlertView exist on current window
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T22:37:34.567

如果您将 UIAlertView 作为属性存储在显示它的视图控制器上，然后运行您的代码：

```
if ([self.view.subviews containsObject:self.myalertview]) { ... } 
```

那应该行得通。~~

# html - 将两个相对定位的 div 堆叠在一起

> ID：10727958
> 
> 赞同：0
> 
> 时间：2012-05-23T21:15:45.600
> 
> 标签：html, css

我有两个 div 我想使用相对定位将它们放在彼此之上。

```
<div id="display_background">
</div>
<div id="display_foreground">
    <div id="home">
        This is the home page
    </div>

    <div id="info">
        This is the info page
    </div>

    <div id="contact">
        This is the contact page
    </div>
</div> 
```

我正在尝试堆叠它们，并且正在使用相对定位，因为我希望 div 位置与背景图像一起调整。

这是我正在使用的CSS：

```
$('#display_background').css({
    'background-color': 'white',
    opacity: 0.5,
    position: 'relative',
    left: '66%',
    top: '66%',
    width: '425px',
    height: '330px',
    border: '1px solid'
});
$('#display_foreground').css({
    position: 'relative',
    left: '66%',
    top: '66%',
    width: '20%',
    height: '25%'
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:26:55.680

您可以尝试将位置更改为绝对位置并添加具有相对位置的包装器。请参阅此示例：http: [//jsfiddle.net/fKmYN/19/](http://jsfiddle.net/fKmYN/19/) 问候，Gijoey

# c# - 将列表框绑定到 ObservableCollection 不工作的WPF

> ID：10727959
> 
> 赞同：1
> 
> 时间：2012-05-23T21:15:48.067
> 
> 标签：c#, wpf, data-binding, listbox, observablecollection

我有一个 JobItem 对象，在它里面，我有：

```
public ObservableCollection<string> BusinessUnit
    {
        get 
        { 
            return businessUnit; 
        }
        set { businessUnit = value; } 

    } 
```

现在用户需要填写一个表格并添加多个业务单位。我创建了一个列表框，旁边有添加和删除按钮。添加按钮打开一个对话框，提示用户添加业务单位的名称，然后将其添加到列表框中。这是我为此编写的代码：

```
<my:ValidatingListBox Grid.Column="1" Grid.ColumnSpan="1" Grid.Row="5" Grid.RowSpan="1" x:Name="businessUnitBox" SelectionMode="Multiple" SelectionChanged="ValidatingListBox_SelectionChanged" IsSynchronizedWithCurrentItem="True">
            <my:ValidatingListBox.ItemsSource>
                <Binding Source="{StaticResource jobItemDataSource}" Path="BusinessUnit" Mode="TwoWay"/>
            </my:ValidatingListBox.ItemsSource>
            </my:ValidatingListBox>

    <Button Style="{StaticResource addBtnStyle}" Grid.Column="2" Grid.Row="5" Name="addBusinessUnitBtn" Click="addBusinessUnitBtn_Click" />
    <Button Style="{StaticResource removeBtnStyle}" Grid.Column="2" Grid.Row="5" Name="delBusinessUnitBtn" Click="delBusinessUnitBtn_Click" /> 
```

在后面的代码中，我将 JobItem 绑定到表单，因为我有其他文本框绑定到其他 JobItems（绑定适用于此）。

```
public NewJobDialog(int workOrderCounter)
    {
        InitializeComponent();
        item = new JobItem();
        base.DataContext = item();
        businessUnitBox.DataContext = item.BusinessUnit;
     } 
```

然后当我点击添加按钮添加一个业务部门时，我有这个代码：

```
private void addBusinessUnitBtn_Click(object sender, RoutedEventArgs e)
    {
        AddBusinessUnitDialog addBusinessUnit = new AddBusinessUnitDialog();
        addBusinessUnit.ShowDialog();

        if (addBusinessUnit.DialogResult == true)
        {
            item.BusinessUnit.Add(addBusinessUnit.BusinessUnit());
        }

    }

    private void delBusinessUnitBtn_Click(object sender, RoutedEventArgs e)
    {
        if (businessUnitBox.Items.Count > 0)
        {
            item.BusinessUnit.Remove((string)businessUnitBox.SelectedItem);
        }

    } 
```

现在当我运行程序时，每次我添加一个业务单位时，它都不会出现在列表框中。请给我一些示例代码，以了解如何使其工作。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T21:21:54.263

我相信这是因为您需要将 DataContext 设置为父类。

```
businessUnitBox.DataContext = item; 
```

这是因为您具有以下绑定

```
<Binding Source="{StaticResource jobItemDataSource}" Path="BusinessUnit" Mode="TwoWay"/> 
```

此外，您可以通过具有..

```
<my:ValidatingListBox ItemsSource="{Binding BusinessUnit}" ... /> 
```

编辑：

如果你真的想要

```
businessUnitBox.DataContext = item.BusinessUnit; 
```

那么你的绑定需要是

```
<my:ValidatingListBox ItemsSource="{Binding Path=." ... /> 
```

# jquery - 一键点击；Divs 以相反方向打开

> ID：10727963
> 
> 赞同：2
> 
> 时间：2012-05-23T21:16:03.033
> 
> 标签：jquery, css, html, onclick

我想知道是否有办法在 JQuery 中实现这种效果。最近有一个 stackoverflow 用户帮助我实现了我想要的效果；现在我想使用 JQuery 并以最有效的方式来完成它。这是小提琴的链接，可以更好地解释我想要实现的目标：

[http://jsfiddle.net/itsbc/U3Lg9/11/](http://jsfiddle.net/itsbc/U3Lg9/11/)

当前版本运行有点不稳定。我正在寻找更平滑的东西，例如：

[http://jsfiddle.net/itsbc/QchfJ/](http://jsfiddle.net/itsbc/QchfJ/)

在此先感谢，BC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T21:50:42.657

好的，所以我采用了您现有的代码并对其进行了一些重构。jQuery 调用就这么简单。

```
$("#opener").click(function() {
    myApp.websiteOpener.displayWebsite('hider1', 'hider2');
}); 
```

然后，您将拥有一个包含所需代码的单独文件。

```
var myApp = {};
myApp.websiteOpener = {

    up: null,
    down: null,
    topPanel: null,
    bottomPanel: null,

    displayWebsite: function(tPanel, bPanel) {
        if (typeof up !== "undefined") return;
        topPanel = tPanel;
        bottomPanel = bPanel;
        up = setInterval(this.goUp, 2);
        down = setInterval(this.goDown, 2);
    },

    goUp: function(x) {
        var h1 = document.getElementById(this.topPanel);
        if (h1.offsetHeight <= 0) {
            clearInterval(up);
            return;
        }
        h1.style.height = parseInt(h1.style.height) - 1 + "%";
    },

    goDown: function(x) {
        var h2 = document.getElementById(this.bottomPanel);
        if (h2.offsetHeight <= 0) {
            clearInterval(down);
            return;
        }
        h2.style.top = parseInt(h2.style.top) + 1 + "%";
        h2.style.height = parseInt(h2.style.height) - 1 + "%";
    }
};​ 
```

[自己试试](http://jsfiddle.net/rockinthesixstring/QtNXH/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:30:48.003

正如评论部分中的其他建议一样，您最好在性能方面拥有更好的表现..如果只是幻灯片动画..你应该坚持你所拥有的..

然而你真正想要的是`slideDown animation + hide effect`. 通常 slideDown 动画是显示元素..所以你需要做一些小技巧来让它工作..见下文，

**CSS：**

```
#hider1 { 
   position:fixed; /* Changed style*/
   top: 0px;       
   background: black;
   width:100%;
   height:48%;
   min-height:0px;
   text-align:center;
   color:white; 
}

#hider2 { 
   background-color:black;
   width:100%;
   height:50%;
   text-align:center;
   position:fixed;  /* Changed style*/
   bottom:0;        /* Changed style*/
   color:white; 
} 
```

**JS：**

```
$(function () {
    $('#test').on('click', function () {
        $('#hider1').animate({            
            height: 0,
            opacity: 0.2 //<-- Fancy stuff
         },1000 );

        $('#hider2').animate({            
            height: 0,
            opacity: 0.2 //<-- Fancy stuff
         },1000 );

    });
}); 
```

​<br> **[DEMO](http://jsfiddle.net/U3Lg9/19/)** -> 已在 FF 和 Chrome 中验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:49:12.200

不使用 jQuery 可能已经比使用它更有效。

也许您真正想要更改它的原因是对动画有更多的控制（例如，对动画的速度或缓动）。如果是这种情况，试试这个：

[http://jsfiddle.net/U3Lg9/13/](http://jsfiddle.net/U3Lg9/13/)

# android - 设置多个 SharedPreferences 实例/文件的默认值

> ID：10727964
> 
> 赞同：21
> 
> 时间：2012-05-23T21:16:05.133
> 
> 标签：android, android-activity, sharedpreferences, android-preferences, preferenceactivity

假设我有一个将首选项保存到两个文件的应用程序，*preferences1.xml*和*preferences2.xml*。然后，我可以使用以下代码检索对相应对象的引用：

```
SharedPreferences sharedPrefs1 = getSharedPreferences("preferences1", MODE_PRIVATE);
SharedPreferences sharedPrefs2 = getSharedPreferences("preferences2", MODE_PRIVATE); 
```

通过这种方式，我可以操纵两者的偏好并注册监听器以进行两者的更改。

*我对使用setDefaultValues*初始化这两个文件有一些疑问：

**问题 1 - PreferenceFragment 上下文**：我创建了一个带有两个*PreferenceFragment的**PreferenceActivity*，并在每个 PreferenceFragment 的*onCreate*方法中执行以下代码（将片段 1 和 2 的 X 替换为 1 和 2）：

```
PreferenceManager pm = getPreferenceManager();
pm.setSharedPreferencesName("preferencesX");

PreferenceManager.setDefaultValues(getActivity(),R.xml.preference_fragmentX, false); 
```

我已经看到两个片段在启动时都使用默认值正确设置了它们的首选项。但是，鉴于我只能在应用程序的**shared_prefs目录中看到一个****_has_set_default_values.xml**文件，它如何理解什么时候的属性已经设置了*preferences1.xml*和*preferences2.xml ？*只要在第一个打开的*PreferenceFragment中调用**setDefaultValues*就会创建此文件，但即使在此之后，如果我打开第二个*PreferenceFragment*它会正确初始化默认值。怎么理解还没有初始化*preferences2.xml*，目的是什么**********_has_set_default_values.xml**鉴于它不包含有关哪些首选项文件已被初始化的信息？********

 *******问题 2 - 标准活动上下文**：当我启动我的应用程序时，*PreferenceActivity*不是第一个启动的活动，用户可能永远不会打开它，所以我想在主*Activity*中使用它们的默认值初始化两个首选项文件，我怎样才能做到这一点？对于默认共享首选项，这很容易：

```
PreferenceManager.setDefaultValues(this, R.xml.default_preferences, false); 
```

对于两个首选项文件我应该怎么做？我无法执行以下操作，因为我无法像*PreferenceFragment类中那样检索**PreferenceManager*的实例：

 *```
PreferenceManager pm = getPreferenceManager(); // NOT AVAILABLE AND NOT WANTED
pm.setSharedPreferencesName("preferences1");
PreferenceManager.setDefaultValues(getActivity(),R.xml.preference_fragment1, false);

PreferenceManager pm = getPreferenceManager(); // NOT AVAILABLE AND NOT WANTED
pm.setSharedPreferencesName("preferences2");            
PreferenceManager.setDefaultValues(getActivity(),R.xml.preference_fragment2, false); 
```

在主 Activity 中，我不需要更改*PreferenceManager*将在其上工作的首选项文件，因为我们不在*PreferenceActivity*中，我只是想初始化这两个文件......有什么帮助吗？我希望我已经发布了一个明确的问题，即使太长了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-22T13:22:03.030

您可以像这样创建首选项：

```
public class MyPreference {

    private static final String APP_SHARED_PREFS1 = "myPrefc1"; 
    private static final String APP_SHARED_PREFS2 = "myPrefc2"; 
    private SharedPreferences   appSharedPrefs1;
    private SharedPreferences   appSharedPrefs2;
    private Editor              prefsEditor1;
    private Editor              prefsEditor2;

    public MyPreference(Context context) {
        this.appSharedPrefs1 = context.getSharedPreferences(APP_SHARED_PREFS1, Activity.MODE_PRIVATE);
        this.appSharedPrefs2 = context.getSharedPreferences(APP_SHARED_PREFS2, Activity.MODE_PRIVATE);
        this.prefsEditor1 = appSharedPrefs1.edit();
        this.prefsEditor2 = appSharedPrefs2.edit();
    }

 public void saveServices(String servicName, boolean isActivated) {
        prefsEditor1.putBoolean(servicName, isActivated);
        prefsEditor1.commit();
        prefsEditor2.putBoolean(servicName, isActivated);
        prefsEditor2.commit();
    } 
```

在您的保存服务或您想根据自己的喜好做的其他事情上，数据将保存在两个文件中。

对于你的第二个问题：

创建一个 Global 类`G`

然后像这样声明您的偏好：

```
public class G extends Application{

    public static Activity currentActivity = null;
    public static MyPreference myAppPref = null;

    @Override
    public void onCreate() {

        super.onCreate();

         myAppPref = new MyPreference(G.this);

    }

} 
```

当您的主要活动运行时，您应该这样做：

```
G.currentActivity = MainActivity.this;
G. myAppPref.saveServices("testpref", true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-03T19:26:16.787

**对于问题 1**

我相信**_has_set_default_values.xml**文件只是另一个首选项文件......它在其中存储键/值对，键是首选项文件的名称，值是是否已设置默认值。

**对于问题 2**

为什么不使用采用共享首选项文件名称的**PreferenceManager.setDefaultValues()版本？**这是方法签名：

```
public static void setDefaultValues (Context context, String sharedPreferencesName, int sharedPreferencesMode, int resId, boolean readAgain) 
```

[http://developer.android.com/reference/android/preference/PreferenceManager.html](http://developer.android.com/reference/android/preference/PreferenceManager.html)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-16T03:49:32.117

1）我猜这些默认值只有在使用 getDefaultSharedPreferences() 方法时才会被加载，如果你提供自己的首选项文件，它们将被忽略。不太确定这一点。

2）您可以在应用程序子类上设置它们。

[http://developer.android.com/reference/android/app/Application.html](http://developer.android.com/reference/android/app/Application.html)

Application.onCreate 是用户启动您的应用程序时要执行的第一件事。它是应用程序的单一入口点，因此是初始化应用程序在系统范围内所需的所有数据的好地方。

由于 Application 扩展了 ContextWrapper，因此您可以通过 getSharedPreferences(file, mode) 方法访问 SharedPreferences。您可以使用它来检索您的两个首选项文件。******

# biztalk - 如果 MSH-7（消息的日期/时间）指定为毫秒，Biztalk 2009 无法解析消息

> ID：10727972
> 
> 赞同：2
> 
> 时间：2012-05-23T21:16:28.580
> 
> 标签：biztalk, hl7, biztalk-2009

我有一个标准的双向接口，使用 biztalk 2009 作为我们的接口引擎。正在发生的事情是，我们收到的订单消息解析得很好，除了它们发送的日期时间以 MSH.7 为毫秒。3 个额外的数字会导致它因数据类型错误而失败。如果我删除 MSH.7 中的 3 个额外数字，则消息将正常处理。

为了增加一层复杂性，我发现了这篇文章：[http](http://social.msdn.microsoft.com/Forums/en-US/biztalkgeneral/thread/d65bf4de-a3dd-47f3-babe-a82bdc260291/) ://social.msdn.microsoft.com/Forums/en-US/biztalkgeneral/thread/d65bf4de-a3dd-47f3-babe-a82bdc260291/描述了这个问题并提出了建议我可以更改 MSH 架构以修复它。我这样做了，它确实可以在我可以处理消息以及返回结果消息的地方工作，而且看起来一切正常。但是，当尝试生成 ACK 时，它会完全失败。我认为批处理可能存在类似的问题，但我没有做到这一点。通过更改 MSH 模式，内置的 ACK 功能不再起作用，因为 MSH 标头具有意外的形式（我认为）。

我开始没有想法了，我想我会尝试在这里发帖，因为我在旅行中在这里找到了很多答案。最奇怪的部分是 MSH.7 被定义为 MSH 模式中的字符串，因此它们在该字段中传递的内容似乎无关紧要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-29T19:05:39.787

您可以将代码添加到转换并删除有问题的毫秒，而不是更改架构。在处理时间戳/日期时，这种情况经常发生。

# html - iframe 替代方案？

> ID：10727973
> 
> 赞同：0
> 
> 时间：2012-05-23T21:16:37.430
> 
> 标签：html, iframe

我只是想知道是否有 Iframe 替代方案。我尝试将 a`div`与以下 CSS 一起使用：

```
div {
    width: 400px;
    height: 400px;
    overflow: auto;
} 
```

和`div`：

```
<div>
    <?php
        include "http://mydomainhere.com";
    ?>
</div> 
```

但似乎我只能使用`include()`. 我可以使用域名吗？如果没有，我可以用什么替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:18:31.060

是的，你可以，但它被认为是危险的，默认情况下被禁用。

[http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-include](http://www.php.net/manual/en/filesystem.configuration.php#ini.allow-url-include)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T08:18:06.573

如果您想让文件的内容显示在该部分中。

尝试：

`<div> <?php echo file_get_contents("http://mydomainhere.com"); ?> </div>`

# .net - 如何在自己的应用程序逻辑中使用实体框架流式 API 配置？

> ID：10727978
> 
> 赞同：1
> 
> 时间：2012-05-23T21:16:47.943
> 
> 标签：.net, entity-framework, poco, or-mapper

我使用 EF fluent API 将我的 POCO 类映射到数据库表。我需要在我自己的应用程序逻辑中使用映射配置。更具体地说，假设我有实体“产品”，并且该实体具有以下映射：

```
public class ProductMap : EntityTypeConfiguration<Product>
{
    public ProductMap()
    {
        ....
        this.HasKey(t => t.ProductId);
        ...
    }
} 
```

在我的应用程序逻辑中，我想编写一个通用方法来获取我的实体的关键字段（此处为 ProductId）。如果我使用了数据注释属性，我可以使用反射找到我的关键属性。我的问题是，当我使用 fluent API 定义映射时，基本上可以实现相同的目标吗？

* * *

谢谢帝豪。我确实来到了您建议的解决方案，但它仍然不是一个好的解决方案，因为实体框架不允许我们使用不是纯实体字段的字段进行查询。举个例子：我想写一个泛型方法，它根据它的 id 返回一个实体。我得出以下解决方案：

```
public TModel GetById<TModel, TKey>(TKey id) where TModel : ModelBase<TKey>
{
    return _context.Set<TModel>().where(e => e.Id == id).FirstOrDefault();
} 
```

但是，此代码不起作用，因为实体框架抱怨它`e.Id`不是驱动实体类的字段（它是父类的字段）。当然，可以通过转换`Set<TModel>()`为列表（如下所示）来强制提前执行查询来解决此问题。但这在性能方面很糟糕，因为它将所有实体加载到内存中以检索单个实体。

```
public TModel GetById<TModel, TKey>(TKey id) where TModel : ModelBase<TKey>
{
    return _context.Set<TModel>().ToList().where(e => e.Id == id).FirstOrDefault();
} 
```

您对这种情况有更好的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:58:56.490

我们遇到了类似的情况。我们无法找到一个很好的解决方案，所以我很想听听反馈。我们的解决方案是创建一个抽象`ModelBase`类，它有两个对我们所有模型都“通用”的字段：

```
public abstract class ModelBase<T>
{
    /// <summary>
    /// The id of the model object
    /// </summary>
    public virtual T Id { get; set; }

    /// <summary>
    /// The date the model object was created
    /// </summary>
    public virtual DateTime CreateDate { get; set; }
} 
```

然后，我们将让所有模型都继承自该类：

```
public class Product : ModelBase<int>
{
    public override int Id
    {
        get { return ProductId; }
        set { ProductId = value; }
    }

    public int ProductId { get; set; }
    ...
} 
```

这样，您始终知道实体的关键字段。注意事项：您将设置 EF 数据库映射以忽略该`Id`属性

# c++ - 是否可以使用 gtkmm 定义 GTK+ 类型？

> ID：10727979
> 
> 赞同：1
> 
> 时间：2012-05-23T21:16:50.170
> 
> 标签：c++, gtk, glib, gtkmm

我想定义一些 gtkmm 类型的新子类，实现底层 GTK+ 对象的接口。然后，我想将它编译成某种 dll 并通过这个接口在纯 C 代码（GTK+，没有 gtkmm）中使用。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:56:22.390

在*GTK+中使用**gtkmm*小部件需要以下条件：

 *1.  *在gtkmm*中实现所需的自定义小部件
**   *从小部件为Glade*创建一个库**   *使用Glade*设计包含自定义小部件的用户界面**   *为用GTK+*编写的应用程序声明*C接口***   从 XML 构建用户界面`GtkBuilder`****

 ***详细信息可以在我的[博文](http://szilard.blogs.balabit.com/en/2013/02/how-to-use-gtkmm-custom-widget-in-gtk/)中找到。****

# hibernate - 使用 Hibernate 4 在运行时提供连接信息

> ID：10727982
> 
> 赞同：1
> 
> 时间：2012-05-23T21:17:05.857
> 
> 标签：hibernate, connection, runtime, multi-tenant

开发基于单数据库/多模式的多租户应用程序。有一个共同的模式，因为租户之间共享数据，此外每个租户都有一个单独的模式用于他们的私有数据。身份验证数据（用户 ID/密码/租户 ID）保存在我们在登录期间访问的通用模式中。一旦通过身份验证，每个租户都有一个唯一的用户 ID/密码登录，有权访问公共架构和租户架构。“租户用户 id/pwd”将作为加密安全令牌的一部分返回给客户端（无状态），并在随后的 web 或 rest 调用中传回。

我们使用 Spring、Hibernate 4 和 C3PO 进行池化。经过大量阅读/搜索，我相信这是可能的，但没有找到任何例子。在随后的休息调用中，从客户端提供的安全令牌中提取用户标识/密码后，我想将这些传递给休眠以建立与数据库的连接，或者使用具有相同用户标识/密码的现有连接（如果连接中存在）水池。目前我们只是将数据源连接到实体工厂，如下所示。对 java、hibernate、spring 等非常陌生，但已经花费了数小时搜索，此时需要指出正确的方向。

```
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
    destroy-method="close">
    <property name="driverClass" value="${jdbc.connection.driver}" />
    <property name="jdbcUrl" value="${jdbc.connection.url}" />
    <property name="user" value="${jdbc.connection.username}" />
    <property name="password" value="${jdbc.connection.password}" />
    <property name="minPoolSize" value="1" />
    <property name="maxPoolSize" value="30" />
    <property name="acquireIncrement" value="5" />
    <property name="idleConnectionTestPeriod" value="300" />
    <property name="maxIdleTime" value="300" />
    <property name="maxStatements" value="0" />
</bean>

<bean id="entityManagerFactory"
    class="org.springframework.o1rm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="persistenceUnitName" value="jobmanagement" />
    <property name=""></property>
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T20:50:19.643

只是在黑暗中开枪：

```
Configuration cfg = new Configuration();
cfg.configure(CONFIG_FILE_LOCATION);
cfg.setProperty("hibernate.connection.datasource","java:/SomeDatabase_MySQLDS");
ServiceRegistry serviceRegistry = new ServiceRegistryBuilder()
    .applySettings(cfg.getProperties())
    .buildServiceRegistry();        
SessionFactory sessionFactory = cfg.buildSessionFactory(serviceRegistry); 
```

您可以将所有常量属性设置为 hibernate.cfg 并在运行时添加其余属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-30T11:42:40.620

相反，您可以使用 MultiTenantConnectionProvider 进行配置，并在创建休眠会话以触发数据库查询时在运行时返回数据源连接。

可以这样配置：

[休眠中的多租户数据库](https://stackoverflow.com/questions/26233778/multitenant-database-in-hibernate)

# shiro - shiro 将我重定向回 l ogin.jsp

> ID：10727987
> 
> 赞同：3
> 
> 时间：2012-05-23T21:17:42.107
> 
> 标签：shiro

只是想将 apache shiro 与另一个应用程序集成。但是 shiro 没有进行身份验证并将我重定向回 l​​ogin.jsp。以下是解释

我用 apache shiro 创建了一个测试应用程序，它使用 jdbcrealm 并且工作正常。重定向到登录页面和成功的身份验证正在发生。下面是shiro.ini

```
[main]
authc.loginUrl = /login.jsp
authc.usernameParam = user
authc.passwordParam = pass
authc.rememberMeParam = remember
authc.successUrl  = /p/explorer

jdbcRealm = org.apache.shiro.realm.jdbc.JdbcRealm
jdbcRealm.permissionsLookupEnabled = true
jdbcRealm.authenticationQuery = select PWD_ as password from act_id_user where ID_ = ?
jdbcRealm.userRolesQuery = select GROUP_ID_ as role_name from act_id_membership where USER_ID_ = ?
jdbcRealm.permissionsQuery = select permission from roles_permissions where GROUP_ID_ = ?

ds = org.apache.commons.dbcp.BasicDataSource
ds.url = jdbc:mysql://localhost:3306/activiti
ds.driverClassName = com.mysql.jdbc.Driver
ds.username=user
ds.password=pass
ds.maxActive = 3

securityManager.realms = $jdbcRealm
cacheManager = org.apache.shiro.cache.ehcache.EhCacheManager
securityManager.cacheManager = $cacheManager

jdbcRealm.dataSource = $ds

sha256Matcher = org.apache.shiro.authc.credential.HashedCredentialsMatcher
sha256Matcher.hashAlgorithmName=SHA-256
jdbcRealm.credentialsMatcher = $sha256Matcher

[urls]
# enable authc filter for all application pages
/p/**=authc 
```

请注意上述配置在我的测试应用程序中运行（使用 mvn jetty:run 运行）。

然后，我将相同的配置、login.jsp 和过滤器设置从 web.xml 复制到另一个应用程序（即 signavio activiti-modeler），在访问 URL 时，它会将我重定向到登录页面，但提交不会导致异常和/或日志中的错误，但仍然将我重定向回 l​​ogin.jsp。这是 web.xml（shiro 是过滤器链中的第一个过滤器）

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
id="WebApp_ID" version="2.5">
<display-name>Signavio Platform</display-name>

<distributable />

<context-param>
    <description>Define a reg exp for all user agents which are supported for the editor</description>
    <param-name>supportedBrowserEditor</param-name>
    <param-value>Firefox[\/\s]((3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20)\.\d+)|AppleWebKit|Opera.9\.\d+</param-value>
</context-param>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
</context-param>
<!-- To load the Spring context -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!--FILTER -->
<filter>
    <filter-name>ShiroFilter</filter-name>
    <filter-class>org.apache.shiro.web.servlet.IniShiroFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>ShiroFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

    <filter>
        <filter-name>RequestExceptionFilter</filter-name>
        <filter-class>com.signavio.platform.filters.RequestExceptionFilter</filter-class>
    </filter>

    <filter>
        <filter-name>HandlerFilter</filter-name>
        <filter-class>com.signavio.platform.filters.HandlerFilter</filter-class>
    </filter>

    <filter>
        <filter-name>EncodingFilter</filter-name>
        <filter-class>com.signavio.platform.filters.EncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>
                UTF-8
            </param-value>
        </init-param>
    </filter>

    <filter>
        <filter-name>AuthenticationFilter</filter-name>
        <filter-class>com.signavio.platform.filters.AuthenticationFilter</filter-class>
        <init-param>
            <description></description>
            <param-name>requiresNoAuthorization</param-name>
            <param-value>
            </param-value>
        </init-param>
    </filter>

    <filter>
        <filter-name>ParseParametersFilter</filter-name>
        <filter-class>com.signavio.platform.filters.ParseParametersFilter</filter-class>
    </filter>

    <!--FILTER MAPPING -->

    <filter-mapping>
        <filter-name>RequestExceptionFilter</filter-name>
        <url-pattern>
            /p/*
        </url-pattern>
    </filter-mapping>

    <filter-mapping>
        <filter-name>HandlerFilter</filter-name>
        <url-pattern>
            /p/*
        </url-pattern>
    </filter-mapping>

    <filter-mapping>
        <filter-name>EncodingFilter</filter-name>
        <url-pattern>
            /p/*
        </url-pattern>
    </filter-mapping>

    <filter-mapping>
        <filter-name>AuthenticationFilter</filter-name>
        <url-pattern>
            /p/*
        </url-pattern>
    </filter-mapping>

    <filter-mapping>
        <filter-name>ParseParametersFilter</filter-name>
        <url-pattern>
            /p/*
        </url-pattern>
    </filter-mapping>

    <!--SERVLETS -->
    <servlet>
        <display-name>Dispatcher</display-name>
        <servlet-name>Dispatcher</servlet-name>
        <servlet-class>com.signavio.platform.servlets.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <!--SERVLET MAPPING -->
    <servlet-mapping>
        <servlet-name>Dispatcher</servlet-name>
        <url-pattern>
            /p/*
        </url-pattern>
    </servlet-mapping>

    <!--LISTENER -->
    <listener>
        <listener-class>com.signavio.platform.listeners.EntryPoint</listener-class>
    </listener>

    <!--SESSION CONFIG -->
    <session-config>
        <session-timeout>1440</session-timeout>
    </session-config>

    <!--ERROR PAGES -->

    <!--MIME MAPPING -->
    <mime-mapping>
        <extension>svg</extension>
        <mime-type>image/svg+xml</mime-type>
    </mime-mapping>
    <mime-mapping>
        <extension>json</extension>
        <mime-type>text/plain</mime-type>
    </mime-mapping>
    <mime-mapping>
        <extension>css</extension>
        <mime-type>text/css</mime-type>
    </mime-mapping>
    <mime-mapping>
        <extension>ico</extension>
        <mime-type>image/x-icon</mime-type>
    </mime-mapping>

    <security-role>
        <role-name>admin</role-name>
    </security-role>

    <!--WELCOME FILE LIST -->
    <welcome-file-list>
        <welcome-file>welcome</welcome-file>
    </welcome-file-list>

    <!-- Servlets from the Oryx Editor -->
    <servlet>
        <display-name>BPMN Layouter</display-name>
        <servlet-name>BPMNLayouterServlet</servlet-name>
        <servlet-class>org.oryxeditor.server.BPMNLayouterServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>BPMN2BPEL Servlet</display-name>
        <servlet-name>BPMN2BPELServlet</servlet-name>
        <servlet-class>org.oryxeditor.server.BPMN2BPELServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>Step Through</display-name>
        <servlet-name>StepThrough</servlet-name>
        <servlet-class>de.hpi.diagram.stepthrough.StepThroughServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>XForms Export</display-name>
        <servlet-name>XFormsExportServlet</servlet-name>
        <servlet-class>org.oryxeditor.server.XFormsExportServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>XForms Import</display-name>
        <servlet-name>XFormsImportServlet</servlet-name>
        <servlet-class>org.oryxeditor.server.XFormsImportServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>Oryx Legacy File Download Servlet</display-name>
        <servlet-name>DownloadServlet</servlet-name>
        <servlet-class>
            org.oryxeditor.server.MultiDownloader
        </servlet-class>
    </servlet>

    <servlet>
        <display-name>Alternatives Renderer</display-name>
        <servlet-name>AlternativesRenderer</servlet-name>
        <servlet-class>org.oryxeditor.server.AlternativesRenderer</servlet-class>
    </servlet>

    <servlet>
        <display-name>Oryx syntax checker</display-name>
        <servlet-name>SyntaxChecker</servlet-name>
        <servlet-class>org.oryxeditor.server.SyntaxCheckerServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>Oryx Validator</display-name>
        <servlet-name>Validator</servlet-name>
        <servlet-class>org.oryxeditor.server.ValidatorServlet</servlet-class>
    </servlet>

    <servlet>
        <display-name>RDF 2 JSON Servlet</display-name>
        <servlet-name>RDF2JSONServlet</servlet-name>
        <servlet-class>org.oryxeditor.server.RDF2JSONServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>BPMNLayouterServlet</servlet-name>
        <url-pattern>/editor/bpmnlayouter</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>BPMN2BPELServlet</servlet-name>
        <url-pattern>/editor/bpmn2bpel</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>StepThrough</servlet-name>
        <url-pattern>/editor/stepthrough</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>XFormsExportServlet</servlet-name>
        <url-pattern>/editor/xformsexport</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>XFormsImportServlet</servlet-name>
        <url-pattern>/editor/xformsimport</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>SyntaxChecker</servlet-name>
        <url-pattern>/editor/syntaxchecker</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>Validator</servlet-name>
        <url-pattern>/editor/validator</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>DownloadServlet</servlet-name>
        <url-pattern>/editor/download</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>AlternativesRenderer</servlet-name>
        <url-pattern>/editor/pdf</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>RDF2JSONServlet</servlet-name>
        <url-pattern>/editor/rdf2json</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>index.html</welcome-file>
    </welcome-file-list>
</web-app> 
```

请再次注意，此设置工作简单/测试 web 应用程序我的疑问是.. 客户端/服务器重定向和/或过滤器链序列。

提前致谢。

# jquery - 在 jquery.ajaxStart 中将所有按钮更改为“工作”，然后在 jquery.ajaxStop 中更改为“保存”

> ID：10727989
> 
> 赞同：0
> 
> 时间：2012-05-23T21:17:48.157
> 
> 标签：jquery

当处理 ajax 请求时，我想将按钮（实际上是 div）上的文本更改为“正在工作”。我还想禁止它们再次被点击，直到 ajax 进程结束。如果是，我想启用按钮并将文本更改回“保存”。

我正在考虑使用 JQuery .ajaxStart() 和 .ajaxStop() 全局事件来处理这个问题。像这样的东西：

```
$(document).ajaxStart(function () {
    $('#btnSave').each(function() {
        $(this).data('eventsbackup', $(this).data('events'));
        $(this).data('events', null);
        $(this).html('Working...');
    });
});

$(document).ajaxStop(function() {
    $('#btnSave').each(function () {
        $(this).html('Save');
        $(this).data('events', $(this).data('eventsbackup'));
        $(this).data('eventsbackup', null);
    });
}); 
```

你觉得这种方法有什么问题吗？我有点担心将 .data('event') 设置为 null 而不是使用 unbind()，但我无法确定按钮绑定了多少事件。这种方法会导致问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T21:23:06.710

我看到一个大问题，您使用**的是 ID**而不是**类**，所以只有**FIRST**按钮可能会受到影响。

将按钮更改为使用类，然后将 jQuery 更改为`$(".buttons").each()`

至于启用/禁用按钮，为什么不在按钮上使用`is-disabled`数据属性并在点击功能中对其进行测试。像这样的东西

```
<a href="#" id="get-files" class="button">Get Files</a>
<a href="#" id="get-folders" class="button">Get Folders</a> 
```

**示例点击代码**

```
$("#get-files").click(function(e) {
    var isDisabled = $(this).data("is-disabled");
    if(!isDisabled) {
        // run Ajax Code
    }
}); // Do the same for #get-folders, even better wrap it in a reusable function 
```

**然后用你现有的代码做**

```
$(document).ajaxStart(function () {
    $('.button').each(function() {
        $(this).data("is-disabled", true);
        $(this).html('Working...');
    });
});

$(document).ajaxStop(function() {
    $('.button').each(function () {
        $(this).html('Save');
        $(this).data("is-disabled", false);
    });
}); 
```