# StackOverflow 问答 000638000-000638999

# prolog - 如何从 .plrc 更改 prolog 中的 prompt_alternatives_on 标志？

> ID：638000
> 
> 赞同：0
> 
> 时间：2009-03-12T10:18:40.183
> 
> 标签：prolog

我可以`prompt_alternatives_on`在 REPL 中更改标志。

1.  但是如何在 .plrc 中更改此标志？

然后我得到

```
 permission to modify static_procedure `set_prolog_flag/2' 
```

目标：不要得到“更多？” 始终为所有答案提供文本。通过更改标志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T14:12:20.963

将 :- （冒号和连字符）放在该行的前面以在文件加载时执行它。

```
:- set_prolog_flag(key, value). 
```

对于您希望在加载文件时评估的任何源文件中的任何代码行都是如此，而不是将其视为新的事实或规则（这会导致错误，因为它试图重新定义 set_prolog_flag/2）。

# c# - 如何从孩子那里获得父母收藏的数量？

> ID：638006
> 
> 赞同：0
> 
> 时间：2009-03-12T10:20:49.180
> 
> 标签：c#, silverlight

我有一个 ObservableCollection 分配给列表框的 ItemsSource。Listbox 正在使用一个 DataTemplate，其中有一个用户控件，其中包含绑定到每个 listboxitem 属性的项目。

我在用户控件上有一个向上和向下按钮，可以在列表中向上或向下移动项目。该列表按我正在更改的属性排序。点击向上或向下，DisplayOrder 属性发生变化，我使用 INotifyProperty 告诉 ObservableCollection 它需要重新排序。

用户控件获取项目计数的最佳方法是什么，以便在项目到达列表底部时禁用向下按钮。（顶部很简单，我比较为0）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T14:26:06.017

listBox1.Items.Count ？this.Parent.Controls.Count?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T22:09:05.087

我看到了两种处理方法。

第一个是将您的集合的句柄传递给您的每个项目（当它们被添加到集合中时），以便他们可以计算它们本身是第一个还是最后一个项目。

另一种是在您的项目上公开可写属性，例如`CanGoUp`and `CanGoDown`，您的父控件将负责正确设置这些属性。我更喜欢这种解决方案，因为它将父列表的行为与子项分离。即使向上/向下按钮放置在您的子项目上，它实际上是父列表的功能。

# php - php中的日期格式

> ID：638011
> 
> 赞同：2
> 
> 时间：2009-03-12T10:22:10.330
> 
> 标签：php, date

我有一个字符串，如下所述：

```
$ts  = "3/11/09 11:18:59 AM"; 
```

我使用该`date()`功能。

现在我需要将其转换为如下所示的可读格式

```
11-Mar-2009 
```

我已经尝试了所有使用`date()`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T10:26:19.760

您需要将其转换为可用于进一步格式化的内容。[strtotime()](http://de.php.net/manual/en/function.strtotime.php)是一个好的开始，它会产生一个 unix 时间戳。然后，您可以使用[strftime()](http://de.php.net/manual/en/function.strftime.php)格式化该格式。

```
strftime("%d-%b-%G", strtotime($ts)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:28:45.400

如果您最初从 date() 函数获取字符串，则将格式参数传递给 date-function：

日期（'Ymd'）

而不是再次转换字符串。

编辑：如果您需要跟踪实际时间戳，则将其存储为时间戳：

```

// 将时间戳存储在变量中。这只是一个整数，unix 时间戳（自纪元以来的秒数）
$时间=时间（）；

// 输出 ISO8601（可能插入数据库？随便）
echo date('Ymd H:i', $time);

// 输出你的可读格式
回显日期（'jMY'，$time）；

```

使用 strtotime() 很方便，但对时间表示的不必要的解析和存储是一个愚蠢的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T10:47:11.113

实际上我尝试这样做并且它有效。

```
echo date("d-M-Y", strtotime($ts)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T10:32:19.980

您可以使用 date() 函数直接生成所需的格式，如下所示：

```
date("j-M-Y"); 
```

有关 date() 函数输出的所有可能格式，请参见[www.php.net/date](http://www.php.net/date)。

# c++ - 基于许可证管理 C++ 应用程序的功能

> ID：638012
> 
> 赞同：8
> 
> 时间：2009-03-12T10:22:19.240
> 
> 标签：c++, networking, licensing, trialware

我们正在尝试为我们的 Linux 应用程序正在运行的每个功能提供许可机制，并且我们正在考虑使用许可服务器以集中方式控制它：

我们的许可目标是：

1.  拒绝运营商未购买的功能。
2.  提供试用（如果未购买，功能将过期）。
3.  在一段时间内激活功能，并使其仅在一段时间内可用。

是否有任何服务器许可证允许我们这样做（基本上，我们将使用套接字与我们的应用程序通信）？我们还能做些什么（例如，使用一些开源软件、阅读等）来入门？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T10:53:57.337

如果您真的想使用许可证服务器，请确保您的应用程序不必一直联系它来授权使用 - 当人们失去 Internet 连接或您的服务器出现故障或崩溃时，这将导致无穷无尽的问题。

我建议在本地下载和存储密钥，从而减少到服务器的往返次数。可以根据用户的机器详细信息对密钥进行加密，从而使密钥无法共享。

我们过去使用过[HASP](http://en.wikipedia.org/wiki/Aladdin_Knowledge_Systems#DRM)硬件密钥，虽然它们确实可以工作并提供解决方案，但我认为它们不是您想要的，因为它们被编程一次，仅此而已。例如，您将无法更新 HASP 密钥以结束试用期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T23:18:50.467

你真的需要“打电话回家”吗？

我见过一个相对轻松的许可证系统，通过它向用户提供了一个 XML 文件，该文件描述了许可证的有效期、一个可选的 IP 地址以及“解锁”功能的列表。使用供应商的私钥生成了一个数字签名，该私钥被重新插入到许可证文件中。启动时，应用程序正在读取许可证、验证许可证、检查 IP 并相应地解锁功能。

供应商可以在需要时向客户提供更新的许可证。

虽然理论上你可以通过更改机器的本地时间和伪造 IP 地址来欺骗许可证，但在这种情况下，这会使应用程序使用起来非常麻烦，所以这不是问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T12:50:33.937

有时软件确实需要保护——[在这里](http://www.aladdin.com/hasp/default.aspx)查看这些人——他们提供硬件和软件解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T12:29:23.237

[FLEXnet](http://www.acresso.com/solutions/flexnet-suite-software-producers.htm)（以前称为 FLEXlm）是一种许可包，通常由高端或专用软件包使用，例如在电子设计自动化市场中。您可以将许可证锁定到单台机器（通过 hostid，通常是以太网 MAC 地址）或便携式硬件加密狗，或者让网络服务器处理与运行您的软件的客户端共享有限的并发许可证池。许可证可以在有限的时间内或永久地授予，也可以受版本号的限制。许可证文件描述了许可的功能。

FLEXnet 包含多个用于与您的应用程序集成的 API，其中一个用于 C++。我想它使用某种公钥密码术。通常，使用 FLEXnet 的应用程序仅在您通过使用 API 要求它时“打电话回家”。许多应用程序在启动时检查一次许可证，或者在应用程序运行期间从池中保留许可证。

当然，您需要支付年度许可费才能在您的产品中使用 FLEXnet，起价超过 1000 美元。费用因贵公司的收入以及您希望许可方案能够运行的平台数量（操作系统/CPU 组合）而异。

如果您的产品每个座位的售价低于几千美元，我会说使用 FLEXnet 之类的东西是不值得的。使用起来很麻烦（我们公司的很大一部分支持电话的来源），但企业客户可能已经熟悉使用它，具体取决于市场。

FLEXnet，就像我听说过的所有 DRM 方案一样，很容易被破解。至少我认为是这样，因为我们的产品的解锁版本经常在warez网站上找到。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T10:46:03.270

这是一种[呆伯特式](http://en.wikipedia.org/wiki/Dilbert)的做事方式。拒绝吧。

虽然讨厌，但这是高端专业软件的标准功能，需要花费数万美元。想想 3D 扫描仪和[CNC](http://en.wikipedia.org/wiki/Numerical_control)的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T12:05:50.563

如果您确实打算自己编写代码，我见过的一种常见机制是将许可证绑定到[MAC 地址](http://en.wikipedia.org/wiki/MAC_address)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T03:46:01.777

一种常见的许可软件是[flexlm](http://en.wikipedia.org/wiki/Flexlm)。但是，如果我将这些限制强加给我的用户，我会三思而后行。许多用户不喜欢它们；特别是来自 FOSS/Linux 环境。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T10:25:36.483

使用过各种使用此类许可证服务器的软件包后，我可以告诉您，这是让您的软件受到用户普遍憎恨的一种可靠方法。

# algorithm - How to calculate or approximate the median of a list without storing the list

> ID：638030
> 
> 赞同：48
> 
> 时间：2009-03-12T10:28:59.970
> 
> 标签：algorithm, optimization, median

I'm trying to calculate the median of a set of values, but I don't want to store all the values as that could blow memory requirements. Is there a way of calculating or approximating the median without storing and sorting all the individual values?

Ideally I would like to write my code a bit like the following

```
var medianCalculator = new MedianCalculator();
foreach (var value in SourceData)
{
  medianCalculator.Add(value);
}
Console.WriteLine("The median is: {0}", medianCalculator.Median); 
```

All I need is the actual MedianCalculator code!

**Update:** Some people have asked if the values I'm trying to calculate the median for have known properties. The answer is yes. One value is in 0.5 increments from about -25 to -0.5\. The other is also in 0.5 increments from -120 to -60\. I guess this means I can use some form of histogram for each value.

Thanks

Nick

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-12T10:38:25.597

If the values are discrete and the number of distinct values isn't too high, you could just accumulate the number of times each value occurs in a histogram, then find the median from the histogram counts (just add up counts from the top and bottom of the histogram until you reach the middle). Or if they're continuous values, you could distribute them into bins - that wouldn't tell you the exact median but it would give you a range, and if you need to know more precisely you could iterate over the list again, examining only the elements in the central bin.

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-04-08T10:57:55.927

There is the 'remedian' statistic. It works by first setting up k arrays, each of length b. Data values are fed in to the first array and, when this is full, the median is calculated and stored in the first pos of the next array, after which the first array is re-used. When the second array is full the median of its values is stored in the first pos of the third array, etc. etc. You get the idea :)

It's simple and pretty robust. The reference is here...

[http://web.ipac.caltech.edu/staff/fmasci/home/astro_refs/Remedian.pdf](http://web.ipac.caltech.edu/staff/fmasci/home/astro_refs/Remedian.pdf)

Hope this helps

Michael

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-01-27T20:15:06.593

I use these incremental/recursive mean and median estimators, which both use constant storage:

```
mean += eta * (sample - mean)
median += eta * sgn(sample - median) 
```

where *eta* is a small learning rate parameter (e.g. 0.001), and *sgn*() is the signum function which returns one of {-1, 0, 1}. (Use a constant *eta* if the data is non-stationary and you want to track changes over time; otherwise, for stationary sources you can use something like *eta*=1/n for the mean estimator, where n is the number of samples seen so far... unfortunately, this does not appear to work for the median estimator.)

This type of incremental mean estimator seems to be used all over the place, e.g. in unsupervised neural network learning rules, but the median version seems much less common, despite its benefits (robustness to outliers). It seems that the median version could be used as a replacement for the mean estimator in many applications.

Also, I modified the incremental median estimator to estimate arbitrary quantiles. In general, a [quantile function](https://en.wikipedia.org/wiki/Quantile_function) tells you the value that divides the data into two fractions: p and 1-p. The following estimates this value incrementally:

```
quantile += eta * (sgn(sample - quantile) + 2.0 * p - 1.0) 
```

The value p should be within [0,1]. This essentially shifts the *sgn*() function's symmetrical output {-1,0,1} to lean toward one side, partitioning the data samples into two unequally-sized bins (fractions p and 1-p of the data are less than/greater than the quantile estimate, respectively). Note that for p=0.5, this reduces to the median estimator.

I would love to see an incremental mode estimator of a similar form...

(Note: I also posted this to a similar topic here: ["On-line" (iterator) algorithms for estimating statistical median, mode, skewness, kurtosis?](https://stackoverflow.com/questions/1058813/on-line-iterator-algorithms-for-estimating-statistical-median-mode-skewness))

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-12T16:26:28.150

Here is a crazy approach that you might try. This is a classical problem in streaming algorithms. The rules are

1.  You have limited memory, say `O(log n)` where `n` is the number of items you want
2.  You can look at each item once and make a decision then and there what to do with it, if you store it, it costs memory, if you throw it away it is gone forever.

The idea for the finding a median is simple. Sample `O(1 / a^2 * log(1 / p)) * log(n)` elements from the list at random, you can do this via reservoir sampling (see a [previous question](https://stackoverflow.com/questions/321637/rosetta-stone-reservoir-random-sampling-algorithm)). Now simply return the median from your sampled elements, using a classical method.

The guarantee is that the index of the item returned will be `(1 +/- a) / 2` with probability at least `1-p`. So there is a probability p of failing, you can choose it by sampling more elements. And it wont return the median or guarantee that the value of the item returned is anywhere close to the median, just that when you sort the list the item returned will be close to the half of the list.

This algorithm uses `O(log n)` additional space and runs in Linear time.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-12T14:52:37.140

This is tricky to get right in general, especially to handle degenerate series that are already sorted, or have a bunch of values at the "start" of the list but the end of the list has values in a different range.

The basic idea of making a histogram is most promising. This lets you accumulate distribution information and answer queries (like median) from it. The median will be approximate since you obviously don't store all values. The storage space is fixed so it will work with whatever length sequence you have.

But you can't just build a histogram from say the first 100 values and use that histogram continually.. the changing data may make that histogram invalid. So you need a dynamic histogram that can change its range and bins on the fly.

Make a structure which has N bins. You'll store the X value of each slot transition (N+1 values total) as well as the population of the bin.

Stream in your data. Record the first N+1 values. If the stream ends before this, great, you have all the values loaded and you can find the exact median and return it. Else use the values to define your first histogram. Just sort the values and use those as bin definitions, each bin having a population of 1\. It's OK to have dupes (0 width bins).

Now stream in new values. For each one, binary search to find the bin it belongs to. In the common case, you just increment the population of that bin and continue. If your sample is beyond the histogram's edges (highest or lowest), just extend the end bin's range to include it. When your stream is done, you find the median sample value by finding the bin which has equal population on both sides of it, and linearly interpolating the remaining bin-width.

But that's not enough.. you still need to ADAPT the histogram to the data as it's being streamed in. When a bin gets over-full, you're losing information about that bin's sub distribution. You can fix this by adapting based on some heuristic... The easiest and most robust one is if a bin reaches some certain threshold population (something like 10*v/N where v=# of values seen so far in the stream, and N is the number of bins), you SPLIT that overfull bin. Add a new value at the midpoint of the bin, give each side half of the original bin's population. But now you have too many bins, so you need to DELETE a bin. A good heuristic for that is to find the bin with the smallest product of population and width. Delete it and merge it with its left or right neighbor (whichever one of the neighbors itself has the smallest product of width and population.). Done! Note that merging or splitting bins loses information, but that's unavoidable.. you only have fixed storage.

This algorithm is nice in that it will deal with **all** types of input streams and give good results. If you have the luxury of choosing sample order, a random sample is best, since that minimizes splits and merges.

The algorithm also allows you to query any percentile, not just median, since you have a complete distribution estimate.

I use this method in my own code in many places, mostly for debugging logs.. where some stats that you're recording have unknown distribution. With this algorithm you don't need to guess ahead of time.

The downside is the unequal bin widths means you have to do a binary search for each sample, so your net algorithm is O(NlogN).

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-12T10:40:46.353

I don't think it is possible to do without having the list in memory. You can obviously approximate with

*   average if you know that the data is symmetrically distributed
*   or calculate a proper median of a small subset of data (that fits in memory) - if you know that your data has the same distribution across the sample (e.g. that the first item has the same distribution as the last one)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-08T12:12:11.380

David's suggestion seems like the most sensible approach for approximating the median.

A running **mean** for the same problem is a much easier to calculate:

> M[n] = M[n-1] + ((V[n] - M[n-1]) / n)
> 
> Where M[n] is the mean of n values, M[n-1] is the previous mean, and V[n] is the new value.

In other words, the new mean is the existing mean plus the difference between the new value and the mean, divided by the number of values.

In code this would look something like:

```
new_mean = prev_mean + ((value - prev_mean) / count) 
```

though obviously you may want to consider language-specific stuff like floating-point rounding errors etc.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-12T13:56:15.387

Find Min and Max of the list containing N items through linear search and name them as HighValue and LowValue Let MedianIndex = (N+1)/2

1st Order Binary Search:

Repeat the following 4 steps until LowValue < HighValue.

1.  Get MedianValue approximately = ( HighValue + LowValue ) / 2

2.  Get NumberOfItemsWhichAreLessThanorEqualToMedianValue = K

3.  is K = MedianIndex, then return MedianValue

4.  is K > MedianIndex ? then HighValue = MedianValue Else LowValue = MedianValue

It will be faster without consuming memory

2nd Order Binary Search:

LowIndex=1 HighIndex=N

Repeat Following 5 Steps until (LowIndex < HighIndex)

1.  Get Approximate DistrbutionPerUnit=(HighValue-LowValue)/(HighIndex-LowIndex)

2.  Get Approximate MedianValue = LowValue + (MedianIndex-LowIndex) * DistributionPerUnit

3.  Get NumberOfItemsWhichAreLessThanorEqualToMedianValue = K

4.  is (K=MedianIndex) ? return MedianValue

5.  is (K > MedianIndex) ? then HighIndex=K and HighValue=MedianValue Else LowIndex=K and LowValue=MedianValue

It will be faster than 1st order without consuming memory

We can also think of fitting HighValue, LowValue and MedianValue with HighIndex, LowIndex and MedianIndex to a Parabola, and can get ThirdOrder Binary Search which will be faster than 2nd order without consuming memory and so on...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-04T12:36:47.447

Usually if the input is within a certain range, say 1 to 1 million, it's easy to create an array of counts: read the code for "quantile" and "ibucket" here: [http://code.google.com/p/ea-utils/source/browse/trunk/clipper/sam-stats.cpp](http://code.google.com/p/ea-utils/source/browse/trunk/clipper/sam-stats.cpp)

This solution can be generalized as an approximation by coercing the input into an integer within some range using a function that you then reverse on the way out: IE: foo.push((int) input/1000000) and quantile(foo)*1000000\.

If your input is an arbitrary double precision number, then you've got to autoscale your histogram as values come in that are out of range (see above).

Or you can use the median-triplets method described in this paper: [http://web.cs.wpi.edu/~hofri/medsel.pdf](http://web.cs.wpi.edu/~hofri/medsel.pdf)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-06T15:52:48.717

I picked up the idea of iterative quantile calculation. It is important to have a good value for starting point and eta, these may come from mean and sigma. So I programmed this:

```
Function QuantileIterative(Var x : Array of Double; n : Integer; p, mean, sigma : Double) : Double;
Var eta, quantile,q1, dq : Double;
    i : Integer;
Begin
  quantile:= mean + 1.25*sigma*(p-0.5);
  q1:=quantile;
  eta:=0.2*sigma/xy(1+n,0.75); // should not be too large! sets accuracy
  For i:=1 to n Do 
     quantile := quantile + eta * (signum_smooth(x[i] - quantile,eta) + 2*p - 1);
  dq:=abs(q1-quantile);
  If dq>eta
     then Begin
          If dq<3*eta then eta:=eta/4;
          For i:=1 to n Do 
             quantile := quantile + eta * (signum_smooth(x[i] - quantile,eta) + 2*p - 1);
     end;
  QuantileIterative:=quantile
end; 
```

As the median for two elements would be the mean, I used a smoothed signum function, and xy() is x^y. Are there ideas to make it better? Of course if we have some more a-priori knowledge we can add code using min and max of the array, skew, etc. For big data you would not use an array perhaps, but for testing it is easier.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-01T22:12:59.973

On homogeneous random ordered and for big enough list, this pseudo code can work:

```
 # find min on the fly
    if minDataPoint > dataPoint:
        minDataPoint = dataPoint  

    # find max on the fly
    if maxDataPoint < dataPoint:
        maxDataPoint = dataPoint

    # estimate median base on the current data
    estimate_mid = (maxDataPoint + minDataPoint) / 2

    #if **new** dataPoint is closer to the mid? stor it
    if abs(midDataPoint - estimate_mid) > abs(dataPoint - estimate_mid):
        midDataPoint = dataPoint 
```

Inspired by @lakshmanaraj

# xml - 新的和改进的澄清：没有预先存在的 DTD/Schema 时结构化数据的 XML 提要设计最佳实践

> ID：638034
> 
> 赞同：8
> 
> 时间：2009-03-12T10:30:53.837
> 
> 标签：xml, language-agnostic

在为结构化数据设计 XML 提要时，有哪些好的做法，有哪些反模式？

我想要涵盖 XML 结构和内容和/或传输机制的答案。

**运输机制**

就目前的技术而言，FTP/SFTP 是一项好技术吗？是否存在最适合作为解决方案的情况？

一般来说，我更喜欢 HTTP 拉取提要，但使用 HTTP 有哪些弱点？

还应考虑哪些其他馈送机制及其优缺点？

**XML 结构内容**

当不存在合适的现有 DTD/模式时，可以遵循哪些实践来提出良好的 XML 设计？

我已经在下面的回答中给出了两种反模式。

但是在设计提要时我应该怎么做？我想听听标签与属性，关系数据（尤其是多对多关系）应如何在 XML 中传达等。

**注意**：我已经完全重写了这个问题，因为即使提供了赏金，它也没有得到很多的爱。（如果你想看的话，旧版本在编辑历史中。这个版本应该与已经给出的答案相关）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T11:14:50.203

一个好的饲料有

1) 一个模式，因为这样你可以通过编程方式检查它并且你知道它什么时候被改变了——节省了很多争论

2）告诉你它什么时候下降

3) 始终如一地工作

4) 将优雅地处理停止、开始、暂停、倒带

5) 有一个测试服务，可以充分练习所有现有的提要功能

6) 新增沙盒开发特色服务

实际上，我只使用提供 1 有时 2 的提要，但我们可以梦想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T10:35:06.710

如果没有 DTD / Schema，在代码遇到问题之前，您无法知道提要是否有效。所以对我来说，模式非常重要，无论是作为 XML 消费者还是生产者。

即使是一个简单的模式也很有用，它可以定义元素、它们出现的次数等。一个详细的模式，根据需要带有限制或枚举就更好了。当我有这些时，我可以最大限度地减少我生成的 XML 中的错误数量，或者我可以验证整个文件是否发送给我，并根据需要将其拒绝为不符合要求。这只是一种执行输入验证的简洁、标准的方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T11:23:31.073

这是一个很好的问题，但我不知道它比模式好，！模式坏了多远。

我不得不使用未能提供或提供损坏模式的提要，实际上你所能做的就是将它们转换为无命名空间的克隆，这是可行的，但风险很大。

I18N，尤其是数字格式和日期戳是一个大问题。最佳实践当然是在文档中声明您的格式，最好默认为 UTC 时间。

我想我可以建议的唯一其他好的做法是，在使用需要交互的多个提要时，不要尝试按照它们的条件处理它们，而是你需要做的第一件事是将它们反序列化为标准对象或将它们转换为一个标准的内部架构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T01:25:57.027

在不了解您的实际需求的情况下，很难对传输机制或样式提出建议。例如，如果您正在进行基于拉取的联合，HTTP 可以提供有助于缓存的功能。如果您正在执行基于推送或发布/订阅协议，例如[XMPP，则可以使用](http://xmpp.org/internet-drafts/attic/draft-saintandre-atompub-notify-01.html)。

对于您的提要本身，我建议您坚持使用[Atom](http://atomenabled.org/developers/syndication/atom-format-spec.php)等公共规范（或者，如果您愿意，也可以是 RSS 变体）。Atom 包含您提到的一些项目，例如编码内容和日期格式（在大多数情况下使用 UTC 是最简单的，然后转换为用户的本地时间进行显示）。通过坚持标准格式，您还允许使用支持该规范的提要解析器。

Atom 和 RSS 足够灵活，允许您定义自己的 XML 名称空间来添加您需要的任何元素和属性。如果您生成的数据没有映射到提要/条目数据模型，那么它们可能不是最适合您的。

如果您使用 XML，父/子关系（其中子只有 1 个父）这些可以很容易地建模为父/子元素。如果孩子有多个父母，您可以使用引用和属性来链接元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T11:21:27.397

目前我个人的一个问题是没有时区信息的时间戳。如果您正在处理来自世界各地的提要，那么没有时区的时间是没有意义的。

**编辑：**以及不包含编码属性或包含一个但不尊重它的提要！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T01:39:05.637

我认为[MediaRSS](http://search.yahoo.com/mrss/)是一个很好的提要模式。我喜欢它因为：

*   它足够灵活，可以包含几乎任何类型的内容。
*   它允许您在提要中定义媒体组（很有用，例如，当您有多个图像分辨率或多种格式时）。
*   它几乎定义了所有类型媒体共有的所有基本元数据，但并不需要所有这些元数据。我没有遇到任何我想放入它​​无法代表的提要中的媒体。

我希望它拥有的一件事不是应该传递给给定媒体的播放器的任意参数的标签，但我认为这真的没有意义，因为提要不应该有了解有关玩家的任何信息。但有时我只需将参数传递给 Flash 播放器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-21T15:40:11.317

好吧，老实说，“最佳实践”并不普遍，因此任何答案都只适用于正在解决的特定问题。

但是，根据我的经验，这里列出了通用 XML 和协议设计元素。

*   由于可靠性，尽可能避免使用 FTP/SFTP，尤其是对于 SFTP，它们不是通用的实现。此外，大多数防火墙将允许端口 80，但您可能会遇到阻止 FTP/SFTP 的端口。
*   Implement a schema with a namespace that has a version or date in it. For example, [http://yourcompany.com/xml/myfeed/2009/03](http://yourcompany.com/xml/myfeed/2009/03). That conveys information about when the schema was revised and also indicates a version number, which is useful for clients.
*   If your feed is publicly exposed, consider implementing various RDF tags for your data. Your data will then become part of the Semantic Web.
*   If your content supports it, use RSS or Atom, because there are tons of clients out there that understand those formats already, so it dramatically increases your usability.

# c# - 链接 .NET 委托时，如何（重新）使用原始实例？

> ID：638038
> 
> 赞同：2
> 
> 时间：2009-03-12T10:32:39.290
> 
> 标签：c#, .net, delegates, chaining, instances

假设我有以下 C# 代码：

```
Action a = TestMethod;
Action b = TestMethod;
Action c = b;
b += a; 
```

测试表明 与`b`不是同一个实例`c`，因此显然`+`操作员似乎创建了委托的新实例。这是一个正确的假设吗？它是在`b`内部重用 -instance，还是只是将方法/目标信息复制到新实例？

我似乎无法找到`+`代表运算符的实现，Delegate 类似乎不包含它。

任何人都可以对这个问题有所了解吗？

我问的原因是我正在创建一些类，它们会像洋葱一样将自己分层，最外层将调用内层，获取一些委托，然后将更多方法附加到这些委托，我只是担心这样做会以某种方式改变我从内层获得的委托，在这种情况下，我需要返回副本/克隆，而不仅仅是内部引用。

请注意，这完全是我的库的内部代码，所以虽然我知道传递这样的内部数据结构通常是一个坏主意，但如果我可以安全地使用这些类，那么我会这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T10:35:55.803

`+=`相当于`Delegate.Combine()`。`-=`相当于`Delegate.Remove()`。每个都创建一个新`Delegate`实例并返回它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T10:37:42.370

正如肯特所说， += 使用 to [`Delegate.Combine`](http://msdn.microsoft.com/en-us/library/system.delegate.combine.aspx)， -= 使用[`Delegate.Remove`](http://msdn.microsoft.com/en-us/library/system.delegate.remove.aspx)。有关更多信息，请参阅我的[活动/代表文章](http://pobox.com/~skeet/csharp/events.html)。

重要的是委托是不可变的——调用组合/删除根本不会改变你调用它的委托——所以你不需要克隆任何东西。对于您对委托执行的任何其他操作也是如此：例如，如果您获取调用列表并更改返回数组的内容，则不会改变委托实际执行的操作。

（这就像 String 的行为，如果你想换一种方式思考的话。）

# c# - .net：从数据库或其他来源提取内容的虚拟网络共享

> ID：638041
> 
> 赞同：0
> 
> 时间：2009-03-12T10:34:56.883
> 
> 标签：c#, .net, virtualization, storage

我想公开可能来自不同来源（即数据库或各种其他文件夹位置）的数据，并将其作为虚拟网络文件夹提供，以便用户可以访问数据，并将数据写入此虚拟文件夹结构，侦听器将动作翻译成应该在幕后对文件执行的操作。我想以这种方式实现文档的版本控制，其中被覆盖的文件在幕后仍然可用，但用户只能看到最新的文档。

此功能是 ie 的一部分。Alfresco 是一个文档管理系统。

我使用的是 .NET，但这些网络文件夹应该可以从其他系统访问，例如 Mac OSX 和 Linux。

有人对我有一些起点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T20:54:02.220

不久前我看着做类似的事情。调查将我带到了这个库（[http://www.suchwerk.net/sodcms_FUSE_for_WINDOWS.htm](http://www.suchwerk.net/sodcms_FUSE_for_WINDOWS.htm)），它是 FUSE 的 .NET 实现（用户空间中的[文件系统](http://fuse.sourceforge.net/)）。

在 .net 代码中创建虚拟文件系统相当快速和容易。我不确定这个实现是否可以在机器外访问，但是当您使用托管语言处理虚拟文件系统时，它是一个很好的起点。

希望这能让你走上好路！

# java - Java VNC 小程序与屏幕捕获

> ID：638042
> 
> 赞同：5
> 
> 时间：2009-03-12T10:34:59.503
> 
> 标签：java, video-capture, vnc

我正在尝试制作一个应用程序，其中一个组件捕获用户的屏幕（用于屏幕投射）。我知道有两个选项可以使用 Java 小程序实现相同的效果（如果我错了，请纠正我）。首先是使用java小程序连续截屏并转换成视频，作为视频文件上传。其次是创建一个 java vnc 服务器并将其记录为 .fbs 文件并使用如下播放器播放：http: [//www.wizhelp.com/flashlight-vnc/index.html](http://www.wizhelp.com/flashlight-vnc/index.html)

我想知道在视频质量、文件大小、跨平台兼容性（windows 和 mac）、防火墙问题以及最终易于实施方面的最佳解决方案。

我对 Java 很陌生。请告诉我什么是我的问题的最佳解决方案。另外，我自己编程是否足够容易，或者我应该通过自由职业者开发它。我有大量的编程经验（LAMP 5 年以上），但没有 Java 经验。

非常感谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T05:28:51.077

我同意这很难。我为前雇主实施了这两种解决方案（VNC 和板载屏幕捕获）以及第三种解决方案（通过[Epiphan](http://www.epiphan.com/products/frame-grabbers/)采集器从外部 VGA 源捕获）。我使用 VNC 获得了最佳的带宽质量比，但使用 VGA 捕获获得了更高的帧速率。在所有这三种情况下，我将帧 + 捕获时间减少为 PNG，并在 QuickTime 参考电影中对它们进行排序。然后我制作了结果的扁平视频（MPEG4 或 SWF）。就我而言，然后我将屏幕视频与 DV 流同步。

最后，该技术奏效[了（见输出示例](http://www.media-landscape.com/yapc/2006-06-26.ChrisDolan/)），但我们的商业模式失败了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T15:03:04.910

据我所知，旧版本的小程序有可能不允许屏幕捕获的安全限制。相反，Java 应用程序可能是可行的。关于自己构建与解雇编码器，这取决于与自由职业者网站上可以找到的时间相比，您如何珍惜时间。我认为您可以从印度/罗马尼亚/波兰/其他国家/地区找到可以以可承受的价格生产的人

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-21T17:38:09.350

鉴于您的 Java 知识和任务的难度，您是否考虑过采用替代方法？例如，为最终用户提供一个本地 VNC 服务器怎么样，这只是一个小下载，然后他们单击“运行”。并且该本地服务器被编程为捕获屏幕并将其直接发送到您的网络服务器，该服务器具有像 vnc2swf 这样的客户端或其他将 VNC 流转换为视频或 .fbs 文件的方法？这一切有意义吗？

诚然，如果没有 Java，您必须为每个要支持的平台准备一个可执行程序，但是，我不知道。这对我来说仍然听起来更容易。考虑 Copilot.com。他们正在做 VNC，但他们仍然为每个平台使用小型原生应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T22:03:13.777

抱歉，这似乎是一项需要大量经验的工作。即使您在网络上到处找到代码片段来修复这个和那个，总体结果也可能比简单地雇用一个有经验的 Java 程序员更糟糕。

# visual-studio - 如何在 Visual Studio 中定义即时自动更正宏？

> ID：638045
> 
> 赞同：7
> 
> 时间：2009-03-12T10:35:59.860
> 
> 标签：visual-studio

通过即时自动更正宏，我的意思是我所做的常见错别字列表以及替换它们的内容。例如，每次我尝试键入 Layer 时，它都会出现“LAyer”。我没有使用任何名为“LAyer”的东西，所以我希望它在我键入后自动将每个 LAyer 实例替换为 Layer。

（作为我的意思的一个例子，进入 Word 并输入类似“推荐”之类的内容。它会立即将其替换为“推荐”，而不会通过在自动更正选项下可以找到的常见拼写错误列表中匹配它来提示。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-08-26T08:04:18.870

我有完全相同的问题（除了我经常打错一大堆单词）。最近我一直在输入“chnage”而不是 change **a lot**。（在我现在正在处理的代码中，我有名为 ChangedRecord 和 ChangedDatum 的类，而且我所做的拼写错误的数量不再有趣了）

在[另一个线程](https://stackoverflow.com/questions/707422/is-there-a-way-to-force-visual-studio-2008-or-below-to-use-a-spellchecker-for-c/707506#707506)中，有人发布了[AutoHotkey](http://www.autohotkey.com/)的链接。

我想我会试一试，我必须说我认为这是一个很棒的小应用程序（它可以做的比我们想要的要多得多。

下面是一个 AutoHotKey 脚本文件，当你键入它时，它应该将“hotstring”“LAyer”替换为“Layer”。我已经定义了它，只有当你完全匹配大小写时它才会更正 - 所以它会留下“layer”和“LaYeR”等。

脚本中还有热字串“chnage”。这被定义为匹配输入单词的大小写 - 即“Chnage”变为“Change”，“ChnagedRecord”变为“ChangedRecord”（请注意，它将“CHnaGe”变为“Change”）。

一个额外的好处（大部分时间 - 请参阅下面的评论）是这些替换是在所有应用程序中进行的，而不仅仅是在 Visual Studio 中。

```
;
; AutoHotkey Version: 1.x
; Language:       English
; Platform:       Win9x/NT
; Author:         A.N.Other <myemail@nowhere.com>
;
; Script Function:
;   Template script (you can customize this template by editing "ShellNew\Template.ahk" in your Windows folder)
;

#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.

:*:chnage::change
:c1*:LAyer::Layer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T11:37:10.090

试试 developer express 的[免费 coderush](http://devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)版本。它的宏语言应该可以轻松地重新创建它。我使用付费版本，但我原以为免费版本仍然具有此功能

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:04:06.720

写一个 Visual Studio 插件？很容易加载 Office 的拼写检查并在 VS 插件中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:18:14.937

Visual Web Developer Team Blog 上有一个使用 Office 拼写检查的加载项：

[http://blogs.msdn.com/webdevtools/archive/2008/11/29/spell-checker-update-2-2-full-support-for-vs-2008-sp1-simpler-setup-and-a-少数错误修复.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/29/spell-checker-update-2-2-full-support-for-vs-2008-sp1-simpler-setup-and-a-few-bug-fixes.aspx)

# visual-studio - Visual Studio 单元测试 - 找不到指定的成员

> ID：638046
> 
> 赞同：2
> 
> 时间：2009-03-12T10:36:11.373
> 
> 标签：visual-studio, unit-testing

在我的解决方案中遇到单元测试的奇怪问题。其中一项测试总是失败并显示以下错误消息：

> 找不到指定的成员 (BuildMap)。您可能需要重新生成私有访问器，或者该成员可能是私有的并在基类上定义。如果后者为真，则需要将定义成员的类型传递给 PrivateObject 的构造函数。

BuildMap 是私有的，我尝试重新生成访问器，将其更改为公共并重新创建单元测试，但它不断失败。其他方法（公共和私有）都可以正常工作。BuildMap 也没有在基类中定义。

还尝试了所有常见的事情，以防VS搞砸，重新启动它，清理程序集，重建等......

关于原因的任何想法？

*更新 1*：这是在 Visual Studio 2008 或命令行 mstest 工具中。
*更新 2*：尝试重命名 BuildMap 方法，并且测试不会构建，说明它丢失了。似乎 Visual Studio/MSBuild 正在做正确的事情，但在它和 mstest 之间的某个地方它正在破坏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T09:43:08.173

奇怪的是，当我将方法从静态更改为非静态时，问题自行解决了。其他私有静态方法虽然工作正常。仍然不确定原因，但这就是解决方案。

# python - 如何在 Python 的元组列表中对每个元组中的第一个值求和？

> ID：638048
> 
> 赞同：36
> 
> 时间：2009-03-12T10:37:27.003
> 
> 标签：python, list, tuples

我有一个像这样的元组列表（总是对）：

```
[(0, 1), (2, 3), (5, 7), (2, 1)] 
```

我想找到每对中第一项的总和，即：

```
0 + 2 + 5 + 2 
```

我怎样才能在 Python 中做到这一点？目前我正在遍历列表：

```
sum = 0
for pair in list_of_pairs:
   sum += pair[0] 
```

我有一种感觉，必须有一种更 Pythonic 的方式。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-12T10:39:31.147

在 Python 的现代版本中，我建议[SilentGhost 发布](https://stackoverflow.com/a/638069/56541)的内容（为清楚起见，在此重复）：

> ```
> sum(i for i, j in list_of_pairs) 
> ```

* * *

在这个答案的早期版本中，我提出了这个建议，这是必要的，因为 SilentGhost 的版本在当时最新的 Python (2.3) 版本中不起作用：

```
sum([pair[0] for pair in list_of_pairs]) 
```

现在那个版本的 Python 已经过时了，而且 SilentGhost 的代码适用于所有当前维护的 Python 版本，所以不再有任何理由推荐我最初发布的版本。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-12T10:43:45.117

```
sum(i for i, j in list_of_pairs) 
```

也会这样做。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-04-21T03:24:43.627

我建议：

```
sum(i for i, _ in list_of_pairs) 
```

*注意*：

使用变量`_`（或`__`避免与 的别名冲突`gettext`）而不是`j`至少有两个好处：

1.  `_`（代表占位符）具有更好的可读性
2.  `pylint`不会抱怨：“未使用的变量'j'”

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-12T10:52:48.777

如果您有一个非常大的列表或生成大量对的生成器，您可能希望使用基于生成器的方法。为了好玩，我也使用`itemgetter()`and `imap()`。不过，一个简单的基于生成器的方法可能就足够了。

```
import operator
import itertools

idx0 = operator.itemgetter(0)
list_of_pairs = [(0, 1), (2, 3), (5, 7), (2, 1)]
sum(itertools.imap(idx0, list_of_pairs)) 
```

请注意，`itertools.imap()`它在 Python >= 2.3 中可用。所以你也可以在那里使用基于生成器的方法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-12T11:19:19.150

晦涩（但有趣）的答案：

```
>>> sum(zip(*list_of_pairs)[0])
9 
```

或者当 zip 是可迭代的时，只有这应该起作用：

```
>>> sum(zip(*list_of_pairs).__next__())
9 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-27T06:55:13.707

下面是示例代码，您还可以指定列表范围。

```
def test_lst_sum():
    lst = [1, 3, 5]
    print sum(lst)  # 9
    print sum(lst[1:])  # 8

    print sum(lst[5:])  # 0  out of range so return 0
    print sum(lst[5:-1])  # 0

    print sum(lst[1: -1])  # 3

    lst_tp = [('33', 1), ('88', 2), ('22', 3), ('44', 4)]
    print sum(x[1] for x in lst_tp[1:])  # 9 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-05T07:32:39.243

如果您不介意将其转换为 numpy 数组，则可以使用[这里](https://docs.scipy.org/doc/numpy/reference/generated/numpy.sum.html)给出`np.sum`的 over`axis=0`

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2020-03-04T14:35:39.473

```
 s,p=0,0
                for i in l:
                  s=s+i[0]
                  p=p+i[1]
               print(tuple(s,p)) 
```

1.  ## 在这里输入代码

# c++ - 如何使用 C++ 增加 Visual Studio 内部版本号？

> ID：638053
> 
> 赞同：4
> 
> 时间：2009-03-12T10:39:02.757
> 
> 标签：c++, c, visual-studio-2008, compiler-construction, build-automation

我有一个 Visual Studio 2008 项目，它生成一个名为：“ **Game-Release.exe** ”的文件。

这是在**Project Properties** -> **C/C++** -> **Linker** -> **General**下配置的：

```
$(OutDir)\$(ProjectName)-Release.exe 
```

我想通过增加内部版本号来进一步说明这一点，所以我会说：

```
Game-Release-Build-1002.exe 
```

最后的数字应该是一个递增的整数。我将在 subversion 上存储构建 exe，所以我认为我会发现这很有用（尽管不是必需的）。

也许 Visual Studio 中有一个内置的宏可以处理这个问题。很可能我在想我可以有一个包含内部版本号的文本文件，并让编译器在每次构建项目时读取、使用和递增文件中的数字。然而，我的目标是使该过程尽可能自动化。实现这一目标的最佳方法是什么？

如果您提供意见，请同时提供我们都可以共享的代码。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T10:53:37.727

版本控制的[构建](http://www.codeproject.com/KB/macros/versioningcontrolledbuild.aspx)插件似乎可以完成这项工作。

**更新：**您的问题特别提到了使用 Visual Studio 来增加版本，但没有什么自动化的。您是否考虑过使用 Nant 和 CI 服务器？这样，很容易将 SVN 修订号注入到与 C++ 等效的 AssemblyInfo.cs 中。自动，在构建服务器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-02T08:27:41.597

如果您使用 svn 对您的项目进行版本控制，您可以按照[此链接](http://www.zachburlingame.com/2011/03/integrating-the-subversion-revision-into-the-version-automatically-with-native-cc/)中的说明进行操作，这对我来说非常有效，因为我可以使用版本信息和比较源代码来跟踪发布应用程序中的错误。

以下所有信息均未包含在链接中：

*   *像这个version.rc*一样设置你的 rc 文件

     *```
    #include "resource.h" 
    #include "version.h" //<-----------Don't forget the include
    /////////////////////////////////////////////////////////////////////////////
    //
    // Version.rc
    //
    VS_VERSION_INFO VERSIONINFO
     FILEVERSION VER_FILE_VERSION
     PRODUCTVERSION VER_PRODUCT_VERSION
     FILEFLAGSMASK 0x17L
    #ifdef _DEBUG
     FILEFLAGS 0x1L
    #else
     FILEFLAGS 0x0L
    #endif
     FILEOS 0x4L
     FILETYPE 0x1L
     FILESUBTYPE 0x0L
    BEGIN
        BLOCK "StringFileInfo"
        BEGIN
            BLOCK "040704b0"
            BEGIN
                VALUE "CompanyName", "Your Company Name"
                VALUE "FileDescription", "Your Application Description"
                VALUE "FileVersion", VER_FILE_VERSION_STR "\0"
                VALUE "InternalName", "Internal Name"
                VALUE "LegalCopyright", "CopyRight stuff - Copyright (C) 2015"
                VALUE "OriginalFilename", "yourapp.exe"
                VALUE "ProductName", "Your Application"
                VALUE "ProductVersion", VER_PRODUCT_VERSION_STR "\0"
            END
        END
        BLOCK "VarFileInfo"
        BEGIN
            VALUE "Translation", 0x407, 1200
        END
    END 
    ```* 
**   接下来将*version.h*文件添加到定义所有内容的项目中，设置如下：

    ```
    #include "svn_version.h"

    #define STRINGIZE2(s) #s
    #define STRINGIZE(s) STRINGIZE2(s)

    #define VERSION_MAJOR             1
    #define VERSION_MINOR             0
    #define VERSION_REVISION          SVN_REVISION
    #define VERSION_BUILD               0

    #if SVN_LOCAL_MODIFICATIONS
       #define VERSION_MODIFIER "M"
    #else
       #define VERSION_MODIFIER
    #endif

    #define VER_FILE_VERSION   VERSION_MAJOR, VERSION_MINOR, VERSION_REVISION, VERSION_BUILD
    #define VER_FILE_VERSION_STR        STRINGIZE(VERSION_MAJOR)        \
    "." STRINGIZE(VERSION_MINOR)    \
    "." STRINGIZE(VERSION_REVISION) \
    "." STRINGIZE(VERSION_BUILD)    \

    #define VER_PRODUCT_VERSION         VER_FILE_VERSION
    #define VER_PRODUCT_VERSION_STR     VER_FILE_VERSION_STR 
    ```* 

 *在此之后，您可以点击上面的[链接](http://www.zachburlingame.com/2011/03/integrating-the-subversion-revision-into-the-version-automatically-with-native-cc/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T10:55:17.100

我不确定 VS2008 是否具有该功能，但我认为您可以使用后链接器事件来执行此操作，该事件运行一个为您完成任务的小脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T11:50:04.520

我使用预构建脚本（用 JavaScript 编写并使用 cscript.exe 引擎执行）定义主要/次要版本，获取 SVN 修订号并根据当前日期生成一个神奇的构建号。然后该脚本创建一个由主应用程序使用的 version.h 文件（以及由主应用程序资源文件创建一个 VERSION 资源）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-30T00:13:48.320

我自己的方法，包括二进制文件标记：

[http://indiocolifax86.wordpress.com/2010/05/22/a-scheme-for-automatic-build-numbers-in-cc-projects/](http://indiocolifax86.wordpress.com/2010/05/22/a-scheme-for-automatic-build-numbers-in-cc-projects/)

# php - 我应该在里面 htmlspecialchars() 变量 吗？

> ID：638057
> 
> 赞同：2
> 
> 时间：2009-03-12T10:40:02.533
> 
> 标签：php, security, xss

是否有必要过滤/转义不安全的变量`<title>`或其他标签`<head>`以防止 XSS？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T10:47:54.030

严格来说，*绝对*`htmlspecialchars()`有必要对您从 PHP 输出到网页的所有内容进行处理。

 *如果您发现这会产生错误的结果（即 HTML 代码由于双重编码而显示在浏览器中），您已经在您的应用程序中发现了设计缺陷。

如果人们坚持这个简单的规则，XSS 就不会成为问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T10:48:43.123

是的。您应该*始终*`htmlspecialchars`对可能包含 HTML 特殊字符的值使用该函数。

# asp.net - 可用于复杂对象（具有子对象的对象）的数据控件（在 .NET 中）

> ID：638059
> 
> 赞同：1
> 
> 时间：2009-03-12T10:40:43.080
> 
> 标签：asp.net

复杂对象（带有子对象的对象）是否有可用的数据控件（在 .NET 中）。类似于 gridview 但带有超链接的东西，它将带你到子对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T15:35:31.267

您可以嵌套 ListView（或 gridview，如果这对场景有意义）。还有一个树形视图控件。

检查此问题以获取嵌套列表视图的示例（它使用 IGrouping，但概念相同 - 只需将 DataSource 设置为 Childs 属性）：[Displaying an IGrouping<> with nested ListViews](https://stackoverflow.com/questions/172934/displaying-an-igrouping-with-nested-listviews)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-16T16:20:33.257

使用 Microsoft 动态数据。[www.asp.net/dynamicdata/](http://www.asp.net/dynamicdata/)

# perl - 如何将 UTF8 编码的非 ASCII 字符转换为 Perl 中的 ASCII 等效字符？

> ID：638060
> 
> 赞同：5
> 
> 时间：2009-03-12T10:40:45.670
> 
> 标签：perl, utf-8, character-encoding, ascii

我有一个 Perl 脚本，第三方调用它来向我发送注册我的软件的人的姓名。其中一方使用 UTF-8 对名称进行编码，因此我相应地调整了我的脚本，以使用 Encode::decode_utf8(...) 将 UTF-8 解码为 ASCII。

这通常可以正常工作，但每 6 个月左右，其中一个名称包含西里尔字母、希腊语或罗马尼亚语字符，因此对名称进行解码会产生诸如“ÐŸÐ¾Ð´Ñ€Ð°Ð¶Ð°Ð½Ñ¡ºÐ°Ñ”之类的垃圾字符。我必须跟进客户并要求他提供其姓名的“拉丁字符版本”，以便颁发注册码。

那么，是否有任何 Perl 模块可以检测是否存在此类字符并在必要时自动将它们转换为最接近的 ASCII 表示？

似乎我可以使用 Lingua::Cyrillic::Translit::ICAO 加上 Lingua::DetectCharset 来处理 Cyrillic，但我更喜欢与其他字符集一起使用的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T14:21:35.107

我相信您可以为此使用[Text::Unidecode](http://search.cpan.org/dist/Text-Unidecode/)，这正是它试图做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-30T15:34:26.460

在 Text::Unicode 的文档中，在“Caveats”下，这个短语似乎是不正确的：

*确保输入数据确实是 utf8 字符串。*

UTF-8 是一种可变长度编码，而 Text::Unidecode 只接受每个字符的固定长度（两字节）编码。所以这句话应该是：

*确保输入数据确实是一串两字节 Unicode 字符。*

这也称为 UCS-2。

如果你想转换真正是 utf8 的字符串，你可以这样做：

```
my $decode_status = utf8::decode($input_to_be_converted);
my $converted_string = unidecode ($input_to_be_converted); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:05:37.370

如果您必须处理不在 ascii 范围内的 UTF-8 数据，最好的办法是更改后端，使其不会在 utf-8 上阻塞。你会如何音译汉字符号？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:25:02.650

如果您得到西里尔文本，则许多字符没有“最接近的 ASCII 表示”。

# php - 在mysql数据库之间切换

> ID：638062
> 
> 赞同：0
> 
> 时间：2009-03-12T10:40:51.207
> 
> 标签：php, mysql

```
function getLink($sa){
    if($sa=='1'){
        $sa = 'qp_bbl';
    } else {
        $sa = 'qp_sbl';
    }   
    return $sa;
}

if(!$_POST['action']){
    header ("Location: index.php"); 
}else{

$sa = $_POST['select'];

$sa = getLink($sa); 

$link = connect(HOST, USER, PASSWORD, $sa);

(....)
} 
```

这真让我抓狂。选择可以是“1”或“2”。如果我硬编码 $sa = '1' 或 '2' 一切都很好，但如果从 $_POST['select'] 设置它，那就不行了。我真的不明白...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T10:47:32.673

使用此解决方案，您需要在每个页面请求上发布“sa”，否则对于任何其他请求，它将始终回退到“qp_sbl”，因为您似乎没有存储要在会话期间使用的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:46:11.553

您可以尝试使用 print_r($_POST) 检查 $_POST 的内容，以确保 $_POST['select'] 已通过。

但是，您不应该基于 $_POST 数据建立数据库连接。这不是很安全。如果要根据 $_POST 有条件地选择数据库，请尝试以下操作：

```
switch($_POST['select']) {

  case '1':  $db = '1';  break;
  default:   $db = '2';

} 
```

这样你就确定你选择了一个有效的数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:53:17.647

要继续 jonstjohn 对 print_r 的评论……如果出现问题，我们还可以查看要发布到此脚本的初始表单。

它也可能有助于在发布时将选择值存储在会话中，然后只使用会话中的值直到它发生变化。

# c# - C# Winforms - 将表单添加到 FlowPanel 控件

> ID：638063
> 
> 赞同：3
> 
> 时间：2009-03-12T10:41:11.220
> 
> 标签：c#, winforms, user-interface, flowpanel

我有一个页面，我必须修改变量，这些变量是具有成对值和标签的字符串。我正在使用数据网格对象，但它不足以满足所需（或者最终不会）。

所以我有一个表单，它是一个文本标签和文本框，以及一个流程面板，我正在尝试以编程方式为流程面板中的每个变量添加此表单的实例，但我什么也没得到。谷歌搜索解决方案带来了很多视频教程，包括单击 UI 设计器中的按钮并将它们放在流面板上，但是我想以编程方式执行此操作。

这样做的“正确”或“标准”方式是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T10:48:05.417

数据（成对）听起来可能更适合 a `TableLayoutPanel`，但理论是一样的；只需打电话`.Controls.Add(...)`，它应该可以工作：

```
 FlowLayoutPanel panel = new FlowLayoutPanel();
    Form form = new Form();
    panel.Dock = DockStyle.Fill;
    form.Controls.Add(panel);

    for (int i = 0; i < 100; i++)
    {
        panel.Controls.Add(new TextBox());
    }

    Application.Run(form); 
```

或带有`TableLayoutPanel`：

```
 TableLayoutPanel panel = new TableLayoutPanel();
    Form form = new Form();
    panel.Dock = DockStyle.Fill;
    panel.ColumnCount = 2;
    form.Controls.Add(panel);

    for (int i = 0; i < 100; i++)
    {
        panel.Controls.Add(new Label { Text = "label " + i });
        panel.Controls.Add(new TextBox { Text = "text " + i });
    } 
```

另外 - 我想知道 a`PropertyGrid`是否会更好地满足您的需求？这将处理所有“获取值”、“显示值”、“解析值”、“存储值”逻辑，并且可以插入诸如`ICustomTypeDescriptor`允许动态属性之类的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T11:51:26.187

要将表单的实例添加到流程布局面板，我执行以下操作：

```
Form1 f1 = new Form1();
f1.TopLevel = false;
f1.Visible = true;
flowLayoutPanel1.Controls.add(f1); 
```

在我的测试代码中似乎工作正常。

# sql - 有限制地任意选择后续记录

> ID：638065
> 
> 赞同：0
> 
> 时间：2009-03-12T10:42:21.220
> 
> 标签：sql, mysql

我想在按列表排序的结果集中执行查询以在任何给定记录的记录之后立即检索记录。我不明白如何使用 sql 语法中的 limit 关键字来做到这一点。

我可以使用 WHERE primarykey = number，但是当我只有一个结果时，限制结果有什么帮助？

如何获得具有任意主键编号的下一条记录？

我有一个任意主键，并想选择按日期排序的下一个主键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T10:47:27.900

这将模拟`LEAD()`分析函数（即从表中为每一行选择下一个值）

```
SELECT  mo.id, mo.date,
        mi.id AS next_id, mi.date AS next_date
FROM    (
        SELECT mn.id, mn.date,
               (
               SELECT  id
               FROM    mytable mp
               WHERE   (mp.date, mp.id) > (mn.date, mn.id)
               ORDER BY
                       mp.date, mp.id
               LIMIT 1
               ) AS nid
        FROM   mytable mn
        ORDER BY
               date
        ) mo,
        mytable mi
WHERE mi.id = mo.nid 
```

如果您只想为给定 ID 选择下一行，您可以使用：

```
SELECT  *
FROM    mytable
WHERE   (date, id) >
        (
        SELECT  date, id
        FROM    mytable
        WHERE   id = @myid
        )
ORDER BY
        date, id
LIMIT 1 
```

如果您有一个索引，这将最有效地工作`(date, id)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:48:24.603

像这样的东西怎么样，如果你正在寻找34之后的那个

```
SELECT * FROM mytable WHERE primaryKey > 34 ORDER BY primaryKey LIMIT 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T10:54:14.920

可能很简单：

```
select *
from mytable
where datecolumn > (select datecolumn from mytable where id = @id)
order by datecolumn
limit 1 
```

（评论后编辑）

# smartclient - 我在哪里可以获得 Microsoft.Practices.SmartClient.DisconnectedAgent.dll？

> ID：638074
> 
> 赞同：1
> 
> 时间：2009-03-12T10:46:59.803
> 
> 标签：smartclient, scsf

我正在重建一个使用以下项目的项目：

Microsoft.Practices.SmartClient.DisconnectedAgent.dll

而且我无法在任何地方找到它作为下载：

*   [Smart Client Software Factory - 2008 年 4 月](http://www.microsoft.com/downloads/details.aspx?FamilyId=3BE112CC-B2C1-4215-9330-9C8CF9BCC6FA&displaylang=en)- 这将创建文件夹“SCSF-Apr2008”，其中包含一个“lib”目录，其中包含许多“Microsoft.Practices.EnterpriseLibrary.*”DLL，但不是我需要的 DisconnectedAgent。
*   [Smart Client Software Factory - 2007 年 5 月](http://www.microsoft.com/downloads/details.aspx?FamilyId=2B6A10F9-8410-4F13-AD53-05A202FBDB63&displaylang=en&hash=eZSjWtpZSiK0rsK1yqaXs8vJovjnghAAKStFsob8wzWOlTH6qiosIA2oMSxUjcAxHw1X3aT0uJDKG4oM8gUWbw==)- 许多消息来源说这个下载有它，但它实际上只是一个包含两个 .chm 文件的 zip 文件

有谁知道我在哪里可以下载**Microsoft.Practices.SmartClient.DisconnectedAgent.dll**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T16:08:24.137

它在[Smart Client Software Factory - May 2007.msi](http://www.microsoft.com/downloads/details.aspx?familyid=2b6a10f9-8410-4f13-ad53-05a202fbdb63&displaylang=en)中。您是否下载了*Smart Client Software Factory**文档**- 2007 年 5 月*？还是您没有安装整个软件包/没有所需的依赖项？然后你可以从 msi 中提取文件（谷歌，或使用[总指挥官](http://www.ghisler.com/) [msi plus 插件](http://www.totalcmd.net/plugring/msiplus.html)- 这就是我现在看到文件的地方）

# xml - Flex 3：同步加载一个xml文件

> ID：638085
> 
> 赞同：3
> 
> 时间：2009-03-12T10:49:18.050
> 
> 标签：xml, apache-flex, synchronous

我的问题很简单：在flex3中，有没有办法同步加载一个xml文件？

我知道如何使用加载事件异步加载。这可能有用，也可能没有。我只想读取文件，解析它，做我必须做的事情，然后继续执行代码。

我有一个使用 xml 文件来存储一些配置参数的组件。我需要在初始化对象时读取文件。但是，使用事件模型，我无法控制文件何时加载，因此我必须编写代码来“等待”代码加载。这太荒谬了，还是我？我想要这样的代码：

```
var foo:Foo = new Foo(); //This constructor should read the xml and initialize the object.
foo.doSomething(); //When I call this method the xml must be already handled. 
```

我可以处理事件的 xml 文件，它工作正常，但事件在doSomething 方法**之后触发。**

我希望我已经解释了自己。我认为这应该很容易，但这让我发疯。除非真的有必要，否则我不想编写代码来等待事件。我觉得这一切应该只是一行代码！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T10:55:05.883

我认为，有一个带有负载的“之后”事件。

所以你必须在两个不同的方法中拆分对 new() 的调用和对 do() 的调用，所以 new() 是在初始化中调用的，do() 是在 load() 之后调用的

伪语法：

```
beforeInitialisation()
  disableDoSomething()
  new()...
  loader.addEvent(AFTERLOAD, afterLoad)

afterLoad()
  enableDoSomething()

someMethod()
  doSomething() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T12:24:57.947

我会回答自己，但是我仍然想知道是否有人提出了更好的想法。dirkgently 和 Peter Miehle 的回答都很有帮助，但并不能解决我的实际问题。

似乎同步加载是不可能的。加载可能会失败或花费太长时间，我们不能因此而冻结应用程序。这是合理的，但我仍然觉得它会使代码变得比它应该的更复杂。

我要做的是在创建对象之前加载 xml 文件，并将其作为参数传递给构造函数。这样，我将确保对象在需要时加载了 xml 文件。然而，这也不是一个理想的解决方案，因为现在我必须让另一个类负责 Foo 的“私人事物”。

有更好的想法吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T15:34:23.487

同步加载是不可能的，flash 是为 web 构建的，你永远无法确定调用需要多长时间。Air 是不同的，因为它从文件系统加载，并且那里的延迟量几乎没有。

最干净的解决方案是监听 Foo 内部完成的负载并从内部调用 doSomething() ，这样你的“外部”类根本不需要打扰。

如果你确实需要从外部调用 foo.doSomething()，你可以使用事件系统。让您的 Foo 类在加载完成后调度一个事件：

```
dispatchEvent(new Event(Event.COMPLETE, true)); 
```

要抓住它，你需要像这样听它：

```
foo.addEventListener(Event.COMPLETE, handleFooComplete); 
```

你的事件处理函数应该是这样的：

```
private function handleFooComplete(e:Event):void{
    foo.doSomething();
} 
```

无论您选择这样做，您都需要在加载程序上侦听 Event.COMPLETE。没有办法解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-19T03:34:35.280

老问题，但我敢打赌很多人仍然来这里，所以这是我的解决方案。

创建一个您在处理 resultEvent 的函数内部分派的自定义事件

有你想做某事的对象，我认为在这种情况下它是 foo，来监听这个自定义事件，然后调用 doSomething()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T11:05:54.483

`foo.doSomething();`从事件处理程序内部调用XML 加载事件（例如`EVENT.Complete`，取决于您加载文件的准确程度）。这是推荐的方式。

# c# - Linq 2 SQL - 一种更好的方法

> ID：638086
> 
> 赞同：1
> 
> 时间：2009-03-12T10:49:26.787
> 
> 标签：c#, generics

我有一个存储库基类，它从我的 mvc 应用程序中的控制器调用

每个控制器都有自己的存储库

像这样

```
public class ServiceRepository : Bluegrass.Mvc.RepositoryBase<Models.Service>
{
    public ServiceRepository()
    {
        this._db = new iSppms.Models.iSppmsDataContext();
    }
} 
```

并被使用

```
internal DataAccess.ServiceRepository repository =
        new iSppms.DataAccess.ServiceRepository();
    public ActionResult Index()
    {
        var viewData = new ViewData.ServiceIndexViewData(
            repository.GetItems<Models.Service>());
        return View(viewData);
    } 
```

我想要做的不是必须通过模型，因为 RepositoryBase 已经是 Models.Service 类型

我正在寻找一种更好的方法来构建它。

```
public class RepositoryBase<T> where T : class
{
    public DataContext _db;

    public List<T> GetItems<T>() where T : class, Interfaces.IModel
    {
        var table = _db.GetTable<T>();
        var data = table.Where(t => !t.Deleted);

        return data.ToList();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T10:55:21.500

您可以将`IModel`位添加到`RepositoryBase<T>`，并使`GetItems<T>`非泛型吗？注意：重新使用通用令牌已经是一个坏主意`T`（在 中有所**不同**`GetItems`）：

```
public class RepositoryBase<T> where T : class, Interfaces.IModel
{
    public DataContext _db;

    public List<T> GetItems()
    {
        var table = _db.GetTable<T>();
        var data = table.Where(t => !t.Deleted);

        return data.ToList();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T11:23:39.060

也许这篇[Repository Base Class](https://devermind.wordpress.com/2008/10/13/a-linq-disconnected-mode-abstract-base-class/)文章可以提供帮助？

# java - 对于 ARM 开发，您建议使用哪种 Java 嵌入式 VM？

> ID：638087
> 
> 赞同：25
> 
> 时间：2009-03-12T10:49:33.837
> 
> 标签：java, embedded, arm

有很多 Java 嵌入式 VM。您对 ARM 开发有何建议？

*   [http://www.cacaovm.org/](http://www.cacaovm.org/)
*   [http://www.rtjcom.com/main.php?p=home](http://www.rtjcom.com/main.php?p=home)
*   [http://www.k-embedded-java.com/](http://www.k-embedded-java.com/)
*   [http://jamvm.sourceforge.net/](http://jamvm.sourceforge.net/)

我目前正在使用 Dallas 的[TINI](http://en.wikipedia.org/wiki/Tiny_Internet_Interface)平台，效果很好（512 KB RAM 和 1 MB 闪存），但现在我需要更多电源（内存和 CPU）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-30T12:36:22.673

我最后的选择是 JamVM + GNU Classpath。效果很好！:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T12:43:57.447

4 种不同的 VM 已移植到在 ARM cpus 上运行的 Symbian OS。

Sun 的 KVM、Sun 的热点（或 cldc-hi）VM、Sun 的 CDC VM 和 IBM J9 VM。

我怀疑还有几个。

开始研究的一个好地方是 JavaME 被许可人列表：

[http://java.sun.com/javame/licensees/index.jsp](http://java.sun.com/javame/licensees/index.jsp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-19T15:39:49.863

我过去在 Dallas tini 上做过一些工作，所以我想我知道你在找什么……？（也许无论如何:)

如果您查看[Buildroot](http://buildroot.uclibc.org/)之类的项目，您会发现现在包含[jamvm ，我计划在](http://www.google.se/search?q=buildroot+jamvm&ie=utf-8&oe=utf-8&aq=t&rls=com.ubuntu:en-US:unofficial&client=firefox-a)[Atmel NGW100](http://www.atmel.com/dyn/products/tools_card.asp?tool_id=4102)上试用它（它基于 AVR32，但它类似于 ARM9）。但是还有很多其他 ARM9 项目几乎可以做到这一点。

这个想法与 Android 相同，首先让 Linux 处理较低的层，然后在顶部添加一个 java vm 并在那里运行您的应用程序。

不利的一面是达拉斯 tini 或多或少是一个“准备就绪”的平台，你没有做太多的魔法来让它运行。但不幸的是，这条道路需要一些工作才能达到全速。但从好的方面来说，你有一个 200MHz 32 位 CPU 和 32Mb RAM 和存储在 SD 卡上的承诺，可以轻松存储几个千兆字节 :)

祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-02T18:37:52.320

还有支持 ARMv5、v6、v7 的[Java SE Embedded](http://java.sun.com/javase/embedded/)，但请注意，这是一个带有 C1 编译器的成熟热点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-13T20:07:26.187

您还可以查看 debian openjdk 支持，例如

[http://debian.torredehanoi.org/debian/pool/main/o/openjdk-6/openjdk-6-jre-headless_6b11-9.1_armel.deb](http://debian.torredehanoi.org/debian/pool/main/o/openjdk-6/openjdk-6-jre-headless_6b11-9.1_armel.deb)

但我认为它需要比 512kB 更多的 RAM

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-16T15:24:22.540

我的选择是 IS2T JVM，它专门针对 ARM Cortex M 和 Cortex A 进行了优化，并带有优化的库（如带有小部件的 HMI 等......）

[http://www.is2t.com](http://www.is2t.com)

# c++ - 分析 C++ 多线程应用程序

> ID：638090
> 
> 赞同：10
> 
> 时间：2009-03-12T10:50:14.070
> 
> 标签：c++, performance, multithreading, profiling

您是否使用过诸如 Intel Vtune 分析器之类的分析工具？

您对 Linux 和 Windows 上的 C++ 多线程应用程序有什么建议？我主要对缓存未命中、内存使用、内存泄漏和 CPU 使用感兴趣。

我使用 valgrind（仅在 UNIX 上），但主要用于查找内存错误和泄漏。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T11:04:49.450

以下是多线程应用程序的好工具。您可以尝试评估副本。

1.  运行时健全性检查工具
    *   线程检查器——英特尔线程检查器/VTune，[在这里](https://software.intel.com/en-us/articles/intel-thread-checker-documentation)
2.  内存一致性检查工具（内存使用情况、内存泄漏）- 内存验证器，[这里](http://www.softwareverify.com/cpp/memory/index.html)
3.  性能分析。（CPU 使用率）- AQTime ，[在这里](http://www.softpedia.com/get/Programming/Other-Programming-Files/AQtime.shtml)

**编辑**：英特尔线程检查器可用于诊断数据竞争、死锁、停滞线程、废弃锁等。请耐心分析结果，因为它很容易混淆。

几个小贴士：

1.  禁用不需要的功能。（在识别死锁的情况下，可以禁用数据竞争，反之亦然。）
2.  根据您的需要使用 Instrumentation 级别。“All Function”和“Full Image”等级别用于数据竞争，而“API Imports”可用于死锁检测）
3.  经常使用上下文相关菜单“诊断帮助”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T13:36:34.293

在 Linux 上，尝试[oprofile](http://oprofile.sourceforge.net/)。它支持各种性能计数器。

在 Windows 上，AMD 的[CodeAnalyst](http://developer.amd.com/CPU/CODEANALYST/Pages/default.aspx)（免费，与 VTune 不同）值得一看。它只支持 AMD 硬件上的事件分析（在 Intel CPU 上它只是一个方便的基于计时器的分析器）。

一位同事最近试用了[Intel Parallel Studio](http://software.intel.com/en-us/intel-parallel-studio-home/)（测试版）并给予好评（它在一些代码中发现了一些有趣的与并行性相关的问题）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T11:14:04.263

VTune 会为您提供有关处理器正在做什么的许多详细信息，有时我发现很难看到树木的树木。VTune 不会报告内存泄漏。为此，您需要 purify plus，或者如果您可以在 Linux 机器上运行，valgrind 对内存泄漏有好处，而且价格实惠。

VTune 显示了两种视图，一种是有用的表格视图，另一种我认为只是为了给销售人员留下深刻印象，但没有那么有用。

对于快速和便宜的选择，我会选择 valgrind。Valgrind 也有一个缓存研磨部分，但我没有使用它，但怀疑它也非常好。

干杯，马丁。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-30T08:19:19.400

您可以试用 AMD CodeXL 的 CPU 分析器。它是免费的，可用于 Windows 和 Linux。

AMD CodeXL 的 CPU 分析器取代了不再受支持的 CodeAnalyst 工具（在上面 timday 给出的答案中提到过）。

如需更多信息和下载链接，请访问：[AMD CodeXL 网页](http://developer.amd.com/tools-and-sdks/heterogeneous-computing/codexl/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T13:54:53.487

我将为[valgrind](http://valgrind.org/info/tools.html)提供另一个答案，尤其是 UI 中的 callgrind 部分。它可以通过分析每个线程的缓存未命中等来处理多个线程。它们还有一个名为 hlgrind 的多线程错误检查器，但我从未使用过它，也不知道它有多好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T11:00:49.613

[Rational PurifyPlus](http://www-01.ibm.com/software/awdtools/purifyplus/)套件包括经过充分验证的泄漏检测器和非常好的分析器。不过，我不确定它是否会下降到缓存未命中的级别——你可能需要 VTune。

PurifyPlus 在各种 Unices 和 Windows 上都可用，因此它应该可以满足您的要求，但不幸的是，与 Valgrind 相比，它不是免费的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-16T19:50:17.793

对于简单的分析[gprof](http://www.cs.utah.edu/dept/old/texinfo/as/gprof_toc.html)非常好..

# oracle - 导入 oracle 转储时出错

> ID：638091
> 
> 赞同：2
> 
> 时间：2009-03-12T10:50:14.833
> 
> 标签：oracle, import, dump

我正在尝试将转储导入到同一个 oracle DB 中的两个模式中。遵循解决方法来执行此操作。

我正在尝试使用 INDEXFILE 选项运行 imp 命令，以便能够修改 sql 中的表空间名称。这就是我得到的：

> E:\oracle_10_2\BIN>imp atlantis/atlantis@orcl file=ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp indexfile=index.sql full=y log=imp.log
> 
> 导入：发布 10.2.0.1.0 - 2009 年 3 月 12 日星期四 15:31:44 生产
> 
> 版权所有 (c) 1982, 2005, Oracle。版权所有。
> 
> 连接到：Oracle 数据库 10g 企业版版本 10.2.0.1.0 - 具有分区、OLAP 和数据挖掘选项的生产
> 
> IMP-00002：无法打开 ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp 以读取导入文件：EXPDAT.DMP >

对我来说看起来像是文件权限问题，所以我尝试更改它。

> E:\oracle_10_2\BIN>cacls E:\ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp /p atlantis:F
> 
> 你确定（Y/N）吗？
> 
> 处理文件：E:\ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp
> 
> E:\oracle_10_2\BIN>cacls E:\ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp
> 
> E:\ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp CORP\atlantis:F

但问题仍然存在。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T11:08:11.983

如果您使用的是 Oracle 10g，请考虑使用新的导出/导入工具[Oracle 数据泵](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_overview.htm#i1009203)，您可以在其中使用[REMAP_TABLESPACE](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_import.htm#sthref342)参数。

无论如何，您错过了导出文件的路径（基于授予权限的命令）。然后你写道：

```
file=ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp 
```

代替

```
file=E:\ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp 
```

然后，运行的结果导出命令是：

```
imp atlantis/atlantis@orcl file=E:\ABCD1_EXCLUDE_CLOB_TABS_BAK.dmp indexfile=index.sql full=y log=imp.log 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-15T07:34:34.443

以管理员身份打开窗口命令行 imp user/pass@databasename(listenername) file='DMP path' log=indexfile.log full=y;

不要忘记添加您的数据库或侦听器名称。

# sql-server - 在 t-sql 中计数和分组

> ID：638093
> 
> 赞同：0
> 
> 时间：2009-03-12T10:50:46.627
> 
> 标签：sql-server, tsql

我有一张看起来像这样的桌子

```
CREATE TABLE MyTable(
    [RecordID] [bigint] IDENTITY(1,1) NOT NULL,
    [PortName] [nvarchar](50) NULL,
    [ReceivedEvent] [datetime] NULL,
    [SentEvent] [datetime] NULL,
); 
```

然后数据可以是

```
 RecordID | PortName | ReceivedEvent       | SentEvent
   1        | Port1    | 2009-10-20 10:20:00 | NULL
   2        | Port2    | NULL                | 2009-10-20 10:10:00
   3        | Port2    | NULL                | 2009-10-20 10:02:00
   4        | Port2    | NULL                | 2009-10-20 11:00:00 
```

我现在需要对这张表提出两个问题：

**1）**我需要计算按端口和日期（而不是时间）分组的行数。然而，日期是问题中的一个参数（在这种情况下，它可能是“2009-10-20”）。我还想要每小时的最后一个“活动”

```
 NumberOfRows | PortName | Hour | LastActivityInHour 
   2            | Port2    | 10   | 2009-10-20 10:10:00
   1            | Port2    | 11   | 2009-10-20 11:00:00
   1            | Port1    | 10   | 2009-10-20 10:20:00 
```

**2）**我还需要一个问题做同样的事情，但按天分组。正如我所说的，day 是一个传入参数。在这种情况下，它可能是“2009-10-20”

```
 NumberOfRows | PortName | LastActivityInDay 
   3            | Port2    | 2009-10-20 11:00:00
   1            | Port1    | 2009-10-20 10:20:00 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:16:02.493

由于您的数据模型没有正确规范化，这比它需要的更难看。

```
SELECT
  COUNT(t.RecordID) NumberOfRows,
  t.PortName,
  t.EventHour,
  MAX(t.EventDateTime) LastActivityInHour
FROM
  (
    SELECT
      RecordID,
      PortName,
      COALESCE(ReceivedEvent, SentEvent) EventDateTime,
      DATEPART(hh, COALESCE(ReceivedEvent, SentEvent)) EventHour,
      DATEADD(dd, 0, DATEDIFF(dd, 0, COALESCE(ReceivedEvent, SentEvent))) EventDate
    FROM
      MyTable
  ) t
WHERE
  t.EventDate = DATEADD(dd, 0, DATEDIFF(dd, 0, @TheDateInQuestion))
GROUP BY
  t.PortName,
  t.EventHour
ORDER BY
  t.PortName,
  t.EventHour 
```

执行按日期分组的 SQL 非常相似，我将把它作为练习留给你。;-)

我确信还有其他方法可以获得相同的结果。在这里查看内部查询将有助于清理整个查询。

# python - 问题通过 Python 使用 ADO 将数据插入 MS Access 数据库

> ID：638095
> 
> 赞同：6
> 
> 时间：2009-03-12T10:52:29.290
> 
> 标签：python, ms-access, ado, comtypes

[编辑2：下面的答案中的更多信息和调试...]

我正在编写一个 python 脚本来将 MS Access 数据库导出到一系列文本文件中，以实现更有意义的版本控制（我知道 - 为什么是 Access？为什么我不使用现有的解决方案？假设限制不是技术性质）。

我已经通过 comtypes 库使用 ADO 和 ADOX 成功导出了数据库的全部内容和结构，但是我在重新导入数据时遇到了问题。

我将每个表的内容导出到一个文本文件中，每行都有一个列表，如下所示：

```
[-9, u'No reply']
[1, u'My home is as clean and comfortable as I want']
[2, u'My home could be more clean or comfortable than it is']
[3, u'My home is not at all clean or comfortable'] 
```

以及导入所述文件的以下功能：

```
import os
import sys
import datetime
import comtypes.client as client
from ADOconsts import *
from access_consts import *

class Db:
    def create_table_contents(self, verbosity = 0):
        conn = client.CreateObject("ADODB.Connection")
        rs = client.CreateObject("ADODB.Recordset")
        conn.ConnectionString = self.new_con_string
        conn.Open()
        for fname in os.listdir(self.file_path):
            if fname.startswith("Table_"):
                tname = fname[6:-4]
                if verbosity > 0:
                    print "Filling table %s." % tname
                conn.Execute("DELETE * FROM [%s];" % tname)
                rs.Open("SELECT * FROM [%s];" % tname, conn,
                        adOpenDynamic, adLockOptimistic)
                f = open(self.file_path + os.path.sep + fname, "r")
                data = f.readline()
                print repr(data)
                while data != '':
                    data = eval(data.strip())
                    print data[0]
                    print rs.Fields.Count
                    rs.AddNew()
                    for i in range(rs.Fields.Count):
                        if verbosity > 1:
                            print "Into field %s (type %s) insert value %s." % (
                                rs.Fields[i].Name, str(rs.Fields[i].Type),
                                data[i])
                        rs.Fields[i].Value = data[i]
                    data = f.readline()
                    print repr(data)
                    rs.Update()
                rs.Close()
        conn.Close() 
```

除了数值（双精度和整数）被插入为零外，一切正常。关于问题出在我的代码、eval、comtypes 还是 ADO 的任何想法？

编辑：我已经解决了插入数字的问题 - 将它们转换为字符串（！）似乎解决了双精度和整数字段的问题。

但是，我现在有一个不同的问题，以前被上述内容所掩盖：每行中的第一个字段被设置为 0，无论数据类型如何......有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T15:39:32.367

并找到了答案。

```
 rs = client.CreateObject("ADODB.Recordset") 
```

需要是：

```
 rs = client.CreateObject("ADODB.Recordset", dynamic=True) 
```

现在我只需要看看为什么。只是希望这个问题可以节省其他人几个小时......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:08:47.353

是否`data[i]`被视为字符串？如果您在设置时专门将其转换为 int/double 会发生什么`rs.Fields[i].Value`？

另外，当你打印出`rs.Fields[i].Value`设置后的内容时会发生什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:58:14.053

还没有完整的答案，但在更新期间似乎是一个问题。我在插入过程中添加了一些进一步的调试代码，生成以下内容（更新单行的示例）：

```
Inserted into field ID (type 3) insert value 1, field value now 1.
Inserted into field TextField (type 202) insert value u'Blah', field value now Blah.
Inserted into field Numbers (type 5) insert value 55.0, field value now 55.0.
After update: [0, u'Blah', 55.0] 
```

每个“Inserted...”行中的最后一个值是在调用 rs.Update() 之前调用 rs.Fields[i].Value 的结果。“After...”行显示调用 rs.Update() 后调用 rs.Fields[i].Value 的结果。

更烦人的是它并没有可靠地失败。几分钟后在相同的记录上重新运行完全相同的代码会生成：

```
Inserted into field ID (type 3) insert value 1, field value now 1.
Inserted into field TextField (type 202) insert value u'Blah', field value now Blah.
Inserted into field Numbers (type 5) insert value 55.0, field value now 55.0.
After update: [1, u'Blah', 2.0] 
```

如您所见，在您提交之前，结果是可靠的，然后......不是。

# windows-mobile - 如何解决此“找不到路径”错误？

> ID：638097
> 
> 赞同：1
> 
> 时间：2009-03-12T10:52:41.193
> 
> 标签：windows-mobile

我该如何解决这个移动应用程序开发问题？

连接到数据库时

```
dataSource = \\..datafile.sdf 
```

我收到这个错误

> “找不到路径”

我正在使用 serviceCE dll 进行数据访问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T21:19:20.200

The path you you have typed it is a relative path. Windows CE/Mobile does not support relative paths.

It follows that since there is no concept of a current directory on a Windows Mobile device how would one locate a resource for which only a relative path is known? A .Net program always has access to the modules of which it is composed (usually a .Net component is composed of one module packaged in a DLL or EXE file). The following line will return the absolute path to the currently executing assembly.

string modulePath = this.GetType().Assembly.GetModules()[0].FullyQualifiedName;

with a little more code you can get the directory in which your program is running

Path.GetDirectoryName(this.GetType().Assembly.GetModules()[0].FullyQualifiedName)

Using that information you can build a proper path string to your resource.

**note:** If you are developing using the native APIS use the following: GetModuleFileName(GetModuleHandle(NULL), pszFullPath, MAX_PATH);

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T12:55:09.247

Windows CE 没有相对路径的概念，因此即使您“修复”了无效的相对路径，它也不起作用。您必须使用绝对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T10:57:17.580

我想 \\ 和 .. 之间缺少一些东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T10:59:08.323

“\..”没有意义。它表明您的数据比根文件夹高一级，该文件夹不存在。此外，ctacke 在评论中告诉我 CE 无论如何都不支持相对路径。

如果您的操作系统支持相对路径*，*我的其余答案仍然适用。我会把它留作将来参考（可能，因为很多人似乎在没有先阅读整篇文章的情况下投反对票）一些声誉损失。:-)

如果数据文件比您的应用所在的文件夹高一级，则正确的路径是“..\datafile.sdf”；在某些编程语言中，您必须转义反斜杠，所以它会变成 '..\datafile.sdf'

您的数据实际位于哪里，您的应用程序在哪里？如果应用程序位于 \yourapp\folder\bin 中，并且您的数据位于 \yourapp\folder\data 中，则从应用程序到数据的路径将为“..\data\”。如果数据文件位于 \yourapp\folder 中，则路径为“..\”。同样，根据您使用的语言，您可能必须将反斜杠加倍才能转义它们。

# excel - excel不同意

> ID：638099
> 
> 赞同：0
> 
> 时间：2009-03-12T10:53:30.833
> 
> 标签：excel, vba

在这种情况下我需要你的帮助：

我有：

```
1    11    111    Cat1 a,b,c

2    22    222    Cat2 d

3    33    333    Cat3 e,f

4    44    444    Cat4 g,h,i 
```

而且我要：

```
1    11    111    Cat1 a

1    11    111    Cat1 b

1    11    111    Cat1 c

2    22    222    Cat2 d

3    33    333    Cat3 e

3    33    333    Cat3 f

4    44    444    Cat4 g

4    44    444    Cat4 h

4    44    444    Cat4 i 
```

你能帮我做这个宏吗？我已经写了 5 列，但我需要 20 列的宏，但最好的是我可以选择宏中的列数。

它接近这种情况但有更多列： [Excel Macro - Comma Separated Cells to Rows Preserve/Aggregate Column](https://stackoverflow.com/questions/473553/excel-macro-comma-separated-cells-to-rows-preserve-aggregate-column)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T11:42:32.587

我对VBA了解不多，所以你必须自己弄清楚。但是，我会使用 Text to Columns 将 CSV 部分转换为单个列，然后使用带有 Transpose 选项的选择性粘贴将 abc 列转换为行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:43:56.760

这里有一些注意事项。

```
Sub SplitRows()
strFile = Workbooks(1).FullName
strCon = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strFile _
    & ";Extended Properties=""Excel 8.0;HDR=No;IMEX=1"";"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")
Set rss = CreateObject("ADODB.Recordset")

cn.Open strCon

strSQL = "SELECT * FROM [Sheet4$]"

rs.Open strSQL, cn

For i = 0 To rs.Fields.Count - 1
    If Not IsNumeric(rs.Fields(i)) Then
        rss.Fields.Append rs.Fields(i).Name, adVarWChar, 255
    Else
        rss.Fields.Append rs.Fields(i).Name, adInteger
    End If
Next

rss.Open

Do While Not rs.EOF
    cat = Split(rs.Fields(3), " ")
    a = Split(cat(1), ",")
    For i = 0 To UBound(a)

        rss.AddNew

        For j = 0 To rs.Fields.Count - 1
            If j = 3 Then
                rss(j) = cat(0) & " " & a(i)
            Else
                rss(j) = rs(j)
            End If
        Next

        rss.Update

    Next
    rs.MoveNext
Loop

rss.MoveFirst
Worksheets("Sheet5").Cells(2, 1).CopyFromRecordset rss

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T13:25:12.480

此代码应该是您要查找的代码，该方法`ExpandData(String, String, String)`将数据集的开始列（在本例中为“A”）作为第一个参数，将要复制的数据集的结束列作为第二个参数（在本例为“D”），最后是包含逗号分隔的数据集的列（此处为“E”）。

您可能应该扩展它，以便它也需要一个起始行，或者只是使其成为一个插件公式，它需要一个范围和一列。

希望这可以帮助。

```
Sub ExpandDat()
    ExpandData "A", "D", "E"
End Sub

Sub ExpandData(start_range As String, end_range As String, comma_column As String)
    Const FirstRow = 1
    Dim LastRow As Long
    LastRow = Range(start_range & CStr(Rows.Count)).End(xlUp).Row

    ' Get the values from the worksheet '
    Dim SourceRange As Range
    Set SourceRange = Range(start_range & CStr(FirstRow) & ":" & end_range & CStr(LastRow))

    ' Get the comma seperated values as a different set of values '
    Dim CommaRange As Range
    Set CommaRange = Range(comma_column & CStr(FirstRow) & ":" & comma_column & CStr(LastRow))

    ' Get the values from the actual values '
    Dim Vals() As Variant
    Vals = SourceRange.Value

    ' We need to know the upper and lower bounds of the second dimension in the Vals Array '
    Dim lower As Integer
    Dim upper As Integer
    lower = LBound(Vals, 2)
    upper = UBound(Vals, 2)

    ' Get the comma seperated values '
    Dim Commas() As Variant
    Commas = CommaRange.Value

    ' Loop through the rows in the array and split each comma-delimited list of items and put each on its own row '
    Dim ArrIdx As Long
    Dim RowCount As Long
    For ArrIdx = LBound(Commas, 1) To UBound(Commas, 1)

        Dim CurrList As String
        CurrList = Replace(Commas(ArrIdx, 1), " ", "")

        ' Split the Comma set into an array '
        Dim ListItems() As String
        ListItems = Split(CurrList, ",")

        ' For each value in the Comma Seperated values write the output '
        Dim ListIdx As Integer
        For ListIdx = LBound(ListItems) To UBound(ListItems)
            ' Loop through the values in our source range and output them '
            For Idx = lower To upper
                Range(start_range & CStr(FirstRow + RowCount)).Offset(0, Idx - 1).Value = Vals(ArrIdx, Idx)
            Next Idx

            Range(comma_column & CStr(FirstRow + RowCount)).Value = ListItems(ListIdx)
            RowCount = RowCount + 1

        Next ListIdx

    Next ArrIdx

End Sub 
```

# c++ - Vista中的C/C++编程

> ID：638101
> 
> 赞同：2
> 
> 时间：2009-03-12T10:53:52.937
> 
> 标签：c++, c, ide, windows-vista

我来自 Java 学校，但我也想亲自参与 C/C++ 开发。你能建议：

1.  一个轻量级的初学者IDE [Eg: JCreator for Java]（简单小下载）
2.  一个成熟的高级 IDE [例如：Eclipse for Java]（每个功能和大量下载）
3.  我应该使用 GCC 还是其他编译器？

非常感谢你们！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T10:59:41.550

> 1) 一个轻量级的初学者IDE [Eg: JCreator for Java] (简单小下载)

[带有 CDT 的 Eclipse](http://www.eclipse.org/cdt/)（约 40 MB 下载）或[Visual Studio 2008 Express](http://www.microsoft.com/Express/)版本（安装程序下载 2.6 MB，然后它会从网上获取大量内容）——它是免费的。另外，获取SP1。但是，我仍然建议您看看 Visual Studio。

> 2) 一个成熟的高级 IDE [例如：Eclipse for Java]（每个功能和大量下载）

[带有 CDT 的 Eclipse](http://www.eclipse.org/cdt/)（约 40 MB 下载）或 Visual Studio 2008 Professional（如果您要付费）。

> 3) 我应该使用 GCC 还是其他编译器？

是和不是。取决于你的需要。GNU g++ 非常适合入门。然而，与 CDT 建立联系可能会很困难。

如果你近期打算做专业的Windows编程，最好购买Visual Studio 2008 Pro（并安装SP1）并习惯它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T10:58:49.557

如果您必须在 Vista 中执行此操作，并且它是特定于 Microsoft 平台的，那么没有比 Visual Studio 更好的成熟 IDE。您可以下载用于 C++ 开发的 Visual Studio Express Edition 作为更轻的 IDE（虽然不是那么轻，但它是免费的）。如果您想跨平台使用，带有 GCC 的 Eclipse 也可以很好地工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T10:59:42.753

我建议[Code::Blocks](http://www.codeblocks.org/)。记得下载 codeblocks-8.02 **mingw** -setup.exe，它包括 GCC 编译器和 GDB 调试器。有了它，你就可以开始了:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T11:08:17.270

我同意没有比 Visual Studio 更好的用于 C++ 开发的 Windows IDE。除了免费的 Visual Studio Express，您可能还需要考虑 Visual Studio Standard。它在美国的售价约为 200 美元，除其他优点外，它还允许您使用第三方插件，例如[Visual Assist](http://www.wholetomato.com/)。这些将帮助您进一步加快开发速度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T11:05:45.890

对于真正的轻量级，您可以不使用任何 IDE。抓住[Cygwin ，安装 GCC 并开始在任何文本编辑器（例如](http://www.cygwin.com/)[Crimson Editor](http://www.crimsoneditor.com/)）中编写代码。事实上，我建议您尝试这样做，以了解 C++ 程序是如何在 IDE 后台实际编译的。

您可以获得[Visual Studio Express C++](http://www.microsoft.com/express/download/)，这是一个适合初学者的好包。可能最容易开始使用它。

您可以使用 CDT 获取 Eclipse 并使用 Cygwin GCC 工具，但这在某些方面不如 Visual Studio。

然后是[CodeBlock](http://www.codeblocks.org/)，我听说过好东西，但不知道它与 Visual Studio 或 Eclipse/CDT 相比如何。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T03:57:13.433

您想只学习 C++ 还是使用 C++ 与 Vista 组件进行交互？您问题的标题是 Vista，但您的描述是询问要使用哪个 IDE。

我同意使用 Visual Studio C++ Express 是一个很好的起点。它基本上将为您提供使用 C++ 编写 Windows 应用程序的基础。你说你来自 JAVA 世界，如果你有 C# 或 VB.NET 的经验，不要指望所有的设计者和向导都会使用 C++。任何做过 C++ GUI 工作的人都知道，情况并非总是如此。不要让你气馁，有设计师，只是不是为了一切。

如果你想学习如何通过 C++ 与 Windows 交互，这里是 VC++ 主站点，[这里](http://msdn.microsoft.com/en-ca/visualc/default.aspx)有 how-do-i 视频，如果你还没有安装 SP1，也可以在这里下载功能包[，](http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&displaylang=en)[除了](http://msdn.microsoft.com/en-ca/visualc/bb496952.aspx)功能区化 MFC，他们在 STL 中包含了 Boost，这太棒了。最后，导游在[这里](http://msdn.microsoft.com/en-ca/library/ms235630.aspx)。

另外，从技术上讲，您不需要 MFC 来编写 GUI 应用程序，您可以直接调用 Win32 API 函数，但 MFC 是一个基础，并且会有所帮助。

那应该让你开始。如果您需要更多帮助，请发表评论。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T11:08:35.650

我同意上面的海报。对于 microsoft 平台特定的开发，Visual Studio 环境是迄今为止最好的。速成版很好，但如果我没记错的话，它们不附带win32 SDK，所以你仍然不能用它制作windows GUI程序（官方）......

如果你只想学习 C++，gcc/g++ 是一个很棒的免费编译器，一个带有语法高亮的编辑器就足够了。我发现 IDE 只会为较大的项目增加价值，对于简单的测试/学习项目，IDE 并不是必需的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T16:27:46.510

您提到您了解 Eclipse for Java。如果您对 Eclipse for Java 有任何经验，那么您可以通过使用 Eclipse 的 CDT (C/C++ Development Toolkit) 插件将大部分经验用于您的 C/C++ 开发。

我强烈建议将 Eclipse 与 CDT 一起使用，而不是使用 Visual Studio，因为如果您想要进行任何 Linux 开发，那么任何花在学习 Visual Studio 上的时间都会浪费掉。

...

我忘了提到带有 CDT 的 Eclipse 具有完整版 VS 所具有的**所有**重要特性（而且可能更多）......但不花任何钱。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T03:13:56.113

我比较偏爱我多年来一直使用的 Code Gear（以前称为 Borland）C++ 编译器系列。他们最近发布了一个名为[Turbo Explorer的免费“社区”插件](http://www.turboexplorer.com/cpp)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T03:31:00.113

Netbeans 也是非常好的 IDE，其中包含许多未来。

# .net - 我怎么知道 dll 不是调试版本

> ID：638104
> 
> 赞同：5
> 
> 时间：2009-03-12T10:54:29.550
> 
> 标签：.net

我如何确定我的生产服务器使用发布构建 dll。有没有办法在 dll 中找到该信息？

* * *

副本：

*   [如何判断 .net 应用程序是在 DEBUG 还是 RELEASE 模式下编译的？](https://stackoverflow.com/questions/194616/how-to-tell-if-net-app-was-compiled-in-debug-or-release-mode)

*   [如何检查 DLL 是否经过调试编译](https://stackoverflow.com/questions/290080/how-to-check-if-dll-is-debug-compiled)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T11:17:43.457

如果是 ac# DLL，那么您可以使用 ildasm (Program Files\Microsoft SDKs\Windows\v6.0A\bin\ildasm.exe) 来查找此信息。

1) 将 DLL 拖入 ILDASM

2) Dbl-单击清单

3) 寻找：

// .custom 实例 void [mscorlib]System.Diagnostics.DebuggableAttribute::.ctor(valuetype [mscorlib]System.Diagnostics.DebuggableAttribute/DebuggingModes) = (01 nn nn nn nn nn nn nn)

4) 对于调试 DLL，它将是 (01 00 07 01 00 00 00 00) 和发布 (01 00 02 00 00 00 00 00) 或 (01 00 03 00 00 00 00)

如果您需要任何进一步的信息，请告诉我！顺便说一句，这显然是非编程解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T11:24:57.840

在您的 AssemlyInfo.cs 中，您可以包含以下内容：

```
#if DEBUG
[assembly: AssemblyDescription("Your description - Debug")]
#else
[assembly: AssemblyDescription("Your description")]
#endif 
```

当使用文件资源管理器上的内置属性对话框时，这将很容易看到。

# c# - 引用正则表达式中已经存在的组，c#

> ID：638113
> 
> 赞同：1
> 
> 时间：2009-03-12T10:56:35.817
> 
> 标签：c#, regex, shrink

我有一个正则表达式

```
%word% can occur multiple times, separated by a "<" 
```

%word% 被定义为`".*?"|[a-zA-Z]+` 我写的

```
(".*"|[a-zA-Z]+)([<](".*"|[a-zA-Z]+))* 
```

有什么办法可以使用捕获组缩小它？

```
(".*"|[a-zA-Z]+)([<]\1)*, 
```

但我不认为`\1`可以使用它，因为它意味着重复第一次捕获，因为我不知道捕获了什么，因为它可以是带引号的字符串或单词。

任何类似的东西我都可以用来指代匹配先前编写的组。我在 C# 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:26:36.197

使用 String.Format 来避免重复，并且没有办法从字面上重复正则表达式组

```
String.Format("{0}([<]{0})*", @"("".*""|[a-zA-Z]+)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T10:15:31.147

由于该功能尚不支持，我制作了一个字符串替换器，在其中我使用 %% 编写了我需要用正则表达式替换的特定单词，然后编写了程序用为文本定义的正则表达式替换它。

# c# - 如何将 PayPal 与 ASP.NET 集成？

> ID：638114
> 
> 赞同：24
> 
> 时间：2009-03-12T10:56:38.127
> 
> 标签：c#, asp.net, paypal

我如何将 PayPal 与 ASP.NET 集成，您是否有任何网站可以帮助我入门或任何教程的链接？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T11:20:51.190

[从Rick Strahl](http://www.west-wind.com/presentations/PayPalIntegration/PayPalIntegration.asp)阅读 asp.net 中的 paypal 集成

更新：有用于 web 矩阵的[PayPal Helper](http://nuget.org/packages/PayPal.Helper)，可以很容易地集成到 asp.net mvc 或 asp.net web 表单中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-12T11:03:12.417

为此，您必须使用[Paypal IPN](https://www.paypal.com/ipn)。我的网站使用 Perl 运行，但它的基本工作方式如下：

1.  客户在我的网站上填写了他们的姓名、地址、电子邮件的订单。
2.  客户被重定向到 Paypal
3.  通过 Paypal 成功付款后，Paypal 调用我的 IPN 兼容脚本
4.  我的脚本向我发送一封电子邮件，通知我有关已完成的订单

如果客户在 30 分钟左右没有付款，我的数据库还会向他发送一个提醒，其中包含相应订单的 Paypal 付款链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-12T15:51:02.317

下载 ASP.NET E-Commerce Start Kit，现在是“DashCommerce”。它已实施 PayPal。[http://dashcommerce.org/](http://dashcommerce.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-23T10:25:34.880

Michael987 将来自不同论坛的帖子放在一起，提出了一个[对他很有效的解决方案](http://forums.asp.net/t/1236969.aspx/1?Paypal+Encrypted+Website+Payments+EWP+Solution)。

NathanRidley 整合了上面链接中的代码，并[在 Github 上发布了一个开源库](https://github.com/axefrog/XMerchant)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-07T22:03:53.740

您可以在 C# (asp.net) 中尝试这个 Paypal NVP API 示例：http: [//brad.w3portals.com/2008/02/paypal-nvp-api-example-in-c-aspnet.html](http://brad.w3portals.com/2008/02/paypal-nvp-api-example-in-c-aspnet.html)

试图给出一个简单的例子来让你快速上手。贝宝 SDK 示例不是那么好。干杯。

# c# - 需要互斥

> ID：638115
> 
> 赞同：2
> 
> 时间：2009-03-12T10:56:51.527
> 
> 标签：c#

不影响集合的代码需要互斥

```
 List<string> _itemColection = new List<string>();
    object _criticalSection = new object();

    private void Add(string item)
    {
        lock (_criticalSection)
        {
            _itemColection.Add(item);
        }
    }

    private void Remove(string item)
    {
        lock (_criticalSection)
        {
            _itemColection.Remove(item);
        }
    }

    private void GetCount()
    {
        ///Is it lock is reuired here?
        return _itemColection.Count;
    }

    //Thread method
    private void Run()
    {
        lock (_criticalSection)
        {

            foreach (string item in _itemColection)
            {
                ///Some operation
            }
        }
    } 
```

GetCount() 方法中是否需要 Mutex。收藏价值没有改变

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T10:59:27.213

是的，你应该锁在那里。您正在请求访问共享数据，如果您没有某种内存屏障，则无法保证它将是“新鲜”信息。记忆模型有时可能是一个真正的心灵弯曲者:)

此外，虽然我希望*这* `List<T>.Count`是一个非常简单的操作，但*理论上*它可能很复杂 - 如果另一个线程在计算计数时正在改变东西（例如添加一个项目，然后需要一个缓冲区扩展），你可以*理论上*会遇到麻烦。

基本上，除非某个类型*声称*对您的特定场景是线程安全的，否则我始终确保您不会同时对其执行两个操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T11:01:53.747

在实践中它可能不需要，但为了安全起见，我自己会包括它。_itemCollection.Count 是一个属性，因此您实际上是在调用集合上的一个函数，并且您无法保证该函数在做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:00:40.347

简单的答案是肯定的，因为这些值可能会发生变化，并且您将没有最新的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T11:01:27.820

这是一个关于并发性的好问题..

在我看来，当你存在一些并发时，总是需要使用锁。

编辑

我们只是在需要更改某些信息的操作中使用锁定，而从不需要在只读对象中使用它。

最好的祝福

# windows - 类似 Cron 的 Windows 系统？

> ID：638124
> 
> 赞同：4
> 
> 时间：2009-03-12T11:00:23.517
> 
> 标签：windows, cron

我正在寻找相当于 Windows 的 Cron 系统。这个想法是能够安排一个触发器并监控它是否成功运行。

系统需要做的事情如下：

*   它应该能够触发 Win32 COM 对象和/或可执行文件。
*   它应该能够触发 .NET COM 对象和/或 .NET 可执行文件。
*   它应该能够触发以任何语言编写的脚本，无论是基于本机框架（Python、Perl、Ruby）还是基于 DLR（IronPython、Ruby.NET 等）
*   脚本应介于需要几秒钟的简单脚本和可能需要半小时的相当繁重的脚本之间。

监控方面至关重要。所以基本上我正在寻找以下内容：

*   如果脚本或可执行文件失败，则应发送电子邮件或其他通知机制。
*   应该记录每个触发器，以便我们可以回顾一下代码何时失败。
*   故障应该很容易通过某种调试输出或堆栈跟踪来跟踪。

是否有任何 Windows 开发人员创建了这样的系统？我知道在 UNIX 世界中有 Cron，但在 Windows 世界中呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T11:11:48.543

在命令提示符下键入“at”

```
> at /?
The AT command schedules commands and programs to run on a computer at
a specified time and date. The Schedule service must be running to use
the AT command.

AT [\\computername] [ [id] [/DELETE] | /DELETE [/YES]]
AT [\\computername] time [/INTERACTIVE]
    [ /EVERY:date[,...] | /NEXT:date[,...]] "command"

\\computername     Specifies a remote computer. Commands are scheduled on the
                   local computer if this parameter is omitted.
id                 Is an identification number assigned to a scheduled
                   command.
/delete            Cancels a scheduled command. If id is omitted, all the
                   scheduled commands on the computer are canceled.
/yes               Used with cancel all jobs command when no further
                   confirmation is desired.
time               Specifies the time when command is to run.
/interactive       Allows the job to interact with the desktop of the user
                   who is logged on at the time the job runs.
/every:date[,...]  Runs the command on each specified day(s) of the week or
                   month. If date is omitted, the current day of the month
                   is assumed.
/next:date[,...]   Runs the specified command on the next occurrence of the
                   day (for example, next Thursday).  If date is omitted, the
                   current day of the month is assumed.
"command"          Is the Windows NT command, or batch program to be run. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T11:05:14.673

您应该能够将计划任务用于上述所有操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T12:40:16.457

我建议[在 Vista/Server 2008 中查看修订后的 Task Scheduler 2.0](http://en.wikipedia.org/wiki/Task_Scheduler#Task_Scheduler_2.0)。它比以前版本的 Windows 中的 1.0 强大得多，现在能够

*   基于事件的触发器，例如每次导致应用程序事件代码 1053
*   失败任务的触发器（对我来说最大的补充）
*   更多内置操作，例如发送电子邮件而不是调用 blat.exe

查看您的清单，我相信您正在寻找的一切都已经存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T11:06:03.550

您看过 Windows 调度程序吗？它似乎满足了您的大部分（如果不是全部）要求，并且已经包含在操作系统中。[您可以在MSDN](http://msdn.microsoft.com)中找到它的文档

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T12:02:32.430

如果您想要一个脚本来“触发 Win32 COM 对象和/或可执行文件”、“触发 .NET COM 对象和/或 .NET 可执行文件”、记录失败并通过电子邮件通知失败，这听起来像是[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)的工作。

PowerShell 没有为您完成日志记录和发送电子邮件，而是一种编程语言，您可以在其中相当轻松地记录或发送电子邮件（或其他）。

我已经安排 PowerShell 脚本使用“at”/“Task Scheduler”服务成功运行。这是一个很好的组合。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T16:46:41.847

看看[nnCron](http://www.nncron.ru/)。我正在使用精简版。它有一个 unix crontab 语法。有一个日志文件，但至于更高级的监控方面，由您的脚本/应用程序提供详细信息，例如。返回结果代码（将被记录）。

nnCron Lite 是我发现的最好的 windows cron 克隆（免费，无 perl 要求，crontab，错过的任务，作为隐藏窗口运行，设置环境变量 - 对 postgres “dump all”工具等有用）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T11:06:16.077

看看这里：[Cron for Windows](http://www.kalab.com/freeware/cron/cron.htm)。还有一些为（免费）DOS 移植的类似 Cron 的软件，应该可以在 Windows 上运行，但我不记得名字了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T12:32:36.693

您是否尝试过将 JIT-Scheduler 与 PowerShell 结合使用？

[http://shareme.com/download/jit-scheduler.html](http://shareme.com/download/jit-scheduler.html)

# user-interface - 是否有用于鼻子测试的 gui

> ID：638127
> 
> 赞同：5
> 
> 时间：2009-03-12T11:01:05.900
> 
> 标签：user-interface, nosetests

在过去的几个月里，我一直在使用鼻子测试来运行我的 Python 单元测试。

它确实可以完成这项工作，但它对于直观地查看哪些测试正在运行或正在破坏并不是很好。

我使用了其他几个基于 GUI 的单元测试框架，它们提供了单元测试状态的可视化快照，并提供了向下钻取功能以获取详细的错误消息。

Nosetests 将其大部分信息转储到控制台，让开发人员筛选细节。

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-30T13:23:01.143

您可以使用[rednose](https://github.com/JBKahn/rednose)插件为您的控制台着色。有了它，视觉反馈要好得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-18T00:37:29.887

我使用 Trac + Bitten 进行持续集成，这是相当复杂的设置，需要大量时间来进行 RTFM、设置和维护一切，但我可​​以获得包含失败测试和错误消息以及失败测试图表的漂亮可视化报告，随着时间的推移，pylint 问题和代码覆盖率。

[Bitten](http://bitten.edgewall.org/)是 Trac 的持续集成插件。它具有主从架构。Bitten master 与 Trac 集成并一起运行。Bitten slave 可以在任何与 master 通信的系统上运行。它会定期轮询 master 以获取构建任务。如果有一个待处理的任务（有人最近提交了一些东西），master 会向 slave 发送类似于 ant 的 build.xml 的“build recipe”，slave 会按照这个 recipe 并返回结果。配方可以包含诸如“从该存储库中签出代码”、“执行此 shell 脚本”、“在此目录中运行鼻子测试”之类的指令。然后构建报告和统计信息显示在 Trac 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T13:07:09.397

我知道这个问题是 3 年前提出的，但我目前正在开发一个 GUI，以便在我参与的项目中更容易使用鼻子测试。

我们的项目使用[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro)，这使得从这个 GUI 开始非常简单，因为它提供了创建界面所需的一切。我使用 Python 的时间不长，但它相当容易掌握，所以如果你知道自己在做什么，只要你有时间，它会是完美的。

您可以将 PyQt 设计器中创建的 .UI 文件转换为 python 脚本：

`pyuic4 -x interface.ui -o interface.py`

[您可以在这里](http://zetcode.com/tutorials/pyqt4/)获得一些很好的教程来感受 PyQt 。希望对某人有所帮助:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-20T12:36:43.747

我喜欢在我的编辑器旁边打开第二个终端，在其中我只是运行一个循环，每次任何文件更改时都会重新运行鼻子测试（或任何测试命令，例如普通的旧单元测试）。然后，您可以在编辑器窗口中保持焦点，同时在每次您在编辑器中点击“保存”时看到测试输出更新。

我不确定 OP 的“向下钻取”是什么意思，但我个人从测试输出中需要的只是失败回溯，这当然会在测试失败时显示。

当您的代码和测试编写良好时，这尤其有效，因此绝大多数测试只需几毫秒即可运行。我可能会在编辑或调试时按照上述循环运行这些快速单元测试，然后在最后提交之前手动运行任何运行时间更长的测试。

您可以使用 Bash 'watch' 手动重新运行测试（但这只是每 X 秒运行一次。这很好，但它还不够快，无法让我开心。）

或者我写了一个快速的python包'rerun'，它轮询文件系统的变化，然后重新运行你给它的命令。轮询更改并不理想，但它很容易编写，完全跨平台，如果您告诉它每 0.25 秒轮询一次，它会相当敏捷，即使是大型项目也不会给我带来任何明显的延迟或系统负载（例如 Python 源代码树），即使在复杂的情况下也能工作（见下文。） [https://pypi.python.org/pypi/rerun/](https://pypi.python.org/pypi/rerun/)

第三种选择是使用更通用的“等待文件系统更改”程序，例如“看门狗”，但这似乎对我的需求很重要，而且像这样监听文件系统事件的解决方案有时不能按我预期的那样工作（例如如果 Vim 通过将 tmp 保存到其他地方然后将其移动到适当位置来保存文件，则有时发生的事件不是您所期望的。）因此“重新运行”。

# objective-c - 如何在 Objective-C 中声明一个字符串类型的二维数组？

> ID：638129
> 
> 赞同：25
> 
> 时间：2009-03-12T11:01:28.037
> 
> 标签：objective-c, arrays, nsstring

如何在 Objective-C 中声明字符串类型的二维数组？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-12T11:15:12.903

首先，您可能会考虑使用一个类来保存您的内部数组的字符串，或者从 plist 文件中加载它（在其中很容易制作一个二维字符串数组）。

对于直接声明，您有几个选择。如果要使用 NSArray，则必须手动创建如下结构：

```
NSMutableArray *strings = [NSMutableArray array];
for(int i = 0; i < DESIRED_MAJOR_SIZE; i++)
{
    [strings addObject: [NSMutableArray arrayWithObject:@"" count:DESIRED_MINOR_SIZE]];
} 
```

或者，使用数组字面量，您可以获得一个*不可变*的版本，如下所示：

```
NSArray *strings = @[ @[ @"A", @"B", @"C" ], @[ @"D", @"E", @"F" ], @[ @"G", @"H", @"I" ] ] 
```

然后你可以像这样使用它：

```
NSString *s = [[strings objectAtIndex:i] objectAtIndex:j]; 
```

初始化有点尴尬，但如果你想使用 NSArray 方法，这是要走的路。

另一种方法是使用 C 数组：

```
NSString *strings[MAJOR_SIZE][MINOR_SIZE] = {0}; // all start as nil 
```

然后像这样使用它：

```
NSString *s = strings[i][j]; 
```

这不那么尴尬，但是当您将它们放入数组和从数组中删除时，您必须小心*保留/复制*和*释放值。*（当然，除非您使用 ARC！） NSArray 会为您执行此操作，但对于 C 样式的数组，您需要执行以下操作来替换数组：

```
[strings[i][j] release];
strings[i][j] = [newString retain]; 
```

另一个区别是你可以将 nil 放在 C 风格的数组中，但不能放在 NSArrays 中——你需要为此使用 NSNull。另请查看 Stack Overflow 问题*[Cocoa: Memory management with NSString](https://stackoverflow.com/questions/329977/cocoa-memory-management-with-nsstring)*以了解有关 NSString 内存管理的更多信息。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-07-08T14:40:42.263

如果要声明和初始化字符串的二维数组，可以这样做：

```
NSArray *myArray = [NSArray arrayWithObjects:
                       [NSArray arrayWithObjects:@"item 1-1", @"item 1-2", nil],
                       [NSArray arrayWithObjects:@"item 2-1", @"item 2-2", nil],
                       [NSArray arrayWithObjects:@"item 3-1", @"item 3-2", nil],
                       [NSArray arrayWithObjects:@"item 4-1", @"item 4-2", nil],
                       nil]; 
```

这样做的好处是为您提供了一个不可变数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-21T10:21:15.577

我可能是在做自我广告，但我写了一个包装器，以`NSMutableArray`方便用作 2D 数组。它在 GitHub 上可用，如下所示`CRL2DArray`。[https://github.com/tGilani/CRL2DArray](https://github.com/tGilani/CRL2DArray)

# entity - ADO 实体框架创建不需要的实体键

> ID：638133
> 
> 赞同：3
> 
> 时间：2009-03-12T11:02:55.303
> 
> 标签：entity, key, ado.net-entity-data-model

我需要使用无法更改的数据库中的表（使用链接服务器）。所以我的架构的一部分是这些表的视图，我无法在我的数据库中创建 FK。

当我在 ADO.NET Entity Framework 中创建关联时，我遇到了问题，因为来自外部 DB 的表上的第二列上有一个索引，而 EF 正在为它创建一个实体键（它是记录-我认为他们只是想加快订购速度）。

当我从 EF 实体中的该列中取出实体键时，它抱怨我需要它，因为基础表上有一个键。如果我把它留在里面，我不能把它映射到 EF 的表映射中的任何东西上。

请问有谁知道我应该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-24T05:15:49.960

您必须编辑 XML 并从键中删除该列。在 <edmx:StorageModels> 部分（SSDL 内容）中找到 <EntityType> 标记。删除 <Key> 中实际上不是主键一部分的任何 <PropertyRef>。

完成此操作后，您可以将设计器中相应标量属性上的“Entity Key”设置为 false，EF 不会生气。您也不会被要求在关联中映射此列。

# iis - IIS 7 'Server.CreateObject 失败'

> ID：638138
> 
> 赞同：1
> 
> 时间：2009-03-12T11:04:44.143
> 
> 标签：iis, iis-7, asp-classic, windows-vista

我已经在我的工作站上安装了 IIS7 并启用了 IIS6 兼容性，因此我可以测试经典的 asp 页面（对于工作中的一些旧项目）。

有些页面可以工作，但有些则不能。

我收到：

```
Serverobject error 'ASP 0177 : 800401f3'

Server.CreateObject failed

/master.central.be/master_connection.asp, line 55

800401f3 
```

在那条线上我有：

```
Set dicTalenLabels = Server.CreateObject("Scripting.Dictionary") 
```

有人知道如何解决这个问题吗？

编辑：

正如 Michael Pryor 所建议的，我运行了一个具有类似代码的 vbscript 并且它是成功的。所以它可能与权限有关。目前正在尝试找出确切的文件...

我需要将 IUSR 添加到 scrrun.dll 吗？尝试时，尽管我是管理员，但我没有权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T23:01:54.847

编辑：他正在运行 32 位 vista，所以这绝对不是 64 位问题。

制作一个 test.vbs 文件并将其放入其中

Dim o: Set o = CreateObject("Scripting.Dictionary")

然后像这样运行它

cscript.exe 测试.vbs

它会给你同样的错误吗？

如果是这样，则 regsvr32 失败或它通常放入注册表中的注册表项有问题。

如果它没有失败，很可能您正在运行您的 asp 页面的用户（默认情况下它是 IUSR_machinename）对其所需的注册表项或实际的 .dll 没有权限

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T11:27:27.677

0x800401f3 表示“Scripting.Dictionary”不正确或找不到。Scripting.FileSystemObject 由同一个 dll 文件提供，我知道一些主机通过取消注册 dll 文件来禁用它，这也会禁用 Dictionary 对象。你能检查一下 Scripting.FileSystemObject 是否有效吗？

这两个对象都由 Windows\System32\scrrun.dll （或 Windows\SysWOW64\scrrun.dll 如果您在 64 位主机上执行 32 位）提供。检查此文件的权限，并验证您的 asp 脚本执行的权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:59:09.887

看一眼：

*   [IIS7 上的经典 ASP 开发人员提示](http://blogs.iis.net/bills/archive/2007/05/21/tips-for-classic-asp-developers-on-iis7.aspx)
*   [为经典 ASP 开发人员提供的更多提示和故障排除帮助](http://blogs.iis.net/bills/archive/2009/02/20/more-tips-and-troubleshooting-help-for-classic-asp-developers.aspx)

这两个链接都来自 Bill Staples 的博客，他是 IIS 方面的负责人之一，当我尝试启动和运行 Classic ASP 时，第一个链接中的提示对我进行了整理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-03T21:15:32.230

我发现对系统对象的调用，例如

```
set rs = server.createobject("adodb.recordset") 
```

和

```
set fs = server.createobject("scripting.filesystemobject"); 
```

在生产服务器上运行数周后有时会失败。这不是一个很好的解决方案，但手动回收应用程序池可以解决它。此外，将应用程序池设置为每隔几个小时回收一次是一种保持新鲜的方法。只要确保您不会意外注销所有人（如果使用会话作为凭据）。

可能是开发人员忘记“关闭”和“设置为空”对象。您使用“设置”创建的任何对象都需要在使用后通过将它们设置为空来处理。

```
set rs = server.createobject("adodb.recordset")
rs.open sql, db, 1, 3       ' adOpenKeyset, adLockOptimistic
' some process here
rs.close
set rs = nothing 
```

# c# - C#axis2 客户端

> ID：638142
> 
> 赞同：1
> 
> 时间：2009-03-12T11:05:32.613
> 
> 标签：c#, web-services, soap, client

我是 c# 语言的新手。我看到您将 c# 客户端应用程序编写到axis2 Web 服务。我还想知道我如何为axis2 应用程序编写C# 客户端

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T12:12:09.943

对于任何新的 Web 服务开发，我建议您使用 WCF 而不是使用“添加 Web 引用”获得的旧式 ASMX Web 服务框架。请改用“添加服务参考”。ASMX 即将过时，因为它只需要关键的安全修复。

许多 AXIS2 服务配置为启用 WS-Security，而 WCF 是处理这些服务的唯一实用方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T11:07:19.083

我相信 Axis 以正常方式公开 WSDL，因此您应该能够使用 Visual Studio 中的“添加 Web 引用”，将其指向相关的[Axis WSDL URL](http://ws.apache.org/axis/java/user-guide.html#WSDLObtainingWSDLForDeployedServices)，并使用自动生成的客户端代理。

[我似乎记得使用null vs empty arrays](http://www.ibm.com/developerworks/webservices/library/ws-array.html)有一些微妙之处，但大多数情况下它工作正常 - 或者当我几年前最后一次尝试时，无论如何。

# php - 通过 onClick javascript 函数使用 PHP 更新 MySql 数据库

> ID：638147
> 
> 赞同：7
> 
> 时间：2009-03-12T11:06:05.110
> 
> 标签：php, javascript, mysql, ajax

我正在创建一个针对儿童的学习新单词的网络游戏。

我有一组四个链接，每个链接显示从我的数据库中检索到的特定单词和一条线索，我需要检查已选择的单词是否与该线索的正确单词匹配。

我知道由于 onClick 功能我需要使用 javascript，并且我可以成功检查所选单词是否与正确的单词匹配。但是，如果单词匹配正确，我需要更新数据库中保存的分数，因此我需要使用 php.ini。

据我所知，这意味着我必须使用 AJAX，但我找不到任何人使用 AJAX onClick 链接然后更新数据库的好例子。

我试图这样做......但它可能完全错误，因为我无法让它正常工作：

```
//This is my link that I need to use in my game.php file where $newarray[0] is that answer I want to check against $newarray[$rand_keys]

<a onClick=originalUpdateScore('$newarray[0]','$newarray[$rand_keys]')>$newarray[0]</a> 
```

//我在 score.js 文件中的 ajax 尝试

```
var xmlHttp;

function originalUpdateScore(obj,corr){
    xmlHttp=GetXmlHttpObject();
if (xmlHttp==null)
{
    alert ("Browser does not support HTTP Request");
    return;
}

if(corr == obj){

var url="getscore.php";
//url=url+"?q="+str;
//url=url+"&sid="+Math.random();
xmlHttp.onreadystatechange=stateChanged;
//xmlHttp.open("GET",url,true);
xmlHttp.open(url,true);
xmlHttp.send(null);

    alert('Correct');

}
else
{
    alert('AHHHHH!!!');
}

window.location.reload(true); 
```

}

```
function stateChanged() 
    { 
    if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")
    { 
        document.getElementById("txtHint").innerHTML=xmlHttp.responseText;
    } 
}
function GetXmlHttpObject()
{
    var xmlHttp=null;
    try
    {
        // Firefox, Opera 8.0+, Safari
        xmlHttp=new XMLHttpRequest();
    }
    catch (e)
    {
        //Internet Explorer
        try
        {
            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
        }
        catch (e)
        {
            xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
    }
return xmlHttp; 
```

}

```
//attempting to update the database in a getscore.php file

<?php
//$q=$_GET["q"];
include("dbstuff.inc");
$con = mysqli_connect($host, $user, $passwd, $dbname)
or die ("Query died: connection");

$sql= "UPDATE `temp` SET `tempScore`= `tempScore`+1 WHERE (temp.Username='$_SESSION[logname]')";

$showsql = "SELECT `tempScore` FROM `temp` WHERE (temp.Username='$_SESSION[logname]')";
$result = mysqli_query($con, $showsql);

echo "$result";

mysqli_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-12T11:29:04.693

我强烈建议正确学习 AJAX - 它不会花你很多时间，但会帮助你了解你能做什么和不能做什么。

通过 AJAX 从网页更新数据库是很常见的。我建议使用[jQuery](http://jquery.com)（一个 JavaScript 库）来简化你的 JavaScript 开发。[这里](http://www.developertutorials.com/tutorials/ajax/getting-started-with-ajax-in-jquery-8-05-11/page1.html)对 jQuery 和 AJAX 有很好的介绍。

基本上，jQuery 会为您编写大量样板代码。你最终会写的是这样的：

```
function updateScore(answer, correct) {
  if (answer == correct) {
    $.post('updatescore.php');
  }
}

...

<a onclick="updateScore(this, correct)" ...> </a> 
```

您在这里所做的是在答案正确时向updatescore.php 发送POST 请求。

然后，在你的updatescore.php中，你只需要像你已经做的那样有PHP代码，它将更新数据库中的分数。

你显然可以做比这更复杂的事情，但希望这足以让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T10:22:53.157

我注意到你有“window.location.reload(true);” 在你的代码中。为什么？这似乎会让事情变得不正常。

您应该尝试分析您的程序以找出问题所在。然后，您将能够向我们提出一个非常具体的问题，例如“为什么当我单击此链接时 Firefox 不触发 onClick 处理程序”，而不仅仅是发布三页代码。当您粘贴这么多代码时，我们很难找到您的错误。

所以这里是你应该问的问题：

1.  **我的 HTML 是否被正确解析？** 对我来说，它看起来可能无法正确解析，因为您没有在 onClick 的值周围加上引号。您应该使用引号，例如： onClick="..." 要确定您的 HTML 是否被很好地解析，您可以使用 Firefox 的 View->Source 功能并查看它打印的颜色。

2.  **我的 onClick 处理程序是否被调用？** 看起来您正在有效地使用 alert()，这很好。

3.  **请求是否真的被发送到我的服务器？** 要确定这一点，您应该使用 Firefox，并安装[Firebug](http://getfirebug.com/)扩展。在“网络”面板中，它将显示您的页面正在发出的所有 AJAX 请求，并将显示从服务器返回的结果。

4.  **我服务器上的脚本做对了吗？**因此，在服务器端，您现在可以添加诸如“echo 'hello world';”之类的行。您将在 Firebug Net 面板中看到该输出，这将帮助您调试服务器端脚本的行为。

5.  **我的 stateChanged 函数是否被调用？** 再次使用 alert() 语句，或写入[Firebug 的调试控制台](http://getfirebug.com/console.html)。

一旦你缩小了你的问题，试着把你的代码减少到*最简单*但仍然失败的代码。然后向我们展示代码并准确告诉我们错误的症状是什么。

另一方面，我推荐阅读这本书：[Javascript: The Deinitive Guide, 5th Edition by O'Reilly](http://oreilly.com/catalog/9780596101992/)。它涵盖了很多很酷的东西，比如 AJAX 和闭包。它花费 50 美元，但绝对是一笔不错的投资，因为它以比您从免费网站获得的更连贯的方式解释事物。

# sql-server-2005 - Sql Server INSERT 范围问题

> ID：638149
> 
> 赞同：0
> 
> 时间：2009-03-12T11:06:29.490
> 
> 标签：sql-server-2005

以前可能有人问过这个问题，但是要搜索限制搜索结果的术语确实很难...

采用以下 SQL 片段：

```
declare @source table (id int)
declare @target table(id int primary key, sourceId int)

set nocount on

insert into @target values (0,0)

insert into @source(id) values(1)
--insert into @source(id) values(2)

set nocount off

insert into @target select (select max(id)+1 from @target), s.id from @source s

select * from @target 
```

这显然执行没有错误，但现在取消注释第二个插入行并发生以下错误：

```
Msg 2627, Level 14, State 1, Line 15
Violation of PRIMARY KEY constraint 'PK__#7DB3CB72__7EA7EFAB'. Cannot insert duplicate key in object 'dbo.@target'. 
```

我意识到插入语句很可能是针对@target 表的快照执行的，因此`(select max(id)+1 from @target)`将始终返回值 1 - 导致上述违规错误...

除了使用光标之外，还有什么办法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:08:14.777

您可以使用标识列（这正是它们的用途）

```
declare @target table(id int IDENTITY(1,1), sourceId int) 
```

如果您的问题是在执行插入之前“计算”了 select 子句，那么使用单个 SQL 请求将无法解决这个问题

我认为这是设计使然；为了避免重复插入，索引 id 必须在插入期间计算，而不是在选择期间计算。这就是 IDENTITY 关键字的确切用途。

如果你想一次插入一个选择，你必须编写单独的请求（例如使用游标，但你会失去原子性，并且必须使用适当的锁定关键字来避免竞争条件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T17:25:38.133

将您的插入语句更改为以下内容：

> 插入@target select (select max(id) from @target) + (ROW_NUMBER() OVER(ORDER BY s.id)), s.id from @source s

这应该适用于这种特定情况，但我会小心泛化它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:12:24.063

您确定新 PK 值的方式是等待发生的竞争条件。如果您的数据库处于高负载状态，并且同时插入多条记录，您将获得意想不到的结果。

为什么不直接使用标识列，让数据库处理新主 ID 的分配？

或者，您可以创建某种元表，它保存数据库中每个表的记录，并且该记录包含应该用作表中主 id 的下一个值。然后，您必须确保每次创建新记录时，还更新元表中的下一个值（并且您应该确保执行适当的锁定），但是，我认为这没有附加值方法与使用身份列。

# python - Ruby on Rails 与 Python

> ID：638150
> 
> 赞同：13
> 
> 时间：2009-03-12T11:06:40.927
> 
> 标签：python, ruby

我在数据处理领域，很快可能会转向网络编程世界。尽管我对 Python 和 Ruby 都很着迷，因为在编写业务逻辑或数据处理逻辑时，它们似乎都有相似的风格。

但是当我开始搜索 Web 开发时，我开始倾向于 Ruby on Rails，我的问题是为什么 Web 世界如此痴迷于 Ruby on Rails 和活动记录？

似乎有很多用于学习 Ruby on Rails 的截屏视频和大量好书，为什么 Python 在创建截屏视频或 ORM 之类的活动记录时无法吸引人群。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-12T11:09:40.327

Ruby 和 Python 是语言。

Rails 是一个框架。

因此，将 Ruby on Rails 与 Python 进行比较并不明智。

那里有 Python 框架，你应该看看更直接的比较 - [http://wiki.python.org/moin/WebFrameworks](http://wiki.python.org/moin/WebFrameworks)（例如，我知道[Django](http://www.djangoproject.com/)得到了很多人的喜爱，但还有其他人）

编辑：我刚刚有一个谷歌，似乎有很多[Django Screencasts](http://www.google.co.uk/search?rlz=1C1GGLS_enGB291GB304&aq=f&sourceid=chrome&ie=UTF-8&q=django+screencast)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-12T17:28:55.347

Ruby 比 Python 更受关注，因为 Ruby 在 Web 应用程序方面有一个明显的最爱，而 Python 传统上采用一种非常分裂的方法（Zope、Plone、Django、Pylons、Turbogears）。让几乎所有开发人员都使用一个系统而不是多个单独的系统的临界质量对于改进文档、发现和消除错误、建立炒作和嗡嗡声等有很大帮助。

在实际语言中，两者除了语法外都非常相似，而 Python 更普遍。在 Web 框架成为大热门之前，Python 本身的流行可能阻碍了 Python，这使得社区更难同意专注于任何单一的方法。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-12T14:16:09.817

如果您想要 Python 截屏视频，请参阅 ShowMeDo.com。我是联合创始人，它已经 3.5 岁，拥有超过 400 个 Python 截屏视频（大部分是免费的）以及 600 多个其他免费开源主题： [http ://showmedo.com/videos/python](http://showmedo.com/videos/python)

在 Python 部分（链接）中，您将看到 Django 的视频、整个 TurboGears v1 DVD（由项目创始人 Kevin Dangoor 免费提供）、Python CGI（old-skool）、网络抓取等等。

大约 1/10 的内容仅供订阅者使用，另外 90% 由 100 位 open-src 作者创建，每月有 100,000 名用户。

请注意，Kyran 和我自己（联合创始人）都是英国的人工智能/数学研究人员，具有很强的学术联系。许多 Python 视频都与开始数据处理有一些链接，我将在接下来的几个月中创建新系列，专注于纯粹的 Python 数学/统计/图形/科学，以配合已经存在的那些。

HTH，伊恩。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T15:03:33.167

Ruby 和 Python 的相似之处多于不同之处。Rails 和 Django 也是如此，它们是各自语言中领先的 Web 框架。

使用这两种语言和两种框架都可能是有益的——至少从个人的、“有趣”的角度来看——我不知道特定领域的就业市场是什么样的。

StackOverflow 中有一些类似的问题：您可能比单击右侧边栏中的“相关”列表获得更多感觉做得更糟。

最好的办法是两者都尝试：选择一个小项目并以两种方式构建它。决定你更喜欢哪个，然后去做！

# .net - 从 VB6.0 升级的最佳开发工具

> ID：638152
> 
> 赞同：5
> 
> 时间：2009-03-12T11:07:32.420
> 
> 标签：.net, vb6, vb6-migration

我计划将大型 vb6 应用程序升级到 .net。该项目使用许多第三方组件，例如 VSFlexGrid 以及水晶报表。它还使用源代码不可用的旧 VB6 dll。我的问题是

1.  我应该将源代码转换为 C# 还是 VB.net 足够强大？对于不受支持或使用不安全/过时技术的第三方组件，我该怎么办？

我欢迎任何以前做过这件事的人提供任何有用的意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T14:52:21.320

这是我对类似问题的[一些](https://stackoverflow.com/questions/395/how-to-switch-a-large-app-from-vb6-to-vb-net/82200#82200)[回答](https://stackoverflow.com/questions/507291/should-we-select-vb-net-or-c-when-upgrading-our-legacy-apps/508823#508823)的改编。

自动转换是比重写更好的选择。开始乐观地重写大型软件，在修复旧架构中的一些众所周知的缺陷时取得良好的早期进展，然后陷入你多年来认为理所当然的功能，这是一个常见的陷阱. 在这一点上，你的管理层开始变得紧张，一切都会变得非常不舒服。

...这是微软[同意我](http://blogs.msdn.com/goto100/archive/2008/11/03/rewrite-vs-migrate-vs-reuse-vs-replace.aspx)的博客文章：

> 我在 .NET 早期工作过的许多公司首先考虑重写，部分原因是在迁移到 .NET 的同时，他们强烈希望改进底层架构和代码结构。不幸的是，其中许多项目遇到了困难，有几个项目从未完成。他们试图解决的问题太大了

这个出色的 Microsoft[页面](http://msdn.microsoft.com/en-gb/dd408373.aspx)推荐了两个第三方迁移工具，它们比（不再[可用](http://msdn.microsoft.com/en-us/vstudio/ms788233.aspx)）内置的 VB.NET 升级向导[——Artinsoft](http://www.artinsoft.com/visual-basic-upgrade-companion-vs-upgrade-wizard.aspx)和 CodeArchitects [VBMigration 更好](http://www.vbmigration.com/)。我相信他们对常见的第三方控件和 DLL 有一些支持——Artinsoft 支持[这些](http://www.artinsoft.com/3rd-party-library-extensibility.aspx). 与他们联系并提供您的依赖项列表是值得的。VBMigration 有一个[免费工具](http://www.vbmigration.com/Resources/VB6Analyzer.aspx)可以列出依赖项。也值得联系原始供应商，以期获得 .NET 等价物。

微软页面还说：

> 对 .NET 进行完全重写要比转换成本高得多，而且很难做好[比转换]……我们只在少数情况下推荐这种方法。

Stack Overflow 上的 C# 开发人员比 VB.NET 开发人员多得多，因此您可能会得到几个推荐 C# 的答案。同样，从历史上看，微软在 .NET 等新部分的代码示例方面倾向于更热情地支持 C#。但微软现在[向](http://support.microsoft.com/kb/308470)我们保证：

> [C# 和 VB.NET] 都是基于 Microsoft .NET Framework 的一流编程语言，它们同样强大。

因此，选择 C# 还是 VB.NET 是个人决定。Artinsoft 工具声称它可以将 VB6 转换为 C#。

* * *

编辑：我刚刚通过编程网站上的广告找到了另一个产品 - [NewCode](http://www.newcode.com/)！

我的快速判断是该网站不如我上面写的两个竞争对手那么详细。这可能是不公平的。Microsoft Ireland 的某个人在[博客](http://blogs.msdn.com/ronang/archive/2008/12/03/microsoft-ireland-podcast-modernising-your-vb6-code-with-newcode.aspx)上介绍了他们——我认为他们的总部设在爱尔兰。显然，该工具将您的 VB6 转换为 DSL，然后转换为 VB.NET Winforms、C#、WPF、Java...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T11:45:53.407

升级；即使存在机械工具，这对您也没有多大帮助。它不会让它神奇地适合 .NET，或者很好地使用该框架。在这种情况下，我总是更喜欢重写，但这确实有相关的风险/成本。例如，我的一些同事目前正在重写一些 VB6/ASP/COM+/xslt 代码以使用 ASP.NET MVC - 大多数“有趣”的代码实际上是业务逻辑，它并不难移植（诀窍是测试它;-p）。它有助于我们的 VB6 代码的布局是细粒度的，允许我们迁移单个切片，而不必一次推送整个批次。

第 3 方控件会很麻烦，听起来其他 dll 可能必须进行逆向工程。不是微不足道的。

C# 和 VB.NET 之间的选择主要是次要的。两者都有一些小的优势，但总的来说，你可以用任何一个来做大多数事情。如果您需要 COM 互操作，那么 VB.NET 可能很有用（对于所有东西，或仅对于特定程序集） - 但 C# 4.0（在 VS2010 中）将通过新`dynamic`类型和无 PIA 更改来填补这一空白。总的来说，我**非常**喜欢 C#，但这必须是本地决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T12:33:36.163

[我在这里](https://stackoverflow.com/questions/395/how-to-switch-a-large-app-from-vb6-to-vb-net/123185#123185)谈这个问题

第一步也是最重要的一步是让您现有的应用程序尽可能像 .NET 一样。任何 VB6 特定或依赖于 3rd 方控件的东西都尽可能多地在接口后面。该界面将准确显示您使用 3rd 方的东西的目的以及首先是什么行为。通过首先在 VB6 中执行此操作，您可以运行单元和集成测试，以确保该行为被保留。保留应用程序行为的关键元素。

至于 C# 和 VB.NET 之间的问题。两种语言在功能上几乎没有区别。我在 90 年代的一个转换项目是将我公司的 CAD/CAM 应用程序从称为 Rocky Mountain BASIC 的 BASIC 方言转换为 Visual Basic 3。在此之前我们有一些错误的开始，后来我们感觉到并证明了它通过切换到另一种 BASIC 家族语言来保持行为比转换像 C 这样的完全不同的语言家族要容易得多。

了解在我们的情况下，我们有很多数学繁重的子程序，而数学是在 BASIC 系列语言中保持相对论一致的少数领域之一。所以我的经验不是 100% 适用于你的情况。

我认为 C 风格语言的简洁性不利于长期（几十年）的可维护性。然而，公平地说，这充其量只是一个小问题。在编写和维护用 C++ 编写的 Mercury 和 Gemini Space Capsule 的模拟以及一些用 C# 编写的实用程序以及我公司的 VB6/VB.NET 中的 CAD/CAM 程序时，我在这两种语言方面都有丰富的经验。

现在我们的 .NET 转换主要集中在 VB.NET。我发现自动化工具几乎没用，因为我们是一个面向图形的繁重程序。幸运的是，我们没有直接使用 VB Graphics 调用，而是将所有内容放在画布界面后面。对于打印兼容性，我们使用 VB Power Pack 中的打印机兼容性库作为起点。

我们有一个工具来运行我们的代码，它将所有整数转换为 Int16 类型，将所有 long 转换为 Int32 类型以及其他一些常用的转换。然后我们将转换后的类或例程放入我们的 .NET 库并运行单元测试。将结果与在原始 VB6 代码上运行的相同测试进行比较。

屁股上最大的痛苦是形式。简单的对话框是可以的，但对于更复杂的表单，我们只需要重新实现。同样，我们的表单位于原始代码中的接口后面，所以当它工作时，我们很容易看到要做什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T03:51:35.740

我建议您“部分重写”您的应用程序。这种方法的花哨名称是扼杀（[http://martinfowler.com/bliki/StranglerApplication.html](http://martinfowler.com/bliki/StranglerApplication.html)）。

我的猜测是它是一个数据库应用程序。看看你是否可以通过直接与 DB 交谈来重写一些功能。不要担心让用户使用两个应用程序。旧的应用程序已经够糟糕了，他们要求更新。

我的另一个猜测是，由于它是 VB6，它没有很好的 UI/BusinessLogic 分离。这就是为什么自动升级不会让你得到太多。

也许我对你的情况有误。您需要询问您真正可以从现有代码中获得多少。也购买/阅读 Michael Feather 的 Legacy 密码书。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T14:47:03.783

我已经开始将我公司的一个用 VB6 编写的应用程序改写为 VB.NET。C# 和 VB.NET 都依赖于 .NET 框架，在任何一个中编译的应用程序之间的差异可以忽略不计。选择您和从事该项目的其他人感觉更舒服的语言。使用 VB.NET 的一个优点（尽管我不愿这样称呼它）是您可以使用 Visual Studio 中的“升级 Visual Basic 6 代码”功能。转换器修复了一些东西，而很多东西没有。如果你想试试这个，你必须清理你的 VB6 代码：

*   所有数组都需要从零开始
*   尽可能避免使用固定长度的字符串。必须更改此代码才能在 vb.net 中使用 Char 数组
*   显式声明所有变量。如果您还没有使用 Option Explicit
*   避免像瘟疫这样的变体，除非你绝对必须使用一个来进行 API 调用
*   传递参数时指定 ByRef 或 ByVal，不要依赖默认行为
*   始终指定要更改的属性，vb.net 中不存在默认属性。例如“txtName = strName”变成“txtName.Text = strName”
*   可以在[此处找到这些差异的更详细列表](http://www.thescarms.com/vbasic/VB6vsVBNet.aspx)

即使在尽可能地清理现有代码之后，转换仍然不是 100%。你可以在一个单独的项目中尝试这个，看看你能得到什么来给你一些关于如何重新设计事情的想法。有时表单在转换后看起来也很丑陋，而且对于某些事情，你很可能最终还是从头开始重做它们。

我们的许多表单在组合框和列表框中大量使用了 ItemData 属性，而 .NET 中不再存在这些属性。ListViews 的工作方式也不同，并且没有一个绘图功能是相同的。我转换的应用程序中的某些表单在转换为 .NET 控件时看起来非常糟糕，并且行为方式也不相同，因此我将最终从头开始重新处理这些表单。优点是我可以重做一开始效率不高的流程，但这当然需要更多时间。再加上我仍在学习了解各种 .NET 库的功能……是的，这需要一段时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-06-26T00:03:40.900

正如它所指出的，您可以重写您的应用程序。

另一种解决方案将是真正的 VB6 替代方案，完全兼容。我正在从事一个想要成为真正的 VB 7：RAD Basic 的项目。您可以在现代环境中继续使用您的 VB6 代码库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T12:53:05.193

你不会喜欢我的回答，但这里有。

a) 聘请在构建大型 .Net 应用程序方面具有丰富经验的人来指导项目并教你。

b) 从您当前的应用程序中提取业务需求并冻结它们。

c) 庆祝这应该是有史以来最简单的未开发应用程序开发项目，因为您有技术经验丰富的人来指导您，您有成熟的工具来构建应用程序并有一套明确定义的需求，所以您知道究竟要建造什么。

PS 在这一点上，我不会打扰 Winforms。我会直接跳到 WPF，稍后你会感谢我的。

PPS 语言真的无关紧要（C# 或 VB.Net）。努力将是相同的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-08T23:42:06.613

问题是明确询问有关“从 VB6.0 升级的最佳开发工具”的信息，以进行大型、复杂的 VB6/COM 升级，其次是有关 C# 或 VB.NET 的信息。

完美的“转换”工具将帮助您实现每次升级的两个关键目标

1.  保留功能
2.  以遵循所需编码和平台依赖标准的方式利用 .NET

**工具在保留功能方面的作用**

大型、成熟的遗留系统可以包含数千个代码文件和数百万行代码。完全描述和验证包含在这么多代码中的功能所需的工作量是巨大的。事实上，可能有太多的功能性工作，以至于一些具有技术头脑的团队一开始看不到它。他们大部分时间都在担心如何利用最新的 .NET 设计、语言和框架功能，然后才完全意识到保留和验证旧功能有多么困难。就好像他们正在从一条巨大的功能性鲸鱼的背上钓鱼，同时又担心抓到一些技术性的小鱼。

试图通过手动阅读、解释和重新编码来重现大量代码的团队很可能在此过程中失明……因此，任何转换工具的一个关键特性是帮助团队在重写代码的同时阅读、解释和重写代码以保留其语义的形式。计算机科学家研究阅读解释和重写源代码的问题已有 60 多年，他们提出的解决方案称为编译器。有效的代码“转换器”就像编译器一样工作。

VB6 是一种高级语言：Microsoft VB6 编译器及其运行时隐式地做了很多事情：管理类型推断、隐式转换、隐式引用、后期绑定调用、处理空值、goto 样式错误处理、设计表单等。 VB6 转换器还必须能够识别和存储代码中未明确显示的无数小细节，并且它必须能够在 .NET 中正确表达这些细节。工业强度转换工具将具有功能强大、可扩展的 VB6 元语言系统，允许用户控制 VB6 代码的识别和解释方式。

VB6 也可以通过 COM 轻松扩展。有数百种不同的 COM API 在使用中，这还不包括通常成为企业系统一部分的所有内部组件。转换器必须能够识别 VB6 在 UI 设计和代码中使用的任何 COM 类或控件，并使用其他一些适当的 .NET API 或互操作来表达它。我知道的一个工具甚至可以从 VB6 中的 COM 使用信息生成一个 .NET 代码框架。工业强度转换工具将具有强大的可扩展 COM 类型系统，并允许用户控制如何在生成的代码中替换 COM。

**该工具在利用 .NET 中的作用**

VB6 和 .NET 在很多方面都不同，支持这两个平台的各种 API 也是如此。因此，无论是否使用工具，几乎总是需要重新设计。此外，每个团队都会为他们的项目带来不同的偏好、约束和要求：询问 10 个程序如何编写代码，您将得到至少 10 个不同的答案。转换器必须帮助团队表达其独特的偏好、约束和要求。这包括提供可重复的、自文档化的方法，在处理之前修改 VB6 代码、在生成之后修改 .NET 代码、集成手写代码、描述自定义 API 替换、指导自定义代码重组以及执行许多其他各种动态和项目- 根据需要进行特定的转换。

**把它们放在一起**

很少会提前完全预测和计划大规模升级。即使对源代码和所需的 .NET 编码标准有广泛的了解，在工作过程中也会出现许多问题和机会。在升级项目期间必须允许更改源代码和要求。需要一种敏捷方法，使团队能够适应源代码更改，试验不同的 .NET 编码技术，响应对需求的更深入理解，并随着时间的推移逐步改进他们的自动升级过程。工业强度转换工具将具有启用此类方法的准确性、精度、灵活性和速度。

关于转换工具的另一条评论。您将在 .NET 升级中使用的最重要的“工具”是您的大脑。您必须学习 .NET 语言、设计模式和框架，并在升级工作中应用您所知道的知识。最好的自动化工具不会为您决定如何重写代码：它可以帮助您根据您认为有意义的设计重新实现遗留功能。

Microsoft 在本文中推荐了几种工具。 [VB6 升级伙伴工具](https://docs.microsoft.com/en-us/visualstudio/vb6/partners/)

**VB.NET 或 C#**

当我向 .NET 社区（即搜索网络）询问信息、工具、想法、代码和编程问题帮助时，我更有可能找到用 C# 表达的答案，而不是用 VB.NET 表达的答案。我还发现 C# 编译器更适合工具辅助重写，因为它要求生成的代码在内部更加一致并明确描述。获取和保持构建是一个有点粗糙但绝对关键的代码质量测试，也是任何升级工作的关键里程碑。请记住，VB.NET 不是 VB6。这听起来很明显，但很难记住，因为这两种语言看起来很相似。这种相似性可能具有欺骗性；所以 IMO 最好去 C# 那里提醒你规则是不同的。最后，C# 一直并将继续为 .NET 设计；VB.NET 不能这么说。

免责声明：我为大迁徙工作。还有很多要讨论的。请访问[Great Migrations 文档门户](http://portal.greatmigrations.com)以获取更多文章并获取 gmStudio 试用版并亲自尝试工业实力升级工具。

# sql-server - 是否有一个简单的工具可以将用户添加到 SQL Server 数据库？

> ID：638153
> 
> 赞同：1
> 
> 时间：2009-03-12T11:07:38.943
> 
> 标签：sql-server, sql-server-2005-express

我正在寻找一种简单的工具，最好是可以与我的应用程序一起重新分发的工具，**非技术性最终用户**可以使用该工具将用户（以及必要时的登录名​​）添加到特定的 SQL Server (Express) 数据库。

显然 SSME 会完成这项工作，但我不想要求用户安装如此重量级的东西。

我很清楚如何使用 SQL 管理对象自己编写这个，但**我正在寻找一些预先构建的**.

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:39:56.510

[您可以使用托管的 .NET 库SQL Server 管理对象](http://msdn.microsoft.com/de-de/library/ms162169.aspx)（简称 SMO）编写自己的工具。我认为它们是随 .NET Framework 2.0 一起提供的。所以依赖关系应该没有问题。

SMO 让您可以完全控制 SQL Server。MS SQL Server Management Studio 也是基于这些库编写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T16:21:13.887

编辑：据我所知，什么都没有。人们通常将其构建到他们的应用程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T16:57:11.803

老实说，我不希望你能够找到这样的工具——它的范围太窄——你想要一些能够创建和编辑登录名/用户的东西，但对于外行来说足够简单。你想要这样一个强大的工具在这样的人手中吗？除了 SSMS，SQL Server 还会有许多第 3 方客户端，但您需要一些简单易用和锁定的东西——我只是看不到它发生。

但是，我可能是错的——仅仅因为我没有遇到过这样的事情，并不意味着它们不存在。

我不明白为什么你不能在你的应用程序中构建简单的功能来添加新用户/登录。这似乎是最明智的建议。除了 SMO，还有什么理由不能使用 CREATE LOGIN/CREATE USER T-SQL 命令？

[创建用户](http://msdn.microsoft.com/en-us/library/ms173463.aspx)

[创建登录](http://msdn.microsoft.com/en-us/library/ms189751.aspx)

# tfs - 如何从 Team Foundation Server 中删除工作项

> ID：638154
> 
> 赞同：32
> 
> 时间：2009-03-12T11:08:02.420
> 
> 标签：tfs

是否有机会从 TFS 中删除工作项，或者我所能做的只是重命名它。

**更新：这个问题是针对 TFS 2008 的。新版本（2010）具有开箱即用的解决方案，正如 Rob Cannon 所建议的那样**

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2010-07-23T14:21:10.097

此处的答案对于 TFS 2010 已过时。您现在需要使用“witadmin destroywi”命令。

[http://msdn.microsoft.com/en-us/library/dd236908.aspx](http://msdn.microsoft.com/en-us/library/dd236908.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-08-31T12:38:25.950

请参阅此工具：[http ://devmatter.blogspot.com/2009/04/deleting-work-items-in-tfs-ui.html](http://devmatter.blogspot.com/2009/04/deleting-work-items-in-tfs-ui.html)

> Team Foundation Client 不包含任何用于从 TFS 中删除工作项的功能。
> 
> 尽管有点不方便，但您可以通过安装[Team Foundation Server Power Tools](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx) （2008 年 10 月版或更高版本）从 TFS 中删除工作项。在电动工具的许多可用功能中，有一个名为 destroywi 的命令可用于删除工作项。例如，要删除工作项 ID 1234，请使用以下命令：
> 
> ```
> tfpt destroywi /server:tfs-dev /workitemid:1234 
> ```
> 
> 尽管这是一项相对简单的任务，但并不是每个人都对命令行界面感到满意，更不用说您必须提前查找工作项 ID。为了稍微简化这个过程，我创建了一个简单的 UI，它位于 Team Foundation Server Power Tools 之上，使您可以轻松地选择要从中查询的 Team Foundation Server 和项目。您可以运行现有查询以显示工作项列表，您可以从中选择一个或多个要删除的工作项。如果您愿意，也可以直接输入工作项 ID（以逗号分隔的列表）...

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-05-31T15:47:05.610

没有人添加代码或示例，所以这是我使用 Rob Cannon 的答案作为上述指导对这个答案的重新迭代。

这是完成此任务的批处理文件代码。在您实际删除工作项之前，系统会提示您。

```
ECHO OFF

SET "VSDir=C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\"

CD %VSDir%

SET /p WorkItemID=Enter Work Item ID: 

ECHO.

witadmin destroywi /collection:{TFS Server}/{Collection Name} /id:%WorkItemID%

ECHO.
PAUSE 
```

享受

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-06-27T01:42:45.653

如果您想在不使用[已接受答案](https://stackoverflow.com/a/1357266/238753)中建议的工具的情况下执行此操作，这里是如何做的快速摘要。这是基于[另一个答案](https://stackoverflow.com/a/3319028/238753)中建议[的相应 MSDN 文章](http://msdn.microsoft.com/en-us/library/dd236908.aspx "永久删除工作项 [witadmin]")。

## 打开 Visual Studio 命令提示符：

使用开始菜单：

*   搜索它。
*   或者导航到*所有程序*-> *Microsoft Visual Studio X* -> *Visual Studio 工具*来找到它。

## 调用*witadmin*

1.  确定团队项目集合 URL。一个例子是`http://ServerName:Port/VirtualDirectoryName/CollectionName`。

2.  确定工作项 ID。

3.  调用以下命令，替换上述两个值：

    ```
     witadmin destroywi /collection:CollectionURL /id:id 
    ```

有关详细信息，请参阅[MSDN 文章。](http://msdn.microsoft.com/en-us/library/dd236908.aspx "永久删除工作项 [witadmin]")请注意，您需要获得许可才能使其正常工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T11:12:07.183

您必须使用 TFS 电动工具。

[http://msdn.microsoft.com/en-us/vstudio/bb980963.aspx](http://msdn.microsoft.com/en-us/vstudio/bb980963.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-10T12:56:40.817

1）如上所述的destroy命令（如果您必须删除多个项目，那就太烦人了）

2) 使用 TFS 2015.2，您将获得一个新的回收站功能（没有永久删除项目的选项）。

[https://www.visualstudio.com/en-us/news/tfs2015-update2-vs.aspx#delwork](https://www.visualstudio.com/en-us/news/tfs2015-update2-vs.aspx#delwork)

但是由于它们没有出现在任何地方（替换“已删除”状态）并且可以恢复......与自 2008 年以来添加 bin 功能的事实相比......非常整洁的 id 说：D

# performance - 这个概念有什么名字吗？

> ID：638161
> 
> 赞同：4
> 
> 时间：2009-03-12T11:09:52.573
> 
> 标签：performance, algorithm, language-agnostic, optimization

比如说，我们有一个程序可以在任意时刻获取用户输入或任何其他不可预测的事件。

对于每种类型的事件，程序都应该执行一些计算或访问资源，这是相当耗时的。程序应该尽可能快地输出结果。如果下一个事件到来，放弃以前的计算并接受新的计算可能是可以接受的。

更复杂的是，一些计算/资源访问可能是相互依赖的，即产生可用于其他计算的数据。

重要的是，我们知道这些事件通常发生的模式。例如：它们相对于彼此的相对频率，或者它们发生的共同顺序和时间间隔。

任务是制定一种算法，以最有效的统计方式处理问题。产生次优解决方案的方法可能绰绰有余。

是否有包含设计此类算法的概念？

* * *

例子：

一个选项卡式互联网浏览器。

当被告知在多个选项卡中加载不同的网页时，应决定是否将页面加载到具有更高优先级的活动选项卡中，仅渲染页面的可见部分或预渲染整个页面，如果是这样，首先要做什么 -为活动选项卡预渲染整个页面或渲染其他选项卡，等等。

（我对浏览器的实际工作方式一无所知，但假设它是这种方式不会受到伤害）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T11:13:43.467

我认为[调度算法](http://en.wikipedia.org/wiki/Scheduling_algorithm)处理这些场景。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T11:14:53.997

您所描述的是*优先应用程序调度程序*。您需要更具体地确定哪种算法最好，但[这里](http://en.wikipedia.org/wiki/Scheduling_(computing)#Common_scheduling_disciplines)有一个您可能会觉得有用的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:16:01.700

我在折腾关键字：**抢占式调度**？此外，预取，双缓冲

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T12:08:34.990

我对此了解不多，但这听起来像是[反应堆模式](http://en.wikipedia.org/wiki/Reactor_pattern)可以用来做的事情。

# java - Java：从父对象创建子类对象

> ID：638171
> 
> 赞同：43
> 
> 时间：2009-03-12T11:13:13.813
> 
> 标签：java, inheritance, constructor

新手Java问题。说我有：

```
public class Car{
  ...
}

public class Truck extends Car{
  ...
} 
```

假设我已经有一个 Car 对象，如何从这个 Car 对象创建一个新的 Truck 对象，以便将 Car 对象的所有值复制到我的新 Truck 对象中？理想情况下，我可以做这样的事情：

```
Car c = new Car();
/* ... c gets populated */

Truck t = new Truck(c);
/* would like t to have all of c's values */ 
```

我必须编写自己的复制构造函数吗？每次 Car 获得一个新字段时，都必须更新它......

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-12T11:14:45.977

是的，只需向 Truck 添加一个构造函数。您可能还想向 Car 添加一个构造函数，但不一定是公开的：

```
public class Car {
    protected Car(Car orig) {
    ...
}

public class Truck extends Car {
    public Truck(Car orig) {
        super(orig);
    }
    ...
} 
```

作为一项规则，通常最好将类设为叶子类（您可能希望将它们标记为最终类）或抽象类。

看起来好像你想要一个`Car`对象，然后让同一个实例变成一个`Truck`. 更好的方法是将行为委托给`Car`( `Vehicle`) 中的另一个对象。所以：

```
public final class Vehicle {
    private VehicleBehaviour behaviour = VehicleBehaviour.CAR;

    public void becomeTruck() {
        this.behaviour =  VehicleBehaviour.TRUCK;
    } 
    ...
} 
```

如果您实现`Cloneable`，那么您可以“自动”将对象复制到同一类的实例中。但是，这样做存在许多问题，包括必须复制可变对象的每个字段，这容易出错并禁止使用 final。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-01-19T11:04:08.373

如果您在项目中使用 Spring，则可以使用 ReflectionUtils。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T11:17:25.847

是的，您必须手动执行此操作。您还需要决定复制内容的“深度”。例如，假设 Car 有一个轮胎集合——你可以对集合做一个*浅*拷贝（这样如果原始对象改变了它集合的内容，新对象也会看到变化）或者你可以做一个*深*拷贝副本创建了一个新集合。

（这是不可变类型`String`经常派上用场的地方 - 无需克隆它们；您只需复制引用并知道对象的内容不会改变。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-06-17T21:33:03.870

> 我必须编写自己的复制构造函数吗？每次 Car 获得一个新字段时，都必须更新它......

一点也不！

试试这个方法：

```
public class Car{
    ...
}

public class Truck extends Car{
    ...

    public Truck(Car car){
        copyFields(car, this);
    }
}

public static void copyFields(Object source, Object target) {
        Field[] fieldsSource = source.getClass().getFields();
        Field[] fieldsTarget = target.getClass().getFields();

        for (Field fieldTarget : fieldsTarget)
        {
            for (Field fieldSource : fieldsSource)
            {
                if (fieldTarget.getName().equals(fieldSource.getName()))
                {
                    try
                    {
                        fieldTarget.set(target, fieldSource.get(source));
                    }
                    catch (SecurityException e)
                    {
                    }
                    catch (IllegalArgumentException e)
                    {
                    }
                    catch (IllegalAccessException e)
                    {
                    }
                    break;
                }
            }
        }
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-25T16:33:03.580

你可以使用反射，我会这样做并且对我来说很好：

```
public Child(Parent parent){
    for (Method getMethod : parent.getClass().getMethods()) {
        if (getMethod.getName().startsWith("get")) {
            try {
                Method setMethod = this.getClass().getMethod(getMethod.getName().replace("get", "set"), getMethod.getReturnType());
                setMethod.invoke(this, getMethod.invoke(parent, (Object[]) null));

            } catch (NoSuchMethodException | SecurityException | IllegalAccessException | IllegalArgumentException | InvocationTargetException ex) {
                //not found set
            }
        }
    }
 } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T11:16:20.420

> 我必须编写自己的复制构造函数吗？每次 Car 获得一个新字段时，都必须更新它......

本质上，是的 - 您不能只转换 Java 中的对象。

幸运的是，您不必自己编写所有代码 - 查看[commons-beanutils](http://commons.apache.org/beanutils/)，特别是[cloneBean 之](http://commons.apache.org/beanutils/v1.8.0/apidocs/org/apache/commons/beanutils/BeanUtils.html#cloneBean(java.lang.Object))类的方法。这具有额外的优势，您不必每次获得新字段时都对其进行更新！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-03-11T08:39:24.137

您始终可以使用诸如[Dozer](http://dozer.sourceforge.net/)之类的映射框架。默认情况下（无需[进一步配置](http://dozer.sourceforge.net/documentation/gettingstarted.html)），它使用 getter 和 setter 方法将所有同名字段从一个对象映射到另一个对象。

依赖：

```
<dependency>
    <groupId>net.sf.dozer</groupId>
    <artifactId>dozer</artifactId>
    <version>5.5.1</version>
</dependency> 
```

代码：

```
import org.dozer.DozerBeanMapper;
import org.dozer.Mapper;

// ...

Car c = new Car();
/* ... c gets populated */

Truck t = new Truck();
Mapper mapper = new DozerBeanMapper();
mapper.map(c, t);
/* would like t to have all of c's values */ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T11:16:40.090

您将需要一个复制构造函数，但您的复制构造函数可以使用反射来查找两个对象之间的公共字段，从“原型”对象获取它们的值，并将它们设置在子对象上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T11:32:03.767

您可以使用反射 API 循环遍历每个 Car 字段并将值分配给等效的 Truck 字段。这可以在卡车内完成。此外，它是访问 Car 私有字段的唯一方法——至少在自动意义上，前提是没有安全管理器并限制对私有字段的访问。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-07T23:22:14.050

我知道这是一个老问题，但是当情况有所改善时，我讨厌遗漏过时的答案。

使用 JSON 要容易得多。将其转换为 JSON 并再次作为孩子返回。

这是一个 Android Kotlin 示例。

```
 val gson = Gson()    
    val childClass = gson.fromJson(
        gson.toJson(parentObject), 
        object: TypeToken<ChildObject>(){}.type
    ) as ChildObject 
```

我认为在Java中基本上是这样。

```
Gson gson = new Gson()
ChildObject child = (ChildObject) gson.fromJson(
    gson.toJson(parentObject),
    TypeToken<ChildObject>(){}.getType()
) 
```

你就完成了，没有混乱，只是简单的 json 输入，json 输出。如果您没有 gson，我相信您还有其他可用的 json 选项。

这比做反思和所有那些疯狂的事情要干净得多，也快得多。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-05T03:20:30.057

上面介绍的解决方案具有您应该注意的局限性。这是将字段从一个类复制到另一个类的算法的简短摘要。

*   [Tom Hawtin](https://stackoverflow.com/a/638179/562242)：如果你的超类有一个拷贝构造函数，就使用这个。如果没有，您将需要不同的解决方案。
*   [Christian](https://stackoverflow.com/a/30902763/562242)：如果超类不扩展任何其他类，请使用它。此方法不会向上递归复制字段。
*   [肖恩·帕特里克·弗洛伊德（ Sean Patrick Floyd](https://stackoverflow.com/a/11900588/562242)）：这是一种向上递归复制所有字段的通用解决方案。请务必阅读@jett 的评论，即必须添加一行以防止无限循环。

`analyze`我用缺失的语句重现了 Sean Patrick Floyd 的函数：

```
private static Map<String, Field> analyze(Object object) {
    if (object == null) throw new NullPointerException();

    Map<String, Field> map = new TreeMap<String, Field>();

    Class<?> current = object.getClass();
    while (current != Object.class) {
        Field[] declaredFields = current.getDeclaredFields();
        for (Field field : declaredFields) {
            if (!Modifier.isStatic(field.getModifiers())) {
                if (!map.containsKey(field.getName())) {
                    map.put(field.getName(), field);
                }
            }
        }

        current = current.getSuperclass();   /* The missing statement */
    }
    return map;
} 
```

# apache-flex - Flex 相当于 Google Visualization Geomap（等值线图）？

> ID：638175
> 
> 赞同：4
> 
> 时间：2009-03-12T11:13:58.257
> 
> 标签：apache-flex, flash, google-maps, flex3, visualization

[Google Visualization Geomap](http://code.google.com/apis/visualization/documentation/gallery/geomap.html#Overview)组件是大洲、国家和地区的[等值线地图](http://en.wikipedia.org/wiki/Choropleth_map)，颜色和值分配给特定区域。虽然它是用 Flash 渲染的，但它只能通过 JavaScript 或 GWT API 访问和定制。

有谁知道我可以轻松嵌入 Flex 3 应用程序（使用 AS3）的替代 Flash/Flex 组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T12:35:39.913

结帐 Esris 地图解决方案。我在一个大项目上使用它，它被证明是一个非常灵活和功能强大的映射 api

[http://resources.esri.com/arcgisserver/apis/flex/](http://resources.esri.com/arcgisserver/apis/flex/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-10T03:14:52.330

您可以查看很多 Flex 地图组件：

商业产品：[http](http://www.ilog.com/products/ilogelixir/) ://www.ilog.com/products/ilogelixir/ 开源项目：[http ://code.google.com/p/birdeye/](http://code.google.com/p/birdeye/)

我的实验组件：[http](http://srirangan.net/?p=209) ://srirangan.net/?p= 209 :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-30T21:31:35.927

我以前在使用 amMap 的非 Flex 地图的非 Flex 项目中取得了成功，但他们确实提供了[Flex 映射产品](http://flex.ammap.com/)。我能够创建和定义自定义地图区域，并且您基本上可以将“任何东西”视为地图，因此我能够创建其他人不认为是区域的自定义区域。

我不确定为什么这篇文章在 1 分钟前突然显示为“有趣”，因为它的年龄，但希望这可以帮助其他人:)

# c# - 在 PropertyGrid 控件中显示集合

> ID：638184
> 
> 赞同：4
> 
> 时间：2009-03-12T11:15:56.207
> 
> 标签：c#, winforms, propertygrid

我有一个包含成对字符串标签和值的对象数组，我如何将它们全部放在一个属性网格中？

```
 public class stringVariable {
        public String name;
        public String defaultValue;
        public String value;
    };
    public List<stringVariable> variables = new List<stringVariable>(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:20:12.937

它并不完全直截了当，但可能。您需要有一个实现 ICustomTypeDescriptor 的类，它将告诉您要显示哪些属性等。那里有一些实现，我正在使用这个： http: [//www.codeproject.com/KB/miscctrl/bending_property .aspx](http://www.codeproject.com/KB/miscctrl/bending_property.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T11:19:20.163

许多教程都很好地介绍了将对象数组添加到属性网格。[这](http://www.codeproject.com/KB/tabs/customizingcollectiondata.aspx)应该是您正在寻找的。

# sql-server-2005 - Reporting Services 报告部署/降级问题

> ID：638191
> 
> 赞同：2
> 
> 时间：2009-03-12T11:18:43.470
> 
> 标签：sql-server-2005, sql-server-2008, reporting-services, bids

我有一个报告服务项目，其中包含在 sql server 2008 附带的 SQL Server 商业智能开发工作室中开发的大量报告。我想将这些报告部署到仅具有报告服务 2005 的服务器，但部署失败。我想知道这里是否有人能够将在商业智能开发工作室 2008 中开发的报告部署到仅运行报告服务 2005 的服务器上。

如果它不能通过，有没有办法将我的报告项目降级回 2005 年的报告服务，以便我能够部署我的报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:38:24.017

不幸的是，这目前是不可能的。

以下线程包含来自 MSDN 论坛的与类似查询有关的讨论。如果您通读它，您会发现 MVP 将此作为开发/支持请求向 Mcrosoft 提出。

[http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/686cac48-bc14-4978-b7bf-acbc0c90384e/](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/686cac48-bc14-4978-b7bf-acbc0c90384e/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T11:59:11.907

真的有那么糟糕吗？

从 2005 -> 2000 开始，您只需从 rdl 文件中删除几行 xml。

你不能做类似的事情吗？假设你不使用 08 特定的东西，比如 Tablix

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T20:16:31.597

微软，你不知道这个问题有多痛苦。只有在 VS 2008 中创建报告并尝试在 SQL Server 2005 上运行它们之后，我们才会发现这种不兼容性。

这是微软极差的产品管理。

# java - 如何最好地赶上 Java 的最新发展？

> ID：638192
> 
> 赞同：6
> 
> 时间：2009-03-12T11:18:54.267
> 
> 标签：java

我正在申请 Java 开发人员的工作。直到 2001 年，我用 Java 编写了一些爱好应用程序，之后我主要使用 C++ 和其他语言工作。同时，感觉 java 成长了很多，而且还有各种我不知道的缩写词（EJB、spring 等）。

我在哪里可以找到关于最近（5 年）Java 发展的简明、清晰的解释？要理解的关键要素是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-12T11:40:29.737

2001 年？哇，时代变了。那是什么？Java 1.3？

一、语言特点：

*   泛型：Java 在 2004 年的 5.0 版本中添加了泛型，基本上是作为语法糖来阻止您从集合中的对象进行所有这些强制转换；
*   注释：也在 Java 5 中。广泛用于持久性框架、Spring 和其他地方；
*   类型安全枚举：Java 5 增加了一个枚举类型，它基本上是一个类（某种意义上的）；
*   并发性：Java 5 添加了广泛的并发性工具，因此多线程发生了很大变化；和
*   断言：Java 1.4 中添加的一个未被充分利用的语言特性。如果在您运行程序时启用，资产可以检查各种条件并在它们不正确时将其轰出。您可以在运行程序时打开或关闭它们，这一事实非常适合诊断。

事情是，上述甚至都不是大的变化。在这十年的早期，Java 经历了彻底的架构和哲学变革。

早在 2001 年，最重要的是 EJB、Swing 和 servlets/JSP。它们中的任何一个都不再是（至少不是直接的）。

可能在 Java 中发生的最重要的事情（自诞生以来恕我直言）是 Spring，而 Spring 大约在 5 年前真正变得大了。Spring 是一个轻量级容器，它还试图隐藏不同提供者和 API 之间的实现差异。然而，Spring 最大的特点是“控制反转”或“依赖注入”的原理。这个想法是类（“bean”）是从外部配置（“应用程序上下文”）组装的。

早期 J2EE 时代的一个典型模式是服务定位器。它现在在很大程度上被视为一种反模式。基本上你会看到这样的代码：

```
public MyClass() {
  this.dataMember = ServiceLocator.locate("some service");
} 
```

如果你现在到处提倡这种方法，你将被视为不合时宜的人、业余爱好者、疯子或三者的某种组合。

依赖注入，以其最简单的形式，将把必要的行为注入到类中，而不考虑实际的实现。这种分离看似强大，而且是 Sun（仍然）没有真正赶上的深刻转变。它还极大地增强了单元测试。

Swing 仍然存在，但不再那么大了。Sun 在最近几个月发布了 JavaFX 作为 Flash 的竞争对手和小程序的替代品。我个人认为它没有太大的未来（正如 Joel 在他最近的播客中所说，桌面上的 Java 基本上已经死了）但其他人会不同意。

EJB 在 2001 年很重要。现在已经不是那么多了。它（正确地）被视为 XML 配置的噩梦，应用程序服务器的差异使它们在很大程度上是不可移植的（或者如果您愿意，它们是不可移植的），而且它们是如此重量级的解决方案（3.0 之前），以至于它们没有' 真的没有那么多的应用程序。

EJB 3.0 采用了更类似于 Spring 的依赖注入（某种）和 POJO 注释（普通的旧 Java 对象）的方法。

Servlet 和 JSP 在 2001 年很重要。Struts 是在那时或之后不久开始发展的，直到几年前才开始发展壮大。它现在已被其他更现代的 Web 框架（如 Struts 2——尽管名称与 STruts 1 没有真正的关系——Spring MVC、Seam 等）所超越。

这些天来最重要的事情——不仅仅是在 Java 中——就是 Web 和 RIA。Flash/Flex 和 Javascript/HTML/CSS（加上框架）如今在这里占据主导地位（是的，有 GWT，但它的追随者很少）。

Weblogic 和 Websphere 没有 2001 年那么大。JBoss 仍然有很大的发展势头，但这些天我选择的应用服务器是 Sun 的 Glassfish v2 或 v3 Prelude。

IDE 也发生了变化。JBuilder 在 2001 年很受欢迎。现在只有三个：Eclipse、Netbeans 和 IntelliJ（可能按流行顺序排列，但我更喜欢 IntelliJ，它也是其中唯一的商业软件）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T11:23:17.500

我强烈建议您阅读博客。这通常是加快速度的最佳方式。

[https://stackoverflow.com/questions/48701/what-is-the-best-blog-for-java-development](https://stackoverflow.com/questions/48701/what-is-the-best-blog-for-java-development)

另外看看这个 SO 线程： [Learning Java](https://stackoverflow.com/questions/255458/learning-java)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T11:35:38.687

订阅并收听[The Java Posse 播客](http://www.javaposse.com)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-15T23:47:05.293

cletus 给出了一个惊人的答案，但我不得不强烈反对

> 桌面上的 Java 基本死了

事实上，它不仅仅是活着的：] *Eclipse IDE*不仅仅是一个开发工具。查看eclipse.org 上的*SWT/JFace/Eclipse RCP*框架 - 使用它，您可以自己构建类似 Eclipse 的应用程序。文本编辑器、图形图编辑器、建模工具、报告……我自己跟不上 Eclipse 技术……其中一些已经进入 Spring，甚至计划在下一个 Java 版本中得到本地支持（像 OSGi 这样的模块）。忘记 Swing，现在的桌面应用程序正在以*RCP*方式开发。

一些信息可以在[http://wiki.eclipse.org/index.php/Rich_Client_Platform](http://wiki.eclipse.org/index.php/Rich_Client_Platform)和 dzone.com 的 eclipse zone 中找到。

Java 现在默认支持*JavaScript*，此外，python、ruby 等许多语言已被“移植”到其生态系统中，如*Jython*、*JRuby*。还有一种称为*groovy*的新语言及其旗舰项目*grails*（使用 Spring 和 Hibernate）。

*GWT*（Java 到 JavaScript 转换器 + 小部件集）正在受到关注。甚至还有一个名为 Eclipse RAP 的新兴项目，旨在将 RCP 内容引入 Web。

除了 JBoss 和 Glassfish，您可能对 Jetty 感兴趣 - 一个极其轻量级但功能强大的替代品。

# wix - 如何使用 WiX 为关联文件设置图标？

> ID：638201
> 
> 赞同：7
> 
> 时间：2009-03-12T11:22:10.890
> 
> 标签：wix

我的应用程序安装文件是使用 WiX 生成的。在 WiX 配置中，我关联了一种适用于应用程序的文件类型。如何在 WiX 配置中将图标与此文件类型相关联？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T11:29:36.487

来自：[http ://www.tramontana.co.hu/wix/lesson1.php#1.7](http://www.tramontana.co.hu/wix/lesson1.php#1.7)

如果您的应用程序处理自己的文件数据类型，则需要为其注册文件关联。将 ProgId 放入您的组件中。FileId 应该引用 File 元素的 Id 属性，该属性描述用于处理此扩展名文件的文件。注意感叹号：它将返回文件的短路径而不是长路径：

```
<ProgId Id='AcmeFoobar.xyzfile' Description='Acme Foobar data file'>
  <Extension Id='xyz' ContentType='application/xyz'>
    <Verb Id='open' Sequence='10' Command='Open' Target='[!FileId]' Argument='"%1"' />
  </Extension>
</ProgId> 
```

要将图标分配给此文件类型，您必须自己在组件中指定适当的注册表项：

```
<Registry Id='FooIcon1' Root='HKCR' Key='.xyz' Action='write'
  Type='string' Value='AcmeFoobar.xyzfile' />
<Registry Id='FooIcon2' Root='HKCR' Key='AcmeFoobar.xyzfile' Action='write'
  Type='string' Value='Acme Foobar data file' />
<Registry Id='FooIcon3' Root='HKCR' Key='AcmeFoobar.xyzfile\DefaultIcon' Action='write'
  Type='string' Value='[INSTALLDIR]Foobar.exe,1' /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T13:22:18.680

我就是这样做的。我宣布：

```
<Icon Id="Icon.exe" SourceFile="..\Installer\Graph.ico" /> 
```

之前`</Product>`并将其添加为参考，如下所示：

```
<ProgId Id='myApp.exe' Description='Some description' Advertise='yes' Icon='Icon.exe'>
          <Extension Id='xyz' ContentType='application/text'>
            <Verb Id='open' Sequence='10' Command='Open' Argument='"%1"' />
          </Extension>
</ProgId> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T14:33:38.173

我建议按照我的堆栈溢出帖子位于[此处](https://stackoverflow.com/questions/2993118/how-to-perform-shell-icon-embedding-in-visual-studio-2010)获取将图标嵌入资源的最简单和最优雅的方法，而无需在托管 .NET 应用程序中使用 c++ 项目。

接下来，这是通过 wix 进行设置的正确方法：

```
 <Component Id="stackoverflowFileRegistration" Guid="MY_GUID">

    <RegistryKey Root="HKCR" Key=".stackoverflow" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
      <RegistryValue Value="stackoverflow.Document" Type="string" KeyPath="yes" />
      <RegistryValue Name="Content Type" Value="application/stackoverflow" Type="string" />
      <RegistryKey Key="ShellNew" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
        <RegistryValue Name="NullFile" Value="" Type="string" />
        <RegistryValue Name="Data" Value="Default new document Content.. NOTE: you must use a MutiStringValue nodes for multi-line content...." Type="string"/>
      </RegistryKey>
    </RegistryKey>

    <RegistryKey Root="HKCR" Key="stackoverflow.Document" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
      <RegistryValue Value="stackoverflow Document" Type="string" />

      <RegistryKey Key="DefaultIcon" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
        <RegistryValue Value="[INSTALLDIR]bin\stackoverflow.lib.dll, 1" Type="string" />
      </RegistryKey>

      <RegistryKey Key="Shell" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
        <RegistryKey Key="openstackoverflowwebsite" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
          <RegistryValue Value="Open Stackoverflow" Type="string" />
          <RegistryKey Key="command" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes">
            <RegistryValue Value="&quot;[INSTALLDIR]stackoverflow.exe&quot; /openwebsite &quot;%1&quot;" Type="string" />
          </RegistryKey>
        </RegistryKey>
      </RegistryKey>

    </RegistryKey>
  </Component> 
```

此示例注册了位于步骤 1 中的程序集中的特定文件扩展名 (.stackoverflow) 的默认图标。它还显示了如何创建与 Windows 资源管理器相关的右键单击命令，以及如何将菜单项添加到 Windows 资源管理器的新子菜单。

谢谢

——布莱克·涅米斯基

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-08-06T06:17:11.523

请注意，对于完整的图标/文件关联，Dracos 的回答是不够的。

以下代码：

我就是这样做的。我宣布：

```
<Icon Id="Icon.exe" SourceFile="..\Installer\Graph.ico" /> 
<ProgId Id='myApp.exe' Description='Some description' Advertise='yes' Icon='Icon.exe'>
          <Extension Id='xyz' ContentType='application/text'>
            <Verb Id='open' Sequence='10' Command='Open' Argument='"%1"' />
          </Extension>
</ProgId> 
```

仅为给定 wix-project 安装的应用程序创建的对话框注册文件/图标关联。要获得在 Windows 中为所有对话、桌面等整体显示的图标，您还需要在 regedit 中为特定文件类型（扩展名）注册图标。

# linux - 将键盘命令编码到 Bash 脚本

> ID：638202
> 
> 赞同：1
> 
> 时间：2009-03-12T11:22:32.603
> 
> 标签：linux, bash, unix, keyboard, qsub

我有以下方式使用 qsub 提交集群作业：

```
 Submitting jobs from standard input
       To submit a PBS job by typing job specifications at the command line, the user types

              qsub [options] <return>

       then types any directives, then any tasks, followed by

              (in UNIX)     CTRL-D on a line by itself
              (in Windows)  CTRL-Z <return>

       to terminate the input. 
```

有没有一种方法可以在 bash 脚本中对 RETURN 和 CTRL-D 进行编码，以便我们可以执行以下操作：

```
for i in path/*.txt; do echo "$i";  qsub [RETURN] /path2/mycode $i; [CTRL-D]; done 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T11:30:38.607

您应该通过管道使用重定向：

```
for i in path/*.txt; do
  echo "$i";
  echo "/path2/mycode $i" | qsub;
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T11:28:27.987

试试`echo /path2/mycode $i | qsub`。

如果这不起作用或者您需要传递更复杂的数据，那么[expect](http://en.wikipedia.org/wiki/Expect)可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T11:32:33.563

只是为了澄清（因为 corvus 的回答完全正确） - CTRL-D 仅表示“文件结束”或“输入结束”，因此当您将该文本回显到 qsub 时，它会自动发送文件结束信号之后（与按 CTRL-D 相同）

# javascript - 如何使用 JQuery 选择表中的所有文本框，不包括表行中的最后一个文本框

> ID：638206
> 
> 赞同：1
> 
> 时间：2009-03-12T11:23:57.250
> 
> 标签：javascript, jquery

我想为表格中的每个文本框元素添加一个按键事件，不包括每行中的最后一个文本框。该表在两个轴上都是动态的。

key up 事件将汇​​总除最后一个文本框以外的所有值。然后将总计放置在该行的最后一个文本框中。

总计和设置总计的脚本一切正常。

我厌倦了以下选择目标元素：

```
$("#Grid tr input:text:not(:last)").keyup(function(){
    //do total stuff here
}) 
```

不幸的是，它按记录工作，而不是我想要的，并选择了除最后一个复选框之外的所有复选框。

理想情况下，该解决方案不会涉及对下表示例的任何进一步标记或涉及任何循环。但是，如果这就是它所需要的，那就这样吧。

```
<table id="Grid">
    <tr id="r1">
        <td>Row 1</td>
        <td><input type="text" id="txt_a1_b1"></td>
        <td><input type="text" id="txt_a1_b2"></td>
        <td><input type="text" id="txt_a1_b3"></td>
        <td><input type="text" id="txt_a1_b4"></td>
        <td><input type="text" id="total_a1"></td>
    </tr>
    <tr id="r2">
        <td>Row 2</td>
        <td><input type="text" id="txt_a2_b1"></td>
        <td><input type="text" id="txt_a2_b2"></td>
        <td><input type="text" id="txt_a2_b3"></td>
        <td><input type="text" id="txt_a2_b4"></td>
        <td><input type="text" id="total_a2"></td>
    </tr>
    <tr id="r3">
        <td>Row 3</td>
        <td><input type="text" id="txt_a3_b1"></td>
        <td><input type="text" id="txt_a3_b2"></td>
        <td><input type="text" id="txt_a3_b3"></td>
        <td><input type="text" id="txt_a3_b4"></td>
        <td><input type="text" id="total_a3"></td>
    </tr>
</table> 
```

最后一点，总文本框确实需要是一个文本框，因为还需要输入总和然后将其拆分到行中，并且我不希望总文本框中的键向上功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:43:42.053

我很惊讶没有人完全明白这一点：

```
$("#Grid tr :not(:last-child) :text").keyup(function(){
    //do total stuff here
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T11:29:36.613

我会在行上使用 each 函数，并在每行中找到除最后一个输入之外的所有内容。

```
$('#Grid > tr').each( function() {
    $(this).find('input:not(:last)).keyup( ... )
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:31:29.230

这个找到所有 TR 中的所有输入（除了最后一个）

```
$("#Grid tr").find("input:text:not(:last)") 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-12T11:27:20.657

如果您想一次性完成所有操作，请使用`:last-child`：

```
... $('table tr input:not(:last-child)') ... 
```

来自文档：“虽然 :last 仅匹配一个元素，但它匹配多个元素，每个父元素匹配一个。”

# asp.net-mvc - 如何在视图中显示查询结果？

> ID：638208
> 
> 赞同：1
> 
> 时间：2009-03-12T11:24:52.707
> 
> 标签：asp.net-mvc

我正在使用 MVC RC2。

我有两个表 1）产品（PID，PName，CIDfk）；2）类别（CID，CName）；

所以我像这样查询

```
var Product = from p in dc.Product
                       from C in dc.Category
                       where p.CIDfk == c.CID
                       select new { ProductName = p.PName, ProductCategory = c.CName };
return view(); 
```

其中 dc 是 LINQ-to-SQL 类 (.dbml) 的数据库上下文；

如何在视图中显示？我在哪里通过产品？（在视图数据或“返回视图（）”中）

请帮帮我...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T11:36:09.687

您希望有一个强类型视图并将产品作为视图模型传递

```
 var product = from p in dc.Product
                   from C in dc.Category
                   where p.CIDfk == c.CID
                   select p;

 return View( product ); 
```

您的视图类型在哪里`ViewPage<Product>`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T12:54:20.573

您可以同时使用：

```
- ViewData["MyName"] = product.SingleOrDefault(); 
```

从你的观点来看，这种方式：

```
 <% Product p = (Product)ViewData(p) %> 
```

或填充模型：

```
ViewData.Model = product.SingleOrDefault(); 
```

从你的观点来看，这种方式：

```
<%Product p = ViewData.Model%> //in case of a Strongly typed view
<%Product p = (Product)ViewData.Model%> //otherwise 
```

填充 ViewData 或模型后，您可以调用：

```
return View(); 
```

正如 tvanfosson 所说，另一种方法是调用接受模型作为参数的 View 重载。

# wpf - WPF RichTextBox - 拼写检查不适用于格式化文本

> ID：638215
> 
> 赞同：1
> 
> 时间：2009-03-12T11:27:46.960
> 
> 标签：wpf, richtextbox, spell-checking

如果我定义一个 RichTextBox 如下；

```
<RichTextBox SpellCheck.IsEnabled="True">
    <FlowDocument />
</RichTextBox> 
```

当我输入作品“Sample”并将前三个字母加粗时，拼写检查器会在单词下划线。

文档的源 XAML 显示 RichTextBox 将单词分成两个单独的运行；

```
<Paragraph>
    <Run FontWeight="Bold" xml:lang="en-gb">Sam</Run>
    <Run xml:lang="en-gb">ple</Run>
</Paragraph> 
```

如果我手动构建具有以下块的文档；

```
<FlowDocument>
    <Paragraph>
        <Run FontWeight="Bold">Sam</Run>ple
    </Paragraph>
</FlowDocument> 
```

拼写检查器成功通过了单词。

有没有人遇到过这个？有我可以使用的解决方法吗？

谢谢马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T18:26:01.287

There seem to be issues with the spell checker and different locales.

If I start with this:

```
<RichTextBox SpellCheck.IsEnabled="True" xml:lang="en-GB">
    <FlowDocument />
</RichTextBox> 
```

I can reproduce your error (by typing "Sample" and bolding the "Sam"), but not with this:

```
<RichTextBox SpellCheck.IsEnabled="True">
    <FlowDocument />
</RichTextBox> 
```

Someone has a similar problem [here](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=357661). Microsoft replies:

> This problem occurs because the Language property on FrameworkElement (and thus TextBox/RichTextBox) defaults to "en-US", and you are using the "en-NZ" locale. When you type text into TextBox/RichTextBox, it will be in a different locale than the text set in XAML. The spell checker does not cross language boundaries, which results in the behavior you see.

# vb.net - VB.Net 动态初始化数组

> ID：638216
> 
> 赞同：7
> 
> 时间：2009-03-12T11:27:57.397
> 
> 标签：vb.net, arrays

我写了这个 - 非常简单的 - 函数，然后想知道 VB 是否有一些预先构建的功能来做到这一点，但找不到任何具体的东西。

```
Private Shared Function MakeArray(Of T)(ByVal ParamArray args() As T) As T()
    Return args
End Function 
```

没那么多用

```
Dim someNames() as string = MakeArray("Hans", "Luke", "Lia") 
```

因为这可以通过

```
Dim someNames() as string = {"Hans", "Luke", "Lia"} 
```

但更像

```
public sub PrintNames(names() as string)
   // print each name
End Sub

PrintNames(MakeArray("Hans", "Luke", "Lia")) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-12T11:31:44.843

任何不做的理由：

```
Dim someNames() as string = New String(){"Han", "Luke", "Leia"} 
```

据我所知，唯一的区别是类型推断。

我刚刚检查过，VB 9 也有[隐式类型数组](https://docs.microsoft.com/en-us/previous-versions/ms364068(v=vs.80))：

```
Dim someNames() as string = { "Han", "Luke", "Leia" } 
```

（据我所知，这在 VB 8 中不起作用，但显式版本可以。隐式版本对于匿名类型是必需的，这也是 VB 9 的新内容。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T11:31:46.293

```
Dim somenames() As String = {"hello", "world"} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-21T16:09:32.440

以下代码将在 VB 10 中工作：

```
Dim someNames = {"Hans", "Luke", "Lia"} 
```

[http://msdn.microsoft.com/en-us/library/ee336123.aspx](http://msdn.microsoft.com/en-us/library/ee336123.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T15:17:23.200

```
PrintNames(New String(){"Hans", "Luke", "Lia"}) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-06T00:57:44.647

微软推荐以下格式

```
Dim mixedTypes As Object() = New Object() {item1, item2, itemn} 
```

根据[http://msdn.microsoft.com/en-US/library/8k8021te(v=VS.80).aspx](http://msdn.microsoft.com/en-US/library/8k8021te(v=VS.80).aspx)

请注意，您不必指定新数组的大小，因为这是从 args 的初始化计数推断出来的。如果确实要指定长度，则指定的不是“长度”，而是数组中最后一个空间的索引号。IE。New Object(2) {0, 1, 2} '注意 3 参数。

# functional-programming - 如何开始使用函数式编程？

> ID：638222
> 
> 赞同：5
> 
> 时间：2009-03-12T11:29:35.350
> 
> 标签：functional-programming

随着函数式编程的所有炒作，哪些是函数式编程入门的最佳资源[对于 C# 程序员]？我不是在寻找 C# 3.0 语言改进。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T11:36:34.973

[无耻的插件：我是Real World Functional Programming](http://manning.com/petricek)的合著者（好吧，真的是荣耀的编辑器：）。它直接针对像你这样的人。它主要通过 F# 教授函数式编程的原理，还展示了如何在 C# 的许多情况下应用相同的原理。

它假定您已经了解 C#，但从头开始介绍 F#。它为您提供了足够的 F# 知识以帮助您开始进行实验，但其目的是教授一种实用的思维方式，而不是深入了解 F# 作为一门语言的每一个角落。（换句话说，如果你想开始使用 F# 作为生产语言，我也会再买一本书*。*）

它尚未发布，但您可以通过 MEAP 计划提前获得。已经有几个章节可用，更多章节即将推出。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-12T11:33:32.280

我认为对于具有 .NET 背景的 C# 开发人员来说，进入函数式编程的最佳方式是学习 F#。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T11:34:50.953

选择一种函数式语言。 [Python](http://www.python.org)有很多功能特性。 [Haskell](http://www.haskell.org/)纯粹是功能性的。

转到[Project Euler](http://projecteuler.net/)。

解决一些问题。

如果您查看 Project Euler 的[统计数据](http://projecteuler.net/index.php?section=statistics)，Python 和 Haskell 的排名非常靠前。

* * *

**编辑**

Python中的函数式编程：

*   [http://www.ibm.com/developerworks/library/l-prog.html](http://www.ibm.com/developerworks/library/l-prog.html)
*   [http://www.amk.ca/python/writing/functional](http://www.amk.ca/python/writing/functional)
*   [http://linuxgazette.net/109/pramode.html](http://linuxgazette.net/109/pramode.html)
*   [http://www.slideshare.net/adambyrtek/functional-programming-with-python-516744](http://www.slideshare.net/adambyrtek/functional-programming-with-python-516744)
*   [http://scott.andstuff.org/FunctionalPython](http://scott.andstuff.org/FunctionalPython)
*   [http://docs.python.org/tutorial/datastructures.html#functional-programming-tools](http://docs.python.org/tutorial/datastructures.html#functional-programming-tools)
*   [http://www.freenetpages.co.uk/hp/alan.gauld/tutfctnl.htm](http://www.freenetpages.co.uk/hp/alan.gauld/tutfctnl.htm)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T13:48:17.980

[Real World Haskell](http://book.realworldhaskell.org/)的免费在线版本是一种不错的廉价入门方式。

完成几章后，您将能够决定 FP 是否适合您，以及您是想继续使用 Haskell 还是继续使用其他语言。你甚至可以继续购买死树版本（就像我一样）。

你从本书中学到的范式，尤其是开篇章节，同样适用于其他函数式语言。（我喜欢认为我的 Javascript 和 Groovy 受益于我学习 Haskell）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T11:34:27.100

花一些时间看看 Lisp 或 Scheme，因为它们是函数式编程的父亲和母亲。[PLT Scheme](http://www.plt-scheme.org/)是使用 Scheme 的绝佳环境。给自己[买一本 The Little Schemer](http://www.ccs.neu.edu/home/matthias/BTLS/)，因为它是对 Scheme 的一个很好的介绍，可以帮助你快速上手。

一旦你了解了函数式，尝试以函数式的方式解决一些[Project Euler](http://projecteuler.net/)问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T11:33:21.360

我在大学学习函数式编程，使用语言[Haskell](http://www.haskell.org/)。

在它的主页上，您很可能会找到入门所需的内容 :)

顺便说一句，需要大量练习才能看到解决方案；因此，算法并不是每个人都习惯用面向对象、逻辑或过程语言进行编码的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T11:35:47.050

我同意 Mehrdad Afshari 的观点。如果您熟悉 C#，请使用 F# 开始函数式编程。语法类似于 C# 中的 lambda 表达式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-14T00:06:40.237

到目前为止，我一直喜欢[向你学习一个 haskell ，这对初学者来说非常好。](http://learnyouahaskell.com/ "向你学习haskell")

# javascript - 寻找基于 Flash/JS 的 SVG 编辑器或编辑框架

> ID：638225
> 
> 赞同：4
> 
> 时间：2009-03-12T11:29:40.450
> 
> 标签：javascript, flash, editor, svg

我正在寻找一个框架或库来创建 SVG 图像。它应该在浏览器中运行，所以它应该基于 Flash 或者 JavaScript。到目前为止，我找到了inevo.pt 的Flash 库，Dojox 的SVG 编辑组件，以及一些小的JavaScript 工具。

还有什么，最好是稳定成熟的？

提前非常感谢！

——安德烈亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T15:39:39.930

导出到 svg 是一个非常简单的步骤。

[从 FLASH 绘制和导出到 svg](http://memo.tv/drawing_and_exporting_svg_from_flash_as3)

[例子](http://memo.tv/files/memotv/SVGExport.swf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T23:18:20.387

你见过拉斐尔吗？[http://raphaeljs.com/](http://raphaeljs.com/)这是一个 JS 绘图框架，根据浏览器的功能以 SVG、Canvas 或 VML 呈现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-16T22:26:54.943

[SVG-Edit](http://svg-edit.googlecode.com) ( [demo](http://svg-edit.googlecode.com/svn/trunk/editor/svg-editor.html) ) 很好用。它是一个基本编辑器，开发人员计划将其迁移到插件架构以启用第三方工具。它与 MoinMoin wiki 很好地集成，以允许内联可编辑图表等。

我认为在一年内会有几个很好的开源编辑器可用，使用不同的基础 JS 库，现在[svg-edit已经打破了基础](http://svg-edit.googlecode.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T19:04:07.663

不太清楚你为什么想要这个。Inkscape 很酷，但不能在浏览器中运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-13T15:42:58.180

你试过 Amaya [http://www.w3.org/Amaya/](http://www.w3.org/Amaya/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T08:37:30.937

我想我在[http://svg.startpagina.nl上有一些](http://svg.startpagina.nl)

# currency - .NET 货币指数 ISO_4217

> ID：638227
> 
> 赞同：0
> 
> 时间：2009-03-12T11:30:35.800
> 
> 标签：currency, iso, exponent

我正在开发一些供国际使用的东西。想知道是否有人可以阐明 CultureInfo 类是否支持查找特定国家的货币指数，或者我是否需要在数据库级别输入这些数据。

我目前看不到任何代表这一点的财产，所以如果有人明确知道它是否存在，那么在我寻找它/从 ISO 购买它之前。

货币指数是货币的次要单位。

[http://en.wikipedia.org/wiki/ISO_4217](http://en.wikipedia.org/wiki/ISO_4217) - 例如英国是“2”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-16T06:08:34.397

查看这篇[关于获取区域的 CultureInfo 的博客文章](http://blogs.neudesic.com/blogs/michael_morozov/archive/2007/01/09/2247.aspx)。基本上，Window 和 .NET 知道用户所在的地区，但不知道他们的货币。一个地区意味着一种货币，但一个国家可以拥有的不仅仅是货币。例如，柬埔寨的一个人很可能比瑞尔更想输入和使用美元。如果可能，在多币种系统中捕获任何货币金额时，您应该捕获货币 ISO 代码。

如果您只是想快速猜测一下，您可以创建一个 CultureInfo 对象并使用它的**NumberDecimalDigits**属性。当国家转换货币时，这也会产生问题。例如，如果白俄罗斯加入欧盟，那么它的货币将从 BYR 变为 EUR。它的货币符号和指数将过时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T06:15:34.540

我查看了这个问题并提供了一个可能会或可能不会满足您需求的解决方案：http: [//www.codeproject.com/KB/recipes/MoneyTypeForCLR.aspx#CurrencyType](http://www.codeproject.com/KB/recipes/MoneyTypeForCLR.aspx#CurrencyType)

简而言之：我将 ISO 规范实现为自定义类型，使用规范本身来生成值。显然，这需要在生产中定期更新......

# xml - XSLT：遍历树状结构

> ID：638239
> 
> 赞同：1
> 
> 时间：2009-03-12T11:34:00.330
> 
> 标签：xml, xslt, tree

我有一个 xml 文档，其中包含一个类别列表：

```
<categories>
    <category id="1" parent="0">Configurations</category>
    <category id="11" parent="13">LCD Monitor</category>
    <category id="12" parent="13">CRT Monitor</category>
    <category id="13" parent="1"">Monitors</category>
    <category id="123" parent="122">Printer</category>
    ...
</categories> 
```

以及产品清单：

```
<products>
  <product>
    ...
   <category>12</category>
    ...
  </product>
    ...
</products> 
```

如果产品的类别等于 12，则应将其转换为“配置/监视器/CRT 监视器”（取类别 12，然后它是父级 (13) 等）。如果 parent 为 0，则停止。

有没有一种优雅的方法可以使用 XSL 转换来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T12:01:59.390

我不知道这是否会被认为是优雅的，但是有了这个输入：

```
<root>
    <categories>
        <category id="1" parent="0">Configurations</category>
        <category id="11" parent="13">LCD Monitor</category>
        <category id="12" parent="13">CRT Monitor</category>
        <category id="13" parent="1">Monitors</category>
        <category id="123" parent="122">Printer</category>
    </categories>
    <products>
        <product>
             <category>12</category>
        </product>
        <product>
             <category>11</category>
        </product>
     </products>
</root> 
```

这个 XSLT：

```
<?xml version="1.0"?>

<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
  <root>
  <xsl:apply-templates select="//product"/>
  </root>
</xsl:template>

<xsl:template match="product">
  <product>
    <path>
      <xsl:call-template name="catwalk">
        <xsl:with-param name="id"><xsl:value-of select="category"/>
        </xsl:with-param>
      </xsl:call-template>
    </path>
  </product>
</xsl:template>

<xsl:template name="catwalk">
  <xsl:param name="id"/>
  <xsl:if test="$id != '0'">
    <xsl:call-template name="catwalk">
      <xsl:with-param name="id"><xsl:value-of select="//category[@id = $id]/@parent"/>
      </xsl:with-param>
    </xsl:call-template>
    <xsl:value-of select="//category[@id = $id]"/><xsl:text>/</xsl:text>
  </xsl:if>
</xsl:template>

</xsl:stylesheet> 
```

会给你这个输出：

```
<?xml version="1.0" encoding="utf-8"?>
  <root>
  <product>
    <path>Configurations/Monitors/CRT Monitor/
    </path>
  </product>
  <product>
     <path>Configurations/Monitors/LCD Monitor/
     </path>
  </product>
  </root> 
```

路径仍然有一个额外的尾部斜杠，您需要另外一点条件 XSLT 以使斜杠仅在您不在第一级时发出。

您的类别层次结构正确至关重要，否则您的转换很容易陷入无限循环，只有在内存不足时才会停止。如果我在真实系统中实现类似的东西，我会很想向 catWalk 模板添加一个参数，该参数在每次调用时递增并将其添加到测试中，以便在 10 次调用后停止循环，无论是否找到父级.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T12:59:12.433

建议使用 an `<xsl:key>`：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="text" />

  <xsl:key name="category" match="categories/category" use="@id" />

  <xsl:template match="/">
    <xsl:apply-templates select="//products/product" />
  </xsl:template>

  <xsl:template match="product">
    <xsl:apply-templates select="key('category', category)" />
    <xsl:text>&#10;</xsl:text>
  </xsl:template>

  <xsl:template match="category">
    <xsl:if test="@parent &gt; 0">
      <xsl:apply-templates select="key('category', @parent)" />
      <xsl:text>/</xsl:text>
    </xsl:if>
    <xsl:value-of select="."/>
  </xsl:template>

</xsl:stylesheet> 
```

这会产生：

```
配置/显示器/液晶显示器
配置/监视器/CRT 监视器

```

在以下 XML 上进行测试时：

```
<data>
  <categories>
    <category id="1" parent="0">Configurations</category>
    <category id="11" parent="13">LCD Monitor</category>
    <category id="12" parent="13">CRT Monitor</category>
    <category id="13" parent="1">Monitors</category>
    <category id="123" parent="122">Printer</category>
  </categories>
  <products>
    <product>
      <category>11</category>
    </product>
    <product>
      <category>12</category>
    </product>
  </products>
</data> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T12:02:32.773

这应该让你足够接近（我一直在努力将 xslt 代码放在这里，所以我已经逃脱了它，希望可以正常工作

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output omit-xml-declaration="yes"/>

  <xsl:template match="/">
    <xsl:call-template name="OutputCategoryTree">
      <xsl:with-param name="productId" select="12"/>
    </xsl:call-template>
  </xsl:template>

  <xsl:template name="OutputCategoryTree">
    <xsl:param name="productId"/>
    <xsl:variable name="parentId" select="/categories/category[@id=$productId]/@parent"/>
    <xsl:if test="$parentId!=0"> 
      <xsl:call-template name="OutputCategoryTree">
        <xsl:with-param name="productId" select="/categories/category[@id=$productId]/@parent"/>
      </xsl:call-template>
    </xsl:if>/
    <xsl:value-of select="/categories/category[@id=$productId]"/>
  </xsl:template>
</xsl:stylesheet> 
```

抱歉粗略的示例代码，但它确实生成

> /配置/监视器/CRT 监视器

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T17:56:10.227

您可以考虑从将类别文档从平面节点列表转换为层次结构开始。这大大简化了转换输入文档的问题。此外，如果您的产品列表很大，它的性能将比在类别层次结构中的每个步骤中搜索平面类别列表的方法要好得多。

```
<xsl:template match="categories">
    <categories>
        <xsl:apply-templates select="category[@parent='0']"/>
    </categories>
</xsl:template>

<xsl:template match="category">
    <category id='{@id}'>
       <xsl:value-of select="text()"/>
       <xsl:apply-templates select="/categories/category[@parent=current()/@id]"/>
    </category>
</xsl:template> 
```

这将产生如下内容：

```
<categories>
    <category id="1">Configurations
       <category id="13">Monitors
          <category id="11">LCD Monitor</category>
           <category id="12">CRT Monitor</category>
       </category>
    </category>
    ...
</categories> 
```

假设您已将转换后的类别文档作为参数传递到 XSLT（或使用`document()`函数将其读入变量），产品模板变得非常简单：

```
<xsl:template match="product"/>
   <xsl:variable name="c" select="$categories/categories/category[@id=current()/category]"/>
   <xsl:foreach select="$c/ancestor-or-self::category">
      <xsl:value-of select="text()"/>
      <xsl:if test="position() != last()">
         <xsl:text>/</xsl:text>
      </xsl:if>
   </xsl:foreach>
</xsl:template> 
```

# c++ - 如何在 Qt 中发出跨线程信号？

> ID：638251
> 
> 赞同：60
> 
> 时间：2009-03-12T11:38:16.280
> 
> 标签：c++, qt, signals-slots, qt-signals

Qt 文档指出信号和槽可以是`direct`,`queued`和`auto`.

它还指出，如果拥有插槽的对象“生活”在与拥有信号的对象不同的线程中，则发出这样的信号就像发布消息一样——信号发出将立即返回，并且插槽方法将在目标线程的事件循环中被调用。

不幸的是，文档没有具体说明“生活”代表什么，也没有可用的示例。我尝试了以下代码：

**`main.h:`**

```
class CThread1 : public QThread
{
Q_OBJECT
public:
    void run( void )
    {
        msleep( 200 );
        std::cout << "thread 1 started" << std::endl;
        MySignal();
        exec();
    }
signals:
    void MySignal( void );
};

class CThread2 : public QThread
{
Q_OBJECT
public:
    void run( void )
    {
        std::cout << "thread 2 started" << std::endl;
        exec();
    }
public slots:
    void MySlot( void )
    {
        std::cout << "slot called" << std::endl;
    }
}; 
```

**`main.cpp:`**

```
int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    CThread1 oThread1;
    CThread2 oThread2;
    QObject::connect( & oThread1, SIGNAL( MySignal() ),
        & oThread2, SLOT( MySlot() ) );
    oThread1.start();
    oThread2.start();
    oThread1.wait();
    oThread2.wait();
    return a.exec();
} 
```

输出是：

```
thread 2 started
thread 1 started 
```

`MySlot()`永远不会被调用:(。我做错了什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-12T13:49:39.707

您的代码存在很多问题：

*   就像 Evan 所说的，缺少 emit 关键字
*   您所有的对象都存在于主线程中，只有运行方法中的代码存在于其他线程中，这意味着 MySlot 插槽将在主线程中被调用，我不确定这是否是您想要的
*   你的插槽永远不会被调用，因为主事件循环永远不会被启动：你对 wait() 的两次调用只会在很长一段时间后超时（并且你可能会在此之前杀死你的应用程序）而且我不认为这也是您想要的，无论如何它们在您的代码中确实没有用。

该代码很可能会起作用（尽管我尚未对其进行测试），并且我认为它可以满足您的要求：

```
class MyObject : public QObject
{
    Q_OBJECT
public slots:
    void MySlot( void )
    {
        std::cout << "slot called" << std::endl;
    }
};

class CThread1 : public QThread
{
    Q_OBJECT
public:
    void run( void )
    {
        std::cout << "thread 1 started" << std::endl;
        int i = 0;
        while(1)
        {
           msleep( 200 );
           i++;
           if(i==1000)
              emit MySignal();
        }
    }
signals:
    void MySignal( void );
};

class CThread2 : public QThread
{
    Q_OBJECT
public:
    void run( void )
    {
        std::cout << "thread 2 started" << std::endl;
        exec();
    }
};

int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    CThread1 oThread1;
    CThread2 oThread2;
    MyObject myObject;
    QObject::connect( & oThread1, SIGNAL( MySignal() ),
        & myObject, SLOT( MySlot() ) );
    oThread2.start();
    myObject.moveToThread(&oThread2)
    oThread1.start();
    return a.exec();
} 
```

现在 MyObject 将存在于 thread2 中（感谢 moveToThread）。

MySignal 应该从 thread1 发送（认为我不确定那个，它可能是从主线程发送的，这并不重要）。

thread1 中不需要事件循环，因为发出信号不需要事件循环。thread2 中需要一个事件循环（由 exec() 启动）来接收信号。

MySlot 将在 thread2 中调用。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2011-12-02T17:24:34.250

## 不要为 Qt 4.4+ 子类化 QThread

虽然 Aiua 的回答很好，但我想指出 QThread 和 Qt 4.6 或 4.7 的一些问题。

这篇文章总结一下：[http ://blog.qt.io/blog/2010/06/17/youre-doing-it-wrong/](http://blog.qt.io/blog/2010/06/17/youre-doing-it-wrong/)

## Qt 方面缺乏文档

不幸的是，问题源于缺乏对文档的更新。在 Qt 4.4 之前，QThread 没有默认的 run() 实现，这意味着您必须继承 QThread 才能使用它。

如果您使用的是 Qt 4.6 或 4.7，那么您几乎可以肯定不应该*继承*QThread。

## 使用 moveToThread

正如 Aiua 指出的那样，让插槽在工作线程中执行的关键是使用 moveToThread 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-22T03:27:49.597

你应该发出信号来启动你的线程函数，比如

```
emit operateCut(examId,examName_examTemplate[examName].studentIdRec,examName_examTemplate[examName].choiceRecA,examName_examTemplate[examName].choiceRecB,examName_examTemplate[examName].objectRecA,examName_examTemplate[examName].objectRecB); 
```

您可以在此信号中添加多个参数

# c++ - 为什么在 VCC 2003 中编译需要这么长时间？

> ID：638260
> 
> 赞同：3
> 
> 时间：2009-03-12T11:43:25.347
> 
> 标签：c++, windows, visual-studio, visual-c++

我的团队需要“Sobol quasi-random number generator”——一种以高质量结果和运行速度而闻名的通用 RNG。我[在网上找到了一个看起来像简单的 C 实现的东西](http://people.scs.fsu.edu/~burkardt/cpp_src/sobol/sobol_old.C)。在家里，我几乎可以使用我的 Linux GCC 编译器立即编译它。

第二天我在工作中尝试了它：如果我在调试模式下在 Visual Studio 中编译大约需要 1 分钟。如果我在发布模式下编译它**大约需要 40 分钟。**

为什么？

我知道“发布”模式会触发一些编译器优化......但是这么小的文件到底怎么可能需要这么长时间来优化？它主要是评论和静态数据。几乎没有什么值得优化的。

这些电脑都不是特别慢，无论如何我知道编译时间在一系列 Windows 电脑上是一致的。我还听说较新版本的 Visual Studio 具有更快的编译时间，但目前我们仍使用 Visual Studio.Net 2003。在 GCC（与 Ubuntu 8.04 捆绑的版本）上编译总是需要几微秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T11:53:41.063

我正在使用 VC++ 2003，它在调试/发布模式下立即编译。

**编辑：**

您的系统上是否安装了最新的服务包？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T12:54:53.240

老实说，我不太确定代码有那么好。里面有一股难闻的味道。即，这个函数：

```
unsigned int i4_xor ( unsigned int i, unsigned int j )

//****************************************************************************80
//
//  Purpose:
//
//    I4_XOR calculates the exclusive OR of two integers.
//
//  Modified:
//
//    16 February 2005
//
//  Author:
//
//   John Burkardt
//
//  Parameters:
//
//    Input, unsigned int I, J, two values whose exclusive OR is needed.
//
//    Output, unsigned int I4_XOR, the exclusive OR of I and J.
//
{
  unsigned int i2;
  unsigned int j2;
  unsigned int k;
  unsigned int l;

  k = 0;
  l = 1;

  while ( i != 0 || j != 0 )
  {
    i2 = i / 2;
    j2 = j / 2;

    if ( 
      ( ( i == 2 * i2 ) && ( j != 2 * j2 ) ) ||
      ( ( i != 2 * i2 ) && ( j == 2 * j2 ) ) )
    {
      k = k + l;
    }

    i = i2;
    j = j2;
    l = 2 * l;
  }

  return k;
} 
```

还有一个 i8_xor。还有几个 abs 函数。

我认为应该在[DailyWTF](http://www.thedailywtf.com/)上发帖。

编辑：对于非 c 程序员，这里是上述内容的快速指南：

```
function xor i:unsigned, j:unsigned
  answer = 0
  bit_position = 1
  while i <> 0 or j <> 0
    if least significant bit of i <> least significant bit of j
      answer = answer + bit_position 
    end if
    bit_position = bit_position * 2
    i = i / 2
    j = j / 2
  end while
  return answer
end function 
```

要确定最低有效位是设置还是清除，使用以下命令：

```
bit set if i <> (i / 2) * 2
bit clear if i == (i / 2) * 2 
```

使代码额外 WTFy 的原因是 C 定义了一个 XOR 运算符，即 '^'。所以，而不是：

```
result = i4_xor (a, b); 
```

你可以有：

```
result = a ^ b; // no function call at all! 
```

最初的程序员真的应该知道 xor 运算符。但即使他们没有（并且承认，这是另一个混​​淆的 C 符号），他们对 XOR 函数的实现也非常糟糕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T11:54:22.823

我建议您下载 Visual Studio 2008 的试用版并尝试在那里进行编译，以查看问题是否与生俱来。此外，如果它*确实*发生在当前版本上，您将能够报告问题，Microsoft 可能会修复它。

另一方面，微软**不可能**修复 VS2003 中的任何错误。

# asp.net - ASP.Net 中的 RunTimeError

> ID：638262
> 
> 赞同：0
> 
> 时间：2009-03-12T11:44:24.173
> 
> 标签：asp.net, vb.net

我正在做 vb 中的 .net 应用程序。在 Internet Explorer 中运行时出现运行时错误，但它在 mozilla 中运行。错误如下

> 错误：SysArgumentTypeException：“AjaxControlToolKit.Animation.Length Animation”类型的对象无法转换为“AjaxControlToolKit.Animation”类型。参数实例。

MicrosoftAjax.debug.js 中出现错误 if(!this.isInstanceOfType(instance)) throw Error.argumentType('instance',ObjectgetType(instance))

这个错误的原因可能是什么。我能做些什么来解决这个问题？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T12:04:28.883

该错误表明，您正在尝试将调用类型`Length Animation`转换为调用类型`Parameter`。在 VB 和 VB.NET 中，如果赋值类型不匹配，则会隐式尝试强制转换。请进一步查看堆栈跟踪以找到错误的确切行。

PS：我不知道 .NET 类型名称中可能有空格...

# c - 在 C 中的函数调用中查找经过时间的计时器

> ID：638269
> 
> 赞同：2
> 
> 时间：2009-03-12T11:46:15.900
> 
> 标签：c, profiling, timer

我想计算 C 函数调用期间经过的时间，精度为 1 纳秒。

C中是否有计时器功能可以做到这一点？

如果是，请提供示例代码片段。

**伪代码**

```
Timer.Start()
foo();
Timer.Stop()
Display time elapsed in execution of foo() 
```

* * *

环境细节： -*在 RHEL 机器上使用 gcc 3.4 编译器*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T16:31:27.327

请问你用的是什么处理器？如果您使用的是 x86 处理器，则可以查看时间戳计数器 ( `tsc`)。此代码片段：

```
#define rdtsc(low,high) \
     __asm__ __volatile__("rdtsc" : "=a" (low), "=d" (high)) 
```

将分别放置 CPU 运行的周期数`low`和`high`（预计为 2`long`秒；您可以将结果存储在 a 中`long long int`），如下所示：

```
inline void getcycles (long long int * cycles)
{
  unsigned long low;
  long high;
  rdtsc(low,high);
  *cycles = high; 
  *cycles <<= 32; 
  *cycles |= low; 
} 
```

请注意，这将返回您的 CPU 已执行的周期数。您需要获得 CPU 速度，然后计算出每 ns 有多少个周期才能获得经过的 ns 数。

为此，我将 "cpu MHz" 字符串从 中解析出来`/proc/cpuinfo`，并将其转换为十进制。在那之后，这只是一些数学运算，记住 1MHz = 1,000,000 个周期每秒，并且有 10 亿纳秒/秒。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T11:52:42.983

在 Intel 和兼容的处理器上，您可以使用 rdtsc 指令，该指令可以轻松地包装到 C 代码的 asm() 块中。它返回在每个周期递增的内置处理器周期计数器的值。您获得高分辨率，这样的时间非常快。

要找到这个增量的速度，您需要校准 - 在固定时间段（如五秒）内调用此指令两次。如果您在将频率转移以降低功耗的处理器上执行此操作，则可能会遇到校准问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T21:43:07.890

使用`clock_gettime(3)`. 有关详细信息，请键入`man 3 clock_gettime`。话虽如此，很少需要纳秒精度。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T11:48:44.880

任何计时器功能都必须是特定于平台的，尤其是在具有这种精度要求的情况下。

POSIX 系统中的标准解决方案是`gettimeofday()`，但它只有微秒级精度。

如果这是为了性能基准测试，标准的方法是让被测代码花费足够的时间来降低精度要求。换句话说，运行您的测试代码一整秒（或更长时间）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T11:50:21.553

c 中没有计时器可以保证 1 纳秒的精度。您可能想要研究`clock()`或更好的 POSIX`gettimeofday()`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-23T09:59:04.463

We all waste our time recreating this test sample. Why not post something compile ready? Anyway, here is mine with results.

```
CLOCK_PROCESS_CPUTIME_ID resolution: 0 sec 1 nano
clock_gettime 4194304 iterations : 459.427311 msec 0.110 microsec / call
CLOCK_MONOTONIC resolution: 0 sec 1 nano
clock_gettime 4194304 iterations : 64.498347 msec 0.015 microsec / call
CLOCK_REALTIME resolution: 0 sec 1 nano
clock_gettime 4194304 iterations : 65.494828 msec 0.016 microsec / call
CLOCK_THREAD_CPUTIME_ID resolution: 0 sec 1 nano
clock_gettime 4194304 iterations : 427.133157 msec 0.102 microsec / call
rdtsc 4194304 iterations : 115.427895 msec 0.028 microsec / call
Dummy 16110479703957395943
rdtsc in milliseconds 4194304 iterations : 197.259866 msec 0.047 microsec / call
Dummy 4.84682e+08 UltraHRTimerMs 197 HRTimerMs 197.26

#include <time.h>
#include <cstdio>
#include <string>
#include <iostream>
#include <chrono>
#include <thread>

enum { TESTRUNS = 1024*1024*4 };

class HRCounter
{
private:
    timespec start, tmp;
public:
    HRCounter(bool init = true)
    {
        if(init)
            SetStart();
    }

    void SetStart()
    {
        clock_gettime(CLOCK_MONOTONIC, &start);
    }

    double GetElapsedMs()
    {
        clock_gettime(CLOCK_MONOTONIC, &tmp);
        return (double)(tmp.tv_nsec - start.tv_nsec) / 1000000 + (tmp.tv_sec - start.tv_sec) * 1000;
    }
};

__inline__ uint64_t rdtsc(void) {
    uint32_t lo, hi;
    __asm__ __volatile__ (      // serialize
    "xorl %%eax,%%eax \n        cpuid"
    ::: "%rax", "%rbx", "%rcx", "%rdx");
    /* We cannot use "=A", since this would use %rax on x86_64 and return only the lower 32bits of the TSC */
    __asm__ __volatile__ ("rdtsc" : "=a" (lo), "=d" (hi));
    return (uint64_t)hi << 32 | lo;
}

inline uint64_t GetCyclesPerMillisecondImpl()
{
    uint64_t start_cyles = rdtsc();
    HRCounter counter;
    std::this_thread::sleep_for (std::chrono::seconds(3));
    uint64_t end_cyles = rdtsc();
    double elapsed_ms = counter.GetElapsedMs();
    return (end_cyles - start_cyles) / elapsed_ms;
}

inline uint64_t GetCyclesPerMillisecond()
{
    static uint64_t cycles_in_millisecond = GetCyclesPerMillisecondImpl();
    return cycles_in_millisecond;
}

class UltraHRCounter
{
private:
    uint64_t start_cyles;
public:
    UltraHRCounter(bool init = true)
    {
        GetCyclesPerMillisecond();
        if(init)
            SetStart();
    }

    void SetStart() { start_cyles = rdtsc(); }

    double GetElapsedMs()
    {
        uint64_t end_cyles = rdtsc();
        return (end_cyles - start_cyles) / GetCyclesPerMillisecond();
    }
};

int main()
{
    auto Run = [](std::string const& clock_name, clockid_t clock_id)
    {
        HRCounter counter(false);
        timespec spec;
        clock_getres( clock_id, &spec );
        printf("%s resolution: %ld sec %ld nano\n", clock_name.c_str(), spec.tv_sec, spec.tv_nsec );
        counter.SetStart();
        for ( int i = 0 ; i < TESTRUNS ; ++ i )
        {
            clock_gettime( clock_id, &spec );
        }
        double fb = counter.GetElapsedMs();
        printf( "clock_gettime %d iterations : %.6f msec %.3f microsec / call\n", TESTRUNS, ( fb ), (( fb ) * 1000) / TESTRUNS );
    };

    Run("CLOCK_PROCESS_CPUTIME_ID",CLOCK_PROCESS_CPUTIME_ID);
    Run("CLOCK_MONOTONIC",CLOCK_MONOTONIC);
    Run("CLOCK_REALTIME",CLOCK_REALTIME);
    Run("CLOCK_THREAD_CPUTIME_ID",CLOCK_THREAD_CPUTIME_ID);

    {
        HRCounter counter(false);
        uint64_t dummy;
        counter.SetStart();
        for ( int i = 0 ; i < TESTRUNS ; ++ i )
        {
            dummy += rdtsc();
        }
        double fb = counter.GetElapsedMs();
        printf( "rdtsc %d iterations : %.6f msec %.3f microsec / call\n", TESTRUNS, ( fb ), (( fb ) * 1000) / TESTRUNS );
        std::cout << "Dummy " << dummy << std::endl;
    }

    {
        double dummy;
        UltraHRCounter ultra_hr_counter;
        HRCounter counter;
        for ( int i = 0 ; i < TESTRUNS ; ++ i )
        {
            dummy += ultra_hr_counter.GetElapsedMs();
        }
        double fb = counter.GetElapsedMs();
        double final = ultra_hr_counter.GetElapsedMs();
        printf( "rdtsc in milliseconds %d iterations : %.6f msec %.3f microsec / call\n", TESTRUNS, ( fb ), (( fb ) * 1000) / TESTRUNS );
        std::cout << "Dummy " << dummy << " UltraHRTimerMs " << final << " HRTimerMs " << fb << std::endl;
    }

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T11:51:44.983

我不知道您是否会找到任何提供单纳秒分辨率的计时器——这取决于系统时钟的分辨率——但你可能想看看[http://code.google.com/ p/高分辨率计时器/](http://code.google.com/p/high-resolution-timer/)。它们表明它们可以在大多数 Linux 系统上提供微秒级的分辨率，在 Sun 系统上可以提供纳秒级的分辨率。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T11:53:12.703

在这种规模上进行基准测试并不是一个好主意。您至少需要花费时间来获取时间，如果您在纳秒级上工作，这可能会使您的结果不可靠。您可以在更大范围内使用您的平台系统调用或[boost::Date_Time [首选]。](http://www.boost.org/doc/libs/1_38_0/doc/html/date_time.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T08:42:31.877

如果您确定您的进程获得 100% 的 CPU 时间，则可以使用标准系统调用，如 gettimeofday。我可以想到很多情况，当您执行 foo () 时，其他线程和进程可能会占用 CPU 时间。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T16:55:07.723

你能运行 10^9 次然后秒表吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-11T07:03:54.060

您正在要求以这种方式不可能的事情。您将需要硬件级别的支持才能达到该级别的精度，甚至需要非常小心地控制变量。如果在运行代码时遇到中断会发生什么？如果操作系统决定运行其他代码怎么办？

你的代码是做什么的？它使用RAM内存吗？如果您的代码和/或数据在缓存中或不在缓存中怎么办？

在某些环境中，只要您控制这些变量，您就可以为此作业使用硬件级别计数器。但是如何防止 Linux 中的上下文切换呢？

例如，在 Texas Instruments 的 DSP 工具（Code Composer Studio）中，您可以非常准确地分析代码，因为整个调试环境已设置为模拟器（例如 Blackhawk）接收有关每个操作运行的信息。您还可以设置观察点，这些观察点直接编码到某些处理器的芯片内部的硬件块中。这是有效的，因为内存通道也被路由到这个调试块。

他们确实在其 CSL（芯片支持库）中提供了您所要求的功能，而时序开销只有几个周期。但这仅适用于他们的处理器，并且完全依赖于从硬件寄存器中读取定时器值。

# .net - 社交多人浏览器游戏的架构（后端选择 + 前端选择 [flash/silverlight]）

> ID：638272
> 
> 赞同：4
> 
> 时间：2009-03-12T11:48:07.580
> 
> 标签：.net, silverlight, multiplayer, python-stackless

我正在考虑开发在线多人社交游戏。世界的共享状态需要在后端有一些快速的东西，所以潜在的解决方案似乎是：

1.  服务器上的快速游戏引擎（例如 c++）和一些前端语言（php/python/ruby）+ flash

2.  python中的整个堆栈（使用扭曲或无堆栈python）+ flash

3.  .NET（asp.net 或 asp.net mvc）+ 闪存

4.  .NET + 银光

从生产力的角度来看，第一个可能是过度杀伤（3 个异构层）

编号。4 可能是程序员的天堂（所有层的公共环境），但是：

*   从来没有用 Silverlight 构建过这样的东西，也许在拐角处隐藏着一些令人兴奋的东西
*   可能很难找到 Silverlight 设计师
*   尽管 Flash 电影/剪辑模型与 SL 完整 OO 架构相比受到批评，但在外部设计师设计虚拟世界的额外部分时，它不是一个优势吗？他们可以用例如准备.swf。4 帧上的 4 个项目的视角 - 使用 SL 会不会更难？
*   Silvelight 显然缺乏一些游戏功能（如碰撞检测）

你怎么看？

[编辑] 游戏本身将成为更大门户的一部分 - 因此将引擎与一些 Web 框架集成会很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-10T14:28:37.703

我花了一年时间开发一个大型多人在线游戏，前端使用 Silverlight，后端使用 Python（我实际上在 Silverlight 中使用 IronPython，以简化开发）

Silverlight 非常适合这个，我不会在其他任何方面做一个严肃的在线游戏。它已经拥有 35% 的市场份额，当你完成开发时，它应该足够高，不再重要。对于严肃的游戏，大多数人真的不介意安装 4MB 浏览器插件。如果你只是想要一个小行星克隆，使用闪光灯。

如果必须重做，我想我会为服务器保留 Python，因为它是我最熟练的服务器技术，但我认为我会在前端使用 C# 并使用 JSON 来传递数据。

我能给你的最好建议是：

1.  尽可能利用现有的库和代码
2.  不要过早地考虑性能

最困难的部分将是完成游戏，使用您熟悉的技术，并优化您的时间，而不是代码。希望你能做我做不到的事——完成该死的游戏:)

**编辑**

关于如果我不得不重新使用 C# 的原因：

IronPython 有它的优点和缺点。很高兴我可以在服务器和客户端之间共享代码文件（常量、模型等）。进行更改并刷新浏览器以查看它真是太棒了。调试不如 C# 友好。

但在某些方面，它是 C# 的二等公民，数据绑定不起作用，并且您不能在 xaml 中使用 IronPython 类。加载时间是个问题，所以我实际上花了很多精力在后台线程上设置并行导入以加快速度。由于涉及到 xaml 的第二公民身份，我使用模板语言来生成 xaml，就好像它是 html 一样，这实际上比数据绑定更好，但是在 IronPython 中没有 python 模板语言工作，所以我自己编写了 (另一个时间沉没。）

为了启用共享模型，我必须编写自己的 ORM。这很容易。但是为了传输它们，我传递了 JSON 并制作了一种优化的二进制格式，而不是在 IronPython 和 Python 之间工作。那是另一个时间沉没。

事后看来，我不应该被所有那些兔子足迹分心。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T15:34:38.913

Twisted 已成功用于此目的。基于异步调用它对于需要持久连接的应用程序非常有效。它还有一个很好的 RTMP 实现，可与 flash 一起使用。检查 chesspark，它是用 Twisted 构建的：

[http://www.chesspark.com/](http://www.chesspark.com/)

另外，游戏引擎并不一定要使用 c/c++。取决于游戏的复杂性和类型。但也有相当不错的 pygame 库。

就我个人而言，我不鼓励您使用 Silverlight。flash 插件被更好地采用并且将在可预见的将来继续使用，尤其是在非 ms 操作系统上。不要把这个放在心上，但我不会安装 silverlight 只是为了看你的游戏。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T15:22:28.990

选项 2——使用无堆栈 Python——是 Eve Online 使用的。

[http://support.eve-online.com/Pages/KB/Article.aspx?id=128](http://support.eve-online.com/Pages/KB/Article.aspx?id=128)

* * *

**编辑**

当然，除非您拥有实际的软件，否则不可能创建一个性能相当好的架构。所以，这里的任何判断都只是无谓的猜测。

但是，请考虑以下内容。

1.  静态内容（.js 文件、.css、.png 等）往往会支配您的网络带宽。您必须使用反向代理服务器（例如 squid）来处理此问题。

2.  Squid 必须从某个地方获取内容。您需要一个轻量级文件服务器，为 squid 提供静态内容。Nginx 或 lighttpd 什么的。Apache 将为此工作，但是——在某种程度上——它可能是矫枉过正的。

3.  您的动态内容——它看起来——将有两种形式。

    *   JSON 支持游戏。

    *   支持门户的 HTML。

    为此，您对 mod_wsgi 引擎最满意。阿帕奇当然会这样做；ngingnx 和 lighttpd 也可以工作。

    *   您的 JSON 内容应该是一组 URI。REST 是一种很好的设计模式。通过 mod_wsgi，它们使用无堆栈 Python 连接到面向游戏的服务器——如果有必要的话。您的前端（例如 Apache）有一个位置、目录或虚拟主机来过滤这些 URI 并将它们路由到为游戏提供服务的 mod_wsgi 守护程序。看看[Wekzeug](http://werkzeug.pocoo.org/)来构建它。

    *   您的 HTML 内容是另一组 URI。通过 mod_wsgi，它们连接到运行传统 Python 的 Django 服务器。您的前端（例如 Apache）有一个位置、目录或虚拟主机来过滤这些 URI 并将它们路由到 mod_wsgi 守护进程。

# c++ - 从内存中的某个位置加载 DLL

> ID：638277
> 
> 赞同：13
> 
> 时间：2009-03-12T11:50:22.960
> 
> 标签：c++, c, winapi, dll

正如问题所说，我想从内存中的位置而不是文件中加载 DLL，类似于 LoadLibrary(Ex)。我不是 WinAPI 方面的专家，所以在谷歌上搜索了一下，发现[这篇文章](http://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/)和 MemoryModule 库几乎可以满足我的需求。

另一方面，那里的信息很旧，图书馆也有一段时间没有更新了。所以我想知道是否有不同的、更新的和更好的方法来做到这一点。另外，如果有人使用了文章中提到的库，他们能否提供有关我在使用它时可能面临的问题的见解？

只是为了好奇，我正在探索为应用程序加密一些插件而不将解密版本存储在磁盘上的概念。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T12:31:34.000

实现你自己的 DLL 加载器会很快变得非常麻烦。阅读这篇文章很容易错过你可以让自己陷入什么样的疯狂边缘情况。我强烈建议不要这样做。
只是为了品尝 - 考虑到您不能对正在加载的 DLL 中的代码使用任何常规调试工具，因为您正在执行的代码未列在操作系统已知的任何 DLL 的区域中。另一个严重的问题是在 Windows
中处理[DEP 。](http://en.wikipedia.org/wiki/Data_Execution_Prevention)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T23:40:17.560

好吧，您可以根据[这些说明](http://www.picobay.com/projects/2006/06/how-to-make-windows-xp-ram-disk-drive.html)创建一个 RAM 驱动器，然后将您可以在内存中的 DLL 复制到那里的文件并使用 LoadLibrary()。
当然，如果您打算将其部署为某种产品，这不是很实用，因为人们会注意到正在安装驱动程序，安装后重新启动以及“我的电脑”下的新驱动器号。此外，这并没有真正隐藏 DLL，因为它只是放在 RAM 驱动器中供所有人观看。

我感兴趣的另一件事是你为什么要这样做？也许您的最终结果可以通过从内存加载 DLL 以外的其他方式来实现。例如，当使用诸如[UPX](http://en.wikipedia.org/wiki/UPX)之类的二进制打包程序时，磁盘上的 DLL 与最终执行的 DLL 不同。在使用 LoadLibrary 正常加载 DLL 后，解包器立即启动并使用未压缩的二进制文件重写 DLL 加载到的内存（DLL 标头确保分配了足够的空间）

# c++ - 如何静态链接到 TBB？

> ID：638278
> 
> 赞同：19
> 
> 时间：2009-03-12T11:50:26.733
> 
> 标签：c++, linker, tbb

如何将[英特尔的 TBB 库](http://www.threadingbuildingblocks.org/)静态链接到我的应用程序？我知道调度程序的负载分配不公[平等所有注意事项](http://www.threadingbuildingblocks.org/wiki/index.php?title=Using_TBB)，但我不需要调度程序，只需要容器，所以没关系。

无论如何，我知道这是可以做到的，尽管它没有记录，但是我现在似乎找不到这样做的方法（尽管我以前在某个地方见过它）。

那么有人知道或有任何线索吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-10-30T13:55:12.423

强烈不建议这样做：

> 是否有提供静态链接库的 TBB 版本？
> 
> TBB 不作为静态链接库提供，原因如下*：
> 
> 大多数图书馆在本地运营。例如，英特尔(R) MKL FFT 转换数组。FFT 有多少个副本无关紧要。多个副本和版本可以毫无困难地共存。但是一些库控制程序范围的资源，例如内存和处理器。例如，垃圾收集器控制整个程序的内存分配。类似地，TBB 控制跨程序的任务调度。为了有效地完成工作，这些中的每一个都必须是单例；也就是说，有一个可以协调整个程序的活动的唯一实例。在单个程序中允许 k 个 TBB 调度程序实例将导致软件线程的数量是硬件线程的 k 倍。该程序将低效运行，因为机器将被超额订阅 k 倍，导致更多的上下文切换，缓存争用和内存消耗。此外，当嵌套并行性源自不同调度程序的嵌套调用时，TBB 对嵌套并行性的有效支持将被否定。
> 
> 创建程序范围的单例最实用的解决方案是包含单例的动态共享库。当然，如果调度程序可以合作，我们就不需要单例了。但是这种合作需要一个集中的代理来进行通信；也就是单例！
> 
> 我们决定省略 TBB 的静态链接版本的决定很大程度上受到了我们的 OpenMP 经验的影响。与 TBB 一样，OpenMP 也尝试跨程序进行调度。曾经提供过静态版本的 OpenMP 运行时，它一直是重复调度程序引起的问题的源头。我们认为最好不要重蹈覆辙。作为这些考虑的有效性的间接证明，我们可以指出 Microsoft Visual C++ 仅通过动态库提供 OpenMP 支持这一事实。

来源：[http ://www.threadingbuildingblocks.org/faq/11#stash.t3BrizFQ.dpuf](http://www.threadingbuildingblocks.org/faq/11#sthash.t3BrizFQ.dpuf)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-08-09T18:56:19.537

**编辑**- 更改为使用`extra_inc`. 谢谢杰夫！

使用以下参数构建：

```
make extra_inc=big_iron.inc 
```

将构建静态库。请参阅 中的注意事项`build/big_iron.inc`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-23T04:05:54.057

# 从源代码构建静态库

从[https://www.threadingbuildingblocks.org/](https://www.threadingbuildingblocks.org/)获取源代码后，像这样构建 TBB：

`make extra_inc=big_iron.inc`

如果您需要额外的选项，则改为这样构建：

`make extra_inc=big_iron.inc <extra options>`

# 每个节点运行多个 TBB 程序

如果您运行多处理应用程序，例如使用 MPI，您可能需要使用适当数量的线程显式初始化 TBB 调度程序以避免超额订阅。

可以在[https://github.com/madness/madness/blob/master/src/madness/world/thread.cc](https://github.com/m-a-d-n-e-s-s/madness/blob/master/src/madness/world/thread.cc)中找到大型应用程序中的一个示例。

# 评论文档

此功能已可用多年（至少从 2013 年开始），尽管由于其他答案中描述的原因未记录在案。

# 历史记录

最初开发此功能是因为 IBM Blue Gene 和 Cray 超级计算机不支持共享库，或者由于缺乏本地安装的文件系统而在使用它们时性能不佳。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-03T09:34:24.090

使用开源版本：

运行“make tbb”后，进入 build/linux_xxxxxxxx_release 文件夹。

然后运行：

```
ar -r libtbb.a concurrent_hash_map.o concurrent_queue.o concurrent_vector.o 
dynamic_link.o itt_notify.o cache_aligned_allocator.o pipeline.o queuing_mutex.o 
queuing_rw_mutex.o reader_writer_lock.o spin_rw_mutex.o spin_mutex.o critical_section.o
task.o tbb_misc.o tbb_misc_ex.o mutex.o recursive_mutex.o condition_variable.o 
tbb_thread.o concurrent_monitor.o semaphore.o private_server.o rml_tbb.o 
task_group_context.o governor.o market.o arena.o scheduler.o observer_proxy.o 
tbb_statistics.o tbb_main.o concurrent_vector_v2.o concurrent_queue_v2.o 
spin_rw_mutex_v2.o task_v2.o 
```

你应该得到 libtbb.a 作为输出。

请注意，您的程序应同时使用“-ldl”和 libtbb.a 构建

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-04T23:52:33.333

虽然没有得到 TBB 团队的正式认可，但可以使用`make extra_inc=big_iron.inc`.

我没有在 Windows 或 MacOS 上测试过它，但在 Linux 上，它可以工作（[来源](https://github.com/philipp-classen/tbb-static-linking-tutorial/blob/master/Dockerfile#L13)）：

```
wget https://github.com/01org/tbb/archive/2017_U6.tar.gz
tar xzfv 2017_U6.tar.gz
cd tbb-2017_U6
make extra_inc=big_iron.inc 
```

生成的文件在`tbb-2017_U6/build/linux*release`.

当您将应用程序链接到静态 TBB 版本时：

*   `-static`使用开关调用 g++
*   链接到 tbb ( `-ltbb`) 和 pthread ( `-lpthread`)

在我的测试中，我还需要明确引用`.o`手动构建的 TBB 版本中的所有文件。根据您的项目，您可能还需要传递`-pthread`给 gcc。

我创建了一个玩具示例来记录此 Github 存储库中的所有步骤：

*   [tbb-静态链接教程](https://github.com/philipp-classen/tbb-static-linking-tutorial)

它还包含测试代码，以确保生成的二进制文件可在其他 Linux 发行版上移植。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-29T12:55:53.320

不幸的是，这似乎不可能：[来自 TBB 网站。](http://www.threadingbuildingblocks.org/wiki/index.php?title=Using_TBB#Is_there_a_version_of_TBB_that_provides_statically_linked_libraries.3F).
英特尔论坛上的一项建议是，如果您确实需要静态链接，请手动编译：[来自英特尔论坛](http://software.intel.com/en-us/forums/intel-threading-building-blocks/topic/64241/)。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-02-01T15:52:35.733

只需链接文件，我只是做了它并且工作。这是 SConscript 文件。有两件小事，一个在 tbb 和 tbbmalloc 中具有相同名称的符号，我必须防止它被多次定义，并且我阻止了 ITT_NOTIFY 的使用，因为它在两个库中创建了另一个具有相同名称的符号。

```
Import('g_CONFIGURATION')
import os
import SCutils
import utils

tbb_basedir = os.path.join(
    g_CONFIGURATION['basedir'],
    '3rd-party/tbb40_233oss/')

#print 'TBB base:', tbb_basedir
#print 'CWD: ', os.getcwd()

ccflags = []
cxxflags = [
    '-m64',
    '-march=native',
    '-I{0}'.format(tbb_basedir),
    '-I{0}'.format(os.path.join(tbb_basedir, 'src')),
    #'-I{0}'.format(os.path.join(tbb_basedir, 'src/tbb')),
    '-I{0}'.format(os.path.join(tbb_basedir, 'src/rml/include')),
    '-I{0}'.format(os.path.join(tbb_basedir, 'include')),
]
cppdefines = [
#    'DO_ITT_NOTIFY',
    'USE_PTHREAD',
    '__TBB_BUILD=1',
]
linkflags = []

if g_CONFIGURATION['build'] == 'debug':
    ccflags.extend([
        '-O0',
        '-g',
        '-ggdb2',
    ])
    cppdefines.extend([
        'TBB_USE_DEBUG',
    ])

else:
    ccflags.extend([
        '-O2',
    ])

tbbenv = Environment(
    platform = 'posix',
    CCFLAGS=ccflags,
    CXXFLAGS=cxxflags,
    CPPDEFINES=cppdefines,
    LINKFLAGS=linkflags
)

############################################################################
# Build verbosity
if not SCutils.has_option('verbose'):
    SCutils.setup_quiet_build(tbbenv, True if SCutils.has_option('colorblind') else False)
############################################################################

tbbmallocenv = tbbenv.Clone()

tbbmallocenv.Append(CCFLAGS=[
    '-fno-rtti',
    '-fno-exceptions',
    '-fno-schedule-insns2',
])

#tbbenv.Command('version_string.tmp', None, '')

# Write version_string.tmp
with open(os.path.join(os.getcwd(), 'version_string.tmp'), 'wb') as fd:
    (out, err, ret) = utils.xcall([
        '/bin/bash',
        os.path.join(g_CONFIGURATION['basedir'], '3rd-party/tbb40_233oss/build/version_info_linux.sh')
    ])

    if ret:
        raise SCons.Errors.StopError('version_info_linux.sh execution failed')

    fd.write(out);
    #print 'put version_string in', os.path.join(os.getcwd(), 'version_string.tmp')
    #print out
    fd.close()

result = []

def setup_tbb():
    print 'CWD: ', os.getcwd()
    tbb_sources = SCutils.find_files(os.path.join(tbb_basedir,'src/tbb'), r'^.*\.cpp$')
    tbb_sources.extend([
        'src/tbbmalloc/frontend.cpp',
        'src/tbbmalloc/backref.cpp',
        'src/tbbmalloc/tbbmalloc.cpp',
        'src/tbbmalloc/large_objects.cpp',
        'src/tbbmalloc/backend.cpp',
        'src/rml/client/rml_tbb.cpp',
    ])

    print tbb_sources
    result.append(tbbenv.StaticLibrary(target='libtbb', source=tbb_sources))

setup_tbb()

Return('result') 
```

# wpf - WPF - 令人困惑的 DataTrigger/DoubleAnimation 行为

> ID：638279
> 
> 赞同：1
> 
> 时间：2009-03-12T11:51:03.207
> 
> 标签：wpf, datatrigger, layouttransform

我正在尝试根据绑定到我的类上的布尔值来为 a 的属性设置动画`ScaleY`。当（当应用程序首次启动时）第一次看到该值为假时，并且当我在复选框的选中事件中第一次将其更改为 true 时，但当我在同一个复选框的未选中事件中将其设置为 false 时，动画会发生。`LayoutTransform``DataTrigger``ViewModel``DataTrigger`

下面列出了我正在做的事情的简化版本。

ViewModel 类非常简单，包含一个`DependencyProperty`名为 Selected 的布尔值。

```
 public class VM : DependencyObject
{
    public bool Selected
    {
        get { return (bool)GetValue(SelectedProperty); }
        set { SetValue(SelectedProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Selected.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty SelectedProperty =
        DependencyProperty.Register("Selected", typeof(bool), typeof(VM), new UIPropertyMetadata(false));
} 
```

`Window.xaml`包含一个按钮和一个复选框。当复选框被选中时，我将 ViewModel 的“Selected”属性设置为 true ，在未选中时设置为 false 。这是 xaml 及其代码隐藏的代码。

```
<Window x:Class="DataTriggers.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:y="clr-namespace:DataTriggers"
Title="Window1" Height="300" Width="300">
<Window.Resources>
    <y:VM x:Key="VM"/>

    <Style TargetType="Button" x:Key="but">
        <Style.Triggers>
            <DataTrigger Binding="{Binding Selected}" Value="False">
                <DataTrigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Duration="0:0:1"
                                             To="0"
                                             Storyboard.TargetProperty="(LayoutTransform).(ScaleTransform.ScaleY)"/>
                        </Storyboard>
                    </BeginStoryboard>
                </DataTrigger.EnterActions>
            </DataTrigger>
            <DataTrigger Binding="{Binding Selected}" Value="True">
                <DataTrigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Duration="0:0:1"
                                             To="1"
                                             Storyboard.TargetProperty="(LayoutTransform).(ScaleTransform.ScaleY)"/>
                        </Storyboard>
                    </BeginStoryboard>
                </DataTrigger.EnterActions>
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Window.Resources>
<StackPanel>

            <Button Style="{StaticResource but}" DataContext="{StaticResource VM}">
        <Button.LayoutTransform>
            <ScaleTransform></ScaleTransform>
        </Button.LayoutTransform>
            me
            </Button>
    <CheckBox Checked="CheckBox_Checked" Unchecked="CheckBox_Unchecked"/>
</StackPanel> 
```

```
 public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
    }

    private void CheckBox_Checked(object sender, RoutedEventArgs e)
    {

        VM vm = this.FindResource("VM") as VM;
        vm.Selected = true;
    }

    private void CheckBox_Unchecked(object sender, RoutedEventArgs e)
    {
        VM vm = this.FindResource("VM") as VM;
        vm.Selected = false;
    }
} 
```

我知道`DataTrigger`当属性为假时会触发，因为如果我将属性更改`DoubleAnimation`为简单的`Setter`操作，`Opacity`那么我会看到正确的结果。所以这似乎是我如何使用`DoubleAnimation`.

任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T12:48:45.737

这是奇怪的行为，但我决定像这样将“错误”案例重构为 DataTrigger 的 ExitActions -

```
<DataTrigger Binding="{Binding Selected}" Value="True">
                <DataTrigger.EnterActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Duration="0:0:1"
                                             To="1"
                                             Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleY)"/>
                        </Storyboard>
                    </BeginStoryboard>
                </DataTrigger.EnterActions>
                <DataTrigger.ExitActions>
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Duration="0:0:1"
                                             To="0"
                                             Storyboard.TargetProperty="(RenderTransform).(ScaleTransform.ScaleY)"/>
                        </Storyboard>
                    </BeginStoryboard>
                </DataTrigger.ExitActions>
            </DataTrigger> 
```

这按预期工作。我不知道这两种情况有什么区别，但至少这是一个答案。

# perl - “未定义的子例程 &HTML::Entities::decode_entities 调用”

> ID：638285
> 
> 赞同：-1
> 
> 时间：2009-03-12T11:52:27.353
> 
> 标签：perl

我收到错误

> 未定义的子例程 &HTML::Entities::decode_entities 调用`

使用[LWP::UserAgent](http://search.cpan.org/dist/libwww-perl)，尽管模块在那里，以及[HTML::Parser](http://search.cpan.org/dist/HTML-Parser)模块。

我怀疑这与缺少 XS 模块有关，因为有问题的功能似乎是在 XS 中实现的，但我不知所措。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T05:50:55.627

最新版本的 HTML::Entities 依赖于通过加载 HTML::Parser 模块的 XS 组件来获取 decode_entities 例程。由于这两个模块是一起分布的，这应该不是问题，但是您可能有一个较旧的 HTML::Parser 版本而不使用 XS（或者安装了多个版本的 HTML::Parser，错误的一个是首先找到）。

[检查 HTML::Parser 中的 $VERSION，在http://search.cpan.org/dist/HTML-Parser](http://search.cpan.org/dist/HTML-Parser)上查找该发行版，并验证该发行版具有您拥有的 HTML::Entities 版本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-12T12:02:14.287

你错过了这一行：

```
use HTML::Entities; 
```

在[HTML::Entities](http://search.cpan.org/~gaas/HTML-Parser/) [CPAN page](http://search.cpan.org/~gaas/HTML-Parser-3.60/lib/HTML/Entities.pm)中，应该像这样使用它：

```
use HTML::Entities;
my $a = "V&aring;re norske tegn b&oslash;r &#230res";
decode_entities($a);
encode_entities($a, "\200-\377"); 
```

如果您认为 HTML::Entities 包有问题，可以检查系统上的源代码。来自 bash：

```
vim $(perldoc -l HTML::Entities) 
```

在文本编辑器中打开文件后，您可以检查子例程是否已定义。我怀疑这个包是正确的，但很有可能这个包没有被“使用”。

你也可以在命令行中测试它，看看它是否在你的程序之外工作：

```
perl -MHTML::Entities -le 'print HTML::Entities::decode_entities( "V&aring;re norske tegn b&oslash;r &#230res" )' 
```

# php - 从字符串中提取 [flv:example.flv 465 301] 的正则表达式

> ID：638288
> 
> 赞同：0
> 
> 时间：2009-03-12T11:53:14.340
> 
> 标签：php, regex

```
$content = preg_match('/[flv[^/]]+:(.*?)[^/]]*/]','', $content); 
```

有人能给我从字符串中提取 [flv:example.flv 465 301] 的正则表达式吗？另外，我想将 example.flv 放入数组的第二个元素，并将维度放入第三个元素。我已经尝试了上面的正则表达式，但它失败了。任何帮助将非常感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:57:57.933

您需要转义文字方括号，否则它们将被视为字符类。另外，我不确定您在做什么，`[^/]`因为您的示例不包含`/`.

```
/\[flv:(.*?) (\d+ \d+)\]/ 
```

或分离出尺寸：

```
/\[flv:(.*?) (\d+) (\d+)\]/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T11:59:20.253

当我做对时，您的字符串中有 4 个部分：

*   'flv:'
*   文件名 => [^\h]+
*   整数 => [0-9]+
*   整数 => [0-9]+

这将组装成类似的东西

```
'/flv:[^\h]+\h+[0-9]+\h+[0-9]+/' 
```

然后你需要将这些东西包装成括号，你就完成了：

```
preg_match('/flv:([^\h]+)\h+([0-9]+)\h+([0-9]+)/', $string, $matches);
$file = $matches[1];
$width = $matches[2];
$height = $matches[3]; 
```

# sql - 在 SQL 中，如何将货币数据类型转换为小数？

> ID：638290
> 
> 赞同：10
> 
> 时间：2009-03-12T11:53:31.047
> 
> 标签：sql, types, decimal, currency

我想将货币数据类型转换为小数，因为我想将结果记录到小数点后 8 位。

例如，在货币汇率表中，我看到存储为 2871047428.20 的汇率作为货币数据类型；使用 Microsoft SQL Management Studio，我想将其除以 10000000 以获得结果 287.10474282；但是我实际得到的结果是 287.1047。

我相信我只得到小数点后 4 位的原因是因为它是货币数据类型，因此我认为前进的方向是将其转换为十进制数据类型......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T12:19:22.857

这里比较左栏是十进制值，右栏是计算出来的货币值：

```
DECLARE @money AS money
SET @money = 2871047428.20
SELECT CAST(@money AS decimal(34,4)) / 10000000, @money / 10000000 
```

另请参阅堆栈溢出：

*   [如何从 SQL Server 中的货币数据类型转换？](https://stackoverflow.com/questions/532351/how-do-i-convert-from-a-money-datatype-in-sql-server)
*   [SQL Server 2005 varchar 丢失小数位转换为小数](https://stackoverflow.com/questions/391117/sql-server-2005-varchar-loses-decimal-places-converting-to-a-decimal)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T11:58:25.233

```
 SELECT CAST(currency_rate AS decimal) / 10000000 FROM ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T08:59:47.373

你们都遇到了小数除法的怪事这是我对[另一个线程 T-SQL 小数除法精度的回答](https://stackoverflow.com/questions/423925/t-sql-decimal-division-accuracy/424052#424052)

如果您使用 10000000.0 ，由于[数据类型优先级](http://msdn.microsoft.com/en-us/library/ms190309.aspx)，您也可能有隐式浮点转换

```
DECLARE @money AS money
SET @money = 2871047428.20
--Oddities
SELECT
    CAST(@money AS decimal(34,8)) / 10000000,
    CAST(@money AS decimal(34,8)) / 10000000.0,
    CAST(@money AS decimal(34,8)) / 10000000.00,
    CAST(@money AS decimal(34,8)) / 10000000.000,
    CAST(@money AS decimal(34,8)) / 10000000.0000
--Should be safe. My brain hurts if I work through p and s
SELECT
    CAST(@money AS decimal(38,8)) / CAST(10000000 AS decimal(8,0)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T16:15:21.703

splattne 的回答几乎是正确的，除了两个小改动：

```
DECLARE @money AS money
SET @money = 2871047428.20
SELECT CAST(@money AS decimal(34,6)) / 10000000.0, @money / 10000000.0 
```

这将给出正确答案：287.10474282。我所做的是更改精度值并将“.0”添加到除法值。

现在唯一让我感到困惑的是我必须将值转换为小数（34,6）而不是预期的小数（34,8）。

因此，我以另一种方式编写了查询，这对我来说更有意义：

```
DECLARE @money AS money
SET @money = 2871047428.20
SELECT CAST((@money / 10000000.0) AS decimal(34,8)), @money / 10000000.0 
```

请查看哪一个适合您。

# asp.net - 检测控件集合中是否存在控件

> ID：638295
> 
> 赞同：0
> 
> 时间：2009-03-12T11:54:35.943
> 
> 标签：asp.net, vb.net, custom-server-controls

***更新：****对缺乏清晰度表示歉意，我意识到我可以遍历控件集合，只是在寻找更好/更有效的方法。*

我正在尝试在运行时将一些 css 和 js 元素动态添加到 ASP.Net 页面中，但由于此代码用于多个控件，我需要确保相关链接只注入一次。

目前我在 OnPreRender 事件中有以下代码。

```
Dim head As HtmlControls.HtmlHead = Me.Parent.Page.Header

If Not _useCustomStyles Then

    Dim litCustomCss As New LiteralControl("<link rel=" & Chr(34) & "stylesheet" & Chr(34) & " href=" & Chr(34) & "/css/udPart_core.css" & Chr(34) & " type=" & Chr(34) & "text/css" & Chr(34) & " media=" & Chr(34) & "screen" & Chr(34) & " />" & vbCrLf)

    litCustomCss.ID = "cssCustom"

    If Not head.Controls.Contains(litCustomCss) Then
        head.Controls.Add(litCustomCss)
    End If

End If 
```

.Contains 是否查找对象的此实例（我认为这就是失败的原因）？

有没有办法检查特定 id 的控件集合？或者我是否必须编写一个子程序来循环检查集合中的现有控件以检查 id。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T12:07:42.590

对于**外部脚本源**，您可以使用它：

```
if (!ClientScript.IsClientScriptIncludeRegistered("externalResuorce"))
{
    ClientScript.RegisterClientScriptInclude("externalResuorce", 
    "scripts/myscripts.js");
} 
```

但是**对于样式表文件**，你可以使用这个：

```
HtmlLink link = new HtmlLink();
link.Href = "main.css";
link.Attributes["type"] = "text/css";
link.Attributes["rel"] = "stylesheet";
Page.Header.Controls.Add(link); 
```

并控制也许你应该循环**Page.Header.Controls**集合并寻找具有**main.css** href的**HtmlLink 。**

 ****编辑：**这也可能有助于在标题的控件集合中找到您的文字控件：

```
Page.Header.FindControl("your_literals_id"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T12:08:05.427

也许循环通过 Controls 集合并测试 ID 属性。如果找到，请记住并打破。从来没有在 ASP.NET 中这样做过，但是在 WinForms 和 WPF 中。

# c# - 正则表达式获取 C# 中模式的所有可能匹配项

> ID：638297
> 
> 赞同：1
> 
> 时间：2009-03-12T11:55:50.357
> 
> 标签：c#, regex, parsing, plsql

我正在学习正则表达式，需要从字符串中获取模式的所有可能匹配项。

如果我的输入是：

```
case a
when cond1 
then stmt1;
when cond2 
then stmt2;
end case; 
```

我需要获得具有以下组的匹配项

第一组：

1.  `"cond1"`
2.  `"stmt1;"`

和组2：

1.  `"cond2"`
2.  `"stmt2;"`

是否可以使用任何正则表达式来获取此类组？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T12:03:28.667

如果您不嵌套语句，则可以为此使用正则表达式。例如，如果您的 stmt1 是另一个案例陈述，那么所有的赌注都将关闭（您不能将正则表达式用于类似的事情，您需要一个常规解析器）。

**编辑**：如果你真的想尝试它，你可以用类似的东西来做（未经测试，但你明白了）：

```
Regex t = new Regex(@"when\s+(.*?)\s+then\s+(.*?;)", RegexOptions.Singleline)
allMatches = t.Matches(input_string) 
```

但正如我所说，这仅适用于非嵌套语句。

**编辑 2**：更改了一些正则表达式以在最后一组中包含分号。这不会像你想要的那样工作 - 相反，它会给你多个匹配项，每个匹配项将代表一个*when*条件，第一组是条件，第二*组*是语句。

我不认为你可以构建一个完全符合你想要的正则表达式，但这应该足够接近（我希望）。

**编辑 3**：新的正则表达式 - 应该处理多个语句

```
Regex t = new Regex(@"when\s+(.*?)\s+then\s+(.*?)(?=(when|end))", RegexOptions.Singleline) 
```

它包含一个肯定的前瞻，以便第二组*从那时*匹配到下一个“何时”或“结束”。在我的测试中，它适用于：

```
case a
when cond1 
then stmt1;
   stm1;
   stm2;stm3
when cond2 
then stmt2;
   aaa;  
   bbb;
end case; 
```

它现在区分大小写，因此如果您需要不区分大小写，则需要添加相应的正则表达式标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T12:49:51.660

我认为这是不可能的，主要是因为任何匹配 when...then... 的组都将匹配所有这些组，从而在同一组中创建多个捕获。

我建议使用这个正则表达式：

```
(?:when(.*)\nthen(.*)\n)+? 
```

这导致：

匹配 1：
* 组 1：cond1
* 组 2：stmt1；
匹配 2：
* 组 1：cond2
* 组 2：stmt2；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T12:35:35.423

如果这是用 java 编写的，我将为解析器编写两种模式，一种用于匹配情况，一种用于匹配 when-then 情况。这是后者的编写方式：

```
CharSequence buffer = inputString.subSequence(0, inputString.length());
// inputString is the string you get after matching the case statements...

Pattern pattern = Pattern.compile(
    "when (\\S+).*"
    + "then (\\S+).*");

Matcher matcher = pattern.matcher(buffer);
while (matcher.find()) {
    DoWhenThen(matcher.group(1), matcher.group(2));
} 
```

注意：我没有测试过这段代码，因为我不能 100% 确定这种模式……但我会对此进行修改。

# ios - 具有居中 UIImageView 的 UIScrollView，如照片应用

> ID：638299
> 
> 赞同：38
> 
> 时间：2009-03-12T11:56:06.017
> 
> 标签：ios, objective-c, iphone, cocoa-touch, uiscrollview

我想要一个带有图像内容视图的滚动视图。图像实际上是比屏幕大得多的地图。地图最初应该位于滚动视图的中心，就像当您将 iPhone 转为横向时照片应用程序中的照片一样。

![替代文字](https://lh4.ggpht.com/_bowYsy0VxgU/Sbj0Vjz5twI/AAAAAAAAAy0/CHM6LRsNkTo/scrollView.png)

我没有设法让地图在中心同时正确缩放和滚动。如果地图图像从屏幕顶部开始（纵向），则代码如下所示：

```
- (void)loadView {
    mapView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"map.jpg"]];
    CGFloat mapHeight = MAP_HEIGHT * SCREEN_WIDTH / MAP_WIDTH;
    mapView.frame = CGRectMake(0, 0, SCREEN_WIDTH, mapHeight);
    scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT)];
    scrollView.delegate = self;
    scrollView.contentSize = mapView.frame.size;
    scrollView.maximumZoomScale = MAP_WIDTH / SCREEN_WIDTH;
    scrollView.minimumZoomScale = 1;
    [scrollView addSubview:mapView];
    self.view = scrollView;
} 
```

当我将图像框架移动到中心时，图像仅从其框架的顶部向下增长。我尝试使用 mapView 转换，动态更改 imageView 的框架。到目前为止，没有什么对我有用。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-08-13T16:42:33.500

这段代码应该可以在大多数版本的 iOS 上运行（并且已经过测试可以在 3.1 以上版本上运行）。

它基于 Jonah 的回答中提到的 Apple WWDC 代码。

将以下内容添加到 UIScrollView 的子类中，并将 tileContainerView 替换为包含您的图像或图块的视图：

```
- (void)layoutSubviews {
    [super layoutSubviews];

    // center the image as it becomes smaller than the size of the screen
    CGSize boundsSize = self.bounds.size;
    CGRect frameToCenter = tileContainerView.frame;

    // center horizontally
    if (frameToCenter.size.width < boundsSize.width)
        frameToCenter.origin.x = (boundsSize.width - frameToCenter.size.width) / 2;
    else
        frameToCenter.origin.x = 0;

    // center vertically
    if (frameToCenter.size.height < boundsSize.height)
        frameToCenter.origin.y = (boundsSize.height - frameToCenter.size.height) / 2;
    else
        frameToCenter.origin.y = 0;

    tileContainerView.frame = frameToCenter;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-02-03T02:51:58.273

这是我要考虑的，其中的解决方案与苹果的照片应用程序完全一样。我一直在使用以下解决方案：

```
-(void) scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale 
```

重新定位，但我不喜欢那个解决方案，因为在缩放完成后，它会反弹然后快速“跳”到中心，这非常不性感。事实证明，如果您几乎执行完全相同的逻辑，但在此委托函数中：

```
-(void)scrollViewDidZoom:(UIScrollView *)pScrollView 
```

它都以居中开始，当您缩小时它*保持*居中：

```
-(void)scrollViewDidZoom:(UIScrollView *)pScrollView {
CGRect innerFrame = imageView.frame;
CGRect scrollerBounds = pScrollView.bounds;

if ( ( innerFrame.size.width < scrollerBounds.size.width ) || ( innerFrame.size.height < scrollerBounds.size.height ) )
{
    CGFloat tempx = imageView.center.x - ( scrollerBounds.size.width / 2 );
    CGFloat tempy = imageView.center.y - ( scrollerBounds.size.height / 2 );
    CGPoint myScrollViewOffset = CGPointMake( tempx, tempy);

    pScrollView.contentOffset = myScrollViewOffset;

}

UIEdgeInsets anEdgeInset = { 0, 0, 0, 0};
if ( scrollerBounds.size.width > innerFrame.size.width )
{
    anEdgeInset.left = (scrollerBounds.size.width - innerFrame.size.width) / 2;
    anEdgeInset.right = -anEdgeInset.left;  // I don't know why this needs to be negative, but that's what works
}
if ( scrollerBounds.size.height > innerFrame.size.height )
{
    anEdgeInset.top = (scrollerBounds.size.height - innerFrame.size.height) / 2;
    anEdgeInset.bottom = -anEdgeInset.top;  // I don't know why this needs to be negative, but that's what works
}
pScrollView.contentInset = anEdgeInset;
} 
```

'imageView' 是`UIImageView`你正在使用的地方。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-06-20T19:48:36.720

Apple 已向 iphone 开发者计划的所有成员发布了 2010 年 WWDC 会议视频。讨论的主题之一是他们如何创建照片应用程序！！！他们逐步构建了一个非常相似的应用程序，并免费提供了所有代码。

它也不使用私有 api。由于保密协议，我不能把任何代码放在这里，但这里是示例代码下载的链接。您可能需要登录才能获得访问权限。

[http://connect.apple.com/cgi-bin/WebObjects/MemberSite.woa/wa/getSoftware?code=y&source=x&bundleID=20645](http://connect.apple.com/cgi-bin/WebObjects/MemberSite.woa/wa/getSoftware?code=y&source=x&bundleID=20645)

而且，这里是 iTunes WWDC 页面的链接：

[http://insideapple.apple.com/redir/cbx-cgi.do?v=2&la=en&lc=&a=kGSol9sgPHP%2BtlWtLp%2BEP%2FnxnZarjWJglPBZRHd3oDbACudP51JNGS8KlsFgxZto9X%2BTsnqSbeUSWX0doe%2Fzv%2FN5XV55%2FomsyfRgFBysOnIVggO%2Fn2p%2BiweDK%2F%2FmsIXj](http://insideapple.apple.com/redir/cbx-cgi.do?v=2&la=en&lc=&a=kGSol9sgPHP%2BtlWtLp%2BEP%2FnxnZarjWJglPBZRHd3oDbACudP51JNGS8KlsFgxZto9X%2BTsnqSbeUSWX0doe%2Fzv%2FN5XV55%2FomsyfRgFBysOnIVggO%2Fn2p%2BiweDK%2F%2FmsIXj)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T19:16:05.013

我怀疑你需要设置`UIScrollView`'s `contentOffset`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T07:29:54.670

我希望它是那么简单。我在网上做了一些研究，发现这不仅仅是我的问题，而且很多人都在为同样的问题而苦苦挣扎，不仅在 iPhone 上，而且在 Apple 的桌面 Cocoa 上也是如此。请参阅以下链接：

[http://www.iphonedevsdk.com/forum/iphone-sdk-development/5740-uiimageview-uiscrollview.html](http://www.iphonedevsdk.com/forum/iphone-sdk-development/5740-uiimageview-uiscrollview.html)
所描述的解决方案是基于图像的 UIViewContentModeScaleAspectFit 属性，但不幸的是它不能很好地工作。图像是居中并正常增长，但弹跳区域似乎比图片大得多。

这家伙也没有得到答案：
[http ://discussions.apple.com/thread.jspa?messageID=8322675](http://discussions.apple.com/thread.jspa?messageID=8322675)

最后，Apple 桌面 Cocoa 上的同样问题：http:
[//www.cocoadev.com/index.pl?](http://www.cocoadev.com/index.pl?CenteringInsideNSScrollView)
CenteringInsideNSScrollView 我想该解决方案有效，但它基于 NSClipView，它不在 iPhone 上......

有人有一些适用于 iPhone 的解决方案吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-31T08:15:00.383

这对我有用：

```
- (void) scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale {
CGFloat tempx = view.center.x-160;
CGFloat tempy = view.center.y-160;
myScrollViewOffset = CGPointMake(tempx,tempy); 
```

}

其中 160 是您的`UIScrollView`.

然后稍后我将 contentoffset 设置为此处捕获的内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-03T17:14:45.793

一种将内容居中的优雅方式`UISCrollView`是这样。

将一个观察者添加到您的**contentSize**中`UIScrollView`，因此每次内容更改时都会调用此方法...

```
[myScrollView addObserver:delegate 
               forKeyPath:@"contentSize"
                  options:(NSKeyValueObservingOptionNew) 
                  context:NULL]; 
```

现在在你的观察者方法上：

```
- (void)observeValueForKeyPath:(NSString *)keyPath   ofObject:(id)object   change:(NSDictionary *)change   context:(void *)context { 

    // Correct Object Class.
    UIScrollView *pointer = object;

    // Calculate Center.
    CGFloat topCorrect = ([pointer bounds].size.height - [pointer viewWithTag:100].bounds.size.height * [pointer zoomScale])  / 2.0 ;
            topCorrect = ( topCorrect < 0.0 ? 0.0 : topCorrect );

    topCorrect = topCorrect - (  pointer.frame.origin.y - imageGallery.frame.origin.y );

    // Apply Correct Center.
    pointer.center = CGPointMake(pointer.center.x,
                                 pointer.center.y + topCorrect ); } 
```

*   你应该改变`[pointer viewWithTag:100]`. 替换为您的内容视图`UIView`。

    *   还要更改`imageGallery`指向您的窗口大小。

每次他的大小改变时，这将纠正内容的中心。

**注意：**此内容不能很好地工作的唯一方法是使用`UIScrollView`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-08T02:14:18.973

注意：这种方法有点工作。如果图像小于 imageView，它将部分滚动到屏幕外。没什么大不了的，但也不如照片应用程序那么好。

首先，重要的是要了解我们正在处理 2 个视图，其中包含图像的图像视图和包含图像视图的滚动视图。所以，首先将imageview设置为屏幕大小：

```
 [myImageView setFrame:self.view.frame]; 
```

然后，在 imageview 中居中您的图像：

```
 myImageView.contentMode = UIViewContentModeCenter; 
```

这是我的整个代码：

```
- (void)viewDidLoad {
AppDelegate *appDelegate = (pAppDelegate *)[[UIApplication sharedApplication] delegate];
 [super viewDidLoad];
 NSString *Path = [[NSBundle mainBundle] bundlePath];
 NSString *ImagePath = [Path stringByAppendingPathComponent:(@"data: %@", appDelegate.MainImageName)];
 UIImage *tempImg = [[UIImage alloc] initWithContentsOfFile:ImagePath];
 [imgView setImage:tempImg];

 myScrollView = [[UIScrollView alloc] initWithFrame:[[self view] bounds]];
 [myScrollView addSubview:myImageView];

//Set ScrollView Appearance
 [myScrollView setBackgroundColor:[UIColor blackColor]];
 myScrollView.indicatorStyle = UIScrollViewIndicatorStyleWhite;

//Set Scrolling Prefs
 myScrollView.bounces = YES;
 myScrollView.delegate = self;
 myScrollView.clipsToBounds = YES; // default is NO, we want to restrict drawing within our scrollview
 [myScrollView setCanCancelContentTouches:NO];
 [myScrollView setScrollEnabled:YES];

//Set Zooming Prefs
 myScrollView.maximumZoomScale = 3.0;
 myScrollView.minimumZoomScale = CGImageGetWidth(tempImg.CGImage)/320;
 myScrollView.zoomScale = 1.01; //Added the .01 to enable scrolling immediately upon view load.
 myScrollView.bouncesZoom = YES;

 [myImageView setFrame:self.view.frame];//rect];// .frame.size.height = imageHeight;
 myImageView.contentMode = UIViewContentModeCenter;
 self.view = myScrollView;
 [tempImg release];
 } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-04T02:16:27.800

好的，我想我已经找到了一个很好的解决这个问题的方法。诀窍是不断地重新调整 imageView 的框架。我发现这比不断调整 contentInsets 或 contentOffSets 好得多。我不得不添加一些额外的代码来容纳纵向和横向图像。

这是代码：

```
- (void) scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale {

CGSize screenSize = [[self view] bounds].size;

if (myScrollView.zoomScale <= initialZoom +0.01) //This resolves a problem with the code not working correctly when zooming all the way out.
{
    imageView.frame = [[self view] bounds];
    [myScrollView setZoomScale:myScrollView.zoomScale +0.01];
}

if (myScrollView.zoomScale > initialZoom)
{
    if (CGImageGetWidth(temporaryImage.CGImage) > CGImageGetHeight(temporaryImage.CGImage)) //If the image is wider than tall, do the following...
    {
            if (screenSize.height >= CGImageGetHeight(temporaryImage.CGImage) * [myScrollView zoomScale]) //If the height of the screen is greater than the zoomed height of the image do the following...
            {
                    imageView.frame = CGRectMake(0, 0, 320*(myScrollView.zoomScale), 368);
            }
            if (screenSize.height < CGImageGetHeight(temporaryImage.CGImage) * [myScrollView zoomScale]) //If the height of the screen is less than the zoomed height of the image do the following...
            {
                    imageView.frame = CGRectMake(0, 0, 320*(myScrollView.zoomScale), CGImageGetHeight(temporaryImage.CGImage) * [myScrollView zoomScale]);
            }
    }
    if (CGImageGetWidth(temporaryImage.CGImage) < CGImageGetHeight(temporaryImage.CGImage)) //If the image is taller than wide, do the following...
    {
            CGFloat portraitHeight;
            if (CGImageGetHeight(temporaryImage.CGImage) * [myScrollView zoomScale] < 368)
            { portraitHeight = 368;}
            else {portraitHeight = CGImageGetHeight(temporaryImage.CGImage) * [myScrollView zoomScale];}

            if (screenSize.width >= CGImageGetWidth(temporaryImage.CGImage) * [myScrollView zoomScale]) //If the width of the screen is greater than the zoomed width of the image do the following...
            {
                    imageView.frame = CGRectMake(0, 0, 320, portraitHeight);
            }
            if (screenSize.width < CGImageGetWidth (temporaryImage.CGImage) * [myScrollView zoomScale]) //If the width of the screen is less than the zoomed width of the image do the following...
            {
                    imageView.frame = CGRectMake(0, 0, CGImageGetWidth(temporaryImage.CGImage) * [myScrollView zoomScale], portraitHeight);
            }
    }
    [myScrollView setZoomScale:myScrollView.zoomScale -0.01];
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-08T14:45:59.493

在对我有用的 Monotouch 中。

```
this._scroll.ScrollRectToVisible(new RectangleF(_scroll.ContentSize.Width/2, _scroll.ContentSize.Height/2,1,1),false); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-05T09:56:02.867

这是另一种解决方案，类似于@JosephH 的答案，但这个解决方案考虑了图像的实际尺寸。因此，当用户平移/缩放时，屏幕上的空白永远不会超过所需。这是一个常见问题，例如在纵向屏幕上显示横向图像时。当整个图像显示在屏幕上时（Aspect Fit），图像上方和下方都会有空白。然后，在放大时，其他解决方案会将该空白视为图像的一部分，因为它位于 imageView 中。它们会让您将大部分图像平移到屏幕外，只留下可见的空白。这对用户来说看起来很糟糕。

使用此类，您确实需要将它正在使用的 imageView 传递给它。我很想让它自动检测，但这更快，你想要在`layoutSubviews`方法中获得的所有速度。

注意：按原样，这要求不为 scrollView 启用 AutoLayout。

```
//
//  CentringScrollView.swift
//  Cerebral Gardens
//
//  Created by Dave Wood
//  Copyright © 2016 Cerebral Gardens Inc. All rights reserved.
//

import UIKit

class CentringScrollView: UIScrollView {

    var imageView: UIImageView?

    override func layoutSubviews() {
        super.layoutSubviews()

        guard let superview = superview else { return }
        guard let imageView = imageView else { return }
        guard let image = imageView.image else { return }

        var frameToCentre = imageView.frame

        let imageWidth = image.size.width
        let imageHeight = image.size.height

        let widthRatio = superview.bounds.size.width / imageWidth
        let heightRatio = superview.bounds.size.height / imageHeight

        let minRatio = min(widthRatio, heightRatio, 1.0)

        let effectiveImageWidth = minRatio * imageWidth * zoomScale
        let effectiveImageHeight = minRatio * imageHeight * zoomScale

        contentSize = CGSize(width: max(effectiveImageWidth, bounds.size.width), height: max(effectiveImageHeight, bounds.size.height))

        frameToCentre.origin.x = (contentSize.width - frameToCentre.size.width) / 2
        frameToCentre.origin.y = (contentSize.height - frameToCentre.size.height) / 2

        imageView.frame = frameToCentre
    }
} 
```

# java - 从批处理文件中发现 Java 安装在哪里？

> ID：638301
> 
> 赞同：12
> 
> 时间：2009-03-12T11:57:32.723
> 
> 标签：java, windows, batch-file, java-home

我想从批处理脚本中设置 JAVA_HOME 变量

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T15:59:37.060

此代码段将在当前 PATH 中搜索 java.exe，并打印出找到它的位置：

```
for /f %%j in ("java.exe") do @echo.%%~dp$PATH:j 
```

在我的系统上，这给了我

> C:\WINDOWS\system32\

使用它你可以设置 JAVA_HOME 如下：

```
@echo off

for /f %%j in ("java.exe") do (
    set JAVA_HOME=%%~dp$PATH:j
)

if %JAVA_HOME%.==. (
    @echo java.exe not found
) else (
    @echo JAVA_HOME = %JAVA_HOME%
) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T21:39:10.973

请参阅[从 BAT 文件获取当前 Java 版本，以](http://www.rgagnon.com/javadetails/java-0642.html)根据注册表中存储的信息获取当前 Java 安装。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-17T19:03:30.363

此解决方案取决于安装在 %ProgramFiles%\Java 下的 JDK，例如 C:\Program Files\Java\jdk1.6.0_18。您可以将“set JDK_Version=1.6”行更改为您要使用的版本，例如“set JDK_Version=1.5”。

假设最新版本的 JDK 位于列表底部 (jdk%jdk_Version%*)，则可用的最新版本应设置为 JAVA_HOME。如果找不到 JDK，则不会更改 JAVA_HOME。如果找不到 JDK 并且 JAVA_HOME 没有值，则脚本将显示错误消息。

```
@echo off
rem set the version of jdk you would like to use (1.4, 1.5, 1.6, etc)
set JDK_Version=1.6

echo.
echo Locating JDK %JDK_Version%

for /d %%i in ("%ProgramFiles%\Java\jdk%jdk_Version%*") do (set Located=%%i)
rem check if JDK was located
if "%Located%"=="" goto else
rem if JDK located display message to user
rem update %JAVA_HOME%
set JAVA_HOME=%Located%
echo     Located JDK %jdk_Version%
echo     JAVA_HOME has been set to:
echo         %JAVA_HOME%
goto endif

:else
rem if JDK was not located
rem if %JAVA_HOME% has been defined then use the existing value
echo     Could not locate JDK %JDK_Version%
if "%JAVA_HOME%"=="" goto NoExistingJavaHome
echo     Existing value of JAVA_HOME will be used:
echo         %JAVA_HOME%
goto endif

:NoExistingJavaHome
rem display message to the user that %JAVA_HOME% is not available
echo     No Existing value of JAVA_HOME is available
goto endif

:endif
rem clear the variables used by this script
set JDK_Version=
set Located= 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-18T21:18:08.993

您可以使用存储在注册表中的值来自动发现 Java 的安装位置并设置 JAVA_HOME 变量。

```
HKLM > Software > JavaSoft > Java Runtime Environment 
```

在这个位置是一个名为 CurrentVersion 的 Key。此版本按名称引用此级别的目录之一。打开该目录会公开另一个名为 JavaHome 的键。JavaHome 的值是一个文件系统路径，可用于定义您的环境变量 JAVA_HOME。

在批处理文件中，您可以执行以下操作：

```
FOR /F "skip=2 tokens=2*" %%A IN ('REG QUERY "HKLM\Software\JavaSoft\Java Runtime Environment" /v CurrentVersion') DO set CurVer=%%B

FOR /F "skip=2 tokens=2*" %%A IN ('REG QUERY "HKLM\Software\JavaSoft\Java Runtime Environment\%CurVer%" /v JavaHome') DO set JAVA_HOME=%%B 
```

如果您想了解更多信息，我已经编写了一个[教程](http://chriskopec.com/blog/2009/jun/15/automatic-discovery-java_home-batch-file/)，描述了构建批处理文件以自动发现 JAVA_HOME 所需的内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T00:33:10.393

虽然不完美，但您可以使用以下内容来发现当前的 JRE 文件夹：

```
for /d %%i in ("\Program Files\Java\jre*") do set JAVA_HOME=%%i 
```

如果它是您想要的 JDK，请使用：

```
for /d %%i in ("\Program Files\Java\jdk*") do set JAVA_HOME=%%i` 
```

要获得基于检查 Windows 注册表的更强大的解决方案，请使用：

```
set KeyName=HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Runtime Environment
set Cmd=reg query "%KeyName%" /s
for /f "tokens=2*" %%i in ('%Cmd% ^| find "JavaHome"') do set JAVA_HOME=%%j 
```

对于 JDK，您将需要此行：

```
set KeyName=HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Development Kit 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T12:15:07.220

如果 JAVA_HOME 尚未设置，并且您想设置它，那么您可能需要执行类似的操作

```
dir java.exe /B /S 
```

这将为您提供包含文件 java.exe 的所有目录的列表。从那里，您可以将该输出通过管道传输到另一个命令，该命令解析结果并选择其中一个目录，然后使用它来设置 JAVA_HOME 变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T12:07:39.640

Java 应该在安装时设置 JAVA_HOME 变量。使用它来查找 Java 的位置：

```
if not "%JAVA_HOME%" == "" goto HasJavaHome

:HasJavaHome
set JAVA_HOME=... // Your new value goes here. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-04T18:43:50.233

这是一个方便的小批处理文件，它将搜索路径中的所有内容以查找文件的第一次出现。神奇的一点是 for 循环中的 %%~dp$PATH:i%%i 。%%~dp 将仅将下一个变量扩展为驱动器号和路径。$PATH:i 在路径中搜索第一次出现的 %%i，这是传递给 for 循环的文件名。

示例：**Where.bat**

```
@echo off
setlocal

if "%1"=="" goto USAGE
set filename=%1

for %%i in (%filename%) do @echo %%~dp$PATH:i%%i

goto EOF

:USAGE

echo %0 filename

:EOF
endlocal 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-20T01:42:10.767

这不会搜索整个硬盘驱动器。它只搜索父目录树，因此比使用“dir java.exe /B /S”要快得多。

```
@ECHO off
ECHO ------------------------------------------------------------------
ECHO  Define the location of an existing JDK install by 
ECHO  searching for Javasoft JDK distrobution in parent 
ECHO  directories.
ECHO.
ECHO  Script does not add trailing slash.
ECHO ------------------------------------------------------------------
IF DEFINED JAVA_HOME (
  ECHO JAVA_HOME is already set.
  GOTO :JHSET
)
SET matchobject=Javasoft\bin\java.exe
SET "dir=%~f0"
:LOOP
CALL :FGETDIR "%dir%"
IF EXIST "%dir%\%matchobject%" (
  ECHO Found JAVA_HOME at %dir%\
  GOTO :HOMESET
)
IF "%dir:~-1%" == ":" (
  ECHO Reached root and directory containing "%matchobject%" not found.
  GOTO :EOF
)
GOTO :LOOP
:HOMESET
SET JAVA_HOME=%dir%
GOTO :JHSET
:: function section
:FGETDIR
SET "dir=%~dp1"
SET "dir=%dir:~0,-1%"
EXIT /B 0
:: end function section
:JHSET
:: Does JAVA_HOME have a trailing slash? If so remove it.
IF !JAVA_HOME:~-1!==\ SET JAVA_HOME=!JAVA_HOME:~0,-1!
ECHO JAVA_HOME is %JAVA_HOME%
ECHO Will close in a few seconds...
ping -n 60 127.0.0.1>nul 
```

# apache-flex - 是否可以在 intellij 中编译 flex 3 图表？

> ID：638304
> 
> 赞同：0
> 
> 时间：2009-03-12T11:58:13.890
> 
> 标签：apache-flex, charts, intellij-idea

我知道 mx.charts 是 flex builder Professional 的一部分。

我已经下载了 flex builder Professional 的试用版，并将 datavisualization.swc 添加到我的 intellij Flex_sdk 类路径中。IDE 现在知道这些类，但是当我开始编译时，我仍然得到：

> “找不到类型”

是否有许可证或我需要添加到类路径中的东西。

任何人都可以提供逐步指南来编译使用图表的 flex 应用程序，无论是在 intellij 中还是从命令行。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T13:41:32.817

似乎只是将 FB3 lib 目录中的所有 swc 类添加到我现有的 jdk 中，基于 Flex SDK 安装不起作用。但是，当我将 Flex SDK 全部删除并添加了一个新 SDK 时，基于 FB3 的 sdk 目录开始工作。

# .net - 如何使用配置在私有文件夹中操作多个程序集版本？

> ID：638310
> 
> 赞同：4
> 
> 时间：2009-03-12T11:59:13.827
> 
> 标签：.net, assemblies, version, configuration-management, assemblybinding

我有一个场景，我需要存储在应用程序私有文件夹中的同一程序集的多个版本，结构如下：

```
.\My.dll          // latest version, say 1.1.3.0
.\v1.1.1\My.dll   // version 1.1.1.0
.\v1.1.2\My.dll   // version 1.1.2.0 
```

我的问题是 .Net 运行时，当被要求提供旧版本之一时，总是找到最新版本，然后由于内部版本号不匹配而失败，然后再尝试探测更好的匹配。

程序集是强命名的，我在 app.config 中使用此配置：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="My" 
                publicKeyToken="xxxxxxxx" culture="netural" />

                <bindingRedirect oldVersion="1.0.0.0-1.1.1.0" 
                    newVersion="1.1.1.0" />
                <bindingRedirect oldVersion="1.1.3.0-1.1.65535.65535" 
                    newVersion="1.1.3.0" />

                <codeBase version="1.1.1.0" href="v1.1.1\My.dll" />
                <codeBase version="1.1.2.0" href="v1.1.2\My.dll" />
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

希望我在这里错过了一些东西。我知道这可以通过监听[AppDomain.AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)事件在代码中解决，但我希望看到一个纯粹的配置解决方案。

**更新：**所以我发现了这个错误，正如 Kent 假设的那样，是一个错字。`culture="netural"`应该是`culture="neutral"`。也就是说，如果没有错字，当使用`codeBase`指向每个版本的元素时，解析效果很好。在这种情况下，探测元素似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T09:49:45.740

在没有看到整个解决方案的情况下，我只能假设您在某处有错字。我只是为自己尝试了这个 - 在[fuslogvw](http://msdn.microsoft.com/en-us/library/e74a18c4(vs.71).aspx)的帮助下，我能够让它工作。

我有三个版本的程序集，使用应用程序引用的版本比其输出目录中的版本旧。CLR 找到重定向和 codeBase 条目并加载正确的（旧）版本。

如果您提供电子邮件地址，我可以通过电子邮件向您发送我的解决方案。

肯特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T20:25:18.043

你可以使用探测路径吗？我们使用它来强制不受控制（例如第三方解析器 - 例如 MSTest）在我们需要它们的地方寻找程序集。

```
<?xml version ="1.0"?>
<configuration>
    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <probing privatePath="v1.1.1;v1.1.2;"/>
        </assemblyBinding>
    </runtime>
</configuration> 
```

请参阅[此处](http://msdn.microsoft.com/en-us/library/4191fzwb.aspx)了解更多信息

# asp.net-mvc - MS MVC - 我可以以某种方式为我的所有视图全局填充强类型视图数据/模型吗？

> ID：638312
> 
> 赞同：1
> 
> 时间：2009-03-12T11:59:51.547
> 
> 标签：asp.net-mvc, model, viewdata

我想为我的 MVC 应用程序中的所有视图提供已登录用户的实例（如果还没有人登录，则为 null）。我已经成功实现了我自己的 ControllerActionInvoker 类，它覆盖了 InvokeAction 并在 ViewData (controllerContext.Controller.ViewData["LoggedUser"] = xxx) 中提供了记录的用户实例。问题是我想使用强类型模型在整个应用程序中传递记录的用户实例。我正在考虑拥有 ApplicationViewDataBase 类，它可以作为我所有强类型 ViewData 类的基类，并且还可以提供记录的用户实例。我可以在我的所有视图中轻松访问已登录的用户实例。

是否可以像我在 ControllerActionInvoker.InvokeAction 覆盖中实现的那样填写全局强类型？还是以某种方式在 Page.User 中提供我的用户实例更好？我会发现使用 Page.User 可能更巧妙，但也没有找到任何解决方案如何注入我的用户实例......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T12:14:26.597

也许将用户放入 HttpContext 的更好方法？在 global.asax

protected void Application_AuthenticateRequest（对象发送者，EventArgs e）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-14T01:33:09.933

这是一个老问题，所以只是为了未来访问者的利益，这可以通过创建一个从 Controller 继承的 basecontroller 并处理 OnActionExecuted() 来将您的自定义用户实例添加到控制器操作和视图之间的视图中。这里有一个全面的实现：http: [//blog.bitdiff.com/2012/05/sharing-common-view-model-data-in.html](http://blog.bitdiff.com/2012/05/sharing-common-view-model-data-in.html)

如果您希望这些数据可用于您的操作方法，事情会变得有点复杂，因为视图还不存在。

对于 POST 方法，“baseView = filterContext.Controller.ViewData.Model as BaseView”将使您能够访问视图，但您需要自定义模型绑定器来设置 ViewData.Model（请参阅[https://stackoverflow.com/a/25250058/ 2381157](https://stackoverflow.com/a/25250058/2381157)）。不幸的是，这不是一个全局解决方案，因为除非有要绑定的东西，否则不会调用模型绑定器。

一种可能适合的方法是向 RouteData 或 ActionParameters 注入值的 ActionFilter 或 AttributeFilter，但您的操作必须将此值传输到视图。

我找不到一种干净、简单的方法将这些数据注入到视图中，因为它被创建并回退到实现用户实例的线程安全缓存，这样我就可以在需要时检索用户实例而无需数据库查询高架。这并不容易，但在保持跨请求用户状态方面具有其他优势（这通常是您希望控制器逻辑可以使用自定义用户数据的原因）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T12:32:24.260

你不需要添加这个；它已经在 ASP.NET MVC 中可用。查看 ViewContext.HttpContext.User.Identity.Name

# .net - NHibernate 集合映射不是 DRY 吗？

> ID：638313
> 
> 赞同：1
> 
> 时间：2009-03-12T11:59:54.713
> 
> 标签：.net, xml, nhibernate, orm, nhibernate-mapping

我不是高级 NHibernate 用户，所以这可能有点重要，我只是还没有发现它.. 但到底是什么。

考虑类：

```
public class House
{
    public int Id { get; set; }

public ISet<Room> Rooms
{
    get;
    set;
}

} 
```

指定 NHibernate Set 元素时，仅写以下内容是不够的：

```
<set name="Rooms" /> 
```

相反，我至少必须写：

```
<set name="Rooms">
  <key column="RoomId"/>
  <one-to-many class="Room"/>
</set> 
```

这似乎违反了 DRY 原则。如果它是 Set，则默认应该是一对多的关系。该类应从集合的泛型类型推断，并且作为键列，应使用集合元素类的主键。

在我看来，这似乎是一个合理的默认值。那么，为什么 NHiberbate 对此并不聪明，并要求我输入这些额外的 3 行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-14T15:56:31.663

因为，我认为，当 NH 基于映射创建代理时，还需要更长的时间来检查你的程序集，并通过反射来确定它需要做什么。这将增加 NH 工厂的启动时间。

不要忘记，它是关系映射器的对象。您至少需要一个额外的节点（密钥）来告诉它它需要使用的数据库密钥是什么。这允许您在映射到数据库时尽可能灵活，而不是硬连线到默认值。

它会破坏 DRY 吗？可能。我在乎这种情况吗？不，真的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T13:48:58.603

您可能会看一下[Fluent NHibnernate](http://fluentnhibernate.org/)。他们的 DSL 受到 DRY 的启发。

**编辑：** 对不起应该更仔细地阅读......

关于您的示例，Fluent NHibernate 将允许您将映射表示为：

```
HasMany(x => x.Rooms); 
```

但是，HasMany（或一对多）关系映射到 IList。我不确定这是否可以进一步定制（让 Fluent 默认映射到 ISet）。但无论哪种方式，它的重复性都比标准映射声明少。

以下是声明映射的一些示例：[Fluent NHibernate Wiki](http://wiki.fluentnhibernate.org/show/StandardMappingRelationships)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T13:50:18.613

如果您不使用通用集合怎么办？如果我没记错的话，NHibernate 只支持从 1.2 版开始的泛型；所以在以前的版本中，类型推断是绝对不可能的。

如果您使用遗留数据库，其中主 ID 不用作相关表中的外键怎么办？

# sharepoint - 为什么 RunWithElevatedPrivileges 无法执行？

> ID：638314
> 
> 赞同：3
> 
> 时间：2009-03-12T12:00:56.210
> 
> 标签：sharepoint, web-parts

我正在尝试制作一个 greps 用户评论并将其存储在自定义列表中的 Web 部件，我编写了此代码以在 Web 部件添加到页面后将列表添加到站点，

```
[Guid("c314a0e8-0210-4064-b79e-bfd3594c6083")]
public class CommentWriteSpace : System.Web.UI.WebControls.WebParts.WebPart
{
    SPSite site = null;
    SPWeb web = null;

    public CommentWriteSpace()
    {
        SPSecurity.CodeToRunElevated foo = new SPSecurity.CodeToRunElevated(doit);

        SPSecurity.RunWithElevatedPrivileges(foo);
        SPListCollection listCollection = web.Lists;

        Guid listGuid = listCollection.Add("Comments List", "A list of user comments", SPListTemplateType.GenericList);
        listCollection[listGuid].Fields.Add("User", SPFieldType.User, true);
        listCollection[listGuid].Fields.Add("Comment", SPFieldType.Text, true);
        listCollection[listGuid].OnQuickLaunch = true;
        listCollection[listGuid].Update();
        //this.Page.Request.Url.ToString()
    }

    public void doit()
    {
        site = SPContext.Current.Site;
        web = site.OpenWeb();
    }
} 
```

但是该方法抛出异常，我猜是权限问题，该异常与在没有提升权限的情况下`RunWithElevatedPrivileges`执行方法时出现的异常相同。`site.OpenWeb();`

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T22:45:17.397

您会看到许多问题：

1.  `SPSite`对象权限是在创建时确定的，因此`SPContext.Current.Site`即使您在`RWEP`.
2.  将 SP 对象从块中传递出去`RWEP`是不受支持的并且通常很危险。如果您确实需要使用 RWEP，那么在该上下文中创建的所有对象（及其子对象）都应该`SPSite`在.`SPWeb``CodeToRunElevated`
3.  每次调用`listCollection[listGuid]`都会创建一个新`SPList`对象，这可能会导致意外行为。

正如 Dan 所建议的那样，RWEP 不是您想要完成的工作的首选方法。[使用他引用的链接](http://solutionizing.net/2009/01/06/elegant-spsite-elevation/)中的扩展名，我将重写为如下所示：

```
[Guid("c314a0e8-0210-4064-b79e-bfd3594c6083")]
public class CommentWriteSpace : System.Web.UI.WebControls.WebParts.WebPart
{
    public CommentWriteSpace()
    {
        SPContext.Current.Site.RunAsSystem(UpdateSite);
        //this.Page.Request.Url.ToString()
    }

    public void UpdateSite(SPSite site)
    {
        SPWeb web = site.RootWeb;

        SPListCollection listCollection = web.Lists;
        Guid listGuid = listCollection.Add("Comments List", "A list of user comments", SPListTemplateType.GenericList);
        SPList list = listCollection[listGuid];

        list.Fields.Add("User", SPFieldType.User, true);
        list.Fields.Add("Comment", SPFieldType.Text, true);
        list.OnQuickLaunch = true;
        list.Update();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T17:38:53.233

您无需以提升的权限运行 SPContext.Current.Site。事实上，我认为这就是你得到例外的原因。此外，您还可以使用 SPContext.Current.Web 代替 site.OpenWeb()。后者创建一个新的 SPWeb 对象，您将负责再次处理该对象。当 HTTP 请求完成时，会自动释放来自 SPContext 的 SPSite 和 SPWeb 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T18:20:55.503

我建议在与 SharePoint 对象交互时避免使用 RunWithElevatedPrivileges（只要可能，就像在您的示例中一样）。您应该将其使用限制在需要访问 SharePoint 外部资源（例如数据库、文件共享等）时才使用。

这是一篇优秀的文章，它提供了一种在 SharePoint 上下文中获得提升权限的非常优雅的方法：http: [//solutionizing.net/2009/01/06/elegant-spsite-elevation/](http://solutionizing.net/2009/01/06/elegant-spsite-elevation/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T17:49:41.680

唔。在匿名委托中运行大部分代码会更容易吗？

```
SPSecurity.RunWithElevatedPrivileges(delegate()
{
  // Your code here
} 
```

最好创建一个 SPList 对象，而不是重复访问该集合。其中一些集合的行为有点奇怪 - 我认为它是 SPViewCollection 每次您通过 guid/index 访问它时都会创建一个新对象！

所有这些问题，我同意 Lars - 使用 SPContext.Current.Web

# sql-server-2005 - 如何从 visio 2003 文件转发工程数据库图？

> ID：638323
> 
> 赞同：0
> 
> 时间：2009-03-12T12:02:56.877
> 
> 标签：sql-server-2005, visio

我遇到了一些将其导出到 mdb ( ms access ) 文件的 vb 宏。但是在复制前向约束等时效果不佳。

**我想从sql server 2005**数据库的数据库图中生成模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T13:13:04.210

（对于 Visio 2007，因为这是我必须要做的，虽然我记得 2003 非常相似）

从数据库菜单中，选择“选项”>“驱动程序...”，然后更改默认驱动程序以适合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-08T07:12:01.193

仅在 Visio 的“Enterprise Architect”版本中支持正向工程

# c# - Sharepoint Web 部件中的多行文本框

> ID：638325
> 
> 赞同：3
> 
> 时间：2009-03-12T12:03:43.223
> 
> 标签：c#, sharepoint, web-parts

如何在 sharepoint webpart 中显示作为多行文本框的字段？

当我在 webpart 上单击“修改共享 webpart”时，我希望文本字段给我一个多行框

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T12:47:49.920

就像是

```
var textBox = new TextBox();
textBox.TextMode = TextBoxMode.MultiLine; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T17:53:55.193

您还必须编写渲染以对您所处的模式敏感：

```
if( (WebPartManager.DisplayMode == WebPartManager.DesignDisplayMode) || 
    (WebPartManager.DisplayMode == WebPartManager.EditDisplayMode) ) {
       //Show your textbox
} else {
       //Render as text
} 
```

# java - 使用有关持久性和 XML 的 InputStream 的最佳方式

> ID：638326
> 
> 赞同：3
> 
> 时间：2009-03-12T12:04:04.673
> 
> 标签：java, xml, web-services, inputstream

我有一个 REST Web 服务，它侦听 POST 请求并从客户端获取 XML 有效负载，并将其最初存储为 InputStream 即*在您可以调用 getStream() 的 Representation 对象上*。

我想利用 InputStream 中保存的 XML，我开始认为保留它是明智的，所以我可以多次询问数据 - 因为一旦你通读它，对象就会变为 null。所以我考虑将 InputStream 转换为字符串。这不是一个好主意，因为 javax.xml.parsers 库中的 DocumentBuilder.parse() 只允许您通过：

*   输入流
*   文件
*   网址
*   SAX 输入源

不是字符串。

关于从其中解析 XML，我应该在这里用 InputStreams 做什么？请记住，我将希望在以后的流程中通过代码重新询问该 XML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T12:19:07.617

如果您有一个 InputStream，并且想将其用作 XML 文档，那么您为什么不简单地解析它并传递 Document 对象呢？如果要保留此对象，请使用序列化程序将其作为文本写回。

正如我在对 Tom Hawtin 的评论中所指出的，编码在处理 XML 时非常重要。与其在这里写一篇可能会错过您的具体情况的长篇文章，不如在这里 写[一篇](http://www.kdgregory.com/index.php?page=xml.parsing)我写的文章。

编辑：实际上，由于我的文章没有专门讨论 Web 服务，所以我应该在这里深入探讨一下。有两个地方可以指定内容编码：在 XML 序言中，或在*Content-Type*响应标头中。根据 XML 规范，前者是您想要使用的，它是解析器将使用的。在大多数情况下，这无关紧要：由不了解规范的人设置的 Web 服务通常会使用没有字符集规范的 text/xml（这是不正确的，但可能不会造成伤害）。如果他们做的事情正确，他们将指定 application/xml，使用 utf-8 编码。然而，你应该验证你得到了什么，这样你就不会得到一些解析器无法处理的奇怪编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T12:10:29.477

通常，当我们谈论持久性时，我们谈论的是将其写入磁盘或其他媒体。那里的性能受到影响，您必须考虑磁盘空间问题。您需要权衡它与长期使用该 XML 的价值。

如果您只是在谈论将它保存在内存中（这听起来像您在问什么），那么您可以分配一个字节数组，并将整个内容读入字节数组。您可以使用 ByteArrayInputStream 读取和重新读取该流。

这样做的成本是两倍。首先，您在内存中保存了一份副本，您需要根据您的可扩展性要求权衡它。其次，解析 XML 有点昂贵，所以最好只解析一次，如果可能的话，然后将结果保存在一个对象中。

编辑：

要分配和读取字节数组，您可以经常（但不总是）依赖 InputStream 的 available() 方法来告诉您要分配多少。并用 DataInputStream 包装 InputStream，这样您就可以调用 readFully() 将整个内容吸入字节数组中。

再次编辑：

阅读下面 Steen 的评论。他是对的，在这种情况下使用 available() 是个坏主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T12:11:29.397

我建议使用 Apache [Commons IO](http://commons.apache.org/io/)库。[IOUtils](http://commons.apache.org/io/apidocs/org/apache/commons/io/IOUtils.html)类包含许多将 InputStreams 转换为 String的便捷方法，反之亦然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T12:09:14.223

我认为您应该研究一些更适合保留编码的结构（即更多与编码无关）。对于低级结构，请考虑`byte[]`（但要小心内存释放！）或者您可以尝试设计适合您需要的数据类型。

您可以将 读[`InputStream`](http://java.sun.com/javase/6/docs/api/java/io/InputStream.html)入 a [`ByteArrayOutputStream`](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html)（使用其中一种[`read()`](http://java.sun.com/javase/6/docs/api/java/io/InputStream.html#read())方法）并`byte[]`从[那里](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html#toByteArray())提取。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T12:17:18.917

如果要多次使用 XML，为什么不从 InputStream 中解析一次（这是繁重的工作），然后保留返回的 Document 呢？

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-12T12:08:44.973

`java.io.StringReader`将允许您使用`InputSource`.

您可能希望将数据存储在 a 中`byte[]`，然后使用`ByteArrayInputStream`. 如果它特别大，您可能需要考虑压缩。这可以被读出 iwth `GzipInputStream`，它通常应该被包裹在一个`BufferedInputStream`.

# sql - 如何在两个表中都具有相同名称的列上连接两个表？

> ID：638332
> 
> 赞同：1
> 
> 时间：2009-03-12T12:06:34.027
> 
> 标签：sql

往上看...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T12:08:50.480

使用别名作为表名是最短的。

```
SELECT a.*, b.*
FROM table1 as 'a'
  INNER JOIN table2 as 'b'
    ON a.col1 = b.col1 
```

您还可以指定完整的表名。

```
SELECT table1.*, table2.*
FROM table1
  INNER JOIN table2 
    ON table1.col1 = table2.col1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T12:08:20.763

你问的是`NATURAL JOIN`关系术语。一些数据库服务器支持此子句。即使提供者支持这样的子句，我也更愿意手动指定连接表达式：

```
SELECT .... FROM Table1 JOIN Table2 ON Table1.JoinCol = Table2.JoinCol ... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T12:09:29.170

```
select  *
from    Table1
        inner join
        Table2
        on Table1.ColumnName = Table2.ColumnName 
```

真的很简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T12:27:41.450

为了完整性（取决于您的 DBMS），您可以使用“USING”：

```
SELECT
    ...
FROM
    table_a
INNER JOIN
    table_b
USING
    (common_column); 
```

# c# - 使用 DotNet 购买的功能区 UI 组件体验

> ID：638346
> 
> 赞同：1
> 
> 时间：2009-03-12T12:10:35.157
> 
> 标签：c#, winforms, components

人们在 DotNet 中将购买的组件用于基于功能区的用户界面方面的经验是什么（特别是 c#，尽管我认为这些组件应该像任何其他 DotNet 野兽一样与语言无关）。我们正在使用 VS 2008。

我在 Stack Overflow 上看过其他类似的问题，比如[这个](https://stackoverflow.com/questions/413910/ribbon-ui-control-for-winforms)，但我更感兴趣的是任何实际使用过一种或多种第三方产品的人的反馈，并且对于**Winforms**的工作，而不是 C++/MFC。

过去我们在 Delphi 中使用过 TMS 组件，但现在我们需要色带支持，最好具有玻璃功能。看起来 DevComponents 的 DotNetBar 很合适……有没有人使用过这个或类似的组件？易用性、错误修复速度等？

我知道 MS 许可证问题，因此无需讨论。请只是现实世界的经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T12:18:06.370

我用过 DevExpress

**专业版**

*   很全啊。。
*   所有组件（功能区旁边）都具有一致的外观和行为
*   易于使用（winforms 设计器支持很好）
*   我知道的错误并不多

**CON**

*   所有绘画都是由.NET完成的，所以有点“沉重”
*   devexpress 库非常庞大。在您的产品中包含功能区会自动包含至少 3 个 500-1000Kb 的额外 dll

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:24:12.033

我是[DevExpress](http://www.devexpress.com)用户。我目前正在从事一个winforms项目。我使用他们的功能区实现，它并没有让我失望过一次。

我从这个供应商那里看到的主要好处之一是他们有一个体面的文档、庞大的用户群和许多组件（所以你的应用程序没有来自万维网的零碎）。丝带做了丝带应该做的事情，我在那里看到了很少的火箭科学。我什至会说，当您将鼠标悬停在丝带按钮上时，您所获得的光芒比在办公套件中要好一些。您还可以获得同样丰富的工具提示外观。

DevExpress 大约每月发布一次修复，但它们与功能区的关联并不频繁。

# html - text-align:center 不适用于表单标签 (?)

> ID：638347
> 
> 赞同：50
> 
> 时间：2009-03-12T12:10:36.437
> 
> 标签：html, css

我正在浏览一个我刚刚完成的网站，并修复了一些可访问性问题。我有一个表格：

```
<input type="hidden" name="redirect" value="thank-you.php" />
<p>Enter your Email Address to receive our Weekly Newsletter</p>                            
<input name="email" type="text" id="formifemail" size="21" />
<input type="image" src="images/newsletter_button.jpg" alt="submit button" border="0" name="Submit" id="Submit" value="Send" /> 
```

这已被标记，因为它们没有用于识别用于输入电子邮件地址的输入字段的标签。所以我改变了

标记为这样的标记：

```
<input type="hidden" name="redirect" value="thank-you.php" />
<label for="formifemail">Enter your Email Address to receive our Weekly Research</label>                            
<input name="email" type="text" id="formifemail" size="21" />
<input type="image" src="images/newsletter_button.jpg" alt="submit button" border="0" name="Submit" id="Submit" value="Send" /> 
```

和CSS：

```
#formItem label {
    text-align:center;
    line-height:150%;
    font-size:.85em;
} 
```

但是文本显示为左对齐，而不是居中。我环顾四周，没有明显的错误。这发生在 FF 3.x 和 IE 7.x 中

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-03-12T12:12:39.490

这是因为`label`它是一个内联元素，因此仅与它包含的文本一样大。

可能的是将您的显示`label`为块元素，如下所示：

```
#formItem label {
    display: block;
    text-align: center;
    line-height: 150%;
    font-size: .85em;
} 
```

但是，如果您想将标签与其他元素在同一行上使用，则需要设置`display: inline-block;`并为其提供显式宽度（这在大多数浏览器上不起作用），或者您需要将其包装在 a 中`div`并执行中的对齐方式`div`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T12:13:51.060

`label`是一个内联元素，所以它的宽度等于它包含的文本的宽度。浏览器实际上正在显示标签，`text-align:center`但由于标签的宽度仅与您没有注意到的文本一样宽。

最好的做法是对`label`大于内容宽度的特定宽度应用 - 这将为您提供所需的结果。

# amazon-ec2 - 如何从命令行终止我的所有 EC2 实例？

> ID：638352
> 
> 赞同：8
> 
> 时间：2009-03-12T12:13:08.770
> 
> 标签：amazon-ec2, amazon-web-services

如何从命令行杀死我的所有实例？有这个命令还是我必须编写脚本？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-08-06T00:10:48.767

这是一个老问题，但我想我会为[AWS CLI](https://aws.amazon.com/documentation/cli/)分享一个解决方案：

```
aws ec2 terminate-instances --instance-ids $(aws ec2 describe-instances --filters  "Name=instance-state-name,Values=pending,running,stopped,stopping" --query "Reservations[].Instances[].[InstanceId]" --output text | tr '\n' ' ') 
```

* * *

## 相关资料：

如果黑客禁用了意外实例终止，请先运行以下命令：

```
aws ec2 describe-instances --filters  "Name=instance-state-name,Values=pending,running,stopped,stopping" --query "Reservations[].Instances[].[InstanceId]" --output text  |  xargs --delimiter '\n' --max-args=1 aws ec2   modify-instance-attribute  --no-disable-api-termination --instance-id 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T22:36:11.803

[AWS 控制台](https://console.aws.amazon.com/ "AWS 控制台")和[Elasticfox](http://developer.amazonwebservices.com/connect/entry.jspa?entryID=609 "弹性狐狸")让它变得非常简单。

使用 EC2 API 工具可以在一行中实现命令行解决方案：

```
for i in `ec2din | grep running | cut -f2`; do ec2kill $i; done 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T12:29:16.047

据我所知，ec2-terminate-instances 命令没有“全部”开关。所以你可能需要编写脚本。不会那么难。您只需要生成一个逗号分隔的实例列表。

这是我正在使用的 python 脚本：

```
import sys
import time
from boto.ec2.connection import EC2Connection

def main():
    conn = EC2Connection('', '')
    instances = conn.get_all_instances()
    print instances
    for reserv in instances:
        for inst in reserv.instances:
            if inst.state == u'running':
                print "Terminating instance %s" % inst
                inst.stop()

if __name__ == "__main__":
    main() 
```

它使用[boto](http://code.google.com/p/boto/)库。这对于特定任务来说不是必需的（一个简单的 shell 脚本就足够了），但在许多场合它可能很方便。

最后，您知道 Firefox 的 Elasticfox 扩展吗？这是迄今为止访问 EC2 的最简单方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-03T04:56:52.740

这是使用 boto3 的更新答案：

1.  下载[python 3](https://www.python.org/downloads/)
2.  按照[boto3的快速入门](https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html)
3.  将以下代码粘贴到一个文件中，并在没有空格的情况下调用它，我做了 delete_ec2_instances.py

`import boto3

```
def terminateRegion(region, ignore_termination_protection=True):
    """This function creates an instance in the specified region, then gets the stopped and running instances in that region, then sets the 'disableApiTermination' to "false", then terminates the instance."""
    # Create the profile with the given region and the credentials from:
    # https://boto3.amazonaws.com/v1/documentation/api/latest/guide/configuration.html
    s = boto3.session.Session(region_name=region)
    ec2 = s.resource('ec2')
    # Get all the instances from the specified region that are either stopped or running
    instances = ec2.instances.filter(Filters=[{'Name':'instance-state-name', 'Values': ['stopped', 'running', 'pending']}])
    for instance in instances:
        # set 'disableApiTermination' to 'false' so we can terminate the instance.
        if ignore_termination_protection:
            instance.modify_attribute(Attribute='disableApiTermination', Value='false')
        instance.terminate()
    print("done with {0}".format(region))

if __name__ == "__main__":
    # We get a list of regions that the account is associated with
    ec2 = boto3.client('ec2')
    regions = [r['RegionName'] for r in ec2.describe_regions()['Regions']]
    # loop through the regions and terminate all the instances in each region
    for region in regions:
        terminateRegion(region)
    print("done with everything") 
```` 

4.  使用命令行，导航到上述文件并输入：python terminate_ec2_instances.py（或任何您的文件名称。
5.  您应该看到该区域被删除时的名称，以及所有实例都已终止时的最终完成消息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-10T14:53:14.750

为了完整起见。这是另一种方式，通过使用正则表达式和 aws cli，更符合程序员的要求：

```
aws ec2 terminate-instances 
        --instance-ids 
         $(
          aws ec2 describe-instances 
            | grep InstanceId 
            | awk {'print $2'} 
            | sed 's/[",]//g'
          ) 
```

# python - Python - 如何计算两个字典的相等部分？

> ID：638360
> 
> 赞同：4
> 
> 时间：2009-03-12T12:15:14.177
> 
> 标签：python, list, dictionary, merge

我在组合或计算这两个字典的共同/相等部分时遇到问题。在我的字典中，值是列表：

```
d1 = {0:['11','18','25','38'], 
      1:['11','18','25','38'], 
      2:['11','18','25','38'], 
      3:['11','18','25','38']}

d2 = {0:['05','08','11','13','16','25','34','38','40', '43'], 
      1:['05', '08', '09','13','15','20','32','36','38', '40','41'], 
      2:['02', '08', '11', '13', '18', '20', '22','33','36','39'], 
      3:['06', '11', '12', '25', '26', '27', '28', '30', '31', '37']} 
```

我想检查“d2”并知道“d1”中是否有数字。如果有的话，我想用新数据更新其中一个或接收第三个字典“d3”，其中只有“d1”和“d2”中相同/相等的值，例如：

```
d3 = {0:['11','25','38'], 1:['38'], 2:['11','18'], 3:['11','25']} 
```

谁能帮我这个？

我的错我忘了说得更具体。我正在寻找 Python 中的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T12:30:54.750

假设这是 Python，你想要：

```
dict((x, set(y) & set(d1.get(x, ()))) for (x, y) in d2.iteritems()) 
```

生成结果字典“d3”。

### Python 3.0+ 版本

```
>>> d3 = {k: list(set(d1.get(k,[])).intersection(v)) for k, v in d2.items()}
{0: ['11', '25', '38'], 1: ['38'], 2: ['11', '18'], 3: ['11', '25']} 
```

上述版本（以及 Python 2.x 版本）允许空交叉点，因此在一般情况下需要额外的过滤：

```
>>> d3 = {k: v for k, v in d3.items() if v} 
```

将上述内容一次性结合起来：

```
d3 = {}
for k, v in d2.items():
    # find common elements for d1 & d2
    v3 = set(d1.get(k,[])).intersection(v)
    if v3: # whether there are common elements
       d3[k] = list(v3) 
```

* * *

[编辑：我制作了这个帖子社区维基，以便人们可以根据需要对其进行改进。我承认如果你不习惯在 Python 中阅读这类东西，它可能会有点难以阅读。]

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T01:15:00.797

提供更具可读性的解决方案：

```
d3= {}
for common_key in set(d1) & set(d2):
    common_values= set(d1[common_key]) & set(d2[common_key])
    d3[common_key]= list(common_values) 
```

### 建议后编辑：

如果您只想要具有至少一个公共值项的键：

```
d3= {}
for common_key in set(d1) & set(d2):
    common_values= set(d1[common_key]) & set(d2[common_key])
    if common_values:
        d3[common_key]= list(common_values) 
```

如果顺序和重复不重要，您可以将 d1 和 d2 值保留为集合而不是列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T12:39:48.113

问题归结为确定两个条目之间的共同元素。（要获得所有条目的结果，只需将代码包含在所有条目的循环中。）此外，看起来每个条目都是一个集合（即它没有重复的元素）。因此，您需要做的就是找到这些元素之间的集合交集。许多语言提供了这样做的方法或功能。例如在 C++ 中使用 set 容器和 set_intersection 函数。正如其他人所建议的那样，这比将一组中的每个元素与另一组中的每个元素进行比较要有效得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T14:08:18.960

如果我们可以假设 d1 和 d2 具有相同的键：

```
d3 = {}
for k in d1.keys():
    intersection = set(d1[k]) & set(d2[k])
    d3[k] = [x for x in intersection] 
```

否则，如果我们不能假设，那么它会有点混乱：

```
d3 = {}
for k in set(d1.keys() + d2.keys()):
    intersection = set(d1.get(k, [])) & set(d2.get(k, []))
    d3[k] = [x for x in intersection] 
```

**编辑：**考虑到评论的新版本。这个只检查 d1 和 d2 共有的键，这就是张贴者似乎在问的问题。

```
d3 = {}
for k in set(d1.keys()) & set(d2.keys()):
    intersection = set(d1[k]) & set(d2[k])
    d3[k] = list(intersection) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-12T12:26:47.207

在伪代码中：

```
Dictionary d3 = new Dictionary()
for (i = 0 to min(d1.size(), d2.size()))
{
  element shared = getSharedElements(d1[i], d2[i]);
  d3.store(i, shared);
}

function getsharedElements(array e1, array e2)
{
  element e3 = new element();
  for (int i = 0 to e1.length)
  {
    if (e2.contains(e1[i]))
    {
      e3.add[e1[i]];
    }
  }
  return e3;
} 
```

# c# - C# 中的可空方法参数

> ID：638361
> 
> 赞同：18
> 
> 时间：2009-03-12T12:16:17.997
> 
> 标签：c#, arguments, nullable

**重复的问题**

[将空参数传递给 C# 方法](https://stackoverflow.com/questions/271588/passing-null-arguments-to-c-methods/271600)

我可以在 C# 中为 .Net 2.0 执行此操作吗？

```
public void myMethod(string astring, int? anint)
{
//some code in which I may have an int to work with
//or I may not...
} 
```

如果没有，我可以做类似的事情吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-12T12:18:52.937

是的，假设您故意添加了 V 形并且您的真正意思是：

```
public void myMethod(string astring, int? anint) 
```

`anint`现在将拥有一个`HasValue`属性。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-12T12:19:56.850

取决于你想要达到什么。如果您希望能够删除`anint`参数，则必须创建一个重载：

```
public void myMethod(string astring, int anint)
{
}

public void myMethod(string astring)
{
    myMethod(astring, 0); // or some other default value for anint
} 
```

您现在可以执行以下操作：

```
myMethod("boo"); // equivalent to myMethod("boo", 0);
myMethod("boo", 12); 
```

如果您想传递一个可为空的 int，那么请参阅其他答案。;)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-12T12:19:09.863

在 C# 2.0 中，您可以这样做；

```
public void myMethod(string astring, int? anint)
{
   //some code in which I may have an int to work with
   //or I may not...
} 
```

并调用类似的方法

```
 myMethod("Hello", 3);
 myMethod("Hello", null); 
```

# asp.net-mvc - ASP.NET MVC 映射 URL 与 {controller}/{action} 不同的区域

> ID：638362
> 
> 赞同：1
> 
> 时间：2009-03-12T12:16:26.717
> 
> 标签：asp.net-mvc, routing

我希望能够使用不符合 {controller}/{action}/{id} 格式的 URL 来映射路由。映射如下所示：

```
routes.CreateArea("Root", "MyApp.Web.Controllers",
    routes.MapRoute("Category-List", "Category/{category}", 
        new { controller = "Category", action = "List" }),
    routes.MapRoute("Default", "{controller}/{action}/{id}", 
        new { controller = "Home", action = "Index", id = "" })
); 
```

我有`CategoryController`一个动作`List(string category)`。

我希望能够在我看来使用它：

```
<%= Html.ActionLink<CategoryController>(
    c => c.List(category.UrlFriendlyName), 
    category.Name)%> 
```

（为可读性添加了换行符）

所有这些产生的都是与`href=""`. 从“根”区域删除路由会产生正确的结果。是否可以将这种类型的映射与通用 ActionLink 帮助器一起使用，或者我是否必须求助于 RouteLink 或类似的硬编码值？

我也尝试了以下但没有成功：

```
<%= Html.ActionLink(category.Name, "List", "Category", 
new { category = category.UrlFriendlyName }) %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T12:30:19.180

不理想，但您可以使用路由名称方法吗？

```
<%= Html.RouteLink("your link", "Category-List", new {category = "foo"})%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:27:00.313

从外观上看，您所写的内容对于生成所需的 URL 看起来是正确的。您是否尝试过使用非强类型`Html.ActionLink`方法来查看是否有效？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T12:29:42.037

我在您对 ActionLink 的调用中没有看到任何会导致路由系统意识到要使用哪个路由的内容。相反，我建议使用 Html。RouteLink，允许您按名称指定路线。这将确保匹配正确的路由。

更新：你在做跨区域链接吗？（换句话说，您链接到的区域是否与包含该链接的区域不同？）如果是这样，您必须在调用 ActionLink/RouteLink 时指定该区域。如果没有，RouteLink 是否有效？

我不认为这是导致问题的原因，但我注意到您的 Category-List 路由没有任何约束，我认为它可能应该被约束到 Category 控制器。

# java - 使用带有透明图像的 Graphics.copyArea

> ID：638363
> 
> 赞同：4
> 
> 时间：2009-03-12T12:17:14.110
> 
> 标签：java, graphics

我正在尝试移动图像的一部分，目前使用 g.copyArea()。它适用于纯色，但不会复制透明像素（因为它们是透明的！）。我想让下面的颜色透明。

此图像显示了正在发生的情况，如果复制了起始形状，但我希望复制整个区域，覆盖下面的所有像素。

[替代文字 http://www.freeimagehosting.net/uploads/3f4b8888b0.png](http://www.freeimagehosting.net/uploads/3f4b8888b0.png)

这就是我要的：

[替代文字 http://www.freeimagehosting.net/uploads/ee911ea35a.png](http://www.freeimagehosting.net/uploads/ee911ea35a.png)

```
BufferedImage b;
...    
Graphics g = b.getGraphics();
g.copyArea(x,y,w,h,dx,dy); 
```

我考虑过将图像复制到另一个图像，清除原始图像然后将其复制回新位置，但必须有更好的方法吗？

免责声明：这是家庭作业项目的*一部分*。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T13:18:07.083

使用 g.setComposite(AlphaComposite.Src)，像这样：

```
Graphics2D g;
...
g.setComposite(AlphaComposite.Src)
g.copyArea(x,y,w,h,dx,dy); 
```

感谢 unwind 建议使用 Graphics2D。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:23:23.457

你确定你应该使用图形吗？我认为它已被半弃用，您现在应该使用[Graphics2D](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Graphics2D.html)。

您可以设置背景颜色，这`Graphics2D`可能有助于防止不需要的透明度。

# c# - 检查浮点变量是否为整数的最可靠方法是什么？

> ID：638376
> 
> 赞同：1
> 
> 时间：2009-03-12T12:21:38.610
> 
> 标签：c#, floating-point, isinteger

我可以想到几种方法，例如。

```
Convert.ToInt32(floatingPoint) - floatingPoint == 0;
Math.Truncate(floatingPoint) - floatingPoint == 0;
floatingPoint % 1 == 0;
Math.Floor(floatingPoint) == floatingPoint;
//etc... 
```

但哪种方法最可靠？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T12:31:24.373

您不应该检查是否完全等于零，因为浮点数通常只包含与您分配给它的数字最接近的可能近似值。

例如，该类型可以表示的最接近 42 的可能值可能是 42.00000000000000662，您仍然希望将其计为整数值。

取值和舍入值之间的差，然后取其绝对值（使其不是负数）并与一个小值进行比较：

```
if (Math.Abs(Math.Round(floatingPoint) - floatingPoint) < 0.000001) ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T12:27:27.423

浮点数不能准确地表示某些整数，所以**没有真正可靠的方法**。具体来说，任何`int`大于 2^24 的都不能用 a 精确表示`float`。唉，这是您使用浮点表示所付出的代价的一部分！

有关您应该注意的各种浮点问题的精彩总结，我鼓励您查看[“每个计算机科学家应该了解的关于浮点运算的知识”](http://docs.sun.com/source/806-3568/ncg_goldberg.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T12:25:18.723

不管可靠性如何，取模方法看起来很容易理解（无需阅读任何规范）和快速（无需函数调用）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T12:25:31.143

您将遇到浮点数只是近似值的经典问题。如果你这样做：

```
floatingPoint = 1.0/3.0;
floatingPoint *= 3; 
```

你最终会得到接近但不完全是 1 的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T12:39:15.040

没有*普遍*可靠的方法。

由于浮点数（大部分）总是近似值，如果它们是先前计算的结果，则不存在简单的整数等价，正如其他人指出的那样。

您必须考虑您正在处理的 fp 和 int 值的**范围**和**精度。**这完全取决于您要达到的目标。

Guffa 有一个很好的方法，使用允许的精度范围进行 int 比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T12:47:26.427

整数可以用浮点表示精确表示，因此如果您正在检查一个精确的整数，其中任何一个都应该工作（我个人会使用第一个......）

# sharepoint - SharePoint 目录 Web 部件和导出/导入

> ID：638380
> 
> 赞同：1
> 
> 时间：2009-03-12T12:23:29.510
> 
> 标签：sharepoint, stsadm

使用 stsadm 导出/导入移动 SharePoint MOSS 站点后，我发现目录 Web 部件存在一些问题。

如果我单击目录 Web 部件中某个部分的标题，例如“文档”，则会出现页面错误，因为它仍在尝试查看我从中导出的站点的子站点 url。

所以在导出站点中，该站点位于[http://sharepoint/sites/dashboard/](http://sharepoint/sites/dashboard/)

它现在位于根[http://sharepoint/](http://sharepoint/)

这是一个错误吗？Web 部件中的所有子链接都可以正常工作，只是标题。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-28T21:15:14.367

可能是 Web 部件上的属性之一，该属性具有从（站点？）导出的值。

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.publishing.webcontrols.tableofcontentswebpart_properties.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.publishing.webcontrols.tableofcontentswebpart_properties.aspx)

# actionscript-3 - 从 Array() 中间删除一个条目的最快方法

> ID：638381
> 
> 赞同：34
> 
> 时间：2009-03-12T12:23:45.657
> 
> 标签：actionscript-3, apache-flex, flex3

从 Array() 中间删除一个特定条目的最快方法是什么

数组很大，有字符串。

我不想只设置 Array[5] = null，而是应该将数组大小减少 1，并且 array[5] 应该具有 array[6] 等的内容。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-12T12:38:24.747

没有任何基准来支持这一点，但人们会假设本机[Array.splice](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice)方法将是最快的......

因此，要删除索引 5 处的条目：

```
array.splice(5, 1); 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-12T12:30:13.813

如果您不关心数组中项目的顺序（但只是希望它缩短 1），您可以将数组的最后一个元素复制到要删除的索引，然后将最后一个元素*弹出*。

```
array[index] = array[array.length-1];
array.pop(); 
```

如果您可以摆脱对数组的重新排序，我想这会更快，在 CPU 时间方面。

编辑：您应该针对您的具体情况进行基准测试；我最近这样做了，只是拼接更快。（大概是因为 Chrome 实际上并没有将数组存储为单个连续缓冲区。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T12:39:10.640

[Array.splice()](http://livedocs.adobe.com/flex/3/langref/Array.html#splice()) *“向数组添加元素并从数组中删除元素”*：

```
myArr.splice(indexToRemove, 1); // only removing one index, thus the 1 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-04T14:14:28.803

我测试了 Array.prototype.splice() 并发现它在大型数组上非常慢。

删除元素的更快方法是将要保留的元素复制到新数组中，同时跳过要删除的元素。完成复制后，您只需用新数组覆盖旧数组。

在我的测试中，我从包含 100.000 个项目的数组中删除了所有其他元素。该测试将 Array.prototype.splice() 与其他方法进行了比较。结果如下：

```
855 ms = splice
  7 ms = manual copying without preserving the original array
 14 ms = manual copying with preserving the original array 
```

这是最后一种方法的代码：

```
var arrB = [],
    i=varA.length,
    j=0;

// copy even items to a new array
while(i > 0) {
    i-=2; // skip two elements
    arrB[j++] = arrA[i];
}

// clear the old array
arrA.splice(0, arrA.length);

// copy values back to the old array
// array is preserved (references to the array don't need to be updated)
arrA.push.apply(arrA, arrB); 
```

可以在 jsFiddle 上找到实际测试：http: [//jsfiddle.net/sansegot/eXvgb/3/](http://jsfiddle.net/sansegot/eXvgb/3/)

如果您只需要删除几个项目，结果会大不相同 - 在这种情况下 Array.prototype.splice() 更快（尽管差异不是那么大）！只有当您需要多次调用 splice() 时，才值得实现自定义算法。第二个测试，其中要删除的元素数量有限，可以在这里找到：http: [//jsfiddle.net/sansegot/ZeEFJ/1/](http://jsfiddle.net/sansegot/ZeEFJ/1/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T01:35:40.450

根据您的情况，如果您想优先考虑性能，您可以考虑使用字典而不是数组。

```
var dict:Dictionary = new Dictionary();

// The following value/key set should be customized so you can 
// get use of them in your specific case.

dict[item1] = item1;
dict[item2] = item2;

...

delete dict[item1]; 
```

# c# - app.config 怪异

> ID：638384
> 
> 赞同：2
> 
> 时间：2009-03-12T12:24:16.590
> 
> 标签：c#, app-config

我的 app.config 文件发生了一件奇怪的事情。我的 ConnectionStrings 部分包含以下内容：

```
<connectionStrings>
  <add name="Connection" connectionString="Data Source=TheServer;
   Initial Catalog=TheDatabase;IntegratedSecurity=SSPI" 
   providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

但是，当我通过 ConfigurationManager.ConnectionStrings[0] 查询该部分时，我得到了这个连接字符串：

```
Data Source=.\\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true 
```

它从哪里得到这个值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T12:30:18.993

它是从 machine.config 中读取的，您可以确保在添加自己的连接字符串之前清除所有连接字符串：

```
<connectionStrings>
  <clear/>
  <add name="Connection" connectionString="Data Source=TheServer;
   Initial Catalog=TheDatabase;IntegratedSecurity=SSPI" 
   providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

或者永远不要通过索引引用您的连接字符串，使用您给它们的名称：

```
ConfigurationManager.ConnectionStrings["Connection"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T12:26:35.850

它来自 machine.config。.NET 自动合并应用程序配置（或 Web 配置）和 machine.config 的连接字符串部分（以及我相信的其他部分）。

[您可以在此处](http://msdn.microsoft.com/en-us/library/ms178685.aspx)了解它在 ASP.NET 中的工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T12:28:05.223

它来自另一个配置，要么是树中较高的 app.config，要么来自机器配置。要忽略其他任何内容，请使用`<clear />`删除当前配置中没有的任何内容。

```
<connectionStrings>
   <clear />
   <add name="Connection" connectionString="Data Source=TheServer;
     Initial Catalog=TheDatabase;IntegratedSecurity=SSPI" 
     providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T12:30:42.753

除了 Nath 的回答，这更好：

```
ConfigurationManager.ConnectionStrings["Connection"] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T12:34:04.243

尽管 Jason Punyon 已经回答了这个问题，但我强烈建议您通过它们的名称而不是它们的索引来访问您的连接字符串。例如

```
ConfigurationManager.ConnectionStrings["Connection"] 
```

# c# - 实体框架获取 CurrentContext

> ID：638391
> 
> 赞同：4
> 
> 时间：2009-03-12T12:26:38.830
> 
> 标签：c#, entity-framework

我正在扩展实体的部分类以拥有一个方法。如何获取对实体附加到的上下文的引用（如果有）以从同一上下文中获取更多实体。

如果不清楚，基本上我要写的代码是这样的（空气代码）：

```
public void AssignSize(int width, int height)
{
    var size = (from s in this.context.Sizes
                where s.width == width && s.height == height
                select s).FirstOrDefault();

    ...
} 
```

注意：这行不通。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T15:56:28.830

您需要将上下文传递给此方法，或者更好的是，不是传递宽度和高度，而是传递大小对象本身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-25T03:27:24.980

看看这篇文章：

[如何从实体获取对象上下文](http://blogs.msdn.com/b/alexj/archive/2009/06/08/tip-24-how-to-get-the-objectcontext-from-an-entity.aspx)

它显示了从实体获取上下文的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-13T18:22:17.197

实体 db = 新实体（）；

实体是您在 EF 中所说的名称...

# java - 许多类引用数据库连接类的最佳方式

> ID：638421
> 
> 赞同：2
> 
> 时间：2009-03-12T12:34:08.970
> 
> 标签：java, database, oop

我很快就要开始我的课程的开发阶段，目前的设计是有一个处理数据库连接的类和许多调用它的类；数据库类应该打开连接并盲目地传递查询，其他类负责这些查询的内容。

我想知道的是，这些参考资料了解数据库类的最佳方式是什么？我的直觉是将 Database 类中的方法设为静态并将它们称为 Database.method() 但有更好的方法吗？

PS是引用正确的词吗？如果不是正确的词，下次我有类似的问题时会有所帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T13:20:01.947

要小心。

单例将是一个瓶颈。

java.sql.Connection 不是线程安全的，所以你可能会在那里遇到问题。

我建议编写您的应用程序，将服务层和持久层完全分开。两者都应该基于接口。服务层是了解工作单元和事务的层，使用模型和持久性对象来实现它们。服务应该负责获取连接，使其可用于持久层，处理事务，并在创建连接的同一方法范围内关闭连接。

范围和清理是关键。如果您不这样做，您将耗尽数据库连接。

你没有提到连接池。我会推荐一个。

看看春天。它的 JDBC 模块完美地处理了这一切。如果你不能使用 Spring 来完成你的任务，至少它会是一个很好的模型来设计你的实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T14:31:22.323

传统方法是为每个数据类设置一个 DAO（数据访问对象）。

也就是说，如果你有一个数据类“Person”，那么你也有一个类“PersonDAO”，它实现了findById()、findAll()、save(Person) 等方法。基本上DAO 类处理所有的数据库交互。

DAO 类的构造函数可以简单地接受一个 Connection 对象，从而将创建连接的问题外部化，或者它可以在某个地方调用一个工厂方法来分配一个 Connection 对象。

无论哪种情况，您都可能希望拥有这样的工厂方法。

```
public class Database{
   public static Connection getConnection(){
      // Create a new connection or use some connection pooling library 
   }
} 
```

正如有人指出 java.sql.Connection 不是线程安全的，因此除非您确定多个线程不会访问该方法，否则您不应每次都分发相同的连接。

当然，如果您需要为每个呼叫创建一个新连接，您还需要在完成连接后关闭连接。简单的方法是向 DAO 添加 close() 方法并让它们处理它。这确实给使用 DAO 的代码带来了负担。

即使您使用连接池，一旦完成连接，仍然需要关闭连接（返回池）。

有人建议使用 Thread local 来建立每个线程的连接。这在某些情况下有效，但对于每个请求都是一个新线程（从不重用，最好不存储引用）的 Web 应用程序来说没有用。

但是，如果您已对其进行配置，则可以在 web 应用程序中利用这一点，以便在处理每个请求后调用 Database.closeConnection() ，然后如果存在 Tread 本地连接，则该连接负责关闭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T12:35:21.993

避免任何静态的东西。首选[“从上方进行参数化”](http://accu.org/index.php/journals/1420)。

所以你想要做的是在你的'main'附近创建你的数据库包装对象。然后将其作为构造函数参数传递给需要它的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T12:37:54.437

如果你按照你的建议去做，那么你将很难对你的课程进行单元测试。一种方法可能是将您的数据库信息传递给进行查询的类，例如

```
Query query = new GetPersonQuery(Database database);
query.run(); // or whatever 
```

如果您使用的是 DAO 模式，这将特别有效，因此：

```
PersonDao dao = new PersonDao(Database database);
dao.findAll(); 
```

然后，数据库可以打包您需要的任何内容，例如连接池、缓存等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T14:14:23.237

如果要静态存储连接，至少使用线程本地。但正如其他人所说的 - 最好将连接或其包装器注入需要使用它的对象中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-12T12:37:49.380

单[例模式](http://en.wikipedia.org/wiki/Singleton_pattern#Java)将帮助您解决这个问题。在此处查看有关它的[更多信息](http://c2.com/cgi/wiki?SingletonPattern)。

这种模式（正确地）在这里很不受欢迎，因为它本质上是使一堆方法全局化，这在面向对象的世界中是要避免的——但对于课程作业和你想要实现的目标来说，它可能是最简单的.

# asp.net - 经典的 Asp to Asp.Net urlEncoding 问题

> ID：638422
> 
> 赞同：2
> 
> 时间：2009-03-12T12:34:54.363
> 
> 标签：asp.net, asp-classic, urlencode

我正在使用 Web 服务将信息从一堆旧的 .asp 页面传递到数据库。问题是使用 httpGet，我需要对信息进行编码，以便可以安全地传递。

除了 ä ö 和 å 之类的斯堪的纳维亚字母以正方形出现之外，一切都像做梦一样。现在我什至不知道这是否与公司的 IIS 语言设置（不能触摸它们）或其他什么有关，但我想知道是否有办法强制 asp 页面使用特定的编码，并且然后强制 asp.net Web 服务使用相同的字符集进行解码，中间*没有*任何类型的服务器设置有机会将它们混合在一起？

我试图环顾四周，但没有找到任何明确的例子来说明如何做到这一点。请保持回复简单，我只是在这里实习的初学者。谢谢您的帮助！

**编辑：** 道歉。没有包含代码，因为它太简单了，我不认为它会泄露任何东西。这里：

.asp

```
function loginfo()
   Dim text
   text = "ääböö"
   text = Server.URLENCODE(text)

   message = "http://server1/logger_webservice/service.asmx/test_Event?" & _
            "userID=" & userID
   Set objRequest = Server.createobject("MSXML2.XMLHTTP")

   With objRequest
   .open "GET", message, False
   .setRequestHeader "Content-Type", "text/xml"
   .send
   End With

   loginfo = objRequest.responseText
end function 
```

网络服务器：

```
<WebMethod()> _
Public Function test_Event(ByVal userId As String) As Boolean
   Dim kirj As StreamWriter
   kirj = File.CreateText("C:\Inetpub\server1\Logger_WebService\test_logEvent.txt")

   userId = Server.UrlDecode(userId)

   kirj.WriteLine("userId = " & userId)
   kirj.Close()
   kirj.Dispose()
End Function 
```

无论如何，谢谢你的帮助。我会更多地研究这个，但像往常一样，压力和匆忙迫使我继续前进。我编写了一个简单的代码来手动加密最常用的斯堪的纳维亚字母，并在 Web 服务器中对其进行解密。到目前为止工作正常，我只是希望没有任何并发​​症发生。反正只想要基本的芬兰字母 ä、ö 和 å。:)

我只是认为有一些简单的方法可以将编码强制为我找不到的特定字符集。在自己查找信息方面往往很糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T16:19:30.587

我最近提出的这个问题进一步阐明了 UrlEncoding 的此类问题：

[/questions/696659/why-is-this-appearing-in-my-c-strings-194163](/questions/696659/why-is-this-appearing-in-my-c-strings-194163)

它可能对您自己或遇到此问题的其他人有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:32:07.703

如果不深入研究代码，我不能给你一个“这里是第 X 行”的答案，但你正在处理的问题是编码问题之一。有多种编码字符串的方法，从 ASCII 到 UTF-8 到完整的 Unicode。这意味着如果强制使用完整的 unicode 编码可能会解决您的问题。

为此，您可以使用编码显式创建流（和/或读取器/写入器）。对于不同类型的对象，方法是不同的，不知道你的代码，我不能给你一个明确的答案。

但是，使用 ASP，您可能仍然会收到垃圾邮件。而且，我已经很久没有玩过经典的 ASP 了，我必须在那里挖掘才能得到答案。幸运的是，听起来你有办法测试 ASP 以确保正确的字符通过，所以测试一下。如果可行，请专注于 Web 服务。

# deployment - 发行说明应该怎么写？

> ID：638423
> 
> 赞同：40
> 
> 时间：2009-03-12T12:35:06.737
> 
> 标签：deployment, language-agnostic, release-notes

是否有任何关于如何编写发行说明的指南或最佳实践？我想我正试图在不太具体的情况下提出观点之间找到适当的平衡。此外，与提交给公众查看的版本相比，开发人员通常会为 QA 团队提供更多的发行说明吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-12T12:41:13.477

公开发行说明应至少包含：

*   发布，版本号
*   所有已修复的公共错误
*   所有添加的公共功能

QA 发行说明应至少包含：

*   发布，版本号
*   所有已修复的错误，包括错误编号
*   所有添加的功能，包括设计文档的链接

考虑你的听众，试着想想他们需要什么。

要添加的另一件事是对某些平台的新支持或已停止支持。（例如我们退出了对 Win3.1 的支持并添加了 Vista 64 位）。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-12T12:42:05.563

我会看一下流行的 F/OSS 项目的发行说明：

*   [火狐](http://www.mozilla.com/en-US/firefox/releases/)
*   [GIMP](http://www.gimp.org/release-notes/gimp-2.6.html)
*   [Ubuntu](http://www.ubuntu.com/getubuntu/releasenotes/810)
*   [安卓](http://developer.android.com/sdk/RELEASENOTES.html)
*   [团队城市](https://confluence.jetbrains.com/display/TW/TeamCity+10.0.4+%28build+42538%29+Release+Notes)
*   等等

所有这些项目都有相当可读和平衡的发行说明。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-12T12:41:42.057

如果您有一个项目管理/问题跟踪系统，那么您绝对应该使用它来生成您的发行说明。[Trac](http://trac.edgewall.org/)和[Redmine](http://www.redmine.org/)尤其擅长这一点。

发布点应该有一些属性，IMO：

*   **记住你的听众。**如果这是一个 iPhone 应用程序，很少有人会关心 Foo 类中第 572 行的特定逻辑错误已得到修复这一事实。但他们会非常关心“应用程序现在对加速度计敏感”。
*   如果可能，以广泛、全面的方式总结新的发展、特性和错误修正。如果您可以将它们按主题联系在一起（例如，“我们实现了泛型和匿名类型”），那么简短地介绍一下这是让人们了解全局的好方法。
*   列出已修复的具体内容，并附上指向您的公共错误跟踪器的链接（如果有）。这通常可以自动生成。
*   不要提供令人痛苦的细节。对添加或修复的每件事进行一或两行摘要就足够了。
*   始终酌情包含特定的版本标识符（例如“v.1.4.5”）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T12:42:13.100

这真的取决于观众。对于技术用户（例如使用您的 API 的开发人员），您可以非常专业。另一方面，您创建的应用程序的高级最终用户可能只对新功能和重大更改感兴趣。

介于两者之间的是也需要详细信息的非技术用户，例如支持部门。对于这些人，您可以在没有低级技术细节的情况下给出详细描述，例如“修复了记录未保存在数据库中的错误。”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T12:46:34.837

在我看来，发布说明的一个最佳实践是自动化。如果版本控制系统提交消息有某些最佳实践 ( [http://drupal.org/node/52287](http://drupal.org/node/52287) )，您可以通过自动化脚本 ( [http://cvs.drupal.org/viewvc.py/ ) 创建发行说明drupal/contributions/tricks/cvs-release-notes/](http://cvs.drupal.org/viewvc.py/drupal/contributions/tricks/cvs-release-notes/)）。这将创建非常好的发行说明：[http ://drupal.org/node/226165](http://drupal.org/node/226165)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-11T23:35:31.263

我发现[ReleaseNotesHub](https://www.releasenoteshub.com/)效果很好。它为发行说明的生成和发布提供了最佳实践。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-05T12:33:43.810

发行说明的主要贡献者将是您的开发团队。允许您的开发人员和测试人员针对链接到 TFS 中的变更集的工作项捕获任何与发布说明相关的信息是一种很好的做法。

[然后你可以使用像http://tfschangelog.codeplex.com](http://tfschangelog.codeplex.com)这样的开源项目来生成发行说明。它有 GUI 版本和命令行版本，可以轻松地安排每晚的发行说明报告。

# linux - 用于成像 Linux 应用程序的最佳语言/框架

> ID：638429
> 
> 赞同：-1
> 
> 时间：2009-03-12T12:37:05.450
> 
> 标签：linux, tiff, kde, imaging, scanning

我正在寻找最好的工具/语言/库/框架来开发必须在 KDE/Linux 上运行的文档扫描/成像/索引应用程序。应用程序必须提供以下功能：

1) 黑白文档扫描（单页和多页），将扫描的图像以 CCITT Group 4 压缩的 TIFF 格式保存。

2) 允许操作员在窗口中查看/浏览/缩放文档，并在预定义的对话框中手动输入索引信息（最多 5-6 个字段）。

3) 使用索引元数据生成 XML 文件，然后将 TIFF 和 XML 文件上传到 FTP 服务器进行进一步处理。

任何帮助将不胜感激。

埃内斯托。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T13:24:09.083

对于 KDE 4，您有 libksane，这取决于您的发行版，可能是单独的包或 kdegraphics 包的一部分。

至于开发语言的选择，请参考 KDE 的文档。 [http://techbase.kde.org/Development/Languages](http://techbase.kde.org/Development/Languages)

# c++ - Prolog ECLiPSe - 如何实现产量方法？

> ID：638452
> 
> 赞同：2
> 
> 时间：2009-03-12T12:42:45.220
> 
> 标签：c++, prolog, argument-passing

我正在使用 ECLiPSe 编程逻辑系统。

我想实现将值从 prolog 传递到 C/C++ 的 yield 方法。有没有人实施过？

还有其他传递值的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-29T20:36:47.220

以下页面介绍了如何使用 yield 方法将 ECLiPSe 与 C++ 集成：

[http://87.230.22.228/doc/embedding/embroot006.html#toc8](http://87.230.22.228/doc/embedding/embroot006.html#toc8)

# xml - 如何将 xml 节点的属性存储在字符串数组中？（重构）

> ID：638458
> 
> 赞同：-1
> 
> 时间：2009-03-12T12:44:30.207
> 
> 标签：xml, winforms

**重复[我如何将 xml 节点的属性存储在字符串数组中](https://stackoverflow.com/questions/637911/how-can-i-store-the-attributes-of-an-xml-node-in-an-array-of-strings)，您应该编辑原始问题。**

我是新手，所以我正在重新构建之前提出的问题。我有一个项目，我的 xmldoc 在 XmlDocument 类的帮助下创建，然后在 xmldoc.Load() 方法的帮助下加载。在 addnodes() 方法的帮助下，我将节点添加到树中，因此它显示在 winform 中。现在，当我单击树视图中的 xmlnode 时，它​​的属性会显示在列表框中。现在我已经在 UI 和后端部分中划分了整个逻辑。现在我想要我的后端类包含显示单击的 xml 节点的属性（名称和值）的方法，并将它们存储在一个数组中，并在 treev_AfterSelect 事件中作为字符串返回给我的前端类。我该怎么做？我需要将单击winform的节点的属性存储在字符串数组中并显示在列表框中。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T18:13:13.527

我从痛苦的经历中发现，使用该`Tag`属性会构建脆弱的解决方案。将 s映射`TreeNode`到`XmlElement`s 的一种类型安全的方法是创建一个`Dictionary<TreeNode, XmlElement>`. 一开始它比使用属性更难`Tag`，但它使关联非常明确。（我昨天刚刚修复了一个错误，该错误来自一段代码保存`Tag`属性中对象的键，而另一段代码希望`Tag`包含对象本身。）

所以 AfterSelect 事件中的代码如下所示：

```
TreeNode n = sender as TreeNode;
if (n != null)
{
   string[] result = TreeNodeMap[n].Attributes
      .Select(x => x.Name + "=" + x.Value)
      .ToArray();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T13:00:33.383

这可以使用更多细节，但我会冒险猜测：

您将 XmlElement 保存在 TreeNode 的 Tag 属性中，对吗？然后，您想从 AfterSelect 事件的 Tag 中获取该 XmlElement，并将其传递给将返回属性（和值？）的 IEnumerable 的方法。IEnumerable 代替 string[] 更灵活。

这很简单，我将把细节留作“练习”，但只需循环遍历 element.Attributes，并将每个属性名称和值添加到列表中。如果您愿意，可以将它们格式化为“name=value”。然后，只需返回列表。

# asp.net - 无法访问不可见时 ASP Grid 视图中的绑定列

> ID：638461
> 
> 赞同：4
> 
> 时间：2009-03-12T12:46:03.760
> 
> 标签：asp.net, gridview, boundcolumn

我有一个带有 BoundColumns 的 GridView。前 2 列是隐藏的，我想分别使用 gridView1.Rows[0].Cells[0].Text 和 gridView1.Rows[0].Cells[1].Text 访问它们，我得到一个空字符串。当列更改为可见时，我可以访问这些值。我已尝试按照其他一些论坛的建议将列宽更改为零，但这从未解决问题。有没有人对我可能做错了什么有任何指示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T13:08:13.630

如果 Columns 是`DataKeyNames`集合的一部分，那么您应该从`GridView.DataKeys[index].value`属性中获取它们的值，如[GridViewGuy 站点上](http://www.highoncoding.com/Articles/87_Accessing%20Invisible%20Columns%20of%20GridView%20Control.aspx)所示。

但是，如果它们不是`DataKeyNames`集合的一部分，那么您可以使用以下 hack 来确保值在 ViewState 中保持不变（与 ASP.NET 2+ 中隐藏字段的正常行为相反）

```
GridView1.DataSource = myDataSource;
// Set the column visibility to true before Databinding

GridView1.Columns[0].Visible = true;
GridView1.Columns[1].Visible = true;
GridView1.DataBind()

// Set the column visibility to false after Databinding
GridView1.Columns[0].Visible = false;
GridView1.Columns[1].Visible = false; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T13:10:50.283

这是 ASP.NET 中的典型行为，Visible = false，仅使控件在代码隐藏中可用。

最好的方法是在该列上应用以下样式：

```
display:'none' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-24T22:41:29.853

将 css 类添加`hiddencol`到要隐藏的列中。将`hiddencol`类添加到您的 css 中，您就可以开始了。

您仍然可以访问后面代码中的列，但它不会显示在您的页面上。

```
<asp:BoundField DataField="Site_ID" ItemStyle-CssClass="hiddencol" />

.hiddencol
{
    display: none;
} 
```

# c# - 引用自定义 C# 扩展方法的编译器错误

> ID：638463
> 
> 赞同：5
> 
> 时间：2009-03-12T12:46:38.440
> 
> 标签：c#, extension-methods

我第一次尝试创建扩展方法，但遇到了一些麻烦……也许你们可以帮忙:)

```
public static class Extentions
    {
        public static int myMethod(this MyClass c)
        {
              return 1;
        }
    } 
```

然后当我执行“MyClass.myMethod”时，我得到 q 编译器错误，说该方法不存在......

这是为什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-12T12:51:26.337

首先，您需要一个“使用”指令来包含包含您的类和扩展方法的命名空间。

第二 - 重新“MyClass.myMethod” - 扩展方法适用于*实例*，而不是静态 - 所以你需要：

```
MyClass foo = ...
int i = foo.myMethod(); // translates as: int i = Extentions.myMethod(foo); 
```

最后——如果你想在*内部* `MyClass`（或子类）使用扩展方法，你需要一个显式的`this`——即

```
int i = this.myMethod(); // translates as: int i = Extentions.myMethod(this); 
```

这是少数几个重要的案例之一`this`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T12:47:44.367

您是否包含定义扩展的名称空间？我以前就被那个烫伤了。

还有一种方法可以避免必须添加扩展名的命名空间，以便在该命名空间中定义扩展名。虽然这不是一个好习惯

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T12:49:11.867

您是否导入（`using`开头的子句）哪个`Extensions`类所在的名称空间？

```
using Myself.MyProduct.MyNamespace; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T13:34:12.040

是否有理由强迫您使用[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)？

如果您无法在原始源中添加方法并且无法使用子类扩展该类（如果已声明`sealed`） ，则应仅使用扩展方法

扩展方法页面指出：

> 一般来说，我们建议您谨慎地实施扩展方法，并且仅在必要时才实施。只要有可能，必须扩展现有类型的客户端代码应该通过创建从现有类型派生的新类型来实现。有关详细信息，请参阅[继承（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173149.aspx)。

[这是有关类](http://msdn.microsoft.com/en-us/library/0b0thckt.aspx)和[多态性](http://msdn.microsoft.com/en-us/library/ms173152.aspx)的更多信息。

如果确实不可能扩展类，那么请遵循有关`using`指令和实例[方法](http://msdn.microsoft.com/en-us/library/ms173114.aspx)与[静态方法](http://msdn.microsoft.com/en-us/library/79b3xss3.aspx)的其他答案。

# python - 在 stackless Python 中，您可以通过通道发送通道吗？

> ID：638464
> 
> 赞同：4
> 
> 时间：2009-03-12T12:46:57.987
> 
> 标签：python, stackless, python-stackless

我目前没有运行无堆栈，所以我*不能自己尝试。*

```
import stackless
ch1 = stackless.channel()
ch2 = stackless.channel()

ch1.send(ch2)
ch3 = ch1.receive() 
```

*那么ch2*和*ch3*是同一个频道吗？说：

```
text = "Hallo"
ch2.send(text)
assert text == ch3.receive() 
```

这个功能让我想起了Robert Pike（[Plan9](http://en.wikipedia.org/wiki/Plan_9_from_Bell_Labs)成名）在 Google上发表的[关于 Newsqueak的演讲。](https://www.youtube.com/watch?v=hB05UFqOtFA)在 Newsqueak 中，您可以通过频道发送频道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T14:26:27.217

是的。刚测试过。

```
>>> import stackless
>>> ch1 = stackless.channel()
>>> def a():
...  ch2 = stackless.channel()
...  ch1.send(ch2)
...  ch2.send("Hello")
...
>>> def b():
...  ch3 = ch1.receive()
...  print ch3.receive()
...
>>> stackless.tasklet(a)()
<stackless.tasklet object at 0x01C6FCB0>
>>> stackless.tasklet(b)()
<stackless.tasklet object at 0x01C6FAB0>
>>> stackless.run()
Hello 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T17:05:14.047

通道发送正常的 Python 引用，因此您发送的数据（通道、字符串等）正是接收到的数据。

通过通道发送通道的一个示例是当您将小任务用作服务时，即小任务在通道上侦听请求，执行工作并返回结果。请求需要包含工作的数据和结果的返回通道，以便结果到达请求者。

这是我几年前[在 PyCon 上为 Stackless 演讲](http://dalkescientific.com/StacklessPyCon2007-Dalke.pdf)开发的一个极端示例。这会为每个函数调用创建一个新的 tasklet，因此我可以使用阶乘的递归实现，而无需担心 Python 的堆栈限制。我为每个调用分配一个 tasklet，它获取结果的返回通道。

```
import stackless 

def call_wrapper(f, args, kwargs, result_ch): 
    result_ch.send(f(*args, **kwargs)) 
    # ... should also catch and forward exceptions ... 

def call(f, *args, **kwargs): 
    result_ch = stackless.channel() 
    stackless.tasklet(call_wrapper)(f, args, kwargs, result_ch) 
    return result_ch.receive() 

def factorial(n): 
    if n <= 1: 
        return 1 
    return n * call(factorial, n-1) 

print "5! =", factorial(5) 
print "1000! / 998! =", factorial(1000)/factorial(998) 
```

输出是：

```
5! = 120 
1000! / 998! = 999000 
```

在我的演示文稿中，我还有其他一些通过频道发送频道的示例。这在 Stackless 中很常见。

# php - PHP表单类

> ID：638465
> 
> 赞同：5
> 
> 时间：2009-03-12T12:47:24.833
> 
> 标签：php, validation

我习惯了 ASPNET 和 Django 的表单方法：很好的面向对象的处理程序，您可以在其中指定正则表达式进行验证，并以非常简单的方式完成所有操作。

在没有它的情况下幸福地生活了几个月后，我不得不回到 PHP 来做一个项目，并注意到我过去对 PHP 表单所做的一切（手动输出、手动验证、极度痛苦）都是完全垃圾。

是否有一个不错、简单且免费的类可以像*应该*那样进行表单生成和验证？

Clonefish 的想法是对的，但在价格标签上还差得很远。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-04-27T14:06:54.937

我最近在开发中使用了上面列出的项目 - [http://code.google.com/p/php-form-b​​uilder](http://code.google.com/p/php-form-builder-class/) -class /，并注意到最新版本（版本 1.0.3）将表格标记替换为更灵活的 div 布局，可以轻松设置样式以呈现您喜欢的表单。有许多示例可以帮助您快速入门。

我会推荐这个项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-21T00:08:51.333

这是另一个免费的选择：

[http://code.google.com/p/php-form-b​​uilder-class/](http://code.google.com/p/php-form-builder-class/)

它允许您使用以下代码创建表单：

```
include("../class.form.php5");

$form = new form("form_elements");

$form->addHidden("cmd", "submit");
$form->addTextbox("Textbox:", "field0");
$form->addTextarea("Textarea:", "field1");

$form->render(); 
```

优点：

*   内置表单验证（PHP 和 javascript）
*   开箱即用，与 jQuery UI、CKEditor/TinyMCE、谷歌地图、工具提示等集成。
*   非常容易启动和运行并创建强大的表单

缺点，最终使我无法使用它：

*   表单输出没有细粒度控制。您可以将整个表单呈现为表格，也可以不呈现。
*   没有字段集

它看起来正在积极开发中，因此可能值得关注未来的版本/改进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T13:11:12.983

[Zend_Form](http://framework.zend.com/manual/en/zend.form.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T15:30:22.120

最简单的解决方案（而不是通过学习另一个框架的过程）原来只是在 Django 中编写表单及其处理代码，并使用 CURL 将它们的输出拉入 PHP。

肮脏，但它很快，具有 Django 的所有功能，并且可以正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T15:19:44.723

[交响乐形式](http://www.symfony-project.org/book/forms/1_2/en/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-02T08:41:01.767

[CodeIgniter](http://codeigniter.com/)项目中有一个非常好的表单验证器：

阅读他们出色的文档中的文档和教程：

*   **[CodeIgniter.com > 用户指南 > 库 > 表单验证](http://codeigniter.com/user_guide/libraries/form_validation.html)**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-22T10:20:53.453

这是一个非常有能力的新人。在几个版本中，我认为它可能很棒。

[http://www.html-form-guide.com/php-form/php-form-validation.html](http://www.html-form-guide.com/php-form/php-form-validation.html)

# vb.net - 使用 My.Settings 的单元测试构造函数

> ID：638470
> 
> 赞同：0
> 
> 时间：2009-03-12T12:48:25.127
> 
> 标签：vb.net, unit-testing

我有一个看起来像这样的构造函数：

Public Sub New() MyBase.New() ws.Url = My.Settings.WebServiceURL End Sub

（ws 是私有的）

对此进行单元测试有什么意义吗？

该类以前没有此构造函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T12:52:25.993

这是该类的唯一构造函数吗？如果是这样，那么您每次测试该类时都对其进行测试，并且不需要单独的测试。如果您编写了一个单独的测试，您会在第一次成功后将其重构为其他测试。

# jquery - jQuery - 如何找到具有特定 id 的元素？

> ID：638471
> 
> 赞同：45
> 
> 时间：2009-03-12T12:48:40.430
> 
> 标签：jquery

我有一个表，每个表`td`都有一个**唯一的 id**，对应于一些时间间隔（`0800`til `0830`... `0830`til`0900`等等）。

我有一个输入文本，用户将在其中键入他们想要阻止的时间间隔。

如果他们输入的区间在我的表中不存在，换句话说，如果他们输入的区间与我的任何一个都不对应`td's id's`，我想显示一个警报，比如`this interval is not available for blocking`.

但是，我很难找到这个 id。

我正在这样做：

```
 var horaInicial = $("#horaInicial").val().split(':')[0] + $("#horaInicial").val().split(':')[1]; // this is remover the ":" from a formatted hour

    var verificaHorario = $("#tbIntervalos").find("td").attr("id", horaInicial); 
```

但这`verificaHorario`实际上是将我所有的 td 设置为这个 horaInicial id。

如何在我的表中找到 id，如果它不存在显示一些警报？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-03-12T12:53:07.253

如果您尝试通过 id 查找元素，则无需仅搜索表格 - 它在页面上应该是唯一的，因此您应该能够使用：

```
var verificaHorario = $('#' + horaInicial); 
```

如果您出于某种原因只需要在表中搜索，您可以使用：

```
var verificaHorario = $("#tbIntervalos").find("td#" + horaInicial) 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-12T12:54:15.737

我不知道这是否能解决您的问题，而不是：

```
$("#tbIntervalos").find("td").attr("id", horaInicial); 
```

你可以这样做：

```
$("#tbIntervalos td#" + horaInicial); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-12T12:52:53.573

这

```
var verificaHorario = $("#tbIntervalos").find("#" + horaInicial); 
```

会找到你需要阻止的 td。

实际上这也可以：

```
var verificaHorario = $("#" + horaInicial); 
```

测试包装集的 size() 将回答您关于 id 存在的问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-07T05:49:24.373

这是为上述问题找到元素的另一种选择

`$("#tbIntervalos").find('td[id="'+horaInicial+'"]')`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-12T12:52:29.970

由于所有 html id 在有效的 html 文档中都是唯一的，为什么不直接搜索 ID？如果您担心他们输入的 id 不是表格，那么您可以通过这种方式检查标签类型吗？

只是一个想法！

小号

# html - 在 ASP.NET 中拆分 html 表

> ID：638480
> 
> 赞同：0
> 
> 时间：2009-03-12T12:52:08.443
> 
> 标签：html, asp.net, split, html-table

我有一个 html 文件，其中有一个包含 4 列和多行的巨大表格。我想在 asp 2.0/3.5 页面中显示它，这样它的前 2 列出现在一个区域中，另外两列出现在与其相邻的另一个区域中。诸如将表格一分为二并显示之类的事情。有什么办法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T12:54:59.807

你如何生成表格？这将决定你如何分割它。

另外，我不明白将两半并排放置的好处。你是不是打算能隐藏一半？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T13:08:49.743

我会将数据集拆分为具有适当列的两个单独的数据集。我还会有两个单独的 GridView 来显示不同的数据集。

为了最大程度地减少代码重复，我将使用 ASP.NET 主题来为数据集设置外观，并且我还将连接到相同的 GridView 函数（更新命令、DataBound 等），这样您就不必重新编写太多内容。

如果您是手工制作表格，那只是改变您的响应位置的问题。编写 and 's to。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T10:00:23.700

好吧，我写了一个正则表达式并将文件拆分为两个 html 文件。然后我将它们中的每一个加载到一个 div 标签中。它对我有用。

# jquery - 使用 Jquery 替换链接的锚部分中的 http://

> ID：638488
> 
> 赞同：0
> 
> 时间：2009-03-12T12:53:23.540
> 
> 标签：jquery, class, replace, hyperlink, anchor

在一个页面上有几个链接：

```
<a class="linked" href="http://link1.com>http://link1.com</a>

<a class="linked" href="http://link2.com>http://link2.com</a> 
```

如何删除每个链接中的第二个 http:// 以便在屏幕上看不到它。

我试过这个无济于事：

```
$(document).ready(function() {

$('.linked').html().replace("http://",""); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T12:57:30.207

如果您正在谈论锚标记中的可见文本

```
$.each($('.linked'), function()
{
  var anchor = $(this);
  anchor.text( anchor.text().replace("http:\/\/",'') )
}); 
```

失踪 '）;' 在最后...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T13:18:39.970

仅作记录，无 jQuery 版本：

```
var links = document.links;
for(var i = links.length; i--; ) {
    with(links[i]) {
        if(/(^|\s)linked(\s|$)/.test(className)) {
            firstChild.nodeValue =
                firstChild.nodeValue.replace(/^http:\/\//, '');
        }
    }
} 
```

# java - 将 Java 字节码翻译成其他表示和编程语言

> ID：638491
> 
> 赞同：7
> 
> 时间：2009-03-12T12:54:46.797
> 
> 标签：java, translation, bytecode, decompiling

我正在寻找将 Java 字节码转换为其他编程语言的方法/工具/项目，或者，如果失败了，至少转换为结构化表示（如 XML）。理想的开源，自然。

我看过[ASM](http://asm.objectweb.org/)，“字节码操作和分析框架”。它不支持转换为其他表示，但看起来像是这样一个项目的良好基础。可悲的是，他们的[用户页面](http://asm.objectweb.org/users.html)上列出的项目都没有接近。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T14:10:11.470

ASM 有 tree api，它基本上可以为您提供字节码的完整结构。似乎很容易使用它甚至访问者 api 以 XML 或其他格式打印出来。不知道那有什么用。

翻译回 Java 是反编译器的工作，像 Jad 这样的工作就可以了。但这很难，因为a）在源到字节码的转换过程中会丢失信息，b）在多个源可以产生相同的字节码时存在歧义。

如果您真的想直接从字节码转换为另一种高级语言，那么这将很难全面而有意义地完成，出于同样的原因，反编译也很困难，除非转换成另一种语言更糟糕。

如果您想从 Java 源代码转换到另一种语言的源代码，这在之前已经完成，就像在这个[Java-to-Python 转换器](http://blog.melhase.net/articles/2007/02/15/automated-translation-of-java-to-python)中一样。这有点容易，因为您可以使用[Antlr](http://antlr.org/)或内置 Java 编译器工具[Project Jackpot](http://jackpot.netbeans.org/)等将 Java 转换为 AST。即便如此，我认为您不会在目标语言中获得非常惯用的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T16:50:11.197

试试[BCEL](http://jakarta.apache.org/bcel/manual.html)（字节码工程库）。您可以实现一个访问者接口，您可以使用它来生成您想要的任何内容（另一种语言的源代码、自定义 AST、xml 等等）。

我在大学的一个项目中使用了它，我（主要）修改了一个可以处理 Java 源代码的程序分析框架，使其也可以处理 Java 字节码。该任务涉及为分析框架的内部 AST 表示生成节点。

还，

我简要浏览了您提到的“ASM”项目的文档。看起来它定义了几个 vistior 类。您也应该能够使用它们来做您想做的事情。

如果您不熟悉访问者模式，请查看[此处](http://en.wikipedia.org/wiki/Visitor_pattern)的说明。另外，如果你还没有读过，“[四人帮](https://rads.stackoverflow.com/amzn/click/com/0201633612)”这本书是一本不错的书。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T13:04:22.140

看起来你正在寻找一个交叉编译器。我知道[xmlvm](http://www.xmlvm.org/)项目，但从未使用过它。也许这适合您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T13:12:35.973

您可以尝试[gcj](http://gcc.gnu.org/java/)将字节码转换为本机代码。

如果您想转换成诸如 python/groovy/ruby 之类的语言，也许可以考虑直接在 JVM 上用这些语言编写（我意识到这并不是您想要的）*。*

[或许可以从这个Eclipse Byte Code outline viewer 之](http://andrei.gmxhome.de/bytecode/index.html)类的东西中寻找一些示例。

最后，从一种低级语言（字节码）转换为另一种语言将非常棘手，正确性将是一个问题。

# php - 停止向数据库中插入数据两次

> ID：638494
> 
> 赞同：25
> 
> 时间：2009-03-12T12:55:07.297
> 
> 标签：php, user-input

我想知道当用户在与表单相同的页面上刷新时，其他程序员使用哪些方法/预防措施来阻止将数据两次输入到 MySQL 数据库中？显然它发生了，我需要一个好的方法来阻止它。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-12T12:58:44.480

我称之为网络编程的黄金法则：

永远不要用正文来响应 POST 请求。总是做这项工作，然后用 Location: 标头响应以重定向到更新的页面，以便浏览器使用 GET 请求它。

这样，清爽不会对您造成任何伤害。

此外，关于评论中的讨论。为了防止重复发布，比如意外双击提交按钮，将表单的 md5() 存储在文本文件中，并将新表单的 md5 与存储的 md5 进行比较。如果他们是平等的，你有一个双重职位。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T12:57:44.637

处理表单，然后重定向到结果页面。重新加载然后仅重新显示结果页面。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T16:59:18.290

伊利亚的回答是正确的，我只是想补充一点，而不是评论：

如果重新提交是危险的（返回并再次提交，重新加载结果页面[如果你没有接受 Ilya 的建议]，等等）我使用“nonce”来确保表单只能通过一次。

在表单页面上：

```
<?php
@session_start(); // make sure there is a session

// store some random string/number
$_SESSION['nonce'] = $nonce = md5('salt'.microtime());
?>
// ... snip ...
<form ... >
<input type="hidden" name="nonce" value="<?php echo $nonce; ?>" />
</form> 
```

在处理页面中：

```
<?php
if (!empty($_POST)) {
@session_start();

// check the nonce
if ($_SESSION['nonce'] != $_POST['nonce']) {
    // some error condition
} else {
    // clear the session nonce
    $_SESSION['nonce'] = null;
}

// continue processing 
```

表单提交一次后，不能再次提交，除非用户故意填写第二次。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-12T13:55:00.880

显而易见（我还没有在这里看到......）：永远不要使用 GET 发布数据，始终使用 POST，这样如果用户尝试刷新/重新发布页面，至少会收到警告（至少在 Firefox 中，但我想在其他浏览器中也是如此）。

顺便说一句，如果您不能承受两次相同的数据，您还应该考虑使用唯一键（可以是字段的组合）的 MySQL 解决方案，并且：

```
 INSERT INTO ... ON DUPLICATE KEY UPDATE ... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T19:21:34.907

除了已经提到的关于让用户离开发布页面以便刷新和返回按钮无害的好建议之外，改进数据存储的另一层是使用[UUID](http://en.wikipedia.org/wiki/Uuid)作为表中的键并让您的应用程序生成它们。

这些在 Microsoft 世界中也称为 GUID，在 PHP 中，您可以通过 PHP 中的 uniqid() 生成一个。这是一个 32 个字符的十六进制值，您应该以十六进制/二进制列格式存储它，但如果该表不会被大量使用，那么 CHAR(32) 将起作用。

当您将表单显示为隐藏输入时生成此 ID，并确保将数据库列标记为主键。现在，如果用户确实设法回到发布页面，则 INSERT 将失败，因为您不能有重复的键。

额外的好处是，如果您在代码中生成 UUID，那么在执行插入之后，您将永远不需要使用浪费的查询来检索生成的密钥，因为您已经知道它了。当您需要将子项插入其他表时，这是一个很好的好处。

好的编程是基于分层你的工作，而不是依赖于一件事情来工作。尽管编码人员依赖增量 ID 是多么普遍，但它们是构建表的最懒惰的方式之一。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T13:07:10.433

我同意 Ilya 的观点，并补充说，一旦单击“提交”按钮，您应该使用一些客户端 javascript 来禁用它，或者显示一个模式对话框（css 可以在此处为您提供帮助）以避免多次单击提交按钮。

最后，如果您不希望数据库中的数据两次，那么在尝试插入数据之前还要检查数据库中的数据。如果您确实允许重复记录但不希望从单一来源快速重复插入，那么我会使用时间/日期戳和 IP 地址字段来允许在我的提交代码中进行基于时间的“锁定”，即如果IP 相同且上次提交时间小于 5 分钟前，则不插入新记录。

希望能给你一些想法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-12T14:38:02.430

您可能想查看大多数现代 Web 应用程序实现的 POST/Redirect/GET 模式，请参阅[http://en.wikipedia.org/wiki/Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-13T13:49:31.590

我通常依靠 sql UNIQUE 索引约束。 [http://dev.mysql.com/doc/refman/5.0/en/constraint-primary-key.html](http://dev.mysql.com/doc/refman/5.0/en/constraint-primary-key.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-19T09:48:05.083

您必须在 showAddProductForm() 方法中将一个 uniqid 变量传递到您的 html 中，并将相同的 uniqid 传递到您的 $_SESSION 例如：

```
public function showAddProductForm()
{
    $uniId = uniqid();
    $_SESSION['token'][$uniId] = '1';
    $fields['token'] = 'token['.$uniId.']';

    $this->fileName = 'product.add.form.php';
    $this->template($fields);
    die();
} 
```

然后，您必须在表单内的 HTML 代码中放置一个隐藏的输入，其中 uniqid 的值已从 showAddProductForm 方法传递到 HTML 中。

```
<input type="hidden" name="<?=$list['token']?>" value="1"> 
```

在提交事件之后，您将在 addProduct() 方法的开头对其进行分析。如果令牌存在于 $_SESSION 中并且它在该数组中具有相等的值，那么这就是新的请求。将他重定向到正确的页面并取消设置令牌并继续插入。否则是来自重新加载页面或重复请求，将他重定向到 addProdeuct 页面

```
public function addProducts($fields)
{
    $token_list = array_keys($fields['token']);
    $token = $token_list['0'];
    if (isset($_SESSION['token'][$token]) and $_SESSION['token'][$token] == '1') {
        unset($_SESSION['token'][$token]);
    } else {
        $this->addAnnounceForm($fields, '');
    }
} 
```

也许你会问为什么一个令牌数组为什么不是一个变量。因为在管理面板中，用户打开多个选项卡并插入多个选项卡，所以如果他们使用多个选项卡，此算法将失败。

特别感谢谁想出了这个方法[malekloo](https://www.linkedin.com/in/mahmoud-malekloo-7b822378/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T20:45:16.260

避免在页面刷新时重复插入记录的最佳方法是，在单击按钮后在数据库中插入记录后，只需添加以下行：

```
Response.Write("<script>location.href='yourpage.aspx'</script>"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T20:52:47.617

尝试在表单中包含一些内容以防止重复提交，最好同时防止跨站点请求伪造。我建议使用我称之为*[formkey](http://stereochro.me/ideas/formkeys)*的东西，它是一个一次性字段，用于唯一标识表单提交，将其绑定到位于个人地址的个人用户。这个概念也有其他名称，但我链接到的简短说明已经很好地解释了它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-12T12:57:48.397

好吧，首先，为了最小化，你应该这样做，所以他们必须做表单发布来插入数据。这样，至少他们会得到一个很好的确认对话框，询问他们是否真的想重新提交。

更复杂的是，您可以在每个表单中放置一个隐藏的一次性使用密钥，一旦提交了具有该密钥的表单，当他们尝试提交具有相同密钥的表单时会显示错误。要创建此密钥，您可能需要使用 GUID 之类的东西。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-12T13:13:05.240

添加一个带有随机字符串的隐藏字段（`md5(uniqid())`例如由 产生），在数据库中为该字符串创建一个字段并将其设为唯一。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-12T13:23:42.033

您可以使用令牌来防止页面再次被处理！很多网络框架中都使用了这样的程序！

您应该使用的模式是“同步器令牌模式”！如果您有一个面向服务的应用程序，您可以将您的状态保存在数据库中。

数据可以通过 JavaScript 或隐藏的表单字段发送。

你还应该看看那些开箱即用的库支持这样的东西！Grails就是这样一个！

请参阅：[http](http://www.grails.org/1.1-Beta3+Release+Notes) ://www.grails.org/1.1-Beta3+Release+Notes ...

```
<g:form useToken="true"> 
```

...

```
withForm {
   // good request
}.invalidToken {
   // bad request
} 
```

..

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-17T11:32:39.160

**POE** *（Post Once Exactly）*是一种 HTTP 模式，旨在警告客户端使用专有标头阻止双重提交......

```
GET /posts/new HTTP/1.1
POE: 1
... 
```

...但仍符合规范。

[http://www.mnot.net/drafts/draft-nottingham-http-poe-00.txt](http://www.mnot.net/drafts/draft-nottingham-http-poe-00.txt)

我认为上述随机数是一个很好的解决方案。尽管将 nonce 存储为离散会话变量会在客户端尝试从多个选项卡执行同时发布时引入一些错误。也许更好...

```
$_SESSION['nonces'][] = $nonce; 
```

... 和 ...

```
if (in_array($_POST['nonce'], $_SESSION['nonces'])) { 
```

...允许多个随机数（nonci？noncei？）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-12T17:17:54.377

我的两分钱：

*   发送数据后将用户重定向到同一页面并验证`if(isset($_POST['submit'])`

类似案例的其他有用信息：

*   看一下[MySQL 中的 LOCK TABLES](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)

*   第一次单击后通过 JavaScript 禁用按钮

# c# - 什么是最快的：(int)、Convert.ToInt32(x) 或 Int32.Parse(x)？

> ID：638496
> 
> 赞同：47
> 
> 时间：2009-03-12T12:55:22.210
> 
> 标签：c#, optimization, casting

以下哪个代码是转换某些对象 x 的最快/最佳实践？

```
int myInt = (int)x; 
```

或者

```
int myInt = Convert.ToInt32(x); 
```

或者

```
int myInt = Int32.Parse(x); 
```

或者在字符串 's' 的情况下

```
int myInt;
Int32.TryParse(s, out myInt); 
```

我很好奇对于在 Convert 中具有方法的数据类型执行最快，而不仅仅是整数。我只是以 int 为例。

编辑：这种情况源于从数据表中获取信息。(int) 仍然会以最快的速度工作吗？

从一些测试来看，当 object x =123123123 时，int 执行得最快，就像许多人所说的那样。当 x 是字符串时，Parse 运行速度最快（注意：cast 会抛出异常）。我真正好奇的是，当通过以下方式检索值时它们是如何运行的：

```
foreach(DataRow row in someTable.Rows)
{
    myInt = (int)row["some int value"];
    myInt2 = Int.Parse(row["some int value"]);
    myInt2 = Convert.ToInt32(row["some int value"]);
} 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-03-12T13:17:07.633

## 这取决于您期望 x 是什么

如果 x 是一个装箱的 int，那么`(int)x`它是最快的。

如果 x 是一个字符串，但绝对是一个有效数字，那么`int.Parse(x)`最好

如果 x 是一个字符串，但它可能无效，那么`int.TryParse(x)`它比 try-catch 块快得多。

Parse 和 TryParse 之间的差异在所有循环中都可以忽略不计，但最大的循环除外。

如果您不知道 x 是什么（可能是字符串或盒装 int），那么`Convert.ToInt32(x)`最好。

这些通用规则也适用于所有具有静态 Parse 和 TryParse 方法的值类型。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-03-12T13:04:11.987

**最快！=最佳实践！**

例如，`(int)`几乎可以肯定是最快的，因为它是一个运算符而不是函数调用，但它只在某些情况下有效。

最佳做法是使用不会对性能产生负面影响的*可读性最强的代码，100 次整数转换中有 99 次不会提高应用程序的性能。*如果是，请尽可能使用最合适、最窄的转换。有时就是这样`(int)`。有时是`TryParse()`。有时是`Convert.ToInt32()`。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-12T13:00:45.317

你为什么不试试几千次呢？

（这适用于所有“什么是最快的：”问题）

* * *

嗯，多年来有很多反对意见......我想我应该扩大这个答案。

上述说法在我年轻时有一定程度的轻率，但我仍然同意它的观点。花时间创建一个 SO 问题来询问其他人他们认为在每个花费不到 1 毫秒的两三个操作中哪个更快是不值得的。

在日常使用中，一个可能比另一个长一两个周期的事实几乎可以忽略不计。而且，如果您在将数百万个对象转换为整数时注意到应用程序中的性能问题，**那么**您可以分析*实际*代码，并且您将能够轻松测试整数转换是否实际上是瓶颈。

虽然今天它是 object-int 转换器，但明天您可能会认为您的 object-DateTime 转换器需要很长时间。您会创建另一个 SO 问题来找出最快的方法吗？

至于您的情况（现在肯定早就解决了），正如评论中提到的，您正在查询数据库，因此 object-int 转换是您最不必担心的。如果我是你，我会使用你提到的任何转换方法。如果出现问题，我会使用分析器或日志记录来隔离呼叫。然后，当我注意到 object-int 转换进行了一百万次并且该转换所花费的总时间似乎相对较高时，我会改为使用不同的转换方法并重新配置文件。选择耗时最少的转换方法。您甚至可以在单独的解决方案中进行测试，甚至可以在 LINQPad 或 Powershell 等中进行测试。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-12T12:59:19.983

如果您知道数据肯定是 int 那么`int myInt = (int)x;`应该是最快的选择。否则`TryParse`将帮助您在没有异常缓慢的情况下正确处理它。

顺便提一句 ：

(int) 只拆箱因此更快，

(int) IL =

```
 .locals init (
        [0] object x,
        [1] int32 Y)
    L_0000: ldc.i4.1 
    L_0001: box int32
    L_0006: stloc.0 
    L_0007: ldloc.0 
    L_0008: unbox int32
    L_000d: ldobj int32
    L_0012: stloc.1 
    L_0013: ret 
```

转换.Toint32=

```
.locals init (
        [0] object x,
        [1] int32 Y)
    L_0000: ldc.i4.1 
    L_0001: box int32
    L_0006: stloc.0 
    L_0007: ldloc.0 
    L_0008: call object [mscorlib]System.Runtime.CompilerServices.RuntimeHelpers::GetObjectValue(object)
    L_000d: call int32 [mscorlib]System.Convert::ToInt32(object)
    L_0012: stloc.1 
    L_0013: ret 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-03-13T06:30:53.423

当我对执行此类特定操作的不同方式之间的性能差异有疑问时，我通常会在我的 MeasureIt 副本中创建一个新条目，该副本可从 Vance Morrison的一篇精彩的[MSDN 文章免费下载。](http://blogs.msdn.com/b/vancem/archive/2009/02/06/measureit-update-tool-for-doing-microbenchmarks.aspx)有关更多信息，请参阅文章。

通过向 MeasureIt 添加一些简单的代码，我得到了下面的结果，它比较了转换为 int 的各种方法的实际时间。请注意，从 string 到 int 的强制转换会引发异常并且无效，因此我只是添加了对我有意义的排列。

```

名称 中位数 Mean StdDev Min Max Samples       
IntCasts：复制 [count=1000 scale=10.0] 0.054 0.060 0.014 0.054 0.101 10       
IntCasts：Cast Int [count=1000 scale=10.0] 0.059 0.060 0.007 0.054 0.080 10       
IntCasts：投射对象 [count=1000 scale=10.0] 0.097 0.100 0.008 0.097 0.122 10       
IntCasts：int.Parse [count=1000 scale=10.0] 2.721 3.169 0.850 2.687 5.473 10       
IntCasts：Convert.ToInt32 [count=1000 scale=10.0] 3.221 3.258 0.067 3.219 3.418 10     

```

要为您感兴趣的各种类型找到最佳性能，只需扩展下面的代码，这就是我必须添加到 MeasureIt 以生成上表的全部内容。

```
static unsafe public void MeasureIntCasts()
{
    int result;
    int intInput = 1234;
    object objInput = 1234;
    string strInput = "1234";

    timer1000.Measure("Copy", 10, delegate
    {
        result = intInput;
    });
    timer1000.Measure("Cast Object", 10, delegate
    {
        result = (int)objInput;
    });

    timer1000.Measure("int.Parse", 10, delegate
    {
        result = int.Parse(strInput);
    });

    timer1000.Measure("Convert.ToInt32", 10, delegate
    {
        result = Convert.ToInt32(strInput);
    });
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-12T12:58:48.037

最佳实践是 TryParse，并查看结果，如果它有效 - 否则你可能会遇到异常

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-13T00:20:15.953

在 .Net 2 中优化绑定数据网格时，我发现几乎一半的时间都花在了各种对象的 ToString() 方法上，这些方法随后被用作转换操作的输入。通过隔离这些情况并在可能的情况下转换为正确的类型（因为它们是从数据库中取出的行并且可以依赖这些类型），这导致数据绑定操作的速度大幅提高。

因此，如果您预先知道事物的类型，并且您会多次访问该代码，那么直接转换它而不是在必要时进行转换是值得的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-17T12:21:21.187

[通过Sam Allen](http://www.dotnetperls.com/unsafe-parse "山姆·艾伦")的替代方案扩展 Eric Cosky 的测试，我发现如果你知道你的字符串是一个有效的整数，那么自己解析它会快得多。

我通过以下情况扩展了测试：

```
 timer1000.Measure("IntParseFast", 10, delegate
    {
        result = Misc.IntParseFast(strInput);
    });

    timer1000.Measure("IntParseUnsafe", 10, delegate
    {
        result = Misc.IntParseUnsafe(strInput);
    }); 
```

使用以下实现：

```
public static int IntParseFast(string value)
{
    int result = 0;
    int length = value.Length;
    for (int i = 0; i < length; i++)
    {
        result = 10 * result + (value[i] - 48);
    }
    return result;
}

public unsafe static int IntParseUnsafe(string value)
{
    int result = 0;
    fixed (char* v = value)
    {
        char* str = v;
        while (*str != '\0')
        {
            result = 10 * result + (*str - 48);
            str++;
        }
    }
    return result;
} 
```

我得到以下结果：

```
IntCaint.Parse                5,495
IntCaConvert.ToInt32          5,653
IntCaIntParseFast             1,154
IntCaIntParseUnsafe           1,245 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-27T09:47:36.323

这不是真的。快速转换是直接转换：

```
int i = (int) stringData;

watch.Elapsed = {00:00:00.1732388}
watch2.Elapsed= {00:00:00.0878196}

 // Mesary start
                Stopwatch watch = new Stopwatch();

                watch.Start();
                for (int f = 1; f < 1000000; f++)
                {
                    item.Count = FastInt32.IntParseFast(dt.Rows[i]["TopCount"]);
                }   // Execute the task to be timed
                watch.Stop();

                Console.WriteLine("Elapsed: {0}", watch.Elapsed);
                Console.WriteLine("In milliseconds: {0}", watch.ElapsedMilliseconds);
                Console.WriteLine("In timer ticks: {0}", watch.ElapsedTicks);
                // Mesary end

                // Mesary start
                Stopwatch watch2 = new Stopwatch();

                watch2.Start();
                for (int n = 1; n < 1000000; n++)
                {
                    item.Count = (int)(dt.Rows[i]["TopCount"]);
                }   // Execute the task to be timed
                watch2.Stop();

                Console.WriteLine("Elapsed: {0}", watch2.Elapsed);
                Console.WriteLine("In milliseconds: {0}", watch2.ElapsedMilliseconds);
                Console.WriteLine("In timer ticks: {0}", watch2.ElapsedTicks);
                // Mesary end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T13:00:16.333

不确定性能，但这些方法根本不一样。两者都`Parse`使用`TryParse`字符串，`String`对象的表示被解析（参见 MSDN）。

> 将数字的字符串表示形式转换为其等效的 32 位有符号整数。

不确定转换和`Convert`类，但转换仅适用于实际上已经是整数但不是强类型的对象。

马蒂亚斯

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T13:11:49.517

如果您需要额外的速度，很容易测试不同的不同选项。由于您没有测试它们，因此您不需要它们。不要在毫无意义的微优化上浪费时间！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-12T13:18:06.163

(int) 对字符串的转换不起作用，所以我不测试它。Convert.ToInt32 反映为将值测试为 null 然后调用 int.Parse，因此通常应该比 int.Parse() 慢。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-08T19:19:58.983

```
foreach(DataRow row in someTable.Rows)
{
    myInt = (int)row["some int value"];
    myInt2 = Int.Parse(row["some int value"]);
    myInt2 = Convert.ToInt32(row["some int value"]);
} 
```

对于此示例，如果来自表的值确实是 int 值或可比较的数据库值，则使用

```
myInt = (int)row["some int value"]; 
```

将是最有效的，因此是“最快的”，因为

```
row["some int value"]; 
```

将是装在引用类型对象实例中的值类型 int 实例，因此使用显式类型转换将是最快的，因为其他人说这是一个操作而不是函数调用，从而减少了所需的 cpu 操作。对转换或解析方法的调用将需要额外的 cpu 操作，因此不会那么“快”。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-09-23T12:52:15.000

有人已经完成了基准测试。[这是结果。](http://cc.davelozinski.com/c-sharp/fastest-way-to-convert-a-string-to-an-int)如果您知道要转换的内容始终是有效的 int，那么最快的方法是使用以下方法（上面有几个人已经回答过）*：*

```
int value = 0;
for (int i = 0; i < str.Length; i++)
{
    value = value * 10 + (str[i] - '0');
} 
```

其他被[基准测试](http://cc.davelozinski.com/c-sharp/fastest-way-to-convert-a-string-to-an-int)的技术是：

*   转换.ToInt32
*   Int32.TryParse
*   int.解析

* * *

## 回答 #15

> 赞同：-6
> 
> 时间：2009-03-12T12:59:46.723

最后，他们都打电话给：

```
System.Number.ParseInt32(string s, NumberStyles style, NumberFormatInfo info); 
```

所以总而言之，不会有什么不同。

*看看[.Net Reflector](http://www.red-gate.com/products/reflector/)看看这个。*

# cookies - 什么是 cookie 点规则？

> ID：638497
> 
> 赞同：5
> 
> 时间：2009-03-12T12:56:02.630
> 
> 标签：cookies, google-analytics, google-website-optimizer

我同时使用谷歌分析和谷歌网站优化器。在我们的开发平台上，我突然意识到有些 cookie 设置了两次。

GA cookie：

```
__utma
__umtb
__utmc
__utmz 
```

全部由 GWO 和 GA 设置。我只希望看到一组这样的 cookie。GWO 在域名前用一个点设置它们：

> .dev.example.com

虽然 GA 将它们设置为：

> dev.example.com

我试图用谷歌搜索并在[RFC2109 HTTP 状态管理机制中阅读了一些关于它的内容](http://www.ietf.org/rfc/rfc2109.txt)

在 SO 上搜索它，会得到许多引用“cookie 点规则”的答案，但我仍然不明白。

该规则到底是什么，它有哪些含义？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T13:12:14.587

我认为您了解 cookie 如何工作的基础知识，即对于任何 HTTP 请求，浏览器都会发送它存储的所有“相关”cookie。

为域“example.com”设置的 cookie 仅与对[http://example.com](http://example.com)的请求相关，而为“.example.com”设置的 cookie 也与其所有子域相关

# c# - 在 C# 中创建二维数组的字典

> ID：638498
> 
> 赞同：2
> 
> 时间：2009-03-12T12:56:17.277
> 
> 标签：c#

我正在尝试在 C# 中创建二维数组的字典，但我无法弄清楚正确的语法。我尝试了以下无济于事，但它显示了我想要完成的事情。

```
 Dictionary dictLocOne = new Dictionary<String,double[][]>(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T13:06:50.683

这里有几件事：

定义必须匹配初始化。您正在定义 Dictionary 并实例化 Dictionary<TKey, TValue>。这意味着什么，根据您在这里所说的：

```
Dictionary<string, double[][]> dict = new Dictionary<string, double[][]>(); 
```

我想这就是你想要的。如果是这样，您的代码可能是这样的：

```
 double[] d1 = { 1.0, 2.0 };
    double[] d2 = { 3.0, 4.0 };
    double[] d3 = { 5.0, 6.0, 7.0 };

    double[][] dd1 = { d1 };
    double[][] dd2 = { d2, d3 };

    Dictionary<string, double[][]> dict = new Dictionary<string, double[][]>();
    dict.Add("dd1", dd1);
    dict.Add("dd2", dd2); 
```

如果是这样，你的问题就解决了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T12:58:52.700

只是要根据其他答案更新我的答案以包含正确的声明：

```
Dictionary<String,double[][]> = new Dictionary<String,double[][]>(); 
```

***Alsoyours***是***数组数组***，而不是多维数组..不确定这是否是您想要的..

 *如果你想要一个多维数组，它是

```
Dictionary<String,double[,]> = new Dictionary<String,double[,]>(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T12:58:53.963

您还必须完全限定变量的类型，而不仅仅是要分配的内容：

```
Dictionary<String,double[][]> dictLocOne = new Dictionary<String,double[][]>(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T12:59:50.547

尝试

```
var dict = new Dictionary<String, double[,]>(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T13:11:24.403

例子：

`var d = new Dictionary<string, double[,]>();`

`d["foo"] = new[,] { { 0.1, 1.0 }, { 0.2, 2.0 }, { 0.3, 3.0 } };`

# visual-studio - 设置 Visual SVN 以供实际使用

> ID：638520
> 
> 赞同：2
> 
> 时间：2009-03-12T13:00:49.637
> 
> 标签：visual-studio, svn, visualsvn

我刚刚在我的本地机器和托管我们网站的服务器上设置了 VisualSVN。我在安装软件时使用了标准的默认设置，但我有点困惑如何在我们的设置中使用它。

我已经测试了安装，一切似乎都正常。在 Visual Studio 2008 中，我可以使用“服务器/svn/域名文件夹的 IP”成功连接到网站文件并将其提交到服务器。如果我将浏览器指向 URL“服务器/svn/域名文件夹的 IP”并输入我的用户名和密码，我会看到一个文件夹树，其中包含我刚刚上传的所有文件。所以这些位工作正常。

我的问题是我们如何测试我刚刚上传的网站？在我们的服务器上，我们所有的网站都存储在“C:\sites\domainname”文件夹中。在 IIS 中，我们将该文件夹映射到域名，因此当有人输入 domainname.com 时，他们会获得正确的网站。如何配置 Visual SVN 服务器设置以允许我使用我们当前拥有的“C:\sites\domainname”设置？

任何帮助将不胜感激，因为我对此感到完全困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T13:49:46.680

我认为您对 VisualSVN 是什么感到困惑：

> VisualSVN Server 是一个包，其中包含您在 Windows 平台上为您的团队安装、配置和管理 Subversion 服务器所需的一切。它包括 Subversion、Apache 和一个管理控制台。

它是一个漂亮的包，包含在 Windows 机器上运行 Subversion 源代码控制服务器所需的一切。我喜欢它。通常，您不会将它安装在同时托管网站的机器上，我绝对不会在托管面向公众的网站的机器上安装它。

Subversion 只是一个源代码控制系统。它不会改变您部署站点的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T13:50:28.020

在我的公司，我们通过以下解决方案实现了这一点：

*   设置一个[hudson CI 服务器](http://hudson.dev.java.net)，通过轮询 SVN 定期构建我们的产品
*   在项目配置的构建步骤中，构建工件被复制到 c:\artifacts 之类的文件夹中。
*   然后我们在 C:\Program Files\VisualSVN Server\conf\httpd-custom.conf 中创建了一个自定义 apache 配置文件（*不要*修改 httpd.conf；它在更新等过程中会被覆盖）

然后我们将以下内容添加到 httpd-custom.conf：

```
LoadModule alias_module bin/mod_alias.so
<Directory "C:/artifacts">
    Options Indexes
    AllowOverride None
</Directory>

<IfModule alias_module>
    Alias /artifacts C:/artifacts
</IfModule> 
```

现在[http://svn.example.com/artifacts/](http://svn.example.com/artifacts/)充当测试站点，并在任何开发人员向 SVN 提交代码时自动更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T13:05:24.527

听起来你需要检查这些网站从颠覆到网络服务器。将 IIS 中的虚拟驱动器映射到这些文件夹。

为清晰起见进行了编辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T13:05:31.997

我从未使用过 VisualSVN，但我认为通常使用 SVN 和网络服务器，您可以将适当的代码检出到 C:\sites\domainname 中。

然后，当您想将代码推送到服务器上时，您可以在该目录上运行 SVN 更新（假设已将适当的更改推送到 subversion）。显然，我会事先使用一个测试域和另一个目录来测试它（或者只是用 IIS 浏览一个测试目录）。

不过就个人而言，由于我使用 asp.net 和 C# 并使用 Web 部署项目进行预编译，因此我通常只是自己移动构建，而不是在网络服务器上弄乱 SVN。使用 PHP 之类的解释型语言会更直接。

我在 Windows 上的 svn 客户端是 ToirtoiseSVN

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T13:38:58.143

你可以做一个[post-commit hook](http://svnbook.red-bean.com/en/1.1/ch05s02.html)，将 SVN EXPORT 服务器到部署路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T13:46:59.980

问题是 subversion 无法正常将文件存储在硬盘上。它使用数据库或虚拟文件系统来存储文件。这是对它们进行版本控制所必需的。完成这项工作的最简单方法是使用 subversion 命令行客户端并编写一个小批处理文件，该文件检查您的 subversion 存储库的头版本并将文件复制到您的 IIS 文件夹。您可以通过 cronjob 定期调用批处理文件。

# c# - C# 中的 BitArrays 有什么问题吗？

> ID：638524
> 
> 赞同：4
> 
> 时间：2009-03-12T13:03:05.343
> 
> 标签：c#, xor, bitarray

当我编译这段代码时：

```
BitArray bits = new BitArray(3);
bits[0] = true;
bits[1] = true; 
bits[2] = true;

BitArray moreBits = new BitArray(3);
bits[0] = true;
bits[1] = true;
bits[2] = true;

BitArray xorBits = bits.Xor(moreBits);

foreach (bool bit in xorBits)
{
Console.WriteLine(bit);
} 
```

我得到以下输出：

> > 真真真

当我通过说 true ^ true 对两个布尔值进行异或运算时，我得到了错误。

是不是代码有问题。我对 XOR 真值表的记忆是 True XOR True 是 false。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-12T13:06:04.430

复制粘贴错误。

```
BitArray moreBits = new BitArray(3);
bits[0] = true;
bits[1] = true;
bits[2] = true; 
```

那应该是：

```
BitArray moreBits = new BitArray(3);
moreBits[0] = true;
moreBits[1] = true;
moreBits[2] = true; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T13:13:37.737

您设置`bits`为`true`两次。您没有设置`moreBits`为`true`，所以它默认为 all- `false`。我责怪复制/粘贴！

编辑：在很短的时间内，我写了这个肯特回答并获得了 8 次投票！

# asp.net - 如何（如果有的话）使 ASP.NET UserControl 从另一个 UserControl 继承？

> ID：638525
> 
> 赞同：12
> 
> 时间：2009-03-12T13:03:43.623
> 
> 标签：asp.net, inheritance, user-controls

在 Windows 窗体中，很容易从一个用户控件继承另一个用户控件。继承的控件包含了父窗体的所有控件，还可以多加一些。可以用 ASP.NET 做同样的事情吗？我说的是 .ASCX 类型的用户控件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-12T13:16:02.830

简短的回答是不，它不*容易*做到。用户控件或网络表单之间没有继承关系。您可以在代码背后的类之间创建继承层次结构，但不会继承 gui 组件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T13:09:56.137

windows 窗体示例和 web 窗体示例之间的区别在于控件具有标记部分。我想这可以在某一天被克服，因为 Web 应用程序编译所有内容（至少在某些情况下），但今天并非如此。

但是，您可以将一个用户控件放在另一个用户控件上，令人作呕。它不会给您继承，但它确实允许您通过将原始控件和您需要添加到其中的内容组合在一起来使用其他控件来装饰特定控件。那可能解决你的问题？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T13:11:23.340

您当然可以在代码中继承基本用户控件并在代码中插入附加控件，如果您正在谈论在可视化设计器中构建，那么我不确定。我知道从 system.web 控件和用户控件创建复合控件，因此您的新控件没有理由不能包含另一个用户控件，并在其周围添加了其他控件。

# command-line - Sourcesafe 命令行选项

> ID：638540
> 
> 赞同：8
> 
> 时间：2009-03-12T13:06:15.320
> 
> 标签：command-line, visual-sourcesafe, default-value, prompt, suppression

我遇到了 Microsoft Visual Sourcesafe 命令行选项的问题，我希望有人遇到过并可以帮助我。

我在 DOS 批处理文件中有以下行。

```
"c:\Program Files\Microsoft Visual SourceSafe\ss.exe" GET 
    "$/Development Projects/Activity" -GL"C:\Compile\Activity" -R -Q 
    -Yname,password 
```

在批处理文件中执行此行时，会出现以下提示...

> 将 C:\Compile\Activity 设置为项目 $/Development Projects/Activity?(Y/N) 的默认文件夹

我需要禁止此提示，以便让脚本在无人值守的情况下运行。我认为 -Q 选项将允许静默运行，但它不会抑制此提示。

我已经搜索过，似乎找不到可以删除此提示的选项。我不想为项目设置默认文件夹，所以如果可能的话，我想将答案默认为“N”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-02-22T10:31:30.087

`-I-Y`对所有“是”或“否”问题回答“是”

[http://msdn.microsoft.com/en-us/library/028cya07%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/028cya07%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-12T16:08:29.067

我认为 Lieven 的回答可能是您的赢家，但如果不是，您可以尝试在命令中输入“N”来为您回答提示：

```
@echo n | "c:\Program Files\Microsoft Visual SourceSafe\ss.exe" GET 
    "$/Development Projects/Activity" -GL"C:\Compile\Activity" -R -Q 
    -Yname,password 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-12T13:41:55.077

斯科特，

这就是我们为日常构建获取最新版本的方式。

```
SET SSDIR="c:\Program Files\Microsoft Visual SourceSafe"
SET SSUSER=Name
SET SSPWD=Password

CD C:\Compile\Activity
SS CP "$/Development Projects/Activity"
SS Get *.* -I -Y -R -W 
```

我不完全确定 Get 是否`*.*`有效。我似乎记得有麻烦。我们的实际脚本会为我们需要的每个文件扩展名做一个获取，如

```
Get *.pas -I -Y -R -W
Get *.dfm -I -Y -R -W 
```

* * *

**编辑**：进一步集思广益，我会尝试

```
SS Get * -I -Y -R-W 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-25T13:39:04.537

以下将对所有提示回答否

-在

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-13T04:08:13.950

SourceSafe working folders are kept in the ss.ini text file located under the users subfolder of your SSDIR. You'll get prompted everytime you move to a new PC or login to SS as a new user to checkout files. To suppress this you should use the **SS Workfold project folder** command to explicity set your Working folder or prepopulate the ss.ini file with your Working folder preferences.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-23T16:46:25.833

您可以尝试以下方法。与`-GF`选项一起使用以使其能够获取命令行变量更改。也许它会与`-GF`. 不过不确定。

```
SET Force_Dir=YES

"c:\Program Files\Microsoft Visual SourceSafe\ss.exe" GET 
    "$/Development Projects/Activity" -GF -GL"C:\Compile\Activity" -R -Q 
    -Yname,password 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T13:13:22.370

我过去遇到过这种情况（老实说，感觉就像前世一样），也无法忍受。

我最终做的是编写一些 jscript 来创建 VSS 自动化对象，显式打开正确的数据库并执行各种必要的操作，从命令行使用 cscript 调用脚本。

我似乎记得有不同的 CheckOuts、CheckIns 和 Gets 脚本，尽管这可能是矫枉过正。

抱歉，我无法再提供帮助了，如果我手头有代码，我会在这里发布。

# sharepoint - 如何使用解决方案（wsp）将 resx 文件放在 App_GlobalResources 文件夹中？

> ID：638544
> 
> 赞同：3
> 
> 时间：2009-03-12T13:07:29.997
> 
> 标签：sharepoint, sharepoint-2007, resources, resx, wsp

我已经为 SharePoint 2007 制作了很多解决方案 (wsp)，并且我几乎自动化了所有需要的安装步骤，但有一件事我无法自动化。

如何制作将资源 (resx) 文件放置在虚拟应用程序的 App_GlobalResources 文件夹中的解决方案？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T14:41:36.743

您需要编写一个复制文件的功能接收器，因为无法通过 SharePoint 配置文件直接部署它们。

当我不得不这样做时，我发现这篇博文很有用：[SharePoint 资源、类型、使用和部署](http://www.mikhaildikov.com/2007/03/sharepoint-resources-types-use-and_2163.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T21:00:33.810

解决方案框架不支持部署到 App_GlobalResources 文件夹。

您需要编写一个复制文件的 SharePoint 计时器作业。timerjob 在场中的所有服务器上运行，因此每个服务器都会复制资源文件。您应该注意的是您运行 timerjob 的上下文（域帐户）。要启动 timerjob，您需要使用农场帐户 - 运行 Web 应用程序的帐户是不够的（这包括 RunWithElevated...） - 长话短说 - 从 af Farm 功能或隐藏的 SiteCollection 功能（隐藏功能作为农场帐户运行）。

在这里找到更多灵感：

[在 Windows SharePoint Services 3.0 中创建自定义计时器作业](http://msdn.microsoft.com/en-us/library/cc406686.aspx)

[SharePoint 资源、类型、使用和部署](http://www.mikhaildikov.com/2007/03/sharepoint-resources-types-use-and_2163.html)（DylanW 引用的链接）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-08T16:41:37.717

我通过右键单击项目并选择将 resx 文件添加到 App_GlobalResources 文件夹： - 添加新项目 - 名为“资源”的空元素 - 然后将新的 resx 文件添加到新创建的“资源”文件夹 - 然后在 resx 文件上将“部署类型”更改为“AppGlobalResource”

马特

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-06T14:47:30.880

您可以使用 stsadm 命令 CopyAppBinContent 将文件 frpm 12/Resources 复制到 App_GlobalResources。因此，您的 WSP（VS 项目）需要将您的 resx 文件放在该文件夹中。我正在使用一个解决方案，我实际上将我的 resx 文件放在 .csproj 根目录中名为 Resources 的文件夹中（只是为了避免将它们放在 12/Resources 中时出现的奇怪命名空间），然后 XCopy 它们（resx 文件）到12/我构建时的资源。

然后将 CopyAppBinContent 添加到部署过程（.bat 文件中的一个步骤）。

CopyAppBinContent 在场上运行时存在一些问题，为了解决这个问题，我使用了一个自定义 SPJobDefinition 来处理在场中启动该命令。

# c# - c# 访问二维数组的哈希表

> ID：638548
> 
> 赞同：1
> 
> 时间：2009-03-12T13:08:53.083
> 
> 标签：c#

我在 c# 中创建了一个二维数组的哈希表，但无法弄清楚如何直接访问数组值，以下是我当前的代码：

```
// create the hashtable
Hashtable hashLocOne = new Hashtable();

// add to the hashtable if we don't yet have this location
if (!hashLocOne.ContainsKey(strCurrentLocationId))
  hashLocOne.Add(strCurrentLocationId,new double[20, 2] { { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 } });

// add to the value at a given array position, this does not work
hashLocAll[strReportLocationId][iPNLLine, 0] += pnl_value; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T13:12:52.510

Hashtable 不知道里面存储了什么样的对象；你必须手动投射每一个：

```
double result = ((double[,]) table["foo"])[4][5]; 
```

如果可能，您应该使用 Dictionary 而不是 Hashtable：

```
var dict = new Dictionary<String, double[,]>();
double result = dict["foo"][4][5]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T13:11:06.493

```
((double[,])hashLocAll[strReportLocationId])[iPNLLine, 0] += pnl_value; 
```

你为什么不使用 Dictionary<string, double[,]> ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T13:16:08.713

所以，你有一个哈希表。您现在想要获取该信息。

看起来 hashLoc **All**应该是 hashLoc **One**。不过，我猜你是有原因的。

使用哈希表，里面的一切都是“对象”类型。这意味着你必须做很多铸造。

试试这个：

 `````
((double[,])hashLocOne[strReportLocationId])[iPNLLine, 0] += pnl_value; 
````  `* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-12T13:15:57.527

*   我没有在您的示例代码中`hashLocAll`或`strReportLocationId`在您的示例代码中看到任何定义。
*   您正在使用非通用字典。请改用通用字典。
*   您正在使用匈牙利符号的混蛋版本。不要那样做。去掉前缀`hash`, `str`,`i`等。它们在像 C# 这样的语言中完全没有必要，只会让你的代码更难阅读。

# scripting - 游戏脚本需要哪些语言功能？

> ID：638549
> 
> 赞同：5
> 
> 时间：2009-03-12T13:09:00.447
> 
> 标签：scripting, language-features, language-design

我正在研究设计一种游戏脚本语言，并且想知道游戏行业中雇用的人认为什么是好的游戏脚本语言的基本项目/属性。这包括以下内容：

*   静态与动态类型
*   它应该针对谁：程序员还是设计师？
*   语法（必须看起来像 C 吗？）
*   应该有多高？（例如 C vs Lisp——或者命令式 vs 函数式）
*   它必须能够做什么。它需要多快？

另外，我从一些消息来源听说脚本往往非常简单，因为它们是由设计师而不是程序员编写的。是这样吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T13:15:41.647

想了解一些实际用于在[Python](http://en.wikipedia.org/wiki/Python_(programming_language))和[Lua](http://en.wikipedia.org/wiki/Lua_(programming_language))等游戏中编写脚本的语言吗？

两者恰好都是动态类型的，而且在语法方面，Python 与 C 非常不相似，Lua 与 C 也不是非常相似。

可能将它们用于游戏脚本的原因是易于将该语言嵌入为脚本引擎（如果有的话）。如果要在设计语言时考虑到设计师，那么可能必须更改对语言的要求以适应设计师的需求，而不是让语言更容易集成到游戏中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T15:19:05.533

您似乎在问一个非常笼统的问题（如果您不知道脚本语言必须做什么，或者它需要多快）并期待具体的答案。

脚本语言的主要原因是允许人们在不破解源代码的情况下更改游戏。让我们一起去吧。

因此，它应该更多地针对设计师，因为他们不会破解源代码，而程序员会。它需要足够快才能正常运行游戏。它需要足够强大，让设计师可以放入他们将要放入的任何东西。（是的，这些都是模糊的答案，但你没有提供足够的信息来更具体。）

所以，忘记那些主要对程序员有用的特性，比如任何特定的语法模型或静态类型。设计人员不会对 C 语法一无所知，也不想担心静态类型或内存管理。

使用已经建立的语言有一些真正的优势。设计师可能对它有一些经验，它已经记录在案，并且已经为您完成了很多困难的工作。这包括语言设计：程序员不一定善于看到脚本语言的优点。

这暗示了 Lua 或 Python 之类的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T13:20:55.457

我理想的游戏脚本语言应该具有类似 Python 的语法，并且可以像 LUA 一样容易地嵌入到其他语言中。
此外，它应该能够嵌入到 XNA 中，目前（并且可能永远）缺少 LuaInterface 和嵌入式 IronPython 所依赖的反射特性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-10T03:13:26.483

这部分取决于哪个部门将负责编写大部分脚本。例如，如果关卡设计师正在编写大部分脚本，那么最好的语言类型将是更接近自然语言的语言，不需要陡峭的学习曲线。关卡设计师不一定想学习像 C/C++ 这样复杂的语法来播放声音。

伪语言可能看起来像这样（TES 构造集脚本是这样的）：

```
script MagicCaveDoorScript
    on UseAction
        if HasItem magicDoorKey
            PlaySound2D magicDoorOpen
            ChangeArea magicCave01
        else
            Message "You need the magic door key to enter..."
        end
    end
end 
```

但是，如果程序员是编写大量脚本的人，那么使用 Lua 或 Squirrel 等更复杂的语言来处理类、对象等可能会更加灵活和强大。

创建“更简单”的脚本语言的一个好处是，实现并不像更难的语言那么复杂，并且还允许您轻松开发工具以通过 GUI 创建脚本，例如从声音列表中选择播放，要附加的怪物物品列表等。

# java - 如何让 Java 在 Linux 中使用串口？

> ID：638553
> 
> 赞同：7
> 
> 时间：2009-03-12T13:10:18.540
> 
> 标签：java, linux, serial-port

我们使用一个通过串行端口管理 pinpad 的 java 应用程序。这在带有 Sun Comm.jar、提供的 dll 和属性文件的 Windows 上完美运行。

现在我们正在尝试在 Linux 上使用这个解决方案（实际上它确实可以在现场的各种其他风格的 linux 上运行） - 使用 Ubuntu 服务器模式。

经过多次尝试 - 鲜血，汗水和几乎眼泪，我们有这样的场景：

Java 版本 1.4.2_17 Linux - Ubuntu Comm libs - 由 sun 提供的 Comm3，并指定了默认驱动程序

外部通讯测试显示通讯端口：/dev/ttyS0 和 /dev/ttyS1 但 java 应用程序说无法打开端口 /dev/ttyS1

（使用 RXRT 文件会产生无效的端口错误）

有没有人能够在 linux 上使用 java 1.4.2 进行串口通信并找到我可以在我的场景中应用的解决方案？

非常感激

菲尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-24T21:28:01.987

我知道这是一个老问题，但我创建了一个 Java 包和本机库来允许串行端口读写，目前仅在同步模式下。

它是开源的，可在 GitHub 上找到：

[j232](https://github.com/jtkb/j232 "j232") - Java 源代码

[libj232](https://github.com/jtkb/libj232 "libj232") - j232 的原生库。

维基页面在[这里](https://github.com/jtkb/j232/wiki)。

请注意，这是一个仅限 Linux 的包和库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:58:49.807

确保您使用的是有权访问串行端口的用户。有些发行版将串行端口放在 uucp 组中，因此请确保用户属于该组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T13:21:13.660

自从我这样做以来已经有一段时间了。我记得您不能只将 /dev/ttyS0 作​​为文件打开并对其进行 I/O。

我记得 Sun IO jar 也有同样的问题。

我记得解决的解决方案是在 C 中创建一个小型命令行程序，它将 stdin 回显到串行端口，将串行端口回显到 stdout。然后，我从我的 java 进程中启动了这个程序。我没有代码，但是网上有很多关于写入 linux 串行端口的 c 程序的示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T15:11:46.407

几年来，我们一直在 Windows 和 Linux 上使用 SerialIO 库进行 Java 串行通信，并取得了很好的效果（不，我不为他们工作 :-)）：

[http://serialio.com/products/serialport/serialport.php](http://serialio.com/products/serialport/serialport.php)

但是，这些库不会自动检测 Linux 上的可用串行端口 - 您必须手动配置它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T13:54:36.277

我们没有改变太多，使用的库中没有任何变化。但是在串行端口对象上删除事件监听器的使用解决了这个问题。

这实际上允许我们的代码在 linux（jre1.4.2、slackware 和 Suns Comm3 驱动程序）上运行，而这在 windows 上不是问题 - 奇怪。

菲尔

# formatting - 格式化代码的正确方法是什么？

> ID：638561
> 
> 赞同：19
> 
> 时间：2009-03-12T13:12:27.333
> 
> 标签：formatting

当我编写代码时，我尝试将相似的代码行组合在一起，然后留下一个空白行并编写另一个代码块。

我相信这有助于代码的整洁和可读性。

我不喜欢在没有任何行距的情况下将东西捆绑在一起。它看起来像地狱，很难阅读，也很难理解。

我的一位老师降级了我的一项作业，因为我在逻辑上间隔了我的代码。他说，“当你必须在现实世界中整天阅读代码时，你不会输入这个行距，你会感谢我的。”当然，我从来没有也永远不会感谢他。

现在我在现实世界中，我看到的大多数绝对没有行距的代码文件都写得不好，而且考虑不周。

这在 VB 类型语言中可能比在 C 类型语言中更普遍，但同样的概念也适用。

想到两个问题：

*   您在代码中的哪个位置留空行？
*   多少行距才算太多？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-12T13:15:08.747

我遵循[Microsoft 的 C# 指南](http://blogs.msdn.com/brada/articles/361363.aspx)。

**编辑**：[C# 的标准](http://www.irritatedvowel.com/Programming/Standards.aspx)是**不要与 IDE 对抗**。如果您点击`CTRL K+D`，IDE 将自动在代码段之间放置空行。

为了跟进这一点，如果您查看[MSDN](http://www.msdn.com)或[其他任何地方](http://codeplex.com)的 C# 示例代码，通常在每个逻辑放置的组之间都有一个空行。所以你的所有成员变量后面会有一个空行，每个方法后面都有一个空行，等等。

为了回应表达我使用 IDE 进行 C# 编程的震惊和恐惧的评论：

* * *

## 真正的程序员

[![](https://imgs.xkcd.com/comics/real_programmers.png "真正的程序员使用 VIM")](http://xkcd.com/378/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-12T13:15:12.693

我想我会做类似的事情，但没有硬性规定。我喜欢将代码分隔在分组/相关逻辑的“段落”中。

没有额外行空间的代码读起来很糟糕。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-12T13:23:03.517

听起来我的代码行与您类似。

但这是无关紧要的个人偏好，每个人都会有自己的“正确方法”来做这件事。恕我直言，最重要的是适应您要进入**的环境的风格。**

此外，你会在“现实世界”中找到这样的代码……但听起来你有更高的抱负。;-)

编辑：......不是比“现实世界”更高的抱负，而是高于“现实世界”中常见的平庸废话。...但是，如果您碰巧有比“现实世界”更高的抱负，您可能希望看到专业人士。;-)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-12T13:21:32.117

我的经验法则是：

> 在可以用一条注释描述的代码块之间放置一个空行。

但总的来说，我同意许多具有大量空白的大型函数应该分解为更小的函数。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-12T13:15:48.463

由于我们没有您个人对“逻辑”行距的想法的示例，因此我们无法真正说明您是否应该被降级。

我倾向于在间隔之前将类似的语句或步骤按顺序组合在一起（例如变量声明、循环等）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T13:23:26.323

基本上和其他人说的一样。COBOL 对什么是句子和段落有非常明确的规则。我想，在我的脑海里，我遵循那些。如果你有一个大的 IF 语句，你没有在嵌套的最后放置一个句点。同样，我在最后一个 } // end if 之后放了一个空行

是的，我把 // end if, // end for, // end 方法的东西放在那里。我认识的一些更直言不讳的人不喜欢它，但我喜欢它。他们说你不应该让你的 if 语句变得很大，如果你**需要**// end if 东西，你可能编码错误，我不需要**它**，但我确实发现它更容易阅读。叫我老式的，强迫症，随便。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-12T13:15:24.877

垂直空间通常比水平空间更重要，因此**过大的间距**通常不是一个好主意。我确实认为用一个**空行在**逻辑上分隔代码块是个好主意。

听起来你的老师大多是个混蛋。俗话说“能者行，行者行，不能者~~上 StackOverflow~~教”。;)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-12T13:16:18.587

我使用与您非常相似的行距。我在现实世界中发现的代码往往布局相似，或者至少不会聚集在一起以至于无法阅读。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-12T13:23:59.770

除非您对垂直间距感到疯狂，否则我认为分离代码没有问题。我知道人们喜欢折腾使用小方法的想法，但是即使您的方法只做一件事情，那件事情也可能需要大量代码才能完成。并非所有事情都可以在一屏代码中完成。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-12T13:36:11.457

您的老师可能在现实世界中没有行距的观点是正确的。当然，在 Big Ball of Mud 代码库中，如果你得到一个行空间，更不用说解释注释，我会很幸运。

顺便说一句，编写这个 Big Ball of Mud 的大部分内容的 73 岁程序员仍在那里工作，他的解释是二进制文件需要保持尽可能小，我没有费心去检查 20 到30 年前效率低下，他们无法去除空格，但我有点怀疑。

我使用单个空行来分解我自己代码中的逻辑部分，因为我发现它大大提高了可读性。

与往常一样，对这类可读性问题的最佳测试是抓取一些您编写的并且一年多没有查看的棘手代码，看看您是否可以快速掌握它。如果可以，那么您的代码将比您在现实世界中看到的大多数代码更好！

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-12T14:02:46.930

我将代码视为一篇文章。你有没有试过阅读两页没有段落或行距的文章？

我同意你的观点，逻辑组之间没有行间距简直太疯狂了。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-03-12T14:14:27.700

> 我的一位老师降级了我的一项作业，因为我在逻辑上间隔了我的代码。他说，‘当你必须在现实世界中整天阅读代码时，你不会有这种行距，你会感谢我的。

除非你用 5 行或 10 行空格分隔块（这会让任何人发疯），否则你的导师就是个混蛋。

编码标准并不是一成不变的，而且对于所有软件商店来说，它们当然也不一样。所有公司都有不同的编码标准。对于它的价值，我公司的一些编码标准明确指出“使用单个空行在视觉上分离逻辑相关的代码块”。

虽然我们应该努力不写 200 行长的方法，但我们所有的短方法包含多个控制流元素仍然很常见，我们应该理解垂直空格在可读性方面与水平空格一样重要。即使在同一方法中的 for 循环和 if 语句之间放置一个空行，也可以满足“单一方法，单一目的”的原则。

* * *

[编辑添加] 还有一些评论：

1）这个线程中的几个人假设OP正在编写200行方法，或者在添加空行和编写草率方法之间存在必要的关联，这是非常冒昧的。

2）不管它的价值是什么，而 OP 的教练假设*他的*编码标准在任何地方都是相同的，这是完全错误的。但是，您应该将编程课程视为拥有自己标准的小型软件商店，因此您的代码应该以遵循这些标准的方式编写。

如果您的讲师根据您的代码是否符合编码标准对您进行评分，那么请坚持获取标准列表。我知道*我的*成绩是否因为不符合教师从未给过我的标准而被扣分（或者如果他的标准说“为其数据类型添加前缀变量”），头脑会滚动。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-12T17:04:30.930

我一直在编写一些相反方向的代码；每个语句与下一个语句由一个空行分隔。作者还喜欢使用在第 60 列右对齐的四行注释，而不是在代码级别缩进的一行注释。它很难阅读，而且修复起来也很乏味。代码的另一个特性（C 代码），前一个 case 的 break 被“附加”到下一个 case，但是 case 后面有一个空行，将它与它的代码分开。哎呀！

代码块周围的空行很好。在一个函数中没有太多的代码块是好的。每行代码周围的空行令人不快。一件好事太多或太少都是一件坏事。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-03-12T13:15:26.530

我们有一个编码标准，规定我们不应在一行中放置多个空行。其他的都取决于开发商。在实践中，我们按照您说的做 - 尝试将逻辑连接的线分组并用空行隔离它们。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-12T13:19:12.713

使用很少的方法，以获得较低的[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)。方法的高圈复杂度一般意味着你的方法必须分成几个其他的子方法，这样会更容易阅读，也更容易测试！

我认为您的代码正面临这种问题。

一般100+行的方法太大太复杂，必须重构。

总而言之，不要用行空间破坏代码，而是将其分解为单独的方法......

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-03-12T13:47:22.397

空格有助于使您的代码更具可读性，我认为这里的共识是它们在很大程度上不是一个坏主意。但似乎没有人指出，与空行一起，注释可能不会出错。

```
/* This section preps the widgets for display */
block 
of some 
code

/* This section passes the widgets to the display handler */
and 
so 
on 
```

请记住，大多数代码将在其生命周期中被多次阅读，因此您可以做的任何事情来让未来的维护者的生活更轻松是一个很好的加分项。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-03-12T14:02:22.627

1）我同意你的行距

2）在我的办公室里，行距很短，因为“这样你可以在一页上看到更多的代码”。他们还将多个语句放在一行上，并且（恕我直言）使用 ?:... 我讨厌它。

3）我不同意“这就是他是老师的原因”这句话。作为一名（前）老师，我不得不说，在我取消放置空间的分数之前，我会因为没有在部分之间放置空间而降级。我想我也没有。我的观点是，他是个混蛋与他是个老师是正交的。（编辑：该部分已从原件中编辑，但我将其留在这里以维持 3 的规则......）

不要诋毁老师！

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-09-15T14:37:40.293

我知道这是一个老问题，但我在寻找其他东西时绊倒了它，并有一个观察结果：看看现有的答案。它们通常很短，但它们包含空白行。

这就是段落。就像在写作中一样，线条是一种快速、直观的方式来分离概念。这并不意味着上面的每一段都应该分成一个单独的答案；这并不意味着每个代码“段落”都应该分成一个单独的方法。

这是一个愚蠢的抱怨。如果仍然可以与那位教授交谈，我会解释“文字墙”的含义。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-12T13:15:00.370

在我看来，在你的代码中添加一个空格暗示你应该将你的函数拆分成更小的部分。通过添加空格来清理代码比一英里长的未分隔行列表更可取。通过分离出较小的函数来清理代码会更好。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-03-12T17:26:48.270

我不会开始建议任何细节。这里和互联网上的其他地方有很多很好的建议。

但我会说是一致的。至少在应用程序或模块中——因为我知道我会不时改进我的方法，但我会尽量让所有代码在同一个地方看起来一样。

如果您始终如一，任何其他开发人员都可以轻松选择您的节奏和风格。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-03-12T17:34:21.590

听起来并不自命不凡，但我认为代码中的空行与乐谱中的短语标记或诗歌中的换行符具有相似的功能：它们在不改变内容语义的情况下向读者传达意图。

这是我刚刚从项目中复制和粘贴的方法：

```
public static void Startup(bool startupUser)
{
    URI = "";
    AutoComplete = new AutoCompleteWrapper();
    SessionToken = Guid.Empty;
    ExternalDataSetLock = new object();

    ConfigDS.Init();
    CalendarDS.Init();
    CalendarDSBuilder.Init();

    if (startupUser && UserName != null)
    {
        string autoCompleteFilename = Path.Combine(UserFolder, "autocomplete.xml");
        AutoComplete.Load(autoCompleteFilename);
    }
} 
```

这里的空行是做什么的？他们阐明了在这种方法中基本上发生了三种不同类型的初始化。如果我添加一个需要在启动时初始化的新属性，我知道我将把初始化它的行放在哪里。空白行还暗示了如果它的大小翻倍，我打算如何重构这个函数。

使用空行的风险与任何其他类型的隐含含义的风险相同：它是隐含的。您在编写代码时所暗示的含义可能不是阅读代码的人所理解的含义。

但是怜悯，这不是不使用它们的理由。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-03-12T13:16:06.560

我已经开始遵循此处找到的 Microsoft 设计指南：

[类库开发人员的设计指南](http://msdn.microsoft.com/en-us/library/czefa0ke(VS.71).aspx "类库开发人员的设计指南")

# regex - 合理地解析科学记数法？

> ID：638565
> 
> 赞同：46
> 
> 时间：2009-03-12T13:13:03.523
> 
> 标签：regex, parsing, scientific-notation

我希望能够编写一个函数，它接收科学计数法中的数字作为字符串，并将系数和指数拆分为单独的项目。我可以只使用正则表达式，但传入的数字可能没有被规范化，我希望能够规范化然后将部分分解。

一位同事使用 VB6 获得了解决方案的一部分，但它并不完全存在，如下面的成绩单所示。

```
cliVe> a = 1e6
cliVe> ? "coeff: " & o.spt(a) & " exponent: " & o.ept(a)
coeff: 10 exponent: 5 
```

*应该是 1 和 6*

```
cliVe> a = 1.1e6
cliVe> ? "coeff: " & o.spt(a) & " exponent: " & o.ept(a)
coeff: 1.1 exponent: 6 
```

*正确的*

```
cliVe> a = 123345.6e-7
cliVe> ? "coeff: " & o.spt(a) & " exponent: " & o.ept(a)
coeff: 1.233456 exponent: -2 
```

*正确的*

```
cliVe> a = -123345.6e-7
cliVe> ? "coeff: " & o.spt(a) & " exponent: " & o.ept(a)
coeff: 1.233456 exponent: -2 
```

*应该是 -1.233456 和 -2*

```
cliVe> a = -123345.6e+7
cliVe> ? "coeff: " & o.spt(a) & " exponent: " & o.ept(a)
coeff: 1.233456 exponent: 12 
```

*正确的*

有任何想法吗？顺便说一下，Clive 是一个基于 VBScript 的 CLI，可以在我的[博客](http://codeaholic.blogspot.com)上找到。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-18T15:07:23.457

谷歌上的[“科学记数法正则表达式”](http://www.google.com/search?q=scientific+notation+regexp)显示了许多匹配项，包括[这个](http://www.regular-expressions.info/floatingpoint.html)（**不要使用它！！！！**）它使用

```
*** warning: questionable ***
/[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/ 
```

其中包括诸如 -.5e7 和 +00000e33 之类的情况（您可能不想允许这两种情况）。

相反，我**强烈**建议您使用 Doug Crockford 的[JSON 网站](http://www.json.org/)上的语法，该网站明确记录了 JSON 中数字的构成。这是从该页面获取的相应语法图：

[![替代文字](https://i.stack.imgur.com/IBQke.gif)](https://i.stack.imgur.com/IBQke.gif)
[（来源：[json.org](http://www.json.org/number.gif)）]

如果您查看他的[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)脚本的第 456 行（在 javascript 中与 JSON 的安全转换），您将看到正则表达式的这一部分：

```
/-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/ 
```

具有讽刺意味的是，这与他的语法图不匹配....（看起来我应该提交一个错误）我相信实现该语法图的正则表达式是这个：

```
/-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+\-]?\d+)?/ 
```

如果你也想允许一个初始 + ，你会得到：

```
/[+\-]?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+\-]?\d+)?/ 
```

根据自己的喜好添加捕获括号。

我还强烈建议您充实一堆测试用例，以确保包含您想要包含（或不包含）的那些可能性，例如：

```
allowed:
+3
3.2e23
-4.70e+9
-.2E-4
-7.6603

not allowed:
+0003   (leading zeros)
37.e88  (dot before the e) 
```

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-10T16:25:43.423

基于评分最高的答案，我将正则表达式稍微修改为`/^[+\-]?(?=.)(?:0|[1-9]\d*)?(?:\.\d*)?(?:\d[eE][+\-]?\d+)?$/`.

这提供的好处是：

1.  允许匹配数字，例如`.9`（我用 做了`(?:0|[1-9]\d*)`可选`?`）
2.  防止仅匹配开头的运算符并防止匹配零长度字符串（使用前瞻，`(?=.)`）
3.  防止匹配`e9`，因为它需要`\d`在科学记数法之前

我的目标是用它来捕捉重要的数字和做重要的数学。所以我也打算用这样的捕获组来分割它：`/^[+\-]?(?=.)(0|[1-9]\d*)?(\.\d*)?(?:(\d)[eE][+\-]?\d+)?$/`.

关于如何从中获得有效数字的解释：

1.  整个捕获是您可以交给的号码`parseFloat()`
2.  匹配项 1-3 将显示为未定义或字符串，因此将它们组合起来（将`undefined`'s替换为`''`）应该给出可以从中提取有效数字的原始数字。

这个正则表达式还可以防止匹配左填充零，JavaScript 有时会接受，但我已经看到它会导致问题并且不会对有效数字添加任何内容，因此我认为防止左填充零是一个好处（尤其是在表单中）。但是，我确信可以修改正则表达式以吞噬左填充的零。

我看到这个正则表达式的另一个问题是它不匹配`90.e9`或其他这样的数字。但是，我发现这种匹配或类似匹配极不可能，因为科学记数法中的惯例是避免此类数字。尽管您可以在 JavaScript 中输入它，但您也可以轻松输入`9.0e10`并获得相同的有效数字。

**更新**

在我的测试中，我还发现了它可以匹配的错误`'.'`。因此，应该将前瞻修改为`(?=\.\d|\d)`最终的正则表达式：

```
/^[+\-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:\d[eE][+\-]?\d+)?$/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T04:01:56.240

这是我刚刚快速编写的一些 Perl 代码。

```
my($sign,$coeffl,$coeffr,$exp) = $str =~ /^\s*([-+])?(\d+)(\.\d*)?e([-+]?\d+)\s*$/;

my $shift = length $coeffl;
$shift = 0 if $shift == 1;

my $coeff =
  substr( $coeffl, 0, 1 );

if( $shift || $coeffr ){
  $coeff .=
    '.'.
    substr( $coeffl, 1 );
}

$coeff .= substr( $coeffr, 1 ) if $coeffr;

$coeff = $sign . $coeff if $sign;

$exp += $shift;

say "coeff: $coeff exponent: $exp"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-02-17T18:38:23.143

在@Troy Weber 的基础上，我建议

```
/^[+\-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d+)?(?:(?<=\d)(?:[eE][+\-]?\d+))?$/ 
```

为避免匹配`3.`，根据@Jason S 的规则

# php - 如何使用 PHP 获取远程系统文件？

> ID：638585
> 
> 赞同：0
> 
> 时间：2009-03-12T13:16:42.267
> 
> 标签：php, javascript

我正在做一个项目，我想从通过 LAN 连接的远程系统访问文件夹。

从那我有一个下拉列表。当我选择远程系统驱动器号（例如：c:、d:）时，该文件夹中的相应文件将显示在我的系统中。

有这方面的教程吗？

我已经尝试过了，但它仅适用于本地系统，而且我无法打开相应的文件。

```
<html>
    <head>
        <title>Drive contents</title>
    </head>
    <body>
    </body>
    <?php // Php starts here
    $myDirectory = opendir("C:\Dream");
    $path = "c:";
    // get each entry
    while($entryName = readdir($myDirectory)) {
        $dirArray[] = $entryName;
    }
    // close directory
    closedir($myDirectory);

    //    count elements in array
    $indexCount = count($dirArray);
    Print ("$indexCount files<br>\n");

    // sort 'em
    sort($dirArray);
    // print 'em
    // loop through the array of files and print them all
    for($index=0; $index < $indexCount; $index++) {
        if (substr("$dirArray[$index]", 0, 1) != "."){ // don't list hidden files
            print("<a href=\"$dirArray[$index]\">$dirArray[$index]</a>");
            echo "<br>";
        }
    }
?>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T05:10:04.390

您的 PHP 脚本在哪里运行？只是为了更好地理解，你的脚本在哪里？脚本是在与远程文件相同的机器上运行还是脚本在不同的位置？

无论如何，对于这两种情况，您应该首先检查 php safe_mode 指令是打开还是关闭，以及 open_basedir 指令的值，因为它们会阻止您访问某些目录。

但是如果脚本在不同的服务器中，您还应该检查远程服务器目录的权限，并验证 php.ini 中的 allow_url_fopen 指令是否设置为“On”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T23:06:39.037

而不是`http://`前缀，请尝试`file:///`在您的`<a href=...`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T13:45:38.533

看[php流函数](http://ru2.php.net/manual/en/book.stream.php)和函数[glob](http://ru2.php.net/manual/en/function.glob.php)

```
$myDirectory = opendir("Y:\\logs"); 
```

流函数可以打开远程目录

```
\\smbserver\share\path\to\winfile.ext 
```

# wix - 自动化 wix 小更新和小升级

> ID：638586
> 
> 赞同：9
> 
> 时间：2009-03-12T13:16:58.100
> 
> 标签：wix

我刚刚在[wix 教程](http://wix.tramontana.co.hu/tutorial/upgrades-and-modularization/checking-for-oldies)中阅读了以下内容。

> 出于某种奇怪的原因，不能简单地通过单击 .msi 文件来运行小更新和小升级——它们会给出错误：“已安装此产品的另一个版本。” 我们知道，愚蠢...无论如何，您必须使用以下命令启动它：
> 
> msiexec /i SampleUpgrade2.msi REINSTALL=ALL REINSTALLMODE=vomus
> 
> 不要问我这对普通用户会有什么影响……您最好从 Autorun.inf 文件启动它，或者设计一个外部 Setup.exe 外壳来启动它。

我们希望人们能够下载并安装我们应用的最新版本，即使他们已经安装了旧版本。您通常如何处理这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T22:42:46.497

一个词：引导者。WiX 工具集现在有一个简单的引导程序（John Robbin 有一篇很好的关于[setupbld.exe](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/02/27/creating-a-bootstrap-loader-with-wix-3-0.aspx)的文章）。未来，Burn 会这样做，甚至更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T01:41:18.057

我很惊讶 Rob 的回答与他对我的问题的回答不同，因为这基本上是同一个问题：

[WiX——总是覆盖以前的版本](https://stackoverflow.com/questions/775259/wix-always-overwrite-the-previous-version)

# asp.net - 使用 asp.net 资源文件时出错

> ID：638588
> 
> 赞同：0
> 
> 时间：2009-03-12T13:17:21.453
> 
> 标签：asp.net, resource-files

我有一些文本内容，我希望能够在不重新编译我的项目的情况下进行更改。我创建了一个资源文件并在其中放入了一些文本内容。

我的印象是我可以写 <%$ Resources:mapLink2 %> 任何我想要的地方，但似乎并非如此。

我的 ascx 中的以下代码给了我一个错误：

```
<a href="<%$ Resources:mapLink2 %>"><img class="2 selectableImg" src="map_2.gif" /></a> 
```

我只收到瑞典语的错误消息（对此感到抱歉），但我认为它可能会给你一些关于正在发生的事情的提示：

*Literala uttryck som "" är inte tillåtna。Använd 我 stället。vid System.Web.UI.TemplateParser.ProcessError(String message) vid System.Web.UI.TemplateParser.ParseStringInternal(String text, Encoding fileEncoding) vid System.Web.UI.TemplateParser.ParseString(String text, VirtualPath virtualPath, Encoding fileEncoding )*

但如果我这样做：

```
<a href='<asp:literal runat="server" Text="<%$ Resources:mapLink2 %>"/>'><img class="2 selectableImg" src="map_2.gif" /></a> 
```

一切正常。

第一个版本怎么不行？资源文件不应该像我希望它们在示例 1 中那样工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T13:21:56.640

也许这只适用于服务器控件？您是否尝试过在第一个示例中的 a 上设置 runat="server" ？

# version-control - 我应该在源代码管理中保留待办事项列表吗？

> ID：638599
> 
> 赞同：5
> 
> 时间：2009-03-12T13:20:33.850
> 
> 标签：version-control

我在找出存储我的编程待办事项列表的最佳方式时遇到了一些麻烦。

我考虑以下几点：

*   每个项目的源代码管理中的一个待办事项列表
*   源代码管理中个人文件夹中的主待办事项列表（带有一般任务）

你怎么找到的？

你有什么建议？

编辑：

感谢您的建议。我使用错误跟踪系统 (BugTracker.NET) 来处理错误和涉及来自其他人的请求的任务，以便他们可以看到状态。我在代码中使用 //TODO。

我有很多关于该做什么的附加说明。您是否建议也将其放入错误跟踪器中（特别是如果无法将它们作为 //TODO 放入代码中）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-12T13:21:47.560

为什么不使用错误跟踪系统？

示例： [Bugzilla](http://www.bugzilla.org/) [Mantis](http://www.mantisbt.org/) [Trac](http://trac.edgewall.org/)

和许多其他人......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T13:26:54.990

您应该将待办事项保存在代码中。最好与错误跟踪程序链接。然后你应该使用一个文档生成程序来捕获所有待办事项并将它们写入一个列表，其中包含指向代码相关部分的链接。

一个很好的例子是 Doxygen。给定代码中的待办事项：

```
// TODO: fix potential non-assigment of var
int my_var; 
```

Doxygen 将能够提取此信息（您甚至可以为任意注释设置过滤器，例如 FIXME BUG LOOK_HERE 等）并且 a) 为特定的类/接口留下一个 todo 条目 b) 为完整的项目。

此外，您的待办事项和待办事项列表将受到版本控制，并且列表（即文档）很容易从头开始生成。

因此，总而言之：[Doxygen](http://www.doxygen.org/)、scm 系统（[任何](http://subversion.tigris.org/)都可以）和[bugzilla](http://www.bugzilla.org/)的组合将使您立即启动并运行。

**更新**：查看[这个 git 钩子](https://github.com/naholyr/github-todos)，它在你的签入中从 TODO 中创建 Github 问题

关于在代码中使用 TODO 是否是一件好事（TM）这个问题的一般说明：使用工具的傻瓜仍然是傻瓜。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T13:23:41.503

错误跟踪系统是开发的重要工具。

您还可以拥有一个简单的基于 Web 的待办事项列表，例如[RtM](http://www.rememberthemilk.com)。

最后，您还可以`// TODO`在代码中使用“书签”，因为 IDE 提供了轻松定位它们的功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T13:27:28.140

我在编码时通常会想到 TODO 项目。通常，为了不打断我的思路，我会快速添加 // TODO: 注释，快速描述我的想法，然后继续编码。

重要的是不要忘记需要做某事的事实！

稍后，我将返回并在我的问题跟踪软件中创建一个票证。您正在使用问题跟踪软件不是吗？:) 之后，可以从代码中删除 TODO。

尝试使用一致的注释标签，以便您以后可以轻松地对它们进行 grep（文本搜索）。

许多开发环境识别特定标签并协助查找和管理它们。

不要害怕将它们放入代码中，并且尽量不要维护单个 TODO 的两个不同副本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T13:23:21.970

我会使用[http://rememberthemilk.com](http://rememberthemilk.com)或[http://basecamphq.com](http://basecamphq.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T13:38:22.013

如果您使用 TFS，您可以使用工作项来表示待办事项列表项。它们可以分配给人员、与签到相关联、附加详细信息等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T20:55:19.627

是的，如果您没有问题跟踪系统。确保它是纯文本格式（换行符分隔的问题），以便每个人都可以同时编辑-提交-合并文件。

否则只需获取问题跟踪器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T13:22:27.573

您应该在源代码管理中保留任何被修改的文本。这不包括生成的代码（除非您有一个无法在构建过程中运行的糟糕生成器）和所有二进制文件，但二进制依赖项除外。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T13:24:12.267

我使用 OnTime2008，它有一个免费的单一开发者（最多 5 个客户端）版本来跟踪我的开发项目。Bugzilla 将是另一种好方法。不确定我是否要跟踪我的“待办事项”列表中的更改，因为我永远不需要回溯这些更改，我希望记录所有活动，全部！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T13:27:34.533

1.  每个项目的源代码管理中都有一个待办事项列表。稍加注意，这将成为您的[Scrum 燃尽](http://www.controlchaos.com/about/burndown.php)数据。一点点剪切和粘贴就可以创建一个供管理层使用的图表。

2.  代码中的显式 TODO 注释——这些*应该*与待办事项列表匹配。定期手动同步和确定优先级很重要。

3.  用于错误跟踪的 Bugzilla（不同于前瞻性的待办事项）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T13:52:41.400

我爱[大本营总部](http://basecamphq.com/ "大本营总部")

你可以从那里控制很多关于项目管理的事情。

我会推荐那个网站。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-02T13:07:48.907

在 Eclipse (for Java) 中，有一个很好的视图可以让你管理你的 TODOS：

*   查看所有这些，无论他们在什么（开放）项目上
*   为他们设置三个优先级
*   使用多个关键字，对您的团队意味着不同的事情（例如，FIXME 可能是高优先级的紧急事件，EXTEND 可能是未来扩展低优先级的可能性等。）

# security - 关于 WSE3 中断言策略的好资源

> ID：638621
> 
> 赞同：0
> 
> 时间：2009-03-12T13:26:00.577
> 
> 标签：security, .net-3.5, wse3.0

我在哪里可以找到关于 WSE3 中断言策略的好资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T13:35:22.660

你的意思是WSE还是WCF？我注意到您标记了问题“.net3.5”，它暗示了 wcf。

WSE3，OTOH，是一个基于 .NET 2.0 ASMX 技术的过时框架，它本身几乎已经过时。

这并没有反映您的问题：如果您别无选择，只能使用 WSE，那么您别无选择。只是想澄清您要问的是什么（并确保您知道 WSE 已过时；并非每个使用它的人都知道这一点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T13:39:49.827

我是这个领域的初学者。我正在尝试将此代码作为练习来实现。我想创建一个将在肥皂消息到达时运行的肥皂过滤器。我在使用策略 XML 时遇到问题

```
using Microsoft.Web.Services3;
using Microsoft.Web.Services3.Design;

namespace WebService1
{
    /// <summary>
    /// Summary description for Service1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [ToolboxItem(false)]
    public class Service1 : System.Web.Services.WebService
    {

    [WebMethod]
    public string HelloWorld(string s)
    {
        return "Hello World" +s ;
    }
}

public class ValidationFilter : SoapFilter
{
    string authCode;

    public ValidationFilter(string authCode)
    {
        this.authCode = authCode;
    }

    public override SoapFilterResult ProcessMessage(
        SoapEnvelope envelope)
    {
        XmlReaderSettings settings = new XmlReaderSettings();

        XmlElement elmRoot = envelope.DocumentElement;
        XmlElement elmNew = envelope.CreateElement("title1234");
        elmNew.InnerXml = "blablabla";
        elmRoot.AppendChild(elmNew);

        return SoapFilterResult.Continue;
    }
}

public class traceAssertion : PolicyAssertion
{
    public static readonly XmlQualifiedName BeNiceQName = new
        XmlQualifiedName("traceAssertion", "http://schemas.cohowinery.com/wsbn");

    public override SoapFilter CreateClientInputFilter(FilterCreationContext context)
    {
        return new ValidationFilter("FFFF");
    }

    public override SoapFilter CreateClientOutputFilter(FilterCreationContext context)
    {
        return new ValidationFilter("FFFF");
    }

    public override SoapFilter CreateServiceInputFilter(FilterCreationContext context)
    {
        return new ValidationFilter("FFFF");
    }

    public override SoapFilter CreateServiceOutputFilter(FilterCreationContext context)
    {
        return new ValidationFilter("FFFF");
    }

} 
```

}

# php - 在 Zend Framework 中对具有多个表关系的对象进行建模

> ID：638622
> 
> 赞同：20
> 
> 时间：2009-03-12T13:26:37.843
> 
> 标签：php, zend-framework, model

我正在玩弄 Zend 框架并尝试对我正在制作的网站使用“快速入门”指南，以了解该过程如何工作。如果这个答案很明显，请原谅我，希望有经验的人可以对此有所了解。

我有三个数据库表：

```
CREATE TABLE `users` (
  `id` int(11) NOT NULL auto_increment,
  `email` varchar(255) NOT NULL,
  `username` varchar(255) NOT NULL default '',
  `first` varchar(128) NOT NULL default '',
  `last` varchar(128) NOT NULL default '',
  `gender` enum('M','F') default NULL,
  `birthyear` year(4) default NULL,
  `postal` varchar(16) default NULL,
  `auth_method` enum('Default','OpenID','Facebook','Disabled') NOT NULL default 'Default',
  PRIMARY KEY  (`id`),
  UNIQUE KEY `email` (`email`),
  UNIQUE KEY `username` (`username`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1

CREATE TABLE `user_password` (
  `user_id` int(11) NOT NULL,
  `password` varchar(16) NOT NULL default '',
  PRIMARY KEY  (`user_id`),
  UNIQUE KEY `user_id` (`user_id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1

CREATE TABLE `user_metadata` (
  `user_id` int(11) NOT NULL default '0',
  `signup_date` datetime default NULL,
  `signup_ip` varchar(15) default NULL,
  `last_login_date` datetime default NULL,
  `last_login_ip` varchar(15) default NULL,
  PRIMARY KEY  (`user_id`),
  UNIQUE KEY `user_id` (`user_id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

我想创建一个在某些情况下使用所有三个表的用户模型。例如，如果/当需要元数据时访问元数据表。只有设置了“默认”auth_method，才能访问 user_password 表。稍后我可能会添加一个我希望能够从用户模型访问的配置文件表。

采埃孚最好的方法是什么？为什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-12T21:53:45.570

```
class Users extends Zend_Db_Table_Abstract
{
    protected $_name = 'users';
    protected $_rowClass = 'User';
    protected $_dependentTables = array ('UserMetadata', 'UserPassword');

...

class UserMetadata extends Zend_Db_Table_Abstract
{
    protected $_name = 'user_metadata';
    protected $_referenceMap = array (
    'Users'=> array (
    'columns'=>'user_id',
    'refTableClass'=>'Users',
    'refColumns'=>'id'
    )
    );

...

class UserPassword extends Zend_Db_Table_Abstract
{
    protected $_name = 'user_password';
    protected $_referenceMap = array (
    'Users'=> array (
    'columns'=>'user_id',
    'refTableClass'=>'Users',
    'refColumns'=>'id'
    )
    ); 
```

获取数据：

```
$id = //get your user id from somewhere

$users = new Users();
$user = $users->fetchRow('id=?', $id);
if ($user->authMethod == 0)
{
    $metadata = $user->findDependentRowset('UserMetadata')->current();
} 
```

或者

```
$user = $users->fetchRow($users->select()
              ->where('gender=?, 'M')
              ->order('email ASC'); 
```

... ETC。

插入数据：

```
$newRow = $users->fetchNew();
$newRow->email = me@domain.com;
$newRow->save(); 
```

或者

```
$users = new Users();
$data = array('email'     => 'me@domain.com',
              'firstname' => 'Me');
$users->insert($data); 
```

更新：

```
$user->email = 'me@domain.org';
$user->save(); 
```

删除一行：

```
$user->delete(); 
```

使用事务：

```
$db->beginTransaction();
$db->commit();
$db->rollback(); 
```

等等……都在[ZF 手册](http://framework.zend.com/manual/en/)中！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T13:37:09.987

基本上而不是`Zend_Db_Table`使用更通用的`Zend_Db_Select`或`Zend_Db_Statement`检索数据。

顺便提一句。您可能希望不直接在 User 模型中访问密码数据，而是在派生自`Zend_Auth_Adapter`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T21:36:10.853

简而言之，我将为每个表创建一个模型，而不是一个访问所有三个表的模型。然后我会[定义](http://framework.zend.com/manual/en/zend.db.table.relationships.html)表之间的关系。

老实说，必须为每个表创建一个模型似乎不是很“干”，但这是我在网上的各种示例中反复看到的，这也是我在使用Zend 框架。如果有人有更好的处理方法，我希望将其发布在这里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T16:01:03.000

我想说用 ZF 做到这一点的最好方法是使用[Doctrine](http://www.doctrine-project.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T17:03:31.510

只需几条注释即可：

第一个 User 表看起来更像是一个 Person 表，除了 auth 方法，但您可以将它放在 User_Password 表中，您可以将其重命名为 User。User_Metadata 表似乎可以与 User_Password/User 表合并。

现在，即使没有这些更改，您也拥有三个不同的表，具有三个不同的概念，如果您将每个单独的表建模为不同的类，然后将 UserModel 类作为各种外观来访问每个表，它可能会更容易.

# html - 为 SEO 和可访问性构建 HTML 文档的最佳方法是什么？

> ID：638625
> 
> 赞同：5
> 
> 时间：2009-03-12T13:27:23.803
> 
> 标签：html, seo, accessibility

构建包含导航的 html 的推荐方法是什么，以便它仍然可以进行 SEO 和访问。

例如，结构是否应该更像文档的结构：

1.  跳到内容（链接，被 CSS 隐藏）
2.  导航
3.  内容
4.  其他内容（右侧窗格等）

或者：

1.  跳转到导航（链接，被 CSS 隐藏）
2.  内容
3.  导航
4.  其他内容（右侧窗格等）

显然 CSS 用于控制布局，但机器人和屏幕阅读器会忽略 CSS。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T13:38:16.180

我之前曾被客户要求将导航移动到内容之后，但我认为这对他们没有多大帮助。我通常遵循您上面提到的第一个结构。

一些随机提示：

*   保持您的标记标准兼容、有效和简单。
*   不要填充关键字或任何东西。
*   像对待标题一样对待它们。确保只有 1 个 h1 标签。在整个页面中谨慎使用标题（[Google](http://googlewebmastercentral.blogspot.com/2008/11/googles-seo-starter-guide.html) - 在 PDF 下载中）。
*   在锚点上使用标题属性，在图像上使用 alt 属性（但仅当图像需要对某些用户等效的文本时）。
*   使用 rel="nofollow" 将 PR 引导到您真正希望他们访问的页面。
*   保持每个页面的内容唯一。
*   使用 Google 网站管理员工具以及 MSN 和 Yahoo! 的等效工具。
*   构建、提交和维护 sitemap.xml 文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T13:32:46.050

任何没有将其内容隐藏在 Flash 或类似内容中的页面都可以进行 SEO。网络爬虫倾向于剥离所有内容并将页面作为文本流读取。有些人会注意您的关键字，它们在正文中的使用，H1 & H2 标签，页面标题甚至域名，但我认为它们不受页面结构顺序的影响。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T17:03:14.317

作为屏幕阅读器用户，我不在乎导航在页面上的位置。最有帮助的是按标题列出内容，例如这个问题在 h2 级别，答案从下一个 h2 级别开始。屏幕阅读器提供允许您按标题跳过的键，因此我发现标题导航比找到跳过导航链接并按 Enter 键更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T13:33:49.420

尽可能减少除内容之外的所有其他内容。

非常短的导航，添加一个链接到完整的导航页面/或/通过 AJAX 加载它。

没有“其他内容”。如果您在页面上放置任何内容，它们必须是相关的。此外，它们应该按它们的关系排序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T13:35:12.253

通常认为将您的内容尽可能靠近页面顶部是“最好的”。所以从技术上讲，你的第二个例子是最好的。跳转到内容链接对于屏幕阅读器来说是一个不错的选择，而且 CSS 布局的状态就是它们，没有人会讨厌你在文档顶部放置一些简单的导航。我当然不认为这会损害您的 Google PageRank。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T13:33:05.630

您可以做的最好的事情是将您的内容尽可能靠近页面顶部。我建议这种结构：

1.  跳过链接
2.  内容
3.  其他内容（右侧窗格等）
4.  导航

# php - 使用 JavaScript 获取表单变量

> ID：638629
> 
> 赞同：3
> 
> 时间：2009-03-12T13:28:24.813
> 
> 标签：php, javascript, html

I have the following form(echoed through php), which when a radio button is selected, I want that value to be passed to a javascript function, which I can then deal with.

```
<form id=\"form1\" name=\"form1\" method=\"\" action=\"JavaScript:alterRecord()\">
<input name=\"radiobutton\" type=\"radio\" value=\"test1\" />Test 2<p>
<input name=\"radiobutton\" type=\"radio\" value=\"test2\" />Test 2<p>
<input name=\"radiobutton\" type=\"radio\" value=\"test3\" />Test 3<p>
<input name=\"radiobutton\" type=\"radio\" value=\"test4\" />Test 4
<input type=\"submit\" name=\"Submit\" value=\"Submit\" />
</form> 
```

和 JavaScript

```
function alterRecord(value) {
alert(value);
} 
```

我不知道如何获取 javascript 以获取表单提交的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T13:32:16.083

从我的头顶：

```
<form onSubmit="alterRecord">
  <input type="radio" id="radio1"/>
  ...
</form>

function alterRecord() {
  var radio1 = document.getElementById('radio1');
  alert(radio1.checked);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T13:44:15.510

您是否希望在单击单选按钮时触发 javascript？或者什么时候提交表格？

如前所述，您可以使用 onsubmit="alterRecord(this);" 然后你可以使用诸如

```
alert(this.radio1.checked); 
```

如果您也将 id 添加到所有单选按钮..

并且每次单击单选按钮时都会触发 javascript

```
<input type="radio" onclick="alterRecord(this);" ... /> 
```

然后“this”命令将允许您访问单击的单选按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:24:21.327

如果您想在提交时使用 Javascript 执行某些操作，但**没有**发生正常的 POST 或 GET 请求（这会导致旧页面卸载并加载新页面），请确保执行以下操作：

```
<html>
  <head>
    <style type="text/css">
      body { background-color: black; color: white; }
    </style>
    <script type="text/javascript">
      function handleClick(event)
      {
        if (console) console.info("handling click");  
        // for Firebug debugging, if you want it

    /* do something here */
        alert(this.textBox1.value);
        // I don't like alerts but it works everywhere

        if (console) console.info("handled click");  

        event.preventDefault(); // disable normal form submit behavior
        return false; // prevent further bubbling of event
      }
      function doit()
      {
        if (console) console.info("starting doit()");
        document.forms.myform.addEventListener("submit", handleClick, true);
        return true;
      }
    </script>
  </head>
  <body onload="doit()">
    <form name="myform">
      <div>
          <textarea name="textBox1" rows="10" cols="80">
'Twas brillig, and the slithy toves
Did gyre and gimble in the wabe;
All mimsy were the borogoves,
And the mome raths outgrabe.
         </textarea>
      </div>
      <input type="submit" value="Update"/>
    </form>
  </body>
</html> 
```

线条`event.preventDefault()`和`return false`是关键。我也喜欢使用 addEventListener 而不是在表单中硬编码 onSubmit。我猜只是风格/偏好的问题。（尽管 addEventListener 确实允许您拥有多个处理程序。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T13:35:07.420

action 属性应该指向一个 URL。如果您想在用户提交表单时在 javascript 中执行某些操作，请使用 onsubmit 属性。例如，onsubmit="alert(42)"。

如果您从 onsubmit 属性中调用 javascript 方法并将其作为参数传递“this”，您将可以访问表单标记及其所有子节点，并且能够随意确定各种控件的当前状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T13:44:13.420

首先，开始使用[jQuery](http://jquery.com/)。

现在你已经开始了，[阅读文档](http://docs.jquery.com/Main_Page)，它应该很容易做这样的事情：

```
$("input[name='radiobutton']").click(function() {
   // do stuff
}); 
```

# mysql - 使用 MySQL 创建简单修订系统的最佳方法是什么？

> ID：638634
> 
> 赞同：9
> 
> 时间：2009-03-12T13:32:19.860
> 
> 标签：mysql, database, database-design, revision

我目前正在研究一个简单的修订系统，它使我能够存储单个文件的多个版本，到目前为止效果很好。

表结构如下（为简洁起见，删除了过时的列）：

```
file_id     file_revision     file_parent      file_name
--------------------------------------------------------
1           1                 0                foo.jpg
2           2                 1                foorevised.jpg                 
3           3                 1                anotherrevision.jpg 
```

在哪里：

*   `file_id`是主键，自动递增
*   `file_revision`存储修订号，默认为`1`第一个
*   `file_parent`是修订的顶级父级，默认为`0`第一次。
*   `file_name`是文件名。

**问题：**

*   最好使用单个查询我想检索所有文件...
*   但只有每个文件的最新版本......
*   ...当仅存储一个修订版（原始）时，应检索该修订版。

非常感谢任何指针。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T13:38:20.733

为了检索，最有效的方法是添加一个像 is_latest 这样的列，您需要提前填充它，然后`select * from table where file_id=1 and is_latest=true`当您想要获取文件 1 的最新版本时。显然，这会使更新此表变得更加复杂。

另一种方法是将文件的最新版本存储在一个表中，将历史版本存储在另一个表中。如果您主要想选择*所有*最新版本的文件，`select * from table where is_latest=true`即使 is_latest 被索引，也可能相当于全表扫描。如果最新的行都在一个表中，则数据库可以在顺序 IO 中将它们全部读取出来，而不必 1）通过表进行大量搜索以找到它需要的记录或 2）扫描整个表丢弃大沿途的旧记录的数据量。

假设您不想更改现有的表设计，您要做的就是选择 groupwise 最大值，请参阅[这篇文章](http://kristiannielsen.livejournal.com/6745.html)了解在 mysql 中执行此操作的几种不同方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T01:56:59.703

```
file_id     file_revised     file_name              Time_Stamp
-----------------------------------------------------------------
1           1                 foo.jpg                 insert_time
2           1                 foorevised.jpg          insert_time                 
3           1                 anotherrevision.jpg     insert_time 
```

然后我会对这样的查询进行变体：

SELECT * WHERE file_revision = 1 ORDER BY Time_Stamp GROUP BY file_revision

或者此类查询的任何数量的变化，即限制 1 或按 file_id 排序，因为最高也将是最新的，等等。

# vb.net - 如何在VB中使组框透明

> ID：638637
> 
> 赞同：4
> 
> 时间：2009-03-12T13:33:07.313
> 
> 标签：vb.net

这个问题几乎说明了一切，我尝试在属性部分将背景色设置为透明，但它似乎没有用。我在 groupbox 后面有一张图片，我需要通过它来展示。有没有特定的方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T17:43:26.263

透明属性不适用于重叠控件。我猜你有你的图片在一个图片框？

您至少可以通过两种方式解决此问题：

1）也许最简单的方法是将您的图片和 GroupBox 都*放在*Panel 中（您设置 Panel 的 BackgroundImage 属性）。那可行。那么 GroupBox 和 Panel 在技术上并不重叠，但 GruopBox 是 Panel 的子级。这不需要任何代码，您可以在表单设计器中直接看到您所获得的内容。

2) 使用表单的 OnPaint 或 OnPaintBackground 方法之一将图片直接绘制到表单上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-08T19:18:51.650

主题太旧了，但我只是将我的答案与其他人分享，我不是专家，但我发现它只是将面板背景图像设为任何图像并将 GroupBox 放在面板中，然后放在 GroupBOX 的背景色中选择 Web > 透明。没有其他东西应该做所有的工作，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:12:54.050

如果您正在寻找 WPF 解决方案，请尝试以下方法。确保将 Window.AllowsTransparency 设置为 true

```
<Window 
    AllowsTransparency="True" />

    <GroupBox Background="Transparent" />
</Window> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-30T05:27:31.240

如果您想在 Visual Basic 6 中执行此操作，您可以使用以下代码执行此操作：-

```
Option Explicit
Const THEBorder As Integer = 24 'You might need to adjust:
                                'this value is to compensate
                                'border of picturebox...
                                'note that I put a width of 2
                                'for this border, to make it
                                'wider
Private Sub Form_Load()
   With PicContainer
      .AutoRedraw = True
      .PaintPicture Me.Picture, 0, 0, , , .Left + THEBorder, .Top + THEBorder, .Width, .Height
   End With
End Sub 
```

如需进一步参考，您可以查看[此处](http://forums.codeguru.com/showthread.php?325547-Making-a-FRAME-transparent)

# python - 分页取决于 Django 中的项目分组

> ID：638647
> 
> 赞同：5
> 
> 时间：2009-03-12T13:36:19.973
> 
> 标签：python, sql, mysql, django, django-models

对于用 Django/Python 实现的网站，我们有以下要求：

在查看页面上，每个网页显示 15 条消息。当来自同一来源的两个或多个消息在视图上相互跟随时，它们应该被组合在一起。

也许不清楚，但通过以下示例可能是：

一个例子是（这次在一个页面上有 5 条消息）：

```
 Message1 Source1
  Message2 Source2
  Message3 Source2
  Message4 Source1
  Message5 Source3
  ... 
```

这应该显示为：

```
Message1 Source1
Message2 Source2 (click here to 1 more message from Source2)
Message4 Source1
Message5 Source3
Message6 Source2 
```

因此，在每一页上都会显示固定数量的项目，其中一些已重新组合。

我们想知道如何创建 Django 或 MySQL 查询来以最佳且简单的方式查询这些数据。请注意，使用了分页，并且消息按时间排序。

PS：由于SQL的性质，我认为没有简单的解决方案，但有时可以轻松解决复杂的问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:20:47.980

我看不出有什么好方法可以直接做你想做的事情。如果您愿意接受一点反规范化，我建议您使用预保存信号将消息标记为在头部。

```
#In your model
head = models.BooleanField(default=True)

#As a signal plugin:
def check_head(sender, **kwargs):
    message = kwargs['instance']
    if hasattr(message,'no_check_head') and message.no_check_head:
        return
    previous_message = Message.objects.filter(time__lt=message.time).order_by('-time')[0]
    if message.source == previous_message.source:
        message.head = False
    next_message = Message.objects.filter(time__gt=message.time).order_by('time')[0]
    if message.source == next_message.source:
        next_message.head = False
        next_message.no_check_head
        next_message.save() 
```

然后你的查询变得神奇简单：

```
messages = Message.objects.filter(head=True).order_by('time')[0:15] 
```

老实说……信号监听器必须比我写的更复杂一些。我的方法中存在许多丢失同步/丢失更新的问题，解决方案会因您的服务器而异（如果它是单处理的、多线程的，那么 python`Lock`对象应该可以解决问题，但如果它是多进程的，那么你真的需要实现基于文件或数据库对象的锁定）。此外，您当然还必须编写相应的删除信号侦听器。

显然，此解决方案涉及添加一些数据库命中，但它们是在编辑而不是在视图中，这对您来说可能是值得的。否则，也许考虑一种更粗略的方法：抓取 30 个故事，在视图中循环，剔除你不会显示的那些，如果还剩下 15 个，则显示它们，否则重复。绝对是一个可怕的最坏情况，但也许不是可怕的平均情况？

如果您的服务器配置使用多线程的单个进程，那么 Lock 或 RLock 应该可以解决问题。这是一个使用不可重入锁的可能实现：

```
import thread
lock = thread.allocate_lock()
def check_head(sender, **kwargs):
    # This check must come outside the safe zone
    # Otherwise, your code will screech to a hault
    message = kwargs['instance']
    if hasattr(message,'no_check_head') and message.no_check_head:
        return
    # define safe zone
    lock.acquire()
    # see code above
    ....
    lock.release() 
```

同样，相应的删除信号也很关键。

编辑：许多或大多数服务器配置（例如 Apache）将 prefork，这意味着有几个进程正在进行。在这种情况下，上面的代码将毫无用处。有关如何开始与分叉进程同步的想法，请参阅[此页面。](https://stackoverflow.com/questions/698950/what-is-the-simplest-way-to-lock-an-object-in-django/699222#699222)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T14:05:47.877

我有一个简单但不完美的纯模板解决方案。在模板中，您可以使用`regroup`模板标签重新组合记录。重组后，您可以隐藏来自同一来源的连续记录：

```
{% regroup records by source as grouped_records %}
{% for group in grouped_records %}
  {% for item in group.list %}
    <li{% if not forloop.first %} style="display:none"{% endif %}>
       {{ item.message }} {{ iterm.source }}
       {% if forloop.first %}
         {% ifnotequal group.list|length 1 %}
           <a href="#" onclick="...">Show more from the same source...</a>
         {% endifnotequal %}           
       {% endif %}
    </li>
  {% endfor %}
{% endfor %} 
```

如果不是为了一件事，这将是完美的：分页。如果您的意思是每页显示 15 个项目，并且在一个页面上，前五个来自一个来源，接下来五个来自另一个来源，最后五个来自另一个，那么页面上将只有三个可见项目。

# html - 换行 标签

> ID：638648
> 
> 赞同：54
> 
> 时间：2009-03-12T13:36:23.687
> 
> 标签：html

我正在创建基于用户输入到 textarea 的评论字段。但是当我使用 <pre> 标签时，我无法告诉它正确地包装在评论视图中。

如果有更好的方法，我不会坚持使用 <pre> 标签。我选择使用它的唯一原因是保留用户添加的换行符和空格。

我注意到 <pre> 有一个名为“width”的属性，但 W3 指出它已被弃用，而且它只会在如此多的字符之后中断，这也不理想。（它也根本不适用于 IE。）

有什么建议么？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-03-12T14:00:11.117

通常的方法是将输入中的单个换行符转换为“<br />”。（双换行符通常会引入一个新的“<p>”元素。）但这不包括多个空格运行；如果您需要保留这些，您可以用一个空格和一个不间断空格（' '、'\xA0' 或 ' ' 作为字符引用）替换每个两个空格序列。

有一种 CSS 方法可以保留文字换行符和空格，但当行长太短时仍会换行：

```
white-space: pre-wrap; 
```

但是，此 CSS 2.1 和 CSS 3 属性值不支持在其原始名称下跨浏览器。Webkit (Safari, Chrome) 选择它；要让它在其他流行的浏览器下工作，你必须添加：

```
white-space: -moz-pre-wrap;
white-space: -o-pre-wrap;
word-wrap: break-word; 
```

“自动换行”适用于 IE，它一如既往地有自己的做事方式。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-07-17T00:50:44.673

**最佳跨浏览器方式**（chrome、internet explorer、Firefox）。它对我有用，可以换行并显示确切的文本：

CSS：

```
xmp{ white-space:pre-wrap; word-wrap:break-word; } 
```

HTML：

```
<xmp> your text or code </xmp> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T13:39:34.303

您可以在 SO 上显示`pre`与此处类似的元素：`overflow:auto`

```
<pre style="overflow:auto">Loremipsumdolorsitamet,consecteturadipisicingelit,seddoeiusmodtemporincididuntutlaboreetdoloremagnaaliqua.Utenimadminimveniam,quisnostrudexercitationullamcolaborisnisiutaliquipexeacommodoconsequat.Duisauteiruredolorinreprehenderitinvoluptatevelitessecillumdoloreeufugiatnullapariatur.Excepteursintoccaecatcupidatatnonproident,suntinculpaquiofficiadeseruntmollitanimidestlaborum.</pre> 
```

但该[`pre`元素](http://www.w3.org/TR/html401/struct/text.html#edef-PRE)仅适用于预格式化文本，如源代码或纯文本文档。因此，您最好添加 HTML 换行符 ( [`br`element](http://www.w3.org/TR/html401/struct/text.html#edef-BR) ) 甚至段落 ( [`p`element](http://www.w3.org/TR/html401/struct/text.html#edef-P) )。

# wpf - 如何在 WPF 中制作选取框进度条？

> ID：638650
> 
> 赞同：30
> 
> 时间：2009-03-12T13:36:42.640
> 
> 标签：wpf, .net-3.5, controls, styles

在 Winforms 中，我可以将进度条的 ProgressBarStyle 设置为 Marqee，对于我不知道它需要多长时间且没有好方法的进程，无需设置即可自行设置进度条向 UI 报告。

我想在 WPF 中做同样的事情，但是除了托管一个 winform 进度条之外，我找不到一种方法来实现它，这似乎适得其反。

如何在 WPF 中实现这一点？我必须托管一个winform进度条吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-12T13:41:46.887

我认为您只是想将 ProgressBar 的*IsIndeterminate*属性设置为*true*。（见[这篇](http://sachabarbs.wordpress.com/2009/12/29/better-wpf-circular-progress-bar/)文章，它也有一个漂亮的圆形进度指示器的例子。）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-03-12T13:41:49.710

尝试以下

```
<ProgressBar 
  IsIndeterminate="True"
  Orientation="Horizontal" /> 
```

关键是奇怪的 IsIndeterminate 属性。将此设置为 true 意味着 Marque

# .net - 我应该将客户端访问权限放在不同的网站上吗

> ID：638658
> 
> 赞同：1
> 
> 时间：2009-03-12T13:39:23.507
> 
> 标签：.net, architecture

我为我的客户开发了一个基于 ASP.NET Web 表单的 Web 应用程序。此 Web 应用程序用于内部和外部管理养老金计划。

我的客户现在想为养老金计划的参与者开放访问权限，以便他们可以查看退休时将拥有多少钱、受益人等。参与者将拥有对数据的只读访问权限。

当前的 Web 应用程序存在缺陷，难以测试且难以更改。

为参与者访问创建新应用程序的优缺点是什么？

将面向公众的 Web 应用程序和内部 Web 应用程序分开是一种常见的做法吗？如果是，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T13:44:47.207

如果内部系统有缺陷且难以测试，那么我认为重建该系统并创建客户端门户是一个很好的论据。如果您有预算，那么将它们分开，让您面向外部的系统得到强化，并且仅对数据进行有限的访问，这听起来合乎逻辑，甚至无需涉及技术细节。

向任何人公开一个可以大量访问您的数据的有缺陷的应用程序令人担忧，但当您考虑互联网时，更令人担忧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T13:46:04.600

拆分它们很常见吗？是的。

原因是为您的客户工作的内部人员通常有与客户完全不同的要求。例如，客户得到一个简化的界面，不能做大部分功能，而且通常需要更多的手握。此外，浏览器要求通常不同。大多数 javascript / ui 效果都消失了。考虑一下仍在使用 XP 并在 56K 调制解调器上运行 IE 6（或更糟）的奶奶。

如果您的应用程序“有问题”，那么我绝对不可能向公众开放它。它只会给您的客户以及通过代理给您的公司带来坏名声。同时引起了很多支持电话。

请注意，我并不是说构建一个全新的数据模型等，只是对您所拥有的内容进行不同的处理，同时将其限制为客户需要的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T13:49:21.377

由于它是一个不同的应用程序，它应该是 - 一个不同的应用程序。它可能共享代码和/或数据库，但它有不同的目的，因此它是一个不同的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T13:59:23.913

是的，这很有意义。新应用程序可能是第一个应用程序的精简版，仅适用于申请人。它将使用其他规则和功能从同一个数据库中读取。

将它们分开实际上是一个非常好的主意。

# asp.net - 为什么我的 cookie 没有被删除/取消设置？

> ID：638661
> 
> 赞同：6
> 
> 时间：2009-03-12T13:40:58.217
> 
> 标签：asp.net, jquery, vb.net, cookies

我有一个登录链接，它触发一个调用注销页面的 javascript 函数。这是注销页面的组成部分：

```
 If Response.Cookies.Count > 0 Then
    Response.Cookies("aLog").Value = Nothing
    Response.Cookies.Clear()
End If 
```

最初我只有 cookies.clear 在那里，但这不起作用。

这是将请求发送到注销页面的 javascript：

```
<script type="text/javascript">
    //<![CDATA[
    $(document).ready(function() {
        $('#logout-link').click(function() {
            if (confirm("Really log out?")) {
                $.cookie('aLog', null);
                location.href = $(this).attr('href');
            }
            return false;
        });
    });
    //]]>
</script> 
```

jQuery 函数`$.cookie`也不起作用。cookie 是由 ASP.NET 设置的，所以我想我也可以用 ASP.NET 取消它，但显然不是。有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T13:46:11.853

在 ASP.NET 中使用 cookie 可能有点不直观。要杀死已经存在于客户端的 cookie，您必须将其过期日期设置为过去的某个时间，然后重新向客户端发送新的 cookie。客户端浏览器将使用新的过期日期更新现有的 cookie，然后立即将其杀死，因为它已经过了过期日期：

```
HttpCookie cookie = Request.Cookies["aLog"];
cookie.Expires = DateTime.Now.AddYears(-10);
Response.AppendCookie(cookie); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T14:10:42.717

除了 Rex 所说的之外，您应该始终设置您使用的任何 cookie 的“路径”（通常设置为“/”之类的东西）。否则，cookie 的可见性取决于 URL 中的文件夹名称，因此，如果您有除平面 URL 方案设置之外的任何内容，那么删除 cookie 的工作将非常不可预测。

# asp.net - 从 ASP.NET 应用程序中删除目录返回到新会话

> ID：638668
> 
> 赞同：7
> 
> 时间：2009-03-12T13:42:11.520
> 
> 标签：asp.net, visual-studio-2005

我正在从 ASP.NET 应用程序中删除一个目录。删除很顺利，但是当我从它返回时，删除之前的所有会话数据都丢失了。
我是否使用都没关系：

```
 if (Directory.Exists(folderPath))
                    Directory.Delete(folderPath, true); 
```

或者：

```
 System.IO.DirectoryInfo d = new System.IO.DirectoryInfo(folderPath);
                if (d.Exists)
                    d.Delete(true); 
```

在这两种情况下，我都会丢失会话数据。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T13:49:12.737

如果您要删除应用程序中的子目录，您的应用程序域将重新启动。这将删除所有会话数据。要缓解此问题，请仅在应用程序主目录之外添加/删除目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T13:47:30.540

目录是否在同一个应用程序中？然后删除它会导致 AppDomain 重新启动，这将导致会话状态丢失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T13:48:30.867

是的！删除 IIS 正在服务的目录会导致重置（或其他东西）。我遇到了这个问题，我重新设计了应用程序以不删除目录。

为这个问题感到羞耻-1，这是一个真正的问题。为有修复的人+1。

# .net - 如何调整窗体上的控件大小以适应不同的分辨率？

> ID：638685
> 
> 赞同：2
> 
> 时间：2009-03-12T13:47:35.360
> 
> 标签：.net, controls, user-interface

我正在开发一个有几个按钮和标签的小应用程序。在我的开发 PC 上，它适合窗口，但在其他机器上，表单的控件变得更小。我的屏幕分辨率是 1680x1050，客户端屏幕解决方案是 1024x768。是否可以使控件自动适应屏幕解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:33:09.277

在 .NET 世界中，您可以使用以下方法查询分辨率（和其他内容）：

[SystemInformation.PrimaryMonitorSize](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.primarymonitorsize.aspx)

我相信，这会在 Size 返回值中返回一对整数，它将告诉您以像素为单位的尺寸。

如果您巧妙地开发了表单——利用布局并期望程序可能以不同的分辨率运行，您可以获取该信息并保持显示正确。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T18:51:45.710

您可以使用锚定和停靠来调整控件的大小以适合屏幕。您还可以将它们放在启用滚动的面板中。但是，围绕用户将使用的分辨率设计应用程序可能是一个更好的主意。您可以使用选项卡式对话框等来一次在屏幕上拥有更少的控件。您在用户面前放置的控件越多，他们就会认为您的应用程序越难使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:14:33.003

我所知道的每种语言都有某种联系操作系统并请求用户屏幕结果的方式。这在 Web 应用程序中并非如此（或至少并非总是如此），但在“标准”应用程序中绝对是正确的。

例如，对于 Windows 窗体 (.NET) 应用程序，您可以将状态设置为最大化，应用程序将填满屏幕。您还可以根据用户的分辨率或其中的一部分（例如 75%）查询分辨率并设置大小。

这里的问题是你是 .NET 还是 Java？你在windows、mac、linux上运行吗？如果没有进一步的信息，没有人可以通过这个“噩梦”来规划你的路线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:36:00.423

使用对接和/或获取屏幕分辨率

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T12:04:29.140

我们在 DevExpress 组件方面拥有出色的经验，可以帮助您调整控件的大小：[Layoutcontrol](http://www.devexpress.com/Products/NET/Controls/WinForms/Layout/)。它使您的表单在所有屏幕尺寸和分辨率上都很好。掌握它需要一段时间，但是一旦你掌握了它......它完全改变了我们创建接口的方式（在 Delpft VCL 中，但它对 .net 的工作方式相同）

# dependencies - 在 Ada 中跟踪标头依赖项？

> ID：638697
> 
> 赞同：1
> 
> 时间：2009-03-12T13:50:27.460
> 
> 标签：dependencies, documentation-generation, ada

是否有工具可以跟踪/绘制 Ada 源代码中的标头依赖关系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:54:26.557

（假设“头文件依赖项”是指“包依赖项”。）

GNAT 编译系统附带[gnatls](http://gcc.gnu.org/onlinedocs/gnat_ugn_unw/The-GNAT-Library-Browser-gnatls.html#The-GNAT-Library-Browser-gnatls)工具，当使用 -d 和 -s 开关调用该工具时，会提供给定单元所依赖的文件列表。

我希望这也是其他 Ada IDE 的标准功能，例如 Aonix 和 Rational Apex。

[了解 2.0](http://www.scitools.com/products/understand/)，来自[Scientific Toolworks](http://www.scitools.com)是一个商业代码分析和浏览工具，可以做到这一点。它有点贵，但那是因为它非常强大，如果你有预算资源，每一分钱都值得。<plug>没有它，我不会处理任何类型的遗留代码库。</plug>

# asp.net-mvc - ASP.NET MVC 视图可以使用来自不同项目的模型吗？

> ID：638699
> 
> 赞同：8
> 
> 时间：2009-03-12T13:51:02.280
> 
> 标签：asp.net-mvc, entity-framework

我在 WPF 项目中有一个名为 Node 的 ADO.NET 实体框架类。我想在同一解决方案中的不同 ASP.NET MVC 项目中使用它。

我的节点控制器：

```
公共类节点控制器
    继承 System.Web.Mvc.Controller

    函数显示（ByVal id As Guid）作为 ActionResult
        将数据库调暗为新的 WpfApplication1.Model1Entities
        Dim m As WpfApplication1.Node = (From n In db.Node _
                                         其中 n.Id = id _
                                         选择 n).First
        返回视图（米）
    结束功能

结束类

```

当我运行项目并尝试导航到`http://.../Node/Display/[a valid ID]`

我的显示操作出现错误：

> “/”应用程序中的服务器错误。
> 
> 编译错误
> 
> 编译器错误消息：BC30456：“标题”不是“ASP.views_node_display_aspx”的成员。
> 
> 源错误：
> 
> 第 1 行：<%@ Page Title="" Language="VB" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage(Of WpfApplication1.Node)" %>
> 
> 源文件：C:...\MvcApplication1\Views\Node\Display.aspx

我读过这个错误可能是由于[代码隐藏类命名冲突](http://mattclingan.wordpress.com/2007/09/28/title-is-not-a-member-of-asp-what-the-hey/)。但我认为情况并非如此。

我不能使用来自不同项目的模型来创建强类型的 ASP.NET MVC 视图吗？

## 更新1：

我尝试在 Display.aspx 页面上导入命名空间，但没有一个

```
<%@ Import Namespace="WpfApplication1" %> 
```

或者

```
<%@ Import Namespace="SolutionName.WpfApplication1" %> 
```

或者

```
<%@ Import Namespace="SolutionName.WpfApplication1.Model1Entities" %> 
```

防止错误。

## 更新 2：

我已经尝试将命名空间添加到我的 Views/Web.config 文件中，但是没有

```
<add namespace="SolutionName.WpfApplication1" /> 
```

也不

```
<add namespace="SolutionName.WpfApplication1.Model1Entities" /> 
```

防止错误。

## 更新 3：

由于添加了命名空间，我现在确实收到了这个警告：

> Imports 'SolutionName.WpfApplication1' 中指定的命名空间或类型不包含任何公共成员或找不到。确保命名空间或类型已定义并包含至少一个公共成员。确保导入的元素名称不使用任何别名。

这是一个线索吗？

## 更新 4：

我已将模型从我的 WpfApplication1 移至新的 ClassLibrary1。

我已经清理了我的控制器。

```
导入 ClassLibrary1

公共类节点控制器
    继承 System.Web.Mvc.Controller

    函数显示（ByVal id As Guid）作为 ActionResult
        Dim db 作为新的 Model1Entity
        Dim m As Node = (From n In db.Node _
                         其中 n.Id = id _
                         选择 n).First
        返回视图（米）
    结束功能

结束类

```

我已经清理了我的视图。

```
<%@ Import Namespace="ClassLibrary1" %>
<%@ Page Title="" Language="VB" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage(Of Node)" %> 
```

我不再看到警告。

但我仍然得到运行时错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T13:56:02.330

仔细检查您的 Views/Web.config 是否具有引用项目的命名空间：

```
<system.web>
  <pages>
    <namespaces>
      <add namespace="SolutionName.WpfApplication1.Model1Entities" />
    </namespaces>
  <pages>
</system.web> 
```

更新：

我没有任何 WPF 应用程序可以对此进行测试...我以为您正在尝试使用“类库”项目。那肯定会奏效。是否可以稍微重构您的应用程序以将“模型”提取到他们自己的项目中？这样您就可以将其编译为类库。

更新 2：

奇怪的是，您的页面几乎没有从 System.Web.Mvc 正确继承。确保您的 Views/Web.config 如下所示：

```
<?xml version="1.0"?>
<configuration>

  <system.web>
    <httpHandlers>
      <add path="*" verb="*"
          type="System.Web.HttpNotFoundHandler"/>
    </httpHandlers>
    <pages validateRequest="false"
            pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
            pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
            userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <controls>
        <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" namespace="System.Web.Mvc" tagPrefix="mvc" />
      </controls>
      <namespaces>
        <add namespace="SolutionName.WpfApplication1.Model1Entities"/>
      </namespaces>
    </pages>

  </system.web>

  <system.webServer>
    <validation validateIntegratedModeConfiguration="false"/>
    <handlers>
      <remove name="BlockViewHandler"/>
      <add name="BlockViewHandler" path="*" verb="*" preCondition="integratedMode" type="System.Web.HttpNotFoundHandler"/>
    </handlers>
  </system.webServer>
</configuration> 
```

更新 3：运行时错误看起来不是 MVC 项目。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T13:55:18.057

你绝对可以！只需确保在视图中包含正确的命名空间：

```
<%@ Import Namespace="MyEntityNamespace" %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:26:03.753

右键单击 web 项目中的引用并选择“添加引用”。之后使用“项目”。

之后，您可以使用 Rex 提供的答案（不要担心那里的 Vb 语法。我使用 c#，它是 c# 的语法）

这个对我有用。

编辑：

利用

不是

# web-services - 基于 Web 服务的架构的可扩展性到底有多大？

> ID：638700
> 
> 赞同：1
> 
> 时间：2009-03-12T13:51:18.003
> 
> 标签：web-services, web-applications, scalability, scaling

每当有人谈论基于服务的架构时，他们经常会提到可扩展性，而且往往是同时提到的。但是，似乎使用服务会增加而不是减少开销，因为现在涉及到一个协议，如 SOAP 或 REST。那么，当 Web 应用程序的用户数量增加一个数量级时，基于 Web 服务的架构真的会增加性能优势吗？还是只是将可扩展性需求转移到服务上，而不是核心应用程序上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T13:56:22.033

可扩展性和性能是两个不同的东西。是的，基于服务的方法确实增加了网络协议的开销，但对于能够在域上的任何应用程序中快速采用经过良好测试的服务的好处而言，这是最小的牺牲。

如果网络的开销对您要构建的系统来说是一个交易破坏者，那么显然 SOA 对您来说是错误的选择。请记住，并非必须通过 HTTP 访问任何服务。我想您会惊讶于某些协议（如`net.tcp`）的速度有多快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:03:52.920

请记住，您可以扩展 Web 服务以在多个服务器上运行，而不会影响客户端。这对于紧密耦合的系统来说效果不佳。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T13:57:36.740

正确设计的 SOA 允许系统中的每个组件独立于所有其他组件工作并异步并行运行，因此性能和可扩展性（两个不同的东西）仅受系统中最慢/最不可扩展的部分的限制，而不是所有组件串行执行所需的总时间。

SOA 并不适用于所有解决方案，因此如果您没有看到对您的特定情况有任何明显好处，那么可能没有任何好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T14:04:45.913

Web 服务不会免费为您提供可伸缩性。事实上，构建一个*无法*扩展的服务非常容易。

它们给你的是建立可扩展性的机会。而且，通过具有良好定义的服务接口，您可以在需要时将服务的快速且肮脏的不可扩展的实现换成更好的实现。

重要的是不要忘记“SOA”中的“A”。随便创建一堆服务就可以搞得一团糟。确保你有一个架构。

朝着可伸缩性迈出的一大步是从基本的、同步的、查询/响应类型的服务（例如 SOAP RPC）转向异步服务。参见 Hohpe 和 Woolf 的“企业集成模式”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T14:21:28.070

RESTafarians 会提醒您，REST 不是一种协议——它是一种架构风格。REST 是一种直接使用 HTTP 的方式，无需 SOAP 使用的包装器来提供服务模型。REST 更接近于 SOAP。仅凭这一点并不能使一个比另一个更好，它们都有自己的位置。

服务模型的可伸缩性与“服务”（如在具有大写 W 和大写 S 的 Web 服务中）没有直接关系，而是与这些服务的无状态性质直接相关。构建良好的 Web 应用程序也具有可扩展性，可以说与任何服务驱动架构一样具有可扩展性。

两种模型之间的区别之一是，没有“服务”的 Web 应用程序以二进制级别与生活在同一进程中的引用模块进行交互——不需要序列化。Web 服务（SOAP 或 REST）引入了某种级别的序列化，增加了开销。但是，考虑到它提供的重用，这种开销通常被认为是值得的（即，在内部驱动您的应用程序的相同 Web 服务也可以用来使业务合作伙伴满意）。

一种好的架构是将服务类（不是 Web 服务，它会很快变得混乱！在这种情况下，服务是指服务于低级业务流程的类）直接在进程中向本地应用程序公开——利用谈话的能力二进制到这个服务。但是，对于业务合作伙伴和其他服务用途，在这些已经测试过的服务类之上放置一个薄的 Web 服务层，以提供与 Web 服务相同的服务层。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-12T14:13:30.540

好的，让我们首先定义“可扩展性”。大多数东西*都会*扩展：如果你需要更多的容量，大致上，你可以简单地投入更多的硬件。但有些架构“更具可扩展性”——这是什么意思？它与成本有关：如果每单位增加容量的成本较低，则架构“更具可扩展性”。

在任何架构中，可扩展性通常具有三个范围：第一部分有固定成本，因此在一个区间内它是线性的，斜率为 0；超过那个点，斜率会增加，并且在某些时候增加容量通常是非常昂贵的。

如果描述每单位增加容量的成本的函数在大范围内大致呈线性，我们就说系统是“线性可扩展的”。显然，希望该斜率更小。

所以，现在，当有人问起 SOA、SOAP 或 REST 或其他任何东西的“可扩展性”时，这就是他们所说的。

面向服务的架构被称为“更具可扩展性”，因为添加更多容量相对便宜，尽管正如您所说，可能存在开销使您需要更多容量来为单个用户提供服务。这是因为管理大型系统的大部分成本和复杂性来自维护会话状态的需要，即跟踪调用之间发生的情况。面向服务的体系结构通过使每个调用相对独立于下一个调用来避免这种情况，RESTful 体系结构是限制情况——所有会话状态都在表示中编码，因此系统的其余部分不需要知道它。当您想增加容量时，您需要做的就是添加另一台服务器；简单的负载平衡足以将消息路由到新的消息。

（请注意，这本质上也更具容错性：如果一个服务器死了，另一个服务器或多或少会自动获取请求，并且不会丢失任何会话。）

需要大量会话状态的体系结构（如某些 J2EE 系统）往往无法很好地扩展，因为您需要大量额外的复杂性来管理会话状态。

您在基于 CGI 的旧架构中看到的那种限制情况是每个用户会话都需要一个完整的重量级进程。我见过一些系统，其中 fork/exec 占负载的 40-50%，需要一个复杂的软件负载平衡装置来确保请求总是到达举行会话的机器，以及在哪里简单地用完进程槽是一个主要问题。一个这样的系统需要购买一个全新的高端 Starfire 服务器来增加容量。

# c# - 如何从二维字节数组创建图像？

> ID：638701
> 
> 赞同：3
> 
> 时间：2009-03-12T13:52:09.873
> 
> 标签：c#

在我的项目经过长时间的处理后，我从红外摄像机得到了一个二维字节数组。

字节数组在其中保存图像...

如何在 C# 中将该字节数组转换为图像..

我知道通过

```
MemoryStream ms = new MemoryStream(byteArray);
System.drawing.Image im = Image.FromStream(ms); 
```

我们可以传递一维数组并将其转换为图像..

如果我将二维数组作为一维数组传递..它显示错误..

怎么整。。？？？？否则如何将二维字节数组转换为图像...？？？

谢谢！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T14:03:02.437

如果它是一个矩形数组（即 a `byte[,]`）而不是锯齿状数组（`byte[][]`），那么您*可以*使用一些不安全的代码非常简单地完成它。

看看我的[并行 Mandelbrot 集生成代码](http://www.yoda.arachsys.com/csharp/blogfiles/Mandelbrot.cs)- 只有底部是有趣的，它从调色板和数据块构造位图：

```
byte[] data = query.ToArray();

unsafe
{
    fixed (byte* ptr = data)
    {
        IntPtr scan0 = new IntPtr(ptr);
        Bitmap bitmap = new Bitmap(ImageWidth, ImageHeight, // Image size
                                   ImageWidth, // Scan size
                                   PixelFormat.Format8bppIndexed, scan0);
        ColorPalette palette = bitmap.Palette;
        palette.Entries[0] = Color.Black;
        for (int i=1; i < 256; i++)
        {
            palette.Entries[i] = Color.FromArgb((i*7)%256, (i*7)%256, 255);
        }
        bitmap.Palette = palette;
        // Stuff
    }
} 
```

我不知道您是否可以在构建位图后取消固定数组 - 如果我将其用于生产代码，我会更仔细地查看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T13:54:37.777

如果要按顺序处理字节数组，可以执行以下操作

```
byte[][] doubleArray = GetMyByteArray();
byte[] singleArray = doubleArray.SelectMany(x => x).ToArray();
MemoryStream ms = new MemoryStream(singleArray);
System.drawing.Image im = Image.FromStream(ms); 
```

SelectMany 方法本质上接受数组的数组并按顺序返回元素。从第一个数组的第一个元素开始，完成该数组，然后移动到下一个。这将一直持续到处理完所有元素。

# c++ - 为什么 QWidget::paintEvent 没有被调用？

> ID：638704
> 
> 赞同：2
> 
> 时间：2009-03-12T13:52:57.437
> 
> 标签：c++, user-interface, qt, widget

我有一个简单的小部件层次结构：GraphWidget -> MotionWidget -> NodeWidget。我是 Qt 的新手，所以我不太确定某些内部是如何工作的。基本上，GraphWidget 创建一个 MotionWidget *M*并将*M 的*父级设置为自身。然后*M离开并创建了一堆 NodeWidgets。*然而，NodeWidgets 永远不会被绘制，它们的 paintEvent() 函数也不会被调用。

我尝试直接创建 MotionWidget，没有 GraphWidget，一切正常。那么，如果我将 GraphWidget 添加到层次结构中，为什么事情会中断呢？

这是我项目中相关代码的粘贴。我还在顶部包含了 GraphWidget::dumpObjectTree() 的输出。

编辑：忘记包含粘贴链接；）[http://rafb.net/p/Zp39CF94.html](http://rafb.net/p/Zp39CF94.html)

更新：我将 MotionWidget 包装到布局中。

前：

```
GraphWidget :: GraphWidget( QWidget *parent ) : QWidget( parent )
{
    setFixedSize( 500, 500 );

    MotionWidget *n = new MotionWidget( 5, this );
} 
```

后

```
GraphWidget :: GraphWidget( QWidget *parent ) : QWidget( parent )
{
    setFixedSize( 500, 500 );

    QVBoxLayout *l = new QVBoxLayout;

    MotionWidget *n = new MotionWidget( 5 );

    l->addWidget( n );

    setLayout( l );
} 
```

现在，后者起作用了。即一切都被绘制。那么问题就变成了……为什么？为什么它在第一种情况下不起作用但在第二种情况下起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T17:27:57.480

我不同意[Aiua 的回答](https://stackoverflow.com/questions/638704/why-qwidgetpaintevent-doesnt-get-called/639221#639221)。将父对象传递给对象会将子对象添加到视觉层次结构中。（否则，使用 Designer 制作包含其他小部件但具有绝对定位的小部件将不起作用。）但是，可能还有其他因素阻止了绘画的发生。

由于布局使事情正常，我猜测在这两个版本中，`MotionWidget`都没有设置大小。这意味着在第一个示例中，它将被调整为 0x0 像素，Qt 将在尝试绘制时对其进行优化。在第二个示例中，布局控制添加到其中的小部件的大小，因此会放大`MotionWidget`，因此它将再次开始接收绘制事件。

要解决此问题，您可以像 for 一样显式设置大小`GraphWidget`，或者您可以根据父级的大小进行一些动态调整大小，或者`GraphWidget`可以控制大小，或大量各种选项中的任何一个。布局也可以很好，但不是绝对必需的。

# oracle - 如何通过 sql plus 从命令行发出单个命令？

> ID：638705
> 
> 赞同：54
> 
> 时间：2009-03-12T13:54:11.773
> 
> 标签：oracle, command-line, sqlplus

使用 SQL Plus，您可以从命令行运行带有“@”运算符的**脚本，如下所示：**

```
c:\>sqlplus username/password@databasename @"c:\my_script.sql" 
```

但是是否可以只运行一个具有类似语法的**命令，而不需要一个完整的单独脚本文件？**如：

```
c:\>sqlplus username/password@databasename @execute some_procedure 
```

我对此感兴趣，因为我想编写一个简单地执行命令的批处理文件，而不生成一堆两行的“.sql”文件。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-03-12T16:15:18.630

我可以通过将 SQL 查询通过管道传输到 SQL*Plus 来运行它：

```
@echo select count(*) from table; | sqlplus username/password@database 
```

给

```
@echo execute some_procedure | sqlplus username/password@databasename 
```

试一试。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-12T14:27:57.307

你有没有尝试过这样的事情？

```
sqlplus username/password@database < "EXECUTE some_proc /" 
```

似乎在 UNIX 中你可以这样做：

```
sqlplus username/password@database <<EOF
EXECUTE some_proc;
EXIT;
EOF 
```

但我不确定 Windows 相当于什么。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-10-06T19:42:13.927

**对于 UNIX (AIX)：**

```
export ORACLE_HOME=/oracleClient/app/oracle/product/version
export DBUSER=fooUser
export DBPASSWD=fooPW
export DBNAME=fooSchema 

echo "select * from someTable;" | $ORACLE_HOME/bin/sqlplus $DBUSER/$DBPASSWD@$DBNAME 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-11-19T20:56:41.363

```
sqlplus user/password@sid < sqlfile.sql 
```

这也适用于 DOS 命令行。在这种情况下，文件 sqlfile.sql 包含您希望执行的 SQL。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-10-20T18:22:37.907

```
@find /v "@" < %0 | sqlplus -s scott/tiger@orcl & goto :eof

select sysdate from dual; 
```

* * *

## 回答 #6

> 赞同：-10
> 
> 时间：2014-09-30T23:03:07.247

这就是我解决问题的方法：

```
<target name="executeSQLScript">
    <exec executable="sqlplus" failonerror="true" errorproperty="exit.status">
        <arg value="${dbUser}/${dbPass}@<DBHOST>:<DBPORT>/<SID>"/>
        <arg value="@${basedir}/db/scripttoexecute.sql"/>
    </exec>
</target> 
```

# database - 数据库应用程序的最佳实践

> ID：638706
> 
> 赞同：2
> 
> 时间：2009-03-12T13:54:14.860
> 
> 标签：database, database-connection, frontend

我问自己，在为数据库构建前端时，社区认为什么是“最佳实践”。

例如：

每个表格都应该有自己的联系吗？

所有与数据库相关的东西都应该放在一个单独的层吗？那就是：创建一个类，处理所有数据库，然后我从我的表单中实例化它等等？

应该遵循多严格的分隔规则，即：SQL字符串，连接字符串放在哪里。在每个表单代码（可找到）中，在单独的（源）文件中作为全局变量，在 XML 文件中，甚至源代码中的任何位置，仅在 sql 服务器上？

等等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:00:54.267

在构建 Web 应用程序时，您通常有 3 层逻辑。

1.  表示层
2.  业务逻辑层
3.  数据访问层

最后一层完成有关管理数据库的所有工作。

业务逻辑层不应该在不使用数据访问层的情况下直接与数据库对话。

这是我最好的建议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:06:18.403

阅读您的语言中应用程序架构的最佳实践，并阅读流行的框架。这个问题的答案可以轻松填满 3 或 4 个学期的应用程序架构课程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:18:23.913

这是一个非常广泛的问题，没有简单的答案。如果这是一个中小型项目，我会将连接字符串放在 web.config（connectionStrings 部分）中，并使用内置的 SqlDataSource 控件来访问它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:21:56.480

了解数据库的事务模型。Oracle 和 SQL Server 都支持事务，但它们的工作方式完全不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T15:13:54.437

最好将项目的不同层分开。查看 MVC 框架。

[维基百科上的 MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

# sql-server - 设置 Identity_insert - 合并复制

> ID：638714
> 
> 赞同：13
> 
> 时间：2009-03-12T13:56:18.350
> 
> 标签：sql-server, sql-server-2005, replication, merge-replication

我在两个数据库之间设置了合并复制，并且在两个数据库上都使用了身份范围。

我想在发布者的合并表中添加特定行（将标识值设置为标识范围之外的内容）。当我尝试这个时，我收到以下错误。

> 插入失败。它与数据库“xxx”、复制表“dbo.yyy”、列“yyy_id”中的标识范围检查约束冲突。如果标识列由复制自动管理，则更新范围如下：对于发布者，执行 sp_adjustpublisheridentityrange；对于订阅服务器，运行分发代理或合并代理。

有没有办法将特定的身份值强制到使用身份范围管理的合并复制表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:10:39.237

一种方法是确保复制拓扑中的每个节点都使用不同范围的标识值，这样就不会发生重复。

> 例如，发布者可以分配范围 1-100，订阅者 A 分配范围 101-200，订阅者 B 分配范围 201-300。如果在发布服务器处插入一行并且标识值为例如 65，则该值将复制到每个订阅服务器。当复制在每个订阅服务器上插入数据时，它不会增加订阅服务器表中的标识列值；而是插入文字值 65。只有用户插入而不是复制代理插入会导致标识列值递增。

参考。[复制标识列](http://msdn.microsoft.com/en-us/library/ms152543(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-29T15:03:26.903

我通过增加 20000 行来增加自动插入来解决。 [此处添加了有用的博客](https://www.mssqltips.com/sqlservertip/6093/sql-server-merge-replication-identity-range-management/)

# jquery - 需要帮助一次处理多个 jquery $.get 调用

> ID：638723
> 
> 赞同：2
> 
> 时间：2009-03-12T13:58:21.777
> 
> 标签：jquery, ajax

我是新来的，我很困惑。我需要帮助。希望有人能告诉我有一个非常简单的解决方案来解决我的问题微笑

我有一个网站，您可以在其中单击链接并在“窗口”中打开相关内容。这一切都来自同一个域。无论如何，当你点击让我说... 5 个链接非常快时，我的问题就会出现。发生的情况是只有 1 或 2 个窗口获得内容。发生的情况是，当第一个呼叫完成时，它似乎优先于最近的呼叫。

基本上，我想知道如何处理多个 .get 调用并将每个调用加载到单独的窗口中而不干扰其他调用。这是处理它的函数：

```
popupWindow.prototype.openURL = function(link){
       windowname=this.windowname;
   theWindow="."+windowname+"_window .window .content";
   $(theWindow).hide();
        $(theWindow).html('<p class="page-loading"><img src="graphics/loading.gif" alt=""/></p>').fadeIn("medium");

   $.get(link, function(data) {
      $(theWindow).hide();
      $(theWindow).html(data).fadeIn("medium");
   });
} 
```

当你点击链接时，上面的代码工作得很好......慢慢地。或者一次一个。如果有人可以提供帮助，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T14:08:59.803

试试看：

```
var theWindow = "." + this.windowname + "_window .window .content"; 
```

`var`将变量的范围更改为函数，并希望解决这个并发问题。

并且...尽可能使用 ID...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T14:10:45.587

您的`theWindow`变量是隐含的全局变量。每次`openURL`调用，`theWindow`都会被覆盖。

您只需将其更改为即可解决此问题`var theWindow = ..`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:32:08.110

你们很棒。我对 javascript 比较陌生，所以我很容易混淆我的局部变量\全局变量\对象属性。我通过本地化该函数中声明的每个变量并将数据（一旦检索到）发送到该对象的单独函数（我称之为“handleDataRequest（data）”）来解决了这个问题。

现在每个窗口都将内容加载到自身中，并且不会与其他窗口发生冲突！

多谢你们。这是迄今为止我的网站中最大的障碍。

*兴奋地跳上跳下*

# http - 记录流量的firefox插件

> ID：638724
> 
> 赞同：7
> 
> 时间：2009-03-12T13:58:43.710
> 
> 标签：http, firefox, firebug, firefox-addon

你知道一个记录我浏览时产生的http流量的firefox插件吗？

我想要像萤火虫的网络选项卡这样的东西，但每次单击新链接时它都不应该“重新启动”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T14:06:06.597

# [HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)

非常适合调试 Ajax 的东西。

![替代文字](https://farm4.static.flickr.com/3662/3348485253_737914cc2c.jpg)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T22:33:50.403

你也可以试试 Firefox 的 HttpWatch 插件。当您单击不同的链接时，它会显示像 Firebug 这样的时间表并按页面对请求进行分组：

[![HttpWatch 页面分组](https://i.stack.imgur.com/0NZ5Q.png)](https://i.stack.imgur.com/0NZ5Q.png)
[（来源：[httpwatch.com](http://www.httpwatch.com/images/v5_pagegrouping.png)）]

有免费版和商业版。免费版仅显示有限数量的知名网站（例如 microsoft.com、google.com 等）的详细信息。

您可以在我们的网站上找到更多关于 HttpWatch 的信息：

[http://www.httpwatch.com/](http://www.httpwatch.com/)

免责声明：此答案由 HttpWatch 背后的公司 Simtec Limited 发布

# ssl - 了解非 SSL 登录表单的风险

> ID：638745
> 
> 赞同：30
> 
> 时间：2009-03-12T14:04:25.257
> 
> 标签：ssl

作为 Web 应用程序的用户，我倾向于只注册使用 SSL 安全登录表单的服务。作为开发人员，我知道风险在于非 SSL 表单以纯文本形式传输，不道德的个人可能会“嗅探”HTTP 流量并确定我的登录名和密码。

但是，如果我说，在家里，在我的 DSL 或有线互联网连接上，发生这种情况的真正风险或可能性是什么？数据包嗅探器需要在哪里运行？可以在任何时候将数据包嗅探回服务器吗？与在家相比，在具有较大 LAN 的公司网络中“嗅探数据包”是否更容易？

我开发 Web 应用程序已经有一段时间了，但我从来没有真正理解过这一点。我很想得到一些澄清。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-12T14:42:32.873

您的流量在您的 ISP 和目的地之间的节点上被嗅探的风险是远程的。您将是数百万人中的一员，并且在该级别执行数据包检查以识别携带登录信息的数据包需要大量的处理能力。

正如已经指出的那样，真正的风险在于本地网络。最常见的两种情况是：

1.  受感染的计算机或恶意用户使用 ARP 中毒等技巧来嗅探所有未加密的流量。ARP 中毒在低流量网络上相当不明显。在高流量网络上，它将导致明显的性能下降和检测概率增加。勤奋的网络分区可能会降低 ARP 中毒的有效性。

2.  有人控制了网关。这可能是最糟糕的情况，因为所有互联网流量都通过网关。根据攻击者的聪明程度，这可能很难检测到。

SSL 可以防止嗅探，它还有另一个您可能不知道的优势：SSL 允许您确定接收您的密码和其他详细信息的实体就是您认为的那个人。

如果说您是 DNS 中毒的受害者，有人将您重定向到一个看起来与合法网站一模一样的恶意网站，您将无从得知。使用 SSL，您会收到一个警告/错误，表明该站点没有有效的证书，这会提醒您一切都不是应有的。

就我个人而言，我根据信息是否通过 HTTPS 传输来定制我的密码。我这样做是因为最终我不可避免地需要在不受信任的网络上通过 HTTP 登录。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-12T14:11:31.370

数据包绝对可以在客户端和服务器之间的路由上的任何位置被嗅探。攻击者只需要物理访问这些网络之一。

显然，您离“主干”（ISP）而不是“叶子”（家用路由器、家用计算机）越近，您可以嗅探到的东西就越多。

通过 DNS 欺骗，攻击者可以修改该路由，使其通过他们控制的系统。

感受这一点的最简单方法可能是亲自尝试一下。安装[Wireshark](http://www.wireshark.org/)，看看看路过的东西是多么容易。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T14:09:06.527

电缆很容易嗅探数据包，因为它是一种共享的广播媒体。工作网络，没那么多。通常情况下，有人必须专门针对您（或进行一般端口监控设置）来嗅探您的流量。DSL 是直接连接到 ISP 的，所以没有那么多。一旦它在网上，有人窃取它的现实机会非常低。帐户几乎总是通过入侵数据库或从不安全的无线网络中窃取信息而被盗。在这 2 个中，直接入侵数据库具有最佳的风险/回报比，因此它是最受欢迎的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-12T14:10:36.897

实际上，根据您的网络设置，您在家中可能面临更高的风险，因为人们在进行战争。如果你的网络有安全性，而邻居没有，那么风险当然要低得多。

任何时候有人可以在你和目的地之间找到一个监听器，无论是在你的家庭网络上，还是在一些大型网络上，他们都可以嗅探。

总体而言，风险相当低，因为不仅仅是任何人都可以嗅探任何路由器。但是，不使用 SSL 意味着您非常信任您不认识的人。

我是这样对待的。如果一个站点有我想要的东西，但没有 SSL，如果没有通过财务信息，我会这样做。在这些网站上，我使用“spamcatcher”电子邮件。如果帐户被嗅探，则不会有重大损坏，因为它会发送到我很少检查的电子邮件。:-)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-01-14T18:04:54.637

如果您正在开发一个供公众使用的网站，您还应该知道到一个地区的所有非 SSL 流量都可能由民族国家或主要电信公司检查或修改。

考虑 2011 年 1 月的报道，突尼斯政府正在对 Facebook 登录页面的非加密访问执行 JavaScript 注入：[https ://www.eff.org/deeplinks/2011/01/eff-calls-immediate-action -保卫突尼斯人](https://www.eff.org/deeplinks/2011/01/eff-calls-immediate-action-defend-tunisian)

包含登录表单的页面应始终通过 SSL 传递，并且表单的目标操作也应始终使用 SSL。对于除了供个人消费的玩具网站之外的任何东西，任何东西都是不负责任的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-12T14:09:36.617

*   “*但是，发生这种情况的真正风险或可能性是什么*”：取决于很多因素。最大的将是您正在使用的网站，银行业务将高于 StackOverflow。
*   “*数据包嗅探器需要在哪里运行*”：它可以在数据运行的任何节点上（包括您机器上的恶意软件）。要查看节点的数量，一个简单的 traceroute 会显示给您。
*   “*是否可以在任何时候将数据包嗅探回服务器*”：是
*   “*与在家相比，在具有较大 LAN 的公司网络中“嗅探数据包”是否更容易*“：不，要求是相同的。控制数据包通过的节点并添加嗅探器。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-12T14:12:24.693

运行跟踪路由。从字面上看，您和目的地之间的每个接口或路由器都可以捕获您的数据包。

从您自己的计算机开始在您不知情的情况下运行数据包嗅探器，这可能是感染的结果。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-01-21T19:58:53.477

人们忽略了一个事实，即通过 wifi 捕获数据非常容易。与您在同一 wifi 网络上的任何用户都可以在数据包进出接入点时捕获数据包。许多工具允许业余黑客这样做。

SSL 对数据进行加密，因此即使您在咖啡店旁边的人可以捕获和存储您的数据，由于 SSL，它已被加密，对黑客来说基本上是无用的。如果没有 SSL，您的用户名、密码、信用卡信息等都是纯文本，并且和这篇文章一样容易阅读。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T14:10:23.793

数据包不会神奇地直接从您的网络传输到服务器。数据包在到达最终目的地之前通常会穿越许多不同的网络。在链中的任何一点，都可能有人在捕获流量。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T14:11:11.450

在您的网络中嗅探数据包变得更加容易。所以WLAN提供了很多危险。如果另一台计算机连接到您的交换机/路由器，它可以通过操纵路由器/交换机功能（ARP 欺骗/中毒）来嗅探数据包，请参阅：[链接文本](http://en.wikipedia.org/wiki/ARP_poisoning)。

WAN 中的嗅探人员必须做更多的工作！因此，您的 IP 必须是已知的，并且攻击者必须在您的数据包途中操纵一个节点以从那里嗅探数据包。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T14:11:28.860

我认为是因为：

1.  您无法控制用户登录系统的位置
2.  您不能确定您的 ISP 不会嗅探您的数据包。（如果某个邪恶的黑客设法做到了呢）

这只是互联网。你对其他人无能为力。最好的方法是保护自己。

# encoding - HttpWebRequest：接收具有正确编码的响应

> ID：638756
> 
> 赞同：2
> 
> 时间：2009-03-12T14:06:47.607
> 
> 标签：encoding, .net-2.0, httpwebrequest

我目前正在使用以下代码下载 HTML 页面：

```
Try
    Dim req As System.Net.HttpWebRequest = DirectCast(WebRequest.Create(URL), HttpWebRequest)
    req.Method = "GET"
    Dim resp As Net.HttpWebResponse = DirectCast(req.GetResponse(), Net.HttpWebResponse)
    Dim stIn As IO.StreamReader = New IO.StreamReader(resp.GetResponseStream())
    Dim strResponse As String = stIn.ReadToEnd

    ''Clean up
    stIn.Close()
    stIn.Dispose()
    resp.Close()

    Return strResponse

Catch ex As Exception
    Return ""
End Try 
```

这适用于大多数页面，但对于某些页面（例如：www.gap.com），我得到的响应编码不正确。
例如，在 gap.com 中，我将“'”视为“？”
更不用说如果我尝试加载 google.cn 会发生什么......

我在这里缺少什么，让 .Net 对其进行编码？

我最担心的是，我实际上必须读取 HTML 中指定编码的元标记，然后重新读取（重新编码？）整个流。

任何指针将不胜感激。

* * *

**更新：**

感谢约翰桑德斯的回复，我更接近了。HttpWebResponse.ContentEncoding 属性似乎总是​​空的。但是， HttpWebResponse.CharacterSet 似乎很有用，并且使用此代码，我越来越接近：

```
Dim resp As Net.HttpWebResponse = DirectCast(req.GetResponse(), Net.HttpWebResponse)
Dim respEncoding As Encoding = Encoding.GetEncoding(resp.CharacterSet)
Dim stIn As IO.StreamReader = New IO.StreamReader(resp.GetResponseStream(), respEncoding) 
```

现在Google.cn 完美的出现了，所有的汉字。
然而，Gap.Com 仍然犯了错误。

对于 Gap.com，HttpWebResponse.CharacterSet 是 ISO-8859-1，我通过 GetEncoding 获得的编码是 {System.Text.Latin1Encoding}，它的正文名称中显示“ISO-8859-1”，以及 Content-在指定的 HTML 中键入 META 标记“charset=ISO-8859-1”。

我还在做错什么吗？
还是 GAP 做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:10:10.470

我相信 HttpWebResponse 具有 ContentEncoding 属性。在 StreamReader 的构造函数中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-14T21:07:32.150

Gap 的网站是错误的。具体问题是他们的页面声称使用了 Latin1 (ISO-8859-1) 的编码，而该页面使用的字符 #146 在 ISO-8859-1 中无效。

但是，该字符在 Windows CP-1252 编码（它是 ISO 8859-1 的超集）中有效。在 CP-1252 中，字符代码 #146 用于右引号字符。您将在今天 Gap.com 主页上的文本中的“您会发现小号和小号”中将其视为撇号。

你可以阅读[http://en.wikipedia.org/wiki/Windows-1252](http://en.wikipedia.org/wiki/Windows-1252)了解更多详情。事实证明，这种事情是最初以 CP-1252 编码保存内容的网页上的常见问题（例如，从 Word 复制/粘贴）。

故事的寓意：始终将国际化文本作为 Unicode 存储在您的数据库中，并始终在您的 Web 服务器上以 UTF8 格式发出 HTML！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T04:50:46.063

大牛，有些页面甚至没有返回值`CharacterSet`，所以这种方法不是那么可靠。有时甚至浏览器都无法“猜测”要使用哪种编码，所以我认为你不能进行 100% 的编码识别。

在我的特殊情况下，当我处理西班牙语或葡萄牙语页面时，我使用**UTF7**编码，它对我来说工作得很好（áéíóúñÑêã...等）。

可能您可以先加载一个 CharacterSet 代码表及其对应的 Encoding。如果 CharacterSet 为空，您可以提供默认编码。

构造函数中的`detectEncodingFromByteOrderMarks`参数`StreamReader`可能会有所帮助，因为它会自动检测或从第一个字节中推断出一些编码。

# c# - 包含泛型数组的对象的 GetHashCode 覆盖

> ID：638761
> 
> 赞同：61
> 
> 时间：2009-03-12T14:08:06.823
> 
> 标签：c#, arrays, generics, hashcode

我有一个包含以下两个属性的类：

```
public int Id      { get; private set; }
public T[] Values  { get; private set; } 
```

我已经做到`IEquatable<T>`并覆盖了`object.Equals`这样的：

```
public override bool Equals(object obj)
{
    return Equals(obj as SimpleTableRow<T>);
}

public bool Equals(SimpleTableRow<T> other)
{
    // Check for null
    if(ReferenceEquals(other, null))
        return false;

    // Check for same reference
    if(ReferenceEquals(this, other))
        return true;

    // Check for same Id and same Values
    return Id == other.Id && Values.SequenceEqual(other.Values);
} 
```

当有覆盖时，`object.Equals`我`GetHashCode`当然也必须覆盖。但是我应该实现什么代码？如何从通用数组中创建哈希码？以及如何将它与`Id`整数结合起来？

```
public override int GetHashCode()
{
    return // What?
} 
```

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-03-12T15:16:08.393

由于这个线程中提出的问题，我发布了另一个回复，显示如果你弄错了会发生什么......主要是你不能使用数组的`GetHashCode()`; 正确的行为是运行它时不会打印任何警告...切换评论以修复它：

```
using System;
using System.Collections.Generic;
using System.Linq;
static class Program
{
    static void Main()
    {
        // first and second are logically equivalent
        SimpleTableRow<int> first = new SimpleTableRow<int>(1, 2, 3, 4, 5, 6),
            second = new SimpleTableRow<int>(1, 2, 3, 4, 5, 6);

        if (first.Equals(second) && first.GetHashCode() != second.GetHashCode())
        { // proven Equals, but GetHashCode() disagrees
            Console.WriteLine("We have a problem");
        }
        HashSet<SimpleTableRow<int>> set = new HashSet<SimpleTableRow<int>>();
        set.Add(first);
        set.Add(second);
        // which confuses anything that uses hash algorithms
        if (set.Count != 1) Console.WriteLine("Yup, very bad indeed");
    }
}
class SimpleTableRow<T> : IEquatable<SimpleTableRow<T>>
{

    public SimpleTableRow(int id, params T[] values) {
        this.Id = id;
        this.Values = values;
    }
    public int Id { get; private set; }
    public T[] Values { get; private set; }

    public override int GetHashCode() // wrong
    {
        return Id.GetHashCode() ^ Values.GetHashCode();
    }
    /*
    public override int GetHashCode() // right
    {
        int hash = Id;
        if (Values != null)
        {
            hash = (hash * 17) + Values.Length;
            foreach (T t in Values)
            {
                hash *= 17;
                if (t != null) hash = hash + t.GetHashCode();
            }
        }
        return hash;
    }
    */
    public override bool Equals(object obj)
    {
        return Equals(obj as SimpleTableRow<T>);
    }
    public bool Equals(SimpleTableRow<T> other)
    {
        // Check for null
        if (ReferenceEquals(other, null))
            return false;

        // Check for same reference
        if (ReferenceEquals(this, other))
            return true;

        // Check for same Id and same Values
        return Id == other.Id && Values.SequenceEqual(other.Values);
    }
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-03-12T14:17:16.787

FWIW，在哈希码中使用值的内容是非常危险的。只有当你能保证它永远不会改变时，你才应该这样做。但是，由于它是暴露的，我认为不能保证它是可能的。对象的哈希码永远不应该改变。否则，它将失去其作为 Hashtable 或 Dictionary 中的键的值。考虑在 Hashtable 中使用对象作为键的难以发现的错误，它的 hashcode 由于外部影响而发生变化，您再也无法在 Hashtable 中找到它！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T14:19:25.003

由于 hashCode 有点像存储对象的键（就像在哈希表中一样），所以我只使用 Id.GetHashCode()

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T14:14:13.847

怎么样：

```
 public override int GetHashCode()
    {
        int hash = Id;
        if (Values != null)
        {
            hash = (hash * 17) + Values.Length;
            foreach (T t in Values)
            {
                hash *= 17;
                if (t != null) hash = hash + t.GetHashCode();
            }
        }
        return hash;
    } 
```

这应该与 兼容`SequenceEqual`，而不是对数组进行参考比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T14:12:18.437

```
public override int GetHashCode() {
   return Id.GetHashCode() ^ Values.GetHashCode();  
} 
```

* * *

评论和其他答案中有几个优点。如果将对象用作字典中的键，则 OP 应考虑是否将值用作“键”的一部分。如果是这样，那么它们应该是哈希码的一部分，否则，不是。

另一方面，我不确定为什么 GetHashCode 方法应该反映 SequenceEqual。它旨在计算哈希表中的索引，而不是完全相等的决定因素。如果使用上面的算法有很多哈希表冲突，并且如果它们的值的顺序不同，那么应该选择一个考虑顺序的算法。如果顺序并不重要，请节省时间并且不要考虑它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-21T16:26:14.967

我只需要添加另一个答案，因为没有提到一个更明显（并且最容易实现）的解决方案 - 不包括您的`GetHashCode`计算中的集合！

这里似乎忘记的主要事情是结果的唯一性`GetHashCode`不是必需的（或者在许多情况下甚至是可能的）。不相等的对象不必返回不相等的哈希码，唯一的要求是相等的对象返回相等的哈希码。因此，根据该定义，以下实现`GetHashCode`对所有对象都是正确的（假设有正确的`Equals`实现）：

```
public override int GetHashCode() 
{ 
    return 42; 
} 
```

当然，这会在哈希表查找中产生最差的性能，O(n) 而不是 O(1)，但它在功能上仍然是正确的。

`GetHashCode`考虑到这一点，对于碰巧具有任何类型的集合作为其一个或多个成员的对象，我的一般建议是简单地忽略它们并`GetHashCode`仅基于其他标量成员进行计算。这将非常有效，除非您将大量对象放入哈希表中，其中所有标量成员都具有相同的值，从而产生相同的哈希码。

尽管散列码值的分布减少，但在计算散列码时忽略集合成员也可以提高性能。请记住，使用哈希码应该通过不需要调用`Equals`N 次来提高哈希表的性能，而只需要调用一次 GetHashCode 并快速查找哈希表。如果每个对象都有一个包含 10,000 个项目的内部数组，这些项目都参与哈希码的计算，那么通过良好分布获得的任何好处都可能会丢失。**如果生成哈希码的成本要低得多，那么最好使用分布式哈希码。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T14:13:23.037

我会这样做：

```
long result = Id.GetHashCode();
foreach(T val in Values)
    result ^= val.GetHashCode();
return result; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T14:14:00.057

前提是 Id 和 Values 永远不会改变，并且 Values 不为空......

```
public override int GetHashCode()
{
  return Id ^ Values.GetHashCode();
} 
```

请注意，您的类不是不可变的，因为任何人都可以修改 Values 的内容，因为它是一个数组。鉴于此，我不会尝试使用其内容生成哈希码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-18T19:19:16.447

我知道这个线程很老了，但我写了这个方法来允许我计算多个对象的哈希码。这对这个案例非常有帮助。它并不完美，但它确实满足了我的需求，很可能也满足了你的需求。

我真的不能把它归功于它。我从一些 .net gethashcode 实现中得到了这个概念。我使用的是 419（毕竟，这是我最喜欢的大素数），但你可以选择任何合理的素数（不要太小……不要太大）。

所以，这是我获取哈希码的方法：

```
using System.Collections.Generic;
using System.Linq;

public static class HashCodeCalculator
{
    public static int CalculateHashCode(params object[] args)
    {
        return args.CalculateHashCode();
    }

    public static int CalculateHashCode(this IEnumerable<object> args)
    {
        if (args == null)
            return new object().GetHashCode();

        unchecked
        {
            return args.Aggregate(0, (current, next) => (current*419) ^ (next ?? new object()).GetHashCode());
        }
    }
} 
```

# canvas - Silverlight 2 的画布实用程序

> ID：638766
> 
> 赞同：0
> 
> 时间：2009-03-12T14:09:26.743
> 
> 标签：canvas, silverlight-2.0

为了节省我编写代码的时间，有人知道使用 Silverlight 画布的实用程序代码的来源吗？我正在考虑确定内容边界框、裁剪范围内的内容、轻松访问变换等的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-14T18:50:11.060

从缺乏回应来看，这要么不是其他人必须经常做的事情，要么真的没有任何东西可以满足要求。我咬紧牙关，开始为 Canvas 类编写自己的一组扩展方法，从 GetContentBounds 开始迭代画布的子项并返回内容边界矩形的边界 Rect。

# .net - asp.net net.mail - 在调试模式下将所有电子邮件路由到不同的电子邮件地址

> ID：638768
> 
> 赞同：3
> 
> 时间：2009-03-12T14:09:37.257
> 
> 标签：.net, asp.net, system.net.mail

`System.Web.HttpContext.Current.IsDebuggingEnabled`无论如何，如果是真的，所有电子邮件都会转到不同的地址吗？或者我需要一个新的类来在任何地方发送电子邮件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T14:19:30.340

我会设置一个 SMTP 服务器并让您的 webapp 将其用作其外发邮件服务器（在某种配置中指定）。对于生产站点，服务器会正​​常运行，但对于调试，您可以配置 SMTP 服务器以将所有邮件路由到您选择的地址。这具有根本不更改您的应用程序的优点，如果更改行为可以防止发生您试图重现的错误等，这可能很有用。我的公司使用这种方法进行质量检查并且效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:14:08.947

你可以把它放在你使用它的任何地方的代码中：

```
if (System.Web.HttpContext.Current.IsDebuggingEnabled)
{
 mail.To = "debug@debug.com";
}
else
{
 mail.To = recipientAddress;
} 
```

或者只是为获取电子邮件地址构建一个简单的包装器（即使是收件人地址的方法的 getter 中的某些东西也可以），或者为整个 smtpclient 或 mailmessage 类构建一个包装器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T14:25:58.497

老实说，我用好旧的

```
#if DEBUG
    Mail.To("debug@debugaddress.com");
#else
    Mail.To("actualrecipient@destinationaddress.com");
#endif 
```

为了阻止我在生产应用程序中浮动调试代码。我用于数据库访问的一种方法是使用 dns 条目，即 database1.domain.com，在我的开发机器上的主机文件中它指向我的本地系统，在我的生产机器上它指向数据库服务器。您可以使用类似的东西来拥有一个调试邮件服务器和一个生产邮件服务器，但与上面的第一个解决方案相比，它似乎有点过分了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T14:14:56.170

我认为处理这个问题的最好方法是通过邮件客户端的代理类。创建代理类时，使用参数指示是否在调试模式下运行。让代理支持与邮件客户端相同的接口，但在调试模式下运行时静默替换外发电子邮件地址。

```
public class MailProxy
{
     private bool IsDebug { get; set; }
     private string DebugAddress { get; set; }
     private SmtpClient Client { get; set; }

     public MailProxy( SmtpClient client,
                       bool debugging,
                       string debugAddress )
     {
         this.IsDebug = debugging;
         this.DebugAddress = debugAddress;
     }

     public void Send( MailMessage message )
     {
         if (this.IsDebug)
         {
             message.To = new MailAddress(this.DebugAddress);
         }
         this.Client.Send( message );
     }

     ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T14:42:21.453

我们使用与 tvanfosson 详述的 MailProxy 方法类似的解决方案。然而，我们有一些我觉得值得一提的差异。第一个是我们在开发或测试环境中简单地扩展 SmtpClient 类并覆盖 Send 方法。我们使用配置文件来确定环境。然后我们在需要发送电子邮件的任何时候使用这个类。此类将确定谁当前登录到应用程序，并将生成的所有电子邮件重定向到他们，如果登录用户由于某种原因不可用，则故障转移到标准收件人列表。如果您有几个人正在测试或开发，这会有所帮助，因为他们只会收到他们生成的电子邮件。我们还将邮件的原始收件人添加到邮件正文中。这在测试工作流类型消息以确保它们发送给正确的个人时再次很有用。最后，我发现在邮件主题中添加 [DEV] 或 [QA] 标记很有用，这样我就可以在我的邮件客户端中设置一个规则来处理所有测试邮件。

# asp.net - 如何有效地将大 XML 发送到 ASP.NET 中的客户端？

> ID：638791
> 
> 赞同：3
> 
> 时间：2009-03-12T14:13:31.053
> 
> 标签：asp.net, xml

例如，我们有一些 IHttpHandler。我们有两个变量： XmlElement xmlResponse - 包含一个非常大的 XML。HttpContext 上下文 - 当前的 HttpContext。

简单的解决方案：

```
context.Response.Write(xmlResponse.OwnerDocument.OuterXml); 
```

但是当 XML 真的很大时，我们可以在该行得到 OutOfMemoryException。调用堆栈将如下所示：

```
 at System.String.GetStringForStringBuilder(String value, Int32 startIndex, Int32 length, Int32 capacity)
   at System.Text.StringBuilder.GetNewString(String currentString, Int32 requiredLength)
   at System.Text.StringBuilder.Append(Char value)
   at System.IO.StringWriter.Write(Char value)
   at System.Xml.XmlTextWriter.InternalWriteEndElement(Boolean longFormat)
   at System.Xml.XmlTextWriter.WriteFullEndElement()
   at System.Xml.XmlElement.WriteTo(XmlWriter w)
   at System.Xml.XmlElement.WriteContentTo(XmlWriter w)
   at System.Xml.XmlElement.WriteTo(XmlWriter w)
   at System.Xml.XmlElement.WriteContentTo(XmlWriter w)
   at System.Xml.XmlElement.WriteTo(XmlWriter w)
   at System.Xml.XmlDocument.WriteContentTo(XmlWriter xw)
   at System.Xml.XmlDocument.WriteTo(XmlWriter w)
   at System.Xml.XmlNode.get_OuterXml() 
```

我会写一些这样的代码：

```
HttpWriter writer = new HttpWriter(context.Response);
XmlTextWriter xmlWriter = new XmlTextWriter(writer);
xmlResponse.OwnerDocument.WriteTo(xmlWriter); 
```

但是一个问题是HttpWriter的构造函数是内部的！HttpContext 在 Write 方法内部使用 HttpWriter。

存在哪些解决方法（通过反射创建 HttpWriter 除外）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:22:09.800

我会直接流式传输到 response.OutputStream

```
XmlTextWriter writer = new XmlTextWriter(Response.OutputStream, 
System.Text.Encoding.UTF8); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T14:19:36.733

```
xmlResponse.OwnerDocument.Save(Response.Output); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:20:53.050

您可以通过读取文件几行然后将内容刷新、重复和冲洗来创建缓冲区。这可以让你通过 OutOfMemory 异常，或者应该。

但如果这些是巨大的 XML 文件，使用 HttpResponse 和“写入”并不是最好的选择。最好创建和链接并允许 .NET 响应对象以外的其他对象将文件传递给用户。因此，我会认真考虑重新考虑您正在设计的架构。也许文件传输网络服务可能更好地传输这些大文件？只是想发表一些想法。

我在这里错过了什么吗？

# c# - 如何在 XML-RPC 和 C# 中使用枚举？

> ID：638799
> 
> 赞同：1
> 
> 时间：2009-03-12T14:15:46.837
> 
> 标签：c#, xml-rpc, enumeration

我在 C# 中使用 Cook Computing XMLRPC 框架。我正在调用一个需要 int 的远程函数。我想在客户端代码中使用枚举，而不是仅使用函数参数中硬编码的数字调用函数。

代码编译成功，但在测试期间抛出 XmlRpcUnsupportedTypeException。该消息指出我的枚举无法映射到 XML-RPC 类型。枚举如下：

```
public enum Codes : int
{
    Installed = 903,
} 
```

我有一种感觉，我忽略了一些简单的东西，但我无法将手指放在它上面，所以我在这里将我的蝙蝠信号发射到云端！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:24:31.450

尝试过显式转换？(int)已安装

MSDN：

> 基础类型指定为每个枚举器分配多少存储空间。但是，从枚举类型转换为整数类型需要显式强制转换。例如，以下语句将枚举器 Sun 分配给 int 类型的变量，方法是使用强制转换从 enum 转换为 int：
> 
> int x = (int)Days.Sun;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:25:36.970

您必须将其显式转换为 int：

```
int code = Codes.Installed; // doesn't work.
int code = (int) Codes.Installed; // works. 
```

# php - Outlook 风格的规则引擎

> ID：638801
> 
> 赞同：2
> 
> 时间：2009-03-12T14:16:32.937
> 
> 标签：php, oop, rule-engine

我正在尝试构建一个基于规则的系统来解释数据。但是，我在决定如何构建存储和解释规则的逻辑时遇到问题。

目前，有一个相当复杂的数据库结构，但会处理存储规则数据的各个方面。这个想法是系统将能够模仿 MS Outlook 允许用户添加规则的方式。

我的问题如下：

1.  我应该使用什么模式将这些规则存储在对象中？
2.  我应该使用 eval() 还是正确的面向对象来执行规则？

示例规则可能是：

> 狗在地区**公园****必须有项圈**

 **其中每个元素（狗、必须拥有、项圈、区域、公园）都是要解释的单独逻辑。

非常感谢对上述问题的任何一般性建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T14:31:15.957

我从来没有在“现实世界”环境中实现过像你描述的系统，但我已经和他们一起玩了相当多的业余项目。我首选的方法是使用某种逻辑语言（如[Prolog](http://en.wikipedia.org/wiki/Prolog)）来进行断言并检查它们。你会断言公园在哪里，拥有什么意味着什么，狗是什么，然后你会制定一个规则，就像你帖子底部括号中的例子一样。很抱歉，我的 Prolog 太生疏了，无法给你一个有用的例子……我玩本土推理语言太久了。

有可用于嵌入大多数语言的 Prolog 解释器，但我不确定 PHP5。如果您找不到 Prolog 解释器，您可以拼凑一些简单的东西，在相当短的时间内对您自己创建的规则数据结构进行[前向链接推理。](http://en.wikipedia.org/wiki/Forward_chaining)您可能对这些关于自动推理的[说明感兴趣。](http://pages.cs.wisc.edu/~dyer/cs540/notes/fopc.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T15:15:00.033

可能这个答案对你来说太微不足道/太明显了，但我只是想如何在我当前现有的项目中解决类似的问题，这是一个 Zend Framework 应用程序。我想到了 ZF 使用的过滤器和验证器链。我假设您有有限数量的可能输入对象、有限数量的条件/约束和有限数量的操作。在这种情况下，您将首先实例化一个对象并针对一系列条件（验证器）运行它，如果满足所有条件，您将针对 actionChain 运行该对象。在这里，我可能必须实施某种行动优先系统，因为某些行动必须先于其他行动执行。就像“发送通知”然后“删除”有问题的对象。因此，在 ZF 中，我将为每个条件/约束构建一个自定义验证器。我不

在数据库中可能有一个实际规则表，一个用于条件，一个用于操作。然后可能有两个多对多表将规则与所有需要的条件和操作链接起来。

# bash - bash 变量中的标记数

> ID：638802
> 
> 赞同：30
> 
> 时间：2009-03-12T14:16:39.737
> 
> 标签：bash, split

我如何知道 bash 变量（空格分隔的标记）中的标记数量 - 或者至少，它是一个还是更多。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-12T14:29:17.960

$# 扩展将告诉您变量/数组中的元素数量。如果您使用的 bash 版本高于 2.05 左右，您可以：

```
VAR='some string with words'
VAR=( $VAR )
echo ${#VAR[@]} 
```

这有效地将字符串沿空格（这是默认分隔符）拆分为一个数组，然后计算数组的成员。

编辑：

当然，这会将变量重新转换为数组。如果您不想这样，请使用不同的变量名或将变量重新转换为字符串：

```
VAR="${VAR[*]}" 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-08-11T20:55:26.307

我不明白为什么人们一直在使用那些过于复杂的 bashism。几乎总是有一个直截了当的、不拘泥的解决方案。

```
howmany() { echo $#; }
myvar="I am your var"
howmany $myvar 
```

这使用了 shell 内置的标记器，因此没有差异。

这是一个相关的问题：

```
myvar='*'
echo $myvar
echo "$myvar"
set -f
echo $myvar
echo "$myvar" 
```

请注意，@guns 使用 bash 数组的解决方案具有相同的问题。

以下是解决问题的（据说）超级强大的版本：

```
howmany() ( set -f; set -- $1; echo $# ) 
```

如果我们想避免使用 subshel​​l，事情就会变得丑陋

```
howmany() {
    case $- in *f*) set -- $1;; *) set -f; set -- $1; set +f;; esac
    echo $#
} 
```

这两个必须使用 WITH 引号，例如`howmany "one two three"`返回`3`

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-12T14:25:31.510

```
set VAR='hello world'
echo $VAR | wc -w 
```

这是您可以检查的方法。

```
if [ `echo $VAR | wc -w` -gt 1 ] 
then
    echo "Hello"
fi 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T14:27:49.990

简单方法：

```
$ VAR="a b c d"
$ set $VAR
$ echo $#
4 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-03T23:37:10.843

计算：

```
sentence="This is a sentence, please count the words in me."
words="${sentence//[^\ ]} "
echo ${#words} 
```

去检查：

```
sentence1="Two words"
sentence2="One"
[[ "$sentence1" =~ [\ ] ]] && echo "sentence1 has more than one word"
[[ "$sentence2" =~ [\ ] ]] && echo "sentence2 has more than one word" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-02T04:42:05.403

有关强大、*可移植* `sh`的解决方案，请参阅[@JoSo 的函数](https://stackoverflow.com/a/11917591/45375)，使用`set -f`.

（用于回答（仅）“是否有至少 1 个空格？”问题的简单 bash-only 解决方案；注意：也将匹配前导和尾随空格，与`awk`下面的解决方案不同：

```
 [[ $v =~ [[:space:]] ]] && echo "\$v has at least 1 whitespace char." 
```

)

这是一个基于健壮`awk`的 bash 解决方案（由于调用外部实用程序而效率较低，但在许多实际场景中可能无关紧要）：

```
# Functions - pass in a quoted variable reference as the only argument.
# Takes advantage of `awk` splitting each input line into individual tokens by
# whitespace; `NF` represents the number of tokens.
# `-v RS=$'\3'` ensures that even multiline input is treated as a single input 
# string.
countTokens() { awk -v RS=$'\3' '{print NF}' <<<"$1"; }
hasMultipleTokens() { awk -v RS=$'\3' '{if(NF>1) ec=0; else ec=1; exit ec}' <<<"$1"; }

# Example: Note the use of glob `*` to demonstrate that it is not 
# accidentally expanded.
v='I am *'

echo "\$v has $(countTokens "$v") token(s)."

if hasMultipleTokens "$v"; then
  echo "\$v has multiple tokens."
else
  echo "\$v has just 1 token."
fi 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-12T14:23:59.190

不确定这是否正是您的意思，但是：

`$#`= 传递给 bash 脚本的参数数量

否则你可能正在寻找类似的东西[`man wc`](http://unixhelp.ed.ac.uk/CGI/man-cgi?wc)

# winapi - COM 库的命名约定是什么？我什么时候选择 .ocx、.oca、.tlb、.olb？

> ID：638803
> 
> 赞同：1
> 
> 时间：2009-03-12T14:17:03.823
> 
> 标签：winapi, com, activex

**编辑**：由于我的问题的原始措辞引起了很多皱眉，我重新措辞。很抱歉造成混乱。

到目前为止，我所有的 COM DLL 都具有扩展名 .dll，但我认为对此有一些规则。我知道有 .ocx、.oca、.tlb 和 .olb 文件。我知道这些文件都包含“COM 东西”，但究竟是什么？

*   这些文件通常是什么：.ocx、.oca、.tlb、.olb？
*   OLB 和 TLB 有什么区别？
*   TLB和OCX有什么区别？
*   .ocx 和 .oca 有什么区别？
*   我应该何时将我的库命名为 .ocx 以及何时命名为 .tlb？如果它们包含某种特征？
*   我的库必须使用特定扩展名的哪些属性？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T14:20:24.923

*   **.ocx**
    *   ActiveX 控件
*   **.oca**
    *   与 .ocx 一起使用的扩展类型库/自定义控件缓存文件
*   **.tlb**
    *   包含其关联 COM 库中包含的 COM 接口和类型的定义。它是一个跨语言的“头文件”。
*   **.olb**
    *   包含 Microsoft Office 组件引用的信息的 Microsoft 对象库文件。

# java - 如何在 JTable 中拖放一行？

> ID：638807
> 
> 赞同：34
> 
> 时间：2009-03-12T14:18:50.230
> 
> 标签：java, swing, drag-and-drop, jtable, mouse

如何设置 JTable 以便能够将行拖动到表中的不同索引。例如，如果我有 5 行并且我想将第 4 行拖到第 2 位？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2011-01-22T18:05:31.983

以下允许 JTable 对单个拖动行重新排序：

```
 table.setDragEnabled(true);
  table.setDropMode(DropMode.INSERT_ROWS);
  table.setTransferHandler(new TableRowTransferHandler(table)); 
```

您的 TableModel 应实现以下内容以允许重新排序：

```
public interface Reorderable {
   public void reorder(int fromIndex, int toIndex);
} 
```

这个 TransferHandler 类处理拖放，并在手势完成时调用 TableModel 上的 reorder()。

```
/**
 * Handles drag & drop row reordering
 */
public class TableRowTransferHandler extends TransferHandler {
   private final DataFlavor localObjectFlavor = new ActivationDataFlavor(Integer.class, "application/x-java-Integer;class=java.lang.Integer", "Integer Row Index");
   private JTable           table             = null;

   public TableRowTransferHandler(JTable table) {
      this.table = table;
   }

   @Override
   protected Transferable createTransferable(JComponent c) {
      assert (c == table);
      return new DataHandler(new Integer(table.getSelectedRow()), localObjectFlavor.getMimeType());
   }

   @Override
   public boolean canImport(TransferHandler.TransferSupport info) {
      boolean b = info.getComponent() == table && info.isDrop() && info.isDataFlavorSupported(localObjectFlavor);
      table.setCursor(b ? DragSource.DefaultMoveDrop : DragSource.DefaultMoveNoDrop);
      return b;
   }

   @Override
   public int getSourceActions(JComponent c) {
      return TransferHandler.COPY_OR_MOVE;
   }

   @Override
   public boolean importData(TransferHandler.TransferSupport info) {
      JTable target = (JTable) info.getComponent();
      JTable.DropLocation dl = (JTable.DropLocation) info.getDropLocation();
      int index = dl.getRow();
      int max = table.getModel().getRowCount();
      if (index < 0 || index > max)
         index = max;
      target.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
      try {
         Integer rowFrom = (Integer) info.getTransferable().getTransferData(localObjectFlavor);
         if (rowFrom != -1 && rowFrom != index) {
            ((Reorderable)table.getModel()).reorder(rowFrom, index);
            if (index > rowFrom)
               index--;
            target.getSelectionModel().addSelectionInterval(index, index);
            return true;
         }
      } catch (Exception e) {
         e.printStackTrace();
      }
      return false;
   }

   @Override
   protected void exportDone(JComponent c, Transferable t, int act) {
      if ((act == TransferHandler.MOVE) || (act == TransferHandler.NONE)) {
         table.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
      }
   }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T23:51:44.873

查看 Java 教程的[拖放](http://java.sun.com/docs/books/tutorial/uiswing/dnd/index.html)部分。有一些关于如何为`JTable`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-22T14:48:41.290

我喜欢 Soley 的修改，但他的代码依赖于外部库，我不确定他是从哪里得到的，所以我重新编写了它，这样你就不需要 TableUtil 类了……

```
 @Override
   public boolean importData(TransferHandler.TransferSupport info) {
     JTable target = (JTable) info.getComponent();
        JTable.DropLocation dl = (JTable.DropLocation) info.getDropLocation();
        int index = dl.getRow();
        int max = table.getModel().getRowCount();
        if (index < 0 || index > max) {
            index = max;
        }
        target.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));

        try {
            Integer rowFrom = (Integer) info.getTransferable().getTransferData(localObjectFlavor);
            if (rowFrom != -1 && rowFrom != index) {

                int[] rows = table.getSelectedRows();
                int iter = 0;
                for (int row : rows) {
                    if (index > row) {
                        index--;
                        ((Reorderable) table.getModel()).reorder(row - iter, index);
                    }

                    else {
                        ((Reorderable) table.getModel()).reorder(row, index);
                    }
                    index++;
                    iter++;
                }

                target.getSelectionModel().addSelectionInterval(index, index);

                return true;
            }

      } catch (Exception e) {
            String error = e.getMessage();
            JOptionPane.showMessageDialog(null, error, "Error", JOptionPane.ERROR_MESSAGE);
      }
      return false;
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T08:46:33.160

也许…… 像这样：

```
 table.addMouseMotionListener(new MouseMotionListener() {
    public void mouseDragged(MouseEvent e) {
        e.consume();
        JComponent c = (JComponent) e.getSource();
        TransferHandler handler = c.getTransferHandler();
        handler.exportAsDrag(c, e, TransferHandler.MOVE);
    }

    public void mouseMoved(MouseEvent e) {
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-05T19:28:03.757

仅用于记录和多行重新排序：

在某处使用......

```
 JTable table = t_objects;
    table.setDragEnabled(true);
    table.setDropMode(DropMode.INSERT_ROWS);
    table.setTransferHandler(new TableRowTransferHandler(table)); 
```

这是上述答案中的主要类，我对其进行了修改以匹配多行 DnD 的需求。我所做的只是使用第一个选定的行，然后计算放置位置上方的行。删除选定的项目并将它们保存在对象列表中（行数组对象）。然后将它们插入回计算行。最后选择删除/拖动的行以完成该过程。

```
public class TableRowTransferHandler extends TransferHandler {

    private final DataFlavor localObjectFlavor = new DataFlavor(Integer.class, "Integer Row Index");
    private JTable table = null;

    public TableRowTransferHandler(JTable table) {
        this.table = table;
    }

    @Override
    protected Transferable createTransferable(JComponent c) {
        assert (c == table);
        return new DataHandler(new Integer(table.getSelectedRow()), localObjectFlavor.getMimeType());
    }

    @Override
    public boolean canImport(TransferHandler.TransferSupport info) {
        boolean b = info.getComponent() == table && info.isDrop() && info.isDataFlavorSupported(localObjectFlavor);
        table.setCursor(b ? DragSource.DefaultMoveDrop : DragSource.DefaultMoveNoDrop);
        return b;
    }

    @Override
    public int getSourceActions(JComponent c) {
        return TransferHandler.COPY_OR_MOVE;
    }

    @Override
    public boolean importData(TransferHandler.TransferSupport info) {
        JTable target = (JTable) info.getComponent();
        JTable.DropLocation dl = (JTable.DropLocation) info.getDropLocation();
        int index = dl.getRow();
        int max = table.getModel().getRowCount();
        if (index < 0 || index > max) {
            index = max;
        }
        target.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));

        try {
            Integer rowFrom = (Integer) info.getTransferable().getTransferData(localObjectFlavor);
            if (rowFrom != -1 && rowFrom != index) {

                int[] rows = table.getSelectedRows();
                int dist = 0;
                for (int row : rows) {
                    if (index > row) {
                        dist++;
                    }
                }
                index -= dist;

                //**TableUtil** is a simple class that just copy, remove and select rows.

                ArrayList<Object> list = TableUtil.getSelectedList(table);
                TableUtil.removeSelected(table);
                ArrayList<Integer> sels = new ArrayList<Integer>();
                for (Object obj : list) {
                    sels.add(index);
                    TableUtil.addRowAt(table, obj, index++);
                }
                TableUtil.selectMultipleRow(table, sels);

                return true;
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return false;
    }

    @Override
    protected void exportDone(JComponent c, Transferable t, int act) {
        if (act == TransferHandler.MOVE) {
            table.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
        }
    }
} 
```

# .net - ActiveX Cab 文件代码库#Version 未正确更新 CAB

> ID：638813
> 
> 赞同：2
> 
> 时间：2009-03-12T14:20:20.710
> 
> 标签：.net, asp.net, activex

好的，我作为最后的手段来到这里，希望有人知道这个问题的答案，在新闻组中没有答案，我已经做了我知道该怎么做的一切，除了我想避免的严重黑客解决方案。

情况如下：

我有一个 COM 公开的 .NET 类库。我将它包装到一个 CAB 文件中，并使用 Object 标记将其嵌入到页面中。在 CODEBASE 属性上，我将其指向 cab 文件并添加一个类似“CODEBASE="cabfiles\mycab.cab#version=30.0.0.1" 的版本

问题：

因此，因为这是一个暴露给 COM 的 .NET dll，所以它使用 inprocServer32 注册表项注册它，该注册表项指向 mscoree.dll，版本为 2.0.50727，这是有道理的，因为 .NET com 对象在该进程和 2.0 下运行。 50727 是那个 dll 的版本。但这破坏了 OBJECT 标记上 CODEBASE 属性的版本属性。

我设置的任何大于 2.0.50727 的版本都将下载重新安装 cab 文件的内容。

我尝试更改注册表设置和值以及一大堆东西，但找不到解决方案。

所以有人知道这个问题的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-05T18:02:44.490

安装 cab 后，您需要更新注册表项：

> HKCR/CLSID/{GUID}/InstalledVersion/（默认）

*   {GUID} 是您的对象的类 ID
*   该值是在您的 Html 元素中指定的字符串（上面的“30.0.0.1”）。

Windows 在使用 dll（在您的情况下为 mscoree.dll）之前会检查几个注册表位置。上面的位置是为每个系统（HKCR）安装一些东西，你也可以为每个用户安装它。选择以下位置之一来放置您的版本字符串。按列出的顺序检查位置。

1.  HKCU/CLSID/{GUID}/AvailableVersion/（默认）
2.  HKCR/CLSID/{GUID}/AvailableVersion/（默认）
3.  HKCU/CLSID/{GUID}/InstalledVersion/（默认）
4.  HKCR/CLSID/{GUID}/InstalledVersion/（默认）
5.  您的组装

如果 regasm 为您解决这个问题，那就太好了，但事实并非如此。您需要在安装程序中手动设置它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-03T16:14:49.437

此外，您需要使用逗号作为版本号：

"CODEBASE="cabfiles\mycab.cab#version=30,0,0,1"

# css - IE 中更大的字体 - 在 FF 中很好

> ID：638824
> 
> 赞同：0
> 
> 时间：2009-03-12T14:22:32.563
> 
> 标签：css, internet-explorer

在此页面上：[http](http://catonthecouchproductions.com/fish/fishing-trips.html) ://catonthecouchproductions.com/fish/fishing-trips.html在 IE 中的字体要大得多，并且正在切断页面。我有一个简单的：

```
<!--[if IE 7]>
<style type="text/css" media="all">.borderitem {
border-style:solid;
}
p.trip-includes-text,ul li{
font-size:10px;
}
p.about-text{
font-size:11px;
}
</style>
<![endif]--> 
```

如果有条件更改字体，但我无法更改。除了左下角的包含框外，它也被剪掉了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T14:26:27.420

这不是字体，而是包含 IE 更改的文本的框的大小。我以前有过这个并且使盒子更大（带有边距或填充）使它可以正常工作。

# multithreading - Delphi：后台线程中的 TWebBrowser

> ID：638825
> 
> 赞同：3
> 
> 时间：2009-03-12T14:22:36.587
> 
> 标签：multithreading, delphi, browser

是否可以在后台线程中的 TWebBrowser 中加载网页？

当应用程序加载时，我想从 web 下载一个页面到 TWebBrowser，但我不想阻止 gui 线程。

有什么建议么？

**一些澄清：**
webbrowser-component 生活在一个表单上，我想显示来自网络的页面。但我想在后台线程中完成该页面的所有下载，以便加载沉重的页面不会阻塞 gui 线程。

我想我有能力写一般的线程。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T15:22:07.523

`TWebBrowser` **已经**在单独的线程中下载了东西。您的程序在下载时应该已经保持响应。您可以看到这一点，因为一种常见的模式是设置 URL，然后等待下载完成：

```
WebBrowser1.Navigate(...);
while WebBrowser1.Busy do
  Application.ProcessMessages; 
```

使用`ProcessMessages`，所以我不能真诚地推荐它。要在下载完成时收到通知，而不是像该代码那样轮询，而是处理控件的`OnNavigateComplete2`事件。请注意，可能会为框架和主页触发该事件。

如果您想*显示*页面，那么您的`TWebBrowser`控件无论如何都不应该位于单独的线程中，因为它与 VCL 使用的任何其他控件都属于相同的规则。如果您只是使用控件来*下载*页面，那么`TWebBrowser`可能是矫枉过正。您可以使用 Indy，或操作系统的内置文件下载功能。这些可以很容易地在单独的线程中使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T15:55:55.717

我也需要同样的东西（制作页面的自动屏幕截图），我从 Rob 的代码开始。它不适用于我正在加载的页面.. 有一半的时间没有设置繁忙标志，而显然页面还没有完成。

经过一些研究，这似乎有效：

```
while (webBrowser1.ReadyState <>  READYSTATE_COMPLETE) do
  Application.ProcessMessages; 
```

其中 readystate 是以下之一：

```
const READYSTATE_UNINITIALIZED = 0; // Default initialisation state.
const READYSTATE_LOADING = 1; // Object is currently loading data.
const READYSTATE_LOADED = 2; // Object has been initialised.
const READYSTATE_INTERACTIVE = 3; // User can interact with the object but loading has not yet finished.
const READYSTATE_COMPLETE = 4; // All of the object's data has been loaded. 
```

* * *

使用 readystate 的想法来自这里： [http://gaskell.org/making-the-webbrowser-control-synchronous/](http://gaskell.org/making-the-webbrowser-control-synchronous/)

readystate delphi 常量取自这里： [http ://www.cryer.co.uk/brian/delphi/twebbrowser/twebbrowser_properties.htm](http://www.cryer.co.uk/brian/delphi/twebbrowser/twebbrowser_properties.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T15:15:22.840

我不得不说我从未尝试过类似的东西，但我认为你会遇到问题。

您可以在一个进程中拥有多个线程，所有线程都实现消息循环并为该线程的窗口处理消息，但所有窗口都与创建它们的线程相关联。Windows 消息将始终在创建窗口的线程中处理。因此，您可能能够从另一个线程中调用嵌入式 TWebBrowser 控件的方法，但是由于这将涉及向 Web 浏览器窗口发送消息，因此它们仍然会在您的 GUI 线程中处理。

有关更多信息，请查看有关[COM 中的线程](http://en.wikipedia.org/wiki/Component_Object_Model#Threading_in_COM)的 Wikipedia 文章以及 Raymond Chen 关于 STA 的博客文章，例如[这个](http://blogs.msdn.com/oldnewthing/archive/2008/04/24/8420242.aspx)。

# .net - 从 SharePoint 工作流运行 Word

> ID：638827
> 
> 赞同：0
> 
> 时间：2009-03-12T14:23:03.230
> 
> 标签：.net, sharepoint, interop, workflow, ms-word

基于[加入 MS Word 文档](https://stackoverflow.com/questions/630449/join-ms-word-documents)，我制作了一个控制台应用程序，可以将多个 word 文件拼接成一个。现在我想从 SharePoint 中的工作流中执行相同的操作。简而言之，我在失败之前的代码如下所示：

```
object oMissing = System.Reflection.Missing.Value;
Microsoft.Office.Interop.Word.ApplicationClass oWord = new Microsoft.Office.Interop.Word.ApplicationClass();
Microsoft.Office.Interop.Word._Document oDoc = null;
oWord.Visible = false;
Microsoft.Office.Interop.Word.Documents oDocs = oWord.Documents;
object oFile = tmpFileName;
oDoc = oDocs.Add(ref oMissing, ref oMissing, ref oMissing, ref oMissing);
oDoc.Activate(); 
```

当我到达 oDoc.Activate() 时，我抛出了以下异常，即使我只有一个工作流实例正在运行并且服务器上没有其他 Word 实例正在运行：

消息过滤器指示应用程序正忙。（来自 HRESULT 的异常：0x8001010A (RPC_E_SERVERCALL_RETRYLATER)）

为什么我会收到这个错误？？什么会使应用程序忙碌？

干杯

尼克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T14:26:31.663

Office 应用程序不是为在服务器环境中运行而构建的——它们是纯粹的桌面应用程序。不要从服务器调用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:34:16.293

如果它们是 Word 2007 文档，我认为您应该查看 Word 文件格式并查看 Microsoft 的文章是否有帮助：

[http://msdn.microsoft.com/en-us/library/bb656295.aspx](http://msdn.microsoft.com/en-us/library/bb656295.aspx)

Office Interop 总是有点不稳定，在服务器上运行它是我建议的最后一件事，除非真的没有其他方法可以做到这一点。

在 Sharepoint 环境中，[文档转换器](http://msdn.microsoft.com/en-us/library/ms518493.aspx)可能会有所帮助，尽管我没有使用它们的经验 - 只是作为一些要查看的东西的提示。

# c# - 在不先检查 InvokeRequired 的情况下更新 UI 时出现性能问题？

> ID：638828
> 
> 赞同：2
> 
> 时间：2009-03-12T14:23:52.433
> 
> 标签：c#, winforms, performance, user-interface

我变得有点懒惰（有时很好），并通过调用回调而不先检查*InvokeRequired*来开始更新 WinForms UI 。

是否有我应该注意的性能问题或注意事项？

```
 private delegate void SetStatusEventHandler(string statusMessage);
    private void SetStatus(string statusMessage)
    {
        Invoke((MethodInvoker) (() =>
        {
            resultLabel.Text = statusMessage;
        }));

        //  - vs -

        if (InvokeRequired)
        {
            SetStatusEventHandler cb = SetStatus;
            Invoke(cb, statusMessage);
        }
        else
        {
            resultLabel.Text = statusMessage;
        }
    } 
```

***[编辑]***：大多数情况下，调用“调用”的方法最多会被调用，比如每秒 10~20 次，中间间隔很宽。

***[更新]***采用以下扩展方法解决

```
public static class SmartInvoker
{
    public static void InvokeHandler(this Control control, MethodInvoker del)
    {
        if (control.InvokeRequired)
        {
            control.Invoke(del);
            return;
        }
        del();
    }
}

...

    private void SetStatus(string statusMessage)
    {
        this.InvokeHandler(() => resultLabel.Text = statusMessage);
    } 
```

我想找出如何管理扩展方法类是我需要深入研究的另一个主题。谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T14:27:01.053

编辑：请参阅有关整个帖子与立即发送恶意软件的辩论评论。

无论哪种方式，我的答案实际上是相同的：除非这种情况*经常*不必要地发生（即大部分时间你都在 UI 线程上开始，并且它连接到鼠标移动处理程序之类的东西）我不会担心. 它确实使代码更简单。如果*要*经常调用它，我会测量和测试更多:)

`Invoke`与一个`EventHandler`或`MethodInvoker`委托比与其他人更快。我不知道两者之间是否有任何区别-您可能需要检查一下。

您可以通过编写扩展方法使这更简单，例如

```
public static void InvokeHandler(this Control control, MethodInvoker handler)
{
     control.Invoke(handler);
} 
```

然后你可以制作你的代码：

```
private void SetStatus(string statusMessage)
{
    this.InvokeHandler(delegate
    {
        resultLabel.Text = statusMessage;
    });
} 
```

或者

```
private void SetStatus(string statusMessage)
{
    InvokeHandler(() => resultLabel.Text = statusMessage);
} 
```

这样您就不需要指定委托类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T14:27:52.813

为什么不直接添加一个扩展方法，这样您就不必再考虑它了？

```
public static object SmartInvoke(this Control control, MethodInvoker del) {
  if ( control.InvokeRequired ) {
    control.Invoke(del);
    return;
  }
  del();
} 
```

现在你的代码变成了

```
private void SetStatus(string statusMessage) {
  this.SmartInvoke(() => resultLabel.Text = statusMessage);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:28:09.630

I believe it just prevents an unnecessary post if you're already on the same thread. So if that would be the most common scenario (being on the correct thread), it might cause a small performance hit by not checking, but I dont believe its actually required.

# dynamics-crm - 将活动链接到 CRM 4.0 中的帐户

> ID：638832
> 
> 赞同：0
> 
> 时间：2009-03-12T14:24:46.393
> 
> 标签：dynamics-crm, dynamics-crm-4

我正在使用 CRM 4.0 Web 服务界面开发应用程序，需要以编程方式创建电话记录并将其链接到帐户记录。我可以看到如何创建记录，但我不确定如何将电话链接到帐户。任何帮助将非常感激。

谢谢

奈杰尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T14:35:18.507

您不能将活动（如电话）直接链接到实体（如帐户）。您必须使用 activityparty 对象来执行此操作。
要做到这一点，请按照以下步骤操作（我假设该帐户存在）：

```
 phonecall newPhoneCall = new phonecall ();

        // Set the properties of the newPhoneCall.
        newPhoneCall.subject = "Test newPhoneCall";
        newPhoneCall.description = "New newPhoneCall";

        // Create the party sending and receiving the newPhoneCall.
        activityparty party = new activityparty();

        // Set the properties of Activityparty.
        party.partyid = new Lookup();
        party.partyid.type = EntityName.account.ToString();
        party.partyid.Value = existingAccount.accountId;

        // The party sends and receives the newPhoneCall.
        newPhoneCall.from = new activityparty[] { };
        newPhoneCall.to = new activityparty[] { party }; 
```

然后像往常一样创建电话呼叫活动。

# git - 颠覆：暂存文件明确提交？

> ID：638834
> 
> 赞同：5
> 
> 时间：2009-03-12T14:25:17.360
> 
> 标签：git, svn, commit

我已经非常习惯 git 必须触摸您要提交的每个文件的方式，并且在执行此操作时，请仔细检查差异。现在在工作中我必须使用 svn，而且我一直在不经意地提交一些东西。有没有办法让 subversion 表现得像 git，因为我必须明确告诉每个文件应该包含在下一次提交中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T14:41:33.750

另一种方法是在工作中使用 git-svn 桥接器，除非有理由说明你不能这样做。没有人，但你必须知道你实际上在使用 Git。这样，您在实际使用 Subversion 的同时获得 Git 的所有好处。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-12T14:43:12.670

在命令行上指定文件

svn commit -m "我的提交信息" 文件夹/file1.c

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T14:34:21.770

您可以创建一个仅列出您要提交的文件的变更集，然后提交该变更集。如果您在完成更改集后勤于删除更改集，并且在没有更改集的情况下从不提交，我认为这对您有用。更简单的解决方案是使用图形客户端（例如 TortoiseSVN，但所有平台都有其他具有类似功能的客户端），它会在提示您输入登录消息时向您显示将要提交的文件列表。然后，如果您单击“提交”而不查看它们，那不是因为它没有告诉您它将做什么:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T17:44:38.260

按照 Rory 的回答，如果您想强制执行显式文件提交行为，您可以编写一个批处理或 shell 脚本来检查以确保您至少有一个除提交消息以外的参数，如果没有，则返回错误。这至少会提醒您明确输入文件名。

无论如何，我总是在提交之前做一个 svn stat 和 diff，所以 stat 通常会提醒我可能有些事情我还不想检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T14:36:07.803

我通常从一些 IDE 提交，比如 Emacs，我可以在其中手动选择要提交的文件集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-09T13:04:35.757

Subversion 默认按照你想要的方式工作。**添加**、**删除**或**修改**的添加项是暂存的，并且在您使用指定要提交的文件的 commit 命令之前不会提交。如果您使用命令行并且只运行“svn commit”而没有任何其他参数，那么我可以看到您的问题可能是什么，在这种情况下，我将使用其他人建议的变更集功能，并将提交时间用作自我代码- 审查时间以浏览所有更改并决定哪些进入，哪些不进入。

我还要补充一点，只做部分提交是一个坏习惯，只有在你非常清楚自己在共享分支中所做的事情时才应该这样做，因为这是破坏构建的最常见方法之一对未包含在同一提交中的意外相关更改执行操作。

如果我有要单独提交的更改，我会做什么并向其他人推荐是为我当时不感兴趣提交的更改创建一个补丁或一组补丁，然后从我的工作副本。现在工作副本只有我要提交的更改，我将通过手动测试或单元测试来重建并验证正确性，然后只有当所有这些都通过时，才进行自我代码审查和提交。我认为这种方式是与一大群人互动的最安全方式，尤其是在您进行复杂更改时。这个过程也可以变得更容易，svn 支持客户端搁置功能，通过单个命令将更改放入名称类似于变更集的临时存储中。

Also BTW, using [TortoiseSVN](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-commit.html) makes it a lot easier to manage changesets and cherry picking files that will go into any given commit. If your on Windows I highly recommend checking it out for that reason.

# css - 列表样式不显示

> ID：638838
> 
> 赞同：0
> 
> 时间：2009-03-12T14:25:57.610
> 
> 标签：css

在此页面上：[http](http://catonthecouchproductions.com/fish/boat-captain.html) ://catonthecouchproductions.com/fish/boat-captain.html我在右下角的黄色框中有一个列表，但它没有显示为 list-style-type:circle，但我有它在我的 CSS 中设置。

我不确定它为什么会这样。有任何想法吗？

我安装了 FireBug，它似乎没有任何冲突。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:29:36.837

您需要添加一个`left-margin`to`li`才能让它们显示出来。

```
ul li { margin-left: 10px; } 
```

应该这样做

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T14:30:00.610

您没有为圆圈留下任何空间来显示 - 请尝试`margin:1px 10px;`使用 ul li

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:29:23.730

`list-style-type:circle;`应该为 ul 而不是 li 定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:29:53.060

`ul`为已被 重置的元素添加填充`reset.css`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T14:32:53.863

我看到的另一个细节：你的`<ul>`元素有`list-style-type:disc;`和`<li>`元素`list-style-type:circle;`。此属性只应为`<ul>`元素声明。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-29T14:43:48.687

我在浮动 li 时遇到了同样的问题。一旦我从 li 元素中删除 float ， ul 中的圆圈就会出现在 IE7 中。

# version-control - 公共 Perforce 开源存储库？

> ID：638842
> 
> 赞同：9
> 
> 时间：2009-03-12T14:26:12.787
> 
> 标签：version-control, repository, perforce

虽然有许多使用 CVS、SVN 和 git 的开源存储库，但我想知道是否有任何基于 Perforce 的构建，因为多年来我一直很高兴地在家里将它用于 CM。

Perforce 提供了一个[public depot](http://public.perforce.com)，但那里托管的项目似乎是强烈的 Perforce 导向的。我的工作与 Perforce 无关，我只是喜欢他们的产品。该公司为托管开源项目提供免费许可证，但我对在网络上维护自己的服务器没有兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T00:28:47.227

我认为公共托管目前不符合 Perforce 的商业模式。

如果您查看他们的许可协议，请从此处链接：

[http://www.perforce.com/perforce/opensource-faq.html](http://www.perforce.com/perforce/opensource-faq.html)

...无论如何，您会注意到它的有效期仅为一年。如果您想“公开”您的代码，您可以考虑尝试导入实用程序，例如 p42svn：

[http://p42svn.tigris.org/](http://p42svn.tigris.org/)

# wpf - WPF - 图像'不是项目的一部分或其构建操作未设置为资源'

> ID：638845
> 
> 赞同：31
> 
> 时间：2009-03-12T14:26:31.197
> 
> 标签：wpf, image, resources, imagesource, buildaction

我有一个项目需要在窗口中显示图像。这是一个静态图像，我通过“添加>现有项目”添加。它存在于项目的根目录中。

我像这样在测试页面中引用图像 -

```
<Page x:Class="Critter.Pages.Test"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Test">
      <Image Source="bug.png"/>
</Page> 
```

问题是我收到一条消息说它找不到或者它的构建操作不是资源但它确实存在并且它的构建操作是资源。如果我创建一个新应用程序并将其放在窗口上，那么它可以正常工作。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-12T16:03:35.273

尝试进行完全重建，或删除构建文件然后构建文件。

Visual Studio 并不总是能获取对资源的更改，重新编译它可能会很痛苦。

还可以尝试使用完整的 URI，因为当我遇到同样的问题时，这对我有帮助。就像是

```
pack://application:,,,/MyAssembly;component/bug.png 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-07-07T07:06:02.960

→ 右键单击​​图像文件 → 单击属性 → 选择构建操作到资源 → 清理并构建解决方案 → 运行解决方案

你会得到一切。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-09-30T10:21:36.300

我遇到过同样的问题。清理和重建解决方案并没有解决它，所以我重新启动了 Visual Studio，它做到了。希望 Visual 2010 能够解决这个问题以及在 Visual 2008 中困扰 wpf 的许多其他问题。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-03-02T16:41:13.990

尝试使用“/”开始图像路径：

```
<Image Source="/bug.png"/> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-13T11:16:29.090

您的问题有一个解决方案

```
<Image Source="/WpfApplication4;component/images/sky.jpg" /> 
```

“组件”不是文件夹！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-11T19:40:59.373

它没有，或者至少当前的测试版没有。我在调查完全相同的问题时发现了这个页面。重建/清理什么也没做。关闭并重新加载解决方案后，文件神奇地再次变得兼容。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-09-05T10:34:53.157

我遇到了完全相同的问题，但重新启动 VS2008 或清理和重建项目对我不起作用。最后，以下步骤成功了。

*   在 Windows 资源管理器中，将图像复制到您的项目资源文件夹中。示例：MyProject\Resources\
*   在 Visual Studio 中右键单击资源并选择“添加 > 现有项目”并选择您刚刚复制的图像
*   在 XAML 表单中将图像源设置为：（`"Source="Resources/MyImage.ico"`我的图像保存为图标 (.ico) 文件，但这种方法适用于任何图像类型

希望这可以帮助某人

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-19T16:42:40.240

异步加载示例，另一种选择。示例 clip.mp4 位于 Web 项目根目录中。

```
void Landing_Loaded(object sender, RoutedEventArgs e)
{
    //Load video async

    Uri pageUri = HtmlPage.Document.DocumentUri;
    Uri videoUri = new UriBuilder(pageUri.Scheme, pageUri.Host, pageUri.Port, "clip.mp4").Uri;           

    WebClient webClient = new WebClient();
    webClient.OpenReadCompleted += new OpenReadCompletedEventHandler(webClient_OpenReadCompleted);
    webClient.OpenReadAsync(videoUri);
}

void webClient_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
{
    byte[] VideoBuffer = new byte[e.Result.Length];
    e.Result.Read(VideoBuffer, 0, (int)e.Result.Length);
    MemoryStream videoStream = new MemoryStream(VideoBuffer);
    ContentVideo.SetSource(videoStream);
    ContentVideo.Stop();
    ContentVideo.Play();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-26T15:29:58.697

我有一个类似的问题。在我从解决方案资源管理器中删除了一个`someStyle.xaml`我并没有真正使用的文件之后。然后我恢复了文件，但没有发生任何变化。清理和重建项目没有帮助。

只需删除相应的行：

```
<ResourceDictionary Source="someStyle.xaml"/> 
```

成功了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-06T09:11:46.517

我有同样的错误信息，但我的问题是一个简单的 NOOB 错误。

当我将 .ico 文件添加到“我的项目/资源”时，VS 创建了一个名为 Resources 的子文件夹，我正在尝试使用；

```
<Window Icon="icons1.ico"> 
```

我应该在什么时候使用；

```
<Window Icon="Resources/icons1.ico"> 
```

...不要判断，我 1 周前开始使用 WPF :)

# c# - C# 扩展方法架构问题

> ID：638850
> 
> 赞同：4
> 
> 时间：2009-03-12T14:27:24.970
> 
> 标签：c#, extension-methods

我最近问了这个问题： [引用自定义 C# 扩展方法的编译器错误](https://stackoverflow.com/questions/638463)

Marc Gravell 的回答很完美，它解决了我的问题。但它给了我一些思考...

如果扩展方法必须放在静态类上，并且方法本身必须是静态的，为什么我们不能创建静态扩展方法？

我知道标记为“this”的参数将用于允许访问我们正在扩展的对象的实例。我不明白的是为什么不能将方法创建为静态的……在我看来，这是一个毫无意义的限制……

我的问题是：为什么我们不能创建一个可以作为静态方法工作的扩展方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T14:33:13.723

我希望真正的答案很简单：没有一个好的用例。例如，优点是它可以在现有类型（它们本身不提供逻辑）上启用 fluent-API - 即

```
var foo = data.Where(x=>x.IsActive).OrderBy(x=>x.Price).First(); 
```

启用 LINQ：

```
var foo = (from x in data
           where x.IsActive
           order by x.Price
           select x).First(); 
```

使用静态方法，这根本不是问题，因此没有理由；只需在第二种类型上使用静态方法。

事实上，扩展方法不是*正确*面向对象的——它们是一种务实的滥用，以牺牲纯度为代价让生活更轻松。没有理由以同样的方式稀释静态方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T14:32:55.937

因为该功能在 C# 中不存在。

作为一种解决方法，静态方法可以在另一个类中实现并通过该类调用以提供附加功能。

例如，XNA 有一个[MathHelper类，理想情况下它是](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.mathhelper_members.aspx)[Math](http://msdn.microsoft.com/en-us/library/system.math_members.aspx)类的静态扩展。

社区正在[询问](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=379978)我们是否认为这对 C# 4.0 来说是个好主意

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:45:12.790

我的想法是为了兼容性——如果你突然将所有静态方法扩展方法都需要 this 运算符，你可能会无意中破坏现在正在用扩展方法覆盖普通方法的代码。

this 参数允许控制，因此不会破坏兼容性。

不过只是一个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:34:52.813

首先，您必须添加另一种语法来表明您想要扩展现有类型的静态方法。在扩展语法时，您确实需要一个很好的理由来这样做。

假设我有一个名为 MyExts 的类，它允许我向 MyClass 添加扩展方法。为什么会：-

```
MyClass.DoSomethingExtra(); 
```

优于

```
MyExts.DoSomethingExtra(); 
```

?

# c# - 三角形列表的路径 (.NET/C#)

> ID：638857
> 
> 赞同：3
> 
> 时间：2009-03-12T14:28:59.053
> 
> 标签：c#, .net, system.drawing

给定一个表示为二维点数组的路径：

```
Point[] path = new Point[4]
{
    new Point(0,0),
    new Point(10,0),
    new Point(10,10),
    new Point(0,10),
}; 
```

...在这里，一个盒子。

将其转换为要在 3D 应用程序中使用的三角形列表（填充路径）的最佳方法是什么？鉴于这只是一个简单的示例，实际路径可能相当复杂。框架中是否已经有任何东西，可能是 System.Drawing 或 WPF 中可以帮助解决这个问题？

编辑：（在塞缪尔的评论之后）理想情况下，我希望能够同时处理凸多边形和凹多边形，否则图形必须手动由许多凸多边形组成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T14:43:34.993

这取决于路径由什么组成，以及它是如何创建的。

如果它总是一个凸多边形，您可以很容易地创建一个三角形扇形来填充该区域。

如果它不是凸多边形，您很可能需要使用某种形式的三角测量来填充路径。那里有很多选择。大多数示例代码使用 C 或 C++，而不是 C#，但这可能会有所帮助：

[http://local.wasp.uwa.edu.au/~pbourke/papers/triangulate/morten.html](http://local.wasp.uwa.edu.au/~pbourke/papers/triangulate/morten.html)

基本思想是填充外部边界，三角测量例程将传回您的 3D 应用程序所需的正确三角形索引。

框架中没有任何东西可以为您执行此操作。

# c# - 如何使用 INotifyPropertyChanged 更新列表框项目

> ID：638859
> 
> 赞同：3
> 
> 时间：2009-03-12T14:29:16.010
> 
> 标签：c#, winforms, data-binding, inotifypropertychanged

我有一个列表框，它数据绑定到一组对象。我想修改项目的显示方式，以向用户显示这些对象中的哪一个是我程序中的 START 对象。

我尝试通过以下方式执行此操作，但列表框不会自动更新。使控件无效也不起作用。

我能找到的唯一方法是完全删除数据绑定并重新添加。但就我而言，这是不可取的。

还有其他方法吗？

```
class Person : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private string _name;
    public string Name
    {
        get
        {
            if (PersonManager.Instance.StartPerson == this)
                return _name + " (Start)";                      
            return _name;
        }
        set
        {
            _name = value;
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs("Name"));
        }
    }

    public Person(string name)
    {
        Name = name;
    }
} 
```

这是管理列表和作为开始的项目的类

```
class PersonManager
{
    public BindingList<Person> persons { get; set; }
    public Person StartPerson { get; set; }

    private static PersonManager _instance;
    public static PersonManager Instance
    {
        get
        {
            if (_instance == null)
            {
                _instance = new PersonManager();
            }
            return _instance;
        }
    }

    private PersonManager()
    {
        persons = new BindingList<Person>();
    }
} 
```

在表格中，我使用以下代码

```
 private void button1_Click(object sender, EventArgs e)
    {
        PersonManager.Instance.StartPerson = (Person)listBox1.SelectedItem;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:50:21.433

我很确定问题在于，当你这样做时，你实际上是在让 Person.Name 属性“get”访问器更改值（就 UI 而言，它就像一个 set 访问器）。

但是，没有任何东西可以更新绑定来说明这种情况正在发生。如果在您设置开始时调用了 PropertyChanged，我相信这会更新。

它很笨重，但是你写它的方式，我相信你可以添加它并使它工作（注意：我没有测试这个，所以它〜可能〜有问题）：

```
private void button1_Click(object sender, EventArgs e)
{
    Person newStart = (Person)listBox1.SelectedItem;
    if (newStart != null)
    {
        PersonManager.Instance.StartPerson = newStart;
        newStart.Name = newStart.Name; // Dumb, but forces a PropertyChanged event so the binding updates
    }
} 
```

# sql - MySQL - 如何在列中随机排序结果？

> ID：638865
> 
> 赞同：1
> 
> 时间：2009-03-12T14:30:21.200
> 
> 标签：sql, mysql

我需要从按列（比如说“用户”）随机排序的表（即“订单”）中检索行。也就是说，我需要来自同一用户的所有订单保持在一起（一个接一个）并且随机订购用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:45:12.943

我将假设您有第二个名为“users”的表，其中包含所有用户。如果没有，您仍然可以通过在订单上添加另一个 SELECT DISTINCT 子查询来做到这一点，但这会更加混乱：

```
SELECT orders.* 
FROM orders 
INNER JOIN (SELECT userid, RAND() as random FROM users) tmp
ON orders.userid = tmp.userid
ORDER BY tmp.random, tmp.userid 
```

您需要按随机数和用户 ID 进行排序，因此如果两个用户 ID 获得相同的随机数，他们的订单就不会全部混杂在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:44:42.057

它必须有多随机？我能想到几个可能的答案。

如果“随机”序列应该是可重复的，您可以使用 MD5 或您自己创建的自定义序列，例如 ORDER BY MD5()、secondary_sort_column，按用户 ID 的哈希值排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T11:08:06.190

按反向（用户）排序？

# iis - 我可以让 IIS 向它所服务的每个页面添加（注入）HTML 吗？

> ID：638866
> 
> 赞同：3
> 
> 时间：2009-03-12T14:30:26.537
> 
> 标签：iis, iis-6

我想为我们的 IIS 6 服务器服务的每个页面添加一些 HTML。它在很大程度上提供静态 HTML。这是 IIS 或扩展可以做的事情吗？我需要对 HTML 的注入方式和位置进行一些控制，在这种情况下是在标记之前。感谢您的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:34:50.987

就我而言，我相信您唯一能做的就是插入文档页脚（在“文档”选项卡上）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:45:28.247

如果您熟悉 ASP.NET，则可以编写一个**HTTP 响应过滤器**来执行此操作。

阅读[米兰内戈万的这篇文章](http://aspnetresources.com/articles/HttpFilters.aspx)。

**HttpResponse**类有一个非常有用的属性：

```
public Stream Filter {get; set;} 
```

> MSDN 对此属性提供了有用的描述：“获取或设置用于在传输前修改 HTTP 实体主体的包装过滤器对象。” 使困惑？换句话说，您可以将自己的自定义过滤器分配给每个页面响应。HttpResponse 将通过您的过滤器发送所有内容。此过滤器将在响应返回给用户之前立即调用，如果需要，您将进行更改以对其进行转换。
> 
> 如果您需要转换“遗留”代码的输出或用正确的代码替换占位符（页眉、页脚、导航，您可以命名），这可能会非常有用。此外，有时根本不可能确保每个服务器控件都按规则运行并产生您期望的结果。输入响应过滤器。
> 
> Filter 属性的类型为 `System.IO.Stream`。要创建自己的过滤器，您需要从 System.IO.Stream（它是一个抽象类）派生一个类，并将实现添加到它的众多方法中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-09-11T13:41:07.033

在使用 URL 重写模块之前，我可以通过出站规则注入一些 CSS：

```
<rewrite>
    <rules>
        <outboundRules rewriteBeforeCache="true">
            <rule name="Add custom CSS" preCondition="IsHTML">
                <match filterByTags="None" pattern="&lt;/head>" />
                <action type="Rewrite" value="&lt;link rel=&quot;stylesheet&quot; href=&quot;/path/to/custom/styles_override.css&quot;>&lt;/head>" />
            </rule>
            <preConditions>
                <preCondition name="IsHTML">
                    <add input="{RESPONSE_CONTENT_TYPE}" pattern="^text/html" />
                </preCondition>
            </preConditions>
        </outboundRules>
    </rules>
</rewrite> 
```

您应该能够对 html 内容执行相同的操作，而不是 css ...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T14:37:56.330

在 IIS 中，您可以添加页脚，这对于版权行或类似内容非常有用。如果您想要更多控制，真正“注入”，我会创建一个 HTTP 处理程序 (.NET) 来处理 .html 请求并添加您需要的内容。

如果您是“老派”，请改用 ISAPI 过滤器。太多的工作不符合我的口味。

# .net - 构建安全字符串类型的注意事项

> ID：638867
> 
> 赞同：0
> 
> 时间：2009-03-12T14:30:33.730
> 
> 标签：.net, securestring

我已经开始构建一个安全字符串类型——我称之为[SecureStringV2——](http://gogoled.blogspot.com/2009/03/securestringv2.html)来扩展 .Net 框架中现有的 SecureString 类型。这种新类型将为现有类型添加一些基本功能（检查相等性、比较等），但仍保持 SecureString 类型提供的安全性，即在类型使用后清除内存中的所有内容。我计划使用 Marshal 类和哈希算法来实现这些功能。关于如何完成这项工作并正确完成的指针将不胜感激。你们中是否有人认为我的实施想法有任何问题？谢谢 ：）

更新：关于图书馆的核心类，这是我的想法到目前为止引导我的地方。看看，让我知道你的想法。

```
/// <summary>
///  This class is extension of the SecureString Class in the .Net framework. 
///  It provides checks for equality of multiple SStringV2 instances and maintains
///  the security provided by the SecureString Class
/// </summary>
public class SStringV2 : IEquatable<SStringV2> , IDisposable
{
    private SecureString secureString = new SecureString();
    private Byte[] sStringBytes;
    private String hash = string.Empty;

    /// <summary>
    ///  SStringV2 constructor
    /// </summary>
    /// <param name="confidentialData"></param>
    public SStringV2(ref Char[] confidentialData)
    {
        GCHandle charArrayHandle = GCHandle.Alloc(confidentialData, GCHandleType.Pinned);
        // The unmanaged string splices a zero byte inbetween every two bytes 
        //and at its end  doubling the total number of bytes
        sStringBytes = new Byte[confidentialData.Length*2];
        try
        {
            for (int index = 0; index < confidentialData.Length; ++index)
            {                   
                secureString.AppendChar(confidentialData[index]);
            }
        }
        finally
        {
            ZeroOutSequence.ZeroOutArray(ref confidentialData);
            charArrayHandle.Free();
        }
    }

    /// <summary>
    /// Computes the hash value of the secured string 
    /// </summary>
    private void GenerateHash()
    {
        IntPtr unmanagedRef = Marshal.SecureStringToBSTR(secureString);
        GCHandle byteArrayHandle = GCHandle.Alloc(sStringBytes, GCHandleType.Pinned);
        Marshal.Copy(unmanagedRef, sStringBytes, 0, sStringBytes.Length);
        SHA256Managed SHA256 = new SHA256Managed();

        try
        {
            hash = Convert.ToBase64String(SHA256.ComputeHash(this.sStringBytes));
        }
        finally
        {
            SHA256.Clear();
            ZeroOutSequence.ZeroOutArray(ref sStringBytes);
            byteArrayHandle.Free(); 
            Marshal.ZeroFreeBSTR(unmanagedRef);
        }
    }

    #region IEquatable<SStringV2> Members

    public bool Equals(SStringV2 other)
    {
        if ((this.hash == string.Empty) & ( other.hash == string.Empty))
        { 
            this.GenerateHash();
            other.GenerateHash();
        }
        else if ((this.hash == string.Empty) & !(other.hash == string.Empty))
        {
            this.GenerateHash();
        }
        else if (!(this.hash == string.Empty) & (other.hash == string.Empty))
        {
            other.GenerateHash();
        }

        if (this.hash.Equals(other.hash))
        {
            return true;
        }
            return false;
    }

    #endregion

    #region IDisposable Members

    public void Dispose()
    {
        secureString.Dispose();
        hash = string.Empty;
        GC.SuppressFinalize(this);
    }

    #endregion
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T18:58:15.743

只是一个简短的说明-您要求将哈希相等与数据相等误认为是问题-确保它们不同的可能性很低，但是一旦遇到它，那将是一场噩梦：/（我有“运气”来调试和修复几年前犯了同样错误的自定义哈希映射实现，所以请相信我；））。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-25T16:28:06.957

不要忘记 SecureString 使用双向加密。我在你的课堂上没有看到任何加密。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T17:30:29.277

如果你传入一个 char[] 数组，你就会开始失去安全字符串的好处。char[] 数组可以在清除之前被垃圾收集器复制到内存中。

# crud - 摆脱 CRUD

> ID：638868
> 
> 赞同：49
> 
> 时间：2009-03-12T14:30:46.257
> 
> 标签：crud

**定义：**
[CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete) -`Create, Read, Update, Delete; The four basic functions of persistent storage. In the context of this question, specifically related to business applications.`

老实说，当我开始编程时，我的目标并不包括成为一名终生的 CRUD 程序员。财务数据只有这么长时间才如此有趣。对我来说，这似乎是大多数编程演出。

我刚从学校毕业，所以任何经验仍然非常有益，但最终我想转向“不像 CRUD 之类的东西”。目前，我关注一些机器控制类型的工作。但是，我只是不确定如何朝那个方向发展。

所以我想了解其他开发人员对这个话题的看法。

*   你喜欢 CRUD，为什么？
*   你在 CRUD 中的经历是怎样的？
*   您是如何从 CRUD 转向非 CRUD 工作的？
*   如果你搬家了，你喜欢什么，讨厌什么？
*   如果您已经搬家，哪些技能有利于/加速过渡？

**编辑：**
我以想要解决问题的态度接近 CRUD，而不是为十几个不同的表重新创建具有不同字段的相同表单。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-12T14:35:53.450

我不认为真的有人喜欢做 CRUD（至少任何人都是*理智*的）。这是网络编程中最乏味的部分。我的建议是找到或编写一个框架来为您自动执行此操作。

*   [进化效用](http://www.evolutility.org/)
*   [django 管理面板](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#ref-contrib-admin)和[django 表单](http://docs.djangoproject.com/en/dev/#forms)

但是，如果这是你的大部分工作，你绝对*应该*考虑换工作。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-12T14:36:33.060

换一份工作。说真的，并不是所有的软件开发都在开发业务应用程序。我认为开发运输软件会让你更快乐。*试着在一家软件*公司找一份工作，写一些东西要发给客户。此外，如果你想了解一些低级硬件风格的东西，只需开始研究一些基本的微控制器，这样你至少有一些背景知识。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-12T15:12:58.057

开发一个框架，使您在工作中轻松创建 CRUD。一旦你做到了，利用空闲时间在可用性、安全性、性能等方面改进它。这应该会让你的工作保持一段时间的趣味性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-09-21T12:09:42.243

这是一个关于 CRUD 如何以及为什么仍然可以鼓舞人心的精彩演示：

[http://www.scribemedia.org/2006/07/09/dhh/](http://www.scribemedia.org/2006/07/09/dhh/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-12T14:49:30.330

我同意 CRUD 很无聊。但我不认为这是财务数据造成的。例如，如果财务数据流入您编写的基于神经网络的专家系统中，以找出如何最好地进行投资，也许您会发现这些数据更有趣？

编程肯定比 CRUD 多得多。找到一个你感兴趣的方面，然后去追求它。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-03-20T14:42:11.343

我很好奇这里没有人提到基于任务的 UI 和 CQRS。事实上，回答你的问题：

*   我不喜欢 CRUD……为什么？请参阅以下对您的问题的回答
*   我对 CRUD 的体验是编写 CRUD 很痛苦（我认为全栈框架充其量是一种解决方法），而且对用户来说也常常很痛苦
*   当我了解构建软件是为用户提供强大的工具，而不是具有某些业务规则的数据库编辑器时，我转向非 CRUD 工作
*   我喜欢构建与全栈框架（Symfony2, ASP.NET & cie...）耦合较少的软件，更完全面向对象，但我越来越讨厌 RDBMS CRUD 方向，越来越被 EventStore（Event采购）
*   [让我们从基于任务的 UI](http://cqrs.wordpress.com/documents/task-based-ui/) 、CQRS 和事件溯源中获得灵感（搜索 Google，我没有足够的声誉来添加更多链接......）=>[一起](http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/)

但是，我希望不要那么固执地完成：有些点不会让你摆脱 CRUD。一些用户喜欢 CRUD，他们感觉就像在 Excel 中一样......而且可能有一些应用程序 CRUD 可以满足所有需求......

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-12T14:41:03.080

CRUD - 是的，最终我们正在存储、读取和更新数据。但那又怎样？这只是等式的一部分，至少在我的世界里是这样。

在业务中，数据是必不可少的，但重要的是业务逻辑和根据该数据做出的决策。我发现获取原始数据并使用它来帮助企业做出决策是非常有益的。我们在代码中使用业务逻辑来做到这一点，更不用说在表示层中呈现数据的无穷无尽的方式了。

是的，最终涉及到 CRUD，但不仅如此，不是吗？

只是我的观点。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-10-05T22:23:02.573

拥有广泛的经验，我的解决方案是[创造我的完美产品](http://blog.gridspy.co.nz)并围绕它开展[业务。](http://www.gridspy.co.nz)我面临着各种有趣的挑战，例如[如何将实时数据从嵌入式设备流式传输到浏览器](http://blog.gridspy.co.nz/2009/09/database-meet-realtime-data-logging.html)。这些东西让我的编程热情洋溢，我有一个重要的、有趣的特性列表要添加。

梦想你的完美产品领域，找到一些可以受益的人，问他们有什么问题。一旦你找到一个你感兴趣的共同主题（我的主题是自动化和电源监控），就开始黑客攻击。当然，我父亲在过去 30 年里经营着[电子公司 Technman](http://www.technman.com)对我很有帮助，他想和我一起创造这个产品。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-09-11T21:02:24.050

是的，很多商业软件都是 CRUD。我曾经在这方面工作。

在机器控制中，其中一部分也可以是 CRUD。例如，记录传感器数据并在某处报告。基本上是 CRUD。

但我承认——在机器控制中，它主要是非 CRUD。您可能会喜欢做一些真正使装配线移动、制造汽车或使电机以一定速度旋转的事情。我知道我知道。在金融机构，它实际上只是数字。没有什么像马达或汽车那样“真实”。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-12T15:10:16.503

首先，您是否了解了有关持久性存储的大部分知识？值得弄清楚如何在您当前的工作中实际应用数据库理论等。一旦你已经这样做了几年并弄清楚了这一切，你绝对应该考虑扩大你的视野。我同意你的看法——除非你自己构建 DBMS——我发现工作的持久存储部分变得相当无聊。

在新领域找到工作的最佳方法之一是制作与工作相关的东西的原型，以便在面试中展示。这是一个令人难以置信的有力声明。

嵌入式软件确实是我的菜，但这个市场在北美正在慢慢萎缩并转移到发展中国家，这是一个相当专业的入门领域。

在我看来，应用空间仍在增长。以 iPhone、J2ME 或 Windows Mobile 开发为例。您可以用相对较少的设备投资来学习自己做这些。

如果您还没有这样做，那么还有 Web 应用程序空间。JBOSS 和 Glassfish 等应用服务器平台是免费的，而且相当容易学习。此外，它们还提供了指向您已经知道的 CRUD 的链接。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-13T00:59:49.117

只需看看 Django 并继续进行有趣的编码！！！

（或 RoR，或 Grails，或任何最适合您的，但 CRUDS 不应该仍然从头开始手工编码）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-13T01:02:24.773

现代框架可以为你做所有的事情。从 GRAILS 项目中检出独立的 GORM。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-12T15:06:16.140

几乎每个程序都必须创建、读取、更新和删除某种数据。在某些系统中，这提出了自己的挑战。

然而，大多数时候读取和写入数据库相当容易（这就是他们制作数据库的原因）。拥有数据后，您将如何处理这些数据，这很有趣，并且通常对企业来说是独一无二的，并且可以让您继续工作。

[这篇文章](http://thedailywtf.com/Articles/Programming-Sucks!-Or-At-Least,-It-Ought-To-.aspx)我很赞同，基本上很多编程都是枯燥的。

但是，如果您足够优秀并且足够坚定，您最终会做一些有趣的事情。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-12T15:08:48.863

找到或编写一种方法来更快地完成应用程序的 CRUD 部分。这样做，告诉你的经理你已经完成了分配的任务（确保它们已经完成；测试，记录等），并询问你接下来应该做什么。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-12T15:41:59.567

在这种经济环境下，你可能很难再找到另一份工作，但这并不意味着你不应该尝试。找一些你认为你会喜欢的工作，去学习它并寻找工作机会。即使你认为自己不太可能得到这份工作，打几个电话并进行几次面试也没有什么坏处。更好的是，你可以想办法创办自己的公司。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-12T16:40:44.713

进入网络开发？说真的，即使有数据库，我构建网络应用程序所需的基本杂物水平也很低。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-02-15T10:56:11.847

用于在 c# .net 中开发的基于 windows FORM 的应用程序的 CRUD

[RocketFramework](http://rocketframework.codeplex.com/)就是答案

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-12T14:33:49.900

当我还是一名本科生时，我把我的专业从电气工程转到了计算机科学，因为我想写电子游戏。后来，当我开始为真钱开发业务应用程序时，我了解到我只是喜欢用代码**解决问题。**

你可能从事了错误的职业。

# svn - 颠覆合并访问权限

> ID：638870
> 
> 赞同：2
> 
> 时间：2009-03-12T14:30:59.470
> 
> 标签：svn, merge

我需要限制访问以将更改合并到特定个人的主干中。有没有办法限制颠覆中特定文件夹的合并权限？我不想阻止从一个分支到另一个分支的合并，只想到主干。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T14:39:24.627

你不能使用 Subversion 的访问控制机制让那些特定人的主干只读吗？

在您的[`svnaccess`](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.pathbasedauthz.html)文件中：

```
[/MyProject/trunk]
me = rw
albert = r
bernard = r
chris = rw 
```

将允许您和 Chris 对“MyProject”的主干进行更改（包括合并），同时仅向 Albert 和 Bernard 授予读取权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:41:33.703

AFAIK 没有“合并权限”之类的东西，只有读写权限。合并实际上是一种写​​操作，您必须仅将特定文件夹（在您的情况下为“主干”）的写权限授予您想要的人。

详情请阅读[“基于路径的授权”](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.pathbasedauthz.html)。

# programming-languages - 当提到编程语言时，“富有表现力”是什么意思？

> ID：638881
> 
> 赞同：77
> 
> 时间：2009-03-12T14:32:57.873
> 
> 标签：programming-languages

我在诸如“javascript 是一种非常富有表现力的语言”之类的句子中经常听到这个词。它只是意味着没有很多规则，还是“表达”具有更具体的含义？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-03-12T14:41:06.760

“富有表现力”意味着编写易于理解的代码很容易，对于编译器和人类读者来说都是如此。

影响表现力的两个因素：

*   直观可读的结构
*   缺乏样板代码

将这个富有表现力的 Groovy 与不那么富有表现力的 Java 等价物进行比较：

```
3.times {
   println 'Hip hip hooray'
} 
```

对比

```
for(int i=0; i<3; i++) {
    System.out.println("Hip hip hooray");
} 
```

有时您会用精确度来换取表现力——Groovy 示例之所以有效，是因为它假设了 Java 让您明确指定的东西。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-12T14:36:41.060

我认为它能够以易于阅读和简洁的方式*表达想法/算法/任务。*

通常我会将具有表达性的语言与句法糖联系起来，尽管情况并非总是如此。在 C# 中它具有表现力的例子是：

*   `foreach`（而不是显式编写迭代）
*   `using`语句（而不是显式编写 try/finally ）
*   查询表达式（编写 LINQ 查询的更简单语法）
*   扩展方法（允许链接方法调用，同样主要用于 LINQ）
*   匿名方法和 lambda 表达式（允许更简单的委托和表达式树构造）

另一个例子是泛型：在 C# 获得泛型之前，您无法`ArrayList`在代码中表达“只包含字符串”的想法。（当然，您可以记录它，或者编写您自己的`StringList`类型，但这并不完全相同。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-12T14:37:55.600

[Neal Gratter 有一个博客](http://gafter.blogspot.com/2007/03/on-expressive-power-of-programming.html)，其中引用了关于这个主题的很好的引述……

> 在我看来，如果语言结构使您能够编写（和使用）一个没有该结构就无法编写（和使用）的 API，那么它就是富有表现力的。

我想说这意味着你可以更自然地用代码表达你的想法。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-12T14:39:41.227

这是一个艰难的。

对我来说，这与你表达意图的难易程度有关。这在不同的语言中是不同的，并且在很大程度上取决于你想要做什么，所以这是一个普遍化的领域。当然，这也是主观和个人的。

人们很容易认为更高级的语言总是更具表现力，但我不认为这是真的。这取决于您要表达的内容，即问题域。

例如，如果您想打印具有二进制模式的浮点数`0xdeadbeef`，那么在 C 中比在 Bash 中要容易得多。然而，与 C 相比，Bash 是一种超高级语言。另一方面，如果您想运行一个程序并将其输出收集到一个文本文件中，这非常简单，它在 Bash 中几乎不可见，但至少需要一页 C 代码（假设是 POSIX 环境）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-21T14:39:57.643

在这里，一个非常有争议的比较：

[http://redmonk.com/dberkholz/2013/03/25/programming-languages-ranked-by-expressiveness/](http://redmonk.com/dberkholz/2013/03/25/programming-languages-ranked-by-expressiveness/)

> 那么，根据这些指标，最好的语言是什么？
> 
> 如果您根据中位数和 IQR 的排名选择前 10 名，然后取它们的交集，这就是剩下的。中位数和 IQR 紧跟在名称之后：
> 
> Augeas (48, 28)：用于配置文件的特定领域语言
> 
> Puppet (52, 65)：另一种用于配置的 DSL REBOL (57, 47)：一种为分布式计算而设计的语言
> 
> eC (75, 75)：Ecere C，一个面向对象的 C 衍生物
> 
> CoffeeScript (100, 23): A higher-level language that transcompiles to JavaScript
> 
> Clojure (101,51): A Lisp dialect for functional, concurrent programming
> 
> Vala (123, 61): An object-oriented language used by GNOME
> 
> Haskell (127, 71): A purely functional, compiled language with strong static typing

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T14:36:38.830

[http://en.wikipedia.org/wiki/Expressive_power](http://en.wikipedia.org/wiki/Expressive_power)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T14:38:13.303

也许这个网站[http://gafter.blogspot.com/2007/03/on-expressive-power-of-programming.html](http://gafter.blogspot.com/2007/03/on-expressive-power-of-programming.html) 可以帮助你

**简而言之，他说**：在我看来，如果*语言结构***使您能够编写（和使用）一个没有该结构就无法编写（和使用）的 API，那么它就是***富有表现力的。***在 Closures for Java 提议的语言扩展的上下文中，控制抽象 API 是一种似乎不受竞争提案支持的东西。**

 **# java - Safari 及其他平台上的 Java Applet z-index

> ID：638886
> 
> 赞同：6
> 
> 时间：2009-03-12T14:34:14.220
> 
> 标签：java, html, applet, overlay, z-index

网页中 Java Applet 的一个众所周知的问题是，浏览器会忽略 applet 标签相对于页面中其他组件的 z-index。无论您如何在页面中定位和 z-index 元素，小程序都会将自己绘制在所有内容之上。

有一种解决方法，称为 iframe shim，如下所述：[http](http://www.oratransplant.nl/2007/10/26/using-iframe-shim-to-partly-cover-a-java-applet/) ://www.oratransplant.nl/2007/10/26/using-iframe-shim-to-partly-cover-a-java-applet/ 。

但是，此解决方法在 Windows 中的 Safari 3 或 4 中不起作用（假设 Mac 相同）。

有谁知道让它在 Safari 中工作的方法？

有没有人知道如何向 Sun 施压以解决根本问题，这样我们就可以避免笨拙的垫片？这是关于该问题的错误报告，[http://bugs.sun.com/bugdatabase/view_bug.do](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6646289) ?bug_id=6646289 ，请注意它已经开放了一年，但是其他错误报告可以追溯到很多年前。

这太令人沮丧了，难道 Sun 不明白这是一种将 Java 边缘化为在浏览器中做酷事的方式吗？我爱你 Java，但你没有帮助你的处境......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-02-14T15:02:28.567

这个问题有一个棘手的解决方案。没有必要将代码放在`iframe`. 我们可以`iframe`在小程序上方有一个虚拟层。然后可以轻松地将带有文本的绝对 div 放在其上方`iframe`。

工作示例

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Applet z index issue</title>
<style>

.applet {width:400px; margin:0 auto; text-align:center; border:1px solid #000; left:40%; position:absolute }
.iframe {width:400px;  background:#fff; position:absolute; border:1px solid #f00; position:absolute; left:45%; top:20px; z-index:9; height:201px;}
.message { width:250px; border:1px solid #000; background:#fff; height:150px; color:#fff; text-align:center;  z-index:99; background:#555;  float:left; position:absolute; left:45%; top:20px}

 </style>
</head>

<body>
<div class="message">Message</div>
<div class="iframe"><iframe style="width:500px; height:205px; background:none; border:none"> </iframe></div>
<div class="applet">

<applet code="Bubbles.class" width="400" height="350">
Java applet that draws animated bubbles.
</applet>

</div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-08T11:48:49.513

实际上问题根本与 z-index 无关。它是由 Netscape Plugin API (NPAPI) 的“窗口”绘图模型引起的。

您对此无能为力（垫片除外）。插件作者必须[使用无窗口 API 重写它](https://developer.mozilla.org/en/Gecko_Plugin_API_Reference:Plug-in_Basics#Windowed%20and%20Windowless%20Plug-ins)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-21T01:13:24.680

一方面，Mac 上的 Java 实际上是由 Apple 而不是 Sun 构建的。至于小程序，当有东西出现在它上面时，我们隐藏小程序。不过，这可能不足以满足您的需求。

# c# - 将 Visual Studio 2008 项目转换为 2003

> ID：638892
> 
> 赞同：2
> 
> 时间：2009-03-12T14:35:23.500
> 
> 标签：c#, visual-studio, visual-studio-2008, projects-and-solutions, visual-studio-2003

非常直截了当，但有谁知道如何将 Visual Studio 2008 项目转换为 Visual Studio 2003，我打算向客户提供一些东西，他们只在 2003 年工作。

对不起，有人提出了很好的观点，什么语言，C# 是答案。

我在谷歌上做了一堆搜索，往往只找到 2003->2008 而不是反之亦然，我非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T14:38:55.097

在一般情况下无法做到这一点，因为 VS2008 项目可能使用 .NET 3.5 功能，而 VS2003 中使用的 .NET 1.1 中不存在这些功能。

如果您的 VS2008 项目中只有 .NET 1.1 功能，您可以想象只需复制文件，创建一个 VS2003 项目，然后使用“添加现有项目”将这些项目添加到 VS2003 项目中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:37:40.903

2008 比 2003 有更多的设置。所以如果项目有一些特殊设置，你就搞砸了。否则创建一个新的 2003 项目并复制所有源文件？（并使用相同的配置）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T14:39:19.573

这将非常困难，因为 VS2003 项目使用 .NET 1.1，而 VS2008 使用 .NET 2.0、3.0 或 3.5（取决于项目的配置）。问题将是每个版本的框架都有一些功能，并且代码很可能会使用 .NET 1.1 中不存在的功能

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:39:27.107

有一些转换器可以从旧的 VS2003 项目格式转换为 2005/2008 使用的 MSBuild 格式，但我认为不存在任何倒退的情况。请记住，VS2008 中的任何重要项目都可能难以迁移到 VS2003——尤其是对于自动化工具。例如，WinForms 在 VS2003 和 VS2005 之间经历了巨大的变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T14:39:56.967

如果我错了，请纠正我，但 Visual Studio 2003 不只支持 .net 1.1 吗？这意味着如果您有一个 .net 2.0 或 3.5 应用程序，您就会遇到问题。对于 C++，我想这是一个类似的问题，因为旧的编译器。

意思是：我相信这是不可能的。

# python - Python中将字符串转换为全小写以去除所有非ASCII字母字符的最有效方法是什么？

> ID：638893
> 
> 赞同：28
> 
> 时间：2009-03-12T14:35:42.123
> 
> 标签：python, string

我有一个简单的任务需要在 Python 中执行，即将字符串转换为全小写并去除所有非 ascii 非字母字符。

例如：

```
"This is a Test" -> "thisisatest"
"A235th@#$&( er Ra{}|?>ndom" -> "atherrandom" 
```

我有一个简单的功能来做到这一点：

```
import string
import sys

def strip_string_to_lowercase(s):
    tmpStr = s.lower().strip()
    retStrList = []
    for x in tmpStr:
        if x in string.ascii_lowercase:
            retStrList.append(x)

    return ''.join(retStrList) 
```

但我不禁想到有一种更有效或更优雅的方式。

谢谢！

* * *

**编辑：**

感谢所有回答的人。我学习了，在某些情况下重新学习了很多 python。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-12T16:06:22.440

另一种解决方案（不是那种 Python 风格，但非常快）是使用 string.translate - 尽管请注意这不适用于 unicode。还值得注意的是，您可以通过将字符移动到一个集合中来加速[Dana 的代码](https://stackoverflow.com/questions/638893/what-is-the-most-efficient-way-in-python-to-convert-a-string-to-all-lowercase-str/638920#638920)（通过哈希查找，而不是每次都执行线性搜索）。以下是我得到的各种解决方案的时间：

```
import string, re, timeit

# Precomputed values (for str_join_set and translate)

letter_set = frozenset(string.ascii_lowercase + string.ascii_uppercase)
tab = string.maketrans(string.ascii_lowercase + string.ascii_uppercase,
                       string.ascii_lowercase * 2)
deletions = ''.join(ch for ch in map(chr,range(256)) if ch not in letter_set)

s="A235th@#$&( er Ra{}|?>ndom"

# From unwind's filter approach
def test_filter(s):
    return filter(lambda x: x in string.ascii_lowercase, s.lower())

# using set instead (and contains)
def test_filter_set(s):
    return filter(letter_set.__contains__, s).lower()

# Tomalak's solution
def test_regex(s):
    return re.sub('[^a-z]', '', s.lower())

# Dana's
def test_str_join(s):
    return ''.join(c for c in s.lower() if c in string.ascii_lowercase)

# Modified to use a set.
def test_str_join_set(s):
    return ''.join(c for c in s.lower() if c in letter_set)

# Translate approach.
def test_translate(s):
    return string.translate(s, tab, deletions)

for test in sorted(globals()):
    if test.startswith("test_"):
        assert globals()[test](s)=='atherrandom'
        print "%30s : %s" % (test, timeit.Timer("f(s)", 
              "from __main__ import %s as f, s" % test).timeit(200000)) 
```

这给了我：

```
 test_filter : 2.57138351271
           test_filter_set : 0.981806765698
                test_regex : 3.10069885233
             test_str_join : 2.87172979743
         test_str_join_set : 2.43197956381
            test_translate : 0.335367566218 
```

[编辑] 也更新了过滤器解决方案。（请注意， using`set.__contains__`在这里有很大的不同，因为它避免了对 lambda 进行额外的函数调用。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-12T15:55:32.093

```
>>> filter(str.isalpha, "This is a Test").lower()
'thisisatest'
>>> filter(str.isalpha, "A235th@#$&( er Ra{}|?>ndom").lower()
'atherrandom' 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-12T14:39:48.463

运行时效率不是特别高，但对于贫穷、疲惫的编码员眼睛肯定更好：

```
def strip_string_and_lowercase(s):
    return ''.join(c for c in s.lower() if c in string.ascii_lowercase) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-12T14:39:28.917

我会：

*   小写字符串
*   全部替换`[^a-z]`为`""`

像那样：

```
def strip_string_to_lowercase():
  nonascii = re.compile('[^a-z]')
  return lambda s: nonascii.sub('', s.lower().strip()) 
```

编辑：事实证明，原始版本（下）确实很慢，尽管通过将其转换为闭包（上）可以获得一些性能。

```
def strip_string_to_lowercase(s):
  return re.sub('[^a-z]', '', s.lower().strip()) 
```

* * *

我对字符串进行 100,000 次迭代的性能测量

```
"A235th@#$&( er Ra{}|?>ndom" 
```

透露：

*   `f_re_0 took 2672.000 ms`（这是这个答案的原始版本）
*   `f_re_1 took 2109.000 ms`（这是上面显示的闭包版本）
*   `f_re_2 took 2031.000 ms`（闭包版本，没有多余的`strip()`）
*   `f_fl_1 took 1953.000 ms`（[放松的`filter`/`lambda`版本](https://stackoverflow.com/questions/638893/what-is-the-most-efficient-way-in-python-to-convert-a-string-to-all-lowercase-str/638946#638946)）
*   `f_fl_2 took 1485.000 ms`（[科迪`filter`版](https://stackoverflow.com/questions/638893/what-is-the-most-efficient-way-in-python-to-convert-a-string-to-all-lowercase-str/639272#639272)）
*   `f_jn_1 took 1860.000 ms`（[达娜的`join`版本](https://stackoverflow.com/questions/638893/what-is-the-most-efficient-way-in-python-to-convert-a-string-to-all-lowercase-str/638920#638920)）

为了测试，我没有`print`结果。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-12T17:56:26.310

### Python 2.x`translate`方法

转换为小写并过滤非 ascii 非字母字符：

```
from string import ascii_letters, ascii_lowercase, maketrans

table = maketrans(ascii_letters, ascii_lowercase*2)
deletechars = ''.join(set(maketrans('','')) - set(ascii_letters))

print "A235th@#$&( er Ra{}|?>ndom".translate(table, deletechars)
# -> 'atherrandom' 
```

### Python 3`translate`方法

过滤非ASCII：

```
ascii_bytes = "A235th@#$&(٠٫٢٥ er Ra{}|?>ndom".encode('ascii', 'ignore') 
```

用于[`bytes.translate()`](http://docs.python.org/py3k/library/stdtypes.html#bytes.translate)转换为小写并删除非 alpha 字节：

```
from string import ascii_letters, ascii_lowercase

alpha, lower = [s.encode('ascii') for s in [ascii_letters, ascii_lowercase]]
table = bytes.maketrans(alpha, lower*2)           # convert to lowercase
deletebytes = bytes(set(range(256)) - set(alpha)) # delete nonalpha

print(ascii_bytes.translate(table, deletebytes))
# -> b'atherrandom' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T14:44:10.670

类似于@Dana，但我认为这听起来像是一项过滤工作，并且应该在代码中可见。也无需显式调用`join()`：

```
def strip_string_to_lowercase(s):
  return filter(lambda x: x in string.ascii_lowercase, s.lower()) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-12T16:20:46.183

我在 Brian 的代码中添加了过滤器解决方案：

```
import string, re, timeit

# Precomputed values (for str_join_set and translate)

letter_set = frozenset(string.ascii_lowercase + string.ascii_uppercase)
tab = string.maketrans(string.ascii_lowercase + string.ascii_uppercase,
                       string.ascii_lowercase * 2)
deletions = ''.join(ch for ch in map(chr,range(256)) if ch not in letter_set)

s="A235th@#$&( er Ra{}|?>ndom"

def test_original(s):
    tmpStr = s.lower().strip()
    retStrList = []
    for x in tmpStr:
        if x in string.ascii_lowercase:
            retStrList.append(x)

    return ''.join(retStrList)

def test_regex(s):
    return re.sub('[^a-z]', '', s.lower())

def test_regex_closure(s):
  nonascii = re.compile('[^a-z]')
  def replacer(s):
    return nonascii.sub('', s.lower().strip())
  return replacer(s)

def test_str_join(s):
    return ''.join(c for c in s.lower() if c in string.ascii_lowercase)

def test_str_join_set(s):
    return ''.join(c for c in s.lower() if c in letter_set)

def test_filter_set(s):
    return filter(letter_set.__contains__, s.lower())

def test_filter_isalpha(s):
    return filter(str.isalpha, s).lower()

def test_filter_lambda(s):
    return filter(lambda x: x in string.ascii_lowercase, s.lower())

def test_translate(s):
    return string.translate(s, tab, deletions)

for test in sorted(globals()):
    if test.startswith("test_"):
        print "%30s : %s" % (test, timeit.Timer("f(s)", 
              "from __main__ import %s as f, s" % test).timeit(200000)) 
```

这给了我：

```
 test_filter_isalpha : 1.31981746283
        test_filter_lambda : 2.23935583992
           test_filter_set : 0.76511679557
             test_original : 2.13079176264
                test_regex : 2.44295629752
        test_regex_closure : 2.65205913042
             test_str_join : 2.25571266739
         test_str_join_set : 1.75565888961
            test_translate : 0.269259640541 
```

似乎 isalpha 使用了与 set 算法类似的算法，至少在 O() 方面。

* * *

**编辑：** 添加了过滤器集，并将过滤器功能重命名为更清晰。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-12T14:42:47.427

```
>>> import string
>>> a = "O235th@#$&( er Ra{}|?&lt;ndom"
>>> ''.join(i for i in a.lower() if i in string.ascii_lowercase)
'otheraltndom' 
```

做的和你基本一样。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-12T14:43:57.800

这是列表理解的典型应用：

```
import string
s = "O235th@#$&( er Ra{}|?<ndom"
print ''.join(c for c in s.lower() if c in string.ascii_lowercase) 
```

它不会像您的示例中那样过滤掉“<”（html实体），但我认为这是意外剪切和过去的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-22T18:15:51.693

### Python 2.x：

```
import string
valid_chars= string.ascii_lowercase + string.ascii_uppercase

def only_lower_ascii_alpha(text):
    return filter(valid_chars.__contains__, text).lower() 
```

适用于`str`or`unicode`参数。

```
>>> only_lower_ascii_alpha("Hello there 123456!")
'hellothere'
>>> only_lower_ascii_alpha(u"435 café")
u'caf' 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T14:44:04.600

我个人会使用正则表达式，然后将最终字符串转换为小写。我不知道如何用 Python 编写它，但基本思想是：

1.  删除字符串中与不区分大小写的正则表达式“ `\w`”不匹配的字符
2.  将字符串转换为小写

或相反亦然。

# java - 如何在 servlet 中创建 URL？

> ID：638896
> 
> 赞同：4
> 
> 时间：2009-03-12T14:36:00.440
> 
> 标签：java, servlets, jakarta-ee

我想知道如何在 servlet 中生成 url。我有一个登录 servlet，每次添加一个我想生成的用户。每个用户配置文件的 url。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T14:48:01.707

最简单的方法是声明一个 servlet 映射，如下所示：

```
 <servlet-mapping>
    <servlet-name>UsersSelvlet</servlet-name>
    <url-pattern>/Users/*</url-pattern>
  </servlet-mapping> 
```

现在，每当您收到对 MyApp/Users/UserId 的请求时，您都会读取请求路径，获取 userId 并检查用户是否存在。如果不是，则返回“未找到”。否则，您将返回用户的页面。

这是 RESTful 服务的快速而肮脏的实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T11:24:18.517

我认为kgiannakakis的解决方案非常好。我只是想添加一些细节，因为阅读 Agusti-N 的评论我怀疑他可能遗漏了一些东西。

假设您有一个由**kgiannakakis**描述的 UsersServlet、一个名为**showUserProfile.jsp**的 jsp和一个**userBean**，它具有需要在 jsp 中显示的用户配置文件的所有属性。

当一个新用户注册到您的应用程序时，您不需要做任何比现在更多的事情。只需在数据库中注册一个新用户，然后**忘记登录 servlet**。

现在假设我使用我的用户名**alexmeia**注册到您的应用程序。

当有人数字化 url *yourApp/Users/alexmeia*时，**就会调用 UsersServlet**。此 servlet 从请求 url 中获取用户名 alexmeia，检查数据库中是否存在此用户名，如果存在则**在 userBean 中加载此用户的所有属性**。

之后，转发到**showUserProfile.jsp**，它显示了从 userBean 读取的用户配置文件。

显然，如果用户 alexmeia 不在 Db 中，您可以重定向到一个通用的 userNotFound.jsp，或者转到主页并显示一条消息等等......

这以相同的方式适用于所有注册用户。您不需要为每个新用户真正创建一个真正的新网址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:43:02.777

听起来您可能想研究[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)技术。这里有一个[教程](http://www.ibm.com/developerworks/edu/x-dw-x-restatompp.html)，你可能想看看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:49:04.073

您需要 URL 重写吗？像[这样](http://docstore.mik.ua/orelly/java-ent/servlet/ch07_03.htm)的东西，也许，但不是 RMI 生成你自己的用户 id

# air - 更新版本

> ID：638903
> 
> 赞同：0
> 
> 时间：2009-03-12T14:37:38.860
> 
> 标签：air, aptana

我在 aptana 中创建了一个新的 air 项目，但启动它让我受益匪浅

```
This application requires a version of the Adobe Integrated Runtime (AIR) which is no longer supported. Please contact the application author for an updated version. 
```

如何为更新版本的空气更新应用程序？我怀疑它与

```
<application xmlns="http://ns.adobe.com/air/application/1.5"> 
```

在 application.xml

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T14:51:04.693

您安装了 AIR 1.0 运行时，主要是在 2009 年 2 月之前的某个时间。AIR 1.5 大约在 2 月的最后一周发布。运行时安装程序会检查更新。您将需要更新的运行时。

应该有一个链接告诉您更新应用程序（当您启动应用程序时）。只需单击它并安装新版本的运行时。万一你错过了——[这里](http://get.adobe.com/air/)是链接。

[在此处](http://www.adobe.com/devnet/logged_in/rchristensen_lpolanco_air_1.5.html)阅读有关 AIR 1.5的更多信息。

如果我错过了真正的问题——请告诉我！

# .net - 使用 Moq 模拟 CAL EventAggregator

> ID：638908
> 
> 赞同：3
> 
> 时间：2009-03-12T14:38:12.167
> 
> 标签：.net, unit-testing, mocking, moq

我正在使用[Composite Application Library](http://www.codeplex.com/CompositeWPF)的事件聚合器，并且想为[IEventAggregator](http://msdn.microsoft.com/en-us/library/cc707867.aspx)接口创建一个模拟，以在我的单元测试中使用。

我计划使用[Moq](http://code.google.com/p/moq/)来完成这项任务，到目前为止的示例测试如下所示：

```
var mockEventAggregator = new Mock<IEventAggregator>();
var mockImportantEvent = new Mock<ImportantEvent>();
mockEventAggregator.Setup(e => e.GetEvent<SomeOtherEvent>()).Returns(new Mock<SomeOtherEvent>().Object);
mockEventAggregator.Setup(e => e.GetEvent<SomeThirdEvent>()).Returns(new Mock<SomeThirdEvent>().Object);
// ...
mockEventAggregator.Setup(e => e.GetEvent<ImportantEvent>()).Returns(mockImportantEvent.Object);

mockImportantEvent.Setup(e => e.Publish(It.IsAny<ImportantEventArgs>()));

// ...Actual test...

mockImportantEvent.VerifyAll(); 
```

这很好用，但我想知道，是否有一些聪明的方法可以避免为我的代码可能遇到的每个事件类型（SomeOtherEvent，SomeThirdEvent，...）定义一个空模拟？我当然可以在 [TestInitialize] 方法中以这种方式定义我的所有事件，但我想知道是否有更聪明的方法？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T09:04:42.767

我找到了解决方案：

```
var mockEventAggregator = new Mock<IEventAggregator>{ DefaultValue = DefaultValue.Mock }; 
```

将使 mockEventAggregator 返回所有嵌套对象的模拟。

# wpf - 使用 ObjectDataProvider

> ID：638911
> 
> 赞同：4
> 
> 时间：2009-03-12T14:38:41.430
> 
> 标签：wpf, xaml, objectdataprovider, app.xaml

我不敢相信没有人能解决这个问题，或者我只是错过了一些东西。

我有一个自定义的 DataSourceController 来处理检索数据并将其提供给其余的应用程序控件。自然，它使用我也初始化的 sql 连接。

我的应用程序代码：

```
private ISQLConnection conn;
public ISQLConnection SqlConnection { get { return conn; } }

private DataSourceController dataSource;
public DataSourceController DataSource { get { return dataSource; } }

protected override void OnStartup(StartupEventArgs e) {
    //-------------------------------------------------------
    // Initialize connections
    conn = new OracleSQLConnection("connectionStringHere");

    //-------------------------------------------------------
    // Initialize controllers
    //dataSource = new DataSourceController(conn);

    base.OnStartup(e);
} 
```

现在我想在 XAML 中创建 ObjectDataProvider，然后用它来绑定控件中的数据：

```
<ObjectDataProvider ObjectType="{x:Type data:DataSourceController}" x:Key="DataSource" MethodName="GetVenues" /> 
```

问题是 DataSourceController 没有无参数构造函数，需要传入一个 OracleSQLConnection 对象（这是我的 App 代码隐藏中的公共属性）。

这是可能吗？或者我必须为每个要绑定数据的控件使用代码内 DataContext 属性？！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T16:47:24.120

您可以将其添加`DataSourceController`为资源（如果您没有无参数构造函数，则必须从代码隐藏中执行此操作）并使用[ObjectDataProvider.ObjectInstance](http://msdn.microsoft.com/en-us/library/system.windows.data.objectdataprovider.objectinstance.aspx)属性来获取`DataSourceController`实例，然后您可以对其执行方法：

```
private ISQLConnection conn;
public ISQLConnection SqlConnection { get { return conn; } }

private DataSourceController dataSource;
public DataSourceController DataSource { get { return dataSource; } }

protected override void OnStartup(StartupEventArgs e) {
   //-------------------------------------------------------
   // Initialize connections
   conn = new OracleSQLConnection("connectionStringHere");

   //-------------------------------------------------------
   // Initialize controllers
   dataSource = new DataSourceController(conn);
   this.Resources.Add("myDataController", dataSource);
   base.OnStartup(e);
} 
```

`ObjectInstance`可以获取资源：

```
<ObjectDataProvider ObjectInstance="{StaticResource myDataController}" x:Key="DataSource" MethodName="GetVenues" /> 
```

如果您`ObjectDataProvider`在 App.xaml 中，可能会出现问题，在添加资源之前可以对其进行解析`DataSourceController`，在这种情况下，您会收到错误消息，因为“ `myDataController`”资源尚不存在。

# language-agnostic - 文件中的修改历史

> ID：638912
> 
> 赞同：2
> 
> 时间：2009-03-12T14:38:50.870
> 
> 标签：language-agnostic, version-control, comments

我曾在一些没有使用源代码控制的地方工作过。他们似乎养成了在他们更改的代码周围添加注释以解释更改的习惯，以便可以还原事情。

我发现这使得代码非常难以阅读，并且一直坚持在引入源代码控制后不需要此类注释，因为修订历史记录可以让您将票证与更改相匹配。

但是现在，我不太确定，我认为在文件以及提交消息中记录对文件的主要修订可能会很好。这应该使代码更具可读性。人们是否有一种记录代码更改的最佳实践方法，这样它就不会太混乱，但对于试图阅读它的人来说仍然是解释性的？

为了清楚起见，我不是在谈论文件头部的更改列表（这是一个完全不同的论点），而是在代码中的注释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T14:45:08.467

大多数源代码控制系统都有“注释”或“责备”命令。它显示了每个版本更改了哪些代码。

由于这些信息不会改变程序的行为，或者使程序更容易理解，因此它不属于程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T14:46:12.520

代码中的文档应该描述它附近的代码。如果代码更改，文档也应相应更改。版本控制系统应该负责管理更改的内容以及更改的原因。让代码和它的文档完成它的工作（做事情，并描述这些事情是如何/为什么完成的），并让版本控制系统完成它的工作（控制/记录版本和更改）。

每当您开始在当前（当前代码）中指示历史记录时，您就是在自找麻烦。试想一下，如果有许多更改，一个特别需要更改的代码区域会是什么样子？！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T14:51:25.847

如果评论对时间敏感，请不要这样做，这是一个坏主意。而是在版本控制系统中对源文件添加注释。

我在工作中一直看到这个问题。我目前正在处理的代码库可以追溯到 1979 年。你可以想象在这段时间里积累的如下评论的困难：

“下面的行似乎修复了错误 xyz，如果发生不可预见的问题将恢复”

我意识到这首先不是一个非常描述性的评论，而是 svn/cvs/etc 中的那种东西。其实很方便。代码中这样的注释会播下怀疑的种子。评论可以去掉吗？是不可预见的问题导致我不得不回顾与此评论相关的代码吗？等等

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T03:19:16.240

我只是想知道现在知道程序用来做什么有助于理解它？你说它有助于可读性。如何？

现在，当由于旧方法无效而新方法违反直觉而发生更改时，我认为应该在代码中进行注释，因为有必要永远知道“这不起作用，不要再做一次。我知道这看起来会更有意义。还是不要这样做。否则，我认为它没有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T14:46:15.127

不要认为以解释的方式评论代码中的更改是可能的。

但我想说一下“文件开始时的修改历史”。我怀疑这是否有用。除非我想知道要比较文件的哪个版本以查看某些“NNNN”任务引入的差异。在文件开头有一行“NNNN 日期 - 小描述”。我们的源代码控制可以“说出”这一行是在哪个版本中引入的。
因此，如果没有这一行，我会查看所有版本以找到正确的版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T14:45:58.543

我认为将主要更改或重构记录为代码中的注释是很好的。我同意阅读大量评论确实有点混乱，但我认为忽略评论并尝试阅读代码很容易。如果有什么令人困惑的地方，或者您想更改某些内容，并且附近有评论，那么您将更倾向于阅读评论，而不是与以前的版本进行差异以查看更改的内容和原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T15:47:51.283

我们代码库中的每个方法都有自己的更改历史。当一个方法的代码被改变时，它的头部会得到一个新的条目。代码本身不会被历史注释弄乱，只有方法头。每个更改历史记录条目都包含一两行简要描述代码更改原因的一般术语。该条目还包含一个引用更改文档的数字，更改文档还包含指向错误报告、开发项目、设计文档等的链接。

此类条目非常宝贵，因为它们通常可以让您深入了解代码为何如此。如果您在那里修复错误，历史跟踪总是会告诉您哪些代码更改引入了错误，更改试图做什么，因此在决定修复时您还需要注意什么。

OTOH - 代码正文中的大量注释描述了它的作用以及何时更改它的人只是噪音。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-16T16:49:12.673

我自己会尝试回答这个问题。

记录源代码中的每一次更改都会让人难以阅读，但是如果其中有一段特别违反直觉的代码，并且它是为特定票证引入的，请在其中注明代码为何奇怪。

但代码仍应记录在案。所以当你做不放的时候

```
/* ticket 101: add blink tag to headers, JF - 20010102 */ 
```

你可能想输入

```
/* make headers blink */ 
```

很多时候，当人们停止发表前一种评论时，他们会大量减少评论，这很糟糕。

# apache-flex - Flex 3 调试不适用于 FIREFOX 3

> ID：638923
> 
> 赞同：2
> 
> 时间：2009-03-12T14:40:16.153
> 
> 标签：apache-flex, flex3

Flex 3 调试不适用于 FIREFOX 3（在 vista 下）

控制台中没有显示 trace()。断点不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:42:50.733

~~您是否安装了 Flex Builder？如果没有，如果您使用的是免费 SDK，您是否安装了 Flash 播放器的调试版本？~~

尝试重新安装 Flash 播放器的调试版本。[这](http://www.adobe.com/support/flashplayer/downloads.html)是一个链接，以防你没有。一周前我遇到了同样的问题——损坏了我的安装。但也要按照其他答案中的建议检查配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-05T10:03:43.423

从上面给出的链接安装调试器后，它工作得很好。应安装的 exe 在[http://www.adobe.com/support/flashplayer/downloads.html](http://www.adobe.com/support/flashplayer/downloads.html)中列为“下载 Windows Flash Player 10.1 ActiveX 控件内容调试器（适用于 IE）（EXE，2.72 MB）” 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:43:12.387

你有：

```
ErrorReportingEnable=1
TraceOutputFileEnable=1 
```

在您的主目录中调用的文件`mm.cfg`中？我在 Windows Server 2k3 上使用 FF3，它运行良好，所以我无法解释为什么它不能在 Vista 上运行。尽管 Vista 以被破坏而闻名，但我怀疑这是您遇到的仅 Vista 的问题。你确定你已经安装了调试 Flash 播放器？

# asp.net - 如何判断 dll 在预编译的 ASP.NET 站点中引用的页面

> ID：638925
> 
> 赞同：1
> 
> 时间：2009-03-12T14:40:57.760
> 
> 标签：asp.net, dll, precompiled, bin

我正在使用预编译的 ASP.NET 2.0 站点（即，使用 Visual Studio 2005 中的“构建->发布网站”功能复制到服务器）。我捕获并记录了所有通常非常详细的错误，但最近我收到以下错误，没有其他信息：

> 无法加载程序集“App-Web-rp2eml-j”。确保在访问页面之前已对其进行编译。

现在，“App-Web-rp2eml-j”文件*应该是*我的 bin 文件夹中的一个 dll，它是为预编译站点创建的。我的主要问题是，**我如何知道哪个 aspx 页面正在寻找那个 dll？**我已经尝试重新发布该网站，甚至完全清除该网站并重新发布，但问题并没有消失。

在谷歌搜索问题时，关于此错误消息的大多数答案都围绕确保 IIS 设置为使用 ASP.NET 2.0 而不是 1.1。*这不是我的问题。*

注意 1：该站点似乎都可以正常工作，但显然（至少）有一页已损坏，我无法找到。

注意 2：上面的文件名应该有下划线而不是破折号，但是 SO 的标记正在将下划线之间的文本更改为斜体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T14:57:37.737

提到的 dll 是否存在于您的 bin 目录中？你把那部分斜体，所以我怀疑它没有。这可能意味着错误是指临时文件夹中的 dll。

如果 ASP.NET 临时文件文件夹中的一个或多个 dll 已损坏，则可能会出现此问题。有时，如果驻留在虚拟目录中的 dll 没有更改，则 ASP.NET 不会在此处刷新文件。它每隔一段时间就会在我的服务器上发生。

我的解决方案如下：

1.  停止服务器上的 IIS 服务一分钟左右。

2.  导航到 ASP.NET 临时文件文件夹（通常位于“%windir%\Microsoft.NET\Framework\\Temporary ASP.NET Files\MyApplicationName”）并清除该文件夹中的所有文件。

3.  将我的站点发布并上传到配置的虚拟目录。

4.  重新启动 IIS 和其他服务。

这个简单的 4 步过程过去对我来说效果很好，可能值得你一试。

但是，要回答您的基本问题，有两种方法可以“逆向工程” dll：

1.  在 ILDASM 中加载它并检查包含的类。
2.  使用 Reflector 将 dll 中包含的所有类文件保存到一个文件夹中。

但是，我怀疑这是否会解决您的问题，因为每个 dll 可能包含许多类文件，并且您不知道“哪个 ASPX 页面正在寻找该 dll”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:45:17.080

也许您可以通过 Global.asax 事件 Application_OnError 捕获有关错误的更多详细信息，以便您可以查看堆栈跟踪。

# sql-server - 请解释sql server选择的查询计划

> ID：638928
> 
> 赞同：3
> 
> 时间：2009-03-12T14:41:04.983
> 
> 标签：sql-server, indexing

在[这篇博](http://blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)文中，我需要说明为什么 SQL Server 会选择特定类型的扫描：

> 为简单起见，我们假设 col1 是唯一的并且值不断增加，col2 有 1000 个不同的值并且表中有 10,000,000 行，并且聚集索引由 col1 组成，并且 col2 上存在非聚集索引。
> 
> 想象一下为以下最初传递的参数创建的查询执行计划：@P1= 1 @P2=99
> 
> 这些值将导致使用替换参数的以下语句的最佳查询计划：
> 
> 选择 * from t where col1 > 1 或 col2
> 
> > 99 按 col1 排序；
> 
> 现在，想象一下如果初始参数值为：@P1 = 6,000,000 和@P2 = 550 的查询执行计划。
> 
> 和以前一样，在替换传递的参数后将创建一个最佳查询计划：
> 
> Select * from t where col1 > 6000000 or col2 > 550 order by col1;
> 
> 由于最初传递的参数值不同，这两个相同的参数化 SQL 语句可能会创建和缓存非常不同的执行计划。但是，由于 SQL Server 每个查询只缓存一个执行计划，因此在第一种情况下，由于“col1 > 1”参数替换，查询执行计划将使用聚集索引扫描的可能性非常高。而在第二种情况下，很可能会创建使用索引查找的查询执行计划。

来自：http: [//blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx](http://blogs.msdn.com/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)

**为什么第一个查询使用聚集索引，而在第二个查询中使用索引查找？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T14:49:22.280

如果优化器发现大部分表将在查询中返回，例如第一个查询，那么执行扫描比查找更有效。

如果只返回表的一小部分，例如在第二个查询中，则索引查找更有效。

扫描**将**触及表中的每一行，无论它是否合格。成本与表中的总行数成正比。如果表很小或者大多数行符合谓词条件，则扫描是一种有效的策略。

**查找**将触及符合条件的行和包含这些符合条件的行的页面，成本与符合条件的行和页面的数量成正比，而不是与表中的总行数成正比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T14:52:24.893

请注意，在这两种情况下都将使用聚集索引。在第一个示例中，它是一个聚集索引 SCAN，而在第二个示例中，它将是一个聚集索引 SEEK，在大多数情况下，如博客作者所述，它会更快。

SQL Server 知道聚集索引正在增加。因此，它会在第一种情况下进行聚集索引扫描。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:44:39.623

假设列仅包含正整数：

SQL Server 会查看表的统计信息，发现对于第一个查询，表中的所有行都满足 col1>1 的条件，因此它选择扫描聚集索引。

对于第二个查询，相对较小比例的行将满足 col1> 6000000 的条件，因此使用索引*查找*将提高性能。

# c# - WPF 关闭时隐藏？

> ID：638942
> 
> 赞同：5
> 
> 时间：2009-03-12T14:43:15.087
> 
> 标签：c#, wpf, vb.net

我如何在 wpf 中执行此操作

VB.NET

```
 Private Sub FrmSettings_FormClosing(ByVal sender As System.Object, ByVal e As System.Windows.Forms.FormClosingEventArgs) Handles MyBase.FormClosing
        e.Cancel = (e.CloseReason = Forms.CloseReason.UserClosing)
        Me.Hide()
    End Sub 
```

C＃

```
private void FrmSettings_FormClosing(object sender, System.Windows.Forms.FormClosingEventArgs e)
{
    e.Cancel = (e.CloseReason == Forms.CloseReason.UserClosing);
    this.Hide();
} 
```

因为 wpf 的 Close 事件只给了我 e.Cancel 而没有 closereason :(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-15T05:30:28.927

我要感谢 Bob King 的提示，并将他的代码添加为 C# WPF。这个对我有用。我的应用程序是按类型划分的托盘图标。在 WPF XAML 表单代码后面：

```
protected override void OnInitialized(EventArgs e)
{
    base.OnInitialized(e);

    Application.Current.ShutdownMode = System.Windows.ShutdownMode.OnMainWindowClose;
}

private bool m_isExplicitClose = false;// Indicate if it is an explicit form close request from the user.

protected override void OnClosing(System.ComponentModel.CancelEventArgs e)

{

    base.OnClosing(e);

    if (m_isExplicitClose == false)//NOT a user close request? ... then hide
    {
        e.Cancel = true;
        this.Hide();
    }

}

private void OnTaskBarMenuItemExitClick(object sender, RoutedEventArgs e)

{            
    m_isExplicitClose = true;//Set this to unclock the Minimize on close 

    this.Close();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T14:47:42.843

WPF 的默认实现中没有等效项。不过，您可以使用 windows 挂钩来获取原因。

以下帖子详细说明了如何执行此操作：[http ://social.msdn.microsoft.com/forums/en-US/wpf/thread/549a4bbb-e77b-4c5a-b724-07996774c60a/](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/549a4bbb-e77b-4c5a-b724-07996774c60a/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T18:43:02.673

我不确定我是否理解 WinForms 方法解决了什么问题。

总是这样做不是更好吗：

```
Protected Overrides Sub OnClosing(ByVal e As System.ComponentModel.CancelEventArgs)
    e.Cancel = True
    Me.Hide()
End Sub 
```

然后在您的应用程序中设置它？

```
Application.Current.ShutdownMode = System.Windows.ShutdownMode.OnMainWindowClose 
```

这样，每当您的子窗口关闭时，您就可以将它们保留在周围以便稍后更快地显示，但是当主窗口关闭时（即退出、关闭等），您的应用程序仍然会关闭。

# javascript - JavaScript 变量的背景颜色十六进制

> ID：638948
> 
> 赞同：36
> 
> 时间：2009-03-12T14:44:23.617
> 
> 标签：javascript, jquery, hex, rgb, background-color

我对 JavaScript 和 jQuery 有点陌生，现在我遇到了一个问题：

我需要将一些数据发布到 PHP 中，并且其中一位数据需要是 div X 的背景颜色十六进制。

jQuery 具有 css("background-color") 函数，通过它我可以将背景的 RGB 值转换为 JavaScript 变量。

CSS 函数似乎返回了一个类似 rgb(0, 70, 255) 的字符串。

我找不到任何方法来获取背景颜色的十六进制（即使它在 CSS 中设置为十六进制）。

所以看来我需要转换它。我找到了一个将 RGB 转换为十六进制的函数，但需要使用三个不同的变量 r、g 和 b 来调用它。所以我需要将字符串 rgb(x,xx,xxx) 解析为 var r=x; 变量 g=xx; 变量 b=xxx; 不知何故。

我试图用 JavaScript 谷歌解析字符串，但我并不真正理解正则表达式的东西。

有没有办法让 div 的背景颜色为十六进制，或者可以将字符串转换为 3 个不同的变量？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-12T14:58:07.967

试试这个：

```
var rgbString = "rgb(0, 70, 255)"; // get this in whatever way.

var parts = rgbString.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
// parts now should be ["rgb(0, 70, 255", "0", "70", "255"]

delete (parts[0]);
for (var i = 1; i <= 3; ++i) {
    parts[i] = parseInt(parts[i]).toString(16);
    if (parts[i].length == 1) parts[i] = '0' + parts[i];
} 
var hexString ='#'+parts.join('').toUpperCase(); // "#0070FF" 
```

针对以下评论中的问题：

> 我正在尝试修改正则表达式以处理 rgb 和 rgba，具体取决于我得到的。有什么提示吗？谢谢。

我不确定它在这个问题的上下文中是否有意义（因为你不能用十六进制表示 rgba 颜色），但我想可能还有其他用途。无论如何，您可以将正则表达式更改为：

```
/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(0\.\d+))?\)$/ 
```

示例输出：

```
var d = document.createElement('div');
d.style.backgroundColor = 'rgba( 255,  60, 50, 0)';

/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(1|0\.\d+))?\)$/.exec(d.style.backgroundColor);

// ["rgba(255, 60, 50, 0.33)", "255", "60", "50", "0.33"] 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-04-22T19:49:13.583

如果你有 jQuery，这是我刚刚提出的超紧凑版本。

```
var RGBtoHEX = 函数（颜色）{
  return "#"+$.map(color.match(/\b(\d+)\b/g),函数(数字){
    return ('0' + parseInt(digit).toString(16)).slice(-2)
  }）。加入（''）;
};

```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-12T14:53:46.077

您也可以使用 rgb 设置 CSS 颜色，例如：

```
background-color: rgb(0, 70, 255); 
```

它是[有效的 CSS](http://www.w3schools.com/css/css_units.asp)，不用担心。

* * *

**编辑：**如果您绝对需要，请参阅[nickf answer以获得转换它的好方法。](https://stackoverflow.com/questions/638948/background-color-hex-to-js-variable-jquery/639030#639030)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-29T02:32:28.890

不久前我发现了另一个函数（[由 R0bb13 编写](http://markmail.org/message/hilbsejsl4zxwlv6#query:+page:1+mid:hilbsejsl4zxwlv6+state:results)）。它没有正则表达式，所以我不得不从 nickf 借来它以使其正常工作。我发布它只是因为它是一种有趣的方法，它不使用 if 语句或循环来为您提供结果。此脚本还返回带有 # 的十六进制值（我当时使用的[Farbtastic插件需要它）](http://acko.net/dev/farbtastic)

```
//Function to convert hex format to a rgb color
function rgb2hex(rgb) {
 var hexDigits = ["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];
 rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
 function hex(x) {
  return isNaN(x) ? "00" : hexDigits[(x - x % 16) / 16] + hexDigits[x % 16];
 }
 return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
}

// call the function: rgb( "rgb(0, 70, 255)" );
// returns: #0046ff 
```

注意：nickf 脚本的十六进制结果应该是 0046ff 而不是 0070ff，但没什么大不了的：P

更新，另一种**更好**的替代方法：

```
function rgb2hex(rgb) {
 rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
 function hex(x) {
  return ("0" + parseInt(x).toString(16)).slice(-2);
 }
 return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-11-16T14:25:48.500

用 jQuery..

```
var cssColorToHex = function(colorStr){
    var hex = '#';
    $.each(colorStr.substring(4).split(','), function(i, str){
        var h = ($.trim(str.replace(')',''))*1).toString(16);
        hex += (h.length == 1) ? "0" + h : h;
    });
    return hex;
}; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-22T18:35:14.627

这些解决方案在 Chrome 中将失败，因为它返回一个 rgba(x,x,x,x) 作为背景颜色。

编辑：这不一定是真的。Chrome 仍将使用 rgb() 设置背景，具体取决于您在做什么。很可能只要没有应用 alpha 通道，Chrome 就会以 rgb 而不是 rgba 响应。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-19T15:06:34.387

这个解决方案怎么样，函数**stringRGB2HEX**返回输入字符串的副本，其中所有出现的格式为“rgb(r,g,b)”的颜色都已替换为十六进制格式“#rrggbb”。

```
 //function for private usage of the function below
   //(declaring this one in global scope should make it faster rather than 
   //declaraing it as temporary function inside stringRGB2HEX that need to be
   //instantieted at every call of stringRGB2HEX
   function _rgb2hex(rgb_string, r, g, b) 
   {
      //VERY IMPORTANT: by adding (1 << 24) we avoid 'rgb(0, 0, 0)' to be mistakenly converted into '#0'
      var rgb = (1 << 24) | (parseInt(r) << 16) | (parseInt(g) << 8) | parseInt(b); //same thing of: ( r + (256 * g) + (65536 * b) + 16777216)
      //toString(16) specify hex 16 radix, works only for numbers [source: http://msdn.microsoft.com/en-us/library/dwab3ed2(v=VS.85).aspx]   
      return '#' + rgb.toString(16).substr(1); //substr(1) because we have to remove the (1 << 24) added above
   }

   function stringRGB2HEX(string)
   {
      if(typeof string === 'string')
         string = string.replace(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/g, _rgb2hex);
      return string;
   } 
```

这也可以转换复杂样式的 rgb 颜色，例如`background`.

`style.background`像：这样的值很容易通过简单`"none no-repeat scroll rgb(0, 0, 0)"`地转换为`"none no-repeat scroll #000000"``stringRGB2HEX(style.background)`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-04-20T07:54:42.380

[http://www.phpied.com/rgb-color-parser-in-javascript/](http://www.phpied.com/rgb-color-parser-in-javascript/)

一个接受字符串并尝试从中找出有效颜色的 JavaScript 类。一些接受的输入例如：

```
* rgb(0, 23, 255)
* #336699
* ffee66
* fb0
* red
* darkblue
* cadet blue 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-11T14:38:40.323

我找到了这个解决方案[http://haacked.com/archive/2009/12/29/convert-rgb-to-hex.aspx](http://haacked.com/archive/2009/12/29/convert-rgb-to-hex.aspx)我在我的项目中使用它

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-09T04:23:01.923

**在这里，这将允许您使用 $(selector).getHexBackgroundColor() 轻松返回十六进制值：**

```
$.fn.getHexBackgroundColor = function() {
    var rgb = $(this).css('background-color');
    rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
    function hex(x) {return ("0" + parseInt(x).toString(16)).slice(-2);}
    return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
} 
```

# functional-programming - 您如何正确计算 Scheme 中的成对差异？

> ID：638962
> 
> 赞同：2
> 
> 时间：2009-03-12T14:46:16.607
> 
> 标签：functional-programming, scheme

给定一个数字列表，比如说，如果你有 x [-1] = 0 ，你`(1 3 6 10 0)`如何计算差异 (x [i] - x [i-1 )？]

（本例中的结果应该是`(1 2 3 4 -10)`）

我发现这个解决方案是正确的：

```
（定义（pairwise-2 f init l）
  （第一的
   （折叠
    (λ (x acc-data)
      (let ([result-list (first acc-data)]
            [prev-x (第二个 acc-data)])
        （列表
         (追加结果列表 (list(fx prev-x)))
         X）））
    （列表空 0）
    l)))

(pairwise-2 - 0 '(1 3 6 10 0))
;; => (1 2 3 4 -10)

```

但是，我认为应该有更优雅但同样灵活的解决方案。这只是丑陋的。

我是函数式编程的新手，想听听有关代码的任何建议。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:36:40.137

`map`接受多个参数。所以我会做

```
(define (butlast l)
  (reverse (cdr (reverse l))))
(let ((l '(0 1 3 6 10)))
  (map - l (cons 0 (butlast l))) 
```

如果您想将其包装在一个函数中，请说

```
(define (pairwise-call f init l)
  (map f l (cons init (butlast l)))) 
```

这当然*不是*Little Schemer Way，而是避免自己编写递归的方式。选择您最喜欢的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:51:27.713

Haskell 告诉我使用`zip`;)

```
(define (zip-with f xs ys)
  (cond ((or (null? xs) (null? ys)) null)
        (else (cons (f (car xs) (car ys))
                    (zip-with f (cdr xs) (cdr ys))))))
(define (pairwise-diff lst) (zip-with - (cdr lst) lst))

(pairwise-diff (list 1 3 6 10 0))
; gives (2 3 4 -10) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T14:53:46.180

无论如何，只要最短的参数列表用完，映射就不会完成吗？

```
(define (pairwise-call fun init-element lst)
  (map fun lst (cons init-element lst)))

```

*编辑*：jleedev 告诉我，至少在一个方案实施中情况并非如此。这有点烦人，因为没有 O(1) 操作来切断列表的末尾。

也许我们可以使用`reduce`：

```
(define (pairwise-call fun init-element lst)
  (反向 (cdr (减少 (lambda (ab)
                          (追加 (列表 b (- b (car a))) (cdr a)))
                        (缺点 (list init-element) lst)))))

```

（免责声明：快速破解，未经测试）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T15:49:01.047

在改进和适应 PLT Scheme [plinth](https://stackoverflow.com/users/20481/plinth)的[代码](https://stackoverflow.com/questions/638962/how-do-you-properly-compute-pairwise-differences-in-scheme/639081#639081)之后，我认为近乎完美的解决方案是：

```
（定义（成对应用 f l0 l）
  （如果（空？l）
      '()
      (让 ([l1 (第一个 l)])
        (cons (f l1 l0) (成对应用 f l1 (rest l))))))

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T15:12:25.453

多年来我没有做过计划，但这让我觉得这是一个典型的小 lisper 类型问题。

我从一个基本定义开始（请忽略括号的错位 - 我没有方便的 Scheme 解释器：

```
(define pairwise-diff
    (lambda (list)
      (cond
       ((null? list) '())
       ((atom? list) list)
       (t (pairwise-helper 0 list))))) 
```

这处理 null 和 atom 的废话，然后将肉类案例委托给助手：

```
(define pairwise-helper
    (lambda (n list)
       (cond
         ((null? list) '())
         (t
            (let ([one (car list)])
               (cons (- one n) (pairwise-helper one (cdr list))))
         )))) 
```

您可以使用“if”重写它，但我硬连线使用 cond。

这里有两种情况：空列表 - 这很容易，其他一切。对于其他一切，我抓住列表的头部并将这个差异用于递归案例。我不认为它变得更简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T18:36:27.490

这是最简单的方法：

```
(define (solution ls)
  (let loop ((ls (cons 0 ls)))
    (let ((x (cadr ls)) (x_1 (car ls)))
      (if (null? (cddr ls)) (list (- x x_1))
          (cons (- x x_1) (loop (cdr ls)))))))

(display (equal? (solution '(1)) '(1))) (newline)
(display (equal? (solution '(1 5)) '(1 4))) (newline)
(display (equal? (solution '(1 3 6 10 0)) '(1 2 3 4 -10))) (newline) 
```

写出每个示例的代码扩展，看看它是如何工作的。

如果您有兴趣开始使用 FP，请务必查看如何设计程序。当然，它是为刚接触*编程*的人编写的，但其中包含大量好的 FP 习语。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T12:43:48.263

```
(define (f l res cur)
  (if (null? l)
    res
    (let ((next (car l)))
      (f (cdr l) (cons (- next cur) res) next))))

(define (do-work l)
  (reverse (f l '() 0)))

(do-work '(1 3 6 10 0))

==> (1 2 3 4 -10) 
```

# javascript - jQuery 在 ASP 2.0 页面中不起作用 - Visual Web Developer 2008 Express

> ID：638966
> 
> 赞同：0
> 
> 时间：2009-03-12T14:47:04.890
> 
> 标签：javascript, jquery, visual-studio-2008, asp.net-2.0

JQuery 不适用于在 VS 2005 下开发的 ASP 2.0 页面，现在使用 Visual Web Developer 2008 Express 在其中执行 Javascript。我已经包含了 jquery 文件。我还安装了所有需要的补丁。JQuery 智能感知在 IDE 中运行良好，但没有运行 jquery 命令。顺便说一句，页面从服务器端编码渲染得很好。

请对此进行一些补救，代码中的问题是什么？

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.aspx.vb" Inherits="_Default" %>

<%@ Register Src="Calendar.ascx" TagName="Calendar" TagPrefix="uc1" %>

 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org   /TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Control Trial Page</title>
<link href="StyleSheet.css" rel="stylesheet" type="text/css" />

<script language="javascript" type="text/javascript" src="Scripts/jquery-1.3.2.js">
   $(document).ready(function() {
      $("#divBody").css("display", "none");
    });
</script>
</head>
<body>
<form id="form1" runat="server">
    <div>
        <input id="showDiv" type="button" value="hi there"/> 
    </div>
    <div id="divBody">
 ....

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T14:50:53.460

您需要 2 个脚本标签。一个导入 jQuery.js 文件，一个包含您的脚本。观察：

```
<script language="javascript" type="text/javascript" src="Scripts/jquery-1.3.2.js"></script>
<script language="javascript" type="text/javascript">
    $(document).ready(function() {
        $("#divBody").css("display", "none");
    });
</script> 
```

# bash - 如何判断 Bash 中是否不存在常规文件？

> ID：638975
> 
> 赞同：3715
> 
> 时间：2009-03-12T14:48:43.340
> 
> 标签：bash, file-io, scripting

我使用以下脚本来查看文件是否存在：

```
#!/bin/bash

FILE=$1     
if [ -f $FILE ]; then
   echo "File $FILE exists."
else
   echo "File $FILE does not exist."
fi 
```

如果我只想检查文件是否**不**存在，正确的语法是什么？

```
#!/bin/bash

FILE=$1     
if [ $FILE does not exist ]; then
   echo "File $FILE does not exist."
fi 
```

* * *

## 回答 #1

> 赞同：5075
> 
> 时间：2009-03-12T14:50:01.093

测试[命令](http://man7.org/linux/man-pages/man1/test.1.html)（`[`此处）有一个“非”逻辑运算符，即感叹号（类似于许多其他语言）。试试这个：

```
if [ ! -f /tmp/foo.txt ]; then
    echo "File not found!"
fi 
```

* * *

## 回答 #2

> 赞同：815
> 
> 时间：2014-01-16T14:25:58.313

**Bash 文件测试**

`-b filename`- 阻止特殊文件
`-c filename`- 特殊字符文件
`-d directoryname`- 检查目录是否存在
`-e filename`- 检查文件是否存在，无论类型如何（节点、目录、套接字等）
`-f filename`- 检查常规文件是否存在而不是目录
`-G filename`- 检查文件是否存在并归有效组 ID
`-G filename set-group-id`- 如果文件存在且设置组 ID，则为真
`-k filename`- 粘滞位
`-L filename`- 符号链接
`-O filename`- 如果文件存在且由有效用户 ID 拥有，则为真
`-r filename`- 检查文件是否可读
`-S filename`- 检查文件是否为套接字
`-s filename`- 检查是否文件大小非零
`-u filename`- 检查是否设置了文件 set-user-id 位
`-w filename`- 检查文件是否可写
`-x filename`- 检查文件是否可执行

**如何使用：**

```
#!/bin/bash
file=./file
if [ -e "$file" ]; then
    echo "File exists"
else 
    echo "File does not exist"
fi 
```

可以使用运算符对*测试表达式求反*`!`

```
#!/bin/bash
file=./file
if [ ! -e "$file" ]; then
    echo "File does not exist"
else 
    echo "File exists"
fi 
```

* * *

## 回答 #3

> 赞同：308
> 
> 时间：2009-03-12T14:50:57.377

您可以用“！”否定表达式：

```
#!/bin/bash
FILE=$1

if [ ! -f "$FILE" ]
then
    echo "File $FILE does not exist"
fi 
```

相关的手册页是`man test`or ，等效地，`man [`-- or `help test`or`help [`用于内置 bash 命令。

* * *

## 回答 #4

> 赞同：146
> 
> 时间：2009-03-12T14:52:16.093

```
[[ -f $FILE ]] || printf '%s does not exist!\n' "$FILE" 
```

此外，该文件可能是一个损坏的符号链接，或一个非常规文件，例如套接字、设备或 fifo。例如，要添加对损坏的符号链接的检查：

```
if [[ ! -f $FILE ]]; then
    if [[ -L $FILE ]]; then
        printf '%s is a broken symlink!\n' "$FILE"
    else
        printf '%s does not exist!\n' "$FILE"
    fi
fi 
```

* * *

## 回答 #5

> 赞同：111
> 
> 时间：2011-08-11T09:15:51.600

值得一提的是，如果你需要执行单个命令，你可以缩写

```
if [ ! -f "$file" ]; then
    echo "$file"
fi 
```

到

```
test -f "$file" || echo "$file" 
```

或者

```
[ -f "$file" ] || echo "$file" 
```

* * *

## 回答 #6

> 赞同：75
> 
> 时间：2011-10-18T16:09:23.113

[我更喜欢以POSIX](http://en.wikipedia.org/wiki/POSIX) shell 兼容格式执行以下单行操作：

```
$ [ -f "/$DIR/$FILE" ] || echo "$FILE NOT FOUND"

$ [ -f "/$DIR/$FILE" ] && echo "$FILE FOUND" 
```

对于几个命令，就像我在脚本中所做的那样：

```
$  [ -f "/$DIR/$FILE" ] || { echo "$FILE NOT FOUND" ; exit 1 ;} 
```

一旦我开始这样做，我就很少再使用完全类型化的语法了！！

* * *

## 回答 #7

> 赞同：60
> 
> 时间：2013-12-19T12:47:04.740

测试文件是否存在，参数可以是以下任意一种：

```
-e: Returns true if file exists (regular file, directory, or symlink)
-f: Returns true if file exists and is a regular file
-d: Returns true if file exists and is a directory
-h: Returns true if file exists and is a symlink 
```

以下所有测试都适用于常规文件、目录和符号链接：

```
-r: Returns true if file exists and is readable
-w: Returns true if file exists and is writable
-x: Returns true if file exists and is executable
-s: Returns true if file exists and has a size > 0 
```

示例脚本：

```
#!/bin/bash
FILE=$1

if [ -f "$FILE" ]; then
   echo "File $FILE exists"
else
   echo "File $FILE does not exist"
fi 
```

* * *

## 回答 #8

> 赞同：47
> 
> 时间：2015-04-28T19:40:16.227

你可以这样做：

```
[[ ! -f "$FILE" ]] && echo "File doesn't exist" 
```

或者

```
if [[ ! -f "$FILE" ]]; then
    echo "File doesn't exist"
fi 
```

如果要同时检查文件和文件夹，请使用`-e`option 而不是`-f`. `-e`对于常规文件、目录、套接字、字符特殊文件、块特殊文件等返回 true。

* * *

## 回答 #9

> 赞同：39
> 
> 时间：2012-01-24T19:43:47.127

您应该小心运行`test`未引用的变量，因为它可能会产生意想不到的结果：

```
$ [ -f ]
$ echo $?
0
$ [ -f "" ]
$ echo $?
1 
```

建议通常是将测试变量用双引号括起来：

```
#!/bin/sh
FILE=$1

if [ ! -f "$FILE" ]
then
   echo "File $FILE does not exist."
fi 
```

* * *

## 回答 #10

> 赞同：29
> 
> 时间：2016-10-14T15:18:33.430

在

```
[ -f "$file" ] 
```

该`[`命令对存储的路径进行`stat()`（非）系统调用，如果该系统调用成功并且返回的文件类型为“*常规*”，则返回*true*。`lstat()``$file`*`stat()`*

 **因此，如果`[ -f "$file" ]`返回 true，您可以判断该文件确实存在并且是常规文件或最终解析为常规文件的符号链接（或至少在`stat()`.

但是，如果它返回*false*（或 if`[ ! -f "$file" ]`或`! [ -f "$file" ]`return true），则有许多不同的可能性：

*   该文件不存在
*   该文件存在但不是*常规*文件（可能是设备、fifo、目录、套接字...）
*   该文件存在，但您没有父目录的搜索权限
*   该文件存在，但访问它的路径太长
*   该文件是指向常规文件的符号链接，但您对解析符号链接所涉及的某些目录没有搜索权限。
*   `stat()`...系统调用可能失败的任何其他原因。

简而言之，应该是：

```
if [ -f "$file" ]; then
  printf '"%s" is a path to a regular file or symlink to regular file\n' "$file"
elif [ -e "$file" ]; then
  printf '"%s" exists but is not a regular file\n' "$file"
elif [ -L "$file" ]; then
  printf '"%s" exists, is a symlink but I cannot tell if it eventually resolves to an actual file, regular or not\n' "$file"
else
  printf 'I cannot tell if "%s" exists, let alone whether it is a regular file or not\n' "$file"
fi 
```

要确定文件不存在，我们需要`stat()`系统调用返回错误代码`ENOENT`(`ENOTDIR`告诉我们其中一个路径组件不是目录是另一种我们可以告诉文件不存在的情况通过该路径存在）。不幸的是，该`[`命令并没有让我们知道这一点。无论错误代码是 ENOENT、EACCESS（权限被拒绝）、ENAMETOOLONG 还是其他任何内容，它都会返回 false。

`[ -e "$file" ]`也可以使用`ls -Ld -- "$file" > /dev/null`. 在这种情况下，`ls`会告诉您`stat()`失败的原因，尽管这些信息不能以编程方式轻松使用：

```
$ file=/var/spool/cron/crontabs/root
$ if [ ! -e "$file" ]; then echo does not exist; fi
does not exist
$ if ! ls -Ld -- "$file" > /dev/null; then echo stat failed; fi
ls: cannot access '/var/spool/cron/crontabs/root': Permission denied
stat failed 
```

至少`ls`告诉我它不是因为文件不存在而失败。这是因为它无法判断文件是否存在。该`[`命令只是忽略了这个问题。

使用`zsh`shell，您可以在命令`$ERRNO`失败后使用特殊变量查询错误代码，并使用模块中的特殊数组`[`解码该数字：`$errnos``zsh/system`

```
zmodload zsh/system
ERRNO=0
if [ ! -f "$file" ]; then
  err=$ERRNO
  case $errnos[err] in
    ("") echo exists, not a regular file;;
    (ENOENT|ENOTDIR)
       if [ -L "$file" ]; then
         echo broken link
       else
         echo does not exist
       fi;;
    (*) syserror -p "can't tell: " "$err"
  esac
fi 
```

（请注意，[使用最新版本构建时](http://www.zsh.org/mla/workers/2016/msg01696.html)[`$errnos`的某些版本会破坏支持`zsh``gcc`](http://www.zsh.org/mla/workers/2016/msg01696.html)）。

* * *

## 回答 #11

> 赞同：24
> 
> 时间：2015-08-05T18:10:39.607

有三种不同的方法可以做到这一点：

1.  用 bash 否定退出状态（没有其他答案这么说）：

    ```
    if ! [ -e "$file" ]; then
        echo "file does not exist"
    fi 
    ```

    或者：

    ```
    ! [ -e "$file" ] && echo "file does not exist" 
    ```

2.  否定 test 命令中的测试`[`（这是之前大多数答案的呈现方式）：

    ```
    if [ ! -e "$file" ]; then
        echo "file does not exist"
    fi 
    ```

    或者：

    ```
    [ ! -e "$file" ] && echo "file does not exist" 
    ```

3.  对测试结果为阴性（`||`而不是`&&`）采取行动：

    仅有的：

    ```
    [ -e "$file" ] || echo "file does not exist" 
    ```

    `/bin/sh`这看起来很愚蠢（IMO），除非您的代码必须可移植到缺少管道否定运算符（ ）的 Bourne shell（如 Solaris 10 或更早版本），否则不要使用它`!`：

    ```
    if [ -e "$file" ]; then
        :
    else
        echo "file does not exist"
    fi 
    ```

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2020-06-04T02:21:24.647

```
envfile=.env

if [ ! -f "$envfile" ]
then
    echo "$envfile does not exist"
    exit 1
fi 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2013-05-04T22:29:20.860

要反转测试，请使用“！”。这相当于其他语言中的“非”逻辑运算符。试试这个：

```
if [ ! -f /tmp/foo.txt ];
then
    echo "File not found!"
fi 
```

或者用稍微不同的方式写：

```
if [ ! -f /tmp/foo.txt ]
    then echo "File not found!"
fi 
```

或者你可以使用：

```
if ! [ -f /tmp/foo.txt ]
    then echo "File not found!"
fi 
```

或者，一起按下：

```
if ! [ -f /tmp/foo.txt ]; then echo "File not found!"; fi 
```

可以写成（然后使用“and”运算符：&&）：

```
[ ! -f /tmp/foo.txt ] && echo "File not found!" 
```

看起来像这样更短：

```
[ -f /tmp/foo.txt ] || echo "File not found!" 
```

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2013-03-31T13:22:58.153

这`test`件事也可能算数。它对我有用（基于*[Bash Shell: Check File Exists or Not](http://www.cyberciti.biz/faq/unix-linux-test-existence-of-file-in-bash/)*）：

```
test -e FILENAME && echo "File exists" || echo "File doesn't exist" 
```

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2015-07-03T08:39:37.130

此代码也有效。

```
#!/bin/bash
FILE=$1
if [ -f $FILE ]; then
 echo "File '$FILE' Exists"
else
 echo "The File '$FILE' Does Not Exist"
fi 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2014-05-21T06:11:22.960

最简单的方法

```
FILE=$1
[ ! -e "${FILE}" ] && echo "does not exist" || echo "exists" 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2013-08-29T06:59:47.960

此 shell 脚本也适用于在目录中查找文件：

```
echo "enter file"

read -r a

if [ -s /home/trainee02/"$a" ]
then
    echo "yes. file is there."
else
    echo "sorry. file is not there."
fi 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2017-04-11T20:25:18.797

有时使用 && 和 || 可能很方便 运营商。

就像在（如果你有命令“测试”）：

```
test -b $FILE && echo File not there! 
```

或者

```
test -b $FILE || echo File there! 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2019-06-12T11:50:20.997

您还可以将多个命令组合在一个衬垫中

`[ -f "filename" ] || ( echo test1 && echo test2 && echo test3 )`

或者

`[ -f "filename" ] || { echo test1 && echo test2 && echo test3 ;}`

如果文件名没有退出，输出将是

```
test1
test2
test3 
```

[注意](https://askubuntu.com/questions/606378/when-to-use-vs-in-bash)： ( ... ) 在子 shell 中运行，{ ... ;} 在同一个 shell 中运行。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2019-08-27T19:45:47.797

如果你想使用`test`而不是`[]`，那么你可以使用`!`来获得否定：

```
if ! test "$FILE"; then
  echo "does not exist"
fi 
```

# perl - 如何更改 ExtUtils::Makemaker 中保存测试文件的目录？

> ID：638988
> 
> 赞同：3
> 
> 时间：2009-03-12T14:51:10.730
> 
> 标签：perl, testing, makemaker

如何从默认值*t/*.t更改**Makefile.PL*中的默认测试路径？文档中提到了一个属性，但它不起作用。有人知道怎么做吗？

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T15:23:07.443

在 Makefile.PL 中：

```
WriteMakefile(
    test => { TESTS => 'tests/*.t'},
    .... 
```

将`make test`运行测试脚本`tests`而不是`t`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T19:15:23.407

Manni 的建议允许您拥有 MakeMaker 将在测试目标中使用的 glob 模式，但这仍然相当有限。我写了[Test::Manifest](http://search.cpan.org/dist/Test-Manifest)以便我可以覆盖这些部分来完全做我需要做的事情。即使您不想做与 Test::Manifest 相同的事情，您也可以查看源代码以了解我做了什么。

# regex - 在 shell 脚本中进行字符串操作的最佳方法是什么？

> ID：638991
> 
> 赞同：3
> 
> 时间：2009-03-12T14:52:04.440
> 
> 标签：regex, string, bash, shell

我在 shell 脚本中有一个作为字符串的路径，可以是绝对的或相对的：

/usr/userName/config.cfg

或者

../config.cfg

我想提取文件名（最后一个 / 之后的部分，所以在这种情况下：“config.cfg”）

我认为最好的方法是使用一些简单的正则表达式？它是否正确？我应该还是应该使用 sed 或 awk 来代替？

Shell-scripting 的字符串操作特性本身看起来非常原始，而且看起来非常深奥。

任何示例解决方案也值得赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T15:06:59.630

如果您可以使用 bash，则可以使用 bash 字符串扩展：

```
FILE="/path/to/file.example"
FILE_BASENAME="${FILE##*/}" 
```

这有点神秘，但是大括号开始变量扩展，并且双哈希从字符串的开头贪婪地删除了指定的 glob 模式。

双 %% 从字符串的末尾开始做同样的事情，而单个百分比或哈希则执行非贪婪删除。

此外，还提供了一个简单的替换构造：

```
FILE=${FILE// /_} 
```

例如，将用下划线替换所有空格。

再次单斜线是非贪婪的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T14:55:04.950

而不是字符串操作，我只是使用

```
file=`basename "$filename"` 
```

**编辑**：

感谢 unwind 为此提供了一些更新的语法（假设您的文件名保存在 $filename 中）：

```
file=$(basename $filename) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:58:14.300

大多数环境都可以访问[`perl`](http://en.wikipedia.org/wiki/Perl)，对于大多数字符串操作，我更喜欢它。

但如前所述，从这么简单的事情开始，您可以使用[`basename`](http://www.manpagez.com/man/1/basename/).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T15:27:27.573

我通常将 sed 与一个简单的正则表达式一起使用，如下所示：

```
echo "/usr/userName/config.cfg" | sed -e 's+^.*/++' 
```

结果：

```
>echo "/usr/userName/config.cfg" | sed -e 's+^.*/++'
config.cfg 
```

# c# - 回调函数

> ID：638998
> 
> 赞同：5
> 
> 时间：2009-03-12T14:52:55.640
> 
> 标签：c#, .net, delegates, callback

我有一个名为funct 的方法，当我在c# 中使用beingreceive 套接字方法时，我想将它作为我的回调函数。

```
s.BeginReceive(buffer, 0, buffer.Length, System.Net.Sockets.SocketFlags.None,
               new AsyncCallback(funct), null); 
```

得到的错误是：

> 'funct' 没有重载匹配委托 'System.AsyncCallback'

这里可能有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T14:56:19.860

“funct”必须是具有以下签名的方法：

```
void funct(IAsyncResult ar) { } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T14:55:58.613

您不能只使用*任何*方法进行回调。该函数必须具有特定的签名（参数列表）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:57:27.470

什么是功能？是代表吗？如果是，它的签名与 AsyncCallback 委托不兼容。

funct 必须是如下所示的方法：

```
void SomeMethod(IAsyncResult ar) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T14:57:25.910

您的“功能”方法签名如何？

它返回 void 吗？

它是否只有一个 IAsyncResult 类型的参数？

换句话说，您的“功能”方法是否符合[Asynccallback](http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx)委托？*******``*****