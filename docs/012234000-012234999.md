# StackOverflow 问答 12234000-12234999

# android - Ant- Android 构建未创建发布版本

> ID：12234001
> 
> 赞同：0
> 
> 时间：2012-09-02T06:54:24.017
> 
> 标签：android, ant

我已经使用 eclipse 创建了一个 android 项目。但是我需要使用命令行来做同样的事情。所以，我使用下面的命令

```
 > android update project --path .
 > ant clean debug 
```

使用上面创建的命令——Welcome-debug.apk 和 WelCome-debug-unaligned.apk 我还在下面写了 ant.properties 文件——

```
 key.store=./mykey.keystore
   key.alias=MA
   key.store.password=mypassword
   key.alias.password=mypassword 
```

现在，当我尝试构建发布版本时-

```
> ant relase 
```

不幸的是，它没有创建任何发布文件。如何使用命令行创建发布版本。

期待您的回应。

谢谢，皮曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:34:43.473

你有一个错字：应该是`ant release`.

你不需要做任何具体的事情。`ant clean release`应该做的伎俩。但是，请注意`clean`目标：ant 是懒惰的，并且试图尽可能多地跳过工作 - 因此，如果您不清理它，它将不会重新创建类文件，并且您实际上会打包一个包含调试编译文件的 apk。

# java - 在DSA算法java中生成P

> ID：12234007
> 
> 赞同：2
> 
> 时间：2012-09-02T06:55:30.967
> 
> 标签：java, dsa

你能告诉我我是否正确吗？我想`p`在`DSA`算法中生成。我不明白：`|| pTemp.bitLength() != l`在`do while`声明中，因为这意味着我只在寻找`1`2、5、7 的数字素数？这是胡说八道。

```
private BigInteger generateP(BigInteger q, int l) { 
    if (l % 64 != 0) { 
        throw new IllegalArgumentException("L value is wrong");
    } 
    BigInteger pTemp;
    BigInteger pTemp2;
    int i = 0;
    do {
        //pTemp = new BigInteger(l, primeCenterie, rand);  <--- this is useless also?
        pTemp = new BigInteger(l,  rand);
        pTemp2 = pTemp.subtract(BigInteger.ONE);
        pTemp = pTemp.subtract(pTemp2.remainder(q));
        System.out.println("1 " + i++); 
    } while (!pTemp.isProbablePrime(primeCenterie) || pTemp.bitLength() != l);

    return pTemp;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T11:25:02.027

IT 不是 1(one)，而是 l(L)，一切都还好。我2个月前在做，现在不明白。

# java-me - 混淆器导致我的 j2me 程序异常 - 验证方法错误

> ID：12234008
> 
> 赞同：2
> 
> 时间：2012-09-02T06:55:53.283
> 
> 标签：java-me, proguard, midp, wma

在我混淆我的 jar 文件后，我可以在手机上安装我的 jar 文件，但它无法运行！它给了我例外：

```
Error verifying method mainPackage/mainClass notifyIncomingMessage(Ljavax/wireless/messaging/MessageConnection;) 
```

我只使用了混淆选项的 ProGuard。
您对问题的原因有任何想法吗？

这是“Sony Erricson sdk”在我的程序执行不成功后给我的：

```
 TRY(1): env: 0x12faa0, throwable: 0x12ffb0, tmpRootsCount: 0
Garbage collecting...
Collected 0 bytes of garbage (2093048/2097152 bytes free)
TRY(2): env: 0x12f798, throwable: 0x1, tmpRootsCount: 2
CATCH(2):   env: 0x12f798, throwable: 0x1, tmpRootsCount: 2
TRY(2): env: 0x12f7f0, throwable: 0x361f7a0, tmpRootsCount: 0
CATCH(2):   env: 0x12f7f0, throwable: 0x361f7a0, tmpRootsCount: 0
TRY(2): env: 0x12f7f8, throwable: 0x12f840, tmpRootsCount: 0
Initializing class: 'java/lang/System'
TRY(3): env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/cldc/i18n/Helper'
TRY(3): env: 0x12f728, throwable: 0x23, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x23, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/j2me/storage/File'
TRY(3): env: 0x12f728, throwable: 0x15, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x15, tmpRootsCount: 1
Initializing class: 'java/lang/Math'
TRY(3): env: 0x12f728, throwable: 0x8, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x8, tmpRootsCount: 1
Initializing class: 'java/lang/Double'
TRY(3): env: 0x12f6dc, throwable: 0x361fa04, tmpRootsCount: 2
Loading class 'com/sun/cldc/i18n/j2me/CP1256_Writer'
THROW(3):   env: 0x12f6dc, throwable: 0x361fa04, tmpRootsCount: 2
CATCH(3):   env: 0x12f6dc, throwable: 0x361e9d4, tmpRootsCount: 2
THROW(2):   env: 0x12f7f8, throwable: 0x12f840, tmpRootsCount: 0
CATCH(2):   env: 0x12f7f8, throwable: 0x361e9d4, tmpRootsCount: 0
Exception: java/lang/ClassNotFoundException
TRY(2): env: 0x12f7f8, throwable: 0x361e9d4, tmpRootsCount: 0
TRY(3): env: 0x12f728, throwable: 0x1040e194, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x1040e194, tmpRootsCount: 1
Initializing class: 'com/sun/kvem/cldc/i18n/j2me/GenericWriter'
Initializing class: 'com/sun/midp/main/Main'
TRY(3): env: 0x12f728, throwable: 0x27, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x27, tmpRootsCount: 1
Initializing class: 'com/sun/midp/lcdui/Resource'
TRY(3): env: 0x12f728, throwable: 0x1003d69f, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x1003d69f, tmpRootsCount: 1
Initializing class: 'com/sun/midp/security/SecurityToken'
TRY(3): env: 0x12f728, throwable: 0x41, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x41, tmpRootsCount: 1
Initializing class: 'com/sun/midp/security/Permissions'
TRY(3): env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'javax/microedition/rms/RecordStore'
THROW(2):   env: 0x12f7f8, throwable: 0x361e9d4, tmpRootsCount: 0
CATCH(2):   env: 0x12f7f8, throwable: 0x361e220, tmpRootsCount: 0
Exception: java/lang/NullPointerException
TRY(2): env: 0x12f7f8, throwable: 0x361e220, tmpRootsCount: 0
TRY(3): env: 0x12f728, throwable: 0x47, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x47, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/j2me/http/Protocol'
TRY(3): env: 0x12f728, throwable: 0x1e, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x1e, tmpRootsCount: 1
Initializing class: 'java/lang/Integer'
TRY(3): env: 0x12f728, throwable: 0x48, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x48, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/j2me/https/Protocol'
TRY(3): env: 0x12f728, throwable: 0x4a, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x4a, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/j2me/datagram/Protocol'
TRY(3): env: 0x12f728, throwable: 0x64, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x64, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/NetworkConnectionBase'
TRY(3): env: 0x12f728, throwable: 0x4b, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x4b, tmpRootsCount: 1
Initializing class: 'com/sun/midp/lcdui/DefaultInputMethodHandler'
TRY(3): env: 0x12f728, throwable: 0x4d, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x4d, tmpRootsCount: 1
Initializing class: 'com/sun/midp/midlet/MIDletState'
TRY(3): env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/tcpobex/Protocol'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/irdaobex/Protocol'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/btgoep/Protocol'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/kvem/jsr082/impl/bluetooth/SecurityTokenHandler'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/kvem/io/j2me/tcpobex/Protocol'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
TRY(3): env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/mmedia/BasicPlayer'
Initializing class: 'com/sun/mmedia/JavaMPEG1Player2'
TRY(3): env: 0x12f728, throwable: 0xba, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xba, tmpRootsCount: 1
Initializing class: 'com/sun/kvem/DeviceConfiguration'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/push/PushRegistryImpl'
TRY(3): env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/kvem/jsr082/impl/JSR082PushAdaptor'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/mms/Protocol'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/jcrmi/Protocol'
TRY(3): env: 0x12f728, throwable: 0xc0, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xc0, tmpRootsCount: 1
Initializing class: 'com/sun/kvem/environment/NetMon'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
TRY(3): env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/j2me/global/AppResourceManagerFactory'
Initializing class: 'com/sun/j2me/global/DevResourceManagerFactory'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
TRY(3): env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/j2me/global/AppResourceBundleReader'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/amms/control/camera/SnapshotCtrl'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/mmedia/protocol/CommonDS'
THROW(2):   env: 0x12f7f8, throwable: 0x361e220, tmpRootsCount: 0
CATCH(2):   env: 0x12f7f8, throwable: 0x361c5f0, tmpRootsCount: 0
Exception: java/lang/ClassCastException
TRY(2): env: 0x12f7f8, throwable: 0x361c5f0, tmpRootsCount: 0
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/mmedia/MmapiTuner'
TRY(3): env: 0x12f728, throwable: 0x93, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x93, tmpRootsCount: 1
Initializing class: 'com/sun/mmedia/Configuration'
TRY(3): env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
TRY(3): env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
Initializing class: 'com/sun/mmedia/DefaultConfiguration'
Initializing class: 'com/sun/mmedia/WtkQSoundAmmsConfig'
TRY(3): env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/mmedia/QSoundHiddenManager'
Exception: java/lang/NumberFormatException
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/mmedia/protocol/FileConnectionSubstitute'
TRY(3): env: 0x12f728, throwable: 0x4f, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x4f, tmpRootsCount: 1
Initializing class: 'com/sun/midp/security/SecurityInitializer'
TRY(3): env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'javax/microedition/content/Registry'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/content/RegistryImpl'
TRY(3): env: 0x12f728, throwable: 0xa0, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xa0, tmpRootsCount: 1
Initializing class: 'com/sun/midp/content/AppProxy'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/content/InvocationImpl'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/j2me/global/NormalizationTableImpl'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/j2me/global/CollationElementTableImpl'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
TRY(3): env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/j2me/payment/PaymentModule'
Initializing class: 'com/sun/kvem/payment/KvemPaymentModule'
TRY(3): env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x2, tmpRootsCount: 1
Initializing class: 'com/sun/kvem/payment/CreditCardAdapter'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/perseus/platform/ResourceHandler'
TRY(3): env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f6e4, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/perseus/builder/DefaultFontFace'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/io/j2me/file/Protocol'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/kvem/jsr082/impl/bluetooth/SDDBStorageImpl'
TRY(3): env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
CATCH(3):   env: 0x12f710, throwable: 0x1026d4dc, tmpRootsCount: 2
Initializing class: 'com/sun/midp/wma/WMASecurityInitializer'
TRY(3): env: 0x12f728, throwable: 0x3, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x3, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/j2me/sms/Protocol'
TRY(3): env: 0x12f728, throwable: 0x5, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x5, tmpRootsCount: 1
TRY(3): env: 0x12f728, throwable: 0xb3, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xb3, tmpRootsCount: 1
TRY(3): env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
TRY(3): env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
TRY(3): env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
Initializing class: 'com/sun/midp/io/Properties'
TRY(3): env: 0x12f728, throwable: 0x5, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x5, tmpRootsCount: 1
Initializing class: 'javax/microedition/lcdui/Display'
TRY(3): env: 0x12f728, throwable: 0xb3, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xb3, tmpRootsCount: 1
Initializing class: 'com/sun/midp/lcdui/Text'
TRY(3): env: 0x12f728, throwable: 0x1003d69f, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x1003d69f, tmpRootsCount: 1
TRY(3): env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
Initializing class: 'javax/microedition/lcdui/Item'
TRY(3): env: 0x12f728, throwable: 0xb2, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xb2, tmpRootsCount: 1
TRY(3): env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
CATCH(3):   env: 0x12f714, throwable: 0x1010524e, tmpRootsCount: 1
Initializing class: 'javax/microedition/lcdui/Displayable'
TRY(3): env: 0x12f728, throwable: 0x4b, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x4b, tmpRootsCount: 1
Initializing class: 'javax/microedition/lcdui/Font'
Initializing class: 'javax/microedition/lcdui/Screen'
Initializing class: 'javax/microedition/lcdui/ImageItem'
TRY(3): env: 0x12f728, throwable: 0xb3, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xb3, tmpRootsCount: 1
Initializing class: 'com/sun/midp/lcdui/DisplayDeviceAccess'
THROW(2):   env: 0x12f7f8, throwable: 0x361c5f0, tmpRootsCount: 0
CATCH(2):   env: 0x12f7f8, throwable: 0x3594a88, tmpRootsCount: 0
Exception: java/lang/NullPointerException
TRY(2): env: 0x12f7f8, throwable: 0x3594a88, tmpRootsCount: 0
Exception: java/lang/NullPointerException
TRY(3): env: 0x12f728, throwable: 0xd, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xd, tmpRootsCount: 1
Initializing class: 'com/sun/midp/content/InvocationStore'
TRY(3): env: 0x12f728, throwable: 0x1003d69f, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x1003d69f, tmpRootsCount: 1
Initializing class: 'javax/microedition/midlet/MIDletProxy'
TRY(3): env: 0x12f728, throwable: 0x35957b4, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0x35957b4, tmpRootsCount: 1
Initializing class: 'javax/microedition/lcdui/List'
TRY(3): env: 0x12f728, throwable: 0xb2, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xb2, tmpRootsCount: 1
Initializing class: 'javax/microedition/lcdui/ChoiceGroup'
TRY(3): env: 0x12f708, throwable: 0x361fa04, tmpRootsCount: 2
Loading class 'com/sun/cldc/i18n/j2me/CP1256_Writer'
THROW(3):   env: 0x12f708, throwable: 0x361fa04, tmpRootsCount: 2
CATCH(3):   env: 0x12f708, throwable: 0x3593ba0, tmpRootsCount: 2
THROW(2):   env: 0x12f7f8, throwable: 0x3594a88, tmpRootsCount: 0
CATCH(2):   env: 0x12f7f8, throwable: 0x3593ba0, tmpRootsCount: 0
Exception: java/lang/ClassNotFoundException
TRY(2): env: 0x12f7f8, throwable: 0x3593ba0, tmpRootsCount: 0
TRY(3): env: 0x12f728, throwable: 0xb4, tmpRootsCount: 1
CATCH(3):   env: 0x12f728, throwable: 0xb4, tmpRootsCount: 1
Initializing class: 'com/sun/kvem/cldc/i18n/j2me/GenericReader'
Garbage collecting...
Collected 511776 bytes of garbage (2017472/2097152 bytes free)
TRY(3): env: 0x12f708, throwable: 0x361f81c, tmpRootsCount: 2
Loading class 'mainPackage/mainClass'
Garbage collecting...
Collected 3268 bytes of garbage (1950216/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1946120/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1944072/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1942024/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1939976/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1937928/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1935880/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1933832/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1931784/2097152 bytes free)
Garbage collecting...
Collected 8144 bytes of garbage (1937880/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1935832/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1933784/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1931736/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1929688/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1927640/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1925592/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1923544/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1921496/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1919448/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1917400/2097152 bytes free)
Garbage collecting...
Collected 0 bytes of garbage (1915352/2097152 bytes free)
Class loaded ok
Linking class: 'mainPackage/mainClass'
Class linked ok
CATCH(3):   env: 0x12f708, throwable: 0x361f81c, tmpRootsCount: 2
Error verifying method mainPackage/mainClass notifyIncomingMessage(Ljavax/wireless/messaging/MessageConnection;)V
Method............: 1024a748 'com/sun/midp/midlet/MIDletState.createMIDlet (static)' 
Stack Chunk.......: 342102c
Frame Pointer.....: 3421084
Approximate bytecode offset 4: Inconsistent or missing stackmap at target
Current IP........: 1035d4e7 = 1035d4ca + offset 29

Previous Frame....: 342104c
Previous IP.......: 103f6e20 (offset 22)
Frame size........: 7 (1 arguments, 6 local variables)
Argument[0].......: 3421964
Local[1]..........: 0
Local[2]..........: 35909ec
Local[3]..........: 3432534
Local[4]..........: 3590a00
Local[5]..........: 1028f4ac
Local[6]..........: 35909cc
Operand[1]........: 361f7e0

Method............: 102b14c8 'com/sun/midp/midlet/Selector.run (virtual)' 
Stack Chunk.......: 342102c
Frame Pointer.....: 342104c
Current IP........: 103f6e20 = 103f6e0a + offset 22
Previous Frame....: 0
Previous IP.......: 1
Frame size........: 6 (1 arguments, 5 local variables)
Argument[0].......: 3421b68
Local[1]..........: 343261c
Local[2]..........: 3421964
Local[3]..........: 0
Local[4]..........: 0
Local[5]..........: 0
Operand[1]........: 343261c

VM status:
Instruction pointer.: 1035d4e7 (offset within invoking method: 29)
Next instruction....: 0x4c
Frame pointer.......: 3421084
Local pointer.......: 3421068
Stack size..........: 128; sp: 342109c; ranges: 3421034-3421234;
Contents of the current stack frame:
    3421068: 3421964 (lp)
    342106c: 0
    3421070: 35909ec
    3421074: 3432534
    3421078: 3590a00
    342107c: 1028f4ac
    3421080: 35909cc
    3421084: 342104c (fp)
    3421088: 103f6e20
    342108c: 3421064
    3421090: 1024a748
    3421094: 342102c
    3421098: 0 (end of frame)
    342109c: 361f7e0 (sp)
Execution stack contains 108 items: 
3421b68  
343261c  
3421964  
0  
0  
0  
0  
1  
35909d0  
102b14c8  
342102c  
0  
343261c  
3421964  
0  
35909ec  
3432534  
3590a00  
1028f4ac  
35909cc  
342104c  
103f6e20  
3421064  
1024a748  
342102c  
0  
361f7e0  

Execution completed.
3690964 bytecodes executed
285 thread switches
1770 classes in the system (including system classes)
19842 dynamic objects allocated (658096 bytes)
23 garbage collections (523188 bytes collected)
CATCH(2):   env: 0x12f7f8, throwable: 0x3593ba0, tmpRootsCount: 0
ALERT: java/lang/VerifyError: mainPackage/mainClass.
Execution completed.
3690964 bytecodes executed
285 thread switches
1770 classes in the system (including system classes)
19842 dynamic objects allocated (658096 bytes)
23 garbage collections (523188 bytes collected) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:33:25.217

确保不要创建包含`javax`包的 jar 文件。`java`并且`javax`必须只能由虚拟机类路径使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T20:38:25.660

“Inconsistent or missing stackmap at target”表示类文件中的预验证信息不正确。

确保您指定`-microedition`，以便 ProGuard 预先验证 JME 的代码，而不是 JSE。

**不要**指定`-dontpreverify`. 您确实希望 ProGuard 预先验证代码。或者，您可以应用外部 JME 预验证器，但效率较低。

参照。ProGuard 手册 > 故障排除 >[验证错误](http://proguard.sourceforge.net/manual/troubleshooting.html#invalidclassexception2)

# linux - gcc：/usr/local/lib 中的链接库未找到，但 /etc/ld/so.conf.d/libc.conf 列出了它？

> ID：12234010
> 
> 赞同：14
> 
> 时间：2012-09-02T06:57:40.117
> 
> 标签：linux, gcc, shared-libraries

我遇到了共享库和 gcc 的问题。起初我无法运行我编译的程序，因为我收到以下错误：加载共享库时出现 gcc 错误。

我做了一些搜索，发现这是因为找不到共享库。但是我已经确定共享库位于 /usr/local/lib 中，AFAICT 是共享库的常用目录，应该从一开始就可以使用。

我读到您可以设置 LD_LIBRARY_PATH，这对我有用。但是我不想在每次我想运行我的程序时都设置这个。

进一步搜索建议编辑ld.so.conf。当我查看它时，它具有以下内容：

```
include /etc/ld.so.conf.d/*.conf 
```

查看 ld.so.conf.d 目录会显示一系列文件，包括 libc.conf。这个文件里面有以下内容：

```
/usr/local/lib 
```

所以我的问题是，当 ld.so.conf 似乎使用包含 /usr/local/lib 的 libc.conf 时，为什么我需要手动设置 LD_LIBRARY_PATH？

这里有什么我必须先配置的东西吗？编译时是否有我缺少的选项？

我应该注意，要编译，我必须指定库的路径，我不知道这是我的问题还是正常行为的症状。

我还应该注意到，当我在其他系统上部署我的软件时，这对我来说是一个问题。我原以为我应该能够将 .so 放在适当的位置并安装我的程序而不会弄乱 ld.so.conf。

我希望这是这个问题的适当论坛，我阅读了常见问题解答，我认为没关系。

干杯。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-02T09:10:32.313

You should run `ldconfig` (as root) after every change of the directories configured via `/etc/ld.so.conf` or under `/etc/ld.so.conf.d/`, in particular in your case after every update inside `/usr/local/lib` (e.g. after every addition or update of some shared libraries there).

# mingw-w64 - 与 MinGW-64 的静态链接

> ID：12234012
> 
> 赞同：5
> 
> 时间：2012-09-02T06:57:57.510
> 
> 标签：mingw-w64

[我正在尝试使用来自http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Automated%20Builds/](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Automated%20Builds/)的 64 位 MinGW，但是当我用它编译程序时，生成的可执行文件当 DLL 不可用时失败。

如何让这个编译器与标准库进行静态链接？

还是我应该使用另一种 64 位 MinGW 发行版？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:31:03.337

g++ 开关应该是

```
 -static 
```

请参阅 [http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)。

```
 -static
        On systems that support dynamic linking, this prevents linking with
    the shared libraries. On other systems, this option has no effect. 
```

您应该发布用于编译/链接的命令行，以便在这对您不起作用时获得更多帮助。

# javascript - onbeforeunload 未正确触发

> ID：12234014
> 
> 赞同：-2
> 
> 时间：2012-09-02T06:58:35.153
> 
> 标签：javascript, jquery, onbeforeunload

我无法弄清楚为什么脚本不能与表单一起使用。为什么不`$("form").submit(function()`使用 id 调用表单`form`？这个脚本甚至没有执行，`window.onbeforeunload`所以我猜这个脚本有问题。有谁知道出了什么问题？

```
<form id="formID" class="access_form" name="form" method="post" action="site.com">          
    <div class="row">
        <label for="email">Email Address:</label>
        <input class="txt_email" type="text" id="email" name="email" value="" onfocus="if(this.value==this.defaultValue)this.value='';" onblur="if(this.value=='')this.value=this.defaultValue;" />
    </div>
    <div class="row">
        <input type="submit" class="btn_access"  value="Get Immediate Access" name="submit1" />
    </div>
</form> 
```

JavaScript：

```
var formHasChanged = false;
var submitted = false; 

$(document).on('change', 'form.confirm-navigation-form input, form.confirm-navigation-form
select, form.confirm-navigation-form textarea', function (e) { 
    formHasChanged = true; 
}); 

$(document).ready(function () { 
    window.onbeforeunload = function (e) { 
        if (formHasChanged && !submitted) { 
            var message = "Please enter your email", e = e || window.event; 
            if (e) { 
                e.returnValue = message; 
            } 
            return message; 
        } 
    }
$("#formID").submit(function () { 
 submitted = true; 
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T07:38:35.120

试试这个。表单的 id 是表单本身。所以使用 jQuery 选择这样的表单

```
$("#form").submit(function () {
  submitted = true;
}); 
```

或者

或者尝试为表单提供另一个 id，例如“formID”。然后像这样选择使用该 id。

```
$("#formID").submit(function () {
  submitted = true;
}); 
```

# node.js - 在管道时使用 mikeal 的请求，如何监听事件以使用进度条显示进度

> ID：12234018
> 
> 赞同：1
> 
> 时间：2012-09-02T06:59:06.727
> 
> 标签：node.js, request, progress-bar

我正在编写一个模块，使用 mikeal 的请求在管道传输时上传和下载文件，如何监听事件以使用进度条显示进度，请给我一些示例，谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T14:45:01.973

我在 NPM 注册表上快速搜索并找到了[progress](https://npmjs.org/package/progress)，这是一个在命令行中显示进度条的模块。它看起来不错，甚至还有一个示例显示如何使用它来显示下载进度。我在这里复制它：

```
var ProgressBar = require('progress')
  , https = require('https');

var req = https.request({
    host: 'download.github.com'
  , port: 443
  , path: '/visionmedia-node-jscoverage-0d4608a.zip'
});

req.on('response', function(res){
  var len = parseInt(res.headers['content-length'], 10);

  console.log();
  var bar = new ProgressBar('  downloading [:bar] :percent :etas', {
      complete: '='
    , incomplete: ' '
    , width: 20
    , total: len
  });

  res.on('data', function(chunk){
    bar.tick(chunk.length);
  });

  res.on('end', function(){
    console.log('\n');
  });
});

req.end(); 
```

上面的代码将生成一个如下所示的进度条：

```
downloading [=====             ] 29% 3.7s​ 
```

请注意他如何检查`content-length`标题以获取正在下载的文件的长度并使用它来计算完成百分比。然后它将每个块的长度传递给进度条。

# ruby - 在这种情况下，Regex 比数组比较快吗？

> ID：12234019
> 
> 赞同：4
> 
> 时间：2012-09-02T06:59:08.133
> 
> 标签：ruby, regex, arrays, performance, parsing

假设我有一个传入的字符串，我想扫描它以查看它是否包含我选择的任何单词“坏”。:)

将字符串拆分为数组是否更快，并将坏词保留在数组中，然后遍历每个坏词以及每个传入的词，看看是否有匹配，有点像：

```
badwords.each do |badword|
 incoming.each do |word|
  trigger = true if badword == word
 end
end 
```

或者这样做是否更快：

```
incoming.each do |word|
 trigger = true if badwords.include? word
end 
```

或者将字符串保持原样并使用看起来像这样的正则表达式运行 .match() 是否更快：

```
/\bbadword1\b|\bbadword2\b|\bbadword3\b/ 
```

还是性能差异几乎可以忽略不计？想知道这个有一段时间了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T08:33:54.000

通过在找到匹配项时不停止循环，您正在为正则表达式提供优势。尝试：

```
incoming.find{|word| badwords.include? word} 
```

我的钱仍在正则表达式上，但应该简化为：

```
/\b(badword1|badword2|badword3)\b/ 
```

或者让它成为一场公平的战斗：

```
/\a(badword1|badword2|badword3)\z/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T07:10:48.217

编译后，Regex 是现实生活中最快的（即非常长的传入字符串，许多类似的坏词等），因为它可以`incoming` [在原地](http://en.wikipedia.org/wiki/In-place_algorithm)运行，并且可以很好地处理“坏词”的重叠部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T08:50:56.590

答案可能取决于要检查的坏词的数量：如果只有一个坏词，它可能不会产生太大的影响，如果有 50 个，那么检查一个数组可能会变慢。另一方面，对于数万或数十万个单词，正则表达式可能也不会太快

如果您需要处理大量坏词，您可能需要考虑拆分成单个词，然后使用布隆过滤器来测试该词是否可能是坏词。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-02T09:40:36.587

这并不能完全回答您的问题，但这肯定有助于解决它。

举一些你想要达到的例子，并将它们作为基准。

[你可以在这里](http://ruby.about.com/od/tasks/f/benchmark.htm)找到如何在 ruby​​ 中进行基准测试

只需将各种表格放在报告块之间并获取基准并自行决定最适合您的方式。

[http://ruby.about.com/od/tasks/f/benchmark.htm](http://ruby.about.com/od/tasks/f/benchmark.htm)

[http://ruby-doc.org/stdlib-1.9.3/libdoc/benchmark/rdoc/Benchmark.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/benchmark/rdoc/Benchmark.html)

为了获得更好的解决方案，请使用真实数据进行测试。

基准总是比讨论更好:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-03T06:10:25.913

如果要扫描字符串以查找单词的出现，请使用[`scan`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-scan)查找它们。

用于[`Regexp.union`](http://www.ruby-doc.org/core-1.9.3/Regexp.html#method-c-union)构建将在黑名单中查找字符串的模式。您将希望将结果包装`\b`为强制匹配单词边界，并使用不区分大小写的搜索。

为了让您了解如何`Regexp.union`提供帮助：

```
words = %w[foo bar]

Regexp.union(words)
=> /foo|bar/

'Daniel Foo killed him a bar'.scan(/\b#{Regexp.union(words)}\b/i)
=> ["foo", "bar"] 
```

您也可以使用`Regexp.new`或者`/.../`如果您想要更多控制来构建模式：

```
Regexp.new('\b(?:' + words.join('|') + ')\b', Regexp::IGNORECASE)
=> /\b(?:foo|bar)\b/i

/\b(?:#{words.join('|')})\b/i
=> /\b(?:foo|bar)\b/i

'Daniel Foo killed him a bar'.scan(/\b(?:#{words.join('|')})\b/i)
=> ["Foo", "bar"] 
```

作为一个忠告，你觉得冒犯性的黑名单词很容易被用户欺骗，并且经常给出错误的结果，因为许多“冒犯性”的词只在特定的上下文中是令人反感的。用户可能会故意拼错它们或使用“l33t”说话，并拥有几乎取之不尽的替代拼写，这将使您不断更新您的列表。对某些人来说，愚弄系统是一种乐趣。

我曾经接到过类似的任务，并写了一个翻译器来为“冒犯性”单词提供替代拼写。我从从 Internet 上收集到的单词和术语列表开始运行我的代码。在向数据库添加了数百万个替代项之后，我拔掉了插头并向管理人员表明这是一项愚蠢的任务，因为愚弄它是微不足道的。

# objective-c - 如何设置 kAudioUnitSubType_Distortion

> ID：12234023
> 
> 赞同：36
> 
> 时间：2012-09-02T07:01:06.670
> 
> 标签：objective-c, ios, core-audio, audiounit

我正在尝试编写一个添加音效的 iOS 应用程序。我正在尝试在 auconverter 和 remoteIO 之间放置一个效果音频单元（例如，失真和混响）。设置好所说的AU后，没有声音。

```
 NewAUGraph(&mAuGraph);
    AUGraphOpen(mAuGraph);

    AUNode remoteOutputNode, converterNode, effectNode;
    AudioUnit remoteIOAudioUnit, converterUnit, effectUnit;

    AudioComponentDescription cd;

    cd.componentManufacturer = kAudioUnitManufacturer_Apple;
    cd.componentFlags = cd.componentFlagsMask = 0;

    // remote io
    cd.componentType = kAudioUnitType_Output;
    cd.componentSubType = kAudioUnitSubType_RemoteIO;
    AUGraphAddNode(mAuGraph, &cd, &remoteOutputNode);

    // converter
    cd.componentType = kAudioUnitType_FormatConverter;
    cd.componentSubType = kAudioUnitSubType_AUConverter;
    AUGraphAddNode(mAuGraph, &cd, &converterNode);

    // ipodeq
    cd.componentType = kAudioUnitType_Effect;
    cd.componentSubType = kAudioUnitSubType_Distortion;
    AUGraphAddNode(mAuGraph, &cd, &effectNode);

    //callback
    AURenderCallbackStruct callbackStruct;
    callbackStruct.inputProc = renderCallback;
    callbackStruct.inputProcRefCon = &audioDataInfo;
    AUGraphSetNodeInputCallback(mAuGraph, converterNode, 0, &callbackStruct);

    // set audio unit asbd
    AudioStreamBasicDescription audioFormat = AUCanonicalASBD(44100.0, audioDataInfo.inputFormat.mChannelsPerFrame);
    AUGraphNodeInfo(mAuGraph, converterNode, NULL, &converterUnit);

    AudioUnitSetProperty(converterUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Input, 0, &audioDataInfo.inputFormat, sizeof(AudioStreamBasicDescription));
    AudioUnitSetProperty(converterUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Output, 0, &audioFormat, sizeof(AudioStreamBasicDescription));

    // get effect unit
    AUGraphNodeInfo(mAuGraph, effectNode, NULL, &effectUnit);

    // set effect unit asbd
    AudioUnitSetProperty(effectUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Input, 0, &audioFormat, sizeof(AudioStreamBasicDescription));
    AudioUnitSetProperty(effectUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Output, 0, &audioFormat, sizeof(audioFormat));

    // set remoteio unit asbd
    AUGraphNodeInfo(mAuGraph, remoteOutputNode, 0, &remoteIOAudioUnit);
    AudioUnitSetProperty(remoteIOAudioUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Input, 0, &audioFormat, sizeof(AudioStreamBasicDescription));

    AUGraphConnectNodeInput(mAuGraph, converterNode, 0, effectNode, 0);
    AUGraphConnectNodeInput(mAuGraph, effectNode, 0, remoteOutputNode, 0);

    AUGraphInitialize(mAuGraph); 
```

在`AUGraphConnectNodeInput`部分，如果没有

```
AUGraphConnectNodeInput(mAuGraph, converterNode, 0, effectNode, 0);
AUGraphConnectNodeInput(mAuGraph, effectNode, 0, remoteOutputNode, 0); 
```

但

```
AUGraphConnectNodeInput(mAuGraph, converterNode, 0, remoteOutputNode, 0); 
```

它产生没有效果的声音。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T15:22:57.080

诚然，我之前对您的问题一无所知，所以我稍微查看了您的代码，并查看了 Mac 开发人员的[CoreAudioOverview.pdf](https://developer.apple.com/library/Mac/documentation/MusicAudio/Conceptual/CoreAudioOverview/CoreAudioOverview.pdf)，这让我无所适从。我没有在您的代码中看到任何太偷偷摸摸的事情。它看起来很紧，但我确实想知道这些行：

```
// set effect unit asbd
AudioUnitSetProperty(effectUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Input, 0, &audioFormat, sizeof(AudioStreamBasicDescription));
AudioUnitSetProperty(effectUnit, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Output, 0, &audioFormat, sizeof(audioFormat)); 
```

最特别的是为什么这里有两行。你不应该只有第一行吗？

只是一个想法。

如果那没有价值，那么，您是否检查过以确保您的音频图都已正确连接。你也可以尝试不同的效果，看看是否有效？

在这个项目上取得了很好的成功。干杯！

# arrays - 查找排序数组中的所有对 (x, y)，使得 x + y < z

> ID：12234027
> 
> 赞同：7
> 
> 时间：2012-09-02T07:02:20.217
> 
> 标签：arrays, algorithm, language-agnostic

这是一道面试题。给定一个排序的整数数组和数字 z，找到数组中的所有对 (x, y)，使得 x + y < z。能比 O(n^2) 做得更好吗？

PS 我知道我们可以在 O(N) 中找到所有对 (x, y | x + y == z)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T07:05:55.253

您不一定能在 O(n) 时间内找到所有此类对，因为可能存在 O(n ² ) 对具有此属性的值。一般来说，一个算法的运行时间不能少于它产生的值的数量。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-02T07:06:24.097

在生成中，不，它不能。考虑在数组中`x + y < z`对于 all`x`的情况。`y`您必须触摸（例如显示）`n(n - 1)/2`集合中所有可能的配对。这基本上是 O(n^2)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T07:18:56.217

如果要求您输出满足该属性的所有对，我认为没有什么比 O(N^2) 更好的了，因为输出中可以有 O(N^2) 对。

但这对于 x + y = z 也是如此，您声称有一个 O(N) 解决方案 - 所以我可能会遗漏一些东西。

我怀疑最初的问题是询问配对的数量。在这种情况下，它可以在 O(N log(N)) 中完成。对于每个元素 x 找出 y = z - x 并在数组中对 y 进行二进制搜索。y 的位置给出了可以用 x 的特定值形成的对数。将数组中的所有值相加即可得出答案。有 N 个值，如果每个对需要 O(log(N))（二分搜索），则找到数量，所以整个事情是 O(N log(N))。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T07:21:00.203

因为它是一个**排序**的整数数组，所以可以使用二分**查找算法**，所以最好的是`O(N)`，最差的是`O(N*logN)`，平均情况也是`O(N*logN)`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-02T07:13:18.200

如果添加每个元素唯一的附加约束，您可以在 O(N) 中*找到它们。*

在找到所有 x+y==z 对之后，您知道对于满足该条件的每个 x 和 y，每个低于其对的索引的 x 或 y（选择一个）满足 x+y < z健康）状况。

实际上选择这些并输出它们需要 O(n^2)，但从某种意义上说，x+y==z 对是答案的压缩形式，以及输入。

（您可以将输入预处理为每个元素都是唯一的表单，以及出现次数的计数器。这将花费 O(N) 时间。您可以将此解决方案推广到未排序的数组，将时间增加到 O(nlogn) .)

说在与解的大小成线性比例的时间内找到对的理由：假设问题是“0 和给定输入 K 之间的整数是什么”？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-02T08:30:12.320

您可以对数组进行排序，对于小于 z 的每个元素，使用二进制搜索 - 总 O(NlogN)。

总运行时间：O(|P| + NlogN)，其中 P 是结果对。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-17T10:51:38.903

这个问题实际上存在一个 O(nlogn) 解决方案。我要做的（在首先检查我是否被允许这样做之后）是定义我的算法/函数的输出格式。

我会将其定义为一系列元素（S，T）。S - 数组中元素的位置（或其值）。T - 子数组 [0,T] 的位置。因此，例如，如果 T=3，则表示元素 S 与元素 0、1、2 和 3 组合满足所需条件。

总的结果是 O(nlogn) 运行时间和 O(n) 内存。

# php - 循环遍历数组并应用 preg_match

> ID：12234028
> 
> 赞同：-1
> 
> 时间：2012-09-02T07:02:29.767
> 
> 标签：php

我需要遍历一个多维数组，如果不是以字母开头，则只检查标题，如下所示：

```
Array
(
    [0] => Array
        (
            [letter] =>  
            [id] => 176
        )

    [1] => Array
        (
            [letter] => "
            [id] => 175
        )
.....etc 
```

所以如果不是以 a-zA-z 开头，我只需要检查字母，我已经尝试这样做，但仍然缺少一些东西，，

```
$notMatch = array();
foreach ($data as $value) {
    foreach ($value as $item['title']=>$d) {

       if(!preg_match('/^[a-zA-Z]$/',$d)){
           $notMatch[]=$d;
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:14:22.363

我删除了一个 foreach 循环并更改了您的 preg_match 模式，删除了字符串/行的开头和字符串/行锚点的结尾。

我是这样做的：

```
// I'm assuming your data array looks something like this:
$data = array(array('title'=>'fjsdoijsdiojsd', 'id'=>3),
                    array('title'=>'oijijsd', 'id'=>5),
                    array('title'=>'09234032', 'id'=>3));

$notMatch = array();
foreach ($data as $value) {
   if(!preg_match('/([a-zA-Z]).*/',$value['title'])){
       $notMatch[]=$value['title'];
       echo 'notmatch! ' . $value['title'];
   }
} 
```

但是，很有可能拥有更多正则表达式经验的人可以为您提供更好的模式。:)

[http://codepad.viper-7.com/dvUQoW](http://codepad.viper-7.com/dvUQoW)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:06:25.347

请参阅下面的 URL，我认为这对您很有帮助。

**更新：**

[在多维数组上使用 preg_match 返回键值数组](https://stackoverflow.com/questions/6281700/using-preg-match-on-a-multidimensional-array-to-return-key-values-arrays)

**试试看**

```
<?php
$data = array(
    "abc"=>array(
            "label" => "abc",
            "value" => "def",
            "type" => "ghi",
            "desc" => "jkl",
            ),
    "def"=>array(
            "label" => "mno",
            "value" => "qrs",
            "type" => "tuv",
            "desc" => "wxyz",
            ),
    );

$matches = array();
$pattern = "/a/i";  //contains an 'a'
//loop through the data
foreach($data as $key=>$value){
    //loop through each key under data sub array
    foreach($value as $key2=>$value2){
        //check for match.
        if(preg_match($pattern, $value2)){
            //add to matches array.
            $matches[$key]=$value;
            //match found, so break from foreach
            break;
        }
    }
}
echo '<pre>'.print_r($matches, true).'</pre>';
?> 
```

# jenkins - 将源代码和二进制文件目录传递给 Sonar

> ID：12234038
> 
> 赞同：0
> 
> 时间：2012-09-02T07:05:38.547
> 
> 标签：jenkins, sonarqube, jenkins-plugins

我正在通过 Jenkins Sonar 插件设置 Sonar，我对 Sonar 解释我给它的目录的方式有几个问题。

1.  `sources=srcDir1,srcDir2`：据我了解，这是我传递项目的源目录的地方。我的项目实际上是一个多项目，里面有很多源目录。是否可以为 Sonar 提供项目的根路径，Sonar 会知道深入并找到每个项目`.java`文件？还是我必须给它每个源目录？另外，如果我有`src/com/mycompany/myproj/...`包结构，我是否必须给它结束路径，或者 src 路径就足够了？
2.  `binaries=binDir`：这里我应该给Sonar编译`.class`代码或打包`.jar / .war / .ear`文件的路径，这样Findbugs才能工作。同样的问题：我没有所有编译类的中心位置，所以我必须指定每个路径吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:08:39.590

Sonar ANT 任务包含有关如何配置 Sonar 以分析多模块构建的部分：

*   [http://docs.codehaus.org/display/SONAR/Analyzing+with+Ant+Task](http://docs.codehaus.org/display/SONAR/Analyzing+with+Ant+Task)

# internet-explorer - DWebBrowserEvent2 的下沉事件挂起导航

> ID：12234042
> 
> 赞同：1
> 
> 时间：2012-09-02T07:06:26.953
> 
> 标签：internet-explorer, winapi, visual-c++, com, automation

我有一个问题，就像[下沉 DWebBrowserEvents2 事件中的 JimEvans 似乎挂起编程导航](https://stackoverflow.com/questions/3919170/sinking-dwebbrowserevents2-events-appears-to-hang-programmatic-navigation)但我无法理解答案，有人可以告诉我更多信息吗？

我正在通过普通 C++ 操作 IE Explorer。一些代码是从 Codeproject 复制而来的。但是当我处理事件时，我的 IE 挂起，并且在我的主函数完成之前我无法获得 DISPID_NAVIGETCOMPLETE 事件。

我的代码如下：

```
#include <afxwin.h>
#include <afxdisp.h>
#include <iostream>
#include <MsHTML.h>
#include <Exdisp.h>
#include <ExDispid.h>

class IE_Events_Sinker : public DWebBrowserEvents2
{

public:
// No constructor or destructor is needed
// IUnknown methods
STDMETHODIMP QueryInterface(REFIID riid,void **ppvObject);
STDMETHODIMP_(ULONG) AddRef();
STDMETHODIMP_(ULONG) Release();
// IDispatch methods
STDMETHODIMP GetTypeInfoCount(UINT *pctinfo);
STDMETHODIMP GetTypeInfo(UINT iTInfo,LCID lcid,ITypeInfo **ppTInfo);
STDMETHODIMP GetIDsOfNames(REFIID riid,LPOLESTR *rgszNames,UINT cNames,LCID lcid,DISPID *rgDispId);
STDMETHODIMP Invoke(DISPID dispIdMember,REFIID riid,LCID lcid,WORD wFlags,
    DISPPARAMS *pDispParams,VARIANT *pVarResult,EXCEPINFO *pExcepInfo,UINT   *puArgErr);
};

IE_Events_Sinker IESinker;

STDMETHODIMP IE_Events_Sinker::Invoke(DISPID dispIdMember, 
    REFIID riid, 
    LCID lcid, 
    WORD wFlags, 
    DISPPARAMS FAR* pDispParams, 
    VARIANT FAR* pVarResult, 
    EXCEPINFO FAR* pExcepInfo, 
    unsigned int FAR* puArgErr )
{
switch(dispIdMember)
{
case DISPID_NAVIGATEERROR:
    {
    //Extract the status code from the DISPPARAMS structure
    VARIANT * vt_statuscode = pDispParams->rgvarg[1].pvarVal;
    DWORD  dwStatusCode =  vt_statuscode->lVal;
    //Extract the event's IDispatch pointer
    IDispatch *pdispFiredEvent = pDispParams->rgvarg[4].pdispVal;
    printf("Status Code: %d\n", dwStatusCode);
    break;
    }
case DISPID_NAVIGATECOMPLETE2:
    printf("Navigate Complete!\n");
    break;

case DISPID_BEFORENAVIGATE2:
    printf("Before Navigate is fired!\n");
    break;

default:
    //MessageBox(NULL, L"A Message", NULL, NULL);
    printf("A Message !\n the dispIdMemberis %d\n", dispIdMember);
    break;
}

return S_OK;
}

STDMETHODIMP IE_Events_Sinker::QueryInterface(REFIID riid,void **ppvObject)
{
// Check if ppvObject is a valid pointer
if(IsBadWritePtr(ppvObject,sizeof(void*))) return E_POINTER;
// Set *ppvObject to NULL
(*ppvObject)=NULL;
// See if the requested IID matches one that we support
// If it doesn't return E_NOINTERFACE
if(!IsEqualIID(riid,IID_IUnknown) && !IsEqualIID(riid,IID_IDispatch) && !IsEqualIID(riid,DIID_DWebBrowserEvents2)) return E_NOINTERFACE;
// If it's a matching IID, set *ppvObject to point to the global EventSink object
(*ppvObject)=(void*)&IESinker;
return S_OK;
}

STDMETHODIMP_(ULONG) IE_Events_Sinker::AddRef()
{
return 1; // We always have just one static object
}

STDMETHODIMP_(ULONG) IE_Events_Sinker::Release()
{
return 1; // Ditto
}

// We don't need to implement the next three methods because we are just a pure event sink
// We only care about Invoke() which is what IE calls to notify us of events

STDMETHODIMP IE_Events_Sinker::GetTypeInfoCount(UINT *pctinfo)
{
UNREFERENCED_PARAMETER(pctinfo);

return E_NOTIMPL;
}

STDMETHODIMP IE_Events_Sinker::GetTypeInfo(UINT iTInfo,LCID lcid,ITypeInfo **ppTInfo)
{
UNREFERENCED_PARAMETER(iTInfo);
UNREFERENCED_PARAMETER(lcid);
UNREFERENCED_PARAMETER(ppTInfo);

return E_NOTIMPL;
}

STDMETHODIMP IE_Events_Sinker::GetIDsOfNames(REFIID riid,LPOLESTR *rgszNames,UINT     cNames,LCID lcid,DISPID *rgDispId)
{
UNREFERENCED_PARAMETER(riid);
UNREFERENCED_PARAMETER(rgszNames);
UNREFERENCED_PARAMETER(cNames);
UNREFERENCED_PARAMETER(lcid);
UNREFERENCED_PARAMETER(rgDispId);

return E_NOTIMPL;
}

int main()
{
HRESULT hr;
IWebBrowser2* IWbr;

IConnectionPointContainer* pCPContainer;
IConnectionPoint* m_pConnectionPoint;

CoInitialize(NULL);

//hr = CoCreateInstance(CLSID_InternetExplorer, NULL, CLSCTX_LOCAL_SERVER, IID_IWebBrowser2, (void**)&IWbr);
hr = CoCreateInstance(CLSID_InternetExplorer, NULL, CLSCTX_LOCAL_SERVER, IID_IWebBrowser2, (void**)&IWbr);
IWbr->put_Visible(TRUE);

hr = IWbr->QueryInterface(IID_IConnectionPointContainer, (void**)&pCPContainer);

hr = pCPContainer->FindConnectionPoint(DIID_DWebBrowserEvents2, &m_pConnectionPoint);

//Important Point!
DWORD m_dwCookie;
m_pConnectionPoint->Advise(&IESinker, &m_dwCookie);

COleVariant vtEmpty;
BSTR url2 = SysAllocString(L"http://www.qq.com/");
IWbr->Navigate(url2, &vtEmpty, &vtEmpty, &vtEmpty, &vtEmpty);

Sleep(20000);
//hr = IWbr->Quit();
//while(FAILED(hr))
//{
    //a++;
    //hr = IWbr->Quit();
//}
//printf("shut down %d times\n", a);

m_pConnectionPoint->Unadvise(m_dwCookie);

m_pConnectionPoint->Release();
IWbr->Release();
pCPContainer->Release();

CoUninitialize();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T14:12:34.143

问题以及您所指问题中的答案是关于使用您的活动处理线程上的窗口消息，即所谓的“消息泵”。你做：

```
Sleep(20000); 
```

这就是问题的原因。相反，您应该等待并且您应该在等待时处理窗口消息。相反，它应该是一个循环发送消息，如下所示：

```
MSG Message;
while(PeekMessage(&Message, NULL, WM_NULL, WM_NULL, PM_REMOVE))
{
    TranslateMessage(&Message);
    DispatchMessage(&Message);
} 
```

因此，作为处理您的请求的一部分发布的`IE`或`COM`可能已经发布的窗口消息将到达目标窗口并得到处理。相反，您正在锁定线程，使其无法选择执行应执行的操作。然而，上面的循环只发送一次消息，所以如果你需要超时，你可以将它作为一个无限循环唤醒，在处理成功或失败的某些指示时唤醒，或者一个基于事件消息的循环唤醒一条消息并返回休眠状态，否则不会浪费 CPU 周期。

也就是说，您`Sleep`在 20 秒内仍在处理窗口消息可能是这样的（该片段应该适合复​​制/粘贴以进行替换）：

```
const ULONG nTimeoutTime = GetTickCount() + 20 * 1000; // In 20 seconds
const HANDLE hFakeEvent = CreateEvent(NULL, TRUE, FALSE, NULL);
for(; ; )
{
    const LONG nWaitTime = nTimeoutTime - GetTickCount();
    if(nWaitTime <= 0)
        break; // Timeout
    const DWORD nWaitResult = MsgWaitForMultipleObjects(1, &hFakeEvent, FALSE, nWaitTime, QS_ALLINPUT | QS_ALLPOSTMESSAGE);
    //ATLTRACE(_T("nWaitResult 0x%x\n"), nWaitResult);
    //ATLASSERT(nWaitResult == WAIT_OBJECT_0 + 1 || nWaitResult == WAIT_TIMEOUT);
    if(nWaitResult == WAIT_TIMEOUT)
        break; // Timeout
    MSG Message;
    while(PeekMessage(&Message, NULL, WM_NULL, WM_NULL, PM_REMOVE))
    {
        //ATLTRACE(_T("Message.hwnd 0x%p, Message.message 0x%04x\n"), Message.hwnd, Message.message);
        TranslateMessage(&Message);
        DispatchMessage(&Message);
    }
}
CloseHandle(hFakeEvent); 
```

# ruby-on-rails - Rails 3，导入前检查CSV文件编码

> ID：12234046
> 
> 赞同：11
> 
> 时间：2012-09-02T07:07:40.803
> 
> 标签：ruby-on-rails, ruby, csv

在我的应用程序（Rails 3.0.5、Ruby 1.8.7）中，我创建了一个导入工具来从文件中导入 CSV 数据。

问题：我要求我的用户以 UTF-8 编码从 Excel 导出 CSV 文件，但他们大部分时间都不这样做。

如何在导入之前验证文件是否为 UTF-8？否则导入将运行但会给出奇怪的结果。我使用 FasterCSV 导入。

错误 CSV 文件的示例：

```
;VallÈe du RhÙne;CÙte Rotie; 
```

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-02T07:37:18.693

您可以使用 Charlock Holmes，一个用于 Ruby 的字符编码检测库。

[https://github.com/brianmario/charlock_holmes](https://github.com/brianmario/charlock_holmes)

要使用它，您只需读取文件并使用该`detect`方法。

```
contents = File.read('test.xml')
detection = CharlockHolmes::EncodingDetector.detect(contents)
# => {:encoding => 'UTF-8', :confidence => 100, :type => :text} 
```

如果格式不正确，您还可以将编码转换为 UTF-8：

```
utf8_encoded_content = CharlockHolmes::Converter.convert contents, detection[:encoding], 'UTF-8' 
```

这使用户不必在再次上传之前自己做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-02T08:16:43.250

对于 1.9，很明显，您只需告诉它期待 utf8，如果不是，它将引发错误：

```
begin
  lines = CSV.read('bad.csv', :encoding => 'utf-8')
rescue ArgumentError
  puts "My users don't listen to me!"
end 
```

# matlab - 在 Matlab 中存储迭代结果

> ID：12234048
> 
> 赞同：2
> 
> 时间：2012-09-02T07:08:27.487
> 
> 标签：matlab

我有下面的代码。

```
for k=40:10:80
 T(k)=273.15+k;
 z=[0.2 0.2 0.2 0.4];
 W_PR=0.245;
 C=4;
 omega=[0.344 0.467 0.578 0.789];
 Tc=[600 700 500 570];
 Pc=[50 70 58 76];
    for c=1:C

        x_PR(1,c)=z(c)/(1+W_PR*(K_PR(c)-1));
        x_PR(2,c)=K_PR(c)*x_PR(1,c);
    end
    for c=1:C
        kappa_PR=0.37464+1.54226.*omega(c)-0.26992.*omega(c).^2;
        alpha_PR=(1+kappa_PR.*(1-sqrt(T(k)./Tc(c)))).^2;
        a_PR(c,c)=0.45724.*R.^2.*Tc(c).^2./Pc(c).*alpha_PR;
        b_PR(c)=0.07780*R.*Tc(c)./Pc(c);
    end
    for c=2:C
        for n=1:(c-1)
            a_PR(c,n)=sqrt(a_PR(c,c).*a_PR(n,n));
            a_PR(n,c)=a_PR(c,n);
        end
    end
    for c=1:C
        A_PR(c,c)=a_PR(c,c).*P./(R.*T(k)).^2;
        B_PR(c)=b_PR(c).*P./(R.*T(k));
    end
    for c=1:C
        Z(c,c)=A_PR(c,c)./5;
        V(c)=B_PR(c).*6;
    end
end 
```

每次我运行代码时，我都想要每个 T(k) 的 Z 和 V 的结果。尽管我希望它运行循环并为所有 T(k) 给出 Z 和 V 的结果，但它的代码只给出了一个 T 值的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:01:07.197

您可能希望在主循环之外定义一些参数，以至少预分配存储空间。

```
Z_store = ones(C,C,5); % if you want to use a 3d matrix 
```

和

```
V_store = ones(5,C); 
```

新功能：

```
function [Z_store V_store] = SO_test1()
  z=[0.2 0.2 0.2 0.4];
  W_PR=0.245;
  C=4;
  omega=[0.344 0.467 0.578 0.789];
  Tc=[600 700 500 570];
  Pc=[50 70 58 76];
  R=8.314; 
  P=20; 
  Z_store = ones(C,C,5);
  V_store = ones(5,C);
  K_PR=[1.546e-2, 0.456, 1.432e2, 14.32];
  iter = 0;

for k=40:10:80

T(k)=273.15+k;
  for c=1:C
      x_PR(1,c)=z(c)/(1+W_PR*(K_PR(c)-1));
      x_PR(2,c)=K_PR(c)*x_PR(1,c);  
      kappa_PR=0.37464+1.54226.*omega(c)-0.26992.*omega(c).^2;
      alpha_PR=(1+kappa_PR.*(1-sqrt(T(k)./Tc(c)))).^2;
      a_PR(c,c)=0.45724.*R.^2.*Tc(c).^2./Pc(c).*alpha_PR;
      b_PR(c)=0.07780*R.*Tc(c)./Pc(c);
  end
  for c=2:C
      for n=1:(c-1)
          a_PR(c,n)=sqrt(a_PR(c,c).*a_PR(n,n));
          a_PR(n,c)=a_PR(c,n);
      end
  end
  for c=1:C
      A_PR(c,c)=a_PR(c,c).*P./(R.*T(k)).^2;
      B_PR(c)=b_PR(c).*P./(R.*T(k)); 
      Z(c,c)=A_PR(c,c)./5;
      V(c)=B_PR(c).*6;
  end
  iter = iter + 1;
  Z_store(:,:,iter) = Z;
  V_store(iter,:) = V;

  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T11:03:23.590

您的结果矩阵需要更高的维度`V`。`Z`从您的代码中，您只需将值分配给 Z 形式

```
 Z(c,c) = value 
```

和 V 的形式

```
 V(c) = value 
```

因此，您的 Z 似乎只是一个仅定义对角线条目的二维矩阵，而 V 只是一个简单的向量。您的迭代运行循环变量的所有值，`k`但每次您覆盖这些数组中的当前值。考虑制作`V`一个 2D 数组和`Z`一个 3D 数组，以便它们能够将结果存储在迭代变量的每个值的单独索引处`k`

# javascript - 带有mongoskin的时间戳如何？

> ID：12234049
> 
> 赞同：0
> 
> 时间：2012-09-02T07:09:04.380
> 
> 标签：javascript, node.js, mongodb

对于那些想要查询时间戳的人，您可以这样做：

```
> db.foo.find()
{ "_id" : ObjectId("4e43a21d84782019413162ed"), "a" : { "t" : 1313055261000, "i" : 1 } }
> db.foo.find({'a': {'$gte': new Timestamp(new Date(2011, 8-1, 11), 0) } })
{ "_id" : ObjectId("4e43a21d84782019413162ed"), "a" : { "t" : 1313055261000, "i" : 1 } }
> db.foo.find({'a': {'$gte': new Timestamp(new Date(2011, 8-1, 12), 0) } }) 
```

我在 mongodb 的页面中找到了该示例...但是如果我想按照示例使用 mongoskin 在 mongodb 中插入时间戳？？？

我试试这个：

```
db.collection('times').insert({time: new Timestamp(new Date('2012-08-06'),0)}) 
```

这是错误：

```
ReferenceError: Timestamp is not defined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:07:55.883

那是因为`Timestamp`没有定义。它既不是 JavaScript 也不是 Node 的一部分。您应该在使用前定义它。这应该有效：

```
var mongoskin = require('mongoskin');
var Timestamp = mongoskin.BSONPure.Timestamp; 
```

请注意，此`Timestamp`s 仅供[内部数据库使用](http://www.mongodb.org/display/DOCS/Timestamp+data+type)；为什么需要它们，当有`Date.now()`and时`new Date().getTime()`？

无论如何，这是一个包含更多细节的链接 - [http://mongodb.github.com/node-mongodb-native/api-bson-generated/timestamp.html](http://mongodb.github.com/node-mongodb-native/api-bson-generated/timestamp.html)。

# nginx - Nginx 大流量负载均衡

> ID：12234050
> 
> 赞同：21
> 
> 时间：2012-09-02T07:09:40.363
> 
> 标签：nginx, dns, kernel, load-balancing, tomcat6

在过去的 3 周里，我们一直在测试 Nginx 作为负载平衡。目前，我们无法成功处理超过 1000 个请求/秒和 18K 个活动连接。当我们达到上述数字时，Nginx 开始挂起，并返回超时代码。获得响应的唯一方法是大幅减少连接数量。

我必须注意，我的服务器可以并且确实每天处理这么多的流量，我们目前使用简单的轮询 DNS 平衡。

我们正在使用具有以下硬件的专用服务器：

*   英特尔至强 E5620 CPU
*   16GB 内存
*   2T SATA硬盘
*   1Gb/s 连接
*   操作系统：CentOS 5.8

我们需要对 7 个运行 Tomcat6 的后端服务器进行负载平衡，并在 peek 时间上处理超过 2000 个请求/秒，处理 HTTP 和 HTTPS 请求。

运行 Nginx 时，cpu 消耗约为 15%，使用的 RAM 约为 100MB。

我的问题是：

1.  有没有人尝试过使用 nginx 对这种流量进行负载平衡？
2.  你认为nginx可以处理这样的流量吗？
3.  你知道什么会导致挂起吗？
4.  我的配置是否遗漏了什么？

以下是我的配置文件：

## nginx.conf：

```
user  nginx;
worker_processes 10;

worker_rlimit_nofile 200000;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
    worker_connections  10000;
    use epoll;
    multi_accept on;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  /var/log/nginx/access.log  main;
    access_log off;

    sendfile        on;
    tcp_nopush     on;

    keepalive_timeout  65;
    reset_timedout_connection on;

    gzip  on;
    gzip_comp_level 1;
    include /etc/nginx/conf.d/*.conf;
} 
```

## 服务器.conf：

```
#Set the upstream (servers to load balance)
#HTTP stream
upstream adsbar {
  least_conn;
  server xx.xx.xx.34 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.36 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.37 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.39 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.40 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.42 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.43 max_fails=2 fail_timeout=15s;
}      

#HTTPS stream
upstream adsbar-ssl {
  least_conn;
  server xx.xx.xx.34:443 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.36:443 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.37:443 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.39:443 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.40:443 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.42:443 max_fails=2 fail_timeout=15s;
  server xx.xx.xx.43:443 max_fails=2 fail_timeout=15s;
}

#HTTP
server {
  listen xxx.xxx.xxx.xxx:8080;
  server_name www.mycompany.com;
  location / {
      proxy_set_header Host $host;
      # So the original HTTP Host header is preserved
      proxy_set_header X-Real-IP $remote_addr;
      # The IP address of the client (which might be a proxy itself)
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_pass http://adsbar;
  }
}

#HTTPS
server {
  listen xxx.xxx.xxx.xxx:8443;
  server_name www.mycompany.com;
  ssl on;
  ssl_certificate /etc/pki/tls/certs/mycompany.crt;
  # Path to an SSL certificate;
  ssl_certificate_key /etc/pki/tls/private/mycompany.key;
  # Path to the key for the SSL certificate;
  location / {
      proxy_set_header Host $host;
      # So the original HTTP Host header is preserved
      proxy_set_header X-Real-IP $remote_addr;
      # The IP address of the client (which might be a proxy itself)
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_pass https://adsbar-ssl;
  }
}

server {
    listen xxx.xxx.xxx.xxx:61709;
    location /nginx_status {
        stub_status on;
        access_log off;
        allow 127.0.0.1;
        deny all;
    }
} 
```

## sysctl.conf：

```
# Kernel sysctl configuration file for Red Hat Linux
#
# For binary values, 

0 is disabled, 1 is enabled.  See sysctl(8) and
# sysctl.conf(5) for more details.

# Controls IP packet forwarding
net.ipv4.ip_forward = 0

# Controls source route verification
net.ipv4.conf.default.rp_filter = 1

# Do not accept source routing
net.ipv4.conf.default.accept_source_route = 0

# Controls the System Request debugging functionality of the kernel
kernel.sysrq = 1

# Controls whether core dumps will append the PID to the core filename
# Useful for debugging multi-threaded applications
kernel.core_uses_pid = 1

# Controls the use of TCP syncookies
net.ipv4.tcp_syncookies = 1

# Controls the maximum size of a message, in bytes
kernel.msgmnb = 65536

# Controls the default maxmimum size of a mesage queue
kernel.msgmax = 65536

# Controls the maximum shared segment size, in bytes
kernel.shmmax = 68719476736

# Controls the maximum number of shared memory segments, in pages
kernel.shmall = 4294967296

fs.file-max = 120000
net.ipv4.ip_conntrack_max = 131072
net.ipv4.tcp_max_syn_backlog = 8196
net.ipv4.tcp_fin_timeout = 25
net.ipv4.tcp_keepalive_time = 3600
net.ipv4.ip_local_port_range = 1024 65000
net.ipv4.tcp_rmem = 4096 25165824 25165824
net.core.rmem_max = 25165824
net.core.rmem_default = 25165824
net.ipv4.tcp_wmem = 4096 65536 25165824
net.core.wmem_max = 25165824
net.core.wmem_default = 65536
net.core.optmem_max = 25165824
net.core.netdev_max_backlog = 2500
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_tw_reuse = 1 
```

任何帮助、指导和想法都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-02T19:33:11.050

这里有一些很好的参考：

[http://dak1n1.com/blog/12-nginx-performance-tuning](http://dak1n1.com/blog/12-nginx-performance-tuning)

服务器故障： [https ://serverfault.com/questions/221292/tips-for-maximizing-nginx-requests-sec](https://serverfault.com/questions/221292/tips-for-maximizing-nginx-requests-sec)

来自 dak1n1 链接的一个非常有据可查的配置：

```
# This number should be, at maximum, the number of CPU cores on your system. 
# (since nginx doesn't benefit from more than one worker per CPU.)
worker_processes 24;

# Number of file descriptors used for Nginx. This is set in the OS with 'ulimit -n 200000'
# or using /etc/security/limits.conf
worker_rlimit_nofile 200000;

# only log critical errors
error_log /var/log/nginx/error.log crit

# Determines how many clients will be served by each worker process.
# (Max clients = worker_connections * worker_processes)
# "Max clients" is also limited by the number of socket connections available on the system (~64k)
worker_connections 4000;

# essential for linux, optmized to serve many clients with each thread
use epoll;

# Accept as many connections as possible, after nginx gets notification about a new connection.
# May flood worker_connections, if that option is set too low.
multi_accept on;

# Caches information about open FDs, freqently accessed files.
# Changing this setting, in my environment, brought performance up from 560k req/sec, to 904k req/sec.
# I recommend using some varient of these options, though not the specific values listed below.
open_file_cache max=200000 inactive=20s; 
open_file_cache_valid 30s; 
open_file_cache_min_uses 2;
open_file_cache_errors on;

# Buffer log writes to speed up IO, or disable them altogether
#access_log /var/log/nginx/access.log main buffer=16k;
access_log off;

# Sendfile copies data between one FD and other from within the kernel. 
# More efficient than read() + write(), since the requires transferring data to and from the user space.
sendfile on; 

# Tcp_nopush causes nginx to attempt to send its HTTP response head in one packet, 
# instead of using partial frames. This is useful for prepending headers before calling sendfile, 
# or for throughput optimization.
tcp_nopush on;

# don't buffer data-sends (disable Nagle algorithm). Good for sending frequent small bursts of data in real time.
tcp_nodelay on; 

# Timeout for keep-alive connections. Server will close connections after this time.
keepalive_timeout 30;

# Number of requests a client can make over the keep-alive connection. This is set high for testing.
keepalive_requests 100000;

# allow the server to close the connection after a client stops responding. Frees up socket-associated memory.
reset_timedout_connection on;

# send the client a "request timed out" if the body is not loaded by this time. Default 60.
client_body_timeout 10;

# If the client stops reading data, free up the stale client connection after this much time. Default 60.
send_timeout 2;

# Compression. Reduces the amount of data that needs to be transferred over the network
gzip on;
gzip_min_length 10240;
gzip_proxied expired no-cache no-store private auth;
gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml;
gzip_disable "MSIE [1-6]\."; 
```

还有更多关于 sysctl.conf 的 linux 系统调优的信息：

```
# Increase system IP port limits to allow for more connections

net.ipv4.ip_local_port_range = 2000 65000

net.ipv4.tcp_window_scaling = 1

# number of packets to keep in backlog before the kernel starts dropping them 
net.ipv4.tcp_max_syn_backlog = 3240000

# increase socket listen backlog
net.core.somaxconn = 3240000
net.ipv4.tcp_max_tw_buckets = 1440000

# Increase TCP buffer sizes
net.core.rmem_default = 8388608
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_rmem = 4096 87380 16777216
net.ipv4.tcp_wmem = 4096 65536 16777216
net.ipv4.tcp_congestion_control = cubic 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T09:54:59.687

nginx 肯定能够处理超过 1000 个请求/秒（我在使用 jmeter 的廉价笔记本电脑上使用 2 个内核中的一个和一半时在 nginx 中获得大约 2800 个请求/秒）

您正在使用 epoll，据我了解，这是当前 linux 内核上的最佳选择。

您已经关闭了 acces_log，因此您的磁盘 IO 也不应该成为瓶颈（注意：您还可以将 access_log 设置为具有大缓冲区的缓冲模式，它只在每个 x kb 之后写入，这样可以避免磁盘 io不断被锤击，但保留日志以供分析）

我的理解是，为了最大化 nginx 性能，您通常将 worker_processes 的数量设置为等于核心/cpu 的数量，然后增加 worker_connections 的数量以允许更多的并发连接（以及打开文件的数量限制）。然而，在您上面发布的数据中，您有一个四核 cpu，有 10 个工作进程，每个进程允许 10k 个连接。因此，在 nginx 方面，我会尝试类似的方法：

```
worker_processes 4;
worker_rlimit_nofile 999999;
events {
  worker_connections 32768;
  use epoll;
  multi_accept on;
} 
```

在内核方面，我会以不同的方式调整 tcp 读写缓冲区，你需要一个小的最小值、小的默认值和大的最大值。

您已经扩大了临时端口范围。

我会增加打开文件的数量限制，因为您将有很多打开的套接字。

这提供了以下几行以在您的 /etc/sysctl.conf 中添加/更改

```
net.ipv4.tcp_rmem = 4096 4096 25165824                                
net.ipv4.tcp_wmem = 4096 4096 25165824
fs.file-max=999999 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-15T15:41:59.837

我发现使用最小连接算法是有问题的。我切换到

```
hash $remote_addr consistent; 
```

并更快地找到了服务。

# c - 打印分区表-C程序

> ID：12234051
> 
> 赞同：10
> 
> 时间：2012-09-02T07:09:53.427
> 
> 标签：c, linux, filesystems, operating-system, partitioning

我正在尝试使用 C 编程语言打印分区表，一切似乎都工作正常：打开和阅读，但我不明白为什么它打印垃圾值。

这是代码：

```
struct partition
{
    unsigned char drive;
    unsigned char chs_begin[3];
    unsigned char sys_type;
    unsigned char chs_end[3];
    unsigned char start_sector[4];
    unsigned char nr_sector[4];
};

int main()
{
    int gc = 0, i = 1, nr = 0, pos = -1, nw = 0;
    int fd =0;
    char  buf[512] ;
    struct partition *sp;
    printf("Ok ");

    if ( (fd = open("/dev/sda", O_RDONLY | O_SYNC )) == -1)
    {
         perror("Open");
         exit(1);
    }
    printf("fd is %d \n", fd);

    pos = lseek (fd, 0, SEEK_CUR);

    printf("Position of pointer is :%d\n", pos);
    if ((nr = read(fd, buf, sizeof(buf))) == -1)
    {
        perror("Read");
        exit(1);
    }

    close(fd);

    printf("Size of buf = %d\n and number of bytes read are %d ", sizeof(buf), nr);

    if ((nw = write(1, buf, 64)) == -1)
    {
        printf("Write: Error");
        exit(1);
    }

    printf("\n\n %d bytes are just been written on stdout\n", nw,"this can also be printed\n");

    printf("\n\t\t*************Partition Table****************\n\n");

    for (i=0 ; i<4 ; i++)
    {
        sp = (struct partition *)(buf + 446 + (16 * i));
        putchar(sp -> drive);
    }

    return 0;
} 
```

它正在打印垃圾而不是分区表。

我可能有一些基本的理解问题，但我用谷歌搜索了很长时间，但并没有真正帮助。我还看到了 fdisk 的源代码，但目前超出了我的理解范围。有人可以指导我吗？我不指望有人能清除我的错误并给我工作代码。只需一两句话 - 或任何链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T18:32:32.490

试试这个：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

struct partition
{
        unsigned char boot_flag;        /* 0 = Not active, 0x80 = Active */
        unsigned char chs_begin[3];
        unsigned char sys_type;         /* For example : 82 --> Linux swap, 83 --> Linux native partition, ... */
        unsigned char chs_end[3];
        unsigned char start_sector[4];
        unsigned char nr_sector[4];
};

void string_in_hex(void *in_string, int in_string_size);
void dump_partition(struct partition *part, int partition_number);

void dump_partition(struct partition *part, int partition_number)
{
        printf("Partition /dev/sda%d\n", partition_number + 1);
        printf("boot_flag = %02X\n", part->boot_flag);
        printf("chs_begin = ");
        string_in_hex(part->chs_begin, 3);
        printf("sys_type = %02X\n", part->sys_type);
        printf("chs_end = ");
        string_in_hex(part->chs_end, 3);
        printf("start_sector = ");
        string_in_hex(part->start_sector, 4);
        printf("nr_sector = ");
        string_in_hex(part->nr_sector, 4);
}

void string_in_hex(void *in_string, int in_string_size)
{
        int i;
        int k = 0;

        for (i = 0; i < in_string_size; i++)
        {
                printf("%02x ", ((char *)in_string)[i]& 0xFF);
                k = k + 1;
                if (k == 16)
                {
                        printf("\n");
                        k = 0;
                }
        }
        printf("\n");
}

int main(int argc, char **argv)
{
        int /*gc = 0,*/ i = 1, nr = 0, pos = -1/*, nw = 0*/;
        int fd = 0;
        char  buf[512] ;
        struct partition *sp;
        int ret = 0;

        printf("Ok ");

        if ((fd = open("/dev/sda", O_RDONLY | O_SYNC)) == -1)
        {
                perror("Open");
                exit(1);
        }
        printf("fd is %d\n", fd);

        pos = lseek (fd, 0, SEEK_CUR);

        printf("Position of pointer is :%d\n", pos);
        if ((nr = read(fd, buf, sizeof(buf))) == -1)
        {
                perror("Read");
                exit(1);
        }

        ret = close(fd);
        if (ret == -1)
        {
                perror("close");
                exit(1);
        }

        /* Dump the MBR buffer, you can compare it on your system with the output of the command:
         * hexdump -n 512 -C /dev/sda
         */
        string_in_hex(buf, 512);

        printf("Size of buf = %d - and number of bytes read are %d\n", sizeof(buf), nr);
        /*if ((nw = write(1, buf, 64)) == -1)
        {
                printf("Write: Error");
                exit(1);
        }

        printf("\n\n%d bytes are just been written on stdout\nthis can also be printed\n", nw);
        */
        //printf("\n\t\t*************Partition Table****************\n\n");
        printf("\n\t\t*************THE 4 MAIN PARTITIONS****************\n\n");

        /* Dump main partitions (4 partitions) */
        /* Note : the 4 partitions you are trying to dump are not necessarily existing! */
        for (i = 0 ; i < 4 ; i++)
        {
                sp = (struct partition *)(buf + 446 + (16 * i));
                //putchar(sp->boot_flag);
                dump_partition(sp, i);
        }

        return 0;
} 
```

# asp.net-mvc - 首先自动生成继承映射 mvc DB

> ID：12234052
> 
> 赞同：0
> 
> 时间：2012-09-02T07:09:56.050
> 
> 标签：asp.net-mvc, entity-framework, c#-4.0, entity-framework-4

是否可以使用 BD 优先方法定义继承映射和鉴别器属性。

我使用 EDMX 图来定义表到对象的映射。我有一个 DomainEntity 表，其中包含我所有的域实体，它们由映射到 DomainEntityTypes 表的 TypeID 进行描述。

如果我有完全的控制权，我会这样设计映射：

1.  定义一个抽象类 DomainEntity
2.  继承 DomainEntity 类以创建具体实体
3.  在 TypeID 上使用继承映射注解和 IsDiscriminator 注解
4.  使用枚举来定义所有可能的类型（我想知道从那时起类型表的用途）

所有这些都可以以某种方式在 EDMX 文件中定义吗？还是我需要停止使用自动生成并继续手动映射？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T08:36:50.293

没有继承映射的“自动生成”。当您首先使用数据库时，您只需将表加载到模型中，它将创建具有关系的实体。现在，如果您想要继承，则必须从设计器中修改映射。[这](http://www.robbagby.com/entity-framework/entity-framework-modeling-table-per-hierarchy-inheritance/)是一个很好的描述如何在设计器中设置 TPH 继承。

1.  您可以将继承层次结构的基本实体定义为抽象的。它是图中实体的属性。
2.  您必须为要使用的所有类型继承一个新实体，并在映射中正确设置其鉴别器值。
3.  没有真正的注释 - 继承是工具箱中可用的构造，鉴别器是映射中定义的条件。
4.  你将没有枚举。鉴别器列甚至在您的实体中不可用，因为它已经用于定义正确类型的映射（存在限制，每个列在映射中只能使用一次，因此您可以将其用于属性或鉴别器，但不能用于两个都）。您将拥有一组有限的实体来描述您的继承层次结构，而不是枚举。

# google-app-engine - 从 Google App Engine 访问 REST Web 服务时出现意外

> ID：12234053
> 
> 赞同：0
> 
> 时间：2012-09-02T07:10:13.363
> 
> 标签：google-app-engine, jersey, jax-rs

我指的是[本](http://tugdualgrall.blogspot.in/2010/02/create-and-deploy-jax-rs-rest-service.html)教程，用于创建 REST Web 服务并在 GAE 中进行部署。本教程运行良好，我可以毫无问题地在本地运行。即使我能够成功部署在 GAE 中。但是当我尝试访问 url 时，出现以下错误

> 错误：服务器错误 服务器遇到错误，无法完成您的请求。
> 
> 如果问题仍然存在，请报告您的问题并提及此错误消息和导致它的查询。

并且 GAE 日志包含此消息

> servlet java.lang.IncompatibleClassChangeError 未捕获的异常：在 java.lang.ClassLoader.defineClass1(Native Method) 在 java.lang.ClassLoader 的 com.google.appengine.runtime.Request.process-78db28d34b15c040(Request.java) 实现类。 defineClass(ClassLoader.java:634) at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142) at java.net.URLClassLoader.defineClass(URLClassLoader.java:277) at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 在 java.lang.reflect.Method.invoke(Method.java:616) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:266) 在 com。 sun.jersey.api.core.ScanningResourceConfig.init(ScanningResourceConfig.java:79) 在 com.sun.jersey.api.core。PackagesResourceConfig.init(PackagesResourceConfig.java:104) 在 com.sun.jersey.api.core.PackagesResourceConfig.(PackagesResourceConfig.java:78) 在 com.sun.jersey.api.core.PackagesResourceConfig.(PackagesResourceConfig.java:89)在 com.sun.jersey.spi.container.servlet.WebComponent.createResourceConfig(WebComponent.java:700) 在 com.sun.jersey.spi.container.servlet.WebComponent.createResourceConfig(WebComponent.java:678) 在 com.sun .jersey.spi.container.servlet.WebComponent.init(WebComponent.java:203) 在 com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:374) 在 com.sun.jersey.spi org.mortbay.jetty.servlet.ServletHolder 的 javax.servlet.GenericServlet.init(GenericServlet.java:212) 的 .container.servlet.ServletContainer.init(ServletContainer.java:557)。initServlet(ServletHolder.java:440) 在 org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263) 在 org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) 在 org.mortbay.jetty .servlet.ServletHandler.initialize(ServletHandler.java:685) 在 org.mortbay.jetty.servlet.Context.startContext(Context.java:140) 在 org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250) ) 在 org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) 在 org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467) 在 org.mortbay.component.AbstractLifeCycle.start( AbstractLifeCycle.java:50) 在 com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:452) 在 com.google.tracing.TraceContext$TraceContextRunnable$1。在 com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:336) 在 com.google.tracing 的 com.google.tracing.TraceContext.runInContext(TraceContext.java:698) 运行(TraceContext.java:458) .TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:328) at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:456) at java.lang.Thread.run(Thread.java:679)TraceContext$TraceContextRunnable.run(TraceContext.java:456) 在 java.lang.Thread.run(Thread.java:679)TraceContext$TraceContextRunnable.run(TraceContext.java:456) 在 java.lang.Thread.run(Thread.java:679)

请任何人让我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T14:08:28.823

正如上面已经提到的，这是由于 asm.3.1.jar 和 asm-4.0.jar 之间的不兼容造成的。要解决此问题，请确保删除对 4.0 的引用并使用 Datanucelus API 1.0，因为 2.0 需要 4.0 的 asm。

我在这里写了关于这个问题的更深入的文章：

[GAE 1.7.2 和 Jersey 的问题](http://cloudvane.com/2012/09/23/problem-with-google-appengine-and-jersey-with-java/)

# asp-classic - 从 MySQL 加载字典

> ID：12234054
> 
> 赞同：0
> 
> 时间：2012-09-02T07:10:25.037
> 
> 标签：asp-classic

是否可以从 MySQL 查询加载经典 ASP 字典？如果是这样，你能告诉我我该怎么做或指出我做的方向吗？谢谢！

资源：[http ://www.w3schools.com/asp/asp_ref_dictionary.asp](http://www.w3schools.com/asp/asp_ref_dictionary.asp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:12:42.260

是的，您只需要查询您的 MySql DB，然后使用循环将所有记录插入到您的字典中。

我正在使用 JSctip ASP，因为那是我的示例，但是将其转换为 VB 非常容易，只需使用替代对象即可。

```
var Conn=Server.CreateObject("ADODB.Connection")
var RS=Server.CreateObject("ADODB.Recordset")
var ConnString = "Driver={SQL Server};Server="+PDServer+";Database="+PDDB+"; Uid="+PDUser+";Pwd="+PDPass+";"
Conn.open(ConnString)

var sqlStr = ""
sqlStr+="SELECT * "
sqlStr+="FROM [Table] "
sqlStr+="WHERE [CONDITION]"

RS = Conn.execute(sqlStr)

while (!RS.EOF)
{
    //myDictionary.add(key,value)   
}
Conn.close() 
```

# regex - 从 xsd 模式中引用类型

> ID：12234055
> 
> 赞同：1
> 
> 时间：2012-09-02T07:10:30.917
> 
> 标签：regex, xsd

我想通过我的办公室网络识别我的所有服务器。他们有一个特定的命名模式，只有我使用。我已经在一个`simpleType`. 现在我被告知我必须从全`DNS`名列表（如`www.bla.moo.oneofmyservers.foo.loo`）中过滤我的服务器。我的命名策略有长度限制。`*mystrategy*`如果不是这样，我会简单地把它放在里面。

**有没有办法从模式定义中引用我的类型？**

我写的时候没有用`*mytype*`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T15:55:59.767

假设您要问的是这样的：

*我有一个模式，我用它作为一个简单类型的约束方面；现在，我想制作另一种类型，出于维护目的，我希望以某种方式引用该模式，这样我就不必在两个不同的地方维护它......*

答案是否定的，你不能。XSD 中的约束方面不是可引用的实体；在约束方面也不能引用类型。

# browser - 浏览器到端口通信如何在内部工作

> ID：12234058
> 
> 赞同：0
> 
> 时间：2012-09-02T07:11:03.603
> 
> 标签：browser, network-programming

我正在调试一个打开几个 UDP 端口的应用程序。我使用 netstat 命令查找打开的端口。当我说“netstat -anb”时，我看到我的浏览器（在本例中为 Firefox）使用了几个端口。Firefox 只打开了几个网站。

这是否意味着服务器将浏览器重定向到用户通常认为的其他端口？

有关此的更多信息将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T10:05:20.157

如果这些是 UDP 端口，它们可能用于 DNS。浏览器所做的大部分工作都是通过 HTTP 进行的，而 HTTP 又是通过 TCP 进行的，这在很大程度上需要连接到远程端口 80、443、8080 或 8443。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T11:49:34.087

有远程端口和本地端口。当您打开网络浏览器并尝试连接到网站时。您的 Web 浏览器始终在其端口 80（默认情况下）（而不是您的本地端口 80）连接到远程地址。但是，在建立此连接之前，您的 Web 浏览器必须告诉远程服务器它将在某个端口号（本地端口）等待远程服务器响应，该端口号不被任何其他应用程序使用（否则，所有其他应用程序正在侦听在同一端口上接收消息时会感到困惑）。

您的本地端口号可以是任何未使用的端口号。因此，如果您的 Firefox 与远程地址建立多个连接，它必须打开多个端口，但远程地址上的单个端口足以服务多个连接。

# video - 如何在网站上实现视频？

> ID：12234061
> 
> 赞同：0
> 
> 时间：2012-09-02T07:11:43.007
> 
> 标签：video, video-streaming, jwplayer, rtmp

我正在制作一个网站，其中很大一部分是提供视频。众所周知，这个领域有很多可能性。（Flash、HTML5，它们中的每一个都有很多不同的可能性。）

1.  我需要视频可以在所有设备上播放，无论是 PC 上的 FF、Mac 上的 Safari、iPad、iPod、Android 等。

2.  我还研究了 RTMP 流。如果可能的话，我不希望这些视频可以下载。（RTMP 在这里确实有点帮助。）

3.  如果可能的话，我希望用户能够在视频中“滚动”，而不必等待他们想要跳过的部分被下载。（我经常看到视频播放器在时间轴上从左到右加载视频，你必须等到你想要滚动到的部分下载完毕。）

4.  如果可能的话，我想根据带宽和屏幕尺寸提供不同版本的视频（在分辨率和尺寸方面）。

如果它会对决定产生影响：

1.  该网站的另一部分是录制视频/音频，并能够在他们按下停止录制后立即预览。

我想最后两个需要媒体流服务器？完整的设置会/可能会是什么样子？我看过 JWPlayer 并且非常喜欢它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T12:18:36.907

Flash 是您最好的选择，因为它目前在大多数设备上都有覆盖 [虽然不是 iOS/MacOS 设备]。对于 iOS，您需要 HLS 流式传输，它也将通过 Safari 覆盖 Mac。JWPlayer 是一个很好的播放器。还有其他人也喜欢flowplayer。

现在这里的问题是，在具有屏幕尺寸/带宽等的不同设备上获取视频需要一些智能，并且您通常会了解很多视频和流媒体之外的内容。还有关于的问题

*   即时设备检测
*   根据您想要支持的内容和设备的流行程度，动态转码与预定义文件
*   所有设备的协议支持。例如。iOS 和 MacOS 与其他系统不同。如果某些东西没有 Flash，您必须通过 html5 或其他东西提供服务。
*   带宽检测和视频适配。

如果您想要以上所有内容，这是一个非常重要的问题。整个公司都是围绕向所有设备提供优化视频的工作而建立的。因此，虽然它是可行的，但它确实需要付出很多努力才能让“所有具有不同 b/w、尺寸以匹配设备等的设备”开始运行。

所以我的建议是，您应该首先获得最流行的设备支持，并离线创建视频以覆盖这些设备。这应该涵盖 80% 的设备和用例。然后为您的视频创建一组样本，这些样本将为其余设备提供服务，但不一定是最佳的。几种格式/分辨率应涵盖大多数设备。最初不要为适应和其他事情而烦恼。当您现在甚至没有任何东西时，不要试图以“在所有条件下都以最佳方式考虑内容、设备和黑白作为标准”为目标。

# objective-c - 直接访问子类中自动合成的实例变量？

> ID：12234063
> 
> 赞同：4
> 
> 时间：2012-09-02T07:12:17.180
> 
> 标签：objective-c, properties, accessor, member-variables, synthesize

为了提高效率，我想访问与子类中的属性关联的成员变量。如果我有一个声明如下的属性：

```
@interface Mumbo : NSObject
    @property (nonatomic) GLKVector3 position;
@end 
```

在 Mumbo 的实现中，我可以将 position 称为 self.position 或直接称为 _position（默认的合成成员变量 - 我没有使用 @synthesize）。在某些情况下，我使用后者来提高效率以避免复制结构。

但是，在子类中，除非我将接口更改为

```
@interface Mumbo : NSObject {
    GLKVector3 _position;
}
    @property (nonatomic) GLKVector3 position;
@end 
```

这似乎有效。但是，我是否保证自动合成的成员变量与我在大括号中明确声明的成员变量一致？我找不到有关该主题的任何权威文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T07:17:45.893

自动合成的变量默认使用前导下划线，所以你就在那里。

但是您声明 iVar 的方式 - 使其公开，但自动合成的变量是私有的。这就是为什么您可以从课堂外访问它的原因。

# operators - 按位逻辑运算的意外结果

> ID：12234065
> 
> 赞同：0
> 
> 时间：2012-09-02T07:12:21.147
> 
> 标签：operators, bit-manipulation, bitwise-operators

给定一个像这样定义的枚举：

```
enum DebugModeType {
    DebugModeNone = 0,
    DebugModeButton = 1,
    DebugModeFPS = 2,
    DebugModeData = 4
};
#define DebugMode DebugModeButton|DebugModeData 
```

我预计 的值为`DebugMode&DebugModeFPS`0，但我观察到它为 1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T07:49:53.753

您需要在宏中使用括号来克服运算符优先级：

```
#define DebugMode (DebugModeButton|DebugModeData) 
```

原样：

`DebugMode & DebugModeFPS`

=`DebugModeButton | DebugModeData & DebugModeFPS`

（被解析为`DebugModeButton | (DebugModeData & DebugModeFPS)`）

=`DebugModeButton | (4 & 2)`

=`DebugModeButton | 0`

=`DebugModeButton`

=`1`

我建议用括号：

=`(DebugModeButton | DebugModeData) & DebugModeFPS`

=`5 & DebugModeFPS`

=`5 & 2`

=`0`

# algorithm - 重复关系

> ID：12234066
> 
> 赞同：8
> 
> 时间：2012-09-02T07:12:25.867
> 
> 标签：algorithm, dynamic, recursion

如何以最佳复杂度计算非常大的 n （比如 10^14 ）的 tribonacci 数。Tribonacci 数定义`F(n)=F(n-1)+F(n-2)+F(n-3)`为`F0=1, F1=2, F2=4`。

或重复定义 `F(n)=aF(n-1)+bF(n-2)+cF(n-3)`为`F0=1, F1=2, F2=4`。

我想计算 log(n) 中的第 n 项，就像第 n 个斐波那契数一样。

如何生成基本矩阵以使用矩阵求幂来计算第 n 项？

以前我试图使用 DP 来实现它，但由于我们不能采用如此大的数组，所以它不能正常工作。同样，由于 10 ^ 14 的大量订单的堆栈溢出，递归在这里不起作用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-02T07:28:10.293

tribonacci 数的*最佳*渐近复杂性将使用矩阵求幂方法，例如[Fibonacci 数的](https://en.wikipedia.org/wiki/Fibonacci_number#Matrix_form)方法。具体来说，正确编写，这是 O(log n) 整数运算，而不是 O(n)（如动态规划方法）或 O(3 ^n )（如天真的解决方案）。

感兴趣的矩阵是

```
 [1, 1, 1]
M = [1, 0, 0]
    [0, 1, 0] 
```

并且第*n个 tribonacci 数在**M ^n*的左上角。必须[通过平方](https://en.wikipedia.org/wiki/Exponentiation_by_squaring)来计算矩阵求幂以实现 log(n) 复杂度。

（对于`F(n+3) = a F(n+2) + b F(n+1) + c F(n)`，矩阵为：

```
 [a, b, c]
M = [1, 0, 0]
    [0, 1, 0] 
```

结果是 {F [n+2] ,F [n+1] ,F [n] } = M ^n {F [2] ,F [1] ,F [0] }，另[见此处](https://stackoverflow.com/a/12333581/849891)。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-02T07:15:15.130

动态编程解决方案不需要 10^14 元素数组。**它只需要 3**。

请注意，每个步骤仅使用前 3 个元素，因此对于`F(1000)`，您真的不需要`F(5)`.

您可以简单地覆盖不再需要的元素，并将它们视为新数字。

`%`为此，运营商是您的朋友。

# java - 我可以使用 Java 应用程序来控制 Windows 7 功能吗？

> ID：12234067
> 
> 赞同：0
> 
> 时间：2012-09-02T07:12:31.887
> 
> 标签：java, api, windows-7

我对编程比较陌生，我最近在 eclipse 环境中进行了很多开发，并且有想法为 Windows 7 构建一个小型应用程序，当我从笔记本电脑上拔下电源线时，它将启用我的触摸板和重新连接电源时禁用触摸板。

*   我的问题是我该如何构建这样的应用程序？
    *   是否有可以导入的包让我可以访问 Windows 7 API？
    *   是否可以编译一个 java 应用程序以便我可以让它在启动时运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T07:24:54.183

我同意 Andrew 的观点，Java 可能不是此类应用程序的最佳选择，但无论如何这就是您可以做的。

Java 7 文件 API 能够监听文件系统。您应该在卡的根文件夹中监听更改。我想当卡断开连接时你会得到异常。

触摸板可以作为外部应用程序调用。查看此讨论以了解详细信息：[Java - 调用屏幕键盘](https://stackoverflow.com/questions/9281315/java-invoke-on-screen-keyboard)

或者，您可以使用 JNI、JNA 或 java-to-windows 库之一（JaWin、Jintegra、Jinterop）。但我认为这要复杂得多。我建议您从第一个解决方案开始。

# c++ - 使用 MinGW 与 ICU 一起构建 Boost

> ID：12234070
> 
> 赞同：3
> 
> 时间：2012-09-02T07:12:42.333
> 
> 标签：c++, boost, build, mingw, icu

我下载了最后一个 ICU 版本 (49) 二进制文件，并将以下 arg 添加到 b2：

```
-sICU_PATH="D:\lib64\icu" 
```

我有

```
gcc.link D:\boost\1.51.0\boost\boost\bin.v2\libs\locale\build\gcc-mingw-4.7.1\debug\has_icu64.exe                 
d:/mingw/bin/../lib/gcc/x86_64-w64-mingw32/4.7.1/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -licui18n 
d:/mingw/bin/../lib/gcc/x86_64-w64-mingw32/4.7.1/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -licudata 
collect2.exe: error: ld returned 1 exit status 
```

icu 二进制文件中没有这样的 libicui18n、libicudata。

所以我尝试自己构建它。我收到了这个错误

```
PATH=../../lib:../../stubdata:../../tools/ctestfw:$PATH  ../../bin/genrb -e UTF-8 -s resources -d uconvmsg root.txt                                                                                                                 
Makefile:173: recipe for target `uconvmsg/root.res'     failed                                                        
make[2]: *** [uconvmsg/root.res] Error 127 
```

有人可以建议我如何使用 MinGW 用 ICU 构建 Boost 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T15:47:57.230

1.) 您下载的包中的库名为`icuin49.dll`, `icudt49.dll`. 我们定期使用 mingw（和许多其他平台）构建以进行测试，但不发布这些二进制文件。

2.) uconv 只是一个额外的。`--disable-extras`您可以在配置行禁用它。（那里没有足够的信息告诉我它失败的原因。）

# javascript - 如何从 data_response 获取父元素内的 html？

> ID：12234073
> 
> 赞同：0
> 
> 时间：2012-09-02T07:13:31.557
> 
> 标签：javascript, jquery, ajax

我正在做一个 ajax 调用，它`data_response`有一个 HTML 元素，里面有很多标记：

```
<div>**code I want to retrieve**</div> 
```

我想在没有父元素的情况下获取 innerHtml，以便将它放在另一个元素中。

基本上：

```
$('selector').html(**code I want to retrieve**); 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:18:40.730

如果响应真的只包含 HTML，那么您可以使用 JQuery 轻松解析它：

```
var html = $(data_response).html();
$('selector').html(html); 
```

**编辑**

和这个原理是一样的：

```
var newElement = $("<div id='foo'>stuff</div>");
$("body").append(newElement);
var theElement = $("#foo");
console.log(theElement.html()); 
```

> 东西

# android - 使用 SimpleCustomAdapter 在列表视图中加载图像

> ID：12234081
> 
> 赞同：0
> 
> 时间：2012-09-02T07:15:42.133
> 
> 标签：android, listview, imageview

我有以下代码：

```
list_home = (ListView) findViewById (R.id.list_home);

    cursor2 = baza5.query("igralci", new String[] {"slika","ime", "priimek",    "pozicija","visina","_id"}, 
                "id_ekipe like " + id_izbrane_ekipe_domaci+" AND " +
                        "je_izbran like " + pomozni,
                null, null, null, null);

    adapter2 = new SimpleCursorAdapter(
                this, 
                R.layout.igralci_ekipe, 
                cursor2, 
                new String[] {"slika","ime","priimek","pozicija","visina","_id"}, 
                new int[] {R.id.slika_igralca,R.id.ime_igralca,R.id.priimek_igralca,R.id.pozicija_igralca,
                        R.id.visina_igralca,R.id.id});

    list_home.setAdapter(adapter2); 
```

还有我的 igralci_ekipe.xml：

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

    android:padding="8px">

    <ImageView

        android:id="@+id/slika_igralca"
        android:layout_gravity="left"
        android:layout_width="50dp"
        android:layout_height="50dp" />

    <TextView
        android:id="@+id/ime_igralca"
        android:layout_width="wrap_content"
        android:textColor="#0000ff"
        android:textSize="15dp"
        android:layout_height="wrap_content"
         android:layout_toRightOf="@id/slika_igralca" />

    <TextView
        android:id="@+id/priimek_igralca"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="#0000ff"
        android:textSize="15dp"
        android:layout_marginLeft="16px"
        android:layout_toRightOf="@id/ime_igralca" />

    <TextView
        android:id="@+id/pozicija_igralca"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="#0000ff"
        android:textSize="15dp"
        android:layout_marginLeft="16px"
        android:layout_toRightOf="@id/priimek_igralca"/>

        <TextView
        android:id="@+id/visina_igralca"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="#0000ff"
        android:textSize="15dp"
        android:layout_marginLeft="16px"
        android:layout_toRightOf="@id/pozicija_igralca"/>

    <TextView
        android:id="@+id/id"
        android:layout_width="wrap_content"
        android:textColor="#0000ff"
        android:textSize="1dp"
        android:layout_height="wrap_content"
        android:layout_marginLeft="16px"
        android:layout_toRightOf="@id/visina_igralca"/>

</RelativeLayout> 
```

数据库字段 slika(picture) 是我的图片在 sdcard 上的字符串路径。

这可以正常工作并且可以正确显示图片，但是当要加载 3 张或更多图片时，出现内存错误。

```
Is there a way I could use picture bitmap like this:

    int targetW = slika_igralca.getWidth();
    int targetH = slika_igralca.getHeight();

    // Get the dimensions of the bitmap
    BitmapFactory.Options bmOptions = new BitmapFactory.Options();
    bmOptions.inJustDecodeBounds = true;

    int photoW = bmOptions.outWidth;
    int photoH = bmOptions.outHeight;

    // Determine how much to scale down the image
    int scaleFactor = Math.min(photoW/targetW, photoH/targetH);

    // Decode the image file into a Bitmap sized to fill the View
    bmOptions.inJustDecodeBounds = false;
    bmOptions.inSampleSize = scaleFactor;
    bmOptions.inPurgeable = true;

    Bitmap bitmap = BitmapFactory.decodeFile(selectedImagePath, bmOptions);
    slika_igralca.setImageBitmap(bitmap); 
```

然后作为字符串使用类似这一行的内容：slika_igralca.setImageBitmap(bitmap);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T07:08:18.430

我解决了这个问题，我只需要创建一个自定义类适配器

gregoradapter.java：

```
 package com.example.ultimate.basketball.stats;

import android.content.Context;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.support.v4.widget.CursorAdapter;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageView;
import android.widget.TextView;

public class gregoradapter extends CursorAdapter {

@SuppressWarnings("deprecation")
gregoradapter(Context context, Cursor cursor) {
super(context, cursor);

mInflater = LayoutInflater.from(context);

mColField1 = cursor.getColumnIndex("slika");
mColField2 = cursor.getColumnIndex("priimek");
}

@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {
View v = mInflater.inflate(R.layout.igralci_ekipe, parent, false);
return v;
}

@Override
public void bindView(View view, Context context, Cursor cursor) {
// show text value

ImageView slika = (ImageView) view.findViewById(R.id.slika_igralca);
int targetW = 20;
int targetH = 20;

// Get the dimensions of the bitmap
BitmapFactory.Options bmOptions = new BitmapFactory.Options();
bmOptions.inJustDecodeBounds = true;

int photoW = bmOptions.outWidth;
int photoH = bmOptions.outHeight;

// Determine how much to scale down the image
int scaleFactor = Math.min(photoW/targetW, photoH/targetH);

// Decode the image file into a Bitmap sized to fill the View
bmOptions.inJustDecodeBounds = false;
bmOptions.inSampleSize = scaleFactor;
bmOptions.inPurgeable = true;

Bitmap bitmap = BitmapFactory.decodeFile(cursor.getString(mColField1), bmOptions);
slika.setImageBitmap(bitmap);

// show icon
TextView iv = (TextView) view.findViewById(R.id.priimek_igralca);
int icon_kind = cursor.getInt(mColField2);

iv.setText(cursor.getString(mColField2));
}

LayoutInflater mInflater;

private int mColField1;
private int mColField2;

} 
```

然后像这样使用：

```
gregoradapter adapter15= new gregoradapter(this, cursor2); 
```

# java - 在ant中引用外部.jar库来构建一个Android java jar

> ID：12234082
> 
> 赞同：0
> 
> 时间：2012-09-02T07:16:18.307
> 
> 标签：java, android, ant, jar, build.xml

（我是 ant 新手，我已经在网上搜索了解决方案，但似乎没有一个对我有用。）

我正在尝试在使用 ant 构建时引用外部 .jar 库。但是，我收到如下错误：.java 文件中`package [name] does not exist`的语句旁边`import [name]`

在我的 build.xml 中，我有以下行，它引用了存储外部 jar 的文件夹：

`<property name="lib.dir" value="libs"/>`

当我删除对外部 jar 的引用时，ant 会构建。现在，似乎 ant 无法找到外部库，**我不确定如何正确更新 build.xml 以引用这些库。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:36:03.280

如果您需要在编译中包含 jar，您可以执行以下操作：

```
<javac srcdir="${src.dir}" destdir="${local.build.dir}" source="1.5" target="1.5" classpathref="base.classpath" debug="true"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T07:29:13.600

尝试删除此属性条目并重建。我一直都有外部库 jar，将它们添加到 libs 文件夹中就足以让所有东西都成功构建。

这个属性条目可能会让你失败的原因是：自动生成的`build.xml`引用了 android sdk 工具文件夹中的另一个构建文件。这个其他构建文件知道如何引用`libs`您当前正在构建的项目的文件夹，但从它的角度来看，路径不是简单的`libs`.

# android - 强制用户通过按钮退出对话框

> ID：12234087
> 
> 赞同：2
> 
> 时间：2012-09-02T07:17:17.267
> 
> 标签：android

我正在开发一个应用程序，在第一次启动时，我有两个对话框，我希望用户单击确定/退出（许可、警告等），但目前可以通过单击屏幕上的其他任何位置来关闭它们。

我目前正在这样创建它；

```
AlertDialog.Builder dlg = new AlertDialog.Builder(this);
dlg.setTitle("Warning");
dlg.setMessage( ... );
dlg.setCancelable(false);
dlg.setPositiveButton("Ok", new DialogInterface.OnClickListener() { ... });
dlg.setNegativeButton("Quit", new DialogInterface.OnClickListener() { ... });
dlg.create().show(); 
```

如何强制用户通过其中一个按钮退出对话框？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T07:30:31.430

没关系，我找到了。将其更改为

```
...snip...
builder.setNegativeButton("Quit", new DialogInterface.OnClickListener() { ... });
AlertDialog dlg = builder.create();
dlg.setCancelableOnTouchOutside(false);
dlg.show(); 
```

# c - C中的函数返回结构

> ID：12234089
> 
> 赞同：3
> 
> 时间：2012-09-02T07:17:31.837
> 
> 标签：c, struct

我们在哪里可以编写类似的代码

```
struct Foo
{
    int bar;
    int baz;
} foo()
{

} 
```

C89/C90？C99？C11? 或者也许它只是K&R？

那这个呢

```
void foo(bar, baz)
int bar;
int baz;
{
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T07:43:20.383

这是自 C89 以来的标准。在 K&R C 中，不可能返回结构，只能返回指向结构的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:23:02.103

从 C89 开始，返回 a 是可能且有用的`struct`。

您的第二个示例`foo`是旧的 K&R C，在较新的标准中已弃用。

请注意，在 Linux x86-64 上，[ABI](http://www.x86-64.org/documentation/abi.pdf)定义了直接通过寄存器返回两个成员结构的[调用约定。](http://en.wikipedia.org/wiki/Calling_convention)其他结构通过内存返回，因此返回可能比单个指针慢一点。

例如，您可以将一个点定义为调用`struct`的两个数字（例如`int`或`double`）的 a `x`，并从某个例程`y`返回这样的 a 。在 Linux/x86-64 上，这两个数字将在两个寄存器中返回（当启用并可能优化时，无需在内存中构建一些数字），例如：`struct``getPosition``struct`

```
 struct point_st { int x, y; };

 struct point_st getPosition(void);

 struct point_st getPosition () {
   struct point_st res = {-1,-1};
   res.x = input_x();
   res.y = input_y();
   return res;
 }; 
```

您通常希望`struct`在函数原型之前声明返回值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-01T19:15:33.947

在 C89/C90 中，可以有一个返回结构的函数。

我没有在标准中找到任何明确的定义，但第 3.3.2.3 节“结构和联合成员”中的脚注说：

> 示例 1：如果**f**是返回结构或联合的函数，并且**x**是该结构或联合的成员，则**f().x**是有效的后缀表达式，但不是左值。

不过，第 3.6.6.4 节“返回语句”并没有忘记将结构和联合作为返回类型。

第 3.5.4.3 节“函数声明符（包括原型）”说：

> 函数声明器不应指定函数类型或数组类型的返回类型。

它没有提及对结构或联合类型的任何限制，并且由于这将是此类限制所属的地方，因此它们是允许的。

C99 的措辞相同，只是重新编号了各个部分。

# css - 使用 Dart 获取文档高度？

> ID：12234092
> 
> 赞同：2
> 
> 时间：2012-09-02T07:17:52.113
> 
> 标签：css, dart

我会提前说，我觉得自己像个新手一样问这个问题。我已经搜索了 Dart 文档，并尽可能多地在 Google 上搜索。没有答案。用JS写了一段时间。试图掌握 Dart。

你如何获得文件的高度？

```
window.document.height 
```

和

```
document.height 
```

在 Dartium 控制台中工作得很好。

但是，当在我的代码中使用时，我会抛出这个

```
NoSuchMethodException : method not found: 'get:height' 
```

我在这里做错了什么？如果你愿意，为什么错了？我对结构有什么误解？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T11:29:06.323

我仍在尝试飞镖，但您可以使用未来来获得身体的计算高度：

```
 document.body.rect.then((ElementRect value){
     print(value.offset.height);    
  }); 
```

这应该有效。

该文档不包含任何“高度”在公众中也不在属性映射中。

# php - 在检查某些数据是否存储在数据库中后使用 Ajax 生成警报框

> ID：12234093
> 
> 赞同：0
> 
> 时间：2012-09-02T07:17:57.050
> 
> 标签：php, jquery, ajax

> **可能重复：**
> [使用 Ajax 生成警报框](https://stackoverflow.com/questions/12234354/using-ajax-to-generate-an-alert-box)

您好我想在检查某些数据是否存储在数据库中后弹出一个警告框。如果存储，它会提示已**保存**，否则**不保存**。

这是我的ajaxfunction

```
AjaxRequest.POST({
  'url': 'GroupsHandler.php',
  'onSuccess': function (creategroupajax) {
    alert('Saved!');
  },
  'onError': function (creategroupajax) {
    alert('not saved');
  }
}); 
```

# javascript - 将 Backbone.View 重新注入到 DOM 中，保留事件而不是创建新事件

> ID：12234094
> 
> 赞同：0
> 
> 时间：2012-09-02T07:17:59.403
> 
> 标签：javascript, jquery, dom, javascript-events, backbone.js

我得到了以下示例 Backbone.View：

```
var View = Backbone.View.extend({
  tagName: "div",

  className: "advertisement",

  initialize: function () {
    this.on('switch', this.
    switch, this);

    this.views = {};
    this.views.laptop = new LaptopAdView();
    this.views.piano = new PianoAdView();
    this.views.food = new FoodAdView();
  },

  render: function () {
    this.$el.empty();
    this.
    switch ('laptops');

    return this;
  },

  switch: function (ad) {
    var el;

    if (ad === 'laptop') {
      el = this.views.laptop.render().el;
    } else if (ad === 'piano') {
      el = this.views.piano.render().el;
    } else {
      el = this.views.food.render().el;
    }

    // reinsert the chosen view
    this.$el.empty().append(el);
    // bind all events new
    this.delegateEvents();
  }
}); 
```

如您所见，我使用 this.delegatEvents() 重新创建所有事件绑定。这实际上不是一个完美的解决方案......当我使用 this.$el.detach(); 会好得多 或其他方法，因此我使用其事件缓存整个对象，而不是重新渲染和重新创建所有事件。

**现在使用小提琴：http:** [//jsfiddle.net/RRXnK/66/](http://jsfiddle.net/RRXnK/66/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T06:58:59.600

您正在尝试绑定到 Backbone 视图而不是 DOM 元素：

`this.on('switch', this.switch, this);`

一切都很好，但是谁触发了“切换”事件？您没有触发 DOM 事件的绑定，并且`this.delegateEvents();`仅适用于 DOM 事件。

一旦你设置了 DOM 事件，例如

`this.$el.on('click', 'a', this.switch)`-- 'switch' 事件将被触发，只要 $el 没有从 DOM 中删除，您就不必重新委托事件。

# android - android标准菜单图标，“图标”字段填写什么？

> ID：12234095
> 
> 赞同：0
> 
> 时间：2012-09-02T07:18:06.300
> 
> 标签：android, icons, android-resources

我想在操作栏上放一个菜单项（只是刷新）。我已经将我的图标（文件名 ic_menu_refresh.png）放在所有可绘制文件夹中，但无法识别它，我总是在编译时收到此错误。请同时查看附件图片。

`error: Error: String types not allowed (at 'icon' with value 'ic_menu_refresh').`

已经尝试不使用 .png 任何提示来解决此问题？谢谢。

![在此处输入图像描述](../Images/39c970e12ab13b7ae4ca0d53220f974a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T07:24:44.777

应该是“ `@drawable/ic_menu_refresh`”

您必须指定从哪里提取图像（在本例中为可绘制）。此外，您不需要包含图像扩展名，即*.png*应该去。

您可以在此处阅读有关菜单的更多信息：http: [//developer.android.com/guide/topics/ui/menus.html#xml](http://developer.android.com/guide/topics/ui/menus.html#xml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:25:51.640

请将@drawable/ic_menu_refresh 添加到您的菜单项。

# c# - 如何将 Object 转换为其实际类型？

> ID：12234097
> 
> 赞同：141
> 
> 时间：2012-09-02T07:18:28.227
> 
> 标签：c#, object, types, casting, typeof

如果我有：

```
void MyMethod(Object obj) {   ...   } 
```

我怎样才能`obj`转换成它的实际类型？

* * *

## 回答 #1

> 赞同：221
> 
> 时间：2012-09-02T07:22:54.030

如果您知道实际类型，那么只需：

```
SomeType typed = (SomeType)obj;
typed.MyFunction(); 
```

如果您不知道实际类型，那么：不是真的，不。您将不得不使用以下之一：

*   反射
*   实现一个众所周知的接口
*   动态的

例如：

```
// reflection
obj.GetType().GetMethod("MyFunction").Invoke(obj, null);

// interface
IFoo foo = (IFoo)obj; // where SomeType : IFoo and IFoo declares MyFunction
foo.MyFunction();

// dynamic
dynamic d = obj;
d.MyFunction(); 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-09-02T07:25:20.173

我不认为你可以（不是没有反射），你也应该为你的函数提供一个类型：

```
void MyMethod(Object obj, Type t)
{
    var convertedObject = Convert.ChangeType(obj, t);
    ...
} 
```

**更新**：

这可能对您有用：

```
void MyMethod(Object obj)
{
    if (obj is A)
    {
        A a = obj as A;
        ...
    } 
    else if (obj is B)
    {
        B b = obj as B;
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-11-11T10:41:43.667

怎么样

```
JsonConvert.DeserializeObject<SomeType>(object.ToString()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T07:31:12.680

如果您的`MyFunction()`方法仅在一个类（及其后代）中定义，请尝试

```
void MyMethod(Object obj) 
{
    var o = obj as MyClass;
    if (o != null)
        o.MyFunction();
} 
```

如果您有大量不相关的类定义要调用的函数，则应该定义一个接口并让您的类定义该接口：

```
interface IMyInterface
{
    void MyFunction();
}

void MyMethod(Object obj) 
{
    var o = obj as IMyInterface;
    if (o != null)
        o.MyFunction();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-10T06:37:46.790

就我而言，AutoMapper 运行良好。

AutoMapper 无需任何显式配置即可映射到动态对象/从动态对象映射：

```
public class Foo {
    public int Bar { get; set; }
    public int Baz { get; set; }
}
dynamic foo = new MyDynamicObject();
foo.Bar = 5;
foo.Baz = 6;

Mapper.Initialize(cfg => {});

var result = Mapper.Map<Foo>(foo);
result.Bar.ShouldEqual(5);
result.Baz.ShouldEqual(6);

dynamic foo2 = Mapper.Map<MyDynamicObject>(result);
foo2.Bar.ShouldEqual(5);
foo2.Baz.ShouldEqual(6); 
```

同样，您可以直接从字典映射到对象，AutoMapper 会将键与属性名称对齐。

更多信息[https://github.com/AutoMapper/AutoMapper/wiki/Dynamic-and-ExpandoObject-Mapping](https://github.com/AutoMapper/AutoMapper/wiki/Dynamic-and-ExpandoObject-Mapping)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-02T08:11:50.023

如果您现在将类型转换为它的真实类型，例如它是从名为 abc 的类定向的。您可以通过这种方式调用您的函数：

```
(abc)(obj)).MyFunction(); 
```

如果您不知道该功能，它可以以不同的方式完成。总是不容易。但是你可以通过它的签名以某种方式找到它。如果这是你的情况，你应该让我们知道。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-04T23:54:52.040

如果可能有多种类型，则方法本身不知道要转换的类型，但调用者知道，您可能会使用如下内容：

```
void TheObliviousHelperMethod<T>(object obj) {
    (T)obj.ThatClassMethodYouWantedToInvoke();
}

// Meanwhile, where the method is called:
TheObliviousHelperMethod<ActualType>(obj); 
```

可以使用`where`括号后的关键字添加对类型的限制。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-09-02T07:26:54.177

```
Implement an interface to call your function in your method
interface IMyInterface
{
 void MyinterfaceMethod();
}

IMyInterface MyObj = obj as IMyInterface;
if ( MyObj != null)
{
MyMethod(IMyInterface MyObj );
} 
```

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2012-09-02T07:22:46.183

转换为实际类型很容易：

```
void MyMethod(Object obj) {
    ActualType actualyType = (ActualType)obj;
} 
```

# java - 在 JTextPane 中更改文本光标大小

> ID：12234098
> 
> 赞同：4
> 
> 时间：2012-09-02T07:18:31.200
> 
> 标签：java, swing, cursor, jtextpane, caret

我正在制作一个简单的文本编辑器，我有一个 JTextPane 并将间距更改为 1.5f。唯一的问题是“文本光标”跨越了从当前行到下一行的所有像素，而不管字体大小。这是一个例子：

![大光标](../Images/9427ba1cd8c87d946fc7c5c865cc2305.png)

无论如何我可以使文本光标大小自动调整为文本大小吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T13:38:21.813

请参阅此处[http://java-sl.com/tip_overwrite_mode.html](http://java-sl.com/tip_overwrite_mode.html)如何更改插入符号的形状。

或者，您可以覆盖 modelToView 方法以更正返回的矩形的形状（高度）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T07:39:37.160

“文本光标”在 GUI 库中通常称为“插入符号”。挥杆也一样。您可以使用该方法`setCaret`来更改它。要更改外观，请继承`javax.swing.text.DefaultCaret`并覆盖方法`paint`。

# asp.net-mvc - MVC Razor 条件验证与下拉和单选按钮上的数据注释

> ID：12234103
> 
> 赞同：1
> 
> 时间：2012-09-02T07:19:03.267
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation

我是 MVC Razor 的新手。我必须在下拉选择和单选按钮上实现条件验证（使用数据注释）。我有两个条件：

1.  我的下拉列表包含三个值：是、否和无。如果用户选择“无”，则只应在剩余字段（如城市和州）上应用所需的验证。
2.  我有两个单选按钮，是和否。如果用户选择否，则只应在剩余字段（如邮政编码）上应用必需的验证。

我找到了很多解决方案，但没有一个是理想的。如果你是 MVC Razor 的大师，请提供我上面解释过的演示示例 zip。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:26:25.380

对于具有“属性间”验证的情况，DataAnnotation 通常不是最好的（或清晰的，或易于实现的）工具。

看看 FluentValidation [http://fluentvalidation.codeplex.com/](http://fluentvalidation.codeplex.com/)

并且您将能够编写类似 (pseudoCode) 的规则

```
RuleFor(m => m.City)
      .NotNull()
      .When(m => m.<mydropdownName> == Conditions.None)
      .WithMessage("You must choose a city when you chosse none"); 
```

# c++ - 编译器的不同输出？

> ID：12234106
> 
> 赞同：0
> 
> 时间：2012-09-02T07:20:15.450
> 
> 标签：c++, visual-studio-2010, gcc, graph

我正在解决一个网站上的编程问题。在我的机器（Visual Studio 2010）上，一个测试用例给出了错误的结果，而在网站上给出了正确的结果。我不确定该站点的判断的编译器是什么，但我认为它类似于 gcc 或 cygwin。

**编码**

一个图形问题。这里的图表示为一棵树。该图是有向的，并且不包含循环。解决方案是`(2 * sum of all edges - max path length from root)`

```
//     to-vertex & edge-length
vector<pair<int, int> > pr[100];
int dfs(int i) // to find max path length from root
{
    int mx = 0;
    for (int j = 0; j < pr[i].size(); ++j)
        mx = max(mx, dfs(pr[i][j].first) + pr[i][j].second);
    return mx;
}

int PowerOutage::estimateTimeOut(vector <int> from_vertex,
                 vector <int> to_vertex, vector <int> edge_length)
{
    int tot = 0;
    for (int i = 0; i < from_vertex.size(); ++i)
    {
        pr[from_vertex[i]].push_back(make_pair(to_vertex[i], edge_length[i]));
        tot += (2 * edge_length[i]);
    }
    return tot - dfs(0);
} 
```

**测试用例**

```
from_vertex   {0,     0,   0,   0,   0}
to_vertex     {1,     2,   3,   4,   5}
edge_length   {100, 200, 300, 400, 500} 
```

**Visual Studio 返回： 2493**，**而站点的编译器返回正确答案： 2500**。

为什么两个结果不一样？我认为有一些隐藏的错误（在我的代码中）出现在 VS 中给出错误的答案，但在其他编译器中消失了。我应该确定站点的编译器并改用它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T07:33:37.687

Despite my first(wrong) assumption, OP has found out that it was 2500 already but the test-function had the flaw after i asked him "where is 2500 printed?".

# c++ - 在c中乘以大数

> ID：12234113
> 
> 赞同：2
> 
> 时间：2012-09-02T07:21:25.320
> 
> 标签：c++, c

我有两个整数 x 和 y 假设 x= 10^5 和 y = 10^8 现在我必须将这些数字相乘并将它们存储在变量 z 中。我不需要确切的值。z 可以得到模 100000009 的答案。我该怎么做？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T07:53:43.660

一般来说，您应该依赖以下关系：

```
(a * b) % n = (a % n) * (b % n) % n 
```

在这种特殊情况下，它没有多大帮助，因为您的`a`and`b`都小于`n`，但对于更大的`a`or`b`这保证了您需要处理的最大乘法是`n^2`and not `a * b`。

在 64 位系统上，您的当前值`n^2`将适合`long`. 如果您预期更大的值，那么您将需要一个任意精度的数学库，如[GMP](http://gmplib.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T07:25:41.137

```
#include <iostream>
#include <cmath>

int main() {
    typedef unsigned long long ull;
    ull x = std::pow(10,5);
    ull y = std::pow(10,8);
    ull z = (x*y) % 100000009;
    std::cout << z << std::endl;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T07:25:49.347

您可以使用对数和指数。指数是函数 f(x)=e^x，其中 e 是一个数学常数，等于 2.71828182845... 对数（由 ln 标记）是指数的倒数。

由于 ln(a*b)=ln(a)+ln(b)，所以 a*b=e^(ln(a)+ln(b))。

备注：
该方法在计算机之前被广泛使用。

# java - 我如何在 java SE 中使用 jdbcRealm-Shiro 进行授权

> ID：12234115
> 
> 赞同：2
> 
> 时间：2012-09-02T07:21:37.463
> 
> 标签：java, shiro, jdbcrealm

我需要知道如何在 Shiro 中使用 MySQL进行**授权。**

我可以通过网络找到的所有示例都是关于 WebApps 中的授权。我在**SE 应用程序**中需要它，但没有太多关于 jdbcRealm 的信息。

请帮我。

**谢谢**

# javascript - 根据内容高度调整 joomla 模块的数量

> ID：12234117
> 
> 赞同：1
> 
> 时间：2012-09-02T07:22:12.727
> 
> 标签：javascript, css, joomla

我想找到一种根据主要内容高度动态调整模块数量的方法。有可能吗？怎么做？在 CSS 中？javascript？

目的是避免在没有内容的情况下出现空白页。

提前致谢

凡妮莎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:25:20.723

这可以通过多种方式实现，有些方式比其他方式更优雅。我能想到的最简单的方法是仅使用 Javascript：

1.  所有模块内容都以 HTML 格式发送。（和现在一样）
2.  获取主要内容的高度。
3.  当主要内容高于模块高度时，删除最后一个模块。

类似的东西：（**代码未测试）**

```
window.addEvent('domready', function() {
    // Get heigth of main content
    var contentHeight = document.id('content').getHeight();

// While the height of the main content is more than 200
// and less than the height of the modules
    while(contentHeight > 200 && contentHeight < document.id('modules').getHeight()) {
        // Get the last module and remove it.
        $$('#modules .moduletable').getLast().dispose();
    }
}); 
```

请注意，这假设您正在使用 mootools（可能已经由您的 Joomla 安装提供）。此外，我的元素选择器可能不适用于您的模板。

同样，即使要删除一些模块，服务器仍将发送所有模块。另一件事是，这将在您网页的 DOM 完全加载时开始，这意味着用户可能会看到模块消失。因此，最好在开始时隐藏所有模块，然后使用类似的循环逐个显示模块。

编辑：您可能更喜欢的另一个示例。

```
window.addEvent('domready', function() {
    // Get heigth of main content
    var contentHeight = document.id('gkContent').getHeight();

    // While the height of the modules is more than 500
    // and less than the height of the modules
    while(document.id('gkRight').getHeight() > 500 && contentHeight < document.id('gkRight').getHeight()) {
        // Get the last module and remove it.
        var banners = $$('#gkRight .adsense2, #gkRight .bannergroup');
        if(banners.length > 0) banners.getLast().dispose();
        else break;
    }
}); 
```

# python - Python SocketServer.BaseRequestHandler 不会与远程请求通信

> ID：12234118
> 
> 赞同：3
> 
> 时间：2012-09-02T07:22:18.570
> 
> 标签：python, sockets, socketserver

我一直在使用 SocketServer.TCPServer 和 SocketServer.BaseRequestHandler 基类开发 Python 服务器。我正在使用主机“localhost”和端口 2304（未被任何其他程序使用）。

问题是我的服务器不会响应远程请求。我正在使用 Amazon AWS 并有一个静态 IP 地址用于访问。

当我使用例如在亚马逊本地机器上测试服务器时。浏览器，我看到我的服务器做了它的东西，但远程访问仍然被阻止。不知道如何打开 2304 端口以从本地机器外部访问。

这是整个代码：

```
import threading, socket
import SocketServer, Queue
import globals
import transaction_pool

class CTSRSThreadedTCPRequestHandler(SocketServer.BaseRequestHandler):

    def handle(self):

        if globals.terminating:
            self.Respond("")

        pCurrThread = threading.currentThread()
        sData = self.request.recv(8192)

        print "CTSRSThreadedTCPRequestHandler->RECV->OK!"

        sResponse = "OK!"

        self.Respond(sResponse)

        print "CTSRSThreadedTCPRequestHandler->SEND->OK!"

    #-------------------------------------------------------------------------

    def Respond(self, sResponse):
        self.request.send(sResponse)

    #-------------------------------------------------------------------------

class CTSRSThreadedTCPServer(SocketServer.ThreadingMixIn, SocketServer.TCPServer):
    allow_reuse_address = True

class CTSRSServer:

    m_pServerThread = None
    m_pServer = None

    #----------------------------------------------------------

    def StartServer(self):
        try:
            self.m_pServer = CTSRSThreadedTCPServer(("localhost", 2304), CTSRSThreadedTCPRequestHandler)
            sIP, iPort = self.m_pServer.server_address

            self.m_pServerThread = threading.Thread(target = self.m_pServer.serve_forever)

            self.m_pServerThread.daemon = True
            self.m_pServer.daemon_threads = True
            self.m_pServerThread.start()

            globals.system_log.info("[CTSRS]->StartServer()")

        except Exception, e:
            globals.system_log.info("[CTSRS]->StartServer() -> Exception: " + str(e))
            return False

        return True

    #----------------------------------------------------------

    def StopServer(self):
        globals.system_log.info("[CTSRS]->StopServer()")

    #---------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T07:40:08.200

当然它不会响应远程请求，“localhost”的意思就是它所说的，它是“本地主机”。您必须改为绑定到外部接口，或者绑定到通用的“catch-all”接口。

要绑定到所有接口，请使用例如

```
self.m_pServer = CTSRSThreadedTCPServer(('', 2304), CTSRSThreadedTCPRequestHandler) 
```

作为地址的空字符串使服务器侦听所有接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:33:40.497

尝试在“127.0.0.1:2304”收听：

self.m_pServer = CTSRSThreadedTCPServer(("127.0.0.1", 2304), CTSRSThreadedTCPRequestHandler)

# android - Android 应用程序意外停止

> ID：12234121
> 
> 赞同：0
> 
> 时间：2012-09-02T07:22:51.610
> 
> 标签：android, android-wifi

我为连接到互联网的android编写了一个程序。

我收到以下错误：

```
The application has stopped unexpectedly.Please try again.. 
```

有什么问题？

Eclipse中的log cat如下：

```
09-02 12:43:42.421: W/dalvikvm(12362): threadid=1: thread exiting with uncaught exception (group=0x40018578)
09-02 12:43:42.437: E/AndroidRuntime(12362): FATAL EXCEPTION: main
09-02 12:43:42.437: E/AndroidRuntime(12362): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.android.networkusage/com.example.networkusage.NetworkActivity}: java.lang.ClassNotFoundException: com.example.networkusage.NetworkActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.android.networkusage-1.apk]
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1573)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.os.Handler.dispatchMessage(Handler.java:99)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.os.Looper.loop(Looper.java:130)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.ActivityThread.main(ActivityThread.java:3687)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at java.lang.reflect.Method.invokeNative(Native Method)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at java.lang.reflect.Method.invoke(Method.java:507)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at dalvik.system.NativeStart.main(Native Method)
09-02 12:43:42.437: E/AndroidRuntime(12362): Caused by: java.lang.ClassNotFoundException: com.example.networkusage.NetworkActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.android.networkusage-1.apk]
09-02 12:43:42.437: E/AndroidRuntime(12362):    at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
09-02 12:43:42.437: E/AndroidRuntime(12362):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1565)
09-02 12:43:42.437: E/AndroidRuntime(12362):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:40:30.013

发现我的包名是：

com.example.android.networkusage

在清单上是：

android:name="com.example.networkusage.NetworkActivity"

所以将清单更改为：

android:name="com.example.android.networkusage.NetworkActivity"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T11:20:12.813

看起来你的`com.example.networkusage.NetworkActivity`课不见了。

如果它在外部库中声明，则将该**jar 文件**添加到“ **libs** ”文件夹并将**其添加到构建路径**，然后**再次构建您的项目**。

也不要忘记**清洁**它！

# objective-c - 如何使用类变量？

> ID：12234124
> 
> 赞同：0
> 
> 时间：2012-09-02T07:22:59.797
> 
> 标签：objective-c

我有一个`loadImage:(NSString *)path`从路径加载图像的类方法，如果路径为零，则加载默认路径图像。

```
 +(NSImage *) loadImage:(NSString *)path{
   if(path== nil){
    path = [[NSBundle mainBundle] pathForResource:@"default" ofType:@"png"];
  }
} 
```

因为默认路径总是使用相同的路径，如果我运行该方法 1000 次，我只想计算一次路径，比如

```
if(defaultPath == nil){
    defaultPath = [[NSBundle mainBundle] pathForResource:@"default" ofType:@"png"];
}
path = defaultPath; 
```

，我想我可以使用静态变量，但我不知道该怎么做，请帮助我，我很高兴知道有关提高性能的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T07:29:43.790

只需使用静态变量来保存默认路径：

```
static NSString *defaultPath = …;
if (path == nil) {
   path = defaultPath;
} 
```

但是，如果您出于性能原因这样做，请首先确保它是值得的。很可能这是一个不值得麻烦的过早优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:07:57.423

有一个基于 GCD 的有用模式可以很好地处理这种情况：

```
+(NSImage *) loadImage:(NSString *)path{

    static NSString *storedPath;

    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        storedPath = [[NSBundle mainBundle] pathForResource:@"default" ofType:@"png"];
    });

    // Do whatever you need to do with the default resource path.
} 
```

`dispatch_once`完全符合您的要求 - 它确保初始化代码只运行一次。它也是线程安全的。

Xcode 的代码完成功能甚至可以帮助您使用该模式——如果您开始输入`dispatch_once`，那么您将`onceToken`直接获得模板。

# android - 在 Android 中检查设备方向

> ID：12234126
> 
> 赞同：0
> 
> 时间：2012-09-02T07:23:42.953
> 
> 标签：android, orientation

我想在不更改当前活动方向的情况下在设备的方向更改上创建一个新活动。有没有办法做到这一点？

附加信息：

我的全部应用程序默认方向是 Portrate。当设备处于横向时，我必须打开第二个活动。但是第一个活动应该在 Portrate 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T07:30:55.050

您可以`android:screenOrienttation="Landscape/Portrate"`在您`AndroidMenifest.xml`的特定活动中使用。因此，其余活动将保留在默认视图中，并且当您提及时，该活动将强制显示在特定视图中。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T07:33:50.053

你当然可以。您只需在清单中声明您的第一个活动将处理方向更改。然后添加一个 onConfigurationChanged 函数来启动您的第二个活动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T07:54:06.737

写在Menifest

**第一个活动**

```
 <activity  android:name="firstActivity" android:screenOrientation="portrait"></activity> 
```

**第二个活动**

```
 <activity  android:name="secondActivity" android:screenOrientation="landscape"></activity> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T08:01:35.463

您还可以以编程方式检测您的活动的当前方向，并在您的设备处于横向模式时运行您的第二个活动的意图。这是完成它的代码：

```
WindowManager wm = getWindowManager();
Display d = wm.getDefaultDisplay();
if(d.getWidth() > d.getHeight())
{
    // landscape mode
    Intent i = new Intent(FirstActivity.this, SecondActivity.class);
    startActivity(i);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T14:47:16.500

感谢你的帮助。最后我通过使用`SensorEventListener`.

**OnCreate()**

```
 sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION); 
```

**听众**

```
 private SensorEventListener mySensorEventListener = new SensorEventListener() {

    public void onAccuracyChanged(Sensor sensor, int accuracy) {
    }

    public void onSensorChanged(SensorEvent event) {
        // angle between the magnetic north directio
        // 0=North, 90=East, 180=South, 270=West
        float azimuth = event.values[1];
        // compassView.updateData(azimuth);

        if ((azimuth < 100 && azimuth > 60)
                || (azimuth > -100 && azimuth < -60)) {
            if (EasterVal != 0) {
                if (!Modules.LoanType.equalsIgnoreCase("Ballcash")) {
                    Intent in = new Intent(Buyeroutput.this, Esteregg.class);
                    startActivity(in);
                    EasterVal = 0;
                }
            }
        } else {
            EasterVal = 1;
        }
    }
};

protected void onDestroy() {
    super.onDestroy();
    if (sensor != null) {
        sensorManager.unregisterListener(mySensorEventListener);
    }
} 
```

# matlab - 在 Matlab 中查找具有高互相关矩阵的组

> ID：12234145
> 
> 赞同：11
> 
> 时间：2012-09-02T07:26:23.200
> 
> 标签：matlab, cluster-analysis, correlation

给定一个包含互相关值的下三角矩阵 (100x100)，其中条目“ij”是信号“i”和“j”之间的相关值，因此高值意味着这两个信号属于同一类对象，并且知道数据集中最多有四个不同的类，是否有人知道一种快速有效的方法来对数据进行分类并将所有信号分配给 4 个不同的类，而不是相互搜索和交叉检查所有条目? 以下 7x7 矩阵可能有助于说明这一点：

```
 1      0       0       0       0       0       0
.2      1       0       0       0       0       0
.8      .15     1       0       0       0       0
.9      .17     .8      1       0       0       0
.23     .8      .15     .14     1       0       0
.7      .13     .77     .83\.    .11     1       0
.1      .21     .19     .11     .17     .16     1 
```

此示例中有三个类：

```
class 1: rows <1 3 4 6>,
class 2: rows <2 5>,
class 3: rows <7> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-02T13:40:04.143

这对于层次聚类来说是一个很好的问题。使用完整的链接聚类，您将获得紧凑的聚类，您所要做的就是确定截止距离，在该距离上两个聚类应该被认为是不同的。

首先，您需要将相关矩阵转换为`dissimilarity`矩阵。由于相关性介于 0 和 1 之间，`1-correlation`因此效果会很好 - 高相关性得分接近 0，低相关性得分接近 1。假设相关性存储在数组中`corrMat`

```
%# remove diagonal elements
corrMat = corrMat - eye(size(corrMat));
%# and convert to a vector (as pdist)
dissimilarity = 1 - corrMat(find(corrMat))';

%# decide on a cutoff
%# remember that 0.4 corresponds to corr of 0.6!
cutoff = 0.5; 

%# perform complete linkage clustering
Z = linkage(dissimilarity,'complete');

%# group the data into clusters
%# (cutoff is at a correlation of 0.5)
groups = cluster(Z,'cutoff',cutoff,'criterion','distance')
groups =
     2
     3
     2
     2
     3
     2
     1 
```

为了确认一切都很好，您可以可视化树状图

```
dendrogram(Z,0,'colorthreshold',cutoff) 
```

![在此处输入图像描述](../Images/dc1710624723e84da0cb03a76eb50b49.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-01T22:34:50.487

您可以使用以下方法而不是创建相异矩阵。

```
Z = linkage(corrMat,'complete','correlation') 
```

这允许 Matlab 将您的矩阵解释为相关距离，然后，您可以绘制树状图，如下所示：

```
dendrogram(Z); 
```

验证您的树状图是否正确的一种方法是检查其最大高度，该高度应对应于`1-min(corrMat)`. 如果 corrMat 中的最小值为 0，则树的最大高度应为 1。如果最小值为 -1（负相关），则高度应为 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T12:40:32.947

鉴于将有 4 个组，我将从一个非常简单的两阶段方法开始。

在第一阶段，您找到任何两个元素之间的最大相关性，将这两个元素放在一个组中，然后将它们在矩阵中的相关性归零。重复，找到两个元素之间的下一个最高相关性，然后将它们添加到现有组或创建一个新组，直到您拥有正确数量的组。

最后，检查哪些元素不在一个组中，转到它们的列，并确定它们与任何其他组的最高相关性。如果该元素已经在一个组中，请将它们也放入该组中，否则跳到下一个元素并稍后再返回。

如果有兴趣或有任何不清楚的地方，我可以稍后添加代码。就像我说的那样，这种方法很简单，但是如果您不需要验证组的数量，我认为它应该是有效的。

# javascript - 从字符串创建dom元素时添加多个类

> ID：12234147
> 
> 赞同：0
> 
> 时间：2012-09-02T07:27:09.643
> 
> 标签：javascript, jquery, handlebars.js

我正在使用 Handlebar js 进行模板化，并且正在创建一个 li 元素，如下所示。

```
var liClass="xyz" ; 
var class2 = "abc"; 
return new Handlebars.SafeString("<li class="+ liClass + ">" + "</li>" ); 
```

我如何添加 class2 和 liClass？我尝试将它添加到安全字符串，但它没有正确显示在 DOM 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T07:29:50.187

只需包含多个用空格分隔的值，并用引号括起来：

```
"<li class='"+ liClass + " " + class2 +"'>" + "</li>" 
```

# php - PHP cURL 设置发送到远程主机

> ID：12234149
> 
> 赞同：0
> 
> 时间：2012-09-02T07:27:49.267
> 
> 标签：php, forms, curl

我有一些关于 cURL 的基本问题，我无法在 cURL 文档中找到答案（可能是因为它们对其他人来说很明显......）。我有一个文件类型输入，需要将该文件发送到远程服务器。cURL 代码是随表单一起出现在页面上，还是表单发送给您的页面上的 cURL 然后被发送到远程服务器？

这是html表单：

```
<form action="send.php" method="post" enctype="multipart/form-data">
    <label for="file">Filename:</label>
    <input type="file" name="file" id="file" /> 
    <br />
    <input type="submit" name="submit" value="Submit" />
</form> 
```

到目前为止我所拥有的 cURL php，我什至不知道它是否适合我正在尝试做的事情，或者这是否在同一页面上或表单转到的 send.php 文件上：

```
$ch = curl_init("http://remoteServer/upload_file.php"); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CUROPT_POSTFIELDS, array('fileupload' => '@'.$_FILES['theFile']      ['tmp_name'])); 
echo curl_exec($ch);` 
```

在远程服务器上，我有这个文件来接收它：

```
$folder = "files/";
$path = $folder . basename( $_FILES['file']['name']); 
if(move_uploaded_file($_FILES['file']['tmp_name'], $path)) {
    echo "The file ".  basename( $_FILES['file']['name']). " has been uploaded";
} else{
    echo "There was an error uploading the file, please try again!";
} 
```

这甚至距离很近吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T07:48:45.453

您不需要 curl 从浏览器上传文件，您可以将表单直接提交到远程服务器进行上传 - 只需确保表单提交到具有第三个代码块的任何文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T10:05:52.500

**试试这个**

```
$curlPost = array('fileupload' => '@'.$_FILES['theFile'] ['tmp_name']);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://remoteServer/upload_file.php');
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $curlPost);
$data = curl_exec();
curl_close($ch); 
```

**另一个例子**

**如何使用 PHP cURL 将图像文件上传到远程服务器**

[http://www.maheshchari.com/upload-image-file-to-remote-server-with-php-curl/](http://www.maheshchari.com/upload-image-file-to-remote-server-with-php-curl/)

# erlang - Mochiweb 中是否有任何状态变量？

> ID：12234156
> 
> 赞同：1
> 
> 时间：2012-09-02T07:29:00.027
> 
> 标签：erlang, state, erlang-otp, mochiweb, gen-server

我浏览了[Mochiweb 代码](https://github.com/mochi/mochiweb)，但没有发现 State 变量的任何迹象。

Mochiweb 中是否存在类似于 gen_server 的[State](http://www.erlang.org/doc/design_principles/gen_server_concepts.html)变量的东西？

我需要在服务器上存储少量与状态相关的服务器端（与会话无关）数据，我不想为此使用 ETS 或 Mnesia。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T18:04:23.947

我认为您对什么是 gen_server 状态有些误解。

**首先，让我简要解释一下 mochiweb 的工作原理。**

Mochiweb 不会为每个客户端生成一个 gen_server 进程。相反，它只是使用`proc_lib:spawn/3`并创建一个参数化模块生成一个新进程，该模块基本上是以下类型的元组：

```
{mochiweb_request, #Port<0.623>, get, "/users", {1, 1}, []} 
```

这是

```
{mochiweb_request, Socket, Method, RawPath, HTTPVersion, Headers} 
```

此元组用作您作为循环参数传递给的函数的参数`mochiweb_http:start/1`。所以，当这个“循环”函数被调用时，它看起来像这样：

```
handle_request(Req) ->
    %% The pattern matching below just shows what Req really is
    {mochiweb_request, _, _, _, _, _} = Req,
    ... 
```

**现在，解释 gen_server 状态。**

基本上，gen_server 是一个具有大致以下结构的进程。当然，IRL 更复杂，但这应该给你一个大致的想法：

```
init(Options)
    State = ...
    loop(Module, State).

loop(Module, State)
    NewState = receive
        {call, Msg, From} -> Module:handle_call(Msg, From, State)
        {cast, Msg} -> Module:handle_cast(Msg, State)
        Info -> Module:handle_info(Info, State)
    end,
    loop(Module, NewState). 
```

因此，状态只是一个参数，您可以在所有函数调用中拖动并在循环内进行更改。您的进程是否是 gen_server 实际上并不重要，它没有生命周期。在以下示例中，该术语`[1, 2, 3]`也是一种状态：

```
a() ->
    b([1, 2, 3], now()).

b(State, Timestamp) ->
    Result = do_something(Timestamp)
    c(State, Result).

c(State, Payload) ->
    exit({State, Payload}). 
```

**现在，回到 mochiweb。**

如果您需要创建自己的状态，只需添加一个额外的函数参数：

```
handle_request(Req) ->
    User = Req:get(path),
    UserData = load_user_data(User),
    handle_request(Req, UserData).

handle_request(Req, UserData) ->
    ... 
```

现在 UserData 也是一个状态。你可以循环这个过程，或者让它响应并立即结束——但只要你将它作为参数传递，你就不会丢失 UserData。

最后，如果你真的想让这个进程成为 gen_server（这在大多数情况下确实不合理），你可以使用 gen_server:enter_loop/3 函数来让你当前的进程成为 gen_server。这个函数的第三个参数将是你的状态，它将存储在启动的 gen_server 中。

# wordpress - 可能的 Wordpress 漏洞利用

> ID：12234157
> 
> 赞同：1
> 
> 时间：2012-09-02T07:29:04.163
> 
> 标签：wordpress, security, phishing

是否有人知道 Wordpress 中的安全漏洞，欺诈者正在发送带有指向有效域的登录链接（声称是银行）的银行网络钓鱼电子邮件，但扩展路径可能不为域的合法所有者所知？

例如：

```
href = [HOST]=http://www.ponnuki.net
   [EXTENSION] = /wordpress/MOBILE-DO/absa-mobiledo/absaBanking/index.php 
```

从我最近收到的这些数量来看，这些主机似乎不是特定于地理区域的，因此显而易见的结论是他们正在寻找易受攻击的主机以进行搭载。

有人可以推荐谁是最好的报告对象吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:32:20.140

如果您认为您发现了 Wordpress 的安全问题，请参见下文。

> 对于 WordPress 自托管版本的实际安全问题，您应该向 security [at] wordpress.org 发送一封包含详细信息的电子邮件。包括尽可能多的细节。

取自[Wordpress Codex](http://codex.wordpress.org/Security_FAQ)。

# c++ - 远程线程的 DuplicateHandle 失败，错误为 ERROR_INVALID_HANDLE

> ID：12234159
> 
> 赞同：1
> 
> 时间：2012-09-02T07:29:24.770
> 
> 标签：c++, windows, winapi, error-handling

嗨，我试图挂起一个远程线程，但在途中我偶然发现 DuplicateHandle 失败，错误 6, ERROR_INVALID_HANDLE 。

以下方法适用于当前进程，但如果给出了像“calc”这样的远程进程（在同一主机上），则 DuplicateHandle 失败。

该进程使用 Admin priv 运行，并且 SeDebugPriv 和 SeSecurityPriv 被授予（进程资源管理器确认），但没有用。任何想法？`

```
bool DbgHelpWrapper::GetThreadStartAddress( IntPtr processHandle, DWORD processId, DWORD threadID, DWORD *dwStartAddress )
{
    // Get ntdll entry points.
    HMODULE ntDLLHandle = LoadLibrary(L"ntdll.dll");
    tNtQueryInformationThread NtQueryInformationThread = (tNtQueryInformationThread)GetProcAddress(ntDLLHandle, "NtQueryInformationThread");

    // Open thread with wrong access rights.
    HANDLE hRemoteProcess = OpenProcess( PROCESS_ALL_ACCESS, FALSE, processId );
    HANDLE hRemoteThread = OpenThread(THREAD_SUSPEND_RESUME, FALSE, threadID);

    if (hRemoteThread != 0 && hRemoteProcess != 0 )
    {
        try
        {
            // Duplicate handle to get correct access rights.
            HANDLE temporaryHandle = 0;
            DWORD duplicateHandleResult = DuplicateHandle(hRemoteProcess, hRemoteThread, GetCurrentProcess(),
                                                              &temporaryHandle, THREAD_QUERY_INFORMATION, FALSE, 0 );
            System::Console::WriteLine( String::Format("DuplicateHandle returned {0}", duplicateHandleResult ));
            System::Console::WriteLine( String::Format("DuplicateHandle error {0}", Marshal::GetLastWin32Error()));
            if (duplicateHandleResult != 0 )
            {
                try
                {
                    NTSTATUS ntStatus = NtQueryInformationThread(temporaryHandle, ThreadQuerySetWin32StartAddress, dwStartAddress, sizeof(DWORD), NULL);
                    System::Console::WriteLine( String::Format("NtQueryInformationThread returned {0}", ntStatus ));
                    if (ntStatus == 0)
                    {
                        System::Console::WriteLine( String::Format("StartAddress: {0:X16}", *dwStartAddress ));
                        return true;
                    }
                    else
                    {
                        System::Console::WriteLine( String::Format("NtQueryInformationThread error {0}", Marshal::GetLastWin32Error()));
                        return false;
                    }
                }
                finally
                {
                    CloseHandle(temporaryHandle);
                }
            }
            else
            {
                System::Console::WriteLine( String::Format("Cannot duplicate the thread handle to THREAD_QUERY_INFORMATION rights"));
                return false;
            }
        }
        finally
        {
            // Cleanup
            CloseHandle(hRemoteThread);
        }
    }
    else
    {
        System::Console::WriteLine( String::Format("Cannot open the thread with THREAD_SUSPEND_RESUME rights"));
        return FALSE;
    }
} 
```

`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:45:31.593

你说`DuplicateHandle`那`hRemoteThread`是一个句柄 in `hRemoteProcess`，但它不是。这是您当前进程中的句柄 - 您之前打开了几行。（线程是远程进程的一部分，但它的句柄不是。）

# cordova - 存储数据持久化或本地存储

> ID：12234160
> 
> 赞同：1
> 
> 时间：2012-09-02T07:29:33.880
> 
> 标签：cordova

我想将数据存储在数据库或本地存储中。第一次从网络服务下载我的列表时，我希望这个列表存储在数据库中。我做了一些事情，但介于两者之间。请帮助我，我是phonegap技术的初学者。
下次用户打开此屏幕时，它将从数据库而不是 Web 服务中获取列表。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Cache-control" content="no-cache">
    <title>First Group</title>
    <link href="style/style.css" rel="stylesheet" type="text/css" />
    <script language="javascript" type="text/javascript" src="script/actb.js"></script>
    <script language="javascript" type="text/javascript" src="script/actb2.js"></script>
    <script type="text/javascript" src="script/common.js"></script>
    <script type="text/javascript" src="script/soapclient.js"></script>
    <script type="text/javascript" src="script/cordova-1.9.0.js"></script>
    <script type="text/javascript">

        //Wait for Cordova to load
      // document.addEventListener("deviceready", onDeviceReady, false);

        //Cordova is loaded and it is now safe to make calls Cordova methods

        function onDeviceReady() 
        {
            checkConnection();
        }

        function checkConnection() 
        {
            var networkState = navigator.network.connection.type;

            var states = {};
            states[Connection.UNKNOWN]  = 'Unknown connection';
            states[Connection.ETHERNET] = 'Ethernet connection';
            states[Connection.WIFI]     = 'WiFi connection';
            states[Connection.CELL_2G]  = 'Cell 2G connection';
            states[Connection.CELL_3G]  = 'Cell 3G connection';
            states[Connection.CELL_4G]  = 'Cell 4G connection';
            states[Connection.NONE]     = 'No network connection';
            //alert('Connection type: ' + states[networkState]);
            if(states[networkState]=="No network connection")
            {
                alert("No Connection Available ");
                navigator.app.exitApp();
            }   
        }
        var stationList = new Array;    

        function GetStationCodes()
        {   
********************************check condition if there is element in database can you give some condition to check data base ******
            if(window.localStorage.getItem(1)!=null){
            alert("break");
            loadList();
            break;  
            } 
            document.getElementById('loadingImg').style.visibility = "visible"; 

             var pl = new SOAPClientParameters();
             var parameter1 = "";
             var parameter2 = "";
             pl.add("parameter1", parameter1);
             pl.add("parameter2", parameter2);
             SOAPClient.invoke(WSDLURL, "stationSearch", pl, true, GetStationCodes_callBack);
        }

        function loadList()
        {
            *************Get list from data base.  how to get keys length?********
            for (var i = 0; i <20 ; i++)
            {
             document.getElementById('loadingImg').style.visibility = "hidden";
            document.getElementById('submitBtn1').removeAttribute('disabled');
            document.getElementById('submitBtn2').removeAttribute('disabled');
            document.getElementById('getStationDesc').removeAttribute('disabled');
                stationList[i] = window.localStorage.getItem(i);
                //alert(stationList[i]);

            }

        }
        function GetStationCodes_callBack(r)
        { 
            document.getElementById('loadingImg').style.visibility = "hidden";
            document.getElementById('submitBtn1').removeAttribute('disabled');
            document.getElementById('submitBtn2').removeAttribute('disabled');
            document.getElementById('getStationDesc').removeAttribute('disabled');
**********************download list*********************
            for (var i = 0; i < r.length-1; i++)
            {
                stationList[i] = r[i].stationCode + " - " + r[i].stationName;
******************************save data in local storage***********************
                 window.localStorage.setItem(i,stationList[i] );
            }
            //alert( );

        }   
        function SetAction(flag)
        {
            if(flag==1)
            {
                 document.frmIndex.action="arrival.html";
            }
            else
            {
                // document.frmIndex.action="departure.html";
                 document.frmIndex.action="destination.html";
            }
        }
    </script>
</head>
<body onload="GetStationCodes()">
    <div id="wrapper">
        <div class="login_cont">
            <div class="home_icon"><a href="#"><img src="images/home-icon.png" alt="Home" title="Home" /></a></div>
            <h1 class="fr">Station ID</h1>
            <div class="cl"></div>
            <form name="frmIndex" type=get>
                <div class="log_cont">
                    <input id="getStationDesc" name="getStationDesc" type="text" class="log_txtfield" disabled="disabled"/>
                    <script>
                        var obj = actb(document.getElementById('getStationDesc'),stationList);
                        //setTimeout(function(){obj.actb_keywords = custom2;},10000);
                        this.actb_timeOut = -1;
                        // Number of elements autocomplete can show (-1: no limit)
                        this.actb_lim = 10;
                        // should the auto complete be limited to the beginning of keyword?
                        this.actb_firstText = true;
                        // Enable Mouse Support
                        this.actb_mouse = true;
                        // Delimiter for multiple autocomplete.
                        // Set it to empty array for single autocomplete
                        this.actb_delimiter = new Array(' ',',');
                        // Show widget only after this number of characters is typed in.
                        this.actb_startcheck = 1;

                        this.actb_bgColor = '#dbe3ec';
                        this.actb_textColor = '#00256a';
                        this.actb_hColor = '#dbe3ec';
                        this.actb_fFamily = 'arial';
                        this.actb_fSize = '16px';   
                        this.actb_hStyle = 'text-decoration:underline;font-weight="bold";text-align="left"';
                        function FillValues()
                        {
                            document.getElementById('getStationCode').value = document.getElementById('getStationDesc').value.substring(0,3);               
                        }
                    </script>
                    <div>

      <img src="images/ajax-loader.gif" id="loadingImg" visible =true style="margin:auto; position: absolute; left:50%; top:50%;"/>

</div>

                    <input id="getStationCode" name="getStationCode" type="hidden" /></div>
                    <input id="submitBtn1" type=submit  class="heading_btn" style="margin-top:10px;margin-left:50px" value="Arrival Dashboard" onclick="FillValues();SetAction(1)"  disabled="disabled">
                    <input id="submitBtn2"  type=submit class="heading_btn" style="margin-top:10px;margin-left:40px" value="Departure Dashboard" onclick="FillValues();SetAction(2)" disabled="disabled">

                </div>
            </form>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T10:43:00.673

使用你所拥有的，你可以循环遍历 while .getItem(i) !== undefined

您可以将返回的数据保存到 localStorage 而不是每个项目。

```
 window.localStorage.setItem('stations',JSON.stringify(stationList) ); 
```

然后当你来检查它是否在那里然后阅读

```
 if (typeof  localStorage.stations!== 'undefined' &&  localStorage.stations!=null) {
       var stationList= JSON.Parse(localStorage.stations)
    } 
```

或者你可以使用 webDB 和草坪椅

```
 <script type="text/javascript" src="Lawnchair.js" charset="utf-8"></script> 
 <script type="text/javascript" src="webkit-sqlite.js" charset="utf-8"></script>

 // Open local DB connection
 var lawnchair = new Lawnchair({table:'staions', adaptor:'webkit'}, function(){
// Lawnchair setup! 
 });

 // Getting some data out of the lawnchair database
 lawnchair.get('my_data_key', function(obj) {
 if (obj !== undefined) {
    lastSyncDate = obj.lastSync;
    dataList = obj.dataList;
}
 });

 // Saving to the database
 lawnchair.save({key:'my_data_key', lastSync: currentTime, dataList: someData}); 
```

# regex - 正则表达式 - 匹配文件名中的电子邮件，返回电子邮件地址列表

> ID：12234162
> 
> 赞同：1
> 
> 时间：2012-09-02T07:29:39.377
> 
> 标签：regex, windows, email, grep, cygwin

我有一个像这样的文本文件目录：

```
listedname_ _email@domain.com__subject_date.eml 
```

文件名保证在“电子邮件”部分具有这种模式：

```
email@domain.xxx_ 
```

因此，电子邮件、at-sign、域、句点、顶级域名、下划线。*（他们不会总是有一个前导下划线，因为不是每个人都在他们的电子邮件客户端中设置他们的“名字”。）*

Windows 上的一个目录中有大约 1,000 个文件，尽管我安装了 Cygwin 工具并且可以导航到该目录。文件内容中还有一行保证看起来像这样：

```
From: "Bob Lawblog" <boblawblog@domain.law> 
```

我想要做的是使用 grep 或任何工具以这种格式返回电子邮件地址列表，仅此而已：

```
email@domain.com <line break>
email2@domain.com <line break>
email3@domain.com <line break> 
```

没有前导或尾随下划线，没有电子邮件正文，没有主题等*（在逗号分隔的列表中获取它也很棒，但不是必需的。）*

有人可以帮我使用 regex/grep 命令吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:57:45.867

我想我已经理解了你的问题。如我错了请纠正我。似乎您有两个选项可以“获取”电子邮件地址：

1.  使用文件名，并应用正则表达式。
2.  使用`From:`每个文件中的行来获取所需的电子邮件地址。

我最喜欢第二个选项，因为找到正则表达式来匹配来自的电子邮件地址：`listedname_ _email@domain.com__subject_date.eml`会很棘手，因为如果电子邮件地址包含多个下划线怎么办？

要从每个文件中获取电子邮件地址列表，请尝试以下操作：

```
awk '/^From:/ { print substr($NF,2,length($NF)-2) }' *.txt > outfile 
```

如果您更喜欢这些电子邮件地址的 csv，请使用`printf`：

```
awk '/^From:/ { printf "%s,", substr($NF,2,length($NF)-2) } END { printf "\n" }' *.txt > outfile 
```

# .net - 在 MVC3 中排序时出现“无法对空引用执行运行时绑定”错误

> ID：12234174
> 
> 赞同：2
> 
> 时间：2012-09-02T07:32:08.997
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-3, c#-4.0, razor

这是查看代码：

```
@helper sortLink(string name, int id)
{
<a href="@Url.Action("Products", "Home", new { sortBy = id, isasc = (id ==     ViewBag.sortBy ? !@ViewBag.isAsc : @ViewBag.isAsc).ToString().ToLower() })">@name</a> 
}

<h2 class="center">Products</h2>

<table class="Products">
@* header *@

<tr>
<th>@sortLink("ID",1)</th>
<th>@sortLink("Name",2)</th>
<th>@sortLink("Number", 3)</th>
<th>@sortLink("Color", 4)</th>
<th>@sortLink("Standard Cost", 5)</th>
<th>@sortLink("List Price", 6)</th>
<th>@sortLink("Size", 7)</th>
<th>@sortLink("Weight", 8)</th>
</tr> 
```

这是控制器代码：

```
 {
    AdventureWorksLT2008R2Entities db = new AdventureWorksLT2008R2Entities();
    const int pageSize = 10;

    [HttpGet]
    public ActionResult Products(int page = 1, int sortBy = 1, bool isAsc = true)
    {
        IEnumerable<Product> products;

        #region sorting
        switch (sortBy)
        {
            case 1:
                products = isAsc ? db.Products.OrderBy(p => p.ProductID) : db.Products.OrderByDescending(p => p.ProductID);
                break;

            case 2:
                products = isAsc ? db.Products.OrderBy(p => p.Name) : db.Products.OrderByDescending(p => p.Name);
                break;

            case 3:
                products = isAsc ? db.Products.OrderBy(p => p.ProductNumber) : db.Products.OrderByDescending(p => p.ProductNumber);
                break;

            case 4:
                products = isAsc ? db.Products.OrderBy(p => p.Color) : db.Products.OrderByDescending(p => p.Color);
                break;

            case 5:
                products = isAsc ? db.Products.OrderBy(p => p.StandardCost) : db.Products.OrderByDescending(p => p.StandardCost);
                break;

            case 6:
                products = isAsc ? db.Products.OrderBy(p => p.ListPrice) : db.Products.OrderByDescending(p => p.ListPrice);
                break;

            case 7:
                products = isAsc ? db.Products.OrderBy(p => p.Size) : db.Products.OrderByDescending(p => p.Size);
                break;

            case 8:
                products = isAsc ? db.Products.OrderBy(p => p.Weight) : db.Products.OrderByDescending(p => p.Weight);
                break;
        }
        #endregion

        products = db.Products
            .OrderBy(p=>p.ProductID)
            .Skip((page - 1) * pageSize)
            .Take(pageSize)
            .ToList();

        ViewBag.CurrentPage = page;
        ViewBag.PageSize = pageSize;
        ViewBag.TotalPages = Math.Ceiling((double)db.Products.Count()/pageSize);

        return View(products); 
```

我正在关注一个教程，并在排序部分一直显示此错误，我需要您的帮助来删除错误，请解释 Sortlink 辅助方法发生了什么，我无法很好地理解它。编写本教程的人并没有对此部分进行太多解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T07:38:40.757

我猜问题是您试图`ViewBag.isAsc`在视图中使用，但从未分配它。此外，在 case 语句之后，您正在重置`products`变量，这会使您在 case 语句中设置的顺序完全无效 - 删除它。所以之后它应该是这样的：

```
switch(sortBy) {
    // include all the case statements here as you have them

    // you need to add a default section to make it a valid switch statement
    default:
    break;
}
#endregion

// (remove the products = statement that was here, it's not needed

ViewBag.CurrentPage = page;
ViewBag.PageSize = pageSize;
ViewBag.TotalPages = Math.Ceiling((double)db.Products.Count()/pageSize);

// add these two lines, as required by the View
ViewBag.isAsc = isAsc;
ViewBag.sortBy = sortBy;

return View(products
    .Skip((page - 1) * pageSize)
    .Take(pageSize)
    .ToList()
); 
```

# mysql - 在派生表和日历表上应用右联接以获取两天之间的所有日期

> ID：12234178
> 
> 赞同：2
> 
> 时间：2012-09-02T07:33:30.253
> 
> 标签：mysql, sql

我不是数据库专家。我只是在做一个项目，我们需要在用户从日历中选择的两个日期之间每天显示页面浏览量。我有以下

SQL 查询带来的总页面浏览量如

```
SELECT DATE_FORMAT(created_at,'%d %b %Y') as this_date, count(*) as Views 
from promotion_insights WHERE f_id = '2' AND p_id = '12' 
AND created_at BETWEEN '2012-08-15' AND '2012-08-19' 
GROUP BY this_date 
```

结果就像

```
----------------------
this_date   View
---------------------
15 Aug 2012     3
16 Aug 2012     2
---------------------- 
```

我还有一个日历表和一个存储过程。日历表有一个名为（日期字段）的日期列。我已经通过调用存储过程生成了日期，所以不用担心。现在我想要的是在日期的基础上对具有日历表的上表（this_date 和 view 列）进行正确的连接，以显示用户选择的 all_dates 并将 0 用于具有 0 个视图的日期。count(*) 也通过返回 1 而不是 0 来制造麻烦

我想要的连接的预期输出是这样的：

```
----------------------
this_date   View
---------------------
15 Aug 2012     3
16 Aug 2012     2
17 Aug 2012     0
18 Aug 2012     0
19 Aug 2012     0

---------------------- 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T13:01:00.747

您可以使用日历表轻松地做到这一点——在大多数数据库中这是一个好主意。

```
SELECT DATE_FORMAT(c.date,'%d %b %Y') as this_date, count(*) as Views 
from calendar c left outer join
     promotion_insights pi
     on c.date between '2012-08-15' AND '2012-08-19' and
        c.date = pi.created_at
WHERE f_id = '2' AND p_id = '12'
GROUP BY c.date 
```

注意：这假定 created_at 存储为日期，而不是日期时间。有一个时间组件可能会导致比较失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T10:20:52.513

如果您想在 SQL 中执行此操作，您需要一个行生成器为您的日期范围内的每一天生成一行，然后将您的查询连接到生成的行以获取您日期范围内每一天的结果（即使没有数据在该范围内存在几天）。

如果您使用的是 Oracle，您可以使用`ALL_OBJECTS`或`DUAL`来生成行。当您`DATE_FORMAT`在查询中使用时，您似乎使用的是 MySQL。之前发布了一个关于[如何在 MySQL](https://stackoverflow.com/questions/701444/how-do-i-make-a-row-generator-in-mysql)中制作行生成器的问题。它指出：

> 不想这么说，但 MySQL 是四大中唯一没有此功能的 RDBMS。

# git - svn2git 神秘错误

> ID：12234184
> 
> 赞同：9
> 
> 时间：2012-09-02T07:33:53.913
> 
> 标签：git, svn

我正在尝试将 SVN 存储库导入 GIT。
svn2git 以以下错误消息终止：

> 命令失败：2>&1 git svn fetch

当我尝试手动运行“git svn fetch”时，会出现以下错误：

> r8641 = dbb23736330e97c356a5ecd0dd29634265b7956c (refs/remotes/svn/trunk) 权限被拒绝：无法打开'/tmp/report.tmp'：权限被拒绝在 C:\Program Files (x86)\Git/libexec/git-core\git- svn线3187

（在管理员权限下运行脚本）。

有什么建议吗？

UPD 我注意到，在此错误发生之前 - 一些文件已成功处理（即 svn fetch 执行了一段时间）。该错误在命令启动后随机发生，通常在几秒钟内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T08:46:22.460

使用 -d -r 运行 svnserve 可能是一个解决方案：

[http://blog.dbtracer.org/2010/01/20/porting-subversion-git-with-error/](http://blog.dbtracer.org/2010/01/20/porting-subversion-git-with-error/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-08T17:24:29.657

问题是您正在本地访问此文件并为原始 svn 存储库和从 svn 迁移到 git 的 git 实例使用不同的格式（很可能您的 git 落后于您的 svn 存储库版本） - 而是尝试通过运行迁移svn server - 尝试启动一个 svn 服务器

`svnserve.exe -d -r /path/to/repo`

然后使用以下命令再次尝试导入：

`git.exe svn init -s "svn://localhost/repo_name"`

问题不是您的权限，而是版本不匹配

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T08:19:17.963

从[这里](https://github.com/nirvdrum/svn2git/issues/69)：

> 我遇到了同样的问题，在过程中间发生错误（我错过了作者文件中的一些作者）时发生。我通过删除执行 svn2git 的目录来解决它，重新创建它并再次执行它。这仍然不是一个解决方案，这个问题需要解决。

# android - 如何使用android actionbar更改contentsView

> ID：12234188
> 
> 赞同：1
> 
> 时间：2012-09-02T07:34:46.837
> 
> 标签：android

我是 android 新手，我只是不知道如何使操作栏按我想要的方式工作。我想单击我的操作栏上的一个项目，该项目在 setContentView 到不同的 XML 文件之间发生变化。

我有以下 XML 文件：activity_main_vertical_view.xml activity_main.xml

（请注意，这不是让我可以在横向模式下看到它，我知道创建一个名为 layer-land 的文件夹。我希望我的 xml 文件在纵向模式下可以水平查看，这就是我试图改变的原因XML）。

我的操作栏中有一个“更改视图”项目，我想在使用它时切换 XML。但是它不起作用。我究竟做错了什么？

我有 2 个类： MainActivity.java VerticalView.java

我的 Manifest.xml 有以下关于 VerticalView 的代码

```
<activity
    android:name=".VerticalView"
    android:label="@string/title_activity_vertical_view" >
    <meta-data
        android:name="android.support.PARENT_ACTIVITY"
        android:value="com.example.calendar.activity_main" />
</activity> 
```

我的 activity_main.xml 菜单具有以下代码：

```
<item
    android:id="@+id/change_view"
    android:onClick="changeView"
    android:orderInCategory="100"
    android:showAsAction="never"
    android:title="@string/change_view" >
</item> 
```

我的 MainActivity.java 有以下代码：

```
 public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    }

    public void changeView(View view) {
        Intent intent = new Intent(view.getContext(), VerticalView.class);
        startActivity(intent);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;

    }
} 
```

最后，我的 VerticalView.java 有以下代码：

```
public class VerticalView extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main_vertical_view);

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T11:26:33.337

您没有遵守以下规则`android:onClick`：

> 该方法必须在 Activity 中声明为 public 并接受 MenuItem 作为其唯一参数，该参数指示单击的项目。

您的方法将 a`View`作为参数，而不是 a `MenuItem`。

另请注意，此方法仅适用于 API 级别 11 及更高级别。为了向后兼容，您可能希望跳过`android:onClick`并覆盖`onOptionsItemSelected()`。

# c - Apache API：`ap_parse_form_data` 获取数据？例子？

> ID：12234189
> 
> 赞同：2
> 
> 时间：2012-09-02T07:35:00.697
> 
> 标签：c, forms, apache, http, post

我正在尝试用来`ap_parse_form_data`解析 POST 请求：

```
request_rec* R = ...;
apr_array_header_t* H;
ap_parse_form_data(R, NULL, &H, -1, 1 << 20); 
```

我想有两个操作`H`：

通过以下键获取条目`"foo"`：

```
const char* val = ap_get_header(H, "foo"); 
```

并遍历所有键/值：

```
while (ap_has_more_headers(H))
{
    const char* key = ap_get_next_header_key(H);
    const char* value = ap_get_next_header_value(H);
    ...
} 
```

有谁知道如何做到这一点或记录在哪里？( `ap_get_header`, `ap_has_more_headers`,`ap_get_next_header_key`和`ap_get_next_header_value`是虚构的 API 调用来显示我想要做什么。)

我还需要以`H`某种方式释放吗？

在这两个用例中使用的工作示例`ap_parse_form_data`会很棒。

# javascript - Javascript 错误：未捕获的 ReferenceError：未定义编辑

> ID：12234193
> 
> 赞同：3
> 
> 时间：2012-09-02T07:36:46.800
> 
> 标签：javascript, jquery, html, events, dom

我正在从 onclick 事件中调用一个名为 edit 的函数，如下所示。

```
<script type="text/javascript">
  $(document).ready(function () {
    ...

    $.each(data, function (key, val) {
      ...

      var td11 = $('<input type="button" value="Edit" onclick="edit();" />')
        .attr("name",val.Id);

      $(tr2).append(td11);
      $(table1).append(tr2);
    });

    $("#cers").append(table1); 
```

该函数定义在$.each循环之外，在$(document).ready内部，如下

```
function edit() {
  alert("Id ");
} 
```

当我单击编辑按钮时，Chrome 显示错误：未捕获的引用错误：未定义编辑。

没有其他错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:44:43.090

不建议将功能 (javascript) 与布局 (HTML) 混合使用，并且随着项目范围的扩大，这会导致不太理想的开发体验。最好使用 jQuery 绑定到该元素上的 click 事件，如下所示：

```
$.each(data, function (key, val) {
    /* . . . */
    var td11 = $('<input type="button" value="Edit" />').attr("name",val.Id);
    $(tr2).append(td11);
    $(table1).append(tr2);
});
$("#cers").append(table1);

$('input[value="Edit"]').click( edit );

function edit() {
    alert("Id ");
} 
```

或者，使用这种风格，您甚至不需要命名函数：

```
$('input[value="Edit"]').click( function() {
    alert("Id ");
}); 
```

但是，如果使用命名函数，重要的`edit`是在绑定事件处理程序的同一范围内定义（即在您调用的同一范围内`.click(...)`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:48:46.417

可能您已经定义`edit`了不在全局范围内的函数。它不仅应该定义在`$.each`循环之外，还应该定义在外部`$(document).ready`等等。例如这有效：

```
<!doctype html>

<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>

    <script type="text/javascript">
      function func () {
        alert('func');
      }

      $(document).ready(function () {
        $('<a href="#" onClick="func();">link</a>').appendTo('#container');
      });
    </script>
  </head>

  <body>
    <div id="container"></div>
  </body>
</html> 
```

但在您的情况下，最好在 javascript 中绑定事件：

```
$.each(data, function (key, val) {
  // ... some code
  var td11 = $('<input type="button" value="Edit">')
    .click(edit)
    .attr('name', val.Id);

  $(tr2).append(td11);
  $(table1).append(tr2);
}); 
```

# jboss - SessionScoped 获取不同的实例

> ID：12234194
> 
> 赞同：2
> 
> 时间：2012-09-02T07:37:02.417
> 
> 标签：jboss, cdi, weld

对于对同一用户会话的两次调用，我得到了 @SessionScoped bean 的不同实例。什么会导致这种情况？

将注解 @SessionScoped 的 bean 注入到 servlet 和 RESTEasy JAX-RS Web 服务端点中。用户使用带有证书的 HTTPS 登录。第一个调用转到 RESTEasy 端点。来自浏览器的下一个调用转到 servlet。我希望在两个调用中使用相同的 bean 实例，但它们是不同的。... 有任何想法吗？

使用 JBoss 7.0.1

豆：

```
@Stateful
@SessionScoped
public class MyBean implements Serializable { ... } 
```

REST 端点：

```
@Path("/one")
public class MyService extends JAXRSPlugin { 
   @Inject MyBean myBean;
   ... 
} 
```

小服务程序：

```
@WebServlet(urlPatterns = "/two", asyncSupported = true)
public class MyServlet extends HttpServlet { 
   @Inject MyBean myBean;
   ... 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T16:28:30.780

事实证明，REST 服务方法实际上并不应该有一个 HttpSession 来共享状态。REST 服务应该是无状态的。它们被赋予@SessionScoped bean，就好像它们是设计的@RequestScoped。

对于这种情况，这不是我想要的，但也许我不应该对这些调用使用 REST。主要是我只想方便地将 URL 路径映射到我的 REST 服务类中的方法。据我所知，Servlet 没有这样的路径到方法映射。

基本上我看到了 3 个选项：(1) 寻找一种在一个 Servlet 中使用的调度机制，(2) 使用多个 Servlet，或者 (3) 通过滥用 @Context HttpServletRequest 来访问 HttpSession 来滥用 REST。我不喜欢滥用 API，所以选项 3 不可用。CDI 可能使选项 2 很酷，但选项 1 可能更常见（因此可能更容易被其他人维护）。

# php - 在 PHP 中打印 3-D 数组的叶元素的所有可能性

> ID：12234197
> 
> 赞同：-1
> 
> 时间：2012-09-02T07:38:09.657
> 
> 标签：php

我有一个问题并试图在 php 中解决。我需要你的想法来解决这个问题。我会试着解释，希望我能。

我有一个这样的数组：

```
$mainArr = array(array("a","b","c"),array("1","2","3"),array("x","y","z"));
Array
(
    [0] => Array
        (
            [0] => a
            [1] => b
            [2] => c
        )

    [1] => Array
        (
            [0] => 1
            [1] => 2
            [2] => 3
        )

    [2] => Array
        (
            [0] => x
            [1] => y
            [2] => z
        )

) 
```

我正在尝试做的是打印叶子元素的所有 3 种可能性。像那样：

```
a1x
a1y
a1z

a2x
a2y
a2z

a3x
a3y
a3z

b1x
b1y
b1z

.
.
. 
```

我试图形成一个算法来做到这一点，但我被卡住了。

你能帮我解决这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:01:27.193

您应该检查[RecursiveIteratorIterator](http://php.net/manual/pt_BR/class.recursiveiteratoriterator.php) 我相信这是您问题的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T07:42:01.043

```
foreach ($mainArr[0] as $level1)
  foreach ($mainArr[1] as $level2)
    foreach ($mainArr[2] as $level3)
      echo $level1 . $level2 . $level3 . "<br />"; 
```

# jenkins - Jenkins 构建步骤超时

> ID：12234204
> 
> 赞同：61
> 
> 时间：2012-09-02T07:39:45.043
> 
> 标签：jenkins, build-process, build-automation, jenkins-plugins

在 Jenkins 中，有没有办法为每个或选定的构建步骤提供不同的超时？
构建时插件在整个项目中提供了超时功能“如果它被卡住则中止构建”，我需要为每个步骤提供不同的超时。这样我可以使我的过程更有效率。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2019-11-01T11:18:24.210

如果您使用的是 Jenkins 管道，并且较新的声明式样式（具有顶级`pipeline {`元素），那么有一个`timeout` `option`可用于整体工作或单个阶段的：

```
pipeline {
    agent any

    options {
        timeout(time: 1, unit: 'HOURS')   // timeout on whole pipeline job
    }

    stages {
        stage('Example') {
          options {
              timeout(time: 1, unit: 'HOURS')   // timeout on this stage
          }
          steps {
              echo 'Hello World'
          }
        }
    }
} 
```

文档：[https ://jenkins.io/doc/book/pipeline/syntax/#options](https://jenkins.io/doc/book/pipeline/syntax/#options)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2017-10-26T15:02:35.310

在当前版本的 Jenkins 中，这是可以做到的。点击“配置”，然后选择“构建环境”选项卡，然后设置超时。

这是一个屏幕截图： [![在此处输入图像描述](../Images/1216ed90ea5f54d886edd97c11f713ba.png)](https://i.stack.imgur.com/SyEkj.png)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-03-20T22:30:22.720

在管道作业中，您可以将步骤包装`timeout`如下：

```
timeout(time: 5, unit: 'MINUTES') {
   // steps to execute
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-05-23T12:50:08.617

这个问题最初是在 Jenkins 流水线存在之前提出的。尽管您可以继续通过 GUI 使用和配置 Jenkins，但目前建议将您的项目转换到管道。使用流水线可以跟踪对流水线的更改，并将其存储为代码，以便在需要移动 Jenkins 服务器时轻松地在任何机器上重新创建构建。

使用管道，为构建的特定部分添加超时是微不足道的。管道语法简单易用。

```
timeout(time:5, unit:'DAYS') {
    input message:'Approve deployment?', submitter: 'it-ops'
} 
```

相关问题：[如何向 Jenkins Pipeline 添加超时步骤](https://stackoverflow.com/questions/38096004/how-to-add-a-timeout-step-to-jenkins-pipeline#38106655)

示例无耻取自：[CloudBees Jenkins Pipeline Plugin 的 10 大最佳实践](https://www.cloudbees.com/blog/top-10-best-practices-jenkins-pipeline-plugin)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-07-12T09:20:25.383

构建超时插件不适用于管道。参考[维基](https://wiki.jenkins.io/display/JENKINS/Build-timeout+Plugin)

对于管道超时，请尝试以下操作：

```
timeout(time: 30, unit: 'MINUTES') {
  node {
    sh 'foo'
  }
} 
```

另一个线程的类似答案： [如何向 Jenkins Pipeline 添加超时步骤](https://stackoverflow.com/questions/38096004/how-to-add-a-timeout-step-to-jenkins-pipeline)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-03-19T13:19:48.263

我不知道没有这样的功能。[JENKINS-8900](https://issues.jenkins-ci.org/browse/JENKINS-8900)请求它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-11-15T10:32:11.633

请为您的 Jenkins 安装 Build Timeout 插件。

Jenkins> 管理 Jenkins> 管理插件

在可用选项卡中搜索 Build Timeout .. 安装它。你会在构建环境中找到它作为“如果它被卡住则中止构建”。设置超时策略和时间。绝对截止日期 Elastic 可能没有活动

就我而言，我使用了无活动。

希望能帮助到你。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-04-04T18:38:42.237

我认为[`timeout`来自 GNU coreutils 的命令](https://www.gnu.org/software/coreutils/manual/html_node/timeout-invocation.html)可能是你想要的。这是假设您的构建步骤是脚本。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-09-02T09:59:38.917

最简单的方法（这就是我正在这样做的方式）是实际上让不同的项目相互依赖并连续构建它们。它并不完美，但另一种选择是使用不同的工具/构建行为监视不同插件的执行。

尽管如此，这种方法仍然有效，尽管它确实很糟糕......

顺便说一句，有一个不错的插件可以帮助您使用一组项目 -[构建管道插件](https://wiki.jenkins-ci.org/display/JENKINS/Build+Pipeline+Plugin)。我现在正在使用它来可视化和验证我创建的管道。真的很方便。。。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-05-02T05:59:44.193

如果您不想使用 Jenkins 插件并且想要使脚本或任何命令超时，那么您可以使用 Linux 内置实用程序“超时”。

```
timeout -s KILL 1m ./test 
```

上述命令将运行`test`1 分钟，如果它在超时后继续执行，则该命令将超时并通过`KILL`实用程序终止进程。

# c# - 尝试减小图像尺寸时图像尺寸变大

> ID：12234205
> 
> 赞同：-1
> 
> 时间：2012-09-02T07:40:01.673
> 
> 标签：c#, image-resizing

> **可能重复：**
> [尝试减小图像尺寸时图像尺寸变大](https://stackoverflow.com/questions/12228050/image-size-got-bigger-when-trying-to-reduce-its-size)

我要调整的是一个`.jpg`文件（5kb），结果是 27kb，无论我使用哪种 InterpolationMode。从它的大小来看，原始文件可能之前已经被压缩过。目的是降低它的分辨率，以便在我将它添加到我的站点时它更小。我正在使用本教程： [图像调整大小教程。](http://www.switchonthecode.com/tutorials/csharp-tutorial-image-editing-saving-cropping-and-resizing)

我设法调整了分辨率，包括裁剪。我的问题是图像的实际尺寸变大了，而不是像我预期的那样变小了。

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:48:49.993

尝试调整传递给`saveJpeg`方法的参数的质量，而不仅仅是`InterpolationMode`.

您目前使用的是什么质量的？

# qt - Qt - 接收信号的对象

> ID：12234207
> 
> 赞同：0
> 
> 时间：2012-09-02T07:40:23.410
> 
> 标签：qt, object

在`Qt`应用程序中，如果我们有以下示例：

```
.
.
.
QApplication a(argc, argv);
.
.
.
QObject::connect(&button, SIGNAL(clicked()), &a, SLOT(quit()));
.
.
. 
```

在这里，我知道`button`将发送信号的对象。因此，`a`是响应信号的对象。在这种情况下，`a`是一个`QApplication`对象。但是，它真正代表的是什么？比如我们知道那`button`是一个按钮对象，那么它`a`代表什么？它只是一个*窗口*吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T07:43:26.113

`QApplication`不代表任何视觉元素。相反，它代表了整个“程序”——这当然是更抽象的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T14:30:51.663

引用自[Qt 文档](http://doc-snapshot.qt-project.org/4.8/qapplication.html)

```
The QApplication class manages the GUI application's control flow and main settings. 
```

实例最重要的任务`QApplication`是处理事件：例如，每当您移动鼠标时，应用程序都会从​​操作系统（或窗口系统）接收事件，`QApplication`实例将分派这些事件并将其转发到您的 GUI。此外，当您`emit`发出信号时，`QApplication`的事件循环将调用连接的插槽。

涉及的其他任务`QApplication`：

*   命令行解析
*   样式（根据操作系统为小部件选择正确的外观）
*   会话管理
*   翻译/国际化

# jsf - javax.el.E xpressionFactory 的 Tomcat6 链接错误

> ID：12234208
> 
> 赞同：1
> 
> 时间：2012-09-02T07:40:26.640
> 
> 标签：jsf, jakarta-ee, tomcat, maven, cloudbees

我正在将一个应用程序从运行良好的 tomcat7 移植到 tomcat6，因为 CloudBees 尚不支持 tomcat 7，这是我正在考虑的 PAAS。

我正在移植到 tomcat 6.035。我认为 el-api.jar 在我的 java-ee 依赖项和 tomcat 上都是我的问题，但我不知道如何解决它。错误和我的 pom.xml 片段如下：

POM：（我认为，这是与 el-api 相关的唯一 2 个依赖项。我删除了另一个，并将 java-ee 依赖项的范围设置为“提供”。

```
 <dependency>
        <groupId>org.glassfish</groupId>
        <artifactId>javax.faces</artifactId>
        <version>2.1.11</version>
    </dependency>
    <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency> 
```

严重：部署期间出现严重错误：java.lang.LinkageError：加载程序约束违规：解析接口方法“javax.servlet.jsp.JspApplicationContext.getExpressionFactory()Ljavax/el/ExpressionFactory;”时 当前类 com/sun/faces/config/ConfigureListener 的类加载器（org/apache/catalina/loader/WebappClassLoader 的实例）和用于解析的类加载器（org/apache/catalina/loader/StandardClassLoader 的实例）类 javax/servlet/jsp/JspApplicationContext 对于 com.sun 的 com.sun.faces.config.ConfigureListener.registerELResolverAndListenerWithJsp(ConfigureListener.java:695) 的签名中使用的 javax/el/ExpressionFactory 类型具有不同的类对象。 faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:246) 在 org.apache.catalina.core.StandardContext。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:34:54.900

你是对的，这确实是问题所在，解决它的方法是将它从你的网络应用程序中删除。

# c# - Microsoft JScript 运行时错误：无法获取属性“样式”的值：对象为空或未定义

> ID：12234210
> 
> 赞同：1
> 
> 时间：2012-09-02T07:41:18.560
> 
> 标签：c#, javascript, asp.net

这是我的代码行抛出错误

```
$get("Panel1").style.visibility= "visible"; 
```

此行在普通页面上运行良好。但每当在拥有母版页的子页面上使用它时，它都会将错误抛出为“Microsoft JScript 运行时错误：无法获取属性'style'的值：对象为空或未定义”。我是 javascript 的优秀初学者。我在 Asp.Net 3.5 上使用它。以前任何人都知道这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:04:13.597

您的问题可能是因为您不使用呈现的 id，如果您在 dipper 页面上使用相同的面板，那就会发生变化。并且因为您没有使用正确的 id，所以该`$get()`部分返回`null or undefined`. 将您的代码更改为：

```
$get("<%=Panel1.ClientID%>").style.visibility= "visible"; 
```

并呈现 panel1 id，因为它最终会出现在 html 页面上。

您应该单独解决的问题：您可以在页面上从浏览器实用程序中查看“查看页面源代码”并查看`Panel1`id 是否存在于您的 html 结构中，在那里您可以找到正确的 id 以及原因没找到。所以这里的重点是我们查看 html 呈现的页面以找出脚本出了什么问题。

# python - Python - 两个相同长度的列表之间的完全区别

> ID：12234211
> 
> 赞同：1
> 
> 时间：2012-09-02T07:41:19.200
> 
> 标签：python, list

我有两个清单：

```
a = ['Peter', '1982', '2000', 'Homeland', '10.34']
b = ['Peter', '1982', '2000', 'Homelnad', '10.32'] 
```

我想要完整的差异。所以我想要这样的输出： ['', '', '', '', '10.32'] 所以我只想在正确的位置更改值。

是否有一些内置功能？最快的方法是什么？我必须像这样“手动”做吗？

```
i = 0
new_list = []
for item in a:
    if item != b[i]:
        new_row.append(item)
    else:
        new_row.append('')
    i += 1
    new_list.append(new_row) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T07:46:22.913

我不认为有内置的，但这里有一个更短的“手动”方式：

```
In [1]: a = ['Peter', '1982', '2000', 'Homeland', '10.34']

In [2]: b = ['Peter', '1982', '2000', 'Homelnad', '10.32']

In [3]: [be if ae != be else '' for ae, be in zip(a, b)]
Out[3]: ['', '', '', 'Homelnad', '10.32'] 
```

# javascript - javascript中具有默认js函数的日期的第二天

> ID：12234212
> 
> 赞同：2
> 
> 时间：2012-09-02T07:41:21.877
> 
> 标签：javascript, jquery, jquery-ui

是否可以使用默认的 java 脚本或 jquery 函数以“yyyymmdd”格式获取给定日期的下一个日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:24:10.123

当您指定 jQuery UI 时，您可以使用其内置的日期格式化程序来获取所需的输出。

使用正则表达式和`new Date`如下所示是为了保证日期解析的变幻莫测不会影响结果。

```
function getTomorrow(dateStr) {
    var ymd = dateStr.match(/^(\d{4})(\d{2})(\d{2})$/);
    if (ymd) {
        var date = new Date(ymd[1], ymd[2] - 1, ymd[3]);
        date.setDate(date.getDate() + 1);
        return $.datepicker.formatDate('yymmdd', date);
    } else {  // parse error
        return null;
    }
} 
```

演示在[http://jsfiddle.net/alnitak/R8awH/](http://jsfiddle.net/alnitak/R8awH/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T10:27:11.553

这里似乎有些混乱。

JavaScript Date 对象的核心是自 1970-01-01 00:00:00 **UTC**以来的毫秒数。最后一点非常重要。

如果您通过指定部分来创建日期，例如 2012 年 9 月 2 日（注意月份编号）：

```
new Date(2012, 8, 2); 
```

然后在主机本地时区的日期开始时的午夜创建一个日期对象，即本地时区的 2012-09-02T00:00:00。但是，如果您指定自纪元以来的时间，例如

```
new Date(1346544000000) // 2012-09-02T00:00:00Z 
```

那么日期是在那个时间**UTC**创建的，所以它会在不同的时区显示不同的本地时间，代表相同的 UTC 时间。因此，如果时间是 2012-09-02T00:00:00Z，那么在 GMT (GMT+10) 前十小时的时区中，它将是：

```
2012-09-02T10:00:00+1000 
```

如果时区比 GMT (GMT-06) 晚 6 小时，它将是：

```
2012-09-01T18:00:00-0600 
```

等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T07:49:31.257

构造日期对象，并设置日期加 1。

```
var dateStr = "20120902";
var d = new Date(dateStr.replace(/(\d{4})(\d{2})(\d{2})/, '$1/$2/$3'));
d.setDate(d.getDate() + 1);
console.log(d); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T08:10:45.810

这是您的代码：

```
function getnextDay(prevDate) {
  var weekday = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
  prevDate = prevDate.toString();
  var formatteDate = prevDate.substr(0, 4) + ',' + prevDate.substr(4, 2) + ',' + prevDate.substr(6, 2);

  formatteDate = new Date(formatteDate);
  document.write(weekday[formatteDate.getDay() + 1])
}

getnextDay(19890831)​​ 
```

和 [小提琴](http://jsfiddle.net/2Rn9j/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-14T04:23:33.360

它非常简单。

```
var today = new Date();
var date = new Date(today.getFullYear(),today.getMonth(),today.getDate()+1); 
```

如果您广泛使用日期功能，请使用 moment.js。
为了第二天，这就足够了。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-04-08T12:50:10.537

是的

使用 javaScript 非常简单，如下所示：

```
today = new Date().getTime();
tomorrow = today + 24*60*60*1000;
parsed_tomorrow = new Date(tomorrow); 
```

# java - Java 8 中的并行性

> ID：12234214
> 
> 赞同：15
> 
> 时间：2012-09-02T07:41:41.310
> 
> 标签：java, parallel-processing, java-8

我尝试使用新的并行功能 JDK8，但不幸的是，我无法让它工作。NetBeans 7.1 说不存在“并行”方法。

这种方法需要特殊导入吗？有人有演示 Java 8 并行性的示例代码吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T23:16:23.973

几周以来，我一直在使用 JDK8 Lambda Developer Preview。以下是我为简化代码的编译和测试所做的工作：

## 配置 JEdit 以编译 JDK 8 代码

以下指南介绍了如何配置 Apache Ant 和 JEdit，以便使用 JDK 8 Lambda 表达式和 JDK 8 Lambda 开发人员预览版中的新 API 功能轻松编译源代码。

这就是我今天所做的，主要是因为还没有 IDE 支持这些 JDK 8 特性。

下载以下内容：

*   [JDK 8](http://jdk8.java.net/lambda/)
*   [编辑](http://www.jedit.org/)
*   [阿帕奇蚂蚁](http://ant.apache.org/)

然后创建以下目录结构：

```
Sanbox
|-----jdk8
|-----ant
|-----projects 
```

*   将未压缩的 JDK 构建放在 jdk8 目录中。
*   将未压缩的 Apache Ant 放在 ant 目录中。
*   项目目录将用于 JEdit 项目。

然后安装以下 JEdit 插件：

*   蚂蚁农场
*   Java折叠
*   项目生成器
*   项目查看器
*   项目向导
*   SVN 插件（我用它来同步我的项目和我的仓库，不过你可能不需要它）

现在，配置您的 Apache Ant：

*   在您的主文件夹中创建一个名为 antrc_pre.bat 的文件（即 %USERPROFILE%\antrc_pre.bat）。
*   （注意：如果您使用的是 Linux，您可以在 ~/.ant/ant.conf 中进行配置）。
*   该文件将在运行任何任务之前由 Apache Ant 运行，因此，这是通过定义 JAVA_HOME 变量来配置或覆盖要使用的 JDK 的地方。
*   在该文件的顶部定义 JAVA_HOME 变量并使其指向安装 JDK8 的目录。有点像这样：`SET JAVA_HOME=C:\Sanbox\jdk8`
*   完成 JDK 8 会话后，请务必将其注释掉，以便 Ant 继续使用默认配置。

是时候配置 JEdit Ant 插件了

*   在 JEdit 中转到插件 -> 插件选项 -> 蚂蚁农场 -> 构建选项
*   在对话框中选择选项：“使用外部脚本/构建文件运行 Ant 目标”
*   选择ant.bat 脚本（即C:\Sandbox\ant\bin\ant.bat）。
*   注意：如果您使用的是 Ant 1.8.x，则可能需要在插件的属性部分添加一个属性：build.compiler=javac1.7，否则在使用 JDK 8 编译时会出错。不过，我对 Ant 1.7 没有这个问题。

然后创建一个新的 Java 项目：

*   在 JEdit 中转到插件 -> 项目生成器 -> 创建新项目
*   选择 Java 应用程序并单击下一步
*   选择您的项目目录作为定位文件的位置（即 C:\Sanbox\projects）。

瞧！此时，JEdit 会在工具栏中呈现四个按钮：Build Application、Compile、Clean 和 Run Application。这些都是基于 build.xml 文件并根据相应的 Ant 任务执行的。一切顺利，您可以开始编写 lambda 表达式并使用新的 API：-)

## 并行示例

在上一个开发者预览版 (b50) 中，几乎没有实现并行。我可以看到他们在一个单独的分支中做更多的工作（如果你想下载并构建 OpenJDK8 源代码）。

但是，您可以使用在数组`Arrays.parallell`上创建包装器的方法。`ParallelIterable`这可以用来测试一些并行特性。

我做了一个例子来在一个大数组中找到素数。当我并行运行它时，我可以验证我所有的四个内核都被使用了。

```
Integer[] source = new Integer[30000000];
for(int i=0; i<source.length; i++)
    source[i] = i;

ParallelIterable<Integer> allIntegers = Arrays.parallel(source).filter(isPrime);
Iterable<Integer> primes = allIntegers.into(new LinkedList<Integer>()); 
```

这在我的带有 Apache Ant 8.4.x 和 JDk8-b50 的 JEdit 项目中编译并运行良好。

我希望这有帮助。

PD：

`isPrime`为了不影响示例的简单性，我没有在上面的代码中定义谓词。我很确定每个人都可以轻松地定义一个素数谓词来尝试这段代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:18:11.817

您可以使用 Netbeans 的[夜间版本](http://bertram2.netbeans.org:8080/job/jdk8lambda/lastSuccessfulBuild/artifact/nbbuild/)，它现在对 JDK8 功能有一些实验性支持 - 我已经尝试过，它似乎与 lambdas 配合得很好（至少你不会在它们下面看到红色曲线，自动格式化并且建议的更正似乎还没有正常工作，但它们更多的是小问题。）您需要确保将启用 Lambda 的 JDK8 添加为 Java 平台，然后将源级别设置为Java 8 用于您想要试验的项目。

[您可以在此处](http://jdk8.java.net/lambda/)获取最新的支持 Lambda 的 JDK 构建。

在撰写本文时，静态类上有 3 种类型的并行方法`Arrays`可以试验 - `parallelStream()`、`parallelPrefix()`和`parallelSort()`。但是请注意，这可能会在最终发布之前发生变化，目前的 API 非常不稳定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T08:32:47.973

检查您的 netbeans 是否使用 jdk8（我对此表示怀疑）。如果没有，则使其指向 jdk8 的本地副本，而不是内置 jdk。希望这可以帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-02T08:09:30.963

我的建议是将 Netbeans 放在一边，使用纯文本编辑器编辑您的 Java 代码，然后使用 Java 8 工具链从命令提示符编译和运行它。这样您就可以确定您的问题不是由 Netbeans 问题引起的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-21T06:31:44.860

下面的示例查找我的文档目录中的所有目录：

```
List<File> directories = Arrays.asList(new File("/Users/sid/Documents")
                               .listFiles())
                               .parallelStream()
                               .filter(t -> t.isDirectory() == true)
                               .collect(Collectors.toList()); 
```

Java 8 提供流支持，将集合转换为连续的对象流。如果集合的大小很小，**.stream()**就可以了。但是如果你有一个大集合并且想要利用并行特性，那么你可以使用**.parallelStream()**方法。

# java - 修改 Enunciate 生成的配置文件以使用最新的 CXF 杰克逊库

> ID：12234218
> 
> 赞同：5
> 
> 时间：2012-09-02T07:42:22.600
> 
> 标签：java, rest, cxf, jackson, enunciate

`Enunciate`自动生成`cxf-jaxrs-servlet.xml`文件并指定：`org.codehaus.jackson.jaxrs.JacksonJaxbJsonProvider`作为`JAX-RS`提供者。此类已更改为`com.fasterxml.jackson.jaxrs.JacksonJaxbJsonProvider`在最新`Jackson`库中。如何在自动生成的文件`Enunciate`中将新类指定为提供者？`JSON`或者我可以`Enunciate`使用用户提供的`XML`文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T23:30:43.623

我有一个类似的问题，正在使用 Maven 和 Spring。我能够通过使用[maven 替换插件](http://code.google.com/p/maven-replacer-plugin/)并将其设置为覆盖 jaxrs:providers 中的 org.codehaus.jackson.jaxrs.JacksonJaxbJsonProvider 并将其替换为 com.fasterxml.jackson.jaxrs.json.JacksonJaxbJsonProvider 来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T17:59:01.040

不幸的是，目前没有一个好的方法可以做到这一点。我们正在[ENUNCIATE-719](http://jira.codehaus.org/browse/ENUNCIATE-719)跟踪对 Jackson 2 的支持。

# java - 用泛型和集合实现 compareTo()

> ID：12234219
> 
> 赞同：3
> 
> 时间：2012-09-02T07:42:31.087
> 
> 标签：java, sorting, collections, comparable, generic-collections

我正在使用集合，但我无法弄清楚......我想基于 Node 类中的“数据”变量覆盖 compareTO() 方法......这样我就可以调用 collection.sort() 来对数组列表进行排序......

```
public class Node<E> implements Comparable<E>{

    public E data;
    public Node<E> next;

    public Node(){
        data=null;
        next=null;
    }

    public Node(E data1){
        data=data1;
    }

    public E getData(){
        return data;        
    }

    public Node<E> getNext(){
        return next;        
    }

    @Override
    public int compareTo(E o) {
        // TODO Auto-generated method stub
        return 0;
    }
} 
```

和

```
public class Test { 
    public static void main(String args[]){
        ArrayList<Node> arr= new ArrayList<Node>();
        Node n1=new Node(1);
        Node n2=new Node(3);
        Node n3=new Node(4);
        Node n4=new Node(3);
        Node n5=new Node(6);
        Node n6=new Node(2);
        arr.add(n1);
        arr.add(n2);
        arr.add(n3);
        arr.add(n4);
        arr.add(n5);
        arr.add(n6);

        Collections.sort(arr);  
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T07:48:48.447

你的声明在我看来很奇怪。`Node<Integer>`例如，将 a与 an进行比较会很奇怪-通过比较其中的整数来将 a与另一个进行比较`Integer`会更有意义。`Node<Integer>``Node<Integer>`

然后，您需要进行约束`E`，以便可以比较两个数据值。

所以我怀疑想要：

```
public class Node<E extends Comparable<E>> implements Comparable<Node<E>> {
    ...
    public int compareTo(Node<E> node) {
        return data.compareTo(node.data);
    }
} 
```

您可以以复杂性为代价使其更加灵活，如下所示：

```
public class Node<E extends Comparable<? super E>> implements Comparable<Node<E>> 
```

（代码的主体将保持不变......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T07:49:10.633

您所做的基本上是将 的比较委托`Node`给运行时类型的比较`E`，因此`E`本身也应该实现`Comparable`. 所以我认为你的意思是：

```
class Node<E extends Comparable<E>> implements Comparable<Node<E>> {

    private E data;

    @Override
    public int compareTo(Node<E> arg0) {        
        return arg0.data.compareTo(data);
    }

} 
```

另请注意，您应该将`Node`对象与`Node`对象进行比较，而不是`Node`对象与`E`对象进行比较。

**旁注**：您的班级成员应该是私人的。你甚至有吸气剂，那为什么它们是公开的呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T07:48:11.700

基本上`E`，您的集合元素也必须具有可比性，可以通过以下方式强制执行：

```
public class Node<E extends Comparable<E> implements Comparable<Node<E>> { 
```

现在`compareTo()`你只需比较你的元素：

```
@Override
public int compareTo(Node o) {
    return data.compareTo(o.data);
} 
```

如果您的`Node`类接受`null`数据元素，`compareTo()`则必须更仔细地实现。

# android - 在 Manifest 中指定 Android Market RAM

> ID：12234221
> 
> 赞同：11
> 
> 时间：2012-09-02T07:42:39.737
> 
> 标签：android, android-manifest, google-play, android-market-filtering

有些人继续在拥有 100MB RAM 的手机上下载并安装我们的高清游戏，并给我们一个差评... :)

有没有办法将应用程序下载限制为仅具有大量内存的智能手机，或者可能限制为新型号/CPU。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-02T21:07:04.600

我的最终解决方案来自 Raghav Sood 的提示。经过一番研究，我发现限制在下面的屏幕将限制为具有 512Mb+ RAM 的设备。它不是 100% 安全的，但它是我发现的最佳解决方案 :)

只需在清单文件中添加这些过滤器..

```
 <compatible-screens>
        <!-- some normal size screens -->
        <screen android:screenSize="normal" android:screenDensity="hdpi" />
        <screen android:screenSize="normal" android:screenDensity="xhdpi" />
        <!-- all large size screens -->
        <screen android:screenSize="large" android:screenDensity="ldpi" />
        <screen android:screenSize="large" android:screenDensity="mdpi" />
        <screen android:screenSize="large" android:screenDensity="hdpi" />
        <screen android:screenSize="large" android:screenDensity="xhdpi" />
        <!-- all xlarge size screens -->
        <screen android:screenSize="xlarge" android:screenDensity="ldpi" />
        <screen android:screenSize="xlarge" android:screenDensity="mdpi" />
        <screen android:screenSize="xlarge" android:screenDensity="hdpi" />
        <screen android:screenSize="xlarge" android:screenDensity="xhdpi" />
    </compatible-screens> 
```

请注意，一些新手机的密度比 xhdpi 更高，因此它们将被屏蔽！我正在试验新的过滤器：

```
<supports-screens 
    android:resizeable="true"
    android:smallScreens="false"
    android:normalScreens="true"
    android:largeScreens="true"
    android:xlargeScreens="true"
    android:anyDensity="true" /> 
```

到目前为止，一切正常。我发现我在支持列表中有低端设备，但到目前为止没有人抱怨，（对于设备相关的错误，在 85k 下载中）。

我会推荐第二种解决方案，但请谨慎使用！我一定会在即将到来的游戏中使用它。

欢迎您提供反馈！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T08:26:08.827

你说你的应用是高清的。你为什么不过滤掉那些不是的设备？任何具有高清屏幕的设备通常都应该有足够的 RAM 来运行您的应用程序。您可以使用`supports-screen`标签排除带有 ldpi 和 mdpi 屏幕的设备。虽然这可能不会锁定所有低端设备，但它会锁定很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T08:02:32.493

[阅读有关记忆的内容](https://stackoverflow.com/questions/6075276/largeheap-true-manifest-tag-not-working)

此外，您可以在开发控制台中取消选中您不想要的设备。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T08:05:06.410

据我所知，它不是 Google Play 的过滤器之一。 [http://developer.android.com/guide/google/play/filters.html](http://developer.android.com/guide/google/play/filters.html)

我想你可以：

*   过滤掉您知道不符合条件的设备。您可以从 Android 开发者控制台执行此操作（只需列出您的应用可以运行的设备，然后点击排除将它们添加到手动排除列表中）。但考虑到 Android 设备的数量，这可能很困难。

*   在应用程序内，检查分配给您的内存，如果不足以获得良好的体验，请采取行动。让用户知道（如果已付款，则退款:) ）等。仅当您确定内存是唯一的限制因素时才这样做。

# javascript - 如何在 HTML5 画布上渲染音频波形？

> ID：12234222
> 
> 赞同：23
> 
> 时间：2012-09-02T07:42:42.547
> 
> 标签：javascript, html, canvas

我想将音频文件（ogg 和/或 mp3）的波形渲染到画布元素。

我想知道是否有任何库可以使这变得简单？我正在寻找这些方面的结果：http: [//plucked.de/](http://plucked.de/)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-02T07:42:42.547

[https://github.com/katspaugh/wavesurfer.js](https://github.com/katspaugh/wavesurfer.js)可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-12-23T19:56:56.750

如果您不想下载文件内容，则必须在服务器上准备波形图像或数据。

前段时间 BBC（是的，英国媒体公司）开源了一套工具来有效地完成这项工作。所有内容都在他们的博客上进行了描述：[http ://www.bbc.co.uk/rd/blog/2013/10/audio-waveforms](http://www.bbc.co.uk/rd/blog/2013/10/audio-waveforms)

很快：在 Linux 服务器端，您必须使用[audiowaveform](https://github.com/bbcrd/audiowaveform)命令行工具将声音文件（FLAC、WAV 或 MP3）转换为基于 JSON 的波形插值。[接下来，您将 JSON 数据提供给浏览器客户端，浏览器客户端将使用波形数据.js](https://github.com/bbcrd/waveform-data.js)在画布元素上呈现波形。

# c# - CMYK 颜色值与其 int 等效值

> ID：12234226
> 
> 赞同：0
> 
> 时间：2012-09-02T07:43:17.047
> 
> 标签：c#, int, equivalent, cmyk

我有 CMYK 颜色值 ( 0, 0.58 ,1 ,0 )。现在我必须使用 C# 转换为其等效的整数。我认为可以使用按位运算符，但不确定。

请帮助我如何实现相同的目标。

谢谢，帕万

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T07:50:02.950

尝试这个：

```
float c = 0.0;
float y = 0.58;
float m = 1.0;
float k = 0.0;

uint intColor = (uint)(c * 255) << 24;
intColor += (uint)(y * 255) << 16;
intColor += (uint)(m * 255) << 8;
intColor += (uint)(k * 255) << 0; 
```

这里`intColor`将是一个 32 位无符号整数，分别包含颜色的 C、Y、M 和 K 分量的字节值。要从整数转换回分量，只需反转所有操作及其顺序：

```
float c = ((intColor & 0xFF000000) >> 24) / 255.0f;
float y = ((intColor & 0x00FF0000) >> 16) / 255.0f;
float m = ((intColor & 0x0000FF00) >> 8) / 255.0f;
float k = ((intColor & 0x000000FF) >> 0) / 255.0f; 
```

# ruby-on-rails - 如何在我的视图中显示关联的属性？

> ID：12234229
> 
> 赞同：0
> 
> 时间：2012-09-02T07:43:35.400
> 
> 标签：ruby-on-rails, activerecord, associations

我是 Rails 菜鸟，但我仍在努力思考查询关联数据的工作原理。这是我的简单架构：

```
 create_table "microposts", :force => true do |t|
    t.text     "content"
    t.integer  "user_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  create_table "users", :force => true do |t|
    t.string   "name"
    t.string   "email"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end 
```

我的协会如下：

```
class Micropost < ActiveRecord::Base
  attr_accessible :content, :user_id
  belongs_to :user
    accepts_nested_attributes_for :user
end

class User < ActiveRecord::Base
  attr_accessible :email, :name
  has_many :microposts
  accepts_nested_attributes_for :microposts
end 
```

我想要做的是查询我的微博，使其包含与用户表中用户名相对应的作者属性。这是我的html：

```
<% @microposts.each do |micropost| %>
  <tr>
    <td><%= micropost.content %></td>
    <td><%= micropost.user_id %></td>
    <td>
      **<%= micropost.author %>**
    </td>
    <td><%= link_to 'Show', micropost %></td>
    <td><%= link_to 'Edit', edit_micropost_path(micropost) %></td>
    <td><%= link_to 'Destroy', micropost, method: :delete, data: { confirm: 'Are you sure?' } %></td>
  </tr>
<% end %> 
```

如何在上面的一个单元格中获得类似 microposts.author 的属性？我尝试查询 Microposts.users.name 但它似乎返回 ruby​​ 对象数据，如下所示：

```
[#<Micropost id: 1, content: "Though good for getting a general overview of Rails...", user_id: 2, created_at: "2012-09-02 01:52:47", updated_at: "2012-09-02 01:52:47">, #<Micropost id: 2, content: "This is another", user_id: 2, created_at: "2012-09-02 01:53:09", updated_at: "2012-09-02 01:53:09">, #<Micropost id: 3, content: "A close cousin of create_table is change_table, 
```

更重要的是，数据中没有提及用户名数据。我究竟做错了什么？我怎么`micropost.author`去上班？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:48:50.103

belongs_to 关联通过在 Micropost 中存储（在您的情况下）user_id 来工作。这允许您像这样引用 Micropost 所属的用户：

```
micropost.user 
```

此时您可以访问任何用户属性，例如名称：

```
micropost.user.name 
```

**编辑**

还有两件事：

1)`accepts_nested_attributes_for`声明通常在父类中进行。它们使您能够像这样拨打电话：

```
# when creating, it infers the user_id attribute thanks to the nested attribute declaration
user.microposts.create(content: "blah blah")

# similarly, user_id is inferred here as well
user.microposts.where( ... ) 
```

在您的 Micropost 模型中包含声明意味着您打算从 micropost 创建用户（或搜索用户）。我认为在您的用例中是不必要的。

2）如果您想将用户别名为“作者”，您可以将 Micropost 中的 belongs_to 调用替换为：

```
belongs_to :author, class_name: "User", foreign_key: "user_id" 
```

这将允许您按如下方式查询作者姓名：

```
micropost.author.name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:46:12.077

```
<%= micropost.user.name %> 
```

您调用`user`以获取关联用户，然后调用`name`以获取该记录的`name`属性。

# python - 简单的python格式字符串测试

> ID：12234231
> 
> 赞同：-2
> 
> 时间：2012-09-02T07:44:31.383
> 
> 标签：python

我很难完成任务。有人给个提示吗？非常感谢

[http://www.learnpython.org/page/String%20Formatting](http://www.learnpython.org/page/String%20Formatting)

我努力了

```
data = ("John", "Doe", 53.44)
format_string = "Hello"

print '%s %s %s %s ' %format_string % data 
```

它给了我没有足够的论据来解决字符串错误......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:55:38.887

我不想给你完整的答案，因为这是一个学习练习。我只会给你一个提示。

从这里开始：

```
data = ("John", "Doe", 53.44)
format_string = "Hello"
print format_string % data 
```

您需要更改的*唯一*`format_string = "....."`行是第二行： .

您需要更改字符串的内容，使其包含三个占位符 ( `%s`)，一个用于`data`. 您不需要更改第一行或第三行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T07:52:48.713

元组中的数据不能这样访问。应该使用索引值访问它，例如`data[0]`.

```
data = ("John", "Doe", 53.44)
format_string = "Hello"
print "%s %s %s %.2f " %(format_string,data[0],data[1],data[2] 
```

这将为您提供所需的结果：

> 你好约翰·多伊 53.44

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T07:55:55.803

您可能应该使用[`format()`](http://docs.python.org/library/string.html#formatspec)，并尝试类似：

```
>>> data = ("John", "Doe", 53.44)
>>> format_string = "Hello"
>>> "{0} {1} {2} {3}".format(format_string,*data)  # *data unpacks the content of data
'Hello John Doe 53.44' 
```

或者：

```
>>> format_string + " {0} {1} {2}".format(*data)
'Hello John Doe 53.44' 
```

# iphone - 如何像 UIScrollView 一样取消触摸？

> ID：12234238
> 
> 赞同：2
> 
> 时间：2012-09-02T07:46:05.390
> 
> 标签：iphone, ios, cocoa-touch, ipad, uiscrollview

我创建了一个应用程序，您可以在其中拖动视图。我需要 UIScrollView 不适合的特殊行为。但现在的问题是其中一些视图响应触摸事件，当我拖动它们时，我必须取消触摸。

UIScrollView 能够取消其子视图中的触摸，因此当用户按下按钮然后开始滚动时，只要用户滚动足够多，滚动视图就会取消按钮中的触摸，因此按钮不会触发一种行为。

一种方法是对每个子视图进行子类化，并在所有触摸处理方法中使用布尔标志，但这会非常乏味和肮脏。

有没有更好的方法通过 API 来取消子视图中的触摸，就像 UIScrollView 一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T14:11:12.147

它通过 UIGestureRecognizer API 取消触摸。UIScrollView 实际上在下面使用了 UIPanGestureRecognizer。 [http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIGestureRecognizer_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40009279-CH1-SW9](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIGestureRecognizer_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40009279-CH1-SW9)

UIGestureRecognizer 还具有延迟触摸开始发送和触摸结束的能力。

```
@property(nonatomic) BOOL delaysTouchesBegan
@property(nonatomic) BOOL delaysTouchesEnded 
```

为了执行拖动手势，我现在使用 UIPanGestureRecognizer，比如 UIScrollView。这样做会让你拥有所有的小技巧。

# vim - 在 vimrc 中添加命令

> ID：12234244
> 
> 赞同：1
> 
> 时间：2012-09-02T07:47:02.497
> 
> 标签：vim, command

我想使用 xclip 将我在 VISUAL 模式下选择的内容复制到 X 剪贴板。如何在我的 vimrc 中创建使用所选文本的映射？

我要执行的命令如下：

```
xclip -selection c {selected text} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:31:47.947

试试这个：

```
vnoremap <F2> :w !xclip -selection c<CR><ESC> 
```

# r - 将多个ggplots打印到一个pdf中，每页多个图

> ID：12234248
> 
> 赞同：38
> 
> 时间：2012-09-02T07:48:15.857
> 
> 标签：r, ggplot2

我有一个列表，`p`其中的每个元素`p`都是 ggplot2 绘图对象的列表。

我想输出一个包含所有图的单个 pdf，其中`p`的图在`p[[1]]`第 1 页，图在`p[[2]]`第 2 页，等等。我该怎么做？

下面是一些示例代码，为您提供我正在使用的数据结构——为无聊的情节道歉，我随机选择了变量。

```
require(ggplot2)
p <- list()

cuts <- unique(diamonds$cut)
for(i in 1:length(cuts)){
    p[[i]] <- list()
    dat <- subset(diamonds, cut==cuts[i])
    p[[i]][[1]] <- ggplot(dat, aes(price,table)) + geom_point() + 
        opts(title=cuts[i])
    p[[i]][[2]] <- ggplot(dat, aes(price,depth)) + geom_point() + 
        opts(title=cuts[i])
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-02T12:09:31.687

该解决方案与列表中列表的长度是否`p`不同无关。

```
library(gridExtra)

pdf("plots.pdf", onefile = TRUE)
for (i in seq(length(p))) {
  do.call("grid.arrange", p[[i]])  
}
dev.off() 
```

由于`onefile = TRUE`该功能`pdf`将所有按顺序出现的图形保存在同一文件中（一个图形一页）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-05-16T03:14:52.773

这是 Sven 解决方案的更简单版本，适用于 R 初学者，否则他们会盲目使用他们既不需要也不理解的 do.call 和嵌套列表。我有经验证据。:)

```
library(ggplot2)
library(gridExtra)

pdf("plots.pdf", onefile = TRUE)
cuts <- unique(diamonds$cut)
for(i in 1:length(cuts)){
    dat <- subset(diamonds, cut==cuts[i])
    top.plot <- ggplot(dat, aes(price,table)) + geom_point() + 
        opts(title=cuts[i])
    bottom.plot <- ggplot(dat, aes(price,depth)) + geom_point() + 
        opts(title=cuts[i])
    grid.arrange(top.plot, bottom.plot)
}
dev.off() 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2020-04-30T20:22:57.940

`ggplot2::ggsave()`这是使用和将 ggplot 对象列表导出到单个 pdf 文件的最优雅的解决方案`gridExtra::marrangeGrob()`。

```
library(ggplot2)
library(gridExtra) 
```

假设您使用创建多个图`lapply()`

```
p <- lapply(names(mtcars), function(x) {
  ggplot(mtcars, aes_string(x)) + 
    geom_histogram()
}) 
```

保存`p`地块列表：

```
ggsave(
   filename = "plots.pdf", 
   plot = marrangeGrob(p, nrow=1, ncol=1), 
   width = 15, height = 9
) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-12-10T02:19:13.633

我已经尝试了其中一些解决方案，但没有成功。我进行了更多研究，并找到了一个非常适合我的解决方案。它将我所有的图形保存在一个 pdf 文件中，每个图表在一页上。

```
library(ggplot2)

pdf("allplots.pdf",onefile = TRUE)
for(i in glist){
   tplot <- ggplot(df, aes(x = as.factor(class), y = value))
   print(tplot)
}
dev.off() 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-09-02T08:14:14.050

这是一种解决方案，但我不是特别喜欢它：

`ggsave("test.pdf", do.call("marrangeGrob", c(unlist(p,recursive=FALSE),nrow=2,ncol=1)))`

问题在于它依赖于每组中的地块数量相同。如果`all(sapply(p, length) == 2)`是假的，那么它就会破裂。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-04-07T11:04:36.777

一个对我有用的解决方案`ggpubr`（Github 上的包，安装代码：）`devtools::install_github("kassambara/ggpubr")`。

假设您有 4 个图 p1、p2、p3 和 p4。

```
library(ggpubr)
multi.page <- ggarrange(p1,p2,p3,p4, nrow=1, ncol=1) # for one plot per page
multi.page[[1]] # for seeing the first plot
ggexport(multi.page, filename="my-plots.pdf") 
```

更多使用示例：http `ggpubr`: [//www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/81-ggplot2-easy-way-to-mix-multiple-graphs-on-the-same -页/](http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/81-ggplot2-easy-way-to-mix-multiple-graphs-on-the-same-page/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-08-14T17:53:14.210

这是一个基于 Sven 方法的函数，包括**roxygen2**文档和一个示例。

```
#' Save list of ggplot2 objects to single pdf
#'
#' @param list (list) List of ggplot2 objects.
#' @param filename (chr) What to call the pdf.
#'
#' @return Invisible NULL.
#' @export
#'
#' @examples
#' #plot histogram of each numeric variable in iris
#' list_iris = map(names(iris[-5]), ~ggplot(iris, aes_string(.)) + geom_histogram())
#' #save to a single pdf
#' GG_save_pdf(list_iris, "test.pdf")
GG_save_pdf = function(list, filename) {
  #start pdf
  pdf(filename)

  #loop
  for (p in list) {
    print(p)
  }

  #end pdf
  dev.off()

  invisible(NULL)
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-14T07:56:21.530

没有包的一个很好的解决方案`gridExtra`：

```
library(plyr)
library(ggplot2)

li = structure(p, class = c("gglist", "ggplot"))
print.gglist = function(x, ...) l_ply(x, print, ...)
ggsave(li, file = "test.pdf") 
```

# c# - 如何接受函数引用作为参数？

> ID：12234256
> 
> 赞同：4
> 
> 时间：2012-09-02T07:48:52.833
> 
> 标签：c#, .net, function, byref

我目前正在将一个`EventHandler`对象传递给一个 util 函数，如下所示：

```
Timer newTimer(int interval, System.Timers.ElapsedEventHandler handler) {
    ....
    timer.Elapsed += handler;
    ....
}

newTimer(1000, new System.Timers.ElapsedEventHandler(myTimer_Tick)); 
```

但这很丑陋，并迫使每个调用者创建一个`EventHandler`对象。我如何将其更改为这样的东西？

```
Timer newTimer(int interval, ref Function handler) {
    ....
    timer.Elapsed += new System.Timers.ElapsedEventHandler(handler);
    ....
}

newTimer(1000, ref myTimer_Tick); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T07:52:29.060

不清楚你为什么在`ref`这里使用，但如果`myTimer_Tick`有正确的签名，你根本不需要改变你的方法 - 你可以使用：

```
newTimer(1000, myTimer_Tick); 
```

这使用方法组转换而不是显式委托创建语句。虽然它做同样的事情。

如果您希望能够使用无参数的 void 方法，您可以编写一个辅助方法来获取 an并通过 lambda 表达式将其`Action`包装在 an 中：`ElapsedEventHandler`

```
Timer StartTimer(int interval, Action action)
{
    ...
    timer.Elapsed = (sender, args) => action();
    ...
} 
```

# java - 用java写mysql的一句话问题

> ID：12234258
> 
> 赞同：0
> 
> 时间：2012-09-02T07:49:04.627
> 
> 标签：java, mysql, sql

我正在用 java 开发一个程序，其中有一些 sql 语句，这个：

```
SQL="SELECT t0.id_proveedor_cloud as id_proveedor_cloud,";
SQL.concat("t1.id_procesador as id_procesador,");
SQL.concat("t2.id_tarea as id_tarea,");
SQL.concat("DATE_FORMAT(t2.f_ultima_ejecucion,'%d-%m-%Y %H:%i:%s') as f_ultima_ejecucion,");
SQL.concat("t3.id_esquema_asociado as id_esquema_asociado,");
SQL.concat("t3.descripcion as descripcion_esquema,");
SQL.concat("t3.cadena_conexion_sql as cadena_conexion_sql,");
SQL.concat("t3.url_portal_ccis as url_portal_ccis");
SQL.concat("FROM proveedores_cloud t0");
SQL.concat("INNER JOIN procesadores t1 ON t1.id_proveedor_cloud=t0.id_proveedor_cloud");
SQL.concat("INNER JOIN tareas t2 ON t2.id_procesador = t1.id_procesador");
SQL.concat("INNER JOIN esquemas_asociados t3 ON t3.id_proveedor_cloud=t0.id_proveedor_cloud");
SQL.concat("WHERE t0.id_proveedor_cloud =1");
SQL.concat("AND t1.activo = true");
SQL.concat("AND t2.activa = true");
SQL.concat("AND (TIMESTAMPDIFF(MINUTE,t2.f_ultima_ejecucion,CURRENT_TIMESTAMP) >= t2.iniciar_cada)");
SQL.concat("ORDER BY t0.id_proveedor_cloud,t2.orden"); 
```

当我尝试用我的 Java 程序执行它时，我附近有一个错误，`INNER JOIN procesadores t1 ON t1.id_proveedor_cloud=t0.id_proveedor_cloud`但是当我在我的 Navicat 上执行这个查询时，我没有任何错误，错误在哪里，问题在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:18:13.777

您在查询中缺少空格。

例如这里

```
SQL.concat("FROM proveedores_cloud t0");
SQL.concat("INNER JOIN procesadores t1 ON t1.id_proveedor_cloud=t0.id_proveedor_cloud"); 
```

这将产生这个字符串：

`FROM proveedores_cloud t0INNER JOIN procesadores t1 ON t1.id_proveedor_cloud=t0.id_proveedor_cloud`

这是无效`SQL`的，不能被查询解析​​器解析。

请参阅 javadoc 示例`String#concat`：

```
 "cares".concat("s") returns "caress" 
```

[http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#concat(java.lang.String](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#concat(java.lang.String) )

您可以通过在 concats 末尾添加一个空格来简单地修复它，例如在您的`FROM`子句之后：

```
SQL.concat("t3.url_portal_ccis as url_portal_ccis ");
SQL.concat("FROM proveedores_cloud t0 ");
SQL.concat("INNER JOIN procesadores t1 ON t1.id_proveedor_cloud=t0.id_proveedor_cloud ");
SQL.concat("INNER JOIN tareas t2 ON t2.id_procesador = t1.id_procesador "); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:26:01.847

您在 Java 中创建的字符串中缺少空格。在 Navicat 中，每行之间都有换行符，但在 Java 中构建的字符串中缺少空格。

你的字符串的某些部分是

```
...FROM proveedores_cloud t0INNER JOIN procesadores... 
```

在末尾添加空格处理它

```
...
SQL.concat("FROM proveedores_cloud t0 ");
... 
```

您基本上需要对所有不以逗号结尾的行执行此操作

# c++ - 制作没有依赖关系的DLL文件

> ID：12234260
> 
> 赞同：0
> 
> 时间：2012-09-02T07:49:27.963
> 
> 标签：c++, visual-studio, dll

过去，我在我的应用程序中使用过其他开发人员制作的 dll。现在，我的愿望是学习制作 dll 文件。因此，我开始在 Visual Studio 2008 中开发 dll 文件作为 c++ 项目。

按照教程完成后，我成功创建了 dll 项目。而且，当我创建另一个 c++ 控制台应用程序来测试上述 dll 时，我发现我需要包含之前 dll 项目的 lib 文件和头文件。我想包括自制标题取决于我如何实现我的项目。但是，在客户端应用程序中包含 lib 文件怎么样？

这不是额外的依赖吗？如果我的问题不清楚，那么我将再次简要解释一下：我已经创建了一个 dll 文件作为 VS2008 c++ 项目。当我尝试从另一个 c++ 项目访问 dll 时，我需要包含上一个项目的 lib 文件。所以，我想知道如何避免包含任何内容或任何依赖项，并且仍然在我的客户端应用程序中使用 dll ......

如果我的话没有意义，那么对不起......我是dll相关内容的新手......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:14:33.137

LIB 文件是一个导入库，其中包含用于在运行时加载 DLL 的代码；Visual Studio 创建它是为了您的方便，因此您无需在客户端应用程序中编写一堆样板导入代码。

Lib 文件是静态链接的，因此就您的客户端应用程序而言，没有额外的依赖关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:07:13.120

您有两个问题（假设您的库是 LibA，另一个库是 LibB）：

1.  头文件依赖：LibA 头文件似乎有 #include 指令来读取 LibB 的头文件。在这种情况下，当您将 LIbA 加载到另一个项目中时，如果不包含 LibB 标头路径，则无法解析这些 #include。为避免这种情况，您必须以 LibB 标头仅出现在 .cpp 文件中而不出现在 .h 文件中的方式创建 LibA。一种选择是为此使用“转发声明”（在互联网上检查，您会学到很多东西，在这里重复基础知识是没有用的）。

2.  库依赖关系：如果您的 .dll 依赖于另一个 .dll，则只能使用这两个库，因为没有 LibB，LibA 就无法工作。一种解决方案是将 LibB 作为静态库，然后将其静态链接到 LibA 中，因此它包含在 LibA.dll 中，您只需要这个（您始终需要它们，但 LibB 二进制文件现在位于 LibA 文件中）。

# c - 在 C 中运行时输入一个特殊的字符串

> ID：12234267
> 
> 赞同：1
> 
> 时间：2012-09-02T07:50:22.780
> 
> 标签：c, string, input

在我的 C 代码中，我得到以下字符串作为输入：

```
"c:\tc\bin\a c j k.jpg" 
```

我尝试使用 scanf 读取输入，但失败了（通过带引号和不带引号的输入），我正在寻找其他解决方案。

我的代码如下：

```
char keytext[16],zzz,source[100],dest[100];
short int a;
size_t readcount;

clrscr();
printf("input the key text(max 16 characters):");
scanf("%s",&keytext);

printf("input file name:");
scanf("%s",&source);

/*fgets(source,100,stdin);
namelen=strlen(source);
if(source[namelen-1]=='\n')
source[namelen-1]='\0';*/

printf("output file name:");
scanf("%s",&dest); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:00:18.320

当遇到第一个空白字符时，格式说明符`%s`将停止使用输入，因此它只会读取到`C:\tc\bin\a`. 要阅读`k.jpg`您可以使用扫描集：

```
char input[128];
if (1 == scanf("%127[^\n]", input))
{
} 
```

格式说明符`"%127[^\n]"`意味着读取到下一个换行符但不超过 127 个字符以防止缓冲区溢出。您应该在使用其输出之前检查 的返回值`scanf()`，它返回所做的分配数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:00:05.870

`scanf`带有`%s`说明符的函数需要指向 char的指针`char *`。但是您将指针传递给指向 char 的指针 `char **`。为了修复它，请改用以下代码：

```
scanf("%s", keytext);
scanf("%s", source);
scanf("%s", dest); 
```

注意，它不需要`&`符号。如果要读取带有空格的整个字符串，可以使用`fgets`函数。

```
fgets(keytext, sizeof(keytext), stdin);
fgets(source,  sizeof(source),  stdin);
fgets(dest,    sizeof(dest),    stdin); 
```

# python - django modelfrom中一对一关系的验证错误

> ID：12234268
> 
> 赞同：0
> 
> 时间：2012-09-02T07:50:49.637
> 
> 标签：python, django, django-models, django-forms, django-views

我有 2 个使用一对一关系相互关联的模型。如果一个模型的对象已经与另一个模型相关，我如何显示验证错误。

假设我有 2 个模型

```
 Class Place(models.Model):
        field1 = CharField()
        field2 = CharField()

   Class Restaurant(models.Model):
       related_field = OneToOneField(Place)
       field3 = CharField() 
```

就我而言**，一个地方一个餐厅**。**如果用户为同一个地方提交新餐厅，那么验证应该引发**

如果 Restaurant 对象已经附加到 Place 对象，那么对于同一个 Place 对象的第二家 Restaurant，我想显示验证

在管理员中，我们通常会看到这条消息“**这个地方的餐厅已经存在。** ”但是我如何使用带有通用视图的模型表单来实现同样的效果

```
 class RestaurantCreateView(CreateView):
       form_class = RestaurantForm
       template_name = 'restaurant_create.html'

       def get_success_url(self):
           return reverse_lazy('restuarants', args=[self.object.id])

       def get_place(self, **kwargs):
           id = self.kwargs['pk']
           place = Place.objects.get(id=id)
           return place 

       def get_context_data(self, **kwargs):
           context = super(RestaurantCreateView, self).get_context_data(**kwargs)
           place = self.get_place()
           context['place'] = place
           return context

       def form_valid(self, form):
          self.object = form.save(commit=False)
          place = self.get_place()
          self.object.place = place
          self.object.save()
          return HttpResponseRedirect(self.get_success_url()) 
```

如何在基于类的通用视图中执行一对一关系验证？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:01:27.507

然后你需要将`Place`对象传递到你的`Restaurant`表单中。表单验证无法访问视图中定义的这些内容，除非您明确将数据传递给它。

```
class MyForm(forms.ModelForm):
    class Meta:
         model = Restaurant

    def __init__(self, *args, **kwargs):
        self.place = kwargs.pop('place', None)
        super(MyForm, self).__init__(*args, **kwargs

    def clean_related_field(self):
        place = self.place
        try:
            place.restaurant
        except Restaurant.DoesNotExist:
            return place
        raise forms.ValidationError("Restaurant already exists for that book")

class MyView(...):
    form_class = MyForm

    def get_form_kwargs(self):
        kwargs = super(MyView, self).get_form_kwargs()
        kwargs['place'] = Place.objects.get(id=self.kwargs['pk'])
        return kwargs

{% if form.related_field.errors %}.........{% endif %} 
```

另一种方法是在 form_valid() 中伪造验证并设置错误字典，然后返回响应。这种方法可能更可取，因为它包含更多内容。此外，特别是如果您不使用表单字段，您不妨在上下文中添加一个错误标志。

```
class MyView():
    def form_valid(self, form):
        if Restaurant.objects.filter(related_field=self.get_place()):
            ctx = self.get_context_data(form=form)
            ctx['massive_error'] = True
            return self.render_to_response(ctx) 
```

# java - 在java中设计一个灵活的Key类

> ID：12234269
> 
> 赞同：0
> 
> 时间：2012-09-02T07:50:51.997
> 
> 标签：java, design-patterns, gwt

我正在尝试在 java 中设计一个通用的 Key 类来表示主 pojo 键。

这些值可以是各种类型，例如 BigInteger、String、Uuid。我正在寻找实现这样一个类的最佳选择。我当前的实现看起来像这样。

任何人都可以帮助我进行更准确的实施或确定当前实施的问题吗？我还没有实现 equals 方法。欢迎任何指点。

此类需要与 GWT 兼容。

```
@SuppressWarnings("serial")
@GwtCompatible
public class Key<T extends Serializable> implements Serializable {

public enum KeyType {
    BigInt, Uuid, String ;

}

private final T keyValue  ;
private final KeyType keyType  ;

Key() {
    keyValue = null;
    keyType = null;
}

public Key(T value){
    this.keyValue =  value ;
    this.keyType = determineKeyType(value);
}

/**
 * @return
 */
private KeyType determineKeyType(Object value) {

    if ( isValueUuid(value))
        return KeyType.Uuid ;

    else if (value instanceof BigInteger)
        return KeyType.BigInt ;

    else 
        return KeyType.String; 
}

/**
 * @param value
 * @return
 */
private boolean isValueUuid(Object value) {
    // TODO Auto-generated method stub
    return false;
}

public Key(T val, KeyType tp){
    this.keyValue = val ;
    this.keyType = tp;
}

public KeyType getKeyType(){
    return keyType ;
}

@Override
public boolean equals(Object obj) {
    return super.equals(obj);
}

public T getKeyValue(){
    return this.keyValue ;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:28:52.767

在我看来，您将从这里的[工厂模式](http://www.oodesign.com/factory-pattern.html)中受益。

您将拥有一个 interface `Key`、 an`AbstractKey`以及任意数量的实现`AbstractKey`（在您的示例中，它应该是 3 个）。KeyFactory 将负责创建密钥。

实际上，它会给出：

```
public interface Key<T> extends Serializable {
    T getKeyValue();
}

public abstract class AbstractKey<T> implements Key<T> {

    @Override
    public boolean equals(Object obj) {
        if (obj == null) {
            return false;
        }
        if (obj instanceof AbstractKey) {
            return getKeyValue().equals(((AbstractKey) obj).getKeyValue());
        }
        return false;
    }
}

public class StringKey extends AbstractKey<String> {

    private String keyValue;

    StringKey() {
        super();
    }

    protected StringKey(String val) {
        super(val);
        this.keyValue = val;
    }

    @Override
    public String getKeyValue() {
        return keyValue;
    }
}

public class BigIntKey extends AbstractKey<BigInteger> {

    private BigInteger keyValue;

    BigIntKey() {
        super();
    }

    protected BigIntKey(BigInteger val) {
        super(val);
        this.keyValue = val;
    }

    @Override
    public BigInteger getKeyValue() {
        return keyValue;
    }
}

...

public class KeyFactory {
    public static Key<String> getKey(String obj) {
        return new StringKey(obj);
    }

    public static Key<BigInteger> getKey(BigInteger obj) {
        return new BigIntKey(obj);
    }
} 
```

此解决方案的一个优点是，即使它比您已有的更详细，您也可以将`Key`s 的类型限制为您实际需要的类型。此外，对于可见性有限的构造函数（刚好足以使 GWT 正确编译），您可以强制代码使用`KeyFactory`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T13:19:52.827

不确定其余的，但你的`equals`代表`equals`是`Object`基于身份的。这是你想要的吗？似乎不是因为您想检查可能是各种类型的键。
此外，如果您覆盖`equals`，那么您**必须**覆盖`hashCode`

# qt - Qt - 启用 Qml 调试。仅在安全的环境中使用

> ID：12234271
> 
> 赞同：11
> 
> 时间：2012-09-02T07:51:32.507
> 
> 标签：qt, qml

我正在尝试运行一个非常简单的程序，该程序仅在单击“退出”按钮时关闭窗口，但如果包含该按钮的应用程序窗口*未*显示，则会获得以下输出：

```
Starting C:\Users\Ola\Desktop\signal_slot1-build-desktop-Qt_4_8_1_for_Desktop_-_MSVC2008__Qt_SDK__Debug\debug\signal_slot1.exe...
Qml debugging is enabled. Only use this in a safe environment! 
```

在这种情况下我该怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-02T08:55:57.303

您已启用 QML 调试（实际上默认情况下它是打开的），这会为运行 QML 的 Javascript 解释器打开一个端口，以便您可以从中获取调试输出。显然这会造成一个安全漏洞，所以当不在安全的地方使用时应该关闭它（当你发布编译时它会自动关闭）。此警告旨在提醒您这一点。

如果您不使用 QML，请将其关闭。您可以在构建设置所在的项目选项页面中将其关闭（这是该`qmake`区域中的复选框）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-21T08:16:14.767

假设您使用 Qt Creator：

如果您选择 Release-Build 类型，QML 调试将被禁用。为此，请选择左下角“运行”按钮上方的构建类型，然后选择“发布”。

* * *

手动，有一个选项传递给 qmake（在 .pro 文件中或通过命令行参数），名为

```
CONFIG+=qml_debug 
```

启用 qml 调试。如果你忽略它，它应该被禁用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-04T12:50:58.757

如果您愿意，您可以将其更改为发布模式，这将解决问题，但我建议您在 MSVC 和 MinGW 之间进行更改并检查哪个可以工作。Project->Build and Run-> 并选择你需要的。

# macos - 如何从应用程序资源中获取 IconRef

> ID：12234272
> 
> 赞同：1
> 
> 时间：2012-09-02T07:51:36.300
> 
> 标签：macos, finder

我想使用 LSSharedFileList API 将自定义位置添加到 Finder 收藏夹边栏，如此处[所述](https://stackoverflow.com/questions/3517874/programmatically-add-a-folder-to-places-in-finder)。但我需要为这个项目添加一个自定义图标。图标应该在`IconRef`类型中。我还没有找到办法。发现只[提到](https://stackoverflow.com/questions/1062856/how-do-you-programmatically-put-folder-icons-on-the-finder-sidebar-given-that-y)了需要使用Icon Services的事实。但是怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T14:08:00.127

您可以使用[Scplugin](http://scplugin.tigris.org/)的此功能。

```
static IconRef IconRefFromIconFileNoCache(CFStringRef file)
{
    IconRef iconRef;
    IconFamilyHandle iconFamily;
    FSRef fileRef;
    CFURLRef url;
    Boolean ok;

    url = CFURLCreateWithFileSystemPath(NULL,file,kCFURLPOSIXPathStyle,false);
    if (!url)
        return 0;

    ok = CFURLGetFSRef(url,&fileRef);
    CFRelease(url);
    if (!ok)
        return 0;

    if (ReadIconFromFSRef(&fileRef, &iconFamily))
        return nil;

    iconRef = 0;
    HLock((Handle)iconFamily);
    GetIconRefFromIconFamilyPtr(*iconFamily,(**iconFamily).resourceSize,&iconRef);
    DisposeHandle((Handle)iconFamily);

    return iconRef;
} 
```

# javascript - Javascript通知插件

> ID：12234274
> 
> 赞同：0
> 
> 时间：2012-09-02T07:51:45.050
> 
> 标签：javascript, jquery, html, notifications

我正在为服务器端使用 HTML/Javascript 和 Java 开发一个 web 2.0 应用程序。

我的应用程序为每个用户管理大量通知，我会在用户单击（如 facebook）后添加一个带有未读号码的简单弹出窗口，显示最新的 10 条通知（我刚刚在服务器端实现了逻辑）。

有没有我可以使用的图形插件（例如通过 jQuery）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-23T06:04:00.280

我是 Notify.js - [http://notifyjs.com](http://notifyjs.com)的作者。目前它依赖于 jQuery，但我确实计划在未来移除依赖。在此处发布您对此有任何疑问[https://github.com/jpillara/notifyjs/issues](https://github.com/jpillora/notifyjs/issues)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-03T09:12:31.890

这是我写的一个，它没有依赖关系并且非常轻量级：[http ://shaundon.github.io/simple-notifications/](http://shaundon.github.io/simple-notifications/)

# jquery - JQuery 和单位

> ID：12234277
> 
> 赞同：0
> 
> 时间：2012-09-02T07:52:17.170
> 
> 标签：jquery

我正在玩一个动画菜单，并使用 CSS 完成了所有操作以保持布局流畅，也就是说，我拥有 em 单位的所有内容，并且缩放文本大小将相应地缩放我的菜单。

然而，用 jQuery 动画这个菜单，自然单位是 px，所以动画在正常字体大小下工作，但它的布局在其他大小时会中断......

有没有办法在 jQuery 中使用其他单位（特别是 em）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:02:10.330

您可以通过键入在 jquery 计算或数字的末尾添加单位

```
+ 'em' 
```

在进行流体布局时，使用像素要容易得多，尤其是当您涉及 jquery 时，因为正如您所提到的，它使用像素单位而不是其他任何东西。

使用 jquery、css 和 html 构建真正流畅的布局将需要一些 CSS 技巧，例如使用绝对定位和内部填充来保持位置，而无需使用 jquery 计算。

# java - ant + Junit 给出 null pinter 异常

> ID：12234278
> 
> 赞同：0
> 
> 时间：2012-09-02T07:52:21.087
> 
> 标签：java, ant, junit

我正在使用 junit4.10.jar 并收到这些错误，尽管测试用例执行得很好。

> org.apache.tools.ant.Task.perform(Task.java:364) 的 org.apache.tools.ant.Project.fireTaskFinished(Project.java:2200) 的 java.lang.NullPointerException。 ant.Target.execute(Target.java:390) at org.apache.tools.ant.Target.performTasks(Target.java:411) at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)在 org.apache.tools.ant.Project.executeTarget(Project.java:1368) 在 org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExe cutor.java:41) 在 org.apache.tools.ant。 Project.executeTargets(Project.java:1251) at org.apache.tools.ant.Main.runBuild(Main.java:809) at org.apache.tools.ant.Main.startAnt(Main.java:217) at org .apache.tools.ant.launch.Launcher.run(Launcher.java:280) 在 org。apache.tools.ant.launch.Launcher.main(Launcher.java:109)

不知道从哪里可以调试这些。请帮忙。

这是我的蚂蚁电话

```
 <target name="test" depends="compile" >
        <junit >
            <classpath refid="test.classpath" />
            <formatter type="brief" usefile="false" />
            <test name="com.test.TestCase" />
        </junit>
    </target>
    <path id="test.classpath">
        <pathelement location="${classes}" />
        <fileset dir="${lib.dir}">
            <include name="**/*.jar" />
        </fileset>
    </path> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:10:57.497

我得到了解决方案，我正在从控制台读取输出并设置

System.setOut(null);

因此，ant 源代码中的 System.out.println() 抛出空指针。

# c# - 在函数之间通过引用传输字符串是否更快？

> ID：12234283
> 
> 赞同：4
> 
> 时间：2012-09-02T07:52:54.647
> 
> 标签：c#, .net, string, performance, byref

在 C# 中通过引用传输小字符串或大字符串更好吗？我假设按值传输会强制运行时创建输入字符串的克隆，因此速度会变慢。因此，是否建议所有字符串函数通过引用传递值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-02T07:54:59.203

> 我假设按值传输会强制运行时创建输入字符串的克隆，因此速度会变慢。

你的假设是不正确的。[String](http://msdn.microsoft.com/en-us/library/system.string.aspx)是一种引用类型 - 使用字符串参数调用方法只是按值复制该引用。不涉及克隆。它是一个固定大小 - 4 或 8 个字节，具体取决于您使用的 CLR。

（即使它是一个值类型，它也必须基本上包含对其他东西的引用——直接在堆栈上分配一个可变大小的值类型是没有意义的。将为变量分配多少空间? 如果将变量的值更改为更短或更长的字符串会发生什么？）

# php - 如何从下拉菜单中获取内容到文本字段？

> ID：12234285
> 
> 赞同：0
> 
> 时间：2012-09-02T07:53:30.400
> 
> 标签：php, javascript

我是这个 PHP 和 Javascript 的新手。我有一个下拉菜单，如下所示。想要获取文本字段的内容或值并在页面刷新后保留该值？将如何做到这一点？

```
<select name="animal" style="width: 350px;">
  <option value="">Please Select</option>
  <option value="Dog">Dog</option>
  <option value="Cat">Cat</option>
  <option value="Cow">Cow</option>
  <option  value="Rat">Rat</option>
</select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:07:21.103

您可以将其保存在 url 中，然后使用新 url 刷新页面，然后将 url 中的值作为下拉列表中的选定值。

前任。

```
window.location.href = window.location.href + '/' + $('select').val();
$('input').text() = window.location.href.split('/').last(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:03:59.677

尝试这个：

```
<?php
$options = array("Dog", "Cat", "Cow", "Rat");
?>

<select name="animal" style="width: 350px;">
  <option value="">Please Select</option>
<?php
  foreach($options as $option) {
    $selected = $POST['animal'] == $option ? 'selected' : ''; 
    echo '<option $selected value="$option">$option</option>';
  }
?>
</select> 
```

# asp.net-mvc - 在iis中按开始时转到默认网址

> ID：12234290
> 
> 赞同：0
> 
> 时间：2012-09-02T07:54:57.983
> 
> 标签：asp.net-mvc, iis

我正在使用 MVC-4。在我复制文件并将它们粘贴到服务器后，在 IIS 中我右击“站点”，然后选择“重新启动”以再次启动项目。但是只有当我在浏览器中明确写入 url 时，该项目才会运行......

或者换句话说，我有一个日志文档，每个函数都会向它写入函数的名称。（当前功能），在`Global.asax.cs`我有这个：

> 路线.MapRoute(
> 
> ```
>  "Default",
>             "{controller}/{action}/{id}",
>             new { controller = "boxes", action = "FillList", id = UrlParameter.Optional} 
>         ); 
> ```

当我编写基本 url 时，我在日志文件中看到了这个函数名，但是当我按下“重新启动”时没有，那么它就没有到达这个函数。选择“重新启动”后是否有运行它的选项？

（我需要它，因为另一个项目使用它从这里传递列表）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:03:14.983

只需在 IIS 中为您的站点设置默认文档。

# java - 类本身的静态方法？

> ID：12234292
> 
> 赞同：0
> 
> 时间：2012-09-02T07:55:02.600
> 
> 标签：java, static-methods, static-members

我有一个旧测试中的问题，我需要知道练习的答案。

我们有以下课程：

```
public class First{
    private int num1 = 0;
    private int num2 = 0;
    private static int count = 0;
    public First(int num){
        this(num,num);
        count++;
        System.out.println("First constructor1");
    }
    public First(int num1, int num2){
        this.num1 = num1;
        this.num2 = num2;
        count++;
        System.out.println("First constructor2");
    }
    public int sum(){
        return num1 + num2;
    }
    public static int getCount(){
        return count;
    }
} 
```

现在我们正在操作以下订单：

```
1\. First f1 = new First(10);
2\. First f2 = new First(4,7);
3\. System.out.println("sum1 = " + f1.sum());
4\. System.out.println("count = " + First.getCount());
5\. System.out.println("sum2 = " + f2.sum());
6\. System.out.println("count = " + First.getCount()); 
```

我需要写下这 6 行之后将在屏幕上打印的行。我知道在前 3 行之后应该是这样的：

```
First constructor2
First constructor1
First constructor2
sum1 = 20 
```

唯一困扰我的是，像第 4 行这样的行是什么意思？它是对类本身而不是对对象进行操作的方法吗？

另一个问题是，在 B 部分中，我们需要在“First”类（扩展 Object 的相同方法）中重新定义方法 equals，以便她能够在该方法操作的对象和另一个“First”类型之间进行比较目的。如果 num1 和 num2 都相等，则该方法返回 true。

我想过这样的事情：

```
public class First {
...
...
.
.
.

    public boolean equals (First anotherObj){
        if ((First.num1 == anotherObj.num1) && (First.num2 == anotherObj.num2))
            return true;
        return false;
    } // equals
} // 'First' class 
```

我对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:11:48.943

是的，getCount() 是 First 类的静态方法，可以在不实例化任何具体对象的情况下调用它。因此，在您的示例中，通过使用此方法，您可以读取静态变量计数，每当调用构造函数时，计数都会增加 1。因此，如果您创建了 f1 和 f2，count 将为 2。“count”是您的所有 First 实例共享的变量。

您的 equals() 方法不起作用，因为首先您需要覆盖

```
public boolean equals(Object obj) 
```

其次， num1 和 num2 是私有的，因此您需要一个 Getter 才能使它们可用。就像是：

```
public boolean equals(Object obj) {
  return num1 == (First)obj.getNum1() && num2 == (First)obj.getNum2();
} 
```

如果你覆盖 equals 你也应该覆盖 public int hashCode()

hashCode() 的示例：

```
public int hashCode() {
  int result = 5;
  result = 31 * result + num1;
  result = 31 * result + num2;
  return result; 
```

}

（5 和 31 是素数，您也可以使用例如 Eclipse 来自动生成此方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:02:01.367

对于第二个问题，是的，你是对的。count 正在计算您对构造函数的调用。每次调用它都会增加。是的，它不是调用对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T08:18:12.377

第 4 行意味着您只是在调用类的静态方法。静态字段或方法不需要访问类的实例，而是可以直接使用类名访问。注意，你的 int count 也是静态字段，静态方法只能访问静态字段和方法。此外，随着每个对象的启动，变量计数会增加，因为它是一个静态字段。静态字段是共享字段。

# vim - vim powerline + tmux 未扩展以填充整个状态行

> ID：12234304
> 
> 赞同：4
> 
> 时间：2012-09-02T07:57:12.177
> 
> 标签：vim, macvim, tmux, vim-powerline

我已经设置了 vim 和 tmux。我试图让 vim-powerline 看起来像第一张照片。如果我有一个 vim 实例，我可以实现这一点，然后使用 :vsplit 来实现以下效果。

![Vim 分裂与 vim-powerline 工作正常](../Images/a0aa788820eba4b43d54851469ddb907.png)

另一方面，如果我使用 tmux 使用垂直拆分，vim-powerline 最终看起来如下所示：

![Tmux 分裂与 vim-powerline 看起来很奇怪](../Images/ebe81c5b2e21ec4150097e9ce7997479.png)

我试图删除段，但 vim-powerline 仍然过早截断并延伸到下一行。

我在 iTerm2 上使用 Mac OSX Lion。vim 来自 brew。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T09:00:18.263

我尝试重新安装 tmux/vim powerline 并检查 $COLUMNS 和 :set 列，但它们看起来不起作用。尝试

```
export LANG=en_US.UTF-8 
```

对我来说，它就像一种魅力。

# javascript - 撤消 jQuery 函数

> ID：12234305
> 
> 赞同：1
> 
> 时间：2012-09-02T07:57:14.707
> 
> 标签：javascript, jquery, html, css, animation

我正在尝试为菜单设置动画并让内容向右滑动`mouseover`。有没有一种简单的方法可以撤销什么`mouseover`时候所做的一切`mouseout`？

我让（我的垂直菜单的）所有菜单项向右滑动，并用一个空的新闻 div 幻灯片代替这些菜单项，然后在内容到位后填充内容......即`animate()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:04:25.100

我认为您正在寻找类似`.stop`功能的东西：http: [//api.jquery.com/stop/](http://api.jquery.com/stop/)

也许你想做这样的事情：

```
$(el).hover(function () {
  $(this).stop().animate(...);
}, function () {
  $(this).stop().animate(...);
}); 
```

***示例：http:*** [//jsfiddle.net/VjKLe/](http://jsfiddle.net/VjKLe/)

# java - 如何使用 onFling() 制作 android 鳍状肢动画？

> ID：12234311
> 
> 赞同：1
> 
> 时间：2012-09-02T07:59:02.423
> 
> 标签：java, android, swipe, viewflipper, onfling

我在`onfling`方法中添加一点动画时遇到了麻烦。一切正常。从左到右和从右到左翻页已经完成，但没有动画。我尝试了各种方法，但无法使动画正常工作。请指导我如何添加鳍状肢动画或滑动动画。这是代码：

```
public class MainActivity extends CustomTitlebarActivityBase {

        // some random variables..

    // detect swipe left/right
    private GestureDetector gestureDetector;
    private MyGestureListener gestureListener;

public void onCreate(Bundle savedInstanceState) {
        Log.i(TAG, "Creating MainActivity");

        super.onCreate(savedInstanceState, true);

        setContentView(R.layout.main_view);

        // create related objects
        gestureListener = new MyGestureListener(MainActivity.this);
        gestureDetector = new GestureDetector( gestureListener );

        documentViewManager = new DocumentViewManager(this);
        documentViewManager.buildView();

        myContentManager = new myContentManager(documentViewManager);

        // force the screen to be populated
        myContentManager.updateText(true);

    }
// there are some other methods

   /** user swiped left */

    public void next() {
        if (getDocumentViewManager().getDocumentView().isPageNextOkay()) {
            CurrentPageManager.getInstance().getCurrentPage().next();
        }       
    }
    /** user swiped left */

    public void previous() {
        if (getDocumentViewManager().getDocumentView().isPagePreviousOkay()) {
            CurrentPageManager.getInstance().getCurrentPage().previous();
        }
    }
}

// here is the listener class

public class MyGestureListener extends SimpleOnGestureListener {

    // measurements in dips for density independence
    private static final int DISTANCE_DIP = 40;
    private int scaledDistance;

    private int minScaledVelocity;
    private MainActivity mainActivity;

    private boolean sensePageDownTap;

    private static final String TAG = "MyGestureListener";

    public MyGestureListener(MainActivity mainActivity) {
        super();
        this.mainActivity = mainActivity;
        scaledDistance = CommonUtils.convertDipsToPx(DISTANCE_DIP);
        minScaledVelocity = ViewConfiguration.get(mainActivity).getScaledMinimumFlingVelocity();
        // make it easier to swipe
        minScaledVelocity = (int)(minScaledVelocity*0.66);
    }

    @Override
    public void onLongPress(MotionEvent e) {
         // do something
    }
         // here is the onFling 
    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
        // get distance between points of the fling
        double vertical = Math.abs( e1.getY() - e2.getY() );
        double horizontal = Math.abs( e1.getX() - e2.getX() );

        Log.d(TAG, "onFling vertical:"+vertical+" horizontal:"+horizontal+" VelocityX"+velocityX);

        if ( vertical > scaledDistance ) {
             return false;
        }
        // test horizontal distance and velocity

        else if ( horizontal > scaledDistance && Math.abs(velocityX) > minScaledVelocity ) {
            if (e1.getX() > e2.getX()) {
                mainActivity.next();
            }
            // left to right swipe
            else {
                mainActivity.previous();
            }
            return true;
        }
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:46:44.320

尝试实现 OnGestureListener。示例代码是 beloe

```
public class MyActivity extends Activity implements GestureDetector.OnGestureListener {

private GestureDetector gestureScanner;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.yourlayout);

    this.gestureScanner = new GestureDetector(this);

}

@Override
public boolean dispatchTouchEvent(MotionEvent paramMotionEvent) {
    super.dispatchTouchEvent(paramMotionEvent);
    return this.gestureScanner.onTouchEvent(paramMotionEvent);
}

public boolean onDown(MotionEvent paramMotionEvent) {
    return false;
}

public boolean onFling(MotionEvent paramMotionEvent1, MotionEvent paramMotionEvent2, float paramFloat1,
        float paramFloat2) {

// your fling code goes here

    return true;
}

public void onLongPress(MotionEvent paramMotionEvent) {
}

public boolean onScroll(MotionEvent paramMotionEvent1, MotionEvent paramMotionEvent2, float paramFloat1,
        float paramFloat2) {
    return false;
}

public void onShowPress(MotionEvent paramMotionEvent) {
}

public boolean onSingleTapUp(MotionEvent paramMotionEvent) {
    return false;
}

} 
```

# ios - 如何在 mapKit 中获取路线长度

> ID：12234312
> 
> 赞同：0
> 
> 时间：2012-09-02T07:59:03.230
> 
> 标签：ios, mapkit, core-location

我正在使用 mapKit 从点到点绘制路线。我做的。但我想获得路线长度而不是直线距离。

```
nextView.startPoint = [NSString stringWithFormat:@"%f,%f", userLatitude , userLongitude];
nextView.endPoint = [NSString stringWithFormat:@"%f,%f", 30.793636, 31.009641];
[diretions loadWithStartPoint:startPoint endPoint:endPoint options:options]; 
```

另外，我想给它一个中间点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:24:43.483

为此，您将不得不使用路线 API，最好是[Google Directions API](https://developers.google.com/maps/documentation/directions/)。您应该查看该链接并通读它，Apple 没有内置的方向 API。您可以向它发送请求并要求 JSON 响应，我会使用[AFNetworking 来简化（在 Github 上）](https://github.com/AFNetworking/AFNetworking)和[JSONKit 也在 Github](https://github.com/johnezang/JSONKit)上。然后发送请求并解析 JSON 响应。在响应中，您需要编码点，这是一组基本上跟踪路线的许多坐标。然后，您需要在叠加层上显示它。这是一些示例代码，但在复制并粘贴之前，请确保您阅读了 GDirections API 站点，您会更容易理解所有内容，并且可以学习如何做更多事情：

```
// DRAG IN AFNETWORKING FILES AND JSON KIT FILES TO YOUR PROJECT AND ALSO IMPORT THE MAP KIT AND CORE LOCATION FRAMEWORKS

// IMPORT FILES

#import "StringHelper.h"
#import "JSONKit.h"
#import "AFJSONRequestOperation.h"
#import "AFHTTPClient.h"
#import <MapKit/MapKit.h>
#import <CoreLocation/CoreLocation.h>

// DECLARE MUTABLE ARRAY IN .H:

NSMutableArray *_path;

// ADD THIS CODE TO WHEN YOU WANT TO REQUEST FOR DIRECTIONS

    AFHTTPClient *_httpClient = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://maps.googleapis.com/"]];

    [_httpClient registerHTTPOperationClass: [AFJSONRequestOperation class]];

    [_httpClient setDefaultHeader:@"Accept" value:@"application/json"];

    NSMutableDictionary *parameters = [[NSMutableDictionary alloc] init];

    [parameters setObject:[NSString stringWithFormat:@"%f,%f", location.coordinate.latitude, location.coordinate.longitude] forKey:@"origin"];

    [parameters setObject:[NSString stringWithFormat:@"%f,%f", location2.coordinate.latitude, location2.coordinate.longitude] forKey:@"destination"];

    [parameters setObject:@"false" forKey:@"sensor"];

    [parameters setObject:@"driving" forKey:@"mode"];

    [parameters setObject:@"metric" forKey: @"units"];

    NSMutableURLRequest *request = [_httpClient requestWithMethod:@"GET" path: @"maps/api/directions/json" parameters:parameters];

    request.cachePolicy = NSURLRequestReloadIgnoringLocalCacheData;

    AFHTTPRequestOperation *operation = [_httpClient HTTPRequestOperationWithRequest:request success:^(AFHTTPRequestOperation *operation, id responseObject) {

        NSInteger statusCode = operation.response.statusCode;

        if (statusCode == 200) {

            [self parseResponse:responseObject];

        }

    } failure:^(AFHTTPRequestOperation *operation, NSError *error) { }];

    [_httpClient enqueueHTTPRequestOperation:operation];

    // NOW ADD THE PARSERESPONSE METHOD
- (void)parseResponse:(NSDictionary *)response {

NSString *status = [response objectForKey: @"status"];

NSArray *routes = [response objectForKey:@"routes"];

NSDictionary *routePath = [routes lastObject];

if (routePath) {

    NSString *overviewPolyline = [[routePath objectForKey: @"overview_polyline"] objectForKey:@"points"];

    _path = [self decodePolyLine:overviewPolyline];

    NSInteger numberOfSteps = _path.count;

    CLLocationCoordinate2D coordinates[numberOfSteps];
    for (NSInteger index = 0; index < numberOfSteps; index++) {
        CLLocation *location = [_path objectAtIndex:index];
        CLLocationCoordinate2D coordinate = location.coordinate;

        coordinates[index] = coordinate;
    }

    polyLine = [MKPolyline polylineWithCoordinates:coordinates count:numberOfSteps];
    [self.mapView addOverlay:polyLine];
}

}

// IMPLEMENTING THE DECODEPOLYLINE METHOD:

-(NSMutableArray *)decodePolyLine:(NSString *)encodedStr {

NSMutableString *encoded = [[NSMutableString alloc] initWithCapacity:[encodedStr length]];
[encoded appendString:encodedStr];
[encoded replaceOccurrencesOfString:@"\\\\" withString:@"\\"
                            options:NSLiteralSearch
                              range:NSMakeRange(0, [encoded length])];
NSInteger len = [encoded length];
NSInteger index = 0;
NSMutableArray *array = [[NSMutableArray alloc] init];
NSInteger lat=0;
NSInteger lng=0;
while (index < len) {
    NSInteger b;
    NSInteger shift = 0;
    NSInteger result = 0;
    do {
        b = [encoded characterAtIndex:index++] - 63;
        result |= (b & 0x1f) << shift;
        shift += 5;
    } while (b >= 0x20);
    NSInteger dlat = ((result & 1) ? ~(result >> 1) : (result >> 1));
    lat += dlat;
    shift = 0;
    result = 0;
    do {
        b = [encoded characterAtIndex:index++] - 63;
        result |= (b & 0x1f) << shift;
        shift += 5;
    } while (b >= 0x20);
    NSInteger dlng = ((result & 1) ? ~(result >> 1) : (result >> 1));
    lng += dlng;
    NSNumber *latitude = [[NSNumber alloc] initWithFloat:lat * 1e-5];
    NSNumber *longitude = [[NSNumber alloc] initWithFloat:lng * 1e-5];

    CLLocation *location = [[CLLocation alloc] initWithLatitude:[latitude floatValue] longitude:[longitude floatValue]];
    [array addObject:location];
}

return array;

}

// IMPLEMENTING THE VIEWFOROVERLAY DELEGATE METHOD (MAKE SURE TO SET YOUR MAP VIEW'S DELEGATE TO SELF OR THIS WONT GET CALLED) 

- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay {

MKPolylineView *polylineView = [[MKPolylineView alloc] initWithPolyline:overlay];

polylineView.strokeColor = [UIColor blueColor];
polylineView.lineWidth = 5.0;
polylineView.alpha = 0.7;

return polylineView;

} 
```

这应该让您的定向路线启动并运行！

# jquery - Facebook评论到ajax加载的jQuery-ui手风琴，仅在第一次ajax调用时加载OK

> ID：12234313
> 
> 赞同：1
> 
> 时间：2012-09-02T07:59:15.963
> 
> 标签：jquery, ajax, accordion, facebook-comments

1.  我有一个加载 jquery ui 手风琴的功能（基于不同 id 的不同手风琴）
2.  当我点击标题为“Facebook 评论”的标签时，我会：

    ```
    $("#myaccordion").bind('accordionchange', function(event, ui) {
        id = $("#myaccordion").data('id');
        switch (ui.newHeader.text()) {
            case "Facebook Comments":
                displayFb(id);
                break;
        }
    }); 
    ```

3.  “displayFB”功能是：

    ```
    function displayFb(id){
        $.get('/fbcomments/' + id, function(data) {
            $("#facecomm").append(data);
            });
        } 
    ```

    www.myweb.com/fbcomments/id 在哪里：

    ```
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/es_ES/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>
    <div class="fb-comments" data-href="<?php echo '/fbcomments/'.$id ?>" data-num-posts="10" data-width="220"></div> 
    ```

4.  当我加载主页，然后选择手风琴，然后打开 Facebook 评论时，它完美运行。如果我重新加载页面并选择另一个手风琴，再次完美工作。**问题是当我再次选择另一个手风琴或相同的手风琴而不重新加载整个页面时。手风琴加载得很好，上面的所有数据（图像、文本、视频等的一些标签），但没有出现 facebook 评论。**

5.  我试过了：

    *   在主布局上加载`#fb-root`和 facebook 评论`<script>`....不起作用。
    *   添加`FB.XFBML.parse();`到 displayFB 功能....不起作用
    *   添加`FB.XFBML.parse();`到`$(document).ready(function(){}`...不起作用。
6.  感谢您阅读并尝试提供帮助！

***更新：***

7.  我做了这个小演示......我无法让它工作......也许 jsfiddle 不是插入 Facebook 评论的最佳位置：[我的第一个小提琴](http://jsfiddle.net/xaFwt/2/)

8.  也许重要的是说我在我的网站上使用 cakephp ......

9.  请记住，我的代码在第一次手风琴调用和 displayFb 函数时运行良好……然后当我更改为其他手风琴时……它崩溃了……

10.  再次感谢你！！

***更新2：***

11.  [这是用户的另一个问题](https://stackoverflow.com/questions/9997091/multiple-facebook-comments-instances)....与我的非常相似。请注意，他没有使用手风琴……但 jquery 是共同的……也许有人比我更能理解答案……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:33:38.173

您可以使用浏览器调试器或提琴手来分析来自服务器的响应。它很可能包含您没有看到的错误，因为您的 Ajax 调用不处理错误。

而不是使用 $.get() 尝试使用[$.ajax()](http://api.jquery.com/jQuery.ajax/)并提供一个 error() 回调函数来查看您的 Ajax 调用可能会返回什么错误。像这样的东西。（未测试）

您可能需要设置数据类型：

```
jQuery.ajax({
      type: "GET",
      url: "/fbcomments/"+id,
      success: function (response) {
        // Append the data here into the dom
      },
      error: function (xhr, ajaxOptions, thrownError) {
        alert(xhr.status);
        alert(thrownError);
      }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T08:49:22.943

> www.myweb.com/fbcomments/id 在哪里：

因此，您实际上是在有效地添加 DIV 元素`#fb-root`并一遍又一遍地加载 JS SDK 并将其放置在您的文档中……这不是一个好主意。

尝试通过 AJAX*仅*加载元素，然后在该新内容上运行。`.fb-comments``FB.XFBML.parse`

从一开始就将 JS SDK嵌入`#fb-root`到您的页面中，并且*仅一次*。

# c++ - C++ 和 JMS - 如何连接两者？

> ID：12234318
> 
> 赞同：6
> 
> 时间：2012-09-02T08:00:17.747
> 
> 标签：c++, jms

我是 C++ 的新手，但在 Java EE 方面有很多经验。

我需要编写一个高度异步的小应用程序。它从 HTTP 接收数据并将其存储在队列中（它需要有保证的交付和非常高的吞吐量），比如 ActiveMQ 或 OpenMQ，可能通过 JMS。

然后另一个 C++ 应用程序/侦听器从队列中取出数据（通过一些由队列直接激活的侦听器，而不是通过我的池），连接到 MySQL 数据库并进行一些业务逻辑计算并将消息发送到另一个队列。

在 Java EE 中，这将是一个将消息发送到 JMS 队列的 Web 应用程序。消息驱动 Bean 将成为 EJB 模块中这些消息的消费者，而会话 EJB 将消息发送到传出 JMS 队列。

有C ++经验的人可以向我解释一些基础知识：

1.  JMS 是 C++ 保证交付队列的唯一选择吗？您是否建议 ActiveMQ 或其他东西，请记住消息 Consumer 将使用 C++。

2.  我是否需要在 C++ 中创建某种多线程守护程序来侦听队列消息，或者这个线程创建（消息消费）是 ActiveMQ 的 C+ 消费者实现的一部分？

非常感谢有关如何实施上述方案的任何其他建议。

已编辑：我希望消息代理和客户端使用 C++。ActiveMQ 是一个 Java 产品，这并不是我们真正需要的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-03T04:56:10.680

1 - JMS - Java 消息服务 - 只是 Java 和 Java 的 API 参考。除了 AMQP 之外，没有适用于 C++ 的消息传递标准（在我看来，它并没有真正实现应有的交叉实现）。对于 C++，您必须为每个消息代理实现依赖特定的供应商库。

实施建议：

*   ActiveMQ - 它有一个很好的 C++ API（称为 CMS），它以 JMS 为模型和命名 - 所以你会感觉对 API 很熟悉。主代理将在 Java 上运行，这可能是最简单的选择。

*   IBM WebSphere MQ - 非开源的企业级代理，运行本机（用 C 编写），并具有 C++ 库。当您克服学习曲线并且价格无关紧要时，相当不错。

*   RabbitMQ - 非常流行的具有高性能和开源的可靠消息传递。具有 C++ 客户端库，但使用 Erlang 编写并在 erlang/otp 运行时中运行。

*   Apache QPID - 鲜为人知的 AMQP/JMS 代理。有两种风格的服务器端，Java 和 C++，其中 C++ 代理具有更好的性能。附带 C++ 客户端库。

2 - 对于多线程，JMS 规范也没有真正提供解决方案。它更像是 Java EE 容器（或 Spring 框架），它简单地包装了线程的管理并让开发人员从它那里解脱出来。在这种情况下，ActiveMQ 仅提供几个支持类，据我所知，其他供应商库也没有。因此，寻找一些包装线程的库（我不知道）或自己处理消费者线程。它不应该那么混乱，做得对。

# php - Exec-PHP WORDPRESS 在包含后添加数字 1

> ID：12234323
> 
> 赞同：-1
> 
> 时间：2012-09-02T08:01:36.960
> 
> 标签：php, wordpress

我在 [http://wordpress.org/extend/plugins/exec-php/](http://wordpress.org/extend/plugins/exec-php/) 中使用在我的帖子中编写 php 代码但如果我写 `echo 'S' ;` 这将打印 `S`

但是如果我要写 `echo include('2.php') ;` 并`2.php`写“D”，这将`D1` 在我包含这个添加数字1之后写，我想删除它我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:25:46.027

请参阅下面的 URL，它对您很有帮助。

重要的提示：

请看网址。很多东西都在那里。

[http://www.hongkiat.com/blog/execute-php-in-wordpress-post-page-and-widget-sidebar/](http://www.hongkiat.com/blog/execute-php-in-wordpress-post-page-and-widget-sidebar/)

**在 WordPress 帖子、页面和 Widget Sidebar 中执行 PHP**

**在 WordPress 页面/帖子中执行 PHP 代码**

**在 WordPress 小部件侧边栏中执行 PHP 代码**

或试试看：-

**在 WordPress 页面/帖子中执行 PHP 代码**

[http://www.hongkiat.com/blog/execute-php-in-wordpress-post-page-and-widget-sidebar/](http://www.hongkiat.com/blog/execute-php-in-wordpress-post-page-and-widget-sidebar/)

安装

*   下载[phpexec.txt](http://priyadi.net/wp-content/plugins/phpexec.txt)

*   将 phpexec.txt 重命名为 phpexec.php

*   上传到 /wp-content/plugins/ 目录

*   从 WordPress 管理菜单激活插件

**用法**

在您想要执行 PHP 代码的帖子/页面中的任何位置，在您的 php 代码和您的 php 代码之前插入。

```
<phpcode>  
    <?php  
        echo "Current date and time: ";  
        echo date("l dS of F Y h:i:s A");  
    ?>  
</phpcode> 
```

**安全**

如果您正在运行一个有多个用户的博客，您需要确定谁可以运行这个插件。更改管理菜单中的设置。选项 -> PHPExec

# java - 通过变量声明包类 - java

> ID：12234326
> 
> 赞同：0
> 
> 时间：2012-09-02T08:01:47.240
> 
> 标签：java, methods, package

我创建了 2 个包含类的包，例如

```
pakage1.class.files
  |- ClassA;
  |- ClassB;

pakage2.class.files
  |- ClassC; 
```

但我想调用代码如下

```
public class ClassC
{
    public void method1()
    {
        pakage1.class.files.ClassA var1 = new pakage1.class.files.ClassA();
    }
} 
```

但我想将“pakage1.class.files.ClassA”作为变量传递

```
public class ClassC
{
    public string CL1 = "pakage1.class.files.ClassA";

    public void method1()
    {
        CL1 var1 = new CL1();
    }
} 
```

请帮助我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:05:39.300

不，你不能这样做。变量类型必须在编译时知道。

你可以使用：

```
Class<?> clazz = Class.forName(className);
Object object = clazz.newInstance(); 
```

...但是当然你必须使用反射来获取任何成员。你不会有*那个类型*的变量。

编辑：当然，您不需要在代码中到处都有完全限定的名称。您可以`import`为此使用语句：

```
// Please don't include "class" as part of your package name...
import package1.class.files.ClassA;

public class ClassC {
    public void method1() {
        ClassA var1 = new ClassA();
    }
} 
```

......当然，这不是一回事......但无论如何它可能会对你有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:13:31.627

```
CL1 var1 = new CL1(); 
```

这是java中的错误。CL1 是变量的标识符，而不是数据类型，因此在创建变量时不能使用 CL1 作为类型。

# c++ - 枚举作为 C/C++ 中函数的参数

> ID：12234334
> 
> 赞同：-6
> 
> 时间：2012-09-02T08:02:27.037
> 
> 标签：c++, c

有人可以给我一个例子，我们真的需要一个枚举作为函数中的参数吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T08:09:39.410

除了使代码更清晰之外，在 C++ 中，它在编译时强制一个函数**只能**使用一组可能值中的一个：

```
namespace Foo
{
enum Bar { A, B, C };

void foo(Bar b) { .... }
void foo2(int i) { /* only ints between 0 and 5 make sense */ }
}

int main()
{
  Foo::Bar b = Foo::A;
  Foo::foo(b);   // OK
  Foo::foo(245); // Compile-time error!
  Foo::foo2(6);  // Compiles, triggering some run-time error or UB 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T08:07:35.630

不需要枚举，但它们使软件更具可读性。例子：

```
void write( const std::string&, bool flush ); 
```

现在调用方：

```
write( "Hello World", true ); 
```

如果使用了枚举，则在调用方会更清楚第二个参数的含义：

```
enum flush_type { flush, no_flush };
void write( const std::string&, flush_type flush ); 
```

再次调用方：

```
write( "Hello World", flush ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T08:10:49.790

按钮中的setColor函数，需要获取参数color，应该是enum。

# java - 从文件（XML/Flat/CSV）中读取批量数据并将数据上传到数据库中

> ID：12234336
> 
> 赞同：0
> 
> 时间：2012-09-02T08:02:45.733
> 
> 标签：java, database, bulk

我需要从文件中读取大约 1 000 000 行数据并使用 Java 将数据上传到数据库中。以下是要求的详细信息和我已经编写的一些解决方案：

1.  从文件（任何格式的 XML、平面文件、CSV）中读取数据。根据文件格式初始化类（使用工厂模式）。对于文本文件，我使用的是 BufferedReader，然后将创建的每个对象（例如员工）添加到列表中。同样，对于 XML，我正在使用 SAXParser，并且在从一个对象读取数据后将其添加到列表中。

2.  但我认为我们不能保存或者我们应该在列表中保存 1 000 000 个对象。所以我需要在读取文件并且列表达到一定大小时将数据并行刷新到数据库中。这就是我卡住的地方。这应该如何处理？我是否应该运行一个并行线程，一旦列表大小达到 1000，它将更新数据库中的数据，同时读取文件的线程应该等待？DB 可以是任何数据库 Oracle/MS 访问。

下面是读取文本文件的代码：

```
public class FlatFileLoader implements Loader {

@Override
public List<Employee> readData(String path) {

    try {
        List<Employee> personList =  new ArrayList<Person>();
        FileReader fr = new FileReader(path);
        BufferedReader br = new BufferedReader(fr);
          String line=null;

          while ((line = br.readLine()) != null) {
              Employee person = scanLine(line, DataConstants.DELIMITER);
              if(null != person)
              personList.add(person);

            }
          br.close();

        }
        catch (IOException e) {
          System.err.println(e);
        }
    return null;
}

private Employee scanLine(String recordLine, String delim) {
    Employee person=null;
    List data= new ArrayList();
    StringTokenizer lineScanner = new StringTokenizer(recordLine, delim);
    while (lineScanner.hasMoreElements()) {
        String nextEle= (String) lineScanner.nextElement();
        if(nextEle.equalsIgnoreCase("FIRST_NAME")){
            break;
        }
        data.add(nextEle);

    }
    if(data.size() > 0){
        DataUtil.populatedata(data);
    }
    return person;
}

} 
```

方法 `DataUtil.populatedata(data)` 创建`Employee`对象。那么我应该在哪里调用更新数据库中的数据呢？也欢迎任何改进上述代码的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:32:01.963

您要如何刷新数据基本上取决于您要使用多少内存，但是在加载 1000 个左右的对象后刷新数据是一个好主意，因为您不必为每个加载的 Employee 实例写入数据库，也不会 1000对象占用大量内存。

如果您使用并行线程刷新 Employee 对象列表，请注意线程同步问题：在创建线程 t2 以插入下一个 1000 个对象之前，线程 t1 可能无法完成将其 1000 个对象插入到 db 中。因此，两个线程现在将对象并行插入 DB，因此输入文件（XML、文本）中数据的顺序可能不会保留在 DB 中。

我的建议：保持简单，让读者在数据插入数据库时​​等待。无论如何，1000000 个对象并不多...

在 personList.add(person) 之后插入 DB 插入代码：

```
....
    if(personList.size()>=1000){
        flushToDB(personList);
        personList.clear();
    }
.... 
```

同时，

```
void flushtoDB(List<Employee> persons){
    for(Employee person:persons){
        //insert Employee object into DB
    }
} 
```

# ajax - 分离在 ajax 调用问题期间创建的 Photoswipe 实例

> ID：12234343
> 
> 赞同：0
> 
> 时间：2012-09-02T08:04:21.093
> 
> 标签：ajax, jquery, jquery-mobile, photoswipe

图像是通过`$.ajax`

然后在内部创建 Photoswipe 实例`$.ajax`

当用户单击浏览器的后退按钮时尝试分离 Photoswipe 实例，但无法分离它。

有谁知道任何可能的解决方案来克服这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T14:31:30.773

终于找到了解决办法。请参考以下

```
$.ajax({
        网址：URL_TO_GET_JSON，
        成功：函数（json，状态）{
            变种 p = [];
            $.each(json, 函数(a,b){
                //在这里画图。
            });
            $('.gallery').html(photo.join(''));

        // 在此处创建实例        
            var myPhotoSwipe = $(".gallery a").photoSwipe({
                启用鼠标轮：假，
            })

          /********** 此处未设置实例 *****************/

            $(document).bind('pagebeforechange', function(e) {
                if ($('.ps-carousel').length) {
                    $('body').removeClass('ps-active');
                    var photoSwipe = window.Code.PhotoSwipe;
                    var photoSwipeInstance = photoSwipe.getInstance($(myPhotoSwipe).attr('id'));
                    if (typeof photoSwipeInstance != "undefined" && photoSwipeInstance != null) {
                        photoSwipe.unsetActivateInstance(photoSwipeInstance);
                        photoSwipe.detatch(photoSwipeInstance);
                    }
                }
            });
        }
    });

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T13:03:46.897

我不确定这是否会帮助你，但是......

我将 PhotoSwipe 附加到具有类的页面`gallery-page`，然后将实际的 PhotoSwipe 实例附加到具有`gallery`包含图像的类的任何容器`<a href="../path/image.jpg" rel="external">...</a>`。

我还给每个页面一个id。所以 index.html 有`id="gallery1"`.

然后，在`script.js`我实际调用以将 PhotoSwipe 附加到`.gallery`类的文件中，我使用 if 语句（每页一个），如下所示：

```
// ..... bunch of JS, including PhotoSwipe core

// Create "exists" function for PhotoSwipe code
jQuery.fn.exists = function(){return this.length>0;}

// Create PhotoSwipe instance for a page that has id="gallery1"
if ($('#gallery1').exists()) {
        // Do something
        var myPhotoSwipe = $("#gallery1 .gallery a").photoSwipe({ 
            allowUserZoom: false,
            backButtonHideEnabled: true,
            enableMouseWheel: false, 
            enableKeyboard: false,
            cacheMode: Code.PhotoSwipe.Cache.Mode.aggressive,
            captionAndToolbarAutoHideDelay: 0,
            captionAndToolbarShowEmptyCaptions: false,
            jQueryMobile: true
        });
} // .... continue on for other page IDs 
```

我对每个页面都这样做，根据我对每个特定页面的要求自定义 PhotoSwipe 设置。由于我创建了该`exists`函数，如果在一个 ID 与上一个不同的页面上，PhotoSwipe 实例将被删除，如果存在不同`id="galleryN"`，则将附加其设置/图像。

我希望这会有所帮助......让我知道。

# c# - 如何在运行时发出事件

> ID：12234345
> 
> 赞同：8
> 
> 时间：2012-09-02T08:04:37.117
> 
> 标签：c#, events, runtime, reflection.emit

我希望生成（发出）在运行时使用 C# 实现接口的类。

我已成功发出方法和属性，但未能发出事件。

这是我希望发出的代码：

命名空间：TestInterfaces，类：TestIImplementMe。

```
public event EventHandler SimpleEvent; 
```

下面是生成的 IL 代码：

```
.event [mscorlib]System.EventHandler SimpleEvent
{
    .addon instance void TestInterfaces.TestIImplementMe::add_SimpleEvent(class [mscorlib]System.EventHandler)
    .removeon instance void TestInterfaces.TestIImplementMe::remove_SimpleEvent(class [mscorlib]System.EventHandler)
}

.method public final hidebysig specialname newslot virtual 
    instance void add_SimpleEvent (
        class [mscorlib]System.EventHandler 'value'
    ) cil managed 
{
    // Method begins at RVA 0x330c
    // Code size 48 (0x30)
    .maxstack 3
    .locals init (
        [0] class [mscorlib]System.EventHandler,
        [1] class [mscorlib]System.EventHandler,
        [2] class [mscorlib]System.EventHandler,
        [3] bool
    )

    IL_0000: ldarg.0
    IL_0001: ldfld class [mscorlib]System.EventHandler TestInterfaces.TestIImplementMe::SimpleEvent
    IL_0006: stloc.0
    // loop start (head: IL_0007)
        IL_0007: ldloc.0
        IL_0008: stloc.1
        IL_0009: ldloc.1
        IL_000a: ldarg.1
        IL_000b: call class [mscorlib]System.Delegate [mscorlib]System.Delegate::Combine(class [mscorlib]System.Delegate, class [mscorlib]System.Delegate)
        IL_0010: castclass [mscorlib]System.EventHandler
        IL_0015: stloc.2
        IL_0016: ldarg.0
        IL_0017: ldflda class [mscorlib]System.EventHandler TestInterfaces.TestIImplementMe::SimpleEvent
        IL_001c: ldloc.2
        IL_001d: ldloc.1
        IL_001e: call !!0 [mscorlib]System.Threading.Interlocked::CompareExchange<class [mscorlib]System.EventHandler>(!!0&, !!0, !!0)
        IL_0023: stloc.0
        IL_0024: ldloc.0
        IL_0025: ldloc.1
        IL_0026: ceq
        IL_0028: ldc.i4.0
        IL_0029: ceq
        IL_002b: stloc.3
        IL_002c: ldloc.3
        IL_002d: brtrue.s IL_0007
    // end loop
    IL_002f: ret
} // end of method TestIImplementMe::add_SimpleEvent

.method public final hidebysig specialname newslot virtual 
    instance void remove_SimpleEvent (
        class [mscorlib]System.EventHandler 'value'
    ) cil managed 
{
    // Method begins at RVA 0x3348
    // Code size 48 (0x30)
    .maxstack 3
    .locals init (
        [0] class [mscorlib]System.EventHandler,
        [1] class [mscorlib]System.EventHandler,
        [2] class [mscorlib]System.EventHandler,
        [3] bool
    )

    IL_0000: ldarg.0
    IL_0001: ldfld class [mscorlib]System.EventHandler TestInterfaces.TestIImplementMe::SimpleEvent
    IL_0006: stloc.0
    // loop start (head: IL_0007)
        IL_0007: ldloc.0
        IL_0008: stloc.1
        IL_0009: ldloc.1
        IL_000a: ldarg.1
        IL_000b: call class [mscorlib]System.Delegate [mscorlib]System.Delegate::Remove(class [mscorlib]System.Delegate, class [mscorlib]System.Delegate)
        IL_0010: castclass [mscorlib]System.EventHandler
        IL_0015: stloc.2
        IL_0016: ldarg.0
        IL_0017: ldflda class [mscorlib]System.EventHandler TestInterfaces.TestIImplementMe::SimpleEvent
        IL_001c: ldloc.2
        IL_001d: ldloc.1
        IL_001e: call !!0 [mscorlib]System.Threading.Interlocked::CompareExchange<class [mscorlib]System.EventHandler>(!!0&, !!0, !!0)
        IL_0023: stloc.0
        IL_0024: ldloc.0
        IL_0025: ldloc.1
        IL_0026: ceq
        IL_0028: ldc.i4.0
        IL_0029: ceq
        IL_002b: stloc.3
        IL_002c: ldloc.3
        IL_002d: brtrue.s IL_0007
    // end loop
    IL_002f: ret
} // end of method TestIImplementMe::remove_SimpleEvent 
```

除了这一行，我设法完成了所有操作： IL_001e: call !!0 [mscorlib]System.Threading.Interlocked::CompareExchange(!!0&, !!0, !!0)

!!0, !!0&是什么意思？

如何使用 IL 发射调用此方法？

我试图调用该方法，但是当我添加处理程序时：

```
obj.SimpleEvent += new EventHandler(obj_SimpleEvent); 
```

我得到这个例外：

```
System.BadImageFormatException was unhandled
  Message=An attempt was made to load a program with an incorrect format. (Exception from HRESULT: 0x8007000B)
  Source=DataBuilderAssembly
  StackTrace:
       at NewTest.add_SimpleEvent(EventHandler value)
       at TestInterfaces.Program.Main(String[] args) in D:\Dev\Private\TestInterfaces\TestInterfaces\Program.cs:line 47
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart() 
```

这是发出事件的 add 方法的代码，其中

```
methodName = "add_SimpleEvent";
actionHanler = typeof(Delegate).GetMethod("Combine", new Type[]{typeof(Delegate),typeof(Delegate)});
eventField = typeBuilder.DefineField(info.Name, info.EventHandlerType, FieldAttributes.Private);
compareExchange = GetGenericMethod(typeof(Interlocked), "CompareExchange");// finds the correct method to call.
// thanks to @marc, create the specific method with the correct type
compareExchange = compareExchange.MakeGenericMethod(info.EventHandlerType); 
```

生成事件方法

```
private static MethodBuilder GenerateEventMethod(string methodName, MethodInfo actionHanler, TypeBuilder typeBuilder, EventInfo info, FieldBuilder eventField, MethodInfo compareExchange)
{
    MethodBuilder method = typeBuilder.DefineMethod(methodName, InternalMethodsAttributes, null, new Type[] { info.EventHandlerType });
    method.DefineParameter(0, ParameterAttributes.Retval, null);
    method.DefineParameter(1, ParameterAttributes.In, "value");
    ILGenerator il = method.GetILGenerator();
    il.DeclareLocal(info.EventHandlerType);
    il.DeclareLocal(info.EventHandlerType);
    il.DeclareLocal(info.EventHandlerType);
    il.DeclareLocal(typeof (bool));

    Label loop = il.DefineLabel();

    il.Emit(OpCodes.Ldarg_0);
    il.Emit(OpCodes.Ldfld, eventField);
    il.Emit(OpCodes.Stloc_0);

    il.MarkLabel(loop);// loop start (head: IL_0007)

    il.Emit(OpCodes.Ldloc_0);
    il.Emit(OpCodes.Stloc_1);
    il.Emit(OpCodes.Ldloc_1);
    il.Emit(OpCodes.Ldarg_1);

    il.Emit(OpCodes.Call, actionHanler);
    il.Emit(OpCodes.Castclass, info.EventHandlerType);

    il.Emit(OpCodes.Stloc_2);
    il.Emit(OpCodes.Ldarg_0);

    il.Emit(OpCodes.Ldflda, eventField);

    il.Emit(OpCodes.Ldloc_2);
    il.Emit(OpCodes.Ldloc_1);

    // How to do this?
    //IL_001e: call !!0 [mscorlib]System.Threading.Interlocked::CompareExchange<class [mscorlib]System.EventHandler`1<class [mscorlib]System.ConsoleCancelEventArgs>>(!!0&, !!0, !!0)
    //il.Emit(OpCodes.Call, !!0 compareExchange(!!0&,!!0, !!0));
    il.Emit(OpCodes.Call, compareExchange);

    il.Emit(OpCodes.Stloc_0);
    il.Emit(OpCodes.Ldloc_0);
    il.Emit(OpCodes.Ldloc_1);
    il.Emit(OpCodes.Ceq);
    il.Emit(OpCodes.Ldc_I4_0);
    il.Emit(OpCodes.Ceq);
    il.Emit(OpCodes.Stloc_3);
    il.Emit(OpCodes.Ldloc_3);
    il.Emit(OpCodes.Brtrue_S, loop);
    // end loop
    il.Emit(OpCodes.Ret);

    return method;
} 
```

GetGenericMethod（特定于此问题）：

```
private static MethodInfo GetGenericMethod(Type type, string methodName)
{
    var q = from m in type.GetMethods()
            where m.Name == methodName && m.IsGenericMethod
            select m;
    return q.FirstOrDefault();
} 
```

谢谢， 奥菲尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T08:22:32.643

`!!0`是`T`in `CompareExchange<T>`（即`!!0`是第一个（从零开始的）泛型类型参数），并且`!!0&`是`ref T`- 但所有这些都只是指定重载。重要的一点是之前行中的 ldflda（按引用加载字段）、ldloc.2 和 ldloc.1，以及它返回 a 的事实`T`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:28:11.453

我建议用 C# 编写代码，编译它，然后使用您最喜欢的 .NET 反编译器之一来检查确切的 IL 代码。这样做之后，应该很容易动态地生成相同的代码。

# java - 处理 jspx 模板

> ID：12234346
> 
> 赞同：1
> 
> 时间：2012-09-02T08:04:47.263
> 
> 标签：java, servlets, jspx

我正在 jspx 中做我的第一步。我真的很喜欢 xml 语法。感觉比 jsp 熟悉得多，它迫使我撤消 jsp 原谅的肮脏黑客行为。其中一个技巧是：

```
<img src="<b:Resource name="myImage.png" />" alt="some text" title="even more text" /> 
```

**如何在jspx中正确执行？**

**我的第一个想法：**编写自己的标签，但我真的不想重写所有可能需要资源引用及其所有可能属性的 html 元素。或者是否有一个现有的库，其中包含我可以扩展以支持我需要的功能的那些 html 元素？

**另一个想法：**做类似的事情：

```
<b:Resource name="myImage.png" var="imgVar"/>
<img src="${imgVar}" alt="some text" title="even more text" /> 
```

但我必须对我的网络开发人员机构有所了解。他们对 jsp 并不满意。如果我开始使用这样的语法，他们将完全退出。

有没有好的解决办法。

顺便说一句，我的一些 Web 开发人员也不喜欢使用`&#160;`而不是。**jspx中有没有更好的方法？**`&nbsp;`

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T11:08:17.293

您可能会考虑编写[自定义 EL 函数](https://stackoverflow.com/questions/7079978/how-to-create-a-custom-el-function)，因此您可以使用：

```
<img src="${b:resource('myImage.png')}"
     alt="some text"
     title="even more text" /> 
```**

# php - 使用 Ajax 生成警报框

> ID：12234354
> 
> 赞同：1
> 
> 时间：2012-09-02T08:06:05.173
> 
> 标签：php, ajax, jquery

我想在检查某些数据是否存储在数据库中后弹出一个警告框。如果存储，它会提示已保存，否则不保存。

这是我的 ajax 函数：

```
 AjaxRequest.POST(
              {
                'url':'GroupsHandler.php'
                ,'onSuccess':function(creategroupajax){ alert('Saved!'); }
                ,'onError':function(creategroupajax){ alert('not saved');}
              }
            ); 
```

但现在它显示 AjaxRequest 未定义。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T07:25:09.627

这当然可以使用[Ajax](http://api.jquery.com/jQuery.ajax/)。

考虑以下相同的示例代码。

```
Ajax call : 

$.ajax({
  url: 'ajax/example.php',
  success: function(data) {
    if(data == "success")
      alert('Data saved.');
  }
}); 
```

example.php 的代码

```
<?php 
           $bool_is_data_saved = false;
          #Database processing logic here i.e
          #$bool_is_data_saved is set here in the database processing logic
          if($bool_is_data_saved) {
             echo "success";
          }
     exit;  
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T11:20:29.857

```
function Ajax(data_location){
    var xml;
    try { 
        xml = new XMLHttpRequest();
    } catch (err){
        try { 
            xml = new ActiveXObject("Msxml2.XMLHTTP");
        } catch (error){
            try {
                xml = new ActiveXObject("Microsoft.XMLHTTP");   
            } catch (error1){
                //
            }

        }
    }
    xml.onreadystatechange = function(){
        if(xml.readyState == 4 && xml.status == 200){
            alert("data available");
        }
    }
    xml.open("GET", data_location, true);
    xml.send(null);

}

window.onload = function(){
    Ajax("data_file_location");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T08:13:10.183

**下面的代码基于jQuery。**

**试试看**

```
 $.ajax({
      type: 'POST',
      url: 'http://kyleschaeffer.com/feed/',
data: { postVar1: 'theValue1', postVar2: 'theValue2' },
      beforeSend:function(){
        // this is where we append a loading image
        $('#ajax-panel').html('<div class="loading"><img src="/images/loading.gif" alt="Loading..." /></div>');
      },
      success:function(data){
        // successful request; do something with the data
        $('#ajax-panel').empty();
        $(data).find('item').each(function(i){
          $('#ajax-panel').append('<h4>' + $(this).find('title').text() + '</h4><p>' + $(this).find('link').text() + '</p>');
        });
      },
      error:function(){
        // failed request; give feedback to user
        $('#ajax-panel').html('<p class="error"><strong>Oops!</strong> Try that again in a few moments.</p>');
      }
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T07:23:48.517

您可以使用上次更新数据库的日期（时间）创建一个附加表，并检查此日期是否较晚。您可以使用标准`setInterval`功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T07:25:00.030

这可以使用 ajax。使用 jQuery.ajax/pos/get 调用保存数据的 php 脚本，或者只是检查数据是否以前保存过（取决于您确切需要它的方式），然后使用成功/失败回调来处理其响应并显示如果您得到正确的响应，请发出警报。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-02T07:48:58.030

使用ajax调用脚本并通过脚本检查数据库中的值。如果数据存在回显成功，否则不会。让我们看一个例子。

假设数据库名 = db

假设表名 = tb

假设 tableColumn = data

假设服务器 = 本地主机

阿贾克斯：

```
$.ajax({
  url: 'GroupsHandler.php',
  success:function(data){
     if(data=="saved")
     {
          alert("success");
     }
  }
}); 
```

现在在 myphpscript.php ：

```
<?php

    $Query = "select data from table";

    $con = mysql_connect("localhost","user","pwd");     //connect to server
    mysql_select_db("db", $con);                        //select the appropriate database
    $data=mysql_query($Query);                         //process query and retrieve data
    mysql_close($con);                                //close connection

   if(!$empty(mysql_fetch_array($data))
   {
      echo "saved";  
   }
   else
   {
      echo " not saved ";
   }

?> 
```

**编辑：** 您还必须包含 jquery 文件才能发出这种类型的 ajax 请求。在您的 ajax 调用页面顶部包含此文件。

```
<script src='ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js' type='text/javascript'></script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-02T08:24:39.337

首先，决定是使用 POST 还是 GET（我推荐 POST）来传递 AJAX 数据。制作一个 php 文件（ajax.php），使其回显`true`或`false`检查某些数据是否存储在数据库中。您可以使用内部包含数据的变量`$your_variable = "some_data_to_check";`进行测试，一旦完成，您可以将其替换为`$your_variable = $_POST["ajaxdata"];`.

然后在您的页面中，使用 jQuery 插件设置 AJAX，例如：

```
var your_data_variable = "data_to_send";
$.ajax({
  type: "POST",
  url: "ajax.php",
  data: 'ajaxdata=' + your_data_variable,
  success: function(result){
    if(result == "true"){
      alert("saved");
    }else{
      alert("not saved");
    }
} 
```

您可以查看[jQuery AJAX 教程，示例：使用 jQuery 简化 Ajax 开发](http://viralpatel.net/blogs/jquery-ajax-tutorial-example-ajax-jquery-development/)。

# microcontroller - 通过 8051 微控制器上的中断进行 UART 传输

> ID：12234356
> 
> 赞同：4
> 
> 时间：2012-09-02T08:06:28.577
> 
> 标签：microcontroller, interrupt, 8051, uart

我的平台是一个 c8051F120 微控制器。我想使用中断通过 UART0 发送（=tx）字节。到目前为止，我的设计如下：

```
#define UART0_TX_SIZE 16    
char UART0_tx[UART0_TX_SIZE];
short UART0_tx_uart = 0;
short UART0_tx_main = 0;
short UART0_tx_available = 0;

void UART0_putChar(char value) {
  char SAVE_SFRPAGE;
  bit EA_SAVE = EA;
  // potentially blocking code
  while (UART0_tx_available == UART0_TX_SIZE)
    ;
  // disable interrupts
  EA = 0;
  EA = 0;
  if (UART0_tx_available) {
    UART0_tx[UART0_tx_main] = value;
    ++UART0_tx_main;
    if (UART0_tx_main == UART0_TX_SIZE)
      UART0_tx_main = 0;
    ++UART0_tx_available;
  } else {
    SAVE_SFRPAGE = SFRPAGE;
    SFRPAGE = UART0_PAGE;
    SBUF0 = value;
    SFRPAGE = SAVE_SFRPAGE;
  }
  // reenable if necessary
  EA = EA_SAVE;
}

// (return void works for other interrupts)
void UART0_Interrupt() interrupt (4) {
  if (RI0 == 1) {
    RI0 = 0;
  }
  if (TI0 == 1) { // cause of interrupt: previous tx is finished
    TI0 = 0; // Q: Should this clear tx interrupt flag be further down?
    if (SSTA0 & 0x20) { // Errors tx collision
      SSTA0 &= 0xDF;
    }
    if (UART0_tx_available) { // If buffer not empty
      --UART0_tx_available; // Decrease array size
      SBUF0 = UART0_tx[UART0_tx_uart]; //Transmit
      ++UART0_tx_uart; //Update counter
      if (UART0_tx_uart == UART0_TX_SIZE)
        UART0_tx_uart = 0;
    }    
  }
} 
```

我很确定通过 Timer2（不是上述代码的一部分）对 UART0 寄存器和计时进行的初始化是正确的，因为我可以使用阻塞功能：

```
char putchar_Blocking(char value) {
  char SFRPAGE_SAVE = SFRPAGE;
  SFRPAGE = UART0_PAGE;
  while (!TI0) // while TI0 == 1 wait for transmit complete
    ;
  TI0 = 0;
  SBUF0 = value;
  SFRPAGE = SFRPAGE_SAVE;
  return value;
} 
```

当我想切换到中断设计时，当然我也设置了

```
ES0 = 1; 
```

有人在我的设计中发现试图使用中断的缺陷吗？或者，有人有这方面的示例代码吗？谢谢！对 jszakmeister 大喊一声，他回答了我关于阅读 TCNT 寄存器的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T02:47:29.663

我看到的最大缺陷是您不应该有任何变量（例如：UART0_tx_available）被主代码和中断代码修改。

通常我使用一个循环缓冲区和两个指针来实现一个中断驱动的 UART。

这是 AVR micro 的简单 C 示例。我的 8051 代码都是汇编代码。

```
/* size of RX/TX buffers */
#define UART_RX_BUFFER_SIZE  16
#define UART_TX_BUFFER_SIZE  16
#define UART_RX_BUFFER_MASK ( UART_RX_BUFFER_SIZE - 1)
#define UART_TX_BUFFER_MASK ( UART_TX_BUFFER_SIZE - 1)

#if ( UART_RX_BUFFER_SIZE & UART_RX_BUFFER_MASK )
#error RX buffer size is not a power of 2   
#endif  
#if ( UART_TX_BUFFER_SIZE & UART_TX_BUFFER_MASK )
#error TX buffer size is not a power of 2
#endif

/* 
 *  module global variables
 */
static volatile unsigned char UART_TxBuf[UART_TX_BUFFER_SIZE];
static volatile unsigned char UART_RxBuf[UART_RX_BUFFER_SIZE];
static volatile unsigned char UART_TxHead;
static volatile unsigned char UART_TxTail;
static volatile unsigned char UART_RxHead;
static volatile unsigned char UART_RxTail;
static volatile unsigned char UART_LastRxError;

SIGNAL(UART0_TRANSMIT_INTERRUPT)
/*************************************************************************
Function: UART Data Register Empty interrupt
Purpose:  called when the UART is ready to transmit the next byte
**************************************************************************/
{
    unsigned char tmptail;

    if ( UART_TxHead != UART_TxTail) {
        /* calculate and store new buffer index */
        tmptail = (UART_TxTail + 1) & UART_TX_BUFFER_MASK;

        /* get one byte from buffer and write it to UART */
        UART0_DATA = UART_TxBuf[tmptail];  /* start transmission */
        UART_TxTail = tmptail;
    }else{
        /* tx buffer empty, disable UDRE interrupt */
        UART0_CONTROL &= ~_BV(UART0_UDRIE);
    }
}

/*************************************************************************
Function: uart_putc()
Purpose:  write byte to ringbuffer for transmitting via UART
Input:    byte to be transmitted
Returns:  none
**************************************************************************/
void uart_putc(unsigned char data)
{
    unsigned char tmphead;

    tmphead  = (UART_TxHead + 1) & UART_TX_BUFFER_MASK;

    while ( tmphead == UART_TxTail ){
        ;/* wait for free space in buffer */
    }

    UART_TxBuf[tmphead] = data;
    UART_TxHead = tmphead;

    /* enable UDRE interrupt */
    UART0_CONTROL |= _BV(UART0_UDRIE);

}/* uart_putc */ 
```

特别感谢 Peter Fleury [http://jump.to/fleury](http://jump.to/fleury)提供这些例程来自的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T09:12:32.547

我的同事郭雄发现了错误：变量UART0_tx_available没有在正确的地方增加和减少。以下是经过修正和测试的版本：

```
#define UART0_TX_SIZE 16    
char UART0_tx[UART0_TX_SIZE];
short UART0_tx_uart = 0;
short UART0_tx_main = 0;
short UART0_tx_available = 0;

void UART0_putChar(char value) {
  char SAVE_SFRPAGE;
  bit EA_SAVE = EA;
  // potentially blocking code
  while (UART0_tx_available == UART0_TX_SIZE)
    ;
  // disable interrupts
  EA = 0;
  EA = 0;
  if (UART0_tx_available) {
    UART0_tx[UART0_tx_main] = value;
    ++UART0_tx_main;
    if (UART0_tx_main == UART0_TX_SIZE)
      UART0_tx_main = 0;
  } else {
    SAVE_SFRPAGE = SFRPAGE;
    SFRPAGE = UART0_PAGE;
    SBUF0 = value;
    SFRPAGE = SAVE_SFRPAGE;
  }
  ++UART0_tx_available;
  // reenable if necessary
  EA = EA_SAVE;
}

// (return void works for other interrupts)
void UART0_Interrupt() interrupt (4) {
  if (RI0 == 1) {
    RI0 = 0;
  }
  if (TI0 == 1) { // cause of interrupt: previous tx is finished
    TI0 = 0; // Q: Should this clear tx interrupt flag be further down?
    if (SSTA0 & 0x20) { // Errors tx collision
      SSTA0 &= 0xDF;
    }
    --UART0_tx_available; // Decrease array size
    if (UART0_tx_available) { // If buffer not empty
      SBUF0 = UART0_tx[UART0_tx_uart]; //Transmit
      ++UART0_tx_uart; //Update counter
      if (UART0_tx_uart == UART0_TX_SIZE)
        UART0_tx_uart = 0;
    }    
  }
} 
```

# mysql - 在 MySQL 查询中显示零计数

> ID：12234358
> 
> 赞同：0
> 
> 时间：2012-09-02T08:07:00.883
> 
> 标签：mysql, select, count

我在我的数据库中有一个名为subscriber 的表，其中包含两行，一行用于订阅者ID，另一行用于每个订阅者获得的积分。我的选择查询：

```
SELECT 1000 * ( LOYALTY_POINTS DIV 1000 ) AS  'from', 1000 * ( LOYALTY_POINTS DIV 1000 ) +1000 AS  'to', COUNT( * ) AS NUMBER FROM SUBSCRIBER GROUP BY LOYALTY_POINTS DIV 1000 
```

应该为每个点范围返回订阅者的数量，但不幸的是它只返回不同于零的订阅者数量。我的结果是：

从到 NUMBER
0 1000 8
1000 2000 2
3000 4000 1

我希望查询也返回计数为零的记录。结果应该是：

从到 NUMBER
0 1000 8
1000 2000 2
2000 3000 0
3000 4000 1

怎么做？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:12:18.527

您需要生成一些数字来指示您的范围

```
 SELECT 0 as RangeStart UNION Select 1000 UNION Select 2000 UNION Select 3000 
```

并将其加入您的结果。

```
SELECT 
    RangeStart, RangeStart + 999 as RangeEnd, RangeCount
FROM
    (SELECT 0 as RangeStart UNION Select 1000 UNION Select 2000 UNION Select 3000) range
         LEFT JOIN
    (Select LoyaltyPoints DIV 1000 as loyaltypoints, count(*) as RangeCount group by LoyaltyPoints DIV 1000 ) counts
    ON range.rangestart = counts.loyaltypoints 
```

# drupal - DRUPAL 和内存限制

> ID：12234365
> 
> 赞同：1
> 
> 时间：2012-09-02T08:07:56.283
> 
> 标签：drupal, optimization, memory, memory-limit

Drupal 上的某些页面比其他页面使用更多的内存。我认为在 Drupal 中为所有页面保留 64M 或更多是浪费服务器资源，只是因为模块的页面（或带有图形的部分）达到了这个峰值，并且我想在进行更改时避免出现白页。

所以，我的问题是：根据部分或页面以编程方式管理不同的内存限制是一种好习惯吗？有些页面使用 32M 或更少，所以我认为最好使用特定限制来优化 Web 应用程序的特定部分。

我已经阅读了很多关于优化实践的内容，但我还没有发现动态处理内存限制或处理这类问题或应用这种方法的 Drupal 模块。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:36:51.080

内存限制实际上只是告诉 Drupal 允许使用多少内存。Drupal 不会“保留”内存。它并没有像你想象的那样真正“管理”内存。它会在需要时使用它需要的（允许的）任何东西，如果它需要更多，你会得到一个错误。如果它需要少于内存限制，它将使用更少。

运行 Drupal 7 所需的最低可用内存为 32MB，但建议的数量接近 128MB。

[http://drupal.org/requirements#php](http://drupal.org/requirements#php)

> PHP 内存需求可能会因站点上使用的模块而有很大差异。Drupal 6 核心要求 PHP 的 memory_limit 至少为[16MB](http://api.drupal.org/api/constant/DRUPAL_MINIMUM_PHP_MEMORY_LIMIT/6)。Drupal 7 核心需要[32MB](http://api.drupal.org/api/constant/DRUPAL_MINIMUM_PHP_MEMORY_LIMIT/7)。如果 PHP 配置不满足这些要求，将显示警告消息。然而，虽然这些值对于默认的 Drupal 安装可能已经足够，但启用了许多常用模块（CCK、视图等）的生产站点可能需要 64 MB 或更多。某些安装可能需要更多，尤其是在富媒体实现中。如果您使用托管服务，请务必验证您的主机是否可以为您正在部署或将来可能部署的模块集提供足够的内存。（请参阅[增加 PHP 内存限制](http://drupal.org/node/207036)有关修改 PHP 内存限制的更多信息，请参见疑难解答常见问题解答页面。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T23:01:33.537

Drupal 的内存非常重。当第一次预热 drupal 实例时，它会尝试为视图、缓存等分配内存。

请务必将其放在 sites/default/settings.php 中

`ini_set('memory_limit','128M');`

# php - 在 CakePHP 中测量应用程序运行时间

> ID：12234367
> 
> 赞同：1
> 
> 时间：2012-09-02T08:08:25.713
> 
> 标签：php, performance, cakephp, logging, cakephp-2.0

在我的生产服务器中，我需要检查我的应用程序的运行时间（我已经在本地机器上制作了）
但是当我将 microtime() 放在 AppController 的 beforeFilter 和 afterFilter 之间时，我得到的结果非常小，比如说`$runningTime=0.20`几秒钟。
但是将地址写入我的浏览器和看到输出页面之间的时间是 runningTime 的 100 倍。
我需要找出使我的应用程序变慢的泄漏。是否可以捕获我将地址写入浏览器并在浏览器上获取输出之间的时差？也许我可以找出原因。
我发现了`TIME_START`常量，它看起来像是`microtime()`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:28:20.707

见以下网址

[CakePHP 1.3：测量页面执行时间](https://stackoverflow.com/questions/4719937/cakephp-1-3-measuring-page-execution-time)

以防万一其他人好奇，我通过将以下代码添加到我的 layout.ctp 来解决这个问题。您也可以在控制器中执行此操作并将其作为变量传递，这可能对 MVC 更友好一点，但我希望在站点的每个页面上都这样做，而无需在每个控制器中复制代码

```
Page rendered in <?php echo round((getMicroTime() - $_SERVER['REQUEST_TIME']) * 1000) ?>ms. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:28:26.787

0.2 秒的运行时间对我来说似乎没问题。如果您的脚本在 20 秒内运行，请将开始测量的点移到脚本的开头并查看结果。

或者 .. 使用[xdebug 分析](http://xdebug.org/docs/profiler)来查看你的 CPU 周期的去向。

# javascript - javascript 速记语法

> ID：12234371
> 
> 赞同：1
> 
> 时间：2012-09-02T08:09:06.213
> 
> 标签：javascript, syntax, shorthand, shorthand-if

我想知道如何用简写来写语句将执行

这个不起作用，但我在插件中多次看到这种语法 - 变量与语句等混合在一起。

**有人可以解释正确使用这种速记语法吗？** 如果第一个评估为真，我想“执行”而不是“评估”第二个语句！

```
var succes = !data.user||(window.location = "users/profile"); 
```

我知道第一个例子很简单，这个更好，它还使用逗号将语句串起来，我想知道如何学习这种语法。

```
},
        hide: function (a,
        b) {
            if (f && !(500 > (new Date).getTime() - f.getTime())) {
                if (!a || "number" == typeof a) a = k();
                b || (b = $(".profile-popup"));
                j(a) && (b.fadeOut("fast"), m(!1, a));
                e && (clearInterval(e), e = null)
            }
        }
    }
}(); 
```

**编辑** 我将我的第一个示例更改为在我的代码中使用 && 并且它起作用了，所以，就是这样 - 对于其他阅读的人 - 并且如果使用 window.location，你应该使用绝对 url

[我还在这里](https://stackoverflow.com/questions/3859433/an-explanation-of-shorthand-in-javascript?rq=1)找到了另一个详细的解释。

谢谢，理查德

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T08:12:14.607

我认为你错过了另一个`=`：

```
var succes = !data.user || (window.location == "users/profile"); 
```

您的示例分配，而是`==`比较。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T08:20:40.460

的一般模式`!obj || obj = "something"`只是以下的简写：

```
if (obj === undefined) {
    obj = "something";
} 
```

那是因为`!obj`评估`false`它是否未定义（该模式似乎也*假设*它`obj`不会被定义为`true`）。

同样，该模式`f(a) && (g(b), h(c))`是以下的简写：

```
if (f(a) == true) {
    g(b);
    h(c);
} 
```

* * *

对于引用的一段代码：

```
var succes = !data.user||(window.location = "users/profile"); 
```

这隐含的意思是：

1.  如果 data.user 未定义，则设置`success`为 true。
2.  否则（如果`data.user` *已*分配），则*重定向*到*users/profile*。

确切的含义是任何人在不知道上下文的情况下的猜测，但它似乎意味着“如果用户数据可用，则重定向个人资料屏幕，否则......”

# vb.net - 在 VB/C# .NET 中，是否总是必须手动处理对话框？

> ID：12234377
> 
> 赞同：1
> 
> 时间：2012-09-02T08:10:04.767
> 
> 标签：vb.net, garbage-collection, dispose

我正在考虑处理资源，并对不同的处理方式有点混淆。

我刚刚发现在 ShowDialog() 显示的表单上使用 Close() 只是实际上隐藏了它，并没有完全杀死它，可以这么说。虽然这对我目前想要的很有用，但我现在担心其他地方的内存泄漏。

使用 ShowDialog() 后，我应该总是在表单上调用 Dispose() 还是使用 Using 块？有区别吗？或者当退出创建子程序时表单会被自动处理吗？例如，我典型的简单用法之一：

```
Private Sub btnEdit_Click(sender As System.Object, e As System.EventArgs) Handles btnEdit.Click
Dim frm As New frmSomething()
frm.ShowDialog()

'frm is exited by clicking the X or using Close()
'At this point, frm is still in memory.  Is it automatically disposed of
'after the End Sub here, or should I do frm.Dispose() ?

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T08:12:39.990

它不会被自动处理，不。它可能不会导致*问题*，并且很可能有一个终结器来完成所需的一切，因此成本只是终结器运行之前的一些额外资源（以及最终 GC 之前的更长延迟），但最好处理它明确 - 理想情况下有一个`Using`声明：

```
Using frm As New frmSomething()
    frm.ShowDialog()
End Using 
```

# c++ - LuaBridge 没有正确创建构造函数

> ID：12234388
> 
> 赞同：2
> 
> 时间：2012-09-02T08:12:24.547
> 
> 标签：c++, lua, luabridge

我使用 LuaBridge 将一些类和函数移植到 Lua。我目前正在调试，我总是得到

```
main.lua:1: attempt to call method 'new' (a nil value) 
```

这是 main.lua ：

```
v = TexVector:new( 1, 2 )
v.X = 0
v.Y = 0
print( v.X, v.Y ) -- print and explicit binded functions work 
```

这是 TexVector 的初始化代码：

```
luabridge::getGlobalNamespace( L ).
    beginClass< Cheap::Math::TexVector >( "TexVector" ).
        addConstructor< void (*) ( ) >( ).
        addConstructor< void (*) ( const double& , const double& ) >( ).
        addData( "X", &Cheap::Math::TexVector::X ).
        addData( "Y", &Cheap::Math::TexVector::Y ).
        addFunction( "Add", &Cheap::Math::TexVector::Add ).
        addFunction( "Sub", &Cheap::Math::TexVector::Sub ).
        addFunction( "Mul", &Cheap::Math::TexVector::Mul ).
        addFunction( "Div", &Cheap::Math::TexVector::Div ).
        addFunction( "Eq", &Cheap::Math::TexVector::Eq ).
        addFunction( "Apply", &Cheap::Math::TexVector::Apply ).
    endClass( ); 
```

AFAIK 是 :new Lua-“类”的构造函数。初始化或 Lua 脚本有问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T08:41:32.653

LuaBridge 只支持一个构造函数。这并不能阻止您拥有多个命名的静态构造函数，例如 Nicol Bolas 建议的 :new 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T04:07:39.223

我必须使用 .operator 进行初始化，并且只注册一个构造函数。

# jquery - Jquery 表插件中的值的总和

> ID：12234403
> 
> 赞同：1
> 
> 时间：2012-09-02T08:15:08.150
> 
> 标签：jquery, jquery-plugins

我正在使用这个 jquery数据表[插件](http://datatables.net/release-datatables/examples/advanced_init/footer_callback.html)来显示来自数据库的信息。我的表如下所示。现在我正在尝试总结分数（请查看下表）并将它们显示为总分，就像在本[网站中给出的示例中一样](http://datatables.net/release-datatables/examples/advanced_init/footer_callback.html)

```
<script type="text/javascript" src="js/jquery.dataTables.min.js"></script>
<script type="text/javascript" charset="utf-8">
 $(document).ready(function() {$('#gtable').dataTable();} );
  </script>

<table class="gtable" align="center" id="gtable">
<thead>
 <tr>
    <th>Sl</th>
    <th>Name</th>
    <th>Marks</th>
 </tr>
</thead>

<tbody>
 <tr><td>1</td> <td>Charlie Sheen</td>  <td>20</td></tr>
 <tr><td>2</td> <td>John Cryer</td>     <td>20</td></tr>
 <tr><td>3</td> <td>Jason Stathum</td>  <td>20</td></tr>

</tbody>

</table 
```

该插件的网站提供了以下代码来执行并显示总和，但我仍然不明白如何使用我上面的数据表。

你能帮我解决这个问题吗？

```
 $(document).ready(function() {
  $('#example').dataTable( {
    "fnFooterCallback": function ( nRow, aaData, iStart, iEnd, aiDisplay ) {
        /*
         * Calculate the total market share for all browsers in 
          this table (ie inc. outside
         * the pagination)
         */
        var iTotalMarket = 0;
        for ( var i=0 ; i<aaData.length ; i++ )
        {
            iTotalMarket += aaData[i][4]*1;
        }

         /* Calculate the market share for browsers on this page */
        var iPageMarket = 0;
        for ( var i=iStart ; i<iEnd ; i++ )
        {
            iPageMarket += aaData[ aiDisplay[i] ][4]*1;
        }

        /* Modify the footer row to match what we want */
        var nCells = nRow.getElementsByTagName('th');
        nCells[1].innerHTML = parseInt(iPageMarket * 100)/100 +
            '% ('+ parseInt(iTotalMarket * 100)/100 +'% total)';
     }
   } );
  } ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T08:20:02.923

功能应该是这样的

```
$('#example').dataTable( {
  "fnFooterCallback": function ( nRow, aaData, iStart, iEnd, aiDisplay ) {

    var TotalMarks = 0;
    for ( var i=0 ; i<aaData.length ; i++ )
    {
        TotalMarks += aaData[i][2]*1;
    }

    var nCells = nRow.getElementsByTagName('th');
    nCells[1].innerHTML = TotalMarks;
  }
}); 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:22:53.643

非常简单：

```
var sum = 0;
$("#gtable tbody tr").each(function(){
    sum += $(this).find("td").eq(3).text();
}); 
```

未经测试，如果您有问题，请告诉我。

说明：这里的基本情况是，我们在 的范围之外初始化了一个变量“sum” `$.each`，jQuery 每个都允许您遍历所有匹配条件的元素，在这种情况下，表体中属于#gtable 的所有表行，然后，我们所做的是，我们在每一行中找到第 3 个 td，并将​​其添加到总和中，因为 JavaScript 是一种动态类型的语言 - 可以这样做。

现在在变量“总和”中，我们有所有的标记总和。

# ruby-on-rails - 应该使用 class_name 和 foreign_key 的 belongs_to

> ID：12234404
> 
> 赞同：22
> 
> 时间：2012-09-02T08:15:30.360
> 
> 标签：ruby-on-rails, rspec, shoulda

我知道您可以使用 Shoulda 轻松测试属于关系：

```
describe Dog dog
  it { should belong_to(:owner) }
end 
```

是否可以使用 Shoulda 测试更复杂的 belongs_to 关系？像这样的东西：

```
class Dog < ActiveRecord::Base
  belongs_to :owner, :class_name => "Person", :foreign_key => "person_id"
end 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-02T09:09:50.957

您应该能够使用：

```
it { should belong_to(:owner).class_name('Person') } 
```

Shoulda 的`belong_to`匹配器总是从关联中读取`foreign_key`并测试它是一个有效的字段名称，所以你不需要做更多的事情。

（参见[`Shoulda::Matchers::ActiveRecord::AssociationMatcher#foreign_key_exists?`](https://github.com/thoughtbot/shoulda-matchers/blob/481631ce366280998f2d2690fca57788a2a73593/lib/shoulda/matchers/active_record/association_matcher.rb#L159)和相关方法）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-08-28T07:44:12.673

现在可以测试自定义外键：

```
it { should belong_to(:owner).class_name('Person').with_foreign_key('person_id') } 
```

请参阅：[https ://github.com/thoughtbot/shoulda-matchers/blob/master/lib/shoulda/matchers/active_record/association_matcher.rb#L122](https://github.com/thoughtbot/shoulda-matchers/blob/master/lib/shoulda/matchers/active_record/association_matcher.rb#L122)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-05T12:46:07.393

我知道我参加聚会有点晚了，所以我的解决方案可能需要最新版本的`shoulda`.

在撰写本文时，我在`v 2.4.0`.

我不需要`class_name`或`with_foreign_key`在我的规范中。

确保您在模型中指定`class_name`和`foreign_key`。

```
# model.rb:  
belongs_to :owner, inverse_of: :properties, class_name: "User", foreign_key: :owner_id

# spec.rb:  
it { should belong_to(:owner) } 
```

结果输出：

```
should belong to owner 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-03-11T07:09:13.843

如果协会喜欢

```
belongs_to :custom_profile, class_name: 'User', foreign_key: :custom_user_id, optional: true 
```

那么 rspec 应该是

```
it { should belong_to(:custom_profile).class_name('User').with_foreign_key('custom_user_id').optional } 
```

此处`optional`用于可选：true，如果您的关联中不需要可选 true，您也可以将其删除

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-02T08:58:49.823

所以[should-matchers 的](https://github.com/thoughtbot/shoulda-matchers)README 对细节很清楚，只是举了一些例子。我发现在类的 RDoc 中有更多的信息，`belongs_to`请查看[association_matcher.rb](https://github.com/thoughtbot/shoulda-matchers/blob/master/lib/shoulda/matchers/active_record/association_matcher.rb)。第一种方法是使用 Rdoc 的 belongs_to

> ```
>  # Ensure that the belongs_to relationship exists.
>   #
>   # Options:
>   # * <tt>:class_name</tt> - tests that the association makes use of the class_name option.
>   # * <tt>:validate</tt> - tests that the association makes use of the validate
>   # option.
>   #
>   # Example:
>   #   it { should belong_to(:parent) }
>   #
>   def belong_to(name) 
> ```

所以`belongs_to`只支持`:class_name`和的测试`:validate`。

# c - 我们如何在 C 中分配 10^15 阶的内存

> ID：12234409
> 
> 赞同：-2
> 
> 时间：2012-09-02T08:17:05.980
> 
> 标签：c, memory-management

我需要分配 10^15 的内存来存储可以是 long long 类型的整数。如果我使用数组并声明类似

```
long long  a[1000000000000000]; 
```

那永远行不通。那么我如何分配如此大量的内存。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T08:23:19.790

真正的大数组通常不是内存的工作，更多的是磁盘。每个 64 位的10 ^(15 个)数组元素（我认为）是 8 PB。目前你可以花大约 15 美元购买 8G 内存片，因此，即使你的机器可以处理那么多内存或地址空间，你也要花费大约 1500 万美元。

此外，随着即将推出的 DDR4 时钟频率高达约 4GT/s（千兆传输），即使每次传输都是 64 位值，仅将该阵列初始化为零仍需要大约一百万秒。*你真的想在你的代码开始*做任何有用的事情之前等待十一天半吗？

而且，即使你走磁盘路线，那也是相当多的。（大约）每 TB 50 美元，您仍然需要 400,000 美元，而且您可能必须提供自己的软件来以某种方式管理这 8,000 个磁盘。而且我什至不会*考虑*弄清楚初始化磁盘上的阵列需要多长时间。

您*可能*需要考虑重新表述您的问题以指示实际*问题*，而不是您当前拥有的问题，即建议的解决方案。可能您根本*不需要*那么多存储空间。

例如，如果您正在谈论一个数组，其中许多值都为零，那么稀疏数组是一种方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T08:23:02.033

你不能。你没有所有这些记忆，而且你暂时不会拥有它。简单的。

编辑：如果你真的想处理不适合你的 RAM 的数据，你可以使用一些处理大容量存储数据的库，比如[stxxl](http://stxxl.sourceforge.net/)，但它的工作速度会慢很多，而且你总是有磁盘大小限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T03:22:46.817

MPI 是您所需要的，这实际上是并行计算问题的小尺寸，劳伦斯利弗莫尔国家实验室的蓝色基因 Q 怪物拥有大约 1.5 PB 的内存。您需要使用块分解来划分您的问题和中提琴！

基本方法是在许多处理器之间将数组分成相等的块或块

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T08:23:26.090

您需要升级到 64 位系统。然后获取支持 64 位的编译器，然后将 al 放在 100000000000000000 的末尾。

你听说过[稀疏矩阵实现](http://www.cplusplus.com/forum/general/8352/)吗？在其中一个稀疏矩阵中，尽管矩阵很大，但您只使用了矩阵的极少部分。

[这里有一些图书馆给你。](https://stackoverflow.com/questions/2222549/best-c-matrix-library-for-sparse-unitary-matrices)

[这是有关稀疏矩阵的基本信息，](http://en.wikipedia.org/wiki/Sparse_matrix)您实际上并没有全部使用它。只是需要的几点。

# javascript - 使用jQuery根据窗口大小更改滑块的css高度

> ID：12234413
> 
> 赞同：0
> 
> 时间：2012-09-02T08:17:58.400
> 
> 标签：javascript, jquery, html, css, resize

我找到了非常接近我想要的解决方案，但由于我有限的编程经验，我无法让它们为我工作。

我想要做的是根据窗口大小更改两个内联 css 标记内的参数。

在我的网站上，我需要更改这三个参数（具体更改`515`下面的数字）：

*   1）内联CSS：`<div id="rev_slider_1_1" class="rev_slider fullwidthabanner" style="display:none;max-height:515px;">`
*   2）内联CSS：`<div id="rev_slider_1_1_wrapper" class="rev_slider_wrapper fullwidthbanner-container" style="margin:0px auto;padding:0px;margin-top:0px;margin-bottom:0px;max-height:515px;">`

我需要做的是`515`根据窗口的宽度更改：如果窗口宽度高于`1280`我希望高度的值是`515`，如果低于`1280`我希望高度是`615`，如果宽度是小于`480`使高度`715`。

这段代码（取自[这里](https://stackoverflow.com/questions/838137/jquery-change-height-based-on-browser-size-resize)）似乎是我需要的，但我不知道如何针对我的具体情况修改代码：

```
jQuery.event.add(window, "load", resizeFrame);
jQuery.event.add(window, "resize", resizeFrame);

function resizeFrame() 
{
    var h = $(window).height();
    var w = $(window).width();
    $("#elementToResize").css('height',(h < 1024 || w < 768) ? 500 : 400);
} 
```

谁能给我一些帮助？我想我只需要屏幕的宽度就可以做到这一点，但我不确定。非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:41:09.813

你可以这样写你的条件：

```
$(window).on('load resize', function () {
  var w = $(window).width();
  $("#rev_slider_1_1 #rev_slider_1_1_wrapper")
    .css('max-height', w > 1280 ? 515 : w > 480 ? 615 : 715);
}); 
```

# java - 如何通过 id 避免休眠默认顺序？

> ID：12234419
> 
> 赞同：0
> 
> 时间：2012-09-02T08:18:51.200
> 
> 标签：java, hibernate, hql

我做这个查询：

```
String query = FROM Account acc WHERE acc.id = ? OR acc.id = ? or acc.id = ?... 
```

我有一组 id：

```
long[] accountIds= {327913,327652,327910,330511,330643}; 
```

然后我做

```
getHibernateTemplate().find(query, accountIds); 
```

我看到我从这个查询中得到的帐户列表是：

327652,327910,327913,330511,330643，显然是按 id 排序的。

我有没有机会按照我写 ID 的顺序取回它？

将感谢所有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T08:56:20.700

您可能想要使用`Criteria`和它的`addOrder`.

像这样的东西：

```
DetachedCriteria cr = DetachedCriteria.forClass(entityClass);
//Add expressions or restrictions to your citeria
//And add your ordering
cr.addOrder(Order.asc("yourID"));
List<T> ls = getHibernateTemplate().findByCriteria(cr);
return ls; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:23:51.253

您不能在查询级别执行此操作。
您可以在从 db 加载后进行排序，就像这样

```
 long[] accountIds= {327913,327652,327910,330511,330643};
   List<Account> afterHql = getHibernateTemplate().find(query, accountIds);
   List<Account> sortedList = new ArrayList<Acount>();
   for (long id : accountIds)
   {
       for (Account account : afterHql)
       {
           if (account.getId() == id)
           {
               sortedList.add(account);
           }
       }
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T09:23:43.160

无法通过在`OR Query`或中提供任何实体来获取结果`Restrictions.in()`。当你触发这种查询时，它会默认搜索结果 id。所以它只会给你明智的结果。您可以在 asc 或 desc 中使用 Criteria 更改顺序。如果您想根据输入的 id 获得结果，那么第二个答案是唯一的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T22:21:50.943

您只能按照数据类型定义的顺序按查询返回的列值排序。预先订购您提供的ID，并按ID对查询结果进行排序，这样它们以相同的顺序出来不是更好吗？

# actionscript-3 - 我正在尝试编写一个程序，该程序在 As3 中加载带有元数据标签的外部资源

> ID：12234421
> 
> 赞同：0
> 
> 时间：2012-09-02T08:19:24.390
> 
> 标签：actionscript-3

我有一些工作要做，但我似乎无法理解为什么它不起作用..我认为我使用了错误的方法，我试图在同一个舞台上加载图片和电影剪辑..虽然我设法显示了一张图片，但是当我尝试显示 MovieClip 时。虽然我运行时没有错误，但我得到以下信息：

TypeError：错误 #1034：类型强制失败：无法将 LoadingFiles_MovingStars1@2aba161 转换为 flash.display.Bitmap。在 LoadingFiles()[C:\Users\user\Adobe Flash Builder 4.5\LoadingFiles\src\LoadingFiles.as:28

这是代码，

```
package
{
import flash.display.Sprite;
import flash.display.Bitmap;
import flash.display.MovieClip;
import flash.display.StageScaleMode;

[SWF(width = "800", height = "600", frameRate = "30", backgroundColor="#FFFF00")]
public class LoadingFiles extends Sprite
{
    [Embed(source="/../assets/Head.jpg")]
    protected var MovingStars:Class;

    [Embed(source="/../assets/water1.mp4", mimeType = "application/octet-stream")]
    public var MovingStars1:Class;

    public function LoadingFiles()
    {
        stage.scaleMode = StageScaleMode.NO_SCALE;

        // swf
                var myStars:Bitmap = new MovingStars(); 

        var myPic:Bitmap = new MovingStars1(); // 
        var yourPic:MovieClip = new MovingStars1();

        myStars.x = (stage.stageWidth-myStars.width)/2;
        myStars.y = (stage.stageHeight-myStars.height)/2;

        addChild(myPic as MovieClip);
        addChild(yourPic);
        addChild(myStars);
    }
}
} 
```

现在我写了那个代码，但它不起作用..我真的很紧张，因为我在课堂上落后了一点..

帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T13:38:05.547

您正在尝试将嵌入的 .mp4 文件实例化为位图或影片剪辑。这是不可能的，您需要创建一个视频播放器或使用已经存在的视频播放器组件。这是一个更深入的答案： [如何制作 AS3 Flash 视频播放器？](https://stackoverflow.com/questions/4985935/how-to-make-an-as3-flash-video-player)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T14:32:33.283

当您嵌入图像时

```
[Embed(source="/../assets/Head.jpg")]
protected var MovingStars:Class; 
```

您的 MovingStars 是 BitmapAsset 类。这是包含在 Flex SDK 中的类。因此，您需要预加载 Flex SDK rsl。或者将 Flex SDK 库链接配置为合并到代码中。

你用的是什么IDE？

# android - 如何在 Android API 10 (Android 2.3.3) 上清理回栈

> ID：12234430
> 
> 赞同：4
> 
> 时间：2012-09-02T08:22:23.943
> 
> 标签：android, android-intent, android-activity, android-compatibility

我想知道如何清理堆栈的所有先前活动（新的活动除外），但我希望在 Android API 10（Android 2.3.3）中进行。

以这个[答案](https://stackoverflow.com/a/5344635/1383227)为指导，我知道这是不可能的，因为自 API 11 以来就存在专门用于执行此操作的标志。

但我想知道这是否可能具有某种兼容性，或者是否有人有任何解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T15:37:52.390

这样做的方法是始终使用`startActivityForResult()`. 如果要清理活动堆栈，请先调用当前活动`setResult(RESULT_CANCELED)`，然后再调用`finish()`. 在所有活动中（除了您的主要或“根”活动）都有以下方法：

```
@Override
protected void onActivityResult (int requestCode, int resultCode, Intent data) {
    if (resultCode == RESULT_CANCELED) {
        // Want to clear the activity stack so I should just go away now
        setResult(RESULT_CANCELED); // Propagate result to the previous activity
        finish();
} 
```

这将完成堆栈中的所有活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:27:09.357

您可以将清单文件 android:noHistory="true" 添加到您不想保留在堆栈中的每个活动中

# java - 使用反射动态调用方法

> ID：12234439
> 
> 赞同：0
> 
> 时间：2012-09-02T08:23:23.313
> 
> 标签：java, reflection

我想编写一个程序来决定在运行时调用对象的哪些方法。

例如

```
 <method>getXyz<operation>
 <arg type="int"> 1 <arg>
 <arg type="float"> 1/0 <arg> 
```

现在我在 XML 文件中有类似上面的内容，我想决定在运行时调用哪个方法。可以有多种方法。

我不想在我的代码中执行以下操作：

```
 if (methodNam.equals("getXyz"))
     //call obj.getXyz() 
```

如何使用 Java 反射来做到这一点？

另外我想在运行时构造参数列表。例如，一种方法可以带 2 个参数，而另一种可以带`n`参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T13:39:38.233

您可以将以下代码用于使用反射的类方法

```
package reflectionpackage;
public class My {
    public My() {
    }
   public void myReflectionMethod(){
        System.out.println("My Reflection Method called");
    }
}
public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, InstantiationException, IllegalAccessException, IllegalArgumentException, InvocationTargetException
{
        Class c=Class.forName("reflectionpackage.My");
        Method m=c.getDeclaredMethod("myReflectionMethod");
        Object t = c.newInstance();
        Object o= m.invoke(t);       
    }
} 
```

这将起作用，如需进一步参考，请点击链接 [http://compilr.org/java/call-class-method-using-reflection/](http://compilr.org/java/call-class-method-using-reflection/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T08:27:31.093

您应该首先使用[`Object.getClass()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#getClass%28%29)方法来获取[`Class`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html)对象。

然后你应该使用[`Class.getMethod()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getMethod%28java.lang.String,%20java.lang.Class...%29)and[`Class.getDeclaredMethod()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getDeclaredMethod%28java.lang.String,%20java.lang.Class...%29)来获取[`Method`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html)，最后使用[`Method.invoke()`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#invoke%28java.lang.Object,%20java.lang.Object...%29)来调用这个方法。

例子：

```
public class Tryout {
    public void foo(Integer x) { 
        System.out.println("foo " + x);
    }
    public static void main(String[] args) throws Exception {
        Tryout myObject = new Tryout();
        Class<?> cl = myObject.getClass();
        Method m = cl.getMethod("foo", Integer.class);
        m.invoke(myObject, 5);
    }
} 
```

> 我也想在运行时构造参数列表。例如，一种方法可以采用 2 个参数，另一种方法可以采用 n 个参数

这不是问题，只需为参数的*类型创建**数组*，以及参数值的数组，并将它们传递给and 。它之所以有效，是因为这些方法接受作为参数，并且数组适合它。`Class<?>`*`Object``getMethod()``invoke()``Class<?>...`*

 ** * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-02T08:33:32.670

好好看看`java.beans.Statement`和`java.beans.Expression`。有关详细信息，请参见[此处](https://stackoverflow.com/questions/10009052/invoking-setter-method-using-java-reflection/10009255#10009255)。*

# android - 在动态线性布局中设置 Imageview 的大小

> ID：12234444
> 
> 赞同：1
> 
> 时间：2012-09-02T08:24:01.287
> 
> 标签：android, android-layout, android-imageview

我正在动态创建一个线性布局并向其添加一些图像视图和文本视图。

代码

```
ScrollView sv = new ScrollView(this);

LinearLayout llay = new LinearLayout(this);

for(int i =0;i<ns;i++){
    TextView tv = new TextView(this);
    ImageView iv = new ImageView(this);
    iv.setLayoutParams(new LinearLayout.LayoutParams(100,100,50));

    llay.addView(tv);
    llay.addView(iv);
} 
```

在运行应用程序时

第一个设备：图像视图大小合适。

第二台设备：图像视图太小。

有什么办法，我可以明确设置图像视图的大小，使其变得独立于设备？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T11:22:56.890

尝试这个....

如果您的应用程序的 diff 大小密度使用显示高度/宽度而不是固定值。

```
Display display = getWindowManager().getDefaultDisplay();
      int height = display.getHeight()/10;
      int width = display.getWidth()/5;

ScrollView sv = new ScrollView(this);

LinearLayout llay = new LinearLayout(this);

for(int i =0;i<ns;i++){
    TextView tv = new TextView(this);
    ImageView iv = new ImageView(this);
    iv.setLayoutParams(new LinearLayout.LayoutParams(width,height,0));

    llay.addView(tv);
    llay.addView(iv);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:41:06.453

建议使用 dp 而不是 px。

有关 dp 与 px 的更多信息，您可以访问[支持多个屏幕](http://developer.android.com/guide/practices/screens_support.html)

在您的情况下，您以像素为单位设置值。如果要使用 dp ，可以使用以下命令：

```
float x = TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 100, getResources().getDisplayMetrics()); 
```

# susy-compass - 将 with-grid-settings 与断点一起使用的示例

> ID：12234446
> 
> 赞同：0
> 
> 时间：2012-09-02T08:24:23.063
> 
> 标签：susy-compass

我试图弄清楚如何根据断点使用不同的网格设置，但无法让它工作。这是我的代码。我正在使用 response-to mixin 进行媒体查询。

```
$breakpoints: 'screenSmall' 480px 768px,
              'screenMedium' 768px 1279px,
              'screenXlarge' 1441px;                                                   

$total-columns: 4;
$column-width: 5em;
$gutter-width: 1em;
$grid-padding: $gutter-width;

[role="main"] {
  @include container($total-columns);
  background: #aaa;
  @include susy-grid-background;
}

@include respond-to('screenSmall')
  @include with-grid-settings(8,4em,1.5em,1em) {
    [role="main"] { @include container; }
  };
}

@include respond-to('screenMedium')
  @include with-grid-settings(12,4em,1.5em,1em) {
    [role="main"] { @include container; }
  };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:59:45.250

究竟是什么不起作用？不同的断点根本没有变化，或者背景网格图像根本没有变化？我猜是后者。如果您希望背景响应新设置，则需要使用这些设置重新声明背景：

```
@include respond-to('screenSmall')
  @include with-grid-settings(8,4em,1.5em,1em) {
    [role="main"] { 
      @include container; 
      @include susy-grid-background;
    }
  };
}

@include respond-to('screenMedium')
  @include with-grid-settings(12,4em,1.5em,1em) {
    [role="main"] { 
      @include container; 
      @include susy-grid-background;
    }
  };
} 
```

当然，我认为您可以使用[断点](http://susy.oddbird.net/guides/reference/#ref-at-breakpoint)而不是响应更轻松地做到这一点。但这是一个不同的问题。:)

# magento - Magento - 自定义模型一对多关系

> ID：12234450
> 
> 赞同：2
> 
> 时间：2012-09-02T08:25:00.757
> 
> 标签：magento, module, one-to-many

我正在为 Magento 编写一个自定义模块，我需要在两个表之间实现一对多的关系。

最简单的解决方案是为每个表创建一个模型并分别保存数据，但我认为这种方法有一些限制（我更喜欢将数据保存在一个事务中而不是两个事务中，我想在加载集合时加载组合数据， ecc）。

处理这种情况的最佳方法是什么？是否可以有一个模型类从多个表中检索数据？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T12:49:42.420

如果 1-n 关系严格来说是数据构造而不是实体构造，则不需要相邻表的完整 ORM 表示。

在核心代码中找到灵感和示例通常是件好事，因此请参考`cms/page`和`cms/block`实体，尤其是它们的资源模型。以该[`Mage_Cms_Model_Resource_Page::_getLoadSelect()`](https://github.com/LokeyCoding/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Cms/Model/Resource/Page.php#L196)方法为例，资源模型调用该方法加载数据：

```
protected function _getLoadSelect($field, $value, $object)
{
    $select = parent::_getLoadSelect($field, $value, $object);

    $storeId = $object->getStoreId();
    if ($storeId) {
        $select->join(
                    array('cps' => $this->getTable('cms/page_store')),
                    $this->getMainTable().'.page_id = `cps`.page_id'
                )
                ->where('is_active=1 AND `cps`.store_id IN (' . Mage_Core_Model_App::ADMIN_STORE_ID . ', ?) ', $storeId)
                ->order('store_id DESC')
                ->limit(1);
    }
    return $select;
} 
```

注意连接，并注意它们分别有一个实体表 (`cms_page`和`cms_block`) - 顺便说一下，这是 ORM 所期望的 - 但是还有其他表包含 cms-entity-to-store 数据。（`cms_page_store`和`cms_block_store`）。后两个表中的记录不是由它们自己的 ORM 类表示的，而是由它们`cms/page`和`cms/block`模型的资源类更新、删除或连接以加载。

同样，是否通过指定的 ORM 类处理 SQL 的决定因素来自业务领域——如果“许多”表中的记录代表业务领域中需要表示或复杂表示的事物，则通过 ORM 访问它们。

# php - 替换数组键和值

> ID：12234454
> 
> 赞同：1
> 
> 时间：2012-09-02T08:25:32.940
> 
> 标签：php, arrays

例如我有这个数组：

```
Array (
[0] => Array (
 [id] => 45 [name] => Name1 [message] => Ololo [date_create] => 21:03:56 )
[1] => Array (
 [id] => 46 [name] => visitor [message] => Hi! [date_create] => 21:06:28 )
) 
```

我需要转换为：

```
Array (
 [id] => Array (
  [0] => 45, [1] => 46
 )
 [name] => Array (
  [0] => Name1, [1] => visitor
 )
 [message] => Array (
  [0] => Ololo, [1] => Hi!
 ) 
 [date_create] => Array (
  [0] => 21:03:56, [1] => 21:06:28
 )
) 
```

我想知道一个转换它的函数，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T08:28:45.647

试试这个代码块：

```
// Assuming the array you have is called $mainArray.
// The output will be $outputArray.
$outputArray = array();

foreach ($mainArray as $index => $array) { // Iterate through all the arrays inside the main array.
// foreach ($mainArray as $array) { // Use this if the numeric index order doesn't matter.
    foreach ($array as $key => $value) { // Iterate through each inner array.
        // Load the multidimensional array with the first key as one of (id, name, message, date_create) and second key as the numeric index (if you need it).
        $outputArray[$key][$index] = $value;
        // $outputArray[$key][] = $value; // Use this if the numeric index order doesn't matter.
    }
}

print_r($outputArray); 
```

# android - 适用于 Android 和 iOS 的 2D 跨平台游戏引擎？

> ID：12234457
> 
> 赞同：263
> 
> 时间：2012-09-02T08:25:47.650
> 
> 标签：android, ios, 2d, game-engine, marmalade

我用 Unity3d 工作了一段时间，发现它的 2D 部分与 OnGUI() 或 GUITextures 太笨拙了。此外，即使是在 Unity3d 上完成的最小游戏也至少需要 10MB 的下载量，这对于 2D 游戏来说实在是太大了。

所以，我目前正在寻找 2D 引擎。我已经尝试过 Cocos2D，但它只是 iOS，我不想将所有内容都重写为 Android 的另一种语言（因此，不能选择用于 Android 的 Cocos2d 的 Java 端口）。相反，我想编写一次代码，并在 iOS、Android 和可能的 Windows Phone 7 上轻松部署它。我有 Mac 和 Windows。

为了更详细，以下是我对引擎的要求：

*   必须是跨平台的
*   必须高效
*   应该是 C++、Java、C# 或 Objective C，因为我对它们很熟悉，而*不是*Flash、Javascript、HTML5，因为我不是网络开发人员
*   必须有一个大型社区、教程、其他库，这些库涵盖了您在 iOS 或 Android 上直接开发时所拥有的大部分内容（应用内计费、Facebook 等）
*   最终交付的包裹不能太大
*   引擎可以免费，但我也不介意支付合理的价格

我找到了以下引擎：

*   [Marmalade](http://www.madewithmarmalade.com/marmaladesdk)（以及基于它的[IwGame 引擎](http://www.drmop.com/index.php/iwgame-engine/)）- C++，对 Marmalade 的总体评价非常积极，但不确定 IwGame。**编辑（2013 年 3 月）**：看起来 Marmalade SDK 现在包括 Cocos2Dx 和一些内置 IDE，这使它变得更好（独立开发者每年花费 150 美元，这对我来说还可以）。
*   [Corona SDK](http://www.coronalabs.com/products/corona-sdk/) - Lua（效率存疑），也需要互联网连接来编译代码
*   [Cocos2d-x](http://www.cocos2d-x.org/) - C++，收到了很多来自开发者的评价，大部分都是正面的，很多人认为它最适合 2D
*   [粒子代码](http://www.particlecode.com/features/core-api/)-Java+Eclipse，未找到评论或评论
*   [Moai](http://getmoai.com/products/sdk/) - Lua，找不到任何评论/意见
*   [猴子引擎](http://jmonkeyengine.com/)- 似乎功能太少
*   [Haxenme](http://www.haxenme.org/) - 它是 Flash，我从未使用过，也不想使用
*   使用[Unity3d](http://unity3d.com/)，但使用 2D 软件包，如 2D Toolkit
*   [SDL](http://www.libsdl.org/)到[Android](http://www.anddev.org/sdl_port_for_android_sdk-ndk_16-t9218.html)（也在[这里](http://forums.libsdl.org/viewtopic.php?t=6471&sid=e8752d0c482fa77a95243b9210c9e33c)）和[iOS](http://immersedcode.org/2011/4/25/sdl-on-ios/)的端口- 看起来没有太多支持或当前的开发（？）
*   [GLBasic](http://www.glbasic.com/) - 基本语言，我不喜欢
*   [playN](http://code.google.com/p/playn/) - 似乎处于开发早期（？）
*   [Gamvas](http://gamvas.com/) - HTML5，对我来说看起来不像一个成熟的引擎
*   [Ignifuga](http://ignifuga.org/features/) - Python，看起来也不成熟
*   [ORX](http://orx-project.org/about) - 不确定它是否还在开发（？）
*   [Construct 2](http://www.scirra.com/construct2/event-editor) - 提醒 GameMaker，可能适用于快速原型，但绝对不适用于行业级游戏
*   [XNA](https://dev.windowsphone.com/en-us/downloadsdk)，然后使用[ExEn](http://andrewrussell.net/exen/)移植游戏（需要[Mono Touch](http://xamarin.com/monotouch)移植到 iOS 和[Mono for Android](http://xamarin.com/monoforandroid)移植到 Android） - C#，可能更适合来自 Microsoft 产品（如 xBox）的人（我来自 Android）。此外，对于小型开发人员来说，这些 Mono 工具的总成本为 800 美元
*   [Impact](http://impactjs.com/) - JavaScript，使用 HTML5。我不太喜欢 JavaScript（例如 Unity3d 上的首选 C#），也不确定效率，因为它在浏览器中运行（？）
*   [GameMaker](http://www.yoyogames.com/gamemaker/studio) - 自己的脚本语言 GML，我实际上记得它是为非程序员提供的工具。它是否真的成长为一个真正的引擎，我的意思是进行认真的开发？
*   [AppGameKit](http://www.appgamekit.com/) - C++，但似乎还是很新。没有找到任何关于它的评论
*   仅使用[Cocos2D](http://cocos2d.org/)和 Objective C 为 iOS 开发，然后使用[Stella SDK](http://www.yeecco.com/stella)为 Android 制作一个 APK 。有人做过吗？我很确定会有一些限制，那么 Google 在 Android 上的应用内计费、AdMob 和 Facebook 集成怎么样？
*   [Moscrif](http://moscrif.com/why-moscrif) - JavaScript，看起来更适合以前的 Web 开发人员
*   [Starling](http://gamua.com/starling/features/) - Flash 11，我不太喜欢 Flash
*   [ND2D](http://www.nulldesign.de/) - 还没有 1.0，它有很多功能吗？

因此，如果您能根据您使用引擎的经验发表评论，并建议列表中的哪一个（或我遗漏的任何其他内容）最适合所描述的要求，我会很高兴。我对某些引擎的第一印象也可能是错误的。

我目前认为 Marmalade+IwGame 是最好的选择，但由于我没有太多关于 Cocos2d-x 和粒子代码的信息，所以我不太确定。

谢谢！

**编辑（2013 年 6 月）**: 到目前为止，我制作了 2 个跨平台的 2D 游戏，并为两者使用了 Unity3D 和 2D Toolkit 插件。对于GUI简单的游戏，我使用了一个基于Unity自己的简单的自制GUI系统。对于更复杂的一个（例如 GUI 元素可以重叠的地方），我使用了 NGUI 插件。最近 2D Toolkit 为 GUI 添加了更多类，这非常方便，因为在将 NGUI 与 2D Toolkit 结合使用时，必须使用 2 个不同的系统来制作纹理图集。我肯定会在下一个 2D 游戏中尝试那个。为 2D 游戏选择 Unity3D 的主要原因是我已经深入 Unity3D，无论是经验还是积累的代码片段以供重用。此外，我为 3D 游戏购买了 Unity3D pro（带有 Android Pro 和 iOS Pro），只需额外支付 60 美元购买 2D 工具包即可获得 2D 游戏。我到目前为止还没有 不后悔我的决定，这似乎对我来说是最佳选择。唯一让我头疼的是使用 Prime31 的插件（Android 和 iOS 社交插件）添加社交功能，但我认为他们的错误不是 Prime31 的错，而是 Twitter/Facebook 的错，所以我可能会看到相同的错误任何其他引擎或插件。

**编辑（2014 年 1 月）**：我想 Unity 4.3 对我的问题的回答现在非常明显：Unity 的新精灵系统，也许还有 2DToolkit 完全击败了其他任何东西，特别是对于那些（像我一样）在 Unity 上待过一段时间的人并购买了带有附加组件的 Pro 版本。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-22T04:31:44.267

[LibGDX](http://www.libgdx.com/)是我用过的最好的引擎之一，几乎可以在所有平台上运行，在我做过的大多数测试中，它的执行速度是 cocos2d-x 的两倍。您可以使用任何您喜欢的 JVM 语言。[这是](http://steigert.blogspot.com)一个 13 部分的 Java 教程，还有一堆使用 jruby[的教程。](http://cbpowell.wordpress.com/)[这里](http://www.java-gaming.org/index.php?topic=27914.0)有一个很好的骨骼动画工具，它也支持平铺的 TMX 贴图。ui 框架很棒，它有一个类似于 cocos2d 场景、精灵和动作的场景图和演员样式 API。社区很棒，更新频繁，文档也很好。不要让 java 部分吓到你，它很快，你可以使用 jruby 或 scala 或任何你喜欢的东西。我强烈推荐它用于 2d 或 3d 工作，它支持两者。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-09-03T07:22:17.490

我合作过`Marmalade`，我觉得很满意。虽然它不是免费的，而且开发者社区也不够大，但你仍然可以使用它的教程来处理大部分任务。（一旦有时间，我也会写我的教程）。
`IwGame`是一个很好的引擎，由一位 Marmalade 用户开发。这对于基本游戏来说很好，但如果您正在寻找一些严肃的高级游戏内容，您也可以`Cocos2D-x`与 Marmalade 一起使用。我从来没有使用过 Cocos2D-x，但是 Marmalade 的`Github`.
Marmalade 的另一个好处是它`EDK (Extension Development Kit)`，它可以让您为所需的任何功能进行扩展，这些功能在本机代码中可用，但在 Marmalade 中不可用。一世'

**编辑**：
Marmalade 现在拥有自己的 RAD（快速应用程序开发）工具，仅用于 2D 开发，命名为[`Marmalade Quick`](http://www.madewithmarmalade.com/quick). 虽然编码将在 Lua 中而不是在 C++ 中，但由于它构建在 C++ Marmalade 之上，因此您可以轻松地包含 C++ 库和所有其他 EDK 扩展。`Cocos-2Dx`和扩展也`Box2D`预先包含在快速中。他们最近推出了它的发布版本（它是 3-4 个月的测试版）。我认为我们您真的只在寻找 2D 开发，您应该尝试一下。

**更新：**
Unity3D 最近推出了对 2D 游戏的支持，由于它的 GUI 和编辑器，这似乎比任何其他 2D 游戏引擎都要好。内置物理、精灵等支持。你可以看看它。

**更新 2**
Marmalade 将很快停止他们的 SDK 以支持他们的内部游戏制作。因此，依赖它不是一个明智的决定。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-09-03T12:29:06.443

您提到 Haxe/NME，但您似乎本能地不喜欢它。但是，我的经验是非常积极的。当然，API 是 Fl​​ash API 的重新实现，但您不仅限于以 Flash 为目标，还可以编译为 HTML5 或原生 Windows、Mac、iOS 和 Android 应用程序。Haxe 是一种令人愉悦的现代语言，类似于 Java 或 C#。

如果你有兴趣，我写了一些关于我使用 Haxe/NME 的经验：[link](http://qwokgames.com/2012/09/porting-from-html5-to-haxe-the-whys-and-the-hows/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-08-23T14:44:07.743

[V-Play](http://v-play.net/) (v-play.net) 是一个基于 Qt/QML 的跨平台游戏引擎，具有许多有用的 V-Play QML 游戏组件，用于处理多种显示分辨率和纵横比、动画、粒子、物理、多点触控、手势，寻路等等。[API 参考](http://v-play.net/doc/vplay-group.html) 引擎核心采用原生 C++ 编写，结合自定义渲染器，游戏在所有设备上均达到 60fps 的稳定性能。

V-Play 还为最成功的游戏类型（如塔防、平台游戏或益智游戏）提供即用型游戏模板。

如果您对使用 V-Play 制作的游戏感到好奇，以下是它们的快速选择：

*   [Squaby](http://games.v-play.net/squaby/)：塔防游戏
*   [鸡爆发](http://games.v-play.net/chickenoutbreak/)：像涂鸦跳跃这样的平台游戏
*   [Blockoban](https://play.google.com/store/apps/details?id=at.impossibru.blockoban)：益智游戏
*   [疯狂大象](https://play.google.com/store/apps/details?id=xom.xxmassdeveloper.CrazyElephant)：类似愤怒的小鸟的游戏
*   [Snowball Mania](https://play.google.com/store/apps/details?id=com.xxmassdeveloper.SnowballMania) : 多人动作游戏
*   [闪电战](https://play.google.com/store/apps/details?id=at.fhooe.mc.blitzkopf)：脑力游戏

（免责声明：我是 V-Play 背后的人之一）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-04T10:02:27.750

这只是 LinkedIn 上 Richard Pickup 对我的一个类似问题的回复：

> 我在 iOS 和 android 上都使用过 cocos 2dx marmalade 和 unity。对于 2d 游戏 cocos2dx 是每次都要走的路。Unity 对于 2d 游戏来说太过分了，正如已经说过的那样，marmalade 只是一个薄的抽象层，而不是真正的游戏引擎。你甚至可以在橘子酱上运行 cocos2d。我的方法是在 iOS 和 android 上使用 cocos2dx，然后在未来在橘子酱上运行 cocosd2dx 代码作为移植到 bb10 并赢得手机 7 的简单方法

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-07-30T07:08:19.577

几天前我发现了一个漂亮整洁的[Wave 游戏引擎。](http://www.waveengine.net/)它使用 C# 并具有 Windows Phone 和 Windows Store 转换器，这使它成为我 XNA 的绝佳替代品

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-20T16:03:24.240

[BadLogicGames](http://libgdx.badlogicgames.com/)的 LibGDX 呢？

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-04-18T13:26:57.007

查看 Loom ( [http://theengine.co](http://theengine.co) ) 是一个新的跨平台 2D 游戏引擎，具有设备上的热交换代码和资产。这意味着您可以在 Photoshop 中处理您的资产，您可以更新您的代码，修改您的应用程序/游戏的 UI，然后在应用程序运行时在您的设备上查看更改。

考虑到我听说过甚至玩过的其他跨平台游戏引擎，Loom 游戏引擎是迄今为止我认为最好的，具有许多出色的功能。大多数其他类似的游戏引擎（Corona SDK、MOAI SDK、Gideros Mobile）都是基于 Lua 的（至少对我来说语法很奇怪）。Loom 游戏引擎使用 LoomScripts，这是一种受 ActionScript 3 启发的脚本语言，具有从 C# 中借用的几个功能。如果您曾经使用 ActionScript 3、C# 或 Java 开发过，LoomScript 对您来说会很熟悉（而且我更喜欢这种语法而不是 Lua 的语法）。

Loom 游戏引擎的 1 年许可费用为 500 美元，我认为对于任何独立游戏开发者来说，这是一个可以承受的价格。几周前，他们也免费提供了 1 年的许可证。许可证到期后，您仍然可以使用 Loom 创建和部署您自己的游戏，但您不会获得任何进一步的更新。Loom 的创建者非常有信心，他们承诺会不断改进他们的孩子，使购买另一个许可证变得物有所值。

事不宜迟，以下是 Loom 的强大功能：

1.  跨平台（iOS、Android、OS X、Windows、Linux/Ubuntu）

2.  受 Rails 启发的工作流程让您可以花时间处理游戏（一个命令创建新项目，另一个命令运行它）

3.  快速编译器

4.  实时代码和资产编辑

5.  集成第三方库的可能性

6.  使用 Cocos2DX 进行渲染

7.  XML、JSON 支持

8.  用于设置 UI 元素样式的 LML（标记语言）和 CSS

9.  用户界面库

10.  依赖注入

11.  单元测试框架

12.  花栗鼠物理学

13.  实时查看您的更改使多设备开发变得容易

14.  小下载大小

15.  专为团队打造

你可以在这里找到更多关于 Loom 的视频：[http ://www.youtube.com/user/LoomEngine?feature=watch](http://www.youtube.com/user/LoomEngine?feature=watch)

也可以查看这 4 部分的深入教程：[http ://www.gamefromscratch.com/post/2013/02/28/A-closer-look-at-the-Loom-game-engine-Part-one-getting -started.aspx](http://www.gamefromscratch.com/post/2013/02/28/A-closer-look-at-the-Loom-game-engine-Part-one-getting-started.aspx)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-12-19T06:11:23.710

我试过 AppGameKit，它既是 c++ 又是 Basic。在 Basic 变体中编写 2d 游戏非常容易，包括物理、碰撞和堆更多。它也在积极开发中，而且非常便宜（65 美元）。主要问题是为 Android 编译真的很困难（你需要下载大量文件并遵循困难的指南之类的东西）我认为它还不足以用于商业用途，但对独立程序员有好处它有一个中等规模的社区

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-08-27T01:54:56.327

我目前将 Corona 用于商业应用程序并取得了巨大成功。就游戏而言，我的印象是它没有提供其他一些跨平台开发引擎所提供的性能。值得注意的是，Carlos（Ansca Mobile/Corona SDK 的创始人）已经在竞争引擎上创办了另一家公司；用于 Appcelerator Titanium 的 Lanica Platino 引擎。虽然我没有亲自处理过这个问题，但它看起来确实很有希望。但是请记住，它的价格为 999 美元/年。

综上所述，我研究 Moai 已经有一段时间了（因为我已经熟悉 Lua 语法），它看起来确实很有希望。它可以为多个平台编译，不仅限于移动环境，这一事实很有吸引力。

考虑到制作的游戏的复杂性和从中实现的性能，Multimedia Fusion 2 也是一个值得竞争的产品。我想到了Vincere Totus Astrum ( [http://gamesare.com )。](http://gamesare.com)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-09-10T18:58:22.830

最近我使用了一个 AS3 引擎：PushButton（现在已经死了，但它仍然可以使用，你可以使用其他东西）来完成这项工作。为了使其适用于 Android 和 iOS，该项目在 AIR 中针对这两个平台进行了编译，并且一切正常，没有性能损失。由于 Flash Builder 有点贵（249 美元），您可以使用 FlashDevelop（有一些教程可以用它在 AIR 中编译）。

Flash 可能是一种选择，因为它非常容易学习。

# xml - 如何获取 HTML/XML 中的属性？

> ID：12234460
> 
> 赞同：0
> 
> 时间：2012-09-02T08:26:14.310
> 
> 标签：xml, r, web-scraping

这是一段要解析的html：

```
<td style="text-align:center; color:black; background:#ff6666; border:2px solid #8811ff;"   title="Alkali metals; Primordial; Solid">
37  
<br />  
<a title="Rubidium" href="/wiki/Rubidium">Rb</a>  
</td>` 
```

我可以用`xmlValue`. 我得到的是：

```
text   br    a   
"19"   ""  "K" 
```

但是我想得到属性的值，在`td`, 的属性中`title`，值是*“碱金属；原始；固体”*，在`a`, 的属性中`title`，值是*“铷”*。

我怎么才能得到它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:53:02.747

您可以使用`xmlAttrs`或`xmlGetAttr`（详情请参阅`?xmlAttrs`）。

```
html <- '<td style="text-align:center; color:black; background:#ff6666; border:2px solid #8811ff;" title="Alkali metals; Primordial; Solid">37<br /><a title="Rubidium" href="/wiki/Rubidium">Rb</a></td>'
td <- xmlRoot(xmlParse(html))
xmlAttrs(td)["title"]
# "Alkali metals; Primordial; Solid"
xmlAttrs(xmlChildren(td)$a)["title"]
# "Rubidium

# or
xmlGetAttr(td, "title")
# "Alkali metals; Primordial; Solid" 
```

# javascript - 如何在谷歌地图 api v3 中获得没有公里的行驶距离

> ID：12234462
> 
> 赞同：0
> 
> 时间：2012-09-02T08:26:33.203
> 
> 标签：javascript, google-maps-api-3

我正在使用此代码从 google map api v3 获得行驶距离。

```
distance11 = response.routes[0].legs[0].distance.text; 
```

代码运行良好，但输出格式为 300km。我只需要数字 300。请帮我找到解决方案。

我已经尝试过放置 distance.value 和简单的距离，但它没有用。

编辑：.....

另外请告诉我如何使用javascript从变量中删除字符串。例如从 300 公里仅获得 300。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:30:30.780

对于这种特殊情况，您可以尝试

```
parseInt(distance11); 
```

`parseInt`自动删除数字后的尾随字符串。但如果你已经知道以`distance11`结尾`"km"`，你也可以这样做

```
distance11.slice(0, -2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T11:55:05.427

请参阅[文档](https://developers.google.com/maps/documentation/javascript/reference#Distance)，距离服务返回文本（您尝试使用）和以米为单位的数字。

如果你想要米以外的其他单位，你可以转换它。

# c# - 如何在属性对话框中添加自定义控件属性

> ID：12234464
> 
> 赞同：2
> 
> 时间：2012-09-02T08:27:24.810
> 
> 标签：c#

我想将属性添加到我的自定义控件中，例如上面带有描述的示例属性！我不知道用上面的 GUI 来显示它。我想知道使用什么属性。

```
 private bool IsNum = true;
[PropertyTab("IsNumaric")]
[Browsable(true)]
[Description("TextBox only valid for numbers only"), Category("EmSoft")]   
public bool IsNumaricTextBox
{
    set
    {
         IsNum = value;
    }
}

protected override void OnKeyPress(KeyPressEventArgs e)
{
    base.OnKeyPress(e);
    if (IsNum)
    {
        doStruf(e);   
    }
}

private void doStruf(KeyPressEventArgs e)
{
    if (!System.Text.RegularExpressions.Regex.IsMatch(e.KeyChar.ToString(), "\\d+") && !char.IsControl(e.KeyChar))
        e.Handled = true;
} 
```

我想将此显示为带有描述的属性工具框

像这样在属性框中

IsNumaric 真

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T12:54:23.680

该属性需要一个 Getter 才能显示在属性网格中：

```
private bool isNum = true;

[PropertyTab("IsNumaric")]
[Browsable(true)]
[Description("TextBox only valid for numbers only"), Category("EmSoft")] 
public bool IsNumaricTextBox {
  get { return isNum; }
  set { isNum = value; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:51:18.107

这很容易实现，您只需使用下面示例中的属性来装饰它：

```
[PropertyTab("IsNumaric")]
[DisplayName("NumericOrNot")]
[Category("NewCategory")]
public bool IsNumaricTextBox
{
     set
     {
         IsNum = value;
     }
} 
```

并使其工作，您需要使用以下方法：

```
using System.ComponentModel 
```

如果您不指定`Category`- 属性将显示在`Misc`类别下（请注意，默认情况下，属性按名称显示，而不是按类别显示）。在此示例中，属性将显示在下方`NewCategory`，并且属性的名称将是`NumericOrNot`。

# class - 处理代码在浏览器上不显示任何内容。不知道为什么

> ID：12234468
> 
> 赞同：0
> 
> 时间：2012-09-02T08:27:49.377
> 
> 标签：class, syntax, processing, shape, processing.js

有人知道这段代码有什么问题吗？它在浏览器中不显示任何内容。

我的意图是根据鼠标位置画出两只眼睛。所以我定义了一个 Eye 类，然后用变量`mouseX`and调用它的 draw 方法`mouseY`。但是，它在浏览器上没有显示任何内容。

另外，我想知道如何检测**浏览器的大小，**因为 screen.width 和 screen.height 似乎在浏览器中不起作用。

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="processing.js"></script>
<script type="text/processing" data-processing-target="mycanvas">

void setup(){
    size(400,400);
    smooth();
    background(225);
    }

if (mousePressed){
    Face.draw(mouseX,mouseY);}

class Face{
    float x,y,a;

    Face(float ax,float ay){
    x=ax;
    y=ay;
    a=random(1,5);}

    void draw{

        noFill();
        stroke(0);
        //eye1
        ellipse(x+2.2*a,y-a,a/2,a/2);
        //eyelashes1
        arc(x+2.2*a，y-.5*a,1.2*a,1.2*a,PI,2*PI)；
        //eyebrows1
        arc(x+3*a,y-.3,2*a,2*a,5/4*PI,9/4*PI);

        //eye2
        ellipse(x-2.2*a,y-a,a/2,a/2);
        //eyelashes2
        arc(x-2.2*a，y-.5*a,1.2*a,1.2*a,PI,2*PI)；
        //eyebrows2
        arc(x-3*a,y-.3,2*a,2*a,5/4*PI,9/4*PI);

    }

    }

</script>
</head>
<body></body>
<canvas id="mycanvas"></canvas>
</html> 
```

我是初学者，所以我不知道我的问题是否愚蠢。

但欢迎任何提示:)

顺便说一句，如何为stackoverflow上的代码添加颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T12:05:03.053

你的脚本有一些问题。

与html页面相关：

*   您必须在以下`header`部分声明文档的编码：`<meta charset="utf-8">`
*   该`canvas`元素应包含**在**html`body`中。

与处理代码相关：

*   处理脚本至少需要一个`setup()`函数和一个`draw()`函数。您在类中定义了一个`draw()`方法`Face`，但没有定义 main`draw()`函数（顺便说一句，您错过了`draw()`方法中的括号）。
*   该`mousePressed`功能应包含在 main`draw()`方法中。
*   您至少需要声明一个`Face`类的实例（在`setup()`函数内部）。例如：`Face myFace = new Face(10, 10);`。
*   您的方法中可能还有更多语法错误`draw()`......

我的建议：

*   从更简单的事情开始：从头开始编写的行越多，调试起来就越困难。尝试先画一个椭圆，然后逐步在代码中添加更多内容。
*   将处理脚本保存在单独的文件中。它更干净，您可以使用处理编辑器或[处理在线草图](http://sketch.processing.org/)对其进行调试：

```
 <!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="utf-8">
            <title>Testing testing</title>
            <script type="text/javascript" src="processing.js"></script>
        </head>

        <body>
            <canvas id="my-sketch" data-processing-sources="my-sketch.pde"></canvas>
        </body>
    </html> 
```

*   查看[本教程](http://processingjs.org/articles/PomaxGuide.html)以获取有关处理中的对象和类的一些想法。
*   处理中的语法与 java 非常相似，并且有更多资源可用于了解该语言的 OOP 基础知识。只是[谷歌它](https://www.google.com/search?q=java%20basic%20oop)。

对于语法高亮，[看这里](https://stackoverflow.com/editing-help#syntax-highlighting)。

# excel - Excel 工具将多个公式简化为一个公式

> ID：12234478
> 
> 赞同：2
> 
> 时间：2012-09-01T23:18:01.130
> 
> 标签：excel

假设在 MS Excel 中我们有包含值的单元格：

A1=3, A2=4

和带有公式的单元格：

**A3** =A1+A2

A4= **A3** *A1

是否有任何自动方式（宏或其他工具）可以将 A4 中的最后一个公式更改为：

A4=(A1+A2)*A1

因此，它将所有以前的函数嵌套在括号中，从工作表中的许多公式中创建一个长公式。最终公式将仅引用具有值的单元格（而不是公式）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T01:25:03.130

@iDevlop 很清楚您的答案是“否”，但使用说突出显示来识别带有公式的单元格（主页> 编辑 - 查找和选择、转到特殊、公式、确定）可能会有所帮助，然后使用公式 > 公式审计 - 跟踪先例。

# c++ - 无法使用 CreateFile 函数打开文件

> ID：12234480
> 
> 赞同：-1
> 
> 时间：2012-09-02T08:29:40.380
> 
> 标签：c++, file, winapi

好的，所以我一直在关注本教程：[http ://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=4422&lngWId=3](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=4422&lngWId=3)

到目前为止，我已经完成了所有工作，直到我需要将程序加载到 .raw 音频文件中。

以下是相关代码：

```
LPSTR loadAudioBlock(const char* filename, DWORD* blockSize)
{
HANDLE hFile = INVALID_HANDLE_VALUE;
DWORD size = 0;
DWORD readBytes = 0;
void* block = NULL;

//open the file

if((hFile = CreateFile((LPCWSTR)filename, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL)) == INVALID_HANDLE_VALUE)
    return NULL;

// get it's size, allocate memory, and then read it into memory

size = GetFileSize(hFile, NULL);
block = HeapAlloc(GetProcessHeap(), 0, size);
ReadFile(hFile, block, size, &readBytes, NULL);

CloseHandle(hFile);
*blockSize = size;
return (LPSTR)block;
} 
```

然后是我调用它的主要函数：

```
int _tmain(int argc, _TCHAR* argv[])
{
HWAVEOUT hWaveOut; //device handle
WAVEFORMATEX wfx; //struct for format info
MMRESULT result; // for waveOut return values
LPSTR block;
DWORD blockSize;

// first let's set up the wfx format struct

wfx.nSamplesPerSec = 44100; // rate of the sample
wfx.wBitsPerSample = 16; //sample size
wfx.nChannels = 2; // 2 channels = stereo
wfx.cbSize = 0; // no extra info
wfx.wFormatTag = WAVE_FORMAT_PCM; //PCM format
wfx.nBlockAlign = (wfx.wBitsPerSample >> 3) * wfx.nChannels;
wfx.nAvgBytesPerSec = wfx.nBlockAlign * wfx.nSamplesPerSec;

// then let's open the device

if(waveOutOpen(&hWaveOut, WAVE_MAPPER, &wfx, 0, 0, CALLBACK_NULL) != MMSYSERR_NOERROR)
{
    fprintf(stderr, "unable to open Wave Mapper device.\n");
    Sleep(1000);
    ExitProcess(1);
}

// if no errors then close it
printf("The Wave Mapper device was opened successfully!\n");

//load and play file
if((block = loadAudioBlock("ding.raw", &blockSize)) == NULL)
{
    fprintf(stderr, "Unable to load file\n");
    Sleep(1000);
    ExitProcess(1);
}
writeAudioBlock(hWaveOut, block, blockSize);
Sleep(1000);
waveOutClose(hWaveOut);
return 0;
} 
```

每次我运行程序时，我都会得到：“无法加载文件”输出。我在与我的 exe 相同的目录中有“ding.raw”文件。我也尝试过将完整路径设置为“C://path”和“C:/path”，但是编译器只是给了我更多关于无法加载 pdb 文件的错误。

有任何想法吗？我正在使用 Visual Studio 2012 Professional IDE 和编译器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:31:12.730

而不是使用标准`char`，你应该使用例如`_TCHAR`和`LPCTSTR`无处不在。这将使您传递的所有字符串和字符串指针都是正确的。

查看`argv`to 的参数`_tmain`，您会发现它使用`_TCHAR`了`char`. 这是因为 Windows 支持普通字符和 Unicode 字符，这取决于几个宏。有关更多信息，请参见[此处。](http://msdn.microsoft.com/en-us/library/c426s321%28v=vs.100%29.aspx)

因此，要解决可能是您的问题（因为您没有得到实际的错误代码，请参阅我的评论`GetLastError`），您应该像这样更改函数：

```
void *loadAudioBlock(LPCTSTR filename, DWORD* blockSize)
{
    // ...

    if((hFile = CreateFile(filename, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL)) == INVALID_HANDLE_VALUE)
    return NULL;

    // ...
} 
```

并这样称呼它：

```
// ...

void *block;

if((block = loadAudioBlock(_T("C:\\path\\ding.raw"), &blockSize)) == NULL)
{
    fprintf(stderr, "unable to open Wave Mapper device, error code %ld.\n", GetLastError());
    Sleep(1000);
    ExitProcess(1);
}

// ... 
```

如您所见，我还更改了返回类型，因为该文件是二进制文件并且没有任何可读文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:49:06.543

```
LPSTR loadAudioBlock(const char* filename, DWORD* blockSize)
{
     if((hFile = CreateFile(CA2T(filename), GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL)) == INVALID_HANDLE_VALUE)
return NULL;
} 
```

请参阅 ATL 转换宏： http: [//msdn.microsoft.com/en-us/library/87zae4a3%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/87zae4a3%28v=vs.80%29.aspx)仅转换 const char* LPCWSTR 不起作用。

# xcode - Set Button selector (on click event) at runtime ? (Cocoa : Mac Project)

> ID：12234485
> 
> 赞同：1
> 
> 时间：2012-09-02T08:31:59.070
> 
> 标签：xcode, cocoa, xcode4, xcode4.4

Any idea how to set button selector at runtime (on click event) for mac (Not IOS)

I have a view controller with a button declared as outlet :

```
#import <Cocoa/Cocoa.h>

@interface MyView : NSView
@property (assign) IBOutlet NSButton *MyBtn; 
```

i can access that buton with something like this :

```
MyView * v;
.
.
.
[v MyBtn] 
```

i didn't find "addTarget" choice like on cocoa touch. The only choice is "setTarget(id)"

I'm using Xcode 4.4.1 for osx mountain lion

any suggestion would be appreciated. thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:37:48.203

those two methods are what you are looking for.

*   (void)setTarget:(id)target;
*   (void)setSelector:(SEL)selector;

================

```
[myButton setSelector:@selector(myButtonClickEvent:)];

-(void) myButtonClickEvent:(id) sender{
       NSLog(@"button:%@ be clicked. :)", sender);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:39:45.903

You shall look at the [**NSControl** class reference](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSControl_Class/Reference/Reference.html#//apple_ref/occ/cl/NSControl) (from which **NSButton** inherits) for two separate methods `setTarget:` and `setAction:`.

You can do something like this in your code:

```
[MyBtn setTarget:self];
[MyBtn setAction:@selector(doStuff)]; 
```

take a look also at [this answer](https://stackoverflow.com/questions/4685886/cocoa-forcontroleventswhatgoeshere).

# assembly - x86 清除 IRQ 掩码挂起操作系统

> ID：12234487
> 
> 赞同：2
> 
> 时间：2012-09-02T08:32:10.097
> 
> 标签：assembly, operating-system, irq

我正在开发一个操作系统，我正在尝试让一个 PIC 计时器工作。它是一个在保护模式下运行的 32 位操作系统。这段代码挂起操作系统，（我不知道为什么，这就是我想要找出的）。我正在清除 IRQ0 掩码。这段代码有什么问题，还是 IDT 或 PIC 有问题？此外，我有几个软件中断处理程序工作得很好，所以我认为它与 IDT 无关。

```
 public static void IRQ_clear_mask(byte IRQline)
    {
        ushort port;
        byte value;

        if (IRQline < 8)
        {
            port = 0x21;
        }
        else
        {
            port = 0xA1;
            IRQline -= 8;
        }
        value = (byte)(GruntyOS.IO.Ports.Inb(port) & ~(1 << IRQline));
        GruntyOS.IO.Ports.Outb(port, value);
    }

mov byte [_NATIVE_IDT_Contents + 254], AL
        mov byte [_NATIVE_IDT_Contents + 255], AH
        mov dword EAX, irq_common_stub
        mov byte [_NATIVE_IDT_Contents + 0x100], AL
        mov byte [_NATIVE_IDT_Contents + 0x101], AH
        mov byte [_NATIVE_IDT_Contents + 0x102], 0x8
        mov byte [_NATIVE_IDT_Contents + 0x105], 0x8E 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:40:05.970

您应该始终尽可能缩短您的中断子例程。与 x86 架构一起使用的 PIC 将使用它的掩码同时处理相同优先级的中断，但是当中断发生在 ISR 内时就会出现问题。我认为可能是更好的方法是简单地提高一个标志（将一个可从 ISR 访问的变量设置为 True 或其他），并且在您的操作系统分配的量子之间，您可以如您所展示的那样刷新您的掩码。或者使用一个 quanta 来完成它，因为您的调度策略认为合适。如果您的操作系统不是抢占式的，您可能希望退出 ISR，进行刷新，然后返回到用户程序。

不过，您的问题似乎不是这个。您应该获得一个好的调试器或仿真器，以便能够了解您的情况会发生什么。

If an uninitialized interrupt is raised, this behavior can happen. You should check, with a debugger if you can, where your OS execution is when it crashes. Did it enter an generic IRQ function which stall the CPU? This is the default behavior on multiple embedded chips.

# .net - TCP连接死锁？忽略/死亡？

> ID：12234489
> 
> 赞同：0
> 
> 时间：2012-09-02T08:32:25.993
> 
> 标签：.net, tcpclient

我无法快速复制，但我知道如何复制。

当我的客户端连接到服务器并且我的客户端空闲很长时间（它等待服务器给它一个 msg 作为它订阅的东西）时，它正在使用`binaryread.ReadByte()`它被类型转换为一个枚举并在交换机中使用。在一段未知的时间后，服务器可能会向它发送一条消息，但由于连接已经空闲很长时间，服务器会收到异常并了解客户端已断开连接。客户端（仍在执行 ReadByte() 的交换机上）没有收到异常，只是坐在那里。它甚至没有意识到它已与服务器断开连接。

为什么不呢？我该如何解决这个问题？现在我直接使用networkstream（这是二进制读取正在使用的流），但我认为这不是正确的解决方案。

我该如何正确解决这个问题？

# configuration - 增加 Sublime Text 2 状态栏的字体大小？

> ID：12234491
> 
> 赞同：7
> 
> 时间：2012-09-02T08:32:55.697
> 
> 标签：configuration, ide, configuration-files, sublimetext2, sublimetext

是否可以增加 Sublime Text 的字体大小`status bar`？我做了一些搜索，并没有找到太多关于这个主题的东西。我有时会错过显示在其中的重要信息，`status bar`因为它太小了，我没有注意到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T08:45:03.693

据我所知，您应该为此修改主题设置。请看一下这个答案（在页面底部）[自定义界面字体](http://www.sublimetext.com/forum/viewtopic.php?f=3&t=8634)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-08-24T06:53:25.480

试试这个，它肯定会在 Sublime Text 3 中工作。导航到 Preferences -> Default File Preferences 。它会在 Sublime 文本中打开文件本身寻找“font Courier New 10”（对我来说行号：14）

只需将 10 更改为 X 大小。

# c# - 在 C# 中使用 'where' 继承

> ID：12234494
> 
> 赞同：-9
> 
> 时间：2012-09-02T08:33:38.867
> 
> 标签：c#, generics

任何人请详细解释以下代码：

```
internal class InternalClientProxy<TInterface> : 
    ClientBase<TInterface> where TInterface : class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:37:33.827

它是一个泛型类型约束。在这种情况下

```
where T : class 
```

表示 T 应该是一个引用类型。

有关约束的详细信息，请参见此处：[类型参数的约束（C# 编程指南）](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:37:58.207

这意味着您只能在您的`InternalClientProxy`

一些有用的链接可以更好地理解

[MSDN1](http://msdn.microsoft.com/en-us/library/ms379564%28v=vs.80%29.aspx) [MSDN2](http://msdn.microsoft.com/en-us/library/bb384067.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T08:38:49.570

为了跟进我的评论，[文档](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)解释了语法。

> **类型参数的约束（C# 编程指南）**
> 
> 当您定义一个泛型类时，您可以对客户端代码在实例化您的类时可用于类型参数的类型类型应用限制。如果客户端代码尝试使用约束不允许的类型来实例化您的类，则结果是编译时错误。这些限制称为约束。使用**where**上下文关键字指定约束。下表列出了六种类型的约束：
> 
> ...
> 
> `where T : class`类型参数必须是引用类型；这也适用于任何类、接口、委托或数组类型。

如果没有约束，泛型代码的行为可能会有所不同（除其他外），具体取决于是`TInterface`表示值还是引用类型。

# objective-c - 在我的 iPhone 应用中寻找下一个 youtube 视频

> ID：12234500
> 
> 赞同：0
> 
> 时间：2012-09-02T08:34:25.547
> 
> 标签：objective-c, youtube

我正在开发一个 iphone 应用程序，它可以使用网络视图播放 youtube 链接一切都很好。但除了它会自动转到下一个视频。有什么方法可以阻止这种情况。这是我的代码。

```
NSString *urlAddress = @"http://www.youtube.com/embed/wh0ZK5QJMWk"; //http://www.youtube.com/embed/wh0ZK5QJMWk 
NSURL *url = [[[NSURL alloc] initWithString:urlAddress] autorelease];
NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];

[self.webView loadRequest:requestObj]; 
```

谢谢

# jquery - 将一个 div 内容复制到另一个 div

> ID：12234501
> 
> 赞同：-4
> 
> 时间：2012-09-02T08:34:38.397
> 
> 标签：jquery

我是 jQuery 的新手。我想将一个 div 内容复制到另一个 div 而不给它们分配 id 或类名，即，单击 div 内容将被复制到一个变量，然后单击其他 div 变量内容应该被复制到该 div。

我想通过使用 jquery 来实现这一点。

编辑：
我试过这段代码：

```
<div>content</div>
<div>paste the above content here</div>​ 
```

* * *

```
div{
   width:100px;
   height:100px;
   border:1px solid black;
   cursor:pointer;
}​ 
```

但我不知道在 jquery 部分要实现什么。

请协助
提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:43:44.647

```
var buffer = '';

//onclick of a div
$('div').click(function(){
    if(buffer == ''){
        // the content will be copied to a variable
        buffer = $(this).text();
    } else {
        // click on other div the variable content should be copied to that div
        $(this).text(buffer);
    }
});​ 
```

[**演示**](http://jsfiddle.net/s6QrL/1/)

**UPD**：您可能想要替换`text()`to`html()`以复制您的全部内容`div`，而不仅仅是文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:41:35.470

您必须为任何元素（在您的情况下为 div）提供 id 或类名，以使用 jQuery 选择该特定元素。否则 jQuery 将如何识别您要插入数据的元素（在您的情况下为 div）。如果它们在您的页面中只有两个 div，即使它们没有类名或 id，您也可以使用页面内的 div 顺序访问它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T08:43:53.523

虽然从您的帖子中看不太清楚，但从您的[评论](https://stackoverflow.com/questions/12234501/copy-a-div-content-to-another-div/12234555#comment16395899_12234501)中猜测如下：

```
var _content;

$('tr:odd td:odd').on('click', function() {
   _content = $(this).html();
});

$('tr:even td:even').on('click', function() {
   $(this).html( _content );
}); 
```

# php - 根据生成表中的值更改复选框状态

> ID：12234504
> 
> 赞同：-1
> 
> 时间：2012-09-02T08:34:51.740
> 
> 标签：php, codeigniter

这是我生成表的代码：

```
foreach($list_user as $temp){
        $this->table->add_row(++$i,
        $temp->ID_user,
        $temp->nama,            
        $temp->email,
        form_checkbox('selected[]', $temp->active),
        anchor('user/update/'.$temp->ID_user, 'update', array('class'=>'update')).' '.
        anchor('user/delete/'.$temp->ID_user, 'delete', array('class'=>'delete', 
        'onclick' => "return confirm('Apa Anda yakin mau menghapus data user $temp->nama?')"))
        );
    } 
```

现在，如果我生成`$temp->active`无复选框，它将给我正确的值，如 1（活动）或 0（不活动）我的问题是：如何更改我的复选框的值，如果值为 1，它将自动检查，反之亦然反之亦然。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T08:58:17.360

使用`form_checkbox()`which 的第三个参数是布尔值：

```
form_checkbox('selected[]', $temp->active, $temp->active) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:03:04.573

form_checkbox() 函数具有以下参数：

```
form_checkbox('nameofcheckbox', 'value', BOOL); 
```

所以代码

```
form_checkbox('selected[]', '123', $temp->active); 
```

会产生

```
<input type="checkbox" name="selected[]" value="123" checked="checked" /> 
```

如果`$temp->active`值为 1

# android - 使用 WebView 的 Google+ 共享中断

> ID：12234506
> 
> 赞同：1
> 
> 时间：2012-09-02T08:35:09.370
> 
> 标签：android, webview, android-activity

在 Android 应用程序中，我希望使用 Google+ 共享 API，您可以通过导航到以下位置调用该 API：

```
https://plus.google.com/share?url=... 
```

如果我的应用启动这样的活动；

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(theUrl);
startActivity(intent); 
```

然后创建了一个浏览器，我在 Google+ 中看到了我的帖子。

另一方面，如果我尝试创建这样的活动：

```
Intent intent = new Intent();
intent.setData(theUrl);
intent.setClass(this,GoogleActivity.class);
startActivity(intent); 
```

其中 GoogleActivity 是一个 Activity，其 onCreate() 实例化了一个 WebView，并且该 WebView 加载了通过意图传递的 url，事情不起作用。我看到 WebView，它转到允许我分享提到的 url 的页面。我可以点击 Google+ 中的分享按钮，然后查看我的 Google+ 信息流，就像我在启动浏览器时所做的那样。但我没有在我的信息流中看到我的共享链接！

为什么这两种情况会有所不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:42:21.540

问题解决了。该问题与 WebView 无关。

我的 Android 浏览器使用一个帐户登录 Google，而 WebView 使用另一个帐户。哦。

WebView 非常适合它使用的帐户。

# signalr - SignalR - 处理断开连接的用户

> ID：12234507
> 
> 赞同：7
> 
> 时间：2012-09-02T08:35:26.873
> 
> 标签：signalr

嗨，

我在一个项目中使用 signalR 库来处理通知和聊天模块。我有一个数据库表来跟踪在线用户。

用于聊天的 HUB 继承了 IDisconnect，我在此断开用户连接。断开用户连接后，我向用户表示关于该事件的热情。此时，我检查断开连接的用户是否是客户端。如果是，那么我在 HUB 上调用一个方法来重新连接用户（只需更新表）。

我这样做是因为在当前的实现中，一旦用户关闭浏览器上的一个选项卡，它就会调用 Disconnect 任务，但他可以打开另一个选项卡。

我还没有测试过这个模块（有更大的请求），但是在我的开发服务器上，IDisconnect 事件和用户再次连接的请求之间可能需要几秒钟的时间。

我担心我的实现来处理与聊天断开连接的用户，但我看不到另一种改进方法。

如果可能的话，有人可以给我一个建议吗，或者这是我唯一的解决方案？

**更新**：我最终使用了一个单例类来存储来自 signalr 的所有用户及其连接 ID。这样，我可以在断开连接任务期间从用户那里获取 id（此时您没有任何 httpcontext 来获取用户信息，但是您始终可以从单例中的数组中获取带有 signalr 的连接 id 的用户 id班级）。

**20-02-2013**虽然上述解决方案可以完成工作，但我需要扩展我的项目。我的解决方案是使用 Redis 存储所有用户连接，并在断开连接事件时利用密钥过期时间。在重新连接期间，我检查密钥是否处于挂起状态（几分钟后到期）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T09:37:08.357

您可以查看[基于 SignalR 构建](http://jabbr.net)的多房间聊天应用程序 JabbR 如何解决此问题：[https ://github.com/JabbR/JabbR/blob/master/JabbR/Hubs/Chat.cs](https://github.com/JabbR/JabbR/blob/master/JabbR/Hubs/Chat.cs)

它基本上保持了 User<->ConnectionId 的 1:N 映射，因此当最后一个连接断开时，可以将用户标记为“离线”。

# arrays - 由可以连续排列的数字组成的子数组。

> ID：12234510
> 
> 赞同：2
> 
> 时间：2012-09-02T08:35:58.023
> 
> 标签：arrays, algorithm

找到长度为 W 的子数组，它由可以连续排列的数字组成。例如 - {4,5,1,5,7,6,8,4,1} 且 W 为 5，输出可以是 -{5,7,6,8,4}..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:02:44.123

一个长度为 W 的连续子数组，包含一个连续（但未排序）的序列，具有三个可用于构造有效算法的属性：

1.  子数组中有 W 个元素。
2.  子数组中的最大和最小数字之间的差异是`W-1`。
3.  子数组中没有重复的元素。

算法应该将两个指针提前到输入数组，并检查这些指针之间的子数组是否满足这三个属性。

1.  推进两个指针以保持指针之间的差异等于 W。
2.  在推进第一个指针的同时，将相应的数组元素放入一个集合（以控制重复项）和一个最小-最大队列（以控制数字范围）。
3.  如果在集合中找到重复项，则将第二个指针前进到这些重复元素中的第一个的位置，同时更新集合和队列。
4.  推进第二个指针，同时最大值和最小值之间的差值保持大于`W-1`，从集合和队列中删除相应的元素。
5.  当所有三个属性都为真时停止。

最小最大队列可以实现为一对最小最大堆栈，如[本答案](https://stackoverflow.com/a/7134189/1009831)中所述。集合可以实现为散列集（给出算法的 O(n) 预期复杂度），或二叉搜索树（给出 O(n log(n)) 最坏情况复杂度），或者作为bitset 和 ringbuffer - 只保留位，对应于最小值和最大值之间的元素，由队列报告（给出 O(n) 最坏情况复杂度）。

输入数组 {42,10,7,4,5,1,5,7,6,8,4,1} 和 W=5 的示例（“：”标记环形缓冲区的开始）。

```
subarray       bitset        rb_start     min  max
42             :1 0 0 0 0    42           42   42
10             :1 0 0 0 0    10           10   10 (with 42, max-min>W-1)
10 7            1 0:1 0 0    7            7    10
7 4             0 0 1 0:1    4            4    7  (with 10, max-min>W-1)
7 4 5           1 0 1 0:1    4            4    7
4 5 1           1:1 0 0 1    1            1    5  (with 7, max-min>W-1)
1 5             1:1 0 0 0    1            1    5  (5 is a duplicate)
5 7            :1 0 1 0 0    5            5    7  (with 1, max-min>W-1)
5 7 6          :1 1 1 0 0    5            5    7
5 7 6 8        :1 1 1 1 0    5            5    8
5 7 6 8 4       1 1 1 1:1    4            4    8  (success) 
```

# c++ - 如何从 MS Word 2007 中获取枚举类型值？

> ID：12234511
> 
> 赞同：0
> 
> 时间：2012-09-02T08:36:01.317
> 
> 标签：c++, qt, ms-word, word-2007

我需要在我的文档中获取当前页面，并设置范围。我发现可以这样做：

```
Range.Information(wdActiveEndPageNumber)     //example in C# 
```

但我有问题。在[文档](http://msdn.microsoft.com/en-us/library/office/bb148663%28v=office.12%29)中，信息作为属性可见。所以当我使用

```
QString number = myRange->property("Information(wdActiveEndPageNumber)").toString() 
```

我什么也得不到。我也尝试过dynamicCall，但都不起作用。像 Text 或 Start 这样的简单属性可以很好地工作，但我不知道如何处理这些枚举。

整个代码：

```
QAxObject *word, *doc;
word = new QAxObject("Word.Application", this);
word->setProperty("DisplayAlerts", false);
word->setProperty("Visible", true);
doc = word->querySubObject("Documents");
doc->dynamicCall("Open(const QString&)", "path to file");
QAxObject *act = word->querySubObject("ActiveDocument");
QAxObject *next = act->querySubObject("Content");
next->dynamicCall("Select()");
next->dynamicCall("Copy()");
QClipboard *clip = QApplication::clipboard();
myTextEdit->setText(clip->text());
QString number = next->property("Information(3)").toString();
QMessageBox::information(this, tr("cos"), tr("%1").arg(number)); //here i need to know how many pages i've got 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T16:27:05.813

好的，经过大量研究，我发现还没有可能从信息枚举中获取价值。也许在 Qt 的未来版本中，但现在我不得不在 Visual Basic 中创建库并从 C++ 代码调用函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-07T14:07:47.963

刚刚在这里找到了一个非常酷的答案： [http ://www.qtforum.org/article/31970/how-do-i-get-use-the-ienumerable-interface-in-qt.html](http://www.qtforum.org/article/31970/how-do-i-get-use-the-ienumerable-interface-in-qt.html)

这里再次给出答案。使用包含您的枚举的 returnList..

```
QAxObject *enum1 = returnList->querySubObject("_NewEnum");
IEnumVARIANT* enumInterface; //to get this, include <windows.h>
enum1->queryInterface(IID_IEnumVARIANT, (void**)&enumInterface);
enumInterface->Reset(); //start at the beginning of the list.
for (int i=0;i<returnList->dynamicCall("Count").toInt();i++)
{
    VARIANT *theItem;
    enumInterface->Next(1,theItem,NULL);
    QAxObject *item = new QAxObject((IUnknown *)theItem->punkVal);
    qDebug() << item->dynamicCall("Caption");
} 
```

# c++ - 可以调用的函数数组，例如 'funs[1]();'

> ID：12234514
> 
> 赞同：2
> 
> 时间：2012-09-02T08:36:59.750
> 
> 标签：c++, arrays, visual-studio-2010, callback, function-pointers

我正在开发一个 Visual C++ 2010 Express 控制台应用程序。

在我详细介绍之前，这里的摘要是：如何创建函数的数组/列表/向量并从该数组中调用它们？

所以我对函数指针有点困难。我正在编写一个“终端”类，该类又具有一个成员类“CommandMap”。CommandMap 类的目的是将函数的向量/数组和表示它们的字符串存储在另一个向量/数组中。我希望（仅）在类从向量调用它们时调用函数，但它仅在我将其添加到向量时执行，而不是在尝试调用它时执行。

我尝试为它定义一个类型：

```
typedef void (*CmdCallback)(); 
```

我声明了一个向量来包含它们：

```
vector<string> CmdNames;
vector<CmdCallback> CmdFuncs; 
```

我像这样添加它们：

```
// Map a new command
bool CommandMap::Map(string name, CmdCallback func)
{
    if (!IsNullOrSpace(name) && func != NULL)
    {
        if (!Exists(name))
        {
            CmdNames.push_back(name);
            CmdFuncs.push_back(func);
            return true;
        }
    }

    return false;
} 
```

我试着这样称呼他们：

```
// Get a command callback from its identifier
CmdCallback CommandMap::GetFunc(string name)
{
    int index = IndexOf(name);
    if (index == -1) return NULL;
    else return CmdFuncs.at(index);
}

// If the given string is a command indentifier
// it will invoke the associated callback.
bool CommandMap::Exec(string input)
{
    for each (string id in CmdStrings)
    {
        if (input == id)
        {
            CmdCallback cmd;
            cmd = GetFunc(id);
            cmd();
            return true;
        }
    }

    return false;
} 
```

我尝试使用这个：

```
CmdCallback SayHello()
{
    cout << "Hello World!" << endl;
    return NULL; // Forces me to return null, guessing since it's
                 // not 'void' but a 'void' pointer it must return something
}

int main(int argc, char *argv[])
{
    App = new Terminal(argc, argv);
    App->Commands->Map("say", SayHello);

    while (!App->ExecComplete)
    {
        App->WaitEnter();
        App->Commands->Exec("say");
        App->WaitEnter();
        App->ExecComplete = true;
    }

    return App->ExitCode;   
} 
```

这首先有效。当我尝试`Map()`它时，该函数被调用。当我`Exec()`“说”时，它找到了回调，但是当它试图调用它时，我得到了这个运行时错误，除了中断或继续选项之外，我看不到任何细节。它给我的代码是。

我非常想放弃我的方法并尝试一种新方法，也许我在使用 void 指针 typedef 时走错了路，我需要在我不喜欢的地方抛出一个“&”或“*”`Map()`参数列表。也许向量也不是最好的方法。

基本上，我在问如何创建一个可以（并且只能）通过从数组中引用它们来调用的函数数组。我对回调很糟糕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:41:02.180

您可以使用[std::functions](http://en.cppreference.com/w/cpp/utility/functional/function)，或者，如果您没有 C++11 支持，请使用[boost::function](http://www.boost.org/doc/libs/1_51_0/doc/html/function.html)。这些是函数对象包装器，可以很容易地从自由函数或成员函数构造。您可以将它们存储在标准库容器或简单数组中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T08:45:48.153

如果我理解正确，您实际上想要声明一个指向的指针`SayHello`具有您的函数向量所需的类型（即）。`void SayHello()``SayHello``void (*)()``CmdCallback`

# c++ - 清除图形的替代方法

> ID：12234515
> 
> 赞同：1
> 
> 时间：2012-09-02T08:37:11.947
> 
> 标签：c++, graphics

我一直在使用**cleardevice()**来清除图形......但它会产生几个问题

例如..我创建了一个背景，但我必须清除一些特定的元素，然后我必须使用另一个用户定义的函数***drawb(*** *)*来绘制背景并同时**cleardevice();** 制造很多问题

```
line(x,y,x1,y1);   //suppose this line is to be erased 
                   //but using cleardevice even clears the background   
cleardevice();
drawb();  //to draw board or background 
```

所以我想知道另一种方法（一种只清除线条而不是背景的方法）（如果存在）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:31:09.243

一旦绘制了一条线，就没有真正的方法可以将其删除（除非您使用[XOR 模式](http://www.cs.colorado.edu/~main/bgi/doc/setwritemode.html)进行绘制！）。但是，您可以做一些事情。您可以在页面中呈现除行之外的所有内容并将其存储在那里。然后，在另一个页面中渲染所有内容，包括行。因此，如果要撤消该行，只需将页面切换回即可。

一个例子：

```
setactivepage(0);
// draw stuff, including background
setactivepage(1);
// draw stuff, including background and line
setvisualpage(0); // no line visible
setvisualpage(1); // line visible 
```

此外，如果您想用背景重置屏幕，则无需执行 a `cleardevice()`，因为它会`drawb()`覆盖每个像素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-15T11:20:10.390

您可以在画线之前先拍摄图像，`getimage()` 并在您想隐藏图像时将该图像放在线上。这不会改变您的背景，也不会轻弹它。`putimage()`可以放图。

# xml - 将 LaTeX 转换为 XML elisp

> ID：12234517
> 
> 赞同：1
> 
> 时间：2012-09-02T08:37:20.093
> 
> 标签：xml, regex, latex, elisp

我是 Elisp 的新手，我需要将一段 LaTeX 代码转换为 XML。

乳胶：

```
\tag[read=true]{Please help}\tag[notread=false]{Please help II} 
```

XML:

```
<tag read='true'> Please help </tag>
<tag notread='false'> please help </tag> 
```

我写了一些正则表达式来搜索和查找`\tag`，但现在我需要以某种方式读取`read`并将`notread`它们分配为属性，然后在“=”之后读取它们的值。我尝试过的正则表达式：

```
[..] (while (re-search-forward "\\\\\\<tag\\>\\[" nil t) [..] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T06:25:01.613

这不是一个完整的解决方案，但希望演示如何将反向引用与正则表达式一起使用。

简而言之，您在正则表达式中创建的每个组都会`\\(...\\)`被捕获，并且可以用 调用`(match-string N)`，其中`N`是组的序号，从最左边的左括号开始，然后继续进行，以使每个左括号的数字高于以前的。

（所以如果你有交替，一些反向引用将是未定义的。如果你将正则表达式`"\\(foo\\)\\|\\(bar\\)"`应用于字符串`"bar"`，`(match-string 1)`将为空，并且`(match-string 2)`将为`"bar"`。）

```
(while
    (re-search-forward
     "\\\\\\<\\(tag\\)\\>\\[\\([^][=]*\\)=\\([^][]*\\)\\]{\\([^}]*\\)}"
     nil t)
  (insert (concat "<" (match-string 1) " "
          (match-string 2) "='" (match-string 3) "'>"
          (match-string 4)
          "</" (match-string 1) ">\n") ) ) 
```

那个正则表达式当然是一个怪物。您可能需要对其进行分解和记录。

```
(defconst latex-to-xml-regex
  (concat "\\\\"                ; literal backslash
          "\\<"                 ; word boundary (not really necessary)
          "\\(tag\\)"           ; group 1: capture tag
          "\\["                 ; literal open square bracket
          "\\("                 ; group 2: attribute name
            "[^][=]*"             ; attribute name regex
          "\\)"                 ; group 2 end
          "="                   ; literal
          "\\("                 ; group 3: attribute value
            "[^][]*"              ; attribute value regex
          "\\)"                 ; group 3 end
          "\\]"                 ; literal close square bracket
          "{"                   ; begin text group
          "\\("                 ; group 4: text
            "[^}]*"               ; text regex
          "\\)"                 ; group 4 end
          "}"                   ; end text group
          ) "Regex for `latex-to-xml` (assuming your function is called that)") 
```

# r - 密度图下的面积不等于 1

> ID：12234523
> 
> 赞同：5
> 
> 时间：2012-09-02T08:38:28.803
> 
> 标签：r, ggplot2

我正在尝试使用 ggplot 绘制概率密度图。我的问题是曲线下的面积不等于一。建议表示赞赏。

示例图表...生成此图表的代码如下... Y 轴看起来像是对小型箱的计数，而不是落入该箱的概率。[此处](http://had.co.nz/ggplot2/stat_density.html)的示例代码是我在准备此图表时使用的资源之一。

![在此处输入图像描述](../Images/3ad93d1c20f7f05600d46852aaff0a87.png)

示例代码......其中大部分是数据......代码的关键位在底部......

```
library(ggplot2)
library(reshape)
library(plyr)
library(scales)

Date <- as.Date(
    c("1976-01-16", "1976-02-15", "1976-03-16", "1976-04-15", "1976-05-16",
      "1976-06-15", "1976-07-16", "1976-08-16", "1976-09-15", "1976-10-16",
      "1976-11-15", "1976-12-16", "1977-01-16", "1977-02-14", "1977-03-16",
      "1977-04-15", "1977-05-16", "1977-06-15", "1977-07-16", "1977-08-16",
      "1977-09-15", "1977-10-16", "1977-11-15", "1977-12-16", "1978-01-16",
      "1978-02-14", "1978-03-16", "1978-04-15", "1978-05-16", "1978-06-15",
      "1978-07-16", "1978-08-16", "1978-09-15", "1978-10-16", "1978-11-15",
      "1978-12-16", "1979-01-16", "1979-02-14", "1979-03-16", "1979-04-15",
      "1979-05-16", "1979-06-15", "1979-07-16", "1979-08-16", "1979-09-15",
      "1979-10-16", "1979-11-15", "1979-12-16", "1980-01-16", "1980-02-15",
      "1980-03-16", "1980-04-15", "1980-05-16", "1980-06-15", "1980-07-16",
      "1980-08-16", "1980-09-15", "1980-10-16", "1980-11-15", "1980-12-16",
      "1981-01-16", "1981-02-14", "1981-03-16", "1981-04-15", "1981-05-16",
      "1981-06-15", "1981-07-16", "1981-08-16", "1981-09-15", "1981-10-16",
      "1981-11-15", "1981-12-16", "1982-01-16", "1982-02-14", "1982-03-16",
      "1982-04-15", "1982-05-16", "1982-06-15", "1982-07-16", "1982-08-16",
      "1982-09-15", "1982-10-16", "1982-11-15", "1982-12-16", "1983-01-16",
      "1983-02-14", "1983-03-16", "1983-04-15", "1983-05-16", "1983-06-15",
      "1983-07-16", "1983-08-16", "1983-09-15", "1983-10-16", "1983-11-15",
      "1983-12-16", "1984-01-16", "1984-02-15", "1984-03-16", "1984-04-15",
      "1984-05-16", "1984-06-15", "1984-07-16", "1984-08-16", "1984-09-15",
      "1984-10-16", "1984-11-15", "1984-12-16", "1985-01-16", "1985-02-14",
      "1985-03-16", "1985-04-15", "1985-05-16", "1985-06-15", "1985-07-16",
      "1985-08-16", "1985-09-15", "1985-10-16", "1985-11-15", "1985-12-16"))

GOLD <- c(
  -0.104,  0.051,  0.011, -0.035, -0.008, -0.010, -0.065, -0.067,  0.041,  0.017,
   0.126,  0.023, -0.011,  0.029,  0.087,  0.007, -0.016, -0.044,  0.048, -0.013,
   0.030,  0.062, -0.029,  0.042,  0.078,  0.028,  0.031, -0.045,  0.005,  0.043,
   0.028,  0.090,  0.030,  0.072, -0.094,  0.009,  0.093,  0.080, -0.014, -0.013,
   0.077,  0.084,  0.058,  0.021,  0.184,  0.097,  0.002,  0.169,  0.474, -0.014,
  -0.168, -0.067, -0.007,  0.169,  0.071, -0.025,  0.077, -0.022, -0.059, -0.044,
  -0.063, -0.103, -0.003, -0.008, -0.031, -0.040, -0.113,  0.005,  0.081, -0.014,
  -0.057, -0.009, -0.062, -0.026, -0.117,  0.061, -0.046, -0.058,  0.080,  0.076,
   0.190, -0.031, -0.019,  0.074,  0.079,  0.022, -0.144,  0.030,  0.013, -0.057,
   0.026, -0.017, -0.012, -0.042, -0.030,  0.015, -0.043,  0.041,  0.022, -0.032,
  -0.011,  0.001, -0.083,  0.004, -0.019, -0.002,  0.003, -0.065, -0.063,  0.017,
  -0.044,  0.134, -0.022, -0.014, -0.008,  0.033, -0.014,  0.017, -0.004, -0.023)

df <- data.frame(Date=Date, GOLD=GOLD)

p <- ggplot(data=df, aes(x=GOLD, y=..density..)) +
    stat_density(fill='grey50') +
    xlab('Percent change on previous month') +
    ylab('Density') +
    opts(title='Change in Gold Price in the US')
ggsave(p, width=8, height=4, filename='plot.png', dpi=125) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T23:59:17.853

我认为这不是 ggplot 的问题，而是您对密度图中 y 轴的理解。R中的基本绘图功能绘制相同的东西。您可以将调用设置`y=..scaled..`为给您一个相对密度，但如果您使用`stat_bin()`，您会看到实际的直方图并注意到它不是计数。如果你愿意，你可以用这样的方式规范你的数据：

```
GOLD_N <- (GOLD- mean(GOLD))/sd(GOLD)
df <- data.frame(Date=Date, GOLD=GOLD,GOLD_N=GOLD_N) 
```

然后运行你的情节，它看起来像这样： ![在此处输入图像描述](../Images/e9985ede1db98d24bc9f320765a98a12.png)

您应该观看有关如何解释密度函数 的视频[http://www.youtube.com/watch?v=Fvi9A_tEmXQ](http://www.youtube.com/watch?v=Fvi9A_tEmXQ) 但是，如果您习惯于盯着 PDF 和总和为 1。但不要误解 y 轴。y 不是从密度中随机抽取的值等于 x 的概率。

# jsp - 如何添加自定义代码以在 jsp 中运行？

> ID：12234525
> 
> 赞同：2
> 
> 时间：2012-09-02T08:38:53.297
> 
> 标签：jsp, jakarta-ee, code-injection

我想在 jsp 中运行自定义函数。而且我想不时更改该功能而无需重新上传整个程序。我怎样才能做到这一点？我说的是诸如将代码上传到数据库并在需要时在数据库中执行代码之类的事情。我怎样才能在jsp中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T22:20:05.570

这是一篇相关文章[将字符串转换为代码](https://stackoverflow.com/questions/935175/convert-string-to-code)

您的一些选项是[javaassist](http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/)、[BeanShell](http://www.beanshell.org/intro.html)，甚至可以实现[JavaCompiler](http://docs.oracle.com/javase/6/docs/api/javax/tools/JavaCompiler.html)接口。

这个选择由你

# java - Java编写单元测试以在用户在控制台中退出时退出程序

> ID：12234526
> 
> 赞同：3
> 
> 时间：2012-09-02T08:39:02.680
> 
> 标签：java, mocking, mockito

我发现为这种方法编写单元测试真的很难，当用户键入退出命令时它基本上退出程序。

系统退出类：

```
public class SystemExit {
    public void exit(int status) {
        System.exit(status);
    }
} 
```

我的静态方法：

```
public static void exitWhenQuitDetected() {
final SystemExit systemExit = new SystemExit();
final String QUIT = "quit";
String line = "";
try {
    final InputStreamReader input = new InputStreamReader(System.in);
    final BufferedReader in = new BufferedReader(input);
    while (!(line.equals(QUIT))) {
        line = in.readLine();
        if (line.equals(QUIT)) {
            System.out.println("You are now quiting the program");                  
            systemExit.exit(1);
        }
    }
} catch (Exception e) {
    System.err.println("Error: " + e.getMessage());
}
} 
```

这里有些东西不太对劲，因为我正在努力对方法 exitWhenQuitDetected 进行单元测试（我正在使用 Mockito 进行模拟）。我将如何模拟 InputStreamReader 并验证 SystemExit.exit 方法在看到退出时被调用？你能解释一下吗？谢谢。

添加了我目前正在进行的测试，它不起作用。

```
 @Test
@Ignore
public void shouldExitProgramWhenTypeQuit() {
    String quit = "quit";           
    SystemExit systemExit = mock(SystemExit.class);
    try {
        BufferedReader bufferedReader = mock(BufferedReader.class);
        when(bufferedReader.readLine()).thenReturn(quit + "\n");
        SomeClass.exitWhenQuitDetected();
        verify(systemExit, times(1)).exit(1);
    } catch (IOException e) {           
        e.printStackTrace();
    }       
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:26:13.753

您应该将[PowerMockito](http://code.google.com/p/powermock/wiki/MockitoUsage13)罐子包含到您的项目中，而不仅仅是普通的 Mockito。Powermock 库是为模拟静态和/或最终类和方法而设计的。

以下[这篇博](http://loongest.com/powermock/mock-static-void-method/)文包含描述与您的类似场景的示例代码。

本质上，您需要一个类似于此的测试类...

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({System.class, ClassToTest.class})
public class SystemExitTest {

    @Test
    public void shouldCallSystemExit() {

        PowerMockito.mockStatic(System.class);

        ClassToTest.methodToTest();

        PowerMockito.verifyStatic();

        System.exit(0);

        System.out.println("If this message displays them System.exit() was mocked successfully");
    }    
} 
```

鉴于这个简单的实现类......

```
public class ClassToTest {

    public static void methodToTest() {
        // do some stuff
        System.exit(0);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:58:54.230

没有真正的方法来测试你`SystemExit`的类，因为执行它会导致 JVM 退出。您也许可以使用`SecurityManager`检测并拒绝 的a 来做一些事情`System.exit()`，但是要测试一行代码，这将是一大堆工作。

你做了正确的事——你把功能拉进了一个小班。如果我是你，我会在上面放一个接口，并通过接口将其注入到解析代码中。然后在您的测试中，您可以注入一个模拟并测试您的解析代码是否`exit()`使用正确的退出代码调用模拟上的方法。

恕我直言，类中的代码`SystemExit`很小且独立，无需测试即可查看和推理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T22:11:46.087

您已经完成了 90% 的工作，方法是将实际退出的代码放在一个没有自己逻辑的单独类中。您的困难是由您使用静态方法引起的。

我建议制作`exitWhenQuitDetected`非静态的。将它放在一个类中，您可以在需要时对其进行实例化，并且可以使用模拟的`SystemExit`. 像这样的东西。

```
public class SomeClass{
  private final SystemExit exiter;
  private final static String QUIT = "quit";
  public SomeClass(){
    this(new SystemExit());
  }

  SomeClass(SystemExit exiter){
    this.exiter = exiter;
  }

  public static void exitWhenQuitDetected() {    
    String line = "";    
    try {    
      final InputStreamReader input = new InputStreamReader(System.in);    
      final BufferedReader in = new BufferedReader(input);    
      while (!(line.equals(QUIT))) {    
        line = in.readLine();    
        if (line.equals(QUIT)) {    
          System.out.println("You are now quiting the program");                      
          exiter.exit(1);    
        }    
      }    
    } catch (Exception e) {    
      System.err.println("Error: " + e.getMessage());    
    }    
  }       

  // ...
} 
```

然后，在您的测试中，您可以模拟`SystemExit`，并使用包私有构造函数`SomeClass`来创建一个对象，该对象将使用您的模拟作为其`exiter`. 然后，您可以运行您的测试，并`verify`在您的 mock 上运行`SystemExit`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T19:35:14.037

提供了大量的技术解决方案。我想指出另一个观点：

这段代码不应该真正进行单元测试。

从单元测试中获得的最大收获是将它们应用于复杂的业务代码，尤其是在有很多分支的情况下。

在代码很简单的情况下，我建议不要围绕它编写单元测试，因为它根本没有足够高的投资回报。您的案例实际上加剧了我的主张，想想您测试这样的简单代码并将其与收益进行比较所花费的精力......这真的值得付出努力吗？这真的会让你更信任自己的代码吗？

# postgresql - 从 PostgreSQL 与 Informix 通信？

> ID：12234529
> 
> 赞同：0
> 
> 时间：2012-09-02T08:39:44.817
> 
> 标签：postgresql, informix

请帮助我设置从 PostgreSQL 到 Informix（两者的最新版本）的连接。我希望能够从 PostgreSQL 对 Informix 执行查询。我正在寻找一种不需要为每个查询导出数据（从 Informix）和导入（到 PostgreSQL）的解决方案。

我是 PostgreSQL 的新手，需要详细说明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T14:31:36.943

正如克里斯特拉弗斯所说，你想做的事情并不容易。

理论上，如果您正在使用 Informix 并需要访问 PostgreSQL，您可以（购买和）使用 Enterprise Gateway Manager (EGM) 并使用 PostgreSQL 的 ODBC 驱动程序来允许 Informix 连接到 PostgreSQL。EGM 在实际访问 PostgreSQL 时会尽最大努力看起来像是另一个 Informix 数据库。（我尚未验证是否支持 PostgreSQL，但 EGM 基本上需要 ODBC 驱动程序才能工作，所以应该没有任何问题——可能是“著名的遗言”。）这将包括 2PC（两阶段犯罪）; 不完美，但适度接近。

对于反向连接（使用 PostgreSQL 并连接到 Informix），您需要查看 PostgreSQL 工具套件或其他来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T09:04:08.990

你还没有说你使用的是哪个版本。有一些限制需要注意，但有多种选择。

既然你说这是导入/导出，我会假设只读选项是不够的。这排除了 PostgreSQL 9.1 的外部数据包装系统。

根据您的版本，David Fetter 的 DBI-Link 可能适合您的需求，因为它可以对远程表执行查询（请参阅[https://github.com/davidfetter/DBI-Link](https://github.com/davidfetter/DBI-Link)）。它已经有一段时间没有更新了，但是实现应该非常稳定并且可以跨版本使用。如果失败，您可以使用不受信任的语言（PL/PythonU、PL/PerlU 等）编写存储过程以连接到 Informix 并在那里运行查询。请注意，在这种情况下您将遇到有关事务处理的限制，因此您可能希望使用延迟约束触发器对其他表运行任何查询，以便在提交时运行所有内容。

编辑：我想到了一种更简洁的方法：使用外部数据包装器进行导入，使用单独的客户端应用程序进行导出。

在这种方法中，您将拥有四个基本组件，但这将是松散耦合的，并受到适当的事务控制。如果需要，您甚至可以使用两阶段提交。这四个组件是（这里没有提供完整的工作示例，但至少是一个路线图）：

1.  用于数据导入的外部数据包装器，允许您查看来自 Informix 的数据。
2.  要导出的数据的视图。
3.  管理导出方面的外部应用程序，以您选择的语言编写。这在一个频道上收听`LISTEN export_informix;`
4.  基础表上的触发器，这些表可以查看要导出的数据，这会引发`NOTIFY export_informix`

通知是在提交时发出的，所以基本上你的事务有两个阶段：

1.  在 PostgreSQL 中写入数据，标记要导出的数据。犯罪。
2.  从 PostgreSQL 读取数据，导出到 Informix。双方都提交（TPC？）。

# android - Android ViewAnimator 和 OutOfMemoryError

> ID：12234531
> 
> 赞同：3
> 
> 时间：2012-09-02T08:39:50.547
> 
> 标签：android, out-of-memory, viewanimator

情况是这样的：我有一个具有三种不同布局的 ViewAnimator。每个布局都有不同的背景图像。对于 xhdpi 设备，图像大小为 1280x800 像素，大小约为 150KB。现在的问题是：当我以 1280x800 的大小和 320dp 的密度启动模拟器时，我总是收到这个异常：

```
09-02 08:22:46.408: D/dalvikvm(1291): GC_EXTERNAL_ALLOC freed 428K, 51% free 2874K/5831K, external 18484K/20407K, paused 83ms
09-02 08:22:46.419: E/dalvikvm-heap(1291): 1366400-byte external allocation too large for this process.
09-02 08:22:46.498: I/dalvikvm-heap(1291): Clamp target GC heap from 25.089MB to 24.000MB
09-02 08:22:46.498: E/GraphicsJNI(1291): VM won't let us allocate 1366400 bytes
09-02 08:22:49.208: E/AndroidRuntime(1291): java.lang.OutOfMemoryError: bitmap size exceeds VM budget 
```

有人为我的问题提供解决方案或解决方法吗？我读了一些关于 BitmapFactory 的东西。它有帮助吗？最好的祝福！

**编辑：**这是我的代码：布局文件 main_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:gravity="center"
android:orientation="vertical" >

<ViewAnimator
    android:id="@+id/viewAnimator"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

   <LinearLayout
        android:id="@+id/LayoutMain"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:gravity="center"
        android:orientation="vertical"
        android:background="@drawable/background"
        ...some Buttons etc. ...
   </LinearLayout>

   <LinearLayout
        android:id="@+id/layoutGameMenu"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:gravity="center"
        android:orientation="vertical"
        android:background="@drawable/gameMenu"
        ...some Buttons etc. ...
   </LinearLayout>

   <LinearLayout
        android:id="@+id/layoutHighscores"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
        android:background="@drawable/highscores"
        ...some ListViews etc. ...
   </LinearLayout>

</ViewAnimator>
</LinearLayout> 
```

和 MainActivity：

```
private ViewAnimator va;   

@Override
public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     setContentView(R.layout.main_layout);
     va = (ViewAnimator) findViewById(R.id.viewAnimator);
     ....
}

....
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if(event.getKeyCode() == KeyEvent.KEYCODE_BACK) {
        if (va.getCurrentView() == findViewById(R.id.layoutHighscores)) {
            va.setInAnimation(inFromRight);
            va.setOutAnimation(outToLeft);
            va.setDisplayedChild(0);
            return true;
        }
        if (va.getCurrentView() == findViewById(R.id.layoutGameMenu)) {
            va.setInAnimation(inFromLeft);
            va.setOutAnimation(outToRight);
            va.setDisplayedChild(0);
            return true;
        }
    } 
    return super.onKeyDown(keyCode, event);
} 
```

有了这个，我可以在主菜单、高分和带有按钮的游戏菜单之​​间切换以启动游戏模式。我选择这个是因为我想要“酷”的视图动画。

我试图用 BitmapFactory 方法解决它，但没有任何变化。

```
public static Bitmap decodeSampledBitmapFromResource(Resources res, int resId, int reqWidth, int reqHeight) {

    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeResource(res, resId, options);

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeResource(res, resId, options);
}

public static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {
// Raw height and width of image
final int height = options.outHeight;
final int width = options.outWidth;
int inSampleSize = 1;

if (height > reqHeight || width > reqWidth) {
    if (width > height) {
        inSampleSize = Math.round((float)height / (float)reqHeight);
    } else {
        inSampleSize = Math.round((float)width / (float)reqWidth);
    }
}
return inSampleSize;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T13:57:38.067

*在 Android 主站点的Android 培训*部分中有一堂课涵盖了这种情况。本课“[高效显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)”分为四个部分，包括工作示例，并支持 API 级别 7 及更高级别（我认为这不是问题。）

如果那没有帮助，我建议发布一些代码，以便提供更具体的帮助。;-)

# c++ - 用 pcap 捕捉跟不上？

> ID：12234533
> 
> 赞同：1
> 
> 时间：2012-09-02T08:40:21.810
> 
> 标签：c++, objective-c, pcap, libpcap

对于我为 OSX 构建的一个小工具，我想捕获从某个以太网控制器发送和接收的数据包的长度。

当我获取以太网卡时，我还会获得额外的信息，例如最大数据包大小、链接速度等。

当我启动（我称之为）“trafficMonitor”时，我会这样启动它：

```
static void initializeTrafficMonitor(const char* interfaceName, int packetSize) {
    char errbuf[PCAP_ERRBUF_SIZE];
    pcap_t* sessionHandle = pcap_open_live(interfaceName, packetSize, 1, 100, errbuf);
    if (sessionHandle == NULL)
    {
        printf("Error opening session for device %s: %s\n", interfaceName, errbuf);
        return;
    }

    pcap_loop(sessionHandle, -1, packetReceived, NULL);
} 
```

提供`interfaceName`的是接口的 BSD 名称，例如`en0`. 该`packetSize`变量是一个整数，我为该以太网适配器提供最大数据包大小（当时这似乎是合乎逻辑的）。例如，我的 WiFi 适配器的数据包大小是`1538`.

我的回调方法被调用`packetReceived`，看起来像这样：

```
void packetReceived(u_char* args, const struct pcap_pkthdr* header, const u_char* packet) {

    struct pcap_work_item* item = malloc(sizeof(struct pcap_pkthdr) + header->caplen);
    item->header = *header;
    memcpy(item->data, packet, header->caplen);
    threadpool_add(threadPool, handlePacket, item, 0);
} 
```

我将数据包的所有属性填充到一个新结构中，并启动一个工作线程来分析数据包并处理结果。这是为了不让 pcap 等待，并尝试解决在添加此工作线程方法之前已经存在的问题。

`handlePacket`方法是这样的：

```
 void handlePacket(void* args) { 

        const struct pcap_work_item* workItem = args;
        const struct sniff_ethernet* ethernet = (struct sniff_ethernet*)(workItem->data);

        u_int size_ip;
        const struct sniff_ip* ip = (struct sniff_ip*)(workItem->data + SIZE_ETHERNET);
        size_ip = IP_HL(ip) * 4;
        if (size_ip < 20) {
            return;
        }
        const u_int16_t type = ether_packet(&workItem->header, workItem->data);
        switch (ntohs(type)) {
            case ETHERTYPE_IP: {

                char sourceIP[INET_ADDRSTRLEN];
                char destIP[INET_ADDRSTRLEN];

                inet_ntop(AF_INET, &ip->ip_src, sourceIP, sizeof(sourceIP));
                inet_ntop(AF_INET, &ip->ip_dst, destIP, sizeof(destIP));

                [refToSelf registerPacketTransferFromSource:sourceIP destinationIP:destIP packetLength:workItem->header.caplen packetType:ethernet->ether_type];

                break;
            }
            case ETHERTYPE_IPV6: {
                // handle v6
                char sourceIP[INET6_ADDRSTRLEN];
                char destIP[INET6_ADDRSTRLEN];

                inet_ntop(AF_INET6, &ip->ip_src, sourceIP, sizeof(sourceIP));
                inet_ntop(AF_INET6, &ip->ip_dst, destIP, sizeof(destIP));

                [refToSelf registerPacketTransferFromSource:sourceIP destinationIP:destIP packetLength:workItem->header.caplen packetType:ethernet->ether_type];

                break;
            }
        }
} 
```

根据以太网数据包的类型，我试图确定它是使用 IPv4 还是 IPv6 地址发送的数据包。在确定之后，我将一些详细信息发送到 ObjectiveC 方法（源 IP 地址、目标 IP 地址和数据包长度）。

我将数据包转换为 tcpdump 网站 (http://www.tcpdump.org/pcap.html) 上解释的结构。

问题是 pcap 似乎跟不上接收/发送的数据包。要么我没有嗅探所有数据包，要么数据包长度错误。

有没有人有任何指针我需要调整我的代码以使 pcap 全部捕获它们或者我有某种问题。

这些方法是从我的 ObjectiveC 应用程序中调用的，并且`refToSelf`是对 objC 类的引用。

**编辑：**我在后台线程中调用 initializeTrafficMonitor，因为 pcap_loop 是阻塞的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T23:29:28.500

这是在哪个版本的 OS X 上？在 Lion 之前的版本中，libpcap 在使用 BPF 的系统（例如 OS X）上的默认缓冲区大小为 32K 字节；[1992 年，他们想要他们的 4MB 工作站和 10Mb 以太网](http://www.tcpdump.org/papers/bpf-usenix93.pdf)。在 Lion 中，Apple 将 libpcap 更新为 1.1.1 版本；在 libpcap 1.1.0 中，默认 BPF 缓冲区大小增加到 512MB（如果不是所有具有 BPF 的系统，大多数系统中的最大值）。

如果这是 Snow Leopard，请尝试切换到新的`pcap_create()`/ `pcap_activate()`API，并使用`pcap_set_buffer_size()`将缓冲区大小设置为 512MB。如果这是Lion或更高版本，那将没有什么不同。

如果您的程序无法跟上*平均数据包速率，这将无济于事，但如果**临时*突发超过平均值，它至少意味着更少的数据包丢失。

如果您的程序无法跟上*平均*数据包速率，那么，如果您只想要数据包的 IP 地址，请尝试将快照长度（称为“packetSize”`）设置为一个足够大的值以仅捕获IPv4 和 IPv6 的以太网标头和 IP 地址。对于 IPv4，34 字节就足够了（libpcap 或 BPF 可能会将其四舍五入到更大的值），因为这是 14 字节的以太网报头 + 20 字节的 IPv4 报头，没有选项。对于 IPv6，它是 54 字节，对于 14 字节的以太网报头和 40 字节的 IPv6 报头。所以使用 54 的 packetSize 值。

请注意，在这种情况下，您应该使用 的字段`len`而*不是*`caplen`字段`struct pcap_pkthdr`来计算数据包长度。 `caplen`是捕获的数据量，不会大于指定的快照长度；`len`是“线上”的长度。

此外，您可能想尝试在同一线程中运行 pcap_loop() 和所有处理，并避免为数据包数据分配缓冲区并复制它，以查看是否*加快*了处理速度。如果您*必须*在单独的线程中执行它们，请确保在完成后释放数据包数据。

# android - 将多个数据传递给一个活动？

> ID：12234537
> 
> 赞同：1
> 
> 时间：2012-09-02T08:40:49.560
> 
> 标签：android, android-intent, android-activity

我正在尝试将多个数据项合二为一`Intent`：

```
if (strActStat == "Sedentary") {
    // passactStat.putString("keySedentary", strActStat);
    // passSeden.putString("keyMale", gender);
    i = new Intent(CalorieTrackerTargetWeight.this, TargetWeightResults.class);
    i.putExtra("keyGender", gender);
    i.putExtra("keyAct", strActStat);
    //i.putExtra("keyAct", strActStat);

    startActivity(i);
} 
```

为什么这不起作用？为什么我不能同时传递多个项目`Intent`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T08:53:20.290

您不能将字符串与`==`.

```
if (strActStat.equals("Sedentary")) { // should work 
```

编辑：

@Hesam 写了一个非常详细的答案，但他的解决方案并不是真的可用。而不是使用.`ArrayList<String>`你应该坚持使用`putExtra(key, value)`. 为什么？那么 ArrayList 解决方案有一些优点：

1.  您不限于 ArrayList 的类型
2.  您不必在列表中保留静态顺序。由于您只能使用索引值来获取列表，因此您需要确保`put()`与 的顺序相同`get()`。考虑以下情况：您经常发送 3 个值，但在某些情况下您不想发送第二个值。当您使用 ArrayList 解决方案时，您最终将`null`作为第二个值发送以确保第三个值将留在他的位置。这是非常混乱的编码！相反，您应该只发送两个值，并且当接收活动尝试接收第二个值时，它可以按需要处理返回的 null ......例如用默认值替换它。
3.  命名密钥将使您*始终*知道里面应该有什么......
4.  您`key`应该在接收活动中声明为常量。因此，通过查看此常量，您始终可以知道活动可以处理哪些意图数据。这是一个很好的编程！

希望这有助于澄清意图的使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:53:27.713

我认为这不是唯一的问题，首先，`if (strActStat == "Sedentary")`这是错误的。您无法以这种方式与字符串进行比较。因为以这种方式对象正在比较的不是字符串。正确的方法是`if (strActStat.equalIgnoreCase("Sedentary"))`。

如果您使用[Parcelable](http://developer.android.com/reference/android/os/Parcelable.html)，那么您可以在 1 个意图中传递多个数据。

你也可以使用`ArrayList<String>`. 这是您需要的代码框架：

申报清单

```
private List<String> test; 
```

在适当的地方初始化列表

```
test = new ArrayList<String>(); 
```

并根据需要添加数据进行测试。

传递给意图如下：

```
Intent intent = getIntent();
intent.putStringArrayListExtra("test", (ArrayList<String>) test); 
```

检索数据如下：

```
ArrayList<String> test = data.getStringArrayListExtra("test"); 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-03T14:11:45.567

我遇到了同样的问题。我的错误是我传输的变量之一没有初始化。就像你的情况下的*性别*或*strActStat*一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-24T04:51:55.610

**尝试这个：**

```
done.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                namevalue=name.getText().toString();
                overvalue=over.getText().toString();
                audiostatus=audio.getText().toString();
                Intent intent=new Intent(Settings.this,home.class);
                 Bundle bundle = new Bundle();   
                 bundle.putString( "namevalue",namevalue);  
                 bundle.putString("overvalue",overvaluse);
                 bundle.putInt("value",variablename);
                 intent.putExtras(bundle);   
                 startActivity(intent);                 
                }
            }); 
```

# asp.net-mvc - 在 MVC 3.0 中应用主题和样式

> ID：12234541
> 
> 赞同：0
> 
> 时间：2012-09-02T08:41:14.083
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我来自 ASP.NET 表单开发，现在正在开发一个 MVC 3.0 应用程序，当客户登录时，她可以从下拉列表中选择不同的帐户：

下拉列表包含：

> 1.  本田汽车保险账户
> 2.  家庭保险账户
> 3.  福特汽车保险账户。

当她选择其中一个帐户时，登录页面会随着她的历史详细信息数据等而更改。该应用程序包含另外 4 个页面，每个页面类型都有不同的内容。

在 ASP.NET 表单中，我们可以使用主题和皮肤等根据用户选择的帐户在页面上应用样式。但是我认为这似乎不适用于 MVC。

谁能建议在 MVC 中实现上述目标的最佳方法是什么？

> 1.  为每个页面创建一个控制器并为每个帐户创建单独的视图？
> 2.  每个页面内容是否应该由部分视图提供？
> 3.  还有什么建议吗？

**注意**：从控制器发送的 JSON 结构对于每个帐户类型都是唯一的，因为每个帐户具有不同的属性。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:37:40.967

我会为每个部分使用一个单独的控制器。然后在该控制器的 View 文件夹中，添加一个`_ViewStart.cshtml`文件并在其中放入

```
@{
    Layout = "~/Views/Honda/_Layout.cshtml";
} 
```

这将指向此控制器的布局页面（本田控制器，但使用您想要的任何名称。）

然后在`_Layout files`你可以添加不同的布局，css等。

这可能是在同一站点上获得截然不同的外观部分的最简单方法。另外，您仍然可以使用默认值`Home`和`Account`控制器来保持标准登录页面等。

您仍然可以使用局部视图，以及您想要的任何其他设置。这甚至可能意味着最终用户的加载时间更快，因为他们的浏览器不必下载它不使用的 css 和其他文件。

**编辑**

这里有更多信息，[ASP.NET MVC 3: Layouts with Razor 来自 ScottGu 的博客](http://weblogs.asp.net/scottgu/archive/2010/10/22/asp-net-mvc-3-layouts.aspx)

> 因为这段代码在每个视图的开头执行，我们不再需要在任何单独的视图文件中显式设置布局（除非我们想覆盖上面的默认值）。
> 
> 重要提示：因为 _ViewStart.cshtml 允许我们编写代码，所以我们可以选择性地使我们的布局选择逻辑更丰富，而不仅仅是一个基本的属性集。例如：我们可以根据访问网站的设备类型来改变我们使用的布局模板——并为这些设备优化手机或平板电脑布局，并为 PC/笔记本电脑优化桌面布局。或者，如果我们正在构建一个供多个客户使用的 CMS 系统或通用共享应用程序，我们可以在访问站点时根据客户（或他们的角色）选择不同的布局来使用。
> 
> 这使得 UI 具有很大的灵活性。它还允许您更轻松地编写一次视图逻辑，并避免在多个地方重复它。

# android - LinearLayout 作为自定义按钮，OnClickListener 从未调用

> ID：12234543
> 
> 赞同：2
> 
> 时间：2012-09-02T08:41:25.117
> 
> 标签：android, android-layout, android-custom-view

我一直在使用带有图标（drawableTop）和文本的通用 Android 按钮。如果你想要一个非标准尺寸的按钮，它的效果真的很差，所以我决定用一个具有以下布局的 LinearLayout 制作一个自定义按钮：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   style="@style/ButtonHoloDark"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:gravity="center" 
   android:clickable="true" 
   android:focusable="true"
   android:orientation="vertical" >

   <ImageView
       android:id="@+id/buttonIcon"  
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:duplicateParentState="true" />

   <TextView
       android:id="@+id/buttonText"  
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:duplicateParentState="true"
       android:gravity="center"
       android:textColor="@color/white" />

</LinearLayout> 
```

布局由自定义类使用：

```
public class CustomIconButton extends LinearLayout {
    public CustomIconButton(Context context, AttributeSet attrs) {
    super(context, attrs);
    setAttributes(context, attrs);
    LayoutInflater.from(context).inflate(R.layout.custom_icon_button, this, true);
}

... 
```

但是，当我在其父布局中的按钮上设置 OnClickListener 时，它永远不会被调用。如果将侦听器设置为 ImageView 和/或 TextView，我只能接收点击。当单击按钮时，这会导致两种可能的效果：

1.  点击在 ImageView 或 TextView 内。点击注册好，但按钮状态drawable没有改变，即它没有出现沮丧。
2.  单击位于按钮的“空白区域”内。单击未注册，但状态可绘制工作正常。

这些都不可行。我在 LinearLayout 或其子项上使用了以下属性，但无论真假似乎都没有任何效果：

*   重复父状态
*   可点击
*   可聚焦

似乎没有任何合理的方法可以让 LinearLayout 父级而不是其子级接收点击。我已经看到一些可能的解决方案覆盖了自定义组件本身的 dispatchTouchEvent 或 onInterceptTouchEvent，但是如果我必须开始分析触摸事件以识别正确的点击，那看起来真的是一团糟。

那么在带有子项的 LinearLayout 上的 OnClickListener = 不行吗？

编辑：这就是我目前将按钮插入片段主布局的方式。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

...

<com.package.CustomIconButton
        android:id="@+id/someButton"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        mynamespace:buttonIcon="@drawable/someIcon"
        mynamespace:text="@string/str_someText" />

 ... 
```

并且按钮在 Fragment 的代码中绑定如下：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {
    View v =  inflater.inflate(R.layout.main, container, false);

    View customButton = v.findViewById(R.id.goButton);     
    customButton.setOnClickListener(onClickListener);

    ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:36:11.617

你确定你设置了正确的监听器`LinearLayout`（因为你有两个，父级和膨胀布局中的一个）。前段时间我做了一个类似的组件，监听器工作没有问题（我不知道你在这些风格中有什么）。唯一的区别是我没有添加 (不需要) `LinearLayout`，而是使用了`merge`标签：

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android" >

   <ImageView
       android:id="@+id/buttonIcon"  
       android:layout_width="fill_parent"
       android:layout_height="wrap_content" />

   <TextView
       android:id="@+id/buttonText"  
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"              
       android:textColor="@color/white" />

</merge> 
```

并在 parent 上设置样式`LinearLayout`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:47:13.890

您可以`transparent child`为您的线性布局设置一个并设置它的尺寸`fill_parent`然后注册`onClickListener`它，所以当用户点击它时，它会响应。例如：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:src="@null" />

</LinearLayout> 
```

创建（）：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ImageView iv = (ImageView) findViewById(R.id.imageView1);
        iv.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                System.out.println("CLICKED!");
            }
        });
    } 
```

# php - 刷新页面而不丢失 Post 值

> ID：12234545
> 
> 赞同：8
> 
> 时间：2012-09-02T08:41:47.017
> 
> 标签：php, html

刷新页面时如何维护 $post 值；换句话说，如何在不丢失 Post 值的情况下刷新页面

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T09:21:27.653

如果没有页面提交，这是不可能的！除非您以某种方式将表单字段提交回服务器，即使用 jQuery 等不刷新页面。某种自动保存表单脚本。

如果这是用于验证检查，则不需要建议的会话。

用户填写表单并提交给自己 服务器端验证失败

$_GET

```
 <input type="hidden" name="first" 
   value="<?php echo htmlspecialchars($first, ENT_QUOTES); ?>" /> 
```

验证消息，结束。

或者按照建议将整个帖子保存在会话中，类似这样，但再次必须先提交才能工作....

$_POST

```
if(isset($_POST) & count($_POST)) { $_SESSION['post'] = $_POST; }
if(isset($_SESSION['post']) && count($_SESSION['post'])) { $_POST = $_SESSION['post']; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T08:47:16.493

你不能这样做。POST 变量可能不会被重新发送，如果是，浏览器通常会在用户刷新页面时执行此操作。

如果用户单击指向另一个页面的链接而不是刷新，则永远不会重新设置 POST 变量。

如果`$post`是一个普通变量，那么它永远不会被保存。

如果您需要保存某些内容，则需要使用 cookie。`$_SESSION`是 cookie 的一种实现。Cookie 是存储在用户浏览器上的数据，每次请求都会重新发送。

参考： http: [//php.net/manual/en/reserved.variables.session.php](http://php.net/manual/en/reserved.variables.session.php)

$_SESSION 变量只是一个关联数组，所以要使用它，只需执行以下操作：

```
$_SESSION['foo'] = $bar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T08:44:36.783

您可以将 $_POST 值保存在 $_SESSION's Save your all $_POST's 中，如下所示：

```
<?php
session_start();
$_SESSION['value1'] = $_POST['value1'];
$_SESSION['value2'] = $_POST['value2'];
// ETC...
echo "<input type='text' name='value1' value='".$_SESSION['value1']."' />";
echo "<input type='text' name='value2' value='".$_SESSION['value2']."' />";
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-20T04:43:31.683

实际上，它以 html 形式保存发布数据。当您需要将插入的数据保留在文本框中时，这很有价值。

```
 <form> 
<input type="text" name="student_name" value="<?php echo 
isset($_POST['student_name']) ? $_POST['student_name']:'';    
?>">
</form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T08:48:50.110

您可以使用与`POST`表单内部相同的值，这样，当您提交它时 - 它会留在那里。

一个小例子：

```
<?php
$var = mysql_real_escape_string($_POST['var']);
?>
<form id="1" name="1" action="/" method="post">
<input type="text" value="<?php print $var;?>"/>
<input type="submit" value="Submit" />
</form> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-02T08:53:51.360

将帖子值放入会话

```
session_start();
$_SESSION["POST_VARS"]=$_POST; 
```

你可以在另一个页面中获取这个值，比如

```
session_start();
$_SESSION["POST_VARS"]["name"];
$_SESSION["POST_VARS"]["address"]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-26T11:14:27.520

您可以使用文件来保存发布数据，因此在有人删除文件之前不会删除数据，当然您可以轻松修改文件

```
if($_POST['name'])
{
$file = fopen('poststored.txt','wb'); 
fwrite($file,''.$_POST['value'].'');
fclose($file);
} 

if (file_exists('poststored.txt')) {
$file = fopen('ipSelected.txt', 'r');
$value = fgets($file);
fclose($file);
} 
```

所以你的帖子价值存储在`$value`.

# iphone - 将 NSMutableArray 从 UITableViewController 传递给 DetailView - iPhone

> ID：12234548
> 
> 赞同：0
> 
> 时间：2012-09-02T08:42:09.140
> 
> 标签：iphone, objective-c, xcode, nsmutablearray, uitableview

我有一个 UITableViewController，当点击一个单元格时它会显示另一个 UITableViewController。我有一个 NSMutableArray，我想在实例化时将其传递给新的 UITableViewController。

我通常会做类似的事情：

```
- (void)loadStationList {

 StationListView * listView = [[StationListView alloc] initWithNibName:@"StationListView" bundle:nil];
 listView.dataList = newParser.stationData;
 // ...
 // Pass the selected object to the new view controller.
 NSLog(@"New Parser is %d", [newParser.stationData count]); //This is fine - all objects in array here.
 [self.navigationController pushViewController:listView animated:NO]; 
```

}

奇怪的是 dataList （新类中的 NSMutableArray 指针）是空的（我正在检查行数委托方法）。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
NSLog(@"Data List is %d", [dataList count]);
return [dataList count];

} 
```

我尝试了几种不同的方法（例如在父类中实例化一个新的 NSMutable 数组），但似乎没有任何效果。这可能与 ARC 有关，因为我对 ARC 还是比较陌生。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:59:01.117

你是怎么申报`dataList`的，`newParser.stationData`？应该是这样的

```
@property (nonatomic, strong) NSMutableArray       *dataList; 
```

无论如何，为确保您不会丢失任何值，您可能希望将每个元素从 复制/分配`newParser.stationData`到`dataList`。像这儿：

```
 NSMutableArray * dataList = [[NSMutableArray alloc] init];
    for (id arrayElement in newParser.stationData) {
        [dataList addObject:arrayElement];
            } 
```

试试这个，而不是简单的 assignment `listView.dataList = newParser.stationData;`。ps不要担心效率，这太快了，没关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:50:29.587

好吧，我通过在应用程序委托中创建一个实例变量然后从那里保存和读取数组来解决这个问题。这看起来确实像 arc 中的错误 - 它适用于其他变量类型。

# c++ - “异构对象”类中的复制构造函数

> ID：12234551
> 
> 赞同：2
> 
> 时间：2012-09-02T08:43:08.843
> 
> 标签：c++, templates

我正在尝试编写非常简单的 Any 对象，它可以容纳任何类型的对象。我希望它在容器内使用，以实现异构容器。

```
#include <iostream>
#include <vector>
#include <string>

struct Any
{
    template < typename T >
    Any(const T & t) 
        :p(new storageImpl<T>(t)) { }

    ~Any() 
    {
        delete p;
    }

    struct storage
    {
        virtual ~storage() {}
    };

    template <typename T>
    struct storageImpl : storage
    {
        storageImpl(const T & t) : data(t) {}
        T data;
    };

    template <typename T>
    T & get()
    {
        storageImpl<T> * i = static_cast<storageImpl<T>*>(p);
        return i->data;
    }

    storage * p;
}; 
```

用法

```
int main ()
{
    //block1
    Any copy(Any(std::string("foo")));      
    std::cout << copy.get<std::string>();   

    //block2
    std::vector<Any> cont;
    cont.push_back(Any(5));
    cont.push_back(Any(37.9f));
    std::cout << cont[0].get<int>();    
    std::cout << cont[1].get<float>();  
} 
```

我有复制构造的问题。

当我推`Any`入向量（//block2）时，未命名`Any`的被破坏，因此指针被删除，推入的对象不再有效。

所以我有两个问题：

1、Any类的拷贝构造函数怎么写？

2、为什么`Any`block1中的unnamed没有被销毁，所以它的指针没有被删除？\

编辑我试过

```
template <typename T>
Any(const Any & rhs)
    :p(new storageImpl<T>(rhs.get()))
{
} 
```

但它不会被触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T08:57:15.353

`Any`不是模板类。尝试将复制构造函数模板化`template <typename T> Any(const Any & rhs)`是没有意义的。

您可以做的是使用[虚拟构造函数](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Virtual_Constructor)习语，让`storageImpl`副本本身。这也是 Boost.Any 中使用的方法。

```
struct Any {
    template < typename T >
    Any(const T& t) : p(new storageImpl<T>(t)) {}

    Any(const Any& other) : p(other.p->clone()) {}
 // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

    ~Any() { delete p; }

    struct storage {
        virtual ~storage() {}
        virtual storage* clone() = 0;
     // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    };

    template <typename T>
    struct storageImpl : storage {
        storageImpl(const T & t) : data(t) {}

        virtual storage* clone() { return new storageImpl(data); }
     // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

        T data;
    };

    template <typename T>
    T& get() {
        storageImpl<T>* i = static_cast<storageImpl<T>*>(p);
        return i->data;
    }

    storage * p;
}; 
```

请注意，这个实现有很多问题，例如该`get()`方法不会检查 Any 是否真的持有 T。最好使用经过良好测试的库，例如[Boost.Any](http://www.boost.org/doc/libs/1_51_0/doc/html/any.html)。

* * *

> 为什么 block1 中未命名的 Any 没有被销毁，所以它的指针没有被删除？

[复制省略](https://stackoverflow.com/questions/10201321/copy-constructor-elision)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:46:58.453

1.  进行深拷贝，即动态分配一个新`storageImpl<T>`对象，初始化为被复制对象的内容。

2.  您可能会发生[复制省略](http://en.wikipedia.org/wiki/Copy_elision)，这意味着没有要删除的临时对象。

或者，使用[boost::any](http://www.boost.org/doc/libs/1_51_0/doc/html/any.html)避免所有问题。

# c++ - 通过在函数后面写 N 个括号来调用函数 N 次

> ID：12234553
> 
> 赞同：1
> 
> 时间：2012-09-02T08:43:41.223
> 
> 标签：c++

我想实现以下内容：

我定义了一个函数。当我在函数后面写*N* `()`时，该函数将被调用*N*次。

我举个例子：</p>

```
#include <iostream>
using namespace std;

typedef void* (*c)();
typedef c (*b)();
typedef b (*a)();

a aaa()
{
    cout<<"Google"<<endl;

    return (a)aaa;
}

int main()
{
    aaa()()()();
    system("pause");
} 
```

然后输出是：

![在此处输入图像描述](../Images/5f6231732980ff5c8b7e178ab4d5ee4d.png)

还有其他方法可以实现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T08:52:56.897

使用函子很简单。

```
#include <iostream>

struct Function
{
   Function& operator()() {
      std::cout << "Google" << std::endl;
      return *this;
   }
};

int main()
{
   Function f;
   f()()()();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:53:48.440

你可能对函子感兴趣：

```
#include <iostream>

class my_functor {
    public:
    //  if called without parameters
        my_functor& operator()(){
            std::cout << "print" << std::endl;
            return *this;
        }
    //  if called with int parameter
        my_functor& operator()(int number){
            std::cout << number << std::endl;
            return *this;
        }
};

int main(){
    my_functor functor;
    functor()(5)();
    return 0;
} 
```

通过重载函数调用运算符`()`，您可以将函数行为添加到您的对象。您还可以定义不同的参数，这些参数应传递给您的重载`()`-operator，并调用相应的函数调用。只需确保返回对 this-instance 的引用，如果要在对象实例上调用函数调用，该函数调用已被先前的函数调用修改。

# asp.net - ASP.Net 中的运行时问题

> ID：12234561
> 
> 赞同：1
> 
> 时间：2012-09-02T08:45:03.723
> 
> 标签：asp.net, .net, controls, runtime, overlap

我是 ASP.NET 中的 Web 开发新手，我刚刚设计了一个小型网站。虽然在设计时我的控件放置正确，但在运行时控件出现重叠。我已经看到源视图，left 和 top 的值都很好。看看这些屏幕截图：

在设计时：

![在此处输入图像描述](../Images/786098aa6b5f9c7040f8c8d5acb30873.png)

在 Chrome 和 IE 中运行时：

![在此处输入图像描述](../Images/aa090693e6d491eda25cc3e9d3a9aabe.png)

在 Mozilla 中：

![在此处输入图像描述](../Images/4fdef64a44355430ff6e17fc33b40147.png)

我在文本框源视图中的代码：

```
<asp:TextBox ID="TextBox1" runat="server" 
    style="z-index: 1; left: 102px; top: 339px; position: absolute"></asp:TextBox>
<asp:TextBox ID="TextBox2" runat="server" 
    style="z-index: 1; left: 247px; top: 327px; position: absolute"></asp:TextBox>
<asp:TextBox ID="TextBox3" runat="server" 
    style="z-index: 1; left: 248px; top: 360px; position: absolute"></asp:TextBox> 
```

可能有一个简单的解决方案，但由于我是新手，请让我知道必须做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T08:52:23.950

我会重新组织你的标记。你可以试试：

```
<div style="position: absolute; left: 102px; top: 327px;">
    <div id="left_column" style="float:left">
        <asp:TextBox ID="TextBox1" runat="server" />
    </div>
    <div id="right_column" style="float: left; margin-left: 15px;">
        <asp:TextBox ID="TextBox2" runat="server" />
        <asp:TextBox ID="TextBox3" runat="server" />
    </div>
</div> 
```

如果您想要元素之间的更多间距，请添加一些边距 og 填充。

# html - 画布到图像：如何保持比例

> ID：12234568
> 
> 赞同：1
> 
> 时间：2012-09-02T08:46:41.517
> 
> 标签：html, canvas, webcam

这是我的测试代码：http: [//jsfiddle.net/Zx4fg/](http://jsfiddle.net/Zx4fg/)

为什么画布上的圆圈看起来像一个椭圆？

我想将网络摄像头的快照保存到图像中，但生成的图像不保持比例。

我的真实代码是：

```
ctx.drawImage(video,0,0, 300, 150); // 300х150 - with this prop. image 
                                    //from webcam on canvas with true proportions
$('body').append($('<img>').attr('src', canvas.toDataURL())); 
```

我得到这样的：

![](../Images/3df1b1e3c9e84660daac1c4ebda9d88d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T09:29:20.163

问题在于画布样式，您应该在 HTML 中设置其宽度和高度属性。不在 CSS 中

```
<canvas id="canvas" width="320" height="2400" style="border:1px solid #d3d3d3;"> 
```

# math - 计算一个角度是否在两个角度之间

> ID：12234574
> 
> 赞同：27
> 
> 时间：2012-09-02T08:47:22.570
> 
> 标签：math, trigonometry

所以我正在制作一个小游戏，我正在检查一个角色是否可以“看到”另一个角色，如果 A 在 B 的一定距离内，角色 A 可以看到角色 B，并且 A 度数的方向是 +/- 45 度B所面对的角度。

目前，我在检查是否

```
(facingAngle - 45) =< angleOfTarget =< (facingAngle + 45) 
```

除了当我们越过 360 度线时，这工作正常。

比方说`facingAngle = 359, angleOfTarget = 5`。在这种情况下，目标仅偏离中心 6 度，所以我希望我的函数返回 true。不幸的是，5 不在 314 和 404 之间。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-02T08:58:49.260

你试一试

```
anglediff = (facingAngle - angleOfTarget + 180 + 360) % 360 - 180

if (anglediff <= 45 && anglediff>=-45) .... 
```

原因是角度的差异`facingAngle - angleOfTarget`虽然是由于包裹效应，但可能会偏离 360 度。

加 180+360 然后模 360 然后减去 180，实际上只是将所有内容转换为 -180 到 180 度的范围（通过加或减 360 度）。

然后您可以轻松检查角度差，是否在 -45 到 45 度之间。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-04-18T18:38:18.433

这是我在网上找到的一个简单的功能，并进行了修改。**它适用于任何角度（可以在 0-360 之外）**。（这个函数在 c 中工作，在 Xcode 中工作。）

请记住，它检查从角度 A 到角度 B 的逆时针方向。如果角度介于两者之间，则返回**YES (true)：)**

一、简单的转换函数，让所有角度都为1-360

```
//function to convert angle to 1-360 degrees
 static inline double angle_1to360(double angle){
 angle=((int)angle % 360) + (angle-trunc(angle)); //converts angle to range -360 + 360
 if(angle>0.0)
 return angle;
 else
 return angle + 360.0;
 } 
```

检查角度是否介于:)

```
//check if angle is between angles
 static inline BOOL angle_is_between_angles(float N,float a,float b) {
 N = angle_1to360(N); //normalize angles to be 1-360 degrees
 a = angle_1to360(a);
 b = angle_1to360(b);

 if (a < b)
 return a <= N && N <= b;
 return a <= N || N <= b;
 } 
```

![在此处输入图像描述](../Images/292025861f4ee1f6d00897fd575889f4.png)

例如。检查角度 300 是否在 180 到 10 度之间：

```
BOOL isBetween=angle_is_between_angles( 300, 180,10); 
```

//返回是

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-02T09:14:07.147

有一个避免环绕问题的三角函数解决方案。

我假设你有 (x, y) 两个字符的坐标`P1`和`P2`. 您已经指定您知道您可能使用毕达哥拉斯定理计算的两者之间的距离。

您可以使用两个向量的*点积*来计算它们之间的角度：

```
A . B = |A| . |B| . cos(theta). 
```

如果您将`A`其作为`facingAngle`向量，它将是`[cos(fA), sin(fA)]`，并且大小`|A|`为 1。

如果您`B`将两个字符之间的向量作为向量，并且您在上方的距离得到：

```
cos(theta) = (cos(fA) * (P2x - P1x) + sin(fA) * (P2y - P1y)) / |B| 
```

`|B|`您已经计算出的距离在哪里。

您不需要实际取反余弦来查找`theta`，因为对于 -45 到 +45 的范围，您只需要检查`cos(theta) >= 0.70710678`(ie `1 / sqrt(2)`)。

这可能看起来*有点*复杂，但很有可能你已经在程序中找到了所有必需的变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T08:55:41.900

处理低端包装的一个简单解决方案（成负值）就是将 360 添加到所有值：

```
(facingAngle + 315) =< (angleOfTarget + 360) =< (facingAngle + 405) 
```

这样，45 的减法永远不会变成负数，因为它不再发生。

要在顶端处理换行，您需要再次检查，将*另一个*360 添加到该`angleOfTarget`值：

```
canSee  = (facingAngle + 315 <= angleOfTarget + 360) &&
          (angleOfTarget + 360 <= facingAngle + 405);
canSee |= (facingAngle + 315 <= angleOfTarget + 720) &&
          (angleOfTarget + 720 <= facingAngle + 405); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-09T10:14:33.283

另一种使用始终最小正差并与阈值进行比较的方法：

```
anglediff = Math.min(Math.abs(facingAngle - angleOfTarget), 360 - Math.abs(angleOfTarget - allowDirection));
if (anglediff <= 45) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-21T23:33:53.930

以不同的方式重述 Alnitak 的答案，避免 360 度角包绕的解决方案是在角度总是很小的不同坐标系中重述问题。这是代码：

```
def inside_angle(facing, target):
    dot = cos(facing)*cos(target) + sin(facing)*sin(target)
    angle = acos(dot)

    return angle <= pi/4 
```

这是使用矢量投影完成的。假设向量 |face> = [cos(facing) sin(facing)] 和 |target> = [cos(target) sin(target)]，当将目标投影到面对向量时，角度将从零开始，当目标正好在面向向量处或将增加到任一侧。这样我们就可以将其与 pi/4（45 度）进行比较。角度公式如下：

```
cos(angle) = <facing|target> / <target|target> <facing|facing> 
```

也就是说，角度的余弦是向量|face>和|target>划分它们的模块之间的点积，在这种情况下为1，它变为：

```
angle = acos(<facing|target>) 
```

参考： [https ://en.wikipedia.org/wiki/Vector_projection](https://en.wikipedia.org/wiki/Vector_projection)

# validation - Mvc4 RTM validation throwing an error

> ID：12234582
> 
> 赞同：5
> 
> 时间：2012-09-02T08:49:35.120
> 
> 标签：validation, asp.net-mvc-4, restsharp

Has something changed with the rtm bits regarding the validation of models.

I have a simple viewmodel that looks like

```
 public class ProductViewModel
    { 
    [Required]
    [DataMember(IsRequired = true)]
    public int ProductTypeId { get; set; }
    public string Product { get; set; }
    } 
```

(I just added the DataMember(IsRequired = true) as the error message I get says to use it to fix the problem. However no joy)

Within my controller the model state is telling me model is valid however when I try passing the model to my api using RestSharp I get the following error.

> {"Message":"An error has occurred.","ExceptionMessage":"Property 'ProductTypeId' on type 'Mine.Model.Model' is invalid. Value-typed properties marked as [Required] must also be marked with [DataMember(IsRequired=true)] to be recognized as required. Consider attributing the declaring type with [DataContract] and the property with [DataMember(IsRequired=true)].","ExceptionType":"System.InvalidOperationException","StackTrace":" at System.Web.Http.Validation.Validators.ErrorModelValidator.Validate(ModelMetadata metadata, Object container)\r\n at System.Web.Http.Validation.DefaultBodyModelValidator.ShallowValidate(ModelMetadata metadata, ValidationContext validationContext, Object container)\r\n at System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(ModelMetadata metadata, ValidationContext validationContext, Object container)\r\n at System.Web.Http.Validation.DefaultBodyModelValidator.ValidateProperties(ModelMetadata metadata, ValidationContext validationContext)\r\n at System.Web.Http.Validation.DefaultBodyModelValidator.ValidateNodeAndChildren(ModelMetadata metadata, ValidationContext validationContext, Object container)\r\n at System.Web.Http.Validation.DefaultBodyModelValidator.Validate(Object model, Type type, ModelMetadataProvider metadataProvider, HttpActionContext actionContext, String keyPrefix)\r\n at System.Web.Http.ModelBinding.FormatterParameterBinding.<>c_*DisplayClass1.b*_0(Object model)\r\n at System.Threading.Tasks.TaskHelpersExtensions.<>c__DisplayClass36`1.<>c__DisplayClass38.<Then>b__35()\r\n at System.Threading.Tasks.TaskHelpersExtensions.<>c__DisplayClass49.<ToAsyncVoidTask>b__48()\r\n at System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func, CancellationToken cancellationToken)"}

I wasnt having this problem with the rc bits but then I have only started to use the restsharp libary with the rtm bits.

Any help would be great.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T22:59:33.380

In addition to adding [DataMember(IsRequired = true)] to the property, you'll also need to ensure that the attribute [DataContract] is applied at the class level.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T23:14:27.560

The data entry DataContract is being consumed by the UI to create the data entry form and the back-end whenever the form is posted. So, is it safe to say that [DataMember(IsRequired = true)] is needed for the back-end and [Required(ErrorMessage = @"Product type is required)] is needed for form validation so you can access the error message?

I'm not sure why we have to do both. Why can't we have a single attribute to be used by front-end and server side?

# vb.net - 将 COM 可见事件添加到 VB.NET 类的最快方法是什么？

> ID：12234590
> 
> 赞同：1
> 
> 时间：2012-09-02T08:51:24.063
> 
> 标签：vb.net, events, visual-studio-2005, com-interop, comvisible

`COM`将可见事件添加到`VB.NET`类的最快方法是什么？

Visual Studio 工具箱中是否有一些东西，或者有没有`macro`可以做到这一点？

我正在使用`VS2005`.

编辑：在这篇文章[http://msdn.microsoft.com/en-us/library/dd8bf0x3(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/dd8bf0x3(v=vs.80).aspx)中，`GuidAttribute`指定了 a 。这是程序员在设计时生成的，还是需要它来匹配其他地方的 GUID？

# c++ - 当我尝试使用异常 [CodeBlocks, C++] 时得到名称修饰

> ID：12234591
> 
> 赞同：0
> 
> 时间：2012-09-02T08:51:54.060
> 
> 标签：c++, exception, name-mangling

我第一次尝试使用异常，但即使这是一个非常简单的示例，我也无法编译它，我查看了几个示例并尝试以多种不同的方式对其进行编码，但我什至不确定问题到底出在哪里，因为当我引入 catch/try/throw 时，我得到了名称处理，这是我的代码，希望它真的很愚蠢:)

```
#include "Surface.h"
#include "SDL_Image.h"

using namespace std;

SDL_Surface* surface::Load(string fileName){

   SDL_Surface* loadedSurface = IMG_Load(fileName.c_str());
   if(loadedSurface == 0) throw 0;

   //Convert surface to same format as display
   loadedSurface = SDL_DisplayFormatAlpha(loadedSurface);

   return loadedSurface;
} 
```

* * *

```
#include "GameState.h"
#include "Surface.h"

#include<iostream>

using namespace std;

GameState::GameState(string fileName){

   try{
      stateWallpaper_ = surface::Load(fileName);
   }
   catch(int& e){
      cerr << "Could not load " << fileName << endl;
   }
} 
```

提前感谢您的帮助！

编辑：对不起，我忘了发布错误信息：它是

```
In function `ZN14GameStateIntroC1Ev':|
-undefined reference to `__gxx_personality_sj0'|
-undefined reference to `_Unwind_SjLj_Register'|
-undefined reference to `_Unwind_SjLj_Unregister'|
In function `ZN14GameStateIntroC1Ev':|
undefined reference to `_Unwind_SjLj_Resume'|
In function `ZN14GameStateIntroC2Ev':|
-undefined reference to `__gxx_personality_sj0'|
-undefined reference to `_Unwind_SjLj_Register'|
-undefined reference to `_Unwind_SjLj_Unregister'|
obj\Release\GameStateIntro.o||In function `ZN14GameStateIntroC2Ev':|
C:\Program Files (x86)\CodeBlocks\MinGW\bin\..\lib\gcc\mingw32\3.4.5\..\..\..\..\include\c++\3.4.5\ext\new_allocator.h|69|undefined reference to `_Unwind_SjLj_Resume'|
C:\MinGW\lib\libSDLmain.a(SDL_win32_main.o)||In function `redirect_output':|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|219|undefined reference to `SDL_strlcpy'|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|220|undefined reference to `SDL_strlcat'|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|243|undefined reference to `SDL_strlcpy'|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|244|undefined reference to `SDL_strlcat'|
C:\MinGW\lib\libSDLmain.a(SDL_win32_main.o)||In function `console_main':|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|296|undefined reference to `SDL_strlcpy'|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|301|undefined reference to `SDL_GetError'|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|312|undefined reference to `SDL_SetModuleHandle'|
C:\MinGW\lib\libSDLmain.a(SDL_win32_main.o)||In function `WinMain@16':|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|354|undefined reference to `SDL_getenv'|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|386|undefined reference to `SDL_strlcpy'|
C:\MinGW\lib\libSDLmain.a(SDL_win32_main.o)||In function `cleanup':|
\Users\slouken\release\SDL\SDL-1.2.15\.\src\main\win32\SDL_win32_main.c|158|undefined reference to `SDL_Quit'|

** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:45:59.843

从您的错误消息来看，问题与异常无关，而是与您的链接有关。您正在使用 SDL 标头但未链接到 SDL 库，请使用正确的`-L`选项。

# java - 如何防止客户端访问JSP页面

> ID：12234592
> 
> 赞同：1
> 
> 时间：2012-09-02T08:52:12.090
> 
> 标签：java, jquery, jsp

在我的 Web 应用程序中，我使用`.load()`JQuery 中的函数`JSP`在`DIV`.

```
$("#myDiv").load("chat.jsp"); 
```

在`chat.jsp`中，除非此客户端已登录，否则不会执行任何 Java 代码，这意味着我检查了会话。

```
String sessionId = session.getAttribute("SessionId");
if(sessionId.equals("100")){
  //execute codes
}else{
  //redirect to log in page
} 
```

那些将被执行的java代码，它们将是`out.println();`一些HTML元素。

我不希望客户端`/chat.jsp`在浏览器中写入来访问此页面，因为它看起来很糟糕，并且主页中的其他内容将不存在，这可能会损害 Web 应用程序的安全性。

如何限制某人`chat.jsp`直接访问，但仍可通过 访问`.load()`？

**更新：**

JavaDB 是我创建的一个类，它将我连接到数据库。

这是chat.jsp

```
<body>

    <%

        String userId = session.getAttribute("SessionId").toString();
        if (userId != null) {
            String roomId = request.getParameter("roomId");
            String lastMessageId = request.getParameter("lastMessageId");
            JavaDB myJavaDB = new JavaDB();
            myJavaDB.Connect("Chat", "chat", "chat");
            Connection conn = myJavaDB.getMyConnection();
            Statement stmt = conn.createStatement();
            String lastId = "";
            int fi = 0;
            ResultSet rset = stmt.executeQuery("select message,message_id,first_name,last_name from users u,messages m where u.user_id=m.user_id and m.message_id>" + lastMessageId + " and room_id=" + roomId + " order by m.message_id asc");
            while (rset.next()) {
                fi = 1;
                lastId = rset.getString(2);
    %>
    <div class="message">
        <div class="messageSender">
            <%=rset.getString(3) + " " + rset.getString(4)%>
        </div>
        <div class="messageContents">
            <%=rset.getString(1)%>
        </div>
    </div>
    <%            }
    %>
    <div class="lastId">
        <% if (fi == 1) {%>
        <%=lastId%>
        <% } else {%>
        <%=lastMessageId%>
        <% }%></div>

    <% if (fi == 1) {%>
    <div class="messages">
    </div> 
    <% }
        } else {
            response.sendRedirect("index.jsp");
        }%>
</body> 
```

伙计们，我不知道过滤器是什么意思。

**更新**

如果我决定发送一个参数告诉我这个请求来自 Jquery。

```
.load("chat.jsp", { jquery : "yes" }); 
```

然后在chat.jsp中检查

```
String yesOrNo = request.getParameter("jquery"); 
```

然后他们可以使用这个 URL 简单地破解它。

```
/chat.jsp?jquery=yes 
```

或类似的东西..

**更新**

我尝试了 Maksim 的建议，当我尝试访问 chat.jsp 时得到了这个。

![在此处输入图像描述](../Images/c76197eb0470ac17b5798dc6198b78ee.png)

这是想要的效果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:07:18.173

为了在我的应用程序中实现这一点，我检查`X-Requested-With`客户端在其请求中发送到我的页面的 http 标头中的字段。如果它的值为`XMLHttpRequest`，那么它很可能来自 ajax 请求（jQuery 将此标头附加到其请求中），否则我不提供该页面。常规（直接）浏览器请求会将此标头字段留空。

在 ASP.Net 中看起来像这样，您将不得不为 JSP 稍微更改代码：

```
if (Request.Headers["X-Requested-With"] != "XMLHttpRequest")
{
     Response.Write("AJAX Request only.");
     Response.End();
     return;
} 
```

**UPD**：快速谷歌搜索后，您的代码可能是这样的

```
if(!request.getHeader("X-Requested-With").equals("XMLHttpRequest")){
    out.println("AJAX Request only.");
    out.flush(); 
    out.close(); 
    return; 
} 
```

**UPD2**`request.getHeader("X-Requested-With")` ：在您的情况下看起来返回 null 将条件更改为如下所示：

```
String ajaxRequest = request.getHeader("X-Requested-With");
if(ajaxRequest == null || !ajaxRequest.equals("XMLHttpRequest")){
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T08:58:10.223

您的代码片段是 servlet 吗？如果是这样，请使用安全框架（例如 Spring Security）或 javax.servlet.Filter 来应用安全性，那么您也可以将安全性应用于 JSP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T09:09:01.467

你应该使用过滤器。检查过滤器代码中的会话并重定向到登录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T09:17:13.487

根据[http://www.c-sharpcorner.com/blogs/2918/how-to-set-a-request-header-in-a-jquery-ajax-call.aspx](http://www.c-sharpcorner.com/blogs/2918/how-to-set-a-request-header-in-a-jquery-ajax-call.aspx)

> JQuery 为您提供了创建请求并通过其 ajax 库检索响应所需的工具。原始的 $.ajax 调用为您提供了各种回调来操作 http 消息。

因此，您可以像这样在 Ajaxa 调用中添加自定义请求标头

```
$.ajax({
  type:"POST",
  beforeSend: function (request)
  {
     request.setRequestHeader("Authority", "AJAXREQUEST");
  },
........... 
```

然后在您的 servlet 中检查请求的标头权限是否等于 AJAXREQUEST。这就是您阅读请求标头的方式[http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-Request-Headers.html](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-Request-Headers.html)

# c# - 旧会话超时后创建会话

> ID：12234596
> 
> 赞同：0
> 
> 时间：2012-09-02T08:53:01.890
> 
> 标签：c#, asp.net, c#-4.0, c#-3.0

我有一个片段，会话具有数字内容，它增加到 3，但是当它收到 3 时它发送给客户端。这个会话必须在 1 分钟内超时，但直到会话没有超时，程序才能正常工作，但是当会话已过期并且要创建新会话我得到 system.invalidoperationexception 有什么问题？？？？它是我的代码？

```
 string ip = HttpContext.Current.Request.UserHostAddress;

           HttpContext failuser = HttpContext.Current;
           failuser.Session.Timeout =1;
           if (failuser != null)
           {
               if (failuser.Session[ip] != null)
                   failuser.Session[ip] = (int)failuser.Session[ip] + 1;
               else
                   failuser.Session[ip] = 1;

               // 
               retval = failuser.Session[ip].ToString();
               if ((int)failuser.Session[ip] > 2)
               {

                   retval = "!";

               } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T11:08:49.493

您将无法在会话到期后维护任何会话状态。
1 分钟的会话超时非常小。将其保持在更高的时间，例如 5 分钟。

不允许会话超时，而不是将会话恢复到超时后的状态会容易得多。

由于您已经在使用 WebMethods，您可以通过在会话到期前回发来延长会话的生命周期。（请务必保持绝对超时，如果您的用户处于非活动状态，则在 30 分钟后说）。

# c# - 第二次设置源（MediaElement）

> ID：12234598
> 
> 赞同：0
> 
> 时间：2012-09-02T08:53:07.270
> 
> 标签：c#, windows-phone-7, mediaelement

在 windows phone 7 ..使用元素 mediaelement 时。

每次用户单击按钮时，我都使用 url 设置 mediaelement 的来源，如下所示：

```
myMediaElement.Source = new Uri(url, UriKind.Absolute); 
```

然后我玩它。

当用户第二次单击按钮时.. mediaElement 不起作用.. 为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T11:48:29.807

你可以试试

```
 myMediaElement.Stop();
   myMediaElement.Source = null; 
   myMediaElement.Source = new Uri(url, UriKind.RelativeOrAbsolute); 
```

但是在您发布一些您正在做的事情的代码之前，我不确定您在做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T06:38:48.210

使用自动播放停止自动播放

```
 myMediaElement.Source = new Uri("Your Url", UriKind.Absolute);

        myMediaElement.AutoPlay = false; 
```

现在在点击时执行 play()

# objective-c - 使用 segue 在情节提要中的视图控制器之间传递数据

> ID：12234599
> 
> 赞同：0
> 
> 时间：2012-09-02T08:53:16.880
> 
> 标签：objective-c, ios, xcode, storyboard

我是 iOS 开发的新手，在阅读了许多关于传递变量的教程之后，我仍然需要你的帮助。

我的 PP.m 文件中的这个函数：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

if ([segue.identifier isEqualToString:@"Btn1Transport"])
{
   [segue.destinationViewController setMyData:(50)];
    NSLog(@"Transporter1");
}

if ([segue.identifier isEqualToString:@"Btn2Transport"])
{
   [segue.destinationViewController setMyData:(100)];
    NSLog(@"Transporter2");
} 
```

}

这是在我的 Category.m 文件中：

```
- (void)viewDidLoad{

[super viewDidLoad];

recipeLabel.text = @"Hello"; //for test, is working 
```

}

```
-(void)setMyData:(int)myData
{

    NSLog(@"Happines %d",myData);
    NSString* result = [NSString stringWithFormat:@"%d", myData];
    recipeLabel.text = result; //not working
} 
```

问题在于 NSLog(@"Happines %d",myData); 我的数据打印得很好，但没有设置为 recipeLabel。所以为了测试它是否有效，我做了 recipeLabel.text = @"Hello"; 标签很好。我究竟做错了什么？很抱歉初学者的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:56:48.180

不，您不能直接从 prepareForSegue 事件写入 TextLabel，当目标视图控制器加载时，该值将被覆盖......

您必须在目标视图控制器中设置一个变量，然后您必须将标签的值设置为等于目标视图控制器的 viewDidLoad 事件中的变量值以使其工作...

```
//The variable myIntVar is a private variable that should be declared in the header file as private 
- (void)viewDidLoad{

[super viewDidLoad];

recipeLabel.text = myIntVar; //set the value equal to the variable defined in the prepareForSeque
}

-(void)setMyData:(int)myData
{

    NSLog(@"Happines %d",myData);
    NSString* result = [NSString stringWithFormat:@"%d", myData];
    myIntVar = result; 
} 
```

# java - 将消息写入骆驼文件？

> ID：12234606
> 
> 赞同：2
> 
> 时间：2012-09-02T08:54:10.320
> 
> 标签：java, apache-camel

我想从（amq）获取消息并写入（某个文件）。我能够从 AMQ 获取消息但无法创建文件。请告诉我哪里有问题这是我的路线。

```
from("test-jms:queue:Test-AMQ").to("file:test?doneFileName=${file:name}.done"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T22:08:52.957

请参阅此单元测试以获取工作示例：

[https://svn.apache.org/repos/asf/camel/trunk/components/camel-jms/src/test/java/org/apache/camel/component/jms/JmsRouteToFileTest.java](https://svn.apache.org/repos/asf/camel/trunk/components/camel-jms/src/test/java/org/apache/camel/component/jms/JmsRouteToFileTest.java)

# flash - 包含 Flash 影片的 iframe 不会刷新

> ID：12234614
> 
> 赞同：0
> 
> 时间：2012-09-02T08:55:18.317
> 
> 标签：flash, caching, iframe, browser-cache

我有这样的代码

```
<iframe src="index.html"></iframe> 
```

**index.html**包含一个**flash**电影。每次我更新这部电影（同名）时，浏览器都会显示浏览器缓存中的上一部电影。

我尝试了不同的技巧，例如：meta headers tahs for no cache，jscript 更改 index.html 文件的参数，即 index.html?xxxxx 但它似乎不起作用。

有任何想法吗 ？

乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:10:45.997

use parameter in object tags, like

```
<object data="xxx.swf?nocache=ran.gettime() .... 
```

# php - 查找字符串中子字符串的多次出现

> ID：12234617
> 
> 赞同：1
> 
> 时间：2012-09-02T08:55:38.287
> 
> 标签：php

我想使用 php 从字符串中获取子字符串的位置。我可以使用`strpos()`，但它只返回第一次出现。如何获得多次出现的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T08:58:48.210

来自：[http ://www.php.net/manual/en/function.strpos.php#108426](http://www.php.net/manual/en/function.strpos.php#108426)

```
function strpos_r($haystack, $needle)
{
    if(strlen($needle) > strlen($haystack))
        trigger_error(sprintf("%s: length of argument 2 must be <= argument 1", __FUNCTION__), E_USER_WARNING);

    $seeks = array();
    while($seek = strrpos($haystack, $needle))
    {
        array_push($seeks, $seek);
        $haystack = substr($haystack, 0, $seek);
    }
    return $seeks;
} 
```

这将返回一个包含出现位置的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:55:08.343

strpos 的第三个参数，有一个可以使用的 $offset：

```
$positions_of_string = array();
$str_to_find = "string to find";
$str_length = strlen( $str_to_find );
$last_found = 0 - $str_length;

while( false !== $last_found ) {
    $last_found = strpos( $the_string, $str_to_find, $last_found+$str_length );
    if( false !== $last_found )
        $positions_of_strings[] = $last_found;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T08:59:33.973

从手册上看，评论中有这样的功能。

```
function strpos_recursive($haystack, $needle, $offset = 0, &$results = array()) {                
    $offset = strpos($haystack, $needle, $offset);
    if($offset === false) {
        return $results;            
    } else {
        $results[] = $offset;
        return strpos_recursive($haystack, $needle, ($offset + 1), $results);
    }
} 
```

# javascript - 将 JQuery 代码转换为其等效的 JavaScript

> ID：12234619
> 
> 赞同：2
> 
> 时间：2012-09-02T08:55:51.823
> 
> 标签：javascript, jquery

我正在修改一些遗留代码，我发现一个加载 JQuery 库的网页仅用于执行以下操作（这是在页面的`<script>`标签内`<body>`）：

```
$(document).ready(function(){ 
  //Once the document is ready, run the following code
  $("head").append($("<link rel='stylesheet' href='style-"+myCSS+".css' type='text/css' media='screen' />"));
}); 
```

我想将此代码转换为常规 JavaScript 并删除 JQuery（我不反对使用 JQuery，我反对必须加载 90+Kb 才能做到这一点的想法）。

我的想法，但我不是 JS 专家，是使用（在页面中的相同位置）：

```
headReference.innerHTML = "<link rel='stylesheet' href='style-" + myCSS + ".css' type='text/css' media='screen' />"; 
```

有没有更好的解决方案？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:01:38.510

这是等效的纯javascript：

```
var head = document.getElementsByTagName("head")[0];
var link = document.createElement("link");
link.rel = 'stylesheet';
link.type = 'text/css';
link.media = 'screen';
link.href = 'style-'+myCSS+'.css';
head.appendChild(link); 
```

如果在文档加载后加载它很重要（这可能不是必需的），那么您可以将此代码放在标签末尾之前的脚本标签中`<body>`- 否则，您可以将其放在`<body>`元素中的任何位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:03:19.557

jfriend00 的回答很好，这是另一种更接近 jQuery 原版的方法：

```
var h = document.createElement('head');
h.innerHTML = "<link rel='stylesheet' href='style-" + 
              myCSS + ".css' type='text/css' media='screen'>"
document.getElementsByTagName('head')[0].appendChild(h.firstChild); 
```

# python - 单个 Python 应用程序中的多个 GUI 工具包

> ID：12234623
> 
> 赞同：0
> 
> 时间：2012-09-02T08:57:08.483
> 
> 标签：python, user-interface, wxpython, cross-platform

我是 Python 新手，但我有兴趣深入了解该语言。我最近学会了如何使用 wxPython 制作简单的 GUI 应用程序，我喜欢它，我读过它是最好的跨平台 GUI 工具包——然而，有更好的“原生”GUI 工具包（pyGTK、IronPython（如果我' m没有记错），pyObjc等），但它们是个体的。

有没有办法可以将这些 GUI 库“混合”到一个应用程序中？如何在跨平台应用程序中提供最佳 GUI 体验？

非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:28:20.267

wxPython 的最大好处是它尽可能使用本地小部件，因此在 GTK 平台上它将使用 GTK，在 windows 上它将使用 win32，而在 mac 上它将使用 cocoa/carbon。

如果您**不**编写跨平台应用程序，那么您最好使用该平台的特定 API，例如 pyGTK（Gnome 等）、PyWin32T（Windows）或您平台上的任何本机工具包，因为它通常更新更多比 wxPython 最新的 API。

# objective-c - 如何在 iOS 中切片/剪切精灵（核心图形）

> ID：12234626
> 
> 赞同：4
> 
> 时间：2012-09-02T08:57:49.117
> 
> 标签：objective-c, ios, core-graphics, sprite, slice

我正在开发一款游戏，我想在其中添加一个适当的切片功能。所以当一个精灵切片时，应该创建 2 个新的精灵。请检查[这里](http://cdn1.raywenderlich.com/wp-content/uploads/2012/05/ccc_cutdiagram.png)

目前，我只是减小尺寸并复制精灵..像这样的东西..提前谢谢..

```
 - (BOOL) sliceSprite: (Sprite *) sprite withPath: (UIBezierPath *) slicePath

 {

            CGSize size = sprite.size;
            size.width /= 2; 
            size.height /=2;
            sprite.size = size;
            sprite.sliced = YES;

            Sprite *newSprite = [[Sprite alloc] initWithImage: sprite.image];

            newSprite.position = sprite.position;
            newSprite.size = size;
            newSprite.sliced = YES;
            newSprite.inView = YES;
            newSprite.xVelocity = SLICE_SPEEDUP * sprite.yVelocity;
            newSprite.yVelocity = SLICE_SPEEDUP * sprite.xVelocity;
            newSprite.angularVelocity = -SLICE_REVUP * sprite.angularVelocity;

            [sprites addObject: newSprite];
            [newSprite release];

        sprite.angularVelocity = SLICE_REVUP * sprite.angularVelocity;
            sprite.xVelocity = -SLICE_SPEEDUP * sprite.xVelocity;
            sprite.yVelocity = -SLICE_SPEEDUP * sprite.yVelocity;

            return YES;
    }

- (void) sliceSpritesInSwipePath
{
    CGRect swipeRect = [swipePath bounds];

        for (NSUInteger i = 0; i < [sprites count]; i++)
        {
                Sprite *sprite = [sprites objectAtIndex: i];

                if ([sprite intersectsWithPathInArray: swipePoints
                                               inRect: swipeRect])
                        if ([self sliceSprite: sprite withPath: swipePath])
                        {

                                [self resetSwipe];

                                if (![sliceSound isPlaying])
                                        [sliceSound play];

                break;
                        }
        } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T18:20:10.230

是否需要特定的分割线？水果忍者只生成两半水果，就好像从中间裂开一样，这很容易做到：

*   创建两个宽度为原始精灵一半的精灵
*   将它们放置在原始精灵水平中心线的 1/4 和 3/4 处
*   添加旋转/加速度等。
*   修改纹理坐标，使左侧精灵拥有纹理的左半部分，而右侧精灵拥有纹理的右半部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T15:47:53.530

既然你在这里使用 CoreGraphics，为什么不简单地在绘制精灵时使用剪切路径呢？

复制要切片的精灵，然后应用简单的多边形来掩盖两半作为它们各自的剪切路径。你需要的函数被调用[`CGContextClip`](https://developer.apple.com/library/mac/documentation/graphicsimaging/Reference/CGContext/Reference/reference.html#//apple_ref/doc/c_ref/CGContextClip)，一个简短的教程可以在[这里](https://developer.apple.com/library/mac/documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF126)找到。

**编辑**：本教程列出了这个例子：

```
CGContextBeginPath (context);
CGContextAddArc (context, w/2, h/2, ((w>h) ? h : w)/2, 0, 2*PI, 0);
CGContextClosePath (context);
CGContextClip (context); 
```

这会将当前路径设置为圆形，然后将当前路径应用为剪切区域。

# c++ - 存储基础对象和派生对象的混合容器？

> ID：12234628
> 
> 赞同：2
> 
> 时间：2012-09-02T08:58:05.693
> 
> 标签：c++, inheritance

什么是正确的做法？我知道如果容器是基类值类型，那么存储的派生对象是“切片”的。如果容器是派生类类型，则不能存储基类对象。对？

如果使用指针，auto_ptr 不能使用，因为它有复制语义问题。shared_ptr 是解决此问题的唯一解决方案吗？

谁能提供解决此问题的更多详细信息、示例代码或在线文章？这应该是一个很常见的问题，但是我在教科书或网上没有找到太多关于它的信息。

提前致谢。

顺便说一句，我只是在 unique_ptr 上搜索。它似乎不支持复制语义。那么在STL中使用不是只比auto_ptr安全，而是可能由于缺乏复制语义，许多STL操作或算法不能在unique_ptr的容器上使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T09:05:25.807

如果您想要多态行为（并且确实想要），那么您必须使用指针或引用。这在很多地方都有很好的记录。

由于不能使用引用容器，因此必须使用指针容器。

现在，您可以使用您认为合适的任何类型的指针：`unique_ptr`或`shared_ptr`原始指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T09:04:15.323

最明显的解决方案是使用[std::unique_ptr](http://en.cppreference.com/w/cpp/memory/unique_ptr)：

```
class IBase {};
class Derived : virtual public IBase {};
std::vector<std::unique_ptr<IBase>> v;
v.push_back(std::unique_ptr<IBase>(new Derived())); 
```

您可以使用[std::shared_ptr](http://en.cppreference.com/w/cpp/memory/shared_ptr)，但它的所有权语义显着改变了程序的行为，使动态分配的对象保持活动状态，直到没有人持有对它们的引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T09:06:13.073

有 std::vector 和 std::shared_ptr 的例子。我想这就是你想要的。

```
#include <iostream>
#include <memory>
#include <vector>

class Base {
public:
   virtual void foo() {
      std::cout << "base" << std::endl;
   }
};

class Derived : public Base {
   void foo() {
      std::cout << "derived" << std::endl;
   }
};

int main()
{
   std::vector<std::shared_ptr<Base> > v;
   v.push_back(std::shared_ptr<Base>(new Base));
   v.push_back(std::shared_ptr<Base>(new Derived));

   for (auto it : v) {
      it->foo();
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T09:13:09.250

[http://www.boost.org/doc/libs/1_51_0/libs/ptr_container/doc/ptr_container.html]（Boost 指针容器库）就是为此而生的。

# java - 来自集合集合的唯一集合

> ID：12234639
> 
> 赞同：2
> 
> 时间：2012-09-02T08:59:38.163
> 
> 标签：java, algorithm, collections, set

我确实有`int`双，即；（整数，整数）

> 1) 给定 k 个这样的对，检查它们是否唯一。IE; 使用 k 对形成的 Set 的大小是 k ?
> 2) 如果给定的 k 个记录是唯一的，则按排序顺序存储它们（按 x 并按 y 解决冲突）
> 3) 给定 n 个大小为 k 的集合，创建一个集合。

如果 k = 3 ，要求 1 和 2 的示例

> (100, 100) (110, 300) (120, 200) 是一个有效的集合并按排序顺序排列。
> (100, 100) (300, 200) (200, 300) 是一个有效集合，但不是按排序顺序排列的。
> (100, 100) (100, 200) (100, 200) 在有效集合中

要求 3输入 示例：

> (100, 100) (200, 300) (300, 200)
> (100, 100) (200, 300) (300, 200)
> (100, 100) (201, 300) (300, 200)

输出：

> (100, 100) (200, 300) (300, 200)
> (100, 100) (201, 300) (300, 200)

这是与我面临的真正问题最接近的类比。我需要用 Java 完成这项工作，而我从未在 Java 中工作过。我是一名中级 C++ 程序员。

我可以通过一些丑陋的编码和排序来解决 1 和 2。
但是我无法获得 3。以下是到目前为止我可以获得的 3。类对实现了可比性

（poc代码）

```
import java.util.HashSet;
public class set {
    public static void main (String []args) {
        HashSet<Pair> s1 = new HashSet();
        s1.add(new Pair(10,10));
        s1.add(new Pair(10,10));

        HashSet<Pair> s2 = new HashSet();
        s2.add(new Pair(10,10));
        s2.add(new Pair(10,10));

        HashSet<HashSet<Pair>> s12 = new HashSet();
        s12.add(s1);s12.add(s2);
        for ( HashSet<Pair> hs : s12) {
            for (Pair p :  hs) {
                System.out.println(""+ p.toString());
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T11:01:18.527

看起来您没有覆盖`equals`和/或`hashCode`Pair 类中的方法。

例如，如果您的`Pair`班级具有以下结构：

```
protected K value1;
protected V value2; 
```

您应该实施`equals`and `hashCode`as(example) ：

```
 public boolean equals(Object obj) {
    if (!(obj instanceof Pair))
        return false;
    Pair that = (Pair)obj;
    boolean result = true;
    if (this.getValue1() != null)
        result = this.getValue1().equals(that.getValue1());
    else if (that.getValue1() != null)
        result = that.getValue1().equals(this.getValue1());

    if (this.getValue2() != null)
        result = result && this.getValue2().equals(that.getValue2());
    else if (that.getValue2() != null)
        result = result && that.getValue2().equals(this.getValue2());

    return result;
} 

public int hashCode() {
    int result = value1 != null ? value1.hashCode() : 0;
    result = 31 * result + (value2 != null ? value2.hashCode() : 0);
    return result;
} 
```

# python - 卸载 Activestate 搞砸了我的 python 目录和我的所有设置

> ID：12234642
> 
> 赞同：0
> 
> 时间：2012-09-02T09:00:53.440
> 
> 标签：python, graphviz, pygraphviz

所以我真的很想尝试通过执行以下操作使用 django-extensions 生成 django 模型图：

```
manage.py graph_models -a -g -o my_project_visualized.png 
```

然后我意识到我需要 pygraphviz 才能让它工作。我正在运行 Windows 7 64 位，因此我按照文档的建议安装了 Activestate 和 Graphviz 作为要求。Graphviz 2.28 安装得非常成功，然后安装了 Activestate 并进行了一些调整`msiexec /package activestate_install.exe /qr`，因为它总是停留在“完成检查所需的磁盘空间”。

后来，事实证明 activestate 并没有真正帮助安装 pygraphviz。因此，经过大量试验和错误，我设法按照本指南[http://blog.ropardo.ro/2011/11/28/installing-pygraphviz-on-windows/](http://blog.ropardo.ro/2011/11/28/installing-pygraphviz-on-windows/)安装了 pygraphviz 。就在我尝试再次运行 graph_models 命令时，python 再次告诉我 pygraphviz 模块没有安装......所以我冻结了它以查看它是否真的没有安装。现在好点来了，pip freeze 返回一个回溯，`ImportError: DLL load failed: %1 is not a valid Win32 application.`但这只发生在 virtualenvs 中，当退出 virtualenvs 和 pip freeze 时，它​​按预期工作。

通过谷歌搜索，我意识到我可能已经安装了一些 64 位版本的软件包，同时在我的机器上安装了 32 位 python 2.7.3，这确实是我所做的。只是我不记得我安装了哪些是 64 位的。现在是深夜，我又累又沮丧，所以我开始卸载我认为可能导致问题的东西。我卸载了 mingw32 和 Activestate，接下来我知道，我什至无法从命令行进入 python。pip 也不被识别；每个 python 包都无法识别。回来查看`Python27`目录，一半的文件夹都在`C:\Python27\Lib`. 以前有很多文件和文件夹，我想不起来是什么，现在只有 4 个目录：

```
bsddb, importlib, site-packages, and test 
```

而且`site-packages`文件夹也“更干净”了！我确信曾经有很多包文件和脚本（一些 .pth 文件和 .py 文件）。现在我安装的一些软件包只有两个文件`easy-install.pth`和`PIL.pth`一些文件夹。但是，最关键的问题是我现在什至不能在 cmd 中使用 python。

我想也许卸载activestate会弄乱我设置的一些环境变量，然后我进入系统设置并添加了诸如`C:\Python27\Scripts;C:\Python27\Lib\site-packages`PATH之类的东西。我回到 cmd，输入“python”和“pip”，python 得到的响应是`The system cannot find the path specified.`，pip 仍然是`'pip' is not recognized as an internal or external command, operable program or batch file.`

这是我唯一一次因为没有设置系统还原点而感到遗憾..

谁能告诉我这里发生了什么，我做错了什么，我应该如何让一切恢复正常？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:04:54.560

男孩，你确实搞砸了你的安装。“ActiveState”是一个适用于 Windows 的 Python 发行版，因此您在旧的 Python 发行版上安装了一个新的 Python 发行版。当您卸载时，它会主动删除您的 python 安装，包括默认库。

恐怕您必须重新安装 Python 安装。从头开始或备份。

你有我的同情，如果这是任何安慰的话。

# android - 根据选项过滤列表视图

> ID：12234645
> 
> 赞同：0
> 
> 时间：2012-09-02T09:01:18.883
> 
> 标签：android, listview, filtering

我有一个`ListView`连接到自定义的`ArrayAdapter`. 适配器采用具有 3 个字符串的对象 - （姓名、电话、邮政信箱）。我正在尝试为我实现一个过滤系统，该系统可以按**他们可以从微调器中选择**`ListView`的名称过滤列表。在他们选择特定名称后，列表应显示仅具有该名称的对象。

 **我搜索了很多解决方案，但找不到任何好的示例来解决我的问题，因为这是在许多应用程序中实现的，我相信有一个简单的解决方案。非常感谢。**

# javascript - 骨干 - Collection.add() / Collection.create() 之间的区别？

> ID：12234646
> 
> 赞同：6
> 
> 时间：2012-09-02T09:01:20.840
> 
> 标签：javascript, backbone.js

我对两者之间的差异感到困惑。似乎 Collection.create() （火灾`add`和`sync`事件）可以看作是 Collection.add() （火灾`add`）和 Model.save() （火灾`sync`）的组合？

上述评估是否正确？我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T10:05:20.327

这是正确的。这是一种捷径。[文档状态](http://backbonejs.org/#Collection-create)：

> **创造** `collection.create(attributes, [options])`
> 
> 方便在集合中创建模型的新实例。相当于实例化一个带有属性哈希的模型，将模型保存到服务器，创建成功后将模型添加到集合中。

和[带注释的源代码](http://backbonejs.org/docs/backbone.html#section-105)：

> 在此集合中创建模型的新实例。立即将模型添加到集合中，除非传递了 wait: true，在这种情况下我们等待服务器同意。

第二个描述更准确一点，因为只有传递`{wait:true}`具有在保存模型时出错的情况下不将模型添加到集合中的效果。

# eclipse-plugin - 将 GEF 编辑器（组合框）中的默认缩放控件更改为滑块

> ID：12234651
> 
> 赞同：3
> 
> 时间：2012-09-02T09:01:48.380
> 
> 标签：eclipse-plugin, eclipse-gef

我正在开发一个基于 GEF 的 Eclipse 编辑器。我为编辑器添加了缩放控件，但我希望它看起来不同（具体来说，我希望它是滑块而不是组合框）。有谁知道我该怎么做？在此先感谢，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T11:18:55.797

这很简单，只需覆盖

```
org.eclipse.gef.ui.actions.ZoomComboContributionItem.createControl(Composite) 
```

创建一个滑块，然后调用

```
org.eclipse.gef.editparts.ZoomManager.setZoomAsText(String) 
```

用正确的参数。

# html - 避免点击链接周围的虚线边框

> ID：12234653
> 
> 赞同：1
> 
> 时间：2012-09-02T09:02:16.920
> 
> 标签：html, css

单击时我有一个链接（实际上是一个下拉菜单链接）我在此链接周围有一个虚线边框。

我怎样才能避免这种行为？

![在此处输入图像描述](../Images/c0d500ff5c3fa18a9c710082c73ac9ac.png)

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T09:03:48.210

使用 CSS`:focus`和`:active`说明符：

```
.yourclass:focus, .yourclass:active {
    outline: 0; /*make sure no outline appears*/
} 
```

还有一个工作演示：[little link](http://jsfiddle.net/glee/Y2R7u/)。

希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-04T07:42:34.490

作为克里斯的附录，回答（尚无法评论）

确保还包括

```
.yourclass:focus { outline: 0; } 
```

以防止轮廓出现在焦点仍然在元素上的某些极端情况下。

# javascript - jPlayer - 设置播放一次且仅播放一次

> ID：12234655
> 
> 赞同：1
> 
> 时间：2012-09-02T09:02:38.943
> 
> 标签：javascript, jquery, audio, jplayer

我一直在寻找获得 jPlayer 实例以允许音频文件只播放一次的最佳方法。我想我可以`.jPlayer("destroy");`在活动完成后打电话，但我觉得必须有更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:34:04.353

```
$(id).jPlayer( "clearMedia" ) : jQuery 
```

您可以在播放一首歌曲后使用它来清除当前媒体。之后播放按钮不会播放任何内容，直到您通过使用`setmedia`方法使用新网址

# javascript - 序列化 html 标签内的 javascript 代码

> ID：12234661
> 
> 赞同：0
> 
> 时间：2012-09-02T09:03:54.807
> 
> 标签：javascript, json

我有一个 ajax 函数，它响应一个 html 标记的内容，作为一个 json 字符串，我将评估它以从中生成一个对象。

现在只要 json 字符串里面没有 javascript，它就可以正常工作。但是当我在字符串中包含一些简单的 javascript`Uncaught SyntaxError: Unexpected identifier`时，我会在尝试评估字符串时得到，尽管我会转义每个`'`and `"`。

这是示例：http: [//jsfiddle.net/dCtA3/2/](http://jsfiddle.net/dCtA3/2/)

当我删除 javascript: [http://jsfiddle.net/dCtA3/3/](http://jsfiddle.net/dCtA3/3/)它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:24:15.580

尝试使用正确的 JSON（如果您的 XHR 返回 JSON，使用它，解析它，或者检查浏览器是否已经为您解析它（应该是`[response].innerhtml`））。将您的 jsfiddle 代码更改为：

```
var contents = JSON.stringify(
  {innerhtml : "<p onclick=\"javascript:alert('hello world');\"> click me! </p>"}
);

function insertContent() {
    document.getElementById("container")
        .innerHTML = JSON.parse(contents).innerhtml;
}​ 
```

[根据评论**编辑**
] 看到[这个 jsfiddle](http://jsfiddle.net/KooiInc/HcadL/)，其中在按钮单击时模拟 json 请求。单击按钮后会显示字符串化的响应对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:07:57.913

你需要生成你的javascript代码吗？它必须在那个字符串中吗？如果 javascript 可以在您的 js 文件中，您可以简单地执行以下操作：创建一个执行警报的函数 helloWorld，并在您的 json 字符串中使用 html hance onclick="helloworld()"。

# javascript - 为什么我的“虚拟”阵列不工作？

> ID：12234666
> 
> 赞同：0
> 
> 时间：2012-09-02T09:04:16.383
> 
> 标签：javascript, arrays, ember.js

在这个例子中：http: [//jsfiddle.net/stephane_klein/Cgn2c/1/](http://jsfiddle.net/stephane_klein/Cgn2c/1/)

我想在“App.my_list2”中创建“虚拟”数组。

我的代码不起作用，我该怎么做才能修复它？我的问题是什么？

谢谢你的帮助。

最好的问候，斯蒂芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:31:14.227

看起来所需要做的就是将*content*属性设置为任何东西（即使只是一个空数组也可以）。见这里：http: [//jsfiddle.net/Cgn2c/2/](http://jsfiddle.net/Cgn2c/2/)

```
App.my_list2 = Ember.ArrayProxy.create({
    // the content propery is required, even if it's not used
    content: [],
    length: 8,
    objectAtContent: function(idx) {
        return "foobar";        
    }
});

<script type="text/x-handlebars">
    {{#each App.my_list2}}
        {{ this }}
    {{/each}}
</script>​ 
```

> foob​​ar foobar foobar foobar foobar foobar foobar foobar

# linux - 如何为 $PWD 添加空间逃逸

> ID：12234667
> 
> 赞同：6
> 
> 时间：2012-09-02T09:04:17.913
> 
> 标签：linux, bash, unix, terminal

我想用

```
ln -s $PWD ~/mylinkname 
```

但我面临的问题是我当前的路径有空间（因此 ln 无法正确执行）。

我相信解决方案应该很简单，但我搜索过找不到答案。

你知道如何解决这个问题吗？

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T09:06:06.917

如果您的参数有空格，它将把每个空格分隔的部分视为一个单独的参数。

为了防止这种情况，请引用任何有空格的参数，例如：

```
ln -s "$PWD" "$HOME/my link name with spaces" 
```

如果文件名有引号，你也可以用反斜杠转义它

```
ln -s "$PWD" "$HOME/my link name with spaces and this quote\"" 
```

代替 $HOME，您可以使用：

```
ln -s "$PWD" ~/"my link name with spaces" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-02T09:06:51.003

```
ln -s "$PWD" "$HOME/mylinkname" 
```

应该这样做。

# c++ - 哈希映射快速插入但检索缓慢

> ID：12234669
> 
> 赞同：0
> 
> 时间：2012-09-02T09:04:37.537
> 
> 标签：c++, performance, hashmap

我正在使用 google 的哈希映射 google::dense_hash_map 的实现。

我的是一个集群应用程序。所以我必须存储成对集群之间的距离。每个集群都有一个集群 id，它是一个 long int。所以密钥必须是 (long int id1, long int id2);

所以我决定在 hashMap 中需要一个 hashMap 才能工作。

这是我的距离存储哈希图的结构：

```
 google::dense_hash_map<long int, google::dense_hash_map<long int, double> > distanceHash; 
```

这是将距离插入哈希映射并检索它的代码

```
template<class Point>
void CoverTree<Point>:: insertDistance(long int id1, long int id2, long double distance)
{

  //Always id1 < id2;
  if(id1 < id2)
  {
    long temp = id1;
    id1 = id2;
    id2 = temp;
  }

  if(distanceHash.find(id1) == distanceHash.end())
  {
    google::dense_hash_map<long int, double> insideHash;
    insideHash.set_empty_key(-9999  );
    insideHash[id2] = distance;
    distanceHash[id1] = insideHash;
  }
  else
  {
    (distanceHash[id1])[id2] = (distanceHash[id1])[id2];
  }
}

template<class Point>
double CoverTree<Point>::getStoredDistance(long int id1, long int id2)
{
  if(id1 < id2)
  {
    long temp = id1;
    id1 = id2;
    id2 = temp;
  }

  google::dense_hash_map<long int, double>::iterator it;

  if(distanceHash.find(id1) != distanceHash.end())
  {

    if( distanceHash[id1].find(id2) != distanceHash[id1].end() ) 
      return distanceHash[id1][id2];
  }

  return -1;
} 
```

我有数百万的距离。上次我检查过，大约有 600000000 个距离，其中 400000000 个是唯一的。这意味着重复 1/3 的距离，可以节省时间。

但是当我使用这个散列映射结构来存储距离时，程序运行得更慢了。这正是我发现的：如果我只使用距离函数存储距离，那么整个程序的运行速度会慢约 50 秒。（200 秒带存储，150 秒不带）。但是如果我存储距离，然后在计算距离之前使用哈希图检查距离是否存在，程序会变得慢得多（程序的 1/25 需要 300 秒）。

我不明白这种行为。我猜想一旦存储了距离，检索距离应该会更快。请让我知道这里出了什么问题以及是否可以更快。

PS：内存不是问题。我在具有大约 160 GB RAM 的服务器上运行它。并且使用 hashmap 时的峰值内存消耗仅为总内存的 1.8%（使用 top 看到）。所以分页和抖动应该不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:16:15.520

`But If I store the distances and then use the hashmap to check whether the distances exist before computing them, the program becomes way way slower(1/25th of the program takes 300 seconds).`

我怀疑您正在找到所有元素来批准数据。

好的，hashmap 查找时间复杂度是 O(n)，但是你正在使用

```
distanceHash.find(id1) 
```

在`getStoredDistance`函数 n 次中两次，这使得最坏情况下的总复杂度为 O(n*n)

400M * 400M = 160000000000000000 太复杂了

# perl - 用于 Web 开发的 Perl

> ID：12234671
> 
> 赞同：2
> 
> 时间：2012-09-02T09:04:58.130
> 
> 标签：perl

如何从 Web 浏览器运行 Perl 脚本？是否需要某种 Web 服务器（例如，我们使用 Apache for PHP）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T09:12:06.777

> Now I want to know how I can run perl script on browser.

It certainly used to be possible to run client side PerlScript.

… providing the user had the ActiveState PerlScript plugin installed

… and was running Internet Explorer.

I've no idea if that is still available, but it isn't in common use on the WWW so would only be practical for system that you control (such as an Intranet application). Even then, the Internet Explorer lock in makes it a bad idea.

> Is there need any kind of web server as we use in Apache for PHP.

Server side Perl is the usual choice for the WWW, and that needs a webserver

All of the recent development I've seen (baring quick, hacky demos written in CGI), uses [Plack / PGSI](http://plackperl.org/). This defines an common interface between a Perl program and a number of means to interact with web servers (including CGI, FastCGI, mod_perl and mod_psgi). It also provides a `plackup` as a tiny webserver for testing and debugging.

It is used by most of the current crop of web frameworks for Perl

*   [Dancer](http://perldancer.org/)
*   [Catalyst](http://www.catalystframework.org/)
*   [Web::Simple](https://metacpan.org/module/Web%3a%3aSimple)
*   etc

Here is a very simple skeleton application I knocked together while figuring out PSGI. It just sends details of the request back to the browser.

```
use v5.12;
use Data::Dump qw/dump/;
use Plack::Request;

my $app = sub {
        my $env = shift;
        my $req = Plack::Request->new($env);
        my $content = dump($req->parameters);

        return [ 
                200,
                [ "Content-Type" => "text/plain" ],
                [ $content ]
        ];
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T09:27:10.850

在您的 DocumentRoot 中（或仅在您要执行 perl 脚本的文件夹中）添加一个名为`.htaccess`以下内​​容的文件：

```
Options -Indexes +ExecCGI
AddHandler cgi-script .pl 
```

从现在开始，每个具有扩展名的文件`.pl`都将在服务器端执行，然后再将输出发送到客户端。

您的文件必须以[shebang](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)开头，否则服务器将不知道如何解释其内容：

```
#!/usr/bin/perl

# And then your code...

use strict;
use warnings;

...
... 
```

这是您在实际运行 php 脚本时运行 perl 脚本所需的基本内容。当然，您需要一个 http 服务器（Apache 总是一个不错的选择）。

当然，如果您正在寻找一个让您的生活更轻松的开发框架，请查看其他答案。但是，它们都不需要在 web 服务器上运行 perl，如果您只想运行小脚本，它们几乎没用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T09:13:13.393

这是一个很大的话题。不知道从哪里开始推荐。

我认为您的意思是想在 Web 服务器中运行 perl 脚本，而不是在浏览器中（默认情况下不支持这种事情，我不知道有任何浏览器插件可以直接执行此操作）。对于 Web 服务器，最好的办法可能是选择一个框架（Catalyst、Dancer 等）或编写一些 CGI 脚本（请参阅 CPAN 上的 CGI::Simple 及其文档以了解从那里开始的好地方）。

此外，还有用于 Web 服务框架的 Plack 和 Mojolicious。这些可以连接到 Apache 和其他服务器，并且可以缓存代码。请记住，如果您的变量没有很好的作用域，缓存代码可能会导致有趣的副作用。

# php - 如何在 Kohana 中使用控制器拥有超过 2 个目录

> ID：12234672
> 
> 赞同：0
> 
> 时间：2012-09-02T09:04:58.227
> 
> 标签：php, url-routing, kohana-3.2

我有一个统计数据，其中可以存在许多改进，这是我的关于页面中的一个模型。我最初将页面构建为一个具有诸如“action_editimprovementstat”之类的愚蠢操作的巨型控制器。

所以我试图将东西移动到目录中，而不是所有东西都在“[...]/controller/about”中，我将东西移动到那里的透视文件夹中，例如：“[...]/controller/about/improvement /统计”

我更改了路由的正则表达式，因此控制器将接受斜杠，这由调试器判断是有效的，因为现在控制器文本将显示为“about/improvement/stat”，不幸的是它仍然告诉我请求的 url 可以'找不到。

那么，我问，拥有分层控制器结构的最简单方法是什么？

这是我更喜欢的控制器 URL 示例： /about /about/internal /about/external /about/improvement /about/improvement/stat

这些也会有动作，例如：/about/improvement/edit/6 /about/improvement/stat/delete/7

如果存在模棱两可的问题，我愿意妥协。（顺便说一句，如果我通过单个控制器进行自己的路由，我想我可以管理一种方式，但我想知道是否有更好的方式，或者这种方式是否有据可查[所以我可以从别人的经验中学习]。 )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T06:19:05.167

自从我学习了 Kohana 后，我的编程体验有了很大的提高，因为在使用 Kohana 之前，我从来没有考虑过我的 url 是如何构建的。在 MVC 世界中，使用 Pretty URLs 会让你真正思考你想要做什么以及如何去做。

在我看来，通过查看您在上面的示例中想要做的事情，在我看来您是在倒退。您说您首选的 URL 是： /about /about/internal /about/external /about/improvement /about/improvement/stat

在我看来，“关于”实际上是一个动作，而不是一个控制器。url "/about/" 非常令人困惑，因为它没有告诉我我正在获取什么信息，但我们可以放一张幻灯片，因为它可能与一般网站有关。“/about/internal”非常清楚，但在很多方面你都在尝试编写你的网址，以便它们以正确的英语阅读。实际上，我会将它们写为：/about、/internal/about、/external/about、/improvement/about、/improvement_stat/about

我不确定您为什么拒绝拥有多个控制器，除非您将控制器设置为模板控制器，并且您认为您必须为每个控制器都这样做。你没有。一般来说，我创建一个名为“page”的控制器，它是我的模板控制器。然后所有其他控制器扩展页面控制器。我可以在页面控制器中定义可以在扩展页面控制器的所有控制器中使用的常量和其他变量。

但是如果你真的拒绝编写多个控制器，你总是可以编写特定的路由来让你到达你想要的任何控制器和动作。例如，我使用一个路由进行比较，我希望最多 4 个 id 传递到我的路由中。我这样写了这条路线：

```
Route::set('thing_compare', 'thing/compare/<thing1>/<thing2>(/<thing3>(/<thing4>))')
    ->defaults(array(
        'controller' => 'thing',
        'action'     => 'compare'
    )); 
```

请注意，thing3 和 thing4 在括号中，这意味着它们是可选的。然后在我的控制器中，我可以通过执行以下操作来获取这些值：

```
$thing1 = $this->request->param('thing1'); 
```

但是回到您给出的示例，只需编写类似这样的路由（假设您的控制器名为“about”：

```
Route::set('about_internal', 'about/internal')
    ->defaults(array(
        'controller' => 'about',
        'action'     => 'about_internal'
    ));
Route::set('about_external', 'about/external')
    ->defaults(array(
        'controller' => 'about',
        'action'     => 'about_external'
    )) 
```

就我个人而言，我会避免设置这样的路由，并真正重新考虑如何设置你的 url，以便它创建一个明智的设计策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:23:11.367

如果您住的话，您可以简单地向路线添加其他变量或常量值。

[Kohana 文档](http://kohanaframework.org/3.0/guide/kohana/routing)甚至显示了一个具体示例，其中在路由前面添加了一个额外的目录，该目录只能具有两个给定值之一：

```
Route::set('sections', '<directory>(/<controller>(/<action>(/<id>)))',
    array(
        'directory' => '(admin|affiliate)'
    ))
    ->defaults(array(
        'controller' => 'home',
        'action'     => 'index',
    )); 
```

当然，您也可以在后面或中间添加值。唯一的要求是您的路线将始终至少产生一个控制器和一个动作。但它们实际上不必存在于 url 中。您可以指定与其他值匹配的路由，并为控制器和/或操作指定一个常量值，如下所示：

```
Route::set('search', ':<query>', array('query' => '.*'))
  ->defaults(array(
    'controller' => 'search',
    'action' => 'index',
  )); 
```

最大的陷阱：重要的是要理解**路由是按照添加的顺序匹配的**，一旦一个 URL 匹配一个路由，路由本质上就“停止”*了，其余的路由永远不会尝试*。因为默认路由几乎匹配任何东西，包括一个空的 url，新路由必须放在它之前。也许这就是现在的问题？

无论如何，与其添加技巧来匹配斜线，我宁愿创建一个接受大量可选变量的路由，这样您就可以从通用控制器中读取 'urlpart1' 到 urlpartX'。也就是说，如果你需要。当然，设置是让您为不同的 url 创建不同的控制器，因此您不需要具有巨大方法的巨大控制器来根据 url 部分决定要做什么。

# python - Python 3：sys.stdout 不工作

> ID：12234676
> 
> 赞同：0
> 
> 时间：2012-09-02T09:05:32.827
> 
> 标签：python, python-3.x

我正在尝试将输出重定向到 task1.txt。正常的打印功能可以正常工作，但无法使用 sys.stdout 修改文本。

```
import random
import sys
num_lines = 10

# read the contents of your file into a list
sys.stdout = open('C:\\Dropbox\\Python\\task1.txt','w')
with open('master.txt', 'r') as f:
    lines = [L for L in f if L.strip()]  # store non-empty lines

# get the line numbers of lines that are not marked
candidates = [i for i, L in enumerate(lines) if not L.startswith("*")] 

# if there are too few candidates, simply select all
if len(candidates) > num_lines:
    selected = random.sample(candidates, num_lines) 
else:
    selected = candidates  # choose all

# print the lines that were selected
# write.selected(sys.stdout)
print ("".join(lines[i] for i in selected))

# Mark selected lines in original content
for i in selected:
    lines[i] = "*%s" % lines[i]  # prepend "*" to selected lines

# overwrite the file with modified content
with open('master.txt', 'w') as f:
    f.write("".join(lines)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:08:24.250

不要重新分配`sys.stdout`. 相反，使用[函数](http://docs.python.org/py3k/library/functions.html#print)`file`上的选项：[`print()`](http://docs.python.org/py3k/library/functions.html#print)

```
with open('C:\\Dropbox\\Python\\task1.txt','w') as output:
    print ("".join(lines[i] for i in selected), file=output) 
```

# javascript - Javascript - onload 函数运行时未定义的变量

> ID：12234677
> 
> 赞同：2
> 
> 时间：2012-09-02T09:05:38.383
> 
> 标签：javascript, closures

```
for (var i=0, file; file=files[i]; i++) {
    if (file.type=='image/jpeg') {
        var reader = new FileReader();
        reader.onload = function(e) {
            $('#upload_preview').append('<img src="'+e.target.result+'" width="150" alt="" />');
            alert(file.type); // error - file is undefined
        }
        reader.readAsDataURL(file);
    }
} 
```

在定义文件的代码块中声明了变量读取器，但错误报告变量文件未定义。这让我发疯，我知道这是非常基本的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:17:24.697

所以`for (var i=0, file; file=files[i]; i++)`评论中提到的这个循环将`undefined`在最后一个循环中设置文件。您应该`each`在 for 循环中使用或调用函数来保存范围。

```
files.forEach(function(file){
if (file.type=='image/jpeg') {
    var reader = new FileReader();
    reader.onload = function(e) {
        $('#upload_preview').append('<img src="'+e.target.result+'" width="150" alt="" />');
        alert(file.type); // error - file is undefined
    }
    reader.readAsDataURL(file);
}
}) 
```

或者如果您需要支持旧版浏览器：

```
for (var i=0, l=files.length; i < l; i++) {
    (function(i) {
        var file = files[i];
        if (file.type == 'image/jpeg') {
            var reader = new FileReader();
            reader.onload = function(e) {
                $('#upload_preview').append('<img src="' + e.target.result + '" width="150" alt="" />');
                alert(file.type); // error - file is undefined
            }
            reader.readAsDataURL(file);
        }
    })(i);
} 
```

# c++ - 将 getline 与 CSV 一起使用

> ID：12234678
> 
> 赞同：1
> 
> 时间：2012-09-02T09:05:50.190
> 
> 标签：c++

我花了将近 4 个小时试图解决这个问题......

我有一个超过 100 行的文本文件。每行有 4 个用逗号分隔的值。我希望能够提取每个值并将其保存到变量中（v1...v4）。

我使用了 for 循环，因为我不会读取文件的全部内容。我只是想让 1 现在工作。

到目前为止，我已经设法读取了一行。我现在只需要打破这一行。这是我的 Uni 作业，我不允许使用任何 boost 或 tokeniser 类。只需 getline 和其他基本命令。

我有这个代码：

```
// Read contents from books.txt file
ifstream theFile("fileName.txt");
string v1, v2, v3, v4, line;

for (int i = 0; i < 1; i++) {
    getline(theFile, line, '\n');
    cout << line << endl;  // This part works fine
    getline(line, v1, ",");  // Error here
    cout << v1 << endl;
    getline(line, v2, ",");  // Error here
    cout << v2 << endl;
    getline(line, v3, ",");  // Error here
    cout << v3 << endl;
    getline(line, v4, '\n');  // Error here
    cout << v4 << endl;
}

theFile.close(); 
```

我得到的错误是 - 错误：没有匹配函数调用 'getline(std::string&, std::string&, const char [2])

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:09:01.327

The delimiter for getline is a character. You have used double-quote marks `","` which represent a string (hence why the compiler error indicates that you've used `char[2]` - string literals contain an additional 'nul' character).

Single character values are represented using single quotes instead:

```
getline(myFile, v1, ','); 
```

*edit* - I've just noticed you're passing a *string* as the first parameter, which getline doesn't support (it won't let you retrieve tokens directly from a string). You probably wanted to stuff the string into a `stringstream` instead

```
#include <sstream>

// etc ...

std::string csv = "the,cat,sat,on,the,mat";
std::istringstream buffer( csv );
std::string token;

while( std::getline( buffer, token, ',' ) )
{
    std::cout << token << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T09:11:22.333

According to [this](http://en.cppreference.com/w/cpp/string/basic_string/getline) page, you have to call `getline` with `std::istream` as the first parameter.

But `line` is of type `std::string`. You should pass a `std::istream` instead, which can be done by creating an `std::istringstream` from `line`. This could work:

```
string v1, v2, v3, v4, line;
istringstream line_stream;

for (int i = 0; i < 1; i++) {
    getline(theFile, line, '\n');
    cout << line << endl;
    line_stream.str(line); // set the input stream to line
    getline(line_stream, v1, ","); // reads from line_stream and writes to v1
... 
```

If you want to read more about `std::istringstream`, you can do that [here](http://www.cplusplus.com/reference/iostream/istringstream/).

Also, according to the above page, the third parameter has to be of type `char`. But you pass `","` which will automatically converted to `const char[2]`, a string. For characters, you use `'c'`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T10:58:03.313

```
string filename, text, line;
vector<string> v1; 
vector<string> v2;
vector<string> v3;
vector<string> v4;
int i = 0, k = 0, n;
cout << "Enter filename." << endl;
cin >> filename;
cout << "How many lines of text are in the file?" << endl;
cin >> n;
cin.ignore(200, '\n');
ifstream file(filename.c_str());
if (!file) {
           cerr << "No such file exists." << endl;
           exit(1);
           }
cin.ignore(200, '\n');
if (file.is_open()) {
    while (file.good()) {
           for (k = 0; k < n; k++) { //Loops for as many lines as there are in the file
                for (i = 0; i < 4; i++) { //Loops for each comma-separated word in the line
                              getline(cin, text, ',');
                              if (i == 0)
                                    v1.push_back(text);
                              else if (i == 1)
                                   v2.push_back(text);
                              else if (i == 2)
                                   v3.push_back(text);
                              else if (i == 3)
                                   v4.push_back(text);
                               }
                              }
                          }
                }
file.close();
return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T11:00:34.020

std::getline 有两个重载：

```
istream& getline ( istream& is, string& str, char delim );
istream& getline ( istream& is, string& str ); 
```

您的三个调用将*文字字符串常量*作为第三个参数传递，其中`char`需要一个。使用`'`而不是`"`用于字符常量。

# .net - Operation with big integers

> ID：12234681
> 
> 赞同：0
> 
> 时间：2012-09-02T09:06:14.190
> 
> 标签：.net, visual-c++, c++-cli, biginteger

I wrote simple C++/CLI code to calculate a result of big integer numbers operation, but it failed with the warning warning `C4307: '*' : integral constant overflow`, here is my code:

```
int main(array<System::String ^> ^args)
{
    String^ number = gcnew String((wchar_t *)(28433 * (2 ^ 7830457) + 1));

    Console::WriteLine(number);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:24:41.227

2 ^ 7830457 需要 7830457 位来存储。一个号码大约1MB！
您应该从学习变量类型和它们可以处理的值开始。你真的需要这个数字的精确整数值吗？你真的需要展示它吗？这个数字有几百万个字符长。

您不能对此类数字使用常规 */-+^ 运算符，您需要一个任意大数数学库。而且我担心它甚至无法处理这么大的数字。 [如何处理任意大的整数](https://stackoverflow.com/questions/310276/how-to-handle-arbitrarily-large-integers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:44:09.027

您的代码中有一些基本的误解：

1.  你没有在任何地方使用大整数
2.  `^`是异或，而不是指数。
3.  您正在将该整数转换为指针，这是一个毫无意义的操作

您应该使用[`BigInteger`来自](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.aspx). `System.Numerics`不要忘记首先添加程序集引用`System.Numerics.dll`。

# ruby - ruby multipart post image with digest auth

> ID：12234682
> 
> 赞同：0
> 
> 时间：2012-09-02T09:06:16.540
> 
> 标签：ruby, api, httpclient, multipart

Given I have this, using Ruby 1.9.3p194

Authentication is digestauth

```
require 'json'
require 'httpclient'

API_URL= "https://api.somewhere.com/upload"
API_KEY='blahblah'
API_SECRET ='blahlbah'
IMAGE ='someimage.png'

h=HTTPClient.new
h.set_auth(API_URL, API_KEY, API_SECRET)

File.open(IMAGE) do |file|
  body = { 'image' => file}
  res = h.post(API_URL, body)
  p res.inspect
end 
```

I get errors

Ive tried Typheous, Patron, Mechanize, Curl but want to find a way that is simple and works e.g.

```
curl --digest -u myusrname:password  -F "image=@image.png" "https://api.somewhere.com/upload" 
```

Curl posts nothing and doesnt work as expected. Ive been assured that the API accepts posts, I have a simple web page that does what I need to do via a simple form and it works fine

Any one know what the easiest way ahead is?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T15:33:57.973

解决它，回到路边。它是一个 RESTful API，RestClient 对摘要做了一些时髦的事情。HttpClient 也发布了空白文件。路边做到了。

# c# - SQLite Join in Windows 8 Metro C# with sqlite-net

> ID：12234687
> 
> 赞同：5
> 
> 时间：2012-09-02T09:07:39.540
> 
> 标签：c#, sql, join, windows-8, microsoft-metro

I am using C# and SQLite for a Database for a Windows-8-Metro-App. I want to use a Join-Command, but don't know how to read the given back data. This will not work:

```
db.Query<Person>("SELECT * FROM Person, Job WHERE Person.JobID = Job.ID"); 
```

And this is not implemented:

```
db.Query<Person, Job>("SELECT * FROM Person, Job WHERE Person.JobID = Job.ID"); 
```

Someone has an idea how to do this?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T09:10:57.133

The join is fine, if antiquated - you should use the newer syntax

```
 SELECT * FROM Person INNER JOIN Job ON Person.JobID = Job.ID 
```

Your problem is in what you are returning - you are returning both Person data and Job data - so you need to create a class that matches the data structure that you are returning - or return just a person, or a job.

```
 db.Query<Person>("SELECT Person.* FROM Person INNER JOIN Job ON Person.JobID = Job.ID");           
 db.Query<Job>("SELECT Job.* FROM Person INNER JOIN Job ON Person.JobID = Job.ID"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T03:24:28.500

我能够正常使用它，你可以试试。

```
 var db = new SQLiteAsyncConnection(_dbPath);
 var query = from person in await db.Table<Person>().ToListAsync()
                    join job in await db.Table<Job>().ToListAsync()
                    on person.JobID = job.ID
                    select new
                    {
                        Name=person.Name
                    }; 
```

# python - Python program works in Eclipse but not when I run it directly (Unicode stuff)

> ID：12234690
> 
> 赞同：3
> 
> 时间：2012-09-02T09:08:41.387
> 
> 标签：python, eclipse, unicode, wxpython

I have searched and found some related problems but the way they deal with Unicode is different, so I can't apply the solutions to my problem.

I won't paste my whole code but I'm sure this isolated example code replicates the error: (I'm also using wx for GUI so this is like inside a class)

```
#coding: utf-8
...
something = u'ЧЕТЫРЕ'
//show the Russian text in a Label on the GUI
self.ExampleLabel.SetValue(str(self.something)) 
```

On Eclipse everything works perfectly and it displays the Russian characters. However when I try to open up Python straight through the file I get this error on the CL:

```
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-11: 
ordinal not in range(128) 
```

I figured this has something to do with the CL not being able to ouput the Unicode chars and Eclipse doing behind-the-scene magic. Any help on how to make it so that it works on its own?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T09:11:16.090

When you call `str()` on something without specifying an encoding, the default encoding is used, which depends on the environment your program is running in. In Eclipse, that's different from the command line.

Don't rely on the default encoding, instead specify it explicitly:

```
self.ExampleLabel.SetValue(self.something.encode('utf-8')) 
```

You may want to study the [Python Unicode HOWTO](http://docs.python.org/howto/unicode.html#unicode-howto) to understand what encoding and `str()` do with unicode objects. The wxPython project has a [page on Unicode usage](http://wiki.wxpython.org/UnicodeBuild) as well.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:10:50.917

Try `self.something.encode('utf-8')` instead.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T08:42:09.113

如果您使用 repr 而不是 str 它应该为您处理转换，并且还涵盖对象并不总是字符串类型的情况，但您可能会发现它在您的上下文中为您提供了一组额外的引号甚至 unicode u . repr 比 str 更安全 - str 假定为 ascii 编码，但 repr 将以与您在代码中看到它们的方式相同的方式显示您的代码点，因为使用 eval 包装应该将其转换回原来的样子 - repr 必须采用 python 代码的形式，即 ascii 安全，因为大多数 python 代码都是用 ascii 编写的。

# c++ - Hex editing GBA in C++

> ID：12234699
> 
> 赞同：0
> 
> 时间：2012-09-02T09:10:21.283
> 
> 标签：c++, hex, game-boy-advance

I am Programming on Mac OS X 10.6 with XCode. Im trying to make a Programm that "decrypts" a Pokemon GBA game so that you can read the dialogs of the game with any Text Editor.

I already got a programm finished witch does that, so I can read all Text Data.

My problem is, that I need to change the clear Text back to Hex after editing it, but I have no Idea what im making wrong.

```
string PathDE;
string PathGBA;
string Zeichen;
int kontrolle = 0;
int current = 0;

char buffer1[3] = "00";
char buffer2[3] = "a1";
...

schreiben.open(PathGBA.c_str(), ios::out | ios::binary); //writes out the edited hex
lesen.open(PathDE.c_str(), ios::in); //reads in the plain text

while(current <= kontrolle){
    lesen.read(reinterpret_cast<char*>(&a), 1);
    converter << a;
    converter >> Zeichen;
    if(Zeichen == "_"){
        schreiben.write(buffer1,3);
    }
    else if(Zeichen == "0"){
        schreiben.write(buffer2,3);
    }
... 
```

I Tryed that, but when I open the result in a Hex Editor, the ASCII code is only a8.a8.a8.a8... and so on till eof, and the Hex code is 61 38 00 ... till eof.

I also tryed other methods, but all with the same result, I cant write the decoded GBA as Hex so I can play it with edited Text.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-07T04:09:07.223

您需要将字符串转换为具有正确编码的 byte[]。这是 Pokemon [http://datacrystal.romhacking.net/wiki/Pok%C3%A9mon_FireRed_-_TBL的 Gen3 文本表](http://datacrystal.romhacking.net/wiki/Pok%C3%A9mon_FireRed_-_TBL)

一旦正确转换，您只需将其插入您的 rom。

抱歉，如果这没有多大帮助，但我只制作了 c# Pokemon 工具，而不是 c++。

顺便说一句，口袋妖怪不使用 ascii 十六进制加密，它使用一种 utf8 形式。

# xna - XNA 4.0 ClickOnce game does not run after installation

> ID：12234700
> 
> 赞同：4
> 
> 时间：2012-09-02T09:10:24.843
> 
> 标签：xna, installation, clickonce

Okay, I have been looking all over to solve this problem before I actually broke down and decided to finally ask for my psecific problem. I am using ClickOnce installation and when I use the setup.exe to install nothing runs, not even on my personal computer that I know has all of the proper libraries and such. I'm not sure what I am doing wrong so it is difficult to explain the problem.

I have included dotNetFramework4.0 client x86 x64 , xna redistributable 4.0 and windows installer 3.1 along with my game and I have it set to install all of that with setup , also I have it set to download prereqs from same location as application. I've tried it on three separate computers , one that does not have XNA or VS C# installed and the same problem occurs.

> > Here is the problem , after I install the game nothing runs, I try clicking on the ClickOnce application file (the one with my game's icon image) and again nothing happens. The thing that really bugs me is that there isn't any errors or crashes or anything , it's almost like clicking on the desktop screen. (I looked at the properties of the "shortcut" that was installed with the game and the file size of the shortcut is like 300 bytes. Isn't that really small? I was thinking maybe there is a problem with a startup executable? I'm not sure though.)

I've tried tweaking some stuff in the Publish section of my project , such as un-checking the box that says "use .deploy extension files" (I don't know why, I've been grasping at straws here) I've been looking into some other installers such as NSIS but I don't know how to compile a list of files to include in other installers and I feel like that won't solve the problem anyway because I've gotten ClickOnce to work with me before.

On one computer there was an error report that said something about 'deployment and application do not have matching security zones.'

> > Game.application resulted in exception. Following failure messages were detected: + Deployment and application do not have matching security zones.

It's getting late so if I need to provide more information let me know.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T17:19:20.060

ClickOnce 可能是一个善变的事情。有时我遇到的错误只能通过重新创建整个 Windows 用户配置文件来解决。因为 ClickOnce 有很多不同的选项，所以我很难诊断出您的确切问题，所以我只能提供我曾经通过 ClickOnce 成功安装的选项。

*   发布文件夹：本地文件夹
*   安装文件夹 URL：空白
*   安装方式：离线
*   申请文件
    *   确保游戏文件的发布状态设置为包含（自动）
    *   确保 XNA 库的发布状态设置为先决条件（自动）
*   单击先决条件
    *   Microsoft .NET Framework 4 客户端配置文件
    *   Microsoft XNA 框架可再发行组件 4.0
    *   视窗安装程序 3.1
*   不检查更新
*   选项下的所有其他默认设置（发布商/套件名称不应影响任何内容）
*   指定版本号
*   立即发布

通过发布位置提供的 setup.exe 安装游戏。我总是分发每个发布的文件。但是，如果您不希望分发历史记录，您可以清理“应用程序文件”文件夹中的旧版本。

您可以仔细检查“应用程序文件”文件夹以查看您的版本是否正确发布（查看已部署的文件并查看它们是否与您的项目内容匹配）。

# shell - Unix shell to prompt user for filename

> ID：12234702
> 
> 赞同：3
> 
> 时间：2012-09-02T09:10:28.957
> 
> 标签：shell, unix

please pardon since I am a UNIX beginner.

I wanna write a shell script that can ask user type in the filename and output the number of lines in that file, here is my code:

```
echo "Pls enter your filename:"
read filename
result=wc -l $filename

echo "Your file has $result lines" 
```

However, I couldn't get it working since it complains about the identifier "filename". Could experts help?Thanks !!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T09:12:52.963

这很好用，至少在`bash`. 嗯，`read`工作正常。但是，分配给的`result`可能应该是：

```
result=$(wc -l $filename) 
```

但是，由于该命令同时输出行数*和*文件名，您可能需要稍微更改它以获取行数，例如：

```
result=$(cat $filename | wc -l) 
```

或者：

```
result=$(wc -l <$filename) 
```

您拥有的命令：

```
result=wc -l $filename 
```

将设置`result`为文字`wc`，然后尝试执行`-l`命令。

例如，下面的五行脚本：

```
#!/bin/bash
echo "Pls enter your filename:"
read filename
result=$(cat $filename | wc -l)
echo "Your file has $result lines" 
```

将在运行并将其名称作为输入时产生以下内容：

```
Your file has 5 lines 
```

* * *

如果您*不*使用`bash`，则需要指定您使用的 shell。不同的shell有不同的做事方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:31:38.157

干得好 ：

```
echo "Pls enter your filename:" 
read filename 
result=`wc -l $filename | tr -s " " | cut -f2 -d' '`

echo "Your file has $result lines" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T09:12:49.827

如果你想评估 wc -l $filename ，你不必这样做：

```
result=$(wc -l $filename) 
```

否则，使用 result=wc -l $filename，bash 会将 wc 分配给 result，并将下一个单词 (-l) 解释为要运行的命令。

# asp.net - Intellisense 未显示代码中的某些控件

> ID：12234712
> 
> 赞同：1
> 
> 时间：2012-09-02T09:11:54.513
> 
> 标签：asp.net, code-behind, object-reference

我是一个 asp.net 初学者，我正在尝试动态设置可见属性，但我无法在后面的代码中访问“TestLinkBox”或“TestLink”ID。我尝试重建解决方案，删除designer.cs文件并让它重新创建并尝试了我在stackOverflow上找到的一些解决方案，正如您在后面的代码中看到的那样，但我总是得到“对象引用未设置为实例一个东西。” 错误。我究竟做错了什么？

**ASP.NET 代码的一部分**

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Public/Main.Master"
AutoEventWireup="true" CodeBehind="SpecifikacijaDetails.aspx.cs" Inherits="web.Public.SpecifikacijaDetails"
%>
    <asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server"></asp:Content>
    <asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
        <mc:VijestiTraka ID="vijestitraka" runat="server"></mc:VijestiTraka>
        <div class="middle_content_box">
            <asp:ListView ID="ListView1" runat="server" DataKeyNames="SpecifikacijaID"
            DataSourceID="SqlDataSource1">
                <AlternatingItemTemplate>
                    <div class="details_title_box">
                        <p class="title"><strong><%# Eval("Brand") %></strong> 
                            <%# Eval( "Model") %>
                        </p>
                    </div>
                    <div class="left_column">
                        <div class="pregled_modela_slika margb30">
                            <img src='<%# Eval("SlikaMobitela") %>' />
                        </div>
                        <div id="TestLinkBox" class="testLink" runat="server" visible="false">
                            <asp:HyperLink runat="server" ID="TestLink" NavigateUrl='<%#"~/Public/TestSpecifikacije.aspx?SpecifikacijaID=" + Eval("SpecifikacijaID")%>'
                            Text="Pogledajte kompletan test"></asp:HyperLink>
                        </div> 
```

**代码背后**

```
using (MobBL temp = new MobBL())
{
    if (temp.ProvjeriImalTest(Int32.Parse(Request.QueryString["SpecifikacijaID"])) > 0)
    {

        //ListView1.FindControl("link_za_test").Visible = true;

        //HtmlControl htmlDivControl = (HtmlControl)Page.FindControl("link_za_tet");
        //htmlDivControl.Visible = true;
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:17:15.790

您试图在后面的代码中访问的控件位于项目模板中。出于这个原因，您不能通过智能感知访问它们，因为它们实际上不在表单上 - 它们将在绑定父控件 (ListView1) 时添加。

Subscribe the the [item databound event](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.itemdatabound.aspx) of the listview control. In there, you can access the child controls for each item in the listview. Something like this would get you the control:

```
e.Item.FindControl("TestLinkBox"); 
```

# python - Python区分错误

> ID：12234713
> 
> 赞同：1
> 
> 时间：2012-09-02T09:11:56.667
> 
> 标签：python, if-statement

我正在编写一个程序，它读取两个相同（字符串）长度的蛋白质，并返回有多少氨基酸字母不同。我设法编写了一些位，但不幸的是无法完成所有这些，所以任何人都可以通过查看我的代码来指导：

```
a = raw_input("Cheetah protein: ")
b = raw_input("Domestic cat protein: ")
u=zip(a,b)
d=dict(u)
x = 1
for i,j in d.items(): 
    if i == j:
        x = x + 1   
print x 
```

这是我想要产生的输出：

```
Cheetah protein: IGADKYFHARGNYDAA
Domestic cat protein: KGADKYFHARGNYEAA
2 difference(s). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:20:54.440

我认为你应该更好地描述你想要达到的目标。我不明白这个检查：

```
if i == j: 
```

如果要检查差异，则应改为：

```
if i != j: 
```

在此修复后，您的代码为您的 cat 和 cheetah 示例提供了 3 个不同之处 - 您确定示例正确吗？

**编辑**：好的，我看到你从一个开始计算差异。换行

```
x = 1 
```

到

```
x = 0 
```

我认为您不想假设始终存在至少一个差异；-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:21:02.943

```
a="IGADKYFHARGNYDAA"
b="KGADKYFHARGNYEAA"

u=zip(a,b)          
x = 0               # not 1
for i,j in u:       # you don't need a dict here
    print i,j, 
    if i != j:      # they differ iff they are not equal to each other
        x = x + 1
        print "  neq" 
    else:
        print " eq"  
print x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T09:21:21.087

```
func=lambda x,y: ((x!=y) and 1) or 0
print sum(map(func, a,b)), 'difference(s)' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T19:04:48.867

不同的蛋白质具有不同的氨基酸序列（“字母”），但也有不同的长度。没有答案可以解决这个问题，因为您没有要求。回答你的问题：

```
>>> a="IGADKYFHARGNYDAA"
>>> b="KGADKYFHARGNYEAA"
>>> sum(1 for x, y in zip(a,b) if x!=y)
2 
```

我使用“生成器表达式”为每对不同的氨基酸生成一个数字并进行总结。现在，如果您想使用类似的方法发现变化的氨基酸：

```
>>> diff = ''.join('-' if x==y else y for x, y in zip(a,b))
>>> print 'A:', a, '\nB:', diff
A: IGADKYFHARGNYDAA
B: K------------E-- 
```

# eclipse - Running eclipse project on android device

> ID：12234715
> 
> 赞同：1
> 
> 时间：2012-09-02T09:12:00.957
> 
> 标签：eclipse, connection, usb, device

i'm new into programming for android. And i have few problems with connecting and debugging my eclipse project on android device - which is my phone Samsung Galaxy SIII. According to this [link](http://developer.android.com/training/basics/firstapp/running-app.html) I tried to launch my app on my phone. Saddly when i press run button it tells me that there's no android device connected. And as you may know im not that dumm to not plug it into my computer. Additionally i have USB Debug mode ticked in options. My PC recognises it as "SAMSUNG Android ADB Device".

Some of you might say that i should start using emulator to have better view how this app will work on other phones/versions of android/etc. Thing is that my PC is quite old, and running an emulator makes it respond so slowly that it's nearly impossible to do anything on this emulated device. Plus... im quite sure that i wont publish this app on play store so i dont need to know if it will work on other devices. I just want to make a weather widget for me since stock one that uses accuweather.com tends to fail weather forecast for my country (like it says heavy rain on sunny day).

So here are the things that i have done so far to try to launch:
1\. Uninstalled device and set some new drivers that should have helped me - saddly not ;]
2\. Tried launching it via command line
3\. I found somewhere on the Internet that it is possible to connect and test your app via WiFi using tcpip over 5555 port... saddly it failed too.

Any ideas what else should i try to make it work?

# c# - error getting start date from week no C#

> ID：12234717
> 
> 赞同：0
> 
> 时间：2012-09-02T09:12:25.553
> 
> 标签：c#, datetime, time

I have this code:

```
// setting first day of year
DateTime jan1 = new DateTime(year, 1, 1);
// setting day offset from the cultureinfo FirstDayOfWeek
int daysOffset = (int)CultureInfo.CurrentCulture.DateTimeFormat.FirstDayOfWeek - (int)jan1.DayOfWeek;
// setting the first monday of the year
DateTime firstMonday = jan1.AddDays(daysOffset);
// no. On first week
int firstWeek = CultureInfo.CurrentCulture.Calendar.GetWeekOfYear(jan1, CultureInfo.CurrentCulture.DateTimeFormat.CalendarWeekRule,DayOfWeek.Monday);
//
if (firstWeek <= 1)
{
    week -= 1;
}
return firstMonday.AddDays(week * 7); 
```

The problem is when im testing it with dates like these

```
var a = TimeHelper.Week_GetStartAndEnd(2005, 29); // 11/7/2005 needs to be 18/7/2005
var b = TimeHelper.Week_GetStartAndEnd(2005, 28); // 4/7/2005 needs to be 11/7/2005
var c = TimeHelper.Week_GetStartAndEnd(2005, 32); // 1/8/2005 needs to be 8/1/2005
var d = TimeHelper.Week_GetStartAndEnd(2005, 52); // 19/12/2005 needs to be 26/12/2005
var e = TimeHelper.Week_GetStartAndEnd(2005, 38); // 12/9/2005 needs to be 19/9/2005
var f = TimeHelper.Week_GetStartAndEnd(2005, 41); // 3/10/2005 needs to be10/10/2005
var g = TimeHelper.Week_GetStartAndEnd(2005, 30); // 18/7/2005 needs to be 25/7/2005
var h = TimeHelper.Week_GetStartAndEnd(2000, 44); // 23/10/2000 needs to be 30/10/200
var j = TimeHelper.Week_GetStartAndEnd(1995, 41); // 9/10/2005 OK!
var r = TimeHelper.Week_GetStartAndEnd(2012, 42); // 15/10/2012 OK!
var t = TimeHelper.Week_GetStartAndEnd(2016, 21); // 16/5/2016 needs to be 23/5/2016
var u = TimeHelper.Week_GetStartAndEnd(2008, 13); // 24/3/2008 OK!
var aa = TimeHelper.Week_GetStartAndEnd(2012, 28); // 9/7/2012 OK!
var ab = TimeHelper.Week_GetStartAndEnd(2014, 37); // 8/9/2014 OK!
var ba = TimeHelper.Week_GetStartAndEnd(2018, 52); // 24/12/2018 OK! 
```

Why are half of them correct and the other half a week too early?

# php - 使用PHP进行加密

> ID：12234718
> 
> 赞同：-2
> 
> 时间：2012-09-02T09:12:34.683
> 
> 标签：php, string, encryption, key, encode

我想加密整个 PHP 文件的内容。我找到了这个，四处搜索：

```
$key = 'password to (en/de)crypt';  
$string = ' string to be encrypted '; // note the spaces 
```

加密：

```
$encrypted = base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($key), 
                           $string, MCRYPT_MODE_CBC, md5(md5($key)))); 
```

我想使用完全相同的方法，但我不知道如何。
我需要删除文件的标签吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:17:41.583

只需使用`file_get_contents()`读取文件，将其存储在 中`$string`，对其进行加密，然后使用`file_put_contents()`.

# symfony - Symfony2：语言环境、日期和法语格式

> ID：12234727
> 
> 赞同：3
> 
> 时间：2012-09-02T09:13:24.180
> 
> 标签：symfony, internationalization, twig

Symfony2 中的语言环境管理有一些我不明白的地方。我想用*date* Twig 方法用法语写月份名称。是否可以？我做不到。

似乎我的语言环境没有被考虑在内。

这是我的*app/config/config.yml*文件：

```
framework:
    #esi:             ~
    translator:      { fallback: fr }
    secret:          %secret%
    charset:         UTF-8
    router:          { resource: "%kernel.root_dir%/config/routing.yml" }
    form:            true
    csrf_protection: true
    validation:      { enable_annotations: true }
    templating:      { engines: ['twig'] } #assets_version: SomeVersionScheme
    session:
        default_locale: fr
        auto_start:     true 
```

会话区域设置似乎不错：

```
echo $this->get('session')->getLocale();  // Returns "fr"
die; 
```

然而，在我看来，当我使用以下内容时：

```
<td class="month">{{ history.date|date('F Y') }}</td> 
```

例如，它返回我“2011 年 7 月”，而不是“2011 年 Juillet”。

我有什么误解？*日期*过滤器不应该本地化吗？如果没有，我该如何检索正确的术语？我曾经使用 I18N 翻译所有月份名称，但我认为这不是最佳做法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T10:53:39.060

[date](http://php.net/manual/en/function.date.php)不返回本地化字符串。您必须为此使用[strftime](http://php.net/manual/en/function.strftime.php)。或者，如果您想要更多控制权，您可以使用[SonataIntlBundle 。](https://github.com/sonata-project/SonataIntlBundle/blob/master/Resources/doc/reference/datetime.rst)

# c# - 树视图如何扩展完整路径

> ID：12234729
> 
> 赞同：3
> 
> 时间：2012-09-02T09:13:38.147
> 
> 标签：c#

我需要根据 C# 中的完整路径扩展我的树视图

我的树视图有 2 个已折叠的节点，我想扩展`Node A`为数字`3` ，所以我有 node 的完整路径`A\1\2\3`。

如何根据完整路径单步执行并打开每个节点？此外，完整路径的长度可能会发生变化，因此我可能需要将节点打开到**6 级**。所以需要根据全路径来做。任何帮助都会很棒。

```
Node A
       1
         2
          3
Node B
1
 2
  3
   4 5 6 
```

这是我尝试过的：

```
TreeNode [] n= treeView1.Nodes.Find(search, true);

if (n.Length > 0)
  found = true;
treeView1.Nodes[t].Collapse();
foreach (TreeNode p in n) {
  string[] a = p.FullPath.Split('\\');
  foreach (string b in a) {
    treeView1.SelectedNode = treeView1.Nodes[b];
    treeView1.SelectedNode.Expand(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-04T22:59:28.140

很抱歉没有评论 S3ddi9 给出的上述答案是正确的。我只是添加一些东西。

所以S3ddi9给出的答案

```
 ...
    string path = @"A\1\2\";

    var path_list = path.Split('\\').ToList();
    foreach (TreeNode node in treeView1.Nodes)
        if (node.Text == path_list[0])
            ExpandMyLitleBoys(node, path_list);
}

private void ExpandMyLitleBoys(TreeNode node, List<string> path)
{
    path.RemoveAt(0);

    node.Expand();

    if (path.Count == 0)
        return;

    foreach (TreeNode mynode in node.Nodes)
        if (mynode.Text == path[0])
          {  
             ExpandMyLitleBoys(mynode, path); //recursive call
             break;  //this was missing in earlier answer
          } 

} 
```

确实有效，但是您必须添加一个 BREAK （我标记了它），因为如果 for 循环没有完成，`return;`则不会将您返回到您的 main 函数，并且会抛出异常，因为`path[0]`is `null`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:47:11.997

我希望这会更简单，对于**Treeviews**，最好的方法是使用**递归**方法

```
 ...
        string path = @"A\1\2\";

        var path_list = path.Split('\\').ToList();
        foreach (TreeNode node in treeView1.Nodes)
            if (node.Text == path_list[0])
                ExpandMyLitleBoys(node, path_list);

    }

    private void ExpandMyLitleBoys(TreeNode node, List<string> path)
    {
        path.RemoveAt(0);

        node.Expand();

        if (path.Count == 0)
            return;

        foreach (TreeNode mynode in node.Nodes)
            if (mynode.Text == path[0])
                ExpandMyLitleBoys(mynode, path); //recursive call

    } 
```

这完美地完成了工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T10:15:09.077

破解它！

```
 TreeNode[] n = treeView1.Nodes.Find(search, true);
            if (n.Length > 0)
                found = true;
            treeView1.Nodes[t].Collapse();

            foreach (TreeNode p in n)
            {
                i = 0;
                string[] a = p.FullPath.Split('\\');
                foreach (string b in a)
                {

                    if (i == 0)
                    {

                        treeView1.SelectedNode = treeView1.Nodes[b];
                        current = treeView1.Nodes[b];
                        treeView1.SelectedNode.Expand();
                        i = 1;
                    }
                    else
                    {
                        treeView1.SelectedNode = current.Nodes[b];
                        current = current.Nodes[b];
                        treeView1.SelectedNode.Expand();

                        if (b.ToUpper().Contains(search))
                        {
                            treeView1.SelectedNode.BackColor = System.Drawing.Color.Red;
                        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-13T15:21:24.993

我写了一个更简单的例程，效果很好。根本没有递归...这假设您的路径是完整的文件路径，例如...“C：\ program files \ myapp”并且当您添加节点时，您将节点键设置为等于文件夹名称

```
string[] strFolders = strPath.Split('\'));
System.Windows.Forms.TreeNode CurrentNode = null;
System.Windows.Forms.TreeNode[] FoundNodes = null;
foreach (string folder in strFolders) {
	if (!folder.Contains(":")) {
		if (CurrentNode == null) {
			FoundNodes = treeFolders.Nodes.Find(folder, false);
		} else {
			FoundNodes = CurrentNode.Nodes.Find(folder, false);
		}
		if (FoundNodes.Length > 0) {
			CurrentNode = FoundNodes[0];
			CurrentNode.Expand();
		} else {
			//no folder found.  cant continue
			break;
		}
	}
}
if (CurrentNode != null) {
	treeFolders.SelectedNode = CurrentNode;
}
```

# haskell - Haskell 实例声明中类似于 C++ 的部分特化

> ID：12234733
> 
> 赞同：0
> 
> 时间：2012-09-02T09:14:07.443
> 
> 标签：haskell

```
import Data.Int

class At c v i | c -> v, c -> i where
  at :: c -> i -> v

instance At [a] a Int where
  at l i = l !! i

{--  
f = at [2 ^ i | i <- [0..]] 10

main = print f
--} 
```

如果我在 ghci（带有 -fglasgow-exts 的 ghc 7.4.1）中加载它，我会收到这样的错误。

```
Prelude> :load Main.hs
[1 of 1] Compiling Main             ( Main.hs, interpreted )

Main.hs:6:10:
    Illegal instance declaration for `At [a] a Int'
      (the Coverage Condition fails for one of the functional dependencies;
       Use -XUndecidableInstances to permit this)
    In the instance declaration for `At [a] a Int'
Failed, modules loaded: none. 
```

我只是在学习函数依赖。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-12T21:18:39.687

正如 dave4420 在评论中所写：“`i -> c`位说知道我告诉你是什么`c`，但是你说如果`i ~ Int`那么`c ~ [a]`对于任何 a”。

# java - Wicket - DropDownChoice - 选项的标题（工具提示）

> ID：12234738
> 
> 赞同：2
> 
> 时间：2012-09-02T09:15:34.567
> 
> 标签：java, wicket

有没有办法让 Wicket 中的 DropDownChoice 将工具提示（例如标题属性）分配给各个选项元素？

我有以下形式的选择框项目：

```
public class SelectBoxItem
{
    private Long id;
    private String label;
    private String description;
} 
```

所有项目都从数据库中加载。

我使用 ChoiceRenderer 配置 DropDownChoice 组件，以使用 id 作为键，使用标签作为值。

现在我需要将其配置为也将描述用作工具提示消息。

* * *

我只在网上找到[了这个相关的帖子](http://mail-archives.apache.org/mod_mbox/wicket-users/201012.mbox/%3C1291233028966-3067946.post@n4.nabble.com%3E)。浏览相关的 Wicket 类让我得出与作者相同的结论，例如，这对于当前版本的 DropDownChoice/ChoiceRenderer 类可能是不可能的。那正确吗？在那种情况下，是否有类似的组件允许这样做？

* * *

（有关我的代码库的更全面的描述，请参阅[我的另一个问题](https://stackoverflow.com/questions/12226118/wicket-dropdownchoice-choicerenderer-preselecting-does-not-work)，我在同一上下文中询问了不同的问题。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T12:26:37.717

这是我对这个问题的解决方案。非常感谢 Andrea Del Bene 的建议。

```
public class TitledDropDownChoice<T> extends DropDownChoice<T> {

//  ... constructors from superclass ...

@Override
protected void appendOptionHtml(AppendingStringBuffer buffer,
        T choice, int index, String selected) {

    super.appendOptionHtml(buffer, choice, index, selected);

    // converts <option value="foo">bar</option> to
    // <option value="foo" title="bar">bar</option>
    String replString = "value=\"" + getChoiceRenderer()
        .getIdValue(choice, index) + "\"";
    int pos = buffer.indexOf(replString);
    buffer.insert(pos + replString.length(), 
        " title=\"" + getChoiceRenderer().getDisplayValue(choice) + "\"");

}

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T12:00:47.757

您是否尝试过覆盖方法 appendOptionHtml？您可以使用它来附加所需的 html（即 title="toolTipText"）。

# awk - 如何使用awk计算蛋白质序列中特定残基的总数？

> ID：12234739
> 
> 赞同：2
> 
> 时间：2012-09-02T09:15:45.783
> 
> 标签：awk

我有一些蛋白质序列。我想计算每个序列中 A 和 L 残基的总数。

```
>p1
ALASDEKI
>p2
KLHMNA
>p3
GQMLAALM 
```

期望的输出

```
ptn   A+L

p1     3
p2     2
p3     4 
```

我怎样才能用 awk 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:27:08.207

文件中的记录跨越多行。所以你可以使用 awk`-v RS=''`选项。

## 命令

```
sed 's/>/\n/' input |
    awk -vRS='' -vOFS='\t' '
        BEGIN{
            print "ptn","A+L"
        }
        {
            gsub(/[^AL]/,"",$2)
            print $1,length($2)
        }' 
```

## 输出

```
ptn A+L
p1  3
p2  2
p3  4 
```

# android - Android RelativeLayout 将对象放置在角落

> ID：12234741
> 
> 赞同：0
> 
> 时间：2012-09-02T09:16:04.867
> 
> 标签：android, android-layout

我正在尝试将 4 个对象放置在列表视图项的四个角中。我正在使用相对布局。由于某种原因，对象仅与左侧对齐。2 个对象应该在右侧。我也在使用layout_gravity，但没用。它们都向左对齐。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <include
        android:id="@+id/fromDistanceWindowLayout"
        android:layout_alignParentLeft="true"
        android:layout_gravity="left"
        layout="@layout/include_distance_window" />

    <include
        android:id="@+id/toDistanceWindowLayout"
        android:layout_alignParentRight="true"
        android:layout_gravity="right"
        layout="@layout/include_distance_window" />

    <include
        android:id="@+id/fromTimeWindowLayout"
        android:layout_alignParentLeft="true"
        layout="@layout/include_time_window" />

    <include
        android:id="@+id/toTimeWindowLayout"
        android:layout_alignParentRight="true"
        layout="@layout/include_time_window" /> 
```

包括 include_distance_window.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content">

        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/distancebackground"
            android:layout_alignParentTop="true" />

        <TextView
            android:id="@+id/distanceWindow"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerInParent="true" />
    </RelativeLayout> 
```

包括 include_time_window

```
<ImageView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:src="@drawable/distancebackground" />

<TextView
    android:id="@+id/timeWindow"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerInParent="true" 
    android:text="123"/> 
```

编辑：如果我将第二个包含替换为包含 xml 的内容，则一切正常

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_height="wrap_content">

    <ImageView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/distancebackground"
        android:layout_alignParentTop="true" />

    <TextView
        android:id="@+id/distanceWindow"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true" />
</RelativeLayout> 
```

我想知道为什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T11:49:28.130

我想指出一件事。布局重力在相对布局中没有影响。它是线性布局的一个参数。2、如果您使用的是eclipse IDE，请检查图形布局。我想知道您是否能够看到所有相关的布局？我猜你可以尝试给出一些明确的值，比如 70dp，而不是为相对布局提供包装内容。请尝试这些，修补程序并让我知道更改。

# asp.net - FormsAuthentication 重定向跨站

> ID：12234742
> 
> 赞同：0
> 
> 时间：2012-09-02T09:16:08.647
> 
> 标签：asp.net, formsauthentication

我有 2 个网站。从网站 1 我需要执行登录到网站 2 并返回到原始请求的 url（网站 1 的请求的 url）。

在登录点击时，当我执行 Response.Redirect(FormsAuthentication.GetRedirectUrl("...", false)) 我总是实现类似“http://website2/requestedPage.aspx”的东西，相反，我应该得到第一个网站： “http://website1/requestedPage.aspx”。

换句话说，GetRedirectUrl 方法 aòways 假设我在同一个 domina 中工作，因此暗示了网站名称。

当然我可以明确的网站名称，但我不想要它，因为明天，也许我将不得不从另一个网站登录。

有没有一种简单的方法来获取需要登录功能的网站名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:28:33.307

这是不可能的，因为表单身份验证仅绑定到一个域，表单身份验证需要 cookie 进行验证，并且只能为特定域设置 cookie。

如果要为多个站点设置登录，则必须查看单点登录解决方案。

# c++ - C++：私有虚函数与纯虚函数

> ID：12234745
> 
> 赞同：8
> 
> 时间：2012-09-02T09:16:41.430
> 
> 标签：c++, function, virtual, private

> **可能重复：**
> [C++ 中的私有虚拟方法](https://stackoverflow.com/questions/2170688/private-virtual-method-in-c)

[如果我从这篇文章（ C++ 中的私有虚拟方法）中](https://stackoverflow.com/questions/2170688/private-virtual-method-in-c)理解正确，那么在基类中创建一个虚拟函数会使派生类能够覆盖它。但似乎事情到此为止了。

但是如果基类虚函数是纯的，那会强制派生类实现该函数。因此，纯（公共）虚函数只是一个接口。我可以在这里看到一个好处。

另一方面，通过将基类虚函数设为私有，只赋予派生类覆盖该函数的能力，但我看不出这样做有什么好处。就好像那个私有虚拟功能甚至不存在一样。派生类显然不知道基类中存在该虚拟函数，因为它是私有的，那么在继承或多态方面声明基类私有函数虚拟有什么好处？

另外，在任何情况下，基类会声明一个函数“纯虚拟”和“私有”吗？

谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-02T09:20:26.607

一个好处是实现[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)：

```
class Base {

 public :
  void doSomething() {
    doSomething1();
    doSomething2();
    doSomething3();
  }
 private:
   virtual void doSomething1()=0;
   virtual void doSomething2()=0;
   virtual void doSomething3()=0;
};

class Derived : public Base {
  private:
   virtual void doSomething1() { ... }
   virtual void doSomething2() { .... }
   virtual void doSomething3() { .... }
} 
```

这允许派生类实现特定逻辑的每一部分，而基类决定如何将这些部分组合在一起。由于这些片段本身没有意义，`private`因此它们被声明并隐藏在客户端代码中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T09:27:07.210

它适用于 base 希望其子级实现 base 本身需要使用的功能的情况。想象一个愚蠢的例子——汽车。

```
class Car {
public:
    int getTorque();
    int getPower();

private:
    virtual const Engine& gimmeEngine() = 0;
};

class Ferrari : public Car {
private:
    FerrariEngine myCoolEngine;
    const Engine& gimmeEngine() { return myCoolEngine; }
}; 
```

现在 Car 不需要知道任何关于法拉利引擎的信息，只需要它实现一些`Engine`接口来保证`Car`可以获取有关其功率和扭矩的信息。

在这个愚蠢的例子中，一切都可以通过制作`getTorque`和`getPower`纯虚拟来简化，但我希望它能说明这个想法。`Base`需要使用它*知道*每个孩子必须拥有的某些特定逻辑，因此它通过私有纯虚拟成员对其进行查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T09:21:37.077

如果方法是虚拟的，它可以被派生类覆盖，即使它是私有的。无论如何，它应该被声明为受保护的。

# matlab - matlab拟合exp2

> ID：12234746
> 
> 赞同：2
> 
> 时间：2012-09-02T09:16:53.860
> 
> 标签：matlab, numerical-methods, numerical-analysis

我没有成功地使用 exp2（2 个指数的总和）寻找拟合函数的文档。如何操作功能一目了然：

```
[curve, gof] = fit(x, y,'exp2'); 
```

但是由于有多种方法可以拟合指数总和，因此我试图找出使用了什么算法。特别是当我用一点噪音拟合一个指数（原始数据）时会发生什么，指数是如何传播的。我模拟了几个案例，似乎它“放弃”了第二组系数的所有权重，但行数据分析通常显示不同的行为。

有人对文档有建议吗？

# extjs - 从按钮处理程序触发应用程序范围的事件

> ID：12234747
> 
> 赞同：0
> 
> 时间：2012-09-02T09:17:11.110
> 
> 标签：extjs, extjs4.1, extjs-mvc

我有这个网格面板：

```
Ext.define('BM.view.test.MacroList', {
extend: 'BM.view.GridPanel',
alias:'widget.macro-test-list',

store: 'Tests',

initComponent: function() {

    this.columns = [
        {
            xtype:'actioncolumn',
            width:50,
            items: [
            {
                icon: 'images/start.png',
                tooltip: 'Start Test',
                handler: function(grid, rowIndex, colIndex) {
                    this.application.fireEvent('testStart', grid.getStore().getAt(rowIndex)); 
                // application not defined here because 'this' is the button.
                }]
     }]
}
} 
```

stratTest 是一个可以在应用程序的许多地方使用的函数，我希望它可以用作应用程序范围的事件，但这些似乎只能从控制器中获得。
如何`.application.fireEvent('testStart'...)`从该按钮内的处理程序调用？

我[将此问题](https://stackoverflow.com/q/7260134/851604)用作对事件和 Sencha 文档的持续参考，但找不到答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T10:32:12.193

您进入`this.application`控制器范围。

鉴于您显然在这里使用 MVC，我会说最好坚持 MVC 概念；也就是说，为了可重用性，组件不应该知道哪个控制器使用它，而控制器应该知道它正在使用哪些组件。

所以你应该真正在控制器中监听事件，并从那里触发一个应用程序事件。

问题是控制器无法访问 actioncolumn 处理程序（它在内部调用`Ext.grid.column.Action` `processEvent()`）。

所以最好的办法是在视图中触发一个新事件：

```
this.columns = [
    {
        xtype:'actioncolumn',
        ...
        items: [
        {
            ...
            handler: function( aGrid, aRowIndex, aColIndex, aItem, aEvent, aRecord ) {
                this.fireEvent( 'columnaction', aGrid, aRowIndex, aColIndex, aItem, aEvent, aRecord); }
        }]
 }] 
```

另请注意，您可以为该列定义一个全局处理程序，如下所示：

```
this.columns = [
    {
        xtype:'actioncolumn',

        handler: function( aGrid, aRowIndex, aColIndex, aItem, aEvent, aRecord ) {
            this.fireEvent( 'columnaction', aGrid, aRowIndex, aColIndex, aItem, aEvent, aRecord); }

        ...
        items: [
        {
            ...
        }]
 }] 
```

然后在控制器中捕获这个事件。

```
init: function() {
    this.control({
        'macro-test-list actioncolumn':{
            columnaction: this.onAction
        }
    });
},

onAction: function( aGrid, aRowIndex, aColIndex, aItem, aEvent, aRecord ) {
    this.application.fireEvent( 'testStart', aGrid.getStore().getAt( aRowIndex ) );
} 
```

请注意，顺便说一下，鉴于您正在尝试做的事情，更简洁的代码将是：

```
onAction: function( aGrid, aRowIndex, aColIndex, aItem, aEvent, aRecord ) {
    this.application.fireEvent( 'testStart', aRecord );
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-17T14:48:05.340

在触发应用程序范围的自定义事件方面，ExtJS V5.1 发布后现在有一个新方法，即使用 Ext.GlobalEvents。

当你触发事件时，你这样做：

```
Ext.GlobalEvents.fireEvent('custom_event',args); 
```

当您注册事件的处理程序时，您执行以下操作：

```
var obj = Ext.create('Ext.form.Panel', {
  // ....
});
Ext.GlobalEvents.on('custom_event', function(arguments){
  /* handler codes*/
}, obj}; 
```

此方法不限于控制器。任何组件都可以通过将组件对象作为输入参数范围来处理自定义事件。

这是一个[小提琴](https://fiddle.sencha.com/#fiddle/qll)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-23T08:09:29.577

APPNAME.getApplication.fireEvent() 在应用程序范围内可用。

# android - 从亚行在手机上启动应用程序

> ID：12234751
> 
> 赞同：0
> 
> 时间：2012-09-02T09:17:20.097
> 
> 标签：android, android-activity, adb

我想通过 adb 工具在手机上启动一个应用程序。我关注这个线程[链接]

[1]：[如何使用android ADB工具启动应用程序？](https://stackoverflow.com/questions/4567904/how-to-start-an-application-using-android-adb-tools)但是，例如，如果我想开始 Angry Bird 游戏，我如何才能发现 package 的主要活动？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:26:53.517

如果您从 Google Play 安装[AppXplore](https://play.google.com/store/apps/details?id=com.sonyericsson.androidapp.AppExplore "AppXplore")应用程序，您可以检查已安装的应用程序并了解**包名称**和 APK 中的**活动**。

我刚刚验证了它，它通过从 adb shell 启动 Adob​​e Reader 来工作：

```
am start -n com.adobe.reader/com.adobe.reader.AdobeReader 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-13T12:28:39.077

我们可以使用 am-:activity manager 启动任何应用程序

```
 adb shell am start android.intent.action.VIEW
    adb shell am start com.android.Browser 
```

# javascript - Backbone.localStorage + RequireJS：不工作？

> ID：12234754
> 
> 赞同：0
> 
> 时间：2012-09-02T09:17:54.367
> 
> 标签：javascript, backbone.js, local-storage, requirejs

集合定义：

```
define(function(require) {
    var Backbone = require('backbone'),
        m = require('../models/m');
        require('backbone.localstorage');

    var c = Backbone.Collection.extend({
        model: m,
        localStorage: new Backbone.LocalStorage('queue')
    });

    return new c();
}); 
```

在视图中：

```
define(function(require) {
    var $ = require('jquery'),
        _ = require('underscore'),
        Backbone = require('backbone'),
        c = require('../collections/c');

    var v = Backbone.View.extend({
        ...
        events: {
            'click div': 'updateQueue'
        },
        updateQueue: function($_event) {
            c.add(this.model);
        }
    });

    return v;
}); 
```

该`c.add(this.model);`行根本不起作用，并且集合永远不会保存到 localStorage 中，每次重新加载页面时都会丢失所有模型。知道我在哪里做错了吗？我正在为 Github 使用最新的 Backbone.localStorage 版本。

**编辑：**

改为`c.create()`改为，它仍然没有将任何内容保存到 localStorage。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T12:25:35.523

尝试调用 create() 函数`c.create(this.model);`，这会自动保存您的模型。或者您可以在将模型添加到集合之前保存模型

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T22:08:56.897

发现错误：

```
updateQueue: function($_event) {
    c.create(this.model);          // wrong
    c.create(this.model.toJSON()); // correct!
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T08:27:18.507

如果您将模型添加到集合中，并不意味着它已保存。您必须自己调用 save 方法。

很好的建议`create`改用。

# algorithm - 社交网络功能查找您可能知道的联系

> ID：12234757
> 
> 赞同：1
> 
> 时间：2012-09-02T09:18:24.977
> 
> 标签：algorithm, graph, social-networking

我想创建一个功能来建议社交网络中的联系。

在网络中，您可以建立连接并连接到其他用户。

我想在网络上实现连接建议功能。

我认为实现这一点的最基本方法是检查我的所有连接，我的用户未连接到的最常见的常见连接，并建议该用户连接到我的用户。

我的问题是：

1.  对于简单的连接查找器来说，这是一个很好的基本方法吗？
2.  有没有什么好的实现算法可以用来找到他们连接的最常出现的用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:57:12.807

我会尝试一种[机器学习](http://en.wikipedia.org/wiki/Machine_learning)方法来解决这个问题。
为了解决这个问题，我将提出两个常见的机器学习概念。为了使它们都起作用-您需要从数据中提取特征（例如，查看子图，与子图中每个成员的友谊是二元特征）。

这两种方法是：

1.  [分类](http://en.wikipedia.org/wiki/Statistical_classification)。在这里，您试图找到一个分类器`C:UserxUser->Boolean`（一个给定两个用户的分类器，给出一个布尔答案 - 他们应该是朋友）。分类方法将要求您首先手动标记或提取一些分类信息（足够大的对，每个对都有一个分类）。该算法将学习这种模式，并使用它来预测未来的输入。
2.  [聚类](http://en.wikipedia.org/wiki/Cluster_analysis)（AKA 无监督学习）。您可以尝试在图表中查找集群，并建议用户与集群中的所有成员成为朋友。

我不得不承认我从未使用过任何这些方法来建议友谊——所以我不知道它会有多准确。您可以使用[交叉验证](http://en.wikipedia.org/wiki/Cross-validation_%28statistics%29)来估计算法的准确性。

* * *

如果您有兴趣了解更多相关信息 - 两周前，斯坦福大学开设了关于机器学习的免费在线课程： [https ://class.coursera.org/ml-2012-002](https://class.coursera.org/ml-2012-002)

# jquery - 使用jquery动态创建内容

> ID：12234758
> 
> 赞同：0
> 
> 时间：2012-09-02T09:18:35.120
> 
> 标签：jquery

我试图在将链接悬停但不工作时加载框架中的链接。如果我将此功能用于我在页面上创建的任何链接都可以正常工作，但是当我在动态创建的情况下使用它时不起作用。

这是在页面上创建的数据

```
$('#user-tweets').append('<table class="tweets" width="320" border="0"><tr><td rowspan="1">' + 
  user + '</td><td rowspan="1">' + 
  date + '</td></tr><tr><td width="45"><a href="' + 
  profile_img + '"><img src="' + 
  profile_img + '" width="55" height="50"/></a></td><td width="186">' + 
  text + '<p><a href="' + url + '"target="_blank">' + 
  url + '</a></p></td></tr></table><hr>'
); 
```

...并且当我悬停时，我正在使用此功能将链接打开到框架中。

```
$("a").hover(
  function() {
    $(this).append($("<iframe src='"+this.href+"'></iframe>"));
  },
  function () {
    $(this).find("iframe:last").remove();
  }
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:25:07.170

您必须使用委托的事件处理程序，使用[`.on()`](http://api.jquery.com/on/).

```
$('#user-tweets').on('mouseenter', "a", function() {
    $(this).append($("<iframe src='"+this.href+"'></iframe>"));
}).on('mouseleave', 'a', function () {
    $(this).find("iframe:last").remove();
}); 
```

这个想法是您将处理程序绑定到某个在脚本运行时已经存在的父元素。然后，在新内容上触发的事件可以将 DOM 树冒泡到该父级并在那里进行处理。因此，您可以处理与特定选择器匹配的所有元素上的事件，即使它们尚不存在。

# c# - 多线程会话后线程不会恢复

> ID：12234759
> 
> 赞同：2
> 
> 时间：2012-09-02T09:18:49.820
> 
> 标签：c#, multithreading, parallel.foreach

我有一个线程，称之为“解析线程”。

```
Thread parsingThread = new Thread(myMethod); 
```

我在这个线程上执行了一些计算，其中最后一个涉及更多的并行计算。

```
 public void ReadCityFiles(BlockingCollection<GeonamesFileInfo> files)
    {
        Parallel.ForEach<GeonamesFileInfo>(
            files.GetConsumingPartitioner<GeonamesFileInfo>(),
            new ParallelOptions { MaxDegreeOfParallelism = _maxParallelism },
            (inputFile, args) =>
            {
                RaiseFileParsing(inputFile);
                using (var input = new System.IO.StreamReader(inputFile.FullName))
                {
                    while (!input.EndOfStream)
                    {
                        RaiseEntryParsed(ParseCity(input.ReadLine()));
                        Interlocked.Increment(ref _parsedEntries);
                    }
                }
                RaiseFileParsed(inputFile);
            });
        RaiseDirectoryParsed(Directory);
    } 
```

问题是，当这些非常长且计算量大的异步 foreach 操作完成（约 30 分钟）时，“解析线程”不会恢复。我的 GUI 仍然响应，但是应该继续在“解析线程”上运行的 RaiseDirectoryParsed 函数从未被调用。到目前为止，我已经调试了程序，并且对于在这种情况下该怎么做感到非常困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:47:48.847

的要点`BlockingCollection`是，当一个操作现在不能执行，但可能在将来（例如`Take()`，或者`Add()`在一个容量有限的集合上）时，它会阻塞。这同样适用于`GetConsumingEnumerable()`，因此也适用于`GetConsumingPartitioner()`：如果集合当前为空，则可枚举将阻塞，直到您将更多项目添加到集合中。

但是还有一种方法可以告诉集合您不再要添加新项目，并且从现在开始它不应该在为空时阻塞[：`CompleteAdding()`方法](http://msdn.microsoft.com/en-us/library/dd287086)。如果在您知道不会再向集合中添加任何新项目时调用它，您`Parallel.ForEach()`将不再阻塞并且您的线程将继续执行。

# architecture - ArcGIS 客户端/服务器开销

> ID：12234763
> 
> 赞同：1
> 
> 时间：2012-09-02T09:20:07.330
> 
> 标签：architecture, client, arcgis, arcgis-server

ArcGIS 服务器如何处理客户端/服务器开销？它用来处理高开销的技术是什么？它们是稳定的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:23:26.900

我建议进一步澄清你的问题。除非您考虑启动的 SOC 和 SOM 进程的各个实例，否则 ArcGIS 服务器的开销不会太大。

另外，你指的是什么版本？我知道架构从 10 到 10.1 发生了很大变化。

然而，我要指出，ESRI 的技术很少是完全稳定的——尽管这是一种主观看法。

# iphone - 一个用于具有不同视图和布局的多个品牌的基本应用程序？

> ID：12234766
> 
> 赞同：0
> 
> 时间：2012-09-02T09:20:32.877
> 
> 标签：iphone, ios, xcode, target

我已经构建了一个应用程序，它可以与不同的互联网资源进行一些计算和通信。我为我的应用程序添加了三个企业客户的标签栏导航栏，唯一的变化是图片和颜色的不同。所以我创建了三个目标并适当地处理了目标成员。

到目前为止，一切都很好。但是，如果我想为客户自定义视图的整个布局，甚至是应用程序的导航怎么办？例如，下一个客户端可能会要求基于导航控制器的交互，而不是基于标签栏的导航。或者在一个视图中再添加一个标签。或者使用饼图而不是条形图来可视化某组数据。

如果您将所有不同的目标放在一个项目中，并带有所有这些 if/else if/else if/else if/... 代码块，则会导致代码非常难看。如果我有 100 个客户怎么办？

现在问题来了：在我的想象中，一个理想的概念是，如果我可以创建一个名为“ *Base* ”的 Xcode 项目，该项目执行所有特定领域的计算、通信等（当然）并具有基本的非品牌 UI . 这样，可以在一个中央存储库中轻松地为所有客户端维护代码。然后，对于每个客户，我创建一个全新的 Xcode 项目，导入或引用“ *Base* ”项目，当我单击 Build 而不进行任何自定义时，它已经为我构建了非品牌但功能齐全的应用程序。如果客户请求修改布局，我将相应的视图子类化。当再次点击 Build 按钮时，它应该会弹出“ *Base* ”应用程序，但某些子类视图取代了标准布局。

这种“覆盖”视觉效果的“*基础*”应用程序的想法能否在 Xcode 中优雅地完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T13:10:23.993

去年我就是为一个客户做的。我有一个框架应用程序，它使用与应用程序项目共享的标头。它几乎就像一个协议，应用程序“承诺”提供一些字符串、视图和图像。您可以从一个相当简单的应用程序项目开始，当您发现需要更多变体时，将代码从框架中移到应用程序中。标头是一个仅提供应用程序特定数据的类方法类的实现。

在我的情况下，我们有 7 个左右的应用程序（现在都在商店里），但在框架中没有一点了解究竟是什么应用程序正在使用它。

作为应用程序启动中的一个示例，框架可能会询问是否应该播放声音，如果需要，则请求该资源 - 与图像和其他变体相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T13:10:52.460

一种方法是创建一个静态库。你可以把所有常用的东西都塞进一个[静态库](http://www.icodeblog.com/2011/04/07/creating-static-libraries-for-ios/)中，然后在其他项目中引用它。

也许大多数东西都存在于静态库中，而您的应用项目中只有一两个文件。如果应用程序之间的更改非常少（即：仅像您在帖子中提到的样式更改），这将很有效。

另一种技术是使用生成的和模板代码。这个想法是你有你的样板代码并运行一个脚本，该脚本将根据提供的颜色、徽标、字符串等设置你的项目和资源。

最后，您可能希望根据您的要求结合使用上述两种方法。

# c# - 为什么 sizeof(bool) == sizeof(byte) 在 C# 中？

> ID：12234768
> 
> 赞同：5
> 
> 时间：2012-09-02T09:20:44.803
> 
> 标签：c#, memory-management, boolean, byte, sizeof

> **可能重复：**
> [c# 中布尔值的二进制表示形式是什么](https://stackoverflow.com/questions/3335841/what-is-the-binary-representation-of-a-boolean-value-in-c-sharp)

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/eahchzkf.aspx)，该`sizeof`关键字“用于获取非托管类型的字节大小”，并且原语被视为非托管类型。如果我检查`sizeof(bool)`，结果是 1。

在我看来，使用布尔值应该只需要一点内存。我弄错了吗？使用一个`Boolean`值实际上需要一个完整字节的内存吗？为什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-02T09:23:06.963

出于性能原因，它使用整个字节的内存。

如果它只使用一个位，那么你如何处理其他 7 个位？很少有变量是布尔值，其他变量可能不需要一个位。所以它只对其他布尔值有用。

例如，4 字节整数。此外，出于性能原因，许多较大的类型需要从适当的字节边界开始。例如，CPU 可能不允许您轻松引用从任何地址开始的 4 字节地址（即，该地址可能需要被 4 整除）。

如果它使用一位内存，这意味着其他 7 位可以用于其他布尔值，尝试使用这个布尔值会更复杂。因为它不是直接可寻址的，所以在测试它是 1 还是 0 之前，您需要获取字节，然后提取该位。这意味着更多的指令 - 因此性能更慢。

如果你有很多布尔值，并且你希望它们每个只使用一个内存位，你应该使用`BitArray`. 这些是单个位的容​​器。它们的行为类似于布尔数组。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-02T09:22:26.007

一个字节是最小的可寻址内存量。.NET 团队选择使用一个字节来存储 a`bool`以简化实现。

如果您想更紧凑地存储大量位，可以查看[`BitArray`](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx).

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-02T09:22:58.273

是的，它需要一个完整字节的内存，因为那是最小的可寻址内存。

当然可以提出一种方案，其中可以将多个布尔值放在同一个字节中，从而节省空间。在更多情况下，这种解决方案的开销将远远超过获得的成本。

如果你有很多位要存储，一个专门的位向量（比如 Mark Byers 提到的 BitArray）可以节省宝贵的空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T09:24:28.997

如果您将 1 Byte 视为由于 sizeof 而导致的数值为 1。那么它怎么能说1位呢？不可能，要么它落地并返回 0，那是不可能的，要么它返回 1，因为它占用了保存一个字节，因为你不保存位。

但我不知道它是按位还是字节来管理的。

在 c++ 中，您在变量名中添加 a :1 表示它应该只有 1 位宽。

# php - 错误 URL 段

> ID：12234777
> 
> 赞同：0
> 
> 时间：2012-09-02T09:21:39.150
> 
> 标签：php, codeigniter

我使用 Codeigniter 2.1.2 创建了自己的登录页面和社交媒体 (Facebook)，然后我想使用 url 重定向，例如：

```
http://mydomain.com/account/login/redirect_url/login/http://mydomain.com/
1- redirect_url  // is a Method in account controllers
2- login         // parameter define login or logout,when click link login/logout
3- http://mydomain.com/ // Is the url for redirecting to, after login succeed. 
```

在我的本地主机上它运行良好，但在我的服务器上它不工作。我知道它为什么起作用的一些原因，因为`.htaccess`文件

当地的：

```
RewriteRule ^(.*)$ ./index.php/$1 [L,QSA] 
```

服务器：

```
RewriteRule ^(.*)$ ./index.php?/$1 [L,QSA] 
```

我认为，由于问号（？），即使 facebook 登录也无法正常工作。但是我尝试了没有`?`在服务器上的代码，但它根本不起作用，如果我使用`?`所有的，但只有 url。

我的问题是我应该如何处理这段代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T05:38:23.793

我注意到许多 CodeIgniter 开发人员没有使用当今许多网站使用的标准方法。

尝试这个：

```
RewriteRule ^ index.php [L, QSA] 
```

本质上，你会发现有很多方法可以做到这一点，但我不认为你真的需要使用`./`和`$1`。

我想这也取决于您使用的服务器系统。

希望这可以帮助。如果没有，也许您可​​以向我们展示您的整个超文本访问文件 (.htaccess)？

# html - CSS LESS 类继承

> ID：12234782
> 
> 赞同：0
> 
> 时间：2012-09-02T09:22:27.577
> 
> 标签：html, css, less

这是我的 #myform1 .btn1 类的属性的 CSS 描述：

```
#myform1 .btn1
{
...
}

#myform1 .btn1:hover
{
...
}
#myform1 .btn1.active
{
...
}
#myform1 .btn1.disabled
{
...
} 
```

是否可以使用LESS（任何方式都可以）为我的#myform2 .btn2 类添加完全相同的属性而无需编写

```
#myform1 .btn1 ,#myform2 .btn2
{
...
}

#myform1 .btn1:hover, #myform2 .btn2:hover
{
...
}
#myform1 .btn1.active, #myform2 .btn2.active
{
...
}
#myform1 .btn1.disabled, #myform2 .btn2.disabled
{
...
} 
```

是否可以？

**添加：**

**是否可以以某种方式使用 LESS：**

```
@btn-superstyle
{
...
}

@btn-superstyle:hover
{
...
}
@btn-superstyle.active
{
...
}
@btn-superstyle.disabled
{
...
}

#myform1 .btn1,     #myform2 .btn2
{
 @btn-superstyle; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:36:31.383

尽量少用这个：

```
#myform1 .btn1, #myform2 .btn2 {
  /* here common styles */    

  &:hover {
    ...
  }

  &:active {
    ...
  }
} 
```

例如这个少：

```
#myform1 .btn1, #myform2 .btn2 {
  color: green;  

  &:hover {
    color: blue;
  }

  &:active {
    color: red;
  }
} 
```

提供这个CSS：

```
#myform1 .btn1,
#myform2 .btn2 {
  color: green;
}
#myform1 .btn1:hover,
#myform2 .btn2:hover {
  color: blue;
}
#myform1 .btn1:active,
#myform2 .btn2:active {
  color: red;
} 
```

另外我推荐这个资源在网上玩少一点，看看编译后的 css：[http ://winless.org/online-less-compiler](http://winless.org/online-less-compiler)

# python - 使用 eval 设置未知属性

> ID：12234788
> 
> 赞同：4
> 
> 时间：2012-09-02T09:23:04.930
> 
> 标签：python, eval

我有一个 User 类，里面有多个属性，我也有 User 类的 addPoint 方法，它允许用户将点输入到它的任何属性中。但是，最多可以有 500 个属性，每个人都可以有不同的属性，等等。所以用“if: - elif:”对每个属性进行编码会很麻烦。现在这就是我试图做的，使它更容易和更清洁：

```
class User:
    def __init__(self):
        self.health = 0
        self.speed = 0

    def addPoint(self, property, amount):
        eval("self."+property) = eval("self."+property) + amount 
```

现在当我做 fe。

```
u = User()
u.addPoint("health", 5) 
```

我希望它这样做：`self.health = self.health + 5`，这就是我使用`eval()`s 的目的。但是，Python 只是给了我错误：`can't assign to function call`. 我不是试图分配`eval()`函数调用本身，而是试图从 分配返回的值`eval()`，那么我怎么能以最简单的方式做到这一点呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-02T09:27:09.590

不要使用`eval()`，使用[`setattr()`](http://docs.python.org/library/functions.html#setattr)and[`getattr()`](http://docs.python.org/library/functions.html#getattr)代替：

```
setattr(self, property, getattr(self, property) + amount) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T09:27:25.160

使用 a`dictionary`而不是`eval()`：

```
class User:
    def __init__(self):
        self.health = 0
        self.speed = 0
        self.properties={}

    def addPoint(self, property, amount):
        self.properties[property] =self.properties.get(property,0)+amount 

        #self.properties.get(property,0) returns 0 if the property was not defined 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T09:33:38.660

我不确定这是否是最佳解决方案，但您可以像这样使用对象的**dict**属性：

```
def addPoint(self, property, amount):
    self.__dict__[property] = amount 
```

`__dict__`属性存储对象的所有属性，您可以非常简洁地访问它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T09:29:31.557

使用 Python 标准库提供的函数 settattr - 快速示例：

```
>>> class A:
...     def __init__(self):
...         setattr(self, "a", "b")
... 
>>> A().a
'b' 
```

# java - 垃圾收集器问题

> ID：12234792
> 
> 赞同：2
> 
> 时间：2012-09-02T09:23:25.573
> 
> 标签：java, garbage-collection, scjp

这个问题就像我之前的[一个](https://stackoverflow.com/questions/12182383/when-an-object-is-eligible-for-a-garbage-collector)问题 ：

```
3\. interface Animal { void makeNoise(); }
4\. class Horse implements Animal {
5\.   Long weight = 1200L;
6\.   public void makeNoise() { System.out.println("whinny"); }
7\.  }
8\.  public class Icelandic extends Horse {
9\.   public void makeNoise() { System.out.println("vinny"); }
10\.  public static void main(String[] args) {
11\.    Icelandic i1 = new Icelandic();
12\.    Icelandic i2 = new Icelandic();
13\.    Icelandic i3 = new Icelandic();
14\.    i3 = i1; i1 = i2; i2 = null; i3 = i1;
15\.  }
16\. } 
```

当到达第 14 行时，有多少对象符合垃圾收集器的条件？

> A. 0
> 
> B. 1
> 
> C. 2
> 
> D. 3
> 
> E. 4
> 
> F. 6

我选择了A，但正确答案是E，但我不知道为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T09:42:43.337

让我们称在as和中创建的三个`Icelandic`对象。`main``A``B``C`

初始

*   `i1=A`,`i2=B`和`i3=C`;

后`i3 = i1`

*   `i1=A`,`i2=B`和`i3=A`;

后`i1 = i2`

*   `i1=B`,`i2=B`和`i3=A`;

之后`i2 = null`：

*   `i1=B`,`i2=null`和`i3=A`;

后`i3 = i1`

*   `i1=B`,`i2=null`和`i3=B`

在第 14 行，存在`B`对类型对象的常规引用`Icelandic`。`A`并`C`在运行程序中丢失。

每个`Icelandic`丢失的对象都会为垃圾收集器提供两个要收集的对象，即。`Icelandic`对象本身和对象内的`Long`every `Icelandic`，这使得垃圾回收对象的总数为*4*。

由于`makeNoise`从不调用方法，因此它们不会改变结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T09:35:22.543

如果你仔细看，所有的赋值到底`i1`并`i3`指向第二个对象，而`i2`指向`null`. 这意味着两个`Icelandic`对象有资格进行 GC。

每个`Icelandic`对象包含一个`Long`，总共有 4 个对象符合 GC 条件。有趣的是，如果常量是`12L`，答案将是：`2`由于`Long`内部常量缓存。另请注意，`"whinny"`and`"vinny"`来自常量池，不会被垃圾收集。

一旦你离开了 all和声明的范围`i1`，剩下的两个对象也有资格进行 GC。`i2``i3`

# php - php foreach 替换变量

> ID：12234793
> 
> 赞同：-1
> 
> 时间：2012-09-02T09:23:33.817
> 
> 标签：php, foreach, str-replace

我想使用一个模板文件，我在其中使用 {value} 作为标记来用一个值替换它。

该变量设置为 $order ，我想在有 {order} 的模板中替换它。

我想替换其中大约 50 个变量。

有没有办法自动做到这一点？

```
$text = file_get_contents("bol_files/order_template.txt");
    $text = str_replace("{ordernummer}",$bestelnummer, $text);
    $text = str_replace("{verzendwijze}",$verzendwijze, $text);
    echo $text; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:28:21.013

您可以使用[strtr](http://php.net/manual/en/function.strtr.php)函数。

```
$text = file_get_contents("bol_files/order_template.txt");
$trans = array(
    '{ordernummer}' => $bestelnummer, 
    '{verzendwijze}'   => $verzendwijze,
    ......
);
echo strtr($text, $trans); 
```

***更新：*** 如果您的规则是固定的（替换`{var_name}`为`$var_name`），那么您可以使用正则表达式替换。

```
echo preg_replace('/\{([^}]+)\}/e',  '${\'$1\'}' , $text ); 
```

***[检查示例。](http://codepad.viper-7.com/enxWZ0)***

***加法：***但是`e`不推荐使用标记（您可以`preg_replace_callback`改用，但那样的话，您需要将这些变量导入回调函数的范围），我认为您最好将数据保存在数组中而不是单独的变量中，甚至如果你可以使用`get_defined_vars`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:37:53.730

IMO，**最简单的方法是首先将模板变量收集在一个数组中，**而不是使用单个变量。然后你可以简单地将数组作为一个整体传递给`str_replace`.

如果以上不是一个选项，您可以使用

*   [`get_defined_vars`— 返回所有已定义变量的数组](http://php.net/manual/en/function.get-defined-vars.php)

### 例子：

```
$a = 'foo';
$b = 'bar';
$c = 'baz';

$template = '{a} to the {b} to the {c}';

foreach (get_defined_vars() as $key => $val) {
     if (is_scalar($val)) {
         $template = str_replace('{' . $key . '}', $val, $template);
     }
}
echo $template; // prints 'foo to the bar to the baz'; 
```

[演示](http://codepad.viper-7.com/6IcWO2)

### 执行相同操作的替代方案：

```
$a = 'foo';
$b = 'bar';
$c = 'baz';

$template = '{a} to the {b} to the {c}';

$scopeVars = array_filter(get_defined_vars(), 'is_scalar');
$templateMarker = preg_replace('/^.*$/', '{$0}', array_keys($scopeVars));
echo str_replace($templateMarker, $scopeVars, $template); 
```

[演示](http://codepad.viper-7.com/AC7xxk)

但请注意，当您让其他人在模板中提供模板标记时，这可能是不安全的。由于获得*了当前范围内的*`get_defined_vars`所有变量，因此有人可能会尝试猜测不是模板值的变量，这些变量可能包含敏感数据。由您来评估该风险。

 *另请注意，我添加了检查范围变量是否包含标量值，因为如果范围变量中有对象或数组，PHP 将抱怨无法将它们转换为`str_replace`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T09:27:03.190

str_replace 可以将数组作为参数：

```
$text = str_replace(array_keys($replaceArray), $replacearray, $text); 
```

其中 $replaceArray 是一个关联数组

```
$replaceArray = (
  "{ordernummer}" => $bestelnummer,
  "{verzendwijze}" => $verzendwijze,
 and so on
); 
```*

# css - 使用 div 中的输入字段时，JqueryUi 自动完成显示在错误的位置：已修复

> ID：12234802
> 
> 赞同：14
> 
> 时间：2012-09-02T09:26:12.457
> 
> 标签：css, jquery-ui, input, position, jquery-ui-autocomplete

我在通过将*css*`div`属性`position`应用于`fixed`. `div`包含输入字段。特别是，我正在使用 jQueryUI 中的自动**完成***小部件*。有两个主要问题：

 **1）第一个是，由于 div 有一个固定的位置，当你向下滚动网页时，自动完成建议不会显示固定，而是随着页面上下移动。**[你可以在这个Codepen](http://codepen.io/anon/pen/ALlpy)**中看到这个问题，我正在使用来自 jQuery 网站的带有城市名称自动完成功能的示例。

2）第二个问题是自动完成的建议显示在页面的左上角，而不是在输入字段的下方。不幸的是，我试图在 Codepen 中重现这个问题，但我做不到。

我很确定问题出在 CSS 上，尤其是 JQuery-UI 提供的此类样式属性。也许可以通过使用自动完成小部件的[位置选项来解决问题。](http://jqueryui.com/demos/autocomplete/#option-position)

**我应该定义什么 CSS 属性以及如何定义？**

PS：我使用*[http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css](http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css)*提供的主题。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-09-02T13:52:37.250

查看 jQuery UI 库，我看到**<ul>**元素用于显示建议。jQuery UI 默认将此元素附加到 HTML 文档，而不是文本**输入的****<div>**（用作“模态窗口”）。

 **但是，文档显示选项**appendTo配置自动完成****<ul>**应该附加到哪个元素。它使用jQuery的`appendTo()`功能。 [http://jqueryui.com/demos/autocomplete/#option-appendTo](http://jqueryui.com/demos/autocomplete/#option-appendTo)

所以，我包含了一个 div 来包含建议：

```
<input type="text" id="myInput" />
<div id="container">
</div> 
```

在`autocomplete()`函数中我添加了选项：

```
appendTo: "#container" 
```

然后我添加了以下CSS

```
#container {
    display: block; 
    position:relative
} 
.ui-autocomplete {
    position: absolute;
} 
```

就这样！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-09T00:25:27.440

确保您只加载一个版本的 Jquery 和我在阅读 @Riapp 的答案后发现的 UI 之一，我玩过，可以看到您需要匹配的版本号，而且永远不会太多......

Otherwise the autocomplete will be an absolute, and fly to the top.

```
 <script type="text/javascript"
    src="https://code.jquery.com/ui/1.11.3/jquery-ui.min.js"></script>
    <link rel="stylesheet" type="text/css"
    href="https://code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-12T22:18:07.867

有同样的问题。删除 jquerUI 基本主题，卸载 jqueryUI 库，然后重新安装 jqueryUI，现在可以正常工作了。不知道你在用什么，但我在 MVC4 上有这么多的错误，我要自杀了。祝你好运。

编辑：这是真正的问题

在查看旧项目以查看自动完成功能是否正常工作时，我们发现旧项目中的许多样式在新项目中都没有。不确定我是否删除了它们，但无法想象这样做。我所要做的就是复制并粘贴我的新项目中缺少的那些类，然后一切都恢复正常了。我认为有人在破坏我的项目。****

# php - 成功登录后magento 404

> ID：12234811
> 
> 赞同：4
> 
> 时间：2012-09-02T09:27:38.213
> 
> 标签：php, magento

我的 magento 安装有一个奇怪的问题。我在安装过程中将管理员 url 设置为 myadmin。在我的 local.xml 文件中，管理员的 frontName 如下所示：

```
 <admin>
        <routers>
            <adminhtml>
                <args>
                    <frontName><![CDATA[myadmin]]></frontName>
                </args>
            </adminhtml>
        </routers>
    </admin> 
```

登录成功后重定向到

> > [http://127.0.0.1/index.php/admin/myadmin/index/noRoute/key/53c3c0bf6b77fb838f1d363c24443483/]

当我单击仪表板链接时，它可以工作。当我将 myadmin 更改为 admin 时，它可以工作。那么这个问题有什么解决方案吗？任何帮助将不胜感激。问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T14:26:10.473

当我也有带有多商店视图的自定义管理员路由时，我遇到了这个问题

我去[http://dev.loc/magento/myadmin/](http://dev.loc/magento/myadmin/)时遇到了问题 {登录后我有 404 }

但是如果我使用[http://dev.loc/magento/storeview/myadmin/](http://dev.loc/magento/storeview/myadmin/) {这很好用}

调试后我发现在 \app\code\core\Mage\Adminhtml\Controller\Action.php

```
 /**
     * Controller predispatch method
     *
     * @return Mage_Adminhtml_Controller_Action
     */
    public function preDispatch()
    {
        .......
        if (!$_isValidFormKey || !$_isValidSecretKey) {
            $this->setFlag('', self::FLAG_NO_DISPATCH, true);
            $this->setFlag('', self::FLAG_NO_POST_DISPATCH, true);
            if ($this->getRequest()->getQuery('isAjax', false) || $this->getRequest()->getQuery('ajax', false)) {
                $this->getResponse()->setBody(Mage::helper('core')->jsonEncode(array(
                    'error' => true,
                    'message' => $_keyErrorMsg
                )));
            } else {
                $this->_redirect( Mage::getSingleton('admin/session')->getUser()->getStartupPageUrl() );
            }
            return $this;
        } 
```

当您成功登录时，此 IF 条件会产生 false，因此在成功登录后设置重定向的语句不会运行

```
$this->_redirect( Mage::getSingleton('admin/session')->getUser()->getStartupPageUrl() ); 
```

所以你可以扩展 Mage_Adminhtml_Controller_Action

并覆盖 Pre-dispatch 函数或者你这个观察者`adminhtml_controller_action_predispatch_start`来设置重定向页面

```
$this->_redirect( Mage::getSingleton('admin/session')->getUser()->getStartupPageUrl() ); 
```

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-31T11:35:51.837

我通过重写[http://dev.loc/magento/myadmin/](http://dev.loc/magento/myadmin/) {KO}解决了这个问题

到[http://dev.loc/magento/index.php/admin/myadmin/](http://dev.loc/magento/index.php/admin/myadmin/) {OK}

对于 nginx：

```
rewrite ^/index.php/admin/myadmin/(.*)$ /index.php/myadmin last;
rewrite ^/myadmin.*$ /index.php/admin/myadmin$1 permanent;
rewrite ^/index.php/myadmin.*$ /index.php/admin/myadmin$1 permanent;
rewrite ^/admin/myadmin.*$ /index.php/admin/myadmin$1 permanent; 
```

# android - 如何以编程方式打开手电筒闪光灯

> ID：12234812
> 
> 赞同：2
> 
> 时间：2012-09-02T09:27:51.237
> 
> 标签：android

我正在使用 LG Optimus 3D 模型，当我将相机切换到视频录制模式时，我可以打开手电筒。在正常拍摄模式下，我只能打开闪光灯。

我尝试了几种方法，将不同的参数添加到 Camera 对象中，但它们都不起作用。我的代码如下：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_flash_light);

    PackageManager pm = getPackageManager();

    if (! pm.hasSystemFeature(PackageManager.FEATURE_CAMERA_FLASH)){
        Toast.makeText(this, "Your phone does not have flash light support.", Toast.LENGTH_LONG).show();
        finish();
    }

    camera = Camera.open(); 
    cParameters = camera.getParameters();

    cParameters.setFlashMode(Camera.Parameters.FLASH_MODE_TORCH);
camera.setParameters(cParameters);

} 
```

没有一点我不能以编程方式打开它，我已经检查如下以确保我的手机支持手电筒模式，事实上，我真的能够为我的设备打开它。

```
List<String> abc = cParameters.getSupportedFlashModes();

        for (String a : abc){
            Log.d("mode: ", a);
} 
```

请帮忙，无论如何要这样做？* 固件为 2.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:24:57.687

使用以下

```
 context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_CAMERA_FLASH); 
```

查看闪光灯是否可用。它将返回真或假。

更多关于如何实际实现代码的信息。

[如何打开安卓手电筒](https://stackoverflow.com/questions/7005001/android-lg-revolution-flashlight)

[在 Android 中使用相机手电筒](https://stackoverflow.com/questions/5503480/use-camera-flashlight-in-android?lq=1)

[如何在 Android 中以编程方式打开相机闪光灯？](https://stackoverflow.com/questions/6068803/how-turn-on-only-camera-flash-light-programmatically-in-android)

# c++ - 在 C++ 中调用 SetSystemFileCacheSize 失败

> ID：12234813
> 
> 赞同：0
> 
> 时间：2012-09-02T09:28:07.120
> 
> 标签：c++, visual-studio-2010, mfc, msdn

以下对 SetSystemFileCacheSize() 的调用失败，但是如果将“FILE_CACHE_MIN_HARD_ENABLE”替换为 0，则会通过。

我究竟做错了什么？

```
SIZE_T dwMinimumFileCacheSize = 1048576; // Exact number reported by SetSystemFileCacheSize.
SIZE_T dwMaximumFileCacheSize = 1099511627776; // Exact number reported by SetSystemFileCacheSize.

int result = SetSystemFileCacheSize(
    dwMinimumFileCacheSize, // dwMinimumWorkingSetSize
    dwMaximumFileCacheSize,  // dwMaximumWorkingSetSize,
    FILE_CACHE_MIN_HARD_ENABLE // Works if this flag is set to 0.
  );
if (result == 0)
{
  // Error is "5" if it fails.
  wprintf(L"  Error E2469: Could not set size of system cache, error %u.\n", GetLastError());
}
else
{
  wprintf(L"  Pass.\n");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T11:33:28.517

事实证明，如果启用了 FILE_CACHE_MIN_HARD_ENABLE，dwMinimumFileCacheSize 必须比 dwMaximumFileCacheSize 小 64KB。

这是修复：

```
int result = SetSystemFileCacheSize(
    dwMinimumFileCacheSize - 64 * 1024, // dwMinimumWorkingSetSize
    dwMaximumFileCacheSize,  // dwMaximumWorkingSetSize,
    FILE_CACHE_MIN_HARD_ENABLE // Works if this flag is set to 0.
  ); 
```

# c - 这条指令是做什么的？:- mov %gs:0x14,%eax

> ID：12234817
> 
> 赞同：5
> 
> 时间：2012-09-02T09:28:36.397
> 
> 标签：c, assembly, x86

我的问候和问候所有人。我有一个 C 程序，基本上是为测试缓冲区溢出而编写的。

```
 #include<stdio.h>
    void display()
    {
            char buff[8];
            gets(buff);
            puts(buff);
    }
    main()
    {
        display();
        return(0);
    } 
```

现在我使用 GDB 反汇编显示和主要部分。编码：-

函数 main 的汇编代码转储：

```
 0x080484ae <+0>:    push   %ebp        # saving ebp to stack
    0x080484af <+1>:    mov    %esp,%ebp   # saving esp in ebp
    0x080484b1 <+3>:    call   0x8048474 <display>   # calling display function
    0x080484b6 <+8>:    mov    $0x0,%eax   # move 0 into eax , but WHY ????
    0x080484bb <+13>:   pop    %ebp        # remove ebp from stack
    0x080484bc <+14>:   ret                # return 
```

汇编程序转储结束。

函数显示的汇编代码转储：

```
 0x08048474 <+0>:    push   %ebp          #saves ebp to stack        
    0x08048475 <+1>:    mov    %esp,%ebp     # saves esp to ebp
    0x08048477 <+3>:    sub    $0x10,%esp    # making 16 bytes space in stack
    0x0804847a <+6>:    mov    %gs:0x14,%eax  # what does it mean ????
    0x08048480 <+12>:   mov    %eax,-0x4(%ebp) # move eax contents to 4 bytes lower in stack
    0x08048483 <+15>:   xor    %eax,%eax       # xor eax with itself (but WHY??)
    0x08048485 <+17>:   lea    -0xc(%ebp),%eax  #Load effective address of 12 bytes 
                                              lower placed value ( WHY???? )

    0x08048488 <+20>:   mov    %eax,(%esp)      #make esp point to the address inside of eax
    0x0804848b <+23>:   call   0x8048374 <gets@plt>  # calling get, what is "@plt" ????
    0x08048490 <+28>:   lea    -0xc(%ebp),%eax       # LEA of 12 bytes lower to eax
    0x08048493 <+31>:   mov    %eax,(%esp)         # make esp point to eax contained address
    0x08048496 <+34>:   call   0x80483a4 <puts@plt>  # again what is "@plt" ????
    0x0804849b <+39>:   mov    -0x4(%ebp),%eax    # move (ebp - 4) location's contents to eax
    0x0804849e <+42>:   xor    %gs:0x14,%eax         # # again what is this ????
    0x080484a5 <+49>:   je     0x80484ac <display+56> # Not known to me
    0x080484a7 <+51>:   call   0x8048394 <__stack_chk_fail@plt>  # not known to me
    0x080484ac <+56>:   leave                        # a new instruction, not known to me
    0x080484ad <+57>:   ret                          # return to MAIN's next instruction 
```

汇编程序转储结束。

所以，伙计们，你应该考虑我的功课。剩下的所有代码我都知道，除了几行。我已经包括了一个很大的“为什么？？？？” 以及每行前面的评论中的更多问题。对我来说第一个障碍是“mov %gs:0x14,%eax”指令，我不能在这个指令之后制作流程图。有人请解释一下，这几条指令的含义是什么以及在程序中做什么？谢谢...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-02T10:09:42.653

```
0x080484b6 <+8>:    mov    $0x0,%eax   # move 0 into eax , but WHY ???? 
```

你没有这个吗：

```
return(0); 
```

他们可能是相关的。:)

```
0x0804847a <+6>:    mov    %gs:0x14,%eax  # what does it mean ???? 
```

这意味着从地址 gs:0x14 的内存中读取 4 个字节到 eax。gs 是一个段寄存器。`TLS`最有可能通过此寄存器引用线程本地存储 (AKA )。

```
0x08048483 <+15>:   xor    %eax,%eax       # xor eax with itself (but WHY??) 
```

不知道。可能与优化有关。

```
0x08048485 <+17>:   lea    -0xc(%ebp),%eax  #Load effective address of 12 bytes 
                                          lower placed value ( WHY???? ) 
```

它使 eax 指向一个存在于堆栈中的局部变量。`sub $0x10,%esp`为他们分配了一些空间。

```
0x08048488 <+20>:   mov    %eax,(%esp)      #make esp point to the address inside of eax 
```

错误的。它将 eax 写入堆栈，堆栈顶部。它将作为堆栈参数传递给被调用函数：

```
0x0804848b <+23>:   call   0x8048374 <gets@plt>  # calling get, what is "@plt" ???? 
```

我不知道。可能是一些名字修饰。

现在你应该已经猜到那是什么局部变量了。`buff`，还能是什么？

```
0x080484ac <+56>:   leave                        # a new instruction, not known to me 
```

为什么不去查CPU手册呢？

现在，我可能可以向您解释 gs/TLS 的事情......

```
0x08048474 <+0>:    push   %ebp          #saves ebp to stack        
0x08048475 <+1>:    mov    %esp,%ebp     # saves esp to ebp
0x08048477 <+3>:    sub    $0x10,%esp    # making 16 bytes space in stack
0x0804847a <+6>:    mov    %gs:0x14,%eax  # what does it mean ????
0x08048480 <+12>:   mov    %eax,-0x4(%ebp) # move eax contents to 4 bytes lower in stack
...
0x0804849b <+39>:   mov    -0x4(%ebp),%eax    # move (ebp - 4) location's contents to eax
0x0804849e <+42>:   xor    %gs:0x14,%eax         # # again what is this ????
0x080484a5 <+49>:   je     0x80484ac <display+56> # Not known to me
0x080484a7 <+51>:   call   0x8048394 <__stack_chk_fail@plt>  # not known to me
0x080484ac <+56> 
```

因此，此代码从 TLS 中获取一个值（位于 gs:0x14）并将其存储在已保存的 ebp 值下方（位于 ebp-4）。然后是你的东西`get()`and `put()`。然后此代码检查来自 TLS 的值的副本是否未更改。`xor %gs:0x14,%eax`比较。

如果 XOR 的值相同，则 XOR 的结果为 0，flags.zf 为 1。否则，结果不为 0，flags.zf 为 0。

`je 0x80484ac <display+56>`检查 flags.zf 并`call 0x8048394 <__stack_chk_fail@plt>`在 flags.zf = 1 时跳过。 IOW，如果来自 TLS 的值的副本未更改，则跳过此调用。

那是怎么回事？这是一种尝试捕获缓冲区溢出的方法。如果写入超出缓冲区的末尾，您将覆盖从 TLS 复制到堆栈的值。

为什么我们从 TLS 中获取这个值，为什么不只是一个固定的、硬编码的值？我们可能希望使用不同的、非硬编码的值来更频繁地捕获溢出（因此 TLS 中的值将在您的程序的运行到另一次运行时发生变化，并且在程序的不同线程中会有所不同）。如果每次程序运行时随机选择该值，这也会降低攻击者成功利用缓冲区溢出的机会。

最后，如果发现值的副本由于缓冲区溢出而被覆盖，`call 0x8048394 <__stack_chk_fail@plt>`将调用一个专用函数来执行任何必要的操作，例如报告问题并终止程序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-02T09:48:55.490

> ```
> 0x0804849e <+42>:   xor    %gs:0x14,%eax         # # again what is this ????
> 0x080484a5 <+49>:   je     0x80484ac <display+56> # Not known to me
> 0x080484a7 <+51>:   call   0x8048394 <__stack_chk_fail@plt>  # not known to me
> 0x080484ac <+56>:   leave                        # a new instruction, not known to me
> 0x080484ad <+57>:   ret                          # return to MAIN's next instruction 
> ```

gs[段](http://en.wikipedia.org/wiki/X86_memory_segmentation)可用于[线程本地存储](http://en.wikipedia.org/wiki/Thread-local_storage)。例如，它用于`errno`，因此多线程程序中的每个线程实际上都有自己的 errno 变量。

上面的函数名是一个很大的线索。这必须是[堆栈金丝雀](http://en.wikipedia.org/wiki/Stack_buffer_overflow#Stack_canaries)。

（`leave`是一些 CISC 指令，可以在实际 ret 之前完成您需要做的所有事情。我不知道细节）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-02T10:06:08.673

其他人已经解释了 GS 的事情（与线程有关）..

```
0x08048483 <+15>:   xor    %eax,%eax       # xor eax with itself (but WHY??) 
```

解释这一点需要一些 X86 架构的历史：

xor eax, eax 指令清除寄存器 eax 中的所有位（加载零），但正如您已经发现的那样，这似乎是不必要的，因为寄存器在下一条指令中加载了新值。

但是，xor eax, eax 在 x86 上也做了其他事情。您可能知道您可以使用 al、ah 和 ax 访问寄存器 eax 的部分内容。从 386 开始就是这样，当时 eax 真的是一个单一的寄存器时也没关系。

然而，这已经不复存在了。您在代码中看到和使用的寄存器只是占位符。CPU 内部正在使用更多的内部寄存器和完全不同的指令集。您编写的指令被翻译成这个内部指令集。

例如，如果您使用 AL、AH 和 EAX，从 CPU 的角度来看，您正在使用三个不同的寄存器。

现在，如果在使用 AL 或 AH 之后访问 EAX，CPU 必须合并这些不同的寄存器以构建有效的 EAX 值。

该行：

```
0x08048483 <+15>:   xor    %eax,%eax       # xor eax with itself (but WHY??) 
```

不仅清除寄存器 eax。它还告诉 CPU 所有重命名的子寄存器：AL、AH 和 AX 现在可以视为无效（设置为零）并且 CPU 不必进行任何子寄存器合并。

为什么编译器会发出这条指令？

因为编译器不知道 display() 将在哪个上下文中被调用。您可以从一段代码中调用它，该代码使用 AL 和 AH 执行大量字节运算。如果它不能通过 XOR 清除 EAX 寄存器，CPU 将不得不进行昂贵的寄存器合并，这需要很多周期。

所以在函数开始时做这些额外的工作可以提高性能。在您的情况下这是不必要的，但是由于编译器无法确定会发出指令。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-02T09:54:32.163

stack_check_fail 是 gcc 缓冲区溢出检查的一部分。它使用 libssp (stack-smash-protection)，并且您在开始时为堆栈设置了一个保护，xor %gs:0x14... 是一个检查保护是否仍然正常。当它正常时，它跳转到离开（检查汇编文档，它是堆栈处理的帮助指令）并跳过跳转到 stack_chk_fail，这将中止程序并发出错误消息。

您可以使用 gcc 选项禁用此溢出检查的发出`-fno-stack-protector`。

正如评论中已经提到的，xor x,x 只是一个清除 x 的快速命令，最后的 mov 0, %eax 是你的 main 的返回值。

# php - 在 CakePHP 中的控制器动作中绑定模型

> ID：12234821
> 
> 赞同：0
> 
> 时间：2012-09-02T09:29:07.890
> 
> 标签：php, cakephp, cakephp-2.0, lazy-loading

通常我在这样的类中加载模型：

```
public $uses = array('Table1', 'Table2', 'Table3'); 
```

但是我的一些模型只被 2-3 个动作使用。所以我不想为其他操作加载该模型。所以我需要声明“table1”控制器范围。当我在控制器中需要它们时加载“table2”和“table3”。可能吗？我在食谱里面找不到。

像这样的东西：

```
class myController extends Controller {
 public $uses = array('Table1');

 public function myaction() {
  $uses = array('Table2','Table3');
 ....
 }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T12:28:13.340

CakePHP 从 v2.x 开始使用延迟加载，也就是说，如果您在数组中指定模型，`$uses`它只会在真正使用时加载，因此可以使用您的第一个代码段。

但如有必要，您也可以使用该`[loadModel()](http://api.cakephp.org/class/controller#method-ControllerloadModel)`方法在单个操作中加载模型：

```
public function myaction() {
    $this->loadModel('ModelName');
    $this->ModelName->doSomething();
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T14:51:14.080

在任何控制器方法中，您都可以在需要时导入模型：

```
App::Import('Model', 'YourModel');

$foo = new YourModel(); 
```

现在您可以通过引用模型变量来调用方法，例如

```
$foo->myMethod() 
```

代替：

```
$this->Model->myMethod(); 
```

# javascript - Extract Values from incorrect Js Date Object?

> ID：12234822
> 
> 赞同：0
> 
> 时间：2012-09-02T09:29:12.670
> 
> 标签：javascript

I've build a function which checks if a date parts *values* are valid :

*Bad* value example :

```
new Date(2012,3,44) = 
Mon May 14 2012 00:00:00 GMT+0300 (Jerusalem Daylight Time) 
```

[**Here**](http://jsbin.com/ihibag/3/edit) is the function ( its arguments are being sent by me `separately` !)

```
function isDate(year, month, day)
{
   ...
}

alert(isDate( 2001,2,29)); 
```

However , I have a problem.

If I have an invalid date object like : `var t= new Date(2001,2,44)` : And I want to send it to my function , I need to extract its values.

*How* can I extract the `44` value + `2` value ?

```
t.getDate() //13
t.getMonth() //3   (days went from march to april) 
```

any help ?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T09:32:55.523

You can't extract the value `44` from the `Date` object, because it's not there.

When creating a `Date` object with out of range values, the values will be adjusted so that it becomes a valid date.

The components of a `Date` object always forms a valid date. If you want to check if the values are valid, you have to do that before creating the `Date` object, or use the `Date` object to check them:

```
var d = new Date(year, month, day);
if (d.getFullYear() == year && d.getMonth() == month && d.getDate() == day) {
  // components were valid
} 
```

# php - Zend_Console_Getopt 和应用程序环境 - 如何使用参数设置 APP_ENV？

> ID：12234825
> 
> 赞同：2
> 
> 时间：2012-09-02T09:29:59.740
> 
> 标签：php, zend-framework

我现在在构建允许使用 zend for app 构建控制台脚本的机制时遇到问题。例如像：

--脚本

----index.php

----basecmd.php

当 basecmd 包含其他脚本的主类时，文件结构为

```
include index.php
....
MyClass extends Zend_Console_Getopt{ 
```

但是在 index.php 中我需要使用参数设置 APPLICATION_ENVOIRMENT 作为 --application_env 发送到脚本 我的问题是我可以在使用 getopt 解析参数时设置它，但是如何在 index.php 中进行设置？信息：我需要显示错误，例如：'application_env must me always set when running script' 我将不胜感激任何指南。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T10:48:02.603

如果我理解正确，您正在尝试从 CLI/CMD 运行您的应用程序，方法是调用 basecmd.php，它将设置变量/常量以使 index.php 正常工作

您的 basecmd.php 应如下所示：

```
#!/usr/bin/env php
<?php
// basecmd.php
require_once 'path/to/Zend/Console/Getopt.php';
try {
    $opts = new Zend_Console_Getopt(
        array(
            'app-env|e=s' => 'Application environment',
            'app-path|ap=s' => 'Path to application folder',
            'lib-path|lp=s' => 'Path to library',
            // more options
        )
    );
    $opts->parse();
    if (!($path = $opts->getOption('ap'))) { // cli param is missing
        throw new Exception("You must specify application path");
    }
    define('APPLICATION_PATH', $path);
    // process other params and setup more constants/variables
} catch (Zend_Console_Getopt_Exception $e) {
    echo $e->getUsageMessage();
    exit;
} catch (Exception $e) {
    echo $e->getMessage() . "\n";
    exit;
}
// it is wise to setup another constant so application can determine is it a web or cli call
define('RUN_VIA', 'cli');
// if all done correctly include application loader script
include 'index.php'; 
```

在您的 index.php 中，您应该只测试是否已经定义了常量或变量：

```
<?php
// index.php
defined('APPLICATION_PATH') // is it defined
    or define('APPLICATION_PATH', '../application'); // no? then define it
defined('RUN_VIA')
    or define('RUN_VIA', 'web');
// ... rest of the code 
```

我希望这可以帮助您走上正轨；）

# objective-c - iOS：五个按钮使用相同的 UIView

> ID：12234826
> 
> 赞同：0
> 
> 时间：2012-09-02T09:30:01.687
> 
> 标签：objective-c, ios

我有一个包含五个不同`UIbutton`实例的表单。当我按下一个按钮时，我必须显示不同的选项，所以我的问题是，我怎么知道我用同一个按钮按下了哪个按钮`UIView`？我不想创建五个 UIView。可以给按钮一个ID吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:47:40.790

正如@Florent 指出的那样，您可以使用标签。但即使是这种复杂性也不需要 - 您可以直接比较按钮对象本身。

```
- (void)buttonClicked:(UIButton *)sender
{
    if (sender == button1) {
        // button 1 clicked
    } else if (sender == button2) {
        // etc.
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:34:47.643

您可以通过这种方式为每个 UIButton 分配一个标签：

```
[button setTag:4] 
```

或者您可以在 UIButton 的 View 属性中的 Interface Builder 中设置它。

然后在您的 IBAction 中：

```
- (IBAction)message:(id)sender 
{
  int currentSender = [sender tag];
  switch(currentSender) {
  // Different actions
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T12:03:31.870

尝试这个...

```
(IBAction)nextHipoacusia:(id)sender
 { 
  int currentSender = ((UIButton *)sender).tag;
 } 
```

# android - Android列表视图标题

> ID：12234827
> 
> 赞同：7
> 
> 时间：2012-09-02T09:30:21.383
> 
> 标签：android, listview, header, adapter

我有一个在列表视图中显示数据的应用程序，但我希望第一行被不同的布局膨胀，我这样做了，但由于列表项数量很大，我想优化列表视图并且存在问题。当我以这种方式填充 listview 时，我无法优化 listview，所以我怎样才能将应该放在第一行的内容放入 listview 标题女巫被某些布局夸大了，这是适配器的代码

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.main);

    LinearLayout content = (LinearLayout) findViewById(R.id.content);
    LinearLayout refLayout = (LinearLayout) findViewById(R.id.refLayout);

    refLayout.setVisibility(View.GONE);

    mBtnNaslovnica = (Button) findViewById(R.id.mBtnNaslovnica);
    mBtnNaslovnica.setSelected(true);
    TextView txtView=(TextView) findViewById(R.id.scroller);
txtView.setSelected(true);
    loadPage();
    ImageButton mBtnRefresh = (ImageButton) findViewById(R.id.btnRefresh);
    mBtnRefresh.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            new LoadingTask().execute(URL);
        }
    });

}

public void loadPage(){

    ArrayList<HashMap<String, String>> homeList = new ArrayList<HashMap<String, String>>();

        JSONObject jsonobj;
        try {
            jsonobj = new JSONObject(getIntent().getStringExtra("json"));
            JSONObject datajson = jsonobj.getJSONObject("data");
            JSONArray news = datajson.getJSONArray(TAG_NEWS);
            JSONArray actual = datajson.getJSONArray("actual");
            for(int i = 0; i < news.length(); i++){
                JSONObject c = news.getJSONObject(i);

                // Storing each json item in variable
                String id = c.getString(TAG_ID);
                String title = c.getString(TAG_TITLE);
                String story = c.getString(TAG_STORY);
                String shorten = c.getString(TAG_SH_STORY);
                String author = c.getString(TAG_AUTHOR);
                String datetime = c.getString(TAG_DATETIME);
                String img = c.getString(TAG_IMG);
                String big_img = c.getString(TAG_BIG_IMG);

                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();

                // adding each child node to HashMap key => value
                map.put(TAG_ID, id);
                map.put(TAG_TITLE, title);
                map.put(TAG_STORY, story);
                map.put(TAG_IMG, img);
                map.put(TAG_BIG_IMG, big_img);
                map.put(TAG_DATETIME, datetime);
                map.put(TAG_AUTHOR, author);

                // adding HashList to ArrayList
                homeList.add(map);}
            for(int i = 0; i < actual.length(); i++){
                JSONObject c = actual.getJSONObject(i);

                // Storing each json item in variable
                String id = c.getString(TAG_ACT_TIME);
                String body = c.getString(TAG_ACT_BODY);
                String anews = " | "+ id+ " " + body;
                String cur_anews = ((TextView) findViewById(R.id.scroller)).getText().toString();
                String complete = anews + cur_anews;
                TextView anewstv = (TextView) findViewById(R.id.scroller);
                anewstv.setText(complete);

                }
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    list=(ListView)findViewById(R.id.list);

    // Getting adapter by passing xml data ArrayList
    adapter=new LazyAdapter(this, homeList);        
    list.setAdapter(adapter);

    // Click event for single list row
    list.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
            String cur_title = ((TextView) view.findViewById(R.id.title)).getText().toString();
            String cur_story = ((TextView) view.findViewById(R.id.einfo2)).getText().toString();
            String cur_author = ((TextView) view.findViewById(R.id.einfo1)).getText().toString();
            String cur_datetime  = ((TextView) view.findViewById(R.id.tVdatetime)).getText().toString();
            String cur_actual  = ((TextView) findViewById(R.id.scroller)).getText().toString();
            ImageView cur_img = (ImageView) view.findViewById(R.id.list_image);
            String cur_img_url = (String) cur_img.getTag();

            Intent i = new Intent("com.example.androidhive.CURENTNEWS");
            i.putExtra("CUR_TITLE", cur_title);
            i.putExtra("CUR_STORY", cur_story);
            i.putExtra("CUR_AUTHOR", cur_author);
            i.putExtra("CUR_DATETIME", cur_datetime);
            i.putExtra("CUR_IMG_URL", cur_img_url);
            i.putExtra("CUR_ACTUAL", cur_actual);
            startActivity(i);
        }
    });     
}   

public void reloadPage(String jsonstring){
    ArrayList<HashMap<String, String>> homeList = new ArrayList<HashMap<String, String>>();

    JSONObject jsonobj;
    try {
        jsonobj = new JSONObject(jsonstring);
        JSONObject datajson = jsonobj.getJSONObject("data");
        JSONArray news = datajson.getJSONArray(TAG_NEWS);
        JSONArray actual = datajson.getJSONArray("actual");
        for(int i = 0; i < news.length(); i++){
            JSONObject c = news.getJSONObject(i);

            // Storing each json item in variable
            String id = c.getString(TAG_ID);
            String title = c.getString(TAG_TITLE);
            String story = c.getString(TAG_STORY);
            String shorten = c.getString(TAG_SH_STORY);
            String author = c.getString(TAG_AUTHOR);
            String datetime = c.getString(TAG_DATETIME);
            String img = c.getString(TAG_IMG);
            String big_img = c.getString(TAG_BIG_IMG);

            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();

            // adding each child node to HashMap key => value
            map.put(TAG_ID, id);
            map.put(TAG_TITLE, title);
            map.put(TAG_STORY, story);
            map.put(TAG_IMG, img);
            map.put(TAG_BIG_IMG, big_img);
            map.put(TAG_DATETIME, datetime);
            map.put(TAG_AUTHOR, author);

            // adding HashList to ArrayList
            homeList.add(map);}
        for(int i = 0; i < actual.length(); i++){
            JSONObject c = actual.getJSONObject(i);

            // Storing each json item in variable
            String id = c.getString(TAG_ACT_TIME);
            String body = c.getString(TAG_ACT_BODY);
            String anews = " | "+ id+ " " + body;
            String cur_anews = ((TextView) findViewById(R.id.scroller)).getText().toString();
            String complete = anews + cur_anews;
            TextView anewstv = (TextView) findViewById(R.id.scroller);
            anewstv.setText(complete);

            }
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

list=(ListView)findViewById(R.id.list);

// Getting adapter by passing xml data ArrayList
adapter=new LazyAdapter(this, homeList);        
list.setAdapter(adapter);

// Click event for single list row
list.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> parent, View view,int position, long id) {
        String cur_title = ((TextView) view.findViewById(R.id.title)).getText().toString();
        String cur_story = ((TextView) view.findViewById(R.id.einfo2)).getText().toString();
        String cur_author = ((TextView) view.findViewById(R.id.einfo1)).getText().toString();
        String cur_datetime  = ((TextView) view.findViewById(R.id.tVdatetime)).getText().toString();
        String cur_actual  = ((TextView) findViewById(R.id.scroller)).getText().toString();
        ImageView cur_img = (ImageView) view.findViewById(R.id.list_image);
        String cur_img_url = (String) cur_img.getTag();

        Intent i = new Intent("com.example.androidhive.CURENTNEWS");
        i.putExtra("CUR_TITLE", cur_title);
        i.putExtra("CUR_STORY", cur_story);
        i.putExtra("CUR_AUTHOR", cur_author);
        i.putExtra("CUR_DATETIME", cur_datetime);
        i.putExtra("CUR_IMG_URL", cur_img_url);
        i.putExtra("CUR_ACTUAL", cur_actual);
        startActivity(i);
    }
});
}

public void startNewActivity(){

}
public class LoadingTask extends AsyncTask<String, Object, Object>{
    XMLParser parser = new XMLParser();
    JSONParser jParser = new JSONParser();
    LinearLayout content = (LinearLayout) findViewById(R.id.content);
    LinearLayout refLayout = (LinearLayout) findViewById(R.id.refLayout);

    protected void onPreExecute(){
        content.setClickable(false);
        refLayout.setVisibility(View.VISIBLE);
    }

    @Override
    protected Object doInBackground(String... params) {
        // TODO Auto-generated method stub

        String URL = params[0];
        JSONObject json = jParser.getJSONFromUrl(URL);
        //String xml = parser.getXmlFromUrl(URL); // getting XML from URL
         // getting DOM element
        return json;
    }

    protected void onPostExecute(Object result){
        String json;
        json = result.toString();
        reloadPage(json);
        refLayout.setVisibility(View.GONE);
    }

}

} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-02T10:13:49.743

如果我明白你的意思 - 你可以采用 2 种方法：

1.  将 headerView 添加到列表中。这就像膨胀您的视图并将其传递给 `addHeaderView(View)` 您的列表一样简单。注意：必须在设置适配器之前添加这个视图，否则会抛出异常。

2.  但是，由于您的“标题”代表与所有其他项目相同的数据，但布局不同 - 我建议不要在这里使用 Header。相反，请尝试`getItemViewType()`在您的适配器中实现。[http://developer.android.com/reference/android/widget/BaseAdapter.html#getItemViewType(int](http://developer.android.com/reference/android/widget/BaseAdapter.html#getItemViewType(int) ) 如果你愿意 - 你将能够检查在`getView()`方法中返回哪种类型的布局。Android 会为你优化和重用你的膨胀视图，所以你可以确定`convertView`，传递给你的`getView`将是正确的类型和布局。

如果我应该解释更多细节，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T10:46:17.730

你可以这样做：

```
...
convertView.setOnClickListener(new OnItemClick(position));
...
public class OnItemClick implements OnClickListener {
   private final int index;
   public OnItemClick(int _index) {
            this.index = _index;
        }
   @Override
   public void onClick(View v) {
      //dosomething
   }
} 
```

# python - 在导入语句后运行“./script”会出现语法错误，但“python script”工作正常

> ID：12234828
> 
> 赞同：0
> 
> 时间：2012-09-02T09:30:31.353
> 
> 标签：python, python-2.7

我正在用 python 中的 sys.argv 做一些事情，这里是代码：

年龄1.py

```
import datetime
import os
import sys

if len(sys.argv) == 2:
    now_time = datetime.datetime.now()
    future_time = now_time + datetime.timedelta(int(sys.argv[1]))
    print "date in", sys.argv[1],"days",future_time

elif len(sys.argv) == 4:
    print "three paras"
    spe_time = datetime.datetime(int(sys.argv[1]),int(sys.argv[2]),int(sys.argv[3]))
    now_time = datetime.datetime.now()
    diff_time = now_time - spe_time
    print "days since then..." , diff_time 
```

如果我在 bash 中像这样运行代码：python age1.py xxxx，程序运行良好
，但如果我像 ./age1.py xxxx 那样运行，鼠标将变成像“+”这样的符号，然后程序结束：

```
"./age1.py: line 5: syntax error near unexpected token `sys.argv'  
./age1.py: line 5: `if len(sys.argv) == 2:' 
```

系统：Ubuntu 10.10
Python 2.7.3
有什么理由吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T09:32:41.717

您没有`#!/usr/bin/python`在文件的开头添加 a 。

您的 shell (bash) 试图解释 python 文件，就好像它是用 bash 脚本编写的一样，但失败了。就像给一个说英语的 3 岁孩子一本法语书，孩子认为单词是英语。

# android - 如何从 Cocos2dx 的 HelloWorld 示例创建 .apk？

> ID：12234832
> 
> 赞同：1
> 
> 时间：2012-09-02T09:31:08.207
> 
> 标签：android, eclipse, android-ndk, cocos2d-x

我正在使用 Windows 7 x64、cygwin、Eclipse Juno cpp、jre6、android ndk r8b、最新的 cocos2dx for windows。我已经尝试过这个教程链接。 [http://www.cnblogs.com/ybgame/archive/2012/06/07/2540693.html](http://www.cnblogs.com/ybgame/archive/2012/06/07/2540693.html)

我已经克服了错误。但不幸的是，Eclipse 构建器不会生成 .apk 文件。控制台的输出在这里： ![在此处输入图像描述](../Images/cc9536d54acf1dfe67be56344b6cac6c.png)

请注意，没有调用“make”命令。这与上面的教程链接不同，教程的最后一部分，控制台的输出显示了调用的 make 命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T23:03:18.367

右键单击您的 Eclipse 项目 -> Android 工具 -> 导出已签名（或未签名）应用程序包

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T08:55:46.473

在 msys 或 cygwin 中编译项目，然后从源代码导入/创建项目并命名。单击运行按钮。您会注意到在模拟器上运行的项目全部设置完毕。祝你好运。

# android - 应用程序类被杀死时重新打开应用程序崩溃

> ID：12234834
> 
> 赞同：0
> 
> 时间：2012-09-02T09:31:14.497
> 
> 标签：android, nullpointerexception

我正在使用应用程序类在解析后保存我的数据，以便在我的整个应用程序中访问它。这对我很有用。只有一个问题：

如果我停止使用我的应用程序，一段时间后，当我使用其他一些应用程序时，Android 有时会杀死应用程序类（我认为），因为当我重新打开我的应用程序时，我会收到 nullpointerexception 错误，因为数据即时加载不存在了.

我知道这就是 Android 所做的：如果应用程序需要内存，则终止应用程序，我并不想避免这种情况或其他任何事情。但是，当我从应用程序类中丢失数据时，有没有办法杀死我的整个应用程序？所以当我重新打开我的应用程序时，它只是重新启动整个应用程序（并重新加载数据）而不是尝试重新打开它，并因为丢失数据而崩溃？

# vim - 如何修复 Mountain Lion 中 VIM 系统剪贴板的使用

> ID：12234837
> 
> 赞同：4
> 
> 时间：2012-09-02T09:31:59.720
> 
> 标签：vim

`set clipboard+=unnamed`是我最喜欢的*.vimrc*配置之一。多亏了它，yanks 和 deletes 被复制到我的系统剪贴板，我可以轻松地将它们粘贴到其他应用程序。

但是，当我升级到 Mountain Lion 时，这个设置就失效了。

你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T10:17:28.840

Apple 提供的 Vim 版本*一直*缺乏有用的功能，`+clipboard`其中，还有 Python 和 Ruby 支持或 X11 相关的功能。

解决方案*一直*是自己安装最新的 Vim。有很多方法可以做到这一点。从相对无痛到相当投入：

*   安装 MacVim 并将捆绑的`mvim`脚本放在你的路径中。之后`$ mvim filename`将打开 MacVim 并`$ mvim -f filename`在终端中打开 MacVim 的 Vim 可执行文件。如果您想继续输入，请使用别名`$ vim filename`。

*   使用[Homebrew](https://brew.sh/)或[MacPorts](https://www.macports.org/)。

*   [从源安装](https://www.vim.org/download.php#unix)。

# spring - 使用 HibernateTemplate 时关闭会话

> ID：12234843
> 
> 赞同：3
> 
> 时间：2012-09-02T09:32:31.353
> 
> 标签：spring, hibernate, spring-orm

考虑以下代码：

```
public class UserDAOImpl implements UserDAO {

 private HibernateTemplate hibernateTemplate;
 public void setSessionFactory(SessionFactory sessionFactory){
  this.hibernateTemplate = new HibernateTemplate(sessionFactory);
  }

 public void saveUser(User user) {
 hibernateTemplate.saveOrUpdate(user);
 }

 public void deleteUser(User user) {
 hibernateTemplate.delete(user);
 }

} 
```

的主要任务之一`HibernateTemplate`是透明地打开和关闭会话。

在上面的代码中有两种方法`saveUser()`，`deleteUser()`我想问一下：

1）将为`HibernateTemplate`这两种方法创建两个单独的会话，并且在这种情况下发生会话的关闭/刷新。

2）它和spring事务一样吗，就像在spring中一样，事务是*在*方法调用和打开时建议的，会话的关闭发生在方法/事务的边界上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T11:22:57.800

默认刷新模式是`FlushMode.AUTO`. 看看下面的链接。我想它会回答你的问题。

[http://static.springsource.org/spring/docs/1.2.9/api/org/springframework/orm/hibernate3/HibernateAccessor.html#setFlushMode(int)](http://static.springsource.org/spring/docs/1.2.9/api/org/springframework/orm/hibernate3/HibernateAccessor.html#setFlushMode%28int%29)

[http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/FlushMode.html](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/FlushMode.html)

# ruby-on-rails - 配置 Facebook 的页面赞按钮

> ID：12234846
> 
> 赞同：0
> 
> 时间：2012-09-02T09:32:43.443
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, facebook-like, facebook-javascript-sdk

我想要一个类似 facebook 的按钮，我希望它的行为如下：当用户单击用户新闻提要中的按钮时，将显示以下内容： - 我的网站的名称 - 到我的网站的链接- 我的网站标志 - 简短描述

我在 rails 3 上使用 ruby​​。你能帮我配置一下吗？感谢：D。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:37:14.023

在下面的页面中配置您的要求
您可以通过向页面中的小部件提供输入来获取 facebook like 按钮所需的脚本

[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:05:43.623

如何实现这一点有两个步骤。第一步是在您的网站上使用适当的 OpenGraph 标签。这些只是 HTML 头部中的附加标签。您可以在[Open Graph 网页](http://ogp.me/)上找到示例。

第二步是嵌入like按钮。您可以在[Facebook 开发者页面](https://developers.facebook.com/docs/reference/plugins/like/)上配置代码。当用户点击按钮时，OpenGraph 标签会被自动解析，结果会显示在用户的流中。

# java - 如何检查特定版本的 Eclipse 内置插件

> ID：12234847
> 
> 赞同：2
> 
> 时间：2012-09-02T09:32:47.803
> 
> 标签：java, eclipse, plugins, versioning, git-checkout

我使用 Eclipse 4.2 Juno（内部版本号：I20120608-1400），我想更改其中一个内置插件，所以我想检查一下，但不知道如何。

该文件是：`org.eclipse.ui.workbench_3.103.0.v20120530-1824.jar`

我尝试了在 Eclipse 站点上找到的 CVS 存储库，但我找不到这个特定的标签/版本。我尝试了 Git，我可以在其中找到版本，但找不到`org.eclipse.ui.workbench`它本身。

有人可以告诉我如何一步一步地获取特定的 Eclipse 源版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:18:03.220

在最终迁移之前，我不建议使用 Git。

试试[这个资源](http://wiki.eclipse.org/CVS_Howto)或[其他](http://wiki.eclipse.org/SVN_Howto)

访问存储库的最佳方式是从 eclipse 本身。

# java - 自定义 JOptionPane 对话框

> ID：12234850
> 
> 赞同：9
> 
> 时间：2012-09-02T09:33:16.347
> 
> 标签：java, swing, jlabel, joptionpane, imageicon

我正在学习java swing。下面的代码是一个处理 IOException 并显示错误消息的 catch 块。

```
 catch(IOException e)
    {
        System.out.println("IOException");
        JOptionPane.showMessageDialog(null,"File not found",null,
                                    JOptionPane.ERROR_MESSAGE);
    } 
```

我正在考虑在 catch 块中声明和自定义我自己的 JOptionPane，如下面的代码：

```
JOptionPane jop=new JOptionPane();
        jop.setLayout(new BorderLayout());
        JLabel im=new JLabel("Java Technology Dive Log",
                new ImageIcon("images/gwhite.gif"),JLabel.CENTER);
        jop.add(im,BorderLayout.NORTH);
        jop.setVisible(true); 
```

但问题是我不知道如何让它像 showMessageDialogue 方法那样出现在屏幕上。请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-02T10:42:12.357

您可以简单地将组件添加到 a 中`JPanel`，然后将其添加`JPanel`到您的`JOptionPane`中，如以下小示例所示：

```
import java.awt.*;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import javax.swing.*;
import javax.imageio.ImageIO;

public class JOptionPaneExample {

    private void displayGUI() {
        JOptionPane.showConfirmDialog(null,
                        getPanel(),
                        "JOptionPane Example : ",
                        JOptionPane.OK_CANCEL_OPTION,
                        JOptionPane.PLAIN_MESSAGE);
    }

    private JPanel getPanel() {
        JPanel panel = new JPanel();
        JLabel label = new JLabel("Java Technology Dive Log");
        ImageIcon image = null;
        try {
            image = new ImageIcon(ImageIO.read(
                    new URL("http://i.imgur.com/6mbHZRU.png")));
        } catch(MalformedURLException mue) {
            mue.printStackTrace();
        } catch(IOException ioe) {
            ioe.printStackTrace();
        } 

        label.setIcon(image);
        panel.add(label);

        return panel;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new JOptionPaneExample().displayGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T09:42:49.567

我想这取决于有什么问题`JOptionPaneshowMessageDialog(Component parentComponent, Object message, String title, int messageType, Icon icon)`？

```
JOptionPane.showMessageDialog(null, "Java Technolgy Dive Log", "Dive", JOptionPane.INFORMATION_MESSAGE, new ImageIcon("images/gwhite.gif")); 
```

![对话](../Images/c7ef9bca19227643759c2576de8d0489.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-02T09:46:59.503

```
JOptionPane jop = new JOptionPane();
JDialog dialog = jop.createDialog("File not found");
dialog.setLayout(new BorderLayout());
JLabel im = new JLabel("Java Technology Dive Log", new ImageIcon("images/gwhite.gif"), JLabel.CENTER);
dialog.add(im, BorderLayout.NORTH);
dialog.setVisible(true); 
```

# javascript - 如何通过facebook graph api从相册中获取大图片

> ID：12234853
> 
> 赞同：1
> 
> 时间：2012-09-02T09:33:49.793
> 
> 标签：javascript, facebook, facebook-graph-api

我目前正在使用以下代码从用户个人资料中检索所有照片

```
FB.api('/me/albums?fields=id,name', function(response) {
  //console.log(response.data.length);
  for (var i = 0; i < response.data.length; i++) {
    var album = response.data[i];

    FB.api('/' + album.id + '/photos', function(photos) {
      if (photos && photos.data && photos.data.length) {
        for (var j = 0; j < photos.data.length; j++) {
          var photo = photos.data[j];
          // photo.picture contain the link to picture
          var image = document.createElement('img');
          image.src = photo.picture;
          document.body.appendChild(image);
          image.className = "border";

          image.onclick = function() {
            //this.parentNode.removeChild(this);
            document.getElementById(info.id).src = this.src;
            document.getElementById(info.id).style.width = "220px";
            document.getElementById(info.id).style.height = "126px";
          };
        }
      }
    });

  }
}); 
```

但是，它返回的照片质量很差，基本上就像缩略图一样。如何从相册中检索更大的照片。

通常对于个人资料图片，我使用 ?type=large 返回一个不错的个人资料图片

但是 type=large 不适用于相册中的照片，并且一旦我指定照片网址，是否有办法从 facebook 获取 zip 格式的照片，因为我希望用户能够下载照片。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T03:50:11.720

你需要改变：

```
image.src = photo.picture; 
```

到：

```
image.src = photo.source; 
```

源成员是指向完整照片的链接，而不是图片成员提供的缩略图链接。

参考链接： [https ://developers.facebook.com/docs/reference/api/photo/](https://developers.facebook.com/docs/reference/api/photo/)

# sql-server - 为什么 Db1.DataBind() 属性不起作用？

> ID：12234859
> 
> 赞同：-1
> 
> 时间：2012-09-02T09:34:51.483
> 
> 标签：sql-server, vb.net

```
cmd = New SqlCommand
cmd.Parameters.Add("@Mod", SqlDbType.Int).Value = 4
con.Open()
dr = cmd.ExecuteReader
Db1.DataSource = dr
Db1.DataBind() 
```

为什么 Db1.DataBind() 属性不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:51:51.977

```
SqlConnection conn=new SqlConnection(your db connestionString);
con.Open()
SqlCommand cmd = New SqlCommand();
cmd.Connection=conn;
//here Iguess you are trying to pass this parameter to sql strored procedure.
//So first set cmd.Commanndtype to sproc
cmd.Parameters.Add("@Mod", SqlDbType.Int).Value = 4
dr = cmd.ExecuteReader
Db1.DataSource = dr
Db1.DataBind() 
```

# performance - 最少两个数字的最快方法

> ID：12234860
> 
> 赞同：1
> 
> 时间：2012-09-02T09:34:59.420
> 
> 标签：performance, boolean-operations

我正在浏览麻省理工学院与性能工程相关的开放课件。

找到两个数字（比如 x 和 y）中的最小值的最快方法（需要最少的时钟周期数）如下所示：

```
min= y^((x^y) & -(x<y)) 
```

表达式 x < y 的输出可以是 0 或 1（假设正在使用 C），然后变为 -0 或 -1。我知道 xor 可以用来交换两个数字。

问题： 1\. 就二进制而言，-0 与 0 和 -1 有何不同？2\. 该结果如何与 and 运算符一起使用以获得最小值？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:43:35.897

-假=0，-真=-1=255d=11111111b。见[这里](https://stackoverflow.com/questions/11544041/how-does-the-unary-minus-operator-work-on-booleans-in-c)
如果 x>y，该行将是：

```
min=y^((x^y) & -false)=y^(x^y & 0)=y^0=y 
```

如果 y>x 该行将是：

```
min=y^((x^y) & -true)=y^(x^y & 11111111)=y^(x^y)=x 
```

因此 min 将是实际的最小值。

# sql - 条件组合的前 3 个最大条目

> ID：12234863
> 
> 赞同：0
> 
> 时间：2012-09-02T09:35:20.447
> 
> 标签：sql

我是 sql 方面的新手。所以如果这个问题听起来很简单，那么请放过我。我在 sql 表中有 4 个列。假设 A,B,C,D 。对于任何 BC 组合，我可以获得任意数量的行。对于这些选定的行，我需要获得最多 3 行（这反过来为我提供了 3 个唯一的 A 值）对于这些选定的行，我应该具有 D 的前 3 个最大值。与该 BC 组合的其他条目相比。

因此可以有任意数量的 BC 组合，因此上述逻辑应该暗示所有这些组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T12:55:55.850

大多数数据库都支持排名功能。有了这些，你可以做你想做的事情，如下所示：

```
select A, B, C, D
from (select t.*,
             row_number() over (partition by B, C order by D desc) as seqnum
      from t
     ) t
where seqnum <= 3
order by B, C, D desc 
```

row_number() 函数创建一个序列号。此数字在非常 B、C 组中从“1”开始，并按 D 的值降序排列。

# ios - 使用 drawRect 在字符串 (\n) 中呈现新行

> ID：12234865
> 
> 赞同：1
> 
> 时间：2012-09-02T09:35:29.203
> 
> 标签：ios, xcode, newline, line-breaks

我正在尝试使用 drawRect 呈现带有新行（换行符 \n）的字符串。

下面的代码将 my 字符串呈现为单行，没有换行符，即使我使用的是 \n 字符。见倒数第二行。

```
UIFont *font =  [UIFont fontWithName:@"HelveticaNeue-CondensedBlack" size:fontSize];
CGPoint point = CGPointMake(0,0);
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSetRGBFillColor(context, 1.0, 1.0, 1.0, 1.0);
CGContextSetRGBStrokeColor(context, 0.0, 0.0, 0.0, 1.0);
CGContextSetLineWidth(context, 4.0);
CGContextSetTextDrawingMode(context, kCGTextFillStroke);
CGContextSaveGState(context);
[@"test \n test" drawAtPoint:point withFont:font];

CGContextRestoreGState(context); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:44:20.437

使用

```
- (CGSize)drawInRect:(CGRect)rect withFont:(UIFont *)font lineBreakMode:(UILineBreakMode)lineBreakMode 
```

方法来绘制你的字符串。

# python - 这里有更好的算法吗？

> ID：12234867
> 
> 赞同：1
> 
> 时间：2012-09-02T09:35:55.347
> 
> 标签：python, algorithm

我正在尝试用 Python 解决[这个](http://www.codechef.com/SEP12/problems/CKISSHUG)问题。注意到只有第一个吻需要交替，任何由于第一个吻而不是链的一部分的吻都可以很好地在第二个人身上拥抱，这是我想出的代码。这只是一个简单的数学计算，没有循环，没有迭代，什么都没有。但我仍然收到一条超时消息。有什么办法可以优化吗？

```
import psyco
psyco.full()
testcase = int(raw_input())
for i in xrange(0,testcase):
    n = int(raw_input())
    if n%2:
        m = n/2;
        ans = 2 + 4*(2**m-1);
        ans = ans%1000000007;
        print ans
    else:
        m = n/2 - 1
        ans = 2 + 2**(n/2) + 4*(2**m-1);
        ans = ans%1000000007
        print ans 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-02T09:43:35.147

您的计算能力具有非常大的指数，如果结果没有在过程中减少，这将非常慢。例如，一个简单的计算`10**10000000 % 11`需要创建一个 10000000 位数字并取模 11。更好的方法是[模幂运算](http://en.wikipedia.org/wiki/Modular_exponentiation)，在每次乘法后减少模 11，整数永远不会变大。

Python 提供了内置的模幂运算。用于`pow(a,b,c)`计算`(a**b) % c`.

这是假设您的算法是正确的，我没有验证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T10:38:13.717

答案是一个非常简单的递归。`F(1) = 2`因为`F(n)`我们有两个选择：

*   `n = H`，那么亲吻剩下的客人的方式数简直就是`F(n-1)`
*   `n = K`，那么亲吻剩余客人的方式数就是公主不被强迫亲吻的剩余客人的数量`2 ** k`。`k`由于她必须亲吻剩下的每一位客人，`k = ceil((n - 1) / 2)`

把它们放在一起，我们得到`F(n) = F(n - 1) + 2 ** ceil((n - 1) / 2)`

我的尝试，包括采取一切 mod 1000000007：

```
from math import ceil

def F(n):
    m = 1000000007
    a = 2
    for i in range(2, n+1):
        a = (a + pow(2, int(ceil((i - 1.0) / 2)), m)) % m
    return a 
```

**编辑：**更新（更快，更不可读！`F(1e9)`大约需要 3 分钟）：

```
def F(n):
    m = 1000000007
    a = 2
    z = 1

    for i in xrange(2, n, 2):
        z = (z * 2) % m
        a = (a + z + z) % m

    if (n & 1 == 0):
        z = (z * 2) % m
        a = (a + z) % m

    return a 
```

**编辑2：**经过进一步思考，我意识到上面实际上只是：

```
F(n) = (1 + 1) + (2 + 2) + (4 + 4) + ... + (2 ** n/2 + 2 ** n/2)
     = 2 * (1 + 2 + 4 + ... + 2 ** n/2)
     = 2 * (2 ** (n/2 + 1) - 1)
     = 2 ** (n/2 + 2) - 2 
```

但是如果`n`是偶数，最后一个`2 ** n/2`只出现一次，所以我们有：

```
def F(n):
    m = 1000000007
    z = pow(2, n/2, m)

    if (n % 2 == 0):
        return (z * 3 - 2) % m
    else:
        return (z * 4 - 2) % m 
```

哪个运行得更快！（受速度限制`pow(x, y, z)`，我认为是`O(lg n)`？）

仅仅因为，这里是单线：

```
def F(n):
    return (pow(2, n/2, 1000000007) * (3 + n % 2) - 2) % 1000000007 
```

结果：

```
1   => 2
2   => 4
3   => 6
4   => 10
5   => 14
6   => 22
7   => 30
8   => 46
9   => 62
10  => 94
1e6 => 902893650
1e7 => 502879941
1e8 => 251151906
1e9 => 375000001 
```

# php - PHP Explode 使用 Unicode 字符作为分隔符

> ID：12234868
> 
> 赞同：4
> 
> 时间：2012-09-02T09:36:06.880
> 
> 标签：php, unicode, explode, pdftotext, xpdf

XPDFs pdftotext 将 pdf 转换为文本并在命令行级别输出。如果需要，它会在 TextOutputDev.cc 中指定的页面之间插入 PageBreaks：

```
eopLen = uMap->mapUnicode(0x0c, eop, sizeof(eop)); 
```

这个 Unicode 符号是独立于编码的，`-enc ASCII7`不会改变它。我目前愿意使用 PHP 将 PDF 文件转换和拆分为几个 TXT 页面用于数据库存储。但是，以下功能确实有效，但一次转换整个 PDF 所需的时间是转换的两倍。

```
for($i = 1; $i <= $pages[0]; $i++)
    $page[$i] = shell_exec('/usr/bin/pdftotext sample.pdf -f '.$i.' -l '.$i.' -'); 
```

我应该如何`explode(0x0c, $wholePDF)`使用 Unicode 字符作为分隔符？目前，page[$i] 似乎没有从 shell_exec() 中检索那些奇怪的 Unicode PageBreak 字符。我尝试了几个用于编码的标头（尤其是 UTF-8），但到目前为止还没有成功。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T09:42:07.923

`0x0c`是一个 ASCII 字符（即在 0-127 范围内），因此在 UTF-8 编码中它表示为自身而不是多字节序列。你应该能够`explode(chr(0x0c), $wholePDF)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:39:22.697

我猜你可以将它转换为另一种类型，然后使用符号来爆炸：

[http://www.php.net/manual/en/ref.mbstring.php#74722](http://www.php.net/manual/en/ref.mbstring.php#74722)

# asp.net - 在 Asp.net 中运行外部可执行文件的内存限制

> ID：12234873
> 
> 赞同：7
> 
> 时间：2012-09-02T09:37:08.443
> 
> 标签：asp.net, memory-management, wkhtmltopdf, external-process

我在运行于 .NET 4.0 的 C# Web 应用程序中使用 WkhtmltoPdf 从 HTML 文件生成 PDF。一般来说，除了 HTML 文件的大小低于 250KB 时，一切正常。一旦 HTML 文件大小超过此值，运行 wkhtmltopdf.exe 的进程就会出现如下异常。在任务管理器上，我看到 wkhtmltopdf.exe 进程的内存值没有增加到超过 40,096 K 的值，我相信这就是该进程在两者之间被放弃的原因。

我们如何配置以增加外部 exe 的内存限制？有没有其他方法可以解决这个问题？

更多信息：
当我直接从命令行运行转换时，PDF 生成良好。因此，它不太可能是 WkhtmlToPdf 的问题。

错误来自本地主机。我在 DEV 服务器上尝试过相同的方法，结果相同。

**编辑：**

> 更具体的异常消息： - 对于 Process 对象的 MainModule 属性，错误显示 - {“仅部分 ReadProcessMemory 或 WriteProcessMemory 请求已完成”}，NativeErrorCode 值 - 299。

例外：

```
> [Exception: Loading pages (1/6) [>                                    
> ] 0% [======>                                                     ]
> 10% [======>                                                     ] 11%
> [=======>                                                    ] 13%
> [=========>                                                  ] 15%
> [==========>                                                 ] 18%
> [============>                                               ] 20%
> [=============>                                              ] 22%
> [==============>                                             ] 24%
> [===============>                                            ] 26%
> [=================>                                          ] 29%
> [==================>                                         ] 31%
> [===================>                                        ] 33%
> [=====================>                                      ] 35%
> [======================>                                     ] 37%
> [========================>                                   ] 40%
> [=========================>                                  ] 42%
> [==========================>                                 ] 44%
> [============================>                               ] 47%
> [=============================>                              ] 49%
> [==============================>                             ] 51%
> [============================================================] 100%
> Counting pages (2/6)                                               
> [============================================================] Object
> 1 of 1 Resolving links (4/6)                                          
> [============================================================] Object
> 1 of 1 Loading headers and footers (5/6)                              
> Printing pages (6/6) [>                                               
> ] Preparing [=>                                                       
> ] Page 1 of 49 [==>                                                   
> ] Page 2 of 49 [===>                                                  
> ] Page 3 of 49 [====>                                                 
> ] Page 4 of 49 [======>                                               
> ] Page 5 of 49 [=======>                                              
> ] Page 6 of 49 [========>                                             
> ] Page 7 of 49 [=========>                                            
> ] Page 8 of 49 [==========>                                           
> ] Page 9 of 49 [============>                                         
> ] Page 10 of 49 [=============>                                       
> ] Page 11 of 49 [==============>                                      
> ] Page 12 of 49 [===============>                                     
> ] Page 13 of 49 [================>                                    
> ] Page 14 of 49 [==================>                                  
> ] Page 15 of 49 [===================>                                 
> ] Page 16 of 49 [====================>                                
> ] Page 17 of 49 [=====================>                               
> ] Page 18 of 49 [======================>                              
> ] Page 19 of 49 [========================>                            
> ] Page 20 of 49 [=========================>                           
> ] Page 21 of 49 [==========================>                          
> ] Page 22 of 49 [===========================>                         
> ] Page 23 of 49 [============================>                        
> ] Page 24 of 49 [==============================>                      
> ] Page 25 of 49 [===============================>                     
> ] Page 26 of 49 [=================================>                   
> ] Page 27 of 49 [==================================>                  
> ] 
```

我使用的代码：

```
 var fileName = " - ";
    var wkhtmlDir = ConfigurationManager.AppSettings[Constants.AppSettings.ExportToPdfExecutablePath];
    var wkhtml = ConfigurationManager.AppSettings[Constants.AppSettings.ExportToPdfExecutablePath] + "\\wkhtmltopdf.exe";
    var p = new Process();

    string switches = "";
    switches += "--print-media-type ";
    switches += "--margin-top 10mm --margin-bottom 10mm --margin-right 5mm --margin-left 5mm ";
    switches += "--page-size A4 ";
    switches += "--disable-smart-shrinking ";

    var startInfo = new ProcessStartInfo
    {
        CreateNoWindow = true,
        FileName = wkhtml,
        Arguments = switches + " " + url + " " + fileName,
        UseShellExecute = false,
        RedirectStandardOutput = true,
        RedirectStandardError = true,
        RedirectStandardInput=true,
        WorkingDirectory=wkhtmlDir
    };

    p.StartInfo = startInfo;
    p.Start(); 
```

WkHtmlToPdf.exe 进程调试器截图：

![在此处输入图像描述](../Images/900ad6f46a09317cc4cda30256fbbc28.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T12:13:33.107

看看[这个](http://msdn.microsoft.com/en-us/library/ee377050%28v=bts.10%29.aspx)，看看每个进程的线程数限制是否会在这里发挥作用。这是一个很长的镜头（我不知道 IIS 对外部进程施加的任何内存限制），但请从文档中注意这一点：

> 因为该属性定义了可以同时执行的最大 ASP 请求数，所以该设置应保持默认值，除非您的 ASP 应用程序对外部组件进行扩展调用。在这种情况下，您可以增加 Threads Per Processor Limit 的值。这样做允许服务器创建更多线程来处理更多并发请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T22:36:47.547

这就是你要找的：

[http://jobobjectwrapper.codeplex.com/](http://jobobjectwrapper.codeplex.com/)

我找不到与“增加”进程的内存限制有关的任何其他内容，尽管我听说有人用 来限制进程内存`MaxWorkingSet`，但我相信这仅适用于应用程序使用完所有它可以.

Job Object 是一个很好的起点，它们只是易于控制的过程的集合。

> “使用这个库，您可以创建作业对象、创建进程并将其分配给作业、**控制进程和作业限制**，并注册各种与进程和作业相关的通知事件。”

这也可能有用：

[调用 wkhtmltopdf 从 HTML 生成 PDF](https://stackoverflow.com/questions/1331926/calling-wkhtmltopdf-to-generate-pdf-from-html/1698839#1698839)

# sql - T-SQL 计算二叉树中的子节点？

> ID：12234876
> 
> 赞同：2
> 
> 时间：2012-09-02T09:37:26.393
> 
> 标签：sql, tsql, binary-tree

我做了一个表来存储一个二叉树，如下所示：

```
- NodeID
- NodeLeft
- NodeRight 
```

NodeLeft 存储左节点的 ID。而Node right存储了正确节点的ID。

我需要编写一个程序，如果我传递一个 NodeID，它将计算左侧有多少个子节点，右侧有多少个子节点。可以分离到2个程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T10:52:47.950

试试这个：

```
WITH CTE_Node(
  NodeID,
  NodeRigth,
  NodeLeft,
  Level,
  RigthOrLeft
  )
AS
(
SELECT 
 NodeID,
  NodeRigth,
  NodeLeft,
  0 AS Level,
  'P'
  FROM Node
  WHERE NodeID = 1

  UNION ALL

  SELECT 
 Node.NodeID,
  Node.NodeRigth,
  Node.NodeLeft,
  Level + 1,
  CASE WHEN CTE_Node.NodeLeft = Node.NodeID THEN 'R' ELSE 'L' END
  FROM Node
INNER JOIN CTE_Node ON CTE_Node.NodeLeft = Node.NodeID
  OR CTE_Node.NodeRigth = Node.NodeID
  )
SELECT DISTINCT RigthOrLeft, 
COUNT(NodeID) OVER(PARTITION BY RigthOrLeft)  
FROM CTE_Node 
```

这是一个[SQL Fiddle](http://www.sqlfiddle.com/#!3/cc63e/23)。关卡只是在那里看看它是如何工作的。愿你以后可以使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T15:25:45.500

我找到了这个话题。 [http://www.sqlservercentral.com/Forums/Topic1152543-392-1.aspx](http://www.sqlservercentral.com/Forums/Topic1152543-392-1.aspx)

表结构与我设计的表不同。但它是一棵二叉树，所以我可以使用它。

SQL Fiddle 非常有帮助。

# windows - 使用 Chef Knife winrm 将文件传输到远程窗口机器

> ID：12234877
> 
> 赞同：2
> 
> 时间：2012-09-02T09:37:35.740
> 
> 标签：windows, linux, powershell, chef-infra, winrm

有没有办法使用`winrm / powershell`或任何本机 Windows 命令将文件传输到远程 Windows 机器？

我`knife-windows`在其中一台 Linux 机器上安装了 Chef。我想使用`knife winrm`或任何本机 windows 命令将文件从 linux 机器传输到 windows 机器，而无需在 windows 机器上安装任何其他软件包。

我试图 cat 一个文件并将其传递给`knife winrm`命令并执行一个`Set-Content`或`Out-File` `powershell`命令，但它没有按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-19T18:23:16.430

从 PowerShell

```
knife winrm -m <IP> -x <USER> -P <PASS> "echo $(gc .\secret_key)>c:\secret_key" 
```

您必须记住，主要问题是无论您的执行上下文（powershell / bash shell）如何，目标始终是 CMD。所以你必须遵守目的地规则。

`$(gc .\secret_key)`本地获取文件内容，`echo`远程执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T13:30:25.220

如果您对 Windows 框具有管理员访问权限，您始终[可以](http://support.microsoft.com/kb/314984)通过`SMB`.

# php - GIT - Web 开发工作流/部署

> ID：12234883
> 
> 赞同：1
> 
> 时间：2012-09-02T09:38:34.507
> 
> 标签：php, linux, git, version-control, web-deployment

我是一个由 3 人（2 名开发人员和 1 名设计师）组成的团队的一员，他们有时在办公室工作，有时在远程工作，我正在寻找一种使用 GIT 无缝开发我们网站的方法。我有一个 Rackspace 的托管帐户，并在该帐户上设置了 3 台服务器 - 开发、登台和生产。

我正在寻找让我们的团队每天在我们的网站上进行开发的最佳方式，而不必在每次进行任何更改时都将文件通过 FTP 上传到服务器。我过去使用过 SVN，但我希望使用 Git 进行版本控制。对于一个名为“test”的示例网站，我想到的工作流程如下：

开发服务器将为每个用户以及一个中央目录提供一个目录（称为中继，但不确定是否应该将其称为其他名称？）。例如 /var/www/test/jbloggs/、/var/www/test/asmith/、/var/www/test/rjohnson/ 和 /var/www/test/central/trunk/。

中央存储库将安装在 /var/www/test/central/trunk/ 中，然后 /asmith/、/rjohnson/ 和 /jbloggs/ 将克隆主干，这意味着它们将成为 /var/www/test/asmith/主干，/var/www/test/rjohnson/trunk/ 和 /var/www/test/jbloggs/trunk/。

然后每个用户将拥有一份 /trunk/ 的副本，其中将包含所有网站文件，都将配置一个子域，即 jbloggs.test.development、rjohnson.test.development 等，并将他们的 IDE 配置为自动 SFTP 到服务器，因此他们直接在开发服务器的目录中工作。中央目录域将是 test.development。当他们向中央存储库提交任何更改时，他们将通过 SSH 连接到服务器并提交更改，当我们想要更新中央存储库时，我们将拉取这些更改以获取最新版本，然后可以在 test.development 查看。

这是正确的做事方法，还是我们都应该安装本地 LAMP 堆栈（除了使用 Windows 的设计师）并在本地拥有我们的存储库？如果是这样，中央存储库是否仍应位于机架空间服务器上？开发人员将使用 phpstorm 和设计器 dreamweaver。

希望以上是有道理的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:01:03.970

我强烈建议您在本地工作，然后在共享服务器上提交。这就是 git 的用途。对每个人来说，开发将更加被动和容易。确保所有开发大师 git，以便他们可以随心所欲地做他们的内部汤。如果一个开发人员破坏了数据库，其他开发人员可以继续工作。但是您还需要一种方便的方式来同步数据库，以便开发人员使用最新的本地数据库。

你的链的其余部分没问题，你仍然可以有两个测试步骤，比如开发团队的开发服务器和测试人员的测试服务器。这将使测试人员在更稳定的版本上工作，并且还可以让您在将更改从开发服务器复制到测试服务器时测试升级过程。由于未经测试的升级过程会出现很多错误。您可以通过在测试和生产服务器上安装 GIT 或仅使用将 ftp 更改的文件的简单脚本来更新测试和生产服务器上的更改。我不喜欢在生产服务器上安装 git，但这是个人意见。

# entity-framework - ssms无法打开EF创建数据库（拒绝访问）

> ID：12234884
> 
> 赞同：0
> 
> 时间：2012-09-02T09:38:42.363
> 
> 标签：entity-framework, ssms

`C:\Temp\MyDB.mdf`我使用 : 来创建实体数据库（如果文件不存在）`MyEFContext.CreateDatabase()`。

我可以使用 VS Express 2010 打开数据库并浏览它，但是当尝试在 SSMS 中添加（加入）数据库时，我收到以下错误：`Unable to open the physical file "C:\Temp\MyDB.mdf". Operating system error 5: "5(Access is denied.)". (Microsoft SQL Server, Error: 5120)`

我怎样才能解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:49:11.080

这是一个权利问题。

在它工作的情况下，您处于您登录的用户帐户的用户上下文中。

在它不起作用的情况下，正在尝试访问该文件的是运行 SQL 服务器的用户帐户。

检查 SQL 服务器正在使用哪个帐户，然后授予该帐户访问临时目录中文件的权限。

# c - 我的代码不适用于大输入

> ID：12234886
> 
> 赞同：0
> 
> 时间：2012-09-02T09:38:58.697
> 
> 标签：c

问题陈述在这里[https://www.interviewstreet.com/challenges/dashboard/#problem/4fe12e4cbb829](https://www.interviewstreet.com/challenges/dashboard/#problem/4fe12e4cbb829)

```
You are distributing candy among children. All the children sit in a line and each of
them  has a rating score according to his or her usual performance. Each child gets 
at least 1 piece. Children get jealous of their immediate neighbors, so if two 
children sit next to each other then the one with the higher rating must get 
more candies. You wants to save money, so minimize the total number of candies.

Input: A file with the children's ratings, 1 per line. 
```

而且我的代码适用于小输入大小，但对于非常大的输入，它要么不提供任何输出（在 interview.com 控制台上），要么在我的系统上与答案有少量偏差。我的代码中的错误有多冷？

```
#include <stdio.h>

int main() 
{
    int i, j, n, rating[100000], candy[1000000], total = 0;

    scanf("%d", &n);

    for (i=0 ; i < n; i++) 
    {
        scanf("%d",&rating[i]);
        candy[i] = 1;
    }

    for (i=0 ; i < n+1 ; i++)
    {
      for (j=1 ; j < n-1; j++)
      {
          if( rating[j-1] < rating[j] )
          {
              if ( candy[j-1] >= candy[j] )
                  candy[j]++;
          }

          if( rating[j+1] < rating[j] )
          {
              if ( candy[j+1] >= candy[j] )
                  candy[j]++;
          }       
      }  
    }

    for (i=0 ; i < n ; i++)
        total = total + candy[i];

    printf("%d",total);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:21:56.340

您可能会遇到使用自动数组`rating`和`candy`. 尝试将它们放在文件范围内，即`main`. 然后它们具有静态存储持续时间。大多数系统允许比自动对象大得多的静态对象。

# django - 更新模型对象中的计数变量

> ID：12234889
> 
> 赞同：0
> 
> 时间：2012-09-02T09:39:45.470
> 
> 标签：django, django-models, django-views, django-1.3

我想做的很简单，我想在每次调用视图函数时更新对象的计数变量。

我的模型是这样的：

```
class Url(models.Model):
      #some vars here
      count=0

      def __unicode__(self):
            return self.urlx
      def incr(self):
            self.count+=1 
```

我的视图代码是这样的

```
@transaction.autocommit
def redirect(request,key):
    if(key):
        key='/'+key
        try:
            ob=Url.objects.get(urlx=key)
            ob.incr()  #not working
            ob.save()  #not working
            return HttpResponseRedirect(ob.url)
            val=ob.count
        except Url.DoesNotExist:
            key="Sorry! couldn't find that url"         

    return render_to_response('redir.html',{},context_instance=RequestContext(request)) 
```

我确定我在这里忽略了一些东西，或者这不是正确的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T10:12:04.547

由于您错过了“此处的其他变量”，因此尚不清楚您是否意识到 Django 模型字段需要是字段 - 即`models.CharField`,`models.IntegerField`等。放置`count=0`只会生成一个不会被持久化的类变量在数据库中。你可能只是想要`count = models.IntegerField(default=0)`.

# android - android声音到扬声器

> ID：12234890
> 
> 赞同：3
> 
> 时间：2012-09-02T09:39:46.123
> 
> 标签：android, audio, volume, speaker

在我的虚拟 android 应用程序上，我尝试复制音频播放器的功能。我必须处理的文件是一些不太长的 ogg 文件：2-3 秒。

问题是文件的体积太小。我想增加音量，但我不知道如何。在我的应用程序中，声音的播放音量与通话音量相同。当我使用扬声器模式时，我想将音量增大到来自语音通话的音量。

```
 AssetFileDescriptor afd;

    try {
        afd = getAssets().openFd(strPlayFileName);
        mPlayer.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());

        mPlayer.prepare();
        afd.close();
        mPlayer.start();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

那是播放我的 ogg 文件的代码。欢迎任何反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T09:12:09.773

```
private AudioManager audio;

audio = (AudioManager) getSystemService(Context.AUDIO_SERVICE); 

@Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        switch (keyCode) {
        case KeyEvent.KEYCODE_VOLUME_UP:
            audio.adjustStreamVolume(AudioManager.STREAM_MUSIC,
                    AudioManager.ADJUST_RAISE, AudioManager.FLAG_SHOW_UI);
            return true;
        case KeyEvent.KEYCODE_VOLUME_DOWN:
            audio.adjustStreamVolume(AudioManager.STREAM_MUSIC,
                    AudioManager.ADJUST_LOWER, AudioManager.FLAG_SHOW_UI);
            return true;
        default:
            return false;

     }
} 
```

尝试这个..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T13:02:10.940

MediaPleyer 允许音量操作。您可以尝试该`setVolume()`方法以查看它是否提供了所需的结果。您可以在[此处](http://developer.android.com/reference/android/media/MediaPlayer.html#setVolume%28float,%20float%29)获取有关此方法的更多信息。

如果这不能给您想要的结果，我建议您使用一些免费的音频编辑器（例如 audacity）来放大源的声音输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T06:32:43.703

It's not a good idea to use media player for very short audios. Rather you will get another option to do so. Use `SoundPool` to play such files.

1.  Reasons why I'm suggesting is Almost all game uses this to play there effects. And we know how simple it is.

2.  You can use FX to play around your media.

Here is a great example. [Just use it](http://www.techrepublic.com/blog/app-builder/getting-your-feet-wet-in-androids-soundpool/877).

I'm sure you will get a great result.

If you still want to use `MediaPlayer` try playing media from `RAW` folder. It wont compress the files. **I did not tested it**.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T12:18:42.070

如果我正确理解您的问题，您想增加媒体的增益，即以超过 100% 的音量播放它们。一种方法是使用 JB 中的新功能。我自己没有玩过这个，但它肯定可以从解码器中获取一个缓冲区，并将缓冲区中的值乘以你的增益，然后将其传递给播放。[您可以在此处](http://developer.android.com/about/versions/android-4.1.html#Multimedia)找到更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T10:27:54.540

@多尔

> 当我使用扬声器模式时，我想将音量增大到来自语音通话的音量。

您想获得完整的音量，这是解决方案

```
AudioManager audioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
                audioManager.setStreamVolume(AudioManager.STREAM_MUSIC, audioManager.getStreamMaxVolume(audioManager.STREAM_MUSIC), 0); 
```

这会将音量设置为最大音量。

[您可以在此处](http://www.vogella.com/articles/AndroidMedia/article.html)参考以下链接了解音频管理器的工作原理。

# c# - 为什么这种方法工作得这么慢？

> ID：12234893
> 
> 赞同：0
> 
> 时间：2012-09-02T09:40:38.847
> 
> 标签：c#, .net, winforms, graphics, gdi+

我编写了一个 Windows 窗体 C# 应用程序，用于绘制诸如线条之类的矢量基元。椭圆等。我有一种方法可以更改所选图形的边框宽度。这是方法：

```
 public void SetBorderWidth(int border)
    {
        if (border < 0) 
            return;

        if ((SelectedItem != null) && (SelectedItem.isGroup == false)) 
        {              
            SelectedItem.BorderWidth = border;
        }

        if ((SelectedItem != null) && (SelectedItem.isGroup == true))
        {

            ChangeCascadeBorderWidth(SelectedItem, border);
        }

        foreach (Shape figure in ObjectsDrawn)
        {
            if (figure.Selected)
            {
                ObjectsDrawn[ObjectsDrawn.IndexOf(figure)].BorderWidth = border;
            }

            if (figure.isGroup)
            {
                ChangeCascadeBorderWidth(figure, border);
            }
        }            
    } 
```

谁调用该方法：

```
 private void ChangeCascadeBorderWidth(Shape group, int width)
    {
        foreach (Shape item in ((Grouping)group).GroupedElements)
        {
            if (item.isGroup == true)
            {
                ChangeCascadeBorderWidth(item, width);
            }
            else
            {
                item.BorderWidth = width;
            }
        }
    } 
```

如果该图是几个图的组。但这工作太慢了。无论我选择一个或一组数字，有时我都需要等待 10-15 秒。用于更改边框宽度。为什么这么慢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:48:46.317

我的想法：

一个像素的宽度会导致更快的性能，因为可以使用基于线的图元来渲染边界。

当您使用大于 1 的宽度时，它必须使用实体填充图元，这会很慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T10:04:54.827

您的代码正在编辑 SelectedItem 的边框、任何将 Selected 属性设置为 true 的 ObjectDrawn 以及所有绘制的属于某个组的对象的边框。

您的意思是还根据是否选择了组形状来过滤您的组边框图吗？
`figure.isGroup && figure.Selected` 否则，它似乎会修改所有组的边界，如果有很多组，无论您选择什么，都可能导致性能问题。

其他性能改进建议：
您在 SetBorderWidth 中执行此操作：
`ObjectsDrawn[ObjectsDrawn.IndexOf(figure)].BorderWidth = border;` 但您在 ChangeCascadeBorderWidth 中执行此操作： `item.BorderWidth = width;` 我建议在 SetBorderWidth 函数中执行相同操作，因为您已经拥有要修改的对象的实例，IndexOf 查找似乎不是必要的。

此外，如果设置 BorderWidth 属性的成本很高（即使设置为相同的现有值），那么像这样包装对 SetBorderWidth 的调用： `if(item.BorderWidth != width) item.BorderWidth = width;`可以节省性能。但是您必须根据设置边框宽度的成本来评估比较的成本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T15:37:59.153

您发布的所有瓶颈似乎都来自在形状上设置 BorderWidth 属性。我猜你会重新绘制或更新 BorderWidth 中形状的布局。如果您在容器上设置 BorderWidth，则会有很多不必要的重绘和布局更改，这在 WinForms 中有点慢（特别是对于布局，如果您的形状继承自 Control）。

我可以建议像其他一些 WinForms 控件一样的*BeginUpdate *EndUpdate* 机制吗​​？*

# php - php - ob_start / fputs 突然不再工作了，有什么可以阻止它的吗？

> ID：12234896
> 
> 赞同：-2
> 
> 时间：2012-09-02T09:40:59.007
> 
> 标签：php, ob-start, fputs, ob-get-contents

我的代码：

```
function log_this($to_log, $prepend = null){

    ob_start();
    $fn = '../info.log';        
    $fp = fopen($fn, 'a');

    fputs($fp, "\r\rnew log -------- \r\r");

    if(isset($prepend)) fputs($fp, $prepend . ":\r\r");

    var_dump($to_log);
    $content = ob_get_contents();

    fputs($fp, $content);
    fclose($fp);
    ob_end_clean();
} 
```

这是我在本地环境 (MAMP) 中经常使用的功能，用于从 wordpress 中记录内容。它总是有效的。现在它不再起作用了。我试图理解为什么几天但找不到任何解决方案。我不是一个真正高级的 php 程序员，所以也许有一些我不知道和应该的东西.. 任何人都可以帮助我吗？

顺便说一句，function_exists 和 file_exists，我称之为它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:50:16.413

我不确定为什么`fputs`不起作用，这可能与您的服务器文件夹权限有关（通常`0755`或`0775`安全），也可以添加一个条件来检查`is_writable`以消除这种可能性。您是否尝试过使用`file_get_contents`和`file_put_contents`。

```
define('FILE_PATH', 'path/to/file/file.log'); 
    function log_this($command, $array = null) {
    //check if we can get to the file
    if(file_exists(FILE_PATH)){
    $current = file_get_contents(FILE_PATH);
    $current .= $command;
    if(!is_null($array)){
    ob_start();print_r($array);$output = ob_get_clean();
    $current .= $output;
    }
    file_put_contents(FILE_PATH, $current);
    }
 } 
```

# c - 我需要打印行号以及行内容，但我得到了行号和 2 行不同的内容

> ID：12234897
> 
> 赞同：0
> 
> 时间：2012-09-02T09:41:37.253
> 
> 标签：c, file-handling

```
main() 
{
     FILE *fp;
     char c;
     int count=1;
     fp=fopen("D:\file.txt","r");
     printf("%d ",count);
     c = fgetc(fp);
     while(c!=EOF) 
     {
         if(c=='\n')
         {
              count++;
              printf("\n%d",count);
         }
         putchar(c);
         c=fgetc(fp);
     }
     fclose(fp);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:51:43.210

您还打印了刚刚从文件中读取的换行符，

改变

```
if(c=='\n') {
 count++;
 printf("\n%d ",count);
}
putchar(c); 
```

至

```
if(c=='\n') {
 count++;
 printf("\n%d",count);
} else {
  putchar(c);
} 
```

或者，在打印行号时不要打印换行符，

```
putchar(c);
if(c=='\n') {
  count++;
  printf("%d ",count);
} 
```

你也必须改变

```
char c; 
```

至

```
int c; 
```

getchar() 返回一个 int，EOF 是一个不能用 char 表示的值。

# sync - 从 iPod 获取歌曲标题

> ID：12234898
> 
> 赞同：0
> 
> 时间：2012-09-02T09:42:03.530
> 
> 标签：sync, ipod

我正在尝试创建一个 PC (Windows) 程序来同步来自 iPod 与远程服务器的歌曲列表（只是标题，而不是音乐文件本身）。我想知道这是否可能。如何访问 iPod 音乐列表？或者有没有办法使用 iTunes 做到这一点？也许有一个 iTunes 存储 iPod 音乐列表的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:54:33.827

如果您设法为其找到反向工程头文件，则可以在 Windows 上本地使用[MobileDevice 库。](http://theiphonewiki.com/wiki/index.php?title=MobileDevice_Library)您也可以尝试使用 MinGW 或类似工具将[libimobiledevice从 Linux 移植到 Windows。](http://www.libimobiledevice.org/)

# java - 关于 Java 中的绿色线程

> ID：12234903
> 
> 赞同：1
> 
> 时间：2012-09-02T09:42:49.473
> 
> 标签：java, multithreading

> **可能重复：**
> [绿色线程与非绿色线程](https://stackoverflow.com/questions/5713142/green-threads-vs-non-green-threads)

据我所知，java支持多少种线程，有两种类型的线程用户线程和守护线程，但我正在阅读一篇文章，其中指出......

> 适当的线程：这些是围绕底层操作系统的线程设施的抽象。因此，线程创建与系统一样昂贵——总是有开销。

另一个是

> “绿色”线程：由 JVM 创建和调度，这些线程更便宜，但不会发生适当的并行性。这些行为类似于线程，但在操作系统的 JVM 线程中执行。据我所知，它们并不经常使用。

请告知什么是绿色线程，它们与守护线程相同吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:59:40.707

> 两种类型的线程用户线程和守护线程

守护线程是常规线程（它们甚至创建相同），除了应用程序不需要等待它们完成后退出。我什至质疑文档中的措辞，因为对我来说，守护线程*是*用户线程（即`Thread`实例）。

绿色线程已完全过时，与守护线程无关。

# c# - SignalR：不在集线器中调用方法以实时返回 JSON

> ID：12234904
> 
> 赞同：0
> 
> 时间：2012-09-02T09:42:56.223
> 
> 标签：c#, asp.net-mvc, json, asp.net-web-api, signalr

在使用 SignalR 运行性能监视过程时，我即将实时返回 JSON（尽管它不起作用）。目前，一旦该过程完成，我可以获得完整的 JSON 返回，但我想实现它，以便在应用程序从程序计数器获取值时每秒返回 JSON。问题是，我的 Invoke 调用根本没有做任何事情，即使我在从性能监控中检索到的每个值期间明确地返回要发送到浏览器的数据。

我正在使用 ASP.NET MVC 4 Web API 来开发 API，并通过浏览器中的 URL 调用 API 并返回 JSON。我正在尝试使用 SignalR 让应用程序将 JSON 发送到浏览器，但它根本没有做任何事情。相反，一旦过程完成，应用程序只需从控制器操作返回完整的 JSON 以及所有性能数据值。换句话说，SignalR 不工作。

所以，我需要一些帮助来弄清楚为什么 SignalR 没有向浏览器发送任何数据，这样我才能获得实时提​​要并结束这个项目。

请注意：由于我将 JSON 直接发送到浏览器，因此调用这样做是在模型类而不是视图中完成的，因为当您通过 URL 调用返回 JSON 时，您无法使用视图到 Web API。请记住，我不是在使用视图，而只是使用浏览器和对 API 的 URL 调用。

任何指向正确方向的帮助将不胜感激，谢谢。如果我问的是一个愚蠢的问题，我很抱歉，但我一直在努力解决这个问题，根本找不到解决方案。

这是我的中心课程。它位于 ~/signalr 并位于名为 LiveHub.cs 的文件中。Send 方法是我试图在下一个代码块中看到的方法中调用的方法。

```
namespace PerfMon2.signalr
{
    public class LiveHub : Hub
    {

        public List<DataValueInfo> Send(List<DataValueInfo> data)
        {
            return data;
        }
    }
} 
```

这是 LogDBRepository.cs 中包含 SignalR 调用的方法。

```
public List<LogInfo> LogTimedPerfData(string macName, string categoryName, string counterName,
                                          string instanceName, string logName, string live, long? seconds)
    {
        iModsDBRepository modsDB = new iModsDBRepository();
        List<MachineInfo> theMac = modsDB.GetMachineByName(macName);

        if (theMac.Count == 0)
            return new List<LogInfo>();

        else if (instanceName == null)
        {
            if (!PerformanceCounterCategory.Exists(categoryName, macName) ||
                !PerformanceCounterCategory.CounterExists(counterName, categoryName, macName) )
            {
                return new List<LogInfo>();
            }
        }
        else if (instanceName != null)
        {
            if (!PerformanceCounterCategory.Exists(categoryName, macName) ||
                !PerformanceCounterCategory.CounterExists(counterName, categoryName, macName) ||
                !PerformanceCounterCategory.InstanceExists(instanceName, categoryName, macName))
            {
                return new List<LogInfo>();
            }
        }
        else if (logName == null)
        {
            return new List<LogInfo>();
        }

        // Check if entered log name is a duplicate for the authenticated user
        List<LogInfo> checkDuplicateLog = this.GetSingleLog(logName);
        if (checkDuplicateLog.Count > 0)
        {
            return new List<LogInfo>();
        }

        PerformanceCounterCategory category = new PerformanceCounterCategory(categoryName, theMac[0].MachineName);
        if (category.CategoryName == null || category.MachineName == null)
        {
            return new List<LogInfo>();
        }

        List<LogInfo> logIt = new List<LogInfo>();
        if (category.CategoryType != PerformanceCounterCategoryType.SingleInstance)
        {
            List<InstanceInfo> instances = modsDB.GetInstancesFromCatMacName(theMac[0].MachineName, category.CategoryName);

            foreach (InstanceInfo inst in instances)
            {
                if (!category.InstanceExists(inst.InstanceName))
                {
                    continue;
                }
                else if (inst.InstanceName.Equals(instanceName, StringComparison.OrdinalIgnoreCase))
                {
                    PerformanceCounter perfCounter = new PerformanceCounter(categoryName, counterName,
                                                                        inst.InstanceName, theMac[0].MachineName);

                    //CounterSample data = perfCounter.NextSample();
                    //double value = CounterSample.Calculate(data, perfCounter.NextSample());
                    string data = "";
                    List<UserInfo> currUser = this.GetUserByName(WindowsIdentity.GetCurrent().Name);

                    string timeStarted = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

                    List<string> dataValues = new List<string>();

                    var hubConnection = new HubConnection("http://localhost/PerfMon2");
                    hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;
                    var perfMon = hubConnection.CreateProxy("LiveHub");
                    // perfMon.On("sendValue", message => Console.WriteLine(message));
                    hubConnection.Start().Wait();

                    List<DataValueInfo> lol = new List<DataValueInfo>();
                    for (int i = 0; i < seconds; i++)
                    {
                        data = "Value " + i + ": " + perfCounter.NextValue().ToString();
                        //dataValues[i] = data;
                        dataValues.Add(data);
                        lol.Add(new DataValueInfo
                        {
                            Value = perfCounter.NextValue().ToString()
                        });
                        perfMon.Invoke<List<DataValueInfo>>("Send", lol);
                        Thread.Sleep(1000);
                    }
                    string timeFinished = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

                    Log log = new Log
                    {
                        LogName = logName,
                        CounterName = perfCounter.CounterName,
                        InstanceName = perfCounter.InstanceName,
                        CategoryName = perfCounter.CategoryName,
                        MachineName = perfCounter.MachineName,
                        TimeStarted = timeStarted,
                        TimeFinished = timeFinished,
                        PerformanceData = string.Join(",", dataValues),
                        UserID = currUser[0].UserID
                    };
                    this.CreateLog(log);
                    logIt.Add(new LogInfo
                    {
                        LogName = logName,
                        CounterName = perfCounter.CounterName,
                        InstanceName = perfCounter.InstanceName,
                        CategoryName = perfCounter.CategoryName,
                        MachineName = perfCounter.MachineName,
                        TimeStarted = timeStarted,
                        TimeFinished = timeFinished,
                        PerformanceData = dataValues.ToList<string>()
                    });
                    break;
                }
            }
        }
        else
        {
            PerformanceCounter perfCounter = new PerformanceCounter(categoryName, counterName,
                                                                        "", theMac[0].MachineName);

            string data = "";
            List<UserInfo> currUser = this.GetUserByName(WindowsIdentity.GetCurrent().Name);

            string timeStarted = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

            //string[] dataValues = new string[(int)seconds];
            List<string> dataValues = new List<string>();

            var hubConnection = new HubConnection("http://localhost/PerfMon2");
            hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;
            var perfMon = hubConnection.CreateProxy("LiveHub");
            // perfMon.On("sendValue", message => Console.WriteLine(message));
            hubConnection.Start().Wait();

            List<DataValueInfo> lol = new List<DataValueInfo>();
            for (int i = 0; i < seconds; i++)
            {
                data = "Value " + i + ": " + perfCounter.NextValue().ToString();
                //dataValues[i] = data;
                dataValues.Add(data);
                lol.Add(new DataValueInfo
                {
                    Value = perfCounter.NextValue().ToString()
                });
                perfMon.Invoke<List<DataValueInfo>>("Send", lol);
                Thread.Sleep(1000);
            }
            string timeFinished = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

            Log log = new Log
            {
                LogName = logName,
                CounterName = perfCounter.CounterName,
                InstanceName = perfCounter.InstanceName,
                CategoryName = perfCounter.CategoryName,
                MachineName = perfCounter.MachineName,
                TimeStarted = timeStarted,
                TimeFinished = timeFinished,
                PerformanceData = string.Join(",", dataValues),
                UserID = currUser[0].UserID
            };              
            this.CreateLog(log);
            logIt.Add(new LogInfo
            {
                LogName = logName,
                CounterName = perfCounter.CounterName,
                InstanceName = perfCounter.InstanceName,
                CategoryName = perfCounter.CategoryName,
                MachineName = perfCounter.MachineName,
                TimeStarted = timeStarted,
                TimeFinished = timeFinished,
                PerformanceData = dataValues.ToList<string>()
            });
        }
        return logIt;
    } 
```

这是 LogController.cs 中方法的控制器：

```
 [AcceptVerbs("GET", "POST")]
    public List<LogInfo> Log_Perf_Data(string machine_name, string category_name, string counter_name, string instance_name,
                                   string log_name, long? seconds, string live, string enforceQuery)
    {
        LogController.CheckUser();

        // POST api/log/post_data?machine_name=&category_name=&counter_name=&instance_name=&log_name=&seconds=
        if (machine_name != null && category_name != null && counter_name != null && log_name != null && seconds.HasValue && enforceQuery == null)
        {
            List<LogInfo> dataVal = logDB.LogTimedPerfData(machine_name, category_name, counter_name, instance_name,
                                   log_name, live, seconds);
            logDB.SaveChanges();
            return dataVal;

        }

        return new List<LogInfo>();
    } 
```

# **更新：**

所以，我更新了 hub 方法，现在它是

```
public void SendToClient(List<DataValueInfo> json)
{
    Clients.showValue(json);
} 
```

在我的存储库方法中，我对其进行了更新，使其具有

```
var hubConnection = new HubConnection("http://localhost/PerfMon2");
hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;
var perfMon = hubConnection.CreateProxy("LiveHub");                    //            
perfMon.On("showValue", json => Console.WriteLine(json));
hubConnection.Start().Wait();

List<DataValueInfo> lol = new List<DataValueInfo>();
for (int i = 0; i < seconds; i++)
{
    data = "Value " + i + ": " + perfCounter.NextValue().ToString();
    dataValues.Add(data);
    lol.Add(new DataValueInfo
    {
        Value = perfCounter.NextValue().ToString()
    });
    perfMon.Invoke<List<DataValueInfo>>("SendToClient", lol);
    Thread.Sleep(1000);
} 
```

仍然没有运气。是因为我使用的是不能在浏览器上使用的 Console.WriteLine 吗？如果不是这样，我能用什么？如前所述，Javascript 是不可能的，因为我没有使用视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T13:03:49.267

我认为您误解了一些 SignalR 基础知识，因为我`Clients`在您的集线器中没有看到任何呼叫，这意味着您没有广播任何内容。

您集线器上的公共方法（即您的 Send() 方法）现在非常无用，因为它只是返回您传递给它的数据。如果要从服务器广播到连接的客户端，则需要使用`Clients`hub 方法中的动态属性并在其上调用方法。

通读这些文档应该可以让您更好地了解它应该如何工作：[https ://github.com/SignalR/SignalR/wiki/Hubs](https://github.com/SignalR/SignalR/wiki/Hubs)

# php - 在文件开头包含函数列表的好习惯

> ID：12234906
> 
> 赞同：0
> 
> 时间：2012-09-02T09:43:14.527
> 
> 标签：php, comments

在 PHP 文件的开头包含函数列表（在注释部分中）是一种好习惯吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T09:46:03.993

不。一个好的做法是使用 - [PHPDoc](http://phpmaster.com/introduction-to-phpdoc/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T09:50:57.500

是的，它有助于了解该文件正在使用哪些功能。

您还应该在实际函数代码之前注释掉哪些参数和返回类型。

阅读[此处](http://manual.phpdoc.org/HTMLSmartyConverter/HandS/phpDocumentor/tutorial_phpDocumentor.quickstart.pkg.html)了解有关 documentor (PHPDOC) 的 php 评论标准的最佳实践。

Jeff atwood 的[无评论编码](http://www.codinghorror.com/blog/2008/07/coding-without-comments.html)和[When Good Comments Go Bad](http://www.codinghorror.com/blog/2004/11/when-good-comments-go-bad.html)帖子有助于评论策略。

# c# - 在 C# Web 应用程序中使用 MAPI 在 ASP.NET 中使用默认 Web 客户端发送邮件

> ID：12234916
> 
> 赞同：0
> 
> 时间：2012-09-02T09:44:54.577
> 
> 标签：c#, asp.net, client, mapi, webmail

我正在使用 MAPI 在我的 C# Web 应用程序中打开默认的 Web 邮件客户端。现在它首先作为对话框打开，然后是 Outlook 窗口。我想使用 MAPI 打开直接默认邮件客户端窗口。

但是当我在 IIS 上部署时，MAPI 不会调用邮件对话框。

有没有使用带有附件的 MAPI 调用 Web 邮件客户端的简单方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:00:09.097

你想在服务器端的客户端上这样做吗？我怀疑在没有人会关闭这些窗口的服务 (IIS) 中运行时，您是否希望在服务器上显示任何窗口。如果你想在客户端运行，mailto: url 几乎是你唯一的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T11:15:25.280

不要使用 MAPI。使用 System.Net.Mail：[http ://www.systemnetmail.com/faq/3.4.1.aspx](http://www.systemnetmail.com/faq/3.4.1.aspx)

```
static void AttachmentFromFile()
{
    //create the mail message
    MailMessage mail = new MailMessage();

    //set the addresses
    mail.From = new MailAddress("me@mycompany.com");
    mail.To.Add("you@yourcompany.com");

    //set the content
    mail.Subject = "This is an email";
    mail.Body = "this content is in the body";

    //add an attachment from the filesystem
    mail.Attachments.Add(new Attachment("c:\\temp\\example.txt"));

    //to add additional attachments, simply call .Add(...) again
    mail.Attachments.Add(new Attachment("c:\\temp\\example2.txt"));
    mail.Attachments.Add(new Attachment("c:\\temp\\example3.txt"));

    //send the message
    SmtpClient smtp = new SmtpClient("127.0.0.1");
    smtp.Send(mail);

} 
```

# python - 使用 PyQt 和 matplotlib 在可滚动的小部件中显示多个绘图

> ID：12234917
> 
> 赞同：2
> 
> 时间：2012-09-02T09:45:12.660
> 
> 标签：python, qt, matplotlib, pyqt, qscrollarea

由于我没有得到[这个](https://stackoverflow.com/questions/12179893/creating-a-scrollable-multiplot-with-pythons-pylab)问题的答案，我尝试用 PyQt 解决它。显然，当涉及到 QScrollArea 时，这并不容易......

我写了一个小测试，基本上可以满足我的要求，但它没有像我预期的那样显示滚动区域和其中的图：

```
from PyQt4 import QtCore, QtGui
import os,sys

#import matplotlib
from matplotlib.backends.backend_qt4agg import FigureCanvasQTAgg as FigureCanvas
from matplotlib.backends.backend_qt4agg import NavigationToolbar2QTAgg as NavigationToolbar
from matplotlib.figure import Figure

qapp = QtGui.QApplication(sys.argv)
qwidget = QtGui.QWidget()
qwidget.setGeometry(QtCore.QRect(0, 0, 500, 500))
qlayout = QtGui.QHBoxLayout(qwidget)
qwidget.setLayout(qlayout)

qscroll = QtGui.QScrollArea(qwidget)
qscroll.setGeometry(QtCore.QRect(0, 0, 500, 500))
qscroll.setFrameStyle(QtGui.QFrame.NoFrame)
qlayout.addWidget(qscroll)

qscrollContents = QtGui.QWidget()
qscrollLayout = QtGui.QVBoxLayout(qscrollContents)
qscrollLayout.setGeometry(QtCore.QRect(0, 0, 1000, 1000))

qscroll.setWidget(qscrollContents)
qscroll.setWidgetResizable(True)

for i in xrange(5):
  qfigWidget = QtGui.QWidget(qscrollContents)
  fig = Figure((5.0, 4.0), dpi=100)
  canvas = FigureCanvas(fig)
  canvas.setParent(qfigWidget)
  toolbar = NavigationToolbar(canvas, qfigWidget)
  axes = fig.add_subplot(111)
  axes.plot([1,2,3,4])
  qscrollLayout.addWidget(qfigWidget)

qscrollContents.setLayout(qscrollLayout)

qwidget.show()
exit(qapp.exec_()) 
```

谁能解释为什么它不起作用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T20:52:24.887

您正在为每个地块创建一个`QWidget`。但是您不会通过布局将`canvas`or`toolbar`放入其中，因此它们无法与`QWidget`. 默认情况下， a`QWidget`没有`minimumSize`，并且内部的小部件/布局`QScrollArea`可以使它们尽可能小，以适应可用空间（即 的大小`QScrollArea`）。

通过布局添加绘图会有所帮助，但我发现`FigureCanvas`小部件也没有任何最小尺寸，因此它可以缩小。为了快速修复，您可以设置一个`minimumSize`. 带有这些修复的循环部分应如下所示：

```
for i in xrange(5):
  qfigWidget = QtGui.QWidget(qscrollContents)

  fig = Figure((5.0, 4.0), dpi=100)
  canvas = FigureCanvas(fig)
  canvas.setParent(qfigWidget)
  toolbar = NavigationToolbar(canvas, qfigWidget)
  axes = fig.add_subplot(111)
  axes.plot([1,2,3,4])

  # place plot components in a layout
  plotLayout = QtGui.QVBoxLayout()
  plotLayout.addWidget(canvas)
  plotLayout.addWidget(toolbar)
  qfigWidget.setLayout(plotLayout)

  # prevent the canvas to shrink beyond a point
  # original size looks like a good minimum size
  canvas.setMinimumSize(canvas.size())

  qscrollLayout.addWidget(qfigWidget) 
```

# android - 使用广播接收器与侦听器与当前显示的片段进行通信

> ID：12234919
> 
> 赞同：1
> 
> 时间：2012-09-02T09:45:29.560
> 
> 标签：android, android-fragments, android-actionbar

我有一个`Activity`显示不同的内容，当用户从中选择一个时`Fragments`，这些发生了变化，我在. 如果我想告诉当前显示的片段使用 ActionBar 上的刷新菜单按钮刷新它的内容。我应该实现一个与片段通信的侦听器吗？或者我应该使用 a来通知 Fragment 刷新。哪个更好 ？？我没有实施任何这些。 `fragments``item``spinner``ActionBar``button``ActionBar``BroadCastReciever`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:49:45.377

如果您需要与更广泛的受众“交谈”，您应该只使用广播。在您的情况下，您需要一个片段和一个按钮，我建议实现侦听器。可以是activity监听action bar按钮动作然后告诉fragment刷新，也可以直接绑定这两者

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:53:02.297

这真的不是一个简单的问题。从一方面来看，对于这样一个简单的任务，广播可能会是一种过度杀伤，所以我建议使用监听器。但..

但是，请确保您了解 Fragments 的工作原理。如果您打算从代码创建它们并立即设置侦听器 - 这可以第一次工作。但是当系统重新实例化片段时，您可能会遇到活动重新创建的问题。在这种情况下，它可以只使用 Fragment 的公共空构造函数，并且您的代码可能会因未设置侦听器而出错。

所以我认为好主意是从 Fragment 本身设置侦听器，例如在`onAttach()`or中`onStart`。在那里，您可以进行活动`getActivity()`并设置侦听器。这种方法的缺点是您必须将 Activity 转换为特定的类才能访问侦听器方法，这限制了其他 Activity 中的片段重用，因此请注意这一事实。

希望能帮助到你

# android - 在 TablerRow 中组合多个 TextView

> ID：12234920
> 
> 赞同：0
> 
> 时间：2012-09-02T09:45:46.693
> 
> 标签：android, textview, tablelayout

我想在代码中创建一个表格布局。每第 n 行应该是一个只有一个文本视图的标题。其他行应包含 3 个文本视图。当然，所有第一个、第二个和第三个视图应该是相同的宽度。

我现在的问题是第一列的宽度是由最广泛的 texview 设置的，它是标题，但对于其他行的第一个视图来说，这是很大的。所以我想组合标题所在行的单元格，这样它就可以跨越整行。其他单元格应该是最宽文本的大小。

这就是它的样子

```
______________________________
|Long Title__________________|
|x___|YYYY_____|ZZZ__________|
|XXX_|YYYYYYYYY|ZZZZ_________|
|xxxx|YYYYY____|ZZZ__________|
|xxx_|YY_______|Z____________|
|Long Title__________________|
|x___|YYYY_____|ZZZ__________|
|XXX_|YYYYYYYYY|ZZZZ_________|
|xxxx|YYYYY____|ZZZ__________|
|xxx_|YY_______|Z____________| 
```

这就是它的外观

```
______________________________
|Long Title__________________|
|x_________|YYYY_____|ZZZ____|
|XXX_______|YYYYYYYYY|ZZZZ___|
|xxxx______|YYYYY____|ZZZ____|
|xxx_______|YY_______|Z______|
|Long Title__________________|
|x_________|YYYY_____|ZZZ____|
|XXX_______|YYYYYYYYY|ZZZZ___|
|xxxx______|YYYYY____|ZZZ____|
|xxx_______|YY_______|Z______| 
```

如果有人可以帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T11:16:58.567

以下代码可以提供帮助。只需添加另一个线性布局块即可拥有 3 行。

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="wrap_content" >

<TextView
    android:id = "@+id/Textviewtitle"
    android:layout_width="fill_parent"
    android:layout_alignParentLeft="true"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="fill_parent"
     android:layout_height="90dp"
     android:layout_alignLeft="@+id/Textviewtitle"
     android:layout_below="@+id/Textviewtitle"
     android:orientation="horizontal">

 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="fill_parent"
     android:layout_weight="1"
     android:layout_height="wrap_content"
     android:orientation="vertical">

 <TextView
    android:id = "@+id/Textview1"
    android:layout_width="wrap_content"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />
 <TextView
    android:id = "@+id/Textview2"
    android:layout_width="wrap_content"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />
 <TextView
    android:id = "@+id/Textview3"
    android:layout_width="wrap_content"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />

 </LinearLayout>

 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_weight="1"
android:layout_height="wrap_content"
android:orientation="vertical">

 <TextView
    android:id = "@+id/Textview4"
    android:layout_width="wrap_content"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />
 <TextView
    android:id = "@+id/Textview5"
    android:layout_width="wrap_content"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />
 <TextView
    android:id = "@+id/Textview6"
    android:layout_width="wrap_content"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".TestActivity" />
 </LinearLayout>

</LinearLayout>

 </RelativeLayout> 
```

使用以下链接获取有关对齐的更多参考。一旦添加了权重为 1 的第三个线性布局块，它将完美对齐。

[http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html)

[http://developer.android.com/reference/android/widget/LinearLayout.LayoutParams.html](http://developer.android.com/reference/android/widget/LinearLayout.LayoutParams.html)

重复同样的操作，您可以获得另外 3 个块行。

请看编辑。你可以使用这样的东西

# php - php: 写一个 .ics (iCal) 文件？日期格式？

> ID：12234925
> 
> 赞同：2
> 
> 时间：2012-09-02T09:46:25.540
> 
> 标签：php, date, calendar, icalendar

我不是 php 专家，在格式化 .ics 文件的日期时遇到了麻烦。

所以我有一个循环，为每个生成一个日历条目`$post`（在我的例子中 $post 是一个事件）

```
foreach( $posts as $post ) : setup_postdata($post);
        $ical .= "BEGIN:VEVENT
        UID:" . md5(uniqid(mt_rand(), true)) . "mysite.com
        DTSTAMP:" . gmdate('Ymd').'T'. gmdate('His') . "Z
        DTSTART:".get_event_date($post)."00Z
        DTEND:".get_event_end_date($post)."00Z
        SUMMARY:".get_the_title($post->ID)."
        DESCRIPTION:".get_the_excerpt($post->ID)."
        END:VEVENT";
    endforeach; 
```

我只是格式化日期的问题，这就是我完全摆脱它的原因，希望你们能帮助我。

我有两个函数`get_event_date($post)`，`get_event_end_date($post)`它们返回一个时间戳，如`1258665163`. 如何将此时间戳转换为 iCal .ics 文件的正确格式？

此外，我还想添加`time`每个事件的。这两个函数被调用`get_event_time($post)`，`get_event_end_time($post)`并且都以以下格式返回时间：`11:00`或`14:00`

有人可以帮我吗？我真的很感激一些帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:52:29.713

基本上，您希望将 unix 时间戳转换为为 iCal 指定的格式。

[php 手册中有一条关于](http://php.net/manual/de/function.date.php)包含这个小宝石的日期函数的精彩小评论，正是这样做的：

```
// Converts a unix timestamp to iCal format (UTC) - if no timezone is
// specified then it presumes the uStamp is already in UTC format.
// tzone must be in decimal such as 1hr 45mins would be 1.75, behind
// times should be represented as negative decimals 10hours behind
// would be -10

function unixToiCal($uStamp = 0, $tzone = 0.0) {

    $uStampUTC = $uStamp + ($tzone * 3600);       
    $stamp  = date("Ymd\THis\Z", $uStampUTC);

    return $stamp;       

} 
```

也许这有帮助。

# c# - 使用类似 JSON 的参数从 .NET 调用 PHP Web 服务

> ID：12234926
> 
> 赞同：1
> 
> 时间：2012-09-02T09:46:38.877
> 
> 标签：c#, php, web-services, proxy

我正在尝试使用 .NET 的 php webservice。在 PHP 中，调用将是这样的：

```
// array with guest information
$extrainfo = array(
            'voorletters'               => 'T.e.s.t.',
            'voornaam'                  => '',
            'tussenvoegsels'            => '',
            'achternaam'                => 'Baker',
            'rekeningnummer'            => '123456789',
            'website'                   => 'www.bla.nl',
            'geboortedatum'             => '19-2-1985',
            'telefoon_extra_restnummer' => '',
            'straat'                    => '',
            'huisnummer'                => '',
            'huisnummer_toevoeging'     => '',
            'postcode'                  => '',
            'woonplaats'                => '',
);
// add guest
$result = $client_cart->setGuest('MySessionID', 'test@test.nl',$extrainfo); 
```

如果我使用 wsdl 在 Microsoft .NET 中生成代理，则“setGuest”操作按预期采用三个参数。一个字符串（sessionID）、一个字符串（邮件地址）和一个“对象”类型的参数（额外信息）。

我试图创建一个自定义类来传递来自.NET 的额外信息，创建一个实例，填充它并将它作为序列化对象传递，但是 PHP web 服务抱怨它需要一个数组而不是一个对象。我还尝试将客人信息作为字典传递：

```
 Dictionary<string, string> dict = new Dictionary<string, string>();
  dict.Add("voorletters", "T.e.s.t.");
  dict.Add("voornaam", "");
  dict.Add("tussenvoegsels", "");
  dict.Add("achternaam", "Baker");
  ...

  object obj = _proxyService.setGuest("MySessionID", "test@test.nl", dict.ToArray()); 
```

但随后 PHP Web 服务抱怨没有收到额外的信息。

所以我的问题是；**如何使用 .NET 中生成的代理将访客信息作为参数传递？**

# javascript - 为什么 toStaticHTML 删除 data-* 属性

> ID：12234931
> 
> 赞同：3
> 
> 时间：2012-09-02T09:47:28.300
> 
> 标签：javascript, jquery, html, internet-explorer, winjs

我的应用程序将 HTML 内容动态构建为字符串，并在完成后将内容附加到 DOM。但是，在 WinJS 中，一旦我尝试将字符串附加到 DOM，就会引发异常。为了解决这些异常，我必须通过 toStaticHTML 运行它来清理 HTML，它在 WinJS 和 Internet Explorer 中全局定义。我遇到的问题是有很多使用 data-* html5 属性。一旦我通过 toStaticHTML 运行它们，它们就会被剥离。为什么 toStaticHTML 删除 data-* 属性？他们真正的安全问题是什么？

请注意，我无法将 DOM 插入包装在 MSApp.execUnsafeLocalFunction 中，因为我使用的是 jQuery，并且不允许修改 jQuery 代码。

```
var html = "<ul><li data-role='list-node'>My list node</li></ul>";
$('#container').html(toStaticHTML(html)); 
```

产生：

```
<ul>
    <li>My list node</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T16:41:41.553

这是因为将 HTML 的随机位插入文档的安全问题，并可能允许不安全的代码在受保护的上下文（您的应用程序，具有对 WinRT 和用户文档的完全访问权限）内执行。

`toStaticHtml`旨在在不断发展的 HTML/Web 模式的情况下保持“安全”，因此它是*白名单*而不是*黑名单*。

鉴于您在这里遇到的挑战，我看到以下选项：

*   包装对 jquery 的调用`msExecUnsafeLocalFunction`（见下文）。这意味着在该调用的整个生命周期中，所有 Dom 插入都可以。这不需要更改 jquery，只需要更改您的代码。
*   完全重写 Jquery 在幕后用来调用的任何 DOM 调用`msExecUnsafeLocalFunction`
*   将应用程序的安全上下文更改为 Web 上下文而不是本地上下文。这当然会让您无法直接访问 WinRT。您必须通过其他一些机制进行操作（I 帧或类似框架之间的消息传递）
*   用于`WinJS.Binding.Template`呈现您的内容而不是 Jquery。这会克隆节点而不是对 HTML 进行字符串化
*   编写自己的节点克隆器
*   `setAttribute`在插入安全节点后设置属性。

msExecUnsafeLocalFunction 的示例用法：

```
MSApp.execUnsafeLocalFunction(function() {
    $('#container').html(html);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T09:53:06.553

-`data-role`属性未在此处列出：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465388.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465388.aspx)

这是一个未知属性，将被删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T10:02:12.630

`data`不允许在文档中提及：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh465388.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465388.aspx)

# php - 如何在此函数中呈现查询？

> ID：12234932
> 
> 赞同：0
> 
> 时间：2012-09-02T09:47:36.877
> 
> 标签：php, mysql

我正在尝试将值呈现到带有删除链接的表中。现在我的问题是我需要将 mysql 行 id 传递给一个函数，该函数将从表中删除值并刷新。除了 delex 子查询之外，一切都很好，我未能在函数内获取 id，它只是将空值传递给函数我如何在函数内获取行 id

```
 deletex($RowID) 
```

我的查询在这里。有任何想法吗？，

```
$query="SELECT username as '{$mylanguage['username']}',
            vchCode as '{$mylanguage['voucher_code']}',
            vchStatus as '{$mylanguage['status']}',
            vchDateCreated as '{$mylanguage['date']}',
            vchDateUsed as '{$mylanguage['date_used']}',  
            CONCAT('<a href=\"#\" onclick=\"return deletx(\'',SELECT vchID,'\')\">".$mylanguage['delete']."</a>') as '&nbsp;' 
        FROM $tablename 
        LEFT JOIN #__users ON $uniqueKey = id
        ".$_SESSION['query_condition']." 
        ORDER BY vchID DESC 
        LIMIT ". ($pagination['start'] - 1) .",{$pagination['size']}"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:05:34.047

我不认为从 SQL 查询返回 HTML 是一个特别好的主意。您应该返回 ID，然后使用 PHP 将其插入 HTML。

添加`vchID`到选择。假设您将 SQL 结果作为一个名为 的关联数组`result`，代码如下所示。

```
<a href="#" onclick="return deletex(<?= $result|'vchID'] ?>)">
    <?= $mylanguage['delete'] ?>
</a> 
```

# sql - 关系建模中的加号是什么意思？

> ID：12234935
> 
> 赞同：0
> 
> 时间：2012-09-02T09:48:09.310
> 
> 标签：sql

当加号出现在表格中的键旁边时，加号是什么意思？

```
 ----------------------------
 TABLES
 ----------------------------
 Order        | OrderLine
 -------      | -----------
 orderid      |  orderid+
 orderdate    |  total price
              |
 ---------------------------- 
```

order 表和 orderline 表通过 orderid 键链接，但我不确定 orderline 表中 orderid 键旁边的加号是什么意思。

感谢您提前回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:53:33.560

查看表和属性名称，您可能会猜测这代表外键。

也就是说，`orderid`属性是表`OrderLine`的外键。`orderid``Order`

请注意，这是基于表和属性名称的上下文以及如何`Order`和`OrderLine`实体通常建模的知识的猜测。

# c++ - 在 C++ 或 C++11 中重新抛出类型化异常

> ID：12234936
> 
> 赞同：16
> 
> 时间：2012-09-02T09:48:21.280
> 
> 标签：c++, design-patterns, exception, c++11

我需要为函数编写一个包装器。它的目的是缓存函数的结果和可能的异常。它应该按如下方式工作：在第一次执行期间，它应该执行函数并存储函数返回的结果（或异常）。在下一次执行期间，它应该返回先前存储的结果或重新抛出捕获的异常。

问题是，我想存储异常的类型。所以基本上我想捕获每种类型的异常，并在将来重新抛出它而不会丢失它的类型。

我正在使用 C++ 或 C++11，因此非常感谢使用其中一种语言的任何解决方案。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-02T09:52:10.077

你正在寻找`std::exception_ptr`.

您可以使用 获取当前捕获的异常`std::current_exception()`，存储结果`std::exception_ptr`，稍后使用`std::rethrow_exception(std::exception_ptr)`

[cppreference wiki](http://en.cppreference.com/w/cpp/error/exception_ptr)上有一个很好的用法示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T07:47:26.377

来自 VC++ 的 exception_ptr 正在使用 RaiseException

# php - 从网络文章中提取内容并以一种很好的方式显示它们

> ID：12234937
> 
> 赞同：1
> 
> 时间：2012-09-02T09:48:24.713
> 
> 标签：php, url, rss, xml-parsing, web-crawler

我正在尝试制作一些东西，允许人们从例如边缘的文章中输入网址。它的作用是读取 url/article 并以一种很好的方式显示它，比如可读性。但我真的被困住了，我无法在任何地方找到有关如何做到这一点的信息。有没有关于如何做到这一点的api。它实际上不是只扫描整个 rss 提要一篇文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:54:10.513

应该是最简单的方法：[http ://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)

您可以简单地定位元素，例如使用 css/jquery

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:56:16.503

您可以使用正则表达式快速完成此操作，也可以导入 DOM。请注意，适用于一个网站的解决方案不太可能在没有更改的情况下适用于另一个网站，无论您使用正则表达式还是正确解析 DOM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T15:47:45.513

您正在寻找[锅炉管](http://code.google.com/p/boilerpipe/)。它应该完全符合您的要求。甚至还有一个 Web API。您还可以下载该模块并从 Python 脚本中使用它。

您可以在此处选择一篇文章对其进行测试：http: [//boilerpipe-web.appspot.com](http://boilerpipe-web.appspot.com/)。只需选择 ArticleExtractor 作为提取器。

# ffmpeg - ffmpeg时间单位解释及av_seek_frame方法

> ID：12234949
> 
> 赞同：6
> 
> 时间：2012-09-02T09:50:36.513
> 
> 标签：ffmpeg, video-processing

`time_base`在 ffmpeg中是什么意思？文档（[此处](http://dranger.com/ffmpeg/data.html#AVStream)）说它是“每秒帧数”。我在一个真实的例子中看到：

`AVFormatContext->streams[video_index]->time_base`== *1 / 30000*

但是视频的`AVCodecContext->time_base`== *1001 / 60000*

这让我很困惑，我不明白他们。

第二个问题是关于**av_seek_frame**方法。如果通过时间戳进行搜索（最后一个参数是 AVSEEK_FLAG_BACKWARD 或 0），则从**av_seek_frame**读取的当前位置开始搜索？还是从文件的开头？还是从最后一次**av_seek_frame**调用后的解码开始位置开始？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-03T10:13:09.720

> 但是视频的 AVCodecContext->time_base == 1001 / 60000
> 
> 这让我很困惑，我不明白他们。

time_base 是 AVRational 类型，它是一个由分子和分母组成的有理数，而不是使用小数点。我认为他们不只是使用 double 的原因是这样你就不会失去任何精度。

AVRational 在源代码中定义为：

```
typedef struct AVRational{
    int num; ///< numerator
    int den; ///< denominator
} AVRational; 
```

time_base 也是每秒帧数的倒数，不等于它。所以如果你有 30 fps，这意味着时基是 1/30，而不是 30。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-24T16:37:20.063

不要使用 r_frame_rate，因为它是 libavformats 的猜测，并不准确。（见[http://ffmpeg.org/pipermail/ffmpeg-devel/2005-May/003079.html](http://ffmpeg.org/pipermail/ffmpeg-devel/2005-May/003079.html)）

AVCodecContext.time_base 给出了准确的 fps。如果 ticks_per_frame 为 2，则将 time_base 缩小 1/2。例如，如果 AVCodecContext.time_base (1, 60) 和 ticks_per_frame 为 1，则 fps 为 60。如果 ticks_per_frame 为 2，则 fps 为 30。

如果 AVCodecContext->time_base 为 (1001, 60000)，则 fps 为 60。

AVCodecContext 的 time_base 与 fps 有关。

AVStream 的 time_base 仅用于 AVStream 中的方法中的时间单位，例如获取一帧的时间，或 .start 变量。

AVPacket 还有另一个 time_base。但是从 ffmpeg-devel 开始，他们更喜欢使 AVPacket.time_base 与 AVStream 相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T23:47:44.220

我用一些视频文件测试了来自 satuon 评论链接的所有字段，看起来好像可以计算出正确的帧率：

`double framerate = av_q2d(pFormatCtx->streams[videoStream]->r_frame_rate);`

...`pFormatCtx`您的 AVFormatContext 在哪里，并且`videoStream`是您的视频流的索引，使用以下代码找到：

```
int videoStream = -1;
for (uint i=0; i < pFormatCtx->nb_streams; i++) {
    if (pFormatCtx->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO && videoStream < 0) {
        videoStream = i;
    }
} 
```

使用 ffmpeg 1.1。

# internet-explorer - 相同的网站在相同的浏览器版本但在不同的计算机上看起来不同

> ID：12234951
> 
> 赞同：2
> 
> 时间：2012-09-02T09:50:58.060
> 
> 标签：internet-explorer, firefox, google-chrome, browser

嗨，我使用 HTML 和 CSS 创建了一个投资组合网站，我注意到一些非常奇怪的东西。我已经在所有最新的浏览器 Internet Explorer 9、Google Chrome、FireFox 上测试了该网站。当我在每个浏览器上看起来都不错时从我的个人计算机加载此链接：

[文件夹](http://madalinaciobotaru.comeze.com/portofolio.html)

现在，为了确保一切正常，我在 adobe browser labs 上测试了该站点，我发现那里存在问题。通常每行应该有 4 个图像，但在浏览器实验室中，似乎所有浏览器第 4 张图片被下推。

我在另一台也有最新的 Chrome 、 FIrefox 、 Internet Explorer 9 的计算机上检查了这一点。而且似乎 adobe 浏览器实验室是正确的，第四张图片被推下。

浏览器和计算机的分辨率相同，我在 Windows 7 Home Premium 上都使用？

什么会导致这个问题？为什么相同的网站在相同的浏览器版本但在不同的计算机上看起来不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T09:54:44.720

它可能会暂时存储您的旧 CSS，您是否尝试过 CTRL+F5 的仪式性应用

还要检查您是否处于 100% 缩放状态！

祝你好运！

- 编辑

快速萤火虫后，您的“portofoliu” div 的最大宽度为 940 像素，每个“portofolioGalery” div 的宽度为 220px，每个边距为 17px，您的第一张和第五张图片的边距已被删除。这意味着您的物品应该适合！

使用萤火虫在你的“portofolioGalery”项目之间轻弹，它显示它们之间有一个小的差距，正在发生的是“display：inline-block;” 正在增加少量的宽度！我将其替换为“浮动：左；” 这一切都准确地到达了它应该在的地方。

[这个家伙的博客](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)有一些其他的解决方案，并解释了原因。

# iphone - I delete a video in my app, but it still exists in the camera roll and vice versa

> ID：12234952
> 
> 赞同：0
> 
> 时间：2012-09-02T09:51:03.540
> 
> 标签：iphone, objective-c, ios, ipad

I noticed something very strange in my app. My app records video and pictures. If I delete a video from the camera roll, it's still available to my app to play. When I delete a video the app I can go to the camera roll and it's still there.

It seems the app keeps a separate copy of the video, and the phone OS keeps another copy.

Is there some way for my app to delete both copies, or ideally only save an app specific copy that does not appear in the camera roll?

The path I use to save a movie is :

```
file://localhost/var/mobile/Applications/735E62F4-F5C4-49F5-A0BF-C34784F4B631/Documents/defaultFolder/1346579390.mov 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T11:47:32.483

There are some unclear points in your question, specifically it is not clear how you are saving your videos and pictures. I will explain a bit how saving happens in general so it might help you to find your problem.

First every app has its own sandbox into which it can save its data, and no app can access the sandbox of another app. On the other hand Apple allows any app to access the Photo Library but only in 2 ways: Reading from the Photo Library, or Writing data in the Photo Library. What is not allowed in the Photo Library is deleting data. Put differently, once you saved something in the Photo Library you can not delete it from your app, the user has to do this himself manually by going to the Photo Library and deleting it from there.

Usually saving in the Photo Library is done as follows:

```
UIImageWriteToSavedPhotosAlbum(imageToSave, nil, nil, nil); //for image files
UISaveVideoAtPathToSavedPhotosAlbum(pathOfVideoToSave, nil, nil, nil); //for video files 
```

So if you don't have these lines in your code the files shouldn't be saved in the Photo Library. To save data in your app sandbox you usually use:

```
[dataToSave writeToFile:fullPathToFile atomically:NO]; 
```

So if you only have this line in your code then you will only have the images and video saved in your app sandbox and if you delete them from your sandbox they will not be found in the Photo Library. I hope this clarifies things for you.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:10:57.957

How do you create/store a taken video/picture? Normally all videos/pics are stored in a specific directories of the phone - for sure different than your app directory. So when you save it, how do you save it ? do you make a real file copy into your app folder or do you only save the link to the movie's file in the phone?

In my case I always had separate copies of pics/videos, since the app is independant of the phone's camera roll.

In the simulator you may also look directly into the app directory with Finder and see what happens when you delete a movie, if it really deletes the movie file.

# java - Java在String中搜索浮点数

> ID：12234963
> 
> 赞同：3
> 
> 时间：2012-09-02T09:53:08.357
> 
> 标签：java, regex, floating-point

假设我有这样的字符串：

> 示例字符串>1.67>>ReSTOfString

我的任务是从上面的字符串中只提取 1.67。

我认为正则表达式会很有用，但我不知道如何编写适当的表达式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-22T01:28:20.920

如果要从 a中提取所有**`Int`'s**和**`Float`'s****`String`**，可以按照我的解决方案进行操作：

```
private ArrayList<String> parseIntsAndFloats(String raw) {

    ArrayList<String> listBuffer = new ArrayList<String>();

    Pattern p = Pattern.compile("[0-9]*\\.?[0-9]+");

    Matcher m = p.matcher(raw);

    while (m.find()) {
        listBuffer.add(m.group());
    }

    return listBuffer;
} 
```

如果您还想解析**负值**，您可以像这样添加**`[-]?`**到模式中：

```
 Pattern p = Pattern.compile("[-]?[0-9]*\\.?[0-9]+"); 
```

如果您还想设置**`,`为分隔符**，您可以像这样添加**`,?`**到模式中：

```
 Pattern p = Pattern.compile("[-]?[0-9]*\\.?,?[0-9]+"); 
```

.

要测试模式，您可以使用此在线工具： http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)

*注意*：对于这个工具，如果您正在尝试我的示例，请记住取消转义（您只需要取消其中一个**`\`**）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-22T02:59:51.773

以下是如何在一行中做到这一点，

```
String f = input.replaceAll(".*?([\\d.]+).*", "$1"); 
```

如果你真的想要一个`float`，下面是你如何在一行中做到这一点：

```
float f = Float.parseFloat(input.replaceAll(".*?([\\d.]+).*", "$1")), 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-02T09:58:24.390

您可以尝试使用正则表达式匹配数字

```
\\d+\\.\\d+ 
```

这可能看起来像

```
Pattern p = Pattern.compile("\\d+\\.\\d+");
Matcher m = p.matcher("eXamPLestring>1.67>>ReSTOfString");
while (m.find()) {
    Float.parseFloat(m.group());
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-02T09:58:07.220

```
 String s = "eXamPLestring>1.67>>ReSTOfString>>0.99>>ahgf>>.9>>>123>>>2323.12";
    Pattern p = Pattern.compile("\\d*\\.\\d+");
    Matcher m = p.matcher(s);
    while(m.find()){
        System.out.println(">> "+ m.group());
    } 
```

只给出浮点数

```
>> 1.67
>> 0.99
>> .9
>> 2323.12 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-02T09:58:23.600

您可以使用正则表达式`\d*\.?,?\d*`这将适用于像 1.0 和 1,0 这样的浮点数

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-02T10:20:14.853

看看这个**[链接](http://www.regular-expressions.info/floatingpoint.html)**，他们还解释了在构建这样的正则表达式时需要记住的一些事情。

`[-+]?[0-9]*\.?[0-9]+`

示例代码：

```
String[] strings = new String[3];

    strings[0] = "eXamPLestring>1.67>>ReSTOfString";
    strings[1] = "eXamPLestring>0.57>>ReSTOfString";
    strings[2] = "eXamPLestring>2547.758>>ReSTOfString";

    Pattern pattern = Pattern.compile("[-+]?[0-9]*\\.?[0-9]+");

    for (String string : strings)
    {
        Matcher matcher = pattern.matcher(string);
        while(matcher.find()){
            System.out.println("# float value: " + matcher.group());
        }
    } 
```

输出：

```
# float value: 1.67
# float value: 0.57
# float value: 2547.758 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-30T20:19:45.650

```
/**
 * Extracts the first number out of a text.
 * Works for 1.000,1 and also for 1,000.1 returning 1000.1 (1000 plus 1 decimal).
 * When only a , or a . is used it is assumed as the float separator.
 *
 * @param sample The sample text.
 *
 * @return A float representation of the number.
 */
static public Float extractFloat(String sample) {
    Pattern pattern = Pattern.compile("[\\d.,]+");
    Matcher matcher = pattern.matcher(sample);
    if (!matcher.find()) {
        return null;
    }

    String floatStr = matcher.group();

    if (floatStr.matches("\\d+,+\\d+")) {
        floatStr = floatStr.replaceAll(",+", ".");

    } else if (floatStr.matches("\\d+\\.+\\d+")) {
        floatStr = floatStr.replaceAll("\\.\\.+", ".");

    } else if (floatStr.matches("(\\d+\\.+)+\\d+(,+\\d+)?")) {
        floatStr = floatStr.replaceAll("\\.+", "").replaceAll(",+", ".");

    } else if (floatStr.matches("(\\d+,+)+\\d+(.+\\d+)?")) {
        floatStr = floatStr.replaceAll(",", "").replaceAll("\\.\\.+", ".");
    }

    try {
        return new Float(floatStr);
    } catch (NumberFormatException ex) {
        throw new AssertionError("Unexpected non float text: " + floatStr);
    }
} 
```

# image-processing - 从图像中快速提取 EXIF（不仅是 jpeg，还包括原始格式，例如 NEF、DNG 等）

> ID：12234968
> 
> 赞同：0
> 
> 时间：2012-09-02T09:54:01.960
> 
> 标签：image-processing, exif, extraction

> **可能重复：**
> [从 JPG 读取 EXIF 数据](https://stackoverflow.com/questions/10494796/reading-exif-data-from-jpg)

在我的 C# 3.0、.NET 3.5 项目中，我正在做一些与图像相关的事情。特别是，我需要提取 EXIF 信息。

EXIF 提取的常规方法有缺点：

1.  如果我使用标准 Image 类，它会加载所有图像，而不仅仅是 EXIF，这会导致大量图像出现性能问题（我正在处理数以万计的图像）。此外，它仅支持常规图像类型，不支持数码相机的原始文件，例如 NEF、DSC、DNG。
2.  如果我使用 GdPicture.NET 库（它支持原始图像格式），加载图像的时间也非常长（单个 NEF 文件大约需要半分钟！），所以我需要等待几天才能为所有图像提取 EXIF。

是否有任何库可以从常规 jpeg 图像和原始图像中快速提取 EXIF 信息，而无需加载图像本身？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T11:05:08.467

[http://www.codeproject.com/Articles/36342/ExifLib-A-Fast-Exif-Data-Extractor-for-NET-2-0](http://www.codeproject.com/Articles/36342/ExifLib-A-Fast-Exif-Data-Extractor-for-NET-2-0)似乎可以为您完成这项工作

> ** 介绍**
> 
> ExifLib 简单地从 JPEG 文件中读取 Exif 标签（即相机型号、GPS 数据、拍摄日期、快门速度等），而无需使用位于 System.Drawing.Imaging 中的 GDI+ 类引入的开销，并且代码行数更少为开发商。

看起来您可以在读取图像时设置[validateimagedata](http://msdn.microsoft.com/en-us/library/21zw9ah6%28v=vs.80%29.aspx)并且可能会加快速度，但是似乎 exiflib 可能仍然更快

# f# - 重构时是否应该删除 F# 类型注释？

> ID：12234970
> 
> 赞同：9
> 
> 时间：2012-09-02T09:54:12.507
> 
> 标签：f#, refactoring, type-inference

如果我在将函数用于任何地方之前编写函数，我发现向其参数添加类型注释很有用。这意味着我可以自动完成它的值，并且（尤其是作为 F# 新手）不会被意外的类型推断弄糊涂。

但是，一旦函数完成，我很想删除参数的类型注释，因为它们很难看。这听起来像是一件合理的事情吗？

我希望这可能取决于我在谈论什么样的功能。例如，它可能对私有函数有意义，但对公共函数没有意义。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T22:30:10.117

我认为这取决于很多因素。以下是一些支持保留注释的论点：

1.  类型注释可以说是一种经过编译器检查的文档。
2.  不要无故修改工作代码。
3.  编译时可能需要某些类型注释，在这种情况下，保留所有类型注释而不是仅删除不必要的注释以保持一致性可能是有意义的。

但是，另一方面，也有一些令人信服的理由来删除它们：

1.  编译器实际上可能会推断出更通用的类型，在这种情况下，您可以在更广泛的上下文集中重用函数。
2.  您的代码会更简洁，您可能会发现它更具可读性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T14:59:51.973

对于它的价值，我的个人风格是使用 fsi 文件维护公共模块接口的注释，并删除 fs 模块实现文件中的大多数注释（除非从左到右类型推断需要它们）。使用这种方案，更改模块接口是一件大事，而更改其实现则较小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T17:41:02.557

不，它没有任何优势。你可以说它使程序在以后更容易更改，或者看起来更好，但实际上它永远不会成功。

很可能您最终还是会重新输入注释，原因与您最初添加它们的原因完全相同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-03T18:17:09.707

我认为，这里的一个重要论点是*删除类型注释会改变 sources 的含义*。

事实上，让我们假设有一个源代码：`let f (arg: MyType) = arg.ToString()`.
源限制`arg`为 type `MyType`。如果任何客户端代码尝试传递另一种类型的参数，它将根本无法编译。
这也适用于**单元测试**。使用类型注释，很容易看出所有单元测试`f`仅使用类型为 的参数进行调用`MyType`。

如果类型注释被删除，类型推断工作不受限制，但测试还没有准备好，他们*仍然*只用`MyType`.

因此，**删除类型注释必须与更改单元测试相关联**，任何其他重构也是如此。如果您准备好改进测试，那就去做吧。否则你可能会自找麻烦，尤其是对于大型代码库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T20:00:02.490

这是个人风格的问题；我会把它们拿出来。随着您在 F# 编码方面的进步，您可能会发现您不必经常经历注释阶段。

# php - 当sql数据库中的值发生变化时，将数据从服务器发送到android设备

> ID：12234975
> 
> 赞同：0
> 
> 时间：2012-09-02T09:54:54.647
> 
> 标签：php, android, android-notifications, google-cloud-messaging

我正在开发一个需要与服务器通信的 Android 应用程序。我的意思是服务器或设备可以随时发送消息。简单地说我想让用户将反馈留给另一个用户。例如在 ebay 上留下反馈。从 android 向服务器发送数据很常见，我知道我可以发出 http 请求来运行 php 脚本、查询数据库并通过 JSON 对象将响应发送回 android 设备。我想通知另一位用户，他通过通知收到了新的反馈。我知道我可以定期轮询服务器，但我试图尽可能避免这种情况。我已阅读有关 Google Cloud Messaging 的信息。我想知道是否有另一种更简单或更好的方法来完成这项任务？请指教。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T09:59:14.407

正如您在问题中所述，您有两个选择：

*   轮询（应用程序轮询服务器以查看是否有任何新内容）
*   推送（服务器告诉客户端有新内容）

没有其他方法可以让设备了解服务器上的新内容（也许几年后，使用[量子纠缠](http://en.wikipedia.org/wiki/Quantum_entanglement)将是第三种选择；-)

推送效果更好，因为网络活动只有在服务器上确实有东西的情况下才会发生。

# post - Octopress 中没有可用的“post”对象

> ID：12234981
> 
> 赞同：0
> 
> 时间：2012-09-02T09:55:51.917
> 
> 标签：post, view, octopress

我刚刚安装了 octopress 作为博客系统并构建了自己的小主题。一切正常，但有一件事还没有工作。

在单个帖子视图中，我似乎没有“帖子”对象。意思就是：

```
<h1>{{post.title}}</h1> 
```

生成一个空字符串。博客索引和单个帖子视图使用相同的文章标题。这只是它不起作用的单个帖子视图。博客索引工作正常。

你们有谁知道，我可以在单个帖子视图中使用哪个对象，或者我如何才能在单个帖子视图中访问帖子的标题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T18:00:53.737

post 对象由 post 循环创建，并且仅在循环内部可用。

```
{% for post in paginator.posts %}  
  <h1>{{ post.title }}</h1>
{% endfor %}

```

在生成页面本身时，您将使用 teh`page`对象访问页面数据。

```
<h1>{{ page.title }}<h1>

```

这将获得当前正在生成的页面的标题，这可能是您想要做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T04:30:57.297

`<h1>{{post.title}}</h1>`是自定义部分的一部分吗？
如果要向侧边栏添加部分，请在`source/_includes/custom/asides/`.
每当您向侧边栏添加部分时，请遵循此模式，使用`<section>`块和`<h1>`标题。要将其添加到侧边栏，请编辑并将`_config.yml`其添加到边栏列表中。
[更多信息](http://octopress.org/docs/theme/template/)

# mysql - 谷歌地图地理编码器从 MySQL 数据库中查找附近的地方

> ID：12234982
> 
> 赞同：4
> 
> 时间：2012-09-02T09:55:53.570
> 
> 标签：mysql, sql

我有一个网站，我使用数据库提供的地址将位置存储在 MySQL 数据库和 GeoCode 中。

现在我想添加一个功能，它可以找到离指定点最近的位置，例如他们现在站立或打字的位置。我正在用 JavaScript 和 jQuery 编写地理编码器和谷歌地图，并使用 PHP 从数据库中获取结果。

我阅读了有关`viewport`但我无法弄清楚它在我需要显示我自己的数据库位置而不是谷歌的情况下如何工作。

有人可以帮忙吗？如果您有某种示例，那就太棒了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T10:23:26.863

半径搜索：

```
select *,
    acos(cos(centerLat * (PI()/180)) *
     cos(centerLon * (PI()/180)) *
     cos(lat * (PI()/180)) *
     cos(lon * (PI()/180))
     +
     cos(centerLat * (PI()/180)) *
     sin(centerLon * (PI()/180)) *
     cos(lat * (PI()/180)) *
     sin(lon * (PI()/180))
     +
     sin(centerLat * (PI()/180)) *
     sin(lat * (PI()/180))
    ) * 3959 as Dist
from TABLE_NAME
having Dist < radius
order by Dist 
```

3959 是以英里为单位的地球半径。将此值替换为以 KM 为单位的半径或任何单位，以获得相同单位的结果。 **centerLat**和**centerLon**是搜索的中心（您的输入），而 lat 和 lon 是表中的字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T10:23:09.190

这是我要做的：

*   由于您无论如何都使用数据库，因此每次将位置添加到数据库时，都将人类可读的地址转换并保存为 LatLng（一次）

*   查询用户的位置

*   将用户位置地理编码为 LatLng

*   使用 SQL 查询查找与所需距离匹配的地点。（见这里[https://developers.google.com/maps/articles/phpsqlsearch_v3](https://developers.google.com/maps/articles/phpsqlsearch_v3)）

`SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(-122) ) + sin( radians(37) ) * sin( radians( lat ) ) ) ) AS distance FROM markers HAVING distance < 25 ORDER BY distance LIMIT 0 , 20;`

*   将 SQL 结果显示回 Javascript 映射

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T13:17:50.397

听起来像经典的商店定位器。有关使用 PHP 和 MySQL 的示例，请参阅[Google Maps API v3 文档中的这篇文章。](https://developers.google.com/maps/articles/phpsqlsearch_v3)

# opencv - OpenCV SURF 关键点比较

> ID：12234983
> 
> 赞同：4
> 
> 时间：2012-09-02T09:56:15.317
> 
> 标签：opencv, computer-vision, surf, keypoint

我有 2 张图像，在相机左侧有一点方向，我想从 opencv 中找到方向，我从 2 张图像中获取 surf 关键点，我的问题是如何比较这 2 个关键点以找到方向。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T13:11:56.020

您需要应用**匹配器**（例如 cv FlannMatcher）来检测两个图像中的哪些关键点对应于同一点。

然后，对于配对匹配，您必须应用**cv::findHomography()**。该算法将使用 4 个匹配对来提取单应矩阵。

最后一步（[这里有一些代码](https://stackoverflow.com/a/10781165/744859)）是从单应矩阵转换为**姿势矩阵**（外参矩阵）。位姿矩阵由旋转和平移组成。

# c# - 两个时间跨度之间的差异返回负数

> ID：12234993
> 
> 赞同：0
> 
> 时间：2012-09-02T09:57:20.757
> 
> 标签：c#

我在一个 HR 项目中，我需要为员工定义 Shift Shift 有两个用于阅读穿孔卡片的字段，Swipein 和 swipeOut。我使用两个 datetimepicker，格式为时间，showupdown 为 true 来设置刷入和刷出时间，并像这样读取

```
public void calculateduration()
    {
        TimeSpan swipein = dtp_toTime.Value.TimeOfDay;
        TimeSpan swipeout = dtp_FromTime.Value.TimeOfDay;
        TimeSpan duration = dtp_toTime.Value.TimeOfDay - dtp_FromTime.Value.TimeOfDay;
        MessageBox.Show(duration.ToString());

    } 
```

在我的 SQL 服务器数据库中，我将所有这三个字段 swipein、swipeout、duration 作为 Time 数据类型，我想在其中插入这些值

为了测试，我给出了四个值

Swipein Swipeout 持续时间（显示输出）上午 8 点 下午 4 点 8 小时 >>>> 同一天的白班

下午 3 点 10 点 8 小时 >> 同一天

晚上 10 点早上 6 点（第二天）-16 小时 >>> prblm..8 必须来这里

任何想法请或任何人都可以告诉我一个想法来检查收到的持续时间是否为负数

```
if(duration <0)
{
duration= 24-duration;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:01:32.457

您可以在减去它们之前检查这些值：

```
TimeSpan duration;
if (swipeout >= swipein) {
  duration = swipeout - swipein;
} else {
  duration = swipeout + new TimeSpan(1, 0, 0, 0) - swipein;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T10:40:42.083

问题在于 TimeSpan 结构旨在表示时间间隔，而不是特定时间。所以在这种情况下，使用 TimeSpan 表示持续时间是有意义的，但 swipein 和 swipeout 最好用 DateTime 表示。

```
public void calculateduration()
{
    DateTime swipein = dtp_toTime.Value;
    DateTime swipeout = dtp_FromTime.Value;
    TimeSpan duration = swipeout - swipein;
    MessageBox.Show(duration.ToString());
} 
```

（当然，这假设 dtp_ToTime.Value 和 dtp_FromTime.Value 是 DateTimes，但我猜它们是......）

# python - 在 Python3 中的 Tornado 上使用非阻塞 MySQL api 有什么建议吗？

> ID：12234998
> 
> 赞同：3
> 
> 时间：2012-09-02T09:58:02.447
> 
> 标签：python, database, asynchronous, io, tornado

我希望龙卷风支持异步 sql 数据库操作，在我阅读了源代码之后，

[http://www.tornadoweb.org/documentation/_modules/tornado/database.html#Connection](http://www.tornadoweb.org/documentation/_modules/tornado/database.html#Connection)

叹息，他们正在阻止版本。这里有一些选择。

计划A：找到一组类似于mysqldb模块的api，除了他们使用回调来返回reuslt.sorry我没有找到一个显示他们的api可以处理非阻塞mysql操作的例子

B方案：使用block版本。听说tornado的作者建议开发者使用block版本，并且极大的优化你的sql查询以缩短阻塞周期。

在我的情况下：服务器需要在高峰时段每秒处理接收 2k 请求，其中大多数需要从数据库查询和更新，建议每个操作需要 10 毫秒，10 毫秒 * 2k 超过 20 秒，那将是一场噩梦。在多线程编程中至少我可以建立更多的连接以获得更多的平均响应时间。

也许我在这里错过了一些观点，我对后端开发没有太多经验。但是我仍然认为使用阻塞 io api 是一个糟糕的想法，而框架是非阻塞的。

方案C：放弃MySql 使用mongoDB，听说mongoDB 有一个异步Python 实现api 叫asyncmongo，但我不确定学习mongoDB 的风险，将mongoDB 作为我们的业务选择

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T10:27:58.107

另一种选择是设置多处理 ( [http://docs.python.org/library/multiprocessing.html?highlight=multiprocessing#multiprocessing](http://docs.python.org/library/multiprocessing.html?highlight=multiprocessing#multiprocessing) ) 并将进程中的一个用作数据库的队列管理器。

将多处理与高效的 SQL 查询相结合，您应该将整体影响降至最低。阻塞调用只会在 DB Processing Queue Manager 进程上完成，应用程序的其余部分可以运行而不会被阻塞。唯一受影响的人是那些试图同时运行数据库查询的人。