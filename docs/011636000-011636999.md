# StackOverflow 问答 11636000-11636999

# objective-c - 通过 UISlider 更改 UIAccelerometer 的 updateInterval

> ID：11636004
> 
> 赞同：0
> 
> 时间：2012-07-24T17:17:27.700
> 
> 标签：objective-c, ios, uislider, uiaccelerometer

我正在尝试通过我的 .xib 中的 UISlider 更改我的 UIAcceleromter 的 updateInterval。我的 NSLogs 完美地显示了这些值，但是当我移动滑块时，加速度计的间隔并没有增加速度。我不确定出了什么问题。

我感谢提供的任何帮助。这是我的代码：

视图控制器.h：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UIAccelerometerDelegate> {

}

- (IBAction)sliderValueChanged:(UISlider *)slider;

@end 
```

视图控制器.m：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize XAxis, YAxis, delta;

float value;

- (void)viewWillAppear:(BOOL)animated
{   
    UIAccelerometer *accel = [UIAccelerometer sharedAccelerometer];
    accel.delegate = self;
    accel.updateInterval = 1.0f * value;

    NSLog(@"Value: %f",value);
}

- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration
{
    NSLog(@"X: %g",acceleration.x);
    NSLog(@"Y: %g",acceleration.y);
    NSLog(@"Z: %g",acceleration.z);
}

- (IBAction) sliderValueChanged:(UISlider *)slider 
{  
    value = slider.value;
    NSLog(@"Value: %f",slider.value);
} 

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:26:03.893

没有一行代码可以改变加速度计的更新间隔。您所做的就是记住 a 中滑块的值`float`并通过`NSLog`.

加速度计值仅在您的视图出现时设置。

您需要将加速度计存储为对象的属性并执行类似的操作

```
self.accelerometer.updateInterval = value; 
```

在你的`sliderValueChanged:`方法中。

# salesforce - 如何自定义 apex:listView 中的列？

> ID：11636005
> 
> 赞同：0
> 
> 时间：2012-07-24T17:17:32.770
> 
> 标签：salesforce, apex-code

我的案例有一个 apex:listView：

```
<apex:ListViews type="Case">
</apex:ListViews> 
```

当我显示此页面时，我会看到列操作、案例编号、联系人姓名、主题、状态、优先级、打开的日期/时间和案例所有者别名。

我将如何自定义显示哪些列以及这些列的顺序？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:00:20.780

这就是我最终做的事情：

```
<apex:page standardController="Case" recordSetVar="Case" sidebar="true" showHeader="true">
    <apex:form >
        <apex:pageBlock title="Cases">
              <apex:outputLabel value="View:"/>
              <apex:selectList value="{!filterId}" size="1">
                <apex:actionSupport event="onchange" rerender="cases_table"/>
                <apex:selectOptions value="{!listviewoptions}"/>
              </apex:selectList>
            <apex:pageBlock >
                <apex:pageBlockButtons >
                </apex:pageBlockButtons>
                <apex:pageBlockTable value="{!case}" var="c" rows="50" id="cases_table" >
                    <apex:column >
                        <a target="_parent" href="{!URLFOR($Action.Case.View, c.id)}">{!c.CaseNumber}</a>
                        <apex:facet name="header">Case Number</apex:facet>
                    </apex:column>
                    <apex:column value="{!c.ContactId}" />
                    <apex:column value="{!c.Subject}" />
                    <apex:column value="{!c.Status}" />
                    <apex:column value="{!c.Priority}" />
                </apex:pageBlockTable>
            </apex:pageBlock>
        </apex:pageBlock>
    </apex:form>
    <base target="_parent"/>
</apex:page> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T19:41:32.570

Apex 列表视图与标准列表视图类似，在顶部包含一个选项列表，后跟一个`Edit`按钮和一个`Create New View`按钮。您可以通过单击编辑按钮来修改视图。据我所知，没有办法以编程方式修改列。如果您需要更多控制，您可以使用另一个标签，例如`<apex:pageblocktable>`问题评论中提到的 JCD。

![列表视图选项列表编辑按钮](../Images/b13aacd600b118951ca86adbceefa1b7.png)

# google-analytics - 谷歌分析 - 唯一网页浏览量与访问量

> ID：11636007
> 
> 赞同：5
> 
> 时间：2012-07-24T17:17:38.900
> 
> 标签：google-analytics, web-analytics

我是否正确假设***访问***指标仅计算用户在给定页面上启动会话的次数，而***唯一页面浏览量***是查看给定页面的用户数量？

鉴于以下情况，我的网站上有两个页面：*Page A*和*Page B*。*页面 A*包含指向*页面 B*的链接。

如果用户在*Page A*开始浏览我的网站，*Google Analytics*会将*A*上的***Visits***和***Unique Pageviews***增加1。

 *现在，如果用户点击*B*的链接，*Google Analytics*会增加***访问次数***和***唯一网页浏览量***，还是只增加*B*上的***唯一网页浏览量***？

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:23:48.613

> 我是否正确假设“访问”指标仅计算用户在给定页面上启动会话的次数，而“唯一浏览量”是查看给定页面的用户数量？

不，页面浏览量是每次执行跟踪代码（或调用 _trackPageview() 时），唯一页面浏览量是同一用户在同一会话期间生成的聚合页面浏览量。

*   [AdWords 点击次数与 Google Analytics（分析）中的会话、用户、入口、网页浏览量和唯一身份网页浏览量之间的区别](https://support.google.com/analytics/answer/1257084?hl=en)
*   [如何在 Analytics 中定义会话](https://support.google.com/analytics/answer/2731565?hl=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T20:08:48.800

问题：现在如果用户点击指向 B 的链接，Google Analytics 会增加访问次数和唯一网页浏览量，还是只增加 B 上的唯一网页浏览量？答案：访问（不增加）/页面 B 上的唯一网页浏览量 (+1)

基本上，访问是会话的第一次点击，它可能与入口不同（会话的第一次网页浏览点击）。请参阅以下链接。

链接：[https ://support.google.com/analytics/answer/2934985?hl=en-GB&ref_topic=2524483](https://support.google.com/analytics/answer/2934985?hl=en-GB&ref_topic=2524483)

这是 Google Visit 1 的示例：

```
Visitor enters to Page A
Visitor navigates to Page B
Visitor navigates back to Page A
End of session 
```

访问 2：

```
Visitor enters to Page C
Visitor navigates to Page B
End of session 
```

概括

```
Page A: 2 Page views, 1 Visit, 1 Unique Page view, 1 Unique Visitor, 1 Entrance
Page B: 2 Page views, 0 Visits, 2 Unique Page views, 2 Unique Visitors, 0 Entrances
Page C: 1 Page view, 1 Visit, 1 Unique Page view, 1 Unique Visitor, 1 Entrance
Totals: 5 Page views, 2 Visits, 4 Unique Page views, 2 Unique Visitors, 2 Entrances 
```**

# mongodb - 限制多个 MongoDB 数组大小

> ID：11636010
> 
> 赞同：0
> 
> 时间：2012-07-24T17:17:44.467
> 
> 标签：mongodb, atomic, fixed

我有一个文档，其中列出了按主题分隔的作者的帖子项目 ID。这会产生如下文档：

```
{
    _id: "sdkafjsadkfjads3023",
    Author: "SomeGuy"
    RecentPosts: {
        "topic-1": {
            Count: 4,
            Posts: ["postitemid1","postitemid2","postitemid2","postitemid3"]
        }
        "topic-2": {
            Count: 3
            Posts: ["postitem5","postitem6","postitem8"]
        }
    }
} 
```

大多数时候，我在同一个更新中对这些帖子数组中的每一个进行原子推送。我想要做的是始终将上面的数组限制为 10 个项目。这样，每当我对相同的主题/帖子进行推送时。我要问的是可能的，还是我应该以不同的方式做到这一点？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T03:51:55.633

事实证明，这是 MongoDB 中一个长期存在的问题，自从使用 $slice 运算符添加到 MongoDB 2.4 版本中之后。

```
db.students.update(
                { _id: 1 },
                { $push: { scores: { $each : [
                                               { attempt: 3, score: 7 },
                                               { attempt: 4, score: 4 }
                                             ],
                                     $sort: { score: 1 },
                                     $slice: -3
                                   }
                          }
                }
              ) 
```

[http://docs.mongodb.org/manual/tutorial/limit-number-of-elements-in-updated-array/](http://docs.mongodb.org/manual/tutorial/limit-number-of-elements-in-updated-array/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:04:12.943

如果我理解正确的话， **Capped Collections**就是你想要的。 [http://www.mongodb.org/display/DOCS/Capped+Collections](http://www.mongodb.org/display/DOCS/Capped+Collections)

# android - 电器遥控器

> ID：11636015
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:18:15.590
> 
> 标签：android, controls, adk, appliance

我喜欢做一个基于android的项目。我喜欢创建一个用于控制房间灯的应用程序。我怀疑我是否可以使用安卓手机从任何地方控制这些灯，还是只能通过USB线或蓝牙控制.如果可以从任何地方控制ADK板如何工作，特别是它如何将数据传输到手机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:22:19.043

您可以使用[Arduino](http://arduino.cc/en/)板来实现。它使用 C/C++ 开发。它非常适合 Android 你会发现很多教程

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:22:32.460

一切都通过某处的网络服务器进行通信。您必须以某种方式将硬件连接到互联网，并且您的自定义设备可以通过 C2DM 或 REST API 或其他方式与手机通信。底线是，您需要一个 Web 组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T01:26:30.590

如果控制器上有蓝牙无线电 SPP 模块（如 connectblue 蓝牙转串口适配器），那么您可以将手机的蓝牙连接到它，打开通信插座并在手机和控制器板之间发送串行数据。无需互联网，也无需网络服务器。当然，这仅适用于您的手机在控制器范围内（例如，小于 10 到 30m）

要从远处控制灯光，您需要将每个设备（控制器和手机）连接到互联网。您不需要使用 Web 服务器来执行此操作（尽管如果您愿意，也可以这样做）您可以使用最适合您目的的任何传输协议通过 Internet 进行数据通信。

# ruby-on-rails - Rake 因 Capistrano 部署而失败

> ID：11636022
> 
> 赞同：1
> 
> 时间：2012-07-24T17:18:51.370
> 
> 标签：ruby-on-rails, ubuntu, rake, capistrano

我正在使用 Capistrano 部署到 Ubuntu。

我为后台进程设置了 God + Resque。

应用程序运行良好，Resque 工作人员正在排队，但被卡在那里。当我查看日志时，我发现它的 Rake 失败了。这是跟踪：

```
FIRST THERE IS ABOUT 1000 OF THE BELOW LINE

/home/ubuntu/myapp/releases/20120724024732/config/application.rb:68:in `invoke'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/home/ubuntu/.rvm/gems/ruby-1.9.3-p125@global/bin/rake:19:in `load'
/home/ubuntu/.rvm/gems/ruby-1.9.3-p125@global/bin/rake:19:in `<main>'
/home/ubuntu/.rvm/gems/ruby-1.9.3-p125/bin/ruby_noexec_wrapper:14:in `eval'
/home/ubuntu/.rvm/gems/ruby-1.9.3-p125/bin/ruby_noexec_wrapper:14:in `<main>'
rake aborted!
Too many open files - rake_tasks_log.log
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:35:in `initialize'
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:35:in `open'
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:35:in `open'
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/logger.rb:592:in `open_logfile'
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/logger.rb:549:in `initialize'
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/logger.rb:314:in `new'
/home/ubuntu/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/logger.rb:314:in `initialize'
/home/ubuntu/myapp/shared/bundle/ruby/1.9.1/gems/activesupport-3.2.6/lib/active_support/core_ext/logger.rb:72:in `initialize' 
```

这是 application.rb 第 68 行中标有注释的函数：

```
module Rake
  class Task
    alias_method :origin_invoke, :invoke if method_defined?(:invoke)
    def invoke(*args)
      logger = Logger.new('rake_tasks_log.log')
      logger.info "#{Time.now} -- #{name} -- #{args.inspect}"
      puts args
      origin_invoke(args) ### LINE 68
    end
  end
end 
```

*** *EDIT:: 这是一条线索，但不知道如何处理它:: 显然，正在传递的 *args 是一个空数组...

这是我的 deploy.rb

```
require "bundler/capistrano"

$:.unshift(File.expand_path('./lib', ENV['rvm_path']))
require 'rvm/capistrano'
set :rvm_ruby_string, ENV['GEM_HOME'].gsub(/.*\//,"") 
set :rvm_type, :user

# -*- encoding : utf-8 -*-

set :assets_dependencies, %w(app/assets lib/assets vendor/assets Gemfile.lock config/routes.rb)

namespace :deploy do
  namespace :assets do

    desc <<-DESC
      Run the asset precompilation rake task. You can specify the full path \
      to the rake executable by setting the rake variable. You can also \
      specify additional environment variables to pass to rake via the \
      asset_env variable. The defaults are:

        set :rake,      "rake"
        set :rails_env, "production"
        set :asset_env, "RAILS_GROUPS=assets"
        set :assets_dependencies, fetch(:assets_dependencies) + %w(config/locales/js)
    DESC
    task :precompile, :roles => :web, :except => { :no_release => true } do
      from = source.next_revision(current_revision)
      if capture("cd #{latest_release} && #{source.local.log(from)} #{assets_dependencies.join ' '} | wc -l").to_i > 0
        run %Q{cd #{latest_release} && #{rake} RAILS_ENV=#{rails_env} #{asset_env} assets:precompile}
      else
        logger.info "Skipping asset pre-compilation because there were no asset changes"
      end
    end

  end
end

set :application, "myapp"

set :repository, "git@github.com:..."
set :scm, :git
set :git_shallow_clone, 1
set :branch, "master"

set :location, "ec2-....amazonaws.com"
role :app, location
role :web, location
role :db,  location, :primary => true

set :deploy_via, :remote_cache

set :user, "ubuntu"
set :use_sudo, false
set :deploy_to, "/home/ubuntu/myapp"
ssh_options[:forward_agent] = true
default_run_options[:pty] = true
ssh_options[:keys] = ["#{ENV['HOME']}/...pem"]

set :keep_releases, 1

# setup some Capistrano roles
role :app, location
role :web, location
role :db,  location, :primary => true

set :default_environment, { 
  'PATH' => "/home/ubuntu/.rvm/gems/ruby-1.9.3-p125/bin:/home/ubuntu/.rvm/gems/ruby-1.9.3-p125@global/bin:/home/ubuntu/.rvm/rubies/ruby-1.9.3-p194/bin:/home/ubuntu/.rvm/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/lib/pkgconfig:/usr/lib/jvm/java-1.6.0-openjdk-amd64:/usr/lib/jvm/java-6-openjdk-amd64:$PATH",
  'JAVA_HOME' => "/usr/lib/jvm/java-6-openjdk-amd64",
  'PKG_CONFIG_PATH' => '$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig'

}

desc "show path"
task :show_path do
  run "echo $PATH"
end

###PASSENGER:

namespace :passenger do
    desc "Restart Application"
    task :restart do
    run 'sudo /etc/init.d/nginx stop'
        run 'sudo /etc/init.d/nginx start'
    end
end

after :deploy, "passenger:restart"
after :deploy, "deploy:migrate" 
```

最后一点 - 如果我不使用 Capistrano，一切正常（例如，只需将 Rails 应用程序文件夹复制到服务器）.. 所以我想我在 Capistrano 方面遗漏了一些东西..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T01:43:43.430

所以原来我的redis文件夹有权限问题，无法写入数据库。所以我检查了数据库文件的保存位置（或者在我的情况下不保存）并且 sudo chown redis:redis 现在一切都很好。

# java - 创建 NdefMessage 时出现 FormatException

> ID：11636025
> 
> 赞同：0
> 
> 时间：2012-07-24T17:19:05.740
> 
> 标签：java, android, nfc, ndef

当它是 FormatException 之一时，我将我的原始问题误认为是转换之一。我正在尝试根据 EditText 输入编写 NFC 标签。相关代码如下：

```
EditText msgInput = (EditText) findViewById(R.id.editText1);

...

try {
    String msg = msgInput.getText().toString();
    byte[] bytes = msg.getBytes();
    messagePayload = bytes;
}

...

NdefMessage message;
try {
message = new NdefMessage(messagePayload);
} catch (FormatException e) {
// ups, illegal ndef message payload
Log.e(TAG, "Format exception from illegal ndef message payload");

return;
} 
```

它总是抛出那个 FormatException。我不确定为什么。我只是想写'xyz'或'stuff'或类似的东西。我确保我从每个之间的 Log 语句中获得正确的字节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:35:00.440

仅给出字符串的字节不是有效的 NdefMessage 有效负载。这就是为什么你会得到一个例外。要使用根据 NFC 论坛标准格式化的文本记录构造正确的 NdefMessage，请使用以下代码：

```
 String msg = msgInput.getText().toString();
    byte[] languageCode;
    byte[] msgBytes;
    try {
        languageCode = "en".getBytes("US-ASCII");
        msgBytes = msg.getBytes("UTF-8");
    } catch (UnsupportedEncodingException e) {
        return;
    }

    byte[] messagePayload = new byte[1 + languageCode.length
            + msgBytes.length];
    messagePayload[0] = (byte) 0x02; // status byte: UTF-8 encoding and
                                        // length of language code is 2
    System.arraycopy(languageCode, 0, messagePayload, 1,
            languageCode.length);
    System.arraycopy(msgBytes, 0, messagePayload, 1 + languageCode.length,
            msgBytes.length);

    NdefMessage message;
    NdefRecord[] records = new NdefRecord[1];
    NdefRecord textRecord = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
            NdefRecord.RTD_TEXT, new byte[]{}, messagePayload);
    records[0] = textRecord;
    message = new NdefMessage(records); 
```

有关 NDEF 协议的更多详细信息，请参阅此文档： [https ://engineering.purdue.edu/477grp14/Specs/NFC/NDEFTECH.pdf](https://engineering.purdue.edu/477grp14/Specs/NFC/NDEFTECH.pdf)

有关文本 RTD 的更多详细信息，请查看以下内容：http: [//www.maintag.fr/fichiers/pdf-fr/nfcforum-ts-rtd-text-1-0.pdf](http://www.maintag.fr/fichiers/pdf-fr/nfcforum-ts-rtd-text-1-0.pdf)

# ruby-on-rails - ruby on rails 自定义函数验证和发布

> ID：11636026
> 
> 赞同：1
> 
> 时间：2012-07-24T17:19:08.663
> 
> 标签：ruby-on-rails, validation, email, post

我创建了一个`controller`命名的`Invites`和一个`model`命名的`invite`，我在控制器中创建了一个名为 request_invite 的新函数，我想用它让用户输入他们的电子邮件地址，验证它并且它在邀请表中不存在，然后将它发布到数据库

邀请控制器.rb

```
class InvitesController < ApplicationController

    def request_invite
        render_404 unless request.xhr?

        @email = params[:get_invited_email]

        if @email
            flash[:notice] = "msg + insert"
        else
            flash[:notice] = "msg"
        end

    end

end 
```

邀请.rb

```
class Invite < ActiveRecord::Base

end 
```

我没有在路由文件中添加资源

形式

```
<%= form_tag(invite_request_path, :method => "post", :id => "landing_request_invite_form") do %>
    <%= text_field_tag 'get_invited_email', nil, :placeholder => 'Enter your email address' %>
    <%= submit_tag 'Get Invited', :id => "get_invited_btn" %>
<% end %> 
```

javascript

```
 $("#landing_request_invite_form").submit(function(e){
    e.preventDefault();
    var form = $(this);
    var url = form.attr("action");
    var formData = form.serialize(); 
    $.post(url, formData, function(html) { 
        console.log('request done');
    });
    return false;
  }); 
```

如何检查电子邮件不存在？我使用 .find() 方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:29:32.180

我将在我的回答中假设 Invite 模型在数据库中有一个被邀请的电子邮件列。

```
class Invite < ActiveRecord::Base
  validates :invited_email, :uniqueness => true
end

class InvitesController < ApplicationController
    def request_invite
        render_404 unless request.xhr?

        @invitation = Invite.new(params[:invite])
        if @invitation.save
            flash[:notice] = "msg + insert"
        else
            flash[:notice] = "msg"
        end
    end
end

<%= form_for Invite.new, :url => invite_request_path, :id => "landing_request_invite_form" do |f| %>
    <%= f.text_field :invited_email, :placeholder => 'Enter your email address' %>
    <%= f.submit 'Get Invited', :id => "get_invited_btn" %>
<% end %> 
```

简要说明：

`@invitation.save`如果对象无效，则通过验证并返回 false，并且由于我们放入`validates :invited_email, :uniqueness => true`了 Invite 模型，因此如果已经存在具有相同邀请电子邮件值的 Invite，则它将无效。

我还想建议您将`request_invite`行动转变为`create`行动。我认为没有理由不这样做 - 你所做的正是创建一个新的邀请。如果你这样做，你可以省略`:url => invite_request_path`from 构建器，因为当表单对象是一个新实例时，rails 默认会执行创建操作（如`Invite.new`）

# git - 将一个 Github 存储库连接到多个 Aptana 项目

> ID：11636028
> 
> 赞同：1
> 
> 时间：2012-07-24T17:19:16.577
> 
> 标签：git, github, repository, aptana

有没有办法将一个 Github 存储库连接到 Aptana 中的多个不同项目？换句话说，在单个 Github 存储库中拥有不同的目录连接到不同的 Aptana 项目？

我需要这种能力，因为我是一名从事许多项目的自由职业者，我不希望向 Github 支付大量美元。这曾经可以通过 SVN 实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T07:04:51.887

GitHub 存储库本身没有连接到任何东西，它只包含一组文件。
如果在这些文件中，您有多个 Aptana 项目，您可以在本地克隆后使用这些项目。

但是，如果您只想克隆GitHub 存储库的*一部分以便只获取其中一个项目，这是不可能的（*[不支持通过文件路径进行部分克隆](https://stackoverflow.com/a/2587244/6309)）

如果您只想要*一个*GitHub 存储库，则将不同的 Aptana 项目存储在**单独的分支**中。
然后，您可以多次克隆同一个 repo，并根据您的项目签出不同的分支。
[从 git1.7.10+ 开始](https://stackoverflow.com/a/9920956/6309)，你甚至可以[`git clone`](http://git-scm.com/docs/git-clone)只从你的仓库中取出*一个*分支！

```
git clone --single-branch 
```

> 仅克隆指向单个分支尖端的历史记录，由`--branch`选项指定或主分支远程的 HEAD 指向。
> 使用该`--depth`选项创建浅层克隆时，这是默认设置，除非`--no-single-branch`给出获取所有分支尖端附近的历史记录。

但这可能有与浅克隆相关的限制，即：

> 浅层存储库有许多限制（您不能克隆或从中获取，也不能从中推送或进入），但如果您只对历史悠久的大型项目的近期历史感兴趣，并且想要作为补丁发送修复。

# c# - MySql 和 SQlite 类实现接口

> ID：11636029
> 
> 赞同：1
> 
> 时间：2012-07-24T17:19:23.063
> 
> 标签：c#, mysql, sqlite, interface

这应该不难回答，但我非常绝望和困惑。我制作了从数据库执行读取查询的接口

```
interface IDatabase
{
    DataTable ExecuteReaderCommand(IDbCommand command);
    IDbCommand GetNewCommand();
} 
```

接下来，我在接口上面创建了两个不同的类实现。

```
class MysqlDatabase : IDatabase
{
    public DataTable ExecuteReaderCommand(MySqlCommand command)
    {
        DataTable dt = new DataTable();
        // ... read db
        return dt;
    }

    public MySqlCommand GetNewCommand()
    {
        cnn.Open();
        return cnn.CreateCommand();
    }
} 
```

和

```
class SQLiteDatabase : IDatabase
{
String dbConnection;
    SQLiteConnection cnn;

    public DataTable ExecuteReaderCommand(SQLiteCommand command)
    {
        DataTable dt = new DataTable();
        // ... read db
        return dt;
    }

    public SQLiteCommand GetNewCommand()
    {
        cnn.Open();
        return cnn.CreateCommand();
    }
} 
```

但是我收到错误，这些类没有实现 IDatabase 接口：

```
 MysqlDatabase does not implement interface member 'Database.GetNewCommand()'
 MysqlDatabase.GetNewCommand() cannot implement 'Database.GetNewCommand()' because it does not have the matching return type of 'System.Data.IDbCommand'.

 SQLiteDatabase does not implement interface member Database.ExecuteReaderCommand(System.Data.IDbCommand)
 SQLiteDatabase does not implement interface member 'Database.GetNewCommand()'. SQLiteDatabase.GetNewCommand() cannot implement Database.GetNewCommand() because it does not have the matching return type of 'System.Data.IDbCommand'. 
```

当我查看它们时`SQLiteCommand`，`MySqlCommand`它们都实现了`IDbCommand`.

**如何在通用接口下使用这些类，以便轻松切换它们？**

我非常感谢任何答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:25:08.997

> 当我查看 SQLiteCommand 和 MySqlCommand 时，它们都实现了 IDbCommand

不，他们没有。他们声称他们这样做，但他们实际上并没有提供正确的方法。看`IDatabase.GetNewCommand()`：

```
IDbCommand GetNewCommand(); 
```

和你的实施：

```
public MySqlCommand GetNewCommand()
{
    ... 
} 
```

他们有不同的返回类型。同样，您的`ExecuteReaderCommand`方法参数`IDbCommand`在 中`IDatabase`，但`MySqlCommand`在`MysqlDatabase`.

选项：

*   对“弱类型”版本使用显式接口实现，在具体类上公开“强类型”版本。例如，这就是`SqlCommand`在 .NET 框架中所做的。

*   使其`IDatabase`创建和使用的命令类型具有通用性：

    ```
    public interface IDatabase<TCommand> where TCommand : IDbCommand
    {
        DataTable ExecuteReaderCommand(TCommand command);
        TCommand GetNewCommand();
    } 
    ```

# php - 检查用户是否通过php中的函数登录

> ID：11636033
> 
> 赞同：0
> 
> 时间：2012-07-24T17:19:24.427
> 
> 标签：php, function, login

我对 PHP 有一个小问题，可能对你们大多数人来说这是一个愚蠢的问题，但我需要你的帮助。
这是我的代码：

```
function is_logged() {
if(isset($_COOKIE['username'])) {
    return true;
} else {
    return false;
}
} 
```

这是整个代码的一部分，如果没有记录，我需要拒绝某人访问。

```
if(!is_logged()) {
header("Location: ./?act=Home");
} 
```

我在哪里犯了错误？

编辑：对不起，我根本没有解释问题......这个函数不会重定向，页面留空！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:34:27.650

尝试这个：

在页面的最开始， put`ob_start()`以防止输出任何错误消息，然后将检查更改为：

```
if(!is_logged()) {
    ob_clean();
    header("Location: ./?act=Home");
    die();
} 
```

这里`die()`可以防止 PHP 做其他事情（可能会修改标头以便没有重定向）。您还应该检查在调用此代码之前是否生成了错误消息（因为这通常是`header()`重定向的问题）。[确保在 php.ini 和/或您的 PHP 中使用display_errors](http://us.php.net/manual/en/errorfunc.configuration.php#ini.display-errors)打开错误消息。请注意，`ob_start`并且`ob_clean`会阻止错误消息出现，因此您需要暂时删除它们以查看错误是什么......

话虽如此，仅使用 cookie 来确定用户是否登录被认为是不好的做法，因为任何人都非常容易在浏览器上制作 cookie。您应该进行一些服务器端检查以确保它是有效的登录。

# android - Android：顶部水平滚动视图，加载部分屏幕

> ID：11636035
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:19:26.503
> 
> 标签：android, memory, load, horizontalscrollview

我是安卓新手。最近我创建了一个活动，它在页面顶部有一个 Horizo​​ntalScrollView，其中包含一组带有 onClickListener 的图像。Horizo​​ntalScrollView 中的每个图像代表一些列表视图和图像视图。

目前，在我单击顶部 Horizo​​ntalScrollView 栏中的任何图像后，程序会启动另一个新活动。这绝对不是很有效，因为顶部的 Horizo​​ntalScrollView 没有改变，但我们每次都需要加载它。

我想知道是否有什么方法可以在我单击顶部栏的 imageView 后仅加载部分屏幕（Horizo​​ntalScrollView）

提前致谢！

杰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:20:37.477

当然，例如，您可以在 src 代码中使用 LayoutInflater 将另一个 xml 布局加载到已经运行的活动中。

# c# - 在 C# 中使用不匹配的数据连接两个数据表

> ID：11636040
> 
> 赞同：3
> 
> 时间：2012-07-24T17:19:57.017
> 
> 标签：c#, .net, sql, linq

我在 SQL 中有两个表，我将它们填充到 C# 中的 DataTables 中。它们的 SQL 表位于不同的服务器和不同的数据库上。

在第一个表中，我有 5 列

```
Name(string), AgentStatus(string), TimeInState(double), TaskHandled(double), Region(string) 
```

第二张表我有 3 列

```
Name(string), CChats(double), AChats(double) 
```

我一直在使用这个链接来合并 C# 中的表

[C#中DataTables的内连接](https://stackoverflow.com/questions/665754/inner-join-of-datatables-in-c-sharp)

但是我遇到的问题是这个。

表 1 有 59 行，每个用户 1 行。

表 2 有 25 行，每个拥有 Chat 帐户的用户 2 行。

当我在 C# 中合并它们时，我只从表 1 中获得与表 2 中的 25 行匹配的匹配项。我需要显示表 1 中的所有行，如果它们在表 2 中有一行，则显示该数据，否则显示 0

我知道问题出在哪里，它在上面链接中的 select 语句中，但我不确定如何在 C# 中修复它

这是我的代码不起作用......列表框只是为了查看输出以进行调试......

```
 DataTable dt1 = new DataTable();
        DataTable dt2 = new DataTable();

        dt1.Columns.Add("Name", typeof(string));
        dt1.Columns.Add("Status", typeof(string));
        dt1.Columns.Add("Time", typeof(double));
        dt1.Columns.Add("Calls", typeof(double));
        dt1.Columns.Add("Region", typeof(string));

        dt2.Columns.Add("Name", typeof(string));
        dt2.Columns.Add("CChats", typeof(double));
        dt2.Columns.Add("AChats", typeof(double));

        foreach(DataRow dr in _agentStates.Rows)
        {
            DataRow row = dt1.NewRow();
            row["Name"] = dr[0].ToString();
            row["Status"] = dr[1].ToString();
            row["Time"] = Convert.ToDouble(dr[2].ToString());
            row["Calls"] = Convert.ToDouble(dr[3].ToString());
            row["Region"] = dr[4].ToString();
            dt1.Rows.Add(row);
        }
        foreach(DataRow dr in _chatCount.Rows)
        {
            DataRow row = dt2.NewRow();
            row["Name"] = dr[0].ToString();
            row["CChats"] = Convert.ToDouble(dr[1].ToString());
            row["AChats"] = Convert.ToDouble(dr[2].ToString());
            dt2.Rows.Add(row);

        }

        var result = from table1 in dt1.AsEnumerable()
                     join table2 in dt2.AsEnumerable() on (string)table1["Name"] equals (string)table2["Name"]
                     select new
                     {
                         Name = (string)table2["Name"],
                         Status = (string)table1["Status"],
                         Time = (double)table1["Time"],
                         Calls = (double)table1["Calls"],
                         Region = (string)table1["Region"],
                         CChats = (double)table2["CChats"]
                     };
        foreach (var item in result)
        {
           listBox1.Items.Add(item.Name + " " + item.CChats.ToString());

        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:25:29.947

你想在`LEFT JOIN`概念上做一个（这是一个`OUTER JOIN`，而不是一个`INNER JOIN`）。

> 表 A 和 B 的左外连接（或简称为左连接）的结果始终包含“左”表 (A) 的所有记录，即使连接条件在“右”表中找不到任何匹配记录（乙）。
> 
> 来源：[http ://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join](http://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join)

Jeff Atwood 还发布[了对不同连接的体面的视觉解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.htm)。

在 LINQ 中，这比 SQL 更笨拙，类似于：

```
var LeftJoin = from user in Users
join chat in Chats
on user.Name equals user.Name into JoinedTables
from row in JoinedTables.DefaultIfEmpty()
select new                          
{
  Name,
  AgentStatus,
  TimeInState,
  TaskHandled,
  Region,
  CChats = chat != null ? chat.CChats : 0
  AChats = chat != null ? chat.AChats : 0                          
}; 
```

来源： [http ://codingsense.wordpress.com/2009/03/08/left-join-right-join-using-linq/](http://codingsense.wordpress.com/2009/03/08/left-join-right-join-using-linq/)

当然加入`Name`并不理想 - 希望您`ID`在现实世界中确实拥有一个，或者可以真正保证名称都是唯一的并且将始终如一地提供（例如，没有尾随空格或大小写差异）。

// 编辑，解决更新的代码示例

尝试这个：

```
var result = from table1 in dt1.AsEnumerable()
             join table2 in dt2.AsEnumerable() 
             on (string)table1["Name"] equals (string)table2["Name"]
             into joinedDt
             from table2 in joinedDt.DefaultIfEmpty()
             select new
             {
                 Name = (string)table1["Name"],
                 Status = (string)table1["Status"],
                 Time = (double)table1["Time"],
                 Calls = (double)table1["Calls"],
                 Region = (string)table1["Region"],
                 CChats = (table2 != null ? (double)table2["CChats"] : 0)
             }; 
```

# rvm - 删除 rbenv 后 Capistrano 不再工作

> ID：11636041
> 
> 赞同：0
> 
> 时间：2012-07-24T17:19:57.743
> 
> 标签：rvm, capistrano, rbenv

我删除了 RBENV 并切换到 RVM。

现在，当我尝试使用 capistrano 进行部署，甚至尝试运行“cap”时，我得到：

```
/Users/me/.rbenv/shims/cap: No such file or directory 
```

它显然仍在寻找 rbenv 垫片，但我如何让 capistrano 在 RVM 上工作？

我试过删除并重新安装gem，但没有奏效......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T21:22:36.860

确保`$PATH`从 中清除`/Users/me/.rbenv`，然后您可以调用`hash -r`使`PATH`缓存无效。

还要确保再次安装 gems，rbenv 和 rvm 都使用自定义路径来安装 gems - 所以需要再次安装 gems。

# java - 在 TestNG 中的 @BeforeMethod 和 @AfterMethod 之间共享驱动程序

> ID：11636044
> 
> 赞同：1
> 
> 时间：2012-07-24T17:20:03.540
> 
> 标签：java, webdriver, selenium-webdriver, testng

我正在 testNG 中编写测试。每个测试方法共享许多存储在类级别的公共属性，但每个测试方法都需要自己独立的驱动程序，因此不能将驱动程序存储为类变量。这允许在同时运行时使用不同的驱动程序多次调用每个测试方法。

基本上，我正在尝试做的 sudo 代码如下所示：

```
@BeforeMethod
public void setup(Argument someArg) {
    Driver driver = new Driver(argArg); 
}

@Test
public void test() {
    driver.dostuff();
}

@AfterMethod (alwaysrun = true)
public void teardown() {
    driver.quit();
} 
```

我的想法是，我可以将驱动程序存储在并发映射集合中，使用类名和测试方法作为存储和检索驱动程序的键，但我想找到一种更简单、更简洁的方法来执行此操作。

如果已经有解决此问题的答案，我深表歉意。我到处搜索，找不到我正在寻找的解决方案，或者无法将特定想法如何应用于我的问题。我的案例特定于 Selenium Webdriver，但我想还有其他案例可能想要做这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:03:38.753

使用一个怎么样`ThreadLocal<Driver>`？

# amazon-s3 - 将文件从 S3 增量复制到本地 hdfs

> ID：11636045
> 
> 赞同：0
> 
> 时间：2012-07-24T17:20:03.660
> 
> 标签：amazon-s3

我有一个应用程序每天或每小时或随机将数据写入 S3，另一个应用程序将数据从 S3 读取到本地 HBase。有没有办法告诉上次更新上传的最后一个文件是什么，然后读取文件，换句话说，增量复制文件？

例如：第 1 天：App1 将文件 1、2、3 写入文件夹 1；App2 将这 3 个文件读取到 HBase；第 4 天：App1 将文件 4 和 5 写入文件夹 1，将 6、7、8 写入文件夹 2；App2 需要从文件夹 1 中读取 4 &5，然后从文件夹 2 中读取 6,7,8。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:51:18.257

LastModified 标头字段可用于根据创建日期处理数据。这需要在客户端有一个内置逻辑来存储已处理的项目和新项目。您可以简单地存储您处理的日期，以便之后的所有内容都被视为新日期。

例子：

```
s3cmd ls s3://test
2012-07-24 18:29  36303234   s3://test/dl.pdf 
```

查看文件前面的日期。

# macos - 为什么 *.abc 不匹配名为 .abc 的文件？

> ID：11636046
> 
> 赞同：0
> 
> 时间：2012-07-24T17:20:05.590
> 
> 标签：macos, git, wildcard

我以为我理解通配符，直到这发生在我身上。本质上，我正在寻找一种通配符模式，它将返回所有未命名的文件`.gitignore`。我想出了这个，这似乎适用于我能想到的所有情况：

```
ls *[!{gitignore}] 
```

为了真正验证这是否有效，我想我会否定表达式并查看它是否返回名为的文件`.gitignore`（实际上任何以`gitignore`;结尾的文件`1.gitignore`也应该返回）。为此，我认为否定的表达式是：

```
ls *[{gitignore}] 
```

然而，这个表达式不返回一个名为的文件`.gitignore`（尽管它返回一个名为 的文件`1.gitignore`）。

从本质上讲，我的问题在简化后归结为：

> 为什么 *.abc 不匹配名为 .abc 的文件

我想我可以从那里拿走它。

PS：

1.  我正在使用 Mac OSX Lion (10.7.4)
2.  我想添加一个子句，`.gitignore`这样我会忽略每个文件，除了`.gitignore`给定文件夹中的文件。所以我最终添加`*`了`.gitignore`文件。结果是，git 最终忽略了`.gitignore`:)
3.  从我在谷歌上进行的众多搜索中 -`Use the asterisk character (*) to represent zero or more characters.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:29:06.463

我假设您正在使用 Bash。来自[Bash 手册](http://www.gnu.org/software/bash/manual/bashref.html#Filename-Expansion)：

> 当模式用于文件名扩展时，字符 '.' 除非设置了 shell 选项 dotglob，否则必须显式匹配文件名的开头或斜杠之后。

但是，[.gitignore模式的处理方式不同：](http://www.git-scm.com/docs/gitignore.html)

> 否则，git 将模式视为适合 fnmatch(3) 使用的带有 FNM_PATHNAME 标志的 shell glob：模式中的通配符将不匹配路径名中的 /。

根据[fnmatch(3) 文档](http://linux.die.net/man/3/fnmatch)`FNM_PERIOD`，只有在设置了标志时才必须显式匹配前导点，以便`*gitignore`gitignore 模式匹配`.gitignore`。

不过，有一种更简单的方法可以做到这一点。`.gitignore`忽略一切，除了`.gitignore`：

```
*
!.gitignore 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:31:06.707

如果您想忽略*除*文件之外的所有内容，请将`gitignore`其用作文件：

```
*
!.gitignore 
```

以感叹号开头的行被解释为例外。

# c++ - 如何获取字符串的一部分

> ID：11636047
> 
> 赞同：0
> 
> 时间：2012-07-24T17:20:16.440
> 
> 标签：c++, c, string

如何获取字符串的一部分。

例如，字符串是：

> > 输入字符串：“53 56 4B 00 00 41 41 2F 41 54 43 43 54 52 31 2E 41 54 31 2E 4E 37 38”
> > 
> > ```
> >  |                                        |
> >               ptr1                                     ptr2 
> > ```

`ptr1`从左到右总是在第 7 位

`ptr2`从右到左总是在第 13 位

输出字符串：

```
4B 00 00 41 41 2F 41 54 43 43 54 52 31 2E 41 54 31 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:24:52.290

如果你已经有了指针，这很简单。使用带有指针和长度的[`std::string`构造函数。](http://www.cplusplus.com/reference/string/string/string/)

```
std::string result(ptr1, ptr2 - ptr1); 
```

或者正如评论中指出的那样，由于指针也可以用作迭代器，因此您可以使用双迭代器构造函数：

```
std::string result(ptr1, ptr2); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T17:24:56.643

在 C 中：

```
char substr[MAX_LEN + 1];

strncpy(substr, input + 6, MAX_LEN);
substr[strlen(substr) - 12] = '\0'; 
```

在 C++ 中：

```
substr = input.substr(6, input.size() - (6 + 12)); 
```

这不会对输入字符串进行错误处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T17:24:43.070

如果可以使用`std::string`，则可以使用该[`substr`](http://www.cplusplus.com/reference/string/string/substr/)方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T17:25:07.170

使用`std::string.substr`功能。它就是为此目的而设计的。

它需要两个参数：第一个是从哪里开始“提取”的索引，第二个是“提取”字符的计数。

例子：

```
string hello = "Hello World";
string part = hello.substr(6, hello.size() - 6); // part == "World" 
```

所以，如果你有两个 indeces`i`和`j`，其中 i <= j，一个从`i`to的子字符串`j`，包括

```
string part = original.substr(i, j - i + 1); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T17:26:21.770

在 C 中，不修改输入字符串：

```
char *ptr1,*ptr2;
if(strlen(instring)<13) { /** error; not long enough **/ }
ptr1 = instring+7;
ptr2 = instring+strlen(instring)-13; 
```

这里的指针只是指向输入字符串中的一个位置。如果您需要在不修改原始输入字符串的情况下对其进行修改，请使用`strncpy`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-24T17:26:28.923

我认为您的 ptr1 和 ptr2 向后或左/右混淆了。但是我要从右边获取 X 位置是从字符串的最后一个元素迭代直到我到达第 X 位置，然后计算 X 离左边多远，然后使用 string.substr()。

[http://www.cplusplus.com/reference/string/string/substr/](http://www.cplusplus.com/reference/string/string/substr/)

# php - 如何在 PHP 中对具有许多属性的对象数组进行排序？

> ID：11636048
> 
> 赞同：2
> 
> 时间：2012-07-24T17:20:28.263
> 
> 标签：php, sorting

我有一个包含多个具有许多属性的对象的数组。

我想根据两个对象属性在 PHP 中对其进行排序

这是一个示例对象数组，可让您了解我正在处理的数据：

```
Array (
    [0] => stdClass Object (
        [username] => user98
        [sender_id] => 98
        [date_sent] => 2012-07-25 00:52:11
        [not_read] => 0
    )
    [1] => stdClass Object (
        [username] => user87
        [sender_id] => 87
        [date_sent] => 2012-07-25 00:59:15
        [not_read] => 1
    )
    [2] => stdClass Object (
        [username] => user93
        [sender_id] => 93
        [date_sent] => 2012-07-25 00:52:13
        [not_read] => 2
    )
    [3] => stdClass Object (
        [username] => user5
        [sender_id] => 5
        [date_sent] => 2012-07-25 00:52:16
        [not_read] => 0
    )
) 
```

我需要对它进行排序，从而得到这个数组：

```
Array (
    [1] => stdClass Object (
        [username] => user87
        [sender_id] => 87
        [date_sent] => 2012-07-25 00:59:15
        [not_read] => 1
    )
    [2] => stdClass Object (
        [username] => user93
        [sender_id] => 93
        [date_sent] => 2012-07-25 00:52:13
        [not_read] => 2
    )
    [3] => stdClass Object (
        [username] => user5
        [sender_id] => 5
        [date_sent] => 2012-07-25 00:52:16
        [not_read] => 0
    )

    [0] => stdClass Object (
        [username] => user98
        [sender_id] => 98
        [date_sent] => 2012-07-25 00:52:11
        [not_read] => 0
    )

) 
```

排序是根据对象的date属性和not_read属性进行排序的，not_read > 0优先排序，然后会查看date_sent属性，按照最新的date_sent排序。请注意，它不是基于谁拥有更高的 not_read 属性。

然后那些 not_read 属性为 0 的将按最新的 date_sent 排序。

谁能帮我完成这个程序？

非常感谢您的关注！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:27:17.423

您需要使用用户定义的排序功能：

```
function sortByDate($a, $b)
{
    if($a->not_read > $b->not_read)
        return 1;
    if($a->not_read < $b->not_read)
        return -1;
    if(strtotime($a->date_sent) > strtotime($b->date_sent))
        return 1;
    if(strtotime($a->date_sent) < strtotime($b->date_sent))
        return -1;
    return 0;
} 
```

然后用[usort](http://us.php.net/usort)调用它：

```
usort($array_to_sort, 'sortByDate'); 
```

传入的数组现在将被排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:41:58.337

```
function sortByDate($a, $b)
{
    if($a->not_read > 0 && $b->not_read == 0)
        return -1;
    if($b->not_read > 0 && $a->not_read == 0)
        return 1;
    if ($a->not_read == 0 && $b->not_read == 0 || $a->not_read > 0 && $b->not_read > 0){
        if(strtotime($a->date_sent) > strtotime($b->date_sent))
            return -1;
        if(strtotime($a->date_sent) < strtotime($b->date_sent))
            return 1;
    }

    return 0;
}

usort($array_to_sort, 'sortByDate'); 
```

注意：我想对 Patrick's 进行编辑，但我不确定我的是否有效。他走在正确的轨道上。

# c# - 将工具提示可见性绑定到变量，以便在代码隐藏中有条件地显示文本

> ID：11636049
> 
> 赞同：1
> 
> 时间：2012-07-24T17:20:29.297
> 
> 标签：c#, wpf, binding, tooltip

如果我有一个包含将包含工具提示的可见性状态的静态变量的类，我将如何编写代码隐藏以在可见性变量更改时动态更改工具提示的可见性？

即当禁用工具提示选项时，不应该显示任何工具提示，但是当启用工具提示选项时，应该显示工具提示。（工具提示选项保存在不同类的静态变量中）工具提示及其连接的控件是动态创建的。

伪代码：

```
 ToolTip myToolTip = new ToolTip();
 Visiblity tooltipVis = Visibility.Visible;
 Bind myToolTip.Visiblity to toolTipVis
 //Any control with ToolTip should now show their respective ToolTip messages.
 ...
 tooltipVis = Visibility.Hidden;
 //Any control with ToolTip should now have ToolTip messages disabled 
```

尝试绑定到 TreeViewItem：

```
 TreeViewItem tvi = new TreeViewItem() { Header = tviHeader };
 ToolTip x = new System.Windows.Controls.ToolTip();
 x.Content = "This is text.";
 Binding binder = new Binding { 
      Source = EnvironmentalVariables.ToolTipVisibility,
      Path = new PropertyPath("Visibility")
 };
 x.SetBinding(VisibilityProperty, binder);
 user.ToolTip = x;

 public class EnvironmentalVariables {
      public static Visibility ToolTipVisibility { get; set; }
 } 
```

这似乎没有将 Visiblity 绑定到 EnvironmentalVariables.ToolTipVisibility 变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:10:47.577

您可以为此使用[ToolTipService.IsEnabled 附加属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.tooltipservice.isenabled)。

```
<TextBlock Text="Example" ToolTip="This is an example"
           ToolTipService.IsEnabled="{Binding TooltipEnabled, Source={x:Static Application.Current}}"> 
```

因为您无法绑定到静态属性（[在 WPF 版本 4.5 中您可以](http://msdn.microsoft.com/en-us/library/bb613588%28v=vs.110%29#static_properties)），所以我将使用此解决方法从任何地方访问该属性

```
public partial class App : Application, INotifyPropertyChanged
{
    private bool _tooltipEnabled;
    public bool TooltipEnabled
    {
        get { return _tooltipEnabled; }
        set
        {
            if (_tooltipEnabled != value)
            {
                _tooltipEnabled = value;
                RaiseNotifyPropertyChanged("TooltipEnabled");
            }
        }
    }

    private void RaiseNotifyPropertyChanged(string property)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(property));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:18:07.223

只需删除您创建`Path`的对象中的属性。`Binding`这就是它需要工作的全部内容。

```
 EnvironmentalVariables.ToolTipVisibility = System.Windows.Visibility.Collapsed;

  var b = new Button () { Content = "test" };
  var x = new ToolTip();
  x.Content = "This is text.";
  var binding = new Binding {
    Source = EnvironmentalVariables.ToolTipVisibility,
  };
  x.SetBinding(VisibilityProperty, binding);
  b.ToolTip = x; 
```

如果要在运行时动态更改 ToolTipVisibility，则必须实现属性通知。

# c - 数组的大小减小 - 为什么

> ID：11636058
> 
> 赞同：0
> 
> 时间：2012-07-24T17:20:59.520
> 
> 标签：c

> **可能重复：**
> [为什么 sizeof(param_array) 是指针的大小？](https://stackoverflow.com/questions/11622146/why-sizeofparam-array-is-the-size-of-pointer)

```
 void print(char arr[]){
  int i;
  printf("%d" , sizeof(arr));  /*print 4**/

}

int main()
{

  char arr[]={0,1,2,3,4};
  printf("%d" , sizeof(arr)); /*print 5**/
  print(arr);
} 
```

当我将数组发送到函数时，大小似乎减少了 1。会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:22:55.957

因为你在函数中并没有真正的数组；它已退化为指针，大小未知。您要求`sizeof`a`char*`在您的平台上是 4 个字节。

# mysql - 匹配 IN 子句中的所有值

> ID：11636061
> 
> 赞同：52
> 
> 时间：2012-07-24T17:21:29.597
> 
> 标签：mysql, sql, yii

有没有办法确保`IN`子句中的所有值都匹配？

例子：

我可以使用 IN 作为：`IN (5,6,7,8)`。

我需要它像`AND`跨多行一样工作。

**更新：** 我需要这个来列出符合指定参数的 db 公司。公司和分类是多对多的关系。我正在使用 Yii 框架。这是我的控制器的代码：

```
public function actionFilters($list)
{
    $companies = new CActiveDataProvider('Company', array(
        'criteria' => array(
            'condition'=> 'type=0',
            'together' => true,
            'order'=> 'rating DESC',
            'with'=>array(
            'taxonomy'=>array(
                'condition'=>'term_id IN ('.$list.')',
                )
            ),
        ),
    ));
    $this->render('index', array(
        'companies'=>$companies,
    ));
} 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-07-24T17:22:50.760

你可以这样做：

```
select ItemID
from ItemCategory
where CategoryID in (5,6,7,8) <-- de-dupe these before building IN clause
group by ItemID
having count(distinct CategoryID) = 4 <--this is the count of unique items in IN clause above 
```

如果您提供您的架构和一些示例数据，我可以提供更相关的答案。

[SQL 小提琴示例](http://sqlfiddle.com/#!9/516a7c/81)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T17:38:51.173

```
 SELECT ItemID
     FROM ItemCategory
        WHERE (
               (CategoryID = 5) OR 
               (CategoryID = 6) OR 
               (CategoryID = 7) OR 
               (CategoryID = 8)
              )
     GROUP BY ItemID
 HAVING COUNT(DISTINCT CategoryID) = 4 
```

# c# - 性能计数器 - 性能类别创建错误

> ID：11636064
> 
> 赞同：3
> 
> 时间：2012-07-24T17:21:49.093
> 
> 标签：c#, performancecounter

当我尝试从我的 ASP.NET 应用程序创建新的性能类别时出现错误。最初我遇到了一些与注册表相关的问题，但通过授予用户对某些注册表项的一些权限并将其添加到“性能日志用户”和“性能监视器用户”组中来解决这些问题。但现在我遇到了一个例外，我不知道还能尝试什么。

执行此行时发生错误：

```
PerformanceCounterCategory.Create(testName, testDescription, PerformanceCounterCategoryType.Unknown, counters); 
```

`testName`并且`testDescriptions`是包含类别名称和描述的字符串变量，计数器是具有 3 个计数器的 CounterCreationDataCollection。

这是异常的堆栈跟踪：

> 在 System.Diagnostics.PerformanceCounterLib.RegisterFiles(String arg0, Boolean unregister) 在 System.Diagnostics.PerformanceCounterLib.RegisterCategory(String categoryName, PerformanceCounterCategoryType categoryType, String categoryHelp, CounterCreationDataCollection creationData) at System.Diagnostics.PerformanceCounterCategory.Create(String categoryName, String categoryHelp , PerformanceCounterCategoryType categoryType, CounterCreationDataCollection counterData) at CL.Libraries.PerformanceTestUtils.InitializeCounters(List`1 usedCounters, String testName, String testDescription) in C:\CL.Libraries\PerformanceTestUtils.cs:line 104

看来我无法发布图片，所以这就是我得到的：

> " UnauthorizedAccessException 被捕获：
> 
> 无法创建或删除性能类别“C:\TEMP\tmpD5E8.tmp”，因为访问被拒绝。"

类别键是在注册表中创建的。上面提到的文件被创建，然后被删除。我为用户提供了对 Temp 文件夹的显式访问权限，但这也无济于事。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:25:27.733

> 您的代码在没有管理权限的情况下执行，并试图读取性能计数器。

您需要管理权限

上述消息取自 MSDN [http://msdn.microsoft.com/en-us/library/sb32hxtc.aspx](http://msdn.microsoft.com/en-us/library/sb32hxtc.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T16:27:49.147

HatSoft 是完全正确的，您需要管理员权限才能创建性能计数器——您通常只需执行一次即可创建计数器。创建这些后，您可以轻松地按名称实例化性能计数器，然后使用它。

我们通常（在开发应用程序之后）将过程的这一步放在安装过程中 - 一旦设置应用程序就可以随意使用计数器。

我在 GitHub 上有一个项目，显示了性能计数器的基本用法，它应该可以帮助您入门： [https](https://github.com/stemarie/Karell.PerfCounters) ://github.com/stemarie/Karell.PerfCounters 您需要以管理员身份运行 VS（右键单击，以管理员身份运行) 以使单元测试正常运行。

# ack - 如何从 ack (ack-grep) 中排除特定文件？

> ID：11636065
> 
> 赞同：60
> 
> 时间：2012-07-24T17:21:49.077
> 
> 标签：ack

使用普通`grep`命令有一个`--exclude`选项（此处详细介绍：[使用 grep --exclude/--include 语法不通过某些文件 grep](https://stackoverflow.com/questions/221921/grep-exclude-include-syntax-do-not-grep-through-certain-files)）可以让您在 grep 时忽略特定文件。

Ack 的`--type`选项可以处理 95% 的您想要排除文件的情况，但它不能（据我所知）处理排除特定文件的情况。我有一个已编译的 JS 文件，其中包含所有其他 JS 文件的内容（在一行上），所以每次我 grep 获取*任何*内容时，我都会取回那个巨大的编译文件的全部内容。

我不想不得不放弃 ack 并为此返回 grep ，但这*真的很*烦人。拜托，有人告诉我有一种方法可以从 ack 搜索中排除特定文件。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2013-06-14T02:07:09.487

要使用 ack 2.0 忽略单个文件，请为 --ignore-file 标志提供过滤器规范：

`--ignore-file=is:cljout.js`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2017-06-30T03:28:20.047

如果你运行`ack --create-ackrc`它，它将输出一大堆常用文件的预设，如缩小的 javascript、css 和 node_modules 和 .git 等目录。很有用！

这是缩小的 js 选项：

```
# minified Javascript
--ignore-file=match:/[.-]min[.]js$/
--ignore-file=match:/[.]js[.]min$ 
```

以下是如何忽略名为 foo 的目录：

```
--ignore-directory=is:foo 
```

如果你想保存这个`.ackrc`运行

```
ack --create-ackrc >> ~/.ackrc 
```

然后从该文件中删除您不需要的内容。

此外，您可以在项目的根文件夹中为项目特定的内容创建另一个`.ackrc`文件。我把它放进去，`.gitignore`这样它就不会弄乱repo。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-24T21:32:05.307

不，ack 1.x 不会让您排除单个文件。在[ack 2.0](https://github.com/petdance/ack2)中，您可以。ack 2.0~~目前处于其第一个 alpha~~版本，现在是当前推荐的 ack 版本。

至于您的缩小 Javascript 文件的具体情况，您使用的是什么版本的 ack？ack 1.96 应该忽略基于扩展的缩小 JavaScript。如果扩展检查不起作用，您可能会自行破解 ack，因为它是一个单独的 Perl 程序。您可以破解该`is_searchable`功能。

在 ack 2.0 中，我们正在考虑忽略任何超过 500 个字符的行，因为它显然不是源代码。

您可能还想加入我们的[ack-users](https://groups.google.com/d/forum/ack-users)邮件列表。我们反应灵敏。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-27T22:27:13.817

也很高兴知道 ack2.0，如果您必须经常过滤文件，您可以在[`.ackrc`文件中指定这些选项。](http://beyondgrep.com/documentation/ack-2.04-man.html#the__ackrc_file)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-13T13:17:26.923

如果要排除特定文件夹，以下命令可能会对您有所帮助：

`ack keywords --ignore-dir folder_name`

`man ack`将提供更多详细信息:)

> --[no]ignore-dir=DIRNAME，--[no]ignore-directory=DIRNAME
> 
> --ignore-file=FILTERTYPE:FILTERARGS

# php - echo/printf 与结束 php 括号？

> ID：11636066
> 
> 赞同：-3
> 
> 时间：2012-07-24T17:21:55.260
> 
> 标签：php

非常简单的问题，需要一个非常简单的答案。

如果我有一些 PHP 文件需要输出大量带有变量的 html，是考虑更好地使用 echo/printf 还是结束 php 并重新启动它更好？

前任：

```
<?php
$varA = 'foo';
$varB = 'bar';
?>
<span><?php echo $foo; ?></span>
<div><?php echo 'content ' . $bar; ?></div>
<?php
//continue php here
?> 
```

被认为比

```
<?php
$varA = 'foo';
$varB = 'bar';
printf('<span> . $foo . </span>');
printf('<div>content ' . $bar . '</div>');
//continue php here
?> 
```

还是后者被认为“更好”，或者甚至被认为比另一个更好，时期！？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:03:05.717

echo/printf 都是一回事，看个人喜好了。但您可能要考虑使用[heredoc 语法](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)。恕我直言，比在 html 中添加 php 标签和 echo 语句更容易阅读。

```
echo <<<HTML
    <h1>$foo</h1>
    <p>$bar</p>
    <span>$fizz</span>
HTML; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:05:27.167

这里的答案是相当主观的，所以我*认为*第一种方法更干净，更容易阅读，主要是因为如果你碰巧与一个试图进行一些关注点分离的团队合作，那么前面 -如果最终开发人员自己没有`echo`被 PHP 淘汰（他们甚至可能*不了解*PHP），那么最终开发人员将更容易发现 HTML 标签。如果 HTML 包含在 PHP 字符串中，大多数文本编辑器将不会为 HTML 提供漂亮的语法突出显示。

还可能需要注意的是，如果您在严格的 MVC 环境中工作，那么您的视图应该包含尽可能少的 PHP，并且实际上应该只是一堆`echo`s。如果您愿意，我认为第一种方法有助于提供更多的 HTML 外观和感觉。

正如@hyphen-this 所说，heredoc 语法也是一种可接受的路线，并且不需要跳入和跳出 PHP 模式。

# colors - SSRS 饼图颜色编码

> ID：11636072
> 
> 赞同：4
> 
> 时间：2012-07-24T17:22:19.980
> 
> 标签：colors, reporting-services, pie-chart

我有一个 ssrs 报告，其中有许多饼图，其中包含通过和失败的字段以及最多 3 个其他杂项字段，我希望能够将通过始终着色为绿色，将失败始终着色为红色，但其他字段可能是默认值。这甚至可能吗？我已经在饼图中看到了带有自定义颜色代码的代码示例，但我不知道如何做到这一点，也没有找到将自定义代码放在哪里。我试图做的与仅定义几个字段的所有其他示例略有不同。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-25T16:56:41.633

```
=Switch
(
Fields!ResultTypeDescription.Value = "Pass", "Green",
Fields!ResultTypeDescription.Value = "Fail", "Red",
Fields!ResultTypeDescription.Value = "Assigned To Machine", "Blue",
Fields!ResultTypeDescription.Value = "Not Yet Assigned", "Orange",
True , "Gray" 
```

)

为了让我们的动态着色工作，我覆盖了调色板中的颜色。这就是它的完成方式。右键单击饼图并选择系列属性。选择填充页面并单击表达式 (fx) 按钮来定义颜色。

# python - 将非常长的字符串拆分为具有字符重叠的较小字符块

> ID：11636079
> 
> 赞同：0
> 
> 时间：2012-07-24T17:22:34.157
> 
> 标签：python, bash

我有一长串字符需要拆分成更小的块，但是这些块需要重叠。输出字符串的长度和重叠应该是可变的。

例子：

从文本文件开始：

```
----------------------------------------------------- 
```

输出是这样写的：

```
---------------------
---------------------
--------------------- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:42:29.347

我认为你的意思是：

```
def get_overlapped_chunks(textin, chunksize, overlapsize):  
    return [ textin[a:a+chunksize] for a in range(0,len(textin), chunksize-overlapsize)] 
```

**解释**

这里我使用了一个列表推导，它只获取输出字符串应该从`[0, step, 2*step,..., len(input)-chunksize]`where开始的索引，`step = chunksize-overlapsize`然后返回这些位置的文本，长度为 chunksize。

**用法**

然后可以按如下方式使用此函数：

```
textin = ''.join(open(FILENAME, 'r').readlines()) # text as single line

CHUNKSIZE=10
OVERLAPSIZE = 2    

chunks = get_overlapped_chunks(textin, CHUNKSIZE, OVERLAPSIZE)

fout = open(FILEOUT, 'w')
fout.writelines(chunks) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:49:45.023

给定一个字符串`s`，你可以使用**slices**得到一个子序列：

```
>>> s = 'abcdefghijklmnopqrstuvwxyz'
>>> s[0:5]
'abcde' 
```

其中切片为您提供第 0 个字符，直到（但不包括）第 5 个字符。该`range(start, end, step)`函数给出一个数字列表，从`start`最多`end`增加`step`

```
>>> range(0, len(s), 6)
[0, 6, 12, 18, 24] 
```

将两者结合起来会给你类似的东西

```
>>> for i in range(0, len(s), 6):
...     print s[i:i+8]
... 
abcdefgh
ghijklmn
mnopqrst
stuvwxyz
yz 
```

因为切片操作是“宽容的”，它仍然会在最后一行产生一个简短的答案，其中来自`s[24:34]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T10:35:40.923

纯重击：

```
length=20
overlap=3

while read line ; do
  idx=0
  while [ $idx -lt ${#line} ] ; do
    echo "${line:idx:length}"
    ((idx+=length-overlap))
  done
done < "$infile" 
```

# python - 为什么 python 将非空字符串的对象解释为逻辑 False？

> ID：11636083
> 
> 赞同：-5
> 
> 时间：2012-07-24T17:22:49.823
> 
> 标签：python

我不明白为什么空字符串不是 False，就像空字符串一样。我认为角色的集合远非如此。在这种情况下，python 目的的根源是什么？

```
>>> "" in 'fdsa'
True
>>> '' in ''
True
>>> 'asdf' in ''
False
>>> 'adsf' is True
False 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:26:17.147

我不太明白你的问题。您在这里使用了两个运算符：

1.  `in`for strings 检查第一个字符串是否是第二个字符串的子字符串。 [空字符串被认为是所有其他字符串的子字符串。](https://stackoverflow.com/a/5206477/279627)

2.  `is`测试对象身份，`True`如果两个运算符是同一个对象，则返回。 `'adsf'`并且`True`显然不是同一个对象，所以你得到`False`.

这两个运算符都与在布尔上下文中解释字符串无关——您的问题似乎也涉及到这一点。例如，布尔上下文将是`if`语句的条件。在布尔上下文中，空字符串被视为`False`，非空字符串被视为`True`。您可以通过使用来查看对象在布尔上下文中的行为`bool(obj)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:27:47.750

请注意，如果您想查看字符串的布尔值是什么，可以`bool()`在其上调用函数，如下所示：

```
>>> bool('')
False
>>> bool('asdf')
True 
```

关键字`in`（[docs](http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)）将测试一个元素是否在一个序列中——我认为这不是你想要的。

# jquery - 为特定元素禁用 csTransPie

> ID：11636088
> 
> 赞同：1
> 
> 时间：2012-07-24T17:23:07.730
> 
> 标签：jquery

我使用库[csTransPie](http://www.pkoretic.net/csTransPie/)。

如何禁用特定元素的转换为`<input type="file">`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:31:14.110

在文件 csTransPie.js（未缩小版）的末尾，您会`$.fn.cTP = function() { ...`在其中找到：

```
$(':checkbox',this).cTPCheckBox();
$(':radio',this).cTPRadio();
$(':file',this).cTPFile();
$('select',this).cTPSelect(); 
```

将其更改为：

```
$('.styleme:checkbox',this).cTPCheckBox();
$('.styleme:radio',this).cTPRadio();
$('.styleme:file',this).cTPFile();
$('select.styleme',this).cTPSelect(); 
```

`styleme`并为您希望通过 csTransPie 设置样式的所有元素添加类。那应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:36:46.527

加载页面后添加您的项目：

**HTML**

```
<div id="file-container"></div> 
```

**jQuery**

```
<script type="text/javascript" src="jQuery/jquery-1.7.2.min.js"></script> 
<script type="text/javascript" src="csTransPie/csTransPie-min.js"></script>
<script type="text/javascript">
    $(function () {
        $('#file-container').html('<input type="file" />');​
    });
</script> 
```

# c++ - 通过openCV对比拉伸图像

> ID：11636094
> 
> 赞同：4
> 
> 时间：2012-07-24T17:23:37.093
> 
> 标签：c++, image-processing, opencv

我正在尝试使用 cvNormalize 将图像的对比度拉伸到 0-255 的范围内。但是当我打印输出像素值时，一些负数显示为像素值。如果您能帮助我找出问题的根源，我将不胜感激。这是代码：

```
cvNormalize(srcImage, dstImage, 0, 255, CV_MINMAX );

for ( int pixel = 0; pixel < dstImage->height * dstImage->width; pixel++ ) {
    printf("%d\t",*(dstImage->imageData + pixel));
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:39:08.320

因为`imageData`'s 的类型是`char*`并且`char`可以是负数（范围是 [-128, 127]）。尝试投射到`unsigned char`.

请参阅[文档](http://opencv.willowgarage.com/documentation/basic_structures.html#iplimage)。

# javascript - 有没有办法在javascript中向文本节点添加属性？

> ID：11636096
> 
> 赞同：0
> 
> 时间：2012-07-24T17:23:39.687
> 
> 标签：javascript, dom, text, textnode

我想向文本节点添加一个属性，以便我可以唯一地识别它。有没有办法在javascript中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:25:01.523

不是以安全、简单、跨浏览器的方式。只有标签有属性，文本节点不是标签。
将其包装在 a 中`<span>`并在跨度上使用 ID。

# ios - 应用程序运行时播放声音

> ID：11636097
> 
> 赞同：0
> 
> 时间：2012-07-24T17:23:43.817
> 
> 标签：ios, cocoa-touch, avfoundation

编辑仍然不确定什么是错的请帮助

嗨，我正在创建 iOS 应用程序并试图让它在运行时播放声音 我已经在应用程序委托 .h 、 .m 中输入了我的代码，它播放的声音很好，但事情是它变成了黑色当我的 ViewController.xib 有蓝色背景时的屏幕继承我的代码

AppDelegate.h

```
#import <UIKit/UIKit.h>
#import <AVFoundation/AVFoundation.h>
@class ViewController;

@interface AppDelegate : NSObject <UIApplicationDelegate, AVAudioPlayerDelegate> {
    UIWindow *window;
    ViewController *viewController;
    AVAudioPlayer *_backgroundMusicPlayer;
    BOOL _backgroundMusicPlaying;
    BOOL _backgroundMusicInterrupted;
    UInt32 _otherMusicIsPlaying;
}

@property (nonatomic, retain) IBOutlet UIWindow *window;

@property (nonatomic, retain) IBOutlet ViewController *viewController;

- (void)tryPlayMusic; 
```

AppDelegate.m

```
#import "AppDelegate.h"

#import "ViewController.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize viewController = _viewController;

- (void)applicationDidFinishLaunching:(UIApplication *)application {    

    // Set up the audio session
    // See handy chart on pg. 55 of the Audio Session Programming Guide for what the categories mean
    // Not absolutely required in this example, but good to get into the habit of doing
    // See pg. 11 of Audio Session Programming Guide for "Why a Default Session Usually Isn't What You Want"
    NSError *setCategoryError = nil;
    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryAmbient error:&setCategoryError];

    // Create audio player with background music
    NSString *ticktockPath = [[NSBundle mainBundle] pathForResource:@"ticktock" ofType:@"wav"];
    NSURL *ticktockURL = [NSURL fileURLWithPath:ticktockPath];
    NSError *error;
    _backgroundMusicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:ticktockURL error:&error];
    [_backgroundMusicPlayer setDelegate:self];  // We need this so we can restart after interruptions
    [_backgroundMusicPlayer setNumberOfLoops:-1];   // Negative number means loop forever

    // Override point for customization after app launch    
    [window addSubview:viewController.view];
    [window makeKeyAndVisible];
}

- (void) audioPlayerBeginInterruption: (AVAudioPlayer *) player {
    _backgroundMusicInterrupted = YES;
    _backgroundMusicPlaying = NO;
}

- (void) audioPlayerEndInterruption: (AVAudioPlayer *) player {
    if (_backgroundMusicInterrupted) {
        [self tryPlayMusic];
        _backgroundMusicInterrupted = NO;
    }
}

- (void)applicationDidBecomeActive:(NSNotification *)notification {
    [self tryPlayMusic];
}

- (void)tryPlayMusic {

    // Play the music if no other music is playing and we aren't playing already
    if (_otherMusicIsPlaying != 1 && !_backgroundMusicPlaying) {
        [_backgroundMusicPlayer prepareToPlay];
        [_backgroundMusicPlayer play];
        _backgroundMusicPlaying = YES;
    }   
}

- (void)dealloc {
    [viewController release];
    [window release];
    [super dealloc];
}

@end 
```

好的，这就是所有的代码

![在此处输入图像描述](../Images/473198eaa76ab13ecd83769918bd6adf.png)

这就是我在应用程序加载并且声音正常时得到的结果

![在此处输入图像描述](../Images/1bf0f1e36d43050f62ec83a8a4259742.png)

这就是我想要得到的（ViewController.xib）

![在此处输入图像描述](../Images/a9aa9de9e6d15bdb72259e1b76bf02ba.png)

感谢先进

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {    

    NSError *setCategoryError = nil;
    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryAmbient error:&setCategoryError];
    self.viewController = [[ViewController alloc] init];
    // Create audio player with background music
    NSString *ticktockPath = [[NSBundle mainBundle] pathForResource:@"ticktock" ofType:@"wav"];
    NSURL *ticktockURL = [NSURL fileURLWithPath:ticktockPath];
    NSError *error;
    _backgroundMusicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:ticktockURL error:&error];
    [_backgroundMusicPlayer setDelegate:self];  // We need this so we can restart after interruptions
    [_backgroundMusicPlayer setNumberOfLoops:-1];   // Negative number means loop forever

    // Override point for customization after app launch    
    [window addSubview:viewController.view];
    [window makeKeyAndVisible];
} 
```

新代码

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.
    self.viewController = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:53:55.420

你从来没有初始化你的视图控制器。

在你做之前的某个地方

```
[window addSubview:viewController.view]; 
```

你需要做

```
self.viewController = [[ViewController alloc] init]; 
```

我看到您将该属性声明为 IBOutlet .. 它实际上与 Interface Builder 中的某些东西挂钩吗？

* * *

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

    NSError *setCategoryError = nil;
    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryAmbient error:&setCategoryError];
    // Create audio player with background music
    NSString *ticktockPath = [[NSBundle mainBundle] pathForResource:@"ticktock" ofType:@"wav"];
    NSURL *ticktockURL = [NSURL fileURLWithPath:ticktockPath];
    NSError *error;
    _backgroundMusicPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:ticktockURL error:&error];
    [_backgroundMusicPlayer setDelegate:self];  // We need this so we can restart after interruptions
    [_backgroundMusicPlayer setNumberOfLoops:-1];   // Negative number means loop forever

    self.viewController = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

复制该功能并完全删除该功能`- (void)applicationDidFinishLaunching:(UIApplication *)application`。

您还应该考虑将您的项目转换为使用[ARC](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)。它将消除保留/释放/自动释放语句的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T20:56:25.060

您有两个目标 - 您的所有资源都包含在您正在构建的目标中吗？

# ruby-on-rails-3 - PG:: 部署到heroku时出错

> ID：11636099
> 
> 赞同：0
> 
> 时间：2012-07-24T17:23:49.230
> 
> 标签：ruby-on-rails-3, heroku

当我的应用程序被推送到 heroku 时，我在应用程序中遇到了一个奇怪的错误。该应用程序在我的本地机器上运行良好。我不知道是不是因为我在本地使用Mysql？

这是我得到的错误：

```
2012-07-24T17:14:52+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  argument of AND must be type boolean, not type integer
2012-07-24T17:14:52+00:00 app[web.1]: : SELECT COUNT(*) FROM "users" INNER JOIN "articles_users" ON "users"."id" = "articles_users"."user_id" WHERE "articles_users"."article_id" = 64 AND (1)):
2012-07-24T17:14:52+00:00 app[web.1]:     9:            <span>
2012-07-24T17:14:52+00:00 app[web.1]:     10:           <a data-action="like" data-id="<%= a.id %>" >
2012-07-24T17:14:52+00:00 app[web.1]:     11:           <%if user_signed_in?%>
2012-07-24T17:14:52+00:00 app[web.1]:     12:                   <%if a.likes.where(user_id = current_user.id).size == 0%>
2012-07-24T17:14:52+00:00 app[web.1]:     13:                           <%=image_tag("star.png", :width => "37", :height => "36", "data-action" => "star")%></a><span data-action="likes" style="vertical-align:10px; padding:8px;">
2012-07-24T17:14:52+00:00 app[web.1]:     14:                   <%else%>
2012-07-24T17:14:52+00:00 app[web.1]:     15:                           <%= image_tag("star-yellow.png", :width => "37", :height => "36", "data-action" =>"star")%></a><span data-action="likes" style="vertical-align:10px; padding:8px;"> 
```

这是我认为的代码：

```
<a data-action="like" data-id="<%= a.id %>" >
    <%if user_signed_in?%>  
        <%if a.likes.where(user_id = current_user.id).size == 0%>   
            <%= image_tag("star.png", :width => "37", :height => "36", "data-action" => "star")%></a><span data-action="likes" style="vertical-align:10px; padding:8px;">
        <%else%>
            <%= image_tag("star-yellow.png", :width => "37", :height => "36", "data-action" => "star")%></a><span data-action="likes" style="vertical-align:10px; padding:8px;">
        <%end%> 
```

这里出了什么问题？先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:06:59.103

我变了

```
<%if a.likes.where(user_id = current_user.id).size == 0%> 
```

至

```
<%if !a.likes.include?(current_user)%> 
```

现在它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:08:02.217

您应该像这样修改 where 方法。

```
a.likes.where(:user_id => :current_user.id) 
```

不是

```
a.likes.where(user_id = current_user.id) 
```

我认为这会奏效。

# actionscript-3 - 通过静态文本引用更改文本值？

> ID：11636100
> 
> 赞同：0
> 
> 时间：2012-07-24T17:23:49.717
> 
> 标签：actionscript-3, flash

我正在通过我的 DisplayContainer 搜索文本字段以更改它们，但我在更改参考时遇到了问题：

```
 for (var i:uint = 0, n:uint = rootContainer.numChildren; i < n; ++i) {
        var item:DisplayObject = rootContainer.getChildAt(i);
        if (item is DisplayObjectContainer) {
            updateFields(DisplayObjectContainer(item));
        } else if (item is TextField) {
            item.text  = "hej";
        }
    } 
```

item.text 抛出：

```
1119: Access of possibly undefined property text through a reference with static type flash.display:DisplayObject. 
```

我如何转换它以便我可以使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:29:10.070

您需要将其键入为 a `TextField`，然后才能对其调用`TextField`方法：

```
for (var i:uint = 0, n:uint = rootContainer.numChildren; i < n; ++i) {
    var item:DisplayObject = rootContainer.getChildAt(i);
    if (item is DisplayObjectContainer) {
        updateFields(DisplayObjectContainer(item));
    } else if (item is TextField) {
        var textField:TextField = item as TextField;
        textField.text  = "hej";
    }
} 
```

# c# - C# winform，将所有相关类都设为 Partial 是个好主意吗？

> ID：11636106
> 
> 赞同：0
> 
> 时间：2012-07-24T17:24:25.997
> 
> 标签：c#, winforms

我的主窗体，现在有两个按钮将显示其他窗体（每个按钮显示一个新窗体），我的主窗体类名是 MyMainForm .. 其他两个窗体类名是： MySubForm1 ， MySubForm2 问题是我我在访问子表单内的 MyMainForm 中的某些内容时遇到了一些问题。

让他们全部偏心是个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:39:08.477

在我看来，您希望能够从不同的表单访问表单的私有成员。

如果您希望能够访问其任何成员，则需要从“子表单”引用到父表单。

其次，您将无法访问“私人”成员。还有两个选项，为您想要的成员创建公共 get/set 方法，或者将对象的访问修饰符更改为 public/internal。

发布更多代码来解释您尝试过的内容以及您正在尝试实现的目标，我也许可以为您指明正确的方向。

此外，在更直接地回答您的问题时，部分与您尝试做的事情无关，它们用于扩展现有类，同时保持逻辑文件中的代码分离。

```
public class Main : Form
{
     // assuming here you have three textboxes

     private void button1_Click(eventargs etc)
     {
         OtherForm otherForm = new OtherForm() { Text1 = textbox1.Text, 
                                                 Text2 = textbox2.Text,
                                                 Text3 = textbox3.Text };
         otherForm.Show();
     }

}

public class OtherForm : Form
{
    public String Text1 { get; set; }
    public String Text2 { get; set; }
    public String Text3 { get; set; }
} 
```

使用此设置，您的 OtherForm 将拥有创建表单时文本值的副本。

根据您的问题和以下评论，这是您在场景中所期望的，但我会再说一遍，向我们展示一些代码，我们可以提供更好的帮助。Partials 绝对不是正确的答案。

# php - 按日期对 Wordpress 自定义元框值进行排序

> ID：11636108
> 
> 赞同：2
> 
> 时间：2012-07-24T17:24:35.540
> 
> 标签：php, wordpress, sorting, loops, meta

我正在为 wordpress 主题开发自定义事件帖子类型，但遇到了排序问题。一切都按我的需要工作，直到我将值吐出到模板中。我需要按日期顺序列出事件，但我似乎无法让它发挥作用。这是我的代码：

```
// From my custom meta box. Shows the type of field that
// the user enters the date into. The prefix is _cmb_
array(
    'name' => 'Event Date',
    'id'   => $prefix . 'event_date',
    'type' => 'text_date'
),

---- // -----

// Grab the date that's input from the user in the
// Custom Meta Box and Convert the text_date to 
// YYYYMMDD format
if ( $field['type'] == 'text_date' ) {
    $new = date('omd', strtotime($new));
} 
```

上面我从日期选择器获取输入并重新格式化文本。

```
// Tour Dates Loop
$args = array(
    'post_type' => 'event',
    'meta_key'  => '_cmb_event_date',
    'order_by'  => 'meta_value_num',
    'order'     => 'DESC'
);
$tourDates = new WP_Query( $args ); 
```

在这里，我使用 WP_Query 来获取正确的帖子类型、元键，并尝试通过该元键对输出进行排序。唯一的问题是事件没有正确排序。

我尝试将 转换为`_cmb_event_date`整数，但无法使其正常工作。我认为可能日期排序不正确，因为它们不是整数，而是字符串。

我在 Stack 上浏览了一堆帖子，但似乎找不到适合我的答案。任何帮助深表感谢！如果您需要更多代码上下文，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T21:32:58.450

问题解决了。`'order_by' => 'meta_value_num',`应该是`'orderby' => 'meta_value_num',`。

# bash - 在几百个静态页面中替换 Google Analytics 代码？

> ID：11636109
> 
> 赞同：0
> 
> 时间：2012-07-24T17:24:37.873
> 
> 标签：bash, replace, sed, awk

我希望创建一个 bash 脚本并使用 sed 将旧的谷歌分析代码替换为新的，但尚未取得任何成功，目前在使用以下代码时出现“未终止的替代模式”错误。另外我不确定我是否可以使用 sed 来替换多行上的文本块，也许我必须使用 awk？

```
OLDANALYTICS='<script type=\"text/javascript\">
var gaJsHost = ((\"https:\" == document.location.protocol) ? \"https://ssl.\" : \"http://www.\");
document.write(unescape(\"%3Cscript src='\''\" + gaJsHost + \"google-analytics.com/ga.js'\'' type='\''text/javascript'\''%3E%3C/script%3E\"));
</script>
<script type=\"text/javascript\">
try {
var pageTracker = _gat._getTracker(\"UA-111111-5\");
pageTracker._trackPageview();
} catch(err) {}</script>'

NEWANALYTICS='<script type=\"text/javascript\">
            var _gaq = _gaq || [];
            _gaq.push(['\''_setAccount'\'', '\''UA-111111-5'\'']);
            _gaq.push(['\''_trackPageview'\'']);

            (function() {
                var ga = document.createElement('\''script'\''); ga.type = '\''text/javascript'\''; ga.async = true;
                ga.src = ('\''https:'\'' == document.location.protocol ? '\''https://ssl'\'' : '\''http://www'\'') + '\''.google-analytics.com/ga.js'\'';
                var s = document.getElementsByTagName('\''script'\'')[0]; s.parentNode.insertBefore(ga, s);
            })();

        </script>'

sed -i '' "s#$OLDANALYTICS#$NEWANALYTICS#g" $1 
```

一旦它工作，我必须将它与“查找”命令结合起来，以递归方式替换所有文件中的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T02:39:15.660

您可以使用 TextPad 在多个文件中进行搜索和替换。它支持多行搜索和正则表达式，是GUI。此外，它是一个免费软件。

[http://www.textpad.com/download/](http://www.textpad.com/download/)

# database - 如何在数据库中存储安全凭证

> ID：11636110
> 
> 赞同：1
> 
> 时间：2012-07-24T17:24:41.633
> 
> 标签：database, security, passwords, credentials, cmdb

我正在开发一个类似 CMDB 的应用程序，我必须在其中存储我们的安全凭证（服务器用户名和密码，...）。

我正在寻找使用这些约束安全存储它们的最佳方法：

*   大多数用户将无法访问所有凭据（取决于用户角色）
*   我们不希望所有密码都使用相同的密钥加密（已经尝试过：当用户离开公司时，更改密钥很痛苦......）
*   事实上，我们不希望任何私钥被硬写在应用程序源中，甚至存储在任何地方（在我们之前的版本中，私钥存储在我们的耳朵之间......）
*   我们需要实现密码强度审计（即从脚本中解析解密的密码）
*   在任何情况下我们都不能再访问我们的凭据（丢失的密钥，...）=>我们不希望未经授权的人查看它们，但我们也不想丢失它们=>解决方案约束可能是定期导出到物理储物柜...

我不是在询问应用程序（https，...）或数据库（没有公共访问权限，...）安全问题本身，而只是关于存储方面（甚至可能不在数据库中......？加密文件或其他东西） ...) ：是否有可能阻止某人，即使可以访问应用程序代码或数据库内容（最坏的情况），也能够读取解密的凭据？

我知道我正在寻求一些神奇的解决方案，但我想知道它是否存在；o)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T01:30:31.410

您要求做的一般情况是不可能的。现代密码学的所有类型都具有[机械优势](http://blogs.msdn.com/b/ericlippert/archive/2011/09/27/keep-it-secret-keep-it-safe.aspx)。也就是说，他们用一个小秘密来保护一个更大的秘密。如果不能保守小秘密，就没有安全。如果您希望能够逐个密码地向某人提供密码，那么您实际上是在向他们提供秘密 - 密码 - 他们需要访问相关项目。

这个问题就是为什么存在联合身份系统（Kerberos/Active Directory/etc.）系统——以允许中央机器对用户进行身份验证而不向所述用户公开秘密。但是使用联合身份系统需要待登录系统和身份服务之间的合作。

# exchangewebservices - 您可以使用 EWS 2010 创建和发送 IRM 电子邮件吗？

> ID：11636113
> 
> 赞同：1
> 
> 时间：2012-07-24T17:24:51.583
> 
> 标签：exchangewebservices

需要以编程方式创建和发送 IRM 电子邮件，但不想通过 Outlook API 进行。希望 EWS 2010 有这个功能，但我没有在 MSDN 文档中看到它。

非常感谢任何指导。

谢谢，

戴夫

# facebook - 带有自定义文本的 FB 分享按钮

> ID：11636122
> 
> 赞同：0
> 
> 时间：2012-07-24T17:25:14.643
> 
> 标签：facebook

我们在我们网站的一部分中使用 facebook 分享按钮。我们曾经能够更改按钮的文本，但似乎不再可行。

我们现在的代码是：

```
<a name="fb_share" type="button" share_url="http://<?=$_SERVER["SERVER_NAME"]?><?=$_SERVER["REQUEST_URI"]?>"></a> 
```

我们需要修改按钮，所以说“分享这个产品”而不是仅仅分享。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:27:33.170

不推荐使用“共享”按钮，而应使用“提要”对话框以及您自己的自定义按钮设计。这是一个例子：

`<a href="https://www.facebook.com/dialog/feed?app_id=123050457758183&link=https://developers.facebook.com/docs/reference/dialogs/&picture=http://fbrell.com/f8.jpg&name=Facebook%20Dialogs&caption=Reference%20Documentation&description=Using%20Dialogs%20to%20interact%20with%20users.&redirect_uri=http://www.example.com/response">Share this product</a>`

显示为：

[分享这个产品](https://www.facebook.com/dialog/feed?app_id=123050457758183&link=https://developers.facebook.com/docs/reference/dialogs/&picture=http://fbrell.com/f8.jpg&name=Facebook%20Dialogs&caption=Reference%20Documentation&description=Using%20Dialogs%20to%20interact%20with%20users.&redirect_uri=http://www.example.com/response)

如您所见，它真的很容易创建并且实际上是受支持的，所以我强烈建议切换。

# matlab - MATLAB：将逗号分隔的单个单元格转换为多个单元格数组，同时使用 textscan 保持 UTF-8 编码

> ID：11636123
> 
> 赞同：1
> 
> 时间：2012-07-24T17:25:14.187
> 
> 标签：matlab, file-io, csv, utf-8, textscan

从一开始就。

我在 csv 文件中有数据，例如：

```
La Loi des rues,/m/0gw3lmk,/m/0gw1pvm
L'Étudiante,/m/0j9vjq5,/m/0h6hft_
The Kid From Borneo,/m/04lrdnn,/m/04lrdnt,/m/04lrdn5,/m/04lrdnh,/m/04lrdnb 
```

等等

这是 UTF-8 格式。我按如下方式导入此文件（取自其他地方）：

```
feature('DefaultCharacterSet','UTF-8');
fid = fopen(filename,'rt');         %# Open the file
  lineArray = cell(100,1);          %# Preallocate a cell array (ideally slightly
                                    %# larger than is needed)
  lineIndex = 1;                    %# Index of cell to place the next line in
  nextLine = fgetl(fid);            %# Read the first line from the file
  while ~isequal(nextLine,-1)       %# Loop while not at the end of the file
  lineArray{lineIndex} = nextLine;  %# Add the line to the cell array
  lineIndex = lineIndex+1;          %# Increment the line index
  nextLine = fgetl(fid);            %# Read the next line from the file
end
fclose(fid);                        %# Close the file 
```

这将创建一个包含 UTF-8 文本的数组。{3x1} 数组：

```
'La Loi des rues,/m/0gw3lmk,/m/0gw1pvm'
'L''Étudiante,/m/0j9vjq5,/m/0h6hft_'
'The Kid From Borneo,/m/04lrdnn,/m/04lrdnt,/m/04lrdn5,/m/04lrdnh,/m/04lrdnb' 
```

现在下一部分将每个值分成一个数组：

```
lineArray = lineArray(1:lineIndex-1);              %# Remove empty cells, if needed
  for iLine = 1:lineIndex-1                        %# Loop over lines
    lineData = textscan(lineArray{iLine},'%s',...  %# Read strings
                        'Delimiter',',');
    lineData = lineData{1};                        %# Remove cell encapsulation
    if strcmp(lineArray{iLine}(end),',')           %# Account for when the line
      lineData{end+1} = '';                        %# ends with a delimiter
    end
    lineArray(iLine,1:numel(lineData)) = lineData; %# Overwrite line data
  end 
```

这输出：

```
'La Loi des rues'   '/m/0gw3lmk'    '/m/0gw1pvm'    []  []  []
'L''�tudiante'  '/m/0j9vjq5'    '/m/0h6hft_'    []  []  []
'The Kid From    Borneo'    '/m/04lrdnn'    '/m/04lrdnt'    '/m/04lrdn5'    '/m/04lrdnh'    '/m/04lrdnb' 
```

问题是 UTF-8 编码丢失了`textscan`（注意我现在得到的问号，而在前面的数组中它很好）。

问题：在将 {3x1} 数组转换为 3xN 数组时，如何维护 UTF-8 编码。

我找不到任何关于如何将 UTF-8 编码保存`textscan`在工作区中已有的数组中的信息。一切都与导入我没有问题的文本文件有关 - 这是第二步。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:52:43.783

试试下面的代码：

```
%# read whole file as a UTF-8 string
fid = fopen('utf8.csv', 'rb');
b = fread(fid, '*uint8')';
str = native2unicode(b, 'UTF-8');
fclose(fid);

%# split into lines
lines = textscan(str, '%s', 'Delimiter','', 'Whitespace','\n');
lines = lines{1};

%# split each line into values
C = cell(numel(lines),6);
for i=1:numel(lines)
    vals = textscan(lines{i}, '%s', 'Delimiter',',');
    vals = vals{1};
    C(i,1:numel(vals)) = vals;
end 
```

结果：

```
>> C
C = 
    'La Loi des rues'        '/m/0gw3lmk'    '/m/0gw1pvm'              []              []              []
    'L'Étudiante'            '/m/0j9vjq5'    '/m/0h6hft_'              []              []              []
    'The Kid From Borneo'    '/m/04lrdnn'    '/m/04lrdnt'    '/m/04lrdn5'    '/m/04lrdnh'    '/m/04lrdnb' 
```

请注意，当我对此进行测试时，我将输入 CSV 文件编码为*“没有 BOM 的 UTF-8”*（我使用 Notepad++ 作为编辑器）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:48:35.203

尝试使用以下`fopen`命令而不是您当前的命令。它为文件指定 UTF-8 编码。

`f = fopen(filename,'rt', 'UTF-8');`

您也可以使用它来缩短一些代码：

```
text = fscanf(f,'%c');
Lines = textscan(text,'%s','Delimiter',','); 
```

这可能有助于减轻您在那里进行的一些预分配。

# scala - 使用这些集合中元素的增量阴影计算每个元素上的函数的最佳方法

> ID：11636124
> 
> 赞同：2
> 
> 时间：2012-07-24T17:25:15.663
> 
> 标签：scala, collections, map, slice

使用每个元素的增量阴影计算集合中每个元素的函数的最佳方法是什么，例如这个简单的示例：

```
val v = IndexedSeq(1,2,3,4)

v.shadowMap{ e => e + 1}

shadow 1: (3,4,5)
shadow 2: (2,4,5)
shadow 3: (2,3,5)
shadow 4: (2,3,4) 
```

我认为首先要`patch`或`slice`要做到这一点，但也许有更好的纯功能风格来做到这一点？

谢谢先生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T20:22:32.103

```
def shadowMap[A,B](xs: Seq[A])(f: A => B) = {
  val ys = xs map f
  for (i <- ys.indices; (as, bs) = ys splitAt i) yield as ++ bs.tail
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:03:13.403

你可以这样定义它：

```
class ShadowMapSeq[A, Repr <: Seq[A]](seq: SeqLike[A, Repr]) {
  def shadowMap[B, That](f: A => B)(implicit bf: CanBuildFrom[Repr, B, That]): Iterator[That] = {
    seq.indices.iterator.map { i =>
      val b = bf(seq.asInstanceOf[Repr])
      b.sizeHint(seq.size - 1)
      b ++= (seq.take(i) ++ seq.drop(i + 1)).map(f)
      b.result
    }
  }
}
implicit def shadowMapSeq[A, Repr <: Seq[A]](seq: SeqLike[A, Repr]) = new ShadowMapSeq(seq) 
```

然后像这样使用它：

```
scala> val v = IndexedSeq(1, 2, 3, 4)
scala> val results = v.shadowMap(_ + 1)
scala> results foreach println
Vector(3, 4, 5)
Vector(2, 4, 5)
Vector(2, 3, 5)
Vector(2, 3, 4) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:34:12.747

如果“纯功能风格”的意思是“不参考索引”（因为你说你想避免`patch`and ），你可以用[zippers](http://en.wikipedia.org/wiki/Zipper_%28data_structure%29)`slice`优雅地做到这一点。例如，这里是如何用[Scalaz 的 zipper 实现](http://scalaz.github.com/scalaz/scalaz-2.9.1-6.0.4/doc.sxr/scalaz/Zipper.scala.html)编写它（这只是一个演示——如果你想把它包装得更好，你可以使用 dhg 在他的回答中给出的方法）：

```
import scalaz._, Scalaz._

List(1, 2, 3, 4).map(_ + 1).toZipper.map(
   _.positions.map(p => (p.lefts.reverse ++ p.rights).toList).toStream
).flatten 
```

一般来说，在实际代码中使用 dhg 的解决方案可能会更好，但 zipper 是一个方便了解的数据结构，它非常适合这个问题。

# mysql - 外键上的 Django IntegrityError 重复条目

> ID：11636127
> 
> 赞同：1
> 
> 时间：2012-07-24T17:25:18.640
> 
> 标签：mysql, django, django-models, foreign-keys

我在 django 上遇到了一个带有一组外键关系的重复键完整性错误的细微错误。

我有以下功能：

```
def update_relationship(actor, action, status, target):
  existing = Relation.objects.filter(actor=actor, target=target)

  # If this relation is 'on', turn it off
  if Relation.objects.filter(actor=actor, target=target, status=status):
    Relation.objects.filter(actor=actor, target=target).update(status="")
  # If this relationship is not on, turn it on
  else:
    created = True
    if existing:
      existing.update(status=status)
    else:
      Relation.objects.create(actor=actor, target=target, status=status) 
```

如您所见，我正在测试该关系是否已存在于数据库中，如果存在则更新它，如果不存在则创建一个新行。但是，似乎在某些我无法重现的情况下，Django 给了我一个重复的键错误，即使在据我所知只有一个实例的情况下也是如此。

作为参考，这里是模型定义：

```
class Relation(models.Model):
  Status = Choices(('L', 'Like', 'Like'), 
                   ('D', 'Dislike', 'Dislike'), 
                   ('S', 'Save', 'Save'))
  actor     = models.ForeignKey('members.Member', related_name='relations')
  target    = models.ForeignKey('members.Member', related_name='reverse_relations')
  status    = models.CharField(choices=Status, max_length=10)
  created   = models.DateTimeField('created', auto_now_add=True)

  notified        = models.BooleanField(default=False)
  notified_mutual = models.BooleanField(default=False)

  class Meta:
    unique_together = (('actor', 'target'),)
    ordering = ('created',)
    verbose_name = 'Relation'
    verbose_name_plural = 'Relations' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:28:58.563

首先，检查是否[存在](https://docs.djangoproject.com/en/dev/ref/models/querysets/#exists)的正确表达式是：

```
existing = Relation.objects.filter(actor=actor, target=target).exists() 
```

但是 djano 编写句子的方法是使用[get_or_create](https://docs.djangoproject.com/en/dev/ref/models/querysets/#get-or-create)方法，这是您正在寻找的方法：

```
Relation.objects.get_or_create(actor=actor, target=target, 
                                 defaults={ 'status':status }
                              ) 
```

或者，对于您的情况，类似：

```
r, _ = Relation.objects.get_or_create(actor=actor, target=target )
r.status = '' if r.status == 'on' else status
r.save() 
```

# visual-studio-2010 - 如何让 ToolStripDropDownButton 与 StatusStrip 的右边缘对齐？

> ID：11636132
> 
> 赞同：0
> 
> 时间：2012-07-24T17:25:43.553
> 
> 标签：visual-studio-2010, statusstrip, toolstripbutton, toolstripdropdown

我在 StatusStrip 或 ToolStripDropDownButton 上看不到可能的属性 - 除了 ToolStripDropDownButton 的 Alignment 属性，这没有帮助。

我是否必须添加“垫片”/垫片或类似的东西才能将 ToolStripDropDownButton 肘部远离左边缘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:10:33.097

我不知道这是否是最好的方法，但我添加了一个 toolStripStatusLabel，并将其 Spring 属性设置为 True 并将其 Text 属性设置为 [空白]。

它有效，所以我想它很好......

# bash - 使用 Unix find 计算和删除旧文件

> ID：11636133
> 
> 赞同：2
> 
> 时间：2012-07-24T17:25:46.423
> 
> 标签：bash, unix, ksh

我想删除`$DIR_TO_CLEAN`几天前的文件`$DAYS_TO_SAVE`。简单的：

```
find "$DIR_TO_CLEAN" -mtime +$DAYS_TO_SAVE -exec rm {} \; 
```

我想我们可以为 添加一个`-type f`或一个`-f`标志`rm`，但我真的很想计算被删除的文件数量。

我们可以天真地这样做：

```
DELETE_COUNT=`find "$DIR_TO_CLEAN" -mtime +$DAYS_TO_SAVE | wc -l`
find "$DIR_TO_CLEAN" -mtime +$DAYS_TO_SAVE -exec rm {} \; 
```

但是这个解决方案还有很多不足之处。除了命令重复之外，如果`rm`删除文件失败，此代码段还会高估计数。

我对重定向、管道（包括命名管道）、子shell、 、 等非常满意`xargs`，`tee`但我渴望学习新技巧。我想要一个适用于 bash 和 ksh 的解决方案。

**您如何计算被删除的文件数`find`？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:46:21.310

我会避免`-exec`并寻求管道解决方案：

```
find "$DIR_TO_CLEAN" -type f -mtime +$DAYS_TO_SAVE -print0 \
| awk -v RS='\0' -v ORS='\0' '{ print } END { print NR }'  \
| xargs -0 rm 
```

用于`awk`计算匹配并将它们传递给`rm`.

### 更新：

*kojiro*让我意识到上述解决方案不计算`rm`. 与`awk`命名错误的文件一样，我认为以下`bash`解决方案可能会更好：

```
find "${DIR_TO_CLEAN?}" -type f -mtime +${DAYS_TO_SAVE?} -print0 |
(
  success=0 fail=0
  while read -rd $'\0' file; do 
  if rm "$file" 2> /dev/null; then 
    (( success++ ))
  else
    (( fail++ ))
  fi
  done
  echo $success $fail
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:39:38.817

# java - hibernate 中的一对多映射：将两个不同的属性引用到单个列

> ID：11636136
> 
> 赞同：0
> 
> 时间：2012-07-24T17:25:52.007
> 
> 标签：java, hibernate, one-to-many, hibernate-mapping

【这个场景是为了说明】
我有一些产品，每个产品都可以有评论。评论有两种类型，**一般评论**（GC）和**产品评论**（PC）。

*样品表*

> **产品**
> 
> 身份证名称
> 
> * * *
> 
> 1个苹果

--

> **PRODUCT_COMMENTS**
> 
> COMMENT_ID | 评论 | COMMENT_TYPE
> 
> * * *
> 
> 1 | IPHONE 不错 | 个人电脑
> 
> 2 | IPAD 看起来不错 |GC
> 
> 3 | 一般评论| GC
> 
> 4 | 产品评论 |PC

假设 Product 表到 Product_comment 表有一个外键。

我有几个类映射到这些表。

产品类和 ProductComment 类

Product 类与 ProductComment 类具有一对一的关系。

```
 public class Product {
     private Long id;

     private String productName;

     private List<ProductComments> productComments;

     private List<ProductComments> generalComments;

    .....

   } 
```

现在我的问题是， **有两个单独的评论列表**（由comment_type 区分）。

当我说

```
 Product p = (Product)session.load(Product.class, new Long(1)); 
```

**是否可以正确获取 generalComments 和 productComments**？在上面的例子中

generalComments 列表应包含 ['IPAD LOOKS GOOD','GENERAL COMMENT']，productComments 列表应包含 ['IPHONE IS GOOD','PRODUCT COMMENT']。

应该做什么样的映射来实现上述事情？

编辑 ：

我们使用 Hibernate 3.0 和 hbm 映射文件（不是注释）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:35:07.437

使用[@Where](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/annotations/Where.html)注释。您可以提供 SQL 条件来限制将选择哪些条件。在您的示例中，大致如下：

```
@Where(clause="COMMENT_TYPE = 'PC'")
private List<ProductComments> productComments;

@Where(clause="COMMENT_TYPE = 'GC'")
 private List<ProductComments> generalComments; 
```

请注意，此限制值是从数据库加载的，而不是写入这些列表的值。您仍然可以通过程序逻辑控制将哪种注释写入这些列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T07:39:26.250

在这种情况下，为了可读性和类型安全，我会选择使用继承。这意味着，创建`Comment.class` `GeneralComment.class`和`ProductComment.class`. 您可以选择 2 种方式来处理层次结构：

1.  实际继承。每个类代表一个由 PK 连接的等效表。
2.  对象继承。使用鉴别器列将`Comment.class`值区分为其他两个实体：

在`Comment.class`：

`<discriminator column="discriminator_column" type="discriminator_type" force="true|false" insert="true|false" formula="arbitrary sql expression" />`

在每个子类上：

`<subclass name="ClassName" discriminator-value="discriminator_value" proxy="ProxyInterface" lazy="true|false" dynamic-update="true|false" dynamic-insert="true|false" entity-name="EntityName" node="element-name" extends="SuperclassName"> <property .... /> ..... </subclass>`

现在您的代码可能如下所示：

```
public class Product {
 private Long id;

 private String productName;

 private List<ProductComments> productComments;

 private List<GeneralComments> generalComments;

..... 
```

}

# javascript - 如何改善使用 JQuery Mobile 的 Android WebView 的加载时间？

> ID：11636139
> 
> 赞同：0
> 
> 时间：2012-07-24T17:26:07.653
> 
> 标签：javascript, android, jquery-mobile, webview

我目前正在编写一个应用程序（完全脱机运行），它使用 HTML 在 WebView 中向用户显示表单。我喜欢使用 JQuery Mobile 来编写这些表单，但是当我使用它时，WebView 需要大约 3 秒才能加载，这对于我正在使用的应用程序来说太长了。这是在运行 Android 2.3.3 的 Nexus S 上。

我自己对这个问题进行了一些调查，似乎时间花在了加载 JQuery、JQuery Mobile 和他们的 CSS 文件上。一旦加载了 JS，渲染实际上并不需要那么长时间，我有非常简单的页面。

由于我将所有这些库用于我向用户显示的所有表单，有没有办法将 javascript 保留在 RAM 中或使用预加载的缓存文件来加速 JQuery Mobile HTML 页面的加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:31:29.650

除非您更改了默认设置，否则 WebView 将自动缓存文件。

确保您的文件位于 CDN 上。确保您的 CDN 为内容项设置了合理的 TTL 值。

# json - 从 JSON 流中请求特定的 JSON 字典

> ID：11636144
> 
> 赞同：0
> 
> 时间：2012-07-24T17:26:27.610
> 
> 标签：json, parsing, rest, dictionary, webrequest

这是一个抽象的问题，所以如果它不适合这里，请原谅我。我想知道是否有一种标准方法可以查询特定子词典的 JSON 流，而不是让流一次返回其所有内容。我希望我可以使用 URL 中的参数来执行此操作，但我不确定是否有用于进行此类查询的标准化方法。

任何建议都会很棒。谢谢！

# sql-server-2008 - SQL Server：Replace 函数是如何工作的，因为它对我来说很奇怪

> ID：11636147
> 
> 赞同：0
> 
> 时间：2012-07-24T17:26:43.197
> 
> 标签：sql-server-2008, tsql, replace

我正在对 SQL Server 表中的一些字符串进行“随机化”，以对它们进行原始加密。

我有一个嵌套的 SQL 替换函数大约 35 次（AZ，1-9），它基本上采用字母表和数字中的每个字母并将其替换为另一个字母或数字。其中的例子是

```
Replace(Replace(Replace('a', 'c'), 'b', 'a'), 'c', 'b') 
```

我认为替换功能会通过像'abc'这样的字符串并替换所有内容并停止 - 'cab'。它没有！

似乎想再次更改一些字符导致`'abc'->'cab'->'ccb'`.

这很好，除非我有另一个名为“aac”的字符串，这可能会导致重复的字符串，并且我会失去对原始的可追溯性。

谁能解释我如何阻止 REPLACE() 部分返回我的字符串？

```
SELECT * INTO example_temp FROM example;
Update KAP_db.dbo.example_temp Set col1 = replace(replace(replace(replace(replace(
replace(replace(replace(replace(replace(‌​replace(replace(replace(replace(replace(
replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(
replace‌​(replace(replace(replace(replace(replace(replace(replace(replace(replace(
col1, 'A', 'N'),'B', 'O'), 'C', 'P'), 'D', 'Q'), 'E', 'R'), 'F', 'S'), 'G', 'T'),
'H', 'U'), 'I', 'V'), 'J', 'W'), 'K', 'X'), 'L', 'Y'), 'M', 'Z'), 'O', 'A'), 'P', 'B'),
'Q', 'C'), 'R', 'D'),'S', 'E'),'T', 'E'),'U', 'E'),'V', 'F'),'W', 'G'),'X', 'H'),
'Y', 'I'),'Z', 'J'), '1', '9'),'2','8'),'3','7'),'4','6'),'5','5'),'6','4'),'7','3'),
'8','2'),'9','1'),' ',''); 
```

以上结果导致“8EVHUAB”和“8EVHHAB”都输出“2DFEENA”

更新 - - - - - - - - - - - - - - - - - - - - - - - - - ------------------

好的，我已经重做了代码，到目前为止有：

```
 DECLARE @Input AS VarChar(1000)
 DECLARE @i AS TinyInt
 Declare @Substring AS VarChar(1000)
 Declare @Prestring  AS VarChar(1000)
 Declare @Poststring  AS VarChar(1000)

 Select @Input='ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789'

 SELECT @i = 1
 Select @Substring ='na'
 WHILE @i <= LEN(@Input) BEGIN

Select @Prestring = SUBSTRING(@Input,-1,@i)
Select @Poststring = SUBSTRING(@Input,@i+1,LEN(@Input))

 SELECT @Substring =  replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace
(SUBSTRING(@Input,@i,1), 'A', 'N'),'B', 'O'), 'C', 'P'), 'D', 'Q'), 'E', 'R'), 'F', 'S'), 'G', 'T'), 'H', 'U'), 'I', 'V'), 'J', 'W'), 'K', 'X'), 'L', 'Y'), 'M', 'Z'), 'N', 'A'), '0', 'B'), 'P', 'C')
, 'Q', 'D'),'R', 'E'),'S', 'E'),'T', 'E'),'U', 'F'),'V', 'G'),'W', 'H'),'X', 'I'),'Y', 'J'), '1', '9'),'2','8'),'3','7'),'4','6'),'5','5'),'6','4'),'7','3'),'8','2'),'9','1'),' ','')

Select @Input = @Prestring + @Substring + @Poststring

 SELECT @i = @i + 1

 print 'END
 '

 END 
```

但是，这不能正常工作，代码没有按其编写的那样执行，有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T19:21:17.740

*为什么你会看到这个：* `replace`是一个函数；它所知道的只是它的论点。`replace(replace('aba', 'a', 'b'), 'b', 'a')`绝对等价于`replace('bbb', 'b', 'a')`，因为外部`replace`无法知道它的第一个参数是由对 的不同调用创建的`replace`。那有意义吗？

你可以把它想象成代数中的一个函数。如果我们定义 f(x) = x ²，则 f(f(2)) = f(2 ² ) = f(4) = 4 ² = 16。当参数为 f 时，无法告诉 f 表现不同(2) 从它的参数是 4 开始，因为 f(2)*是*4。

同样，`replace('aba', 'a', 'b')` *is* `'bbb'`，所以没有办法告诉它的第一个参数是什么`replace`时候的行为不同于它的第一个参数是`replace('aba', 'a', 'b')`什么时候的行为`'bbb'`。

（这在计算机科学中通常是正确的。计算机科学中的函数并不总是像代数中的函数——例如，它们经常实际*做事*，而不仅仅是返回一个值——但通常情况下它们接收参数作为值，或者作为对值的不透明引用，并且无法知道它们来自哪里或它们是如何构造的。）

*如何解决这个问题：*我认为没有任何非常干净的方法可以做到这一点。Gordon Linoff 建议您可以使用初始字符串中不存在且最终字符串中不存在的中间占位符（特别是小写字母），这样您就可以安全地`replace`使用它们而不必担心干扰；我认为这可能是最好的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T17:43:14.403

您的结果并不令人惊讶，因为每次替换都会将字符串返回到下一个级别。当它们是相同的字符时，无法区分原始字符值和替换值。

如果您只使用字母字符，则可以执行以下操作。

1.  更改原始字符串的排序规则。
2.  大写字符串
3.  用小写字母替换大写字母
4.  最后将整个字符串小写（应该是多余的）

不幸的是，我想不出一个可以以同样方式工作的数字的模拟。

这是一个网站的链接，该网站包含函数[http://www.dbforums.com/microsoft-sql-server/1216565-oracle-translate-function-equivalent-sql-server.html](http://www.dbforums.com/microsoft-sql-server/1216565-oracle-translate-function-equivalent-sql-server.html)的代码。Oracle 中的等效函数称为 translate。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T19:19:09.937

该`Replace()`函数只是执行操作并返回。它不会保持状态到下一个`Replace()`。它不会阻止以后的调用替换您之前替换的字符。要循环字符，您必须有一个额外的“占位符”值，然后注意不要替换已经从其他内容更改的字符。

首先，让我给你打个比方：

三个桶装满了相同数量的弹珠。这些桶被标记为“A”、“B”和“C”。您必须执行以下说明：

*   将 A 中的所有弹珠倒入 C 中。
*   将 B 中的所有弹珠倒入 A 中。
*   将 C 中的所有弹珠倒入 B 中。

你希望得到什么结果？答案是：一个空桶 C，B 的弹珠数量是 A 的两倍。

如果您想保留原始数量的弹珠，则必须有四个容器，以免在移动弹珠时混合它们：

*   将 C 中的所有弹珠倒入 X 中。
*   将 A 中的所有弹珠倒入 C 中。
*   将 B 中的所有弹珠倒入 A 中。
*   将 X 中的所有弹珠倒入 B 中。（而不是从 C 中——已经有 A 的弹珠）

现在你得到了你期望的结果，并且可以丢弃空桶 X。

试试这个表达式，看看它是否给出了你想要的：

```
Replace(Replace(Replace(Replace('c', char(1)), 'a', 'c'), 'b', 'a'), char(1), 'b') 
```

# java - Java - 密码策略验证

> ID：11636148
> 
> 赞同：-3
> 
> 时间：2012-07-24T17:26:47.393
> 
> 标签：java, regex, validation, web

在我的 Web 应用程序中，我有以下要求。用户首次注册时设置密码时，我有以下限制。

1.  密码应包含 6 位数字。（例如 132715）
2.  只能输入数字
3.  不允许升序/降序数字（例如 123456、654321 - 不允许）
4.  3 个（或更多）相同的数字不能重复（例如 121715、232254 - 不允许）。

任何人都可以澄清这是否可以通过正则表达式来完成，或者通过Java实现更好。如果可能的话，谁能给我一个示例代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:31:40.387

有这么多限制，我认为您应该使用 Java 验证这一点。
您可以使用Apache Commons 的[StringUtils](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html)来帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:51:47.197

你的问题似乎很有趣，所以我想我会试一试。这应该做你正在寻找它做的事情，尽管我没有彻底测试它。那里可能有更简单的解决方案。

```
private static boolean validatePW(String pw) {
    if(pw.length() == 6){
        int pwInt = Integer.MIN_VALUE;
        try{
            pwInt = Integer.parseInt(pw);
            char[] values = pw.toCharArray();
            boolean asc = true;
            boolean dec = true;
            int[] map = new int[10];
            map[values[0]-48] = 1;
            for(int i = 1; i < values.length; i++){
                asc = asc && values[i] - 1 == values[i-1];
                dec = dec && values[i] + 1 == values[i-1];
                map[values[i]-48] ++;
                if(map[values[i]-48] == 3){return false;}
            }
            if(asc || dec){
                return false;
            } else {
                return true;
            }
        } catch(NumberFormatException e){
            return false;
        }
    }
    return false;
} 
```

# asp.net - 在 aspx 页面的同一占位符中将 usercontrol1 替换为 usercontrol2，并使用 usercontrol1 中的按钮

> ID：11636149
> 
> 赞同：0
> 
> 时间：2012-07-24T17:26:49.797
> 
> 标签：asp.net, .net

我可以用主aspx页面中的按钮替换同一占位符中的用户控件。但是如何用用户控件中的按钮替换同一占位符中的用户控件。

例如，我加载了 usercontrol1，并且在控件内有一个按钮，我想在同一个占位符中更改为 usercontrol2..

所以我有 usercontrol1 带有用于 usercontrol2 和 usercontrol3 的按钮 我有 usercontrol2 带有用于 usercontrol1 和 3 的按钮 & 我有 usercontrol3 带有用于 usercontrol1 和 2 的按钮..

我想在这些控件之间移动..使用控件中的按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:41:03.157

在您的用户控件中添加事件处理程序并相应地在页面上使用[用户控件的单击事件](http://www.codeproject.com/Articles/33874/Capture-Button-s-Click-Event-of-User-Control-in-th)（通过隐藏/取消隐藏其他控件或[创建运行时控件](https://stackoverflow.com/questions/9069347/how-to-add-user-control-on-run-time-in-asp-net-solved)）。

# c# - 从列表框中读取文件

> ID：11636153
> 
> 赞同：0
> 
> 时间：2012-07-24T17:27:19.460
> 
> 标签：c#, winforms, listbox

我有一些代码可以根据用户选择的目录将完整的文件名（例如 F:\logs\1234.log）加载到列表框中。当用户选择一个或多个文件并单击输出按钮时，我希望代码通读每个选定的文件。之前，我使用的是组合框和代码：

```
StreamReader sr = new StreamReader(comboBox1.Text); 
```

这显然不适用于列表框。让程序从列表框中读取用户选择的文件的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:34:37.820

您应该在原始问题中更清楚......但如果您需要阅读所有文件：

```
 var items = listBox.SelectedItems;
        foreach (var item in items)
        {
            string fileName = listBox.GetItemText(item);
            string fileContents = System.IO.File.ReadAllText(fileName);
            //Do something with the file contents
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:34:48.583

如果您选择每次打开一个文件，则解决方案如下：

```
string[] files = Directory.GetFiles(@"C:\");
listBox1.Items.Clear();
listBox1.Items.AddRange(files); 
```

然后，要获得选择的文件路径：

```
if (listBox1.SelectedIndex >= 0)
{ // if there is no selectedIndex, property listBox1.SelectedIndex == -1
       string file = files[listBox1.SelectedIndex];
       FileStream fs = new FileStream(file, FileMode.Open);
       // ..
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:47:56.657

您可以做什么来创建一个通用列表，该列表将包含所选文件中的所有文本：

```
 void GetTextFromSelectedFiles()
    {
        List<string> selectedFilesContent = new List<string>();
        for (int i = 0; i < listBox1.SelectedItems.Count; i++)
        {
            selectedFilesContent.Add(ReadFileContent(listBox1.SelectedItems.ToString()));
        }

        //when the loop is done, the list<T> holds all the text from selected files!
    }

    private string ReadFileContent(string path)
    {
        return File.ReadAllText(path);
    } 
```

我认为在您的示例中，当您明确表示“尽可能简单”来读取文件时，最好使用**File.ReadAllText()**方法，而不是使用 StreamReader 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T17:50:20.273

要访问 ListBox 中的所有选定项目，您可以使用 SelectedItems 属性：

```
foreach (string value in listBox1.SelectedItems)
{
    StreamReader sr = new StreamReader(value);
    ...
} 
```

# visual-foxpro - 在 Win 7 64 位机器上运行 32 位编译的 Visual Foxpro App

> ID：11636159
> 
> 赞同：0
> 
> 时间：2012-07-24T17:27:37.093
> 
> 标签：visual-foxpro

下午好，我有一个继承的（从国外程序员那里）Visual FoxPro 32 位应用程序，我必须让它在 Windows 7 64 位 PC 上运行，一旦我尝试运行它，它会显示一条消息，上面写着（“这个程序的版本与您拥有的 Windows 版本不同") 。我从 Microsoft 页面搜索并安装了 VisualFoxPro 9 和 Visual Fox Pro 的 SP 2，但似乎只要应用程序是在 32 位平台上编译的，它就不能在 64 位机器上运行，关于这个问题的任何建议都是非常感激。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T23:41:28.853

确保您安装了正确的运行时。你知道它是在哪个版本的 VFP 中编译的吗？

VFP 有以下版本，每个版本都有自己的运行时：

*   工作计划 2.6a
*   VFP 3
*   VFP 5
*   VFP 6
*   VFP 7
*   VFP 8
*   VFP 9
*   VFP 9 SP2

如果您确定安装了正确的运行时，您确定它是在 Visual FoxPro 中构建的，而不是在较旧的 FoxPro 2.X 中构建的吗？那将是 16 位，运行这些版本会有些麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-23T17:18:54.903

亲爱的首先右键单击设置或安装文件然后转到属性然后兼容性选项卡并选择单击更改所有用户的设置然后在复选框中选择兼容模式以兼容模式运行此程序以选择Windows XP（服务包 2) 祝你好运，这是一种经过测试且成功的方法

# python - python while循环的问题

> ID：11636162
> 
> 赞同：1
> 
> 时间：2012-07-24T17:27:52.783
> 
> 标签：python

如果这是一个荒谬的问题，我很抱歉，但我只是在学习 python，我无法弄清楚。:)

我的程序应该打印用户输入的任何状态的首都。有时会连续工作十次，有时会连续工作三次，然后在你输入一个状态后它就会停止。如果我重新启动它并输入它停止的状态，它将正常工作....随机次数，然后它会再次停止。我究竟做错了什么？我的代码也很糟糕吗？我不知道要使用什么样的代码，所以我只是把我能做的任何事情都扔进去了。

```
 x = str(raw_input('Please enter a sate: ' ))
    while x == 'Alabama':
        print 'Montgomery is the capital of', x
        x = str(raw_input('Please enter a state: '))
    while x ==  'Alaska':
        print 'Juneau is the capital of', x
        x = str(raw_input('Please enter a state: '))                  
    while x == 'Arizona':
        print 'Phoenix is the capital of', x
        x = str(raw_input('Please enter a state: ' ))
    while x == 'Arkansas':
        print 'Little Rock is the capital of', x
        x = str(raw_input('Please enter a state: '))' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:31:31.957

1.  您的意思是在一个大循环中使用多个`if`语句`while`，而不是多个`while`循环。在这段代码中，一旦你通过了一个 while 循环，你就再也不会回到它了。*仅*当您按字母顺序为其提供州名称时，此代码才有效。

2.  *不要这样做！*使用 python[字典](http://docs.python.org/tutorial/datastructures.html#dictionaries)有*更好*的方法。

    ```
    capitals = {"Alabama": "Montgomery", "Alaska": "Juneau", "Arizona": "Phoenix", "Arkansas": "Little Rock"}
    while True:
        x = str(raw_input('Please enter a state: ' ))
        if x in capitals:
            print capitals[x], "is the capital of", x 
    ```

否则，如果你想覆盖所有 50 个州，你最终会得到 50 对几乎相同的线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:31:40.653

我认为您不了解`while`循环。基本上，

```
while condition:
    dostuff() 
```

在条件为真时做事。一旦条件为假，您就继续前进。我认为你正在寻找的是这样的：

```
x=True
while x 
   x=raw_input('please enter a state'):
   if x == 'Alabama':
      ...
   elif x == 'Alaska':
      ... 
```

这将永远循环，直到用户按下回车键（`bool('')`在`False`python 中）

但是，更好的方法是使用字典：

```
state_capitals={'Alabama':'Montgomery', 'Alaska':'Juneau'}
x=True
while x 
   x=raw_input('please enter a state'):
   print '{0} is the capital of {1}'.format(state_capitals[x],x) 
```

通过这种方式，它会`KeyError`在给出坏资本时引发 a（如果你愿意，你可以使用`try`块来捕获）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:33:43.737

老实说，这比可怕的要糟糕*得多*。但是，您很可能是初学者，因此会发生这种情况。

对于此任务，您应该使用`dict`包含 country=>capital 映射的 a 并读取国家名称*一次*：

```
capitals = {'Alabama': 'Montgomery',
            'Alaska': 'Juneau',
          ...}
state = raw_input('Please enter a state: ')
if(state in capitals):
    print '{0} is the capital of {1}'.format(capitals[state], state)
else:
    print 'Sorry, but I do not recognize {0}'.format(state) 
```

如果您想使用`while`循环以便用户可以输入多个状态，您可以将整个代码包装在一个`while True:`块中，并在用户未输入任何内容时`if not state: break`在该行之后使用来中断循环。`raw_input`

# iphone - 将图像保存在 Core Data 中以供 UITableView 使用

> ID：11636165
> 
> 赞同：3
> 
> 时间：2012-07-24T17:27:59.960
> 
> 标签：iphone, ipad, optimization, core-data

我计划构建一个主要内容是图像的应用程序。基本上，它将有多个使用 的菜单`UITableViews`，其单元格将只有一个图像。当您单击单元格时，您将被推送到一个包含该图像的简单视图和另一个包含其余详细内容的视图。

这一切都很容易做到，我的问题是关于优化的。它会有很多内容（可能有 1k 行）并且会在`UITableView`.

我的问题是：最好将图像存储在`Core Data`数据库中（as `NSData`）还是只存储图像的名称？我想象的是，如果我存储资源的名称，对于`UITableView`设备中的每一行都必须去获取该图像，处理它最终显示它。当滚动浏览它们时（预计会发生很多），我们会有很多获取图像。如果我将它们存储在 中`Core Data`，那么就像获取该信息并使用它一样简单，就好像它在图像中一样。

将图像存储在其中的好处是`Core Data`在数据库中存储 blob 的正常撤回。我不知道这在 Core Data 中会有多大的问题（我在 dbs 方面的经验主要来自 MySQL）

另一方面，强硬的我的“常识”要求只保存名称并在需要时获取图像，如果要求更多，则需要更多时间，我不确定这会对性能造成多大影响是。有没有“最好的方法”来存储它们？只是名称，然后调用`pathForResourse:ofType:`或（如果它更快）`pathForResourse:ofType:inDirectory:`，`mainBundle`存储 URI，或其他形式的指向它。

**编辑**：应用程序将具有随应用程序提供的静态内容，用户将无法以任何方式修改此内容。（至少在 1.0 版中）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:38:13.173

来自[iOS v5.0 的核心数据发行说明](https://developer.apple.com/library/IOS/#releasenotes/DataManagement/RN-CoreData/_index.html)：

> 像图像缩略图这样的小数据值可以有效地存储在数据库中，但大照片或其他媒体最好直接由文件系统处理。您现在可以指定托管对象属性的值可以存储为外部记录 - 请参阅 setAllowsExternalBinaryDataStorage:。启用后，Core Data 会根据每个值试探性地决定是直接将数据保存在数据库中还是将 URI 存储到它为您管理的单独文件中。如果使用此选项，则无法根据二进制数据属性的内容进行查询。

setAllowsExternalBinaryDataStorage: 基本上做了你所描述的“......只是存储图像的名称......”

另请参阅这些其他问题：

1.  [CoreData：是否将图像存储到数据库？](https://stackoverflow.com/questions/2573072/coredata-store-images-to-db-or-not/2573113#2573113)
2.  [从桌面到 iPhone 的核心数据图像](https://stackoverflow.com/questions/2271195/core-data-images-from-desktop-to-iphone/2274916#2274916)
3.  [请举例说明为什么不建议将图像存储在 CoreData 中？](https://stackoverflow.com/questions/10848147/provide-example-for-why-it-is-not-advisable-to-store-images-in-coredata)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:34:06.793

只需使用文件名，您将获得很好的优化...

如果你重用一个文件......你不必将它存储在数据库中两次，或者有一个模型对象只是为了将该文件表示为关系。

你可以做一些分析和检查......但我认为只有一个名字是理想的。您还可以做一些工作来制作类似于 -imageNamed 的内容，为您缓存图像，并且您只需为每个文件制作一个 UIImage，无论它存在于程序中的任何位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:37:40.360

不要将图像保存在核心数据中。您可以将与图像相关的信息保存在核心数据中的有组织的事务中，但将图像有序地保存在项目的支持文件部分中。或者，如果您正在下载图像，您可以将它们缓存在应用程序的图像部分，并简单地更新核心数据中图像的信息。

# php - 哪个 CMS 可以处理来自多个托管位置的服务页面？

> ID：11636167
> 
> 赞同：1
> 
> 时间：2012-07-24T17:28:09.373
> 
> 标签：php, mysql, content-management-system, replication, web-hosting

我们公司在管理其网站方面非常成功，包括所有业务逻辑和内容。然而，今天也有很多静态内容页面使用模板系统提供服务，模板系统将内容存储在文件系统上的序列化 PHP 对象中。

我们现在正在考虑使用“真正的”CMS，但是我们有一些要求可以或多或少地排除所有常见的嫌疑人。最重要的要求是我们的托管环境：

我们有两个完全独立的托管位置，并采用“无共享”方法进行故障转移。这两个位置都有单独的 MySQL 实例，它们是位于我们总部现场的主数据库的从属 ()。这两个位置都有一定数量的 Web 服务器，每个服务器都存储完整的网站（同样，用于故障转移）。

从这个架构中，自然会产生两种可能的方法： - 数据库驱动的 CMS，在我们的总部进行管理并复制到我们的托管位置（以及使用我们的文件同步过程复制的图像和内容） - 文件驱动的 CMS其中不仅附件，而且内容文件都使用我们的文件同步进行同步

数据库驱动的方法对我来说似乎更灵活，但是我们找不到在“本地管理读/写数据库并仅使用只读从属设备提供内容”中工作的 CMS。例如，通常的嫌疑人（Typo3）需要一个数据库来写入其日志记录和会话管理，因此不是一种选择。其他 CMS 似乎也有这个问题。

那么，长话短说，有没有（PHP/MySQL-）CMS 可以处理这个问题？有什么建议么？

如果 CMS 可以轻松地与我们的 Zend Framework 应用程序集成（反之亦然），则加分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:33:48.897

你应该看看 Percona，这是一家 MySQL 性能公司，它把 MySQL 放在了类固醇上。轻松支持 Master/Master/Master 环境，无需更改 master 到 master 的自动增量值即可轻松实现。

他们有一个产品叫做，[`XtraDB Cluster`](http://www.percona.com/software/percona-xtradb-cluster/)。它是一个免费的产品，就像 MySQL 一样工作，安装方式相同，但在数据库级别处理集群并且做得非常好。

一旦您控制了数据库，您就可以在其中一台服务器上安装 CMS，进行更改，将其复制到所有其他服务器，您的整个环境就可以进行故障转移了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T07:51:41.877

根据您评论中添加的信息，我们似乎在谈论静态内容。

**现有系统**

据我所知，您已经有一个稳定的系统，可以部署静态内容。从这个意义上说，制造更复杂的情况是没有意义的。保持简单会在大多数情况下最适合您的需求。

根据您的需要，您可以在数据库同步或文件同步之间做出选择。

**文件同步**

如果您可以发送完全静态的所有内容，您的文件同步就会做得很好。虽然我在那里看到了一个问题。例如：如果您需要最新新闻项目列表，您还必须生成并同步它。当您使用数据库同步时，您只需执行所需的简单查询 SELECT * FROM news ORDER BY created_at DESC LIMIT 0,10。

**同步动作的数量**

另一点是您需要做的同步量。例如，如果您的后端有一个屏幕，其中包含 10 条新闻。作者创建了 3 个帖子并开始单击每个帖子的发布按钮。基本上，您的文件同步将在第一个之后开始同步。所以它应该首先同步新的新闻项目。然后它应该更新最新的新闻项目列表，然后同步那个。

如果他们开始很好地编辑，那可能会有点糟糕。因为这也需要在例如标题更改时完成。

**数据库解决方案**

这是数据库更擅长的地方，您只需更新记录，它就会到达那里。当新记录可用时，最新新闻部分将自行更新。

**相关静态内容的问题**

现在您遇到了一个问题：您必须确保您的流程分两步进行： 1\. 同步图像和其他静态内容 2\. 同步和/或发布新闻项目

否则，您将看到损坏的图像。例如，这可以通过以下方式完成： 确保新图像的同步直接开始。所以当它上传到CMS时。然后它将在新闻项目发布之前出现。您可以根据您的需要进行验证。

**备择方案**

由于这是静态内容，您可能能够更好地处理它。这将需要您的堆栈采用新技术，因此首先验证它是否真的需要。新闻项目是一个工作流程。因此，它的步骤彼此相邻。通常，对于工作流程，您可以使用队列。因此，您创建一个包含新新闻项目的队列、一个用于发布的队列、一个用于同步静态项目的队列等。

队列与缓存系统配合得很好。我认为有一个非常有趣的部分需要回顾。目前有强大的缓存系统可用，可以使内容可用并同步它们。它们基于这样一个事实，即您有许多服务器提供相同的内容。它们可能是完成工作的非常稳定且简单的解决方案。但如前所述，如果您还没有它们，请考虑是否要为您的堆栈添加新的复杂性。

# c# - Visual Studio 2010“System.Web”引用未解决 [C#]

> ID：11636170
> 
> 赞同：1
> 
> 时间：2012-07-24T17:28:23.330
> 
> 标签：c#, visual-studio-2010, dll, reference

我在添加对我的项目的引用时遇到问题。我需要`System.Web`参考才能使我的代码工作，但参考不会坚持。当我查看解决方案资源管理器时，我在我添加的引用顶部发现了这个警告图标。我在同一解决方案中的另一个项目中有相同的参考，它工作正常。

![上面有警告图标的参考](../Images/ffb03fff1dd8016fc2119af4de405747.png)

如果您查看此引用的属性，您会看到该`Resolved`属性设置为`False`

![此参考的属性](../Images/1cb167f19e0e47719a3d73b32e2d08df.png)

有谁知道我该如何解决这个问题或者是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:52:27.293

您的项目很有可能以**.NET Framework 4.0 Client Profile**为目标。客户端配置文件不支持 System.Web。将其更改为**.NET Framework 4.0**。

# javascript - Netbeans 中的 JavaScript

> ID：11636173
> 
> 赞同：1
> 
> 时间：2012-07-24T17:28:31.317
> 
> 标签：javascript, netbeans, intellisense, netbeans-7, netbeans-7.1

我正在使用**Netbeans 7.1**。我使用 Netbeans 在 HTML 和 JS 文件中编写 JavaScript。情况是，Netbeans 的 IntelliSense 似乎没有 JavaScript 拥有的所有方法和变量。例如，如果我键入`navigator`并放置点运算符 ( `navigator.`)，Intellisense 不会显示`cookieEnabled`布尔属性。这只是一个例子，但我发现了很多。为什么会这样？有没有办法解决它？请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T22:28:36.807

网豆？真的吗？您不需要 Javascript 的超级 IDE。使用作为 Sublimetext 的文本编辑器和带有 Javascript 控制台的浏览器，您可以做到这一切:)

# java - maven surefire 插件 - 指定单个测试 - 不运行

> ID：11636179
> 
> 赞同：0
> 
> 时间：2012-07-24T17:28:58.450
> 
> 标签：java, maven, testng, maven-surefire-plugin

我有这个 Maven 配置文件设置。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.8</version>
    <configuration>
        <includes>
            <include>com.something.test.X.java</include>
        </includes>

        <properties>
            <property>
                <name>reporter</name>
                <value>org.testng.reporters.XMLReporter</value>
            </property>
            <property>
                <name>listener</name>                          
                <value>Listener</value>
            </property>
        </properties>

        <systemProperties>
            <property>
                <name>x.host</name>
                <value>${server.ip}</value>
            </property>
            <property>
                <name>http_port</name>
                <value>${http_port}</value>
            </property>
            <property>
                <name>https_port</name>
                <value>${https_port}</value>
            </property>
            <property>
                <name>jmx_remote_port</name>
                <value>${jmx_remote_port}</value>
            </property>
        </systemProperties>

        <systemPropertyVariables>
            <x.host>${server.ip}</x.host>
            <env.BUILD_NUMBER>${env.BUILD_NUMBER}</env.BUILD_NUMBER>
            <env.HOSTNAME>${env.HOSTNAME}</env.HOSTNAME>
        </systemPropertyVariables>
    </configuration>

    <executions>
        <execution>
            <id>test</id>
            <phase>integration-test</phase>
            <goals>
                <goal>test</goal>
            </goals>
            <configuration>
                <skip>false</skip>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

当我运行配置文件时，包含的测试不运行！我究竟做错了什么？我什至用suitexmlfile尝试过，但我得到一个解析错误，它找不到类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T12:29:39.657

正如 Andrew Logvinov 建议的那样，您应该`.java`从包含的测试名称中删除。通常，测试坐标指定为`<class-name>[#<method-name>]`。

# regex - 使用正则表达式获取由不同数量的空格分隔的单词？

> ID：11636185
> 
> 赞同：0
> 
> 时间：2012-07-24T17:29:30.630
> 
> 标签：regex, perl

我正在尝试获取字符串中可以由不同数量的空格分隔的每个单词。

```
my $ff = "Disk  DSM     Policy  Paths   Serials";

if($ff =~ m/(\w+)/) {
    print $1;
    print $2;
    print $3;
} 
```

我认为它会像 \w 一样简单，但它只得到第一个单词？难道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:35:28.947

你需要[匹配`g`lobally](http://p3rl.org/retut#Global-matching)。

```
my $ff = "Disk  DSM     Policy  Paths   Serials";

my (@words_match) = $ff =~ /(\w+)/g;
# (
#     'Disk',
#     'DSM',
#     'Policy',
#     'Paths',
#     'Serials'
# ) 
```

更好的解决方案是[拆分](http://p3rl.org/split)。

```
my @words_split = split ' ', $ff;
# (
#     'Disk',
#     'DSM',
#     'Policy',
#     'Paths',
#     'Serials'
# ) 
```

# jquery - 如何使用 jquery 检索表单值

> ID：11636187
> 
> 赞同：0
> 
> 时间：2012-07-24T17:29:33.150
> 
> 标签：jquery, html

如何从表单元素中检索名称和值？

例如：我应该有一个`id=110kgod, checkbox=cancel, name=aj, age=23` 我听说过 serialize 的输出，但可以应用吗？

```
<DIV style="BORDER-BOTTOM: blue 2px ridge; BORDER-LEFT: blue 2px ridge; WIDTH: 1000px; BORDER-TOP: blue 2px ridge; BORDER-RIGHT: blue 2px ridge" id=0_212099594_990000 class=mid>
<TABLE border=0 cellSpacing=0 cellPadding=0 width="100%" align=center>
    <TBODY>
        <TR vAlign=top align=middle width="100%" cellPadding="0" cellSpacing="0" border="0">
            <TD width="15%"><H4>ID</H4></TD>
            <TD width="5%"></TD>
            <TD width="30%" align=left><INPUT onblur="this.style.backgroundColor='#fff'" class=input_0_212099594_990000 onfocus="this.style.backgroundColor='#ccc'" value=110KG0D name=ow_id> </TD>
            <TD width="19%"></TD>
            <TD style="BORDER-BOTTOM: black 1px solid; BORDER-LEFT: black 1px solid; BORDER-TOP: black 1px solid; BORDER-RIGHT: black 1px solid" class=radiobutton width="20%" align=middle>YES<INPUT class=0_212099594_990000 disabled value=YES type=radio name=0_212099594_990000 jQuery172033007169320727875="2">NO<INPUT class=0_212099594_990000 disabled value=NO type=radio name=0_212099594_990000 jQuery172033007169320727875="3">MAYBE<INPUT class=0_212099594_990000 value=MAYBE CHECKED type=radio name=0_212099594_990000 jQuery172033007169320727875="4"></TD>
            <TD width="5%" align=right><BUTTON style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; BACKGROUND-COLOR: white; BORDER-TOP: medium none; BORDER-RIGHT: medium none" onclick="javascript:ShowHide('0_212099594_990000')"><IMG src="../images/delete.png"></BUTTON> 
            </TD>
        </TR>
    </TBODY>
</TABLE>
<TABLE border=0 cellSpacing=0 cellPadding=0 width="98%" align=center>
    <TBODY>
        <TR vAlign=top align=left>
            <TD style="PADDING-BOTTOM: 1em" width="9%" align=middle><FONT color=black size=2><B>NAME</B></FONT></TD>
            <TD class=input_0_212099594_990000 width="8%" align=left><SELECT name=bsn_code> <OPTION selected value=a>A</OPTION> <OPTION value=B>B</OPTION> <OPTION value=C>C</OPTION> <OPTION value=D>D</OPTION> <OPTION value=OS>OS</OPTION></SELECT> </TD>
            <TD vAlign=top width="10%" align=middle><FONT color=black size=2><B>Age</B> </FONT></TD>
            <TD vAlign=top width="10%" align=left><INPUT onblur="this.style.backgroundColor='#fff'" class=input_0_212099594_990000 onfocus="this.style.backgroundColor='#ccc'" size=15 value=23 name=osi_cd> </TD>
            <TD width="1%"></TD>
            <TD class=input_0_212099594_990000 width="10%">22</TD>
            <TD class=input_0_212099594_990000 width="30%"></TD>
        </TR>
    </TBODY>
</TABLE>                        
</DIV> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:40:28.537

```
$(document).ready(function () {
    var ow_id = $('#ow_id').val();
    var bsn_code = $('#bsn_code').val();
    var osi_cd = $('#osi_cd').val();
    alert('ID: ' + ow_id + ', NAME: ' + bsn_code + ', AGE: ' + osi_cd);
}); 
```

这是小提琴：http: [//jsfiddle.net/collabcoders/NQ5jf/](http://jsfiddle.net/collabcoders/NQ5jf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:43:29.267

序列化将为您提供给定元素/表单中输入的名称/值

给你留下一个字符串，`osi_cd=21&bsn_code=[SELECTED.VALUE]&....`基本上是一个基于输入名称和输入值的键/值对。我认为输入类型与序列化无关。

如果您想要捕获的不仅仅是您需要手动循环浏览表单中的元素，那么请构建您自己的字符串以在此基础上发布。

附带说明一下，您的 HTML 不是很有效，并且可能会在某些浏览器上引起一些问题，尤其是一些较旧的浏览器。所有自定义属性或其他属性都应始终为小写并用双引号括起来

示例： `<input name="something" class="colorme" id="whatever" rel="something_else">`那么还取决于您选择的 HTML 格式，即：XHTML、HTML5 等。你必须补偿那些有效的东西。W3C 有一个很好的验证页面，你可以提供一个 URL，它会验证 HTML（如果你希望搜索引擎不惩罚你并给你一个较低的索引，这很好，也可以在使用 javascript/jquery 时避免一些头痛在将来）

不过，总的来说，您可以通过一些自定义编码来模仿序列化。例如在给定的包含元素或表单标签中循环元素，并在该循环中构建一个更适合您发布需求的字符串。

或者，您也可以使用“隐藏”元素来运行序列化，这将从每个元素中获取对并相应地构建字符串。最后，虽然它不会类似于序列化和传递数据，但需要在某处应用一些自定义逻辑。相应地处理数据。就我个人而言，我会构建一个多维数组，然后根据我从您的帖子中收集到的内容进行发布。

# git - 如何强制客户端不执行GIT post-receive hook

> ID：11636192
> 
> 赞同：1
> 
> 时间：2012-07-24T17:30:00.927
> 
> 标签：git, githooks

尝试实现工作流的 GIT 新手。

我们的本地办公室设置使用与 Apache、Linux 等共享的 Debian Samba 磁盘。因此，我们从类型为“本地路径”的“`w:/webs/site.com/site.git`这是 BARE repos”克隆项目。

我们创建了一个 bash 脚本作为位于**w:/webs/site.com/site.git/hooks/post-receive**上的“post-receive”钩子，我们认为它会由“linux”git 以类似的方式执行`/home/samba/webs/site.com/hooks... 包含一个条件脚本，具体取决于提交到结帐的分支，类似于：

```
GIT_WORK_TREE=/home/samba/webs/site.com/html git checkout -f $BRANCH 
```

问题是当我们从我们的 tortoiseGIT 本地副本推送到源分支时，钩子失败并显示：

> 远程：致命：无法切换到“C:/Program Files (x86)/Git/home/samba/webs/site.com/html”：没有这样的文件或目录到 w:/webs/site.com/site。混帐

我们理解这意味着客户端 GIT 正在执行 WORK_TREE 或整个钩子脚本。

问题是我们计划打开 SSH 和其他对存储库的访问，所以如果我们使用 Windows 本地路径，当我们从非 Windows 本地网络客户端推送时，这些路径会失败。替代方案可能是通过 SSH 提取存储库，即使在本地也是如此，但我们认为这相当低效，并且仅在此钩子问题中需要。

我们可以使用的任何建议和/或 GIT 变量都可以兼容吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T17:37:24.233

这个问题实际上与 GIT_WORK_TREE 的路径有关，而不是与解释器本身有关。

我们现在发现，无论是通过 Samba 访问的 Windows 客户端还是通过 Linux 的 SSH git 推送，使用 GIT_WORK_TREE="../html" 都可以完美地工作。

显然 GIT钩子是在 .git 存在***的存储库根目录本身（不是钩子目录）中执行的。***

我们的“其他”问题现在与符号链接有关……如果从 Windows 客户端完成推送过程，则符号链接作为文件出现在自动生成的（结帐）HTML 目录中，而不是像原始符号链接一样。

出于这个原因，我们最终决定通过 SSH 访问存储库，即使是本地的。;(

# php - 发送大量电子邮件 - 时事通讯

> ID：11636193
> 
> 赞同：2
> 
> 时间：2012-07-24T17:30:05.497
> 
> 标签：php, mass-emails

我有很多客户想向他们的用户发送新闻通讯。

我需要知道执行此服务的最佳方式： - 使用 PHP 和 PHPMailer 编程？- 使用 MailChimp、Campaing Monitor 等工具？- 使用像[http://www.phplist.com/](http://www.phplist.com/)这样的库？- 使用[http://www.sendblaster.com/](http://www.sendblaster.com/)？- 其他？

最好的方法是什么？

重要的是（面对 usuariois）多语言的可能性，因为用户是西班牙人，并且不懂英语。

希望您能够帮助我。

问候和感谢。

**哈维尔**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:32:01.143

我使用 SendGrid 发送电子邮件，API 非常简单。

开发社区也很棒：

[http://sendgrid.com/](http://sendgrid.com/)

# c# - Expression Blend 是否可用于 Windows 桌面应用程序？

> ID：11636194
> 
> 赞同：0
> 
> 时间：2012-07-24T17:30:06.520
> 
> 标签：c#, expression, desktop-application, expression-blend

在使用 windows phone 7 时，我爱上了表情混合。

现在我正在开发一个 Windows 桌面应用程序，我想使用表达式混合来设计表单。

Expression Blend 是否适用于桌面应用程序，还是仅适用于手机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:32:23.953

Expression Blend 用于`Windows Presentation Foundation`和`Silverlight`。因此，如果您想使用 WPF 进行桌面应用程序开发，那么表达式混合是一种方式......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T21:07:55.657

我也想让它工作。构建桌面应用程序时，VS 中没有在 Blend 中打开的选项。Blend For VS 2013 也不提供制作桌面应用程序的选项。

# php - php使用循环重新启动脚本执行的时间限制

> ID：11636196
> 
> 赞同：3
> 
> 时间：2012-07-24T17:30:10.977
> 
> 标签：php, performance, loops, timeout

我在 php 中运行一个 foreach 循环，它的执行时间比我的最大执行时间 30 秒要长。循环向用户发送单独的电子邮件。

不是每 30 秒运行一次 cron 作业并为记录创建队列，而是使用 重新启动循环中的计数器是不道德的`set_time_limit(30)`吗？

```
$i = 0; //start count from 0

foreach ($users as $user): 

    //limit emails sent
    if(++$i == 100) break; //ends execution of loop

    set_time_limit(30); //restart timeout counter

    send_email($user); //send email to user

endforeach; 
```

我是新手，但使用上面的代码，我认为我会给每封电子邮件 30 秒的时间来完成，但也会在发送 100 封电子邮件时打破循环，因此脚本不会永远运行。

**更新：** `set_time_limit(0)`反对托管 TOS，我相信重新启动超时计数器会重新启动脚本以及 CRON

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:26:06.297

循环运行`set_time_limit`会`foreach`同时带来并解决一些问题。

我认为这个解决方案的最大优点是确保没有请求将花费超过 30 秒的时间（当你有一个完整的提示时，我相信甚至希望削减每个需要这么长时间的脚本）。

它带来的问题是，并非所有工作都必须执行。也许您会在作业队列中间遇到一些问题，这一切都会失败。

我会这样做：

```
# crontab
0,30 * * * * php /path/to/your/script.php 
```

并且会使用你的脚本。

如果您需要尽可能快地执行作业，我会创建一个 bash 脚本，只要它不会完成`exit(0)`（所有作业都成功执行）或不会返回`"Done!"`或其他什么，它将执行（没有任何超时）php 脚本你喜欢。

**示例 bash 脚本：[1](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-7.html) , [2](http://linuxcommando.blogspot.sk/2008/03/how-to-check-exit-status-code.html)**

```
#!/bin/bash
# Note that false sets $? to 1
false
while [ $? -ne 0 ]; do
    php /path/to/your/script.php >> log.log
done 
```

如果你需要确保没有两个实例会同时运行，谷歌其中一个（只是从我的头顶）：

*   `.pid`文件
*   mysql`LOCK TABLE`

PS：如果您将使用某些方法，请确保您的脚本在中间崩溃时可以正常工作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:33:09.093

只需在脚本开始时一起禁用时间限制：

```
set_time_limit(0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:23:29.950

如果您的主机的 TOS 禁止使用无限脚本，他们几乎肯定会反对重置脚本。唯一的选择是并行发送电子邮件，或移动到不同的主机。

# c# - 如果两者之间有外部 api 调用，如何处理 lock 语句

> ID：11636198
> 
> 赞同：2
> 
> 时间：2012-07-24T17:30:23.243
> 
> 标签：c#, asp.net, concurrency

我有以下代码：

```
private static HashSet<SoloUser> soloUsers = new HashSet<SoloUser>();

    public void findNewPartner(string School, string Major)
    {
        lock (soloUsers)
        {
            SoloUser soloUser = soloUsers.FirstOrDefault(s => (s.School == School) && (s.Major == Major));
            MatchConnection matchConn;
            if (soloUser != null)
            {
                if (soloUser.ConnectionId != Context.ConnectionId)
                {                                                                     
                    soloUsers.Remove(soloUser);
                }

            }
            else
            {   string sessionId = TokenHelper.GenerateSession();                                     

                soloUser = new SoloUser
                {
                    Major = Major,
                    School = School,
                    SessionId = sessionId,
                    ConnectionId = Context.ConnectionId
                };

                soloUsers.Add(soloUser);

            }

        } 

    } 
```

`TokenHelper.GenerateToken(soloUser.Session)`并且`TokenHelper.GenerateModeratorToken(session);`可能很危险，因为它们可能需要一些时间来生成令牌。这将锁定所有用户，这可能是一个问题？这个逻辑是否有任何解决方法，以便我仍然可以保持所有线程安全？

编辑：我删除了`TokenHelper.GenerateToken(soloUser.Session)`and`TokenHelper.GenerateModeratorToken(session)`因为我意识到它们可能发生在锁之外，但每个`SoloUser`都有一个名为的属性`SessionId`，这是为每个用户生成的。该`GenerateSession`方法也将是一种需要一点时间的方法。`SessionId`每个用户在被添加到集合之前都需要拥有其中一个

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:05:01.703

如果您可以负担两次锁定，并且如果偶尔生成 sessionId 但从未使用过，则可以将 GenerateSession 移出锁定。

像这样的东西：

```
 public void findNewPartner(string School, string Major)
    {
        SoloUser soloUser = null;

        lock (soloUsers)
        {
            soloUser = soloUsers.FirstOrDefault(s => (s.School == School) && (s.Major == Major));
        }

        string sessionId = null;

        // will we be creating a new soloUser?
        if (soloUser == null)
        { 
            // then we'll need a new session for that new user
            sessionId = TokenHelper.GenerateSession();
        }

        lock (soloUsers)
        {
            soloUser = soloUsers.FirstOrDefault(s => (s.School == School) && (s.Major == Major));
            if (soloUser != null)
            {
                // woops! Guess we don't need that sessionId after all.  Oh well! Carry on...
                if (soloUser.ConnectionId != Context.ConnectionId)
                {                                                                     
                    soloUsers.Remove(soloUser);
                }

            }
            else
            {   
                // use the sessionid computed earlier
                soloUser = new SoloUser
                {
                    Major = Major,
                    School = School,
                    SessionId = sessionId,
                    ConnectionId = Context.ConnectionId
                };

                soloUsers.Add(soloUser);

        }

    } 
```

这基本上可以快速锁定以查看是否需要构建新的 soloUser，如果需要，那么我们需要生成一个新的会话。生成新会话发生在锁之外。然后我们重新获取锁并执行原始操作集。在构造新的 soloUser 时，它使用在锁之外构造的 sessionId。

这种模式可能会生成从未使用过的 sessionId。如果两个线程同时执行这个函数，同一学校和专业，两个线程都会生成会话ID，但只有一个线程会成功创建一个新的soloUser并将其添加到集合中。失败的线程将在集合中找到 soloUser 并将其从集合中删除 - 而不是使用它刚刚生成的 sessionId。此时，两个线程都将引用具有相同 sessionId 的同一个 soloUser，这似乎是目标。

如果 sessionId 有与之关联的资源（例如数据库中的条目），但是当 sessionId 过期时这些资源将被清理，那么像这样的冲突会产生一点额外的噪音，但总体上不应该影响系统。

如果生成的 sessionId 没有与它们相关的任何需要清理或老化的东西，那么您可能会考虑在我的示例中丢失第一个锁，并始终生成一个 sessionId，无论是否需要。这可能不太可能发生，但我之前在特殊情况下使用过这种“混杂”技巧以避免跳入和跳出高流量锁。如果创建成本低而锁定成本高，那么就放弃创建并小心使用锁。

Make sure the cost of GenerateSession is high enough to justify this extra run-around. If GenerateSession takes nanoseconds to complete, you don't need all this - just leave it in the lock as originally written. If GenerateSession takes "a long time" (a second or more? 500ms or more? can't say), then moving it out of the lock is a good idea to prevent other uses of the shared list from having to wait.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:35:27.477

最好的解决方案可能是使用`ConcurrentBag<T>`.

请参阅[http://msdn.microsoft.com/en-us/library/dd381779](http://msdn.microsoft.com/en-us/library/dd381779)

我假设您使用的是 .NET 4。

请注意，这是一个包，而不是一套。因此，您必须自己编写“无重复”代码，并以线程安全的方式进行。

# html - 自定义计数器重置：项目

> ID：11636199
> 
> 赞同：0
> 
> 时间：2012-07-24T17:30:25.200
> 
> 标签：html, css

如何自定义使用以下 CSS 时创建的数字：

```
div.Most ol{counter-reset: item;}
div.Most ol li:before {content: counter(item) "  "; counter-increment: item} 
```

通过将这些行添加到我的有序列表中，我获得了一个从零开始到列表中项目数的数值。我想要的是手动控制这些值。假设我希望第一个项目的值为 2，第二个项目的值为 4，依此类推。

是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:36:05.777

如果您想始终增加 2，可以将其设置为`counter-increment`值：

```
div.Most ol li:before {content: counter(item) "  "; counter-increment: item 2} 
```

这记录在[规范](http://www.w3.org/TR/CSS21/generate.html#propdef-counter-increment)中。

# python - Python 运行 Excel 宏

> ID：11636200
> 
> 赞同：2
> 
> 时间：2012-07-24T17:30:25.263
> 
> 标签：python, excel, vba

我正在尝试使用 python 运行一个 excel 宏，然后关闭 excel。我有以下内容：

```
 import win32com.client
 import os

 xl = win32com.client.DispatchEx("Excel.Application")
 wb = xl.workbooks.open("X:\Location\Location2\File1.xlsm")
 xl.run("File1.xlsm!WorkingFull")
 xl.Visible = True
 wb.Close(SaveChanges=1)
 xl.Quit 
```

如果我取出 xl.run("File1.xlsm!WorkingFull") ，我的脚本将正常打开和关闭当我运行它时，我收到以下错误：

回溯（最后一次调用）：文件“C:\Python27\File1.py”，第 6 行，在 xl.run("File1.xlsm!WorkingFull") 文件“”，第 2 行，在运行 com_error: (-2147352567 , '发生异常。', (0, u'Microsoft Excel', u"无法运行宏 'File1.xlsm!WorkingFull'。此工作簿中可能没有该宏，或者所有宏都可能被禁用。", u' xlmain11.chm', 0, -2146827284), 无)

我启用了宏并且我知道它在工作簿中，有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-20T21:18:49.233

请参阅下面使用 python 运行 Excel 宏的代码。[您可以在此站点链接](https://sites.google.com/site/exceldriven/selenium-webdriver/python-scripts/run-an-excel-macro-using-python)中找到此代码。使用此站点获取有关 excel、vba 和 python 脚本的其他参考资料，这些参考资料将来可能会有所帮助。

```
from __future__ import print_function
import unittest
import os.path
import win32com.client

class ExcelMacro(unittest.TestCase):
    def test_excel_macro(self):
        try:
            xlApp = win32com.client.DispatchEx('Excel.Application')
            xlsPath = os.path.expanduser('C:\test1\test2\test3\test4\MacroFile.xlsm')
            wb = xlApp.Workbooks.Open(Filename=xlsPath)
            xlApp.Run('macroName')
            wb.Save()
            xlApp.Quit()
            print("Macro ran successfully!")
        except:
            print("Error found while running the excel macro!")
            xlApp.Quit()
if __name__ == "__main__":
    unittest.main() 
```

# android - 首次使用时用户设置的上下文菜单？

> ID：11636204
> 
> 赞同：1
> 
> 时间：2012-07-24T17:30:41.487
> 
> 标签：android, menu

我正在尝试设置一个在用户第一次启动应用程序时出现的菜单，因此他们可以通过从 6 个项目中选择 1 个来设置它。它需要根据从 sharedPreferences 中获取的布尔值自动启动。我一直在尝试创建一个上下文菜单，但它不起作用，我不确定它是否是正确的方法。有没有人这样做并且上下文菜单是正确的方法？如果没有，请您指出正确的方向。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:03:31.380

您不应该将 ContextMenu 用于这种设计。您应该使用自定义对话框来配置您的应用程序。可能使用 ViewSlider 来允许多个配置屏幕，或者只使用一个 View 和 ScrollView 中的所有配置选项。

# asp.net-membership - 如何使用 Microsoft.Web.WebPages.OAuth 更改范围/权限

> ID：11636211
> 
> 赞同：6
> 
> 时间：2012-07-24T17:31:12.023
> 
> 标签：asp.net-membership, dotnetopenauth, asp.net-webpages

使用 Microsoft.Web.WebPages.OAuth 时是否可以更改范围/权限？最合乎逻辑的地方是使用 OAuthWebSecurity.RegisterClient 注册客户端时。我认为向 extraData 参数添加范围可能会起作用，但我没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:26:45.720

extradata 是您可以传递有关提供程序并在 UI 层中使用它的东西。例如。额外数据可能是列出用于登录的提供程序时显示的图标。以下帖子显示了如何编写自己的提供程序并将其插入您的站点 [http://blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers.aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/23/plugging-custom-oauth-openid-providers.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T15:11:51.997

Microsoft.Web.WebPages.OAuth 在使用客户端进行授权时不会公开范围。我最终添加了自定义 DotNetOpenAuth 客户端以包含我必要的范围。

# asp.net-mvc-3 - MVC 3 GET Web 服务和响应

> ID：11636222
> 
> 赞同：1
> 
> 时间：2012-07-24T17:31:59.617
> 
> 标签：asp.net-mvc-3, json.net

我正在尝试构建一个 GET 网络服务，该服务将从网站 1 发起 GET 请求...将该请求发送到网站 2，网站 2 将通过发送对象列表来响应。我使用 Json.net 序列化和反序列化对象列表。

在这个问题的帮助下，我整理了一个 POST网络服务[。WebService ASP.NET MVC 3 Send and Receive](https://stackoverflow.com/questions/11568453/webservice-asp-net-mvc-3-send-and-recieve)

但是到目前为止，我在根据我的新要求调整该示例方面一直没有成功。

这是我到目前为止从网站 1..

```
 public static List<ScientificFocusArea> ScientificFocusAreas()
    {
        string apiURL = "http://localhost:50328/Api/GetAPI";

        //Make the post
        ServicePointManager.ServerCertificateValidationCallback = (sender, certificate, chain, errors) => true;

        //var bytes = Encoding.Default.GetBytes(body);
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(apiURL);
        Stream stream = null;
        try
        {
            request.KeepAlive = false;
            request.ContentType = "application/x-www-form-urlencoded";
            request.Timeout = -1;
            request.Method = "GET";
        }
        finally
        {
            if (stream != null)
            {
                stream.Flush();
                stream.Close();
            }
        }

        List<ScientificFocusArea> listSFA = WebService.GetResponse_ScientificFocusArea(request);

        return listSFA;
    }

    public static List<ScientificFocusArea> GetResponse_ScientificFocusArea(HttpWebRequest request)
    {
        List<ScientificFocusArea> listSFA = new List<ScientificFocusArea>();

        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {

            using (Stream responseStream = response.GetResponseStream())
            {
                if (response.StatusCode != HttpStatusCode.OK && response.StatusCode != HttpStatusCode.Created)
                {
                    throw new HttpException((int)response.StatusCode, response.StatusDescription);
                }

                var end = string.Empty;
                using (StreamReader reader = new StreamReader(responseStream))
                {
                    end = reader.ReadToEnd();
                    reader.Close();

                    listSFA = JsonConvert.DeserializeObject<List<ScientificFocusArea>>(end);
                }

                response.Close();
            }
        }

        return listSFA;
    } 
```

然后在网站2...

```
public class GetAPIController : Controller
{
    //
    // GET: /Api/GetAPI/

    [AcceptVerbs(HttpVerbs.Get)]
    public ActionResult GetScientificFocusAreas()
    {
        //Get list of SFAs
        List<ScientificFocusArea> ListSFA = CreateList.ScientificFocusArea();

        string json = JsonConvert.SerializeObject(ListSFA, Formatting.Indented);

        //Send the the seralized object.
        return Json(json);

    }

} 
```

另外，在网站 2 上，我已经为传入请求注册了这条路线......

```
 context.MapRoute(
"GetScientificFocusAreas",
"Api/GetAPI/",
new
{
    controller = "GetAPI",
    action = "GetScientificFocusAreas",
    id = UrlParameter.Optional
} 
```

);

我目前收到错误消息。他的远程服务器返回了一个错误：（404）未找到。

任何帮助我都会非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T16:22:19.687

这个问题似乎是一个路由问题。我将从可以在[此处](http://haacked.com/archive/2011/04/13/routedebugger-2.aspx)找到的 RouteDebugger 开始。此工具可让您深入了解您的 URL 正在访问哪些路由。

我用于 HTTP GET 的代码与您上面的代码有些不同。它包含在下面。

```
 public T Get<T>(string url)
    {
        try
        {
            HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;

            using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
            using (Stream responseStream = response.GetResponseStream())
            {
                if (response.StatusCode != HttpStatusCode.OK && response.StatusCode != HttpStatusCode.Created)
                {
                    throw new HttpException((int)response.StatusCode, response.StatusDescription);
                }

                var end = string.Empty;
                using (StreamReader reader = new StreamReader(responseStream))
                {
                    end = reader.ReadToEnd();
                    reader.Close();
                }

                responseStream.Close();
                response.Close();

                JsonSerializer serializer = new JsonSerializer();
                serializer.Binder = new DefaultSerializationBinder();
                JsonReader jsonReader = new JsonTextReader(new StringReader(end));
                T deserialize = serializer.Deserialize<T>(jsonReader);

                return deserialize;
            }

        }
        catch (Exception ex)
        {
            throw new ApiException(string.Format("An error occured while trying to contact the API. URL: {0}", url), ex);
        }
    } 
```

我看到的另一个问题是`GetScientificFocusAreas()`方法。在代码的第二行，对象被转换为 JSON。这很好，但是 json 的最后一行代码被传递到`Json()`方法中。这再次将字符串转换为 Json。使用 JSON.Net 库时，使用instead of`Content()`中的方法并将内容类型设置为**application/json**`return``Json()`

 **使用外部 Json 转换器而不是内部转换器的原因仅仅是内部 json 转换器存在一些已知问题。JSON.Net 已经存在多年并且很稳固。**

# jquery - jquery影响单元测试，试图完成什么？

> ID：11636224
> 
> 赞同：0
> 
> 时间：2012-07-24T17:32:02.463
> 
> 标签：jquery

阅读 jQuery 1.8 [test/unit/effects.js](https://github.com/jquery/jquery/blob/master/test/unit/effects.js)测试，这里要测试什么？

```
 var speeds = {
        'null speed' : null,
        'undefined speed': undefined,
        'false speed': false
    }

    // make sure passing bogus arguments doesn't change state var ?
    jQuery.each( speeds,
                 function( name, speed ) {
                     pass = true;
                     div.hide()
                         .show(speed)
                         .each( function() {
                                     if( this.style.display == 'none' ) {
                                         pass = false;
                                     }
                              });
                         ok( pass, 'Show with ' + name );
                 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:40:47.270

正如代码中的注释所述，它确保将无效值传递给[`.show()`](http://api.jquery.com/show/)方法不会破坏它。即`.show( null )`,`.show( undefined )`和`.show( false )`all 显示元素，即使参数无效。

# python - 使用 Cairo 和 wxPython 进行动态绘图

> ID：11636225
> 
> 赞同：0
> 
> 时间：2012-07-24T17:32:11.927
> 
> 标签：python, dynamic, wxpython, cairo

我正在开发一个使用 wxPython 和 Cairo 编写的新项目，以便在画布上动态绘制对象。一切都很好，尽管我注意到 wxPython 有一个很大的警告，我很难解决这个问题。我对 wxPython 很陌生，对 Cairo 也很陌生，所以答案可能很明显，但我似乎无法在任何地方找到它。

我遇到的问题是，当调用 wx.EVT_PAINT 时，您似乎只能在图形上下文（我相信是 wx.GraphicsContext）上绘制，尽管我需要外部类才能绘制到画布容易地。

我最初的计划是创建 Cairo 上下文，然后将其存储在画布所在的类中，然后任何需要访问上下文进行绘制的类都可以使用 canvas.ctx 之类的东西简单地获取它。

我的总体问题是，有没有什么方法可以访问开罗上下文而不需要调用 wx.EVT_PAINT？

这是我现在正在使用的代码：

```
import wx
import CairoAPI

class Canvas(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None, -1, "test", pos=(0, 0), size=(640,480))
        #self.ShowFullScreen(1)
        self.Bind(wx.EVT_PAINT, self.OnPaint)

    def DrawRectangle(self):
        pass

    def OnPaint(self, event):
        dc = wx.PaintDC(self)
        w,h = dc.GetSizeTuple()
        gc = wx.GraphicsContext.Create(dc)
        nc = gc.GetNativeContext()
        ctx = CairoAPI.Context_FromSWIGObject(nc)

if __name__=="__main__":

    app = wx.App()
    canvas = Canvas()
    canvas.Show()
    app.MainLoop() 
```

在这段代码中，我想要完成的是制作 canvas.DrawRectangle 并能够写入画布，而无需从 canvas.OnPaint 中调用该函数。

对不起，如果我让这个问题变得混乱。我昨晚刚开始学习开罗，但我对它的工作原理和某些事情的正确术语仍然有些陌生。

谢谢！

编辑：我忘记了一些代码：“CairoAPI”模块是我从教程中得到的（不记得是哪一个）。这是它的来源。

```
import ctypes
import cairo
from ctypes.util import find_library

cairo_dll = ctypes.CDLL(find_library("cairo"))

# Pycairo's API representation (from pycairo.h)
class Pycairo_CAPI(ctypes.Structure):
   _fields_ = [
      ('Context_Type', ctypes.py_object),
      ('Context_FromContext', ctypes.PYFUNCTYPE(ctypes.py_object,
                                                ctypes.c_void_p,
                                                ctypes.py_object,
                                                ctypes.py_object)),
      ('FontFace_Type', ctypes.py_object),
      ('FontFace_FromFontFace', ctypes.PYFUNCTYPE(ctypes.py_object, ctypes.c_void_p)),
      ('FontOptions_Type', ctypes.py_object),
      ('FontOptions_FromFontOptions', ctypes.PYFUNCTYPE(ctypes.py_object, ctypes.c_void_p)),
      ('Matrix_Type', ctypes.py_object),
      ('Matrix_FromMatrix', ctypes.PYFUNCTYPE(ctypes.py_object, ctypes.c_void_p)),
      ('Path_Type', ctypes.py_object),
      ('Path_FromPath', ctypes.PYFUNCTYPE(ctypes.py_object, ctypes.c_void_p)),
      ('Pattern_Type', ctypes.py_object),
      ('SolidPattern_Type', ctypes.py_object),
      ('SurfacePattern_Type', ctypes.py_object),
      ('Gradient_Type', ctypes.py_object),
      ('LinearGradient_Type', ctypes.py_object),
      ('RadialGradient_Type', ctypes.py_object),
      ('Pattern_FromPattern', ctypes.c_void_p),
      ('ScaledFont_Type', ctypes.py_object),
      ('ScaledFont_FromScaledFont', ctypes.PYFUNCTYPE(ctypes.py_object, ctypes.c_void_p)),
      ('Surface_Type', ctypes.py_object),
      ('ImageSurface_Type', ctypes.py_object),
      ('PDFSurface_Type', ctypes.py_object),
      ('PSSurface_Type', ctypes.py_object),
      ('SVGSurface_Type', ctypes.py_object),
      ('Win32Surface_Type', ctypes.py_object),
      ('XlibSurface_Type', ctypes.py_object),
      ('Surface_FromSurface', ctypes.PYFUNCTYPE(ctypes.py_object, ctypes.c_void_p)),
      ('Check_Status', ctypes.PYFUNCTYPE(ctypes.c_int, ctypes.c_int))]

# look up the API
ctypes.pythonapi.PyCObject_Import.restype = ctypes.POINTER(Pycairo_CAPI)
pycairo_api = ctypes.pythonapi.PyCObject_Import("cairo", "CAPI").contents

ContextType = pycairo_api.Context_Type

def Context_FromSWIGObject(swigObj):
    ptr = ctypes.c_void_p(int(swigObj))
    #increment the native context's ref count, since the Pycairo_Context decrements it
    #when it is finalised.
    cairo_dll.cairo_reference(ptr)
    return pycairo_api.Context_FromContext(ptr, ContextType, None) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T21:55:15.320

我按照 Mike Driscoll 的指示做了（[在上面的评论中](https://stackoverflow.com/questions/11636225/dynamic-drawing-with-cairo-and-wxpython/11659235#comment15416775_11636225)）并将我的问题发布在**wxPython 组**和**开罗邮件列表**上，开罗列表成员的回复是：

> 看看 wxWindowDC、wxClientDC。

在查找了这些课程后，我读到：

> 如果应用程序希望从 OnPaint 事件之外在窗口的客户区进行绘制，则必须构造 wxClientDC。这通常应该构造为临时堆栈对象；不要存储 wxClientDC 对象。

这正是我一直在寻找的。我希望这对以后遇到同样问题的人有所帮助。

谢谢！杰里米奥弗曼

# ruby-on-rails-3 - 在 Rails 3 应用程序中将具有某些子网的 IP 列入白名单

> ID：11636228
> 
> 赞同：2
> 
> 时间：2012-07-24T17:32:31.763
> 
> 标签：ruby-on-rails-3, controller, ip, before-filter

我一直在尝试找出阻止对 Rails 3 应用程序访问的正确方法，除了少量 IP 地址和几个 IP 子网。

在寻找方法时，我发现了这个[问题/答案](https://stackoverflow.com/questions/5553874/rails-3-whitelisting-list-of-ips-via-routes)。建议的代码如下：

**应用控制器**

```
before_filter :protect

def protect
  @ips = ['127.0.0.1', '203.123.10.1'] #And so on ...]
  if not @ips.include? request.remote_ip
     # Check for your subnet stuff here, for example
     # if not request.remote_ip.include?('127.0,0')
     render :text => "You are unauthorized"
     return
  end
end 
```

这行得通，所以我将其更改为重定向到静态页面，而不仅仅是文本消息。

不过，我想做的是允许从与 Rails 应用程序服务器位于同一子网上的本地 IP 进行访问。子网很简单`192.168.1.0/24`。

将子网添加到接受的 IP 的最简单/最干净的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:29:43.053

要测试给定的 IP 地址是否在 address和 mask`foo`指定的网络中，您可以将掩码应用于网络地址和测试地址，并查看结果是否相等：您必须先将 IP 地址和掩码转换为整数。掩码是 24 位设置为后跟 8 位设置为-或点分四边形表示法。`net``mask``foo & mask == net & mask``/24``1``0``0xFFFFFF00``255.255.255.0`

```
before_filter :protect

def protect
  @ips = ['127.0.0.1', '192.168.1.0/24'] #And so on ...]
  allowed = false
  # Convert remote IP to an integer.
  bremote_ip = request.remote_ip.split('.').map(&:to_i).pack('C*').unpack('N').first
  @ips.each do |ipstring|
    ip, mask = ipstring.split '/'
    # Convert tested IP to an integer.
    bip = ip.split('.').map(&:to_i).pack('C*').unpack('N').first
    # Convert mask to an integer, and assume /32 if not specified.
    mask = mask ? mask.to_i : 32
    bmask = ((1 << mask) - 1) << (32 - mask)
    if bip & bmask == bremote_ip & bmask
      allowed = true
      break
    end
  end

  if not allowed
     render :text => "You are unauthorized"
     return
  end
end 
```

# jquery - 选择输入顺序

> ID：11636229
> 
> 赞同：0
> 
> 时间：2012-07-24T17:32:35.623
> 
> 标签：jquery, html

所以我有 3 个选择输入字段，我想知道是否可以在选择其他选项后禁用它们。IE：

```
<tr id="row1">
    <th>Row 1</th>
    <td>
        <select>
            <option value="1">1</option>
            <option value="2" selected>2 selected so 1+3 are disabled</option>
            <option value="3">3</option>
        </select>
    </td>
</tr>

<tr id="row2">
    <th>Row 2</th>
    <td>
        <select>
            <option value="1" selected>1 selected 2+3 are disabled</option>
            <option value="2">2</option>
            <option value="3">3</option>
        </select>
    </td>
</tr>

<tr id="row3">
    <th>Row 3</th>
    <td>
        <select>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3" selected>3 (you get it...)</option>
        </select>
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:36:59.537

尝试这个：

```
$('select').change(function(){
    $(this).find('option:not(:selected)').prop('disabled', true)
}) 
```

[演示](http://jsfiddle.net/3UQtj/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:42:22.173

您可以将 onchange 事件绑定到选择。然后选择哪些选项元素没有被选中并禁用它。如果你已经熟悉 jQuery，你可以这样做：

```
$("select").bind("change", function(){
        $(this).children("option:not(:selected)").attr("disabled", "disabled");
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:42:44.247

禁用其他选项将阻止用户更改他们的选择，因此只需使用 javascript 删除所有其他选项。

快速，肮脏的方式是

```
<select onchange='for(vari=0, l=this.options.length; i<l; i++){ if(this.options[i].selected) continue; this.remove(i); }'> 
```

不需要 Jquery。但是，我不建议将 javascript 与 html 混合，除非您没有任何其他外部 javascript 可以导入并将其用作这些特定选择语句的处理程序。

# ios - Cocos2d：如何在场景之间共享玩家数据

> ID：11636234
> 
> 赞同：1
> 
> 时间：2012-07-24T17:33:00.363
> 
> 标签：ios, objective-c, cocoa-touch, cocos2d-iphone, singleton

**我有一个从 CCNode 派生的 PlayerData 类，我想在游戏的各个场景之间共享它作为静态单例实例。**

我尝试了以下实现：

```
#import <Foundation/Foundation.h>
#import "cocos2d.h"
@interface PlayerData : CCNode {

}

@property (readwrite, nonatomic) int data;  
+(id) playerData;
+(PlayerData*) sharedPlayerData;

#import "PlayerData.h"
@implementation PlayerData
@synthesize data;
static PlayerData* instanceOfPlayerData;

+(id) playerData 
{
    if(instanceOfPlayerData==nil){
        return  [[self alloc] init];
    }else {
        return [self sharedPlayerData];
    }
}

+(PlayerData*) sharedPlayerData{
    NSAssert(instanceOfPlayerData != nil, @"PlayerData instance not yet initialized!");
    return instanceOfPlayerData;
}

-(id) init 
{
    if ((self = [super init]))
    {
        instanceOfPlayerData=self;
        data=0;
        }
    return self;
}
@end 
```

**分配这个的正确位置在哪里？**我考虑过将它添加并访问到 AppDelegate 类，但我无法安静地理解如何。

我从 sharedDirector 中看到我可以访问一个 delagate 值，但我认为这不是正确的，除非我必须将它转换为我的 AppDelegate 类。有什么建议吗？

```
[[CCDirector sharedDirector] delegate]; 
```

这是来自模板的我的 AppDelegate 类：

```
#import <UIKit/UIKit.h>
#import "cocos2d.h"

@interface AppController : NSObject <UIApplicationDelegate, CCDirectorDelegate>
{
    UIWindow *window_;
    UINavigationController *navController_;

    CCDirectorIOS   *__unsafe_unretained director_;                         // weak ref
}

@property (nonatomic) UIWindow *window;
@property (readonly) UINavigationController *navController;
@property (unsafe_unretained, readonly) CCDirectorIOS *director;

@end 
```

**PS：我正在使用启用 ARC 的 Cocos2d v2.x**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T21:37:36.580

这是一个很棒的单例教程，我用于我的游戏并且效果很好： http: [//getsetgames.com/2009/08/30/the-objective-c-singleton/](http://getsetgames.com/2009/08/30/the-objective-c-singleton/)

# python - 如何从 Django 列表中删除 unicode 字符？

> ID：11636239
> 
> 赞同：1
> 
> 时间：2012-07-24T17:33:24.680
> 
> 标签：python, django, python-2.7, django-views

我在 Django 中有以下列表：

```
[['Host Name', 'No. of Events'], [u'12.23.21.23', 0], [u'2.152.0.2', 2]] 
```

为了获得上面的列表，我在我的代码中编写了以下代码`views`：

```
 def graph_analysis(request):
    event_host, event_alerts = ([] for x in range(2))
    event_alerts.append(['Host Name', 'No. of Events'])
    host_ipv4 = [et for et in get_hosts(user=request.user)]
    event = get_events(source_hosts=host_ipv4)
    for x in host_ipv4:
        event_host.append(x.ipv4)
        event_alerts.append([x.ipv4,get_host_count(x,event)])
    extra_context = {
    #### 
```

现在我在我的 Javascript 变量中使用这个列表。一切都很好，除了 unicode 字符。我想删除它。简而言之，我希望上面的列表如下：

`[['Host Name', 'No. of Events'], ['12.23.21.23', 0], ['2.152.0.2', 2]]`

我应该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T17:46:23.133

这里没有“unicode 字符”。您有一个包含要输出为 json 的 unicode 字符串的列表。您需要将 unicode 字符串（文本的抽象表示）编码为字节字符串（字节序列）。你这样做的方式是：

```
u'12.23.21.23'.encode('utf8') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T17:53:03.733

```
import json
list_ = #your content list here
list_as_json = json.dumps(list_) 
```

你实际上并没有删除任何东西。出现 u 是因为这些列表中的元素是 unicode 字符串，并且`__repr__()`for a unicode 字符串打印前导 u 以将其与非 unicode 字符串区分开来。 `json.dumps()`在将列表转换为 json 字符串时，将 unicode 和非 unicode 字符串的内容视为相同（至少就这个问题而言），因此您不会得到任何 u 标识符。

# spring-security - Spring Security 的 BasicLookupStrategy 中使用的 SQL 语句是否正确？

> ID：11636254
> 
> 赞同：0
> 
> 时间：2012-07-24T17:34:44.997
> 
> 标签：spring-security

在调试使用 Spring Security ACL 遇到的一些问题时，我查看了“BasicLookupStrategy”使用的 SQL 语句。我在这里复制它以供参考：

```
public final static String DEFAULT_SELECT_CLAUSE = "select acl_object_identity.object_id_identity, "
    + "acl_entry.ace_order,  "
    + "acl_object_identity.id as acl_id, "
    + "acl_object_identity.parent_object, "
    + "acl_object_identity.entries_inheriting, "
    + "acl_entry.id as ace_id, "
    + "acl_entry.mask,  "
    + "acl_entry.granting,  "
    + "acl_entry.audit_success, "
    + "acl_entry.audit_failure,  "
    + "acl_sid.principal as ace_principal, "
    + "acl_sid.sid as ace_sid,  "
    + "acli_sid.principal as acl_principal, "
    + "acli_sid.sid as acl_sid, "
    + "acl_class.class "
    + "from acl_object_identity "
    + "left join acl_sid acli_sid on acli_sid.id = acl_object_identity.owner_sid "
    + "left join acl_class on acl_class.id = acl_object_identity.object_id_class   "
    + "left join acl_entry on acl_object_identity.id = acl_entry.acl_object_identity "
    + "left join acl_sid on acl_entry.sid = acl_sid.id  "
    + "where ( "; 
```

我的问题是关于上述语句中表“acli_sid”的用法。AFAICT，Spring 安全 ACL 不需要任何具有该名称的表，所以我想知道这里是否缺少一些东西。任何帮助是极大的赞赏。

谢谢，拉古

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:37:06.897

该表称为`acl_sid`。您发布的 SQL 查询`acli_sid`用作别名：

```
left join acl_sid acli_sid on acli_sid.id 
```

您可以通过运行示例应用程序轻松检查它是否适用于 ACL 数据库模式。

# symfony - Symfony 2 - 生成日历月表，其中包含指向事件的链接

> ID：11636256
> 
> 赞同：0
> 
> 时间：2012-07-24T17:34:53.377
> 
> 标签：symfony, twig

我有一个名为 的实体，其中`Event`包含字段`startDate`、`startTime`和。如果日期相同，则日期可以为 NULL （如果它使事情变得更容易，我可以更改此行为，因为我还没有事件）。并且不能为NULL。它还有一个方法，如果事件将在给定日期运行，则返回该方法。`endDate``endTime``startDate``endDate``endDate``startTime``startTime``endTime``isOnDate(\DateTime $date)``true`

这很痛苦，但我最终生成了任何给定日历月的 HTML 表格，将当月第一天的星期几 ( `firstDow`) 和该月的天数 ( `numDays`) 作为模板变量传递。

如果给定的日期有一个或多个事件，下一步将是使一些表格单元链接到事件或事件列表页面。现在我有点卡住了，因为我不知道如何获取模板中每个单元格的 DateTime() 对象。

有人可以给我一个提示吗？还是我完全错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:18:18.113

您可以使用 Twig 过滤器日期将 DateTime 对象显示为文本日期：

```
{{ event.startDate|date("m/d/Y") }} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T23:31:47.653

您可以使用 Ajax 和 jQuery 将您的页面与数据库动态链接。您可以从 Symfony2 的日历代码开始：[http ://www.symfocal.com](http://www.symfocal.com)

# iphone - 在 iOS 上使用 MKNetworkKit 进行流式传输

> ID：11636257
> 
> 赞同：0
> 
> 时间：2012-07-24T17:35:01.567
> 
> 标签：iphone, objective-c, ios, ipad, mknetworkkit

我试图弄清楚如何让 MKNetworkKit 处理来自流的数据。我可以看到正在下载一些数据（状态栏上的指示器），但我不知道实际下载后该数据会发生什么。我在主体中放置了一个 NSLog 语句，`connection: didReceiveData:`但在流式传输期间没有调用它。任何指示如何解决该问题？

**编辑**

抱歉，我的问题不准确。我知道如何流式传输到文件，但我需要流式传输到内存（最好是 NSData 实例）。好的，由于 NSOutputStream 方法，它再次看起来很简单`initWithBytes:capacity:`。我的问题就在这里，我的流的长度未定义，因此会对内存产生巨大影响。我不知道该怎么办。我的完美解决方案是这样工作的。流中的小块数据在下载后被处理，然后被丢弃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T16:32:29.260

您可以使用该`outputStreamToBuffer:capacity:`方法来创建流。

至于缓冲区，您可以使用循环缓冲区，以便您可以在流写入时从中读取。一个很好的实现（和解释）在[这里](http://atastypixel.com/blog/a-simple-fast-circular-buffer-implementation-for-audio-processing/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T03:28:07.087

使用 MKNetworkKit 流式下载文件是三行魔术。

```
//Create a MKNetworkOperation for the remote URL.

MKNetworkOperation *op = [self operationWithURLString:remoteURL 
                                                    params:nil
                                              httpMethod:@"GET"];

// add your output stream, in this case a file
[op addDownloadStream:[NSOutputStream outputStreamToFileAtPath:filePath
                                                             append:YES]];
// enqueue the operation to a MKNetworkEngine.
[self enqueueOperation:op]; 
```

就是这样。

# c# - OpenXML 替换 word 文档的特定 customxml 部分

> ID：11636258
> 
> 赞同：3
> 
> 时间：2012-07-24T17:35:04.697
> 
> 标签：c#, xml, ms-word, openxml

我`OpenXML SDK ver 2`用来操作一些word文档。这些文档当前具有自定义 xml 部分，我想要做的是专门替换这些部分的 xml。

我知道我可以做这样的事情来访问文档的 customxml 部分：

```
Dim mainStream As New MemoryStream()
Dim buffer As Byte() = File.ReadAllBytes(Server.MapPath("myfile.docx"))
mainStream.Write(buffer, 0, buffer.Length)

Try
  Using mainDocument As WordprocessingDocument = WordprocessingDocument.Open(mainStream, True)

  MainDocumentPart mainPart = mainDocument.MainDocumentPart;
  'collection of custom xml parts
   Dim parts = mainPart.CustomXmlParts
   For Each part As CustomXmlPart In parts
     'how do I replace the xml here??
   Next 
```

但正如您所见，我不确定如何替换零件的 XML。我的文档有两个 XML 部分，分别称为 item1.xml 和 item2.xml。我想替换这些部分中的 XML。我知道我可以使用 .DeleteParts() 删除现有的 xml 部件，我可以使用 AddCustomXmlPart() 创建新部件，但我不想这样做。我只是想替换现有部件的 XML。

谁能建议我怎么做？任何建议表示赞赏。

谢谢你。

**编辑**哎呀忘记了代码标签

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:16:59.020

使用实例的`FeedData()`方法`CustomXmlPart`替换自定义xml部分的xml。该`FeedData()`方法首先截断部分的流，然后将新数据写入部分流。因此，您可以使用此方法替换现有自定义 xml 部件中的 XML。

```
MainDocumentPart mainPart = mainDocument.MainDocumentPart;

Dim parts = mainPart.CustomXmlParts

For Each part As CustomXmlPart In parts

  Dim ms As New MemoryStream
  Dim xtw As New XmlTextWriter(ms, Encoding.UTF8)

  ' Create your xml.'

  xtw.WriteStartDocument() 
  xtw.WriteStartElement("bla")
  xtw.WriteEndElement()
  xtw.WriteEndDocument()
  xtw.Flush()

  ms.Seek(0, SeekOrigin.Begin)

  part.FeedData(ms) ' Replace old xml in part stream.'

  xtw.Close()    

Next 
```

# zend-framework - Zend autoloadernamespaces[] 和 autoloadernamespaces 的区别

> ID：11636260
> 
> 赞同：0
> 
> 时间：2012-07-24T17:35:12.613
> 
> 标签：zend-framework, zend-autoloader

在 Zend Framework 中设置自定义库时和和有什么**区别**？`autoloadernamepaces[] = "foo"``autoloadernamespaces.foo = "foo"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:51:08.763

你最终在配置中得到的基本上是一个数组。一个具有数字索引，而另一个具有提供的键

```
autoloadernamespaces[] = "foo" 
// results into this
array(0 => "foo");

autoloadernamespaces.foo = "foo"
array("foo" => "foo"); 
```

后者的优点是您始终可以使用名称对其进行寻址。自动加载器命名空间可能不需要这，但对于其他配置，这可能是一个救命稻草。

# ruby-on-rails-3 - 如何重新路由标准休息动作以设计控制器？

> ID：11636262
> 
> 赞同：0
> 
> 时间：2012-07-24T17:35:22.110
> 
> 标签：ruby-on-rails-3, devise, controller

我一直在将设计构建到一个小型 Rails 应用程序中。这是一个非常标准的设置，但有一个问题是需要更改此项目的默认身份验证规则。非幂等注册操作必须全部仅限于经过身份验证的用户。

为此，我编写了一个自定义注册控制器并将其链接到路由中。自定义控制器真正要做的就是改变过滤要求。基于 Rails 控制器过滤[文档](http://rails.rubyonrails.org/classes/ActionController/Filters/ClassMethods.html)，我以最少的努力完成了这项工作。

但它本身仅适用于设计特定的操作，如 /users/sign_up 或 /users/edit。我还想将标准 Rails 操作（/users/new、/users/1/edit 等）连接到自定义控制器。我可以获得实例化控制器的动作——可以说是把马带到水边——但是当动作是新的而不是sign_up时，它会在过滤过程中崩溃。

问题似乎是当操作为“新”时 resource_name 产生 nil，但当它是“sign_up”时很好。我不明白为什么设计关心或代码中表示区别的地方。我查看了其他问题，例如[更新设计的用户控制器](https://stackoverflow.com/questions/4907376/update-the-user-controller-of-devise)和[覆盖设计注册控制器](https://stackoverflow.com/questions/3546289/override-devise-registrations-controller)和[自定义设计控制器](https://stackoverflow.com/questions/4655114/custom-devise-controller)，但他们没有涉及到这个问题。

我得到的具体错误是

> **RegistrationsController 中的 NoMethodError#new**
> 
> nil:NilClass 的未定义方法“名称”

并且迹线的顶部是

> 设计（2.1.2）app/controllers/devise_controller.rb:22:in `resource_name' app/controllers/registrations_controller.rb:104:in` authenticate_scope！'

这显然是第一次引用 devise_mapping 时发生的。但是根据上面的 stackoverflow 问题，我还明确地为 devise_mapping 提供了帮助程序，它们甚至没有被调用。

任何人都可以解释或帮助我找出进一步看的地方吗？

来自 routes.rb：

```
Fs::Application.routes.draw do
  devise_for :users, :controllers => { :registrations => 'registrations' } 
  resources :users, :except => [:index, :show], :controller => 'registrations'
  resources :users, :only => [:index, :show] 
```

[...]

耙路线报告：

```
 new_user_session GET    /users/sign_in(.:format)            devise/sessions#new
            user_session POST   /users/sign_in(.:format)            devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)           devise/sessions#destroy
           user_password POST   /users/password(.:format)           devise/passwords#create
       new_user_password GET    /users/password/new(.:format)       devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format)      devise/passwords#edit
                         PUT    /users/password(.:format)           devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)             registrations#cancel
       user_registration POST   /users(.:format)                    registrations#create
   new_user_registration GET    /users/sign_up(.:format)            registrations#new
  edit_user_registration GET    /users/edit(.:format)               registrations#edit
                         PUT    /users(.:format)                    registrations#update
                         DELETE /users(.:format)                    registrations#destroy
                   users POST   /users(.:format)                    registrations#create
                new_user GET    /users/new(.:format)                registrations#new
               edit_user GET    /users/:id/edit(.:format)           registrations#edit
                    user PUT    /users/:id(.:format)                registrations#update
                         DELETE /users/:id(.:format)                registrations#destroy
                         GET    /users(.:format)                    users#index
                         GET    /users/:id(.:format)                users#show 
```

我的registrations_controller.rb：

```
class RegistrationsController < Devise::RegistrationsController
  prepend_before_filter :authenticate_scope!, :except => [:index, :show]
  skip_filter :require_no_authentication
end 
```

我的 users_helper.rb：

```
module UsersHelper
  # used by devise
  def resource_name
    :user 
  end

  def resource
    @resource ||= User.new
  end

  def devise_mapping
    @devise_mapping ||= Devise.mappings[:user]
  end
end 
```

使用：

导轨 3.2.6

红宝石 1.9.3

设计 2.1.2

更新：粘贴在正确的跟踪输出中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T02:27:33.403

所以一种解决方案似乎是添加

```
 devise_scope :user do
    get '/users/new' => 'registrations#new'
  end 
```

进入 routes.rb。这可能不是最好的答案，但它确实有效。

# java - 如何确认插入查询是否成功？

> ID：11636268
> 
> 赞同：1
> 
> 时间：2012-07-24T17:35:42.247
> 
> 标签：java

我正在使用以下代码插入数据库，它工作正常，因为我可以看到数据填充在数据库中，但是我想以编程方式捕获结果，无论它是成功还是失败

1）这是要插入的代码

```
public void SignUp(String last_name, String first_name, String email,
        String password, String confirm_password, String phone) {

    Connect connect = new Connect();
    Connection conn = connect.Connection();
    Statement stmt = conn.createStatement();

    String query = "INSERT INTO users VALUES(NULL,('" + last_name + "'),('"
            + first_name + "'),('" + email + "'),('" + password + "'),('"
            + confirm_password + "'),('" + phone + "'))";
    stmt.executeUpdate(query);
    conn.close();

} 
```

2）这是我用来连接的代码

```
public Connection Connection() {

    Connection conn = null;

    try {
        String userName = "admin";
        String password = "admin";
        String url = "jdbc:mysql://localhost/project";
        Class.forName("com.mysql.jdbc.Driver").newInstance();
        conn = DriverManager.getConnection(url, userName, password);

        System.out.println("\n Database connection established");

    } catch (Exception e) {
        e.printStackTrace();
        System.err.println("\n Cannot connect to database server");

    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T17:37:11.673

> 执行更新

```
public int executeUpdate(String sql)
                  throws SQLException 
```

> 返回：INSERT、UPDATE 或 DELETE 语句的行数，或 0 用于不返回任何内容的 SQL 语句

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:38:38.663

最简单的方法是直接查询它。[检查 API](http://docs.oracle.com/javase/7/docs/api/java/sql/Statement.html#executeUpdate%28java.lang.String%29)总是一个好主意，但是通过更新，我不确定除非出现异常，否则是否有一种干净的方法来判断它是否成功（除了没有抛出异常）。

作为旁注，请查看[Prepared Statements](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)。在执行未过滤的 sql 时，使用 strait text 通常不是一个好主意。

# ruby-on-rails - 让控制器、路由和隐藏字段按钮在 Rails 中正常工作

> ID：11636276
> 
> 赞同：0
> 
> 时间：2012-07-24T17:36:06.297
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, controller

我想创建一个按钮，以便用户可以注册课程。注册模型属于用户和课程，应该跟踪注册。

我在课程页面上以按钮形式显示以下代码（看起来不错）：

```
<% @enroll = current_user.enrollings.build(course_id: @course.id) %>
<%= form_for(@enroll) do |f| %>  
    <div><%= f.hidden_field :course_id %></div>
    <%= f.submit "Enroll", class: "btn btn-large btn-primary" %>
<% end %> 
```

我有一个用于注册的资源路线，当用户单击该按钮时，该页面将转到 /enrollings。

这是注册控制器中的代码：

```
def create    
@course = Course.find(params[:course_id])
current_user.enroll!(@course)
end 
```

当我单击按钮时，我收到以下错误消息：

> EnrollingsController#create 中的 ActiveRecord::RecordNotFound
> 
> 找不到没有 ID 的课程

为什么它不通过表单传递 course_id？如何正确设置控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:46:02.183

试试这个：

```
<div><%= hidden_field_tag "course_id", @course.id %></div> 
```

# c# - 无法在 activex 控件中初始化 Microsoft.PointOfService

> ID：11636280
> 
> 赞同：0
> 
> 时间：2012-07-24T17:36:15.513
> 
> 标签：c#, javascript, activex

我正在使用 Microsoft.PointOfService.dll 实例化探索类库中的打印机功能。当我从 .cs 代码继承该类库时，它工作正常。但是，当我使用该类库创建 cab 文件以用作 ActiveX 控件并从 javascript 调用相同的方法时，它不会实例化 PosExplorer 并将异常作为“Microsoft.PointOfService.Management 的类型初始化程序。 Explorer 抛出了一个异常。”

我已经使用了配置文件并插入了`<NetFx40_LegacySecurityPolicy enabled="true"/>`

在创建安装文件时我需要做任何额外的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:51:24.753

将以下代码添加到您的 app.config（它肯定可以在 .net 4.0 上运行，您能告诉我您使用的是哪个版本吗？）

```
<configuration>
    <runtime>
          <NetFx40_LegacySecurityPolicy enabled="true"/>
        </runtime>
</configuration> 
```

如果它不起作用，那么您也可以尝试打开该位置：

C:\Program Files (x86)\Common Files\microsoft shared\DevServer\10.0\WebDev.WebServer40.exe.config
在此文件中添加以下行

```
<runtime>
<NetFx40_LegacySecurityPolicy enabled="true"/> 
```

# sql - 随机选择并添加到表中的序号

> ID：11636281
> 
> 赞同：1
> 
> 时间：2012-07-24T17:36:20.533
> 
> 标签：sql, sql-server

[*SO问题*](https://stackoverflow.com/questions/11614928/populate-lookup-table-with-random-values/11615062#11615062)使我想到了以下问题。

如果一个表有 16 行，我想在表中添加一个字段，其中数字 1,2,3,4,5,...,16 随机排列，即在第 1 行的“RndVal”字段中，这可能是2，那么对于第 2 行，它可能是 5，即 16 个整数中的每一个都需要出现一次*而不*重复。

为什么以下不起作用？理想情况下，我希望看到这个工作，然后看到替代解决方案。

这可以创建表：

```
IF OBJECT_ID('tempdb..#A') IS NOT NULL BEGIN DROP TABLE #A END
IF OBJECT_ID('tempdb..#B') IS NOT NULL BEGIN DROP TABLE #B END
IF OBJECT_ID('tempdb..#C') IS NOT NULL BEGIN DROP TABLE #C END
IF OBJECT_ID('tempdb..#myTable') IS NOT NULL BEGIN DROP TABLE #myTable END

CREATE TABLE #B (B_ID INT)
CREATE TABLE #C (C_ID INT)

INSERT INTO #B(B_ID) VALUES
    (10),
    (20),
    (30),
    (40)
INSERT INTO #C(C_ID)VALUES
    (1),
    (2),
    (3),
    (4)

CREATE TABLE #A 
    (
    B_ID INT
    , C_ID INT
    , RndVal INT
    )

INSERT INTO #A(B_ID, C_ID, RndVal)  
SELECT 
        #B.B_ID
        , #C.C_ID
        , 0 
FROM #B CROSS JOIN #C; 
```

然后我尝试使用以下内容添加随机列。逻辑是添加 1 到 16 之间的随机数 > 然后有效地覆盖任何与其他数字重复的数字 > 在循环中...

```
SELECT 
    ROW_NUMBER() OVER(ORDER BY B_ID) AS Row
    , B_ID
    , C_ID
    , RndVal
INTO #myTable
FROM #A

DECLARE @rowsRequired INT = (SELECT COUNT(*) CNT FROM #myTable)
DECLARE @i INT = (SELECT @rowsRequired - SUM(CASE WHEN RndVal > 0 THEN 1 ELSE 0 END) FROM #myTable)--0

DECLARE @end INT = 1
WHILE @end > 0 
    BEGIN

            SELECT @i = @rowsRequired -  SUM(CASE WHEN RndVal > 0 THEN 1 ELSE 0 END) FROM #myTable
            WHILE @i>0
                BEGIN

                    UPDATE x
                    SET x.RndVal = FLOOR(RAND()*@rowsRequired)
                    FROM #myTable x
                    WHERE x.RndVal = 0 

                    SET @i = @i-1
                END 

         --this is to remove possible duplicates
            UPDATE c 
            SET c.RndVal = 0 
            FROM 
                #myTable c
                INNER JOIN 
                    (
                    SELECT RndVal
                    FROM #myTable
                    GROUP BY RndVal 
                    HAVING COUNT(RndVal)>1
                    ) t
                    ON 
                        c.RndVal = t.RndVal

         SET @end = @@ROWCOUNT

    END

TRUNCATE TABLE #A
INSERT INTO #A
SELECT 
    B_ID
    , C_ID
    , RndVal
FROM #myTable 
```

如果原始表有 6 行，那么结果应该是这样的

```
B_ID|C_ID|RndVal
----------------
    |    | 5 
    |    | 4
    |    | 1
    |    | 6
    |    | 3
    |    | 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:47:43.447

坦率地说，我不明白你的代码

这将使用随机数更新每一行，不重复的数字介于 1 和表中的行数之间

```
UPDATE T
SET SomeCol = T2.X
FROM
   MyTable T
   JOIN
   (
   SELECT
      KeyCol, ROW_NUMBER() OVER (ORDER BY NEWID()) AS X
   FROM 
      MyTable
   ) T2 ON T.KeyCol = T2.KeyCol 
```

这更简洁，但无法测试它是否按预期工作

```
UPDATE T
SET SomeCol = X
FROM
   (
   SELECT
      SomeCol, ROW_NUMBER() OVER (ORDER BY NEWID()) AS X
   FROM 
      MyTable
   ) T 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:08:15.877

当您将 TOP (1)（因为您需要更新第一个 RndVal=0 记录）和 +1（因为否则您的零标记没有任何意义）添加到您的更新时，事情将开始发生变化。但是非常慢（在我相当过时的笔记本电脑上大约需要 40 秒）。这是因为，随着#myTable 被生成的随机数填充，丢失数字的可能性越来越小 - 您通常会重复，并且必须重新开始。

```
UPDATE top (1) x
SET x.RndVal = FLOOR(RAND()*@rowsRequired) + 1
FROM #myTable x
WHERE x.RndVal = 0 
```

当然，@gbn 有完全有效的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:58:22.503

这与上一个答案基本相同，但特定于您的代码：

```
;WITH CTE As
(
    SELECT B_ID, C_ID, RndVal, 
    ROW_NUMBER() OVER(ORDER BY NewID()) As NewOrder
    FROM #A
)

UPDATE  CTE
SET     RndVal = NewOrder

SELECT * FROM #A ORDER BY RndVal 
```

# mysql - 按分组列分组？

> ID：11636282
> 
> 赞同：0
> 
> 时间：2012-07-24T17:36:22.330
> 
> 标签：mysql, group-by

我有一个节点喜欢表，大致如下所示：

```
lid nid uid type
1   23  3   like
2   23  1   like
3   49  3   dislike
4   11  6   like 
```

lid = 此表的唯一 ID，nid =“节点”（内容）ID，uid = 用户 ID 和类型是不言自明的。

使用此查询：

```
SELECT nid, COUNT(lid) AS score, type
FROM node_likes
INNER JOIN users ON node_likes.uid = users.uid
GROUP BY nid, type 
```

我可以得到每个节点的喜欢和不喜欢分数。内连接无关紧要；一些（不）喜欢来自不再存在的用户，加入是为了消除它们。

结果如下所示：

```
nid score type
307 4     like
307 1     dislike
404 24    like 
```

然后如何按 对这个查询进行分组`type`，并返回每个“喜欢”类型（喜欢/不喜欢）的得分最高的节点 ID？

IE。

```
nid score type
404 24    like
307 1     dislike 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:00:52.987

```
SELECT
    SUBSTRING_INDEX(GROUP_CONCAT(nid ORDER BY likes DESC),',',1) as most_likes_nid,
    MAX(likes) as most_likes,
    SUBSTRING_INDEX(GROUP_CONCAT(nid ORDER BY dislikes DESC),',',1) as most_dislikes_nid,
    MAX(dislikes) as most_dislikes
FROM (
    SELECT 
        nid,
        COUNT(IF(type = 'like', 1, null)) as likes,
        COUNT(IF(type = 'dislike', 1 ,null)) as dislikes
    FROM node_likes
    GROUP BY nid 
) as t 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:58:51.330

尝试这个：

```
SELECT 
    nid, max(score) as score, type
FROM (
    SELECT nid, COUNT(lid) AS score, type
    FROM node_likes
    INNER JOIN users ON node_likes.uid = users.uid
    GROUP BY nid, type
) results
GROUP BY type
ORDER BY type DESC, score DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:52:33.327

```
 SELECT nid, COUNT(lid) AS score, type
    FROM node_likes
    INNER JOIN users ON node_likes.uid = users.uid
    GROUP BY nid, type        
    ORDER BY type DESC, score DESC; 
```

可能会成功。

# facebook - Facebook喜欢依靠详细信息和主页

> ID：11636283
> 
> 赞同：1
> 
> 时间：2012-07-24T17:36:23.700
> 
> 标签：facebook, facebook-graph-api

我有一个向访客展示房屋的网站。当用户想要查看房子时，他/她点击查看房子，将显示一个详细信息页面。网址为`www.myhouses/details/123`（123 是房子的唯一 ID）。

`www.myhouses/details/123`我在详细信息屏幕 ( ) 中添加了 Facebook 点赞按钮。这个“点赞”会计入 www.myhouses（整个网站）的点赞数还是仅计入特定的 url。

在上述情况下，有没有办法让我的页面上的所有 Facebook 喜欢计数？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:43:31.827

这取决于。当您创建一个赞按钮时，您将传递您要赞的 URL。

文档显示：

```
<iframe src="https://www.facebook.com/plugins/like.php?href=YOUR_URL"
        scrolling="no" frameborder="0"
        style="border:none; width:450px; height:80px"></iframe> 
```

如果你放：

```
<iframe src="https://www.facebook.com/plugins/like.php?href=www.myhouses.com"
        scrolling="no" frameborder="0"
        style="border:none; width:450px; height:80px"></iframe> 
```

你会喜欢你的网站，如果：

```
<iframe src="https://www.facebook.com/plugins/like.php?href=www.myhouses.com/details/123"
        scrolling="no" frameborder="0"
        style="border:none; width:450px; height:80px"></iframe> 
```

你会喜欢你的房子链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:44:27.050

这取决于您是否在类似 fb 的 div 中定义了 data-href 属性。

了解您网站上的所有喜欢。据我所知（如果错了，请纠正我）。您需要使用 Facebook Graph 或使用 FQL 来映射您的所有网站 url 和请求，以获取每个页面的类似内容，因此，总和。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:40:14.307

好吧，如果你没有用`data-href`属性定义它，它将使用当前的 URL，否则它将使用定义的 URL。

```
<div class="fb-like" data-href="http://www.yourdomain.com" data-send="false" data-width="450" data-show-faces="false"></div> 
```

# ruby-on-rails - ActiveRecord::RecordNotFound in UserController#show

> ID：11636286
> 
> 赞同：0
> 
> 时间：2012-07-24T17:36:44.887
> 
> 标签：ruby-on-rails, ruby, activerecord, controller

您好我正在开发一个关于用户注册的应用程序，但是当用户 X 想要编辑他的信息时，该应用程序正在“编辑”而不是用户 ID，并向我显示以下错误：

```
ActiveRecord::RecordNotFound in UserController#show

Couldn't find User with id=edit 
```

（我正在为用户使用设计），这是我的 home.html.rb

```
<body>
<div class="container">

  <% if signed_in? %>
    <table class="front" summary="For signed-in users">
      <tr>
        <td class="main">
          <h1 class="micropost">What's up?</h1>
          <%= link_to "edit your profile", edit_user_registration_path, :class => "signup_button round" %>
        </td>
      </tr>
    </table>
  <% else %>

    <h1>Sample App</h1>
    <p>
    This is the home page for the <a href="http://railstutorial.org/">Ruby on Rails Tutorial</a> sample application.
    </p>
    <%= link_to "Sign up now!", new_user_registration_path, :class => "signup_button round" %>
  <% end %>
 </div> 
```

这是我的 routes.rb （我知道它应该是用户，但如果我把它作为复数不工作）

```
Estaciones::Application.routes.draw do
root :to => "static_pages#home"
match '/contact', :to=>'static_pages#contact'
match '/about', :to=>'static_pages#about'
get "user/:id" => "User#show"
devise_for :user
resources :user do
end 
```

最后这里是我的 UserController

```
class UserController < ApplicationController

def new
     @user = User.new
end

def create
    @user = User.new(params[:user])
    if @user.save
        redirect_to user_session_path
    else
    redirect_to new_user_session_path
end

end

def show
    @user = User.find(params[:id])
    #redirect_to @user
end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:04:30.143

您需要指定一个用户 ID，以便 Rails 生成正确的路由。

```
edit_user_registration_path ( USER_ID ) 
```

您没有将任何 user_id 传递给 home.html.erb 中的方法。

# java - 将 Spring 从 3.0.x 更新到 3.1.2 导致表单选择框不显示列表 tostring

> ID：11636289
> 
> 赞同：0
> 
> 时间：2012-07-24T17:36:53.233
> 
> 标签：java, spring, maven

最近我将 Spring 从 3.0.5 升级到 3.1.2。一切正常，除了在我的表单上，我的所有选择框都显示枚举值而不是之前显示的 toString 值。

我的枚举是：

```
public enum StateType {

    ALABAMA("AL", 1, "Alabama"),
          etc

    StateType(String abbreviation, int code, String displayText) {
        this.abbreviation = abbreviation;
        this.code = code;
        this.displayText = displayText;
    }

          public String toString() {
             return displayText;
          }
} 
```

我的控制器然后有这个：

```
 @ModelAttribute("stateList")
public static StateType[] populateStateList() {
    return StateType.values();
} 
```

我的表格有这个片段：

```
<form:select path="state" id="state" items="${stateList}" style="width:12em" dojoType="dijit.form.FilteringSelect"/> 
```

这一切都在 3.0.5 中起作用。出于某种原因，在 3.1.2 中从未调用过 toString。我在屏幕上的选择框显示枚举常量 (ALABAMA)。

有什么改变的想法吗？我使用 maven 来跟踪我的依赖项。我所做的只是更新我的春季版本常量。也许我需要更新其他一些依赖项？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T16:45:46.600

我实施了以下解决方案。这没关系，因为我有一个较小的项目。这对于大型项目可能是不可接受的。

为我的枚举添加了一个吸气剂：

```
public enum StateType { 

ALABAMA("AL", 1, "Alabama"), 
      etc 

StateType(String abbreviation, int code, String displayText) { 
    this.abbreviation = abbreviation; 
    this.code = code; 
    this.displayText = displayText; 
} 

public String getDisplayText() {
   return this.displayText;
}

      public String toString() { 
         return displayText; 
      } 
```

}

在表格上添加：

```
<form:select path="state" id="state" items="${stateList}" itemLabel="displayText" style="width:12em" dojoType="dijit.form.FilteringSelect"/> 
```

这现在按预期工作。就像我提到的那样，这种解决方法对于大型项目可能是不可接受的。

# c++ - assert() 函数未在反汇编中显示

> ID：11636291
> 
> 赞同：3
> 
> 时间：2012-07-24T17:37:02.687
> 
> 标签：c++, compiler-construction

我的同事只是让我帮忙解决一个问题，他的代码中有几行

```
for (long counter = 0; counter < End; )
{
  ...
  assert(counter++ < MAX);
  ...
} 
```

问题是，当我们使用 Visual Studio 逐行调试时，assert() 行似乎一直被跳过，并且`counter`从未递增，因此循环从未完成。

当我们使用 VS 查看反汇编时，没有这个 assert() 函数的组装线。我以前从未使用过 assert()，所以我想知道这是否正常，他不应该将任何代码行为放入 assert() 中，或者调试器或其他有什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:39:33.387

确保*未定义*，因为`NDEBUG`仅在调试构建中启用，即未定义时。*`assert``NDEBUG`*

 *从[这里](http://en.cppreference.com/w/cpp/error/assert)：

```
#ifdef NDEBUG
#define assert(condition) ((void)0)
#else
#define assert(condition) /*implementation defined*/
#endif 
```

也就是说，when`NDEBUG`被定义`assert`为无操作，这是您在汇编中观察到的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T17:40:45.960

**您应该只将 assert 用于调试目的。**

线

```
assert(counter++ < MAX); 
```

包含逻辑，它不应该。

在非调试版本中，它永远不会被执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T17:40:01.000

`assert` is a macro, which is removed in release builds. So unless you're looking at a debug build, don't expect to see any `assert` code.

And because `assert` is a macro, and not a function, it's not likely to look like a single function call either.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T17:40:24.447

断言通常会从发布版本中删除，因此仅在调试版本中执行。你不应该有任何副作用影响断言中的程序逻辑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T17:45:52.853

如果代码是在发布模式下构建的，则不会包含断言语句。您的同事是否在使用发布模式？

Visual Studio 的优化设置也可能会删除断言语句。

您的同事不能将 for 循环更改为不使用 assert 语句吗？*

# php - 根据下拉选择从数据库中填充另一个选择下拉列表

> ID：11636293
> 
> 赞同：6
> 
> 时间：2012-07-24T17:37:18.380
> 
> 标签：php, javascript, ajax

我正在构建一个网站来学习编码，并尝试构建一个工具，用户单击一个选择/下拉列表，其中包含从数据库**cat**中提取的一些类别名称，然后将出现另一个选择，其中包含从数据库**subcat**中提取的子类别名称。这几乎与 Yelp 的（进入类别）[和 Yelp 的（进入](http://www.yelp.com/biz_attribute?biz_id=Jsuy0DN6NhILXSkHr6UpCA)类别）一模一样。

我还做了一个图表：

![在此处输入图像描述](../Images/400b7705502b8221b308ce4740587e2c.png)

**我已经有一个从cat**数据库中提取的类别下拉列表：

```
<p><b>Category:</b><br />
 <?php
  $query="SELECT id,cat FROM cat";
  $result = mysql_query ($query);
  echo"<select name='cselect3' class='e1'><option value='0'>Please Select A       Category</option>";
  // printing the list box select command
  while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
  echo "<option value=\"".htmlspecialchars($catinfo['cat'])."\">".$catinfo['cat']."    </option>";

  }

echo"</select>";
?> 
```

我有一个从 subcat 数据库中提取的 subcat：

```
<p><b>Subcat1:</b><br />
<?php
  $query="SELECT id,subcat FROM subcat";
  $result = mysql_query ($query);
  echo"<select name='sselect1' class='e1'><option value='0'>Please Select A Category</option>";
  // printing the list box select command
  while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
      echo "<option value=\"".htmlspecialchars($catinfo['subcat'])."\">".$catinfo['subcat']."</option>";

  }

 echo"</select>";
?> 
```

如何根据用户单击的类别创建子类别下拉列表并使其自动显示？非常感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-24T18:03:58.387

我只是将变量放入带有 php 的 javascript 中，然后使用 javascript 函数.. 不需要 jquery 或 AJAX。

但是，无论如何，您都需要为子类别提供外键..即-对于 subcat 表中的每条记录，您都需要给它一个 catid 以便引用...

```
<?php
  $db = new mysqli('localhost','user','password','dbname');//set your database handler
  $query = "SELECT id,cat FROM cat";
  $result = $db->query($query);

  while($row = $result->fetch_assoc()){
    $categories[] = array("id" => $row['id'], "val" => $row['cat']);
  }

  $query = "SELECT id, catid, subcat FROM subcat";
  $result = $db->query($query);

  while($row = $result->fetch_assoc()){
    $subcats[$row['catid']][] = array("id" => $row['id'], "val" => $row['subcat']);
  }

  $jsonCats = json_encode($categories);
  $jsonSubCats = json_encode($subcats);

?>

<!docytpe html>
<html>

  <head>
    <script type='text/javascript'>
      <?php
        echo "var categories = $jsonCats; \n";
        echo "var subcats = $jsonSubCats; \n";
      ?>
      function loadCategories(){
        var select = document.getElementById("categoriesSelect");
        select.onchange = updateSubCats;
        for(var i = 0; i < categories.length; i++){
          select.options[i] = new Option(categories[i].val,categories[i].id);          
        }
      }
      function updateSubCats(){
        var catSelect = this;
        var catid = this.value;
        var subcatSelect = document.getElementById("subcatsSelect");
        subcatSelect.options.length = 0; //delete all options if any present
        for(var i = 0; i < subcats[catid].length; i++){
          subcatSelect.options[i] = new Option(subcats[catid][i].val,subcats[catid][i].id);
        }
      }
    </script>

  </head>

  <body onload='loadCategories()'>
    <select id='categoriesSelect'>
    </select>

    <select id='subcatsSelect'>
    </select>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T17:49:07.033

由于子类别下拉列表中的数据取决于类别中选择的内容，因此您可能希望使用 ajax。您可以在您的类别下拉列表中设置一个事件侦听器，当它发生更改时，您可以请求子类别下拉列表的数据并填充它，有很多不同的方法可以解决它，下面是一个选项（使用 jquery）让你开始了。

```
// warning sub optimal jquery code 
$(function(){

   // listen to events on the category dropdown
   $('#cat').change(function(){

       // don't do anything if use selects "Select Cat"
       if($(this).val() !== "Select Cat") {

           // subcat.php would return the list of option elements 
           // based on the category provided, if you have spaces in 
           // your values you will need to escape the values
           $.get('subcat.php?cat='+ $(this).val(), function(result){
               $('#subcat').html(result);
           });

       }

   });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:43:19.720

如果您使用的是 AJAX，您将希望第二段代码成为一个单独的 php 文件，您将通过 AJAX 调用该文件。在来自 AJAX 调用的回调中，只需执行 (pseudo-code): `someContainingDivOrSomething.innerHtml = responseBody;`。

请注意，直接在 PHP 显示文件中进行查询通常是一个坏主意（关注点分离）。还有其他一些可以改进的地方。但是，这将使您入门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T17:57:15.823

在登陆页面上制作这个 html 结构

```
<p><b>Category:</b><br />
 <?php
  $query="SELECT id,cat FROM cat";
  $result = mysql_query ($query);
  echo"<select name='cselect3' onChange='loadSubCats(this.value)' class='e1'><option value='0'>Please Select A       Category</option>";
  // printing the list box select command
  while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
  echo "<option value=\"".htmlspecialchars($catinfo['cat'])."\">".$catinfo['cat']."    </option>";

  }

echo"</select>";
?>

<div id='sub_categories'></div> 
```

将 js 函数分配给类别下拉列表

```
function loadSubCats(value)
{
  $.post('load_sub_cats.php',{catid : value},function{data}
                                             {
                                              $('#sub_categories').html(data);

                                             });

} 
```

现在在你的 load_sub_cats.php

```
<p><b>Subcat1:</b><br />
<?php
  $catid = $_POST['cat_id']
  $query="SELECT id,subcat FROM subcat where catid = $catid";
  $result = mysql_query ($query);
  echo"<select name='sselect1' class='e1'><option value='0'>Please Select A Category</option>";
  // printing the list box select command
  while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
      echo "<option value=\"".htmlspecialchars($catinfo['subcat'])."\">".$catinfo['subcat']."</option>";

  }

 echo"</select>";
?> 
```

您需要在此代码工作中包含 jquery。

# javascript - “on”事件未触发动态内容

> ID：11636294
> 
> 赞同：0
> 
> 时间：2012-07-24T17:37:20.817
> 
> 标签：javascript, jquery

我有以下代码，它*在*事件上使用 jquery。

```
 $(document).on('click', 'a.test', function (event) {
        alert('');
    }); 
```

我的问题是这不会触发通过 ajax 动态添加的内容：

```
$.ajax({
    url: ...,
    ...
    ..
    success: function(response) {

        var dom = $(response.d.html);
        myContainer.html(dom.find('#ajaxcontainer'));
    }
}); 
```

你能帮我解决这个问题吗？我正在使用 jquery.1.7.2.min.js

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:53:04.873

我没有任何奇怪的问题......我认为你可能需要像调用 .on('click') 事件上的函数一样调用你的 ajax。

[jsFiddle 链接](http://jsfiddle.net/BEdwW/)

```
var myContainer = $('body');

$(document).on('click', 'a', function () {
  $.ajax({
    url: '#',
    success: function(response) {
        // of course here i'm appending just a regular link, but your response data would include all that html
        myContainer.append('<a class="ajaxAdded">Click this</a>');

    }
  });
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:58:26.960

发生的情况是，由于`$.ajax`它是一个异步函数，您的`on`方法无法访问它创建的内容，可能是因为该内容尚未准备好，您需要确保您已经完成了触发事件的 ajax 请求，您可以这样做像这样检查一下：

```
var done = false;
$.ajax({ /*bla bla bla*/ }).done(function(){ done = true; });

if(done){/* now you can fire the event */ } 
```

# c++ - C++ 冻结测试成员变量是否等于 NULL

> ID：11636300
> 
> 赞同：0
> 
> 时间：2012-07-24T17:38:02.330
> 
> 标签：c++, binary-tree, eclipse-cdt, tree-traversal, huffman-code

我创建了一个程序，到目前为止，它为 Huffman 编码程序创建了一个节点的二叉树。出于某种原因，当调试器到达它测试两个孩子是否等于 Null 的地步（因此树上有一个实际字符而不仅仅是一个父级）时，程序会冻结。Codes 是每个对象的代码数组，由具有两个成员变量的 Code 结构组成。

```
void Huff::traverse(Node* root, vector<Code>* code, string code_base){
    if(root->childL == NULL && root->childR == NULL){ //stops here
        Code c;
        c.content = root->litteral;
        c.symbol = code_base;
        code->push_back(c);
    }else{
        if (root->childL != NULL)
            traverse(root->childL, code, code_base + '0');
        if (root->childR != NULL)
            traverse(root->childR, code, code_base + '1');
    }
} 
```

调用这个的函数是（它在最后被调用）：

```
vector<Code>* Huff::compress(){
    //-------GETTING WEIGHTS/FREQUENCIES------
    vector<Node *>* nodes = new vector<Node*>; // Vector of nodes for later use
    map<char, int>* freq = new map<char, int>; //  Map to find weight of nodes
    for(unsigned int i = 0; i < content.length(); i++)
        (*freq)[content[i]]++; 
    CopyTo copyto(nodes); //sets vector<Node*> to copy to 
    for_each(freq->begin(), freq->end(), copyto); // Copies 
    delete freq;
    vector<Node *>::iterator beg = nodes->begin();

    //-------SETTING UP TO BUILD TREE------
    if(nodes->size() % 2 == 1){ //makes sure there are an even number of nodes
        Node* fill = new Node;
        fill->set_node(0, '*', NULL, NULL);
        nodes->push_back(fill);
    }
    huff_sort(nodes); // sort nodes by weight

    //-------BUILDING TREE------
    while(nodes->size() != 1){ //Sorts nodes by weight and then removes two of them and replaces them with one
        int w= (**beg).weight + (**(beg+1)).weight;
        Node* p = new Node;
        p->set_node(w, '*', *nodes->begin(), *(nodes->begin()+1)); //making it the parent node of the two lowest nodes
        nodes->erase(nodes->begin(), nodes->begin()+2);
        unsigned int i = 0;
        while(w > (*nodes)[i]->weight && i <= nodes->size()){ //finds where to insert the parent node based on weight
            i++;
        }
        if(i > nodes->size()) //if it needs to be inserted at the end
            nodes->push_back(p);
        else
            nodes->insert(nodes->begin()+i, p);
        delete p;
    }

    //-------TRAVERSING TREE------
    Node* root = (*nodes)[0];
    delete nodes;
    vector<Code>* codes;
    traverse(root, codes , "");
    delete root;
    return codes;
} 
```

注意：遍历树代码块之前的while循环是创建树的地方

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:42:19.297

检查是否`root`指向某物 ( `if (root) ...`)。这应该会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:46:44.340

你需要`delete nodes;`打电话后说`traverse`。你现在所拥有的东西在你打电话之前就说明了这`root`一点。`NULL``traverse`

# linker - 静态库中的 fPIC 代码：为什么？怎么了？

> ID：11636304
> 
> 赞同：2
> 
> 时间：2012-07-24T17:38:43.060
> 
> 标签：linker, solaris, x86-64, relocation, fpic

将位置无关代码放在静态库中会发生什么？（特别是在 x86-64 上）

也就是说：`.o`用PIC生成几个文件，放在一个`.a`文件中。这`.a`像往常一样静态链接到最终的可执行文件中。

它似乎有效，但这样做有意义吗？为什么？

最后的地址计算是怎么做的？（链接时间？运行时间？）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T10:46:08.330

IIRC 在 PIC 系统中所有全局变量都将通过 PIC 访问。

PIC 的整个想法是只需要调整一个表（GOT），而不是代码中的每个全局访问。

代码本身是位置无关的，因为它通过 GOT 访问，并且 GOT 的位置（相对于指令的地址）在最终链接期间被编码。

所以它是一个混合体。有些是在最终链接期间完成的（编码 GOT 偏移），有些是在启动时完成的（GOT 重定位/修复），还有一些没有完成（代码重定位）。

# linq - Linq 将一个表中的值分配到另一个表中

> ID：11636306
> 
> 赞同：1
> 
> 时间：2012-07-24T17:38:45.293
> 
> 标签：linq, join

我正在尝试从另一个表中查找列的值，然后在 where 子句中使用新查找的值。例如，我有以下表格

```
ID    Name
 1     Jan
 2     Feb
 3     March

Product    Customer  Start   End
  A          C        Feb    March
  A          B        Jan    March
  B          C        March  Jan 
```

在上面的示例中，我需要查询 Start ID 大于 End ID 的记录列表。例如，BC-March-Jan 是我要查找的记录。我应该使用加入吗？此外，如果可能的话，查询语法将非常有帮助。

我的查询：

```
 var vInvalidStartEnd = from p in vRecords
                        where (from t in vTimePeriods where t.Name == p["Start"] select t.TID).First().Cast<int>() > (from t in vTimePeriods where t.TName == p["End"] select t.ID).First().Cast<int>()
                        select new
                        {
                           Product = p["Product"],
                           Location = p["Location"],
                           Start = p["Start"],
                           End = p["End"]
                        }; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:36:40.957

假设 ID 定义了比另一个名称晚的名称。Tim 在评论中的问题可能是因为，首先，使用名称值而不是 ID 作为链接是不寻常的，其次，ID 不能很好地指示哪个月份大于另一个月份。如果我*必须*按照您的方式使用月份名称，我可能会在 vTimePeriods 表中拥有一个 id、一个名称和一个订单值。

```
from p in vRecords
join start in vTimePeriods on p["Start"] equals start["Name"]
join end in vTimePeriods on p["End"] equals end["Name"]
where (int)end["ID"] < (int)start["ID"]
select new
{
    Product = p["Product"],
    Location = p["Location"],
    Start = p["Start"],
    End = p["End"]
}; 
```

我不知道 Linq to Dataset 的细节，但它看起来像这样。

# mysql - MySQL 中 COUNT() 列的 SUM()

> ID：11636313
> 
> 赞同：0
> 
> 时间：2012-07-24T17:39:27.240
> 
> 标签：mysql, sql

我有以下查询：

```
SELECT COUNT(employees.id) AS emp_count 
FROM `orders` 
INNER JOIN `companies` ON `companies`.`id` = `orders`.`company_id` 
INNER JOIN employees ON employees.company_id = companies.id
  AND (employees.deleted_at >= companies.activate_at OR employees.deleted_at IS NULL)                       
  AND employees.created_at <= companies.activate_at 
WHERE 
  (companies.activate_at BETWEEN '2012-01-31 23:00:00' AND '2012-02-29 22:59:59'                    
   AND orders.type = 'Order::TrialActivation'
   AND orders.state = 'completed') 
```

我需要所有“emp_count”列的总和。目前，我遍历上述查询返回的所有行，然后在 Ruby 中对“emp_count”进行 SUM。但是有很多行，所以这会占用很多内存。

我如何在 SQL 中对“emp_count”求和并只返回这个数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:42:35.900

**- - 更新： - -**

由于问题已更新，我将更新我的答案：

如果您试图根据`WHERE`语法从查询中获取行数，那么您可以使用`COUNT()`. 但是，如果您想要`employees.id`查询中所有值的总和，则更`COUNT(employees.id)`改为`SUM(employees.id)`，这应该可以满足您的需求。

**--- 原始答案 ---**

尝试使用子查询，有点像这样（代码未测试）：

```
SELECT SUM(x.emp_count) FROM (
    SELECT COUNT(employees.id) AS emp_count 
    FROM `orders` 
    INNER JOIN `companies` ON `companies`.`id` = `orders`.`company_id` 
    INNER JOIN employees ON employees.company_id = companies.id
      AND (employees.deleted_at >= companies.activate_at OR employees.deleted_at IS NULL)                       
      AND employees.created_at <= companies.activate_at 
    WHERE 
      (companies.activate_at BETWEEN '2012-01-31 23:00:00' AND '2012-02-29 22:59:59'                    
       AND orders.type = 'Order::TrialActivation'
       AND orders.state = 'completed')
) x; 
```

[您可以在MySQL 文档](http://dev.mysql.com/doc/refman/5.6/en/from-clause-subqueries.html)中阅读有关子查询的更多信息，另请参阅：[如何 SUM() MySQL 中的多个子查询行？](https://stackoverflow.com/questions/3785600/how-to-sum-multiple-subquery-rows-in-mysql)

# sql - Postgresql - 在多个表上执行左连接时遇到问题

> ID：11636314
> 
> 赞同：7
> 
> 时间：2012-07-24T17:39:30.113
> 
> 标签：sql, postgresql, syntax-error

我正在将一些 Mysql 查询移至 Postgresql，但我遇到了这个不起作用的查询。

```
select (tons of stuff)
from trip_publication 

left join trip_collection AS "tc" on
tc.id = tp.collection_id

left join 
            trip_author ta1, (dies here)
            trip_person tp1,
            trip_institution tai1,
            trip_location tail1,
            trip_rank tr1
    ON
            tp.id = ta1.publication_id 
            AND tp1.id = ta1.person_id 
            AND ta1.order = 1 
            AND tai1.id = ta1.institution_id 
            AND tail1.id = tai1.location_id 
            AND ta1.rank_id = tr1.id 
```

该查询似乎在“trip_author ta1”行上消失了，我在上面标记了它。实际的错误信息是：

```
 syntax error at or near ","
   LINE 77:   (trip_author ta1, trip_person tp1, ... 
```

我浏览了文档，它似乎是正确的。我在这里到底做错了什么？任何反馈将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T17:40:53.467

我不知道 postgres，但在常规 SQL 中，您需要一系列`LEFT JOIN`语句而不是逗号语法。你似乎已经开始了，然后在前两个之后停止了。

就像是：

```
SELECT * FROM
table1 
LEFT JOIN table2 ON match1
LEFT JOIN table3 ON match2
WHERE otherFilters 
```

另一种方法是较旧的 SQL 语法：

```
SELECT cols
FROM table1, table2, table3
WHERE match AND match2 AND otherFilters 
```

您的 SQL 中还有一些其他较小的错误，例如您在第一个表上忘记了`tp`别名，并尝试将`where`子句 ( `ta1.order = 1`) 作为连接约束。

我认为这就是你所追求的：

```
select (tons of stuff)
from trip_publication tp 
left join trip_collection AS "tc" on tc.id = tp.collection_id
left join trip_author ta1 on ta1.publication_id  = tp.id
left join trip_person tp1 on tp1.id = ta1.person_id 
left join trip_institution tai1 on  tai1.id = ta1.institution_id 
left join trip_location tail1 on tail1.id = tai1.location_id 
left join trip_rank tr1 on tr1.id = ta1.rank_id
where ta1.order = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:42:51.453

您的左联接是您要加入的每个表一个

```
left join trip_author ta1 on ....
left join trip_person tp1 on ....
left join trip_institution on ... 
```

...等等

# c# - 源重置后扩展器分组崩溃

> ID：11636319
> 
> 赞同：4
> 
> 时间：2012-07-24T17:39:45.477
> 
> 标签：c#, wpf, xaml

我有一个带有一些模板的列表框。组由扩展器表示。列表框链接到文件系统，每个文件夹都有自己的扩展器。任何时候重命名、删除文件等，都会刷新列表框的视图。这很好用，但是一旦调用了刷新，每个扩展器都会崩溃。我似乎找不到让它们保持开放的好方法。我看到另一个使用绑定来解决单个扩展器的问题。“IsExpanded”上的数据绑定的问题是存在未知数量的扩展器，我无法在设计时知道会有多少，它们将被称为什么等。有任何想法吗？

```
<ListBox.GroupStyle>
        <GroupStyle>
           <GroupStyle.ContainerStyle>
              <Style TargetType="{x:Type GroupItem}">
                 <Setter Property="Template">
                    <Setter.Value>
                       <ControlTemplate TargetType="{x:Type GroupItem}">
                          <Expander VerticalAlignment="Top"
                              OverridesDefaultStyle="True"
                              Template="{StaticResource SimpleExpanderTemp}">
                             <Expander.Header>
                                <TextBlock VerticalAlignment="Center"
                                     Background="Transparent"
                                     Text="{Binding Path=Name}"
                                           FontFamily="SegoeUI"
                                     FontSize="16"
                                     Foreground="Black"/>
                             </Expander.Header>
                             <Expander.Tag>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                   <GradientStop Offset="0.0" Color="#696969" />
                                   <GradientStop Offset="1.0" Color="#474747" />
                                </LinearGradientBrush>
                             </Expander.Tag>
                             <ItemsPresenter/>
                          </Expander>
                       </ControlTemplate>
                    </Setter.Value>
                 </Setter>
              </Style>
           </GroupStyle.ContainerStyle>
        </GroupStyle>
     </ListBox.GroupStyle> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:25:40.087

一种可能的解决方案是仍然在 IsExpanded 属性上使用数据绑定。

不是绑定到布尔值，而是绑定到布尔值列表并使用 ValueConverter 从列表中检索适当的项目。

创建所有扩展器时，如果还没有，请给每个扩展器一个索引号。然后在绑定 IsExpanded 属性时，设置 Converter，并将转换器参数设置为扩展器的索引号。然后您的转换器将接收布尔值列表作为“值”参数和索引号作为“参数”参数，然后您的转换器可以返回一个布尔值。

您的转换器可能如下所示：

```
public class ListToBooleanConverter : IValueConverter
{

  public object Convert(object value, System.Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    if ((value != null) & (parameter != null)) {
      try {
        Int16 itmNum = Convert.ToInt32(parameter);
        List<bool> lst = value;
        return lst[itmNum];
      } catch (Exception ex) {
        return null;
      }
    }
      return null;
  }

  public object ConvertBack(object value, System.Type targetType, object parameter, System.Globalization.CultureInfo culture)
  {
    throw new NotImplementedException("This method or operation is not implemented.");
  }
} 
```

在 XAML 中，此数据绑定和转换器的实现如下所示（对于索引号为 5 的扩展器）：

```
IsExpanded="{Binding Path=ListIsExpanded, Converter={StaticResource ListToBooleanConverter}, ConverterParameter=5}"> 
```

显然，在代码中，这个实现看起来会有些不同。

# javascript - ASCX and ASPX Mayhem.

> ID：11636321
> 
> 赞同：1
> 
> 时间：2012-07-24T17:40:01.237
> 
> 标签：javascript, asp.net, vb.net, ascx

**BACKSTORY** I am building a module that extends a .NET web app that I did not develop. All I know is that if I create a "view.ascx" file, populate it with the appropriate vb .net html and javascript code and put that file in the right place, that some good stuff is going to happen. Im having issues though.

My Goal, enable a web based TWAIN scanning utility.(I'm using a scanner to get a picture of the sole of the foot of a patient.) The scanning plugin (DynamicWebTwain) has the ability to set some http form fields and call a post method to an action page (aspx) file. The action page should then use those fields to store the file and make write a record in SQL with a pointer to the uplaoaded file destination and associated that with the patient chart id. The uploaded file name, storage path etc are all composed of data that sits in variables in the application mentioned above.

**ISSUES**

1.  The view.ascx file (which encodes the reading of the application variable instances, the plugin embedding and the JS triggers) is loaded one time when the application loads. Therefore, the patient specific information, captured in a form is not actually available unless I reload the page. This of course is because you cant specify the patient demographics before the application is opened.
2.  As a result of item 1\. I am unable to set form fields with meaningful information and as such cannot pass it to the actionpage.aspx and upload and save everything properly in the filesystem and DB in the first pass.

**WORKFLOW SUMMARY**

1.  Patient enters, dr loads web app. at this time the variables pertaining to the Patient are empty. the control is not reloaded at any point and those variables remain unchanged (blank) in my module as the Dr. navigates through the app. Dr. puts in PT name and DOB and clicks next which goes to the Scanner form.
2.  Scanner module has not refreshed variable data. Dr. Takes scan via plugin, triggers JS to set and drive scanner, is presented with a Save button, Save button sets form fields and calls the action page.

**ATTEMPTED WORKAROUNDS**

1.  Point the action page to the ascx file, in other words call myself - **FAIL** - Would love a good explanation of why this is not OK.
2.  Re-evaluate tha variables within the actionpage.aspx file. ( well to do that i tried using the same references in the headers as found in my view.ascx file

    "<%@ Control Language="vb" AutoEventWireup="false" Inherits="DriveWorks.Live.Parts.Modules.LiveModuleControl" %> <%@ Import Namespace="DriveWorks.Live.Parts.Theme" %>"

And of course this did not fly - **FAIL** - If I could somehow talk to the application again from the actionpage.aspx file, i.e. call another ASCX page that would revaluate the variables and give me back the results, then that might solve my problems. Would love a good explanation on feasibility and approach with code samples.

Still green please be kind and Mind you the web app that I am building the module for is a black box to me..

# java - 在 Preference Activity 中，创建要为应用启用的主题列表视图

> ID：11636323
> 
> 赞同：0
> 
> 时间：2012-07-24T17:40:13.997
> 
> 标签：java, android, android-listview, themes, preferenceactivity

我有一个应用程序，其中我有一个偏好活动，它加载我的设置 xml。现在，我想做的是实现主题列表视图以启用应用程序。大多数情况下，我知道如何在设置 xml 中设置列​​表视图，但我不知道如何为应用程序启用不同的主题。谁能指出我正确的方向。或者有一些示例代码。

这是我的 Preference JAVA 文件，下面是我的设置 XML。

```
 public class Prefs extends PreferenceActivity {

ListPreference listPreference;

protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.settingsbasic);
        //New 
        Preference customPref = (Preference) findPreference("clearcache");
        customPref.setOnPreferenceClickListener(new OnPreferenceClickListener() {

                                public boolean onPreferenceClick(Preference preference)    {
                                        Toast.makeText(getBaseContext(),
                                                        "Cache Cleared",
                                                        Toast.LENGTH_LONG).show();
                                        WebViewClientDemoActivity.web.clearCache(true);
                                        return false; 

                                } 
```

我的代码中还没有我的列表视图，任何关于如何实现的帮助都会很好。我只有一个清除缓存按钮。

这是我的设置 XML。

```
 <PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">

    <CheckBoxPreference android:key="themes"
            android:title="@string/themes" 
            android:summary="@string/themes_list"
            android:defaultValue="true" />

    <CheckBoxPreference android:key="something"
             android:title="@string/cache" 
             android:summary="@string/somethingelse"
             android:defaultValue="true" />
    <Preference
            android:title="Clear Cache"
            android:summary="Hopefully this Works"
            android:key="clearcache" />

    </PreferenceScreen> 
```

我有 2 个复选框，我想将第一个复选框更改为列表视图，并拥有一组主题列表。我只是不知道如何启用这些主题。我是否为每个主题创建单独的布局文件？？？或者我使用themes.xml，如果是这样，我如何通过单击列表视图中的对象来实现它们？？？

对不起所有的问题。任何帮助都会很棒。

main.xml 文件，我希望我的主题更改此 main.xml 的内容。大多数属性将保持不变。

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:background="@drawable/boardimage"
  android:fadingEdge="vertical"
  android:orientation="vertical" >

  <ImageView
   android:layout_width="fill_parent"
   android:layout_height="wrap_content"
   android:background="@drawable/boarder"
   android:contentDescription="@string/title"
   android:gravity="center_horizontal"
   android:src="@drawable/banner" >

 </ImageView> 

  <ProgressBar
    android:id="@+id/progressBar1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"/>

 <WebView
   android:id="@+id/webview01"
   android:layout_width="fill_parent"
   android:layout_height="0dp"
   android:layout_gravity="center"
   android:layout_weight="1.12" >

  </WebView>

  </LinearLayout> 
```

所以我想知道我将如何更改这个 xml 文件的内容。就像在我的蓝色主题上一样，我将使用不同的 drawable 作为背景或不同大小的 webview，或者在 imageview 中绘制图像。我该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:00:14.243

如果您想了解主题和样式，请参阅 android developer 的此链接：http: [//developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)

构建两种样式，然后从 prefrence 中给出设置值并在主题之间切换，您可以使用以下代码在您的活动中以编程方式设置主题：`setTheme(R.style.MyTheme);`

您可以在 values 文件夹中的 theme.xml 文件中使用以下代码来执行此操作：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <style name="MyTheme" parent="@android:style/Theme.Light">

        <!-- hide the Window Title -->
        <item name="android:windowNoTitle">true</item>

    </style>

</resources> 
```

您可以使用此代码创建 ListPreference 并在 String.xml 中添加您的字符串数组：

```
 <ListPreference
  android:title="List Preference"
  android:summary="Select the option of the list"
  android:key="listPref"
  android:entries="@array/listDisplayWord"
  android:entryValues="@array/listReturnValue" /> 
```

此链接对您很有用：[How to add multiple theme attributes to the same Activity on Android Manifest?](https://stackoverflow.com/q/5998565/1105277)

您可以使用 listPreference 提供的值并在布局之间切换，如下所示：

```
if(myTheme==1)
     setContentView(R.layout.main1);
else
     setContentView(R.layout.main2); 
```

但这些布局中的组件（按钮、textViews、EditText、...）的名称必须相同。

# html - 自动调整div容器html中表格中的列大小

> ID：11636327
> 
> 赞同：4
> 
> 时间：2012-07-24T17:40:24.993
> 
> 标签：html, css, html-table

我正在寻找一种解决方案（最好是在 css 或 html 中），以使我位于 div 容器内的表压缩它的 <td>，以便在调整浏览器大小时它们留在 div 容器内。[http://lux.physics.ucdavis.edu/public/new_website/kkdijlsis2311/ex.html](http://lux.physics.ucdavis.edu/public/new_website/kkdijlsis2311/ex.html)请注意，当您更改浏览器大小时，单元格的内容如何更改大小，但我希望固定单元格的大小和列改变。因此，如果浏览器很小，表格将是 2 列而不是 6 列。示例 html 代码：

```
<div id="imageline">
    <table width="100%">
    <tr>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
    </tr>
    <tr>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
         <td>Stuff, maybe an image</td>
    </tr>
    </table>
</div> 
```

CSS代码：

```
#imageline {
width: 100%;
position:relative;
} 
```

我觉得这可以用简单的css来解决。我一直在尝试 width:100% 的不同组合，但没有成功。非常感谢任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:05:53.360

好吧，不幸的是，事情没那么简单。如果您考虑一下，在您的示例中，一行有 6 列，另一行有 3 列。您将无法仅将对象移到行外，因为正如您所料，该表旨在将所有内容保留在指定的行中。

因此，最好的方法是使用带有浮动选项的 DIV。这是我正在谈论的一个简短[示例。](http://jsfiddle.net/aBqce/11/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:57:08.320

最好的解决方案是将您的内容放在 div 中，每个`float: left;`并指定每个的高度和宽度。如果您确实必须使用表格，则必须查看媒体查询，以便根据用户浏览器窗口的大小调整样式表。但这会复杂得多。

# java - 在 Java 中读取文本文件后，如何将读取文本文件的函数中的读取内容传递给同一类中的其他函数？

> ID：11636334
> 
> 赞同：0
> 
> 时间：2012-07-24T17:41:00.487
> 
> 标签：java, text-files, tar

下面是一个代码块，它做了两件事 - 函数 readBCInputDataFromTextFile 读取文本文件，并将读取的数据存储在变量 textData 中，该变量是一个字符串数组（即 String[]） 数组大小使用 int 变量填充numOfLines（同样在函数 readBCInputDataFromTextFile 中）。此功能完美运行。

代码所做的第二件事（在函数 checkBCInput 中） - 现在不起作用 - 是使用正则表达式分离数据并将其存储在 4 个“容器”（所有这些都是向量）中：bcStringConstant、bcNameVec、bcTempVec 和bcHTCVec。

现在我的问题是：如何将变量 textData 传递给函数 checkBCInput。如果我将这两个函数的代码合并到一个 java 文件中，代码就可以执行。但是这种让事情发挥作用的方式并不是很好——模块化会受到影响。因此，我需要将代码分成两个函数——一个读取文本文件并将读取的内容传递给第二个函数，第二个函数使用正则表达式将读取的数据存储到特定的容器中。

我尝试从 readBCInputDataFromTextFile 返回 textData，但这在我正在运行的当前模拟中不起作用。我还尝试将读取的数据传递给 checkBCInput——但这会导致另一个错误消息：“找不到符号：符号 textData”。第二种方法（下面以粗体显示）将起作用，但我还看不到解决方案：-/

```
/*
 * inputReader
 * Last Revision: July 19, 2012.
 */
// package below is specific to software
package macro;

import java.util.*;
import java.text.*;
import java.io.*;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

// Imports below are specific to the software
import star.base.neo.*;
import star.base.report.*;
import star.common.*;
import star.energy.*;
import star.flow.*;
import star.keturb.*;
import star.material.*;
import star.meshing.*;
import star.metrics.*;
import star.prismmesher.*;
import star.resurfacer.*;
import star.segregatedenergy.*;
import star.segregatedflow.*;
import star.solidmesher.*;
import star.trimmer.*;
import star.turbulence.*;
import star.vis.*;

// base class (StarMacro) is derived from software 
public class inputReader extends StarMacro {
/*************************************************** 
* 
* Global definitions
* 
***************************************************/
// Print output to screen?
int print_to_screen = 0;

// Variables to store BCs             

int noOfBounds = 0;
String inputBCTextFile = null;

Vector bcStringConstant = new Vector();
Vector bcNameVec = new Vector();
Vector bcTempValVec = new Vector();
Vector bcHTCValVec = new Vector();

public void execute(){
    // does nothing but function is required
}

public void readBCInputDataFromTextFile(String inputBCTextFile){

/*  
* READ INPUT FILE CONTENTS
*/

File dir = new File(System.getProperty("user.dir").toString() + File.separatorChar);  
if(print_to_screen == 0){
    sim.println("Directory where input text file is located: " + dir);
}
else{
    System.out.println("Directory where input text file is located: " + dir);
}

this.inputBCTextFile = inputBCTextFile;

if(print_to_screen == 0){
    sim.println("File name is: " + inputBCTextFile);
}
else{
    System.out.println("File name is: " + inputBCTextFile);
}

BufferedReader bf = null;        

try{
    bf = new BufferedReader(new FileReader(inputBCTextFile));

    if(print_to_screen == 0){
        sim.println("FILE EXISTS!!");
    }
    else{
        System.out.println("FILE EXISTS!!");
    }

}

catch (FileNotFoundException e){

    if(print_to_screen == 0){
        sim.println("FILE NOT FOUND!!!");
    }
    else{
        System.err.println("FILE NOT FOUND!!!");
    }

    e.printStackTrace();
}

int numOfLines = 0;
String aLine;

try{
    while (( aLine = bf.readLine()) != null){
        numOfLines++;
    }
} 
catch (IOException e){
    if(print_to_screen == 0){
        sim.println("FILE NOT READ => NUMBER OF LINES IN FILE SET TO NULL");
    }
    else{
        System.err.println("FILE NOT READ => NUMBER OF LINES IN FILE SET TO NULL");
    }
    e.printStackTrace();

}

try{
    bf.close();
}
catch (IOException e){
    if(print_to_screen == 0){
        sim.println("FILE NOT CLOSED PROPERLY!!!");
    }
    else{
        System.err.println("FILE NOT CLOSED PROPERLY!!!");
    }

    e.printStackTrace();
}
BufferedReader textReader = null;

try{
    textReader = new BufferedReader(new FileReader(inputBCTextFile));
    if(print_to_screen == 0){
        sim.println("READING INPUT DATA FROM TEXT FILE");
    }
    else{
        System.out.println("READING INPUT DATA FROM TEXT FILE");
    }

} 
catch (FileNotFoundException e){
    if(print_to_screen == 0){
        sim.println("FILE NOT FOUND!!!");
    }
    else{
        System.err.println("FILE NOT FOUND!!!");
    }

    e.printStackTrace();
}

String[] textData = new String[numOfLines];

try{
for (int i = 0; i < numOfLines; i++){
    textData[i] = textReader.readLine();
    }
}
catch (IOException e){
    if(print_to_screen == 0){
        sim.println("FILE NOT READ!!!");
    }
    else{
        System.err.println("FILE NOT READ!!");                
    }

    e.printStackTrace();
}

 **checkBCInput(textData);**

try{
    if(print_to_screen == 0){
        sim.println("FILE READ AND CLOSED");
    }
    else{
        System.out.println("FILE READ AND CLOSED");
    }

    textReader.close();
    }
catch (IOException e){
    if(print_to_screen == 0){
        sim.println("FILE NOT CLOSED PROPERLY!!!");
    }
    else{
        System.err.println("FILE NOT CLOSED PROPERLY!!!");
    }

    e.printStackTrace();
   }

 }

public void checkBCInput(String[] textData){
    Pattern inputBCTextFileData = Pattern.compile("(.*)\t(.*)\t-?((\\d+\\.\\d*|\\d*\\.\\d+)|\\d+)\t-?((\\d+\\.\\d*|\\d*\\.\\d+)|\\d+)");

for (int i =0; i < textData.length; i++){
    Matcher inputBCTextFileDataMatcher = inputBCTextFileData.matcher(textData[i]);

    if(inputBCTextFileDataMatcher.find()){
        // 1st match is variable name
            bcStringConstant.add(inputBCTextFileDataMatcher.group(1)); // this is the 1st column in the text file
        bcNameVec.add(inputBCTextFileDataMatcher.group(2));
        bcTempValVec.add(inputBCTextFileDataMatcher.group(4)); // gets numbers in decimal notation
        bcHTCValVec.add(inputBCTextFileDataMatcher.group(6)); // gets numbers in decimal notation
    }
 }

 } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:52:36.560

> 我尝试从 readBCInputDataFromTextFile 返回 textData，但这在我正在运行的当前模拟中不起作用。

为什么不？像这样的东西应该工作：

```
String[] textData = readBCInputDataFromTextFile(...);
checkBCInput(textData); 
```

然后更改 to 的返回类型`readBCInputDataFromTextFile`并在其末尾`String[]`添加 a 。`return textData;`

# jquery - jQuery Add() 不起作用

> ID：11636336
> 
> 赞同：1
> 
> 时间：2012-07-24T17:41:06.647
> 
> 标签：jquery

我正在尝试使用 add() 构建一个 jQuery 集，但我的实现没有向该集添加元素。

```
 var questionPath = $(); // create empty set
    var selectedRuleElement = $(event.currentTarget);
    questionPath.add(selectedRuleElement); //no element is added to set here!
    selectedRuleElement.find('li.property-value-node').each(function () {
        var questionId = $(this).attr('data-parent-id');
        questionPath.add($('#' + questionId)); // or here!
    });
    return questionPath; 
```

上述两行 add() 都被赋予了一个有效元素作为参数。有人能告诉我将元素添加到 jQuery 集的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:42:27.147

与字符串一样，jQuery 对象是不可变的，因此您需要重新分配返回值。否则，您将丢弃由返回的值`.add()`并`questionPath`保持不变。

```
questionPath = questionPath.add(selectedRuleElement); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:48:18.160

你可以使用[**jQuery.merge()**](http://api.jquery.com/jQuery.merge/)：

```
var questionPath = $(); // create empty set
var selectedRuleElement = $(event.currentTarget);
$.merge(questionPath,selectedRuleElement);  //merging
selectedRuleElement.find('li.property-value-node').each(function () {
    var questionId = $(this).attr('data-parent-id');
    $.merge(questionPath,$('#' + questionId)); //merging
});
return questionPath; 
```

# vb.net - 控件和标签属性

> ID：11636339
> 
> 赞同：0
> 
> 时间：2012-07-24T17:41:18.363
> 
> 标签：vb.net, winforms

我正在尝试编写一个名为的函数`HasUnsavedChanges`，基本上应该在您关闭表单时调用该函数。即在保存项目后，它应该检查控件中的值`Tag`与相同函数中的属性值，例如 `txtFirstName.Tag = .ContactFirstname`和`txtFirstName.Text = .ContactFirstname`。如果两者之间有任何区别，请返回`True`。关闭表单时，如果此函数返回 true，则询问是否应保存更改。

我认为正确的方法是编写一个`For`循环来遍历控件，但在那之后我被卡住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:46:02.963

假设您将 .Text 和 .Tag 属性存储在同一个控件中，请尝试以下操作：

```
For Each objControl As Control In frmMain.Controls
   If TypeOf objControl is TextBox Then
       If objControl.Tag <> objControl.Text Then
           '---Changes have been made!---
       End if
   End if
Next 
```

显然，您需要将“frmMain”替换为您的表单名称。

# git - 在 msysgit 1.7.11 的更改日志中说：索引文件的实验性“版本 4”格式是什么意思

> ID：11636343
> 
> 赞同：3
> 
> 时间：2012-07-24T17:41:39.207
> 
> 标签：git, msysgit

如标题所述，

他们的意思是什么：

> 引入了索引文件的实验性“版本 4”格式，以减少磁盘占用和 I/O 开销

更重要的是，是否存在失去与此更改的向后兼容性的风险，或者此更改是否会损坏存储库？

做一些测试表明它向后兼容并且没有显示任何不利影响。

有人可以澄清一下这个变化实际上对 msysgit 1.7.11 有什么影响吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T06:54:17.293

这里没有兼容性问题（在 msysgit 和 git 之间，或与 Git 的先前版本之间），因为这与 git repo 本身的修改相同（并且官方 Git repo 没有提到任何兼容性问题）。

请参阅，在[*git* repo](https://github.com/git/git)[`Documentation/technical/index-format.txt`](https://github.com/git/git/blob/master/Documentation/technical/index-format.txt)中有关 GIT 索引格式的文件：

> （版本 4）在版本 4 中，条目路径名是​​相对于前一个条目的路径名进行前缀压缩的（第一个条目被编码，就好像前一个条目的路径名是一个空字符串）。
> 在条目的开头，存储了一个`N`可变宽度编码中的整数（与为包条目编码的偏移量相同的编码`OFS_DELTA`；参见[pack-format.txt](https://github.com/git/git/blob/master/Documentation/technical/pack-format.txt)），后跟一个以 NUL 结尾的字符串`S`。
> 从前一个条目的路径名末尾删除`N`字节，并将其替换为字符串会`S`生成此条目的路径名。
> 
> 需要 1-8 个 nul 字节以将条目填充到 8 个字节的倍数，同时保持名称以 NUL 结尾。
> 
> （版本 4）在版本 4 中，路径名后面的填充不存在。

所以这实际上是*索引条目的**内部*管理，它不会阻止 git（1.7.11 或任何其他版本）克隆/读取远程 repo。 它仅旨在优化“入口路径名称”表示。

# .net - 我应该使用哪个实体框架 SQL Server CE DLL？

> ID：11636346
> 
> 赞同：0
> 
> 时间：2012-07-24T17:41:57.773
> 
> 标签：.net, entity-framework, sql-server-ce

我使用 Entity Framework 4.1 和 SQL Server CE 4.0 开发了一个应用程序。该应用程序使用 SQL CE 的私有部署来简化安装...

最近我从 EF 4.1 升级到 4.3。我仍在编写将数据库从 EF 4.1 迁移到 4.3 的过程。不过，它似乎确实适用于新数据库。

我的问题涉及名为[EntityFramework.SqlServerCompact](http://nuget.org/packages/EntityFramework.SqlServerCompact)的 NuGet 包。此程序包是否替换 SQL Server CE 4.0 专用安装中的库之一？我很难找到关于这个包提供什么类以及它可能取代什么的简单解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T08:16:50.377

不，它与 SQL Server Compact 本身提供的 DLL 相同，但它是一个 SP1 预发行版。暂时避免使用它，直到 4.0 SP1 是 RTM，只需使用您到现在使用的那个（System.Data.SqlServerCe.Entity.dll）

# jquery - Jquery：使用动画将 div 隐藏在隐藏的 div 中

> ID：11636354
> 
> 赞同：2
> 
> 时间：2012-07-24T17:42:23.997
> 
> 标签：jquery

我试图隐藏一个隐藏`<div>`在另一个隐藏的内部`<div>`。我正在使用动画：`$("#innerDiv").hide(400)`，但是只要隐藏了外部`<div>`，内部`<div>`就不会被隐藏，并且稍后在我取消隐藏外部时可见`<div>`。如果显示外部`<div>`，则内部`<div>`会按预期隐藏并带有动画。

当外部隐藏时，我不希望内部`<div>`隐藏动画，`<div>`因为那没有意义。但是，我希望`<div>`至少会隐藏起来，但事实并非如此。

我发现更改 javascript 可以`$("#innerDiv").hide()`解决问题，但会删除我希望在外部`<div>`可见时出现的动画。

[这](http://jsfiddle.net/aBqce/1/)是一个演示问题的 jsFiddle。如果先单击“显示”按钮，然后单击“隐藏”按钮，则文本会像我期望的那样以动画形式消失。但是，如果您先单击“隐藏”按钮，然后单击“显示”按钮，文本仍然会出现。我希望它被隐藏（因为我使用了该`.hide()`功能。）。

为什么会发生这种情况，有没有办法在外部`<div>`可见时保留动画，但`.hide(400)`在外部隐藏时实际隐藏元素`<div>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:46:31.313

您可以使用回调选项手动将内部 div css`display`属性更改为

`display : none`

[隐藏文档](http://api.jquery.com/hide/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T19:00:58.360

您可以编写一个片段来根据父级是否隐藏来切换动画：

```
var innerDiv = $("#innerDiv");
if(innerDiv .parents("div").is(":visible")){
    innerDiv.hide(400);
}else{
    innerDiv.hide();
} 
```

**编辑：进一步解释 parents(...) 选择器**

您还可以将 .parents("...") 调用与任何选择器一起使用。因此，如果嵌套的 div 比直接子级更复杂，它仍然会冒泡以找到您要检查的目标父级。因此，如果您的父 div 名为 id="outerDiv" 您可以这样做：

```
$("#innerDiv").parents("#outerDiv").is(":visible") 
```

**编辑：更一般的解决方法**

您也可以对任何元素执行此操作以确定它是否隐藏（您可以为动画编写自己的自定义插件或只是隐藏，但我会留给您）

```
$(function(){
     HideOrAnimate($("#whatever"),400);
});

function HideOrAnimate(target, hideTime)
{
     if(target.parents(":hidden").length > 0){
          target.hide();
     }else{
          target.hide(hideTime);
     }
} 
```

# entity-framework - 如何使用 Entity Framework 4.3 Code First 方法从现有数据库中干净地生成 POCO 类？

> ID：11636359
> 
> 赞同：1
> 
> 时间：2012-07-24T17:42:35.823
> 
> 标签：entity-framework, ef-code-first, entity-framework-4.3

我在一个针对现有数据库的项目中遵循 EF Code-First 方法，我将根据需要向其中添加表。

这个数据库有许多表，我需要为其生成 POCO 类，所以我想知道是否有一种直接、干净的方法来从数据库生成简单的 POCO 类......我可以继续从中使用一般的 Code-First 范例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:18:28.363

您可以为此使用[Entity Framework Power Tools](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:29:35.757

如果您只想要没有任何关系的简单 Poco 类，请使用此 T4 模板

[从数据库表生成实体类](https://stackoverflow.com/questions/1094876/generate-entity-class-from-database-table)

# python - 字典上的简单python循环

> ID：11636366
> 
> 赞同：-2
> 
> 时间：2012-07-24T17:43:06.693
> 
> 标签：python, dictionary

我想在 Python 中循环遍历这个字典，并打印键和值，我是 Python 的新手，在互联网上找到的示例不起作用或打印错误。

那么如何正确循环下表并显示键/值？

```
letters = {
    "m":1, "n":1, "r":1, "M":1, "N":1, "R":1, "l":1, "L":1, "1":1,
    "3":1, "6":1, "7":1, "8":1, "0":1,
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T17:47:35.417

您可以使用 items()，例如：

```
for k, v in letters.items():
  print k,v 
```

或者因为它是一个字典，所以遍历键，例如：

```
# uses iterator, as opposed to returning all the keys via .keys()
for k in letters:
  print k, letters[k] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T17:45:53.810

你所拥有的是python中的[字典](http://docs.python.org/tutorial/datastructures.html#looping-techniques)。

```
for k, v in letters.iteritems():
    print k, v 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:47:01.417

做这件事有很多种方法

```
# for key in letters
# for key in letters.iterkeys()
for key in letters.keys():
    print key, letters[key]

# for key, val in letters.iteritems()
for key, val in letters.items():
    print key, val 
```

# objective-c - 将自动释放的 CGColor 返回到 ARC 的转换方法

> ID：11636369
> 
> 赞同：12
> 
> 时间：2012-07-24T17:43:19.083
> 
> 标签：objective-c, xcode, cocoa, automatic-ref-counting, core-foundation

我正在将我的项目转换为使用 ARC。我在 NSColor 上有一个类别，该类别具有返回自动释放的 CGColor 表示的方法：

```
@implementation NSColor (MyCategory)

- (CGColorRef)CGColor
{
    NSColor *colorRGB = [self colorUsingColorSpaceName:NSCalibratedRGBColorSpace];
    CGFloat components[4];
    [colorRGB getRed:&components[0]
               green:&components[1]
                blue:&components[2]
               alpha:&components[3]];
    CGColorSpaceRef space = CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);
    CGColorRef theColor = CGColorCreate(space, components);
    CGColorSpaceRelease(space);
    return (CGColorRef)[(id)theColor autorelease];
}

@end 
```

使用 ARC 执行此操作的正确方法是什么？我不想返回保留的 CGColor。

XCode 中的 ARC 转换器建议使用

```
return (CGColorRef)[(__bridge id)theColor autorelease]; 
```

但这会导致以下错误消息：

> [重写器] 将 'autorelease' 消息的结果转换为 'CGColorRef' 是不安全的；__bridge 强制转换可能会导致指向已销毁对象的指针，而 __bridge_retained 可能会泄漏对象

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-14T19:51:33.907

本质上是因为没有好的方法可以在 ARC 中转换以下代码：

```
CGColorRef a = ...;
id b = [(id)a autorelease];
CGColorRef c = (CGColorRef)b;
// do stuff with c 
```

转换器删除`-autorelease`并添加了一些桥接演员，但它卡住了：

```
CGColorRef a = ...;
id b = (__bridge_transfer id)a;
CGColorRef c = (__bridge_SOMETHING CGColorRef)b;
// do stuff with c. Except the compiler sees that b is no longer being used! 
```

但是迁移者应该选择做`__bridge_SOMETHING`什么呢？

*   如果选择`__bridge`, then`b`将不再使用，因此编译器可以*立即*释放它。这崩溃了。
*   如果选择`__bridge_retained`，则所有权将转移*回*“CF-land”，但原始代码假定该对象将归自动释放池所有。代码现在泄露了。

问题是 ARC 禁止调用`-autorelease`，但没有记录的方法来保证将对象添加到自动释放池中——这样做的唯一充分理由是从方法中返回自动释放的 CF 类型，但是*很多*UIKit 类都有 CF -typed 属性（并且`MKOverlayPathView`具有*必须*返回自动释放值的*原子* `CGPathRef`属性）。

 *这是我真正希望得到更好记录的 ARC 的棘手部分之一。

您可以跳过一些障碍，这些障碍可能会取得不同程度的成功。按照增加粘性的顺序：

1.  `CFAutorelease()`在未使用 ARC 编译的文件中定义函数（`-fno-objc-arc`在目标设置 → 构建阶段 → 编译源中添加编译器标志）。我把这个作为练习留给读者。这是因为 ARC 代码需要与 MRC 代码互操作。这可能是最干净的解决方案。（这势必会引起评论说它不应该使用 CF 前缀，但只要你没有看到链接错误，C 符号名称冲突通常是安全的，因为引入了“两级命名空间”在 10.3 左右。）

2.  各种箍向它发送`-autorelease`消息或等效。所有这些都有些混乱，因为它们依赖于“愚弄”ARC，除了最后一个假设`id`与 ABI 兼容的`void*`. 它们也可能比上面的要慢，因为它们需要查找类/选择器（`objc_lookUpClass()`并且`sel_registerName()`可能更快甚至优化，但我不会打赌）。

    ```
    return (__bridge CGColorRef)[(__bridge id)theColor performSelector:NSSelectorFromString(@"autorelease")]

    [NSClassFromString(@"NSAutoreleasePool") addObject:(__bridge id)theColor]
    return theColor;

    return (__bridge CGColorRef)((id(*)(id,SEL))objc_msgSend)((__bridge id)theColor,NSSelectorFromString(@"autorelease"));

    return ((void*(*)(void*,SEL))objc_msgSend)(theColor,NSSelectorFromString(@"autorelease")); 
    ```

3.  `__autoreleasing`通过分配给编译器无法优化的变量来强制将其添加到自动释放池中。我不确定这是否得到保证（特别是类似于`objc_autoreleaseReturnValue()`并且`objc_retainAutoreleasedReturnValue()`可能是可能的，但我认为这不太可能，因为它会减慢 的常见情况`(NSError * __autoreleasing *)error`）。

    ```
    -(id)forceAutorelease:(id)o into:(id __autoreleasing*)p
    {
      *p = o;
      return p;
    }

    -(CGColorRef)CGColor
    {
      ...
      CGColorRef theColor = CGColorCreate(...);
      CGColorSpaceRelease(space);
      id __autoreleasing temp;
      return (__bridge CGColorRef)[self forceAutorelease:(__bridge_transfer id)theColor into:&temp];
    } 
    ```

    （编译器/运行时也有可能合作并使用静态调度/内联，直到相关方法被覆盖，但这似乎很棘手，而且本身也有很大的开销。）

4.  `typedef`与 一起使用`__attribute__((NSObject))`。这是[ARC 规范](http://clang.llvm.org/docs/AutomaticReferenceCounting.html)中文档最容易混淆的部分，但类似这样的东西*似乎*有效：

    ```
    typedef CGColorRef MyCGColorRef __attribute__((NSObject));
    -(MyCGColorRef)CGColor
    {
      ...
      return (__bridge MyCGColorRef)(__bridge_transfer id)theColor;  
    } 
    ```

    我*认为*你需要两座桥梁才能工作（一个将所有权转移给 ARC，另一个转移到）；如果你只是`return theColor;`我怀疑它被泄露了。根据我对文档的阅读，您*应该*只需要`(__bridge_transfer MyCGColorRef)`，因为它正在从非 ARC 指针 (CGColorRef) 转换为 ARC 指针 (MyCGColorRef)，但这会让编译器抱怨。唉，文档没有给出如何使用`__attribute__((NSObject))`typedef 的任何示例。

    请注意，您不需要更改标头中的返回类型。这样做可能会启用自动释放的返回值优化，但我不确定编译器如何处理从 MyCGColorRef 到 CGColorRef 的转换。乐叹息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-24T17:51:43.333

`CGColor`是一个核心基础对象。你不应该尝试使用`autorelease`它。相反，您应该重命名您的方法`copyCGColor`并返回一个保留对象。

自动发布是一个 Objective-C 的概念。它不存在于核心基础级别。

由于`CGColor`不是免费桥接到任何 Objective-C 类，因此尝试自动释放它是非常奇怪的（即使这可能有效）。

*几年后更新*

现在在 CoreFoundation 级别有 CFAutorelease()（从 Mavericks 和 iOS 7 开始可用）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-01T15:53:47.060

从 OS X 10.9 或 iOS 7 开始，您可以使用`CFAutorelease()`（在 CFBase.h 中声明）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-21T08:22:44.950

实际上，您可以在手动内存管理中`retain`，`release`以及`autorelease`任何**CoreFoundation**对象，因为它们都是**免费桥接**至至少`NSObject`.

由于 ARC 禁止使用手动内存管理，我们应该以某种方式告诉编译器该做什么。一种方法是命名您的方法`- (CGColorRef)copyCGColor;`，以便编译器知道该方法返回具有 +1 保留计数的对象。

但是，如果您像我一样喜欢简单的“CGColor”用于此类方法，您可以附加`__attribute__((cf_returns_retained))`到方法定义中：

```
@interface NSColor (MyCategory)

- (CGColorRef)CGColor __attribute__((cf_returns_retained));

@end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T17:54:55.293

我认为您想在这种情况下使用 __bridge_transfer 。

[文档](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#objects.operands.casts)*

# c# - 将结果从一个线程通知到另一个线程或等待第一个线程的反馈以继续第二个线程

> ID：11636372
> 
> 赞同：2
> 
> 时间：2012-07-24T17:43:29.063
> 
> 标签：c#, multithreading

我试图让 2 个线程在后台运行以执行任务。我必须按顺序创建线程并继续执行程序。但是只有在第一个线程完成时，第二个线程才必须执行它的工作。另外，再澄清一点。我希望在 WPF 应用程序上使用此解决方案。不需要 UI 反馈。我需要的只是第一个任务的状态更新。我同意，如果我们在一个线程中完成所有操作，那就没问题了。但是我们想要第二个线程单独做更多的事情，即使用户离开创建这个线程的屏幕。

这是示例：

```
class Program
{

    static string outValue;
    static bool _isFinished = false;

    static void Main(string[] args)
    {
        ThreadStart thread1 = delegate()
        {
            outValue = AnotherClass.FirstLongRunningTask();
            // I need to set the _isFinished after the long running finishes..
            // I cant wait here because I need to kick start the next thread and move on.
            // 
        };
        new Thread(thread1).Start();

        ThreadStart thread2 = delegate()
        {
            while (!_isFinished)
            {
                Thread.Sleep(1000);
                Console.WriteLine("Inside the while loop...");
            }
            if (!string.IsNullOrEmpty(outValue))
            {
                // This should execute only if the _isFinished is true...
                AnotherClass.SecondTask(outValue);    
            }

        };
        new Thread(thread2).Start();

        for (int i = 0; i < 5000; i++)
        {
            Thread.Sleep(500);
            Console.WriteLine("I have to work on this while thread 1 and thread 2 and doing something ...");    
        }    
        Console.ReadLine();

    }

}

public class AnotherClass
{
    public static string FirstLongRunningTask() 
    {
        Thread.Sleep(6000);
        return "From the first long running task...";
    }

    public static void SecondTask(string fromThread1) 
    {
        Thread.Sleep(1000);
        Console.WriteLine(fromThread1);
    }
} 
```

我在哪里设置_isFinished？
我不能使用 BackgroundWorker 线程。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:45:57.177

您应该简单地调用`thread1.Join()`，这将阻塞直到`thread1`终止。

但是，有很多更好的方法可以做到这一点。
您应该改用 TPL 和`Task`类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:10:08.287

如果一个线程只能在另一个线程完成时启动，您有一个非常简单的解决方案：在第一个线程上执行整个代码。

您可以使用`Task.ContinueWith`队列来为相同的更多工作`Task`。

# css - 选择嵌套元素

> ID：11636375
> 
> 赞同：0
> 
> 时间：2012-07-24T17:43:35.883
> 
> 标签：css

我有一个类分配给具有“级别”类的 div 中的第一个 div。工作正常。

如果父 div 有一个 id="selected"，我需要交换样式。很难选择它...

```
.level:first-child div:nth-child(1) {
    background-position: 0px -368px;
}
.level:first-child div:nth-child(1) #selected {
    background-position: 0px -429px;
    background-color:red
} 
```

```
<div class="level" id="selected">
    <div></div>
    <div></div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:45:33.680

把`id`前面

```
#selected.level:first-child div:nth-child(1)  {
    background-position: 0px -429px;
    background-color:red
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:52:57.463

试试这个：

```
.level:first-child div:nth-child(1) {
    background-position: 0px -368px;
}
.level:first-child#selected div:nth-child(1) {
    background-position: 0px -429px;
    background-color:red
}​ 
```

示例：http: [//jsfiddle.net/HARWp/1/](http://jsfiddle.net/HARWp/1/)

# performance - 用于地理空间查询的 EC2 上的 Solr 性能

> ID：11636376
> 
> 赞同：2
> 
> 时间：2012-07-24T17:43:42.353
> 
> 标签：performance, solr, geolocation, geospatial

EC2 配置

```
mlarge machine - 
4 CPU,
7.5G,
EBS volume,
JVM Memory - 6G,
Solr Version tested on both 4.0-ALPHA and 3.6.1 
```

架构.xml

```
<fieldType name="tdouble" class="solr.TrieDoubleField" precisionStep="4" positionIncrementGap="0"/>
<field name="id" type="long" indexed="true" stored="true" required="true" />
<field name="location" type="location" indexed="true" stored="true"/>
<field name="location_0_coordinate" type="tdouble" indexed="true" stored="true" />
<field name="location_1_coordinate" type="tdouble" indexed="true" stored="true" />
<field name="text" type="text_general" indexed="true" stored="false" multiValued="true"/> 
```

solrconfig.xml 没有变化。

编辑：

```
<query>
  <filterCache class="solr.FastLRUCache" size="512" initialSize="512" autowarmCount="0"/>
  <queryResultCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0"/>
  <documentCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0"/>
  <enableLazyFieldLoading>true</enableLazyFieldLoading>
  <queryResultWindowSize>20</queryResultWindowSize>
  <queryResultMaxDocsCached>200</queryResultMaxDocsCached>
  <useColdSearcher>false</useColdSearcher>
  <maxWarmingSearchers>2</maxWarmingSearchers>
</query> 
```

128M 的数据记录在其中加载。

Java 客户端代码

```
 ModifiableSolrParams params = new ModifiableSolrParams();
        params.set("wt","csv");
        params.set("df","id");
        params.set("fl", "id,location");
        params.set("q", "*:*");
        params.set("fq", "{!geofilt}");
        params.set("sfield", "location");
        params.set("d", "0.05");
        params.set("pt",  columns[1] +"," + columns[2]);
        QueryResponse response = solr.query(params); 
```

最佳

```
Tasks:  71 total,   1 running,  70 sleeping,   0 stopped,   0 zombie
Cpu(s): 38.7%us,  0.0%sy,  0.0%ni, 49.4%id,  0.0%wa,  0.0%hi,  0.0%si, 11.9%st
Mem:   7634740k total,  7570960k used,    63780k free,   150708k buffers
Swap:        0k total,        0k used,        0k free,  3914812k cached

PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                                                                         
956 root      20   0 25.7g 4.0g 889m S 100.1 55.2 353:48.70 java 
```

结果是，查询一个文档平均需要大约 1.5 秒。

```
record 203 response Time 1108 result: 42.7461000,-73.6924000, 
record 207 response Time 1123 result: 40.8448850,-73.7156030, 
record 210 response Time 1180 result: 40.8087660,-74.1583510, 
record 211 response Time 1656 result: 0, 
record 212 response Time 1423 result: 0, 
record 213 response Time 1316 result: 39.1027710,-76.7964910. 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T23:30:46.230

试试[SOLR-2155](https://github.com/dsmiley/SOLR-2155)，一个用于 Solr 3.x 的插入式地理空间插件

底层算法/方法是 Lucene/Solr 4 中新空间模块的核心。人们告诉我他们使用 SOLR-2155，因为它的性能优于 LatLonType。

在您试用 SOLR-2155 并告诉我们在相同情况下它有多快之后，我建议将您的索引分成 2-3 个分片并进行分布式搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T20:42:54.790

是的，对于初学者来说是：如果**solrconfig.xml 没有更改。**你的意思是你正在使用 \example 中的那个而不做任何更改，你有一堆你可能不需要的东西（因为它是一个例子，显示了许多不同的功能），所以从那里删除你不需要的东西（主要是我认为的领域）并再次测试。

# c++ - C++ strtok：如何获取和分配

> ID：11636377
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:43:44.480
> 
> 标签：c++

我使用下面的代码并得到下面的输出。

原始字符串是`-CCY 1.2624 Up 0.0006(0.05%) 01:37 [37]`

```
char* pch;

 pch = strtok (buffer," ");

  while (pch != NULL)
  {
    printf ("%s\n",pch);
    pch = strtok (NULL, " ");

  } 
```

这是我的输出

```
CCY
1.2624
Up
0.0006(0.05%)
01:37
SGT
[37] 
```

如何获取*1.2624*并将其分配给 cstr 以便我以后可以`printf`在 while 循环之外使用它或其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:47:47.850

由于 strtok 使用静态缓冲区，因此您需要使用自己的缓冲区制作您感兴趣的字符串的副本。就像是：

```
char* numbuffer = malloc(sizeof(char) * strlen(pch));

if (numbuffer != NULL) {
   strcpy(numbuffer, pch);
} 
```

更多示例：[http ://www.cplusplus.com/reference/clibrary/cstring/strcpy/](http://www.cplusplus.com/reference/clibrary/cstring/strcpy/)

这样做的原因是因为任何后续调用 strtok 都会改变 pch 指向的缓冲区的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:48:08.843

```
char* pch;

 pch = strtok (buffer," "); // pch == "CCY"
 // again:
 pch = strtok (NULL, " "); // pch == "1.2624" 
```

前提是`buffer`可以拆分为两个或多个项目

# tabs - JQuery 工具选项卡内的 Facebook 点赞按钮

> ID：11636378
> 
> 赞同：0
> 
> 时间：2012-07-24T17:43:55.370
> 
> 标签：tabs, facebook-like, jquery-tools

我在 JQuery 工具选项卡的第一个选项卡中添加了 Facebook 的点赞按钮。

加载页面时，第一个选项卡打开并出现 Facebook 的点赞按钮，这按预期工作，但是当您单击第二个/第三个/...选项卡然后返回第一个选项卡时，Facebook 的点赞按钮不再出现...

以下是我添加到第一个选项卡以添加“赞”按钮的内容：

```
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "http://connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

并将以下代码放在我希望按钮出现在第一个选项卡中的位置：

```
<div class="fb-like" data-href="http://www.mysite.com/example/thisPage" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false"></div> 
```

知道这里发生了什么，以及每次加载第一个选项卡时如何重新加载like按钮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:46:52.230

我猜这与 AJAX 有关，当然您需要在使用 AJAX 调用 FB 按钮后重新加载它。将此添加到函数的末尾以重新初始化 Facebook 并加载 Like 按钮：

```
FB.XFBML.parse(); 
```

# php - 在codeigniter中路由到页面的策略

> ID：11636380
> 
> 赞同：0
> 
> 时间：2012-07-24T17:44:15.320
> 
> 标签：php, codeigniter, methods, routing, controller

我想知道在codeigniter中路由到页面的最佳方式是什么？例如，用户想要路由到索引页面，但我应该在控制器中创建一个仅用于该页面的方法，还是更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:11:30.130

无需创建单独的方法或控制器。这是我的做法：

```
class Pages extends CI_Controller {

    function _remap($method)
    {
        is_file(APPPATH.'views/pages/'.$method.'.php') OR show_404();
        $this->load->view("pages/$method");
    }

} 
```

所以 url`http://example.com/pages/about`会加载视图文件`application/views/pages/about.php`。如果文件不存在，则显示 404。

您不需要任何特殊的路由来执行此操作，但如果您希望 URL 改为，您可以执行以下操作`http://example.com/about`：

```
// Route the "about" page
$route['about'] = "pages/$1";

// Route ALL requests to the static page handler
$route['(:any)'] = "pages/$1"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:48:58.983

可以使用该`application/config/routes.php`文件完成路由。您可以在那里定义重定向到索引页面的自定义路由。绝对不需要为每个页面创建方法。

更详细的解释可以在这里找到：[http ://codeigniter.com/user_guide/general/routing.html](http://codeigniter.com/user_guide/general/routing.html)

编辑：没有真正明白你的意思，但这是我使用的解决方案：

```
class Static_pages extends CI_Controller {

    public function show_page($page = 'index')
    {
        if ( ! file_exists('application/views/static_pages/'.$page.'.php'))
            show_404();

        $this->load->view('templates/header');
        $this->load->view('static_pages/'.$page);
        $this->load->view('templates/footer');
    }

} 
```

我为静态页面制作了 1 个控制器，`application/controllers`其中包含 1 个用于加载静态页面的方法。

然后我将此行添加到`application/config/routes.php`：

```
$route['(:any)'] = 'static_pages/show_page/$1';
//you can also change the default_controller to show this static page controller
$route['default_controller'] = 'static_pages/show_page'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:47:26.150

在位于的配置文件中`/application/config/routes.php`

# sql - 选择其中一个 id 不在另一个表中

> ID：11636384
> 
> 赞同：1
> 
> 时间：2012-07-24T17:44:22.903
> 
> 标签：sql, sql-server

基本上，我有一个表格结构，学生可以在其中参加考试。

结构是这样的：

[http://www.dropmocks.com/mBj9YX](http://www.dropmocks.com/mBj9YX)

```
SELECT s.name AS studentName, 
t.name AS testName,
MAX(sc.percentile) 
AS percentile,
    (CASE WHEN  MAX(sc.percentile) > 70 THEN 'passed' 
     WHEN MAX(sc.percentile) <70 THEN 'fail'
     WHEN  MAX(sc.percentile) IS NULL THEN 'not taken' END) AS status
FROM Score sc 
```

我不想要的部分在这里：

```
WHEN  MAX(sc.percentile) IS NULL THEN 'not taken' END 
```

如果学生不参加考试，则考试 ID 不会出现在成绩表中。如果他们没有参加考试，我想不出一个会在状态列中添加“未参加”的查询。帮助？前两个有效，但如果测试表中有一个测试 ID 并且学生没有参加该测试，那么该学生的测试 ID 将不会显示在分数表中。我正在尝试找到一种方法来检测它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:59:05.637

也许您使用的是 IS_MEMBER NULL 而不是 IS NULL？IS_MEMBER 函数与您要实现的目标无关（检查某人是否在角色组中）。有时会发生这种情况，因为当您按空格键入查询 mssms 添加了 IS_MEMBER。过去发生在我身上。尝试改变

```
WHEN  MAX(sc.percentile) IS_MEMBER NULL THEN 'not taken' 
```

至

```
WHEN  MAX(sc.percentile) IS NULL THEN 'not taken' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:59:42.053

我从来没有测试过，但尝试过

```
SELECT
    sc.name AS studentName, 
    t.name AS testName,
    MAX(sc.percentile) AS percentile,
    (CASE
        WHEN MAX(sc.percentile) > 70 THEN 'passed'
        WHEN MAX(sc.percentile) < 70 THEN 'fail'
        WHEN sc.testID IS NULL THEN 'not taken'
        -- /*OR...*/ WHEN MAX(sc.percentile) IS NULL THEN 'not taken'
    END) AS status
FROM Score sc
FULL OUTER JOIN Test t ON t.testID = sc.testID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:07:22.580

CASE var WHEN NULL THEN … 永远不会成功。

用这个：

CASE WHEN MAX(sc.percentile) IS NULL THEN 'not take' ELSE '123' END

或者只是这个：

COALESCE(MAX(sc.percentile), '未采取')

# c# - 如何配置 web.config 以允许任何长度的请求

> ID：11636386
> 
> 赞同：157
> 
> 时间：2012-07-24T17:44:26.473
> 
> 标签：c#, javascript, asp.net-mvc, web-config, query-string

我正在构建一个站点，我想在其中从 textarea 元素的值创建一个文件客户端。

我有执行此操作的代码，但我收到此错误

> HTTP 错误 404.15 - 未找到 请求过滤模块配置为拒绝查询字符串过长的请求。

有没有办法覆盖它，以便我能够处理任何大小的请求？

如果没有，有没有办法在不使用文件系统/活动 x 对象的情况下生成文件客户端？

谢谢

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2012-07-24T17:50:28.497

将以下内容添加到您的 web.config 中：

```
<system.webServer>
  <security>
    <requestFiltering>
      <requestLimits maxQueryString="32768"/>
    </requestFiltering>
  </security>
</system.webServer> 
```

看：

[http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits](http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits)

**更新以反映评论。**

[requestFiltering [IIS 设置架构] 的 requestLimits 元素](http://msdn.microsoft.com/en-us/library/ms689462%28v=vs.90%29.aspx)

您可能还必须在 web.config 中添加以下内容

```
<system.web>
    <httpRuntime maxQueryStringLength="32768" maxUrlLength="65536"/>
</system.web> 
```

请参阅：[httpRuntime 元素（ASP.NET 设置架构）](http://msdn.microsoft.com/en-us/library/e1f13641%28v=vs.100%29.aspx)

当然，上面配置设置中的数字（32768 和 65536）只是示例。您不必使用这些确切的值。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-05-24T07:41:01.170

就我而言（Visual Studio 2012 / IIS Express / ASP.NET MVC 4 app / .Net Framework 4.5 ），经过 30 分钟的反复试验后真正起作用的是在标签中设置`maxQueryStringLength`属性：`<httpRuntime>`

```
<httpRuntime targetFramework="4.5" maxQueryStringLength="10240" enable="true" /> 
```

`maxQueryStringLength`默认为`2048`.

更多关于它的信息：

[扩大允许 URL 的范围](http://www.asp.net/whitepapers/aspnet4#0.2__Toc253429244)

* * *

我尝试`<system.webServer>`按照[@MattVarblow](https://stackoverflow.com/a/11636484/114029)的建议设置它，但它没有用......这是因为我在装有 Windows 8 的开发机器上使用 IIS Express（基于 IIS 8）。

当我将我的应用程序部署到生产环境（带有 IIS 7 的 Windows Server 2008 R2）时，IE 10 开始在带有长查询字符串的 AJAX 请求中返回 404 错误。然后我认为问题与查询字符串有关，并尝试了@MattVarblow 的答案。它只适用于 IIS 7。:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-10-08T17:18:57.893

如果您在运行 IIS 8.5 Web 服务器时遇到此问题，您可以使用以下方法。

首先，在您正在处理的 IIS 站点中找到**“请求过滤”**模块，然后双击它...

[![在此处输入图像描述](../Images/0fbf0d9760ecfce5ea4695963851c8b2.png)](https://i.stack.imgur.com/8RLaH.png)

接下来，您需要右键单击下图所示的白色区域，然后单击名为**“编辑功能设置”**的上下文菜单选项。

[![在此处输入图像描述](../Images/a7ac388e150755872bb68ff678b545f8.png)](https://i.stack.imgur.com/q7Kkf.png)

然后要做的最后一件事是将**“最大查询字符串（字节）”**值从**2048**更改为更适合您需要的值，例如**5000 。**

[![在此处输入图像描述](../Images/f38f35122e23440754c11fa6ba950452.png)](https://i.stack.imgur.com/iuUHL.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-08-05T01:55:27.300

需要检查的其他内容：如果您的站点使用 MVC，如果您将 [Authorize] 添加到您的登录控制器类，就会发生这种情况。它无法访问登录方法，因为它没有被授权，所以它重定向到登录方法-->繁荣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-02T05:40:12.353

**当您在 ajax 调用参数中传递大字符串时，它也会产生错误。**

因此，始终在 ajax 中使用类型 post 将**100% 解决您的问题** ，并且无需在 web.config 中设置长度。

**// var UserId= 1000 个用户 ID 的数组**

$.ajax({ global: false, url: SitePath + "/User/getAussizzMembersData", "data": { UserIds: UserId}, "type": "POST", "dataType": "JSON" }}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-06T01:22:50.657

对于在使用 IIS Express 从 Visual Studio 运行应用程序时遇到这种情况的人，首先您必须找到**应用程序**正在使用的 applicationhost.config 文件。[请参阅https://stackoverflow.com/a/41553876/1849880](https://stackoverflow.com/a/41553876/1849880)上的答案，了解如何找到**applicationhost.config**文件。然后，您可以按照上面的说明更改*maxQueryString*值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-20T17:13:12.027

我必须将 [AllowAnonymous] 添加到登录页面的 ActionResult 函数中，因为用户尚未经过身份验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-21T13:05:08.630

如果您的网站正在使用身份验证，但您没有在 IIS 中设置正确的身份验证方法（例如 Basic、Forms 等），那么浏览器将陷入重定向循环。这会导致重定向 url 变得越来越长，直到它爆炸。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-31T10:42:08.640

我在尝试将 ASP Web 应用程序部署到 IIS 8 时遇到了类似的问题。为了解决它，我按照上面的 Matt 和 Leniel 建议做了。但还必须配置我网站的身份验证设置以启用匿名身份验证。这对我有用。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-05-14T04:52:52.380

> HTTP 错误 404.15 - 未找到 请求过滤模块配置为拒绝查询字符串过长的请求。

要解决此问题，请在源代码中检查`Form`标记是否具有`method`获取/设置状态的属性。

如果是这样，`method`则应删除该属性。

# php - 向多个用户群发墙贴？

> ID：11636387
> 
> 赞同：0
> 
> 时间：2012-07-24T17:44:37.707
> 
> 标签：php, facebook, facebook-graph-api

我有一个竞赛应用程序。许多用户已经安装了该应用程序。我已经存储了这些用户的 offline_access 令牌。我想在比赛结束时向应用程序的所有用户发送消息。最好的方法是什么。因为当我在一段时间循环中执行此操作时，页面永远不会加载，浏览器只会在选项卡上显示加载动画 gif。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:46:14.170

您甚至不需要用户访问令牌来完成类似于您正在尝试做的事情。

首先，大量发帖既违反了[Facebook 平台政策](https://developers.facebook.com/policy/#policies)（特别是 IV.2、IV.3），但它也确实是垃圾邮件，用户会做出负面反应，可能会阻止您的应用程序，最终可能会被 Facebook 禁止. 所以不要那样做。

相反，您应该利用预期的社交渠道来通知用户新内容，[App to user Requests](https://developers.facebook.com/docs/requests/#app_to_user)。

这很容易做到，根据[apprequests 的 Graph API 文档，](https://developers.facebook.com/docs/reference/api/user/#apprequests)您只需进行以下 API 调用：

`https://graph.facebook.com/USERID/apprequests?app_access_token=APPTOKEN`

其中 USERID 是每个用户的 Facebook ID，而 APPTOKEN 始终是您的应用程序唯一的访问令牌（如果您不知道如何获取其中之一，请参阅[此处的文档）。](https://developers.facebook.com/docs/authentication/applications/)您还需要包括参数，例如`message`，您可以在文档中了解更多信息。

# sql - 当前连接上的临时表

> ID：11636394
> 
> 赞同：1
> 
> 时间：2012-07-24T17:45:17.397
> 
> 标签：sql, sql-server, temp-tables

如果我做：

```
select * from tempdb.sys.tables 
```

我将看到系统中的所有临时表，但是该视图没有关于每个表属于哪个连接/用户的信息。我有兴趣只查找在当前连接上创建的表。有没有办法做到这一点？

谢谢-e

ps是的，我可以尝试阅读列出的每个表，并认为那些成功的表应该是我的（在最近的版本中，无法读取其他连接的表），但这种方法成本太高，因为可能有数千个表在系统上

pps 我确实读过[有没有办法获取 SQL Server 中所有当前临时表的列表？](https://stackoverflow.com/questions/7075483/is-there-a-way-to-get-a-list-of-all-current-temporary-tables-in-sql-server)它提出了正确的问题但没有得到好的答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:04:01.007

假设你没有用三个连续的下划线命名你的#temp 表，这应该只选择你的#temp 表。但是，它不会提取您的表变量，您也不能以某种方式更改此代码以选择其他人连接上的表 - 这仅适用`OBJECT_ID('tempdb..#foo')`于您的会话中的表只能返回 true。

```
SELECT 
  name = SUBSTRING(t.name, 1, CHARINDEX('___', t.name)-1),
  t.[object_id]
FROM tempdb.sys.tables AS t
WHERE t.name LIKE '#%[_][_][_]%'
AND t.[object_id] = 
  OBJECT_ID('tempdb..' + SUBSTRING(t.name, 1, CHARINDEX('___', t.name)-1)); 
```

您可能还对这些表中的每一个使用的空间感兴趣（至少对于堆或聚集索引），例如：

```
SELECT 
    name = SUBSTRING(t.name, 1, CHARINDEX('___', t.name)-1),
    t.[object_id], 
    p.used_page_count, 
    p.row_count
FROM tempdb.sys.tables AS t
INNER JOIN tempdb.sys.dm_db_partition_stats AS p
ON t.[object_id] = p.[object_id]
WHERE t.name LIKE '#%[_][_][_]%'
AND p.index_id IN (0,1)
AND t.[object_id] = 
    OBJECT_ID('tempdb..' + SUBSTRING(t.name, 1, CHARINDEX('___', t.name)-1)); 
```

您可以扩展它以显示所有索引的总空间。我没有费心聚合每个分区，因为这些是#temp 表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T18:08:53.023

```
select * 
from tempdb.sys.objects
where object_id('tempdb.dbo.' + name, 'U') is not null 
  AND name LIKE '#%' 
```

会告诉你 tempdb 中所有可以访问的以 # 开头的表，但是 Aaron 的脚本让我大吃一惊，哈哈

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-12T17:09:52.900

要找出创建对象的用户的名称，您只需检查模式 ID 并与 Schemas 表交叉引用

```
Select sch.name as 'User Owner' from tempdb.sys.tables TBL
join tempdb.sys.schemas SCH on TBL.schema_id = SCH.schema_id
where TBL.name like '#tmp_Foo%' 
```

# c# - 在环绕面板中设置最大行数

> ID：11636396
> 
> 赞同：5
> 
> 时间：2012-07-24T17:45:27.817
> 
> 标签：c#, wpf, xaml, panel, wrappanel

我需要配置一个换行面板，我可以在其中设置最大行数或最大列数。

这真的很有必要，我使用的是 WPF 4.0。但是另一天，我正在编写 Metro 应用程序，我记得它的一个控件具有此属性，但在 WPF 中没有（直到我知道）。

WPF 4.0 中是否存在这样的控件？还是我需要创建一个新的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T17:54:27.327

您可以设置`ItemHeight`和`ItemWidth`属性来设置最大行数和列数...

有关更多信息，请查看[此处](http://www.codeproject.com/Articles/32629/A-better-panel-for-data-binding-to-a-WrapPanel-in)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-31T09:10:01.873

这是这样一个 WrapPanel 的**实现**。

**xml:**

```
<loc:WrapPanelWithRowsOrColumnsCount
    xmlns:loc="clr-namespace:..."
    Orientation="Vertical"
    RowsOrColumnsCount="2">
    <TextBox Text="Andrew" Margin="2" Height="30" />
    <TextBox Text="Betty" Margin="2" Height="40" />
    <TextBox Text="Celine" Margin="2" Height="20" />
    <TextBox Text="Dick" Margin="2" Height="20" />
    <TextBox Text="Enron" Margin="2" Height="30" />
    <TextBox Text="Felix" Margin="2" Height="20" />
    <TextBox Text="Hanibal" Margin="2" Height="30" />
</loc:WrapPanelWithRowsOrColumnsCount> 
```

**结果：**

[![在此处输入图像描述](../Images/34072ea0c62b8184f8ebfdb4cd3481f0.png)](https://i.stack.imgur.com/nJvM1.png)

**代码**`WrapPanelWithRowsOrColumnsCount.cs`：_

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;

public class WrapPanelWithRowsOrColumnsCount : WrapPanel
{
    public static readonly DependencyProperty RowsOrColumnsCountProperty = 
        DependencyProperty.Register(
            "RowsOrColumnsCount",
            typeof(int),
            typeof(WrapPanelWithRowsOrColumnsCount),
            new PropertyMetadata(int.MaxValue));

    public int RowsOrColumnsCount
    {
        get { return (int)GetValue(RowsOrColumnsCountProperty); }
        set { SetValue(RowsOrColumnsCountProperty, Math.Max(value, 1)); }
    }

    protected override Size MeasureOverride(Size availableSize)
    {
        if (Children.Count > 0)
        {
            Size newAvailableSize;

            if (Orientation == Orientation.Horizontal)
            {
                var suitableWidth = EstimateSuitableRowOrColumnLength(Children.Cast<UIElement>(),
                                                                        true,
                                                                        availableSize,
                                                                        RowsOrColumnsCount);

                newAvailableSize = 
                    double.IsNaN(suitableWidth) || suitableWidth <= 0
                        ? availableSize 
                        : new Size(Math.Min(suitableWidth, availableSize.Width), availableSize.Height);
            }
            else
            {
                var suitableHeigth = EstimateSuitableRowOrColumnLength(Children.Cast<UIElement>(),
                                                                        false,
                                                                        availableSize,
                                                                        RowsOrColumnsCount);
                newAvailableSize =
                    double.IsNaN(suitableHeigth) || suitableHeigth <= 0
                        ? availableSize
                        : new Size(availableSize.Width, Math.Min(suitableHeigth, availableSize.Height));
            }

            return base.MeasureOverride(newAvailableSize);
        }
        else
        {
            return base.MeasureOverride(availableSize);
        }
    }

    private double EstimateSuitableRowOrColumnLength(IEnumerable<UIElement> elements,
                                                        bool trueRowsFalseColumns,
                                                        Size availableSize,
                                                        int rowsOrColumnsCount)
    {
        var elementsList = elements.ToList();

        var desiredLengths = elementsList.Select(el => DesiredLength(el, availableSize, trueRowsFalseColumns)).ToList();

        var maxLength = desiredLengths.Where(length => !double.IsNaN(length)).Concat(new[] { 0.0 }).Max();

        if (maxLength <= 0.0)
        {
            return double.NaN;
        }

        var desiredLengthsRepaired = desiredLengths.Select(length => double.IsNaN(length) ? maxLength : length).ToList();

        var totalDesiredLength = desiredLengthsRepaired.Sum();

        var maxCount = Math.Min(rowsOrColumnsCount, elementsList.Count);

        var suitableRowOrColumnLength = totalDesiredLength / maxCount;

        double nextLengthIncrement;

        while (CountRowsOrColumnsNumber(desiredLengthsRepaired, suitableRowOrColumnLength, out nextLengthIncrement) > maxCount)
        {
            suitableRowOrColumnLength += nextLengthIncrement;
        }

        suitableRowOrColumnLength = Math.Max(suitableRowOrColumnLength, desiredLengthsRepaired.Max());

        return suitableRowOrColumnLength;
    }

    private int CountRowsOrColumnsNumber(List<double> desiredLengths, double rowOrColumnLengthLimit, out double nextLengthIncrement)
    {
        int rowOrColumnCount = 1;
        double currentCumulativeLength = 0;
        bool nextNewRowOrColumn = false;

        var minimalIncrement = double.MaxValue;

        foreach (var desiredLength in desiredLengths)
        {
            if (nextNewRowOrColumn)
            {
                rowOrColumnCount++;
                currentCumulativeLength = 0;
                nextNewRowOrColumn = false;
            }

            if (currentCumulativeLength + desiredLength > rowOrColumnLengthLimit)
            {
                minimalIncrement = Math.Min(minimalIncrement,
                                            currentCumulativeLength + desiredLength - rowOrColumnLengthLimit);

                if (currentCumulativeLength == 0)
                {
                    nextNewRowOrColumn = true;
                    currentCumulativeLength = 0;
                }
                else
                {
                    rowOrColumnCount++;
                    currentCumulativeLength = desiredLength;
                }
            }
            else
            {
                currentCumulativeLength += desiredLength;
            }
        }

        nextLengthIncrement = minimalIncrement != double.MaxValue ? minimalIncrement : 1;

        return rowOrColumnCount;
    }

    private double DesiredLength(UIElement el, Size availableSize, bool trueRowsFalseColumns)
    {
        el.Measure(availableSize);
        Size next = el.DesiredSize;

        var length = trueRowsFalseColumns ? next.Width : next.Height;

        if (Double.IsInfinity(length) ||
            Double.IsNaN(length))
        {
            return Double.NaN;
        }
        else
        {
            return length;
        }
    }
} 
```

该解决方案的灵感来自[此 codeproject 文章](https://www.codeproject.com/articles/32629/a-better-panel-for-data-binding-to-a-wrappanel-in)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:52:39.663

我认为对于您要完成的 WPF Grid 是更好的解决方案。通过设置特定的网格行数，您可以模拟环绕面板的行为，并且更加灵活。

```
<Grid>
  <Grid.ColumnDefinitions>
    <ColumDefinition Height="Auto"/>
    <ColumDefinition Height="Auto"/>
    <ColumDefinition Height="Auto"/>
    .... 
    <ColumDefinition Height="*/>  
  </Grid.ColumnDefinitions>
<Grid> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T17:55:02.960

我认为您可以使用 WrapPanel 执行此操作的唯一方法是，如果您知道对象的大小（并且它们是一致的），那么您可以相应地设置 WrapPanel 的高度/宽度。不过这很丑。

要考虑的一件事：您希望面板如何处理超出最大行/列数的元素？还是总有正确数量的元素？如果是这种情况，那么您应该真正查看网格。

# hadoop - s3cmd 没有“获取”distcp jar 文件

> ID：11636397
> 
> 赞同：1
> 
> 时间：2012-07-24T17:45:30.763
> 
> 标签：hadoop, amazon-s3, s3cmd

大家好：我正在尝试通过 s3 在 EMR 集群中获取 s3 distcp jar 文件：

```
s3cmd get s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar 
```

但是，“get”命令不起作用：

```
ERROR: Skipping libs/s3distcp/: No such file or directory 
```

该文件也存在于其他 s3 区域中，所以我什至尝试过：

```
s3cmd get s3://us-east-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar 
```

但是ecommand仍然失败。但是，唉——这个 .jar 文件显然存在，当我们运行“s3cmd ls”时，我们可以看到它被列出来。有关详细信息，请参见下文（以 eu-west 地区为例）：

```
hadoop@ip-10-58-254-82:/mnt$ s3cmd ls s3://eu-west-1.elasticmapreduce/libs/s3distcp/
Bucket 'eu-west-1.elasticmapreduce':
2012-06-01 00:32   3614287   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar
2012-06-05 17:14   3615026   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.2/s3distcp.jar
2012-06-12 20:52   1893078   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.3/s3distcp.jar
2012-06-20 01:17   1893140   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.4/s3distcp.jar
2012-06-27 21:27   1893846   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.5/s3distcp.jar
2012-03-15 21:21   3613175   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0/s3distcp.jar
2012-06-27 21:27   1893846   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.latest/s3distcp.jar 
```

以上似乎证实了，事实上该文件是存在的。

**我怎样才能使“get”命令适用于这个文件？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:13:00.193

jar 工作正常，您可以粘贴 get 命令后收到的错误消息吗？

```
:s3cmd ls s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar

2012-06-01 00:32   3614287   s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar

:s3cmd get s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar

s3://eu-west-1.elasticmapreduce/libs/s3distcp/1.0.1/s3distcp.jar -> ./s3distcp.jar  [1 of 1]
 3614287 of 3614287   100% in    3s  1008.86 kB/s  done 
```

# jquery - 如何获取方法的默认值（jQuery插件）

> ID：11636401
> 
> 赞同：0
> 
> 时间：2012-07-24T17:45:40.077
> 
> 标签：jquery, plugins, default

```
$.fn.myFunction = function(options) {
    var options = $.extend({}, $.fn.myFunction.defaults, options);        
    $.fn.myFunction.defaults = {
        var1: 123,
        var2: 987
    }
} 
```

我需要在 myFunction 之外获取 var1 (= 123) ... 怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:47:56.427

您只是希望能够从任何地方访问该值？

```
console.log($.fn.myFunction.defaults.var1) // 123 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:48:05.600

在这种特殊情况下，

```
var default1 = $.fn.myFunction.defaults.va1; 
```

但是没有通用的（与插件无关的）方法可以做到这一点。

# java - JTar 从 .tar 文件中提取文件

> ID：11636403
> 
> 赞同：0
> 
> 时间：2012-07-24T17:45:42.153
> 
> 标签：java, tar

我正在`jtar-1.1`尝试从 tar 文件中提取文件，我使用以下代码尝试提取文件

```
String tarFile = "c:/test/test.tar";
String destFolder = "c:/test/myfiles";

// Create a TarInputStream
TarInputStream tis = new TarInputStream(new BufferedInputStream(new FileInputStream(tarFile)));
while (( entry = tis.getNextEntry() ) != null) {
        System.out.println( "Extracting: " + entry.getName() );
        int count;
        byte data[] = new byte[BUFFER];

        if (entry.isDirectory()) {
            new File( destFolder + "/" + entry.getName() ).mkdirs();
            continue;
        } else {
            int di = entry.getName().lastIndexOf( '/' );
            if (di != -1) {
                new File( destFolder + "/" + entry.getName().substring( 0, di ) ).mkdirs();
            }
        }

        FileOutputStream fos = new FileOutputStream( destFolder + "/" + entry.getName() );
        BufferedOutputStream dest = new BufferedOutputStream( fos );

        while (( count = tis.read( data ) ) != -1) {
            dest.write( data, 0, count );
        }

        dest.flush();
        dest.close();
    }
} 
```

编辑：

我已经编辑了上面的代码来检查`entry`a `directory`，一旦我这样做了，它就消除了`FileNotFound`错误......上面的代码现在可以工作了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:06:54.220

我认为您需要在打开 FileOutputStream 之前创建路径。

类似的主题[在这里](https://stackoverflow.com/questions/7353871/fileoutputstream-throws-filenotfoundexception-when-unzipping)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:58:07.710

刚刚开始，也许问题是您收到的条目包含一个尚未创建的子文件夹：'LAB3'？在这种情况下，文件系统中不存在目录“LAB3”，因为您尚未创建它，并且文件“sg5”打算放置在那里，因此当您尝试在包含 LAB3 的完全限定路径上创建文件时它抱怨。

# networking - 网络单元的定义：分片、分段、包、帧、数据报

> ID：11636405
> 
> 赞同：55
> 
> 时间：2012-07-24T17:45:44.570
> 
> 标签：networking, ip, definition, osi

网络术语中使用哪些单位？我们在哪里使用它们？

我知道以下内容 - 但我不确定它们的含义是什么：

*   分段
*   分割
*   包
*   框架
*   数据报

它们可以分配给特定的 OSI 层吗？是不是更复杂？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-07-24T18:28:47.940

*[取自Richard Stevens 等人](http://www.cs.newpaltz.edu/~pletcha/NET_PY/the-protocols-tcp-ip-illustrated-volume-1.9780201633467.24290.pdf)*的 TCP/IP Illustrated: Vol 1 中的第 1.2 节，考虑 4 层 TCP/IP 堆栈：

```
 +-------------+-------------------------+
        | Application |  Telnet, FTP, etc       |
        +-------------+-------------------------+
        | Transport   |  TCP, UDP               |
        +-------------+-------------------------+
        | Network     |  IP, ICMP               |
        +-------------+-------------------------+
        | Link        | drivers, interface card | 
        +-------------+-------------------------+ 
```

**Segment**：如果传输协议是 TCP，那么从 TCP 发送到网络层的数据单位称为*Segment*。

**数据报**：这用于 2 层。如果网络协议是 IP，则数据的单位称为*Datagram*。在传输层，如果协议是 UDP，我们也使用数据报。因此，我们将它们区分为*UDP Datagram*、*IP Datagram*。

**帧**：物理层表示。

**数据包**：它是一个更通用的术语，用于传输层或网络层。 *TCP Packet*，*UDP Packet*，*IP Packet*等。我还没有看到它代表物理层数据单元。

**Fragment**：我的猜测是，当一个数据单元被协议分割以适应 MTU 大小时，生成的数据单元称为*Fragments*。但我猜。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-06-10T06:28:51.420

这些术语用于指代我们所指的 OSI 层，数据保持不变，但标头和尾标被添加或删除。

在物理层（即物理层）中，实际数据以“位”为单位，即 0 和 1。

当它到达数据链路层或第 2 层时，它变成了“帧”，其中添加了源和目标 MAC 地址。

当它到达第三层或网络层时，它就变成了一个附有源 IP 地址和目标 IP 地址的“数据包”。

最后它成为第 4 层或 TCP/IP 层的“段”。基本上，“段”术语用于 TCP 连接，“数据报”用于 UDP。

那么其他层呢，例如：会话、表示和应用程序？在这些层中，数据被称为“PDU”或“协议数据单元”。

因此，当有人说网络设备正在接收“帧”时，您就知道该设备是交换机。

路由器接收数据包并处理它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-30T16:50:36.923

上面的答案是完整的。尽管如此，如果我没记错的话，我认为数据包这个术语来自数据包交换......

有 2 种类型：

**电路交换**是一种实现电信网络的方法，其中两个网络节点在节点可以通信之前通过网络建立专用通信信道（电路）。该电路保证通道的全带宽，并在通信会话期间保持连接。电路的功能就像节点与电路物理连接一样。（Wiki）

**分组交换**是一种数字网络通信方法，它将所有传输的数据——无论内容、类型或结构——分组到适当大小的块中，称为数据包。（维基）

我会自己定义它，但只是为了**确定**。

所以这里是数据包术语。关于片段，**我同意**Josua Schmid 的回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-30T08:47:18.630

**对我来说，作为物理层表示的帧**听起来不是 100% 准确的。它主要位于物理之上的数据链路层。

对于更具操作性的定义，我会说帧是一个协议数据单元，它具有确定其边界的方法。例子：

*   HDLC 帧在开始和结束时具有标志以及位填充
    机制
*   以太网帧使用前导码和 SFD
*   GFP 使用 HEC 帧描述，如 ATM

一个**信元**，就像在 ATM 中一样，只是为了多介绍一个术语，是一个固定长度的帧。

**相反，数据包**是一个协议数据单元，它依赖于较低层单元来确定其边界。如果需要，它可能完全适合一帧或被分解**成碎片**。在后一种情况下，必须设计碎片和重组机制。**数据报**主要是数据包的同义词。

一个应用程序数据流可以分成多个**段**。段在数据报上承载，然后段被重新组合到原始应用程序流中。这通常由 TCP 层完成。因此，在 TCP 中，我们在数据链路帧上通过 IP 数据报在 TCP 段上使用应用程序流。在 UDP 中没有分段，所以 UDP 数据报是一对一映射到 IP 数据报上的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-17T00:49:35.960

我同意上面的答案，但重要的是要强调这是假设 TCP/IP 堆栈。如果我们使用我认为更普遍的 OSI 模型，我们将有以下情况：

传输层：如果是 TCP 则为分段，如果是 UDP 则为数据报 网络层：如果拆分，则可以使用数据报，片段（它仍然是数据报） 数据链路层：MAC 子层中的帧，LLC 子层中的帧或位（取决于什么级别与您一起工作，它们不可互换）物理层：位

正如前面的答案中提到的，数据包更通用，它可以用于传输层、网络层或数据链路层，但不能用于物理层。在这个级别，它还没有被“打包”。所以我想说这是 TCP/IP 堆栈模型和 OSI 模型之间最大的区别。OSI 模型将 TCP/IP 堆栈中的物理层分解为两层：数据链路层和物理层。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-08T03:57:33.400

数据报是……一个自包含的、独立的数据实体，它携带足够的信息，可以从源计算机路由到目标计算机，而不依赖于该源计算机和目标计算机以及传输网络之间的早期交换。（……在 UDP 中使用）

一个段是……一个协议数据单元，它由一个 TCP 标头和一个来自（上）应用层的应用数据块（数据包）组成

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-01T11:10:02.073

**数据包**：网络中源和目标之间通信的基本单位是数据包。数据包是 OSI 模型中网络层内的数据单元。数据包位于**网络层**。

**片段**：数据包通常可以大于最大大小，因此每个数据包也被分成更小的数据片段，称为片段。**网络层**负责分片。

**段**：段是一个数据包的碎片，每个数据包都有一个 TCP 标头。段提高了网络性能的效率并提高了安全性。段位于**传输层中。**

**帧**：类似于数据包，帧是网络中消息的一小部分。帧是 OSI 模型的**数据链路层**中使用的数据单位。

**数据报**：数据报表示网络中传输的数据单元。在网络中传输的数据被分成更小的部分，称为数据报。**传输** **层**

另外，还有一些class bit，这个在一个**Physical** **layer**

# php - 通过 cmd 打开 URL 无需打开浏览器

> ID：11636409
> 
> 赞同：4
> 
> 时间：2012-07-24T17:46:01.093
> 
> 标签：php, browser, cron, cmd

我想使用运行 Windows 7 的本地服务器来利用任务调度程序为我的一些 php 文件设置一些 cron 作业。

我目前可以通过以下方式做到这一点： `start http://theurl`

在我的默认浏览器中打开。但是，我希望在不实际打开浏览器的情况下完成此操作，因此当我几天后回到我的计算机时，我没有打开数百万个 Chrome 窗口。

如何在不通过打开浏览器客户端的情况下在任务计划程序中加载 URL `cmd`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T12:44:31.973

我能够通过使用一个名为[wget](http://gnuwin32.sourceforge.net/packages/wget.htm)的程序来完成 cron 工作。我设置任务调度程序以在我指定的时间使用以下参数运行 wget.exe：

```
 wget -q -O - http://theurl.com > tmp.txt 
```

这将加载网站并将其存储到临时文本文件中，下次使用时会覆盖该文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T17:53:23.317

如果您只想运行一些 php 文件，则不需要浏览器。您可以从命令行运行它：

```
php -f /path/to/php/file.php 
```

但是，如果您确实需要访问一个页面，您可以执行以下几项操作：或从 PHP[`file_get_contents()`](http://php.net/manual/en/function.file-get-contents.php)发出[cURL 请求。](http://nl.php.net/manual/en/book.curl.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:47:46.520

您不需要 cmd 或 shell 访问权限。如果您的主机启用了 HTTP 包装器，那么您只需要调用[`file_get_contents()`](http://php.net/file_get_contents)：

```
file_get_contents( 'http://theurl'); 
```

[`fopen()`](http://php.net/fopen)如果您对服务器的响应不感兴趣，也可以使用。

# c++ - 识别导致“非 POD 类型‘类段’”的错误

> ID：11636412
> 
> 赞同：2
> 
> 时间：2012-07-24T17:46:09.860
> 
> 标签：c++, std, segments

*发生错误的代码部分：*

```
int disk::access (const char fname[]){

    int char_count=77;
    int actual_count=0; //just to pass the tests.
    char c;

    cout << "the file name is " << fname << ", and the mode is " << mode << endl;
    if(strcmp(mode, "w")==0){
        for (int i = 0; i < size; i++) {
            //cout << "sgm to be written is " << sgm[i];
            fp=fopen(fname, "w");
            fprintf(fp, "%s\n",sgm[i]);
         }
        fclose(fp);
    }       
    if(strcmp(mode,"a")==0){
        fp=fopen(fname, "a");
        fprintf(fp, "%s\n", sgm);
        fclose(fp);
    }

    fp=fopen(fname, "r");

    do{
        c=fgetc(fp);
        if(c!=' ' && c!='\n')
        actual_count++; 
     }while(c!=EOF);
    fclose(fp);

    return actual_count;        
} 
```

*我的错误：*

> disk.cpp：在成员函数'int disk::access(const char*)'中：
> 
> disk.cpp:67：警告：不能通过“...”传递非 POD 类型“类段”的对象；调用将在运行时中止

***编辑***第 67 行是： fprintf(fp, "%s\n",sgm[i]);

***编辑***SGM：

cpp代码：

```
disk::disk(int num_of_segments, const char* temp_mode){

    size=num_of_segments;
    sgm = new segment[size];  //initializes num_of_segments in a disk

    count=0;        
    if(strcmp(mode, "w")!=0||strcmp(mode, "a")!=0){
        strcpy(mode, "w");
    }

}

disk::disk(){

    sgm = new segment[20]; //initialize 20 segments in a disk
    size=20;  //keeps track of how many are initialized
    count=0;  //keeps track of how many are added
    strcpy(mode, "w"); //initialize disk access mode to w

} 
```

标头代码：

```
class disk {
    private:
        int size, count; //to keep a track of number of segments 
        char mode [2]; //a for append and w for write 
        segment* sgm;
        FILE *fp;

    public:
        disk(int num_of_segments, const char *temp_mode);
        disk();
        ~disk();
        const char* get_mode( ) const;
        segment get_segment(int pos) const;
        int get_segment_count( ) const;
        const segment* get_all_segments( ) const;
        int access(const char fname[ ]);
        disk& operator+=(const segment &rhs);
        disk& operator=(const disk &dk);
}; 
```

我以前没有遇到过这样的警告。我做了一些搜索，从我收集的 POD 中得到“普通的旧数据，它是一个没有构造函数、析构函数和虚拟成员函数的结构”。——格雷格·休吉尔

因此，如果我理解正确，我的错误是我确实有构造函数或析构函数和/或虚拟成员函数，因为它是非 POD？

我想我只是让自己感到困惑，我不确定如何解决这个错误，甚至不知道问题出在哪里。

欢迎所有建议并非常感谢，

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:18:59.110

我冒昧地猜测一下，说“segment”是一个结构或一个类，而您正试图将它打印为一个“%s”字符串。

您需要实现一个将段转换为字符串的函数。或打印段的各个本机字段。

例如，如果您这样定义段

```
struct segment { char name[10]; int index; } 
```

应该作为

```
print("%s:%d\n", seg.name, seg.index); 
```

或作为

```
inline std::ostream& operator << (std::ostream& os, const struct segment& seg)
{
return os<<seg.name<<":"<<seg.index;
} 
```

并且您的方法调用变为：

```
std::ostringstream os;
os<<seg;
std::string segStr = os.str();
printf("%s\n", segStr.c_str()); 
```

您还可以手动编写 toString() 类型的函数来获取段的字符串表示形式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:52:17.383

如果`sgm`包含`virtual`方法 or 是`class`or `struct`，则您依赖于该行的实现：

```
fprintf(fp, "%s\n",sgm[i]); 
```

`%s`你说的`fprintf`是`sgm[i]`一个. `char*`如果`sgm[i]`有虚函数，这很可能是错误的（因为`vfptr`）。如果该类型的成员布局没有将 a`char*`作为第一个数据成员，那么这将再次为 false。

# image-processing - 使用 SIFT 为每个关键点生成局部特征

> ID：11636415
> 
> 赞同：0
> 
> 时间：2012-07-24T17:46:21.650
> 
> 标签：image-processing, similarity, sift, feature-extraction, keypoint

我有一张图像，我想通过使用 SIFT 检测器定位关键点并将它们分组，然后我想通过使用 SIFT 为每个关键点生成局部特征，请你帮我怎么做？请给我任何建议我非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T06:27:07.660

If you are using opencv here are the commands to do it, else if you are using the matlab see the link [MATCHING_using surf](http://www.mathworks.com/matlabcentral/fileexchange/28300-opensurf-including-image-warp)

* * *

**USING OPENCV::**

// you can change the parameters for your requirement

```
 double hessianThreshold=200; 
    int octaves=3;
    int octaveLayers=4;
    bool upright=false;
    vector<KeyPoint>keypoints; 
```

//The detector detects the keypoints in an image here image is RGBIMAGE of Mat type

```
SurfFeatureDetector detector( hessianThreshold, octaves, octaveLayers, upright );
detector.detect(RGB_IMAGE, keypoints); 
```

//The extractor computesthe local features around the keypoints

```
SurfDescriptorExtractor extractor;
Mat descriptors;
extractor.compute( last_ref, keypoints, descriptors); 
```

// all the key points local features are stored in rows one after another in descriptors matrix...

Hope it is useful:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:27:56.190

我不确定我理解你的意思，但是如果你从图像中提取 SIFT 特征，你会自动获得用于相互比较特征的特征描述符。当然你也可以用它得到特征位置、大小、方向和粗麻布值。

虽然您可以按图像中的位置对这些特征进行分组，但目前我知道无法比较这些组，因为它们可能是局部相关的，但可能具有截然不同的特征描述符。

我也建议冲浪。它速度更快且不受专利保护。

如果您需要有关如何检索和比较描述符的具体说明，请查看[OpenCV 中的示例。](http://opencv.willowgarage.com/)

# tsql - CTE 的真正递归？

> ID：11636420
> 
> 赞同：0
> 
> 时间：2012-07-24T17:46:46.460
> 
> 标签：tsql, recursion, common-table-expression

我今天下午才发现 CTE，在享受了 2 个小时之后，我意识到它们并没有像我们在任何其他语言中学到的那样执行常见的递归。

我的意思是，我总是将递归视为树搜索。所以我期待 CTE 一直到它发现的第一片叶子，但没有。他分层工作。它从头部开始，然后是所有分支，然后是所有子分支，等等……然后是叶子。

有没有办法让它以不同的方式搜索？也许我错过了什么...我在 SQL Server 2005 上工作（不，我不能为 2008 年更改）

为了清楚起见，我不想：

1.  团队1
2.  团队2
3.  团队3
4.  团队1-1
5.  队3-1
6.  团队1-2

但

1.  团队1
2.  团队1-1
3.  团队1-2
4.  团队2
5.  团队3
6.  队3-1

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T18:50:27.550

您可以在执行递归时构建一个列进行排序。

像这样的东西：

```
declare @t table
(
  ID int,
  ParentID int,
  Name varchar(10)
);

insert into @T values
(1, null, 'team1'),
(2, null, 'team2'),
(3, null, 'team3'),
(4, 1, 'team1-1'),
(5, 1, 'team1-2'),
(6, 3, 'team3-1');

with C as
(
  select T.ID,
         T.ParentID,
         T.Name,
         cast(right(100000 + row_number() over(order by T.ID), 5) as varchar(max)) as Sort
  from @T as T
  where T.ParentID is null
  union all
  select T.ID,
         T.ParentID,
         T.Name,
         C.Sort+right(100000 + row_number() over(order by T.ID), 5)
  from @T as T
    inner join C
      on T.ParentID = C.ID
)
select *
from C
order by Sort 
```

结果：

```
ID          ParentID    Name       Sort
----------- ----------- ---------- ------------
1           NULL        team1      00001
4           1           team1-1    0000100001
5           1           team1-2    0000100002
2           NULL        team2      00002
3           NULL        team3      00003
6           3           team3-1    0000300001 
```

# javascript - 如何强制 Firebug 按声明的顺序打印我的 JSON 属性？

> ID：11636421
> 
> 赞同：0
> 
> 时间：2012-07-24T17:46:50.233
> 
> 标签：javascript, json

我正在用 JavaScript 构建 JSON。这是我的对象：

```
catalogoJSON = {
    condicion: condicionCatalogos0,
    tipo: tipoCatalogos0,
    idCatalogo: idCatalogo0,
    valor: valorCatalogos0
}; 
```

但是当我用 Firebug 打印它时，我的属性按字母顺序打印，如下所示：

```
{
    condicion: condicionCatalogos0,
    idCatalogo: idCatalogo0,
    tipo: tipoCatalogos0,
    valor: valorCatalogos0
} 
```

JavaScript 中有没有办法按照我声明它们的顺序取回我的 JSON 及其属性，而不必更改我的属性名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:49:08.593

JavaScript 中的对象没有继承顺序。Firebug 只是按字母顺序打印，因为感觉就像它（Chrome 的开发工具也是如此）。

您可以尝试遍历对象并自己打印，这*可能会*保持顺序。

```
for(var x in catalogoJSON){
    console.log(x, catalogoJSON[x]);
} 
```

# entity-framework - Entity Framework + ODATA：回避分页

> ID：11636425
> 
> 赞同：1
> 
> 时间：2012-07-24T17:47:07.643
> 
> 标签：entity-framework, pagination, odata

我正在处理的项目在 OData 层之上具有实体框架。Odata 层将其服务器端分页设置为`75`. 我对这个主题的阅读让我相信这个分页值是全面使用的，而不是每张桌子的基础。我目前要从中提取*所有*数据的表当然超过 75 行。使用实体框架，我的代码就是这样：

```
public IQueryable<ProductColor> GetProductColors()
{
   return db.ProductColors;
} 
```

`db`实体上下文在哪里。这将返回前 75 条记录。我读了一些东西，我可以在其中附加一个参数`inlinecount`集来`allpages`给我以下代码：

```
public IQueryable<ProductColor> GetProductColors()
{
   return db.ProductColors.AddQueryOption("inlinecount","allpages");
} 
```

但是，这也返回 75 行！

无论 OData 服务器端分页内容如何，​​任何人都可以阐明如何真正获取所有记录吗？

*重要：*我无法删除分页或将其关闭！在其他需要关注性能的场景中，它非常有价值。

**更新：** 通过更多搜索，我找到了描述如何执行此任务的[MSDN 。](http://msdn.microsoft.com/en-us/library/ee474320.aspx)

我希望能够将它变成一个完整的通用方法，但是，这与我可以在不使用反射的情况下获得的通用方法一样接近：

```
public IQueryable<T> TakeAll<T>(QueryOperationResponse<T> qor)
    {
      var collection = new List<T>();
      DataServiceQueryContinuation<T> next = null;
      QueryOperationResponse<T> response = qor;
      do
      {
        if (next != null)
        {
          response = db.Execute<T>(next) as QueryOperationResponse<T>;
        }

        foreach (var elem in response)
        {
          collection.Add(elem);          
        }

      } while ((next = response.GetContinuation()) != null);

      return collection.AsQueryable();
    } 
```

像这样称呼它：

```
public IQueryable<ProductColor> GetProductColors()
    {      
      QueryOperationResponse<ProductColor> response = db.ProductColors.Execute() as QueryOperationResponse<ProductColor>;
      var productColors = this.TakeAll<ProductColor>(response);
      return productColors.AsQueryable();
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T18:42:26.547

如果无法关闭寻呼，您将始终收到 75 行的呼叫。您可以通过以下方式获取所有行：

1.  添加另一个`IQueryable<ProductColor> AllProductColors`并修改

    ```
    public static void InitializeService(DataServiceConfiguration config)
    {
        config.UseVerboseErrors = true;
        config.SetEntitySetAccessRule("*", EntitySetRights.AllRead);
        config.SetEntitySetPageSize("ProductColors", 75); - Note only paged queries are present
        config.SetServiceOperationAccessRule("*", ServiceOperationRights.AllRead);
        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V2;
    } 
    ```

2.  例如，您应该根据需要尽可能多地调用 ProductColors

    ```
     var cat = new NetflixCatalog(new Uri("http://odata.netflix.com/v1/Catalog/"));

        var x = from t in cat.Titles
                where t.ReleaseYear == 2009
                select t;
        var response = (QueryOperationResponse<Title>)((DataServiceQuery<Title>)x).Execute();

        while (true)
        {
            foreach (Title title in response)
            {
                Console.WriteLine(title.Name);
            }

            var continuation = response.GetContinuation();
            if (continuation == null)
            {
                break;
            }

            response = cat.Execute(continuation);
        } 
    ```

我使用带有以下代码的 Rx

```
public sealed class DataSequence<TEntry> : IObservable<TEntry>
{
    private readonly DataServiceContext context;
    private readonly Logger logger = LogManager.GetCurrentClassLogger();
    private readonly IQueryable<TEntry> query;

    public DataSequence(IQueryable<TEntry> query, DataServiceContext context)
    {
        this.query = query;
        this.context = context;
    }

    public IDisposable Subscribe(IObserver<TEntry> observer)
    {
        QueryOperationResponse<TEntry> response;
        try
        {
            response = (QueryOperationResponse<TEntry>)((DataServiceQuery<TEntry>)query).Execute();
            if (response == null)
            {
                return Disposable.Empty;
            }
        }
        catch (Exception ex)
        {
            logger.Error(ex);
            return Disposable.Empty;
        }
        var initialState = new State
                               {
                                   CanContinue = true,
                                   Response = response
                               };
        IObservable<TEntry> sequence = Observable.Generate(
            initialState,
            state => state.CanContinue,
            MoveToNextState,
            GetCurrentValue,
            Scheduler.ThreadPool).Merge();
        return new CompositeDisposable(initialState, sequence.Subscribe(observer));
    }

    private static IObservable<TEntry> GetCurrentValue(State state)
    {
        if (state.Response == null)
        {
            return Observable.Empty<TEntry>();
        }
        return state.Response.ToObservable();
    }

    private State MoveToNextState(State state)
    {
        DataServiceQueryContinuation<TEntry> continuation = state.Response.GetContinuation();
        if (continuation == null)
        {
            state.CanContinue = false;
            return state;
        }
        QueryOperationResponse<TEntry> response;
        try
        {
            response = context.Execute(continuation);
        }
        catch (Exception)
        {
            state.CanContinue = false;
            return state;
        }
        state.Response = response;
        return state;
    }

    private sealed class State : IDisposable
    {

        public bool CanContinue { get; set; }

        public QueryOperationResponse<TEntry> Response { get; set; }

        public void Dispose()
        {
            CanContinue = false;
        }
    }
} 
```

因此，要通过 OData 获取任何数据，请创建一个序列，然后由 Rx 完成其余工作

```
 var sequence = new DataSequence<Product>(context.Products, context);
 sequence.OnErrorResumeNext(Observable.Empty<Product>())
            .ObserveOnDispatcher().SubscribeOn(Scheduler.NewThread).Subscribe(AddProduct, logger.Error); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:55:04.780

页面大小由服务作者设置，并且可以为每个实体集设置（但服务可以选择将相同的页面大小应用于所有实体集）。无法从客户端避免它（这是设计使然，因为它是一项安全功能）。

inlinecount 选项要求服务器包含结果的总计数（只是数字），它不会禁用分页。

从客户端读取所有数据的唯一方法是发出将返回第一页的请求，它可能包含您请求读取下一页的下一个链接，依此类推，直到最后一个响应没有下一个关联。

如果您使用的是 WCF 数据服务客户端库，它支持延续（下一个链接），并且可以在此博客文章中找到一个简单的示例（例如）：http: [//blogs.msdn.com/b/phaniraj /archive/2010/04/25/server-driven-paging-with-wcf-data-services.aspx](http://blogs.msdn.com/b/phaniraj/archive/2010/04/25/server-driven-paging-with-wcf-data-services.aspx)

# actionscript-3 - 将来自网络摄像头的 h.264 记录为来自闪存的 f4v

> ID：11636426
> 
> 赞同：2
> 
> 时间：2012-07-24T17:47:16.973
> 
> 标签：actionscript-3, flash, h.264, flash-media-server

使用 Flash Media Server，我有一个预制的应用程序，它从网络摄像头和麦克风记录并将其作为 FLV 文件发布到 FMS 服务器。

这很好用，但我现在需要将录制的视频流式传输到 iOS 设备。我有 FMS 工作，它可以将 hls-record/sample.f4v.m3u8 文件流式传输到 iOS / quicktime 设备。

我已经在线阅读了一些教程，并将 publish(filename, "record") 更改为 publish("mp4:" + filename + ".f4v", record)

它记录将文件存储在 FMS 服务器上（我在那里看到它，带有我给它的文件名，并作为 .f4v 文件），它有内容。当我开始播放它时（通过 quicktime 或 safari），我看到了视频的长度（4 秒作为测试）但没有视频。跟踪栏不移动，等待图标等待。

FMS 版本 4.5 和 Flash 11.3 安装在我的 Mac 上。（CentOS 5.8 服务器）

我肯定错过了什么。

```
package com
{
import fl.controls.ProgressBar;
import fl.controls.ProgressBarMode;
import flash.display.MovieClip;
import flash.events.Event;
import com.NetConnector
import flash.events.MouseEvent;
import flash.events.TimerEvent;
import flash.media.Camera;
import flash.media.Microphone;
import flash.media.Video;
import flash.net.navigateToURL;
import flash.net.NetConnection;
import flash.net.NetStream;
import flash.net.URLLoader;
import flash.net.URLLoaderDataFormat;
import flash.net.URLRequest;
import flash.net.URLRequestMethod;
import flash.net.URLVariables;
import flash.text.TextField;
import flash.utils.setTimeout;
import flash.utils.Timer;
import flash.media.H264Level;
import flash.media.H264Profile;
import flash.media.H264VideoStreamSettings;
/**
 * ...
 * @author Alexander (flash2you) < >
 */
public class Recorder extends MovieClip
{
    private var dataHolder:DataHolder = DataHolder.getInstance()

    public var layer:MovieClip
    public var activityLevel_pb:ProgressBar
    public var aguja:MovieClip
    public var aguja2:MovieClip
    public var publishButton:MovieClip
    public var timer_txt:TextField
    public var recordStatus:MovieClip
    public var recordBtn:MovieClip

    private var netStream:NetStream
    private var microphone:Microphone = Microphone.getMicrophone()
    private var camera:Camera = Camera.getCamera()
    public var  video:Video

    private var timer:Timer = new Timer(100)
    private var clockTimer:Timer = new Timer(1000)

    public var published:Boolean = false

    private var isRecording:Boolean = false

    private var minutero = 0;
    private var crono = 0;
    private var records = 0;

    public var settings_mc:MovieClip
    public static var recorder:Recorder
    public var settings_icon:MovieClip

    private var limitTimer:Timer
    public function Recorder()
    {
        Recorder.recorder = this;

        timer.addEventListener(TimerEvent.TIMER, on$timer)
        clockTimer.addEventListener(TimerEvent.TIMER, on$clockTimer)
        //visible = false

        recordBtn.buttonMode = true
        recordBtn.addEventListener(MouseEvent.CLICK , recordBtn$click)
        recordBtn.addEventListener(MouseEvent.MOUSE_OVER, recordBtn$over)
        recordBtn.addEventListener(MouseEvent.MOUSE_OUT, recordBtn$out)

        addEventListener(Event.ADDED_TO_STAGE, onAddedToStage)

        limitTimer = new Timer(dataHolder.timelimit * 1000);
        limitTimer.addEventListener(TimerEvent.TIMER, onLimitTimerHandler)
    }

    private function onLimitTimerHandler(e:TimerEvent):void
    {
         stopPublish()
    }
    /*
     *  when we comes to second frame
     * */
    private function onAddedToStage(e:Event):void
    {
        removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);

        init()
    }
    /*
     *   function for set up camera from settings module
     * */
    public function setCamera(_camera:Camera) {
        camera = _camera
        addCameraSettings()

        video.attachCamera(camera)

        if (netStream){
            netStream.attachCamera(camera)
        }
    }

    public function setMicrophone(mic:Microphone) {
        microphone = mic;

        if (netStream){
            netStream.attachAudio(microphone)
        }

        addMicSettings()
    }

    private function addMicSettings() {
        microphone.setUseEchoSuppression(true);
        microphone.setSilenceLevel(1)
    }

    private function addCameraSettings():void
    {
        camera.setQuality(90000, 90);
        camera.setMode(320, 240, 30, true);
        camera.setKeyFrameInterval(15);
        //camera.setMode(dataHolder.cameraWidth, dataHolder.cameraHeight, dataHolder.cameraFPS)
        //camera.setQuality(0, dataHolder.cameraQuality)
    }

    public function init() {
        startConnect()
    }
    /*
     *  main function for connection
     * */
    private function startConnect() {
        visible = true

        timer_txt.htmlText = "<b>00:00</b>";

        initCamera()
        initMicropone()
        var nc:NetConnection = new NetConnection()
        nc.connect(null)
        netStream = new NetStream(nc)
        netStream.attachAudio(microphone)

        video.attachCamera(camera)
        layer.visible = false

        publishButton.gotoAndStop(1);

        activityLevel_pb.mode = ProgressBarMode.MANUAL;

        recordStatus.gotoAndStop("noRecord")

        timer.start()

        connection.addEventListener(NetConnector.CONNECTED, connectionComplete)
        connection.startConnection()
    }

    public function get connection():NetConnector {
        return dataHolder.connection
    }

    private function on$timer(e:TimerEvent) {
        activityLevel_pb.setProgress(microphone.activityLevel, 100)
    }
    /*
     *  when connection to your stream server done
     * */
    private function connectionComplete(e:Event = null) {
        netStream = new NetStream(connection)
        netStream.attachAudio(microphone)
        netStream.attachCamera(camera)
    }

    /*
     *   add 0 if less then 10secs
     * */
    private function addLeading(nbr) {
        if (nbr<10) {
            return ("0"+Math.floor(nbr));
        } else {
            return (Math.floor(nbr).toString());
        }
    }

    /*
     *   update visible clock, rotate arrows
     * */
    private function updateTimer() {
        timer_txt.htmlText = "<b>"+addLeading(crono/60)+":"+addLeading(crono%60)+"</b>";
        aguja.rotation = aguja.rotation+6;
        if (addLeading(crono/60)>minutero) {
            aguja2.rotation = aguja2.rotation+6;
            ++minutero;
        }
        // end if
        ++crono;
    }

    private function on$clockTimer(e:TimerEvent):void
    {
        updateTimer()
    }
    private function startClockTimer() {
        clockTimer.start()
    }

    /*
     *  update graphics and start recording
     * */
    private function recordBtn$click(e:MouseEvent):void
    {
        if (!isRecording) {
            startRecording()
            recordStatus.gotoAndStop("record")
            recordBtn.visible = false
        }
    }

    private function recordBtn$over(e:MouseEvent):void
    {
        if (!isRecording) {
            this.gotoAndPlay(65);
        }
    }
    private function recordBtn$out(e:MouseEvent):void
    {
        if (!isRecording) {
            this.gotoAndPlay(61);
        }
    }

    private function startRecording() {
        if (connection.connected){

            var h264Settings:H264VideoStreamSettings = new H264VideoStreamSettings();
            h264Settings.setProfileLevel(H264Profile.BASELINE, H264Level.LEVEL_3_1);

            netStream.videoStreamSettings = h264Settings;

            netStream.publish("mp4:" + dataHolder.filename + ".f4v", "record");

            var metaData:Object = new Object();
            metaData.codec = netStream.videoStreamSettings.codec;
            metaData.profile =  h264Settings.profile;
            metaData.level = h264Settings.level;
            metaData.fps = camera.fps;
            metaData.bandwith = camera.bandwidth;
            metaData.height = camera.height;
            metaData.width = camera.width;
            metaData.keyFrameInterval = camera.keyFrameInterval;
            metaData.copyright = "company";
            netStream.send("@setDataFrame", "onMetaData", metaData);

        }

        isRecording = true
        startClockTimer()

        publishButton.gotoAndPlay(2)
        publishButton.buttonMode = true
        publishButton.addEventListener(MouseEvent.CLICK, publishButton$click);

        limitTimer.start()
    }

    /*
     *  redirect to finishURL that was passed via flashvars
     * */
    private function publishButton$click(e:MouseEvent):void
    {
        stopPublish()

        var request:URLRequest = new URLRequest(dataHolder.finishURL)
        navigateToURL(request, "_self")
    }

    private function stopPublish():void
    {
        netStream.close();
        connection.close();

        limitTimer.stop();
        clockTimer.stop();

        isRecording = false

        recordStatus.gotoAndStop("recordEnd")

        updateTimer();
    }
    /*
     *  init microphone
     * */
    private function initMicropone():void
    {
        microphone = Microphone.getMicrophone()
        addMicSettings()
    }
    /*
     *  init camera
     * */
    private function initCamera():void
    {
        camera = Camera.getCamera()
        addCameraSettings()
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T16:08:16.883

我决定创建一个 php 脚本，该脚本位于包含 FLV 文件的文件夹中。通过 cron 作业，此 php 文件检查 mysql 数据库中进程标签为 1 的新视频。找到新视频了吗？对 FLV 文件执行 ffmpeg 以将其转换为 mp4 并将进程标记设置为 0。这样，我维护了用于桌面浏览器流式传输的 FLV 和用于 iOS 流式传输的 MP4 文件。如果我需要为 android 或任何可能出现的文件创建另一种文件类型，我可以在 cron 作业触发时简单地进行另一个 ffmpeg 转换。

这也将减少服务器上的开销。mp4 由 ffmpeg 编码一次 - 不是每次请求通过 FMS 流式传输文件时。现在 MP4 只是 Web 服务器上的另一个文件。

# android - 无法从 Android 的 Webview 访问 html 文件中存在的 url

> ID：11636429
> 
> 赞同：3
> 
> 时间：2012-07-24T17:47:22.557
> 
> 标签：android, webview, android-webview

我正在尝试使用 shouldOverrideUrlLoading 方法访问 url。出于某种原因，当我尝试访问 html 文件中存在的 url 时，出现 Web page not available 错误。以前我可以访问 url，因为我将 html 文件存储在 raw 文件夹中，但我需要将其移动到 assets文件夹，因为这样代码看起来更干净。这是我的代码，谁能告诉我如何解决这个问题。

```
webview.setWebChromeClient(new WebChromeClient());
webview.setWebViewClient(new WebViewClient());
webview.loadUrl("file:///android_asset/myfile/file.html");
webview.setVerticalScrollBarEnabled(false);
webview.setWebViewClient(new WebViewClient()
{
    public boolean shouldOverrideUrlLoading(WebView view, String url) {

        if (url.equalsIgnoreCase("some text")){
            setDialog("some fancy text");
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-01T10:12:31.290

* * *

# 尝试先获取`Real Path`文件，然后按照您的方式尝试：

* * *

```
String YourURI="/android_asset/myfile/file.html";
YourURI = new File(getRealPathFromURI(YourURI));

//Got the Real Path Of the File

private String getRealPathFromURI(Uri contentURI) {
  Cursor cursor = getContentResolver().query(contentURI, null, null, null, null); 
  cursor.moveToFirst(); 
  int idx = cursor.getColumnIndex(MediaStore.Images.ImageColumns.DATA); 
  return cursor.getString(idx); 
}

webview.setWebChromeClient(new WebChromeClient());
webview.setWebViewClient(new WebViewClient());
webview.loadUrl(YourURI);                      //**Used the Real Path**
webview.setVerticalScrollBarEnabled(false);
webview.setWebViewClient(new WebViewClient()
{
    public boolean shouldOverrideUrlLoading(WebView view, String url) {

        if (url.equalsIgnoreCase("some text")){
            setDialog("some fancy text");
        }
} 
```

* * *

# 如果文件在 SDCARD 中：-

* * *

```
webview.setWebChromeClient(new WebChromeClient());
webview.setWebViewClient(new WebViewClient());
if (!Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED))
{
  Log.d(TAG, "No SDCARD");
} 
else 
{
  webview.loadUrl("file://"+Environment.getExternalStorageDirectory()
                                   +"/android_asset/myfile/file.html");
}
webview.setVerticalScrollBarEnabled(false);
webview.setWebViewClient(new WebViewClient()
{
    public boolean shouldOverrideUrlLoading(WebView view, String url) {

        if (url.equalsIgnoreCase("some text")){
            setDialog("some fancy text");
        }
} 
```

* * *

# 最终编辑：- 此代码非常适用于资产文件夹

* * *

```
public class MyActivity extends Activity {  
    @Override  
    public void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);
        setContentView(R.layout.webview);  
        WebView webview;  
        webview = (WebView) findViewById(R.id.webView1);  
        webview.loadUrl("file:///android_asset/myfile/file.html");
    }  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T04:49:18.513

还有另一种方法也适合你——

```
webView.loadData(customHtml, "text/html", "UTF-8"); 
```

其中 custromHtml 是用于显示的 HTML 行。

在“custromHtml”的地方，你只需传递“file://android_asset/myfile/file.html”。

我认为这应该有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-01T04:59:48.727

你也可以试试这个——

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        String myURL = "file:///android_asset/index.html";
        myBrowser=(WebView)findViewById(R.id.mybrowser);

        /*By default Javascript is turned off,
         * it can be enabled by this line.
         */
        myBrowser.getSettings().setJavaScriptEnabled(true);
        myBrowser.setWebViewClient(new WebViewClient());

        myBrowser.loadUrl(myURL);

    } 
```

*并检查您是否已将文件放置在主项目的正确文件夹中。如果一切正常，请创建一个干净的项目并修复项目。然后尝试运行它。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T10:07:40.767

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        String myURL = "file:///android_asset/index.html";
        myBrowser=(WebView)findViewById(R.id.mybrowser);
        myBrowser.getSettings().setJavaScriptEnabled(true);
        myBrowser.setWebViewClient(new WebViewClient());

        myBrowser.loadUrl(myURL);

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T06:10:14.477

shouldOverrideUrlLoading 不适用于文件：// 的 ICS，但适用于外部 url。loadURL 可以很好地从资产文件夹加载。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    WebView web=(WebView)findViewById(R.id.webView1);

    web.setWebViewClient(new MyWebClient());
    //web.loadUrl("file:///android_asset/index.html");
    web.loadUrl("http://google.com"); 
```

......

```
class MyWebClient extends WebViewClient
{
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        Log.d("MyWebClient", "url is: " + url);

        if (url.equalsIgnoreCase("google.com")){
            Log.d("MyWebClient","url is: " + url);
        }
        return false;
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-01T04:50:44.137

这会很好用，试试吧-----

```
"android.resource://[package]/[res type]/[res name]"

Uri path = Uri.parse("android.resource://com.androidbook.samplevideo/raw/myvideo"); 
```

这个链接也很有用——

[http://developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

[将 Android 资源加载到 WebView](https://stackoverflow.com/questions/4855008/loading-an-android-resource-into-a-webview)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-11T00:55:20.683

我发现这个论坛解决方案为我解决了这个问题：[http ://www.cynosurex.com/Forums/DisplayComments.php?file=Java/Android/Android_4_has_a_.file....android_asset.webkit.._bug](http://www.cynosurex.com/Forums/DisplayComments.php?file=Java/Android/Android_4_has_a_.file....android_asset.webkit.._bug)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-30T04:45:15.657

我想你应该试试这个....

```
webview.setWebChromeClient(new WebChromeClient());
webview.setWebViewClient(new WebViewClient());
webview.loadUrl("file://android_asset/myfile/file.html");
webview.setVerticalScrollBarEnabled(false);
webview.setWebViewClient(new WebViewClient()
{
    public boolean shouldOverrideUrlLoading(WebView view, String url) {

        if (url.equalsIgnoreCase("some text")){
            setDialog("some fancy text");
        } 
```

# javascript - Javascript 变量 - Getter 问题

> ID：11636431
> 
> 赞同：1
> 
> 时间：2012-07-24T17:47:31.640
> 
> 标签：javascript, variables, private, getter

我想出了以下情况：

```
function Dog () {
    "use strict";
    this.age = 1;
    var name = "Fido";
    this.getName = function () { return name; }
} 
```

现在我正在创建“Dog”类的一个新实例并打印变量的值。

```
var d = new Dog;
document.write('<strong>Dog age:</strong> ' +d.age); \\Outputs "1" as expected
document.write('<br/>');
document.write('<strong>Dog name:</strong> ' +d.name); \\Outputs "undefined" as expected, 'cause it's a private variable.
document.write('<br/>');
document.write('<strong>Get Dog name:</strong> ' +d.getName()); \\Outputs "Fido", as expected. 
```

但是假设我想改变狗的名字，像这样：

```
d.name = "Stinky";
document.write('<br/>');
document.write('<strong>Dog name Again:</strong> ' +d.name); 
document.write('<br/>');
document.write('<strong>Get Dog name Again:</strong> ' +d.getName()); 
```

基于此，我有几个问题：

1.  为什么“d.name”没有向我显示“未定义”？“名称”不是私有变量吗？我想你不能改变私有变量的值，对吗？我想知道这个过程是否创建了一个新变量，但这次是一个公共变量，并且具有相同的名称。如果是这样，有没有办法防止每次我尝试分配具有相同名称的新属性时创建新变量？有没有办法抛出“类型错误”或其他东西（嗯，这是我所期望的）。
2.  最后：为什么“getName”会打印原始值“Fido”，即使我为它分配了一个新值？

有任何想法吗？

这是一个让事情变得更容易的fid。

[http://fiddle.jshell.net/yZpfg/2/](http://fiddle.jshell.net/yZpfg/2/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T17:51:19.253

`d.name = "Stinky";`正在向`d`对象添加一个新的（公共）属性，即`instanceOf Dog`.

getter 仍然使用 value 引用（私有）变量`Fido`。

如果您想允许消费者更改私有变量，您还需要一个 setter：

```
function Dog () {
    "use strict";
    this.age = 1;
    var name = "Fido";
    this.getName = function () { return name; }
    this.setName = function (value) { name = value; }
}

var d = new Dog(); 
d.name; // undefined because there is no name public property
d.getName() // returns the internal private, "Fido"
d.setName('Stinky'); // the internal private is now "Stinky" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:53:03.740

您将局部变量与实例属性混淆了。这些是完全分开的。

1）您设置`d.name`，一个实例属性，这是您正在调用的，而不是私有变量。

2) Fido 是私有 var 的 valeu，这是你的方法返回的，而不是实例属性，所以方法总是会说 Fido。

您的原始代码应该如下所示：

```
function Dog () {
    "use strict";
    this.age = 1;
    this.name = "Fido";
}
Dog.prototype.getName = function() { return this.name; } 
```

请注意，我将方法添加到原型中，而不是显式地将其添加到每个实例中。这样，实例就会继承它。这是更好的做法；可重用的代码应该在原型上，并且它比每次都将其添加到每个实例中性能更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:53:40.090

`var name`在您的构造函数中，`someObj.name`并且永远不会是同一件事。2 个不同的值可以设置为 2 个不同的东西。相反，您需要一个像 getter 一样工作的 setter 函数：

```
this.setName = function(newName) { name = newName; }; 
```

设置与私有变量同名的属性时，无法引发错误。它们是两个完全不同的东西，当设置了一个你甚至可以拦截的属性时没有回调。

# java - 最佳 100% 纯 Java 媒体框架

> ID：11636444
> 
> 赞同：1
> 
> 时间：2012-07-24T17:48:00.363
> 
> 标签：java, media

我正在寻找一个主要用于播放的纯 Java 媒体框架。支持的格式应该是（至少）wav、midi，也许还有 ogg vorbis。理想情况下，它还支持更高级的功能，如音量控制、混音等。你能推荐一些能满足这些要求的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:51:07.460

[JMF（Java 媒体框架）](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-140239.html)呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:50:24.930

我曾经使用标准的[JMF](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-140239.html)，发现它工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:10:59.870

使用媒体的 java[教程](http://docs.oracle.com/javase/tutorial/sound/index.html)。[JMF](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-140239.html)特点：

*   音频文件格式：AIFF、AU 和 WAV
*   音乐文件格式：MIDI Type 0、MIDI Type 1 和 Rich Music Format (RMF)
*   声音格式：8 位和 16 位音频数据，单声道和立体声，采样率从 8 kHz 到 48 kHz
*   任何受支持的音频文件格式的线性、a-law 和 mu-law 编码数据
*   软件中的 MIDI 波表合成和排序，以及访问硬件 MIDI 设备
*   一个全软件混音器，可以混合和渲染多达 64 个数字音频和合成 MIDI 音乐的通道

[在这里](http://docs.oracle.com/javase/7/docs/technotes/guides/sound/)检查。

# c# - 将 id 值传递给 gridview 控件中的 LinkBut ton 服务器端事件

> ID：11636449
> 
> 赞同：5
> 
> 时间：2012-07-24T17:48:13.617
> 
> 标签：c#, asp.net, gridview, linkbutton

我正在尝试将 CustomerID 值从我的 gridview 控件中的 LinkBut​​ton 传递给代码隐藏。我尝试了[这里](https://stackoverflow.com/questions/6614803/passing-control-id-from-linkbutton-in-a-gridview)建议的解决方案，但它不起作用。

我的gridview代码是：

```
<asp:TemplateField HeaderText="Last Name, First Name">
    <ItemTemplate>
        <asp:LinkButton OnClick="EditCustomer" id="lbtnCustomerName" CommandName="CustomerName" Visible="true" runat="server" ToolTip="Click to edit customer."><%# DataBinder.Eval(Container.DataItem, "custLastName") + ", " + DataBinder.Eval(Container.DataItem, "custFirstName" + ", " + DataBinder.Eval(Container.DataItem, "custID")%></asp:LinkButton>
    </ItemTemplate>
</asp:TemplateField>

protected void EditCustomer(Object sender, EventArgs e)
{

} 
```

如何在 EditCustomer 事件中获取 custID 值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T17:52:19.667

你可以通过`CustomerID`as [`CommandArgument`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx)：

```
<asp:LinkButton OnClick="EditCustomer" id="lbtnCustomerName" 
     CommandArgument='<%#Eval("CustomerID")%>'
     CommandName="CustomerName"
     OnCommand="LinkButton_Command"
     Visible="true" runat="server"
     ToolTip="Click to edit customer."><%# DataBinder.Eval(Container.DataItem, "custLastName") + ", " + DataBinder.Eval(Container.DataItem, "custFirstName" + ", " + DataBinder.Eval(Container.DataItem, "custID")%>
</asp:LinkButton> 
```

现在您可以处理 LinkBut​​ton 的[`Command`事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.command)：

```
void LinkButton_Command(Object sender, CommandEventArgs e) 
{
   String CustomerID = e.CommandArgument.ToString();
} 
```

# ruby-on-rails - 使用 Ruby on Rails 显示对象

> ID：11636451
> 
> 赞同：1
> 
> 时间：2012-07-24T17:48:19.423
> 
> 标签：ruby-on-rails, ruby, json

我有一些看起来像这样的 JSON。我将它存储并读入一个对象@items。

```
[
 {
  {
    "id": "A",
    "description": "a_description"
  }, 
  {
    "id": "B",
    "description": "b_description"
  }
 }, 
 {
  {
    "id": "A",
    "description": "a_description"
  }, 
  {
    "id": "B",
    "description": "b_description"
  }
 }
] 
```

我的目标是显示一个包含两列的表，一列标记为 A，另一列标记为 B，其中每一行给出“a_description”和“b_description”。我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:54:31.603

像这样的东西也许

```
<tr><th>A</th><th>B</th></tr>
<% @items.each do |item| %>
  <tr><td><%=item[0].description%></td><td><%=item[1].description%></td></tr>
<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T19:28:21.980

啊，哈希数组和数组哈希问题。

要解决您的“乱序”问题，您首先必须转换

```
{
  "id": "A",
  "description": "foo"
},
{
  "id": "B",
  "description": "bar"
} 
```

进入`{"A" : "foo", "B" : "bar" }`.

```
@new_items = @items.map do |item|
  output = {}
  item.each do |hash|
    output.merge!(hash["id"] => hash["description"])
  end
end 
```

然后`@new_items`变成（故意乱序呈现，因为散列元素没有排序）

```
[
  { 
    "A": "a1_description",
    "B": "b1_description"
  },
  { 
    "B": "b2_description",
    "A": "a2_description"
  }
] 
```

从那里开始，每一行只是一个哈希，因此您可以根据您所在的列取消引用您需要的值。

```
@new_items.each do |item|
  puts "#{item['A']} is paired with #{item['B']}"
end 
```

如果您不想使用硬编码“A”和“B”，当然可以动态检索密钥`.keys`

# jquery - JqPlot 1.0 如何创建带有日期轴和图例的折线图

> ID：11636452
> 
> 赞同：3
> 
> 时间：2012-07-24T17:48:21.600
> 
> 标签：jquery, date, jqplot, legend

首先，提前感谢您的回答。

这是我的问题。我有一个带有 JqPlot 的线性图表，我需要显示图例，但我不知道如何更改系列名称。我们如何做到这一点？

这是我的代码。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery.jqplot.min.js"></script>
<script type="text/javascript" src="plugins/jqplot.dateAxisRenderer.min.js"></script>
<link rel="stylesheet" type="text/css" href="jquery.jqplot.css" />

<script type="text/javascript" language="javascript">
$(document).ready(function(){
  var line1=[['2008-06-30',4], ['2008-7-14',6.5], ['2008-7-28',5.7], ['2008-8-11',9],     ['2008-8-25',8.2]];
  var line2=[['2008-06-30',8], ['2008-7-14',5], ['2008-7-28',7], ['2008-8-11',2],     ['2008-8-25',2]];
  var plot2 = $.jqplot('conteneur', [line1,line2], {
      title:'Customized Date Axis', 
      seriesDefaults: {
            rendererOptions: {
                //////
                // Turn on line smoothing.  By default, a constrained cubic spline
                // interpolation algorithm is used which will not overshoot or
                // undershoot any data points.
                //////
                smooth: true
            }
        },
            legend:{ show: true } ,
      axes:{
        xaxis:{
          renderer:$.jqplot.DateAxisRenderer, 
          tickOptions:{formatString:'%b %#d, %#I %p'},
          min:'June 16, 2008', 
              tickInterval:'1 month'
        }
      },
      series:[{lineWidth:4, markerOptions:{style:'square'}}]
  });
});
</script>

</head>
<body>

<div id="conteneur"></div>

</body>
</html> 
```

我真正想做的是，在传说中，“系列 1”和“系列 2”以其系列名称命名（例如：“克利夫兰”和“多伦多”）。但是我应该把它放在代码的什么地方呢？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T19:01:40.467

您应该添加：

```
series: [
                { label: 'Toronto' },
                { label: 'New York' }
        ] 
```

这是完整的代码：

```
<script type="text/javascript" language="javascript">
$(document).ready(function () {
    var line1 = [['2008-06-30', 4], ['2008-7-14', 6.5], ['2008-7-28', 5.7], ['2008-8-11', 9], ['2008-8-25', 8.2]];
    var line2 = [['2008-06-30', 8], ['2008-7-14', 5], ['2008-7-28', 7], ['2008-8-11', 2], ['2008-8-25', 2]];
    var plot2 = $.jqplot('conteneur', [line1, line2], {
        title: 'Customized Date Axis',
        seriesDefaults: {
            rendererOptions: {
                //////
                // Turn on line smoothing.  By default, a constrained cubic spline
                // interpolation algorithm is used which will not overshoot or
                // undershoot any data points.
                //////
                smooth: true
            }
        },
        legend: { show: true },
        axes: {
            xaxis: {
                renderer: $.jqplot.DateAxisRenderer,
                tickOptions: { formatString: '%b %#d, %#I %p' },
                min: 'June 16, 2008',
                tickInterval: '1 month'
            }
        },
        series: [{ lineWidth: 4,
            markerOptions: { style: 'square' }

        }],
        series: [
                { label: 'Toronto' },
                { label: 'New York' }
        ],
    });
}); 
```

# javascript - Rally App SDK 2.0：引用 /apps/2.0p3/sdk.js 时无法加载 Rally.ui.cardboard.ArtifactCard

> ID：11636459
> 
> 赞同：0
> 
> 时间：2012-07-24T17:48:52.500
> 
> 标签：javascript, extjs, extjs4, rally

此项目无法加载，因为它依赖于 Ext.Loader：[https ://rally1.rallydev.com/slm/panel/Rally/ui/cardboard/ArtifactCard.js?_dc=1343151803942](https://rally1.rallydev.com/slm/panel/Rally/ui/cardboard/ArtifactCard.js?_dc=1343151803942)

我用过

```
Ext.Loader.setConfig({ enabled: true }); 
```

来解决这个问题。但是，ArtifactCard.js 仍然无法加载。任何洞察这是为什么？不应该使用 preview 3 脚本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:19:26.117

我相信 ArtifactCard 类已被删除，只支持使用 Rally.ui.cardboard.Card 类。2.0p3 API 文档可以在这里找到：[https ://rally1.rallydev.com/apps/2.0p3/doc/#!/api/Rally.ui.cardboard.Card](https://rally1.rallydev.com/apps/2.0p3/doc/#!/api/Rally.ui.cardboard.Card)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T16:09:14.103

第二个预览只是一个当前是静态的。在这一点上，预览 3 最好是作为金丝雀或不断变化的版本。

在下一个预览版中有些东西会有所不同，尤其是升级到 Ext 4.1

# ios - 持续检查数据（方法） iOS

> ID：11636461
> 
> 赞同：0
> 
> 时间：2012-07-24T17:49:05.443
> 
> 标签：ios, cocoa-touch, continuous

有没有什么方法（比如——viewDidLoad）可以连续执行一部分代码？我需要能够连续检查远程服务器上的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:51:06.907

这样做的方法是设置一个 NSTimer。

```
-(void)startCheckingValue
{
    mainTimer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(checkValue:) userInfo:nil repeats:YES];
    [[NSRunLoop mainRunLoop] addTimer:mainTimer forMode:NSDefaultRunLoopMode];
}

-(void)checkValue:(NSTimer *)mainTimer
{
    //Placeholder Function, this is where you write the code to check your value on the remote server
} 
```

timerWithTimeInterval 函数是您感兴趣的函数，正如您在上面看到的，您需要传递它的主要内容是它将执行您传递它的选择器的函数的时间间隔。时间间隔以秒为单位，因此当前设置为每秒检查一次，这可能太快了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:51:27.827

使用 NSTimer 每 x 秒执行一次相同的代码块。但是，我认为这不是您想要的，因为它会给服务器带来很多额外的负载并且您可能会被禁止，所以可能有更好的方法。

[苹果关于 NSTimer 使用的页面](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Timers/Articles/usingTimers.html#//apple_ref/doc/uid/20000807-CJBJCBDE)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-24T17:59:45.823

你需要使用[NSTimer](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Timers/Articles/usingTimers.html#//apple_ref/doc/uid/20000807-CJBJCBDE)为此：

在您的界面中声明一个`NSTimer`对象，例如：

```
NSTimer *timer; 
```

在您的 .m`viewDidLoad`方法中添加以下行。

```
timer = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(timerFireMethod:) userInfo:nil repeats:YES]; 
```

在该`timerFireMethod`方法中，您需要执行服务器调用和其他操作。

# java - 协议不支持 java.net.scoket 异常地址

> ID：11636467
> 
> 赞同：0
> 
> 时间：2012-07-24T17:49:16.843
> 
> 标签：java, android, rabbitmq

安卓代码

```
 public class androidconn extends Activity {
    private rabbitmqclient mConsumer;
    private TextView mOutput;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.conn);

        //The output TextView we'll use to display messages
        mOutput =  (TextView) findViewById(R.id.moutput);

        //Create the consumer
        mConsumer = new rabbitmqclient("10.0.2.2:5672",
                "logs",
                "fanout");

        //Connect to broker
        mConsumer.connectToRabbitMQ();

        //register for messages
        mConsumer.setOnReceiveMessageHandler(new OnReceiveMessageHandler(){

            public void onReceiveMessage(byte[] message) {
                String text = "";
                try {
                    text = new String(message, "UTF");
                } catch (UnsupportedEncodingException e) {
                    e.printStackTrace();
                }

                mOutput.append("\n"+text);
            }
        });

    }

    @Override
    protected void onResume() {
        super.onPause();
        mConsumer.connectToRabbitMQ();
    }

    @Override
    protected void onPause() {
        super.onPause();
        mConsumer.dispose();
    }
} 
```

兔子MQ代码

```
 public abstract class rabbitmq {
      public String mServer;
      public String mExchange;

      protected com.rabbitmq.client.Channel mModel = null;
      protected Connection  mConnection;

      protected boolean Running ;

      protected  String MyExchangeType ;

      /**
       *
       * @param server The server address
       * @param exchange The named exchange
       * @param exchangeType The exchange type name
     * @return 
       */
      public  rabbitmq(String server, String exchange, String exchangeType)
      {
          mServer = server;
          mExchange = exchange;
          MyExchangeType = exchangeType;
      }

      public void Dispose() throws SQLException
      {
          Running = false;

            try {
                if (mConnection!=null)
                    mConnection.close();
                if (mModel != null)
                      mModel.close();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

      }

      /**          * Connect to the broker and create the exchange
       * @return success
       */
      public boolean connectToRabbitMQ()
      {
          if(mModel!= null && mModel.isOpen() )//already declared
              return true;
          try
          {
              ConnectionFactory connectionFactory = new ConnectionFactory();
              connectionFactory.setHost(mServer);
              connectionFactory.setPort(5672);

            mConnection = (Connection) connectionFactory.newConnection();
              mModel = ((com.rabbitmq.client.Connection) mConnection).createChannel();
              mModel.exchangeDeclare(mExchange, MyExchangeType, true);

              return true;
          }
          catch (Exception e)
          {
              e.printStackTrace();
              return false;
          }
  }
} 
```

rabbitmq客户端代码

```
 public class rabbitmqclient extends  rabbitmq{

    public rabbitmqclient(  
 String server,String exchange,String exchangeType) {

        super(server,exchange,exchangeType);
  }

    //The Queue name for this consumer
    private String mQueue;
    private QueueingConsumer MySubscription;

    //last message to post back
    private byte[] mLastMessage;

    // An interface to be implemented by an object that is interested in messages(listener)
     public interface OnReceiveMessageHandler{
         public void onReceiveMessage(byte[] message);
    };

    //A reference to the listener, we can only have one at a time(for now)
     private OnReceiveMessageHandler mOnReceiveMessageHandler;

    /**
     *
     * Set the callback for received messages
     * @param handler The callback
     */     public void setOnReceiveMessageHandler(OnReceiveMessageHandler handler)
 {
        mOnReceiveMessageHandler = handler;
    };

    private Handler mMessageHandler = new Handler();
    private Handler mConsumeHandler = new Handler();

    // Create runnable for posting back to main thread
    final Runnable mReturnMessage = new Runnable() {
        public void run() {
            mOnReceiveMessageHandler.onReceiveMessage(mLastMessage);
        }
    };

    final Runnable mConsumeRunner = new Runnable() {
        public void run() {
            Consume();
        }
    };

    /**
     * Create Exchange and then start consuming. A binding needs to be added before any messages will be delivered
 */
    @Override
    public boolean connectToRabbitMQ()
    {
       if(super.connectToRabbitMQ())
       {

           try {
               mQueue =  mModel.queueDeclare().getQueue();
               MySubscription = new QueueingConsumer(mModel);
               mModel.basicConsume(mQueue, false, MySubscription);
            } catch (IOException e) {
                e.printStackTrace();
                return false;
            }
             if (MyExchangeType == "fanout")
                   AddBinding("");//fanout has default binding

            Running = true;
            mConsumeHandler.post(mConsumeRunner);

           return true;
       }
       return false;
    }

    /**
     * Add a binding between this consumers Queue and the Exchange with routingKey
     * @param routingKey the binding key eg GOOG
     */
    public void AddBinding(String routingKey)
    {
        try {
            mModel.queueBind(mQueue, mExchange, routingKey);
    } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    /**
     * Remove binding between this consumers Queue and the Exchange with routingKey
     * @param routingKey the binding key eg GOOG
     */
    public void RemoveBinding(String routingKey)
    {
        try {
            mModel.queueUnbind(mQueue, mExchange, routingKey);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    private void Consume()
    {
        Thread thread = new Thread()
        {

             @Override
                public void run() {
                 while(Running){
                    QueueingConsumer.Delivery delivery;
                    try {                           
 delivery = MySubscription.nextDelivery();
                    mLastMessage = delivery.getBody();
                        mMessageHandler.post(mReturnMessage);
                        try {
                                     mModel.basicAck(delivery.getEnvelope().getDeliveryTag(), false);
                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                    } catch (InterruptedException ie) {
                        ie.printStackTrace();
                    }
                 }
             }
             };
        thread.start();

    }

    public void dispose(){
        Running = false;
    }
} 
```

并且 logcat 是 07-24 22:57:45.412: D/SntpClient(59): request time failed: java.net.SocketException: Address family not supported by protocol 请告诉我错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:54:35.640

确保rabbitmq 服务器没有阻塞连接并且提供的连接信息是正确的。您也可以将其添加到 android 清单文件中：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

捕获 SocketException 并确保您可以连接到目标 IP 地址/端口号。

# sql - 在列表中显示重复数据

> ID：11636468
> 
> 赞同：0
> 
> 时间：2012-07-24T17:49:18.870
> 
> 标签：sql, sql-server-2008, tsql

目标：
显示重复数据，在表格​​测试中，应删除。
但是，如果有两个重复数据，例如“3412 New York”。测试表中应仅显示 1 行。

问题：
不知道怎么做。请记住，此表可以是一百万行。

```
All data from the list

table testing
Region          Category    Energy
----------------------------------
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
3125 New Jersey drink       4
3125 New Jersey drink       4
3125 New Jersey drink       4
3125 New Jersey drink       4
3125 New Jersey drink       4
3412 New York   food        3
3412 New York   food        3
3412 Washington coke        7
3412 california chips       20
3412 california chips       20
3412 california chips       20
3412 california chips       20

Requested result that should display data in table testing
Table testing
Region          Category    Energy
----------------------------------
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
1235 Delaware   candy       5
3125 New Jersey drink       4
3125 New Jersey drink       4
3125 New Jersey drink       4
3125 New Jersey drink       4
3412 New York   food        3
3412 california chips       20
3412 california chips       20
3412 california chips       20 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:53:08.887

查看结果

```
SELECT
    Region, Category, Energy
FROM
    (
    SELECT
       Region, Category, Energy,
       ROW_NUMBER() OVER (PARTITION BY Region, Category, Energy ORDER BY Region) AS rn
    FROm
       MyTable
    ) X
WHERE
   X.rn > 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:40:18.003

因为您没有主键，所以您可以使用 group by 或 distinct 重新生成表：

```
select distinct Region, Category, Energy
into newt
from t 
```

这将使您不必识别重复项，然后再次弄清楚如何删除这些行。

# javascript - 如何从 javascript 更改密码字段的文本？

> ID：11636469
> 
> 赞同：0
> 
> 时间：2012-07-24T17:49:27.500
> 
> 标签：javascript, google-chrome-extension, passwords, forms

我有一个 chrome 扩展，我想通过在页面上运行外部 javascript 来自动填写用户已经输入的信息（进入我的应用程序）的用户名和密码字段。我想出了如何填写用户名，但我不知道如何自动选中复选框或填写密码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:56:36.110

如果没有 jQuery，可以执行以下操作：

```
document.getElementById( "password" ).value = "Value";
document.getElementById( "checkbox" ).checked = true; 
```

当然换成`"password"`密码输入框的ID，和`"checkbox"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:50:58.507

如果你使用 jQuery，你可以这样做：

```
$('#password').val('whateveryouwant');
$('#checkbox').attr('checked','checked'); 
```

# ruby - 为什么 ActiveRecord::Base.execute_query 在第 20 行之后停止返回所有结果？

> ID：11636470
> 
> 赞同：0
> 
> 时间：2012-07-24T17:49:29.497
> 
> 标签：ruby, oracle, activerecord

我正在开发一个测试套件，该套件需要我从 Oracle 数据库中提取数据。我正在使用一个已经编写好的查询，因为它比设置所有活动记录对象更容易。我没有使用rails，而是使用gem activerecord 3.2.6。

我突然发现返回的14列数据，从第21行开始，实际上只有12列有数据。在 Oracle SQL Developer 中使用时，此查询返回超过 20 行的完整数据，所以我知道这不是查询。

是不是我需要给它更多时间来完成返回所有数据？这似乎不太可能，因为第一个问题总是第 21 行。某些数据可能为 NULL 并且一旦发现第一个 NULL 活动记录就搞砸了，这是一个问题吗？

我真的不知道在这里做什么，我唯一能想到的尝试就是安装不同版本的 activerecord，并希望其中一个能正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:37:35.087

> **“这似乎不太可能，因为总是第 21 排最先出现问题。”** 某些数据可能为 NULL 并且一旦发现第一个 NULL 活动记录就搞砸了，这是一个问题吗？

也许您可以尝试使其中一行 < 21（例如第 8 行）有一些 NULL 数据，然后查看查询是否阻塞？

# c++ - strcpy System.AccessViolationException

> ID：11636471
> 
> 赞同：0
> 
> 时间：2012-07-24T17:49:36.270
> 
> 标签：c++, c++-cli

当我到达 strcpy 行时，我得到

```
An unhandled exception of type 'System.AccessViolationException' occurred. 
Additional information: Attempted to read or write protected memory. 
This is often an indication that other memory is corrupt.

char* str; char* out;
str = (char*) Marshal::StringToHGlobalAnsi(Parms["AVI"]).ToPointer();  
strcpy(out, str);  
Marshal::FreeHGlobal(IntPtr(str)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:52:35.760

您需要分配内存并指向`out`该内存。就像现在一样，`out`指向一些随机内存位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:00:17.740

设置 str 之后，但在将其复制到 out 之前：

```
char* out = (char*)malloc((strlen(str) + 1) * sizeof(char));

if (out != NULL) {
    strcpy(out, str);
} 
```

因为您需要某种缓冲区来复制。完成后一定要释放（out）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:14:22.873

[如何在 Visual C++ 中从 System::String* 转换为 Char*](http://support.microsoft.com/kb/311259)

“方法3”看起来很简单。无需手动释放内存。

# java - 如何在 Scala 中扩展通用 Java 类？

> ID：11636479
> 
> 赞同：1
> 
> 时间：2012-07-24T17:50:04.863
> 
> 标签：java, scala, javafx-2

我有 Scala 类，我想扩展 JavaFX 的通用类之一来创建我的自定义控件

```
public abstract class SkinBase <C extends Control, B extends BehaviorBase <C>> 
                               extends StackPane 
                               implements Skin <C> 
```

但我不能。例子：

```
import javafx.scene.control.Control

class MyControl extends Control {

}

import com.sun.javafx.scene.control.skin.SkinBase

class MyControlSkin extends SkinBase[MyControl,MyControlBehavior] {

}

import com.sun.javafx.scene.control.behavior.BehaviorBase

class MyControlBehavior extends BehaviorBase[MyControl] {

} 
```

有什么建议我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T20:41:29.000

这对我有用：

```
class MyControlBehavior(myControl: MyControl) extends BehaviorBase[MyControl](myControl) 
```

# jquery - 提交表单时不会触发通过代码进行的jquery ui更新

> ID：11636480
> 
> 赞同：0
> 
> 时间：2012-07-24T17:50:12.390
> 
> 标签：jquery, forms, html, submit, loading

我有一个加载 div，显示在对服务器的不同调用之间。这是代码：

```
$("#submitButton").click(function () {
        $("#loadingDiv").show();
        $(this).attr("disabled", "disabled");
        $("form:first").submit();                        
    }); 
```

如果我注释掉提交表单的第三行代码，一切都会很好。但是当我将提交表单的代码放在这些 ui 更新调用旁边时，它们都没有生效，并且浏览器等待光标显示，直到显示表单提交的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:57:37.047

您需要添加`preventDefault()`以防止发生默认提交。正如您所拥有的，在任何点击处理程序代码可以运行之前提交表单。

```
$("#submitButton").click(function (e) { // note event object passed in
    e.preventDefault(); // add this
    $("#loadingDiv").show();
    $(this).attr("disabled", "disabled");
    $("form:first").submit();                        
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:55:34.393

当您提交表单时，页面将被重新加载或重定向到另一个地方，我猜您想使用 AJAX，如果是这种情况，您可能想查看`ajax()`或`post()`使用方法并使用它们而不是提交表单。

# c# - 将服务引用添加到 .cs 文件

> ID：11636483
> 
> 赞同：0
> 
> 时间：2012-07-24T17:50:27.337
> 
> 标签：c#, asp.net, oracle, service, reference

我有一个通用的 .cs 类文件，用于不同程序之间的通用任务。我最近开始使用服务参考，该参考适用于我的代码中的其他 .aspx.cs 文件，但不适用于我的 .cs 文件。

它说每当我尝试将代码添加到我的 .cs 文件时，我都缺少参考。

我将如何将此服务参考放入我的班级？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:04:11.677

您需要将服务引用添加到您的项目中。一旦有了新的引用，您就可以使用添加的命名空间中的客户端来调用服务。

# java - 看到 Java 程序运行时变量的值发生了变化吗？

> ID：11636485
> 
> 赞同：0
> 
> 时间：2012-07-24T17:50:34.420
> 
> 标签：java, variables, report

考虑一个带有许多变量的 java 程序，其中一些是循环计数器

为什么 ？我认为它可以帮助我轻松调试。

```
Example-
int a = 7;  
for(i=0; i<3; i++)
{
  a++;
} 
```

当这个程序运行时，我想得到这样的实时报告：

```
t is 0, a is 7, i is 0
t is 3, a is 8, i is 1
t is 12, a is 9, i is 2
(t is time, time factor is NOT necessary though) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:52:28.030

您可以使用调试器。调试器将帮助您跟踪这一点，而无需实际将您的变量发送到 STDOUT。我推荐 DDD，因为它是免费且专业使用的。[http://www.gnu.org/software/ddd/](http://www.gnu.org/software/ddd/)

注意：为了避免混淆它的工作原理，DDD 在 JDB 之上工作，JDB 是 JDK 中包含的 Java 调试器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:53:56.617

您应该使用调试器并在要查看值的位置放置一个断点（在本例中位于带有 a++ 的行）。您可以在每次迭代中看到该值。

大多数 IDE 都有调试器（Intellij IDEA、Eclipse 或 NetBeans）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:54:17.337

这就是调试器的用途……单步执行您的代码并检查变量的值。如果您希望您的代码每隔一段时间打印出语句，您可以使用`Timer`该类并`TimerTask`在指定的时间间隔内打印出变量的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:08:22.657

**1.**使用`Debugger`，如果您使用的是 Eclipse、IntelliJ 之类的 IDE，则将其内置到其中。

**2.**如果你没有使用任何调试器，那么你可以使用`jdb` **The Java Debugger**。有关`JPDA`调试器架构规范，请参阅。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T21:34:18.457

如果我没记错的话，Eclipse 不支持这一点，但是在 Intellij IDEA 中，您可以设置断点，这种方式在命中时不会停止应用程序运行，而是评估并记录您指定的特定表达式。使用 ms visual studio 的用户可以使用相同的功能:)

# c# - C# - 为什么我不能将 using 语句中声明的类作为引用类型传递？

> ID：11636489
> 
> 赞同：19
> 
> 时间：2012-07-24T17:50:53.383
> 
> 标签：c#

假设我有以下一次性类和示例代码来运行它：

```
public class DisposableInt : IDisposable
{
    private int? _Value;

    public int? MyInt
    {
        get { return _Value; }
        set { _Value = value; }
    }

    public DisposableInt(int InitialValue)
    {
        _Value = InitialValue;
    }

    public void Dispose()
    {
        _Value = null;
    }
}

public class TestAnInt
{
    private void AddOne(ref DisposableInt IntVal)
    {
        IntVal.MyInt++;
    }

    public void TestIt()
    {
        DisposableInt TheInt;
        using (TheInt = new DisposableInt(1))
        {
            Console.WriteLine(String.Format("Int Value: {0}", TheInt.MyInt));
            AddOne(ref TheInt);
            Console.WriteLine(String.Format("Int Value + 1: {0}", TheInt.MyInt));
        }
    }
} 
```

调用`new TestAnInt().TestIt()`运行得很好。但是，如果我更改`TestIt()`，`DisposableInt`则在 using 语句中声明，如下所示：

```
 public void TestIt()
    {
        // DisposableInt TheInt;
        using (DisposableInt TheInt = new DisposableInt(1))
        {
            Console.WriteLine(String.Format("Int Value: {0}", TheInt.MyInt));
            AddOne(ref TheInt);
            Console.WriteLine(String.Format("Int Value + 1: {0}", TheInt.MyInt));
        }
    } 
```

我收到以下编译器错误：

```
Cannot pass 'TheInt' as a ref or out argument because it is a 'using variable' 
```

为什么是这样？`using`除了语句完成后类超出范围并进入垃圾收集器之外，还有什么不同？

（是的，我知道我的一次性类示例非常愚蠢，我只是想让事情变得简单）

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-24T17:53:34.903

> 为什么是这样？

语句中*声明*的变量`using`是只读的；`out`而`ref`参数不是。所以你*可以*这样做：

```
DisposableInt theInt = new DisposableInt(1);
using (theInt)
{
    AddOne(ref theInt);
} 
```

...但从根本上讲，您并没有*使用*`ref`它是参数的事实...

您可能误解了`ref`真正的含义。阅读我[关于参数传递的文章](http://pobox.com/~skeet/csharp/parameters.html)以确保您真正理解是个好主意。

# opencl - OpenCL - 多 GPU 缓冲区同步

> ID：11636491
> 
> 赞同：3
> 
> 时间：2012-07-24T17:50:59.683
> 
> 标签：opencl, nvidia

我有一个 OpenCL 内核，它计算系统中其他粒子对粒子施加的总力，然后是另一个集成粒子位置/速度的内核。我想在多个 GPU 上并行化这些内核，基本上为每个 GPU 分配一定数量的粒子。但是，我必须多次运行这个内核，并且每个 GPU 的结果都会在每个 GPU 上使用。让我进一步解释一下：

假设您在 GPU 0 上有粒子 0，在 GPU 1 上有粒子 1。粒子 0 上的力发生了变化，粒子 1 上的力也发生了变化，然后积分器相应地改变了它们的位置和速度。然后，这些新位置需要放置在每个 GPU 上（两个 GPU 都需要知道粒子 0 和粒子 1 都在哪里），并且这些新位置用于计算下一步中每个粒子上的力，由积分器，其结果用于计算力等。**本质上，在力计算滚动时，所有缓冲区都需要包含相同的信息。**

所以，问题是：**考虑到每个 GPU 都有不同的缓冲区，跨 GPU 同步缓冲区的最佳方法是什么**？[根据我的最后一个问题](https://stackoverflow.com/questions/11562543/clenqueuendrange-blocking-on-nvidia-hardware-also-multi-gpu)，如果我想保持并行性，它们就不能有一个共享缓冲区（不过，如果有办法创建一个共享缓冲区并仍然保留多个 GPU，我完全赞成）。我怀疑复制每个步骤的结果会导致比跨 GPU 并行化算法更慢的速度。

我确实找到[了这个线程](https://stackoverflow.com/questions/11093826/read-write-opencl-memory-buffers-on-multiple-gpu-in-a-single-context)，但答案不是很明确，仅适用于所有 GPU 的单个缓冲区。我想知道，特别是对于 Nvidia GPU（更具体地说，是 Tesla M2090）。

**编辑：**实际上，根据[Khronos 论坛上的这个帖子](http://www.khronos.org/message_boards/viewtopic.php?f=37&t=2133)，OpenCL 工作组的一位代表表示，共享上下文上的单个缓冲区确实会分布在多个 GPU 上，每个 GPU 都确保它在内存中拥有最新信息. 但是，我在 Nvidia GPU 上没有看到这种行为。当我`watch -n .5 nvidia-smi`在后台运行程序时使用时，我看到一个 GPU 的内存使用量上升了一段时间，然后在另一个 GPU 的内存使用量上升时下降。有没有人可以指出我正确的方向？也许这只是他们的实施？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T20:38:01.493

听起来您在实施时遇到了麻烦。

SIGGRAPH 有一个很棒的演示文稿，展示了利用共享内存的多个 GPU 的几种不同方法。幻灯片在[这里](http://sa09.idav.ucdavis.edu/docs/SA09-opencl-dg-events-stream.pdf)。

我想，在您当前的设置中，您有一个包含多个设备和多个命令队列的单一上下文。对于您正在做的事情，这可能是正确的方法。

[OpenCL 1.2 规范](http://www.khronos.org/registry/cl/specs/opencl-1.2.pdf)的附录 A说：

> OpenCL 内存对象，[...] 是使用上下文创建的，并且可以在使用相同上下文创建的多个命令队列之间共享。

更远：

> 应用程序需要在主机处理器上的线程之间实现适当的同步，以确保当多个线程中的多个命令队列正在生成时，共享对象状态的更改 [...] 以正确的顺序发生 [...]更改共享对象的状态。

所以在我看来，计算粒子位置和速度的内核需要依赖于计算粒子间力的内核。听起来你已经知道了。

为了更多地说明您的问题：

> 考虑到每个 GPU 都有不同的缓冲区，跨 GPU 同步缓冲区的最佳方法是什么？

...我认为答案是“不要让缓冲区分开”。通过使该对象来自相同的上下文`cl_mem`，在两个设备之间使用相同的对象。`cl_mem`

至于数据实际存在的位置......正如您所指出的，这是实现定义的（至少据我从规范中可以看出）。您可能不应该担心数据在哪里，只需从两个命令队列中访问数据。

我意识到这可能会产生一些严重的性能问题。实现可能会发展并变得更好，因此如果您现在根据规范编写代码，将来它可能会运行得更好。

为了获得更好（或至少不同）的缓冲区共享行为，您可以尝试的另一件事是将粒子数据制作成地图。

如果有任何帮助，我们的设置（具有双 C2070 的一堆节点）似乎可以相当优化地共享缓冲区。有时，数据只保存在一个设备上，有时数据可能同时存在于两个地方。

总而言之，我认为这里的答案是以**规范提供的最佳方式来做，并希望在实施方面做到最好。**

我希望我是有帮助的，

瑞安

# c - 如何为任意大小的固定长度 C 字符串数组分配内存

> ID：11636509
> 
> 赞同：2
> 
> 时间：2012-07-24T17:51:54.420
> 
> 标签：c, arrays, string

我正在尝试为 C 字符串数组分配内存。我可以保证字符串适合`MAX_STRING_LENGTH`字符，但在编译时我不知道数组中有多少字符串（这是动态计算的）。当我使用代码时...

```
char *strings[MAX_STRING_LENGTH] = malloc( sizeof(char *) * numstrings ); 
```

...编译器抱怨这是一个无效的初始化程序。当我使用代码时...

```
char strings[MAX_STRING_LENGTH][] = malloc( sizeof(char *) * numstrings ); 
```

...编译器抱怨不完整的元素类型。我在这里做错了什么，如何为这个数组分配内存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:56:28.600

有了这个声明：

```
char *strings[MAX_STRING_LENGTH] = malloc(sizeof(char *) * numstrings); 
```

它读起来好像您正在定义一个 C 字符串数组，其计数 - 而不是单个字符串长度 - 是`MAX_STRING_LENGTH`.

最好定义 a `**char`，如下所示：

```
char **strings = malloc(sizeof(char *) * numstrings); 
```

稍后在您的代码中，当您准备将字符串添加到例如插槽 5 时：

```
strings[5] = malloc(sizeof(char) * MAX_STRING_LENGTH)); 
```

或在初始化循环中，例如：

```
for (i = 0; i < numstrings; i++)
    strings[i] = malloc(sizeof(char) * MAX_STRING_LENGTH); 
```

而且，如果在某些时候您需要更多字符串`realloc`的空间，请使用来增加初始内存分配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:39:50.107

```
char (*strings)[MAX_STRING_LENGTH] = malloc(sizeof *strings * num_strings); 
```

将分配一个`num_strings`x`MAX_STRING_LENGTH`数组`char`作为一个连续的块，这样您就不必进行多级分配。

```
strcpy(strings[i], "This is a test");
printf("%s\n", strings[j]); 
```

等当你完成后，你只需要`free(strings);`。

`num_strings`这种方法的主要缺点是，如果请求非常大， 您可能没有足够的内存来满足请求，并且如果您的大多数字符串都短于 MAX_STRING_LENGTH，您将有一些内部碎片。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T17:55:15.857

```
char **strings;

strings=(char **) malloc(number of strings);

strings[i]=(char *) malloc(MAX_STRING_LENGTH); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T17:55:48.757

如果它真的是动态的，那么它可能需要是这样的：

```
char **strings = malloc( sizeof(char*) * numstrings );
for ( int i = 0; i < numstrings; i++ )  
    strings[i] = malloc( MAX_STRING_LENGTH ); 
```

也可以将其全部分配到一个块中（使其更容易释放），然后将数组中的各个指针分配给已分配缓冲区中的计算位置。但是，这增加了一些可能不会超过好处的复杂性。

# ant - Ant SecureInputHandler：与 tee 一起使用时以明文形式打印密码

> ID：11636514
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:52:18.967
> 
> 标签：ant, tee

我们使用 Ant 的安全处理程序来输入密码：

```
<input message="Please enter TFS password: " addproperty="tfs.password">
  <handler type="secure"/> 
</input> 
```

当然，这确实有效：不打印输入。

虽然（保存构建日志）我们将构建运行为

```
ant | tee build.log 
```

输入以明文形式打印。哎呀。

我想知道问题出在哪里（蚂蚁？三通？）以及如何解决这个问题。

PS操作系统：

```
Linux devosb1 3.0.0-12-generic #20-Ubuntu 
SMP Fri Oct 7 14:56:25 UTC 2011 x86_64 x86_64 x86_64 GNU/Linux 
```

PPS 好的，所以它不是 tee - 带有 read/echo 而不是 tee 的 shell 脚本会触发相同的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:51:23.503

看起来像一个shell问题。您是否考虑过使用[ANT 记录](http://ant.apache.org/manual/Tasks/recorder.html)任务？

```
<project name="demo" default="build">

    <target name="build">
        <record name="build.log" loglevel="verbose"/>

        <input message="Please enter TFS password: " addproperty="tfs.password">
            <handler type="secure"/> 
        </input>
    </target>

</project> 
```

# maven - maven项目之间的依赖关系

> ID：11636521
> 
> 赞同：1
> 
> 时间：2012-07-24T17:52:35.417
> 
> 标签：maven, dependencies

我有一些库在其他项目中用作依赖项。有没有办法查看哪些项目正在使用我的库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T07:00:00.977

在其他项目的 pom.xml 中搜索 group & artifact id。

# iphone - UIViewcontroller 从未被释放

> ID：11636525
> 
> 赞同：0
> 
> 时间：2012-07-24T17:52:41.840
> 
> 标签：iphone, memory-management, uiviewcontroller, dealloc

我来这里寻求帮助，因为我正在完成我的 iphone 项目，我希望它是完美的！

我在*分配*和*释放*.`UIViewcontroller`

让我解释 ：

我有一个`UITableview`自定义单元格。在每个自定义单元格中，将分配一个新的按钮`UIViewController`：***ListOfAGuestFriendViewController***；

因此，我创建了一个委托，它调用一个方法来进行“翻转转换”，并显示我的新 ListOfAGuestFriendViewController 视图。

我的问题是，我的 ALL 都遇到了同样的问题，**ListOfAGuestFriendViewController**`addSubiew`永远***不会***被**释放**，或者在视图加载**后被释放！**

有人可以准确地解释我如何制作*完美*的addSubview 吗？

这是我的代码：

***当我翻转视图时：***

```
-(void)flipAView
{
    Guest *currentSelectedGuest = [self createAGuestUsingIndexPath:self.selectedIndex];

    ListOfAGuestFriendViewController *listOfAGuestFriendViewController = [[ListOfAGuestFriendViewController alloc]init];

    [listOfAGuestFriendViewController setCurrentGuestSelected:currentSelectedGuest];
    [listOfAGuestFriendViewController setMyListOfContactControllerDelegate:self];

    [UIView animateWithDuration:0.25 animations:^{
        [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
        [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight 
                           forView:self.tableviewContainerView cache:YES];
        [self.tableviewContainerView addSubview:listOfAGuestFriendViewController.view];
    }completion:^(BOOL finished){
        [listOfAGuestFriendViewController release];
        [self collapseCurrentExpandedCell];
    }];
} 
```

***当我想回去时：***

```
-(IBAction)goBackButtonGotPressed:(id)sender{
    [UIView animateWithDuration:0.5 animations:^{
        [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
        [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft 
                           forView:[self.view superview] cache:YES];
        [self.view removeFromSuperview];
    }];
} 
```

如果我删除那行代码：

```
[listOfAGuestFriendViewController release]; 
```

我的`listOfAGuestFriendViewController`永远不会解除分配。

我不为此实例使用属性，但是当我这样做时，它是一样的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:30:52.800

让我用你的代码解释一下：

```
ListOfAGuestFriendViewController *listOfAGuestFriendViewController = [[ListOfAGuestFriendViewController alloc]init]; 
```

创建对象时，保留计数将为 1。

当您这样做时：`[self.tableviewContainerView addSubview:listOfAGuestFriendViewController.view];`接收者视图将保留该视图。然后它的retaincount将变为2。

在此之后：[self.view removeFromSuperview]; 保留计数将变为 1。

**每个对象只有在它的retaincount变为0后才会被释放** 。在上面的例子中它是1，所以它永远不会调用dealloc方法。

如果你写这行：`[listOfAGuestFriendViewController release];`在这之后`[self.tableviewContainerView addSubview:listOfAGuestFriendViewController.view];`这意味着它的保留计数从 2 减少到 1，所以当你调用`[self.view removeFromSuperview];`你的视图时，你的视图将被释放。[addSubview](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)参考[内存管理](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html) 参考

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:03:56.610

你检查了dealloc函数吗？// Tu as une fonction dealloc dans tes ViewController qui est appelée automatiquement quand ta vue est retirée.

```
- (void)dealloc
{
    [yourThings release], yourThings = nil;
    [super dealloc];
} 
```

# iphone - iphone - 扫描完整图像以获取像素颜色

> ID：11636526
> 
> 赞同：0
> 
> 时间：2012-07-24T17:52:41.553
> 
> 标签：iphone, ios, xcode

我有以下问题：如何扫描完整的图像以获取每个像素的颜色。

我使用这个库[https://github.com/unixpickle/ANImageBitmapRep](https://github.com/unixpickle/ANImageBitmapRep)。

我有这个代码：

```
- (void)executeImageScanProcessWithImage:(UIImage *)image{

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 
                                         (unsigned long)NULL), ^(void) {

    NSString *rowString = @"";
    NSMutableArray *array = [[NSMutableArray alloc] init];
    ANImageBitmapRep *imageBitmap;
    UIColor *color;
    // Loop für die Spalten (y)
    for (int y = 0; y < 320; y += 20) {
        rowString = @""; // rowString zurücksetzen

        // Loop für die Reihe (x)
        for (int x = 0; x < image.size.width; x += 20) {

            BMPoint pixelPoint = BMPointMake(x, y);
            imageBitmap = [ANImageBitmapRep imageBitmapRepWithImage:image];
            BMPixel pixel = [imageBitmap getPixelAtPoint:pixelPoint];
            color = UIColorFromBMPixel(pixel);

            if ([color isEqual:[UIColor redColor]]) {
                rowString = [rowString stringByAppendingFormat:@"0"];
            }
            else {
                rowString = [rowString stringByAppendingFormat:@"1"];
            }

            // Wenn der letzte "Run" vollzogen ist, wird die rowString in den Array hinzugefügt
            if ([rowString length] == image.size.width / 20) {
                [array addObject:rowString];
            }
        }

        [array addObject:rowString];
    }

    NSLog(@"content of array = %@",array);

}); 
```

}

问题是当图像太大时出现此错误。

> Malloc 失败了，这太糟糕了。我希望能利用这段记忆。7 月 24 日 18:31:41 Christians-MacBook-Pro.local Bitmap_Test[2374]：CGBitmapContextGetData：无效上下文 0x0 7 月 24 日 18:31:41 Christians-MacBook-Pro.local Bitmap_Test[2374]：CGBitmapContextCreateImage：无效上下文 0x0 7 月 24 日18:31:41 Christians-MacBook-Pro.local Bitmap_Test[2374]：CGBitmapContextGetWidth：无效上下文 0x0 Bitmap_Test（2374,0xb0103000）malloc：*** mmap（size=2265088）失败（错误代码=12）

你知道处理这个计划的另一种方法吗？

来自德国的问候，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:20:22.887

我找到了另一个线程的代码，我用我的代码替换了它。

这是线程： [如何从 UIImage (Cocoa Touch) 或 CGImage (Core Graphics) 获取像素数据？](https://stackoverflow.com/questions/448125/how-to-get-pixel-data-from-a-uiimage-cocoa-touch-or-cgimage-core-graphics)

# ruby-on-rails-3 - 在 Rails has_many 关系上默认使用范围

> ID：11636541
> 
> 赞同：90
> 
> 时间：2012-07-24T17:53:20.957
> 
> 标签：ruby-on-rails-3, activerecord, has-many

假设我有以下课程

```
class SolarSystem < ActiveRecord::Base
  has_many :planets
end

class Planet < ActiveRecord::Base
  scope :life_supporting, where('distance_from_sun > ?', 5).order('diameter ASC')
end 
```

`Planet`有一个范围`life_supporting`和`SolarSystem` `has_many :planets`. 我想定义我的 has_many 关系，以便当我要求 a `solar_system`for all associated`planets`时，`life_supporting`会自动应用范围。本质上，我想要`solar_system.planets == solar_system.planets.life_supporting`.

## 要求

*   我**不想**换成`scope :life_supporting`_ `Planet`_

    `default_scope where('distance_from_sun > ?', 5).order('diameter ASC')`

*   我还想通过不必添加来防止重复`SolarSystem`

    `has_many :planets, :conditions => ['distance_from_sun > ?', 5], :order => 'diameter ASC'`

## 目标

我想要类似的东西

`has_many :planets, :with_scope => :life_supporting`

# 编辑：解决方法

正如@phoet 所说，使用 ActiveRecord 可能无法实现默认范围。但是，我发现了两个潜在的解决方法。两者都防止重复。第一个虽然很长，但保持了明显的可读性和透明度，第二个是辅助类型方法，其输出是显式的。

```
class SolarSystem < ActiveRecord::Base
  has_many :planets, :conditions => Planet.life_supporting.where_values,
    :order => Planet.life_supporting.order_values
end

class Planet < ActiveRecord::Base
  scope :life_supporting, where('distance_from_sun > ?', 5).order('diameter ASC')
end 
```

另一个更清洁的解决方案是简单地将以下方法添加到`SolarSystem`

```
def life_supporting_planets
  planets.life_supporting
end 
```

并在`solar_system.life_supporting_planets`任何你想使用的地方使用`solar_system.planets`.

两者都没有回答这个问题，所以我只是把它们放在这里，以防其他人遇到这种情况。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2013-10-22T15:05:44.340

在 Rails 4 中，`Associations`有一个可选`scope`参数，该参数接受应用于`Relation`（参见[ActiveRecord::Associations::ClassMethods](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Customizing+the+query)的文档）的 lambda

```
class SolarSystem < ActiveRecord::Base
  has_many :planets, -> { life_supporting }
end

class Planet < ActiveRecord::Base
  scope :life_supporting, -> { where('distance_from_sun > ?', 5).order('diameter ASC') }
end 
```

在 Rails 3 中，`where_values`有时可以通过使用`where_values_hash`处理更好的范围来改进解决方法，其中条件由多个`where`或散列定义（这里不是这种情况）。

```
has_many :planets, conditions: Planet.life_supporting.where_values_hash 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2019-03-05T17:32:12.493

在 Rails 5 中，以下代码可以正常工作...

```
 class Order 
    scope :paid, -> { where status: %w[paid refunded] }
  end 

  class Store 
    has_many :paid_orders, -> { paid }, class_name: 'Order'
  end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T19:01:13.943

我刚刚深入研究了 ActiveRecord，但目前的`has_many`. 您可以将块传递给，`:conditions`但这仅限于返回条件哈希，而不是任何类型的 arel 东西。

实现您想要的（我认为您正在尝试做的）的一种非常简单且透明的方法是在运行时应用范围：

```
 # foo.rb
  def bars
    super.baz
  end 
```

这与您的要求相去甚远，但它可能会起作用；）

# sql - 尝试向 sql 数据库添加 10 个值

> ID：11636544
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:53:29.447
> 
> 标签：sql, sql-server-2008

这是在 sql management studio 下的简单任务。我点击了编辑前 200 行。并将第一组值输入为：

除了 Index 和 rollnumber 之外，一切都应该相同

```
Index class rollnumber age 
1      A      1         10
2      A      2         10
3      A      3         10
...
10     A      10        10 
```

我遇到的问题是：我复制了第一行并粘贴到了第二行，当我尝试在 sql 编辑器中更改它时，我无法做到。谁能告诉我通过 sql 编辑器执行此操作的最佳方法是什么？

或者在这种情况下是否有更简单的方法来进行 SQL 插入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:59:30.570

您可以进行 sql 查询并在编辑器中执行它。

```
insert into table values( 1, A, 1, 10);
insert into table values( 2, A, 2, 10);
insert into table values( 3, A, 3, 10);
insert into table values( 4, A, 4, 10);
insert into table values( 5, A, 5, 10);
insert into table values( 6, A, 6, 10);
insert into table values( 7, A, 7, 10);
insert into table values( 8, A, 8, 10);
insert into table values( 9, A, 9, 10);
insert into table values( 10, A, 10, 10); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T17:55:58.537

如果您将其作为主键，请尝试在没有索引字段的情况下复制它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:58:13.847

我假设索引是一个 IDENTITY 列。数据库将分配值

可能存在差距：这是 IDENTITY 列的本质

在这种情况下，学习使用原始 SQL INSERT 会有所帮助：您可以更好地控制自己所做的事情。[SET IDENTITY_INSERT](http://msdn.microsoft.com/en-us/library/ms188059.aspx)将允许您覆盖身份属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:00:30.867

您可以将其作为快速 SQL 语句执行（假设您的第一列是 IDENTITY 列）：

```
INSERT INTO dbo.YourTableName(class,rollnumber,age)
VALUES ('A', 10, 10),
       ('A', 11, 10),
       ('A', 12, 10) 
```

这种格式很容易复制和粘贴单个值，直到您将它们全部考虑在内，然后可以运行一次以将它们放入（或保存并在其他环境中重新运行）。

如果索引列不是 IDENTITY 列，而只是它给您一个错误的 UNIQUE 列，您可以将其指定为列并提供额外的唯一值，如下所示：

```
INSERT INTO dbo.YourTableName(index, class,rollnumber,age)
VALUES (10, 'A', 10, 10),
       (11, 'A', 11, 10),
       (12, 'A', 12, 10) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T18:12:01.443

如果您的 Index 列是带有 Identity 的主键，您可以使用以下内容创建 N - 1 行：

```
DECLARE @Counter int;
SET @Counter = 0;

WHILE (@Counter < 10)
BEGIN
INSERT INTO table ([class],[rollnumber],[age]) VALUES ('A',@@IDENTITY + 1,10)
SET @Counter = @Counter + 1
END 
```

这也假设 rollnumber 必须等于您的索引。

# ios - Xcode ARC 项目添加了带有发布调用的 dealloc

> ID：11636546
> 
> 赞同：1
> 
> 时间：2012-07-24T17:53:38.367
> 
> 标签：ios, xcode, automatic-ref-counting

我将我的项目转换为使用 ARC，但是当我将项目添加到 xib 然后将它们拖到我的 .h 文件以创建 IBOutlets 时，Xcode 通过释放调用和`[super dealloc]`调用再次添加了 dealloc 方法。

我不想每次在这个项目中添加插座时都必须删除这些东西。这是什么原因造成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:08:48.573

您是否关闭了项目并在转换后重新打开它？这听起来像是 Xcode 中那些陈旧的数据之一。完成此操作后，请检查项目设置和目标设置以确保 ARC 实际上已启用。

在转换我的项目后我从未见过这个，但我 100% 确定我首先关闭/重新打开。更改后我确实看到了其他奇怪的东西，所以现在习惯关闭/重新打开。

编辑：另外，选择 xib 文件，然后打开最右侧的窗格并查看“Interface Builder Document”部分，并确保部署和开发版本是最新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:15:01.733

我以前有过这种经历。我有不同的目标——并没有全部设置为 ARC。

检查例如。发布设置设置为非 ARC。如果某些目标上的某些构建配置启用了 ARC，我相信 Xcode 在从 XIB 拖动时会使用 dealloc 方法。

# exchangewebservices - Exchange Web 服务 - 获取所有可用“ExtendedProperty”的列表

> ID：11636548
> 
> 赞同：3
> 
> 时间：2012-07-24T17:53:47.850
> 
> 标签：exchangewebservices

我有一个 Exchange 服务器，其中包含具有自定义字段的项目（*例如，具有自定义 ExtendedProperty 值的联系人和事件*）。我正在寻找一种使用 Exchange Web 服务 (EWS) 显示这些字段的方法。

根据[Microsoft 文档](http://msdn.microsoft.com/en-us/library/exchange/dd633697%28v=exchg.80%29)，有一种使用该方法检索单个`ExtendedProperty`值的简单`FindItem`方法。例子：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"
     xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types"
     xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Header>
    <t:RequestServerVersion Version="Exchange2010" />
  </soap:Header>
  <soap:Body>
    <m:FindItem Traversal="Shallow">
      <m:ItemShape>
        <t:BaseShape>AllProperties</t:BaseShape>
        <t:AdditionalProperties>
          <t:ExtendedFieldURI PropertySetId="c11ff724-aa03-4555-9952-8fa248a11c3e" 
             PropertyName="Expiration Date" PropertyType="String" />
        </t:AdditionalProperties>
      </m:ItemShape>
      <m:IndexedPageItemView MaxEntriesReturned="10" Offset="0" BasePoint="Beginning" />
      <m:ParentFolderIds>
        <t:DistinguishedFolderId Id="inbox" />
      </m:ParentFolderIds>
    </m:FindItem>
  </soap:Body>
</soap:Envelope> 
```

但是，这需要`PropertySetID`和。就我而言，我不知道有什么可用的，更不用说and了。有没有办法获取所有可用**扩展属性**的列表？`PropertyType``PropertyName``PropertySetIDs``PropertyType``PropertyName`

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T08:55:42.503

It is not possible to get list of extended (custom) properties. I was using API from Independentsoft and they told me that you have to know (request) which properties want to retrieve with EWS.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-26T00:09:22.433

有一种获取扩展属性列表的方法：您可以使用以下代码：

`ItemView view = new ItemView(100); var s = service.FindItems(WellKnownFolderName.Inbox, view); ExtendedPropertyDefinition ExtendedProp = new ExtendedPropertyDefinition(DefaultExtendedPropertySet.PublicStrings, "Expiration Date", MapiPropertyType.String); var requestedPropertySet = new PropertySet(BasePropertySet.FirstClassProperties, ExtendedProp; var s = service.FindItems(WellKnownFolderName.Inbox, view);`

然后遍历 s 中的每个项目，然后执行：

`foreach(var s1 in s) { s1.load(requestedPropertySet); //Here you need to specify the name of each extended property and get it one by one. }`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-20T13:49:28.120

```
 if (emails[i].ExtendedProperties.Count > 0)
 {
      Console.WriteLine("Aantal extended properties *" + i + "*" + sAccount + "*" + emails[i].ExtendedProperties.Count + "*");
      foreach (ExtendedProperty extendedProperty in emails[i].ExtendedProperties)
      {
          Console.WriteLine(" Extended Property Name: " + extendedProperty.PropertyDefinition.Name);
          Console.WriteLine(" Extended Property Value: " + extendedProperty.Value);
      }
} 
```**

# iphone - StageWebView 滚动 - iOS AIR

> ID：11636551
> 
> 赞同：0
> 
> 时间：2012-07-24T17:53:56.547
> 
> 标签：iphone, flash, air, mobile-application, stagewebview

我正在使用该类在我的*iOS*`StageWebView`应用程序中显示 html 页面。除滚动外，一切正常。它允许最终用户滚动整个 web 视图，并在到达页面内容的末尾后显示难看的灰色背景。 我的问题是：***有没有办法禁用滚动过去的页面内容？***

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:09:36.613

我不认为有办法做什么。使用`StageWebView`实现此功能的 iOS 默认浏览器（使用不同的背景颜色，但行为相同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T23:44:18.630

你试过这个视口吗？

```
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

重要的部分是`user-scalable=no`应该删除 iOS 浏览器的“滚动反弹”。**

# javascript - javascript: setInterval 执行时不停止

> ID：11636554
> 
> 赞同：0
> 
> 时间：2012-07-24T17:54:01.783
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在创建一个 chrome 扩展，我需要使用一个间隔。

每次间隔关闭的时间由用户自己选择。

该函数在每个打开的选项卡上执行并向其发送数据。

我的问题是“计时器”不能正常工作，它只是像普通的while循环一样一次执行。

这是代码：

```
chrome.tabs.query({}, function (tabs) {
//the times the code need to run is by the amount of tabs that is open
        setInterval(function () {
            if (i < tabs.length) {

                chrome.tabs.sendRequest(tabs[i].id, { input: "uCanSend",

                    userName: myName,
                    password: myPass,

                    subject: mySubject, msg: myMsg,

                    linkName1: myLinkName1,
                    linkURL1: myLinkURL1,

                    linkName2: myLinkName2,
                    linkURL2: myLinkURL2

                }, function (response) { });

            }
            i++;
        }, timeInMintus //the time that the code need to run every time);
    }); 
```

我不知道我做错了什么。知道如何修复它以使其正常运行吗？

（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:55:45.470

第二个参数需要以毫秒（千分之一秒）为单位。根据变量名称，您似乎正在过几分钟。例如，如果您希望回调每分钟运行一次：

```
setInterval(function () { /* snip */ }, 1000*60); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:07:32.610

Chrome 将非活动标签上的 setTimeout/setInterval 调用排队并更改[最小超时长度](http://codereview.chromium.org/6577021)。

# security - 更改 SSRS 服务帐户导致报告部署应用程序中出现“HTTP 请求未经授权”错误

> ID：11636557
> 
> 赞同：1
> 
> 时间：2012-07-24T17:54:14.537
> 
> 标签：security, soap, reporting-services, ssrs-2008

我有一个 C# 应用程序，用于将报告部署到 SSRS 实例。它一直运作良好。为了提高安全性，我决定将 SSRS 从使用 NT AUTHORITY\NETWORK SERVICE 帐户更改为使用专用域帐户。我使用 Reporting Services 配置管理器进行更改。现在我的应用程序抛出 MessageSecurityException：

HTTP 请求未经客户端身份验证方案“协商”的授权。The authentication header received from the server was 'Negotiate oYGEMIGBoAMKAQGiegR4YHYGCSqGSIb3EgECAgMAfmcwZaADAgEFoQMCAR6kERgPMjAxMjA3MjQxNzIyNTBapQUCAwUAuaYDAgEpqQ4bDFZFUlRFWC5MT0NBTKoqMCigAwIBA6EhMB8bBGhvc3QbF3Z0eC1kZXYtMDEudmVydGV4LmxvY2Fs'.

我调用以下方法：

```
public static ReportService.ReportingService2010SoapClient Connect(StreamWriter logFile, string reportingServicesUri)
{
    //Connect with the user's Windows credentials
    try
    {
        BasicHttpBinding basicHttpBinding = new BasicHttpBinding();
        basicHttpBinding.Security.Mode = BasicHttpSecurityMode.TransportCredentialOnly;
        basicHttpBinding.Security.Transport.ClientCredentialType = HttpClientCredentialType.Windows;
        basicHttpBinding.SendTimeout = new TimeSpan(0, 10, 0);
        EndpointAddress endpoint = new EndpointAddress(reportingServicesUri);
        var rs = new ReportService.ReportingService2010SoapClient(basicHttpBinding, endpoint);
        rs.ClientCredentials.Windows.AllowedImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Impersonation;
        rs.ChannelFactory.Credentials.Windows.ClientCredential = System.Net.CredentialCache.DefaultNetworkCredentials;
        return rs;
    }
    catch (UriFormatException)
    {
        Common.WriteToLog(logFile, "Connect: " + reportingServicesUri + " does not point to a valid SSRS instance.", false);
    }

    return null;
} 
```

然后我调用这个方法（这是捕获异常的地方）：

```
private static CatalogItem FindFirstItem(ReportingService2010SoapClient rs, StreamWriter logFile, String itemPath, String itemName)
{
    CatalogItem[] items;
    var itemsNames = new string[] { itemName };
    string indentText = "";
    Console.WriteLine(indentText + "Searching for " + itemPath + '/' + itemName + "...");

    try
    {
        TrustedUserHeader userHeader = new TrustedUserHeader();
        var properties = new Property[1];
        properties[0] = new Property();
        properties[0].Name = "Recursive";
        properties[0].Value = "false";
        var conditions = new SearchCondition[1];
        conditions[0] = new SearchCondition();
        conditions[0].Condition = ConditionEnum.Equals;
        conditions[0].ConditionSpecified = true;
        conditions[0].Name = "Name";
        conditions[0].Values = itemsNames;
        rs.FindItems(userHeader, "/" + itemPath, BooleanOperatorEnum.And, properties, conditions, out items);

        if (items.Length == 0)
            return null;

        return items[0];
    }
    catch (FaultException e)
    {
        if (!e.Message.Contains("cannot be found"))
            Common.WriteToLog(logFile, "FindFirstItem: " + e.Message, false);
    }
    catch (MessageSecurityException e)
    {
        throw;
    }

    return null;
} 
```

我仍然可以使用浏览器中的报告管理器 URL 访问此 SSRS 实例的数据源。我的应用程序仍然适用于使用 NT AUTHORITY\NETWORK SERVICE 作为服务帐户的 SSRS 实例。我怎样才能让这个应用程序再次与这个 SSRS 实例一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-22T21:04:55.673

[WCFTestClient HTTP 请求未经授权，客户端身份验证方案“匿名”](https://stackoverflow.com/questions/1044034/wcftestclient-the-http-request-is-unauthorized-with-client-authentication-scheme)

```
Customer_PortClient proxy = new Customer_PortClient();
proxy.ClientCredentials.Windows.AllowedImpersonationLevel =    
         System.Security.Principal.TokenImpersonationLevel.Impersonation; 
```

# c# - 将嵌套列表与逻辑相结合

> ID：11636560
> 
> 赞同：3
> 
> 时间：2012-07-24T17:54:19.757
> 
> 标签：c#, list, nested, wrapper

我正在使用无法序列化嵌套列表的游戏引擎，例如`List<List<int>>`. 我需要的是一个快速的解决方案，它将多个列表存储到一个列表中。我即将自己写这个，但想知道是否已经存在任何解决方案。

是否有任何包装器可以将“虚拟”嵌套列表存储到一个大列表中，同时提供您期望从单独列表中获得的功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T17:57:08.837

您可以使用[`Enumerable.SelectMany`](http://msdn.microsoft.com/en-us/library/bb534336.aspx)扁平化嵌套列表：

```
List<int> flattened = allLists.SelectMany(l => l).ToList(); 
```

> 是否可以将扁平列表展开回嵌套列表？

您可以使用 a`Tuple<int, int>`将原始列表的编号存储在中`Item1`，将编号本身存储在 中`Item2`。

```
// create sample data
var allLists = new List<List<int>>() { 
    new List<int>(){ 1,2,3 },
    new List<int>(){ 4,5,6 },
    new List<int>(){ 7,8,9 },
};

List<Tuple<int, int>> flattened = allLists
    .Select((l, i) => new{ List = l, Position = i + 1 })
    .SelectMany(x => x.List.Select(i => Tuple.Create(x.Position, i)))
    .ToList();

// now you have all numbers flattened in one list:
foreach (var t in flattened)
{
    Console.WriteLine("Number: " + t.Item2); // prints out the number
}
// unflatten
allLists = flattened.GroupBy(t => t.Item1)
                    .Select(g => g.Select(t => t.Item2).ToList())
                    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:12:57.663

像这样的东西怎么样：

要展平列表，请使用其他人建议的东西来制作元组的展平列表（注意，下面的所有代码都未经测试）：

```
List<List<int>> myStartingList = new List<List<int>>();
List<Tuple<int, int, int>> myFlatList = new List<Tuple<int, int, int>>();
for (var iOuter = 0; iOuter < myStartingList.Count; iOuter++)
    for (var iInner = 0; iInner < myStartingList[iOuter].Count; iInner++)
        myFlatList.Add(new Tuple<int, int, int>(iOuter, iInner, myStartingList[iOuter][iInner]); 
```

并展开：

```
List<List<int>> myNestedList = new List<List<int>>();
int iOuter=-1;
foreach (var t in myFlattenedList)
{
    if (iOuter != t.Item1)
        myNestedList.Add(new List<Int>());
    iOuter = t.Item1;
    myNestedList[t.Item1][t.Item2] = t.Item3;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:57:18.247

你能澄清一下你是否在追求：

1.  一个可以表示嵌套列表的序列化库（例如 JSON.NET 应该能够）。
2.  一种扁平化列表的方法

# c - 如何调试可能的堆损坏？

> ID：11636563
> 
> 赞同：3
> 
> 时间：2012-07-24T17:54:32.983
> 
> 标签：c, windows-xp, heap-corruption

VS2008，C。还使用了一些预构建的库。当我在调试器中单步执行我的代码并遍历被调用的库函数时，我得到了这个：

> HEAP [unit_test.exe]：堆在 35c70 附近的已提交范围内缺少最后一个条目 Windows 已触发 unit_test.exe 中的断点。
> 
> 这可能是由于堆损坏，这表明 unit_test.exe 或其已加载的任何 DLL 中存在错误。
> 
> 这也可能是由于用户在 unit_test.exe 获得焦点时按 F12。
> 
> 输出窗口可能有更多诊断信息。

关于如何调试的任何想法？

更新：我重构了代码并看到在执行 printf() 时出现了弹出窗口。当有一个 free() 时，我也得到它。我注释掉了这些行，现在当有一个 malloc() 时，我得到了堆损坏弹出对话框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T18:38:02.020

我建议您首先使用应用程序验证程序来测试堆损坏。Application Verifier 是 Microsoft 提供的免费工具，可帮助识别资源泄漏和堆损坏。您可以在 url 找到 App Verifier：http: [//www.microsoft.com/en-us/download/details.aspx](http://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=20028) ?displaylang=en&id=20028您可以从[http： //technet.microsoft.com/en-us/library/bb457063.aspx](http://technet.microsoft.com/en-us/library/bb457063.aspx)

在这些情况下它通常很有用。

# javascript - 如何修复 - jEditable 被回调 2x？

> ID：11636566
> 
> 赞同：0
> 
> 时间：2012-07-24T17:54:46.097
> 
> 标签：javascript, jquery, jeditable

我对 jEditable 感到疯狂......在我的情况下，回调似乎被调用了两次，我的表中有一个 fnUpdate：

```
oTable.$("td.my_class").editable(function(value, settings) { 
    if (ifItsNumeber(value)) {
        console.log("It's a number.");

        var aPos = oTable.fnGetPosition( this );

        console.log("aPos: "+aPos);

        oTable.fnUpdate(qnttSL, aPos[0], aPos[1]));

        return(value);
    } else {
        console.log("It's not a NUMBER");

        return(null);    
    }

}, {
    width: '100%',
    onblur : 'submit'
}); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:41:53.717

为了使回调工作，它必须在 jEditable 的回调选项中使用，在仔细阅读文档之后......我想我误解了函数构建器的使用，而不是 Ajax 调用。

```
oTable.$("td.my_class").editable(function(value, settings) { 
    if (ifItsNumeber(value)) {
        console.log("It's a number.");
        return(value);
    } else {
        console.log("It's not a NUMBER");

        return(null);    
    }

}, {
    width: '100%',
    onblur : 'submit'
    callback: function(value){
                 var aPos = oTable.fnGetPosition( this );
                 oTable.fnUpdate(value, aPos[0], aPos[1]));
              }

}); 
```

# java - Eclipse RCP 数据绑定：标签的文本已更新，大小未更新

> ID：11636575
> 
> 赞同：2
> 
> 时间：2012-07-24T17:55:21.947
> 
> 标签：java, swt, eclipse-rcp

我使用以下代码将标签的文本值绑定到我的后端模型（省略了一些细节）：

```
Model model = entry.getModel();
Control nameControl = formToolkit.createLabel(labelPanel, null);

IObservableValue modelValue = BeanProperties.value(model.getClass(), Model.PROPERTY_NAME).observe(model);
IObservableValue widgetValue = SWTObservables.observeText(nameControl);

DataBindingContext context = new DataBindingContext();
UpdateValueStrategy widgetToModel = new UpdateValueStrategy(UpdateValueStrategy.POLICY_NEVER);
UpdateValueStrategy modelToWidget = new UpdateValueStrategy(UpdateValueStrategy.POLICY_UPDATE);
context.bindValue(widgetValue, modelValue, widgetToModel, modelToWidget); 
```

更改模型时，标签的文本会相应更新。但是标签没有调整大小。因此，当模型更改为更长的名称时，新名称将被截断。当它更改为更短的名称时，标签占用的空间超出了应有的空间。

我考虑过添加一个属性更改侦听器（用于模型名称或标签文本），`layout`每当名称更改时都会调用标签的父级，但这不会破坏数据绑定的目的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T08:45:14.323

那么你可以绑定你的控件的大小

```
WidgetProperties.size().observe(nameControl); 
```

到控件的文本（您已经拥有的可观察对象）并在您的 UpdateStrategy 中提供一个 IConverter 将文本转换为大小（因此每次文本更改时，您都可以计算文本然后设置控件的大小）。确保标签的大小被父母布局管理器识别

# iphone - iPhone暂停CAAnimation从应用程序进入后台并检索

> ID：11636576
> 
> 赞同：1
> 
> 时间：2012-07-24T17:55:22.470
> 
> 标签：iphone, animation, core-animation, storyboard, layer

我一直在阅读有关如何暂停 CAAnimation 的功能： [https ://developer.apple.com/library/ios/#qa/qa2009/qa1673.html](https://developer.apple.com/library/ios/#qa/qa2009/qa1673.html)

而且效果很好！除了当我点击主页按钮使应用程序进入后台（我确实为 applicationWillResignActive 使用了相同的暂停技术）

然而，动画似乎完全被删除了，而不是它漂亮的暂停。

关于如何解决这个问题的任何建议？

有时也会发生情节提要似乎从头开始重新启动整个应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T22:21:11.980

我已经使用该链接中的技术来暂停动画，并且效果很好。

但是，根据一些测试，在我看来，当您的应用程序进入后台时，系统会终止运行 CAAnimations。如果要从中断处继续动画，则必须重新创建动画并将 beginTime 参数设置为偏移到动画中的值。我还没有这样做，所以如果不做一些修补，我无法确切地告诉你如何做到这一点。

# asp.net - 无需命令行工具即可加密 web.config

> ID：11636578
> 
> 赞同：0
> 
> 时间：2012-07-24T17:55:28.507
> 
> 标签：asp.net, .net, encryption, web-config, asp.net-4.0

我想加密我的`appSettings`和`ConnectionStrings`位于我的`web.config`文件中的那个。

但是由于我使用的是共享主机，所以我不能使用`aspnet_regiis.exe`方法。

还有其他加密`web.config`文件的方法吗？（在线工具、远程工具、编程方式，或...）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:09:20.167

未经我测试，来自 CodeProject，希望它能工作 **Aspx 代码：**

```
 <asp:Button id="btnEncrypt" runat="server" Text="Encrypt" onclick="btnEncrypt_Click" />
 <asp:Button ID="btnDecrypt" runat="server" Text="Decrypt" onclick="btnDecrypt_Click" />

 Code Behind:

    string provider = "RSAProtectedConfigurationProvider";
    string section = "connectionStrings";
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void btnEncrypt_Click(object sender, EventArgs e)
    {
       Configuration confg = WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);
       ConfigurationSection configSect = confg.GetSection(section);
       if (configSect != null)
       {
          configSect.SectionInformation.ProtectSection(provider);
          confg.Save();
       }
    }

    protected void btnDecrypt_Click(object sender, EventArgs e)
    {
       Configuration config = WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath);
       ConfigurationSection configSect = config.GetSection(section);
       if (configSect.SectionInformation.IsProtected)
       {
          configSect.SectionInformation.UnprotectSection();
          config.Save();
       }
    } 
```

[http://www.codeproject.com/Tips/304638/Encrypt-or-Decrypt-Connection-Strings-in-web-confi](http://www.codeproject.com/Tips/304638/Encrypt-or-Decrypt-Connection-Strings-in-web-confi)

# python - 考虑到python中周围的窗口，在每个像素位置创建直方图

> ID：11636579
> 
> 赞同：0
> 
> 时间：2012-07-24T17:55:31.193
> 
> 标签：python, image, image-processing, histogram

考虑到像素的一些相邻窗口，我必须在每个像素处创建局部直方图。

```
numpy.histogram(image,bins=256) 
```

创建整个图像的直方图。我可以给它图像的特定部分，但我不想使用循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:04:49.987

此代码应该为您提供矩形中图像部分的直方图，其左上角为`(x1, y1)`，右下角为`(x2, y2)`：

```
numpy.histogram(image[x1:x2, y1:y2], bins=256) 
```

如果要对图像中的每个像素执行此操作，则必须使用循环。

# windows - 是否所有基于 Windows 的程序都使用 Windows API？没有它如何制作程序？

> ID：11636582
> 
> 赞同：2
> 
> 时间：2012-07-24T17:55:39.897
> 
> 标签：windows, api, dll, assembly, operating-system

我已经编程了几年，我知道如何使用预先存在的/标准库创建自己的复杂方法。我一直想知道（例如 Java）在 Java 中创建 JFrame 对象时如何创建 JFrame？您如何使用标准代码（无库）来编写 GUI 或创建文件、读取文件等复杂操作？

如果我们使用的所有这些现有方法都可以与我们用来构建金字塔的积木进行比较。首先这些块是如何创建的？（我的意思是技术上）。没有标准库的编程语言是变量、循环和数学（甚至数学函数都是由某人创建的）。

基本问题是 Java 或 C 或任何其他语言（例如在 Windows 上运行时）是否通过调用 Windows .dll 库来创建窗口和其他复杂操作来完成其所有操作？

如果是这样，这些复杂的操作/方法/函数是如何在只有常规变量、循环等的操作系统中创建的？

我对编程的理解存在差距。我了解计算机读取二进制（电=开/关），有人制作了汇编/汇编程序将二进制转换为更具可读性的代码，该代码从处理器中的不同寄存器移动数字，这可能导致基本的数学，加法，减法，乘法，除法。我理解的差距是从汇编跳转到像 C 这样的高级语言，它包含变量、循环、创建 GUIS、操作系统。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T20:04:44.163

我试图在这里（非常）粗略地说明连接 AFAIK

*   **硬件**=如果用他们的语言指示，他们可以实际做事，即以电脉冲（电压高/低）形式的 1 和 0 流；
*   **总线/网络**=供应/携带这些电脉冲
*   **控制单元**= 驻留在 CPU 中的重要硬件控制总线以路由信号/脉冲
*   **指令（机器代码）** = 控制单元可以理解的 1 和 0 流；这是由制造商预先确定的；这可以告诉控制单元如何使用 CPU 寄存器、内存和 I/O 设备（即计算机硬件）
*   **进程**= 驻留在内存中的指令集
*   **操作系统**= 允许访问硬件的进程集，可以通过对现有进程的系统调用来创建新进程。系统调用是人类可读的指令，最终被转换为机器代码
*   **目标文件/二进制文件/可执行文件**=当进程不在内存中且未执行但驻留在磁盘中时；CPU 指示 BIOS 查找操作系统加载程序，引导加载程序启动一个母进程以启动操作系统，并且该母进程从驻留在磁盘中的（内核）目标文件生成其他进程
*   **assembler** = 从汇编代码生成目标代码（文件）；汇编代码是直接人类可读的指令形式，执行所有这些存储、加载到 CPU 寄存器和内存、写入/发送信号到各种 I/O 设备
*   **编译器/解释器等**=最终将更多高级语言转换为指令（变量存储在内存中，循环转换为从内存中的一个位置到另一个位置的跳转，如果您有兴趣查看从简单 C 程序生成的汇编代码`gcc -S source.c -o assembly.s`）
*   **程序（源代码）** =人类和编译器都能理解的语言
*   **驱动程序**=用于与硬件通信的程序，它们产生这样的目标代码，其中包含处理特定硬件所需的指令；专有硬件不会透露其说明，因此您必须下载其二进制文件
*   **库/API** = 存储在磁盘上的一段目标代码/编译器可理解的代码，因此您无需在每次编写程序时都重新发明轮子

因此，当您从 Java 创建 GUI 时，它实际上是在请求您的窗口管理器通过其本机方法调用以“*绘制一个 20x20 圆角半径为 5px 的矩形*”形式创建 GUI ，窗口管理器正在将此请求转发给操作系统进程它通过驱动程序将适当的指令转发给控制单元，然后强大的 CU 将向您的显示器发送一些信号，为适当的像素着色，给您一种 GUI 的感觉。

[我知道我会因为像傻瓜一样回答和报告的题外问题而得到很多反对票：P]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:34:17.823

您的问题的答案非常广泛和通用，但我相信答案涉及对操作系统角色的理解。程序不能做任何操作系统不允许它们做的事情，并且从程序的角度来看，操作系统总是有一个定义好的接口。这个接口可能非常低级，如通过中断的系统调用，或者它可能处于更高级别，如 Win32 API。其中很多也与硬件和驱动程序有关，因为没有硬件就无法对程序进行输入和输出，硬件是通过操作系统从最终程序中抽象出来的。例如，nVidia 提供了由许多 API 抽象的 Windows 驱动程序：OpenGL、DirectX、WPF 等；如果您知道通过系统调用对视频卡驱动程序进行低级访问，您可以编写自己的 API。任何语言，例如 Java 或 C，都必须使用这些接口。

我希望这会有所帮助...

# java - 如何在 Facebook 广告标题中显示 & 符号

> ID：11636586
> 
> 赞同：1
> 
> 时间：2012-07-24T17:55:49.097
> 
> 标签：java, facebook, facebook-graph-api

我正在使用 Facebook 广告 API。我想在 Facebook 标题中显示 AT&T。当我不编码时，它会切断参数并只显示 AT，但是当我用 AT%26T 编码 AT&T 时，它会显示 AT%26T。我如何在 Facebook 广告中显示 AT&T。我将 Facebook 服务称为[https://graph.facebook.com/act_111111/adcreatives?type=1&title=](https://graph.facebook.com/act_111111/adcreatives?type=1&title=) ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:59:09.103

尝试对其进行两次编码，一次用于 URL，一次用于 HTML。

```
 https://graph.facebook.com/act_111111/adcreatives?type=1&title=AT%26amp%3BT 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T22:33:19.660

您不必在 HTML 中将 AT&T 编码为 AT&T 吗？注意添加的';'

# c# - TypeLoadExpection，不能使用我项目中的库中的类型

> ID：11636591
> 
> 赞同：0
> 
> 时间：2012-07-24T17:56:20.807
> 
> 标签：c#, types

我正在制作某种游戏引擎。我遇到了 TypeLoadExpection 的问题。这是我的解决方案资源管理器的外观：

[http://screenshooter.net/data/uploads/rc/sg/cohk.jpg](http://screenshooter.net/data/uploads/rc/sg/cohk.jpg)（我将其作为链接发布，因为我没有足够的代表。）

如果我在 PolyEngineRuntime 中使用 PolyEngine 中的任何类型，我将得到 TypeLoadExpection！我不知道为什么会这样。如果它有助于解决问题，我可以发布代码，但我认为代码不会有用。

编辑：这里的代码： http: [//pastebin.com/M508FhAC](http://pastebin.com/M508FhAC)

Log 是 PolyEngine 的一个静态类。

以下是预期的样子：

无法从程序集“PolyEngine，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”加载类型“PolyEngine.Log”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:01:10.993

很可能由于某种原因，PolyEngine DLL 不会自动复制到 PolyEngineRuntime 的 /bin 文件夹中。或者，如果 PolyEngineRuntime 使用来自另一个程序集的类型，则缺少外部 DLL。

构建完成后，确认所有 *.dll 都在 PolyEngineRuntime 的 /bin 文件夹中，您可以从该文件夹中运行应用程序。

# php - CodeIgniter 函数不带参数

> ID：11636596
> 
> 赞同：-1
> 
> 时间：2012-07-24T17:56:31.547
> 
> 标签：php, oop, codeigniter, function

我定义了这个函数

```
function login_user($emailusername, $password) { } 
```

该函数使用变量但是，当我尝试使用它调用它时

```
$this->login->login_user('username', 'password'); 
```

它返回一个错误，指出这些变量在函数中未定义。

编辑：我在登录模型中设置功能

我收到这些错误：

> 遇到 PHP 错误严重性：通知消息：未定义索引：密码文件名：models/login.php 行号：20
> 
> 第 20 行：$pass = crypt($password, $hash['password']);
> 
> 遇到 PHP 错误严重性：通知消息：未定义索引：用户名文件名：models/login.php 行号：26
> 
> 第 26 行： if ($user_data['username'] == $emailusername || $user_data['email'] == $emailusername) {
> 
> 遇到 PHP 错误严重性：通知消息：未定义索引：电子邮件文件名：models/login.php 行号：26
> 
> 第 26 行： if ($user_data['username'] == $emailusername || $user_data['email'] == $emailusername) {

这是功能

```
 function login_user($emailusername, $password) {
        //To initiate session set this cookie
        $query = $this->db->query("SELECT password FROM usrs WHERE username = '$emailusername' or email = '$emailusername'"); 

        $hash = $query->result();

        $pass = crypt($password, $hash['password']);

        $nq = $this->db->query("SELECT usr_id, username, email from usrs WHERE email = '$emailusername' or username = '$emailusername' and password = '$pass'");
        $user_data = $nq->result(); 

        if($emailusername&&$password) {
            if ($user_data['username'] == $emailusername || $user_data['email'] == $emailusername) {
                if($hash['password'] == $pass) {

                    $_SESSION['login'] = True;
                    $_SESSION['uid'] = $user_data['usr_id'];
                    $_SESSION['username'] = $user_data['username'];

                    return True;
                } else
                    return False; 
            } else
                return False;
        } else 
            return False; 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T19:43:11.580

此错误不在您的变量中。您的 $hash 表中没有索引 calldes 'password'；首先检查你的 $hash 表。

```
$hash = $query->result(); 
```

函数返回对象数组组成

```
$hash->password = ''; 
```

如果要获得单行并且结果是数组，请使用 row_array() 函数

```
$hash = $query->row_array(); 
```

这返回

```
$hash['password'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T19:48:26.090

问题源于这一行：

```
$hash = $query->result(); 
```

[根据文档](http://codeigniter.com/user_guide/database/results.html)，`result()`执行以下操作：

> 此函数将查询结果作为**对象**数组返回，或者在失败时返回**空数组。**通常，您将在 foreach 循环中使用它...

因此，`$hash`不包含名为`password`,`username`或`email`- 因此您收到的错误消息的索引。

如果您只关心从该查询返回的第一行（这是我的假设），您可以使用`row_array()`仅返回第一条记录并*作为数组*，这将使这些索引可用，如下所示：

```
$hash = $query->row_array();
// $hash['password'], $hash['username'], and $hash['email'] are now available 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T19:05:37.387

考虑到您正在使用 codeignitor，如果该功能在控制器“登录”中，则使用

```
$this->login_user('username', 'password'); 
```

如果函数在库中，请确保您已加载库并且实例的名称是“登录”

如果您直接包含文件，那么只需创建一个对象并调用该方法

```
$loginObj = new login();
$loginObj->login_user('username', 'password'); 
```

干杯，

韦当

# azure - 尝试通过部署在 tomcat 中的 Web 应用程序连接到 Azure 服务管理 API

> ID：11636600
> 
> 赞同：1
> 
> 时间：2012-07-24T17:56:53.517
> 
> 标签：azure, virtual-machine, keystore

我无法通过部署在 tomcat 中的 webapp 连接到 Azure。

尽管我正在为密钥库密码发送正确的输入，但我收到了以下错误。

“密钥库被篡改，或密码不正确”

请评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T21:21:57.063

当您尝试使用服务管理 API 连接到 Windows Azure 管理门户时，将通过 SSL 隧道创建连接，并使用证书来创建 SSL 隧道。

我首先建议，这不是 Windows Azure 特定的问题，它更多的是与 Java/Tomcat 相关的问题，主要是因为在选择证书来创建 SSL 隧道时，代码遇到了一些问题。

为了解决这个问题，我可以提出以下建议：

*   在运行 Tomcat Web 应用程序的 VM/物理机中，首先尝试找到物理密钥库文件并将其删除。
*   之后尝试使用正确的密码创建密钥库并在您的 Tomcat 配置中正确设置该密码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T05:35:53.517

错误地提供了 Trustcacerts 密码！现在它可以工作了

# asp.net-mvc-4 - webapi IPrincipal 和授权

> ID：11636605
> 
> 赞同：3
> 
> 时间：2012-07-24T17:57:11.190
> 
> 标签：asp.net-mvc-4, asp.net-web-api

这是关于安全 MVC4 RC 和“Install-Package Microsoft.AspNet.WebApi”的。

我创建了一个自定义身份：System.Security.Principal.IIdentity，我在身份验证 cookie 中存储了一些有价值的字符串和整数：

```
 [Serializable]
public class SiteIdentity : IIdentity
{
    public SiteIdentity(string name, string displayName, int userId, int siteId)
    {
        this.Name = name;
        this.DisplayName = displayName;
        this.UserId = userId;
        this.SiteId = siteId;

    }

    public SiteIdentity(string name, UserInfo userInfo)
        : this(name, userInfo.DisplayName, userInfo.UserId, userInfo.SiteId)
    {
        if (userInfo == null) throw new ArgumentNullException("userInfo");
        this.AuthenticationType = userInfo.AutheticationType;
        this.ClaimsIdentifier = userInfo.ClaimsIdentifier;
    }

    public SiteIdentity(FormsAuthenticationTicket ticket)
        : this(ticket.Name, UserInfo.FromString(ticket.UserData))
    {
        if (ticket == null) throw new ArgumentNullException("ticket");
    } 
```

...不完整，但我想你猜。

但首先是我的 webapi 控制器的结构。我创建并扩展了控制器，从那里我扩展了我所有的 webapi 控制器：

```
 public class _AuthorizedApiController : ApiController
{

        protected readonly Site.Web.Domain.Services.IUserServices _userServices;

        public _AuthorizedApiController(Site.Web.Domain.Services.IUserServices userServices)
        {
            if (userServices == null) throw new ArgumentNullException("userServices");
            this._userServices = userServices;

        }

        protected int CurrentUserId
        {
            get { return this.User.SiteIdentity().UserId; }
        }

        private Site.Web.Domain.Models.User currentUser;

        public Site.Web.Domain.Models.User CurrentUser
        {
            get
            {
                return this.currentUser ??
                       (this.currentUser = this._userServices.GetUserFromIdentity(this.User.SiteIdentity()));
            }
        }

        protected int CurrentSiteId
        {
            get { return this.User.SiteIdentity().SiteId; }
        }

} 
```

所以我的 webapi 控制器是：

```
 public class ServicioController : _AuthorizedApiController
{
    //http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api
    //http://www.asp.net/web-api/overview/web-api-routing-and-actions/exception-handling

    static readonly IServicioStatusRepository repositoryServicioStatus = 
        new ServicioStatusRepository(new Site.Web.Data.DatabaseFactory());

    public ServicioController(Site.Web.Domain.Services.IUserServices userServices)
    : base(userServices)
    {

    }

    public IEnumerable<ServicioStatusA> GetServiciosStatus()
    {
        IEnumerable<ServicioStatusA> coleccion;
        var estevalor = CurrentUser.SiteId;
     } 
```

如您所见，我使用 IoC，但问题是当我尝试读取 CurrentUser.SiteId 时。我收到此错误：

无法将“System.Web.Security.FormsIdentity”类型的对象转换为“Site.Web.Models.SiteIdentity”类型。

在这个返回函数中：

```
 public static Site.Web.Models.SiteIdentity SiteIdentity(this System.Security.Principal.IPrincipal principal)
    {
        return (Site.Web.Models.SiteIdentity)principal.Identity;
    } 
```

我在 global.asax.cs 中使用这个“工件”来保存会话和信息：

```
 public override void Init()
    {
        this.PostAuthenticateRequest += this.PostAuthenticateRequestHandler;
        //            this.EndRequest += this.EndRequestHandler;

        base.Init();
    }

    private void PostAuthenticateRequestHandler(object sender, EventArgs e)
    {
        if (IsWebApiRequest())
        {
            string esto = "popopopopo";
        }

        HttpCookie authCookie = this.Context.Request.Cookies[FormsAuthentication.FormsCookieName];
        if (IsValidAuthCookie(authCookie))
        {
            // var formsAuthentication = ServiceLocator.Current.GetInstance<IFormsAuthentication>();
            var formsAuthentication = new FormsAuthenticationService();

            var ticket = formsAuthentication.Decrypt(authCookie.Value);
            var siteIdentity = new SiteIdentity(ticket);
            this.Context.User = new GenericPrincipal(siteIdentity, null);

            // Reset cookie for a sliding expiration.
            formsAuthentication.SetAuthCookie(this.Context, ticket);
        }
    } 
```

我猜是，当有一个“正常”的 MVC 调用时，每个都可以正常工作，但是当有一个 webapi 调用时，我可以从 cookie 中恢复所有内容，但我有：

System.Security.Principal.GenericPrincipal + 身份：Site.Web.Model.SiteIdentity

代替 ：

System.Security.Principal.GenericPrincipal + 身份：System.web.security.FormsIdentity

预先感谢您对我们的支持

ADEN-UM：

谷歌搜索我也尝试将身份保留在线程中，所以在 PostAuthenticateRequestHandler 中我输入：

```
 System.Threading.Thread.CurrentPrincipal = this.Context.User; 
```

但现在我在任何请求中都有以下错误，不仅是webapi：

```
 [SerializationException: Type is not resolved for member 'Site.Web.Models.SiteIdentity,Site.Web, Version=1.0.0.0, Culture=neutral,PublicKeyToken=null'.]
   Microsoft.VisualStudio.WebHost.Connection.get_RemoteIP() +0
   Microsoft.VisualStudio.WebHost.Request.GetRemoteAddress() +65
   System.Web.HttpRequest.get_IsLocal() +23
   System.Web.Configuration.CustomErrorsSection.CustomErrorsEnabled(HttpRequest request) +86
   System.Web.HttpContextWrapper.get_IsCustomErrorEnabled() +45
   System.Web.Mvc.HandleErrorAttribute.OnException(ExceptionContext filterContext) +72
   System.Web.Mvc.ControllerActionInvoker.InvokeExceptionFilters(ControllerContext controllerContext, IList`1 filters, Exception exception) +115
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +105
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +57
   System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult) +45
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +14
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +61
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +49
   System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult asyncResult) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__4(IAsyncResult asyncResult) +28
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +25
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970061
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

# image - 图像像素重定位

> ID：11636608
> 
> 赞同：0
> 
> 时间：2012-07-24T17:57:12.640
> 
> 标签：image

我有一个*n* x *m* x 3 矩阵，其中当前位置与图像来源有关。我正在尝试将图像映射到另一个来源。图像大小为*n* x *m*，我分别有第一层和第二层像素的空间`x`和`y`位置，以及第三层像素的强度值。我需要以某种方式重新组织像素并根据存储在前两层中的空间位置显示它们。

这意味着在`img(i,j,:)`我有`x`位置、`y`位置和灰度像素值。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T16:15:33.010

我不确定我是否正确。
1- 在第一层获取最小和最大 x
2- 在第二层获取最小和最大 y
3- 在第三层获取最小和最大强度
4- 创建足够大的图像以处理所有 x、y、强度。
（如果您对图像大小有限制，这可能涉及平移/缩放）
5- 然后在图像中绘制所有 (x,y,i)。

# cross-browser - 通过查看代码的自动浏览器互操作性测试器

> ID：11636609
> 
> 赞同：0
> 
> 时间：2012-07-24T17:57:13.500
> 
> 标签：cross-browser, interop, browser

假设我已经有有效的代码，是否有一个工具或插件可以用来评估我的网站代码并突出显示不同浏览器可能以不同方式显示代码的区域？我知道[browsershots](http://browsershots.org/)之类的网站，并且我有要测试的VM，但我想知道是否有一些东西可以通过查看代码和众所周知的跨浏览器兼容性红旗警告来缩短流程。

例如，当使用尚未普遍支持的 CSS 时。以下是有效的 CSS 2.1：

```
display: run-in; 
```

知道 CSS 2.1 的验证器会以优异的成绩通过它，但实际上，应该抛出一个红旗，表明它在 Firefox 3 中不起作用。另一方面，

```
border-radius: 10px; 
```

实际上在更新的浏览器中得到了很好的支持，即使它是 CSS3。

这是 Javascript 中的新功能，但也由验证器传递：

```
getElementsByClassName(); 
```

但如果弹出警告通知我它在 IE8 中不起作用会更好。

另一个例子是众所周知的渲染错误，它可以由奇怪（有效）的情况触发。我知道在每个系统上的每个浏览器中打开网站以真正了解其工作原理是无可替代的，但我只是想知道是否有一些工具可以帮助检查我是否正在编写可互操作的代码，这样我就可以在开发过程中更频繁地进行测试，并在以后花更少的时间解决错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T14:57:20.587

不幸的是，答案是否定的。

我曾经开始研究完全按照您的描述创建工具。现实情况是，像 jQuery 这样的大多数库实际上**都利用**了浏览器的不兼容性和对标准的不同解释（或忽略了标准）。

因此，如果您使用任何标准库，那么您会收到大量警告并且实际上从中得到的很少。垃圾邮件的数量只会掩盖您可能引入的实际错误。

更重要的是不兼容是否真的会影响最终结果。因此，我们采用了所见即所得的测试方法，而不是静态代码分析。

# java - 内部 Servlet 映射 - web.xml

> ID：11636612
> 
> 赞同：2
> 
> 时间：2012-07-24T17:57:24.500
> 
> 标签：java, web-services, jsp, servlets

我想知道是否有任何方法可以创建只能在 web 应用程序中访问的 servlet 映射。例如，此应用程序中的一个文件调用另一个文件，但它不能从 Web 应用程序外部访问。

谢谢你，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T22:47:24.207

是的，有办法。将受限制的 jsp 文件放在 web-inf 目录中。然后将这些jsp导入其他jsp是完全合法的，不会给您带来任何问题。

请参阅下面的示例 jsp：

```
<%@page import="admin.*"%>
<%@ taglib uri="/WEB-INF/struts-tiles.tld" prefix="tiles" %>
<tiles:insert template='myTemplate.jsp'>
  <tiles:put name='top' content='/WEB-INF/templates/top.jsp''/>  
  <tiles:put name='main' content='/WEB-INF/templates/main.jsp''/>  
  <tiles:put name='footer' content='/WEB-INF/templates/footer.jsp'/>
</tiles:insert> 
```

# mysql - MySQL - 选择所有 UNLESS 查询

> ID：11636613
> 
> 赞同：0
> 
> 时间：2012-07-24T17:57:32.337
> 
> 标签：mysql

我有一个使用作品的查询，但现在我需要对其进行修改，以便在字段中有特定数据的情况下排除行。

这是当前代码：

```
SELECT oc_ieentry,oc_sysitem,oc_item,oc_itemdesc,oc_purchasedate,oc_url
FROM catalog
WHERE oc_purchasedate >= date_sub(current_date, interval 21 day)
ORDER BY oc_item ASC 
```

我需要做的是在其中添加一条语句，如果 oc_ieentry LIKE 1，则不应显示这些行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:00:18.897

试试这个：

```
SELECT 
oc_ieentry,oc_sysitem,oc_item,oc_itemdesc,oc_purchasedate,oc_url 
FROM catalog 
WHERE (oc_purchasedate >= date_sub(current_date, interval 21 day)) 
AND (oc_ieentry NOT LIKE 1) 
ORDER BY oc_item ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:00:26.057

您可以在子句中添加另一个条件`WHERE`，例如：

```
SELECT oc_ieentry,oc_sysitem,oc_item,oc_itemdesc,oc_purchasedate,oc_url
FROM catalog
WHERE
    oc_purchasedate >= date_sub(current_date, interval 21 day)
    AND oc_ieentry != 1
ORDER BY oc_item ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:00:14.127

为您的 WHERE 添加额外条件？

```
...
WHERE oc_purchasedate >= date_sub(current_date, interval 21 day) AND oc_ieentry <> 1
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:01:19.407

您可以在 WHERE 子句中使用 NOT 关键字：

```
SELECT * from products WHERE prod_price NOT IN (49, 100, 999); 
```

它对你有帮助吗？

# r - 如何返回包含最大值标签的向量

> ID：11636620
> 
> 赞同：3
> 
> 时间：2012-07-24T17:44:41.850
> 
> 标签：r, function

我有一个 4 列数组，我想为每一行获取一个向量，该向量包含包含该行最大值的列标签。

我可以循环执行此操作，但我想使用矩阵函数来提高速度。

如果不编写自己的 lib 函数，我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T17:57:56.523

有一个函数可以做到这一点。如果`x`是您的矩阵，请尝试`max.col(x)`.

# ruby - Watir StaleElementReferenceError 在框架中的形式

> ID：11636624
> 
> 赞同：0
> 
> 时间：2012-07-24T17:58:40.323
> 
> 标签：ruby, frame, watir, watir-webdriver

我只是在检查页面上是否存在元素：

```
sleep 5 # for the page load
form.wait_until_present
next if form.span(:class => "SSSMSGWARNINGTEXT").exists? 
```

`form`来自这两行：

```
browser.goto browser.frame(:name => "TargetContent").src
form = browser.form(:name => "win1") 
```

前一页和当前页都`form`存在，所以我添加了一个 sleep 以确保它有新页。但是，我的程序仍然因错误而崩溃：

```
[remote server] resource://fxdriver/modules/web_element_cache.js:5665:in `unknown': Element not found in the cache - perhaps the page has changed since it was looked up (Selenium::WebDriver::Error::StaleElementReferenceError)
from [remote server] file:///var/folders/80/_bwll9x91h7d6c5dp2d3fbb00000gr/T/webdriver-profile20120724-63693-194o52g/extensions/fxdriver@googlecode.com/components/driver_component.js:5354:in `unknown'
from [remote server] file:///var/folders/80/_bwll9x91h7d6c5dp2d3fbb00000gr/T/webdriver-profile20120724-63693-194o52g/extensions/fxdriver@googlecode.com/components/driver_component.js:6597:in `unknown'
from [remote server] file:///var/folders/80/_bwll9x91h7d6c5dp2d3fbb00000gr/T/webdriver-profile20120724-63693-194o52g/extensions/fxdriver@googlecode.com/components/driver_component.js:471:in `unknown'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/response.rb:52:in `assert_ok'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/response.rb:15:in `initialize'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:59:in `new'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:59:in `create_response'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:65:in `request'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:40:in `call'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:576:in `execute'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:542:in `find_element_by'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/search_context.rb:42:in `find_element'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/watir-webdriver-0.6.1/lib/watir-webdriver/locators/element_locator.rb:85:in `find_first_by_multiple'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/watir-webdriver-0.6.1/lib/watir-webdriver/locators/element_locator.rb:32:in `locate'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:384:in `locate'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:362:in `assert_exists'
from /Users/amosng/.rvm/gems/ruby-1.8.7-p370/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:37:in `exists?'
from ./my-script.rb:123:in `foo' 
```

当我只是想知道某个元素是否存在时，有什么可能让它抛出错误？

**编辑**：所以似乎将等待时间延长到 10 秒可以解决问题。由于该页面上有一堆Javascript，我想页面在执行时可能没有开始重新加载`form.wait_until_present`，并且在`next if form.span(:class => "SSSMSGWARNINGTEXT").exists?`执行时，表单不再存在于加载页面之间。至少这是我能想到这次崩溃的唯一原因......

但问题是，我有几个地方像这样重新加载页面。在任何地方增加 10 秒的睡眠时间会减慢它到令人难以忍受的爬行速度。如何让程序检测页面何时完全重新加载？

**编辑 2**`form` ：每次重新加载页面时都尝试设置：

```
 ...
    form = browser.form(:name => "win1")
    form.wait_until_present
    form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_CLASS_SRCH").click
    form = browser.form(:name => "win1")
    form.wait_until_present
    form.input(:id => "#ICSave").click if form.input(:id => "#ICSave").exists?
    form = browser.form(:name => "win1")
    form.wait_until_present
    ... 
```

还是类似的错误：

```
[remote server] resource://fxdriver/modules/web_element_cache.js:5665:in `unknown': Element not found in the cache - perhaps the page has changed since it was looked up (Selenium::WebDriver::Error::StaleElementReferenceError)
    from [remote server] file:///var/folders/80/_bwll9x91h7d6c5dp2d3fbb00000gr/T/webdriver-profile20120725-47093-y3nzl8/extensions/fxdriver@googlecode.com/components/driver_component.js:5354:in `unknown'
    from [remote server] file:///var/folders/80/_bwll9x91h7d6c5dp2d3fbb00000gr/T/webdriver-profile20120725-47093-y3nzl8/extensions/fxdriver@googlecode.com/components/driver_component.js:6597:in `unknown'
    from [remote server] file:///var/folders/80/_bwll9x91h7d6c5dp2d3fbb00000gr/T/webdriver-profile20120725-47093-y3nzl8/extensions/fxdriver@googlecode.com/components/driver_component.js:471:in `unknown'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/response.rb:52:in `assert_ok'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/response.rb:15:in `initialize'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:59:in `new'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:59:in `create_response'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/default.rb:65:in `request'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/http/common.rb:40:in `call'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:576:in `execute'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/remote/bridge.rb:542:in `find_element_by'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/selenium-webdriver-2.25.0/lib/selenium/webdriver/common/search_context.rb:42:in `find_element'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/watir-webdriver-0.6.1/lib/watir-webdriver/locators/element_locator.rb:247:in `by_id'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/watir-webdriver-0.6.1/lib/watir-webdriver/locators/element_locator.rb:26:in `locate'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:384:in `locate'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:362:in `assert_exists'
    from /Users/amosng/.rvm/gems/ruby-1.9.3-p194/gems/watir-webdriver-0.6.1/lib/watir-webdriver/elements/element.rb:95:in `click'
    from my-script.rb:471:in `block (2 levels) in foo'
    ... 
```

**编辑 3**：这是整个测试脚本：

```
require 'watir-webdriver'

def foo
  browser = Watir::Browser.new
  browser.driver.manage.timeouts.implicit_wait = 3
  browser.goto "http://schedule.arizona.edu"
  browser.form(:name => "win1").select_list(:name => "CLASS_SRCH_WRK2_STRM$54$").option(:index => 2).select
  browser.goto browser.frame(:name => "TargetContent").src
  form = browser.form(:name => "win1")
  term_select_list = form.select_list(:name => "CLASS_SRCH_WRK2_STRM$54$")
  (1..browser.form(:name => "win1").select_list(:name => "CLASS_SRCH_WRK2_STRM$54$").options.count - 1).each do |term_index|
    (1..term_select_list.options.count - 1).each do |subj_index|
      term_select_list.option(:index => term_index).select
      sleep 1
      form.select_list(:name => "CLASS_SRCH_WRK2_SUBJECT$67$").option(:index => subj_index).select
      sleep 1
      form.checkbox(:id => "CLASS_SRCH_WRK2_SSR_OPEN_ONLY").click
      sleep 1
      form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_CLASS_SRCH").click
      sleep 1
      form.input(:id => "#ICSave").click if form.input(:id => "#ICSave").exists?
      sleep 10
      form.wait_until_present
      next if form.span(:class => "SSSMSGWARNINGTEXT").exists?
      puts "got the form I want!!! do something with it: #{form.html[0..10]}"
      form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_NEW_SEARCH").click
      sleep 1
      form.wait_until_present
    end
  end
  browser.close
  GC.start
end

foo 
```

直到达到 ACCT 才会崩溃，但是当它达到 ACCT 时，它会可靠地崩溃（对我来说），尽管这可能只是因为 1 秒的睡眠时间不够长。

`form.wait_until_present`使用而不是任意睡眠的脚本：

```
require 'watir-webdriver'

def foo
  browser = Watir::Browser.new
  browser.driver.manage.timeouts.implicit_wait = 3
  browser.goto "http://schedule.arizona.edu"
  browser.form(:name => "win1").select_list(:name => "CLASS_SRCH_WRK2_STRM$54$").option(:index => 2).select
  browser.goto browser.frame(:name => "TargetContent").src
  form = browser.form(:name => "win1")
  term_select_list = form.select_list(:name => "CLASS_SRCH_WRK2_STRM$54$")
  (1..browser.form(:name => "win1").select_list(:name => "CLASS_SRCH_WRK2_STRM$54$").options.count - 1).each do |term_index|
    (1..term_select_list.options.count - 1).each do |subj_index|
      term_select_list.option(:index => term_index).select
      form = browser.form(:name => "win1")
      form.wait_until_present
      form.select_list(:name => "CLASS_SRCH_WRK2_SUBJECT$67$").option(:index => subj_index).select
      form = browser.form(:name => "win1")
      form.wait_until_present
      form.checkbox(:id => "CLASS_SRCH_WRK2_SSR_OPEN_ONLY").click
      form = browser.form(:name => "win1")
      form.wait_until_present
      form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_CLASS_SRCH").click
      form = browser.form(:name => "win1")
      form.wait_until_present
      form.input(:id => "#ICSave").click if form.input(:id => "#ICSave").exists?
      form = browser.form(:name => "win1")
      form.wait_until_present
      next if form.span(:class => "SSSMSGWARNINGTEXT").exists?
      puts "got the form I want!!! do something with it: #{form.html[0..10]}"
      form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_NEW_SEARCH").click
      form = browser.form(:name => "win1")
      form.wait_until_present
    end
  end
  browser.close
  GC.start
end

foo 
```

甚至在到达 ABE 之前就崩溃了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T02:02:44.733

有时最好等待某事消失而不是某事出现。在这种情况下，当进行 ajax 调用时，您会得到一个方便的徽标，表明页面正在加载。将所有内容替换`sleep 1`为以下内容即可完成脚本而不会出现错误。

```
browser.image(:id, 'processing').wait_while_present 
```

结果似乎有点奇怪，但以下脚本不再遇到您遇到的异常。希望这至少可以帮助您继续前进。

```
require 'watir-webdriver'

def foo
  browser = Watir::Browser.new
  browser.driver.manage.timeouts.implicit_wait = 3
  browser.goto "http://schedule.arizona.edu"
  browser.form(:name => "win1").select_list(:name => "CLASS_SRCH_WRK2_STRM$54$").option(:index => 2).select
  browser.goto browser.frame(:name => "TargetContent").src
  form = browser.form(:name => "win1")
  term_select_list = form.select_list(:name => "CLASS_SRCH_WRK2_STRM$54$")
  (1..browser.form(:name => "win1").select_list(:name => "CLASS_SRCH_WRK2_STRM$54$").options.count - 1).each do |term_index|
    (1..term_select_list.options.count - 1).each do |subj_index|
      term_select_list.option(:index => term_index).select
      browser.image(:id, 'processing').wait_while_present
      form.select_list(:name => "CLASS_SRCH_WRK2_SUBJECT$67$").option(:index => subj_index).select
      browser.image(:id, 'processing').wait_while_present
      form.checkbox(:id => "CLASS_SRCH_WRK2_SSR_OPEN_ONLY").click
      browser.image(:id, 'processing').wait_while_present
      form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_CLASS_SRCH").click
      browser.image(:id, 'processing').wait_while_present
      form.input(:id => "#ICSave").click if form.input(:id => "#ICSave").exists?
      browser.image(:id, 'processing').wait_while_present
      form.wait_until_present
      next if form.span(:class => "SSSMSGWARNINGTEXT").exists?
      puts "got the form I want!!! do something with it: #{form.html[0..10]}"
      form.a(:id => "CLASS_SRCH_WRK2_SSR_PB_NEW_SEARCH").click
      browser.image(:id, 'processing').wait_while_present
      form.wait_until_present
    end
  end
  browser.close
  GC.start
end

foo 
```

# objective-c - 在 Safari 中从表详细信息视图显式打开链接

> ID：11636625
> 
> 赞同：0
> 
> 时间：2012-07-24T17:58:43.123
> 
> 标签：objective-c, ios5, uiwebview, safari, uiwebviewdelegate

全部，

我的 UITableView 的详细视图中有丰富的文本和链接：

![在此处输入图像描述](../Images/5b22cc79e610d26ba25c70c287927e33.png)

按下链接时，URL 会加载到显示富文本的 UIWebView 中。我希望 URL 在 Safari 中打开。

有人能告诉我如何正确地做到这一点吗？是否有适合此目的的 UIWebView 委托方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:01:02.543

```
// where url is an NSURL

[[UIApplication sharedApplication] openURL:url]; 
```

这将在默认操作系统浏览器中打开链接。

文档[在这里](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006728-CH3-SW14)。

# php - 如何改进这个正则表达式？它在非常短的文本上达到 PHP 的 PREG_BACKTRACK_LIMIT_ERROR

> ID：11636626
> 
> 赞同：2
> 
> 时间：2012-07-24T17:58:43.350
> 
> 标签：php, regex

以下正则表达式：

```
$common_tlds = 'us|me|com|net|org|ly|be|edu|gov|uk|ca|de|jp|fr|au|ru|ch|it|nl|se|no|es|mil|co';

$regex = '#(?:https?://)?([^.\s]+(?:[^\s.]|[^\s][^\s.])*\.(?:' . $common_tlds . ')[^.\s]*)#i'; 
```

在这里使用：

```
preg_replace($regex,'<a href="http://$1" target="_blank">$1</a>', $text); 
```

给我一个`PREG_BACKTRACK_LIMIT_ERROR`很短的文字。一个示例文本是：

`Life cant always give you the best shoes,handbags,clothes but it can give you the best creations.`

我知道，有更好的链接在线查找正则表达式，但我很好奇我的正则表达式中的什么导致大量回溯以及如何改进它。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:03:55.023

尝试这样的事情：

```
$regex = '#(?:https?://)?([^.\s]+(?:\.[^.\s]+)*\.(?:' . $common_tlds . '))#i'; 
```

评论：

*   您正在看到[灾难性的回溯](http://www.regular-expressions.info/catastrophic.html)- 您的模式有太多无法匹配字符串的方法。
*   `[^.\s]+(?:\.[^.\s]+)*`只允许一种匹配域的方式，锚定在点上。
*   `[^.\s]*`- 从最后删除，不确定在 tld 之后应该做什么。如果你想匹配类似的域`.co.il`，你可能需要另一个点：`(?:\.[^.\s]+)?`
*   您可能需要 a`\b`在开头，以避免匹配`(google.com`.

# mercurial - 果园的 hgignore

> ID：11636631
> 
> 赞同：0
> 
> 时间：2012-07-24T17:59:02.170
> 
> 标签：mercurial, orchardcms

我只是第一次测试 Mercurial。有人能告诉我在 .hgignore 文件中放什么吗？- 也许在这里发布一个样本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:06:24.843

hgignore[手册页](http://www.selenic.com/mercurial/hgignore.5.html)解释了在 .hgignore 文件中放入的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-23T10:39:33.240

Orchard 模块只是一个 .Net 项目，因此任何 .Net/C# .hgignore 也可以满足您的目的。我现在正在使用[这个 stackoverflow 帖子](https://stackoverflow.com/questions/4095696/mercurial-hgignore-for-visual-studio-2010-projects)中的一个。检查您正在使用的 Visual Studio 版本，因为还有其他专门针对 2012 和 2013 的版本。

# jquery - 当名称包含单引号时 rel='imageName' 出现问题

> ID：11636637
> 
> 赞同：3
> 
> 时间：2012-07-24T17:59:28.363
> 
> 标签：jquery, mysql, html, rel

我的页面上有一张表格，显示卡名、费用、套装、稀有度。此信息来自数据库表。当用户将鼠标悬停在表格中的任何卡片名称上时，卡片会弹出一个图像，一旦鼠标移开，图像就会关闭（为此使用 jQuery 脚本）。

这是卡片名称单元格的代码：

```
<td><a href='#' class='screenshot' rel='cards/$cardname.jpg'>$cardname</a></td> 
```

一切正常，除非 $cardname 包含 ' 这会弄乱代码并阻止图像显示（卡名不工作的示例可能是“Faith's Shield”）。我尝试使用 ´ 代替，但这似乎也不起作用。

我知道这可能不是实现我想要做的事情的最佳方式，但我对网络编程很陌生，这似乎是一个让它工作的简单技巧。

```
print "<table id='cardTable'>
                <tr>
                    <th>Add to deck</th>
                    <th>Cardname</th>
                    <th>Cost</th>
                    <th>Set</th>
                    <th>Rarity</th>
                </tr>";

        while ($row = mysql_fetch_array($result)) {
            $cardname = $row['cardname'];
            $cost = $row['cost'];
            $set = $row['set'];
            $rarity = $row['rarity'];
            $idCard = $row['idCard'];

            print "<tr>
                    <td>
                    <form action='' method='post'>
                    <p><button type='submit' name='addCard' class='addCard' value='$idCard' title='Add card to deck'></button>
                    <select name='amount'>
                    <option value='1'>1</option>
                    <option value='2'>2</option>
                    <option value='3'>3</option>
                    <option value='4'>4</option>
                    </select></p>
                    </form>
                    </td>
                    <td><a href='#' class='screenshot' rel='cards/$cardname.jpg'>$cardname</a></td>
                    <td>$cost</td>
                    <td>$set</td>
                    <td>$rarity</td>
                </tr>";

        }
            print "</table>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:02:09.447

尝试用双引号将属性值括起来（attrib="value"）。那么值中是否有单引号就无关紧要了。此外，将值内的双引号替换为

```
&quot; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:04:43.447

```
<td>
    <a href='#' class='screenshot' rel='cards/<?php echo str_replace("'", '', $cardname); ?>.jpg'></a>
</td> 
```

更合适的是，正如 Felix 所建议的那样使用`htmlspecialchars`，这将转换所有特殊字符..

```
<td>
    <a href='#' class='screenshot' rel='cards/<?php echo htmlspecialchars($cardname); ?>.jpg'></a>
</td> 
```

# asp.net-mvc-3 - 代码优先参考表

> ID：11636640
> 
> 赞同：0
> 
> 时间：2012-07-24T17:59:36.000
> 
> 标签：asp.net-mvc-3, entity-framework, ef-code-first, code-first

我目前正在为我的模型上的一些映射属性而苦苦挣扎。这是我的两个模型。我要做的是在我的表中只有唯一的 PersonTypes（即 MD、Nurse），并且人员模型引用这些 personTypes。

```
public partial class Person
{
    public Person()
    {
        this.PersonTypes = new List<PersonType>();
        this.Contacts = new List<Contact>();
    }

    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    public int FacilityId { get; set; }

    [DataType(DataType.Text), MaxLength(200), Required]
    public string FirstName { get; set; }

    [DataType(DataType.Text), MaxLength(200)]
    public string MiddleName { get; set; }

    [DataType(DataType.Text), MaxLength(200), Required]
    public string LastName { get; set; }

    public int? SpecialtyId { get; set; }

    public bool IsEnabled { get; set; }

    // Mapped Properties

    [ForeignKey("FacilityId")]
    public virtual Facility Facility { get; set; }

    [ForeignKey("SpecialtyId")]
    public virtual Specialty Specialty { get; set; }

    public virtual ICollection<PersonType> PersonTypes { get; set; }

    public virtual ICollection<Contact> Contacts { get; set; }
}

public partial class PersonType
{
    public PersonType()
    {
    }

    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    [DataType(DataType.Text), MaxLength(200), Required]
    public string Name { get; set; }

    public bool IsEnabled { get; set; }
} 
```

Person1 = MD，护士 - Person2 = MD - Person3 = 护士，CNP

我不想在上面的例子中的 PersonType 表中有 MD 2 次。这可能吗。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:09:55.453

从您的示例中，我了解到您在 Persons 和 PersonTypes 之间具有多对多关系。要让 EF CodeFirst 理解这一点，您必须在 PersonType: 中创建对称导航属性`public virtual ICollection<Person> Persons`。

# ios - 使用 beginBackgroundTaskWithExpirationHandler 删除陈旧的核心数据记录是否安全？

> ID：11636651
> 
> 赞同：0
> 
> 时间：2012-07-24T18:00:21.047
> 
> 标签：ios, core-data, background

我的同事对使用后台任务来处理我们机载数据库中的陈旧数据的批量清理持谨慎态度。在我看来，这是进行清理的理想场所，因为它不会影响用户体验。

批量清理核心数据的最佳做法是什么？使用 BG Task 安全吗？即使用 beginBackgroundTaskWithExpirationHandler 删除陈旧的核心数据记录是否安全？如果没有，推荐的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:49:26.210

斯科特，

我一直在后台进行数据库垃圾收集。它工作得很好。IOW，如果你遵循标准的 CD 多线程模式，它是安全的。一个注释：`-applicationWillResignActive:`被调用的频率比你想象的要多得多。我建议您在`-applicationDidEnterBackground:`.

安德鲁

# vb.net - 为treeview VB.NET中的每个节点生成一个包含相同复选框的新面板（附加图像）

> ID：11636654
> 
> 赞同：1
> 
> 时间：2012-07-24T18:00:33.877
> 
> 标签：vb.net, treeview, panel

我想通过单击树视图中的每个节点来生成一个新面板。但这每个新生成的面板都将具有相同的复选框。此外，这些复选框链接到具有选中条件的组框。

我可以通过为每个节点添加一个面板来为 4-5 个节点执行此操作。但我有大约 90 个这样的节点。请参考以下图片， ![节点 1 被选中并单击复选框](../Images/fbeb426f4f93f72f60258b697ddad4ca.png) ![节点2被选中](../Images/38de1c4a7e75a7a900266a7a7c0d5bbc.png) 有 90 个这样的节点。

有没有更简单的方法，如循环等来实现这一点？还是硬方法（为每个节点添加面板并使用显示/隐藏）是唯一的方法？

帮助将不胜感激。

干杯，

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-25T10:31:57.043

您可以为此使用循环。

这是一个示例：

首先，您需要定义一些全局变量：

```
Dim Panels(100) As Panel
Dim CheckBox1(100) As CheckBox
Dim CheckBox2(100) As CheckBox
Dim CheckBox3(100) As CheckBox
Dim Label1(100) As Label 
```

然后，您应该初始化`Form_Load()`事件控件：

```
For i As Integer = 0 To 100

    'Initialize Controls
    Panels(i) = New Panel()
    CheckBox1(i) = New CheckBox()
    CheckBox2(i) = New CheckBox()
    CheckBox3(i) = New CheckBox()
    Label1(i) = New Label()

    'Set properties
    CheckBox1.Left = 100
    CheckBox2.Left = 100
    CheckBox3.Left = 100
    CheckBox1.Top = 100
    CheckBox2.Top = 200
    CheckBox3.Top = 300
    Label1.Left = 100
    Label1.Top = 50
    Label1.Text = "ID : " & NodeNames(i) 'You should replace NodeNames(i) with a variable that you are using for the name of nodes.

    'Add Controls to panel
    Panels(i).Controls.Add(CheckBox1(i))
    Panels(i).Controls.Add(CheckBox2(i))
    Panels(i).Controls.Add(CheckBox3(i))
    Panels(i).Controls.Add(Label1(i))

    'Set visiblity of panel to false
    Panels(i).Visible = False

    'Add panel to the form.
    Me.Controls.Add(Panels(i))       
Next 
```

当您需要显示面板时，您应该这样做：

```
Panels(i).BringToFront()
Panels(i).Visible = True 
```

**但是在 RAM 中拥有许多面板并不是一个好主意。我建议您只使用一个面板并通过代码为每个节点进行修改。因为如果你有很多面板和很多控件，你的应用程序可能会使用大量的 RAM。**

# jpa - 在 JPA OneToMany 关系中指定中间表名

> ID：11636655
> 
> 赞同：9
> 
> 时间：2012-07-24T18:00:36.150
> 
> 标签：jpa, playframework

我有一个表用户，每个用户都有一组其他用户作为朋友。我在模型类中定义它的方式如下：

```
 Public class User extends Models {
     ....
     @OneToMany
     public List<User> friends;
     .
     .
     } 
```

现在 Play JPA 正在创建一个包含以下字段的中间表名称 user_user。

```
 mysql> desc user_user;
    ------------+------------+------+-----+---------+-------+
    | user_id     | bigint(20) | NO   | MUL | NULL    |       |
    | friends_id  | bigint(20) | NO   | PRI | NULL    | 
```

问题是如何更改中间表 (user_user) 的名称和其中的列？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T19:51:21.153

使用`@JoinTable`注释应该可以满足您的需求。有一篇很好的帖子（[JPA“@JoinTable”注释](https://stackoverflow.com/questions/5478328/jpa-jointable-annotation)）专门关于如何使用这个注释。

# c# - 从远程客户端接收文件

> ID：11636670
> 
> 赞同：1
> 
> 时间：2012-07-24T18:01:50.127
> 
> 标签：c#, .net, file-upload, tcp, ftp

我有一个异步套接字服务器，到目前为止，它只接收具有相对较小有效负载的简单请求。我需要添加与请求一起接收文件的功能，但不确定最好的方法。更复杂的是，一些连接客户端是 C#，另一些是 VB6，因此该机制必须能够支持不同的客户端集。

*   .NET 有实现此目的的本机机制吗？
*   我可以让我的客户将文件转换为字节数组并将其传递到他们现有的 TCP 流中，以便在服务器端重建吗？
*   我应该让我的服务器表现得像一个 FTP 服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:21:28.487

> 我可以让我的客户将文件转换为字节数组并将其传递到他们现有的 TCP 流中，以便在服务器端重建吗？

是的。

# ruby-on-rails - 我的正则表达式中的错误

> ID：11636671
> 
> 赞同：0
> 
> 时间：2012-07-24T18:01:55.390
> 
> 标签：ruby-on-rails, ruby, regex

我正在尝试查看一个字符串并拒绝字符串中包含的任何`seq=`内容`app=`。棘手的地方是我需要带有`q=something`or的元素`p=something`。

`seq=`字符串的部分总是在一个之前`&`并且`app=`总是在一个之前`?`

我完全不知道从哪里开始。我一直在使用[http://www.rubular.com/](http://www.rubular.com/)试图弄清楚但无济于事。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:14:04.217

根据您的问题，我相信您可以拒绝任何与以下表达式匹配的字符串：

```
[\?&](?:seq|app)= 
```

这将匹配任何包含 a`?`或`&`后跟`app=`or的字符串`seq=`。括号内`?:`只是告诉正则表达式不要费心将匹配组捕获为子匹配。它们并不是真正必要的，但到底是什么。

这是带有[一些示例](http://www.rubular.com/r/IoKuujQt4j)的 Rubular 链接。

# javascript - 在primefaces的数据表中排序后Javascript丢失

> ID：11636673
> 
> 赞同：0
> 
> 时间：2012-07-24T18:02:14.160
> 
> 标签：javascript, ajax, jsf, datatable, primefaces

我在 primefaces 上的桌子，像这样：

```
 <p:dataTable id="creditos" ajax="false" paginator="true" value="#{listaCreditos.proyectList}" var="cc" resizable="false" styleClass="dataTableSelProject" rows="20" width="99%" cellspacing="10" cellpadding="10" rowsPerPageTemplate="20,40,80" rowIndexVar="rowIndex">

                                   <p:column styleClass="borderCell imgColumnOnLoans">
                                        <div id="imagenCol-loans#{cc.proyectloanPk.proyect_loan_id}" class="imgCol-Loans">
                                             <h:graphicImage styleClass="graphImage" url="..#{cc.proyect.image}" /> 
                                        </div>
                                   </p:column> 

                                   <p:column id="colNameTag"  sortBy="#{cc.proyect.name}" rendered="true" styleClass="borderCell proyectTitle" headerText="Categoría / Título">
                                        <div id="yui-gen62" class="yui-dt-liner proyectDetailOnLink">
                                            <div id="yui-gen66" class="titleAndPurposeDiv">
                                                <strong id="yui-gen65" class="browseNotesStrong breakWord">
                                                        <span  id="yui-gen64" class="expand-loan-details pDLink">
                                                            <p:commandLink id="cmdLinkDetail" value="#{cc.proyect.purpose.name}" actionListener="#{summaryRequest.mapeoDatos}" action="resumen">
                                                                <f:attribute name="proyectAtrr" value="#{cc.proyectloanPk.proyect_loan_id}::#{cc.proyectloanPk.proyect_id}::#{cc.proyectloanPk.prospectus_id}::#{cc.proyectloanPk.company_id}" />
                                                            </p:commandLink>
                                                        </span>
                                                </strong>
                                                <div id="proyectNameTag">
                                                    <span id="yui-gen211" >
                                                            #{cc.proyect.name}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>

                                   </p:column>

                                   <p:column sortBy="#{cc.ammount}" styleClass="borderCell" >
                                        <f:facet id="headerB" name="header" align="center">
                                               Monto/&nbsp;<br /> Tasa
                                        </f:facet>
                                            <div align="center" id="yui-gen130" class="yui-dt-liner">
                                                <div align="center" id="yui-gen209" class="timeDisplay">
                                                    <h:outputText value="#{cc.ammount}">
                                                         <f:convertNumber currencySymbol="$" type="currency" groupingUsed="true" locale="es_MX"/>
                                                    </h:outputText>
                                                </div>
                                                <strong id="yui-gen137" class="rate"> &nbsp;&nbsp;&nbsp;#{cc.rate}%</strong>
                                            </div>      
                                   </p:column> 

                                   <p:column   styleClass="borderCell" sortBy="#{cc.term.months}">
                                        <f:facet name="header" id="headerC">
                                               Plazo&nbsp;&nbsp;
                                        </f:facet>
                                            <div class="termForProyect" id="yui-gen163">
                                                <span id="yui-gen162" class="loanTypeAndLength">#{cc.term.months} meses</span>
                                            </div>      
                                    </p:column> 
```

. 一些列。.

```
 </p:dataTable> 
```

但是在普通排序后我的javascript代码不起作用，当使用commandButton时，我使用onComplete标签并在JS的某些功能上执行“刷新”，我怎么能在排序时做到这一点？？？

这是JS代码，只需加载一个fancybox即可通过commandButton调用fancybox：

```
function setFancyBox(){
    $("a#ifancybox").fancybox({
         'width' : 500,
         'height' : 330,
         'autoScale': false,
         'autoDimensions': false,
         'transitionIn' : 'elastic',
         'transitionOut' : 'elastic',
         'type' : 'inline',
         'overlayColor':'#E8E8E8'
    });
    $("#creditos tr:odd").addClass('par');
    $.fancybox.resize();
} 
```

这是“重新加载”并使 JS 函数保持活动状态的代码。

```
<p:ajax update="creditOfAccount , actualAccount , creditos , :forminfo:cuentasUsr2 , :forminfo:addBtn1 , :forminfo:tagFromAccount2" oncomplete="setFancyBox();"/> 
```

但问题是¿当我点击默认类型的primefaces时，我怎么能做一个“oncomplete”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T12:31:11.307

primefaces 数据表提供了几个 ajax 行为事件。您需要使用“排序”事件。查看 primefaces 用户指南，第 141 页，了解支持的其他 ajax 事件。

```
<p:ajax event="sort" update="creditOfAccount actualAccount creditos :forminfo:cuentasUsr2 :forminfo:addBtn1 :forminfo:tagFromAccount2" oncomplete="setFancyBox();"/> 
```

# javascript - 无法分配点击事件

> ID：11636674
> 
> 赞同：0
> 
> 时间：2012-07-24T18:02:19.120
> 
> 标签：javascript, jquery, html

我有以下html代码。在我的页面中，有许多标签具有 class='posta' 但我只想将 onclick 事件分配给具有 post 属性的标签。

```
<ul class="posts_li">
        <li>
            <a href="#" class="posta" post="status">Post</a>
        </li>
        <li>
            <a href="#" class="posta" post="act">Act</a>
        </li>
        <li>
            <a href="#" class="posta" post="event">Event</a>
        </li>
        <li>
            <a href="#" class="posta" post="news">Create News</a>
        </li>
    </ul> 
```

我的用于分配事件的 Jquery 代码在这里

```
$(".posta").click(function(){
            alert("here");
            if($(this).attr("post")){
                alert($(this).attr("post"));
            }
        }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:04:27.917

```
$(".posta[post]").click(....); 
```

小提琴：http: [//jsfiddle.net/maniator/LmrPR/](http://jsfiddle.net/maniator/LmrPR/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:07:36.373

然后`[attribute=value]`在选择器中使用：

[例子](http://jsfiddle.net/gqRmC/)

```
$('.posts_li').on('click', '.posta[post]', function() {
    alert($(this).attr("post"));
    return false;
});​ 
```

此外，您可以通过将它们委托给父项来避免为每个项目放置事件处理程序。在此示例中，我使用该方法（jQuery 1.7+）`<ul>`在所有子元素上放置了一个处理程序。[`.on()`](http://api.jquery.com/on/)对于较旧的 jQuery (1.4.2+)，[`.delegate()`](http://api.jquery.com/delegate/)也可以使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:04:36.480

使用可以使用属性选择器`[propertyname]`来仅选择具有该属性的节点。

```
$(".posta[post]").click(function(){ ... }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:12:32.033

您可以使用 css/jquery 属性选择器执行此操作：

```
$(".posta[post]").click(......... your code here) 
```

这是示例：http: [//jsfiddle.net/wHvkF/](http://jsfiddle.net/wHvkF/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T18:16:02.580

我会使用：

请参阅此[工作小提琴](http://jsfiddle.net/zuul/af8pb/)示例。^(列表中的最后一个不提醒)

```
$(".posta[post]").click(function(e) {
    e.preventDefault();
    alert("here");
}); 
```

*从 jQuery 1.0 版开始工作。*

# ios - 已接受 App store 游戏在两部 iPhone 4 4 .3.3 版上崩溃

> ID：11636675
> 
> 赞同：0
> 
> 时间：2012-07-24T18:02:24.720
> 
> 标签：ios, crash, app-store

刚刚在 Apple Appstore 上发布了我的第一款 iOS 游戏。（苹果接受）

它在 iPod（第 4 代）、Iphone 3Gs 和 iPad 2/3 上运行良好。

但是，我的两个朋友在 iPhone 4 上购买了它，iOS 版本为 4.3.3，他们都说它无法启动。它很快变黑，然后返回主屏幕。

目前没有可能借用他们的手机，谷歌搜索也帮不了我。有任何想法吗？iTunes Connect 上也没有崩溃报告。

游戏已经支持4.1了。我现在已将其从应用商店中临时删除。

如果有人有 hockeyapp，请尝试一下：[https ://rink.hockeyapp.net/recruit/baf90d07e6864bdfb2855a75b1a1877d](https://rink.hockeyapp.net/recruit/baf90d07e6864bdfb2855a75b1a1877d)

今天从我的一个朋友那里借了一部手机，并尝试从 Xcode 运行游戏（发行版）。它像以前一样变黑，在 xcode 中生成以下错误：

```
error: failed to launch '/Users/xxx/Library/Developer/Xcode/DerivedData/xxx-
hkwbdotvymdyljavlnsmbygluhnu/Build/Products/Release-iphoneos/xxx.app/xxx'
-- failed to get the task for process 1585 
```

但是，如果您稍后只是单击 iPhone 上的游戏图标，它就会完美运行...

然而，调试目标/版本确实工作得很好。

**更新：**

如果那里有人获得了 iOS 4.3.3，请使用这些促销代码之一并尝试一下。如果可以，请在崩溃时发送崩溃报告。

```
JWF3LLP3ALMT
9M6XLTYY7TJ9
LWMKW7MTN99W 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T21:32:02.713

崩溃报告：

```
Identifier:      appName
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-07-28 00:14:50.460 +0300
OS Version:      iPhone OS 4.3.3 (8J3)
Report Version:  104

Exception Type:  EXC_BREAKPOINT (SIGTRAP)
Exception Codes: 0x00000001, 0xe7ffdefe
Crashed Thread:  0

Dyld Error Message:
  Symbol not found: _OBJC_CLASS_$_GKNotificationBanner
  Referenced from: /var/mobile/Applications/...../appName.app/appName
  Expected in: /System/Library/Frameworks/GameKit.framework/GameKit
 in /var/mobile/Applications/...../appName.app/appName
  Dyld Version: 191.3 
```

GKNotificationBanner 适用于 iOS 5.0 及更高版本

[http://developer.apple.com/library/ios/#documentation/GameKit/Reference/GKNotificationBanner_Ref/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/GameKit/Reference/GKNotificationBanner_Ref/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:21:17.287

让您的朋友向您发送他们的崩溃报告。一旦他们同步他们的手机，崩溃报告将被复制到他们的计算机（~/Library/Logs/CrashReporter/MobileDevice 在 Mac 上），他们可以将它们发送给您。

# php - PHP SOAP 标准类

> ID：11636676
> 
> 赞同：0
> 
> 时间：2012-07-24T18:02:31.007
> 
> 标签：php, soap, stdclass

我想使用 SOAP 获取外部服务的信息。当我对该 SOAP 调用进行 print_r 时，我得到：

```
stdClass Object (
    [Ticket] => stdClass Object
        (
            [Timestamp] => 2012-07-24T17:46:01.306+02:00
            [ExpiryTimestamp] => 2012-07-24T18:47:46.626+02:00
        )

    [FUP] => stdClass Object
        (
            [Period] => stdClass Object
                (
                    [From] => 2012-06-25+02:00
                    [Till] => 2012-07-24+02:00
                    [CurrentDay] => 30
                )

            [Usage] => stdClass Object
                (
                    [TotalUsage] => 75.1
                    [MinUsageRemaining] => 182.59
                    [MaxUsageRemaining] => 612.54
                    [Unit] => GB
                    [LastUpdate] => 2012-07-24T17:40:44.000+02:00
                )

            [Status] => Vrij verbruik
            [StatusDescription] => stdClass Object
                (
                    [NL] => Je surft met volledige surfsnelheid.
                    [FR] => Vous surfez Ã  vitesse normale.
                )

        )

) 
```

这是获取数据的 PHP 代码：

```
$wsdl_url = "https://t4t.services.telenet.be/TelemeterService.wsdl";
$client = new SoapClient($wsdl_url);

try
      {
         $result = $client->retrieveUsage(new SoapParam(array("UserId" => $userName, "Password" => $password), "RetrieveUsageRequestType"));
      } 
```

如何显示 TotalUsage 的数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:32:34.717

```
<?php

$usage = $result->FUP->Usage->TotalUsage; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:05:56.357

它只是一个具有许多属性的 PHP 对象。

您可以`TotalUsage`像这样访问：

```
$result->FUP->Usage->TotalUsage; 
```

# awk - AWK——文件共享

> ID：11636677
> 
> 赞同：2
> 
> 时间：2012-07-24T18:02:34.100
> 
> 标签：awk

我有两个文件：

**文件_1**

```
Head;track1;track2;track3;
date1;vol2;vol4;vol9;
date2;vol5;vol0;vol1;
date3;vol7;vol2;vol5; 
```

**文件_2**

```
Head1
trackV1 track1
trackV2 track2
trackV3 track3 
```

我想共享 File_1 并将结果存储在单独的文件中。对于 File_1，我分别编写 ($1, $2), ($1, $3), ($1, $4)。新文件的名称将从第一列 File_2（trackV1、trackV2、trackV3）中检索。我想创建这些文件：

**轨道V1**

```
Head track1
date1 vol2
date2 vol5
date3 vol7 
```

**轨道V2**

```
Head track2
date1 vol4
date2 vol0
date3 vol2 
```

**轨道V3**

```
Head track3
date1 vol9
date2 vol1
date3 vol5 
```

我尝试了不同的解决方案，但不起作用：

```
awk 'BEGIN { while(getline < "File_1"){split($0, tab, ";"); print  $(getline a < "File_2") > tab[1] tab[2]}}' 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T20:10:03.877

把它放进去`foo.awk`。用法（注意文件的顺序）
`awk -f foo.awk File_2 File_1`

```
BEGIN {
    # fields separator
    FS=";"
}

# skip a first line in the "names file"
NR==FNR && NR==1 {next}

NR==FNR {
    # read "names file"
    split($1, aux, " ")
    name[aux[2]]=aux[1]
    next
}

FNR!=NR && FNR==1{
    # read a header of the "data file" and create output files
    split($0, head)
    for (i=2; i<NF; i++) {
       print "Head", head[i] > name[head[i]]
    }
    next
}

{
    # populate output files
    for (i=2; i<NF; i++) {
       print $1, $i >> name[head[i]]
    }
} 
```

# objective-c - 获取屏幕上某种颜色所占据的区域 - iOS

> ID：11636679
> 
> 赞同：2
> 
> 时间：2012-07-24T18:02:58.750
> 
> 标签：objective-c, ios, opengl-es, pixel, area

我正在尝试做类似于[这个问题](https://stackoverflow.com/questions/10675245/ios-calculating-percent-of-a-color-in-an-area)中所问的事情，但我并不真正理解该问题的答案，我不确定它是否是我需要的。

我需要的很简单，尽管我不太确定它是否容易。我想计算屏幕上某种颜色的像素数。我知道我们看到的每个“像素”实际上都是不同颜色的像素组合，例如绿色。所以我需要的是*实际*的颜色——用户看到的颜色。

例如，如果我创建了一个 UIView，将背景颜色设置为`[UIColor greenColor]`，并将其尺寸设置为屏幕区域的一半（为了简单起见，我们可以假设状态栏是隐藏的，并且我们在 iPhone 上），我会期望这种“魔术方法”返回 240 * 160 或 38,400——屏幕面积的一半。

我不希望任何人写出这个“神奇的方法”，但我想知道

a) 如果可能的话

b) 如果是这样，如果它几乎是实时完成的

c) 如果又是这样，从哪里开始。我听说它可以用 OpenGL 完成，但我在这方面没有经验。

这是我的解决方案，感谢 Radif Sharafullin：

```
int pixelsFromImage(UIImage *inImage) {
    CGSize s = inImage.size;
    const int width = s.width;
    const int height = s.height;
    unsigned char* pixelData = malloc(width * height);

    int pixels = 0;

    CGContextRef context = CGBitmapContextCreate(pixelData,
                                                  width,            
                                                  height,            
                                                  8,           
                                                  width,            
                                                  NULL,            
                                                  kCGImageAlphaOnly);

    CGContextClearRect(context, CGRectMake(0, 0, width, height));

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), inImage.CGImage );

    CGContextRelease(context);

    for(int idx = 0; idx < width * height; ++idx) {
        if(pixelData[idx]) {
            ++pixels;
        }
    }

    free(pixelData);

    return pixels;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T19:20:13.230

有可能的。我做了类似的事情来计算透明像素的百分比，但由于我需要粗略的估计，我不是在看每个像素，而是在每 10 个像素，`step`变量在下面的代码中。

```
BOOL isImageErased(UIImage *inImage, float step, int forgivenessCount){
CGSize s = inImage.size;
int width = s.width;  
int height = s.height;   
unsigned char*  pixelData = malloc( width * height );  
int forgivenessCounter=0;

CGContextRef context = CGBitmapContextCreate ( pixelData,  
                                              width,            
                                              height,            
                                              8,           
                                              width,            
                                              NULL,            
                                              kCGImageAlphaOnly );   
CGContextClearRect(context, CGRectMake(0, 0, width, height));
CGContextDrawImage( context, CGRectMake(0, 0, width, height), inImage.CGImage );  
CGContextRelease( context );  
for (int x=0; x<width; x=x+step) {
    for (int y=0; y<height; y=y+step) {

        if(pixelData[y * width + x]) {
            forgivenessCounter++;
            if (forgivenessCounter==forgivenessCount) {
                free(pixelData);
                return FALSE;
            }

        };

    }
}

free( pixelData );

return TRUE;} 
```

`kCGImageAlphaOnly`如果您传递经过预处理的灰度图像或修改API的设置，我相信此代码可以用于您的目的。

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-12T15:18:41.163

**用Swift 3**编写的 eric.mitchell 解决方案

 **```
func pixelsFromImage(inImage: UIImage) -> Int {

    let width = Int(inImage.size.width)
    let height = Int(inImage.size.height)

    let bitmapBytesPerRow = width
    let bitmapByteCount = bitmapBytesPerRow * height

    let pixelData = UnsafeMutablePointer<UInt8>.allocate(capacity: bitmapByteCount)

    let colorSpace = CGColorSpaceCreateDeviceGray()

    let context = CGContext(data: pixelData,
                            width: width,
                            height: height,
                            bitsPerComponent: 8,
                            bytesPerRow: bitmapBytesPerRow,
                            space: colorSpace,
                            bitmapInfo: CGBitmapInfo(rawValue: CGImageAlphaInfo.alphaOnly.rawValue).rawValue)!

    let rect = CGRect(x: 0, y: 0, width: width, height: height)
    context.clear(rect)
    context.draw(inImage.cgImage!, in: rect)

    var pixels = 0

    for x in 0...width {
        for y in 0...height {

            if pixelData[y * width + x] > 0 {
                pixels += 1
            }
        }
    }

    free(pixelData)

    return pixels
} 
```**

# java - 如何在 Logback 中更新 SMTPAppender 上的“to”地址？

> ID：11636680
> 
> 赞同：5
> 
> 时间：2012-07-24T18:02:59.330
> 
> 标签：java, logging, logback, smtpappender

我正在创建一个管理页面，其中有几个我想即时设置的 logback 属性，其中一个是我向其发送系统警报的管理电子邮件。的 api`SMTPAppender`具有添加到“到”地址列表或将它们作为列表获取的方法，但我没有找到任何要清除、删除或更新它们的方法。我该怎么做？

我目前看到两个选项：

1.  一种选择是删除 appender 并使用新属性创建一个新的 (yuck)。
2.  弄清楚如何直接通过 Joran 来配置它（也许很糟糕？）。

我正在推进（2），但如果有更好的方法，请发布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T07:21:04.480

我能想到的另外两个选择：

1/ 将更新的地址设置为系统属性，并`SMTPAppender`使用系统属性配置以评估 smtpTo 地址，如下所示

```
<to>%property{smtpTo}</to> 
```

或 2/ 在数据库/系统属性的某处设置更新的地址。将 smtpTo 地址放入每个线程的 MDC，并配置为`SMTPAppender`从 MDC 获取它，如下所示

```
<to>%X{smtpTo}</to> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T13:02:42.663

也许你已经完成了这个，但我只需要找到一种设置动态“到”地址的方法，这个主题引导我找到了方法（感谢@gresdiplitude 关于系统属性和 MDC 值的想法），所以我分享我的解决方案。

我`SMTPAppender`用来发送小型执行报告，但需要发送到不同的邮箱。该解决方案看起来很糟糕，或者至少我对结果非常满意。

我的 logback.xml：

```
<!-- this is the trick: a converter to use on the "to" field pattern -->
<conversionRule conversionWord="smtpTo" converterClass="com.example.logback.MyConverter" />
<appender name="SMTP" class="ch.qos.logback.classic.net.SMTPAppender">
    <!-- a filter to select just the log entries that will be sent by mail -->
    <filter class="com.example.logback.MyFilter" />
    <!-- an evaluator, mine is like CounterBasedEvaluator from the manual:
        http://logback.qos.ch/xref/chapters/appenders/mail/CounterBasedEvaluator.html
    -->
    <evaluator class="com.example.logback.MyEvaluator">
        <limit>25</limit>
    </evaluator>
    <!-- a discriminator to create a cyclic buffer for each mailing group I need -->
    <discriminator class="com.example.logback.MyDiscriminator" />
    <!-- just matching buffer size to evaluator limit -->
    <cyclicBufferTracker class="ch.qos.logback.core.spi.CyclicBufferTrackerImpl">
        <bufferSize>25</bufferSize>
    </cyclicBufferTracker>
    <smtpHost>${smtp.host}</smtpHost>
    <smtpPort>${smtp.port}</smtpPort>
    <SSL>${smtp.ssl}</SSL>
    <username>${smtp.username}</username>
    <password>${smtp.password}</password>
    <from>${smtp.from}</from>

    <!-- here you use the converter: in this case will get data
        from marker containing the destination addresses
    -->
    <to>%smtpTo</to>
    <subject>my subject</subject>
    <layout class="ch.qos.logback.classic.PatternLayout">
        <pattern>%date: %message%n%xThrowable{full}</pattern>
    </layout>
</appender> 
```

MyFilter.java：

```
public FilterReply decide(ILoggingEvent event) {
    return event.getMarker() != null
            && event.getMarker().contains("REPORT") ? FilterReply.ACCEPT
            : FilterReply.DENY;
} 
```

MyDiscriminator.java：

```
public String getDiscriminatingValue(ILoggingEvent e) {
    Marker marker = e.getMarker();
    if (marker == null || !(marker instanceof MyMarker)) {
        return null;
    }
    return ((MyMarker) marker).getDiscriminatingValue();
} 
```

MyConverter.java：

```
public class MyConverter extends ClassicConverter {

    @Override
    public String convert(ILoggingEvent event) {
        Marker marker = event.getMarker();
        if (marker == null || !(marker instanceof MyMarker)) {
            return null;
        }
        return ((MyMarker) marker).getSmtpTo();
    }
} 
```

MyMarker.java：

```
public interface MyMarker extends Marker {
    // a list of destination addresses, like "a@c.com, x@y.net"
    String getSmtpTo();
    // an "id" to tell the buffers apart, could be "smtpTo" itself
    // but in my case it would mix different reports that goes to the same addresses
    String getDiscriminatingValue();
} 
```

我刚刚创建了一个实现`MyMarker`，并在每个应该报告的日志语句中使用了它的几个实例：

```
// suggestion: make the marker immutable, then you can store and reuse them instead of recreating them every time
Marker marker1 = new MyMarkerImpl(
    "REPORT", // marker name
    "me@company.com, joe@company.com", // smtpTo
    "alertGroup"); // discriminatingValue
logger.warn(marker1, "SNAFU");
Marker marker2 = new MyMarkerImpl(
    "REPORT", "boss@company.com, ceo@company.com", "phbGroup");
logger.info(marker2, "Everything is fine");
// here we have same smtpTo as above but different discriminatingValues, so this will be sent in another email/report
Marker marker3 = new MyMarkerImpl(
    "REPORT", "me@company.com, joe@company.com", "bugFixingGroup");
logger.error(marker3, "Why things gone bad", exception); 
```

希望它能有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-05T22:01:23.633

我这样做：

```
smtpappender.getToList().clear(); 
```

# actionscript-3 - AS3 Adob e AIR：返回 xml 字符串

> ID：11636682
> 
> 赞同：0
> 
> 时间：2012-07-24T18:03:06.617
> 
> 标签：actionscript-3, flash, actionscript, air

**我正在使用 Adob​​e AIR 3.3（适用于 iOS）在 Flash CS6 中工作，并且无法将 XML 字符串返回到 textField。**

它正在跟踪正确的信息，我尝试了几种方法来返回跟踪，但似乎无法完全理解......这是我最近的尝试。有什么建议么？提前致谢。

```
 var myLoader:URLLoader = new URLLoader();
myLoader.load(new URLRequest("http://www.someURL.php"));
//php file that echos xml   
myLoader.addEventListener(Event.COMPLETE, init);
     var fadedText:TextField;
     var touchList:TouchList;
     var textOutput:TextField;
     var animateLeft:Tween;
     var listArray:Array;
     var item:TouchListItemRenderer;
     var theXML:XML; 
     var days:Array = new Array("monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday");
     var daySelected;
     var businessNameArray:Array = new Array();
     var businessLogoArray:Array = new Array();
     var businessAddress:Array = new Array();
     var distanceArrayDisplay:Array = new Array();
     var distanceArrayCount = 0;

     function init(e:Event = null):void
    {
        trace(myLoader.data);
        theXML = new XML(e.target.data);
        theXML.ignoreWhitespace = true;
        myLoader.close();

        // add our list and listener
        var itemSizeCalculator = stage.stageHeight / 6;
        touchList = new TouchList(stage.stageWidth, stage.stageHeight-itemSizeCalculator);
        touchList.addEventListener(ListItemEvent.ITEM_SELECTED, handlelistItemSelected);
        addChild(touchList);
        touchList.x = stage.stageWidth;

        // Fill our list with item rendreres that extend ITouchListRenderer. 
                for(var i:int = 0; i < theXML.food.length(); i++) {
                    if(theXML.food[i].monday != "un")
                    {                           
                item = new TouchListItemRenderer();
                item.index = i;
                item.data = theXML.food[i].business;
                item.name = theXML.food[i].business;
                item.addEventListener(MouseEvent.CLICK, itemWasClicked);
                item.itemHeight = itemSizeCalculator;

     businessNameArray[i]= theXML.food[i].business;
     businessLogoArray[i]=("http://www.logosURL.com/"+theXML.food[i].logo);
     businessAddress[i]= theXML.food[i].address;

            var fadedTextFormat:TextFormat = new TextFormat();
            fadedTextFormat.bold = true;
            fadedTextFormat.color = 0x999999;
            fadedTextFormat.size = 14;
            fadedTextFormat.font = "Helvetica"; 

            fadedText = new TextField();
            fadedText.height = 30;
            fadedText.mouseEnabled = false;
            fadedText.defaultTextFormat = fadedTextFormat;

            item.addChild(fadedText);
            fadedText.x = 75;
            fadedText.y = 10;
            distanceArrayDisplay.push(fadedText);

                var distanceLoader:URLLoader = new URLLoader();
                distanceLoader.load(new URLRequest("http://maps.googleapis.com&origins=someAddress&destinations="+businessAddress[i]+"&mode=walking&language=en-en&sensor=false"));
                distanceLoader.addEventListener(Event.COMPLETE, distanceCalculated);

                var logoLoader:Loader = new Loader();
                item.addChild(logoLoader);
                var logoURL:URLRequest = new URLRequest("http://www.myLogos.com/"+theXML.food[i].logo);
                logoLoader.load(logoURL);
                logoLoader.scaleX = .4;
                logoLoader.scaleY = .4;
                logoLoader.y = logoLoader.y + 5;
                logoLoader.mouseEnabled = false;
                var arrowGraphic:rightArrow = new rightArrow();
                item.addChild(arrowGraphic);
                arrowGraphic.x = stage.stageWidth - 5;
                arrowGraphic.y = item.height/2;

            touchList.addListItem(item);
                    }
        }
}

function distanceCalculated(e:Event)
{
//  trace(e.currentTarget.data);
var distanceXML:XML = new XML(e.target.data);
distanceXML.ignoreWhitespace = true;
var returnVar:String = (distanceXML.row.element.distance.text);
distanceArrayDisplay[distanceArrayCount].text = returnVar;
trace(returnVar);

distanceArrayCount++;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:08:24.967

我猜您正在正确读取第一个 XML，并且 XML 有一个您想要加载的 URL 列表，然后显示来自 TextFields 的一些信息。在不知道该 XML 的结构的情况下，我无法向您推荐任何工作代码，但我可以为您指明正确的方向。有关在 flash as3 上读取/迭代 XML 的更多信息，请阅读：[http ://www.kirupa.com/developer/flashcs3/using_xml_as3_pg1.htm](http://www.kirupa.com/developer/flashcs3/using_xml_as3_pg1.htm)

```
//iterator var
var xml_read:uint=0;
//array of textfields for reference
var array_textFields:Array;

//config XML complete
function init(e:Event = null):void
{

  array_textFields = new Array();

  theXML = new XML(e.target.data);
  theXML.ignoreWhitespace = true;

  //this depends on the XML structure, please look at the article I linked
  //for more info on how to iterate an XML
  var i:uint=0;
  for(someUrl in theXML..url)
  {
    var fadedText:TextField = new TextField();

    //you should place each Textfield on different coord, otherwise
    //they will all stack on top of each other and you will only see one
    //for example:
    fadedText.y = (fadedText.height+10)*i;
    item.addChild(fadedText);
    array_textFields.push(fadedText);

    var distanceLoader:URLLoader = new URLLoader();
    distanceLoader.load(new URLRequest(someUrl));
    distanceLoader.addEventListener(Event.COMPLETE, distanceCalculated);

    i++;

  }
}
function distanceCalculated(e:Event):void
{

  var distanceXML:XML = new XML(e.target.data);
  distanceXML.ignoreWhitespace = true;

  //retrieve information
  var returnVar:String = (distanceXML.row.element.distance.text);

  //set to textfield
  TextField(array_textFields[xml_read]) = returnVar;

  //increase iterator
  xml_read++;
} 
```

请记住，在 ActionScript3 中，所有网络 I/O 都是**异步**的。通常 EventListener 函数不会返回任何值，因为您不知道数据何时准备就绪。当异步调用 EventListener 函数时，您所做的是存储对您希望数据去往的位置（在您的情况下为 TextField 变量）的引用。

# php - 可以选择第一个非空或第一个整数值的mysql语句

> ID：11636684
> 
> 赞同：1
> 
> 时间：2012-07-24T18:03:11.483
> 
> 标签：php, mysql, select

我的用户将选择一个初始年份，我希望 mysql 从列中选择初始年份的值（比如说 1990 年），但是如果该初始年份（1990 年）没有值，它应该选择第一个可用值（让比如说 1996 年）

在这种情况下，我应该尝试选择第一个非空值，但在我的数据库中，我对所有不可用的值都有一个“-”而不是空值。

我想我很生气尝试一个无限循环的do-while循环......

```
do{
$sql="SELECT `$cityb` FROM data WHERE year=$initialyear";
$result = mysql_query($sql) or die('Query failed: ' . mysql_error());
if ($result) {
  while ($row = mysql_fetch_assoc($result)) {
      $valuei=$row["$cityb"];
      }

}         

$initailyear++;
}
while($value == "-"); //till when intial value is "-" (i.e no value) 
```

此循环应在找到非“-”值时结束。但它永远不会结束。所以必须有一个更好的选择，而不是使用这个愚蠢的循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:06:23.127

```
SELECT stuff FROM data 
WHERE CONVERT(year, UNSIGNED INTEGER) >= 1990 
  AND year != '-' 
ORDER BY year 
LIMIT 1; 
```

（未经测试）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:19:36.410

如果您想放弃“-”方式，还有“不为空”的方法。

```
select something from data where (year=1996) and (year is not null) 
```

如果什么都没有回来（可以用 mysql_num_rows==0 或简单地用你内部的“if”上的“else”检查）：

```
select something from data where year is null order by something_else asc limit 0, 1 
```

这会进行两个查询而不是循环。

# android - 如何使布局加载更有效？还是将它们缓存起来以便快速访问？

> ID：11636687
> 
> 赞同：0
> 
> 时间：2012-07-24T18:03:27.943
> 
> 标签：android, android-layout

我有一个包含大约 400 个表格行的布局来显示数据。在中档设备上，渲染大约需要 5 秒。

有没有办法让布局保持缓存，这样当用户在更详细地查看一行后重新加载数据时，重新渲染就不会再花 5 秒了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:07:09.180

使用带有自定义适配器的 ListView 是解决方案。

# perl - 如何获取系统中可用的“标准”perl 模块列表？

> ID：11636691
> 
> 赞同：4
> 
> 时间：2012-07-24T18:03:41.090
> 
> 标签：perl, module

中有一句话`perlmodlib(1)`：

> 您的系统上可能未安装下面列出的所有模块。例如，如果您没有 gdbm 库，则不会安装 GDBM_File 模块。

如何获取系统中安装的标准模块的实际列表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T18:54:14.140

该`cpan`命令可以做到：

```
% cpan -a 
```

我写了[App::Module::Lister](https://www.metacpan.org/module/App::Module::Lister)来完成这项工作。虽然它是一个模块，但它也是一个程序，当你像程序一样运行它时，它会做你想做的事情：

```
% perl `perldoc -l App::Module::Lister` 
```

其他几个 Stackoverflow 问题针对特定模块回答了这个问题，包括：

*   [如何检查是否安装了 Perl 模块？](https://stackoverflow.com/questions/802107/how-do-i-check-whether-a-perl-module-is-installed?rq=1)
*   [在使用 Perl 模块之前如何检查它？](https://stackoverflow.com/questions/251694/how-can-i-check-if-i-have-a-perl-module-before-using-it)
*   [如何检查 Perl 的可用性、版本和所需模块的存在？](https://stackoverflow.com/questions/2605545/how-to-check-availability-of-perl-its-version-and-presence-of-a-required-module?lq=1)

但是，对于您的特定问题，您真的关心实现 DBM 功能的内容吗？你对此有什么疑问吗？

# javascript - 在 Raphael JS 中创建脉动（循环）背景的最简单方法？

> ID：11636692
> 
> 赞同：0
> 
> 时间：2012-07-24T18:03:44.323
> 
> 标签：javascript, jquery, raphael

我正在寻找最简单和更直接的方法来制作某些元素的循环/重复脉动背景。

例如，如果我有一个圆圈：

```
var filler = {
            'fill': 'white',
            'stroke': 'white',
            'stroke-width': '0'
}
var fillerHover = {
            'fill': '#b6def1',
            'stroke': '#b6def1',
            'stroke-width': '0',
            'cursor': 'pointer'
}

circle.hover(function() {
            circle.animate(fillerHover, 500);
        },

        function() {
            circle.animate(filler, 500);
        }
); 
```

上面的代码运行良好，但是它只为过渡设置一次动画，只要我将鼠标悬停在圆圈上，我就想做一个重复循环。

当我将光标放在从填充到填充悬停的圆圈上时，我想循环背景，直到我带着光标出去。

如何以最简单的方式创建这样的循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:40:55.273

您可以向再次启动它的动画添加回调：[http ://raphaeljs.com/reference.html#Element.animate](http://raphaeljs.com/reference.html#Element.animate)

不要在 a中这样做`setInterval`，那会提高帧率！
甚至不要使用`requestAnimationFrame`. 你不知道它什么时候会触发动画。唯一“安全”的方法是让 Raphael 告诉您动画何时结束（通过`callback`选项）以开始下一个动画。

就像是：

```
fillerHover.callback = mouseOver;
function mouseOver() {
  circle.animate(fillerHover, 500);
}

circle.hover(
  mouseOver,
  function() {
    circle.animate(filler, 500);
  }
); 
```

将其与您当前的代码混合 =) 您知道我的意思。

**编辑：**这看起来像：http: [//jsfiddle.net/rudiedirkx/j9XyX/6/show/](http://jsfiddle.net/rudiedirkx/j9XyX/6/show/)

# objective-c - 如何在 Objective-C 中使用 OpenSSL 获取 X.509 数字证书的 OCSP 吊销状态？

> ID：11636694
> 
> 赞同：0
> 
> 时间：2012-07-24T18:03:49.243
> 
> 标签：objective-c, ios, openssl, x509certificate, ocsp

如何使用 Objective-C (iOS) 和 OpenSSL OCSP 库检查 x509 证书（我目前拥有 .cer 格式）的吊销状态？

# sql - SQL Join Query VB (Pretty Sumple, 我只是学习)

> ID：11636700
> 
> 赞同：0
> 
> 时间：2012-07-24T18:04:03.987
> 
> 标签：sql, vb.net

我正在尝试进行一个查询，它在表 A 和表 B 中具有相同的字段。然后表 B 与表 C 具有相同的字段。我想左连接表 A 上的所有表。这可能吗？如果是，我的代码离它有多近？

```
 Try
            objConn = DBAccess.GetConnection
            strBlder.Append("SELECT ")
            strBlder.Append("FLD_NM, DATA_TYPE_CD, XML_PATH_TX, UPDT_USER_ID_NR, DOC_TMPL_FLD_ID_NR  ")
            strBlder.Append("FROM ")
            strBlder.Append("LLC.[LLCW10_DCTMPFLD_TB] LEFT JOIN LLC.[DataMapTool_FieldMapping] ")
            strBlder.Append("ON LLC.[LLCW10_DCTMPFLD_TB].DOC_TMPL_FLD_ID_NR = LLC.[DataMapTool_FieldMapping].DocumentTemplateFieldID ")
            strBlder.Append("& LEFT JOIN LLC.[DataMapTool_FieldMapping] ")
            strBlder.Append("ON LLC.[DataMapTool_FieldMapping].FieldMappingStatusID = LLC.[DataMapTool_FieldMappingStatus].FieldMappingStatusID ")

            strBlder.Append("ORDER BY FLD_NM ;")
            dsData = DBAccess.ExecuteDataTable(objConn, CommandType.Text, strBlder.ToString())
            'execute non query - takes sp name 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:09:04.157

对我来说看起来不错，但在……把它拿出来`&`之前有一个奇怪的地方。`LEFT JOIN LLC.[DataMapTool_FieldMapping]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T19:21:36.027

您得到的错误（删除 后`&`）是因为`LLC.[DataMapTool_FieldMapping]`重复了，这是一个问题。而不是你的`from`条款尝试类似的东西：

`FROM (LLC.[LLCW10_DCTMPFLD_TB] LEFT JOIN LLC.[DataMapTool_FieldMapping] ON LLC.[LLCW10_DCTMPFLD_TB].DOC_TMPL_FLD_ID_NR = LLC.[DataMapTool_FieldMapping].DocumentTemplateFieldID) LEFT JOIN LLC.[DataMapTool_FieldMappingStatus] ON LLC.[DataMapTool_FieldMappingStatus].FieldMappingStatusID = LLC.[DataMapTool_FieldMapping].FieldMappingStatusID`

请注意，`LLC.[DataMapTool_FieldMapping]`在第一个连接中引用了该字段，然后`.FieldMappingStatusID`在第二个连接中仅引用了该字段。您的初始查询会尝试两次将同一个表添加到查询中，而不给它一个别名，这会使查询分析器感到困惑。

基本上，新`from`子句会将前两个表附加在一起，然后将第三个表附加到第一个连接的结果上。

# php - mySQL关于重复键多次更新

> ID：11636702
> 
> 赞同：1
> 
> 时间：2012-07-24T18:04:13.907
> 
> 标签：php, mysql, sql

我试图创建一个简单的 SQL INSERT 否则 UPDATE 语句，但老实说我不知道​​我在做什么

到目前为止，这是我的功能

```
function addInventoryBook($isbn, $sku, $price, $quantity, $condition, $dateOpened){
   $q = "INSERT INTO ".TBL_INVENTORY." VALUES('$isbn', '$sku', $price, 
   $quantity, '$condition', $dateOpened)
   ON DUPLICATE KEY UPDATE VALUES('$isbn', '$sku', $price, $quantity, 
   '$condition', $dateOpened)";     

   return mysql_query($q, $this->connection);           
} 
```

似乎更新价格字段的先前功能正在工作

```
function addInventoryBook($isbn, $sku, $price, $quantity, $condition, $dateOpened){
   $q = "INSERT INTO ".TBL_INVENTORY." VALUES('$isbn', '$sku', $price, 
   $quantity, '$condition', $dateOpened)
   ON DUPLICATE KEY UPDATE price = $price";     

   return mysql_query($q, $this->connection);           
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:16:34.683

我会这样写，而不是第二次提供每个值：

```
ON DUPLICATE KEY UPDATE 
  isbn       = VALUES(isbn)
  sku        = VALUES(sku)
  price      = VALUES(price)
  quantity   = VALUES(quantity)
  condition  = VALUES(condition)
  dateOpened = VALUES(dateOpened) 
```

（如果插入成功，这将分配将被插入的值。）

（您可能不希望将值分配给构成插入违反的“唯一”键的任何列；我在这里包含了所有列，因为这就是您在尝试中显示的内容。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:14:37.460

Assuimg TBL_INVENTORY 是具有列值的字符串：

```
$q = "INSERT INTO ".TBL_INVENTORY." VALUES('$isbn', '$sku', $price,     $quantity, '$condition', $dateOpened) ON DUPLICATE KEY UPDATE isbn='$isbn', sku='$sku', price='$price', quantity='$quantity', condition='$condition', dateOpened='$dateOpened'"; 
```

参考链接：[http ://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

# css - 在浏览器缓存中编辑 CSS

> ID：11636710
> 
> 赞同：0
> 
> 时间：2012-07-24T18:04:39.603
> 
> 标签：css, caching

我正在 webkit 之上构建一个应用程序，我需要修改一个 CSS 文件（编辑选择器），一旦使用 Javascript 加载页面，我就可以这样做。在我的特定场景中，我可能会多次加载页面，并且我想改变缓存中的 CSS（使用 Javascript，而不是破解 webkit）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:25:12.930

在不完全了解您的用例的情况下，我看到至少三种廉价且快速的方法来覆盖某些样式：

*   使用那里的许多书签之一（例如[Paul Irish 的这个](http://pastie.org/379693)）来玩注入风格或
*   使用一小段 javascript ondomready 将带有选择器和样式的样式表注入到文档的头部（类似于上面的小书签）或
*   定义一个足够具体的 CSS 选择器，并在您的文档中简单地包含一个内联样式元素（我不建议这样做）

这三种方法基本相同。取决于你有什么，能够编辑或想要实现，任何一种方法都可能更合适。

用户样式表或 Google Chrome 的 Stylebot 等扩展可能是另一种研究方法。

奇怪的事情，比如通过 javascript 的 XHR 加载引用的样式表、获取文件的内容、修改或注入内容以及将样式重新应用到当前文档也是可能的，但可能不是您想要的。

# perl - 从 perl 脚本调用 bash 脚本

> ID：11636721
> 
> 赞同：7
> 
> 时间：2012-07-24T18:05:17.503
> 
> 标签：perl, bash

我正在尝试 perl 脚本中的代码，并且需要在 bash 中调用另一个文件。不确定，这是最好的方法吗？我可以使用 system() 直接调用它吗？请指导/告诉我一个示例方式。

从我到目前为止所尝试的：

```
 #!/usr/bin/perl
     system("bash bashscript.sh"); 
```

重击：

```
#!/bin/bash
echo "cdto codespace ..."
cd codetest
rm -rf cts
for sufix in a o exe ; do
echo ${sufix}
find . -depth -type f -name "*.${sufix}" -exec rm -f {} \;
done 
```

执行 perl 脚本时出现错误：没有这样的文件或目录 codetest

意外标记`do附近的语法错误

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T18:12:50.223

如果你只想运行你的脚本，你可以使用反引号或系统：

```
$result = `/bin/bash /path/to/script`; 
```

或者

```
system("/bin/bash /path/to/script"); 
```

如果您的脚本产生大量数据错误，则运行它的最佳方法是使用 open + pipe：

```
if open(PIPE, "/bin/bash /path/to/script|") {
  while(<PIPE>){
  }
}
else {
  # can't run the script
  die "Can't run the script: $!";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:08:29.113

您可以使用反引号来执行命令：

```
$command = `command arg1 arg2`; 
```

还有其他几种附加方法，包括`system("command arg1 arg2")`执行它们。

这是一个很好的在线参考：[http ://www.perlhowto.com/executing_external_commands](http://www.perlhowto.com/executing_external_commands)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T21:51:51.867

我根据 [Why does not "cd" work in a bash shell script? 解决了我的第一个问题？](https://stackoverflow.com/questions/255414/why-doesnt-cd-work-in-a-bash-shell-script)：

```
alias proj="cd /home/tree/projects/java" 
```

（感谢@Greg Hewgill）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T18:09:59.677

您可以使用反引号、system() 或 exec。

```
 system("myscript.sh") == 0
    or die "Bash Script failed"; 
```

另见：[这篇](https://stackoverflow.com/questions/799968/whats-the-difference-between-perls-backticks-system-and-exec)文章。

# html - CSS 伪类：内容编辑器 webpart 中的悬停在 ie8/ie7 中无法正常工作

> ID：11636728
> 
> 赞同：0
> 
> 时间：2012-07-24T18:05:59.417
> 
> 标签：html, css, sharepoint

对于主页，我有一个 html 文件，其中包含由图像精灵表示的四个链接。精灵正确显示并在悬停时更改，并且在仅在我的桌面上使用 html 文件测试代码时，悬停属性工作正常（即使在 ie8 中），但是在我的共享点站点上实现它时，鼠标移出部分`:hover`无法识别由于某种原因，图像不会按需要变回其原始状态。当我使用 firefox 调出 sharepoint 时，此代码将起作用，甚至在 ie8 中也可以使用，但仅当我调出 ie 的开发人员工具并切换`Browser Mode:IE8`和`Document Mode:IE8 Standards`.

不悬停时如何使我的图像恢复到原始状态？

这是我的参考代码：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<style type="text/css">
#navlist{position:relative;}
#navlist li{margin:0;padding:0;list-style:none;position:absolute;}
#navlist li, #navlist a{height:50px;display:block;}

#one{left:0px;width:250px;}
#one{background:url('images/newMenuSprite.png') 0px -1px;}
#one a:hover{background: url('images/newMenuSprite.png') 0px -226px;}

#two{left:0px;width:250px;top:54px}
#two{background:url('images/newMenuSprite.png') 0px -53px;}
#two a:hover{background: url('images/newMenuSprite.png') 0px -278px;}

#three{left:0px;width:250px;top:108px}
#three{background:url('images/newMenuSprite.png') 0px -105px;}
#three a:hover{background: url('images/newMenuSprite.png') 0px -330px;}

#four{left:0px;width:250px;top:162px}
#four{background:url('images/newMenuSprite.png') 0px -157px;}
#four a:hover{background: url('images/newMenuSprite.png') 0px -382px;}

</style>

</head>

<body>

<ul id="navlist" style="top:100px">
<li id="one"><a href="h.html"></a></li>
<li id="two"><a href="t.html"></a></li>
<li id="three"><a href="m.html"></a></li>
<li id="four"><a href="l.html"></a></li>
</ul>

</body>

</html> 
```

感谢您的时间，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:12:08.557

没有必要为两个状态使用相同的图像作为`normal`背景`:hover`。只是设置`background-position`。

```
#four a:hover { background-position: 0px -382px; } 
```

# javascript - 在函数中处理异步调用 (Firebase)

> ID：11636731
> 
> 赞同：12
> 
> 时间：2012-07-24T18:06:18.270
> 
> 标签：javascript, ajax, asynchronous, firebase

现在我多次遇到使用 Firebase 的同步和异步函数的问题。我的问题通常是我需要在我编写的函数中进行异步 Firebase 调用。举个简单的例子，假设我需要计算和显示一个物体的速度，并且我的 Firebase 存储了距离和时间：

```
function calcVelocity() {
    var distance, time, velocity;

    firebaseRef.once('value', function(snapshot) {
        distance = snapshot.val().distance;
        time = snapshot.val().time;

        velocity = distance / time;
    });
    return velocity;
}

$("#velocity").html(calcVelocity()); 
```

当然，上面的代码是行不通的，因为`firebaseRef.once()`是异步调用，所以`velocity`我们到达的时候还没有设置`return velocity;`。如果我们将其`return`放在`.on()`回调函数内部，则根本不会返回任何内容。

一种解决方案是使我的`calcVelocity()`函数也异步。

另一种解决方案是存储 Firebase 的缓存版本，该版本同步读取但从 Firebase 异步更新。

这些解决方案中的一种是否比另一种更好？有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T18:36:44.183

另一种方法是使用 Promise 策略。[jQuery 有一个很棒的](http://api.jquery.com/category/deferred-object/)。

```
function calcVelocity() {
    var distance, time, velocity, def = $.Deferred();

    firebaseRef.once('value', function(snapshot) {
        distance = snapshot.val().distance;
        time = snapshot.val().time;

        def.resolve( distance / time );
    });
    return def.promise();
}

calcVelocity().then(function(vel) { $("#velocity").html(vel); }); 
```

还请记住，如果返回 null ，`snapshot.val().distance;`则可能会返回错误！`snapshot.val()`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T18:29:43.863

您确定了两种可能性：或者使您的函数也异步，或者缓存最新的 Firebase 数据，以便您可以同步访问它。考虑到您正在编写的应用程序的上下文，您使用哪一个只是偏好和方便的问题。

例如，我们注意到“动作游戏”通常由紧密的渲染循环驱动，而不是由 firebase 数据更改事件驱动。因此，缓存最新的 Firebase 数据以在渲染循环中使用是有意义的。例如：

```
var latestSnapshot = null;
firebaseRef.on('value', function(snap) { latestSnapshot = snap; }); 
```

然后您可以在渲染循环（或其他任何地方）中同步使用 latestSnapshot，尽管您需要小心处理它为空，直到第一个 firebase 回调发生。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-03T00:29:24.320

与@Kato 提供的答案相同的想法，但使用[Firebase 中的内置承诺](https://www.firebase.com/blog/2016-01-21-keeping-our-promises.html)看起来像这样

```
function calcVelocity(snapshot) {
    var distance, time, velocity;

    distance = snapshot.val().distance;
    time = snapshot.val().time;

    return distance / time;
}

function getVelocity() {
return firebaseRef.once('value').then(calcVelocity);
}

getVelocity().then(function(vel) { $("#velocity").html(vel); }); 
```

# azure - Azure 后台服务

> ID：11636735
> 
> 赞同：2
> 
> 时间：2012-07-24T18:06:29.820
> 
> 标签：azure, azure-worker-roles

我们有一个后台工作者角色，为我们运行一些服务。通信服务和通知服务。当我在本地运行我的代码时，这些服务都运行并且我能够写入日志并且一切看起来都很好。当我将我的配置文件指向生产连接字符串和其他生产变量并针对它运行我的本地代码时 - 这一切都按预期工作。当我将代码推送到 Azure 时，我的服务似乎没有运行，我不再看到任何数据写入我的日志表。

我们有另一个解决方案，我们做同样的事情（通信和通知服务），这在另一个解决方案中按预期工作。

我已经将我们工作解决方案中的所有引用与我们非工作解决方案中的那些引用进行了比较 - 所有需要的 dll 都已设置为 copyLocal=true - 我们尝试了各种不同的工具来查看问题所在，但我们还没有能够指出确切的问题。

编辑：

1.  这是后台的一个简单过程
2.  我使用内置的日志记录实用程序写入日志 - 此日志表存在于我们的 sql azure 数据库中
3.  我们验证这是否有效——考虑到服务使用 azure 实用程序启动并最终显示“就绪”——在过去发生的情况下——我们会收到错误消息，否则它会继续旋转。
4.  我们的服务由 WorkerRole.cs 文件 - Run / OnStart 启动。

# windows - 如何修改exe文件以强制它以管理员身份启动而无需源代码

> ID：11636742
> 
> 赞同：3
> 
> 时间：2012-07-24T18:07:09.223
> 
> 标签：windows, manifest, administrator

前段时间我开发了一个视频游戏，当时 WinXP 是当前的 Windows 版本。游戏需要在系统中安装自己的字体，如果它不存在的话。我不记得我在代码中是如何做到这一点的，我想我要么使用了特定的 WinAPI 函数，要么只是将字体文件复制到了 Fonts 文件夹中——无论哪种方式，当时都可以正常工作。

但是，现在有人在Win7上运行游戏时，除非用户以管理员身份运行，否则游戏无法安装字体。游戏可以运行，但使用了可怕的默认字体，因此用户甚至没有意识到有问题，只是认为游戏看起来很糟糕。

所以我需要的是使 exe 文件始终要求以管理员身份运行。我可以重新编译游戏并设置构建，以便 exe 文件始终需要管理员权限，但我没有一些我已经使用过的 SDK，因此重建可能会有些困难。

所以我想做的是：我可以以某种方式简单地修改 .exe 文件，而不需要源代码，以便它始终要求以管理员身份运行吗？

我发现我需要把它放在清单中：

```
<requestedExecutionLevel level="requireAdministrator" uiAccess="false" /> 
```

但我可以编辑 exe 文件的清单吗？我已经尝试过使用资源的 XN 资源编辑器，但它似乎无法编辑清单。

是否有可能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:17:39.580

您可以将清单创建为外部 XML 文件，并将其放在与可执行文件相同的文件夹中。命名它`YourAppName.exe.manifest`（当然，用您的实际可执行名称替换明显的名称），它应该像嵌入式资源一样工作。

外部文件示例：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <assemblyIdentity
    type="win32"
    name="YourApplication"
    version="1.0.0.0"
    processorArchitecture="*"/>
  <dependency>
    <dependentAssembly>
      <assemblyIdentity
        type="win32"
        name="Microsoft.Windows.Common-Controls"
        version="6.0.0.0"
        publicKeyToken="6595b64144ccf1df"
        language="*"
        processorArchitecture="*"/>
    </dependentAssembly>
  </dependency>
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
      <requestedPrivileges>
        <requestedExecutionLevel
          level="requireAdministrator"
          uiAccess="false"/>
      </requestedPrivileges>
    </security>
  </trustInfo>
</assembly> 
```

# jquery - 使用 val() 在多选中预选选项

> ID：11636743
> 
> 赞同：2
> 
> 时间：2012-07-24T18:07:12.650
> 
> 标签：jquery

如何使用 jquery 的 val() 在多选 html 标记中预先选择一个选项？

我的意思是说您有一个多选组件，并且您希望预先选择一些值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T18:11:03.653

假设我正确理解了您的问题，您可以将一组值传递给该[`.val()`](http://api.jquery.com/val/)方法：

```
$("#yourSelect").val(["value1", "value2"]); 
```

这是一个[工作示例](http://jsfiddle.net/jamesallardice/uXEVJ/1/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T18:13:19.963

你可以这样做：

HTML：

```
<select multiple="multiple">
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select>​ 
```

jQuery：

```
$("select").val(["volvo", "mercedes"]).prop("selected", true); 
```

这是一个例子：http: [//jsfiddle.net/HCm3e/](http://jsfiddle.net/HCm3e/)

# vba - 比较来自不同工作表的两列和匹配值

> ID：11636744
> 
> 赞同：1
> 
> 时间：2012-07-24T18:07:13.737
> 
> 标签：vba, excel, excel-2007

我的项目的目标是创建一个不在办公室的程序，该程序可以轻松跟踪和审核我们的 Sharepoint 站点，因为它没有内置系统可做。我没有 VBA 的背景，但我已经做了很多 python。话虽如此，我遇到了我的第一个问题。我不确定语法是如何工作的，以及我应该使用什么命令来获得我想要的结果。即工作表与工作表与工作表。

我有一个工作簿，一张是原始数据，我从一个 sharpoint 站点导入数据。它显示以下列

资源名称 -- 缺勤类型 -- ID -- 开始时间 -- 结束时间 -- 创建者 -- 修改者

我的下一张表是跟踪，它被称为跟踪。在此页面上，用户将他们想要跟踪的资源名称输入到 A 列中，然后剩下的列将显示该名称的缺勤次数，因此它看起来像

资源名称 -- 假期 -- 生病 -- WFH

克鲁尼，乔治 -- 2 -- 0 -- 7

计数器将根据原始数据中出现的每个实例运行，并根据原始数据中的缺勤类型将数字添加到计数器。

我需要一种方法来遍历原始数据并查找出现在跟踪数据中的名称。如果可能的话，我想将它们存储在第三个工作表中，用于测试目的。我知道我需要使用的逻辑，但我不知道将页面一起引用的语法。关于实现这一目标的最佳方法的任何见解？

**问题：** 我需要搜索从跟踪页面中出现的每个实例资源名称的原始数据并存储到另一个工作表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T19:30:43.290

如果您不想使用数据透视表（以后可能很难搜索），这是使用 COUNTIFS 的方法。该公式位于第 2 行的 Tracking 的“Sick”列中（假设第 1 行是标题）。

`=COUNTIFS('Raw Data'!A:A,Tracking!A2,'Raw Data'!B:B,"Sick")`

它假定原始数据中的名称在 A 列中，而 AbsenceType 在 B 列中，但是有多少记录并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T19:18:39.187

我理解你的问题的方式（这并不容易），你正在处理一堆时间表信息。您似乎正在尝试计算人们休假的不同类型休假的数量 - 无论是假期、生病还是在家工作 (WFH)。

我从来没有听说过某人的名字被称为“资源名称”哈哈。

你真的不需要使用 VBA 来解决这个问题 - 至少不是任何你不能只记录宏的东西 - 这似乎是一个相当简单的问题，你可以使用数据透视表来解决。

![数据透视表示例](../Images/cce909b50a948c74060b125cd0199cbf.png)

如果您愿意，您可以设置对此数据透视表的 vlookup 引用，以创建您似乎正在尝试创建的小表单。但我真的认为你最好只教那些将要使用它的人关于数据透视表。如果我误解了你的问题，请告诉我，我很乐意删除这篇文章。

# python - pip 需求文件中的平台独立性

> ID：11636752
> 
> 赞同：6
> 
> 时间：2012-07-24T18:07:33.287
> 
> 标签：python, virtualenv, pip

如何将特定于平台的内容放入需求文件中？需要一些 Windows 包而不是它们的 linux 对应包。

WinPExpect 与 pexpect pywin32 在 Linux 上不需要，但 winpexpect 需要

你知道如何处理吗？

我考虑过一个小的 python 脚本，它可以检测平台并通过运行 pip 与不同的平台特定文件以及“主要”需求文件来处理它。似乎它应该更简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T21:27:13.243

`pip`要求不允许。

[distutils2](http://packages.python.org/Distutils2/)中有关于此功能的讨论。有关更多元数据信息，请参阅[PEP 345](http://www.python.org/dev/peps/pep-0345/)。

`distutils2`有关元数据的更多信息： [http ://packages.python.org/Distutils2/library/distutils2.metadata.html](http://packages.python.org/Distutils2/library/distutils2.metadata.html)

我不知道 PEP 345 和软件包安装程序的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-17T01:29:15.087

由于这首先出现在 stackoverflow 搜索中，`[python] requirements different platforms`因此我可以指出这个后面的问题的[答案](https://stackoverflow.com/a/30449557/1124740)和[这个的](https://stackoverflow.com/a/16057099/1124740); 特别是因为`distutils2`这里其他答案中的链接现在已经死了。

# java - 自定义 SWT 组件在我与之交互时闪烁

> ID：11636754
> 
> 赞同：1
> 
> 时间：2012-07-24T18:07:38.507
> 
> 标签：java, user-interface, swt

我正在为 SWT 构建一个小部件套件（[这里](https://github.com/germantech/ios-widgets)）。
我做了一个滑块，但每次我用鼠标滚轮更改值时，它都会闪烁。

源代码可[在此处](https://github.com/germantech/ios-widgets/blob/master/br.com.germantech.iosWidgets.plugin/src/br/com/germantech/ioswidgets/slider/IOSSlider.java)获得。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T12:10:34.760

我只是`SWT.DOUBLE_BUFFERED`在实例化它们时添加到组件中

# c++ - eclipse-cdt如何与静态库链接

> ID：11636755
> 
> 赞同：14
> 
> 时间：2012-07-24T18:07:39.970
> 
> 标签：c++, eclipse-cdt

我很困惑应该在链接器/库下设置库还是将它们设置在“路径和符号”下。我认为它们是一样的。我对么？

我的问题的任何方式 - 我需要链接静态库，所以我尝试了几件事：

**首先尝试**我尝试在链接库中添加gtest（这是库）和gtest路径。这样它的编译和链接正确，但在运行时失败，因为当它试图加载共享库时（**我想要静态库！**）错误是

> 加载共享库时出错：libgtest.so.0

**第二次尝试**- 我尝试在路径和符号中定义它，将完整路径 '/root/workspace/gmock/gtest/lib/.lib/libgtest.a' 添加到库中。在这种情况下，我在链接中遇到错误：

```
g++ -L/root/workspace/gmock/lib/.libs -L/root/workspace/gmock/gtest/lib/.libs -o "playground"  ./src/p.o ./src/playground.o   -lpthread -l/root/workspace/gmock/gtest/lib/.lib/libgtest.a -l/root/workspace/gmock/lib/.lib/libgmock.a
/usr/bin/ld: cannot find -l/root/workspace/gmock/gtest/lib/.lib/libgtest.a 
```

[这篇文章](https://stackoverflow.com/questions/8332460/how-do-i-include-a-statically-linked-library-in-my-eclipse-c-project)没有给出答案，也没有解释你如何定义静态链接和共享链接。

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-25T07:40:49.070

经过大量研究并且没有相关答案。找到了！！！我在[eclipse-cdt 这个有用的链接中找到了它](http://webcourse.cs.technion.ac.il/234122/Spring2012/en/faq_Working%20with%20Eclipse%20CDT.html)

显然，该库需要存在于工作区中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-07-07T18:30:45.817

将库路径/文件添加到：Properties - C/C++ Build - Settings - GCC C++ Linker - Miscellaneous - Other objects

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-19T00:20:47.720

我将 Botan 密码库构建为静态库，出于我不想进入这里的原因，当我按照互联网上的所有步骤进行操作时，添加库路径并指定库名称，不带“lib”和“。 a”，我的项目构建得很好，但是，当我运行它时，我不断收到“程序意外终止”（或类似）错误。最后我想出了如何解决它。在菜单栏中，转到 Project > Properties > C/C++ Build > Settings > Cross G++ Linker 并在and`-static`之间添加，因此整行如下所示：`${COMMAND}``${FLAGS}`

```
${COMMAND} -static ${FLAGS} ${OUTPUT_FLAG} ${OUTPUT_PREFIX}${OUTPUT} ${INPUTS} 
```

您的可能会有所不同。我正在使用 Eclipse Luna Service Release 2 (4.4.2)，在 Windows 8.1 上使用 mingw-w64 mingw-builds 项目 w/gcc 4.9.2。

# mule - 骡子 foreach 有效载荷

> ID：11636756
> 
> 赞同：0
> 
> 时间：2012-07-24T18:07:41.533
> 
> 标签：mule

我想迭代一些 Arraylist 值，所以在有`foreach`收集的 Mule 3.3 中，我`foreach`用来迭代 ArrayList。

迭代工作正常，但在迭代之后，我需要当前的有效载荷。我没有获得当前的有效载荷，而是获得了以前的有效载荷，如`foreach`ArrayList。

```
 <flow name="">
    <component java="ArrayList"/>
    <foreach >
    <component java="getting arrayList value"/>
    </foreach>
    <logger message="DAVID#[payload]" /> 
```

在这里，我得到 java="ArrayList" 而不是这个有效载荷“getting arrayList value”

请帮助我通过 foreach 获取当前有效负载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:17:04.213

It's very hard to understand your issue.

The doc states:

> The `MuleEvent` sent to the next message processor is the same that arrived to foreach.

Isn't that what you're noticing? What else do you want?

# sql - 请教我如何写一个独特的sql语句

> ID：11636757
> 
> 赞同：-1
> 
> 时间：2012-07-24T18:07:44.377
> 
> 标签：sql, sql-server, select

下面是我需要从中提取数据的表——我只包括了在这个例子中要使用的列：

**维护表**：

```
mainkey, account
-----------------
1, 100
2, 200
3, 300 
```

**子表**：

```
linkedkeytomain, type, color
---------------------------
2, b, blue
2, y, yellow
2, r, red
2, g, green
2, w, white 
```

我的目标是能够编写一个仅显示一行数据的选择，其中 Type = 'b' and Type = 'w' and Type = 'r' only：

例如，

```
Account, c1, c2, c3
---------------------
200, blue, white, red 
```

有人可以告诉我如何获得这个复杂的选择。提前谢谢了。

布卢蒙德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:49:00.077

您的问题是您需要调整组。这是一个简单的方法：

```
select account,
       max(case when seqnum = 1 then color end) as color1,
       max(case when seqnum = 2 then color end) as color2,
       max(case when seqnum = 3 then color end) as color3
from (select account, color,
             row_number() over (partition by account order by color) as seqnum
      from maintable mt join
           childtable ct
           on ct.linkedkeytomain = mt.mainkey
     ) t
group by account 
```

# gdb - 使用 gdb 同时单步执行工作代码和错误代码

> ID：11636759
> 
> 赞同：0
> 
> 时间：2012-07-24T18:07:48.437
> 
> 标签：gdb

我有一个有错误的 C 代码和一个不显示错误的旧版本。现在，我想同时并排使用两个 gdb 会话来逐步执行代码。我正在寻找一种方法来做到这一点，而不必`n`在每个 gdb 会话中输入。换句话说，我正在寻找一种方法来链接会话，当我按下一个 gdb 命令时，它将传播到另一个会话。可以这样做吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:55:15.030

我猜你可以在单个 gdb 会话中使用[Multiple Inferiors](http://sources.redhat.com/gdb/current/onlinedocs/gdb.html#Inferiors-and-Programs)（未测试）来完成。

首先，您可以创建 2 个劣质版本，一个用于新的错误版本，另一个用于旧版本。然后你需要为命令定义[命令钩子](http://sources.redhat.com/gdb/current/onlinedocs/gdb.html#Hooks)`next`，如下所示：

```
define hookpost-next
inferior 2
next
inferior 1
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:20:47.037

您可以通过在 tmux/screen 中打开两个窗格来执行此操作。请参阅此链接[http://www.wikivs.com/wiki/Screen_vs_tmux](http://www.wikivs.com/wiki/Screen_vs_tmux)和同步窗格部分。对于 tmux：

```
ctrl-b :set-window-option synchronize-panes on|off 
```

应该做的伎俩

# jquery - Facebook Like 按钮评论框事件

> ID：11636760
> 
> 赞同：1
> 
> 时间：2012-07-24T18:07:49.150
> 
> 标签：jquery, facebook, facebook-like, facebook-javascript-sdk

我正在使用 XFBML 将一个赞按钮加载到我的页面中，并将一个事件挂接到我的按钮上。

问题是在用户填写评论框（边缘框）**后**触发事件。

我已经尝试用 CSS 隐藏它，但问题仍然存在。用户需要点击页面上的任意位置来触发我的回调函数。

这是代码示例：

```
FB.Event.subscribe('edge.create', function(response) {
    window.location = "[URL]";
} 
```

还有我的 CSS：

```
.fb_edge_comment_widget { display: none !important; } 
```

解决方案之一可能是找到一种禁用评论框的方法，但这似乎不可能。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:33:35.163

[Like Button 文档](https://developers.facebook.com/docs/reference/plugins/like/#faq)包含一种防止 Like Button 上的评论框出现的方法，或者至少概述了它不应该出现的条件：

“如果您使用的是 XFBML 版本的 Like 按钮，用户将始终可以选择添加评论。如果您使用的是 Iframe 版本的按钮，如果您使用的是“标准”，用户将可以选择评论布局宽度至少为 400 像素。如果用户确实添加了评论，则发布回 Facebook 的故事会更加突出。

[编辑：下面的备选方案 2]

另一种选择是根本不使用 Like Button 插件，而是切换到使用新[内置的 Open Graph 'Like' action](https://developers.facebook.com/docs/opengraph/actions/builtin/likes/)。这涉及几个步骤： 1\. 在 Developer Dashboard 中配置您的应用程序以添加“喜欢”全局操作。2\. 创建您自己的自定义按钮 3\. 将 API 调用附加`https://graph.facebook.com/USERID/og.likes`到该按钮（使用参数`object`和`access_token`）

鉴于此选项意味着您几乎可以控制所有客户端代码，因此您应该可以毫无问题地跟踪 Like 操作，然后执行您想要的任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T10:08:11.093

CSS“显示：无”似乎不再起作用，但为 iframe 设置固定高度对我有用：

```
iframe.fb_iframe_widget_lift {
  height: 20px !important; 
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-07-24T18:44:49.673

从此链接为您的网站生成 XFBML 代码时取消选中“发送按钮”

[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)

评论框将被删除。

# opencv - 如何处理 cv::VideoCapture 解码错误？

> ID：11636766
> 
> 赞同：12
> 
> 时间：2012-07-24T18:08:14.887
> 
> 标签：opencv, ffmpeg, h.264, decoding, ip-camera

我正在使用来自 OpenCV 的 VideoCapture（使用 ffmpeg 支持编译）从 IP 摄像机流式传输 H264 内容。

到目前为止一切正常，但每隔一段时间我就会遇到解码错误（我认为来自 ffmpeg）：

```
[h264 @ 0x103006400] mb_type 137 in I slice too large at 26 10
[h264 @ 0x103006400] error while decoding MB 26 10
[h264 @ 0x103006400] negative number of zero coeffs at 25 5
[h264 @ 0x103006400] error while decoding MB 25 5
[h264 @ 0x103006400] cbp too large (421) at 35 13
[h264 @ 0x103006400] error while decoding MB 35 13
[h264 @ 0x103006400] mb_type 121 in P slice too large at 20 3
[h264 @ 0x103006400] error decoding MB 20 3 
```

这些消息显示在控制台中。有什么干净的方法来听这些吗？我想跳过处理故障帧。

任何提示/提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-24T00:28:04.397

最近我解决了同样的问题并尝试解释我遵循的步骤。

我更新了最新的[opencv_ffmpeg.dll](https://github.com/alalek/opencv_3rdparty/tree/ffmpeg/master_20160207/ffmpeg)（我将 opencv_ffmpeg.dll 重命名为 opencv_ffmpeg310.dll 以与 OpenCV 3.1 一起使用，也将相同的 dll opencv_ffmpeg2412.dll 重命名为与 OpenCV 2.4.12 一起使用

通过这样做，基本的捕获帧和显示成功而没有问题。但是如果我进行一些图像处理或检测，仍然会出现同样的问题导致捕获帧之间的延迟。

为了解决第二个问题，我使用一个线程连续抓取帧并更新全局`Mat`以进行处理。

[在这里](https://github.com/sturkmen72/opencv_samples/blob/master/rtsp/VideoCapture-thread-test.cpp) 你可以找到我的测试代码（它需要一些改进，比如在更新 Mat 时使用互斥锁和锁定内存）

我希望这些信息有用（对不起我的英语不好）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T08:45:08.313

我也有同样的问题。在我看来，问题来自这样一个事实，即起源流的源比一个解码慢。可能对于解码，您有一个无限循环读取帧并对其进行解码，这可能比您的来源可以发送给您的要快。

我不知道如何停止并等到缓冲区已满..我正在使用一个文件，这样我的相机源会写入一个文件并在我的解码程序中从中读取帧。到目前为止，我还无法同步它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-21T09:07:31.760

sturkmen说的完全正确，opencv版本是2413，由于某种原因，我无法将opencv更新到310，我知道opencv310不会出现这样的解码错误[。](https://stackoverflow.com/a/35591041/9820874)所以首先，我将 lib **opencv_ffmpeg310_64.dll**复制到我的可执行文件路径**E:\GITHUB\JpegRtspCamera\vs2013\JpegRtspCamera\x64\Release**

然后我只删除**opencv_ffmpeg2413.dll**并将名称**opencv_ffmpeg310_64.dll**更改为**opencv_ffmpeg2413.dll**。有用！！！

# c++ - 在 C++ 中复制函数参数

> ID：11636777
> 
> 赞同：4
> 
> 时间：2012-07-24T18:08:47.647
> 
> 标签：c++

我正在阅读这本名为加速 C++ 的书。对于下面显示的“复制”

```
// error - no element at ret.end() 
copy(bottom.begin(), bottom.end(), ret.end()); 
```

书中提到，使用 ret.end() 作为第三个参数并不是绝对正确的。但是 ret.end() 会返回一个迭代器，用于 'ret' 容器的最后一个元素。有什么问题这个论点？他们建议改用'back_inserter（ret）'。为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T18:13:32.313

问题`ret.end`在于，尽管它指向容器末尾之后的位置，但在内存中的该位置或该位置之外可能没有分配任何内容。由于写入尚未分配给程序的内存位置是未定义的行为，因此您确实应该使用`back_inserter`.

# linux - 为什么我们需要 mktemp？

> ID：11636790
> 
> 赞同：62
> 
> 时间：2012-07-24T18:09:19.240
> 
> 标签：linux, shell, filesystems

我不明白`mktemp`临时文件的功能和含义。

`touch xyz`say和之间有什么区别`mktemp xyz`（除了`mktemp`会创建一些附加了 xxx 的文件并具有 600 个权限的事实之外？）

请澄清。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-07-24T18:14:09.317

`mktemp`随机化名称。从安全的角度来看，这是非常重要的。

想象一下，你做了类似的事情：

```
echo something > /tmp/temporary-file 
```

在您的根运行脚本中。

有人（读过你的剧本）确实

```
ln -s /etc/passwd /tmp/temporary-file 
```

前。

这会导致`/etc/passwd`被覆盖，并且可能意味着从系统开始的不同不愉快的事情被破坏，以系统结束的事情被黑客入侵（当输入`something`可以精心设计时）。

在这种情况下，该`mktemp`命令可以帮助您：

```
TEMP=$(mktemp /tmp/temporary-file.XXXXXXXX)
echo something > ${TEMP} 
```

现在这种`ln /etc/passwd`攻击将不起作用。

*简要了解 mktemp 的历史*：该`mktemp`命令由 OpenBSD 人员发明，并于 1997 年首次出现在 OpenBSD 2.1 中。他们的目标是提高 shell 脚本的安全性。以前的标准是添加`$$`临时文件名，这绝对不安全。现在所有的 UNIX/Linux 系统都有`mktemp`或者它的替代品，它成为事实上的标准。有趣的是，`mktemp`C 函数因不安全而被弃用。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-07-24T18:13:37.373

您经常需要一个“便签本文件”（或目录）。此外，您可能同时需要几个这样的文件，并且您不想费心弄清楚如何命名它们，这样就不会发生冲突。

“mktemp”符合要求 :)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-11-27T12:03:34.777

还有一个额外的原因：并非所有系统都`/tmp`用作临时目录。例如[https://termux.com/](https://termux.com/)由于技术原因（它在 Android 内部作为进程运行），具有不同的长路径，因为它是 tmp 目录。

使用创建临时文件或目录的脚本`mktemp`将是可移植的，并且也可以在此类特殊环境中工作。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-07-24T18:28:49.947

好的，实际上它在手册页中写得很清楚。

> mktemp - 创建一个临时文件或目录。
> 
> 安全地创建一个临时文件或目录，并打印其名称。

它安全地创建文件或目录意味着没有其他用户可以访问它，这就是它的权限为 600 的原因

> touch - 更改文件时间戳

如果已经创建文件，它只是更改文件的时间戳，如果不存在则创建文件。但是文件权限默认还是644。

有关更多详细信息，请查看以下手册页：

[http://linux.die.net/man/1/mktemp](http://linux.die.net/man/1/mktemp)

[http://linux.die.net/man/1/touch](http://linux.die.net/man/1/touch)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-17T16:04:57.737

至少在 bash shell 中，您可以执行以下操作：

```
dirpath="/tmp/dir1-$$/dir2-$$"  
mkdir -p $dirpath  
chmod -R 0700 /tmp/dir1-$$ 
```

例如。

# osgi - 管理通过使用约束声明的传递包依赖项

> ID：11636795
> 
> 赞同：1
> 
> 时间：2012-07-24T18:09:46.297
> 
> 标签：osgi, apache-felix

我有包 A、B 和 C。A 包含一个包“a”，它分别由包 B 和 C 中的包 b 和 c 中的代码依赖。

```
bundle A {
  package a

  export-package:a
}

bundle B {
  package b.a
  package b.b
  package b.c
  package b.d
  package b.e

  import-package: a
  export-package:b.a;uses:=a,
    b.b;uses:=b.a,
    b.c;uses:=b.b,
    b.d;uses:=b.c,
    b.e;uses:=b.d
}

bundle C {
  package c

  import-package: b.e,
    a
} 
```

当我一起更新所有这些包时，我经常会遇到使用约束违规（Felix 报告风格）：

```
Chain 1:
  C [47.1]
    import: (&(osgi.wiring.package=a)(version>=1.1.0))
     |
    export: osgi.wiring.package=a
  A [9.1]

Chain 2:
  C [47.1]
    import: (&(osgi.wiring.package=b.e)(version>=1.0.0))
     |
    export: osgi.wiring.package=b.e; uses:=a
  B [33.0]
    import: (&(osgi.wiring.package=a)(version>=1.0.0))
     |
    export: osgi.wiring.package=a
  C [9.0] 
```

最初我很惊讶会为“a”生成一个使用子句。这未在 Manifest 或提供这些捆绑包的 OBR repository.xml 中声明。但是，类型是通过它们的 API 公开类型的，所以我想这就是它的来源。

我发现解决这些问题的唯一方法是增加中间包的导出和导入的版本号，例如在这个例子中。但是，有很多包最终使用“a”，可传递。

**这意味着每次更新 'a' 时，我还需要使用新版本更新 a 上的所有传递依赖项。**增加这些软件包的版本号是否正确？重构我的代码以减少相互依赖是唯一的另一种方式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T20:14:40.993

使用约束不被解析器传递处理。

如果 bundle C 导入 be 和 be 使用 bd，那么 bundle C 也需要导入 bd 即 be 的公共签名包含对 bd 中某物的引用 这就是为什么我们说 be 使用 bd 因此，任何导入 be 的 bundle 也必须import bd 否则，bundle 无法正确使用 be，因为 be 中引用的某些类型对 bundle 不可见。

对于 be 的导出，它应该说明它使用 bd、bc、bb、ba 和 a，因为使用 bd 意味着你也使用 bc 等等......

您是否手动生成了您的使用条款？或者这个例子是从 bnd 生成的东西衍生而来的？

# java - 创建 BufferedReader 以读取 URL 导致错误：无法启动活动

> ID：11636796
> 
> 赞同：1
> 
> 时间：2012-07-24T18:09:46.993
> 
> 标签：java, android, bufferedreader, urlconnection

我正在尝试阅读 URL 的内容。BufferedReader 的初始化不断导致崩溃。

我已经尝试查找人们的解决方案，但无论我做什么，我都会收到此错误。

这是我的代码：

```
 try {
        String sUrl = "http://www.google.com";
        System.out.println("About to create URL.");
        URL url = new URL(sUrl);
        System.out.println("Created URL");

        System.out.println("About to create URLConnection");
        URLConnection urlc = url.openConnection();
        System.out.println("Created URLConnection");

        System.out.println("About to create the BufferedReader");
        BufferedReader bR = new BufferedReader(new 
            InputStreamReader(urlc.getInputStream()));
        System.out.println("Created the BufferedReader");

        System.out.println("About to create a StringBuilder");
        StringBuilder sBuilder = new StringBuilder();
        System.out.println("Created StringBuilder");

        int byteRead;
        System.out.println("About to enter while loop and build string");
        while ((byteRead = bR.read()) != -1)
        {
            sBuilder.append((char) byteRead);
        }
        System.out.println("Built string");

        bR.close();
        System.out.println("Buffered reader is closed");
        String text = sBuilder.toString();
        System.out.println(text);
} 
catch (IOException e) 
{
//
} 
```

这是我得到的（一些）日志：

```
07-24 13:56:17.546: I/System.out(1554): About to create URL.
07-24 13:56:17.557: I/System.out(1554): Created URL
07-24 13:56:17.557: I/System.out(1554): About to create URLConnection
07-24 13:56:17.557: I/System.out(1554): Created URLConnection
07-24 13:56:17.557: I/System.out(1554): About to create the BufferedReader
07-24 13:56:17.576: D/AndroidRuntime(1554): Shutting down VM
07-24 13:56:17.576: W/dalvikvm(1554): threadid=1: thread exiting with uncaught exception   
                                      (group=0x40a13300)
07-24 13:56:17.606: E/AndroidRuntime(1554): FATAL EXCEPTION: main
07-24 13:56:17.606: E/AndroidRuntime(1554): java.lang.RuntimeException: Unable to start 
                                     activity ComponentInfo{com. ... 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:12:34.957

从 Android 3.0 开始，在主 UI 线程中打开 url 连接是不合法的。您**必须**在 AsyncTask/Background 线程中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:19:09.670

**1.**始终建议让**UI 工作在 UI 线程上，而 Non-UI 工作在 Non-UI 线程上，这****从 HoneyComb 版本的 Android**开始成为一个规律。

**此外尝试下面的代码....**

```
public final String sUrl = "http://www.google.com";

new Thread(new Runnable(){

public void run(){

URL url = new URL(sUrl);

InputStream i = url.openStream();

InputStreamReader isr = new InputStreamReader(i);

BufferedReader br = new BufferedReader(isr);

StringBuilder sb = new StringBuilder();

String s = null;

while ((br.readLine())!=null){

  sb.append(br.readLine());

  }

  s = sb.toString();

 System.out.println(s);

     }
   }).start(); 
```

**2.**这个代码本来可以更小`InputStream and Scanner`，**但正如你所提到** `BufferedReader`的，**我用它**......

**3.**也可以使用`AsyncTask`专为android设计的**无痛线程，轻松同步UI和Non-UI线程。**

# ios - iOS purgeIdleCellConnections

> ID：11636797
> 
> 赞同：7
> 
> 时间：2012-07-24T18:09:50.100
> 
> 标签：ios, xcode, nsurlconnection

从应用程序中的模型类从互联网下载大量 png 图像后不久，我得到了 purgeIdleCellConnections 列表。

**这是对应用程序的威胁吗？它不会冻结。我应该手动关闭连接吗？**

谢谢！

xcode 4.2.1，ARC，部署到 ios 5.0+

编辑：我在控制台中看到了列表。此外，我只在 3G 网络上通过手机进行测试时看到它，而不是在 wifi 上。在模拟器中也不会发生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:16:01.470

我不知道您在哪里看到“purgeIdleCellConnections 列表”。

如果您的意思是在管理器控制台中，这可能是正常的：您刚刚停止下载东西，所以大概现在有一堆空闲的蜂窝网络连接可以关闭以节省电力（无论如何，这是我的看法）。

# c# - ASP.NET MVC + EF 性能

> ID：11636803
> 
> 赞同：1
> 
> 时间：2012-07-24T18:10:23.467
> 
> 标签：c#, asp.net-mvc, entity-framework, dependency-injection, ef-code-first

我的控制器中有这段代码：

```
public class MyController : Controller
{
  private readonly IMyRepository myRepository;

  public MyController() : this(new MyRepository())
  {}

  public MyController(IMyRepository myRepository)
  {
    this.myRepository = myRepository;
  }

  public ActionResult Index()
  {
    return View(myRepository.GetData());
  }
} 
```

MyRepository 使用 EF 进行数据操作。每次用户加载此页面时，MyRepository 实例都会创建。这意味着 EF 上下文正在创建并且 Fluent API 代码正在执行（OnModelCreating 方法）。

每次用户加载页面时是否有可能不创建 EF 上下文？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T20:29:37.957

> MyRepository 使用 EF 进行数据操作。每次用户加载此页面时，MyRepository 实例都会创建。这意味着 EF 上下文正在创建并且 Fluent API 代码正在执行（OnModelCreating 方法）。

你错了。在 OnModelCreating 方法上放置一个断点。当您的应用程序加载时，此方法只会被命中一次。如果您重建项目，它将再次遇到断点，因为这会导致二进制 dll 重新加载到应用程序域中。但是，如果您让应用程序运行并两次点击控制器操作（中间没有重建），您将看到`OnModelCreating`第二次不会被点击。[就像 Serg Rogovtsev 所说](https://stackoverflow.com/a/11636920/304832)，EF 在 OnModelCreating 期间创建模型（即模式）后对其进行缓存。

我对[Serg Rogovtsev 的回答](https://stackoverflow.com/a/11636920/304832)的唯一反对意见是我永远不会创建 DbContext 的单例实例。相反，您应该为每个 HttpContext （也就是每个 Web 请求）使用一个实例。如果您将其用作单例，并且启用了并发，您最终会看到 DbConcurrencyExceptions 在您的应用程序中蔓延。使用 DI/IoC，并在请求响应周期的开始/结束时创建/处置 DbContext 实例。这是最好的做法。不要担心创建`new MyDbContext()`实例的开销。在第一次构建期间 EF 初始化（预热）之后，未来的构建将相当便宜。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:18:41.527

要回答您的问题：您可以创建存储库的单例，或者您可以使用 DI 容器来为您保存单个实例。

但重点是：如果你在里面设置断点，`OnModelCreating`你会发现每个应用程序实例只调用一次。EntityFramework 使用非常有效的模型缓存。因此，您不必担心创建 EF 上下文会导致性能下降。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:14:31.063

更改您的控制器，以便您以惰性方式创建存储库的实例。例如，您可以使用[Lazy < T >](http://msdn.microsoft.com/en-us/library/dd642331.aspx)类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:21:39.530

在性能方面，我更倾向于保留数据而不是上下文，EF 上下文经过优化以创建并释放池中的连接。[http://www.sql-server-performance.com/2012/entity-framework-performance-optimization/](http://www.sql-server-performance.com/2012/entity-framework-performance-optimization/)上的其他一些 EF 性能方法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T18:26:11.213

最佳做法是在检索/更新数据后处理 EF 上下文。

# hibernate - 使休眠二级缓存中的对象无效

> ID：11636804
> 
> 赞同：0
> 
> 时间：2012-07-24T18:10:25.403
> 
> 标签：hibernate, ehcache

我有一个使用 Hibernate 和 ehcache 作为二级缓存的应用程序。我一直在试图弄清楚如何使缓存中的特定对象无效，从而强制休眠在下次引用它时从数据库中重新加载它。

是否有捷径可寻？

我已经尝试了几件事，但到目前为止都没有成功。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:49:05.870

您可以使用：

`SessionFactory.getCache().evictEntity(Class entityClass, Serializable identifier)`

# java - Java替换文件正则表达式

> ID：11636805
> 
> 赞同：0
> 
> 时间：2012-07-24T18:10:36.837
> 
> 标签：java, regex, file, replace, pattern-matching

我想在一个文件中放入一些正则表达式并用分号（或其他东西）分隔另一个表达式，即：

```
orderNumber:* completionStatus;orderNumber:X completionStatus 
```

我将有一个日志文件将有：

```
.... orderNumber:123 completionStatus... 
```

我希望它们看起来像：

```
.... orderNumber:X completionStatus... 
```

我怎样才能在 Java 中做到这一点？

我尝试使用（键：正则表达式和值：替换）创建一个 Map，读取我的日志文件并为每一行尝试匹配键，但我的输出看起来相同。

```
FileInputStream fstream = new FileInputStream(file);
// Get the object of DataInputStream
DataInputStream in = new DataInputStream(fstream);
BufferedReader br = new BufferedReader(new InputStreamReader( in ));
FileWriter fstreamError = new FileWriter(myFile.replace(".", "Replaced."));
BufferedWriter output = new BufferedWriter(fstreamError);

while ((strFile = br.readLine()) != null) {
    for (String clave: expressions.keySet()) {
        Pattern p = Pattern.compile(clave);
        Matcher m = p.matcher(strFile); // get a matcher object
        strFile = m.replaceAll(expressions.get(clave));
        System.out.println(strFile);
    }
} 
```

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:57:52.353

看来你走在一条好路上。但是，我会建议几件事：

1.  不要每次都编译正则表达式。您应该将它们全部预先编译，并在循环中从它们中生成新的匹配器。
2.  您并没有真正将地图用作地图，而是将其用作对的集合。您可以轻松地制作一个小的`class RegexReplacement`，然后`List<RegexReplacement>`在循环中迭代一个。

* * *

```
class RegexReplacement { 
  final Pattern regex;
  final String replacement;
  RegexReplacement(String regex, String replacement) {
    this.regex = Pattern.compile(regex);
    this.replacement = replacement;
  }
  String replace(String in) { return regex.matcher(in).replaceAll(replacement); }
} 
```

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:43:25.983

这是你想要的？

```
import java.text.MessageFormat;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RegexpTests {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub
    String text = "orderNumber:123 completionStatus";
    String regexp = "(.*):\\d+ (.*)";
    String msgFormat = "{0}:X {1}";

    Pattern p = Pattern.compile(regexp);
    Matcher m = p.matcher(text);

    MessageFormat mf = new MessageFormat(msgFormat);
    if (m.find()) {
        String[] captures = new String[m.groupCount()];
        for (int i = 0; i < m.groupCount(); i++) {
            captures[i] = m.group(i + 1);
        }
        System.out.println(mf.format(msgFormat, captures));
    }

}

} 
```

# common-lisp - eval 形式应该在空词法环境中评估给定形式，我没有得到我期望的结果

> ID：11636807
> 
> 赞同：13
> 
> 时间：2012-07-24T18:10:38.810
> 
> 标签：common-lisp

假设我有一个特殊的 var：

```
(defvar x 20) 
```

然后我执行以下操作：

```
(let ((x 1)) (eval '(+ x 1)) 
```

评估为 2。

根据 CLHS，eval “在当前动态环境和空词法环境中评估形式”。所以，我希望得到 21 而不是 2。

我错过了什么吗？

现在，如果我没有符号 y 的动态绑定，则评估

```
(let ((y 1)) (eval '(+ y 1)) 
```

我得到条件：“变量 Y 未绑定”，这是有道理的，因为 y 没有动态绑定。

注意：我使用的是 SBCL 1.0.57

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T19:06:06.247

在您的示例`x`中是`special`这意味着它绑定在*动态环境中*

`y`并不特殊，*所以在**词法环境*中是绑定的

 ** * *

所以在第一次的时候，`eval`环境可以这样表示：

```
dynamic environment:  { x : 1 } -> { x : 20, ...other global variables... } -> nil
lexical environment:  nil 
```

该符号`x`很特殊，因此在*当前*动态环境中查找并`eval`找到`x`*`x = 1`*

 ** * *

假设它在与上一个示例相同的 lisp 中运行，您的第二个环境`eval`如下所示：

```
dynamic environment: { x : 20,  ...other global variables... } -> nil
lexical environment: { y :  1 } -> nil 
```

该符号`y`并不特殊，因此在*空* 词法环境中查找 -而*不是**当前*的词法环境 - 并没有找到任何东西。`eval``y`

 **当您意识到 lisp 通常是编译的，并且`mov`在某些情况下可以将词法环境优化为简单的指令时，这是有道理的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T19:27:33.090

`DEFVAR`声明它的变量是特殊的。全球，无处不在。您也不能轻易删除它。

这也是你永远不应该使用常见名称（如`x`, `i`, ）`list`作为`DEFVAR`. 确保使用`*x*`,`*i*`和`*list*`代替。否则，所有具有这些通用名称的变量，甚至是局部变量，都被声明为特殊的。****

# c# - 如何在字符的第一个实例处截断字符串？

> ID：11636812
> 
> 赞同：1
> 
> 时间：2012-07-24T18:11:11.477
> 
> 标签：c#, .net, string

我目前有一个字符串`1_0707201206050239`，我想截断包括字符在内的所有`_`字符。

问题是左侧的字符会根据用户输入而变化，因此字符串的长度总是不同的。的右侧`_`表示日期和时间（例如`07-07-2012 6:05:02.390AM`），长度可以在 17-14 个字符之间变化。

所以我想知道是否有办法截断直到`_`检测到？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T18:14:18.880

```
text.Substring(0, text.IndexOf('_')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:15:58.037

您还可以使用：

```
String.Substring(0, String.indexOf('_')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:25:09.327

如何使用 String.Remove

```
theString = theString.Remove(sourceString.IndexOf('_'), 1); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-23T17:17:25.960

怎么样，如果字符串中没有出现字符，则返回整个字符串：

```
static class StringExtensions
{
    internal static string TruncateAtFirst(this string str, params char [] ch)
    {
        int i = str.IndexOfAny(ch);
        return (i < 0 ? str : str.Substring(0, i));
    }
}

"abcdefg".TruncateAtFirst('c')      // "ab" 
"abcdefg".TruncateAtFirst('e', 'b') // "a"
"abcdefg".TruncateAtFirst('z')      // "abcdefg"
       "".TruncateAtFirst('z')      // "" 
```

使用字符串也很容易。

# django - 用户通过 LAN (Django) 访问网站的权限

> ID：11636819
> 
> 赞同：0
> 
> 时间：2012-07-24T18:12:04.200
> 
> 标签：django, apache, apache2, mod-wsgi

我被困在这个问题上。想法是允许通过局域网或本地网络访问我的网站的用户跳过登录页面并以具有特殊权限的匿名用户身份访问该网站。（我正在运行一个带有 apache2 和 mod_wsgi 的 ubuntu 服务器）。有谁知道 apache 是否有办法确定用户是否通过 LAN 访问该网站？我对所有建议持开放态度，因为我目前不知道如何解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:57:26.800

最简单的方法是只查看远程 IP。如果它在您的 LAN 子网中，那么您就知道它们是本地的。但是，通常的免责声明和所有内容：虽然 REMOTE_ADDR*在大多数*情况下可以安全使用，但在某些情况下*可能*会被欺骗。它需要访问 ISP 或类似的服务（只有当您试图侵入银行并获得足够的钱以在您的余生中躲在某个僻静的岛屿度假胜地时，才值得进行黑客攻击），或访问本地网络本身，所以在任何一种情况下都有点幻想，但安全的黄金法则是“做最坏的打算，抱最好的希望”。*任何*入侵场景通常都是太高的代价，无法为缺乏安全性给您带来的任何小便利付出代价。

也就是说，我会将其视为一种教育练习。您仍然需要至少一个用户，该用户可以简单地在所有本地网络用户之间共享（顺便说一下，另一个 honkin 大红色安全标志）。您将检查 IP 地址，确定它是否在您的子网中，如果是，则使用存储的凭据登录共享用户（又一个 honkin' 大红色安全标志）。

```
from django.contrib.auth import authenticate, login

class PleaseHackMeMiddleware(object):
    def process_request(self, request):
        if re.search(r'^192.168.1', request.META['REMOTE_ADDR']):
            user = authenticate('shared_username', 'shared_password')
            if user:
                login(request, user) 
```

然后，只需将其添加到`MIDDLEWARE_CLASSES`并等待坏事发生。

# mono - Monodevelop目标平台

> ID：11636822
> 
> 赞同：0
> 
> 时间：2012-07-24T18:12:20.693
> 
> 标签：mono, monodevelop

我正在编写一个应该是跨平台的库，但它需要不同的实现，具体取决于我想要定位的平台。*对于每个*目标，我还想在项目中包含一组文件。我怎样才能做到这一点？

编辑：如果我可以[针对特定的 .NET 运行时](http://monodevelop.com/Download/What%27s_new_in_MonoDevelop_2.2)（Microsoft 的 .NET 或 Mono）也很好，而且我已经看到了这个选项——它在项目选项中的 Build/General 中。我不确定这是我需要的。

另一个编辑：我想我也可以使用预处理器`if`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:24:07.753

查看[http://www.mono-project.com/Guidelines:Application_Portability](http://www.mono-project.com/Guidelines:Application_Portability)以获取一般指南，并[隔离 Mono 特定代码](https://stackoverflow.com/questions/721161/how-to-detect-which-net-runtime-is-being-used-ms-vs-mono)以进行修复。

# c# - 对大型数据集的可枚举 LINQ 查询结果使用 ToList() - 效率问题？

> ID：11636836
> 
> 赞同：4
> 
> 时间：2012-07-24T18:12:59.410
> 
> 标签：c#, linq, optimization, .net-4.0, type-conversion

我一直在我正在编写的应用程序中大量使用 LINQ 查询，而我一直遇到的一种情况是必须将 LINQ 查询结果转换为列表以进行进一步处理（我有我的理由想要的清单）。

我想更好地了解此列表转换中发生的情况，以防效率低下，因为我现在已经反复使用它。所以，假设我执行这样的一行：

```
var matches = (from x in list1 join y in list2 on x equals y select x).ToList(); 
```

**问题：**

1.  除了创建一个新列表及其对查询返回的 Enumerable 中的元素的引用之外，这里是否还有任何开销？

2.  你会认为这是低效的吗？

3.  有没有办法让 LINQ 查询直接生成列表以避免在这种情况下需要转换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T18:15:37.350

好吧，它会创建数据的副本。这*可能*效率低下 - 但这取决于发生了什么。如果你最后*需要*一个`List<T>`，`List<T>`通常会接近你得到的效率。一个例外是，如果您*只*进行转换并且源已经是一个列表 - 那么使用`ConvertAll`会更有效，因为它可以创建正确大小的支持数组开始。

如果您*只*需要对数据进行流式传输——例如，您只需对其`foreach`进行操作，并采取不影响原始数据源的操作——那么调用`ToList`绝对是低效率的潜在来源。它将强制对整个`list1`进行评估 - 如果这是一个延迟评估的序列（例如“来自随机数生成器的前 1,000,000 个值”），那就不好了。请注意，当您进行连接时，*无论如何*`list2`都会在您尝试从序列中提取第一个值时进行评估（无论是否为了填充列表）。

 *您可能想阅读我的[Edulinq 帖子，`ToList`](http://codeblog.jonskeet.uk/2011/01/01/reimplementing-linq-to-objects-part-20-tolist/)以了解在后台发生了什么——至少在一种可能的实现中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:18:07.890

1.  除了那些已经被你指定的那些之外，没有任何其他的overhed。

2.  我会说是的，但这取决于具体的应用场景。顺便说一句，*通常*最好避免额外的调用。（我认为这很明显）。

3.  恐怕不是。`LINQ query`返回*一个*数据序列，这可能*是*一个无限序列。转换为您使其成为 finit，还可以进行索引访问，这在*sequence*或*stream*`List<T>`中是不可能的。

 **建议：避免出现需要`List<T>`. 顺便说一句，如果您需要它，请在当前时刻尽可能少地推送您需要的数据。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:25:04.070

除了已经说过的内容之外，如果您要加入的最初两个列表已经非常大，那么创建第三个（创建两者的“交集”）可能会导致内存不足错误。如果您只是迭代 LINQ 语句的结果，您将显着减少内存使用量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:59:33.693

`Enumerable.ToList(source)`本质上只是对`new List(source)`.

此构造函数将测试 source 是否为`ICollection<T>`，如果它分配了适当大小的数组。在其他情况下，即源是 LINQ 查询的大多数情况下，它将分配一个具有默认初始容量（四个项目）的数组，并根据需要通过将容量加倍来增长它。每次容量翻倍时，都会分配一个新数组，并将旧数组复制到新数组中。

如果您的列表有很多项目（我们可能至少要谈论数千个），这可能会带来一些开销。一旦列表增长超过 85 KB，开销就会很大，因为它随后会分配到未压缩的大对象堆上，并且可能会遭受内存碎片的影响。请注意，我指的是列表中的数组。如果`T`是引用类型，则该数组仅包含引用，而不包含实际对象。这些对象不计入 85 KB 限制。

如果您可以准确估计序列的大小（在这种情况下，高估一点比低估一点要好），您可以消除一些这种开销。例如，如果您只`.Select()`在实现的东西上运行运算符`ICollection<T>`，您就知道输出列表的大小。

在这种情况下，此扩展方法将减少此开销：

```
public static List<T> ToList<T>(this IEnumerable<T> source, int initialCapacity)
{
    // parameter validation ommited for brevity

    var result = new List<T>(initialCapacity);

    foreach (T item in source)
    {
        result.Add(item);
    }

    return result;
} 
```

在某些情况下，您创建的列表只是要替换已经存在的列表，例如以前运行的列表。在这些情况下，如果您重用旧列表，则可以避免相当多的内存分配。但是，只有在您无法同时访问该旧列表时，这才有效，如果新列表通常比旧列表小得多，我不会这样做。如果是这种情况，您可以使用此扩展方法：

```
public static void CopyToList<T>(this IEnumerable<T> source, List<T> destination)
{
    // parameter validation ommited for brevity

    destination.Clear();

    foreach (T item in source)
    {
        destination.Add(item);
    }
} 
```

话虽这么说，我会考虑`.ToList()`效率低下吗？不，如果您有内存，并且您将重复使用该列表，要么对它进行大量随机索引，要么对其进行多次迭代。

现在回到你的具体例子：

```
var matches = (from x in list1 join y in list2 on x equals y select x).ToList(); 
```

以其他方式执行此操作可能更有效，例如*：*

```
var matches = list1.Intersect(list2).ToList(); 
```

如果 list1 和 list2 不包含重复项，这将产生相同的结果，并且如果 list2 很小，则非常有效。

不过，像往常一样，真正了解的唯一方法是使用典型的工作负载进行测量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T19:00:10.543

1.  大多数开销发生在创建列表之前，例如与数据库的连接，将数据获取到
    适配器，对于 var 类型，.NET 需要确定它的数据类型/结构......

2.  效率是非常相对的术语。对于不擅长 SQL 的程序员来说，1 中详述的开销是高效、更快的开发（相对于旧的 ADO）。

3.  另一方面，LINQ 可以从数据库本身调用过程，这已经更快了。我建议你进行下一个测试：

    *   在最大数量的数据上运行您的程序并测量时间。
    *   使用一些数据库程序将数据导出到文件（如 XML、CSV、....）并尝试从该文件构建您的列表并测量时间。然后您可以查看差异是否显着。但第二种方式对程序员来说效率较低，但可以减少运行时间。***

# shell - 在 shell 脚本中更改为 root 用户

> ID：11636840
> 
> 赞同：24
> 
> 时间：2012-07-24T18:13:20.080
> 
> 标签：shell, su

我有一个 shell 脚本，它需要非 root 用户帐户来运行某些命令，然后将用户更改为 root 以运行脚本的其余部分。我正在使用 SUSE11。我用过expect来自动化密码提示。但是当我使用 spawn su - 并且命令被执行时，提示会以 root 身份返回，并且脚本的其余部分不会执行。

例如。

```
< non-root commands>
 spawn su -
<root commands> 
```

但是在 su - 之后，提示以 root 用户身份返回。如何执行剩余的脚本。

sudo -S 选项没有帮助，因为它不运行我需要查找机器 IP 地址的 sudo -S ifconfig 命令。

我已经浏览了这些链接，但找不到解决方案： [Change script directory to user's homedir in a shell script](https://stackoverflow.com/questions/521226/change-script-directory-to-users-homedir-in-a-shell-script)

[在 shell 脚本中更改 unix 用户](https://stackoverflow.com/questions/11493464/changing-unix-user-in-a-shell-script)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-24T18:20:01.027

`sudo`将在这里工作，但你需要稍微改变你的脚本：

```
$ cat 1.sh 
id 
sudo -s <<EOF
echo Now i am root
id
echo "yes!"
EOF

$ bash 1.sh
uid=1000(igor) gid=1000(igor) groups=1000(igor),29(audio),44(video),124(fuse)
Now i am root
uid=0(root) gid=0(root) groups=0(root)
yes! 
```

您需要在`<<EOF`块中运行命令并将块提供给`sudo`.

如果你愿意，你`su`当然可以使用 。但是您需要使用`expect/pexpect`它将为您输入密码来运行它。

但即使您可以设法自动输入密码（或将其关闭），这种构造也不起作用：

```
user-command
su 
root-command 
```

在这种情况下`root-command`，将使用用户执行，而不是 root 权限，因为它将`su`在完成后执行（`su`打开一个新的 shell，而不是更改当前 shell 的 uid）。您当然可以在这里使用相同的技巧：

```
su -c 'sh -s' <<EOF
# list of root commands
EOF 
```

但是现在你和 with 一样`sudo`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-08-07T08:14:06.257

有一种简单的方法可以在没有第二个脚本的情况下做到这一点。只需将其放在文件的开头：

```
if [ "$(whoami)" != "root" ]
then
    sudo su -s "$0"
    exit
fi 
```

然后它将自动以root身份运行。当然，这假设您`sudo su`无需提供密码即可 - 但这超出了此答案的范围；有关如何执行此操作，请参阅有关在 shell 脚本中使用 sudo 的其他问题之一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-11-12T19:31:28.340

短版：创建一个块来包含所有以 root 身份运行的命令。

例如，我创建了一个脚本来从根子目录运行命令，该段如下所示：

```
sudo su - <<EOF
cd rootSubFolder/subfolder
./commandtoRun
EOF 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-16T13:13:17.380

最简单的方法是创建至少两个脚本。

第一个应该以 root 权限调用第二个。因此，您在第二个脚本中执行的每个命令都将以 root 身份执行。

例如：

**runasroot.sh**

```
sudo su-c'./scriptname.sh' 
```

**脚本名.sh**

```
apt-get install mysql-server-5.5 
```

或任何你需要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-12-25T05:58:52.090

另外，请注意，如果您在下面的 shell 脚本中更改为“root”用户，则很少有 Linux 实用程序（如用于数据提取的 awk 或定义一个简单的 shell 变量等）会表现得很奇怪。

要解决此问题，只需使用 <<'EOF' 代替 EOF 来引用整个文档。

```
sudo -i <<'EOF'
ls
echo "I am root now"
EOF 
```

# css - 您可以为跨浏览器兼容的 CSS 三角形设置不透明度吗

> ID：11636841
> 
> 赞同：-3
> 
> 时间：2012-07-24T18:13:27.650
> 
> 标签：css

我希望创建使用 css 箭头的面包屑，并希望在背景上应用渐变，但无法为 css 三角形本身设置渐变。

我想知道是否可以在三角形上设置不透明度，然后将它们放在具有所需背景渐变的 div 顶部。这也必须兼容到 IE7。到目前为止还没有运气。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:19:05.087

这是您设置不透明度或 <=IE8 的方式

```
.triangle {
  filter: Alpha(Opacity=80); // ie argh!
  opacity: 0.8; // standard browsers
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:16:13.167

使用 PNG 图像作为箭头。箭头图像必须具有透明背景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:16:26.833

实现您的目标的最佳方法是使用图像。IE7 我认为没有一些 javascript 操作不支持不透明度。使用具有透明背景的 gif 或其他类型的图像。

# javascript - 复选框更改总计

> ID：11636855
> 
> 赞同：0
> 
> 时间：2012-07-24T18:14:34.963
> 
> 标签：javascript, jquery, joomla2.5

我需要一些代码方面的帮助。

我有一个表格，有三种不同的计划可供选择。然后在第二页上，您可以选中一个框以添加配偶，并且总数需要更改。我不知道如何编码。

**第一页**

此页面显示三个计划选项供客户选择。

计划一（标准）是 99 美元的安装费和每月 99 美元。

计划二（高级）是 149 美元和 120 美元

计划三（白金）是 399 美元和 185 美元

**第二页**

这是最终用户填写信息的表格。可以选择以每月 35% 的折扣添加配偶。

当他们[b]检查[/b]添加配偶复选框时，我需要更改总数。

**情侣总数**

如果是计划一（标准），则设置费为 198 美元，每月 163.35 美元。

如果计划二（高级）然后 $298 安装费和 $198 每月。

如果是计划三（白金），则设置费为 798 美元，每月 305.25 美元。

知道如何完成这个吗？

```
<div class="ccms_form_element cfdiv_checkbox" id="addspouse_container_div"><input type="hidden" name="spouse" value="" alt="ghost">
<input value="Yes" id="addspouse" title="" type="checkbox" name="spouse" class="label_right">
<label for="addspouse" class="full_label">Yes! I want to sign up my spouse and take advantage of the 35% discount. (Couples discount applies to spouse's monthly fee only.)</label><div class="clear"></div><div id="error-message-spouse"></div></div>

<div id="math" style="padding-bottom:4px;">
<p id="sign-up-date-first" style="display: block; "><b>Sign Up Date</b> (Today): <span id="sign-up-date-today" style="border: 0px; background-color: rgb(255, 255, 255); "><?php
echo date("F dS, Y");
?> </span></p>

<p id="signup-fee-result"><b>Review/Setup Fee</b>: <span id="signup-fee-price" style="margin-left: 4px;">$49.00 </span> will be charged: <span class="next-month" id="sign-up-date-six-days"><?php
$monthlydate = mktime(0,0,0,date("m"),date("d")+6,date("Y"));
echo date("F dS, Y", $monthlydate);
?></span>
</p>

 <p id="signup-price-result"><b>Initial Monthly Fee</b>: <span id="signup-monthly-price">$49.00 </span> will be charged: <span class="next-month" id="sign-up-date-next-month"><?php
$monthlydate = mktime(0,0,0,date("m"),date("d")+30,date("Y"));
echo date("F dS, Y", $monthlydate);
?></span></p>
</div> 
```

# linux-kernel - 如何将串口设备驱动程序从 Linux 2.6.21 移植到 2.6.36？

> ID：11636860
> 
> 赞同：3
> 
> 时间：2012-07-24T18:15:01.373
> 
> 标签：linux-kernel, serial-port, device-driver

似乎在这两个内核之间的一段时间内，很多数据结构都发生了变化，并且在几个地方破坏了我的驱动程序。

首先，在 2.6.21 中，struct uart_port 有一个字段“struct uart_info *info”，我在几个地方都依赖它。我测试了几个地方以确保它是非空的，如果非空，我另外测试它的子字段（struct tty_struct *tty）是否非空，我使用这些来检查是否启用了流控制以及是否我们已停止传输。

在 2.6.36 中，信息返回指针已被删除，我不确定如何获取它，或者我正在尝试做的语义是否更有效，因为出现了唯一使用它的串行驱动程序让 ifdef 处理它的代码，并将所有这些数据保存在它自己的结构中（它如何工作，甚至正确地维护内核的状态）？？？

此外，缺少 save_and_cli() 和 restore_flags()。我看到了新函数 local_irq_save() 和 local_irq_restore()，我可以切换到使用它们，还是有什么陷阱？

最后，缺少 __ioremap。看起来可能 ioremap_noncache 是替代品，但我再次不确定是否存在任何语义差异或陷阱。我假设我不想要 ioremap() 因为我直接与硬件交谈，但其他一些驱动程序似乎这样做了，我不知道为什么会这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T03:54:06.317

查看使用相同功能的树内驱动程序如何在两个版本之间发生变化通常是最好的方法。例如，`ioc4_serial`驱动程序使用[内核 2.6.21](http://lxr.linux.no/#linux+v2.6.21/drivers/serial/ioc4_serial.c#L1630)中的`info`成员，但已切换到使用[内核 2.6.36](http://lxr.linux.no/#linux+v2.6.36/drivers/serial/ioc4_serial.c#L1630)中的成员。`struct uart_port``struct uart_state *state`

该驱动程序获得`tty_struct`：

```
state = the_port->state;
tty = state->port.tty; 
```

# jquery - 表单提交后如何清除输入数据

> ID：11636862
> 
> 赞同：0
> 
> 时间：2012-07-24T18:15:12.517
> 
> 标签：jquery, forms

> **可能重复：**
> [提交表单后无法清除输入值](https://stackoverflow.com/questions/11635116/cant-clear-the-input-value-after-form-is-submited)

好的，所以我试了100次。我需要在验证并提交表单后清除输入数据。然后包装器 div 将淡出。因此，验证、提交、清除数据、淡出。我有一种感觉，我没有将 val('') 放在正确的位置。如果有人想帮忙..谢谢。

```
$(document).ready(function () {
    $('#form1').ajaxForm({
        beforeSubmit: validate
    });

    function validate(formData, jqForm, options) {
        var name = $('input[name=name]').fieldValue();
        var email = $('input[name=email]').fieldValue();
        var message = $('textarea[name=message]').fieldValue();

        if (!name[0]) {
            alert('Please enter a value for name');
            return false;
        }
        if (!email[0]) {
            alert('Please enter a value for email');
            return false;
        }
        if (!message[0]) {
            alert('Please enter a value for message');
            return false;
        }
    }

    var name = $('input[name=name]').val('');
    var email = $('input[name=email]').val('');
    var message = $('textarea[name=message]').html('');

    $("#form1").ajaxForm(function () {
        $("#formplic").fadeOut(1000, function () {
            $(this).html("<img src='images/postauto2.png'/>").fadeIn(2000);
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:25:51.837

删除这些行：

```
var name = $('input[name=name]').val('');
var email = $('input[name=email]').val('');
var message = $('textarea[name=message]').html(''); 
```

试试这个：

```
function validate(formData, jqForm, options) {
    //.....Some code.....
    if (!message[0]) {
        alert('Please enter a value for message');
        return false;
    }
    //....Added code....
    setTimeout(function(){
        $('input,textarea','#form1').val(''); //clearing inputs
    },1);
    //..................
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:17:19.237

通过使用 jQuery 的[`each`](http://api.jquery.com/jQuery.each/)函数：

```
$("input").each(function (){
    $(this).val() = "";
}); 
```

编辑：你的淡入/淡出看起来不错。

# c# - 如何重置内部数据库时间戳计数器？

> ID：11636867
> 
> 赞同：1
> 
> 时间：2012-07-24T18:15:26.610
> 
> 标签：c#, sql-server, database, tsql, timestamp

我有一个应用程序，其中有一个主（中央）数据库，然后是许多分布式客户端数据库。一些表有时间戳列。因此，这些列将填充当前数据库时间戳（选择@@DBTS）。但是当我重建一个分布式客户端数据库时，我需要将新数据库的时间戳计数器重置为大于上次使用的值。目前，我只是旋转更新，直到计数器变得大于上次使用的值。但是，我的问题是：有没有办法将数据库的内部时间戳计数器重置为另一个值？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:58:56.937

您可以使用 MIN_ACTIVE_ROWVERSION()。MIN_ACTIVE_ROWVERSION 是一个非确定性函数，它返回当前数据库中的最低活动 rowversion 值

有关详细信息，请参见[此处](http://msdn.microsoft.com/en-us/library/bb839514.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-05T11:07:50.880

@michael-lee 也许你已经解决了这么多年的问题。但我正在搜索与您的请求相关的内容，我在这里找到了答案 [ROWVERSION 是时间戳数据类型的别名] [http://docs.intersystems.com/latest/csp/docbook/DocBook.UI.Page。 cls?KEY=RSQL_C124042](http://docs.intersystems.com/latest/csp/docbook/DocBook.UI.Page.cls?KEY=RSQL_C124042)

答案是否定的：“无法重置 ROWVERSION 计数器。” 而且“不能由用户指定 ROWVERSION 字段值；该值始终由 ROWVERSION 计数器提供。”

也许它对其他人有用。

# c++ - 多维数组赋值

> ID：11636872
> 
> 赞同：0
> 
> 时间：2012-07-24T18:15:41.517
> 
> 标签：c++, multidimensional-array

```
class//
  public:
      double a[3][2][2];

  void f(double b[3][2][2]){

     //How do i assign b to a?
  } 
```

我如何分配数组。我被指针困住了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:34:00.220

一个 memcpy 可以解决问题：

```
memcpy(a, b, sizeof(a)); 
```

小心不要使用`sizeof(b)`，因为 b 实际上是一个指针，而不是一个数组，所以只会复制 4 或 8 个字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:17:10.970

您可以重载 = 运算符，但它必须将一个数组逐个元素地复制到另一个数组。

# ruby-on-rails - 使用参数引发自定义异常

> ID：11636874
> 
> 赞同：54
> 
> 时间：2012-07-24T18:15:51.957
> 
> 标签：ruby-on-rails, ruby, exception, exception-handling

我在rails中的模型上定义了一个自定义异常作为一种包装异常：（`begin[code]rescue[raise custom exception]end`）

当我引发异常时，我想向它传递一些关于 a) 其内部函数引发错误的模型实例的信息，以及 b) 被捕获的错误。

这是一个模型的自动导入方法，该模型由来自外部数据源的 POST 请求填充。

tldr; 鉴于您自己定义了异常，如何将参数传递给异常？我对该异常有一个初始化方法，但`raise`语法似乎只接受异常类和消息，没有传递到实例化过程的可选参数。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-07-24T18:25:13.960

使用 new 创建一个异常实例：

```
class CustomException < StandardError
  def initialize(data)
    @data = data
  end
end
# => nil 
raise CustomException.new(bla: "blupp")
# CustomException: CustomException 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-09-09T13:55:52.803

# 解决方案：

```
class FooError < StandardError
  attr_reader :foo

  def initialize(foo)
   super
   @foo = foo
  end
end 
```

如果您遵循[Rubocop 样式指南](https://github.com/rubocop-hq/ruby-style-guide#exception-class-messages)并始终将您的消息作为第二个参数传递给：这是最好的方法`raise`：

```
raise FooError.new('foo'), 'bar' 
```

你可以得到`foo`这样的：

```
rescue FooError => error
  error.foo     # => 'foo'
  error.message # => 'bar' 
```

如果要自定义错误消息，请编写：

```
class FooError < StandardError
  attr_reader :foo

  def initialize(foo)
   super
   @foo = foo
  end

  def message
    "The foo is: #{foo}"
  end
end 
```

如果`foo`需要，这很有效。如果您想`foo`成为可选参数，请继续阅读。

* * *

# 解释：

### 将您的消息作为第二个参数传递给`raise`

正如[Rubocop 风格指南](https://github.com/rubocop-hq/ruby-style-guide#exception-class-messages)所说，消息和异常类应该作为单独的参数提供，因为如果你写：

```
raise FooError.new('bar') 
```

并且想要将回溯传递给`raise`，没有两次传递消息就没有办法做到这一点：

```
raise FooError.new('bar'), 'bar', other_error.backtrace 
```

正如[这个答案](https://stackoverflow.com/a/4789702/1067145)所说，如果要将异常重新引发为具有相同回溯和不同消息或数据的新实例，则需要传递回溯。

### 实施`FooError`

问题的症结在于 if`foo`是一个可选参数，有两种不同的引发异常的方式：

```
raise FooError.new('foo'), 'bar', backtrace # case 1 
```

和

```
raise FooError, 'bar', backtrace # case 2 
```

我们希望`FooError`与两者合作。

*在案例 1*中，由于您提供了错误实例而不是类，因此`raise`设置`'bar'`为错误实例的消息。

*在案例 2*中，为您`raise`实例化`FooError`并作为唯一参数传递`'bar'`，但它不会像案例 1 那样在初始化后设置消息。要设置消息，您必须使用消息作为唯一参数进行调用`super`。`FooError#initialize`

因此，在情况 1 中，`FooError#initialize`收到`'foo'`，在情况 2 中，收到`'bar'`。它已超载，通常无法区分这些情况。这是 Ruby 的设计缺陷。所以 if`foo`是一个可选参数，你有三个选择：

(a) 接受传递给的值`FooError#initialize`可能是`foo`或者是消息。

(b) 仅使用案例 1 或案例 2 样式，`raise`但不能同时使用。

(c) 做`foo`一个关键字参数。

**如果您不想`foo`成为关键字参数，我建议 (a) 并且我的`FooError`上述实现旨在以这种方式工作。**

如果您`raise`是`FooError`用例 2 样式，则 的值`foo`是消息，它被隐式传递给`super`. 如果您`super(foo)`向`FooError#initialize`.

如果您使用关键字参数（h/t [Lemon Cat's answer](https://stackoverflow.com/a/56384868/1067145)），则代码如下所示：

```
class FooError < StandardError
  attr_reader :foo

  def initialize(message, foo: nil)
   super(message)
   @foo = foo
  end
end 
```

提高看起来像：

```
raise FooError, 'bar', backtrace
raise FooError(foo: 'foo'), 'bar', backtrace 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-11-03T14:02:31.990

以下是向错误添加代码的示例代码：

```
class MyCustomError < StandardError
    attr_reader :code

    def initialize(code)
        @code = code
    end

    def to_s
        "[#{code}] #{super}"
    end
end 
```

并提出： `raise MyCustomError.new(code), message`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-05-30T19:59:24.693

TL; DR 提出这个问题 7 年后，我相信正确的答案是：

```
class CustomException < StandardError
  attr_reader :extra
  def initialize(message=nil, extra: nil)
    super(message)
    @extra = extra
  end
end
# => nil 
raise CustomException.new('some message', extra: "blupp") 
```

警告：您将获得相同的结果：

```
raise CustomException.new(extra: 'blupp'), 'some message' 
```

但那是因为`Exception#exception(string)`a `#rb_obj_clone`on `self`，然后调用`exc_initialize`（它不调用`CustomException#initialize`. 从[error.c](https://github.com/ruby/ruby/blob/trunk/error.c#L956)：

```
static VALUE
exc_exception(int argc, VALUE *argv, VALUE self)
{
    VALUE exc;

    if (argc == 0) return self;
    if (argc == 1 && self == argv[0]) return self;
    exc = rb_obj_clone(self);
    exc_initialize(argc, argv, exc);

    return exc;
} 
```

在上面的后一个示例中`#raise`， a`CustomException`将`raise`d`message`设置为“a message”并`extra`设置为“blupp”（因为它是一个克隆），但实际上创建了*两个* 对象：第一个是由，第二个是通过调用其中第一个实例创建了第二个 cloned 。`CustomException``CustomException.new``#raise``#exception``CustomException``CustomException`

*为什么*我的扩展舞蹈混音版本位于：[https ://stackoverflow.com/a/56371923/5299483](https://stackoverflow.com/a/56371923/5299483)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-25T10:06:58.437

### 带有附加信息的自定义错误的简单模式

如果您要传递的额外信息只是带有消息的类型，则效果很好：

```
# define custom error class
class MyCustomError < StandardError; end

# raise error with extra information
raise MyCustomError, 'Extra Information' 
```

结果（在 IRB 中）：

```
Traceback (most recent call last):
        2: from (irb):22
        1: from (irb):22:in `rescue in irb_binding'
MyCustomError (Extra Information) 
```

### 课堂上的例子

下面的模式对我来说非常有用（双关语）。它很干净，可以很容易地模块化，并且错误是有表现力的。在我的类中，我定义了继承自 的新错误`StandardError`，并通过消息（例如，与错误关联的对象）引发它们。

这是一个简单的示例，类似于 OP 的原始问题，它在类中引发自定义错误并在错误消息中捕获方法名称：

```
class MyUser
  # class errors
  class MyUserInitializationError < StandardError; end

  # instance methods
  def simulate_failure
    raise MyUserInitializationError, "method failed: #{__method__}"
  end
end

# example usage: 
MyUser.new.simulate_failure

# => MyUser::MyUserInitializationError (method failed: simulate_failure) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-11-09T01:30:00.557

对于来自 Java 之类的程序员来说，这是违反直觉的，但最有效的方法不是编写自定义初始化程序，而是编写自己的[`Exception::exception`类方法](https://ruby-doc.org/core-2.7.4/Exception.html#method-c-exception)替换。

根据[`Kernel#raise`](https://ruby-doc.org/core-2.7.4/Kernel.html#method-i-raise)文档：

> 第一个参数应该是一个 Exception 类（**或另一个`Exception`在发送`exception`消息**时返回对象的对象）。*[强调补充。]*

```
class MyException < StandardError

  class << self
    def exception(arg)
      # per `Exception::exception` docs
      return self if arg.nil? || self.equal?(arg)
      return MyException.new(arg.to_s) unless arg.is_a?(MyModel)

      # $! is a magic global variable holding the last raised
      # exception; Kernel#raise will also inject it as the 
      # cause attribute of the exception we construct here
      error_caught = $!
      msg = custom_message_for(arg, error_caught)

      ex = MyException.new(msg)
      # … any additional initialization goes here
      ex
    end

    private

    def custom_message_for(my_model_instance, error_caught)
      # …
    end
  end
end 
```

这样，您可以正常引发自定义异常，使用模型实例而不是字符串消息，而不必记得`new`显式调用[和扰乱 RuboCop](https://github.com/rubocop/ruby-style-guide#exception-class-messages)，也不必让 Ruby 程序员感到困惑，这些程序员稍后会期待标准语法。

```
begin
  my_model.frob
rescue => e
  raise MyException.new, my_model # works
end

raise MyException.new, 'some other reason' # also works 
```

来自的消息和初始化逻辑`MyException#exception`也可以进入自定义初始化程序，让您只需编写`MyException.new(arg, $!)`，但在这种情况下，请确保初始化程序足够聪明，也可以处理纯字符串消息，并确保它在某些时候`super`使用字符串消息调用.

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-07-24T18:25:25.817

您可以创建`Exception`子类的新实例，然后引发它。例如：

```
begin
  # do something
rescue => e
  error = MyException.new(e, 'some info')
  raise error
end 
```

# session - phpBB 会话不会在页面之间进行

> ID：11636882
> 
> 赞同：1
> 
> 时间：2012-07-24T18:16:13.630
> 
> 标签：session, web, integration, phpbb

我有一个网站（位于根目录中），其论坛位于 ./forum/

我已使用以下代码成功地将 phpBB 的会话集成到我的网站索引中：

在我之前的索引页中`<html>`：

```
<?php include_once("include/phpbb.php");
// check for logout request
$cp = $_GET['cp'];
// is it a logout? then kill the session!
if ($cp == "logout") {
$user->session_kill();
$user->session_begin();
echo "Successfully Logged Out.";
}
?> 
```

phpbb.php：

```
<?php
define('IN_PHPBB', true);
$phpbb_root_path = (defined('PHPBB_ROOT_PATH')) ? PHPBB_ROOT_PATH :  './forum/';
$phpEx = substr(strrchr(__FILE__, '.'), 1);
require($phpbb_root_path . 'common.' . $phpEx);
// Start session management
$user->session_begin();
$auth->acl($user->data);
$user->setup();
?> 
```

显示信息 - 这是在我的索引中包含的 header.php 中：

```
<?php
// Page login notice
if ($user->data['user_id'] == ANONYMOUS)
{
?>

<img src="forum/images/avatars/gallery/noavatar.png" style="float:left; width:72px; height:72px;">
<div class="login">
    <form method="POST" action="forum/ucp.php?mode=login">
    <ul><li><span>Username:</span> <input class="loginfield" type="text" name="username" size="20"></li>
        <li><span>Password:</span> <input class="loginfield" type="password" name="password" size="20"></li>
        <li>Remember Me? <input type="checkbox" name="autologin"> &nbsp; &nbsp; &nbsp; <a href="forum/ucp.php?mode=register">Register</a></li>
        <li><input type="submit" value="Login" name="login"></li>
    </ul>
    <input type="hidden" name="redirect" value="../index2.php">
    </form>
</div>  

<?php
} else { ?>

<img src="forum/images/avatars/gallery/<?php echo $user->data['user_avatar']; ?>" style="float:left; width:72px; height:72px;">
<div class="login">
    Welcome back, <?php echo $user->data['username_clean']; ?><br> 
    You have <?php echo $user->data['user_unread_privmsg']; ?> new messages<br>
    <a href="index2.php?cp=logout">Log Out</a>
</div>
<?php } ?> 
```

我可以使用我创建的表单成功登录索引，但是如果我随后单击另一个页面（即 about.php），我会被要求再次登录。每个页面都会发生这种情况。如果我点击到 phpbb 论坛，也会发生这种情况。

有什么办法可以让我在任何页面上登录，并且在浏览其他页面时不会重新启动会话？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T14:04:17.907

检查 phpBB ACP 中板配置中的 cookie 路径。默认情况下，phpBB 尝试创建限制性 cookie，并将板根指定为 cookie 路径。

如果 cookie 路径为`/forum/`，则会话不会在 / 中持续存在。

# javascript - 相机看矢量

> ID：11636887
> 
> 赞同：2
> 
> 时间：2012-07-24T18:16:33.870
> 
> 标签：javascript, opengl-es, webgl, three.js

我正在使用 Three.js 透视相机，我需要得到相机正在看的点。

如何使用相机的矩阵/旋转向量计算它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T19:59:59.583

相机正在向下看它的内部负 z 轴。因此，选择相机负 z 轴上的任何点，如下所示：

```
var point = new THREE.Vector3( 0, 0, -1 ); 
```

现在将该点从相机空间转换为世界空间，如下所示：

```
point.applyMatrix4( camera.matrixWorld ); 
```

注意：这给出了相机正在查看的点。要获取相机正在看的方向，请参阅[Three.js：获取相机正在看的方向](https://stackoverflow.com/questions/14813902/three-js-get-the-direction-in-which-the-camera-is-looking/14816480#14816480)

编辑：更新为three.js r.59

# php - 如何替换 Netbeans 中的字符串？

> ID：11636890
> 
> 赞同：11
> 
> 时间：2012-07-24T18:16:35.580
> 
> 标签：php, netbeans, replace, find

> **可能重复：**
> [搜索和替换整个项目（Netbeans）](https://stackoverflow.com/questions/4000376/search-and-replace-entire-project-netbeans)

其他 IDE 具有在代码中查找和替换某些内容的功能。我想要 Netbeans 中的这个功能。我知道有重构功能，但这仅适用于变量。如何查找和替换不是变量名的文本？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-24T18:19:24.227

CTRL+SHIFT+H 将打开替换对话框，您可以在其中找到+替换任何或所有打开的项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T18:27:19.433

`Ctrl`++为您提供查找`Shift`和`H`替换对话框，如图所示：

![在此处输入图像描述](../Images/dcadcd3060346cc58d4126189b634751.png)

如果您在 Netbeans 中查找某个功能时遇到问题，您可以首先检查的地方之一是[键盘快捷键](http://netbeans.org/project_downloads/www/shortcuts.pdf)列表。

# android - 'Ext.Logger' [未定义] 在 Phonegap 中使用 SenchaTouch for Android

> ID：11636891
> 
> 赞同：1
> 
> 时间：2012-07-24T18:16:46.943
> 
> 标签：android, cordova, sencha-touch-2

我用谷歌地图创建了我的 secha touch 2.0 应用程序。当我尝试将其添加到 phonegap 以制作 android 应用程序时。我收到以下错误：

```
TypeError: Result of expression 'Ext.Logger' [undefined] is not an object. at file:///android_asset/www/app-all.js:4 
```

如何修复错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T18:28:37.217

确保`logger`构建选项（您的 app.json 文件）中的值设置为 false：

```
 /**
    * Build options
    */
    "buildOptions": {
        "product": "touch",
        "minVersion": 3,
        "debug": false,
        "logger": false
    }, 
```

默认情况下，该字段的值为`'no'`this is a known bug，并在发布生产构建时导致类似错误。

# javascript - Selenium IDE 不会记录来自某些网站的任何内容

> ID：11636894
> 
> 赞同：1
> 
> 时间：2012-07-24T18:16:56.693
> 
> 标签：javascript, selenium-ide

The Selenium IDE does not record anything from this websites "http://suppliers.inwk.com". You may not have credentials to get login access, but if you can get the login page itself recorded in Selenum IDE, then I think we can come to the root cause, or atleast get a clue.

If I save the page to local machine, and open the page, and try to record it works. Seems to be like this line in the source of that page is the root cause. Can any of you figure out the nature of issue coming from this line?

```
<script type="text/javascript" language="javascript" src="com.iwprint.vendorportal.VendorPortalClient/com.iwprint.vendorportal.VendorPortalClient.nocache.js"></script> 
```

also, FYI: this site is made using gwt (GWT). Is that what makes it not compatible with Selenium?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T05:24:18.123

是的，selenium 没有记录任何事件可能是因为站点在 GWT 中，但您可以手动生成脚本。
我已经生成了用于登录的脚本供您参考

```
type  |  name=username | test
type  |  name=password | testing
click | //button[text()='Login'] 
```

# ormlite - ORMLite LazyForeignCollection：如何只查询一次集合？

> ID：11636897
> 
> 赞同：7
> 
> 时间：2012-07-24T18:17:06.197
> 
> 标签：ormlite

假设我有以下对象：

```
public class MyOwnList {

    @DatabaseField(id= true)
    protected int id;

    @ForeignCollectionField(eager = false)
    protected Collection<Item> items;
} 
```

由于`items`标记为惰性，如果我从数据库加载列表对象，它将不会被加载。这正是我想要的！！

问题是每次我访问`items`时，ORMLite 都会进行 sql 查询来获取集合。激活ORMLite的日志后才发现...

为什么这样做？有什么好的理由吗？

有什么方法可以延迟加载集合，但只能加载一次，而不是每次访问集合？所以介于渴望和懒惰之间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T18:37:51.237

> 问题是每次我访问项目时，ORMLite 都会进行 sql 查询来获取集合。

所以一开始我不明白这一点。您要求的是[ORMLite](http://ormlite.com/)在第一次延迟加载后缓存项目集合。将此作为默认设置的问题是 ORMLite 不知道您的收藏有多大`items`。使用惰性集合的原因之一是处理大型集合。如果 ORMLite 将所有惰性集合保存在内存中，它可能会填满内存。

我将在 TODO 列表中添加类似`lazyCached = true`懒惰和渴望的混合体。好建议。

# freemarker - freemarker 错误：预期的哈希值。而是评估为 freemarker.template.SimpleScalar

> ID：11636899
> 
> 赞同：4
> 
> 时间：2012-07-24T18:17:18.113
> 
> 标签：freemarker

我的模板如下所示：

```
 <#assign senti = "${scmr.results[model]}">
    <#if senti??>
      <td>${senti} ---- ${senti.sentimentType}</td>
      <td>${senti.score?html}</td>
    </#if> 
```

输出如下所示：

```
POSITIVE(1.0/1) ---- Expected hash. senti evaluated instead to freemarker.template.SimpleScalar on line 5, column 27 in com/addthis/sentiment/sentidemo.ftl. 
```

“----”之前的输出文本表明**senti**确实是一个有效的 java **Sentiment**对象。方法**getSentimentType**和**getScore**存在并且有效。

那么，为什么我会收到错误消息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T09:04:19.393

随着`<#assign senti = "${scmr.results[model]}">`您已转换`scmr.results[model]`为字符串（标量），这就是原因。就写吧`<#assign senti = scmr.results[model]>`。在 FreeMarker 表达式中，您可以将值注入到**字符串字面**量中，例如`"Hello ${name}!"`(same as `"Hello " + name + "!"`)，`"${someExpression}"`这只是其中的一种情况。这不像在 JSP 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-07T10:43:37.523

使用带有 ninjaframework 的 swagger 生成的模型时出现相同的错误，通过在 conf 包中添加以下类来修复

```
package conf;

import com.google.inject.Inject;
import freemarker.ext.beans.BeansWrapper;
import freemarker.ext.beans.MethodAppearanceFineTuner;
import freemarker.template.Configuration;
import freemarker.template.DefaultObjectWrapperBuilder;
import ninja.NinjaDefault;
import ninja.template.TemplateEngineFreemarker;

/**
 * Created by varya on 07/12/17.
 */
public class Ninja extends NinjaDefault {
    @Inject
    protected TemplateEngineFreemarker templateEngineFreemarker;

    @Override
    public void onFrameworkStart() {
        super.onFrameworkStart();

        Configuration freemarkerConfiguration = templateEngineFreemarker.getConfiguration();
        DefaultObjectWrapperBuilder owb = new DefaultObjectWrapperBuilder(Configuration.VERSION_2_3_23);
        owb.setMethodAppearanceFineTuner(new MethodAppearanceFineTuner() {
            @Override
            public void process(BeansWrapper.MethodAppearanceDecisionInput in, BeansWrapper.MethodAppearanceDecision out) {
                out.setMethodShadowsProperty(false);
            }
        });

        freemarkerConfiguration.setObjectWrapper(owb.build());

    }

} 
```

# javascript - 用 extern javascript 替换 onclick、onmouseover 和 onmouseout

> ID：11636902
> 
> 赞同：0
> 
> 时间：2012-07-24T18:17:27.677
> 
> 标签：javascript, html, google-chrome, google-chrome-extension, mouseevent

我想用javascript中的extern替换我的onclick、onmouseover和onmouseout属性，这些属性现在在我的html中是内联的。

html:

```
<div onclick:"myfunctiononclick()"></div>
<div onmouseover:"myfunctionmouseover()"></div>
<div onmouseout:"myfunctionmouseout()"></div> 
```

javascript:

```
function myfunctiononclick(){something};
function myfunctiononmouseover(){something};
function myfunctiononmouseout(){something}; 
```

我为什么要这样做？因为 chrome 不允许在扩展中使用内联 javascript。

谢谢

顺便说一句，请不要使用 jQuery，所以我知道发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:20:14.820

以某种方式获取对元素的引用，然后[`addEventListener`](https://developer.mozilla.org/en/DOM/element.addEventListener)：

```
document.addEventListener("DOMContentLoaded", function() {
    //This code is ran when the DOM content has been loaded
    //I.E. the elements we are trying to get exist on the page
    var divs = document.querySelectorAll("div");
    divs[0].addEventListener("click", myfunctiononclick, false);
    divs[1].addEventListener("mouseover", myfunctiononmouseover, false);
    divs[2].addEventListener("mouseout", myfunctiononmouseout, false);
}, false); 
```

# c# - Socket.Send 和 Stream.Write 有什么区别？（关于 tcp ip 连接）

> ID：11636903
> 
> 赞同：2
> 
> 时间：2012-07-24T18:17:30.130
> 
> 标签：c#, sockets, stream, send

在处理服务器/客户端连接时，我已经看到这两种方法都被有效地使用，没有任何明显的优势，但我怀疑如果其中一种没有任何已知的优势，它们都会存在。有谁知道这两者之间有什么明显的区别吗？帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:31:19.760

`Socket.Send`是直接通过 WINSOCK 层的原始数据发送... `Stream`在您发送数据时缓冲和处理数据。它通常用于需要类似流的功能的情况。显然，那里有一些额外的开销。相比之下`Send`，这种开销包括创建一个新类来管理“流”并在您和`Socket.Send`. `NetworkStream.Write`最终只是打电话`Socket.Send`；但这是几层开销。

`NetworkStream`通过使用类型，还需要做更多的工作来设置流。

当然，流也可以是双向的，这意味着您可以读取和写入它。`Receive`您可以使用这些方法完美地从套接字读取。

使用`Send`或`Receive`直接将您连接到套接字。如果您使用`Stream`-derivative，您将与`Socket`使用`Stream`.

# javascript - IE8中的换行代码

> ID：11636904
> 
> 赞同：-1
> 
> 时间：2012-07-24T18:17:33.273
> 
> 标签：javascript, html, dom

这行似乎破坏了我在 IE8 中的代码，谁能告诉我为什么

```
data=[];
item=someElementWithTextInside
//line below breaks it
data.push({obj: item, text: item.innerHTML.replace(/^\s+/, "").replace(/\s+$/, ""))}; 
//line above breaks 
```

我已经尝试查看它的 innerHTML 部分，该功能似乎在我的浏览器上运行良好（并且切换到 innerText 不会产生任何影响）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:20:18.110

你应该`)});`在行尾，而不是`))};`.

# c# - 如何调用具有类型的函数？

> ID：11636905
> 
> 赞同：2
> 
> 时间：2012-07-24T18:17:36.117
> 
> 标签：c#

所以我有这个自定义对象/静态函数，它需要一个类型来调用：

```
 MyObject<MyType>.MyFunction(); 
```

MyObject 是这样定义的：

```
 public abstract class MyObject <type> { ... } 
```

我该如何调用它？我需要调用的原因是因为 MyType 是动态的，我不能这样做：

```
 Type t = this.GetType();
     MyObject<t>.MyFunction(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:20:50.623

您需要使用反射来实例化类 - 然后更多的反射来调用该方法：

```
Type typeDefinition = typeof(MyObject<>);
Type constructedType = typeDefinition.MakeGenericType(t);
MethodInfo method = constructedType.GetMethod("MyFunction");
method.Invoke(null, null); 
```

这很不愉快，当然。您肯定*需要*它成为泛型类中的方法吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:21:48.047

```
typeof(MyObject<>).MakeGenericType(this.GetType())
    .GetMethod("MyFunction", BindingFlags.Static | BindingFlags.Public)
    .Invoke(null, null); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:23:38.343

只能通过使用反射。

```
typeof(MyObject<>).MakeGenericType(t).GetMethod("MyFunction", BindingFlags.Static).Invoke(null, new object[0]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:20:37.097

你知道关键字 typeof 吗？

这应该可以正常工作：[msdn.microsoft.com/en-us/library/twcad0zb (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/twcad0zb%28v=vs.80%29.aspx)

# css - 顶部高时在背景中形成图像

> ID：11636907
> 
> 赞同：0
> 
> 时间：2012-07-24T18:17:41.050
> 
> 标签：css

我的表格背景由 4 个部分组成：frame_border_top.png（高度 18px）、form_border_top.png（高度 200px，这张图片上有渐变）、frame_border_middle（高度：1px，repeat-y）和 frame_border_bottom.png（18px） . 我需要从这些图像中构建表单背景。困难在于表单内容应该从 form_border_top.png 开始显示（它应该是前 5 或 6 个输入的背景）。所以表格应该是（从上到下，像素在 Y 轴上）： 0-17px frame_border_top.png 18px-217px form_border_top.png 218px-599px（或其他，取决于内容高度） frame_border_middle 600px-617px frame_border_bottom

文字从 20px 开始。

如何用css设置这个样式？这很容易，但是这个 form_border_top.png 部分。

它必须在 IE7 中工作。

我试过这样的HTML

```
 <div id="Content">
        <form action="">
            <div class="form-top"></div>
            <div class="form-background-top"></div>
            <div class="form-content">
                ... inputs ...
            </div>
            <div class="form-bottom"></div>
        </form>
    </div> 
```

和

```
#Content {
    width: 942px;
}

form {
}

.form-top {
    background: url("images/form_top.png") no-repeat scroll 0 0 transparent;
    height: 18px;
}
.form-background-top {
    background: url("images/form_background.png") no-repeat 
        scroll 0 0 transparent;
    height: 200px;
}
.form-content {
    background: url("images/form_middle.png") repeat-y 
        scroll center 0 transparent;
}
.form-bottom {
    background: url("images/form_bottom.png") repeat 
        scroll 0 0 transparent;
    height: 18px;
} 
```

并尝试了位置、边距、填充的不同组合，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:03:11.597

我修改了png。我只创建了带有边框和内部透明的外层。然后我为渐变背景创建了 png，但没有边框。然后很容易将所有内容放在一起。

# google-app-engine - 想使用python将文件上传到google appengine中的目录

> ID：11636908
> 
> 赞同：0
> 
> 时间：2012-07-24T18:17:43.217
> 
> 标签：google-app-engine

我是谷歌应用引擎的新手。我想将文件上传到目录而不是存储为 blob。

主文件

```
import cgi 
import webapp2
from google.appengine.api import users
from google.appengine.ext.webapp.template \
    import render
from os import path

class MainHandler(webapp2.RequestHandler):
    def get(self):
        context={}
        tmpl = path.join(path.dirname(__file__), 'static/html/index.html')
        self.response.out.write(render(tmpl, context))

    def post(self):
       form_data = self.request.get('file')
       file_data = form_data
       f=open('static/html/'+form_data,'w')
       f.write(file_data)
       f.close

routes=[
        (r'/', MainHandler),
        ]   
app = webapp2.WSGIApplication(routes=routes,debug=True) 
```

索引.html

```
> <html>
>     <head><title>test</title></head>
>     <body>hello
>        <form id="addmovieform" action="/" method="post" ENCTYPE="multipart/form-data">
>            <input type="file" name="file" >
>            <input type="submit" name="submit">
>        </form>
>     </body>
>         </html> 
```

错误

> Traceback（最近一次通话最后）：文件“/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py”，第 1536 行，**调用** rv = self .handle_exception(request, response, e) 文件“/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py”，第 1530 行，**通话中** rv = self.router.dispatch(request, response) 文件“/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py”，第 1278 行，在default_dispatcher return route.handler_adapter(request, response) 文件“/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py”，第 1102 行，**通话中** return handler.dispatch() File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py"，第 572 行，在 dispatch return self.handle_exception( e、self.app.debug）文件“/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py”，第570行，在调度返回方法中（ *args, **kwargs) 文件“/Users/saravase/test/main.py”，第 33 行，在帖子 f=open('static/html/'+form_data,'w') 文件“/Applications/GoogleAppEngineLauncher. app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/dev_appserver_import_hook.py”，第 589 行，在**初始化** raise IOError('invalid mode: %s' % mode) IOError: invalid mode: w

请指导我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:29:40.437

来自“[什么是 Google App Engine？](https://developers.google.com/appengine/docs/whatisgoogleappengine) ”

> 应用程序无法在任何运行时环境中写入文件系统。应用程序可以读取文件，但只能读取使用应用程序代码上传的文件。应用程序必须使用 App Engine 数据存储区、内存缓存或其他服务来处理请求之间持续存在的所有数据。Python 2.7 环境允许读取、写入和修改字节码。

您需要重新使用 blobstore，或尝试使用[Google Cloud Storage API](https://developers.google.com/appengine/docs/python/googlestorage/)，具体取决于您的应用程序的需要。

# c# - 以 C# 字符串格式应用 Excel 自定义格式

> ID：11636911
> 
> 赞同：1
> 
> 时间：2012-07-24T18:18:08.647
> 
> 标签：c#, excel

目前我正在使用基于 excel 插件的 C# 应用程序。我必须读取 excel 单元格值并将相同的自定义格式应用于 C# 应用程序中的其他字符串数据。

例如，我有以下自定义格式。

```
 #,##0.0_);(#,##0.0);#,##0.0_);@_) --> Numeric Data Formatting

 $#,##0.0_);($#,##0.0);$#,##0.0_);@_) --> Currency Data Formatting

 0.0%_);(0.0%);0.0%_);@_)  --> Percentage Data Formatting 
```

如何在 .Net 字符串对象中应用此数字格式？

# atk4 - Atk4 表格列

> ID：11636914
> 
> 赞同：0
> 
> 时间：2012-07-24T18:18:21.620
> 
> 标签：atk4

我正在尝试在表单中使用列。

我有下一个代码，它产生![列](../Images/92dcde7425f322cc27d161a1f3427887.png)

代码是这样的：

```
$col=$this->add('Columns');
$left=$col->add($f->addField('text','observaciones'));
$right=$col->add($f->addField('line','cantidad_de_bocas')); 
```

列的字段基于表单字段。我想在列中添加多个字段（例如左列上的 2 个字段和右列上的 4 个字段）。

我看过一些关于这个的例子，比如

```
$col=$page->add('Columns');
$left=$col->addColumn(2)->add('View_SlotMachine');
$right=$col->addColumn(2)->add('View_SlotMachine'); 
```

*   为什么字段重复？
*   addColumn(2) 方法有什么作用？

很感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T02:31:28.520

如果您还没有使用 atk 4.1 进行开发，您可以下载 4.2 并查看[此处](http://agiletoolkit.org/codepad/gui/formstyle)的示例。您可以利用 4.2 中的许多新功能，并且正在更新演示和示例以反映这些更改。

在 4.2 中，有一个这样的两列样式示例

```
class StylingForm extends Form {
  function init(){
    parent::init();
    $f=$this;

    $f->addField('line','name')->validateNotNull()
        ->setFieldHint('Click "Register" to see error');
    $f->addField('line','email')
        ->validateNotNull()
        ->validateField('filter_var($this->get(), FILTER_VALIDATE_EMAIL)')

    .. .. ..

 }

 functoin init() {
   // Stacked class puts labels on top of fields
   $form=$page->add('StylingForm');
   $form->addClass('stacked atk-row');

   $form->template->trySet('fieldset','span6');
   $sep=$form->addSeparator('span6');
   $form->add('Order')->move($sep,'before','age')->now();

 } 
```

在 atk4.1 中，表单是一个视图，因此它在 atk4/templates/shared/view/form.html 中有一个模板，在 atk4/lib/View/form.php 中有一些代码

[在您从此处](http://agiletoolkit.org/learn/understand/base/example)提到的老虎机示例中，addColumns(2) 用于将视图的宽度设置为可用屏幕宽度的 20%，但在示例中，每一列都将包含老虎机的视图. 如果您想在同一页面上创建表单，您可以使用相同的功能，但您似乎想要的是跨两列的单个表单，带有一个提交按钮。

如果非要继续使用atk4.1，则需要查看form.html。Romans 可能会建议您如何在该版本中创建两列表单。我可以看到在 css 中定义了一些类，例如 atk-form-vertical-2col 和 atk-form-vertical-3col 并且有一个函数 setFormClass 来设置它们，但我看不到您将设置哪些标签来将字段放入右手边 - 默认情况下，一切都在左边。

# c# - C# SNMP 代理命令处理程序

> ID：11636915
> 
> 赞同：0
> 
> 时间：2012-07-24T18:18:25.597
> 
> 标签：c#, snmp

当前的情况是一方面我有一个系统，其中我们有相机适配器（我们开发），它可以帮助我们将相机集成到系统中。另一方面，我们有一个相机模拟器。

在我的相机适配器中，为了获取`UpTime`相机的电流，我发送了一个`SNMP Get`带有正确 Oid 的命令`system UpTime`。

在我的适配器中，我使用的是`SnmpSharpNet library`.

```
public static void GetSystemUptime(string host, out TimeSpan? uptime)
{
   SimpleSnmp snmp = new SimpleSnmp();
   snmp.PeerIP = IPAddress.Parse(host);
   Oid oid = new Oid(SnmpOid.SYS_UPTIME);
   Dictionary<Oid, AsnType> dict = snmp.Get(SnmpVersion.Ver1, new[] { oid.ToString()});
   AsnType asnType;

   if (dict == null || dict.TryGetValue(oid, out asnType) == false || asnType == null || asnType.GetType() != typeof(TimeTicks))
   {
      uptime = null;
      return;
   }

   uptime = (TimeSpan)(asnType as TimeTicks);
} 
```

但现在，我正在研究实际模拟相机的相机模拟器。所以我现在需要制作`SNMP Agent`. 我似乎无法找到有关如何`Get`在 SNMP 代理中处理命令的信息，因此我可以在后面回复正确的信息。

任何人都可以将我链接到相关信息或指导我完成整个过程。

坦克，

拍

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:48:21.283

[http://www.lextm.com/2012/07/sharpsnmp-vs-snmpsharpnet/](http://www.lextm.com/2012/07/sharpsnmp-vs-snmpsharpnet/)

您问的问题可能是每个 SNMP#NET 用户都想知道的。

SNMP#NET 不能很好地支持代理开发。您需要切换到另一个库，无论是商业的还是开源的。

# php - 从codeigniter中的关联数组中取消设置键

> ID：11636916
> 
> 赞同：2
> 
> 时间：2012-07-24T18:18:26.597
> 
> 标签：php, codeigniter

我将如何`category[1]`从下面的数组中取消设置？

```
Array
(
    [category] => Array
        (
            [0] => add new
            [1] => second
        )
) 
```

似乎无法获得正确的代码。

这是用于codeigniter的会话类

```
$this->session->unset_userdata($array['category'][$session_id]); 
```

以上正确吗？或者还有其他东西 - 那不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:20:49.560

```
unset( $array['category'][1] ); 
```

假设您知道数组名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:20:40.967

这不是你要找的吗？

```
unset($arr['category'][1]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:38:49.533

我不知道您实际上在寻找什么，以及 user_unsetdata 做了什么，但我想您想取消设置数组元素并且您的功能与尝试通过引用传递相同

```
$this->session->unset_userdata(&$array['category'][$session_id]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:20:22.760

假设您的数组名称是`$array`：

```
unset( $array['category'][1] ); 
```

另一种方式是，`array_pop()`

```
array_pop( $array['category'] ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T18:21:06.833

看看[http://www.php.net/manual/de/function.array-splice.php](http://www.php.net/manual/de/function.array-splice.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-01T05:55:21.403

您将不得不在 CI 中解决 hack 以完成您想要的：

```
$SESSION = $this->session->userdata();
unset( $SESSION['category'][1] );
$this->session->set_userdata( $SESSION ); 
```

# xamarin.ios - MonoTouch 仅在调试中链接本机引用

> ID：11636919
> 
> 赞同：1
> 
> 时间：2012-07-24T18:18:35.043
> 
> 标签：xamarin.ios, monodevelop, static-linking, native-code

我有一个 MonoTouch 项目，我想在其中包含对一些仅用于测试和调试的本机 ios 库的引用。我不需要将这些引用编译到发布版本中。

我已经尝试编辑 .csproj 文件以具有链接本机引用的 ItemGroup 的条件，但它们似乎被忽略了。

```
 <ItemGroup Condition=" '$(Configuration)' == 'Debug' ">
<NativeReference Include="some path">
  <IsCxx>false</IsCxx>
  <Kind>Static</Kind>
</NativeReference> 
```

我想可能有某种方法可以使用项目选项窗口中的附加 mtouch 参数选项。不过我不确定。

有谁知道我如何仅在 MonoDevelop 中链接特定构建配置的本机参考？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:53:14.953

MonoDevelop 允许您为它为您的项目定义的每个配置提供不同**的附加 mtouch 参数**。一般来说，这意味着四个：`[Debug|Release]|iPhone[Simulator]`可以使用不同的设置。

如果您手动添加静态库，那么很容易从特定目标中添加（或删除）它。

但是，如果您使用的是使用新`[LinkWith]`支持创建的绑定，那么这些附加参数会*自动*为您创建。可能有一些方法可以解决这个问题（例如更改**Build Action**），但我没有尝试过。

# c++ - 在其他类中声明的私有成员

> ID：11636921
> 
> 赞同：2
> 
> 时间：2012-07-24T18:18:50.877
> 
> 标签：c++, class, attributes, stream, private

我正在用 C++ 程序编写我的第一个大“类”（它处理 I/O 流），我想我理解了对象、方法和属性的概念。虽然我想我仍然没有获得封装概念的所有权利，因为我希望我的名为 File 的类拥有

*   名称（文件的路径），
*   阅读流，以及
*   写流

作为属性，

也是它实际获取 File 对象的“写入流”属性的第一种方法......

```
#include <string>
#include <fstream>

class File {
public:
    File(const char path[]) : m_filePath(path) {}; // Constructor
    File(std::string path) : m_filePath(path) {}; // Constructor overloaded
    ~File(); // Destructor
    static std::ofstream getOfstream(){ // will get the private parameter std::ofStream of the object File
        return m_fileOStream;
    };
private:
    std::string m_filePath; // const char *m_filePath[]
    std::ofstream m_fileOStream;
    std::ifstream m_fileIStream;
}; 
```

但我得到了错误：

> 错误 4 错误 C2248: 'std::basic_ios<_Elem,_Traits>::basic_ios' : 无法访问在类 'std::basic_ios<_Elem,_Traits>' c:\program files (x86)\microsoft visual studio 中声明的私有成员10.0\vc\include\fstream 1116

向 fstream.cc 的以下部分报告我：

```
private:
    _Myfb _Filebuffer;  // the file buffer
    }; 
```

然后你能帮我解决这个问题并能够使用流作为我班级的参数吗？我试图返回一个引用而不是流本身，但我也需要一些帮助（也不起作用......）。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:21:15.380

改变

```
static std::ofstream getOfstream(){ // will get the private parameter std::ofStream of the object File
        return m_fileOStream;
    }; 
```

至

```
// remove static and make instance method returning a reference
// to avoid the copy constructor call of std::ofstream
std::ostream& getOfstream(){ return m_fileOStream; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T19:43:02.503

每个类都有三个部分，所以假设以下类：

```
class Example{

public:
   void setTime(int time);
   int getTime() const;
private:
 int time;
protected:
bool ourAttrib;

} 
```

你看到 public、private 和 protected 的话，是的，它们解释了封装，当你可以对方法或属性使用 private 时，只有成员可以使用它。但是当你使用 public 时，每个人都可以使用它。现在受保护：当你从一个类派生这个类，派生类可以使用protected和继承它们。

# https - JBoss-AS 7.1 在哪里存储 https 错误消息？

> ID：11636922
> 
> 赞同：0
> 
> 时间：2012-07-24T18:18:56.633
> 
> 标签：https, jboss7.x

我正在尝试在 JBoss-AS 7.1 上配置 https。当我通过 https 连接时，我得到一个空白屏幕。JBoss 管理控制台在对 https 连接器的 4 个请求上显示 4 个错误，但是对于这些失败的请求中的任何一个，standalone/log/server.log 都没有。

JBoss 在哪里记录失败的 https？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T04:14:56.087

尝试在standalone.xml 中将日志级别设置为DEBUG，然后查看server.log
，您可能会发现[此链接](https://community.jboss.org/message/642556)很有用

# jquery - 拉斐尔地图不会调整大小

> ID：11636924
> 
> 赞同：0
> 
> 时间：2012-07-24T18:19:04.587
> 
> 标签：jquery

嗨，我正在尝试调整由 raphael 创建的地图的大小，我最终加载了 SVG 文件坐标，然后运行此函数来创建选择了新区域的地图，但我似乎无法调整它的大小。 [http://pastie.org/4319180](http://pastie.org/4319180)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T19:42:46.143

似乎您只是在画布中绘制地图....尝试使用

```
paper.setviewBox(xvalue, yvalue, resize-x-width, resize-y-height); 
```

为您提供画布的缩放和平移功能，希望对您有所帮助...

# android - how to pause AsyncTask for asking details from user?

> ID：11636927
> 
> 赞同：2
> 
> 时间：2012-07-24T18:19:09.517
> 
> 标签：android, android-asynctask

I want to ask user for some details while doing some work in `doInBackground()` of `AsyncTask` (showing to user some dialog with choices in UI-thread), and after users choice continue the job in `doInBackground()` with chosen parameters from dialog.

What is a best mechanism of transfer this parameter to `doInBackground()`? How I should pause (and continue) thread doing `doInBackground()` (maybe `object.wait()` and `notify()`?)? Should I use a `Handler` for this purpose?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:56:49.280

在实际启动后台任务之前，我会要求用户输入。如果这是不可能的，有几种可能性：

1.  您可以使用锁定对象并对其执行通常的 wait()/notify() 操作。不过，您仍然需要将数据从 UI 线程传递到后台线程

2.  我会使用队列将数据从 UI 线程传递到后台线程并让它处理所有锁定。

像这样的东西（一种伪代码）

```
class BackgroundTask extends AsyncTask<BlockingQueue<String>, ...> {
    void doInBackground(BlockingQueue<String> queue) {
      ...
      String userInput = queue.take(); // will block if queue is empty
      ...
    }
}

// Somewhere on UI thread:
   BlockingQueue<String> queue = new ArrayBlockingQueue<String>(1);
   BackgroundTask task = new BackgroundTask<BlockingQueue<String>,....>();
   task.execute(queue);
   ....
   ....
   String userInput = edit.getText().toString(); // reading user input
   queue.put(userInput); // sending it to background thread. If thread is blocked it will continue execution 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:46:22.187

您可以使用 a `Callable`，将其提交给 an `Executor`，然后`Executor`将返回`FutureTask`然后您将`while`循环等待，直到`FutureTask.isDone == true`；

这是一个示例[http://programmingexamples.wikidot.com/futuretask](http://programmingexamples.wikidot.com/futuretask)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:27:26.597

我希望我的回答一定能解决你的问题。

**//在 AsyncTask 的 doInBackground() 方法中执行以下所有代码**

```
String userInput="";

        YouActivity.this.runOnUiThread(new Runnable() {

            public void run() {

            //SHOW YOUR DIALOG HERE

            }
        });

        while("".equals(userInput))
        {
            YouActivity.this.runOnUiThread(new Runnable() {

                public void run() {

                userInput=editText.getText().toString();//fetching user input from edit Text    
                }
            });

        } 
```

谢谢 ：）

# javascript - Take snapshot from a url based video file in a Javascript Metro Application

> ID：11636933
> 
> 赞同：1
> 
> 时间：2012-07-24T18:19:32.730
> 
> 标签：javascript, html5-video, microsoft-metro, windows-runtime

I've a few video files urls that my application plays, using the html video tag.

I would like to shows tiles of those videos with an snapshot/thumbnail of it. I've been looking at the [Windows.Media.Capture.MediaCapture](http://msdn.microsoft.com/en-us/library/windows/apps/windows.media.capture.mediacapture.aspx) class and it seems it doesn't support urls.

How can I do this?.

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:19:48.457

根据需要编辑`getThumbnailAsync`参数以获得您想要的。

```
var openPicker = new Windows.Storage.Pickers.FileOpenPicker();
openPicker.pickSingleFileAsync().then(function (storageFile) {
    if (storageFile) {

        storageFile.getThumbnailAsync(
            Windows.Storage.FileProperties.ThumbnailMode.musicView,
            100,
            Windows.Storage.FileProperties.ThumbnailOptions.useCurrentScale).then(
                function (storageItemThumbnail) {
                // Add code to process thumbnail
                });

    } else {
        // No file
    }
}); 
```

# flyway - How to get flyway to re-run migration?

> ID：11636936
> 
> 赞同：11
> 
> 时间：2012-07-24T18:19:40.250
> 
> 标签：flyway

**OUR SYSTEM**

We are trying to put migrations as .sql files under version control. Developers would write a VN__*.sql file, commit to version control and a job that runs every 5 minutes would automatically migrate to a Dev and Test database. Once the change proved to not cause problems, someone else would run a manual job to run the migration on Production.

**MY PROBLEM:**

I had a demo migration that created a few tables. I checked V4__DemoTables.sql into version control on my PC.

On our Linux box a job that runs every 5 minutes extracted the new file from version control, then ran the flyway.sh file. It detected the file and executed it.

But the .sql file had a typo. And we are using Neteeza which has problems with flyway automatically wrapping a migration in a BEGIN TRAN ... END TRAN. So the migration created 2 tables, then aborted before the third.

No problem I thought. I dropped the 2 tables that the .sql file did create. Checked V4__ out of version control, fixed the typo and re-submitted it.

Five minutes later the update was extracted but flyway complains that the checksum does not match. So it will NOT run the updated V4__DemoTables.sql file.

**How do I get flyway to accept the updated file and update the checksum in the SCHEMA_VERSION file in case of a typo?**

Reading the docs it seems like the developers suggest I should have created a new V4_1_DemoTables.sql file with the fix's. But this would have collided with the commands in the V4__ file so this seemed wrong.

So here is what the docs imply I need to do:

*   Leave V4__ as a 'successful' migration according to the SCHEMA_VERSION table.

    Create V4_1_ to delete the tables that were created before the typo line in V4__.

    Create V4_2_ which has the typo fix from the original file to do all the real work.

Is this correct?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T19:05:38.447

如果迁移**成功完成**，但某些 db 对象还不完全正确（列名中的拼写错误，...），请按照您所说的执行并推送修复它的**后续脚本**（重命名列，...） .

如果迁移**失败**，并且它没有在具有 DDL 事务的数据库上运行，则必须**手动清理**数据库。这表示：

*   恢复迁移对数据库的影响
*   从 SCHEMA_VERSION 表中删除版本并将前一个版本标记为当前版本

[**随着flyway.repair**](https://github.com/flyway/flyway/issues/83) [() 命令的](https://github.com/flyway/flyway/issues/83)[引入，](https://github.com/flyway/flyway/issues/83)**这第二步将在未来自动化。**

# c++ - 使用placement new 代码运行速度更快

> ID：11636938
> 
> 赞同：2
> 
> 时间：2012-07-24T18:19:46.243
> 
> 标签：c++, performance, gcc, compiler-optimization

我上了这门课

**方法一：**

```
typedef float v4sf __attribute__ (vector_size(16))

class Unit
{
    public:
    Unit(int num)
    {
        u = new float[num];
        v = new float[num];
    }
    void update()
    {
        for(int i =0 ; i < num; i+=4)
        {
            *(v4sf*)&u[i] = *(v4sf*)&v[i] + *(v4sf*)&t[i];
            //many other equations
        }
    }
    float*u,*v,*t; //and many other variables
} 
```

**方法二：**

与方法 1 相同。除了在方法 2 中`v`，`u`, 和所有其他变量都分配在一个预先分配在堆上的大块上，使用 placement `new`。

```
typedef float v4sf __attribute__ (vector_size(16))

class Unit
{
    public:
    Unit(int num)
    {
        buffer = new char[num*sizeof(*u) + sizeof(*v)  /*..and so on for other variables..*/]
        u = new(buffer) float[num];
        v = new(buffer+sizeof(float)*num) float[num];
        //And so on for other variables
    }
    void update()
    {
        for(int i =0 ; i < num; i+=4)
        {
            *(v4sf*)&u[i] = *(v4sf*)&v[i] + *(v4sf*)&t[i];
            //many other equations
        }
    }
    char* buffer;
    float*u,*v,*t; //and many other variables
} 
```

但是，方法 2 快 2 倍。这是为什么？

大约有 12 个浮点变量，num 为 500K。update() 被称为`1k`次。速度不考虑内存分配。我这样测量速度：

```
double start = getTime();
for( int i = 0; i < 1000; i++)
{
   unit->update();
}
double end = getTime();
cout<<end - start; 
```

这在方法 2 中快了大约 2 倍。

编译器选项：`gcc -msse4 -o3 -ftree-vectorize.`

L1 缓存为 256K，Ram 为 8GB，页面大小为 4K。

编辑：更正了方法 2 中分配变量的错误。所有变量都正确分配在不同的部分。处理器是 Intel(R) Core(TM) i7-2600 CPU @ 3.40GHz

编辑：在此处添加源 - [Source](https://gist.github.com/11e94d3fba7e7f9ea2a4)。方法 1) 给出 69.58s，方法 2) 给出 46.74s。虽然不是快 2 倍，但它仍然很快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T18:27:16.927

可能是因为“方法 2”有一个错误——所有变量`u`, `v`,`t`都位于内存中完全相同的位置（您将相同的地址传递给新的位置）。

**编辑**：现在你不... ;)

没有分析很难猜测，但它可能与默认分配器有关。如果在第一种方法中，您对每个变量都有单独的 new 调用，则不能保证这些变量将分配到彼此接近的地址。另一方面，在第二种方法中，您要确保它们彼此尽可能接近。这将最大化缓存利用率并限制缓存未命中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:40:09.003

分解时间并查看构造函数中的部分与`update`.

由于`update`没有改变，唯一会影响它的时间的是缓存对数据的影响。这足以解释 2 倍的差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:25:47.890

正常新建实际上是分配+构建，而放置新只是构建。
所以很自然，分配+2构造比分配+构造+分配+构造要快。
此外，整数类型的构造是 nop ，因此在您的情况下，它是 2 个分配与 1 个分配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:26:43.207

我假设在方法 2 中，编译器能够识别出 u 和 v 的地址在调用之间不会改变，因此将 for 循环中等式中使用的一些指针保留在寄存器中。

# jsf - c:foreach 与 EL 结束值 NumberFormatException

> ID：11636945
> 
> 赞同：0
> 
> 时间：2012-07-24T18:20:20.673
> 
> 标签：jsf, foreach, jstl, expression, el

我想使用 jstl foreach 循环来显示由我的托管 bean 的属性定义的一定数量的元素：

```
 <c:forEach begin="0" end="#{MyBean.IntegerProperty}" step="1" var="o" >
   <h:commandButton value="#{MyBean.IntegerProperty}"></h:commandButton>
 </c:forEach> 
```

我的标签库声明是：

```
 <%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
```

但是我得到了这个例外：

```
...
Caused by: java.lang.NumberFormatException: For input string: "#{MyBean.IntegerProperty}"
... 
```

我在某处读到 foreach 和 EL 彼此之间的合作不太好，如果是这样，那么有人知道将 int 值放在 c:foreach 的 end 属性中的解决方法吗？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:29:20.557

我不希望您上面的内容能够正常工作，因为 JSTL 标记不构成组件树的一部分。

有关更多信息，请参见[此处](https://rogerkeays.com/jsf-c-foreach-vs-ui-repeat)

# sharepoint-2010 - 导出到 Excel 时包含托管元数据的列表有奇怪的字符？

> ID：11636946
> 
> 赞同：0
> 
> 时间：2012-07-24T18:20:21.683
> 
> 标签：sharepoint-2010, metadata, export-to-excel, taxonomy

我有一个日历所有事件列表，其中包含几个字段，其中一些来自托管元数据和人员状态查找字段。当我尝试使用功能区功能将列表导出到 Excel 时，每个字段值都有一个 id 哈希标签。

这使得 excel 表非常无用和不可读。

是否有人在 SharePoint 2010 平台中尝试或遇到过此问题，以及如何将数据导出到没有 id # 标记的 Excel 中。

例如：参加者：字段包含启用人员存在的用户列表。当我将此字段值导出到 Excel 中时，每个用户都会被复制到工作表中，并带有自己独特的 # 标签，如 Doe, John;#39
或者如果它是分类管理元数据查找字段，那么导出数据将具有其独特的 #值前面的标记，如 74;#Ford

如果您能提供帮助，请告诉我。如果您有任何问题或需要进一步澄清，请随意问我。

一个建议是尝试将值复制到计算字段中，作为替换 # 标记的简单文本。但我无法根据现有查找字段的计算创建列。
其他建议是在 Excel 工作簿 Book1 中创建一个宏，可以对其进行编码以删除这些哈希标记。

我希望有一些其他更简单的方法来清理 Excel 数据表。请告诉我。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:56:15.117

这里的答案是在 Excel 中创建一个清理宏，然后所有电子表格都可以通过存储在 XLSTART 本地计算机目录中的 .xlam 插件访问该宏。

这个 VBA 代码不是很漂亮，但它就像一个魅力：~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

```
Sub Remove_unneeded()

' Remove_unneeded Macro
' Removes extraneous hash setup from SharePoint exported workbook

Dim Again As Integer
Dim Again1 As Range

On Error GoTo Nope

Set Again1 = Cells.Find(What:="?;#", LookAt:=xlPart)
If Again1 Is Nothing Then
    Set Again1 = Cells.Find(What:=";#?", LookAt:=xlPart)
    If Again1 Is Nothing Then
        GoTo Nope
    End If
End If

Range("A1").Select
Again = 1

Do While Again < 5
    Set Again1 = Cells.Find(What:="0;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="0;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="0;#", LookAt:=xlPart)
    Loop

        Set Again1 = Cells.Find(What:="1;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="1;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="1;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="2;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="2;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="2;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="3;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="3;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="3;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="4;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="4;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="4;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="5;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="5;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="5;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="6;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="6;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="6;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="7;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="7;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="7;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="8;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="8;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="8;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:="9;#", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:="9;#", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:="9;#", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#0", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#0", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#0", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#1", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#1", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#1", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#2", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#2", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#2", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#3", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#3", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#3", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#4", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#4", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#4", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#5", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#5", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#5", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#6", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#6", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#6", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#7", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#7", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#7", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#8", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#8", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#8", LookAt:=xlPart)
    Loop

    Set Again1 = Cells.Find(What:=";#9", LookAt:=xlPart)
    Do While Not Again1 Is Nothing
        Cells.Replace What:=";#9", Replacement:=";#", LookAt:=xlPart, _
            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
            ReplaceFormat:=False
        Set Again1 = Cells.Find(What:=";#9", LookAt:=xlPart)
    Loop
    Again = Again + 1
Loop

Set Again1 = Cells.Find(What:="#;#", LookAt:=xlPart)
Do While Not Again1 Is Nothing
    Cells.Replace What:="#;#", Replacement:=" | ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Set Again1 = Cells.Find(What:="#;#", LookAt:=xlPart)
Loop

Set Again1 = Cells.Find(What:=";#", LookAt:=xlPart)
Do While Not Again1 Is Nothing
    Cells.Replace What:=";#", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Set Again1 = Cells.Find(What:=";#", LookAt:=xlPart)
Loop

Set Again1 = Cells.Find(What:="#;", LookAt:=xlPart)
Do While Not Again1 Is Nothing
    Cells.Replace What:="#;", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Set Again1 = Cells.Find(What:="#;", LookAt:=xlPart)
Loop

Set Again1 = Cells.Find(What:="#", LookAt:=xlPart)
Do While Not Again1 Is Nothing
    Cells.Replace What:="#", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Set Again1 = Cells.Find(What:="#", LookAt:=xlPart)
Loop

Set Again1 = Cells.Find(What:="; |", LookAt:=xlPart)
Do While Not Again1 Is Nothing
    Cells.Replace What:="; |", Replacement:=" |", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Set Again1 = Cells.Find(What:="; |", LookAt:=xlPart)
Loop

Range("A1").Select
MsgBox "Extraneous hash data has been deleted."
Exit Sub

Nope:
    MsgBox "This is not the proper spreadsheet setup to run this macro."

End Sub 
```

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

我还在 xlam 中创建了一个带有 iRibbon 控件的附加宏，以通过 Excel 中自定义功能区上的按钮访问此宏，然后编辑 xlam UI xml 以适应它。但这只是装腔作势，因为一旦您准备好使用宏，您就可以按照自己喜欢的方式设置 UI。

您必须在“信任中心”、“宏选项”的“Excel 选项”中打开“信任 VBA 项目对象模型”。当然，除非您有能力对插件进行数字签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T17:26:47.887

我对这个问题的解决方案是在列表中创建一个新列，根据我的情况将其命名为“OnlyValues”。我创建了一个工作流程，以便每当在列表中创建或更新项目时，我都会继续使用“Person Group”字段的值更新“OnlyValues”

* * *

```
Person or Group field = AssignedTo
Auxiliary field = OnlyValues 
```

* * *

```
Workflow:
If Current Item:AssignedTo is not empty
 Set OnlyValues to Current Item:AssignedTo
then Stop the workflow and log Success 
```

* * *

之后，我在列表上创建了一个视图，显示了我的其他字段和 OnlyValues 并导出到 Excel。标签现在不见了！希望这对任何人都有帮助！^^

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-04T07:55:04.657

我也是，用宏来清理它

```
Private Sub CommandButton1_Click()
'Columns to format
    Dim cols() As Variant: cols = Array("AC", "AL", "AM", "BA", "BB")
    Dim col As String

    For i = LBound(cols) To UBound(cols)
        Call FormatColumn("Sheet1", cols(i))
    Next

    MsgBox ("Formatting Lookup & Person - Group column completed.")
End Sub

Sub FormatColumn(ByVal Shet As String, ByVal col As String)
    Dim flagValueChanged As Boolean: flagValueChanged = False
    Dim strPattern1 As String: strPattern1 = "#\d+;"
    Dim strPattern2 As String: strPattern2 = "#\d+"
    Dim strPattern3 As String: strPattern3 = "#"
    Dim strReplace As String: strReplace = ""
    Dim regex As New RegExp
    With regex
        .Global = True
        .MultiLine = True
        .IgnoreCase = True
    End With

    'process for all items in the column

    rowscount = Sheets(Shet).Range("A1048576").End(xlUp).Row
    'i = 16
    For i = 2 To rowscount
        flagValueChanged = False
        currentValue = Sheets(Shet).Cells(i, col)
        'MsgBox (currentValue)

        'format Pattern1
        With regex
           .Pattern = strPattern1
        End With

        If regex.Test(currentValue) Then
           currentValue = regex.Replace(currentValue, strReplace)
           flagValueChanged = True
           'MsgBox (currentValue)
        End If

        'format Pattern2
        With regex
           .Pattern = strPattern2
        End With

        If regex.Test(currentValue) Then
           currentValue = regex.Replace(currentValue, strReplace)
           flagValueChanged = True
           'MsgBox (currentValue)
        End If

        'format Pattern3
        With regex
           .Pattern = strPattern3
        End With

        If regex.Test(currentValue) Then
           currentValue = regex.Replace(currentValue, strReplace)
           flagValueChanged = True
           'MsgBox (currentValue)
        End If

        'update formatted value
        If flagValueChanged Then
           Sheets(Shet).Cells(i, col) = currentValue
        End If

        'MsgBox (currentValue)
    Next i

End Sub 
```

# linux - Linux 调度程序历史

> ID：11636949
> 
> 赞同：0
> 
> 时间：2012-07-24T18:20:29.000
> 
> 标签：linux, linux-kernel, scheduler

我有一个在 Linux 上运行的进程，它创建了很多 pThreads（它们每个都有自己的目的）。假设由于某种原因其中一个线程崩溃了。有时，崩溃可能是由其他线程引起的，最好知道在崩溃之前运行的是哪些线程。

**所以问题是：** 有没有办法询问 Linux 调度程序最后调度了哪些线程？

非常感谢任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T19:22:52.870

可能您知道 Linux “top”命令，它可以向您显示您的进程打开的所有线程：

> top -H -p "你的进程的pid"

我可以帮助确定有多少正在运行的线程停止或崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T22:37:58.163

您必须更改内核代码以在每次上下文切换时收集调度数据并继续写入内存中的某个位置，这有点类似于 PNE 内核中可用的飞行记录器功能。

# c# - 通用类成员填充问题（数据行到对象映射器）（高效解决方案）

> ID：11636957
> 
> 赞同：0
> 
> 时间：2012-07-24T18:20:54.133
> 
> 标签：c#, generics, orm, accessor, system.reflection

我正在寻找为生产服务器创建数据库行到对象映射器。

我的目标是在一个位置填写数据库列名是什么，以及在该对象的哪个字段中存储从数据库查询返回的单行。

我计划稍后添加功能以自动获取表名和连接字符串。这样做的目的是集中所有与数据库相关的东西（列的命名和查询字符串自动跟随，对返回的结果添加保护，错误记录等）

我读了很多关于泛型集访问器的文章，认为我目前无法从中综合解决方案。

这是我想要实现的（非工作）骨架。欢迎所有关于优化和更好实践的评论。

用途：

```
 /* get MediaInfo filled regarding CDbColumnFind criterias */
    CEventReportingMediaInfo MediaInfo = DbQuery(1, new CDbColumnFind() { Name = "uid", Value = "2" }); 
```

这是 Db-Mappable 基类

```
 public class DbMappableClass
    {
        /********************************************/
        /* required fields for database information */
        /********************************************/
        public string TableName;
        public IList TableColumns;

        /********************************************/
        /* generic object filling helper            */
        /********************************************/
        public void ReadObject(DataRow FromRow)
        {
            foreach (CDbColumn Column in TableColumns)
            {
                TryParseGeneric(FromRow[Column.Name].ToString(), Column.Field);
            }
        }

        /********************************************/
        /* conversion helper                        */
        /********************************************/
        public static bool TryParseGeneric(string src, T value)
        {
            TypeConverter converter = TypeDescriptor.GetConverter(typeof(T));

            try
            {
                value = (T)converter.ConvertFromString(src);
                return true;
            }
            catch
            {
                value = default(T);
                CSysLog.WriteEntry(SysLogLevel.WARNING, "failed to convert src ({0}) to type ({1}), use default value ({2})", src.ToString(), typeof(T), value);
                return false;
            }
        }

        /********************************************/
        /* Db column type                           */
        /********************************************/
        public class CDbColumn
        {
            private readonly string name;
            private readonly SqlDbType sqltype;
            private readonly Type ctype;

            public CDbColumn(string Name, SqlDbType SqlType, object Field)
            {
                this.name = Name;
                this.sqltype = SqlType;
                this.Field = Field;
                this.ctype = Field.GetType();
            }

            public string Name { get { return name; } }
            public SqlDbType SqlType { get { return sqltype; } }
            public object Field { get; set; }
            public Type CType { get { return ctype; } }
        }

        /********************************************/
        /* Db Query type criterias                  */
        /********************************************/
        public class CDbColumnFind
        {
            public string Name;
            public object Value;
        }

        /********************************************/
        /* Generic Db Query                         */
        /********************************************/
        public static TReturnType DbQuery(int ExpectedCount, params CDbColumnFind[] Args) where TReturnType : DbMappableClass, new()
        {
            /* query database, obtain results in RowResults ... */

            TReturnType ReturnResult = new TReturnType();

            DataRow RowResults = TableResult.Rows[0];

            ReturnResult.ReadObject(RowResults);
        }
    } 
```

现在是 db-mappable 派生对象的自定义集中声明

```
 /********************************************/
    /* Event Reporting Media Table : Database   */
    /********************************************/
    public class CEventReportingMediaInfo : DbMappableClass
    {
        /**********************************/
        /** Member Declaration          ***/
        /**********************************/
        public int          Uid     { get; set; }
        public MediaType    Type    { get; set; }
        public string       IpAddr  { get; set; }
        public Int32        Port    { get; set; }
        public MediaStatus  Status  { get; set; }
        public int          Delay   { get; set; }

        /**********************************/
        /** Database Informations       ***/
        /**********************************/
        public CEventReportingMediaInfo()
        {
            TableName = "event_reporting_media_tbl";

            TableColumns = new ReadOnlyCollection (new[] {
                    new CDbColumn ("uid"           , SqlDbType.Int,            Uid),
                    new CDbColumn ("media_type"    , SqlDbType.TinyInt,        Type),
                    new CDbColumn ("media_ip"      , SqlDbType.VarChar,        IpAddr),
                    new CDbColumn ("media_port"    , SqlDbType.Int,            Port),
                    new CDbColumn ("media_status"  , SqlDbType.TinyInt,        Status),
                    new CDbColumn ("media_delay"   , SqlDbType.Int,            Delay)
            });
        }

        public enum MediaType
        {
            INVALID = 0,
            SIP_GATEWAY = 1,
            MODEM = 2
        }

        public enum MediaStatus
        {
            OFFLINE = 0,
            ONLINE = 1
        }
    } 
```

如何实现由 ReadObject() 填充的指定字段（Uid、Type、IpAddr 等）？我需要一个等效于指向成员的指针......我也读过反射，但我不确定效率并且不理解 100% 如何实现它。

注意：我宁愿不使用完整的 ORM 解决方案——我的理解是它不是一个战略性的长期解决方案（对于未来的实现、支持等不太灵活——更容易但不是真正的企业级）。我想保持对数据库映射层的控制，同时减少生产服务器未来开发中出现的故障。

你们如何看待这个实施，实现我的目标的最佳方式是什么？

感谢您的宝贵时间，并致以最诚挚的问候，

墨菲斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:31:46.617

您的猜测是正确的：您将不得不使用反射。

（一位已经完成 DAL 框架的人的一点建议。

1.  不要这样做。每种选择和风格都有很多可用的框架。如果您不喜欢 Entity Framework 或 nHibernate 等成熟的 ORM - 将光照映射器用作 Dapper 或 BLToolkit。否则你会花太多时间发明自己的自行车，而且很可能你还是会弄错。
2.  如果您仍想这样做，请计划实施 LINQ，因为它是（对于开发人员）构建类型安全查询的最简单方法。
3.  如果您*仍然*想要它，请不要强制您的“实体”类从您预定义的基类（`DbMappableClass`在您的情况下）继承。它打破了设计，打破了分层，打破了简单性。）

# entity-framework - 如何从 Entity Framework 4.0 升级到 4.3

> ID：11636962
> 
> 赞同：1
> 
> 时间：2012-07-24T18:21:10.593
> 
> 标签：entity-framework, entity-framework-4.3

我有一个使用 Entity Framework 4.0 的项目。在那个项目中，我安装了 4.3。我的 app.config 中出现了一些更改，表明我现在使用的是 4.3。但是，即使我删除并重新添加 edmx，我生成的代码仍然继承自 ObjectContext 并创建 ObjectSet。如何让生成器使用 DbContext 和 DbSets？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T19:59:20.880

您必须从 Visual Studio 库下载[DbContext T4 模板](http://visualstudiogallery.msdn.microsoft.com/7812b04c-db36-4817-8a84-e73c452410a2)- 您可以从 Visual Studio 的扩展管理器中获取它。

# air - SimController（设备模拟器窗口）在我调试 SWF 时消失

> ID：11636964
> 
> 赞同：2
> 
> 时间：2012-07-24T18:21:16.303
> 
> 标签：air, flash-cs6

这个奇怪的问题已经发生了几天，但以前没有。

知道如何显示/打开它会很棒，我还没有找到任何地方。

![最终加载 SWF 时，模拟器窗口消失了！](../Images/c32852e30a57d0539c2829babd117ad3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:56:05.617

在 AIR Debug Launcher (Mobile) 中选择 Control > Test Movie >

# javascript - 如何通过调用javascript函数在iphone应用程序中计算行驶距离

> ID：11636973
> 
> 赞同：2
> 
> 时间：2012-07-24T18:22:07.033
> 
> 标签：javascript, iphone, ios, google-maps, driving-distance

无论地图是否显示，我都想在我的 iphone 应用程序中计算行驶距离。以前，我看到了一些可以完成这项工作的 javascript。这是html中javascript的源代码：

```
<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
        <title>Distance Calculator</title>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <style type="text/css">
            #map_canvas { 
               height: 100%;
            }
        </style>
        <script type="text/javascript">
    var directionDisplay;
    var directionsService = new google.maps.DirectionsService();
    var map;

    function initialize() {
        directionsDisplay = new google.maps.DirectionsRenderer();
        var melbourne = new google.maps.LatLng(-37.813187, 144.96298);
        var myOptions = {
            zoom:12,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            center: melbourne
        }

        map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
        directionsDisplay.setMap(map);
    }

    function calcRoute() {
        var start = document.getElementById("start").value;
        var end = document.getElementById("end").value;
        var distanceInput = document.getElementById("distance");

        var request = {
            origin:start, 
            destination:end,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };

        directionsService.route(request, function(response, status) {
            if (status == google.maps.DirectionsStatus.OK) {
                directionsDisplay.setDirections(response);
                distanceInput.value = response.routes[0].legs[0].distance.value / 1000;
            }
        });
    }
    </script>
</head>
<body onload="initialize()">
    <div>
        <p>
            <label for="start">Start: </label>
            <input type="text" name="start" id="start" />

            <label for="end">End: </label>
            <input type="text" name="end" id="end" />

            <input type="submit" value="Calculate Route" onclick="calcRoute()" />
        </p>
        <p>
            <label for="distance">Distance (km): </label>
            <input type="text" name="distance" id="distance" readonly="true" />
        </p>
    </div>
    <div id="map_canvas"></div>
</body> 
```

然后我想知道如何在我的 iphone Objective-c 文件中调用 javascript 函数。

我在 ViewController.m 中尝试这个：

```
[webView loadHTMLString:@"<script src=\"calDistance.js\"></script>" baseURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] resourcePath]]];
NSString *function = [[NSString alloc] initWithFormat: @"calcRoute('%@', '%@')", address1,address2];
NSString *result = [webView stringByEvaluatingJavaScriptFromString:function];
self.distance.text = result; 
```

其中 calDistance.js 是一个 javascript 文件，其中包含上述 2 个函数：initialize()、calcRoute()，并且我还重写了 calcRoute() 函数以传递 2 个地址字符串。“距离”是应该显示行驶距离的标签。但是它不起作用。

它与最初在javascript文件中的以下行有关吗？

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
```

因为我不知道如何插入这个“ [http://maps.google.com/maps/api/js?sensor=false](http://maps.google.com/maps/api/js?sensor=false) ”链接。我应该怎么办？我的代码中还有其他问题吗？我的方法计算行驶距离是否正确？

# oracle - Oracle 中的触发器失败

> ID：11636974
> 
> 赞同：0
> 
> 时间：2012-07-24T18:22:11.213
> 
> 标签：oracle, triggers

编辑：这里的每个请求是 SQL*Plus 中发生的事情 编辑 2：问题是列名是关键字 SQL> 删除表注释；

```
Table Dropped.

SQL> create table comments (
 2 comment_id number not null,
 3 post_id number not null,
 4 user_id number not null,
 5 message varchar2(2500) not null,
 6 timestamp timestamp(6) not null);

Table Created

SQL> create sequence comment_seq
 2 start with 1
 3 increment by 1
 4 nomaxvalue;

Sequence Created

SQL> ed

Wrote file afiedt.buf //NOTEPAD OPENED UP

1 create or replace trigger comment_trigger
2      before insert on comments
3      for each row
4 begin
5     select comment_seq.nextval
6     into :new.comment_id
7     from dual;
8 end;
SQL> /

    ERROR at Line 2:
    ORA-06552: PL/SQL: Compilation unit analysis terminated
    ORA-06553: PLS-320: the declaration of the type of this expression is
    incomplete or malformed

    SQL> show errors
    No errors. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:27:35.263

假设我更正了数字列的数据类型（`number(300)`不是有效的数据类型），那么该代码似乎对我有用。如果您遇到错误，这意味着您正在执行与您在此处发布的内容不同的操作。

```
SQL> create table comments (
  2    comment_id number not null,
  3    post_id    number not null,
  4    user_id    number not null,
  5    message    varchar2(2500) not null,
  6    timestamp  timestamp(6) not null
  7  );

Table created.

SQL> create sequence comment_seq
  2  start with 1
  3  increment by 1
  4  nomaxvalue;

Sequence created.

SQL> ed
Wrote file afiedt.buf

  1  create or replace trigger comment_trigger
  2    before insert on comments
  3    for each row
  4  begin
  5    select comment_seq.nextval
  6      into :new.comment_id
  7      from dual;
  8* end;
SQL> /

Trigger created. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-25T07:32:50.163

*扩展评论...*

该错误是由表中命名的列引起`timestamp`的`comments`。使用保留字作为对象名称不是一个好主意，因为它会导致混乱和晦涩难懂的问题，并且可能需要转义（如此[处](https://stackoverflow.com/q/11629966/266304)）。

在这种情况下，即使创建的表没有错误，触发器（尽管它可以是任何已编译的 PL/SQL“库单元”）也会失败，特别是因为列名是*数据类型*而不仅仅是保留字。

这似乎是错误 6331062，'PLS-320 if a column name is a datatype (eg "TIMESTAMP")'，错误报告说已在补丁集 10.2.0.5（见注释 1088172.1）和 11.1.0.7 中修复，并且在 11gR2 基本版本中 - 这可以解释为什么 Justin 和 Craig 没有看到它。（我假设 Justin 使用的是 11gR2；Craig 的输出显示他使用的是 11.1.0.7）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T19:28:02.383

什么版本的甲骨文？

另外，如果您只是将触发代码直接放入 SQL*Plus 而不是使用“ed”，会发生什么情况？

但很奇怪，因为你的脚本对我来说很好：

```
Oracle Database 11g Enterprise Edition Release 11.1.0.7.0

SQL> create table comments (
  2   comment_id number not null,
  3   post_id number not null,
  4   user_id number not null,
  5   message varchar2(2500) not null,
  6   timestamp timestamp(6) not null);

Table created.

SQL> create sequence comment_seq
  2   start with 1
  3   increment by 1
  4   nomaxvalue;

Sequence created.

SQL> ed
Wrote file afiedt.buf

  1  create or replace trigger comment_trigger
  2        before insert on comments
  3        for each row
  4   begin
  5       select comment_seq.nextval
  6       into :new.comment_id
  7       from dual;
  8*  end;
SQL> /

Trigger created. 
```

# java - Java：字符串的字符（以字节为单位）的值是常量吗？

> ID：11636977
> 
> 赞同：1
> 
> 时间：2012-07-24T18:22:21.200
> 
> 标签：java, character-encoding, char, byte

**TL;DR**：在 Java 中，通过方法从字符串获得的字符`charAt`转换为字节是否总是产生相同的值？

我正在阅读用任意（我们不知道）字符编码编码的文件。我需要解析这些文件并查找某些单词，例如“TAG”。我对文件内容进行了一定的限制，例如“在查找标签时，“标签”的字节必须与其 ASCII 表示相同”。

例如，假设我有以下文件：
`0x00 0x11 0x22 0x33 0x54 0x41 0x47 0x77 0x88 0x99 0xaa 0xbb`
由于 T、A 和 G 的 ASCII 值分别为`0x54`和`0x41`，`0x47`我可以通过解析字节本身在文件中找到“TAG”。 但是，我需要对要查找的字节的值进行硬编码。为此，我调用'
`0x00 0x11 0x22 0x33`**`0x54 0x41 0x47`**`0x77 0x88 0x99 0xaa 0xbb`

`String``charAt(int i)`方法并将 char 转换为一个字节。

例如，我将如何验证任意字节（称为`b`）来表示“T”的字节表示：
`String tag = "TAG";`
`char t = tag.charAt(0);`
`if ((byte)t == b){`
        `//magic goes here, such as comparing the 'A' and the 'G'`
`}`
*注意：代码实际上并非如此，验证算法要优雅得多。*

这在我的本地机器上运行良好。但是，这将在可能包含非常奇怪编码的机器上运行。让我担心的是，将使用获得的字符`charAt`转换为字节是否会产生不同的值，具体取决于机器。我知道 Java 总是`char`使用 UTF-16 字符编码对 s 进行编码，但我担心从字符串转换为字符然后再转换为字节时可能会产生奇怪的结果。

因此，简而言之，将通过`charAt`一个字节的方法总是产生相同的值？还是取决于外部因素？

谢谢你的帮助！

***注意**：我不能对字节本身进行硬编码（例如，在字节数组中），因为它们可能非常长并且将来可能会经常更改。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:31:23.847

`java.lang.string.charAt`将始终返回 16 位 UTF-16 字符，当您将其转换为字节时，该字符始终相同，但由于`char`是 16 位无符号数据类型，因此将其转换为 8 位有符号`byte`可能会给您带来不希望的行为。但是，如果您的源数据是 ASCII，您将获得您所期望的行为类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T18:30:07.973

Yes`charAt (int)`返回一个 Java 定义的 char 类型 (UTF-16)，因此总是相同地转换为`byte`.

相反`String.getBytes()`，根据指定的字符集或操作系统的默认字符集（如果未指定）返回字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T18:26:36.050

将 char 转换为 byte`(byte)`将在所有系统上为您提供相同的结果。

但是，很少需要混合`char`和`byte`. 你真的应该使用其中一个。正如您所怀疑的那样，混合这些概念可能会导致混淆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-27T09:35:24.763

您可以使用该`Character.codePointAt(char c)`方法，而不是直接对它们进行类型转换。这应该保证您每次都获得相同的结果。

# javascript - locaStorage 和 javascript 循环

> ID：11636979
> 
> 赞同：0
> 
> 时间：2012-07-24T18:22:28.140
> 
> 标签：javascript, local-storage

我的小应用程序有问题，您可以在这里查看：http: [//jsfiddle.net/47bV8/](http://jsfiddle.net/47bV8/)

我的问题是：我输入了一些注释，然后当我“清除所有”并重新输入注释时，控制台在刷新时返回我 lsReturn == null 。

我明白为什么，但看不到如何解决问题。

事实上，我的 'var i' 的值在全部清除后不是 0（它的值是我输入的最后一个音符，所以如果我输入了 5 个音符，则为 5），所以当我重新输入一个音符时，它是任务 6，所以刷新我的第一个循环失败了......

我试图在 localstorage.clear 之后设置 var i = 0 但它不起作用......

```
 jQuery(document).ready(function() {

  // Initial loading of tasks
  var i = 0;

    // clear All

  jQuery('.clear').on('click',function(e){

    e.preventDefault();
    jQuery('#tasks li').remove();
    localStorage.clear();
    jQuery(this).data('erase', true);

  });

  if(localStorage.length){  
     for( i = 0; i < localStorage.length; i++){ 

        var lsReturn = JSON.parse(localStorage.getItem('task-'+i));

        if (lsReturn == null){ // HERE IS THE PROBLEM
          var b = 0; //

        }else{
            jQuery("#tasks").append("<li id='task-"+i+"'>" + lsReturn.text  + " <a href='#'>Delete</a></li>");
           jQuery('#tasks li#task-'+i+'').css('background-color', lsReturn.color );

        }

     }

  }else{

    jQuery('header').after("<p class='error'>no messages</p>");

  }

  // ----------------- ADD A TASK ----------------------//

  jQuery("#tasks-form").submit(function() {

    if (jQuery("#task").val() != "" ) {

      jQuery('#task').attr('placeholder', "Enter a note")

      var text = jQuery("#task").val(); 
      var color = jQuery('#color').val(); 

      var allNotes = {}; 
      var note = {}; 

      note.text = text; 
      note.color = color;

      allNotes['task-'+i] = note; 

      var lsStore = JSON.stringify(allNotes['task-'+i ]);

      localStorage.setItem( "task-"+i, lsStore); 

      var lsStoreReturn = JSON.parse(localStorage.getItem("task-"+i, lsStore)); 

      jQuery("#tasks").append("<li id='task-"+i+"'>"+ lsStoreReturn.text +"<a href='#'>Delete</a></li>"); 
      jQuery('#tasks li#task-'+i+'').css('background-color', lsStoreReturn.color );
      jQuery("#task").val(""); 

      i++; 

    }else{

       jQuery('#task').attr('placeholder', "nothing in it !")

    }

    return false; 

  });

  // ----------------- REMOVE A TASK ----------------------//

  jQuery("#tasks li a").live("click", function(e) {

    e.preventDefault();

    localStorage.removeItem(jQuery(this).parent().attr("id"));

    jQuery(this).parent().remove();

    // PROBLEM solved : if I remove a task #2 in a list of  4 item for example, if i   refresh the list become 0, 1, 3, 4, 
    // so the locastorage loop doesn't find the item 2 

   for(i=0; i<localStorage.length; i++) { // SO I check my locastorage

      if(localStorage.getItem("task-"+i) == null) { // If the task 4 doesn't exist

        localStorage.setItem("task-"+i, localStorage.getItem('task-' + (i+1)));
        // I do : create  task-4 
        // and give him the value of task 5
        localStorage.removeItem('task-'+ (i+1) ); 
        // the i remove task 5
        // so the loop wiil not find task 5 and give him the value of task 6 etc..
      }
    }
  });

});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:38:35.077

`i`通过以下方式重置您的变量

```
jQuery('.clear').on('click',function(e) {
  e.preventDefault();
  jQuery('#tasks li').remove();
  localStorage.clear();
  jQuery(this).data('erase', true);
  // Need to reset the index counter here.
  i = 0;
}); 
```

这是一个更新/工作的[小提琴](http://jsfiddle.net/brantolsen/47bV8/1/)。

# ruby-on-rails - 如何检查 Rails 控制台中启用了哪些观察者

> ID：11636981
> 
> 赞同：2
> 
> 时间：2012-07-24T18:22:28.140
> 
> 标签：ruby-on-rails, console, observer-pattern, observers

我在不同的环境中启用了不同的观察者，我希望能够通过控制台检查哪些是启用的

就像是

```
ActiveRecord::Observers.list 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T22:05:23.037

你可以通过`ActiveRecord::Base.observers`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-24T18:35:37.853

尝试`ActiveRecord::Observer.observed_classes`

# objective-c - 如何计算 PDF 文档中嵌入的图像的分辨率 (DPI)？

> ID：11636982
> 
> 赞同：12
> 
> 时间：2012-07-24T18:22:29.030
> 
> 标签：objective-c, cocoa, pdf, quartz-graphics, poppler

我有一个包含图像的[PDF 文档。](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/QuartzFramework/Classes/PDFDocument_Class/Reference/Reference.html)

现在我想知道这些图像的分辨率。

第一步是以某种方式从 PDF 文档中获取图像。但是怎么做？

可可中提供的东西甚至可能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-28T09:30:55.560

看看你的另一个问题的答案：

*   [**PDF 文档可以包含具有不同 DPI 的图像吗？**](https://stackoverflow.com/a/11699750/359307)

基本上，您现在可以`-list`为 Poppler 的`pdfimages`命令行实用程序使用（新）参数（它***不适***用于 XPDF 的版本`pdfimages`！）。

它将报告出现在查询页面上的每个图像的*尺寸。*

[*（您也可以使用它从 PDF 中提取图像：`pdfimages -png -f 3 -l 5 some.pdf prefix---`将从 PDF 文件中提取所有图像为 PNG，从第一**页**3 开始，到最后一页 5 结束**，**`prefix---`使用每个图像的文件名前缀。但是这个问题似乎不是你问题的主要焦点......）*]

### 例子：

```
pdfimages -list -f 1 -l 3 /Users/kurtpfeifle/Downloads/ct-magazin-14-2012.pdf

  页面编号类型宽度高度颜色comp bpc enc interp 对象ID
  -------------------------------------------------- ------------------
     1 0 图像 1247 1738 RGB 3 8 jpx 无 3053 0
     2 1 图像 582 839 灰色 1 8 jpeg no 2080 0
     2 2 图像 344 364 灰色 1 8 jpx 无 2079 0
     3 3 图像 581 838 RGB 3 8 jpeg 无 7 0
     3 4 图像 1088 776 RGB 3 8 jpx 无 8 0
     3 5 图像 6 6 RGB 3 8 图像编号 9 0
     3 6 图像 8 6 RGB 3 8 图像编号 10 0
     3 7 图像 4 6 RGB 3 8 图像编号 11 0
     3 8 图像 212 106 RGB 3 8 jpx 无 12 0
     3 9 图像 150 68 RGB 3 8 jpx 无 13 0
     3 10 图像 6 6 RGB 3 8 图像编号 14 0
     3 11 图像 4 4 RGB 3 8 图像编号 15 0

```

它不直接报告 DPI 分辨率 - 但从“宽度”和“高度”维度您可以轻松计算它：您使用英寸标尺测量屏幕上图片的宽度，然后将“宽度像素”除以测量的尺数...

您觉得这很奇怪，因为结果取决于您当前的缩放级别？是的！

“分辨率”的概念始终取决于环境。所谓的“高分辨率”图片基本上总是在宽度和高度上有很多像素。如果需要以更高的缩放级别显示或打印图片，这允许更好的质量（或“分辨率”）。

* * *

## 更新

同时有一个新版本的 (Poppler's) `pdfimages`：

```
$  pdfimages -version
  pdfimages version 0.33.0
  [....] 
```

这也报告了嵌入图像的分辨率，以 PPI（每英寸像素数）、水平 ( `x-ppi`) 和垂直 ( `y-ppi`) 方向为单位：

```
page num  type width height color comp bpc enc interp objectID x-ppi y-ppi size ratio
-------------------------------------------------------------------------------------
   1   0 image  1247  1738  rgb     3   8  jpx    no    3053 0   151   151  228K 3.6%
   2   1 image   582   839  gray    1   8  jpeg   no    2080 0    72    72  319B 0.1%
   2   2 image   344   364  gray    1   8  jpx    no    2079 0   150   150 4325B 3.5%
   3   3 image   581   838  rgb     3   8  jpeg   no       7 0    73    73 1980B 0.1%
   3   4 image  1088   776  rgb     3   8  jpx    no       8 0   150   151  106K 4.3%
   3   5 image     6     6  rgb     3   8  image  no       9 0   150   150  108B 100%
   3   6 image     8     6  rgb     3   8  image  no      10 0   150   150  158B 110%
   3   7 image     4     6  rgb     3   8  image  no      11 0   150   150   73B 101%
   3   8 image   212   106  rgb     3   8  jpx    no      12 0   150   150 2396B 3.6%
   3   9 image   150    68  rgb     3   8  jpx    no      13 0   150   150 1878B 6.1%
   3  10 image     6     6  rgb     3   8  image  no      14 0   150   150   81B  75%
   3  11 image     4     4  rgb     3   8  image  no      15 0   150   150   50B 104% 
```

此新功能首次出现在 Poppler 0.25 版（2013 年 12 月 11 日星期三发布）中。它还报告...

*   ... *（文件）大小*和
*   ... *（压缩）比率*

...嵌入图像。

### 的限制`pdfimages -list`

也许我还应该让您了解该`pdfimages`实用程序的局限性，并举一个其输出报告不完全正确的示例。

一个例子是我**（最近创建的） GitHub 存储库中的****[这个手工编码](https://raw.githubusercontent.com/angea/PDF101/master/handcoded/111_current-transformation-matrix-ctm.pdf)****[的 PDF，它可以帮助初学者学习 PDF 源代码的语法](https://github.com/angea/PDF101/tree/master/handcoded)**。

我最初创建此 PDF 是为了演示**[Mozilla 的 PDF.js 渲染器的错误](https://github.com/mozilla/pdf.js/issues/5757)**。这是关于它在*PDF.js*中的外观（左）以及正确渲染时的外观的屏幕截图（右，由*Ghostscript**和*Adob ​​e *Reader*渲染）：

![](../Images/923f52abfab8299d96371c18430fae15.png) ![](../Images/99a6ac7403b62e5f9765fe89b7847eb5.png)

[*（右键单击上面的每个图像。选择“在新选项卡中打开图像”以查看确切的差异...“）*]

* * *

PDF 文件包含一个 2x2 像素的图像，***仅嵌入一次***（带有 object ID `5 0`），但***在页面上多次显示并使用不同的设置***，每次放置图像时...

*   ...在不同的位置，
*   ...具有不同的缩放比例，
*   ...不同的旋转，
*   ...即使有不同的*skew*。

在这些极端情况下`pdfimages -list`，当试图确定此图像实例的*某些*分辨率时，它会一头雾水：

```
page num type width height color comp bpc enc interp objectID x-ppi y-ppi size ratio
------------------------------------------------------------------------------------
   1   0 image    2     2  rgb     3   8 image  no        5 0     4     4   13B 108%
   1   1 image    2     2  rgb     3   8 image  no        5 0     5     3   13B 108%
   1   2 image    2     2  rgb     3   8 image  no        5 0     3     5   13B 108%
   1   3 image    2     2  rgb     3   8 image  no        5 0     6     3   13B 108%
   1   4 image    2     2  rgb     3   8 image  no        5 0     3    10   13B 108%
   1   5 image    2     2  rgb     3   8 image  no        5 0     4 72000   13B 108%
   1   6 image    2     2  rgb     3   8 image  no        5 0     4     2   13B 108%
   1   7 image    2     2  rgb     3   8 image  no        5 0     2     4   13B 108%
   1   8 image    2     2  rgb     3   8 image  no        5 0 14401     1   13B 108%
   1   9 image    2     2  rgb     3   8 image  no        5 0     1     2   13B 108%
   1  10 image    2     2  rgb     3   8 image  no        5 0 0.950     4   13B 108%
   1  11 image    2     2  rgb     3   8 image  no        5 0     4 0.950   13B 108%
   1  12 image    2     2  rgb     3   8 image  no        5 0 0.950     4   13B 108%
   1  13 image    2     2  rgb     3   8 image  no        5 0     1     4   13B 108%
   1  14 image    2     2  rgb     3   8 image  no        5 0 0.950     4   13B 108%
   1  15 image    2     2  rgb     3   8 image  no        5 0 0.950     4   13B 108%
   1  16 image    2     2  rgb     3   8 image  no        5 0     4 0.950   13B 108% 
```

`pdfimages -list`如果没有旋转和/或不涉及倾斜，则大多数值都是正确的。难怪图像旋转或倾斜会出现差异：因为对于这种情况，您如何可靠地定义*and*`x-ppi`值`y-ppi`？这解释了`72000 y-ppi`图像编号的（完全错误的）值。5 和`14401 x-ppi`图像编号。8.

如您所见，`pdfimages`确定其他图像属性相当聪明：

1.  它为显示的图像的所有实例正确报告了相同的对象 ID `5 0`，表明此图像***嵌入了一次***，但在页面上***显示了多次***。
2.  它正确地将图像尺寸报告为`2x2`像素。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T18:40:35.427

这并不容易，但这是可能的。虽然你不能使用`PDFDocument`.，但你可以使用`CGPDF*`Quartz 中的东西。简而言之：您将需要使用`CGPDFPageGetDictionary()`获取图像所在页面的字典，然后从字典中获取有关其 XObject 的信息（假设它未内联在流中）。即使这也不是很简单——您需要查阅 PDF 标准以了解如何格式化 XObject，然后使用各种`CG*`例程深入了解您需要的内容。

我应该补充一点，PDF 文档的默认 DPI（“用户单位”）是 72。此外，PDF 中的许多图像都是用矢量图形创建的，因此它们实际上没有默认 DPI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T07:23:53.713

您需要通过 Do 命令访问的原始图像 XObject 的尺寸

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-23T00:40:24.663

答案肯定是否定的，因为 PDF 文档并没有真正的内在分辨率。解决方案最终取决于当时谁在处理文档及其元素。它甚至会因您在 Adob​​e Acrobat 中使用的缩放量而异。

例如，我创建了一个 16x16 像素尺寸的二维条码，并在将其添加到文档之前将其缩放为一英寸宽和一英寸高。它在 adobe acrobat reader 中看起来非常清晰（即每平方元素有很多像素），但是当我将生成的 PDF 发送到传真服务时，它最终是 100x200 分辨率（大约）。当我在激光打印机中打印同一份文档时，它最终更像是 400dpi。当我在 acrobat reader 中单击条形码图像并将其复制/粘贴到 Gimp 中时，它会显示为一个 16x16 的微小位图。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-06-12T14:57:28.333

该答案旨在作为@Kurt Pfeifle 答案的附录，并且在Objective C 之外工作。

### 或者：

如果您有 Windows 系统并且没有设置编译器，那么以下是最简单的方法。下载 Windows XPDF 二进制文件；然后使用`pdfimages`提取图像，将它们转换为 BMP 格式，然后`mspaint`会告诉你分辨率。这种方法的优点是：

*   您可以通过测量图像大小来获得精确的分辨率，而无需进行估计；

*   它适用于***XPDF***的`pdfimages`.

缺点是：

*   这需要更多的工作，包括将文件转换为无需更改分辨率即可打开的格式；

*   您必须单独为每个文件执行此操作，而不是获取列表。

*   它为您提供图像本身的分辨率，而不是它们在 PDF 文件中出现的分辨率。（感谢 Kurt Pfeifle 的评论）

# jquery - 检查值选择选项列表

> ID：11636985
> 
> 赞同：1
> 
> 时间：2012-07-24T18:22:51.527
> 
> 标签：jquery

我有一个生成选项列表的 wordpress 插件。生成的代码是这样的：

```
<select name="question">
  <option value="yes">Yes</option>
  <option value="no">No</option>
  <option value="maybe">Maybe</option></select>

<p id="text">some text</p> 
```

如果选择了该选项，下面是我想显示的一段。如果选择是或否，则应将其隐藏。

我想出的 Jquery 脚本（经过大量的谷歌搜索、复制和粘贴）是这样的：

```
$('select').change(function(){
  var selectVal = $(‘select’).val();

            if( $selectVal=="maybe"){
              $('#text').show();}
            else{
            $('#text').hide();}
        }); 
```

不幸的是，这不起作用。有人知道我做错了什么或如何做对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:27:35.067

`$selectVal`不同于`selectVal`. 智能引号是 jQuery 选择器中的禁忌。

您还需要隐藏段落 onload。CSS`display: none`可以做到最好。

[http://jsfiddle.net/mblase75/uz2uf/](http://jsfiddle.net/mblase75/uz2uf/)

顺便说一句，您可以将布尔值传递给该`.toggle()`方法以缩短您的代码：

```
$('select').change(function() {
    var selectVal = $(this).val();
    $('#text').toggle(selectVal=="maybe");
});​ 
```

[http://jsfiddle.net/mblase75/uz2uf/1/](http://jsfiddle.net/mblase75/uz2uf/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:31:09.167

```
$('select[name=question]').change(function(){
  var selectVal = $(this).val();

  if( selectVal=="maybe"){
     $('#text').show();
  }else{
     $('#text').hide();}
}); 
```

jsfiddle：http: [//jsfiddle.net/ufomammut66/xqCKD/](http://jsfiddle.net/ufomammut66/xqCKD/)

# javascript - Javascript，数组

> ID：11636986
> 
> 赞同：1
> 
> 时间：2012-07-24T18:22:52.853
> 
> 标签：javascript, arrays, join, count

> **可能重复：**
> [计算 Javascript 数组元素的出现次数](https://stackoverflow.com/questions/5667888/counting-occurences-of-javascript-array-elements)

我在 javascript 中有一个数组，例如该数组是：

```
array(1,1,1,1,5,5,7,7); 
```

如果有人可以帮助我了解如何计算相似值，以及如何加入相似值，谢谢大家，祝你有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T18:30:51.920

```
var array = [1,1,1,1,5,5,7,7];

var count = 0;
var tempArray = array.sort();
var i;
var prevValue = null;
var joined = [];
for (i = 0; i < array.length; i++) {

    if (tempArray[i] != prevValue) {
        count++;
        prevValue = tempArray[i];
        joined.push(prevValue);
    }

}

​document.write(joined);​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T18:30:23.527

我可以建议使用[underscore.js](http://underscorejs.org "下划线.js")。您要查找的代码并不难编写，并且会是一次很好的学习体验。一旦你这样做了，underscore 是一个很棒的便利库，它提供你正在寻找的东西，你不必维护它。:)

[uniq](http://underscorejs.org/#uniq)函数将为您提供没有重复的数组副本，而[size](http://underscorejs.org/#size)函数将告诉您包含多少个值（或仅引用该`.length`属性）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T18:30:33.987

如果您希望唯一标识数组内容：

```
Array.prototype.unique =
  function() {
    var a = [];
    var l = this.length;
    for(var i=0; i<l; i++) {
      for(var j=i+1; j<l; j++) {
        // If this[i] is found later in the array
        if (this[i] === this[j])
          j = ++i;
      }
      a.push(this[i]);
    }
    return a;
  };

  var myArray = [1,1,1,1,5,5,7,7];

  var uniquedMyArray = myArray.unique();
  var valueCountsMyArray = [];
  for (var i = 0; i < myArray.length; i++) {
     if (valueCountsMyArray[myArray[i]])
        valueCountsMyArray[myArray[i]]++;
     else
        valueCountsMyArray[myArray[i]] = 1;
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T18:26:28.293

这里有一个解决方案来计算它包含一个数字的次数。

```
var count = [];
for(var i=0; i<array.length; i++) {
    count[array[i]]++;
} 
```

# iis-7 - 使用集成身份验证配置 IIS 以不允许 ie 用户使用自动登录选项

> ID：11636987
> 
> 赞同：0
> 
> 时间：2012-07-24T18:23:01.823
> 
> 标签：iis-7, windows-authentication

有没有办法总是强制用户必须将他们的用户名和密码输入到使用集成 Windows 身份验证的 asp.net 站点，即使他们在 Internet Explorer 中的选项设置为自动登录？我知道域策略可以在 ie 中为它们设置选项，但由于客户端的其他情况，这不是一个选项，我不会详细说明。我只需要它始终提示输入凭据，无论是否在 ie 中选择了该选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:27:52.693

在您的配置文件中添加此部分：

```
<system.web>

  <authentication mode="Windows"/>

 </system.web> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T18:36:17.007

你不能那样做，对不起。强制用户输入登录名/密码的唯一方法是使用基于表单的身份验证。

# osgi - 更新捆绑包时出现 ArrayStoreException

> ID：11636989
> 
> 赞同：1
> 
> 时间：2012-07-24T18:23:22.183
> 
> 标签：osgi, classloader, apache-felix

使用 Apache Felix 更新捆绑包时，我得到了 ArrayStoreException。它出现在与更新的包不同的包中。受影响的捆绑包有一个服务侦听器，该侦听器对更新的捆绑包注册的新服务做出反应。侦听器执行一些以 ArrayStoreException 结尾的代码。这是堆栈跟踪：

```
ERROR: Bundle com.elsten.bliss.platform [47] EventDispatcher: Error during dispatch. (java.lang.ArrayStoreException: com.elsten.bliss.music.policy.tag.tagtype.TagTypePolicy)
java.lang.ArrayStoreException: com.elsten.bliss.music.policy.tag.tagtype.TagTypePolicy
        at com.elsten.bliss.main.Main.getPolicies(Main.java:473)
        at com.elsten.bliss.main.Main.<init>(Main.java:150)
        at com.elsten.bliss.main.Main.startup(Main.java:143)
        at com.elsten.bliss.main.Activator$VersionServiceTracker.addingService(Activator.java:58)
        at org.osgi.util.tracker.ServiceTracker$Tracked.customizerAdding(ServiceTracker.java:980)
        at org.osgi.util.tracker.ServiceTracker$Tracked.customizerAdding(ServiceTracker.java:906)
        at org.osgi.util.tracker.AbstractTracked.trackAdding(AbstractTracked.java:262)
        at org.osgi.util.tracker.AbstractTracked.track(AbstractTracked.java:234)
        at org.osgi.util.tracker.ServiceTracker$Tracked.serviceChanged(ServiceTracker.java:941)
        at org.apache.felix.framework.util.EventDispatcher.invokeServiceListenerCallback(EventDispatcher.java:932)
        at org.apache.felix.framework.util.EventDispatcher.fireEventImmediately(EventDispatcher.java:793)
        at org.apache.felix.framework.util.EventDispatcher.fireServiceEvent(EventDispatcher.java:543)
        at org.apache.felix.framework.Felix.fireServiceEvent(Felix.java:4260)
        at org.apache.felix.framework.Felix.registerService(Felix.java:3275)
        at org.apache.felix.framework.BundleContextImpl.registerService(BundleContextImpl.java:346)
        at org.apache.felix.framework.BundleContextImpl.registerService(BundleContextImpl.java:352)
        at com.elsten.osgi.Activator.start(Activator.java:28)
        at org.apache.felix.framework.util.SecureAction.startActivator(SecureAction.java:641)
        at org.apache.felix.framework.Felix.activateBundle(Felix.java:1977)
        at org.apache.felix.framework.Felix.startBundle(Felix.java:1895)
        at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:944)
        at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:931)
        at org.apache.felix.bundlerepository.impl.ResolverImpl.deploy(ResolverImpl.java:647)
        at com.elsten.bliss.updater.OnlineUpdater$2.run(OnlineUpdater.java:100)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:679) 
```

getPolicies 中的代码（**这是一个静态方法**）访问一个**静态最终**变量：

```
private static final MusicPolicy tagTypePolicy = new TagTypePolicy();
private static MusicPolicy[] policies;
private static MusicPolicy[] getPolicies(Version version) {

    if(policies==null) {
        final HttpClientConfiguration httpClientConfig = HttpClientConfigurations.userAgentAndAcceptGzip(version);
        policies = new MusicPolicy[] {
            tagTypePolicy
        };
    }
    return policies;
} 
```

我的猜测是这与类加载有关；更新后 MusicPolicy 或 TagTypePolicy 类不匹配。我有点困惑为什么会这样；鉴于这些是**私有**静态变量，尽管我的代码可以做它喜欢的事情。我认为，只有当静态数据导出到其他包时，才会出现问题。

# facebook - 如何在 wamp 中从 localhost 更改为 localhost.local？

> ID：11636990
> 
> 赞同：-1
> 
> 时间：2012-07-24T18:23:22.353
> 
> 标签：facebook, cakephp, wamp

我正在为我的一个使用 Facebook Connect 插件的应用程序使用 cakephp 2.1 和 WAMP。得到一个错误说

> 发生错误。请稍后再试

谷歌搜索并找到了这个

```
http://ardentdev.com/no-facebook-connect-cookies-for-localhost-development/ 
```

但不知道如何将设置从 localhost 设置为 localhost.local 以用于 WAMP 中的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T14:33:35.087

首先，您需要添加一个虚拟主机。为此，请编辑 WAMP 附带的 apache 配置文件。这是假设你在 OSX 上。

**/bin/apache/Apache2.2.17/conf/http.conf**

```
# add the following
<VirtualHost 127.0.0.1>
    DocumentRoot "/path/to/project" 
    ServerName mysite.local
    ServerAlias mysite.local
</VirtualHost> 
```

然后，编辑您的主机文件。打开终端，运行以下命令（使用你喜欢的任何编辑器，我选择 Vi）：

`$ sudo vi /private/etc/hosts`

并添加一个主机指向我们的新站点。

`127.0.0.1 mysite.local`

最后，重新启动 WAMP 服务器，您应该可以`mysite.local`在浏览器中访问，它将指向您的项目。

# c# - 获取程序 ApplicationExitCode 进行单元测试

> ID：11636994
> 
> 赞同：0
> 
> 时间：2012-07-24T18:24:01.060
> 
> 标签：c#, nunit

我想检查我正在测试的 C# 控制台程序的 ApplicationExitCode。下面是我的 NUnit 测试方法。我不确定用什么替换问号。

我的测试类方法：

```
[Test]
public void ExitApplicationWithZeroOnNoErrors()
{
  string[] arguments = { "--version=43" };
  var program = new Program(arguments);
  Assert.AreEqual(Utility.Status.Success, ?????);
} 
```

我的主要应用程序 Program.cs。

```
public class Program
{
    public int? Version { get; private set; }

    [STAThread]
    public static int Main(string[] arguments)
    {
        var program = new Program(arguments);
        return (int)Utility.Status.Success;
    }

    public Program(IEnumerable<string> arguments)
    {
        var parameters = new OptionSet()
                             {
                                 {"v|version=", "Client version number.", (int v) => Version = v},
                             };
        parameters.Parse(arguments);
    }
} 
```

顺便说一句，我正在使用 NDesk.Options 类来收集参数。我试图为这个项目编写单元测试并利用 TDD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:27:34.827

为了检查将返回给操作系统的退出代码，您应该检查从`Main`. 所以你必须运行`Main`：

```
var returnValue = Program.Main(arguments);
Assert.AreEqual(Utility.Status.Success, returnValue); 
```

# android - Android：如何使用 UriMatcher 切换多表、查询参数和活动？

> ID：11636997
> 
> 赞同：3
> 
> 时间：2012-07-24T18:24:15.410
> 
> 标签：android, uri, multiple-tables, android-contentresolver

我想阅读您对如何解决以下问题的想法。以下是我正在处理**的应用程序的基本要求。**

*   在地图上显示一个城市的多个位置。
*   支持**多个**城市。
*   在单独的详细信息视图中显示位置的属性。
*   每个城市的位置属性**不同**。

我想实现一个灵活的**决策逻辑**，**根据地图所在的位置在城市之间切换**。这意味着，我依赖的初始信息是地图中心。这是理论上的工作流程。

1.  从地图中获取当前中心位置。
2.  将位置翻译成城市**url**和**uri**。
3.  使用 url 通过 HTTP 下载位置。
4.  将位置存储在本地数据库中。由于位置属性不同，每个城市一张表。
5.  使用 uri 从内容解析器加载缓存或下载的数据。
6.  创建覆盖项目并包括**uri 引用**和**唯一的 id**。
7.  点击位置时打开详细信息视图。
8.  详细信息视图应呈现城市特定的位置属性。
9.  位置属性再次通过基于传递的 uri 和唯一 ID 的内容解析器加载。

**问题：**

1.  我对如何使用类切换城市、查询参数（例如**列名**`UriMatcher`）特别感兴趣。
2.  您会为每个城市准备**一个详细视图吗？**或者您是否看到任何基于可用属性信息**交换**文本字段、标签、.. 的实用解决方案？

* * *

为了说明不同的属性，这里有两个示例城市和一个内容提供商。

**例子：**

```
public class DatabaseParis {
    public static final class Contract {
        public static final String COLUMN_LATITUDE = "latitude";
        public static final String COLUMN_LONGITUDE = "longitude";
        public static final String COLUMN_NAME = "name";
    } 
```

而另一个城市...

```
public class DatabaseDenver {
    public static final class Contract {
        public static final String COLUMN_LATITUDE = "lat";
        public static final String COLUMN_LONGITUDE = "lon";
        public static final String COLUMN_HEIGHT = "height";
        public static final String COLUMN_DIAMETER = "diameter";
    } 
```

和内容提供商...

```
public class CustomContentProvider extends ContentProvider {
    public static final class Contract {
        public static final Uri URI_PARIS = Uri.parse("content://" + AUTHORITY + "/cities/paris");
    }

    private static final String AUTHORITY = "com.example.cities.locations";
    private static final int URI_CODE_PARIS = 0;
    private static final UriMatcher URI_MATCHER = new UriMatcher(UriMatcher.NO_MATCH);

    static {
        URI_MATCHER.addURI(AUTHORITY, "cities/paris", URI_CODE_PARIS);
    } 
```

我不确定使用**一个**或**多个内容提供程序**，因为我读过将所有数据库引用放在一个中可能会在将来同步数据时出现问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T20:59:12.233

我想处理这种情况的人应该使用以下信息源。

*   [开发 Android REST 客户端应用程序，Virgil Dobjanschi，Google I/O 旧金山，2010](http://www.google.com/events/io/2010/sessions/developing-RESTful-android-apps.html)
*   [ContentProvider 和 REST API，Benjamin Brombach，Android 用户组柏林，2012](https://docs.google.com/file/d/0B4rncoVb9uFGaUlpUnlLSzdoZ1U/edit?pli=1)

# ruby-on-rails - 是否有人为自己的路由网格提供反向代理作为后端返回 Heroku？

> ID：11636998
> 
> 赞同：1
> 
> 时间：2012-07-24T18:24:18.340
> 
> 标签：ruby-on-rails, heroku, nginx, reverse-proxy, unicorn

我有兴趣拥有 Heroku 后端，即应用程序服务器、数据库服务器、工作程序、附加组件等。

不过，我想提供自己的路由网格，并为 Rails 应用程序提供 Nginx 和独角兽服务器的反向代理。

在我试一试之前，这是否可能。我会假设我可以在上游指令中提供我的应用程序 Heroku 域？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-09T11:44:20.607

Heroku 没有提供在他们的反向代理中配置它的方法，但是您可以运行自己的方法，例如使用[nginx-buildpack](https://github.com/ryandotsmith/nginx-buildpack)（另请参阅[此答案](https://stackoverflow.com/a/27788633/2866660)）。