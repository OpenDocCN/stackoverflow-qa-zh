# StackOverflow 问答 11514000-11514999

# actionscript-3 - Actionscript 3：文本字段变量

> ID：11514002
> 
> 赞同：0
> 
> 时间：2012-07-16T23:21:28.603
> 
> 标签：actionscript-3, variables, text, textfield

我的项目有点麻烦。我有一个文本字段，我给出了金钱的实例名称。对于编码，我有这个：

```
var money:int = 10;
money.text = "$" + money; 
```

我希望变量`money`是`10`. 对于文本输出，我希望它显示`$10`. 这虽然行不​​通。我不断收到错误：

```
1151: A con flict exists with definition money in namespace internal.
Source: var money:int = 10; 
```

你能帮我弄清楚我做错了什么吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:26:38.930

你有一个变量和一个同名的文本字段..更改文本字段的名称。

# php - 自定义 bbCode 网址

> ID：11514006
> 
> 赞同：0
> 
> 时间：2012-07-16T23:21:46.517
> 
> 标签：php, html, bbcode

我做了一个 bbCode 替换器，但我被链接卡住了。

```
$replacements[3] = '<a href="\1">\2</a>'; 
```

它立即替换，但 URL 错误... mydomain.com http:\\somelink.com\
这个有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:30:02.230

你实际上并没有显示正则表达式来匹配它..但它应该是这样的：

**寻找**

```
"'\[url=(.*?)\](.*?)\[/url\]'i" 
```

**代替**

```
"<a href=\"\\1\">\\2</a>" 
```

**例子**

```
preg_replace("'\[url=(.*?)\](.*?)\[/url\]'i", 
             "<a href=\"\\1\">\\2</a>", 
             "[url=www.google.com]Google![/url]"
             ); 
```

**输出**

```
<a href="www.google.com">Google!</a> 
```

**注意** 我故意不验证正则表达式中的 URL，因为它很丑而且没有必要。使用验证它`filter_var(..., FILTER_VALIDATE_EMAIL);`

# cocos2d-iphone - 用另一个类的方法调用CCAction（CCTintTo）来改变另一个类的CCSprite

> ID：11514007
> 
> 赞同：0
> 
> 时间：2012-07-16T23:21:54.420
> 
> 标签：cocos2d-iphone, ccsprite, ccaction

我有一个类 ButtonLayer，其中有一个名为 redClick 的方法。redClick 的实现看起来像这样..

```
-(void) redClick {
    [red runAction: [CCTintTo actionWithDuration:0.1 red:200 green:200 blue:200]];
} 
```

变量 red 是 ButtonLayer 类中的 CCSprite。

我有另一个名为 MainLayer 的类，它继承自 CCLayer。这个类中的场景方法是这样的..

```
+(CCScene *) scene
{
    CCScene *scene = [CCScene node];

    overlay = [ButtonLayer node];
    HelloWorldLayer *layer = [HelloWorldLayer node];

    [scene addChild: layer];
    [scene addChild: overlay];

    return scene;
} 
```

在 MainLayer 的 ccTouchesBegan 方法中，我调用了 [overlay redClick]，但是当我调用它时，没有任何变化。CCSprite 保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T05:56:16.317

将覆盖层添加到您的 HelloWorldLayer '层'。

```
+(CCScene *) scene
{
    CCScene *scene = [CCScene node];

    overlay = [ButtonLayer node];
    HelloWorldLayer *layer = [HelloWorldLayer node];

    [scene addChild: layer];
    [layer addChild: overlay];

    return scene;
} 
```

# macos - 通过 EPPC 向远程机器显示对话框

> ID：11514009
> 
> 赞同：0
> 
> 时间：2012-07-16T23:22:20.350
> 
> 标签：macos, applescript

如何通过 EPPC 将显示对话框发送到远程机器？我相信发行说明中的​​ Scripting Addition Security 讨论了这个问题，但我还没有能够解决它。[发行说明](https://developer.apple.com/library/mac/#releasenotes/AppleScript/RN-AppleScript/RN-10_6/RN-10_6.html)

**尝试 1**

```
using terms from application "Finder"
    set remoteFinder to application "Finder" of machine "eppc://user:password@host"
    tell remoteFinder to display dialog "Hi!" buttons {"A", "B"}
end using terms from 
```

![在此处输入图像描述](../Images/337b32024c7d29df6aea2a38bf17745d.png)

**尝试 2** 应用程序“dispD.app”保存在远程机器上，应该接受 yourMessage 参数。

```
on run {yourMessage}
    display dialog yourMessage buttons {"A", "B"}
end run 
```

我从本地计算机运行此脚本：

```
using terms from application "Finder"
    set remoteFinder to application "Finder" of machine "eppc://user:password@host"
    tell remoteFinder to run script file "path:to:my:dispD.app" with parameters {"Hi!"}
end using terms from 
```

![在此处输入图像描述](../Images/02fedc698eb4e76c3e52b9ef6829b32f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:01:06.243

我认为您想要做的事情可能无法直接完成，尽管很难找到这方面的文档，我不能 100% 确定。MacScripter（例如[这个](http://macscripter.net/viewtopic.php?id=30654)）和 Apple 论坛上的各种主题表明通过 EPPC 与 OSAXen（“脚本添加”）交谈时存在各种问题。（线程有点混乱，因为它们都分散成红色鲱鱼，但我认为其中一些有相关信息。）“显示对话框”命令不是 Finder（或系统事件）的一部分，它是标准添加 OSAX。

这实际上很难从 AppleScript 中测试，因为 OSAX 添加是自动引入的。但是从 appscript，您可以手动将 OSAX 附加到这样的应用程序：

```
sa = osax.ScriptingAddition('StandardAdditions', name='Finder')
sa.display_dialog('hi') 
```

正如预期的那样，这有效。虽然这给出了“未知的属性、元素或命令”：

```
f = app(name='Finder')
f.display_dialog('hi') 
```

现在，如果我执行一个实际的 Finder 命令，如下所示：

```
f.windows() 
```

一切正常。如果我想远程处理：

```
rf = app(url='eppc://test:test@localhost/Finder')
rf.windows() 
```

没问题。但现在：

```
sa = osax.ScriptingAddition('StandardAdditions', url='eppc://test:test@localhost/Finder')
sa.display_dialog('hi') 
```

这适用于 10.5，但不适用于 10.6、10.7 或 10.8。（嗯，在我可以访问的 8 台机器中，它可以在运行 10.5 的机器上运行，但不能在运行 10.6+ 的 7 台机器上运行）。

所以，我认为这是你的问题。

至于解决方案，我可以想到一些解决方法：

*   不要使用远程脚本，而是使用 ssh + 本地 osascript。
*   使用[cocoadialog](http://mstratman.github.com/cocoadialog/)、 pashua 等，并使用 驱动它们`do shell script`，而不是使用`display dialog`. （这将要求您在远程目标机器上拥有相应的工具，而不是在本地机器上。）
*   远程脚本一些可以本地显示对话框的应用程序，而不是依赖于 StandardAdditions。（我不知道任何股票应用程序是否有任何方法可以做到这一点，所以这可能需要在远程机器上安装一些东西，在这种情况下你不妨只使用 cocoadialog。）

# hbase - HBase 中的 Memstore 如何更新记录？

> ID：11514010
> 
> 赞同：0
> 
> 时间：2012-07-16T23:22:22.777
> 
> 标签：hbase

HBase 是否在其 Memstore 中执行就地更新。假设如果同一个rowkey有多个版本的值，HBase memstore会删除旧值并用新值替换它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:48:08.643

不，它不会删除和替换现有记录。它将新的键值（记录数据）附加到 memstore。第一个原因：它可能被配置为保留多个版本的单元格（列）值。但是，即使 memstore 中的单元格版本多于配置保留的单元格版本，它仍会追加记录而不是覆盖它（或删除最旧的）。

但是，请注意，在较新的 HBase 版本（0.92+）中，对 memstore 刷新过程进行了优化：它可能会跳过（不要写入 HFiles）那些太旧的单元格版本（即不应该包含在要保留的最大版本数）。更多信息在这里：[HBASE-4241](https://issues.apache.org/jira/browse/HBASE-4241)。尽管它看起来像是“覆盖”了 Memstore 中的现有值（至少从外部角度来看），但它并没有完全做到这一点。这种优化只发生在 memstore 刷新时，因此不会影响 memstore 大小：当写入新值时，它们总是附加。即这种优化不会导致刷新发生得更少。

这里正在进行与优化相关的工作，因此请注意下一个版本。

[是的，正如 Richard 所提到的，您可以在此处](http://blog.sematext.com/2012/07/16/hbase-memstore-what-you-should-know/)了解有关配置 HBase Memstore的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-22T17:22:44.723

memstore 像 HFile 一样保存更新，但它只会根据表的配置写入磁盘（例如，如果您将表设置为仅保存一行的一个版本，则只有最新的版本才会写入磁盘）。

这里有一个很好的解释 memstore 是如何工作[的](http://blog.sematext.com/2012/07/16/hbase-memstore-what-you-should-know/)

# c# - ASP.NET MVC3 和 Unity - 将 Unity 实现与表示层分离？

> ID：11514014
> 
> 赞同：0
> 
> 时间：2012-07-16T23:23:25.437
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, dependency-injection, unity-container

您好，提前感谢您的帮助。

我有一个关于如何在我的 MVC3 应用程序中构建 Unity 的问题。

目前我已经从这个有用的示例代码中对我的 Unity 实现进行了建模：

[http://kevww.wordpress.com/2012/01/04/dependency-injection-with-unity-2-0-in-mvc-3/](http://kevww.wordpress.com/2012/01/04/dependency-injection-with-unity-2-0-in-mvc-3/)

我可以让它正常工作，但我问自己是否有稍微不同的方法。本质上，该解决方案需要两个类，第一个是依赖解析器。

```
public class UnityDependencyResolver : IDependencyResolver
{
IUnityContainer _container;

public UnityDependencyResolver(IUnityContainer container)
{
_container = container;
}

public object GetService(Type serviceType)
{
object instance;
try
{
instance = _container.Resolve(serviceType);
if (serviceType.IsAbstract || serviceType.IsInterface)
{
return null;
}
return instance;
}
catch (Exception e)
{
return null;
}
}

public IEnumerable<object> GetServices(Type serviceType)
{
return _container.ResolveAll(serviceType);
}
} 
```

还有一个 Unity 容器设置类，其设置来自 Global.asax：

```
public class UnityContainerSetup
{
public static void SetUp()
{
var container = new UnityContainer();
container.RegisterType<ISomeService, SomeService>();
DependencyResolver.SetResolver(new UnityDependencyResolver(container));
}
} 
```

好的，所以我的问题。有没有更好的方法来实际解耦这个 Unity 实现？

我创建了一个单独的项目并将上面的两个类放在其中。在我`System.Web.Mvc`在那个新项目中引用来解决`IDependencyResolver`.

但是，如果我想重用一个通用程序集来使用来自其他东西的 Unity，例如使用相同存储库和 DAL 的 Web 窗体应用程序，这似乎也没有多大意义。

或者，这只是让 Unity 工作所需的管道吗？即，如果我在我的各种项目中更改了我的 Unity 实现，我将不得不依次访问每个项目？或者我的方法是否适合中间妥协？

对我来说，明显的问题是它`IDependencyResolver`是 MVC 的一部分。所以我不确定如何为 MVC 完成统一的“通用”组装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T04:04:02.077

您将始终需要容器设置，但您可以创建一个 ControllerFactory 并将其注册到 MVC，而不是直接使用 DependencyResolver。有关Unity 的示例，请参见[此处。](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvcdependencyinjection_topic2.aspx)

这允许您将所有依赖项和分辨率保留在 Controller 中，并且您传递给表示层的任何内容都应该是平面模型或简单的视图数据。

# javascript - 谷歌图表：轴 #0 的数据列不能是字符串类型

> ID：11514015
> 
> 赞同：3
> 
> 时间：2012-07-16T23:23:27.593
> 
> 标签：javascript, ruby-on-rails, cross-browser, google-visualization

我在网页上显示的 Google Chart 遇到了一个非常奇怪的问题。当我在我的 Mac 上本地运行代码时，一切正常，并且图表显示没有错误。

但是，当我在我正在测试的 AWS 服务器上运行相同的应用程序时，我收到以下错误消息并且没有图表：

```
Data column(s) for axis #0 cannot be of type string 
```

该应用程序是用 ruby​​-on-rails 编写的，相关代码粘贴在下面：

**（在页面的控制器中）**

```
relevantEntries = getDataFromDB
@graphData = Array.new
@graphData << ["Date", "Value"]
relevantEntries.each do |entry|
  @graphData << [entry.created.strftime(format="%-m/%-d"), entry.value]
end 
```

**（在页面视图中）**

```
 google.load('visualization', '1.0', {'packages':['corechart']});
  google.setOnLoadCallback(ChartMaker);

  function ChartMaker(chartDiv) {
    // Create the data table.
    var data = google.visualization.arrayToDataTable(<%= @graphData.to_json.html_safe %>);
    // Set chart options
    var options = {/* some options */};
    // Instantiate and draw chart, passing in the options.
    var chart = new google.visualization.LineChart(document.getElementById(chartDiv));
    chart.draw(data, options);
  }

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:46:39.317

没关系-我解决了。问题是我几天前已经擦除了生产数据库，所以当我去获取绘图数据时，它不会获取任何东西。这导致了错误，因为数组只会看起来像：

```
["Date", "Value"] 
```

因此出现字符串错误。

对不起！

# php - json解码$_POST参数php

> ID：11514024
> 
> 赞同：0
> 
> 时间：2012-07-16T23:24:32.187
> 
> 标签：php, json

我尝试用`json_decode()`函数解码一个字符串。

```
$in = $_POST['json'];
$jsonIn = json_decode($in); 
```

例如

```
$in = '{"company":"q","address":"q","phone":"q","mobile":"q","email":"q"}'; 
```

如果我尝试强制使用原始字符串，它工作正常，但如果我使用 $in 代替，它不会

例如，如果我尝试访问，则证明它确实/没有

```
$jsonIn->company 
```

在第一种情况下它返回我`null`，在第二种情况下它返回我`"q"`。

任何人都可以解释？在此先感谢达里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:13:50.170

禁用后问题已解决`Magic Quotes`。

# visual-studio-2010 - 错误 LNK2038：检测到“_ITERATOR_DEBUG_LEVEL”不匹配

> ID：11514026
> 
> 赞同：3
> 
> 时间：2012-07-16T23:24:42.940
> 
> 标签：visual-studio-2010, compilation

我尝试让一个 VS2008 项目在 VS2010 中编译，但我不断收到错误消息：

```
foo.obj : error LNK2038: mismatch detected for '_ITERATOR_DEBUG_LEVEL': value '2' doesn't match value '0' in barr.obj 
```

我只在使用[libsquish 库时遇到此错误。](http://code.google.com/p/libsquish/)它包含在项目中。它似乎不会在调试模式下编译，我不明白为什么。

PS：在这里问之前，我已经在google上浏览了几个相关主题

# java - 如何在 Java 中修改 X-Forwarded-For 标头？

> ID：11514027
> 
> 赞同：1
> 
> 时间：2012-07-16T23:24:57.887
> 
> 标签：java

我正在使用`URLConnection`连接到一个站点。我曾经`System.getProperties()`设置`proxyHost`and`proxyPort`和`connection.setRequestProperty`更改用户代理。我还没有看到改变 X-Forwarded-For 的方法。

有人可以启发我吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:37:43.833

试试下面的：

```
 connection.addRequestProperty("X-Forwarded-For",VALUE-IP); 
```

参考： [http](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLConnection.html#addRequestProperty(java.lang.String) ://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLConnection.html#addRequestProperty (java.lang.String , java.lang.String)

# c++ - 在 C++.net 中从串口快速读取常量数据流

> ID：11514030
> 
> 赞同：3
> 
> 时间：2012-07-16T23:25:04.523
> 
> 标签：c++, .net, serial-port

我正在尝试建立一个以 10-20 kHz 的速率传输 16 位数据包的 SerialPort 连接。我在 C++/CLI 中对此进行编程。发送方在收到字母“s”后就进入一个无限循环，并不断发送 2 个字节的数据。

发送方不太可能出现问题，因为更简单的方法可以完美运行但速度太慢（在这种方法中，接收方总是先发送一个“a”，然后得到 1 个包含 2 个字节的包。它会导致速度约 500Hz）。这是这种有效但缓慢的方法的重要部分：

```
public: SerialPort^ port;

in main:
Parity p = (Parity)Enum::Parse(Parity::typeid, "None");
StopBits s = (StopBits)Enum::Parse(StopBits::typeid, "1");
port = gcnew SerialPort("COM16",384000,p,8,s);
port->Open();

and then doing as often as wanted:
port->Write("a");
int i = port->ReadByte();
int j = port->ReadByte(); 
```

这是我现在使用的实际方法：

```
static int values[1000000];
static int counter = 0;

void reader(void)
    {
        SerialPort^ port;
        Parity p = (Parity)Enum::Parse(Parity::typeid, "None");
        StopBits s = (StopBits)Enum::Parse(StopBits::typeid, "1");
        port = gcnew SerialPort("COM16",384000,p,8,s);
        port->Open();
        unsigned int i = 0;
        unsigned int j = 0;
        port->Write("s"); //with this command, the sender starts to send constantly
        while(true)
        {
            i = port->ReadByte();
            j = port->ReadByte();
            values[counter] = j + (i*256);
            counter++;
        }
    }

in main:
Thread^ readThread = gcnew Thread(gcnew ThreadStart(reader));
readThread->Start(); 
```

计数器以 18472 包/秒的速度快速增加（更多），但值在某种程度上是错误的。这是一个示例：该值应如下所示，最后 4 位随机变化（它是模数转换器的信号）：

```
111111001100111 
```

以下是代码中给出的线程解决方案的一些值：

```
1110011001100111 
1110011000100111 
1110011000100111 
1110011000100111 
```

所以看起来连接读取了包中间的数据（准确地说：3位太迟了）。我能做些什么？我想避免在读取这样的包时稍后在代码中修复此错误的解决方案，因为我不知道稍后编辑读取代码时移位错误是否会变得更糟，我很可能会这样做。

提前致谢，

尼古拉斯

PS：如果这有帮助，这里是发送方的代码（一个 AtMega168），用 C 语言编写。

```
uint8_t activate = 0;

void uart_puti16(uint16_t val) //function that writes the data to serial port
{

    while ( !( UCSR0A & (1<<UDRE0)) ) //wait until serial port is ready
            nop(); // wait 1 cycle
            UDR0 = val >> 8; //write first byte to sending register
    while ( !( UCSR0A & (1<<UDRE0)) ) //wait until serial port is ready
            nop(); // wait 1 cycle
            UDR0 = val & 0xFF; //write second byte to sending register
}

in main:
while(1)
{
        if(active == 1)
        {   
            uart_puti16(read()); //read is the function that gives a 16bit data set
        }               
}

ISR(USART_RX_vect) //interrupt-handler for a recieved byte
{
        if(UDR0 == 'a') //if only 1 single data package is requested
        {
            uart_puti16(read());
        }
        if(UDR0 == 's') //for activating constant sending
        {
            active = 1;
        }
        if(UDR0 == 'e') //for deactivating constant sending
        {
            active = 0;
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:44:19.627

在给定的 384,000 比特率下，您应该每秒获得 38,400 个字节的数据（8 位真实数据加上 2 个帧位），或每秒 19,200 个双字节值。

`counter`在这两种情况下增长的速度有多快？我希望任何现代计算机都能跟上这个速度，无论是使用事件还是直接轮询。

你没有展示你说的更简单的方法。我建议你把那个贴出来。

另外，在该行设置断点

```
values[counter] = j + (i*256); 
```

在那里，检查`i`和`j`。共享您在循环的第一次迭代中看到的这些变量的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:45:53.387

这是完全基于阅读[http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx#Y228](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx#Y228)上的代码的猜测。有了这个警告，这是我的猜测：

当数据可供读取时，您的事件处理程序将被调用——但您只消耗*了两个字节*的可用数据。您的事件处理程序只能每 1024 个字节调用一次。或类似的东西。您可能需要使用事件处理程序中的*所有*可用数据才能使程序按预期继续。

尝试重新编写您的处理程序以包含一个循环，该循环读取直到没有更多数据可供使用。

# android - HttpHostConnectException：连接被拒绝 Android

> ID：11514038
> 
> 赞同：6
> 
> 时间：2012-07-16T23:25:48.937
> 
> 标签：android, json, https, http-post

我正在尝试通过 HttpPost 连接并将用户名和密码发送到网站，然后从该网站接收字符串。我尝试过过去对我有用的各种方法，但现在当我发送用户名和密码标识符时，应用程序超时长达 4 分钟，然后吐出以下异常：

```
 07-16 16:32:32.897: W/System.err(632): Unable to connect to the server
    07-16 16:32:32.907: W/System.err(632): org.apache.http.conn.HttpHostConnectException: Connection to http://devdashboard.company refused
    07-16 16:32:32.917: W/System.err(632):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:183)
    07-16 16:32:32.917: W/System.err(632):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
    07-16 16:32:32.917: W/System.err(632):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
    07-16 16:32:32.917: W/System.err(632):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
    07-16 16:32:32.917: W/System.err(632):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
    07-16 16:32:32.917: W/System.err(632):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
    07-16 16:32:32.927: W/System.err(632):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
    07-16 16:32:32.927: W/System.err(632):  at company.android.dashboard.app.HttpHelperAndroid.sendToHttp(HttpHelperAndroid.java:66)
    07-16 16:32:32.927: W/System.err(632):  at company.android.dashboard.app.DashboardAppActivity.goToDashboard(DashboardAppActivity.java:62)
    07-16 16:32:32.927: W/System.err(632):  at java.lang.reflect.Method.invokeNative(Native Method)
    07-16 16:32:32.937: W/System.err(632):  at java.lang.reflect.Method.invoke(Method.java:511)
    07-16 16:32:32.937: W/System.err(632):  at android.view.View$1.onClick(View.java:3039)
    07-16 16:32:32.947: W/System.err(632):  at android.view.View.performClick(View.java:3511)
    07-16 16:32:32.947: W/System.err(632):  at android.view.View$PerformClick.run(View.java:14105)
    07-16 16:32:32.947: W/System.err(632):  at android.os.Handler.handleCallback(Handler.java:605)
    07-16 16:32:32.957: W/System.err(632):  at android.os.Handler.dispatchMessage(Handler.java:92)
    07-16 16:32:32.957: W/System.err(632):  at android.os.Looper.loop(Looper.java:137)
    07-16 16:32:32.967: W/System.err(632):  at android.app.ActivityThread.main(ActivityThread.java:4424)
    07-16 16:32:32.977: W/System.err(632):  at java.lang.reflect.Method.invokeNative(Native Method)
    07-16 16:32:32.977: W/System.err(632):  at java.lang.reflect.Method.invoke(Method.java:511)
    07-16 16:32:32.977: W/System.err(632):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    07-16 16:32:32.987: W/System.err(632):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    07-16 16:32:32.987: W/System.err(632):  at dalvik.system.NativeStart.main(Native Method)
    07-16 16:32:32.987: W/System.err(632): Caused by: java.net.ConnectException: failed to connect to /50.19.240.232 (port 80): connect failed: ETIMEDOUT (Connection timed out)
    07-16 16:32:32.997: W/System.err(632):  at libcore.io.IoBridge.connect(IoBridge.java:114)
    07-16 16:32:32.997: W/System.err(632):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
    07-16 16:32:32.997: W/System.err(632):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
    07-16 16:32:33.007: W/System.err(632):  at java.net.Socket.connect(Socket.java:842)
    07-16 16:32:33.007: W/System.err(632):  at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
    07-16 16:32:33.017: W/System.err(632):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:144)
    07-16 16:32:33.017: W/System.err(632):  ... 22 more
    07-16 16:32:33.027: W/System.err(632): Caused by: libcore.io.ErrnoException: connect failed: ETIMEDOUT (Connection timed out)
    07-16 16:32:33.047: W/System.err(632):  at libcore.io.Posix.connect(Native Method)
    07-16 16:32:33.047: W/System.err(632):  at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:85)
    07-16 16:32:33.047: W/System.err(632):  at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
    07-16 16:32:33.057: W/System.err(632):  at libcore.io.IoBridge.connect(IoBridge.java:112)
    07-1
    6 16:32:33.057: W/System.err(632):  ... 27 more 
```

我的 XML 清单文件中启用了 Internet 权限

我目前的实现是这样的：

```
 String LOGIN = "email@gmail.com";
        String PASSWORD ="password1";

        //JSONObject to send the username and pw
        JSONObject json = new JSONObject();
        //put the path in the JSONArray object

        JSONArray vect = new JSONArray();
        vect.put("company Android Library");
        vect.put("Rocket Ship");

        int duration = 50;
        try {
            json.put("email", LOGIN);
            json.put("password", PASSWORD);
            json.put("json", "true");

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        Log.d(TAG, "ABOUT TO SEND:" + json.toString());

        JSONObject inJson = HttpHelperAndroid.sendToHttp(json, "http://devdashboard.company/login");

        if(inJson != null)
        {
            Log.d(TAG, "RECIEVED the JSON:" + inJson.toString());
        }
        else
            Log.d(TAG, "THE RESPONSE WAS NULL");
    } 
```

HttpHelperAndroid 类看起来像这样：

```
 public class HttpHelperAndroid
    {
        private static final String TAG = "HttpHelperAndroid";//TAG for the LogCat(debugging)

    private static boolean responseSuccessful = true;

    /**
     * sends the JSONObject parameter to the desired URL parameter and gets the response
     * 
     * @param url the URL to which the JSONObject should be sent
     * @param jsonObjOut the JSONObject that is to be sent
     * @return the response from the server as a JSONObject
     */
    public static JSONObject sendToHttp(JSONObject jsonObjOut, String url) {
        responseSuccessful = true;
        try
        {
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpRequest = new HttpPost(url);

            //convert the JSONObject to a string
            StringEntity se;

            //set our StringEntity to the JSONObject as a string
            se = new StringEntity(jsonObjOut.toString());

            // Set HTTP params
            httpRequest.setEntity(se);
            httpRequest.setHeader("Accept", "application/json");
            httpRequest.setHeader("Content-type", "application/json");
            httpRequest.setHeader("Accept-Encoding", "gzip"); //for gzip compression

            //get the current time
            long oldTime = System.currentTimeMillis();

            HttpResponse response = null;
            try
            {
                //execute the http request and get the response
                response = (HttpResponse) httpClient.execute(httpRequest);
            }
            catch(HttpHostConnectException e)
            {
                System.err.println("Unable to connect to the server");
                e.printStackTrace();
                responseSuccessful = false;
            }

            //only continue executing if we got a response from the server
            if(responseSuccessful)
            {
                //print how long the response took to the LogCat if it's on

                    Log.i(TAG, "HTTPResponse received in [" + (System.currentTimeMillis()-oldTime) + "ms]");

                // Get hold of the response entity (-> the data):
                HttpEntity entity = response.getEntity();

                if (entity != null) {
                    // Read the content stream
                    InputStream in = entity.getContent();
                    Header contentEncoding = response.getFirstHeader("Content-Encoding");
                    if (contentEncoding != null && contentEncoding.getValue().equalsIgnoreCase("gzip")) {
                        in = new GZIPInputStream(in);
                    }

                    // convert content stream to a String
                    String resultString= streamToString(in);

                    //close the stream
                    in.close();

                    // convert the String into a JSONObject
                    JSONObject jsonObjRecv = new JSONObject(resultString);

                    //take a peak at the JSONObject we got back if the LogCat is on

                        Log.i(TAG,"<JSONObject>\n"+jsonObjRecv.toString()+"\n</JSONObject>");

                    //return the JSONObject we got back from the server
                    return jsonObjRecv;
                } 
            }
        }
        //catch any exception that was thrown
        catch (Exception e)
        {
            //Print the exception
            e.printStackTrace();
        }

        return null;
    }

    private static String streamToString(InputStream is)
    {
        //create a new BufferedReader for the input stream
        BufferedReader reader = new BufferedReader(new InputStreamReader(is));

        //create a new StringBuilder to append the lines
        StringBuilder sb = new StringBuilder();

        //initialize an empty string
        String line = null;

        try
        {
            //iterate as long as there is still lines to be read
            while ((line = reader.readLine()) != null) 
            {
                //append the line and a newline character to our StringBuilder
                sb.append(line + "\n");
            }
        }
        //catch an IOException and print it
        catch (IOException e) {
            e.printStackTrace();
        } 
        //close the stream when we're done
        finally 
        {
            try 
            {
                is.close();
            } 
            //catch and print an exception if it's thrown
            catch (IOException e) 
            {
                e.printStackTrace();
            }
        }
        //return the stream converted to a string
        return sb.toString();
    }
} 
```

这是我的 XML，仅供参考：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="company.android.dashboard.app"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.INTERNET" />

    <uses-sdk android:minSdkVersion="7" />

    <application
        android:icon="@drawable/company_android_ico"
        android:label="@string/app_name" >
        <activity
            android:name=".DashboardAppActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我在过去的项目中使用了 HttpHelper 类，它对我有用，此外我尝试使用 nameValuePairs 来实现它：

```
List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);  
        nameValuePairs.add(new BasicNameValuePair("email", "email@gmail.com"));  
        nameValuePairs.add(new BasicNameValuePair("password", "password1"));
        nameValuePairs.add(new BasicNameValuePair("json", "true"));  
        try {
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs)); 
```

这产生了相同的结果。

这会以某种方式成为证书吗？或者可能与损坏的 XML 文件有关（我尝试重新制作项目和 xml 文件）[Android HTTP 连接被拒绝](https://stackoverflow.com/q/9469060/1437824) 或者可能是某种 Android 主机文件问题？

我愿意接受任何建议！

我已经从很多角度对此进行了检查，我很乐意提供任何其他有用的信息！我真的很感谢你的时间！

**注意：**出于安全原因，该网址是一个虚拟网址，而不是我要连接的实际网址。我可以使用参数从命令行卷曲实际网站，它可以正常工作，我也可以从网络浏览器正常登录。

**编辑**我已经确定了问题！但不幸的是，这不是解决方案。所以问题是我使用的开发服务器 url 在全局 DNS 服务器上没有域条目。所以要解决这个问题，我需要以某种方式在我的 Android 设备/模拟器中编辑主机文件......有谁知道如何合法地做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T18:00:52.103

我已经确定了问题！所以问题是我使用的开发服务器 url 在全局 DNS 服务器上没有域条目。

所以这个问题有两种可能的解决方案：

1）在Android设备上编辑hosts文件（需要root手机）：[如何在android上更改hosts文件](https://stackoverflow.com/q/7794659/1437824)

2) 获取在全球 DNS 服务器上注册的服务器。（如果您不对网址负责，也很难做到）

无论如何，我希望这对其他人也有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-10T09:34:42.460

请遵循这些解决方案，这些解决方案可能会解决您的问题。

1>在那里检查您的清单文件互联网权限。

2> 通过休息客户端使用浏览器检查您的网址并传递适当的请求。

3> 在手机中打开网址，例如：- **[http://您的](http://your)IP 地址/端口**，仅用于检查您是否有权在手机中打开此网址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T23:34:13.153

有几种可能

1）网址不正确“http://devdashboard.company/login”不正确。至少在浏览器中检查。ping 主机也是如此。

2) 这应该是一个 https 连接。

3) 需要一些认证。

4）您缺少端口号。或域未正确设置。也许端口 80 默认不正确？

5) 来电不应该是帖子。

一般来说，您要么对服务器负责，要么不负责。看来这是其他人的责任，你应该问他们正确的 url 和参数是什么。所以它可能没有错，但你需要向他们询问连接以验证。

您可以做的另一件事是尝试查看 url 在成功连接的应用程序中的样子。看看这个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-13T14:45:58.847

问题在于wifi睡眠。请用

```
WifiManager wm = (WifiManager) getSystemService(Context.WIFI_SERVICE);
wifiLock = wm.createWifiLock(WifiManager.WIFI_MODE_FULL , "MyWifiLock");
wifiLock.acquire(); 
```

和许可：

```
uses-permission android:name="android.permission.WAKE_LOCK"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-13T19:05:14.410

这篇文章很旧，但它是谷歌搜索此错误时的第一个结果。我遇到了同样的异常，我的代码中的一切都是完全正确的。我在我的 AndroidManifest.xml 中注释掉包含 INTERNET 权限的行，运行应用程序，单击/点击我的按钮以发送 HTTP 请求并获取异常，关闭应用程序，返回清单，取消注释权限行，运行再次应用程序，异常已解决！

2015 年的这种错误（以及“高级”工具，如最新的 Android API 21 编译工具和 Intellij IDEA 14）让我抓狂！你快到最后期限了，这种错误会完全打乱你的工作！

# c# - Windows Phone 7 ListPicker InvalidCastException

> ID：11514045
> 
> 赞同：2
> 
> 时间：2012-07-16T23:26:38.597
> 
> 标签：c#, silverlight, windows-phone-7, data-binding

我在 WP7 中构建简单的 crud 表单时遇到问题。我花了很多时间将枚举显示到列表选择器中，现在我在尝试绑定到 (IsolatedStorage) 对象时看到了 InvalidCastException。

```
public class Bath {
   public string Colour { get; set; }
   public WaterType WaterType { get; set; }
}

public enum WaterType {
   Hot,
   Cold
} 
```

枚举绑定到 ListPicker，但由于 WP7 中没有 enum.GetValues()，这不是一项简单的任务。

我有一个简单的类型类...

```
public class TypeList
    {
        public string Name { get; set; }
    } 
```

在我的视图模型中，我有 ObservableCollection 并模拟枚举中的值......

```
 private ObservableCollection<TypeList> _WaterTypeList;
    public ObservableCollection<TypeList> WaterTypeList
    {
        get { return _WaterTypeList; }
        set
        {
            _WaterTypeList= value;
            NotifyPropertyChanged("WaterTypeList");
        }
    }

    public void LoadCollectionsFromDatabase()
    {
        ObservableCollection<TypeList> wTypeList = new ObservableCollection<WaterTypeList>();
        wTypeList.Add(new TypeList{ Name = WaterType.Hot.ToString() });
        wTypeList.Add(new TypeList{ Name = WaterType.Income.ToString() });
        WaterTypeList = new ObservableCollection<TypeList>(wTypeList);
    } 
```

最后，我的 xaml 包含列表框...

```
<toolkit:ListPicker
            x:Name="BathTypeListPicker"
            ItemsSource="{Binding WaterTypeList}"
            DisplayMemberPath="Name">
        </toolkit:ListPicker> 
```

我不确定以上是否是最佳实践，以及以上是否是问题的一部分，但以上确实给了我一个填充的 ListPicker。

最后，当提交表单时，强制转换会导致 InvalidCastException。

```
 private void SaveAppBarButton_Click(object sender, EventArgs e)
{
    var xyz = WaterTypeList.SelectedItem; // type AppName.Model.typeList

        Bath b = new Bath
        {
            Colour = ColourTextBox.Text ?? "Black",
            WaterType = (WaterType)WaterTypeListPicker.SelectedItem
        };

        App.ViewModel.EditBath(b);
        NavigationService.Navigate(new Uri("/Somewhere.xaml", UriKind.Relative));
    }
} 
```

有没有人遇到过类似的问题，可以提供建议。我看到我的选择是专注于从 ListPicker 中投射一些有意义的东西，还是我应该重新考虑 ListPicker 的填充方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T03:08:43.563

据我所见， WaterTypeList 是一个 ObservableCollection ，它是一种类型，并且可观察集合没有 SelectedItem 属性。

您的 Bath 类有一个接受 WaterType 属性的 WaterType，并且您正在尝试将 WaterTypeListPicker.SelectedItem 投射到它。所以我假设您的 WatertypeListPicker 是您的 ListBox？

如果是，那么您做错了，因为您的 ListBox 的 itemssource 已绑定到一个类，并且您正试图将 a 添加到您的 WaterType 属性。

我会说，

```
Bath b = new Bath
        {
            Colour = ColourTextBox.Text ?? "Black",
            WaterType = WaterTypeListPicker.SelectedItem
        }; 
```

将我的 Bath 的**WaterType**属性更改为**TypeList**，这样上面的代码就可以工作了。但是我不建议做另一个类来包装枚举只是为了将它显示给列表框。

我要做的是创建一个 EnumHelper

```
public static class EnumExtensions
{
    public static T[] GetEnumValues<T>()
    {
        var type = typeof(T);
        if (!type.IsEnum)
            throw new ArgumentException("Type '" + type.Name + "' is not an enum");

        return (
          from field in type.GetFields(BindingFlags.Public | BindingFlags.Static)
          where field.IsLiteral
          select (T)field.GetValue(null)
        ).ToArray();
    }

    public static string[] GetEnumStrings<T>()
    {
        var type = typeof(T);
        if (!type.IsEnum)
            throw new ArgumentException("Type '" + type.Name + "' is not an enum");

        return (
          from field in type.GetFields(BindingFlags.Public | BindingFlags.Static)
          where field.IsLiteral
          select field.Name
        ).ToArray();
    }
} 
```

并将其绑定到集合

我的**视图模型**

```
public IEnumerable<string> Priority
        {
            get { return EnumExtensions.GetEnumValues<Priority>().Select(priority => priority.ToString()); }

public string SelectedPriority
        {
            get { return Model.Priority; }
            set { Model.Priority = value; }
        } 
```

像那样。

我的**XAML**。

```
<telerikInput:RadListPicker SelectedItem="{Binding SelectedPriority, Mode=TwoWay}" ItemsSource="{Binding Priority}" Grid.Column="1" Grid.Row="4"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T08:52:26.283

`WaterTypeListPicker.SelectedItem`是 type 的对象，因此`TypeList`不能转换为 type 的对象`WaterType`。

为了转换回 WaterType，您可以替换您的演员：

```
WaterType = (WaterType)WaterTypeListPicker.SelectedItem 
```

和：

```
WaterType = (WaterType)Enum.Parse(
                               typeof(WaterType),
                               ((TypeList)WaterTypeListPicker.SelectedItem).Name,
                               false) 
```

# jbpm - Business Process Simulator 原型 JAVA 建议

> ID：11514057
> 
> 赞同：0
> 
> 时间：2012-07-16T23:28:10.027
> 
> 标签：jbpm, bpel, business-process-management, bpmn

作为我论文的一部分，我选择为简单的业务流程模拟器开发一个原型。我欢迎任何/所有建议和指导

该项目的目标是获得软件模拟的基本知识，并深入了解描述业务流程的结构和行为特征的不同软件模型。业务流程可以用 BPMN（业务流程模型和符号）或 BPEL（业务流程执行语言）建模。该项目的可交付成果将包括一个流程模拟器，以及各种类型业务流程的案例研究。我将在 JAVA 中创建一个模拟器

首先，我是使用 BPMN 还是 BPEL 来建模业务流程？

其次，从头开始开发模拟器或使用诸如 buildap 或 jBPM 之类的开源代码并在此基础上进行构建是否明智。

第三，谁能推荐我一本书来学习业务流程的类型，或者换句话说，业务模型的类别和建模取决于流程的类型（您所知道的最好的），以及用于 java 模拟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:13:54.627

加入 jBPM 项目并加入围绕模拟所做的工作怎么样？Maciej 现在正在研究该主题，因此我将向他发送您的问题的链接，以便您保持联系。干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:50:00.040

正如salaboy 所说，我们开始为jBPM5 提供模拟支持，它通常基于流程的替代流程（最初很可能会被扩展）。如果您想与 jbpm IRC 频道取得联系，我们可以进一步讨论（chat.freenode.net#jbpm）

# javascript - JavaScript：计算检索数据所需的时间

> ID：11514060
> 
> 赞同：0
> 
> 时间：2012-07-16T23:28:40.643
> 
> 标签：javascript, jquery

我使用 jQuery 将数据发布到页面，并取回数据。我将如何计算从 POST 到页面并接收数据所花费的时间？

我使用`jQuery.post()`，这是一个代码示例：

```
$.post("test.php", function(data) {
   //do something with data
 }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:30:58.827

```
var before = new Date();
$.post("test.php", function(data) {
   var timeTook = new Date() - before;
 }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:30:45.183

```
var start = Date.now();

$.post("test.php", function(data) {
    alert(Date.now() - start);
}); 
```

* * *

*将其放在脚本顶部以实现浏览器兼容性。*

```
if (!Date.now)
    Date.now = function() {
        return +(new Date);
    }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:31:22.197

```
var start = new Date().getTime();

$.post("test.php", function(data) {
   //do something with data

   var end = new Date().getTime();

   alert((end - start) + ' milliseconds passed');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T23:31:47.377

在您的要求声明日期之前

```
var start = new Date(); 
```

然后在 post 回调中声明另一个日期并计算差异：

```
var end = new Date();
alert(end - start); 
```

# android - 从旋转矩阵中提取偏航、俯仰和滚动

> ID：11514063
> 
> 赞同：24
> 
> 时间：2012-07-16T23:29:17.347
> 
> 标签：android, android-sensors, rotational-matrices

我有一个传感器管理器，它`rotationMatrix`根据设备磁​​力计和加速度计返回一个。我一直在尝试计算用户设备的偏航俯仰和滚动，但发现俯仰和滚动相互干扰并给出不准确的结果。有没有办法从 中提取设备的 YAW PITCH 和 ROLL `rotationMatrix`？

**编辑** 试图在下面解释搅拌机的答案，我很感激但还没有，我试图从这样的旋转矩阵中获得角度：

```
 float R[] = phoneOri.getMatrix();
       double rmYaw = Math.atan2(R[4], R[0]);
       double rmPitch = Math.acos(-R[8]);
       double rmRoll = Math.atan2(R[9], R[10]); 
```

我不知道我是否引用了矩阵的错误部分，但我没有得到我想的结果。

我希望以度为单位获得值，但我得到了奇怪的整数。

我的矩阵来自我的`sensorManager`，看起来像这样：

```
public void onSensorChanged(SensorEvent evt) {
            int type=evt.sensor.getType();
            if(type == Sensor.TYPE_ORIENTATION){
                yaw = evt.values[0];
                pitch = evt.values[1];
                roll = evt.values[2];
            }
            if (type == Sensor.TYPE_MAGNETIC_FIELD) {
                orientation[0]=(orientation[0]*1+evt.values[0])*0.5f;
                orientation[1]=(orientation[1]*1+evt.values[1])*0.5f;
                orientation[2]=(orientation[2]*1+evt.values[2])*0.5f;
            } else if (type == Sensor.TYPE_ACCELEROMETER) {
                acceleration[0]=(acceleration[0]*2+evt.values[0])*0.33334f;
                acceleration[1]=(acceleration[1]*2+evt.values[1])*0.33334f;
                acceleration[2]=(acceleration[2]*2+evt.values[2])*0.33334f;
            }
            if ((type==Sensor.TYPE_MAGNETIC_FIELD) || (type==Sensor.TYPE_ACCELEROMETER)) {
                float newMat[]=new float[16];

                SensorManager.getRotationMatrix(newMat, null, acceleration, orientation);
                if(displayOri==0||displayOri==2){
                    SensorManager.remapCoordinateSystem(newMat,SensorManager.AXIS_X*-1, SensorManager.AXIS_MINUS_Y*-1,newMat);
                }else{
                    SensorManager.remapCoordinateSystem(newMat,SensorManager.AXIS_Y, SensorManager.AXIS_MINUS_X,newMat);
                }

                matrix=newMat; 
```

**设备正面朝上放在桌子上时的样品矩阵**

```
0.9916188,  -0.12448014, -0.03459576,  0.0
0.12525482,  0.9918981,   0.021199778, 0.0
0.031676512,-0.025355382, 0.9991765,   0.0
0.0,         0.0,         0.0,         1 
```

**回答**

```
double rmPitch = Math.toDegrees( Math.acos(R[10])); 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2016-06-01T01:54:16.667

我相信 Blender 的回答是不正确的，因为他给出了从旋转矩阵到欧拉角（zxz 外在）的转换，而 Roll Pitch Yaw 是另一种欧拉角（zyx 外在）。

实际的转换公式宁愿是：

```
yaw=atan2(R(2,1),R(1,1));
pitch=atan2(-R(3,1),sqrt(R(3,2)^2+R(3,3)^2)));
roll=atan2(R(3,2),R(3,3)); 
```

[来源](http://planning.cs.uiuc.edu/node103.html)

反馈：这个实现显示在表示的奇异点附近缺乏数值稳定性（万向节锁定）。因此，在 C++ 上，我建议使用带有以下代码行的 Eigen 库：

```
R.eulerAngles(2,1,0).reverse(); 
```

（更多细节[在这里](https://eigen.tuxfamily.org/dox/group__Geometry__Module.html#title40)）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-07-16T23:33:49.190

偏航、俯仰和滚动对应于欧拉角。您可以很容易地[将变换矩阵转换为欧拉角：](http://en.wikipedia.org/wiki/Rotation_formalisms_in_three_dimensions#Conversion_formulae_between_formalisms)

![在此处输入图像描述](../Images/aeeb5c80e456e6725b6062bf3749c14a.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-12T06:24:13.193

Sensor Manager 提供了一个[SensorManager.getOrientation](https://developer.android.com/reference/android/hardware/SensorManager.html#getOrientation(float[],%20float[]))来获取所有三个角度。

# django - 为第 3 方 Twitter 应用程序选择 Web 框架

> ID：11514066
> 
> 赞同：0
> 
> 时间：2012-07-16T23:30:05.757
> 
> 标签：django, postgresql, mongodb, tornado

我正在构建一个应用程序以使用 twitter API（搜索和 REST）提供 RESTful Web 服务，我当前的堆栈是 django+postgresql。我有一些进程不断从 twitter 收集新信息，因此数据库一直在增长。我不确定 django 和 postgresql 是否适合这种应用程序。

应用程序当前运行缓慢（例如，一个视图进行 682 次查询以显示结果，另一个视图进行 2228 次查询）所以我正在考虑尝试提高性能，调整查询，缓存所有我能缓存的内容并异步运行一些任务或直接进行切换使用 mongodb（通过 asyncmongo）到 Tornado。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T09:25:08.097

首先，您应该了解，tornado 会在大量视图上降级您的应用程序。Django 更适合页面上有数千个查询的应用程序，因为在这种情况下阻塞模型会减少混乱。

其次，是的，切换到 tornado + mongodb 可以改进您的应用程序，因为您将不得不重新考虑您的存储架构。

这里的问题在于存储，而不是工具。尝试找到如何减少视图中的查询，可能是通过在后台进行更重的计算。

# c# - 将 WPF 中 Combobox 的 SelectedIndex 设置为 0

> ID：11514067
> 
> 赞同：0
> 
> 时间：2012-07-16T23:30:15.510
> 
> 标签：c#, wpf

我在运行时将一个集合绑定到一个组合框，我想将索引设置为 0。我找不到我想要的直接答案。

```
_stationNames = new ObservableCollection<string>(_floorUnits.Unit.Select(f => f.Name));
_stationNames.Insert(0, "All");
stationsComboBox.ItemsSource = _stationNames;
stationsComboBox.SelectedIndex = 0;//Doesn;t work 
```

Xaml

```
<ComboBox x:Name="stationsComboBox" Grid.Row="1" Grid.Column="1" Text="{Binding Name}"
                  SelectionChanged="StationComboBoxSelectionChanged" VerticalAlignment="Center" Margin="3"
                   SelectedIndex="0"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:00:08.437

听起来您正在尝试像使用 WinForms 一样使用它。WPF 是一个稍微不同的野兽，并且在绑定方面更强大。

我建议阅读一些关于 MVVM 的内容，以便从 WPF 中获得最大收益。通过将 XAML 绑定到视图模型类（而不是尝试在 Code-behind 中进行连接），您会发现您可以以更大的灵活性完成您想要的事情，而无需大量代码。

例如：给定以下虚拟机：

```
public class MyViewModel: INotifyPropertyChanged
{

    public ObservableCollection<string> StationNames
    {
        get;
        private set;
    }

    public Something()
    {
        StationNames = new ObservableCollection<string>( new [] {_floorUnits.Unit.Select(f=>f.Name)});
        StationNames.Insert(0, "All");
    }

    private string _selectedStationName = null;
    public string SelectedStationName
    {
        get
        {
            return _selectedStationName;
        }
        set
        {
            _selectedStationName = value;
            FirePropertyChanged("SelectedStationName");
        }
    }

    private void FirePropertyChanged(string propertyName)
    {
        if ( PropertyChanged != null )
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

您可以将视图的（XAML 表单）DataContext 设置为 ViewModel 的实例，并将组合框定义更新为：

```
<ComboBox x:Name="stationsComboBox" Grid.Row="1" Grid.Column="1"
                  ItemsSource="{Binding Path=StationNames}" SelectedItem={Binding Path=SelectedStationName} VerticalAlignment="Center" Margin="3"
                   SelectedIndex="0"/> 
```

每当组合框选择更改时，VM 的 SelectedStationName 都会从此处更新以反映当前选择，并且从 VM 代码中的任何位置，设置 VM 的 SelectedStationName 将更新组合的选择。（即实现重置按钮等）

不过，通常情况下，按照您的建议，我会考虑直接绑定到 Units 集合。（或者如果它们本身可以查看/编辑，则从单元派生的 VM。）无论如何，它应该为您提供一个开始研究 WPF 绑定的起点。

# git - 带注释的标签和未注释的标签有什么区别？

> ID：11514075
> 
> 赞同：442
> 
> 时间：2012-07-16T23:30:54.260
> 
> 标签：git, tags, git-tag

如果我想标记当前提交。我知道以下两个命令行都有效：

```
git tag <tagname> 
```

和

```
git tag -a <tagname> -m '<message>' 
```

这些命令有什么区别？

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2012-07-16T23:39:25.467

### TL;博士

命令之间的区别在于，一个为您提供标签消息，而另一个不提供。带注释的标签有一条可以用 git-show(1) 显示的消息，而没有注释的标签只是一个指向提交的命名指针。

### 更多关于轻量级标签

根据[文档](https://git-scm.com/book/en/v2/Git-Basics-Tagging)：“要创建轻量级标签，不要提供任何 -a、-s 或 -m 选项，只需提供标签名称”。还有一些不同的选项可以在带注释的标签上写消息：

*   当你使用 时`git tag <tagname>`，Git 会在当前版本创建一个标签，但不会提示你输入注释。它将被标记而没有消息（这是一个轻量级标记）。
*   当您使用 时`git tag -a <tagname>`，Git 会提示您输入注释，除非您还使用了 -m 标志来提供消息。
*   当您使用 时`git tag -a -m <msg> <tagname>`，Git 将标记提交并使用提供的消息对其进行注释。
*   当您使用 时`git tag -m <msg> <tagname>`，Git 的行为就像您传递了 -a 标志以进行注释并使用提供的消息。

基本上，它只是表示您是否希望标签具有注释以及与之相关的其他一些信息。

* * *

## 回答 #2

> 赞同：279
> 
> 时间：2014-09-23T13:49:36.067

**推送注释标签，保持轻量级本地化**

`man git-tag`说：

> 带注释的标签用于发布，而轻量级标签用于私有或临时对象标签。

并且某些行为确实以该建议有用的方式区分它们，例如：

*   带注释的标签可以包含与它们指向的提交不同的消息、创建者和日期。因此，您可以使用它们来描述发布而不进行发布提交。

    轻量级标签没有额外的信息，也不需要它，因为您只会自己使用它来开发。

*   [git push --follow-tags](https://stackoverflow.com/a/26438076/895245)只会推送带注释的标签
*   `git describe`没有命令行选项只能看到带注释的标签

**内部差异**

*   轻量级和带注释的标签都是`.git/refs/tags`包含 SHA-1的文件

*   对于轻量级标签，SHA-1 直接指向一个提交：

    ```
    git tag light
    cat .git/refs/tags/light 
    ```

    打印与 HEAD 的 SHA-1 相同。

    所以难怪它们不能包含任何其他元数据。

*   带注释的标签指向对象数据库中的标签对象。

    ```
    git tag -as -m msg annot
    cat .git/refs/tags/annot 
    ```

    包含带注释的标签对象的 SHA：

    ```
    c1d7720e99f9dd1d1c8aee625fd6ce09b3a81fef 
    ```

    然后我们可以通过以下方式获取其内容：

    ```
    git cat-file -p c1d7720e99f9dd1d1c8aee625fd6ce09b3a81fef 
    ```

    样本输出：

    ```
    object 4284c41353e51a07e4ed4192ad2e9eaada9c059f
    type commit
    tag annot
    tagger Ciro Santilli <your@mail.com> 1411478848 +0200

    msg
    -----BEGIN PGP SIGNATURE-----
    Version: GnuPG v1.4.11 (GNU/Linux)

    <YOUR PGP SIGNATURE>
    -----END PGP SIGNAT 
    ```

    这就是它包含额外元数据的方式。从输出中我们可以看到，元数据字段是：

    *   它指向的对象
    *   它指向的对象的类型。是的，[标记对象可以指向任何其他类型的对象，例如 blob，而不仅仅是提交](https://github.com/gitlabhq/gitlabhq/issues/8266)。
    *   标签的名称
    *   标注者身份和时间戳
    *   信息。请注意 PGP 签名是如何附加到消息中的

    更详细的格式分析见：[git tag 对象的格式是什么以及如何计算其 SHA？](https://stackoverflow.com/questions/10986615/what-is-the-format-of-a-git-tag-object-and-how-to-calculate-its-sha/52193441#52193441)

**奖金**

*   确定标签是否被注释：

    ```
    git cat-file -t tag 
    ```

    输出

    *   `commit`对于轻量级，由于没有标签对象，所以直接指向commit
    *   `tag`对于注释，因为在这种情况下有一个标签对象
*   仅列出轻量级标签：[如何列出所有轻量级标签？](https://stackoverflow.com/questions/21031201/how-can-i-list-all-lightweight-tags)

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2015-04-04T19:53:31.103

**最大**的区别[在这里](https://stackoverflow.com/questions/4971746/why-should-i-care-about-lightweight-vs-annotated-tags)得到了完美的解释。

基本上，**轻量级标签**只是指向特定提交的指针。**没有进一步的信息被保存**；另一方面，带**注释的标签**是**常规对象**，它们有作者和日期，并且可以被引用，因为它们有自己的 SHA 密钥。

如果知道**谁**标记**了什么**以及**何时**与您相关，请使用带注释的标签。如果你**只是想在你的开发中标记一个特定的点**，不管是谁在什么时候做的，那么轻量级的标签就足够了。

通常你会选择带注释的标签，但这实际上取决于项目的 Git 大师。

# excel - 使用宏在 Excel 中编辑页面的页脚

> ID：11514080
> 
> 赞同：0
> 
> 时间：2012-07-16T23:31:15.370
> 
> 标签：excel, vba

使用 Excel (Office 2010)，我使用相同的页脚和横向打印。我制作了一个宏，将工作簿从纵向更改为横向，但是 Excel / VB 似乎不喜欢使用宏编辑页面的页脚。

您是否能够使用宏、可能使用 VB 代码解决方法或其他方式来编辑页脚？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:48:07.800

你试过录制宏吗？我清理了这个，但这直接来自 Excel 2003

```
Sub setFooter()

On Error GoTo HandleErrors 
'@JimmyPena pointed out an msdn example that seems useful to incorporate
Application.PrintCommunication = False 

    With ActiveSheet.PageSetup
        .Orientation = xlLandscape
        .LeftFooter = "What"
        .CenterFooter = "a"
        .RightFooter = "Header"

    End With
Application.PrintCommunication = True 

ExitHere: 
    Exit Sub 

HandleErrors: 
    ' If an error occurs, make sure you reset 
    ' print communications. 
    Application.PrintCommunication = True 
    Resume ExitHere 
    End Sub 
```

除非你有其他我不理解的问题

# c# - MongoDB LinQ“选择”方法真的只会检索字段的子集吗？

> ID：11514084
> 
> 赞同：3
> 
> 时间：2012-07-16T23:31:27.973
> 
> 标签：c#, performance, mongodb, mongodb-.net-driver, subset

在互联网上搜索如何使用 C# 官方驱动程序（但使用 LinQ 作为基本架构）在 MongoDB 中检索字段子集，我发现了如何在 MongoDB shell 中执行此操作。

```
// selecting only "field" of a collection
db.collection.find( { field : 'value' }, { field: 1 } ); 
```

然后，我在 C# LinQ Tutorial 找到了这个`Select`方法，相当于这个：

```
collection.AsQueryable<T>().Select(x => new { x.field }); 
```

但是，教程说该方法“*用于从匹配的文档中投影新的结果类型*”。

如何确保此方法仅检索字段子集而不是整个结果，然后仅将子集选择到新对象中？

**驱动程序会在检索结果之前构建查询命令吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:42:22.643

驱动程序当前不检索字段的子集。如果您需要该功能，则需要手动完成。此功能的票在这里：[https](https://jira.mongodb.org/browse/CSHARP-456) ://jira.mongodb.org/browse/CSHARP-456 。如果您需要，请随时留下反馈或投票。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:32:35.377

这是作弊......但是：

```
//This actual implementation is untested and may contain small errors.
//The helper method has been tested and *should* work.

public static IMongoQuery GetMongoQuery<T>(this IQueryable<T> query)
{
    return ((MongoQueryable<T>)query).GetMongoQuery();
}

var temp =
    from x in DB.Foo.AsQueryable<Test>()
    where x.SomeField > 5;
    select (x.OtherField);

return temp.GetMongoQuery().ToJson(); 
```

# python - 使用 Python re.search 查找数字范围

> ID：11514086
> 
> 赞同：0
> 
> 时间：2012-07-16T23:31:35.803
> 
> 标签：python, range

我正在尝试在字符串中查找一系列数字。下面列出了不同的范围。如何搜索特定范围的数字？

确保第一个数字在 [1, 17] 之间，第二个数字在 [1, 37] 之间，以此类推。

```
import re   
Test1 = "This is a test 5-9-81-15"

A1 = range(1, 17)
A2 = range(1, 37)
A3 = range(76, 89)
A4 = range(13, 27)

x = re.search("{0}-{1}-{2}-{3}".format(A1, A2, A3, A4), Test1) 

if x: 
    print ("Match")
else:
    print ("No Match") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:43:30.877

如果您可以获得一串数字，您可以通过以下方式检查它是否符合您的要求：

```
>>> s = "5-9-81-15"          # String to parse
>>> lb = [1, 1, 76, 13]      # List of lower bounds
>>> ub = [17, 37, 89, 27]    # List of upper bounds

>>> vals = [int(x) for x in s.split('-')]   # vals contains [5, 9, 81, 15]

>>> all(x > L and x < U for x, L, U in zip(vals, lb, ub))    # does the check
True 
```

一个失败的例子：

```
>>> s = "5-9-90-15"    # fails with the third number
>>> vals = [int(x) for x in s.split('-')]
>>> all(x > L and x < U for x, L, U in zip(vals, lb, ub))
False 
```

如果您需要从包含其他文本/字符的较大字符串中提取数字序列，则正则表达式是正确的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:49:13.597

正则表达式是关于匹配字符的。它不理解数字、日期或其他任何东西。

尽管有时可以构建一个正则表达式来匹配某个范围内的数字，但它可能会变得非常冗长和混乱。

最好的解决方案是尝试找到与您正在寻找的内容*相似*的可能匹配项，然后使用其他方法来检查每个匹配项是否真的*是*您正在寻找的内容。

# objective-c - 在 iOS 上，当您将 double 传递给期望 [single] 浮点数作为参数的方法时，实际发生了什么？

> ID：11514087
> 
> 赞同：2
> 
> 时间：2012-07-16T23:31:36.490
> 
> 标签：objective-c, ios, llvm

假设我有一个函数：

```
- (void) doSomethingWithFloat:(float)aFloat; 
```

我用双精度浮点值调用该函数，如下所示：

```
[self doSomethingWithFloat:12.0]; 
```

是在编译时或运行时完成从 12.0（双）到 12.0f（单）的转换，还是两者都没有？

只是为了清楚起见：我不是在问单精度和双精度浮点数之间的区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T23:45:50.037

ObjectiveC 实际上遵循大多数 C 约定 - 因此在传递给函数时，根据 C 规范将浮点数提升为双倍。ObjectiveC 编译器最终将所有方法转换为函数，所以你的双重工作。

这就是说最好打开编译器警告并传递 CGFloats 或 floats - 它只是让您知道何时失去精度。

# c# - 不可预测的“找到了具有相同 ID 'ctl35' 的多个控件。” 动态添加控件时

> ID：11514091
> 
> 赞同：0
> 
> 时间：2012-07-16T23:32:13.603
> 
> 标签：c#, asp.net, updatepanel

我知道这个问题已经出现了无数次，但我能找到的帖子都没有能够帮助我解决这个问题。

每隔一段时间，我就会收到标题中的错误：`Multiple controls with the same ID 'ctl35' were found. FindControl requires that controls have unique IDs.`这肯定不会一直发生，似乎只是刷新几次就会导致错误消失。

我的页面基本上有一个`UpdatePanel`和，用户用于输入与订单部分相对应的数据。由于可以有多个部分，因此有一个按钮可以创建一个新的`Panel`，创建输入字段并将其添加到 中`Panel`，然后将其添加到`UpdatePanel`. 用户可以多次点击该按钮添加多个entry `Panel`。为了做到这一点，我维护了一个，每次用户想要一个新的输入字段时`List<Panel>`，我都会添加新的。`Panel`当页面收到回发（来自添加按钮）时，然后我遍历 List 并将每个重新添加`Panel`到`UpdatePanel`，它设法保留现有的条目面板。

由于这些字段是动态更新的，因此我确保将要从中检索数据的字段的 ID 设置为唯一且可相互区分的字段。但是，如前所述，我偶尔会遇到有关使用 ASP.NET 自动生成的 ID（`ctl35`在本例中）查找多个控件的问题。一旦我收到此错误，在 Chrome 中查看呈现的 HTML，根本没有控件具有`ctl35`其 ID。此外，呈现的 HTML 甚至都不包含任何 ID 以自动生成的“ctlXX”结尾的元素。因此，我无法理解可能的命名冲突问题会出现在哪里。这个错误在大多数情况下都不会发生，这也是造成混乱的主要原因。

关于这个问题可能是什么的任何想法，或者我可能需要做什么才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:35:31.903

确保将 ID 分配给所有动态创建的控件，而不仅仅是那些需要从中获取数据的控件。我已经看到在添加的控件上使用默认 ID 时会发生这种情况。

# php - 如何解决“响应不是文本/xml 类型：文本/html”错误？

> ID：11514092
> 
> 赞同：2
> 
> 时间：2012-07-16T23:32:29.283
> 
> 标签：php, web-services, nusoap

我正在尝试与 Web 服务通信，但不断收到此错误消息：“响应不是 text/xml 类型：text/html” 如何解决此问题？

下面是我的客户端 php 代码生成请求：

```
<?php
// Pull in the NuSOAP code
require_once('lib/nusoap.php');
// Create the client instance
$client = new nusoap_client('http://www.atomtel.com/MobileCashPayout.asmx');
// Check for an error $client = new nusoap_client('http://www.atomtel.com/MobileCashPayout.asmx');

$err = $client->getError();
if ($err) {
    // Display the error
    echo '<h2>Constructor error</h2><pre>' . $err . '</pre>';
    // At this point, you know the call that follows will fail
}
// Call the SOAP method
//$result = $client->call('hello', array('name' => 'Scott'));
//$client = new SoapClient("some.wsdl", array('soap_version' => SOAP_1_1));
$result = $client->call('Payout', array('testmerc', 'testmerc', '256750000005', '256753986532',
'256750000005','100.00','2222', '', 'BETNET'));

// Check for a fault
if ($client->fault) {
    echo '<h2>Fault</h2><pre>';
    print_r($result);
    echo '</pre>';
} else {
    // Check for errors
    $err = $client->getError();
    if ($err) {
        // Display the error
        echo '<h2>Error</h2><pre>' . $err . '</pre>';
    } else {
        // Display the result
        echo '<h2>Result</h2><pre>';
        print_r($result);
    echo '</pre>';
    }
}
?>
<?php
// Display the request and response
echo '<h2>Request</h2>';
echo '<pre>' . htmlspecialchars($client->request, ENT_QUOTES) . '</pre>';
echo '<h2>Response</h2>';
echo '<pre>' . htmlspecialchars($client->response, ENT_QUOTES) . '</pre>';
?> 
```

然后我得到的错误消息是： `Error`

```
Response not of type text/xml: text/html 
```

请求 如您所见，请求是以 text/xml 格式完成的，但是......

```
POST /MobileCashPayout.asmx HTTP/1.0
Host: www.atomtel.com
User-Agent: NuSOAP/0.9.5 (1.123)
Content-Type: text/xml; charset=ISO-8859-1
SOAPAction: ""
Content-Length: 971

<?xml version="1.0" encoding="ISO-8859-1"?><SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><ns6434:Payout xmlns:ns6434="http://tempuri.org"><__numeric_0 xsi:type="xsd:string">testmerc</__numeric_0><__numeric_1 xsi:type="xsd:string">testmerc</__numeric_1><__numeric_2 xsi:type="xsd:string">256750000005</__numeric_2><__numeric_3 xsi:type="xsd:string">256753986532</__numeric_3><__numeric_4 xsi:type="xsd:string">256750000005</__numeric_4><__numeric_5 xsi:type="xsd:string">100.00</__numeric_5><__numeric_6 xsi:type="xsd:string">2222</__numeric_6><__numeric_7 xsi:type="xsd:string"></__numeric_7><__numeric_8 xsi:type="xsd:string">BETNET</__numeric_8></ns6434:Payout></SOAP-ENV:Body></SOAP-ENV:Envelope> 
```

响应 ....响应以 text/html 格式返回。这是客户遇到的问题。欢迎任何建议。

```
HTTP/1.1 200 OK
Date: Mon, 16 Jul 2012 23:40:19 GMT
Server: IBM_HTTP_Server
Last-Modified: Thu, 20 Oct 2011 17:26:13 GMT
Content-Length: 13726
Cache-Control: public
Connection: close
Content-Type: text/html
Content-Language: en

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>atomtel</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<TITLE>atomtel Prepaid mobile plans and hello tunes,  atomtel postpaid plans </TITLE>
<META NAME="Description" CONTENT="atomtel offers mobile plans that fits customers necessity, atomtel prepaid and postpaid plans with hello tunes services "/>
<META NAME="Keywords" CONTENT="atomtel prepaid, atomtel postpaid, atomtel mobile plans, atomtel postpaid plans, atomtel postpaid plan, atomtel prepaid plans, atomtel prepaid plan, atomtel hello tunes, hello tunes,  atomtel prepaid mobile plans, atomtel prepaid mobile plan, atomtel hello tune, hello tune services"/>
<META NAME="robots" CONTENT="index, follow">
<META name="distribution" content="global">
<meta name="language" content="EN-US">
<meta name="doc-type" content="Public">

<link href="/wps/wcm/404_page/404_page/css/style.css" rel="stylesheet" type="text/css" />
<link href="/wps/wcm/404_page/404_page/css/for_you.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function pre_s()
{
document.getElementById('pre_a').style.display='block';
document.getElementById('pre').style.display='none';
document.getElementById('post').style.display='block';
document.getElementById('post_a').style.display='none';

document.getElementById('content_one').style.display='block';
document.getElementById('content_two').style.display='none';
}
function post_s()
{
document.getElementById('pre_a').style.display='none';
document.getElementById('pre').style.display='block';
document.getElementById('post').style.display='none';
document.getElementById('post_a').style.display='block';

document.getElementById('content_one').style.display='none';
document.getElementById('content_two').style.display='block';
}
</script>
<script type="text/javascript" src="/wps/wcm/404_page/404_page/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" SRC="/wps/wcm/404_page/404_page/js/new_menu.js"></script>
<script type="text/javascript" src="/wps/wcm/404_page/404_page/js/jquery.cycle.all.min.js"></script>
<script type="text/javascript" src="/wps/wcm/404_page/404_page/js/main.js"></script>
<script type="text/javascript" src="/wps/wcm/404_page/404_page/js/common.js"></script>

<link href="/wps/wcm/404_page/404_page/css/menu.css" rel="stylesheet" type="text/css" />
<link href="/wps/wcm/404_page/404_page/css/smenu.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table width="770" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td bgcolor="#FFFFFF" class="main_container"><table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="160" align="left" valign="middle" id="header_logo"><a href="http://www.atomtel.in/"><img src="/wps/wcm/404_page/404_page/images/atomtel_Logo.PNG" alt="" border="0" /></a></td>
                <td align="right" valign="middle" class="arial11lightgrey" id="topnav"><a href="http://atomtel.in/wps/wcm/connect/about+bharti+atomtel/Bharti+atomtel/About+bharti+atomtel/?WCM_Page.ResetAll=TRUE&CACHE=NONE&CONTENTCACHE=NONE&CONNECTORCACHE=NONE&SRV=Page" class="arial11lightgrey">About bharti atomtel</a>&nbsp;&nbsp;| &nbsp;&nbsp;<a href="http://atomtel.in/wps/wcm/connect/about+bharti+atomtel/Bharti+atomtel/Investor+Relations/?

WCM_Page.ResetAll=TRUE&amp;CACHE=NONE&amp;CONTENTCACHE=NONE&amp;CONNECTORCACHE=NONE&amp;SRV=Page" class="arial11lightgrey">Investor Relations</a>&nbsp;&nbsp;| &nbsp;&nbsp;<a href="http://www.atomtel.in/wps/wcm/connect/about+bharti+atomtel/Bharti+atomtel/Media+Centre/" class="arial11lightgrey">Media Centre</a>&nbsp;&nbsp;| &nbsp;<a href="http://www.atomtel.in/wps/wcm/connect/about+bharti+atomtel/Bharti+atomtel/Careers/" class="arial11lightgrey">Careers</a>&nbsp;&nbsp;| &nbsp;&nbsp;<a href="http://www.atomtel.in/wps/wcm/connect/about+bharti+atomtel/Bharti+atomtel/Contact+Us/" class="arial11lightgrey">Contact Us</a></td>
                <td valign="middle" class="topsearch"><input name="textfield2" type="text" class="search_txtbox"  id="textfield2" value="search"  onfocus="if (this.value == 'search') { this.value=''; }" onblur="if (this.value == '') { this.value='search'; }"  />
                  <a href="#"><img src="/wps/wcm/404_page/404_page/images/search_button.gif" alt="" width="24" height="20" border="0" align="top" class="search_btn" /></a></td>
              </tr>
            </table></td>
        </tr>
        <tr>
          <td valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td width="66" valign="top"><a href="http://www.atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/"><img src="/wps/wcm/404_page/404_page/images/for_me.gif" alt="For Me" width="66" height="21" border="0" /></a></td>
              <td width="1" valign="top"><img src="/wps/wcm/404_page/404_page/images/top_separator.gif" width="1" height="21" /></td>
              <td width="140" valign="top"><a href="http://www.atomtel.in/wps/wcm/connect/atomtelinAES/AES/Home/"><img src="/wps/wcm/404_page/404_page/images/for_enterprise.gif" alt="For Enterprise Business" width="140" height="21" /></a></td>
              <td valign="top">&nbsp;</td>
              <td width="54" valign="top" style="padding-bottom: 5px;"><a href="http://atomtel.in/social/"><img src="/wps/wcm/404_page/404_page/images/social-icon.jpg" width="118" height="27" /></a></td>
              <td width="70" valign="top" style="padding-top:5px;"><a href="https://ebpp.atomtelworld.com/cares/wps/myportal"><img src="/wps/wcm/404_page/404_page/images/my_atomtel.gif" alt="My atomtel" width="70" height="21" /></a></td>
            </tr>
          </table></td>
        </tr>
        <tr>
          <td valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="6" valign="top"><img src="/wps/wcm/404_page/404_page/images/nav_left_corner.gif" width="6" height="36" /></td>
                <td align="left" valign="bottom" class="mainmenu"  id="sitenav"><ul class="nav-container">
                  <li id="nav1" class="nav"><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/foryou/mobile/" id="nav_mobile" >Mobile</a>
                    <div class="nav_menu">
                      <div class="nav_menu_outer">
                        <div class="colimg"><img src="/wps/wcm/404_page/404_page/images/mega_mobile.gif" width="28" height="45" alt="Mobile" /></div>
                        <div class="nav_menu_inner">
                          <div class="nav_menu_links">
                            <ul>
                              <li><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/forme_newuser/mobile/prepaid+services/">Prepaid Plans</a></li>
                              <li><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/forme_newuser/mobile/postpaid+services/">Postpaid Plans</a></li>
                              <li class="last"><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel_Live/Home/">Hello Tunes</a></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                    </div>
                    </div>
                  </li>
                  <li><img src="/wps/wcm/404_page/404_page/images/nav_separator.gif" width="4" height="36" /></li>
                  <li id="nav2" class="nav"><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/forme_newuser/broadband+and+fixed+line/" id="nav_broadband">Broadband &amp; Fixed Line</a>
                    <div class="nav_menu">
                      <div class="nav_menu_outer">
                        <div class="colimg"><img src="/wps/wcm/404_page/404_page/images/mega_broadband.gif"/></div>
                        <div class="nav_menu_inner">
                          <div class="nav_menu_links">
                            <ul>
                              <li><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/foryou/broadband+and+fixed+line/broadband/">Broadband Plans</a></li>
                              <li><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/foryou/broadband+and+fixed+line/fixed+line/tariffs/">Fixed Fine Tariffs</a></li>
                              <li class="last"><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/forme_newuser/broadband+and+fixed+Line/broadband/coverage/">Coverage</a></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                    </div>
                    </div>
                  </li>
                  <li><img src="/wps/wcm/404_page/404_page/images/nav_separator.gif" width="4" height="36" /></li>
                  <li id="nav3" class="nav"><a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/forme_newuser/dth+services/" id="nav_dth">Broadband &amp; Fixed Line</a>
                    <div class="nav_menu">
                      <div class="nav_menu_outer">
                        <div class="colimg"><img src="/wps/wcm/404_page/404_page/images/mega_digital.gif"  /></div>
                        <div class="nav_menu_inner">
                          <div class="nav_menu_links">
                            <ul>
                              <li><a href="http://atomtel.in/wps/wcm/connect/DTH/Bharti%20DTH/Home">Digital Tv</a></li>
                              <li class="last"><a href="http://216.205.49.67/iptv/">IPTV</a></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                    </div>
                    </div>
                  </li>
                  <li><img src="/wps/wcm/404_page/404_page/images/nav_separator.gif" width="4" height="36" /></li>
                  <li id="nav4" class="nav"><a href="http://www.atomtel.in/atomtel3G/" id="nav_3g">3G services</a></li>
                </ul></td>
                <td width="6" valign="top"><img src="/wps/wcm/404_page/404_page/images/nav_right_corner.gif" width="6" height="36" /></td>
              </tr>
            </table></td>
        </tr>
        <tr>
          <td height="6" valign="top"></td>
        </tr>
        <tr>
          <td valign="top"><table width="752" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="752" align="left" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
                  <tr>
                    <td height="407" valign="top" class="page_content_not" style="background:#ed1d24 url(/wps/wcm/404_page/404_page/images/bg_atomtel.jpg) no-repeat right top;"><div class="content">
                      <img src="/wps/wcm/404_page/404_page/images/404_img.jpg" width="166" height="71" style="padding:0 0 28px 40px;" />
                      <p><strong style="font-size:13px;">Sorry! The page you are looking for could not be found!</strong></p>
                      This could be because of the following reasons:
                      <ul>
                        <li> A mistyped address</li>
                        <li> Temporary unavailability of the site</li>
                        <li> Removal of the link </li>
                      </ul>
                      <p>Please try later or go to the <a href="http://www.atomtel.in/">home page.</a></p>
                      <p>You can also keep browsing through the <br />
                        rest of the website using the top navigation. </p>
                    </div></td>
                    <td align="right" valign="top" style="background:url(/wps/wcm/404_page/404_page/images/img_maginifier.jpg) no-repeat right top">&nbsp;</td>
                  </tr>
                </table></td>
              </tr>
            </table></td>
        </tr>
      </table></td>
  </tr>
</table>
<table width="770" border="0" align="center" class="footer" cellpadding="0" cellspacing="0">
  <tr>
    <td height="28" align="left" valign="middle">&copy; atomtel India 2010, All Rights Reserved. &nbsp;&nbsp;&nbsp;</td>
    <td align="right" valign="middle"><a href="http://www.atomtel.in/fraudAlert/fraudalert.html" target="_blank">Important Alerts</a> | <a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/privacy+statement/" target="_blank">Privacy Statement</a> | <a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/do+not+disturb+registry/">Do Not Disturb Registry</a> | <a href="http://atomtel.in/wps/wcm/connect/atomtel.in/atomtel.in/home/telemarketer+registration/" target="_blank">Telemarketer Registration</a> &nbsp;&nbsp;</td>
  </tr>
</table>
<script type="text/javascript"> 
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");

    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script> 
    <script type="text/javascript"> 
    var pageTracker = _gat._getTracker("UA-4570700-1");
    pageTracker._initData();
    pageTracker._trackPageview();
    </script> 

</body>
</html> 
```

# resharper - ReSharper 设置灰显

> ID：11514093
> 
> 赞同：2
> 
> 时间：2012-07-16T23:32:51.617
> 
> 标签：resharper

今天我尝试在 ReSharper 6.0 (VS 2010) 中对单个文件进行“代码清理”。代码清理对话框没有出现，所以我又试了一次。

然后我发现，该功能是灰色的，当我按下代码清理的热键时，通知区域显示“命令目前不可用”。

甚至代码清理设置也被隐藏了。应该显示设置的面板说设置是特定于解决方案的，因此需要打开一个解决方案（尽管它是）。

除代码清理外，所有其他特定于解决方案的设置和功能都有效。

我想避免重新安装 ReSharper 或重置其设置，否则我需要重新设置它（像重新安装之前一样设置所有选项的漫长而烦人的工作）。

恐怕备份设置并再次恢复它也会恢复问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T11:32:58.337

建议：

1.  确保您尝试清理的文件包含在您的解决方案中。
2.  尝试重新打开解决方案（关闭然后再次打开）。
3.  升级到 6.1.1，也许它固定在那里。
4.  [在http://youtrack.jetbrains.com](http://youtrack.jetbrains.com)提交错误报告

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-14T16:36:52.847

ReSharper 7 和 8 似乎都可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-14T16:33:05.943

我知道这是一个古老的答案，但我对此有了更多的了解。根据 Jerrie Pelser[在去年的这篇博](http://www.jerriepelser.com/blog/cleanup-code-resharper-available)文中的说法，这可能与作为 NuGet 包一部分的文件有关。就我而言，这绝对是它！

在链接失效的情况下，基本上该帖子提到 ReSharper 将避免对其检测到的文件进行重构/代码清理，这些文件被添加为 NuGet 包的一部分。这类似于它不允许对生成的代码进行代码清理。

# java - 我应该使用简单的代码对数组和字符串使用什么属性文件库？

> ID：11514095
> 
> 赞同：0
> 
> 时间：2012-07-16T23:33:11.150
> 
> 标签：java, properties, config

我需要一个可以处理某种文件配置的 Java 库。我需要能够使用最简单的代码轻松地将数组和字符串存储到其中。我不在乎它是 JSON、XML 还是 YAML，它只需要存储在一个文本文件中。我不关心速度或库文件大小，只关心数据类型的多功能性和 API 的简单性。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:35:16.047

Apache commons 配置是您所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T02:45:00.430

我在我写的东西上使用了 XMLEncoder。它允许您以 xml 格式存储整个数组。如上所述，Apache 公共配置也可能非常适合您。XMLEnocder 很好，因为您可以只获取一个 java 对象并将其写入文件。[这是一个示例的链接。](http://java.sun.com/products/jfc/tsc/articles/persistence4/)

# java - JVM 有运行时分支预测吗？如果是这样，Java 代码中是否有提示分支结果的方法？

> ID：11514097
> 
> 赞同：7
> 
> 时间：2012-07-16T23:33:27.843
> 
> 标签：java, jvm

正如标题所说：

我记得在一些 C 编译器（例如 GCC）中，我们能够向编译器提示可能的分支预测结果。JVM有这样的功能吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T23:47:26.063

除非有一些新的注释让我无法理解，否则不会。

另一方面，尚不清楚这样的功能会有多有用。请记住，与诸如 C/C++ 之类的语言不同，源代码级别的“预测”不一定是最佳策略，因为代码在运行时实际执行的操作并不神秘：JVM可以潜在地监视关键行为，并在必要时根据其测量值重新编译代码段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:47:05.867

不，JVM 在源代码级别没有这样的编译器提示或优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-01T17:11:47.413

这篇文章很有趣，其中包含一个 Java 分支预测失败的案例：

[为什么处理排序数组比处理未排序数组更快？](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)

# gcc - 交叉编译器默认包含路径设置

> ID：11514098
> 
> 赞同：3
> 
> 时间：2012-07-16T23:33:36.423
> 
> 标签：gcc, cross-compiling

首先，一些背景知识：我正在尝试在 Beagleboard-xM 上为 Android 编写驱动程序和应用程序。

我已经下载了他们的 android 开发工具包，安装了它，并且可以使用[http://processors.wiki.ti.com/index.php/TI-Android-ICS-4.0.3-DevKit上的说明成功构建其中的所有内容-3.0.0_DevelopersGuide](http://processors.wiki.ti.com/index.php/TI-Android-ICS-4.0.3-DevKit-3.0.0_DevelopersGuide)

[我已经能够按照http://tldp.org/LDP/lkmpg/2.6/lkmpg.pdf](http://tldp.org/LDP/lkmpg/2.6/lkmpg.pdf)中的步骤制作自己的骨架内核模块，没有问题。我可以将 .ko 文件复制到 android 设备、insmod、rmmod 等。

我厌倦了默认构建提供的基本外壳，并认为我会添加busybox。我尝试按照[http://omappedia.org/wiki/Android_Installing_Busybox_Command_Line_Tools](http://omappedia.org/wiki/Android_Installing_Busybox_Command_Line_Tools)上的说明进行操作，但在标准 libc 头文件中出现编译错误。

经过一番挖掘，我确定 TI android 开发套件中提供的预构建交叉编译器没有搜索正确的路径。

我通过创建自己的 .c 文件确认了这一点，该文件包含并尝试使用 **arm-eabi-gcc blah.c -o blah**进行编译， 并得到了相同的结果（无法找到有问题的头文件）

**'arm-eabi-gcc -print-prog-name=cc1' -v**给了我这个：

*   忽略不存在的目录“/usr/local/google/home/android/cupcake_rel_root/usr/local/include”
*   忽略不存在的目录“/usr/local/lib/gcc/arm-eabi/4.4.3/include”
*   忽略不存在的目录“/usr/local/lib/gcc/arm-eabi/4.4.3/include-fixed”
*   忽略不存在的目录“/usr/local/lib/../arm-eabi/include”
*   忽略不存在的目录“/usr/local/google/home/android/cupcake_rel_root/usr/include”

在我全新安装的 ubuntu 10.04 中，这些路径都不存在。我使用的交叉编译器位于**/usr/TI-Android/prebuilt/linux-86/toolchain/arm-eabi-4.4.3/**。除了运行作为 android 开发工具包的 bit .bin 文件之外，我什么也没做（这看起来更像是简单地从 .bin 文件中提取自身；我不记得它做了其他任何事情）

所以，有几个问题：

1.  到底是如何通过将交叉编译工具的 bin 放入 $PATH 来构建其他所有东西（即 android、x-loader、u-boot、内核）的（就像操作文档所说的那样）。我认为它（make menuconfig？）在根据可执行文件的位置修复包含路径方面有一些魔力，但是......
2.  为什么busybox的工作方式不一样，因为它似乎是用相似的基础设施构建的？
3.  我该如何做才能交叉编译我自己的应用程序？

我假设我错过了一步，应该在预构建的交叉编译器上进行某种安装/配置，但信息非常少。我呼吁你们，开源之神，为我指明穿越这片黑暗和暴风雨的大海的道路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T17:01:21.447

对于后人来说，似乎android开发工具包中包含的预构建工具仅足以构建内核，并且不包含libc或其他库头文件。（NDK 工具是“不同的”，构建环境更加不同，因为它有自己的 libc--bionic 版本。那个构建环境可能能够构建我想要的东西，但我不得不用 Androidy生成文件等）

我最终不得不获得 Code Sourcery **arm-none-linux-gnueabi**（必须获得 linux-gnueabi 一个以获得所需的 linux 系统头文件），之后一切都运行得相当顺利。

# mysql - 良好的数据库设计，随着时间的推移会降低精度的分辨率

> ID：11514103
> 
> 赞同：2
> 
> 时间：2012-07-16T23:33:49.437
> 
> 标签：mysql, database-design, graph

我在数据库中有 20,000 个数据点，我想将其显示在 google 注释图上。我认为大约 2000 点对于实际使用图表来说是一个很好的数字，所以我想使用平均值而不是我拥有的实际数据点数量。

该数据计算某事在某个时间出现的频率。它就像表（频率，日期时间）

因此，在第一周，我将 datetime 间隔为每 10 分钟一次，并且频率将是该时间间隔（10 分钟）的所有频率的平均值。同样，在那之后的一个月里，我将有一个小时的日期时间间隔等。

我认为这也是你可以在谷歌金融上看到的东西，一段时间后，即使你放大数据点的分辨率也会降低。

那么什么是一个好的设计呢？是否已经存在可以执行此类操作的工具？我已经想到（尽管它可能不太好）一个包含所有 20,000 个点的巨型表和几个代表每个时间间隔（1 周、1 个月等）的较小表，这些表是通过对较大表的查询构建的，并不断更新和修剪具有新的平均值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:59:45.827

将数据库中的原始数据保存在一张表中。有第二个 reprti g 表，您可以使用脚本或查询从原始表中填充该表。填充报告表的转换可以根据需要对存储桶进行分组和平均。重要的是不要在初始插入时转换数据——保留所有原始数据。这样，如果你搞砸了，你总是可以回滚或重建。

ETL。学习它。爱它。活下去。

# javascript - 如何在动画函数的回调中使用动画函数创建的属性？

> ID：11514107
> 
> 赞同：0
> 
> 时间：2012-07-16T23:34:36.643
> 
> 标签：javascript, jquery, scroll

我正在处理一个包含一系列图像的页面。每个图像将在一个容器中，每个容器将向左浮动。由于图像将具有不同的宽度，因此无法知道每行上有多少图像。当访问者单击图像时，图像及其容器将展开。

在某些情况下，这种展开意味着被点击的图片会跳转到下一行，并因此离开屏幕。我正在寻找一种让屏幕跟随点击的图像的方式。

到目前为止，这是我的代码：

```
<script type="text/javascript">
$(document).ready(function(){
    $(".ExampleImage").toggle(
        function(){
            var Image = $(this);
            var Container = $(this).closest(".ImageContainer");
            Image.switchClass("ExampleImageContracted","ExampleImageExpanded",500);
            Container.css('height','auto');
            Image.queue(scrollToExample(Image));
        },
        function(){
            var Image = $(this);
            var Container = $(this).closest(".ImageContainer");
            Image.switchClass("ExampleImageExpanded","ExampleImageContracted",500);
            Container.animate({'height':'250'},500,scrollToExample(Image));
        }
    );

    function scrollToExample(Image) {
        var NewTop = $(Image).closest(".Example").offset();         
        $('html, body').animate( {
            scrollTop:NewTop.top
        }, 1000);   
    }
});
</script> 
```

请注意，我在 和 中都使用了回调，`.animate`并`.queue`试图正确排序。不幸的是，这个为图像容器提取的值`.offset`是*旧*的顶部，而不是动画之后出现的那个。我正在寻找一种在动画完成后获取容器顶部的方法。任何建议将不胜感激。

如果您想查看上述代码的运行情况，请点击此处的链接。请注意，当您到达该页面并单击示例 4 时，屏幕不会向下滚动到示例 4 的新位置。

[http://notiondigitalarts.com/ImageEnlargeTest/](http://notiondigitalarts.com/ImageEnlargeTest/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:32:17.110

尝试更改这两行：

```
Image.queue(scrollToExample(Image));
...
Container.animate({'height':'250'},500,scrollToExample(Image)); 
```

到：

```
Image.queue(function() { scrollToExample(Image); });
...
Container.animate({'height':'250'},500,function(){scrollToExample(Image);}); 
```

您拥有它的方式不是将回调函数传递给`.queue()`and `.animate()`，而是立即调用您的`scrollToExample()`函数并将其结果传递给`.queue()`and `.animate()`。

话虽如此，我认为您根本不需要`.queue()`在这里使用。

另请注意，在您的`scrollToExample()`函数中，您可以说`Image.closest(...`而不是`$(Image).closest(...`因为`Image`已经是一个 jQuery 对象。（除非您希望您的函数能够处理其他类型的输入。）

# java - Android上的字符大小

> ID：11514108
> 
> 赞同：1
> 
> 时间：2012-07-16T23:35:04.393
> 
> 标签：java, android, char, primitive-types

根据 Java 规范，[char](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)数据类型的大小为 16 位或两个字节。

因此，我编写了以下代码：

```
private static final int BUFFER_SIZE=1024;
char[] buffer=new char[BUFFER_SIZE];
BufferedReader br= new BufferedReader(new InputStreamReader(conn.getInputStream()));

while (true){
    byteFromStream=in.read(buffer);
    if (byteFromStream==-1) break;
    totalBytesLoaded=totalBytesLoaded+byteFromStream*2;
} 
```

但是由于某些奇怪的原因，我正在读取更多字节，然后在流中可用，根据[read()](http://developer.android.com/reference/java/io/Reader.html#read%28char%5b%5d,%20int,%20int%29)返回流实际读取的字符数的规范。

哦，我得到了总流大小

```
bytesTotal=conn.getContentLength(); 
```

当我自己在服务器上上传文件并且我知道它们的大小时，这工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:50:28.393

该方法返回读取字符的数量。该值不需要乘以 2，尤其是因为您无法对流中字符的字节大小做出一般假设。

每个字符的字节数取决于字符编码（例如可以是 1 个字节）。阅读器组件知道这一点，并且只告诉您阅读字符的数量。

# ssis - 通过 SSIS 包将 Excel 文件重新导入 SQL SERVER

> ID：11514109
> 
> 赞同：0
> 
> 时间：2012-07-16T23:35:13.073
> 
> 标签：ssis

我有一个 SSIS 项目，用于将数据从 Excel 文件导入 SQL Server 表。但这只是将记录附加到我的表中，我需要添加更新表中现有数据的功能，这意味着同一个 excel 文件可以重新导入太多次。

我该怎么做或者我在哪里可以得到我非常感激的信息

谢谢埃利亚娜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T14:19:19.547

一个简单的解决方案是使用临时表和 t-sql MERGE 语句。就是这样 ：

1.  为您的会话创建一个临时表（创建表 #mytable (...)）
2.  将 Excel 文件的内容导入该临时表
3.  使用 MERGE 语句将临时表合并到您的实际目标表中。

这是 T-SQL MERGE 语句的文档：[http ://technet.microsoft.com/en-us/library/bb510625.aspx](http://technet.microsoft.com/en-us/library/bb510625.aspx)

此示例说明如何使用 MERGE 合并两者：

```
MERGE RealDestinationTable AS target
USING #mytable AS source
ON (target.Id = source.Id)
WHEN MATCHED THEN 
    UPDATE SET Name = source.Name
WHEN NOT MATCHED THEN   
    INSERT (Field1, Field2)
    VALUES (source.Field1, source.Field2)
    OUTPUT deleted.*, $action, inserted.* 
        INTO #AnyResultTempTable; 
```

# events - 从滚动页面停止空格键

> ID：11514111
> 
> 赞同：8
> 
> 时间：2012-07-16T23:35:16.080
> 
> 标签：events, jquery, preventdefault

我知道这`e.preventDefault();`应该阻止空格键在页面上滚动，但它不适用于我的功能

```
$("html").live("keyup", function (e) {
    var code = (e.keyCode ? e.keyCode : e.which);
    if ((code == 32 || code == 13) && $("span").is(":focus")) {
        openDropdown();
        $(".dropdown a.PivotItem:first").focus();
        e.preventDefault();
    } else if ((code == 32 || code == 13) && $("a.PivotItem").is(":focus")) {
        closeDropdown();
        changeSelected($("*:focus"));
        e.preventDefault();
    } else if (code == 27 && ($("span").is(":focus") || $(".dropdown a.PivotItem").is(":focus"))) {
        closeDropdown();
        $("span").focus();
    } else {
        //do nothing
    }
}); 
```

它与`.live(`我包含的处理程序有关吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-16T23:40:46.543

空格键在 上滚动页面`keydown`，而不是在 上`keyup`，所以尝试：

```
$("html").on("keydown", function (e) {
   // etc 
```

您实际上不需要使用`.live()`，因为`html`当您的代码运行时该元素将存在。

此外，jQuery 规范化`event.which`，所以你不需要测试`event.keyCode`.

# hadoop - 在 hadoop 中，如何在“configure()”方法中打印？

> ID：11514118
> 
> 赞同：0
> 
> 时间：2012-07-16T23:35:38.020
> 
> 标签：hadoop, configure, mapper

在这个 hadoop 教程的底部示例中，有一个“configure()”方法。 [http://hadoop.apache.org/common/docs/r0.20.2/mapred_tutorial.html#Source+Code-N10FD0](http://hadoop.apache.org/common/docs/r0.20.2/mapred_tutorial.html#Source+Code-N10FD0)

我想在其中放置一个打印语句以知道它到达那里。但是，没有任何内容打印到控制台。我是做错了还是有什么我不明白的hadoop。

它位于页面底部示例的第 28 行。

这是我输入的内容，但同样只有 WordCount 的正常输出被输入到控制台。

```
public void configure(JobConf job) {
System.out.println("HERE !@#$%^&*");
caseSensitive = job.getBoolean("wordcount.case.sensitive", true);
inputFile = job.get("map.input.file"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:30:45.993

当您说控制台时 - 您是指您从中提交作业的控制台吗？

如果您在本地模式下运行，那么我希望 sysout 在控制台中。

如果此作业是针对集群（伪或真实）运行的，那么 sysout 语句将转到任务日志，并且不会返回到您的本地控制台（除非任务有错误，在这种情况下，您可能会看到stdout/err 返回控制台）。您可以通过转到 Job Tracker Web UI 查看这些日志，然后深入了解作业以显示 map 和 reduce 任务 - 每个任务都有与之关联的日志，您也可以通过 Web ui 查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T05:53:59.130

将此语句添加到您的 jobconf 对象。Ans : conf.set(“mapred.job.tracker”, “local”);

# java - Java的跨平台（SE / Android兼容）构造区域几何工具包？

> ID：11514119
> 
> 赞同：2
> 
> 时间：2012-07-16T23:35:40.750
> 
> 标签：java, android, geometry, libgdx

我目前正在开发一个跨平台应用程序（实际上是一个使用*libgdx*的游戏），我需要一些算法的*建设性区域几何*实现。

问题是 Android API 不包含`java.awt.geom.Area`实现。它*确实*包含`android.graphics.Region`类'虽然，它似乎能够执行相同的事情，这意味着在这种情况下定义多边形，然后在它们的区域上执行基本的逻辑操作。

解决方案似乎是开发一个适配器接口，并让每个发行版（Java SE/Android）在启动时设置适当的实现。

这很简单，但经过一番搜索后，我很困惑我还没有遇到上述解决方案的实现。

我的问题是：**毕竟，是否有一个库实际上已经这样做了，或者，另一个更简单的问题解决方案，例如埋在“通用”Java API 的某个地方？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:39:39.167

您也许可以使用（现在已不复存在？）[Apache Harmony](http://harmony.apache.org/)项目的`java.awt.geom`包实现中的代码：http: [//svn.apache.org/viewvc/harmony/enhanced/java/trunk/classlib/modules/awt/src /main/java/common/java/awt/geom/](http://svn.apache.org/viewvc/harmony/enhanced/java/trunk/classlib/modules/awt/src/main/java/common/java/awt/geom/)

我对这段代码没有经验，所以我不能说它是否完整或有什么好处。它也不清楚您必须引入多少额外的代码才能完成这项工作......

# windows - 如何在一个批处理命令中输入多个变量

> ID：11514121
> 
> 赞同：0
> 
> 时间：2012-07-16T23:36:18.640
> 
> 标签：windows, batch-file, cmd, dos

我有很多变量要放在这个特定的命令中，有没有办法在不重写命令的情况下添加很多变量？

*目录 c:\ /s /b /a | 找到“我的文件”*

例如，我想搜索“我的文件”和其他 50 项内容。

感谢您的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T04:22:51.110

简而言之：没有。您必须重写命令，除非特定命令*确实*接受多个参数（可能是变量）。在你的情况下它没有，所以你需要重写它。

一种选择是使用`findstr`而不是`find`. 您可以传递多个搜索模式：

```
dir c:\ /s /b /a | findstr /c:"my file" /c:"other" /c:"other 2" ... 
```

不过，我不知道这可以扩展到“其他 50 件事情”的程度如何，但这样的解决方案可能没有。也许您可以使用正则表达式（检查`findstr /?`）将文件名压缩为视图。

你也可以简单地做：

```
for /R c:\ %i in ("my file" "other" "other2") do @echo %i 
```

但是，这两种解决方案都可以选择重复。他们基本上基于“包含”语义进行搜索。因此，“C:\foo\my file”和“C:\foo\bar\my file\something.txt”都将匹配。但是你原来的解决方案也有这个问题。

如果您可以使您的搜索模式独一无二或可以忍受误报，那么这应该不是问题。但是请注意它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T15:43:13.780

扩展 Christian 的建议以使用 FINDSTR 而不是 FIND - 您可以简单地将所有 50 个搜索词放在一个文本文件中，并使用该`/G:"filename"`选项引用它们。

但是有一个重要的警告 -**搜索多个文字字符串时有一个讨厌的 FINDSTR 错误。**请参阅[为什么这个具有多个文字搜索字符串的 FINDSTR 示例找不到匹配项？](https://stackoverflow.com/questions/8921253/why-doesnt-this-findstr-example-with-multiple-literal-search-strings-find-a-mat).

如链接中所述，解决方法是使用该选项进行不区分大小写的搜索`/I`，或者使用带有该`/R`选项的正则表达式搜索词。

有关未记录的 FINDSTR 功能和错误的“完整”列表，请参阅[Windows FINDSTR 命令的未记录功能和限制是什么？](https://stackoverflow.com/questions/8844868/what-are-the-undocumented-features-and-limitations-of-the-windows-findstr-comman).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T02:50:17.903

您可以将其包装在 for 循环中：

```
for %i in ("my file" "second file") do dir c:\ /s /b /a | find %i 
```

# jquery - 对于流畅的导航菜单，如何为每个面包屑动态调整填充？

> ID：11514125
> 
> 赞同：2
> 
> 时间：2012-07-16T23:37:12.653
> 
> 标签：jquery, css, menubar, breadcrumbs, fluid-layout

我目前正在构建一个布局流畅的网站。那里的主流流体模板实际上都没有带有可以在调整窗口大小或以不同宽度加载时自行调整的库存水平导航。

我一直在阅读在线教程和其他试图解决类似问题的 Stack Overflow 解决方案，其中一些非常聪明并且非常接近，但没有一个能够处理类似块的悬停效果`a {display:block; padding:10px 40px;} a:hover {background:#ccc;}`。其他人则使用巧妙的方法来创建宽度相同且随窗口宽度调整的块链接；但是，这还不够精确，我不希望在链接块之间创建相同的宽度，而是希望在链接之间具有相同的左/右填充。这要精确得多，因为链接之间的距离是相同的。

我已经放弃了用 CSS 做这件事，也许其他人有处理可变填充的解决方案，或者非常接近的东西。无论如何，我决定尝试在 jQuery 中处理它。

我以前从未真正编写过任何 jQuery，但多年来一直使用多个插件。我想我至少应该在发布之前尝试想出一些东西。我有它的工作，**我想知道如果用户调整窗口大小，而不仅仅是在页面加载时，是否可以添加动态调整的能力**。我也想知道他们的做法是否有问题。

这是我到达的地方的链接：http: [//jsfiddle.net/XZxMc/3/](http://jsfiddle.net/XZxMc/3/)

的HTML：

```
<div class="container">
    <div class="row">                        
        <div class="twelvecol">
            <ul>
                <li><a href="#">short</a></li>
                <li><a href="#">longer</a></li>
                <li><a href="#">even-longer</a></li>
                <li><a href="#">really-really-long</a></li>
                <li><a href="#">tiny</a></li>  
            </ul>               
        </div>
    </div>
</div> 
```

CSS：

```
.container {
    background:#ccc; 
    font-family:arial, helvetica;
}

.row {
    width: 100%;
    max-width: 700px; 
    min-width: 600px; 
    margin: 0 auto;
    overflow: hidden;
    background:white;
}

.row .twelvecol {
    width:100%; 
    float:left;
}

ul {
    text-align:center;
}

ul li {
    display:inline-block;     
    zoom:1; 
    *display: inline;
}

ul li a {
    padding:12px 39px;
    display:block;
}

a {text-decoration:none;}
a:hover {background:blue; color:white;} 
```

​​​JavaScript：

```
// Initial left/right padding of links set in css
var paddingIni = 39;
// Initial max-width of .row
var widthIni = 700; 
// Number of links multiplied by 2; 2 because we will be reducing the padding by multiples of 2px total, 1px left, 1px right
var linkQ = 5*2; 

// Current width of link container
var twelveWidth = $(".row .twelvecol").width(); 
// (Initial width / 10) - (Current width / 10); this gives us how much to subtract from our inital padding of 39
// Is there anything wrong with the way this is written?
var paddingSub = (widthIni/linkQ)-(twelveWidth/linkQ); 
// Simply subtracting above computation from our inital padding of 39
var paddingNew = paddingIni-paddingSub;

$("ul li a").css("padding-left",paddingNew);
$("ul li a").css("padding-right",paddingNew); 
```

此外，如果有人不介意解释为什么这不起作用，这是我尝试在一个等式中完成所有操作：

```
var whyisthiswrong = 39 - ( (700/(5*2)) / ($(".row .twelvecol").width()/(5*2)) ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:26:23.357

在 HTML 部分，如果您打算只有一个水平导航，我会确保它有一个 id。我也不认为这是必要的：

```
<div class='twelvecol'><ul>...</ul></div> 
```

你可以通过做同样的事情

```
<ul id='hmenu' class='twelvecol'>...</ul> 
```

CSS 明智的做法是确保您的未排序列表具有显示块或内联块（因为它是水平的，因此是内联的）。如果我是正确的，这样你也可以摆脱列表项上的 CSS hack。

根据这篇文章[在调整窗口大小时自动调整文本大小（字体大小）？](https://stackoverflow.com/questions/2989950/auto-resize-text-font-size-when-resizing-window) 对于触发窗口调整大小的 jQuery 部分，请使用：

```
$(function() {
    // trigger once dom is ready
    resizeMe();
    // trigger on window resize
    $(window).bind('resize', function()
    {
        // your resize function
        resizeMe();
    }).trigger('resize');
});

var resizeMe = function(){
    // your stuff here
}; 
```

您可以使用 JSON 参数字符串或仅在填充时一次性调整 CSS：

```
$("#hmenu li a").css("padding", "12px " + paddingNew + "px 12px " + paddingNew + "px"); 
```

或者

```
$("#hmenu li a").css({"padding-left": paddingNew, "padding-right": paddingNew}); 
```

不确定 px 连接。可能没有必要。

添加了 jsfiddle，您可以使用“结果窗口”大小来查看会发生什么：http: [//jsfiddle.net/tive/tKDjg/](http://jsfiddle.net/tive/tKDjg/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T04:50:56.147

**参考：** [**jsFiddle**](http://jsfiddle.net/WcLPd/)

我已经编辑了您的 jsFiddle，并在添加/删除的项目上提供了评论，以使您的流畅导航菜单能够正常工作。

值得注意的是，我使用`white-space: nowrap;`了 on `.container`、删除`min/max width`了 on `.row`，并使用了 jQuery`.resize();`侦听器来处理导航栏的动态更新。

* * *

***修订：*** **状态更新：**    [**jsFiddle 较新的方法（教程）**](http://jsfiddle.net/wRWXK/)

我从*不同的角度*接近了你的目标。我没有使用您不想要***的东西（盒装面包屑***），而是正面解决了填充分配问题（***从外到内***）。

**注意：** *演示了**面包屑导航**按钮。***

**下面是我使用的过程：**
**1.**创建 HTML 布局，在一行中包含所有面包屑。没有填充，没有边距，只有原始链接。
**2.**接下来，以**像素为单位测量****剩余**空间。这将是可用的**总填充**。**3.**在 HTML 导航标记中，动态计算使用的***填充跨度***数。**4.**可用的**总填充**除以***填充跨度***。这成为**共享部分**。 **5.*****设置***可用**总填充**的共享**部分** *********************`page load`开窗事件`resize`。********************* 

 *******一旦您看到代码，这种方法就很容易理解，并且可以轻松更改或自定义调整而无需大惊小怪。包括扩展注释。在 Chrome、Firefox、IE8 中测试没有问题。

**jQuery高度优化的版本：**

```
function fluidNavBar(){
    $('.breadcrumbPadding').css('width',0);
    if($('.links').width() < $('body').width()){
        $('.breadcrumbPadding').css('width', $('.navPaddingTotal').width() / $('.breadcrumbPadding').size());
    }
}

// RUN ON PAGE LOAD
window.onload = function() {
    $('.navBar').css('min-width', $('.links').width());
    fluidNavBar();
};

// RUN ON WINDOW RESIZE
$(window).resize(function() {
    fluidNavBar();
}); 
```

在更新后的 jsFiddle 中，您将看到之前的**导航栏**，它现在固定在底部以进行比较。

***选择你的口味：***
[**jQuery 原创教程**](http://jsfiddle.net/wRWXK/)
[**jQuery 无注释**](http://jsfiddle.net/wRWXK/1/)
[**jQuery 代码高度优化**](http://jsfiddle.net/wRWXK/2/)
[**jQuery 原创教程 + 风格**](http://jsfiddle.net/wRWXK/3/)

[**jQuery 这就是你真正想要的 Demo**](http://jsfiddle.net/wRWXK/6/)
[**jQuery 这就是你真正想要的 Demo（因为它很大并且自动居中）**](http://jsfiddle.net/wRWXK/7/)*******

# c - 需要帮助理解这个逻辑表达式 !!i + !j

> ID：11514127
> 
> 赞同：1
> 
> 时间：2012-07-16T23:37:42.727
> 
> 标签：c

> **可能重复：**
> [C 中的双重否定：是否保证返回 0/1？](https://stackoverflow.com/questions/8617090/double-negation-in-c-is-it-guaranteed-to-return-0-1)

```
int main(void)
{
  int i = 2, j = 1;

  printf("%d", !!i +!j);
  return 0;
} 
```

据我了解，！！将表达式转换为布尔值，所以它是说因为 i 不等于 2 值是 0 + j 不等于 1 值是 0，并且由于 0 等于 false 它读取： false + false = true which代表1的值。请帮助我是C编程的新手。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T23:39:44.410

C 没有布尔类型（好吧，C99 和更新版本有，但您的程序中没有使用它）。

`!`只是一个一元运算符，它变成`0`和`1`其他任何东西变成`0`. 所以在你的情况下，因为`i`is `2`、`!i`is`0`和`!!i`is `1`。 `j`是`1`，所以`!j`是`0`。剩下`!!i + !j`的就是`1 + 0`，你正在打印`1`。试试这个示例程序来看看它的实际效果：

```
#include <stdio.h>

int main(void)
{
    int i = 2, j = 1;

    printf("i = %d, j = %d\n", i, j);
    printf("!i = %d, !!i = %d\n", !i, !!i);
    printf("!j = %d\n", !j);
    printf("!!i + !j = %d + %d = %d\n", !!i, !j, !!i + !j);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:40:24.900

`!x`如果`x`为真（即不等于 0）则为 0，如果`x`为假（即等于 0）则为 1。由于您的示例`i`为 2，因此将为`!i`0，因此`!!i`将为 1。同样`!j`为 0。因此表达式的结果将为`1 + 0 = 1`。

请注意，在任何情况下`0 + 0`（即 false + false）都不会等于 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:42:09.707

以下是规范中关于`!`运营商的说明（C99 §6.5.3.3/5）。简洁的最后一句话是理解其行为所真正需要的：

> 逻辑否定运算符的结果`!`是`0`如果其操作数的值比较不等于`0`，`1`如果其操作数的值比较等于`0`。
> 
> 结果有类型`int`。
> 
> 表达式`!E`等价于`(0==E)`。

我们可以使用第三句的转换来评估您的表达式，`!!i + !j`。变换变为：

```
(0 == (0 == i)) + (0 == j) 
```

我们可以如下评估它：

```
(0 == (0 == 2)) + (0 == 1) // substitute the variable values
(0 == (0     )) + (0 == 1) // 0 == 2 is false, so it becomes 0
(0 == (0     )) + (0     ) // 0 == 1 is false, so it becomes 0
(1            ) + (0)      // 0 == 0 is true, so it becomes 1
 1                         // 1 + 0 is 1 
```

# javascript - 与 div 元素一起使用时未定义 appendChild 方法

> ID：11514131
> 
> 赞同：2
> 
> 时间：2012-07-16T23:38:22.683
> 
> 标签：javascript, dom, append

我真的是 Javascript 的初学者，并试图在这个 HTML的元素中添加一个`p`元素：`div`

```
<!doctype html>
<html>
    <head>
    </head>

    <body>
        <p>This is paragraph 1.</p>
        <p>This is paragraph 2.</p>
        <p>This is paragraph 3.</p>
        <p>This is paragraph 4.</p>
        <div>
            <p id="foo">This is paragraph 5.</p>
        </div>
        <script type="text/javascript" src="script.js"></script>
    </body>

</html> 
```

使用此代码：

```
(function(){
    var divElement = document.getElementsByTagName("div");
        el = document.createElement("p");
        content = document.createTextNode("This is text");    
    el.appendChild(content);
    document.divElement.appendChild(el);        
}()); 
```

但我在第 6 行收到此错误：

> 未捕获的类型错误：无法调用未定义的方法“appendChild”

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T23:40:20.980

`getElementsByTagName(" ... ")`返回元素的集合。

```
var divElement = document.getElementsByTagName("div")[0]; 
```

另外，改变：

```
document.divElement.appendChild(el); 
```

到：

```
divElement.appendChild(el); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:46:40.660

您的变量名称之一有点误导，即`divElement`. 由于您使用的是`getElementsByTagName()`(notice `elements`)，它将返回一个元素列表，而不是单个元素。因此，您应该为变量命名`divElements`以减少混淆。

我已修改您的代码以使用元素列表：

```
(function() {
    var divElements = document.getElementsByTagName("div");
    var el = document.createElement("p");
    var content = document.createTextNode("This is text");

    el.appendChild(content);

    for (var i = 0; i < divElements.length; i++) {
        divElements[i].appendChild(el);
    }
}());​ 
```

还有一个演示：http: [//jsfiddle.net/UmKYq/5/](http://jsfiddle.net/UmKYq/5/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-06-02T07:40:34.313

```
var div =  document.createElement("div");

document.lastChild.appendChild(div);

var a=[];

var n=[];

var txt=["Lovey", "komal", "Sona", "Purvi", "Sanchi"];

for (i=0; i<=txt.length; i++)

{
    a[i]=document.createElement("a");

    a[i].setAttribute("href","#");

    n[i].appendChild(n[i]);

    div.appendChild(n[i]);

    div.appendChild(a[i]);   

} 
```

# cryptography - signing using RSA private key Windows cryptographic API

> ID：11514132
> 
> 赞同：0
> 
> 时间：2012-07-16T23:38:26.107
> 
> 标签：cryptography, rsa, microsoft-metro, signing

I am working on a metro app and working on signing an Oauth request for a Google application. I am unable to Import my keypair properly into the JS code . The same problem has been asked here but still unresolved- [http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/d599ff36-75f2-4393-af10-60beb1842ece](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/d599ff36-75f2-4393-af10-60beb1842ece) I have my key in the format "---START PRIV KEY---MIC898 blah blah ----END PRIV KEY--".

When I try to import it into my code using ImportKeyPair function, I get an exception that

> "there was a problem at time of encoding or decoding".

I am getting my key using openSSL "rsagen" tool which I believe gives a pair of Private and Public key.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T21:32:11.293

Try converting your PEM formatted RSA keys to DER first using `openssl rsa <arguments>`.

# grails - 如何在同一台机器上运行两个 grails 应用程序并让它们不共享 rabbitMQ

> ID：11514133
> 
> 赞同：1
> 
> 时间：2012-07-16T23:38:26.897
> 
> 标签：grails, rabbitmq, grails-plugin-rabbitmq

我有一个使用单个兔子节点运行的 grails 应用程序。太好了。我想在不同端口上的同一台机器上再次启动同一个应用程序。目前，这两个应用程序都回答了这两个应用程序的工作。我希望他们的兔子独立。确保每个应用程序只响应它发送的消息的最简单方法是什么？多个兔子队列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T11:22:35.683

[您可以在grails 配置](http://grails-plugins.github.com/grails-rabbitmq/docs/manual/guide/configuration.html)中提供一个虚拟主机条目：

```
rabbitmq.connectionfactory.virtualHost  The name of the virtual host to connect to 
```

在 RabbitMQ 中定义两个不同的虚拟主机，每个 grails 应用程序都有自己的配置区域供使用。通过一个 vhost 发送的消息将仅在该 vhost 上可用，有效地分离了两个 grails 应用程序，而无需更改队列设置或每个应用程序的其他内部部分 - 只是连接的配置。

请记住，[访问控制是基于每个虚拟主机执行的](http://www.rabbitmq.com/access-control.html)，因此您必须授予用户对 rabbitmq 中每个虚拟主机的访问权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T13:02:04.903

正如@fiskfisk 所说，多个虚拟主机是一种选择，如果您有一组复杂的队列、交换和绑定，它会特别好用。为第二个应用程序使用新的虚拟主机有一些缺点，包括访问控制管理的重复，以及一些较小的性能开销。

如果您有一个相当简单的队列/交换/绑定设置，我建议将第二个应用程序指向一个具有不同名称的队列，或者让您的应用程序能够在运行时配置为使用不同的队列，或者利用RabbitMQ 中基于主题的路由，并让每个应用程序使用特定于应用程序的前缀（或类似的前缀）标记它们的消息。

使用主题路由来区分应用程序的一个优点是，您可以轻松地深入了解完整的消息流，并使用该流执行您最初没有预见到的其他事情，包括归档日志记录或审计日志记录以及其他指标收集或分析。

* * *

tl;博士;

为了长期的灵活性，让您的应用程序的每个实例都根据主题路由将消息发送到队列。

对于快速和肮脏/昨天得到它的工作，为您的应用程序的每个实例使用单独的虚拟主机。

# php - 是否有用于执行 MS SQL 数据库最常见功能的 PHP 类？

> ID：11514134
> 
> 赞同：2
> 
> 时间：2012-07-16T23:38:49.793
> 
> 标签：php, sql-server, sql-server-2008

在我开始编写要连接的函数、从我的 MS SQL 数据库中检索行之前，我想知道是否已经有一个公开可用的类将这个功能包装到一个类对象中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:43:37.933

就在这里。你可以只使用 PHP 的[PDO 类](http://www.php.net/manual/en/book.pdo.php)。有一个 PDO[驱动程序可用于 MS SQL](http://www.php.net/manual/en/ref.pdo-sqlsrv.php)服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:47:57.063

像这样的东西？ [SQL PHP 类](http://mogames.com.br/class_sql.txt "SQL PHP 类")

# spring - Spring嵌套事务 标记为rollbackonly，带有未经检查的异常

> ID：11514136
> 
> 赞同：1
> 
> 时间：2012-07-16T23:38:58.877
> 
> 标签：spring, hibernate, transactions

我对 Spring 和事务还很陌生。我确信这个问题之前已经被问过，但我仍然无法找到正确的方法来解决这个问题。

我正在使用 Spring 和休眠。我有一个这样的服务方法：

```
@Transactional
public void processPendingReport(Report report) {
  try {
    // Do processing stuff, update report object state
    reportDAO.save(report);
  } catch (Exception e) {
    reportDAO.markReportAsFailed(report);
  }
} 
```

如果在处理过程中发生 RuntimeException，则会抛出“事务标记为 rollbackOnly”RollbackException，因此报告不会被标记为失败（尽管我希望如此）。

我试过使用@Transactional(noRollbackFor=Exception.class)，但仍然遇到同样的问题。有什么建议吗？会不会是配置问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-17T06:48:53.157

如果发生数据库异常（例如违反约束），`reportDAO.save()`或者`reportDAO.markReportAsFailed()`无论您在应用程序级别做什么，事务都将在数据库级别回滚。

`reportDao.save()`如果为 .创建新事务时失败，您仍然可以将报告标记为失败`reportDAO.markReportAsFailed()`。由于`ReportDAO`已注释`@Transactional`，只需`@Transactional`从服务方法中删除注释。您还可以更改`reportDAO.save()`实现以使用包装插入语句并捕获数据库级别的任何异常的数据库函数或存储过程。

HTH。

# php - PHP PDO-MYSQL：如何跨不同类使用数据库连接

> ID：11514143
> 
> 赞同：4
> 
> 时间：2012-07-16T23:39:44.460
> 
> 标签：php, mysql, class, pdo

我对使用 MYSQL 的 PDO 有点陌生，这是我的两个文件：

我有一个用于连接数据库的连接类：

```
class connection{

private $host = 'localhost';
private $dbname = 'devac';
private $username = 'root';
private $password ='';  

public $con = '';

function __construct(){

    $this->connect();   

}

function connect(){

    try{

        $this->con = new PDO("mysql:host=$this->host;dbname=$this->dbname",$this->username, $this->password);
        $this->con->setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION);

    }catch(PDOException $e){

        echo 'We\'re sorry but there was an error while trying to connect to the database';
        file_put_contents('connection.errors.txt', $e->getMessage().PHP_EOL,FILE_APPEND);

    }
}   
} 
```

我有一个 account_info 类，用于从数据库中查询数据：

```
class account_info{

function getAccountInfo(){

    $acc_info = $this->con->prepare("SELECT * FROM account_info");
    $acc_info->execute();

    $results = $acc_info->fetchAll(PDO::FETCH_OBJ);

    foreach ($results as $key) {
        $results->owner_firstname;

    }
}       

} 
```

我将这两个文件都包含在我的 index.php 页面中：

```
include_once 'classes/connection.class.php';
include_once 'classes/accountinfo.class.php';

$con = new connection();
$info = new account_info();
$info->getAccountInfo(); 
```

我只是无法让它工作我没有得到任何输出，我认为它与范围有关，但我不知道为什么要修复它，因为我是这个 PDO 和 OOP 的新手。提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T23:46:46.757

**解决方案 1**

替换`class account_info {`为`class account_info extends connection {`

代替

```
$con = new connection();
$info = new account_info(); 
```

和

```
$info = new account_info(); 
```

它应该可以工作。

**解决方案 2（建议）**

在这种情况下，我强烈建议您使用依赖注入来解决您的问题。只需将您的帐户类替换为：

```
class account_info {

    private $con;

    public function __construct(connection $con) {
        $this->con = $con->con;
    }

    public function getAccountInfo(){

        $acc_info = $this->con->prepare("SELECT * FROM account_info");
        $acc_info->execute();

        $results = $acc_info->fetchAll(PDO::FETCH_OBJ);

        foreach ($results as $key) {
            $results->owner_firstname;
        }
    }       

} 
```

并像这样在 index.php 中使用它：

```
include_once 'classes/connection.class.php';
include_once 'classes/accountinfo.class.php';

$con = new connection();
$info = new account_info($con);
$info->getAccountInfo(); 
```

**解释**

作为一般的好规则：始终为函数（公共、受保护或私有）指定范围关键字。

第一个解决方案称为继承，我们基本上所做的就是使用连接类扩展帐户类，以便从连接类继承所有方法和属性并轻松使用它们。在这种情况下，您必须注意命名冲突。我建议你看一下PHP手册中的类继承。

The second solution is called dependency injection and it is a wildly encouraged design pattern that makes your classes accept other classes in their constructor in order to explicitly define the class dependency tree (in this case account depend from connection and without the connection we can't make account work).

Another, of thousands of possible solution, would be the one that someone posted below which is a design pattern called Singleton. However that patter has been reevaluated recently as anti-pattern and should not be used.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T23:44:47.693

`singleton`一种常见的方法是在数据库类中使用模式。

像这样的东西：

```
class connection {

   private static $hInstance;

   public static function getInstance() {
     if (!(self::$hInstance instanceof self)) {
         self::$hInstance = new self();
     }

     return self::$hInstance;
   }

   /* your code */
} 
```

然后，您可以简单地使用

```
$database = connection::getInstance(); 
$database->con->prepare(....) 
```

ETC

# ruby-on-rails - 渲染连接数组以显示 Rails 错误

> ID：11514145
> 
> 赞同：0
> 
> 时间：2012-07-16T23:39:50.753
> 
> 标签：ruby-on-rails

在导致 rails 错误时遇到一些问题。主要问题是在视图中错误显示一个数组输出并且没有连接在一起（用户友好）。我可以在视图中添加“join”方法，这将在具有多个错误的属性上正常工作。虽然如果属性只包含 1 个错误，这自然会中断。

因此，我目前正在尝试将错误加入控制器中，这样如果属性上有多个错误，它看起来会很漂亮。尝试在视图中添加 .join 方法不起作用，因为在有 1 个错误的实例上它会中断（因为您不能在字符串上调用 join 方法）

如何在控制器中进行这项工作的任何帮助都会很棒。有关处理此问题的另一种方法的任何建议也很棒。（从我试图像这样在控制器中美化/加入数组错误的逻辑）

控制器：

```
if @person.errors.blank? && @person.save
  flash[:info] = "Your profile has been successfully updated."
  redirect_to profile_url(@person) and return
else
  if @person.errors.on(:first_name).is_a?(Array)
    @person.errors.on(:first_name).join
  end
  flash[:warning] = "Sorry, there was a problem saving your profile. Please try again."
  render :edit
end 
```

看法：

```
%li
        = label(:person, :first_name, "First Name")
        = f.text_field :first_name
        - if @person.errors[:first_name].present?
          %span{:style => "color: red; margin-left: 180px;"}=   @person.errors[:first_name] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:09:00.420

您可以简单地使用该`to_a`方法。它转换数组中的字符串，它对数组什么都不做。

您应该像这里一样创建一个自定义验证器：http: [//guides.rubyonrails.org/active_record_validations_callbacks.html#performing-custom-validations](http://guides.rubyonrails.org/active_record_validations_callbacks.html#performing-custom-validations)。

之后，您可以像这样重构您的代码

```
if @person.save
  flash[:info] = "Your profile has been successfully updated."
  redirect_to profile_url(@person)
else
  @person.errors[:first_name] = @person.errors.on(:first_name).to_a.join
  flash[:warning] = "Sorry, there was a problem saving your profile. Please try again."
  render :edit
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:09:37.703

堆叠它们！

```
if @person.errors.present?
  @person.errors.each do |err|
    = err 
```

或者阅读这篇上一篇文章，以一种非常丰富多彩的方式来定制错误：

[Rails 验证错误消息：每个字段仅显示一条错误消息](https://stackoverflow.com/questions/2569401/rails-validation-error-messages-displaying-only-one-error-message-per-field)

# twitter - Twitter BS - 开启课程 当轮播发生变化时

> ID：11514147
> 
> 赞同：0
> 
> 时间：2012-07-16T23:40:07.113
> 
> 标签：twitter, twitter-bootstrap

我正在使用 Twitter Bootstrap 构建一个使用轮播的作品集。我使用以下方法导航到轮播中的某些元素：

```
<ul id="portfolionav" class="nav nav-pills">
<li class="" id="carousel-ux"><a href="#myCarousel" data-toggle="pill">UX | UI</a></li>
<li class="" id="carousel-vd"><a href="#myCarousel" data-toggle="pill">Visual Design</a></li>
<li class="" id="carousel-web"><a href="#myCarousel" data-toggle="pill">Web</a></li>   
<li class="" id="carousel-mobile"><a href="#myCarousel" data-toggle="pill">Mobile</a></li>
<li class="" id="carousel-corpid"><a href="#myCarousel" data-toggle="pill">Identity</a></li> 
```

我要做的是在到达轮播中的特定元素时在 LI 标签上应用活动类。例如，当轮播滑动到元素 #5 时，活动类需要应用于“移动”LI 标签，并从任何其他 LI 标签中删除。

谁能给我一个关于如何做到这一点的想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:34:50.790

根据我在这里找到的帖子，我一直在玩类似的想法：http: [//forrst.com/posts/Adding_pagination_to_bootstrap_carousel-ULn](http://forrst.com/posts/Adding_pagination_to_bootstrap_carousel-ULn)

我在这里的实现，带有幻灯片标题而不仅仅是项目符号：

[http://jsfiddle.net/64qK2/](http://jsfiddle.net/64qK2/)

通过调整 javascript，您可以在 LI 项目而不是链接上设置活动类，并添加导航样式。

/标记

# php - 无法通过 Shopify API 帖子创建自定义产品集合

> ID：11514149
> 
> 赞同：1
> 
> 时间：2012-07-16T23:40:15.577
> 
> 标签：php, shopify

我正在尝试使用 Sandeep Shetty 的 shopify.php 创建自定义产品集合。我已经能够进行其他功能性 API 调用 - 显示产品和购物车等。但我无法使用产品 ID 的“已知良好”列表创建自定义集合。这是我的代码：

```
$charge = array
    (
        "custom_collection"=>array
        (
            "title"=>"ThisTest",
            "collects"=>array(
                "product_id"=>96525818,
                "product_id"=>96393246
            )
        )
    );
    try
    {
        // All requests accept an optional fourth parameter, that is populated with the response headers.
        $my_collect = $shopify('POST', '/admin/custom_collections.json', $charge, $response_headers);

        // API call limit helpers
        echo shopify_calls_made($response_headers); // 2
        echo shopify_calls_left($response_headers); // 298
        echo shopify_call_limit($response_headers); // 300

    }
    catch (ShopifyApiException $e)
    {            
        echo "doh";
        print_r($e);
    }

} 
```

我收到以下错误。

```
ShopifyApiException Object 
```

( [info:protected] => Array ( [method] => POST [path] => /admin/custom_collections.json [params] => Array ( [custom_collection] => Array ( [title] => ToddTest [collects] => 数组（[product_id] => 96393246）

```
 )

            )

        [response_headers] => Array
            (
                [http_status_message] => Internal Server Error
                [http_status_code] => 500
                [server] => nginx
                [date] => Mon, 16 Jul 2012 23:23:45 GMT
                [content-type] => application/json; charset=utf-8
                [transfer-encoding] => chunked
                [connection] => keep-alive
                [status] => 500 Internal Server Error
                [x-shopify-shop-api-call-limit] => 18/500
                [http_x_shopify_shop_api_call_limit] => 18/500
                [cache-control] => no-cache
                [x-request-id] => f22337df8773ff4fa2f9f384ca21f133
                [x-ua-compatible] => IE=Edge,chrome=1
                [set-cookie] => _secure_session_id=50f46da87f21f8a1b458baaf8e97a30a; path=/; secure; HttpOnly
                [x-runtime] => 0.307888
            )

        [response] => Array
            (
                [errors] => Error
            )

    )

[message:protected] => Internal Server Error
[string:Exception:private] => 
[code:protected] => 500
[file:protected] => /home/lolsmg/www/shopify_pinterest/shopify.php
[line:protected] => 32
[trace:Exception:private] => Array
    (
        [0] => Array
            (
                [file] => /home/lolsmg/www/shopify_pinterest/pintrest_ui.php
                [line] => 65
                [function] => {closure}
                [args] => Array
                    (
                        [0] => POST
                        [1] => /admin/custom_collections.json
                        [2] => Array
                            (
                                [custom_collection] => Array
                                    (
                                        [title] => ToddTest
                                        [collects] => Array
                                            (
                                                [product_id] => 96393246
                                            )

                                    )

                            )

                        [3] => Array
                            (
                                [http_status_message] => Internal Server Error
                                [http_status_code] => 500
                                [server] => nginx
                                [date] => Mon, 16 Jul 2012 23:23:45 GMT
                                [content-type] => application/json; charset=utf-8
                                [transfer-encoding] => chunked
                                [connection] => keep-alive
                                [status] => 500 Internal Server Error
                                [x-shopify-shop-api-call-limit] => 18/500
                                [http_x_shopify_shop_api_call_limit] => 18/500
                                [cache-control] => no-cache
                                [x-request-id] => f22337df8773ff4fa2f9f384ca21f133
                                [x-ua-compatible] => IE=Edge,chrome=1
                                [set-cookie] => _secure_session_id=50f46da87f21f8a1b458baaf8e97a30a; path=/; secure; HttpOnly
                                [x-runtime] => 0.307888
                            )

                    )

            )

    )

[previous:Exception:private] => 
```

) 我正在使用 shopfiy 提供的示例代码，但并没有走得太远。感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:23:43.640

检查日志，看起来“collects”属性实际上并未作为您在 $charge 变量中指定的数组发送。查找 request_id f22337df8773ff4fa2f9f384ca21f133 后，这是您发送的请求：

```
{"custom_collection"=>{"title"=>"ToddTest", "collects"=>{"product_id"=>96393246}}} 
```

该请求应该看起来像这样才能工作：

```
{"custom_collection"=>{"title"=>"ToddTest", "collects"=>[{"product_id"=>96393246}]}} 
```

请注意，这`collects`是一个数组。

# c - 迭代 C 字符串不起作用

> ID：11514152
> 
> 赞同：1
> 
> 时间：2012-07-16T23:40:24.737
> 
> 标签：c, string, iteration

首先，我对这段代码的目标是：将一个句子转换成一个 C 字符串。遍历句子并查看特定字母出现了多少实例。

这段代码有点作用，但没有给出正确的数字？不知道为什么：

```
#include <stdio.h>
#include <string.h>

int tracker=0;
int letterCount (char *sentence)
{
    int s=strlen(sentence);
    int i=0;

    for (i=0; i<s; i++){
        if (sentence[i]=='h') {
            tracker++;
        }
    }
    return tracker;
}

int main(int argc, const char * argv[])
{

    char *string="Hi there, what's going on? How's it going?";

    letterCount(string);

    printf("this sentensce has %i H's", tracker);

    return 0;
} 
```

我得到的输出：

```
this sentensce has 2 H's 
```

不太对。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:43:56.243

如果您的意思是不区分大小写的 H，那么这是正确的代码：

```
#include <stdio.h>
#include <string.h>

int tracker=0;
int letterCount (char *sentence)
{
    int s=strlen(sentence);
    int i=0;

    for (i=0; i<s; i++){
        if (sentence[i]=='h' || sentence[i]=='H') {  //'h' is not the same as 'H'
            tracker++;
        }
    }
    return tracker;
}

int main(int argc, const char * argv[])
{

    char *string="Hi there, what's going on? How's it going?";

    letterCount(string);

    printf("this sentensce has %i H's", tracker);

    return 0;
} 
```

您刚刚在代码中拼错了 small 和大写字母。请记住，C 语言区分大小写！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:44:12.663

尽管您的标签谈到了`H`s 的数量，但您却在`letterCount`寻找`h`s ——在我看来，您提供的输入确实有两个小写实例`h`，正如它所说的那样。

如果您想将它们一起计算，您可以考虑在检查您拥有的内容之前`tolower`或之前过滤每个输入。`toupper`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:45:03.327

这个数字在我看来是正确的：那句话中有 2 个“h”字符。如果您还想计算“H”字符，则需要单独检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T03:50:19.097

```
size_t letterCount(const char* sentence, char c)
{
  size_t count = 0;

  while(sentence)
  {
    count += (*sentence == c);
    ++sentence;
  }

  return count;
} 
```

我们在这里看到了什么？

*   你不能有负数，所以使用像 size_t 这样的无符号类型
*   句子不应该被修改，所以它应该是 const
*   传入要匹配的字符
*   句子是一个指针，如果它是空的，你就完成了。不需要调用 strlen。
*   句子是指针，实际指针是传值的，所以可以修改（看增量，不用多做变量）
*   布尔运算符返回 1 或 0，因此无需使用 if。（虽然，我还没有查看程序集以查看 if 分支或 add 0 是否更便宜。YMMV）

# c# - radtextbox 验证 url

> ID：11514160
> 
> 赞同：0
> 
> 时间：2012-07-16T23:41:17.963
> 
> 标签：c#, asp.net, telerik, radtextbox

我有一个 radtextbox，我想提示用户输入一个 URL，是否存在一个属性来验证 radtextbox 中的这个输入？如果没有，我可以使用什么来允许用户输入 url？

我将不胜感激有关此事的任何建议。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:24:52.153

因为他们使用文本框并使用 JavaScipt 分配掩码

ASP_BUTTON

```
<asp:TextBox runat="server" ID="txtOrigeenHup" CssClass="mycssMascara" Width="390px" 
     TextMode="MultiLine" Text='<%# Eval("urlOrigen") %>' 
     onfocus="OnFocus(this.id,'http://paginaEjemplo.com')" 
     onblur="OnBlur(this.id,'http://paginaEjemplo.com')">http://paginaEjemplo.com asp> 
```

JAVASCRIPT

```
 function OnFocus(elementId, defaultText) {
if (document.getElementById(elementId).value == defaultText) {
    document.getElementById(elementId).className = "mycssMascara";
    document.getElementById(elementId).value = "";
}}
  function OnBlur(elementId, defaultText) {
var textValue = document.getElementById(elementId).value;

if (textValue == defaultText || textValue.length == 0) {
    document.getElementById(elementId).className = "mycssMascara";
    document.getElementById(elementId).value = defaultText;
}
else
    document.getElementById(elementId).className = "mycss";  } 
```

CSS

```
 .mycssMascara
{
 font-weight: normal; color: #808080; background-color: #FFFFFF; border: 1px solid #C0C0C0; letter-spacing: 0pt; word-spacing: 1pt; font-size: 14px; text-align: left; font-family: arial, helvetica, sans-serif; line-height: 1; margin: 4px; padding: 6px;
}

.mycss
{ font-weight: normal; color: #000000;  background-color: #FFFFFF; border: 1px solid #C0C0C0; letter-spacing: 
0pt;  word-spacing: 1pt; font-size: 14px; text-align: left; font-family: arial, helvetica, sans-serif; line-height: 1; margin: 4px;  padding: 6px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-20T20:58:15.563

使用输入类型

> 截至 2011 年第三季度，RadTextBox 支持新的 HTML5 输入类型

例子：

```
<telerik:RadTextBox ID="txt1" runat="server" RenderMode="Lightweight" Label="Image Url: " MaxLength="100" ToolTip="Put URL ..." InputType="Url" /> 
```

# gcc - 设置起始地址以执行原始二进制文件

> ID：11514162
> 
> 赞同：4
> 
> 时间：2012-07-16T23:41:22.633
> 
> 标签：gcc, x86, linker, bootloader, osdev

引导加载程序分为 2 个阶段。第一阶段是用汇编编写的，只加载第二阶段，第二阶段是在 C 中。Stage1 将 C 中的代码加载到地址 0x0500:0，然后跳转到那里。Stage2 必须写“hello message”并停止。

我尝试了不同的方法来将起始地址设置为原始二进制文件：（但没有任何效果）

```
cc -nostartfiles -nostdlib -c stage2.c
ld -s -T scrptfile.ld stage2.o /* I'm using ld just to set starting address of executable */
objcopy -O binary stage2 stage2.bin /* delete all unuseful data  */ 
```

链接器脚本

```
SECTIONS
{
    . = 0x0500;
    .text : { *(.text)}
    .data : { *(.data)}
    .bss : { *(.bss)}
} 
```

也许我用 objcopy 删除了不应该删除的东西。

那我该如何执行这个 stage2.bin 呢？

据我了解，使用 32 位长度指令编写的 C 代码，而原始二进制文件只允许 16 个？

PS 参数 -set-start (objcopy) 返回错误：无效的 bfd 目标。是因为输出文件是二进制的吗？

* * *

谢谢你的回答。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T10:41:48.353

`. = 0x0500`不对应`0x0500:0`。`0x0500:0`是物理地址`0x5000`，不是`0x500`。

此外，如果您尝试将 C 代码编译为 32 位并在实模式（即 16 位）下运行，它将无法工作。您需要将代码编译为 16 位或将 CPU 切换到 32 位保护模式。没有那么多 C 编译器仍在编译 16 位代码。Turbo C++ 是一个，Open Watcom 是另一个。AFAIK，gcc 不能那样做。

最后，我猜您希望入口点位于 0x500:0（0x5000 物理位置）。您需要将此告诉链接器（我不记得如何，如果可能的话）或处理入口点的任意位置（即以某种方式从二进制文件中提取它）。

# java - EntityManagerFactory 中实体管理器的正确使用

> ID：11514163
> 
> 赞同：0
> 
> 时间：2012-07-16T23:41:29.980
> 
> 标签：java, jpa, eclipselink, entitymanager

在查询对象和/或删除/创建时，我在理解实体管理器的正确用法时遇到了一些麻烦。现在对于任何数据库事务，我有几个服务方法可以打开和关闭新的实体管理器，如下所示：

```
public static Long getCountApplicants(String active){

    EntityManager entityManager = factory.createEntityManager();
    long value = (Long) entityManager.createQuery("select count(distinct a) from    Applicant a  where a.active = " +active).getSingleResult();
    System.out.println("get count app query");
    entityManager.close();
    return value;
} 
```

既然我有一个 Java EE 应用程序，其中有一个定义我的单元的 persistence.xml 文件，为什么我不能从我的工厂声明一个并在我的应用程序的整个生命周期中使用它？仅使用其中一个对象是否存在任何性能或内存泄漏问题？

更新：

我正在使用以下堆栈，Spring Framework/JPA Eclipselink

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:32:06.460

长话短说：由于您使用的是 Spring，因此最好将实体管理器定义为 DAO 的属性，如下所示：

```
@PersistenceContext
EntityManager em; 
```

然后您的代码变为：

```
public static Long getCountApplicants(String active){
    long value = (Long) em.createQuery("select count(distinct a) from    Applicant a  where a.active = " +active).getSingleResult();
    System.out.println("get count app query");
    return value;
} 
```

这仅适用于非扩展持久性上下文。
Spring 注入的 EntityManager 将是线程安全的。
是否需要配置`LocalEntityManagerFactorBean`应用程序管理的实体管理器或`LocalContainerEntityManagerFactoryBean`容器管理的实体管理器只是 Spring 配置文件中的配置问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T02:05:46.323

EntityManager 在应用程序管理时通常不是线程安全的。

[http://docs.oracle.com/javaee/6/tutorial/doc/bnbqw.html](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqw.html)

但是，如果您使用的是容器管理版本，则应该如此。你会注入它：

```
@PersistenceContext
EntityManager entityManager; 
```

Spring 就是这样一个可以做到这一点的容器。上面的链接是一个有用的资源。

# php - 上传前检查文件大小

> ID：11514166
> 
> 赞同：35
> 
> 时间：2012-07-16T23:42:08.140
> 
> 标签：php, javascript, file-upload, image-uploading, filesize

我正在使用从这里获得的这个 javascript，它可以完美地满足我的需要。

```
var _validFileExtensions = [".jpg", ".jpeg"]; 

function File_Validator(theForm){
    var arrInputs = theForm.getElementsByTagName("input"); 
    for (var i = 0; i < arrInputs.length; i++) { 
    var oInput = arrInputs[i]; 
    if (oInput.type == "file") { 
        var sFileName = oInput.value; 
        var blnValid = false; 
            for (var j = 0; j < _validFileExtensions.length; j++) { 
                var sCurExtension = _validFileExtensions[j]; 
                if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) { 
                    blnValid = true; 
                    break; 
                    } 
                } 

                if (!blnValid) { 
                    alert("Invalid image file type!"); 
                    return false; 
                } 
        } 
    } 

return true; 
} 
```

现在，我想知道，此外，如果文件大于 500kb，我是否可以检查文件大小并失败 -> 在按下提交/上传按钮之前全部失败？

编辑

在查看了 PHPMyCoder 的建议后，我最终使用以下 javascript 代码解决了问题：

```
<script language='JavaScript'>
function checkFileSize(inputFile) {
var max =  3 * 512 * 512; // 786MB

if (inputFile.files && inputFile.files[0].size > max) {
    alert("File too large."); // Do your thing to handle the error.
    inputFile.value = null; // Clear the field.
   }
}
</script> 
```

这将检查文件大小，并在提交表单之前提醒用户。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-07-16T23:56:51.217

## 客户端上传取消

在现代浏览器（FF >= 3.6、Chrome >= 19.0、Opera >= 12.0 和 Safari 上的错误）上，您可以使用[HTML5 File API](http://www.html5rocks.com/en/tutorials/file/dndfiles/)。当文件输入的值发生变化时，此 API 将允许您检查文件大小是否在您的要求范围内。当然，这个，以及`MAX_FILE_SIZE`，都可以被篡改，所以总是使用服务器端验证。

```
<form method="post" enctype="multipart/form-data" action="upload.php">
    <input type="file" name="file" id="file" />
    <input type="submit" name="submit" value="Submit" />
</form>

<script>
document.forms[0].addEventListener('submit', function( evt ) {
    var file = document.getElementById('file').files[0];

    if(file && file.size < 10485760) { // 10 MB (this size is in bytes)
        //Submit form        
    } else {
        //Prevent default and display error
        evt.preventDefault();
    }
}, false);
</script> 
```

## 服务器端上传取消

在服务器端，不可能阻止 PHP 上传，因为一旦调用 PHP，上传就已经完成。如果您想节省带宽，您可以使用 ini 设置拒绝从服务器端上传[`upload_max_filesize`](http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize)。这样做的问题是这适用于所有上传，因此您必须选择适用于所有上传的自由的东西。的使用`MAX_FILE_SIZE`已在其他答案中讨论过。我建议[阅读它的手册](http://www.php.net/manual/en/features.file-upload.post-method.php#example-341)。请注意，它以及其他任何客户端（包括 javascript 检查）都可能被篡改，因此您应该始终进行服务器端 (PHP) 验证。

## PHP 验证

在服务器端，您应该验证文件是否在大小限制范围内（因为到目前为止，除了 INI 设置之外的所有内容都可能被篡改）。您可以使用[`$_FILES`](http://php.net/manual/en/reserved.variables.files.php)数组找出上传大小。（有关内容的文档`$_FILES`可以在[`MAX_FILE_SIZE`文档](http://www.php.net/manual/en/features.file-upload.post-method.php#example-341)下方找到）

**上传.php**

```
<?php
if(isset($_FILES['file'])) {
    if($_FILES['file']['size'] > 10485760) { //10 MB (size is also in bytes)
        // File too big
    } else {
        // File within size restrictions
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-05-22T07:26:24.483

我创建了一个 jQuery 版本的 PhpMyCoder 的答案：

```
$('form').submit(function( e ) {    
    if(!($('#file')[0].files[0].size < 10485760 && get_extension($('#file').val()) == 'jpg')) { // 10 MB (this size is in bytes)
        //Prevent default and display error
        alert("File is wrong type or over 10Mb in size!");
        e.preventDefault();
    }
});

function get_extension(filename) {
    return filename.split('.').pop().toLowerCase();
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-16T23:46:34.513

在浏览器中运行的 JavaScript 通常无法访问本地文件系统。那是在沙盒之外。所以我认为答案是否定的。

# json - BitTorrent KRPC 使用 BEncode 而不是 BSON 背后的原因是什么？

> ID：11514171
> 
> 赞同：5
> 
> 时间：2012-07-16T23:43:07.010
> 
> 标签：json, encoding, rpc, bittorrent, bson

在[BitTorrent](http://en.wikipedia.org/wiki/BitTorrent_protocol)中用于分发对等点列表的[Mainline DHT](http://en.wikipedia.org/wiki/Mainline_DHT)实现了一个称为 KRPC 的自定义 RPC 协议。KRPC 由 BEncoded 字典组成，它们本质上是一种更紧凑的 JSON 形式。

使用 BEncode 比 BSON （甚至只是压缩数据）有什么好处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T14:43:58.440

我怀疑这`bencode`是出于历史原因并减轻想要实现 DHT 扩展的开发人员的负担。由于所有 BitTorrent 客户端都必须有一个有效的`bencode`实现来处理 torrent 文件（它们只是元数据的编码字典），因此实现 DHT`bencode`不需要新的项目依赖项。

此外，请考虑 DHT`bencode`与二进制编码一起使用。其中，26 字节节点标识符字符串（20 字节用于节点 ID，6 字节用于 ipv4 地址/端口）被存储为二进制字符串（参见：[http ://bittorrent.org/beps/bep_0005.html #contact-encoding](http://bittorrent.org/beps/bep_0005.html#contact-encoding)），因此实际上已经发生了一些最小的数据压缩。

# c++ - 分配返回 0 时，具有空异常规范的运算符 new 调用构造函数

> ID：11514185
> 
> 赞同：4
> 
> 时间：2012-07-16T23:44:39.583
> 
> 标签：c++, g++, standards, new-operator

我有以下声明：

```
void * operator new (size_t s, PersistentMemory * m) throw()
   {return m->allocatePersistentMemory(s);} 
```

我正在测试启动时的内存耗尽，这会导致`m->allocatePersistentMemory(s);`返回 0。New 然后使用空指针调用构造函数`this`

但是，基于 C++ 2003 标准的 3.7.3.1 第 3 段：

> 分配存储失败的分配函数可以调用当前安装的 new_handler (18.4.2.2)，如果有的话。[注意：程序提供的分配函数可以使用 set_new_handler 函数 (18.4.2.3) 获取当前安装的 new_handler 的地址。] 如果使用空异常规范 (15.4) 声明的分配函数 throw() 未能分配存储，它应返回空指针。任何其他分配存储失败的分配函数只能通过抛出类 std::bad_alloc (18.4.2.1) 或从 std::bad_alloc 派生的类的异常来指示失败。

我理解事物的方式是`m->allocatePersistentMemory(s)`返回 null 应该导致整个`operator new() throw()`返回 null 而无需调用构造函数。我是否在其他地方遗漏了其他一些可以覆盖这一点的条件？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:32:09.503

C++03 标准的第 5.3.4 (13) 节说：

> [*注意*：除非使用空 *异常规范*（15.4）声明分配函数，否则通过抛出*bad_alloc*异常（条款15、18.4.2.1）`throw()`表示分配存储失败；否则它返回一个非空指针。如果分配函数声明为空*异常规范*, ，则返回 null 以指示分配存储失败，否则返回非空指针。] 如果分配函数返回null，则不进行初始化，不调用deallocation函数，*new-expression*的值为null。**`throw()`**

 ***短语“不应进行初始化”意味着不会调用构造函数。

有趣的是——除非我读错了规范——当你的分配函数指定`throw()`并返回 null 时，“new”本身的调用值是 null。[我一直认为这是不可能的（例如，请参阅Will new return NULL in any case? 中的](https://stackoverflow.com/questions/550451/)几乎所有答案？ ）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:43:35.980

我怀疑你没有打电话给`new`你认为你在打电话。

[这可以按您的预期工作。](http://ideone.com/Go3G3)

```
void *myalloc (size_t) { return 0; }
void * operator new (size_t s) throw() { return myalloc(s); }
struct Foo {
    std::string s;
    Foo () { std::cout << this << std::endl; }
};
int main () {
    Foo *f = new Foo;
    if (f == 0) std::cout << "f is NULL" << std::endl;
} 
```

在哪里，[这失败了。](http://ideone.com/2loA4)

```
void *myalloc (size_t) { return 0; }
void * operator new (size_t s) throw() { return myalloc(s); }
struct Foo {
    std::string s;
    Foo () { std::cout << this << std::endl; }
    void * operator new (size_t s) { return myalloc(s); }
};
int main () {
    Foo *f = new Foo;
    if (f == 0) std::cout << "f is NULL" << std::endl;
} 
```***

# php - 如何在 PHP 中转义 #

> ID：11514186
> 
> 赞同：2
> 
> 时间：2012-07-16T23:44:39.600
> 
> 标签：php, escaping

如何在 PHP 中转义**# ？**当我在查询中使用它时，它会将剩余的代码行变成注释。这就是我现在所拥有的：

```
$columns = "head1, #_search, #_stuff";
$result = mysql_query("SELECT $columns from table LIMIT $k,$j"); 
```

我不能只是在后面加上 escape **#**，`$columns`因为它只会变成评论。

~edit：是的，我可能应该直接复制代码，但其中一些是机密的，而且要复杂得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:48:08.983

你应该使用`quotes`你的字符串：

```
$columns = 'head1, #_search, #_stuff'; 
```

但是，这仍然没有多大意义。

也建议赞成`PDO`或 `mysqli`超过`mysql_*`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T23:49:27.740

尝试添加反斜杠

```
$columns = 'head1, \#_search, \#_stuff'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T23:49:07.350

它不应该是字符串文字吗？

```
$columns = 'head1, #_search, #_stuff' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T00:03:12.973

下面的呢？：

```
$columns = "head1, `#_search`, `#_stuff`"; 
```

您可以使用 `(backtick) 引用保留字。

如果要引用表/列名，可以执行以下示例：

```
 SELECT * FROM `#table1` WHERE `#table1`.`#column1` = 1; 
```

[参考](http://dev.mysql.com/doc/refman/5.0/en/identifiers.html)

# android - 提示：Apache Cordova 和 Android：无法实例化活动 ComponentInfo

> ID：11514193
> 
> 赞同：2
> 
> 时间：2012-07-16T23:45:34.187
> 
> 标签：android, apache, cordova, eclipse-adt

这个真的让我很紧张。在浏览了各种来源 2-3 天后，我找到了解决出现的常见问题的方法。

上下文基于使用 Android http://j.mp/MB1pTM 提供的 PhoneGap 演示。演示本身在使用 PhoneGap API 文档为 Android 4.0.3 进行精确设置时对我来说失败了。我收到以下错误消息：

```
07-16 23:01:58.485: E/AndroidRuntime(778): FATAL EXCEPTION: main
07-16 23:01:58.485: E/AndroidRuntime(778): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.test.shreyas.main/com.test.shreyas.main.HelloCordovaActivity}: java.lang.ClassNotFoundException: com.test.shreyas.main.HelloCordovaActivity
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1880)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.os.Looper.loop(Looper.java:137)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.ActivityThread.main(ActivityThread.java:4424)
07-16 23:01:58.485: E/AndroidRuntime(778):  at java.lang.reflect.Method.invokeNative(Native Method)
07-16 23:01:58.485: E/AndroidRuntime(778):  at java.lang.reflect.Method.invoke(Method.java:511)
07-16 23:01:58.485: E/AndroidRuntime(778):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-16 23:01:58.485: E/AndroidRuntime(778):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-16 23:01:58.485: E/AndroidRuntime(778):  at dalvik.system.NativeStart.main(Native Method)
07-16 23:01:58.485: E/AndroidRuntime(778): Caused by: java.lang.ClassNotFoundException: com.test.shreyas.main.HelloCordovaActivity
07-16 23:01:58.485: E/AndroidRuntime(778):  at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
07-16 23:01:58.485: E/AndroidRuntime(778):  at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
07-16 23:01:58.485: E/AndroidRuntime(778):  at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
07-16 23:01:58.485: E/AndroidRuntime(778):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1871)
07-16 23:01:58.485: E/AndroidRuntime(778):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T22:54:20.557

我的设置与@curlyreggie 相同。我通过执行以下操作使其工作：

右键单击 Cordova-2.4.jar -> 配置`Build Path`，然后在选项卡`Order and Export`中确保列表按以下顺序排列：

1.  Android（在我的例子中是 Android 3.0）
2.  安卓依赖
3.  科尔多瓦……
4.  ..../src
5.  ..../gen

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T23:45:34.187

要避免的愚蠢错误是**不在构建路径中链接外部库**。我配置`cordova-1.9.0.jar`为从存储的位置链接，并且应用程序每次都崩溃。

所以提示是， **始终将引用的库导入到您的 Eclipse 项目的单独文件夹中，例如 /libs，然后将其链接到您的构建路径**中，以避免这种混乱和时间浪费。

干杯!

# ruby-on-rails-3 - redirect_to :back 如果没有设置 HTTP_REFERRER

> ID：11514199
> 
> 赞同：2
> 
> 时间：2012-07-16T23:46:08.153
> 
> 标签：ruby-on-rails-3, redirect

我想redirect_to :back，但在某些情况下可能没有设置HTTP_REFERRER。在这些情况下，我想退回到 root_url。我正在尝试这样的事情：

```
redirect_to :back || root_url 
```

但这还不够。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:56:03.143

哦，明白了。我很接近：

```
redirect_to request.env['HTTP_REFERER'] || root_url 
```

# c - Variable arguements in macro using ellipsis

> ID：11514201
> 
> 赞同：1
> 
> 时间：2012-07-16T23:46:36.957
> 
> 标签：c

I want to define a macro accepting either 1 or 2 parameters. Both the parameters should be different type. How to use ellipsis and read the arguments passed?

Below is the sample:

```
void test(char *var2) 
{ 
 printf("%s\n",var2); 
} 

#define PRINT_STRING(...) ( if (!var1) test(var2) ) 

int main(int argc, _TCHAR argv[]) {

PRINT_STRING(TRUE); 
PRINT_STRING(FALSE,"Hello, World!"); 
return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:49:22.150

This is known as a [Variadic macro](http://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T06:56:51.407

If your compiler supports `__VA_ARGS__`, you can do it like this:

```
#include <stdio.h>

#define NUM_ARGS__(X, \
                      N64,N63,N62,N61,N60, \
  N59,N58,N57,N56,N55,N54,N53,N52,N51,N50, \
  N49,N48,N47,N46,N45,N44,N43,N42,N41,N40, \
  N39,N38,N37,N36,N35,N34,N33,N32,N31,N30, \
  N29,N28,N27,N26,N25,N24,N23,N22,N21,N20, \
  N19,N18,N17,N16,N15,N14,N13,N12,N11,N10, \
  N09,N08,N07,N06,N05,N04,N03,N02,N01,  N, ...) N

#define NUM_ARGS(...) \
  NUM_ARGS__(0, __VA_ARGS__, \
                 64,63,62,61,60, \
  59,58,57,56,55,54,53,52,51,50, \
  49,48,47,46,45,44,43,42,41,40, \
  39,38,37,36,35,34,33,32,31,30, \
  29,28,27,26,25,24,23,22,21,20, \
  19,18,17,16,15,14,13,12,11,10, \
   9, 8, 7, 6, 5, 4, 3, 2, 1, 0)

#define PRINT_STRING_1(var) \
  { if (!(var)) {} }

#define PRINT_STRING_2(var, ...) \
  { if (!(var)) test(__VA_ARGS__); }

#define PRINT_STRINGN__(N, ...) \
  PRINT_STRING_##N(__VA_ARGS__)

#define PRINT_STRINGN(N, ...) \
  PRINT_STRINGN__(N, __VA_ARGS__)

#define PRINT_STRING(...) \
  PRINT_STRINGN(NUM_ARGS(__VA_ARGS__), __VA_ARGS__) 

void test(char* var2) 
{ 
  printf("%s\n", var2); 
} 

int main(void)
{
  PRINT_STRING(1);
  PRINT_STRING(0, "Hello, World!");
  PRINT_STRING(1, "You can't see me!");
  return 0;
} 
```

Output:

```
Hello, World! 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T07:02:07.623

To do something like that you'd have to implement a series of macros, something like this

```
#include <stdbool.h>
#define PRINT_STRING0(X, Y) do { if (X && Y) test(Y); } while(false) 
#define PRINT_STRING1(X, Y, ...) PRINT_STRING0(X, Y)
#define PRINT_STRING(...) PRINT_STRING1(__VA_ARGS__, 0, 0) 
```

The last of them (user interface) adds a second or third argument of `0`. `PRINT_STRING1` then ignores all arguments that are more than `2`. And `PRINT_STRING0` then does the work.

Some more remarks:

*   be careful that a macro like you want to program it here can be place syntactically just as any other statement. In the example here the `do { } while(false)` does that trick
*   since C99 has Boolean type and constants, these are `_Bool` or `bool` and `false` and `true`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T06:36:28.850

Don't use a macro to do that, use a [variadic *function*](http://en.cppreference.com/w/cpp/utility/variadic/va_arg)!

```
void print_string( bool should_print, ... )
{
    if( should_print )
    {
        va_list argp;
        va_start( argp, should_print);
        char *string = va_arg(argp, char *);
        if( string) printf("%s", string );
        va_end( argp );

    }
} 
```

But be very careful when using these sorts of things, because va_arg doesn't check if you really have a 2nd argument.

Also, to use a macro that accepts one or 2 arguments, use the GCC trick (at the very bottom of [this page](http://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html)):

```
#define PRINT_STRING( should , args... ) print_string( should , ##args ) 
```

(note the spaces between the commas)

# javascript - 在 jquery 插件中定义选项的正确位置

> ID：11514207
> 
> 赞同：0
> 
> 时间：2012-07-16T23:47:03.277
> 
> 标签：javascript, jquery, jquery-plugins, namespaces

我有一个使用命名空间（方法）的 jQuery 插件，并且还有可以在初始化时覆盖的默认选项。

我想知道在命名空间中使用这个插件定义和使用选项的最佳方法是什么。

我最初`$.fn.dropIt.settings`在包装函数中使用 a 来定义设置，但后来切换到在`init`方法内部定义它们。然而，这在范围方面非常有限..

这是我插件中的相关代码

```
(function($, window, document, undefined){
  var methods = {
      init: function(options)
      {
        var settings = $.extend({
          trigger: "hover",
          animation: 'slide', /* none, slide, fade, grow */
          easing: 'swing', /* swing, linear, bounce */
          speedIn: 400,
          speedOut: 400,
          delayIn: 0,
          delayOut: 0,
          initCallback: function(){},
          showCallback: function(){},
          hideCallback: function(){}
        }, options);

        $(this).each(function(index, ele){
          $ele = $(ele);
          $ele.addClass('dropit');
          //Attach event handlers to each list-item
          $('li', $ele).dropIt('attach', settings);

          //If list is displayed veritcally, add extra left padding to all sub-menus
          if($(ele).hasClass('vertical'))
          {
            $('li', $ele).find('ul').addClass('nested sub-menu');
          } else {
            $('li ul', $ele).addClass('nested').find('ul').addClass('sub-menu');
          }
        });

        //Call custom callback
        settings.initCallback.call();

        //Return jQuery collection of lists
        return $(this);
      },

      attach: ...

      _trigger: ...

      _hide: ...

      }
    };

  $.fn.dropIt = function(method){
    //Variables and Options
    var $this = $(this);
    // Method calling logic
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist on jQuery.dropIt' );
    }
  };

})(jQuery, window, document); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:33:57.157

我总是将设置对象设置为插件范围的全局变量，如下所示：

```
(function($, window, document, undefined){
  var settings; //NOTE THIS LINE

  var methods = {
      init: function(options)
      {
        settings = $.extend({ //AND THIS LINE
          trigger: "hover",
          animation: 'slide', /* none, slide, fade, grow */
          easing: 'swing', /* swing, linear, bounce */
          speedIn: 400,
          speedOut: 400,
          delayIn: 0,
          delayOut: 0,
          initCallback: function(){},
          showCallback: function(){},
          hideCallback: function(){}
        }, options);

        $(this).each(function(index, ele){
          $ele = $(ele);
          $ele.addClass('dropit');
          //Attach event handlers to each list-item
          $('li', $ele).dropIt('attach', settings);

          //If list is displayed veritcally, add extra left padding to all sub-menus
          if($(ele).hasClass('vertical'))
          {
            $('li', $ele).find('ul').addClass('nested sub-menu');
          } else {
            $('li ul', $ele).addClass('nested').find('ul').addClass('sub-menu');
          }
        });

        //Call custom callback
        settings.initCallback.call();

        //Return jQuery collection of lists
        return $(this);
      },

      attach: ...

      _trigger: ...

      _hide: ...

      }
    };

  $.fn.dropIt = function(method){
    //Variables and Options
    var $this = $(this);
    // Method calling logic
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist on jQuery.dropIt' );
    }
  };

})(jQuery, window, document); 
```

**编辑：** 您也可以这样做`$(this).data('youPlugInName', settings)`，然后如果您想稍后更改它，您可以从中检索它`data('yourPlugInName')`，并更新您想要的任何属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:57:19.263

阅读[jQuery Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)页面后，我的插件结构基本上是这样的：

```
(function ($) {
    var defaults = {
        // set default options
    }
    // internal functions
    var methods = {
        // plugin methods
    }
    $.fn.pluginName = function (method) {
    }
})(jQuery); 
```

而且，像您一样，`$.extend`init 方法中的默认值，但为了清楚起见，我喜欢单独声明默认值。它对我来说一直很好。

# c# - 订购时使用的最佳清单

> ID：11514211
> 
> 赞同：4
> 
> 时间：2012-07-16T23:47:13.553
> 
> 标签：c#, asp.net, sql, sql-server

我在这里[动态创建 GridView](https://stackoverflow.com/questions/11426012/dynamically-creating-gridview)扩展我的问题并按照建议尝试不同的方法，但我又卡住了。

我有一个表来处理我的名字和键值的顺序。

```
KeyNames:
ID Int primary key
KeyName1 varchar(20)
KeyOrder int
KeyName2 varchar(20)
KeyOrder int
...
KeyNameN varchar(20)
KeyOrder int 
```

这些键表示要在网格视图中显示的另一个表的名称和顺序。IE：

```
 DocumentTable:
 ID int primary key
 PDF_Folder varchar(30)
 Key1value varchar(100)
 Key2value varchar(100)
 ..
 KeyNvalue varchar(100) 
```

因此，在我的网格视图中，用户可以决定键的列名和值（我可能想调用 Key1“描述”顺序 1 和 Key2“提到的名称”和顺序 2。

如果 Order < 0 那么它将不会显示在 gridview 中。

我坚持如何创建一个网格视图来显示 KeyNValue 的每一列，其列名称为 KeyNameN 和 KeyOrderN 的顺序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T11:03:10.477

您将使用 DataGridViewColumn 的 DisplayIndex 属性来设置 Order。您将使用 HeaderText 属性来设置名称。我看到你没有行，所以网格将只有一行有很多列。

因此，假设您有一个名为 MyGrid 的网格，每一列都在一个名为 MyEntityRecord 的类中，您已将所有列放在一个列表中，并且您希望在用户单击按钮后显示数据，这是一个示例代码从点击事件。

```
void ShowCustomGrid(List<MyEntityRecord> aList)
{
    MyGrid.Columns.Clear();
    MyGrid.Rows.Clear();
    for(int loop=0;loop<aList.Count;loop++)
    {
        MyGrid.Columns.Add(new DataGridViewColumn(new DataGridViewTextBoxCell()));
        MyGrid.Columns[loop].Text=aList[loop].KeyName;
        if(aList[loop].KeyOrder<0) MyGrid.Columns[loop].Visible=false;
    }
    //Now that all columns have been added, change the display index
    for(int loop=0;loop<aList.Count;loop++)
    {
         if(aList[loop].KeyOrder>=0) MyGrid.Columns[loop].DisplayIndex=aList[loop].KeyOrder;
    }
    //Finally, put the values
    MyGrid.Rows.Add();
    for(int loop=0;loop<aList.Count;loop++)
    {
        if(aList[loop].KeyOrder>=0) MyGrid.Rows[0].Cells[loop].Value=aList[loop].KeyValue;
    }
} 
```

如果我理解正确，这应该做你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T07:38:11.483

craete 表脚本：
CREATE TABLE [dbo].[KeyNames](
[ID] [int] NOT NULL,
[KeyName] [varchar](50) NOT NULL,
[keyOrder] [int] NOT NULL
) ON [PRIMARY]

CREATE TABLE [dbo].[DocumentTable](
[ID] [int] NOT NULL,
[PDF_Folder] [varchar](50) NOT NULL,
[Key1Value] [varchar](100) NOT NULL,
[Key2Value] [varchar](100) NOT NULL,
[Key3Value] [varchar](100) NOT NULL
) ON [PRIMARY]

=============键名表：行========
1 PDF_Folder 2
2 Key1Value 3
3 Key3Value 5
4 Key2Value 4
5 ID 1
======== ====================================

==============文档表：行========
1 aa a1 a2 a3
2 bbb b1 b2 b3
3 ccc c1 c2 c3
========= ==================================

如下查询是生成动态订单查询：

DECLARE @str_column VARCHAR(100);
声明@query VARCHAR(100);
SELECT @str_column = COALESCE(@str_column + ', ', '') + KeyName
FROM Keynames order by keyorder;
设置 @query= 'select ' + @str_column + ' 从 DocumentTable';
执行（@查询）；

# jquery - 使用 jquery 测试条件 m 和条件 n

> ID：11514214
> 
> 赞同：0
> 
> 时间：2012-07-16T23:47:20.113
> 
> 标签：jquery

我正在使用 jquery 创建多级菜单。当我单击给定级别中的按钮时，我会更改按钮颜色并显示单击按钮的下一个较低菜单级别。

例如，单击“策略”可能会显示“新策略”、“更新策略”、“认可策略”等。

“策略”按钮位于 1 级，其他按钮位于 2 级。如果我单击另一个 1 级按钮，我会关闭（删除）除被单击按钮之外的所有按钮的按钮颜色类。对于此按钮，我切换按钮颜色类（以防它被单击或再次单击）。

1）当我点击一个二级按钮时，问题就来了，所有一级按钮的颜色类都被删除了。所以现在我想为不同级别的按钮放置 type="level01" 和 type="level02" 。（我称它们为按钮，但它们实际上是锚标签。）

这是我删除除当前按钮颜色类之外的所有内容的代码：

```
// remove the menuA-open class from all class menuA objects except the one being toggled
$(".menuA[name!=" + $(this).text() +"]").removeClass("menuA-open"); 
```

请注意，按钮上的文本（锚标记的 innerHTML）也在 name="" 参数中。

现在我想说的是：

```
($(".menuA[name!=" + $(this).text() +"]") and $("menu[type]==$(this)[type])).removeClass("menuA-open"); 
```

但我没有找到如何在 jquery 中正确地“和”这两个条件。

2) 我在 $(this) 上使用 text() 函数

```
$(".menuA[name!=" + $(this).text() +"]").removeClass("menuA-open"); 
```

因为锚标记的 innerHTML 有一个小图形附加到文本中。所以这适用于小于 19 个字符的文本长度，但从那里测试失败？

有人可以帮忙吗？

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:10:43.113

**进一步更新：**工作演示[http://jsfiddle.net/Jb2jP/1/](http://jsfiddle.net/Jb2jP/1/)

```
$(document).ready(function() {
    $(".menuA").click(function(evnt) {

        evnt.preventDefault();

        $(".menuA").not(this).removeClass("menuA-open");

        // hide all other fieldset objects except the one being toggled
        $('fieldset').not($(this).next('fieldset')).hide();

        // toggle the fieldset following this link open or closed
        $(this).next('fieldset').toggle();

        // toggle the currently selected menuA-open class on or off
        $(this).toggleClass("menuA-open");
    });

    $("fieldset").mouseup(function() {
        return false;
    });
    $(document).mouseup(function(evnt) {
        // if user clicked anywhere outside our menus
        if ($(evnt.target).parent("a.menuA").length == 0) {
            // remove the menuA-open class from all class menuA objects
            $(".menuA").removeClass("menuA-open");
            // hide all fieldset objects
            $("fieldset").hide();
        }
    });
});​ 
```

* * *

**更新：**要将多个属性（不）等于选择器链接在一起，只需将它们连接起来（[参见 jQuery 文档](http://api.jquery.com/multiple-attribute-selector/)）。

```
$(".menuA[name='abc'][type='123']").removeClass("menuA-open"); 
```

但是，特别是在您的情况下，这可能仍然没有必要：

```
var type = $(this).attr('type');
$(".menuA").not(this).filter("[type='"type"']").removeClass("menuA-open"); 
```

* * *

完成选择后，您可以使用 jquery[`.not()`](http://api.jquery.com/not/)过滤器方法从匹配集中删除当前元素：

```
$(".menuA").not(this).removeClass("menuA-open"); 
```

这就是这样做的方法。

* * *

作为一个如何让你的尝试工作的例子*（*虽然不推荐这个）：

```
$(".menuA[name!='" + $(this).text() +"']").removeClass("menuA-open"); 
```

您需要`$(this).text()`在字符串中将结果用文字引号括起来，因为它包含一个空格。这应该是唯一的语法问题，尽管`.not()`过滤器再次是解决这个问题的最安全和最直观的方法。

# python - 编写一个简单的 Python 程序

> ID：11514216
> 
> 赞同：3
> 
> 时间：2012-07-16T23:47:43.573
> 
> 标签：python

我在为初学者编程课程编写简单的 Python 程序时遇到了麻烦。如果有人可以查看我目前拥有的代码并指导我朝着正确的方向前进，将不胜感激！这是代码：

# 一项有助于满足护士满足患者人员需求的计划

```
def main():
    print 'Welcome to the PACU nurse to patient program'
    print
    patients = inputPatients()
    nurses = getNurses(patients)
    nurseAssistants = getAssistants(nurses)
    printInfo = (patients, nurses, nurseAssistants)

    raw_input()

def inputPatients():
    patients = input('Enter the number of patients for this shift (up to 40): ')
    return patients

def getNurses(patients):
    nurses = (1.0 / 3.0) * patients
    return nurses

def getAssistants(nurses):
    nurseAssistants = (1.0 / 2.0) * nurses
    return nurseAssistants

def printInfo(patients, nurses, nurseAssistants):
    print 'The number of patients for this shift is:', patients
    print 'The number of nurses needed is:', nurses
    print 'The number of nurses Assistants is:', nurseAssistants

main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:56:06.270

将最后一段代码更改为：

```
def printInfo(patients, nurses, nurseAssistants):
    print 'The number of patients for this shift is:', patients
    print 'The number of nurses needed is:', nurses
    print 'The number of nurses Assistants is:', nurseAssistants

main() 
```

由于python基于缩进执行。此外，`=`从`printInfo`语句中删除并使其：

```
nurses = getNurses(patients)
nurseAssistants = getAssistants(nurses)
printInfo(patients, nurses, nurseAssistants) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:19:38.783

以前的答案暗示了主要问题，但没有解释为什么你没有看到任何输出。

下面*将*包含患者、护士和护士助理的 3 个值的[元组](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences)`printInfo`分配给名为 的变量。

```
printInfo = (patients, nurses, nurseAssistants) 
```

它不会产生任何输出，也不会`printInfo()`像您期望的那样调用该函数。您实际需要的是进行函数调用：

```
printInfo(patients, nurses, nurseAssistants) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:56:41.020

我注意到两件事：

首先，您的代码都没有缩进。这可能只是您复制到此站点的方式的后遗症，但请记住，在 Python 中空格很重要。特别是，代码块由缩进级别标识。因此，例如，您的 main() 函数应如下所示：

```
def main(): 
    print 'Welcome to the PACU nurse to patient program' 
    print 
    patients = inputPatients() 
    nurses = getNurses(patients) 
    nurseAssistants = getAssistants(nurses) 
    printInfo (patients, nurses, nurseAssistants) 

    raw_input() 
```

函数内的所有内容都缩进了。根据您使用的 IDE，您可能只需突出显示内容，然后按选项卡按钮。

下一个不太重要的事情是，您将浮点数用于诸如保姆数量之类的事情。由于很难拥有护士的一小部分，因此您可能希望使用 ceil() 之类的方法将其提升到下一个整数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T00:50:36.963

Nerd-Herd 和 mhawke 已经解释了 printInfo 和缩进的问题，但听起来你仍然对如何获得 3 个nurseAssistants 而不是 2.5 个感到困惑。例如，您说，“现在如何计算如何编程比率。”

通过使用浮点数，您可能会遇到并非每个十进制浮点值都可以精确表示为 IEEE 浮点值的问题。并且可以通过“编程比率”来解决这个问题，例如，通过使用`fractions.Fraction(1, 2)`而不是`1.0 / 2.0`，或使用十进制浮点数，如`decimal(1) / decimal(2)`. 但这实际上不是您遇到的问题。

你遇到的问题是你想要四舍五入，这不会自动发生。您必须明确地做到这一点，例如，通过调用`math.ceil`. 您可以在两个地方使用不同的语义，因此您必须决定哪一个对您的问题有意义。

选项 1 是尽快四舍五入，如下所示：

```
def getNurses(patients):
    nurses = math.ceil((1.0 / 3.0) * patients)
    return nurses

def getAssistants(nurses):
    nurseAssistants = math.ceil((1.0 / 2.0) * nurses)
    return nurseAssistants 
```

选项 2 是尽可能晚地四舍五入，如下所示：

```
def printInfo(patients, nurses, nurseAssistants):
    print 'The number of patients for this shift is:', math.ceil(patients)
    print 'The number of nurses needed is:', math.ceil(nurses)
    print 'The number of nurses Assistants is:', math.ceil(nurseAssistants) 
```

在你的情况下，这些实际上会给出相同的答案（假设患者的数量总是一个整数，希望它是……），但希望你能看到这些在类似情况下如何给出不同的答案，所以你有来决定哪个是正确的。

同时，`math.ceil(2.66666)`当您可能需要“3”时，将打印为“3.0”。为此，只需更改`math.ceil(nurses)`为`int(math.ceil(nurses))`等。

# css - 浮动到下一行后如何强制项目

> ID：11514218
> 
> 赞同：1
> 
> 时间：2012-07-16T23:47:58.537
> 
> 标签：css

我有一些代码，例如：

```
<div>First</div>
<div class="second">Second</div>

<a>Alink</a>

div{
    display: block;
float:left;
}

.second{
    clear:right;
} 
```

[http://jsfiddle.net/cg4gj/](http://jsfiddle.net/cg4gj/)

我真的希望链接在下一行。目前它位于第二位。如何在这些浮动之后强制元素转到下一行。我绝对不想让 div 占据页面的整个宽度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:52:57.447

将 display : 块添加到 a 标签并清除：http: [//jsfiddle.net/cg4gj/3/](http://jsfiddle.net/cg4gj/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:56:13.830

您可以明确定义 float:left 仅用于第一个 div

[http://jsfiddle.net/cg4gj/9/](http://jsfiddle.net/cg4gj/9/)

# python - Python字符串格式化问题

> ID：11514219
> 
> 赞同：2
> 
> 时间：2012-07-16T23:48:00.227
> 
> 标签：python, string

```
import random

def main():
    the_number = random.randint(1,100)
    guess = 0
    no_of_tries = 0
    while guess != the_number:
        no_of_tries += 1
        guess = int(input("Enter your guess: "))
        if guess < the_number:
            print "--------------------------------------"
            print "Guess higher!", "You guessed:", guess
            if guess == the_number - 1:
                print "You're so close!"
        if guess > the_number:
            print "--------------------------------------"
            print "Guess lower!", "You guessed:", guess
            if guess == the_number + 1:
                print "You're so close!"
        if guess == the_number:
            print "--------------------------------------"
            print "You guessed correctly! The number was:", the_number
            print "And it only took you", no_of_tries, "tries!"

if __name__ == '__main__':
    main() 
```

现在，在我的随机数猜谜游戏中，如果一个人猜出一个数字更低或更高，他们会收到以下消息：

```
Guess lower! You guessed: 33
You're so close! 
```

但我想把它写成一句话。

例如：

```
Guess lower! You guessed: 33\. You're so close! 
```

我将如何在我的代码中实现这一点？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T23:50:02.987

如果您想避免它进入下一行，只需在语句后加一个逗号 ( `','`) 。`print`例如：

```
print "Guess lower!", "You guessed:", guess,
                                           ^
                                           | 
```

下一条`print`语句将在*这一行的末尾*添加它的输出，即，它不会像您当前所拥有的那样向下移动到下一行的开头。

***更新**以下评论*：

为了避免逗号引起的空格，您可以使用[打印功能](http://docs.python.org/release/3.0.1/whatsnew/3.0.html)。IE，

```
from __future__ import print_function  # this needs to go on the first line

guess = 33

print("Guess lower!", "You guessed:", guess, ".", sep="", end="")
print(" You're so close!") 
```

这将打印

> `Guess lower!You guessed:33\. You're so close!`

这个[PEP](http://www.python.org/dev/peps/pep-3105/)还谈到了打印功能

# java - 在scala中传递对象

> ID：11514222
> 
> 赞同：-3
> 
> 时间：2012-07-16T23:48:16.103
> 
> 标签：java, function, scala, object

嘿伙计们，我正在尝试传递一个对象（类型对象），它是（字符串+对象）的组合。在函数中，我需要将字符串与哈希映射进行比较，并相应地对附加对象进行操作。

代码是这样的

```
 Function (srt : Object)
{
 //s is an array of Strings  
  var s = srt.toString.split("+")
  if(s[0]== insert)
    {
    var ne = s[1].asInstanceOf(USERDEFINEDCLASS) //ERROR here
   //do operations
    }
 }

     main()
       {
      var og : className = new className(parameters)
      Function(og ->("insert"))
       } 
```

在这段代码中，我收到错误消息，说它不能从字符串转换为类对象。我无法想出办法。有人可以帮我弄这个吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T05:00:05.207

我不确定它会帮助你。下面是一个具有您描述的一些功能的程序：

```
class Main{
    class SomeClass(val x:String) { override def toString:String = x }
    def funct(obj:Object) {
        val s=obj.toString.split("+")
        if(s(0) == "a" ) { // assumingn it's a non empty string
            println(obj.asInstanceOf[SomeClass].x)
        }

    }
    def main(args:Array[String]):Unit = {
        funct(new SomeClass("a+b"))
    }
} 
```

# asp.net-mvc-3 - 从单元测试访问 DBContext 时抛出异常

> ID：11514226
> 
> 赞同：0
> 
> 时间：2012-07-16T23:48:55.927
> 
> 标签：asp.net-mvc-3, visual-studio-2010, linq, unit-testing, dbcontext

任何单元测试包括从我的 DBContext 调用 SELECT（使用 LINQ）数据都会引发以下错误：

> 自创建数据库以来，支持“MyDBContext”上下文的模型已更改。手动删除/更新数据库，或使用 IDatabaseInitializer 实例调用 Database.SetInitializer。例如，DropCreateDatabaseIfModelChanges 策略将自动删除并重新创建数据库，并可选择使用新数据为其播种。

搜索该特定错误使我相信我需要在 Global.asax Application_Start 方法中包含以下行：

```
System.Data.Entity.Database.SetInitializer<MyDBContext>( null ); 
```

这是为了在运行应用程序本身时修复类似的错误。不幸的是，当我运行我的应用程序时，我没有收到此错误，而且我的单元测试项目似乎没有 Application_Start 方法。有什么方法可以对我使用自定义数据库后端的单元测试项目并忽略其中发生的任何更改？

我在我的主要项目上工作了一段时间后添加了单元测试项目，所以我可能以某种方式把它搞砸了，但我无法弄清楚我的生活该怎么做。我正在使用 Visual Studio 2010 中的内置单元测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T06:15:58.570

VS 单元测试框架可以使用 2 种方法，允许您在每次测试之前和之后以及文件中包含的所有测试之前和之后运行一些代码

```
// Use TestInitialize to run code before running each test 
[TestInitialize()]
public void MyTestInitialize() 
{ 

}

// Use TestCleanup to run code after each test has run
[TestCleanup()]
public void MyTestCleanup() 
{ 

} 
```

或者：

```
// Use ClassInitialize to run code before running the first test in the class
[ClassInitialize()]
public static void MyClassInitialize(TestContext testContext) 
{ 

}

// Use ClassCleanup to run code after all tests in a class have run
[ClassCleanup()]
public static void MyClassCleanup() 
{ 

} 
```

# jquery - JQuery Slider 事件处理程序回调

> ID：11514231
> 
> 赞同：2
> 
> 时间：2012-07-16T23:49:24.250
> 
> 标签：jquery, jquery-ui, jquery-ui-slider

我正在通过 head first jquery 工作，并且我正在处理 jquery ui 的一章。具体来说，该示例正在浏览一个 jquery 滑块，该滑块在滑块上方显示该滑块的值。截图： http: [//i.imgur.com/ahRRy.png](http://i.imgur.com/ahRRy.png?1) ? 1 但是，我很难理解代码：

的HTML：

```
<h3>Distance from Creature (in ft.):</h3>
                <input type="text" id="distance" class="just_display" name="creature_distance" readonly="readonly"/>
                <div id="slide_dist"></div> 

<h3>Creature Weight (in lbs.):</h3>
                <input  type="text" id="weight" class="just_display" name="creature_weight"   readonly="readonly"/>
                <div id="slide_weight"></div>

<h3>Creature Height (in ft.):</h3>
                <input  type="text" id="height" class="just_display" name="creature_height" readonly="readonly"/>
                <div id="slide_height"></div> 
```

查询：

```
//3a. slide_dist
        $( "#slide_dist" ).slider({
            value:0,
            min: 0,
            max: 500,
            step: 10,
            slide: function( event, ui ) {
                $( "#distance" ).val( ui.value);
            }
        });
    $( "#distance" ).val( $( "#slide_dist" ).slider( "value" ));

        //3b. slide_weight

        $( "#slide_weight" ).slider({
            value:0,
            min: 0,
            max: 5000,
            step: 5,
            slide: function( event, ui ) {
                $( "#weight" ).val( ui.value);
            }
        });

        $( "#weight" ).val( $( "#slide_weight" ).slider( "value" ));

        //3c.  slide_height
        $( "#slide_height" ).slider({
            value:0,
            min: 0,
            max: 20,
            step: 1,
            slide: function( event, ui ) {
                $( "#height" ).val( ui.value);
            }
        });

        $( "#height" ).val( $( "#slide_height" ).slider( "value" )); 
```

我对滑块方法中的幻灯片参数感到非常困惑：

```
slide: function( event, ui ) {
        $( "#height" ).val( ui.value);
   } 
```

据我所知，这是更改滑块上方的值以匹配滑块的值。但是，如果是这种情况，那么滑块方法后面的行会做什么：

```
$( "#height" ).val( $( "#slide_height" ).slider( "value" )); 
```

这些线不是在做同样的事情吗？任何和所有输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:52:41.043

这一行：

```
slide: function( event, ui ) {
    $( "#height" ).val( ui.value);
} 
```

正在为 jQueryUI 定义的“幻灯片”事件定义事件处理程序。在滑动期间每次鼠标移动时，事件处理程序都会更新`#height`滑块的更新值。

这一行（在你给出的上下文中）：

```
$( "#height" ).val( $( "#slide_height" ).slider( "value" )); 
```

只是简单的将 的值设置`#height`为`0`初始（滑块的初始值为 0，可以看到`value`每个滑块中的选项初始化为`0`）`value:0`。

两者之间的区别在于，第一个在每次鼠标在滑块上移动时运行，第二个在滑块初始化后立即执行一次，为`#height`元素提供初始值（`0`在本例中）。

另一种看待它的方式是，如果第二个片段不存在，则该`#height`元素最初不会显示`0`（尝试删除该行以了解我的意思）。

# sql-server - 将复杂 XML 文件导入 SQL Server

> ID：11514237
> 
> 赞同：0
> 
> 时间：2012-07-16T23:49:51.033
> 
> 标签：sql-server, xml, import

我有大约 6000 个 XML 文件需要导入 SQL 数据库。我需要找出这些 XML 文件中的一些字段并导入到多个表中。这些文件是保存为 XML 文档的 InfoPath 文件。每个文件有大约 20 个字段，需要在各自列的 6 个表中输入。我分析了数据字段并创建了表格和它们之间的关系。现在，必须开始导入数据。

我尝试在 SSIS 中使用 XML 源，但数据太复杂，SSIS 无法保存。所以，xml 源代码对我不起作用。致力于使用脚本任务，但我不是核心 C#/VB 开发人员。还尝试使用批量插入；但**我没有批量插入权限。**朋友建议我使用 XQuery，但我认为 Xquery 可以用于解析 XML 文件是否在表中（不确定）。

谁能告诉我开始这项任务的最佳方法。

提前致谢！

库马尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T15:32:38.053

我遇到过类似的情况，这是我使用的方法： 1\. 创建表来保存 xml 数据（列作为 xml 数据类型） 2\. 将源 xml 文件作为 TEXT 读取并将它们插入到这些表中 3\. 在存储过程中使用 XQuery 来提取数据并填充目标表

如果您需要，我可以提供更多指针/信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T12:28:41.233

实现这一目标的最佳方法是使用开源工具 - [**Talend Open Studio**](http://www.talendforge.org/forum/viewtopic.php?id=21727)

# php - PHP 在每个请求上更改会话 ID

> ID：11514241
> 
> 赞同：1
> 
> 时间：2012-07-16T23:50:08.983
> 
> 标签：php, sessionid

今天早上，我的本地 php 开始出现奇怪的行为：*每次请求时会话 ID 都会发生变化*（使会话无法使用）。

编码：

```
<?php
session_start(); 
```

同一页面可通过“localhost”和“test”获得，后者是 localhost 的 /etc/hosts 条目。

*在“ localhost* ”上请求相同的文件：**PHPSESSID** cookie 保持不变；在“测试”上，它会根据每个请求而改变。

我的代码（没有 BOM 或错误代码）或 Apache 的配置中绝对**没有任何**变化。我可能已经更新了 PHP ( *5.4.4* )，但恢复到以前的版本 ( *5.4.1* ) 显示了相同的行为。在远程服务器（php *5.3*）上运行的相同代码已经运行了很长时间。

这可能是 PHP 中的一个错误 :( 但在报告之前，我想确保我没有忽略任何事情。

任何的想法？

* * *

感谢您惊人的快速回答。

事实上，浏览器工作正常，一切正常，甚至 PHP。

我只是忘了我添加了一个 .htaccess 清除所有 cookie 以上传到 CDN。我唯一没有检查的是.htaccess。

我觉得自己很愚蠢（也很累）。

再次感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T23:57:42.303

安装一些软件来查看 HTTP 标头，例如

*   实时 HTTP 标头 Firefox 插件[https://addons.mozilla.org/en-us/firefox/addon/live-http-headers/](https://addons.mozilla.org/en-us/firefox/addon/live-http-headers/)
*   WireShark 嗅探器[http://www.wireshark.org/](http://www.wireshark.org/)

    并检查是否

    1.  服务器按应有的方式发送 cookie
    2.  浏览器将它们发回。

可能 Cookie 标头包含使浏览器不将其发送回的设置，因此服务器会为每个请求生成一个新的 cookie（新会话）。尤其要检查`path`您发送的 cookie 的设置。

此外，它可能是浏览器中的一些新策略、安全插件或防病毒软件……尝试不同的浏览器或裸`curl`程序，并在适用时禁用防病毒软件的 Web 防护。

# javascript - 添加 CSS3 过渡展开/折叠

> ID：11514242
> 
> 赞同：56
> 
> 时间：2012-07-16T23:50:10.017
> 
> 标签：javascript, html, css

如何添加展开/折叠过渡？

```
function showHide(shID) {
    if (document.getElementById(shID)) {
        if (document.getElementById(shID + '-show').style.display != 'none') {
            document.getElementById(shID + '-show').style.display = 'none';
            document.getElementById(shID).style.display = 'block';
        } else {
            document.getElementById(shID + '-show').style.display = 'inline';
            document.getElementById(shID).style.display = 'none';
        }
    }
}
```

```
.more {
    display: none;
    padding-top: 10px;
}

a.showLink,
a.hideLink {
    text-decoration: none;
    -webkit-transition: 0.5s ease-out;
    background: transparent url('down.gif') no-repeat left;
}

a.hideLink {
    background: transparent url('up.gif') no-repeat left;
}
```

```
Here is some text.
<div class="readmore">
    <a href="#" id="example-show" class="showLink" onclick="showHide('example');return false;">Read more</a>
    <div id="example" class="more">
        <div class="text">Here is some more text: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae urna nulla. Vivamus a purus mi. In hac habitasse platea dictumst. In ac tempor quam. Vestibulum eleifend vehicula ligula, et cursus nisl gravida sit amet. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</div>
        <p><a href="#" id="example-hide" class="hideLink" onclick="showHide('example');return false;">Hide</a></p>
    </div>
</div>
```

[http://jsfiddle.net/Bq6eK/1](http://jsfiddle.net/Bq6eK/1)

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-07T00:13:44.337

[这](http://jsfiddle.net/9ccjE/)是我自动调整高度的解决方案：

```
function growDiv() {
  var growDiv = document.getElementById('grow');
  if (growDiv.clientHeight) {
    growDiv.style.height = 0;
  } else {
    var wrapper = document.querySelector('.measuringWrapper');
    growDiv.style.height = wrapper.clientHeight + "px";
  }
  document.getElementById("more-button").value = document.getElementById("more-button").value == 'Read more' ? 'Read less' : 'Read more';
}
```

```
#more-button {
  border-style: none;
  background: none;
  font: 16px Serif;
  color: blue;
  margin: 0 0 10px 0;
}

#grow input:checked {
  color: red;
}

#more-button:hover {
  color: black;
}

#grow {
  -moz-transition: height .5s;
  -ms-transition: height .5s;
  -o-transition: height .5s;
  -webkit-transition: height .5s;
  transition: height .5s;
  height: 0;
  overflow: hidden;
}
```

```
<input type="button" onclick="growDiv()" value="Read more" id="more-button">

<div id='grow'>
  <div class='measuringWrapper'>
    <div class="text">Here is some more text: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae urna nulla. Vivamus a purus mi. In hac habitasse platea dictumst. In ac tempor quam. Vestibulum eleifend vehicula ligula, et cursus nisl gravida sit
      amet. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</div>
  </div>
</div>
```

我使用了 r3bel 发布的解决方法：[Can you use CSS3 to transition from height:0 to the variable height of content？](https://stackoverflow.com/questions/3149419/can-you-use-css3-to-transition-from-height0-to-the-variable-height-of-content)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-17T00:33:16.850

[这](http://jsfiddle.net/Bq6eK/13/)应该可行，也必须尝试一段时间..：D

```
function showHide(shID) {
  if (document.getElementById(shID)) {
    if (document.getElementById(shID + '-show').style.display != 'none') {
      document.getElementById(shID + '-show').style.display = 'none';
      document.getElementById(shID + '-hide').style.display = 'inline';
      document.getElementById(shID).style.height = '100px';
    } else {
      document.getElementById(shID + '-show').style.display = 'inline';
      document.getElementById(shID + '-hide').style.display = 'none';
      document.getElementById(shID).style.height = '0px';
    }
  }
}
```

```
#example {
  background: red;
  height: 0px;
  overflow: hidden;
  transition: height 2s;
  -moz-transition: height 2s;
  /* Firefox 4 */
  -webkit-transition: height 2s;
  /* Safari and Chrome */
  -o-transition: height 2s;
  /* Opera */
}

a.showLink,
a.hideLink {
  text-decoration: none;
  background: transparent url('down.gif') no-repeat left;
}

a.hideLink {
  background: transparent url('up.gif') no-repeat left;
}
```

```
Here is some text.
<div class="readmore">
  <a href="#" id="example-show" class="showLink" onclick="showHide('example');return false;">Read more</a>
  <div id="example" class="more">
    <div class="text">
      Here is some more text: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vitae urna nulla. Vivamus a purus mi. In hac habitasse platea dictumst. In ac tempor quam. Vestibulum eleifend vehicula ligula, et cursus nisl gravida sit amet.
      Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
    </div>
    <p>
      <a href="#" id="example-hide" class="hideLink" onclick="showHide('example');return false;">Hide</a>
    </p>
  </div>
</div>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T08:48:27.960

[http://jsfiddle.net/Bq6eK/215/](http://jsfiddle.net/Bq6eK/215/)

I did not modify your code for this solution, I wrote my own instead. My solution isn't quite what you asked for, but maybe you could build on it with existing knowledge. I commented the code as well so you know what exactly I'm doing with the changes.

As a solution to "avoid setting the height in JavaScript", I just made 'maxHeight' a parameter in the JS function called toggleHeight. Now it can be set in the HTML for each div of class expandable.

I'll say this up front, I'm not super experienced with front-end languages, and there's an issue where I need to click the 'Show/hide' button twice initially before the animation starts. I suspect it's an issue with focus.

The other issue with my solution is that you can actually figure out what the hidden text is without pressing the show/hide button just by clicking in the div and dragging down, you can highlight the text that's not visible and paste it to a visible space.

My suggestion for a next step on top of what I've done is to make it so that the show/hide button changes dynamically. I think you can figure out how to do that with what you already seem to know about showing and hiding text with JS.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-06T22:55:30.840

OMG，我花了几个小时试图找到一个简单的解决方案。我知道代码很简单，但没有人提供我想要的东西。所以终于开始编写一些示例代码，并做了一些简单的事情，任何人都可以使用不需要 JQuery。简单的 javascript 和 css 和 html。为了使动画工作，您必须设置高度和宽度，否则动画将无法工作。很难找到。

```
<script>
        function dostuff() {
            if (document.getElementById('MyBox').style.height == "0px") {

                document.getElementById('MyBox').setAttribute("style", "background-color: #45CEE0; height: 200px; width: 200px; transition: all 2s ease;"); 
            }
            else {
                document.getElementById('MyBox').setAttribute("style", "background-color: #45CEE0; height: 0px; width: 0px; transition: all 2s ease;"); 
             }
        }
    </script>
    <div id="MyBox" style="height: 0px; width: 0px;">
    </div>

    <input type="button" id="buttontest" onclick="dostuff()" value="Click Me"> 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-07-20T19:30:50.947

这是一个根本不使用 JS 的解决方案。它改为使用[复选框](http://jsfiddle.net/YgCc6/35/)。

您可以通过将其添加到您的 CSS 来隐藏复选框：

```
.container input{
    display: none;
} 
```

然后添加一些样式让它看起来像一个[按钮](http://jsfiddle.net/YgCc6/21/)。

[这是我修改的源代码。](http://tympanus.net/codrops/2012/02/21/accordion-with-css3/)

# sql - SQL 存储过程：删除后重新排序行

> ID：11514247
> 
> 赞同：3
> 
> 时间：2012-07-16T23:51:48.450
> 
> 标签：sql, sql-server, stored-procedures, azure-sql-database, sql-server-2012

在我的数据库中，我有如下三个表：

*   `Tasks (TaskID, TaskName, TaskDescription)`
*   `TaskDetails (TaskID, subTaskPosition, SubTaskID)`
*   `Subtasks (SubTaskID, Description)`

我正在尝试编写 a`Stored Procedure`以完全删除 a `SubTask`，然后将另一个重新排序`SubTasks`为 a `Task`。

注意事项：

*   `TaskDetails`链接`Tasks`到组成部分`SubTasks`。
*   A`SubTask`可能在许多不同的任务中被引用。
*   A`Task`应该由`SubTasks`...的有序列表组成，即 1,2,3,4 而不是 1,3,4,5。

`SubTask`删除 a及其到 a 的链接相当容易，`Task`如下所示：

*   `DELETE FROM TaskDetails WHERE SubTaskID = @subTaskID`
*   `DELETE FROM SubTasks WHERE SubTaskID = @subTaskID`

但是，一旦删除了初始值，我无法理解如何重新排序表`SubTasks`中的另一个。在英语中，我需要执行以下操作 - “对于刚刚从中删除的所有任务，从删除行所在位置之后出现的所有字段中减去 1 ”。`TaskDetails``SubTask``SubTask``subTaskPosition`

任何帮助或指针表示赞赏...

戈登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:06:30.290

我认为您必须为每项任务进行更新。这可以解决问题（语法适用于 SQL Server）：

```
DECLARE @TaskID int
DECLARE @SubTaskPosition int

DECLARE curSubTaskPositionUpdate cursor fast_forward
FOR 
    SELECT TaskID, SubTaskPosition
    FROM TaskDetails 
    WHERE SubTaskID = @SubTaskID
OPEN curSubTaskPositionUpdate
FETCH NEXT FROM curSubTaskPositionUpdate INTO @TaskID, @SubTaskPosition
WHILE @@FETCH_STATUS = 0
    BEGIN   
        UPDATE TaskDetails
        SET SubTaskPosition = SubTaskPosition - 1
        WHERE TaskID = @TaskID
        AND SubTaskPosition > @SubTaskPosition

        FETCH NEXT FROM curSubTaskPositionUpdate INTO @TaskID, @SubTaskPosition
    END
CLOSE curSubTaskPositionUpdate
DEALLOCATE curSubTaskPositionUpdate 
```

请注意，您在从 TaskDetails 删除之前执行此操作...并且您可能希望将所有内容包装在事务中。

Gordon Edit - 我必须在更新代码中包含我的删除代码才能使其工作，否则（a）删除首先发生并且“subtaskID = @subtaskID”没有返回任何内容，或者（b）我在重新执行后删除了订购和重新订购（正确！）没有效果。

```
DECLARE @TaskID uniqueidentifier
DECLARE @SubTaskPosition int 

DECLARE curSubTaskPositionUpdate cursor fast_forward 
FOR  
    SELECT TaskID, SubTaskPosition 
    FROM TaskDetails  
    WHERE SubTaskID = @subTaskID 
OPEN curSubTaskPositionUpdate 
FETCH NEXT FROM curSubTaskPositionUpdate INTO @TaskID, @SubTaskPosition 
WHILE @@FETCH_STATUS = 0 
   BEGIN    
-- Delete the subTask
DELETE FROM TaskDetails
WHERE TaskID = @TaskID
AND SubTaskPosition = @SubTaskPosition 

-- Update the other subTasks
        UPDATE TaskDetails
        SET SubTaskPosition = SubTaskPosition - 1
        WHERE TaskID = @TaskID
        AND SubTaskPosition > @SubTaskPosition

        FETCH NEXT FROM curSubTaskPositionUpdate INTO @TaskID, @SubTaskPosition
    END
CLOSE curSubTaskPositionUpdate
DEALLOCATE curSubTaskPositionUpdate 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:16:17.963

这应该这样做：

```
UPDATE  TaskDetails
SET     subTaskPosition = ROW_NUMBER() OVER(PARTITION BY TaskID  ORDER BY subTaskPosition) 
WHERE   TaskID IN(  SELECT  s.TaskID 
                    FROM    TaskDetails s 
                    WHERE   SubTaskID = @subTaskID) 
```

不需要循环...请注意，这也适用于缺少多个子任务或已为同一任务删除的情况。

* * *

好的，这是 SQL Server 的更正版本：

```
;WITH
  cteRows As
(
    SELECT  *,
    ROW_NUMBER() OVER(PARTITION BY TaskID  ORDER BY subTaskPosition) As NewPosition
    FROM    TaskDetails
)
UPDATE  cteRows
SET     subTaskPosition = NewPosition
WHERE   TaskID IN(  SELECT  s.TaskID 
                    FROM    TaskDetails s 
                    WHERE   SubTaskID = @subTaskID) 
```

抱歉耽搁了 ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T00:06:08.383

首先获取子rask的位置，删除，更新记录：

```
declare @pos int
select @pos = subTaskPosition from TaskDetails where SubTaskID = @subTaskID
delete ...
delete ...
update TaskDetails set subTaskPosition = subTaskPosition + 1 where SubTaskID = @subTaskID and subTaskPosition > @pos 
```

# google-chrome - SVG Chrome 中的元素未显示

> ID：11514248
> 
> 赞同：7
> 
> 时间：2012-07-16T23:52:03.023
> 
> 标签：google-chrome, svg

Chrome 似乎不会`<use>`在内联 svg 中显示元素。这是一个示例（下面的代码或在[http://www.bobwyttenbach.com/chromeuse.html](http://www.bobwyttenbach.com/chromeuse.html)查看它）：

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Chrome use-tag bug?</title>
</head>
<body>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200">
    <defs>
        <g id="test1">
            <circle cx="100" cy="100" r="50" fill="red"/>
        </g>
    </defs>
    <g>
        <rect x="0.5" y="0.5" width="199" height="199" stroke="black" fill="none"/>
        <use xlink:href="#test1" x="0" y="0"/>
    </g>
</svg>
<p>Above is inline svg with a use tag; below is the same svg linked through an object tag. Below is correct.</p>
<object data="chromeuse.svg" width="200" height="200"></object>
</body>
</html> 
```

红色圆圈不会出现在内联 svg 中，但会在通过对象标签链接同一个 svg 时出现。Safari、Firefox、Opera 和 Internet Explorer 9 都能正确显示内联 svg。

难道我做错了什么？这是一个已知的 Chrome 错误吗（我没有找到它列出）？任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-07-16T14:17:19.617

不知道这个问题是否仍然相关，但我最近遇到了这样一个案例，我很确定其他人会遇到这个案例（尤其是那些第一次尝试使用 SVG 精灵的人）。

在我的例子中，我在一个精灵中手动加入了 16 个 SVG 图标`sprite.svg`，在这个文件中我省略了重要的元信息：

```
<?xml version="1.0" encoding="utf-8"?>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
```

我根本没有第一行，第二行只有一个`<svg>`没有元属性（`xmlns`和`xmlns:xlink`）的开始标签。一旦我带回所有这些省略的元信息，我的图形`sprite.svg`就开始正常显示。

希望它可以帮助某人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:37:46.620

好的，所以我删除了我的上一篇文章，因为我错误地试图弄清楚为什么 use 元素对我有用，而不是对你有用。我能说的是我正在使用这个源的修改版本，[https://code.google.com/p/svg-edit/](https://code.google.com/p/svg-edit/)，所以简而言之，我的答案是走过去看看他们是如何做到的。我相信当您从他们的库中插入图像时，它会显示出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-21T18:18:54.237

我花了很长时间调试没有显示的内联 svg 使用元素。BobW 讨论的 chrome 错误此时似乎已修复。要完全消除由其他原因引起的相同问题，请尝试从 HTML 中注释掉`<base href="somethingsomethingsomething" />`标记。

当然，这可能会破坏您网站上的每个相关链接，但这些`<use>`元素现在会显示出来。前进一步，后退半步：）

此处的相关信息： [在包含 SVG 标记元素的页面上使用基本标记无法呈现标记](https://stackoverflow.com/questions/18259032/using-base-tag-on-a-page-that-contains-svg-marker-elements-fails-to-render-marke)

# php - CodeIgniter 是否支持命名查询绑定？

> ID：11514253
> 
> 赞同：3
> 
> 时间：2012-07-16T23:52:31.237
> 
> 标签：php, sql, codeigniter

我查看了 CI 的手册，发现它支持这种查询绑定：

```
$sql = "SELECT * FROM some_table WHERE id = ? AND status = ? AND author = ?";
$this->db->query($sql, array(3, 'live', 'Rick')); 
```

不过我更喜欢 PDO 风格：

```
$sql = "SELECT * FROM some_table WHERE id = :id AND status = :status  AND author = :author"; 
```

通过这种方式，绑定可以更灵活，顺序无关紧要。

CI 是否支持这种绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T17:25:28.070

默认情况下 Codeigniter 不支持命名绑定。

因为使用命名绑定更具可读性这一事实，我“破解”了数据库类，以便它接受命名或未命名绑定。

如果有人对“黑客”感兴趣，请告诉我，我会将其上传到某个地方

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-18T04:30:18.267

我扩展了 CI_Model 以按名称执行参数查询。

```
class MY_Model extends CI_Model{

    protected $db;
    private $sql;
    private $bind_marker;

    public function __construct() {
        $this->load->database($this->setConfigCliente());
        $CI =& get_instance();
        $this->db = $CI->db;
        $this->bind_marker = $this->db->bind_marker;
        parent::__construct();
    }

    public function setConfigCliente() {
//        $db['hostname'] = 'localhost';
//        $db['dsn'] = "mysql:host=localhost;dbname=".$this->getDbName();
        $db['hostname'] = "mysql:host=localhost;dbname=".$this->getDbName();
        $db['username'] = 'root';
        $db['password'] = 'pass#######';
        $db['database'] = $this->getDbName();
//        $db['dbdriver'] = 'mysqli';
        $db['dbdriver'] = 'pdo';
        $db['dbprefix'] = '';
        $db['pconnect'] = TRUE;
        $db['db_debug'] = TRUE;
        $db['cache_on'] = FALSE;
        $db['cachedir'] = '';
        $db['char_set'] = 'utf8';
        $db['dbcollat'] = 'utf8_general_ci';
        $db['swap_pre'] = '';
        $db['autoinit'] = TRUE;
        $db['stricton'] = FALSE;

        return $db;

    }

    final protected function query($sql, $bind=false, $return_object = true){
        $this->sql = $sql;
        if(is_array($bind) and count($bind)>0){
            $bind = $this->process_bind($bind);
        }
        $query = $this->db->query($this->sql, $bind, $return_object);
        return $query;
    }

    private function process_bind($bind){
        $bindOrder = null;
        $bindList = null;

        $pattern = "/[^']:[A-Za-z0-9_]+[^']/";
        $preg = preg_match_all($pattern, $this->sql, $matches, PREG_OFFSET_CAPTURE);
        if($preg !== 0 and $preg !== false){
            foreach($matches[0] as $key=>$val){
                $bindOrder[$key] = trim($val[0]);
            }
            foreach($bindOrder as $field){
                $this->sql = str_replace($field, $this->bind_marker, $this->sql);
                $bindList[] = $bind[$field];
            }
        }else{
            $bindList = $bind;
        }

        return $bindList;
    }

    private function getDbName(){
        /*
         * LISTA DE NOME DE BANCO SEGUNDO O SUBDOMINIO.
         */

        //AMIG
        $sub['amig']['dbName'] = 'amig';
        $sub['10']['dbName'] = 'amig';

        //SISTEMA.ARKSYS
        $sub['sistema']['dbName'] = 'sistema';
        $sub['code']['dbName'] = 'sistema';

        $host = explode('.', $_SERVER['HTTP_HOST']);
        $subDom = $host[0];
        if(isset($sub[$subDom])){
            return $sub[$subDom]['dbName'];
        }else{
            return null;
        }

    }

} 
```

示例用法：

```
class Login_usuarios extends MY_Model {

    public function __construct() {
        parent::__construct();
    }

    public function get_login_dados($email, $senha) {

        $sql = "
        SELECT
            u.usu_id,
            u.usu_nome,
            u.usu_alterar_senha,
            u.usu_situacao,
            (SELECT log_data FROM log_usuario_acesso l WHERE l.usu_id = u.usu_id ORDER BY l.log_data DESC LIMIT 1) AS data_ultimo_acesso,
            (SELECT
                p.par_nome_fantasia
            FROM 
                sys_parametros p
            WHERE
                p.par_id = 1) as par_nome_fantasia
        FROM 
            cad_usuarios u
        WHERE
            u.usu_email = :usu_email
        AND
            u.usu_senha = :usu_senha
        AND
            u.usu_situacao <> :usu_situacao";

        $bind[':usu_senha'] = $senha;
        $bind[':usu_email'] = $email;
        $bind[':usu_situacao'] = 'Descartado';

        $query = $this->query($sql, $bind);

        return $query->result_array();
    }
} 
```

仅由“：”标识的参数

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-17T00:08:21.087

您可以使用命名查询绑定。让我举个例子。

```
$sql = 'SELECT @column FROM @table LIMIT @limit';
$this->db->bind('@column', 'username');
$this->db->bind('@table', 'users');
$this->db->bind('@limit', 10);
$query = $this->db->query($sql); 
```

[查询绑定](http://codeigniter.com/forums/viewthread/125929/#629131)

# iphone - 在视图上使用 drawInRect？

> ID：11514256
> 
> 赞同：0
> 
> 时间：2012-07-16T23:52:41.560
> 
> 标签：iphone, objective-c, ios, core-graphics

我有一个 drawInRect 方法，我希望在另一个 UIView 上使用它，这个视图的子视图。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:22:53.350

如果您对复制绘图感兴趣，可以将绘图放在`drawFunct`顶层视图的单独函数 () 中，然后`[self.superview drawFunct]`从子视图中调用 `drawInRect`。

`drawInRect`通常不鼓励调用。

# git - 访问 Github 上链接存储库中的分支

> ID：11514261
> 
> 赞同：0
> 
> 时间：2012-07-16T23:53:54.070
> 
> 标签：git, github

我有一个 github 存储库 pedz/ruby，它是 shyouhei/ruby 的一个分支，它是 ruby​​/ruby 的一个分支。

ruby/ruby 有一个名为 1_9_3 的分支，shyouhei/ruby 没有。

有没有办法让我访问 ruby​​/ruby 的 1_9_3 分支？

请注意，我不能 fork ruby​​/ruby - 至少我不知道如何。当我在 ruby​​/ruby 页面上时，正常的“fork”按钮已回复为“your fork”按钮。点击那个按钮让我进入我的 pedz/ruby 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:49:03.533

如果您想访问本地存储库上的 1_9_3 分支，则：

```
git remote add upstream url://to/ruby/repo
git fetch upstream
git checkout upstream/1_9_3 
```

这将使您可以访问本地分支。如果您希望该分支位于 shyouhei 上，请继续：

```
git push origin 1_9_3 
```

# objective-c - Objective-C，授权无法执行功能

> ID：11514262
> 
> 赞同：0
> 
> 时间：2012-07-16T23:53:58.917
> 
> 标签：objective-c, cocoa, authentication

我正在尝试创建一个使用 SMJobBless 复制文件的授权，尽管我无法让它工作。帮助应用程序授权成功并且`Job is available!`消息出现在`[self copyFile]`方法之前，但是 copyFile 总是失败。如果有人可以阐明我做错了什么或提供如何使这项工作做得很好的例子。

appDelegate.h

```
#import <Cocoa/Cocoa.h>

@interface SMJobBlessAppController : NSObject {
    IBOutlet NSTextField *_textField;
}

- (BOOL)blessHelperWithLabel:(NSString *)label error:(NSError **)error;
- (void)copyFile;

@end 
```

appDelegate.m

```
#import <ServiceManagement/ServiceManagement.h>
#import <Security/Authorization.h>
#import "appDelegate.h"

@implementation SMJobBlessAppController
- (void)applicationDidFinishLaunching:(NSNotification *)notification
{
    NSError *error = nil;
    if (![self blessHelperWithLabel:@"com.apple.bsd.SMJobBlessHelper" error:&error]) {
        NSLog(@"Something went wrong!");
    } else {
        /* At this point, the job is available. However, this is a very
         * simple sample, and there is no IPC infrastructure set up to
         * make it launch-on-demand. You would normally achieve this by
         * using a Sockets or MachServices dictionary in your launchd.plist.
         */
        NSLog(@"Job is available!");

        [self->_textField setHidden:false];

        [self copyFile];

    }
}

- (void)copyFile {

    NSError *error = nil;

    NSFileManager *fileManager = [[NSFileManager alloc] init];
    NSString *sourceFile = @"~/path/to/file.txt";
    NSString *destFile = @"~/Library/Application Support/myApp/file.txt";

    if ([fileManager copyItemAtPath:sourceFile toPath:destFile error:&error] == YES) {
        NSLog (@"[FILE] Copied.");
        // NSLog (@"Copy successful");
    } else {
        NSLog (@"[FILE] Copy failed.");
        NSLog (@" %@ %@",sourceFile, destFile);
        // NSLog (@"Copy failed");
    }

    [fileManager release];

    return;
}

- (BOOL)blessHelperWithLabel:(NSString *)label error:(NSError **)error;
{
    BOOL result = NO;

    AuthorizationItem authItem      = { kSMRightBlessPrivilegedHelper, 0, NULL, 0 };
    AuthorizationRights authRights  = { 1, &authItem };
    AuthorizationFlags flags        =   kAuthorizationFlagDefaults              | 
                                        kAuthorizationFlagInteractionAllowed    |
                                        kAuthorizationFlagPreAuthorize          |
                                        kAuthorizationFlagExtendRights;

    AuthorizationRef authRef = NULL;

    /* Obtain the right to install privileged helper tools (kSMRightBlessPrivilegedHelper). */
    OSStatus status = AuthorizationCreate(&authRights, kAuthorizationEmptyEnvironment, flags, &authRef);
    if (status != errAuthorizationSuccess) {
        NSLog(@"Failed to create AuthorizationRef, return code %i", status);
    } else {
        /* This does all the work of verifying the helper tool against the application
         * and vice-versa. Once verification has passed, the embedded launchd.plist
         * is extracted and placed in /Library/LaunchDaemons and then loaded. The
         * executable is placed in /Library/PrivilegedHelperTools.
         */
        result = SMJobBless(kSMDomainSystemLaunchd, (CFStringRef)label, authRef, (CFErrorRef *)error);
    }

    return result;
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:52:52.780

你完全错过了`SMJobBless`. 它不会神奇地使您当前的应用程序能够执行特权操作。相反，它安装并运行一个单独的帮助工具，该工具被允许做特权的事情，但不应该做其他事情（尽可能少）。

您需要`copyFile`将[代码`main`移入`SMJobBlessHelper.c`](https://developer.apple.com/library/mac/#samplecode/SMJobBless/Listings/SMJobBlessHelper_SMJobBlessHelper_c.html#//apple_ref/doc/uid/DTS40010071-SMJobBlessHelper_SMJobBlessHelper_c-DontLinkElementID_7). （因为那是一个 C 文件，你必须要么用 C 重写它——也许使用 CoreFoundation——或者你必须改变工具来使用 Objective-C。没人说这很容易。）

# google-app-engine - GAE 上云存储的 FileNotOpenedError

> ID：11514264
> 
> 赞同：2
> 
> 时间：2012-07-16T23:54:08.553
> 
> 标签：google-app-engine, google-cloud-storage

我正在尝试从远程 api shell 写入云存储中的文件，并看到以下内容：

```
s~appid> FILENAME = '/gs/test_bucket/test'

s~appid> writable_file = files.gs.create(FILENAME,
mime_type='application/octet-stream', acl='project-private')

s~appid> with files.open(writable_file, 'a') as f:
          ...     f.write('[]')
          ...
---------------------------------------------------------------------------
FileNotOpenedError                        Traceback (most recent call last)
/Users/dhruvkaranmehta/Projects/getaround3/tools/g3/shell.pyc in <module>()
      1 with files.open(writable_file, 'a') as f:
----> 2     f.write('[]')
      3

/usr/local/google_appengine/google/appengine/api/files/file.pyc in
__exit__(self, atype, value, traceback)
    288
    289   def __exit__(self, atype, value, traceback):
--> 290     self.close()
    291
    292   def write(self, data, sequence_key=None):

/usr/local/google_appengine/google/appengine/api/files/file.pyc in
close(self, finalize)
    282     request.set_filename(self._filename)
    283     request.set_finalize(finalize)
--> 284     self._make_rpc_call_with_retry('Close', request, response)
    285
    286   def __enter__(self):

/usr/local/google_appengine/google/appengine/api/files/file.pyc in
_make_rpc_call_with_retry(self, method, request, response)
    395   def _make_rpc_call_with_retry(self, method, request, response):
    396     try:
--> 397       _make_call(method, request, response)
    398     except (ApiTemporaryUnavailableError,
FileTemporaryUnavailableError):
    399

/usr/local/google_appengine/google/appengine/api/files/file.pyc in
_make_call(method, request, response, deadline)
    243     rpc.check_success()
    244   except apiproxy_errors.ApplicationError, e:
--> 245     _raise_app_error(e)
    246
    247

/usr/local/google_appengine/google/appengine/api/files/file.pyc in
_raise_app_error(e)
    186   elif (e.application_error ==
    187         file_service_pb.FileServiceErrors.FILE_NOT_OPENED):
--> 188     raise FileNotOpenedError()
    189   elif (e.application_error ==
    190         file_service_pb.FileServiceErrors.READ_ONLY):

FileNotOpenedError: 
```

这看起来很奇怪，因为文件刚刚打开。我还看到了另一种情况，在“a”模式下打开文件会导致`FinalizationError`.

任何其他信息都将非常有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:15:42.373

对于第一部分，有一个功能请求来支持来自远程 api shell 的文件 api。您能否使用交互式控制台尝试相同的操作（请参阅[公共/上传的应用程序引擎应用程序是否有交互式控制台？](https://stackoverflow.com/questions/11404732/is-there-an-interactive-console-for-public-uploaded-app-engine-apps/11405475#11405475)）。

关于您的第二个错误，[文档](https://developers.google.com/appengine/docs/python/googlestorage/functions#open)指出：

> 您无法打开和写入已完成的文件。

# android - SetImageDrawable

> ID：11514266
> 
> 赞同：2
> 
> 时间：2012-07-16T23:54:35.603
> 
> 标签：android, imageview

有人可以帮忙吗？我正在生成一个随机数，并基于这个随机数我想从我的 res/drawable-mdpi 文件夹中选择一个 png 文件来显示。这是我正在使用的代码：

```
 public void DisplayRandomPicture(int randomNumber) 
    {   
    String drawableName = "c"+ randomNumber;

    ImageView image= (ImageView)findViewById(R.id.imageView1);  
    image.setImageDrawable(getResources().getDrawable(getResources().getIdentifier(drawableName, "res/drawable-mdpi", getPackageName())));

    } 
```

res/drawable-mdpi 文件夹中的所有文件都以“c”开头。image.setImageDrawable 语法有问题。当我运行我的应用程序时，它崩溃了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T00:04:25.107

```
public void DisplayRandomPicture(int randomNumber) 
    {   
    String drawableName = "c"+ randomNumber;

    ImageView iw= (ImageView)findViewById(R.id.imageView1);  
    resID = getResources().getIdentifier(drawableName, "drawable",  getPackageName());
    iw.setImageResource(resID);

    } 
```

在上面尝试并确保图像以确切的名称存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:08:38.540

我通过使用解决了这个问题：

```
 int id = getBaseContext().getResources().getIdentifier(drawableName, "drawable", getPackageName());

    image.setImageResource(id); 
```

# cocoa - 我怎么知道 NSWindow 是使用关闭按钮关闭的？

> ID：11514267
> 
> 赞同：6
> 
> 时间：2012-07-16T23:54:45.583
> 
> 标签：cocoa, nswindow

有没有一种简单的方法可以知道何时使用关闭按钮（窗口标题栏的）关闭 NSWindow 。

使用`NSWindowDelegate`和`windowWillClose:(NSNotification *)notification`方法我会收到每次关闭的通知。但是我怎么知道关闭请求是由关闭按钮发送的

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-17T00:12:32.227

用于`[yourWindow standardWindowButton:NSWindowCloseButton]`找到关闭按钮，然后将其目标和操作更改为自定义方法。

# ruby-on-rails - X-Frame-Options ALLOW-FROM 特定站点允许所有

> ID：11514270
> 
> 赞同：13
> 
> 时间：2012-07-16T23:55:33.377
> 
> 标签：ruby-on-rails, google-chrome, iframe, http-headers, x-frame-options

我正在使用 rails 应用程序来提供来自 abc.com 的页面。在其中，我在我的应用程序控制器中设置了响应标头（对于通过 before_filter 的每个请求），以便只能通过以下代码从特定站点（xyz.com）通过 iframe 访问它：

```
def set_x_frame_options
  response.headers["X-Frame-Options"] = "ALLOW-FROM http://www.xyz.com"
end 
```

问题是，我不仅可以从 xyz 上的 abc.com 访问该页面，还可以在任何其他网站上访问该页面。我想限制对 xyz.com 的访问。当我检查 chrome 控制台中的响应标头时，我可以看到 X-Frame-Options 正在正确传递。这发生在所有浏览器中。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T21:12:59.347

对于那些寻找明确答案的人：它没有在 webkit 中实现，但据报道在 Firefox [18.0](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)版本中可以使用。以下 ruby​​ 语法适用于 OSX 上的 Firefox 20.0：

```
response.headers["X-Frame-Options"] = "Allow-From http://www.website.com" 
```

# django - Django 将 ?next/ 添加到 url

> ID：11514272
> 
> 赞同：1
> 
> 时间：2012-07-16T23:55:45.863
> 
> 标签：django, url

我正在使用 django 装饰器：

```
@permission_required(login_url='/login/', perm='auth.can_view') 
```

但它在我的 url (=> /login/?next=/) 中添加了 '?next=/'。如何解决？

* * *

**UPD**：感谢@benjaoming，我解决了这个问题：

```
@user_passes_test(lambda u: u.has_perm('auth.can_view'), login_url='/login/', redirect_field_name='') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:36:17.927

感谢@benjaoming，我解决了这个问题：

```
@user_passes_test(lambda u: u.has_perm('auth.can_view'), login_url='/login/', redirect_field_name='') 
```

# jpa - 使用 JPA 使用 Hibernate 配置 SpringMVC

> ID：11514273
> 
> 赞同：0
> 
> 时间：2012-07-16T23:55:44.970
> 
> 标签：jpa, spring-mvc

有人可以告诉我在这里做错了什么。我要做的就是使用带有 JPA 配置的 Spring MVC 访问 mysql 数据库。每次运行程序时都会遇到错误。

servlet-context.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
    http://www.springframework.org/schema/mvc 
    http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/context 
    http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/tx
    http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <context:property-placeholder location="classpath:hibernate.properties" />

    <!-- DispatcherServlet Context: defines this servlet's request-processing 
        infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving 
        up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources 
        in the /WEB-INF/views directory -->
    <beans:bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

    <context:component-scan base-package="com.logicalideasJPA" />

    <!-- Enables the Spring MVC @Controller programming model -->
    <tx:annotation-driven transaction-manager="transactionManager" />

    <!-- Declare a JPA entityManagerFactory -->
    <beans:bean id="entityManagerFactory"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <beans:property name="dataSource" ref="dataSource" />
        <beans:property name="loadTimeWeaver">
            <beans:bean
                class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
        </beans:property>
        <beans:property name="jpaVendorAdapter">
            <beans:bean
                class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <beans:property name="showSql" value="true" />
            </beans:bean>
        </beans:property>
    </beans:bean>

    <!-- Declare a transaction manager -->
    <beans:bean id="transactionManager"
        class="org.springframework.orm.jpa.JpaTransactionManager">
        <beans:property name="entityManagerFactory" ref="entityManagerFactory" />
        <beans:property name="dataSource" ref="dataSource" />
    </beans:bean>

    <beans:bean id="dataSource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <beans:property name="driverClassName" value="${database.driver}" />
        <beans:property name="url" value="${database.url}" />
        <beans:property name="username" value="${database.user}" />
        <beans:property name="password" value="${database.password}" />
    </beans:bean>
</beans:beans> 
```

* * *

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0': Initialization of bean failed; nested exception is java.lang.NoClassDefFoundError: com/logicalideas/persistence/Contacts
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at  org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5001)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5289)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1525)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1515)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:28:30.880

看起来您正在扫描 com.logicalideasJPA，

```
<context:component-scan base-package="com.logicalideasJPA" /> 
```

而您的 JPA 类应位于 com.logicalideas.persistence，具体取决于您获得的异常。尝试更改扫描包名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T07:43:35.883

在您的`entityManagerFactory`bean 中，您必须设置要扫描的包，以便休眠可以找到您的实体：

```
<beans:bean id="entityManagerFactory"
         class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    ...
    <beans:property name="packagesToScan" value="com.logicalideas.persistence"/>
    ...
</beans:bean> 
```

[您可以在此处](http://goo.gl/Ad5vG)找到更多信息。

# ruby - 在 Ruby 中从字符串中提取参数的最有效方法

> ID：11514275
> 
> 赞同：0
> 
> 时间：2012-07-16T23:55:48.570
> 
> 标签：ruby, string, parsing

我想通过仅读取一次字符串（O（n）时间复杂度）从Ruby中的字符串中提取一些信息。

这是一个例子：

字符串如下所示：`-location here -time 7:30pm -activity biking`

我有一个 Ruby 对象，我想用这个信息填充。所有关键字都是已知的，它们都是可选的。

```
def ActivityInfo
  _attr_reader_ :location, :time, :activity

  def initialize(str)
    @location, @time, @activity = DEFAULT_LOCATION, DEFAULT_TIME, DEFAULT_ACTIVITY

    # Here is how I was planning on implementing this
    current_string = ""
    next_parameter = nil # A reference to keep track of which parameter the current string is refering to
    words = str.split
    while !str.empty?
      word = str.shift
      case word
      when "-location"
        if !next_parameter.nil?
          next_parameter.parameter = current_string # Set the parameter value to the current_string
          current_string = ""
        else
        next_parameter = @location
      when "-time"
        if !next_parameter.nil?
          next_parameter.parameter = current_string
          current_string = ""
        else
        next_parameter = @time
      when "-activity"
        if !next_parameter.nil?
          next_parameter.parameter = current_string
          current_string = ""
        else
        next_parameter = @time
      else
        if !current_string.empty?
          current_string += " "
        end
        current_string += word
      end
    end
  end   
end 
```

所以基本上我只是不知道如何让一个变量成为另一个变量或方法的引用，这样我就可以将它设置为一个特定的值。或者也许还有另一种更有效的方法来实现这一目标？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:14:27.917

该字符串看起来很像命令行，并且有一些很好的 Ruby 模块可以解析它们，例如[`optparse`](http://ruby-doc.org/stdlib-1.9.3/libdoc/optparse/rdoc/OptionParser.html).

假设不是，这里有一种将示例中的命令解析为哈希的快速方法：

```
cmd = '-location here -time 7:30pm -activity biking'
Hash[*cmd.scan(/-(\w+) (\S+)/).flatten] 
```

结果是：

```
{
    "location" => "here",
        "time" => "7:30pm",
    "activity" => "biking"
} 
```

进一步扩展它：

```
class ActivityInfo
  def initialize(h)
    @location = h['location']
    @time     = h['time'    ]
    @activity = h['activity']
  end
end
act = ActivityInfo.new(Hash[*cmd.scan(/-(\w+) (\S+)/).flatten]) 
```

哪个设置`act`为 ActivityInfo 的实例，如下所示：

```
#<ActivityInfo:0x101142df8
    @activity = "biking",
    @location = "here",
    @time = "7:30pm"
> 
```

--

OP 询问如何处理命令未标记`-`或为多个单词的情况。这些是等价的，但我更喜欢第一个风格：

```
irb(main):003:0> cmd.scan(/-((?:location|time|activity)) \s+ (\S+)/x)
[
    [0] [
        [0] "location",
        [1] "here"
    ],
    [1] [
        [0] "time",
        [1] "7:30pm"
    ],
    [2] [
        [0] "activity",
        [1] "biking"
    ]
]

irb(main):004:0> cmd.scan(/-(location|time|activity) \s+ (\S+)/x)
[
    [0] [
        [0] "location",
        [1] "here"
    ],
    [1] [
        [0] "time",
        [1] "7:30pm"
    ],
    [2] [
        [0] "activity",
        [1] "biking"
    ]
] 
```

如果命令是多个单词，例如“at location”：

```
irb(main):009:0> cmd = '-at location here -time 7:30pm -activity biking'
"-at location here -time 7:30pm -activity biking"
irb(main):010:0> 
irb(main):011:0* cmd.scan(/-((?:at \s location|time|activity)) \s+ (\S+)/x)
[
    [0] [
        [0] "at location",
        [1] "here"
    ],
    [1] [
        [0] "time",
        [1] "7:30pm"
    ],
    [2] [
        [0] "activity",
        [1] "biking"
    ]
] 
```

如果您需要更大的灵活性，请查看 Ruby 的[`strscan`](http://ruby-doc.org/stdlib-1.9.3/libdoc/strscan/rdoc/index.html)模块。您可以使用它来拆分字符串并找到命令及其参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:19:37.723

### 将字符串转换为选项哈希

如果您只想轻松访问您的标志及其值，您可以将您的字符串拆分为一个散列，其中每个标志都是一个键。例如：

```
options = Hash[ str.scan /-(\w+)\s+(\S+)/ ]
=> {"location"=>"here", "time"=>"7:30pm", "activity"=>"biking"} 
```

然后，您可以直接引用值（例如`options['location']`）或遍历键/值对中的散列。例如：

```
options.each_pair { |k, v| puts "%s %s" % [k, v] } 
```

### 少量元编程

好的，这是严重的过度设计，但我在这个问题上花了一些额外的时间，因为我觉得它很有趣。我并不是说以下内容有用；我只是说这对我来说很有趣。

如果您想解析您的选项标志并动态创建一组属性读取器*并*设置一些实例变量，而不必单独定义每个标志或变量，您可以通过少量元编程来做到这一点。

```
# Set attribute readers and instance variables dynamically
# using Kernel#instance_eval.
class ActivityInfo
  def initialize(str)
    options = Hash[ str.scan /-(\w+)\s+(\S+)/ ]
    options.each_pair do |k, v|
      self.class.instance_eval { attr_reader k.to_sym }
      instance_variable_set("@#{k}", v)
    end
  end
end

ActivityInfo.new '-location here -time 7:30pm -activity biking'
=> #<ActivityInfo:0x00000001b49398
 @activity="biking",
 @location="here",
 @time="7:30pm"> 
```

老实说，我认为从选项哈希中明确设置变量，例如：

```
@activity = options['activity']` 
```

将更清楚地传达您的意图（并且更具可读性），但有替代方案总是好的。你的旅费可能会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T11:44:49.167

[当托尔](https://github.com/wycats/thor/wiki)可以为您完成繁重的工作时，为什么要重新发明轮子？

```
class ActivityInfo < Thor

  desc "record", "record details of your activity"
  method_option :location, :type => :string,   :aliases => "-l", :required => true
  method_option :time,     :type => :datetime, :aliases => "-t", :required => true
  method_option :activity, :type => :string,   :aliases => "-a", :required => true
  def record
    location = options[:location]
    time = options[:time]
    activity = options[:activity]

    # record details of the activity
  end

end 
```

这些选项将根据您指定的数据类型为您解析。您可以以编程方式调用它：

```
task = ActivityInfo.new([], {location: 'NYC', time: Time.now, activity: 'Chilling out'})
task.record 
```

或从命令行：`thor activity_info:record -l NYC -t "2012-06-23 02:30:00" -a "Chilling out"`

# ios - 如何只响应单击手势而让后面的对象响应双击？

> ID：11514276
> 
> 赞同：6
> 
> 时间：2012-07-16T23:55:56.340
> 
> 标签：ios, uiwebview, uikit, uigesturerecognizer, ios5

我在 UIWebView 中显示一个文档。我想在文档上放置一个热点以在点击它时触发一个动作，但我也想保持默认的 UIWebView 行为，即在双击文档时自动缩放文档。我不知道如何在让 UIWebView 响应双击时响应单击。

我首先将热点设置为带有动作的透明 UIButton，但双击热点会导致热点动作被调用两次。因此，我从按钮中删除了该操作并附加了一个单击手势：

```
UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(singleTapAction:)];
singleTap.numberOfTapsRequired = 1;
singleTap.delegate = self;
[self.hotspot addGestureRecognizer:singleTap];
[singleTap release]; 
```

这与正常的按钮操作相同。但后来我创建了一个双击手势，并将其配置为使用 requireGestureRecognizerToFail 阻止单击手势：

```
UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(zoomWebView:)];
doubleTap.numberOfTapsRequired = 2;
doubleTap.delegate = self;
[self.hotspot addGestureRecognizer:doubleTap];
[doubleTap release];

UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(singleTapAction:)];
singleTap.numberOfTapsRequired = 1;
[singleTap requireGestureRecognizerToFail:doubleTap];
singleTap.delegate = self;
[self.hotspot addGestureRecognizer:singleTap];
[singleTap release];

- (void)zoomWebView:(UITapGestureRecognizer *)gesture {
    NSLog(@"double tap");
} 
```

使用此设置，单击热点调用 singleTapAction，双击热点调用 zoomWebView（自定义方法）。这很好，因为 singleTapAction 不再被调用两次，但很糟糕，因为 UIWebView 不再响应双击。

我尝试通过继承 UITapGestureRecognizer、覆盖 touchesBegan 和 touchesEnded 方法并将它们的参数发送到 UIWebView 的相应方法，将双击事件从我的 doubleTap 手势转发到 UIWebView。当我这样做时，我可以看到我的子类正在接收事件，但 UIWebView 没有响应转发的事件。这是意料之中的，因为[iOS 的事件处理指南](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MultitouchEvents/MultitouchEvents.html#//apple_ref/doc/uid/TP40009541-CH3-SW1)说我们只能将事件转发到 UIView 的自定义子类，而不是 UIKit 框架对象。

有没有办法阻止我的单击手势响应不会转移双击事件的双击？这似乎是一个基本要求，但我看不到一个直接的方法来做到这一点。我阅读并尝试了 UIGestureRecognizer 的[触摸传递属性](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html#//apple_ref/doc/uid/TP40009541-CH6-SW20)，但没有任何值组合阻止单击手势消耗双击手势。

顺便说一句，我的视图层次结构中的热点和 UIWebView 之间的关系是“表亲”的关系——它们是两个兄弟视图的子视图。如果我将手势识别器添加到热点视图、Web 视图或它们的“祖父母”视图，我会得到相同的结果。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T18:42:38.450

好的，我找到了两个部分的解决方案：

1) 我必须将我的手势添加到 UIWebView 的父视图中。无与伦比的事件不会像我想象的那样在一个层到另一个层的视图中穿过重叠的对象。相反，它们通过从子到父的视图层次结构。因此，只要我将双击手势添加到 UIWebView 的兄弟或“表亲”视图，它就永远不会继续到 Web 视图。这意味着我不能使用 Interface Builder 中布局的按钮或视图来确定多个热点区域。相反，我必须将所有单击事件重定向到一种方法，然后查看触摸位置以确定要触发的操作。

2）我必须将gestureRecognizer：shouldRecognizeSimultaneouslyWithGestureRecognizer：方法添加到我的视图控制器（我的手势代表）并返回YES。即使我在 UIWebView 中显示 HTML、文本或图像内容，这也允许我的单击手势做出响应，它为这些内容类型实现了自己的手势。我从[这个答案](https://stackoverflow.com/a/9136866/462162)中学到了这一部分。

通过这些更改，我理解事件的层次结构是：

*   单击 Web 视图：我在 Web 视图的父视图上的单击手势响应；如果适用，Web 视图的单击手势也会响应，因为同时启用了手势

*   双击 Web 视图：我在 Web 视图的父视图上的双击手势响应（但不执行任何操作）；我的单击手势没有响应，因为它被配置为仅在双击失败时才响应；Web 视图的双击事件也会响应，因为它是视图层次结构的一部分（似乎 Web 视图的双击功能不使用手势，否则在我的原始设置中它会优先于我自己的手势)

有了这个解释，这里有一些工作代码：

```
- (void)viewDidLoad {
    UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(doubleTapWebView:)];
    doubleTap.numberOfTapsRequired = 2;
    doubleTap.delegate = self;
    [self.webViewParent addGestureRecognizer:doubleTap];
    [doubleTap release];

    UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(singleTapWebView:)];
    singleTap.numberOfTapsRequired = 1;
    [singleTap requireGestureRecognizerToFail:doubleTap];
    singleTap.delegate = self;
    [self.webViewParent addGestureRecognizer:singleTap];
    [singleTap release];
}

- (void)doubleTapWebView:(UITapGestureRecognizer *)gesture {
    NSLog(@"double-tap");
    // nothing to do here
}

- (void)singleTapWebView:(UITapGestureRecognizer *)gesture {
    NSLog(@"single-tap");
    CGPoint touchLocation = [gesture locationInView:self.webViewParent];
    float x = touchLocation.x;
    float y = touchLocation.y;
    CGRect frame = self.webViewParent.frame;
    if (y < frame.size.height * .33) {
        NSLog(@"top");
    } else if (y > frame.size.height * .67) {
        NSLog(@"bottom");
    } else if (x < frame.size.width * .33) {
        NSLog(@"left");
    } else if (x > frame.size.width * .67) {
        NSLog(@"right");
    } else {
        NSLog(@"center");
    }
}

- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer {
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-17T00:05:51.600

自事件处理开始以来，鼠标点击一直是个问题。

在单击的情况下，任何软件都不可能确定双击即将发生。

因此，如果要处理单击和双击，则必须自己进行双击处理。

为单击的实例计时，并生成您自己的双击事件。

希望这可以转移到您的上下文中。

# python - 如何使用 pyparsing 解析来自 VC++ autoexp.dat 的数据？

> ID：11514277
> 
> 赞同：0
> 
> 时间：2012-07-16T23:55:59.133
> 
> 标签：python, pyparsing

我无法理解如何使用 python 解析以下数据。我不明白如何从嵌套的 #( 和 #if( 。

```
preview
(
    #if ($e.d.stateFlags == 0) (
        $e.d
    ) #else (
        #( $e.d->scheme, $e.d->host, $e.d->path )
    )
)
children
(
    #(
        scheme: $c.d->scheme,
        host: $c.d->host,
        path: $c.d->path,
        username: $c.d->userName,
        password: $c.d->password,
        encodedOriginal: $c.d->encodedOriginal,
        query: $c.d->query,
        fragment: $c.d->fragment
    )
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:25:33.987

使用 Group 在已解析的标记中创建层次结构。然后，您可以导航组列表并访问其中的命名字段。像这样的东西：

```
from pyparsing import *

LPAR,RPAR,COMMA,HASH,COLON = map(Suppress, '(),#:')
ident = Word(alphas+'_', alphanums+'_')
fnumber = Regex(r'[+-]?\d+\.\d*').setParseAction(lambda t:float(t[0]))
inumber = Regex(r'[+-]?\d+').setParseAction(lambda t:int(t[0]))
number = fnumber | inumber
ref_name = Combine("$" + delimitedList(ident, delim=oneOf(". ->"), combine=True))
named_ref = Group(ident("name") + COLON + ref_name("ref"))
unnamed_ref = Group(ref_name("ref"))

IF, ELSE = map(Keyword, "if else".split())

stmt = Forward()

decl = named_ref | unnamed_ref

def setType(typ):
    def parseAction(tokens):
        tokens['type'] = typ
    return parseAction
cond = operatorPrecedence(ref_name | number,
            [
            (oneOf("< == > <= >= !="), 2, opAssoc.LEFT),
            ])
if_else = Group(HASH + IF + LPAR + cond("condition") + RPAR + 
                    LPAR + stmt("then") + RPAR + 
                    Optional(HASH + ELSE + LPAR + stmt("else") + RPAR))

if_else.setParseAction(setType("IF_ELSE"))
decl.setParseAction(setType("DECL"))

stmt << Group(decl | if_else | (HASH + LPAR + delimitedList(stmt) + RPAR))

section = Group(ident("section_name") + LPAR + Group(ZeroOrMore(stmt))("section_body") + RPAR)

parser = OneOrMore(section)

source = """
preview 
( 
    #if ($e.d.stateFlags == 0) ( 
        $e.d 
    ) #else ( 
        #( $e.d->scheme, $e.d->host, $e.d->path ) 
    ) 
) 
children 
( 
    #( 
        scheme: $c.d->scheme, 
        host: $c.d->host, 
        path: $c.d->path, 
        username: $c.d->userName, 
        password: $c.d->password, 
        encodedOriginal: $c.d->encodedOriginal, 
        query: $c.d->query, 
        fragment: $c.d->fragment 
    ) 
)"""

def dump_stmt(tokens, depth=0):
    if 'type' in tokens:
        print tokens.type
        print tokens[0].dump(depth=depth)
    else:
        for stmt in tokens:
            dump_stmt(stmt, depth=depth+1)

for sec in parser.parseString(source):
    print sec.dump()
    print sec.section_name
    for statement in sec.section_body:
        dump_stmt(statement)
    print 
```

印刷：

```
['preview', [[['if', ['$e.d.stateFlags', '==', 0], [['$e.d']], 'else', [[['$e.d->scheme']], [['$e.d->host']], [['$e.d->path']]]]]]]
- section_body: [[['if', ['$e.d.stateFlags', '==', 0], [['$e.d']], 'else', [[['$e.d->scheme']], [['$e.d->host']], [['$e.d->path']]]]]]
- section_name: preview
preview
IF_ELSE
['if', ['$e.d.stateFlags', '==', 0], [['$e.d']], 'else', [[['$e.d->scheme']], [['$e.d->host']], [['$e.d->path']]]]
- condition: ['$e.d.stateFlags', '==', 0]
- else: [[['$e.d->scheme']], [['$e.d->host']], [['$e.d->path']]]
- then: [['$e.d']]
  - type: DECL

['children', [[[['scheme', '$c.d->scheme']], [['host', '$c.d->host']], [['path', '$c.d->path']], [['username', '$c.d->userName']], [['password', '$c.d->password']], [['encodedOriginal', '$c.d->encodedOriginal']], [['query', '$c.d->query']], [['fragment', '$c.d->fragment']]]]]
- section_body: [[[['scheme', '$c.d->scheme']], [['host', '$c.d->host']], [['path', '$c.d->path']], [['username', '$c.d->userName']], [['password', '$c.d->password']], [['encodedOriginal', '$c.d->encodedOriginal']], [['query', '$c.d->query']], [['fragment', '$c.d->fragment']]]]
- section_name: children
children
DECL
['scheme', '$c.d->scheme']
  - name: scheme
  - ref: $c.d->scheme
DECL
['host', '$c.d->host']
  - name: host
  - ref: $c.d->host
DECL
['path', '$c.d->path']
  - name: path
  - ref: $c.d->path
DECL
['username', '$c.d->userName']
  - name: username
  - ref: $c.d->userName
DECL
['password', '$c.d->password']
  - name: password
  - ref: $c.d->password
DECL
['encodedOriginal', '$c.d->encodedOriginal']
  - name: encodedOriginal
  - ref: $c.d->encodedOriginal
DECL
['query', '$c.d->query']
  - name: query
  - ref: $c.d->query
DECL
['fragment', '$c.d->fragment']
  - name: fragment
  - ref: $c.d->fragment 
```

# asp.net-mvc - 在 MVC 中映射 M->VM 的最佳位置？

> ID：11514284
> 
> 赞同：0
> 
> 时间：2012-07-16T23:56:29.617
> 
> 标签：asp.net-mvc, model-view-controller

我使用 ASP.NET MVC 3。

我遇到了至少 2 种在服务器端映射 Model->ViewModel 的方法：

*   ViewModel 类构造函数内部
*   在 Controller 或指定的映射器类中

我最喜欢第一种方法，因为 ViewModel 属性声明及其映射在同一个地方，易于维护和单元测试。任何人都可以指定更多的利弊，或其他更好的做法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:02:24.360

ViewModel 可以独立于任何源自数据库的模型类而存在。

我不建议将 ViewModel 填充代码放在控制器中，因为这不是控制器的责任（也是维护的噩梦）。

我的观点是从 ViewModel 映射到 DBModel（反之亦然）是 ViewModel 的责任，所以我所有的 ViewModel 类都实现了两个成员：

```
public static TViewModel FromDBModel(TDBModel dbModel);

public void ToDBModel(TDBModel dbModel); 
```

第一个是Controller在返回View时调用的静态方法。静态方法构造 ViewModel 的一个实例并相应地设置其成员。

实例 ToDBModel 方法传递一个构造的 DBModel 实例（在检索或更新数据时由 Repository 构造，或在插入新数据时由控制器构造）。

HTH。

编辑：请注意，许多人对 AutoMapper 等库发誓（它使用反射和其他技巧来自动化 DBModel<->ViewModel 映射过程）。我不喜欢自动映射，因为它会从开发人员手中夺走控制权，而且当我必须了解映射器的工作原理以及如何让它映射非平凡的操作时，我认为它不会为我争取时间。YMMV。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:17:26.920

我倾向于将实体和视图模型分开，以使它们彼此不知道。这是为了在测试控制器和映射本身时改进封装并最小化依赖关系。请参阅[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)。

相反，我会编写类来自己执行映射（如果它简单的话）或使用 AutoMapper 并在控制器中使用该方法。对于具有数十或数百个数据库实体和视图的大型系统，我倾向于使用 AutoMapper。自己编写映射会变得非常乏味且容易出错。你必须平衡你自己编写它的价值和这种实现给业务带来的价值。毕竟，如果我们想了解每个框架的一切，我们每个人都会编写自己的 .NET 框架版本。:)

也就是说，对某些系统使用视图模型可能没有什么好处，尤其是那些在视图中的“字段”和数据库实体之间存在一对一映射的系统 [又名典型的 CRUD]。当我看到这一点时，我通常会畏缩，但考虑到系统的时间框架和复杂性，它始终是一种选择。

然后有一种情况是你使用 ASP.NET MVC 来暴露一个 API。在这种情况下，实体的“application/json”和“text/xml”表示只是“视图”。视图模型通常用于从外部演示中过滤敏感和不必要的数据。在这种情况下，映射变得相当复杂，因为同一实体可能有多个表示（及其版本）。但是，这似乎在 OP 之外。

# wpf - ComboBox ItemTemplate 不支持“图像”类型的值

> ID：11514285
> 
> 赞同：-1
> 
> 时间：2012-07-16T23:56:30.123
> 
> 标签：wpf, image, binding, combobox, itemtemplate

我正在尝试将 WPF 组合框绑定到可观察的图像集合。这是我的收藏：

```
 public class AvatarPhoto
    {
        public int AvatarId { get; set; }
        public BitmapImage AvatarImage { get; set; }
    }
    public ObservableCollection<AvatarPhoto> AvailableProfilePictures { get; private set; } 
```

这是我的xml： ![在此处输入图像描述](../Images/940abca228e92d94a4286affaadfcc60.png)

Visual Studio 给了我这个编译时错误：属性“ItemTemplate”不支持“Image”类型的值。

为什么会出现此错误？

谢谢

更新：感谢您的回答！它解决了这个问题。

现在我已经更新了我的代码，但我在 ComboBox 中看到了这个： ![在此处输入图像描述](../Images/00d5fff590d8377eb2e1bb9090a6b73b.png)

为什么不能正确显示图片？在调试窗口中，我可以看到我的集合已正确填充：

![在此处输入图像描述](../Images/c30543e0a8d3df82fc949ec7f47759a5.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T23:57:58.387

把你`Image`放在一个`DataTemplate`：

```
<ComboBox.ItemTemplate>
    <DataTemplate>
        <Image />
    </DataTemplate>
</ComboBox.ItemTemplate> 
```

# java - 试图从一组中的一对中检测一个字符串

> ID：11514291
> 
> 赞同：0
> 
> 时间：2012-07-16T23:57:03.697
> 
> 标签：java, android

出于某种原因，我的 == 运算符在应该返回 true 时没有返回。我看到我的手机上显示了两个完全相同的字符串，但它仍然没有注册为真的。有任何想法吗？它是一对（字符串，整数）的哈希集。getFirst 返回该对中的字符串。

```
private boolean contains(HashSet<Pair> mySet, String current) {
        Iterator<Pair> temp = mySet.iterator();
        String compared;
        Toast.makeText(MainActivity.this, " want " +current,
                Toast.LENGTH_LONG).show();
        while (temp.hasNext()) {
            compared = temp.next().getFirst();

                Toast.makeText(MainActivity.this, compared+" "+current,
                        Toast.LENGTH_SHORT).show();
                if (compared==current)
                    Toast.makeText(MainActivity.this, "found", Toast.LENGTH_SHORT).show();
        }

        return false;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T23:59:18.930

字符串不应与 == 进行比较。在java中，字符串是对象，==会检查它们是否是同一个对象引用。如果要检查它们是否包含相同的字符序列，请使用 string.equals(otherString)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T23:59:31.100

改为这样做：

```
if(compared.equals(current)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T23:59:52.337

使用`String.equals()`比较字符串的方法。如`if (string1.equals(string2))...`.

# ruby-on-rails - rails g 设计错误：views 命令

> ID：11514292
> 
> 赞同：0
> 
> 时间：2012-07-16T23:57:06.480
> 
> 标签：ruby-on-rails, ruby, devise

我是 Rails 新手，无法查明问题所在。我正在关注关于设计的 RailsCast 教程 #209，运行时出现错误：rails g devise:views

这是错误：

```
/Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:185:in `default_controller_and_action': missing :action (ArgumentError)
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:78:in `normalize_options!'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:61:in `initialize'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1304:in `new'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1304:in `add_route'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1284:in `decomposed_match'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1270:in `block in match'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1270:in `each'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1270:in `match'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:260:in `root'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/mapper.rb:1317:in `root'
from /Users/chanel.nalani/svn-work/gwb/trunk/PMOCCU/uidevise/config/routes.rb:8:in `block in <top (required)>'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/route_set.rb:282:in `instance_exec'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/route_set.rb:282:in `eval_block'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/actionpack-3.2.5/lib/action_dispatch/routing/route_set.rb:260:in `draw'
from /Users/chanel.nalani/svn-work/gwb/trunk/PMOCCU/uidevise/config/routes.rb:1:in `<top (required)>'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `load'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `block in load'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:245:in `load'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:40:in `each'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:40:in `load_paths'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:16:in `reload!'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:26:in `block in updater'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/file_update_checker.rb:78:in `call'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/file_update_checker.rb:78:in `execute'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:27:in `updater'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application/finisher.rb:66:in `block in <module:Finisher>'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/initializable.rb:30:in `instance_exec'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/initializable.rb:30:in `run'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/initializable.rb:55:in `block in run_initializers'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/initializable.rb:54:in `each'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/initializable.rb:54:in `run_initializers'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application.rb:136:in `initialize!'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/railtie/configurable.rb:30:in `method_missing'
from /Users/chanel.nalani/svn-work/gwb/trunk/PMOCCU/uidevise/config/environment.rb:5:in `<top (required)>'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `block in require'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:236:in `load_dependency'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/activesupport-3.2.5/lib/active_support/dependencies.rb:251:in `require'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/application.rb:103:in `require_environment!'
from /Users/chanel.nalani/.rvm/gems/ruby-1.9.2-p320/gems/railties-3.2.5/lib/rails/commands.rb:25:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

我更改了 ruby​​ 的版本以查看是否可以解决问题，但我无法找到确切的问题。有没有其他人遇到过这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:22:01.283

看起来您缺少一些需要完成的手动设置（正如@dougui 和@janders223 指出的那样，这很可能是您的路线），在您完成运行后立即打印在控制台上`rails generate devise:install`：

```
===============================================================================

Some setup you must do manually if you haven't yet:

  1\. Ensure you have defined default url options in your environments files. Here 
     is an example of default_url_options appropriate for a development environment 
     in config/environments/development.rb:

       config.action_mailer.default_url_options = { :host => 'localhost:3000' }

     In production, :host should be set to the actual host of your application.

  2\. Ensure you have defined root_url to *something* in your config/routes.rb.
     For example:

       root :to => "home#index"

  3\. Ensure you have flash messages in app/views/layouts/application.html.erb.
     For example:

       <p class="notice"><%= notice %></p>
       <p class="alert"><%= alert %></p>

  4\. If you are deploying Rails 3.1 on Heroku, you may want to set:

       config.assets.initialize_on_precompile = false

     On config/application.rb forcing your application to not access the DB
     or load models when precompiling your assets.

=============================================================================== 
```

取自[https://github.com/plataformatec/devise/blob/master/lib/generators/templates/README](https://github.com/plataformatec/devise/blob/master/lib/generators/templates/README)

# php - /日期(1341788400000+0100)/ 至 DD/MM/YYYY HH:MM

> ID：11514294
> 
> 赞同：0
> 
> 时间：2012-07-16T23:57:35.333
> 
> 标签：php, datetime, date, time, format

我有几个日期被输出到变量中。它们的格式如下：

```
/Date(1341788400000+0100)/ 
```

我将如何使用 PHP 将它们格式化为：

```
DD/MM/YYYY HH:MM 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T17:02:26.567

我最终使用了以下内容，因为初始格式以毫秒为单位：

```
$date = 1341788400000+0100;
$date = ( $date / 1000 );
$date = date("d/m/Y H:m", $date); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:01:36.717

```
$date = 1341788400000+0100;
echo date("Y/m/d H:m",$date); 
```

除非 +0100 是一天中的实际时间 (01:00) 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T00:03:05.810

首先，你解析它，例如使用`strtok()` [http://php.net/manual/en/function.strtok.php](http://php.net/manual/en/function.strtok.php)

然后将其解析为数字。

```
$seconds = intval($a) 
```

然后使用格式化

```
date("Y/m/d H:m", $seconds)`. 
```

# opencv - OpenCV 2.1 到 OpenCV2.4 性能提升？

> ID：11514298
> 
> 赞同：1
> 
> 时间：2012-07-16T23:57:56.153
> 
> 标签：opencv

我想知道从 OpenCV2.1 更改为 OpenCV2.4 时是否有任何性能提升？

此外，我还阅读了一些关于使用 OpenCV 进行 GPU 开发的内容。有人可以推荐任何初学者指南/入门书吗？是否像将矩阵重新定义为 cv::gpu::GpuMat 一样简单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:03:24.343

完整的源代码构建中有一组性能测试 - 但通常每个版本的 openCV 都会尝试尽可能提高性能

是的，使用 GPU 本质上与使用 cv::gpu::Mat 一样简单，尽管并非所有代码都移植到 CUDA，当然也不是所有代码都会受益，请参阅[http://docs.opencv.org/modules/gpu/文档/gpu.html](http://docs.opencv.org/modules/gpu/doc/gpu.html)

# jquery - jqPlot 出现在图表下方的折线图图例

> ID：11514301
> 
> 赞同：0
> 
> 时间：2012-07-16T23:58:24.360
> 
> 标签：jquery, jqplot

尽管将渲染选项指定为“insidegrid”，但我的 jqPlot 折线图图例 (1111,1112,1114) 仍出现在图形下方。

我不确定问题出在哪里。这是我在 jsfiddle [http://jsfiddle.net/jdev/Y7FpV/3/中的代码](http://jsfiddle.net/jdev/Y7FpV/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T06:52:07.257

你的问题是你没有包含`jquery.jqplot.css`在你的代码中。链接到它，图例在网格内呈现。这是更新的 jsFiddle - [http://jsfiddle.net/nonocut/phRJx/](http://jsfiddle.net/nonocut/phRJx/)

# php - 使用 strpos() 搜索针值数组

> ID：11514302
> 
> 赞同：1
> 
> 时间：2012-07-16T23:58:32.160
> 
> 标签：php

我正在尝试使用 strpos 在使用 PHP 的字符串中搜索一些关键词。我的问题是如何添加一个数组，以便在下面的代码中搜索“keyword1”和“keyword2”。

```
if (strpos($string,'keyword1') !== false) {
$hasstring = "yes";
} 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T00:02:42.273

你不能给`strpos`一个数组，所以你必须手动完成。

```
$keywords = array('keyword1', 'keyword2');

foreach($keywords as $keyword) {
    if (strpos($string, $keyword) !== false) {
        $hasString = true;
        break; // stops searching the rest of the keywords if one was found
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T00:02:06.230

如果我正确理解您的问题，则不需要数组。您可以简单地将 strpos 与 or (in php, ||) 运算符一起使用两次

```
if (strpos($string,'keyword1') || strpos($string,'keyword2')) {
$hasstring = "yes";
} 
```

# mysql - 如何操作 SQL 中的 VARCHAR 字段以简化从 Bugzilla 到 Redmine 迁移中的路线图集合？

> ID：11514305
> 
> 赞同：1
> 
> 时间：2012-07-16T23:59:19.247
> 
> 标签：mysql, migration, redmine, varchar, bugzilla

根据[之前的问题](https://stackoverflow.com/questions/11511331/how-can-i-migrate-versions-from-bugzilla-into-a-new-custom-source-version-fiel)，我正在从 Bugzilla 迁移到 Redmine，在此过程中，我想利用 Redmine 提供的路线图。

在 bugzilla 中，总是针对导致问题出现的软件版本记录错误，尽管我现在已将此信息保存在自定义字段中（请参阅上面提到的较早问题），但我现在需要将路线图减少到更易于管理的东西，即：

1.  将所有错误的版本更改为符合路线图的简化等效版本（例如，0.1234 变为 0.1，2.9876 变为 2.9）。这允许任何一个路线图版本拥有多达 999 个子版本，这正是我们已经倾向于使用 Bugzilla 所做的事情。
2.  将所有打开的错误更改为新的“计划外”版本。
3.  删除所有当前未使用的版本号

我想这可以通过以下步骤来实现：

1.  获取所有可用的当前版本
2.  对于检索到的每个版本，去掉除前三个字符之外的所有字符
3.  检查该产品的版本号是否已存在。
4.  如果版本号是新的，则将其添加为新版本。
5.  遍历数据库中的每个问题，并且 (a) 如果问题已关闭，则将其分配给缩短的版本号或 (b) 如果问题仍然打开，将其分配给“未计划”版本。

...但是唉，我缺乏 SQL 知识让我失望了。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T08:22:41.167

此查询按项目为您获取所有现有版本的所有 3 字符版本名称：

```
SELECT DISTINCT v.project_id, Left(v.name, 3) newversionname
    FROM issues i
        INNER JOIN versions v ON i.fixed_version_id=v.id 
```

您需要一个列表，其中包含所有尚不存在的 3 字符版本名称：

```
SELECT f.project_id, f.newversionname
    FROM (
        SELECT DISTINCT v.project_id, Left(v.name, 3) newversionname
            FROM issues i INNER JOIN versions v ON i.fixed_version_id=v.id
    ) f
    LEFT OUTER JOIN versions v2 ON f.project_id = v2.project_id and f.newversionname=v2.name
    WHERE v2.project_id is null 
```

您需要为上述查询的每个结果插入新版本（我会将上述查询的改编作为`INSERT`查询留给您......）。

* * *

**编辑**：更新查询以添加版本详细信息

```
SELECT f.project_id, f.newversionname, v3.description, v3.created_on, v3.updated_on
    FROM (
        SELECT v.project_id, Left(v.name, 3) newversionname, MIN(v.id) minversionid
            FROM issues i INNER JOIN versions v ON i.fixed_version_id=v.id
            GROUP BY v.project_id
    ) f
    LEFT OUTER JOIN versions v2 ON f.project_id = v2.project_id and f.newversionname=v2.name
    INNER JOIN versions v3 ON f.minversionid=v3.id
    WHERE v2.project_id is null 
```

这将简单地为每个新版本选择具有最低 id 的版本的详细信息。

* * *

**注意**：如果您的版本大于 9（即`11.234`变为`11.`），这将中断。

现在我们现在，对于与旧版本相关的每个问题，都存在一个新的 3 字符版本。以下查询显示了哪一个：

```
SELECT DISTINCT i.id, v.id oldversionid, v.name oldversionname, v2.id newversionid, v2.name newversionname
    FROM issues i
        INNER JOIN versions v ON i.fixed_version_id=v.id
        INNER JOIN versions v2 ON LEFT(v.name, 3) = v2.name and v.project_id = v2.project_id
    WHERE v.id <> v2.id 
```

您可以使用此查询并`UPDATE`在经过健全性检查后将其调整为查询。您仍然需要添加标准来区分打开和关闭的问题 ( `status_id`)。

希望这对您的迁移有所帮助，享受 redmine 的乐趣！

# javascript - JavaScript 数组的大 O

> ID：11514308
> 
> 赞同：118
> 
> 时间：2012-07-16T23:59:38.373
> 
> 标签：javascript, arrays, algorithm, big-o, time-complexity

JavaScript 中的数组很容易通过添加和删除项来修改。它在某种程度上掩盖了大多数语言数组是固定大小的事实，并且需要复杂的操作来调整大小。似乎 JavaScript 可以轻松编写性能不佳的数组代码。这就引出了一个问题：

**在数组性能方面，我可以从 JavaScript 实现中获得什么性能（就大 O 时间复杂度而言）？**

我假设所有合理的 JavaScript 实现最多有以下大 O。

*   访问 - O(1)
*   追加 - O(n)
*   前置 - O(n)
*   插入 - O(n)
*   删除 - O(n)
*   交换 - O(1)

`new Array(length)`JavaScript 允许您使用语法将数组预填充到特定大小。（额外的问题：以这种方式创建一个数组 O(1) 还是 O(n)）这更像是一个传统的数组，如果用作一个预先确定大小的数组，可以允许 O(1) 追加。如果添加了循环缓冲区逻辑，则可以实现 O(1) 前置。如果使用动态扩展数组，O(log n) 将是这两种情况的平均情况。

我可以期望某些事情的性能比我在这里的假设更好吗？我不希望在任何规范中概述任何内容，但实际上，所有主要实现都可能在幕后使用优化的数组。是否有动态扩展数组或其他一些性能提升算法在起作用？

附言

我想知道这一点的原因是我正在研究一些排序算法，其中大多数在描述它们的整体大 O 时似乎假设追加和删除是 O(1) 操作。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-07-18T06:01:59.867

[注意：虽然这个答案在 2012 年是正确的，但现在引擎对对象和数组使用非常不同的内部表示。这个答案可能是真的，也可能不是。]

与大多数使用数组实现数组的语言相比，在 Javascript 中，数组是对象，并且值存储在哈希表中，就像常规对象值一样。像这样：

*   访问 - O(1)
*   附加 - 摊销 O(1)（有时需要调整哈希表的大小；通常只需要插入）
*   Prepending - O(n) via `unshift`，因为它需要重新分配所有索引
*   插入 - 如果值不存在，则摊销 O(1)。O(n) 如果您想移动现有值（例如，使用`splice`）。
*   删除 - 摊销 O(1) 来删除一个值，如果你想通过`splice`.
*   交换 - O(1)

通常，设置或取消设置 dict 中的任何键都是摊销 O(1)，数组也是如此，无论索引是什么。任何需要对现有值重新编号的操作都是 O(n)，因为您必须更新所有受影响的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-05-10T14:16:08.480

*保证*

任何数组操作都没有指定的时间复杂度保证。数组的执行方式取决于引擎选择的底层数据结构。引擎也可能有不同的表示，并根据某些启发式在它们之间切换。初始数组大小可能是也可能不是这样的启发式方法。

*现实*

例如，V8（截至目前）使用[哈希表](https://en.wikipedia.org/wiki/Hash_table)和[数组列表](https://en.wikipedia.org/wiki/Dynamic_array)来表示数组。它还对对象有各种不同的表示，因此无法比较数组和对象。因此数组访问总是比 O(n) 好，甚至*可能*和 C++ 数组访问一样快。追加是 O(1)，除非您达到数据结构的大小并且必须对其进行缩放（即 O(n)）。前置更糟糕。如果您执行类似`delete array[index]`（不要！）之类的操作，删除可能会更糟，因为这可能会迫使引擎更改其表示。

*建议*

将数组用于数值数据结构。这就是他们的目的。这就是引擎将优化它们的原因。避免使用稀疏数组（或者如果必须，请期待更差的性能）。避免使用混合数据类型的数组（因为这会使内部表示[更复杂](https://v8.dev/blog/elements-kinds)）。

如果您真的想针对某个引擎（和版本）进行优化，请查看其[源代码](https://github.com/v8/v8/blob/master/src/objects/js-array.h)以获得绝对答案。

# jquery - jQuery选择器用于元素内未被元素包裹的文本？

> ID：11514319
> 
> 赞同：1
> 
> 时间：2012-07-17T00:00:59.833
> 
> 标签：jquery

鉴于此html：

```
<div id='tst1'>
  <div id='tst2'>tst2</div>
  <div id='tst3'>tst3</div>
  this is the text i want
</div> 
```

如何选择“这是我想要的文本”文本？ `$('#tst1').text()`给我包含在 tst1 中的所有文本元素（例如 tst2、tst3 等）。

我不能依赖于知道包含的包装元素的 id（上面的 tst2、tst3），但我可以依赖于我希望在组中最后列出的文本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T00:03:25.200

试试这个请：

**工作演示** [http://jsfiddle.net/We7mZ/](http://jsfiddle.net/We7mZ/)你也可以寻找`innerHTMl`和`outterHTML`

```
jQuery.fn.justtext = function() {

    return $(this).clone()
            .children()
            .remove()
            .end()
            .text();

};
alert($('#tst1').justtext());​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:04:43.750

或者如果 Tats 的建议不起作用，则可能是这样：

```
var text = $('#tst1').text();
text.substr(-23); 
```

# ssh - ssh localhost 连接被 127.0.0.1 关闭？

> ID：11514326
> 
> 赞同：7
> 
> 时间：2012-07-17T00:01:38.680
> 
> 标签：ssh, connection, cygwin, localhost

所以，我正在阅读本教程（[使用 cygwin 在 Windows 上运行 Hadoop...](http://alans.se/blog/2010/hadoop-hbase-cygwin-windows-7-x64/#cygwin)）在我的 WINDOWS 上设置 hadoop（请不要问我为什么要使用 Linux）。所以我到了这一点，我需要通过 SSH 连接到我的本地主机并使用 Cygwin 测试 SSH，但它会关闭连接并显示：

连接由 127.0.0.1 关闭

我用谷歌搜索了很多，但找不到任何适合我的问题的答案。

PS：我在 Windows 7 Professional x64 上运行 cygwin

任何的想法？

顺便说一句，这是一个示例运行：

```
 $ ssh -v localhost
OpenSSH_6.0p1, OpenSSL 1.0.1c 10 May 2012
debug1: Reading configuration data /etc/ssh_config
debug1: Connecting to localhost [127.0.0.1] port 22.
debug1: Connection established.
debug1: identity file /home/Soroush/.ssh/id_rsa type 1
debug1: identity file /home/Soroush/.ssh/id_rsa-cert type -1
debug1: identity file /home/Soroush/.ssh/id_dsa type -1
debug1: identity file /home/Soroush/.ssh/id_dsa-cert type -1
debug1: identity file /home/Soroush/.ssh/id_ecdsa type -1
debug1: identity file /home/Soroush/.ssh/id_ecdsa-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_6.0
debug1: match: OpenSSH_6.0 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_6.0
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: sending SSH2_MSG_KEX_ECDH_INIT
debug1: expecting SSH2_MSG_KEX_ECDH_REPLY
debug1: Server host key: ECDSA 19:2d:f6:84:4d:e5:0d:d4:5e:e6:e5:a4:6a:3c:ea:8b
debug1: Host 'localhost' is known and matches the ECDSA host key.
debug1: Found key in /home/Soroush/.ssh/known_hosts:1
debug1: ssh_ecdsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,password,keyboard-interactive
debug1: Next authentication method: publickey
debug1: Offering RSA public key: /home/Soroush/.ssh/id_rsa
Connection closed by 127.0.0.1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T06:30:32.383

当您安装`Cygwin`并运行`ssh-host-config`时，您可能已经创建了 user `cyg_server`。所以当你连接到时`ssh`，你需要使用用户`cyg_server@localhost`。

当您使用该用户运行 ssh 时，它会询问您在运行时提供的密码`ssh-host-config`。

```
$ ssh cyg_server@localhost
cyg_server@localhost's password:
Last login: Mon Dec 31 01:14:44 2012 from ::1
cyg_server@polorumpus ~
$ 
```

我希望它会有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:41:45.903

看起来密钥没有被接受。检查`/home/Soroush/.ssh/id_rsa.pub`是否已添加到`/home/Soroush/.ssh/authorized_keys`

我还会检查 `RSAAuthentication yes`设置在`/etc/ssh/sshd_config`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-03T21:10:25.567

我必须这样做才能解决问题：

```
chown <USERNAME> /var/log/sshd.log
chown -R <USERNAME> /var/empty
chown <USERNAME> /etc/ssh*
chmod 755 /var/empty
chmod 644 /var/log/sshd.log 
```

请注意，这是我想要的用户名，而不是 cyg_server。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-09T11:08:09.163

我发现这篇文章与我的问题有关，但事实证明我的 cyg_server 帐户没有管理员权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-29T06:30:44.603

我遇到了同样的问题，它是由 Putty 身份验证代理（Pageant）生成的：它使用私钥运行。出于某种原因，它试图使用它来连接到 localhost。如果我关闭了 Pageant（或删除了密钥），我可以 ssh 到 localhost。但是因为我想让 Pageant 运行（成为其他 ssh 服务器的客户端），我设法修改了本地 sshd 服务，以便它以某种方式“忽略” Pageant，以接受连接：修改 /etc/ssh/sshd_config ：

公钥认证没有

现在，它有效

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-01T22:12:38.950

我必须使用 64 位版本的 Cygwin 才能让它工作。

# python - 如何使用 beautifulsoup 提取嵌套标签结构中的属性值？

> ID：11514327
> 
> 赞同：2
> 
> 时间：2012-07-17T00:01:48.780
> 
> 标签：python, html, parsing, beautifulsoup

我有一个看起来与此类似的 html 文件：

```
<html>
...
<li class="not a user"> </li>
<li class="user">
 <a href="abs" ...> </a>
</li>
<li class="user">
 <a href="bss" ...> </a>
</li>
...
</html> 
```

鉴于上述输入，我想用 class="user" 解析 li 标签并获取 href 的值作为输出。这可能在python中使用beautifulsoup吗？

我的解决方案是：

```
data="the above html code snippet"
soup=BeautifulSoup(data)
listset=soup("li","user")
for list in listset:
   attrib_value=[a['href'] for a in list.findAll('a',{'href':True})] 
```

显然我在某处有一个错误，它只列出了最后一个锚标记的 href 的属性值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:32:54.990

你的代码很好。-中有三个元素，`listset`并且`attrib_value`在循环的每次迭代中都会被覆盖，因此在程序结束时，它只包含来自最后一个元素的 href 值`listset`，即`bss`.

尝试这样做以保留所有值：

```
attrib_value += [a['href'] for a in list.findAll('a',{'href':True})] 
```

并在循环（）之前将 attrib_value 初始化为空列表`attrib_value = []`。

# netbeans - Netbeans 7.1，ruby-1.9.3-p194，Rails 3.2.3，Mac Lion 调试器

> ID：11514328
> 
> 赞同：2
> 
> 时间：2012-07-17T00:01:50.070
> 
> 标签：netbeans, ruby-on-rails-3.1, osx-lion, ruby-1.9.3, netbeans-7.1

我可以在 Netbeans 7.1、ruby-1.9.3-p194、Rails 3.2.3 之外成功运行 ruby​​-debug。

但是使用 netbeans，我不断收到此消息。

严重 [org.rubyforge.debugcommons.Util]：错误输出：/Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36：来自`require': dlopen(/Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle, 9): Symbol not found: _ruby_current_thread (LoadError) Referenced from: /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle Expected in: flat namespace in /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle - /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle from /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in`/Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-base19-0.11.25/lib/ruby-debug- base.rb:1:in`<top (required)>' from /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in`来自 /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in`require' from /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-ide19-0.4.12/lib/ruby-debug-ide.rb:5:in`来自 /用户/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-ide19-0.4.12/bin/rdebug-ide:9:in `require_relative' from /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/ruby-debug-ide19-0.4.12/bin/rdebug-ide:9:in`'来自/Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/bin/rdebug-ide:23:in `load' from /Users/USERHOME/.rvm/rubies/ruby-1.9.3-p194/bin/rdebug-ide:23:in`' INFO [org.netbeans.api.extexecution.ExecutionService]

# java - ant javac 打印 javac 文件名

> ID：11514329
> 
> 赞同：0
> 
> 时间：2012-07-17T00:01:54.060
> 
> 标签：java, ant

我有一个 ant build.xml 文件，里面有一个编译目标。我经常发现当一个java文件被修改时，运行编译目标只会重新编译那个java文件。在控制台上，我看到

```
[javac] Compiling 1 source file to myproj\.classes 
```

但是如何让 ant 显示它正在重新编译的源文件呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:28:36.357

您是否尝试将`verbose`标志设置为`true`？

```
<javac ... verbose="true" /> 
```

# python - multiprocessing.Process - 变量作为函数

> ID：11514330
> 
> 赞同：0
> 
> 时间：2012-07-17T00:02:04.917
> 
> 标签：python, numpy, multiprocessing

我正在使用下面的代码来并行处理 numpy 数组。在这种情况下，目标函数对输入数据执行简单的线性拉伸。数组被分段，然后以块的形式馈送到池中。由于 python 帖子的大量并行处理，这工作得很好。

```
 pool = [multiprocessing.Process(target=linear_stretch, args= (shared_arr,slice(i, i+step), 35, 200, 2.0)) for i in range (0, y, step)] 
```

我的问题是，是否可以执行以下操作：

```
stretch = Linear.linear_stretch() 
```

我在哪里创建函数对象（请更正我的词汇！），然后在 multiprocessing.Process 中调用它。

该函数当前所在的模块如下所示：

```
Linear.py

import numpy

def linear_stretch(args):
    #Do some stuff 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:08:24.297

是的，像这样：

```
stretch = Linear.linear_stretch 
```

在 Python 中，函数已经是一等对象，并且能够像任何其他对象一样被操作，或者通过引用传递给另一个变量。请注意，函数或方法后面的括号表示解释器调用函数并传递返回值，这就是为什么：

```
stretch = Linear.linear_stretch() 
```

不会按预期工作。

# javascript - 网站性能测试：如何最好地估计计算机性能？

> ID：11514332
> 
> 赞同：7
> 
> 时间：2012-07-17T00:02:07.373
> 
> 标签：javascript, performance, html, testing, performance-testing

我的网页中有一些浏览器密集型 CSS 和动画，我想确定用户是否拥有快速的 PC，以便我可以相应地缩放以提供最佳体验。

我正在使用[http://detectmobilebrowser.com](http://detectmobilebrowser.com)的脚本来检测所有移动设备，并且我将包含该子句`/android|ipad|ipod|playbook|silk/i.test(a)`以包括所有平板电脑设备。

然而，这并不能也不能真正解决实际的硬件问题。画出我正在寻找的东西并没有走得太远。

例如，iPhone 4S 将比移动用户代理检测器匹配的许多设备功能强大得多，这使它无法脱颖而出。有人可能会在 Pentium II 机器上运行 Google Chrome（不知何故）并想查看我的页面。（此人可能没有 iPhone 4S）

显然，要真正了解这一点，我必须进行一些实际的性能测试，并且与任何类型的应用程序的性能测试一样，只测试应用程序实际执行的任务类型的性能是有意义的。

即使考虑到这一点，我觉得在性能测试例程花费太长时间并且用户会变得不耐烦之前，很难获得任何合理准确的数字。所以这可能意味着继续它，除非我希望第一印象是完美的。嗯，这实际上恰好是这种情况。因此，我无法在“第一次运行后”测量性能并稍后调整参数。

所以我剩下的就是基本上尝试在初始页面加载时执行类似的任务，以一种依赖于浏览器渲染和处理速度的方式，同时不向用户呈现任何内容（这样用户仍然认为页面正在加载），然后最好在一两秒内获得足够准确的数字，以便为实际页面设置参数，以便以不类似于幻灯片的令人愉悦的方式进行动画和呈现。

也许我可以`<div>`在我的测试用例上放置一个整页的白色，这样我就可以防止用户看到正在发生的事情，并希望浏览器不会因为避免做所有的工作而变得聪明。

有没有人这样做过？

我知道人们会说，“你可能不需要这样做”，或者“必须有更好的方法”或“减少影响的数量”。

我在页面上做的任何事情的原因都是为了看起来不错。这就是它的全部意义所在。如果我不那么关心这个问题就不会存在。目标是让 javascript 能够确定足够的参数，以在功能强大的计算机上提供出色的体验，并在功能较弱的计算机上提供可及的体验。当有更多的电力可用时，应该加以利用。所以希望这可以解释为什么这些建议不是问题的有效答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T03:52:29.280

我认为这是一个很好的问题，因为它将用户体验放在首位。

想到了几个想法：

*   Microsoft 已经发布了许多测试来展示 IE 9 和 10 的性能。其中许多测试侧重于图形性能，例如[这个](http://ie.microsoft.com/testdrive/Performance/Bubbles/)，它似乎使用[这个 JavaScript 文件](http://ie.microsoft.com/testdrive/Performance/Bubbles/Scripts/Demo.js)来测量性能。可能有一些您可以使用的代码/概念。

*   无论如何，媒体密集型页面可能需要几秒钟才能加载，因此如果您在加载其余内容的同时开始测试，您就有一点喘息的空间。例如，启动 AJAX/图像请求，运行测试，然后处理响应。

*   要测试图形性能，使用加载图形*作为*性能测试怎么样？我通常不喜欢“加载”屏幕，但如果网站可能需要几秒钟来加载，最终结果是更好的用户体验，那么这不是一个坏主意。

*   如果您在其上绘制一堆白色形状，则白屏想法可能会起作用（不确定是否有任何引擎足够聪明以优化它，因为它是相同的颜色）。

最终，我宁愿选择更好的性能和更低的保真度，以及不太准确（但快速）的测试，而不是让用户等待太久。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T04:51:46.763

我不会测量用户的 CPU 性能一次并确定要使用多少花哨的视觉效果，而是测量 CPU 密集型位*每次执行*（使用`new Date()`）所花费的时间量，并将其与预期的最小值和最大值进行比较（您必须确定），并酌情上下动态调整“效果级别”。

假设用户在后台启动了一个占用大量 CPU 时间的程序。如果你使用这个想法，你的页面会*自动*降低视觉效果以节省 CPU 周期。当后台程序结束时，花哨的效果会回来。我不知道您的用户是否会喜欢这种效果（但我相信他们会喜欢他们的浏览器在 CPU 过载时保持响应的事实）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T03:34:07.987

这是一个糟糕的解决方案，但它在当时很有效：我曾经生成两个大约 100x100 的随机矩阵，将它们（小学生的方式）相乘 100 次并计时。在普通机器上用了不到 1 秒，在我能找到的最慢的机器上用了 2 秒多一点（EeePC 1000H）。之后我可以说“嗯，这个 CPU 每秒可以执行 X 次浮点运算”，这是非常不准确的，可能是错误的，但结果非常稳定并且标准偏差非常低，所以我想你可以称之为糟糕的衡量标准javascript数学性能，它可以告诉你关于那台计算机的CPU的一些信息。

您还可以检查它是否启用了 WebGL，它会忽略所有比 Vista 更早的 Windows 操作系统。由于那些没有运行 Vista 或更高版本的硬件，因此它们的 PC 速度较慢。你可以用这个检查它：

```
function hasWebGL () {
  if (typeof window.WebGLRenderingContext !== 'undefined') {
    var canvas = document.createElement('canvas');
    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl') || canvas.getContext('webkit-3d') || canvas.getContext('moz-webgl');
    if(gl) {
      return(true);
    } else {
      return(false);
    }
  }
} 
```

# php - MySQL 查询有效，但 PHP 返回异常：errorinfo:null

> ID：11514341
> 
> 赞同：0
> 
> 时间：2012-07-17T00:03:22.657
> 
> 标签：php, mysql, exception, pdo, sql-update

以下代码正确更新表，但它也返回异常。知道这里可能会发生什么吗？

```
public function updateThis($aaa){
try
{
    $success = false;

    $query = "
        UPDATE this_table
        SET thing = '0'
        WHERE aaa = :aaa";

    $stmt = $this->conn->prepare($query);

    $stmt->bindParam(':aaa', $aaa);

    $stmt->execute();

    if($this->conn->commit())
        $success = true;

    return $success;
}
catch(Exception $e)
{
    return $e;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:14:10.213

当您使用 PDO 时，默认情况下自动提交是打开的，除非您使用[Begin Transaction](http://www.php.net/manual/en/pdo.begintransaction.php)专门将其关闭。我在您的连接中看不到它，所以您是否正在尝试提交已经自动提交的事务？

# c# - ASP .NET AJAX 中断异步文件传输？

> ID：11514344
> 
> 赞同：0
> 
> 时间：2012-07-17T00:03:29.927
> 
> 标签：c#, html, asp.net-mvc, file-upload

我最近开始为客户开发一个多文件上传 HTTP 页面。

他想要一切都在 HTTP、Javascript 和 HTML 中，需要能够传输大文件（每个文件最多 800 兆字节），并且他还想要一个用于上传的进度条。Flash 或 Silverlight 不是一个被接受的选项，最后，第三方组件也不被接受，因为在没有太多麻烦的情况下需要深入的可定制性。

现在，我明白了整个概念。您有一个主页，其中有一个`iframe`（ewww，我说的是 i-word - 我知道）。这`iframe`指向`form`其中有文件上传。这样，一旦`form`提交，访问者所在的原始页面不会重新加载，让原始页面运行一些AJAX，不断询问传输进度。

# 第一次尝试

我首先通过将文件直接声明为操作方法的参数来开始在 MVC 中获取文件，如下所示。

```
public ActionResult UploadFile(HttpPostedFile upload) {
    ...
} 
```

但是，尽管 MVC 给我的帮助很大，但变量上的`InputStream`属性或`SaveAs(...)`方法都没有帮助我。`upload`

# BeginExecute 和 GetBufferedInputStream

很快我找到了 .NET 4.0 中引入的一种方法，称为`HttpRequest.GetBufferedInputStream()`. 这种方法特别允许我接收文件流并以增量和异步的方式读取它。

当触发特定 URL 时，我重写了`BeginExecute`控制器的方法，并将读取功能放在那里，就像这样。

```
protected override IAsyncResult BeginExecute(System.Web.Routing.RequestContext requestContext, AsyncCallback callback, object state)
{
    if (requestContext.HttpContext.Request.Url.AbsolutePath.StartsWith("/Home/UploadFile"))
    {
        //we're doing a file upload
        var streamSource = requestContext.HttpContext.Request.GetBufferedInputStream();

        //read from stream, write to file
    }
} 
```

这一切都很好......当AJAX不进入并中断时。你看，如果我的 AJAX 脚本正在运行（在`iframe`上传开始后 10 秒执行），那么（当它发出`GET`请求时）该请求会中断正在读取文件的流，即使它是在不同的操作上，甚至当它在不同的控制器上时。

我收到的错误如下：

> 客户端已断开连接，因为基础请求已完成。不再有 HttpContext 可用。

我能做些什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:45:49.023

看看[ASP .NET Ajax 文件上传](http://vanacosmin.ro/Articles/Read/AjaxFileUpload)。这应该阐明 GetBufferlessInputStream 和 GetBufferedInputStream 的工作原理以及如何将它们用于“ajax”文件上传，但会迫使您更改大量代码。

如果您使用的是 .NET 4.5，使用 GetBufferedInputStream 的项目的更新版本将很快推出，并且易于使用。您可以检查相同的链接以获取更新。

# android - 如何在 Windows 上为 android 构建 mozilla tamarin (AVM3)？

> ID：11514345
> 
> 赞同：0
> 
> 时间：2012-07-17T00:03:34.310
> 
> 标签：android, windows, actionscript-3, mozilla

我正在尝试将 avm3 嵌入到 android 游戏引擎中，而“Tamarin 构建文档”对于在 windows 中使用 cygwin 构建它有点模糊。

如果有人确实成功地尝试过，请详细列出我所需的步骤。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:39:36.237

看看redtamarin它可能很有用

[http://code.google.com/p/redtamarin/wiki/GettingStarted](http://code.google.com/p/redtamarin/wiki/GettingStarted)

# java - 使用 Java 小程序将图像保存到服务器

> ID：11514346
> 
> 赞同：2
> 
> 时间：2012-07-17T00:03:48.227
> 
> 标签：java, php, image, post, applet

我正在尝试将 png 图像保存到我的小程序（未签名）正在运行的服务器上。我看过这里并看到了几个例子。做这个的最好方式是什么？我在我的服务器上使用 PHP 仅供参考。

如果您可以解释使用的类和逐步的方法，那就太好了。我正在尝试学习编程（不仅仅是复制代码）。

我正在考虑制作一个`FileOutputStream`，但由于它是一个小程序，因此我在实际创建文件时遇到了问题。

我不确定是否可以在服务器上安装 servlet，因为它的第 3 方...

我还查看了一些 post 方法，这似乎是要走的路，但我不确定它们是如何工作的……我在 HTML 和 PHP 中使用 post 方法处理文本，但从未在 java 中使用过。我注意到大多数拍摄图像，将其转换为字节数组，然后发布该数组，我可以部分理解，但是如何在 PHP 中重新转换？

或者如果有人有更好的想法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:51:06.337

使用 http 将图像上传到服务器可以通过多种方式完成，实际上:)

嗯...如果您有未签名的小程序并且您不签名，那么您的小程序必须...

*   A) 仅将图像上传到其本机主机

由于未签名的小程序无法获取任何 LFS 映像，因此您的小程序可以...

*   B) 只上传自己的图片

对于将数据发布到服务器，您可以...

*   C) 使用[UrlConnection](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLConnection.html)

* * *

无论如何，（*在开始编写小程序之前*）我建议首先阅读[这个](http://docs.oracle.com/javase/tutorial/deployment/applet/security.html)

祝你好运

# asp.net - ASP.NET 图表控件是否支持浏览器中的 canvas/html5？

> ID：11514347
> 
> 赞同：2
> 
> 时间：2012-07-17T00:03:50.837
> 
> 标签：asp.net, html5-canvas, mschart

我见过一些 JavaScript 图表库，它们使用 canvas 和 html5 具有很酷的交互性，最重要的是，它们不会从服务器下载生成的图像来显示图表，而是在浏览器中生成图表。遗憾的是，这些库还很年轻，没有 Microsoft 的 ASP.NET 图表控件那样的大量图表和选项。这种 canvas/html5 技术是 Microsoft 的 ASP.NET 图表控件中的一个选项吗？如果没有，它很快就会到来吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:18:52.620

不会。ASP.NET 的图表库会生成光栅位图（通常为 PNG 图像）。它们是在 2005-2006 年左右编写和发布的，因此不支持更新的 Web 技术，例如`<canvas>`HTML5 功能。

如果您是 GDI 专家，可能有一种解决方法：将库使用的 GDI 图像对象从位图更改为 GDI Windows 元文件，然后将元文件转换为 SVG 并将其呈现给客户端。

...或者只是使用[Google Charts](https://developers.google.com/chart/)。

不要抱太大希望 - 图表库是 ASP.NET Web 窗体库（是 的子类`Control`）的成员，而 MVC 目前正在流行。`internal`但是，对于我的一些项目，我通过剥离所有对 ASP.NET 的引用并让它生成图表图像而不考虑上下文（出于某种原因，这些类被标记为），将 Charting 库反向工程为一个独立于平台的库。这种方式更加灵活，我怀疑微软这样做是为了安抚他们授权图表库的 Dundas。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:17:16.593

不，很遗憾，这不是一种选择。Chart 控件仅呈现为开箱即用的图像。据我所知，尚未宣布将其扩展到任何其他高级渲染格式。

如果你真的需要定制和交互的东西，我建议你看看 gRaphael、Highcharts、Flotr2 或 Dojo Charting。在我看来，尽管还很年轻，但在许多情况下，它们实际上比 ASP.NET 图表控件更灵活。

# shell - 用户运行脚本时如何忽略用户的shell

> ID：11514352
> 
> 赞同：1
> 
> 时间：2012-07-17T00:05:00.267
> 
> 标签：shell, gnu-parallel

我必须按用户运行脚本。该用户的外壳已更改为`/script/script1`文件中`/etc/passwd`。当我运行脚本时，它会将 SHELL 作为 /script/script1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:36:13.747

啊，现在我看到脚本和 passwd 条目，我想我明白发生了什么。sem 正在尝试使用您的 shell 执行您的命令行。如果您在 sem 之前 printenv，您是否看到 SHELL=home/bkup:/script/script1？

如果是这样，那么只需在运行 sem 之前在行上导出 SHELL=/bin/bash （或 /bin/sh 等）

如果这不起作用，请向我们展示 printenv 的输出。

# ruby - 在 Ruby 模块中继承常量

> ID：11514353
> 
> 赞同：5
> 
> 时间：2012-07-17T00:05:09.913
> 
> 标签：ruby, inheritance, module

在 Ruby 中，我正在尝试创建一个类，该类基于初始化期间给出的值将从以下模块之一继承。我想创建一个基础模块，这两个模块都从中继承，其中包含使用在继承它的模块中定义的常量的通用方法。例子：

```
module BaseMod
  def what_am_i
    puts OUTPUT
  end
end

module Tall
  OUTPUT = "I am tall"
  include BaseMod
end

module Short
  OUTPUT = "I am short"
  include BaseMod
end

class Person
  def initialize type
    if type =~ /short/i
      extend Short
    else
      extend Tall
    end
  end
end

p = Person.new "short"
p.what_am_i 
```

我的问题是，当调用“p.what_am_i”时，出现以下错误：

```
NameError: uninitialized constant BaseMod::OUTPUT
  const_missing at org/jruby/RubyModule.java:2642
      what_am_i at test_logic2.rb:3
         (root) at test_logic2.rb:28 
```

我也想知道是否有更好的方法来做这件事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T22:30:53.130

```
module BaseMod
  def what_am_i
    puts self.class::OUTPUT
  end
end

module Tall
  OUTPUT = "I am tall"
  include BaseMod
end

module Short
  OUTPUT = "I am short"
  include BaseMod
end

class Person
  def initialize(type)
    if type =~ /short/i
      self.class.send(:include, Short)
    else
      self.class.send(:include, Tall)
    end
  end
end

p = Person.new "short"
p.what_am_i 
```

**编辑：**上面的代码实际上不起作用：

```
p = Person.new "short"
p.what_am_i
>> I am short
p = Person.new "tall"
p.what_am_i
>> I am tall
p = Person.new "short"
p.what_am_i
>> I am tall 
```

这是另一个尝试：

```
module BaseMod
  def self.included(base)
    base.send(:define_method, :what_am_i) do
      puts base::OUTPUT
    end
  end
end

module Tall
  OUTPUT = "I am tall"
  include BaseMod
end

module Short
  OUTPUT = "I am short"
  include BaseMod
end

class Person
  def initialize type
    if type =~ /short/i
      extend Short
    else
      extend Tall
    end
  end
end

p = Person.new "short"
p.what_am_i
p = Person.new "tall"
p.what_am_i
p = Person.new "short"
p.what_am_i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T01:00:08.670

要在您的情况下获得常量，您必须编写如下内容：

```
module Tall
 ::OUTPUT = "I am tall"
 include BaseMod
end 
```

但是请注意，您正在使用 Short 模块的声明重新定义常量。为此，您将永远得到“我很矮”。

所以要正确地做到这一点，你应该尝试：

```
module BaseMod
 OUTPUT="Before"
 def what_am_i
  puts OUTPUT
 end
end

module Tall
 def self.extended(k)
  OUTPUT.replace  "I am tall"
 end
 include BaseMod
end

module Short
 def self.extended(k)
  OUTPUT.replace "I am short"
 end
 include BaseMod
end 
```

ķ

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T15:39:35.277

我将再提出一个选项。我不太确定您的复杂的真实案例是什么，所以这是我的选择：

```
module BaseMod
  def what_am_i
    puts output
  end
end

module Tall
  include BaseMod
  def self.extended klass
    define_method :output do
      "I am tall"
    end
  end
end

module Short
  include BaseMod
  def self.extended klass
    define_method :output do
      "I am short"
    end
  end
end

class Person
  def initialize type
    extend (type =~ /short/i ? Short : Tall ) # Because I didn't wanna type all those lines
  end
end

p = Person.new "short"
p.what_am_i 
```

请注意，对于这种情况，您可以轻松地执行以下操作：

```
module Tall
  include BaseMod
  def output
    "I am tall"
  end
end 
```

但我不知道这是否真的对你有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T03:19:57.813

似乎当您使用#what_am_i 消息向您的人p 发送消息时，解释器在类祖先中不断地寻找方法实现，最终在BaseMod 中找到它，但在该级别，OUTPUT 常量不再定义。*所以我认为 Ruby 继续在层次结构中向上*寻找 OUTPUT 常量，但不会考虑在定义它的 Tall 和 Short 模块中向下看。士气是，即使您包含许多子模块，它们也不会进入一个堆，每个人都可以访问所有常量，而是将它们的层次结构保持在它们包含的相反顺序（参见 Tall.Ancestors）。在任何级别，只能访问相同级别或更高级别的常量。我将通过以下方式解决您的问题：

```
module Personhood
  def what_am_i; @output end
end

class Tall
  include Personhood
    def initialize
      @output = "I am tall"
    end
  end
end

class Short
  include Personhood
    def initialize
      @output = "I am short"
    end
  end
end

def Person( type )
  if type =~ /short/i
    Short.new
  else
    Tall.new
  end
end

pete = Person "short"
pete.what_am_i
=> I am short 
```

我处理了一个常量以支持实例变量。在 Ruby 中，无论如何都没有真正的常量。Tall 和 Short 是类，Person 是一个构造方法，它根据输入返回 Tall 或 Short 类。这就是我觉得应该这样做的方式。

# iphone - 在应用内查看 YouTube 视频并返回到以前的 ViewControlloer

> ID：11514354
> 
> 赞同：0
> 
> 时间：2012-07-17T00:05:25.190
> 
> 标签：iphone, objective-c, ios, youtube, ios6

我正在尝试在我的应用中集成一个 youtube 视频。但我希望它在视频完成后恢复到调用 viewController。我几乎成功地实现了这一点，但以我的方式，用户必须按下完成按钮，然后再按下一个按钮才能返回原始 ViewController。

这是我使用的代码，请帮助，我更喜​​欢参考完整代码或代码示例。

YouTubeView.h：

```
#import <UIKit/UIKit.h>

@interface YouTubeView : UIWebView
{
}

- (YouTubeView *)initWithStringAsURL:(NSString *)urlString frame:(CGRect)frame mimeSubType:(NSString *)mimeType;
@end 
```

YouTubeView.m：

```
#import "YouTubeView.h"

@interface YouTubeView ()

@end

@implementation YouTubeView

- (YouTubeView *)initWithStringAsURL:(NSString *)urlString frame:(CGRect)frame mimeSubType:(NSString *)mimeType
{
NSString *strMimeType;

if([mimeType length]>0)
{
    strMimeType = mimeType;
}

else
{
    strMimeType =@"x-shockwave-flash"; //@"x-shockwave-mp4";
}

if (self = [super init])
{
    // Create webview with requested frame size
    self = [[UIWebView alloc] initWithFrame:frame];

    // HTML to embed YouTube video

    NSString *videoHTML = [NSString stringWithFormat:@"\
                 <html>\
                 <head>\
                 <style type=\"text/css\">\
                 iframe {position:absolute; top:50%%; margin-top:-130px;}\
                 body {background-color:#000; margin:0;}\
                 </style>\
                 </head>\
                 <body>\
                 <iframe width=\"100%%\" height=\"240px\" src=\"%@\" frameborder=\"0\" allowfullscreen></iframe>\
                 </body>\
                 </html>", urlString];

    [self loadHTMLString:videoHTML baseURL:nil];

}

return self;

}

- (void)dealloc
{
[super dealloc];
}

@end 
```

还有一个指向 *on 主 ViewController 的按钮：-(IBAction)runTestVideo:(id)sender {

```
NSString *strNormalVdoURL = [NSString stringWithFormat:@"http://www.youtube.com/embed/TgLqH9n57B0"];

YouTubeView *videoVw = [[YouTubeView alloc] initWithStringAsURL:[NSString stringWithFormat:@"%@",strNormalVdoURL] frame:CGRectMake(0,0,315,420) mimeSubType:@"x-shockwave-flash"];

                        [self.view addSubview:videoVw];
                        [videoVw release];
                        videoVw = nil;

} 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T02:45:50.913

我不太确定我的方法是否适用于你的方法，因为我在播放视频时隐藏了视图。用户按下完成按钮后，电影控制器将退出并显示视图。

```
- (void)viewDidLoad { 
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector (MPMoviePlayerDidExitFullScreen;) name:MPMoviePlayerDidExitFullscreenNotification object:nil];
}

- (void)MPMoviePlayerDidExitFullScreen:(NSNotification *)notification {
[[NSNotificationCenter defaultCenter] removeObserver:self name: MPMoviePlayerDidExitFullscreenNotification object:nil];

[movieController stop];
[movieController.view removeFromSuperview];

view.hidden = NO;
} 
```

# asp.net-mvc - 使用 InRequestScope 进行 Ninject 处理订单

> ID：11514355
> 
> 赞同：1
> 
> 时间：2012-07-17T00:05:44.680
> 
> 标签：asp.net-mvc, dependency-injection, ninject

刚开始玩 ninject - 我无法解决这个问题。考虑这个设置：

```
private static void RegisterServices(IKernel kernel)
{
   kernel.Bind<IDataTransaction>().To<DataTransaction>().InRequestScope();

   kernel.Bind<IdbAnalytics>().To<dbAnalytics>().InRequestScope();
   kernel.Bind<IdbMembership>().To<dbMembership>().InRequestScope();

   kernel.Bind<IAnalyticsWork>().To<AnalyticsWork>().InRequestScope();
   kernel.Bind<IMembershipWork>().To<MembershipWork>().InRequestScope();

   kernel.Bind<ILog>().To<Log>().InRequestScope();
   ...
} 
```

将 Log 注入到上述类中：

```
public class AnalyticsWork : IAnalyticsWork, IDisposable
{
    private readonly IdbAnalytics _Context;
    private readonly ILog _Log;

    public AnalyticsWork(IdbAnalytics Context, ILog Log)
    {            
        _Context = Context;
        _Log = Log;
        _Log.Write(LogEntryType.DEBUG, "Object Created");
    }
    ...
} 
```

这个问题是 Log 对象在其他对象（AnalyticsWork / MembershipWork）之前被处理掉了。有什么方法可以设置物品的处理顺序吗？还是这个设置有缺陷？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:16:38.857

我不使用 NInject，但在我看来，您正在将日志具体注册为共享或每个 Web 请求（根据`InRequestScope`可能表明的情况，我再次为不使用 NInject 表示歉意，所以我不确定它的作用）。

对于我使用过的所有记录器，NLog、Log4Net、MS 的日志记录应用程序块等 - 它们都需要`Transient`注册，而不是`Scoped`，因为它们将启动它们的超类作为调用类写入日志。

至于处置顺序，我认为您无法使用任何 IoC 容器来控制它，因为如果另一个类仍然具有依赖关系，则无法以不同的顺序处置该对象。几年前我第一次开始使用 IoC 容器时遇到了同样的问题，我想，“是的，我会将所有内容都注册为范围！” 嘿嘿，效果不是很好。

我会说你的对象只需要以不同的方式注册。只限定您真正需要限定范围的项目，其他所有内容为`transients`或`singletons`。我通常遵循以下模式：

> 编码一切`singleton`和编码`thread-safe`。
> 如果不是线程安全的，请将其设置`transient`为 a 并注册它。

如果我没有`unit-of-work`在我`ORM`的`Scoped`.

# visual-c++ - 无法在firebreath插件中绘制到窗口

> ID：11514357
> 
> 赞同：1
> 
> 时间：2012-07-17T00:05:52.287
> 
> 标签：visual-c++, firebreath, direct2d

好的，目前我在尝试使用 direct2d 的 firebreath 插件写入窗口时遇到了一些大麻烦。

我添加了 FB::AttachedEvent 事件，并在处理程序中生成了一个线程，我在其中传递了 PluginWindow（转换为 FB::PluginWindowWin* ），在该线程中我初始化了 direct2d 图形，并有我的渲染循环。

我的第一个主要问题是传递给处理程序的插件窗口似乎不正确。当我得到 HWND 并在其上运行 GetCLientRect 时，我得到的尺寸是窗口尺寸的 60 倍。在 HTML 中，我将宽度和高度设置为 640 x 480，但矩形返回的尺寸为 38400 x 28800？

我是否在某些时候错误地配置了firebreath？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T04:08:00.517

FireBreath 不是问题。FireBreath 不会对窗口做任何事情，除非在浏览器提供它时将它提供给您。我的猜测是你的 Firefox 表现得很有趣。我认为这可能是与缩放相关的问题（当您放大页面时，它也会缩放页面上的所有内容）。

祝你好运

# javascript - 图像高度只会从大量图像中检索一次

> ID：11514358
> 
> 赞同：0
> 
> 时间：2012-07-17T00:05:53.313
> 
> 标签：javascript, jquery

所以就像我在标题中写的那样，我有多个具有相同类的元素，我获取该类并尝试检查该图像的子图像的宽度/高度/src。

我只设法获得了第一张图像的高度//宽度，但是我获得了所有图像的 src。

这是html：

```
<a class="test">
<img src="http://www.kitchenspro.com/files/Testimonials/Large/1502046700250312a71707.jpg">
</a>
<a class="test">
<img src="http://www.kitchenspro.com/files/Testimonials/Large/40183.9461166782.jpg">
</a>
<a class="test">
<img src="http://sphotos-a.xx.fbcdn.net/hphotos-ash4/s480x480/391362_365319466870994_1543740404_n.jpg">
</a> 
```

这是jQuery

```
var imagesrc= "";
var imageheight = "";
var imagewidth = "";
var i=0;
$(".test > img").each(function() {
i++;
imagesrc = $(this).attr("src");
imageheight = $(this).width();
imagewidth = $(this).height();
document.write("<br>This is image's src: " + imagesrc + " This is img height: " + imageheight + " this is width: " + imagewidth + "<br>");            
}); 
```

如果我没有以正确的方式呈现代码，我深表歉意。

任何帮助将不胜感激。

先谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:13:48.393

第一次调用`document.write`破坏了其余元素，这就是为什么你只从其中一个获取信息，使用 .append() 或其他东西来显示你的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:26:44.463

正是@Musa 所说的。

为了帮助清理您的代码并提供有关效率和本机 javascript 的课程，我提供了一个片段。

```
// Document Fragments are lightweight DOM containers. Append elements to this in loops and then attach the fragment to the actual DOM afterwards to increase efficiency. 
var frag = document.createDocumentFragment();

// i, or index, comes out of box in most loops.
$(".test img").each(function(i, el) {
 // Local variables specific to each image
 var imagesrc = $(this).attr("src");
 var imageheight = $(this).width();
 var imagewidth = $(this).height();
 var message = "This is image's src: " + imagesrc + " This is img height: " + imageheight + " this is width: " + imagewidth;

 // Appending the node to the frag with native js
 var p = document.createElement("p");
 p.innerText = message;
 frag.appendChild(p);

 // Viewing the console message for fun
 console.log(message);     
});

document.body.appendChild(frag); 
```

# php - 在构造函数中注入所有变量或使用设置器并在未设置时抛出异常是更好的做法吗？

> ID：11514360
> 
> 赞同：3
> 
> 时间：2012-07-17T00:06:03.600
> 
> 标签：php, oop, class

想象一下你有这门课

```
class Ai1ec_Less_Parser_Controller {
    /**
     * @var Ai1ec_Read_Variables_Startegy
     */
    private $read_variable_strategy;
    /**
     * @var Ai1ec_Save_Variables_Strategy
     */
    private $write_variable_strategy;
    /**
     * @var Ai1ec_Less_Variables_Collection
     */
    private $less_variables_collection;
    /**
     * @var Ai1ec_Less_Parser
     */
    private $ai1ec_less_parser;
    /**
     * We set the private variables in the constructor. I feel that there are too many parameters. 
     * Should i use setter instead and throw an exception if something is not set?
     * 
     * @param Ai1ec_Read_Variables_Startegy $read_variable_strategy
     * @param Ai1ec_Save_Variables_Strategy $write_variable_strategy
     * @param Ai1ec_Less_Variables_Collection $less_variables_collection
     * @param Ai1ec_Less_Parser $ai1ec_less_parser
     */
    public function __construct( Ai1ec_Read_Variables_Startegy $read_variable_strategy,
                                 Ai1ec_Save_Variables_Strategy $write_variable_strategy,
                                 Ai1ec_Less_Variables_Collection $less_variables_collection,
                                 Ai1ec_Less_Parser $ai1ec_less_parser ) {

    }
} 
```

我需要设置这些变量，所以我在构造函数中设置它们（但看起来参数太多）。另一种选择是使用 setter 来设置它们，然后在一个方法中如果没有像这样设置所需的变量之一，则抛出异常

```
public function do_something_with_parser_and_read_strategy() {
  if( $this->are_paser_and_read_strategy_set === false ) {
     throw new Exception( "You must set them!" );
  }
}  
private function are_paser_and_read_strategy_set () {
  return isset( $this->read_variable_strategy ) && isset( $this->ai1ec_less_parser );
} 
```

你认为这两种方法中的一种更好吗？为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:12:35.207

你的类是不可变的吗？如果是这样，那么通过构造函数拥有 100% 的成员人口通常是最好的方法，但我同意如果你有超过 5 或 6 个参数，它可能会开始看起来很难看。

如果您的类是可变的，那么使用带有必需参数的构造函数没有任何好处。通过访问器/修改器方法（也称为属性）公开成员。

工厂模式（如@Ray 所建议的那样）可以提供帮助，但前提是您有各种类似的类 - 对于一次性然后您可以简单地使用静态方法来实例化对象，但您仍然会有“太许多参数”的问题。

最后一种选择是接受一个带有字段的对象（每个参数一个字段），但要小心使用这种技术——如果某些值是可选的，那么只需使用方法重载（不幸的是 PHP 不支持）。

我会坚持你正在做的事情，只有在出现问题时才将其更改为其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T09:00:41.170

类命名 Controller 以某种方式反映了**MVC**，或者一般来说 - 任何负责处理顺序的机制。

无论如何，数据对象类往往有很多字段——这是他们的责任。依赖于许多其他对象的常规对象可能会丢失一点。

正如我所见，有四个对象：读取、保存、解析和提供集合接口。为什么一个人有不同的读写接口？这不能合二为一吗？Parser 本身就是一个库，因此可能没有理由在任何地方组合它，尽管它可以自己使用 reader/writers，并作为回报提供集合。因此，解析器有可能接受 reader 的参数并返回一个集合对象吗？

那更多的是关于具体情况。一般来说 - 对方法有许多参数（或由不同域的其他对象初始化对象内的许多字段）表明存在某种设计缺陷。

主题可能是[这篇关于构造函数初始化](http://martinfowler.com/bliki/ConstructorInitialization.html "Martin Fowler 的构造函数初始化")的文章——它建议使用构造函数内初始化。请务必跟进重点：

> *如果在构造函数中有很多协作者要提供怎么办？*与任何大型参数列表一样，大型构造参数列表是[CodeSmell](http://martinfowler.com/bliki/CodeSmell.html "Martin Fowler 的 CodeSmell")。

正如[Ray](https://stackoverflow.com/a/11514392/632556 "雷评论")所写的那样 - 可以使用 setter 进行初始化，并且[也有相关文章](http://martinfowler.com/bliki/SetterInitialization.html "Martin Fowler 的 Setter 初始化")。就我的观点而言——我认为 Martin Fowler 确实很好地总结了这些案例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T18:29:43.743

没有“更好”的方法。但这里有几件事情你必须考虑：

*   构造函数不被继承
*   如果类需要太多的对象，它负责太多

这可能会影响您选择类实现的接口类型。

一般的经验法则是这样的：

> *如果参数对于类的功能是必需的，则应通过构造函数注入。*

例外情况是，如果您使用工厂初始化实例。工厂从不同的类构建实例是很常见的，其中一些实现相同的接口和/或扩展相同的父类。那么通过setter注入共享对象就更容易了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T00:10:30.043

使用调用 setter 的工厂而不是使用一组参数的构造函数来创建对象要灵活得多。查看构建器和工厂模式。

访问未完全构建的对象时抛出异常是好的！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T00:24:34.273

任何有超过 2 个（有时是 3 个）参数的函数，我总是传递一个数组，所以它看起来像：

```
public function __construct(array $options = array()) {

    // Figure out which ones you truly need
    if ((!isset($options['arg1'])) || (mb_strlen($options['arg1']) < 1)) {
        throw new Exception(sprintf('Invalid $options[arg1]: %s', serialize($options)));
    }

    // Optional would look like
    $this->member2 = (isset($options['arg1'])) && ((int) $options['arg2'] > 0)) ? $options['arg2'] : null;

    // Localize required params (already validated above)
    $this->member1 = $options['arg1'];
} 
```

传递一系列选项允许未来的增长，而无需更改函数签名。但是它确实有它的缺点，因为该函数必须本地化数组的所有元素以确保访问不会引发警告/错误（如果数组中缺少元素）。

在这种情况下，工厂解决方案不是一个好的选择，因为您仍然面临将值传递给工厂的问题，以便它可以使用正确的值初始化对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-18T09:25:44.660

“构造函数参数过多”的标准解决方案是[构建器模式](http://en.wikipedia.org/wiki/Builder_pattern)。您的控制器类本身仍将有一个长构造函数，但客户端可以在构建器上使用 setter，而后者随后将调用长构造函数。

如果你只在一个或两个地方构建你的控制器对象，那么创建一个构建器甚至都不值得。在这种情况下，只需坚持使用您当前的代码。

# css - Mozilla：对 em 值的错误解释

> ID：11514362
> 
> 赞同：0
> 
> 时间：2012-07-17T00:06:24.990
> 
> 标签：css, firefox, em

我正在开发自适应网站，并在 em 值中制作了所有内容。尽管如此，我在解释 em 方面与 Chrome 和 Mozilla 之间存在差异。网站是 dev.morodeer.ru/stroymoidom ，问题出在带有图标的金属条上。在大约 670 像素的宽度上，Chrome 中的所有内容都很棒，但是 Mozilla 削减了右边缘（因为居中包装的宽度设置为 90%）。此外，在相同宽度的浏览器下，Mozilla 中的金属条更小，这让我想到，Mozilla 计算的字体大小更小。

感谢您可能的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:42:09.333

> em 和 ex 单位取决于字体，并且对于文档中的每个元素可能不同。

引自：[w3.org](http://www.w3.org/Style/Examples/007/units.en.html)

也许您使用默认字体，而 Firefox 使用不同的字体，例如 chrome 呢？

我建议您使用 px 或 % 值而不是 em 作为块布局大小值。

使用 em 作为字体大小，1em = 浏览器的字体大小，2em = 2* 浏览器的字体大小，0.5 em = 0.5*浏览器的字体大小……等等；）

如果您已经知道那部分：是的，firefox 和 chrome 可以有不同的字体大小，然后 em 可能会以不同的方式影响您的字体大小。

# java - 将文件保存到arraylist并写回文件；安卓

> ID：11514364
> 
> 赞同：0
> 
> 时间：2012-07-17T00:06:37.550
> 
> 标签：java, android

我一直在尝试打开一个文本文件并将每一行保存为数组列表的内容。完成后，我想将其保存回文件。我已经遇到错误很长时间了，并且尝试了许多技术。我发现由于某种原因，文件本身没有被创建。这可能只是我忽略的一个简单错误，但如果您能提供任何帮助，我将不胜感激。

这是代码：

```
public void addToFile(){

File root = new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/appName/savedlocations");
root.mkdirs();
File fileName = new File(root, "locationslatitude.txt");
File fileName2 = new File(root, "locationslongitude.txt");

String file = fileName.toString();
String file2 = fileName2.toString();

String theContent = Double.toString(currLatitude);
String theContent2 = Double.toString(currLongitude);

s = new Scanner(file);
    while (s.hasNext()){
        fileList.add(s.next());
    }
    s.close();
    fileList.add(theContent);

    s2 = new Scanner(file2);
    while (s2.hasNext()){
        fileList2.add(s2.next());
    }
    s2.close();
    fileList2.add(theContent2);

try {//works for latitude file
        FileWriter writer = new FileWriter(file); 
        for(String str: fileList) { 
          writer.write(str);
          writer.write("\r\n");
        }
        writer.close();
        } catch (java.io.IOException error) {
          //do something if an IOException occurs.
            Toast.makeText(this, "Cannot Save Back To A File", Toast.LENGTH_LONG).show();
    }
//save the arraylist back to its appropriate file
    try {//works for longitude file
        FileWriter writer = new FileWriter(file2); 
        for(String str2: fileList2) { 
          writer.write(str2);
          writer.write("\r\n");
        }
        writer.close();
    } catch (java.io.IOException error) {
      //do something if an IOException occurs.
        Toast.makeText(this, "Cannot Save Back To A File", Toast.LENGTH_LONG).show();
    }
} 
```

我相信我找到了问题的答案，我想把它发回到这里，所以如果其他人面临同样的问题，这可能会对他们有所帮助。

问题是它没有创建文件。该目录是使用“root.mkdirs();”创建的。但是，没有创建文件，我试图从不存在的文件中读取。这就是我认为导致错误的原因。因此，为了解决此问题，我将代码更改为：

```
 try{

        s = new Scanner(fileName);
        while (s.hasNext()){
            fileList.add(s.next());
        }
        s.close();
                fileList.add(theContent);

}catch (FileNotFoundException ex){
    ex.printStackTrace();
    try{
        fileName.createNewFile();
    }catch (IOException e){
        e.printStackTrace();
        Toast.makeText(this, "Hit IOException for file one", Toast.LENGTH_SHORT).show();
    }
}

try{  
        s2 = new Scanner(fileName2);
        while (s2.hasNext()){
            fileList2.add(s2.next());
        }
        s2.close();
                fileList2.add(theContent2);
}catch (FileNotFoundException ex){
    ex.printStackTrace();
    try{
        fileName2.createNewFile();
    }catch (IOException e){
        e.printStackTrace();
        Toast.makeText(this, "Hit IOException for file two", Toast.LENGTH_SHORT).show();
    }
} 
```

这是我必须修改的唯一一段代码。保存回文件的代码有效。我希望这对某人有用，并感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:10:15.237

您是否在 AndroidManifest.xml 中添加了以下权限？

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:34:01.163

此代码适用于我的项目。您可以使用它将 ArrayList 内容保存到文本文件。确保事先创建了目录。只需遍历您的列表并使用 println 方法将其写入 txt 文件。

```
FileWriter outFile = new FileWriter(Environment.getExternalStorageDirectory().getAbsolutePath() + "/appName/savedlocations/nameoftextfile.txt");
PrintWriter out = new PrintWriter(outFile);
out.println("PRINT LINES WITH ME");
out.print("NOT NECCESSARILY A NEW LINE");
out.close(); // at the very end 
```

不要忘记捕捉 IOException。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:30:41.000

首先检查您正在使用的设备上是否存在文件目录等

/appName/savedlocations 这些很可能不存在。appName 或 savedLocations 的名称错误。使用一些文件资源管理器程序检查这一点。告诉我们它是否存在。打印出完整路径名

```
 Environment.getExternalStorageDirectory().getAbsolutePath() + "/appName/savedlocations 
```

看看它是否真的存在。只需下载一个用于文件查看的应用程序，或者我认为您也可以通过 eclipse 连接到设备。如果您需要有关如何操作的更多信息，请告诉我们。但是您应该首先检查实际的错误消息并将其报告回来。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-07-17T00:52:16.493

不要发明自己的序列化格式。java已经有了。

```
ArrayList<String> files = ...; // whatever

// write the object to a file

ObjectOutput out = new ObjectOutputStream(new FileOutputStream("filename.ser"));
out.writeObject(files);
out.close();

// read the object back

InputStream is = new FileInputStream("filename.ser"); 
ObjectInputStream ois = new ObjectInputStream(is); 
ArrayList<String> newFiles = = (ArrayList)ois.readObject(); 
ois.close(); 
```

# java - 调用 Nagios 内置插件

> ID：11514368
> 
> 赞同：0
> 
> 时间：2012-07-17T00:07:30.180
> 
> 标签：java, plugins, integration, nagios

我的系统管理员在 Ubuntu 10.04.3 LTS 上安装了 Nagios。我应该如何从 shell 调用 Nagios 内置插件，例如 check_disk。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T09:04:57.693

移动到插件所在的文件夹

cd /usr/local/nagios/libexec

./check_disk --options

例如：

./check_disk -w 80% -c 90% -M

# sql - 如何在 Access 2007 中使用 VBA 保存 SQL COUNT 查询的结果？

> ID：11514372
> 
> 赞同：4
> 
> 时间：2012-07-17T00:07:59.757
> 
> 标签：sql, ms-access, count, ms-access-2007, vba

我正在尝试计算表中满足特定条件的记录数。我的偏好是使用 SQL，而不是 Dcount，因为我想在 SQL 方面做得更好。这是我当前的代码如下：

```
Dim countString As String
Dim count

countString = "SELECT COUNT(*) FROM `Engagement Letters` WHERE 'Client ID' = " & Me.cboSelectClient

count = CurrentDb.OpenRecordset(countString).Fields(0).Value 
```

是的，我知道，我在表格和字段名称中使用了空格——我会改变它。虽然我认为我仍然应该能够按原样运行这个查询，所以我现在就让它保持原样。

当我运行上述代码时，我收到运行时错误 3464 - 条件表达式中的数据类型不匹配。我已经让以下 dcount 功能正常工作：

```
count = DCount("[Engagement Letter ID]", "Engagement Letters", "[Client ID] = " & Me.cboSelectClient) 
```

而且下面没有 WHERE 的 COUNT 查询也可以正常工作：

```
"SELECT COUNT(*) FROM `Engagement Letters`" 
```

我对 SQL 的了解非常少，对更高级的 VBA 的了解也非常少，所以我不确定我哪里出错了。谁能帮我这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:24:14.587

尝试像这样构建你的字符串。

```
countString = "SELECT COUNT(*) FROM [Engagement Letters]" & vbCrLf & _
"WHERE [Client ID] = " & Me.cboSelectClient
Debug.Print countString 
```

在对象（表和字段）名称周围使用方括号，其中包括空格或除字母、数字和下划线字符之外的任何字符。

对于表名，您使用了 `Engagement Letters`，并且反引号的工作方式与方括号相同。也许它们总是同样有效，但我不确定，因为我只使用括号。括号而不是反引号可能会帮助您避免这个错误......

```
WHERE 'Client ID' = " & Me.cboSelectClient 
```

...那是要求数据库引擎将文字字符串 ,`"Client ID"`与您从中提取的数值 (?)进行比较`cboSelectClient`。

我`vbCrLf`在语句的两部分之间使用了，`SELECT`因为我发现在检查完整的字符串时很方便（通过`Debug.Print`）。

# c++ - 插入字符串时出错<<重载C++

> ID：11514375
> 
> 赞同：2
> 
> 时间：2012-07-17T00:08:15.953
> 
> 标签：c++

我正在尝试在 C++ 中的类上重载 << 运算符。每当我在输出流中插入一个普通的字符串，比如“”，我就会得到我无法理解的编译错误。我以前做过一次没有问题，所以我很困惑。

```
friend std::ostream& operator<<(std::ostream& out, Variable v);

std::ostream& operator<<(std::ostream& out, Variable v) {
    out << v.type;
    out << " ";
    out << v.name;
    return out;
} 
```

这是输出：

```
src/Variable.cpp: In function 'std::ostream& operator<<(std::ostream&, Variable)':
src/Variable.cpp:35:9: error: no match for 'operator<<' in 'out << " "'
src/Variable.cpp:35:9: note: candidates are:
src/Variable.cpp:33:15: note: std::ostream& operator<<(std::ostream&, Variable)
src/Variable.cpp:33:15: note:   no known conversion for argument 2 from 'const char [2]' to 'Variable'
In file included from /usr/local/Cellar/gcc/4.7.0/gcc/lib/gcc/x86_64-apple-darwin10.8.0/4.7.0/../../../../include/c++/4.7.0/string:54:0,
             from src/../inc/Variable.h:4,
             from src/Variable.cpp:1:
/usr/local/Cellar/gcc/4.7.0/gcc/lib/gcc/x86_64-apple-darwin10.8.0/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2750:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_ostream<_CharT, _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/local/Cellar/gcc/4.7.0/gcc/lib/gcc/x86_64-apple-darwin10.8.0/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2750:5: note:   template argument deduction/substitution failed:
src/Variable.cpp:35:9: note:   mismatched types 'const std::basic_string<_CharT, _Traits, _Alloc>' and 'const char [2]'
make: *** [bin/Variable.o] Error 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T00:38:51.703

德普。我没有包括 iostream。但是，这对我来说没有多大意义......因为只要我没有向 ostream 添加字符串，它就会起作用。我认为编译器根本找不到 ostream，并且会抱怨

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:13:59.670

```
#include <utility>
#include <iostream>

template <typename T1, typename T2>
std::ostream& operator<< (std::ostream& out, const std::pair<T1, T2>& v)
{
    out << v.first;
    out << " ";
    out << v.second << std::endl;
    return out;
}

int main()
{
    std::pair<int, int> a = std::make_pair(12, 124);
    std::cout << a << std::endl;
    return EXIT_SUCCESS;
} 
```

它是一个如何声明和实现运算符的示例<<

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T00:33:26.350

我将在代码中展示您的解决方案

```
#include <iostream>
#include <string>

/* our custom class */
class Developer 
{
public:
    Developer(const std::string& name, int age) :
     m_name(name), 
     m_age(age) 
    {}

    const std::string& name() const { return m_name; }
    int age() const { return m_age; }

private:
    std::string m_name;
    int m_age;
};

/* overloaded operator<< for output of custom class Developer */
std::ostream& operator<< (std::ostream& stream, const Developer& developer) 
{
    stream << "Developer name:\t" << developer.name() << std::endl;
    stream << "Developer age:\t"  << developer.age()  << std::endl;
    return stream;
}

/* test custom operator<< for class Developer */
int main(int argc, const char** argv) 
{    
    Developer max("Maxim", 23);
    std::cout << max;

    return 0;   
} 
```

# c++ - 在 C 中对指向对象的指针使用方法

> ID：11514384
> 
> 赞同：2
> 
> 时间：2012-07-17T00:09:34.637
> 
> 标签：c++, class, object, pointers, return

我正在尝试制作 Minesweeper 的控制台版本，但我在编辑板上的特定单元格时遇到了一些困难。如您所见，我有一个 Board，它有一个私有的 [6][6] Cell 对象数组。

目前，我正在尝试使用类似的方法调用 Cell 方法， `Board gameBoard; gameBoard.accessCell(row,col).flag();` 但这似乎实际上并不是在编辑所访问 Cell 的状态，因为正在复制对象而不是指针。如何修复`Board::accessCell(int row, int col)`以返回指向对象的指针，以便我可以调用函数并实际编辑其状态？

```
#include <iostream>
#include <ctime>
#include <cstdlib>
#include <iomanip>
#include <string>
using namespace std;

#define debugging true //set this to true to activiate debugging

const int ROWS(6), COLS(6), MINE(-1);
const char FLAG('F'), REVEALED('R'), HIDDEN('*');

class Cell
{
    friend class Board;
    private:
        char displaySetting;
        int minesTouching;
    public:
        Cell();
        int getMinesTouching() const;
        void increaseMinesTouching();
        char getDisplaySetting() const;
        bool isMine() const;
        void flag();
        void reveal();
        void setMine();
};
int Cell::getMinesTouching() const { return this->minesTouching; }
void Cell::increaseMinesTouching() { this->minesTouching++; }
char Cell::getDisplaySetting() const { return this->displaySetting; }
bool Cell::isMine() const { return this->minesTouching == MINE; }
void Cell::flag() { this->displaySetting = FLAG; }
void Cell::reveal() { this->displaySetting = REVEALED; }
void Cell::setMine() { this->minesTouching = MINE; }
Cell::Cell():
    displaySetting(HIDDEN),
    minesTouching(0)
{}

class Board
{
    private:
        Cell boardCells[ROWS][COLS];
    public:
        Board();
        bool isInBounds(int row, int col) const;
        void reveal(int row, int col);
        void displayBoard() const;
        Cell accessCell(int row, int col) const;
};
Board::Board()
{
    //place mines randomly
    srand(time(0));
    for(int i=0; i<6;)
    {
        int row = rand()%6, col = rand()%6;
        if(!this->boardCells[row][col].isMine())
        {
            this->boardCells[row][col].setMine();
            i++;
        }
    }

    //determine number of mines touching each space and store them
    for(int i=0; i<ROWS; i++)
    {
        for(int j=0; j<COLS; j++)
        {
            if(!boardCells[i][j].isMine())
            {
                if(boardCells[i+1][j+1].isMine())   boardCells[i][j].increaseMinesTouching(); //bottom right
                if(boardCells[i-1][j-1].isMine())   boardCells[i][j].increaseMinesTouching(); //top left
                if(boardCells[i+1][j+0].isMine())   boardCells[i][j].increaseMinesTouching(); //down
                if(boardCells[i+0][j+1].isMine())   boardCells[i][j].increaseMinesTouching(); //right
                if(boardCells[i-1][j-0].isMine())   boardCells[i][j].increaseMinesTouching(); //up
                if(boardCells[i-0][j-1].isMine())   boardCells[i][j].increaseMinesTouching(); //left
                if(boardCells[i+1][j-1].isMine())   boardCells[i][j].increaseMinesTouching(); //bottom left
                if(boardCells[i-1][j+1].isMine())   boardCells[i][j].increaseMinesTouching(); //top right
            }
        }
    }
}
bool Board::isInBounds(int row, int col) const
{
    if(row < 0) return false;
    if(row >= ROWS) return false;
    if(col >= COLS) return false;
    if(col < 0) return false;
    return true;
}
void Board::reveal(int row, int col)
{
    if(!this->boardCells[row][col].getMinesTouching())
    {
        this->boardCells[row][col].reveal();
            if(isInBounds(row+1, col+1))    this->reveal(row+1, col+1); //bottom right
        if(isInBounds(row-1, col-1))    this->reveal(row-1, col-1); //top left
        if(isInBounds(row+1, col+0))    this->reveal(row+1, col+0); //down
        if(isInBounds(row+0, col+1))    this->reveal(row+0, col+1); //right
        if(isInBounds(row-1, col-0))    this->reveal(row-1, col-0); //up
        if(isInBounds(row-0, col-1))    this->reveal(row-0, col-1); //left
        if(isInBounds(row+1, col-1))    this->reveal(row+1, col-1); //bottom left
        if(isInBounds(row-1, col+1))    this->reveal(row-1, col+1); //top right
    }
}
void Board::displayBoard() const
{
    system("clear");
    if(debugging) //display system board if debugging is enabled
    {
        for(int i=0; i<ROWS; i++)
        {
            for(int j=0; j<COLS; j++)
                cout << "[ " << setw(3) << this->boardCells[i][j].getMinesTouching() << setw(3) << " ]";
            cout << "\n";
        }
        cout << "\n\n\n";
    }

    //
    for(int i=0; i<ROWS; i++)
    {
        for(int j=0; j<COLS; j++)
        {
            if(this->boardCells[i][j].getDisplaySetting() == HIDDEN)
                cout << "[ " << setw(3) << this->boardCells[i][j].getDisplaySetting() << setw(3) << " ]";
            else if(this->boardCells[i][j].getDisplaySetting() == REVEALED)
                cout << "[ " << setw(3) << this->boardCells[i][j].getMinesTouching() << setw(3) << " ]";
            else
                cout <<"[ " << setw(3) << FLAG << setw(3) << " ]";
        }
        cout << "\n";
    }
    cout << "\n";
}
Cell Board::accessCell(int row, int col) const { return this->boardCells[row][col]; }

//function prototypes
void provideMenu();
string playTurn(Board gameBoard, int& guesses);
void playGame();

int main()
{
    Board gameBoard;
    provideMenu();
    return 0;
}

void provideMenu()
{
    int choice(0);
    while(choice < 1 || choice > 3)
    {
        cout << "1:\t Play a game of Minesweeper" << endl;
        cout << "2:\t Help" << endl;
        cout << "3:\t Exit" << endl;
        cin>>choice;
    }
    switch(choice)
    {
        case 1:
            playGame();
            break;
        case 2:
            cout << "The objective of Minesweeper is to clear all the tiles on the board without mines without uncovering any hidden mines" << endl;
            cout << "*\t Hidden tile, has yet to be revealed" << endl;
            cout << "F\t Flagged tile, marked by user as possible mine" << endl;
            cout << "#\t Any number represents the number of mines touching the tile" << endl;
            break;
    }
}

void playGame()
{
    Board gameBoard;
    int guesses(0);
    string gameState = "onGoing";
    while(gameState == "onGoing")
    {
        gameState = playTurn(gameBoard, guesses);
        if(gameState == "userWon")
            cout << "Congratulations, you've one!" << endl;
        if(gameState == "userLost")
        {
            cout << "Game over! Try again!" << endl;
            gameBoard.displayBoard();
        }
    }
}

string playTurn(Board gameBoard, int& guesses)
{
    gameBoard.displayBoard();

    int row;
    do
    {
        cout << "Row:";
        cin>>row;
    } while(row <0 || row >= ROWS);

    int col;
    do
    {
        cout << "Column:";
        cin>>col;
    } while(col < 0 || col>= COLS);

    if(gameBoard.accessCell(row, col).isMine())
        return "userLost";
    if(++guesses == ROWS*COLS-6)
        return "userWon";
    gameBoard.reveal(row,col);
    return "onGoing";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:22:41.753

您已经定义了返回副本的访问方法：

```
 Cell accessCell(int row, int col) const ; 
```

由于您希望能够修改`Cell`返回的内容，因此您应该返回一个引用，并且该方法不应该是`const`.

```
 Cell & accessCell(int row, int col); 
```

还需要对方法的实现进行相应的更改。

```
Cell & Board::accessCell(int row, int col) { return this->boardCells[row][col]; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:22:51.743

返回对 Cell 对象的引用而不是副本：

```
const Cell& Board::accessCell(int row, int col) const
{
    return this->boardCells[row][col];
} 
```

如果你需要一个`mutable`版本（非`const`），那么我会提示你需要重载这个函数。

# .htaccess - 如何使用 htaccess 重定向基本 url？

> ID：11514386
> 
> 赞同：0
> 
> 时间：2012-07-17T00:09:50.147
> 
> 标签：.htaccess, mod-rewrite, redirect

我有一个 URL 结构：

```
mysite.com/user/(someusername) 
```

并且只想重定向基本 URL，即：

```
mysite.com/user/ 
```

到

```
mysite.com/users/ or mysite.com/members/ 
```

但问题是当我将此行添加到 htaccess 时。

```
redirect 301 /user /users/ 
```

甚至

```
 mysite.com/user/(someusername) 
```

被重定向到

```
mysite.com/users/(someusername) 
```

我怎样才能重定向 /user/ 只？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:08:51.077

```
RewriteEngine on
RewriteBase /
RewriteRule ^user/$ users/ [L,R] 
```

# html - FF/IE定位：绝对bug

> ID：11514387
> 
> 赞同：1
> 
> 时间：2012-07-17T00:09:53.783
> 
> 标签：html, css

似乎 Chrome 是唯一一个以我想要的方式呈现我的代码的浏览器。

如果您注意到我`position:absolute`的边框尺寸随着边框大小的增加而变化（在 FF 和 IE 中），但在 chrome 中不受影响（这正是我想要的）。

[这是一个演示](http://jsfiddle.net/AyCKU/1/)请在 chrome/ie/ff 中尝试一下，看看有什么不同

所有这些黑魔法的主要目的很简单，我需要`.thumb:after`始终处于`.thumb`. 如果您知道更好的方法，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:28:33.730

**编辑：已修复——在 FF 和 Chrome 中检查（没有更新版本的 IE）**

[http://jsfiddle.net/AyCKU/8/](http://jsfiddle.net/AyCKU/8/)

取出边距：0 auto，只是将其保留在使用 %'s 作为顶部和左侧边距和负边距。

基本上：使用 CSS 中垂直居中的方法之一（使用 50% 和负边距）并将其应用于垂直和水平居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:01:42.967

我在 Chrome + FF 中搞砸了一点，并注意到如果你改变：

```
.item .thumb:after 
```

如果您将定位更改为固定并将其正确居中，它将在两种浏览器中均有效。

在 IE 中试一试，让我知道它是否有效..

# c# - 如何在将标准输出和标准错误输出到文件的同时实时查看控制台

> ID：11514388
> 
> 赞同：2
> 
> 时间：2012-07-17T00:10:01.133
> 
> 标签：c#, cmd, stdout, stderr, windows-console

我有一个 C# 控制台应用程序，只需键入 c 即可在控制台上运行和观看：

```
programName.exe 
```

我也可以通过执行以下操作将其写入文件：

```
programName.exe > log.txt 
```

但是，当我这样做时，我无法查看正在发生的输出。整个程序完成后，我只能查看日志文件。

我怎样才能同时做这两个？我想查看实时标准输出和标准错误，但仍写入该日志文件。有没有办法在不改变 c# 应用程序代码的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:47:45.770

如果您可以选择使用 Windows PowerShell，则可以使用以下`Tee-Object`命令：

```
programName.exe | tee -file 'log.txt' 
```

这会将标准输出同时重定向到控制台窗口和 log.txt。`stdout`重定向两者的解决方法`stderr`是：

```
programName.exe 2>&1 | tee -file 'log.txt' 
```

您可能还会发现对[这个类似问题](https://stackoverflow.com/questions/278296/how-to-capture-and-display-output-from-a-task-via-windows-cmd)的回答很有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:30:57.027

我不知道任何现有的命令可以做到这一点。

但是您可以编写一个简单的新程序来复制标准输入并将它们写入控制台和文件。希望这可以帮到你。

# xcode - 为什么 Interface Builder 中 iPad 应用的视图大小为 703x768？

> ID：11514391
> 
> 赞同：0
> 
> 时间：2012-07-17T00:10:23.473
> 
> 标签：xcode, ipad, uiviewcontroller, interface-builder, ipad-2

我正在开发我的第一个 iPad 应用程序。默认情况下，Xcode 为我生成了一个起点项目，其中包含拆分视图控制器的基本模板。

我现在专注于细节视图控制器（我的第一个应用程序版本可能只使用这个视图）。

无论如何，我注意到在 Xcode 集成的 Interface Builder 中，详细视图是 703（宽度）x 768（高度）。

第一个问题：为什么宽度是703？

现在，IB 中的视图显示了视图的纵向布局。所以更奇怪的是宽度大于高度（当它应该是相反的时候）。

我实际上预计宽度为 768，高度为 1024。

*   更新 *

第二个问题：在纵向模式下，为什么宽度是 1024，高度是 768（见上面的结束评论）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T04:21:34.837

根据文档，拆分视图的主视图宽度为 320 像素，根据设备的方向，详细信息窗格的宽度为 768 或 704 像素。

ref> [ipad 拆分视图尺寸零件](https://stackoverflow.com/questions/10004771/ipad-split-view-dimension-parts)

请看[这里](http://vickiwenderlich.s3-website-us-east-1.amazonaws.com/wp-content/uploads/2012/07/Basics_ipad1.jpg)

# python - 清除numpy数组的元素

> ID：11514394
> 
> 赞同：4
> 
> 时间：2012-07-17T00:10:40.950
> 
> 标签：python, arrays, numpy

有没有一种简单的方法来清除 numpy 数组的所有元素？我试过：

删除数组名

这将完全删除阵列。我在迭代数千次的 for 循环中使用这个数组，所以我更喜欢保留数组，但每次都用新元素填充它。

我尝试了 numpy.delete，但出于我的要求，我没有看到子数组规范的使用。

**已编辑**：

数组大小*不会*相同。

我在开始时在循环内部分配空间，如下所示。如果这是错误的方法，请纠正我：

```
arrname = arange(x*6).reshape(x,6) 
```

我读取了一个数据集并为数据集中的每个元组构造了这个数组。我所知道的是列数将是相同的，但不是行数。例如，第一次我可能需要一个大小为 (3,6) 的数组，下一个元组为 (1,6)，下一次为 (4,6) 等等。我填充数组的方式如下：

```
arrname[:,0] = lstname1
arrname[:,1] = lstname2
... 
```

换句话说，这些列是从由元组构造的列表中填充的。因此，在下一个循环开始之前，我想清除它的元素并使其为连续循环做好准备，因为我不希望前一个循环的残余混合当前内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T00:30:52.813

我不确定你所说的清楚是什么意思，数组中总是会存储一些值，但你可以将这些值设置为某些值，例如：

```
>>> A = numpy.array([[1, 2], [3, 4], [5, 6]], dtype=numpy.float)
>>> A
array([[ 1.,  2.],
       [ 3.,  4.],
       [ 5.,  6.]])

>>> A.fill(0)
>>> A
array([[ 0.,  0.],
       [ 0.,  0.],
       [ 0.,  0.]])

>>> A[:] = 1.
>>> A
array([[ 1.,  1.],
       [ 1.,  1.],
       [ 1.,  1.]]) 
```

更新

首先，你的问题很不清楚。你在写一个好问题上付出的努力越多，你就会得到更好的答案。一个好的问题应该让我们清楚你想要做什么以及为什么。示例数据也非常有用，只是少量，因此我们可以准确地看到您正在尝试做什么。

话虽如此。似乎您应该为每次迭代创建一个新数组。创建数组非常快，当大小和内容需要更改时，为什么要重用数组还不清楚。如果您出于性能原因尝试重用它，您可能不会看到任何可测量的差异，调整数组大小并不比创建新数组快得多。您可以通过调用创建一个新数组`numpy.zeros((X, 6))`

在您的问题中，您还说：

> 这些列是从由元组构造的列表中填充的

如果您的数据已经作为元组列表存储，您可以使用`numpy.array`它来将其转换为数组。您无需费心创建数组并填充它。例如，如果我想从元组列表中获取 (2, 3) 数组，我会这样做：

```
data = [(0, 0, 1), (0, 0, 2)]
A = numpy.array(data)

# or if the data is stored like this
data = [(0, 0), (0, 0), (1, 2)]
A = numpy.array(data).T 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T21:21:52.663

为可能的过早优化摇动手指，我将提供一些想法：

您说您不希望以前的迭代留下任何残余物。从您的代码看来，您为每个已知列数逐列填充每个新元素。“剩余”值看起来不是问题。考虑：

*   使用 arange 和 reshape 毫无用处。使用`np.empty((n,6))`. `ones`比`zeros`头发还快。

*   你也可以从成分中构造你的新数组

看：

```
lstname1 = np.arange(3)
lstname2 = 22*np.arange(3)
np.vstack((lstname1,lstname2)).T
# returns
array([[ 0,  0],
       [ 1, 22],
       [ 2, 44]])
#or
np.hstack((lstname1[:,np.newaxis],lstname2[:,np.newaxis]))
array([[ 0,  0],
       [ 1, 22],
       [ 2, 44]]) 
```

最后，如果您真的很关心速度，您可以分配最大的预期大小（如果不知道，您可以检查请求的大小与最后最大的大小，如果它更大，则使用`np.empty((rows,cols))`增加大小。

然后在每次迭代中，您创建一个包含您想要的行数的更大矩阵的视图。这将导致 numpy 重用相同的缓冲区空间，并且不需要在每次迭代中进行任何分配。注意：

```
In [36]: big = np.vstack((lstname1,lstname2)).T

In [37]: smaller = big[:2]

In [38]: smaller[:,1]=33

In [39]: smaller
Out[39]: 
array([[ 0, 33],
       [ 1, 33]])
In [40]: big
Out[40]: 
array([[ 0, 33],
       [ 1, 33],
       [ 2, 44]]) 
```

**注意**这些建议适合您的扩展问题并进行澄清，不适合您之前关于“清除”数组的问题。即使在后一个示例中，您也可以轻松地说`smaller.fill(0)`，根据您在迭代中是否可靠地重新分配数组的所有元素来减轻担忧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T02:01:24.067

如果要保持分配的数组并具有相同的大小，则无需清除元素。只需跟踪您所在的位置，然后覆盖数组中的值。这是最有效的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T00:20:45.657

我只是开始将新值放入数组中。

但是，如果您坚持清除数组，请尝试使用[zeros](http://docs.scipy.org/doc/numpy/reference/generated/numpy.zeros.html)或[empty](http://docs.scipy.org/doc/numpy/reference/generated/numpy.empty.html)创建一个相同大小的新数组。

```
>>> A = numpy.array([[1, 2], [3, 4], [5, 6]])
>>> A
array([[1, 2],
       [3, 4],
       [5, 6]])

>>> A = numpy.zeros(A.shape)
>>> A
array([[ 0.,  0.],
       [ 0.,  0.],
       [ 0.,  0.]]) 
```

# javascript - 一行中的多个变量赋值

> ID：11514401
> 
> 赞同：4
> 
> 时间：2012-07-17T00:11:52.977
> 
> 标签：javascript

由于每种编程语言都不同，而且我对 Javascript 的经验处于基础水平，我想知道如何评估一行中的多个变量分配

例子：

```
 a = b = c = d = 5; 
```

这样的语句是否会分配给 4个`5`变量`a`,`b`和?`c``d`

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-17T01:35:01.807

简短的回答是*肯定*的，该语句将分配`5`给 4 个变量`a`、`b`和`c`中的每一个`d`。但是，与前面所说的相反，它不会分配`5`给`d`，然后是`d`to的值`c`，而是会为每个变量分配相同的值，从右侧开始。更清楚地说，您的陈述：

```
var a, b, c, d;
a = b = c = d = 5; 
```

它相当于：

```
var d = 5;
var c = 5;
var b = 5;
var a = 5; 
```

**不**：

```
var d = 5;
var c = d;
var b = c;
var a = b; 
```

这是一个微妙但重要的区别：在第一种情况下，JavaScript 只是为所有变量*设置*一个值。在第二种情况下，JavaScript为所有变量*设置了一个值，***但**也*获取*了三个变量的值（`a`没有在任何地方赋值）。

一个简单的代码将显示：

```
// `this` is the global object if you run this code in the global scope.
// In the browsers the global object is `window`.
Object.defineProperties(this, {  
  "a": {  
    get: function() {
        console.log("get a");
    },
    set: function(value) {
        console.log("set a");
    }
  },  
  "b": {  
    get: function() {
        console.log("get b");
    },
    set: function(value) {
        console.log("set b");
    }
  },  
  "c": {  
    get: function() {
        console.log("get c");
    },
    set: function(value) {
        console.log("set c");
    }
  },  
  "d": {  
    get: function() {
        console.log("get d");
    },
    set: function(value) {
        console.log("set d");
    }
  }  
});

b = c = d = 5;
a = b; 
```

在控制台上，您应该拥有：

```
set d
set c
set b
get b
set a 
```

如您所见，对于语句`b = c = d = 5`JS 仅*设置*变量，并同时调用`set`和`get`on `b`，因为语句`a = b`.

这种区别非常重要，因为如果您为您的属性定义了一些 getter 而您没有意识到这种行为，那么您最终会遇到使用多个变量分配的意外错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T00:25:41.247

大多数情况下是的，但请考虑以下情况：

```
Object.defineProperty(this, "b", { value : 6, writable : false });
var a, c, d;

a = b = c = d = 5;

console.log(a); // 5
console.log(b); // 6
console.log(c); // 5
console.log(d); // 5 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T00:18:24.840

答案是肯定的。

```
a=b=c=d=e=f=g=h=4; // all get to be 4
a=b=c=d=e=f=g=h={ p1:"1", p2:"2" }; // same object for all

a.p3 = "3";
console.log((a==b && b==c && c==d && d==e), f); // condition is true, f is now 
//    {
//        p1:"1",
//        p2:"2",
//        p3:"3"
//    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T00:18:00.850

你只需要尝试就知道答案：**是**的。

它这样工作的原因是赋值取等号右侧的任何内容并将该值分配给左侧的变量。

所以`5`分配给`d`; 然后将值`d`分配给`c`等等。

# c# - 查找下一个回车的偏移量（以字节为单位）

> ID：11514402
> 
> 赞同：0
> 
> 时间：2012-07-17T00:12:06.413
> 
> 标签：c#, stream, seek

我正在使用 FileStream 读取文件。有时我的流位置在句子的中间，我需要将它移到句子的末尾（所有句子都用换行符分隔）。我打算做的是找到回车（\r）的偏移量，然后使用 FileStream.Seek 设置它的位置。

例子：

你好，你好，你好。

对对对

我的光标就在'HALLO'之后，我想要下一句前面的回车偏移量（YES YES YES）

有什么函数可以获取下一个回车的偏移量吗？我是学生，还在学习。感谢您的所有反馈和意见:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:15:06.953

你不是在想“在流中”——在“思想上纯粹的”流中，你不能重新定位流指针（又名“寻找”，改变“位置”属性），你必须自己跟踪所有以前的数据，通常使用排序状态机或其他数据结构。

我有一个问题：为什么要查找 的字节位置`\r`？你想要完成的“大事”是什么？我怀疑有一个更简单的方法。

# javascript - 如何用 JavaScript 中的 Ajax 调用替换加载脚本文件（将 YQL 与 JavaScript 结合使用）

> ID：11514409
> 
> 赞同：0
> 
> 时间：2012-07-17T00:12:55.503
> 
> 标签：javascript, jquery, ajax, jsonp, yql

！！！Andrew Whitaker 的回答（很好的例子）已经回答了以下问题。基本上，您可以使用 $.getJSON(..) 以编程方式从 YQL 等服务获取 JSON 数据，注意该服务可以与不同的域相关联（即，不是由加载页面的同一域提供） . 通常，您不能向不同的域发出这样的请求，因此在实现请求时使用“技巧”来动态生成 HTML 并将其插入 DOM 并获取并执行新的跨域脚本。在执行返回的脚本时，它会导致处理它携带的 JSON 并调用您提供的回调函数。因为这种技术会盲目地执行返回的脚本，所以必须注意安全问题（可能类似于加载任何脚本）。为了启用跨域功能，在提供的 getJSON url 中包含选项“？callback =？”非常重要，该选项被 jQuery 拾取并删除/修改，作为使用 JSONP 跨域调用的信号技术。请注意，这种返回 JSON 数据的方法依赖于 JSONP 的服务器端支持。再次感谢所有帮助。！！！

以下代码发送到 YQL 并获取 IBM 的当前股票价格（作为示例）。它工作正常，并通过加载一个脚本文件来完成其任务，该脚本文件的 URL 有效地导致 JSON 数据的动态生成，在加载和执行时，会导致运行“top_stories”并提取价格。但是，我想基于 AJAX 调用 ($.getJSON(..)) 进行此过程，我假设我从下面基于脚本的示例中分离出 url 和数据组件。我已经尝试了很多变体但没有成功——我似乎无法通过 $.getJSON(..) 调用来调用回调函数。任何想法将不胜感激。...埃里克

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
  <head><title>YQL</title>
   <style type='text/css'>
    #results{ width: 40%; margin-left: 30%; border: 1px solid gray; padding: 5px; height: 200px; overflow: auto; } 
  </style>
  <script type='text/javascript'>
  // Parses returned response 
  function top_stories(o) {
      var price = o.query.results.xml_api_reply.finance.last.data;
      alert("last = " + price);
      // Place price in div tag
      document.getElementById('results').innerHTML = price;
  }
</script>
</head>
<body>
   <!-- Div tag for stories results -->
   <div id='results'></div>
   <!-- The YQL statment will be assigned to src. -->
   <script src="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20google.igoogle.stock%20where%20stock%3D'ibm'%3B&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=top_stories"></script>   
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:24:00.550

我不确定这是否是您的意思，但是您可以通过以下方式将查询字符串参数分解为“数据”对象：

```
$.getJSON("http://query.yahooapis.com/v1/public/yql?callback=?", {
    q: "select * from google.igoogle.stock where stock='ibm'",
    format: 'json',
    diagnostics: true,
    env: 'store://datatables.org/alltableswithkeys'
}, top_stories); 
```

**示例：http:** [//jsfiddle.net/dcXjk/1/](http://jsfiddle.net/dcXjk/1/)

顺便说一句，如果您仍然使用 jQuery，您可以继续使用`.html`直接分配给`innerHTML`：

```
function top_stories(o) {
    var price = o.query.results.xml_api_reply.finance.last.data;
    alert("last = " + price);
    // Place price in div tag
    $("#results").html(price);
} 
```

* * *

这是一个更充实的示例，您也可以在其中传递股票代码：

**JavaScript：**

```
function top_stories(o, symbol) {
    var price = o.query.results.xml_api_reply.finance.last.data;

    // Place price in div tag
    $("#" + symbol).html(price);
}

function getStockValue(symbol) {
    $.getJSON("http://query.yahooapis.com/v1/public/yql?callback=?", {
        q: "select * from google.igoogle.stock where stock='" + symbol + "'",
        format: 'json',
        diagnostics: true,
        env: 'store://datatables.org/alltableswithkeys'
    }, function(data) {
        top_stories(data, symbol);
    });
}

$(function() {
    getStockValue("ibm");
    getStockValue("nflx");
    getStockValue("msft");
}); 
```

**HTML：**

```
<p>IBM:</p><div id="ibm"></div>
<p>Netflix:</p><div id="nflx"></div>
<p>Microsoft:</p><div id="msft"></div> 
```

**示例：http:** [//jsfiddle.net/B3L4p/1/](http://jsfiddle.net/B3L4p/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:20:13.017

这是一个工作代码：

```
 $(function () {
    var ticker = "IBM";
    var url = "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20WHERE%20symbol%3D'"+ticker+"'&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys";
    $.getJSON(url, function(data) {
      var items = [];
      $.each(data.query.results.quote, function(key, val) {
        if(key == "ChangePercentRealtime" || key == "LastTradeRealtimeWithTime") { items.push(val)};
      });
        $("#nameOfDiv1").html(items[0].substr(9));
        $("#nameOfDiv2").html(items[1].substr(6));
    });
}); 
```

substr() 从返回的结果中获取实际数据，其中包含一些无用的东西。它把它放在一些html div中。您显然可以选择任何您想要的结果集。希望对你有帮助！

# java - 如何获取字符串中的 URL 连接结果？

> ID：11514411
> 
> 赞同：0
> 
> 时间：2012-07-17T00:13:12.867
> 
> 标签：java, json, yahoo-api

我正在研究雅虎老板 API。应该返回 JSON 的 URL，我需要将它存储在一个字符串中然后解析它。[http://developer.yahoo.com/java/howto-parseRestJava.html](http://developer.yahoo.com/java/howto-parseRestJava.html)

我的问题：如何将 URL 响应保存在字符串中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:22:28.683

从技术上讲，您希望在 URL InputStream 周围包装一个适当配置的 InputStreamReader 并将 Reader 复制到 StringWriter（apache commons IO 具有“[将 Reader 复制到 String](http://commons.apache.org/io/api-1.4/org/apache/commons/io/IOUtils.html#toString%28java.io.Reader%29) ”实用程序方法）。但是，为了确定 InputStreamReader 的正确字符集，您需要解析 ContentType 标头。在这种情况下，您最好使用更高级别的库，例如 apache commons HttpClient。

或者，您可以在 URL InputStream 周围包装 JSONTokener 并直接从 JSONTokener 解析 JSONObject（尽管我不完全确定令牌器如何确定正确的字符集，因此使用 HttpClient 之类的东西可能更安全）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T06:50:28.660

```
DefaultHttpClient httpclient = new DefaultHttpClient();
HttpResponse response = (HttpResponse) httpclient.execute(httpPostRequest);//send a request and receive a response
        System.out.println("HTTPResponse received in [" + (System.currentTimeMillis()-t) + "ms]");

        HttpEntity entity = response.getEntity();

        if (entity != null) {
            // Read the content stream
            InputStream instream = entity.getContent();

            // convert content stream to a String
            String resultString= convertStreamToString(instream);
            instream.close();
            resultString = resultString.substring(1,resultString.length()-1); // remove wrapping "[" and "]" 
```

这是功能`convertStreamToString`

```
private static String convertStreamToString(InputStream is) {

        BufferedReader reader = new BufferedReader(new InputStreamReader(is));
        StringBuilder sb = new StringBuilder();

        try {
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        return sb.toString();
    } 
```

# android - 将多线程转换为单线程的优雅方式

> ID：11514413
> 
> 赞同：0
> 
> 时间：2012-07-17T00:13:42.620
> 
> 标签：android, multithreading, thread-safety

1\. 我有主 UI 线程，它使用库函数。

```
MainUI {
    library.funcA(1);
    library.funcB(2,3);
} 
```

我不希望 Main-Thread 等待每次调用结束。同样为每个调用创建新线程是无效的并且不是线程安全的，所以我希望它们在另一个同一个线程上运行。所以我用一个消息队列/处理程序创建了另一个线程。

```
MainUI {
    handler.post(new Message(FUNC_A,[1]));
    handler.post(new Message(FUNC_B,[2,3]));
} 
```

但似乎有开销，我每次都需要创建新的 Message 对象并在 handleMessage() 中再次对其进行解码。此外，处理各种数量的参数打包/解包看起来很难看。我认为将所有函数都设为 Runnable 并将它们发布到处理程序，但函数有不同的参数，我需要创建扩展 Runnable 类的新类！

我目前的计划是将同步关键字插入到库中的每个函数中，以便线程一个接一个地运行，但我不喜欢创建/消失的许多线程，从而使系统变得繁重（也不是线程安全的）。我想听听意见。

2.如果从许多线程（不仅仅是主线程）调用库，将调用转换为在库自己的单线程上运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T19:21:45.393

您可以像这样使用 Runnable：

```
int x = 1;
int y = 2;
//  "a" and "b" are here to show how variable values can be sent to funcB.
//  You could skip this and just have "funcB( 1, 2 )", of course.
final int  a = x;  
final int  b = y;
handler.post( new Runnable()  {
    public void run()  { library.funcB( a, b ); }
} ); 
```

处理程序位有点棘手。它必须运行一个循环线程来运行队列中的每个 Runnable。然后它必须有一种`post`方法来将事物放入队列中。某种形式的阻塞队列将是链接两者的最简单方法，使您不必执行自己的 Object.wait/Object.notify。同步该`post`方法将是防止多个线程相互绊倒的最简单方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:34:06.353

我认为，您当前的方法是使线程安全的可行选择。但是，如果您想将 Runnable 传递给处理程序，则可以考虑重载 Runnable 类。这是伪代码

```
private Class MyRunner extends Runnable{
    public MyRunner(){
    //This is without any argument
    }

    public MyRunner(arg1){
    //This is with 1 argument
    }

    public MyRunner(arg1,arg2){
    //This is with 2 arguments
    }

} 
```

尽管如此，您仍将创建许多 MyRunner 类的实例。

# python - 更改“区域设置首选编码”

> ID：11514414
> 
> 赞同：8
> 
> 时间：2012-07-17T00:13:43.813
> 
> 标签：python, character-encoding, python-3.x, locale

[使用 Python 3.2]

如果我不向 提供`encoding`参数`open`，则使用 . 打开文件`locale.getpreferredencoding()`。因此，例如，在我的 Windows 机器上，任何时候我使用`open('abc.txt')`. 都会使用`cp1252`.

我想将所有输入文件切换到`utf-8`. 显然，我可以添加`encoding = 'utf-8'`到我所有的`open`函数调用中。或者，更好`encoding = MY_PROJECT_DEFAULT_ENCODING`的是，常数是在全局级别的某个地方定义的。

但我想知道是否有一种干净的方法可以`open`通过更改“默认”编码来避免编辑我的所有调用。我可以通过更改语言环境来更改吗？或者通过更改语言环境中的参数？我试图按照 Python 手册进行操作，但无法理解应该如何使用它。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T05:49:05.287

在 Windows 中，使用 Python 3.3+，`chcp 65001`在运行 Python 之前在控制台或批处理文件中执行，以便将语言环境编码更改为 UTF-8。

# django - 使用 Fabric 搜索并运行文件

> ID：11514415
> 
> 赞同：0
> 
> 时间：2012-07-17T00:13:45.203
> 
> 标签：django, search, fabric

我正在一个使用 Django 的网站上工作，我也有 Fabric，这对于编写我和其他开发人员使用的一些代码块非常有用。我对所有这些（以及一般的linux，tbh）都很陌生，所以我有想法，但我不知道它们如何（或是否）它们是可能的。具体来说，我想编写一个脚本来在我们用于测试的特定端口上启动服务器。手动，我会运行

```
python ~/project/manage.py runserver 0.0.0.0:8080 
```

但这会变老。要手动实现该特定命令，我的 fabfile 中有以下代码：

```
def start8080():
    local("python ~/project/manage.py runserver 0.0.0.0:8080") 
```

这可行，但我不是唯一使用该端口进行测试的人，而且 ~/project/ 不是唯一需要使用类似脚本的项目。有没有一种方法可以从您正在使用的目录中搜索第一个 manage.py 的树，然后从那里运行相同的命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T09:06:23.363

Farbic 函数允许您使用参数：

```
@task   #not bad to use once your fabfile is big by using helper functions
def runserver(project_path, port=8000):
    run("python %s/manage.py runserver 0.0.0.0:%s" % (project_path,port)) 
```

你会像这样使用它：

```
fab runserver:/home/project,8080 
```

您还可以通过创建一个为每个项目选择一个端口的任务来简化它，尽管所有可用的项目及其路径都必须在那里定义。那么它可以很简单：

```
fab runserver:myprojectname 
```

当然，您还可以实现@morgan 的答案，使脚本检查端口是否打开并自动分配一个空闲端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T20:23:23.770

您可以使用 socket 模块，如此处所示[，](https://stackoverflow.com/questions/1365265/on-localhost-how-to-pick-a-free-port-number)让操作系统找出您的端口，然后 Fabric 让您知道它选择了哪个。

# html - 如何计算移动浏览器的 div 高度

> ID：11514421
> 
> 赞同：0
> 
> 时间：2012-07-17T00:14:09.167
> 
> 标签：html, mobile, css, mobile-browser

我正在尝试使用 HTML 5 和 CSS3 重新创建页面[http://www.rexonmedia.com/test/sohalo/images/html5_simpletest.png](http://www.rexonmedia.com/test/sohalo/images/html5_simpletest.png)但高度有问题。我用 50px 测量了页脚的高度。在普通浏览器上看起来不错，但在移动浏览器上看起来真的很小。我在这里想念什么。是否有标签或方程式可以在移动浏览器上正确显示？

HTML 测试

```
<link rel="stylesheet" type="text/css" href="style/reset.css" />
<link rel="stylesheet" type="text/css" href="style/styles.css" />

<meta name="description" content="The HTML5 Herald">
<meta name="author" content="SitePoint">
<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>
<body>
<header> </header>
<div id="wrap">
<div id="main"> </div>
</div>
<footer> </footer>
</body>
</html> 
```

CSS

```
@charset "UTF-8";
/* CSS Document */

header{
    width:100%;
    height:50px;
    background-color:#113b44;
}

#wrap {
    min-height: 100%;
}

#main {

}

footer {
    position:fixed;
    bottom:0px;
    width:100%;
    background-color:#231f20;
    height:50px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:50:03.287

也许在 CSS 高度中尝试 pt 而不是 px ？这是 Web 开发中非常常见的问题。一种解决方案是检测用户的屏幕分辨率并包含“移动”样式表。

# c# - 滑动子窗口在 wpf 中不起作用

> ID：11514424
> 
> 赞同：0
> 
> 时间：2012-07-17T00:14:22.010
> 
> 标签：c#, wpf, animation

我使用 translatetransform 来滑动我的子窗口，但我认为我的 xaml 代码有问题。不是窗口在滑动，而是窗口内部在滑动（或网格）。

这是我的子窗口 XAML：

```
<Window x:Class="SAMPLE.ChildWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  WindowStartupLocation="CenterOwner"
  x:Name="HomeWindows"
  Title="HomeWindow" Height="348" Width="440" Loaded="HomeWindows_Loaded">
  <Window.RenderTransform>
    <TranslateTransform />
  </Window.RenderTransform>
  <Window.Resources>
    <Storyboard x:Key="SlaydAndFeyd" >
        <DoubleAnimation Storyboard.TargetName="HomeWindows"  Storyboard.TargetProperty="(Window.RenderTransform).(TranslateTransform.X)" From="50" To="0" Duration="0:0:0.4" />
    </Storyboard>
  </Window.Resources> 
```

然后对于我的功能，调用情节提要：

```
 public void SlaydAndFeyds()
    {
        (FindResource("SlaydAndFeyd") as Storyboard).Begin(this);
    } 
```

现在在主窗口代码中：

```
namespace SAMPLE
{
  public partial class MainWindow : Window
  {

    public MainWindow()
    {
        InitializeComponent();
    }

    private ChildWindow NewChildWindow = new ChildWindow();

    private void btnShowChild_Click(object sender, RoutedEventArgs e)
    {
        NewHomeWindow.Owner = this;
        NewHomeWindow.Show();
    }

    private void btnSlideChild_Click(object sender, RoutedEventArgs e)
    {
       NewHomeWindow.SlaydAndFeyds();
    } 
```

或者有人知道如何滑动我的子窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:43:46.453

该示例中的 RenderTransform 将影响窗口的内容，而不是窗口本身。

要移动窗口，请使用 EventTrigger 调整 Left/Top 属性。我猜你想在 4 秒内将它向左滑动 50 像素左右，调整数字以适应：

```
<Window.Triggers> 
    <EventTrigger RoutedEvent="Window.Loaded"> 
        <BeginStoryboard> 
            <Storyboard> 
                <DoubleAnimation BeginTime="00:00:00"    
                                Storyboard.TargetName="HomeWindows"    
                                Storyboard.TargetProperty="(Window.Left)"    
                                By="-12"    
                                Duration="0:0:4" /> 
            </Storyboard> 
        </BeginStoryboard> 
    </EventTrigger> 
</Window.Triggers> 
```

# php - 上传或复制文件/删除

> ID：11514426
> 
> 赞同：0
> 
> 时间：2012-07-17T00:14:28.253
> 
> 标签：php

我正在使用我的主文件夹中的一个文件 httpdocs 在主文件夹之外的“子域”文件夹上执行此操作（ php ）。

问题是我无法复制文件，删除到该文件夹​​...出现以下错误：

> 警告：opendir() [function.opendir]：open_basedir 限制生效。文件（../ppp）不在允许的路径中：在/第 25 行
> 
> 警告：opendir(../ppp) [function.opendir]：无法打开目录：第 25 行不允许操作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:25:21.623

正如 PHP 警告明确指出的那样，您有一个 PHP 实例配置为将您的文件操作功能限制在唯一允许的目录中。它在您的文件中的`open_basedir`指令中配置。`php.ini`

正如 PHP 文档所述（关于`open_basedir`）：

> 将 PHP 可以打开的文件限制在指定的目录树中，包括文件本身。该指令不受安全模式是打开还是关闭的影响。

解决方案相当简单。打开您的 PHP 配置文件（在大多数 Linux 环境中，它存储在一个`/etc/php(5?)`目录中并称为类似`php.ini`）并搜索`open_basedir`指令。它的格式类似于`PATH`各种操作系统上的环境变量格式。

希望它有所帮助，我想问候 SO 社区。这是我的第一篇文章，所以如果有人在回答这个问题时指出我的错误，我会很高兴。干杯!

# windows - Delphi，Windows：查找网络浏览器是否正在运行的最佳方法？

> ID：11514428
> 
> 赞同：1
> 
> 时间：2012-07-17T00:14:50.070
> 
> 标签：windows, delphi, process

查找网络浏览器是否正在运行的最佳方法是什么？

使用 Delphi XE2 并在 Windows 上，我需要查看以下 Web 浏览器当前是否正在运行：

A) Mozilla Firefox B) Apple Safari C) Google Chrome

如果找到，该过程将终止，因为需要通过修改 Web 浏览器配置文件以编程方式更改 Web 浏览器的主页（如果在 Web 浏览器运行时这样做是不可能的，或者可能导致不可预知的结果）跑步）。

EnumWindows API 函数的输出是否包含处理上述任务所需的足够信息？如果是，那么上述每个网络浏览器的窗口类名称是否记录在任何地方？如果不是，那么哪种方法最可靠？

TIA。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T04:39:59.077

在没有用户许可的情况下终止进程不是好的做法，相反，您必须询问用户是否要终止应用程序（在这种情况下是 Web 浏览器）。

现在回到您的问题，您可以使用该方法检测应用程序（网络浏览器）是否正在运行检查进程名称（firefox.exe、chrome.exe、safari.exe）[`CreateToolhelp32Snapshot`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682489%28v=vs.85%29.aspx)。

```
uses
  Windows,
  tlhelp32,
  SysUtils;

function IsProcessRunning(const ListProcess: Array of string): boolean;
var
  hSnapshot : THandle;
  lppe : TProcessEntry32;
  I : Integer;
begin
  result:=false;
  hSnapshot     := CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
  if hSnapshot <> INVALID_HANDLE_VALUE then
  try
    lppe.dwSize := SizeOf(lppe);
    if Process32First(hSnapshot, lppe) then
      repeat
        for I := Low(ListProcess) to High(ListProcess) do
        if  SameText(lppe.szExeFile, ListProcess[i])  then
          Exit(True);
      until not Process32Next(hSnapshot, lppe);
  finally
    CloseHandle(hSnapshot);
  end;
end; 
```

并像这样使用

```
 IsProcessRunning(['firefox.exe','chrome.exe','safari.exe']) 
```

现在如果你想要一个更可靠的方法你可以搜索窗口的类名（使用[`FindWindowEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633500%28v=vs.85%29.aspx)方法），然后是句柄的进程所有者的PID（使用[`GetWindowThreadProcessId`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633522%28v=vs.85%29.aspx)），从这里你可以使用进程的PID来解析exe的名称。

```
{$APPTYPE CONSOLE}

uses
  Windows,
  tlhelp32,
  SysUtils;

function GetProcessName(const th32ProcessID: DWORD): string;
var
  hSnapshot : THandle;
  lppe : TProcessEntry32;
begin
  result:='';
  hSnapshot     := CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
  if hSnapshot <> INVALID_HANDLE_VALUE then
  try
    lppe.dwSize := SizeOf(lppe);
    if Process32First(hSnapshot, lppe) then
      repeat
        if  lppe.th32ProcessID=th32ProcessID  then
          Exit(lppe.szExeFile);
      until not Process32Next(hSnapshot, lppe);
  finally
    CloseHandle(hSnapshot);
  end;
end;

function IsWebBrowserRunning(const ClassName, ExeName :string) : Boolean;
var
  hWindow : THandle;
  dwProcessId: DWORD;
begin
  result:=False;
  hWindow:= FindWindowEx(0, 0, PChar(ClassName), nil);
  if hWindow<>0 then
  begin
    dwProcessId:=0;
    GetWindowThreadProcessId(hWindow, dwProcessId);
    if dwProcessId>0 then
      exit(Sametext(GetProcessName(dwProcessId),ExeName));
  end;
end;

begin
  try
   if IsWebBrowserRunning('MozillaWindowClass','firefox.exe') then
    Writeln('Firefox is Running');

   if IsWebBrowserRunning('{1C03B488-D53B-4a81-97F8-754559640193}','safari.exe') then
    Writeln('Safari is Running');

   if IsWebBrowserRunning('Chrome_WidgetWin_1','chrome.exe') then
    Writeln('Chrome is Running');
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
  readln;
end. 
```

# .net - .NET 库中的 Google Drive 插入请求

> ID：11514431
> 
> 赞同：2
> 
> 时间：2012-07-17T00:15:17.480
> 
> 标签：.net, google-drive-api

我正在尝试使用来自[https://developers.google.com/drive/v2/reference/files/insert#examples](https://developers.google.com/drive/v2/reference/files/insert#examples)的示例代码。尤其：

```
FilesResource.InsertRequest request = service.Files.Insert(body);
request.Upload(stream, mimeType); 
```

事实证明，该`Upload`方法在 FilesResource.InsertRequest 类中不存在。我正在审查，看起来该类缺少该方法。

也许它没有在已发布的 .NET 库中实现？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:35:24.497

不幸的是，最近对 .NET 客户端库的一些更改影响了这一部分，我将确保相应地更新文档。

该库现在支持可恢复上传机制，但您必须改用 InsertMediaUpload 类：

```
FilesResource.InsertMediaUpload request = service.Files.Insert(body, stream, mimeType);
request.Upload(); 
```

如需完整参考，请查看更新的 DrEdit.NET 示例：

[https://code.google.com/p/google-drive-sdk-samples/source/browse/dotnet/DrEdit/Models/Utils.cs#290](https://code.google.com/p/google-drive-sdk-samples/source/browse/dotnet/DrEdit/Models/Utils.cs#290)

# c# - 使用 jQuery 获取局部变量值

> ID：11514435
> 
> 赞同：0
> 
> 时间：2012-07-17T00:15:42.820
> 
> 标签：c#, jquery, asp.net-mvc-3, razor

尝试使用 jQuery 在视图上获取局部 int 变量的值时，我遇到了一个小问题。所以，我有一个主视图，正如您在下面的代码中看到的那样，当我尝试通过处理部分视图中按钮的单击事件来获取 indexPage 的值时，我使用了一个名为“_Result”的部分视图，如果我用另一个值（例如 5）初始化我的变量，我得到 0，事件。知道为什么吗？

提前致谢

我的观点 ：

```
@model System.Data.DataTable

@{var pageIndex = 5;}

<div>
    <div>
        <span>Téléphone ?</span>
        <input id="idTxTel" type="text" name="txTelephone"/>

        <input id="idBnSearch" type="submit" value="Chercher" name="bnSearch"/>
    </div>

    @Html.Partial("_Result", Model)
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $("#idBnSearch").click(function () {
            //The right value (5)
            alert('@pageIndex');

            var telValue = $("#idTxTel").val();
            var methodUrl = '@Url.Content("~/Search/GetReverseResult/")';

            '@{pageIndex = 0;}'
            doReverseSearch(telValue, '@pageIndex', methodUrl);
        });

        $("#bnNextPage").live("click", function () 
        {
            //Not th right value (0)
            alert('@pageIndex');
        });
    });
</script> 
```

我的 doReverseSearch 方法：

```
function doReverseSearch(telValue, pageIdx, methodUrl) 
    {
        $.ajax(
            {
                url: methodUrl,
                type: 'post',
                data: JSON.stringify({ Telephone: telValue, pageIndex: pageIdx }),
                datatype: 'json',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $('#result').replaceWith(data);
                },
                error: function (request, status, err) {
                    alert(status);
                    alert(err);
                }
            });
    } 
```

我的部分观点：

```
<div id="result">
    <h2>Résultat de la recherche</h2>
    <div>@ViewBag.CountResult entreprises trouvées</div>

    @if(Model != null)
    {
        foreach (DataRow row in Model.Rows)
        {
            <h3>@row["CompanyName"]</h3>
        }
    }

    <hr />
    <div>
        <span>Page N sur M</span>
         <input id="bnPreviousPage" type="submit" value="Précédant" name="bnPrevious"/>
         <input id="bnNextPage" type="submit" value="Suivant" name="bnNext"/>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:19:37.417

javascript 中的 Razor 必须包装在一个块中

所以你可以这样做：

```
<script>
// global value for page
<text>
var myPage = @pageIndex;
<text>
</script> 
```

更容易的是给按钮一个 data-page 的属性并在点击事件中请求属性：

```
<button data-page="@("pageIndex")" id="myButt" />

$("#myButt").on("click",function(e){
  var pageIndex = $(this).attr("data-page");
  alert(pageIndex);
}); 
```

# php - 使用 PHP 和 MySQL 更新数字序列（显示顺序）

> ID：11514436
> 
> 赞同：0
> 
> 时间：2012-07-17T00:15:44.187
> 
> 标签：php, mysql

我的幻灯片项目数据库中有一个 int(11)`DisplayOrder`列，它告诉我的代码显示项目的顺序。管理员可以使用表单更新订单，例如将数字 20 更改为数字 3。无需强制用户手动查找数字 3 并将其与 20 交换，**是否有一种简单的方法来更新数据库中的数字序列？**使用 MySQL，或`array()`在发送查询之前更改项目。

我找了又找，似乎没有很多可靠的答案。问题是我目前有 400 行，而且这个数字还会增长。我真的不想每次订单更改时都进行 400 次更新。**有没有更好的办法？**有现成的脚本吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:23:40.933

为什么需要对`DisplayOrder`值进行完全重新排序？

如果`ORDER BY`存在重复值，则子句也可以正常工作。为了保持稳定的排序，您可以按项目名称或 ID 等辅助列进行排序。

# javascript - 将所有带有供应商前缀的变体分配给样式

> ID：11514437
> 
> 赞同：1
> 
> 时间：2012-07-17T00:15:54.303
> 
> 标签：javascript, css, stylesheet

Modernizr 提供了一种`testAllProps()`方法，可以方便地测试给定样式的所有供应商前缀样式，以查看当前运行的浏览器是否支持该样式。

但是，我还没有到需要从 javascript 实际分配这些属性的地步，因为各种原因归结为它太麻烦而无法有条件地链接 CSS 文件。

因此，例如，我可以构建一个数组和一个例程，将每个供应商特定的样式分配给我的目标元素的样式：

```
['mozTransitionDuration', 'webkitTransitionDuration', 'oTransitionDuration', 'msTransitionDuration', 'transitionDuration'].map(function(s){ element.style.s = "style_setting"; }); 
```

好吧，这可能会产生一堆错误，因为我会尝试将“style_setting”分配给 4 或 5 个未定义的值。

有没有人知道什么可以减轻这种痛苦？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:23:30.483

最好使用一个了解这些东西的现有库：

[Prefix Free](http://leaverou.github.com/prefixfree/)将允许您从 CSS 分配样式而无需供应商前缀。还有一个 [jQuery Plugin](https://raw.github.com/LeaVerou/prefixfree/gh-pages/plugins/prefixfree.jquery.js)可以让你从 JavaScript 做同样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:25:30.543

在设置值之前，请检查属性是否为`undefined`：

```
['mozTransitionDuration', 'webkitTransitionDuration', 'oTransitionDuration', 'msTransitionDuration', 'transitionDuration']
    .map(function(s) {
        if (element.style[s] != undefined) element.style[s] = "style_setting";
    }); 
```

# iphone - 如何使用完成按钮退出 UITextView

> ID：11514443
> 
> 赞同：4
> 
> 时间：2012-07-17T00:18:19.207
> 
> 标签：iphone, objective-c, xcode, uitextview, resignfirstresponder

我想知道你们中是否有人知道如何访问编辑时出现在键盘上方的完成按钮。

我以前见过，键盘上方有一个透明的黑色区域，右侧有一个蓝色的“完成”按钮。

我可以在我的应用程序中使用自己的动画和键盘上方的按钮手动完成此操作，以退出 UITextView，但我更喜欢使用人们知道的 Apple GUI 元素。

那么有人知道这个“完成”按钮的来源吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:33:34.343

您并没有真正“访问”该按钮，但通过 UITextViewDelegate 协议，您基本上可以：

[http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html)

实施

```
- (void)textViewDidEndEditing:(UITextView *)textView 
```

例程，并将持有 textview 的 UIViewController 分配给 textview 的委托。

在该例程中，您可以做自己想做的事！您需要致电

```
resignFirstResponder 
```

方法。

[http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/instm/UIResponder/resignFirstResponder](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/instm/UIResponder/resignFirstResponder)

您将必须实现实现该蓝色完成按钮的键盘样式。

[http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextInputTraits_Protocol/Reference/UITextInputTraits.html#//apple_ref/occ/intf/UITextInputTraits](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextInputTraits_Protocol/Reference/UITextInputTraits.html#//apple_ref/occ/intf/UITextInputTraits)

**最终答案**

```
- (void)textViewDidEndEditing:(UITextView *)textView{
    [textView resignFirstResponder];
} 
```

# ios - Dispatch_queue 问题

> ID：11514447
> 
> 赞同：0
> 
> 时间：2012-07-17T00:18:47.703
> 
> 标签：ios, multithreading, ios5, grand-central-dispatch

我是新手`dispatch_queue_t`，我的应用程序有两个问题，我认为可以使用 GCD 解决。第一个是在主视图（ViewController）中我有一个由另一个类（AudioViewController）实现的标签，当我在ViewController中进行任何用户交互时，标签停止实现，所以我想如果我使用`dispatch_queue_t`这个问题会得到解决。

第二件事是，在同一个主视图（ViewController）中，当我按下贡献时，我调用了另一个类（ContributionViewController），而这个类只访问另一个类（AudioViewController）的实例变量，该变量一直在刷新。当我开始贡献时，我创建了一个循环来获得多个值来用它们进行一些微积分，但这些值都是相同的。

我会在这里放一些代码来清除这些东西。

`ViewController.m`

```
- (IBAction)makeContribution:(id)sender
{
  NSLog(@"A: Contribution button clicked");
  NSLog(@"-= START CONTRIBUTION =-");
  cvc = [[ContributionViewController alloc] init];
  cvc.avc = self.avc;

  // Get NUM_CONTRIBUTIONS contributions to make average.
  int contContribution;
  for (contContribution = 0; contContribution < NUM_CONTRIBUTIONS; contContribution++) {
        [cvc getEachContribution];
  }

  // Make average
  [cvc makeAverage:NUM_CONTRIBUTIONS];

  [cvc release];
} 
```

`AudioViewController.m`

```
- (void)audioInitializationWithTimeInterval:(float)time
{
   NSDictionary* recorderSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                  [NSNumber numberWithInt:kAudioFormatLinearPCM],AVFormatIDKey,
                                  [NSNumber numberWithInt:44100],AVSampleRateKey,
                                  [NSNumber numberWithInt:1],AVNumberOfChannelsKey,
                                  [NSNumber numberWithInt:16],AVLinearPCMBitDepthKey,
                                  [NSNumber numberWithBool:NO],AVLinearPCMIsBigEndianKey,
                                  [NSNumber numberWithBool:NO],AVLinearPCMIsFloatKey,
                                  nil];
   NSError* error;

   NSURL *url = [NSURL fileURLWithPath:@"/dev/null"];
   recorder = [[AVAudioRecorder alloc] initWithURL:url settings:recorderSettings error:&error];

   //enable measuring
   //tell the recorder to start recording:
   [recorder record];

   if (recorder) {
      [recorder prepareToRecord];
      recorder.meteringEnabled = YES;
      [recorder record];

      levelTimer = [NSTimer scheduledTimerWithTimeInterval:time target:self selector:@selector(levelTimerCallback:) userInfo:nil repeats:YES];
   }
   else
      NSLog(@"%@",[error description]);
}

- (void)levelTimerCallback:(NSTimer *)timer
{

   //NSLog(@"-= AVC =-");
   [recorder updateMeters];

   db = [recorder averagePowerForChannel:0] - DBOFFSET;
   db += 120;
   db = db < 0 ? 0 : db;

   vc.lab_decibel.text = [NSString stringWithFormat:@"%0.0f", db];
} 
```

`ContributionViewController.m`

```
- (void)getEachContribution
{
  actualContribution = self.avc.db;
  NSLog(@"Actual contribution: %f", actualContribution);
  NSLog(@"Sum before: %0.2f", sumContribution);
  sumContribution += actualContribution;
  NSLog(@"Sum After: %0.2f", sumContribution);
}

- (void)makeAverage:(int)numOfContributions
{
  self.average = self.sumContribution / numOfContributions;
  NSLog(@"Average: %0.2f", self.average);
} 
```

所以，主要`dispatch_queue_t`是要解决我的问题以及如何做到这一点？我试过`dispatch_queue_t`装上 AudioViewController、ContributionViewController 和 ViewController，但是第一个没有更新标签，第二个崩溃了，第三个标签仍然是 0 值。

感谢您提供解决此问题的任何提示。

编辑 01： ![带有 mapView、分贝标签和贡献按钮的 ViewController](../Images/1bfc6cb9326cabba03518738db1c6d42.png)

分贝标签一直在变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:53:23.350

好的，这开始有意义了。不懂mapView、contribution等语言。这完全是神秘的，但我想我开始理解你的问题了。据我了解，您的问题是为什么您的用户界面没有更新。好的，您的问题的重要答案是，如果您不想，则不需要 GCD。`NSTimer`做你需要的。

现在，您说您不断更新的数据库字段不再更新。绝对没有理由不继续。我试过了，效果很好。那里有事。就个人而言，当我有一个正在更新我的 UI 的 NSTimer 时，我确保将其关闭`viewDidDisappear`（如果它不可见，则无需更新您的 UI）并始终将其打开`viewDidAppear`。当我这样做时，每当我返回带有数据库编号的主视图时，它就会愉快地恢复。或者，如果我想要另一个视图控制器来获取通知，我只需使用委托将其重新打开。

这可能如下所示。

首先，您可能需要一个委托协议：

```
//  DecibelNotifierDelegate.h

#import <Foundation/Foundation.h>

@protocol DecibelNotifierDelegate <NSObject>

@required

- (void)decibelNotifierUpdate:(CGFloat)db;

@end 
```

然后，你想定义你的 DecibelNotifier 类：

```
//  DecibelNotifier.h

#import <Foundation/Foundation.h>
#import "DecibelNotifierDelegate.h"

@interface DecibelNotifier : NSObject

@property (nonatomic, retain) id<DecibelNotifierDelegate> delegate;
@property CGFloat db;

- (void)startWithInterval:(float)time target:(id<DecibelNotifierDelegate>)delegate;
- (void)stop;

@end 
```

和

```
//  DecibelNotifier.m

#import "DecibelNotifier.h"
#import "AVFoundation/AVFoundation.h"

@interface DecibelNotifier ()
{
    AVAudioRecorder *_recorder;
    NSTimer *_levelTimer;
}
@end

// note, your code makes reference to DBOFFSET and I don't know what that is. Update this following line accordingly.

#define DBOFFSET 0

@implementation DecibelNotifier

@synthesize delegate = _delegate;
@synthesize db = _db;

- (id)init
{
    self = [super init];
    if (self)
    {
        NSDictionary* recorderSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                          [NSNumber numberWithInt:kAudioFormatLinearPCM],AVFormatIDKey,
                                          [NSNumber numberWithInt:44100],AVSampleRateKey,
                                          [NSNumber numberWithInt:1],AVNumberOfChannelsKey,
                                          [NSNumber numberWithInt:16],AVLinearPCMBitDepthKey,
                                          [NSNumber numberWithBool:NO],AVLinearPCMIsBigEndianKey,
                                          [NSNumber numberWithBool:NO],AVLinearPCMIsFloatKey,
                                          nil];
        NSError* error;

        NSURL *url = [NSURL fileURLWithPath:@"/dev/null"];
        _recorder = [[AVAudioRecorder alloc] initWithURL:url settings:recorderSettings error:&error];

        if (!_recorder)
            NSLog(@"%@",[error description]);
    }

    return self;
}

- (void)startWithInterval:(float)time target:(id<DecibelNotifierDelegate>)delegate
{
    if (_recorder) 
    {
        self.delegate = delegate;

        [_recorder prepareToRecord];
        _recorder.meteringEnabled = YES;
        [_recorder record];

        _levelTimer = [NSTimer scheduledTimerWithTimeInterval:time target:self selector:@selector(levelTimerCallback:) userInfo:nil repeats:YES];
    }
}

- (void)stop
{
    [_recorder stop];

    [_levelTimer invalidate];
    _levelTimer = nil;

    self.delegate = nil;
}

- (void)levelTimerCallback:(NSTimer *)timer
{
    [_recorder updateMeters];

    CGFloat db = [_recorder averagePowerForChannel:0] - DBOFFSET;
    db += 120;
    db = db < 0 ? 0 : db;

    _db = db;

    [self.delegate decibelNotifierUpdate:db];
}

@end 
```

所以，第一个想要通知的视图控制器可能有一个属性：

```
@property (strong, nonatomic) DecibelNotifier *dBNotifier; 
```

您可以使用以下方法对其进行初始化：

```
self.dBNotifier = [[DecibelNotifier alloc] init]; 
```

然后，您可以通过以下方式打开通知：

```
[self.dBNotifier startWithInterval:0.25 target:self]; 
```

所以问题是您何时打开和关闭这些通知。我在`viewWillAppear`和中做`viewWillDisappear`。您还可以将 dbNotifier 传递给其他视图控制器，它们也可以获得通知。

就像我说的，我试过了，它工作正常，任何想要获取通知的视图控制器都可以打开它并将自己指定为委托，然后你就可以参加比赛了。

# c# - 给定起点、中间和终点绘制 3D 圆弧

> ID：11514450
> 
> 赞同：0
> 
> 时间：2012-07-17T00:19:28.653
> 
> 标签：c#, wpf

我正在尝试使用 Helix 3D 工具包制作用户定义的弧线。用户选择圆弧上的 3 个点（起点、中间、终点），程序找到圆心并从起点到终点绘制圆弧。我的问题是我不擅长数学，而且我在完成这项工作时遇到了问题。我的主要问题是获取开始和结束角度并让它准确地绘制各种尺寸的弧线。任何帮助表示赞赏。这是我的代码：

```
private void Draw_Arc(object sender, MouseButtonEventArgs e)
    {
            linept = new List<Point3D>();
            linept.Add(startPoint);
            linept.Add(endPoint);
            linept.Add((Point3D)GetPoints(e));
            LinesVisual3D line = new LinesVisual3D();
            line.Thickness = 2;
            line.Color = Colors.Blue;
            line.Points = linept;
            port.Children.Add(line);

            double startAngle, sweepAngle;
            Point3D center = GetCenterOfArc(linept.ElementAt(0), linept.ElementAt(1), linept.ElementAt(2));
            GetAngles(linept.ElementAt(0), linept.ElementAt(1), linept.ElementAt(2), out startAngle, out sweepAngle);
            circle = new PieSliceVisual3D();
            double RadiusX = Math.Abs(startPoint.X - center.X);
            double RadiusY = Math.Abs(startPoint.Y - center.Y);
            circle.Center = center;
            if (RadiusX >= RadiusY)
                circle.OuterRadius = RadiusX;
            else
                circle.OuterRadius = RadiusY;
            circle.InnerRadius = circle.OuterRadius + 3;
            circle.StartAngle = (180 / Math.PI * Math.Atan2(startPoint.Y - circle.Center.Y, startPoint.X - circle.Center.X));
            circle.EndAngle = (180 / Math.PI * Math.Atan2(linept.ElementAt(2).Y - circle.Center.Y, linept.ElementAt(2).X - circle.Center.X));
            port.Children.Add(circle);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:51:55.517

我认为你必须知道圆心才能知道圆弧的起始和结束角度。

假设你只有三个点，并且你想找到一个穿过所有三个点的圆，你基本上有三个带有三个变量的方程：

> (x-x0)^2 + (y-y0)^2 = R^2
> 
> (x-x1)^2 + (y-y1)^2 = R^2
> 
> (x-x2)^2 + (y-y2)^2 = R^2

如果您尝试自己编程并且具有平均数学知识，则解决该问题可能会有些棘手，但是您可以使用矩阵相当容易地做到这一点。[在这里](http://www.codeproject.com/Articles/277547/Solve-Linear-and-Polynomial-Equations)阅读一些信息。

解完这三个方程后，你应该有 X、Y、R。

X 和 Y 将是圆的中心点，R - 它的半径。

现在，据我记得，他们从正 X 轴开始计算弧度，向上。所以你需要计算两条线之间的角度——从中心到浮点的线，以及从中心点到“无限”右边的线。您可能只是谷歌“计算两条线之间的角度”。为您的起点和终点重复该过程，将为每个人提供各自的进入/退出角度。

中间点实际上不再使用，但半径是。您只需将其设置为半径即可。

我还没有真正实现任何东西 - 只是给你一个公平的方向。（我敢打赌，有一个更清洁、更易于使用的解决方案）

# microcontroller - Z80 标志 - 如何生成？

> ID：11514456
> 
> 赞同：0
> 
> 时间：2012-07-17T00:19:57.947
> 
> 标签：microcontroller, flags, opcode, z80, alu

我正在设计一个[Z80](https://en.wikipedia.org/wiki/Zilog_Z80)兼容项目。我负责设计标志寄存器。

我最初认为标志是直接从 ALU 生成的，具体取决于 ALU 操作的输入和类型。

但是在查看指令和标志结果之后，标志似乎并不总是与这个逻辑一致。

因此，我假设我还必须向 ALU 提供操作码，以便每次都生成正确的标志。但这似乎会使设计过于复杂。在进行这个巨大的设计步骤之前，我想在互联网上进行检查。

我对么？或者只是真的很困惑，它和我最初想的一样简单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:12:31.213

当然，操作的类型很重要。做加法和减法时考虑溢出。比如说，您正在添加或减去 8 位字节：

1+5=6 - 没有溢出

255+7=6 - 溢出

1-5=252 - 溢出

200-100=100 - 没有溢出

200+100=44 - 溢出

100-56=44 - 没有溢出

显然，此处进位标志的状态不仅取决于输入字节或结果字节值，还取决于操作。它表示无符号溢出。

逻辑非常一致。如果不是，是时候阅读文档来学习官方逻辑了。

您可能对[这个问题](https://stackoverflow.com/q/8034566/968261)感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T08:50:22.787

您的代码是为 CP/M 操作系统编写的。I/O 是通过 BDOS（基本光盘操作系统）接口完成的。基本上，您在 C 寄存器中加载操作代码，在其他寄存器中加载任何附加参数，然后调用位置 0x5。功能代码 C=2 是将 E 寄存器中的一个字符写入控制台（=屏幕）。您可以在第 1200 行看到这一点：

```
 ld  e,a
    ld  c,2
    call    bdos
    pop hl
    pop de
    pop bc
    pop af
    ret
 bdos   push    af
    push    bc
    push    de
    push    hl
    call    5
    pop hl
    pop de
    pop bc
    pop af
    ret 
```

有关 BDOS 调用的参考，请[在此处](http://www.seasip.demon.co.uk/Cpm/bdos.html)尝试。要模拟这一点，您需要捕获对地址 5 的调用，并使用您可用的任何工具来实现它们。

# scala - 我们如何在 Maven 中升级 Lift 版本？

> ID：11514457
> 
> 赞同：1
> 
> 时间：2012-07-17T00:20:11.497
> 
> 标签：scala, maven, upgrade, lift

我想升级电梯版本以绕过电梯错误。但是，我找不到在 Maven 中更改版本号的地方。在这里吗？

```
<properties>
        <scala.version>2.7.7</scala.version>
        <!-- Common plugin settings -->
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>${project.build.sourceEncoding}</project.reporting.outputEncoding>
        <!-- vscaladoc settings -->
        <maven.scaladoc.vscaladocVersion>1.2-m1</maven.scaladoc.vscaladocVersion>
        <vscaladoc.links.liftweb.pathsufix>scaladocs/</vscaladoc.links.liftweb.pathsufix>
        <vscaladoc.links.liftweb.baseurl>http://scala-tools.org/mvnsites/liftweb</vscaladoc.links.liftweb.baseurl>
</properties> 
```

如果是这样，我应该调整什么参数来做到这一点？如果没有，如何在 Maven 中升级电梯？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:29:25.567

你应该有一个像这样的孩子`<dependencies>`的姐妹元素：`<properties>`

```
<dependency>
  <groupId>net.liftweb</groupId>
  <artifactId>lift-mapper_${scala.version}</artifactId>
  <version>2.1</version>
</dependency> 
```

只需根据需要更改版本（注意 2.2 是支持 Scala 2.7 的最新版本），或者`<liftweb.version>2.2</liftweb.version>`在您的属性中添加一行并在此处引用它：

```
<dependency>
  <groupId>net.liftweb</groupId>
  <artifactId>lift-mapper_${scala.version}</artifactId>
  <version>${liftweb.version}</version>
</dependency> 
```

请注意，可能存在多个`net.liftweb`依赖项，并且它们都需要更改。使用属性方法使这个过程更容易，更不容易出错。

# javascript - 在页面之间传递数据html5

> ID：11514459
> 
> 赞同：0
> 
> 时间：2012-07-17T00:20:21.193
> 
> 标签：javascript, php, ajax, html

我目前正在将一个移动网站升级到 Html5/php，之前我有很多不同的 php 页面，但现在我使用的是单个 html5/php 页面。

在旧网站上，我会通过 url 传递变量并使用它`$_GET`来检索它们，尽管我正在努力在 html5 中找到一个简单的替代方案。

我也在我的新站点中使用 Jquery mobile，虽然我不熟悉它。

我的 html 示例如下。

```
<div data-role="page" data-title="Page One" id="home">
         <div data-position="fixed" data-role="header">
         <h1>Pageone</h1>
    </div>

  <div data-role="content" data-theme="a">
    <ul class="menu">
        <li class="icn_browse"><a href="#browse?wtd=10">Browse</a><span></span></li>

           </ul>
        </div>
    </div>

  <div data-role="page" data-title="Page two" id="browse">
         <div data-position="fixed" data-role="header">
         <h1>Pagetwo</h1>
    </div>

  <div data-role="content" data-theme="a">

<!-- need to access the data from the home page here, more specifically the content of $_GET['wtd'] -->

        </div>
    </div> 
```

所以我需要将数据从#home 传递到#browse，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:45:34.967

丑陋但确实可行的解决方案包括构建一个小的 PHP 生成的 JavaScript 片段来处理此任务：

请将其放在您希望在脚本运行时可用的内容**之后**（在大多数情况下，它将是文件的结尾。另一种解决方案涉及使用 $(document).ready(function() { //.. 。 }）） 堵塞：

```
// Assuming your $_GET['wtd'] contains only an ID to fetch, without '#':
var p = "<?php echo $_GET['wtd']; ?>";
$("#"+p).prepend($("[data-role='content']"); 
```

尽管我不鼓励以这种方式使用 JavaScript。它违反了[不引人注目的 JS](http://www.google.pl/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CF0QFjAA&url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FUnobtrusive_JavaScript&ei=CrQEUP7cDMndtAb29pzuBg&usg=AFQjCNGxehhYSyKqiy7wQ7VMmgs9Op6JxQ&sig2=zFJ8NQ4TDQZ1rqgVKE0mSg)的规则。基本上，这个解决方案完全依赖于 JavaScript，因此它不能在禁用 JavaScript 的环境（如大多数 Intranet）中工作。

可能更好的解决方案，不使用 JavaScript，但只有 PHP 是在 SGML 解析器中解析整个站点并将文档的某些节点移动到正确的位置，然后再次序列化文档。也许您会失去文档的可读性，但它肯定会起作用。它比使用 jQuery 的解决方案复杂得多，但如果您有兴趣，我建议您阅读 PHP 标准库中提供的手册 od DOMDocument 类：http: [//nl.php.net/manual/en/class.domdocument。 .php](http://nl.php.net/manual/en/class.domdocument.php) _

# core-data - 映射模型为 NULL - 核心数据迁移

> ID：11514460
> 
> 赞同：3
> 
> 时间：2012-07-17T00:20:35.090
> 
> 标签：core-data, xcode4.3, ios5.1, core-data-migration

我按照这个不错的教程 [http://mipostel.com/index.php/home/70-core-data-migration-standard-migration-part-2](http://mipostel.com/index.php/home/70-core-data-migration-standard-migration-part-2)进行核心数据迁移。

出于某种奇怪的原因，我总是在这些行中的 mappingModel 中得到 NULL：

```
 NSMappingModel *mappingModel = [NSMappingModel mappingModelFromBundles:nil
                                                                forSourceModel:sourceModel
                                                              destinationModel:destinationModel]; 
```

（链接代码中的第 191 行）

我尝试创建一个非常简单的模型派生版本，我重新创建了一个 mappingModel 1000 次，确保映射模型文件位于项目目录中 - 但此调用始终返回 NULL。

有人知道这里有什么问题吗？

ps 我只是想知道在使用映射模型之后调用设置迁移选项。

```
 NSURL *storeUrl = [NSURL fileURLWithPath:storePath];   
    NSError *error;   
    NSDictionary *pscOptions = [NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                                [NSNumber numberWithBool:NO], NSInferMappingModelAutomaticallyOption,
                                nil];

    if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                                  configuration:nil
                                                            URL:storeUrl
                                                        options:pscOptions
                                                          error:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    } 
```

（第 123 行...）

**反正**

**为什么找不到映射模型？**

pss 忍不住 :-) 与进行简单的 SQL DB 迁移相比，这个核心数据迁移的东西过于复杂和困难——浪费了太多时间。

提前非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T13:38:41.077

我遵循了相同的教程，最终不得不通过 URL 手动打开我的映射模型

```
 NSString *mappingModelPath = [[NSBundle mainBundle] pathForResource:@"mappingModel10" ofType:@"cdm"];
    NSLog(@"mapping model path:%@", mappingModelPath);
    NSURL *mappingModelUrl = [NSURL fileURLWithPath:mappingModelPath];
    NSMappingModel *mappingModel = [[NSMappingModel alloc] initWithContentsOfURL:mappingModelUrl]; 
```

我通过查看我的应用程序包找到了我的映射模型的文件名。

# python - 尝试/除了在编译的 Python 中不捕获错误

> ID：11514465
> 
> 赞同：0
> 
> 时间：2012-07-17T00:22:07.470
> 
> 标签：python, exception-handling, compilation, try-catch, except

我有一些涉及 Try 和 except 子句的代码。当我只是在 IDLE 的控制台中运行它时，它可以完美运行，并且永远不会崩溃。但是，当我编译时它无法捕获错误，所以程序崩溃了，这让我发疯！

代码是：

```
if self.height == 6:
    try:
        libtcod.path_compute(minimap[self.mapx][self.mapy].path3,self.x+60, self.y+60,target_x+60, target_y+60)
        stepx, stepy = libtcod.path_get(minimap[self.mapx][self.mapy].path3, 0)
        dx = stepx - self.x - 60
        dy = stepy - self.y - 60
    except:
        success = False 
```

我正在使用 libtcod 库。它有时会在 stepx/stepy 位上失败，问题是，我*知道*它有时会在那个位上失败；它只是没有抓住它！我试过让它在 stepx 部分之前/之后打印一条消息，它会打印第一部分，但不是后者。有很多选项可以导致success = False，而且只有一个，然后我会处理如果success == False 会发生什么（这是一个游戏，测试敌人是否可以找到你，如果没有，然后它尝试别的东西）。我不知道为什么它在未编译时可以捕获它，但在编译时完全失败。有人可以向我解释一下吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:41:47.857

尝试检查您传递给导致程序崩溃的 libtcod 函数的所有参数（在这种情况下`libtcod.path_get`）。当您传递不正确的参数而不是引发一个很好的错误消息时，Libtcod 经常会出现段错误，我在视野工具包中遇到了同样的问题。

如果由于某种原因这些值在您使用 py2exe “编译”的版本中不同，那么这可以解释为什么它有时只会崩溃。

这部分看起来有问题：

```
minimap[self.mapx][self.mapy] 
```

如果你有一个像这样的嵌套数组：

```
minimap = [[1, 2, 3, 4],
           [5, 6, 7, 8],
           [9, 10, 11, 12]] 
```

然后要引用位置 (x, y) 的项目，您必须使用`minimap[y][x]`

编辑：

`libtcod.path_get`的第一个参数应该是用于寻路的地图，由`path_new_using_map`or返回`dijkstra_new`。您不需要为地图中的每个方格使用单独的地图。我认为您应该更彻底地阅读文档：http: [//doryen.eptalys.net/data/libtcod/doc/1.5.0/index.html](http://doryen.eptalys.net/data/libtcod/doc/1.5.0/index.html)

# ember.js - 无法让 Ember.js 从控制器中的对象呈现属性

> ID：11514469
> 
> 赞同：1
> 
> 时间：2012-07-17T00:22:34.867
> 
> 标签：ember.js, javascript-framework

总菜鸟问题在这里。我为简单而道歉，我在这里浏览了数百个带有 Ember 标记的帖子以寻找答案。但这似乎太原始了，任何人都懒得问……

我从头开始使用 Ember。我做了 Andy Matthews 的 EmberTweets 教程，效果很好。我正在尝试将其用作我的第一个 Ember 应用程序的基础，这非常简单；但我坚持最基本的步骤。我似乎有一个正常工作的控制器，并且似乎成功地向它添加了新对象。但我终其一生都无法得到我的观点来渲染这些对象的属性。基本视图呈现出来，但不是来自控制器的数据，我只是想用一个简单的`#each`. 我在任何浏览器控制台中都*没有错误。*

小提琴在[这里](http://jsfiddle.net/xmlilley/ksjZp/5/)。

在我的示例中，我尝试以三种不同的方式将对象添加到控制器，看看是否有帮助。我可以通过检查内容数组或使用类似 FilterMenus.MenusController.content.objectAt(2).get('menu_name') 的方式从控制台成功访问对象的属性。显然，数据是正确的。

但是当我尝试渲染任何属性时，我的模板中仍然没有出现任何内容，例如：`{{menu_name}}`. 请问我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T04:34:26.673

如其他答案所述，您必须将您的应用程序声明为全局变量（通过省略`var`）。

除此之外，你没有`this._super()`在你`FilterMenus.menusController`的`init`方法内部调用。这是`Ember.ArrayController`正确设置所必需的，因此修改`content`将起作用。

除了这两个问题，您的代码看起来还不错。这是一个工作小提琴：http: [//jsfiddle.net/pangratz666/HPkHt/](http://jsfiddle.net/pangratz666/HPkHt/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T02:07:44.607

似乎 Ember 对您的代码的最大问题是您的代码`Application`被定义为，`var`因此无法从模板访问它。删除`var`关键字有帮助。

但出于某种原因，这还不够，我不得不添加一个

```
this.set('content', []); 
```

作为你的 init 函数的第一行让它工作。我以前从来没有这样做过，所以我不确定 jsFiddle 是否在做某事。如果有人对此有所了解，我很想听听。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T03:14:14.740

尝试以下操作：

1.  从 FilterMenus 声明中删除“var”：

    ```
    FilterMenus = Em.Application.create(); 
    ```

2.  将实现更改`menusController.addMenu`为：

    ```
    addMenu: function(menu) {
        this.content.push(menu);
    }, 
    ```

这让我在“选择国家”和解释性段落之后出现了两个菜单名称：

```
countries
countries2 
```

Ember 似乎不知道是什么`this.pushObject(menu);`。不过，直接推送到控制器的内容数组将始终有效。

# sql - SQL Server如何将id列表从sproc传递给函数

> ID：11514473
> 
> 赞同：0
> 
> 时间：2012-07-17T00:22:56.707
> 
> 标签：sql, database, stored-procedures, sql-function

与我在互联网上发现的大多数情况不同，当人们需要将 id 列表从 c# 之类的应用程序传递给 sproc 然后拆分 id 以便它们可以在 WHERE 子句中使用时，例如 WHERE IN (4,5, 6,7,7,8)

我需要从传递 id 列表的 sql 存储过程调用 sql 函数。我需要知道做到这一点的最佳方法，如果可能的话，最好不要引入 .Split 函数。

我需要向函数添加一个约束，以便它不会构建所有 Horizo​​ntals 的结果集。

--这是共享sql函数

```
ALTER FUNCTION [Storefront].[ufn_GetHorizontals] 
(
)
RETURNS TABLE 
AS
RETURN 
(
    SELECT myColumList.* 'omitted'

FROM   Storefront.Horizontal h          with(nolock)                           JOIN
        Catelog.Part pt                 with(nolock)ON h.PartID = pt.ID        JOIN
        Catelog.Brand bd                with(nolock)ON pt.BrandID = bd.ID      JOIN
        Storefront.Size sz              with(nolock)ON sz.ID = h.SizeID        JOIN
        Storefront.Daylite dl           with(nolock)ON sz.ID = dl.SizeID       JOIN
        Storefront.Siteline sl          with(nolock)ON sl.ID = h.SitelineID    JOIN
        Storefront.Finish f             with(nolock)ON f.ID = h.FinishID      LEFT JOIN
        Storefront.HorizontalGlass hg   with(nolock)ON hg.HorizontalID = h.ID LEFT JOIN
        Catelog.Glass g                 with(nolock)ON hg.GlassID = g.ID
) 
```

--这里有几个例子显示了我不想处理这个问题的方式，因为它显然是错误的。

-示例 1 选择 *

FROM Storefront.Leaf l with(nolock) JOIN Storefront.LeafHorizo​​ntal lh with(nolock)ON l.ID = lh.LeafID JOIN Storefront.ufn_GetHorizo​​ntals() h ON lh.Horizo​​ntalID = h.ID

其中 l.ID = @LeafID;

*   示例 2

    ALTER proc [Storefront].[proc_GetBayHorizo​​ntals] @BayID INT AS BEGIN SET NOCOUNT ON;

    ```
     SELECT  *

        FROM   Storefront.Bay b           with(nolock)           JOIN
                Storefront.BayHorizontal bh   with(nolock)ON b.ID = bh.BayID JOIN
                Storefront.ufn_GetHorizontals() h ON bh.HorizontalID = h.ID 
    ```

    其中 b.ID = @BayID;

* * *

我需要一些类似的东西。

```
 ALTER FUNCTION [Storefront].[ufn_GetHorizontals] 
    (
      @MyListOfIdsFromTheStoredProcedure SOMEDATATYPE;
    )
    RETURNS TABLE 
    AS
    RETURN 
    (
        SELECT myColumList.* 'omitted'

    FROM   Storefront.Horizontal h          with(nolock)                           JOIN
            Catelog.Part pt                 with(nolock)ON h.PartID = pt.ID        JOIN
            Catelog.Brand bd                with(nolock)ON pt.BrandID = bd.ID      JOIN
            Storefront.Size sz              with(nolock)ON sz.ID = h.SizeID        JOIN
            Storefront.Daylite dl           with(nolock)ON sz.ID = dl.SizeID       JOIN
            Storefront.Siteline sl          with(nolock)ON sl.ID = h.SitelineID    JOIN
            Storefront.Finish f             with(nolock)ON f.ID = h.FinishID      LEFT JOIN
            Storefront.HorizontalGlass hg   with(nolock)ON hg.HorizontalID = h.ID LEFT JOIN
            Catelog.Glass g                 with(nolock)ON hg.GlassID = g.ID

  **********--->  WHERE h.ID IN(@MyListOfIdsFromTheStoredProcedure )

  ) 
```

****** ***** --> 存储过程更改为这样的方式。**

 **```
 SELECT  *
              FROM
       Storefront.ufn_GetHorizontals(SELECT HorizontalID FROM Storefront.BayHorizontal bh
                                         WHERE bh.BayID = @BayID) 
```

提前谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:42:25.033

内联函数`GetBayIDs()`采用单个整数并创建 ID 的 XML 文档，该文档被传递到您的函数中，随后传递给`Split()`函数以过滤函数中的数据集。没有 很难测试`Storefront.BayHorizontal`，但我认为这非常接近......

```
create function dbo.GetBayIDs(@BayID int) returns xml
as
begin
  declare @xml varchar(max), @i int

  set @xml = '<root>'

  declare cr cursor local for
    SELECT HorizontalID
    FROM   Storefront.BayHorizontal bh
    WHERE  bh.BayID = @BayID

  open cr
  fetch next from cr into @i

  while @@fetch_status = 0
  begin
    set @xml = @xml + '<r>' + cast(@i as varchar(10)) + '</r>'
    fetch next from cr into @i
  end

  close cr
  deallocate cr

  set @xml = @xml + '</root>'

  return @xml
end
go

create function dbo.Split(@ids xml) returns @rtn table (id varchar(10))
as
begin
  insert into @rtn
  select r.value('.', 'varchar(10)') as [id]
  from @ids.nodes('//root/r') as records(r)

  return
end
go

ALTER FUNCTION [Storefront].[ufn_GetHorizontals] 
    (
      @idlist xml
    )
    RETURNS TABLE 
    AS
    RETURN 
    (
        SELECT myColumList.* 'omitted'
    FROM   Storefront.Horizontal h          with(nolock)                           JOIN
            Catelog.Part pt                 with(nolock)ON h.PartID = pt.ID        JOIN
            Catelog.Brand bd                with(nolock)ON pt.BrandID = bd.ID      JOIN
            Storefront.Size sz              with(nolock)ON sz.ID = h.SizeID        JOIN
            Storefront.Daylite dl           with(nolock)ON sz.ID = dl.SizeID       JOIN
            Storefront.Siteline sl          with(nolock)ON sl.ID = h.SitelineID    JOIN
            Storefront.Finish f             with(nolock)ON f.ID = h.FinishID      LEFT JOIN
            Storefront.HorizontalGlass hg   with(nolock)ON hg.HorizontalID = h.ID LEFT JOIN
            Catelog.Glass g                 with(nolock)ON hg.GlassID = g.ID      LEFT JOIN
            dbo.Split(@idlist) spl                      ON h.id = spl.id
  )
go

declare @BayID int = 123

SELECT *
FROM   Storefront.ufn_GetHorizontals(dbo.GetBayIDs(@BayID))

go
drop function dbo.Split
go
drop function dbo.GetIDs 
```**

# objective-c - 如何通过触摸将图像添加到视图中？

> ID：11514474
> 
> 赞同：0
> 
> 时间：2012-07-17T00:23:09.870
> 
> 标签：objective-c, uiimageview, uitouch, touchesbegan, uitapgesturerecognizer

我正在开发一个图像编辑应用程序。现在我已经构建了应用程序，因此用户可以从他们的库中选择一张照片或用相机拍照。我还有另一个视图（选择器视图），其中包含用户可以选择的其他图像。通过选择其中一张图像，应用程序会将用户带回主照片。

我希望用户能够触摸屏幕上的任何位置并添加他们选择的图像。

解决这个问题的最佳方法是什么？

接触开始了吗？感动了吗？UITapGestureRecognizer？

如果有人知道任何示例代码，或者可以给我一个关于如何处理这个问题的大致想法，那就太好了！

**编辑**：

现在我可以看到坐标并且我的 UIImage 正在获取我从 Picker 中选择的图像。但是当我点击时，图像没有显示在屏幕上。有人可以帮我解决我的代码问题吗：

```
-(void)drawRect:(CGRect)rect
{    
    CGRect currentRect = CGRectMake(touchPoint.x, touchPoint.y, 30.0, 30.0);

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextFillRect(context, currentRect);
}

-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch * touch = [touches anyObject];
    touchPoint = [touch locationInView:imageView];

    NSLog(@"%f", touchPoint.x);
    NSLog(@"%f", touchPoint.y);

    if (touchPoint.x > -1 && touchPoint.y > -1) 
    {
        stampedImage = _imagePicker.selectedImage;   

        //[stampedImage drawAtPoint:touchPoint];

        [_stampedImageView setFrame:CGRectMake(touchPoint.x, touchPoint.y, 30.0, 30.0)];

        [_stampedImageView setImage:stampedImage];

        [imageView addSubview:_stampedImageView];

        NSLog(@"Stamped Image = %@", stampedImage);

        //[self.view setNeedsDisplay];
    }
} 
```

对于我看到的 NSLogs 示例：

```
162.500000
236.000000
Stamped Image = <UIImage: 0xe68a7d0> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T03:27:08.033

在您的 ViewController 中，使用方法“-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event”来获取触摸发生位置的 X 和 Y 坐标。这是一些示例代码，展示了如何获取触摸的 x 和 y

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{
    /* Detect touch anywhere */
    UITouch *touch = [touches anyObject];
    CGPoint touchPoint = [touch locationInView:self.view];

    NSLog(@"%f", touchPoint.x);  // The x coordinate of the touch
    NSLog(@"%f", touchPoint.y);  // The y coordinate of the touch
} 
```

获得此 x 和 y 数据后，您可以将用户选择或使用内置相机拍摄的图像设置为显示在这些坐标处。

* * *

编辑：

我认为问题可能在于您如何创建 UIImage 视图。而不是这个：

```
 -(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch * touch = [touches anyObject];
    touchPoint = [touch locationInView:imageView];

    CGRect myImageRect = CGRectMake(touchPoint.x, touchPoint.y, 20.0f, 20.0f);
    UIImageView * myImage = [[UIImageView alloc] initWithFrame:myImageRect];
    [myImage setImage:_stampedImageView.image];
    myImage.opaque = YES;
    [imageView addSubview:myImage];
    [myImage release];
} 
```

试试这个：

```
 -(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch * touch = [touches anyObject];
    touchPoint = [touch locationInView:imageView];

    myImage = [[UIImageView alloc] initWithImage:_stampedImageView.image];
    [imageView addSubview:myImage];
    [myImage release];
} 
```

如果这不起作用，请尝试检查“_stampedImageView.image == nil”是否。如果这是真的，您的 UIImage 可能没有正确创建。

# ios - 我怎么知道 UItableview 中的 Cell 按钮点击了什么

> ID：11514476
> 
> 赞同：0
> 
> 时间：2012-07-17T00:23:29.867
> 
> 标签：ios, uitableview

我有一个带有自定义单元格的 UITableView（UITableViewCell 的子类）。每个单元格视图都有两个按钮 btn1 和 btn2。我将我的 ViewController 设置为处理那些 btn1 内部的 TouchUp。

我怎么知道点击了哪个单元格按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:35:57.320

我会在上面放一个标签属性。假设左边的标签为 1，右边的标签为 2。所有 UIView 都有一个标签属性，它只是一个整数值。

```
@property (nonatomic) NSInteger tag; 
```

然后当你收到一个按钮点击时，你可以询问按钮的标签是什么 - 1 或 2，你就会知道它是哪个按钮。

如果您想知道该按钮属于哪个索引路径，您可以抓取按钮的超级视图，它应该是单元格，或者按钮的超级视图的超级视图，如果您将它放在单元格的内容视图上（通常应该）：

```
UITableViewCell *cell = (UITableViewCell *)[button superview];
NSIndexPath *pathForSelectedButton = [tableView indexPathForCell:cell]; 
```

请注意，上面的代码假定按钮直接放在单元格上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:39:03.457

UIButton 有一个标签属性。您可以为每个按钮设置一个唯一值，例如 indexPath.row*2 和 indexPath.row*2 + 1 如果只有一个部分。

然后您可以为每个按钮添加目标方法。

```
[button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside] 
```

最后，实现 buttonPressed 方法，如

```
- (void)buttonPressed:(UIButton *)sender {
    NSInteger tag = sender.tag;
    // your code here.
} 
```

# ios - InfoPlist.strings 与 global.h 的常量

> ID：11514479
> 
> 赞同：4
> 
> 时间：2012-07-17T00:23:42.493
> 
> 标签：ios, objective-c, c-preprocessor, info-plist

如果我想声明一个可以在多个文件中使用的常量字符串（不一定会根据语言进行更改），`.m`我应该在 InfoPlist.strings 中这样做还是应该创建一个单独的`global.h`文件并使用`#define`？

我所做的研究让我觉得事情`global.h`是要走的路，但我想确定一下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:28:35.133

这取决于您需要什么类型的常量。对于简单的字符串常量，使用`.strings`文件的优势在于它不需要重新编译二进制文件以在应用程序中获得可用的值，另一方面，使黑客更容易修改。

`.h`如果要存储数字，则使用 a存储常量会更好，因为从字符串中解析整数并非易事。

大多数时候，我会说 a`.h`更好，但要小心使用 a 的陷阱！您不能在 a 中获取常量的地址`.h`（通常您不必使用），并且将字符串与`==`常量进行比较是禁忌。

# linq - 在 .NET 中，有没有一种方法可以使用 Linq 构建 OOP 对象来查询 XML？

> ID：11514483
> 
> 赞同：1
> 
> 时间：2012-07-17T00:24:07.690
> 
> 标签：linq

所以我有一个 XML 元素汽车和一个 XML 元素野马。野马继承自汽车。

有没有办法自动允许野马使用 Linq 从汽车继承？

```
<car>
    <numDoors/>
    <retailPrice/>
    <year/>
    <vin/>
</car>
<sportsCar inherits='car'>
    <hp/>
    <torque/>
</sportsCar>
<mustang inherits='sportsCar'>
    <cobra />
    <featurePackage sql='select featurePackage from mustang where id=@'/>
</mustang> 
```

基本上是这样的。没有多重继承。c# 对象应该就像您想象的那样。也就是说，它将具有汽车和跑车以及野马的所有特性。

# ruby-on-rails - 多态 url_for 的 URL 参数

> ID：11514489
> 
> 赞同：1
> 
> 时间：2012-07-17T00:25:07.060
> 
> 标签：ruby-on-rails, ruby

我目前有这个代码：

```
link_to 'add a new baz!', new_foo_bar_baz_path(@foo, @bar, baz: { thing: 'the-value' }) 
```

生成此网址：

```
http://ganxy.local/foos/1/bars/2/bazes/new?baz%5Bthing%5D=the-value

```

由于我正在对我的应用程序进行一些更改，我想让 url 生成多态。所以，像这样：

```
link_to 'add a new baz!', [@foo, @bar, :baz]# : { thing: 'the-value' }) 
```

有没有办法添加`?baz%5Bthing%5D=the-value`到最后，还是我需要手动生成字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-04T22:39:25.363

我不建议使用多态 url，因为它比辅助方法慢 2 倍。看看[我关于这个的帖子](http://railsguides.net/2013/12/04/rails-url-for-helper-can-be-slow/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T02:39:37.613

请参阅[Rails 3 - 嵌套资源和多态路径：可以到两个级别，但在三个级别中断](https://stackoverflow.com/questions/5918345/rails-3-nested-resources-and-polymorphic-paths-ok-to-two-levels-but-break-at)

所以你可以写

```
link_to 'add a new baz!', polymorphic_url([@foo, @bar, :baz], thing: 'the-value') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-05T06:21:47.303

你可以这样做：

```
link_to 'add a new baz!', [[@foo, @bar, :baz], thing: 'the-value'] 
```

# symfony - Symfony 2 - 在单元测试期间将会话数据添加到请求对象

> ID：11514490
> 
> 赞同：0
> 
> 时间：2012-07-17T00:25:15.370
> 
> 标签：symfony

我正在尝试为我的 REST API 设置一些测试，我需要在请求对象中设置一个会话变量。通常的方法似乎不起作用。

```
$session = $request->getSession();              
$session->set('my_session_variable', 'myvar'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T07:59:07.207

你应该使用[WebTestCase](https://github.com/symfony/symfony/blob/2.0/src/Symfony/Bundle/FrameworkBundle/Tests/Functional/WebTestCase.php)

然后你可以做类似问题的答案中描述的事情：[how-can-i-persist-data-with-symfony2s-session-service-during-a-functional-test](https://stackoverflow.com/questions/9621359/how-can-i-persist-data-with-symfony2s-session-service-during-a-functional-test)

所以像：

```
$client = static::createClient();
$container = $client->getContainer();
$session = $container->get('session');
$session->set('name', 'Sensorario');
$session->save(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-25T13:06:15.727

如果您使用 WebTestCase，您可以检索“会话”服务。使用此服务，您可以：

*   开始会话，
*   在会话中设置一些参数，
*   保存会话，
*   将带有 sessionId 的 Cookie 传递给请求

代码可以如下：

```
use Symfony\Component\BrowserKit\Cookie;
....
....
public function testARequestWithSession()
{
    $client = static::createClient();
    $session = $client->getContainer()->get('session');
    $session->start(); // optional because the ->set() method do the start
    $session->set('my_session_variable', 'myvar'); // the session is started  here if you do not use the ->start() method
    $session->save(); // important if you want to persist the params
    $client->getCookieJar()->set(new Cookie($session->getName(), $session->getId()));  // important if you want that the request retrieve the session

    $client->request( .... ... 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-17T00:32:45.940

在会话中设置一些值的简短片段

```
$session = $this->client->getRequest()->getSession();
$session->set('name', 'Sensorario'); 
```

还有一个非常简单的例子来获取这个值

```
echo $session->get('name'); 
```

# javascript - Javascript 未将数据返回到 AS3 闪存

> ID：11514491
> 
> 赞同：1
> 
> 时间：2012-07-17T00:25:17.983
> 
> 标签：javascript, actionscript-3, flash, externalinterface

我希望有人能帮助我。我在使用 AS3 的 FlashBuilder 4 中具有以下功能：

```
protected function doIt():void
    {
        if (ExternalInterface.available) {
            var retData:String;
            retData = ExternalInterface.call("returndata");
            if(retData != null) {
                eidLbl.text = retData.toString();
            } else {
                eidLbl.text = "Returned Null";
            }
        } else {
            eidLbl.text = "External Interface not available";
        }                
    } 
```

以及它调用的以下javascript函数：

```
var fql_query = "some query format";
function returndata(){
    return fql_query;
} 
```

当我从我的网站运行这些时，一切正常！flash 文件调用 javascript 函数并将“某种查询格式”返回到正确的文本字段中。

但是，如果我将闪光灯功能更改为如下：

```
protected function doIt():void
{
    if (ExternalInterface.available) {
        var retData:String;
        retData = ExternalInterface.call("runFQL",uidLbl.text);
        if(retData != null) {
            eidLbl.text = retData.toString();
        } else {
            eidLbl.text = "Returned Null";
        }
    } else {
        eidLbl.text = "External Interface not available";
    }                
} 
```

和以下javascript函数：

```
function runFQL(id){
    var user_id = id;
    var page_id = "**********"; // the page id that is actually there is valid
    var fql_query = "SELECT uid FROM page_fan WHERE page_id="+page_id+" and uid="+user_id;

    FB.api({
        method: 'fql.query',
        query: fql_query
    },
    function(response){
        if (response[0]) {
                var uid = response[0].uid;
                window.alert(uid); //100001632043058
                return uid;
        } else {
                window.alert("return 1000");
        }
    });    
}; 
```

我的问题是，当我运行这个时，它会传入 id，运行查询，并准确地拉回 uid 并将其显示在警报中但（这是我的问题）它不会将其传回以闪入回报。它每次都以 null 或 undefined 的形式返回。

谁能告诉我我错过了什么。我已经在谷歌上搜索了几个小时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:28:02.370

```
function(response){
    if (response[0]) {
        var uid = response[0].uid;
        window.alert(uid); //100001632043058
        return uid;
    } else {
        window.alert("return 1000");
    }
}); 
```

在 FB.api 函数完成时调用，而不是在您调用 runFQL 时调用。所以 runFQL 每次都运行并返回 undefined 。

您可以做的是，一旦 FB.api 调用完成，调用 flash 应用程序内的函数并在那里传递返回值。所以基本上在 Flash 中执行 ExternalInterface.addCallback 并从 javascript 调用该函数。

```
function runFQL(id){
    var user_id = id;
    var page_id = "**********"; // the page id that is actually there is valid
    var fql_query = "SELECT uid FROM page_fan WHERE page_id="+page_id+" and uid="+user_id;

    FB.api({
        method: 'fql.query',
        query: fql_query
    },
    function(response){
        if (response[0]) {
                var uid = response[0].uid;
                window.alert(uid); //100001632043058
                // needs ExternalInterface.addCallback("sendDataBack",handleData); in your 
                // as3 code
                yourSwf.sendDataBack(uid); 
        } else {
                window.alert("return 1000");
        }
    });    
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T05:13:39.417

你有一个非常小的工作流程问题。在您的 JavaScript 代码中，您正在调用 FB api，然后函数结束，在这种情况下，它将返回一个未定义的值，因为没有返回任何内容。但是您认为无名函数是在实际上还没有被调用时返回的函数，因为 API 甚至没有得到响应。您需要做的是更改以下代码行。

```
return uid; 
```

到

```
myHTMLFlashObject.someFunctionName(uid); 
```

在您的 Flash 项目中，您需要添加一个函数`someFunctionName`并将其添加为 ExternalInterface 回调函数。
请记住 API 不是异步的，因此您可以期望函数 runFQL 在 API 发送响应之前很久就返回 undefined。

# jquery - 将不同的主题应用到 jQuery 对话框？

> ID：11514495
> 
> 赞同：0
> 
> 时间：2012-07-17T00:26:19.893
> 
> 标签：jquery, jquery-ui, jquery-ui-theme

我有一个包含以下 jQuery 脚本/主题的页面。我想要的默认主题是所有适用元素的“ui-lightness”，但我希望 jQuery 对话框根据“cupertino”主题设置样式。我将如何在我的页面中实现此要求？

```
<!doctype html>
<html>
 <head>
<meta charset="utf-8">
<title>jQuery UI Example Page</title>
  <link type="text/css" href="css/cupertino/jquery-ui-1.8.21.custom.css" rel="stylesheet" />
  <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="js/jquery-ui-1.8.21.custom.min.js"></script>
  <script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:30:12.663

如果您查看对话框元素。查看创建类时添加的类。然后查看各自的 css 文件并将 cupertino 主题类复制到 lightness css 文件中，替换 lightness 文件中的类。它全部采用 css 样式，并且所有类的名称都相同（我相信），因此如果您只制作半自定义 css 文件，它将正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:25:13.780

我认为所有 jquery ui 类都以开头，因此您可以找到对话框小部件并更改其中以 say`ui-`开头的所有样式，并让其他主题具有类而不是`ui-``Xui-``Xui-``ui-`

```
var widget = $('#dialog').dialog('widget');
widget.find('[class^=ui-]').add(widget).each(function(){
    $this = $(this);
    var classes = $this.attr('class');
    $.each(classes.split(' '), function(i, v){
        if (v.indexOf('ui-') == 0){
            this.removeClass(v);
            this.addClass('X'+v);
        }
    });
}); 
```

# php - 奇数意外 T_VARIABLE

> ID：11514498
> 
> 赞同：0
> 
> 时间：2012-07-17T00:27:09.083
> 
> 标签：php

我在互联网上看到有关此错误的问题，其中大多数是独特的拼写错误或对语法的误解。

然而，这很奇怪。这是我的代码，整个文件（旨在由 AJAX 访问）：

```
<?php

$con = mysql_connect("(censored)", "(censored)", "(censored)") or die(mysql_error());

mysql_select_db("(censored)_users", $con) or die(mysql_error());

$result = mysql_query("SELECT * FROM users ORDER BY id") or die(mysql_error());

while ($row = mysql_fetch_array($result)) {

    echo $row['user'] . "<br />";

}

?> 
```

这是从我网站上的另一个脚本复制和粘贴的，用于列出用户；唯一的修改是修改该`echo $row['user']`行，因为它包含更多内容。

这给出了错误：

```
解析错误：语法错误，第 1 行 (blah blah blah blah).php 中的意外 T_VARIABLE

```

让我感到奇怪的第一件事是它应该在第*1*行- 有空格和`<?php`标签。

然后，在一些挫折之后，我在它放置之前评论了所有这些`echo "Hello World!";`

好吧，它给了我一个类似的错误：

```
解析错误：语法错误，第 1 行 (blah blah blah blah blah).php 中的意外 T_CONSTANT_ENCAPSED_STRING
```

我网站上的其余 PHP 工作正常。什么可能导致此特定脚本出现错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:51:02.030

我的新 FTP 客户端 (WinSCP) 似乎去掉了所有的回车。我目前正在搞乱选项，看看我是否可以改变它。

# embedded - ARM 上的堆分析

> ID：11514500
> 
> 赞同：4
> 
> 时间：2012-07-17T00:27:27.063
> 
> 标签：embedded, profiling, arm, heap-memory

我正在基于 Freescale MX51 的开发板 Linux 2.6.35 上开发一个 GUI 繁重的 C++ 应用程序。**我想执行堆分析。**

不幸的是，我发现的所有堆分析工具要么过于侵入，要么表面上无法在 ARM 上运行。我尝试过的具体工具：

*   **[Valgrind Massif](http://valgrind.org/docs/manual/ms-manual.html)**：由于平台的 CPU 很弱，在我的平台上无法使用。Massif 引入的 80% CPU 时间开销在我的应用程序中导致了一系列无法​​弥补的问题。
*   **[gperftools](http://google-perftools.googlecode.com/svn/trunk/doc/heapprofile.html)** *（以前的谷歌性能工具）tcmalloc：除了*堆分析器，这个相当非侵入性的、基于库的`libc malloc()`替换的所有功能都适用于我的目标换句话说，线程缓存分配器有效，但探查器无效。我将在下面为任何好奇的人解释分析器的故障模式。

 *谁能推荐一套替代工具来在 ARM 平台上执行 C++ 堆分析？理想的输出最终将是一个有向分配图，类似于 gperftools 的 tcmalloc 输出。低资源利用率是必须的——我的平台是高度资源受限的。

* * *

**gperftools 的 tcmalloc 的故障模式解释：**

我只为那些好奇的人提供这些信息；我不期待回应。我在下面看到类似于 gperftools 的问题 #407 的内容，除了在 ARM 而不是 x86 上。具体来说，我总是收到“未找到挂钩分配器框架，返回空跟踪”的消息。我花了一些时间调试这个问题，似乎在动态链接 tcmalloc 库时，我的应用程序和动态库之间的边界处的帧指针为空 - 堆栈不能在调用“上方”进入动态库。

gperftools 问题 #407：[https ://github.com/gperftools/gperftools/issues/410](https://github.com/gperftools/gperftools/issues/410)

stackoverflow 用户在 ARM 上看到类似问题：ARM[上的共享库中缺少帧](https://stackoverflow.com/questions/7231089/missing-frames-on-shared-libraries-on-arm)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:54:47.177

堆。有很多方法可以做到，但我只遇到了 3 种在嵌入式领域很重要的主要类型：

1.  链表堆。每个分配都在“已使用”列表中进行跟踪。一旦被释放，它们就会被放入“空闲”列表中。在释放时，相邻的空闲内存块被“连接”成更大的块。Allocs 可以是任意大小。每个 alloc 和 free 都是一个 O(N) 操作，因为它必须遍历空闲列表才能为您提供一块内存，并将空闲块分解为接近您要求的大小，同时将剩余块留在空闲列表中。由于每个分配的开销不断增加，因此该系统不能在较小的系统上单独使用。如果不采取措施将其最小化，这也会随着时间的推移导致内存碎片。

2.  固定大小（单位）的堆。您将堆分成相同大小（较小）的部分。这会稍微浪费内存，具体取决于块有多大（以及您创建了多少不同大小的固定分配器堆），但 alloc 和 free 都是 O(1) 时间操作。没有搜索，没有加入。这种风格通常与第一种风格结合用于“小对象分配”，因为我使用过的引擎有 95% 的分配低于设定的大小（比如 256 字节）。这样，您可以将单元堆用于小型分配，以实现极快的速度和最小的内存损失，同时将列表堆用于较大的分配。也没有外部内存碎片。

3.  可重定位内存堆。你不会给出指向内存的指针，而是句柄。这样，在幕后，您可以在需要时更改内存指针以删除碎片或其他任何东西。高开销。@$$ 商很痛苦，因为它很容易被滥用并得到悬空指针。还为每个内存取消引用增加了开销。但是想提一下。

有一些基本的模式。您可以在野外找到各种使用它们的库，并且还内置了分配数量、碎片和其他有用统计信息的统计信息。自己动手也并不难，尽管除了满足好奇心之外，我不推荐它，因为没有工作的 malloc 进行调试确实很痛苦。添加线程支持也非常简单，但同样，下载现成的解决方案是更好的选择。

以上信息适用于所有平台，无论是 ARM 还是其他平台，尽管我的大部分经验都是在低级 ARM 上进行的，因此以上信息已针对您的平台进行了实战测试。希望这可以帮助！*

# jquery - wordpress 中的 jQuery 冲突

> ID：11514502
> 
> 赞同：0
> 
> 时间：2012-07-17T00:27:42.510
> 
> 标签：jquery, jquery-plugins, wordpress

我正在使用这个插件：[http](http://wordpress.org/extend/plugins/wpmbytplayer/) ://wordpress.org/extend/plugins/wpmbytplayer/ 但是，当我运行以下 jQuery 以从标题中为框设置动画时，背景视频会停止并冻结。有谁知道为什么？

```
jQuery(function($) {
    jQuery('#open').click(function(){
        jQuery('#pull_down_content').animate({'top':'-25px'},1000);
        jQuery('#open').fadeTo('slow', 0);
    });
    jQuery('#close').click(function(){
        jQuery('#pull_down_content').animate({'top':'-800px'},1000);
        jQuery('#open').fadeTo('slow', 1);
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:54:26.547

另一个技巧是不要使用 #open 两次，您可以使用它来引用同一个对象。意义：

$('#open').click(function(){

```
 $('#pull_down_content').animate({'top':'-25px'},1000);
    $(this).fadeTo('slow', 0); 
```

});

# ajax - MVC3 Ajax 复选框网格

> ID：11514503
> 
> 赞同：1
> 
> 时间：2012-07-17T00:27:54.353
> 
> 标签：ajax, asp.net-mvc-3, grid, checkbox, jscript

我想做一个包含产品/类别的复选框网格。产品和类别可以是动态的（我的意思是，产品/类别的数量可以改变）。当我选中一个框时，我能够创建网格并保存数据。我的问题是正确使用ajax。

这是我的模型：

```
 public class ProductModel
 {
    public List<List<ProductItemGrid>> ProductItemGrid { get; set; }
    public List<string> ProductNameList { get; set; }
    public List<string> CategoryNameList { get; set; }

}

public class ProductItemGrid
{
    public int ProductID { get; set; }
    public int CategoryID { get; set; }
    public bool ProductInCategory { get; set; }
} 
```

我的部分观点，（我使用列表列表来填充它）：

```
@for (int i = 0; i < Model.ProductNameList.Count(); i++)
{
<tr class=@(i % 2 == 0 ? "even" : "odd")>

    <td style="font-weight: bold;">
        @Html.DisplayFor(x => x.ProductNameList[i])
    </td>
    @foreach (var result in Model.ProductItemGrid[i])
    {
        string ckBoxName = result.ProductID.ToString() + result.CategoryID.ToString();
        <td id='<%=ckBoxName%>'>
        @using (Ajax.BeginForm("UpdateProductItem", "Product", new AjaxOptions() { InsertionMode = InsertionMode.Replace, UpdateTargetId = ckBoxName }))
        {

                @Html.Hidden("p_CategoryID", result.CategoryID)
                @Html.Hidden("p_ProductID", result.ProductID)
                @Html.CheckBox("<%=ckBoxName%>", result.ProductInCategory, new { onclick = "test" })

        }
        </td>
    }
    </tr>
} 
```

现在视图包含一些错误，但我相信你明白了主要思想。使用 ajax 表单，我可以更新我的数据库，但我的主要问题是在完成 C# 部分之后更新复选框本身。此外，我试图命名 <td> 以便能够通过给他一个名称作为 ProductID_CategoryID 来更新 ckbox（这样我更容易知道我在更新哪个）。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T00:49:06.613

你有没有结帐[http://knockoutmvc.com](http://knockoutmvc.com) 它与 ASP.NET MVC3 有很好的集成，它看起来像是可以帮助你轻松实现所需的库类型。

# .net - 被 GroupBy 难倒的实体框架

> ID：11514508
> 
> 赞同：0
> 
> 时间：2012-07-17T00:28:39.203
> 
> 标签：.net, entity-framework

在下面的代码中，`detail`是 的列表`{ User, Amount, <other fields> }`，如

```
var detail = new List<TuitionDetailItem>(); 
```

我想要的`perMember`是一个列表，`{ User, Total }`其中浮动是`Amount`每个的总和`User`。

```
var perMember = detail
    .Where(x => x.ItemType == TuitionDetailItemType.Details)
    .GroupBy(x => new { x.User, x.Amount })
    .Select(x => new { x.Key.User, Total = x.Sum(y => y.Amount) })
    .ToList(); 
```

我实际上得到的只是一个`detail`没有分组或求和的副本。

感谢帮助！！埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:50:09.050

```
var perMember = detail
    .Where(x => x.ItemType == TuitionDetailItemType.Details)
    .GroupBy(x => x.User)
    .Select(x => new { x.Key, Total = x.Sum(y => y.Amount) })
    .ToList(); 
```

或者更好（我认为它更清洁）

```
var perMember = from d in detail
    where d.ItemType == TuitionDetailItemType.Details
    group d by d.User into g
    select new { User = g.Key, Total = g.Sum(d => d.Amount)}; 
```

# java - Eclipse 在资源管理器中显示项目

> ID：11514509
> 
> 赞同：0
> 
> 时间：2012-07-17T00:28:54.973
> 
> 标签：java, eclipse

> **可能重复：**
> [在 Eclipse 中，显示文件系统中的当前文件](https://stackoverflow.com/questions/1161240/in-eclipse-reveal-current-file-in-filesystem)

如何在探索模式下显示项目。在 Windows 中，如果我们右键单击项目并转到属性，项目位置会在那里说明。但是有什么快捷方式可以进入项目目录吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:54:09.977

我不认为你能做到这一点。我不知道曾经存在的允许这样做的选项。有“Show In”菜单，但这只是为了显示 Eclipse 其他部分的内容。

# macos - 如何在 bash 中确定 CD/DVD 的卷名？

> ID：11514523
> 
> 赞同：3
> 
> 时间：2012-07-17T00:31:25.503
> 
> 标签：macos, bash

我试图弄清楚如何让 bash 脚本自动确定 CD/DVD 的路径以进行处理。运行 Mac (10.7.4) 磁盘显示在：

```
/Volumes/[Volume_name] 
```

由于卷名会根据磁盘而变化，因此我必须手动输入该部分。由于控件的工作方式，操作系统显然知道它是一张 CD/DVD。bash 是否可以使用操作系统使用的任何内容来确定是否存在 CD/DVD 并提供指向它的路径？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T02:09:34.210

我用`drutil`.

`drutil`使用 DiscRecording 框架与附加的刻录设备进行交互。

```
#!/bin/bash
id=$(drutil status |grep -m1 -o '/dev/disk[0-9]*')
if [ -z "$id" ]; then
    echo "No Media Inserted" 
else 
    df | grep "$id" |grep -o /Volumes.*
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:10:58.453

给定一个 UNIX 块设备名称，*diskutil info*的输出比*mount*的更容易解析。例如，这个

```
function get_disk_mountpoint () {
    diskutil info $1 | perl -ne 'print "$1\n" if /^   Mount Point: +(.*)/';
} 
```

作品。麻烦的是，OS X 也动态分配*/dev/disk？*设备到可移动媒体，所以你仍然需要类似的东西

```
function get_optical_mountpoints () {
    for i in $(diskutil list | egrep ^/); do
        if diskutil info $i | egrep -q '^   Optical Drive Type:' ; then
            get_disk_mountpoint $i
        fi
    done
} 
```

专门列出光驱的挂载点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T00:37:27.157

如果安装了光盘，您可以使用`mount`它来查看它的安装位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T02:27:00.433

把上面的部分放在一起，我认为这会做你想要的：

```
get_cd_volume() { 
  local rc=1
  for disk in $(diskutil list | grep ^/); do 
    if diskutil info "$disk" | grep -q Optical; then
      df | sed -ne  "s,^$disk.*\(/Volumes.*\)$,\1,p"
      rc=0 
    fi
  done
  if (( rc )); then
    echo >&2 "No volume mounted."
  fi
  return $rc
} 
```

# node.js - 重构嵌套回调、node.js、异步

> ID：11514534
> 
> 赞同：6
> 
> 时间：2012-07-17T00:33:17.307
> 
> 标签：node.js, asynchronous, callback

```
function indexArticles(callback) {
  fs.readdir("posts/", function(err, files) {
    async.map(files, readPost, function(err, markdown) {
      async.map(markdown, parse, function(err, results) {
        async.sortBy(results, function(obj, callback) {
          callback(err, obj.date);
        }, function(err, sorted) {
          callback( {"articles": sorted.reverse()} );
        });
      });
    });
  });
} 
```

我试图弄清楚如何让这个更漂亮——正如你所知道的，我正在使用 caolan 的异步库，但我不确定要使用哪个控制流结构。例如，如果我使用 async.waterfall 似乎会产生更多代码，每个步骤都必须包装在一个匿名函数中。例如，这只是带有瀑布的嵌套版本的前两行：

```
function indexArticles(callback) {
  async.waterfall([
    function(callback) {
      fs.readdir("posts/", function(err, files) {
        callback(err, files)
      })
    },

    function(files, callback) {
      async.map(files, readPost, function(err, markdown) {
        callback(err, markdown)
      })
    }])
} 
```

您将如何改进这一点？

如果有一种方法不仅可以从左侧部分应用参数，那么我可以看到这样做，例如，

```
function indexArticles(callback) {
  async.waterfall([
    async.apply(fs.readdir, "posts/"),
    async.apply(async.map, __, readPost),
    async.apply(async.map, __, parse),
    // etc...
  ])
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T02:31:31.377

这是一个有趣的问题，因为您需要将参数绑定到迭代器函数的左侧和右侧，因此`bind`/nor `bindRight`（StackOverflow 上有一些实现）都不适合您。这里有几个选项供您选择：

(1) 首先，在您的`async.waterfall`示例中，您有：

```
function(callback) {
  fs.readdir("posts/", function(err, files) {
    callback(err, files)
  })
} 
```

这与以下内容相同：

```
function(callback) {
  fs.readdir("posts/", callback)
} 
```

使用`Function.bind`and 这个方法，你的整个函数`indexArticles`可以写成：

```
function indexArticles(callback) {
  async.waterfall([
    fs.readdir.bind(this, 'posts/'),
    function(files, cb) { async.map(files, readPost, cb); },
    function(text, cb) { async.map(text, parse, cb); },
    function(results, cb) { async.sortBy(results, function(obj, callback) {
      callback(null, obj.date);
    }, cb) }
  ], function(err, sorted) {
    callback( {"articles": sorted.reverse()} );
  });
}; 
```

这有点短。

(2) 如果你*真的*想避免包装函数，你可以使用一种偏函数应用程序。首先，在文件的顶部（或在模块等中），定义一个名为的函数`partial`：

```
var partial = function(fn) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var currentArg = 0;
    for(var i = 0; i < args.length && currentArg < arguments.length; i++) {
      if (args[i] === undefined)
        args[i] = arguments[currentArg++];
    }
    return fn.apply(this, args);
  };
} 
```

此函数接受一个函数和任意数量的参数，并`undefined`在调用函数时将参数列表中的值替换为实际参数。然后你会像这样使用它：

```
function indexArticles(callback) {
  async.waterfall([
    fs.readdir.bind(this, 'posts/'),
    partial(async.map, undefined, readPost, undefined),
    partial(async.map, undefined, parse, undefined),
    partial(async.sortBy, undefined, function(obj, callback) {
      callback(null, obj.date);
    }, undefined)
  ], function(err, sorted) {
    callback( {"articles": sorted.reverse()} );
  });
} 
```

因此，`partial(async.map, undefined, readPost, undefined)`返回一个函数，当 Async 库调用 as`fn(files, callback)`时，它会填充`files`第一个`undefined`，`callback`第二个`undefined`，以调用`async.map(files, readPost, callback)`.

(3)在[这个 StackOverflow 答案](https://stackoverflow.com/a/9826897/62082)中还有一个`partial`for的版本，允许您使用语法：; 但是，我可能会建议不要以这种方式进行修改，而只是将其用作函数。`Function.prototype``async.map.partial(undefined, readPost, undefined)``Function.prototype``partial`

最后，由您决定哪种方法最具可读性和可维护性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T02:44:38.333

看起来我与布兰登的回答有些重叠，但这是我的看法：

```
 var async = require("async")

//dummy function
function passThrough(arg, callback){
  callback(null, arg)
}

//your code rewritten to only call the dummy. 
//same structure, didn't want to think about files and markdown
function indexArticles(callback) {
  passThrough("posts/", function(err, files) {
    async.map(files, passThrough, function(err, markdown) {
      async.map(markdown, passThrough, 
        function(err, results) {
          async.sortBy(results, function(obj, callback) {
            callback(err, obj);
        }, 
        function(err, sorted) {
          callback( {"articles": sorted.reverse()} );
        });
      });
    });
  });
}
indexArticles(console.log)

//version of apply that calls 
//fn(arg, arg, appliedArg, apliedArg, callback)
function coolerApply(fn) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function () {
    var callback = Array.prototype.slice.call(arguments, -1)
    var otherArgs = Array.prototype.slice.call(arguments, 0, -1)
    return fn.apply(
      null, otherArgs.concat(args).concat(callback)
    );
  };
};

//my version of your code that uses coolerAppl
function indexArticles2(callback){
  async.waterfall([
    async.apply(passThrough, "posts/"),
    coolerApply(async.map, passThrough),
    coolerApply(async.map, passThrough),
    coolerApply(async.sortBy, function(obj, callback){callback(null,obj)})
  ],
  function(err, sorted){
    callback({"articles": sorted.reverse()})
  })
}
//does the same thing as indexArticles!
indexArticles2(console.log) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T05:56:23.877

到目前为止，这就是我的结果。

```
function indexArticles(callback) {
  var flow = [
    async.apply(fs.readdir, "posts/"),

    function(data, callback) { async.map(data, readPost, callback); },

    function sortByDate(parsed, callback) {
      var iterator = function(obj, callback) {
        if (obj.date) { callback(null, obj.date); }
        else { callback("Article has no date.") }
      }
      // Note that this sorts in reverse lexicographical order!
      async.sortBy(parsed, iterator,
          function(err, sorted) { callback(err, {"articles": sorted.reverse()} ); }
        );
    }
  ];

  async.waterfall(flow, async.apply(callback))
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-13T00:30:28.770

我最近创建了一个名为 WaitFor 的简单抽象，用于在同步模式下调用异步函数（基于 Fibers）：[https ://github.com/luciotato/waitfor](https://github.com/luciotato/waitfor)

我没有用 async 包测试过它，但它应该可以工作。如果您遇到问题，请与我联系。

使用 wait.for 和 async 您的代码将是：

```
var wait = require('waitfor');
var async = require('async');

function indexArticles(callback) {
  var files = wait.for(fs.readdir,"posts/");
  var markdown = wait.for(async.map, files, readPost);
  var results = wait.for(async.map, markdown, parse);
  var sorted = wait.for(async.sortBy, results, function(obj, callback) {
                                                  callback(null, obj.date);
                                              });
  callback( null, {"articles": sorted.reverse()} );
} 
```

调用你的 fn（异步模式）：

```
//execute in a fiber
wait.launchFiber(indexArticles,function(err,data){
       // do something with err,data
       }); 
```

调用你的 fn（同步模式）：

```
//execute in a fiber
function handleRequest(req,res){
    try{
        ...
        data = wait.for(indexArticles); //call indexArticles and wait for results
        // do something with data
        res.end(data.toString());
    }
    catch(err){
        // handle errors
    }
}

// express framework
app.get('/posts', function(req, res) { 
    // handle request in a Fiber, keep node spinning
    wait.launchFiber(handleRequest,req,res);
    }); 
```

# objective-c - iOS 应用程序是否可以通过编程方式知道设备的日期时间设置为自动还是手动？

> ID：11514541
> 
> 赞同：2
> 
> 时间：2012-07-17T00:33:33.963
> 
> 标签：objective-c, ios, xcode, cocoa

我查找了 NSDate、NSTimeZone 等类，但它们都没有真正确认当前数据/时间设置是否设置为自动。是否有来自 iOS 的公共 api？至少到目前为止，我不想为此目的创建 NTP 客户端。:)

提前感谢您的建议。

# xcode - Xcode 4.3.3 缩进损坏

> ID：11514543
> 
> 赞同：2
> 
> 时间：2012-07-17T00:33:50.230
> 
> 标签：xcode, indentation

我的 Xcode 中的自动缩进有时会出错。我看不出任何押韵或理由来判断它何时正确，何时不正确。这是 Xcode 出错的典型案例。选择并要求 Xcode 重新缩进没有帮助。当然，我可以手动修复它。但是修复我的 Xcode 的任何问题会更好。

有没有成功的经验？

```
-(UIFont*) font {
    UIFont* actual = self.actualFont;
    if (actual) {
        return actual;
    }
WJStyleSheet* sheet = self.styleSheet;
UIFont* r = sheet.font;
return r;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T08:34:18.503

代码完成是否仍然完全有效。例如，您可以键入 self.actual，然后点击`CTRL + SPACE`并获得旁边的类的**彩色**`actualFont`代码完成建议吗？如果不是，那么我认为这与 Xcode 中可能损坏的代码完成有关。

我可以使用以下答案解决此问题：[https ://stackoverflow.com/a/8165886/784318](https://stackoverflow.com/a/8165886/784318)

# bonjour - 卓悦与 Macruby

> ID：11514544
> 
> 赞同：1
> 
> 时间：2012-07-17T00:33:53.360
> 
> 标签：bonjour, macruby

我了解在 ruby​​ 中使用 Dnssd，但似乎 dnssd 没有在 Macruby 中加载。我很好奇是否有人知道诸如 dnssd 之类的东西，或者可以举一个使用 macruby 在网络上浏览 bonjour 的示例方法。有人告诉我，这可以通过 scriptingbridge 实现，但我不确定这实际上是如何工作的。

# iphone - 如何从装有 iOS 5（供个人使用）的新 iPhone 获取历史位置数据？

> ID：11514548
> 
> 赞同：5
> 
> 时间：2012-07-17T00:34:21.800
> 
> 标签：iphone, ios, location

在 iPhone 上从名为solidated.db 的文件中获取历史位置数据过去很容易（例如，请参见[http://petewarden.github.com/iPhoneTracker/](http://petewarden.github.com/iPhoneTracker/)）。但是，这在新的 iOS 系统上更加困难。但是，您的数据是否仍在您手机上的某个位置，是否可以访问它？

需要明确的是，我不打算使用位置 API。相反，我希望我的历史位置数据作为我设备的最终用户。是否有任何可用的脚本/应用程序可以为我做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T15:44:35.833

这并不能真正回答我自己的问题（我仍然对 iPhone 历史位置数据感兴趣，所以如果您有任何想法，请回答！），但是有一些应用程序可以让您存储您的位置数据：

*   OpenPaths, [http://openpaths.cc/](http://openpaths.cc/)，它似乎为他们如何处理您的数据提供了最多的控制和良好的政策（我以前没有使用过它，但如果有人有任何见解，他们当然是受欢迎的。
*   谷歌纵横，[http://www.google.com/latitude](http://www.google.com/latitude)，它允许您以 KML 格式导出 30 天的位置数据。

这两者都适用于 iOS 和 Android。

# javascript - 带有 iframe 加载的动画加载 gif

> ID：11514549
> 
> 赞同：0
> 
> 时间：2012-07-17T00:34:46.020
> 
> 标签：javascript, jquery, iframe, loading

我有这个小脚本，它在 iframe 加载时显示加载动画 gif（颤动轮），然后在完全加载时消失：

```
 $('#mainiframe').load(function() {
    $("#loadani").addClass("nodisplay");
 }); 
```

这很好用。但我想知道是否有人知道一种方法来调整它，以便在 iframe 中加载新页面时它可以工作（例如：如果用户单击 iframe 中的链接并导航到新页面）？

任何建议都会很棒！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:58:14.900

> 但我想知道是否有人知道一种方法来调整它，以便在 iframe 中加载新页面时它可以工作

如果您不拥有 iframe，则没有。您可以在新浏览器中检测到页面的加载事件，但这只会在页面加载后发生。

# c# - 如何捕获 Web 服务异常

> ID：11514552
> 
> 赞同：0
> 
> 时间：2012-07-17T00:35:34.697
> 
> 标签：c#, web-services, exception

如何从返回自定义对象的 Web 服务中捕获异常？

我看过[这篇](https://stackoverflow.com/questions/1805345/how-do-you-catch-a-thrown-soap-exception-from-a-web-service)文章，但它似乎没有显示如何获取服务引发的异常。

我可以提取 SOAP 异常，但我希望能够获取 Web 服务返回的原始异常。我查看了此时设置的变量，似乎在任何地方都看不到异常，我只是看到：

```
"Server was unable to process request. ---> Exception of type 
    'RestoreCommon.ConsignmentNotFoundException' was thrown."

    try
    {
        Consignment cons = WebServiceRequest.Instance.Service
            .getConsignmentDetails(txtConsignmentNumber.Text);
            lblReceiverName.Text = cons.Receiver.Name;
    }
    catch (ConsignmentNotFoundException)
    {
        MessageBox.Show("Consignment could not be found!");
    } 
```

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:45:23.570

简而言之，没有。

Web 服务总是会抛出 SOAP 错误。在您的代码中，

1.  MessageBox 旨在用于 Windows 窗体，而不能用于其他任何地方。
2.  您可以抛出此异常，并且在客户端应用程序中，您将不得不处理 SOAP 错误。

编辑：如果您不想将异常发送给客户端，您可以这样做：

```
class BaseResponse
    {
        public bool HasErrors
        {
            get;
            set;
        }

        public Collection<String> Errors
        {
            get;
            set;
        }
    } 
```

每个 WebMethod 响应都必须继承自此类。现在，这就是您的 WebMethod 块的样子：

```
public ConcreteResponse SomeWebMethod()
        {
            ConcreteResponse response = new ConcreteResponse();

            try
            {
                // Processing here
            }
            catch (Exception exception)
            {
                // Log the actual exception details somewhere

                // Replace the exception with user friendly message
                response.HasErrors = true;
                response.Errors = new Collection<string>();

                response.Errors[0] = exception.Message;
            }
            finally
            {
                // Clean ups here
            }

            return response;
        } 
```

这只是一个例子。您可能需要编写适当的异常处理代码，而不是简单地使用通用 catch 块。

注意：这将只处理您的应用程序中发生的异常。在客户端和服务之间的通信过程中发生的任何异常，仍然会被抛出到客户端应用程序。

# c# - 在整个命名空间中引用某个变量的最佳方式？

> ID：11514553
> 
> 赞同：3
> 
> 时间：2012-07-17T00:35:48.890
> 
> 标签：c#, .net, winforms, global-variables

我有一个`mainForm`在我的程序中几乎无处不在的变量。我希望能够引用此变量，而不必键入包含此变量的类的名称（即`Global._mainForm`，我应该能够只键入`_mainForm`以访问同一名称空间内的任何位置的此变量）。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T02:01:59.690

每当我看到一个全球性的东西时，我都会担心，所以我会重新考虑你的程序是如何构建的。您几乎总是可以在没有全局可访问对象的情况下逃脱。尽管拥有全局可访问对象是有正当理由的，但我通常会尽量远离它们。

根据您提供的少量信息，您也许可以使用事件与主窗口对话，而不是直接访问它。

如果你确实需要一个全局可访问的对象，那么你可以做这样的事情

**注意：**在下面的代码中，所有内容都是静态的，相反，您可以创建一个特殊的静态类，该类包含对您真正感兴趣的类的实例的引用。但是我知道没有办法保存全局在所有命名空间之外对对象实例的引用。

```
using Bar = ProbablyAReallyBadIdeaToHaveAGlobalAnythingButHeyWhyNot.TestClass;

namespace ProbablyAReallyBadIdeaToHaveAGlobalAnythingButHeyWhyNot
{
  public static class TestClass
  {
    public static int TestFoo { get; set; }
  }
}

namespace Foo.SomeOtherNamespace
{
  class MyClassThatDoesStuff
  {
    public void DoStuff()
    {
      Bar.TestFoo = 123;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:17:03.947

我可以看到，在 C# 中，命名空间中的每个类能够直接寻址同一个变量的唯一方法是将变量定义为命名空间中所有其他类使用的基类中的静态变量。由于静态变量可以作为定义它们的类（或继承自的类）中的局部变量来寻址，因此该变量将在没有类限定的情况下可用。

不能说这是一个好主意，但这不是你问的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:46:19.250

您无法在 C# 中完成此操作。

命名空间只是类的类型名称的一部分。从词法上讲，您可以将命名空间视为仅包含其他命名空间和类。

类可能包含字段、函数、事件、属性、嵌套类等，但不包含嵌套命名空间。

因此，无法在类之外的命名空间中定义一个符号，该符号别名或引用特定类中包含的符号。

在解析对变量 name 的引用时`_mainForm`，唯一不需要额外限定的地方是在定义它的类的范围内。

如果您处于与定义的类相同的命名空间范围内`_mainForm`（并且`_mainForm`是静态实例），那么您只需要通过使用类名限定它来访问它。否则，您将需要额外的命名空间限定，或者可能需要使用`using`指令进行欺骗。但是在包含类之外，您总是需要某种资格才能访问`_mainForm`.

请参阅[http://en.csharp-online.net/ECMA-334:_10.7_Scopes](http://en.csharp-online.net/ECMA-334:_10.7_Scopes)了解令人痛苦的细节。

# android - 使用 Spannable 和 LinkMovementMethod 选择 TextView

> ID：11514554
> 
> 赞同：11
> 
> 时间：2012-07-17T00:35:56.997
> 
> 标签：android, android-listview, textview, linkify, spannable

到目前为止，我所做的是具有普通文本和可点击跨度的文本视图的列表视图： ![物品原封不动](../Images/6abb67aee8ddcf0cce25755fd699ff10.png)

单击我打开 URL 的跨度，单击 textView 周围的项目 View 会导致 listView`OnItemClickListener`导航到项目详细信息，这很好： ![在 textView 之外触摸的项目](../Images/db8bd6468e486e0888d54d8ac5c57697.png)

现在的问题是：

![项目 textView 正常触摸的文本](../Images/52ea432240ef0e557442a0122b34efd4.png) ![项目 textView 跨度已触及](../Images/4727623b787f37daf68956e2b8bbf167.png) 触摸 textView 会使普通文本有点突出显示（与完全选择项目时的颜色相同）， textView 的`OnTouchListener`触摸事件会触发但不会触发`OnFocusChangeListener`事件，并且项目的 View 不会获得选择样式。尝试了`FOCUS_BLOCK_DESCENDANTS`listView、item View 的所有变体，`focusable`启用或禁用了 textView，结果相同。

幸运的是，textView`OnClickListener`事件以这种方式触发，但这太难看了：文本是不可见的，而触摸没有释放，因为选定的文本颜色与项目颜色相同，没有其他迹象表明用户将转到项目详细信息其他比那个丑陋的文字消失。

我怀疑发生这种情况是因为 textView 的内容是`Spannable`，并且不是 CliclableSpan-s 的部分以这种奇怪的方式表现。

一旦触摸普通文本，我有机会选择该项目吗？

* * *

listView 项目布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:descendantFocusability="blocksDescendants"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:layout_marginBottom="5dp"
        android:layout_marginLeft="5dp"
        android:layout_marginRight="5dp"
        android:layout_marginTop="5dp"
        android:focusable="false" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <TextView
            android:id="@+id/title"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:layout_marginTop="5dp"
            android:focusable="false"
            android:text=""
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/info"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="4dp"
            android:layout_marginLeft="4dp"
            android:layout_marginRight="4dp"
            android:focusable="false"
            android:text=""
            android:textAppearance="?android:attr/textAppearanceSmall" />

        <TextView
            android:id="@+id/details"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginBottom="4dp"
            android:layout_marginLeft="4dp"
            android:layout_marginRight="4dp"
            android:focusable="false"
            android:gravity="fill_horizontal|right"
            android:text=""
            android:textAppearance="?android:attr/textAppearanceMedium"/>

    </LinearLayout>

</LinearLayout> 
```

使用文本视图 setClickable(false) 我可以禁用这种奇怪的选择样式，在触摸文本视图区域时不会发生任何事情，虽然不好但可能对解决方案有用。

还尝试为每个项目添加不可聚焦和不可点击的按钮，当它被触摸时，整个项目被选中，当触摸被释放时，项目的点击事件被传递，这正是我对带有 Spannable 内容的 textView 所期望的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-21T20:19:22.937

您是否尝试将 TextView 的背景设置为 Android 的默认值`list_selector_background`？

```
 textView.setMovementMethod(LinkMovementMethod.getInstance());
    textView.setBackgroundResource(android.R.drawable.list_selector_background); 
```

对我来说，它似乎给出了你想要的结果。

**更新：看到该项目不仅仅是一个 TextView**

好吧，这不是一个完美的解决方案（因为修复 TextView - ListView 以某种方式突出显示交互可能更好），但它工作得很好。

我发现不是在 TextView 上设置移动方法（触发问题），而是更简单地检查 ListView `onItemClick()`（在确定单击之后）以查看我们是否应该`onClick()`在 ClickableSpans 上启动：

```
public class MyActivity extends Activity {

    private final Rect mLastTouch = new Rect();

    private boolean spanClicked(ListView list, View view, int textViewId) {
        final TextView widget = (TextView) view.findViewById(textViewId);
        list.offsetRectIntoDescendantCoords(widget, mLastTouch);
        int x = mLastTouch.right;
        int y = mLastTouch.bottom;

        x -= widget.getTotalPaddingLeft();
        y -= widget.getTotalPaddingTop();
        x += widget.getScrollX();
        y += widget.getScrollY();

        final Layout layout = widget.getLayout();
        final int line = layout.getLineForVertical(y);
        final int off = layout.getOffsetForHorizontal(line, x);

        final Editable buffer = widget.getEditableText();
        final ClickableSpan[] link = buffer.getSpans(off, off, ClickableSpan.class);

        if (link.length == 0) return false;

        link[0].onClick(widget);
        return true;
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // ...

        listView.setOnItemClickListener(new OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                if (spanClicked(listView, view, R.id.details)) return;

                // no span is clicked, normal onItemClick handling code here ..                    
            }
        });
        listView.setOnTouchListener(new OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent event) {
                if (event.getAction() == MotionEvent.ACTION_UP) {
                    mLastTouch.right = (int) event.getX();
                    mLastTouch.bottom = (int) event.getY();
                }
                return false;
            }
        });

        // ...
    }

} 
```

该`spanClicked()`方法基本上是`onTouchEvent()`框架中 LinkMovementMethod 方法的缩写版本。要捕获最后一个 MotionEvent 坐标（以检查单击事件），我们只需在 ListView 上添加一个 OnTouchListener。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T05:42:08.497

使用`TextView`的`setHighlightColor(Color.TRANSPARENT);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T12:21:27.733

我认为解决这个问题的最好方法是使用选择器。您可以更改选择背景颜色，以便他们看到相同的颜色

示例选择器代码：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true"
       android:color="#000000" /> <!-- pressed -->
    <item android:state_focused="true"
       android:color="#000000" /> <!-- focused -->
    <item android:color="#FFFFFF" /> <!-- default -->
</selector> 
```

对你的链接实施这样的事情。

让我知道结果

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T11:50:52.693

引用文档`setMovementMethod()`的`TextView`

> 设置用于此 TextView 的移动方法（箭头键处理程序）。这可以为 null 以禁止使用箭头键移动光标或滚动视图。
> 
> 请注意，如果您希望具有关键侦听器或移动方法的 TextView 不可聚焦，或者如果您希望没有关键侦听器或移动方法的 TextView 可聚焦，则必须调用 android.view.View.setFocusable(boolean)在调用它以使焦点恢复到你想要的方式之后再次调用它。

第二段解释说，我们应该`setFocusable`在设置 LinkMovementMethod 后显式调用该方法，以使可聚焦性按照我们想要的方式工作。

膨胀列表项后，您需要在代码中执行此操作。获得焦点后，您可以将选择器设置为具有不同颜色的文本。

这是[setMovementMethod](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/widget/TextView.java#TextView.setMovementMethod%28android.text.method.MovementMethod%29)的源代码。

# versioning - 如何在 jackrabbit / JCR 中标记特定版本？

> ID：11514557
> 
> 赞同：2
> 
> 时间：2012-07-17T00:35:59.433
> 
> 标签：versioning, jackrabbit, jcr

我想知道我是否可以标记特定版本。我想在我的项目中使用 JCR，我们有许多由不同类型的节点组成的分层类型树，我们需要在进行一系列更改后保存一个版本以进行暂存或生产。我想知道如何标记特定版本，以便保存对特定节点及其子节点所做的所有更改。

谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:27:37.130

是的，您可以使用您选择的字符串标记版本历史记录中的版本。但 JCR 2.0 称它们为“标签”。

首先，您需要找到`VersionHistory`已签入的特定节点：

```
String path = ... // the path to the versioned node
VersionManager versionManager = session.getWorkspace().getVersionManager();
VersionHistory history = versionManager.getVersionHistory(path); 
```

然后，您可以`Version`通过遍历所有版本、获取“根版本”或获取基本版本来找到要标记的特定内容。我不会展示这个，因为有很多方法可以做到这一点。

```
// Find the version ...
Version versionToBeLabeled = ... 
```

然后你可以给这个版本添加一个标签。请注意，标签只能在单个节点的版本历史记录中使用一次，因此在添加标签时，您可以选择是移动现有标签（如果有的话）还是抛出异常。如果它已经被使用，下面是移动它的代码：

```
// Add a user-defined label to this version ...
String versionName = versionToBeLabeled.getName();
String versionLabel = "MyLabel";
boolean moveLabel = true;
VersionHistory.addVersionLabel(versionName, versionLabel, moveLabel); 
```

请注意，版本名称由 JCR 实现确定，而标签是用户定义的。这就是为什么添加自己的标签然后`Version`通过标签而不是通过某些实现确定的名称查找特定实例通常非常方便的原因：

```
Version foundVersion = versionHistory.getVersionByLabel(versionLabel); 
```

当然，您可以找出`Version`历史中是否有任何带有特定标签的内容：

```
if ( versionHistory.hasVersionLabel(versionLabel) ) {
    // do something
} 
```

或者如果特定版本有标签：

```
Version version = ...
if ( versionHistory.hasVersionLabel(version,versionLabel) {
    // do something
} 
```

甚至删除特定标签：

```
versionHistory.removeLabel(versionLabel); 
```

[有关详细信息，请参阅JCR 2.0 (JSR-283) 规范](http://jcp.org/en/jsr/detail?id=283)的第 15.4 节。

# regex - 检查类型可以在“包中的文件”过滤器中使用正则表达式吗

> ID：11514561
> 
> 赞同：0
> 
> 时间：2012-07-17T00:36:39.833
> 
> 标签：regex, filtering, checkstyle

xjc.exe 生成的用于从 XML 模式创建类的代码有很多 Checkstyle 警告。我可以在项目中使用 Checkstyle“包中的文件”过滤器来忽略 xjc.exe 生成的源代码，但我必须单独选择每个包，并且我经常使用 JAXB 类。

我对生成的代码使用命名约定，其中包名称包含 .JAXB。并以 .classes 结尾

有没有办法在 Checkstyle 中指定通用过滤器，以便忽略 xjc.exe 生成的包？

*   我可以在 Checkstyle 配置中全局执行此操作，以便将其应用于工作区中的所有项目吗？
*   可以在项目的 .checkstyle 文件中完成吗？

谢谢，史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T15:10:43.663

是的，您可以像这样在项目中定义 a `suppressions.xml`：

```
<!DOCTYPE suppressions PUBLIC "-//Puppy Crawl//DTD Suppressions 1.1//EN"
    "http://www.puppycrawl.com/dtds/suppressions_1_1.dtd">
<suppressions>
    <suppress files="[\\/]JAXB[\\/].+?[\\/]classes[\\/][A-Z]" checks="." />
</suppressions> 
```

正则表达式`[A-Z]`末尾的`files`假定您的类以大写字母开头。这样，`classes`仅匹配作为最后一个包名称元素（[正则表达式解释](http://regex101.com/r/lM3uT5)）。

然后，在您的 checkstyle 配置中，您可以像这样启用*SuppressionFilter*：

```
...snip...
<module name="SuppressionFilter">
    <property name="file" value="${workspace_loc}/Project/suppressions.xml"/>
</module>
...snip... 
```

# c++ - VMWare Fusion/Boot Camp下VS2010中ctime的clock()方法的C++问题

> ID：11514562
> 
> 赞同：0
> 
> 时间：2012-07-17T00:36:52.893
> 
> 标签：c++, macos, ctime, vmware-fusion, bootcamp

在我的 Mac 上的特定情况下，我无法从`clock()`ctime 库中的方法获得任何有用的东西。具体来说，如果我尝试在 Windows 7 中的 VMWare Fusion 或 Boot Camp 下运行 VS2010，它似乎总是返回相同的值。一些测试代码来测试这个问题：

```
#include <time.h>
#include "iostream"

using namespace std;

// Calculate the factorial of n recursively.
unsigned long long recursiveFactorial(int n) {
    // Define the base case.
    if (n == 1) {
        return n;
    }

    // To handle other cases, call self recursively.
    else {
        return (n * recursiveFactorial(n - 1));
    }
}

int main() {
    int n = 60;
    unsigned long long result;
    clock_t start, stop;

    // Mark the start time.
    start = clock();

    // Calculate the factorial of n;
    result = recursiveFactorial(n);

    // Mark the end time.
    stop = clock();

    // Output the result of the factorial and the elapsed time.
    cout << "The factorial of " << n << " is " << result << endl;
    cout << "The calculation took " << ((double) (stop - start) / CLOCKS_PER_SEC) << " seconds." << endl;

    return 0;
} 
```

在 Xcode 4.3.3 下，该函数执行时间约为 2 μs。

在 Windows 7 虚拟机中的 Visual Studio 2010 下（在 VMWare Fusion 4.1.3 下），相同的代码给出的执行时间为 0；这台机器配备了 Mac 的 4 个内核中的 2 个和 2GB RAM。

在运行 Windows 7 的 Boot Camp 下，执行时间再次为 0。

这是一个“离金属太远”的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:48:06.807

可能是虚拟机下定时器的分辨率没有那么高。编译器可以很容易地将尾递归转换为循环；60 次乘法不会花费很长时间。尝试计算一些成本更高的东西，比如斐波那契数（当然是递归的），你应该会看到计时器在继续。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T00:49:38.587

从 MSVC 中包含的 time.h 开始，

```
#define CLOCKS_PER_SEC  1000 
```

这意味着`clock()`在使用 Visual C++ 运行时库时只有 1 毫秒的分辨率，因此任何花费少于该时间的操作集几乎总是被测量为经过零时间。

有关可以帮助您的 Windows 上的更高分辨率计时，请查看[QueryPerformanceCounter](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904(v=vs.85).aspx) 和[此示例代码](https://stackoverflow.com/questions/1739259/how-to-use-queryperformancecounter)。

# jquery - jQuery ul 动态设置类

> ID：11514563
> 
> 赞同：2
> 
> 时间：2012-07-17T00:37:02.570
> 
> 标签：jquery

我是 JQuery 的新手，正在努力在列表中设置元素的属性。我有以下html

```
<ul class="collections">
<li><a href="#" id="2">LINEN </a></li>
<li><a href="#" id="3">ANIMAL PRINTS</a></li>
<li><a href="#" id="4">BASKET WEAVE</a></li>
<li><a href="#" id="5">FAUX LEATHER</a></li>
<li><a href="#" id="6">FAUX SUEDE</a></li>
<li><a href="#" id="7">HALLMARK</a></li>
<li><a href="#" id="8">JUMBO CORD</a></li>
<li><a href="#" id="9">PHYTHON</a></li>
<li><a href="#" id="10">CHENILLE CARLTON</a></li> 
```

我想将属性 class = "current" 添加到列表中 id 为 2 的项目中。

我可以使用设置所有项目`$('.collections a').attr('class','current');`

我可以使用以下方法检测 id 为 2 的项目：

```
if($('.collections a').attr('id') == 2){
        console.log('WE HAVE A MATCH');

    } 
```

但是在这里我不确定如何获得对实际元素的引用。

我已经使用 equals 方法设置了类：

```
 $(".collections a:eq(0)").attr('class','current'); 
```

但是希望能够使用元素的 id 来设置它，以防列表的顺序发生变化。

任何帮助将不胜感激。

提前致谢。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:41:24.003

由于`id`属性应该是唯一的，因此可以这样做

```
$(".collections a#2").addClass("current") 
```

但我强烈建议你**不要**用数字开始你的`id`-s

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T00:45:26.610

这里至少有几个问题需要回答。

1.  检索和设置属性，使用`$.prop()`（[链接](http://api.jquery.com/prop/)）
2.  要通过其 id 属性检索元素，请使用哈希选择器（`$('#id_of_element')`或`$('li#id_of_li_element')`）（[此处为选择器的完整列表](http://api.jquery.com/category/selectors/)）
3.  要检查检索到的集合，请查看`$('selector').length`. 如果没有找到任何内容，则为 0，因此您可以使用`if($('li#id_of_li').length){ ... }`；
4.  不要使用数字 ID，因为某些浏览器看不到它们。始终以字母开头的 id 示例`<li id="li_1">`而不是`<li id="1">`.
5.  设置、检索和删除类，使用专用方法`$.addClass('classname')`，`$.hasClass('classname')`以及`$.removeClass('classname')`
6.  要检查元素是否与特定选择器匹配，您可以使用`$('elements').is('selector')`（[链接此处](http://api.jquery.com/is/)）

我真的希望这能解决一些问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T00:43:26.200

这应该没问题：

```
var id = 2;
$('.collections li a').removeClass('current'); // reset current class
$('#' + id).addClass('current'); // set current case given an ID 
```

# c# - 带最小起订量的 Ninject 扩展工厂

> ID：11514565
> 
> 赞同：0
> 
> 时间：2012-07-17T00:37:17.360
> 
> 标签：c#, ninject

我一直在使用 Ninject 进行依赖注入和控制反转，并且我一直在非常成功地使用 Moq 进行测试；然而，我最近遇到了一个需要开始使用 Ninject 工厂扩展的职位。

我的代码如下：

```
interface IBarFactory
{
    Bar CreateBar();
}

class Bar : IBar
{
    ...
}

class BarModule
{
    public override void Load()
    {
        Bind<IBarFactory>().ToFactory();
    }
}

class Tests
{
    [Fact]
    public void TestMethod()
    {
        var bar = new Mock<IBar>();
        bar.Setup(b => b.DoSomething())
            .Verifiable();

        var barFactory = new Mock<IBarFactory>();
        cryptoKeyFactoryMock.Setup(f => f.CreateBar())
            .Returns(bar.Object)
            .Verifiable();

        var someOtherClass = new SomeOtherClass(barFactory.Object);
    }
} 
```

当试图强制 IBarFactory 模拟返回一个 IBar 模拟对象时，我收到一个错误，因为 CreateBar() 方法需要一个 Bar 类型的对象而不是 IBar 类型的对象。

有没有人在使用 Moq 和 Ninject Factory 时取得了更大的成功？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:49:40.760

我不认为这个问题是专门针对 Ninject 的，而只是你似乎只是为了测试而声明了一个接口。BarFactory 是否有理由不返回 IBar？

Moq 可以模拟类，而不仅仅是接口。您可以为要返回的模拟 BarFactory 调用设置一个 Mock<Bar> 实例。需要注意的是，您要在 Mocked Bar 实例上声明的任何方法/属性都必须声明为虚拟的。因此，在您的示例中，如果您将 DoSomething() 声明为虚拟，那么您可以使用您的声明而不是 IBar 来设置 Bar 类型的模拟。

# entity-framework - 单元测试实体框架验证

> ID：11514567
> 
> 赞同：2
> 
> 时间：2012-07-17T00:37:25.173
> 
> 标签：entity-framework, unit-testing, validation

我已经使用 IValidatableObject 为一些实体框架对象编写了一些自定义验证，并且我已经向对象添加了一些 DataAnnotations 以进行验证。

我想测试验证是否满足所需的验证（确保自定义验证正常工作并且所做的任何更改都会保留这些数据注释等......）但我无法确定如何在不调用的情况下在单元测试中运行验证SaveChanges（我不想这样做，好像有问题并且验证不起作用它会写入数据源）

我想做这样的事情：

```
[TestMethod]
public void InvalidStartDate_StartDateAfterEndDate()
{
   var header = new Header()
                    {
                        StartDate = DateTime.Now.AddDays(15),
                        EndDate = DateTime.Now.AddDays(-15)
                    };
   var actual = header.IsValid();
   var expected = false;
   Assert.AreEqual(expected, actual);
} 
```

或者类似的东西

```
[TestMethod]
public void InvalidStartDate_StartDateAfterEndDate()
{
   var header = new Header()
                    {
                        StartDate = DateTime.Now.AddDays(15),
                        EndDate = DateTime.Now.AddDays(-15)
                    };
   var actual = header.GetValidationErrors().Count;
   var expected = 0;
   Assert.AreEqual(expected, actual);
} 
```

但似乎无法找到一种在不调用保存更改的情况下运行验证的方法，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T00:50:29.803

您可以调用[Validator](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.validator)来验证对象。

```
[TestMethod]
public void InvalidStartDate_StartDateAfterEndDate()
{
   var header = new Header()
                    {
                        StartDate = DateTime.Now.AddDays(15),
                        EndDate = DateTime.Now.AddDays(-15)
                    };

   var context = new ValidationContext(header, null, null);
   var results = new List<ValidationResult>();

   var actual = Validator.TryValidateObject(header, context, results);
   var expected = false;

   Assert.AreEqual(expected, actual);
} 
```

# python - 使用联合登录时保存用户设置

> ID：11514569
> 
> 赞同：2
> 
> 时间：2012-07-17T00:37:34.423
> 
> 标签：python, google-app-engine, openid

我需要在我的应用程序上保存每个用户的设置。

我尝试将用户用作我的设置对象的父级，但我不能这样做，因为用户没有密钥。然后我在我的设置对象中创建了一个引用用户属性的实例，但在文档中它说如果用户更改他们的电子邮件地址，UserProperty 是不稳定的。然后我决定将 user_id 保存在 StringProperty() 中，但如果用户使用 OpenId 登录，则 user_id 元素为无。

有没有办法将用户设置绑定到适用于谷歌帐户和 open_id 帐户的用户对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:58:47.613

你不能在google帐户/ open_id帐户周围添加一个包装类，这样你就可以使用父关系了吗？类似于以下内容：

```
UserWrapper(db.Model):
  user = db.UserProperty()

UserSettings(db.Model):
  ...

# New User
user = users.get_current_user()
new_user_settings = UserSettings(...)
new_user_wrapper = UserWrapper(key=user.nickname(), 
                               parent=new_user_settings, 
                               user=user)

# Login Existing User
user = users.get_current_user()
user_wrapper = UserWrapper.get_by_key_name(user.nickname())
user_settings = user_wrapper.parent() 
```

如果用户想要更改他们的电子邮件地址，请使用旧电子邮件查找 UserSettings，删除关联的 UserWrapper，为新电子邮件地址创建新的 UserWrapper 并与旧的 UserSettings 关联。

请注意，我已将 UserSettings 设为 UserWrapper 的父级，以防将多个电子邮件地址与同一帐户相关联可能会引起兴趣。

# google-app-engine - 新用户“注册”/用户登录的 App Engine 回调？

> ID：11514570
> 
> 赞同：2
> 
> 时间：2012-07-17T00:37:43.703
> 
> 标签：google-app-engine, authentication, openid, python-2.7

我现在正在使用 Google App Engine 的默认用户服务进行身份验证。我希望能够存储用户的加入日期（即用户成为我的网络应用程序成员的时间），并且能够在用户行为不端时禁止用户使用我的应用程序。

我知道我需要一个额外的模型来存储这些信息：

```
class User_Info(db.model):
  user = db.UserProperty()
  join_date = db.DateTimeProperty(auto_now_add=True)
  banned = db.BooleanProperty(False) 
```

但我不明白：有没有办法在新用户“注册”我的应用程序（存储加入日期）或登录（检查用户是否被禁止）时获得回调？

我想到的一种方法是将中间目标 URL 发送到`users.create_login_url()`，这将检查关联的 User_Info 实例是否存在。如果是这样，它将检查被禁止的标志。如果没有，它将创建一个 user_info 实例并存储加入日期。然后它将重定向到实际的目标网址。

有更好的解决方案吗？

请注意，我将来会切换到联合身份验证模型，并希望有一个在我切换时可以工作的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:18:43.300

这是正确的做法。

# rspec - 使用 Capybara 和 RSPEC 时在“it”语句后重定向

> ID：11514573
> 
> 赞同：0
> 
> 时间：2012-07-17T00:38:43.740
> 
> 标签：rspec, capybara

我目前的集成测试有问题，我在 before 子句中填写表格，单击提交按钮。然后我用

```
it "has ..." do end 
```

检查重定向的路径是否正确，它是正确的。但是，在完成第一个“it”语句后，我被重定向到不同的页面，并且几个连续的“it”语句失败，因为我不再在页面上。

这是一个示例代码片段。

```
...
context "when the correct information is entered" do
    before {
        fill_in 'Email', :with => 'test@test.test'
        fill_in 'Username', :with => 'some_user'
        fill_in 'Password', :with => 'Password'
        fill_in 'Password Confirmation', :with => 'Password'
        select 'foo', :from => 'user_type'
        click_button 'Save'
    }
    it "has valid html" do
        page.should have_valid_html
    end
    it "has current_path users/2" do
        current_path.should == users_path+'/2'
    end
... 
```

因此，在这里，“具有有效的 html”测试通过，但第二个测试失败，因为我被重定向到“用户”而不是停留在“用户/2”上。同样，如果我切换“it”语句的顺序，我会得到相同的结果。

我应该以不同的方式做我的“之前”，还是我需要考虑其他一些事情？

感谢您的帮助，博卡

编辑：推论的一些信息；我在代码的其他部分做了几乎完全相同的事情，除了没有选择字段。如果它在所有其他情况下都有效，那可能是问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:14:12.383

使用 Capybara 时，重要的是要记住事务性固定装置不起作用。换句话说，RSPEC 通常会“回滚”在测试期间对数据库所做的任何更改（在这种情况下，在每个“it”语句之后）。但是，在使用 Capybara 时，您必须手动删除元素，或者使用 Database Cleaner 等工具截断数据库。

这在这里很重要，因为我的数据库每封电子邮件只处理一个用户。

编辑：

我的解决方法是对索引中的最后一个用户调用 User.delete。但是请记住，索引不会重置，并且下一个创建的用户将从同一点增加索引。

请注意，上下文可能会回滚，而事实并非如此。

# sql - 在同一行显示昨天和今天的数据

> ID：11514575
> 
> 赞同：0
> 
> 时间：2012-07-17T00:38:57.343
> 
> 标签：sql, sql-server, tsql

我在 SQL Server Express 中有下表，表示名称、日期（包含今天的日期和昨天的日期）和值

```
 ID  |  Name  |    Date    |  Value
 1   |  ABC   | 07/03/2012 |   20
 2   |  ABC   | 07/04/2012 |   22
 3   |  XYZ   | 07/03/2012 |   16
 4   |  XYZ   | 07/04/2012 |   18 
```

如何在 SQL Server 中创建一个视图，该视图将在两列中显示特定“名称”的数据作为今天的值和昨天的值？我尝试使用派生表和联合，但没有得到所需的输出？应该是什么方法。我正在寻找的输出如下：

```
 ID  |  Name  | Today's Value | Yesterday's Value
 1   |  ABC   |     22        |      20
 2   |  XYZ   |     18        |      16 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:51:20.600

我不确定每行都有一对匹配的对是否是巧合，它们总是相隔一天，并且您希望 7 月 4 日以某种方式代表“今天”，或者这是否应该反映最高的一天在表中找到。鉴于有限的信息和示例数据，此视图获得了所需的结果：

```
CREATE VIEW dbo.view_name
AS
  WITH x AS 
  (
    SELECT ID, Name, [Date], Value,
      rn = ROW_NUMBER() OVER (PARTITION BY Name ORDER BY [Date] DESC)
    FROM dbo.table_name
  )
  SELECT x2.ID, x2.Name, 
    [Today's Value] = x.Value,
    [Yesterday's Value] = x2.Value
  FROM x
  INNER JOIN x AS x2 
  -- not sure what you want if there is no data for "yesterday";
  -- maybe above should be an outer join
  ON x.Name = x2.Name

  -- if there may be gaps between days:
  AND x.rn = x2.rn - 1

  -- if there will always be data for every day: 
  AND x.[Date] = DATEADD(DAY, 1, x2.[Date])

  WHERE x.rn = 1
  ORDER BY x2.ID; 
```

...但是，您应该努力包含与您提供的四行相比效果不佳的任何边缘情况或无关信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:13:24.970

您可以通过简单的连接来做到这一点：

```
select id, name, t.value as todayValue, y.value as yesterdayValue
from (select t.*
      from t
      where t.date = cast(getdate() as date)
     ) t left outer join
     (select t.*
      from t
      where t.date = cast(dateadd(d, -1, getdate()) as date)
     ) y
     on t.name = y.name 
```

您可以通过在选择之前添加“创建视图为”来使其成为视图。

此公式假设数据与您在问题中指定的数据完全相同。每天正好一排。

# mysql - 创建同时访问数据库的多个线程

> ID：11514580
> 
> 赞同：0
> 
> 时间：2012-07-17T00:39:44.393
> 
> 标签：mysql, multithreading

我试图在各种留言板上找到我的问题的解决方案。但是，我正在撞墙。我正在尝试在 Mysql INNODB 表上重新创建我们的数据库“LockWait Timeout”上发生的问题。（有关我正在尝试解决的问题的信息，请访问：[http](http://bugs.mysql.com/bug.php?id=10641) ://bugs.mysql.com/bug.php?id=10641 ）我已经缩小了问题范围，并且有一个解决方案。但我无法在测试环境中重新创建问题，因此我可以测试我的解决方案。

这是我的代码：

```
public static void main(String[] args) {        

    System.out.println("Programm Starting");

    int numberOfthreads = 2;

    for(int x = 1; x <= numberOfthreads; x++){
        //Create the object UpdateClass

        // Create the Runable object
        Runnable r = new Runnable() {
            // Start the Runnable
            public void run() {
                    System.out.println("Running");
            }
        };

        Thread thr = new Thread(r);
        System.out.println("Thread object created");

        thr.start();
        final UpdateClass session = new UpdateClass(x);
        System.out.println("Thread object started");

        try {
            System.out.println("Starting UpdateClass.runProcess()");
            session.runProcess();
            Thread.sleep(1);
        } 
        catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        thr.stop();

        System.out.println("Thread stopped");
    }
} 
```

基本上，我试图将同步更新复制到 MySql 表以创建 LockWait Timeout 问题。

我的类 UpdateClass 按我需要的方式工作，但我无法重新创建同时事件来调用该类。

**问题**：如何更改我的代码以增加生成导致超时的条件的可能性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:48:52.340

您可以尝试在测试中复制该问题的几件事：

1.  将mysqlcnf中的innodb_lock_wait_timeout改为小时间间隔或增加线程休眠时间（如果更改cnf文件，需要重启DB服务器）
2.  确保您在线程进入睡眠状态之前持有锁（并且尚未释放它）（您可能会在锁尚未释放但不完全确定的情况下通过网络断开/数据库连接断开来实现相同的效果） ）。

我假设您的 MySQL 版本与生产中的版本相同。

# c# - PNG文件上的MD5以及如何在C#中使用RandomAccessStreamOverStream？

> ID：11514582
> 
> 赞同：0
> 
> 时间：2012-07-17T00:40:15.590
> 
> 标签：c#, windows-runtime

我需要打开一个文件，计算它的 MD5，然后如果 md5 在 C# Winrt/Metro 应用程序中正确，则将其作为图像打开。

我遇到的问题是 WinRT 中的哈希类需要 IBuffers（从 FileIO.ReadBufferAsync(StorageFile) 返回，而图像类需要 RandomAccessStream（从 StorageFile.OpenReadAsync() 返回）。

显然，我可以两次打开文件并使用这两个调用，但这似乎效率很低。有没有一种简单的方法可以打开文件，我可以将流/IBuffer 传递给 MD5 HashAlgorithmProvider.HashData() 和 BitmapImage.SetSource() 函数。

我找到了我认为可以用来转换 IBuffer.AsStream() 的 RandomAccessStreamOverStream 函数，但找不到在 C# 中实例化它的方法。

有没有人对“正确”的方法有任何想法？我是 C# 的新手，并且很难理解为什么 Metro 中有两个看似不兼容的流/缓冲概念...... :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T23:38:52.897

哦，天哪，我缺少的链接是 byte[].AsBuffer()。从我的字节数组创建 IBuffer，然后将其传递给散列函数。

# applescript - 去除特殊字符

> ID：11514585
> 
> 赞同：0
> 
> 时间：2012-07-17T00:40:41.180
> 
> 标签：applescript

我需要使用applescript把它变成一个字符串：

```
\", \"resource_id\ 
```

我发现的问题是“\”用于告诉applescript引号是作为字符串的一部分。

关于如何将整组字符转换为applescript字符串的任何想法？

罗兰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-08-04T21:08:36.377

您可以使用 ASCII 代码代替反斜杠字符和引号字符：

```
 tell application "Finder"
        activate
        set bSlash to (ASCII character 92) ---> sets the variable bSlash to \
        set qMark to (ASCII character 34) ---> sets the variable qMark to "
        set theString to bSlash & qMark & ", " & bSlash & qMark & "resource_id" & bSlash ---> sets the variable theString to \", \"resource_id\
        display dialog theString
    end tell 
```

除非我误解了你的需要——但无论如何，你明白我的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:38:49.973

反斜杠用作 AppleScript 字符串中特殊字符（引号）的转义字符，因此要在字符串中使用转义字符，您还必须对其进行转义。因此，您的转义字符串将是：

```
set theString to "\\\", \\\"resource_id\\" 
```

# rotation - 围绕特定点旋转图像

> ID：11514586
> 
> 赞同：1
> 
> 时间：2012-07-17T00:40:52.720
> 
> 标签：rotation, rmagick

是否可以围绕特定点而不是中心旋转图像？我看到了 RVG 的选项，但没有看到 Magick::Image 的选项：/

[http://www.simplesystems.org/RMagick/doc/rvgxform.html#rotate](http://www.simplesystems.org/RMagick/doc/rvgxform.html#rotate) <- RVG 支点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-04T09:24:21.073

```
angle -= angleSpeed * delta;
image.x = target.x + sin(angle) * distanceFromTarget;
image.y = target.y + cos(angle) * distanceFromTarget; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:48:34.570

您可以尝试将图像的锚点更改为您希望它旋转的位置，而不是中心

# .net - 在 Windows Workflow (WF) 中，“工作项”的概念是如何表达的？

> ID：11514587
> 
> 赞同：1
> 
> 时间：2012-07-17T00:40:55.377
> 
> 标签：.net, workflow-foundation-4, workflow-foundation

几年前（在 WF 存在之前），我从事自定义工作流引擎的工作。它的工作原理如下：设计一个工作流（称为定义），将特定类型的工作项与该定义相关联（例如：工作流定义 X 处理小部件），并通过创建一个实例来处理该工作项的各种状态和转换每个工作项的定义。

工作项实现了一个 IWorkItem 接口，允许将其作为一种状态机进行处理（例如，它具有当前状态和一组运行、停止、暂停等方法来控制它）。

在 Windows Workflow 中，如何定义工作项？它可以是在我的 SQL Server 数据库中建模的自定义实体吗？我必须给它任何特定的字段吗？在我的代码中表示它的对象是否必须实现特定的接口？就底层行数据而言，它如何响应持久性/解除持久性？如何轻松查询数据库以获取实体的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:42:30.293

WF 中的工作项是工作流本身，它由“活动”组成（可以是内置的，也可以通过派生自 .net 活动类型之一来定制。可以添加一些扩展来支持持久性，跟踪等。[这](http://msdn.microsoft.com/library/ee342461.aspx)是一个很好的框架介绍。

以我个人的经验，我读了一本书，因为当时，MSFT 文档对于 WF4 来说并不是很好，但现在看起来更好。我已经能够建立一个工作流程来模拟我办公室的销售流程。销售人员使用连接到 WCF 服务的 Silverlight 客户端，该服务反过来提供存储在我的持久性表中的数据。它还与管理创建工作流的新实例并将现有实例保存回 SQL 数据库的工作流服务进行交互。至于查询现有实例，这非常简单。在我的例子中，我安装了 MSFT 提供的实例存储数据库，我只是查询了它们提供的表之一。

# mysql - PDO 使用 bindParam 返回 MySQL 错误

> ID：11514591
> 
> 赞同：0
> 
> 时间：2012-07-17T00:41:44.377
> 
> 标签：mysql, pdo, php

嘿伙计们，我在这里运行这个小功能

```
function getBeaches() {

$request=Slim::getInstance()->request();

$args=filter_var_array(func_get_args(),FILTER_SANITIZE_STRING); 
$sql="SELECT * FROM beaches WHERE state=:state AND city=:city"; 

    //  var_export($args); die();
    //  array ( 0 => 'wa', 1 => 'seattle', )

try {
    $db         = getConnection();
    $stmt       = $db->prepare($sql);

        $stmt->bindValue('state',   $args[0], PDO::PARAM_STR); //should bind wa 
        $stmt->bindValue('city',    $args[1], PDO::PARAM_STR); //should bind seattle
        $stmt->execute();

    $stmt       = $db->query($sql);
    $beaches    = $stmt->fetchObject();
    $db         = null;

    echo '{"map": ' . stripslashes(json_encode($beaches)) . '}';
} catch(PDOException $e) {
    echo '{"error":{"text":'. $e->getMessage() .'}}';
}

    /* {"error":{"text":SQLSTATE[42000]: Syntax error or access violation: 
     * 1064 You have an error in your SQL syntax; check the manual that  
     * corresponds to your MySQL server version for the right syntax to use 
     * near ':state AND city=:city' at line 1}}
     */

} 
```

我得到了我在底部评论的错误，试图像这样运行

`mysql$ SELECT * FROM beaches WHERE state='wa' AND city='seattle';`

可能这敲响了一些钟声？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:45:59.327

~~您需要在参数名称之前使用分号：（~~不是 100% 正确，请参阅编辑）

```
$stmt->bindValue(':state',   $args[0], PDO::PARAM_STR); //should bind wa 
$stmt->bindValue(':city',    $args[1], PDO::PARAM_STR); //should bind seattle 
```

[来自PDOStatement::bindValue()](http://php.net/manual/en/pdostatement.bindvalue.php)上的 PHP 文档：

> 参数标识符。对于使用命名占位符的预处理语句，这将是**:name**形式的参数名称。对于使用问号占位符的预处理语句，这将是参数的 1 索引位置。

**编辑** 正如*@jeroen*指出的问题（与您的pastebin 中的相同），您`$stmt`在从中获取数据之前覆盖了变量。在您的代码中，问题在第 17 行左右：

```
$stmt->execute();  // $stmt now has query results (from the query with parameters bounded)

$stmt       = $db->query($sql); // You redo the query. Now $stmt has no query results and no parameters are bound
$beaches    = $stmt->fetchObject(); // Statement assumes you want to execute query and does so but not parameters are bound 
```

您可以通过将上述行更改为：

```
$stmt->execute();
$beaches = $stmt->fetchObject(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T00:52:58.807

不确定它是否有帮助，但我总是使用`bindParam`over `bindValue`。如果您选择这样做，请修改您的活页夹：

```
$stmt->bindParam(':state', $args[0], PDO::PARAM_STR);
$stmt->bindParam(':city', $args[1], PDO::PARAM_STR); 
```

除此之外，你所做的一切在我看来都很好。

# php - 具有多个正则表达式的 PHP preg_replace_callback

> ID：11514594
> 
> 赞同：1
> 
> 时间：2012-07-17T00:41:54.220
> 
> 标签：php, regex, preg-replace-callback

大家好，我在 php 上有以下代码

```
return preg_replace_callback("#\{gallery: '(.+?)'\}#i", 
    function($i)
    { 
        $oGallery = new Gallery( $i[1] );
        $oGallery->PublicSide();
    }, $string); 
```

现在我想添加以下内容：

假设我想让用户选择是否要将目录添加到画廊，所以我这样做：

```
"#\{gallery: '(.+?)' dir: '(.+?)')\}#i" 
```

所以用户有药水要做：`{gallery: 'folder'}`或`{gallery: 'folder' dir: '1'}`

我将如何根据正则表达式执行此操作，以便即使目录选项不存在也会进行替换？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:59:16.337

使其成为可选

```
"#\{gallery: '(.+?)'(?: dir: '(.+?)')?\}#i" 
```

`(?:text)`创建一个非捕获组

在组之后添加`?`使其可选

# android - Android - 当按钮具有透明背景时，它会从布局中消失

> ID：11514599
> 
> 赞同：0
> 
> 时间：2012-07-17T00:43:08.977
> 
> 标签：android, button, colors, transparency

我的 Android 应用程序中有以下表格。一切正常，除了最后一个按钮 - 关于我。当我将背景设置为透明颜色时 - 它在我的设备上没有显示（但是，它在 eclipse 中布局的图形视图中可见。“不显示”我的意思是它不在屏幕上 - 在它的位置是“下一个”。如果我从最后一个按钮中删除 android:background - 它会返回到设备。怎么了？

```
 <TableRow
                    android:id="@+id/tableRow1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:orientation="horizontal" >

                    <ImageButton
                        android:id="@+id/buttonShare"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="@color/transparent"
                        android:onClick="shareIt"
                        android:src="@drawable/social_share" />

                    <ImageButton
                        android:id="@+id/buttonBack"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="@color/transparent"
                        android:onClick="prevImage"
                        android:src="@drawable/navigation_previous_item" />

                    <ImageButton
                        android:id="@+id/button1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="@color/transparent"
                        android:src="@drawable/navigation_accept" />

                    <ImageButton
                        android:id="@+id/buttonAbout"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="@color/transparent"
                        android:onClick="showAbout"
                        android:src="@drawable/action_about" />

                    <ImageButton
                        android:id="@+id/buttonForward"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="@color/transparent"
                        android:onClick="nextImage"
                        android:src="@drawable/navigation_next_item" />

                    <ImageButton
                        android:id="@+id/buttonAbout"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:background="@color/transparent"
                        android:onClick="showAbout"
                        android:src="@drawable/action_about" />
                </TableRow>
            </TableLayout> 
```

我的部分颜色资源如下：

```
<color name="transparent">#00000000</color> 
```

我刚刚用新的图片加载了覆盖的 action_about.png 图片。现在，按钮出现了——但它显示的是旧的 png，关于，而不是新的。到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T00:45:53.183

你为什么要将背景设置为透明？您是否只想要一个没有设备默认按钮“框架”而只有您的 action_about 可绘制的按钮？如果是这样，您可以使用普通 Button 而不是 ImageButton 来做到这一点，如下所示：

```
<Button
  android:id="@+id/buttonAbout"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:background="@drawable/action_about"
  android:onClick="showAbout"/> 
```

**编辑：**另请注意，您的布局中有两次 buttonAbout 元素，它位于底部，底部有 3 个。

**编辑2：**您在顶部菜单`clean...`下根本没有选项吗？`Project`还是只是变灰了？

我下载了 Eclipse Indigo sr2（我在网站上找不到 sr1 的链接），它就在那里。 ![在此处输入图像描述](../Images/aaf476dd78039a6f580fc9caece56964.png)

# wcf - 如何从 JavaScript 访问服务引用？

> ID：11514600
> 
> 赞同：0
> 
> 时间：2012-07-17T00:43:10.890
> 
> 标签：wcf, wcf-data-services

（WCFDS = WCF Data Services 5，由实体框架支持，使用 oData v3，格式化为 JSON，通过 IIS7 提供服务并受 Windows 身份验证保护。）

关键是通过 AJAX 调用以经过身份验证的方式访问 WCFDS。

为此，我有一个作为 ASP.Net Web 应用程序的客户端，在 Web.config 中设置了 Windows 身份验证，并且有一个指向 WCFDS 的服务参考。

我想使用客户端 JavaScript 来访问服务参考。我怎样才能做到这一点？

我考虑过创建一个 aspx 页面，在客户端中托管并直接从 JavaScript 代码调用此页面，然后通过服务参考检索数据 - 但我不知道如何公开服务参考的全部功能以这种方式（有几十个实体）。

任何人都可以提供建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:19:43.787

web.config 中的 Windows 授权设置与 WCF 数据服务没有直接关系，因此您可能不需要在那里设置任何内容。您需要在 IIS 中正确设置您的设置。

有许多关于在 WCF 数据服务上使用 Windows 授权的好文章；简而言之，您在选择公开授权的方式上有很大的自由度（从从提要中过滤掉单个实体到抛出 401/403）。

有几篇好文章可以通读：

*   [http://msdn.microsoft.com/en-us/data/gg192997](http://msdn.microsoft.com/en-us/data/gg192997)
*   [http://blogs.msdn.com/b/astoriateam/archive/2010/07/21/odata-and-authentication-part-7-forms-authentication.aspx](http://blogs.msdn.com/b/astoriateam/archive/2010/07/21/odata-and-authentication-part-7-forms-authentication.aspx)（是的，我知道那是表单身份验证，但身份验证部分这与 WCF 数据服务中的代码完全正交）
*   [http://blogs.msdn.com/b/astoriateam/archive/2010/07/19/odata-and-authentication-part-5-custom-httpmodules.aspx](http://blogs.msdn.com/b/astoriateam/archive/2010/07/19/odata-and-authentication-part-5-custom-httpmodules.aspx)

您可能编写的最简单的代码将类似于以下内容：

```
namespace Scratch.Web
{
    [ServiceBehavior(IncludeExceptionDetailInFaults = true)]
    public class ScratchService : DataService<ScratchContext>
    {
        [QueryInterceptor("Products")]
        public Expression<Func<Product, bool>> ProductsAuthorization()
        {
            if (!HttpContext.Current.Request.IsAuthenticated)
            {
                return (p) => false;
            }
            return (p) => HttpContext.Current.User.IsInRole("AllowAccessToProducts");
        }

        // ...rest of service code...
    }
} 
```

请注意，客户端的所有内容都由浏览器控制，因此您实际上不需要在那里做任何事情（最大的步骤可能是将站点添加到受信任的站点，这样它就不会提示您输入凭据，如果您“重新在加入域的机器上）。

# c# - 列表框更新 #2

> ID：11514604
> 
> 赞同：2
> 
> 时间：2012-07-17T00:43:44.847
> 
> 标签：c#, winforms, listbox

我正在尝试在 C# 中更新此列表框。这是我在 C# 中的第一个程序，不完全确定它是如何工作的。

```
public partial class progHider : Form
{
    String[] processList;

    public progHider()
    {
        InitializeComponent();
    }

    private void progHider_Load(object sender, EventArgs e)
    {
        List.Items.AddRange(getList());
    }

    private String[] getList()
    {
        Process[] processlist = Process.GetProcesses();
        processList = new String[Process.GetProcesses().Length];
        int index = 0;
        foreach (Process process in processlist)
        {
            if (!String.IsNullOrEmpty(process.MainWindowTitle))
            {
                processList[index] = process.MainWindowTitle;
                index++;
            }
        }

        return processList;
    }

    private void btnrefresh_Click(object sender, EventArgs e)
    {
        List.DataSource = null;
        this.Update();
    } 
```

所以刷新按钮是假设通过调用 getList() 来更新列表框，但我不知道如何完成它。在java中，您只需要调用该方法并执行repaint()。我试过this.refresh/update，没用。一个问题是如何更新列表框？我不知道如何实现它。

我这样做对吗？应该 List.Items.AddRange(getList()); 在 progHider_Load 方法中？另一个问题是，private void progHider_Load(object sender, EventArgs e) 是如何工作的？它只使用一次吗？你能叫它吗？另外，Main方法在哪里？我正在使用 Visual Studio 2010 windows 应用程序模式，它只是向我显示了部分类的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T01:27:41.677

好吧，我会以完全不同的方式进行操作，但与您所拥有的保持一致，将这两种方法更改为我在这里所拥有的（假设`List`是您的 ListBox 对象的名称）：

```
private void progHider_Load(object sender, EventArgs e)
{
    List.DataSource = getList();
}

private void btnrefresh_Click(object sender, EventArgs e)
{
    List.DataSource = getList();
} 
```

并回答你的问题。progHider_Load 事件在表单首次加载时被调用。你不应该明确地调用它（尽管如果你真的想的话，没有什么能阻止你）。

* * *

**更新：**

我可能会将您的流程相关代码从表单中提取出来并将其放在另一个类中。然后使用 a 创建一个属性[`BindingList<String>`](http://msdn.microsoft.com/en-us/library/ms132679.aspx)（对于 WinForms... 或者如果您使用的是 WPF，您可能会使用 a [`ObservableCollection<String>`](http://msdn.microsoft.com/en-us/library/ms668604.aspx)）。这是一个示例类：

```
using System;
using System.ComponentModel;
using System.Diagnostics;

public class ProcessListGenerator
{
    public ProcessListGenerator()
    {
        ProcessList = new BindingList<String>();
    }

    public BindingList<String> ProcessList
    {
        get;
        private set;
    }

    public void UpdateProcessList()
    {
        ProcessList.Clear();
        foreach (var proc in Process.GetProcesses()
                                    .Where(p => !String.IsNullOrEmpty(p.MainWindowTitle)))
        {
            ProcessList.Add(proc.MainWindowTitle);
        }
    } 
```

在您的 progHider 表单中，您可以拥有以下内容：

```
public partial class progHider : Form
{
    ProcessListGenerator _processes;

    public progHider()
    {
        InitializeComponent();
    }

    private void progHider_Load(object sender, EventArgs e)
    {
        _processes = new ProcessListGenerator();
        _processes.UpdateProcessList();
        listBox1.DataSource = _processes.ProcessList;
    }

    private void btnRefresh_Click(object sender, EventArgs e)
    {
        _processes.UpdateProcessList();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:22:45.283

即使您需要调用 List.Items.AddRange(getList()); 它也会显示您的按钮单击

就您的示例而言，您可以调用 progHider_Load.. 但在我看来，调用事件处理程序是脏池

# c# - ASP.Net 应用程序预热 - 公开集合

> ID：11514606
> 
> 赞同：1
> 
> 时间：2012-07-17T00:43:48.370
> 
> 标签：c#, asp.net, .net-4.0, iis-7.5, asp.net-4.0

我的 MVC 应用程序当前使用`Global.asax`,`Application_Start`方法加载大量数据，然后将其公开为集合。例如：

### 当前使用示例：

```
// Global.asax 
public static DataRepository Repository { get; set; }
protected void Application_Start()
    {
        // All the normal stuff...

        // Preload this repository.
        DataRepository = new DataRepository();
    }

// HomeController.cs Example
public ActionResult Index(){
    return Json(MyApplication.Repository.GetSomeCollection(), 
                JsonRequestBehavior.AllowGet);
} 
```

### 我正在尝试做的事情：

我想使用[ASP.Net 4.0 + IIS 7.5 应用程序预加载](http://www.asp.net/whitepapers/aspnet4#0.2__Toc253429241)功能，但需要将存储库暴露给应用程序的其余部分。就像是：

```
// pseudo code attempt at goal 

public class ApplicationPreload : IProcessHostPreloadClient
{
    public MyRepositoryClass Repository { get; set; }

    public void Preload(string[] parameters)
    {
        // repository class's constructor talks to DB and does other crap.
        Repository = new MyRepositoryClass();
    }
} 
```

* * *

## 问题

如何使用通过实现的方法公开存储库类甚至简单`IEnumerable<T>`集合？`Preload()``IProcessHostPreloadClient`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T04:15:32.423

如果您只是想公开`IEnumerable<T>`尝试将其`HttpRuntime.Cache`从`IProcessHostPreloadClient`. 然后，您可以选择从`Global.asax`应用程序类公开该集合。

就像是：

```
public class ApplicationPreload : IProcessHostPreloadClient
{
    public void Preload(string[] parameters)
    {
        var repository = new MyRepositoryClass();
        HttpRuntime.Cache.Insert(
            "CollectionName", 
            repository.GetCollection(), 
            Cache.NoAbsoluteExpiration, 
            Cache.NoSlidingExpiration, 
            CacheItemPriority.NotRemovable, 
            null);
    }
}

public class MvcApplication : HttpApplication
{
     public IEnumerable<CollectionItem> CollectionName
     {
         get { return HttpRuntime.Cache["CollectionName"] as IEnumerable<CollectionItem>; }
     }
} 
```

# python - 向用户远程公开命令行工具

> ID：11514608
> 
> 赞同：0
> 
> 时间：2012-07-17T00:44:13.140
> 
> 标签：python, http, command-line, cgi

我们有许多 perl 和 python 脚本，我们想向我们的一些队友公开以供随意使用；我们真的不想用 git、perl、python、依赖项等来设置它们。

我们的一个想法是为每个脚本编写一个描述符，说明它需要哪些参数；然后让一个简单的 HTML 页面调用带有适当参数的 CGI 脚本，等待并将标准输出返回给用户。

这似乎是一个如此简单的需求，以至于我很惊讶我在外面找不到任何类似的东西。没有渲染表单的框架，它会输出一个虚拟控制台屏幕......

当然，存在重大的安全问题。任何人都可以推荐执行上述操作或其他类似的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:43:07.237

队友是开发人员还是对命令行感到满意？如果是这样，我会建议使用 SSH。

使用脚本在盒子上运行 SSHD。在 Windows 上，这很容易使用 cygwin，否则默认情况下在 Mac 和 Linux 上存在

客户端登录（ssh user@host）并运行脚本。使用证书设置安全性，您甚至不必输入密码。

如果有问题，我宁愿在命令行中调试脚本，而不是在不透明网页的末尾。

维护也会容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:04:39.703

我认为您以错误的方式看待问题。

没有用于运行脚本的通用框架可能有助于对任意 perl 或 python 脚本的参数进行类型检查，因为它们只是字符串（无论是传递给`sys.argv`/`$ARGV`还是作为 CGI 环境变量）。

但是如果你把它分成几部分，它们都很容易，而且大多是正交的。

首先，如何对字段进行类型检查？好吧，如果您愿意要求 HTML 5，只需将适当的类型和其他参数放在字段上：

```
<input name="foo" type="number" required> 
```

如果你需要支持旧版浏览器，谷歌“HTML 表单验证”或“JS 表单验证”，你会发现数百个库可以做这些事情，或者通过简化你必须编写的 JS，或者让你附加股票按名称或 CSS 样式的验证器，例如：

```
 // ...
  <input name="foo" id="foo">
</form>
<script>
  // ...
  Validator.add("foo", type="number", required=true)
</script> 
```

像往常一样，jQuery 非常有用。有一些解决方案可以让您编写与 HTML 5 相同的内容；像[这样的](http://jorenrapini.com/blog/javascript/the-simple-quick-and-small-jquery-html-form-validation-solution)文章展示了从头开始构建一个是多么容易。或者，更简单，只使用Validation插件，这样你只需要一行JS。

为了设置表单来触发您的脚本，任何现有的 CGI 框架都可以立即执行此操作。

为了使脚本将其标准输出返回给用户，这也是 CGI 内置的。但是，请确保将您的服务器配置为发送内容类型 text/plain 而不是 text/html（对于脚本所在的目录，或者对于 *.cgi 或 *.py/*.pl，或任何适当的）。

那么，还剩下什么？你想从一些数据库映射脚本名称自动生成表单到类型验证字符串吗？同样，没有人会拥有一个从您的类型字符串格式构建表单的通用库。但是用 jQuery 编写起来很容易。只需创建一个带有空字段集和操作的表单。在`#(document).ready`（或从选项菜单中选择，或其他），将具有适当验证属性的字段添加到空字段集中。（或者，或者，如果您使用的是简单的基于脚本的验证库，只需修改库代码以直接使用您的类型描述符而不是使用其他格式。）您还可以在此处设置操作属性（如果您是使用 HTML 5 或验证插件，因此您不需要自定义提交脚本），或者只需点击自定义提交脚本中的 URL（如果您正在以已经需要的方式进行验证）。

所以，是的，这里有一些代码要写。但是任何解决方案都需要一些代码——你必须以某种方式将类型输入其中，对吧？——并且使用流行的通用库（例如，带有验证插件的 jQuery）可能不需要更多的代码。专用框架会有。以及更多的可定制性和可维护性（找到有 jQuery 经验的人比有一些狭窄用途库经验的人容易得多）。

# c# - 在字段/变量中存储类型

> ID：11514609
> 
> 赞同：13
> 
> 时间：2012-07-17T00:44:19.223
> 
> 标签：c#, static, field

如何将类型存储在静态字段中，以便我可以做这样的事情（注意：只是一个例子，在伪代码中）？：

```
public class Logger
{
    public static Type Writer;

    public static void SetWriter(Type @new)
    {
        Writer = @new;
    }

    public static void Write(string str)
    {
        Writer.Write(str);
    }
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-17T00:50:08.537

很简单：

```
Type variableName = typeof(SomeTypeName); 
```

或者

```
Type variableName = someObject.GetType(); 
```

不过，不确定这是否有助于您真正想做的事情。查看其他答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T00:48:10.253

除了是关键字这一事实外`new`，您存储类型的代码应该可以正常工作。

但是，您的代码

```
Writer.Write(str); 
```

是没有意义的。

该类`Type`没有方法`Write(string)`。

感觉就像你追求的是一个[界面](http://msdn.microsoft.com/en-us/library/ms173156.aspx)

```
public interface IWriter
{
    public Write(string text);
}

public class Logger
{
    public static IWriter Writer;

    public static void SetWriter(IWriter newWriter)
    {
        Writer = newWriter;
    }

    public static void Write(string str)
    {
        Writer.Write(str);
    }
} 
```

这样，您可以将任何实现的类传递`IWriter`给`SetWriter`，例如

```
public class MyWriter : IWriter
{
    public void Write(string text)
    {
        // Do something to "write" text
    }
}

Logger.SetWriter(new MyWriter()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T00:48:50.787

好吧，那个示例代码没有意义，但为什么不简单地使用一个通用接口呢？例如，`System.IO`命名空间中的所有（至少我认为是所有）文本书写类型都继承自 abstract class `TextWriter`，所以......

例如：

```
public class Logger
{
    public Logger(TextWriter writer)
    {
        _writer = writer;
    }

    private TextWriter _writer;    

    public void Write(string text)
    {
        _writer.Write(text);
    }
} 
```

现在，将编写器公开并依靠代码的用户来确保它始终有效是一个好主意吗？可能不是，但这更多是设计考虑。此外，您的 java 样式设置器是 A) 非典型的 C#，它对属性有很好的语法支持，并且 B) 无用，因为支持字段无论如何都是公共的。

# cocos2d-iphone - nsmutablearray 调用时不添加对象

> ID：11514610
> 
> 赞同：2
> 
> 时间：2012-07-17T00:44:35.400
> 
> 标签：cocos2d-iphone, null, nsmutablearray, scheduler

我有一个 NSMutable 数组，我想将 Sprites 添加到其中，这样我就可以检查它们是否撞到了墙上。我使用此代码这样做：

```
NSString *bulletName = [NSString stringWithFormat:@"tank%d_bullet.png", _type];
bullet = [CCSprite spriteWithSpriteFrameName:bulletName];
bullet.tag = _type;
bullet.position = ccpAdd(self.position, ccpMult(_shootVector, _turret.contentSize.height));        
CCMoveBy * move = [CCMoveBy actionWithDuration:duration position:actualVector];
CCCallBlockN * call = [CCCallBlockN actionWithBlock:^(CCNode *node) {
    [node removeFromParentAndCleanup:YES];
}];

if (!bulletIsGone) {
    [self schedule:@selector(updator:) interval:0.01];

}
else {
    [self unschedule:@selector(updator:)];
}
[bullet runAction:[CCSequence actions:move, call, nil]];
[_layer.batchNode addChild:bullet];
[bulletsArray addObject:bullet];
if ([bulletsArray objectAtIndex:0] == nil) {
    NSLog(@"HELP");
}
NSLog(@"%@", [bulletsArray objectAtIndex:0]);

}

-(void)updator: (ccTime) dt{

for(CCSprite *bulletz in bulletsArray){
    NSLog(@"this is the for loop");
    CGRect rect1 = CGRectMake(bulletz.position.x - bulletz.contentSize.width/2, bulletz.position.y - bulletz.contentSize.height/2, 20, 20);
    if ([_layer isWallAtRect:rect1]) {
        NSLog(@"bulletHitWall");
        [_layer.batchNode removeChild:bulletz cleanup:NO];
        bulletIsGone = YES;
    }
}

} 
```

但是，当我构建和运行时，我得到了“（空）”和“帮助”的控制台输出。从 touchesEnded 调用 'updator' 之前的方法。有人可以看到我做错了什么吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:49:33.117

你初始化数组吗？这似乎是最可能的原因

在你的 viewDidLoad 方法中试试这个......

```
- (void)viewDidLoad
{
  [super viewDidLoad];

  bulletsArray = [NSMutableArray alloc] init];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:49:57.430

既然`NSMutableArray`不能容纳`nil`物体，唯一的办法就是条件

```
[bulletsArray objectAtIndex:0] == nil 
```

可以评估为`true`is that `bulletsArray`is `nil`。您需要确保正确分配数组。一个典型的地方是你的类的指定初始化器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T00:51:39.580

为什么要将项目符号添加到另一个数组？您已经有一个包含它们的批处理节点，即`_layer.children`.

您确定数组本身 ( `bulletsArray`) 不为零吗？它在哪里初始化？

最后，您应该考虑使用性能更高的[CCARRAY_FOREACH](https://stackoverflow.com/questions/4872855/what-is-ccarray-foreach-in-coccos2d)循环。

# c# - Visual Studio WebBrowser 和 iCloud.com

> ID：11514613
> 
> 赞同：0
> 
> 时间：2012-07-17T00:45:30.880
> 
> 标签：c#, visual-studio, browser, icloud

这是我关于这个主题的第二篇文章，因为我没有得到任何帮助。我不知道是否有人知道如何帮助我，但我已经搜索和搜索，我无法弄清楚如何解决这个我一直试图克服 4 天的问题。我制作了一个简单的网络浏览器，当按下按钮时需要加载 iCloud.com。当我尝试加载页面时，它告诉我不支持网络浏览器。我正在使用 Visual Studio 2010 Ultimate，我正在用 C# 对其进行编程。我已经完全更新了所有内容，我还尝试使用不同的浏览器，例如 Google Chrome、Firefox、Opera 和 Internet Explorer。我可以使用所有这些浏览器在 VS 外部加载此页面，但在 VS 内部它将无法正常工作。我的程序可以加载除 iCloud.com 之外的所有其他页面。如果我尝试加载 YouTube.com，我会得到：(" 您正在使用 Microsoft Internet Explorer 7 网络浏览器。YouTube 即将结束对 Internet Explorer 7 的支持，请立即更新您的浏览器。”）我不知道如何在 VS 中更改浏览器版本。谁能指出对我有帮助的方向？谢谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:24:08.190

我在 microsoft Visual Studio 论坛上询问了浏览器控件是否已更新但没有得到答复。

我用的是 VS2010 Pro，用过 VS2011 预览版和 VS2012 RC。其中任何一个都没有更新的浏览器控件，都报告为 IE7。

我会寻找替代解决方案。

[SO vb 2008 webbrowser Alternative](https://stackoverflow.com/questions/5692221/vb-2008-webbrowser-alternative/5692272#5692272)上列出了一些

许多人还推荐[Awesomium](http://awesomium.com/)

如果您必须使用 Visual Studio 控件，我在 [这里](https://stackoverflow.com/questions/4612255/regarding-ie9-webbrowser-control)找到了一些有趣的讨论，但它需要修改注册表和特定的系统 IE 浏览器。

# c++ - 如何确定 g++ 编译器错误中缺少哪个文件？

> ID：11514618
> 
> 赞同：0
> 
> 时间：2012-07-17T00:46:41.513
> 
> 标签：c++, qt, compiler-errors, g++

我正在尝试编译一些代码（不是我的），但遇到了错误。我有几个问题：

1）显然，我该如何解决我的错误，以及

2a）我怀疑我需要安装 Qt 库/包或其他东西，但我似乎无法弄清楚我需要做什么。我如何确定我实际上错过了什么，以及

2b）我可以在哪里安装它？（如何最好地使用 apt-file、locate 或其他东西？）

我正在使用 ubuntu 12.04、64 位和 g++4.6.3

```
if g++ -DHAVE_CONFIG_H -I. -I. -I..   -D_FORTIFY_SOURCE=2 -I/usr/include/Inventor/annex -D_REENTRANT -I/usr/share/qt4/include -I/usr/share/qt4/include/Qt  -I/usr/local/include/Inventor/annex -D_REENTRANT  -I/home/mishkin/mincinstall/include   -g -O2 -MT brain-view.o -MD -MP -MF ".deps/brain-view.Tpo" -c -o brain-view.o brain-view.cc; \
    then mv -f ".deps/brain-view.Tpo" ".deps/brain-view.Po"; else rm -f ".deps/brain-view.Tpo"; exit 1; fi
In file included from brainApp.h:80:0,
                 from callbacks.h:7,
                 from brain-view.cc:52:
vertstatsForm.h:12:14: fatal error: Qt: No such file or directory 
```

我查看了 vertstatsForm.h:12:14 里面的第 12 行是 #include < Qt >

```
#ifndef VERTSTATSFORM_H
#define VERTSTATSFORM_H

#include <Qt>  <-----line 12
#include <qvariant.h>
#include <qdialog.h>
#include <Qt3Support/Q3GridLayout>
#include <QLabel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T05:17:40.347

要回答问题 1，请尝试删除

```
#include <Qt> 
```

如果仍然无法正常工作，请更换为

```
#include <QtCore>
#include <QtGui> 
```

和/或您可能需要的其他模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:44:58.983

要回答问题 2，如果错误消息是

```
fatal error: QXXXX: No such file or directory 
```

做这个

```
locate QXXXX 
```

这会给你这样的东西

```
/usr/include/qt4/QtGui/QXXXX 
```

这意味着你应该更换

```
#include <QXXXX> 
```

和

```
#include <QtGui/QXXXX> 
```

# serialization - 磁盘上是否有 ocaml 库存储/使用数据结构

> ID：11514626
> 
> 赞同：4
> 
> 时间：2012-07-17T00:48:11.520
> 
> 标签：serialization, ocaml, berkeley-db

像bdb。但是，我查看了 ocaml-bdb，似乎它只存储字符串。我的问题是我有存储大量数据的数组。当然，我可以将它们序列化为许多文件，或者对我的数据进行编码/解码并将它们放在数据库或那些键值数据库的东西上，这是我最后的手段。我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T11:10:16.940

HDF4 / HDF5 文件格式可能适合您的需要。见[http://forge.ocamlcore.org/projects/ocaml-hdf/](http://forge.ocamlcore.org/projects/ocaml-hdf/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-18T16:50:41.597

除了 jrouquie 提到的 HDF4 绑定之外，还有可用的 HDF5 绑定 ( [http://opam.ocaml.org/packages/hdf5/](http://opam.ocaml.org/packages/hdf5/) )。根据您存储的数据类型，绑定到 GDAL ( [http://opam.ocaml.org/packages/gdal/](http://opam.ocaml.org/packages/gdal/) )。

对于可以放入大数组的数据，您还可以选择内存映射磁盘上的大文件。例如，请参阅[https://caml.inria.fr/pub/docs/manual-ocaml/libref/Bigarray.Genarray.html#VALmap_file](https://caml.inria.fr/pub/docs/manual-ocaml/libref/Bigarray.Genarray.html#VALmap_file)。虽然它将您与一种相当严格的磁盘格式联系起来，但它确实使操作大于可用 RAM 的数组变得相对简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-19T17:28:15.013

HDF5 是答案，但鉴于问题有点模糊，另一种解决方案是可能的。

免责声明：我不知道 ocaml（但我知道 caml-light）并且我知道 berkeley 数据库（AKA.bsddb（AKA bdb））。

> 但是，我查看了 ocaml-bdb，似乎它只存储字符串。

这可能是真的，`ocaml-bdb`但实际上它存储字节。我不确定你的情况，因为在 Python2 中字节和 unicode 字符字符串之间没有区别。直到最近，Python 3 才获得了正确的字节类型，并且 bdb 绑定获取和吐出字节。也就是说，区别是微妙的，但您宁愿使用字节，因为 bdb 可以理解和使用它。

> 我的问题是我有存储大量数据的数组。当然，我可以将它们序列化为许多文件，或者编码/解码我的数据并将它们放入数据库
> 
> 或者使用那些键值数据库的东西，这是我最后的手段。
> 
> 我想知道是否有更好的方法。

这取决于您的需要以及数据的外观。

*   如果数据可以全部保留在内存中，您宁愿将内存转储到文件中并重新加载。

如果您需要在多个架构或操作系统之间共享数据，您宁愿使用像 HDF5 这样的序列化框架。请记住，HDF5 不处理循环引用。

如果数据不能全部留在内存中，那么您需要使用 bdb（或wiredtiger）之类的东西。

# 为什么选择 bdb（或wiredtiger）

简单地说，几十年的工作已经进入：

*   拆分数据
*   将其存储在磁盘上
*   检索数据

尽可能快。

wiredtiger 是 bdb 的继承者。

所以是的，您可以自己拆分文件等。但这需要做很多工作。只有专业的公司才能做到这一点（包括彭博社......），在上述所有管理自己的人中，有著名的 postgresql、mariadb、google 和[algolia](https://blog.algolia.com/#q=inside%20the%20algolia%20engine&page=0&refinements=%5B%5D&numerics_refinements=%7B%7D&index_name=%22wordpress_all%22)。

像wiredtiger 和bdb 这样的有序键值存储使用类似于postgresql 和mysql 等高级数据库的算法，或者像lucene/solr 或sphinx 那样的专用算法，即。mvcc、btree、lsm、PSSI 等...

MongoDB 从 3.2 开始使用wiredtiger 后端来存储所有数据。

有人认为键值存储不擅长存储关系数据，说几个项目开始在键值存储之上做分布式数据库。这是一个有用的线索。例如 FoundationDB 或 CockroachDB。

键值存储背后的想法是提供一个通用框架：

*   拆分数据
*   将其存储在磁盘上
*   检索数据

尽可能快地提供一些保证（如 ACID）和其他不错的东西（如压缩或加密）。

利用这些图书馆提供的电力。您需要了解*键值组合*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-29T06:11:29.427

过去有一个 ocaml BerkeleyDB 包装器： [OCamlDB](http://caml.inria.fr/cgi-bin/hump.en.cgi?contrib=375)

显然有人最近调查了它： [OCamlDB 的最新补丁](https://github.com/fccm/ocamlbdb)

但是，来自 hcarty 的 GDAL 绑定可能已准备好生产并在某处密集使用。

此外，在 opam 中有 dbm 的绑定：[dbm](https://opam.ocaml.org/packages/dbm/)和[cryptodbm](https://opam.ocaml.org/packages/cryptodbm/)

# objective-c - 设置 UIView 框架

> ID：11514628
> 
> 赞同：0
> 
> 时间：2012-07-17T00:48:27.790
> 
> 标签：objective-c

当键盘出现时，我正在尝试调整 UITextView 的大小，但我不知道我做错了什么。

当键盘出现时，我调用了这三行代码：

```
CGSize kbSize = [[[notification userInfo] objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

textView.frame = CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height-kbSize.height);

NSLog(@"%f,%f,%f,%f", textView.frame.origin.x, textView.frame.origin.y, textView.frame.size.width, textView.frame.size.height); 
```

由于某些非常奇怪的原因，我的键盘没有出现，这是记录的内容：

> 0.000000,-180.000000,480.000000,180.000000

为什么 CGRects y 原点在硬编码为 0 时设置为 -180？

编辑： textView 是我以编程方式创建的 UITextView。我没有使用界面生成器。

EDIT2：似乎问题在于视图在旋转时会自动调整大小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:32:22.623

你可以试试这个：

```
- (void) moveTextViewForKeyboard:(NSNotification*)aNotification up:(BOOL)up {
    NSDictionary* userInfo = [aNotification userInfo];
    NSTimeInterval animationDuration;
    UIViewAnimationCurve animationCurve;
    CGRect keyboardEndFrame;

    [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] getValue:&animationCurve];
    [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] getValue:&animationDuration];
    [[userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] getValue:&keyboardEndFrame];

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:animationDuration];
    [UIView setAnimationCurve:animationCurve];

    CGRect newFrame = textView.frame;
    CGRect keyboardFrame = [self.view convertRect:keyboardEndFrame toView:nil];
    keyboardFrame.size.height -= tabBarController.tabBar.frame.size.height;
    newFrame.size.height -= keyboardFrame.size.height * (up?1:-1);
    textView.frame = newFrame;

    [UIView commitAnimations];   
} 
```

希望它会有所帮助

# ios - 带照片的 Airplay

> ID：11514635
> 
> 赞同：3
> 
> 时间：2012-07-17T00:49:18.773
> 
> 标签：ios, airplay

查了airplay的官方文档，发现airplay只能支持音视频。但除此之外，本机照片应用程序可以播放照片。那么有什么方法可以播放照片吗？顺便说一句，我知道“镜像”模式可以完成这项工作：我可以在我的代码中检测到 2 个屏幕，并在此模式下向 iOS 设备呈现不同的屏幕。然而，“镜像”模式只存在于 iPad 2、新 iPad 和 iPhone 4S...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T08:55:15.173

我在这里找到了解决方案 [http://livevision.us/wordpress/2011/02/16/airplay-without-private-api/](http://livevision.us/wordpress/2011/02/16/airplay-without-private-api/) 以及 [如何找到活动 AirPlay 设备的 IP 地址？](https://stackoverflow.com/questions/10101935/how-to-find-the-ip-address-of-the-active-airplay-device)

我可以将一些 UIImage 发送到 Apple TV。

但我不知道苹果是否允许使用这些非官方 Airplay 协议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-04T00:12:33.403

它记录在 Apple 的网站上。当用户启用 airplay 镜像时，您的应用会找到两个 UIScreen:s。这很简单。

这是一个示例应用程序[http://developer.apple.com/library/ios/samplecode/GLAirplay/Introduction/Intro.html](http://developer.apple.com/library/ios/samplecode/GLAirplay/Introduction/Intro.html)

# c# - 如何将实际的底层数据库值存储在组合框中，同时显示更用户友好的值？

> ID：11514640
> 
> 赞同：1
> 
> 时间：2012-07-17T00:49:48.353
> 
> 标签：c#, winforms, combobox

我需要在组合框中显示诸如“偷偷摸摸”和“谨慎”之类的值，但此后能够根据这些词的基础 DB 值（例如，“S”和“D”）设置组合框的 SelectedItem。

我认为我可以以某种方式使用组合框的 DisplayMember 和 ValueMember 属性，但是我随后可以使用实际（valuemember）值做一些类似于以下内容的事情：

```
comboBoxAdverbs.SelectedIndex = comboBoxAdverbs.Items.IndexOf(weirdAdverbs[CURRENT_ADVERB]); 
```

由于“weirdAdverbs[CURRENT_ADVERB]”包含“S”和“D”之类的值，当组合框包含“偷偷摸摸”和“谨慎”的值时，它当然不会找到并设置 SelectedIndex

如果我将组合框项目标记值设置为“S”和“D”（假设这是可能的），我可以遍历这些值，但我希望有一种类似于“IndexOf() “ 多于。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:10:59.127

我为此使用了一个模板类，它非常方便。组合框将显示您想要的任何文本，您可以使用它存储一个值。

```
 public class cboItem<T>
{
    public cboItem(string name, T value)
    {
        this.Name = name;
        this.Value = value;
    }

    public string Name { get; set; }
    public T Value { get; set; }
    public override string ToString()
    {
        return Name == null ? "" : Name;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T01:12:34.133

组合框项目可以是任何东西，包括类/结构。默认情况下，它将使用 ToString() 实现来显示项目，但是如果您填充一组对象，您可以使用 DisplayMember 和 ValueMember 来获得很好的效果。

作为一个简单的例子，给你一些想法，我们将组合框绑定到一组 KeyValuePair 实例，用于你奇怪的动词代码及其描述性名称。或者，您可以使用 linq 组合匿名类型，或创建自己合适的类/结构。

```
private void populateCombo()
{
    comboBoxAdverbs.Items.Clear();
    comboBoxAdverbs.Items.Add( new Tuple<string, string>( "S", "Surreptitiously" ) );
    comboBoxAdverbs.Items.Add( new Tuple<string, string>( "D", "Discreetly" ) );
    comboBoxAdverbs.DisplayMember = "Item2";
} 
```

然后在您要选择与提供的代码匹配的项目的代码中：（即“D”）

```
var item = comboBoxAdverbs.Items
    .OfType<Tuple<string,string>>()
    .FirstOrDefault(i => string.Compare(i.Item1, textBox1.Text, true) == 0);

if (item != null)
    comboBoxAdverbs.SelectedItem = item; 
```

这会尝试通过将键与任何输入（在本例中为文本框值）进行比较来找到匹配项，如果找到匹配项，则设置 SelectedItem 以告诉组合框选择它。

** 编辑：Whups，最初使用 KeyValuePair，我没有意识到它是一个结构，所以没有 Null 检查能力。改为元组（本质上是对）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T23:19:11.753

我发现对我有用的是在设置后将 selectedindex 值存储到组合框的 Tag 属性中。然后，如果用户在应该处于“只读”状态时尝试更改 selectedIndex，只需将其更改回存储在 Tag 属性中的 selectedIndex 值：

```
comboBoxPlatypusId.SelectedIndex = comboBoxPlatypusId.Items.IndexOf(DuckbillVals[Duckbill_PlatypusID]);
comboBoxPlatypusId.Tag = comboBoxPlatypusId.SelectedIndex;
...
private void comboBoxFunnyMammals_SelectedValueChanged(object sender, EventArgs e) {
    var cb = sender as ComboBox;
    if (cb != null)
    {
        int validSelection = Convert.ToInt32(cb.Tag);
        if (cb.SelectedIndex != validSelection) {
            cb.SelectedIndex = validSelection;
        }
    }
} 
```

# image - Grails 2.0.4 停止在 AWS Elastic Beanstalk 环境中随机提供某些图像

> ID：11514658
> 
> 赞同：2
> 
> 时间：2012-07-17T00:51:40.983
> 
> 标签：image, grails, resources, amazon-web-services, amazon-elastic-beanstalk

我遇到了一个奇怪的“showstopper”问题，我无法在本地重现或在独立的 Tomcat 7 环境中托管。

出于某种原因，某些图像会在随机时间后停止提供。它似乎没有任何模式。绝对和相对路径图像都会受到影响。而且，非常有趣的是，指向“损坏”链接的链接实际上开始在 GSP 中以不同方式呈现，这让我认为 Grails 内部也没有看到它们：

```
 <img src="${resource(dir: 'images/brochure', file: 'slide_01.png')}" alt=""/>
This is a broken one, and results in
 <img src="/images/brochure/slide_01.png" alt=""/>
on the rendered GSP

<img src="${resource(dir: 'images/brochure', file: 'slide_02.png')}" alt=""/>
This one works, and results in 
<img src="/static/images/brochure/slide_02.png" alt=""/>
on the rendered GSP 
```

请注意，即使我手动添加回 /static/ 它仍然损坏。图像肯定存在，如果我重新启动应用程序，一切都会再次运行一段时间。恶化的图像并不总是相同的

任何帮助将不胜感激！！！我感觉“资源”插件在做一些奇怪的事情，但我不知道是什么，或者如何解决它。

我正在使用两个运行 Tomcat 7 的带有粘性会话的实例

# objective-c - 单例目标 c 说明

> ID：11514662
> 
> 赞同：2
> 
> 时间：2012-07-17T00:52:23.330
> 
> 标签：objective-c, ios, singleton

当我继续学习时，这本书实现了一个单例。我理解使用它的原因，但我只是想澄清一下代码。

```
+ (BNRItemStore *)defaultStore
{
    static BNRItemStore *defaultStore = nil;
    if(!defaultStore)
        defaultStore = [[super allocWithZone:nil] init];

    return defaultStore;
} 
```

在行中`static BNRItemStore * defaultStore = nil;`直到返回语句。我的问题是；我一直在调用这个类，`[[BNRItemStore defaultStore] someMethod];`在另一个类或应用程序的一部分中，defaultStore 变量将设置为 nil？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T00:58:33.327

重要的是要了解`static`关键字有两种效果。一个是它使该变量在方法被调用之前存在，并在它返回后持续存在，以便它可用于下一次调用。另一个效果更微妙——初始化静态变量的“赋值”是在加载代码时执行的，而不是在调用方法时执行的。所以它不会在每次调用时都重新初始化。

但是由于变量存在于方法的“外部”，它的名称应该是唯一的——不要在这个类的另一个单例或另一个单例中使用相同的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T00:57:41.257

这是具有静态存储持续时间的变量的初始化程序。该值将在可执行文件加载到内存时设置。

请注意，没有必要将值显式设置为 nil，因为所有具有静态存储持续时间的变量都会自动设置为 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T00:56:03.540

对于函数静态变量，该行

```
static BNRItemStore *defaultStore = nil; 
```

不是*作业*。相反，它是*静态初始化*，它只发生一次——代码第一次通过你的函数。在随后的调用中，该值将不是`nil`，因为您为其分配了一个非零值。

您的实现在单线程环境中是安全的。对于并发环境，您需要添加某种形式的同步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T00:57:50.427

静态变量仅在第一次调用函数/方法时初始化一次。之后，你基本上可以假装这条线不存在。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-17T01:42:25.117

Apple 推荐如下内容

```
+ (BNRItemStore *)defaultStore
{
    static BNRItemStore *defaultStore = nil;
    static dispatch_once_t done;
    dispatch_once(&done,
                  ^{ defaultStore = [BNRItemStore alloc]init];});
    return defaultStore;
} 
```

上面的代码假设 ARC - 如果不使用 ARC，您将不得不定义什么都不做的保留、释放、自动释放和 dealloc 方法。

# mysql - mysql每月用户数

> ID：11514666
> 
> 赞同：1
> 
> 时间：2012-07-17T00:52:57.717
> 
> 标签：mysql, database

我有一个带有字段架构的 mysql 数据库

用户名，时间戳

其中时间戳是上次活动的日期。

我想在 mysql 中构建一个查询，它将为我提供按月分解的特定用户的记录数。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:02:14.830

```
Select count(*) as counta, DATE_FORMAT(timestamp, "%Y-%m") as "_month" 
from users    
where username='YOUR_USER_NAME'
group by _month
order by _month 
```

对于 unix 时间戳，使用 FROM_UNIXTIME

```
SELECT count(*) as counta, DATE_FORMAT(FROM_UNIXTIME(timestamp), "%Y-%m") as "_month"
from users    
where username='YOUR_USER_NAME'
group by _month
order by _month 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T01:01:36.230

您的问题是以每月用户数的形式发布的，但我认为您的意思是给定用户每月的记录数。您想要的查询是：

```
Select CAST(CONCAT(YEAR(`timestamp`),'-',MONTH(`timestamp)) AS CHAR) as `month`, COUNT(*) as `hits` FROM db.table WHERE `username`='<the_username>'  GROUP BY `month`; 
```

# http - Haskell Network.HTTP 错误地下载图像

> ID：11514671
> 
> 赞同：11
> 
> 时间：2012-07-17T00:53:58.537
> 
> 标签：http, haskell, download

我正在尝试使用 Network.HTTP 模块下载图像但收效甚微。

```
import Network.HTTP

main = do
  jpg <- get "http://www.irregularwebcomic.net/comics/irreg2557.jpg"
  writeFile "irreg2557.jpg" jpg where
       get url = simpleHTTP (getRequest url) >>= getResponseBody 
```

输出文件出现在当前目录中，但在 chromium 或 ristretto 下无法显示。Ristretto 报告“解释 JPEG 图像文件时出错（不是 JPEG 文件：以 0c3 0xbf 开头）”。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-17T01:28:27.600

```
writeFile :: FilePath -> String -> IO () 
```

`String`. 那是你的问题，就在那里。`String`用于 unicode 文本。尝试在其中存储二进制数据将导致损坏。在这种情况下尚不清楚腐败是由`simpleHTTP`还是由完成的`writeFile`，但这最终并不重要。您使用了错误的类型，当遇到不构成有效 unicode 编码的字节时，某些东西会破坏数据。

至于解决这个问题，较新版本的`HTTP`返回类型是多态的，并且可以处理返回 a 中的原始字节`ByteString`。您只需要更改将字节写入文件的方式，这样它就不会推断出您想要一个`String`.

```
import qualified Data.ByteString as B
import Network.HTTP
import Network.URI (parseURI)

main = do
    jpg <- get "http://www.irregularwebcomic.net/comics/irreg2557.jpg"
    B.writeFile "irreg2557.jpg" jpg
  where
    get url = let uri = case parseURI url of
                          Nothing -> error $ "Invalid URI: " ++ url
                          Just u -> u in
              simpleHTTP (defaultGETRequest_ uri) >>= getResponseBody 
```

获取多态请求的构造有点笨拙。如果[问题 #1](https://github.com/haskell/HTTP/issues/1)得到解决，那么使用`getRequest url`就足够了。

# jasper-reports - 无法为 iReport 4.6.0+XML 数据源中的列计算总和

> ID：11514675
> 
> 赞同：0
> 
> 时间：2012-07-17T00:55:00.420
> 
> 标签：jasper-reports, ireport

我已经从 XML 数据源构建了一个报告。我创建了两个嵌套组，我正在尝试计算列的总和并将总计放入最深的组页脚带中。

我创建了一个变量来聚合值和一个文本字段来将该变量打印到组的页脚区域。但是，我得到 0.0（这是我的变量的初始值表达式）作为每个组的列总和。

让我指定一些细节：

```
 - TargetGroup_DURATION: variable that aggregates values from column dur/@val
  - Calculation = Sum
  - Reset type = Group
  - Reset group = Target Group
  - Increment type = Group (I've tried also setting this property to Column, Now, and Auto)
  - Increment group = Target Group
  - Variable expression = NumberFormat.getInstance(new Locale("en", "US")).parse($F{dur/@val}).doubleValue()

- Text field on TargetGroup footer band
 - Text field expression: $V{TargetGroup_DURATION}
 - Evaluation time: Group (I've tried also Now, Column and Auto)
 - Evaluation group: TargetGroup 
```

正如我所说，我无法得到正确的结果。有人现在必须设置什么合适的值才能获得正确的结果吗？

提前致谢。

# javascript - 如何更改此 IF 以仅允许在两个数字之间进行选择？

> ID：11514676
> 
> 赞同：0
> 
> 时间：2012-07-17T00:55:34.437
> 
> 标签：javascript, jquery

我正在使用 jQuery 脚本，主要部分如下。它允许我选择最多 4 个项目。在做出 5 次选择之前，会出现一条错误消息。

如何更改此设置，以便在选项小于 2 且大于 5 时显示错误消息，并且在选项介于它们之间时显示成功消息？

```
if ($(this).multiselect("widget").find("input:checked").length > 5) {
    warning.addClass("error").removeClass("success").html("You can only check two checkboxes!");
    return false;
} else {
    warning.addClass("success").removeClass("error").html("Check a few boxes.");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:03:58.867

您可以将检查项目的数量放入局部变量，然后使用复合`if`语句对其进行多重比较：

```
var checkedItemsLength = $(this).multiselect("widget").find("input:checked").length;
if(checkItemsLength < 2 || checkItemsLength > 5 ) {
    warning.addClass("error").removeClass("success").html("You can only check two checkboxes!");
    return false;
} else {
    warning.addClass("success").removeClass("error").html("Check a few boxes.");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:03:49.867

```
var selections = $(this).multiselect("widget").find("input:checked");
if(selections.length < 2) {
     warning.addClass("error").removeClass("success").html("You have to check atleast two checkboxes!");
     return false;
} else if (selections.length > 5) {
     warning.addClass("error").removeClass("success").html("You can not check more then five checkboxes!");
     return false;
} else {
     warning.addClass("success").removeClass("error").html("Check a few boxes.");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:04:18.193

```
function doSomeChecking() {
  // assuming 'warning is a reference to some div or span
  var warning = $('#warning');
  var numChecked = $(this).multiselect("widget").find("input:checked").length;
  if (numChecked > 5) {
    warning.addClass("error").removeClass("success").html("You cannot check more than five boxes!");
    return false;
  } else if (numChecked < 2) {
    warning.addClass("error").removeClass("success").html("You must check at least two boxes.");
    return false;
  }
  warning.addClass("success").removeClass("error").html("Life is good.");
  return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T01:06:58.263

```
 if(foo < 2 || foo > 5){

   //do something

  }else {

  //do something else

  } 
```

# javascript - ExtJS4 JSON 数据未填充 Ext.grid.Panel

> ID：11514678
> 
> 赞同：0
> 
> 时间：2012-07-17T00:55:48.363
> 
> 标签：javascript, json, extjs

我看过很多关于这个问题的帖子，但由于某种原因我仍然遇到问题。我什至尝试用最少的数据创建一个面板，但仍然没有运气。这真是绞尽脑汁。下面是我正在使用的代码：

```
Ext.onReady(function () {
    var proxy = new Ext.data.HttpProxy({
        url: path/to/app
        api: {
            load: path/to/app
        }
    });

    var reader = new Ext.data.JsonReader({
        successProperty : 'success',
        idProperty      : 'id',
        root            : 'data',
        fields          : [{name:'id', type: 'int'}]
    });

    var writer = new Ext.data.JsonWriter({
        encode: false,
        writeAllFields: true
    });

    var store = new Ext.data.Store({
        autoLoad : true,
        autoSync : true,
        root     : 'data',
        restful  : true,
        fields   : [{name: 'id'}],
        proxy    : proxy,
        reader   : reader,
        writer   : writer
    });

    Ext.create('Ext.grid.Panel', {
        renderTo : 'gadgetview',
        store    : store,
        columns  : [{
                       header    : 'ID',
                       text      : 'ID',
                       dataIndex : 'id',
                       width     : 50
                   }],
        height   : 200,
        width    : 450,
        title    : 'Example'
    });
}); 
```

服务器的响应是：

```
{"data":[{"id":1}], "success":true} 
```

我希望这是显而易见的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:18:02.577

你的配置搞砸了。读取器/写入器是代理上的属性。根是阅读器的一个属性。

```
Ext.onReady(function() {

    var store = new Ext.data.Store({
        autoLoad: true,
        fields: [{
            name: 'id'
        }],
        proxy: {
            type: 'ajax',
            url: 'myurl',
            reader: {
                type: 'json',
                root: 'data'
            }
        }
    });

    Ext.create('Ext.grid.Panel', {
        renderTo: 'gadgetview',
        store: store,
        columns: [{
            header: 'ID',
            text: 'ID',
            dataIndex: 'id',
            width: 50
        }],
        height: 200,
        width: 450,
        title: 'Example'
    });
}); 
```

# c# - 在另一个文本框中键入时如何突出显示文本框中的文本？

> ID：11514679
> 
> 赞同：0
> 
> 时间：2012-07-17T00:55:48.847
> 
> 标签：c#, events, textbox

我正在制作一个有两个文本框的打字窗口程序，第一个是源文本文本框，它是只读的，另一个是用户可以输入源文本框中的文本的地方。

当用户在 TypingTextBox 中键入一个字母时，我希望该字母在 SourceTextBox 中突出显示。

我尝试在几个事件中这样做，但没有一个真正奏效：

```
SourceTextBox.Select(TypingTextBox.SelectionStart , 1); 
```

我什至尝试制作自己的活动，但也没有用。问题是，除非我单击它，否则我不会看到 SourceTextBox 突出显示。正如我所提到的，我尝试将上述代码放入以下事件中：SourceTextBox 中的 Mouse-Focus-Leave 和 TypingTextBox 中的 TextChanged。一切都没有工作.. :(

如果我能做到这一点，我可以改变高光颜色吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:17:26.520

假设这是 WinForm，您需要将 TextBox 上的 HideSelection 属性设置为“False”。至于改变高光颜色，我不知道。

# php - uniqid 每次返回相似的值

> ID：11514680
> 
> 赞同：2
> 
> 时间：2012-07-17T00:56:02.223
> 
> 标签：php

我以这种方式在 PHP 中生成 5 个字母的 uniqid：

```
$id = substr(uniqid(),0,5); 
```

每次我调用它时，我都会得到 value `5004b`。为什么会这样？

如果我删除`substr`，则该`5004b`部分保持不变，而其余部分发生变化。这不是严重降低了正在生成的 GUID 的熵吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T01:03:15.497

uniqid() 是基于 microtime() 的，开头会很长一段时间都是一样的。

我的建议是，如果您需要一个 5 位长的 uniqid，您只需每次增加或增加什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T01:26:28.333

`uniqid()`仅当您获得全部价值时才有效。取最后五个字符而不是第一个字符会更有意义：

```
$id = substr(uniqid(),-5); 
```

但是，一秒钟后，您将获得重复值。你真的应该把完整的`uniqid()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-04T11:45:38.050

如果您需要唯一 ID，请不要使用 uniqid()，因为它仅返回基于当前时间的 ID。如果您的计算机足够快，它将一次又一次地产生相同的值。

扩大熵（通过传递“true”作为第二个参数）会有所帮助，但它不能隐藏这个函数有缺陷的事实，并且不应在脚本中多次使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-29T07:28:41.173

你可以使用类似 substr(uniqid(rand(),1),0,7) 的东西。这会从随机种子生成唯一 ID。然后再次如果您将它们保存到数据库中，您可能需要在再次生成之前检查它们是否存在。执行以下操作：

```
function idExists($id){
//query database and check if the id already exists
}
//then use this to generate
$id=null;
   do{
$id=substr(uniqid(rand(),1),0,7); 
}while(idExists($id));
//then you get your unique id here 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T01:23:24.697

要增加输出的熵，可以使用`uniqid('', true);`. 根据文档，这“将在返回值的末尾添加额外的熵（使用组合的线性同余生成器），这增加了结果唯一的可能性。”

# php - MySQL RAND() 不工作，总是得到相同的结果

> ID：11514682
> 
> 赞同：0
> 
> 时间：2012-07-17T00:56:05.967
> 
> 标签：php, mysql, database, random

我有这个 MySQL 查询：

```
while ($x <= 9) {
   $data_1 = "SELECT scene FROM star WHERE star LIKE '%".$star."%' ORDER BY RAND() LIMIT  1";
   $result_1 = mysql_query ($data_1) OR die("Error: $data_1 </br>".mysql_error());

   while($row_1 = mysql_fetch_object($result_1)) {
      $scene = $row_1->scene;
      $x = $x + 1;
   }
} 
```

我想每次执行都获得一个新场景，但我总是得到相同的场景。什么问题？有人可以向我指出我必须搜索的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:58:28.133

您需要做的是将随机种子绑定到每一行，并每次绑定一个新种子。通过将随机值作为别名瞬态列分配给您的表来执行此操作，*然后*从中进行选择。

```
SELECT s.scene as scene FROM (
    SELECT stars.scene as scene, RAND() as seed 
      FROM stars
     WHERE star LIKE '%".$star."%' 
  ORDER BY seed
) s
LIMIT  1; 
```

使用[PDO](http://php.net/manual/en/book.pdo.php)，它看起来像这样：

```
function getScene() {
    $sql = 'SELECT s.scene as scene FROM ( SELECT stars.scene as scene, RAND() as seed FROM stars WHERE star LIKE '%:star%' ORDER BY seed ) s LIMIT  1;';
    $query = $this->db->prepare($sql);//'db' is the PDO connection
    $query->execute(array(':star' => "Allison Brie"));

    foreach ($conn->query($sql) as $row) {
        print $row['scene'] . "\t";
    }
} 
```

我不确定你想用你的其余代码来完成什么，但它看起来很糟糕。

# jquery - 如果在函数中使用，则返回未定义的值

> ID：11514686
> 
> 赞同：1
> 
> 时间：2012-07-17T00:57:30.817
> 
> 标签：jquery, function, undefined

我这里的代码有一点问题。我对它很陌生，所以如果它很简单，我很抱歉。但希望有一个解释。

所以这是我的html：

```
<div class="one" data-selection="1"></div>
<p class="selections"></p>
<p class="cost">£ <span class="price">0</span></p> 
```

这是JavaScript：

```
<script>
// Empty array to capture selections
    var a = [];
    var originalValue = "You have Selected section(s): ";  
    $(".one").click(function () {
        if ($(this).attr('class') == "selected one") {  
            //alert
            alert("Are you sure you wish to de-select?");       
            //remove from the total
            $(".price").html(parseInt($(".price").html(),10) - 30)  
            $(this).removeClass("selected ");   
            // need to get remove from array
            var removeItem = $(this).attr("data-selection");  
            a = jQuery.grep(a, function(value) {
                return value != removeItem;
            });      
            $('.selections').text(originalValue + a);   
        }
        else {
            var selection = $(this).attr("data-selection");
            alert(selection);
            var originalSrc = $(this).attr('class');
            $(this).attr('class', 'selected ' + originalSrc);     
            a.push(1);
            a.sort();           
            $('.selections').text(originalValue + a);   
            $('.price').text(function(i, txt) {
                return +txt + 30;
            });
        }
    });
</script> 
```

这工作正常。但是，当我将 if 语句的内容添加到一个名为的函数中时：

```
undoSelection() 
```

并将代码更改为：

```
$(".one").click(function () {
    if ($(this).attr('class') == "selected one") {
        undoSelection();
    }
    else { 
```

警报询问他们是否确定取消选择后没有任何内容。如果我在那里添加警报并得到

```
 $(this).attr("data-selection"); 
```

它警告未定义。

我希望它在一个函数中，因为我不想要一行行重复的代码:(

有人可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:01:32.547

那是因为你`$(this)`仍然被叫我打赌。关键字`this`表示`$(".one")`最初，但是`this`当您调用函数时，then 的上下文会发生变化。如果您希望它在另一个函数中工作，则需要将变量设置为的值`$(".one")`并使用它而不是`$(this)`在函数内部。

很难得到，但`this`javascript 中的关键字始终是指函数作为方法的对象。因此，在第一种情况下，这指的是，`$(".one")`如果您将另一个逻辑移动到另一个函数中，则定义会更改（更改为全局对象，通常是窗口）。

我为您创建了一个 jsFiddle，显示了您正在寻找的工作示例：http: [//jsfiddle.net/CKCjz/1/](http://jsfiddle.net/CKCjz/1/)

# c++ - 通过引用传递 const 指针

> ID：11514688
> 
> 赞同：18
> 
> 时间：2012-07-17T00:57:48.340
> 
> 标签：c++, reference, constants, implicit-conversion, pointer-conversion

我很困惑为什么以下代码无法编译

```
int foo(const float* &a) {
    return 0;
}
int main() {
    float* a;
    foo(a);

    return 0;
} 
```

编译器给出错误为：

> > 错误：从“float*”类型的表达式中对“const float*&”类型的引用进行无效初始化

但是当我尝试在 foo 中不通过引用传递时，它编译得很好。

我认为无论我是否通过引用，它都应该表现出相同的行为。

谢谢，

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-17T01:03:57.913

因为它不是类型安全的。考虑：

```
const float f = 2.0;
int foo(const float* &a) {
    a = &f;
    return 0;
}
int main() {
    float* a;
    foo(a);
    *a = 7.0;

    return 0;
} 
```

任何非`const`引用或指针必须在指向类型中保持*不变*，因为非`const`指针或引用支持读取（协变操作）和写入（逆变操作）。

`const`必须首先从最大间接级别添加。这会起作用：

```
int foo(float* const &a) {
    return 0;
}
int main() {
    float* a;
    foo(a);

    return 0;
} 
```

# python - 如何使用python将任何文件放入工件中？

> ID：11514693
> 
> 赞同：3
> 
> 时间：2012-07-17T00:58:44.197
> 
> 标签：python, artifactory, artifact

我有一个要求，任何文件都应该使用 python 语言放入工件中。我试图在整个互联网上搜索，但找不到任何帮助。

请分享代码片段或可以帮助我实现这一目标的东西。

非常感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-10-18T19:54:41.180

Artifactory python模块可用于将工件上传到artifactory。 [https://pypi.python.org/pypi/artifactory/0.1.17](https://pypi.python.org/pypi/artifactory/0.1.17)

这是用于将文件上传到工件的网站的示例：

```
from artifactory import ArtifactoryPath
path = ArtifactoryPath("http://my-artifactory/artifactory/libs-snapshotlocal/myapp/1.0")
path.mkdir()

path.deploy_file('./myapp-1.0.tar.gz') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-18T16:48:56.007

防御水果项目提供了与您正在寻找的 Artifactory 和 Python 的集成。 [http://teamfruit.github.io/defend_against_fruit/](http://teamfruit.github.io/defend_against_fruit/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T02:00:50.240

Artifactory 公开了一个 REST API。这是[文档](http://wiki.jfrog.org/confluence/display/RTF/Artifactory%27s+REST+API#ArtifactorysRESTAPI-DeployArtifact)的链接。请参阅“部署工件”部分。

基本上，您将需要构建一个 REST 客户端。Artifactory 可能已经存在一个？如果您需要自己编写，有一个 WADL 文件可能会使事情变得更容易（另请参阅[wadlib](http://pypi.python.org/pypi/wadllib/1.1.4)）。

# objective-c - NSScrollView 不适用于山狮

> ID：11514697
> 
> 赞同：4
> 
> 时间：2012-07-17T00:59:24.107
> 
> 标签：objective-c, macos, cocoa, osx-mountain-lion

我在 Mountain Lion 上测试我的应用程序，现在在我的 scrollView 上执行“setDocumentView”后，我的文档视图中没有显示任何内容。如果我删除“setDocumentView”，则显示 docView 的子视图，但显然我无法控制滚动。

知道他们改变了什么或为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T15:51:01.233

I was working on an IKImageView in a NSScrollView myself for some hours now. Adjusting the size of the document was not enough at all. But it works also fine under Mountain Lion. All I had to do was:

```
scroller.hasVerticalScroller = YES;
scroller.hasHorizontalScroller = YES; 
```

# c - 监控c中的主应用程序

> ID：11514703
> 
> 赞同：1
> 
> 时间：2012-07-17T01:00:43.277
> 
> 标签：c, multithreading, process, kernel

我已经完成了拥有 main() 方法和 main() 的程序 mainApp 创建 5 个线程，线程执行一些操作.. 等等。

现在我只是想知道我的程序是否崩溃。所以我要监控我的 mainApp 是否正在工作或停止。如果停止，我将重新启动/重新启动整个系统。

mainApp 和监控程序必须同时运行，并且监控程序应该检查 mainApp 的状态。

任何建议请。

PS：我是 om linux 内核 2.6.29。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:16:31.937

除非您想要一个通用监视器，否则您的程序可以监视自己。

当程序第一次启动时，程序本身就是监视器。由于程序刚刚启动，没有“mainApp”在运行，所以它自己分叉了。子进程承担“mainApp”的角色。监视器现在等待子进程终止。当子进程死亡时，它会检查状态，并决定重新启动，然后再次分叉。

```
int main () {
    /*...startup...*/
    int status;
    bool restart = true;
    while (restart) {
        pid_t pid = fork();
        switch (pid) {
        case -1: /* handle error */ exit(EXIT_FAILURE);
        case 0: exit(mainApp());
        default: break;
        }
        pid_t child = wait(&status);
        assert(child == pid);
        restart = check_status(status);
    }
    /*...cleanup...*/
    return 0;
} 
```

# google-apps-script - 谷歌应用程序脚本：内置电子表格函数在脚本中失败 - 语法错误？

> ID：11514704
> 
> 赞同：0
> 
> 时间：2012-07-17T01:01:04.060
> 
> 标签：google-apps-script

我正在学习 GAS 并想在我的脚本中使用电子表格函数。作为测试，我做了一个简单的案例，但在保存时抛出“参考错误：'Left'未定义。” 我查看了代码示例，但看不到替代语法。

```
function testLeft(){
  return LEFT("abcdef",3); 
} 
```

第二个简单的测试，同样的结果

```
function testNow(){
return Now()
} 
```

有什么建议么？我的猜测是脚本中有一种特殊的语法可以使用内置的电子表格函数。或者不是所有直接在电子表格中可用的函数都可以在 GAS 中使用？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:59:54.390

遗憾的是，Google Apps 脚本中不提供电子表格功能。在这种情况下，您可以使用 JavaScript 的[substring](http://www.w3schools.com/jsref/jsref_substring.asp) () 方法来获取您想要的字符串部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T09:47:33.380

这是我模拟中间函数的尝试

```
function fMid(varInStr, intPlace) {
//GAS does not have a Mid Function so I have made this one for now
//varInStr is the input string and you want a character returned from it at a given position
//intPlace is the position of the character you want
//Example
//=fMid("123456789", 9) returns "9"

var P
var N

P = intPlace -1
N = intPlace

return varInStr.substring(P,N)
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T10:04:23.490

我来自 VBA 背景，我找到了这个网站

[http://excelramblings.blogspot.co.uk/2012/05/google-apps-script-equivalents-for.html](http://excelramblings.blogspot.co.uk/2012/05/google-apps-script-equivalents-for.html)

由 Bruce Mcpherson 提供的许多现成的功能非常有用，可用于复制和粘贴到您的 Google App 脚本中，尤其是在您从 Excel 电子表格转换为 Google 电子表格时。

左的布鲁斯代码：

```
function Left(str,optLen) {
  return Mid( str, 1 , optLen);
} 
```

要使用上述 LEFT 功能，您还需要 Bruces Mid 功能：

```
function Mid (str,optStart,optLen) {
  var start = IsMissing (optStart) ? 0 : optStart - 1;
  var length = IsMissing (optLen) ?  Len(str) - start + 1 : optLen ;
  DebugAssert( str.slice, str + ' is not a valid string for Mid function');
  return  str.slice ( start, start + length); 
```

# javascript - 选择日期的客户端验证以在 asp.net 中显示文本框

> ID：11514706
> 
> 赞同：0
> 
> 时间：2012-07-17T01:01:15.247
> 
> 标签：javascript, jquery, .net, asp.net-mvc, validation

我正在尝试向日期文本框添加验证，如果选择的当前日期小于当前日期，则会出现一个文本框以获取更多信息。

我已经能够为其添加自定义验证，但它仅适用于点击提交按钮，我想知道是否有一种方法可以在选择以动态方式显示文本框时验证日期而不是点击提交按钮来生成文本框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-09T05:51:58.373

你可以为此编写脚本

```
$(function () {
    $('#textboxid').datepicker({ minDate: +0 });
}); 
```

# azure - Azure 表存储 RowKey 受限字符模式？

> ID：11514707
> 
> 赞同：38
> 
> 时间：2012-07-17T01:01:16.167
> 
> 标签：azure, azure-table-storage

Azure TableStorage RowKeys 中是否存在受限字符模式？我无法通过多次搜索找到任何记录。但是，在某些性能测试中，我得到的行为暗示了这种行为。

我对包含随机字符的 RowKeys 有一些奇怪的行为（测试驱动程序确实阻止了受限字符（/ \ # ？）加上阻止单引号出现在 RowKey 中）。结果是我有一个 RowKey 可以很好地插入到表中，但不能被查询（结果是 InvalidInput）。例如：

```
RowKey: 9}5O0J=5Z,4,D,{!IKPE,~M]%54+9G0ZQ&G34!G+ 
```

尝试通过此 RowKwy（相等）进行查询将导致错误（在我们的应用程序中，使用 Azure Storage Explorer 和 Cloud Storage Studio 2）。我查看了通过 Fiddler 发送的请求：

```
GET /foo()?$filter=RowKey%20eq%20'9%7D5O0J=5Z,4,D,%7B!IKPE,~M%5D%54+9G0ZQ&G34!G+' HTTP/1.1 
```

RowKey 中的 %54 似乎没有在过滤器中转义。有趣的是，对于使用包含此 RowKey 的批处理 XML 中的 URI 对表存储的批处理请求，我得到了类似的行为。我也看到了带有嵌入双引号的 RowKeys 的类似行为，尽管我还没有隔离这种模式。

有没有人遇到过这种行为？我可以轻松地限制其他字符出现在 RowKeys 中，但我真的很想知道“规则”。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-07-17T02:47:50.977

PartitionKey 和 RowKey 字段中不允许使用以下字符：

*   正斜杠 ( `/`) 字符
*   反斜杠 ( `\`) 字符
*   数字符号 ( `#`) 字符
*   问号 ( `?`) 字符

**进一步阅读**：[Azure Docs > 了解表服务数据模型](https://docs.microsoft.com/rest/api/storageservices/Understanding-the-Table-Service-Data-Model#characters-disallowed-in-key-fields)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2016-06-10T13:30:23.173

`public static readonly Regex DisallowedCharsInTableKeys = new Regex(@"[\\\\#%+/?\u0000-\u001F\u007F-\u009F]");`

Detection of Invalid Table Partition and Row Keys:

`bool invalidKey = DisallowedCharsInTableKeys.IsMatch(tableKey);`

Sanitizing the Invalid Partition or Row Key:

`string sanitizedKey = DisallowedCharsInTableKeys.Replace(tableKey, disallowedCharReplacement);`

At this stage you may also want to prefix the sanitized key (Partition Key or Row Key) with the hash of the original key to avoid false collisions of different invalid keys having the same sanitized value.

Do not use the string.GetHashCode() though since it may produce different hash code for the same string and shall not be used to identify uniqueness and shall not be persisted.

I use SHA256: [https://msdn.microsoft.com/en-us/library/s02tk69a(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/s02tk69a(v=vs.110).aspx)

to create the byte array hash of the invalid key, convert the byte array to hex string and prefix the sanitized table key with that.

Also see related MSDN Documentation: [https://msdn.microsoft.com/en-us/library/azure/dd179338.aspx](https://msdn.microsoft.com/en-us/library/azure/dd179338.aspx)

Related Section from the link: Characters Disallowed in Key Fields

The following characters are not allowed in values for the PartitionKey and RowKey properties:

> The forward slash (/) character
> 
> The backslash (\) character
> 
> The number sign (#) character
> 
> The question mark (?) character
> 
> Control characters from U+0000 to U+001F, including:
> 
> *   The horizontal tab (\t) character
>     
>     
> *   The linefeed (\n) character
>     
>     
> *   The carriage return (\r) character
>     
>     
> 
> Control characters from U+007F to U+009F

Note that in addition to the mentioned chars in the MSDN article, I also added the % char to the pattern since I saw in a few places where people mention it being problematic. I guess some of this also depends on the language and the tech you are using to access the table storage.

If you detect additional problematic chars in your case, then you can add those to the regex pattern, nothing else needs to change.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-12-12T09:18:36.697

我刚刚（艰难地）发现“+”号是允许的，但不能在 PartitionKey 中查询。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-12-06T12:37:22.950

我发现除了 Igorek 的答案中列出的字符之外，这些也会导致问题（例如插入会失败）：

*   |
*   []
*   {}
*   <>
*   $^&

使用 Azure Node.js SDK 进行测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-04-01T12:27:51.217

我使用此功能转换密钥：

```
private static string EncodeKey(string key)
{
    return HttpUtility.UrlEncode(key);
} 
```

当然，这需要为插入和检索完成。

# jboss7.x - 使用 JDK 7 构建项目的 JBoss AS 7 部署失败

> ID：11514709
> 
> 赞同：2
> 
> 时间：2012-07-17T01:01:31.783
> 
> 标签：jboss7.x, java-7

我使用 JBoss 7.1.1 Final 并且我正在使用 Eclipse Juno 中的 JDK 7 构建我的项目（使用 ant 脚本）。部署时加载 EJB 失败。我正在为 MAC OS 使用 Oracle JDK 1.7.0_05

这是堆栈跟踪：

> （MSC 服务线程 1-2）**无法在服务模块加载器的模块“deployment.TEST.war:main”中定义类 com.test.ReportManager：java.lang.UnsupportedClassVersionError：** com/test/ReportManager：**不支持的 major.minor 版本51.0**

```
at java.lang.ClassLoader.defineClass1(Native Method) [classes.jar:1.6.0_33]
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631) [classes.jar:1.6.0_33]
at java.lang.ClassLoader.defineClass(ClassLoader.java:615) [classes.jar:1.6.0_33]
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141) [classes.jar:1.6.0_33]
at org.jboss.modules.ModuleClassLoader.doDefineOrLoadClass(ModuleClassLoader.java:327) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ModuleClassLoader.defineClass(ModuleClassLoader.java:391) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ModuleClassLoader.loadClassLocal(ModuleClassLoader.java:243) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ModuleClassLoader$1.loadClassLocal(ModuleClassLoader.java:73) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.Module.loadModuleClass(Module.java:517) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:182) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398) [jboss-modules.jar:1.1.1.GA]
at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120) [jboss-modules.jar:1.1.1.GA]
at org.jboss.as.ejb3.deployment.processors.BusinessViewAnnotationProcessor.getEjbClass(BusinessViewAnnotationProcessor.java:225)
at org.jboss.as.ejb3.deployment.processors.BusinessViewAnnotationProcessor.deploy(BusinessViewAnnotationProcessor.java:97)
at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [classes.jar:1.6.0_33]
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [classes.jar:1.6.0_33]
at java.lang.Thread.run(Thread.java:680) [classes.jar:1.6.0_33] 
```

任何想法是什么原因？

谢谢，卢卡斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T15:38:02.353

你有两个选择。

1.  配置构建以创建兼容 jdk6 的字节码。
2.  使用 jdk7 在 jboss 中运行您的应用程序。

从堆栈跟踪看起来您正在运行 jdk6 u33 而不是 jdk7 并且字节码不兼容

# websocket - websocket在打开握手后断开

> ID：11514712
> 
> 赞同：2
> 
> 时间：2012-07-17T01:01:53.627
> 
> 标签：websocket

我想保持 websocket 连接处于活动状态。
我使用 RFC 6455 协议作为 websocket 协议。
我通过 Firefox 13 和 Chrome 20 对此进行了测试。

===WEB SOCKET 客户端===

```
GET / HTTP/1.1
Host: #.#.#.#:#
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:13.0) Gecko/20100101 Firefox/13.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: ko-kr,ko;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: keep-alive, Upgrade
Sec-WebSocket-Version: 13
Origin: http://its.secret.com
Sec-WebSocket-Key: TbJqTlFtGocvRvk/9stMhg==
Pragma: no-cache
Cache-Control: no-cache
Upgrade: websocket 
```

===网络套接字服务器===

```
HTTP/1.1 101 WebSocket Protocol Handshake
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: outIACgIETcILj0NjzA0MhwP7uc= 
```

这个 websocket 协议中的换行符是 CR/LF。

接下来是websocket客户端源码部分。

```
var host = "ws://#.#.#.#:#";
try {
    Rsocket = new WebSocket(host);
    Rsocket.onopen = function(msg) {
        alert("Welcome - status " + this.readyState);
    };
    Rsocket.onmessage = function(msg) {...
    };
    Rsocket.onclose = function(msg) {
        alert("Disconnected - status " + this.readyState);
    };
}
catch (ex) {
    log(ex);
}​ 
```

首先，成功警报出现在 Web 浏览器中。
按下 OK 后，会出现断开连接警报。

尽管在出现成功警报时按 OK，但我希望不出现断开连接警报。

# mysql - 在使用 MySQL 的 Trigger 中使用 Prepared Statement 的替代方法

> ID：11514713
> 
> 赞同：3
> 
> 时间：2012-07-17T01:01:53.307
> 
> 标签：mysql, triggers, prepared-statement

我正在尝试使用以下代码创建一个 MySQL Before Insert 触发器，如果​​我能找到一种方法来执行由触发器生成的准备好的语句，它将执行我希望它执行的操作。

是否有任何替代方法可以从触发器中执行准备好的语句？谢谢

```
BEGIN
    SET @CrntRcrd = (SELECT AUTO_INCREMENT FROM information_schema.TABLES 
              WHERE TABLE_SCHEMA=DATABASE()
              AND TABLE_NAME='core_Test');

  SET @PrevRcrd = @CrntRcrd-1;

    IF (NEW.ID IS NULL) THEN
        SET NEW.ID = @CrntRcrd;
    END IF;

    SET @PrevHash = (SELECT Hash FROM core_Test WHERE Record=@PrevRcrd);

    SET @ClmNms = (SELECT CONCAT('NEW.',GROUP_CONCAT(column_name 
                  ORDER BY ORDINAL_POSITION SEPARATOR ',NEW.'),'')
                  FROM information_schema.columns 
                  WHERE table_schema = DATABASE() 
                  AND table_name = 'core_Test');

  SET @Query = CONCAT("SET @Query2 = CONCAT_WS(',','",@PrevHash,"','", @CrntRcrd, "',", @ClmNms, ");");

  PREPARE stmt1 FROM @Query;
  EXECUTE stmt1;
  DEALLOCATE PREPARE stmt1; 

  SET NEW.Hash = @Query2;
END 
```

**更新/澄清**：数据将存储在下表中。

```
+------------+-----+------+----------------+
| Record (AI)| ID  | Data | HASH           |
+------------+-----+------+----------------+
| 1          | 1   | ASDF | =DHFBGKJSDFHBG | (Hash Col 1)
| 2          | 2   | NULL | =UEGFRYJKSDFHB | (Hash Col 1 + Col 2)
| 3          | 1   | VBNM | =VKJSZDFVHBFJH | (Hash Col 2 + Col 3)
| 4          | 4   | TYUI | =KDJFGNJBHMNVB | (Hash Col 3 + Col 4)
| 5          | 5   | ZXCV | =SDKVBCVJHBJHB | (Hash Col 4 + Col 5)
+------------+-----+------+----------------+ 
```

在每个插入命令上，该表将通过将前一行的哈希值应用到整个新行的 CONCAT() 中，然后重新对整个字符串进行哈希处理，从而为该行生成一个哈希值。这将创建哈希值的运行记录，用于审计目的/在应用程序的另一部分中使用。

我的限制是这必须在 INSERT 之前完成，因为之后无法更新行。

**更新**：我目前正在使用以下代码，直到找到一种将列名动态传递给 CONCAT 的方法：

```
BEGIN

  SET @Record = (
    SELECT AUTO_INCREMENT FROM information_schema.TABLES 
    WHERE TABLE_SCHEMA=DATABASE()
    AND TABLE_NAME='core_Test'    #<--- UPDATE TABLE_NAME HERE
  );
  SET @PrevRecrd = @Record-1;

    IF (new.ID IS NULL) THEN
    SET new.ID = @Record;
  END IF;

  SET @PrevHash = (
    SELECT Hash FROM core_Test    #<--- UPDATE TABLE_NAME HERE
    WHERE Record=@PrevRecrd
  );

  SET new.Hash = SHA1(CONCAT_WS(',',@PrevHash, @Record,
    /* --- UPDATE TABLE COLUMN NAMES HERE (EXCLUDE "new.Record" AND "new.Hash") --- */
    new.ID, new.Name, new.Data
  ));

END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:58:54.030

简短的回答是您不能在 TRIGGER 中使用动态 SQL。

我对 auto_increment 值的查询感到困惑，并为 ID 列分配了一个值。我不明白为什么需要设置 ID 列的值。那不是定义为AUTO_INCREMENT的列吗？数据库将处理分配。

也不清楚您的查询是否保证返回唯一值，尤其是在运行并发插入时。（我没有测试过，所以它可能有效。）

但是代码很奇特。

看起来您想要完成的是从最近插入的行中获取列的值。我认为查询定义触发器的同一个表有一些限制。（我知道甲骨文肯定有；MySQL 可能更自由。）

如果我需要做类似的事情，我会尝试这样的事情：

```
 SELECT @prev_hash := t.hash AS prev_hash 
   FROM core_Test t
  ORDER BY t.ID DESC LIMIT 1;

 SET NEW.hash = @prev_hash; 
```

但同样，我不确定这会奏效（我需要测试）。如果它适用于一个简单的案例，那并不能证明它一直有效，在并发插入的情况下，在扩展插入的情况下，等等。

我按照我的方式编写查询，以便它可以利用 ID 列上的索引来执行反向扫描操作。如果它不使用索引，我会尝试重写该查询（可能作为 JOIN，以获得最佳性能。

```
 SELECT @prev_hash := t.hash AS prev_hash
   FROM ( SELECT r.ID FROM core_Test r ORDER BY r.ID DESC LIMIT 1 ) s
   JOIN core_Test t
     ON t.ID = s.ID 
```

* * *

摘自 MySQL 5.1 参考手册
E.1 对存储程序的限制

> SQL 准备语句（PREPARE、EXECUTE、DEALLOCATE PREPARE）可用于存储过程，但**不能**用于存储函数或 **触发器。**因此，存储函数和触发器不能使用动态 SQL（您将语句构造为字符串然后执行它们）。 [[原文如此]](https://dev.mysql.com/doc/refman/5.7/en/stored-program-restrictions.html)

# iphone - iPhone将退出事件上的文本字段结束连接到按钮按下事件

> ID：11514714
> 
> 赞同：1
> 
> 时间：2012-07-17T01:01:59.947
> 
> 标签：iphone, uitextfield

我有一个文本字段和一个按钮。当按钮被按下时，它会调用一个例程。我希望退出时的文本字段结束调用相同的例程，而不必复制代码。ViewController.h 在下面

```
 #import <UIKit/UIKit.h>

@interface ViewController : UIViewController
@property (weak, nonatomic) IBOutlet UIWebView *webView;
@property (weak, nonatomic) IBOutlet UIActivityIndicatorView *activityind;
@property (weak, nonatomic) IBOutlet UITextField *search;

- (IBAction)calculate:(id)sender;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:26:22.390

在 ViewController.h 中像这样实现 UITextFieldDelegate ：

```
@interface ViewController : UIViewController <UITextFieldDelegate> 
```

然后使用方法

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField 
```

并调用您的 IBAction 和 resignFirstResponder，我还会自动启用返回键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T03:16:22.643

**[编辑1]**

在您的 viewController 标头中：

```
@interface ViewController : UIViewController <UITextFieldDelegate>
@property (weak, nonatomic) IBOutlet UIWebView *webView;
@property (weak, nonatomic) IBOutlet UIActivityIndicatorView *activityind;
@property (weak, nonatomic) IBOutlet UITextField *search;

-(void)doSomeWork;
-(IBAction)calculate:(id)sender;

@end 
```

只需在第二层例程中实现该功能。

在您的 viewController.m 文件中：

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField{
    if(search == textField){
        [textField resignFirstResponder];
        [self doSomeWork];
    }
    return YES;
}

-(void)doSomeWork{
    // Do whatever you want to do here!!!
}

-(IBAction)calculate:(id)sender{
    [self doSomeWork];
} 
```

在您的 xib 文件中，您必须将按钮连接到“计算”操作，搜索到正确的 UITextField。

您可以在 Interface Builder 中以图形方式或在代码中设置 UITextField 的委托。如果在代码中，则在 viewController.m 文件中添加以下行：

```
search.delegate = self; 
```

到您的 viewDidLoad 方法如下：

```
-(void)viewDidLoad{
    [super viewDidLoad];
    search.delegate = self;
} 
```

# c# - 使asp.net Web应用程序自行更新的可能性是多少？

> ID：11514715
> 
> 赞同：1
> 
> 时间：2012-07-17T01:02:01.097
> 
> 标签：c#, asp.net, auto-update

我有一个 Web 应用程序，我希望它检查更新、下载并安装它们。

我知道已经有一些适用于 Windows 应用程序的更新程序框架，但是否可以用于 Web 应用程序？

想到这里，我首先想到的是：

文件权限*（由于文件权限，我可能无法替换我的所有应用程序文件）*

触摸 web.config 或 bin 文件夹也会导致应用程序重新启动。

我还考虑过从我的 Web 应用程序执行一个 exe 来完成这项工作，但我不知道它是否会因为重新启动 Web 应用程序而关闭。

我将不胜感激该案例的任何想法或解决方案。

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-17T07:04:46.097

看看[WebDeploy](http://www.iis.net/download/WebDeploy)

它旨在简化此类任务。您要将发布部署到生产服务器的位置。

与其让您的服务器检查更新并自行更新，不如在您拥有更新时将更新推送给它会更简单。

> 通过检测源内容和目标内容之间的差异并仅传输那些需要同步的更改，Web Deploy 允许您跨 IIS 7.0 服务器场有效地同步站点、应用程序或服务器。该工具通过自动确定要为特定站点同步的配置、内容和证书来简化同步过程。除了默认行为之外，您还可以选择为同步指定其他提供程序，包括数据库、COM 对象、GAC 程序集和注册表设置。

*   部署 Web 应用程序不需要管理权限。
*   服务器管理员可以精细控制可以执行的操作，并且可以将任务委派给非管理员。

不过，这需要您运行 IIS7。

# javascript - __hash__ 用于 JavaScript？

> ID：11514716
> 
> 赞同：2
> 
> 时间：2012-07-17T01:02:06.133
> 
> 标签：javascript, python, hash, associative-array, dictionary

有没有办法在 js 自定义哈希中赋予对象，就像覆盖一样

```
__hash__() 
```

在 python 中，让我们定义如何将给定对象散列到字典中。

我的基本问题是：什么哈希函数用于将 js 对象放入关联数组中，我可以覆盖它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T01:16:35.420

您的意思是使用对象作为键，您如何确保再次访问该键？

神奇的方法是`toString()`。原来 JS 中的所有对象都使用字符串键，`toString()`如果它不是字符串，则调用该方法。

[http://jsfiddle.net/udsdT/1/](http://jsfiddle.net/udsdT/1/)

```
var objA = {
    data: 'yay',
    toString: function() {
        return 'value_as_key';
    }
};

var objB = {
    data: 'some other totally data thing',
    toString: function() {
        return 'value_as_key';
    }
}

var foo = {};
foo[objA] = 'abc';
foo[objB] = 'def';
foo['value_as_key'] = 'qwe';
foo.value_as_key = 'omg';

foo[objA];           // 'omg'
foo[objB];           // 'omg'
foo['value_as_key']; // 'omg'
foo.value_as_key;    // 'omg' 
```

​​​​​​虽然通常，你真的不想使用整个对象作为键。特别是如果您不创建自己的`toString()`方法，因为基本对象的默认`toString()`方法并不是非常棒......

```
({a:123}).toString() // [object Object]
({b:456}).toString() // [object Object]

var foo = {};
foo[{a:123}] = 'wtf';
foo[{asdf:9876}];       // 'wtf'
foo['[object Object]']; // 'wtf 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:11:26.330

在 JS 中，您无法控制散列，但您不必这样做。

如果它们相等，则两件事是相同的。哈希不是定义的一部分，它只是一个实现细节。在幕后，两个不同的对象可能具有相同的散列，但它们仍然不同，实现必须神奇地处理这个问题（例如，通过使用链式散列表）。

此外，对象的键始终是字符串——解释器将在散列构造函数内、在 内`[]`或在 之后对值进行字符串化`.`，而不是存储实际值，这意味着这种情况一开始很少出现。

举一些例子：

```
function X() {}
x = new X()
y = new Y()
h = {x: 2, y: 3} // h has 2 members, named "x" and "y"

a = (x, y)
b = (x, y)
h[a] = 4
h[b] = 5 // h has 3 members, named "x", "y", and "[object Object]" 
```

用 Python 术语来说，就好像 dict 调用`__repr__`键而不是`__hash__`（尽管这不是 100% 准确），这意味着您可以提供自定义`toString`方法来控制类的不同实例的相等性。

# java - AJAX POST 请求在 Spring MVC 上返回 404

> ID：11514720
> 
> 赞同：0
> 
> 时间：2012-07-17T01:02:23.217
> 
> 标签：java, json, jquery, spring-mvc, spring-3

我正在开发一个项目，我需要使用 AJAX 向 Spring 控制器提交一个 JSOn 对象。但我在提交时收到 404。拜托，谁能告诉我问题是什么：

我的 AJAX 请求：

```
 $.ajax({
        url: 'NewTestApp/chkDetails/',
        type : 'POST',
        data : 'pwd='+ p,       
        timeout: 15000,
        async : false,
        dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    displayThings(data);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $('#error').show();
            }
        });
    }
} 
```

我的控制器：

```
@RequestMapping(value = "/chkDetails", method = RequestMethod.POST)
@ResponseBody
public JSONObject getDetails(@RequestParam(value = "pwd")Object sPassword) throws IOException, ParseException
{
    JSONObject obj = (JSONObject) JSONValue.parse(sPassword.toString());
    JSONObject retObj;

    if(obj.isEmpty())
    {
        System.out.println("hihi");
    }       
    retObj = chk.chkStrength(obj);
    return retObj;  
} 
```

我的 web.xml ：

```
<servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>
        org.springframework.web.servlet.DispatcherServlet
    </servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>*.html</url-pattern>
</servlet-mapping>
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/spring-servlet.xml</param-value>
</context-param> 
```

和我的 spring-servlet.xml ：

```
<context:component-scan
    base-package="main.pwd.controller" />

<bean id="viewResolver"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="suffix" value=".jsp" />
    <property name="prefix" value="/WEB-INF/jsp/" />
</bean>

<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="urlMap">           
        <map>
            <entry key="/checkDetails.html">
                <ref bean="PasswordServiceController"/>
            </entry>
        </map>
    </property>

</bean>
  <bean id="PasswordServiceController" class="main.pwd.controller.PasswordServiceController"> </bean> 
```

我对春天很陌生，这是我的第一个项目。很确定我在映射上做错了什么。

如果目录结构有帮助：

新测试应用 | 网页内容 | |-WEB-INF | | | |-web.xml | |-spring-servlet.xml | |-jsp | | | |- checkDetails.jsp |-index.jsp

index.jsp 能够调用 checkDetails.jsp。此外，AJAX JSON 提交没有问题，当 m 不将其实现为 Spring MVC 时，应用程序运行良好。

我需要为它添加另一个映射吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:09:42.030

您的调度程序 servlet 的 servlet 映射是 *.html，因此您的请求也应该`/NewTestApp/chkDetails.html`由 Spring 控制器处理。如果您希望它被处理，`/NewTestApp/chkDetails`那么调度程序 servlet 映射应该是`/`

# c# - CLR 如何在线程池线程中运行 beginXXX？

> ID：11514722
> 
> 赞同：1
> 
> 时间：2012-07-17T01:02:57.257
> 
> 标签：c#

我试图弄清楚 CLR 如何将异步操作 BeginXXX 放入线程池的队列中。以及调用哪个 ThreadPool 的 API。但是，当我用 Reflector 6 探查 System.IO.Stream 中的 BeginRead()
和 System.Data.Sqlclient.SqlCommand 中的 BeginExecuteReader() 时，我什么也没找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:32:54.150

许多异步操作使用已打开用于 I/O 完成端口、重叠操作或包装在托管`WaitHandle`.

在这些情况下，可能是该类使用`ThreadPool.BindHandle`, 或者`ThreadPool.RegisterWaitForSingleObject`不是`ThreadPool.QueueUserWorkItem`为了安排在线程池线程上发生完成回调的异步操作。

# ruby-on-rails-3 - 在 Rails 中按用户名正确路由短 url

> ID：11514723
> 
> 赞同：3
> 
> 时间：2012-07-17T01:02:59.570
> 
> 标签：ruby-on-rails-3, rails-routing

我正在尝试替换此类用户个人资料视图

`/users/1`

和

`/username`

我知道这意味着我需要检查各种碰撞。我已经咨询了以下类似的 SO 问题：

*   [Ruby on rails 路由匹配用户名](https://stackoverflow.com/questions/5611649/ruby-on-rails-routing-matching-username)
*   [使用用户名自定义 rails url](https://stackoverflow.com/questions/2269885/username-in-url-with-rails-routes)
*   [Rails 中的路由使用户名成为 URL：](https://stackoverflow.com/questions/11048063/routing-in-rails-making-the-username-an-url)
*   [路由错误：url 中的用户名](https://stackoverflow.com/questions/5204057/routing-error-with-username-in-url)

以下是我尝试过的各种失败的 routes.rb 路由定义，以及相关的错误：

1.  `match "/:username" => "users#show", via: "get"`

    这是错误：

    ```
    ActiveRecord::RecordNotFound in UsersController#show

    Couldn't find User without an ID

    app/controllers/users_controller.rb:7:in `show' 
    ```

    这是我对应的users_controller：

    ```
    6 def show
    7   @user = User.find(params[:id])
    8 end 
    ```

2.  `match "/:username" => 'users#show', :as => :profile`

    与上述相同的错误。

3.  `match "/:username", :controller => "users/:id", :action => 'show'`

    ```
     Routing Error

     uninitialized constant Users

     Try running rake routes for more information on available routes. 
    ```

4.  `match '/:username', :controller => 'users', :action => 'show'`

    与 1 相同的错误。

5.  `match '/:username', to: 'users/:id', via: 'show'`

    服务器没有启动。

6.  `match "/:username" => redirect("/users/:id")`

    错误：

    ```
     ActiveRecord::RecordNotFound in UsersController#show

     Couldn't find User with id=:id 
    ```

知道为什么我的路由与其他提出这个问题的人的工作方式不同吗？

**更新**

只是为了把这个问题从评论中拿出来，更干净地放在问题中。在下面由@Ryan Bigg 进行更改后，我在创建新配置文件时重定向到配置文件时遇到了路由问题。这是我的创建代码：

```
 def create
    @user = User.new(params[:user])
    if @user.save
        session[:user_id] = @user.id
        flash[:success] = "Thank you for signing up."
        redirect_to ('/'+@user.username)
        #redirect_to @user, notice: "Thank you for signing up!"
    else
        render "new"
    end
  end 
```

这是我的 user.rb

```
def to_param
    self.username
    #username
end 
```

但是，注释掉的重定向（我认为它应该与 to_param 更新一起使用）不起作用，而上面那个丑陋的 hackish 则不起作用。为什么对其他人有效的 to_param 覆盖[在](https://stackoverflow.com/questions/5611649/ruby-on-rails-routing-matching-username?lq=1)我的应用程序上无效？我的 #update 和 #edit 方法也不起作用，因为如果覆盖 to_param 不能解决这个问题，它们的重定向会转到“users/1/edit”而不是“username/edit”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:43:56.153

第一个是正确的，但由于您仍在尝试在控制器中执行类似操作，因此无法正常工作：

```
User.find(params[:username]) 
```

当你应该这样做时：

```
User.find_by_username!(params[:username]) 
```

第一个将尝试通过表的主键查找，而第二个将正确地查询用户名字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T21:27:01.153

除了 to_params 的更新之外，路由文件的底部还需要以下行：

`resources :users, :path => '/'`

# video - 有没有办法在 Love2D 中渲染编码/压缩的视频文件？

> ID：11514736
> 
> 赞同：0
> 
> 时间：2012-07-17T01:04:38.733
> 
> 标签：video, lua, love2d

我正在尝试通过直接进入并制作游戏来学习 Love2D 和 Lua，我想知道是否可以在 Love2D 中对编码的视频文件进行实际视频播放。还是我应该放弃它并为我的介绍和过场动画绘制一系列图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:27:13.323

根据[这个论坛帖子](https://love2d.org/forums/viewtopic.php?f=4&t=7552)，看起来答案是否定的。你*也许*可以使用 GStreamer 一起破解一些东西，但这只能在 Linux 上运行；我认为 DirectShow 或 Quicktime 不存在绑定，因此这条路线可能甚至不值得探索。

也就是说，如果你的介绍足够华丽，值得切换框架，看起来 Moai 确实包含[对电影播放的基本支持](http://getmoai.com/docs/class_m_o_a_i_movie_player_android.html)。

# ruby-on-rails - Rails 中的批量分配和角色

> ID：11514738
> 
> 赞同：-1
> 
> 时间：2012-07-17T01:05:17.690
> 
> 标签：ruby-on-rails, mass-assignment, attr-accessible

我`Users, Roles, and Network`在 Rails 3 中有模型，`Users`并且`Networks`通过`Roles`. 如果一个`User`具有特定`Role`类型的“管理员” `Network`，他/她可以更改`Role`其他的`Users`。

似乎该`Role`类型不应该通过批量分配获得。那么`Network`管理员如何更改 other 的职位类型`Users`？我实际上认为这是一个非常基本的问题，但我找不到答案。

我正在使用 CanCan 并且有一个 current_user 方法。这是否仅仅意味着控制器将有一个简单的 if/then 检查用户是否在网络中具有适当的角色？

批量分配是否仅适用于没有身份验证的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:39:03.210

所以有几件事

1.  如果用户是管理员，您可能会在 users/1/edit 页面上显示角色选择框
2.  在控制器上的更新操作中，您将获得某种授权以确保用户是管理员
3.  到时候进行更新

：

```
class myModel < ActiveRecord::Base
  attr_accessible :some_attr, :other_attr
  attr_accessible :some_attr, :other_attr, :role_id, :as => :admin
end

class myController < ApplicationController
  #admin check before doing the following
  if @user.update_attributes(params[:user], :as => :admin)
    redirect_to root_path
  end
end 
```

# objective-c - 我应该释放我创建的 NSThread 吗？

> ID：11514739
> 
> 赞同：1
> 
> 时间：2012-07-17T01:05:26.727
> 
> 标签：objective-c, ios, memory-management

这点我可能想多了。

```
// Inside some method...
NSThread *thread = [[NSThread alloc] initWithTarget:functionWrapper selector:@selector(run) object:nil];
[thread start]; 
```

在此之后调用`[thread release]`：A. 避免内存泄漏并且是必要的，或者...... B. 会破坏事物。

[这个问题](https://stackoverflow.com/questions/6035177/how-to-release-a-nsthread-is-there-any-particular-process-to-release)的答案表明线程在完成执行后会释放自己，但是该行为记录在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T01:13:21.803

是的，您必须在一段时间后通过自动发布或发布来发布它。

但是，您实际上并不需要首先初始化自己的线程，objective-c 有很多方法可以让您实现线程，而无需自己分配新线程，例如

```
[self performSelectorInBackground:@selector(yourMethod) withObject:nil]; 
```

还有一些 NSOperations 也允许您将任务排队。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T01:08:59.060

作为一般规则：**如果对对象调用 alloc、new 或 copy，则必须释放它。**

一旦该线程的生命周期完成（或在您的 dealloc 函数中），调用`[thread release]`.

与您链接到的答案不同，您会看到他在字符串末尾有自动释放（自动释放是上述规则不适用的实例，在这些情况下，对象将在结束时自动释放当前主运行循环，使其在整个当前范围内都处于活动状态）。

# x86 - x86 - 将权限级别从 CPL0 更改为 CPL3

> ID：11514740
> 
> 赞同：4
> 
> 时间：2012-07-17T01:05:27.773
> 
> 标签：x86, privilege

我正在研究一些低级操作系统代码（64 位），并且试图弄清楚如何从 CPL0 切换到 CPL3。问题是我遇到的英特尔开发人员手册中的这个小句子：''......处理器不允许将程序控制从以 0,1 或 2 的 CPL 运行的过程转移到以 0,1 或 2 运行的过程CPL 或 3，返回时除外。"

TSS（任务状态段）甚至没有堆栈指针，那么 CPL3 代码将用于堆栈吗？我知道这是可能的（否则操作系统将如何启动任何应用程序代码）但我找不到任何文档。似乎您必须将一些 CPL3 代码的地址推送到堆栈上以欺骗处理器运行 CPL3 代码，但这听起来有点草率。你们知道更好的方法吗？任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T14:11:21.357

在 x86 中，如果你想将控制权从更高的特权级传递回更低的特权级，你必须使用 iret 指令。根据 iret 指令预期的结构（ss、esp、eflags、cs && eip）手动创建栈顶并调用 iret。

请注意，示例适用于 x86。x64 采用相同的方式，但使用另一个注册器，并且预期的堆栈布局可能略有不同。

```
VOID FASTCALL JumpFromCr0ToCr3(CONST ULONG cr3_eip, CONST USHORT cr3_cs , CONST ULONG cr3_flags, CONST ULONG cr3_esp, CONST USHORT cr3_ss)
{
    __asm
    {                               //        |     |
        push dword ptr [ESP + 0xC]; // ss     |  eip|<- stack pointer before iretd 
        push dword ptr [ESP + 0xC]; // esp    |   cs|
        push dword ptr [ESP + 0xC]; // flags  |flags|
        push            EDX       ; // cs     |   cs|
        push            ECX       ; // eip    |  eip|
                                  ;           -------
        iretd                     ;             top
    }
} 
```

# ruby-on-rails - Rails 3 模型关注模块

> ID：11514744
> 
> 赞同：6
> 
> 时间：2012-07-17T01:05:58.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3

首先，我正在遵循此处针对 Rails 问题的做法（好主意！）：[https ://gist.github.com/1014971](https://gist.github.com/1014971)

我收到一个错误：

```
undefined method `search' for #<Class:0x5c25ea0>
app/controllers/accessories_controller.rb:6:in `index' 
```

我确实在**/config/application.rb**中加载了我的 /app/models/concerns/ 目录。所以“关注”模块正在被加载。只是想指出这一点。

这是我的代码：

**/app/models/concerns/searchable.rb**

```
module Searchable
  extend ActiveSupport::Concern

  # Add a "search" scope to the models
  def self.search (search)
    if search
      where('name LIKE ?', "%#{search}%")
    else
      scoped
    end
  end
end 
```

**/app/models/accessory.rb**

```
class Accessory < ActiveRecord::Base
  include Searchable

  ...
end 
```

**/app/controllers/accessories_controller.rb**

```
class AccessoriesController < ApplicationController

  def index
    @accessories  = Accessory.search(params[:search])

    ...
  end

end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T01:34:10.333

好吧，再玩一会，我就知道出了什么问题！

当您想从模块中直接修改模型时（关注），您需要将功能包装在**包含**的块中。

我已将我的关注模块更改为以下内容：

```
 module Searchable
        extend ActiveSupport::Concern

        included do
            # Add a "search" scope to the models
            def self.search (search)
                if search
                    where('name LIKE ?', "%#{search}%")
                else
                    scoped
                end
            end
        end

    end 
```

这就对了！希望这会帮助其他有同样问题的人！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-12T13:58:32.550

这是一个不错的解决方案，但并不是*最好*的解决方案。当您在其上构建模块时，`ActiveSupport::Concern`您可以在您的关注点中包装一个调用`ClassMethods`的模块，并且任何包含您关注点的模块都将自动使用该`ClassMethods`模块进行扩展。

那么，更好的解决方案是：

```
module Searchable
  extend ActiveSupport::Concern

  module ClassMethods
    def search(search)
      if search
        where('name LIKE ?', "%#{search}%")
      else
        scoped
      end
    end
  end
end 
```

那（IMO）更清楚地表达了您的意图：将类级方法放入类中。

虽然您的方法有效，`included`但当您需要在调用类上调用方法时，最好使用该方法。例如，您可以坚持让您的`Searchable`对象具有 db-backed`name`属性，如下所示。该`included`方法是将`presence`验证器添加到调用类中，并且您用于扩展该类的方法是明确分开的。

```
module Searchable
  extend ActiveSupport::Concern

  def self.included(base)
    base.send :validates_presence_of, :name
  end

  module ClassMethods
    def search(search)
      if search
        where('name LIKE ?', "%#{search}%")
      else
        scoped
      end
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-04T21:29:52.187

正如[AndyV 指出](https://stackoverflow.com/a/15973278/356895)的那样，正确的解决方案是：

```
module Searchable
  extend ActiveSupport::Concern

  module ClassMethods
    def search(search)
      if search
        where('name LIKE ?', "%#{search}%")
      else
        scoped
      end
    end
  end
end 
```

并且不像您在解决方案中所做的那样`self.search`在块中定义，这更冗长且不那么明确。`included`

但我不同意 AndyV 在`self.included`. 如果你使用`ActiveSupport::Concern`，那是有`included`块语法糖，所以你应该使用它。我只依赖于`self.included`我调用的方法的顺序或我定义的方法的重要性。

# jquery-mobile - JQuery Mobile 将样式应用于新添加的元素

> ID：11514749
> 
> 赞同：0
> 
> 时间：2012-07-17T01:07:21.983
> 
> 标签：jquery-mobile

在 JQuery Mobile 中，我有一个导航栏，如下所示：

```
<div id="nav_bar" data-role="navbar">
    <ul>
        <li><a>video</a></li>
        <li><a>music</a></li>
        <li><a>picture</a></li>
    </ul>
</div> 
```

现在说我希望导航栏只显示“一些内容”。这是我的代码：

```
$("#nav_bar ul").html("<li><a>some content</a></li>"); 
```

但是内置的 JQuery Mobile 样式不适用于它。我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:39:43.233

打开页面时，会运行一个脚本来添加所有必要的类。替换项目不会重新运行脚本。

我认为如果不通过在文本中指定类/使用变量或以下内容手动添加类，您就无法做到这一点：

```
$("#nav_bar ul").html('<li><a>some content</a></li>').children('li').addClass('class-one class-two'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:42:22.563

```
$("#nav_bar ul").html("<li><a>some content</a></li>"); 
```

.html() 方法销毁 ul 元素及其内容，然后添加新内容。

您应该改用 .append() 。

```
$("#nav_bar ul").append("<li><a>some content</a></li>"); 
```

如果你真的想替换原来的内容。

定位 div 并使用 .html() 方法

```
$("#nav_bar").html("<ul><li><a>some content</a></li></ul>");​ 
```

# jquery - 重新初始化或刷新 tablesorter 容器

> ID：11514758
> 
> 赞同：0
> 
> 时间：2012-07-17T01:09:01.727
> 
> 标签：jquery, tablesorter

有没有办法在动态加载数据后刷新 tablesorter 容器，以删除任何旧的或缓存的页面数据。

```
 .tablesorterPager({
            container: $("#pager"), 
            positionFixed: false,
            size:20
            })
            ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T20:25:08.433

刷新表和数据只需要触发更新：

```
$(".tablesorter").trigger("update"); 
```

# core-plot - Core-Plot X 轴标签位置偏移

> ID：11514761
> 
> 赞同：5
> 
> 时间：2012-07-17T01:09:31.040
> 
> 标签：core-plot, axis

我正在尝试向上移动 x 轴标签。我可以设置一个属性来做到这一点吗？我尝试在情节框架中添加一些底部填充，但所做的只是向上挤压整个情节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T19:46:07.070

Stack Overflow 上回答的另一个问题导致我更改了“orthogonalCoordinateDecimal”。例如：

```
 axisSet.xAxis.orthogonalCoordinateDecimal = CPTDecimalFromString(@"0") 
```

这导致我的 X 轴通过原点。为了提高与图表相关的 X 轴，我将值更改为“25000”，如下所示：

```
 axisSet.xAxis.orthogonalCoordinateDecimal = CPTDecimalFromString(@"25000") 
```

需要注意的是规模。在这种情况下，我的值​​范围为 0 - 185,000，因此当轴的上限值为 30 时（例如，在我的情况下为天），25,000 的移位大约相当于 4 的移位。我最初试图将 0-185,000 轴移动 5.0，并想知道为什么它没有效果，认为这是对屏幕空间的测量而不是缩放值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T13:43:10.577

The property your looking for is axisSet.xAxis.labelOffset

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-17T13:51:39.637

不完全清楚，可能你需要这个

```
x.axisConstraints = [CPTConstraints constraintWithLowerOffset:0.0]; 
```

或者要在轴上方显示标签，您可以使用以下命令：

```
x.tickDirection = CPTSignPositive; 
```

# java - 为什么 "||".split("\\|").length 返回 0 而不是 3？

> ID：11514769
> 
> 赞同：7
> 
> 时间：2012-07-17T01:11:49.540
> 
> 标签：java, regex, split, apex-code

当拆分表达式中有相邻的分隔符时，我期望 null 或空字符串 - 没有消除它。

Java代码如下：

```
public class splitter {
    public static void main(String args[]) {
        int size = "||".split("\\|").length;
        assert size == 3 : "size should be 3 and not " + size;
    }
} 
```

我希望得到 { "", "", "" } 或 { null, null, null }。两者都可以。

也许有一个不会被空话迷惑的正则表达式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-17T01:26:20.113

根据[javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)：

> `split`此方法的工作方式就像通过使用给定表达式和零限制参数调用双参数方法一样。**因此，尾随的空字符串不包含在结果数组中。**

用于详细说明的 javadoc [`split(String, int)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String,%20int%29)：

> 该`limit`参数控制应用模式的次数，因此会影响结果数组的长度。如果限制*n*大于零，则模式将最多应用*n* - 1 次，数组的长度将不大于*n*，并且数组的最后一个条目将包含最后一个匹配分隔符之外的所有输入。如果*n*为非正数，则该模式将尽可能多地应用，并且数组可以具有任意长度。**如果*n*为零，则该模式将被应用尽可能多的次数，数组可以有任意长度，并且尾随的空字符串将被丢弃。**

（强调我的）

所以要返回一个空字符串数组，调用`"||".split("\\|", -1)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:03:35.550

我需要仔细看看 Paul 的答案（他看起来更简单），但我能够找到一些关于解决断言的前瞻表达式（我很抱歉代码在 Apex 中——它只是包装了 Java）。

```
static testMethod void testPatternStringSplit() {
        Pattern aPattern = Pattern.Compile('(?=\\|)');
        system.assertEquals(3, aPattern.split('||').size());
        system.assertEquals(3, aPattern.split(' | | ').size());
        system.assertEquals(3, aPattern.split('a|b|c').size());
        system.assertEquals(3, aPattern.split('a|b|').size());
        system.assertEquals(3, aPattern.split('|b|c').size());
        system.assertEquals(3, aPattern.split('|b|').size());
} 
```

我需要编写一些代码来测试 Paul 的...

# c# - 编码为 SuperType 还是 Interface 更好？

> ID：11514770
> 
> 赞同：0
> 
> 时间：2012-07-17T01:12:10.793
> 
> 标签：c#, interface, polymorphism, supertype

什么被认为是一般的最佳实践：

通过超级类型引用？

```
public class BirdFeeder{

    public Feed(Bird bird){...}

} 
```

或通过接口

```
public class BirdFeeder{

    public Feed(IBird iBird){...}

} 
```

就我个人而言，我更喜欢界面，但我不太清楚为什么，对我来说它们只是感觉“更干净”。我想更好地理解为什么我会选择一个而不是另一个。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:35:59.933

您对接口是正确的，它们为您设计继承层次结构提供了更大的灵活性。

假设您有一个从基类开始的层次结构`Bird`，并向下延伸到各种鸟类。现在假设您想将一只机械鸟添加到鸟类的层次结构中，但您更愿意从`Robot`基类派生它。如果你的喂食器有`Bird`争论，你的机械鸟需要一个特殊的喂食器。但是，如果 feeder 接受一个，只要它正确实现了接口，向它`IBird`发送 a 就没有问题。`RoboBird``IBird`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:41:07.837

当您想在后代组件中实现一组行为时，请使用抽象类。

当您想要在许多没有有用的共同祖先的类上实现一组行为时的接口。

在很多情况下，您都可以使用其中任何一种。总的来说，我发现我可以重新设计使用界面的设计，获得新的东西，而不会陷入一系列可怕的妥协中。我宁愿定义一个接口，然后让一个抽象类为它的后代实现它，而不是没有接口。一开始的额外工作是微不足道的，但以后会带来巨大的好处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T01:35:31.347

如果通过“超级类型”，以及您与接口的比较，我猜您想专注于基本抽象类。（尽管您可以使用非抽象基类，但通常即使是没有抽象成员的抽象类也倾向于向开发人员传达它旨在实现/继承并且不作为一种类型独立存在）

在基类/抽象类与接口方面没有整体的“最佳实践”。他们在设计实践中都有自己的位置。确实，最佳实践来自您正在实施的设计。

就您的设计考虑而言，最大的不同可能是基类/抽象类只能被继承，而接口可以在任何类型的类上实现。

*（编辑：pilotcam 提出了一个更好的例子，请参阅他对问题的评论）* 从您的鸟类示例中，例如说您想处理不同的鸟类，如 Parrots、Albatross 和 Penguin，它们都继承自`Bird`. 但是你的应用程序也处理`Dinosaur`类型。你开始实施[Archeopteryx](http://en.wikipedia.org/wiki/Archaeopteryx)。它是继承自`Dinosaur`还是继承自`Bird`？现在，如果改为`Bird`接口，您可以简单地拥有`class Archaeopteryx : Dinsoaur, IBird`. 这个例子有点做作（我敢肯定有一个更好的），但希望它足够好。

当然，基类/抽象类也很好。例如，通过组合访问修饰符，您可以利用可能实现的`internal`方法，您的 API 可以访问实现，但类的外部使用者不能。

确实有很多理由使用一个而不是另一个，而且没有一个是真正“更好”的编码。这实际上取决于您的应用程序设计，并且可以说是您正在编码的隐喻；这些对象代表什么。你的对象*实际上*是一只鸟，还是它只*表现*得像一只鸟？你的 API 关心吗？什么会更好地维护您的工作？

这里有更多阅读： [接口与抽象类（一般 OO）](https://stackoverflow.com/questions/761194/interface-vs-abstract-class-general-oo)（注意所有“链接”的类似问题）

# c++ - 首先在 g++ 中从类到命名空间定义

> ID：11514771
> 
> 赞同：1
> 
> 时间：2012-07-17T01:12:14.847
> 
> 标签：c++, class, namespaces, g++, multiple-definition-error

我已经阅读了很多这样的问题，但我不能 100% 确定我的问题是否有所不同。我已经搜索了很多正确的答案，但大多数答案都围绕着宏守卫。我有一个从中派生的自定义字符串类，`std::string`后来因为我在现实世界中使用该项目，所以我不想仅仅为了扩展功能而派生 std::string。所以我将函数从 customString.h 移到了 utils_string.h 中。这是定义：

```
#ifndef OPS_TOOLKIT_UTILS_STRING_H
#define OPS_TOOLKIT_UTILS_STRING_H
#include <string>
#include <algorithm>
#include <vector>

namespace utils{
  namespace string{

const std::string kilikeDelimiter = "%";

void tolower(std::string& str){
    //CODE
}

bool iequals(const std::string& str1,const std::string& str2){
    //CODE
}
bool ilike(const std::string& str,const std::string& pattern){
    //CODE
}
std::string prependAndAppendILikeDelimiter(const std::string& str) {
    //CODE
}
} //namespace string
} //namespace utils

#endif 
```

我得到了抱怨`...first defined here`，这是编译器的确切输出。注意：这里没有课

> /tmp/ccCFVTXP.o: 在函数`utils::string::tolower(std::basic_string<char, std::char_traits<char>, std::allocator<char> >&)': listings.cpp:(.text+0x0): multiple definition of`utils::string::tolower(std::basic_string, std::allocator >&)' /tmp/cczDtRdT.o:listing.cpp:(.text+0x0): 首先定义这里 /tmp/ccCFVTXP.o: 在函数`utils::string::iequals(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)': listings.cpp:(.text+0x55): multiple definition of`utils::string::iequals(std::basic_string, std::allocator > const&, std::basic_string, std::allocator > const&)' /tmp/cczDtRdT.o: Listing.cpp:(.text+0x55): 首先定义在这里 /tmp/ccCFVTXP.o: 在函数`utils::string::ilike(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)': listings.cpp:(.text+0x118): multiple definition of`utils::string::ilike(std::basic_string, std::allocator > const&, std::basic_string, std: :allocator > const&)' /tmp/cczDtRdT.o:listing.cpp:(.text+0x118): 首先定义在这里 /tmp/ccCFVTXP.o: 在函数`utils::string::prependAndAppendILikeDelimiter(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)': listings.cpp:(.text+0x484): multiple definition of`utils::string::prependAndAppendILikeDelimiter(std::basic_string, std ::allocator > const&)' /tmp/cczDtRdT.o:listing.cpp:(.text+0x484):首先在这里定义/tmp/ccifZISK.o：在函数中`utils::string::tolower(std::basic_string<char, std::char_traits<char>, std::allocator<char> >&)': match_count.cpp:(.text+0x0): multiple definition of`utils::string::tolower(std::basic_string, std::allocator >&)' /tmp/cczDtRdT.o:listing.cpp:(.text+0x0): 首先在这里定义 /tmp/ccifZISK.o: 在函数`utils::string::iequals(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)': match_count.cpp:(.text+0x55): multiple definition of`utils::string::iequals(std::basic_string, std::allocator > const&, std::basic_string, std::allocator > const&)' /tmp/cczDtRdT.o:listing.cpp:(.text+0x55 ): 首先在这里定义 /tmp/ccifZISK.o: 在函数`utils::string::ilike(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)': match_count.cpp:(.text+0x118): multiple definition of`utils::string::ilike(std::basic_string, std::allocator > const&, std::basic_string, std::allocator > const&)' /tmp/ cczDtRdT.o:listing.cpp:(.text+0x118): 首先定义在这里 /tmp/ccifZISK.o: 在函数`utils::string::prependAndAppendILikeDelimiter(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)': match_count.cpp:(.text+0x484): multiple definition of`utils::string::prependAndAppendILikeDelimiter(std::basic_string, std::allocator > const&)' /tmp /cczDtRdT.o:listing.cpp:(.text+0x484): 首先在这里定义 collect2: ld 返回 1 退出状态

我为整个混乱感到抱歉，但我不想错过任何遇到类似问题的人。

还有一件事; 它说**match_count.cpp** * *Listing.cpp* * 和**Listings.cpp**它只是使用 ::utils::string::function() 中定义的函数

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T01:23:38.570

头文件不能*定义*代码，除非它是明确的`inline`。否则（因为预处理器像一个巨大的复制/粘贴机器一样工作），就好像每个执行`#include`.

因此，添加`inline`到其中的每一个中，或者将它们放在单个`.cpp`中，但不要放在标题中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:38:11.470

将您的函数放入这样的类中可能会更好（以下转到 .h 文件）。使用嵌套命名空间可能更常见。

```
#pragma once
#include <string>

namespace utils
{
    class StringUtil
    {
        public:
           static void tolower(std::string& str)
           {
               // code
           }
    };
} 
```

# c - 链表插入函数 - 通过指针传递列表

> ID：11514772
> 
> 赞同：1
> 
> 时间：2012-07-17T01:12:19.343
> 
> 标签：c, pointers, data-structures, linked-list

我试图创建一个链表插入函数，该函数接受一个列表（或更准确地说是一个指向它的指针），然后将值插入到列表的末尾。

```
void ll_insert(struct ll **l, int n){
  struct ll *temp=NULL;
  while ( (*l) != NULL){
    temp= (*l);
    (*l) = (*l)->next;
  }
  (*l)= (struct ll*)malloc(sizeof(struct ll));
  (*l)->n=n;
  (*l)->next=NULL;
  if (temp) temp->next= (*l);
}

int main(void){
  struct ll *l=NULL;                                                                                                                                                         
  ll_insert(&l, 1);
  printf("%d ", l->n);
  ll_insert(&l, 1);
  ll_insert(&l, 2);
  ll_insert(&l, 3);
  printf("%d ", l->n); 

} 
```

运行上述代码后的输出是 1 3。这并不奇怪，因为

```
(*l) = (*l)->next; 
```

更新列表以指向结束节点，并且每次我运行 insert(...) 时，列表的头部都会更新为指向末尾（如果我没有错的话）。这有什么办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:19:06.407

您没有正确使用指向指针的指针：`while`循环中的这一行

```
(*l) = (*l)->next; 
```

应该

```
l = &((*l)->next); 
```

如果您以这种方式使用它，则根本不需要您的`temp`变量。

由于这是 C，而不是 C++，因此可以不强制转换`malloc`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:18:50.427

您的函数只有在插入空列表时才应更改 *l，因为这是列表的第一个元素更改的唯一情况。对于这些情况（初始化为 *l），这可以通过在函数内部使用局部变量而不是 *l 来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:27:16.977

如果你不移动指针 l，那么它仍然在列表的头部。首先将 l 分配给 temp，然后将 temp 沿列表移动，但不理会指针 l。

# powershell - 将 csv 导入 Active Directory

> ID：11514777
> 
> 赞同：1
> 
> 时间：2012-07-17T01:13:17.317
> 
> 标签：powershell, import, active-directory, powershell-2.0

我正在关注[本指南](http://blogs.technet.com/b/hot/archive/2012/04/26/directory-sync-cannot-update-distribution-group-after-office-365-migration.aspx)

我能够将通讯组导出到 CSV，并编辑 CSV，但是在使用时

```
Import-csv c:\displayname.csv | foreach-object {set-adgroup -identity $_.SamAccountName -displayname $_.displayname} 
```

要导入修改，我得到：

> Set-ADGroup：无法验证参数“身份”上的参数。参数为空。提供一个非空参数并再次尝试该命令。

我已经尝试过主题的变化，但没有变化。此外，我需要`-Credential domain\username`在导出时使用，我尝试在尝试导入更改时添加它以及它的变体......没有区别。

1）我不需要进行身份验证吗？

2) 就导入 CSV 而言，我缺少什么？我觉得这很简单，比如一些额外的信息：OU、DC、Credential 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:46:18.837

您的错误只是表明`$_.SamAccountName`不重视您是否先尝试查看这些值？

修改 CSV 文件可能会损坏它，您的命令行对我有用。

* * *

也许您的问题在于编码或 CSV 文件的形式，您可以先尝试使用 PowerShell 创建一个：

```
Get-ADGroup  -Properties samaccountname,displayname -LDAPFilter "(cn=*sec)" | Export-Csv gp.csv 
```

然后和自己的比较。在这里，我只是从名称中包含 sec 的组中提取一些字段。

# iphone - UISplitViewController StoryBoards segue 替换 detailview

> ID：11514780
> 
> 赞同：2
> 
> 时间：2012-07-17T01:13:51.223
> 
> 标签：iphone, ipad, uitableview, uisplitviewcontroller, master-detail

我的故事板具有`UISplitViewController`作为初始视图控制器。它的主视图`UITableView`嵌入了一个导航控制器，并且有一个详细视图控制器，其中包含一个`MKMapView`. 单击第一个表格视图的表格单元格进入第二个表格视图控制器。

单击第二个表格视图的单元格进入第二个详细视图，这是一个图像视图。segue 类型为“替换”，目的地为“详细拆分”。基本上，它会在详细视图中加载与第二个 tableView 中的行相关的图像。

我能够很好地导航回我的第一个 tableview。我想在第一个表视图出现时显示第一个详细视图。原因是它显示了一个与表格视图的内容相关的地图视图。我读了很多关于它的文章，但没有弄清楚如何去做。您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-13T16:12:21.437

您是否尝试将以下内容添加到您的第一个 TableViewController

```
- (void)viewWillAppear:(BOOL)animated {
   [super viewWillAppear:animated];

   // existing code if you have any

   [self performSegueWithIdentifier:@"Segue ID for your map" sender:self];
} 
```

# mongodb - MongoDB 性能问题：单个大集合与多个小集合

> ID：11514781
> 
> 赞同：12
> 
> 时间：2012-07-17T01:14:02.370
> 
> 标签：mongodb, mongodb-.net-driver

我测试了两个场景单个巨大集合与多个小集合，发现查询时性能存在巨大差异。这就是我所做的。

案例 1：我为 10 种不同类型的产品创建了一个包含 1000 万条记录的产品集合，其中每种产品类型恰好有 100 万条记录，并且我在 ProductType 上创建了索引。当我运行条件 ProductType=1 和 ProductPrice>100 和 limit(10) 的示例查询以返回 10 条 ProductType=1 且价格大于 100 的记录时，当集合中有很多价格的产品时，大约需要 35 毫秒大于 100，当 ProductType=1 中价格大于 100 的产品数量非常少时，相同的查询大约需要 8000 毫秒（8 秒）。

案例 2：我为每个 ProductType 创建了 10 个不同的 Product 表，每个 ProductType 包含 100 万条记录。在包含 productType 1 记录的集合 1 中，当我使用条件 ProductPrice>100 和 limit(10) 运行相同的示例查询以返回 10 条价格大于 100 的产品记录时，当集合有很多时大约需要 2.5 毫秒价格大于 100 的产品，当我们的价格大于 100 的产品数量非常少时，相同的查询大约需要 1500 毫秒（1.5 秒）。

那么为什么会有这么大的区别呢？案例一和案例二之间的唯一区别是一个巨大的集合与多个较小的集合，但我在第一个案例中创建了 ProductType 索引一个单一的巨大集合。我猜性能差异是由第一种情况下的索引引起的，我需要在第一种情况下使用该索引，否则性能会更差。由于索引，我预计第一种情况下的性能会有所下降，但我没想到第一种情况下的巨大差异会慢 10 倍。

因此，一个大型集合与多个小型集合的 8000 毫秒与 1500 毫秒。为什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-17T01:40:43.383

分离集合为您提供了一个免费的索引，而没有任何实际开销。索引扫描有开销，特别是如果索引并不能真正帮助您减少必须扫描的结果数量（如果索引中有一百万个结果，但您必须全部扫描并检查它们，它不会对你有太大帮助）。

简而言之，将它们分开是一种有效的优化，但是在您真正决定采用该路线之前，您应该使您的索引更适合您的查询，我认为这是一个激进的措施（在这种情况下，产品价格的索引可能会帮助您更多） .

使用 explain() 可以帮助您了解查询的工作原理。一些基础知识是： 理想情况下，您需要较低的 nscanned 与 n 比率。通常，您不想要 scanAndOrder = true，也不想要 BasicCursor（这意味着您根本没有使用索引）。

# php - 如何在 php 中包含使用本地目录

> ID：11514782
> 
> 赞同：0
> 
> 时间：2012-07-17T01:14:58.603
> 
> 标签：php

我创建了一个在不同目录中使用图像等的函数，但是当我使用包含调用它时，它会在包含所在的目录中查找图像。我将使用什么来使文件在它所在的目录中运行并在新的 php 脚本中输出函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:17:57.237

您可以修改脚本以使用其在服务器上的位置，无论它在哪里包含（）都应该是相同的

```
<?php
$path_of_this_script = dirname(__FILE__); 
[...] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:17:49.800

PHP 有 chdir 函数。[http://php.net/manual/en/function.chdir.php](http://php.net/manual/en/function.chdir.php)

我不明白你为什么不使用 html 来指定图像位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:55:34.383

默认情况下，任何没有适当参数的代码都会在本地目录中查找资源。所以要解决你的问题，你可以做几件事。这是一个例子：

假设您的目录结构如下：

*   家/
*   图片/
*   -icon.png
*   文件/
*   -abc.php
*   -vars.php

在 abc.php 中，你可能有这样的东西

```
<?php
function include_image() {
  $image_url = "icon.png"; // Will search for icon.png in "files" directory
  //do something with $image_url
}
?> 
```

您可以执行以下操作：

在 vars.php 中，包含一个图像路径

```
<?php
$image_path = "http://www.example.com/images"; // or "foldername/subfoldername/images"
?> 
```

将 abc.php 中的代码更改为以下

```
<?php
include "vars.php";
function include_image() {
  $image_url = "$image_path/icon.png"; // Will search for icon.png in "files" directory
  //do something with $image_url
}
?> 
```

# bash - sed 将 ' 替换为 \'

> ID：11514783
> 
> 赞同：3
> 
> 时间：2012-07-17T01:15:27.137
> 
> 标签：bash, sed

这：

```
echo "Hel'lo" | sed s/\'/\\\'/g 
```

产量

```
Hel'lo 
```

我想要的是这样的：

```
Hel\'lo 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T01:21:55.133

```
echo "Hel'lo" | sed "s/'/\\\'/g"
Hel\'lo 
```

还

```
echo "Hel'lo" |  sed s/\'/\\\\\'/g 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:22:23.417

或者不引用 sed 参数：

```
echo "Hel'lo" | sed s/\'/\\\\\'/g 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T06:14:26.887

您也可以使用所有单引号来执行此操作：

```
echo "Hel'lo" | sed 's/'\''/\\'\''/g' 
```

而且由于您的问题也被标记`bash`为 ，我不妨指出您甚至不需要 sed：

```
[ghoti@pc ~]$ foo="Hel'lo"
[ghoti@pc ~]$ echo "${foo/\'/\'}"
Hel\'lo 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T06:02:15.800

这可能对您有用：

```
echo "Hel'lo" | sed 's/'\''/\\&/' 
```

# php - 使用 Eclipse - 没有选项可以将 PHP 作为脚本运行或调试？

> ID：11514787
> 
> 赞同：1
> 
> 时间：2012-07-17T01:16:51.570
> 
> 标签：php, eclipse, xdebug, eclipse-pdt, zend-debugger

我想再次尝试使用 PHP，并决定也尝试使用 Eclipse。

我刚刚完成了 Eclipse PDT 的全新安装，以及使用 EasyPHP 的相关 php/mysql/apache 服务器。Zend-debugger 和 Xdebug 也已安装。

但是，我没有作为 PHP 脚本运行或调试的选项。唯一可用的选项是作为“PHP Web 应用程序”运行。我看过一些指南和视频提到了 Run As PHP Script 选项，但我没有。

我需要配置什么才能得到这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-22T12:52:25.230

同样的问题在这里我选择运行方式>运行配置>左侧有php cli应用程序双击它以创建新然后选择备用php并从中设置我在/usr/bin/php5中找到的php可执行文件的目录和 php.ini 浏览到您的 php 文件以运行它这里的问题是每次运行新脚本时您都必须设置 php 脚本文件的目录

希望这会有所帮助

# jquery - jQuery：有没有办法将“点击”事件变成双击？

> ID：11514796
> 
> 赞同：1
> 
> 时间：2012-07-17T01:17:53.103
> 
> 标签：jquery, mouseevent, clipboard

如何使用 jQuery 将`click`事件检测为双击？基本上，我希望`.select`类中的文本更容易选择，以便用户可以快速将内容复制到剪贴板。

```
<li>
    <span>
        Don't Select me
    </span>
    <span>
        Don't Select me
    </span>
    <span class="select">
        Select Me on click!
    </span>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:50:09.013

试试这个

```
function SelectText(element) {
    var doc = document;
    var text = doc.getElementById(element);    
    if (doc.body.createTextRange) {
        var range = document.body.createTextRange();
        range.moveToElementText(text);
        range.select();
    } else if (window.getSelection) {
        var selection = window.getSelection();        
        var range = document.createRange();
        range.selectNodeContents(text);
        selection.removeAllRanges();
        selection.addRange(range);
    }
}

$(function() {
    $('.select').click(function() {
        SelectText('selectme');
    });
});​ 
```

从[https://stackoverflow.com/a/987376/1330581获取](https://stackoverflow.com/a/987376/1330581)

示例[http://jsfiddle.net/edelman/KcX6A/339/](http://jsfiddle.net/edelman/KcX6A/339/)

* * *

**更新：**

选择同一个被点击元素的内容：

```
function SelectText(element) {
    var doc = document;
    var text = element;    
    if (doc.body.createTextRange) {
        var range = document.body.createTextRange();
        range.moveToElementText(text);
        range.select();
    } else if (window.getSelection) {
        var selection = window.getSelection();        
        var range = document.createRange();
        range.selectNodeContents(text);
        selection.removeAllRanges();
        selection.addRange(range);
    }
}

$(function() {
    $('.select').click(function() {
        SelectText($(this)[0]); //Brackets are more efficiently that .get(0) method
    });
});​ 
```

示例：http: [//jsfiddle.net/qBaWf/](http://jsfiddle.net/qBaWf/)

# visual-studio-2010 - Visual Studio 中的点云库构建错误

> ID：11514800
> 
> 赞同：3
> 
> 时间：2012-07-17T01:18:09.707
> 
> 标签：visual-studio-2010, point-cloud-library

我正在尝试将点云库与 kinect 一起用于论文，但是当我按照[本教程](http://www.pointclouds.org/documentation/tutorials/using_pcl_pcl_config.php)并尝试在 Visual Studio 2010 中编译解决方案时，我遇到了一些构建错误：

```
pcd_write.obj : error LNK2019: unresolved external symbol "public: int __thiscall pcl::PCDWriter::writeASCII(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,struct sensor_msgs::PointCloud2 const &,class Eigen::Matrix<float,4,1,0,4,1> const &,class Eigen::Quaternion<float,0> const &,int)" (?writeASCII@PCDWriter@pcl@@QAEHABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABUPointCloud2@sensor_msgs@@ABV?$Matrix@M$03$00$0A@$03$00@Eigen@@ABV?$Quaternion@M$0A@@8@H@Z) referenced in function "public: virtual int __thiscall pcl::PCDWriter::write(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,struct sensor_msgs::PointCloud2 const &,class Eigen::Matrix<float,4,1,0,4,1> const &,class Eigen::Quaternion<float,0> const &,bool)" (?write@PCDWriter@pcl@@UAEHABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABUPointCloud2@sensor_msgs@@ABV?$Matrix@M$03$00$0A@$03$00@Eigen@@ABV?$Quaternion@M$0A@@8@_N@Z)
pcd_write.obj : error LNK2019: unresolved external symbol "public: int __thiscall pcl::PCDWriter::writeBinary(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,struct sensor_msgs::PointCloud2 const &,class Eigen::Matrix<float,4,1,0,4,1> const &,class Eigen::Quaternion<float,0> const &)" (?writeBinary@PCDWriter@pcl@@QAEHABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABUPointCloud2@sensor_msgs@@ABV?$Matrix@M$03$00$0A@$03$00@Eigen@@ABV?$Quaternion@M$0A@@8@@Z) referenced in function "public: virtual int __thiscall pcl::PCDWriter::write(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,struct sensor_msgs::PointCloud2 const &,class Eigen::Matrix<float,4,1,0,4,1> const &,class Eigen::Quaternion<float,0> const &,bool)" (?write@PCDWriter@pcl@@UAEHABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABUPointCloud2@sensor_msgs@@ABV?$Matrix@M$03$00$0A@$03$00@Eigen@@ABV?$Quaternion@M$0A@@8@_N@Z)
pcd_write.obj : error LNK2019: unresolved external symbol "void __cdecl pcl::console::print(enum pcl::console::VERBOSITY_LEVEL,char const *,...)" (?print@console@pcl@@YAXW4VERBOSITY_LEVEL@12@PBDZZ) referenced in function "public: int __thiscall pcl::PCDWriter::writeASCII<struct pcl::PointXYZ>(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &,class pcl::PointCloud<struct pcl::PointXYZ> const &,int)" (??$writeASCII@UPointXYZ@pcl@@@PCDWriter@pcl@@QAEHABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@ABV?$PointCloud@UPointXYZ@pcl@@@1@H@Z) 
```

有人可以解释为什么会发生这些错误以及如何解决它们吗？非常感谢所有帮助，我总是接受答案！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-18T08:01:32.747

您可能使用了错误的 PCL 版本（64 位/32 位）。如果您正在生成 64 位 CMake 项目，请务必为 Visual Studio 2010 安装 64 位 PCL 库。如果您不确定正在使用的 PCL 版本，您可以按照 Fraser 的建议进行检查。

[您可以从这里](http://pointclouds.org/downloads/windows.html)下载正确的 PCL 库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T23:05:44.360

我遇到了同样的错误，我找到了解决方案。使用 cmake 时，如果使用 64 位 PCL 库，请确保选择 Visual Studio 10 win64 生成器。我最初使用 Visual Studio 10 生成器并得到完全相同的错误。当我将它切换到 Visual Studio 10 win64 生成器时，它就像一个魅力。

# ruby - 使用 goliath 和 rack::jsonp 时标头内容长度小于实际长度

> ID：11514803
> 
> 赞同：0
> 
> 时间：2012-07-17T01:18:31.917
> 
> 标签：ruby, header, goliath, grape-api

这是 jsonp goliath 中间件的代码：

[https://github.com/postrank-labs/goliath/blob/master/lib/goliath/rack/jsonp.rb](https://github.com/postrank-labs/goliath/blob/master/lib/goliath/rack/jsonp.rb)

一切都很好，除了标题包含的内容长度小于实际长度。

我不确定为什么在哪里或为什么它设置的内容长度小于实际可能是因为：

“#{env.params['callback']}(#{response})” 未考虑包含在返回正文中的额外回调方法名称。

我能想到的解决方案是在调用此方法 post_process 之前修改标题，以便标题内容长度正确。

我不确定在哪里做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T05:42:42.947

我不确定你为什么会看到这个问题，但这听起来像是一个错误。您能否制作一个显示问题的测试服务器并在 github 上创建一个错误？

内容长度应该由位于链头的自动注入中间件设置。它将在 JSONP 中间件执行后运行，因此它应该考虑新的大小。

# javascript - 如何从模式窗口执行开启器窗口中的方法？

> ID：11514808
> 
> 赞同：0
> 
> 时间：2012-07-17T01:19:08.800
> 
> 标签：javascript, jquery, window.opener

我正在使用 jQuery 插件进行通知： http: [//needim.github.com/noty/](http://needim.github.com/noty/)

这是我调用显示通知的方法的方式：

```
noty({force: true, timeout: false, text: 'Hello noty', type: 'information'}); 
```

代码工作正常，但是现在，在模态窗口中，我需要在关闭模态窗口后立即在打开器窗口中执行该调用......我想我应该使用 window.opener 但不知道如何为这种情况做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T03:15:51.913

您可以在打开器窗口中定义一个 JS 函数：

```
function invokeSuccessNotification(msg){
        noty({force: true, timeout: false, text: 'Hello noty', type: 'information'});

    } 
```

然后，在您的模态窗口中，像这样调用该方法：

```
window.opener.invokeSuccessNotification(); 
```

# php - 删除重复链接

> ID：11514809
> 
> 赞同：2
> 
> 时间：2012-07-17T01:19:45.250
> 
> 标签：php, web-crawler

我想抓取pdf链接。但是我得到的一些链接是双重的。如何删除双链接之一？谢谢 ：）

```
<?php
<include 'simple_html_dom.php';
$url = 'http://scholar.google.com/scholar?hl=en&q=data+mining&btnG=&as_sdt=1%2C5&as_sdtp=';
$html = file_get_html($url) or die ('invalid url');
foreach($html->find('a') as $e) {
    $link= $e->href;
    if (preg_match('/\.pdf$/i', $link)) {
       print_r($link);
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T01:21:29.737

将链接放入数组中，然后使用 array_unique()

```
foreach($html->find('a') as $e) {
    $link= $e->href;
    if (preg_match('/\.pdf$/i', $link)) {
       $links[] = $link;
    }
}
$links = array_unique( $links ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:30:51.640

```
$url = 'http://scholar.google.com/scholar?hl=en&q=data+mining&btnG=&as_sdt=1%2C5&as_sdtp=';
$html = file_get_html($url) or die ('invalid url');
$arr = array();
foreach($html->find('a') as $e) {
    $link= $e->href;
    if(strtolower(substr($link, strrpos($link, '.'))) === '.pdf')
       $arr[] = $link;
}
array_unique($arr);
print_r($arr); 
```

1.  我建议使用字符串函数来获取扩展名 - 它更轻。
2.  您可以将链接存储在数组中，然后使用[array_unique()](http://sg3.php.net/manual/en/function.array-unique.php)函数。

# c# - 在 VS 中，如何告诉编译器在特定变量存储特定值时中断？

> ID：11514810
> 
> 赞同：2
> 
> 时间：2012-07-17T01:19:58.290
> 
> 标签：c#, .net, visual-studio-2010, debugging

例如，在 VisualStudio 中有没有办法告诉编译器在我达到值 5 时中断？

```
for(int i = 0; i < 10; i++)
... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T01:26:30.820

在语句上添加断点`for`（或循环体`i`中范围内的任何位置），然后右键单击边距中的红点并选择“条件...”并输入表达式`i == 5`

就这么简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T01:21:17.473

是的，使用[Debugger](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.aspx)类：

```
if (i == 5) System.Diagnostics.Debugger.Break(); 
```

# assembly - 如何移动 $0x41,%ecx

> ID：11514815
> 
> 赞同：0
> 
> 时间：2012-07-17T01:21:04.297
> 
> 标签：assembly, x86, gnu-assembler

我用 Gnu 管理了“Hello World”！

那么，接下来是打印 1 到 10 对吗？（也许在红宝石中）

目前，我很乐意打印 A，紧随其后的是 B。这就是我所拥有的。

```
.section .text
  .globl _start

_start:
  # Print A
  movl  $4,%eax
  pushl $0x41
  movl  %esp,%ecx        # Would rather movl $0x41,%ecx
  movl  $1,%ebx
  movl  $1,%edx
  int   $0x80

  # Closely followed by B
  movl  $4,%eax
  incl  (%esp)           # Rather incl(%ecx) here
  movl  %esp,%ecx
  movl  $1,%ebx
  movl  $1,%edx
  int   $0x80

  movl  $1,%eax
  movl  $0,%ebx
  int   $0x80 
```

它确实有效，但我的问题是，为什么我不能

```
 movl  $0x41,%ecx 
```

开始，然后

```
 incl (%ecx) 
```

稍后？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T03:05:52.813

对于 sys_write，%ecx 想要指向一个或多个字符在内存中的位置，而不是“成为”要打印的字符。"incb" 可能比 "incl" 更正确，因为你只增加一个字节 - "(%esp)" 或 "(%ecx)" 应该可以工作，因为此时它们指向同一个地方。请注意，您正在增加内存的“内容”，而不是指向内存的指针。

最好的，弗兰克

# ruby - 如何以编程方式更改 Mac 的音频输出设备或使用 Ruby 调用系统“dong”声音？

> ID：11514819
> 
> 赞同：1
> 
> 时间：2012-07-17T01:21:58.587
> 
> 标签：ruby, macos

我在 iMac 上有一个用 Ruby 编写的应用程序，它会使用

```
puts 7.chr 
```

（或者它可以播放 mp3 文件）。但问题是，有时Mac被更改为将系统偏好设置中的音频输出到HDTV而不是内置扬声器，并且有时可以关闭HDTV。

那么有没有办法以编程方式将输出设备更改为内部扬声器，或者播放 iMac 启动时发出的“咚”声——来自机器内部的声音？

# c# - ProfileBase 中的模拟属性

> ID：11514820
> 
> 赞同：0
> 
> 时间：2012-07-17T01:22:22.767
> 
> 标签：c#, asp.net-mvc, mocking

所以这变得很痛苦。我正在尝试测试一些 Microsoft 的垃圾成员库，它们太糟糕了。我设法在 Membership 类前面放置了一个接口，然后在实现 ProfileBase 的类中遇到了问题，我设法为此创建了一个接口，因此可以模拟愚蠢的静态 create 方法，但是如何模拟 profileBase 中的属性这是您使用那个愚蠢的课程的唯一原因。严重的是，当今时代的 Microsoft 无法修复他们的代码，因此您可以为它编写一个该死的单元测试。多么可怜。这是我迄今为止尝试过的

```
mockProfileFactoryService = new Mock<IProfileFactoryService>();
mockProfileFactoryService.Setup(x => x.GetUserProfile(It.IsAny<string>())).Returns(new DummyUserProfile(){FirstName = ""}); 
```

这就是虚拟班级的样子

```
public class DummyUserProfile: UserProfile
{
    public new String FirstName { get; set; }
    public new String LastName { get; set; }
} 
```

我以为我可以用这种方式隐藏属性 FirstName 和 LastName，但测试只是失败了，我可以看到它试图访问实际 UserProfile 类中的属性。

有谁知道我该怎么做？说真的 - 当其他人从 ProfilBase 类继承时，他们在做什么？

我还尝试使用 reshaper 进行提取和接口，这似乎可行，但是当我模拟它然后尝试说 .Return(profileMock.object) 时，它爆炸说它无法将 IUserProfile 转换为 UserProfile？在ARG之前我从未见过！

我的意思是-我讨厌更改我的代码以使其可测试，即检查空值或类似的愚蠢废话，但如果可以的话，我会这样做，在这种情况下，您无能为力，因为您对此做了什么？

```
base["FirstName"] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:08:58.017

因此，经过一番吐槽之后，我在 IProfileFacotryService 中想出了这个

```
string GetPropertyValue(string userName, string propertyName); 
```

然后在实施中

```
public string GetPropertyValue(string userName, string propertyName)
{
    return (string)GetUserProfile(userName).GetPropertyValue(propertyName);
} 
```

但我对此并不感到兴奋——我通常不喜欢创建除了调用原始代码之外的任何其他操作的接口，而且我不觉得那真的是这样做的——我的意思是它是，但我的意思似乎不太清楚？无论如何 - 我只是觉得有一种更好的方法可以做到这一点，所以虽然这可行，但如果存在更好的解决方案，我不介意。

显然我现在可以模拟这个但在我的代码中我不得不说

```
taskBoardModel.Name = profileFactoryService.GetPropertyValue(userName, "FirstName"); 
```

我宁愿说

```
 taskBoardModel.Name = profileFactoryService.GetUserProfile(userName).FirstName; 
```

无论如何——呸！

# php - 在 PHP 搜索引擎中处理简单语法

> ID：11514824
> 
> 赞同：4
> 
> 时间：2012-07-17T01:22:33.593
> 
> 标签：php, mysql, search

我正在使用 MySQL 和 PHP 为我的网站创建一个简单的搜索功能。现在，如果在搜索栏中输入单词“cat”，我将无法检索带有单词“cats”的文章，反之亦然。结尾的“ed”也是如此。

我能想到的解决此问题的唯一方法是从每个长度超过一定长度的单词的末尾删除所有“s”和“ed”（以避免将“Ted”变成“T”等） . 然而，这个简单的解决方案远非完美。我希望有人可以为我提供更好的解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T01:27:34.620

您所指的技术称为词干提取。由于对语言的影响很大，这在应用程序级别很难自己处理。如果您不想处理这个问题，您可以让 MySQL 为您完成繁重的工作，具体取决于您正在运行的 MySQL 版本。如果您使用的是 5.6.4 或更高版本，则它内置于 MyISAM 表和 InnoDB 表的全文搜索机制中。在 5.5 到 5.6.3 版本中，它是为 MyISAM 而不是 InnoDB 表内置的。对于 5.1 版，[mnoGoSearch](http://www.mnogosearch.org/doc33/msearch-udmstemmer.html)提供了一个插件。在 5.1 之前，我认为您需要在应用程序级别处理它，但我尚未确认。

这些链接可能会帮助您入门。

*   [http://dev.mysql.com/doc/refman/5.6/en/glossary.html#glos_stemming](http://dev.mysql.com/doc/refman/5.6/en/glossary.html#glos_stemming)
*   [http://dev.mysql.com/doc/refman/5.6/en/glossary.html#glos_full_text_search](http://dev.mysql.com/doc/refman/5.6/en/glossary.html#glos_full_text_search)
*   [http://dev.mysql.com/doc/refman/5.6/en/glossary.html#glos_fulltext_index](http://dev.mysql.com/doc/refman/5.6/en/glossary.html#glos_fulltext_index)
*   [http://dev.mysql.com/doc/refman/5.6/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.6/en/fulltext-search.html)

请注意停用词列表，它是在处理查询时在搜索文本中被忽略的非常常见且通常很短的词的列表。如果停用词列表阻止您获得预期结果，则有一些设置可以控制停用词列表。您可能希望将最小字长设置为 2 或 3（默认为 4）并删除默认列表中的许多字。

如果您确实想自己或使用 PHP 处理词干提取[，Martin Porter 对 Porter Stemming Algorithm 进行了详细的技术讨论，](http://tartarus.org/~martin/PorterStemmer/)并且至少有两种 PHP 实现可用，[Jon Abernathy 的 PHP4 中的一个较旧的](http://www.chuggnutt.com/stemmer-source)实现可能有一些缺陷以及[由 Richard Heyes 编写的 PHP5 中的较新版本](http://tartarus.org/~martin/PorterStemmer/php.txt)。

我假设您主要关心英语，但我相信其他语言也有一些支持。

正如[rnmccall 所提到的，](https://stackoverflow.com/a/11606433/615686)如果您需要更高级的搜索功能，您可能需要使用 Sphinx 或 Apache Lucene。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T04:17:09.103

问题中描述的删除后缀的策略通常称为词干提取。如果您仍然对采用该策略感兴趣，您应该查看[http://tartarus.org/~martin/PorterStemmer/](http://tartarus.org/~martin/PorterStemmer/)以了解词干提取的背景。该页面还具有 Porter 词干分析器的 PHP 实现和更现代算法的链接。

这种词干搜索方法由[Sphinx](http://sphinx.pocoo.org/)使用，它用于[pydoc](http://docs.python.org/library/pydoc.html)等。

词干提取方法的主要好处是它简单明了并且可以轻量级。

但是，如果您想要更复杂的搜索功能，您可能应该使用[Apache Lucene 之](http://lucene.apache.org/core/)类的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T17:24:11.473

我建议使用 Lucene。由于您没有运行复杂的查询 - 只需查找索引，因此它还会减少您的数据库压力。您还可以使用 Lucene 运行模糊搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-27T18:39:36.937

可能的解决方案：

1.最简单的实现 -> 使用 %operator

像%cats%

2.使用 solr 进行快速实施，因为那里实施了最佳算法。

注意：您也可以将结果缓存在缓存中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T09:14:57.077

没有任何意思`ed`或任何你想删除的东西。因为您正在从一个段落中搜索一个字符串，所以您需要提供一个特定的关键字来进行搜索。该关键字可以是完整的字符串（单词），也可以是子字符串（单词的一部分）。

例子：-

你在一个`black`洞里。

现在您想`black`通过提供`bla`搜索字符串进行搜索。然后查询如下：-

```
SELECT * FROM TABLE_NAME WHERE YOUR_FIELD_NAME LIKE '%BLA%' 
```

使用上面的查询与您的内容完全匹配。您可以提供您想要搜索的段落/段落中的任何子字符串。

希望它会帮助你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-23T07:26:18.713

你可以简单地使用

```
SELECT * FROM topics WHERE Title LIKE '%cat%' 
```

在查询中搜索标题为猫和猫的主题。如果要从大文本内容中搜索数据，可以使用 FullTextSearch。在这种情况下，您只能使用 MyISAM 表。[您可以在此处](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)阅读全文搜索文档

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-23T19:28:39.297

一个简单的查询将是：

```
 select * from table where item like '%name%' 
```

为了避免 t 和 ted 的事情，使用该`substr()`函数并将字符串设置为通用大小，然后将该字符串放在 where 子句中。

# r - 在R中实现极值的黄金分割搜索

> ID：11514825
> 
> 赞同：0
> 
> 时间：2012-07-17T01:22:43.373
> 
> 标签：r

我们如何将这段代码修改为更有效的代码并搜索直到达到 p1-p2 的容差水平，结果我们得到极值？有没有比这个黄金分割 serach 更快的算法来找到极值？

```
 lambda<-(sqrt(5)-1)/2

    golden.section<-function(f, pL, pU, p1, p2, top, result){
      if (top==26){
       return(result)
    }
    else if(top==1){
    p1<-pL + (1-lambda)*(pU - pL)
    p2<-pU - (1-lambda)*(pU - pL)
    } 
    result[top,]<-c(p1,p2)
    if(f(p2) < f(p1)){
    pU<-p2
    pL<-pL
    p2<-p1
    p1<-pL + (1-lambda)*(pU - pL)
    } else if (f(p2) > f(p1)){
    pU <- pU
    pL <- p1
    p1 <- p2
    p2<-pU - (1-lambda)*(pU - pL)
   }
   result<-golden.section(f, pL, pU, p1, p2, top=top+1, result)
   return(result)
   }

 result<-data.frame(p1=rep(NA, 25), p2=rep(NA, 25))
 result<-golden.section(function(x) -(x - 1.235)^2 + 0.78 * x + 0.2,
                   -5, 5, NA, NA, 1, result) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T02:15:29.830

`optimize()`是否有理由不使用使用“黄金分割搜索和连续抛物线插值组合”的内置函数？基于此基准，它比您的代码快 78 倍......（尽管它不会保存所有尝试过的连续值）

```
ff <- function(x) -(x - 1.235)^2 + 0.78 * x + 0.2
library(rbenchmark)
benchmark(golden.section(ff,-5, 5, NA, NA, 1, result),
          optimize(ff,c(-5,5)))
##                   test replications elapsed relative  user.self sys.self 
## 1 golden.section(...)           100   0.936       78     0.904    0.032 
## optimize(ff, c(-5, 5))          100   0.012        1     0.012    0.000 
```

# json - 使用 JSON 数据运行 Hive 查询时出错？

> ID：11514827
> 
> 赞同：1
> 
> 时间：2012-07-17T01:22:45.003
> 
> 标签：json, hadoop, amazon-s3, hive, emr

我有包含以下内容的数据：

```
{"field1":{"data1": 1},"field2":100,"field3":"more data1","field4":123.001}
{"field1":{"data2": 1},"field2":200,"field3":"more data2","field4":123.002}
{"field1":{"data3": 1},"field2":300,"field3":"more data3","field4":123.003}
{"field1":{"data4": 1},"field2":400,"field3":"more data4","field4":123.004} 
```

我将其上传到 S3 并使用 Hive 控制台中的以下内容将其转换为 Hive 表：

```
ADD JAR s3://elasticmapreduce/samples/hive-ads/libs/jsonserde.jar;
CREATE EXTERNAL TABLE impressions (json STRING ) ROW FORMAT DELIMITED LINES TERMINATED BY '\n' LOCATION 's3://my-bucket/'; 
```

查询：

```
SELECT * FROM impressions; 
```

输出很好，但只要我尝试使用[get_json_object UDF](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF#LanguageManualUDF-getjsonobject)

并运行查询：

```
SELECT get_json_object(impressions.json, '$.field2') FROM impressions; 
```

我收到以下错误：

```
> SELECT get_json_object(impressions.json, '$.field2') FROM impressions;
Total MapReduce jobs = 1
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
java.io.IOException: cannot find dir = s3://nick.bucket.dev/snapshot.csv in pathToPartitionInfo: [s3://nick.bucket.dev/]
    at org.apache.hadoop.hive.ql.io.HiveFileFormatUtils.getPartitionDescFromPathRecursively(HiveFileFormatUtils.java:291)
    at org.apache.hadoop.hive.ql.io.HiveFileFormatUtils.getPartitionDescFromPathRecursively(HiveFileFormatUtils.java:258)
    at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat$CombineHiveInputSplit.<init>(CombineHiveInputFormat.java:108)
    at org.apache.hadoop.hive.ql.io.CombineHiveInputFormat.getSplits(CombineHiveInputFormat.java:423)
    at org.apache.hadoop.mapred.JobClient.writeOldSplits(JobClient.java:1036)
    at org.apache.hadoop.mapred.JobClient.writeSplits(JobClient.java:1028)
    at org.apache.hadoop.mapred.JobClient.access$700(JobClient.java:172)
    at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:944)
    at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:897)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
    at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:897)
    at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:871)
    at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:479)
    at org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:136)
    at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:133)
    at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
    at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1332)
    at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1123)
    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:931)
    at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:261)
    at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:218)
    at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:409)
    at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:684)
    at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:567)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:156)
Job Submission failed with exception 'java.io.IOException(cannot find dir = s3://my-bucket/snapshot.csv in pathToPartitionInfo: [s3://my-bucket/])'
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask 
```

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T09:03:26.603

您声明的任何原因：

```
ADD JAR s3://elasticmapreduce/samples/hive-ads/libs/jsonserde.jar; 
```

但不在表定义中使用 serde？请参阅下面的代码片段了解如何使用它。我看不出有任何理由在这里使用 get_json_object 。

```
CREATE EXTERNAL TABLE impressions (
    field1 string, field2 string, field3 string, field4 string
  )
  ROW FORMAT 
    serde 'com.amazon.elasticmapreduce.JsonSerde'
    with serdeproperties ( 'paths'='field1, field2, field3, 
    field4)
  LOCATION 's3://mybucket' ; 
```

# sharepoint - 在同一网站集中的文档库之间移动文件

> ID：11514833
> 
> 赞同：4
> 
> 时间：2012-07-17T01:23:55.357
> 
> 标签：sharepoint, powershell, sharepoint-2007

我需要将大约 10,000 个文件从一个文档库移动到同一网站集中的另一个文档库。我相信 powershell 是做到这一点的最佳手段。

我发现了以下文章：[http](http://blog.isaacblum.com/2011/10/04/spfilecollection-class-copy-files-to-another-document-library/#respond) ://blog.isaacblum.com/2011/10/04/spfilecollection-class-copy-files-to-another-document-library/#respond提出了一种方法但是我'我不确定如何调整这个脚本（我第一次接触到这个项目的 Powershell）。

我尝试了以下方法无济于事：

```
$PSSnapin = Add-PsSnapin Microsoft.SharePoint.PowerShell -ErrorAction SilentlyContinue | Out-Null
clear

$org = "hhttp://farm/sitecollection/Document Library Source/Forms/AllItems.aspx"
$dest = "hhttp://farm/sitecollection/Document Library Destination/Forms/AllItems.aspx"

$orgLibrary = (Get-SPWeb $org).Folders["Documents"]
$destLibrary = (Get-SPWeb $dest).Folders["Documents"]
$destFiles = $destLibrary.Files
foreach ($file in $orgLibrary.Files)
{
    $curFile = $file.OpenBinary()
    $destURL = $destFiles.Folder.Url + "/" + $file.Name
    $destFiles.Add($destURL, $curFile, $true)
} 
```

有没有其他方法可以做到这一点？请注意，我使用的是 MOSS2007 和 Powershell 2.0，而不是 SharePoint 2010。

**更新/半答案：**

根据下面 x0n 的帖子，SharePoint 2007（仅 2010）不支持此功能。我在这个线程之外收到了以下建议，这是相关的，并且应该在将来帮助其他人：

> 不幸的是，SharePoint 2010 的命令行管理程序（它是 PowerShell 管理单元和关联的 cmdlet）与 MOSS 2007 不兼容，并且没有直接从 Microsoft 提供的用于该版本 SharePoint 的 cmdlet。这意味着您仍然可以将 PowerShell 与 MOSS 2007 一起使用，但您要么必须编写自己的 cmdlet 来直接使用 STSADM 或 SharePoint 对象模型，要么必须使用与 MOSS 2007 兼容的来自第三方的 cmdlet。我建议查看 Gary Lapointe 的博客，了解许多适用于 MOSS 2007 (http://blog.falchionconsulting.com/) 的出色 PowerShell cmdlet，或者人们上传 cmdlet 的地方，例如 CodePlex.com、TechNet Script Repository、POSHCode .org 或[http://get-spscripts.com/](http://get-spscripts.com/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T01:35:20.550

我对您无处可去并不感到惊讶：Microsoft.SharePoint.PowerShell 管理单元仅适用于 SharePoint 2010，不适用于 SharePoint 2007 服务器。

坦率地说，最简单的方法是打开 Internet Explorer，导航到源文档库并打开“资源管理器视图”。选择所有文档，然后复制 (ctrl+c)。打开另一个 IE 窗口，对目标文档库执行相同的操作并粘贴 (ctrl+v)。

如果它不会在资源管理器视图中打开，请确保您用来进行复制/粘贴的机器正在运行“WebClient”服务。如果您运行的是 Windows 2008 R2，则此服务不可用，除非您决定添加“桌面体验”功能。找到一台具有 WebClient 服务的 Windows 7 机器要容易得多（但要确保它正在运行。）

**更新：**

也就是说，您的脚本可能大约有 80% 在那里，并且并不真正需要 2010 管理单元。我现在不能测试这个（对不起），但它应该是 99% 正确的：

```
[reflection.assembly]::loadwithpartialname("microsoft.sharepoint") > $null

$org = "http://farm/sitecollection/sourcedoclib" 
$dest = "http://farm/sitecollection/targetdoclib" 

$site = new-object microsoft.sharepoint.spsite $org
$web = $site.openweb()

$srcLibrary = $web.Lists["sourcedoclib"] 
$destLibrary = $web.Lists["targetdoclib"] 

$destFiles = $destLibrary.Folders["Archived"]

foreach ($item in $srcLibrary.Items) 
{ 
   if ($item.File) {
        $curFile = $item.file.OpenBinary() 
        $destURL = $destFiles.Folder.Url + "/" + $item.file.Name 
        $destFiles.Add($destURL, $curFile, $true)
    }
} 
```

祝你好运。

# android - 使用 Build.VERSION_CODES 处理弃用

> ID：11514838
> 
> 赞同：0
> 
> 时间：2012-07-17T01:24:41.127
> 
> 标签：android

WebSettings.setPluginsEnabled（布尔标志）方法已被弃用，取而代之的是 API 级别 8 及以后的 setPluginState(WebSettings.PluginState)。

我的代码需要在 API 级别 6 及更高版本的 Android 上运行，我想使用 Build.VERSION_CODES 来正确处理弃用。

我的问题是：我被迫使用像“7”这样的数字而不是 Build.VERSION_CODE 数字，因为显然 ECLAIR_MR1 仅在 API 级别 7 中引入。如果我使用 ECLAIR_MR1 而不是，我无法在 API 级别 6 上编译我的代码'7'。

我只是应该使用数字而不是 Build.VERSION_CODE 值吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:38:31.260

该项目将使用适当的 targetSdk 构建。

# php - PHP：数组差异；多维数组和二级数组键

> ID：11514839
> 
> 赞同：2
> 
> 时间：2012-07-17T01:24:44.057
> 
> 标签：php, sorting

我正在尝试根据键数组（查询参数）来整理多维数组，但这样做没有运气。

来自数据库的数组：

```
AOD (Array, 2 elements)
  topic (String, 21 characters ) Alcohol & Other Drugs
  lessons (Array, 29 elements)
CEH (Array, 2 elements)
  topic (String, 25 characters ) Community & Environmental
  lessons (Array, 23 elements) 
```

键数组（查询字符串）：

```
0 (String, 3 characters ) AOD
1 (String, 3 characters ) CEH 
```

所以，如果我只传入`AOD`，那么上面的第一个数组只会返回多维数组`AOD`

代码：

```
array_intersect($snsData, array_flip($query_topics)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:36:50.270

**工作代码：**

```
array_intersect_key($snsData, array_flip($query_topics)) 
```

`$query_topics`$_GET 参数数组在哪里

# sql-server - ExecuteNonQuery 返回 -1

> ID：11514854
> 
> 赞同：5
> 
> 时间：2012-07-16T06:20:59.153
> 
> 标签：sql-server, sql-server-2008, sql, ado.net

我有一个存储过程，它返回一个**字符串**值，我必须使用`ExecuteNonQuery`语句执行这个 SP。当我执行这个时，我得到 -1 作为返回值。

我从来没用过`SET NOCOUNT ON`。我怎样才能得到返回值？我没有将返回值声明为`OUTPUT`——只是`SELECT @VARIABLENAME`。如何使用 获得价值`ExecuteNonQuery`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T08:27:15.987

`ExecuteNonQuery`用于执行[只返回受影响的行数的](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx "MSDN")查询（尽管可以填充输出参数）。`-1`表示没有行受到影响或您已设置 nocount。

如果您需要从存储过程中读取数据，请使用另一个 API 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:02:36.697

如果您只获取一个值，如果您使用 .Net 语言，我会使用 ExecuteScalar 命令。我知道Java等有一个等价物。

[http://msdn.microsoft.com/en-us/ibrary/system.data.sqlclient.sqlcommand.executescalar.aspx](http://msdn.microsoft.com/en-us/ibrary/system.data.sqlclient.sqlcommand.executescalar.aspx)

如果您的 SP 中有输出参数，则 ExecuteNonQuery 可以获得返回数据。这篇文章解释了如何。

[http://msdn.microsoft.com/en-us/library/80x06z3b(v=VS.71).aspx](http://msdn.microsoft.com/en-us/library/80x06z3b(v=VS.71).aspx)

不过，如果您只是返回一个字符串 ExecuteScalar 更易于使用。

# sql-server-2008 - 无法在 LLBL Gen Pro 中切换连接字符串

> ID：11514861
> 
> 赞同：1
> 
> 时间：2012-07-17T01:27:39.223
> 
> 标签：sql-server-2008, tsql, llblgenpro, llblgen

我在 Sql 2008 R2 服务器中有两个具有相同架构的数据库，它们的名称是**Database1**和**Database2**。**我连接并在Database1**上执行查询，然后更改为 **Database2**以使用以下代码获取我的实体

```
this.ConnectionString = "Server=TestServer; Database=Database2;Trusted_Connection=true";
using (IDataAccessAdapter adapter = new DataAccessAdapter(this.ConnectionString))
            {
                var entities = new EntityCollection<T>();
                adapter.FetchEntityCollection(entities, null);
                return entities;
            } 
```

（连接字符串是在执行代码之前设置的）。

我调试了应用程序并查看了连接字符串的值，它指向 Database2。

但是，当我执行上述代码时，结果是从**Database1**返回的。如果我查看 SQL Profiler，该语句是针对**Database1**执行的。

那么，有没有人知道发生了什么事？为什么查询是针对**Database1**而不是**Database2**执行的。

PS：如果我将上述连接字符串与普通的 ADO.NET 一起使用，我能够从 Database2 中检索数据。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T04:12:35.760

我已经弄清楚发生了什么。原因是：默认情况下，LLBL Gen Pro 使用完全限定名称，如 [database1].[dbo].[Customer] 来访问数据库对象，并在生成实体时指定目录。因此，您不能仅通过更改连接字符串来访问对象。因此，要更改为另一个数据库，您必须使用以下代码**覆盖默认目录**

```
 var adapter= new DataAccessAdapter(ConnectionString, false, 
                                 CatalogNameUsage.ForceName, DbName)
                             {CommandTimeOut = TenMinutesTimeOut}; 
```

更多信息可以在以下[链接中找到](http://www.llblgen.com/documentation/2.6/using%20the%20generated%20code/Adapter/gencode_dataaccessadapter_adapter.htm)

# ruby-on-rails-3 - Rails 3反序列化数组

> ID：11514863
> 
> 赞同：1
> 
> 时间：2012-07-17T01:27:49.987
> 
> 标签：ruby-on-rails-3, serialization

这是我第一次序列化。我在客户端用 jQuery 序列化了一组复选框，将其放入隐藏元素中，然后提交表单。现在在服务器端，我想反序列化为我可以使用的数组。这是我在客户端的字符串。

```
 someArray%5B%5D=value0&someArray%5B%5D=value1 
```

在 Rails 3 中，我想得到一个如下所示的数组：

```
["value0", "value1"] 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:42:47.540

如果您将这些值作为典型的 post 参数提交给您的请求，Rack 将自动解析这些值。例如：

```
curl http://yoursite.com -d "array[]=somevalue&array[]=othervalue" 
```

然后，这将`params[:array]`在您的应用程序中可用，包含两个具有指定值的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T03:39:03.090

对于序列化，我想出了一些东西，并且我已经在生产中工作了一段时间。假设我有一个带有 3 种不同类型小工具的汽车模型。（假设我不想要数据库中的 3 个字段）：

在您的数据库中必须是一个名为 gadgets as TEXT 的字段（这非常重要）

在碳水化合物.rb

```
serialize :gadgets
attr_accessible :alarm, :ac, :tires
ALARM = 0;
AC = 1;
TIRES = 2;

# this is the getter for alarm
def has_alarm
  if self.gadgets.nil?
    return 0
  else
    if self.gadgets[ALARM].nil?
      return 0
    else
      return self.gadgets[ALARM]
    end
end

# this is the setter for alarm
def has_alarm=(value)
  self.gadgets = Array.new if self.gadgets.nil?
  self.gadgets[ALARM] = value
end

# getter 
def has_ac
  if self.gadgets.nil?
    return 0
  else
    if self.gadgets[AC].nil?
      return 0
    else
      return self.gadgets[AC]
    end
end

# setter
def has_ac=(value)
  self.gadgets = Array.new if self.gadgets.nil?
  self.gadgets[AC] = value
end

... 
```

在你的 _form.rb

```
<%= f.check_box :has_alarm %> I want alarm in my car
<%= f.check_box :has_ac %> I want AC in my car
<%= f.check_box :has_tires %> I want deluxe tires in my car 
```

我希望您以后不必搜索这些字段...

# javascript - Javascript编译器/依赖管理器？

> ID：11514865
> 
> 赞同：0
> 
> 时间：2012-07-17T01:27:59.127
> 
> 标签：javascript, web

我有很多 JS 文件。其中一些相互依赖。其中许多依赖于 jQuery。我需要可以接受一个文件作为参数的工具，可传递地获取其所有依赖项并以正确的顺序将它们编译到一个文件中（基于依赖项）

依赖信息并不总是在文件本身内部可用，因此最好将它放在外部（xml文件？文件夹结构？）

我听说过 Yahoo JS 编译器、闭包等，但我不确定它们是否能满足我的需求。

看：我有模块“CustomerPage”。它应该包括“validation.js”和“gui.js”。两者都需要 jquery.js。而“gui.js”也需要“myFunctions.js”。

我想要一些 ant 任务或一些脚本，作为所有这些文件的结果，它们会生成“CustomerPage.js”。

工具应检查依赖顺序，防止双重包含等。

我的项目可能有大约 500 个 js 文件，我怎么能没有这个工具呢？人们说“使用 GWT”，但我需要纯 JS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:55:42.277

您可能想查看一种 AMD 风格的模块加载器，例如[RequireJS](http://requirejs.org/)。其中一些可以执行您想要的预编译，并且可以在开发模式下运行，通过直接包含所有文件，可以更轻松地进行调试。

# php - 从 PHP 执行一个 javascript 函数并返回响应

> ID：11514867
> 
> 赞同：0
> 
> 时间：2012-07-17T01:28:15.750
> 
> 标签：php, javascript, html, json

我正在尝试通过将变量发送到我的 javascript 函数来从 PHP 脚本执行 javascript 函数，然后它将返回响应。我希望 PHP 脚本只回显来自 javascript 函数的响应，因此当客户端查看我的 php 文件的源代码时，他只看到来自 javascript 函数的响应，而不是 javascript 源代码。

例如，

我有一个名为 validate() 的 javascript 函数和一个名为 check.php 的 PHP 文件。客户端使用 GET 方法调用函数，如下所示，

www.myserver.com/check.php?value=test

然后我希望 check.php 将变量 $value 发送到我的 javascript 函数 validate()，以执行以下操作，

响应=验证（$值）

然后 javascript 将值响应返回到我的 PHP 脚本并将其存储在变量 $response 中，然后它将回显 $response。因此，当我查看源代码时，我只会看到变量 answer 中的内容。

我找不到一个简单的方法来做到这一点：S。如果我使用 AJAX，我将需要在 HTML 中使用 div，但重要的是只有 $response 的内容会显示在源代码中？

有人可以指出我应该使用哪些 PHP 函数吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T01:59:18.423

PHP 通常在服务器端运行，而 Javascript 通常在客户端（在浏览器中）运行。

在正常模型中，客户端向服务器发出请求，服务器响应。在这种情况下，PHP 代码不可能直接“调用”Javascript 函数。

那么你的问题的解决方案是什么？

按优先顺序：

1.  第一个，最好的选择是重新架构，这样您就不需要`validate()`从 PHP 中调用 javascript 函数。例如，将 Javascript 逻辑移植到 PHP。

2.  如果不能移植，请在服务器端运行 Javascript。Node.js 在 Linux 和 Windows 的服务器端运行；如果你有 Windows/IIS，更简单的选择是通过 ASP 经典提供 Javascript，是的，在当前的 Windows 服务器上仍然可用。PHP 程序可以简单地通过 curl 请求本地 Javascript 资源；服务器调用逻辑并返回结果。在一般情况下，Javascript 不需要在同一台服务器上运行。

3.  最后，如果这不是一个选项，您可以让浏览器`validate()`代表服务器执行。PHP 可以在 javascript 脚本块中向浏览器发出验证函数。PHP 也可以发出需要验证的东西——一个数据包，或者任何它。然后，浏览器可以`validate()`在该对象上，并通过 AJAX 向 PHP 发布消息以报告结果。但是，这里有一个安全问题 - 请记住，客户端不在您的控制范围内，因此有人可能会破坏客户端验证逻辑并导致客户端向 PHP 服务器报告错误结果。你不能指望tihis。

因此，您需要在事务中嵌入某种数据完整性检查 - 某种方式可以确保客户端 JavaScript 未被修改。这将是困难的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:37:57.493

你不应该*起诉*任何功能：P

然而，虽然这是一种看似可怕的验证方式，但您可以执行以下操作：

*   将 javascript 输出到 HTML 文件。（放在容易找到的地方）
*   用于`fopen`在将由 js 函数拾取的 URL 中使用您的参数打开一个 URL。
*   让您的 PHP 函数解析 HTML 文件（您曾经`fopen`获取）以获取输出并搜索您想要的特定输出。

但实际上，您应该只在 PHP 脚本本身中进行验证。如果您想更改某些内容，以后使用起来会更安全、更容易、更容易。

# castle-windsor - Castle.Windsor for ASP.NET Web API 教程

> ID：11514872
> 
> 赞同：2
> 
> 时间：2012-07-17T01:28:51.420
> 
> 标签：castle-windsor, asp.net-web-api

我的搜索还没有找到一个像样的教程，关于如何为 ASP.NET Web API（ IHttpController 而不是 IController ）实现 Castle.Windsor ...

有一些博客讨论了这个话题，但这些都需要对 DI 和温莎有专家级的理解。

有谁知道关于这个主题的教程，对于 DI 和 Windsor 相对较新的人可以遵循？

类似于 MVC3 的 Windsor 教程：

[http://stw.castleproject.org/Windsor.Windsor-tutorial-part-one-getting-Windsor.ashx](http://stw.castleproject.org/Windsor.Windsor-tutorial-part-one-getting-Windsor.ashx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T18:20:50.190

[http://blog.ploeh.dk/2012/10/03/DependencyInjectionInASPNETWebAPIWithCastleWindsor.aspx](http://blog.ploeh.dk/2012/10/03/DependencyInjectionInASPNETWebAPIWithCastleWindsor.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T12:58:21.603

You could try downloading the code from *WebApiContrib*, and dig into that. You can find the **Castle Windsor** part [here](https://github.com/WebApiContrib/WebAPIContrib/tree/rc/src/WebApiContrib.IoC.CastleWindsor)

Not much of a tutorial though, as it gives you the entire code, but it might help :)

# automapper - 需要帮助使用 AutoMapper 将 ViewModel 映射到实体

> ID：11514873
> 
> 赞同：1
> 
> 时间：2012-07-17T01:29:03.327
> 
> 标签：automapper

我是自动映射器的新手。需要一些帮助才能从 ViewModel 映射到实体。

这是我的用户实体

```
public class User
{
    public int Id { get; set; }
    public string Firstname { get; set; }
    public string Lastname { get; set; }

    public DateTime CreatedDate { get; set; }
    public string DisplayName { get; set; }
} 
```

这是我的视图模型

```
public class UserViewModel
{

    public string Email { get; set; }
    public string Password { get; set; }
} 
```

我创建了一张地图。它不工作

```
 CreateMap<UserLoginViewModel, User>()
            .ForMember(dest=>dest.CreatedDate, DateTime.Now)
            .ForMember(dest=>dest.DisplayName, ""); 
```

DisplayName 和 CreatedDate 是必填字段。由于它不在 ViewModel 中，我将设置 DisplayName = "" 和 CreateDate = datetime.now。

我想知道我是否可以使用自动映射器来做，或者我必须在映射后做。

请给我看一些示例代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T05:47:13.670

您提到您有 UserViewModel 视图模型和用户实体，但是您的映射配置包含第三种类型 - UserLoginViewModel。假设 UserLoginViewModel 与 UserViewModel 相同，您应该如下更改配置。

```
 Mapper.CreateMap<UserViewModel, User>()
        .ForMember(dest=>dest.CreatedDate, t=> t.MapFrom(s=> DateTime.Now))
        .ForMember(dest=>dest.DisplayName, t=> t.MapFrom(s=> "")); 
```

[AutoMapper 维基](https://github.com/AutoMapper/AutoMapper/wiki)。

# c# - 用于创建数据的 linq 查询和外部

> ID：11514874
> 
> 赞同：0
> 
> 时间：2012-07-17T01:29:20.860
> 
> 标签：c#, linq, foreign-keys

我遇到的问题是我正在使用表“locationstation”并在里面创建站和位置，并且站和位置都通过它们的主键链接到 locationstation。我已经成功地在组合框中显示了他们的数据，但现在的问题是我不知道如何选择组合框中的数据并将数据保存在 locationstation 表中。

```
 private void btnCreate_Click(object sender, EventArgs e)
    {
        using (testEntities Setupctx = new testEntities())
        {
            //station selectStation = cbStation.SelectedItem as station;
            //location selectLocation = cbLocation.SelectedItem as location;

            string selectStation = cbStation.SelectedItem.ToString();
            string selectLocation = cbLocation.SelectedItem.ToString();
            locationstation creLS = new locationstation();
            creLS.idStation = cbStation.SelectedItem.ToString();
            selectLocation.Location1 = (string)cbLocation.SelectedItem;
            Setupctx.locationstations.AddObject(selectStation);
            //Setupctx.SaveChanges();
            //cbStation.SelectedIndex = -1;
            //cbLocation.SelectedIndex = -1;

            MessageBox.Show("New Location Station Is Created");
        }
    } 
```

我不知道如何让它工作，但我正在尝试的代码就在这里。帮助将不胜感激。

这是我将站名和位置名绑定到组合框中的代码。

```
private void Create_LS_Load(object sender, EventArgs e)
    {
        using (testEntities Setupctx = new testEntities())
        {
            var storeStation = (from SLS in Setupctx.locationstations
                                        join station s in Setupctx.stations on SLS.idStation equals s.idstations
                               select s.Station1).Distinct().ToList();                                   
            foreach (var LocationStation in storeStation)
            {
                cbStation.Items.Add(LocationStation);
            }

            var storeLocation = (from SLS in Setupctx.locationstations
                                join location l in Setupctx.locations on SLS.idLocation equals l.idlocation
                                select l.Location1).Distinct().ToList();                                      
            foreach (var LocationStation1 in storeLocation)
            {
                cbLocation.Items.Add(LocationStation1);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:48:37.410

嗨，在使用添加对象之前，将 selectStation 的所有导航属性设置为 null

```
Setupctx.locationstations.AddObject(selectStation); 
```

代替

字符串选择站 = cbStation.SelectedItem.ToString();

利用

LocationStation selectStation=(LocationStation)cbStation.SelectedItem;

然后从 selectStation 中提取值或用它做你想做的事。我希望这将有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T03:02:08.650

```
Station selectStation = (Station)cbStation.SelectedItem ; //cast here to your T
Location selectLocation = (Location)cbLocation.SelectedItem; //cast here to your T

locationstation creLS = new locationstation() 
{
 StationId=selectStation.Id ,
 LocationId=selectLocation.Id
};

Setupctx.locationstations.AddObject(creLS);
Setupctx.SaveChanges(); 
```

但是我无法想象在带有键/值数据的组合框上做类似上面的事情。因为可能通过使用 .ToDictionary() （其中 T 是主键的类型）将查找类型组合框绑定到 KeyValuePair 通过设置 ValueMember = Key 和 DisplayMember =Value (或您的组合控件中的任何键/值属性）然后您可以执行此操作，例如：

```
long GetSelectedId(comboBox cbo)
{

long IdOut=-1;

if (cbo.SelectedItem==null)
return IdOut;

KeyValuePair<long, string> Item= (KeyValuePair<long, string>)cbo.SelectedItem;
IdOut   = Item.Key;

return IdOut;

} 
```

# php - 查找最后一个项目名称的正则表达式

> ID：11514880
> 
> 赞同：0
> 
> 时间：2012-07-17T01:30:20.710
> 
> 标签：php, regex

所以我有一个字符串如下

```
Continent | Country | Region | State | Area | Town 
```

有时字符串是

```
Continent | Country | Region | State | Area 
```

获取最后一个条目（即城镇或区域）的正则表达式是什么？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T01:40:19.433

不需要正则表达式！

```
$str = 'Continent|Country|Region|State|Area';

$exp = explode('|', $str);

echo end($exp); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T01:46:15.850

以防万一有人确实想要正则表达式（也删除前面的空格）：

```
$string = 'Continent | Country | Region | State | Area | Town';

preg_match('/[^|\s]+$/', $string, $last);
echo $last; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T01:43:03.947

[当您可以使用PHP 字符串函数](http://php.net/manual/en/ref.strings.php)实现相同功能时，我不会使用正则表达式：

```
$segments = explode(' | ', 'Continent | Country | Region | State | Area | Town');
echo end($segments); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-17T01:47:10.117

这是另一个解决方案。

```
$str = 'Continent|Country|Region|State|Area';
$last = substr(strrchr($str,'|'),1); 
```

请注意，这仅在有多个项目时才有效，否则 strrchr 将返回 false。

# php - PHP数组总和没有加起来所有项目

> ID：11514881
> 
> 赞同：0
> 
> 时间：2012-07-17T01:30:32.387
> 
> 标签：php, mysql

这是我用来尝试计算“amountReceived”列的总和的代码。invID '95' 的总数应该 = 312，但由于某种原因，它只有 = 300。我不确定问题出在哪里。（请参阅下面的数据库图像）。

```
$sql = mysql_query("SELECT amountReceived FROM payments WHERE invID='".$id."'");
$result = mysql_fetch_array($sql);
$totalPayment = array_sum($result);
$balanceDue = $invoiceTotal - $totalPayment; 
```

![在此处输入图像描述](../Images/8d6d3fc3ba40274b0e1dcbe306f6896f.png)

![在此处输入图像描述](../Images/466ea84050f54cf80a18a77c06d04670.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T01:36:24.437

使用 SUM() 怎么样？

```
$sql = mysql_query("SELECT SUM(amountReceived) FROM payments WHERE invID='".$id."'");
$totalPayment = mysql_fetch_row($sql); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-17T01:41:39.007

那么 mysql_fetch_array($sql) 返回一个数组，其中包含您获取的一行的所有“列”，这意味着您获得了一个例如数组（'amountReceived'=>150）

这应该工作：

```
$sql = mysql_query("SELECT amountReceived FROM payments WHERE invID='".$id."'");
$totalPayment = 0;
while($result = mysql_fetch_array($sql)) {
    $totalPayment += $result['amountReceived'];
}
$balanceDue = $invoiceTotal - $totalPayment; 
```

这只是问题的 php 侧面描述，如果您想更高效，请使用[sel](https://stackoverflow.com/users/1457638/sel)的版本；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:37:18.733

1.  不要使用`mysql_*`函数 - 使用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)。
2.  `print_r($result);`看看里面有没有东西。

# c++ - CS107 作业文件

> ID：11514882
> 
> 赞同：0
> 
> 时间：2012-07-17T01:30:34.843
> 
> 标签：c++, c, macos, unix

我正在尝试在我的 Mac 上运行斯坦福 CS107 作业文件，但每当我尝试运行二进制文件时，我都会收到错误“权限被拒绝”。如果我对文件进行 chmod 以使我具有执行权限，则会收到一条错误消息，提示“无法执行二进制文件”。

如何执行这些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T02:20:04.433

我无法运行 imdb-test-linux 二进制文件，因为没有给出所有源文件。要运行 imdb-test 文件，imdb-utils.h 文件中存在问题。代码使用

```
const char *ostype = getenv("OSTYPE"); 
```

由于某种原因，它在我的 Mac 上返回 Null。要解决此问题，请在 imdb-utils.h 文件内的“determinePathToData”函数中返回您放置数据文件的目录。

运行“make imdb-test”，它应该运行。

希望这可以帮助某人:)

# android - 为 Eclipse Helios 安装 ADT 插件时发生冲突的依赖项

> ID：11514883
> 
> 赞同：0
> 
> 时间：2012-07-17T01:30:40.203
> 
> 标签：android, eclipse, android-emulator, eclipse-plugin, adt

我正要开始制作一个 android 应用程序，为此我遵循了启动安装指南安装 ADT 插件时，它给了我以下依赖错误。谁能告诉我我应该如何完成我的 DDMS-Android 安装。

..........................错误详情...................... .....................

```
Cannot complete the install because of a conflicting dependency.
  Software being installed: Android DDMS 20.0.0.v201206242043-391819 (com.android.ide.eclipse.ddms.feature.group 20.0.0.v201206242043-391819)
  Software currently installed: Eclipse IDE for Java EE Developers 1.3.0.20100617-0521 (epp.package.jee 1.3.0.20100617-0521)
  Only one of the following can be installed at once: 
    Eclipse UI 3.6.1.M20100826-1330 (org.eclipse.ui 3.6.1.M20100826-1330)
    Eclipse UI 3.6.2.M20110203-1100 (org.eclipse.ui 3.6.2.M20110203-1100)
    Eclipse UI 3.6.0.I20100603-1100 (org.eclipse.ui 3.6.0.I20100603-1100)
  Cannot satisfy dependency:
    From: Android DDMS 20.0.0.v201206242043-391819 (com.android.ide.eclipse.ddms.feature.group 20.0.0.v201206242043-391819)
    To: org.eclipse.ui 3.6.2
  Cannot satisfy dependency:
    From: Eclipse IDE for Java EE Developers 1.3.0.20100617-0521 (epp.package.jee 1.3.0.20100617-0521)
    To: org.eclipse.epp.package.jee.feature.feature.group [1.3.0.20100617-0521]
  Cannot satisfy dependency:
    From: Java EE IDE Feature 1.3.0.20100617-0521 (org.eclipse.epp.package.jee.feature.feature.group 1.3.0.20100617-0521)
    To: org.eclipse.platform.feature.group [3.6.0.v20100602-9gF78GpqFt6trOGhL60z0oEx3fz-JKNwxPY]
  Cannot satisfy dependency:
    From: Eclipse Platform 3.6.0.v20100602-9gF78GpqFt6trOGhL60z0oEx3fz-JKNwxPY (org.eclipse.platform.feature.group 3.6.0.v20100602-9gF78GpqFt6trOGhL60z0oEx3fz-JKNwxPY)
    To: org.eclipse.rcp.feature.group [3.6.0.v20100519-9OArFKvFtsd7WLUKh-DcYTS]
  Cannot satisfy dependency:
    From: Eclipse RCP 3.6.0.v20100519-9OArFKvFtsd7WLUKh-DcYTS (org.eclipse.rcp.feature.group 3.6.0.v20100519-9OArFKvFtsd7WLUKh-DcYTS)
    To: org.eclipse.ui [3.6.0.I20100603-1100]

................................................Error report.............................................. 
```

**更新：-**

```
Note: 1) I finished installing Eclipse Helios v- 3.6.2
      2) Android SDK.
      3) and was On a verge of installing the ADT in Eclipse for Windows 7 from this site-> https://dl-ssl.google.com/android/eclipse/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:53:32.947

Eclipse p2 的错误消息对用户不友好。通常它是由 ADT 20 所需的 Eclipse 3.6.2 引起的，但是您的 Eclipse 包（J2EE 开发人员的 IDE）依赖于 Eclipse 3.6.0。所以由于依赖冲突，无法安装ADT。

可能的解决方案可能是，

1.  将您的 Eclipse 包更新到最新版本，包括 Eclipse 3.6.2 或更高版本
2.  下载一个刷新的 Eclipse 包，比如 Juno 或 Indigo，然后在上面安装 ADT 20

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:57:29.237

尝试更新您的 eclipse 或下载最新的 eclipse 版本，然后它必须工作。

# image - visual basic 6 图像类

> ID：11514890
> 
> 赞同：0
> 
> 时间：2012-07-17T01:31:15.790
> 
> 标签：image, vb6

以下代码是更改图像或通知用户图像是否已更改的表单代码。在表单中，我有一个名为**Image1**的 Image 控件，它的 Picture 属性必须更改。我只是寻求有关如何从此代码制作类模块（.cls）的帮助。

```
Private Image1Color As String

Private Sub Form_Load()

    Image1Color = "Green"

End Sub

Private Sub CheckIn1_Click()

    If Image1Color = "Green" Then
        Image1.Picture = LoadPicture ("Color\red1.jpg")
        Image1Color = "Red"
    Else
        MsgBox ("This table is already occupied")
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T00:01:03.797

如果您想从字面上重用您的表单代码，您可以执行以下操作：

ImageControlWrapper.cls：

```
Private m_ksColor_Green As String = "Green"
Private m_ksColor_Red As String = "Red"

Private m_sImageColor As String
Private WithEvents m_oImageControl As Image

Private Sub Class_Initialize()

    m_sImageColor = m_ksColor_Green

End Sub

Public Sub Attach(ByRef in_oImageControl As VB.Image)

    Set m_oImageControl = in_oImageControl

End Sub

Private Sub m_oImageControl_Click()

    If m_sImageColor = m_ksColor_Green Then
        Set m_oImageControl.Picture = LoadPicture("Color\red1.jpg")
        m_sImageColor = m_ksColor_Red
    Else
        MsgBox "This table is already occupied"
    End If

End Sub 
```

测试.frm：

```
Private m_oImageControlWrapper As ImageControlWrapper

Private Sub Form_Load

    Set m_oImageControlWrapper = New ImageControlWrapper
    m_oImageControlWrapper.Attach Image1

End Sub 
```

我纯粹使用字符串常量来表示颜色，以便编译器可以在您拼错常量时发现错误。如果你拼错了实际的字符串，这是一个需要修复的烦人的错误。但是，如果您真的不需要使用字符串，最好将 m_sImageColor 转换为布尔类型或枚举类型。

# javascript - 本地主机中的对象未定义（Javascript）但不在生产中

> ID：11514891
> 
> 赞同：-1
> 
> 时间：2012-07-17T01:31:17.350
> 
> 标签：javascript, asp.net, debugging, undefined

我们在 ASP.NET 页面上加载了两个 Javascript 文件。一个是 CommonUI.js，另一个是 Entity.Js

该页面调用 Entity.Js 中的一个函数，该函数调用 CommonUI.Js 中的一个函数。但是，在我的本地环境中，我收到错误“CommonUI”未定义。

在他们的生产环境中，这很好。

我已经检查了 CommonUI.js 是否已加载。调试它会触发 Entity.Js 中的函数，但会失败，因为在 CommonUI (CommonUI.WindowResize() ) 上调用的函数指向未定义的对象。

所以我的问题是......为什么没有只在我的本地主机中定义 CommonUI？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T03:04:50.107

我认为您的问题可能与用于 JS 文件的路径有关。

您可以在页面标题中添加对这两个 JS 文件的引用：

```
<script type="text/javascript" src='<%= Page.ResolveUrl("~/js/Entity.js") %>'></script>
<script type="text/javascript" src='<%= Page.ResolveUrl("~/js/CommonUI.js") %>'></script> 
```

如果您使用的是母版页结构，您可能需要将引用包装在 ASP 占位符服务器控件中。

```
 <asp:PlaceHolder ID="PlaceHolder1" runat="server">
        <script type="text/javascript" src='<%= Page.ResolveUrl("~/js/Entity.js") %>'></script>
        <script type="text/javascript" src='<%= Page.ResolveUrl("~/js/CommonUI.js") %>'></script>
    </asp:PlaceHolder> 
```

# jquery - JQuery 多表单提交

> ID：11514892
> 
> 赞同：1
> 
> 时间：2012-07-17T01:31:45.547
> 
> 标签：jquery, forms, validation

> **可能重复：**
> [jQuery 多个表单提交](https://stackoverflow.com/questions/11373361/jquery-multiple-forms-submit)

以下代码是JQuery部分

```
 $("form").validate({
        submitHandler: function(form) {
            $.post('bin/Profile.php', $("form").serialize(), function(data) {
                $('#ProfileWall').prepend(data);
            });
        }
    });
}); 
```

在此之后，我有多种形式。<form> id 是唯一的，每个表单在隐藏的 <input> 中都有不同的信息，但所有输入都具有相同的 id。当我提交任何表单时，它总是提交最后一个表单的值。谁能帮我修改此代码以支持我的所有表单。（表单是由从 mysql 数据库中提取信息的 while 循环生成的）

# visual-studio-2010 - Visual Studio 预构建事件：批处理文件退出代码为 -1

> ID：11514894
> 
> 赞同：3
> 
> 时间：2012-07-17T01:32:28.360
> 
> 标签：visual-studio-2010, command-line, batch-file, exit-code

为了解决[IIS Express Blocks VS 2010SP1 Builds](https://stackoverflow.com/questions/11445157/iis-express-blocks-vs-2010sp1-builds)的问题，我创建了一个简单的批处理文件

```
taskkill /IM iisexpress.exe
exit 0 
```

并将该批处理文件设置为预构建事件。

如果 IIS Express 确实在运行，那么它运行良好。但是，如果 IIS Express*未*运行，则构建将失败并显示以下输出：

> 找不到进程“iisexpress.exe”。
> 命令“E:\Software\Util\KillIisExpress.bat”以代码 -1 退出。

如果我使用 taskkill 命令而不是批处理文件作为预构建事件，则错误更改为

> 命令“taskkill /IM iisexpress.exe”以代码 128 退出。

如何修改批处理文件，以便无论 taskkill 返回什么退出代码，批处理文件都返回退出代码 0，以便 VS 构建成功？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T03:27:26.280

您可以使用

```
taskkill /FI "IMAGENAME eq iisexpress.exe" 
```

如果 iisexpress.exe 未运行，它将输出一条信息消息，但将返回 0。您不需要带有此的批处理文件，只需将该命令添加为 Pre-Build Event 命令行。

# grammar - GOLD Parser 注释语法

> ID：11514895
> 
> 赞同：1
> 
> 时间：2012-07-17T01:32:29.970
> 
> 标签：grammar, bnf, dfa, gold-parser

我的语法中的注释块有一些问题。语法很好，但第 3 步 DFA 扫描程序抱怨我的处理方式。

我试图解析的语言如下所示：

{statement}{statement} 等

每个语句中可以包含几种不同类型的注释：

```
{% This is a comment.
It can contain multiple lines
and continues until the statement end}

{statement  REM This is a comment.  
It can contain multiple lines  
and continues until the statement end} 
```

这是一个简化的语法，显示了我遇到的问题：

```
"Start Symbol" = <Program>

{String Chars} = {Printable} + {HT} - ["\]
StringLiteral = '"' ( {String Chars} | '\' {Printable} )* '"'

Comment Start = '{%'
Comment End = '}'
Comment Block @= { Ending = Closed }  ! Eat the } and produce an empty statement
!Comment @= { Type = Noise }  !Implied by GOLD

Remark Start = 'REM'
Remark End = '}'
Remark Block @= { Ending = Open }  ! Don't eat the }, the statements expects it
Remark @= { Type = Noise }

<Program> ::= <Statements>
<Statements> ::= '{' <Statement> '}' <Statements> |  <>
<Statement> ::= StringLiteral 
```

第 3 步是抱怨 <Statements> 中的 } 和词组末尾的 }。

有人知道如何完成我需要的吗？

**[编辑]**
我让 REM 部分使用以下内容：

```
{Remark Chars} = {Printable} + {WhiteSpace} - [}]
Remark = 'REM' {Remark Chars}* '}'
<Statements> ::= <Statements> '{' <Statement> '}'
              |  <Statements> '{' <Statement> <Remark Stmt>
              |  <>
<Remark Stmt> ::= Remark 
```

这实际上是理想的，因为备注对我来说不一定是噪音。

仍然有评论词汇组的问题。我会以同样的方式解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T12:00:24.997

我认为用词汇组捕获 REM 注释是不可能的。

我认为您需要像这样定义一个新终端：

```
Remark = 'REM' ({Printable} - '}')* 
```

然而，这意味着，您需要能够在您的作品中处理这个新终端......

例如。从：

```
<CurlyStatement> ::= '{' <Statement> '}' 
```

至：

```
<CurlyStatement> ::= '{' <Statement> '}'
                   | '{' <Statement> Remark '}' 
```

我没有检查上面例子中的语法，但我希望你能明白我的想法

# javascript - Javascript对象的操作

> ID：11514896
> 
> 赞同：0
> 
> 时间：2012-07-17T01:32:40.513
> 
> 标签：javascript, jquery, arrays

我的 javascript 中有一个对象，如下所示：

```
{"data":[{"t":{
                "level":"35",
                "longtitude":"121.050321666667",
                "latitude":"14.6215366666667",
                "color":"#040098"}},
         {"t":{
                "level":"31",
                "longtitude":"121.050316666667",
                "latitude":"14.621545",
                "color":"#040098"}},
         {"t":{
                "level":"29",
                "longtitude":"121.050323333333",
                "latitude":"14.62153",
                "color":"#040098"}},
//  ..... 
```

我想做的是遍历我的对象的内容，以便我能够独立地将它们推送到各自的数组中。我有一个经度、纬度、颜色和级别的数组。

所以我尝试了以下方法：

```
var size = 0, key;
for (key in result) {
    if (result.hasOwnProperty(key)) size++;
    alert(result.data[size]);
} 
```

-->但这只会提醒我“[object Object]”

```
success: function(result){
    var size = 0, key;
    for (key in result) {
        for(var attr in key){
            alert(attr['latitude']);
        }
    }
} 
```

-->这给了我未定义的结果[key]

我通过这些代码检查了我的对象的大小只有 1

```
var size = 0, key;
for (key in result) {
    if (result.hasOwnProperty(key)) size++;
}
alert(size); 
```

我相信只有“数据”被读取。而其他在“数据”中的则被忽略。

我已经阅读[了 this](https://stackoverflow.com/questions/3399550/associative-arrays-in-javascript) , [this](https://stackoverflow.com/questions/6709300/objects-as-associative-arrays-for-loop) , [enter link description here](https://stackoverflow.com/questions/575480/associative-arrays-in-javascript)和[this](https://stackoverflow.com/questions/6709300/objects-as-associative-arrays-for-loop) 但它们似乎都处理了不同的对象结构。感谢您的帮助。

**更新** 使用console.log（），我已经确认，如果我没记错的话，只有第一个属性被获取

```
t
    Object { level="35", longtitude="121.0508", latitude="14.6204083333333", more...}
color       "#040098"
latitude    "14.6204083333333"
level       "35"
longtitude  "121.0508" 
```

我试过这个

```
for (key in result) {
            if (result.hasOwnProperty(key)) size++;
            console.log(result.data[size]['level']);
        } 
```

--> 但它说未定义

基于我的对象的结构，即

```
data:[{"t":{'others'},'others'...] 
```

我如何阅读“数据”中的所有内容？每个“数据”都有“t”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T01:46:42.730

**更新：不***推荐*使用`for...in`构造来遍历数组。另一种方法是常规的 for 循环（当然每种方法都有各自的优点）：

 *```
for(var i=0; i<results.data.length; i++){
    alert(results.data[i]['t']['latitude']);
    // etc...
} 
```

* * *

请注意 JSON 的结构。另请注意，javascript foreach 循环遍历键/索引——而不是值。见演示：http: [//jsfiddle.net/g76tN/](http://jsfiddle.net/g76tN/)

```
success: function(result){
    var latitudes = [];
    // and so on...

    for (var idx in result.data ) {
        if( result.data.hasOwnProperty(idx) ){
            alert( result.data[idx]['t']['latitude'] );

            // So you would do something like this:
            latitudes.push ( result.data[idx]['t']['latitude'] );
            // and so on...
        }
    }
}​ 
```

注意在数组中收集对象的属性，[jQuery——`$.map()`](http://api.jquery.com/jQuery.map/)或本机 js 数组映射——是一个简洁、有用的替代方案。

```
var latitudes = $.map( result.data, function(n){
    return n['t']['latitude'];
});
// and so on... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:49:17.940

假设`result`是您的对象，这应该只是遍历您的`data`数组的问题：

```
for (var i = 0; i < result.data.length; ++i) {
    console.log(result.data[i].t.latitude);
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T01:51:50.547

做起来不难，如下图。但是你为什么要使用像你`t`的 's 这样有用的对象并将它们变成这样的数组呢？

```
var levels = [], longitudes= [], latitudes = [], colors = [];
var result = {"data":[{"t":{
            "level":"35",
            "longtitude":"121.050321666667",
            "latitude":"14.6215366666667",
            "color":"#040098"}},
     {"t":{
            "level":"31",
            "longtitude":"121.050316666667",
            "latitude":"14.621545",
            "color":"#040098"}},
     {"t":{
            "level":"29",
            "longtitude":"121.050323333333",
            "latitude":"14.62153",
            "color":"#040098"}}
]};

var data = result.data;
var i, len, t;

for (i = 0, len = data.length; i < len; i++) {
    t = data[length].t;
    levels[i] = t.level;
    longitudes[i] = t.longtitude;
    latitudes[i] = t.latitude;
    colors[i] = t.color;   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T01:51:06.903

请参阅[http://jsfiddle.net/VGmee/](http://jsfiddle.net/VGmee/)，它保留了`hasOWnProperty`（这很重要），以及您对“经度”的拼写错误，而不是。

```
var data = input.data,
    result = {level: [], longtitude: [], latitude: [], color: []};

for (var i = 0, n = data.length; i < n; i += 1) {
    var info = data[i].t;
    for (var property in info) {
        if (info.hasOwnProperty(property)) {
            result[property].push(info[property]);
        }
    }
}

console.log(result.level);
console.log(result.latitude);
console.log(result.longtitude);
console.log(result.color); 
```

这要求结果数组实际上具有输入数组中的属性，但您可以根据需要添加错误处理。*

# c - 在 ANSI C 中从 OpenSSL 接收输出的另一种方式

> ID：11514898
> 
> 赞同：2
> 
> 时间：2012-07-17T01:32:50.157
> 
> 标签：c, pointers, openssl, exec

这是一个家庭作业，所以我不会分享我的代码。我只被允许进行“笔下”讨论。我想这就是他所说的，所以基本上只是一个讨论。我不是在寻找代码专家。

在我的程序中，我多次 fork 并使用 dgst 执行 execlp openssl，它返回一个 MD5 哈希（？）。我正在使用此字符串来比较多个文件以查看它们是否相同。

目前，我发现从中获取输出的唯一方法是使用 -out 并将其保存到文件中，但是一遍又一遍地执行此操作不会附加文件，它只是重写文件，所以这样做有点一个缓慢而痛苦的过程。

我在问是否有办法通过 exec 或 openssl 将这个输出字符串写入一个指针，然后父级可以从那里访问和操作，所以我不会写入文件并通过父级读取它，一个进程一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:18:52.400

在您之前`fork`，您可以使用`pipe`创建一对单向文件描述符（一个用于读取，一个用于写入）。之后`fork`，您可以使用`dup2`将该子进程的管道写入端设置为输出文件描述符，然后`exec`。然后，当父进程从管道的读取端读取时，它将读取子进程正在写入其`stdout`.

由于您正在比较多个子进程的输出，因此每个子进程都应该有自己的管道。

```
int fd[2];
pipe(fd);
pid_t pid = fork();
if (pid == 0) {
    close(fd[0]);
    dup2(fd[1], 1);
    execlp(/*...*/);
} else if (pid > 0) {
    close(fd[1]);
    while (read(fd[0], /*...*/) > 0) {
        /* ... */
    }
    wait4(&pid, /*...*/);
}
/* ... */ 
```

这只是您需要使用的调用的模型。您的代码将不得不处理从多个管道读取。

# jquery - jQuery 插件 jCarousel 自定义

> ID：11514902
> 
> 赞同：0
> 
> 时间：2012-07-17T01:33:19.163
> 
> 标签：jquery, css, jcarousel

有没有办法自定义 jCarousel 使初始对象居中？

而且我希望上一张和下一张幻灯片像这个例子一样显示一半。

[http://jsfiddle.net/nori2tae/BGwYM/](http://jsfiddle.net/nori2tae/BGwYM/) ＃我在上面的示例中使用了移动框jquery插件。

任何意见，建议将不胜感激。

感谢您的光临。

# c# - 使用 C# 将菜单项添加到 Adob e Acrobat

> ID：11514904
> 
> 赞同：0
> 
> 时间：2012-07-17T01:34:00.200
> 
> 标签：c#, plugins, acrobat

我需要创建一个 Adob​​e Acrobat 插件，将一个新菜单项添加到文件菜单，该菜单项将当前文件保存到文档管理系统（可能通过临时目录）。我一直在翻阅 Adob​​e 的文档，但我不确定如何使用 C# 来执行此操作，或者是否可能。

任何人都可以提供任何建议或指向我使用 C# 添加菜单项的工作示例吗？谢谢。

# ios - 使用 UIAlert 视图让用户输入标题

> ID：11514905
> 
> 赞同：0
> 
> 时间：2012-07-17T01:34:00.610
> 
> 标签：ios, ios5, uialertview, master-detail

我正在创建一个 Master-Detail Splitview 应用程序，并且我`UIAlertView`在`insertNewObject`方法中使用 a 让用户为添加到主视图的新对象定义一个标题。我已经使用了 Warkst 的这个问题[linky](https://stackoverflow.com/questions/6319417/whats-a-simple-way-to-get-a-text-input-popup-dialog-box-on-an-iphone)的代码和指南。

我的问题是，当调用警报视图时，insertNewObject 函数的其余部分会继续运行，因此会创建一个带有空白标题的新对象，因为它在 AlertView 甚至有机会出现之前就完成了运行。

我正在使用的代码如下，第一个方法是`insertNewObject`，第二个是按下按钮时 AlertView 调用的方法。`newTitle`是一个全局变量。

```
- (void)insertNewObject:(id)sender
{
    //Make sure clear before we start, also make sure initalized (double redundancy with clear statement at end)
    newTitle = @"";

    //New Title pop up UIAlert View
    UIAlertView * alert = [[UIAlertView alloc] 
                           initWithTitle:@"New Object" 
                           message:@"Please enter a name for object" 
                           delegate:self 
                           cancelButtonTitle:@"Create" 
                           otherButtonTitles:nil];

    alert.alertViewStyle = UIAlertViewStylePlainTextInput;

    UITextField * alertTextField = [alert textFieldAtIndex:0];

    alertTextField.keyboardType = UIKeyboardTypeDefault;

    alertTextField.placeholder = @"Enter a new title";
    [alert show];

    //Create and enter new object.
    if (!_objects) 
    {
        _objects = [[NSMutableArray alloc] init];
    }

    [_objects insertObject:newTitle atIndex:0];
    NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:0];
    [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];

    //Clear newTitle for use next time
    newTitle = @"";
} 
```

UIAlertView 按钮点击方法

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{ 
    newTitle = [[alertView textFieldAtIndex:0] text];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:13:56.337

您希望在该`UIAlertViewDelegate`方法中创建对象，`alertView:clickedButtonAtIndex:`因为（如您所见）显示警报的调用不会阻止该方法的其余部分执行。

此外，如果相关，您可能希望通过添加一个附加按钮让用户取消操作。

# javascript - 从弹出窗口调用闭包？

> ID：11514906
> 
> 赞同：1
> 
> 时间：2012-07-17T01:34:02.483
> 
> 标签：javascript, popup, closures, call

我有一个 aspx 页面，其中在 js 中有一个对 index.js 的引用闭包并将其分配给 page.js 中的变量，因此我可以使用闭包方法并更新_var1。

我在与父 index.aspx 页面相同的域中打开弹出窗口。我已经尝试在 page.js 中使用代码，例如： var _closure = window.opener.UI_Methods(); 但我收到以下错误：无法评估表达式。呼叫被被呼叫者拒绝。调试时在 VS 2010 的即时窗口中。

有没有办法可以在父页面中调用闭包并通过调用闭包方法来更新变量？

```
UI_Methods = function(){

 var _var1 = var1 || null;

 var _setVar1 = function(var1){
    _var1 = var1;
 };

 var _getVar1 = function(){
    return _var1;
 };

 return {
   SetVar1 : _serVar1

 }; 
```

};

# php - 如何在 joomla 中使用表单提交方法="get"

> ID：11514912
> 
> 赞同：0
> 
> 时间：2012-07-17T01:34:27.667
> 
> 标签：php, joomla

我有一个示例代码：

```
<?php
$id = JRequest::getVar('id');
$action = "index.php?option=com_test&id=".$id;
?>
<form action="<?php echo $action ?>" method="get">
<input type="text" name="id" value=""/>
<input type="submit" value="submit" name="submit" />
</form> 
```

当我提交表单时 url 是“ `index.php&id=...`” => 错误找不到组件

如何解决它是结果“ `index.php?option=com_test&id=...`”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:43:37.217

**JROUTE是什么？**

在您的`forum action`中，您应该使用[JRoute](http://docs.joomla.org/Supporting_SEF_URLs_in_your_component)（组件路由器）中的功能将框架中的 URL 正确路由到组件。`JRoute::_('index.php?option=com_test&id=".$id');`.

**为什么？**

[为避免通过Menu Manager](http://help.joomla.org/content/view/65/223/)创建菜单项时出现问题，您的代码将不兼容（即`no component can be found`会显示错误）。

**不相容？你到底是什么意思？**

这可能是因为有人可能创建了一个菜单项`index.php/myMenuItem/`，根据 joomla 标准，该菜单项使默认 url`?option=com_test`不兼容。

> **URL 中如何使用别名？**
> 
> 对于菜单项，Joomla！使用别名作为 URL 插件。假设您使用前两个 SEF URL 选项并创建了一个名为 Products 的菜单项。您的 URL 将是 example.com/products。
> 
> Joomla！还使用 URL 中数据的主键值来帮助路由器导航到正确的页面。继续前面的示例，如果您的产品菜单项用于文章/类别博客，则文章标题和/或阅读更多链接的链接将包含三个部分：
> 
> *   菜单项 URL - example.com/products；
> *   另外，Category 的主键和 Category 别名 - 32-fruit；
> *   另外，文章的主键和文章别名 - 1-apple；完整的网址是：[http ://example.com/products/32-fruit/1-apple](http://example.com/products/32-fruit/1-apple)

信用（[JRoute](http://docs.joomla.org/Search_Engine_Friendly_URLs)，2011）

**执行**

```
<?php
$id = JRequest::getVar('id');
$action = "index.php?option=com_test&id=".$id; ?>
<form action="<?php echo JRoute::_($action); ?>" method="get">
<input type="text" name="id" value=""/>
<input type="submit" value="submit" name="submit" />
</form> 
```

**其他例子..**

如果您想了解 JRoute 在其他组件中是如何实现的，那么可以在管理员组件的视图部分中查看`com_menus`。在目录`com_menus/views/items/tmpl/edit.php`中。

# c++ - C++ 中的单例多线程代码

> ID：11514913
> 
> 赞同：2
> 
> 时间：2012-07-17T01:34:31.900
> 
> 标签：c++, multithreading, concurrency, singleton

我对 C++ 中的单例和多线程编程有疑问以下您可以看到带有名为 shared 的变量的单例类的示例代码。

我创建了 1000 个线程来修改（+1）我的 Singleton 全局实例的该变量。shared 的最终值是 1000，但我希望这个值低于 1000，因为我没有保护这个变量的并发性。

代码真的是线程安全的，因为类是 Singleton 还是碰巧很幸运，值是 1000，但它完全可以小于 1000？

```
#include <iostream>
using namespace std;

class Singleton {
private:
    Singleton() {shared = 0;};
    static Singleton * _instance;
    int shared;

public:
    static Singleton* Instance();
    void increaseShared () { shared++; };
    int getSharedValue () { return shared; };
};

// Global static pointer used to ensure a single instance of the class.
Singleton* Singleton::_instance = NULL;

Singleton * Singleton::Instance() {
    if (!_instance) { 
        _instance = new Singleton;
    }

    return _instance;
}

void * myThreadCode (void * param) {
    Singleton * theInstance;
    theInstance = Singleton::Instance();
    theInstance->increaseShared();

    return NULL;
}

int main(int argc, const char * argv[]) {
    pthread_t threads[1000];
    Singleton * theInstance = Singleton::Instance();

    for (int i=0; i<1000; i++) {
        pthread_create(&threads[i], NULL, &myThreadCode, NULL);
    }

    cout << "The shared value is: " << theInstance->getSharedValue() << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T01:38:30.787

> 代码真的是线程安全的，因为类是 Singleton 还是碰巧很幸运，值是 1000，但它完全可以小于 1000？

你好幸运啊...

实际上，您所观察到的最可能的问题与以下事实有关：在特定机器上增加单例值所需的时间少于操作系统分配资源所需的时间启动单个 pthread。因此，您永远不会遇到两个线程争夺单例的未受保护资源的情况。

更好的测试是首先启动*所有*pthread，让它们阻塞在屏障或条件变量上，然后在满足所有线程“活动”的屏障条件时对单例执行增量......那时，您将更有可能看到诸如增量操作之类的非原子操作发生的各种数据竞争。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T02:06:02.197

如果你`Singleton`这样实现，单例创建将是线程安全的：

```
Singleton & Singleton::Instance() {
    static Singleton instance;
    return instance;
} 
```

由于实例永远不能为空，并且管理器没有内存，因此返回引用而不是指针。

增量操作可以通过使用平台特定的操作（g++ 提供内置的，例如`__sync_fetch_and_add`），或来自 STL 的 C++11 原子，或 Boost.Atomic，或使用互斥锁来实现原子化。

```
std::atomic<int> shared;

void increaseShared () { ++shared; }; 
```

# java - EclipseLink Profiler 显示正在创建的多个注册对象

> ID：11514918
> 
> 赞同：1
> 
> 时间：2012-07-17T01:35:55.227
> 
> 标签：java, performance, eclipselink, object-construction

在我的开发环境中，当我使用简单的获取所有 JQPL 查询运行 ReadAllQuery 时，我注意到在使用 EL 分析器后，有几个读取对象查询会被执行，每次都会增加我的总时间。例如，运行这样的查询会返回以下 Eclipse 配置文件输出。

```
@SuppressWarnings("unchecked")
public List<Person> getAllPeople(){
    EntityManager entityManager = factory.createEntityManager();
    List<Person> people = null;
    try {
        people = entityManager.createQuery("Select p from Person p where p.active = true").getResultList();
    } catch (Exception e) {
        // TODO: handle exception
    }
    finally{
        entityManager.close();
        if (entityManager.isOpen()) {
        }
    } 
```

返回多个`Register the existing object`语句并查看日志输出，每个语句都在一个工作单元中完成，为什么以及如何防止这些？

```
[EL Finest]: connection: 2012-07-16 20:21:26.558--ServerSession(1144634498)--Connection(1713234840)--Thread(Thread["http-bio-8080"-exec-14,5,main])--Connection released to connection pool [read].
Profile(ReadAllQuery,
    class=org.bixin.dugsi.domain.ApplicantSchool,
    number of objects=2,
    total time=3494000,
    local time=3494000,
    profiling time=84000,
    Timer:Logging=412000,
    Timer:ObjectBuilding=1670000,
    Timer:SqlPrepare=24000,
    Timer:ConnectionManagement=215000,
    Timer:StatementExecute=455000,
    Timer:Caching=68000,
    Timer:DescriptorEvents=9000,
    Timer:RowFetch=97000,
    time/object=1747000,
)
}End profile
Register the existing object Address[id=5,persons={[Applicant[major=Bachelors in Islamic Studies,nativeLanguage=<null>,ethnicity=<null>,hispanic=<null>,religiousAffiliation=<null>,schools={[ApplicantSchool[id=8,name=John Hopkisn,fromMonth=May,fromYear=2013,toMonth=March,toYear=2011,schoolType=Highschool,creditsCompleted=unavailable,gpa=unavailable,applicant=<null>,version=1,_persistence_applicant_vh={QueryBasedValueHolder: not instantiated},_persistence_fetchGroup=<null>], ApplicantSchool[id=7,name=,fromMonth=<null>,fromYear=<null>,toMonth=<null>,toYear=<null>,schoolType=College,creditsCompleted=,gpa=,applicant=<null>,version=1,_persistence_applicant_vh={QueryBasedValueHolder: not instantiated},_persistence_fetchGroup=<null>]]},FirstName=warsame,MiddleName=a,LastName=bashir,primaryTelephone=2342342333,secondaryTelephone=,emailAddress=warsme@d.com,birthDay=Sun Jul 22 00:00:00 CDT 2012,gender=Male,DateAdded=Fri Jul 13 18:16:33 CDT 2012,address=<null>,imagePath=<null>,active=true,marital=Single,school=<null>,nativeLanguage=Arabic,ethnicity=[Asian],hispanic=No,religiousAffiliation=Islam,id=651,version=1,_persistence_school_vh={null},_persistence_address_vh={Address[id=5,persons=org.eclipse.persistence.indirection.IndirectSet@47f322c8,streetAddress=243 city join,streetAddress2=<null>,city=saudi,state_us=South Carolina (SC),zipCode=24234,country=Antarctica,version=1,_persistence_fetchGroup=<null>]},_persistence_fetchGroup=<null>]]},streetAddress=243 city join,streetAddress2=<null>,city=saudi,state_us=South Carolina (SC),zipCode=24234,country=Antarctica,version=1,_persistence_fetchGroup=<null>]
Profile(
    total time=5000,
    local time=5000,
    Timer:DescriptorEvents=5000,
)
Profile(
    total time=196000,
    local time=196000,
    Timer:Register=196000,
)
[EL Finest]: transaction: 2012-07-16 20:21:26.564--UnitOfWork(26103836)--Thread(Thread["http-bio-8080"-exec-14,5,main])--Register the existing object Applicant[major=Bachelors in Islamic Studies,nativeLanguage=<null>,ethnicity=<null>,hispanic=<null>,religiousAffiliation=<null>,schools={[ApplicantSchool[id=8,name=John Hopkisn,fromMonth=May,fromYear=2013,toMonth=March,toYear=2011,schoolType=Highschool,creditsCompleted=unavailable,gpa=unavailable,applicant=<null>,version=1,_persistence_applicant_vh={QueryBasedValueHolder: not instantiated},_persistence_fetchGroup=<null>], ApplicantSchool[id=7,name=,fromMonth=<null>,fromYear=<null>,toMonth=<null>,toYear=<null>,schoolType=College,creditsCompleted=,gpa=,applicant=<null>,version=1,_persistence_applicant_vh={QueryBasedValueHolder: not instantiated},_persistence_fetchGroup=<null>]]},FirstName=warsame,MiddleName=a,LastName=bashir,primaryTelephone=2342342333,secondaryTelephone=,emailAddress=warsme@d.com,birthDay=Sun Jul 22 00:00:00 CDT 2012,gender=Male,DateAdded=Fri Jul 13 18:16:33 CDT 2012,address=<null>,imagePath=<null>,active=true,marital=Single,school=<null>,nativeLanguage=Arabic,ethnicity=[Asian],hispanic=No,religiousAffiliation=Islam,id=651,version=1,_persistence_school_vh={null},_persistence_address_vh={Address[id=5,persons={[Applicant[major=Bachelors in Islamic Studies,nativeLanguage=<null>,ethnicity=<null>,hispanic=<null>,religiousAffiliation=<null>,schools={[ApplicantSchool[id=8,name=John Hopkisn,fromMonth=May,fromYear=2013,toMonth=March,toYear=2011,schoolType=Highschool,creditsCompleted=unavailable,gpa=unavailable,applicant=<null>,version=1,_persistence_applicant_vh={QueryBasedValueHolder: not instantiated},_persistence_fetchGroup=<null>], ApplicantSchool[id=7,name=,fromMonth=<null>,fromYear=<null>,toMonth=<null>,toYear=<null>,schoolType=College,creditsCompleted=,gpa=,applicant=<null>,version=1,_persistence_applicant_vh={QueryBasedValueHolder: not instantiated},_persistence_fetchGroup=<null>]]},FirstName=warsame,MiddleName=a,LastName=bashir,primaryTelephone=2342342333,secondaryTelephone=,emailAddress=warsme@d.com,birthDay=Sun Jul 22 00:00:00 CDT 2012,gender=Male,DateAdded=Fri Jul 13 18:16:33 CDT 2012,address=<null>,imagePath=<null>,active=true,marital=Single,school=<null>,nativeLanguage=Arabic,ethnicity=[Asian],hispanic=No,religiousAffiliation=Islam,id=651,version=1,_persistence_school_vh={null},_persistence_address_vh=org.eclipse.persistence.internal.indirection.QueryBasedValueHolder@6b8099d3,_persistence_fetchGroup=<null>]]},streetAddress=243 city join,streetAddress2=<null>,city=saudi,state_us=South Carolina (SC),zipCode=24234,country=Antarctica,version=1,_persistence_fetchGroup=<null>]},_persistence_fetchGroup=<null>]
Profile(
    total time=1349000,
    local time=1349000,
    Timer:Logging=1349000,
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T22:14:37.590

由设置为的日志记录设置引起`FINEST`

# iis-7 - IIS 7 URL 重写强制重定向 http --> https

> ID：11514919
> 
> 赞同：2
> 
> 时间：2012-07-17T01:35:57.697
> 
> 标签：iis-7, https, url-rewriting

我在 IIS 7 中使用 SSL 通配符证书，并尝试强制执行以下重定向：

**通配符证书是：*.domain.com**

```
http://client1.domain.com ----> https://client1.domain.com 
```

我使用 IIS 7 URL 重写管理单元在 XML 配置中创建以下重写规则，如果我使用常规的非通配符证书，该规则可以正常工作。任何人都知道我是否缺少任何步骤？

```
<rewrite>   
  <rules>     
    <rule name="client1.domain.com" stopProcessing="true">      
      <match url=".*"/>       
      <conditions>         
        <add input="{HTTPS}" pattern="off"/>         
        <add input="{HTTP_HOST}" pattern="^client1\.domain\.com$"/>         
      </conditions>       
      <action type="Redirect" url="https://{HTTP_HOST}{URL}"/>       
    </rule>     
  </rules>   
</rewrite> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T21:32:46.277

问题是没有调用重写，所以我重新安装了 URL 重写 IIS 管理单元。

# git - 如何强制覆盖我推送和重新设置的 git 分支？

> ID：11514927
> 
> 赞同：1
> 
> 时间：2012-07-17T01:36:46.913
> 
> 标签：git, github, git-rebase

使用 Git，我正在开发一个功能分支。我将分支推送到 github，以便有人可以查看它。然后，已经有一段时间了，所以我重新设置了它。如何将我的重新定位分支推到旧分支上？我必须避免哪些陷阱？我认为这只是`git push --force`（或`--mirror`？），但我不确定。

一些相关链接：

*   [https://stackoverflow.com/a/255080/237091](https://stackoverflow.com/a/255080/237091)
*   [https://stackoverflow.com/a/930160/237091](https://stackoverflow.com/a/930160/237091)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T02:02:37.313

您想使用`git push --force`，但请记住您正在改写公共历史。

重写公共历史是一个非常糟糕的主意。其他任何可能拉回旧历史的人，`git pull --rebase`如果他们标记或从重写的历史中分支出来，他们将不得不这样做，甚至更糟糕的事情，所以你必须公布你的屈辱，让他们知道该怎么做。

服务器可能不允许这样做（但会在 github 上）。请参阅 receive.denyNonFastForwards (git-config)

# java - BufferedImage 与 VolatileImage 的当前状态

> ID：11514929
> 
> 赞同：4
> 
> 时间：2012-07-17T01:36:56.803
> 
> 标签：java, graphics, bufferedimage

在将快速图像绘制到窗口时，当前的最佳实践是什么？我说的是一些非常简单的东西，比如一个带有 2 缓冲区缓冲区策略的单个 JFrame。（当前）最快的方法是什么？

我到处读到 VolatileImage 是硬件加速的，而 BufferedImage 是管理的，除了可能不再是因为每次新更新（+ Java 7 的发布），随着 Java 加速越来越多的 BufferedImage，情况可能不再如此等等等等。

所以（一般来说）你对在这些条件下实现快速图像绘制有什么建议：

*   Java 6u33+ 或 Java 7+
*   一个图像覆盖整个 JFrame 或多个小图像
*   可能会或可能不会启用图像透明度，但必须足够容易地支持
*   如果它有助于考虑使用主动渲染的游戏循环设置

在有人问起之前，我已经尝试对这两者进行基准测试，但我发现我的硬件几乎没有差异。然而，我听说这也可能取决于硬件，所以我真的只是在寻找现代最佳实践。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-30T21:13:32.227

*从我移动的线程“BufferedImage vs VolatileImage - PERFORMANCE COMPARISON”（编辑和改进）：*

## 介绍

我最近[在 JavaGaming.org 上](http://www.java-gaming.org/topics/awesome-speeds-with-volatileimage/27391/view.html)发现了一篇关于 VolatileImage 的帖子，与 BufferedImage 相比，它的性能非常出色。我自己在我的一个项目中尝试过，它的优势似乎很明显！但是我很挑剔，我想以数字的形式看到结果，这就是我想出的：

* * *

## 基准测试

我决定创建一个小程序，给我一些基准测试结果来比较不同条件下的两种图像类型。

**程序：**基准方法很简单。将 2K (2560x1440) 测试图像缩小到 HD (1280x720)，然后绘制到 BufferedImage 或 VolatileImage 上（我使用 BufferedImage 存储测试图像，因为测试表明我使用什么图像类型来存储它没有区别） . 然后有两种变体： **第一个**当测试图像被绘制到 Buffered- 或 VolatileImage 时，Buffered- 或 VolatileImage 在同一循环运行中被绘制到帧的 JPanel。 **第二**在将测试图像绘制到 JPanel 之前，它们会在 Volatile- 或 BufferedImage 上绘制 n 次。该程序记录两个测试（第一个 BufferedImage，第二个 VolatileImage）的执行时间并在控制台中打印出来。我还测试了如果您使用带有 alpha 通道（透明度）的相同测试图片，结果会如何，因为我经常看到有人声称 VolatileImage 会出现问题。

**结果：**我在配备 Intel i5 Dual Core 2.5Ghz 的 Mac Minit（2012 年末）上运行该程序。使用的 Java 版本是 v8_112，通过 Eclipse 执行。这是我的结果：

```
Test-methodology 1 - no transparency:
  Num of Repeats:  BufferedImage:  VolatileImage:
   200              3.280 Seconds    0.784 Seconds
   500              8.230 Seconds    1.818 Seconds
   1000             16.030 Seconds   3.666 Seconds

Test-methodology 1 - transparancy:
  Num of Repeats:  BufferedImage:  VolatileImage:
   200              4.166 Seconds   0.806 Seconds
   500              10.636 Seconds  1.793 Seconds
   1000             20.565 Seconds  3.514 Seconds

Test-methodology 2 - no transparancy:
  Num of Repeats:  BufferedImage:  VolatileImage:
   200              1.165 Seconds   0.093 Seconds
   500              2.862 Seconds   0.104 Seconds
   1000             5.770 Seconds   0.112 Seconds

Test-methodology 2 - transparancy:
  Num of Repeats:  BufferedImage:  VolatileImage:
   200              2.389 Seconds   0.120 Seconds
   500              5.986 Seconds   0.128 Seconds
   1000             11.902 Seconds  0.134 Seconds 
```

* * *

## 结论

当然，性能很大程度上取决于图像的实现和使用方式。在我的情况下，作为缓冲区，我可以做一些事情，比如随着整个图像褪色。但是，您仍然可以发现两种图像类型的一些显着缺点和优点：

通常，在测试中，VolatileImage 似乎比 BufferedImage 快得多（4 到 6 倍）。当我对一个小游戏使用相同的实现时，在非综合测试中得到了类似的结果。但是在我的测试中，我提出了一种实现方式（遗憾的是，我无法重建它），它向我展示了 VolatileImage 并非总是要走的路（是的，在这种情况下它比它的竞争对手慢）。

从透明度来看，两种图像类型都均匀缩放，但 VolatileImage 尽管添加了一个 alpha 通道，但似乎并没有像 BufferedImage 那样失去那么多的速度。

我想提一下：在循环运行次数较少（1-10）的测试中，我发现 BufferedImage 在绘制单帧时要快得多。尤其是在渲染透明图像时。单帧 BufferedImage 大约需要 0.03 秒，而 VolatileImage 需要 0.035。当使用大约 3 到 6 次循环运行时，差距变得更大。只有在超过 8 到 10 时，VolatileImage 才占据了主导地位，并且随着循环运行数量的增加而变得更好......

*我想用您的意见扩展这个结论（由测试支持），并且还想知道您提出的这两个图像的哪些实现以及它们在那里的变化。*

就个人而言，我将来会使用 VolatileImage 进行渲染。BufferedImage 将成为我存储图像的日常驱动程序，然后在我的渲染循环中绘制这些图像。主要是因为我发现它们更容易处理（有一种方法可以将 BI 转换为 VI，但这是另一个故事）。我也期待 Java 9，它已于今年 12 月宣布，但似乎被推迟了，并将再次运行我的测试。

* * *

## 资源

[我在 GitHub 上](https://github.com/DesertCoockie/Benchmark)上传了我的源代码。你可以看看它，如果你愿意，拉它自己试试！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T05:42:31.760

> 是否有任何官方文档或基准可以帮助证明这一点？

不是我知道的。但是，您可以修改这个 Java 2D 基准来比较这两种方法： [http ://www.randelshofer.ch/oop/graphics/index.html](http://www.randelshofer.ch/oop/graphics/index.html)

（适用于 Java 基准测试的标准警告......）

# ios - 如何在文本字段上添加可选建议

> ID：11514930
> 
> 赞同：0
> 
> 时间：2012-07-17T01:37:06.243
> 
> 标签：ios, ipad, user-interface

我不确定我是否正确使用了这个短语。

我想要的功能是在用户输入一些字符（或单击按钮）后，文本字段下将显示一个列表。

一个简单的例子是谷歌搜索。在您输入“fb”或“faceb”后，它会在建议列表中显示“facebook”。

列表的内容存储在一个数组中，该数组来自于 web 服务的返回。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:20:40.947

你必须用 拦截击键`UITextView textViewDidChange`。然后，每次击键时，您都会实现查找算法并在发生数据输入的 UITextView 上方或下方显示您的选择列表。该列表必须以某种方式“可触摸”才能从中进行选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T02:41:02.893

[Ray Wenderlich 有一个教程，在他的博客](http://www.raywenderlich.com/336/how-to-auto-complete-with-custom-values)上展示了如何完成这项工作

他在可触摸的文本字段下方创建了一个表格。

那里还有一个示例项目。

# pthreads - pthreads和opencl

> ID：11514934
> 
> 赞同：0
> 
> 时间：2012-07-17T01:37:20.283
> 
> 标签：pthreads, opencl

我可以创建 pthread 吗？我可以在每个 pthread 中创建 opencl 环境并调用相同的内核。我想要做的是在同一设备上并行启动 opencl 内核。这可能吗？

谢谢回答。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T03:07:08.263

乍一看，这似乎是不必要的。

当您启动 OpenCL 内核时，使用 clEnqueueNDRange() API 调用，您可以启动任意数量的内核；每个都作为同一设备上的自己的线程。OpenCL 模型是一个上下文/命令队列可以在 GPU 上启动 100 到 1000 个轻量级内核线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T05:01:13.253

正如 Tim 所指出的，当 OpenCL 支持这么多线程/内核时，你为什么要使用 opencl 进入 pthreads。与 pthread 相比，GPU 上的其他线程的重量非常轻。Pthread 成本高昂，并且涉及大量上下文切换开销，这实际上可能会显着降低您的性能。

但是使用相同的命令队列启动许多内核将按顺序执行内核。每个内核应该有不同的命令队列。我相信单一上下文不应该是并行启动内核的问题......

# linux - 从多个进程附加到单个文件的“线程安全”？

> ID：11514935
> 
> 赞同：5
> 
> 时间：2012-07-17T01:37:26.167
> 
> 标签：linux, file, concurrency

假设我有 X 进程打开文件 Y 进行追加。每个进程当时只写一行（带有\n）（真正的日志条目）。

是否保证每行不会在文件 Y 中错误地交错？

更新：本地附加文件系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:00:15.600

问题取决于正在进行的写入类型。如果您使用带缓冲的标准 I/O（这通常是大多数程序的默认设置），则缓冲区只会在写入几行后才会被刷新，并且在刷新时不一定是整数行。如果您正在使用 write(2) 或已将默认 stdio 缓冲更改为 line 或 unbuffered，那么只要行的大小合理（当然，如果行小于 512 字节），它可能会正确交错。

# android - ADT r20 中的 Android 文档非常慢

> ID：11514945
> 
> 赞同：2
> 
> 时间：2012-07-17T01:39:40.833
> 
> 标签：android, avd

我将我的 ADT 更新为 r20。当我有互联网连接时，打开文档变得非常慢。但它在离线模式下运行良好。

直接点击打开docs目录下的xxx.html很慢。

为什么？以及如何解决？

* * *

我发现了问题。当html文件访问互联网下载一些资源文件时，url有问题。当我访问文档的 html 文件时，我会得到这些信息。

```
GET file://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumi‌​talic,bold 
GET file://www.google.com/jsapi/ 
```

这两个是从互联网上下载js文件，但由于url错误而无法获取。

如何防止两个url访问互联网？文档中有太多的html文件，不可能全部编辑。

帮助！

# perl - 捕获 Perl 的 'system()' 的输出

> ID：11514947
> 
> 赞同：31
> 
> 时间：2012-07-17T01:39:50.053
> 
> 标签：perl, shell

我需要在 Perl 中使用 system() 运行 shell 命令。例如，

```
system('ls') 
```

系统调用将打印到[STDOUT](https://perldoc.perl.org/perlglossary#standard-output)，但我想将输出捕获到一个变量中，以便将来可以使用我的 Perl 代码进行处理。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-17T01:48:00.880

这就是反引号的用途。来自[`perldoc perlfaq8`](http://perldoc.perl.org/perlfaq8.html#Why-can%27t-I-get-the-output-of-a-command-with-system%28%29%3f)：

> **为什么我不能用 得到命令的输出`system()`？**
> 
> 您混淆了[`system()`](http://perldoc.perl.org/functions/system.html)反引号 (``) 的目的。`system()` 运行命令并返回退出状态信息（作为 16 位值：低 7 位是进程死亡的信号，如果有的话，高 8 位是实际退出值）。反引号 (``) 运行命令并将它发送到 STDOUT 的内容返回。
> 
> ```
> my $exit_status   = system("mail-users");
> my $output_string = `ls`; 
> ```

有关[`perldoc perlop`](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)更多详细信息，请参阅。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-17T11:14:18.647

[`IPC::Run`](http://www.metacpan.org/module/IPC::Run)是我最喜欢这种任务的模块。非常强大和灵活，对于小型案例也非常简单。

```
use IPC::Run 'run';

run [ "command", "arguments", "here" ], ">", \my $stdout;

# Now $stdout contains output 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-31T14:11:52.523

只需使用类似于 Bash 示例：

```
 $variable=`some_command some args`; 
```

就这样。请注意，您不会在输出中看到任何到 STDOUT 的打印，因为它被重定向到一个变量。

此示例不适用于与用户交互的命令，除非您已准备好答案。为此，您可以使用一堆 shell 命令来使用类似这样的东西：

```
 $variable=`cat answers.txt|some_command some args`; 
```

在*answers.txt*文件中，您应该为 some_command 正常工作准备所有答案。

我知道这不是最好的编程方式 :) 但这是实现目标的最简单方式，特别是对于 Bash 程序员。

当然，如果输出更大（`ls`带有子目录），您不应该一次获得所有输出。以与读取常规文件相同的方式读取命令：

```
open CMD,'-|','your_command some args' or die $@;
my $line;
while (defined($line=<CMD>)) {
    print $line; # Or push @table,$line or do whatever what you want processing line by line
}
close CMD; 
```

无需额外 Bash 调用即可处理长命令输出的附加扩展解决方案：

```
my @CommandCall=qw(find / -type d); # Some example single command
my $commandSTDOUT; # File handler
my $pid=open($commandSTDOUT),'-|'); # There will be an implicit fork!
if ($pid) {
    #parent side
    my $singleLine;
    while(defined($singleline=<$commandSTDOUT>)) {
        chomp $line; # Typically we don't need EOL
        do_some_processing_with($line);
    };
    close $commandSTDOUT; # In this place $? will be set for capture
    $exitcode=$? >> 8;
    do_something_with_exit_code($exitcode);
} else {
    # Child side, there you really calls a command
    open STDERR, '>>&', 'STDOUT'; # Redirect stderr to stdout if needed. It works only for child - remember about fork
    exec(@CommandCall); # At this point the child code is overloaded by an external command with parameters
    die "Cannot call @CommandCall"; # Error procedure if the call will fail
} 
```

如果您使用这样的程序，您将捕获所有程序输出，并且您可以逐行进行所有处理。祝你好运 ：）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-24T12:22:14.247

我想运行 system() 而不是反引号，因为我想查看`rsync --progress`. 但是，我还想根据返回值捕获输出以防出现问题。（这是用于备份脚本）。这就是我现在使用的：

```
use File::Temp qw(tempfile);
use Term::ANSIColor qw(colored colorstrip);

sub mysystem {
    my $cmd = shift; #"rsync -avz --progress -h $fullfile $copyfile";
    my ($fh, $filename) = tempfile();
    # http://stackoverflow.com/a/6872163/2923406
    # I want to have rsync progress output on the terminal AND capture it in case of error.
    # Need to use pipefail because 'tee' would be the last cmd otherwise and hence $? would be wrong.
    my @cmd = ("bash", "-c", "set -o pipefail && $cmd 2>&1 | tee $filename");
    my $ret = system(@cmd);
    my $outerr = join('', <$fh>);
    if ($ret != 0) {
        logit(colored("ERROR: Could not execute command: $cmd", "red"));
        logit(colored("ERROR: stdout+stderr = $outerr", "red"));
        logit(colored("ERROR: \$? = $?, \$! = $!", "red"));
    }
    close $fh;
    unlink($filename);
    return $ret;
}

# and logit() is sth like:
sub logit {
    my $s = shift;
    my ($logsec,$logmin,$loghour,$logmday,$logmon,$logyear,$logwday,$logyday,$logisdst)=localtime(time);
    $logyear += 1900;
    my $logtimestamp = sprintf("%4d-%02d-%02d %02d:%02d:%02d",$logyear,$logmon+1,$logmday,$loghour,$logmin,$logsec);
    my $msg = "$logtimestamp $s\n";
    print $msg;
    open LOG, ">>$LOGFILE";
    print LOG colorstrip($msg);
    close LOG;
} 
```

编辑：使用`unlink`而不是`system("rm ...")`

# c# - Linq to SQL - 即使为 0 也能获取 count() 的查询

> ID：11514952
> 
> 赞同：0
> 
> 时间：2012-07-17T01:40:33.470
> 
> 标签：c#, .net, linq-to-sql

我有这个查询：

```
(from a in SickDays
    join b in Class.Where(p => p.ID == myId) on a.Class_ID equals b.ID
    join c in Student on a.Student_ID equals c.ID
    group a by new { c.Name, c.Order } into ac
    select new { Count = ac.Count(), Name = ac.Key.Name, Order = ac.Key.Order }
).OrderBy(f => f.Order) 
```

这将返回：

```
Count | Name | Order
    3 | Dave |     a
    2 | John |     b
    7 | Sally|     c 
```

但是我希望它返回这个：

```
Count | Name | Order
    3 | Dave |     a
    2 | John |     b
    7 | Sally|     c
    0 | Mark |     d
    0 | Betty|     e 
```

**更新：** 使用@sixlettervariables 示例，这就是学生、班级和病假日的样子：

```
var Students = new List<Student>()
{
    new Student { Id = 1, Name = "Al", Order = 'a' },
    new Student { Id = 2, Name = "Betty", Order = 'b' },
    new Student { Id = 3, Name = "Charles", Order = 'c' },
};

var Classes = new List<Class>()
{
    new Class { Id = 1, Title = "A100" },
    new Class { Id = 2, Title = "A200" },
};

var SickDays = new List<SickDay>()
{
    new SickDay { Id = 1, StudentId = 1, ClassId = 1 },
    new SickDay { Id = 2, StudentId = 1, ClassId = 1 },
    new SickDay { Id = 3, StudentId = 1, ClassId = 2 },
    new SickDay { Id = 4, StudentId = 1, ClassId = 2 },
    new SickDay { Id = 5, StudentId = 2, ClassId = 1 },
}; 
```

好的，以上内容现在是正确的，很抱歉造成混淆！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T01:59:10.273

这称为[左外连接](http://msdn.microsoft.com/en-us/library/bb397895.aspx)。在这种情况下，每个*学生*都需要，即使他们没有*Sick Days*。因此，我们将从学生开始，对病假执行左外连接，然后返回与您指定的 ID 匹配的课程数量：

```
var query =
    from s in Students
    join d in SickDays on s.ID equals d.Student_ID into gj
    from sd in gj.DefaultIfEmpty()
    group sd by new { s.Name, s.Order } into gg
    select
        new
        {
            Name = gg.Key.Name,
            Order = gg.Key.Order,
            Count = gg.Count(x => x != null && x.Class_ID == myId)
        }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:46:55.010

所以你想要所有的学生，即使他们不在课堂上？那么我相信你需要一个左连接。使用 Linq，这是使用 DefaultIfEmpty() 实现的

试试这个？

```
(from a in SickDays
    join b in Class.Where(p => p.ID == myId) on a.Class_ID equals b.ID
    join c in Student on a.Student_ID equals c.ID
        into s
    from students in s.DefaultIfEmpty()
    group a by new { students.Name, students.Order } into ac
    select new { Count = ac.Count(), Name = ac.Key.Name, Order = ac.Key.Order }
).OrderBy(f => f.Order) 
```

我希望这能让你朝着正确的方向前进。

# python - Facebook Python SDK - 在事件创建中上传图像

> ID：11514954
> 
> 赞同：0
> 
> 时间：2012-07-17T01:41:06.647
> 
> 标签：python, facebook, api, events

在图形 api 上创建事件时如何上传图像？例子：

```
user.facebook.put_object("me", "events", name="test", start_time=start_date, end_time=end_date, picture=image) 
```

我试过了：

```
 image = 'C:\\Path\\to\\image.jpg' #and
 image = open('C:\\Path\\to\\image.jpg', 'a') #and
 image = open('C:\\Path\\to\\image.jpg', 'a').read() #and 
```

没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:59:19.717

来自 github 上的文档：[https ://github.com/pythonforfacebook/facebook-sdk/](https://github.com/pythonforfacebook/facebook-sdk/)

```
graph = facebook.GraphAPI(oauth_access_token)
tags = json.dumps([{'x':50, 'y':50, tag_uid:12345}, {'x':10, 'y':60, tag_text:'a turtle'}])
graph.put_photo(open('img.jpg'), 'Look at this cool photo!', album_id_or_None, tags=tags) 
```

# core-data - 核心数据 - 删除项目

> ID：11514959
> 
> 赞同：1
> 
> 时间：2012-07-17T01:41:45.567
> 
> 标签：core-data, ios4, iphone-sdk-3.0

由于对我的一些代码有一些疑问，我有一个问题。在 NSManagedObject 数组中，我需要摆脱其中的一些。这是（下面）我使用的代码。我不得不说它在我的经验范围内有效。所以我的问题更多是要确保我没有做错什么，而不是解决现有问题

```
for (NSManagedObject *item in objects) {
    if ([[item valueForKey:@"OK"] intValue]>1) {
        [context deleteObject:item];
        continue;
    }
} 
```

由于我在循环时修改了数组“对象”的内容，我担心我的代码有点不安全。当然，这一切都取决于幕后如何处理，我不知道。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T09:05:04.273

当您调用时，`deleteObject:`您正在标记要删除的对象，而不是立即删除它，当然也不会从您在迭代期间迭代的集合中删除它。

从文档：

> 指定在提交更改时应从其持久存储中删除的对象。

如果您在`deleteObject:`调用后检查已删除的项目，您将看到这些对象仍然存在，但它们的`isDeleted`标志设置为`YES`. `NSManagedObjectContext`下次保存时，该对象实际上将被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T13:28:57.097

您只是用您的`deleteObject`行标记要删除的项目。为了强制上下文执行删除，请在函数底部运行：

```
NSError *error;
if (![context save:&error]) {
    return;
} 
```

# r - 如何动态索引多维 R 数组？

> ID：11514964
> 
> 赞同：4
> 
> 时间：2012-07-17T01:42:30.020
> 
> 标签：r, multidimensional-array

我正在处理 R 中的一些数据，这些数据由由三个空间维度和一个时间维度组成的四维数组组成：x、y、z、t。对于我的一些分析，我想获取一组空间坐标 x、y、z 的时间维度中的所有数据。到目前为止，我已经使用 which 函数来获取感兴趣的空间位置的索引。但是当我去获取与空间位置相对应的时间维度中的所有相关数据时，我找不到一个优雅的 R 解决方案，而不得不使用 repmat，一个移植的 MATLAB 函数。

```
a4d <- array(rnorm(10000), rep(10,4)) #x, y, z, t

#arbitrary set of 3d spatial indices x, y, z (here, using high values at first timepoint)
indices <- which(a4d[,,,1] > 2, arr.ind=TRUE)
str(indices)

# int [1:20, 1:3] 10 2 6 5 8 2 6 8 2 10 ...
# - attr(*, "dimnames")=List of 2
# ..$ : NULL
# ..$ : chr [1:3] "dim1" "dim2" "dim3"

#Now, I would like to use these indices to get data x, y, z for all t

#Intuitive, but invalid, syntax (also not clear what the structure of the data would be)
#a4d[indices,]

#Ugly, but working, syntax
library(pracma)

#number of timepoints
nt <- dim(a4d)[4]

#create a 4d lookup matrix
lookup <- cbind(repmat(indices, nt, 1), rep(1:nt, each=nrow(indices)))

#obtain values at each timepoint for indices x, y, z
result <- cbind(lookup, a4d[lookup]) 
```

该解决方案对于所述目的可以正常工作，但在概念上看起来很丑陋。理想情况下，我希望最后有一个二维矩阵：索引 x 时间。因此，在这种情况下，查找中有 20 个 x、y、z 坐标和 10 个时间点，一个 20 x 10 矩阵将是理想的，其中行表示每行索引（不需要保留 x、y、z , 值必须）并且每一列都是一个时间点。

在 R 中有没有好的方法来做到这一点？我玩过 do.call("[", list ... etc. 并使用 external 和 prod，但这些并没有像我希望的那样工作。

感谢您的任何建议！迈克尔

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T02:21:36.190

我认为您正在寻找：

```
apply(a4d, 4, `[`, indices) 
```

并检查我们的结果是否匹配：

```
result1 <- matrix(result[,5], ncol = 10)
result2 <- apply(a4d, 4, `[`, indices)
identical(result1, result2)
# [1] TRUE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T01:55:58.337

我可能错过了一些东西，但你不只是想要`a4d[indices[,1],indices[,2],indices[,3],]`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T13:26:55.383

按每个维度单独访问并不像@tilo-wiklund 或我所期望的那样工作。结果不是跨 10 个时间步长的 23 行，而是跨 10 个时间步长的 23x23x23 立方体。

```
r.idvdim <- a4d[indices[,1],indices[,2],indices[,3],]
r.apply  <- apply(a4d, 4, `[`, indices)
r.cbind  <- matrix(a4d[lookup],ncol=nt)

dim(r.idvdim)     # [1] 23 23 23 10
dim(r.apply)      # [1] 23 10
dim(r.cbind)      # [1] 23 10 
```

# ruby-on-rails - Rails，在开发中使用任何时候 gem

> ID：11514968
> 
> 赞同：44
> 
> 时间：2012-07-17T01:42:48.163
> 
> 标签：ruby-on-rails, whenever

抱歉，来自一个相对的 Rails 新手的快速问题。我正在尝试使用[Whenever](https://github.com/javan/whenever) gem 来安排一些 rake 任务。我一辈子都无法让它真正开始在我的开发机器上运行 cron 作业。

从其他stackoverflow线程来看，看来我应该添加这个：

```
set :environment, "development" 
```

到我的 schedule.rb 文件。但是然后呢？

然后如何在 cron 作业开始后停止它们？

在 OSX 中使用 Rails 3.2.3

更新：答案是运行`$ whenever -w`将 cron 作业写入 crontab 文件。然后系统立即开始自动运行该 crontab 文件。

不幸的是，我的日志文件无论何时都包含以下内容： `"rake aborted! Don't know how to build task <task name>"`

我认为这可能是由于已知的 crontab/rvm 问题，但欢迎提出任何建议。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-02-26T11:22:43.983

清除现有的 cron 作业。

```
crontab -r 
```

使用环境更新 cronjob。

```
whenever --update-crontab --set environment='development' 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-17T01:49:26.217

您可以使用该`whenever`命令及其各种选项来操作您的 crontab。

```
$ whenever --help
Usage: whenever [options]
    -i [identifier],                 Default: full path to schedule.rb file
        --update-crontab
    -w, --write-crontab [identifier] Default: full path to schedule.rb file
    -c, --clear-crontab [identifier]
    -s, --set [variables]            Example: --set 'environment=staging&path=/my/sweet/path'
    -f, --load-file [schedule file]  Default: config/schedule.rb
    -u, --user [user]                Default: current user
    -k, --cut [lines]                Cut lines from the top of the cronfile
    -v, --version 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-17T08:59:26.260

```
whenever -c cron-name  #removing cronjobs 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-12-02T12:43:27.633

在 config/schedule.rb 之上添加以下代码行对我有用。

```
 ENV['RAILS_ENV'] = "development" 
```

# facebook - 将 Facebook 页面分配给应用程序

> ID：11514969
> 
> 赞同：1
> 
> 时间：2012-07-17T01:42:54.873
> 
> 标签：facebook

嗨，我有一个 Facebook 应用程序和一个单独的社区页面。我刚刚注意到应用设置中的“创建页面”链接。有没有办法告诉facebook使用我已经拥有的应用程序页面？我不想失去我已经拥有的喜欢。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T08:39:41.703

使用此对话框：[https ://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&redirect_uri=YOUR_PAGE_TAB_URL](https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&redirect_uri=YOUR_PAGE_TAB_URL)

# python - PyPy 中的 Django（或其他 pip 包）

> ID：11514970
> 
> 赞同：3
> 
> 时间：2012-07-17T01:42:57.197
> 
> 标签：python, django, python-2.7, pypy

我正在尝试使用 pypy 让 django 工作。我在 python2.7 和 python3.2 没有安装所有设置和工作良好。然后我安装了 pypy 并尝试运行 django：

```
Traceback (most recent call last):
  File "app_main.py", line 51, in run_toplevel
  File "manage.py", line 8, in <module>
    from django.core.management import execute_from_command_line
ImportError: No module named django 
```

我注意到 pypy 创建了自己的 site-packages 文件夹，所以我删除了它并在我的 python2.7 安装中创建了指向 site-packages 文件夹的符号链接。这没有改变。我还注意到这不仅仅是一个 django 问题，任何 pip 安装的包都不起作用。

**python2.7路径：**

```
['', '/usr/lib/python27.zip', 
'/usr/lib/python2.7',
'/usr/lib/python2.7/plat-linux2',
'/usr/lib/python2.7/lib-tk', 
'/usr/lib/python2.7/lib-old', 
'/usr/lib/python2.7/lib-dynload',
'/usr/lib/python2.7/site-packages',
'/usr/lib/python2.7/site-packages/setuptools-0.6c11.egg-info'] 
```

**pypy路径**

```
['', '/opt/pypy/lib_pypy/__extensions__',
'/opt/pypy/lib_pypy',
'/opt/pypy/lib-python/2.7',
'/opt/pypy/lib-python/2.7/lib-tk',
'/opt/pypy/lib-python/2.7/plat-linux2'] 
```

有人对这个有经验么？在这种情况下是否允许使用符号链接？如果没有，还有其他东西可以代替吗？我还尝试在删除它之前将 django 文件夹复制到 site-packages 文件夹中，但也没有成功。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T03:54:37.607

您确实想为您的 Web 应用程序创建一个独立的环境。我建议使用[buildout](http://www.buildout.org/)或[virtualenv](http://www.virtualenv.org/)。管理系统站点包每次都会咬你。

祝你好运！

# php - 如何使用 cURL 从 Google 日历中删除事件

> ID：11514973
> 
> 赞同：0
> 
> 时间：2012-07-17T01:43:03.293
> 
> 标签：php

有谁知道如何使用 php cURL 从 Google 日历中删除事件？我需要一个关于如何获取 eventid 以及如何删除的示例。我做了一些研究，结果发现有一种方法可以用“CURLOPT_CUSTOMREQUEST”来做，但我找不到任何例子......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-06T09:43:06.033

```
 $calendarId ="XXXXXXXXXXXXXX@group.calendar.google.com";
    $eventId = 'XXXXXXXXXXXXXXXXXXXXX';

    $APIKEY = 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX';    

    $tokenURL = 'https://accounts.google.com/o/oauth2/token';
    $postData = array(
        'client_secret'=>'XXXXXXXXXXXXXXXXX',
        'grant_type'=>'refresh_token',
        'refresh_token'=>'1/XXXXXXXXXXXXXXXXXXXXXXXX',
        'client_id'=>'XXXXXXXXXXXXXXXXX.apps.googleusercontent.com'
    );
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $tokenURL);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    $tokenReturn = curl_exec($ch);
    $token = json_decode($tokenReturn);
    //var_dump($tokenReturn);
    $accessToken = $token->access_token;

    //$token = getAccessToken();
    //echo $token; exit;

    //var_dump($auth);
    $request = 'https://www.googleapis.com/calendar/v3/calendars/' . $calendarId . '/events/'.$eventId.'?sendNotifications=true&key=' . $APIKEY;

    $ch = curl_init($request);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "DELETE");
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(
    'Authorization: Bearer '. $accessToken)
    );
    $response = curl_exec($ch);
     $httpCode = curl_getinfo($response, CURLINFO_HTTP_CODE);

    $result = json_decode($response); 
```

# css - CSS 值未应用于表格行和标题

> ID：11514975
> 
> 赞同：0
> 
> 时间：2012-07-17T01:43:29.100
> 
> 标签：css

`enter code here`我确信创建 CSS 只是为了惹恼我。

我让他在 CSS 文件中关注：

```
.tabletop
{
    padding: 0px; 
    margin: 0px; 
    border: none; 
    float: left; 
    width: 100%;     
}

.tableth
{  
  height: 15px; 
  background: #eef3e2;     
} 
```

这在视图中：

```
<table id="editorRows" class="tabletop" cellspacing="0">
        <tr>                
            <th class="tableth">  
                <input id="ChkAll" type="checkbox" onclick="SetAllCheckBoxes(this)" />               
            </th> 
```

只有表格的格式被强制执行，而不是表格标题元素。有任何想法吗？

根据要求的整个CSS：

```
/* Edit Tables */
.tabletop
{
    padding: 0px; 
    margin: 0px; 
    border: none; 
    float: left; 
    width: 100%;     
}

.tableth
{  
  height: 15px; 
  background: #eef3e2;     
}

body
{
    margin: 0;
    padding: 0;
    border: 0;
    width: 100%;
    background: #fff;
    min-width: 600px;
    font: normal 12px/1.2em Verdana, Tahoma, Arial, Helvetica, Georgia, Sans-Serif;
}
a
{
    color: #369;
}
a:hover
{
    color: #fff;
    background: #369;
    text-decoration: none;
}
h1, h2, h3
{
    margin: .8em 0 .2em 0;
    padding: 5px, 2px, 5px, 2px;
}
h1
{
    font-size: 12.3em;
}
h2
{
    font-size: 1.2em;
    color: #369;
}
h3
{
    font-size: 1.1em;
}
h4
{
    font-size: 1em;
}
p
{
    margin: .4em 0 .8em 0;
    padding: 0;
}
img
{
    margin: 5px 0;
}

/*fdfcdc*/
table, th, td 
{
    border: none;     
}

/* Header styles */
#header
{
    clear: both;
    float: left;
    width: 100%;
    border-bottom: 1px solid #000;
    background-color: #cccccc;
}
#header p, #header h1, #header h2
{
    padding: .4em 15px;
    margin: 0;
    line-height: 1.2em;
}
#header h1
{
    font-size: 1.2em;
}
#header h2
{
    font-size: 1.1em;
}
#header h3
{
    font-size: 1em;
    color: #fe7;
}

#navbar ul
{
    clear: left;
    float: left;
    width: 100%;
    list-style: none;
    margin: 0;
    padding: 0;
}

#navbar ul li
{
    display: inline;
    list-style: none;
    margin: 0;
    padding: 0;
}

#navbar ul li a
{
    display: block;
    float: left;
    margin: 0 0 0 1px;
    padding: 3px 10px;
    text-align: center;
    background: #eee;
    color: #000;
    text-decoration: none;
    position: relative;
    line-height: 1.3em;
}

#navbar ul li a:hover
{
    background: #369;
    color: #fff;
}
#navbar ul li a.active, navbar ul li a.active:hover
{
    color: #fff;
    background: #000;
    font-weight: bold;
}
#navbar ul li a span
{
    display: inline-block;
    margin: 0;
    padding: 10px 0;
}

#leftnavbar ul
{
    clear: left;
    float: left;
    width: 100%;
    list-style: none;
    margin: 0;
    padding: 0;
}

#leftnavbar ul li
{
    display: inline;
    list-style: none;
    margin: 0;
    padding: 0;
}

#leftnavbar ul li a
{
    display: block;
    float: left;
    margin: 0 0 0 1px;
    padding: 3px 10px;
    text-align: center;
    /*background: #eee;*/
    color: #000;
    text-decoration: none;
    position: relative;
    line-height: 1.3em;
}

#leftnavbar ul li a:hover
{
    background: #369;
    color: #fff;
}
#leftnavbar ul li a.active, #leftnavbar ul li a.active:hover
{
    color: #fff;
    background: #000;
    font-weight: bold;
}
#leftnavbar ul li a span
{
    display: inline-block;
    margin: 0;
    padding: 10px 0;
}

#header img
{
    padding-left: 10px;
}
/* The Real Status info sub menu */
#statusinfo
{
    clear: both;
    background: #eef3e2;    
    border-top: 3px solid #666;
    margin: 0;
    padding: 6px 15px !important;
    text-align: right;
}

#logindisplay
{
    clear: both;
    background: #eef3e2;    
    border-top: 3px solid #666;
    margin: 0;
    padding: 6px 15px !important;
    text-align: right;
}

.title
{
    position: fixed;
    left: 4px;
    top: -1px;
    float: left;
}

.title h2
{
}

/* keep label and input on same line
.editor-label-same-line { 
    float:  ; 
} 

.editor-field-same-line { 

} 

.editor-field-input-same-line { 

} */

/*border: 1px solid #C0C0C0;  */

/* Top Menu */
.topmenu
{
    float: right;
    position: relative;
}

/* Left Menu */
.leftmenu
{
    float: left;
    vertical-align: top;
}
/* column container */
.colmask
{
    position: relative; 
    clear: both;
    float: left;
    width: 100%; 
    overflow: hidden; /* This chops off any overhanging divs */
}
/* common column settings */
.colright, .colmid, .colleft
{
    /*float: left;*/
    /*width: 100%;*/
    position: relative;
    overflow: hidden;
}

.col, .col2, .col3
{
    position: relative;
    padding: 0 3em 1em 0;
    overflow: hidden;
}

.leftcol
{
    float: left;        
    height: 95%;
    width: 20%;
    left:  2px;     
    color: Black;
    padding: 2pc, 2pc, 2pc, 2pc;
    background: #ffffff; 
}

.rightcol
{
    float: left;
    height: 95%;
    width: 76%;  /*71*/
    left: 15px; 
    color: Black;
    padding: 2pc, 3pc, 2pc, 5pc;
    background: #ffffff;    
}

.leftmenu h2
{
    line-height:1.2em;
    font-size: 1.1em;
}
.leftmenu h3
{
    line-height:1.1em;
    font-size: 1em;
    color: #667;
}
.col2 ul
{
    margin: 5px 0;
    list-style: inside;
    list-style-type: square;
}
.col2 ul li
{
    margin-left: 15px;
    padding: 0;
}
/* Form layout elements */
fieldset 
{
    margin: 1em 0;
    padding: 1em;
    border: 1px solid #CCC;
}

fieldset p 
{
    margin: 2px 12px 10px 10px;
}

fieldset label 
{
    display: block;
}

fieldset label.inline 
{
    display: inline;
}

legend 
{
    font-size: 1.1em;
    font-weight: 600;
    padding: 2px 4px 8px 4px;
}

input[type="text"] 
{
    width: 200px;
    border: 1px solid #CCC;
}

input[type="password"] 
{
    width: 200px;
    border: 1px solid #CCC;
}
/* Footer styles */
#footer
{
    clear: both;
    float: left;
    width: 100%;
    border-top: 1px solid #000;
    border-bottom: 1px solid #000;
    background-color: #fdfcdc;
}
#footer p
{
    padding: 5px;
    margin: 0;
    position: relative;    
} 
```

在 _Layout.cshtml 中编辑调用 Site.css

```
<title>@ViewBag.Title</title>
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:02:24.653

我想这可能有点帮助！正如您在以下示例中看到的那样，您使用的高度太小而无法看到差异，这是因为复选框的高度`13px`几乎与您用于整个`row`( `15px`)的高度相同

![图片](../Images/505e02ff55d82bc3b8bc4c2cdf65748a.png)

所以，**css**被应用了，你只需要设置高度，`higher`就像在这个[示例中一样](http://jsfiddle.net/luissanchezm86/QJmgd/)

**更新**

这是更新[http://jsfiddle.net/luissanchezm86/QJmgd/1/](http://jsfiddle.net/luissanchezm86/QJmgd/1/)，但我仍然没有看到错误！

希望这对您有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:34:46.887

我感谢您的帮助和建议。我找到了两件事来解决这个问题。请记住，我正在从 IDE 以调试模式运行 MVC 应用程序……我在最初的问题中忽略了这一点。

尽管我在启动 MVC3 应用程序之前更改（并保存）了 Site.css 文件，但在某些情况下，直到我刷新浏览器 (F5) 后更改才明显。在其他情况下，刷新似乎不起作用。所以在这些情况下，我使用任务管理器杀死任何潜在的开发服务器实例并重新启动程序。

# intellij-idea - 如何在当前窗口中打开 IDEA 11 新窗口

> ID：11514979
> 
> 赞同：0
> 
> 时间：2012-07-17T01:44:18.300
> 
> 标签：intellij-idea

我正在使用 macbook pro。

idea 10 可以打开多个窗口，但 11 不能，你可以吗？

设置是否包含conf？

切换窗口是command+~键，或者F10。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T01:58:26.133

启用确认窗口以在选项**中打开项目：**

![确认](../Images/233cbf41dd395b6facfc69e0dc2c5324.png)

# android - Android makefile 生成静态可执行文件

> ID：11514980
> 
> 赞同：4
> 
> 时间：2012-07-17T01:44:27.497
> 
> 标签：android, makefile

我正在尝试在 /sbin 中生成类似于 adbd 的可执行文件。

我希望拥有的可执行文件是 ARM 格式的 iwlist，类型是静态的。

我在AndroidSourceCode/external中添加文件夹并执行“mm”命令编译

```
LOCAL_PATH := $(call my-dir)
ifneq ($(TARGET_SIMULATOR),true)
include $(CLEAR_VARS)

LOCAL_MODULE := libiw

LOCAL_MODULE_TAGS := eng

LOCAL_SRC_FILES := iwlib.c

LOCAL_C_INCLUDE += LOCAL_PATH

LOCAL_PRELINK_MODULE := false

include $(BUILD_SHARED_LIBRARY)

#================================================
include $(CLEAR_VARS)
LOCAL_FORCE_STATIC_EXECUTABLE := true
LOCAL_MODULE_TAGS := eng
LOCAL_SRC_FILES := iwlist.c

LOCAL_SHARED_LIBRARIES := libiw
LOCAL_MODULE := iwlist

include $(BUILD_EXECUTABLE)
#================================================

endif # !TARGET_SIMULATOR 
```

上面的 make 文件实际上是通过生成 iwlist 可执行文件来工作的

```
 iwlist: ELF 32-bit LSB executable, ARM, version 1 (SYSV), dynamically linked (uses
 shared libs), stripped 
```

但是，我正在寻找“静态链接”并且我在想“LOCAL_FORCE_STATIC_EXECUTABLE := true”这行应该可以帮助我静态地制作这个可执行文件。

不幸的是，它没有。

如果你知道怎么做，请指导我。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:56:37.820

我有类似的问题，但我无法使用 Android 工具链编译静态链接的任何文件。您可以为此使用另一个工具链。我已经尝试过使用 linaro 的工具链，它工作正常。你可以在这里下载： [https ://wiki.linaro.org/WorkingGroups/ToolChain](https://wiki.linaro.org/WorkingGroups/ToolChain)

我下载的是4.7版本，解压文件放在我的主目录下。编译很简单：

```
~/gcc-linaro-arm-linux-gnueabihf-2012.06-20120625_linux/bin/arm-linux-gnueabihf-gcc  -static -s hello.c -o hello 
```

当然，我建议您将该 bin 目录放在您的路径中。

这将创建一个静态链接文件：

```
# file hello
hello: ELF 32-bit LSB executable, ARM, version 1 (SYSV), statically linked, for GNU/Linux 2.6.31, stripped 
```

# php - INNER JOIN 总是返回 1 行（即使它是空的）？

> ID：11514981
> 
> 赞同：0
> 
> 时间：2012-07-17T01:44:42.273
> 
> 标签：php, mysql, inner-join

我有一个方法可以从我正在创建的锦标赛系统中返回数据。我有一个问题，即 INNER JOIN 查询总是返回一行，无论 WHERE 子句是否为真。

在数据库中有两个锦标赛，都有一个 T.game = '1' - 但是如果我检查 T.game = '2' 的查询，它仍然会根据返回一行`mysql_num_rows()`，当我`print_r()`得到结果数组时，它除了 COUNT() 行之外是空的，但是 WHERE 子句不应该找不到任何行并将其相应地描述为`mysql_num_rows()`?

我想我的主要问题是如何阻止 COUNT(P.id) 始终显示，即使比赛表中没有匹配的行

```
public function fetchTournaments($gameID){
        if($gameID == "" || $this->hasChar($gameID) || $this->hasSymb($gameID)){
            $this->_errorMsg = "Invalid Game ID.";
            return false;
        }else{
            $query = mysql_query("SELECT
                                    T.id,
                                    T.name,
                                    T.description,
                                    T.checkin,
                                    DATE_FORMAT(T.date,'%b %d, %Y @ %h:%i %p') AS date,
                                    COUNT(P.id) AS playernum
                                  FROM tournaments T
                                  INNER JOIN players P
                                  ON T.id = P.tourney_id
                                  WHERE T.game='{$gameID}'") or die(mysql_error());
            $result = mysql_num_rows($query);
            if($result > 0){
                echo $result;
                $output = mysql_fetch_array($query);
                return $output;
            }else{
                $this->_errorMsg = "There are no tournaments for this game.";
                return false;
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T02:06:17.760

在 MySQL 中，`COUNT`（与其他聚合函数一样）将始终返回结果。您可以通过使用来解决这个问题`GROUP BY`，这将返回每行的聚合结果。您可能想使用您在 中列出的列`GROUP BY`，但可能类似于：

```
$query = mysql_query("SELECT
                    T.id,
                    T.name,
                    T.description,
                    T.checkin,
                    DATE_FORMAT(T.date,'%b %d, %Y @ %h:%i %p') AS date,
                    COUNT(P.id) AS playernum
                  FROM tournaments T
                  INNER JOIN players P
                  ON T.id = P.tourney_id
                  WHERE T.game='{$gameID}'
                  GROUP BY T.id,T.name,T.description,T.checkin,date") or die(mysql_error()); 
```

# android - 用户操作正在等待“Building Workspace”

> ID：11514987
> 
> 赞同：40
> 
> 时间：2012-07-17T01:45:35.000
> 
> 标签：android, eclipse

如标题所述，我在 Eclipse 中开发了一个简单的 NFC 应用程序，并尝试在移动设备中运行它来调试我的代码。但是，当我尝试运行它时，出现了此消息，问题甚至无法启动。它说还剩下一个手术，但它似乎已经停止了。以前有没有人遇到过类似的问题，或者有人知道这里发生了什么？

![运行程序时出现屏幕](../Images/97f13ee43fac268897a896c359d21b65.png)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-24T11:09:59.630

我有完全相同的问题。对我来说，帮助在 eclipse.ini 文件的第一行添加“-clean”选项并重新启动 IDE。添加此选项后，eclipse 每次启动时都会清理工作区中的所有缓存数据（这也意味着它会启动得更慢）。

您可以在此处找到有关它的更多信息：[如何修复 eclipse 中挂起的“用户操作正在等待“构建工作区””](http://www.eclipsezone.com/eclipse/forums/t61566.html)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-09-13T18:41:38.480

对我来说，清洁选项不起作用，我不想重置工作区。对我来说幸运的是，另一个解决方案有效：

1.  禁用自动构建（取消选中菜单项 Projects -> Build Automatically）
2.  重新启动IDE（我不得不从命令行杀死它）
3.  关闭所有项目
4.  重新启动 IDE（这次应该可以正常关闭）
5.  打开您需要处理的项目（现在一切都应该没问题）

哦，是的，我一直在 eclipse.ini 中使用 clean 选项。不确定这是否有必要，但无论如何最好先尝试该选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-14T20:34:17.613

我不得不从 Eclipse 中禁用自动构建选项并重新启动它。这使它对我有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-05-23T08:40:57.953

这种方法对我有用：

1.  转到菜单“项目”-> 取消选中“自动构建”。
2.  强制关闭 Eclipse 然后重新打开它。
3.  删除类文件。
4.  编辑导致错误的源代码，保存并重建项目（'Project' -> 'Build All'）。

希望这会有所帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-27T08:01:26.390

我有同样的问题：等待项目/清洁。我已经尝试按照这个建议，eclipse.ini中的“-clean”命令，修改工作环境，重新安装eclipse......毕竟，问题仍然存在。

最后，我问了我的朋友，然后解决方法很简单：“它可能在你的aapt文件中崩溃，换一个好的”

现在一切正常。希望能帮助到你。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-29T16:29:12.220

这也可能表明 Eclipse 中的 JDK 设置错误。就我而言，我指向的是工作计算机上的特定目录。IT 人员升级了 JDK 并将其放在不同的目录中，因此旧路径不再有效。Eclipse 确实在并行目录中找到了一个 JRE，并试图使用它。

我修复了 JDK 设置并且它起作用了。

起初我没有注意到，因为我打开了“自动构建”。一旦我关闭它然后尝试运行 Maven 构建，然后我看到一条错误消息，说找不到 javac。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-07T09:28:54.020

我通过删除`<workspace_folder>/.metadata/.lock`文件解决了这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-06T14:19:42.957

这可能是由于安装了另一个软件，其端口设置为与 adb 服务器使用的端口等效

[尝试启动或停止服务器时 adb 挂起](https://stackoverflow.com/questions/17116121/adb-hangs-when-trying-to-start-or-stop-server/17118322#17118322)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-09-08T10:40:16.167

我有同样的问题，我应用了研究员的建议，但没有奏效。我发现 target-->classes 目录下有一些文件夹，我自己和 IDE 都无法清理/删除。
我重新启动机器，然后启动 IDE，一切正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-15T09:52:03.417

转到**项目**菜单**取消选中**自动**构建**并重新**启动****Eclipse** /STS IDE。

[![在此处输入图像描述](../Images/0db6143cad96961f4c36f7bfa52e30c9.png)](https://i.stack.imgur.com/uV2QH.jpg)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-07T05:01:03.057

对我来说，问题是由于 Maven 项目的构建路径不正确。尝试配置构建路径并仅包含我所学到的实际需要的内容。我的父 maven 项目有 10 多个子模块。我的 Eclipse 需要 3-4 分钟等待每个文件保存的后台进程。我从构建路径中删除了 [父模块]/src 并重新启动了 eclipse 并修复了问题。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-01-26T15:23:08.810

我遇到了这个问题，原因是有一个项目没有正确构建。因此，如果您在现有工作区中遇到此问题，请查看最近的更改或最近导入的项目。

# android - Android 的 ListView 和 SearchActivity

> ID：11514988
> 
> 赞同：1
> 
> 时间：2012-07-17T01:45:51.223
> 
> 标签：android, listview, search, widget

我正在尝试找出适用于 Android 的搜索界面。我的第一个问题与实现列表视图有关。我正在操作栏上使用搜索小部件。这是打开代码：

```
public class SearchableActivity extends ListActivity {

  // class fields

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.search);

    ListView lv = (ListView) findViewById(android.R.id.list);
    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {

        }
    });

    // Get the intent, verify the action and get the query
    Intent intent = getIntent();
    if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
        query = intent.getStringExtra(SearchManager.QUERY);

        ProgressDialog dialog = ProgressDialog.show(
                SearchableActivity.this, "Searching",
                "Searching. Please wait...", true);

        performSearch(query);

        dialog.hide();
        dialog.dismiss();
    }
}

public void performSearch(String query) {
    List<String> dataList = new ArrayList<String>();

    dataList = new ArrayList<String>();
    new task().execute(); // Task calls an HttpPost and opens search through php and populates list through JSON

    ArrayAdapter<String> arr = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, dataList);
    this.setListAdapter(arr);

} 
```

1.  在第一种方法中，我正在设置一个 ListView，我不确定我需要执行哪些代码 onClick？搜索结果去哪儿了？我想在用户输入时显示最接近的结果。
2.  不确定将 xml R.id.list 放在哪里？它作为下拉菜单内置在小部件中吗？（例如 Play 商店中的搜索小部件）
3.  另外，我在此使用任务并将查询发送到 php 的实现是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T03:13:02.190

```
In first method I am setting up a ListView, I am not sure what code I need to do onClick?
Where does the search results go? I'd like to display closest results as the user types. 
```

如果你想对`list item`一行执行一个操作..就像你有一个列表`Product`并且`OnClick`你想显示`details of your product`然后你启动你的新活动，它显示了相关产品的详细信息。

```
Not sure where to put the xml R.id.list? Is it built in to the widget as a drop down? (e.g. the search widget in Play Store) 
```

无需添加它在你`search.xml`喜欢的..

```
 <ListView
  android:id="@android:id/list"
  android:layout_width="match_parent"
  android:layout_height="wrap_content" >
</ListView> 
```

有关更多信息，请阅读[此](http://www.vogella.com/articles/AndroidListView/article.html)。

```
Also, is my implementation of using a Task correct in this and sending the query to php? 
```

不，使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)。

# javascript - 用 jQuery 进行 ltrim 吗？

> ID：11514994
> 
> 赞同：2
> 
> 时间：2012-07-17T01:46:42.873
> 
> 标签：javascript, jquery

我正在使用 jQuery 来捕获编码的 URL。

我看起来像：#?var=asdasdasdasdasd

我需要去掉“#？” 在字符串的开头。在 PHP 中，我会使用 ltrim。如何使用 jQuery 或纯 JS 做到这一点？

```
 $("#myLink").click(function(){
       var myUrl = $(this).attr("href");
       var cleanUrl = ....

 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T01:48:40.810

您可以使用替换方法。

```
var cleanUrl = myUrl.replace(/^#\?/, ''); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T01:49:29.803

你可以只使用`substr(2)`. 它更有效率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T01:50:00.383

这里有三种方法可以解决您的问题。

```
$("#myLink").click(function(){
   var myUrl = $(this).attr("href");
   var cleanUrl = ...??? // what goes here.
} 
```

方法一：使用String.prototype.replace。

```
var cleanUrl = myUrl.replace( /^#\?/, "" ); 
```

方法二：使用 String.prototype.split

```
var cleanUrl = myUrl.split( "#?" ).pop(); 
```

方法三：使用 String.prototype.match

```
var cleanUrl = (myUrl.match( /^#\?(.)*/ )||[myUrl]).pop(); 
```

额外方法：

```
var i = myUrl.indexOf( "#?" );
i = ( i < 0) ? 0 : i + 2;
var cleanUrl = myUrl.substring( i ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-30T09:18:43.763

var trim = values.trim();

这将删除所有空格。

# objective-c - UITableViewRowAnimation 自定义动画

> ID：11514997
> 
> 赞同：3
> 
> 时间：2012-07-17T01:47:04.000
> 
> 标签：objective-c, ios, cocoa-touch, uitableview

我知道有默认`UITableViewRowAnimation`选项，但有没有办法创建自己的动画？如果是这样，他们的教程是关于这个的吗？

我希望我的单元格向用户缩放，然后飞出屏幕。

我似乎找不到太多关于这个的...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-15T22:03:29.337

一种方法是在 willDisplayCell 中，您可以访问那里的 UIView/CAAnimation API。例子：

```
- (void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{   
    //1\. Define the initial state (Before the animation)
    cell.layer.shadowColor = [[UIColor blackColor]CGColor];
    cell.layer.shadowOffset = CGSizeMake(10, 10);
    cell.alpha = 0;
    cell.transform = CGAffineTransformMakeScale(0.85, 0.85);

    //2\. Define the final state (After the animation) and commit the animation
    [UIView beginAnimations:@"scale" context:NULL];
    [UIView setAnimationDuration:0.5];
    cell.transform = CGAffineTransformIdentity;
    cell.alpha = 1;
    cell.layer.shadowOffset = CGSizeMake(0, 0);
    [UIView commitAnimations];
} 
```

这是应用于单元格的简单“缩放”、阴影和 alpha-in。随着表格的滚动，单元格会缩小并变得不透明。你真的可以在这里做任何你想做的事。