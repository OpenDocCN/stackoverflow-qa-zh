# StackOverflow 问答 000323000-000323999

# java - 如何以编程方式将 portlet 添加到 JBoss Portal 仪表板

> ID：323003
> 
> 赞同：-1
> 
> 时间：2008-11-27T05:36:14.820
> 
> 标签：java, api, jboss, jboss-portal

如何以编程方式将 portlet 添加到特定用户的[JBoss Portal仪表板？](http://www.jboss.com/products/platforms/portals)JBoss Portal 是否有任何远程 API 来执行此操作？SOAP Web 服务，可能是基于 MBean 的 API？当然，作为最后的手段，我可​​以自己实现这样的服务并将其部署到 JBoss 门户，但理想情况下它不应该需要部署任何东西到 JBoss。

我需要从未部署在 JBoss 上的应用程序执行此操作。它在单独的 Tomcat 实例上运行。应用程序知道门户地址，它知道用户名和凭据，我可以在应用程序和门户之间建立我需要的任何信任关系。

更详细的描述：我有一个[Google Gadget](http://code.google.com/apis/gadgets/)，我想在我的应用程序中创建一个按钮，该按钮将把这个小工具作为一个 portlet 添加到我的门户中。因此，用户打开我的应用程序，按下“添加到仪表板”按钮，Google 小工具被添加到门户仪表板。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-06T14:12:55.673

希望这种和平的代码有助于：

```
 //container
    container = (CustomizationManager)MBeanProxy.get(CustomizationManager.class, new ObjectName("portal:service=CustomizationManager"), MBeanServerLocator.locateJBoss());

    //transaction manager
    tm = (TransactionManager) new InitialContext().lookup("java:/TransactionManager");      

    tm.begin();

    //dashboard
    dashboard = container.getDashboard(new org.jboss.portal.identity.User() {

        public boolean validatePassword(String arg0) {
            return false;
        }

        public void updatePassword(String arg0) throws IdentityException {
        }

        public String getUserName() {
            return userId;
        }

        public Object getId() {
            return null;
        }
    });     
    System.out.println("!!! Portlal: " + dashboard.toString());

    //default page
    defaultPage = dashboard.getPage("default");
    System.out.println("!!! Page: " + defaultPage.toString());

    //gets page windows
    Collection<PortalObject> objects = defaultPage.getChildren();
    if (objects != null && objects.size() > 0) {
        for (PortalObject object : objects) {
            System.out.println("!!! PageChild: " + object.getName());
            System.out.println("!!! WindowRegion: " + object.getDeclaredProperty("theme.region"));

            String windowPortletName = object.getDeclaredProperty("portletName");

            if (StringUtils.equals(object.getDeclaredProperty("theme.region"), "column1"))
            {
                column1Windows.add(object.getName());

                System.out.println("!!! Column1Window: " + object.getName());
                System.out.println("!!! Column1WindowPortletName: " + object.getDeclaredProperty("portletName"));

                //removes from portlets list if already exists
                Iterator iterator = portlets.iterator();
                while (iterator.hasNext())
                {
                    Portlet tempPortlet = (Portlet) iterator.next();
                    if (StringUtils.equals(tempPortlet.getSystemName(), windowPortletName))
                    {
                        iterator.remove();
                    }                       
                }
            }
            else if (StringUtils.equals(object.getDeclaredProperty("theme.region"), "column2"))
            {
                column2Windows.add(object.getName());
                System.out.println("!!! Column2Window: " + object.getName());

                //removes from portlets list if already exists
                Iterator iterator = portlets.iterator();
                while (iterator.hasNext())
                {
                    Portlet tempPortlet = (Portlet) iterator.next();
                    if (StringUtils.equals(tempPortlet.getSystemName(), windowPortletName))
                    {
                        iterator.remove();
                    }                       
                }

            }
        }
    }

    tm.commit(); 
```

# ruby - 在 ruby 中，为什么我的 IRB 交互式调试会话总是说“没有可用的源文件”

> ID：323010
> 
> 赞同：1
> 
> 时间：2008-11-27T05:39:55.793
> 
> 标签：ruby

只是想让我的 irb 会话真正列出当前的代码行，以及它周围的代码。类似于 Perl 的 -d 调试模式让你做 ddo。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T06:27:36.307

这是因为，当您以交互方式执行此操作时，您的“源文件”是标准输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-29T21:35:10.127

如果您正在寻找 Ruby 调试器，您可以尝试[ruby​​-debug](http://bashdb.sourceforge.net/ruby-debug.html)。它允许您设置断点，然后单步执行代码，同时显示当前指令的上下文。

# asp.net - Facebook 连接和 ASP.NET

> ID：323019
> 
> 赞同：45
> 
> 时间：2008-11-27T05:44:03.023
> 
> 标签：asp.net, facebook, facebooktoolkit

我在此处找到的身份验证概述的第 8 步：[http ://wiki.developers.facebook.com/index.php/How_Connect_Authentication_Works](http://wiki.developers.facebook.com/index.php/How_Connect_Authentication_Works)

特别是，用户已经通过 Facebook Connect 登录到 facebook，并且他们的网络会话已经创建。如何使用 facebook 开发者工具包 v2.0（从清晰起见）来检索有关用户的信息。例如，我想获取用户的名字和姓氏。

文档中的示例面向 facebook 应用程序，但事实并非如此。

## 更新

Facebook 最近发布了 Graph API。除非您正在维护使用 Facebook Connect 的应用程序，否则您应该查看最新的 API：http: [//developers.facebook.com/docs/](http://developers.facebook.com/docs/)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-15T21:02:38.063

一旦用户使用 Facebook Connect 登录，我在弄清楚如何进行服务器端调用时遇到了很多麻烦。关键是一旦成功登录，Facebook Connect javascript 就会在客户端上设置 cookie。您使用这些 cookie 的值在服务器上执行 API 调用。

令人困惑的部分是查看他们发布的 PHP 示例。他们的服务器端 API 自动负责读取这些 cookie 值并设置一个 API 对象，该对象准备好代表登录用户发出请求。

以下是用户使用 Facebook Connect 登录后在服务器上使用[Facebook 工具包](http://www.codeplex.com/FacebookToolkit)的示例。

服务器代码：

```
API api = new API();
api.ApplicationKey = Utility.ApiKey();
api.SessionKey = Utility.SessionKey();
api.Secret = Utility.SecretKey();
api.uid = Utility.GetUserID();

facebook.Schema.user user = api.users.getInfo();
string fullName = user.first_name + " " + user.last_name;

foreach (facebook.Schema.user friend in api.friends.getUserObjects())
{
   // do something with the friend
} 
```

实用程序.cs

```
public static class Utility
{
    public static string ApiKey()
    {
        return ConfigurationManager.AppSettings["Facebook.API_Key"];
    }

    public static string SecretKey()
    {
        return ConfigurationManager.AppSettings["Facebook.Secret_Key"];
    }

    public static string SessionKey()
    {
        return GetFacebookCookie("session_key");
    }

    public static int GetUserID()
    {
        return int.Parse(GetFacebookCookie("user"));
    }

    private static string GetFacebookCookie(string name)
    {
        if (HttpContext.Current == null)
            throw new ApplicationException("HttpContext cannot be null.");

        string fullName = ApiKey() + "_" + name;
        if (HttpContext.Current.Request.Cookies[fullName] == null)
            throw new ApplicationException("Could not find facebook cookie named " + fullName);
        return HttpContext.Current.Request.Cookies[fullName].Value;
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-01T06:43:23.727

我跟进了这个概念并写了一篇完整的文章，在 ASP.NET 中解决了这个问题。请参阅以下内容。

[如何在 ASP.NET 中从 Facebook Connect 检索用户数据 - Devtacular](http://devtacular.com/articles/bkonrad/how-to-retrieve-user-data-from-facebook-connect-in-aspnet/)

感谢 Calebt 为帮助类提供了一个良好的开端。

享受。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-02T07:34:15.550

Facebook Connect 实际上并不太难，只是缺少文档。

从这里放置必要的javascript：http: [//tinyurl.com/5527og](http://tinyurl.com/5527og)

验证 cookie 是否与 facebook 提供的签名匹配以防止黑客攻击，请参阅：[http](http://tinyurl.com/57ry3s) ://tinyurl.com/57ry3s了解如何开始

创建 api 对象 (Facebook.API.FacebookAPI) 在 api 对象上，设置 Facebook 在创建应用程序时为您提供的应用程序密钥和秘密。设置`api.SessionKey`和`api.UserId`从 facebook connect 为您创建的 cookie。

完成后，您可以开始调用 facebook：

```
Facebook.Entity.User user = api.GetUserInfo();   //will get you started with the authenticated person 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-03T02:34:01.163

到目前为止列出的答案中缺少这一点：

登录成功后，Facebook 建议您验证 cookie 实际上是合法的，并由它们放置在客户端计算机上。

这里有两种方法可以一起使用来解决这个问题。您可能希望将 IsValidFacebookSignature 方法添加到 calebt 的 Utility 类。请注意，我也稍微更改了他的 GetFacebookCookie 方法。

```
private bool IsValidFacebookSignature()
{
        //keys must remain in alphabetical order
        string[] keyArray = { "expires", "session_key", "ss", "user" };
        string signature = "";

        foreach (string key in keyArray)
            signature += string.Format("{0}={1}", key, GetFacebookCookie(key));

        signature += SecretKey; //your secret key issued by FB

        MD5 md5 = MD5.Create();
        byte[] hash = md5.ComputeHash(Encoding.UTF8.GetBytes(signature.Trim()));

        StringBuilder sb = new StringBuilder();
        foreach (byte hashByte in hash)
            sb.Append(hashByte.ToString("x2", CultureInfo.InvariantCulture));

        return (GetFacebookCookie("") == sb.ToString());
    }

    private string GetFacebookCookie(string cookieName)
    {
        //APIKey issued by FB
        string fullCookie = string.IsNullOrEmpty(cookieName) ? ApiKey : ApiKey + "_" + cookieName;

        return Request.Cookies[fullCookie].Value;
    } 
```

SecretKey 和 ApiKey 是 Facebook 提供给您的值。在这种情况下，需要设置这些值，最好来自 .config 文件。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-30T20:09:41.280

我跟进了比尔的精彩文章，并制作了这个小组件。它负责从 Facebook Connect cookie 中识别和验证用户。

[用于 ASP.NET 的 Facebook Connect 身份验证](http://fbconnectauth.codeplex.com/ "用于 ASP.NET 的 Facebook Connect 身份验证")

我希望这对某人有帮助！

干杯，

亚当

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-05-30T12:33:56.627

您也可以使用[SocialAuth.NET](http://code.google.com/p/socialauth-net/)

它提供身份验证、配置文件和与 facebook、google、MSN 和 Yahoo 的联系，只需很少的开发工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-11T20:23:06.773

我的两分钱：一个使用“使用 Facebook 登录”功能的**非常简单的项目 -** [facebooklogin.codeplex.com](http://facebooklogin.codeplex.com/)

不是图书馆，但展示了它是如何运作的。

# c# - 静态类与。具有私有构造函数和所有静态属性和方法的类？

> ID：323022
> 
> 赞同：25
> 
> 时间：2008-11-27T05:46:35.953
> 
> 标签：c#, .net

当我创建实用程序类时，我通常会创建一个具有私有构造函数并将其所有方法和属性公开为静态的类。最好的方法是什么？我做的方式或创建静态类的方式有什么区别？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-27T05:54:38.200

静态类是自动密封的，所以人们不能继承和覆盖它们的行为。

这是唯一真正的区别（除非 IL 中有什么特别的东西）

所以如果你使用一个静态类，你就省去了将构造函数设为私有和声明类密封的麻烦。

我要补充一点，将类定义为静态是“自记录”代码。你的库的用户会知道这个类不应该被实例化，并且只有静态值。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-27T05:55:06.543

永远不能实例化静态类。没办法，没办法。

具有私有构造函数但所有静态方法的非静态类可以以各种方式滥用 - 继承、反射、在静态工厂中调用私有构造函数 - 以实例化该类。

如果你从不想要实例化，我会选择静态类。

* * *

*编辑 - 澄清 FosterZ 的评论*

假设您有这个实用程序类：

```
public class Utility
{
    public static string Config1 { get { return "Fourty Two"; } }

    public static int Negate(int x) { return -x; }

    private Utility() { }      
} 
```

如果其他开发人员不清楚其意图，他们可以这样做：

```
public class Utility
{
    public static string Config1 { get { return "Fourty Two"; } }
    public int Config2 { get; set; }

    public static int Negate(int x) { return -x; }

    private Utility() { }

    /// Get an instance of Utility     
    public static Utility GetUtility()
    {
        return new Utility();
    }
} 
```

Now you have a Frankenstein class. Some of its features require instantiation and some don't. Maybe that's what you want but maybe it's not. You could prevent this with code review, but why not make your intentions explicit in code? Marking the class as `static` eliminates any possible confusion. You can't instantiate a static class or inherit from it.

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-27T05:57:05.340

In addition to the previous answers: The compiler won't allow non-static members on static classes and produces and error. This may help a little bit to not accidently add non-static members.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-18T10:03:33.230

you can pass object of a class that has private constructor as a parameter to any method but you can't do the same with static class. This is the major difference.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-27T09:15:04.753

Also I'm going to go with the private constructor never being called by the static methods. So any initialisation in there would be wasted... But that's just a theory.

# c# - C# 有什么可以与 Python 的列表推导相媲美的吗？

> ID：323032
> 
> 赞同：22
> 
> 时间：2008-11-27T05:55:24.140
> 
> 标签：c#, python, list, list-comprehension

我想在 C# 中生成一个列表。我缺少 python 的列表理解。是否有一种 C# 方法可以像 Python 中的列表推导或生成器表达式那样动态创建集合？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-27T05:59:36.347

如果您使用的是 C# 3.0 (VS2008)，那么 LINQ to Objects 可以做非常相似的事情：

```
List<Foo> fooList = new List<Foo>();
IEnumerable<Foo> extract = from foo in fooList where foo.Bar > 10 select Foo.Name.ToUpper(); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-27T06:24:33.317

Matt 提到了查询表达式。顺便说一下，这些通常可用于 LINQ - 而不仅仅是 LINQ to Objects。（例如，应用于 LINQ to SQL 数据上下文的相同查询将在数据库上执行过滤器和投影。）

C# 3 中的查询表达式只是编写普通 C# 代码的语法糖——尽管查询表达式通常最终调用[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)。（它们不必这样做，编译器也不关心，但它们通常会这样做。）您可以对集合执行各种操作，这些操作在 C# 查询表达式中不可用，但受方法调用支持，因此值得了解这两种语法。例如，Matt 的查询表达式为：

```
List<Foo> fooList = new List<Foo>();
IEnumerable<string> extract = from foo in fooList where foo.Bar > 10 select foo.Name.ToUpper(); 
```

被“预处理”成：

```
List<Foo> fooList = new List<Foo>();
IEnumerable<string> extract = fooList.Where(foo => foo.Bar > 10)
                                     .Select(foo => foo.Name.ToUpper()); 
```

如果您想（比如说）根据原始集合中值的索引进行过滤，您可以使用[Where 的适当重载，](http://msdn.microsoft.com/en-us/library/bb549418.aspx)该重载通过查询表达式不可用：

```
List<Foo> fooList = new List<Foo>();
IEnumerable<string> extract = fooList.Where((foo, index) => foo.Bar > 10 + index)
                                     .Select(foo => foo.Name.ToUpper()); 
```

或者您可以找到符合条件的最长名称的长度：

```
List<Foo> fooList = new List<Foo>();
int longestName = fooList.Where((foo, index) => foo.Bar > 10 + index)
                         .Select(foo => foo.Name)
                         .Max(); 
```

（您不必在单独的方法中进行投影和最大值 - 有一个*重载*`Max`也需要一个投影。）

我的观点是，使用扩展方法，您可以非常轻松地构建复杂的查询。

[您还提到了 Python 生成器 - C# 以迭代器块](https://stackoverflow.com/questions/317462/some-help-understanding-yield)的形式具有此功能。事实上，这些在实现类似 LINQ 的运算符时非常有用。（因为大多数 LINQ to Objects 都基于扩展方法，所以您可以将自己的运算符添加到 LINQ 中，这些运算符看起来“本机” - 尽管您自己不能更改查询表达式语法。）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-04-29T17:25:59.427

[`List<T>.ConvertAll`](http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx)通过对现有列表中的每个项目执行相同的操作，然后返回一个新集合，其行为就像列表推导式一样。这是使用 Linq 的替代方法，尤其是在您仍在使用 .NET 2.0 时。

在 Python 中，一个简单的列表理解示例：

```
>>> foo = [1, 2, 3]
>>> bar = [x * 2 for x in foo]
>>> bar
[2, 4, 6] 
```

对于 C# 3.0，您可以传递一个 lambda 函数来指定所需的映射函数类型。

```
public static void Main()
{
    var foo = new List<int>{ 1, 2, 3};
    var bar = foo.ConvertAll(x => x * 2);    // list comprehension

    foreach (var x in bar)
    {
        Console.WriteLine(x);  // should print 2 4 6
    }
} 
```

对于 C# 2.0，您可以使用带有`Converter`委托的匿名方法来执行等效操作。

```
public static void Main()
{
    List<int> foo = new List<int>(new int[]{ 1, 2, 3});
    List<int> bar = foo.ConvertAll(new Converter<int, int>(delegate(int x){ return x * 2; }));  // list comprehension

    foreach (int x in bar)
    {
        Console.WriteLine(x);  // should print 2 4 6
    }
} 
```

（注意：同样可以使用 Arrays 完成[`Array.ConvertAll`](http://msdn.microsoft.com/en-us/library/exc45z53.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-23T07:43:18.687

我知道这是一个非常晚的答案，但我也想知道 C# 是否有任何相当于 python 的列表理解的东西。[据我所知， Matt Campbell](https://stackoverflow.com/a/323039/3375713)和[Jon Skeet](https://stackoverflow.com/a/323058/3375713)的回答展示了如何从现有列表中*提取列表。*但是 python 的列表推导也可以从头开始创建列表。所以这就是我想出的。

首先，我将展示 python 列表理解，然后展示我想出的 C# 等价物。

玩具任务是创建一个这样的字符串

```
cb01, cb02, cb02, ... , cb50 
```

### Python列表理解：

```
s = ', '.join('cb{0:02}'.format(i+1) for i in range(50)) 
```

### 我想出的 C# 等价物：

```
string s = String.Join(", ", new Func<List<string>>( () =>
{
    List<string> list = new List<string>();
    foreach (int i in Enumerable.Range(1, 50))
        list.Add(String.Format("cb{0:00}", i));

    return list;
}).Invoke()); 
```

我不确定我是否做过头。

* * *

**编辑：（**从 Jon Skeet 在他的评论中提到的，一个真正的单行相当于 python 的列表理解）

```
String.Join(", ", Enumerable.Range(1, 50).Select(x => $"cb{x:00}"))) 
```

请注意，这`$`件事是[C# 6 的功能](https://msdn.microsoft.com/en-us/magazine/dn879355.aspx)。如果您仍然不使用 C# 6，则可以使用旧`String.Format()`方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-30T14:48:38.197

有这个：

```
new List<FooBar> { new Foo(), new Bar() } 
```

它只比它的 python 等价物长一点：

```
[Foo(), Bar()] 
```

然后是这样的：

```
public IEnumerable<FooBar> myFooBarGenerator() {
     yield return new Foo();
     yield return new Bar();
} 
```

这相当于python：

```
def myFooBarGenerator():
    yield Foo()
    yield Bar() 
```

# visual-c++ - 用于空中立体图像（左、右图像）的 OpenGL 3d 立体查看

> ID：323053
> 
> 赞同：2
> 
> 时间：2008-11-27T06:17:38.807
> 
> 标签：visual-c++, opengl

我的目的： - 显示与整个左右卫星或航空图像重叠的区域

```
 - rotate image using roll, pitch yaw angles
        -image format is Tiff image 
```

现在我正在为航空立体图像（左、右立体对）进行 OpenGL 3d 立体查看。我使用以下代码显示了我的左右图像：

```
glDrawBuffer (GL_BACK_LEFT);
LeftBuf = new unsigned char [LeftCol * LeftRow *3];

for (int i = 0; i < LeftRow; i++){
    for (int j = 0; j< LeftCol; j++){

        LeftBuf [(i*LeftCol + j)*3] = tiff.LnBuf [i*LeftCol + LeftCol-(j-1)];
        LeftBuf [(i*LeftCol + j)*3+1] = tiff.LnBuf [i*LeftCol + LeftCol-(j-1)];
        LeftBuf [(i*LeftCol + j)*3+2] = tiff.LnBuf [i*LeftCol + LeftCol-(j-1)];

    }
}

glRasterPos2f(-1,-1);
glDrawPixels(LeftCol, LeftRow, GL_RGB, GL_UNSIGNED_BYTE, LeftBuf);

glDrawBuffer (GL_BACK_RIGHT);
RightBuf = new unsigned char [RightCol *RightRow *3];

for (int r = 0; r < RightRow; r++){
    for (int c = 0; c< RightCol; c++){

        RightBuf [(r*RightCol + c)*3] = tiff.RnBuf [r*RightCol + RightCol-(c-1)];
        RightBuf [(r*RightCol + c)*3+1] = tiff.RnBuf [r*RightCol + RightCol-(c-1)];
        RightBuf [(r*RightCol + c)*3+2] = tiff.RnBuf [r*RightCol + RightCol-(c-1)];

    }
}

glRasterPos2f(-1,-0.45);
glDrawPixels(RightCol, RightRow, GL_RGB, GL_UNSIGNED_BYTE, RightBuf); 
```

现在我需要使用 Opengl 以下函数对我的右图像进行 3D 旋转：glRotatef(rightphoto.omega*180/PI,1.0f,0.0f,0.0f); glRotatef(rightphoto.phi*180/PI,0.0f,1.0f,0.0f); glRotatef(rightphoto.kappa*180/PI,0.0f,0.0f,1.0f); 但我无法旋转我的图像。

请帮我如何旋转我的图像！！！！！！！我也想用 3d 旋转显示左右图像相同部分的左侧重叠的整个图像。我不知道如何计算整个左右图像的重叠区域坐标。对不起我糟糕的英语。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T08:36:25.983

使用读取或写入的像素`glDrawPixels()`不会被模型视图矩阵转换，这就是`glRotatef()`变化。它们是像素，是比实际模型更底层的基元。

要解决这个问题，请考虑使用纹理映射图元（例如四边形）来绘制您的内容。

# c# - 在 ASP.NET MVC 标记中设置下拉菜单的最佳方法是什么？

> ID：323063
> 
> 赞同：4
> 
> 时间：2008-11-27T06:35:12.627
> 
> 标签：c#, html, asp.net-mvc

我有这个html...

```
<select id="View" name="View">
   <option value="1">With issue covers</option>
   <option value="0">No issue covers</option>
 </select> 
```

它不会让我插入这样的代码......

```
<select id="View" name="View">
   <option value="1" <% ..logic code..%> >With issue covers</option>
   <option value="0" <% ..logic code..%> >No issue covers</option>
 </select> 
```

那么将一个设置为选中的最佳方法是什么？

更新：不使用 HTML Helpers。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-27T07:52:57.023

“最好”的方法可能是*使用*助手：

```
var selectList = new SelectList(data, "ValueProp", "TextProp", data[1].ValueProp);
... Html.DropDownList("foo", selectList) 
```

其中“数据”可以是一组匿名类型，例如：

```
var data = new[] {
  new {Key=1, Text="With issue covers"},
  new {Key=0, Text="No issue covers"}
};
// todo: pick the selected index or value based on your logic
var selectList = new SelectList(data, "Key", "Text", data[1].Key);
Writer.Write(Html.DropDownList("foo", selectList)); 
```

另一种方法可能是通过脚本在客户端选择正确的项目，但显然这只适用于启用脚本。

请注意，数据声明中缺少逗号和分号，使其无法工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T08:01:25.947

我同意 Marc 关于使用助手的观点，但如果你必须避免使用它们，那么你可以尝试以下方法：

```
<select id="View" name="View">
   <option value="1" <% if (something) { %> selected <% } %> >With issue covers</option>
   <option value="0" <% if (!something) { %> selected <% } %> >No issue covers</option>
</select> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T08:04:10.433

我认为助手是最好的方法。

如果您不传递“选定值”（`SelectList`构造函数中的第 4 个参数），它将从`ModelState`如果可用值中加载。当您处理回发并希望 MVC 在加载时自动维护表单的状态时，这非常方便。如果是第一次加载，您可以将条件设​​置为仅使用带有“选定值”选项的覆盖，然后将其留给 MVC 和 HtmlHelpers 来管理之后的状态。

**查看标记：**

```
<%= Html.DropDownList("RdfParser", ViewData["RdfParserTypes"] as SelectList) %> 
```

**控制器：**

```
var rdfTypes = new[]
    {
        new { value = 0, text = "RDF/XML" },
        new { value = 1, text = "NTriples" },
        new { value = 2, text = "Turtle" },
        new { value = 3, text = "RDFa" }
    };
ViewData["RdfParserTypes"] = new SelectList(rdfTypes, "value", "text", rdfTypes[0]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-24T17:10:14.867

看到这篇博文，它对我有用

[http://weblogs.asp.net/ashicmahtab/archive/2009/03/27/asp-net-mvc-html-dropdownlist-and-selected-value.aspx](http://weblogs.asp.net/ashicmahtab/archive/2009/03/27/asp-net-mvc-html-dropdownlist-and-selected-value.aspx)

# gridview - 如何将 Gridview 转换为 Datatable

> ID：323064
> 
> 赞同：1
> 
> 时间：2008-11-27T06:37:29.640
> 
> 标签：gridview, visual-studio-2005, datatable

我`GridView`在我的应用程序中用于填充数据。

有什么简单的方法可以将 gridview 复制到 datatable 吗？

实际上，在我`GridView`的控件之一是文本框。
所以我可以随时编辑该控件...我需要的是在按钮上单击我所做的任何更改`GridView`都必须复制到一个数据表中...

我使用代码做到了这一点，

```
dt = CType(Session("tempTable"), DataTable) 
i = 0 For Each rows As GridViewRow In Grid1.Rows 
   Dim txt As TextBox 
   txt = CType(rows.FindControl("txt"), TextBox) 
   dt.Rows(i)(1) = txt.Text
   i = i + 1 
Next 
```

在这里，我在“for each”循环的帮助下遍历网格。
我担心它是否会影响性能？
你能告诉我任何其他将a复制`GridView`到数据表的简单方法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T12:33:26.460

最好的方法是使用数据绑定。如果您设法让双向数据绑定工作，您的 DataTable 会自动更新。

性能方面，您可能会从动态生成的表格中获得最佳速度，其中您的文本框有一个 Id，您可以在回发时轻松解释并保存您的更改，而无需 GridView 使用 ViewState 或恢复其状态并触发所有事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T07:50:26.903

如何在没有数据源的情况下使用数据集和数据表在gridview上编辑数据

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T08:54:20.903

html页面看起来像，

```
 <asp:GridView ID="Grid1" runat="server" AutoGenerateColumns="False" GridLines="None">
                                <Columns>
                                    <asp:TemplateField HeaderText="ID">
                                        <ItemTemplate>
                                            <asp:Label ID="lbl1" runat="server" Text='<%#Bind("ID") %>' CssClass="rowHeader"></asp:Label>
                                        </ItemTemplate>
                                        <FooterTemplate>
                                            <asp:TextBox ID="txt1" runat="server" Text='<%#Bind("ID") %>'></asp:TextBox>
                                        </FooterTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField HeaderText="Description">
                                        <ItemTemplate>
                                            <asp:TextBox ID="txt" runat="server" Text='<%#Bind("Description") %>'></asp:TextBox>
                                        </ItemTemplate>
                                        <FooterTemplate>
                                            <asp:TextBox ID="txt2" runat="server" Text='<%#Bind("Description") %>'></asp:TextBox>
                                        </FooterTemplate>
                                    </asp:TemplateField>
                                    <asp:TemplateField HeaderText="Comments">
                                        <ItemTemplate>
                                            <asp:Label ID="Comments" runat="server" Text='<%#Bind("Comments") %>'></asp:Label>
                                        </ItemTemplate>
                                        <FooterTemplate>
                                            <asp:DropDownList ID="Drop1" runat="server">
                                                <asp:ListItem>v1</asp:ListItem>
                                                <asp:ListItem>v2</asp:ListItem>
                                            </asp:DropDownList>
                                        </FooterTemplate>
                                    </asp:TemplateField>
                                </Columns>
                            </asp:GridView>

                            <asp:Button ID="btnAdd" runat="server" Text="Add" />
                            <asp:Button ID="btnSave" runat="server" Text="Save" /> 
```

在页面加载时，

conn = New OleDb.OleDbConnection("Provider = Microsoft.Jet.OLEDB.4.0; 数据源 = D:\GDD_Work\Employee.mdb")

```
 If Not Page.IsPostBack Then

        ViewState("intCount") = 0
        Session("blnFlag") = False

        Dim Cmd As New OleDb.OleDbDataAdapter("Select * from Emp", conn)
        Cmd.Fill(ds, "Employee")

        Grid1.DataSource = ds.Tables("Employee")
        Grid1.DataBind()

        Session("intOldCount") = ds.Tables("Employee").Rows.Count
        Session("tempTable") = ds.Tables("Employee") 
```

在添加按钮单击时，

If Session("blnFlag") = False Then Session("blnFlag") = True Else getFooter() End If

```
 Grid1.FooterRow.Visible = True 
```

点击保存按钮，

Dim intOldCount As Integer Dim intNewCount As Integer Dim dt As New DataTable Dim strQuery As String intOldCount = CType(Session("intOldCount"), Integer) If Session("blnFlag") = True Then

```
 getFooter()
        dt = CType(Session("tempTable"), DataTable)
        intNewCount = dt.Rows.Count

        If intOldCount = intNewCount Then
            Dim tx1 As TextBox
            Dim tx2 As TextBox
            Dim drp As DropDownList
            tx1 = CType(Grid1.FooterRow.FindControl("txt1"), TextBox)
            tx2 = CType(Grid1.FooterRow.FindControl("txt2"), TextBox)
            drp = CType(Grid1.FooterRow.FindControl("Drop1"), DropDownList)

            strQuery = "INSERT INTO Emp (ID,Description,Comments) values ('" + tx1.Text + "','" + tx2.Text + "','" + drp.SelectedValue + "')"
            Dim Cmd As New OleDb.OleDbCommand(strQuery, conn)
            conn.Open()
            Cmd.ExecuteNonQuery()
            conn.Close()

        Else
            For i = intOldCount To intNewCount - 1
                Dim strId As String
                Dim strDesc As String
                Dim strComm As String
                strId = dt.Rows(i)(0).ToString()
                strDesc = dt.Rows(i)(1).ToString()
                strComm = dt.Rows(i)(2).ToString()

                strQuery = "INSERT INTO Emp (ID,Description,Comments) values ('" + strId + "','" + strDesc + "','" + strComm + "')"
                Dim Cmd As New OleDb.OleDbCommand(strQuery, conn)
                conn.Open()
                Cmd.ExecuteNonQuery()
                conn.Close()
            Next
        End If

        For i = 0 To intOldCount - 1
            Dim strId As String
            Dim strDesc As String
            strId = dt.Rows(i)(0).ToString()
            strDesc = dt.Rows(i)(1).ToString()
            strQuery = "update Emp set Description = '" + strDesc + "' where ID = '" + strId + "'"

            Dim Cmd1 As New OleDb.OleDbCommand(strQuery, conn)
            conn.Open()
            Cmd1.ExecuteNonQuery()
            conn.Close()
        Next

        ds = New DataSet()
        Dim CmdData As New OleDb.OleDbDataAdapter("Select * from Emp", conn)
        CmdData.Fill(ds, "Employee")
        Grid1.DataSource = ds.Tables("Employee").DefaultView
        Grid1.DataBind()

        Session("blnFlag") = False
    Else
        dt = CType(Session("tempTable"), DataTable)
        i = 0
        For Each rows As GridViewRow In Grid1.Rows
            Dim txt As TextBox
            txt = CType(rows.FindControl("txt"), TextBox)
            dt.Rows(i)(1) = txt.Text
            i = i + 1
        Next
        Session("tempTable") = dt

        For i = 0 To intOldCount - 1
            Dim strId As String
            Dim strDesc As String
            strId = dt.Rows(i)(0).ToString()
            strDesc = dt.Rows(i)(1).ToString()
            strQuery = "update Emp set Description = '" + strDesc + "' where ID = '" + strId + "'"

            Dim Cmd1 As New OleDb.OleDbCommand(strQuery, conn)
            conn.Open()
            Cmd1.ExecuteNonQuery()
            conn.Close()
        Next

        Grid1.DataSource = dt.DefaultView
        Grid1.DataBind()

    End If 
```

我使用一种功能，例如，

公共函数 getFooter() Dim tx1 As TextBox Dim tx2 As TextBox Dim drp As DropDownList tx1 = CType(Grid1.FooterRow.FindControl("txt1"), TextBox) tx2 = CType(Grid1.FooterRow.FindControl("txt2"), TextBox ) drp = CType(Grid1.FooterRow.FindControl("Drop1"), DropDownList)

```
 Dim dr As DataRow
    Dim dt As DataTable
    dt = CType(Session("tempTable"), DataTable)

    dr = dt.NewRow()
    dr("ID") = tx1.Text
    dr("Description") = tx2.Text
    dr("Comments") = drp.SelectedValue
    dt.Rows.Add(dr)

    i = 0
    For Each rows As GridViewRow In Grid1.Rows
        Dim txt As TextBox
        txt = CType(rows.FindControl("txt"), TextBox)
        dt.Rows(i)(1) = txt.Text
        i = i + 1
    Next

    Grid1.DataSource = dt.DefaultView
    Grid1.DataBind()

    Session("tempTable") = dt
End Function 
```

# database-design - 如何对数据库中的记录进行版本控制

> ID：323065
> 
> 赞同：192
> 
> 时间：2008-11-27T06:39:28.123
> 
> 标签：database-design, architecture, versioning, auditing

假设我在数据库中有一条记录，管理员和普通用户都可以进行更新。

任何人都可以建议一个好的方法/架构来控制这个表中的每一个更改，以便可以将记录回滚到以前的版本？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2008-11-27T07:15:57.707

假设您有一个`FOO`管理员和用户可以更新的表。大多数情况下，您可以针对 FOO 表编写查询。快乐的时光。

然后，我会创建一个`FOO_HISTORY`表。这具有表的所有列`FOO`。主键与 FOO 相同，加上一个 RevisionNumber 列。`FOO_HISTORY`从to有一个外键`FOO`。您还可以添加与修订相关的列，例如 UserId 和 RevisionDate。以不断增加的方式在所有`*_HISTORY`表中填充 RevisionNumbers（即来自 Oracle 序列或等价物）。不要依赖一秒钟内只有一个变化（即不要放入`RevisionDate`主键）。

现在，每次更新`FOO`时，就在更新之前将旧值插入`FOO_HISTORY`. 您在设计的某个基本级别上执行此操作，这样程序员就不会意外错过这一步。

如果你想从中删除一行，`FOO`你有一些选择。级联并删除所有历史记录，或通过标记`FOO`为已删除来执行逻辑删除。

当您对当前值非常感兴趣并且只是偶尔对历史感兴趣时，此解决方案非常有用。如果您总是需要历史记录，那么您可以输入有效的开始日期和结束日期，并保留所有记录`FOO`本身。然后，每个查询都需要检查这些日期。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-27T06:59:46.303

我认为您正在寻找版本控制数据库记录的内容（就像 StackOverflow 在有人编辑问题/答案时所做的那样）。一个好的起点可能是查看一些使用*修订*跟踪的数据库模型。

想到的最好的例子是维基百科引擎 MediaWiki。[比较这里](http://www.mediawiki.org/wiki/Database)的数据库图，尤其是[修订表](https://www.mediawiki.org/wiki/Manual:Revision_table)。

根据您使用的技术，您必须找到一些好的差异/合并算法。

如果它适用于 .NET，请检查[此问题。](https://stackoverflow.com/questions/138331/any-decent-text-diffmerge-engine-for-net)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-11-27T07:09:35.193

在 BI 世界中，您可以通过将 startDate 和 endDate 添加到要版本化的表中来完成此操作。当您将第一条记录插入表中时，将填充 startDate，但 endDate 为空。当您插入第二条记录时，您还会将第一条记录的 endDate 更新为第二条记录的 startDate。

如果要查看当前记录，请选择 endDate 为空的记录。

这有时被称为类型 2[渐变维度](http://en.wikipedia.org/wiki/Slowly_Changing_Dimension)。另请参见[TupleVersioning](http://en.wikipedia.org/wiki/Tuple-versioning)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-28T00:36:38.637

升级到 SQL 2008。

尝试使用 SQL 2008 中的 SQL 更改跟踪。您可以使用此新功能来跟踪数据库中数据的更改，而不是时间戳和墓碑列黑客。

[MSDN SQL 2008 更改跟踪](http://msdn.microsoft.com/en-us/library/cc280462.aspx)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-12-10T03:29:28.690

只是想补充一点，这个问题的一个很好的解决方案是使用[Temporal database](https://en.wikipedia.org/wiki/Temporal_database "时态数据库")。许多数据库供应商开箱即用或通过扩展提供此功能。我已经成功地将[临时表](http://pgxn.org/dist/temporal_tables/1.0.0/)扩展与 PostgreSQL 一起使用，但其他人也有。每当您更新数据库中的记录时，数据库也会保留该记录的先前版本。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-27T09:04:42.090

两种选择：

1.  有一个历史表 - 每当更新原始数据时，将旧数据插入此历史表。
2.  审计表 - 存储之前和之后的值 - 仅用于审计表中修改后的列以及其他信息，如更新者和时间。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-27T12:40:17.413

您可以通过 SQL 触发器对 SQL 表执行审计。从触发器中，您可以访问 2 个特殊表（[插入和删除](http://msdn.microsoft.com/en-us/library/ms191300.aspx)）。这些表包含每次更新表时插入或删除的确切行。在触发器 SQL 中，您可以获取这些修改后的行并将它们插入到审计表中。这种方法意味着您的审计对程序员是透明的；不需要他们的努力或任何实施知识。

这种方法的额外好处是，无论 sql 操作是通过您的数据访问 DLL 还是通过手动 SQL 查询发生的，审计都会发生；（因为审计是在服务器本身上执行的）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-08-03T18:36:00.707

Alok 建议`Audit table`在上面，我想在我的帖子中解释它。

我在我的项目中采用了这种无模式的单表设计。

**架构：**

*   id - 整数自动增量
*   用户名 - STRING
*   表名 - 字符串
*   旧值 - TEXT / JSON
*   新值 - 文本/JSON
*   创建时间 - DATETIME

该表可以将每个表的历史记录都保存在一个位置，在一个记录中包含完整的对象历史记录。该表可以使用触发器/钩子填充数据更改，存储目标行的旧值和新值快照。

**这种设计的优点：**

*   用于历史管理的表数量较少。
*   存储每行新旧状态的完整快照。
*   易于在每张桌子上搜索。
*   可以按表创建分区。
*   可以为每个表定义数据保留策略。

**这种设计的缺点：**

*   如果系统频繁更改，数据量可能很大。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-27T08:10:42.637

你不说什么数据库，我在帖子标签中也没有看到。如果是针对 Oracle，我可以推荐 Designer 中内置的方法：使用[日志表](http://www.google.com/search?hl=en&q=journal+tables+Oracle)。如果是针对任何其他数据库，好吧，我基本上也推荐同样的方式......

它的工作方式，如果你想在另一个数据库中复制它，或者如果你只是想理解它，对于一个表来说，也创建了一个影子表，只是一个普通的数据库表，具有相同的字段规范，加上一些额外的字段：比如最后执行的操作（字符串，典型值“INS”表示插入，“UPD”表示更新，“DEL”表示删除），操作发生时间的日期时间，以及执行者的用户 ID它。

通过触发器，对表中任何行的*每个*操作都会在日志表中插入一个新行，其中包含新值、执行了什么操作、何时执行以及由哪个用户执行。您永远不会删除任何行（至少最近几个月不会）。是的，它会变得很大，很容易达到数百万行，但是您可以轻松地跟踪自日志开始或旧日志行最后一次清除以来的*任何时间点的**任何*记录的值，以及最后一次更改的人。

 *在 Oracle 中，您需要的一切都会自动生成为 SQL 代码，您所要做的就是编译/运行它；它带有一个基本的 CRUD 应用程序（实际上只有“R”）来检查它。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-10-22T23:55:32.830

我也在做同样的事情。我正在为课程计划制作一个数据库。这些计划需要原子更改版本控制的灵活性。换句话说，无论多么小，课程计划的每一次更改都需要被允许，但旧版本也需要保持不变。这样，课程创建者可以在学生使用课程计划时对其进行编辑。

它的工作方式是，一旦学生完成了课程，他们的结果就会附加到他们完成的版本中。如果进行了更改，他们的结果将始终指向他们的版本。

这样，如果删除或移动课程标准，其结果将不会改变。

我目前这样做的方式是处理一张表中的所有数据。通常我只有一个 id 字段，但在这个系统中，我使用了一个 id 和一个 sub_id。sub_id 通过更新和删除始终与行保持一致。id 是自动递增的。课程计划软件将链接到最新的 sub_id。学生成绩将链接到 id。我还包含了一个时间戳，用于跟踪更改发生的时间，但没有必要处理版本控制。

一旦我测试了它，我可能会改变的一件事是我可能会使用前面提到的 endDate null 想法。在我的系统中，要找到最新版本，我必须找到 max(id)。另一个系统只是寻找 endDate = null。不确定是否有另一个日期字段的好处。

我的两分钱。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-11-28T02:25:30.097

虽然@WW。答案是一个很好的答案另一种方法是创建一个版本列并将所有版本保存在同一个表中。

**对于一个表方法**，您可以：

*   使用标志来表示最新的 ala [**Word Press**](http://codex.wordpress.org/Database_Description)
*   或者做一个讨厌的大于版本`outer join`。

`outer join`使用修订号的方法的示例 SQL是：

```
SELECT tc.*
FROM text_content tc
LEFT OUTER JOIN text_content mc ON tc.path = mc.path
AND mc.revision > tc.revision
WHERE mc.revision is NULL 
AND tc.path = '/stuff' -- path in this case is our natural id. 
```

坏消息是上面需要一个`outer join`并且外部连接可能很慢。好消息是理论上创建新条目更便宜，因为您可以在**没有事务的情况下在一次写入操作中完成**（假设您的数据库是原子的）。

进行新修订的示例`'/stuff'`可能是：

```
INSERT INTO text_content (id, path, data, revision, revision_comment, enabled, create_time, update_time)
(
SELECT
(md5(random()::text)) -- {id}
, tc.path
, 'NEW' -- {data}
, (tc.revision + 1)
, 'UPDATE' -- {comment}
, 't' -- {enabled}
, tc.create_time
, now() 
FROM text_content tc
LEFT OUTER JOIN text_content mc ON tc.path = mc.path
AND mc.revision > tc.revision
WHERE mc.revision is NULL 
AND tc.path = '/stuff' -- {path}
) 
```

我们使用旧数据插入。如果您只想更新一列并避免乐观锁定和/或事务，这将特别有用。

标志方法和历史表方法需要插入/更新**两**行。

修订号方法的另一个优点`outer join`是，您以后可以随时使用触发器重构为多表方法，因为您的触发器本质上应该执行上述操作。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-01T16:37:21.913

作为我上面答案的附加步骤，我建议给每个生成的更改一个唯一的 ID，可能是日期/时间和每天的唯一计数器（这样一秒钟的多个更新不会重叠）。我将在此代码中包含一个操作类型代码，即“9129128213939REPLACE”。这提供了一种稳健性，以允许完整性检查您的其他历史系统是否正常工作。

# security - 生成一个我可以证明我生成的令牌

> ID：323067
> 
> 赞同：9
> 
> 时间：2008-11-27T06:41:28.587
> 
> 标签：security, encryption

我需要生成随机令牌，这样当我以后看到它们时，我可以绝对确定它们实际上是由我生成的，即其他人几乎不可能生成假令牌。这有点像序列号生成，只是我不需要唯一性。实际上，它很像数字签名，只是我是唯一需要验证“签名”的人。

我的解决方案如下：

1.  有一个秘密字符串 S（这是唯一未公开的数据）
2.  对于每个token，生成一个随机字符串K
3.  令牌 = K + MD5(K + S)

验证令牌是我生成的：

1.  将传入的令牌拆分为 K + H
2.  计算MD5(K + S)，确保等于H

在我看来，在没有 S 的情况下，任何人都不可能可靠地生成 H。这个解决方案是否过于简单？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T06:48:05.377

查看[HMAC](http://en.wikipedia.org/wiki/HMAC)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T07:01:52.773

您提出的解决方案是正确的。您实际上是在对自己执行[质询-响应身份验证](http://en.wikipedia.org/wiki/Challenge-response_authentication)。每个令牌可以由非秘密质询字符串 C 和 HMAC(C, K) 组成，其中 K 是您的服务器的密钥。

要验证令牌，只需使用提供的 C 值重新计算 HMAC 并查看它是否与提供的 HMAC 值匹配。

另外，正如 Vinko 所说，您不应该使用 MD5；SHA-256 是一个不错的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T06:43:29.550

这并不太简单，这肯定是实现简单数字签名的有效方法。

当然，您无法在不透露您的密钥 S 的情况下向其他任何*人*证明您生成了签名，但为此您需要使用更复杂的协议，如 PKI。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T06:47:29.370

只是挑剔一点，您将证明*只有*有权访问 S 的人才能生成令牌。另一个小细节：使用更好的哈希，比如 SHA256。因为如果 Mallory 能够产生碰撞，她甚至不需要知道 S。

# linq - 如何在程序中的实体框架中检索实体的映射表名称

> ID：323072
> 
> 赞同：4
> 
> 时间：2008-11-27T06:44:34.603
> 
> 标签：linq, entity-framework, .net-3.5

有没有办法在程序中的实体框架中检索实体的映射表名称？我知道您可以使用 .ToTraceString() 获取命令文本然后提取表名，但是 ToTraceString() 方法非常慢。有没有其他方法像使用 ObjectContext.MetadataWorkspace？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-26T20:34:16.770

在 EF v1.0 ToTraceString 是唯一的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T02:02:55.733

感谢您的回答，但上面的代码适用于 LINQ to SQL，它不适用于实体框架，因为 EF 中的实体类没有表名属性。映射信息在 XML 的 edmx 文件中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-25T16:56:56.967

您可以使用 <dataContext>.<EntityName>.CommandText 属性来获取实体的名称。也许这有帮助...

# visual-c++ - vc++ MFC项目

> ID：323073
> 
> 赞同：0
> 
> 时间：2008-11-27T06:47:05.020
> 
> 标签：visual-c++, visual-c++-6

在 Vc++ 6.0 mscomm 控件中，请任何人解释这个函数它是如何工作的，它是做什么的

```
if (m_comm.GetCommEvent()==2 ) 
        {   
            VARIANT in_dat;
            in_dat = m_comm.GetInput();
            CString strInput(in_dat.bstrVal);
            m_input = m_input + strInput;
            UpdateData(FALSE);  
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T08:05:48.013

该代码检查是否发生了通信事件。如果是，则从控件获取输入数据并将其附加到 m_input。之后，数据被更新。

该代码没有提供更多的洞察力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T09:03:38.020

万一您不知道，HS 帖子中的“数据已更新”意味着“对话框字段已更新以显示新数据”

# c# - 查询内存中的复杂数据结构

> ID：323079
> 
> 赞同：1
> 
> 时间：2008-11-27T06:50:36.993
> 
> 标签：c#, .net

第一次发布到问题网站，但我有一个复杂的问题，我已经看了几天。

**背景** 在工作中，我们正在实施一个新的计费系统。但是，我们希望采取前所未有的举措，将新计费系统与旧计费系统进行实际审计，旧计费系统在持续的基础上更加强大。原因是新的计费系统对于我们的新费率计划更加灵活，因此营销确实需要我们来实施这个新的计费系统。

我们让我们的 IT 团队针对昨天的数据在每天早上 8 点运行的巨额资金开发报告，比较记录以获取字节计数差异，并生成报告。这对我们来说不是很有用，因为它在第二天运行，其次如果它显示不好的结果，我们没有任何迹象表明为什么我们可能在前一天遇到了问题。

所以我们想建立我们自己的系统，它可以连接到任何可能的数据源（起初只有新旧系统的用户数据记录（UDR））并近乎实时地比较结果。

只是规模上的一些注释，每个计费系统每天产生大约 600 万条记录，总文件大小约为 1 gig。

**我建议的设置** 基本上，购买一些服务器，我们有几台 8 核 / 32GB RAM 机器的预算，所以我想在内存数据结构中进行所有处理和存储。如有必要，我们可以购买更大的服务器，但几天后，我看不出有任何理由再将数据保存在内存中（写入持久存储）并将汇总统计信息存储在数据库中。

每条记录本质上包含来自平台的记录 ID、相关 ID、用户名、登录时间、持续时间、字节输入、字节输出和其他一些字段。

我正在考虑使用相当复杂的数据结构进行处理。每条记录都将被分解为一个用户对象，一个记录对象属于平台 a 或平台 b。在顶层，将是用户名上的二叉搜索树（自平衡）。下一步有点像基于日期的跳过列表，所以我们会有下一个matched_record、下一天、下一个小时、下个月、明年等。最后我们会有匹配的记录对象，本质上只是一个持有者从系统 a 引用 udr_record 对象，从系统 b 引用 udr 记录对象。

在添加数据时，我会运行一些内部分析，以查看新计费系统是否已阻塞，与旧系统相比是否开始出现较大差异，并向我们的运营中心发送警报以进行调查。我自己对这部分没有任何问题。

**问题** 我遇到的问题是聚合统计信息很棒，但我想看看我是否可以提出一种查询语言，用户可以在其中输入查询，例如此警报的主要贡献者，并查看哪些记录有助于差异，并深入调查。最初，我想使用类似于wireshark 中的过滤器的语法，并在SQL 中添加了一些语法。

例子：

```
udr.bytesin > 1000 && (udr.analysis.discrepancy > 100000 || udr.analysis.discrepency_percent > 100) && udr.started_date > '2008-11-10 22:00:44' order by udr.analysis.discrepancy DESC LIMIT 10 
```

另一种选择是使用 LINQ，但我已经离开 C# 游戏一年半了，所以在 .net 3.5 的东西上没有 100% 的速度。另外我不确定它是否可以处理我计划使用的数据结构。真正的问题是，我能否获得有关如何处理从用户那里获取查询字符串、解析它并将其应用于数据结构（上面概述了更多属性）并获得结果的任何反馈回列表。我可以自己处理剩下的事情。

我已经完全准备好对许多可能的查询进行硬编码，并将它们更多地作为使用某些参数运行的报告，但是如果有一种很好的干净方式来执行这种类型的查询语法，我认为它会非常酷要添加的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T06:57:15.983

实际上，对于上述类型的查询，[动态 LINQ](http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=csharpsamples&DownloadId=51)非常适合。否则，无论如何你都必须编写几乎相同的东西——一个解析器，以及一个将其映射到属性的机制。不幸的是，这不是一个*精确的*命中，因为您需要拆分像 OrderBy 这样的东西，并且需要参数化日期 - 但这是一个工作示例：

```
class Udr { // formatted for space
    public int BytesIn { get; set; }
    public UdrAnalysis Analysis { get; set; }
    public DateTime StartedDate { get; set; }
}
class UdrAnalysis {
    public int Discrepency { get; set; }
    public int DiscrepencyPercent { get; set; }
}    
static class Program {
    static void Main() {
        Udr[] data = new [] {
              new Udr { BytesIn = 50000, StartedDate = DateTime.Today,
                 Analysis = new UdrAnalysis { Discrepency = 50000, DiscrepencyPercent = 130}},
              new Udr { BytesIn = 500, StartedDate = DateTime.Today,
                 Analysis = new UdrAnalysis { Discrepency = 50000, DiscrepencyPercent = 130}}
        };
        DateTime when = DateTime.Parse("2008-11-10 22:00:44");
        var query = data.AsQueryable().Where(
            @"bytesin > 1000 && (analysis.discrepency > 100000
                || analysis.discrepencypercent > 100)
                && starteddate > @0",when)
            .OrderBy("analysis.discrepency DESC")
            .Take(10);
        foreach(var item in query) {
            Console.WriteLine(item.BytesIn);
        }
    }
} 
```

当然，您可以获取动态 LINQ 示例并自定义解析器以执行更多您需要的操作...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T07:14:39.410

无论您是否使用 LINQ，我都怀疑您会希望在解决方案中的*某个地方*使用 LINQ ，因为它提供了您想要的很多内容。

您需要用户提供多少保护，他们的技术水平如何？如果这仅适用于一些非常技术性的内部人员（例如已经是开发人员），那么您可以让他们编写 C# 表达式，然后使用[CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)编译代码 - 然后将其应用于您的数据。

显然，这要求您的用户能够编写 C# - 或者至少足以编写查询表达式 -*并且*要求您相信他们不会破坏服务器。（您可以将代码加载到单独的 AppDomain 中，赋予它低权限并在超时后拆除 AppDomain，但这种事情实现起来很复杂 - 而且您真的不希望大量数据跨越 AppDomain 边界。 )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T07:25:19.093

关于 LINQ 的一般主题-再次，由于您的尺寸问题，非常适合：

> 只是规模上的一些注释，每个计费系统每天产生大约 600 万条记录，总文件大小约为 1 gig。

LINQ 可以完全与流解决方案一起使用。例如，您的“来源”可能是文件阅读器。然后 Where 将遍历数据检查各个行，而不必在内存中缓冲整个内容：

```
 static IEnumerable<Foo> ReadFoos(string path) {
        return from line in ReadLines(path)
               let parts = line.Split('|')
               select new Foo { Name = parts[0],
                   Size = int.Parse(parts[1]) };
    }
    static IEnumerable<string> ReadLines(string path) {
        using (var reader = File.OpenText(path)) {
            string line;
            while ((line = reader.ReadLine()) != null) {
                yield return line;
            }
        }
    } 
```

这现在是延迟加载......我们一次只读取一行。您需要将`AsQueryable()`它与动态 LINQ 一起使用，但它仍然很懒惰。

如果您需要对同一数据执行多个聚合，那么[Push LINQ](http://www.yoda.arachsys.com/csharp/miscutil/)非常适合；如果您需要对[数据进行分组](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)，这会特别有效，因为它不会缓冲所有内容。

最后——如果你想要二进制存储，可以使用像[protobuf-net这样的序列化器来创建流解决方案。](http://code.google.com/p/protobuf-net/)目前，它最适合使用 Push LINQ 的“推送”方法，但我希望`IEnumerable<T>`如果需要，我可以将其反转为常规方法。

# asp.net-mvc - ASP.NET MVC 文件夹控制器 Html.ActionLink

> ID：323088
> 
> 赞同：0
> 
> 时间：2008-11-27T06:59:08.303
> 
> 标签：asp.net-mvc, actionlink, actionresult

我在几乎空的 ASP.NET MVC 项目的 Site.Master 页面中有以下代码。

```
<li>
    <%= Html.ActionLink("Home", "Index", "Home")%>
</li>
<li>
    <%= Html.ActionLink("Feed List", "FeedList", "Home")%>
</li>
<li>
    <%= Html.ActionLink("Monitored Feeds", "MonitoredFeeds", "Home")%>
</li>
<li>
    <%= Html.ActionLink("About", "About", "Home")%>
</li> 
```

除了一个文件夹之外，我还没有向名为 Feeds 的 Views 文件夹添加任何其他内容。在 Feeds 文件夹中，我有两个视图；FeedList.aspx 和 MonitoredFeeds.aspx。我还将以下代码添加到 HomeController 中，如下所示。

```
 [HandleError]
public class HomeController : Controller
{
    public ActionResult Index()
    {
        ViewData["Title"] = "The Reporter";
        ViewData["Message"] = "Welcome to The Reporter.";
        return View();
    }

    public ActionResult About()
    {
        ViewData["Title"] = "About Page";
        return View();
    }

    public ActionResult FeedList()
    {
        ViewData["Title"] = "Feed List";
        return View();
    }

    public ActionResult MonitoredFeeds()
    {
        ViewData["Title"] = "Monitored Feeds";
        return View();
    }
} 
```

不管我做什么，每当我点击页面的链接时，都会显示以下错误。

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

The view 'FeedList' or its master could not be found. The following locations were searched:
~/Views/Home/FeedList.aspx
~/Views/Home/FeedList.ascx
~/Views/Shared/FeedList.aspx
~/Views/Shared/FeedList.ascx 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.InvalidOperationException: The view 'FeedList' or its master could not be found. The following locations were searched:
~/Views/Home/FeedList.aspx
~/Views/Home/FeedList.ascx
~/Views/Shared/FeedList.aspx
~/Views/Shared/FeedList.ascx

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 

[InvalidOperationException: The view 'FeedList' or its master could not be found. The following locations were searched:
~/Views/Home/FeedList.aspx
~/Views/Home/FeedList.ascx
~/Views/Shared/FeedList.aspx
~/Views/Shared/FeedList.ascx]
   System.Web.Mvc.ViewResult.FindView(ControllerContext context) +493
   System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +199
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ActionResult actionResult) +105
   System.Web.Mvc.<>c__DisplayClass13.<InvokeActionResultWithFilters>b__10() +39
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +385
   System.Web.Mvc.<>c__DisplayClass15.<InvokeActionResultWithFilters>b__12() +61
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ActionResult actionResult, IList`1 filters) +386
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +736
   System.Web.Mvc.Controller.ExecuteCore() +180
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +96
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +36
   System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext) +377
   System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext) +71
   System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +36
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +181
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.3053; ASP.NET Version:2.0.50727.3053 
```

我错过了什么吗？我需要在某处添加 Feeds 文件夹吗？提要是否需要转到我在链接中列出“主页”的位置？我什至试过了，但仍然有错误。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-27T07:09:18.953

您的控制器称为“Home”，因此您的视图应该位于 Views/Home 文件夹中，而不是 Views/Feeds 中。

错误消息明确指出它正在搜索 ~/Views/Home/FeedList.aspx 和 ~/Views/Home/FeedList.ascx

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-27T08:06:12.520

创建一个 FeedsController.cs 并将它们移动到该控制器

```
public ActionResult FeedList()
{
    ViewData["Title"] = "Feed List";
    return View();
}

public ActionResult MonitoredFeeds()
{
    ViewData["Title"] = "Monitored Feeds";
    return View();
} 
```

然后修复这些以使用 Feeds 控制器

```
<li>
    <%= Html.ActionLink("Feed List", "FeedList", "Feeds")%>
</li>
<li>
    <%= Html.ActionLink("Monitored Feeds", "MonitoredFeeds", "Feeds")%>
</li> 
```

# c - 静态与全局在 C 中的速度和空间消耗

> ID：323094
> 
> 赞同：6
> 
> 时间：2008-11-27T07:03:24.440
> 
> 标签：c, gcc, static, embedded, global

我想知道静态变量和全局变量在**访问速度**和**空间消耗**方面的区别。（如果你想知道我的平台：Windows 上的 gcc 编译器。（我使用 Cygwin 和 Triton IDE 在 Windows 上进行 ARM7 嵌入式编程。Triton 在 Java 平台上带有 gcc 编译器，可以在 Windows 上运行。））

[（显然我知道这个问题](https://stackoverflow.com/questions/320461/why-main-cannot-be-declared-as-a-static-in-c)的文件和功能范围）

**编辑：**好的，给我一个关于任何微控制器/处理器环境的答案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-27T08:00:08.990

空间没有区别，它们的数量相同。

但是有一个速度差异：静态更快。

当然，对变量的内存访问对于全局和静态来说是一样的。但是当你有静态时编译器可以优化。当它编译一个模块时，它知道对模块外部函数的任何函数调用都不能改变静态变量。所以它确切地知道发生了什么，并且可以例如通过函数调用将其保存在寄存器中。当它是全局的并且您从不同的模块调用函数时，编译器无法知道它的作用。因此，他必须假设函数访问变量并更改它，从而导致存储和重新加载。

使用 gcc 您可以同时传递所有`.c`源代码，因此它还可以查看函数调用来自不同模块的函数时发生的情况。要使其工作，您必须同时传递所有`.c`文件`-combine`和`-fwhole-program`. 这`-fwhole-program`使得所有全局变量都是静态的（不是模块静态，而是编译单元静态，即所有给定的`.c`文件一起）。进行模块间分析`-combine`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T07:09:12.103

空间消耗：基本没有区别。唯一会出现空间问题的情况是，如果您设法将相同的静态数据块隐藏在 N 个对象文件中，那么您会得到 N 的乘法因子，如果它是单个全局片段，您可能只有 1 个副本数据的。然而，这是一个错误的设计问题。信息隐藏是好的——除非信息不应该被隐藏。

访问速度：没有区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T07:10:11.557

很难猜测或估计。这可能需要时间，但我会制作一个示例项目并测试速度。使用循环测试访问速度和空间。使用该架构的模拟器测试示例项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T07:30:23.980

我希望任何差异都来自打包（空间）和缓存（速度）问题。这两者也可能来自其他任何事物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T10:13:37.473

当涉及到**space**时，您描述的 env没有**区别**。静态或全局 var 消耗的内存量相同。

 **出于**速度**考虑（*但不是好的做法*） ，如果您需要访问一个文件之外的 var，您可能**更喜欢 global vars 。**（参考使用`external char my_global_char_placed_else_where;`）

为了更好地练习，您可以使用 get/set 函数，但它们速度较慢。因此，您可以使用宏来获取/设置全局变量，以向代码读者隐藏变量实际上是全局的，但这有点像作弊。但它可以使代码更具可读性。

如果您比较将 var 隐藏在函数内部，那么与将其放在函数外部相比没有区别，并且更多函数可以访问 var。

我自己使用 MSP430、ARM7（仅用于测试）和 AVR32 micros 进行开发

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-10T20:39:09.220

乔纳森所说的并不完全正确。静态和全局变量都将（必须）保存在 ZI（或 RW 数据）区域中。编译器不能严格地将它“保留”在寄存器上——它可能做的是将值加载到寄存器中，将该寄存器用于所有操作，然后将该值保存回来——这是编译器特定的优化。即便如此，编译器也没有理由对全局变量也这样做：除非你当然让它变得易变。但是，从技术上讲，您也可以将静态变量设为 volatile，因此同样没有区别。

编辑：哦，是的 - 空间：没有区别。

# javascript - 最好的javascript组合框？

> ID：323112
> 
> 赞同：8
> 
> 时间：2008-11-27T07:16:27.410
> 
> 标签：javascript, user-interface, combobox, autocomplete

组合框是一个自动完成的文本框，也是一个下拉列表（即，如果您愿意，可以从列表中选择）。

“最佳”意味着组合：稳定、外观/感觉、API/可定制性、成熟度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-29T02:47:42.900

[ExtJS](http://extjs.com/)有一个[非常强大的组合框](http://www.extjs.com/deploy/dev/docs/?class=Ext.form.ComboBox)，它提供[下拉、自动完成和过滤选项](http://extjs.com/deploy/dev/examples/form/combos.html)。您还可以启用[分页](http://extjs.com/deploy/dev/examples/form/forum-search.html)，

有许多扩展提供了额外的功能，例如[Facebook 风格的多选](http://extjs.com/forum/showthread.php?t=33794&highlight=combo+extension)或多[选复选框](http://lovcombo.extjs.eu/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T21:14:21.820

我喜欢[Yahoo UI 自动完成小部件](http://developer.yahoo.com/yui/autocomplete/)。它本身不提供下拉菜单，但可以通过[几行代码](http://tech.groups.yahoo.com/group/ydn-javascript/message/30178)添加一个下拉按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T08:05:05.940

这当然是一个主观问题，但我对[Script.aculo.us](http://script.aculo.us/)的自动完成器（[此处的 API 文档](http://github.com/madrobby/scriptaculous/wikis/ajax-autocompleter)）有很好的经验。它已经存在了很长一段时间，浏览器支持非常好，您可以自定义外观等。

注意 Script.aculo.us 依赖于[Prototype](http://prototypejs.org/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-29T01:20:02.717

当然，自动完成和组合框有两个相似但不同的目的：

*   自动完成；从很长的列表中选择一个（即太长而无法滚动）
*   组合框; 从相对较短的列表中选择一个（即一个易于滚动的列表）

您的清单中有多少项目？

# gdi+ - 如何使用 GetHBITMAP 方法？

> ID：323126
> 
> 赞同：2
> 
> 时间：2008-11-27T07:26:32.960
> 
> 标签：gdi+, bitmap, hbitmap

我有一个 gdi+ 位图，我想将位图转换为 HBitmap。我编写以下代码。

```
 HBITMAP temp;
    Color color;
    img->GetHBITMAP(color, &temp); 
```

但它不起作用，我怎样才能获得 HBitmap？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-27T07:35:50.257

检查 GetHBITMAP 函数的返回值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T07:41:06.580

[来自MSDN](http://msdn.microsoft.com/en-us/library/2k57eh1k.aspx)的演示代码：

```
void DemonstrateGetHbitmapWithColor()
{
   Bitmap^ bm = gcnew Bitmap( "Picture.jpg" );
   IntPtr hBitmap = bm->GetHbitmap( Color::Blue );

   // Do something with hBitmap.
   DeleteObject( hBitmap );
} 
```

# csv - 读取 CSV 数据的最佳方法是什么？

> ID：323131
> 
> 赞同：1
> 
> 时间：2008-11-27T07:32:42.633
> 
> 标签：csv, connection-string, oledb, c#-2.0

我正在使用 C# 并尝试`CSV`使用此连接字符串读取 a；

> ```
> Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Documents and Settings\rajesh.yadava\Desktop\orcad;Extended  Properties="Text;HDR=YES;IMEX=1;FMT=Delimited" 
> ```

这适用于制表符分隔的数据。

我想要一个连接字符串，它应该用于制表符分隔以及逗号（，）和管道（|）。

如何为`CSV`.

谢谢拉杰什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T07:44:54.340

filehelpers库[是](http://filehelpers.sourceforge.net/)一个选项吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T08:32:34.930

如果您需要快速顺序访问 CSV 文件，可以选择[快速 CSV 阅读器。](http://www.codeproject.com/KB/database/CsvReader.aspx "一个快速的 CSV 阅读器")前段时间我在一个项目中使用它并取得了巨大的成功。它应该进行了很好的优化，并且如果您需要它还提供缓存版本。此外，它自 2005 年首次发布以来已多次更新（最后一次更新于 2008 年 10 月 9 日），它通过实现`System.Data.IDataReader`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T07:49:10.713

我知道这不能回答你的问题，但这里有一个警告。

我不得不创建自己的阅读器，因为如果您曾经在 64 位系统上运行，您将无法获得正确的驱动程序。

如果您的软件将在 64 位系统上运行，请确保您首先对其进行测试，并且将存在 oledb 或 odbc 驱动程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T08:30:18.403

如果不滚动自定义解决方案，我不确定是否有一种直接的方法可以支持多个分隔符。[该页面](http://msdn.microsoft.com/en-us/library/ms709353.aspx)建议通过 schema.ini 您可以选择：

*   制表符分隔
*   CSV 分隔
*   一个特定字符（双引号除外）
*   固定宽度

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T00:09:04.010

使用 TextFieldParser 类是一种选择吗？

[http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-27T08:18:35.957

以下是网络上讨论此问题的一些链接：

*   [操作 CSV 文件](http://weblogs.asp.net/fmarguerie/archive/2003/10/01/29964.aspx)
*   [ConnectionStrings.com](http://www.connectionstrings.com/?carrier=textfile)
*   [如何使用 Jet Provider 的 Text IIsam 打开分隔的文本文件](http://support.microsoft.com:80/support/kb/articles/Q262/5/37.ASP)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-17T04:37:35.707

```
 class CSVFile extends SplFileObject
{

private $keys;

    public function __construct($file)
    {
        parent::__construct($file);
        $this->setFlags(SplFileObject::READ_CSV);
    }

    public function rewind()
    {
        parent::rewind();
        $this->keys = parent::current();
        parent::next();
    }

    public function current()
    {
        return array_combine($this->keys, parent::current());
    }

    public function getKeys()
    {
        return $this->keys;
    }
} 
```

然后使用：

```
$csv = new CSVFile('exmaple.csv'); 
```

您可以使用以下方法遍历行：

```
foreach ($csv as $line)
{ 
```

# php - PHPSpec - 无法运行，有人使用它进行 php 开发吗？

> ID：323133
> 
> 赞同：3
> 
> 时间：2008-11-27T07:34:13.863
> 
> 标签：php, bdd, phpspec

在stackoverflow上搜索了这个并没有找到答案

来自 Ruby On Rails 和 Rspec，我需要像 rspec（更轻松的转换）这样的工具。通过 PEAR 安装它并尝试运行它，但它不工作（还）

只是想问一下是否有人在使用它有同样的问题，因为它根本没有运行

尝试使用手册中的示例运行它 - [http://dev.phpspec.org/manual/en/before.writing.code.specify.its.required.behaviour.html](http://dev.phpspec.org/manual/en/before.writing.code.specify.its.required.behaviour.html#id569490)

```
phpspec NewFileSystemLoggerSpec 
```

什么都不返回

甚至跑步

```
phpspec some_dummy_value 
```

什么都不返回

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-07-27T22:59:04.480

PHPSpec 的开发自 2010 年 8 月开始，经过 2 年的中断。代码库现在看起来更稳定了。我会再试一次。

该网站现在位于 www.phpspec.net

[您可以在http://www.phpspec.net/documentation](http://www.phpspec.net/documentation)找到文档。它基本上是第一个版本的更新。

如果您需要任何进一步的帮助，您还可以通过他们的邮件列表联系开发人员： [http ://groups.google.com/group/phpspec-dev](http://groups.google.com/group/phpspec-dev)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-25T08:54:26.220

我已经成功使用了 PHPSpec，但它现在还没有积极开发，是吗？这很棒，但不要认为我会选择一个停滞不前的项目。无论如何，我使用以下设置从网络浏览器运行测试，也许你会找到一些东西来帮助你为 CLI 设置它。

PHPSpecConfiguration.php

```
$projectDir = realpath( dirname(__FILE__) . DIRECTORY_SEPARATOR . '..' ) . DIRECTORY_SEPARATOR;

$simdal_root = $projectDir . 'library';
$phpspec_root = $projectDir . '..' . DIRECTORY_SEPARATOR . 'PHPSpec';
$mockery_root = $projectDir . '..' . DIRECTORY_SEPARATOR . 'Mockery';

$paths = array(
    'SimDAL'=>$simdal_root,
    'PHPSpec'=>$phpspec_root,
    'Mockery'=>$mockery_root
);

set_include_path( implode( PATH_SEPARATOR, $paths ) . PATH_SEPARATOR . get_include_path() );

require_once 'PHPSpec.php';
require_once 'Mockery/Framework.php';

class Custom_Autoload
{
    public static function autoload($class)
    {
        //$path = dirname(dirname(__FILE__));
        //include $path . '/' . str_replace('_', '/', $class) . '.php';
        if (preg_match('/^([^ _]*)?(_[^ _]*)*$/', $class, $matches)) {
            include str_replace('_', '/', $class) . '.php';
            return true;
        }

        return false;
    }

}

spl_autoload_register(array('Custom_Autoload', 'autoload')); 
```

然后是运行它的文件：AllSpecs.php；

```
require_once 'PHPSpecTestConfiguration.php';

$options = new stdClass();
$options->recursive = true;
$options->specdocs = true;
$options->reporter = 'html';

PHPSpec_Runner::run($options); 
```

我不喜欢 CLI 测试……但这可能对某人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T15:08:17.677

我也无法让它运行，但您也可以将 BDD 与 PHPUnit 一起使用。检查[文档](http://www.phpunit.de/manual/3.3/en/behaviour-driven-development.html)：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T19:14:36.710

Was really looking forward to using PHPSpec, oh I guess will check into PHPUnit

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T18:03:34.727

您可以在 PHPUnit 中编写 RSpec-ish 类型的测试，但它受到一些事情的阻碍。

*   PHPUnit 模拟不允许您重新声明它们，因此很难在 before 方法中设置一堆存根然后根据需要覆盖它们。您可以通过安排在预期之后设置存根来解决此问题，但这很奇怪。

*   PHP 不像 Ruby 那样动态，所以你不能轻易地模拟或存根类方法，除非你专门为此设计类，即使那样它也很丑陋。（这可能会随着 PHP 5.3 的后期静态绑定特性而改变）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-12T10:02:03.053

您好，它确实很老 Q.，但我认为[http://behat.org/](http://behat.org/)应该在这里。每个人都有这个问题应该检查一下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-27T22:22:18.173

我尝试使用 phpspec，但发现它太错误/不成熟。我强烈推荐[SimpleTest](http://simpletest.sourceforge.net/)来编写单元测试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-12T10:08:34.593

请注意，PHPSpec 已停产：

[http://blog.atrumfutura.com/2010/05/the-mockery-php-mock-objects-made-simple/#comment-88628508](http://blog.astrumfutura.com/2010/05/the-mockery-php-mock-objects-made-simple/#comment-88628508)

# .net - System.BadImageFormatException：无法加载文件或程序集（来自 installutil.exe）

> ID：323140
> 
> 赞同：115
> 
> 时间：2008-11-27T07:39:01.967
> 
> 标签：.net, windows-services, x86, 64-bit, x86-64

我正在尝试使用 InstallUtil.exe 安装 Windows 服务并收到错误消息

> System.BadImageFormatException: 无法加载文件或程序集“ `{xxx.exe}`”或其依赖项之一。试图加载格式不正确的程序。

是什么赋予了？

* * *

编辑：（不是由 OP）从 dup 中提取的完整消息获得更多点击 [for googleability]：

> C:\Windows\Microsoft.NET\Framework64\v4.0.30319>InstallUtil.exe C:\xxx.exe Microsoft (R) .NET Framework 安装实用程序版本 4.0.30319.1 版权所有 (c) Microsoft Corporation。版权所有。
> 
> 初始化安装时发生异常：System.BadImageFormatException：无法加载文件或程序集“file:///C:\xxx.exe”或其依赖项之一。试图加载格式不正确的程序..

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2010-01-29T09:18:32.567

一些更完整的细节，以防它帮助某人......

请注意，目前此异常的最常见原因是尝试将 32 位特定 ( `/platform:x86`) DLL 加载到 64 位进程中，反之亦然（即，将 64 位特定 ( `/platform:x64`) DLL加载到32 位）。如果您`platform`是非特定的 ( `/platform:AnyCpu`)，则不会出现这种情况（假设没有引用的依赖项是错误的位数）。

换句话说，运行：

> %windir%\Microsoft.NET\Framework\v2.0.50727\installutil.exe

或者：

> %windir%\Microsoft.NET\Framework **64** \v2.0.50727\installutil.exe

将不起作用（替换为其他框架版本：（`v1.1.4322`仅限 32 位，因此不会出现此问题）并且`v4.0.30319`如上文所述）。

显然，正如另一个答案中所涵盖的那样，您还需要`installutil`您正在运行的 .NET 版本号 >=（最好是 =）您正在运行安装程序的 EXE/DLL 文件的版本号。

最后，请注意，[在 Visual Studio 2010 中，该工具将默认生成 x86 二进制文件](http://blogs.msdn.com/rmbyers/archive/2009/06/8/anycpu-exes-are-usually-more-trouble-then-they-re-worth.aspx)（[而不是之前的*任何 CPU*](https://connect.microsoft.com/VisualStudio/feedback/details/455333/platform-target-is-defaulting-to-x86-rather-than-any-cpu)）。

[System.BadImageFormatException 的完整细节](http://msdn.microsoft.com/en-us/library/system.badimageformatexception.aspx)（说唯一的原因是不匹配的咬痕真的是过于简单化了！）。

**x64**安装程序`BadImageFormatException`下的另一个原因是，[在 Visual Studio 2010 中，默认](http://msdn.microsoft.com/en-us/library/kz0ke5xt.aspx)[安装项目类型会生成 32 位](http://msdn.microsoft.com/en-us/library/kz0ke5xt.aspx)[shim，](http://msdn.microsoft.com/en-us/library/kz0ke5xt.aspx)[**即使在 x64 系统上也是如此**](http://msdn.microsoft.com/en-us/library/kz0ke5xt.aspx)（搜索“64 位托管自定义操作引发 System.BadImageFormatException 异常”这页纸）。**[`.vdproj``InstallUtilLib`](http://msdn.microsoft.com/en-us/library/kz0ke5xt.aspx)**

 ***** * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-27T07:39:28.113

确保最新的框架（您编译应用程序时使用的框架）位于 PATH 的第一位。这为我解决了问题。（[在论坛上](https://web.archive.org/web/20100527204545/http://www.issociate.de/board/post/280574/Installutil_System.BadImageFormatException.html)找到）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2019-05-15T19:51:10.883

关键是在两个地方为项目设置匹配处理器设置。

[![在此处输入图像描述](https://i.stack.imgur.com/4Jk8k.png)](https://i.stack.imgur.com/4Jk8k.png)

并确保架构设置在测试菜单>>测试设置>>默认处理器架构>>中相同，如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/z5v3C.png)](https://i.stack.imgur.com/z5v3C.png)

这适用于 VS2013，但也可能适用于其他版本。

更新 - 对于 VS2019：

[![在此处输入图像描述](https://i.stack.imgur.com/ZYf5f.png)](https://i.stack.imgur.com/ZYf5f.png)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-07-05T07:35:55.120

我认为您正在使用该工具的 64 位版本来安装 32 位应用程序。我今天也遇到了这个问题，并使用此框架路径来满足 .

C:\Windows\Microsoft.NET\Framework\v4.0.30319

它应该可以很好地安装您的 32 位应用程序。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-01-23T08:43:57.510

好的，这就是我遇到的问题，而且，修复它的方法似乎与上述内容非常相关。

我正在使用 Visual Studio 2010 Express。我写了一个测试服务，它并没有真正做任何事情。这只是后来的真实事物的练习。

我编写了该服务并尝试使用它安装它`installutil.exe`并收到以下错误：

> System.BadImageFormatException：无法加载文件或程序集“{filename.exe}”或其依赖项之一。试图加载格式不正确的程序。

到目前为止与原作者相同。

[Ruben](https://stackoverflow.com/a/2160932/447356)对 Visual Studio 2010 的 32 位输出的上述观察是这里的救星。

我使用了 64 位版本，`installutil.exe`果然，Visual Studio 2010 构建的输出是 32 位的。`installutil.exe`在这里添加一点额外的价值，您可以在*C:\Windows\Microsoft.NET\framework*文件夹中找到最新的 .NET 框架的 32 位版本和相关联的。使用这个版本`installutil.exe`解决了我的问题；该服务安装顺利！

我希望这对其他人有帮助。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-12-31T08:21:48.963

我在使用 VS 2015 的 WinForms 项目中遇到了这个问题。我的解决方案是：

1.  右键单击项目
2.  选择属性
3.  勾选“首选 32 位”
4.  平台目标：任何 CPU

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-08-15T06:49:38.553

在尝试了所有提到的解决方案后，我发现在我的项目 .csproj 中`PlatformTarget`以某种方式添加到配置中。`AnyCPU`

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <PlatformTarget>x64</PlatformTarget>
</PropertyGroup> 
```

删除线路对我有用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-12-28T18:14:05.627

就我而言，我使用了如下所示的 Framework64

```
cd\
cd "C:\Windows\Microsoft.NET\Framework64\v4.0.30319"
installutil.exe "C:\XXX\Bin\ABC.exe"
pause 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-03-13T09:12:02.647

我今天遇到了这个问题。就我而言，我的应用程序*（引用了 64 位 dll）*平台目标设置为，`AnyCPU`但平台目标部分下的`Prefer 32-bit` *复选框*默认勾选。这就是问题所在，在取消选中`Prefer 32-bit`选项后一切正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-27T11:57:08.663

我遇到过同样的问题。我使用标准命令执行。它正在调用 X64 ro 针对 X86 测试运行。我需要指定 nunit-runner 的 X86 而不是 X64 版本。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-06T00:27:20.307

总而言之，必须将 Build 和 Project\Build\Platform 都设置为 x64 才能在 64 位系统上成功安装 64 位服务。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-03-20T20:07:46.733

我的问题不同。这发生在我的 Windows 7 机器意外关闭之后。我执行了一个干净的解决方案，它按预期运行。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-12-28T22:08:29.870

如果在**实时测试**中出现此消息，但**在单元测试**中没有，这是因为选定的程序集被动态复制到`$(SolutionDir)\.vs\$(SolutionName)\lut\0\0\x64\Debug\`. 但有时*无法选择*少数程序集，例如，在互操作 c++/c# 项目的情况下，VC++ dll。

构建后`xcopy`不会纠正问题，因为复制的文件将被实时测试引擎删除。

迄今为止（2018 年 12 月 28 日）唯一的解决方法是避免实时测试，并在单元测试中使用`[TestCategory("SkipWhenLiveUnitTesting")]`应用于测试类或测试方法的属性来执行所有操作。

此错误出现在任何 Visual Studio 2017 至 15.9.4 中，需要由 Visual Studio 团队解决。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-01-18T19:50:28.363

目标构建 x64 目标服务器托管 IIS 64 位

右键单击运行网站/Web 应用程序的 appPool 托管并设置启用 32 位应用程序 = false。

[![在此处输入图像描述](https://i.stack.imgur.com/CTs3s.png)](https://i.stack.imgur.com/CTs3s.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-05-10T16:13:29.520

对于具有相同症状的问题，我们找到了不同的解决方案：

当我们将项目从 .net 4.7.1 更新到 4.7.2 时，我们看到了这个错误。

问题是，即使我们在项目中不再引用 System.Net.Http，它也列在 web.config 的dependentAssembily 部分中。从 web.config 中删除这个和任何其他未使用的程序集引用解决了这个问题。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-12-05T21:46:37.997

问题是，每一个`System.BadImageFormatException: Could not load file or assembly`包括那些根本不相关`installutil.exe`的都指向这个线程。

1.  如果您的问题与 dll 相关`WindowsBase`并且`PresentationFramework` 您安装了分析器，请确保为您的解决方案中的所有项目安装它们，或者不为它们安装。

    [![在此处输入图像描述](https://i.stack.imgur.com/QtbE2.png)](https://i.stack.imgur.com/QtbE2.png)

2.  在您的库文件中引用整个框架，`.csproj`而不仅仅是两个`dlls`：

    ```
    <Project Sdk="Microsoft.NET.Sdk.WindowsDesktop">

      <PropertyGroup>
        <OutputType>Library</OutputType>
        <TargetFramework>netcoreapp3.0</TargetFramework>
        <RazorLangVersion>3.0</RazorLangVersion>
        <UseWpf>True</UseWpf>
      </PropertyGroup> 
    ```

3.  删除`bin`和`obj`目录，清理解决方案并重建。

# bash - 如何在 unix 系统中关闭另一个进程的文件描述符

> ID：323146
> 
> 赞同：32
> 
> 时间：2008-11-27T07:41:55.313
> 
> 标签：bash, unix, file, file-descriptor, lsof

您可以使用命令**lsof**获取所有正在运行的进程的文件描述符，但我想做的是关闭其中一些描述符而不进入该进程。这可以在 Windows 上完成，因此您可以轻松解锁某些应用程序。

有什么命令或功能吗？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-11-27T08:03:39.840

我不知道你为什么要这样做，但你应该能够使用 gdb 附加到进程，然后在 fd 上调用 close()。例子：

在一个外壳中：猫

在另一个外壳中：

```
$pidof cat
7213

$gdb -p 7213

...
lots of output
...

(gdb) 
```

现在你告诉 gdb 执行 close(0)：

```
(gdb) p close(0)

$1 = 0

(gdb) c

Continuing.

Program exited with code 01.
(gdb) 
```

在第一个 shell 中，我得到以下输出：

```
cat: -: Bad file descriptor

cat: closing standard input: Bad file descriptor 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T07:51:15.793

我不这么认为，但是 lsof 会为您提供打开文件的进程的 PID，因此您可以做的是完全终止该进程或至少发送一个信号让它退出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T07:48:07.003

在 Windows 中，您可以使用程序来执行此操作，因为有人编写了一个程序，该程序将设备驱动程序插入正在运行的内核中来执行此操作。顺便说一句，这样做可能很危险，因为在您关闭一个损坏的应用程序正在使用的句柄后，应用程序不知道该句柄已关闭，并且当应用程序打开其他一些不相关的对象时它不知道同一个句柄现在可能引用其他一些不相关的对象。您真的想尽快杀死损坏的应用程序。

在 Linux 中，您当然可以使用相同的技术。编写一个程序，将模块插入到正在运行的内核中。与模块通信并告诉它关闭哪个句柄。这样做同样危险。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-27T07:50:27.683

我对此表示怀疑。文件描述符是进程本地的，`stdout`对所有进程都是 1，但它们当然仍然引用唯一的流。

关于您要解决的阻塞问题，也许更多细节会很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-29T18:09:21.900

在 Unix 上比在 Windows 上做这件事的需要少得多。

在 Windows 上，大多数程序倾向于“锁定”（实际上是拒绝共享）它们打开的文件，因此它们不能被其他程序读取/写入/删除。

在 Unix 上，大多数情况下不会发生这种情况。Unix 上的文件锁定主要是建议性的，只会阻止其他锁定尝试，而不是正常的读/写/删除操作。您甚至可以删除进程的当前目录。

关于在 Unix 中正常使用中出现的唯一情况是尝试卸载文件系统时（对已安装文件系统的任何引用都可能阻止卸载）。

# apache-flex - Flex：数据库驱动的 DataGrid：箭头消失

> ID：323147
> 
> 赞同：1
> 
> 时间：2008-11-27T07:43:17.620
> 
> 标签：apache-flex, actionscript-3, flex-datagrid

在 Flex 中，我使用以下代码来允许在 DataGrid 中进行排序（数据在服务器端进行分页和排序）。

```
        私有函数 headerReleaseHandler(event:DataGridEvent):void
        {
            var column:DataGridColumn = DataGridColumn(event.currentTarget.columns[event.columnIndex]);

            如果（this.count>0）
            {
                如果（this.query.SortField == column.dataField）
                {
                    this.query.SortAscending = !this.query.SortAscending;
                }
                别的
                {
                    this.query.SortField = column.dataField;
                    this.query.SortAscending = true;
                }
                this.fill();
            }

            event.preventDefault();
        }

```

这非常有效，只是没有显示指示排序的箭头。我怎样才能做到这一点？

谢谢！/尼尔斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-23T00:23:04.203

如果这是您要查找的内容，这里有一个示例：http: [//blog.flexexamples.com/2008/02/28/displaying-the-sort-arrow-in-a-flex-datagrid-control-without-不得不点击列/](http://blog.flexexamples.com/2008/02/28/displaying-the-sort-arrow-in-a-flex-datagrid-control-without-having-to-click-a-column/)

看起来您需要刷新数据提供者使用的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-11T14:58:01.940

我遇到了同样的问题，我发现的唯一解决方案是覆盖 DataGrid 并创建一个自定义的。这是课程：

```
public class DataGridCustomSort extends DataGrid
{

    public function DataGridCustomSort()
    {
        super();

        addEventListener(DataGridEvent.HEADER_RELEASE,
            headerReleaseHandlerCustomSort,
            false, EventPriority.DEFAULT_HANDLER);
    }       

    public function headerReleaseHandlerCustomSort(event:DataGridEvent):void {
        mx_internal::sortIndex = event.columnIndex;
        if (mx_internal::sortDirection == null || mx_internal::sortDirection == "DESC")
            mx_internal::sortDirection = "ASC";
        else
            mx_internal::sortDirection = "DESC";
        placeSortArrow();
    }

} 
```

当您获得 HEADER_RELEASE 事件并设置列索引和方向信息时，您必须专门调用 placeSortArrow() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:53:51.687

在上面的代码中，“this”指的是数据网格，因为我对 this.query.SortField 感到困惑，我假设“this”和“query”是您自己的自定义对象。为什么要检查计数。那算什么。

问候-莫汉

# url - 即将推出的页面的 URL 重定向？

> ID：323148
> 
> 赞同：3
> 
> 时间：2008-11-27T07:43:26.980
> 
> 标签：url, redirect

我有一个超过 100 页的网站。我们需要上线即将推出的产品，但是，许多网站页面在发布时不会准备好。

为了继续前进，我想引用一个“即将推出”页面，其中包含指向当前可用页面的链接。

有没有一种简单的方法可以将 URL 转发到即将推出的页面？这是有效的，还是有更好的方法？

在以下位置找到： [http ://www.web-source.net/html_redirect.htm](http://www.web-source.net/html_redirect.htm)

“将以下 HTML 重定向代码放在 HTML 代码的 和 标记之间。

```
 meta HTTP-EQUIV="REFRESH" content="0; url=http://www.yourdomain.com/index.html" 
```

如果搜索引擎爬过您的网站，这会对您产生负面影响吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T07:57:37.780

您列出的代码将起作用。但是，我永远不会这样做：

1.  您可以只显示您想立即显示的页面，而无需重定向。这对访问者来说会更快，因为他们不需要加载两个页面。
2.  如果您必须使用重定向，为什么不以编程方式创建它，例如通过指示您的 Web 服务器（例如 Apache）重定向某些页面？
3.  我不会链接到尚不存在的页面。大多数访问者会不喜欢这样 - 单击某些内容以找出“稍后再回来”是令人失望的。我们都看到了那些即将推出的页面，内容从未到达，或者仅在数月甚至数年后才到达。要么省略这些链接（或者可能在没有链接的情况下放置一个“正在进行中的标志”），或者仅在完成后添加项目。

搜索引擎应该可以很好地处理重定向页面，尽管您的“即将推出”页面不太可能出现在排名前列的任何位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T07:54:14.073

也许更好或更“正确的方法”是在标头级别进行重定向。使用 PHP，你会调用

```
<?php
header("Location: http://www.yourdomain.com/index.html"); 
```

`.htaccess`在 Apache（假设您正在使用它）和-files中也有方法可以做到这一点。有关详细信息，请参阅[http://www.webweaver.nu/html-tips/web-redirection.shtml 。](http://www.webweaver.nu/html-tips/web-redirection.shtml)

# java - 使用 javax.naming.spi.DirObjectFactory 从 LDAP 中查找对象

> ID：323161
> 
> 赞同：1
> 
> 时间：2008-11-27T07:50:53.143
> 
> 标签：java, jndi

我已经实现了一个对象工厂来查找 LDAP 对象，但是提供的上下文不会从 LDAP 返回 DN（通过 nameCtx.getNameInNamespace()）。我在某种程度上做错了吗？

```
public class LdapPersonFactory implements DirObjectFactory {
        @Override
        public Object getObjectInstance(Object obj, Name name, Context nameCtx,
                Hashtable<?, ?> environment, Attributes attrs) throws Exception {
            if (attrs == null)
                return null;
            Attribute oc = attrs.get("objectclass");
            if (oc != null && oc.contains("inetOrgPerson")) {
                String surname = (String) attrs.get("sn").get();
                String givenName = (String) attrs.get("givenname").get();
                String dn = nameCtx.getNameInNamespace();
                return new LdapPerson(dn, givenName, surname);
            }
            return null;
        }
    } 
```

nameCtx.getNameInNamespace() 只返回一个空字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T11:00:08.440

```
String dn = (String) attrs.get("dn").get(); 
```

这只会抛出一个`NamingException`。
我不认为专有名称 (DN) 是 LDAP 对象的属性，它更像是 LDAP 世界中的身份密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T08:06:55.560

也许？

```
String dn = (String) attrs.get("dn").get(); 
```

它应该像其他任何属性一样吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-14T15:54:44.230

可能是您的上下文指向“根节点”或者它被称为什么。也就是说，具有顶级命名空间作为其子节点的节点。

我想也可能是在您调用 getNameInNamespace 时上下文未绑定，尽管我希望这会引发异常。

我使用 spring-ldap 来处理这类东西，并且在其 DirContextAdapter 和 LdapTemplate 类中没有遇到类似的错误。但话又说回来，我总是将它们绑定到特定的命名空间。

# ajax - SharePoint Webparts 和 Ajax

> ID：323163
> 
> 赞同：1
> 
> 时间：2008-11-27T07:52:13.577
> 
> 标签：ajax, sharepoint, web-parts

拜托，我是 webparts 新手，我需要帮助！！

我有一个我创建的自定义 Web 部件。我使用运行良好的 UpdatePanel 添加了 MS Ajax。我将所有控件添加到 CreateChildControls 方法。一旦我添加了 UpdateProgress 控件，我的分页符就会出现以下错误：

在 PreRender 之前不能注册脚本控件

我没有像其他帖子所建议的那样使用 OnPreRender 事件。请，如果有人能给我建议，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T10:29:49.953

我之前遇到过类似的问题，尝试在你的 on init 方法覆盖中调用 EnsureChildControls 方法。它应该由系统自动调用，但sharepoint喜欢时不时忘记它。

像这样：

```
 protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);
        EnsureChildControls();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T18:15:51.353

You might have forgotten to call the base method of an overrided event, which is not necessarily the OnPreRender event.

Check if the OnInit or OnLoad events are calling their base.On[...] method, e.g.:

```
protected override void OnLoad(EventArgs eventArgs)
{
    base.OnLoad(eventArgs);

    // your code...
} 
```

# wpf - 保存 WPF 装饰器

> ID：323178
> 
> 赞同：3
> 
> 时间：2008-11-27T08:01:28.567
> 
> 标签：wpf, adorner

我对 WPF 比较陌生，我对 Adorners 有疑问。

我有一个包含图像的inkcanvas，我可以使用用户添加的笔画保存图像。我遇到的问题是我有一个要求，允许用户在图像上添加文本，并在不损坏图像的情况下打印/保存文本。

我使用装饰器将文本放在墨水画布上，它在屏幕上看起来不错，但我不知道保存文本或打印带有文本的图像。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T15:20:09.060

Josh Smith 为 Image Annotations 提供了两篇很棒的文章。我认为这是您一直在寻找的东西：

CodeProject：[在 WPF 中注释图像](http://www.codeproject.com/KB/WPF/AnnotatingAnImageInWPF.aspx)

Josh Smith 博客：[在 Viewbox 中注释图像](http://joshsmithonwpf.wordpress.com/2007/08/26/annotating-an-image-in-a-viewbox/)

[本文](http://blogs.msdn.com/mehlhorn/archive/2006/03/11/549132.aspx)将简要概述 WPF 中的 Annotation Framework 以及持久化注解的方式。

希望有帮助。

# cruisecontrol.net - CruiseControl.Net 从控制台切换到服务

> ID：323179
> 
> 赞同：3
> 
> 时间：2008-11-27T08:02:44.617
> 
> 标签：cruisecontrol.net

我已经建立了一个 Cruisecontrol.net 构建服务器。在控制台模式下运行它可以正常工作，但是当尝试将它作为 Windows 服务运行时它不起作用。日志文件显示以下消息：

```
ThoughtWorks.CruiseControl.Core.CruiseControlException: 
Source control operation failed: No VSS database (srcsafe.ini) found.  
Use the SSDIR environment variable or run netsetup. 
```

ssdir 是在 ccnet.config 中设置的，那么我在这里缺少什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-27T08:51:44.270

不确定它是否适用，但是当我在控制台版本和服务版本之间切换时遇到问题时，我开始服务的用户的访问权限就下降了。

也许服务没有访问 srcsafe.ini 文件的权限，而您的帐户则有（假设您使用它来运行控制台）。

抱歉，如果我离题了，只是想提供帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-15T01:42:53.880

我在工作中设置 CI 环境时遇到了类似的问题。如果您可以获得您正在使用的服务帐户的登录权限，您可以使用该帐户登录并通过控制台运行 CC.NET 并调试您的问题。

# c - IRC Bot：错误 - 注册超时

> ID：323189
> 
> 赞同：6
> 
> 时间：2008-11-27T08:07:34.640
> 
> 标签：c, sockets, irc

我正在用 C 语言制作一个简单的 IRC 机器人。我终于让机器人连接并接收信息。我的代码也应该发送，但服务器的行为就像它没有发送任何东西一样。当机器人连接时，我收到：

> 已收到：：roc.esper.net 通知身份验证：*** 正在查找您的主机名...
> 
> 已收到：：roc.esper.net 通知身份验证：*** 找到您的主机名

在这一点上我的代码发送这个：

发送：NICK Goo

发送：USER Goo * * :Goo

我通过使用 wireshark 确定这是您应该在初始连接后发送的注册。但是，我不确定数据是否实际发送，或者它可能以某种方式无效？因为大约 30 秒后我也收到了这个：

> 收到：错误：关闭链接：c-68-33-143-182.hsd1.md.comcast.net（注册超时）

然后我的程序关闭。

有没有其他人知道有关 irc 中的程序化身份验证/注册过程的任何信息？或者其他人有什么有用的想法吗？

谢谢

** 编辑 ** 已修复。我需要在每行的末尾发送行终止符。\r\n

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T08:49:20.733

roc.esper.net 的 Telnet：

```
~$ telnet roc.esper.net 6667
Trying 198.247.173.216...
Connected to roc.esper.net.
Escape character is '^]'.
:roc.esper.net NOTICE AUTH :*** Looking up your hostname...
:roc.esper.net NOTICE AUTH :*** Found your hostname
NICK Goo
USER Goo * * :Goo
PING :268966433
PONG :268966433 
```

NICK、USER 和 PONG 是我派来的。之后，欢迎信息如下：

```
:roc.esper.net 001 Goo :Welcome to the EsperNet Internet Relay Chat Network Goo
:roc.esper.net 002 Goo :Your host is roc.esper.net[198.247.173.216/6667], running version esphyb-1.0.1 
```

等等...

因此，再次检查 PING-PONG 以及您的消息是否正确发送（尤其是 CR/LF 或末尾的 '\n'）。

顺便说一句，如果我不发送任何消息，即使 PONG 丢失，我也会得到“注册超时”，但是一旦我回答了 PING，就不再有超时（至少在 30 秒后不会）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T08:29:05.967

尝试在 NICK 命令之前发送 USER 命令。您要连接到哪个 IRC 网络？

```
"
> telnet irc.freenode.net 6667
NOTICE AUTH :*** Looking up your hostname...
NOTICE AUTH :*** Checking ident
NOTICE AUTH :*** No identd (auth) response
NOTICE AUTH :*** Couldn't look up your hostname
USER x x x x
NICK hwjrh
:kubrick.freenode.net 001 hwjrh :Welcome to the freenode IRC Network hwjrh
:kubrick.freenode.net 002 hwjrh :Your host is kubrick.freenode.net[kubrick.freenode.net/6667], running version hyperion-1.0.2b
" 
```

为我工作；我一直在远程登录到 Freenode、Undernet 和 Dalnet...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T08:17:15.570

从我看过的教程（比如[这个](http://www.haskell.org/haskellwiki/Roll_your_own_IRC_bot)）来看，你似乎做对了，除了这个

```
USER Goo * * :Goo 
```

是

```
USER Goo 0 * :Goo 
```

在我看到的所有教程中。另外，以后不要忘记 PING-PONG，但这不应该用于注册（编辑：这似乎是错误的，在您发送 NICK 后立即需要 PONG）。

我猜你知道[RFC 1459](http://www.mirc.com/help/rfc1459.txt)，它也会对你有很大帮助。

# sql-server - 加速数据库更新

> ID：323193
> 
> 赞同：2
> 
> 时间：2008-11-27T08:11:26.253
> 
> 标签：sql-server, migration

有一个 SqlServer2000 数据库我们必须在周末更新。

它的大小几乎是10G。

更新范围从模式更改、主键更新到更新、更正或插入的几​​百万条记录。

周末对这份工作来说是不够的。

我们为这项工作设置了一个专用服务器，将数据库 SINGLE_USER 进行了我们能想到的任何优化：删除/重新创建索引、关系等。

你能提出任何加速这个过程的建议吗？

SQL SERVER 2000 是不可否认的（不是我的决定）。更新是通过定制程序而不是 BULK INSERT 运行的。

编辑：

模式更新由查询分析器 TSQL 脚本完成（每个版本更新一个脚本）

数据更新由 C# .net 3.5 应用程序完成。

数据来自一堆文本文件（有很多问题）并写入本地数据库。

计算机未连接到任何网络。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T08:23:02.080

尽管删除多余的索引可能会有所帮助，但您需要确保保留这些索引，以便升级脚本能够轻松找到需要更新的行。

否则，请确保您在服务器中有足够的内存（尽管 SQL Server 2000 Standard 限制为 2 GB），并且如果需要预先增长 MDF 和 LDF 文件以应对任何增长。

如果可能，您的自定义程序应该将更新作为集合而不是逐行处理。

编辑：理想情况下，尝试确定导致性能不佳的操作。如果是架构更改，可能是因为您使列变大并导致发生大量页面拆分。但是，出于同样的原因，在插入和更新时也会发生页面拆分 - 该行不再适合页面。

如果您的 C# 应用程序是瓶颈，您是否可以先将更改运行到临时表中（在您的维护窗口之前），然后对实际表执行一次更新？100 万行的单次更新将比应用程序进行 100 万次更新调用更有效。诚然，如果您需要在本周末进行此操作，您可能没有太多时间进行设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T08:18:03.540

这个“定制程序”到底是什么样的？即它是如何与数据对话的？最小化网络 IO 量（从数据库服务器到应用程序）将是一个好的开始......通常这可能意味着在 TSQL 中做很多工作，但即使只是在数据库服务器上运行应用程序也可能会有所帮助。 ..

如果应用程序正在重写大块数据，它可能仍然能够使用批量插入来提交新的表数据。通过命令行（bcp 等）或通过代码（`SqlBulkCopy`在 .NET 中）。这通常比单个插入等更快。

但这真的取决于这个“定制程序”。

# asp.net-mvc - linq、mvc 和部分类

> ID：323194
> 
> 赞同：0
> 
> 时间：2008-11-27T08:13:02.490
> 
> 标签：asp.net-mvc, linq

我有单表**用户的****dbml**

 **我想为 User 添加部分类并添加另一个属性，如下所示：

```
 public partial class User
    {
        public string FullName
        {
            get
            {
                return FirstName + " " + LastName;
            }
        }
    } 
```

然后在我的视图中使用类似：

```
<%=ViewData.Model.FullName %> 
```

我得到了什么：

```
CS1061: 'PR.Web.Models.User' does not contain a definition for 'FullName' and no extension method 'FullName' accepting a first argument of type 'PR.Web.Models.User' could be found (are you missing a using directive or an assembly reference?) 
```

我做错了什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-27T08:24:52.543

仔细检查生成的 LINQ to SQL 类 ( `User`) 和部分类的命名空间。

您可能确定它“完全正确”，但编译器会告诉您不然。如有必要，发布嵌套在您的 .dbml 文件下的 .designer.cs 文件的相关部分，以及包含`User`您在上面发布的类的文件的完整源代码。

# ssl - HTTPS 查询字符串是否安全？

> ID：323200
> 
> 赞同：403
> 
> 时间：2008-11-27T08:18:50.980
> 
> 标签：ssl, https, query-string

我正在创建一个使用 HTTPS 的基于 Web 的安全 API；但是，如果我允许用​​户使用查询字符串来配置它（包括发送密码），这也是安全的还是我应该强制它通过 POST 完成？

* * *

## 回答 #1

> 赞同：507
> 
> 时间：2008-11-27T09:11:34.057

是的。但是出于以下几个原因**，对敏感数据使用 GET 是一个坏主意：**

*   主要是 HTTP referrer 泄漏（目标页面中的外部图像可能会泄漏密码 [1]）
*   密码将存储在服务器日志中（这显然很糟糕）
*   浏览器中的历史缓存

因此，即使查询字符串是安全的，也不建议通过查询字符串传输敏感数据。

*[1] 虽然我需要注意 RFC 声明浏览器不应将引用者从 HTTPS 发送到 HTTP。但这并不意味着糟糕的第 3 方浏览器工具栏或来自 HTTPS 站点的外部图像/闪存不会泄露它。*

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2008-11-27T08:29:42.923

从“嗅探网络数据包”的角度来看，GET 请求是安全的，因为浏览器将首先建立安全连接，然后发送包含 GET 参数的请求。但是 GET url 将存储在用户浏览器历史记录/自动完成中，这不是存储例如密码数据的好地方。当然，这仅适用于可能从浏览器访问服务的更广泛的“Webservice”定义，如果您仅从您的自定义应用程序访问它，这应该不是问题。

因此，至少应该首选将 post 用于密码对话框。同样正如链接 littlegeek 所指出的那样，GET URL 更有可能被写入您的服务器日志。

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2016-03-28T06:52:42.963

> **是**的，您的查询字符串将被加密。

背后的原因是查询字符串是 HTTP 协议的一部分，它是一个应用层协议，而安全性（SSL/TLS）部分来自传输层。首先建立 SSL 连接，然后将查询参数（属于 HTTP 协议）发送到服务器。

建立 SSL 连接时，您的客户端将按顺序执行以下步骤。假设您尝试登录名为*example.com*的站点并希望使用查询参数发送您的凭据。您的完整 URL 可能如下所示：

```
https://example.com/login?username=alice&password=12345) 
```

1.  您的客户端（例如，浏览器/移动应用程序）将首先使用 DNS 请求将您的域名解析`example.com`为 IP 地址。`(124.21.12.31)`查询该信息时，仅使用域特定信息，即仅`example.com`将使用。
2.  现在，您的客户端将尝试使用 IP 地址连接到服务器，`124.21.12.31`并将尝试连接到端口 443（SSL 服务端口不是默认的 HTTP 端口 80）。
3.  现在，服务器`example.com`将其证书发送给您的客户端。
4.  您的客户端将验证证书并开始为您的会话交换共享密钥。
5.  成功建立安全连接后，您的查询参数才会通过安全连接发送。

因此，您不会暴露敏感数据。但是，使用此方法通过 HTTPS 会话发送您的凭据并不是最好的方法。你应该采取不同的方法。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-11-27T08:24:36.647

是的。HTTPS 会话的整个文本由 SSL 保护。这包括查询和标题。在这方面，POST 和 GET 将完全相同。

至于您的方法的安全性，如果没有适当的检查，就没有真正的说法。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-11-27T08:45:19.603

SSL 首先连接到主机，因此主机名和端口号以明文形式传输。当主机响应并且挑战成功时，客户端将使用实际 URL（即第三个斜线之后的任何内容）加密 HTTP 请求并将其发送到服务器。

有几种方法可以破坏这种安全性。

可以将代理配置为充当“中间人”。基本上，浏览器将连接到真实服务器的请求发送到代理。如果以这种方式配置代理，它将通过 SSL 连接到真实服务器，但浏览器仍将与代理通信。因此，如果攻击者可以访问代理，他可以以明文形式查看流经它的所有数据。

您的请求也将在浏览器历史记录中可见。用户可能会想为该站点添加书签。一些用户安装了书签同步工具，因此密码可能会出现在 deli.ci.us 或其他地方。

最后，可能有人入侵了您的计算机并安装了键盘记录器或屏幕抓取工具（许多特洛伊木马类型的病毒都会这样做）。由于密码直接在屏幕上可见（与密码对话框中的“*”相反），这是另一个安全漏洞。

结论：在安全性方面，始终依靠人迹罕至的道路。有太多你不知道，不会想到的事情，这会伤到你的脖子。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-11-27T11:17:52.540

是的，只要没有人在你的肩膀上看着显示器。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-11-27T09:40:29.163

[我不同意Slough 的响应](https://stackoverflow.com/questions/323200/is-a-https-query-string-secure#323286)中关于*[...] HTTP 引荐来源网址泄露（目标页面中的外部图像可能泄露密码）*的说法。

HTTP 1.1 RFC[明确指出](http://www.w3.org/Protocols/rfc2616/rfc2616-sec15.html#sec15.1.3)：

> 如果引用页面是使用安全协议传输的，则客户端不应在（非安全）HTTP 请求中包含Referer 头字段。

无论如何，服务器日志和浏览器历史是不将敏感数据放入查询字符串的充分理由。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-11-27T08:24:56.227

是的，从您建立 HTTPS 连接的那一刻起，一切都是安全的。作为 POST 的查询字符串 (GET) 通过 SSL 发送。

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2012-11-08T02:00:56.220

您可以将密码作为 MD5 哈希参数发送，并添加一些盐。在服务器端进行比较以进行身份​​验证。

# language-agnostic - 如何设计可扩展的软件（插件架构）？

> ID：323202
> 
> 赞同：78
> 
> 时间：2008-11-27T08:19:51.527
> 
> 标签：language-agnostic, plugins, resources, extensibility

我需要一些资源来讨论如何将您的软件设计为可扩展的，即，以便其他人可以编写附加组件/插件来为其添加功能。

你有什么建议吗？有没有讨论这个主题的书？
我更喜欢简明扼要的东西；一点理论和一堆具体的例子。

我不是针对特定的语言，我希望能够理解核心思想，以便我可以用任何语言实现它。

出于同样的原因，我不喜欢使用别人构建的框架（除非框架不是很高级，即没有隐藏*太多*），目前我只想自学主题并尝试各种方法来实现它。另外，一个框架通常假设用户对主题的了解。

**更新**

我不是在询问 OOP 或允许我的类被继承。我说的是设计一个将部署在系统上的应用程序，这样它就可以在部署后由第三方附加组件进行扩展。

例如，Notepad++ 有一个插件架构，您可以在其中将 .dll 文件放置在 plugins 文件夹中，并为应用程序添加不存在的功能，例如颜色选择、片段插入或许多其他功能（广泛的功能）。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-27T08:24:38.350

如果我们谈论的是 .NET，请尝试在 CodeProject 上[使用 VBScript 编写 .NET 应用程序脚本。](http://www.codeproject.com/KB/system/mScriptable.aspx)那里有很多具体的例子。

以下是实施各种应用程序扩展技术的站点

*   [ClearScript - 使 V8、VBScript 和 JScript 可用于 .NET 应用程序](http://clearscript.codeplex.com)
*   [CS-Script - C# 脚本引擎](http://www.csscript.net/)
*   [使用 C# 的插件架构](http://www.codeproject.com/KB/cs/c__plugin_architecture.aspx)
*   [Opinio 插件架构](http://objectplanet.com/opinio/userguide/index.htm?page=plugin_architecture.html)
*   [Eclipse 插件架构注意事项](http://www.eclipse.org/articles/Article-Plug-in-architecture/plugin_architecture.html)
*   [初学者插件架构框架](http://www.codeguru.com/cpp/misc/misc/plug-insadd-ins/article.php/c3879)
*   [Gecko 插件架构](https://developer.mozilla.org/en/Plugin_Architecture)
*   [Fungimol 插件架构](http://www.fungible.com/fungimol/plugin.html)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-27T08:24:04.403

[OSGI](http://neilbartlett.name/blog/osgibook/)是一个技术框架的一个很好的实际例子，它允许你做你想做的事情。

理论就在[这里](http://www.osgi.org/Main/HomePage)。

（[免费！）书在那里](http://neilbartlett.name/downloads/osgibook_preview_20080922.pdf)。

可扩展性和编写插件的能力必须处理**服务生命周期**

*   现场添加/删除服务/插件
*   管理服务之间的依赖关系
*   管理服务状态（声明、安装、启动、停止……）

[OSGI 有什么用？](http://neilbartlett.name/blog/2008/06/06/what-is-osgi-for/)

> 模块的主要功能之一是作为部署单元……我们可以构建或下载并安装它以扩展应用程序的功能。

你会在[这里找到一个很好的介绍](http://www.osgi.org/blog/2008/08/why-services-are-important.html)，关于***服务***的中心概念（这与你的问题有关，它解释了围绕服务的一些问题，可扩展性的关键组件）。

提炼：

> 如果没有服务可以构建如此多的应用程序，为什么服务如此重要？好吧，服务是将软件组件彼此分离的最知名方式。
> 
> 服务最重要的方面之一是它们极大地减少了类加载问题，因为它们使用对象的实例，而不是类名。由提供者而不是消费者创建的实例。复杂度的降低是相当令人惊讶的
> 
> 服务不仅最大限度地减少了配置，而且还显着减少了共享包的数量。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-13T13:17:31.630

在您的应用程序中实施[SOLID](https://en.wikipedia.org/wiki/SOLID_(object-oriented_design))原则。

***1.单一职责原则：***一个类应该只有单一职责（即软件规范中只有一个潜在的变化应该能够影响类的规范

***2.开闭原则：***软件实体……应该**对扩展开放，对修改关闭**

***3\. Liskov 替换原则：***程序中的对象应该可以用它们的子类型的实例替换而不改变该程序的正确性

***4、接口隔离原则：***很多客户端专用接口优于一个通用接口

***5\. 依赖倒置原则：*** *应该依赖于抽象*。不要依赖结石

堆栈溢出问题：

[单一职责原则示例](https://stackoverflow.com/questions/10620022/example-of-single-responsibility-principle)

[开放/封闭原则是个好主意吗？](https://stackoverflow.com/questions/1416476/is-the-open-closed-principle-a-good-idea)

[什么是里氏替换原则？](https://stackoverflow.com/questions/56860/what-is-the-liskov-substitution-principle)

[接口隔离原则——程序到接口](https://stackoverflow.com/questions/9249832/interface-segregation-principle-program-to-an-interface)

[什么是依赖倒置原则，为什么它很重要？](https://stackoverflow.com/questions/62539/what-is-the-dependency-inversion-principle-and-why-is-it-important)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-27T09:27:33.247

你试图达到两个相互竞争的目标：

1.  你的软件的组件必须暴露**很多**自己，所以它们可以被重用
2.  你的软件的组件必须**很少**暴露自己，所以它们可以被重用

说明：为了鼓励代码重用，您应该能够扩展现有类并调用它们的方法。当方法被声明为“私有”并且类是“最终的”（并且不能扩展）时，这是不可能的。所以为了实现这个目标，一切都应该是公开的和可访问的。没有私有数据或方法。

当您发布软件的第二个版本时，您会发现版本 1 的许多想法是完全错误的。您需要更改许多接口或代码、方法名称、删除方法、破坏 API。如果你这样做，很多人会转身离开。因此，为了能够发展您的软件，组件不得暴露任何非绝对必要的东西——以代码重用为代价。

示例：我想观察 SWT StyledText 中光标（插入符号）的位置。插入符号并不意味着扩展。如果你这样做，你会发现代码包含诸如“这个类在包 org.eclipse.swt 中”之类的检查，并且很多方法是私有的和最终的等等。我不得不从 SWT 中复制大约 28 个类到我的项目中来实现这个功能，因为一切都被锁定了。

SWT 是一个很好的框架，可以很好地使用和扩展。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-27T08:52:05.173

当然还有著名的开放封闭原则 - [http://en.wikipedia.org/wiki/Open/closed_principle](http://en.wikipedia.org/wiki/Open/closed_principle)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-25T21:15:39.117

好吧，这取决于语言。

*   在 C/C++ 中，我很确定有一个 loadlibrary 函数允许您在运行时打开一个库并调用它的导出函数。这通常是在 C/C++ 中完成的。
*   在 .NET 中，有 Reflection，它提供了与 loadlibrary 类似（但更广泛）的功能。还有基于反射构建的完整库，例如托管扩展框架或 Mono.Addins，它们已经为您完成了大部分繁重的工作。
*   在 Java 中，还有反射。还有用于 Eclipse IIRC 之类的 JPF（Java 插件框架）。

根据您使用的语言，我可以推荐一些教程/书籍。我希望这可以帮到你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T04:21:24.077

插件架构因其可扩展性和灵活性而变得非常流行。

对于 c++，Apache httpd 服务器实际上是基于插件的，而是使用了模块的概念。大多数 apache 特性都是作为模块实现的，比如缓存、重写、负载平衡，甚至线程模型。这是我见过的一个非常模块化的软件。

而对于 java，Eclipse 绝对是基于插件的。Eclipse的核心是一个管理bundle的OSGI模块系统，插件的另一个概念。Bundle 可以提供扩展点，我们可以在这些扩展点上轻松构建模块。OSGI 中最复杂的是它的动态特性，这意味着可以在运行时安装或卸载包。没有停止世界综合症了！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-25T21:10:02.590

文章[编写基于插件的应用程序](http://www.developerfusion.com/article/4371/writing-pluginbased-applications/)通过一个非常简单的示例清楚地解释了架构各个部分的职责；提供源代码（VB.Net）。我发现它对理解基本概念很有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-15T23:41:45.673

由于我没有足够的代表点来发表评论，因此我将其发布为答案。SharpDevelop 是用于在 C#/VB.NET/Boo 中开发应用程序的 IDE。它有一个令人印象深刻的架构，允许以多种方式扩展自身——从新的菜单项到对全新语言的开发支持。

它使用一些 XML 配置来充当 IDE 核心和插件实现之间的粘合层。它开箱即用地处理插件的定位、加载和版本控制。部署新插件只需复制新的 xml 配置文件和所需的程序集 (DLL) 并重新启动应用程序即可。您可以在原作者 - Christian Holm、Mike Krüger、Bernhard Spuida 的“剖析 csharp 应用程序”一书中阅读更多关于此应用程序的[信息](http://www.icsharpcode.net/opensource/sd/insidesharpdevelop.aspx)。这本书似乎在那个网站上没有，但我找到了一本可能还在附近的[副本](https://download.damieng.com/documentation/Dissecting_A_CSharp_Application.pdf)

还在[这里找到了一个相关的问题](https://softwareengineering.stackexchange.com/a/92824/115785)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-27T08:41:53.337

结帐“CAB” - Microsoft 的*组合应用程序构建块框架*。我认为他们也有一个“网络版本”......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-27T08:43:26.017

我刚刚开始开发一个智能客户端应用程序。这是我正在考虑的两个选项。

使用 Microsoft 的[System.AddIn](http://msdn.microsoft.com/en-us/library/system.addin.aspx)命名空间。看起来很有希望，但是对于我们的最终解决方案来说可能有点复杂。

或者来自 Microsoft的 Smart Client - [Composite UI Application Block](http://msdn.microsoft.com/en-us/library/aa480450.aspx)

最近，我研究了使用 Composite UI Application Block 和 System.AddIn 命名空间的组件来构建我自己的。由于 CAB 有源代码，因此很容易扩展。我认为我们的最终解决方案将是 CAB 的轻量级版本，肯定会使用[Unity 应用程序块](http://msdn.microsoft.com/en-us/library/dd203104.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-26T13:11:39.703

如果您使用 .Net，我们的研究产生了两种方法：脚本和组合。

**脚本**

您可以通过使用脚本编排类来扩展类的功能。这意味着以动态语言公开以您最喜欢的 .Net 语言编译的内容。

我们发现一些值得探索的选项：

*   [铁蟒](http://ironpython.net/)
*   [铁红宝石](http://www.ironruby.net/)
*   JavaScript：[Jint](http://jint.codeplex.com/)、[Jurassic](http://jurassic.codeplex.com/)和[JavaScript .Net](http://javascriptdotnet.codeplex.com/)是很好的起点。
*   [Script.Net](http://www.protsyk.com/scriptdotnet/wiki/index.php?title=Main_Page) -> 这个是第一个引起我们注意的。

**作品**

如果您使用 .Net 4 或更高版本启动项目，则必须仔细查看 Managed Extensibility Framework (MEF)。它允许您以插件方式扩展应用程序的功能。

> 托管可扩展性框架 (MEF) 是 .NET 的组合层，可提高大型应用程序的灵活性、可维护性和可测试性。MEF 可用于第三方插件扩展，或者它可以为常规应用程序带来松散耦合的插件式架构的好处。

[Managed Add-in Framework](http://msdn.microsoft.com/en-us/library/bb384200%28v=vs.100%29.aspx)也是一本不错的读物。

*   MSDN：http: [//msdn.microsoft.com/en-us/library/dd460648.aspx](http://msdn.microsoft.com/en-us/library/dd460648.aspx)
*   Codeplex： http: [//mef.codeplex.com/](http://mef.codeplex.com/)

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2008-11-27T08:38:34.297

与其重新发明轮子，不如使用现有的框架。Eclipse 和 Netbeans 都支持基于插件的扩展。你必须在 Java 中工作。

# c# - 解决方法 .net 应用程序域仅按值传递对象

> ID：323212
> 
> 赞同：3
> 
> 时间：2008-11-27T08:25:52.637
> 
> 标签：c#, appdomain, marshalbyrefobject

我正在开发一个严重依赖插件的.net 应用程序。应用程序本身包含与远程服务器的连接。

最近我深入研究了应用程序域，并将它们视为将插件代码与应用程序的其余部分隔离的理想解决方案。

然而，有一个很大的缺点使我无法实现用于托管插件的应用程序域。似乎没有办法通过引用另一个应用程序域来传递对象，而另一个应用程序域需要传递对连接对象的引用。

我希望有人能给我一个解决方法，这样我就可以传递对该对象的引用。

注意：创建代理是不可能的，连接层已经充当代理，因为类是自动生成的。

注意 2：不能使用 System.AddIn，因为它在紧凑框架上不可用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T08:30:55.950

您是否尝试[过从 MarshalByRefObject](http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx)派生？这是一个痛苦，它搞砸了你的继承层次结构，但我认为这是你想要的。

从文档：

> MarshalByRefObject 是通过使用代理交换消息来跨应用程序域边界进行通信的对象的基类。不从 MarshalByRefObject 继承的对象是按值隐式编组的。当远程应用程序按值引用编组对象时，该对象的副本将跨应用程序域边界传递。
> 
> MarshalByRefObject 对象在本地应用程序域的边界内直接访问。远程应用程序域中的应用程序第一次访问 MarshalByRefObject 时，会将代理传递给远程应用程序。代理上的后续调用被封送回驻留在本地应用程序域中的对象。
> 
> 当跨应用程序域边界使用类型时，类型必须从 MarshalByRefObject 继承，并且不能复制对象的状态，因为对象的成员在创建它们的应用程序域之外不可用。

以我的经验，它可能是非常有限的——你真的需要尽可能少地跨越 AppDomain 边界，最好将自己限制在只需要原始类型、字符串和两者的数组的操作上。这很可能是由于我自己在使用多个 AppDomain 方面缺乏经验，但这只是一个警告，它有点雷区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T08:31:14.047

要在 AppDomain 之间与同一个实例通信，它必须从[MarshalByRefObject](http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx)继承。通过这种方式，对对象的每个方法调用（包括属性等）实际上都是对另一个应用程序域的远程调用。这有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T08:43:13.990

请注意，`MarshalByRefObject`代理的清理是根据租约清理的。简而言之，如果您在特定时间内不使用该对象，它将被回收。您可以通过重写`InitializeLifetimeService`来控制它以返回符合您需要的租约对象。如果您返回`null`，则有效地禁用了租赁，然后仅在卸载 AppDomain 时才回收该对象。

# graphics - Microsoft.DirectX.Vector3.Normalize() 不一致

> ID：323226
> 
> 赞同：0
> 
> 时间：2008-11-27T08:36:43.753
> 
> 标签：graphics, geometry, directx, direct3d

标准化 Vector3 对象的两种方法；通过调用 Vector3.Normalize() 和另一个从头开始规范化：

```
class Tester {
    static Vector3 NormalizeVector(Vector3 v)
    {
        float l = v.Length();
        return new Vector3(v.X / l, v.Y / l, v.Z / l);
    }

    public static void Main(string[] args)
    {
        Vector3 v = new Vector3(0.0f, 0.0f, 7.0f);
        Vector3 v2 = NormalizeVector(v);
        Debug.WriteLine(v2.ToString());
        v.Normalize();
        Debug.WriteLine(v.ToString());
    }
} 
```

上面的代码产生了这个：

```
X: 0
Y: 0
Z: 1

X: 0
Y: 0
Z: 0.9999999 
```

为什么？

（奖励积分：为什么是我？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T08:54:53.733

看看他们是如何实现它的（例如在 asm 中）。

也许他们想要更快并产生类似的东西：

```
 l = 1 / v.length();
 return new Vector3(v.X * l, v.Y * l, v.Z * l); 
```

用 2 个除法对 3 个乘法进行交易（因为他们认为 mults 比 divs 更快（这对于现代 fpus 来说通常是无效的））。这引入了一个级别的操作，因此精度较低。

这将是经常被引用的“过早优化”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T08:39:11.407

不要在意这个。使用浮点数时总是会出现一些错误。如果您很好奇，请尝试更改为双倍，看看是否仍然会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T08:49:32.823

您在这里有一个关于浮点数的字符串格式的[有趣讨论。](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/862effa2-a956-4df5-a70c-45257b851b70/)

仅供参考：

> 您的数字需要 24 位来表示，这意味着您正在用完一个浮点数的整个尾数（23 位 + 1 个隐含位）。
> Single.ToString() 最终是由一个原生函数实现的，所以我无法确定发生了什么，但我的猜测是它使用最后一位数字来舍入整个尾数。
> 这背后的原因可能是你经常得到不能用二进制精确表示的数字，所以你会得到一个很长的尾数；例如，0.01 在内部表示为 0.00999... 你可以通过以下方式看到：

```
float f = 0.01f;
Console.WriteLine ("{0:G}", f);
Console.WriteLine ("{0:G}", (double) f); 
```

> 通过在第七位四舍五入，您将得到“0.01”，这是您所期望的。
> 
> 正如您已经看到的，对于上面所见，只有 7 位数字的数字不会显示此问题。
> 
> 需要说明的是：仅当您将数字转换为字符串时才会进行舍入：您的计算（如果有）将使用所有可用位。

浮点数的外部精度为 7 位（内部为 9 位），因此如果超过该精度，则舍入（具有潜在的怪癖）是自动的。
如果您将浮点数降低到 7 位（例如，向左 1，向右 6），那么它会起作用并且字符串转换也会起作用。

至于奖励积分：

为什么你 ？因为这段代码“渴望打击你”。
（火神......吹......好吧。最蹩脚的。平底船。曾经）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T08:50:02.417

使用浮点数时您应该预料到这一点，其基本原因是计算机以二进制方式处理，而这并不完全映射到十进制。

对于不同基数之间问题的直观示例，请考虑分数 1/3。它不能用十进制精确表示（它是 0.333333 .....），但可以用三进制表示（如 0.1）。

通常，这些问题在使用双精度时不太明显，但以计算成本为代价（要操作的位数翻倍）。然而，鉴于浮点精度足以让人类登上月球，那么你真的不应该着迷:-)

这些问题有点像计算机理论 101（与编程 101 相反——你显然远远超出了这一点），如果你走向 Direct X 代码，类似的事情会经常出现，我建议这可能是个好主意拿起一本基本的计算机理论书并快速阅读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T09:01:14.233

如果您的代码因微小的浮点舍入错误而损坏，那么恐怕您需要修复它，因为它们只是生活中的事实。

# iphone - 读取 JavaEE 服务器返回的字节流

> ID：323230
> 
> 赞同：1
> 
> 时间：2008-11-27T08:39:33.327
> 
> 标签：iphone, objective-c, cocoa-touch

我们有一个 JavaEE 服务器和向移动客户端提供数据的 servlet（首先是 JavaME，现在很快是 iPhone）。servlet 使用以下代码写出数据：

```
DataOutputStream dos = new DataOutputStream(out);

dos.writeInt(someInt);

dos.writeUTF(someString); 
```

... 等等

此数据作为 HTTP 响应正文中的字节返回给客户端，以减少传输的字节数。

在 iPhone 应用程序中，响应负载被加载到 NSData 对象中。现在，在花费数小时试图弄清楚如何在 Objective-C 应用程序中读取数据之后，我几乎准备放弃，因为我还没有找到任何将数据读入 NSInteger 和 NSString 的好方法（对应上述协议）

任何人都会有任何指示如何从java应用程序编写的二进制协议中读取内容？任何帮助是极大的赞赏！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T22:23:51.323

您必须自己进行解组；幸运的是，它相当简单。Java 的`DataOutputStream`类以大端（网络）格式写入整数。因此，为了对整数进行解组，我们抓取 4 个字节并将它们解压缩为一个 4 字节整数。

对于 UTF-8 字符串，`DataOutputStream`首先写入一个 2 字节值，指示后面的字节数。我们将其读入，然后读取后续字节。然后，要解码字符串，我们可以使用以下`NSString`方法[`initWithBytes:length:encoding:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/initWithBytes:length:encoding:)：

```
NSData *data = ...;  // this comes from the HTTP request
int length = [data length];
const uint8_t *bytes = (const uint8_t *)[data bytes];

if(length < 4)
    ; // oops, handle error

// demarshall the big-endian integer from 4 bytes
uint32_t myInt = (bytes[0] << 24) | (bytes[1] << 16) | (bytes[2] << 8) | (bytes[3]);
// convert from (n)etwork endianness to (h)ost endianness (may be a no-op)
// ntohl is defined in <arpa/inet.h>
myInt = ntohl(myInt);

// advance to next datum
bytes += 4;
length -= 4;

// demarshall the string length
if(length < 2)
    ; // oops, handle error
uint16_t myStringLen = (bytes[0] << 8) | (bytes[1]);
// convert from network to host endianness
myStringLen = ntohs(myStringLen);
bytes += 2;
length -= 2;

// make sure we actually have as much data as we say we have
if(myStringLen > length)
    myStringLen = (uint16_t)length;

// demarshall the string
NSString *myString = [[NSString alloc] initWithBytes:bytes length:myStringLen encoding:NSUTF8StringEncoding];
bytes += myStringLen;
length -= myStringLen; 
```

您可以（并且可能应该）为 demarshall 编写函数，这样您就不必为要 demarshall 的每个字段重复此代码。另外，要**格外小心**缓冲区**溢出**。您正在处理通过网络发送的数据，您应该始终不信任这些数据。 **始终**验证您的数据，并**始终**检查您的缓冲区长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T08:45:56.917

主要是了解二进制数据格式本身。写什么并不重要，只要您知道字节的含义即可。

因此，[DataOutputStream](http://java.sun.com/javase/6/docs/api/java/io/DataOutputStream.html)的文档是您最好的选择。他们详细说明了二进制数据的外观（希望如此）。

接下来，我会尝试在 iPhone 上创建一个类，它将相同的格式读入适当的数据结构。我根本不了解Objective C，但我确信读取4个字节不会太难，知道第一个字节是最重要的（等等）并进行适当的位旋转以获得正确的一种整数。（基本上读取一个字节，将其左移 8 位，读取下一个字节并将其添加到结果中，将全部左移 8 位，等等。）可能有更有效的方法来做这件事，但首先要得到一些有效的方法. 当你对它进行了单元测试时，你就可以开始优化它了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:54:44.000

不要忘记，Objective-C 只是穿着漂亮衣服的 C——而 C 擅长这种卑躬屈膝的方式。在很大程度上，您应该能够定义一个看起来像您的数据的 C 结构并将指向您的数据的指针转换为指向该结构的指针。现在，究竟要使用哪些类型，以及是否需要进行字节交换，将取决于 Java 是如何构造这个流的；这就是您需要花时间阅读 Java 文档的目的。

不过，从根本上说，这是一种设计气味。您遇到此问题是因为您对不再有效的客户端平台做出了假设。如果这是一个选项，我建议您为相同的功能提供第二个更便携的接口（只需添加“WithXML”包装器或其他东西就足够了）。如果您最终移植到另一个不使用 Java 的平台，这将节省您的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T02:28:03.810

Carl，如果您真的无法更改服务器提供的内容，请查看[此类](http://svn.apache.org/repos/asf/incubator/thrift/trunk/lib/cocoa/src/protocol/TBinaryProtocol.m)。它应该是您正在寻找的指针。也就是说：使用原生 java 序列化作为传输格式的想法听起来不是一个好主意。我的第一选择是[JSON](http://json.org/)。如果这仍然太大，我可能宁愿使用[Thrift](http://incubator.apache.org/thrift/)或[Protobuffers](http://code.google.com/apis/protocolbuffers/docs/proto.html)之类的东西。它们还提供二进制序列化 - 但以跨语言方式。（还有老歌 ASN1 - 但这很痛苦）

# .net - 从哪里开始以及如何参与 .NET 社区？

> ID：323235
> 
> 赞同：2
> 
> 时间：2008-11-27T08:43:23.770
> 
> 标签：.net, open-source

我是 .NET 的新手，我想加入 .NET 社区以提高我的技能（自私，我知道），贡献一些东西（不是那么自私），我认为成为社区的一员真是太好了。

我可以开始写博客，但考虑到我是初学者，我不可能发布任何有价值的东西。开源项目怎么样？有参与方式吗？我检查了 codeplex，在 sourceforge 中没有像“Help Wanted”这样的东西，所以我不知道从哪里开始。我在想一些开源项目也可以接受初学者。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T08:53:48.290

仅仅因为您是初学者并不意味着您不能在博客上发布任何有价值的内容。您可以将您的博客作为“我不理解 X，现在我明白了 - 这是一个解释”的笔记本。这将帮助其他初学者学习，*并*可能帮助老手了解哪些领域会给初学者带来问题。

至于为开源项目做贡献 - steveth45 在那里有完全正确的答案。如果您想真正让自己受欢迎，请提出编写高质量的文档——这*总是*有需求的。你可以通过阅读现有代码来提高你的技能，并通过记录它的作用来做出大量贡献。这也将帮助您了解项目可以改进的地方，并贡献代码。

当然，也有“回答问题”的一面——无论是在这里、在新闻组上还是在其他任何地方。你不需要事先知道很多来回答问题——你只需要愿意做一些研究，并且比提出问题的人更聪明（或更坚持）。通过回复新闻组帖子，我几乎学会了 C#——这是一种非常有益的学习方式。

您可以帮助社区的一种不太明显（但重要）的方式是写信给图书出版商，询问他们是否需要任何同行评审员来为当前正在编写的书籍提供同行评审。根据我的经验，大多数同行评审员已经处于“接近专家”的水平，这意味着他们很擅长发现错误，但在判断这本书是否有效教学方面并不出色。让自己成为光谱另一端的人（至少现在 - 不要指望长时间成为初学者！）将为每个人提供很好的服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T08:48:01.763

找到一个有趣且有趣的开源项目。大多数开源项目都接受任何级别的帮助。通常，更大的问题是个人动机，这就是为什么你应该找到一些你认为个人有回报的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T08:48:32.513

查看[CodeProject](http://www.codeproject.com)。这是一个关于 .NET 之前的 Microsoft 技术的社区站点。它现在已经包含 Java 和 LAMP 技术，但主要主题是 .NET。成员发布获得社区评级的文章。我想说这是关于 .NET 的最丰富的信息来源。

如果你想贡献，你可以写一篇文章。这篇文章可能是关于您正在构建的开源项目，例如库或应用程序。它可能比这更简单。您可以描述您为解决难题所遵循的步骤并提供源代码。以这种方式开始贡献会更容易，因为您不需要编写一个完整的开源项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T08:56:33.433

作为[FileHelpers Project](http://www.filehelpers.com)的提交者，我们可以使用我们可以获得的所有帮助！由于我们只有两个人，我们的项目已经停滞了很长时间，而且我们两个人去年的个人生活都非常多事。最简单的帮助仍然有用 - 大部分文档仍然是蹩脚的英语，因为首席开发人员不是母语也不是流利的英语 - 所以即使是帮助改进文档的简单提交也会非常有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T09:43:28.063

你在工作中使用任何开源项目吗？这可以为您提供指导，您可以尝试添加您发现自己想要的功能或重写您发现令人困惑的文档。你也可以简单地按照 Jon 的建议去做，并开始参与这些项目的新闻组或论坛。

# http - 如何禁用 Tomcat 5.5.27 的 HTTP 方法

> ID：323241
> 
> 赞同：0
> 
> 时间：2008-11-27T08:47:34.450
> 
> 标签：http, tomcat, http-method

请让我知道如何禁用 Web 服务器 Apache Coyote HTTP 1.1 连接器 (Tomcat 5.5.27) 的 HTTP 方法，如 OPTIONS、PUT、DELETE

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T09:12:52.400

[Tomcat 6](https://stackoverflow.com/questions/320959/disabling-put-trace-delete-request-in-apache-tomcat-60)也有类似的问题。我相信它也适用于 Tomcat 5.5。也看看这个[线程](http://marc.info/?l=tomcat-user&m=110940068226551&w=2)。

# encryption - 禁用 Tomcat 5.5.27 的弱密码？

> ID：323245
> 
> 赞同：0
> 
> 时间：2008-11-27T08:49:20.560
> 
> 标签：encryption, weak

请让我知道如何禁用 Tomcat 5.5.27 的弱密码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T10:07:04.773

请参阅`ciphers`HTTP 连接器定义中的属性：http: [//tomcat.apache.org/tomcat-5.5-doc/config/http.html](http://tomcat.apache.org/tomcat-5.5-doc/config/http.html)

或者，如果您使用 APR，请参阅`SSLCipherSuite`此处记录的 SSL 连接器配置中记录的指令：http: [//tomcat.apache.org/tomcat-5.5-doc/apr.html](http://tomcat.apache.org/tomcat-5.5-doc/apr.html)。

请注意，OpenSSL 密码套件名称与 j2se 密码套件名称并不完全相同。Java 密码记录在：http: [//java.sun.com/j2se/1.4.2/docs/guide/security/jsse/JSSERefGuide.html#SunJSSE](http://java.sun.com/j2se/1.4.2/docs/guide/security/jsse/JSSERefGuide.html#SunJSSE)。对于 APR，该命令`openssl ciphers`将为您提供系统上所有可用 OpenSSL 密码的列表。

# operating-system - 进程和线程

> ID：323250
> 
> 赞同：-5
> 
> 时间：2008-11-27T08:51:02.320
> 
> 标签：operating-system

1a) MS Word 和 MS PowerPoint 是不同的进程还是单个进程的线程？

b) 拼写检查程序（word 和 PowerPoint 通用）如何使用？我的意思是为主内存中的每个进程复制了 2 次代码，

*   如果它们是不同的过程
*   如果它们是线程。

该问题并非特定于 Windows 操作系统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T22:44:13.963

它们是碰巧在[某些]功能上有重叠的不同过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T02:17:46.013

1a）虽然可能存在一些程序，但通常存在不同的进程，如果您将其视为 O/S 情况下的 O/S，它们可能会尝试在同一进程中运行它们。

1b) 拼写检查器可能只是在现有输入数据上运行，并在字典中找到确认单词以及一些基本语法，从而在这里和那里进行奇怪的更正。请注意，尽管您没有指定您指的是哪个版本的 Office，因为该软件的 Mac 和 PC 版本可能在版本之间具有不同的行为。

在 Windows 机器上，您可以使用任务管理器或进程资源管理器来确认单独的进程。

# basic-authentication - 如何在 Tomcat 5.5.27 上禁用基本身份验证

> ID：323252
> 
> 赞同：1
> 
> 时间：2008-11-27T08:51:08.933
> 
> 标签：basic-authentication

请让我知道如何在 Tomcat 5.5.27 上禁用基本身份验证

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T10:05:36.180

仅当您自己配置身份验证时才存在。默认情况下，Web 应用程序不使用身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-10T14:31:56.543

但是，如果，正如我所怀疑的那样，你没有自己把它放在那里，那么告诉你在哪里看会对你有所帮助。在 Java 中，无论如何，源目录 (WEB_INF/) 中可能有一个 web.xml 文件。

# http - 如何从响应中删除 Web 服务器的默认横幅 - Apache http1.1 coyote

> ID：323260
> 
> 赞同：1
> 
> 时间：2008-11-27T08:53:46.213
> 
> 标签：http, header

请让我知道如何从响应中删除 Web 服务器的默认横幅 - Apache http1.1 coyote

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T10:01:41.943

如果您在谈论 apache 生成页面底部的生成行，则必须使用以下命令更新 httpd.conf：

```
ServerSignature Off 
```

见[http://httpd.apache.org/docs/2.2/mod/core.html#serversignature](http://httpd.apache.org/docs/2.2/mod/core.html#serversignature)

请注意，这些信息也是通过 HTTP 标头发送的。您可以通过此[指令更改它们](http://httpd.apache.org/docs/2.2/mod/core.html#servertokens)

关于 Coyote，AFAIK 没有隐藏这些信息的关键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-04T23:55:47.997

在 server.xml 中会有一个`<Connector>`元素。为其添加一个`server`属性。例如：

```
<Connector executor="tomcatThreadPool"
    port="80" protocol="HTTP/1.1"
    server=" "
    ...
/> 
```

不幸的是，将`server`属性设置为空字符串不会导致行为发生任何变化。设置`server`为带有单个空格的字符串会产生如下标题：

```
Server: 
```

虽然不是最佳的，但它是进步的。

# web-services - 标准 Web 服务 v 安全 Web 服务

> ID：323262
> 
> 赞同：4
> 
> 时间：2008-11-27T08:54:27.680
> 
> 标签：web-services, ws-security

作为项目的一部分，我在期待中提出这个问题。我过去有开发和使用 Web 服务的经验，我对此很熟悉。然而，有人告诉我，作为下一个项目的一部分，我将需要使用“安全”网络服务。您能否提供一些关于实现这些而不是标准的额外开发任务的见解，我敢说它不安全的 Web 服务？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T19:09:30.263

除非您有一个复杂的多跳场景，否则 SSL 比任何基于 WS-Security 或相关规范的东西都更加实用和可互操作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T09:04:32.510

如果您要使用 WCF，请查看[MSDN上的这些指南](http://msdn.microsoft.com/en-us/library/ms735093.aspx)

[可以使用Web 服务增强 (WSE) 3.0](http://msdn.microsoft.com/en-us/library/ms977317.aspx)保护现有的 ASMX Web 服务

# .net - Http 请求 - 绕过 DNS [.Net]

> ID：323264
> 
> 赞同：9
> 
> 时间：2008-11-27T08:54:59.207
> 
> 标签：.net, http, dns

在进行 HTTP 请求时是否有可能（如果是，如何）绕过 DNS？

我想通过 HTTP 请求直接访问前端，而不通过 NLB，但使用正确的主机标头。由于我有我的服务器的 IP，我只需要绕过 DNS。

我尝试使用 WebRequest，将 URL 替换为 IP 并设置 Host 标头，但此标头受到保护。

我怎样才能做到这一点 ？我需要自己创建 HTTP 请求吗？

注意：编辑主机文件不是一个选项

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-27T11:54:35.633

在提出这个问题时，这不可能与 WebRequest 类有关。然而，在此问题引发的 Microsoft Connect 问题之后，Microsoft 将 Host 属性添加到 .Net 4.0 版中的 HttpWebRequest 类中。因此，如果您使用的是 .net 4.0 或更高版本，则可以使用此代码实现您想要的。

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://127.0.0.1");
Request.Host = "www.example.com" 
```

在 .Net 版本 4 之前，唯一真正的选择是打开一个 Socket 并自己执行 HTTP 请求，或者找到一个具有更多功能的第 3 方组件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-11T13:49:41.743

我设法做我需要将代理设置为远程服务器的 IP 地址的事情：

```
request.Proxy = new WebProxy(ip.ToString()); 
```

它并非在所有情况下都有效，但在我的情况下确实有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T13:22:23.953

我自己也有类似的问题，但设法使用套接字解决了它（正如 Martin Brown 所提到的。这是我的答案：[https ://stackoverflow.com/questions/359041/request-web-page-in-c-spoofing -主机#359299](https://stackoverflow.com/questions/359041/request-web-page-in-c-spoofing-the-host#359299 "我的答案")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T17:17:22.080

你可以使用我的解决方案来解决这个问题，它发布在这里：

[如何在 HttpWebRequest 中设置自定义“主机”标头？](https://stackoverflow.com/questions/1450937/how-to-set-custom-host-header-in-httpwebrequest/18572236#18572236)

这可以帮助您编辑主机标头，并避免使用代理解决方法。

# c# - 我可以修改 Request.Form 变量吗？

> ID：323265
> 
> 赞同：13
> 
> 时间：2008-11-27T08:55:30.377
> 
> 标签：c#, request.form

我尝试`Request.Form.Set(k, v)`但它抛出异常

> 集合是只读的

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-27T09:27:54.650

这与修改`Request.Querystring`. 两者在内部都因私有属性而变得复杂，并且可能被视为错误，但是我知道有两种可能的解决方案（我会立即取消 response.redirect 计划 - 这太糟糕了）。

方法一是使用反射直接修改集合：

```
NameValueCollection oQuery = Request.QueryString;
oQuery = (NameValueCollection)Request.GetType().GetField("_queryString",BindingFlags.NonPublic | BindingFlags.Instance).GetValue(Request);
PropertyInfo oReadable = oQuery .GetType().GetProperty("IsReadOnly", BindingFlags.NonPublic | BindingFlags.Instance);
oReadable.SetValue(oQuery, false, null);
oQuery["foo"] = "bar";
oReadable.SetValue(oQuery, true, null); 
```

我认为更适合单元测试的计划 B 是避免直接处理集合，而是将其作为 a 传递`NameValueCollection`给您想要处理它的任何方法，浅拷贝您需要的任何内容。我自己用它来模拟网络请求。

编辑：Marc Gravell 为 B 计划给出了更有说服力的理由

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T09:15:56.327

表单表示客户端在请求中发送的内容。你想做什么？就个人而言，我会尝试将“读取表单”代码与“使用值做某事”代码分开 - 这样，您可以在早期（从表单读取时）进行任何预处理，而不是稍后代码需要知道*实际*发送了什么——它只接受给它的值（即它从不直接与请求对话）。

这也意味着您可以测试您的逻辑，而无需表单，甚至根本不需要 http 请求。

实际上，ASP.NET MVC 会为你做很多这样的事情（上一段）......

请注意，您可以更新 .Items 集合 - 但这有点模糊（即它与表单没有具体关系）。

# php - 如何使用 PHP 生成 PDF 文件？

> ID：323269
> 
> 赞同：2
> 
> 时间：2008-11-27T08:57:04.837
> 
> 标签：php, pdf, pdf-generation, fpdf

我有一些 HTML，包括粗体、斜体、小标签、大标签、块引用标签、项目符号和编号项目。我需要通过 PHP 将其转换为 PDF。我试过 FPDF，但它太复杂了。我尝试了使用 FPDF 的 html2pdf PHP 库，但它非常错误且不可靠。你有什么建议吗？

注意：想象一下你的典型简历。我需要格式化类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T09:53:27.857

看看[FPDF](http://www.fpdf.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T09:02:54.450

我在[dompdf](http://www.digitaljunkies.ca/dompdf/)方面取得了很大的成功。

但请确保您拥有有效的 HTML，否则它可能会陷入循环。使用起来非常简单 - 将 HTML 文件转换为 PDF 大约需要 4 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T09:59:33.460

我对 PrinceXML 有很好的体验。他们的渲染引擎非常好。通过 acid2 并具有良好的 .svg 支持，因此您可以包含矢量图而不是位图以保持 .PDF 相对较小（这在生成需要作为附件发送的报告时很重要）。

（请注意，princexml 是专有软件）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T10:26:03.860

[http://www.ros.co.nz/pdf/](http://www.ros.co.nz/pdf/)

我曾经使用上述方法将极其复杂的建筑师的瓷砖规范动态地转换为 PDF，并且效果很好。我发现该课程非常平易近人且易于修改。

# web-applications - 在 VBscript 中绘制图形

> ID：323271
> 
> 赞同：0
> 
> 时间：2008-11-27T08:58:21.697
> 
> 标签：web-applications, vbscript, bitmap, bmp, hta

我有一个 HTML 应用程序，部分是 HTML，部分是 VBscript，伪装成一个表单。它的作用是打开一些本地文件，运行一个包含 GAWK 的 DOS 框，并显示一个文本文件作为其结果。我希望通过让它创建一个位图图像来扩展它，结果是堆积条形图中的结果，例如作为 .BMP 文件。但我很难过。我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T09:34:20.173

javascript是一种选择吗？这比创建图像文件要容易得多。

我已经使用了这个 jquery 插件[http://code.google.com/p/flot/](http://code.google.com/p/flot/)几次并且效果很好。

我已经有几年没有使用 VBScript 了，认为您可能需要使用某种类型的 active-x 对象来生成图像文件，但我可能错了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T09:36:41.790

图形超出了 VBScript 单独的能力。如果您找到可以为您做的 ActiveX/COM 组件，您可以尝试。看看谷歌，我猜他们中的大多数都是相当昂贵的商业产品的简化试用版。也许这里的其他人知道免费的。

作为替代路线，您可以在某处设置一个使用 URL 参数进行图像处理的 Web 服务（例如 PHP/gdlib）。然后，您只需`<img>`像往常一样使用标签链接到 HTA 中的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T10:11:44.653

我相信你也可以在 VBScript中使用这个库[http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm 。](http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm)可用于绘制各种形状线条、矩形、圆形等

绘制图形后，您可以将页面打印到 PDF 打印机（如 cutePDF），以将图像保存到文件中以备后用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-20T05:04:09.257

Microsoft Scripting Guys 发表了一篇文章，讨论了他很久以前，但它涉及使用 Excel ActiveX 控件或 OWC 控件，该文章非常详细地介绍了如何操作，请看这里： http: [//www.microsoft .com/technet/scriptcenter/topics/activex/chart.mspx](http://www.microsoft.com/technet/scriptcenter/topics/activex/chart.mspx)

# wpf - 如何从 Windows 主题继承/覆盖强制样式？

> ID：323284
> 
> 赞同：1
> 
> 时间：2008-11-27T09:10:45.463
> 
> 标签：wpf, inheritance, themes, styles

目前我强制我的 WPF 应用程序使用 luna 主题无论如何，这个 XAML 代码

```
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Styles.xaml" />
            <ResourceDictionary Source="NavigationCommands.xaml" />
            <ResourceDictionary Source="/RibbonControlsLibrary;component/Themes/Office2007Blue.xaml"/>
            <ResourceDictionary Source="/PresentationFramework.Luna, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL;;component/Themes/luna.normalcolor.xaml" /> 
            </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

现在我想用这个验证触发器扩展每个文本框的样式

```
<Style TargetType="TextBox">
    <Style.Triggers>
        <Trigger Property="Validation.HasError" Value="true">
            <Setter Property="Background" Value="#d3e1f3"></Setter>
            <Setter Property="ToolTip"
            Value="{Binding RelativeSource={RelativeSource Self}, 
                   Path=(Validation.Errors)[0].ErrorContent}"/>
        </Trigger>
    </Style.Triggers>
</Style> 
```

但是这个触发器不起作用，因为我强制使用了 luna 主题。（没有强制主题，每件事都按应有的方式工作，但看起来却不应该:(）有什么方法可以强制使用 luna 主题并扩展它的样式吗？可能在 BasedOn 属性上？

atm 我为有问题的样式定义了一个键，并手动将其添加到每个文本框中，这可行，但不是最漂亮的方法。

蒂亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T09:02:36.273

类型样式的 BasedOn 语法如下：

```
<Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}"> 
```

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T16:30:06.107

尝试

```
<Style x:Key="{x:Type TextBox}" TargetType="{x:Type TextBox}"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-11T21:08:06.793

您是否尝试过先设置 lune 资源字典，最后设置自己的资源字典？我可以想象 luna 主题会覆盖你的风格。

```
<Application.Resources>
   <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/PresentationFramework.Luna, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL;;component/Themes/luna.normalcolor.xaml" />
            <ResourceDictionary Source="/RibbonControlsLibrary;component/Themes/Office2007Blue.xaml"/> 
            <ResourceDictionary Source="Styles.xaml" />
            <ResourceDictionary Source="NavigationCommands.xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-06T10:11:21.553

使用提到的

```
<Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}"> 
```

但还要确保您的字典以正确的顺序包含 - 首先是您的风格所依据的字典

```
<Application.Resources>
<ResourceDictionary>
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/RibbonControlsLibrary;component/Themes/Office2007Blue.xaml"/>
        <ResourceDictionary Source="/PresentationFramework.Luna, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL;;component/Themes/luna.normalcolor.xaml" /> 

        <ResourceDictionary Source="Styles.xaml" />
        <ResourceDictionary Source="NavigationCommands.xaml" />
   </ResourceDictionary.MergedDictionaries>
</ResourceDictionary> 
```

# c - 在C中按空格分割字符串

> ID：323285
> 
> 赞同：10
> 
> 时间：2008-11-27T09:10:45.777
> 
> 标签：c, string

我正在使用 C 并且通过一个套接字我将收到一条带有一个空格的消息，我需要将字符串拆分为空间中的部分。我该怎么做呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-27T09:13:42.010

[strtok_r](http://www.mkssoftware.com/docs/man3/strtok_r.3.asp)是你的朋友。

不要使用 plain `strtok()`，因为它不是线程安全的。

即使在线程安全的平台上（因为状态保存在线程本地存储中），仍然存在使用内部状态意味着您不能同时从多个字符串解析令牌的问题。

例如，如果您编写一个`strtok()`用于分隔字符串 A 的函数，则不能在`strtok()`用于拆分字符串 B的第二个函数的循环中调用您的函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-27T09:22:19.620

如果您拥有字符串缓冲区，并且知道修改它是安全的，则可以`strtok_r()`按照人们的建议使用。或者你可以自己做，像这样：

```
char buffer[2048];
char *sp;

/* read packet into buffer here, omitted */

/* now find that space. */
sp = strchr(buffer, ' ');
if(sp != NULL)
{
  /* 0-terminate the first part, by replacing the space with a '\0'. */
  *sp++ = '\0';
  /* at this point we have the first part in 'buffer', the second at 'sp'.
} 
```

这可能会更快和/或更容易理解，具体取决于上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T09:14:05.550

这通常使用[strtok](http://www.opengroup.org/onlinepubs/000095399/functions/strtok.html) () 库调用来完成。但是请注意，此函数将修改输入字符串（它会在找到所选分隔符的任何地方插入 '\0' NUL 字符） - 因此，如果需要，您可能需要在字符串的副本上调用 strtok()稍后访问整个内容。

编辑：正如另一张海报所提到的，“普通” strtok() 不是线程安全的，所以 strtok_r() 是更安全的调用函数。我不确定 strtok_r() 是否存在就地修改输入缓冲区的相同问题。

# database-design - 什么应该存储在数据库（RDBMS）中？

> ID：323287
> 
> 赞同：5
> 
> 时间：2008-11-27T09:11:57.067
> 
> 标签：database-design

是否有任何指导方针/最佳实践来决定应将哪种类型的数据存储在数据库中？

例如，是否可以使用数据库存储

1.  应用程序日志
2.  配置详细信息（如服务器 IP 地址等）
3.  系统信息（例如，shell 脚本的名称、批处理作业的调度信息、批处理作业状态等）

我见过使用数据库来存储这些的应用程序。这可以接受吗？这种设计的优缺点是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T09:16:15.030

要回答这个问题，我们必须了解数据库存储提供了哪些在平面文件存储中不可用的功能。

1.  安全性 - 您可以存储内容并确保更新、删除和视图受到控制
2.  审核 - 您可以跟踪更改的人员和时间
3.  分布式服务器 - 如果您有多个应用程序服务器访问单个数据库，您可以避免将相同的数据存储在多个位置

如果这些是您的数据所需要的，最好将它们存储在数据库中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-27T10:19:02.393

**应用程序日志**

虽然将数据库中的数据限制在特定时间范围内通常是个好主意（例如，转储/归档/压缩以统计超过 3 个月的所有内容），但将日志记录在数据库中可以非常快速和轻松地分析数据. 需要查看特定用户做了什么？“ *SELECT * FROM logs WHERE User = 'bla'* ”。需要找出系统在特定时间崩溃的原因？“ *SELECT * FROM logs WHERE Timestamp BETWEEN failure - 1 小时和失败 + 5 分钟*”。

**配置详细信息（如服务器 IP 地址等）**

这取决于配置细节。有些是，有些不是。对在多个客户端（例如网站）上运行的应用程序有效并且可能经常更改（例如用户设置）的所有内容都应该放入数据库中。对于或多或少的静态选项，我更喜欢使用配置文件。

**系统信息（例如，shell 脚本的名称、批处理作业的调度信息、批处理作业状态等）**

我想这与配置细节几乎相同。如果它改变：数据库。如果是静态的：配置文件。Shell 脚本通常是静态的。调度信息和状态会随着时间而改变。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-27T10:00:14.943

我们已经将最近几个项目的所有内容都存储在数据库中，这在从开发转向生产时确实很有帮助，因为应用程序本身几乎不需要配置。

记录到数据库可能很有用（例如 Log4j），因为它允许测试人员和分析人员广泛访问日志。

我想这取决于你的情况。存储在数据库中的所有内容都为系统增加了一定程度的复杂性。读取文件比访问数据库从代码中获取相同信息更容易。一个可能的规则是，如果系统越大，则应该将更多的系统存储在数据库中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-27T09:59:20.933

一个小点：99％的时间将配置存储在数据库中是一个糟糕的主意。配置太重要了，不能输给南下的数据库连接：它需要 100% 防弹。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-16T15:40:16.693

**RE: 配置数据** 将配置数据保存在数据库中可能是一个好主意，这样可以更轻松地对其进行编辑并跟踪更改，然后将其写入配置文件以供实际程序读取。

*   为什么 apache 必须了解您的数据库信息才能进行配置？

*   为什么当数据库关闭时您的 FTP 服务器会停止工作？

**RE：应用程序日志**

如前所述，数据库可以使日志分析更容易，但我强烈建议您考虑 log-to-file-and-batch-import-later 模式。

***性能问题***

数据库非常适合取出随机数据位并放入随机数据位。日志数据大多不是随机写入的，而是连续的数据流，非常适合将文件逐行放入文件中。在写入数据时，您无法击败平面文件的性能。也没有很多东西可以用平面文件破坏。这也让数据库专注于做实际的业务工作。

然后稍后您可以从文件中收集所有记录的数据，对其进行解析，进行任何所需的后处理（例如从 IP 地址查找主机名）并将其放入数据库表中。您可以根据需要经常这样做。对于我的网站，我真的不需要能够查看访问者统计数据从一分钟到另一分钟的变化，所以我在晚上运行日志批处理。如果您需要最新信息，您也可以每 60 秒运行一次批量导入，但这仍然比为每个实际业务事务执行一个额外的 INSERT 语句更好（当然，取决于您记录的数量）。

***安全***

*   如果数据库是您的日志引擎，您如何记录失败的数据库连接？

*   如果数据库在崩溃所涉及的事件中提前关闭，您如何调查系统崩溃的原因？

所以我认为你应该考虑什么时候需要数据库中的日志数据以及为什么需要它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T21:02:43.257

尚未提及的一件事是，如果您将应用程序配置之类的东西推到数据库中，则不能将其置于版本控制之下那么容易。

例如，一些 CMS 喜欢将 HTML 模板放入数据库而不是作为文件。我个人认为这是糟糕的设计。您无法对您对模板所做的任何更改进行版本控制，更糟糕的是，您所做的只是从真正的文本编辑器复制并粘贴到浏览器中的懦弱文本编辑器中。

底线？问问自己这是否是您想要版本化的东西。如果是，请将其保留在数据库之外。如果没有，当然，将其放入数据库中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T16:00:46.317

**注重易用性和维护性。**我存储在数据库中的唯一日志是由错误的触发器放置在那里的，因为这是最简单的。但对于其他一切，搜索和解析文本日志更快更容易。如果您的应用程序崩溃，查看文本配置文件比查看数据库更容易，**尤其是对于新维护者**。对于一个新人来说，查看目录`app.properties`中的`config/`文件比知道查看数据库中的表要容易得多。

此外，如果配置文件是文本文件，您可以更轻松地将配置文件存储在源代码管理中，而不是存储在数据库中。相信我，这非常重要。您不想调试丢失导致错误的配置文件设置的应用程序。如果您遇到数据库崩溃或损坏，您可能会丢失日志和配置设置，这可能会导致无法找到问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-14T16:56:12.227

如果您正在开发一个小型静态网站，那么我会同意已经提出的大部分观点。但是，如果您有一个允许用户通过生产站点添加内容的网站，我认为将配置放入数据库会使部署管道复杂化，以至于最好将其保留在数据库之外。

如果您尝试将更新从开发推送到生产，客户端正在将内容推送到生产，并且您的配置和内容都在同一个数据库中，那么您只需要针对具有要覆盖的配置数据的表。这“可能”对您来说是微不足道的额外工作，但这取决于应用程序的规模以及您是否正在使用其他人的代码。考虑 drupal 站点。如果用户正在添加内容，那么对于部署，您需要针对要覆盖的特定数据库表。由于drupal 有几个表（它们的名称中都没有配置），您需要做一些研究以确定哪些可以被覆盖，哪些不能。现在，如果 drupal 的数据库布局发生变化会发生什么？部署管道可能会中断并且它' 为您提供更多额外的工作。添加新插件时会发生什么？更多配置表，因此需要更改部署脚本。为您提供更多工作。如果您最终离开这个项目，您应该向新开发人员留下信息，以解释您对这些部署问题所做的工作。为您提供更多工作。

考虑一下如果配置不在数据库中而是在您的应用程序目录结构中会发生什么。将配置更改保存到 git/svn/etc，将更改推送到您的服务器框并覆盖旧文件。完毕。当您推出更改时，对数据库的影响将减少，您的配置可以置于版本控制之下，并且您的应用程序现在直接与它使用的配置耦合（这是有道理的）。这对于中/大型应用程序或使用您无法控制的预构建组件/框架的应用程序更有价值，然后对于小型应用程序。但是，它适用于所有规模，因为随着应用程序的增长和部署管道变得复杂，将配置存储在数据库中变得更加麻烦。

# com - 有没有办法判断两个 COM 接口引用是否指向同一个实例？

> ID：323289
> 
> 赞同：2
> 
> 时间：2008-11-27T09:13:34.460
> 
> 标签：com, identity, com-interface

给定从不同来源获得的两个接口引用。有没有一种编程方式来判断它们是否由同一个实例实现？

接口引用的简单相等检查总是失败。

* * *

**编辑：**原来问题的大部分，原来是一个独立的问题，现在已经转移到[一个新的问题](https://stackoverflow.com/questions/325629/)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T09:23:46.293

您可以查询 IUnknown 接口并比较这些指针。不保证所有其他接口指针每次都返回相同的值。

来自[组件对象模型的规则](http://msdn.microsoft.com/en-us/library/ms810016.aspx)：

> **对象身份。**要求对特定接口 IUnknown 的给定对象实例的任何接口上的任何 QueryInterface 调用必须始终返回相同的物理指针值。这允许在任何两个接口上调用 QueryInterface(IID_IUnknown, ...) 并比较结果以确定它们是否指向对象的同一实例（相同的 COM 对象标识）。

# asp.net - 我如何知道页面的控件是否进行了回调？

> ID：323293
> 
> 赞同：1
> 
> 时间：2008-11-27T09:14:05.830
> 
> 标签：asp.net, controls

我有一个 ASPX 页面，在这个页面上我有一个包含 AJAX 的控件`UpdatePanel`。当控件进行回调时，我的 ASPX 页面`Page_Load`事件被触发，但该`Page.IsCallBack`属性为 false。

我如何在页面`Page_Load`事件中知道是否有回调？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T09:55:22.707

我已经使用以下代码来检查 a`Page_Load`是否由 AJAX 请求触发：

```
if (!string.IsNullOrEmpty(Request.Headers["X-MicrosoftAjax"]))
{
} 
```

# java - MySQL 中 SUM 结果的数据类型

> ID：323294
> 
> 赞同：3
> 
> 时间：2008-11-27T09:14:37.500
> 
> 标签：java, mysql, sum, return-type

使用 SUM 时，我在将 MySQL 查询的结果转换为 Java 类时遇到了一些问题。

在 MySQL 中执行简单 SUM 时

```
SELECT SUM(price) FROM cakes WHERE ingredient = 'chocolate'; 
```

作为一个整数，`price`看起来`SUM`有时返回一个字符串，有时返回一个整数，具体取决于 JDBC 驱动程序的版本。

显然，服务器确实告诉 JDBC 驱动程序的结果`SUM`是一个字符串，而 JDBC 驱动程序有时会“方便地”将其转换为整数。（见[马克马修斯的解释](http://marc.info/?l=mysql-java&m=116295785422117&w=2)）。

Java 代码使用一些[BeanInfo](http://java.sun.com/j2se/1.4.2/docs/api/java/beans/BeanInfo.html)和[Introspection](http://java.sun.com/j2se/1.4.2/docs/api/java/beans/Introspector.html)自动用查询结果填充（列表）bean。但是，如果部署应用程序的服务器之间的数据类型不同，这显然是行不通的。

我不在乎我得到的是字符串还是整数，但我希望始终拥有相同的数据类型，或者至少提前知道我将获得哪种数据类型。

有什么方法可以知道 MySQL`SUM`从 Java 代码中返回哪种数据类型？或者有谁知道一些更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-27T09:23:28.683

这只是一个猜测，但也许转换为整数会迫使 MySQL 总是告诉它是一个整数。

```
SELECT CAST(SUM(price) AS SIGNED) FROM cakes WHERE ingredient = 'marshmallows'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T10:21:48.813

我以前从未使用过 MySQL，所以我不能说为什么，但如果你说：

```
ResultSet rs = statement.executeQuery("SELECT SUM(price) FROM cakes WHERE ingredient = 'chocolate'");
int sum = 0;
if(rs.next())
size = Integer.parseInt(rs.getString(1)); 
```

Then you should not have a problem regardless of the returned datatype as the documentation says:

> ### String getString(int columnIndex) throws SQLException
> 
> Retrieves the value of the designated column in the current row of this ResultSet object **as a String** in the Java programming language

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-10-28T11:43:12.067

I found `COALESCE(SUM(price),0)` good for always ensuring the field returned 0 if there was no result.

See: [http://lists.mysql.com/mysql/177427](http://lists.mysql.com/mysql/177427)

# client - 设计师到开发者——我应该知道什么？

> ID：323299
> 
> 赞同：4
> 
> 时间：2008-11-27T09:17:51.017
> 
> 标签：client, protocols

这是一个广泛的问题，所以让我缩小一点。我是一名进入网页设计世界的平面设计师。我在这个领域并不完全是新手，但我知道的足够多，知道我还有很多东西要学。从朋友和这个网站上的帖子中，我意识到设计和开发之间经常存在有害的脱节。

我正准备在我的网站上放置一个客户登录/密码“门户”。没有什么花哨的，足以为我的客户提供一些健全的头脑和安全下载图像的空间。我只处理这个的外观和感觉，仅此而已。我应该知道哪些潜在的陷阱，以避免让开发结束变得麻烦？

当然，任何其他的智慧也受到赞赏。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T09:51:25.943

也许许多设计师在与开发人员合作时犯的最严重的错误是假设开发人员没有创造力，并且我们不可能对设计有任何好的想法或投入。这种谬误是显而易见的，因为我们每天、每天都在做的事情就是创造事物。当我们的代码不能准确地代表设计时，设计师可以向开发人员提出错误是理所当然的，但是当我们提出关于如何改进他们的设计的建议时，即使是在很小的方面，许多设计师也会变得非常敏感。有时这些建议可能不合适，但有时您可能能够改进您的设计。

此外，我经常发现设计师低估了开发人员实现他们想要的功能的能力，因此有时会提出更简单的替代方案。通过打开对话框并提供一些选项，例如最小选项和理想选项，您可能会惊讶于您可以拥有理想选项的元素，或全部，甚至更好的元素，因为您讨论实际可以是什么实现（有时对设计师来说似乎很难实现的东西对开发者来说似乎很容易，反之亦然，因为它们是不同的学科）。当然反过来也是正确的，你可能目标太高了，所以你也需要找出来。

总而言之-您绝对正确，设计和开发之间的任何脱节都会损害士气和最终产品。因此，一旦您有了初始设计，就立即与开发人员交谈，并保持良好的双向对话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T09:44:53.507

我是一名网络开发人员，所以我从我的角度回答这个问题。只要开发人员和设计人员相互理解，就没有严重的陷阱。一种尝试使网站看起来尽可能有吸引力，而另一种尝试使网站的外观尽可能接近设计。

所以当我被要求做不可能的事情时（比如用猫的动画图像替换浏览器的默认滚动条），我只会告诉设计师它不能完成，原因，并提出可能的替代方案（闪光 ？）。话虽如此，我希望设计师能够理解并与我合作，选择最好的替代品，而不是突然变成脾气暴躁的模式或什么的。

对开发人员的工作有一点基本了解也会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T09:36:54.270

一些可以使过程顺利的想法：

直接与开发人员交谈，询问他们是否有任何具体要求。不同的平台有不同的需求和要求。沟通很重要。

掌握好的 HTML 和 CSS 的基础知识。有很多参考资料，但您可以尝试[A List Apart](http://www.alistapart.com/)作为起点。

# crystal-reports - 水晶报表 10

> ID：323303
> 
> 赞同：2
> 
> 时间：2008-11-27T09:20:22.870
> 
> 标签：crystal-reports

我正在使用 Crystal Reports 10。在报告中我有两个提示。

如何将此报告提供给用户，以便他们可以在 Web 上输入参数？

提前谢谢，S.Gyazuddin

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-04T21:25:09.753

If you're using the stand alone crystal reports designer you will need to deploy the report to a web reporting tool such as Crystal Reports Server or Crystal Enterprise. Then allow your users to access it from there.

If you are using .Net then create an ASP.NET page and add a CrystalReportSource control to your report to the page. Then add a CrystalReportViewer control to the page that uses your report source and be sure the checkbox for Enable Report Parameter Prompting is checked. When they load the page it should prompt the user for the parameters.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T16:49:16.227

这是一些让您开始使用 ReportDocument rpt 的代码；

```
//set the datasource 
rpt.SetDataSource(reportDataSet.Tables[0]);

ArrayList reportParameters;  // you filled this arraylist with your values coming from aspx page

//set the parameters for mail report
for (int param = 0; param < reportParameters.Count; param++)
{
    rpt.SetParameterValue(param, reportParameters[param]);
} 
```

# c# - 将 Pascal Case 转换为句子的最佳方法

> ID：323314
> 
> 赞同：79
> 
> 时间：2008-11-27T09:30:35.017
> 
> 标签：c#, string

从 Pascal Case（大骆驼案例）转换为句子的最佳方法是什么。

例如从

```
"AwaitingFeedback" 
```

并将其转换为

```
"Awaiting feedback" 
```

C# 更可取，但我可以将它从 Java 或类似的转换。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-07-31T09:04:04.580

```
public static string ToSentenceCase(this string str)
{
    return Regex.Replace(str, "[a-z][A-Z]", m => m.Value[0] + " " + char.ToLower(m.Value[1]));
} 
```

在 2015 年之后的 Visual Studio 版本中，您可以执行

```
public static string ToSentenceCase(this string str)
{
    return Regex.Replace(str, "[a-z][A-Z]", m => $"{m.Value[0]} {char.ToLower(m.Value[1])}");
} 
```

基于：[Converting Pascal case to sentence using regular expression](http://www.vojkovic.net/converting-pascal-case-to-sentences-using-regular-expression)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-05-28T16:14:36.740

我更喜欢为此使用[Humanizer](https://github.com/Humanizr/Humanizer)。Humanizer 是一个可移植的类库，可以满足所有 .NET 操作和显示字符串、枚举、日期、时间、时间跨度、数字和数量的需求。

**简答**

```
"AwaitingFeedback".Humanize() => Awaiting feedback 
```

**长而描述性的答案**

Humanizer 可以做更多的工作，其他示例包括：

```
"PascalCaseInputStringIsTurnedIntoSentence".Humanize() => "Pascal case input string is turned into sentence"
"Underscored_input_string_is_turned_into_sentence".Humanize() => "Underscored input string is turned into sentence"
"Can_return_title_Case".Humanize(LetterCasing.Title) => "Can Return Title Case"
"CanReturnLowerCase".Humanize(LetterCasing.LowerCase) => "can return lower case" 
```

完整的代码是：

```
using Humanizer;
using static System.Console;

namespace HumanizerConsoleApp
{
    class Program
    {
        static void Main(string[] args)
        {
            WriteLine("AwaitingFeedback".Humanize());
            WriteLine("PascalCaseInputStringIsTurnedIntoSentence".Humanize());
            WriteLine("Underscored_input_string_is_turned_into_sentence".Humanize());
            WriteLine("Can_return_title_Case".Humanize(LetterCasing.Title));
            WriteLine("CanReturnLowerCase".Humanize(LetterCasing.LowerCase));
        }
    }
} 
```

**输出**

> 等待反馈
> 
> Pascal case 输入字符串变成句子
> 
> 下划线输入字符串转成句子 Can Return Title Case
> 
> 可以返回小写

如果您更喜欢编写自己的 C# 代码，您可以通过编写一些其他人已经回答的 C# 代码来实现这一点。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-27T09:42:58.080

干得好...

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace CamelCaseToString
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(CamelCaseToString("ThisIsYourMasterCallingYou"));   
        }

        private static string CamelCaseToString(string str)
        {
            if (str == null || str.Length == 0)
                return null;

            StringBuilder retVal = new StringBuilder(32);

            retVal.Append(char.ToUpper(str[0]));
            for (int i = 1; i < str.Length; i++ )
            {
                if (char.IsLower(str[i]))
                {
                    retVal.Append(str[i]);
                }
                else
                {
                    retVal.Append(" ");
                    retVal.Append(char.ToLower(str[i]));
                }
            }

            return retVal.ToString();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2010-05-28T05:45:57.063

**这对我有用：**

```
Regex.Replace(strIn, "([A-Z]{1,2}|[0-9]+)", " $1").TrimStart() 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-06-06T20:08:35.283

**这就像@SSTA，但比调用 TrimStart 更有效。**

```
Regex.Replace("ThisIsMyCapsDelimitedString", "(\\B[A-Z])", " $1") 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-07-11T12:36:19.523

在 MvcContrib 源代码中找到了这个，这里似乎还没有提到。

```
return Regex.Replace(input, "([A-Z])", " $1", RegexOptions.Compiled).Trim(); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-27T09:48:16.573

这是我使用正则表达式提出的一种基本方法

```
public static string CamelCaseToSentence(this string value)
{
    var sb = new StringBuilder();
    var firstWord = true;

    foreach (var match in Regex.Matches(value, "([A-Z][a-z]+)|[0-9]+"))
    {
        if (firstWord)
        {
            sb.Append(match.ToString());
            firstWord = false;
        }
        else
        {
            sb.Append(" ");
            sb.Append(match.ToString().ToLower());
        }
    }

    return sb.ToString();
} 
```

它还将拆分我没有指定但很有用的数字。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-07-12T16:45:13.717

仅仅因为每个人都在使用正则表达式（除了[这个家伙](https://stackoverflow.com/a/28520553/1037948)），这里的实现在我的测试中快了`StringBuilder`大约**5 倍。**也包括检查数字。

```
"SomeBunchOfCamelCase2".FromCamelCaseToSentence == "Some Bunch Of Camel Case 2"

public static string FromCamelCaseToSentence(this string input) {
    if(string.IsNullOrEmpty(input)) return input;

    var sb = new StringBuilder();
    // start with the first character -- consistent camelcase and pascal case
    sb.Append(char.ToUpper(input[0]));

    // march through the rest of it
    for(var i = 1; i < input.Length; i++) {
        // any time we hit an uppercase OR number, it's a new word
        if(char.IsUpper(input[i]) || char.IsDigit(input[i])) sb.Append(' ');
        // add regularly
        sb.Append(input[i]);
    }

    return sb.ToString();
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-27T10:00:46.517

```
string camel = "MyCamelCaseString";
string s = Regex.Replace(camel, "([A-Z])", " $1").ToLower().Trim();
Console.WriteLine(s.Substring(0,1).ToUpper() + s.Substring(1)); 
```

编辑：没有注意到您的套管要求，因此进行了修改。您可以使用匹配评估器来进行大小写，但我认为子字符串更容易。您也可以将其包装在第二个正则表达式替换中，您可以在其中更改第一个字符

```
"^\w" 
```

向上

```
\U (i think) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-27T09:41:49.597

我会使用正则表达式，在每个大写字符之前插入一个空格，然后降低所有字符串。

```
 string spacedString = System.Text.RegularExpressions.Regex.Replace(yourString, "\B([A-Z])", " \k");
    spacedString = spacedString.ToLower(); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-27T09:44:51.120

在 JavaScript（或 PHP 等）中很容易做到，您可以在 replace 调用中定义一个函数：

```
var camel = "AwaitingFeedbackDearMaster";
var sentence = camel.replace(/([A-Z].)/g, function (c) { return ' ' + c.toLowerCase(); });
alert(sentence); 
```

虽然我还没有解决最初的上限问题...... :-)

现在，对于 Java 解决方案：

```
String ToSentence(String camel)
{
  if (camel == null) return ""; // Or null...
  String[] words = camel.split("(?=[A-Z])");
  if (words == null) return "";
  if (words.length == 1) return words[0];
  StringBuilder sentence = new StringBuilder(camel.length());
  if (words[0].length() > 0) // Just in case of camelCase instead of CamelCase
  {
    sentence.append(words[0] + " " + words[1].toLowerCase());
  }
  else
  {
    sentence.append(words[1]);
  }
  for (int i = 2; i < words.length; i++)
  {
    sentence.append(" " + words[i].toLowerCase());
  }
  return sentence.toString();
}

System.out.println(ToSentence("AwaitingAFeedbackDearMaster"));
System.out.println(ToSentence(null));
System.out.println(ToSentence(""));
System.out.println(ToSentence("A"));
System.out.println(ToSentence("Aaagh!"));
System.out.println(ToSentence("stackoverflow"));
System.out.println(ToSentence("disableGPS"));
System.out.println(ToSentence("Ahh89Boo"));
System.out.println(ToSentence("ABC")); 
```

注意在不丢失任何字符的情况下拆分句子的技巧......

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-13T00:21:49.553

适用于 UpperCamel 和 lowerCamel 情况的 xquery 解决方案：

输出句子大小写（只有第一个单词的第一个字符大写）：

```
declare function content:sentenceCase($string)
{
let $firstCharacter := substring($string, 1, 1)
let $remainingCharacters := substring-after($string, $firstCharacter)
return
concat(upper-case($firstCharacter),lower-case(replace($remainingCharacters, '([A-Z])', ' $1')))
}; 
```

要输出标题大小写（每个单词的第一个字符大写）：

```
declare function content:titleCase($string)
{
let $firstCharacter := substring($string, 1, 1)
let $remainingCharacters := substring-after($string, $firstCharacter)
return
concat(upper-case($firstCharacter),replace($remainingCharacters, '([A-Z])', ' $1'))
}; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-27T09:38:34.987

伪代码：

```
NewString = "";
Loop through every char of the string (skip the first one)
   If char is upper-case ('A'-'Z')
     NewString = NewString + ' ' + lowercase(char)
   Else
     NewString = NewString + char 
```

更好的方法也许可以通过使用正则表达式或字符串替换例程来完成（用“x”替换“X”）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-02-14T21:31:38.110

发现自己在做类似的事情，我很高兴能从这个讨论出发。这是我的解决方案，作为字符串类的扩展方法放置在控制台应用程序的上下文中。

```
using System;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string piratese = "avastTharMatey";
            string ivyese = "CheerioPipPip";

            Console.WriteLine("{0}\n{1}\n", piratese.CamelCaseToString(), ivyese.CamelCaseToString());
            Console.WriteLine("For Pete\'s sake, man, hit ENTER!");
            string strExit = Console.ReadLine();
        }

    }

    public static class StringExtension
    {
        public static string CamelCaseToString(this string str)
        {
            StringBuilder retVal = new StringBuilder(32);

            if (!string.IsNullOrEmpty(str))
            {
                string strTrimmed = str.Trim();

                if (!string.IsNullOrEmpty(strTrimmed))
                {
                    retVal.Append(char.ToUpper(strTrimmed[0]));

                    if (strTrimmed.Length > 1)
                    {
                        for (int i = 1; i < strTrimmed.Length; i++)
                        {
                            if (char.IsUpper(strTrimmed[i])) retVal.Append(" ");

                            retVal.Append(char.ToLower(strTrimmed[i]));
                        }
                    }
                }
            }
            return retVal.ToString();
        }
    }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-06-23T21:56:51.467

前面的大多数答案都将首字母缩写词和数字分开，在每个字符前面添加一个空格。我希望首字母缩略词和数字保持在一起，所以我有一个简单的状态机，每次输入从一种状态转换到另一种状态时都会发出一个空格。

```
 /// <summary>
    /// Add a space before any capitalized letter (but not for a run of capitals or numbers)
    /// </summary>
    internal static string FromCamelCaseToSentence(string input)
    {
        if (string.IsNullOrEmpty(input)) return String.Empty;

        var sb = new StringBuilder();
        bool upper = true;

        for (var i = 0; i < input.Length; i++)
        {
            bool isUpperOrDigit = char.IsUpper(input[i]) || char.IsDigit(input[i]);
            // any time we transition to upper or digits, it's a new word
            if (!upper && isUpperOrDigit)
            {
                sb.Append(' ');
            }
            sb.Append(input[i]);
            upper = isUpperOrDigit;
        }

        return sb.ToString();
    } 
```

这里有一些测试：

```
 [TestCase(null, ExpectedResult = "")]
    [TestCase("", ExpectedResult = "")]
    [TestCase("ABC", ExpectedResult = "ABC")]
    [TestCase("abc", ExpectedResult = "abc")]
    [TestCase("camelCase", ExpectedResult = "camel Case")]
    [TestCase("PascalCase", ExpectedResult = "Pascal Case")]
    [TestCase("Pascal123", ExpectedResult = "Pascal 123")]
    [TestCase("CustomerID", ExpectedResult = "Customer ID")]
    [TestCase("CustomABC123", ExpectedResult = "Custom ABC123")]
    public string CanSplitCamelCase(string input)
    {
        return FromCamelCaseToSentence(input);
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-27T10:39:19.950

大部分[已经在这里回答了](https://stackoverflow.com/questions/272633/add-spaces-before-capital-letters#272929)

对接受的答案的小改动，将第二个和后续的大写字母转换为小写，所以改变

```
if (char.IsUpper(text[i]))                
    newText.Append(' ');            
newText.Append(text[i]); 
```

至

```
if (char.IsUpper(text[i]))                
{
    newText.Append(' ');            
    newText.Append(char.ToLower(text[i]));
}
else
   newText.Append(text[i]); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-01T20:53:13.947

这是我的实现。这是我在避免为缩写创建空格的同时获得的最快速度。

```
public static string PascalCaseToSentence(string input)
    {
        if (string.IsNullOrEmpty(input) || input.Length < 2)
            return input;

        var sb = new char[input.Length + ((input.Length + 1) / 2)];
        var len = 0;
        var lastIsLower = false;
        for (int i = 0; i < input.Length; i++)
        {
            var current = input[i];
            if (current < 97)
            {
                if (lastIsLower)
                {
                    sb[len] = ' ';
                    len++;
                }
                lastIsLower = false;
            }
            else
            {
                lastIsLower = true;
            }
            sb[len] = current;

            len++;
        }

        return new string(sb, 0, len);
    } 
```

# prototyping - 谁能告诉我强类型和弱类型是什么意思，哪个更好？

> ID：323323
> 
> 赞同：38
> 
> 时间：2008-11-27T09:36:57.797
> 
> 标签：prototyping, static-typing, dynamic-typing, strong-typing, weak-typing

谁能告诉我强类型和弱类型是什么意思，哪个更好？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-27T10:58:30.817

这将是照顾的理论答案，但实践方面似乎被忽视了......

强类型意味着您不能使用一种类型的变量来预期另一种类型的变量（或这样做有限制）。弱类型意味着你可以混合不同的类型。例如，在 PHP 中，您可以混合使用数字和字符串，PHP 不会抱怨，因为它是一种弱类型语言。

```
$message = "You are visitor number ".$count; 
```

如果它是强类型的，则必须将 $count 从整数转换为字符串，通常使用强制类型转换：

```
$message = "you are visitor number ".(string)$count; 
```

...或函数：

```
$message = "you are visitor number ".strval($count); 
```

至于哪个更好，那是主观的。强类型的拥护者会告诉你，它会帮助你避免一些错误和/或错误，并帮助传达变量的用途等。他们还会告诉你弱类型的拥护者会称强类型“*不必要”被常识*“或类似的东西变得毫无意义的语言绒毛”。作为弱打字组的持卡成员，我不得不说他们有我的号码......但我也有他们的，*我*可以把它放在一个字符串中:)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-27T09:51:54.617

“强类型”及其相反的“弱类型”在含义上相当弱，部分原因是被认为是“强”的概念可能会因您询问的对象而异。例如，C 被不同的作者称为“强类型”和“弱类型”，这实际上取决于您将其与什么进行比较。

一般来说，如果一个类型系统可以表达与另一个相同的约束，甚至更多，那么它应该被认为是更强大的。但是，通常两种类型的系统是不可比较的——一种可能具有另一种缺乏的功能，反之亦然。任何关于相对优势的讨论都取决于个人喜好。

拥有更强大的类型系统意味着编译器或运行时将报告更多错误，这通常是一件好事，尽管它可能以必须手动提供更多类型信息为代价，这可能被认为不值得付出努力。我会声称“强类型”通常更好，但你必须看看成本。

同样重要的是要认识到“强类型”经常被错误地使用，而不是“静态类型”甚至“清单类型”。“静态类型”意味着在编译时进行类型检查，“清单类型”意味着类型被显式声明。清单类型可能是使类型系统更强大的最著名方法（想想 Java），但您可以通过其他方式（例如类型推断）来增加强度。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-27T11:24:00.420

我想重申，弱类型*与*动态类型不同。

这是一篇关于该主题的写得相当好的文章，如果您不确定强、弱、静态和动态类型系统之间的区别，我绝对建议您阅读它。它详细说明了差异，比简短回答中的预期要好得多，并且有一些非常有启发性的例子。

[http://en.wikipedia.org/wiki/Type_system](http://en.wikipedia.org/wiki/Type_system)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-08T13:46:02.867

**强类型**是现代编程语言中最常见的类型模型。这些语言有一个简单的特性——在运行时了解类型值。我们可以说强类型语言防止两种或多种不同类型之间的混合操作。这是Java中的示例：

```
String foo = "Hello, world!";
Object obj = foo;

String bar = (String) obj;
Date baz = (Date) obj; // This line will throw an error 
```

前面的示例将运行良好，直到程序遇到将引发 ClassCastException 的最后一行代码，因为 Java 是强类型编程语言。

当我们谈论**弱类型**语言时，Perl 就是其中之一。下面的例子展示了 Perl 如何在混合两种不同类型时没有任何问题。

```
$a = 10;
$b = "a";
$c = $a . $b;
print $c; # returns 10a 
```

希望这个对你有帮助，

谢谢。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-31T00:03:25.897

这篇文章很好读： http: [//blogs.perl.org/users/ovid/2010/08/what-to-know-before-debating-type-systems.html](http://blogs.perl.org/users/ovid/2010/08/what-to-know-before-debating-type-systems.html)在研究时为我清理了很多东西试图回答类似的问题，希望其他人也觉得它有用。

强类型和弱类型：

> 可能最常见的类型系统分类方式是“强”或“弱”。这是不幸的，因为这些词几乎没有任何意义。在有限的范围内，可以将两种语言与非常相似的类型系统进行比较，并指定一种语言具有这两种系统中更强的一种。除此之外，这些话根本没有任何意义。

静态和动态类型

> 这几乎是唯一具有实际意义的类型系统的常见分类。事实上，它的重要性经常被低估 [...] 动态和静态类型系统是两个完全不同的东西，它们的目标恰好部分重叠。
> 
> 静态类型系统是一种机制，编译器通过该机制检查源代码并将标签（称为“类型”）分配给语法片段，然后使用它们来推断程序的行为。动态类型系统是一种机制，编译器通过该机制生成代码以跟踪程序使用的数据类型（巧合的是，也称为“类型”）。当然，在这两个系统中使用同一个词“类型”并非完全巧合。但最好将其理解为具有某种微弱的历史意义。试图找到一种世界观，其中“类型”在两个系统中真正意味着相同的东西，导致了极大的混乱。它没有。

显式/隐式类型：

> 当使用这些术语时，它们指的是编译器对程序部分的静态类型进行推理的程度。所有编程语言都有某种形式的关于类型的推理。有些人比其他人拥有更多。ML 和 Haskell 具有隐式类型，因为不需要（或很少，取决于使用的语言和扩展）类型声明。Java 和 Ada 有非常明确的类型，并且不断地声明事物的类型。以上所有都具有（例如，相对于 C 和 C++）强静态类型系统。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-30T17:53:55.440

语言中的强/弱类型与您进行类型转换的难易程度有关：

例如在 Python 中：

```
str = 5 + 'a' 
# would throw an error since it does not want to cast one type to the other implicitly. 
```

在 C 语言中：

```
int a = 5;
a = 5 + 'c';
/* is fine, because C treats 'c' as an integer in this case */ 
```

因此 Python 的类型比 C 更强（从这个角度来看）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-01T12:28:42.060

也许这可以帮助你理解强类型和弱类型......

**强类型：**它尽快检查变量的类型，通常在编译时。它可以防止不匹配类型之间的混合操作。

强类型编程语言是一种：

*   所有变量（或数据类型）在编译时都是已知的
*   严格执行输入规则（字符串不能用于需要整数的地方）
*   键入规则的所有例外都会导致编译时错误

**弱类型：**虽然弱类型会尽可能晚地延迟检查系统的类型，通常延迟到运行时。在这种情况下，您可以混合类型而无需显式转换。

“弱类型”编程语言只是一种非强类型的编程语言。

**哪个是首选**取决于你想要什么。对于脚本和好东西，您通常需要弱类型，因为您希望编写尽可能少的代码。在大型程序中，强类型可以减少编译时的错误。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-11-27T09:44:07.657

弱类型意味着您不指定变量的类型，而强类型意味着您为每个变量指定严格的类型。

每个都有其优点，弱类型（或通常称为动态类型），更灵活并且需要更少的程序员代码。另一方面，强类型需要开发人员做更多的工作，但作为回报，它可以在编译代码时提醒您许多错误，然后再运行它。动态类型可能会延迟这些简单问题的发现，直到代码被执行。

根据手头的任务，弱类型可能比强类型更好，反之亦然，但这主要是个人喜好问题。弱类型通常用于脚本语言，而强类型则用于大多数编译语言。

# asp.net - IIS 6.0 通配符映射基准？

> ID：323325
> 
> 赞同：35
> 
> 时间：2008-11-27T09:38:36.577
> 
> 标签：asp.net, asp.net-mvc, iis-6

我很快就爱上了 ASP.NET MVC beta，我决定在部署到我的 IIS 6 托管环境时不会牺牲的一件事是无扩展 URL。因此，我正在权衡添加通配符映射的考虑，但我阅读的所有内容都表明使用此方法时可能会影响性能。但是，我找不到任何实际的基准！

这个问题的第一部分是，你知道我在哪里可以找到这样的基准，还是只是一个未经检验的假设？

问题的第二部分是关于我在我们的开发服务器上使用 jMeter 通过 100Mbs 连接运行的 2 个负载测试。

**背景信息**

我们的托管服务提供商有一个 4Gbs 的可突发互联网管道和一个用于我们 VLAN 的 1Gbs 骨干网，因此我可以通过办公室局域网生成的任何内容都应该很好地转换为托管环境。

测试场景是加载几个图像/css 文件，因为当请求现在通过 ASP.NET ISAPI 过滤器（通常不会通过它）传递的文件时，假定的性能会受到影响。每个测试包含 50 个线程（模拟用户），每个线程运行 1000 次迭代的请求脚本。每个测试的结果发布在下面。

**测试结果**

没有通配符映射：

```
样品：50,000
平均响应时间：428ms
错误数：0
每秒请求数：110.1
每秒千字节：11,543

```

使用通配符映射：

```
样品：50,000
平均响应时间：429ms
错误数：0
每秒请求数：109.9
千字节每秒：11,534

```

两个测试都是热运行的（一切都在内存中，没有初始负载偏差），从我的角度来看，性能差不多。在两次测试期间，CPU 使用率约为 60%，内存正常，网络使用率稳定在 90-95% 左右。

这是否足以证明通过所有内容的 ASP.NET 过滤器的通配符映射不会*真正*影响性能，还是我遗漏了什么？

编辑：11 个小时，没有一条评论？我希望有更多..大声笑

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T15:51:29.190

克里斯，非常方便的帖子。

许多提出性能劣势的人推断，Web 应用程序中处理的代码与标准工作流程中处理的代码有一些不同/劣势。基本代码类型可能不同，并且您肯定需要 MSIL 解释器，但 MS 已经表明，在许多情况下，您实际上会看到 .NET 运行时的性能比本机运行时有所提高。

考虑 IIS 如何成为“万事通”也是明智之举——**即使在静态文件上也**允许进行各种配置和覆盖。其中一些是为提高性能（缓存、压缩）而设计的，并且 - 实际上 - 除非您在代码中重新实现它们，否则它们会丢失，但其中许多是用于其他目的，可能永远不会被使用。如果您（仅）为您的需要而构建，您可以忽略那些其他部分，并且应该实现某种性能优势，即使存在潜在的 ASP.NET 劣势。

在我的（非 .NET）MVC 测试中，我看到与 Web 表单相比具有相当大的（10 倍或更多）性能优势。即使对静态内容有一点影响——这也不是一颗难以下咽的药丸。

在您的测试中差异几乎可以忽略不计，我并不感到惊讶，但我很高兴看到它得到支持。

注意：您可以在 IIS 中禁用来自静态目录的通配符映射（我将所有静态文件保存在 /static/(pics|styles|...) 中）。将文件夹切换到应用程序，删除通配符映射，然后将其从应用程序切换回来 - 瞧 - 静态文件由 IIS 处理，而不会打扰您的 ASP.NET。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T13:12:57.177

我认为还有一些额外的事情需要检查：

*   由于我们使用的是 .Net ISAPI 过滤器，我们可能会使用线程来运行应用程序以提供静态资产。我会在查看线程的性能计数器时运行相同的负载测试 -[查看此链接](http://msdn.microsoft.com/en-us/library/zf749bat.aspx)
*   我会在运行 Microsoft Performance Analyzer 时运行相同的负载测试并比较报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T21:09:30.240

我一直在寻找这样的基准。谢谢！

在我的公司，我们在几个网站（标准 Web 表单、.net1.1 和 2、iis6）上进行了通配符映射，系统管理员对我说他们没有注意到任何性能问题。

但是，似乎您强调的是网络，而不是服务器。所以也许分数如此相似是因为网络瓶颈？只是想...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T14:01:43.780

那是一个令人印象深刻的帖子，非常感谢。

我们还在评估删除一个一直存在以过滤掉不需要的流量的软件的安全性和性能问题。

您是否会进一步进行基准测试？

干杯，

卡尔。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-10T06:55:23.237

似乎您的测试中的瓶颈是网络利用率。如果性能下降预计会出现在 CPU 使用率上（我不确定是否如此，但这是合理的），那么您在进行的测试中不会注意到它。

由于这是一个复杂的系统，具有许多变量 - 这并不意味着没有性能下降。这意味着在您的场景中 - 性能下降可能可以忽略不计。

# c# - 对存储过程的结果进行排序

> ID：323342
> 
> 赞同：3
> 
> 时间：2008-11-27T09:49:39.177
> 
> 标签：c#, asp.net, sorting, stored-procedures, ado.net

我想对存储过程结果中的列进行排序，而不必在存储过程中添加 Order By 子句。我不希望在执行查询后对数据进行排序，如果可能的话，排序应该是查询的一部分。我有以下代码：

```
public static DataTable RunReport(ReportQuery query)
{
    OffertaDataContext db = new OffertaDataContext();
    Report report = (from r in db.Reports where r.Id == (int)query.ReportId select r).Single(); 
    //???: check security clearance.

    DataSet dataSet = new DataSet();

    /*
    doesn't work, I guess the "Result" table hasn't been created yet;
    if(!string.IsNullOrEmpty(query.SortField))
    {
        dataSet.DefaultViewManager.DataViewSettings["Result"].Sort = query.SortField + " " + (query.SortAscending ? "ASC" : "DESC"); 
    }
    */

    using (SqlConnection conn = new SqlConnection(Config.ConnectionString))
    {
        conn.Open();
        using (SqlCommand exec = conn.CreateCommand())
        {
            using (SqlDataAdapter adapter = new SqlDataAdapter())
            {
                exec.Connection = conn;
                exec.CommandType = CommandType.StoredProcedure;
                exec.CommandText = report.ReportProc;

                adapter.SelectCommand = exec;
                try
                {

                    adapter.Fill(dataSet, query.Skip, query.Take, "Result");
                }
                catch (Exception e)
                {
                    throw e;
                }
                finally
                {
                    conn.Close();
                }
                return dataSet.Tables["Result"];
            }
        }
    }
} 
```

如何添加排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T10:06:42.807

获取您在数据集中填充的数据表（“结果”）。

现在 - 除了通过填充它的查询、视图或存储过程之外，没有办法对 DataTable 进行排序。

由于您不想在 SP 中这样做，您可以对 DataTable 的 DefaultView 或与 DataTable 关联的任何 DataView 进行排序。

您可以使用 DataView 的 Sort 属性来实现它。这是一个字符串，它指定要排序的列（或列）和顺序（ASC 或 DESC）。

例子：

```
myTable.DefaultView.Sort = "myColumn DESC"; 
```

您现在可以使用 DefaultView 做任何您想做的事（将其绑定到某物或其他东西）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T10:05:41.077

说实话，既然你用的是DataTable，那还不如直接在客户端排序。

通过 SP 等动态排序（在服务器上）总是很痛苦；要在纯 TSQL 中执行此操作，要么在 SELECT 末尾需要一些非常低效的 CASE 块，要么需要使用动态 SQL（例如通过 sp_ExecuteSQL），在最终查询中操作 ORDER BY。唯一的其他选项（在原始 TSQL 中）是 EXEC/INTO 将数据放入表变量（或临时表）中，然后使用 ORDER BY 从中选择。

如果是一个选项，LINQ-to-SQL 实际上在这方面做得很好；它支持查询（和组合）UDF - 因此，而不是 SP，在 UDF 中编码查询（如果您需要支持遗留调用者，SP 总是可以从 UDF 中选择）。然后您可以在 LINQ 查询中使用“order by”等：

```
var qry = from row in ctx.SomeMethod(args)
          order by row.Name, row.Key
          select row; 
```

（或者有多种方法可以为 LINQ 查询添加动态排序 - 以上只是一个简单的示例）

最终的 TSQL 将类似于：

```
SELECT blah FROM theudf(args) ORDER BY blah 
```

即它会做对，并在服务器上执行“ORDER BY”。`Skip()`这在与和`Take()`获取分页数据一起使用时特别有用。

# objective-c - Mac 应用程序的 MVC 架构问题

> ID：323350
> 
> 赞同：0
> 
> 时间：2008-11-27T09:58:22.713
> 
> 标签：objective-c, cocoa, macos

我有一个控制器类，我从中调用模型类的方法。现在，我想从这个模型类方法中不断更新作为控制器类数据成员的 textView 对象。我在控制器类中有方法来编辑这个 textView。我尝试从模型类方法创建一个控制器对象并编辑了 textView。虽然我没有收到任何错误，但它没有在 textView 中显示文本。如何让模型类使用控制器类方法连续显示文本..？？是不是我正在创建一个本地控制器对象并引用它的 textView 而不是原始控制器对象。

控制器.m 文件：

```
- (void) notifyContentHasChanged:(NSInteger) block {
    NSString *str;
    str = [NSString stringWithFormat:@"Block Written Successfully: %d\n", block];
    [data insertText:str];
} 
```

模型.m 文件：

```
Controller * c = [[Controller alloc] init];
while (USB_SUCCESS(status)){
    DfuBlockCnt++;
    printf("\nBlocks Written Successfully: %d",DfuBlockCnt);
    [c notifyContentHasChanged:DfuBlockCnt];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T10:46:34.443

您应该考虑使用 KVO - Key Value Observing - 这样您就可以让观察者为您完成所有工作。

我想知道您是否缺少与 NSTextView 的连接 - 如果您尝试将消息传递给 Objective C 中的 nil 对象，它不会给您错误。

# http - HTTP 使用 UDP 吗？

> ID：323351
> 
> 赞同：126
> 
> 时间：2008-11-27T09:58:29.533
> 
> 标签：http, udp

这可能是一个愚蠢的问题：

*   HTTP 是否曾经使用过用户数据报协议？

**例如：**

> 如果使用 HTTP 流式传输 MP3 或视频，它是否在内部使用 UDP 进行传输？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2008-11-27T10:16:19.620

来自[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt)：

> HTTP 通信通常通过 TCP/IP 连接进行。默认端口是 TCP 80，但也可以使用其他端口。这并不排除 HTTP 在 Internet 或其他网络上的任何其他协议之上实现。HTTP 只假定可靠的传输；可以使用任何提供此类保证的协议；HTTP/1.1 请求和响应结构到相关协议的传输数据单元的映射超出了本规范的范围。

因此，尽管没有明确说明，但未使用 UDP，因为它不是“可靠传输”。

**编辑**- 最近，QUIC 协议（更严格地说是一种伪传输或会话层协议）确实使用 UDP 来承载 HTTP/2.0 流量，并且 Google 的大部分流量已经使用该协议。它目前正朝着标准化的方向发展，如[HTTP/3](https://datatracker.ietf.org/doc/html/draft-ietf-quic-http)。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-11-27T10:00:36.597

通常，没有。

流很少在 HTTP 本身上使用，HTTP 很少在 UDP 上运行。但是，请参见[RTP](http://en.wikipedia.org/wiki/Real-time_Transport_Protocol)。

对于您的示例（在评论中），您没有显示资源的协议。如果该协议是 HTTP，那么我不会将访问称为“流式传输”；即使它在某种意义上是因为它通过网络连续发送（可能很大）资源。通常，资源会在播放之前保存到本地磁盘，因此网络传输不是通常所说的“流式传输”。

不过，正如评论者所指出的那样，确实可以通过 HTTP 进行流式传输，并且这是由一些人完成的。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-11-27T10:07:08.470

也许只是一些琐事，但 UPnP 将使用 UDP 上的 HTTP 格式消息进行设备发现。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-11-06T17:49:20.490

当然，它不一定必须通过 TCP 传输。我在 UDP 之上实现了 HTTP，用于卫星电视广播行业。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2013-02-09T15:04:35.030

是的，HTTP 作为一种应用协议，可以通过 UDP 传输协议进行传输。以下是一些使用 UDP 和底层协议来传输 HTTP 数据并将其流式传输给最终用户的服务：

*   XMPP 的 Jingle Raw UDP 传输方法
*   使用 UDT 的服务编号 --- 基于 UDP 的数据传输协议，它是 UDP 协议的超集。
*   封装 HTTP 的传输层安全 (TLS) 协议以及上述 XMPP 和其他应用程序协议确实有一个在其传输层中使用 UDP 的实现；这种实现称为数据报传输层安全性 (DTLS)。
*   GNUTella 中的推送通知是通过 UDP 传输发送的 HTTP 请求。

本文包含有关 UDP 流传输及其可靠超集 RUDP：[可靠 UDP (RUDP)：下一个大流传输协议？](http://www.streamingmedia.com/Articles/Editorial/Featured-Articles/Reliable-UDP-%28RUDP%29-The-Next-Big-Streaming-Protocol-85316.aspx)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-27T10:11:49.520

如果您正在流式传输不一定通过 HTTP 的 mp3 或视频，事实上，如果是这样的话，我会感到惊讶。它可能是 TCP 上的另一种协议，但我看不出为什么不能通过 UDP 流式传输。

如果你这样做，你必须考虑到你的数据是否会到达另一端，但我可以认为你知道 UDP。

要回答您的问题，不，HTTP 不使用 UDP。不过，对于您所说的，mp3/视频流可以通过 UDP 发生，我认为永远不应该通过 HTTP 发生。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-04-29T21:07:16.193

[也许QUIC](http://en.wikipedia.org/wiki/QUIC)会在这个话题上有所改变

> QUIC（Quick UDP Internet Connections，发音为 quick）是 Google 开发并于 2013 年实施的实验性传输层网络协议。QUIC 通过用户数据报协议 (UDP) 支持两个端点之间的一组多路复用连接，旨在提供安全保护等效于 TLS/SSL，同时减少了连接和传输延迟，以及每个方向的带宽估计以避免拥塞。QUIC 的主要目标是优化当前使用 TCP 的面向连接的 Web 应用程序。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-09-03T00:28:26.057

我认为有些答案遗漏了重要的一点。UDP 和 TCP 之间的选择不应*基于*数据的类型（例如，音频或视频）或应用程序是否在传输完成之前开始播放（“流式传输”），而应基于是否是*实时的*。实时数据（根据定义）对延迟敏感，因此通常最好通过 RTP/UDP（基于 UDP 的实时协议）发送。

延迟不是来自文件的存储数据的问题，即使它是音频和/或视频，所以它可能最好通过 TCP 发送，以便可以纠正任何数据包丢失。发送方可以提前读取并保持网络管道满，接收方也可以使用大量播放缓冲，因此它不会被偶尔的 TCP 重新传输或暂时的网络减速而中断。限制情况是在播放开始之前传输整个记录。这消除了播放停止的任何风险，但通常是不切实际的。

实时数据的 TCP 问题不在于重传，而是过度缓冲，因为 TCP 试图尽可能有效地使用管道而不考虑延迟。UDP 保留了应用程序包的边界并且没有内部存储，因此它不会引入任何延迟。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-12-05T23:23:59.773

**答案：**是的

**原因：**参见 OSI 模型。

**解释：**

HTTP 是一种应用层协议，它可以封装在使用 UDP 的协议中，提供比 TCP 更快的可靠通信。服务器守护进程和客户端显然需要支持这个新协议。Quake 2 协议证明 UDP 可以在 TCP 上使用，为确保流量控制的结构化通信系统（例如块 ID）提供基础。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-01-09T16:37:24.400

（这是一个老问题，但值得更新答案。）

[HTTP/3 很可能](https://daniel.haxx.se/blog/tag/http3/)会使用[QUIC 协议](https://datatracker.ietf.org/doc/html/draft-ietf-quic-transport-17)，该协议被描述为

> 基于 UDP 的多路复用传输

因此，[*从某种角度来看*](https://www.youtube.com/watch?v=P2PtoWbNsaI)，您可以说 HTTP/3 将使用 UDP。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-10-28T08:35:21.343

尝试使用 node-httpp 在 UDP 上运行 HTTP：

[https://github.com/InstantWebP2P/node-httpp](https://github.com/InstantWebP2P/node-httpp)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-11-01T20:25:05.840

http over udp 被一些 torrent 跟踪器实现使用（并且所有主要客户端的 supporteb）

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-09-10T12:41:11.817

理论上是的，可以将 UDP 用于 http，但这可能会有问题。例如，在您的示例中，正在流式传输 mp3 或视频，将会出现排序问题，并且由于 UDP 不是面向连接的，因此某些位可能会丢失，因此没有重传机制。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-12-27T16:30:21.650

UDP 是流式传输的最佳协议，因为它不需要 TCP 等丢失的包。如果它不提出要求，流程会更快，而且没有任何缓冲。

甚至流延迟也小于 TCP。这是因为 TCP（作为一种更安全的协议）要求丢失的包，覆盖现有的包。

因此，TCP 是一种过于先进的协议，无法用于流式传输。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-30T03:16:50.910

HTTP/3（又名 QUIC）使用 UDP 而不是 TCP。

[https://http3-explained.haxx.se/en/the-protocol/feature-udp](https://http3-explained.haxx.se/en/the-protocol/feature-udp)

# c++ - 将 HTML 导出为 PDF（C++、Windows）

> ID：323354
> 
> 赞同：5
> 
> 时间：2008-11-27T09:59:57.017
> 
> 标签：c++, winapi, pdf, pdf-generation

我正在寻找一个可再发行组件来将 HTML 转换为 PDF。

我现在 - 想避免使用“PDF 打印机”，因为这需要安装打印机，并且某些用户在打印机面板中“玩弄”可能会破坏该功能。

HTML 可用于浏览器控件或作为外部文件。HTML 通常相当简单，但客户可以创建自己的模板，因此应该支持“良好范围”的 HTML。

应该可以从 C++ 访问自动化进程 - DLL / COM / 具有命令行支持的外部可执行文件都很好。

商业很好，但现在成千上万不是一个选择。

那么，您知道或可以推荐哪些组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T17:44:13.883

[PDFCreator](http://sourceforge.net/projects/pdfcreator/)可以用作虚拟打印机，但也可以通过 COM 使用。默认设置甚至包括 COM 示例。

您可以在这里查看 SourceForge SVN 存储库中的 COM 示例：http: [//pdfcreator.svn.sourceforge.net/viewvc/pdfcreator/trunk/COM/](http://pdfcreator.svn.sourceforge.net/viewvc/pdfcreator/trunk/COM/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T17:22:28.293

如果您安装了 Microsoft Word，我想您可以使用可以从 Microsoft Office 站点下载的“另存为 pdf”插件来自动化整个过程。

您将自动执行 word，然后在 word 中打开 HTML 文档，然后输出为 PDF。如果您在 Microsoft 环境中开发，可能值得一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-06T12:23:04.803

如果您更喜欢使用 Aspose.Words，该 API 允许您将 HTML 导出为 PDF，而无需任何 PDF 打印机或 Microsoft Office 依赖项。您可以访问以下链接以获取工作示例。

[https://kb.aspose.com/words/cpp/how-to-convert-html-to-pdf-using-cpp/](https://kb.aspose.com/words/cpp/how-to-convert-html-to-pdf-using-cpp/)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-11-27T10:06:46.597

您可能想看看[**PDFReactor**](http://www.realobjects.com/PDFreactor.808.0.html)

# ruby-on-rails - 为什么 Test::Unit 测试用例启动如此缓慢？

> ID：323363
> 
> 赞同：1
> 
> 时间：2008-11-27T10:01:07.810
> 
> 标签：ruby-on-rails, ruby, unit-testing, testunit

```
>rails -v
Rails 1.2.6

>ruby -v
ruby 1.8.6 (2007-03-13 patchlevel 0) [i386-mswin32] 
```

当我像这样运行测试夹具（测试 Rails 模型类）时，开始执行这些测试需要 20-30 秒（显示“加载的套件...”）。是什么赋予了？

```
>ruby test\unit\category_test.rb

require File.dirname(__FILE__) + '/../test_helper'

class CategoryTest < Test::Unit::TestCase
    def setup
        Category.delete_all
    end
    def test_create
        obCategoryEntry = Category.new({:name=>'Apparel'})
        assert obCategoryEntry.save, obCategoryEntry.errors.full_messages.join(', ')
        assert_equal 1, Category.count

        assert_not_nil Category.find(:all, :conditions=>"name='Apparel'")
    end
    #.. 1 more test here
end 
```

这是使用没有固定装置的 MySql DB 的 Rails。这次它的启动时间为 30 秒以上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T13:13:38.580

看看这个[Rails 测试服务器](http://roman.flucti.com/a-test-server-for-rails-applications)。

作者的一段话：

> “每次在 Rails 应用程序中运行测试时，整个环境都会被加载，包括在两次连续运行之间不会发生变化的库。这可能需要相当长的时间。如果我们可以加载一次环境，并且只加载一次呢？在每次运行之前重新加载变化的部分？介绍 RailsTestServing。
> 
> 使用 RailsTestServing，单个测试文件的运行时间在我的计算机上从 8 秒下降到 0.2 秒。这是 40 倍的速度提升。现在，在 TextMate 中点击 ⌘R 之前，我不会三思而后行。感觉很自由！”

（上周我在[Rails Envy 播客上发现了这个。）](http://www.railsenvy.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T11:02:53.380

在开始任何测试时，Rails 首先加载您拥有的所有夹具（在 test/fixtures 中）并使用它们重新创建数据库。

不过， 20-30 秒听起来*很*慢。在您的测试运行之前，您是否需要加载很多固定装置，或者您的数据库运行缓慢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T15:39:31.727

Ruby 的*gem*工具遵循一个路径发现算法，显然，它对 Windows（正如我从您的 中看到的`ruby -v`）不友好。

[例如，如果您跟踪使用ProcMon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)加载的 Rails 应用程序，您可以获得清晰的画面。Every（我的意思是*every*）`require`开始扫描 Ruby 路径中的所有目录以及所有 gem 目录。一个典型`require`的在一台普通机器上需要 20 毫秒。由于 Rails 会产生数百个`require`s，因此每次启动 Rails 环境时，这 20 毫秒的时间很容易总计为几秒。花点时间初始化数据库中的固定装置，您就会更好地了解为什么开始运行测试用例需要这么多时间。

也许是因为每个文件系统架构和实现（路径缓存等），这在 Linux 中的问题比在 Windows 中要小。不过，我不知道你该怪谁。看起来 NTFS 文件系统可以通过更好的路径缓存实现来改进，但显然*gem*工具可以实现缓存本身并且其性能不太依赖于平台。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T14:00:08.500

你的 test_helper.rb 是什么样子的？你在使用实例化的固定装置吗？

```
self.use_instantiated_fixtures  = true 
```

[编辑]

如果将其设置为 true，请尝试将其设置为 false。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T17:55:06.560

在黑暗中完成拍摄，但大多数时候我看到的东西启动时间很长，这通常是由于某种反向 DNS 查找发生在某处的一些 TCP 套接字通信。

尝试添加：

```
require 'socket'
Socket.do_not_reverse_lookup = true 
```

在您的另一`require`行之后的测试文件的顶部。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-27T10:11:03.407

似乎 Test::Unit 是使用 Ruby 进行单元测试的最简单但也是最慢的方法之一。[ZenTest](http://rubyforge.org/projects/zentest/)是一种替代方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-27T10:42:09.617

测试单元的启动并不是特别慢，而且远不及 20 秒。

```
(11:39) ~/tmp $ cat test_unit.rb 
require 'test/unit'
class MyTest < Test::Unit::TestCase
  def test_test
    assert_equal("this", "that")
  end
end

(11:39) ~/tmp $ time ruby test_unit.rb 
Loaded suite test_unit
Started
F
Finished in 0.007338 seconds.

  1) Failure:
test_test(MyTest) [test_unit.rb:4]:
<"this"> expected but was
<"that">.

1 tests, 1 assertions, 1 failures, 0 errors

real    0m0.041s
user    0m0.027s
sys     0m0.012s 
```

这可能是您在测试中正在做的事情。你在做复杂的事情吗？设置数据库？从互联网上检索东西？

# validation - 是否可以使用 '/>' 使 BEA Portal 9.2 关闭链接和元标记，使其对 XHTML 有效？

> ID：323367
> 
> 赞同：1
> 
> 时间：2008-11-27T10:03:14.327
> 
> 标签：validation, xhtml, standards-compliance, bea

我正在尝试使 BEA Portal 网站与 XHTML 兼容，因为这已写在与客户的合同中，而我被困在这个问题上：BEA 渲染`<meta>`和`<link>`标记没有右斜线，即`<link/>`它`<meta/>`是由XHTML。

当我查看 BEA 的文档时，似乎应该可以使用右斜杠渲染标签：[skin.properties 文件 (edocs.bea.com)](http://edocs.bea.com/wlp/docs81/lookandfeel/lookandfeel.html#999045)。

是否可以使用配置指令更改重编？或者，也许是为了挂钩底层的重新渲染方法以便我可以修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T10:14:01.093

尝试将标记重写过滤器实现为反向代理中的重写规则或过滤器 servlet。不建议在门户网站本身中寻找答案...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T10:48:42.007

对于不使用 XML 序列化程序的软件，XHTML 毫无意义（请参阅关于 XHTML 的许多其他关于 SO 的问题）。

如果你想让页面更符合标准，我建议瞄准 HTML4.01 Strict 或 HTML5（当然用 CSS 进行布局——这不是 XHTML 特定的东西）。

# multithreading - 如何在win32 中获取线程的当前状态（例如阻塞、挂起、运行等）？

> ID：323370
> 
> 赞同：1
> 
> 时间：2008-11-27T10:04:39.567
> 
> 标签：multithreading, winapi, internals, thread-state

我找不到产生此信息的文档化 API。

一位朋友建议我使用 NtQuerySystemInformation。查找后，信息就在那里（参见[SYSTEM_THREAD](http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/System%20Information/Structures/SYSTEM_THREAD.html)），但它没有记录，而且不是很优雅——我得到了系统中所有线程的信息。

你知道一个更优雅、最好有文档的 API 来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-08T23:22:30.697

除了使用`NtQuerySystemInformation`. 然而，它可能不那么复杂，这是真的，但微软缺乏实现。

我在这里发布了一个使用非常优雅的工作类：

[如何获取线程状态（例如挂起）、内存 + CPU 使用率、开始时间、优先级等](https://stackoverflow.com/questions/22949725/how-to-get-thread-state-e-g-suspended-memory-cpu-usage-start-time-priori)

# asp.net - ASP.NET 网络邮件引擎

> ID：323371
> 
> 赞同：0
> 
> 时间：2008-11-27T10:04:46.180
> 
> 标签：asp.net

今天我的一个朋友问我是否有任何开源或商业可用的 Webmail/电子邮件“引擎”。当我问她引擎是什么意思时，我得到了她老板要求的功能列表——

*   用于登录和访问电子邮件的 Web 界面
*   能够使用 Web 界面发送/接收/转发电子邮件
*   能够使用 Web 界面撰写和保存草稿
*   能够使用 Web 界面删除电子邮件、清空已删除项目文件夹
*   能够搜索电子邮件（按发件人的电子邮件、主题、内容）
*   使用 Web 界面维护和管理联系人列表（电子邮件地址）
*   允许用户将他们的电子邮件与 iPhone/Windows Mobile 智能手机同步

我发现[SharpWebMail](http://anmar.eu.org/projects/sharpwebmail/)有一些功能，虽然它最近没有更新，最后一次更新是在 2006 年 4 月。我倾向于使用 ASP.NET，建议主要是使用电子邮件结合Intranet（在 ASP.NET 中开发）。如果您有任何建议，请让我知道。

印地

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T10:08:36.640

有

*   gmail [http://www.google.com/mail](http://www.google.com/mail)
*   Outlook Exchange 与 Webmail [http://www.microsoft.com/EXCHANGE/default.mspx](http://www.microsoft.com/EXCHANGE/default.mspx)
*   雅虎邮箱等
*   [http://www.eudora.com/](http://www.eudora.com)
*   [http://www.bynari.net/products/server/products.html](http://www.bynari.net/products/server/products.html)
*   [http://atmail.com/](http://atmail.com)

尝试谷歌“带有网络客户端的邮件服务器”或类似的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T10:14:05.647

我会为网络部分使用 gmail 应用程序：[http ://www.google.com/apps/intl/en/business/index.html](http://www.google.com/apps/intl/en/business/index.html)

出色的网络界面，您可以拥有 user.name@yourdomain.com 形式的地址（不仅仅是@gmail.com）

它具有移动支持，如果您需要使用桌面软件进行同步等，它还允许使用 pop 或 imap 使用其他客户端。

# xaml - 在 Expression Blend UI 中更改线性渐变画笔的起点/终点

> ID：323389
> 
> 赞同：0
> 
> 时间：2008-11-27T10:12:25.823
> 
> 标签：xaml, expression-blend, lineargradientbrush

看起来很简单，但我无法在帮助或在线中找到它。

我知道如何更改 XAML 以设置 LinearGradient 画笔的 StartPoint 和 EndPoint，但我不知道您是如何使用 Expression Blend 中的 IDE 执行此操作的 - 有人知道您用来执行此操作的键盘/鼠标操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T00:52:35.777

1.  在艺术窗格中选择要修改的对象
2.  在画笔属性组中选择要修改的画笔
3.  选择左侧的画笔变换工具（它是从上数第 7 个的箭头）。
4.  拖动箭头头和箭头尾来修改起点和终点。

# visual-studio - 是否有用于在已处理/未处理的异常上切换中断的 Visual Studio 快捷方式/宏？

> ID：323390
> 
> 赞同：2
> 
> 时间：2008-11-27T10:12:48.880
> 
> 标签：visual-studio, debugging, macros

我一直在尝试编写一个宏做相当于

1.  按 Ctrl+Alt+E 调出异常窗口
2.  切换“公共语言运行时异常”的“抛出”列中的文本框
3.  打好

如果我记录这个，它只记录一行不做任何事情的宏代码。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-12-02T23:03:32.333

已经很晚了，我还没有测试过，但这有帮助吗？

```
 Dim dbg As EnvDTE90.Debugger3 = DTE.Debugger
    Dim exSettings As EnvDTE90.ExceptionSettings = dbg.ExceptionGroups.Item("Common Language Runtime Exceptions")
    Dim exSetting As EnvDTE90.ExceptionSetting = exSettings.Item("System.Data")

    If exSetting.BreakWhenThrown Then
        exSettings.SetBreakWhenThrown(False, exSetting)
    Else
        exSettings.SetBreakWhenThrown(True, exSetting)
    End If 
```

# windows - Win XP msvcrt 崩溃

> ID：323391
> 
> 赞同：-1
> 
> 时间：2008-11-27T10:12:51.437
> 
> 标签：windows, windows-vista, windows-xp, visual-c++-6, msvcrt

有谁知道为什么总是在 Windows XP 上运行的应用程序现在突然崩溃 msvcrt.dll？

对线程类只有很小的改动，这是在 VC++ 6 中的 Vista 下完成的。

为了使我们所有的库正常工作，我们动态链接到 MFC dll。

较新版本的 msvcrt 不能解决问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T10:16:08.997

这不是很有帮助，但到目前为止，最可能的原因是您的应用程序中有一个错误，无论出于何种原因，该错误以前没有出现。某处发生了一些变化，现在出现了错误。你只需要调试它。

作为一般规则，仅仅因为某些东西似乎有效并不意味着它是正确的，可悲的是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T05:46:22.283

您可能会遇到一个问题，即您无意中同时升级了运行时（这是我遇到的问题） [，由于策略而自动升级运行时的版本](https://stackoverflow.com/questions/397196/why-does-windows-side-by-side-winsxs-install-policy-for-auto-upgrade-when-there)

您应该检查您是否正在使用您认为自己使用的库。Process Explorer（可从 sysinternals 下载）应该能够帮助您解决这个问题。

# asp.net - 文件路径作为 MVC 路由参数

> ID：323397
> 
> 赞同：18
> 
> 时间：2008-11-27T10:14:49.140
> 
> 标签：asp.net, asp.net-mvc, routing

我的应用程序的一部分将存储在多个位置的资源映射到 Web URL，如下所示：

```
http://servername/files/path/to/my/resource/ 
```

资源位置是根据文件路径建模的，因此可以有无限的嵌套级别。是否可以构造一个匹配这个的 MVC 路由，以便我将整个路径传递到我的控制器中？可以是单个字符串，也可以是 params 样式的字符串数组。

我想这需要匹配 files 关键字，然后是某种通配符。虽然我不知道 MVC 是否支持这一点。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-27T10:53:04.337

像这样的路线

```
"Files/{*path}" 
```

将路径作为单个字符串。将其`*`指定为通配符映射，它将在`"Files/"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-28T07:59:35.420

有关 ASP.NET 的路由功能的更多信息，请参阅 MSDN：

[http://msdn.microsoft.com/en-us/library/cc668201.aspx](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

对于您要使用的“包罗万象”参数，请参阅“处理可变数量的段”下的部分。

# cocoa - 使用 Cocoa 在 Finder 中将文件夹挂载为设备

> ID：323403
> 
> 赞同：1
> 
> 时间：2008-11-27T10:18:01.957
> 
> 标签：cocoa, macos, applescript

有没有办法将硬盘上的文件夹作为 Finder 中的设备挂载。这里的目的是为用户提供一种简单的方法来访问我的应用程序用来存储数据的文件夹。我不希望我的用户在应用程序数据中搜索数据。我宁愿让他们在 Finder 中将这些数据作为已安装的卷或设备提供。我还希望这个卷或设备可以读/写，这样如果用户对数据文件进行任何更改，更改将反映在原始文件夹中。

有没有办法在可可、碳或苹果脚本中做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T10:56:12.613

尝试查看 FUSE。你可以拥有各种伪文件系统。

但我会提醒您注意您正在尝试做的事情。在您的应用程序中只使用一个打开文件夹的按钮可能更有意义，而不是创建一个新设备。我个人会发现很难继续使用执行此类操作的应用程序。它并不真正适合其他可用的应用程序。

您还可以使用别名来指向您的应用程序数据目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T17:21:08.717

我可以建议完全重新考虑这一点吗？符号链接或别名会起作用，但如果可能，更好的主意是注册人们将移入该文件夹的文件类型，然后通过将它们移动或复制到正确的文件夹来响应打开它们。我正在考虑类似仪表板界面的东西，如果您双击下载的 .wdgt 文件，它会询问您是否要“安装”小部件，然后，如果您愿意，请将其复制到 ~/Library/Widgets。显然，如果您处理的是图像、文件夹或通用文本文件等常见类型，这可能是不切实际的。

为了实现，您只需将文档类型添加到您的 Info.plist，并在您的 App Delegate 的 -application:openFile: 方法中处理它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T12:47:50.720

您可以使用稀疏磁盘映像来创建“假”驱动器。

但是为什么不在你的应用程序中配置数据目录呢？或者使用子目录`~/Documents/`？

桌面上的别名/符号链接将是最简单的解决方案：

```
ln -s '~/Application Data/Yourapp' '~/Desktop/Yourapp Data' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T12:47:50.203

我还敦促对此保持谨慎，这对大多数用户来说似乎有些混乱。也就是说，您是否考虑过简单地创建一个指向相关目录的软链接？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-02T15:00:03.050

我使用 NSWorkspace 来做。就我而言，我使用函数 -(BOOL)isMountedPath; 进行了初步检查。

安装代码为：

```
 NSURL *path=[NSURL URLWithString:@"smb://server.resource/KEYS_DB"];
    if(NO==[self isMountedPath:[path absoluteString]])
    {
        NSWorkspace *ws=[NSWorkspace sharedWorkspace];
        [ws openURL:path];
    } 
```

检查路径是否已挂载的代码是：

```
-(BOOL)isMountedPath:(NSString *)share
{
    NSArray * keys = @[NSURLVolumeURLForRemountingKey];
    NSArray * mountPaths = [[NSFileManager defaultManager] mountedVolumeURLsIncludingResourceValuesForKeys:keys options:0];

    NSError * error;
    NSURL * remount;

    for (NSURL * mountPath in mountPaths) {
        [mountPath getResourceValue:&remount forKey:NSURLVolumeURLForRemountingKey error:&error];
        if(remount){
            if ([[[NSURL URLWithString:share] host] isEqualToString:[remount host]] && [[[NSURL URLWithString:share] path] isEqualToString:[remount path]])
            {
                printf("Already mounted at %s\n", [[mountPath path] UTF8String]);
                return YES;
            }
        }
    }
    return NO;
} 
```

其他可能有用的方法是：

```
-(NSString *)mountedPath:(NSString *)share
{
    NSArray * keys = @[NSURLVolumeURLForRemountingKey];
    NSArray * mountPaths = [[NSFileManager defaultManager] mountedVolumeURLsIncludingResourceValuesForKeys:keys options:0];

    NSError * error;
    NSURL * remount;

    for (NSURL * mountPath in mountPaths) {
        [mountPath getResourceValue:&remount forKey:NSURLVolumeURLForRemountingKey error:&error];
        if(remount){
            if ([[[NSURL URLWithString:share] host] isEqualToString:[remount host]] && [[[NSURL URLWithString:share] path] isEqualToString:[remount path]])
            {
                printf("Already mounted at %s\n", [[mountPath path] UTF8String]);
                return [mountPath path];
            }
        }
    }
    return nil;
} 
```

# linux - 带有 Linux 的 AD 组的 Subversion？

> ID：323405
> 
> 赞同：1
> 
> 时间：2008-11-27T10:19:24.000
> 
> 标签：linux, svn, ubuntu, active-directory, ldap

我尝试将 Windows SVN 服务器迁移到 Linux。
我已将 Apache 配置为针对 AD 验证用户访问权限，因此只有 AD 用户可以登录。
现在我必须为带有 authz 文件的存储库设置权限。
当我使用 AD 用户名设置权限时，它可以工作，但 AD 组却不能。

authz 文件如下所示：

```
[test:/]
user1=rw   #That works

[test2:/]
@usergroup=rw  #No access for the groupmembers 
```

当我在 authz 文件中创建组并分配 AD 用户时，该内部组工作正常，但我无法在 2 个位置管理组，每天都会进行很多更改。

有谁知道如何在 authz 文件中使用 AD 组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T11:47:14.577

您可以使用 sync_ldap_groups_to_svn_authz.py 在 authz 文件中获取 AD 组。您可以在 bitbucket 获得它。

[https://bitbucket.org/whitlockjc/jw-tools/src/e3396390e99bfbc566a4e8423a123abb4c00d655/sync_ldap_groups_to_svn_authz?at=default](https://bitbucket.org/whitlockjc/jw-tools/src/e3396390e99bfbc566a4e8423a123abb4c00d655/sync_ldap_groups_to_svn_authz?at=default)

使用示例：

```
 python ./sync_ldap_groups_to_svn_authz.py \
-d "CN=access-TO-AD-user,OU=Users,OU=SiteName,OU=Europe,OU=St,DC=domainname,DC=com" \
  -l "ldap://adserver.domainname.com:389" \ 
-b "OU=Groups,OU=SiiteName,OU=Europe,OU=St,DC=domainname,DC=com" \
-u "objectClass=person"  -g "(&(objectClass=group)(cn=UniqueStringBeforSVN*))" \ 
-i "sAMAccountName" > ldaptest.txt 
```

"\" 是我的 linebrake 标记，因为这样更容易阅读示例，请确保您将其全部写在一行中！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T10:35:13.560

您不能在 authz 文件中自动使用 AD 组。

一个可能的解决方案是编写一个脚本，查询组及其成员用户的 AD，并编写正确的 authz 文件，同时定义组本身。

最终的输出应该是这样的：

```
[groups]
usergroup = user1, user2, user3

[test:/]
user1 = rw

[test2:/]
usergroup = rw 
```

# c++ - Escape(\) 字符背后的魔力是什么

> ID：323407
> 
> 赞同：6
> 
> 时间：2008-11-27T10:20:00.033
> 
> 标签：c++, c, compiler-construction, escaping, backslash

C/C++ 编译器如何操作源代码中的转义字符["\"]？如何编写用于处理该字符的编译器语法？遇到该字符后编译器会做什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-27T10:27:48.943

大多数编译器分为几个部分：编译器前端称为[词法分析器](http://en.wikipedia.org/wiki/Lexical_analyzer)或扫描器。编译器的这一部分读取实际字符并创建标记。它有一个状态机，当看到转义字符时，它会决定它是真实的（例如，当它出现在字符串中时）还是修改下一个字符。标记相应地作为转义字符或其他标记（例如制表符或换行符）输出到编译器的下一部分（[解析器](http://en.wikipedia.org/wiki/Parser)）。状态机可以将几个字符组合成一个令牌。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-27T20:28:53.677

关于这个主题的一个有趣的注释是[On Trusting Trust [PDF 链接]](http://www.ece.cmu.edu/~ganger/712.fall02/papers/p761-thompson.pdf)。

该论文描述了编译器可以准确处理此问题的一种方法，显示了 c-written-in-c 编译器如何没有将代码显式转换为 ASCII 值；以及如何将新的转义代码引导到编译器中，以便对新代码的 ASCII 值的理解也是隐含的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T11:06:20.533

它通常会转义以下字符：

*   在字符串文字或字符文字中，它意味着转义下一个字符。`\a`表示“警报”（闪烁终端，哔哔声或其他），`\n`表示“换行”，`\xNUM`例如表示十六进制数。
*   如果它作为换行符之前的最后一个可见字符出现，无论是否在字符串中（甚至在行宽注释中！），它都充当换行符：以下换行符被忽略，下一行是与当前行合并。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T10:50:05.433

带有后续字符（如`\n`）的转义字符是 C 编译器的单个字符 - 扫描器将其作为字符标记呈现给解析器，因此解析器中不需要特殊的语法规则来处理转义字符。

# .net - 有没有一种方法可以检查 ADO.NET 方法生成的 SQL 而无需使用 DB 跟踪/分析？

> ID：323408
> 
> 赞同：1
> 
> 时间：2008-11-27T10:20:02.967
> 
> 标签：.net, ado.net

我想测试应用程序 A（旧版）和应用程序 B（当前）是否正在向数据库发送相同的 SQL。有没有一种简单的方法来检查生成的 SQL？

我不太关心细微的语法差异。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-27T10:30:58.437

我怀疑追踪是最可靠的选择。有些东西（如 LINQ-to-SQL）允许查询日志记录，但肯定不是全部。但是你有更多的安全性，一个痕迹会抓住一切。

请注意，“细微的语法差异”当然会让比较非常痛苦

# bug-tracking - 布吉拉还是螳螂？

> ID：323411
> 
> 赞同：58
> 
> 时间：2008-11-27T10:22:58.797
> 
> 标签：bug-tracking, project-planning, bugzilla, mantis

正如标题所说，我现在正在启动一个项目，并尝试为项目布局基础设施（SVN、电子邮件、错误跟踪、在线论坛等......）

那么，Bugzilla 还是 Mantis？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-27T11:43:23.017

我想你会发现你的团队更喜欢 Trac 或 Redmine，而不是 Bugzilla 或 Mantis。两者都很好地与 Subversion 集成。两者都包括 wiki、论坛、项目管理功能......

快速概览：

**Trac**：非常广泛使用和喜爱，用 python 编写，庞大的社区，许多“插件”。一个常见的抱怨是它不支持开箱即用的多个项目，但您可以添加一个插件来帮助解决这个问题。

**Redmine**：用 RubyOnRails 编写。像 Trac，但开箱即用更完整。Redmine 的作者正在尝试创建比 Trac 更好的 Trac。

如果您对其他搜索错误跟踪器的人所写的内容感兴趣，将跟踪器相互比较，我在这里放置了一些链接：http:
[//ifdefined.com/blog/post/2007/10/Links-to-other -比较问题跟踪器.aspx](http://ifdefined.com/blog/post/2007/10/Links-to-other-comparisons-of-issue-trackers.aspx)

如果你在 Windows 上，我猜你不是，那么还要考虑 BugTracker.NET，一个易于使用、非常可配置的 .NET/MS SQL Server 中的[错误跟踪](http://ifdefined.com/bugtrackernet.html)系统。（免责声明：我是作者）。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-27T14:23:41.963

我使用过 Bugzilla 和 Mantis，但我更喜欢 Mantis 的简单性。它不像 Bugzilla 那样功能丰富，但我记得与 Bugzilla 的战斗更多。螳螂是一种你可以设置一次然后离开的东西。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-11-27T10:33:35.000

我喜欢螳螂。这很简单，它可以完成工作。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-02-03T01:14:19.040

Mantis definitely wins on usability grounds over Bugzilla.

In particular, it is just a lot faster to log bugs on Mantis. Time to log bugs is a blocker for some people - I've heard it used as an excuse for not logging them, fixing them and pretending there was never a bug to fix (symptomatic of deeper team problems).

It wasn't until a client (currently using Basecamp, bleah!) canned the idea of Mantis because it wasn't pretty enough that I realised some people (as noted above) think it is ugly.

Compared to Bugzilla or another system we tried implementing, some weird European thing, Mantis is gorgeous.

I know Mantis scales well - a friend used it for the production of the movie Happy Feet. He customised it by adding one extra field to provide another level of categorisation.

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-11-27T10:38:16.627

Bugzilla 更大，社区更大，功能更多，功能更强大……因此，我一直更喜欢 mantis ;) Mantis 像罪恶一样丑陋，但对于大多数项目，它以简单直观的方式为您提供所需的东西。

如果你有一个大团队、一个大 QA 部门和所有其他 bugzillia 可能更适合。只需要完成工作的小团队 - 我认为螳螂可能会更好。

mantis 缺少的最大功能（他们可能已经添加了它，这是几年前的事了）是报告功能，因此您可以使用漂亮的折线图和饼图跟踪进度。但是，我只是编写了一个简单的 PHP 脚本来提取数据并每周在 Excel 中手动创建它们（只花了 5 分钟左右）。不是很好，但功能足以满足我们当时的需要。

但是，两者都有在线演示，所以我建议您尝试一下并选择最适合您的。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-12-31T17:34:00.827

**螳螂很棒而且很容易设置**

我已经使用了大约 3 年

它有以下问题。

您可以在 issue 中存储的文件大小有 2 Meg 的限制。当您想要包含问题的屏幕截图时，这会成为一个问题。

如果两个人同时更新问题 - 有人会丢失数据

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-27T10:34:06.620

我两个都用过，完全不喜欢，我更喜欢[Trac](http://trac.edgewall.org/)，如果你真的需要在这两者之间做出选择，我会选择 Bugzilla TRAC 与 subversion 的集成非常好（看看[Assembla](http://www.assembla.com/)看看集成是如何工作的）

Trac 也是开源的，添加新报告和类似的东西非常简单。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-08-10T08:35:53.433

Mantis 伟大而简单，简单很重要，因为我的客户是非技术人员。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-03T00:39:28.690

我更喜欢螳螂。它性能很好，并且可以通过使用插件或通过编码轻松扩展。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-12-11T12:14:23.463

我已经广泛使用了 Bugzilla（工作项目的默认设置），但 Mantis 获得了我的支持，因为它易于设置和使用。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-11-27T10:30:35.130

你可以试试[Redmine](http://redmine.org)。它为您提供了 repo 访问、跟踪器、论坛、wiki、日历 - 在一个地方。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-01-13T18:17:56.377

我听说过关于fogbugz 的好消息，但还没有找到使用它的机会。 [http://www.fogcreek.com/FogBUGZ/](http://www.fogcreek.com/FogBUGZ/)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-11-27T14:17:15.843

对 Trac 的另一票 - 非常容易上手，基于 Web 的漂亮视图进入您的存储库，等等。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-01T18:03:00.533

选择正确的错误跟踪器需要您知道谁将使用它（以及如何使用它）。我使用过 Bugzilla 和 Mantis，发现从技术角度来看 Bugzilla 更好，但如果你的一些错误报告者不是程序员/不是程序员，Mantis 会赢。它的界面对于新手 bugtracker 用户来说不那么“威胁”。

如果您打算拥有一个私人 bugtracker，您还需要考虑它为您提供的选项，以指定允许查看/编辑的人员等。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-10-27T15:14:33.797

我使用 bugzilla 有一段时间了，但 Redmine 得到了我的投票。设置简单，非常直观。

# .net - 在 SQL Server 和 .NET 代码 +LINQ 之间处理非常大的字符串

> ID：323413
> 
> 赞同：3
> 
> 时间：2008-11-27T10:23:32.117
> 
> 标签：.net, sql-server, linq, string

我有一个应用程序需要处理 SQL Server 数据库和 .NET 代码之间的非常大的字符串。我有一个 LINQ 查询，它在将字符串保存*到*数据库时生成字符串，但是当尝试*从*数据库创建字符串时，由于字符串的大小，应用程序崩溃并出现 OutOfMemoryException。

我必须做些什么来使 LINQ 生成的代码避免这种情况吗？使用某种压缩可能是一种选择，但出于性能原因希望避免这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T10:32:12.553

什么叫“非常大”？什么是字符串？克洛布？斑点？xml？

我怀疑您应该使用类似的东西`ExecuteReader()`，它（通过`IDataReader`）公开了以块的形式读取此类列的方法：

```
 using (var reader = cmd.ExecuteReader(
            CommandBehavior.SequentialAccess)) {
            char[] buffer = new char[8040]; // or some multiple (sql server page size)
            while (reader.Read()) {
                long dataOffset = 0, read;
                while((read = reader.GetChars(colIndex, dataOffset, buffer, 0, buffer.Length)) > 0) {
                    // process "read"-many chars from "buffer"
                    dataOffset += read;
                }
            }
        } 
```

显然，使用 xml 你可能需要一个`XmlReader`via `cmd.ExecuteXmlReader()`。

更新了重新 LINQ 评论（现已删除）：

要`IDataReader`直接从 LINQ-to-SQL 使用，我希望您能得到的最接近的是`ctx.GetCommand()`，向它传递一个查询。然后，您将使用`ExecuteReader`or`ExecuteXmlReader`如上所述。我对EF了解不多...

如果您给出失败查询类型的示例，可能会有一些技巧 - 例如，如果您正在过滤或选择 xml 的子集，则可以在 SQL/XML 中执行某些操作 - 可能在 UDF 中通过 LINQ-to-SQL 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T10:41:17.387

我没有测量字符串的大小，但它们很快就达到了 .Net 的限制。信息以 XML 形式“存储”在 LINQ 查询生成的 XStreamingElement 对象中。我会试一试您的 IDataReader 建议，看看它是否能解决问题。基本上，我正在使用 LINQ to SQL 进行回读，是否有任何钩子可以提供 IDataReader 分块代码？

# winforms - 在您的应用程序中显示菜单的最佳方式是什么？

> ID：323417
> 
> 赞同：1
> 
> 时间：2008-11-27T10:27:19.567
> 
> 标签：winforms, user-interface

您认为在传统 WinForms 应用程序中向用户呈现分层功能列表的最佳方式是什么？（菜单系统 - 假设功能可以分为少量模块和子模块，但就这些子模块而言没有固定的深度）。

您喜欢传统的下拉菜单系统、功能区、停靠的工具栏、树视图方法还是任何其他创新想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T12:26:50.480

在您的设计中要考虑的一个重要事项是[可用性与可发现性](http://haacked.com/archive/2008/11/06/usability-vs-discoverability.aspx)。

*最佳*解决方案很大程度上取决于您的用户是谁。市中心游客信息亭应用程序的 UI 要求与电站控制屏幕的 UI 要求非常不同......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T10:49:21.770

对于最常用的功能，我经常在顶部停靠一个工具条。以及所有其他设置热键的下拉菜单。

如果我有一个可以包含不同类型项目的列表，我会使用底部停靠的工具条，该工具条会根据列表中的选定项目更改其内容。这样我就只有与任务相关的按钮/图标，而不是一堆会刺激视图的禁用按钮。

我还为自动填充与底部工具条相同的选项的项目添加了一个上下文菜单。这样，我提供了一种更快的方式来获得“动作”，而无需将鼠标向下移动到屏幕底部。

我真的很讨厌功能区的东西（作为用户），所以我不会在我的项目中将它用作程序员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T12:06:45.937

在我看来，最好的方法是确保一切都可以通过多种方式完成。

*   菜单
*   键盘快捷键
*   工具箱...

所以用户可以选择它的方式。

我真正喜欢在更多应用程序中看到的是菜单或选项直接附加到用户正在查看的选定项目（控件）。当然，菜单与给定内容相关联。

我已经在我的开源项目[Monex](http://www.monex.si)中实现了这一点，我真的很喜欢自己使用它。看看这个[截图](http://www.monex.si/ENG/screenshots/screenshots.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T10:48:08.450

您总是可以选择越来越多的功能区控件。Microsoft/Office 界面习惯于成为用户对规范的期望（最终）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T11:03:03.787

在我看来，你的问题没有明确的答案。它始终取决于您向用户展示的菜单以及预期使用该应用程序的用户

具有标准/通用功能的菜单可能最好呈现 Office 样式，即下拉菜单或新的功能区样式。具有自定义功能的菜单，当您声明具有不同深度的多个模块和子模块时，通常最好将其呈现为类似 TreeView 的菜单。

从用户的角度来看，典型用户使用标准菜单会做得很好，而更高级的用户不会介意更高级的功能，如键盘导航或隐藏/显示菜单或将其停靠到另一侧的可能性窗户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T15:26:50.167

菜单栏、工具栏和功能区用于命令，其中用户对项目的选择作用于窗口或整个应用程序中显示的数据对象。您使用哪一个主要取决于您的应用程序中的命令数量。

*   仅工具栏：大约 20 个或更少的命令。为每个命令按钮提供图标和文本标签。用分隔符表示层次结构。不超过两个级别——相应地扁平化你的层次结构。

*   带有工具栏的菜单栏：大约 20 多个但少于 1000 个命令。单个菜单上最多 20 个菜单项（使用分隔符）通常比级联菜单更好——相应地扁平化您的层次结构。常用命令应该有加速键。通常将您的工具栏限制为不超过 30 个最常用的命令，主要是命令，否则只能从对话框中访问。考虑*不*为具有加速器的菜单项设置工具栏控件——专家访问的一种好方法通常就足够了。

*   功能区：超过 1000 个命令。功能区只不过是将不同的菜单栏和工具栏放在单独的选项卡上。为了正常工作，与每个选项卡（功能层次结构的顶部）关联的任务应该是非集成的——用户相对很少从一个选项卡切换到另一个选项卡。功能区也倾向于更有效地促进高级功能的发现，但代价是基本功能的可发现性和效率。

检查函数层次结构中的项目是否可以更好地表示为属性而不是命令。命令执行一个过程，例如打开、查找和复制，而属性更改某些东西的特定特征，例如字体、大小和视角。属性由窗口中的字段控件（例如，文本框、复选框和下拉列表）而不是菜单项、工具栏控件或功能区控件设置。

充满此类字段控件（或数据对象的其他表示）的窗口是内容块。树控件可用于控制显示的内容块。与选项卡控件一样，当用户经常在内容块之间切换并且不比较内容块时，它们优于多个窗口。当内容量不适合单行选项卡时，树优于选项卡控件。

树中没有任何空节点。用户单击的任何内容都应显示完整的内容窗格——相应地扁平化您的层次结构，甚至使用列表框而不是树。

If users tend to select one content block, complete a task there, then leave your app, then consider a “home” page displaying a full-page menu of all the content blocks, possibly spatially arrange according to your hierarchy, each accessible with a single click.

# c++ - 计算NLOC的简单脚本？

> ID：323419
> 
> 赞同：6
> 
> 时间：2008-11-27T10:28:08.240
> 
> 标签：c++, c, metrics, lines-of-code

你知道一个简单的脚本来计算 NLOC（netto 代码行数）吗？脚本应该计算 C 代码的行数。它不应该计算空行或仅带有大括号的行。但这也不需要过于精确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-13T21:42:25.363

我会使用**awk** & **cpp** (预处理器) & **wc**来做到这一点。awk 删除所有大括号和空格，预处理器删除所有注释，wc 计算行数：

```
find . -name \*.cpp -o -name \*.h | xargs -n1 cpp -fpreprocessed -P | 
    awk '!/^[{[:space:]}]*$/' | wc -l 
```

如果您想包含评论：

```
find . -name \*.cpp -o -name \*.h | xargs awk '!/^[{[:space:]}]*$/' | wc -l 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T11:35:20.773

在网上查看 NLOC，我发现主要是“未注释的代码行”。
您没有指定是否必须跳过注释...
因此，如果我坚持您当前的信息，那么 Perl 中的以下单行应该可以完成这项工作：

```
perl -pe "s/^\s*[{}]?\s*\n//" Dialog.java | wc -l 
```

我可以扩展它来处理行注释：

```
perl -pe "s#^\s*[{}]?\s*\n|^\s*//.*\n##" Dialog.java | wc -l 
```

也许

```
perl -pe "s#^\s*(?:[{}]?\s*|//.*)\n##" Dialog.java | wc -l 
```

处理块注释稍微有点棘手（我不是 Perl 专家！）。

[编辑] 明白了...第一部分可能会有所改进（更短）。实验很有趣。

```
perl -e "$x = join('', <>); $x =~ s#/\*.*?\*/##gs; print $x" Dialog.java | perl -pe "s#^\s*(?:[{}]?\s*|//.*)\n##" | wc -l 
```

PS.：我使用双引号是因为我在 Windows 上测试过......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T10:33:32.270

查看 Visual Studio 的 DPack 插件。它有任何解决方案/项目的统计报告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T10:40:12.163

不是脚本，但你可以试试这个命令行开源工具：[NLOC](http://sourceforge.net/projects/nloc/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-27T13:14:48.217

[源监视器](http://www.campwoodsw.com/sourcemonitor.html)是免费的源分析软件。它是 Windows 应用程序，但也可以使用命令行中的参数运行。

它可以分析 C++、C、C#、VB.NET、Java、Delphi、Visual Basic (VB6) 或 HTML。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-27T18:51:21.173

[Ohloh](http://www.ohloh.net)提供免费的[Ohcount](http://www.ohloh.net/projects/ohcount)，它计算代码和注释的行数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-13T20:59:48.710

如果注释还可以，标准的 unix 工具就足够了：

```
grep  -x -v "[[:space:]}{]*" files.c  | wc 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-13T21:13:39.307

[SLOCCOunt](http://www.dwheeler.com/sloccount/)不是一个简单的脚本，它的功能远远超出您的需要。但是，它是已经提到的 Ohcount 和 NLOC 的强大替代品。:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-13T21:17:14.730

我通常只是这样做：

```
grep -vc '^$' (my files) 
```

仅当您的空行确实为空（没有空格）时才有效。对我来说足够了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-13T21:59:07.110

[Locmetrics](http://www.locmetrics.com/ "定位学")运行良好。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-13T22:24:50.223

这是一个简单的 Perl 脚本[eLOC.pl](http://gist.github.com/35562)：

```
#!/usr/bin/perl -w
# eLOC - Effective Lines of Code Counter
# JFS (2005)
#
# $ perl eLOC.pl --help
#
use strict;
use warnings;
use sigtrap;
use diagnostics;

use warnings::register;
no warnings __PACKAGE__;
sub DEBUG { 0 }

use English qw( -no_match_vars ) ;  # Avoids regex performance penalty
use Getopt::Long qw(:config gnu_getopt);
use File::DosGlob 'glob';
use Pod::Usage;

our $VERSION = '0.01';

# globals
use constant NOTFILENAME => undef;
my %counter = ( 
    'PHYS'          => 0, 
    'ELOC'          => 0, 
    'PURE_COMMENT'  => 0,
    'BLANK'         => 0,
    'LLOC'          => 0,
    'INLINE_COMMENT'=> 0,
    'LOC'           => 0,
);
my %header = (
    "eloc"      =>  "eloc",
    "lloc"      =>  "lloc",
    "loc"       =>  "loc",
    "comment"   =>  "comment",
    "blank"     =>  "blank",
    "newline"   =>  "newline",
    "logicline" =>  "lgcline",
);
my %total = %counter; # copy
my $c = \%counter; # see format below
my $h = \%header;  # see top format below
my $inside_multiline_comment = 0;
my $filename = NOTFILENAME;
my $filecount = 0;
my $filename_header = "file name";

# process input args
my $version = '';
my $help = '';
my $man = '';
my $is_deterministic = '';
my $has_header = '';

print STDERR "Input args:'" if DEBUG;
print STDERR (join("|",@ARGV),"'\n") if DEBUG;

my %option = ('version' => \$version,
    'help' => \$help,   
    'man'  => \$man,
    'deterministic' => \$is_deterministic,
    'header' => \$has_header
);
GetOptions( \%option, 'version',    'help', 'man',
    'eloc|e', # print the eLOC counts
    'lloc|s', # print the lLOC counts (code statements)
    'loc|l' , # print the LOC counts (eLOC + lines of a single brace or parenthesis)
    'comment|c'    , # print the comments counts (count lines which contains a comment)
    'blank|b'      , # print the blank counts
    'newline|n'    , # print the newline count
    'logicline|g'  , # print the logical line count (= LOC + Comment Lines + Blank Lines)   
    'deterministic', # print the LOC determination for every line in the source file
    'header',        # print header line
) or invalid_options("$0: invalid options\nTry `$0 --help' for more information.");

version()                                   if $version;
pod2usage(-exitstatus => 0, -verbose => 1)  if $help ;
pod2usage(-exitstatus => 0, -verbose => 2)  if $man;

#
$has_header = 1 if $is_deterministic && $has_header eq '';

#format for print_loc_metric()
my ($format, $format_top) = make_format(); 
print STDERR "format:\n" if DEBUG > 10;
print STDERR $format if DEBUG > 10;
eval $format;
die $@ if $@; # $EVAL_ERROR

if(DEBUG>10) {
    print STDERR ("format_top:\n", $format_top);
}
if( $has_header) {
    eval $format_top;
    die $@ if $@; # $EVAL_ERROR 
}

# process files
print STDERR ("Input args after Getopts():\n",
    join("|",@ARGV),"\n") if DEBUG > 10;

expand_wildcards();
@ARGV = '-' unless @ARGV;
foreach my $fn (@ARGV) {
    $filename = $fn;
    unless (open(IN, "<$filename")) {
        warn "$0: Unable to read from '$filename': $!\n";
        next;
    }
    print STDERR "Scanning $filename...\n" if DEBUG;

    clear_counters();
    generate_loc_metric();  

    $filecount++;

    print_loc_metric();                     

    close(IN)
        or warn "$0: Could not close $filename: $!\n";      
}

# print total
if($filecount > 1) {
    $filename = "total";
    $c = \%total;
    print_loc_metric();
}
exit 0;

#-------------------------------------------------
sub wsglob {
    my @list = glob;
    @list ? @list : @_; #HACK: defence from emtpy list from glob()
}
sub expand_wildcards {
    print STDERR ("Input args before expand_wildcards():\n",
        join("|",@ARGV),"\n") if DEBUG;

    {       
        @ARGV = map( /['*?']/o ? wsglob($_) : $_ , @ARGV);
    }   
    print STDERR ("Input args after expand_wildcards():\n",
        join("|",@ARGV),"\n") if DEBUG; 
}
sub clear_counters {
    for my $name ( keys %counter) {
        $counter{$name} = 0;
    }   
}
sub make_format {
    my $f = 'format STDOUT =' . "\n";
    $f .= '# LOC, eLOC, lLOC, comment, blank, newline, logicline and filename' . "\n";
    my $f_top = 'format STDOUT_TOP =' . "\n";   
    my $console_screen_width = (get_terminal_size())[0];
    print STDERR '$console_screen_width=' . $console_screen_width ."\n" if DEBUG>10;
    $console_screen_width = 100 if $console_screen_width < 0;
    my $is_print_specifiers_set = 
         ($option{"eloc"} or
         $option{"lloc"} or
         $option{"loc"} or
         $option{"comment"} or
         $option{"blank"} or
         $option{"newline"} or
         $option{"logicline"});

    my %o = %option;
    my $fc = 0;
    if( $is_print_specifiers_set ) {

        $fc++ if $o{"eloc"};
        $fc++ if $o{"lloc"};
        $fc++ if $o{"loc"};
        $fc++ if $o{"comment"};
        $fc++ if $o{"blank"};
        $fc++ if $o{"newline"};
        $fc++ if $o{"logicline"};
        if( $fc == 0 ) { die "$0: assertion failed: field count is zero" }
    }
    else {
        # default
        $fc = 7;
        $o{"loc"}       = 1;       
        $o{"eloc"}      = 1;         
        $o{"lloc"}      = 1;      
        $o{"comment"}   = 1;   
        $o{"blank"}     = 1;     
        $o{"newline"}   = 1;   
        $o{"logicline"} = 1;        
    }
    if (DEBUG > 10) {
        while( (my ($name, $value) = each %{o}) ) {
            print STDERR "name=$name, value=$value\n";
        }       
    }

    # picture line  
    my $field_format = '@>>>>>> ';
    my $field_width = length $field_format;
    my $picture_line = $field_format x $fc;     
    #   place for filename
    $picture_line .= '^';       
    $picture_line .= '<' x ($console_screen_width - $field_width * $fc - 2);
    $picture_line .= "\n";  
    $f .= $picture_line;
    $f_top .= $picture_line;
    # argument line
    $f .=   '$$c{"LOC"}, '      ,$f_top .= '$$h{"loc"}, '       if $o{"loc"};
    $f .=   '$$c{"ELOC"}, '     ,$f_top .= '$$h{"eloc"}, '      if $o{"eloc"};      
    $f .=   '$$c{"LLOC"}, '     ,$f_top .= '$$h{"lloc"}, '      if $o{"lloc"};
    $f .=   '$$c{"comment"}, '  ,$f_top .= '$$h{"comment"}, '   if $o{"comment"};
    $f .=   '$$c{"BLANK"}, '    ,$f_top .= '$$h{"blank"}, '     if $o{"blank"};
    $f .=   '$$c{"PHYS"}, '     ,$f_top .= '$$h{"newline"}, '   if $o{"newline"};
    $f .=   '$$c{"logicline"}, ',$f_top .= '$$h{"logicline"}, ' if $o{"logicline"};
    $f .=  '$filename' . "\n";
    $f_top .= '$filename_header' . "\n";        

    # 2nd argument line for long file names
    $f .=   '^';    
    $f .= '<' x ($console_screen_width-2);
    $f .= '~~'  . "\n"
            .' $filename'  . "\n";
    $f .='.' . "\n";
    $f_top .='.' . "\n";
    return ($f, $f_top);
}
sub generate_loc_metric {
    my $is_concatinated = 0;
    LINE: while(<IN>)
    {
        chomp;      
        print if $is_deterministic && !$is_concatinated;        

        # handle multiline code statements
        if ($is_concatinated = s/\\$//) {
            warnings::warnif("$0: '\\'-ending line concantinated");
            increment('PHYS');
            print "\n" if $is_deterministic;
            my $line = <IN>;
            $_ .= $line;
            chomp($line);
            print $line if $is_deterministic;
            redo unless eof(IN);            
        }               

        # blank lines, including inside comments, don't move to next line here
        increment('BLANK')                  if( /^\s*$/ );  

        # check whether multiline comments finished
        if( $inside_multiline_comment && m~\*/\s*(\S*)\s*$~ ) {
            $inside_multiline_comment = 0;
            # check the rest of the line if it contains non-whitespace characters
            #debug $_ = $REDO_LINE . $1, redo LINE if($1);
            warnings::warnif("$0: expression '$1' after '*/' discarded") if($1);
            # else mark as pure comment
            increment('PURE_COMMENT');
            next LINE;
        }
        # inside multiline comments
        increment('PURE_COMMENT'), next LINE if( $inside_multiline_comment );

        # C++ style comment at the begining of line (except whitespaces)
        increment('PURE_COMMENT'), next LINE if( m~^\s*//~ ); 

        # C style comment at the begining of line (except whitespaces)
        if ( m~^\s*/\*~ ) {
            $inside_multiline_comment = 1 unless( m~\*/~ );
            increment('PURE_COMMENT'),  next LINE;
        }
        # inline comment, don't move to next line here
        increment('INLINE_COMMENT')        if ( is_inline_comment($_) );

        # lLOC implicitly incremented inside is_inline_comment($)

        #
        increment('LOC')                    unless( /^\s*$/ );

        # standalone braces or parenthesis  
                                  next LINE if( /^\s*(?:\{|\}|\(|\))+\s*$/ );           

        # eLOC is not comments, blanks or standalone braces or parenthesis
        #   therefore just increment eLOC counter here
        increment('ELOC'),        next LINE unless( /^\s*$/ );
    }
    continue {
        increment('PHYS');
        print " [$.]\n" if $is_deterministic; # $INPUT_LINE_NUMBER
    }
}

sub print_loc_metric {
    $$c{'comment'} = $$c{'PURE_COMMENT'} + $$c{'INLINE_COMMENT'}; 
    # LOC + Comment Lines + Blank Lines 
    $$c{'logicline'} = $$c{'LOC'} + $$c{'comment'} + $$c{'BLANK'};
    unless (defined $filename) { 
        die "print_loc_metric(): filename is not defined";
    }       

    my $fn = $filename;
    $filename = "", $filename_header = "" 
        unless($#ARGV);
    print STDERR ("ARGV in print_loc_metric:" , join('|',@ARGV), "\n") 
        if DEBUG;
    write STDOUT; # replace with printf
    $filename = $fn;
}
sub increment {
    my $loc_type = shift;
    defined $loc_type
        or die 'increment(\$): input argument is undefined';    

    $counter{$loc_type}++;
    $total{$loc_type}++;
    print "\t#". $loc_type ."#" if $is_deterministic;   
}

sub is_inline_comment {
    my $line = shift;
    defined $line 
        or die 'is_inline_comment($): $line is not defined';

    print "\n$line" if DEBUG > 10;  

# here: line is not empty, not begining both C and C++ comments signs,
#       not standalone '{}()', not inside multiline comment,
#       ending '\' removed (joined line created if needed)

# Possible cases: 
#   - no C\C++ comment signs                        => is_inline_comment = 0
#   - C++ comment (no C comment sign)
#       * no quote characters                       => is_inline_comment = 1
#       * at least one comment sign is not quoted   => is_inline_comment = 1
#       * all comment signs are quoted              => is_inline_comment = 0
#   - C comment (no C++ comment sign)
#       * no quote characters                       => is_inline_comment = 1,
#           ~ odd number of '/*' and '*/'           => $inside_multiple_comment = 1                             
#           ~ even number                           => $inside_multiple_comment = 0
#       * etc...
#   - ...
# algorithm: move along the line from left to right
# rule: quoted comments are not counted
# rule: quoted by distinct style quotes are not counted
# rule: commented quotes are not counted
# rule: commented distinct style comments are not counted
# rule: increment('LLOC') if not-quoted, not-commented
#           semi-colon presents in the line except that two 
#           semi-colon in for() counted as one.

# 
$_ = $line; #hack: $_ = $line inside sub
#   state
my %s = (
    'c'     => 0, # c slash star - inside c style comments
    'cpp'   => 0, # c++ slash slash - inside C++ style comment
    'qm'    => 0, # quoted mark - inside quoted string
    'qqm'   => 0, # double quoted - inside double quoted string
);
my $has_comment = 0;
# find state
LOOP:
    {
      /\G\"/gc  &&  do { # match double quote
                            unless( $s{'qm'} || $s{'c'} || $s{'cpp'} ) {
                                    # toggle 
                                $s{'qqm'} = $s{'qqm'} ? 0 : 1; 
                            }
                            redo LOOP;
                    };
      /\G\'/gc  &&  do { # match single quote
                            unless( $s{'qqm'} || $s{'c'} || $s{'cpp'} ) {
                                    # toggle 
                                $s{'qm'} = $s{'qm'} ? 0 : 1; 
                            }
                            redo LOOP;
                    };
      m~\G//~gc &&  do { # match C++ comment sign
                            unless( $s{'qm'} || $s{'qqm'} || $s{'c'} ) {
                                    # on
                                $has_comment = 1;
                                $s{'cpp'} = 1; 
                            } 
                            redo LOOP;
                    };
      m~\G/\*~gc    &&  do { # match begining C comment sign
                            unless( $s{'qm'} || $s{'qqm'} || $s{'cpp'} ) {
                                    # on
                                $has_comment = 1;
                                $s{'c'} = $s{'c'} ? 1 : 1; 
                            } 
                            redo LOOP;
                    };
      m~\G\*/~gc    &&  do { # match ending C comment sign
                            unless( $s{'qm'} || $s{'qqm'} || $s{'cpp'} ) {
                                    # off                                   
                                if( $s{'c'} ) {                                     
                                    $s{'c'} = 0;
                                }
                                else {
                                    die 'is_inline_comment($): unexpected c style ending comment sign'.
                                        "\n'$line'";
                                }
                            } 
                            redo LOOP;
                    };
      /\Gfor\s*\(.*\;.*\;.*\)/gc    &&  do { # match for loop
                            unless( $s{'qm'} || $s{'qqm'} || $s{'cpp'} || $s{'c'} ) {
                                # not-commented, not-quoted semi-colon                                  
                                increment('LLOC');
                            }
                            redo LOOP;
                    };                                          
      /\G\;/gc  &&  do { # match semi-colon
                            unless( $s{'qm'} || $s{'qqm'} || $s{'cpp'} || $s{'c'} ) {
                                # not-commented, not-quoted semi-colon
                                # not inside for() loop
                                increment('LLOC');
                            }
                            redo LOOP;
                    };                      
      /\G./gc   &&  do { # match any other character
                            # skip 1 character
                            redo LOOP;
                    };
      /\G$/gc   &&  do { # match end of the line
                            last LOOP;
                    };                      
      #default
        die 'is_inline_comment($): unexpected character in the line:' .
            "\n'$line'";
    }
# apply state
    $inside_multiline_comment = $s{'c'};
    return $has_comment;
}

sub version {
#   TODO: version implementation
    print <<"VERSION";
NAME v$VERSION
Written by AUTHOR

COPYRIGHT AND LICENSE
VERSION

exit 0;
}

sub invalid_options {
    print STDERR (@_ ,"\n");
    exit 2;
}

sub get_terminal_size {
    my ($wchar, $hchar) = ( -1, -1); 
    my $win32console = <<'WIN32_CONSOLE';   
        use Win32::Console; 
        my $CONSOLE = new Win32::Console(); 
        ($wchar, $hchar) = $CONSOLE->MaxWindow();
WIN32_CONSOLE

    eval($win32console); 
    return ($wchar, $hchar) unless( $@ );
    warnings::warnif($@); # $EVAL_ERROR

    my $term_readkey = <<'TERM_READKEY';
        use Term::ReadKey; 
        ($wchar,$hchar, $wpixels, $hpixels) = GetTerminalSize(); 
TERM_READKEY

    eval($term_readkey); 
    return ($wchar, $hchar) unless( $@ );

    warnings::warnif($@); # $EVAL_ERROR 
    my $ioctl = <<'IOCTL'; 
        require 'sys/ioctl.ph'; 
        die "no TIOCGWINSZ " unless defined &TIOCGWINSZ; 
        open(TTY, "+</dev/tty")                     
            or die "No tty: $!"; 
        unless (ioctl(TTY, &TIOCGWINSZ, $winsize='')) { 
            die sprintf "$0: ioctl TIOCGWINSZ (%08x: $!)\n", 
                    &TIOCGWINSZ; 
        } 
        ($hchar, $wchar, $xpixel, $ypixel) = 
            unpack('S4', $winsize); # probably $hchar & $wchar should be swapped here 
IOCTL

    eval($ioctl); 
    warnings::warnif($@) if $@ ; # $EVAL_ERROR  

    return ($wchar, $hchar); 
}

1;
__END__ 

=head1 NAME

eLOC - Effective Lines of Code Counter

=head1 SYNOPSIS

B<eloc> B<[>OPTIONB<]...> B<[>FILEB<]...>

Print LOC, eLOC, lLOC, comment, blank, newline and logicline counts 
for each FILE, and a total line if more than one FILE is specified.
See L</"LOC Specification"> for more info, use `eloc --man'.

  -e, --eloc             print the {E}LOC counts
  -s, --lloc             print the lLOC counts (code {S}tatements)
  -l, --loc              print the {L}OC counts (eLOC + lines of a single brace or parenthesis)
  -c, --comment          print the {C}omments counts (count lines which contains a comment)
  -b, --blank            print the {B}lank counts
  -n, --newline          print the {N}ewline count
  -g, --logicline        print the lo{G}ical line count (= LOC + Comment Lines + Blank Lines)
      --deterministic    print the LOC determination for every line in the source file
      --header           print header line
      --help display this help and exit
      --man  display full help and exit
      --version  output version information and exit

With no FILE, or when FILE is -, read standard input.      

Metrics counted by the program are based on narration from 
http://msquaredtechnologies.com/m2rsm/docs/rsm_metrics_narration.htm

=for TODO: Comment Percent = Comment Line Count / Logical Line Count ) x 100      

=for TODO: White Space Percentage = (Number of spaces / Number of spaces and characters) * 100       

=head1 DESCRIPTION

eLOC is a simple LOC counter. See L</"LOC Specification">. 

=head2 LOC Specification

=over 1

=item LOC

Lines Of Code = eLOC + lines of a single brace or parenthesis

=item eLOC

An effective line of code or eLOC is the measurement of all lines that are 
not comments, blanks or standalone braces or parenthesis. 
This metric more closely represents the quantity of work performed. 
RSM introduces eLOC as a metrics standard.
See http://msquaredtechnologies.com/m2rsm/docs/rsm_metrics_narration.htm

=item lLOC

Logical lines of code represent a metrics for those line of code which form 
code statements.  These statements are terminated with a semi-colon.  

The control line for the "for" loop contain two semi-colons but accounts 
for only one semi colon.
See http://msquaredtechnologies.com/m2rsm/docs/rsm_metrics_narration.htm

=item comment

comment = pure comment + inline comment

=over

=item pure comment

Comment lines represent a metrics for pure comment line without any code in it.
See L</"inline comment">.

=item inline comment

Inline comment line is a line which contains both LOC line and pure comment.

Inline comment line and pure comment line (see L</"pure comment">)
are mutually exclusive, that is a given physical line cannot be an inline comment
line and a pure comment line simultaneously.

=over

=item Example:

    static const int defaultWidth = 400;        // value provided in declaration

=back

=back

=item blank

Blank line is a line which contains at most whitespaces.
Blank lines are counted inside comments too.

=item logicline

The logical line count = LOC + Comment Lines + Blank Lines

=back

=head1 KNOWN BUGS AND LIMITATIONS

=over

=item

It supports only C/C++ source files.

=item

Comments inside for(;;) statements are not counted

=over

=item Example:

    for(int i = 0; i < N /*comment*/; i++ );        #LLOC#  #LLOC#  #LOC#   #ELOC#  #PHYS# [1]

=back

=item

'\'-ending lines are concatinated ( though newline count is valid)

=item

Input from stdin is not supported in the case 
the script is envoked solely by name without explicit perl executable.

=item

Wildcards in path with spaces are not supported (like GNU utilities).

=back

=over

=begin fixed
=item Limitation: single source file

    Only one source file at time supported

=item Limitation: LLOC is unsupported

    The logical lines of code metric is unsupported. 

=item missed inline comment for C style comment

    #include <math.h> /* comment */ #ELOC#  #PHYS# [2]

But must be
    #include <math.h> /* comment */ #INLINE_COMMENT#    #ELOC#  #PHYS# [2]

=item wrong LOC type for the code after '*/'

    /* another  #PURE_COMMENT#  #PHYS# [36]
    trick   #PURE_COMMENT#  #PHYS# [37]
    */  i++;    #PURE_COMMENT#  #PHYS# [38]

In the last line must be 

    #INLINE_COMMENT# #PHYS# [38]

=end fixed

=back

=head1 SEE ALSO

Metrics counted by the program are based on narration from L<http://msquaredtechnologies.com/m2rsm/docs/rsm_metrics_narration.htm>

=cut 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-27T22:15:20.370

我有一个名为`scc`去除 C 注释（和 C++ 注释，尽管在 C99 中它们是相同的）的程序。应用它加上一个过滤器来删除空行，如果需要，还可以删除只包含左大括号和右大括号的行，以生成行数。我在内部项目中使用过它——不需要打折打开/关闭大括号。这些脚本更复杂，比较了存储在 ClearCase 中的一个实质性项目的两个不同版本的源代码。他们还对添加和删除的文件以及从公共文件中添加和删除的行等进行了统计。

不计算大括号会产生很大的不同：

```
Black JL: co -q -p scc.c | scc | sed '/^[       ]*$/d' | wc -l
     208
Black JL: co -q -p scc.c | scc | sed '/^[       {}]*$/d' | wc -l
     144
Black JL: co -p -q scc.c | wc -l
     271
Black JL: 
```

所以，你的规则下有 144 行；208 计算打开和关闭大括号线；271 计算一切。

让我知道您是否想要代码`scc`（将电子邮件发送到 gmail dot com 的第一个 dot last）。它是 13 KB 的 gzip 压缩 tar 文件，包括手册页、酷刑测试和一些库文件。

* * *

@litb 评论说 ' `cpp -fpreprocessed -P file`' 处理删除评论。它主要是。但是，当我在 SCC 的压力测试中运行它时，它会抱怨（在我看来）它不应该：

```
SCC has been trained to handle 'q' single quotes in most of
the aberrant forms that can be used. '\0', '\', '\'', '\\
n' (a valid variant on '\n'), because the backslash followed
by newline is elided by the token scanning code in CPP before
any other processing occurs. 
```

当来自 GCC 4.3.2 的 CPP 处理这个时，它会抱怨（警告）：

```
SCC has been trained to handle 'q' single quotes in most of
<stdin>:2:56: warning: missing terminating ' character
the aberrant forms that can be used. '\0', '\', '\'', '\\
<stdin>:3:27: warning: missing terminating ' character
n' (a valid variant on '\n'), because the backslash followed
by newline is elided by the token scanning code in CPP before
any other processing occurs. 
```

C99 标准的第 5.1.1.2 节翻译阶段说：

> 翻译的语法规则之间的优先级由以下阶段指定。（*脚注5*）
> 
> 1.  如有必要，物理源文件多字节字符以实​​现定义的方式映射到源字符集（为行尾指示符引入换行符）。Trigraph 序列被相应的单字符内部表示替换。
>     
>     
> 2.  每个反斜杠字符 () 的实例后面紧跟一个换行符被删除，拼接物理源代码行以形成逻辑源代码行。只有任何物理源行上的最后一个反斜杠才有资格成为此类接头的一部分。非空源文件应以换行符结尾，在任何此类拼接发生之前，该换行符之前不应紧跟反斜杠字符。
>     
>     
> 
> 脚注 5 是：
> 
> (5) 实现应该表现得好像这些单独的阶段发生了一样，即使在实践中许多通常是折叠在一起的。

因此，在我看来，CPP 对示例文本中的第二阶段处理不当。或者，至少，警告不是我想要的——构造是有效的 C 并且警告是有道理的并不是不言而喻的。

当然，这是一个边缘情况，并且允许额外的警告。但这会惹恼我的生活。如果我没有自己的、可能更好的工具来完成这项工作，那么使用 ' `cpp -fpreprocessed -P`' 就可以了——这是我抱怨的极端情况（而且，争辩说这更有可能是合理的）总有一个问题——尽管更好的启发式方法会观察到该行被拼接并且结果是合法的单字符常量，因此应该禁止投诉；如果结果不是合法的单字符常量，则投诉（在我的测试案例中 - 诚然是酷刑测试 - CPP 产生 13 个问题，主要与我抱怨的问题有关，其中 SCC 正确产生 2。）

（我观察到 ' `-P`' 设法`#line`在省略选项时出现的输出中抑制 ' ' 指令。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-13T20:35:47.790

以下脚本将获取与给定目录中的模式匹配的所有文件的计数。

# 脚本开始

var str 文件
var str dir

set $files = "*.cpp" # <===================== 在此处设置您的文件名模式。
set $dir = "C:/myproject" # <===================== 在这里设置你的项目目录。

# 获取变量fileList中的文件列表。
var str fileList
find -rn files($files) dir($dir) > $fileList

# 声明变量，我们将在其中保存单个文件的计数。
var int c # 所有行
var int nb # 非空行

# 声明变量，我们将在其中保存所有文件的总数。
var int totalc # 所有行的
总和 var int totalnb # 所有非空行的总和

# 声明我们将存储文件计数的变量。
var int fileCount

# 我们将在下面存储我们当前正在处理的文件的名称。
var str 文件

# 逐个遍历 $fileList 文件。
while ($fileList<>"")
do
# 提取下一个文件。
lex "1" $fileList >$file

# 检查这是否是一个平面文件。我们对目录不感兴趣。
af $file >null # 我们不想看到输出。
# 我们只想设置 $ftype 变量。
if ($ftype=="f")
do
# 是的，这是一个平面文件。

```
 # Increment file count.<br>
set $fileCount = $fileCount+1<br>

# Collect the content of $file in $content<br>
var str content # Content of one file at a time<br>
repro $file >$content<br>

# Get count and non-blank count.<br>
set $c={len -e $content}<br>
set $nb={len $content}<br>

echo -e "File: " $file ", Total Count: " $c ", Non-blank Count: " $nb<br>

# Update total counts.<br>
set $totalc = $totalc + $c<br>
set $totalnb = $totalnb + $nb<br> 
```

完成
结束

完毕

# 显示总计

回声“************************************************ ****************************************************** ************************************"
echo "总行数:\t" $totalc ",\tTotal非空行数：\t" $totalnb "，文件总数：" $fileCount
echo "****************************** ****************************************************** ****************************************************** **"

# 脚本结束

如果您只需要 2008 年修改的文件中的行数，请添加 ($fmtime >= "2008") 等。

如果您没有 biterscripting，请从 .com 获取。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-13T21:35:09.263

这不是一个简单的脚本，但[CCCC](http://cccc.sourceforge.net/)（C 和 C++ 代码计数器）已经存在了一段时间，它对我来说非常有用。

# python - py2exe 无法生成可执行文件

> ID：323424
> 
> 赞同：51
> 
> 时间：2008-11-27T10:31:51.510
> 
> 标签：python, wxpython, py2exe

我在 XP 上使用 python 2.6。我刚刚安装了py2exe，我可以从一个hello.py成功地创建一个简单的hello.exe。但是，当我尝试在我的真实程序上使用 py2exe 时，py2exe 会生成一些信息消息，但无法在 dist 文件夹中生成任何内容。

我的 setup.py 看起来像这样：

```
from distutils.core import setup
import py2exe

setup(console=['ServerManager.py']) 
```

py2exe 输出如下所示：

```
python setup.py py2exe
running py2exe
creating C:\DevSource\Scripts\ServerManager\build
creating C:\DevSource\Scripts\ServerManager\build\bdist.win32
   ...
   ...
creating C:\DevSource\Scripts\ServerManager\dist
*** searching for required modules ***
*** parsing results ***
creating python loader for extension 'wx._misc_' (C:\Python26\lib\site-packages\wx-2.8-msw-unicode\wx\_misc_.pyd -> wx._misc_.pyd)
creating python loader for extension 'lxml.etree' (C:\Python26\lib\site-packages\lxml\etree.pyd -> lxml.etree.pyd)
   ...
   ...
creating python loader for extension 'bz2' (C:\Python26\DLLs\bz2.pyd -> bz2.pyd)
*** finding dlls needed *** 
```

py2exe 似乎已经找到了我所有的导入（虽然看到提到 win32 我有点惊讶，因为我没有明确导入它）。此外，我的程序使用以下命令启动得非常愉快：

```
python ServerManager.py 
```

显然我在做一些根本错误的事情，但是在没有来自 py2exe 的任何错误消息的情况下，我不知道是什么。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-21T21:29:58.143

我把它放在我所有的 setup.py 脚本中：

```
distutils.core.setup(
    options = {
        "py2exe": {
            "dll_excludes": ["MSVCP90.dll"]
        }
    },
    ...
) 
```

这使 py2exe 保持安静，但您仍然需要确保 dll 在用户的计算机上。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-11-28T10:36:56.880

我发现如果我注释掉程序中使用 wxPython 的部分，py2exe 就可以正常工作。此外，当我在其下载附带的“简单”示例上使用 py2exe 时（即在 Python26\Lib\site-packages\py2exe\samples\simple 中），我收到以下错误消息：

```
*** finding dlls needed ***
error: MSVCP90.dll: No such file or directory 
```

所以关于 wxPython 的一些东西让 py2exe 认为我需要一个 Visual Studio 2008 DLL。我没有 VS2008，但我的程序作为 Python 模块的目录运行良好。我在网上找到了一份 MSVCP90.DLL 的副本，将其安装在 Python26/DLLs 中，py2exe 现在可以正常工作了。

我仍然不明白这种依赖是从哪里来的，因为我可以在没有 py2exe 的情况下完美地运行我的代码。py2exe 没有像 test_wx.py 样本那样给我一个错误消息，这也很烦人。

进一步更新：当我尝试在另一台 PC 上运行 py2exe 的输出时，我发现它需要安装 MSVCR90.DLL；因此，如果您的目标 PC 尚未安装 Visual C++ 2008，我建议您下载并安装[Microsoft Visual C++ 2008 Redistributable Package](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=29)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-11-18T15:07:21.433

wxPython 与它无关。在 Python 2.6 之前，Python 使用 Visual Studio 2003 作为其 Windows 编译器。从 2.6 开始，他们切换到 Visual Studio 2008，在某些情况下需要清单文件。这已经有据可查。请参阅以下链接：

[http://wiki.wxpython.org/py2exe](http://wiki.wxpython.org/py2exe)

[http://py2exe.org/index.cgi/Tutorial#Step52](http://py2exe.org/index.cgi/Tutorial#Step52)

此外，如果您使用 py2exe 创建 wxPython 应用程序，那么您需要设置 windows 参数，而不是控制台参数。也许我的教程会帮助你：

[http://www.blog.pythonlibrary.org/2010/07/31/a-py2exe-tutorial-build-a-binary-series/](http://www.blog.pythonlibrary.org/2010/07/31/a-py2exe-tutorial-build-a-binary-series/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-10-15T03:37:08.327

看起来这只是 Python 2.6 的依赖项。我在 2.5 下没有收到此错误，但升级后我收到了。

这个电子邮件线程有一些背景说明问题存在的原因以及如何解决它： http:
[//www.nabble.com/py2exe,-Py26,-wxPython-and-dll-td20556399.html](http://www.nabble.com/py2exe,-Py26,-wxPython-and-dll-td20556399.html)

我不想安装 vcredist。我的应用程序目前不需要安装，并且可以由非管理员运行，这是我不想失去的行为。因此，我按照链接中的建议，通过“仅针对该用户”安装 Python 获得了必要的 Microsoft.VC90.CRT.manifest 和 msvcr90.dll。我还需要在“所有用户”Python 2.6 安装的 WinSxS 文件夹中找到的 msvcp90.dll。由于我已经拥有了三个中的两个，因此我包含了 msvcm90.dll 以防止将来出现错误，尽管当我忽略它时我没有立即收到任何错误。我将清单和三个 DLL 放在我的冻结应用程序使用的 libs 文件夹中。

我必须执行的技巧是在我的应用程序文件夹的根目录中包含清单和 msvcr90.dll 的附加副本，旁边是 py2exe 生成的可执行文件。此 DLL 副本用于引导应用程序，但随后它似乎只在 libs 文件夹中查找。

希望这一发现可以帮助其他人。

此外，让 py2exe 记录真正的错误消息时，我也遇到了同样的问题。然后我意识到 stderr 没有被重定向到我的日志文件中。在调用 py2exe 的命令行上添加 "> build.log 2>&1"。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-25T06:37:18.497

```
import sys

sys.path.append('C:\\WINDOWS\\WinSxS\\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.4148_none_5090ab56bcba71c2') 
```

在每个 Windows 上，您都可以`MSVCP90.dll`在以下子目录中找到该文件`C:\\WINDOWS\\WinSxS\\`

就我而言，目录是：`x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.4148_none_5090ab56bcba71c2`.

转到`C:\\WINDOWS\\WinSxS\\`并使用 windows 文件搜索来查找`MSVCP90.dll`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-04-13T14:43:32.273

仅供参考，对我来说，复制文件很有效

Microsoft.VC90.CRT.manifest msvcr90.dll

进入用户机器上带有 .exe 的目录（没有安装 python 或 VC 可再发行组件）。

感谢这里的所有提示！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-28T06:05:46.443

输出显示您正在使用 WX。尝试使用指定为 GUI 应用程序而不是控制台的脚本运行 py2exe。如果我没记错的话，这往往会导致 py2exe 出现问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-10T17:38:41.350

试试这个： http: [//www.py2exe.org/index.cgi/Tutorial#Step52](http://www.py2exe.org/index.cgi/Tutorial#Step52)

它对我有用

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-02-12T09:35:53.790

wxPython wiki 上有一些信息。

[部署 Python 应用程序](http://wiki.wxpython.org/Deployment)

[py2exe 与 wxPython 和 Python 2.6](http://wiki.wxpython.org/py2exe-python26)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-02-21T21:20:54.607

在我的win8.1上，我找不到路径

> c:/Program Files/Microsoft Visual Studio 9.0/VC/redist/x86/Microsoft.VC90.CRT

相反，dll位于

> C:/WINDOWS/WinSxS/x86_Microsoft.VC90.CRT_XXXXXXX

XXX 可能因您的电脑而异

您可以在路径中搜索，然后在 setup.py 中添加路径

```
import sys
sys.path.append('C:/WINDOWS/WinSxS/x86_Microsoft.VC90.CRT_XXXXXXX') 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-09-16T15:58:53.823

```
import sys

sys.path.append('c:/Program Files/Microsoft Visual Studio 9.0/VC/redist/x86/Microsoft.VC90.CRT') 
```

# windows - Windows 命令行：不评估环境变量

> ID：323426
> 
> 赞同：5
> 
> 时间：2008-11-27T10:33:29.557
> 
> 标签：windows, command-line, biztalk, environment-variables

我想将引用环境变量的原始文本提供给命令，而不是评估环境变量。

我需要这个来从命令行配置 BizTalk，例如：

BTSTask.exe AddResource -ApplicationName:App1 -Type:System.BizTalk:BizTalkAssembly -Overwrite -Source:..\Schemas\bin\development\App1.Schemas.dll -Destination:%BTAD_InstallDir%\App1.Schemas.dll

此命令将资源添加到 BizTalk 应用程序。我希望目标是 %BTAD_InstallDir%\App1.Schemas.dll，但目前它正在评估环境变量（没有）并使用 \App1.Schemas.dll。

在解析\执行此命令时是否可以转义或禁用此环境变量的评估？

我尝试用胡萝卜 (^) 转义第一个和两个百分比字符，但这并没有停止评估。

**[编辑]**当我在命令提示符下执行它时，它不会替换环境变量，但是当我将它作为脚本运行时它会替换，关于为什么这不同的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T10:54:13.197

在它打印的命令提示符中尝试 echo ^%path^% ...

> 小路

而不是扩展环境变量，所以我想按照 Mikeage 的建议，以下内容应该对你有用

> BTSTask.exe AddResource -ApplicationName:App1 -Type:System.BizTalk:BizTalkAssembly -Overwrite -Source:..\Schemas\bin\development\App1.Schemas.dll -Destination:^%BTAD_InstallDir^%\App1.Schemas.dll

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T11:28:41.783

你试过了吗：

```
%%BTAD_InstallDir%% 
```

在你的脚本中？

这应该会阻止脚本解释变量，并将其传递`%BTAD_InstallDir%`给程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T10:36:06.587

尝试 ^% 而不是 %。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T10:54:37.907

试过：

```
C:\PrgCmdLine\Unix\echo.exe "%"JAVA_HOME"%" 
```

拿到：

```
%JAVA_HOME% 
```

[编辑]确实，`C:\PrgCmdLine\Unix\echo.exe ^%JAVA_HOME^%`也有效，而且更简单......

[编辑 2] 作为记录：我使用 UnxUtils 的 echo 来获得普通程序的行为。内置 echo 的行为略有不同，至少对于引用的 % 符号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-03T10:29:28.280

不确定它是否与我的情况相同，但我很难使用批处理文件来创建一个内部包含 %temp% 变量的脚本。我找到的解决方法： set test=%temp; echo {command} %test%%>>path_to_my_batch_file; 希望这对某人有帮助:)

# apache - Apache 是否记录取消的下载？

> ID：323443
> 
> 赞同：4
> 
> 时间：2008-11-27T10:42:19.600
> 
> 标签：apache, http, webserver

如果用户从 Apache Web 服务器请求一个大文件，但在下载完成之前取消了下载，这是由 Apache 记录的吗？

我可以从日志文件中看出哪些响应没有完全发送，以及发送了多少字节？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T10:51:42.997

是的，它会记录这些请求，但您需要使用[mod_logio](http://httpd.apache.org/docs/2.2/mod/mod_logio.html)来了解实际发送的字节数，否则它将显示文件的总字节数。要知道哪些失败了，您必须：

*   使用[%X 格式修饰符](http://httpd.apache.org/docs/2.2/mod/mod_log_config.html)并使用自定义日志格式
*   将发送的实际字节数与文件的大小进行比较（如果您有第一个选项，您为什么要选择 :-)）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-27T10:49:47.230

是的。如果我没记错的话，它会显示下载中断之前传输的字节数。然后，您可以计算出应该为该请求发送多少字节并进行比较。

如果您使用的是 PHP（因为问题在一分钟前被标记），您可能会做某种响应缓冲区，将文件分成较小的位。首先计算出你需要发送多少块，写一个日志（到数据库或系统日志）说你已经开始，一旦你到达最后一个块，另一个说你已经完成（或删除第一个）。

# mysql - 如何在 SQL 中对贝叶斯网络或更一般的有向加权图进行建模？

> ID：323456
> 
> 赞同：7
> 
> 时间：2008-11-27T10:51:16.023
> 
> 标签：mysql, sql, graph-theory, bayesian-networks

我在网上找到了几篇文章，提供了如何在 SQL 中对各种类型的图（尤其是 DAG）进行建模的示例，但鉴于它们所建模的内容相对简单，它们似乎都非常复杂。

是否有这样做的最佳/标准方法？我目前的想法是这样的：

```
create table node (
  id int not null auto_increment,
  name TEXT
)

create table edge (
  from_node int not null,
  to_node int not null,  
  weight float
) 
```

这有什么问题吗？任何人都知道更好（也许更强大）的方式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T11:03:48.747

这将是一个相当合理的方法。SQL 并没有真正做好递归结构，尽管 Oracle 或 SQL Server 等一些系统具有递归查询功能。

尽管您可能会找到一种更适合特定搜索类型的结构，但我认为您不会在一般情况下找到明显更好的结构。如果您的应用程序的要求以这种方式受到限制，那么这样的优化可能会给您带来好处。

由于贝叶斯网络是有向无[环图](http://en.wikipedia.org/wiki/Directed_acyclic_graph)(DAG)，因此纯递归的父子关系不足以对网络进行建模（即一个节点可以有多个父节点），因此您的类型为 M:M 关系ve 描述将是必要的。

[Joe Celko](http://www.amazon.com/s/ref=nb_ss_gw?url=search-alias%3Daps&field-keywords=joe+celko&x=0&y=0)的各种“聪明人的 SQL”书籍很好地概述了在 SQL 中实现和查询层次结构和图形结构的技术。这些是迄今为止我所知道的关于该主题的最佳资源。 *强烈推荐。*

# asp.net-mvc - ASP.NET MVC OutputCache 不适用于根 URI

> ID：323458
> 
> 赞同：11
> 
> 时间：2008-11-27T10:52:20.233
> 
> 标签：asp.net-mvc, controller, action, outputcache

我正在学习 ASP.NET MVC，但遇到了一个问题。

在 HomeController 中，Index 操作具有 OutputCache 属性，但似乎不起作用。

```
[HandleError]
public class HomeController : Controller
{
    [OutputCache(Duration=5, VaryByParam="none")]
    public ActionResult Index()
    {
        ViewData["Title"] = "Home Page" + DateTime.Now;
        ViewData["Message"] = "Welcome to ASP.NET MVC! " + DateTime.Now;

        return View();
    }
} 
```

经过几分钟的尝试，我发现这是由于我访问操作的方式所致。如果我通过“ [http://localhost:3573/](http://localhost:3573/) ”访问它，则输出缓存不起作用。但是，如果我使用“ [http://localhost:3575/Home/Index](http://localhost:3575/Home/Index) ”访问它，则输出缓存可以工作。

有人知道使默认控制器操作输出可缓存的任何解决方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-28T08:00:41.267

我认为这是 ASP.NET MVC 中的一个错误。我们已将问题记录在我们的数据库中，并将调查此问题的修复程序。

谢谢，艾隆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:51:01.130

使用 VarByParam="" 似乎使它工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-10T17:59:19.513

根据我在 Microsoft 的联系人，如果您从站点的根目录中删除 Default.aspx 文件，问题就会完全消失，或者，如果您绝对需要它，请确保使用最新版本的 ASP 提供的文件.NET MVC。

# java - Apache 蜂巢和本地化 DataGrid 的默认寻呼机

> ID：323461
> 
> 赞同：2
> 
> 时间：2008-11-27T10:53:13.027
> 
> 标签：java, apache, localization, beehive, netui

我正在尝试本地化由 Apache Beehive 和 netui 默认寻呼机创建的字符串。

我想翻译这个输出的语言。

```
Page 1 of 3  First / Previous   Next / Last 
```

我的 .jsp 代码看起来像这样

```
<netui-data:dataGrid name="searchResultsGrid" dataSource="pageInput.someData">

  <netui-data:header>
       ...
  </netui-data:header>
  <netui-data:rows>
       ...
  </netui-data:rows>
  <netui-data:configurePager pagerFormat="firstPrevNextLast" pageAction="refresh" pageSize="10"
    disableDefaultPager="false" />
</netui-data:dataGrid> 
```

我已经找到了我应该在翻译中使用的[键](http://beehive.apache.org/docs/1.0.1/netui/apidocs/javadoc/org/apache/beehive/netui/databinding/datagrid/api/rendering/IDataGridMessageKeys.html)，但是我如何配置寻呼机应该使用的消息属性文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T06:24:22.987

据我所知，`IDataGridMessageKeys`它只是一个公开的内部接口，并不是真正打算供最终用户使用。作为一种猜测，我敢打赌他们必须在该包中将其公开，以便其他包能够使用它，并且找不到另一种方式（使用他们的构建方案）将其安全地传递给其余的代码。

（当然，我可能是错的。我会尝试再通过源代码获取一些内容。）

# windows - 颠覆自动道具问题

> ID：323462
> 
> 赞同：5
> 
> 时间：2008-11-27T10:53:30.683
> 
> 标签：windows, svn, tortoisesvn, visualsvn, ankhsvn

这让我发疯了，所以欢迎其他用户的任何建议。我正在使用 Subversion，在 Windows 服务器上安装了 VisualSVN 1.6.1 的副本。在我的 PC 上，我使用 TortoiseSVN 和出色的 AnkhSVN Visual Studio 插件的组合。一切都像做梦一样，但现在我正在尝试使用该`svn:keywords`功能，以便可以将其包含`$Id$`在所有源文件的顶部。现在，对于现有文件，我可以编辑 SVN 属性并添加此关键字，一切正常，但我希望为新文件自动完成 - 我无法使其工作。

根据文档，您需要编辑位于您`C:\Documents and Settings\<user>\Application Data\Subversion`文件夹中的特殊 Subversion 配置文件。我的电脑已经有了这个文件的副本，所以我把它改成了这样：

```
[miscellany]
enable-auto-props = yes

[auto-props]
*.cpp = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.hpp = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.rc = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.rc2 = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.cc = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.c = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.h = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.wsf = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.js = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.htm = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.html = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision
*.css = svn:eol-style=native;svn:keywords=Author Date Id HeadURL Revision 
```

然后，我将一个新文件添加到现有的 Visual Studio 项目（从 Visual Studio 中），添加`$Id$`到顶部并提交 - 但是，唉，`svn:keywords`没有设置该属性。

有谁知道如何让这个工作？我什至尝试将设置添加到注册表（在`HKEY_CURRENT_USER\Software\Tigris.org\Subversion\Config`）中，但仍然没有乐趣。然后我尝试在 SVN 服务器本身上弄乱配置文件，但似乎没有任何效果。

我显然错过了一些非常明显的东西！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T11:08:44.990

似乎答案只是围绕实际关键字的一些愚蠢的引号:)

```
[auto-props]
*.cpp = svn:eol-style=native;svn:keywords="Author Date Id HeadURL Revision" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T10:57:32.643

如果您想确保选择了正确的配置文件，请使用 TortoiseSVN 的编辑按钮：[Subversion Wiki](http://www.mediawiki.org/wiki/Subversion/auto-props)。

我能找到的唯一类似问题是用户抱怨这不适用于大写文件扩展名，但这适用于 Fedora，不适用于 Windows：[link](http://osdir.com/ml/version-control.subversion.tortoisesvn.user/2006-10/msg00413.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T12:41:14.900

这似乎是 AnkhSVN 的一个问题。我在 Visual Studio 之外做了一些测试，使用 TortoiseSVN 添加文件，它开始工作（使用我的用户配置文件）。我会尝试最新的 AnkhSVN 看看这是否有什么不同。

我希望在服务器端完成此操作，但这似乎是特定于用户的。

不管怎样，感谢 Len 和 schnaader 的指点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T08:59:39.917

你是对的，问题在于 AnkhSVN。如果在 Visual Studio 中添加新文件（使用 AnkhSVN 2.0.5250），则不会自动添加关键字属性。仅当您使用 Tortoisvn 添加文件时才会添加它。

我下载了 VisualSVN 的试用版（Visual Studio 的插件）。它没有这个问题。属性会自动添加到 Visual Studio 中添加的新文件中。

# ruby-on-rails - backgroundrb thread_pool.defer 方法记录器输出到哪里去？

> ID：323463
> 
> 赞同：2
> 
> 时间：2008-11-27T10:53:58.267
> 
> 标签：ruby-on-rails, ruby, logging, threadpool, backgroundrb

似乎由于线程问题 logger.warn （这就是我测试的）没有产生任何输出？我的代码与此类似：

```
def deliver(args)
  logger.info "delivery start"
  thread_pool.defer(:deliver_deferred, args)
  logger.info "delivery end"
end

def deliver_deferred(args)
  logger.warn "whatsoever"
end 
```

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T19:44:39.113

我不确定具体细节，但假设 BackgrounDRb 作为分叉进程运行，则任何打开的文件都会为分叉子进程关闭。这可能会表现为您所看到的。

但是，我会假设 BackgrounDRb 足够聪明来处理这个问题，因为它应该是一个非常明显的问题。

# eclipse - J2EE eclipse文件上传项目需要在服务器注册新文件之前在包资源管理器上刷新？

> ID：323473
> 
> 赞同：3
> 
> 时间：2008-11-27T10:58:35.683
> 
> 标签：eclipse

我正在使用 struts 构建图像上传模块。

但是，我遇到了用户无法看到他们上传的文件的问题，直到我在 Eclipse 上手动刷新包资源管理器。

有谁知道如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T11:21:32.127

可能是这样的选择：

```
Preference > General > Workspace > 'Refresh automatically' 
```

有助于 ？（eclipse3.4的设置）

注意：“自动刷新”是[在 eclipse3.0 中引入的](http://dev.eclipse.org/viewcvs/index.cgi/platform-core-home/documents/auto_refresh.html?view=co)。

[CVS 文件](http://dev.eclipse.org/newslists/news.eclipse.platform/msg28687.html)也有类似的问题。

这篇[文章](http://www.eclipse.org/articles/Article-Resource-deltas/resource-deltas.html)描述了那些“刷新”的背后是什么

# clipboard - 剪贴板似乎无法正常工作，并且无法从代码或窗口访问

> ID：323485
> 
> 赞同：0
> 
> 时间：2008-11-27T11:05:58.663
> 
> 标签：clipboard

我的剪贴板似乎“卡住”了——在我的机器使用一段时间后它就停止工作了——任何试图访问它的软件都会卡住或在 Ctrl + C 或 Ctrl + V 上抛出异常。当我尝试访问时问题仍然存在它通过 .Net 框架或 Win32API（抛出异常 - 类似于“剪贴板不可用”[抱歉，我无法在此处复制粘贴它 - 我的剪贴板不起作用！:)]）

我一直在重启！

我将不胜感激任何帮助或线索，谢谢:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T11:13:44.903

我已经看到由安装剪贴板更改挂钩（[SetClipboardViewer](http://msdn.microsoft.com/en-us/library/ms649052(VS.85).aspx)）但后来挂起的应用程序引起的类似问题。因为它没有传递 WM_DRAWCLIPBOARD 消息，所以最终剪贴板停止了操作。甚至 Windows 资源管理器拖放也停止工作。

我建议你下次遇到这种情况时，检查所有非基础 Windows 应用程序并一个一个地杀死它们，直到剪贴板再次开始工作。也许使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)来确保您得到所有​​这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T11:22:05.090

看起来像旧的 SecuRom-bug。在他们的网站上有一个修复程序。

# sharepoint - 使用户无法删除 Web 部件/区域？

> ID：323492
> 
> 赞同：1
> 
> 时间：2008-11-27T11:08:53.930
> 
> 标签：sharepoint, web-parts

在 Sharepoint 中，是否可以拒绝普通用户删除 Web 部件和/或 Web 部件区域的可能性？如是; 如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T11:53:15.713

拒绝用户关闭/移动 Web 部件的选项位于 sharepoint 中 Web 部件工具窗格的“高级”部分（通过 Web 部件菜单中的“修改共享 Web 部件”选项访问）。

或者，您可以修改站点的权限级别（站点设置 > 权限 > 设置 > 权限级别）并从用户运行的级别中删除“添加/删除个人 Web 部件”和“更新个人 Web 部件”权限。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T12:16:29.363

这可以通过站点角色来控制。默认情况下，可用角色为完全控制、设计、贡献、读取和受限访问。

不是 Contribute 或更高级别成员的用户将无法删除该站点的 Web 部件或 Web 部件区域。

# sql-server - SQL Server：修改“应用程序名称”属性以进行审核

> ID：323494
> 
> 赞同：12
> 
> 时间：2008-11-27T11:09:52.413
> 
> 标签：sql-server, triggers, connection-string, audit

由于我们没有将应用程序的用户实现为 SQL 服务器中的用户，因此当应用程序服务器连接到数据库时，每个应用程序始终使用相同的凭据来附加到每个数据库。

这提出了一个审计问题。使用触发器，我们希望存储每个更新、插入和删除，并将每个更新、插入和删除都归因于特定用户。一种可能的解决方案是向每个表添加一个“由用户更新”列，并每次都更新它。这意味着每个表上都有一个新列，每个存储过程上都有一个新参数。这也意味着您只能进行软删除。

相反，我建议使用连接字符串的应用程序名称属性并使用触发器内的 App_Name() 属性读取它。我用一个简单的应用程序对此进行了测试，它似乎可以工作（格式可以是：App=MyApp|User=100）。

你们的问题是，这是一个坏主意吗？你们有更好的主意吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-27T14:27:11.563

我为此使用[SET CONTEXT_INFO](http://msdn.microsoft.com/en-us/library/ms187768.aspx)。这正是你所需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T12:49:50.450

尽管每次加载应用程序时都需要将用户名注入连接字符串，但这似乎是一个可行的解决方案。请注意，此解决方案可能不适用于 Web 应用程序，因为您的连接字符串每次都会不同，这可能会导致巨大的连接池问题。

另一种选择是检索主机名/IP 地址 (SELECT host_name() ) 并存储它。

您不必在每个存储过程上都需要一个新参数，因为您可以修改每个存储过程（或触发器）以自动插入 App_Name/Hostname。

一个潜在的缺点是通过 Management Studio 执行的任何修改都没有自定义 App_Name，并且您将留下“Microsoft Management Studio”作为用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T11:17:33.507

我们使用应用程序名称属性来控制审计触发器，使用它没有发现任何问题，也没有注意到任何速度问题（尽管在我们的例子中，我们特别不审计某些应用程序，所以很难衡量多少时间不做某事需要:)）

# c# - 递归算法生成站点地图

> ID：323503
> 
> 赞同：0
> 
> 时间：2008-11-27T11:18:14.083
> 
> 标签：c#, algorithm, recursion

我有一个包含站点地图层次结构的 DataTable，其中包含以下列：

*   项目 ID
*   父 ID
*   姓名
*   网址

我需要在 HTML 中生成一组嵌套列表（为了清楚起见，将锚元素留在了外面）：

```
<ul>
<li>Item 1</li>
<li>Item 2</li>
    <ul>
    <li>Sub Item 1</li>
    <li class="current">Sub Item 2</li>
    </ul>
<li>Item 3</li>
</ul> 
```

树应该只包含通向“当前”节点/页面的分支（因此使用上面的示例，项目“1”或“3”所具有的任何子项都不会显示。任何人都可以帮助提供一些伪代码/代码示例可以遍历树从叶子到根构建HTML吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-10T19:39:43.113

The more efficient way of doing this if you can change the data structure is using nested sets:

[Managing Hierarchical Data in MySQL](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

[Using the Nested Set Data Model for Breadcrumb Links](http://www.developer.com/db/article.php/3517366)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T15:24:38.517

这是一些伪代码。这个想法很简单：从所有未标记的节点开始，然后标记当前节点的父节点、*其父*节点等等，直到到达根节点。通过这样做，您将准确标记从当前节点到根的路径上的节点。然后您可以简单地打印另一遍中的所有节点，仅在“标记”节点上递归。这是最佳的（运行时间最多是您必须打印的节点数）。

```
for all n: mark[n]=False
n=current
while n!=root:
    n=parent[n]
    mark[n]=True

def print_tree(n):
    print_node(n)
    if mark[v]==True:
        print '<ul>'
        for each child c of n: print_tree(c)
        print '</ul>'

def print_node(n):
   if n==current: print '<li class="current">' else: print '<li>'
   print name[n]
   print "</li>"

print_tree(root) 
```

`parent[n]`并且`name[n]`可能类似于你`n.parent`的`n.name`结构。关于“对于 n 的每个孩子”部分——我假设你有一个邻接列表维护给定节点的所有孩子的列表。（如果你不这样做，那么子节点的打印顺序是什么？）在任何情况下，只需将每个节点添加到它的父母。列表的*总*大小最多是节点的数量（因为除根以外的每个节点都恰好出现在其中一个列表中），因此这些列表不会占用太多内存（单个列表可能包含很多元素，但是总大小是有界的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T11:49:44.377

我做了类似的东西，它可能效率不高，但很容易调试。

1.  查找选定节点的路径。
2.  将根节点添加到列表中。
3.  在路径中的列表中查找节点。
4.  将所有子节点添加到此节点。
5.  查找路径中的下一个节点。
6.  重复 4-5 直到在选定节点处，如果不在叶子处，则添加选定的子节点。

备选方案： 1\. 找到选定节点，打印此节点和所有兄弟节点 2\. 从 1 开始打印字符串周围的父节点和所有兄弟节点。 3\. 重复 2 直到根。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T12:24:50.970

这是 VBScript，虽然我没有尝试运行它，所以它可能包含错误，它应该给你基本的想法。

```
'# OMITTED: Code to retrieve the record for the current node, and read all info about it.
'# Note: field values are read into variables with the same names.

Dim RootFound
Dim ListHTML
RootFound = false
ListHTML = ""

if ParentID = Null then RootFound = true
ListHTML = "<ul><li>" & Name & "</li></ul>"

while not RootFound
  SQL = "SELECT * FROM DataTable WHERE ItemID = " & ParentID
  '# OMITTED: Code to open dataset using the SQL statement above and 
  'fetch all field values into identically named variables

  ListHTML = "<ul><li>" & Name & "</li>" & ListHTML & "</ul>"
  if ParentID = Null then RootFound = true
wend 
```

# sql - SqlServer 2000 兼容性

> ID：323506
> 
> 赞同：3
> 
> 时间：2008-11-27T11:20:44.717
> 
> 标签：sql, sql-server, sql-server-2000

开发者环境db server为SqlServer 2005（开发者版）

有什么方法可以确保我的 SQL 查询将在 SqlServer 2000 中运行？

此数据库设置为兼容级别“SQL Server 2000 (80)”，但某些在开发系统中运行没有问题的查询无法在测试服务器 (SqlServer) 中运行。

（问题似乎在子查询中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T11:45:14.480

兼容性级别旨在以相反的方式工作 - 允许较旧版本的 T-SQL 代码无需修改即可在较新版本的 SQL Server 上工作。更改通常涉及 T-SQL 语法和保留字，并且可以使用 SQL Server 2005 功能，例如兼容级别 80 的数据库索引中的 INCLUDED 列。但是，您不能使用 2005 T-SQL 功能，例如 CROSS申请。

您最好的选择是针对 SQL Server 2000 实例开发/测试您的所有代码。请注意，您可以使用 2005 的 Management Studio 连接到 SQL Server 2000 实例，因此您不必在工具方面倒退。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T14:04:37.587

问题解决了：

在相关子查询中，您必须（在 SQL2000 中）显式定义外部字段。

SQL2005：

```
SELECT * FROM WHERE EXISTS (SELECT * FROM Collat​​erals WHERE COLLATERAL_LOAN=LOAN_NUMBER)

```

SQL2000：

```
SELECT * FROM WHERE EXISTS (SELECT * FROM Collat​​erals WHERE COLLATERAL_LOAN=Loans.LOAN_NUMBER)

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T06:47:39.557

你应该总是显式定义所有的字段，否则你写错了就不会报错

```
SELECT * FROM Loans WHERE EXISTS (SELECT * FROM Collaterals WHERE LOAN_NUMBER=Loans.LOAN_NUMBER) 
```

如果 Collat​​erals-table 没有 LOAN_NUMBER 列，则使用 Loans-table 代替。

# python - 如何获取打开文件的名称？

> ID：323515
> 
> 赞同：39
> 
> 时间：2008-11-27T11:28:25.047
> 
> 标签：python

我试图将我从文件夹中打开的当前文件的名称存储在一个变量中。

我怎样才能做到这一点？我试过`cwd = os.getcwd()`了，但这只会给我文件夹的路径，我需要存储打开文件的名称。

你能帮我么？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2014-06-10T15:30:11.540

添加一个更有用的技巧。我同意原来的正确答案，但是如果你像我一样来到这个页面只想要文件名而没有路径的其余部分，这很好用。

```
>>> f = open('/tmp/generic.png','r')
>>> f.name
'/tmp/generic.png'
>>> import os
>>> os.path.basename(f.name)
'generic.png' 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-11-27T11:30:31.797

```
Python 2.5.1 (r251:54863, Jul 31 2008, 22:53:39)
[GCC 4.1.2 (Ubuntu 4.1.2-0ubuntu4)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> f = open('generic.png','r')
>>> f.name
'generic.png' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-27T17:36:44.303

也许这个脚本是你想要的？

```
import sys, os
print sys.argv[0]
print os.path.basename(sys.argv[0]) 
```

当我运行上面的脚本时，我得到了；

```
D:\UserData\workspace\temp\Script1.py
Script1.py 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-31T06:59:58.003

使用此代码段获取您当前正在运行的文件名（即`.py`文件）：

```
target_file = inspect.currentframe().f_code.co_filename 
```

# php - Javascript 中是否有 var_dump (PHP) 的等价物？

> ID：323517
> 
> 赞同：263
> 
> 时间：2008-11-27T11:29:30.363
> 
> 标签：php, javascript

我们需要查看对象在 Javascript 中具有哪些方法/字段。

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2008-11-27T13:45:38.933

正如其他人所说，您可以使用 Firebug，这将使您对 Firefox 无后顾之忧。Chrome 和 Safari 都有一个内置的开发者控制台，其界面与 Firebug 的控制台几乎相同，因此您的代码应该可以跨这些浏览器移植。对于其他浏览器，有[Firebug Lite](http://getfirebug.com/lite.html)。

如果 Firebug 不适合您，那么试试这个简单的脚本：

```
function dump(obj) {
    var out = '';
    for (var i in obj) {
        out += i + ": " + obj[i] + "\n";
    }

    alert(out);

    // or, if you wanted to avoid alerts...

    var pre = document.createElement('pre');
    pre.innerHTML = out;
    document.body.appendChild(pre)
} 
```

我建议不要提醒每个单独的属性：有些对象有很多属性，你会整天点击“OK”、“OK”、“OK”、“O...该死的那是我的属性寻找”。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-11-27T11:34:16.890

如果您使用的是 firefox，那么[firebug 插件](http://getfirebug.com/)控制台是检查对象的绝佳方式

```
console.debug(myObject); 
```

或者，您可以像这样遍历属性（包括方法）：

```
for (property in object) {
    // do what you want with property, object[property].value
} 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2011-08-12T00:18:34.377

许多现代浏览器支持以下语法：

```
JSON.stringify(myVar); 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2011-01-03T19:01:19.593

不能说您可以为此使用 console.debug(object) 。如果您以此为生，这项技术将每年为您节省数百小时：p

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-09-21T19:19:42.307

为了从这个问题的标题的上下文中回答这个问题，这里有一个类似于 PHP var_dump 的函数。它每次调用只转储一个变量，但它指示数据类型和值，并且它遍历数组和对象[即使它们是对象数组，反之亦然]。我相信这可以改进。我更像是一个 PHP 人。

```
/**
 * Does a PHP var_dump'ish behavior.  It only dumps one variable per call.  The
 * first parameter is the variable, and the second parameter is an optional
 * name.  This can be the variable name [makes it easier to distinguish between
 * numerious calls to this function], but any string value can be passed.
 * 
 * @param mixed var_value - the variable to be dumped
 * @param string var_name - ideally the name of the variable, which will be used 
 *       to label the dump.  If this argumment is omitted, then the dump will
 *       display without a label.
 * @param boolean - annonymous third parameter. 
 *       On TRUE publishes the result to the DOM document body.
 *       On FALSE a string is returned.
 *       Default is TRUE.
 * @returns string|inserts Dom Object in the BODY element.
 */
function my_dump (var_value, var_name)
{
    // Check for a third argument and if one exists, capture it's value, else
    // default to TRUE.  When the third argument is true, this function
    // publishes the result to the document body, else, it outputs a string.
    // The third argument is intend for use by recursive calls within this
    // function, but there is no reason why it couldn't be used in other ways.
    var is_publish_to_body = typeof arguments[2] === 'undefined' ? true:arguments[2];

    // Check for a fourth argument and if one exists, add three to it and
    // use it to indent the out block by that many characters.  This argument is
    // not intended to be used by any other than the recursive call.
    var indent_by = typeof arguments[3] === 'undefined' ? 0:arguments[3]+3;

    var do_boolean = function (v)
    {
        return 'Boolean(1) '+(v?'TRUE':'FALSE');
    };

    var do_number = function(v)
    {
        var num_digits = (''+v).length;
        return 'Number('+num_digits+') '+v;
    };

    var do_string = function(v)
    {
        var num_chars = v.length;
        return 'String('+num_chars+') "'+v+'"';
    };

    var do_object = function(v)
    {
        if (v === null)
        {
            return "NULL(0)";
        }

        var out = '';
        var num_elem = 0;
        var indent = '';

        if (v instanceof Array)
        {
            num_elem = v.length;
            for (var d=0; d<indent_by; ++d)
            {
                indent += ' ';
            }
            out = "Array("+num_elem+") \n"+(indent.length === 0?'':'|'+indent+'')+"(";
            for (var i=0; i<num_elem; ++i)
            {
                out += "\n"+(indent.length === 0?'':'|'+indent)+"|   ["+i+"] = "+my_dump(v[i],'',false,indent_by);
            }
            out += "\n"+(indent.length === 0?'':'|'+indent+'')+")";
            return out;
        }
        else if (v instanceof Object)
        {
            for (var d=0; d<indent_by; ++d)
            {
                indent += ' ';
            }
            out = "Object \n"+(indent.length === 0?'':'|'+indent+'')+"(";
            for (var p in v)
            {
                out += "\n"+(indent.length === 0?'':'|'+indent)+"|   ["+p+"] = "+my_dump(v[p],'',false,indent_by);
            }
            out += "\n"+(indent.length === 0?'':'|'+indent+'')+")";
            return out;
        }
        else
        {
            return 'Unknown Object Type!';
        }
    };

    // Makes it easier, later on, to switch behaviors based on existance or
    // absence of a var_name parameter.  By converting 'undefined' to 'empty 
    // string', the length greater than zero test can be applied in all cases.
    var_name = typeof var_name === 'undefined' ? '':var_name;
    var out = '';
    var v_name = '';
    switch (typeof var_value)
    {
        case "boolean":
            v_name = var_name.length > 0 ? var_name + ' = ':''; // Turns labeling on if var_name present, else no label
            out += v_name + do_boolean(var_value);
            break;
        case "number":
            v_name = var_name.length > 0 ? var_name + ' = ':'';
            out += v_name + do_number(var_value);
            break;
        case "string":
            v_name = var_name.length > 0 ? var_name + ' = ':'';
            out += v_name + do_string(var_value);
            break;
        case "object":
            v_name = var_name.length > 0 ? var_name + ' => ':'';
            out += v_name + do_object(var_value);
            break;
        case "function":
            v_name = var_name.length > 0 ? var_name + ' = ':'';
            out += v_name + "Function";
            break;
        case "undefined":
            v_name = var_name.length > 0 ? var_name + ' = ':'';
            out += v_name + "Undefined";
            break;
        default:
            out += v_name + ' is unknown type!';
    }

    // Using indent_by to filter out recursive calls, so this only happens on the 
    // primary call [i.e. at the end of the algorithm]
    if (is_publish_to_body  &&  indent_by === 0)
    {
        var div_dump = document.getElementById('div_dump');
        if (!div_dump)
        {
            div_dump = document.createElement('div');
            div_dump.id = 'div_dump';

            var style_dump = document.getElementsByTagName("style")[0];
            if (!style_dump)
            {
                var head = document.getElementsByTagName("head")[0];
                style_dump = document.createElement("style");
                head.appendChild(style_dump);
            }
            // Thank you Tim Down [http://stackoverflow.com/users/96100/tim-down] 
            // for the following addRule function
            var addRule;
            if (typeof document.styleSheets != "undefined" && document.styleSheets) {
                addRule = function(selector, rule) {
                    var styleSheets = document.styleSheets, styleSheet;
                    if (styleSheets && styleSheets.length) {
                        styleSheet = styleSheets[styleSheets.length - 1];
                        if (styleSheet.addRule) {
                            styleSheet.addRule(selector, rule)
                        } else if (typeof styleSheet.cssText == "string") {
                            styleSheet.cssText = selector + " {" + rule + "}";
                        } else if (styleSheet.insertRule && styleSheet.cssRules) {
                            styleSheet.insertRule(selector + " {" + rule + "}", styleSheet.cssRules.length);
                        }
                    }
                };
            } else {
                addRule = function(selector, rule, el, doc) {
                    el.appendChild(doc.createTextNode(selector + " {" + rule + "}"));
                };
            }

            // Ensure the dump text will be visible under all conditions [i.e. always
            // black text against a white background].
            addRule('#div_dump', 'background-color:white', style_dump, document);
            addRule('#div_dump', 'color:black', style_dump, document);
            addRule('#div_dump', 'padding:15px', style_dump, document);

            style_dump = null;
        }

        var pre_dump = document.getElementById('pre_dump');
        if (!pre_dump)
        {
            pre_dump = document.createElement('pre');
            pre_dump.id = 'pre_dump';
            pre_dump.innerHTML = out+"\n";
            div_dump.appendChild(pre_dump);
            document.body.appendChild(div_dump);
        }  
        else
        {
            pre_dump.innerHTML += out+"\n";
        }
    }
    else
    {
        return out;
    }
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-08-29T19:12:29.527

您希望以 JSON 形式查看整个对象（对象和变量的所有嵌套级别）。JSON 代表 JavaScript Object Notation，打印出对象的 JSON 字符串相当于`var_dump`（获取 JavaScript 对象的字符串表示）。幸运的是，JSON 在代码中非常易于使用，而且 JSON 数据格式也非常易于人类阅读。

例子：

```
var objectInStringFormat = JSON.stringify(someObject);
alert(objectInStringFormat); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-08-01T17:20:43.410

[无论是 firebug 还是 google-chrome web-inspector 中的console.dir](http://getfirebug.com/logging/)（指向链接页面的底部）都将输出对象属性的交互式列表。

另请参阅[此 Stack-O 答案](https://stackoverflow.com/a/11656075/564406)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-27T11:39:13.633

如果您使用 Firebug，您可以使用[console.log](http://getfirebug.com/console.html)输出一个对象并在控制台中获取一个超链接、可探索的项目。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-02-13T02:31:56.100

对于不知道传入变量类型的人来说，对 nickf 的功能进行了一些改进：

```
function dump(v) {
    switch (typeof v) {
        case "object":
            for (var i in v) {
                console.log(i+":"+v[i]);
            }
            break;
        default: //number, string, boolean, null, undefined 
            console.log(typeof v+":"+v);
            break;
    }
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-11-28T08:14:05.707

我改进了 nickf 的答案，所以它递归地遍历对象：

```
function var_dump(obj, element)
{
    var logMsg = objToString(obj, 0);
    if (element) // set innerHTML to logMsg
    {
        var pre = document.createElement('pre');
        pre.innerHTML = logMsg;
        element.innerHTML = '';
        element.appendChild(pre);
    }
    else // write logMsg to the console
    {
        console.log(logMsg);
    }
}

function objToString(obj, level)
{
    var out = '';
    for (var i in obj)
    {
        for (loop = level; loop > 0; loop--)
        {
            out += "    ";
        }
        if (obj[i] instanceof Object)
        {
            out += i + " (Object):\n";
            out += objToString(obj[i], level + 1);
        }
        else
        {
            out += i + ": " + obj[i] + "\n";
        }
    }
    return out;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-10-20T10:45:55.193

```
console.log(OBJECT|ARRAY|STRING|...);
console.info(OBJECT|ARRAY|STRING|...);
console.debug(OBJECT|ARRAY|STRING|...);
console.warn(OBJECT|ARRAY|STRING|...);
console.assert(Condition, 'Message if false'); 
```

这些应该可以在 Google Chrome 和 Mozilla Firefox 上正常工作（如果你运行的是旧版本的 firefox，那么你必须安装 Firebug 插件）
在 Internet Explorer 8 或更高版本上，你必须执行以下操作：

*   通过单击 F12 按钮启动“开发人员工具”
*   在选项卡列表上，单击“脚本”选项卡”
*   点击右侧的“控制台”按钮

有关更多信息，您可以访问此 URL：[https ://developer.chrome.com/devtools/docs/console-api](https://developer.chrome.com/devtools/docs/console-api)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-03-05T07:50:02.773

**你可以简单地使用 NPM 包 var_dump**

```
npm install var_dump --save-dev 
```

用法：

```
const var_dump = require('var_dump')

var variable = {
  'data': {
    'users': {
      'id': 12,
      'friends': [{
        'id': 1,
        'name': 'John Doe'
      }]
    }
  }
}

// print the variable using var_dump
var_dump(variable) 
```

这将打印：

```
object(1) {
    ["data"] => object(1) {
        ["users"] => object(2) {
            ["id"] => number(12)
            ["friends"] => array(1) {
                [0] => object(2) {
                    ["id"] => number(1)
                    ["name"] => string(8) "John Doe"
                }
            }
        }
    }
} 
```

链接：[https ://www.npmjs.com/package/@smartankur4u/vardump](https://www.npmjs.com/package/@smartankur4u/vardump)

晚点再谢我！

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-10-19T05:50:19.297

如果你正在寻找用 JS 转换的 PHP 函数，有这个小站点： http: [//phpjs.org](http://phpjs.org)。在那里，您可以获得大部分用 JS 可靠编写的 PHP 函数。对于 var_dump 尝试：[http://phpjs.org/functions/var_dump/](http://phpjs.org/functions/var_dump/)（确保检查顶部评论，这取决于“回声”，也可以从同一站点下载）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-02-03T18:32:19.830

我使用了第一个答案，但我觉得其中缺少递归。

结果是这样的：

```
function dump(obj) {
    var out = '';
    for (var i in obj) {
        if(typeof obj[i] === 'object'){
            dump(obj[i]);
        }else{
            out += i + ": " + obj[i] + "\n";
        }
    }

    var pre = document.createElement('pre');
    pre.innerHTML = out;
    document.body.appendChild(pre);
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-08-04T15:28:51.290

基于在这篇文章中找到的以前的功能。添加了递归模式和缩进。

```
function dump(v, s) {
  s = s || 1;
  var t = '';
  switch (typeof v) {
    case "object":
      t += "\n";
      for (var i in v) {
        t += Array(s).join(" ")+i+": ";
        t += dump(v[i], s+3);
      }
      break;
    default: //number, string, boolean, null, undefined 
      t += v+" ("+typeof v+")\n";
      break;
  }
  return t;
} 
```

例子

```
var a = {
  b: 1,
  c: {
    d:1,
    e:2,
    d:3,
    c: {
      d:1,
      e:2,
      d:3
    }
  }
};

var d = dump(a);
console.log(d);
document.getElementById("#dump").innerHTML = "<pre>" + d + "</pre>"; 
```

结果

```
b: 1 (number)
c: 
   d: 3 (number)
   e: 2 (number)
   c: 
      d: 3 (number)
      e: 2 (number) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-09-06T17:31:52.120

这是我的解决方案。它复制了`var_dump`well 的行为，并允许嵌套对象/数组。请注意，它不支持多个参数。

```
function var_dump(variable) {
  let out = "";

  let type = typeof variable;
  if(type == "object") {
    var realType;
    var length;
    if(variable instanceof Array) {
      realType = "array";
      length = variable.length;
    } else {
      realType = "object";
      length = Object.keys(variable).length;
    }
    out = `${realType}(${length}) {`;
      for (const [key, value] of Object.entries(variable)) {
    out += `\n [${key}]=>\n ${var_dump(value).replace(/\n/g, "\n  ")}\n`;
  }
  out += "}";
  } else if(type == "string") {
    out = `${type}(${type.length}) "${variable}"`;
  } else {
    out = `${type}(${variable.toString()})`;
  }
  return out;
}
console.log(var_dump(1.5));
console.log(var_dump("Hello!"));
console.log(var_dump([]));
console.log(var_dump([1,2,3,[1,2]]));

console.log(var_dump({"a":"b"}));
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-01-09T02:45:43.600

以下是我最喜欢的**var_dump/print_r**在 Javascript 中与 PHP等效`var_dump`。

```
function dump(arr,level) {
    var dumped_text = "";
    if(!level) level = 0;

    //The padding given at the beginning of the line.
    var level_padding = "";
    for(var j=0;j<level+1;j++) level_padding += "    ";

    if(typeof(arr) == 'object') { //Array/Hashes/Objects 
        for(var item in arr) {
        var value = arr[item];
            if(typeof(value) == 'object') { //If it is an array,
                dumped_text += level_padding + "'" + item + "' ...\n";
                dumped_text += dump(value,level+1);
            } else {
                dumped_text += level_padding + "'" + item + "' => \"" + value + "\"\n";
            }
        }
    } else { //Stings/Chars/Numbers etc.
        dumped_text = "===>"+arr+"<===("+typeof(arr)+")";
    }
    return dumped_text;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-07-26T12:43:35.663

游戏迟到了，但这里有一个非常方便的函数，使用起来超级简单，允许您传递任意类型的任意数量的参数，并将在浏览器控制台窗口中显示对象内容，就像您调用了控制台一样。来自 JavaScript 的日志 - 但来自 PHP

请注意，您也可以通过传递“TAG-YourTag”来使用标签，它将一直应用到另一个标签被读取，例如，“TAG-YourNextTag”

```
/*
*   Brief:          Print to console.log() from PHP
*   Description:    Print as many strings,arrays, objects, and other data types to console.log from PHP.
*                   To use, just call consoleLog($data1, $data2, ... $dataN) and each dataI will be sent to console.log - note that
*                   you can pass as many data as you want an this will still work.
*
*                   This is very powerful as it shows the entire contents of objects and arrays that can be read inside of the browser console log.
*                   
*                   A tag can be set by passing a string that has the prefix TAG- as one of the arguments. Everytime a string with the TAG- prefix is
*                   detected, the tag is updated. This allows you to pass a tag that is applied to all data until it reaches another tag, which can then
*                   be applied to all data after it.
*
*                   Example:
*                   consoleLog('TAG-FirstTag',$data,$data2,'TAG-SecTag,$data3); 
*                   Result:
*                       FirstTag '...data...'
*                       FirstTag '...data2...'
*                       SecTag   '...data3...' 
*/
function consoleLog(){
    if(func_num_args() == 0){
        return;
    }

    $tag = '';
    for ($i = 0; $i < func_num_args(); $i++) {
        $arg = func_get_arg($i);
        if(!empty($arg)){       
            if(is_string($arg)&& strtolower(substr($arg,0,4)) === 'tag-'){
                $tag = substr($arg,4);
            }else{      
                $arg = json_encode($arg, JSON_HEX_TAG | JSON_HEX_AMP );
                echo "<script>console.log('".$tag." ".$arg."');</script>";
            }       
        }
    }
} 
```

注意：**func_num_args()**和**func_num_args()**是 php 函数，用于读取动态数量的输入 args，并允许此函数从一个函数调用获得无限多个 console.log 请求

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-30T12:23:05.287

我只是想添加一些关于console.log的相对重要的东西

如果您正在调试大型变量（如大型音频或视频数据缓冲区）。当您打印 console.log(big_variable) 时，控制台只会显示其中的一小部分。（这似乎有点明显）。

但是，如果变量处于循环中并且该变量不断变化，如果您曾经“将其复制到剪贴板”，则浏览器将做的就是再次请求变量（并且在您访问时可能已经改变）复制）。

我会告诉你我的故事。我正在编写一个处理大量音频数据的应用程序，其 Float32arrays 大小为 8192。如果缓冲区具有某些特征，我将使用 console.log() 打印该变量，然后抓取该变量进行测试和玩弄使用它（甚至将它用于模拟，以便我可以进行自动化测试）

然而，结果永远不会成立。麦克风将捕获音频数据，将其存储在 this.audioBuffer 变量中，整个过程都可以正常工作，但是当我从 console.log 复制该变量时，我可以将其作为模拟运行一些自动化测试，行为会发生巨大变化。

我花了一段时间才弄清楚这一点，显然，每当我在调试器中“复制”或“将变量设置为全局”时，而不是复制显示在 console.log 中的变量，jsvm 会再次要求 this.audioBuffer . 由于变量是在循环内使用的，麦克风仍然会记录，我会得到一个与我正在听的完全不同的声音阵列，并认为音频缓冲区首先出现。

如果您正在处理大型复杂数据结构，例如音频或视频文件、图像文件……并且当您读取 chrome /firefox / edge 控制台中的值时，这些数据结构可能会发生变化，请确保您没有使用 console.log （变量），而是console.log（JSON.stringify（变量））。这将为您节省大量时间

# c# - 带有事件的 asp:table 问题中复选框的动态构造

> ID：323519
> 
> 赞同：0
> 
> 时间：2008-11-27T11:29:59.940
> 
> 标签：c#, asp.net, .net-2.0, autopostback

我目前正在动态构建一个包含**复选框的****asp:table** ， 这些复选框有一个**CheckChanged**事件作为**自动回**发。

 ******```
v_articleCheckBox.CheckedChanged += new EventHandler(v_articleCheckBox_CheckedChanged); 
```

我将复选框状态存储在视图状态中，并且在每次页面加载时都重建表，以便视图状态可以重新应用于复选框。

对于每个复选框，但第一个复选框非常有效。

奇怪的情况是第一个复选框在 check 事件上起作用，但根本没有在**uncheck 事件上调用****v_articleCheckBox_CheckedChanged**方法

 **有人有想法吗？

我正在考虑添加一个虚拟复选框作为表中的第一个条目，然后简单地将其隐藏在客户端。但这似乎是一个不好的解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-03T12:53:03.940

> 我很好奇：问题是什么？– splattne（11 月 27 日 11:39）
> 我也很好奇 – JohnIdol（11 月 27 日 13:48）

我通过修改我的逻辑解决了这个问题，以便在更通用的基础上触发一些事件，我只是避免了这个问题。

我不知道发生这种情况的原因或方式；我只是找到了适合我需要的工作。

# lucene - Lucene.Net 和 Geosearch - 它在某个地方吗？

> ID：323520
> 
> 赞同：2
> 
> 时间：2008-11-27T11:30:08.067
> 
> 标签：lucene, lucene.net

我发现了一篇关于 Lucene 和地理搜索的有趣文章：

[http://sujitpal.blogspot.com/2008/02/spatial-search-with-lucene.html](http://sujitpal.blogspot.com/2008/02/spatial-search-with-lucene.html)

是否存在我无法找到的等效 .NET 实现，或者我是否必须在他的示例中重新编写 Java 代码以适应 .NET Framework？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:07:35.113

我也看到了这篇文章。我在谷歌搜索中没有看到特定于 .NET 的内容，因此我计划在需要时也可能移植此代码。现在，我刚刚开始接触 Lucene.NET，还没有达到让我对它感到足够舒服并开始扩展它的地步。

文章中的代码似乎是 Lucene In Action 中概述的概念地理距离功能的派生示例。虽然这本书是基于 Java 产品的，但它是一本很好的读物。样品很容易移植，而且信息量很大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-12T07:23:21.660

在最新的 lucene.net contrib 文件夹中，有空间贡献来执行地理搜索，请参阅

[https://svn.apache.org/repos/asf/incubator/lucene.net/tags/Lucene.Net_2_9_1/contrib/Spatial.Net/](https://svn.apache.org/repos/asf/incubator/lucene.net/tags/Lucene.Net_2_9_1/contrib/Spatial.Net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T19:30:00.343

随着即将发布的 Lucene.NET 3.0.3，有一个全新的空间贡献。看：

[http://www.code972.com/blog/2012/05/the-future-of-geo-spatial-searches-with-lucene/](http://www.code972.com/blog/2012/05/the-future-of-geo-spatial-searches-with-lucene/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-08T12:15:58.640

[在https://www.leapinggorilla.com/Blog/Read/1010/spatial-search-in-lucenenet---worked-example](https://www.leapinggorilla.com/Blog/Read/1010/spatial-search-in-lucenenet---worked-example)有工作示例

问候

伊斯梅尔

# version-control - 使用 mercurial 和 Beyond compare 3(bc3) 作为差异工具？

> ID：323521
> 
> 赞同：29
> 
> 时间：2008-11-27T11:30:08.740
> 
> 标签：version-control, mercurial, diff, beyondcompare

在 Windows 中，我可以使用 winmerge 作为 hg 的外部差异工具，使用*mercurial.ini*等。
使用一些您可以在网络上找到的选项开关（我认为这是一个日本网站）无论如何，这里例如：

```
hg winmerge -r1 -r2
```

将列出 winmerge 中 rev1 和 rev2 之间的文件更改。我可以点击哪个文件来区分

但对于 bc3：

```
hg bcomp -r1 -r2
```

将使 bc3 打开一个对话框，指出找不到临时目录。

使用 bc3 和 hg 我能做的最多的是

```
hg bcomp -r1 -r2 myfile.cpp
```

这将打开 myfile.cpp 的 rev1 和 rev2 之间的差异

因此，似乎 hg+bc3 无法成功确认修订之间的所有文件更改。一次只能区分 1 个文件。
任何人都可以更好地使用 bc3 + hg 吗？

编辑：问题解决了！

从 http://www.scootersoftware.com/support.php?zz=kb_vcs.php>scooter 支持页面获得解决方案。我必须使用*bcompare*而不是*bcomp* 这是我的 mercurial.ini 的片段

```
[扩展]
hgext.win32text =

;mhd 添加
hgext.extdiff =

;mhd 为 bc 添加
[扩展差异]
cmd.bc3 = bcompare
opts.bc3 = /ro

;mhd 为 winmerge 添加
;[扩展差异]
;cmd.winmerge = WinMergeU
;opts.winmerge = /r /e /x /ub

```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-21T08:55:39.970

Beyond-Compare-3 是一个了不起的工具。我建议对设置进行一些调整：

```
[extensions]
extdiff =

[extdiff]
cmd.bcomp = C:\Program Files\Beyond Compare 3\BCompare.exe
opts.bcomp = /leftreadonly

[merge-tools]
bcomp.executable = C:\Program Files\Beyond Compare 3\BComp
bcomp.args = /leftreadonly /centerreadonly $local $other $base $output
bcomp.priority = 1

[ui]
merge = bcomp

[tortoisehg]
authorcolor = True
vdiff = bcomp 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-10-08T18:54:48.580

我个人发现最好的 Beyond Compare 配置可以在 Mercurial[`mergetools.rc file`](https://www.mercurial-scm.org/repo/hg/file/tip/mercurial/default.d/mergetools.rc#l95)文件中找到：

```
[merge-tools]
....
; Windows version of Beyond Compare
beyondcompare3.args=$local $other $base $output /ro /lefttitle=local /centertitle=base /righttitle=other /automerge /reviewconflicts /solo
beyondcompare3.regkey=Software\Scooter Software\Beyond Compare 3
beyondcompare3.regname=ExePath
beyondcompare3.gui=True
beyondcompare3.priority=-2
beyondcompare3.diffargs=/lro /lefttitle='$plabel1' /righttitle='$clabel' /solo /expandall $parent $child 
```

我还发现**不要**在部分中包含 Beyond Compare很重要，`extdiff`因此它将使用带有参数`beyondcompare3`的部分。（我在和中都指定了）`merge-tools``diffargs``beyondcompare3``ui.merge``tortoisehg.vdiff`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-31T22:02:22.377

I had to add the following to make it work on my machine:

```
[extensions]
extdiff =

[extdiff]
cmd.bc3 = C:\Program Files\Beyond Compare 3\BCompare.exe
opts.bc3 = /ro 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-04-21T09:28:33.057

如果您不断从 BC 收到此“文件夹不可用”错误（当我同时打开多个 BC 实例时，我确实这样做了），请尝试`/solo`在命令行中添加选项，即：

```
[extdiff]
cmd.bcomp = C:\Program Files\Beyond Compare 3\BCompare.exe
opts.bcomp = /leftreadonly /solo 
```

资料来源：[踏板车软件支持论坛](http://www.scootersoftware.com/vbulletin/showthread.php?t=5093&highlight=mercurial)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-07-01T14:26:01.577

[从 Scooter Software 支持页面查看此页面](http://www.scootersoftware.com/support.php?zz=kb_vcs)- 它还包括大多数版本控制系统的设置 - 我的书签列表中的一个！

片段：

要配置 Mercurial，您需要编辑文件 %USERPROFILE%\Mercurial.ini 或 $HOME/.hgrc。添加以下行，如果它们已经存在，则使用现有的 INI 部分：

**差异**

```
[extensions] extdiff =

[extdiff] 
cmd.bcomp = C:\Program Files\Beyond Compare 3\BCompare.exe
opts.bcomp = /ro

[tortoisehg] vdiff = bcomp 
```

设置完成后，您可以使用命令行比较修订版

```
hg bcomp -r <rev1> [-r <rev2>] [<filename>] 
```

**三向合并 (v3 Pro)**

```
[merge-tools] 
bcomp.executable = C:\Program Files\Beyond Compare 3\BComp 
bcomp.args = $local $other
$base $output bcomp.priority = 1
bcomp.premerge = True bcomp.gui = True

[ui] merge = bcomp 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-27T19:43:33.217

我尝试了当时给出的建议，但没有一个奏效。

我发现了以下作品：

1.  添加超越比较安装目录到你的系统`path`
2.  打开全局设置并将差异工具设置为`bcompare`

现在尝试一个差异 - 超越比较！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-22T19:20:25.753

到目前为止给出的所有答案都是针对 Windows 的。这是我为使用 Linux 的用户的配置。

### 差异

```
[extensions]
extdiff =

[extdiff]
cmd.bcomp = bcompare
opts.bcomp = -ro1 
```

### 4 路合并 (v3 Pro)

```
[merge-tools]
bcomp.executable = bcompare
bcomp.args = -title1='First Parent' -title2='Second Parent' -title3='Common Ancestor' -title4='Output' -ro1 -ro2 -ro3 $local $other $base $output
bcomp.premerge = True
bcomp.gui = True 
```

`-ro#`：禁用指定侧的编辑

`-title#=<title>`：在路径编辑中显示描述而不是文件名

`#`字符：1=左，2=右，3=中，4=输出

如需更多选项`bcompare`，只需`bcompare -help`在控制台中执行即可。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-05T15:12:36.680

如果您使用 TortoiseHg，您可以通过选择 File -> Settings 将合并工具设置为 Beyond Compare，然后在 TortoiseHg 选项上，选择 Visual Diff Tool 和 Three-way Merge Tool。此设置也会影响通过命令行设置的合并。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-22T13:49:36.970

如果您无法正确解析配置，请注意任何变量或部分名称的任何空格都会导致配置解析不正确。我一直在复制和粘贴不同的配置并继续出错。结果只是在许多变量之前添加了空格，导致它无法解析。

# jquery - jQuery $.ajaxSend() settings.data 为空

> ID：323526
> 
> 赞同：1
> 
> 时间：2008-11-27T11:32:30.310
> 
> 标签：jquery, ajax

我发现了奇怪的错误（也许）。当我以散列的形式向$.ajax 发送参数，并尝试检查$.ajaxSend 中的参数时，我发现settings.data 为空，settings.url 正常，包含参数。然后我查看了 jQuery 代码，发现数据被删除了。

```
 // If data is available, append data to url for get requests
    if ( s.data && type == "GET" ) {
        s.url += (s.url.match(/\?/) ? "&" : "?") + s.data;

        // IE likes to send both get and post data, prevent this
        s.data = null;
    } 
```

现在我需要解析 url ((。怎么办？

[在 JQuery 中，使用 ajaxSend 预览 $.post 调用构建的 url](https://stackoverflow.com/questions/73885/in-jquery-using-ajaxsend-to-preview-the-url-built-by-post-call)

在评论中，我看到数据应该在那里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T12:16:03.873

默认情况下，作为非字符串数据传递的任何内容都会被处理并转换为查询字符串。因此，如果您使用 POST 跳过该错误：

```
 $.post({
      url: "http://yourserver/ajax" ,
      data: {param1: 'val1', param2:'val2'}
 }); 
```

在`$.ajaxSend`将的值中，您`settings.data`将`'param1=val1&param2=val2'`需要解析参数，就像使用 GET 一样。

如果您想避免解析 url 或数据，只需在构建设置对象时添加数据的副本。额外的参数不应该引起任何问题。

```
 var data = {param1: 'val1', param2:'val2'};
 $.get({
      url: "http://yourserver/ajax" ,
      data: data,
      dataCopy: data
 }); 
```

然后，`$.ajaxSend`您可以检查 中的值`settings.dataCopy`。

# vmware-server - 在 VMWare 工作站上运行的 VMWare ESX 映像

> ID：323527
> 
> 赞同：2
> 
> 时间：2008-11-27T11:33:29.357
> 
> 标签：vmware-server, vmware-tools

我有一个在 VMWare ESX 3.1 上运行的 linux 映像（debian）。是否可以复制该映像并在我的本地 VMWare 工作站上本地运行它？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T22:56:15.237

只需打开 VI 客户端，关闭 VM，浏览到数据存储，然后下载映像。真的很简单，我一直从 ESXi 3.5 -> Workstation 6.5 开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T22:43:01.470

我*相信*，虽然 ESX（商业）与 Server（免费）反向兼容，但 Server与 ESX**不**向前兼容。

因此，您可以将服务器映像导入 ESX，但反之则不行。

但是，您*可以*从 ESX 主机转到 ESXi（免费）主机。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T22:55:59.573

据我记得，这正是我几周前所做的。我导出了图像（导出工具包含在 ESX 中，但是在导出图像时必须关闭图像）。导出图像后，我通过 VMware 转换器（免费工具）运行它并将其转换为在工作站/播放器上运行。但是，当我安装 VMWorkstation 时，我的笔记本电脑总是崩溃，所以我在 VMPlayer 上运行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-23T19:07:14.037

我们也有这样的环境，并且从过去 5 年开始一直在努力。我们拥有运行 Centos OS 虚拟机等的 ESXi 3.5 虚拟化环境。为了在我们的本地机器上使用来自 ESXi 的虚拟机，我们安装了 VMWare Workstation（也是 VMWare Player）。我们使用[mondoarchive](http://mondorescue.org)进行完整的 mondo 备份。然后我们在本地机器上传输这些图像。从这些映像中，我们在本地 VMWare 工作站环境中恢复基于 ESXi 的虚拟机。在过去的五年里，它取得了巨大的成功，我们从未遇到过任何问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-14T13:10:07.820

您还可以使用 Vizioncore vConverter 或 FastSCP 进行迁移。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T09:31:48.390

Kasper，你运行的是什么版本的 ESX？尝试从我们的 ESX 服务器导出映像总是以 I/O 错误结束（现在无法访问服务器，所以我不记得确切的错误消息）。

很想让这个功能正常工作，但我在网上找不到任何可能有助于解决这个特定错误的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-18T12:31:37.710

这是一篇很好的文章，描述了如何转换不同的图像：请仔细阅读。 [http://www.dedoimedo.com/computers/vmware-converter.html](http://www.dedoimedo.com/computers/vmware-converter.html)

# c# - ASP.NET 如何获取 Active Directory 中的组列表

> ID：323536
> 
> 赞同：19
> 
> 时间：2008-11-27T11:39:20.420
> 
> 标签：c#, asp.net, vb.net, active-directory

如何获取 Active Directory 中组的完整列表？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-27T12:08:38.193

查看 System.DirectoryServices（ASP.NET 2.0 参考）：

C#-获取组的示例：

```
using System.DirectoryServices; 

public class test
{

    private void main()
    {
        foreach (string @group in GetGroups())
        {
            Debug.Print(@group);
        }
    }

    public List<string> GetGroups()
    {
        DirectoryEntry objADAM = default(DirectoryEntry);
        // Binding object. 
        DirectoryEntry objGroupEntry = default(DirectoryEntry);
        // Group Results. 
        DirectorySearcher objSearchADAM = default(DirectorySearcher);
        // Search object. 
        SearchResultCollection objSearchResults = default(SearchResultCollection);
        // Results collection. 
        string strPath = null;
        // Binding path. 
        List<string> result = new List<string>();

        // Construct the binding string. 
        strPath = "LDAP://stefanserver.stefannet.local";
        //Change to your ADserver 

        // Get the AD LDS object. 
        try
        {
            objADAM = new DirectoryEntry(strPath);
            objADAM.RefreshCache();
        }
        catch (Exception e)
        {
            throw e;
        }

        // Get search object, specify filter and scope, 
        // perform search. 
        try
        {
            objSearchADAM = new DirectorySearcher(objADAM);
            objSearchADAM.Filter = "(&(objectClass=group))";
            objSearchADAM.SearchScope = SearchScope.Subtree;
            objSearchResults = objSearchADAM.FindAll();
        }
        catch (Exception e)
        {
            throw e;
        }

        // Enumerate groups 
        try
        {
            if (objSearchResults.Count != 0)
            {
                foreach (SearchResult objResult in objSearchResults)
                {
                    objGroupEntry = objResult.GetDirectoryEntry();
                    result.Add(objGroupEntry.Name);
                }
            }
            else
            {
                throw new Exception("No groups found");
            }
        }
        catch (Exception e)
        {
            throw new Exception(e.Message);
        }

        return result;
    }

} 
```

获取组的 VB 示例：

```
Imports System.DirectoryServices

Public Class Form1

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    For Each group As String In GetGroups()
        Debug.Print(group)
    Next
End Sub

Public Function GetGroups() As List(Of String)
    Dim objADAM As DirectoryEntry                   ' Binding object.
    Dim objGroupEntry As DirectoryEntry             ' Group Results.
    Dim objSearchADAM As DirectorySearcher          ' Search object.
    Dim objSearchResults As SearchResultCollection  ' Results collection.
    Dim strPath As String                           ' Binding path.
    Dim result As New List(Of String)

    ' Construct the binding string.        
    strPath = "LDAP://stefanserver.stefannet.local" 'Change to your ADserver

    ' Get the AD LDS object.
    Try
        objADAM = New DirectoryEntry(strPath)
        objADAM.RefreshCache()
    Catch e As Exception
        Throw e
    End Try

    ' Get search object, specify filter and scope,
    ' perform search.
    Try
        objSearchADAM = New DirectorySearcher(objADAM)
        objSearchADAM.Filter = "(&(objectClass=group))"
        objSearchADAM.SearchScope = SearchScope.Subtree
        objSearchResults = objSearchADAM.FindAll()
    Catch e As Exception
        Throw e
    End Try

    ' Enumerate groups
    Try
        If objSearchResults.Count <> 0 Then
            Dim objResult As SearchResult
            For Each objResult In objSearchResults
                objGroupEntry = objResult.GetDirectoryEntry
                result.Add(objGroupEntry.Name)
            Next objResult
        Else
            Throw New Exception("No groups found")
        End If
    Catch e As Exception
        Throw New Exception(e.Message)
    End Try

    Return result
End Function
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T12:03:44.537

Microsoft .NET Framework 提供了用于使用 Active Directory 的标准库：**[System.DirectoryServices.dll](http://msdn.microsoft.com/en-us/library/ms682458(VS.85).aspx)**中的 System.DirectoryServices 命名空间。

Microsoft 建议使用 System.DirectoryServices 命名空间中的两个主要类：**DirectoryEntry**和**DirectorySearcher**。在大多数情况下，仅使用 DirectorySearcher 类就足够了。

[您可以在此CodeProject 文章](http://www.codeproject.com/KB/system/QueryADwithDotNet.aspx)中找到一些示例。

# wpf - 绑定转换器和多重绑定

> ID：323547
> 
> 赞同：0
> 
> 时间：2008-11-27T11:48:46.113
> 
> 标签：wpf

我想创建 4 个堆叠成一行的矩形。

|----|---|------|------------|

每个矩形的宽度都绑定到以 % 为单位的值。

我决定将矩形分组到水平 StackPanel。要计算矩形的宽度，我要编写转换器。

我不知道如何创建必须绑定到的转换器： - % 中的值我想将父级的宽度传递给转换器参数。

如何编写参数以将其绑定到父母的宽度？

谢谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T16:45:04.610

摆脱 StackPanel 并放置一个具有 1 行 4 列的 Grid，这样就可以了。您可以调整控件的大小，它会正常运行。波纹管代码 ColumnDefinition Width 实际上是一个百分比值。例如，第一个矩形波纹管占总宽度的 20%，因为 ColumnDefinition 在该列上设置了 0.2*。

```
 <Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="0.2*"/>
        <ColumnDefinition Width="0.1*"/>
        <ColumnDefinition Width="0.25*"/>
        <ColumnDefinition Width="0.45*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition /> 
    </Grid.RowDefinitions>

    <Rectangle Grid.Column="0" Fill="Black" Stroke="White" StrokeThickness="1"/>
    <Rectangle Grid.Column="1" Fill="Black" Stroke="White" StrokeThickness="1"/>
    <Rectangle Grid.Column="2" Fill="Black" Stroke="White" StrokeThickness="1"/>
    <Rectangle Grid.Column="3" Fill="Black" Stroke="White" StrokeThickness="1"/>
</Grid> 
```

# wcf - 请求 WCF 服务合同时出现 HTTP 错误请求错误

> ID：323551
> 
> 赞同：13
> 
> 时间：2008-11-27T11:49:49.387
> 
> 标签：wcf, http, exception, wsdl

我有一个具有以下配置的 WCF 服务：

```
<system.serviceModel>
    <behaviors>
        <serviceBehaviors>
            <behavior name="MetadataEnabled">
                <serviceDebug includeExceptionDetailInFaults="true" />
                <serviceMetadata httpGetEnabled="true" />
            </behavior>
        </serviceBehaviors>
     </behaviors>
      <services>
          <service behaviorConfiguration="MetadataEnabled" name="MyNamespace.MyService">
              <endpoint name="BasicHttp"
                        address=""
                        binding="basicHttpBinding"
                        contract="MyNamespace.IMyServiceContract" />
              <endpoint name="MetadataHttp"
                        address="contract"
                        binding="mexHttpBinding" 
                        contract="IMetadataExchange" />
              <host>
                  <baseAddresses>
                      <add baseAddress="http://localhost/myservice" />
                  </baseAddresses>
              </host>
          </service>
    </services>
</system.serviceModel> 
```

在**WcfSvcHost.exe**进程中托管服务时，如果我浏览到 URL：

> [http://localhost/myservice/contract](http://localhost/myservice/contract)

在服务元数据可用的地方，我收到**HTTP 400 Bad Request**错误。

通过检查 WCF 日志，我发现**System.Xml.XmlException**异常与消息一起引发：“消息*的正文无法读取，因为它是空的。* ”
这是日志文件的摘录：

```
<Exception>
<ExceptionType>
System.ServiceModel.ProtocolException, System.ServiceModel, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
</ExceptionType>
<Message>There is a problem with the XML that was received from the network. See inner exception for more details.</Message>
<StackTrace>
at System.ServiceModel.Channels.HttpRequestContext.CreateMessage()
at System.ServiceModel.Channels.HttpChannelListener.HttpContextReceived(HttpRequestContext context, ItemDequeuedCallback callback)
at System.ServiceModel.Channels.SharedHttpTransportManager.OnGetContextCore(IAsyncResult result)
at System.ServiceModel.Channels.SharedHttpTransportManager.OnGetContext(IAsyncResult result)
at System.ServiceModel.Diagnostics.Utility.AsyncThunk.UnhandledExceptionFrame(IAsyncResult result)
at System.Net.LazyAsyncResult.Complete(IntPtr userToken)
at System.Net.LazyAsyncResult.ProtectedInvokeCallback(Object result, IntPtr userToken)
at System.Net.ListenerAsyncResult.WaitCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)
</StackTrace>
<InnerException>
<ExceptionType>System.Xml.XmlException, System.Xml, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</ExceptionType>
<Message>The body of the message cannot be read because it is empty.</Message>
<StackTrace>
at System.ServiceModel.Channels.HttpRequestContext.CreateMessage()
at System.ServiceModel.Channels.HttpChannelListener.HttpContextReceived(HttpRequestContext context, ItemDequeuedCallback callback)
at System.ServiceModel.Channels.SharedHttpTransportManager.OnGetContextCore(IAsyncResult result)
at System.ServiceModel.Channels.SharedHttpTransportManager.OnGetContext(IAsyncResult result)
at System.ServiceModel.Diagnostics.Utility.AsyncThunk.UnhandledExceptionFrame(IAsyncResult result)
at System.Net.LazyAsyncResult.Complete(IntPtr userToken)
at System.Net.LazyAsyncResult.ProtectedInvokeCallback(Object result, IntPtr userToken)
at System.Net.ListenerAsyncResult.WaitCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP)
</StackTrace>
</InnerException>
</Exception> 
```

如果我改为浏览 URL：

> [http://localhost/myservice?wsdl](http://localhost/myservice?wsdl)

一切正常，我得到了 WSDL 合同。在这一点上，我也可以完全删除*“MetadataHttp”*元数据端点，它不会有任何区别。

我正在使用 .NET 3.5 SP1。有谁知道这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-27T12:04:06.830

我想我发现了问题所在。

如果我浏览到 URL：

> [http://localhost/myservice/contract](http://localhost/myservice/contract)

使用**WcfTestClient**应用程序，我可以成功检索服务元数据。
因此，该错误仅在我通过 Web 浏览器请求 URL 时才会发生。

**HTTP Bad Request**错误来自浏览器发出 HTTP GET 请求，其中消息的内容在 HTTP 标头中，并且正文为空。
这正是 WCF **mexHttpBinding**所抱怨的！

为了通过 Web 浏览器访问服务合同，您必须在服务行为中明确启用它：

```
<serviceBehaviors>
    <behavior name="MetadataEnabled">
        <serviceMetadata httpGetEnabled="true" />
    </behavior>
</serviceBehaviors> 
```

请求的 URL 变为：

> [http://localhost/myservice?wsdl](http://localhost/myservice?wsdl)

所以，事实证明我发布这个问题有点太快了。但是，无论如何我都会保留它以供记录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-10T19:42:47.947

通常这是 SOAP 信封大小的问题。检查您的绑定配置以更改 MaxBufferPoolSize、MaxReceivedMessageSize 以允许大量内容。请记住，您必须在客户端和服务器端都进行更改。

另一个问题是 MessageEnconding（另一个绑定参数），确保客户端和服务器端使用相同的编码。

最后，检查 Reader Quotas Properties 参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-18T13:24:43.410

我能够通过将我的 WCF 服务从运行 Visual Studio 开发服务器切换到使用本地 IIS Web 服务器来修复“400 错误请求”问题（右键单击项目 --> 属性 --> web 选项卡 --> 无线电“服务器”下的按钮）。我希望这对那里的人有所帮助，因为我花了两天时间才弄清楚这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-23T02:43:47.353

如果你不确定你的 WCF 代码为什么会抛出错误，那么我强烈推荐 MS Service Trace Viewer。这对于识别此类通信和传输问题非常有帮助。查看这篇[C# Corner](http://www.c-sharpcorner.com/uploadfile/shivprasadk/wcf-tracing-faq/)文章了解更多详细信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-26T17:36:18.830

从 SvcUtil 使用 HTTPS mex URL 时，我遇到了 HTTP 400 问题，尽管`httpsGetEnabled`设置为`true`. 错误消息与真正的问题相去甚远，所以我在这里发布，以防其他人偶然发现同样的问题。

我有一个自签名 CA 证书 (TestRootCA)，它是服务器证书 (localhost) 的颁发者。在客户端上，我导入了 TestRootCA CER 文件，但没有导入 CRL（证书吊销列表）。似乎当您使用自签名 CA 时，您还**必须**导入 CRL，否则服务器身份验证会以奇怪的方式失败，这些都没有指向真正的问题。更糟糕的是，失败发生在 SSL 握手期间，甚至*在*请求到达您的服务之前，因此您不会在 WCF 跟踪日志中看到任何错误。

# c# - resharper 导出待办事项列表

> ID：323552
> 
> 赞同：1
> 
> 时间：2008-11-27T11:50:59.213
> 
> 标签：c#, resharper

我安装了 resharper，并且经常使用待办事项列表功能。我的问题是，除了对列表进行截图之外，还有一种方法可以导出当前列表，以便我可以通过电子邮件发送或与开发人员交流。我没有使用团队系统，因此无法以这种方式向其他开发人员传播更改/待办事项等。干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T12:49:03.480

在我的版本（3.1 C# 版本）中，待办事项资源管理器中有一个导出按钮。如果您使用的是较旧的，您可能会考虑升级，您的 3.0 密钥也应该适用于这个。

# delphi - 以这种方式删除和重新分配事件是否安全？如果不是，为什么？

> ID：323556
> 
> 赞同：4
> 
> 时间：2008-11-27T11:54:56.380
> 
> 标签：delphi

```
A.Event1 := nil;
A.Event2 := nil;
try
  ...
finally
  A.Event1 := MyEvent1;
  A.Event2 := MyEvent2;
end; 
```

有什么问题吗？

**编辑：**

我接受了 Barry 的回答，因为它回答的正是我所问的，但 Vegar 的回答根据情况也是正确的，遗憾的是我不能同时接受两者。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-27T13:32:34.920

这听起来像是我以前见过的事件噩梦:-)

我通常不会删除事件，而是设置一个我在事件中签入的标志。我经常使用整数而不是布尔值，以便可以在一次处理中多次设置相同的标志。

像这样的东西：

```
procedure TMyObject.Traverse;
begin
  inc(FTraverseFlag);
  try
    ...
  finally
    dec(FTracerseFlag);
  end;
end;

procedure TMyObject.OnBefore( ... );
begin
  if FTraverseFlag > 0 then 
    exit;
  ...
end; 
```

我想这很容易成为线程安全的，以解决 Barrys 的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T12:02:32.370

这完全取决于标记为“...”的代码位中发生的情况。例如，如果它启动一个后台线程并在执行到 finally 块后尝试调用 Event1 或 Event2，您可能会得到意想不到的结果。

如果代码完全是单线程的，那么是的，当代码在 try 和 finally 之间时，不应触发 Event1 和 Event2。

但是，这确实假设 Event1 和 Event2 属性（所有 Delphi 事件都是方法指针类型的属性）在它们的设置器中没有做不寻常的事情。一个病态的恶意事件设置器可能会隐藏一个方法指针，并且仍然能够调用它，即使在您稍后以“nil”作为值调用设置器之后也是如此。

但这将是非常不寻常的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T19:28:01.007

As Barry said, the only real concern is with multithreaded concerns - other than that is perfectly normal. As VCL events setters just assign the event, nothing need to be worried.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-04T18:06:40.530

If it is multithreaded you need to make operation atomic. Disabling several event handlers opens possibility that they are running at the moment then they are being disabled. Or Event2 starts when Event1 is being set to nil. All kinds of malfunctions may happen if these events called often. Possible solution to use semaphores instead. But then you may need to add extra code to event handlers as well.

Any way setting event handler temporarily to nil looks like a bad design. It will be incomprehensible very soon and hard to make do what it have to do any way. So you’d better spend some time and develop something more sophisticated.

# c# - .NET 中的通用线程池

> ID：323558
> 
> 赞同：5
> 
> 时间：2008-11-27T11:56:55.300
> 
> 标签：c#, .net, multithreading, generics, threadpool

对于我来说，这是一个相对常见的任务，而且我认为对于许多 .NET 程序员来说：
我想使用 .NET ThreadPool 来调度需要处理给定类型任务的工作线程。

作为复习，ThreadPool 的队列方法及其关联委托的签名是：

```
public static bool QueueUserWorkItem (
    WaitCallback callBack,
    Object state
)
public delegate void WaitCallback (Object state) 
```

因此，典型的通用工作线程类看起来像：

```
public class Worker<T> {
    public void schedule(T i_task) {
        ThreadPool.QueueUserWorkItem(execute, i_task)
    }
    private void execute(Object o){
        T task = (T)o;  //What happened to the type safety?  
        executeTask(task);
    }
    private void executeTask(T i_task){
        //process i_task
    }
} 
```

注意`state`参数的类型？是*`Object`*！

`QueueUserWorkItem`.NET 团队选择不使方法（或整个`ThreadPool`类）通用的令人信服的原因是什么？我不敢相信他们只是忽略了它。

这是我希望看到的方式：

```
//in the ThreadPool class:
public static bool QueueUserWorkItem<T> (
    WaitCallback<T> callBack,
    T state
)
public delegate void WaitCallback<T> (T state) 
```

这将使工人类类型安全（并且更清晰，恕我直言）：

```
public class Worker<T> {
    public void schedule(T i_task) {
        ThreadPool.QueueUserWorkItem<T>(execute, i_task)
    }
    private void execute(T i_task){
        //process i_task
    }
} 
```

我肯定错过了什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T12:00:09.367

由于通过将匿名委托或 lambda 传递给线程池（通过变量捕获）来打包您喜欢的任何状态是微不足道的，因此不需要通用版本。

例如，您可以编写一个实用函数：

```
static void QueueItem<T>(Action<T> action, T state)
{
    ThreadPool.QueueUserWorkItem(delegate { action(state); });
} 
```

但这不会非常有用，因为您可以在需要池任务中的状态的任何时候自己使用委托。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-27T12:04:38.373

听起来你在谈论工作队列？（而且我听起来很笨拙……）

作为记录，线程池线程通常应该用于短的工作。理想情况下，您应该为长寿命队列创建自己的线程。请注意，.NET 4.0 可能正在采用 CCR/TPL 库，因此我们将免费获得一些内置的工作队列——但编写线程工作队列并不难。你也可以让它通用;-p

关于问题 - 我更喜欢使用捕获的变量方法将状态传递给线程（无论是`Thread`、`ThreadPool`还是`Control.Invoke`）：

```
 Thread t = new Thread(() => SomeMethod(arg));
    t.IsBackground = true;
    t.Name = "Worker n";
    t.Start(); 
```

这使您可以更精细地控制线程，而不会使`ThreadPool`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T14:57:48.727

ThreadPool 自 .NET 1.1 以来就存在，它没有泛型。

我喜欢他们选择不破坏向后兼容性的方式:-)

# delphi - 为什么每次构建都会更改 exe 文件？

> ID：323560
> 
> 赞同：2
> 
> 时间：2008-11-27T11:57:22.787
> 
> 标签：delphi, linker, binary-reproducibility

构建相同的项目（没有任何更改）会产生**二进制不同**的 exe 文件：它们的一些小区域是不同的。空项目、版本信息（以及每次构建的自动增量）已关闭。

为什么会发生？是否可以让 delphi 为相同的项目生成二进制相等的文件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-27T12:17:52.793

Windows 使用的 PE 可执行文件格式中的各种结构包括由编译器和链接器设置的时间戳。

可以对文件进行后处理以将这些值重置为定义的常量（我为需要精确哈希值的安全产品编写了一个工具来执行此操作），但这只能在准备好发布的可执行文件上完成，因为一些调试器依赖时间戳进行源查找等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T12:15:39.677

尝试将问题更改为“如果源代码没有更改，我如何避免编译”，可能更容易处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T12:05:59.180

我怀疑编译器插入到 *.exe 编码时间、特殊序号（用于版本控制）以及其他可能的东西:) 强制 Delphi 产生相等的二进制输出是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T12:02:25.053

可能是一些实际的时间戳被编译到 exe 文件中。

# php - 在 php 中强制重新缓存 WSDL

> ID：323561
> 
> 赞同：16
> 
> 时间：2008-11-27T11:57:53.487
> 
> 标签：php, web-services, caching, wsdl

我知道如何在 PHP 中禁用[WSDL 缓存](https://stackoverflow.com/questions/303488/in-php-how-can-you-clear-a-wsdl-cache)，但是如何强制重新缓存 WSDL？

这就是我尝试过的：我在缓存设置为禁用的情况下运行我的代码，并且新方法显示为 espected。然后我激活了缓存，但由于某种原因，我的旧的非工作 wsdl 再次出现。那么：如何强制我的新 WSDL 覆盖我的旧缓存？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-27T12:23:37.430

我猜当您禁用缓存时，它也会停止写入缓存。因此，当您重新启用缓存时，旧的缓存副本仍然存在并且有效。您可以尝试（启用缓存）

```
ini_set('soap.wsdl_cache_ttl', 1); 
```

我输入了一秒的生存时间，因为我认为如果你输入零，它将完全禁用缓存但不会删除条目。当您想杀死缓存的副本时，您可能只想放入该行。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-19T10:19:18.313

在我的 php.ini 中有一个如下所示的条目：

```
soap.wsdl_cache_dir="/tmp" 
```

在 /tmp 中，我找到了一堆名为 wsdl-[some hexadecimal string] 的文件

我可以使用以下命令刷新缓存的 wsdl 文件：

```
rm /tmp/wsdl-* 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-27T12:14:06.840

从缓存中删除旧的 WSDL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T12:11:39.107

我会尝试

```
$limit = ini_get('soap.wsdl_cache_limit');
ini_set('soap.wsdl_cache_limit', 0);
ini_set('soap.wsdl_cache_limit', $limit); 
```

或者可能设置`soap.wsdl_cache_ttl`为 0 并返回

# vb.net - 编译器警告：空引用异常

> ID：323562
> 
> 赞同：6
> 
> 时间：2008-11-27T11:58:07.327
> 
> 标签：vb.net, visual-studio-2005

我在 Visual Studio 2005 中有以下代码。

```
 Dim OutFile As System.IO.StreamWriter
    Try
        OutFile = New System.IO.StreamWriter(Filename)
       // Do stuff with OutFile
    Catch Ex As Exception
       // Handle Exception
    Finally
       If OutFile IsNot Nothing Then OutFile.Close()
    End Try 
```

但是 VS2005 对“If OutFile IsNot..”这一行提出了警告，即

> 变量“OutFile”在被赋值之前被使用。运行时可能会导致空引用异常。

是否有某种方法可以通过巧妙地更改代码来消除此警告，或者是否有更好的方法来做我想做的事情？

谢谢

抢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-27T12:01:32.280

```
Dim OutFile As System.IO.StreamWriter
OutFile = Nothing
Try
    OutFile = New System.IO.StreamWriter(Filename)
   // Do stuff with OutFile
Catch Ex As Exception
   // Handle Exception
Finally
   If OutFile IsNot Nothing Then OutFile.Close()
End Try 
```

**类似于[C# 错误：使用未分配的局部变量](https://stackoverflow.com/questions/256073/c-error-use-of-unassigned-local-variable#256078)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T12:16:04.823

这是一个范围问题，outfile 对象的初始化发生在 fianlly 块不可见的代码块中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-30T15:06:58.627

当然，接受的答案是正确的，但它没有解释为什么或何时显式初始化可能很重要。

VB.NET*通常*在声明变量时分配默认值 (`0`或`Nothing`)，但在某些极端情况下它不会。

考虑这个简单的控制台应用程序：

```
Sub Main()
    For i As Integer = 1 To 5
        Dim number As Integer
        If i = 3 Then number = 3

        Console.Write(number)
    Next
End Sub 
```

输出是什么样的？您可能期望循环的每次迭代`number`都设置`0`为，并且仅在`3`循环的第三次迭代时设置为。然后对于第四次和第五次迭代，它会`0`再次出现。所以输出是`00300`，对吧？不是这样。这段代码的输出实际上是

> 00333

这是因为在 VB.NET 中，循环中声明的变量的生命周期是针对**整个**循环的，而不是针对循环的一次迭代的（不是您所期望的，对吧？）。但是，如果您在其声明中明确设置`number`to的值`0`，就像这样

```
Dim number As Integer = 0 
```

然后输出看起来像

> 00300

因此，*通常*可以安全地假设 VB.NET 将在您`Dim`设置变量时设置默认值，但将其显式设置为`0`或`Nothing`获得预期行为始终是最安全的。

# java - 使用带有 Netbeans 的 java servlet 从 Oracle 数据库中查询数据

> ID：323567
> 
> 赞同：2
> 
> 时间：2008-11-27T12:02:12.277
> 
> 标签：java, jsp, netbeans, servlets

从 index.jsp 代码，

```
statement.executeQuery("select * from fus where tester_num like 'hf60' ") ; 
```

示例我希望“hf60”成为一个变量（用户输入），其中用户必须从输入文本输入/写入数据，然后提交并获取数据，以便结果为

```
("select  * from fus where tester_num like 'userinput' ") 
```

我应该在哪里插入该代码，是在 InsertServlet .java 中还是在 Index.jsp 中？或制作另一个 filename.java 代码？请帮忙。谢谢;）

**索引.jsp**

```
<%@ page import="java.sql.*" %>

<%  Class.forName("oracle.jdbc.driver.OracleDriver"); %>

<HTML>
<HEAD>
    <TITLE>SHIFT REPORT </TITLE>
</HEAD>

<BODY BGCOLOR=##342D7E>
    <CENTER>
    <H2><FONT COLOR="#ECD672" FACE="Verdana" >SHIFT REPORT</FONT></H2></CENTER>
<hr>
    <% 

 Connection connection=DriverManager.getConnection ("jdbc:oracle:thin:@oradev2.*****.com:1521:RPADB","shift_admin",  //
         "shift_admin"
            );

        Statement statement = connection.createStatement() ;
//**Should I input the codes here?**
        ResultSet resultset = 
            statement.executeQuery("select  * from fus where tester_num like 'hf60") ; 
    %>

    <TABLE BORDER="1" BGCOLOR="CCFFFF" width='200%' cellspacing='1' cellpadding='0'   bordercolor="black" border='1'>
        <TR>
            <TH bgcolor='#DAA520'> <font size='2'>RECORD NUMBER</TH>
            <TH bgcolor='#DAA520'><font size='2'>TESTER NUMBER</TH>
            <TH bgcolor='#DAA520'><font size='2'>DATE</TH>
            <TH bgcolor='#DAA520'><font size='2'>TIME</TH>
            <TH bgcolor='#DAA520'><font size='2'>SYSTEM TYPE</TH>
            <TH bgcolor='#DAA520'><font size='2'>PACKAGE</TH>
            <TH bgcolor='#DAA520'><font size='2'>SOCKETS</TH>
            <TH bgcolor='#DAA520'><font size='2'>VALIDATED BY</TH>
        </TR>

        <% while(resultset.next()){ %>
        <TR>
            <TD> <font size='2'><center><%= resultset.getLong(1) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getString(2) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getDate(3) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getString(4) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getString(5) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getString(6) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getString(7) %></center></TD>
            <TD> <font size='2'><center><%= resultset.getString(8) %></center></TD>
            </TR>

        <% } %>

    </TABLE>     
        </BODY>
</HTML> 
```

**插入Servlet.java**

```
package fusion.shift.servlets.db;

import java.sql.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class InsertServlet extends HttpServlet {

public void init(ServletConfig config) throws ServletException { 
    super.init(config); 
} 

public void destroy() { 
} 
public boolean processRequest(HttpServletRequest request, HttpServletResponse    response) throws ServletException, IOException{

            String rec_num = request.getParameter("rec_num");
            String tester_num = request.getParameter("tester_num");
            String t_date = request.getParameter("t_date");
            String t_time = request.getParameter("t_time");
            String sys_type = request.getParameter("sys_type");
            String packages = request.getParameter("package");
            String sockets = request.getParameter("sockets");
            String sockets = request.getParameter("val");

    Connection con = null;
    Statement stmt = null;
    ResultSet rs = null;
    PreparedStatement ps = null;

    try {
                 Class.forName("oracle.jdbc.driver.OracleDriver");
    con=DriverManager.getConnection("jdbc:oracle:thin:@oradev2.*****.com:1521:RPADB","shift_admin",  //
         "shift_admin"
            );

        String sql;
                    sql = "INSERT INTO fusion_shiftrpt(RECORD_NUM, TESTER_NUM, T_DATE, T_TIME, SYSTEM_TYPE, PACKAGE, SOCKETS,VAL) VALUES (?,?,?,?,?,?,?,?)";

            ps = con.prepareStatement(sql);
        stmt = con.createStatement();

               ps.setString(1, rec_num);
             .0+  ps.setString(2, tester_num);
                             ps.setString(3, t_date);
                             ps.setString(4, t_time);
                             ps.setString(5, sys_type);
                             ps.setString(6, packages);
                             ps.setString(7, sockets);
                             ps.setString(8, val);
                             ps.executeUpdate();

        } catch (SQLException e) {
        throw new ServletException(e);
    } catch (ClassNotFoundException e) {
        throw new ServletException(e);
    } finally {
        try {
            if(rs != null)
                rs.close();
            if(stmt != null)
                stmt.close();
            if(ps != null)
                ps.close();
            if(con != null)
                con.close();
        } catch (SQLException e) {}
    }

 return(true);
 }

protected void doGet(HttpServletRequest request, HttpServletResponse response) 
    throws ServletException, IOException {
        processRequest(request,response);     

}
protected void doPost(HttpServletRequest request, HttpServletResponse response) 
    throws ServletException, IOException {
 processRequest(request,response);
 //String url = request.getRequestURI();
 //System.out.println(url);

}
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-02T16:43:43.240

***如果***您坚持使用这种设计，我建议您使用[JSTL](http://jakarta.apache.org/taglibs/doc/standard-doc/intro.html)。这提供了一组用于访问数据、控制逻辑和执行 SQL 访问的标签。

请参阅关于标准标记库和[SQL 标记](http://java.sun.com/javaee/5/docs/tutorial/doc/bnald.html)的 Sun 教程。这比将 scriptlet 嵌入到 JSP 中要好得多。也就是说，我建议这种方法（或脚本）仅用于原型或作为非常临时的修复。

使用 JSTL，您可以将所有 scriptlet 替换为类似以下内容：

```
<sql:query var="rows" >
    select  * from fus where tester_num like ?
    <sql:param value="${param.user_input}" />
</sql:query>

<table>
   <c:forEach var="row" items="${rows}">
      <tr>
         <td>${row.column1name}</td>
         <td>${row.column2name}</td>
         <td>${row.column3name}</td>
      </tr>
   </c:forEach>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T12:14:05.670

您可以访问`JSP`. 因此，如果您`JSP`要像这样访问：

```
test.jsp?q=userinput 
```

你可以像这样在`JSP`：

```
request.getParameter('userinput'); 
```

执行此操作时，您应该将`JSP`代码转换为至少使用 a `preparedStatement`：

```
PreparedStatement ps = connection.prepareStatement("select * from fus where tester_num like ?");
ps.setString(1, "%" + request.getParameter('userinput') + "%");
ResultSet resultSet = ps.executeQuery(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:16:21.350

As tvanfosson said, you should remove all database access code from your view logic (JSP). You should just show the info in your JSP, let the Servlet do all the processing. I also strongly recommend you to use an OMR framework like Hibernate.

# asp.net - 具有 > 1 个参数的 ASP MVC 路由

> ID：323572
> 
> 赞同：3
> 
> 时间：2008-11-27T12:03:42.570
> 
> 标签：asp.net, asp.net-mvc, url-rewriting

我定义了以下路线

```
 routes.MapRoute(
            "ItemName",
            "{controller}/{action}/{projectName}/{name}",
            new { controller = "Home", action = "Index", name = "", projectName = "" }
            ); 
```

这条路线实际上有效，所以如果我在浏览器中输入

```
/Milestone/Edit/Co-Driver/Feature complete 
```

它正确地转到 Milestone 控制器、编辑操作并传递值。

但是，如果我尝试使用 url.action 在视图中构建链接 -

```
<%=Url.Action("Edit", "Milestone", new {name=m.name, projectName=m.Project.title})%> 
```

我得到以下网址

```
Milestone/Edit?name=Feature complete&projectName=Co-Driver 
```

它仍然有效，但不是很干净。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T19:52:24.247

在 ASP.NET 路由（这是 ASP.NET MVC 使用的）中构造和匹配路由时，使用第一个适当的匹配，而不是最贪婪的，并且顺序很重要。

因此，如果您有两条路线：

```
"{controller}/{action}/{id}"
"{controller}/{action}/{projectName}/{name}" 
```

按照给定的顺序，然后将使用第一个。额外的值（在本例中为 projectName 和 name）成为查询参数。

事实上，由于您为 {projectName} 和 {name} 提供了默认值，因此它与默认路由完全冲突。以下是您的选择：

*   删除默认路由。如果您不再需要默认路由，请执行此操作。

*   先移动较长的路由，并使其更加明确，使其与默认路由不匹配，例如：

    ```
    routes.MapRoute(
        "ItemName",
        "Home/{action}/{projectName}/{name}",
        new { controller = "Home", action = "Index", name = "", projectName = "" }
    ); 
    ```

    这样，任何带有 controller == Home 的路由都将匹配第一个路由，而任何带有 controller != Home 的路由都将匹配第二个路由。

*   使用 RouteLinks 而不是 ActionLinks，特别是命名您想要的路线，以便它建立正确的链接而不会产生歧义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T10:18:27.947

只是为了澄清，这就是我最终解决它的方法，感谢@Brad的回答

```
<%=Html.RouteLink("Edit", "ItemName", new { projectName=m.Project.title, name=m.name, controller="Milestone", action="Edit"})%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T19:40:26.020

你可以试试

```
Html.RouteLink("Edit","ItemName", new {name=m.name, projectName=m.Project.title}); 
```

# firefox - IIS7 在 Firefox 中显示欢迎屏幕，Internet Explorer 工作正常

> ID：323580
> 
> 赞同：1
> 
> 时间：2008-11-27T12:10:44.303
> 
> 标签：firefox, iis-7

有没有人遇到过以下问题： 我的电脑上运行着 IIS7。在同一台计算机上，我打开 IE7 并且网站正常工作（[http://localhost/web.site/Default.aspx](http://localhost/web.site/Default.aspx)）。将相同的 url 放入 Firefox 3 中，我会看到 IIS7 的欢迎屏幕，中间是 IIS7 的大图像和几种不同语言的“欢迎”。点击图片会带你进入[http://www.iis.net/](http://www.iis.net/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T12:43:51.867

一个浏览器通过 127.0.0.1 访问您的服务器，另一个浏览器通过您的外部 IP 访问您的服务器。

确保虚拟主机适用于所有网络接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T12:48:15.930

也许您的浏览器设置了不同的本地设置，只是猜测因为我没有使用过 IIS7

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T13:13:09.307

奇怪的。今天早上（2009 年 4 月 9 日）发生在我身上，但反过来。我试图访问 Dell.ca。IE7 将我带到了 IIS7 欢迎屏幕，而 Firefox 将我带到了正确的站点。在纠正之前发生了 3 次。

我的网络上的任何地方都没有 IIS，我的默认主页是 Google，它没有出现问题。当我输入新的 URL 时发生了重定向。我想知道戴尔是否正在使用 IIS7 ......

# python - Eclipse（pydev）：是否可以分配一个快捷方式将选择发送到 python 控制台？

> ID：323581
> 
> 赞同：4
> 
> 时间：2008-11-27T12:10:53.040
> 
> 标签：python, ide

问题很简单，适合标题:) Eclipse (pydev)：是否可以分配一个快捷方式来将选择发送到 python 控制台？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T13:36:39.887

您只能为“操作”分配快捷方式。绑定到按钮（例如工具栏）和菜单的操作。如果你有一个菜单，你可以绑定一个键。如果没有，那么您将不得不在 pydev 项目中打开一个增强请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-09T13:48:15.357

如果您指的是交互式控制台，请在 pydev 编辑器（1.5 版）中使用 ctrl+alt+enter。

这个动作做了很多事情：

1.  如果尚未打开，则打开交互式控制台视图
2.  将选定的文本发送到控制台
3.  生成当前编辑器的 execfile（如果没有选择文本）

# 3d - 有没有一种简单的方法可以在 3D 中为心形建模？

> ID：323584
> 
> 赞同：1
> 
> 时间：2008-11-27T12:12:33.490
> 
> 标签：3d, modeling

我想用尽可能少的代码在不使用外部模型文件的情况下以 3D 建模心形。

在 2D 中，我可以使用一些 Bézier 曲线来绘制心形，我可以将其拉伸以获得简单的 3D 心形，但这看起来不像我想要的形状。心的底部应该是一个峰，上部应该是两个圆形的部分（嗯，我想你知道我的意思）。

那么，有没有一种简单的方法可以在 3D 中对这种形状进行建模（即，一个简单的公式或一个小代码片段）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T12:17:14.853

[MathWorld 的这个页面](http://mathworld.wolfram.com/HeartCurve.html)有一些很好的材料。虽然大部分是 2D，但它也确实显示了几个 3D 形状。它有一个指向[这个页面](http://mathworld.wolfram.com/HeartSurface.html)的链接，看起来很有希望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T07:30:49.497

我觉得你的方向很好。

为 2D 心脏建模并将其拉伸到您想要的最大宽度。

您现在可以应用额外的变换，沿高度不同地缩放宽度。

您可以使用贝塞尔曲线为沿高度的每个位置形成所需的比例。

# wcf - WCF 分块/流式传输

> ID：323585
> 
> 赞同：12
> 
> 时间：2008-11-27T12:13:08.950
> 
> 标签：wcf, streaming, uploading, chunking

我正在使用 WCF 并希望将一个大文件从客户端上传到服务器。我已经调查并决定遵循[http://msdn.microsoft.com/en-us/library/aa717050.aspx中概述的分块方法](http://msdn.microsoft.com/en-us/library/aa717050.aspx)

但是，这种方法（就像流式传输一样）将合约限制为有限的方法签名：

```
[OperationContract(IsOneWay=true)]
[ChunkingBehavior(ChunkingAppliesTo.InMessage)]
void UploadStream(Stream stream); 
```

该示例使用了一个相当方便的示例，即从固定路径上传文件并将其保存到服务器上的固定路径。因此，我的问题是如何传递附加参数来指定文件名、文件路径等内容。

例如。我想要类似的东西：

```
[OperationContract(IsOneWay=true)]
[ChunkingBehavior(ChunkingAppliesTo.InMessage)]
void UploadStream(Stream stream, String filePath); 
```

在此先感谢，马克。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-18T20:26:26.107

[本文](http://www2.zdo.com/archives/27-Windows-Communication-Foundation-WCF-Notes.html)解释了如何使用 MessageHeader 属性来强制在标头中传递内容，因此不计为参数。因此，与其传递流和其他元数据，不如创建一个具有 MessageContract 属性的类并将所有元数据标记为 MessageHeader。然后，将流标记为 MessageBodyMember（文章错误地称为“MessageBody”）。让您的 UploadStream 方法采用一个参数，该参数的类型是您刚刚创建的 MessageContract 类的类型。我已经成功地做到了这一点，但我还没有与分块一起做到这一点。祝你好运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T12:48:28.923

您可以使您的服务具有会话性，并在合同中具有一个将 IsInitiating 属性设置为 true 的初始化方法。就像是：

```
[OperationContract(IsInitiating = true)]
void InitializeUploadService(string filename);

[OperationContract(IsOneWay = true, IsInitiating = false)]
[ChunkingBehavior(ChunkingAppliesTo.InMessage)]
void UploadStream(Stream stream); 
```

我从未尝试过使用流媒体服务，但它基本上应该让 WCF 强制在 UploadStream 之前始终调用 InitializeUploadService。

更多文档可以在这里找到：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.description.operationdescription.isinitiating.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.operationdescription.isinitiating.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-15T19:27:51.940

我会查看[MessageContracts](http://msdn.microsoft.com/en-us/library/ms730255.aspx)并将这些值作为消息头添加到您的对象中。这应该允许您将流和与流相关的任何值作为消息头传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-19T13:23:21.080

在客户端和服务器端设置 maxItemsInObjectGraph 对我有用。

（不要忘记客户端。）[http://social.msdn.microsoft.com/Forums/en/wcf/thread/0af69654-2d89-44f3-857a-583b57844ca5](http://social.msdn.microsoft.com/Forums/en/wcf/thread/0af69654-2d89-44f3-857a-583b57844ca5)

# sharepoint - 由多个开发人员在单个服务器上测试 Sharepoint 部署

> ID：323596
> 
> 赞同：1
> 
> 时间：2008-11-27T12:18:11.310
> 
> 标签：sharepoint, deployment, wss

我们从一个三人团队开始 Sharepoint 开发，目前正在建立我们的开发环境。我们希望避免为每个开发人员安装一个 Server 2008，因此已经设置了一个终端服务器，使用远程 Windows 在每个开发人员的机器上启动一个 VS2008 实例。现在我们想分离开发人员的测试环境（即每个开发人员使用不同的站点集合），但已经意识到需要将程序集安装到 GAC 中才能在站点上正确显示。但由于 AFAIK 只有一个 GAC，开发人员无法独立测试他们的东西。

有没有什么方法可以在不安装一堆 2008 服务器的情况下创建单独的测试环境？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T12:34:46.253

所以你们都要远程启动 Visual Studio 并编译东西并重新启动 IIS 等？

你们会互相跺脚。

现在更明智的选择是使用 Hyper-V（或其他一些虚拟化）。

我们在笔记本电脑上使用 Windows Server 2008，并使用 Hyper-V 运行我们的开发环境。然后我们每个人都有一个开发环境（沙箱），这些环境有 VS2008、SVN、Nunit 等。

由于唯一共享的 Hyper-V 上的 CruiseControl，我们的代码相互测试。

这对我们来说非常棒......我们分配负载，我们可以在移动中工作，我们不会互相踩踏，如果我们需要做一个演示，我们可以从演示 Hyper 切换 Hyper-V 和演示-V（早期从开发分支分支，以便了解环境）。

去虚拟，不要回头。

PS：我刚刚看到您对一台服务器的评论......只需将 Hyper-V 放在上面并运行 3 个实例。这也是我们所做的；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T12:29:38.120

我不知道在所有东西上安装服务器，但这听起来像是虚拟机而不是物理机的理想任务——在我工作的地方，我们大量使用 VMWare 来完成这种工作，而且效果很好。

在测试安装过程等方面，能够回滚到快照也很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T20:45:49.710

您在终端服务上走错了路 - 它只是不会给您任何分离。

很多人建议直接在 W003/2008 服务器上开发，它确实简化了远程调试等一些事情。

我更喜欢使用 VMWare 运行虚拟机的更传统的方法。这些可以在本地或远程主机上运行。远程调试的设置有点复杂，但仍然可以。

最后 - 如果可能，然后部署到 bin 目录而不是 GAC。这将使编译后自动部署变得更加容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T12:54:38.630

没有。除了 GAC 之外，12 个配置单元中还有所有 SharePoint 文件，例如功能和网站模板。节省服务器成本不值得。

（当然如果你不使用 GAC，而是部署到 bin 文件夹，并且你不接触 12 hive 中的任何东西，你可以在同一台服务器上为每个开发人员提供自己的 web 应用程序。但是这种方法放置了一个他们能做什么有很多限制。仍然不值得。）

虚拟机可以工作，但它们的开发速度可能很慢。例如，您需要为每个 GAC 部署重新启动应用程序池 - 这意味着可能会暂停 15-60 秒以重新加载应用程序（取决于硬件）。这会变得很烦人。

虚拟机更适合测试和生产，您不需要经常重启应用程序。

我为每个开发者推荐一个物理服务器。这将最大限度地减少代码-部署-测试周期时间，并确保他们不必担心踩到彼此的脚趾。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-09T10:24:28.143

贡献者是对的，多开发人员单服务器环境有很多绊脚石。

第一个开发人员将尝试附加到同一个 Web 应用程序进程 w2ps.exe，因此必须在不同的端口上创建单独的 Web 应用程序，除非您准备共享时间调试。 [如何为 sharepoint 2013 设置开发环境](https://stackoverflow.com/questions/16933278/how-to-setup-a-development-environment-for-sharepoint-2013/17929517#17929517)

第二个问题是当您尝试协作和使用共享组件/功能时。独立工作的愿望是值得商榷的，我认为团队开发人员应该协作和共享，因此需要组合工作以确保无缝集成到一个最终解决方案中，并且不会重复任何工作。多开发人员单服务器环境完美运行，直到您尝试协作 '一个常见错误是让所有团队开发人员都使用一个“开发服务器”。除非团队成员正在处理完全不相关的组件并且永远不需要做常见的事情，例如重新启动 IIS 或将调试器附加到 IIS 进程，否则这种类型的环境通常不能很好地工作。[http://technet.microsoft.com/en-us/magazine/dn145990.aspx](http://technet.microsoft.com/en-us/magazine/dn145990.aspx)我们因缺乏经验和知识而犯了这个错误，但一旦你犯了这个错误，就有可能解决它。

我第一次分享功能的尝试是将开发人员 1 的项目复制到开发人员 2 的解决方案中，并在开发人员 2 的项目中添加对它的引用，并将所有功能添加到开发人员 2 的包中。部署这对开发人员 2 来说效果很好，直到我发现如果开发人员 1 将他们的解决方案从调试器中分离出来，它会根据农场中重复的解决方案 ID 收回解决方案，因此从每个开发人员的 Web 应用程序中收回。因此，开发人员 2 将地毯从其下方拉出。尽管这是一个部分解决方案并且似乎工作了一段时间，但我花了一段时间才弄清楚发生了什么以及开发 1 和 2 部署的哪些组合使彼此工作而不工作。

所以我找到了一个更好的解决方案。在 SharePoint 选项卡下 Visual Studio 的项目属性下，有一个名为“调试后自动收回”的组合框。默认情况下，当开发人员停止附加的调试器并从其他开发人员的下方拉出功能时，这会收回解决方案。取消选中此框可防止撤回，并使每个开发人员在农场级别部署单独的解决方案，并且在重新连接到调试器时只需用最小的麻烦替换解决方案。

根据我的经验，回收 IIS 应用程序池的速度如此之快，其他开发人员甚至都没有注意到，但是如果团队人数超过 2 人，这可能会变得更加普遍，因此也许其他人可以添加他们的经验。我还猜想，除非其他开发者尝试在回收发生的同一时间附加它会很好，所以随着时间的推移发生交叉的可能性非常小，如果它是简单地分离和重新附加就可以解决这个问题曾经经历过。

# css - 如何在另一个div中水平放置两个div

> ID：323599
> 
> 赞同：56
> 
> 时间：2008-11-27T12:20:40.337
> 
> 标签：css, layout, html

我已经很久没有使用 CSS 了，目前也没有参考资料。我的问题应该相当简单，但谷歌搜索并没有提供足够的答案。所以，增加集体知识......

```
|#header---------------------------------------------------------------|
|                               TITLE                                  |
|#sub-title------------------------------------------------------------|
|bread > crumb                    |                  username logout   |
|#sub-left                        |                          #sub-right|
|---------------------------------|------------------------------------| 
```

这就是我想要的布局。反正就是标题。我希望副标题包含 sub-left 和 sub-right。我使用什么 css 规则来确保一个 div 受另一个 div 的属性约束。在这种情况下，如何确保 sub-left 和 sub-right 保持在 subtitle 内？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-11-27T19:50:23.160

这是一个很常见的误解，即`clear:both`您实际上不需要一个 div 在底部。虽然 foxy 的答案是正确的，但您不需要那个非语义、无用的清除 div。您需要做的就是将一个贴`overflow:hidden`在容器上：

```
#sub-title { overflow:hidden; } 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-27T12:46:29.177

当您漂浮时`sub-left`，`sub-right`它们不再占用`sub-title`. 您需要`style = "clear: both"`在它们下方添加另一个 div 以展开包含的 div 或它们出现在其下方。

HTML：

```
<div id="sub-title">
   <div id="sub-left">
      sub-left
   </div>
   <div id="sub-right">
      sub-right
   </div>
   <div class="clear-both"></div>
</div> 
```

CSS：

```
#sub-left {
   float: left;
}
#sub-right {
   float: right;
}
.clear-both {
   clear: both;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-27T12:39:33.373

这应该做你正在寻找的：

```
<html>
    <head>
        <style type="text/css">
            #header {
                text-align: center;
            }
            #wrapper {
                margin:0 auto;
                width:600px;
            }
            #submain {
                margin:0 auto;
                width:600px;
            }
            #sub-left {
                float:left;
                width:300px;
            }
            #sub-right {
                float:right;
                width:240px;
                text-align: right;
            }
        </style>

    </head>
    <body>
        <div id="wrapper">
            <div id="header"><h1>Head</h1></div>
            <div id="sub-main">
                <div id="sub-left">
                    Right
                </div>
                <div id="sub-right">
                    Left
                </div>
            </div>
        </div>
    </body>
</html> 
```

您可以使用包装类控制整个文档，或者使用子主类控制两列。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-28T23:52:58.073

我同意 Darko Z 将“溢出：隐藏”应用于#sub-title。但是，应该提到溢出：清除浮动的隐藏方法不适用于 IE6，除非您具有指定的宽度或高度。或者，如果您不想指定宽度或高度，可以使用“zoom: 1”：

```
#sub-title { overflow:hidden; zoom: 1; } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-27T12:59:33.690

该答案添加到上述解决方案中，以解决您的最后一句话：

*如何确保 sub-left 和 sub-right 保持在 subtitle 内*

问题是，随着 sub-left 或 sub-right 的内容扩展，它们将扩展到 sub-title 下方。这种行为是设计在 CSS 中的，但确实会给我们大多数人带来问题。最简单的解决方案是拥有一个带有 CSS Clear 声明样式的 div。

为此，请包含一个 CSS 语句来定义一个结束 div（可以是 Clear Left 或 RIght 而不是两者，这取决于所使用的 Float 声明：

```
#sub_close {clear:both;} 
```

HTML变为：

```
<div id="sub-title">
<div id="sub-left">Right</div>
<div id="sub-right">Left</div>
<div id="sub-close"></div>
</div> 
```

抱歉，才发现这是以前发过的，不应该在输入我的回复时煮那杯咖啡！

@Darko Z：你说得对，我发现的溢出：自动（或溢出：隐藏）解决方案的最佳描述是不久前 SitePoint 上的一篇文章[Simple Clearing of FLoats](http://www.sitepoint.com/blogs/2005/02/26/simple-clearing-of-floats/)并且在 456bereastreet 中也有一个很好的描述文章[CSS 提示和技巧第 2 部分](http://www.456bereastreet.com/archive/200503/css_tips_and_tricks_part_2/)。不得不承认自己懒得实现这些解决方案，因为关闭 div cludge 工作正常，尽管它当然非常不雅。所以从现在开始会努力清理我的行为。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-27T12:51:55.360

认真尝试其中一些，您可以选择固定宽度或更流畅的布局，选择权在您手中！也很容易实现。

### IronMyers 布局

*   [CSS 布局](http://layouts.ironmyers.com)
*   [布局定制指南](http://layouts.ironmyers.com/customize/)
*   [750 像素 CSS 布局](http://layouts.ironmyers.com/750_pixel_Layouts/)
*   [950 像素 CSS 布局](http://layouts.ironmyers.com/950_pixel_Layouts/)
*   [100% 的 CSS 布局](http://layouts.ironmyers.com/100_percent_Layouts/)

### 更多更多更多

*   [布局晚会 CSS 布局](http://blog.html.it/layoutgala/)
*   [Glish CSS 布局](http://www.glish.com/css/)
*   [代码糟透了 CSS 布局](http://www.code-sucks.com/css%20layouts/)
*   [最大设计 CSS 布局](http://maxdesign.com.au/presentation/page_layouts/)
*   [CSS 播放 CSS 布局](http://www.cssplay.co.uk/layouts/index.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-27T12:41:54.927

您也可以使用 CSS Grids 框架来实现这一点，例如[YUI Grids](http://developer.yahoo.com/yui/grids/)或[Blue Print CSS](http://www.blueprintcss.org/)。它们解决了很多跨浏览器问题，并使更复杂的列布局可以供普通人使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-01T07:12:47.167

使用 css3 的最佳和简单方法

```
#subtitle{
/*for webkit browsers*/
     display:-webkit-box;
    -webkit-box-align:center;
    -webkit-box-pack: center;
     width:100%;
}

#subleft,#subright{
     width:50%;
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-27T12:34:15.660

大概是这样的……

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <style>
            #container
            {
                width:600px;
            }

            #head, #sub-title
            {
                width:100%;
            }

            #sub-left, #sub-right
            {
                width:50%;
                float:left;
            }

        </style>
    </head>

    <body>
        <div id="container">
            <div id="head">
                 #head
            </div>
            <div id="sub-title">
                #sub-title
                <div id="sub-left">
                    #sub-left
                </div>

                <div id="sub-right">
                    #sub-right
                </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-02-26T00:16:12.433

```
#sub-left, #sub-right
{
    display: inline-block;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-02-11T05:20:30.217

通过[Bootstrap Grid](http://getbootstrap.com/examples/grid/)，您可以轻松获得跨浏览器兼容的解决方案。

```
<div class="container">     
  <div class="row">
    <div class="col-sm-6" style="background-color:lavender;">
      Div1       
    </div>
    <div class="col-sm-6" style="background-color:lavenderblush;">
          Div2
    </div>
  </div>
</div> 
```

jsfiddle：http: [//jsfiddle.net/DTcHh/4197/](http://jsfiddle.net/DTcHh/4197/)

* * *

## 回答 #12

> 赞同：-6
> 
> 时间：2010-11-25T22:53:40.157

你这样做：

```
<table>
   <tr>
      <td colspan="2">TITLE</td>
   </tr>
   <tr>
      <td>subleft</td><td>subright</td>
   </tr>
</table> 
```

EASY - 我花了 1 分钟来打字。记住 CSS 文件需要下载到客户端，所以不要担心额外标签的问题，在这种情况下它是无关紧要的。

# language-agnostic - 在 KISS 和铺路牛道上

> ID：323603
> 
> 赞同：14
> 
> 时间：2008-11-27T12:25:12.950
> 
> 标签：language-agnostic, naming-conventions

我目前正在开发一个使用 Access 数据库作为后端的 PHP 应用程序。不是你理解的选择......数据库是客户最初使用的，使用它是需求的一部分。

该数据库的问题之一是列名具有您可以想象的最疯狂的命名约定。大写，小写，下划线，空格和普通的疯狂。例如，“性别”列包含一个日期。“User2”列也是如此。还有很多，但你明白了。

面对这种情况，我决定创建一个数组来将数据库列映射到 PHP 变量，这样我们就可以将代码与疯狂隔离开来。但是我的同事认为我过于复杂了，我们应该将数据库的列名用于相应的 PHP 变量，这样我们就不需要通过映射数组来查找去哪里了。

所以我的问题是……我是在做正确的事情还是让事情复杂化？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-27T12:32:32.200

绝对你在正确的轨道上。如果你不抽象出疯狂，你自己最终会屈服于疯狂。

你的同事有一个有效的观点，所以我建议你也编写一个简单的方法来确定 PHP 中的数据到列映射。

这不是为了保持简单，而是为了改造一个坚实的基础。

让我担心的是，这种随机设计通常会隐藏某些业务规则，例如“......如果性别是一个日期，那么他们一定在某个时候购买了一个小部件，因此他们不能被允许胡说八道lubdub ......” - 我知道很疯狂，但比它应该更常见。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-27T12:33:43.993

名字非常重要。如果您希望您的应用程序可维护，请在代码库进一步增长之前修复它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-27T12:36:24.393

我不会说你把事情复杂化了。

Eric Evan 的书[领域驱动设计](http://domaindrivendesign.org/books/#DDD)对此有一个可爱的术语：[反腐败层](http://c2.com/cgi/wiki?AnticorruptionLayer)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-27T12:35:32.570

要玩 Devil's Advocate，有一些话要说，因为在您使用系统的短期记忆负载中没有不必要的间接层。一旦熟悉了代码，您就会知道哪个变量包含了什么，因此主要的好处是对于从头开始编写代码的新人来说。但是，正确解决该问题还需要修复数据库模式，这将 (a) 是一项重要的工作，并且 (b) 在很大程度上使问题消失。

这个问题没有非黑即白的答案，而且对你的具体问题没有明显的答案表明你可能想让睡狗撒谎。

另一方面，如果清理操作在可能的范围内，那么您可能希望在重构类型的基础上执行此操作，并在机会出现时逐步修复 DB 列名称。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-27T13:08:10.087

只需在最需要的地方创建视图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-27T12:34:58.687

这是一个很好的问题，因为它涉及到编码恕我直言的核心。

我会和你一起去把坏名字抽象成可读的好名字。*结果是逻辑上更*易于理解和可读的代码有点复杂。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-27T12:35:55.207

您没有说您不能重命名 Access 中的列，所以.... 这样做！另一种可能性是为每个表创建视图，并重命名视图中的列。然后，您可以使用视图 vEmployees，而不是使用表员工。如果我没记错的话，Access 允许您更新视图并从中进行选择。但是，如果您将 ORM 与 PHP 一起使用，则可能不支持更新视图。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-27T12:38:35.870

即使名称有意义，硬编码表名和列名也不是一个好主意。

我不知道使用数组是否是最好的解决方案。我对 PHP 不是很熟悉，但我会使用诸如常量字符串之类的东西来存储表名。在我使用的语言中，这将导致代码更具可读性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-27T12:38:51.753

你很不幸被这个数据库困住，但我认为总的来说，将字段名称抽象成更明智的方法更聪明。

当您从数据库中提取数据时，我可能会创建一个包含数据库名称、已清理名称、类型和内容字段的数据结构。这将提供一种将事物组合在一起的便捷方式，因此您*不仅可以*映射出疯狂的名称方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-27T12:42:34.163

绝对你在做正确的事。在我看来，最好在那里实现一些理智。展望未来，如果他们决定更改该数据库或其任何列名，您的逻辑不会被丢弃。如果您以正确的方式构建映射，则只需将新表/列直接插入应该很容易。

如果有的话，您正在做的事情可以提高整体解决方案的敏捷性。

当然，我仍然会说 KISS 适用于您的映射方法！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-27T12:45:41.287

在应用程序的末尾使用正确的列名是您能做的最好的事情。除非您想查找“该字段应该是什么？”，否则您应该这样做。当你做了其他事情后必须再次查看它时。

你的同事的观点是不要把事情复杂化。这也是有效的。

因此，将对字段的访问封装在一个或多个方法中，并让该方法进行翻译。使用地图这不应该是一个性能问题。

事实上，如果您的客户重新考虑使用*真实*数据库，将所有到数据源的映射放在一个对象中可能会对您有所帮助。客户喜欢改变他们的看法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-27T12:58:38.217

为什么不创建一个带有映射到每个表的类的数据层。然后，您可以定义类方法来访问列并为方法指定您想要的任何名称。那么数据层数据库访问代码是唯一需要知道真实列名的东西。我怀疑有人（可能是几个人）已经开发了一个框架来做到这一点。谷歌“php orm”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-27T13:35:39.610

使用 ORM，您将很快更改数据库...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-03T20:33:16.163

您仍然需要维护数据库。我可以建议的一种可能方法是按照您的计划在应用程序代码中映射字段名称。但是迟早你必须开始用字段名称处理这种命名疯狂并修复它。仅仅从问题中筛选并认为这是一个安全的解决方案和好方法并不是一个好主意。这只是临时解决方法。不要把你自己填满。

# binary - 设计（二进制）文件格式时有哪些重点？

> ID：323604
> 
> 赞同：45
> 
> 时间：2008-11-27T12:26:06.927
> 
> 标签：binary, file-format

在设计用于记录二进制数据的文件格式时，您认为该格式应该具有哪些属性？到目前为止，我提出了以下要点：

*   开头有一些“魔术字节”，以便能够识别文件（在我的具体情况下，这也应该有助于区分文件和“遗留”文件）
*   开头有文件版本号，以便以后可以更改文件格式而不会破坏兼容性
*   指定所有数据项的字节顺序和大小；或：包括一些空间来描述数据的字节顺序/大小（我倾向于前者）
*   可能为将来可能需要的更多每个文件属性保留一些空间？

还有什么可以使格式更加面向未来并减少将来的头痛？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-27T12:38:30.880

看看[PNG 规范](http://www.w3.org/TR/PNG/)。这种格式背后有一些很好的理由。

另外，决定什么对你未来的格式很重要：紧凑性、兼容性、允许在其中嵌入其他格式（不同的压缩算法）。另一个有趣的例子是[谷歌的协议缓冲区](http://google-opensource.blogspot.com/2008/07/protocol-buffers-googles-data.html)，其中传输数据的大小是王道。

至于字节序，我建议您选择一个选项并坚持使用，不允许不同的字节顺序。否则，读写库只会变得更复杂和更慢。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-29T17:35:42.587

我同意这些都是好主意：

1.  魔术数字开头。*nix 中几乎[需要：](http://en.wikipedia.org/wiki/File_format#Magic_number)

2.  向后兼容的文件版本号。

3.  字节顺序规范。

但是您的第四个是多余的，因为＃2 允许您添加字段，只要您更改版本号（并且只要您不需要[前向兼容性](http://en.wikipedia.org/wiki/Forward_compatibility)）。

*   可能为将来可能需要的更多每个文件属性保留一些空间？

此外，在许多其他答案中表达的对文件强加块结构的想法似乎不像对二进制文件的普遍要求，而是解决某些类型的有效负载问题的解决方案。

除了上面的 1-3 之外，我还要添加这些：

*   简单的校验和或其他检测内容是否完整的方法。否则你不能相信魔法字节或版本号。请注意指定校验和中包含哪些字节。通常，您会在文件中包含尚未进行错误检测的所有字节。

*   编写文件的软件版本（包括您拥有的最精细的编号，例如内部版本号）。您将从无法打开它的人那里获得带有附件的错误报告，并且他们在编写文件时将不知道任何线索，因为当时没有发生错误。但是错误在于编写它的版本，而不是试图阅读它的版本。

*   在规范中明确说明这是一种*二进制*格式，即所有字节都允许使用 0-255 的所有值（幻数除外）。

以下是一些可选的：

*   如果您确实需要向前兼容性，您需要某种方式来表达哪些“块”是“可选的”（就像 png 一样），以便您的软件的先前版本可以优雅地跳过它们。

*   如果您希望“在野外”找到这些文件，您可以考虑嵌入一些线索来查找规范。想象一下在 png 文件中找到字符串*[http://www.w3.org/TR/PNG/](http://www.w3.org/TR/PNG/)*会有多大帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-27T12:47:06.120

当然，这完全取决于格式的目的。

一种灵活的方法是将整个文件构造为 TLV（标签长度值）三元组。例如，使您的文件由记录组成，每条记录都以 4 字节的标头开头：

```
1 byte  = record type
3 bytes = record length
followed by record content 
```

关于字节序，如果您在文件中存储字节序指示符，您的所有应用程序都必须支持所有字节序格式。另一方面，如果您为文件指定特定的字节序，则只有具有不匹配字节序的平台上的应用程序才需要做额外的工作，并且可以在编译时决定（使用条件编译）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-15T11:42:19.420

另一点，取自 .xz 文件规范（[http://tukaani.org/xz/xz-file-format.txt](http://tukaani.org/xz/xz-file-format.txt)）：前几个字节之一应该是非字符，“以防止应用程序错误检测文件作为文本文件。”。请注意确定编辑器和其他工具通常检查多少标头字节，但在前四个或八个字节中使用非二进制字节似乎很有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-11-04T00:26:13.123

在开始之前要知道的最重要的事情之一是如何使用您的文件。

*   随机或顺序访问会成为常态吗？
*   多久读取一次数据？
*   多久写入一次数据？
*   您会一次性写出文件，还是会在数据进入时减慢写入速度。
*   文件是否需要可移植？并非所有格式都需要。
*   是否需要与其他版本兼容？也许更新文件就足够了。
*   它需要易于读/写吗？
*   大小/速度/复杂性权衡。

这里的大多数答案都在可移植性/兼容性方面给出了很好的建议，所以我不打算添加更多。但请考虑以下（经常被忽视）的事情。

*   有些文件经常被写入而很少被读取（备份、日志等），您可能希望专注于文件大小和易于编写。
*   如果您的文件永远不会离开主机，或者很少离开以至于转换是一个不错的选择，那么转换字节顺序会很慢（相对而言），您可以获得显着的性能提升。考虑将诸如 0x1234 之类的数字写为标头的一部分，以便您可以检测（并指示用户转换）是否是这种情况。
*   有时简单的阅读真的很有用。如果您正在处理日志或文本文档，请考虑一次性压缩所有内容，而不是按条目压缩，以便您可以`zcat | strings`查看文件并查看里面的内容。

有很多事情要记住，设计一个好的格式需要大量的计划和远见。诸如`zcat`ing 文件和获取有用信息之类的小事情或使用原生整数带来的小幅性能提升可以为您的产品带来优势，但是您需要注意不要为了获得它而牺牲一些重要的东西。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-02T21:09:03.063

确保您保留一个标记代码（或者更好的是在每个标记中保留一个位）来指定一个已删除/空闲块/块。然后可以通过简单地将块的当前标签代码更改为已删除标签代码或设置标签的已删除位来删除块。这样，当您删除一个块时，您不需要立即完全重组您的文件。

在标签中保留一个位提供了可能取消删除块的选项（如果您保持块的数据不变）。

但是，为了安全起见，您可能希望将已删除块的数据归零，在这种情况下，您将使用特殊的已删除/空闲标签。

我同意 Stepan 的观点，您应该选择一个字节序，但我也会在文件中包含一个字节序指示符。如果您使用字节序指示符，您可能会考虑使用其中一个[UniCode 字节顺序标记](http://en.wikipedia.org/wiki/Byte_order_mark)作为用于任何文本块的任何 UniCode 文本编码的指示符。BOM 通常是 UniCoded 文本文件的前几个字节，因此如果您的 BOM 是文件中的第一个条目，则某些实用程序将您的文件识别为 UniCode 文本可能会出现问题（我认为这不是什么大问题） . 我会将 BOM 视为您的普通标签之一（如果使用 16 位标签，则使用 UTF16 BOM，如果使用 32 位标签，则使用 UTF32 BOM），块/块长度为 0。

另见[http://en.wikipedia.org/wiki/File_format](http://en.wikipedia.org/wiki/File_format)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-27T12:45:26.810

我会考虑定义一个更高级别用来存储数据的子结构，有点像文件中的迷你文件系统。

例如，即使您的文件格式将存储特定于应用程序的数据，我也会考虑在文件中定义记录/流等，以便与应用程序无关的代码能够理解文件的布局，但不能当然了解不透明的有效载荷。

让我们更具体一点。考虑将数据存储在内存中的常用方法：通常它们可以归结为连续的可扩展数组/列表、基于指针/引用的图和特定格式的二进制数据块。

因此，按照类似的思路定义二进制文件格式可能是富有成效的。使用记录头来指示以下数据的长度和组成，无论是数组形式（相同类型记录的列表）、引用（文件中其他记录的偏移量）还是数据块（例如字符串数据）在特定的编码中，但不包含任何引用）。

如果精心设计，这可以允许文件格式不仅用于一次性持久化数据输入和输出，而且可以根据需要以增量方式使用。如果子结构设计得当，它可以与应用程序无关，但仍然允许编写垃圾收集应用程序，它了解 blob、数组和引用记录类型，并且能够跟踪文件并消除未使用的记录（即记录不再指向）。

这只是一个想法。寻找想法的其他地方是一般文件系统设计或关系数据库物理存储策略。

当然，根据您的要求，这可能是矫枉过正。您可能只是在使用二进制格式来持久化内存中的数据，在这种情况下，需要考虑的一种方法是标记记录。

在这种方法中，每条数据都以标签为前缀。标签指示紧随其后的数据的类型，可能还有它的长度和名称。列表可以以没有有效负载的“end-list”标签作为后缀。标签可能有一个嵌入的标识符，因此序列化机制在读取内容时可以忽略不理解的标签。在这方面它有点像 XML，除了使用二进制习惯用法。

实际上，XML 是一个寻找文件格式长期寿命的好地方。查看它的命名空间功能。如果您仔细构建您的读写代码，应该可以编写保留他们不理解的标记（递归）数据的位置和内容的应用程序，这可能是因为它是由同一应用程序的更高版本编写的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-27T12:46:08.523

将来证明文件的一种方法是提供块。在您的文件头数据之后，您可以开始第一个块。该块可以具有块类型的字节或字代码，然后是字节大小。现在您可以任意添加新的块类型，并且可以跳到块的末尾。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-27T13:34:55.430

我同意 atzz 关于使用标签长度值系统的建议。为了将来的兼容性，您可以在开始时存储一组指向 TLV 条目的“指针”（或者可能是 Tag、Pointer 并让指针指向一个 Length、Value；或者可能是 Tag、Length、Pointer，然后将所有数据放在一起别处？）。

因此，我的文件可能类似于：

```
magic number/file id
version
tag for first data entry
pointer to first data entry --------+
tag for second data entry           |
pointer to second data entry        |
...                                 |
length of first data entry <--------+
value for first data entry
... 
```

幻数、版本、标签、指针和长度都将是预定义的设置长度，以便于解码。说，2个字节。或 4，取决于您的需要。它们不必都相同（例如，所有标签都是 1 个字节，指针是 4 个等）。

该*标签*让您知道正在存储什么。*指针*告诉你位置（偏移量或绝对值，以字节为单位），*长度*告诉你数据有多大，*值*是*tag类型数据的**长度*字节。如果您在 MyFileFormat v2 文件上使用 MyFileFormat v1 解码器，则指针允许您跳过 v1 解码器不理解的部分。如果您只是跳过无效标签，您可能可以简单地使用 TLV 而不是 TPLV。

 *[我要么手动编写类似的代码，要么在ASN.1](http://en.wikipedia.org/wiki/ASN.1)中定义我的格式并生成一个编解码器（我在电信部门工作，所以 ASN.1/TLV 对我来说很有意义 :-D）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-11-19T01:28:21.893

如果您正在处理可变长度数据，使用指针*会更*有效：有一个指向数据的指针数组，最好在文件开头附近，而不是将数据直接存储在数组中。

在这种情况下，最好使用间接方式，因为它允许随机访问，这只有在所有项目大小相同的情况下才有可能。如果数据直接存储在数组中，不指定任何记录的位置，最坏情况下数据访问将花费 O( *n* ) 时间；为了让您的文件读取代码访问特定元素，它必须知道所有先前元素的长度，而找出它的唯一方法是查看每个元素。如果您一次读取整个文件，那么无论如何您都会这样做，所以这不是问题。但是，如果您只想要一件事，那么这不是要走的路。

而对于一个指针数组，它是 O(1) 时间：你所需要的只是一个索引号，你可以检索并跟随指针来获取你的数据。

使用此方法写入文件时，您当然必须在进行任何写入之前在内存中建立表。

# c# - 如何使用 C# 获取 Active Directory 中所有域的列表

> ID：323608
> 
> 赞同：9
> 
> 时间：2008-11-27T12:30:52.517
> 
> 标签：c#, active-directory, dns

谁能帮我获取 Active Directory 中的所有域。我已经尝试了很多次，但是所有程序都只列出了当前的工作域。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-27T18:17:16.123

```
Domain domain = Domain.GetDomain(new DirectoryContext(DirectoryContextType.Domain, "yourDomain", "username", "password"));

Forest forest = domain.Forest;

DomainCollection domains = forest.Domains; 
```

The above uses the System.DirectoryServices.ActiveDirectory namespace. It'll give you a domain collection containing all the domains that are in the same forest as your given domain.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-27T00:45:05.007

[我在让LeeMobile 的代码](https://stackoverflow.com/a/324416/1574221)在我的案例中工作时遇到了一些问题，因为它在运行 forest.Domains 时试图找到我的应用程序的当前域上下文。我能够通过做这样的事情来解决它。

```
Forest forest = Forest.GetForest(new DirectoryContext(DirectoryContextType.Forest, "yourForestDomain", "username", "password"));
DomainCollection domains = forest.Domains; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T12:38:26.777

使用 DirectorySearcher，您可以连接和读取一个 Active Directory 的结构，包括结构（组织单位、组、用户、计算机、域控制器）。为了连接到不同的域，您需要该其他域的凭据。我们在从属于与目标域不同的域的计算机连接到另一个域时遇到问题。我也很好奇这是否可能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-29T00:25:48.707

您还可以使用 System.DirectoryServices.ActiveDirectory.Forest.GetCurrentForest().Domains

```
var domains = Forest.GetCurrentForest().Domains.Cast<Domain>();
foreach (var domain in domains)
{
    Console.WriteLine(domain.Name);
} 
```

# ruby-on-rails - 在分配虚拟属性时发出信号验证错误？

> ID：323610
> 
> 赞同：3
> 
> 时间：2008-11-27T12:31:43.543
> 
> 标签：ruby-on-rails, validation, activerecord, virtual-attribute

这是一个 Rails/ActiveRecord 问题。

我有一个模型，它基本上必须代表*事件*或表演。每个事件都有许多*属性*：属性基本上类似于“在这个事件中，人 X 有角色 Y”。

我得出的结论是，允许用户编辑此数据的最佳方法是提供一个需要结构化格式的自由文本字段，我将其称为*角色字符串*：

`singer: Elvis Costello, songwriter: Paul McCartney, ...`

我使用自动完成功能来完成角色名称（歌手、词曲作者......）和人名。角色和人员都存储在数据库中。

为了实现这一点，我在 Event 模型中创建了一个虚拟属性：

```
def role_string
    # assemble a role string from the associations in the model
end

def role_string=(s)
    # parse a string in the above role string format,
    # look up the People and Events mentioned, and update
    # what's in the database
end 
```

这一切都很好。当角色字符串格式正确并且角色字符串给出的关联都检查出来时，整个事情运行得很好。

但是如果角色字符串格式不正确怎么办？好的，我想，我可以使用正则表达式和标准验证来检查格式：

```
validates_format_of :role_string, :with => /(\w+:\s*\w+)(,\s*\w+:\s*\w+)*/ 
```

但是如果角色字符串隐含的关联无效怎么办？例如，如果我给上面的角色字符串，并且`Elvis Costello`没有引用一个有效的人，会发生什么？

我想，好吧，我可以使用`validates_each`属性`:role_string`来查找关联，如果给定的名称之一不匹配任何内容，则抛出错误。

我的问题有两个：首先，我不喜欢这种方法，因为要验证关联，我必须解析字符串并查找它们，这重复了我自己要做的事情`role_string=`，除了实际将关联保存到数据库。

其次，......我如何表明在分配给这个虚拟属性时发生了错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-01T15:11:10.823

首先，您错误地将 Person 归因于 Event。相反，您应该将人员的 ID 传递给事件，而不是人员姓名的字符串。例如，如果一个 ID 为 230404 且名字为“Elvis Costello”的人将他的名字改为“Britney Spears”怎么办？好吧，如果发生这种情况，ID 将保持不变，但名称会改变。但是，您将无法再引用该人。

您应该设置关联，以便外键在多种情况下引用人员：

```
has_one :singer, :class_name => "Person", :foreign_key => "singer_id"
has_one :songwriter, :class_name => "Person", :foreign_key => "songwriter_id" 
```

这样，您可以让多个人员在不同的角色下与一个事件关联，并且您可以引用 Person 可能具有的多个属性。例如：

```
Event.first.singer.name   # => "Elvis Costello"
Event.first.songwriter.name   # => "Britney Spears" 
```

您可以研究关联的可用验证 ( `validates_associated`)，以及表单中是否存在 ID ( `validates_presence_of`)。我建议创建您自己的自定义验证，以确保 Person 在 before_save 之前有效。类似（未经测试）：

```
def before_save
  unless Person.exists?(self.songwriter_id)
    self.errors.add_to_base("Invalid songwriter. Please try again!")
    return false
  end
end 
```

另外，我注意到您正在寻找一种方法让用户选择应该用于您的事件中角色的用户。以下是您可以在部分表单中执行的操作：

```
select(:event, :singer_id, Person.find(:all).collect {|p| [ p.name, p.id ] }, { :include_blank => 'None' }) 
```

希望这可以帮助！

# .net - 异构字典，但输入？

> ID：323613
> 
> 赞同：7
> 
> 时间：2008-11-27T12:32:44.387
> 
> 标签：.net

这更像是一个学术探究，而不是一个实际问题。是否有任何语言或框架功能可以或将来允许异构类型的字典，例如

```
myDict.Add("Name", "Bill"); 
myDict.Add("Height", 1.2); 
```

myDict 现在包含的不是两种`object`类型的值，而是一种`string`和一种`double`？然后我可以`double`用

```
double dbl = myDict["Height"]; 
```

并期望抛出双重或异常？

请注意：名称和高度值不一定属于同一对象。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-27T13:06:49.153

如果您有一个带有通用重载的 Add 和 Get 方法的自定义集合，那么您将能够做到这一点的唯一方法。但这意味着您可以在读取密钥时要求错误的类型，因此当您调用 Get 方法时，它不会比您自己进行转换获得太多（如果有的话）。

但是，如果您可以将泛型类型推送到键中，那么这可能会起作用。类似的东西（此处未经测试的代码）

```
sealed class MyDictionaryKey<T>
{
}

class MyDictionary
{
    private Dictionary<object, object> dictionary = new Dictionary<object, object>();

    public void Add<T>(MyDictionaryKey<T> key, T value)
    {
        dictionary.Add(key, value);
    }

    public bool TryGetValue<T>(MyDictionaryKey<T> key, out T value)
    {
      object objValue;
      if (dictionary.TryGetValue(key, out objValue))
      {
        value = (T)objValue;
        return true;
      }
      value = default(T);
      return false;
    }

    public T Get<T>(MyDictionaryKey<T> key)
    {
      T value;
      if (!TryGetValue(key, out value))
         throw new KeyNotFoundException();
      return value;
    }
} 
```

然后你可以定义你的键，如：

```
static readonly MyDictionaryKey<string> NameKey = new MyDictionaryKey<string>();
static readonly MyDictionaryKey<double> HeightKey = new MyDictionaryKey<double>(); 
```

并像使用它一样

```
var myDict = new MyDictionary();
myDict.Add(NameKey, "Bill"); // this will take a string
myDict.Add(HeightKey , 1.2); // this will take a double

string name = myDict.Get(NameKey); // will return a string
double height = myDict.Get(HeightKey); // will return a double 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T12:37:04.593

您可以使用通用`Dictionary<object, object>`；键的对象类型和值的对象类型。C# 可以提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T12:47:38.583

键都是字符串？那么`Dictionary<string,object>`可能会完成这项工作......但是在获取值时，您要么需要使用`object`，要么需要强制转换：

```
double dbl = (double)myDict["Height"];
object height = myDict["Height"]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T12:48:41.950

如果类型是类，则没有什么可以阻止您连接两者并将实例放入字典 <foo, IYourInterface>

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-27T13:06:02.727

字典不是这样做的方法。
你真的需要一个 Person 类来存储这些值。

而且，使用类创建集合和捕获错误要容易得多。

**编辑：**

因为你需要一个半强类型的字典：

```
public class CustomDictionary : Dictionary<string,object>
{
    public T GetTyped<T>(string key) where T : IConvertible
    {
        return (T)Convert.ChangeType(base[key], typeof (T));
    }
} 
```

用法：

```
CustomDictionary dictionary = new CustomDictionary();

dictionary.Add("Test",1.2);

var d = dictionary.GetTyped<double>("Test"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-27T12:39:05.200

有什么理由你不能创建一个类/结构并将其放入列表或字典中？否则，您可以用自己的字典类包装字典并以这种方式设置限制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-27T12:39:16.760

为什么不简单地将所有值存储为字符串，在检索它们时对其进行转换，并从该转换中捕获异常？

我不明白您为什么需要以这种方式做事-也许有必要重新设计您的程序？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-27T12:53:37.137

字典将包含一个字符串和一个双精度值作为值，但双精度值将被装箱。

编译器如何验证您的要求？它如何在编译时知道哪种类型的对象与每个键相关？

# asp.net - 在 NLB 集群中修改应用程序的 web.config 文件

> ID：323614
> 
> 赞同：-1
> 
> 时间：2008-11-27T12:33:18.597
> 
> 标签：asp.net, iis

我想知道在运行 ASP.NET 应用程序时修改 web.config 文件会产生什么影响。

这是我的确切情况。我有两台主机在 IIS6 上运行相同的应用程序。两台主机都有完全相同的 machine.config 文件，这意味着它们共享相同的机器密钥。

```
 |
              |
[HOST A]----[NLB]---[HOST B]
    |                  |
    |                  |
    |                  |
    |                  |
[SQL server for ASP.NET sessions] 
```

该应用程序必须在每天 7:00 至 18:00 之间可供用户访问。19:00 主机 A 和 B 重新启动，我们可以对两台主机上的应用程序进行一些更新。但有时我们希望能够在应用程序正常运行期间进行更新。更新通常包括向 web.config 添加一些值，据我所知，这会导致应用程序重新启动。

该应用程序严重依赖会话，但它们持久化在 SQL Server 中，并且只有缓存数据存储在服务器内存中，如果这些数据丢失并不重要。但是丢失用户会话是绝对不能接受的。我的问题是，如果我们在服务器当前正在执行用户请求的情况下修改网络场中一台主机上的 web.config 文件，用户会体验到什么？如果在应用程序重新启动时有新的请求进来，会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T15:50:29.463

好吧，你自己已经给出了答案。通常，会话在重新启动时会中断，但您使用 SQL Server 来持久化它们，因此它们不会丢失。

但是，新访问者在重新启动时会收到错误页面。但它们不会触发新的会话开始，因此访问者可以保持 F5'ing 直到应用程序运行。

# tomcat - 找不到 Tomcat 5.5.27 的 httpd.conf

> ID：323626
> 
> 赞同：2
> 
> 时间：2008-11-27T12:36:09.400
> 
> 标签：tomcat, httpd.conf

我需要配置 Tomcat 5.5.27 以禁用弱密码、ServerSignature 和 AuthType，但我找不到 httpd.conf 文件。请让我知道这件事。

提前致谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T12:38:24.063

Tomcat 不使用 httpd.conf，它不是 apache。

相反，请查看 tomcat 发行版中的 conf 文件夹并查看在线文档以在[http://tomcat.apache.org上配置您的 tomcat 版本](http://tomcat.apache.org)

# oracle - 继续循环中的错误

> ID：323629
> 
> 赞同：1
> 
> 时间：2008-11-27T12:37:15.077
> 
> 标签：oracle, plsql

下面的循环调用了一个执行各种“事情”的过程

如果它应该抛出异常，它也会“引发”它。我想抓住它并忽略它，让循环继续处理数组中的下一个值。

谢谢

```
WHILE indx IS NOT NULL LOOP

    table_dump_csv(tableList(indx), tableList(indx) || '.csv');

    indx := tableList.NEXT(indx);
END LOOP; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T12:41:07.863

一种可能的方法...

```
 WHILE indx IS NOT NULL LOOP

      BEGIN
         table_dump_csv(tableList(indx), tableList(indx) || '.csv');
      EXCEPTION
         WHEN OTHERS THEN
            -- Handle/Ignore the exception as appropriate
      END;

      indx := tableList.NEXT(indx);

   END LOOP; 
```

或者，您可以将过程更改为返回成功/失败代码的函数。

# c# - 我可以将 C# 字符串值转换为转义字符串文字吗？

> ID：323640
> 
> 赞同：211
> 
> 时间：2008-11-27T12:39:36.977
> 
> 标签：c#, string, escaping

在 C# 中，我可以像在代码中看到的那样将字符串值转换为字符串文字吗？我想用它们的转义序列替换制表符、换行符等。

如果此代码：

```
Console.WriteLine(someString); 
```

产生：

```
Hello
World! 
```

我想要这个代码：

```
Console.WriteLine(ToLiteral(someString)); 
```

生产：

```
\tHello\r\n\tWorld!\r\n 
```

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2008-11-27T23:40:44.613

我找到了这个：

```
private static string ToLiteral(string input)
{
    using (var writer = new StringWriter())
    {
        using (var provider = CodeDomProvider.CreateProvider("CSharp"))
        {
            provider.GenerateCodeFromExpression(new CodePrimitiveExpression(input), writer, null);
            return writer.ToString();
        }
    }
} 
```

这段代码：

```
var input = "\tHello\r\n\tWorld!";
Console.WriteLine(input);
Console.WriteLine(ToLiteral(input)); 
```

产生：

```
 Hello
    World!
"\tHello\r\n\tWorld!" 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-01-16T11:31:19.350

使用[Regex.Escape(String)](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape.aspx)：

> Regex.Escape 通过将字符（、*、+、?、|、{、[、(,)、^、$、.、# 和空格）替换为它们的转义码来转义最小的字符集。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-11-27T12:49:38.440

一种更结构化的方法，包括`string`s 和`char`s 的所有转义序列，是：

它不会用文字等价物替换 Unicode 字符。它也不煮鸡蛋。

```
public class ReplaceString
{
    static readonly IDictionary<string, string> m_replaceDict
        = new Dictionary<string, string>();

    const string ms_regexEscapes = @"[\a\b\f\n\r\t\v\\""]";

    public static string StringLiteral(string i_string)
    {
        return Regex.Replace(i_string, ms_regexEscapes, match);
    }

    public static string CharLiteral(char c)
    {
        return c == '\'' ? @"'\''" : string.Format("'{0}'", c);
    }

    private static string match(Match m)
    {
        string match = m.ToString();
        if (m_replaceDict.ContainsKey(match))
        {
            return m_replaceDict[match];
        }

        throw new NotSupportedException();
    }

    static ReplaceString()
    {
        m_replaceDict.Add("\a", @"\a");
        m_replaceDict.Add("\b", @"\b");
        m_replaceDict.Add("\f", @"\f");
        m_replaceDict.Add("\n", @"\n");
        m_replaceDict.Add("\r", @"\r");
        m_replaceDict.Add("\t", @"\t");
        m_replaceDict.Add("\v", @"\v");

        m_replaceDict.Add("\\", @"\\");
        m_replaceDict.Add("\0", @"\0");

        //The SO parser gets fooled by the verbatim version
        //of the string to replace - @"\"""
        //so use the 'regular' version
        m_replaceDict.Add("\"", "\\\"");
    }

    static void Main(string[] args){

        string s = "here's a \"\n\tstring\" to test";
        Console.WriteLine(ReplaceString.StringLiteral(s));
        Console.WriteLine(ReplaceString.CharLiteral('c'));
        Console.WriteLine(ReplaceString.CharLiteral('\''));

    }
} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2012-12-30T02:18:37.083

这是一个完全有效的实现，包括转义 Unicode 和 ASCII 不可打印字符。它不会像[Hallgrim 的回答](https://stackoverflow.com/a/324812/254101)那样插入“+”号。

```
static string ToLiteral(string input) {
    StringBuilder literal = new StringBuilder(input.Length + 2);
    literal.Append("\"");
    foreach (var c in input) {
        switch (c) {
            case '\"': literal.Append("\\\""); break;
            case '\\': literal.Append(@"\\"); break;
            case '\0': literal.Append(@"\0"); break;
            case '\a': literal.Append(@"\a"); break;
            case '\b': literal.Append(@"\b"); break;
            case '\f': literal.Append(@"\f"); break;
            case '\n': literal.Append(@"\n"); break;
            case '\r': literal.Append(@"\r"); break;
            case '\t': literal.Append(@"\t"); break;
            case '\v': literal.Append(@"\v"); break;
            default:
                // ASCII printable character
                if (c >= 0x20 && c <= 0x7e) {
                    literal.Append(c);
                // As UTF16 escaped character
                } else {
                    literal.Append(@"\u");
                    literal.Append(((int)c).ToString("x4"));
                }
                break;
        }
    }
    literal.Append("\"");
    return literal.ToString();
} 
```

请注意，这也会转义所有 Unicode 字符。如果您的环境支持它们，您可以更改该部分以仅转义控制字符：

```
// UTF16 control characters
} else if (Char.GetUnicodeCategory(c) == UnicodeCategory.Control) {
    literal.Append(@"\u");
    literal.Append(((int)c).ToString("x4"));
} else {
    literal.Append(c);
} 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2012-03-02T11:04:00.363

尝试：

```
var t = HttpUtility.JavaScriptStringEncode(s); 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-11-27T16:00:09.270

```
public static class StringHelpers
{
    private static Dictionary<string, string> escapeMapping = new Dictionary<string, string>()
    {
        {"\"", @"\\\"""},
        {"\\\\", @"\\"},
        {"\a", @"\a"},
        {"\b", @"\b"},
        {"\f", @"\f"},
        {"\n", @"\n"},
        {"\r", @"\r"},
        {"\t", @"\t"},
        {"\v", @"\v"},
        {"\0", @"\0"},
    };

    private static Regex escapeRegex = new Regex(string.Join("|", escapeMapping.Keys.ToArray()));

    public static string Escape(this string s)
    {
        return escapeRegex.Replace(s, EscapeMatchEval);
    }

    private static string EscapeMatchEval(Match m)
    {
        if (escapeMapping.ContainsKey(m.Value))
        {
            return escapeMapping[m.Value];
        }
        return escapeMapping[Regex.Escape(m.Value)];
    }
} 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2013-02-06T00:41:58.087

[Hallgrim 的回答](https://stackoverflow.com/a/324812/254101)非常好，但是“+”、换行符和缩进添加对我来说破坏了功能。一个简单的方法是：

```
private static string ToLiteral(string input)
{
    using (var writer = new StringWriter())
    {
        using (var provider = CodeDomProvider.CreateProvider("CSharp"))
        {
            provider.GenerateCodeFromExpression(new CodePrimitiveExpression(input), writer, new CodeGeneratorOptions {IndentString = "\t"});
            var literal = writer.ToString();
            literal = literal.Replace(string.Format("\" +{0}\t\"", Environment.NewLine), "");
            return literal;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2019-11-12T19:50:58.523

[在Roslyn](https://en.wikipedia.org/wiki/.NET_Compiler_Platform)的NuGet 上的[Microsoft.CodeAnalysis.CSharp](https://www.nuget.org/packages/Microsoft.CodeAnalysis.CSharp/)包中有一种方法：

```
private static string ToLiteral(string valueTextForCompiler)
{
    return Microsoft.CodeAnalysis.CSharp.SymbolDisplay.FormatLiteral(valueTextForCompiler, false);
} 
```

显然，在最初的问题出现时这并不存在，但它可能会帮助那些最终从谷歌搜索到这里的人。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-01-24T13:17:01.793

这是[Smilediver 的回答](https://stackoverflow.com/questions/323640/can-i-convert-a-c-sharp-string-value-to-an-escaped-string-literal/14087738#14087738)的一点改进。它不会转义所有非 ASCII 字符，但只有这些是真正需要的。

```
using System;
using System.Globalization;
using System.Text;

public static class CodeHelper
{
    public static string ToLiteral(this string input)
    {
        var literal = new StringBuilder(input.Length + 2);
        literal.Append("\"");
        foreach (var c in input)
        {
            switch (c)
            {
                case '\'': literal.Append(@"\'"); break;
                case '\"': literal.Append("\\\""); break;
                case '\\': literal.Append(@"\\"); break;
                case '\0': literal.Append(@"\0"); break;
                case '\a': literal.Append(@"\a"); break;
                case '\b': literal.Append(@"\b"); break;
                case '\f': literal.Append(@"\f"); break;
                case '\n': literal.Append(@"\n"); break;
                case '\r': literal.Append(@"\r"); break;
                case '\t': literal.Append(@"\t"); break;
                case '\v': literal.Append(@"\v"); break;
                default:
                    if (Char.GetUnicodeCategory(c) != UnicodeCategory.Control)
                    {
                        literal.Append(c);
                    }
                    else
                    {
                        literal.Append(@"\u");
                        literal.Append(((ushort)c).ToString("x4"));
                    }
                    break;
            }
        }
        literal.Append("\"");
        return literal.ToString();
    }
} 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-11-27T12:48:11.593

有趣的问题。

如果找不到更好的方法，可以随时更换。
如果你选择它，你可以使用这个**C# Escape Sequence List**：

*   \' - 单引号，字符文字需要
*   \" - 双引号，字符串文字需要
*   \ - 反斜杠
*   \0 - Unicode 字符 0
*   \a - 警报（字符 7）
*   \b - 退格（字符 8）
*   \f - 换页（字符 12）
*   \n - 换行（字符 10）
*   \r - 回车（字符 13）
*   \t - 水平制表符（字符 9）
*   \v - 垂直引号（字符 11）
*   \uxxxx - 十六进制值 xxxx 字符的 Unicode 转义序列
*   \xn[n][n][n] - 十六进制值 nnnn 字符的 Unicode 转义序列（\uxxxx 的可变长度版本）
*   \Uxxxxxxxx - 十六进制值 xxxxxxxx 字符的 Unicode 转义序列（用于生成代理）

此列表可在 C# 常见问题解答中找到 [哪些字符转义序列可用？](https://devblogs.microsoft.com/csharpfaq/what-character-escape-sequences-are-available/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-02-04T07:57:58.803

如果 JSON 约定对于您想要转义的非转义字符串已经足够了，并且您已经在项目中使用了[Json.NET](https://www.newtonsoft.com/json/help/html/Introduction.htm) ( `Newtonsoft.Json`)（它的开销非常大），您可以使用这个包，如下所示：

```
using System;
using Newtonsoft.Json;

public class Program
{
    public static void Main()
    {
        Console.WriteLine(ToLiteral(@"abc\n123"));
    }

    private static string ToLiteral(string input)
    {
        return JsonConvert.DeserializeObject<string>("\"" + input + "\"");
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-01-30T11:10:45.110

```
public static class StringEscape
{
  static char[] toEscape = "\0\x1\x2\x3\x4\x5\x6\a\b\t\n\v\f\r\xe\xf\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\"\\".ToCharArray();
  static string[] literals = @"\0,\x0001,\x0002,\x0003,\x0004,\x0005,\x0006,\a,\b,\t,\n,\v,\f,\r,\x000e,\x000f,\x0010,\x0011,\x0012,\x0013,\x0014,\x0015,\x0016,\x0017,\x0018,\x0019,\x001a,\x001b,\x001c,\x001d,\x001e,\x001f".Split(new char[] { ',' });

  public static string Escape(this string input)
  {
    int i = input.IndexOfAny(toEscape);
    if (i < 0) return input;

    var sb = new System.Text.StringBuilder(input.Length + 5);
    int j = 0;
    do
    {
      sb.Append(input, j, i - j);
      var c = input[i];
      if (c < 0x20) sb.Append(literals[c]); else sb.Append(@"\").Append(c);
    } while ((i = input.IndexOfAny(toEscape, j = ++i)) > 0);

    return sb.Append(input, j, input.Length - j).ToString();
  }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-11-02T11:15:12.063

我尝试将*ToVerbatim*添加到[Hallgrim 接受的答案](https://stackoverflow.com/a/324812/254101)中：

```
private static string ToLiteral(string input)
{
    using (var writer = new StringWriter())
    {
        using (var provider = CodeDomProvider.CreateProvider("CSharp"))
        {
            provider.GenerateCodeFromExpression(new CodePrimitiveExpression(input), writer, new CodeGeneratorOptions { IndentString = "\t" });
            var literal = writer.ToString();
            literal = literal.Replace(string.Format("\" +{0}\t\"", Environment.NewLine), "");
            return literal;
        }
    }
}

private static string ToVerbatim(string input)
{
    string literal = ToLiteral(input);
    string verbatim = "@" + literal.Replace(@"\r\n", Environment.NewLine);
    return verbatim;
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-02-18T19:19:26.750

[Hallgrim 的回答](https://stackoverflow.com/questions/323640/can-i-convert-a-c-sharp-string-value-to-an-escaped-string-literal/324812#324812)非常好。这是一个小调整，以防您需要使用 C# 正则表达式解析出额外的空白字符和换行符。在将序列化的 JSON 值插入[Google 表格](https://en.wikipedia.org/wiki/Google_Sheets)的情况下，我需要这个，并且在代码插入制表符、+、空格等时遇到了麻烦。

```
 provider.GenerateCodeFromExpression(new CodePrimitiveExpression(input), writer, null);
  var literal = writer.ToString();
  var r2 = new Regex(@"\"" \+.\n[\s]+\""", RegexOptions.ECMAScript);
  literal = r2.Replace(literal, "");
  return literal; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-06-03T22:15:09.333

我提交了我自己的实现，它处理值，并且由于使用数组查找表、手动十六进制转换和避免语句`null`而应该具有更高的性能。`switch`

```
using System;
using System.Text;
using System.Linq;

public static class StringLiteralEncoding {
  private static readonly char[] HEX_DIGIT_LOWER = "0123456789abcdef".ToCharArray();
  private static readonly char[] LITERALENCODE_ESCAPE_CHARS;

  static StringLiteralEncoding() {
    // Per http://msdn.microsoft.com/en-us/library/h21280bw.aspx
    var escapes = new string[] { "\aa", "\bb", "\ff", "\nn", "\rr", "\tt", "\vv", "\"\"", "\\\\", "??", "\00" };
    LITERALENCODE_ESCAPE_CHARS = new char[escapes.Max(e => e[0]) + 1];
    foreach(var escape in escapes)
      LITERALENCODE_ESCAPE_CHARS[escape[0]] = escape[1];
  }

  /// <summary>
  /// Convert the string to the equivalent C# string literal, enclosing the string in double quotes and inserting
  /// escape sequences as necessary.
  /// </summary>
  /// <param name="s">The string to be converted to a C# string literal.</param>
  /// <returns><paramref name="s"/> represented as a C# string literal.</returns>
  public static string Encode(string s) {
    if(null == s) return "null";

    var sb = new StringBuilder(s.Length + 2).Append('"');
    for(var rp = 0; rp < s.Length; rp++) {
      var c = s[rp];
      if(c < LITERALENCODE_ESCAPE_CHARS.Length && '\0' != LITERALENCODE_ESCAPE_CHARS[c])
        sb.Append('\\').Append(LITERALENCODE_ESCAPE_CHARS[c]);
      else if('~' >= c && c >= ' ')
        sb.Append(c);
      else
        sb.Append(@"\x")
          .Append(HEX_DIGIT_LOWER[c >> 12 & 0x0F])
          .Append(HEX_DIGIT_LOWER[c >>  8 & 0x0F])
          .Append(HEX_DIGIT_LOWER[c >>  4 & 0x0F])
          .Append(HEX_DIGIT_LOWER[c       & 0x0F]);
    }

    return sb.Append('"').ToString();
  }
} 
```

* * *

## 回答 #16

> 赞同：-9
> 
> 时间：2008-11-27T14:36:44.667

**代码：**

```
string someString1 = "\tHello\r\n\tWorld!\r\n";
string someString2 = @"\tHello\r\n\tWorld!\r\n";

Console.WriteLine(someString1);
Console.WriteLine(someString2); 
```

**输出：**

```
 Hello
    World!

\tHello\r\n\tWorld!\r\n 
```

# javascript - Opera 中的 HTML 表单提交

> ID：323648
> 
> 赞同：0
> 
> 时间：2008-11-27T12:42:57.250
> 
> 标签：javascript, html, cross-browser, opera

下面显示的 HTML 表单在 Opera（版本：9.52）中无法正常工作。该表单没有 onsubmit 属性，也没有 type=submit 的 input 元素。它只有两个 type=button 的输入元素，它们都 onclick 调用一个 js 方法，我希望用户在其中确认提交。如果我删除 confirm() 调用，它工作得很好。在所有其他浏览器（FF2、FF3、IE7）中它运行良好。

任何指针？

```
<script type = "text/javascript">
function userSubmit(submitStatus)
{
    // Omitted code that uses the parameter 'submitStatus' for brevity
    if(confirm('Are you sure you want to submit?'))
        document.qpaper.pStatus.value = something;
    else
        return;     
    document.qpaper.submit();
}
</script>
<form  name = "qpaper" method = "post" action = "evaluate.page">
    <input name = "inp1" type = "button" value = "Do This" class = "formbutton" onClick = "userSubmit(false)">
    <input name = "inp2" type = "button" value = "Do That" class = "formbutton" onClick = "userSubmit(true)">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T12:49:40.793

1.  永远不要使用`document.nameofsomething`. 这是一种过时的技术，在 21 世纪的浏览器中得到了不完整的支持。对于表单使用`document.forms.nameofform`.

2.  不要在按钮上使用 onclick，除非您需要 Javascript 根据按下的按钮来表现不同。如果您只想验证表单或确认提交，请`<form onsubmit>`改用。

    ```
    <form onsubmit="return confirm('Sure?')"> 
    ```

    这样你甚至不需要`form.submit()`. 如果`<form onsubmit>`返回 false，提交将被中止。

3.  你甚至不需要找到那个表格。
    在`<button onclick>`形式上将`this.form`。
    在`<form onsubmit>`形式将是`this`可变的。

# php - 变量没有被传递？

> ID：323650
> 
> 赞同：0
> 
> 时间：2008-11-27T12:43:38.747
> 
> 标签：php, javascript, ajax

我有这个代码

```
while($row = mysql_fetch_row($result))
{
echo '<tr>';
$pk = $row[0]['ARTICLE_NO'];

foreach($row as $key => $value)
{
echo '<td><a href="#" onclick="GetAuctionData(\''.$pk.'\')">' . $value . '</a></td>';
} 
```

得到pk。然后将 pk 传递给 axjax 部分：

```
function GetAuctionData(pk)
{
.....
var url="get_auction.php?"
url=url+"cmd=GetAuctionData&pk="+pk; 
```

最后在一个单独的 php 文件中使用：

```
$pk = $_GET["pk"];
$sql="SELECT * FROM Auctions WHERE ARTICLE_NO ='$pk'"; 
```

第二个 php 文件在单独使用它并传递参数时工作正常。同样，任何地方都没有错误。问题似乎在于传递或生成 $pk，因为输出文件中的链接导致 $pk 增加 2，例如 4、6、8 等

我不明白为什么会这样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T12:59:36.250

mysql_fetch_row[链接](http://no.php.net/manual/en/function.mysql-fetch-row.php)没有子数组。它将返回第一个字段为 0，下一个字段为 1，依此类推。

尝试

```
$pk = $row[0]; 
```

这可以很容易地与你的 foreach 一起使用

```
while($row = mysql_fetch_assoc($result))
$pk = $row['ARTICLE_NO']; 
```

或者这为您提供了关联数组和编号数组。

```
while($row = mysql_fetch_array($result, MYSQL_BOTH))
$pk = $row['ARTICLE_NO']; 
```

编辑：基于

```
$result = mysql_query("SELECT SELLER_ID, ACCESSSTARTS, ARTICLE_NAME FROM {$table}"); 
```

您必须包含要从中获取值的行。;)

```
$result = mysql_query("ARTICLE_NO, SELECT SELLER_ID, ACCESSSTARTS, ARTICLE_NAME FROM {$table}"); 
```

顺便说一句：我很确定这个嵌套循环不会产生你想要的。您将获得每个 article_no 的 3 个链接。第一个以seller_id 作为文本，第二个文本是accessstarts，最后一个具有相同href 的链接将具有文本article_name。

也许是这样的？

```
while($row = mysql_fetch_assoc($result))
{
    $pk = $row['ARTICLE_NO'];
    echo '<td><a href="#" onclick="GetAuctionData(\''.$pk.'\')">' . $row['ARTICLE_NAME'] . '</a></td>';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T12:56:32.403

正如 troelskn 所说，您似乎对 mysql_fetch_row 返回的内容有些困惑。

mysql_fetch_row 将返回 $article[0]、$article[1] 等

还有：

```
mysql_fetch_assoc // return $article['ARTICLE_NO'], $article['otherfield'] etc

mysql_fetch_array // returns an array that is effectively the above two array_merge'd
mysql_fetch_object // returns a stdclass object, as if mysql_fetch_assoc had been passed to get_object_vars() 
```

鉴于此，您需要进行一些重构....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T12:51:20.870

我不认为这符合您的期望：

```
$pk = $row[0]['ARTICLE_NO']; 
```

尝试：

```
$pk = $row['ARTICLE_NO']; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-27T13:57:42.187

这里的其他回复应该可以充分回答您的问题，但我只是想添加一个额外的调试提示，以便在您将来遇到类似问题时为您提供帮助。

您只需将有关您正在使用的变量的信息打印到屏幕上，就可以进行一些非常基本的调试。（一个PHP IDE通常会有更强大的调试功能，但是对于这种问题，这种方法就可以了）

**您的原始代码：**

```
while($row = mysql_fetch_row($result))
{
    echo '<tr>';
    $pk = $row[0]['ARTICLE_NO'];

    foreach($row as $key => $value)
    {
        echo '<td><a href="#" onclick="GetAuctionData(\''.$pk.'\')">' . $value . '</a></td>';
    }
} 
```

您注意到 GetAuctionData 函数没有正确获取其变量。添加这一行：

```
$pk = $row[0]['ARTICLE_NO'];
var_dump($pk); 
```

如果您在运行文件时查看输出，您可能会看到它说 $pk 为空。嗯，那没用。让我们稍微改变一下：

```
$pk = $row[0]['ARTICLE_NO'];
var_dump($row); 
```

您现在会看到如下内容：

```
array(2) {
  [0]=> string(2) "12"
  [1]=> string(7) "myValue"
} 
```

啊哈！现在您可以确切地看到您正在使用什么，您会看到您首先要使用的代码是：

```
$pk = $row[0]; 
```

`var_dump()`是你的朋友。如果您正在使用数组，`print_r()`则会为您提供类似的信息，但格式很好。

祝你好运。

# facebook - 是否有可能/如何获取特定 Facebook 群组成员的数量（即使他们的数量是 500+）？

> ID：323653
> 
> 赞同：2
> 
> 时间：2008-11-27T12:44:44.703
> 
> 标签：facebook

我需要监控 facebook 组用户的数量并将其显示在网站上。我知道可以使用他们的 API 获取用户 ID，但仅限于 500 个（如果成员总数为 500+）。

获得注册我设置的 Facebook 群组的成员总数的最简单方法是什么？这是可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T14:38:11.450

如果你编写一个 http bot，它应该不会很难废弃，因为实时性能不是关键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-03T23:37:16.153

您可以使用这样的 FQL 查询来做到这一点：

```
SELECT uid FROM group_member WHERE gid = <group_id> limit 500
SELECT uid FROM group_member WHERE gid = <group_id> limit 500 offset 500
SELECT uid FROM group_member WHERE gid = <group_id> limit 500 offset 1000
... 
```

* * *

### 获取成员数量

在循环中执行（直到获得 0 个结果），您将获得组成员的总数

```
 perPage = 500
    for count in range(100):
        res = fql('SELECT uid FROM group_member WHERE gid = %s limit %d offset %d' % (fbUserId, perPage, perPage * count))
        if len(res) == 0:
            break
        friends += len(res) 
```

* * *

### 获取成员详细信息

您甚至可以加入用户 FQL 表以获取所有用户详细信息：

```
SELECT uid, name, pic_square FROM user WHERE uid IN ( 
         SELECT uid FROM group_member WHERE gid = <group_id> limit 500 offset %d ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T15:39:47.883

根据文档，`Groups.getMembers`通过 API 调用无法获得超过 500 个组成员。更糟糕的是，您似乎只能获得 500 个*随机*成员。

您可能需要考虑在您的网站上使用 Facebook Connect。我不是 Connect 方面的专家，但我相信你使用它不会有这个问题，因为你实际上是在编写 Facebook 特定的代码——似乎没有任何限制结果的目的。至少我会朝这个方向看。

祝你好运。

# c# - 有没有办法在调用基类构造函数时使用可覆盖的行为？

> ID：323668
> 
> 赞同：1
> 
> 时间：2008-11-27T12:49:02.417
> 
> 标签：c#, .net

标题有点抽象，所以用一个具体的例子可能更容易解释：

我发现让我的异常类采用枚举参数而不是字符串消息很有用。

```
throw new SpecificException(SpecificExceptionCode.ThisThingWentWrong); 
```

造成这种情况的原因很少，包括：

*   我可以将访问本地化字符串资源的所有逻辑封装在一个地方
*   我可以轻松地确保我拥有所有异常消息的字符串资源
*   在单元测试中检查正确的异常消息更简单

我想为这种类型的异常编写一个基类。派生的异常类通常只想提供自己的 System.Resources.ResourceManager 但也可能提供额外的构造函数。问题来了，因为我只能在调用基类构造函数时调用静态方法。这让我想到了类似的东西：

```
public abstract class BaseException : ApplicationException
{
    protected static ResourceManager m_resources;
    public BaseException(System.Enum errorCode, params object[] messageArgs) 
        : base(ProcessError(errorCode, messageArgs))
    {}

    private static string ProcessError(Enum errorCode, params object[] messageArgs)
    {
        string errorMessage = m_resources.GetString(errorCode.ToString());
        // Handling of messageArgs and trace logging
        // ....
        return finalError;
    }
} 
```

和

```
public class SpecificException : BaseException
{
    static SpecificException()
    {
        m_resources = //.. Get an appropriate resource manager instance
    }

    public SpecificException(SpecificExceptionCode errorCode, params object[] messageArgs)
        : base(errorCode, messageArgs)
    {}
} 
```

这可行，但我对此不满意，因为没有编译时提示派生类必须提供自己的`System.ResourceManager`. 我想要一个基类，例如：

```
public abstract class BaseException : ApplicationException
{
    protected abstract static ResourceManager Resources{get;}

    public BaseException(System.Enum errorCode, params object[] messageArgs) 
        : base(ProcessError(errorCode, messageArgs))
    {}

    private static string ProcessError(Enum errorCode, params object[] messageArgs)
    {
        string errorMessage = Resources.GetString(errorCode.ToString());
        // Handling of messageArgs and trace logging
        // ....
        return finalError;
    }
} 
```

...但我不能有一个抽象的静态方法。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T12:58:50.650

您当前的代码已损坏...只有一个静态字段；最后一个执行的静态ctor获胜。

重新使用非静态方法 - 请注意，在构造函数中调用虚拟/抽象方法有点危险 - 具体类尚未初始化，因此覆盖可能会尝试使用尚不可用的数据。

ResourceManager 不能成为基本构造函数的参数吗？如果它们传递 null，则使用合理的默认值... ProcessError 然后将接受 ResourceManager 等。

```
public abstract class BaseException : ApplicationException
{
    static ResourceManager defaultManager;
    static ResourceManager DefaultManager
    {
        get
        {
            if (defaultManager == null) defaultManager = TODO; // sensible default
            return defaultManager;
        }
    }

    public BaseException(System.Enum errorCode, params object[] messageArgs)
        : this(DefaultManager, errorCode, messageArgs) {}
    public BaseException(ResourceManager resourceManager, System.Enum errorCode, params object[] messageArgs)
        : base(ProcessError(resourceManager, errorCode, messageArgs))
    { }

    private static string ProcessError(ResourceManager resourceManager, Enum errorCode, params object[] messageArgs)
    {
        if (resourceManager == null) throw new ArgumentNullException("resourceManager");
        string errorMessage = resourceManager.GetString(errorCode.ToString());
        // Handling of messageArgs and trace logging
        // ....
        return finalString;
    }
} 
```

和：

```
public class SpecificException : BaseException
{
    static ResourceManager customManager;
    static SpecificException()
    {
        customManager = //TODO - init manager
    }
    public SpecificException(SomeEnum errorCode, params object[] messageArgs)
        : base(customManager, errorCode, messageArgs)
    { }
} 
```

不想提供自己的管理器的类只需使用另一个 ctor：

```
: base(errorCode, messageArgs) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T13:19:59.093

Why not have a protected constructor that takes a resource manager as a parameter? That way your concrete exception would have to pass it in.

I would tend to use a factory method rather than the constructor for this kind of issue though.

```
public static SpecificException SpecificExceptionCodeName()
{
    //Do resource lookup and create Exception
} 
```

and then use

```
throw ExceptionBuilder.SpecificExceptionCodeName(); 
```

this way you get the benefits you outlined without having to inherit from a specific base exception which allows you to throw any Exception you like. There are several places in the framework where it is internally using this method. Note that I tend not to put the factory method on the concrete exception because they showup on derived classes which can get.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T12:55:45.790

为什么它必须是静态属性？您可以使资源正常属性：

```
protected abstract static ResourceManager Resources{get;} 
```

并将它留给实现者来实现它以返回一个静态对象：

```
private static ResourceManager resources = ....

protected override static ResourceManager Resources{get {return resources; }} 
```

# python - 无明显原因使用 Python 列表切片语法

> ID：323689
> 
> 赞同：36
> 
> 时间：2008-11-27T12:57:05.473
> 
> 标签：python, list, shallow-copy

我偶尔会看到 Python 代码中使用的列表切片语法，如下所示：

```
newList = oldList[:] 
```

当然，这与以下内容相同：

```
newList = oldList 
```

还是我错过了什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-11-27T13:00:31.973

`[:]` [Shallow 复制](http://en.wikipedia.org/wiki/Deep_copy#Shallow_copy)列表，复制包含对原始列表成员的引用的列表结构。这意味着对副本的操作不会影响原件的结构。但是，如果您对列表成员执行某些操作，则两个列表仍然引用它们，因此如果通过原始成员访问成员，则会显示更新。

[Deep Copy](http://en.wikipedia.org/wiki/Deep_copy#Deep_copy)也会复制所有列表成员。

下面的代码片段显示了一个浅拷贝的操作。

```
# ================================================================
# === ShallowCopy.py =============================================
# ================================================================
#
class Foo:
    def __init__(self, data):
        self._data = data

aa = Foo ('aaa')
bb = Foo ('bbb')

# The initial list has two elements containing 'aaa' and 'bbb'
OldList = [aa,bb]
print OldList[0]._data

# The shallow copy makes a new list pointing to the old elements
NewList = OldList[:]
print NewList[0]._data

# Updating one of the elements through the new list sees the
# change reflected when you access that element through the
# old list.
NewList[0]._data = 'xxx'
print OldList[0]._data

# Updating the new list to point to something new is not reflected
# in the old list.
NewList[0] = Foo ('ccc')
print NewList[0]._data
print OldList[0]._data 
```

在 python shell 中运行它会给出以下记录。我们可以看到列表是用旧对象的副本制作的。其中一个对象可以通过旧列表通过引用更新其状态，并且当通过旧列表访问该对象时可以看到更新。最后，可以看出更改新列表中的引用不会反映在旧列表中，因为新列表现在引用了不同的对象。

```
>>> # ================================================================
... # === ShallowCopy.py =============================================
... # ================================================================
... #
... class Foo:
...     def __init__(self, data):
...         self._data = data
...
>>> aa = Foo ('aaa')
>>> bb = Foo ('bbb')
>>>
>>> # The initial list has two elements containing 'aaa' and 'bbb'
... OldList = [aa,bb]
>>> print OldList[0]._data
aaa
>>>
>>> # The shallow copy makes a new list pointing to the old elements
... NewList = OldList[:]
>>> print NewList[0]._data
aaa
>>>
>>> # Updating one of the elements through the new list sees the
... # change reflected when you access that element through the
... # old list.
... NewList[0]._data = 'xxx'
>>> print OldList[0]._data
xxx
>>>
>>> # Updating the new list to point to something new is not reflected
... # in the old list.
... NewList[0] = Foo ('ccc')
>>> print NewList[0]._data
ccc
>>> print OldList[0]._data
xxx 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-11-27T13:13:58.483

就像 NXC 所说，Python 变量名实际上指向一个对象，而不是内存中的特定位置。

`newList = oldList`将创建两个指向同一个对象的不同变量，因此，更改`oldList`也会更改`newList`。

但是，当您这样做时`newList = oldList[:]`，它会“切片”列表，并创建一个新列表。的默认值为`[:]`0 和列表的末尾，因此它会复制所有内容。因此，它创建了一个新列表，其中包含第一个列表中包含的所有数据，但两者都可以在不改变另一个的情况下进行更改。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-27T13:40:50.487

正如已经回答的那样，我将简单地添加一个简单的演示：

```
>>> a = [1, 2, 3, 4]
>>> b = a
>>> c = a[:]
>>> b[2] = 10
>>> c[3] = 20
>>> a
[1, 2, 10, 4]
>>> b
[1, 2, 10, 4]
>>> c
[1, 2, 3, 20] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-27T13:45:58.730

永远不要认为 Python 中的“a = b”意味着“将 b 复制到 a”。如果双方都有变数，你就无法真正知道这一点。相反，将其视为“给 b 附加名称 a”。

如果 b 是一个不可变对象（如数字、元组或字符串），那么是的，效果就是你得到一个副本。但那是因为当您处理不可变对象（可能应该称为*read only*、*unchangeable*或*WORM*）时，根据定义，您*总是*会得到一个副本。

如果 b 是可变的，你*总是需要做一些额外的事情来确保你有一个真实的副本*。*总是*。使用列表，它就像切片一样简单：a = b[:]。

可变性也是这个原因：

```
def myfunction(mylist=[]): 
    pass 
```

...并没有完全按照您的想法进行。

如果您来自 C 语言背景：'=' 的左侧总是一个指针。所有变量都是指针，总是。如果你把变量放在一个列表中：a = [b, c]，你已经把指向 b 和 c 所指向的值的指针放在了 a 所指向的列表中。如果您随后设置 a[0] = d，则位置 0 中的指针现在指向 d 指向的任何内容。

另请参阅复制模块：  [http ://docs.python.org/library/copy.html](http://docs.python.org/library/copy.html)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-02-08T10:30:39.237

**浅拷贝：（**将内存块从一个位置复制到另一个位置）

```
a = ['one','two','three']

b = a[:]

b[1] = 2

print id(a), a #Output: 1077248300 ['one', 'two', 'three']
print id(b), b #Output: 1077248908 ['one', 2, 'three'] 
```

**Deep Copy：（**复制对象引用）

```
a = ['one','two','three']

b = a

b[1] = 2

print id(a), a #Output: 1077248300 ['one', 2, 'three']
print id(b), b #Output: 1077248300 ['one', 2, 'three'] 
```

# java - Hibernate 和 Oracle 原生函数

> ID：323690
> 
> 赞同：1
> 
> 时间：2008-11-27T12:57:48.377
> 
> 标签：java, oracle, hibernate

我有一个映射到外部 oracle 表的实体，该表是我的应用程序的主要数据源之一。这个实体是使用hibernate建模的。

oracle 表现在有一个复杂的函数，定义了计算一些特殊值。我需要以某种方式调用这个函数——几乎作为实体上的另一个访问器。

您建议合并此函数调用的最佳方法是什么，以便我可以保持对实体的相对正常的休眠访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-28T12:28:20.357

我有一个使用 @Formula 注释的解决方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T17:13:54.973

为了保持与 Hibernate 提供的数据库的解耦，我将依靠 Oracle 使用触发器或视图来调用此函数。

这种方法的主要优点是它与您的 Hibernate 实现完全无缝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:01:41.083

您可以使用带有 HQL 的存储过程直接调用该函数。当然，除非您必须为表中的每个条目调用此函数。但是，如果您在同一个休眠会话中执行此操作，只要您不同时执行多个调用，这应该可以在没有显着性能影响的情况下工作。

# asp.net - ASP.NET 和长时间运行的后台线程 - 它们如何混合？

> ID：323693
> 
> 赞同：1
> 
> 时间：2008-11-27T12:59:33.520
> 
> 标签：asp.net, multithreading, background

在我正在编写的 ASP.NET 应用程序中，我需要使用与特定服务器的连接（类似于 DB 但......不同）。建立连接非常昂贵（字面意思是几秒钟），所以我正在尝试编写一个池来提高可伸缩性。

一切都非常简单，直到某一点 - 回收旧连接。对于旧的，我的意思是“池中未使用时间超过 5 分钟的连接”。清理它们还可以释放它们连接的服务器上的资源。

我需要某种线程，每 5 分钟唤醒一次，检查池中旧的未使用连接，然后关闭它们。但是，正如我从 Google 中了解到的那样，ASP.NET 和长时间运行的线程不会混合使用。

我不害怕整个过程被终止，因为那样我的池也会被清理（析构函数和所有）。我担心的是我的清理线程可能会在我的应用程序终止之前终止（并且我的池没有清洁器）。或者反过来——我的清理线程阻止我的应用程序关闭。

如何正确实施？

* * *

有几个人建议使用外部服务来执行此操作。我将详细说明“mysterios 服务”，以便您了解为什么这是不可行的。

“神秘服务”是我公司编写了 10 多年的应用程序的庞然大物。它是一个使用 MSSQL 或 Oracle 作为数据的 Delphi 会计应用程序。没有其他服务器。

最近（就像几年前一样）它还获得了一个外部应用程序可以用来与之通信的接口。它是基本上相同的应用程序的 Windows 控制台应用程序，除了它不是 GUI 而是侦听套接字并使用某种 Delphi 序列化来来回传递数据。

在客户端有一个 .DLL（用 Java 编写，后来修改为在 J# 下编译），它解析这个二进制数据流并模仿 .NET 中的业务层。也就是说 - 我得到了与 Delphi 中的原始应用程序相同的所有业务类 (700+)。或者非常接近的东西（我认为应用程序本身有> 3000个类）。而且我必须使用它们来执行我想要的任何业务逻辑。我所有的呼叫都会被转发到真正的应用程序，然后由它来完成工作。

我无法直接连接到 MSSQL/Oracle 数据库，因为服务器中有很多奇怪的业务逻辑，然后我必须复制并跟上这些逻辑（应用程序正在不断开发中）。我无法重新创建客户端 .DLL，因为这太费时了，而且协议无论如何都会规定几乎相同的结果。我无法围绕它编写包装器，因为我必须包装其中的所有 700 多个类。

换句话说 - 我无法控制业务层。它就是这样（实际上有几个人已经退出而不是继续使用它）。我只是想把事情做到最好。

* * *

致克里斯和其他好奇的人。

使用这些东西的代码是这样的：

```
ConnectionType con = new ConnectionType;
con.OpenConnection("server", "port", "username", "password");
BLObjectNumber234 obj = (BLObjectNumber234)con.GetBLObject("BLObjectNumber234");
obj.GetByPK(123);
// Do some stuff with obj's properties and methods
// that are different for each BLObject type 
```

这些 BL 对象非常随意。它们都是单例 - 调用`con.GetBLObject`总是返回相同的实例。大部分数据是`DataTable`通过调用特殊方法获得的，但也有不少是在属性中；有些需要使用奇怪的未记录常量调用特殊方法；还有一些属性是其他 BL 对象实例（不确定它们是否也是单例，我认为不是），并且需要特殊代码来填充等。

总而言之，我将系统称为“补丁软件”——因为它似乎是由一百万个补丁和变通方法组成的，所有这些补丁都以当时最方便的方式结合在一起。

* * *

撞？（你怎么在这里撞到？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T13:46:06.467

您不需要包装每个类和函数，只需包装您需要执行的操作。因此，您可能需要一个获取一些数据的方法和一个更新一些数据的方法，这将在服务中转换为根据需要对各种函数的一系列调用。前端逻辑将被简化，因此这将简化网站的未来版本。

* * *

好的，只是为了解决您自己对这个问题的补充 - 我认为您对“包装器”的含义过于关注了。我希望你已经在做某种包装，或者我可能需要停止假设并直接问你这个问题：你是直接从 asp.net 页面后面的代码调用这个服务，还是你单独构建类来处理前端和服务之间的通信？一旦我们建立了您当前拥有的体系结构，我们将看看将这个逻辑移动到单独的服务是否可行（然后获得 WCF 可以提供的好处）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T14:16:00.777

我同意 Chris 的观点，将所有业务逻辑（与所有神秘业务对象通信的代码）放在一个单独的层而不是 Web（表示）层中会更合适。

这将使您的应用程序设计更具可扩展性，并且您将能够更轻松地完成池、线程和其他与可扩展性相关的任务。

如果您选择使用 WCF 在 Web 和业务层之间进行通信（如果它在同一台机器上，则使用名称管道），您将获得一个干净、可扩展和高性能的体系结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:07:09.417

You could write a WCF service that wrappers the service you are trying to call and then communicate with this mysterious service only through your WCF service application.

WCF has various models to handle pooling and cleanup.

# asp.net - 自动更新网络应用程序

> ID：323696
> 
> 赞同：0
> 
> 时间：2008-11-27T12:59:56.983
> 
> 标签：asp.net, auto-update

我的处境非常糟糕：我需要维护托管在我没有任何访问权限的环境中的 asp.net Web 应用程序。对于每一个小的干预，我都需要亲自去，包括检查程序，因为它是一个政府机构。

我想知道是否有某种方法可以从应用程序本身或从其他一些基于 Web 的工具部分完全更新 asp.net Web 应用程序。

我没有远程桌面、vpn，所有这些都应该通过 http 完成。

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T13:05:33.103

我认为给你的应用程序写入磁盘的权限不是一个好主意。更好的解决方案是在同一台机器上运行一个后端进程（服务），如果有新版本可用，它将检查您的某些服务器并在适当的场合部署它。但当然，这个过程必须具有写入磁盘和访问互联网（或外部网络）的权限。由于它是一个政府机构，我认为他们不会热衷于这样的解决方案。

# c# - 正则表达式匹配不以 .ext（扩展名）结尾的字符串（1+ 个字符）

> ID：323697
> 
> 赞同：13
> 
> 时间：2008-11-27T13:00:31.177
> 
> 标签：c#, .net, asp.net-mvc, regex

我需要测试一个**不**以它结尾的 url`.asp`

所以`test`, `test.html`and`test.aspx`应该匹配，但`test.asp`不应该匹配。

通常，您会测试 url**是否**以 .asp 结尾，并在代码中使用 NOT 运算符来否定它匹配的事实：

```
if(!regex.IsMatch(url)) { // Do something } 
```

在那种情况下，正则表达式将是`\.asp$`，但在这种情况下，我需要正则表达式来产生匹配。

* * *

`RouteCollection.MapRoute`背景：我需要在 ASP.NET MVC扩展方法中使用正则表达式作为路由约束。路由需要匹配所有控制器，但当 url 中的控制器以 .asp 结尾时，它应该会失败

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-27T13:23:35.967

诀窍是使用[否定的lookbehind](http://www.regular-expressions.info/lookaround.html)。

如果您只需要一个是/否的答案：

```
(?<!\.asp)$ 
```

如果您需要匹配整个 URL：

```
^.*(?<!\.asp)$ 
```

这些正则表达式适用于文件名出现在 URL 末尾的任何 URL（即没有查询或片段的 URL）。鉴于您问题中的正则表达式 .asp$，我假设您的 URL 符合此限制。如果您希望它适用于所有 URL，请尝试以下操作：

```
^[^#?]+(?<!\.asp)([#?]|$) 
```

或者，如果您希望正则表达式匹配整个 URL：

```
^[^#?]+(?<!\.asp)([#?].+|$) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T13:39:57.137

不是正则表达式，而是可以轻松完成这项工作的 c# String.EndsWith 方法。

IE

```
string test1 = "me.asp" ;
string test2 = "me.aspx" ;

test1.EndsWith(".asp") // true;
test2.EndsWith(".asp") // false ; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T13:10:23.297

试试这个

```
^((?!\.asp$).)*$ 
```

# asp.net - 跨项目分布 ASP.NET 用户控件的技术

> ID：323702
> 
> 赞同：4
> 
> 时间：2008-11-27T13:01:59.117
> 
> 标签：asp.net, user-controls

当您想要创建可供不同项目使用的控件库时，跨不同项目分布 ASP.NET 用户控件非常有用。

不幸的是，据我所知，ASP.NET（至少 2.0）并不能非常干净地支持这一点。

我所知道的唯一技术是将控件添加到另一个项目，然后将 ascx（并且只有 ascx，除非您当然要扩展控件）文件复制到引用该控件的项目中，然后从中删除 CodeBehind 引用它。

它有效，但感觉很hackish。

有谁知道跨项目拆分控件的更好方法？（也许 3.5 有帮助？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T13:35:23.433

您可以查看 Scott Guthrie 的这篇文章：

[使用 VS 2005 构建可重用的 ASP.NET 用户控件和页面库](http://weblogs.asp.net/scottgu/archive/2005/08/28/423888.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T13:29:11.650

看看这个：[如何使用 Visual C# .NET 在应用程序之间共享 ASP.NET 页面和用户控件](http://support.microsoft.com/kb/324785)

您可以在 Google 上找到类似的其他资源。

# .net - “不能在 DateTime 上调用方法”和其他限制

> ID：323704
> 
> 赞同：8
> 
> 时间：2008-11-27T13:02:18.070
> 
> 标签：.net, sql, linq, linq-to-sql

有谁知道在编译时没有被捕获的 LINQ to SQL 查询限制的最终列表，以及（在可能的情况下）限制的解决方法？

到目前为止，我们的清单是：

*   调用`.Date`on 等方法`DateTime`
    *   未找到解决方法
*   `string.IsNullOrEmpty`
    *   简单，只需`== ""`使用
*   `.Last()`
    *   我们用了`.OrderByDescending(x => x.WhateverProperty).First()`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-27T10:49:32.463

基本上，这个列表是巨大的......它是处理的相对较小的一组事情之外[**的**](http://msdn.microsoft.com/en-us/library/bb386970.aspx)[所有](http://msdn.microsoft.com/en-us/library/bb386970.aspx)[内容](http://msdn.microsoft.com/en-us/library/bb386970.aspx)**。不幸的是，[泄漏抽象定律](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)开始生效，每个提供者都有不同的答案......**

 **LINQ-to-Objects 可以做任何事情（几乎），因为它是委托；LINQ-to-SQL 和实体框架具有**不同**的支持集。

一般来说，我在使用`DateTime`属性等方面取得了相当大的成功——但实际上，你必须确保你的查询表达式被单元测试覆盖，这样如果你改变提供者（或提供者得到更新）你知道这一切仍然有效。

我想一种观点是从 TSQL 的角度来思考；没有`BOTTOM n`，但有一个`TOP 1`（重新`OrderByDescending`）；就 而言`string.IsNullOrEmpty`，您可能非常直截了当`foo.Bar == null || foo.Bar == ""`：和你一起，`DateTime.Date`你可能可以用`DATEPART`/各种组件做很多事情。

LINQ-to-SQL 的另一个选项是将逻辑封装在 UDF 中 - 因此您可以编写一个接受 a`datetime`并返回 a的 UDF，`datetime`并通过 dbml 将其公开到数据上下文中。然后，您可以在查询中使用它：

```
where ctx.Date(foo.SomeDate) == DateTime.Today 
```

然而，这种方法不一定能很好地利用索引。

* * *

更新：

*   支持的方法翻译等在[这里](http://msdn.microsoft.com/en-us/library/bb386970.aspx)。
*   支持的查询操作等在[这里](http://msdn.microsoft.com/en-us/library/bb399342.aspx)。

有关完整的血腥细节，您可以查看`System.Data.Linq.SqlClient.PostBindDotNetConverter+Visitor`反射器 - 特别是`Translate...`方法；有些`string`功能是分开处理的。所以不是一个*巨大*的选择 - 但这是一个实现细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T16:09:51.223

LINQ 是语言。LINQ-to-SQL 将您的 LINQ 命令编译为 SQL 查询。因此，它受到 TSQL 语法的正常限制，或者更确切地说是可以轻松转换成它的项目的限制。

正如其他人所说，你不能做的事情的清单将是巨大的。这是您可以做的事情的一个小得多的列表。一般的经验法则是尝试确定您要使用的函数如何转换为 TSQL。如果您很难弄清楚，那么不要使用该功能（或至少先测试它）。

但是有一个简单的解决方法来使用不在 LINQ-to-SQL 中的 LINQ 命令。将代码的纯 LINQ 部分与 LINQ-to-SQL 部分分开。换句话说，使用 LINQ-to-SQL 将数据拉入（使用 LINQ-to_SQL 中提供的任何您需要的函数），并使用命令将其放入对象（ToEnumerable、ToList 或其他类似对象）。这将执行查询并将数据拉到本地。现在它可用于完整的 LINQ 语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T17:49:10.737

我为 String.IsNullOrEmpty() 创建了一个连接问题：

[反馈：我想在 LINQ to SQL 语句中使用 string.IsNullOrEmpty。](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=367077)

随意添加您的声音或投票，或为在 Linq to SQL 中不起作用的各种其他方法创建其他连接问题。吱吱作响的轮子得到油脂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T12:41:39.897

我确实遇到了 DateTimes 的这个问题，并且发现目前以下解决方法对我有用，但我意识到对于更大的结果集，它可能会成为一个问题，因为处理现在在我的应用程序中而不是在数据库中：

```
BlogPosts post = (from blogs in blogPosts
           where blogs.PostPath == path 
           select blogs)
           .ToList()
           .Where(blogs => blogs.Published.Date == publishedDate.Date)
           .SingleOrDefault(); 
```

请注意中间的“.ToList()” - 这会将其转换为普通的 IEnumerable，并允许我使用我期望的常用属性。

然而，仍然让我感到困惑的一件事是，这在 EF 中是合法的：

```
BlogPosts posts = from blogs in blogPosts
           where !blogs.IsDraft
             && blogs.Published.Year == year
             && blogs.Published.Month == month
           orderby blogs.Published descending
           select blogs 
```

所以，我可以在 DateTime 上调用“.Year”或“.Month”，但不能调用“.Date”——我想它归结为类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T17:43:52.837

Marc Gravell 的回答是完全正确的。

我只是想为日期逻辑（和字符串比较）添加这个细节。由于您使用的是 LinqToSql，因此您可以利用[SqlMethods](http://msdn.microsoft.com/en-us/library/system.data.linq.sqlclient.sqlmethods_members.aspx)来执行您习惯在数据库中执行的操作。

# c# - ASP.Net：将新文件部署到服务器时用户被注销

> ID：323710
> 
> 赞同：1
> 
> 时间：2008-11-27T13:05:40.060
> 
> 标签：c#, asp.net, session, iis, application-pool

每次我将文件上传到我的 ASP.NET 站点时，所有用户都会注销（也就是我猜他们的会话会失效）。

有没有办法“热交换” ASP.NET 中的代码，这样就不会发生这种情况？在部署之前编译等。

通过 SVN 更新，我的部署方法非常简单。

谢谢！/尼尔斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T13:10:09.927

您可以将会话存储在[SQL 数据库](http://msdn.microsoft.com/en-us/library/ms229862(VS.80).aspx)中，因此应用程序重新启动不会丢失您的会话。

部署预编译的不可更新代码将使您的 xcopy 更快，但仍会重新启动应用程序池。

更新：@configurator，让任何临时观察者都能看到您的评论 [http://support.microsoft.com/kb/317604](http://support.microsoft.com/kb/317604)

（有很多关于不同选项和操作方法的报道，例如，不止一个会话数据库、同一数据库中的不同框架数据库等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T13:08:52.597

如果您将文件部署到 bin 文件夹或 web.config，这将出于很好的理由自动重置站点。

# sql - sql查询导致错误2950

> ID：323711
> 
> 赞同：0
> 
> 时间：2008-11-27T13:05:50.667
> 
> 标签：sql, ms-access, macros

此 SQL 查询由 Microsoft Access 2003 生成，运行时运行良好，但尝试从宏运行时失败。查询中是否有任何明显的错误，或者任何原因它不起作用？

```
SELECT tblAuction.article_no, tblAuction.article_name, tblAuction.subtitle, tblAuction.current_bid, tblAuction.start_price, tblAuction.bid_count, tblAuction.quant_total, tblAuction.quant_sold, tblAuction.start, tblAuction.ends, tblAuction.origin_end, tblUser.user_name, tblAuction.best_bidder_id, tblAuction.finished, tblAuction.watch, tblAuction.buyitnow_price, tblAuction.pic_url, tblAuction.private_auction, tblAuction.auction_type, tblAuction.insert_date, tblAuction.update_date, tblAuction.cat_1_id, tblAuction.cat_2_id, tblAuction.article_desc, tblAuction.countrycode, tblAuction.location, tblAuction.condition, tblAuction.revised, tblAuction.paypal_accept, tblAuction.pre_terminated, tblAuction.shipping_to, tblAuction.fee_insertion, tblAuction.fee_final, tblAuction.fee_listing, tblAuction.pic_xxl, tblAuction.pic_diashow, tblAuction.pic_count, tblAuction.item_site_id
FROM tblUser INNER JOIN tblAuction ON tblUser.id = tblAuction.seller_id; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-27T13:53:56.577

您的意思是来自 Access 宏还是来自 VBScript 或来自 VBA？如果您有一个正在调用操作的宏，那么我的建议是将其转换为 VBA 语句。我假设当您说运行时它运行良好时，您的意思是作为 Access 查询运行。您不指定数据库是本地数据库还是远程数据库（即 SQL Server）。假设它是本地的，那么从 VBA 运行该 SQL 语句必须有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T15:29:40.003

[本文](http://support.microsoft.com/kb/931407)适用于 Access 2007，但也许您也遇到过这种情况。

您在 Access 中使用的安全级别是什么？（打开一个 MDB，然后转到 Tools\Macro\Security...）。尝试降低安全级别，看看是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-28T12:14:25.267

我注意到您使用 INSERT 和 UPDATE 等关键字作为字段名称的一部分。这样的词在通过宏发送时可能会被分析为 SQL 指令，从而导致错误。

你能试着把它们放在[括号]之间吗？无论如何，最好更改字段名称。

# project-planning - Warning signs to look for in a potential customer?

> ID：323738
> 
> 赞同：8
> 
> 时间：2008-11-27T13:15:31.180
> 
> 标签：project-planning

I have seen a few questions about how to interview potential employees and employers, but this is something fairly important that I've come across in the past and I'm sure a lot of other users here will have too:

If you are running a small development company, consultancy or working freelance, what are the warning signs you look for in a potential client? There must be some things that are indicators that a customer will require a lot of supervision, demand a lot of your time and perhaps need you to adjust your charging model accordingly- what are these in your experience and how do you handle them?

What are the red-flags that indicate to you that a customer is going to simply be too much trouble to work with at all? Where do you set the threshold for this decision?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T13:23:04.970

Look for how much detail they know about their project, and how much they want to talk about it. If they seem focused on the details, they may drive you crazy by trying to micro-manage your work. If they don't seem to know much about the details, then they (the customer) may be in over their heads as they don't know the scope of the project. A good customer will know the details when asked, but won't want to drone on about them excessively.

Oh, a quick way to make the customer choose their billing model: when explaining to them what your contract includes (working with them for requirements, development, testing, etc) add a note that this includes *x* hours of phone and e-mail communication, where x is some function of the size of the project based on experience. Add that additional time will cost $250 per hour in 30 minute increments. That will discourage them from contacting you for every trivial question, and to put together lists of things to talk to you, which makes contact more efficient. Assuming your value for x is reasonable, a low-maintenance customer will have no problem with it, so you can remove that clause from the contract, since it's irrelevant. A high maintenance customer will want to know why it's so little, what if it's just a teeny question, etc.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T13:22:44.597

Any of these:

*   They don't have a clear idea of what they are trying to achieve
*   They try to dictate a technical solution to you before you have even examined the requirements / They don't seem interested in your opinion as the consultant
*   They agressively haggle over price
*   If doing any kind of graphical front-end, they ask for spec-work in advance of any kind of agreement

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T13:28:37.813

I've been working as a contractor for a few years, and [this posting](https://stackoverflow.com/questions/242996/dealbreakers-for-new-programming-jobs#243455) shows a few specific instances of reasons I've walked away from jobs. What I want to see in a contract engagement:

*   A strong business sponsor with genuine commitment to the project and the clout to remove obstacles.

*   Evidence of adequate funding and support within the organisation for the project.

*   A line manager who won't drop you in it or interfere in your work to cover their own arse. This is a particular problem as you tend to be reporting directly to people on the first rung of the management ladder who don't really have much clout. For this reason the first point about a strong business sponsor is quite important.

*   Evidence that the project does not have powerful enemies within the organisation.

Edit:

*   For the first point, asking who the businss sponsor is and where they live in the organisation is a good start.

*   For the second point, ask for a reasonable market rate and if they quibble, it's a bit of a sign that someone's trying to do it on the cheap.

*   For the third point, the line manager's approach is often apparent from the way the conduct interviews.

*   For the fourth point, ask who might block the project and look for any hesitation in the response.

These are not hard and fast rules, but heuristics.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T13:24:31.193

We recently had an "experience" with a customer so straight off the bat:

1.  Did you underbid? If so, it's quite likely that you wouldn't be able to meet the customer's expectations within your budget and profit margin constraints, and it's going to cause problems.
2.  Other vendors' experiences. What experiences do other vendors have working with this customer? Also, are you replacing another vendor, if so, why? Could the same reasons apply for replacing you?
3.  Are the requirements vague? (Of course they are) I mean do they keep changing all the time? were you forced to sign off the requirements in a hurry?
4.  Do you have the backing and buy-in of the best people in your company to make this work? They may not be directly involved with working for this project but they should have some stake in making it work out with this customer.
5.  New country? Cultural issues could kill you despite your best intentions. Think of having local partners or go betweens, if not an option, at least familiarize yourself with the local language and customs.

# iphone - native iPhone database, all data on iPhone

> ID：323739
> 
> 赞同：10
> 
> 时间：2008-11-27T13:15:58.463
> 
> 标签：iphone, database, cocoa-touch

Is it possible to make a big 50MB database native on the iPhone? So that it can be searched very quickly in a smart way? With SQlite?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T15:11:07.950

是的，您可以在 iPhone 上使用 SQLite。由于数据库只是一个文件，您可以将 50 MB 的文件添加到您的应用程序中，仅此而已。根据我的经验，SQLite 在 iPhone 上的性能很好，尽管 YMMV 取决于您的确切表布局和索引。

在我看来，绝对值得一试 Galwegian 建议的 FMDB 包装器；它使编程比直接使用 SQLite 库本身要容易得多。

虽然 50 MB 远低于限制，但请注意，下载 50 MB 的应用程序需要一些时间，而且人们无法在没有 WiFi 连接或 iTunes 的情况下从 AppStore 安装它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-27T16:55:01.390

SQLite 是 iPhone 上可用的受支持 API 的一部分。

此外，50MB 并不是真正的“大型”数据库。SQLite 会毫不犹豫地处理它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-27T13:23:29.930

There's some talk to a [SQLite for iPhone SDK](http://blog.saers.com/archives/2008/03/14/sqlite-for-iphone-sdk/) in this article. It uses [FMDB](http://gusmueller.com/blog/archives/2008/03/fmdb_for_iphone.html), which is a cocoa wrapper fro SQLite3

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T22:52:58.483

一定要使用 SQLite。我觉得它很容易使用。如果您需要一些示例代码，请查看[http://tetontech.wordpress.com/2008/06/28/iphone-objective-c-sqlite-development/](http://tetontech.wordpress.com/2008/06/28/iphone-objective-c-sqlite-development/)

如果您想要一个易于使用的包装器，请查看 QuickConnectiPhone。这个框架有一个你可以拉出来使用的包装器。

[https://sourceforge.net/projects/quickconnect/](https://sourceforge.net/projects/quickconnect/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-26T08:20:14.567

我知道 OP 可能早就找到了他们的解决方案，但我想我会添加（为了任何从谷歌搜索登陆这里的人）我们的数据库 SDK，RDM Embedded，来自 Raima，作为另一种可能的解决方案。

据我所知，它是 iPhone 上唯一可以替代 SQLite 的本地数据库（不是包装器），也是唯一同时支持网络和关系数据库模型的数据库。

我们在[raima.com/iphone上有一些信息](http://www.raima.com/iphone "适用于 iPhone 的 RDM 嵌入式")

# asp.net - 如果我将 ANSI 编码文件转换为 UTF-8，会出现什么问题？

> ID：323741
> 
> 赞同：0
> 
> 时间：2008-11-27T13:17:01.237
> 
> 标签：asp.net, tfs, utf-8, ansi

我有一个现有的 ASP.NET 2.0 网站，存储在 Team Foundation Server 2005 中。一些页面/控件被编码为 ANSI（根据 Notepad++），并且 Content-Type 标头设置为：

```
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252"/> 
```

我想将所有页面更改为 UTF-8，因此 Content-Type 标头更改为：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/> 
```

除了更改元元素之外，我认为我还需要更改所有文件的编码。我可以在 Notepad++ 中做到这一点，但如果有人有更快的方法，请提及。

**在 TFS 中进行合并/比较时，我可能会遇到哪些问题？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T13:23:49.493

这取决于代码库中的文本有多少使用了 ASCII 范围 0..127 之外的字符。

你可能想先扫描一下，看看它会产生多大的影响。如果您的代码库主要是英语，那么您可能不必担心太多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T13:24:02.520

我会写一个 Python 脚本

```
for fn in os.listdir(srcdir):
    data = open(srcdir+"\\"+fn, "rb").read().decode("windows-1252")
    data = data.replace("charset=windows-1252", "charset=utf-8")
    open(srcdir+"\\"+fn, "wb").write(data.encode("utf-8")) 
```

字符集的更新假定此特定字符串不会出现在其他地方；您可以通过检查更长的字符串、检查文件中是否确实存在旧文本、进行适当的 XML 解析等来使其更加健壮。

您可能需要在 UTF-8 编码的数据前面放置一个 UTF-8 签名；你在 codecs.BOM_UTF8 中找到一个

我不知道这种变化对 TFS 有什么影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:29:37.983

我刚刚发现的一些有用的东西是您可以右键单击源代码管理资源管理器中的文件，然后选择属性。然后，就 TFS 而言，您可以查看/修改编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T13:37:40.883

选择一个字符在 0-127 ASCII 范围以上的文件。用记事本打开它，选择另存为并选择 UTF-8 作为编码。然后看字符是否转换成功。

要自动化该过程，您可以编写一个应用程序，将所有文件从 ASCII 转换为 UTF-8，使用 1252 作为代码页。如果您没有超过 127 个字符，则无需担心所有这些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T13:49:07.633

这不一定是真的。我不了解 ASP.net，但我们在 Ansi 中进行所有 php 编码，并以 UTF8 提供页面。我们所有的数据库信息也都以 UTF8 格式存储。

# .net - Drawing stuff on winform, Format32bppRgb or Format24bppRgb or something else?

> ID：323742
> 
> 赞同：1
> 
> 时间：2008-11-27T13:17:20.177
> 
> 标签：.net, drawing, pixel

Which one would you use to draw stuff on a winform? Format32bppRgb or Format24bppRgb or something else?

[in any .net version](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.pixelformat.aspx)

```
Format24bppRgb
Specifies that the format is 24 bits per pixel; 8 bits each are used for the red, green, and blue components.

Format32bppRgb
Specifies that the format is 32 bits per pixel; 8 bits each are used for the red, green, and blue components. The remaining 8 bits are not used. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-27T14:14:41.370

据我所知，由于文档的原因，如果您要在这两者之间进行选择，那么选择 32 是没有意义的。但是，我的直觉告诉我，如果您只为桌面应用程序构建，并且您想要为具有 32 位颜色的人获得最佳颜色范围，我将使用`Format32bppArgb`或`Format32bppPArgb`，根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.pixelformat.aspx)，这些将为颜色存储提供更多位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T17:27:27.047

正如您从文档中引用的那样， Format32bppRgb 将使用相同的每像素 24 位，并且不使用其他 8 位，那么如果 Format32bppRgb 只浪费位，为什么还要使用它。它可能仅出于兼容性原因而存在。Format32bpp然而，RGB*确实***将**额外的 8 位用于 Alpha 通道。因此，在这些选择之间，如果您需要 Alpha 通道，则应使用 Format32bppArgb，否则应使用 Format24bppRgb。

 *您是否使用位图在 WinForm 中绘制一些东西？如果您使用 Graphics 在 Bitmap 上绘制只是为了显示 Bitmap，您还不如使用 Graphics 直接绘制到控件中。您可以使用`Graphics.From(control.Handle)`.

# asp.net - Loading ASP.NET User Controls By Type And Passing Parameters?

> ID：323745
> 
> 赞同：1
> 
> 时间：2008-11-27T13:18:48.427
> 
> 标签：asp.net, user-controls

> **Possible Duplicate:**
> [Asp.net Usercontrol LoadControl Issue](https://stackoverflow.com/questions/240850/asp-net-usercontrol-loadcontrol-issue)

In ASP.NET 2.0 it is my understanding that although the API existed for loading a user control by type, it didn't actually work.

Or at least I never managed to get it to work, and I know from blogs that others have had similar issues.

So I use a wrapper type that provides the functionality I need, invoking the relevant control constructor using reflection.

Has ASP.NET 3.5 made the loading of user controls by type and passing in parameters any easier?

Edit:

Further clarification....

There are two overloads for the TemplateControl.LoadControl method:

```
Control TemplateControl.LoadControl(Type t, object[] params) and,

Control TemplateControl.LoadControl(string virtualPath) 
```

My question is; in ASP.NET 2.0 the first overload didn't seem to work. Does anyone know if this method truly didn't work, and if so has it been fixed in ASP.NET 3.5.

I'll be testing this myself tomorrow, and will update the question with the answer if noone else knows.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-01T15:04:25.250

回答我自己的问题：

在这里回答：[Asp.net Usercontrol LoadControl 问题](https://stackoverflow.com/questions/240850/aspnet-usercontrol-loadcontrol-issue)

# python - How to access the previous/next element in a for loop?

> ID：323750
> 
> 赞同：50
> 
> 时间：2008-11-27T13:22:19.323
> 
> 标签：python, for-loop

Is there a way to access a `list`'s (or `tuple`'s, or other iterable's) next or previous element while looping through it with a `for` loop?

```
l = [1, 2, 3]
for item in l:
    if item == 2:
        get_previous(l, item) 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-11-27T14:28:23.527

表示为生成器函数：

```
def neighborhood(iterable):
    iterator = iter(iterable)
    prev_item = None
    current_item = next(iterator)  # throws StopIteration if empty.
    for next_item in iterator:
        yield (prev_item, current_item, next_item)
        prev_item = current_item
        current_item = next_item
    yield (prev_item, current_item, None) 
```

用法：

```
for prev,item,next in neighborhood(l):
    print prev, item, next 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-05-08T01:10:28.057

```
l = [1, 2, 3]

for i, j in zip(l, l[1:]):
    print(i, j) 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-27T17:15:38.353

```
l = [1, 2, 3]
for i, item in enumerate(l):
    if item == 2:
        previous = l[i - 1]
        print(previous) 
```

输出：

```
1 
```

如果您要查找的项目是列表中的第一项，这将环绕并返回列表中的最后一项。换句话说`if item == 1:`，将上面代码中的第三行更改为将导致它打印`3`。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-27T14:29:16.303

在处理需要一些上下文的生成器时，我经常使用以下实用函数在迭代器上提供滑动窗口视图：

```
import collections, itertools

def window(it, winsize, step=1):
    """Sliding window iterator."""
    it=iter(it)  # Ensure we have an iterator
    l=collections.deque(itertools.islice(it, winsize))
    while 1:  # Continue till StopIteration gets raised.
        yield tuple(l)
        for i in range(step):
            l.append(it.next())
            l.popleft() 
```

它将一次生成一个序列 N 项的视图，并移动步骤。例如。

```
>>> list(window([1,2,3,4,5],3))
[(1, 2, 3), (2, 3, 4), (3, 4, 5)] 
```

当在前瞻/后向情况下使用时，您还需要处理没有下一个或前一个值的数字，您可能希望用适当的值填充序列，例如无。

```
l= range(10)
# Print adjacent numbers
for cur, next in window(l + [None] ,2):
    if next is None: print "%d is the last number." % cur
    else: print "%d is followed by %d" % (cur,next) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-02-26T01:40:44.207

我知道这是旧的，但为什么不直接使用`enumerate`？

```
l = ['adam', 'rick', 'morty', 'adam', 'billy', 'bob', 'wally', 'bob', 'jerry']

for i, item in enumerate(l):
    if i == 0:
        previous_item = None
    else:
        previous_item = l[i - 1]

    if i == len(l) - 1:
        next_item = None
    else:
        next_item = l[i + 1]

    print('Previous Item:', previous_item)
    print('Item:', item)
    print('Next Item:', next_item)
    print('')

    pass 
```

如果你运行它，你会看到它抓取了上一个和下一个项目，而不关心列表中的重复项目。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-28T14:21:20.083

查看[Tempita 项目](http://pythonpaste.org/tempita/#bunch-and-looper)中的 looper 实用程序。它为您提供了一个围绕循环项目的包装对象，该对象提供诸如上一个、下一个、第一个、最后一个等属性。

看一下looper类的[源代码](http://svn.pythonpaste.org/Tempita/trunk/tempita/_looper.py)，很简单。还有其他这样的循环助手，但我现在不记得其他任何人了。

例子：

```
> easy_install Tempita
> python
>>> from tempita import looper
>>> for loop, i in looper([1, 2, 3]):
...     print loop.previous, loop.item, loop.index, loop.next, loop.first, loop.last, loop.length, loop.odd, loop.even
... 
None 1 0 2 True False 3 True 0
1 2 1 3 False False 3 False 1
2 3 2 None False True 3 True 0 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-12-08T19:07:10.310

如果您希望解决方案适用于可迭代对象，则[`itertools`文档](https://docs.python.org/library/itertools.html#itertools-recipes)中有一个配方可以完全按照您的要求使用[`itertools.tee()`](https://docs.python.org/library/itertools.html#itertools.tee)：

```
import itertools

def pairwise(iterable):
    "s -> (s0,s1), (s1,s2), (s2, s3), ..."
    a, b = itertools.tee(iterable)
    next(b, None)
    return zip(a, b) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-27T13:55:31.177

我不认为有一个简单的方法，特别是因为一个可迭代的可以是一个[生成器](https://docs.python.org/library/stdtypes.html#generator-types)（没有回头路）。您可以通过将元素的索引传递到循环体中来使用[序列：](https://docs.python.org/library/stdtypes.html#sequence-types-list-tuple-range)

```
for index, item in enumerate(l):
    if index > 0:
        previous_item = l[index - 1]
    else:
        previous_item = None 
```

该[`enumerate()`](https://docs.python.org/library/functions.html#enumerate)函数是内置函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-27T15:46:17.753

直接上一个？

你的意思是下面的，对吧？

```
previous = None
for item in someList:
    if item == target: break
    previous = item
# previous is the item before the target 
```

如果你想要*n 个*先前的项目，你可以使用一种大小为*n*的循环队列来做到这一点。

```
queue = []
for item in someList:
    if item == target: break
    queue .append( item )
    if len(queue ) > n: queue .pop(0)
if len(queue ) < n: previous = None
previous = previous[0]
# previous is *n* before the target 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-10-26T20:36:45.500

如果您不想导入任何内容，这里是使用 for 循环访问生成器的前一项的示例。它使用类变量在下一次调用之前存储每个下一个结果。如果您想要的不仅仅是前一个项目，这个变量可能是一个小列表。类内部是一个方法生成器，它有效地扩展了 next() 内置函数以包含前一个项目分配。

代码（Python 3.10）：

```
def previous():
    class Plusprev():
        def __init__(pp, gen=None):
            pp.g = gen
            pp.nxt = ''
            pp.prev = 'start'

        def ppnext(pp):
            while pp.nxt != 'done':
                pp.nxt = next(pp.g,'done')
                yield pp.nxt
                pp.prev = pp.nxt

    sqgen = (n*n for n in range(13))
    ppcl = Plusprev(sqgen)
    nxtg = ppcl.ppnext()
    nxt = next(nxtg,'done')
    while nxt != 'done':
        print('\nprevious ',ppcl.prev)
        print('current ',nxt)
        nxt = next(nxtg,'done')

previous() 
```

这使用内置函数 next()，默认参数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-10-15T12:12:36.207

对于升级到 python 3.10 的任何人，此类功能直接添加到 [itertools](https://docs.python.org/3/library/itertools.html#itertools.pairwise)

```
import itertools

l = [1,2,3]
for x, y in itertools.pairwise(l):
    print(x, y)
# 1 2
# 2 3 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-04-01T05:34:11.057

我知道这是一个老问题，但我发现展示一个简单的解决方案很重要，它也适用于生成器和其他类型的可迭代对象，而不像大多数只适用于列表类对象的答案。这有点类似于布赖恩的回答和这里的解决方案：[https ://www.programcreek.com/python/example/1754/itertools.tee](https://www.programcreek.com/python/example/1754/itertools.tee)

```
import itertools

iter0, iter1 = itertools.tee(iterable)

for item, next_item in itertools.zip_longest(
    iter0,
    itertools.islice(iter1, 1, None)
):

    do_something(item, next_item) 
```

或者，调用`next`第二个可迭代对象（如果您确定它至少有一个元素）：

```
import itertools

iter0, iter1 = itertools.tee(iterable)
_ = next(iter1)

for item, next_item in itertools.zip_longest(iter0, iter1):

    do_something(item, next_item) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-27T13:39:28.650

迭代器只有 next() 方法，所以你不能向前或向后看，你只能得到下一项。

如果您正在迭代列表或元组，则 enumerate(iterable) 可能很有用。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2011-01-12T18:50:54.037

不是很pythonic，但可以完成并且很简单：

```
l=[1,2,3]
for index in range(len(l)):
    if l[index]==2:
        l[index-1] 
```

TO DO：保护边缘

* * *

## 回答 #15

> 赞同：-7
> 
> 时间：2008-11-27T13:41:17.007

最简单的方法是在列表中搜索项目：

```
def get_previous(l, item):
    idx = l.find(item)
    return None if idx == 0 else l[idx-1] 
```

当然，这仅适用于列表仅包含唯一项目的情况。另一个解决方案是：

```
for idx in range(len(l)):
    item = l[idx]
    if item == 2:
        l[idx-1] 
```

# database - 跨多个项目记住已读/未读状态的最有效方法是什么？

> ID：323758
> 
> 赞同：2
> 
> 时间：2008-11-27T13:23:55.920
> 
> 标签：database, read-unread

例如，让我们采用论坛的格式，我们有多个用户和多个线程。假设这个论坛想要跟踪哪些用户已经阅读了哪些主题，并且在查看主题列表时使用该信息来标记哪些主题未读。

我能想象的唯一解决方案是每次用户访问线程时将记录放入数据库中。我想可能有一个“全部标记为已读”按钮，它可以使用时间戳来帮助减少数据库中的蔓延……尽管这不是一个让我印象深刻的解决方案。

我有一种感觉，我在这里遗漏了一些东西......也许感恩节早上不是考虑一个人的编程问题的时候。

有没有更好的解决方案呢？有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T13:31:12.740

对我来说，使用数据库记录听起来最有希望。如果您有一个活跃的论坛，它将非常快速地生成一个包含数百万行的表，但这将是最简单的实现解决方案。它将为查询哪些用户也在阅读什么内容提供了很大的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T13:28:02.307

1.  在数据库中为每个用户线程组合删除一条记录
2.  或者将此信息存储在一个文件中 - 每个用户一个文件。如果允许同一用户多次登录，可能需要锁定/解锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:34:38.410

我想我在某个地方看到了，也许是phpbb论坛？反正

其中有一个表，其中包含用户 ID、线程 ID、上次读取日期时间（将其命名为 userAsRead）

然后它将比较在该线程 ID 中发布的最后一篇文章与 last-read-datetime

对于标记为全部已读，它是用户表中的一个字段，使用与上述相同的逻辑

如果使用“标记为全部已读”，请不要忘记清除 userAsRead，这样可以节省数据库空间

# python - 在Django中从一个应用程序到另一个应用程序的外键

> ID：323763
> 
> 赞同：115
> 
> 时间：2008-11-27T13:24:45.263
> 
> 标签：python, django, django-models

我想知道是否可以在 Django 的 models.py 文件中定义一个外键，它是对另一个应用程序中表的引用？

换句话说，我有两个应用程序，称为 cf 和配置文件，在 cf/models.py 我有（除其他外）：

```
class Movie(models.Model):
    title = models.CharField(max_length=255) 
```

在profiles/models.py中我想要：

```
class MovieProperty(models.Model):
    movie = models.ForeignKey(Movie) 
```

但我无法让它工作。我试过了：

```
 movie = models.ForeignKey(cf.Movie) 
```

我已经尝试在models.py的开头导入cf.Movie，但我总是得到错误，例如：

```
NameError: name 'User' is not defined 
```

我是否通过尝试以这种方式将两个应用程序绑定在一起而违反了规则，或者我只是语法错误？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2008-11-27T14:27:45.400

根据文档，您的第二次尝试应该有效：

> 要引用另一个应用程序中定义的模型，您必须改为显式指定应用程序标签。例如，如果上面的制造商模型是在另一个名为 production 的应用程序中定义的，您需要使用：

```
class Car(models.Model):
    manufacturer = models.ForeignKey('production.Manufacturer') 
```

你试过把它放在引号里吗？

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2015-09-30T15:09:36.443

也可以传递类本身：

```
from django.db import models
from production import models as production_models

class Car(models.Model):
    manufacturer = models.ForeignKey(production_models.Manufacturer) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-27T14:26:28.103

好的 - 我已经想通了。你可以做到，你只需要使用正确的`import`语法。正确的语法是：

```
from prototype.cf.models import Movie 
```

我的错误是没有指定该`.models`行的一部分。哦！

# algorithm - 视觉解释的来源？

> ID：323769
> 
> 赞同：3
> 
> 时间：2008-11-27T13:28:33.460
> 
> 标签：algorithm, graphics, visualization, diagrams

有没有人有对算法（或数学）进行视觉解释的资源，这些解释更具表现力，更直观，也许在美学上更有吸引力？或者，算法的动画？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:15:14.303

这是[排序算法](http://vision.bc.edu/~dmartin/teaching/sorting/anim-html/all.html "排序算法")的一个。它提供了一些不错的动画，以了解每种类型在整个过程中的工作方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T14:17:16.123

开始讨论。

我喜欢向非技术人员展示的**[数据库/事务死锁。](http://www.codeproject.com/KB/database/Deadlocks4Dummy.aspx)**

**[在Relevant Algorithm Animations/Visualizations](http://www.ansatt.hig.no/frodeh/algmet/animate.html)**页面上你也有很多不错的动画

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T10:14:09.167

[Animal](http://www.algoanim.info/Animal2/)是一款算法动画的跨平台动画工具。

网站的[动画存储库](http://www.algoanim.info/Animal2/?q=node/268)中提供了许多常用算法和数据结构的动画脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T14:17:21.100

谷歌搜索 [插入算法名称] 和“小程序”。许多学者和其他类似的人已经制作了 java 小程序来演示算法的工作原理。您可能可以找到几乎任何已发布算法的示例。

# c++ - 如何使 CListCtrl 保持其滚动条？

> ID：323774
> 
> 赞同：0
> 
> 时间：2008-11-27T13:30:01.850
> 
> 标签：c++, mfc

在 MFC 中，CListBox 具有“禁用无滚动”属性。当您将其设置为 true 时，无论您有多少项目，垂直滚动条始终存在。如何使用 CListCtrl 做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T14:16:24.597

标准控件似乎不支持您想要的行为。

您可以创建足够的条目以使滚动条可见，也可以创建自己的控件以您喜欢的方式实现它。介于两者之间的是 ownerdrawn 样式，但这不适用于滚动条。

顺便说一句：无论如何，让滚动条在列表控件中始终可见的原因是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-28T00:31:07.803

鉴于您正试图拥有一个漂亮的报表视图，其中列的大小恰好适合 - 没有水平滚动，也没有丑陋的灰色条代替滚动。

您可以从报告视图的内存中添加最后一列，该列将填充其余空间且无法调整大小。目前我似乎无法在 MSDN 中找到合适的代码，模糊地记得该列的大小为 -1。

如果您在哪里继续调整列的大小，那么我会在以下情况下这样做： - 应用程序完成向报告添加/删除一组新项目 - 用户调整报告窗口的大小

还要考虑一下，为什么不让用户将列的大小调整为他们想要的？

# .net - Typed DataSets with XML data sources and schemas

> ID：323778
> 
> 赞同：1
> 
> 时间：2008-11-27T13:31:11.663
> 
> 标签：.net, xml, schema, dataset

I've written an XML Schema file by hand (not using the DataSet Designer in VS) and a corresponding XML file containing structured data to be read in.

I ran the xsd.exe program to generate a `Typed DataSet` class; on the whole it looks fine to begin with (ignoring how it uses lowercase for public class members), but when it comes to using the generated class nothing happens:

```
MyDataSet set = new MyDataSet();
set.ReadXml( "myData.xml" ); 
```

At this point all of the typed table members of the `MyDataSet` class have a `.Count` of 0.

Strangly enough, I can't get normal `DataSets` to work either:

```
DataSet set = new DataSet();
set.ReadXmlSchema("mySchema.xsd");
set.ReadXml( "myData.xml"); 
```

`set.Tables.Count` returns 7, which is right, but the tables are all empty.

Am I missing something obvious?

UPDATE:

After doing absolutely nothing `set.Tables["extra"].Rows.Count` returns the correct number of rows; but when I use a typed dataset it doesn't work, despite everything else being the same:

```
DataSet ds = new DataSet();
ds.ReadXml( packageExamplePath );

System.Console.WriteLine( ds.Tables["extra"].Rows.Count );

Package st = new Package();
st.ReadXml( packageExamplePath );

System.Console.WriteLine( st.Tables["extra"].Rows.Count ); 
```

...prints this out to console:

> 19
> 
> 0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T21:06:50.700

问题：xsd.exe 中的代码是否正确生成？例如，您可以在代码中使用生成的 DS、创建 DataRows、将它们添加到 DataTables 等吗？

如果是这样，请尝试手动填写 DS，保存 xml，并与您的结构化 xml 数据文件进行比较，以确保它具有相同的结构。

# junit - 使用 junitperf 运行 junit4 测试

> ID：323782
> 
> 赞同：2
> 
> 时间：2008-11-27T13:33:53.450
> 
> 标签：junit, junitperf

可以将 Junitperf 与 junit4 一起使用吗？我有一个带有多个测试的简单 Junit4 测试类，我想对该类的单个测试进行 TimedTest。我怎样才能做到这一点？

更清楚地说，我的 Junit4 课程类似于：

```
public class TestCitta {

    @Test
    public void test1 {}

        @Test
    public void test2 {}
} 
```

使用 junit3 我应该写一些类似的东西：

```
public class TestCittaPerformance {

    public static final long toleranceInMillis = 100;

    public static Test suite() {

        long maxElapsedTimeInMillis = 1000 + toleranceInMillis;

        Test testCase = new TestCitta("test2");

        Test timedTest = new TimedTest(testCase, maxElapsedTimeInMillis);

        return timedTest;
    }

    public static void main(String args[]) {
        junit.textui.TestRunner.run(suite());
    }
} 
```

与 Junit4？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-31T17:22:42.533

我遇到了同样的问题，但试图让它在不同的构建环境中运行并不幸运。所以我使用了自 JUnit 4 以来可用的 @Rule 特性来注入性能测试调用和使用注解的需求检查。结果它变成了一个小型库，在这个项目中取代了 JUnitPerf，我以[contiperf](/questions/tagged/contiperf "显示标记为“contiperf”的问题")的名义发布了它。如果您对这种方法感兴趣，可以在[https://github.com/lucaspouzac/contiperf](https://github.com/lucaspouzac/contiperf)找到它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-11T09:46:31.150

如果你已经有 junit4，为什么不使用 contiperf。它会做你正在寻找的东西和注释。

POM 是这样的。

```
 <dependency>
  <groupId>junit</groupId>
  <artifactId>junit</artifactId>
  <version>4.10</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.databene</groupId>
  <artifactId>contiperf</artifactId>
  <version>2.0.0</version>
  <scope>test</scope>
</dependency> 
```

测试课是这样的

```
public class PersonDAOTest {
@Rule
public ContiPerfRule i = new ContiPerfRule(); 
```

实际测试是这样的

```
@Test
@PerfTest(invocations = 1, threads = 1)
@Required(max = 1200, average = 250)
public void test() { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-23T10:15:23.340

或者您可以使用注释：`@Test(timeout=1000)`

# c++ - Autotools：如何设置全局编译标志

> ID：323790
> 
> 赞同：19
> 
> 时间：2008-11-27T13:36:48.797
> 
> 标签：c++, autotools, autoconf, flags, automake

我有一个包含多个源目录的项目：

```
src/A
   /B
   /C 
```

在每个中，Makefile.am 包含

```
AM_CXXFLAGS = -fPIC -Wall -Wextra 
```

如何避免在每个源文件夹中重复此操作？

我试图修改 src/Makefile.am 和 configure.in，但没有成功。我以为我可以使用 AC_PROG_CXX 全局设置编译标志，但找不到太多关于如何使用这些宏的文档（你有任何指向此类文档的指针吗？）。

提前致谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-28T10:17:32.193

你可以做几件事：

(1) 一种解决方案是在您的所有 s 上包含一个通用的 makefile 片段`Makefile.am`：

```
include $(top_srcdir)/common.mk
...
bin_PROGRAMS = foo
foo_SOURCES = ... 
```

在那种情况下，你会写

```
AM_CXXFLAGS = -fpic -Wall -Wextra 
```

到`common.mk`将来`Makefile.am`，只需编辑此文件，即可更轻松地向所有 s 添加更多宏或规则。

(2) 另一种解决方案是在您的全局设置这些变量`configure.ac`（该名称`configure.in`很久以前已被弃用），如：

```
...
AC_SUBST([AM_CXXFLAGS], [-fpic -Wall -Wextra])
... 
```

然后你甚至不用在你`Makefile.am`的 s 中说什么，它们会自动继承这个全局定义。缺点是您不能轻易选择退出（使用第一个解决方案很容易决定不包含`common.mk`）并且依赖项对第三方人员来说并不是真正明确的（当他们阅读时，`Makefile.am`他们没有关于标志位置的提示可能来自）。

（3）第三种解决方案是按照[orsogufo](https://stackoverflow.com/users/15622/orsogufo)的建议：覆盖用户变量 CXXFLAGS in `configure.ac`。我建议不要这样做，因为它破坏了 GNU 构建系统的一个特性：允许用户在`make`-time 覆盖这个变量。例如，您可能想要输入

```
make CXXFLAGS='-O0 -ggdb' 
```

在调试一段代码时，这将覆盖`CXXFLAGS`（但不会覆盖`AM_CXXFLAGS`）的任何定义。老实说，大多数项目都无法正确支持这一点，因为它们玩弄`CXXFLAGS`.

最后，我应该提到`-fpic`,`-Wall`和`-Werror`不是可移植的选项。根据您项目的范围，您可能希望为这些添加配置检查（[gnulib](http://www.gnu.org/software/gnulib/)最近获得了新的宏来测试警告标志，并且[libtool](http://www.gnu.org/software/libtool/)可用于构建共享库）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-17T12:21:09.803

在 configure.ac 中使用 EXTRA_CFLAGS

例如，对于您的情况，它将是这样的：

`EXTRA_CFLAGS=-fPIC -Wall -Wextra`

# java - 如何为我的 Java 程序生成运行时间图

> ID：323791
> 
> 赞同：1
> 
> 时间：2008-11-27T13:37:01.323
> 
> 标签：java, graph

嗨，我想在我的 java 程序上生成运行时间图。有什么程序可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T13:43:20.967

那么，如果 X 轴是时间，那么 Y 轴需要什么？

如果它的内存，那么你可以使用[jconsole 或 jvisualvm](http://java.sun.com/javase/6/docs/technotes/tools/index.html#monitor)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T13:42:19.067

当您的意思是每个方法需要的时间/总运行时间时，请寻找分析器（例如 Eclipse 插件 TPTP）。或者您的意思是在您的程序本身中显示运行时图表？（你使用的介词“on”让我很难理解，“in”或“for”在我看来会澄清事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T13:39:15.733

看看[jfreechart](http://www.jfree.org/jfreechart/)库。

# c++ - C++ 指针/列表实现

> ID：323816
> 
> 赞同：0
> 
> 时间：2008-11-27T13:50:40.077
> 
> 标签：c++, list, pointers

> 编写一个具有以下属性的类 ListNode：
> 
> *   整数值；
> *   列表节点*下一个；
> 
> 提供以下功能：
> 
> *   ListNode(int v, ListNode *l)
> *   int getValue();
> *   ListNode* getNext();
> *   无效插入（int i）；
> *   布尔列表包含（int j）；
> 
> 编写一个程序，要求用户输入一些整数并将它们存储为 ListNodes，然后询问它应该在列表中查找的数字。

这是我的代码：

```
#include <iostream>
using namespace std;

class ListNode
{
    private:
        struct Node
        {
            int value;
            Node *next;
        } *lnFirst;

    public:
        ListNode();
        int Length();       
        void DisplayList();     
        void Insert( int num );
        bool Contains( int num );       
        int GetValue( int num );        
};

ListNode::ListNode()
{
    lnFirst = NULL;
}

int ListNode::Length()
{
    Node *lnTemp;
    int intCount = 0;
    for( lnTemp=lnFirst ; lnTemp != NULL ; lnTemp = lnTemp->next )
    {
        intCount++;
    }
    return intCount;
}

void ListNode::DisplayList()
{
    Node *lnTemp;
    for( lnTemp = lnFirst ; lnTemp != NULL ; lnTemp = lnTemp->next )
        cout<<endl<<lnTemp->value;
}

void ListNode::Insert(int num)
{
    Node *lnCurrent, *lnNew;

    if( lnFirst == NULL )
    {
        lnFirst = new Node;
        lnFirst->value = num;
        lnFirst->next = NULL;
    }
    else
    {
        lnCurrent = lnFirst;
        while( lnCurrent->next != NULL )
            lnCurrent = lnCurrent->next;

        lnNew = new Node;
        lnNew->value = num;
        lnNew->next = NULL;
        lnCurrent->next = lnNew;
    }
}

bool ListNode::Contains(int num)
{
    bool boolDoesContain = false;
    Node *lnTemp,*lnCurrent;
    lnCurrent = lnFirst;
    lnTemp = lnCurrent;
    while( lnCurrent!=NULL )
    {
        if( lnCurrent->value == num )
        {
            boolDoesContain = true;
            return boolDoesContain;
        }
        lnTemp = lnCurrent;
        lnCurrent = lnCurrent->next;
    }
    return boolDoesContain;
}

int ListNode::GetValue(int num)
{
    Node *lnTemp;
    int intCount = 1;
    for( lnTemp=lnFirst; lnTemp != NULL; lnTemp = lnTemp->next )
    {
        if (intCount == num)
        {
            return lnTemp->value;
        }
        intCount++;
    }    
}

int main()
{   
    cout << "Input integers below. Input the integer -1 to stop inputting.\n\n";

    ListNode lnList;
    int intNode = 1, intInput = 0;
    while (intInput != -1) {
        cout << "Please input integer number " << intNode << ": "; cin >> intInput;
        intNode++;
        if (intInput != -1) { lnList.Insert(intInput); }
    }   

    lnList.DisplayList();
    cout << "\n\n";

    int intListLength = lnList.Length();    
    cout << "Which value do you wish to recall? (Between 1 and " << intListLength << "): "; cin >> intNode;    
    if ( intNode >= 1 && intNode <= intListLength ) {
        cout << "Value at position " << intNode << " is " << lnList.GetValue(intNode) << ".";                
    } else {
        cout << "No such position in the list. Positions run from 1 to " << intListLength << ". You asked for " << intNode << ".";
    }

    cout << "\n\nCheck if the following value is in the list: "; cin >> intNode;
    bool IsThere = lnList.Contains(intNode);
    if (IsThere) {
        cout << intNode << " is in the list.";
    } else {
        cout << intNode << " is not in the list.";
    }

    cout << "\n\n";
    system("pause");
    return 0;  
} 
```

我们在哪里可以改进这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T13:56:45.557

我认为您误解了所要求的设计。ListNode 类应该是一个节点，而不是包含节点的列表。

我建议您不要将多个命令放在一个 ligne 上，如下所示：

```
cout << "Please input integer number " << intNode << ": "; cin >> intInput; 
```

这简直令人困惑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T14:04:56.447

unwind 和 ckarmann 怎么说。这是一个提示，我为您实现了 listcontains 以让您了解分配的含义：

```
class ListNode {
private:
    int value;
    ListNode * next;

public:
    bool listcontains(int v) { 
        // does this node contain the value?
        if(value == v) return true; 

        // was this the last node?
        if(next == 0) return false;

        // return whether nodes after us contain the value 
        return next->listcontains(v);
    }
}; 
```

因此，您只有列表的头部，它依次链接到下一个节点。尾巴会有`next == 0`;

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-27T14:07:08.797

在更一般的样式注释中，声明指针更靠近您将定义它们的位置，并使其范围尽可能小。
虽然您的代码在技术上不会出错，但根据我的经验，始终这样做可以避免更大/更旧的代码库中的错误。

例如，而不是

```
Node *lnTemp;
int intCount = 0;
for( lnTemp=lnFirst ; lnTemp != NULL ; lnTemp = lnTemp->next )
{
} 
```

写

```
int intCount = 0;
for(Node* lnTemp=lnFirst ; lnTemp != NULL ; lnTemp = lnTemp->next )
{
} 
```

或者，类似的，而不是

```
Node *lnTemp,*lnCurrent;
lnCurrent = lnFirst;
lnTemp = lnCurrent; 
```

写

```
Node* lnCurrent = lnFirst;
Node* lnTemp = lnCurrent; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-27T13:53:16.797

我认为您过度设计了列表节点建模。ListNode 类**[是一个](http://en.wikipedia.org/wiki/Isa_(computer_science))**列表节点，从它的名字就可以看出。然后它不应该需要一个嵌套结构来保存列表信息，这是非常令人困惑的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-27T16:47:14.183

在这篇文章的底部有更详细的反馈，但首先，只是一些内联注释和代码中的更改：

```
struct Node // Why doesn't this have a constructor initializing the members?
{
        int value;
        Node *next;
} *lnFirst; 

ListNode::ListNode() : lnFirst(NULL) {} // Use initializer lists instead of initializing members in the ctor body. It's cleaner, more efficient and may avoid some nasty bugs (because otherwise the member gets default-initialized *first*, and then assigned to in the body)

int ListNode::Length()
{
    int intCount = 0;
    for( Node* lnTemp=lnFirst ; lnTemp != NULL ; lnTemp = lnTemp->next ) // Create the loop iteration variable lnTemp here, in the loop, not at the start of the function
    {
        intCount++;
    }
    return intCount;
}

void ListNode::DisplayList()
{
    for(Node* lnTemp = lnFirst ; lnTemp != NULL ; lnTemp = lnTemp->next ) // And again, initialize the loop variable in the loop
        cout<<endl<<lnTemp->value; // Not a huge deal, but endl flushes the stream as well as inserting a newline. That can be needlessly slow. So you might want to just use "\n" in cases where you don't need the flushing behavior.
}

void ListNode::Insert(int num)
{
//    Node *lnCurrent, *lnNew; // Very subjective, but I prefer not declaring multiple variables on the same line, because the syntax if they're pointers can be surprising (You got it right, but a lot of people would write Node* lnCurrent, lnView, which would make lnView not a pointer. I find it clearer to just give ecah variable a separate line:
    if( lnFirst == NULL )
    {
//        lnFirst = new Node;
//        lnFirst->value = num;
//        lnFirst->next = NULL;
        lnFirst = new Node(num); // Make a constructor which initializes next to NULL, and sets value = num. Just like you would in other languages. ;)
    }
    else
    {
        Node* lnCurrent = lnFirst; // Don't declare variables until you need them. Both to improve readability, and because C++ distinguishes between initialization and assignment, so in some cases, default-initialization followed by assigment may not be the same as just initializing with the desired value.
        while( lnCurrent->next != NULL )
                lnCurrent = lnCurrent->next;

        Node* lnNew = new Node(num); // Again, let a constructor do the work.
        lnCurrent->next = lnNew;
    }
}

bool ListNode::Contains(int num)
{
    bool boolDoesContain = false;
//    Node *lnTemp,*lnCurrent; // Again, don't initialize variables at the start of the function if they're not needed
    Node* lnCurrent = lnFirst;
//    lnTemp = lnCurrent;
    while( lnCurrent!=NULL )
    {
        if( lnCurrent->value == num )
        {
//                boolDoesContain = true;
//                return boolDoesContain;
                  return true; // Just return directly, and remove the boolDoesContain variable. Alternatively, set boolDoesContain to true, and then break out of the loop without returning, so you have a single exit point from the function. Both approaches have their merits, but setting a variable you don't need, and then returning is silly. ;)
        }
//        Node* lnTemp = lnCurrent; // you don't actually use lnTemp for anything, it seems
        lnCurrent = lnCurrent->next;
    }
//    return boolDoesContain;
      return false; // just return false. If you get this far, it must be because you haven't found a match, so boolDoesContain can only be false anyway.
}

int ListNode::GetValue(int num)
{
//    Node *lnTemp;
    int intCount = 1; // Wouldn't most people expect this indexing to be zero-based?
    for( Node* lnTemp=lnFirst; lnTemp != NULL; lnTemp = lnTemp->next )
    {
        if (intCount == num)
        {
            return lnTemp->value;
        }
        intCount++;
    }    
} 
```

现在，发表一些一般性评论。（我将忽略您是否误解了作业，并专注于您发布的代码）首先，匈牙利符号：不要。首先调用你的节点指针，临时和其他任何东西，没有'ln'前缀。调用你的布尔变量 doesContain 没有不必要的'bool'前缀。其次，正如我在编辑后的代码中所做的那样，只在需要时创建变量。C 曾经要求在块的顶部声明变量，但 C++ 从未这样做过。第三，您不需要在 main 函数的末尾加上“return 0”。Main 是一种特殊情况，如果它到达函数的末尾，它会自动返回 0。

第四，我们有一个令人讨厌的问题：内存管理。您分配的内存永远不会被释放。由于您没有 RemoveNode 函数，这似乎是一个有争议的问题，但是当整个列表本身超出范围并被删除时会发生什么？它的所有节点都没有被删除，因为列表中只有一堆指针，并且它不会自动在这些指针上调用 delete。因此，至少，您需要在列表类本身上使用析构函数，以便在删除列表时，确保删除其所有子节点。

这应该处理简单的默认情况，您创建一个列表，向其中添加节点，然后删除列表。

下一个大问题，如果我复制列表怎么办？

```
int main(){
ListNode list;
list.Insert(1);
list.Insert(2);
list.Insert(3);
}
ListNode list2 = list; 
```

你的代码爆炸了。两个列表现在都指向*相同*的节点，而不是制作节点的副本。将节点添加到一个列表也会使其显示在另一个列表中。在您声称“这是一项功能，而不是错误”;) 之前，请考虑一下当*现在*删除其中一个列表时会发生什么。

假设 list2 首先被删除。使用我们刚刚定义的析构函数，它删除了三个节点，然后返回。现在列出已删除节点的点。访问它们是未定义的行为，并且很可能会崩溃。因此，假设我们不访问它们，而是快速删除此列表。

哎呀，这意味着我们正在尝试删除已经被删除的子节点。这听起来*绝对像是一场车祸。*

因此，要解决此问题，您的 ListNode 类必须实现两个附加函数，即复制构造函数和赋值运算符：

```
ListNode(const ListNode& other);
ListNode& operator==(const ListNode& other); 
```

这两个必须确保当所有数据都从“其他”*复制时。*对于“其他”中的每个节点，您必须在当前列表中分配一个新节点，而不是让两个列表都指向同一个节点。（这意味着节点类很可能至少还需要一个复制构造函数）。

这是处理内存管理的基本方法，理解这一点很重要，否则你*会*搞砸的。;)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-27T14:04:41.343

部分作业内容如下：

> 提供以下功能：
> 
> *   ListNode(int v, ListNode *l)
> *   int getValue();
> *   ListNode* getNext();
> *   无效插入（int i）；
> *   布尔列表包含（int j）；

您没有提供任何这些功能。

正如其他几个人指出的那样，您实现了 List 而不是 ListNode，这就是您的函数签名不同的原因。

但是你也不应该轻率地违反作业的编码约定。你有 C# 背景吗？在 C++ 中，编码约定通常要求使用小写的方法名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-27T14:57:06.653

另一个改进是，在列表代码中，您不应该遍历整个列表来获取长度，您可以保留一个计数器，了解在插入/删除时更新它的元素数量并返回它。

# c# - 如何访问 GroupPrincipal 对象上的注释字段

> ID：323817
> 
> 赞同：1
> 
> 时间：2008-11-27T13:52:34.600
> 
> 标签：c#, active-directory

我使用查询特定域中的所有安全组

```
PrincipalSearchResult<Principal> results = ps.FindAll(); 
```

其中 ps 是 PrincipalSearcher。

然后我需要迭代结果（首先将其转换为 GroupPrincipal ）并在 notes 字段中找到包含特定字符串的结果。

但是 AD 中的 Notes 字段似乎不是 GroupPrincipal 类中的公共字段，doh。我究竟做错了什么 ？

更新：我已经放弃了这个。似乎没有办法访问那个讨厌的 Notes 字段。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-31T03:13:27.807

您可以访问目录条目的“注释”字段，如下所示：

```
// Get the underlying directory entry from the principal
System.DirectoryServices.DirectoryEntry UnderlyingDirectoryObject =
     PrincipalInstance.GetUnderlyingObject() as System.DirectoryServices.DirectoryEntry;

// Read the content of the 'notes' property (It's actually called info in the AD schema)
string NotesPropertyContent = UnderlyingDirectoryObject.Properties["info"].Value;

// Set the content of the 'notes' field (It's actually called info in the AD schema)
UnderlyingDirectoryObject.Properties["info"].Value = "Some Text"

// Commit changes to the directory entry
UserDirectoryEntry.CommitChanges(); 
```

花了一点时间 - 我以为 notes 属性确实被称为“notes”，ADSIEdit 来拯救！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T17:56:46.393

我一遍又一遍地回到这个挑战，但现在我终于放弃了。看起来该属性确实无法访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T12:41:10.143

对于使用“info”属性的任何人：请注意，如果使用空字符串或空值，它将引发异常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-29T13:24:14.183

我能够改变那个领域。

entryToUpdate.Properties["info"].Clear(); entryToUpdate.Properties["info"].Add("你想要的一些文本");

所以谢谢布拉德:)

# architecture - 软件设计和架构的文档

> ID：323823
> 
> 赞同：2
> 
> 时间：2008-11-27T13:53:40.557
> 
> 标签：architecture, documentation

记录软件设计和架构的最佳实践和软件工具是什么？

1.  基于 Java 或 .NET 的基于 PC 的应用程序？

2.  基于 VxWorks 或嵌入式 Linux 或 Windows CE 的嵌入式应用程序？

我想到的一个工具是[Enterprise Architect](http://www.sparxsystems.com.au/products/ea/editions.html)。这是一个不错的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:30:47.813

很大程度上取决于文档的目的。读者群是谁？是为了推动开发活动而使用它，还是为了提供一些历史记录而生产它？制作/使用本文档的团队有多大？

在我们的小型开发团队中，我们发现笔/纸和 wiki 足以容纳大多数架构/设计文档。一些设计/架构决策也可以合并到代码注释中（但如果文档用于驱动开发，这显然没有意义。）我们经常使用的两个专业工具是数据库图表/部署工具（例如[DBWrench](http://www.dbwrench.com/)）和 UML 图表工具（例如[ArgoUML](http://argouml.tigris.org/)）。

警告一句：不要编写需要花费大量精力来维护或任何人都不会阅读的文档。

# python - 如何在 Python 中找出是否有要从 Windows 上的标准输入读取的数据？

> ID：323829
> 
> 赞同：8
> 
> 时间：2008-11-27T13:55:59.240
> 
> 标签：python

这段代码

```
select.select([sys.stdin], [], [], 1.0) 
```

在 Linux 上完全符合我的要求，但在 Windows 中却没有。

我以前用过`kbhit()`in`msvcrt`来查看 stdin 上是否有数据可供读取，但在这种情况下它总是返回`0`. 另外`msvcrt.getch()`返回`'\xff'`而`sys.stdin.read(1)`返回`'\x01'`。似乎 msvcrt 函数的行为不正常。

不幸的是，我无法使用 TCP 套接字，因为我无法控制与我的 Python 程序对话的应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:26:53.377

在极少数情况下，您可能会关心标准输入连接到什么。大多数情况下，您并不关心——您只需阅读标准输入。

在`someprocess | python myprogram.py`中，stdin 连接到管道；在这种情况下，前一个进程的标准输出。您只是`sys.stdin`从另一个进程中读取并且正在读取。[请注意，然而，在 Windows 中，仍然（可能）有一个带有键盘的“CON”设备。只是不会`sys.stdin`。]

在`python myprogram.py <someFile`中，stdin 连接到一个文件。您只需从文件中读取，`sys.stdin`并且正在从文件中读取。

在`python myprogram.py`中，stdin 保持连接到控制台（`/dev/ttyxx`在 *nix 中）。你简单`sys.stdin`地从键盘上读取。

请注意上述三种情况的共同主题。您只需阅读`sys.stdin`，您的程序环境就会为您定义一切。您不检查“查看标准输入是否有数据可供阅读”。它已经可用。

有时，您需要键盘中断（或其他恶作剧）。顺便说一句，Python 具有键盘中断作为 I/O 元素的一流功能。Control-C 在 I/O 期间引发中断（它不会进入紧密循环，但它会向定期打印的程序发出信号。）

有时您需要找出`stdin`连接到哪种文件。

`os.isatty( sys.stdin.fileno() )` If is a TTY之类的东西`sys.stdin`，你的程序被连接到windows“CON”（键盘）。如果`sys.stdin`不是 TTY，则它连接到文件或管道。

* * *

例子

```
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\Documents and Settings\slott>python
Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)] on
win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> import sys
>>> os.isatty( sys.stdin.fileno() )
True
>>> 
```

的值`True`告诉我 Python 在没有附加文件或管道的情况下运行。 `sys.stdin`是键盘。使用 Windows`kbhit`是不必要的。

值`False`告诉我 Python 正在运行附加文件或管道。 `sys.stdin`不是键盘。检查`kbhit`可能是有意义的。此外，我可以打开`CON:`设备并直接读取键盘，与`sys.stdin`.

* * *

我不确定您为什么需要“查看标准输入上是否有数据可供阅读”。使用您要完成的工作的其他详细信息来更新您的问题可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-22T13:31:27.290

我运行一个从标准输入读取的线程，然后将数据转发到一个套接字。套接字是可选择的，因此标准输入也是可选择的。

> 在最近的一个项目中，我必须不断地从一个网络套接字读取，转发到另一个套接字，直到用户`q`从控制台输入。有人可能会考虑使用线程，但我不想处理多线程的东西。最后，我找到了一个不明确的解决方案，并且有效。
> 
> 我创建了一个线程——是的，线程，但没有多线程问题——这个线程打开一个监听随机端口的服务器套接字，然后打开一个连接到这个服务器的客户端套接字。服务器套接字接受连接，然后`sys.stdin.read()`以块方式调用，从标准输入读取的所有数据都将写入该接受的连接。所以客户端套接字接收从标准输入读取的数据。现在，客户端套接字是一个*可选择*的标准输入，并且它是线程安全的。

源代码：

```
# coding=UTF-8
""" === Windows stdio ===
@author ideawu@163.com
@link http://www.ideawu.net/
File objects on Windows are not acceptable for select(),
this module creates two sockets: stdio.s_in and stdio.s_out,
as pseudo stdin and stdout.

@example
from stdio import stdio
stdio.write('hello world')
data = stdio.read()
print stdio.STDIN_FILENO
print stdio.STDOUT_FILENO
"""
import thread
import sys, os
import socket

# socket read/write in multiple threads may cause unexpected behaviors
# so use two separated sockets for stdin and stdout

def __sock_stdio():
    def stdin_thread(sock, console):
        """ read data from stdin, and write the data to sock
        """
        try:
            fd = sys.stdin.fileno()
            while True:
                # DO NOT use sys.stdin.read(), it is buffered
                data = os.read(fd, 1024)
                #print 'stdin read: ' + repr(data)
                if not data:
                    break
                while True:
                    nleft = len(data)
                    nleft -= sock.send(data)
                    if nleft == 0:
                        break
        except:
            pass
        #print 'stdin_thread exit'
        sock.close()

    def stdout_thread(sock, console):
        """ read data from sock, and write to stdout
        """
        try:
            fd = sys.stdout.fileno()
            while True:
                data = sock.recv(1024)
                #print 'stdio_sock recv: ' + repr(data)
                if not data:
                    break
                while True:
                    nleft = len(data)
                    nleft -= os.write(fd, data)
                    if nleft == 0:
                        break
        except:
            pass
        #print 'stdin_thread exit'
        sock.close()

    class Console:
        def __init__(self):
            self.serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            self.serv.bind(('127.0.0.1', 0))
            self.serv.listen(5)
            port = self.serv.getsockname()[1]

            # data read from stdin will write to this socket
            self.stdin_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            self.stdin_sock.connect(('127.0.0.1', port))
            self.s_in, addr = self.serv.accept()
            self.STDIN_FILENO = self.s_in.fileno()
            thread.start_new_thread(stdin_thread, (self.stdin_sock, self))

            # data read from this socket will write to stdout
            #self.stdout_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            #self.stdout_sock.connect(('127.0.0.1', port))
            #self.s_out, addr = self.serv.accept()
            #self.STDOUT_FILENO = self.s_out.fileno()
            #thread.start_new_thread(stdout_thread, (self.stdout_sock, self))

            self.read_str = '' # read buffer for readline

        def close(self):
            self.s_in.close()
            self.s_out.close()
            self.stdin_sock.close()
            self.stdout_sock.close()
            self.serv.close()

        def write(self, data):
            try:
                return self.s_out.send(data)
            except:
                return -1

        def read(self):
            try:
                data = self.s_in.recv(4096)
            except:
                return ''
            ret = self.read_str + data
            self.read_str = ''
            return ret

        def readline(self):
            while True:
                try:
                    data = self.s_in.recv(4096)
                except:
                    return ''
                if not data:
                    return ''
                pos = data.find('\n')
                if pos == -1:
                    self.read_str += data
                else:
                    left = data[0 : pos + 1]
                    right = data[pos + 1 : ]
                    ret = self.read_str + left
                    self.read_str = right
                    return ret

    stdio = Console()
    return stdio

def __os_stdio():
    class Console:
        def __init__(self):
            self.STDIN_FILENO = sys.stdin.fileno()
            self.STDOUT_FILENO = sys.stdout.fileno()

        def close(self):
            pass

        def write(self, data):
            try:
                return os.write(self.STDOUT_FILENO, data)
            except:
                return -1

        def read(self):
            try:
                return os.read(self.STDIN_FILENO, 4096)
            except:
                return ''

        def readline(self):
            try:
                return sys.stdin.readline()
            except:
                return ''

    stdio = Console()
    return stdio

if os.name == 'posix':
    stdio = __os_stdio()
else:
    stdio = __sock_stdio() 
```

# c# - WindowsPrincipal.IsInRole 和通用与全局活动目录组

> ID：323831
> 
> 赞同：5
> 
> 时间：2008-11-27T13:56:34.670
> 
> 标签：c#, active-directory, windows-principal, isinrole

有人知道如何`WindowsPrincipal.IsInRole("domain\role")`使用 Active Directory 通用组吗？

假设当前用户是名为 domain 的域中名为 Role 的组的成员，并且 Role 组是 Active Directory 中的全局组。然后以下代码将产生***result = true***：

```
WindowsPrincipal wp = new WindowsPrincipal(WindowsIdentity.GetCurrent());
bool result = wp.IsInRole(@"domain\Role"); 
```

但是，如果角色组更改为通用组，则代码会产生***result = false***。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-28T14:10:41.133

我发现我的问题没有很好的答案，我必须做的是编写一个新的 Principal 类，它扫描用户所属的所有组的目录，并递归扫描所有这些组以解决组中组成员资格。为有相同问题的用户提供的代码。这不是我写过的最简洁的代码，但至少它有效。

像这样使用：

```
var wp = new WindowsPrincipalEx(WindowsIdentity.GetCurrent());
result = wp.IsInRole(@"domain\role");

public class WindowsPrincipalEx : IPrincipal
{
    // Dictionary to store all groups, key = uppercase groupname, value = groupname as entered in AD
    private Dictionary<string,string> completeGroupList = new Dictionary<string,string>();
    // Private vars
    private WindowsIdentity identity;
    private string domain;

    // Identity property
    public IIdentity Identity
    { 
        get { return identity; }
    }

    // Constructor, accepts identity
    public WindowsPrincipalEx(IIdentity identity)
    {
        this.identity = (WindowsIdentity)identity;
        // Find domain name and store it for filtering purposes
        if (identity.Name.Contains('\\'))
            this.domain = identity.Name.Substring(0, identity.Name.IndexOf('\\') + 1);

        // Find all groups this user belongs to, and store the list for later use
        getRoles(completeGroupList);
    }

    public bool IsInRole(string role)
    {
        // Remove domain
        if (role.StartsWith(domain, StringComparison.CurrentCultureIgnoreCase))
            role = role.Substring(domain.Length);
        return completeGroupList.ContainsKey(role.ToUpper());
    }

    private void getRoles(Dictionary<string,string> groupList)
    {
        // Find username and remove domain
        string name = Identity.Name.Replace(domain,"");

        // Find user in AD
        DirectorySearcher search = new DirectorySearcher("(&(sAMAccountName="+name+")(objectCategory=user))");
        search.PropertiesToLoad.Add("memberof");

        SearchResult result = search.FindOne();
        if (result != null)
        {
            // Add all groups to the groupList dictionary
            foreach (string s in result.Properties["memberOf"])
            {
                string[] elements = s.Split(new char[] { ',' });
                foreach (string e in elements)
                    if (e.StartsWith("CN=", StringComparison.CurrentCultureIgnoreCase))
                    {
                        if (!groupList.ContainsKey(e.Substring(3).ToUpper()))
                            groupList.Add(e.Substring(3).ToUpper(),e.Substring(3));
                        break;
                    }
            }
        }

        // Scan through all groups found, and find group on group memberships recursevly
        foreach (var ng in groupList.ToArray())
            getRolesInRoles(groupList, ng.Key);
    }

    private void getRolesInRoles(Dictionary<string, string> groupList, string roleName)
    {
        string name = roleName.Replace(domain, "");

        // Find group in AD
        DirectorySearcher search = new DirectorySearcher("(&(cn="+name+")(objectCategory=group))");
        search.PropertiesToLoad.Add("memberof");

        SearchResult result = search.FindOne();
        if (result != null)
        {
            // Add all groups to the groupList dictionary
            foreach (string s in result.Properties["memberOf"])
            {
                string[] elements = s.Split(new char[] { ',' });
                foreach (string e in elements)
                    if (e.StartsWith("CN=", StringComparison.CurrentCultureIgnoreCase))
                    {
                        if (!groupList.ContainsKey(e.Substring(3).ToUpper()))
                        {
                            groupList.Add(e.Substring(3).ToUpper(),e.Substring(3));
                            getRolesInRoles(groupList, e.Substring(3));
                        }
                        break;
                    }
            }
        }
    }
} 
```

# tfs - 我应该如何正确摆脱 TFS 分支？

> ID：323834
> 
> 赞同：34
> 
> 时间：2008-11-27T13:57:41.127
> 
> 标签：tfs, branch

我想知道我应该如何正确摆脱不再有任何目的的分支。现在，即使我删除它们并提交，它们仍然在属性窗口中列为特定分支根（目录）的分支。如果我选择合并，我没有获得合并到已删除分支的选项，这显然是预期的，但因此我对仍然显示在属性窗口中的分支感到困惑。

对此行为的任何解释将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-17T22:39:21.690

我遇到过一个分支被删除的情况，它没有任何保留的目的。`tf`在我发现像 Damien 提到的目录的删除号之前，我无法破坏工作。我无法通过`tf`属性获取该 ID，因为根据错误消息没有本地副本和服务器副本。

我能够使用以下方法获得完整的 TFS 路径：

```
tf dir $/MyPathTo/TheParent/Directory /deleted 
```

然后我在目录中找到了后缀“;Ident”并可以发出：

```
tf destroy $/MyPathTo/TheParent/Directory/TheDirectoryToGetRidOff;Ident 
```

达米安你的回答帮助了我 - 谢谢。我想我会在你的帖子中包含让我通过它的语法。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-27T14:50:55.043

已删除的分支仅在某个时刻被标记为已删除，如果您在删除操作之前同步到变更集或时间，仍然可以访问代码。

如果您根本不想将文件放在数据库的分支中，可以使用`tf destroy`命令行：

[http://msdn.microsoft.com/en-us/library/bb386005.aspx](https://msdn.microsoft.com/en-us/library/bb386005.aspx)

由于您的分支已经被删除，您需要使用`tf dir /deleted`来查找该分支的删除编号以销毁文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-31T20:15:57.190

请使用以下方法销毁 TFS 项目中的分支，您应该有权删除分支 - 您应该是项目集合管理员的一部分。以管理员权限打开 Visual Studio 命令提示符。cd C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE> tf destroy $/MyProject/Main/Bin /collection: [http://servername:8080/tfs/myproject](http://servername:8080/tfs/myproject)

# c# - 关于关闭 {} 的 C# 注释

> ID：323837
> 
> 赞同：3
> 
> 时间：2008-11-27T13:58:26.460
> 
> 标签：c#, devexpress, comments

我一直在使用 DevExpress CodeRush 和 Refactor！本周 Pro，我选择了一个评论器插件，它会在你输入代码时自动生成评论。

我不想谈论它在挑选基本含义方面做得有多好（实际上非​​常好），但它的默认实现确实提出了一个问题。

默认情况下，键入 } 字符来关闭块将导致插件添加如下注释...

```
using(MyType myType = new MyType())
{
    myType.doWork();
} // using 
```

（即在打开它的右大括号标签中添加注释。）

虽然我可以看到在某些情况下这种行为可能很有用，但我觉得生成的代码看起来非常不整洁，加上所有额外的注释。

我想知道其他人对这种评论的看法是什么。不仅仅是从学术的角度来看，而且如果我收到大量关于他们的负面评论，我可以决定是将它们强加给我的同事还是将它们剔除。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-27T14:02:50.863

我认为这样的评论毫无用处，除非代码当然很糟糕。通过正确的代码格式，不难看出块的开始位置和块的结束位置，因为通常这些块是缩进的。

编辑：如果一个过程是如此之大以至于不是很明显哪个代码块被大括号封闭，那么无论如何应该已经有更多描述性的注释来描述该过程，而这些注释只会是混乱的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-27T14:08:20.900

我发现从代码中生成注释的插件的想法相当无用。如果它可以由机器推断，那么它也可以由任何阅读它的人推断。这些评论极有可能是完全多余的。

我觉得那些右括号注释很混乱，如果个人需要，它提供的信息最好由 IDE 直接提供。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-27T14:03:47.913

IMO 描述代码已经告诉您的内容的每条评论都是不必要的。

如果您的代码块真的很长，以至于您必须滚动很多才能看到那里的开头，那么您做错了，可能会考虑拆分代码。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-27T14:08:06.097

Bad bad comment style - 它在代码库中引入了维护开销。

我知道前 VB 编码人员发现`}`C 语法代码中的 s 线索令人困惑，但在这种情况下，真正的解决方法是重构代码以防止深度嵌套和过长的函数和/或代码块。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-27T14:04:40.877

如果 using 块在 IDE 中的页面上扩展，可能很有用，但是您还有其他问题需要担心。在这种情况下，我通过适当的缩进和一个 IDE 来解决问题，当我选择一个匹配的大括号时，它会突出显示匹配的大括号。

一般来说，我不赞成它，但是当您无法避免长时间的阻塞时，它可能会派上用场。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-27T14:06:30.733

有时你会得到非常大的代码块，或者很多嵌套在一起的块。我有时会在这种情况下使用这种风格，但绝对不是一直都这样。我也不将其限制为代码：HTML 可以从这种“密切评论”风格中受益匪浅：

```
<div id="content">
    <div id="columns">
        <div class="column">

            <!-- .. snip a lot of lines .. -->

        </div> <!-- .column -->
    </div> <!-- #columns -->
</div> <!-- #content --> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-27T14:05:02.157

这种注释只对有很多嵌套块的很长的代码块有用。但话虽如此，首先不应该是这种情况，因为许多嵌套块和长方法都需要重构。所以我一点也不喜欢这样，因为读者显然可以看到它是什么代码块。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-27T14:37:06.037

我认为比注释更有用的是一个 IDE 功能，它不仅可以突出显示匹配的大括号，还可以在工具提示上显示开始行，这样如果您将鼠标悬停在示例中的右大括号上，它会出现“使用（ MyType myType = new MyType())" 在工具提示中。

这将使您能够轻松理解大型函数的复杂嵌套大括号，而不会提供持续的视觉混乱。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-28T12:16:36.510

我总是觉得记住这一点很有用...

清晰、编写良好的代码将为有能力的程序员提供足够的关于代码正在做**什么的解释。**

代码中应该留下注释来解释代码**为什么**这样做！

换句话说，使用注释来帮助你的代码读者理解算法，或者代码应该*实现*什么，而不是它是*如何*实现的！

您可能想[查看 Jeff Atwood 的这篇文章](http://www.codinghorror.com/blog/archives/001150.html)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-27T14:08:34.347

不要这样做，如果在所有地方使用它只会增加噪音，除了适当的缩进应该解决可读性问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-27T14:24:34.330

我会保持关闭状态。当你有多个块在同一个地方结束（更长或更短的块）时，我只看到使用它的意义 - 在某些情况下我自己使用过它们。但是，如果使用它们，最好在精心选择的位置手动添加它们，而不是使用一些自动工具添加它们。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-28T11:37:54.853

如果您必须考虑某种类型的评论是否可用，则很可能是后者。

注释用于解释某些代码块或整个实体，以简化理解；不要使格式更易于阅读。

让插件始终符合这种行为既肥胖又丑陋。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-17T15:50:53.023

我同意有更好的方法来描述代码在做什么。

如果您有一长段代码，前面有一条信息性注释，例如 // Fix Work Item，您可以采用该代码并将其重构为自己的方法。然后使用注释作为新方法的名称，FixWorkItem()。这样做是一种使您的代码更具自我记录性的快速方法，甚至可能会揭示一些您以前没有注意到的设计特征。

请留意像这样的单行注释作为潜在的重构，它可以由 IDE 自动处理。记录本身的代码甚至比写得最好的独立注释都要好，当然，在描述意图时除外。

# database - 用于问卷调查的 MySQL 表设计

> ID：323842
> 
> 赞同：1
> 
> 时间：2008-11-27T14:01:31.587
> 
> 标签：database, database-design

我对 MySQL 还很陌生，并且有一个项目，我需要设计一个数据库来存储在线问卷的回复。需要根据数据编写报告。有人对使用什么类型的字段有任何提示吗？这些问题将有一个是否的答案，从非常满意到非常不满意的 4 个选项或多项选择中进行选择。这主要是我不确定的选择问题，因为我需要能够制作一份报告来显示满意客户的百分比。我知道这可能是非常基本的，但我不想弄错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T14:05:16.243

您是否探索过使用[SurveyMonkey](http://www.SurveyMonkey.com)之类的工具作为问卷的选项？

如果这不适合，MySQL 论坛上的一个帖子可能会有所帮助：[Database design for multiple selection interviews results?](http://forums.mysql.com/read.php?20,3827,3874)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T14:28:12.203

其中一些取决于调查的设计——是单页还是多页；如果是多页，您是在用户从一页到另一页移动时存储数据，还是在最后等。我认为最大的问题是单个调查响应是否将对应于单个数据库行，或者是否单个调查响应可以拆分为多行。显然，如果可能的话，前者是要走的路。

对于选择题，我会使用 INT 或 ENUM 列；确定以特定方式回答的受访者比例是一个简单的“SELECT ... GROUP BY”查询。

# sql - 优化工会

> ID：323857
> 
> 赞同：1
> 
> 时间：2008-11-27T14:08:06.113
> 
> 标签：sql, sql-server-2005, optimization

我在尝试优化 sql server 2005 的以下查询时遇到问题。有谁知道我该如何改进它。那里使用的每个表都有大约 4000 万行。我已经尽力优化它，但我设法做完全相反的事情。

谢谢

```
SELECT
        cos
      , SIN
    FROM
        ConSisHis2005
    union all
    SELECT
        cos
      , SIN
    FROM
        ConSisHis2006
    union all
    SELECT
        cos
      , SIN
    FROM
        ConSisHis2007
    UNION ALL
    SELECT
        cos
      , SIN
    FROM
        ConSisHis2008 
```

也许我应该对架构说点别的，这里使用的所有表都是历史表，它们没有引用任何其他表。并且已经有一个 cos 和 SIN 的索引。我只是想知道是否有任何其他方法来优化查询......你可以想象 160 万条记录很难获得：s

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:18:41.630

似乎该查询只是将分离的历史表组合成一个包含所有数据的结果集。在这种情况下，查询已经是最优的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T14:31:53.990

另一种方法是解决为什么需要拥有所有 1.6 亿行的问题？如果您正在做某种报告，您可以创建单独的报告表，其中已经汇总了一些数据。或者您是否真的需要一个数据仓库来支持您的报告需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T14:17:29.057

在每个表的 cos 和 sin 上放置一个复合索引。这与您在不重构表格设计的情况下获得的一样好（在此示例中，看起来您应该只有 1 个表格开始）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T14:22:39.453

由于没有 WHERE 子句，我不相信你可以做任何事情来提高这个 PoV 的性能。

您已经正确使用了 UNION ALL，所以那里没有帮助。

我唯一能想到的另一件事是表格上是否有更多列？如果是这样，您可能会从磁盘中获取比您需要的更多的数据，从而减慢查询速度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-27T14:33:36.433

可能值得尝试索引视图。您可以将上述语句放入带有 Dave 建议的索引的视图中。最初构建这将花费一些时间，但会更快地返回您的结果（这是假设数据集没有太大变化，因此您可以忍受额外的事务开销）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T04:59:26.187

您可以考虑使用带有年份指示器的单个分区表。

我仍然很好奇 - 这段代码是在视图或 SP 中运行 160m 行，还是实际上会返回 160m 行。如果是这样，那么返回的数据非常多，实际上是一个提取物，并且需要一段时间才能传下来。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-28T05:37:06.360

无需进行优化。由于您要从所有表中选择所有记录，因此根据定义，您可以从一个结果集中的所有表中获取所有记录。

这样做的原因是什么？

# c# - 如何分析程序内部的.exe参数？

> ID：323866
> 
> 赞同：4
> 
> 时间：2008-11-27T14:13:40.360
> 
> 标签：c#, java, .net, python

我有一个可以有很多参数的程序（我们有超过 30 个不同的选项）。

例子： `myProgram.exe -t alpha 1 -prod 1 2 -sleep 200`

这是 3 个命令（来自最后的命令模式对象），每个都包含一些参数。在代码中，我们解析所有命令（以 - 开头）并获取参数的字符串列表（拆分所有空格）。所以其实我们有：string-->Collection of String parameters for each command。

目前，我们使用字符串比较，我们可以让整个事情正常工作（例如具体的命令并返回 ICommand 接口）。问题是我们每次都需要做很多 IF 才能获得好的命令。

您是否有一些模式可用于从 EXE 中提取所有参数而无需使用大量 IF？

代码在 C# 中，但我认为逻辑也可以是任何其他语言......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-27T14:18:48.290

（好吧，因为这是用 Python 标记的）：

为此，我们使用 Python 的[optparse模块。](http://docs.python.org/library/optparse.html)它有一个比许多 if 更友好的 API。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-27T14:21:37.613

创建一个哈希表，其中存储用于处理每个参数的函数指针（在 C# 中是委托），使用参数文本键入。然后，您只需循环执行命令行，并根据哈希表查找的结果调用委托。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-27T14:30:04.210

一个有用的 C# 选项库：[NDesk.Options](http://www.ndesk.org/Options)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-27T14:23:42.570

getopt 函数在 C 编程中非常常见。它可以为您解析参数。这是 C# 的问题（和答案）：[GetOpt library for C#](https://stackoverflow.com/questions/172443/getopt-library-for-c)。

尤其是[lappies 的](https://stackoverflow.com/questions/172443/getopt-library-for-c#172533)实现看起来像带有属性等的相当现代的 C#。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-27T14:19:47.710

使用这样的命令行我会有点不舒服。我要说的第一件事是“第一个'1'是什么意思，为什么它与第二个'1'不同？”

每当我编写一个接受参数的命令行实用程序时，我都会考虑用户学习所有选项是多么容易。在这种情况下，恕我直言，这似乎是一项艰巨的任务。

也许重构用户如何传递参数将是一个好主意。许多软件采用键/值类型参数是有原因的（例如，myclient.exe -server=myServerName -config=debug） 它减轻了用户的负担，并且在遇到代码后也简化了参数解析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-27T15:18:25.847

只是为了好玩，您可以围绕整个事物创建一个包装器，并在代码中使用强名称。更多的工作？是的。但更有趣的是，一旦您向包装器添加新命令，您就可以忘记它；）

```
public class Form1 
{ 

private void main() 
{ 
    MyCommandHandler CommandLineHandler = new MyCommandHandler(); 
    CommandLineHandler.SetInput = "-t alpha 1 -prod 1 2 -sleep 200"; 

    //now we can use strong name to work with the variables: 
    //CommandLineHandler.prod.ProdID 
    //CommandLineHandler.prod.ProdInstanceID 
    //CommandLineHandler.Alpha.AlhaValue() 
    //CommandLineHandler.Sleep.Miliseconds() 
    if (CommandLineHandler.Alpha.AlhaValue > 255) { 
        throw new Exception("Apha value out of bounds!"); 
    } 

} 
} 

public class MyCommandHandler 
{ 
private string[] values; 
public string SetInput { 
    set { values = Strings.Split(value, "-"); } 
} 

//Handle Prod command 
public struct prodstructure 
{ 
    public string ProdID; 
    public string ProdInstanceID; 
} 
public prodstructure prod { 
    get { 
        prodstructure ret = new prodstructure(); 
        ret.ProdID = GetArgsForCommand("prod", 0); 
        ret.ProdInstanceID = GetArgsForCommand("prod", 1); 
        return ret; 
    } 
} 

//Handle Apha command 
public struct Aphastructure 
{ 
    public int AlhaValue; 
} 
public Aphastructure Alpha { 
    get { 
        Aphastructure ret = new Aphastructure(); 
        ret.AlhaValue = Convert.ToInt32(GetArgsForCommand("alpha", 0)); 
        return ret; 
    } 
} 

//Handle Sleep command 
public struct SleepStructure 
{ 
    public int Miliseconds; 
} 
public SleepStructure Sleep { 
    get { 
        SleepStructure ret = new SleepStructure(); 
        ret.Miliseconds = Convert.ToInt32(GetArgsForCommand("sleep", 0)); 
        return ret; 
    } 
} 

private string GetArgsForCommand(string key, int item) 
{ 
    foreach (string c in values) { 
        foreach (string cc in Strings.Split(c.Trim, " ")) { 
            if (cc.ToLower == key.ToLower) { 
                try { 
                    return Strings.Split(c.Trim, " ")(item + 1); 
                } 
                catch (Exception ex) { 
                    return ""; 
                } 
            } 
        } 
    } 
    return ""; 
} 
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-27T17:15:14.533

在 Java 中，通常情况下的答案是，有人抢先一步，并发布了一个出色的开源库来执行此操作。看看[**Apache CLI**](http://commons.apache.org/cli/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-27T14:34:54.670

我不认为这太拥挤了..

```
private void Main() 
{ 
string c = "-t alpha 1 -prod 1 2 -sleep 200"; 

foreach (string incommand in Strings.Split(c, "-")) { 
    HandleCommand(Strings.Split(incommand.Trim, " ")); 
} 
} 

public void HandleCommand(string[] c) 
{ 
switch (c(0).ToLower) { 
    case "t": 
        Interaction.MsgBox("Command:" + c(0) + " params: " + c.Length - 1); 
        break; 
    case "prod": 
        Interaction.MsgBox("Command:" + c(0) + " params: " + c.Length - 1); 
        break; 
    case "sleep": 
        Interaction.MsgBox("Command:" + c(0) + " params: " + c.Length - 1); 
        break; 
} 
} 
```

当然，与其在那些 switch 语句中做完全相同的事情，不如调用适当的函数或代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-28T06:30:23.803

通常，您可以用字典替换大型 if/else 或 switch/case 结构。if-criteria 是键，要执行的代码是值。

例如，您可以在解析命令行之前填充一个`Dictionary<string, ICommand>`（或）。`Dictionary<string, Type>`

当您遍历传入的命令行选项时，您只需在字典中查找它们并“调用”作为要执行的匹配命令（对象）的值（或者`Activate.CreateInstance(/*dictionary-value*/)`如果您存储类型而不是特定对象，则使用实例）。

在 C# 3.0 中，您还可以使用类似的东西`Dictionary<string, System.Linq.Expressions.Expression<T>>`，尽管这让您非常接近实际的 if 语句——这可能是您想要或不想要的东西。YMMV。

一些库只为您提供命令行参数的解析（就像传统的 getopt() 等人所做的那样），或者可以提供整个包，包括在存在特定命令行参数时调用操作。

# c++ - 如何在 Pocket PC 上显示/隐藏 SIP

> ID：323874
> 
> 赞同：3
> 
> 时间：2008-11-27T14:16:25.720
> 
> 标签：c++, windows-mobile, pocketpc

我有以下问题：

我打开对话框，打开 SIP 键盘以填写表格，然后最小化 SIP。然后，当我关闭当前对话框并返回主对话框时，SIP 键盘再次出现。有谁知道我如何以编程方式显示/隐藏 SIP 键盘或更好地解决所描述的问题。一旦用户最小化键盘，它就不会在对话切换时出现在屏幕上。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T15:20:45.013

您需要在 coredll 中调用**SipShowIM** ()。请参阅此 MSDN 文章：

[http://msdn.microsoft.com/en-us/library/ms838341.aspx](http://msdn.microsoft.com/en-us/library/ms838341.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T20:45:07.167

我们使用[SHSipPreference](http://msdn.microsoft.com/en-us/library/aa458034.aspx)来控制 SIP 在我们的应用程序中的显示。我知道它与 MFC 一起工作，它为窗口设置 SIP 的状态，因此您可以设置一次，并且您知道每次显示窗口时 SIP 状态都会恢复到您设置的状态。

我从未听说过 SipShowIM，但我确实在 MSDN 页面上看到了链接：

> 显示和隐藏 SIP (SIPShowIM) 的标准方法在 MFC 对话框中存在一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T14:37:47.003

您可以使用 Microsoft.WindowsCE.Forms.InputPanel 组件。您可以使用 Enabled 属性以编程方式显示/隐藏 SIP。工具箱中有一个 InputPanel 组件。

您还可以处理 InputPanel 的 EnabledChanged 事件。您通常希望在文本框的 GetFocus 事件中显示 SIP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T23:34:47.563

你在使用 MFC 吗？

问题是 SIP 状态是每个对话，而不是每个应用程序。因此，您需要在每个对话框中独立显示/隐藏它。

```
void CAaa::OnActivate( UINT nState, CWnd* pWndOther, BOOL bMinimized )
{
if(nState == WA_ACTIVE || nState == WA_CLICKACTIVE)
{
        SHINITDLGINFO shidi;
            shidi.dwMask = SHIDIM_FLAGS;
            shidi.dwFlags = SHIDIF_FULLSCREENNOMENUBAR|SHIDIF_SIPDOWN | SHFS_HIDETASKBAR;
            shidi.hDlg = m_hWnd;
            SHInitDialog(&shidi);

        SHFullScreen(m_hWnd, SHFS_HIDETASKBAR | SHFS_HIDESIPBUTTON |SHFS_HIDESTARTICON);
}
} 
```

如果不需要，您应该删除任何全屏或任务栏键:)

还有另一件事要使用：

```
 SHSipPreference(m_hWnd,SIP_UP); // SIP_DOWN 
```

甚至：

```
 HWND hwndCB = ::FindWindow(_T("SipWndClass"),_T(""));
      ::ShowWindow( hwndCB, SW_SHOW);
      hwndCB = ::FindWindow(_T("MS_SIPBUTTON"),NULL);
      ::ShowWindow( hwndCB, SW_SHOW); 
```

但后者可能不是那么标准:) 它仍然有效。试试看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-26T22:39:54.173

> ...在其他一些对话框中，我想将键盘布局设置为数字，所以我在构造函数中添加了以下行： SendMessage(EM_SETINPUTMODE, 0, EIM_NUMBERS); 但是，如果我删除此行，我会解决一个问题并创建另一个问题

GetLastError() 是 6（无效句柄）或 120（不支持）。EM_SETINPUTMODE 仅在 SmartPhone 上受支持，SmartPhone 没有 SIP。请参阅[http://msdn.microsoft.com/en-us/library/bb416452.aspx](http://msdn.microsoft.com/en-us/library/bb416452.aspx)。

# wcf - 如何跟踪 WCF 消息大小？

> ID：323888
> 
> 赞同：11
> 
> 时间：2008-11-27T14:20:00.957
> 
> 标签：wcf, debugging

我在玩 WCF，想看看我发送/接收了多少消息，以及这些消息有多大。

我尝试激活 WCF 跟踪，并最终得到一个真正巨大的跟踪文件，但我发现无法从中提取简单的消息大小。

肯定有某种方法可以得到这个吗？也许我在跟踪中错过了一些参数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T14:25:38.307

除了使用像[Wireshark](http://en.wikipedia.org/wiki/Wireshark)（nee ethereal）这样的东西，你还可以看看像[Fiddler](http://www.fiddlertool.com/fiddler/)这样的东西，它还有其他好处。它显示所有请求/响应的内容长度，并允许您以多种方式查看内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T14:25:07.730

WCF 服务跟踪查看器工具允许您打开巨大的跟踪文件并分析消息的许多方面。确保您还打开了消息记录，因此消息本身也会被记录（具有大小等属性...）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-12-17T21:07:22.700

您还可以在 WCF 中构建拦截器并自行捕获和记录这些信息。

[http://msdn.microsoft.com/en-us/library/ms751495.aspx](http://msdn.microsoft.com/en-us/library/ms751495.aspx)

# javascript - 如何在连接文本文件中查找重复行

> ID：323901
> 
> 赞同：0
> 
> 时间：2008-11-27T14:26:51.690
> 
> 标签：javascript, text, refactoring

我最近将 10 个 JavaScript 文件转换为一个文件，然后在其上运行 JavaScript 编译器。我只是有一个错误，我重用了一个函数名。

是否有工具可以检查组合文件中重复的行/函数名称？

或者我应该创建一个小程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:35:58.067

我还没有尝试过，但[http://www.rlvision.com/dupli/about.asp](http://www.rlvision.com/dupli/about.asp)上的“Dupli Find”可能对您有所帮助。

[http://secretgeek.net/ps_duplicates.asp](http://secretgeek.net/ps_duplicates.asp)中概述的 windows powershell 脚本 还可以帮助您编写自定义工具。

[在http://www.microsoft.com/technet/scriptcenter/resources/qanda/aug05/hey0819.mspx](http://www.microsoft.com/technet/scriptcenter/resources/qanda/aug05/hey0819.mspx)也有一个脚本解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T15:16:49.110

```
cat file.js | grep -o "function\([[:space:]]\+[a-zA-Z0-9_]\+\)\?[[:space:]]*(" | sort | uniq -c | sort -n 
```

内容如下：

*   猫文件
*   查找函数定义（function-ws-name-ws-paren） -o 仅提取匹配的行的部分（即仅定义本身）
*   排序（用于下一步）
*   计算相同的连续行（uniq 删除重复项，-c 添加计数）
*   按出现次数进行数字排序，以便重复（如果最后出现）

您可以过滤掉非重复项，但仅排序更容易，因此它们排在第一位。

**编辑**更改的正则表达式以包含匿名函数

# javascript - 删除文本层并替换为图像

> ID：323907
> 
> 赞同：0
> 
> 时间：2008-11-27T14:27:53.637
> 
> 标签：javascript, html, css

我有这个代码，它工作得很好，但我希望能够做到这一点，所以当图像出现时，文本层消失，并且会有一个链接将 xt 带回并删除图像。我将如何做到这一点......，与改变 isibility 和覆盖有关？

```
<html>
  <script type="text/javascript">
    //<!--
    function sbox(boxName, xname) {
      theBox = document.getElementById(boxName);
      theBox.className = xname;
    }
    //-->
  </script>

  <style>
    #main {
      position: absolute;
      width: 800px;
      height: 600px;
    }
    .test1 {
      position: absolute;
      top: 20px;
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: green;
    }
    .test2 {
      position: absolute;
      top: 120px;
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: red;
    }
    .test3 {
      position: absolute;
      top: 220px;
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: blue;
    }
    .test4 {
      position: absolute;
      top: 320px;
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: black;
    }
    .test5 {
      position: absolute;
      top: 20px;
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: yellow;
    }
    #test6 {
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: green;
    }
    #test7 {
      width: 80px;
      height: 80px;
      border-style: solid;
      border-color: green;
    }
  </style>
  <div class="test1" id="test1">
    <a href="#" onclick="sbox('test1', 'test5'); return false;">test1</a>
  </div>
  <div class="test2" id="test2">test2</div>
  <div class="test3" id="test3">test3</div>
  <div class="test4" id="test4">test4</div>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-27T14:45:02.120

我所做的是使用 DIV 和 CSS 将 display 参数设置为 none 以隐藏和阻止显示。

```
<div id="hider" style="display:block"> contents here </div> 
```

并使用 javascript 显示或隐藏内容

```
...
// find the element and it's stored in "elem"
vis = elem.style;
if (showit) {
  vis.display = 'block';
} else {
  vis.display = 'none';
} 
```

其中 showit 是一个布尔值，指示您想要做什么。您还可以检查 vis.display 并切换它。这将显示一个隐藏的 div 并隐藏一个显示的 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T15:07:13.560

使用 display 属性：

```
<div id="text1">Some text here</div>
<a href="" onClick="toggleImg('text1');return false;">Show</a></div>
<div id="text1_img" style="display:none"><img src="/your/image_text1.png" /></div>

<div id="text2">Some text here</div>
<a href="" onClick="toggleImg('text2');return false;">Show</a>
<div id="text2_img" style="display:none"><img src="/your/image_text2.png" /></div>

<div id="text3">Some text here</div>
<a href="" onClick="toggleImg('text3');return false;">Show</a>
<div id="text3_img" style="display:none"><img src="/your/image_text3.png" /></div> 
```

然后，一个JS函数：

```
<script type="text/javascript">
function toggleImg(myid)
{
  objtxt = document.getElementById(myid);
  objimg = document.getElementById(myid+'_img');

  if( objtxt.style.display == 'block' ) // Show image, hide text
  {
    objtxt.style.display = 'none';
    objimg.style.display = 'block';
  }
  else                                  // Hide image, show text
  {
    objimg.style.display = 'none';
    objtxt.style.display = 'block';
  }

}
</script> 
```

我希望您能够将其应用于您的需求。

# wcf - 如何在 Windows 服务中自托管基于 TCP 的 WCF 服务？

> ID：323913
> 
> 赞同：3
> 
> 时间：2008-11-27T14:30:31.527
> 
> 标签：wcf, tcp, windows-services

我正在尝试在 Windows 服务中自托管基于 TCP 的 WFC 服务。Windows 服务是执行 2 个作业的包装器：

1.  托管基于 TCP 的 WCF 服务（注意 Windows 服务是一个简单的服务）
2.  在其下运行其他 Windows 服务

我能够运行 Windows 服务，但是当尝试使用客户端连接到它时，我得到`TCP 10061: target machine actively refused connection`.

这里可能缺少什么；为什么我会收到`TCP 10061`消息？

# c# - 继承类的泥潭，如何让这段代码可维护

> ID：323922
> 
> 赞同：1
> 
> 时间：2008-11-27T14:35:17.353
> 
> 标签：c#, coding-style

我想创建可维护的代码，但是这种继承情况给我带来了问题。

问题在于我的第二个名为**InitUserExtension**的数据库帮助程序类。

由于 UserExtension 继承自 User，我必须确保将InitUser 帮助程序中的任何更改**镜像**到 InitUserExtension。

我真的不喜欢这个，因为**它容易出现错误，解决方案是什么？**

我的班级定义：

```
public class User
{
    public string Name {get; set; }
    public string Age { get; set; }
}

public class UserExtension : User
{
    public string Lastname {get; set; }
        public string Password {get; set; }

} 
```

我的数据库助手：

```
public static SqlDataReader InitUser(SqlDataReader dr)
{
      User user = new User();

      user.Name = Convert.ToString(dr["name"]);
      user.Age ...
}

public static SqlDataReader InitUserExtension(SqlDataReader dr)
{
      UserExtension user = new UserExtension();

      // note: mirror attributes from User
      user.Name = Convert.ToString(dr["name"]);
      user.Age ...

      user.Lastname = Convert.ToString(dr["lastname"]);
      user.Password = ....;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:47:45.453

如何将 Name 等的处理转移到一个方法中（接受一个 User 或一个 T : User），然后从两者中调用它？

```
private static void InitUser(User user, SqlDataReader dr)
{ // could also use an interface here, or generics with T : User
  user.Name = Convert.ToString(dr["name"]);
  user.Age ...
}

public static User InitUser(SqlDataReader dr)
{
    User user = new User();
    InitUser(user, dr);
    return user;
}

public static UserExtension InitUserExtension(SqlDataReader dr)
{
  UserExtension user = new UserExtension();
  InitUser(user, dr);
  user.Lastname = Convert.ToString(dr["lastname"]);
  user.Password = ....;
  return user;
} 
```

作为替代方案，您可以使用泛型减少行数，但会增加复杂性：

```
private static T InitUserCore<T>(SqlDataReader dr) where T : User, new()
{
    T user = new T();
    // ...
    return user;
}
public static User InitUser(SqlDataReader dr)
{
    return InitUserCore<User>(dr);
}
public static UserExtension InitUserExtension(SqlDataReader dr)
{
    UserExtension user = InitUserCore<UserExtension>(dr);
    // ...
    return user;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T14:45:14.913

你为什么不`InitUser`从`InitUserExtension`方法中调用。让基初始化处理基类属性，让扩展初始化器处理扩展类属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T14:58:44.357

如果您确实更喜欢助手，请对助手执行相同操作

```
public class InitUser
{
    public InitUser(SqlDataReader dr, User u) { }
}

public class InitUserExtension : InitUser
{
    public InitUserExtension(SqlDataReader dr , UserExtension u) : base(dr, u) { }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T14:54:31.963

我不确定您为什么没有将分配代码放在类本身中，但这可能与您如何获取信息来存储它有关...

我的解决方案是将其重写为：

```
public class User
{
    public string Name {get; set; }
    public string Age { get; set; }

    public User(DataReader dr)
    {
       user.Name = Convert.ToString(dr["name"]);
       user.Age ...
    }
}

public class UserExtension : User
{
    public string Lastname {get; set; }
    public string Password {get; set; }

    public UserExtension(DataReader dr):base(dr)
    {
        user.Lastname = Convert.ToString(dr["lastname"]);
        user.Password = ....;

    }
} 
```

里程可能会因您的情况而异

这样，像

```
var MyExtension = new UserExtension(dr); 
```

将适当地填充所有字段。

# .net - Visual C++ 中的事件处理

> ID：323928
> 
> 赞同：0
> 
> 时间：2008-11-27T14:36:52.823
> 
> 标签：.net, event-handling, c++-cli

有两个带有两个不同图像的图片框。

如果我单击一个图片框，其中的图像应该被清除。

更糟糕的是，两个图片框只有一个公共事件处理程序。我如何知道是哪个图片框生成了该事件？我会欣赏 C++-CLI 中的源代码

我需要知道在函数内部写什么：

```
private: System::Void sqaure_Click(System::Object^  sender, System::EventArgs^  e) {

} 
```

编辑：问题是当我尝试将发件人转换为 picurebox 时，它会给出一个错误，指出无法转换类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-28T15:04:41.727

你演的怎么样？在大多数情况下，我会使用：

```
PictureBox ^pb = safe_cast<PictureBox^>(sender);
if(pb != null) {
    // logic goes here
} 
```

（请注意，在 Josh 指出我的参考缺陷之后，我已经更正了上面的代码。谢谢！）

如果它可以转换，动态转换将为您提供正确的对象类型，如果不能转换，则为 null（它相当于 C# 中的“as”）

如果这确实给了您一个空引用，那么您的发件人可能不是您认为的那样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T14:47:47.937

您可以使用发件人对象。将其投射到图片框控件并将其与两个可用的图片框进行比较。

我的 Visual C++ 有点生疏，现在无法提供代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T14:50:46.087

kgiannakakis，问题是当我尝试将发件人转换为 picurebox 时，它给出了一个错误，指出无法转换类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T15:14:44.760

您确定发件人对象实际上是您假设的类型吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T17:39:35.547

如果您正在尝试 Toji 提供的代码，那么您就有问题了 - 试试这个：

```
PictureBox ^pb = safe_cast<PictureBox^>(sender); 
```

与不需要任何语法来表示托管堆对象的 C# 不同，C++\CLI 区分堆栈对象 ( `PictureBox pb`)、指向堆对象的指针 ( `PictureBox *pb`) 和托管堆对象的句柄 ( `PictureBox ^pb`)。这三者不是一回事，并且有不同的生命周期和用途。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T05:58:52.067

你想怎么投？我通常会使用`dynamic_cast`or `safe_cast`：

```
PictureBox ^ pb = dynamic_cast<PictureBox^>(sender);
if (pb != nullptr)
{
...
} 
```

或者

```
try
{
    PictureBox ^ pb = safe_cast<PictureBox^>(sender);
    ...
}
catch(InvalidCastException ^ exp)
{
    // Handle a cast that went awry
} 
```

从那里开始应该很简单......

# memory-leaks - 是否存在“好”内存泄漏之类的东西？

> ID：323938
> 
> 赞同：2
> 
> 时间：2008-11-27T14:40:57.480
> 
> 标签：memory-leaks

> **可能重复：**
> [内存泄漏是否正常？](https://stackoverflow.com/questions/273209/are-memory-leaks-ever-ok)

我在某处读到，在需要内存泄漏的特殊情况下，在极少数情况下实际上是一件好事。但我不记得到底是什么了！

有谁知道或记得这样的论点？

谢谢，阿迪

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-27T15:26:49.137

我能想到的唯一需要内存泄漏的情况如下：

（除了第一个之外，它们都有点令人费解）

*   内存泄漏将是编程课中很好的学习练习的学术情况；包括*追踪*和*防止*泄漏。

*   一个分析/测试场景，我们希望了解我们的软件在泄漏情况下的行为。

*   编写一个泄漏的应用程序来测试/调试一个分析应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T18:39:29.793

Memory leaks are never "OK". Sometimes you need to allocate a piece of memory and not deallocate it because it will be needed later, but that isn't a memory leak. But saying things like leaking memory avoids memory fragmentation is like saying it's better to just skip work today without calling in to avoid being late.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T14:45:28.703

哇，我很想知道你是从哪里听说的。内存泄漏就是这样，内存的意外泄漏会浪费资源。我看不出有任何理由想要这种行为，除非你正在构建你希望你的竞争对手使用的软件（就像美国人对俄罗斯人所做的那样，他们让他们窃取管道控制软件）！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-27T14:50:53.950

我能想到的唯一接近的事情是当您想要测试代码以处理内存不足的情况时。这对于没有交换空间的嵌入式系统很重要，其中内存不足是一种致命的情况。

如果您想通过自动化单元测试获得接近 100% 的代码覆盖率，您将必须找出某种方法来使自动化单元测试中的特定分配请求失败（这说起来容易做起来难）。

一旦你有了它，你需要为每个分配请求编写一个单元测试，以确保你有正确处理该分配的内存不足故障（大量工作）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T14:45:31.870

我从来没有听说过内存泄漏是件好事。

在现代操作系统中，它们几乎没有 5-10 年前那么糟糕。那时，在监管程序和内存泄漏方面更糟糕的操作系统会导致内存永久丢失，直到操作系统重新启动。

这些天来，这不是一个真正的问题。因此，最常见的“内存泄漏”是当事情没有正确清理错误并退出程序时。当程序即将终止时，通常可以让内存保持未释放状态，因为当程序被操作系统拆除时，所有这些都会以任何方式重新释放。

在程序运行时，我想不出你想要内存泄漏的理由。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-27T18:33:30.240

@Adi Barda:

In the long run, issues with more memory consumed by leaked objects will outweight memory fragmentation issues.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-27T14:47:06.877

如果您是一家托管公司，他们会为服务器的内存升级收取 $$$++ 的费用，那么它们会很好。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-11-27T16:36:48.073

如何避免内存碎片？这不是一个足够好的理由吗？

# php - 网络服务认证

> ID：323939
> 
> 赞同：1
> 
> 时间：2008-11-27T14:41:58.493
> 
> 标签：php, html, ajax, web-services, authentication

我正在开发一个 webservice + AJAX 接口，我担心身份验证。这一刻，我将用户名和密码作为参数传递给 web 服务，但我担心这种方法非常不安全。有人告诉我 ssl 可以解决我的问题，但我想要更多的选择。

我的网络服务是用 php 编写的，我的界面是用 php + AJAX 编写的。Web 服务从 POST 或 GET 接收参数并检索 xml（将来我可能会使用 JSON）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T14:51:03.687

有各种标准，如 ws-trust、ws-security、ws-federation 等，您可以依靠这些标准来保护您的 Web 服务。

您还可以签署包含安全信息的肥皂标题。

以下博客详细介绍了使用 php 的 web 服务的各种身份验证机制。 [http://phpwebservices.blogspot.com/](http://phpwebservices.blogspot.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T14:46:44.177

AJAX 请求与普通请求没有什么不同。

由于您有一个 AJAX 界面，我想您可以有一个用户登录的页面。当他们登录时，会在浏览器中存储一个 cookie。然后可以将这个 cookie 与每个 AJAX 请求一起发回。

您的 PHP 脚本可以使用 cookie 对 AJAX 请求进行“身份验证”，就像使用普通请求一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T14:46:34.037

如果我理解这个问题，您有 1) AJAX 发布到 PHP，2) PHP 调用 Web 服务。您应该有第 1 步的 SSL 证书。对于第 2 步，Web 服务机器上的 SSL 证书也是安全的。另一种方法是在 Web 服务器和 Web 服务的服务器之间建立一个安全的 VPN。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T03:06:13.873

带有用户凭据的 SSL 与您所能获得的一样安全。您必须定义您的安全问题是什么。用户的数据包会被嗅探吗？这就是 SSL 的用途。未经授权的用户将获得访问权限？这将取决于密码的安全性。

您可以做的一件事是建立一个租赁系统，您可以在其中分发一个唯一的加密 ID，该 ID 必须在邮件中传递，并且在交易后或短时间内到期。可以将该租用代码检索到页面中的隐藏 div 中（以避免上述沙箱问题），然后插入到每个后续 Ajax 请求中。

# java - java fixedThreadPool 可以被多个线程使用吗

> ID：323945
> 
> 赞同：1
> 
> 时间：2008-11-27T14:45:00.890
> 
> 标签：java, web-services, concurrency, threadpool, executorservice

我有一个 Web 服务，它在返回结果之前会进行多次小计算。我想使用`ExecutorService`提供`Executors.newFixedThreadPool()`的方式来实现 Master - Worker 模式（即调用`invokeAll`并让线程等待所有结果完成）。理想情况下，所有 web 服务线程都使用相同的执行器服务，这样它们就不必都创建自己的线程池，它们可以共享一个用完系统所有处理时间的大池。

我对这种方法有疑问：

*   `invokeAll`从多个线程访问函数是否安全。
*   执行程序服务是否会按顺序处理请求（即首先来自线程 1 的所有任务，然后是线程
*   有没有办法说 10 个工作线程，并且可用的最大线程数取决于传入的请求数，所以假设我们有 1 个请求，它使用所有 10 个线程来处理该请求。如果您有 2 个请求，则每个请求将它们拆分为 5 个线程等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T16:22:03.080

在 Java EE 服务器中操作时，不应自行创建线程。我意识到这不是很好的情况，因此您应该根据您使用的应用服务器调查替代方案。如果是 WebSphere 或 Weblogic，您应该使用 commonj 规范的[WorkManager](http://e-docs.bea.com/wls/docs92/commonj/commonj.html)，它提供了您想要的确切功能。[JBoss](http://www.nexopen.org/confluence/display/NXFWK/CommonJ+and+jBoss+integration)也有一个实现。

作为最后的手段，您应该考虑在托管环境中创建自己的线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T14:53:04.163

我会说不要使用invokeAll。让每个请求为您希望并行执行的每个子任务调用 ExecutorService.submit。线程池将处理任务的调度（这就是它的设计目的！）。

是的，如果您使用 Executors.newFixedThreadPool() 每个请求都会被放置在一个队列中，因此它们会按顺序处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-27T14:57:46.963

我认为你应该使用[Semaphore](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Semaphore.html)而不是 invokeAll()

# jquery - 如何组合两个 jQuery 结果

> ID：323955
> 
> 赞同：163
> 
> 时间：2008-11-27T14:46:47.797
> 
> 标签：jquery

你如何组合两个 jQuery 搜索结果？例如：

```
var $allFoos = $('.foo'),
    $allBars = $('.bar')
    $allFoosAndBars = $allFoos + $allBars; 
```

显然，我只是编造了最后一行，但我希望它可以清楚地说明我的意思。需要明确的是，这个例子被大大简化了，它可以是我正在谈论的任何任意集合，所以`$('.foo, .bar')`不是*我*想要的。

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2008-11-27T14:53:34.647

您可以使用[add()](https://api.jquery.com/add/)；

```
var $foos = $('.foo');

var $foosAndBars = $foos.add('.bar'); 
```

或者

```
var $allFoosAndBars = $allFoos.add($allBars); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-10-14T09:25:37.043

另一种解决方案是使用[jQuery.merge()](https://api.jquery.com/jquery.merge/) *(jQuery > 1.0)*

> 说明：将两个数组的内容合并到第一个数组中。

所以你可以简单地用它来合并两个结果：

```
var $allFoos = $('.foo');
var $allBars = $('.bar');

var $allFoosAndBars = $.merge($allFoos, $allBars); 
```

# linux - 如何从脚本编辑 /etc/sudoers？

> ID：323957
> 
> 赞同：136
> 
> 时间：2008-11-27T14:47:12.007
> 
> 标签：linux, shell, sudo

我需要`/etc/sudoers`从脚本编辑以从白名单中添加/删除内容。

假设我有一个可以处理普通文件的命令，我怎么能将它应用到`/etc/sudoers`？

我可以复制和修改它，然后`visudo`用修改后的副本替换原件吗？通过提供我自己的脚本`$EDITOR`？

或者我可以只使用相同的锁`cp`吗？

这个问题更多的是关于潜在问题，而不仅仅是找到有效的东西。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2015-02-07T13:43:31.260

旧线程，但是呢：

```
echo 'foobar ALL=(ALL:ALL) ALL' | sudo EDITOR='tee -a' visudo 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2010-09-14T07:13:07.873

使用 visudo 和自定义编辑器。这解决了 Brian 解决方案的所有竞争条件和“黑客”问题。

```
#!/bin/sh
if [ -z "$1" ]; then
  echo "Starting up visudo with this script as first parameter"
  export EDITOR=$0 && sudo -E visudo
else
  echo "Changing sudoers"
  echo "# Dummy change to sudoers" >> $1
fi 
```

该脚本会将“# Dummy change to sudoers”这一行添加到 sudoers 的末尾。没有黑客，没有比赛条件。

解释这实际上是如何工作的注释版本：

```
if [ -z "$1" ]; then

  # When you run the script, you will run this block since $1 is empty.

  echo "Starting up visudo with this script as first parameter"

  # We first set this script as the EDITOR and then starts visudo.
  # Visudo will now start and use THIS SCRIPT as its editor
  export EDITOR=$0 && sudo -E visudo
else

  # When visudo starts this script, it will provide the name of the sudoers 
  # file as the first parameter and $1 will be non-empty. Because of that, 
  # visudo will run this block.

  echo "Changing sudoers"

  # We change the sudoers file and then exit  
  echo "# Dummy change to sudoers" >> $1
fi 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-11-27T15:15:31.343

您应该对临时文件进行编辑，然后使用 visudo -c -f sudoers.temp 确认更改有效，然后将其复制到 /etc/sudoers 的顶部

```
#!/bin/sh
if [ -f "/etc/sudoers.tmp" ]; then
    exit 1
fi
touch /etc/sudoers.tmp
edit_sudoers /tmp/sudoers.new
visudo -c -f /tmp/sudoers.new
if [ "$?" -eq "0" ]; then
    cp /tmp/sudoers.new /etc/sudoers
fi
rm /etc/sudoers.tmp 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-07-31T08:54:33.513

在大多数发行版（至少基于 Debian、基于 Redhat、基于 openSUSE 等）上，您可以将自定义脚本插入到`/etc/sudoers.d/`具有权限的目录中`0440`- 有关更多信息，请参阅`man sudo`（“在 sudo 中包含其他文件”）或[官方网站](https://www.sudo.ws/man/1.8.15/sudoers.man.html#Including_other_files_from_within_sudoers)上的信息相同。

它可能会有所帮助。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-27T15:17:48.093

visudo 应该是用于编辑的人机界面`/etc/sudoers`。您可以通过直接替换文件来实现相同的目的，但您必须注意并发编辑和语法验证。注意`r--r-----`权限。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-04-22T13:47:36.417

如果您`sudo`允许在 中添加条目`/etc/sudoers.d`，那么您可以使用@dragon788 的这个答案：

[https://superuser.com/a/1027257/26022](https://superuser.com/a/1027257/26022)

基本上，您`visudo`在将文件复制到之前使用它来验证文件`/etc/sudoers.d`，因此您可以确保您不会`sudo`为任何人破坏。

```
visudo -c -q -f filename 
```

这会检查它并在有效时返回成功 (0)，因此您可以将它与`if`,`&&`和其他脚本布尔操作一起使用。验证后，只需将其复制到`/etc/sudoers.d`其中即可。确保它由 root 拥有并且不能被其他人写入。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-01-22T13:51:24.050

很多答案，一直在使用 sudo for yonks，但到目前为止还不需要自动化设置配置。我混合使用了上面的一些答案，将我的配置行写入 /etc/sudoers.d 包含位置，这样我就不必修改主 sudoers 文件，然后检查该文件的语法，简单示例如下：

将您的行写入 sudoers 包含文件：

```
sudo bash -c 'echo "your_user ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers.d/99_sudo_include_file' 
```

检查您的 sudoers 包含文件是否通过了 visudo 语法检查：

```
sudo visudo -cf /etc/sudoers.d/99_sudo_include_file 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-27T15:22:25.573

设置自定义编辑器。基本上，它将是一个接受文件名的脚本（在本例中为 /etc/sudoers.tmp），然后对其进行修改和保存。所以你可以写出那个文件。完成后，退出脚本，visudo 会为您修改实际的 sudoers 文件。

```
sudo EDITOR=/path/to/my_dummy_editor.sh visudo 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-03-07T00:29:03.963

我认为最直接的解决方案是：

创建脚本**addsudoers.sh**

```
#!/bin/sh

while [ -n "$1" ]; do
    echo "$1    ALL=(ALL:ALL) ALL" >> /etc/sudoers;
    shift # shift all parameters
done 
```

并与您想要将其添加为的用户一起调用它：

```
root prompt> ./addsudoers.sh user1 user2 
```

有关完整说明，请参阅此答案：[通过 shell 脚本将用户添加到 sudoers](https://stackoverflow.com/questions/8784761/adding-users-to-sudoers-through-shell-script?lq=1)

问候！

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2021-06-16T09:42:59.747

这是我想出的解决方案。这是一个快速而肮脏的解决方案，但它确实有效......

```
echo "username ALL=(ALL) NOPASSWD:ALL" | sudo tee -a /etc/sudoers 
```

它将 echo 输出通过管道传输到在 sudo 下运行的 tee 中。然后 Tee 将输出附加到 sudoers 文件中。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-05-29T17:16:11.510

只是为了在上面的答案中添加一个进一步的选项，如果竞争条件不是主要问题，那么可以使用以下命令来避免手动将修改后的文件复制到`/etc/sudoers`

```
sudo EDITOR="cp /tmp/sudoers.new" visudo 
```

这将确保新文件通过权限更新得到验证和正确安装。

`/tmp/sudoers.new`请注意，如果文件中有错误，`visudo`则会提示用户输入，因此建议先检查它`visudo -c -f /tmp/sudoers.new`。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-18T17:50:50.883

尝试回应它。不过，您必须在子shell 中运行它。例子：

`sudo sh -c "echo \"group ALL=(user) NOPASSWD: ALL\" >> /etc/sudoers"`

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2013-03-13T21:41:02.020

根据其他人在此处发布的内容，这对我有用。当我使用其他人的脚本时，它会为我打开 visudo 但不会进行编辑。这使得我需要进行编辑以允许所有用户（包括标准用户）为 safari/firefox 安装 java 7u17。

```
#!/usr/bin/env bash
rm /etc/sudoers.new
cp /etc/sudoers /etc/sudoers.new
echo "%everyone   ALL = NOPASSWD: /usr/sbin/installer -pkg /Volumes/Java 7 Update 17/Java 7 Update 17.pkg -target /" >> /etc/sudoers.new
cp /etc/sudoers.new /etc/sudoers 
```

这将 %everyone blah blah blah 添加到 sudoers 文件的底部。我不得不像这样运行脚本。

```
sudo sh sudoersedit.sh 
```

祝你好运：D

# python - 有没有办法杀死一个线程？

> ID：323972
> 
> 赞同：893
> 
> 时间：2008-11-27T14:55:53.973
> 
> 标签：python, multithreading, kill, terminate

是否可以在不设置/检查任何标志/信号量/等的情况下终止正在运行的线程？

* * *

## 回答 #1

> 赞同：771
> 
> 时间：2008-11-28T11:19:54.063

在 Python 和任何语言中，突然终止线程通常是一种不好的模式。考虑以下情况：

*   线程持有必须正确关闭的关键资源
*   该线程创建了几个其他线程，这些线程也必须被杀死。

如果您负担得起（如果您正在管理自己的线程），则处理此问题的好方法是有一个 exit_request 标志，每个线程都会定期检查它是否该退出。

**例如：**

```
import threading

class StoppableThread(threading.Thread):
    """Thread class with a stop() method. The thread itself has to check
    regularly for the stopped() condition."""

    def __init__(self,  *args, **kwargs):
        super(StoppableThread, self).__init__(*args, **kwargs)
        self._stop_event = threading.Event()

    def stop(self):
        self._stop_event.set()

    def stopped(self):
        return self._stop_event.is_set() 
```

在此代码中，您应该`stop()`在希望线程退出时调用它，并使用 . 等待线程正确退出`join()`。线程应定期检查停止标志。

但是，在某些情况下，您确实需要终止线程。一个例子是，当您包装一个忙于长时间调用的外部库时，您想中断它。

以下代码允许（有一些限制）在 Python 线程中引发异常：

```
def _async_raise(tid, exctype):
    '''Raises an exception in the threads with id tid'''
    if not inspect.isclass(exctype):
        raise TypeError("Only types can be raised (not instances)")
    res = ctypes.pythonapi.PyThreadState_SetAsyncExc(ctypes.c_long(tid),
                                                     ctypes.py_object(exctype))
    if res == 0:
        raise ValueError("invalid thread id")
    elif res != 1:
        # "if it returns a number greater than one, you're in trouble,
        # and you should call it again with exc=NULL to revert the effect"
        ctypes.pythonapi.PyThreadState_SetAsyncExc(ctypes.c_long(tid), None)
        raise SystemError("PyThreadState_SetAsyncExc failed")

class ThreadWithExc(threading.Thread):
    '''A thread class that supports raising an exception in the thread from
       another thread.
    '''
    def _get_my_tid(self):
        """determines this (self's) thread id

        CAREFUL: this function is executed in the context of the caller
        thread, to get the identity of the thread represented by this
        instance.
        """
        if not self.isAlive():
            raise threading.ThreadError("the thread is not active")

        # do we have it cached?
        if hasattr(self, "_thread_id"):
            return self._thread_id

        # no, look for it in the _active dict
        for tid, tobj in threading._active.items():
            if tobj is self:
                self._thread_id = tid
                return tid

        # TODO: in python 2.6, there's a simpler way to do: self.ident

        raise AssertionError("could not determine the thread's id")

    def raiseExc(self, exctype):
        """Raises the given exception type in the context of this thread.

        If the thread is busy in a system call (time.sleep(),
        socket.accept(), ...), the exception is simply ignored.

        If you are sure that your exception should terminate the thread,
        one way to ensure that it works is:

            t = ThreadWithExc( ... )
            ...
            t.raiseExc( SomeException )
            while t.isAlive():
                time.sleep( 0.1 )
                t.raiseExc( SomeException )

        If the exception is to be caught by the thread, you need a way to
        check that your thread has caught it.

        CAREFUL: this function is executed in the context of the
        caller thread, to raise an exception in the context of the
        thread represented by this instance.
        """
        _async_raise( self._get_my_tid(), exctype ) 
```

（基于Tomer Filiba 的[Killable Threads](http://tomerfiliba.com/recipes/Thread2/)。关于返回值的引用`PyThreadState_SetAsyncExc`似乎来自[Python 的旧版本](https://svn.python.org/projects/stackless/Python-2.4.3/dev/Python/pystate.c)。）

如文档中所述，这不是灵丹妙药，因为如果线程在 Python 解释器之外忙，它就不会捕获中断。

此代码的一个良好使用模式是让线程捕获特定异常并执行清理。这样，您可以中断任务并仍然进行适当的清理。

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2011-10-13T09:38:20.383

一个[`multiprocessing.Process`](https://docs.python.org/library/multiprocessing.html#multiprocessing.Process)罐头[`p.terminate()`](https://docs.python.org/library/multiprocessing.html#multiprocessing.Process.terminate)

在我想杀死一个线程但不想使用标志/锁/信号/信号量/事件/什么的情况下，我将线程提升为完整的进程。对于只使用几个线程的代码，开销并没有那么糟糕。

例如，这可以方便地终止执行阻塞 I/O 的辅助“线程”

转换是微不足道的：在相关代码中，将所有替换`threading.Thread`为`multiprocessing.Process`和全部`queue.Queue`替换`multiprocessing.Queue`，并将所需的调用添加`p.terminate()`到想要杀死其子进程的父进程`p`

请参阅[Python 文档以获取`multiprocessing`](https://docs.python.org/library/multiprocessing.html).

例子：

```
import multiprocessing
proc = multiprocessing.Process(target=your_proc_function, args=())
proc.start()
# Terminate the process
proc.terminate()  # sends a SIGTERM 
```

* * *

## 回答 #3

> 赞同：132
> 
> 时间：2008-11-27T15:08:07.207

没有官方的 API 可以做到这一点，没有。

您需要使用平台 API 来终止线程，例如 pthread_kill 或 TerminateThread。您可以通过 pythonwin 或 ctypes 访问此类 API。

请注意，这本质上是不安全的。如果被杀死的线程在被杀死时具有 GIL，它可能会导致无法收集的垃圾（来自成为垃圾的堆栈帧的局部变量），并且可能导致死锁。

* * *

## 回答 #4

> 赞同：95
> 
> 时间：2009-11-03T14:53:11.080

如果您试图终止整个程序，您可以将线程设置为“守护进程”。见 [Thread.daemon](http://docs.python.org/library/threading.html#threading.Thread.daemon)

* * *

## 回答 #5

> 赞同：67
> 
> 时间：2014-12-03T00:07:06.260

正如其他人所提到的，规范是设置一个停止标志。对于轻量级的东西（没有 Thread 的子类化，没有全局变量），lambda 回调是一种选择。（注意 中的括号`if stop()`。）

```
import threading
import time

def do_work(id, stop):
    print("I am thread", id)
    while True:
        print("I am thread {} doing something".format(id))
        if stop():
            print("  Exiting loop.")
            break
    print("Thread {}, signing off".format(id))

def main():
    stop_threads = False
    workers = []
    for id in range(0,3):
        tmp = threading.Thread(target=do_work, args=(id, lambda: stop_threads))
        workers.append(tmp)
        tmp.start()
    time.sleep(3)
    print('main: done sleeping; time to stop the threads.')
    stop_threads = True
    for worker in workers:
        worker.join()
    print('Finis.')

if __name__ == '__main__':
    main() 
```

替换为始终刷新 ( )`print()`的`pr()`函数`sys.stdout.flush()`可能会提高 shell 输出的精度。

（仅在 Windows/Eclipse/Python3.3 上测试过）

* * *

## 回答 #6

> 赞同：43
> 
> 时间：2013-03-03T12:42:30.627

在 Python 中，您根本无法直接杀死线程。

如果你真的不需要一个线程（！），你可以做的是使用多处理包，而 [*不是*](http://docs.python.org/2/library/multiprocessing.html)[使用](http://docs.python.org/2/library/multiprocessing.html)[*线程*包](http://docs.python.org/2/library/threading.html)。在这里，要杀死一个进程，您可以简单地调用该方法：[](http://docs.python.org/2/library/multiprocessing.html)

 *```
yourProcess.terminate()  # kill the process! 
```

Python 将杀死你的进程（在 Unix 上通过 SIGTERM 信号，而在 Windows 上通过`TerminateProcess()`调用）。注意在使用队列或管道时使用它！（它可能会破坏队列/管道中的数据）

注意 the`multiprocessing.Event`和 the 的工作方式分别与 the和the`multiprocessing.Semaphore`完全相同。事实上，第一个是后者的克隆。`threading.Event``threading.Semaphore`

如果你真的需要使用一个线程，没有办法直接杀死它。但是，您可以做的是使用*“守护线程”*。事实上，在 Python 中，可以将 Thread 标记为*daemon*：

```
yourThread.daemon = True  # set the Thread as a "daemon thread" 
```

当没有活着的非守护线程时，主程序将退出。换句话说，当你的主线程（当然是一个非守护线程）完成它的操作时，即使还有一些守护线程在工作，程序也会退出。

请注意，必须像调用方法`daemon`之前一样设置线程！`start()`

当然，您`daemon`甚至可以而且应该使用`multiprocessing`. 在这里，当主进程退出时，它会尝试终止其所有守护子进程。

最后，请注意，这`sys.exit()`不是`os.kill()`选择。

* * *

## 回答 #7

> 赞同：38
> 
> 时间：2013-03-07T15:23:22.410

这是基于[thread2 -- 可杀死线程（Python 配方）](http://code.activestate.com/recipes/496960-thread2-killable-threads/)

您需要调用 PyThreadState_SetasyncExc()，它只能通过 ctypes 获得。

这仅在 Python 2.7.3 上进行了测试，但它很可能适用于其他最近的 2.x 版本。

```
import ctypes

def terminate_thread(thread):
    """Terminates a python thread from another thread.

    :param thread: a threading.Thread instance
    """
    if not thread.isAlive():
        return

    exc = ctypes.py_object(SystemExit)
    res = ctypes.pythonapi.PyThreadState_SetAsyncExc(
        ctypes.c_long(thread.ident), exc)
    if res == 0:
        raise ValueError("nonexistent thread id")
    elif res > 1:
        # """if it returns a number greater than one, you're in trouble,
        # and you should call it again with exc=NULL to revert the effect"""
        ctypes.pythonapi.PyThreadState_SetAsyncExc(thread.ident, None)
        raise SystemError("PyThreadState_SetAsyncExc failed") 
```

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2008-11-27T14:58:49.503

你不应该在不合作的情况下强行杀死一个线程。

杀死一个线程会删除任何尝试/最终阻止设置的保证，因此您可能会锁定锁、打开文件等。

您唯一可以争辩说强制终止线程是一个好主意是快速终止程序，但绝不是单个线程。

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2018-04-17T12:05:19.253

如果您`time.sleep()`作为线程的一部分显式调用（例如轮询某些外部服务），则对 Phillipe 方法的改进是在`event`'`wait()`方法中使用超时`sleep()`

例如：

```
import threading

class KillableThread(threading.Thread):
    def __init__(self, sleep_interval=1):
        super().__init__()
        self._kill = threading.Event()
        self._interval = sleep_interval

    def run(self):
        while True:
            print("Do Something")

            # If no kill signal is set, sleep for the interval,
            # If kill signal comes in while sleeping, immediately
            #  wake up and handle
            is_killed = self._kill.wait(self._interval)
            if is_killed:
                break

        print("Killing Thread")

    def kill(self):
        self._kill.set() 
```

然后运行它

```
t = KillableThread(sleep_interval=5)
t.start()
# Every 5 seconds it prints:
#: Do Something
t.kill()
#: Killing Thread 
```

使用`wait()`而不是`sleep()`ing 并定期检查事件的优点是您可以在更长的睡眠间隔内进行编程，线程几乎立即停止（否则您会`sleep()`ing），并且在我看来，处理退出的代码要简单得多.

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2008-11-28T03:47:26.630

您可以通过将跟踪安装到将退出线程的线程中来终止线程。有关一种可能的实现，请参阅附加链接。

[在 Python 中杀死一个线程](https://web.archive.org/web/20130503082442/http://mail.python.org/pipermail/python-list/2004-May/281943.html)

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2008-11-27T15:12:07.183

最好不要杀死线程。一种方法是在线程的循环中引入一个“try”块，并在您想要停止线程时抛出异常（例如，中断/返回/...停止您的 for/while/...）。我已经在我的应用程序上使用了它并且它有效......

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2014-09-04T16:32:48.550

绝对可以实现`Thread.stop`如下示例代码所示的方法：

```
import sys
import threading
import time

class StopThread(StopIteration):
    pass

threading.SystemExit = SystemExit, StopThread

class Thread2(threading.Thread):

    def stop(self):
        self.__stop = True

    def _bootstrap(self):
        if threading._trace_hook is not None:
            raise ValueError('Cannot run thread with tracing!')
        self.__stop = False
        sys.settrace(self.__trace)
        super()._bootstrap()

    def __trace(self, frame, event, arg):
        if self.__stop:
            raise StopThread()
        return self.__trace

class Thread3(threading.Thread):

    def _bootstrap(self, stop_thread=False):
        def stop():
            nonlocal stop_thread
            stop_thread = True
        self.stop = stop

        def tracer(*_):
            if stop_thread:
                raise StopThread()
            return tracer
        sys.settrace(tracer)
        super()._bootstrap()

###############################################################################

def main():
    test1 = Thread2(target=printer)
    test1.start()
    time.sleep(1)
    test1.stop()
    test1.join()
    test2 = Thread2(target=speed_test)
    test2.start()
    time.sleep(1)
    test2.stop()
    test2.join()
    test3 = Thread3(target=speed_test)
    test3.start()
    time.sleep(1)
    test3.stop()
    test3.join()

def printer():
    while True:
        print(time.time() % 1)
        time.sleep(0.1)

def speed_test(count=0):
    try:
        while True:
            count += 1
    except StopThread:
        print('Count =', count)

if __name__ == '__main__':
    main() 
```

该类`Thread3`的代码运行速度似乎比`Thread2`该类快大约 33%。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2018-05-22T18:32:46.897

我玩这个游戏已经很晚了，但我一直在努力解决[类似的问题](https://stackoverflow.com/q/50473309/2123176)，以下似乎完美地解决了我的问题，并让我在守护进程的子线程退出时进行一些基本的线程状态检查和清理：

```
import threading
import time
import atexit

def do_work():

  i = 0
  @atexit.register
  def goodbye():
    print ("'CLEANLY' kill sub-thread with value: %s [THREAD: %s]" %
           (i, threading.currentThread().ident))

  while True:
    print i
    i += 1
    time.sleep(1)

t = threading.Thread(target=do_work)
t.daemon = True
t.start()

def after_timeout():
  print "KILL MAIN THREAD: %s" % threading.currentThread().ident
  raise SystemExit

threading.Timer(2, after_timeout).start() 
```

产量：

```
0
1
KILL MAIN THREAD: 140013208254208
'CLEANLY' kill sub-thread with value: 2 [THREAD: 140013674317568] 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2018-03-14T21:59:07.563

以下解决方法可用于终止线程：

```
kill_threads = False

def doSomething():
    global kill_threads
    while True:
        if kill_threads:
            thread.exit()
        ......
        ......

thread.start_new_thread(doSomething, ()) 
```

这甚至可以用于从主线程终止代码在另一个模块中编写的线程。我们可以在该模块中声明一个全局变量，并使用它来终止在该模块中产生的线程。

我通常使用它来终止程序退出时的所有线程。这可能不是终止线程的完美方式，但可能会有所帮助。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2013-04-22T11:27:17.933

```
from ctypes import *
pthread = cdll.LoadLibrary("libpthread-2.15.so")
pthread.pthread_cancel(c_ulong(t.ident)) 
```

**t**是你的`Thread`对象。

阅读 python 源代码 ( `Modules/threadmodule.c`and `Python/thread_pthread.h`) 你可以看到它`Thread.ident`是一种`pthread_t`类型，所以你可以做任何`pthread`在 python use 中可以做的事情`libpthread`。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2021-01-01T22:23:08.507

这是另一种方法，但代码极其简洁，可在 2021 年的 Python 3.7 中运行：

```
import ctypes 

def kill_thread(thread):
    """
    thread: a threading.Thread object
    """
    thread_id = thread.ident
    res = ctypes.pythonapi.PyThreadState_SetAsyncExc(thread_id, ctypes.py_object(SystemExit))
    if res > 1:
        ctypes.pythonapi.PyThreadState_SetAsyncExc(thread_id, 0)
        print('Exception raise failure') 
```

改编自这里：[https ://www.geeksforgeeks.org/python-different-ways-to-kill-a-thread/](https://www.geeksforgeeks.org/python-different-ways-to-kill-a-thread/)

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2014-05-28T20:09:41.097

我想补充的一件事是，如果您阅读[threading lib Python](https://docs.python.org/2/library/threading.html)中的官方文档，建议避免使用“恶魔”线程，当您不希望线程突然结束时，使用 Paolo Rovelli[提到](https://stackoverflow.com/a/15185771)的标志。

来自官方文档：

> 守护程序线程在关闭时突然停止。它们的资源（如打开的文件、数据库事务等）可能无法正常释放。如果您希望线程优雅地停止，请将它们设为非守护进程并使用合适的信号机制，例如事件。

我认为创建守护线程取决于您的应用程序，但总的来说（在我看来）最好避免杀死它们或使它们成为守护线程。在多处理中，您可以`is_alive()`用来检查进程状态并“终止”以完成它们（也可以避免 GIL 问题）。但有时，当您在 Windows 中执行代码时，您会发现更多问题。

并且永远记住，如果你有“活动线程”，Python 解释器将运行等待它们。（因为如果无关紧要突然结束，这个守护进程可以帮助你）。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2018-07-23T23:53:12.183

为此目的构建了一个库[stopit](https://pypi.org/project/stopit/)。尽管此处列出的一些相同注意事项仍然适用，但至少该库提供了一种常规的、可重复的技术来实现所述目标。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2019-09-04T15:40:10.323

假设您希望拥有多个线程的相同功能，这是恕我直言，通过 id 停止一个最简单的实现：

```
import time
from threading import Thread

def doit(id=0):
    doit.stop=0
    print("start id:%d"%id)
    while 1:
        time.sleep(1)
        print(".")
        if doit.stop==id:
            doit.stop=0
            break
    print("end thread %d"%id)

t5=Thread(target=doit, args=(5,))
t6=Thread(target=doit, args=(6,))

t5.start() ; t6.start()
time.sleep(2)
doit.stop =5  #kill t5
time.sleep(2)
doit.stop =6  #kill t6 
```

好东西就在这里，您可以拥有多个相同和不同的功能，并通过以下方式阻止它们`functionname.stop`

如果你只想拥有一个函数线程，那么你不需要记住 id。停止，如果`doit.stop`> 0。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2020-03-25T20:19:17.273

只是为了建立@SCB 的想法（这正是我所需要的）来创建一个具有自定义功能的 KillableThread 子类：

```
from threading import Thread, Event

class KillableThread(Thread):
    def __init__(self, sleep_interval=1, target=None, name=None, args=(), kwargs={}):
        super().__init__(None, target, name, args, kwargs)
        self._kill = Event()
        self._interval = sleep_interval
        print(self._target)

    def run(self):
        while True:
            # Call custom function with arguments
            self._target(*self._args)

            # If no kill signal is set, sleep for the interval,
            # If kill signal comes in while sleeping, immediately
            #  wake up and handle
            is_killed = self._kill.wait(self._interval)
            if is_killed:
                break

        print("Killing Thread")

    def kill(self):
        self._kill.set()

if __name__ == '__main__':

    def print_msg(msg):
        print(msg)

    t = KillableThread(10, print_msg, args=("hello world"))
    t.start()
    time.sleep(6)
    print("About to kill thread")
    t.kill() 
```

自然，与@SBC 一样，线程不会等待运行一个新循环来停止。在这个例子中，你会看到在“About to kill thread”之后打印出“Killing Thread”消息，而不是再等待 4 秒让线程完成（因为我们已经睡了 6 秒）。

KillableThread 构造函数中的第二个参数是您的自定义函数（此处为 print_msg）。Args 参数是在此处调用函数 (("hello world")) 时将使用的参数。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2021-04-01T11:58:33.510

Python版本：3.8

使用守护线程来执行我们想要的，如果我们想终止守护线程，我们只需要让父线程退出，然后系统将终止父线程创建的守护线程。

还支持协程和协程功能。

```
def main():
    start_time = time.perf_counter()
    t1 = ExitThread(time.sleep, (10,), debug=False)
    t1.start()
    time.sleep(0.5)
    t1.exit()
    try:
        print(t1.result_future.result())
    except concurrent.futures.CancelledError:
        pass
    end_time = time.perf_counter()
    print(f"time cost {end_time - start_time:0.2f}") 
```

下面是 ExitThread 源代码

```
import concurrent.futures
import threading
import typing
import asyncio

class _WorkItem(object):
    """ concurrent\futures\thread.py

    """

    def __init__(self, future, fn, args, kwargs, *, debug=None):
        self._debug = debug
        self.future = future
        self.fn = fn
        self.args = args
        self.kwargs = kwargs

    def run(self):
        if self._debug:
            print("ExitThread._WorkItem run")
        if not self.future.set_running_or_notify_cancel():
            return

        try:
            coroutine = None
            if asyncio.iscoroutinefunction(self.fn):
                coroutine = self.fn(*self.args, **self.kwargs)
            elif asyncio.iscoroutine(self.fn):
                coroutine = self.fn
            if coroutine is None:
                result = self.fn(*self.args, **self.kwargs)
            else:
                result = asyncio.run(coroutine)
            if self._debug:
                print("_WorkItem done")
        except BaseException as exc:
            self.future.set_exception(exc)
            # Break a reference cycle with the exception 'exc'
            self = None
        else:
            self.future.set_result(result)

class ExitThread:
    """ Like a stoppable thread

    Using coroutine for target then exit before running may cause RuntimeWarning.

    """

    def __init__(self, target: typing.Union[typing.Coroutine, typing.Callable] = None
                 , args=(), kwargs={}, *, daemon=None, debug=None):
        #
        self._debug = debug
        self._parent_thread = threading.Thread(target=self._parent_thread_run, name="ExitThread_parent_thread"
                                               , daemon=daemon)
        self._child_daemon_thread = None
        self.result_future = concurrent.futures.Future()
        self._workItem = _WorkItem(self.result_future, target, args, kwargs, debug=debug)
        self._parent_thread_exit_lock = threading.Lock()
        self._parent_thread_exit_lock.acquire()
        self._parent_thread_exit_lock_released = False  # When done it will be True
        self._started = False
        self._exited = False
        self.result_future.add_done_callback(self._release_parent_thread_exit_lock)

    def _parent_thread_run(self):
        self._child_daemon_thread = threading.Thread(target=self._child_daemon_thread_run
                                                     , name="ExitThread_child_daemon_thread"
                                                     , daemon=True)
        self._child_daemon_thread.start()
        # Block manager thread
        self._parent_thread_exit_lock.acquire()
        self._parent_thread_exit_lock.release()
        if self._debug:
            print("ExitThread._parent_thread_run exit")

    def _release_parent_thread_exit_lock(self, _future):
        if self._debug:
            print(f"ExitThread._release_parent_thread_exit_lock {self._parent_thread_exit_lock_released} {_future}")
        if not self._parent_thread_exit_lock_released:
            self._parent_thread_exit_lock_released = True
            self._parent_thread_exit_lock.release()

    def _child_daemon_thread_run(self):
        self._workItem.run()

    def start(self):
        if self._debug:
            print(f"ExitThread.start {self._started}")
        if not self._started:
            self._started = True
            self._parent_thread.start()

    def exit(self):
        if self._debug:
            print(f"ExitThread.exit exited: {self._exited} lock_released: {self._parent_thread_exit_lock_released}")
        if self._parent_thread_exit_lock_released:
            return
        if not self._exited:
            self._exited = True
            if not self.result_future.cancel():
                if self.result_future.running():
                    self.result_future.set_exception(concurrent.futures.CancelledError()) 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-11-24T07:15:56.347

虽然它相当旧，但对于某些人来说，[这](http://code.activestate.com/recipes/496960-thread2-killable-threads/)可能是一个方便的解决方案：

> 一个扩展线程模块功能的小模块——允许一个线程在另一个线程的上下文中引发异常。通过 raise `SystemExit`，您最终可以杀死 python 线程。

```
import threading
import ctypes     

def _async_raise(tid, excobj):
    res = ctypes.pythonapi.PyThreadState_SetAsyncExc(tid, ctypes.py_object(excobj))
    if res == 0:
        raise ValueError("nonexistent thread id")
    elif res > 1:
        # """if it returns a number greater than one, you're in trouble, 
        # and you should call it again with exc=NULL to revert the effect"""
        ctypes.pythonapi.PyThreadState_SetAsyncExc(tid, 0)
        raise SystemError("PyThreadState_SetAsyncExc failed")

class Thread(threading.Thread):
    def raise_exc(self, excobj):
        assert self.isAlive(), "thread must be started"
        for tid, tobj in threading._active.items():
            if tobj is self:
                _async_raise(tid, excobj)
                return

        # the thread was alive when we entered the loop, but was not found 
        # in the dict, hence it must have been already terminated. should we raise
        # an exception here? silently ignore?

    def terminate(self):
        # must raise the SystemExit type, instead of a SystemExit() instance
        # due to a bug in PyThreadState_SetAsyncExc
        self.raise_exc(SystemExit) 
```

因此，它允许“线程在另一个线程的上下文中引发异常”，并且通过这种方式，终止的线程可以处理终止，而无需定期检查中止标志。

但是，根据其[原始来源](http://tomerfiliba.com/recipes/Thread2/)，此代码存在一些问题。

> *   只有在执行 python 字节码时才会引发异常。如果您的线程调用本机/内置阻塞函数，则仅当执行返回到 python 代码时才会引发异常。
>     *   如果内置函数在内部调用 PyErr_Clear() 也会出现问题，这将有效地取消您的未决异常。您可以尝试再次提高它。
> *   只有异常类型可以安全地引发。异常实例很可能导致意外行为，因此受到限制。
>     *   例如：t1.raise_exc(TypeError) 而不是 t1.raise_exc(TypeError("blah"))。
>     *   恕我直言，这是一个错误，我将其报告为一个错误。欲了解更多信息， http: [//mail.python.org/pipermail/python-dev/2006-August/068158.html](http://mail.python.org/pipermail/python-dev/2006-August/068158.html)
> *   我要求在内置线程模块中公开此功能，但由于 ctypes 已成为标准库（从 2.5 开始），并且此
>     功能不太可能与实现无关，因此可能会保持
>     未公开。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2020-06-01T12:21:00.610

正如@Kozyarchuk 的[回答](https://stackoverflow.com/questions/323972/is-there-any-way-to-kill-a-thread/325027#325027)中提到的，安装跟踪是有效的。由于此答案不包含任何代码，因此这是一个现成可用的示例：

```
import sys, threading, time 

class TraceThread(threading.Thread): 
    def __init__(self, *args, **keywords): 
        threading.Thread.__init__(self, *args, **keywords) 
        self.killed = False
    def start(self): 
        self._run = self.run 
        self.run = self.settrace_and_run
        threading.Thread.start(self) 
    def settrace_and_run(self): 
        sys.settrace(self.globaltrace) 
        self._run()
    def globaltrace(self, frame, event, arg): 
        return self.localtrace if event == 'call' else None
    def localtrace(self, frame, event, arg): 
        if self.killed and event == 'line': 
            raise SystemExit() 
        return self.localtrace 

def f(): 
    while True: 
        print('1') 
        time.sleep(2)
        print('2') 
        time.sleep(2)
        print('3') 
        time.sleep(2)

t = TraceThread(target=f) 
t.start() 
time.sleep(2.5) 
t.killed = True 
```

`1`它在打印和后停止`2`。`3`不打印。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-07-29T10:59:06.593

这似乎适用于 Windows 7 上的 pywin32

```
my_thread = threading.Thread()
my_thread.start()
my_thread._Thread__stop() 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-02-09T11:18:10.597

[Pieter Hintjens—— ØMQ](http://zguide.zeromq.org/py:all)项目的创始人之一——说，使用 ØMQ 并避免像锁、互斥锁、事件等同步原语是编写多线程程序的最明智和最安全的方法：

[http://zguide.zeromq.org/py:all#Multithreading-with-ZeroMQ](http://zguide.zeromq.org/py:all#Multithreading-with-ZeroMQ)

这包括告诉子线程，它应该取消它的工作。这将通过为线程配备一个ØMQ-socket并在该socket上轮询一条消息来说明它应该取消来完成。

该链接还提供了一个使用 ØMQ 的多线程 python 代码示例。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2014-06-22T16:24:08.977

如果您确实需要终止子任务的能力，请使用替代实现。`multiprocessing`并且`gevent`两者都支持不分青红皂白地杀死“线程”。

Python 的线程不支持取消。想都别想。您的代码很可能会死锁、损坏或泄漏内存，或者具有其他意想不到的“有趣”难以调试的影响，这些影响很少发生且不确定。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2016-04-14T19:01:09.543

您可以在进程中执行命令，然后使用进程 ID 将其终止。我需要在两个线程之间同步，其中一个线程不会自行返回。

```
processIds = []

def executeRecord(command):
    print(command)

    process = subprocess.Popen(command, stdout=subprocess.PIPE)
    processIds.append(process.pid)
    print(processIds[0])

    #Command that doesn't return by itself
    process.stdout.read().decode("utf-8")
    return;

def recordThread(command, timeOut):

    thread = Thread(target=executeRecord, args=(command,))
    thread.start()
    thread.join(timeOut)

    os.kill(processIds.pop(), signal.SIGINT)

    return; 
```

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2011-04-28T10:52:30.153

> **这是一个不好的答案，请参阅评论**

这是如何做到的：

```
from threading import *

...

for thread in enumerate():
    if thread.isAlive():
        try:
            thread._Thread__stop()
        except:
            print(str(thread.getName()) + ' could not be terminated')) 
```

给它几秒钟然后你的线程应该停止。还要检查`thread._Thread__delete()`方法。

为了方便起见，我会推荐一种`thread.quit()`方法。例如，如果你的线程中有一个套接字，我建议`quit()`在你的套接字句柄类中创建一个方法，终止套接字，然后`thread._Thread__stop()`在你的`quit()`.

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2016-05-17T20:13:43.350

使用 setDaemon(True) 启动子线程。

```
def bootstrap(_filename):
    mb = ModelBootstrap(filename=_filename) # Has many Daemon threads. All get stopped automatically when main thread is stopped.

t = threading.Thread(target=bootstrap,args=('models.conf',))
t.setDaemon(False)

while True:
    t.start()
    time.sleep(10) # I am just allowing the sub-thread to run for 10 sec. You can listen on an event to stop execution.
    print('Thread stopped')
    break 
```

# c# - 无限循环中的 .NET 正则表达式

> ID：323973
> 
> 赞同：1
> 
> 时间：2008-11-27T14:56:36.560
> 
> 标签：c#, vb.net, visual-studio, regex

我正在使用 .NET 正则表达式来剥离 HTML 代码。

使用类似的东西：

```
<title>(?<Title>[\w\W]+?)</title>[\w\W]+?<div class="article">(?<Text>[\w\W]+?)</div> 
```

这在 99% 的情况下都有效，但有时，在解析时......

```
Regex.IsMatch(HTML, Pattern) 
```

解析器只是阻塞，它将在这行代码上继续运行几分钟或无限期。

这是怎么回事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-27T17:52:00.620

当您的 HTML 字符串实际上包含适合该模式的 HTML 时，您的正则表达式将正常工作。但是当您的 HTML 不符合该模式时，例如，如果缺少最后一个标签，您的正则表达式将表现出我所说的“[灾难性回溯](http://www.regular-expressions.info/catastrophic.html)”。单击该链接并向下滚动到“快速匹配完整的 HTML 文件”部分。它准确地描述了您的问题。[\w\W]+? 是一种复杂的说法。+？使用 RegexOptions.SingleLine。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-27T15:08:48.250

通过一些努力，您可以使正则表达式在 html 上工作 - 但是，您看过[HTML 敏捷包](http://www.codeplex.com/htmlagilitypack)吗？这使得将 html 作为 DOM 使用变得更加容易，并支持 xpath 类型的查询等（即“//div[@class='article']”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T15:10:13.943

你要求你的正则表达式在那里做很多事情。在每个字符之后，它必须向前看，看下一位文本是否可以与模式的下一部分匹配。

正则表达式是一种模式匹配工具。虽然您可以将它用于简单的解析，但最好使用特定的解析器（例如 HTML Agility 包，正如我的 Marc 所提到的）。

# ruby-on-rails - Rails 连接表

> ID：323977
> 
> 赞同：2
> 
> 时间：2008-11-27T14:57:47.260
> 
> 标签：ruby-on-rails

我正在尝试使用 GeoKit 插件来计算 2 点之间的距离。所以我的想法是，我搜索一篇文章，我想按距离排序结果。所以我有一个表格，我可以在其中输入文章（我正在寻找）和我的地址。然后 rails 必须找到所有与我的查询匹配的文章并按地址排序。

所以现在，我有两个模型：文章和用户。Articles belongs_to User 和 User has_many Articles。在用户模型中，我有与我的纬度和经度相关的信息。

所以我的 Article 对象有三个字段：

*   ID
*   姓名
*   user_id（FK 到用户模型）

我的用户模型有四个字段

*   ID
*   姓名
*   lat（纬度）
*   lng（经度）

好的，要通过文章访问用户信息，我执行以下查询：

```
@articles = Article.find(:all,:conditions=>"vectors @@ to_tsquery('büch')",:joins=>" INNER JOIN users ON users.id = articles.user_id",:include=>:user,:origin=>"Augustusplatz,8,leipzig,germany") 
```

有用。但是当我想添加一个 :order=>'distance ASC' 时它会失败，因为查询排序使用的是 Article.lat 和 Article.lng 字段来计算距离，但是这些字段 lat 和 lng 是用户对象的成员和不是文章成员。

顺便说一句，如果我得到由 rails 生成的查询，并且我将使用 article.lat/lng 的 order by 子句更改为 users.lat/lng 它可以工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T15:45:00.783

我并不是真正的 SQL 专家，我发现连接很难让我理解（甚至比找出多个 NOT's like 还要多`if(!(foo != !bar & (!baz)))`），但我确实觉得`:joins`行或`:include`行是多余的，甚至是错误的。

（我清理了你的查询，所以我可以理解它，请对问题做同样的事情）：

```
@articles = Article.find(:all,
    :conditions=>"vectors @@ to_tsquery('büch')",
    :joins=>" INNER JOIN users ON users.id = articles.user_id",
    :include=>:user,
    :origin=>"Augustusplatz,8,leipzig,germany") 
```

我猜用户和文章的模型应该定义它们的关系，因此您不需要手动加入或删除包含。

但是我没有从这段代码中看到实际计算距离的地方（可能是 GeoKit 中的一些自动魔法？）。距离应该用 SQL 来“命名”，例如：

```
SELECT (some_heavy_calculation(user.lat, user.long)) AS distance, ... ; 
```

所以你可以在 order by 子句中引用距离，我认为数据库不关心*ruby*​​ 对象是否不包含该值。

也许如果您向我们展示了生成的 SQL，这会导致错误，并且您操纵了 SQL，我们可以更好地理解......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T15:53:03.293

我不想将生成的 sql 放在第一篇文章中，否则会太多:-)

我只使用包含，但我不知道为什么，包含进行左连接，我需要一个内连接。如果我删除包含我无法通过文章对象访问用户信息（例如文章[0].user.name）

这是我的sql。如果我将articles.lat 和articles.lng 字段的顺序更改为users.lat 和user.lng 它可以工作：

```
SELECT "articles"."id" AS t0_r0, "articles"."name" AS t0_r1, "articles"."price" AS t0_r2, "articles"."user_id" AS t0_r3, "articles"."created_at" AS t0_r4, "articles"."updated_at" AS t0_r5, "articles"."vectors" AS t0_r6, "users_articles"."id" AS t1_r0, "users_articles"."name" AS t1_r1, "users_articles"."address" AS t1_r2, "users_articles"."created_at" AS t1_r3, "users_articles"."updated_at" AS t1_r4, "users_articles"."lat" AS t1_r5, "users_articles"."lng" AS t1_r6, "users_articles"."zipcode" AS t1_r7 FROM "articles"  LEFT OUTER JOIN "users" users_articles ON "users_articles".id = "articles".user_id     INNER JOIN users ON users.id = articles.user_id WHERE (vectors @@ to_tsquery('büch'))  ORDER BY                   (ACOS(least(1,COS(0.896021391737553)*COS(0.216084610510851)*COS(RADIANS(articles.lat))*COS(RADIANS(articles.lng))+
              COS(0.896021391737553)*SIN(0.216084610510851)*COS(RADIANS(articles.lat))*SIN(RADIANS(articles.lng))+
              SIN(0.896021391737553)*SIN(RADIANS(articles.lat))))*3963.19) 
```

问候，

胜利者

# javascript - 如何从 Google 解析 JavaScript 中的 XML

> ID：323982
> 
> 赞同：1
> 
> 时间：2008-11-27T14:59:10.113
> 
> 标签：javascript, xml, parsing, weather

我想解析这个 XML 文档[http://www.google.de/ig/api?weather=Braunschweig,%20Deutschland](http://www.google.de/ig/api?weather=Braunschweig,%20Deutschland)我希望能够读出条件、temp_c 和湿度。所有这一切我想在 JavaScript 内部完成，而不使用任何服务器端脚本，例如 PHP，我希望它可以在现代浏览器和 IE7 上运行，如果没有很多问题 IE6 编辑：没有框架的解决方案将是理想的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-16T11:59:07.523

除非您在 google.de 上托管的页面上工作，否则您不能。

[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)可防止在您站点的网页中运行的 JS 访问远程站点上的文档。

您必须涉及服务器端进程，以便将 XML 转换为可以远程处理的格式（例如 JSON-P，[Yahoo! Pipes](http://pipes.yahoo.com/)将为您完成）或通过您自己的服务器与服务器中继数据在与页面相同的来源中可访问的侧进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T15:08:09.097

Ajaxian 有一个很好的教程，介绍如何使用 jQuery [http://ajaxian.com/archives/ajaxian-featured-tutorial-parsing-xml-with-jquery](http://ajaxian.com/archives/ajaxian-featured-tutorial-parsing-xml-with-jquery)解析 XML 希望对您有所帮助

编辑：教程实际上在这里：[http ://blog.reindel.com/2007/09/24/jquery-and-xml-revisited/](http://blog.reindel.com/2007/09/24/jquery-and-xml-revisited/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-27T15:19:31.803

我在 javascript 中使用以下代码解析 XML 时遇到了一些运气：

```
var xmlDoc = this.req.responseXML.documentElement;
var tStatus = xmlDoc.getElementsByTagName("status")[0].firstChild.data;
var tOtherURL = xmlDoc.getElementsByTagName("otherurl")[0].firstChild.data;
var tRows = xmlDoc.getElementsByTagName("rows")[0].firstChild.data; 
```

请记住，我并不真正了解 Javascript，并且我从其他地方对此进行了货物崇拜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-27T16:10:18.313

在[Firefox](https://developer.mozilla.org/en/Introduction_to_using_XPath_in_JavaScript)和 Opera 中，解决方案非常简单：它们具有内置的 XPath 支持。因此，您只需在 XML 响应的 DOM 上[评估](https://developer.mozilla.org/en/DOM/document.evaluate)XPath 表达式。

有了 IE，还有更多工作要做。之前有人问过基本[相同的问题](https://stackoverflow.com/questions/178016/problem-selecting-html-elements-with-xpath-in-internet-explorer)，合理的答案是：您需要使用允许您使用 XPath 的 JavaScript 库。否则，您最终将自己编写特定于问题的解析代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-09T22:19:01.047

我创建了一个非常容易解析 XML 的 jQuery 插件。它适用于所有雅虎 A 级浏览器，并带有过滤、限制和回调选项。

这可能是一个需要考虑的解决方案：http: [//jparse.kylerush.net/](http://jparse.kylerush.net/)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-27T15:14:40.987

我想我找到了一个教程（虽然它是德语）[http://www.aboutwebdesign.de/awd/content/1124893836.shtml](http://www.aboutwebdesign.de/awd/content/1124893836.shtml)

# agile - 小团队的项目方法

> ID：323984
> 
> 赞同：19
> 
> 时间：2008-11-27T15:00:20.313
> 
> 标签：agile, scrum, methodology, extreme-programming

在我公司的每个项目中，我们通常有 1-4 名开发人员/艺术总监/文案，您建议使用什么方法？敏捷？经验？Scrum？还有什么？（我知道它们都是本质上相同概念的变体，是的）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-27T15:04:47.840

我不认为它有一个普遍的答案，这个问题太宽泛了，你不能只是“采用一种方法论”，就好像它是你开箱即用的产品，它是你随着时间而发展的东西...但无论如何，我强烈建议您获得这本书的副本：[Head First Software Development](https://rads.stackoverflow.com/amzn/click/com/0596527357)

然后你将你喜欢的想法应用到你的项目中。不用担心名字和流行语，反正明年它们都将“过时”。**一开始要保持简单**，采用更有意义、最划算的想法，不要试图解决尚不存在的问题。这将是一个非常好的开始。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-27T15:15:15.883

至少对于结对编程，最好有偶数个程序员……;P

小型团队的好处之一是您*不需要*很多支持系统来进行内部沟通（bugtracker 或多或少会成为您自己的待办事项列表，但无论如何拥有它是件好事）。如果与整个团队开会只涉及转身说“嘿，鲍勃和卡尔，看看这个！”，那么无论如何，你并不真的需要所有正式的方法规则。但总的来说，敏捷方法非常适合中小型团队，但它们需要有自我激励的团队成员。

我会说从不同的方法中挑选你喜欢的任何想法，无论如何它们都可以被视为建议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T19:14:41.907

对于这样的小团队，我肯定会考虑采用敏捷方法进行软件开发。就个人而言，我可能会混合使用 XP、Scrum 和 Lean，因为我最了解这些。特别是如果您是敏捷新手，XP 提供了一个很好的起点，您可以从中找到针对特定项目的适应性。我强烈推荐《敏捷开发的艺术》一书。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-14T16:09:40.507

我的 3 开发团队简单地使用看板 + 持续部署，它使我们保持快速移动。我看过 Scrum 和其他人，我们的小团队有太多的开销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-27T15:50:01.693

他们非常接近业务方面，这是一件坏事，因为程序员通常不能很好地理解会计、时间或风险管理等方面的含义，即使他们认为他们知道。他们将商业视为提高其复杂技术技能的另一个有吸引力的机会。由于公司规模较小，在开发团队内部实施复杂的方法可能有点矫枉过正。他们可以自己轻松处理技术问题。他们无法处理的是，如果他们接近商业环境并不意味着他们不再是程序员。

我建议实施一些简单的政策，以确保纪律并专注于技术方面，而不是与客户谈论一些程序员非常喜欢的技术话题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-27T16:32:19.067

答案是，众所周知，这取决于...

每个团队都是个性和能力的混合体，每个团队成员都是不同的。与其专注于寻找“方法论”本身，我建议您专注于每个团队成员成功所需的东西，并将其与项目成功所需的东西结合起来。您会在这两个考虑因素之间找到正确的方法和流程组合。

例如，在过去的七个月里，我一直在领导一个小团队（三个全职开发人员和一些兼职 UI 设计师）。我发现以下做法/程序对我们很有效......

*   采用短时间（60-90 天）、定义明确的螺旋，使团队保持专注和以交付为导向，并帮助我们将风险降至最低。
*   采用迭代生命周期，我们在螺旋式过程中向客户进行一些增量交付，并讨论我们所做的工作。这样做可以让我们和客户确保我们正在满足他们的需求。
*   为每个团队成员量身定制任务和方向。例如，一个团队成员是更初级的开发人员，而另一个团队成员是一个非常优秀的开发人员，但不能很好地处理开放式任务。他们需要不同的方法。

当然，我还定制了 CM 流程和测试实践，以适应项目和团队的需求。

# singleton - DDD 存储库作为单例？

> ID：323987
> 
> 赞同：5
> 
> 时间：2008-11-27T15:03:16.220
> 
> 标签：singleton, domain-driven-design, repository-pattern

快速提问：将我的领域驱动设计风格存储库实现为单例是个好主意还是坏主意？为什么？

或者我应该使用依赖注入器容器来管理我的存储库并确定它们是否是单例？

我仍在*快速阅读 DDD*，并希望看到一些好的存储库示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-27T15:05:41.190

使用您的依赖注入容器来决定如何以及在哪里创建存储库。

通过使用

```
UserRepository.Instance.Find(userId); 
```

您正在为测试设置障碍。

如果您的存储库使用构造函数注入传递到服务中，那么您也可以轻松地将它们替换为模拟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T15:32:00.577

我已经看到了几种方法来做到这一点。

最常见的方法是使用依赖注入将存储库注入到使用它们的对象中。通常这些是演示者或控制器类，但在某些情况下，模型会调用存储库。通常最好避免这种情况。如果您可以使用 di-container 来做到这一点，那就去吧。

您还可以使存储库实现单例模式。我会尽量避免这种情况，因为单例通常使用静态方法。这会使测试调用单例的代码变得更加困难。如果您必须以这种方式做事，那么请确保您分离出调用单例的代码并使用“手动”依赖注入将单例注入到调用它们的类中。这消除了一些您原本会得到的紧密耦合。

我见过一些从未调用存储库的示例。当有人在模型中导航对象图并请求一个未加载的对象时，模型只会引发一个事件，并且存储库会对此事件做出反应。这样就没有对存储库的调用，并且它与模型完全分离。我自己没有使用过这种架构，但它看起来很干净。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T14:32:42.807

我不确定这一点，我也有同样的问题。我认为当经常使用它所使用的对象时，您应该将存储库设为单例。并且如果您使用很少使用的对象，则不应将其设置为单例，因为存储库会占用大量内存来存储对象，并且在应用程序使用期间它可能只会被调用一次并且永远不会再次调用。正如我所说，这可能不是正确的想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-10T11:23:50.137

可以说我有一个非常大的项目，我想添加新服务可以说它是我系统中的一些硬件代表。我希望可以通过许多类访问此服务，我想确保只有一个服务实例或控制对服务的访问的层。通过我的所有系统（200 多个类）注入此服务将是很多工作。对我来说，“单例”或某些“服务定位器”非常适合这项任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-17T15:09:06.013

据我了解，该域仅包含一个存储库接口，这意味着单个接口可以有许多存储库实现。所以存储库当然不能是静态类，因为你不能在接口中定义静态方法。（注意：在某些语言中，您可以在接口中定义静态方法，但这对我来说没有多大意义。）

存储库通常用于将实体与数据库、文件等同步。因此它们具有不稳定的依赖关系。这意味着它们不能是单例，只能具有环境依赖项。这是[一篇](http://enterprisecraftsmanship.com/2016/05/03/singleton-vs-dependency-injection/)关于它的文章。有趣的部分甚至作者都告诉你，你可以在你的域中使用单例。

据我了解，创建一个确保您只有一个实体而不是多个实体的存储库要干净得多。如果您希望您的代码满足[单一责任原则](https://en.wikipedia.org/wiki/Single_responsibility_principle)，那是存储库的责任，而不是实体的责任。**********************