# StackOverflow 问答 000257000-000257999

# c# - 如何在 C# 中将数字四舍五入到小数点后两位？

> ID：257005
> 
> 赞同：447
> 
> 时间：2008-11-02T16:07:46.683
> 
> 标签：c#, decimal, rounding, bankers-rounding

我想使用该`Math.Round`功能来做到这一点

* * *

## 回答 #1

> 赞同：734
> 
> 时间：2008-11-02T16:13:59.680

这里有一些例子：

```
decimal a = 1.994444M;

Math.Round(a, 2); //returns 1.99

decimal b = 1.995555M;

Math.Round(b, 2); //returns 2.00 
```

您可能还想查看以下重载的银行家四舍五入/四舍五入：

```
Math.Round(a, 2, MidpointRounding.ToEven); 
```

[这里](http://en.wikipedia.org/wiki/Rounding#Round-to-even_method)有更多关于它的信息。

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2008-11-02T16:11:44.257

尝试这个：

```
twoDec = Math.Round(val, 2) 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2013-03-27T01:02:19.680

如果你想要一个字符串

```
> (1.7289).ToString("#.##")
"1.73" 
```

或者小数

```
> Math.Round((Decimal)x, 2)
1.73m 
```

* * *

但要记住！舍入不是分布式的，即。`round(x*y) != round(x) * round(y)`. 因此，在计算结束之前不要进行任何舍入，否则您将失去准确性。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2012-02-23T02:01:55.237

就我个人而言，我从不舍弃任何东西。保持它尽可能坚定，因为无论如何四舍五入在CS中有点像红鲱鱼。但是您确实想为您的用户格式化数据，为此，我发现这`string.Format("{0:0.00}", number)`是一个好方法。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-11-02T16:27:31.417

[维基百科有一个](http://en.wikipedia.org/wiki/Rounding)关于四舍五入的好页面。

所有 .NET（托管）语言都可以使用任何公共语言运行时（CLR）的舍入机制。例如，[Math.Round()](http://msdn.microsoft.com/en-us/library/zy06z30k(VS.95).aspx)（如上所述）方法允许开发人员指定舍入的类型（舍入到偶数或远离零）。Convert.ToInt32() 方法及其变体使用[round-to-even](http://msdn.microsoft.com/en-us/library/system.midpointrounding.aspx)。[Ceiling()](http://msdn.microsoft.com/en-us/library/zx4t0t48(VS.95).aspx)和[Floor()](http://msdn.microsoft.com/en-us/library/e0b5f0xb(VS.95).aspx)方法是相关的。

[您也可以使用自定义数字格式](http://msdn.microsoft.com/en-us/library/0c899ak8(VS.95).aspx)进行舍入。

请注意，[Decimal.Round()](http://msdn.microsoft.com/en-us/library/system.decimal.round(VS.71).aspx)使用与 Math.Round() 不同的方法；

这是关于银行家舍入算法的[有用帖子。](http://blogs.msdn.com/ericlippert/archive/2003/09/26/bankers-rounding.aspx)在这里查看雷蒙德关于四舍五入的幽默[帖子之一......](http://blogs.msdn.com/oldnewthing/archive/2005/01/26/360797.aspx)

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2016-01-15T09:15:15.347

// 转换到小数点后两位

```
String.Format("{0:0.00}", 140.6767554);        // "140.67"
String.Format("{0:0.00}", 140.1);             // "140.10"
String.Format("{0:0.00}", 140);              // "140.00"

Double d = 140.6767554;
Double dc = Math.Round((Double)d, 2);       //  140.67

decimal d = 140.6767554M;
decimal dc = Math.Round(d, 2);             //  140.67 
```

=========

```
// just two decimal places
String.Format("{0:0.##}", 123.4567);      // "123.46"
String.Format("{0:0.##}", 123.4);         // "123.4"
String.Format("{0:0.##}", 123.0);         // "123" 
```

也可以将“0”与“#”组合。

```
String.Format("{0:0.0#}", 123.4567)       // "123.46"
String.Format("{0:0.0#}", 123.4)          // "123.4"
String.Format("{0:0.0#}", 123.0)          // "123.0" 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-02-22T21:06:54.780

这是为了在 C# 中舍入到小数点后 2 位：

```
label8.Text = valor_cuota .ToString("N2") ; 
```

在 VB.NET 中：

```
 Imports System.Math
 round(label8.text,2) 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2019-05-09T19:58:57.267

如果你想对一个数字进行四舍五入，你可以获得不同的结果，具体取决于：你如何使用 Math.Round() 函数（如果是向上舍入或向下舍入），你正在使用双精度数和/或浮点数，然后应用中点舍入。特别是，当使用其中的操作或要舍入的变量来自操作时。假设您想将这两个数字相乘：**0.75 * 0.95 = 0.7125**。正确的？不在 C# 中

让我们看看如果你想四舍五入到小数点后第三位会发生什么：

```
double result = 0.75d * 0.95d; // result = 0.71249999999999991
double result = 0.75f * 0.95f; // result = 0.71249997615814209

result = Math.Round(result, 3, MidpointRounding.ToEven); // result = 0.712\. Ok
result = Math.Round(result, 3, MidpointRounding.AwayFromZero); // result = 0.712\. Should be 0.713 
```

如您所见，如果您想向下舍入中点，第一个 Round() 是正确的。但是第二个 Round() 如果你想四舍五入，那就错了。

这适用于负数：

```
double result = -0.75 * 0.95;  //result = -0.71249999999999991
result = Math.Round(result, 3, MidpointRounding.ToEven); // result = -0.712\. Ok
result = Math.Round(result, 3, MidpointRounding.AwayFromZero); // result = -0.712\. Should be -0.713 
```

因此，恕我直言，您应该为满足您的要求的 Math.Round() 创建自己的包装函数。我创建了一个函数，其中参数“roundUp=true”表示舍入到下一个更大的数字。即：0.7125 舍入为 0.713，-0.7125 舍入为 -0.712（因为 -0.712 > -0.713）。这是我创建的函数，适用于任意数量的小数：

```
double Redondea(double value, int precision, bool roundUp = true)
{
    if ((decimal)value == 0.0m)
        return 0.0;

    double corrector = 1 / Math.Pow(10, precision + 2);

    if ((decimal)value < 0.0m)
    {
        if (roundUp)
            return Math.Round(value, precision, MidpointRounding.ToEven);
        else
            return Math.Round(value - corrector, precision, MidpointRounding.AwayFromZero);
    }
    else
    {
        if (roundUp)
            return Math.Round(value + corrector, precision, MidpointRounding.AwayFromZero);
        else
            return Math.Round(value, precision, MidpointRounding.ToEven);
    }
} 
```

变量“校正器”用于修复使用浮点数或双精度数操作的不准确性。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-11-02T09:12:24.080

**我知道这是一个老问题，但请注意数学轮**和**字符串格式轮**之间的以下差异：

```
decimal d1 = (decimal)1.125;
Math.Round(d1, 2).Dump();   // returns 1.12
d1.ToString("#.##").Dump(); // returns "1.13"

decimal d2 = (decimal)1.1251;
Math.Round(d2, 2).Dump();   // returns 1.13
d2.ToString("#.##").Dump(); // returns "1.13" 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-02T16:15:44.733

您可能要检查的一件事是 Math.Round 的舍入机制：

[http://msdn.microsoft.com/en-us/library/system.midpointrounding.aspx](http://msdn.microsoft.com/en-us/library/system.midpointrounding.aspx)

除此之外，我推荐 Math.Round(inputNumer, numberOfPlaces) 方法而不是 *100/100 方法，因为它更干净。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-02T16:15:00.957

您应该能够使用 Math.Round(YourNumber, 2) 指定要四舍五入的位数

[你可以在这里](http://msdn.microsoft.com/en-us/library/zy06z30k.aspx)阅读更多。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-09-11T13:09:46.720

有一个奇怪的情况，我有一个十进制变量，当序列化 55.50 时，它总是在数学上将默认值设置为 55.5。但是，由于某种原因，我们的客户端系统严重期望 55.50，并且他们肯定期望十进制。那是我编写以下帮助程序的时候，它总是将任何填充的十进制值转换为用零填充的 2 位数字，而不是发送一个字符串。

```
public static class DecimalExtensions
{
    public static decimal WithTwoDecimalPoints(this decimal val)
    {
        return decimal.Parse(val.ToString("0.00"));
    }
} 
```

用法应该是

```
var sampleDecimalValueV1 = 2.5m;
Console.WriteLine(sampleDecimalValueV1.WithTwoDecimalPoints());

decimal sampleDecimalValueV1 = 2;
Console.WriteLine(sampleDecimalValueV1.WithTwoDecimalPoints()); 
```

输出：

```
2.50
2.00 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-09-30T10:52:38.860

**Math.Floor(123456.646 * 100) / 100** 将返回 123456.64

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-11-27T06:33:34.623

字符串 a = "10.65678";

十进制 d = Math.Round(Convert.ToDouble(a.ToString()),2)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-06-28T08:53:18.170

```
 public double RoundDown(double number, int decimalPlaces)
        {
            return Math.Floor(number * Math.Pow(10, decimalPlaces)) / Math.Pow(10, decimalPlaces);
        } 
```

# php - DES 加密

> ID：257015
> 
> 赞同：0
> 
> 时间：2008-11-02T16:12:40.010
> 
> 标签：php, encryption, des

DES 加密称为“单向加密”还是“双向加密”？是否有 PHP 类或方法解密 DES 加密？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T16:27:51.277

php [crypt](http://us2.php.net/crypt)函数是一个单向哈希函数，如果你想能够解密，看看支持[一系列算法的](http://us2.php.net/manual/en/mcrypt.ciphers.php)[mcrypt](http://us2.php.net/manual/en/book.mcrypt.php)扩展

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T16:41:04.183

[应该注意的是，围绕DES](http://en.wikipedia.org/wiki/Data_Encryption_Standard)算法存在（并且一直存在）问题。它已经被广泛使用了很长时间，但由于它最初只指定了一个 56 位密钥，因此对于此时的任何重要用途来说它是否足够安全是值得怀疑的。三重 DES 通常更好，但有一些已知的理论攻击。如果您可以选择密码，则可能需要查看[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T16:21:22.023

DES 可以反转，所以它是一种双向加密（如果你是这个意思）。

DES 是一个众所周知的加密标准，因此它也应该在 PHP 中可用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T06:00:18.513

**单向加密**是一种安全的*散列*形式：明文被更改为明显随机的数据序列，通常是固定长度的，这样原始明文（理论上）就无法在没有蛮力的情况下被检索到。

**双向加密**或**可逆加密**是我们通常所说的*加密*的意思：明文被转换为明显随机的数据，但在某种程度上依赖于允许检索原始明文的“密钥”。

DES 是一种可逆加密形式，按照当今的标准来说相对较弱，因为它依赖于 56 位密钥（14 个十六进制字符）。它已被 3DES 或三重 DES 取代，后者本质上是具有更长密钥的相同算法。

您没有提及您的应用程序，但如果您只需要*比较*数据而不需要*检索*它，则散列被认为更安全。例如，您可以存储散列密码；然后，当用户进行身份验证时，对输入的文本执行相同的哈希并将其与存储的哈希值进行比较。如果它们匹配，则输入了正确的密码。

散列的一个显着优势是您不需要存储解密密钥。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-02T16:23:25.997

我不熟悉“单向加密”或“双向加密”术语。有一个术语“一次性密码”（与 DES 完全无关），并且有“对称”和“不对称”加密算法，这意味着是使用相同的密钥进行加密和解密（对称）还是一组两个不同的密钥一个用于加密，另一个用于解密（不对称）。DES 是一种对称算法。至于 PHP， crypt() 既然正在做这项工作：

[http://us2.php.net/crypt](http://us2.php.net/crypt)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-29T15:48:14.457

我认为您可能是指单向函数[1]。在密码学中，人们区分对称和非对称密码学。对称密码术使用相同的密钥进行加密和解密（DES 是对称的）。非对称密码学用于密钥交换，公钥用于加密消息，而私钥用于解密。非对称密码学的一个例子是 AES [2]。非对称密码学使用单向函数。

[1] [http://en.wikipedia.org/wiki/One-way_function](http://en.wikipedia.org/wiki/One-way_function) [2] [http://en.wikipedia.org/wiki/AES](http://en.wikipedia.org/wiki/AES)

# performance - Linq To Sql 与实体框架性能

> ID：257016
> 
> 赞同：16
> 
> 时间：2008-11-02T16:12:56.157
> 
> 标签：performance, linq-to-sql, entity-framework, stored-procedures

我一直在搜索比较 L2S 和 EF 的最新性能基准，但找不到任何使用已发布版本的 EF 测试调用存储过程的基准。因此，我进行了一些自己的测试，并发现了一些有趣的结果。

这些结果看起来对吗？我应该以不同的方式对其进行测试吗？

一个上下文实例，一个sproc调用：（死链接）

上下文的一个实例，同一个sproc的多次调用：（死链接）

上下文的多个实例，同一个sproc的多个调用：（死链接）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T14:37:21.590

我认为您应该以某种不同的方式对其进行测试，以区分[启动成本与执行成本](http://oakleafblog.blogspot.com/2008/08/entity-framework-instantiation-times.html)。尤其是实体框架，[由于需要编译数据库视图](http://blogs.msdn.com/adonet/archive/2008/02/04/exploring-the-performance-of-the-ado-net-entity-framework-part-1.aspx)（尽管您可以提前完成），因此需要大量的启动成本。同样，LINQ 有一个已[编译查询](http://msdn.microsoft.com/en-us/library/system.data.linq.compiledquery.aspx)的概念，如果多次执行查询，这将是合适的。

对于许多应用程序，查询执行成本将比启动成本更重要。对某些人来说，情况可能恰恰相反。由于它们的性能特征不同，我认为区分它们很重要。特别是，将启动成本平均为重复执行查询的平均成本是一种误导。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-27T22:09:12.333

这看起来可以很好地衡量 LINQ to SQL 和实体框架之间的性能。

[http://toomanylayers.blogspot.com/2009/01/entity-framework-and-linq-to-sql.html](http://toomanylayers.blogspot.com/2009/01/entity-framework-and-linq-to-sql.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-16T02:02:32.187

我做了几个测试 asp.net 页面，试图看看哪个表现更好。我的测试是：

删除10000条记录 插入10000条记录 编辑10000条记录 将10000条记录数据绑定到GridView并显示在页面上

我期待 LinqToSQL 更快，但执行上述 LinqToSQL 需要将近 2 分钟，而 LinqToEntities 需要不到 20 秒。

至少对于这个测试，LinqToEntities 似乎更快。我的结果似乎也与您的结果相匹配。

我没有尝试插入/编辑/删除/显示超过 1 个连接在一起的表。

我有兴趣了解更多……或者如果我的测试不是有效的测试类型，我会有兴趣看到一些真实的测试。

# c++ - 如何在 C++ 中创建一个空函子（使用 loki 库）

> ID：257030
> 
> 赞同：3
> 
> 时间：2008-11-02T16:23:28.133
> 
> 标签：c++, loki

[使用loki 库](http://loki-lib.sourceforge.net/)编写类似的东西，

```
typedef Functor<void> BitButtonPushHandler; 
```

引发编译器错误，但这有效

```
typedef Functor<void,TYPELIST_1(Matrix3D*)> Perspective; 
```

> Functor.h:530: error: '((Loki::FunctorHandler, int>*)this)->Loki::FunctorHandler, int>::f_' 不能用作函数 Functor.h:530: error: return - 带有值的语句，在返回“void”的函数中

任何熟悉这个库的人都知道如何让第一行工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-02T17:10:14.497

看源码，Functor模板定义如下：

```
template <typename R = void, class TList = NullType,
        template<class, class> class ThreadingModel = LOKI_DEFAULT_THREADING_NO_OBJ_LEVEL>
    class Functor{...}; 
```

如下所述，不允许使用模板类型定义，因此需要指定所有类型（或接受所有默认值）。

您可以按如下方式定义并让默认值完成工作：

```
typedef Functor<> BitButtonPushHandler; 
```

这为我编译了一个小的测试 Functor 类（不是实际的 Loki 类），我可以成功使用 typedef。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T08:47:11.970

我最初写的工作......已经很晚了，我忘记了......

```
using namespace Loki; 
```

...非常抱歉

# php - 如何在 PHP 中四舍五入？

> ID：257032
> 
> 赞同：7
> 
> 时间：2008-11-02T16:24:58.083
> 
> 标签：php, rounding

我需要将任何非整数四舍五入到最接近的整数，无论​​小数点后的数字是否> 5。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-02T16:26:59.483

您可以利用[`ceil($value)`](http://php.net/ceil)PHP 中的函数进行四舍五入。

同样，您可以使用[`floor()`](http://php.net/floor)for 向下舍入。

# web-services - 什么是可扩展查询界面的好设计？

> ID：257040
> 
> 赞同：0
> 
> 时间：2008-11-02T16:35:49.590
> 
> 标签：web-services, enterprise

我们的应用程序通过 Web 服务公开查询，我们发现我们的客户经常需要自定义查询，或者通过指定附加条件来进一步限制返回的结果，或者通过询问我们还没有的东西暴露。

现在，我们可以采用为这些新方法中的每一个创建新方法的方法，但这有点不方便；在客户站点部署我们的应用程序通常需要数周的分阶段集成测试。我们提出了一种命名查询机制，应用程序管理员将通过名称定义参数化的查询，以及一个简单地调用这些参数的相应 Web 服务。但是，我不禁认为以前有人已经解决了这个问题，所以我想从 SO 社区获得一些关于可能设计的意见。

谢谢！

**更新**

规范模式是一个很好的模式，但是我们的应用程序处理了足够多的数据，我们希望将尽可能多的查询工作推送到 RDBMS 中，这可以比我们想要的更好地优化查询计划。此外，我们支持三个 RDBMS 后端，因此我们被困在使用最大公分母方法：我们使用功能最少的数据库所能提供的尽可能多的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T16:56:04.480

我还建议考虑将此类应用程序中的“规范模式”作为后端的设计决策。检查以下有关“规范模式”的帖子：

[http://www.mattberther.com/2005/03/25/the-specification-pattern-a-primer/](http://www.mattberther.com/2005/03/25/the-specification-pattern-a-primer/)

[http://devlicio.us/blogs/jeff_perrin/archive/2006/12/13/the-specification-pattern.aspx](http://devlicio.us/blogs/jeff_perrin/archive/2006/12/13/the-specification-pattern.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T16:50:20.060

*   查看[Hibernates Criteria API](http://www.hibernate.org/hib_docs/reference/en/html/querycriteria.html)并使用它或为您的用户构建一些类似的功能。
*   如果值得付出努力，请为分组标准提供一个树状界面。（“一个组的所有条件必须匹配”/“一个条件必须匹配”/“否定”）

好处：

*   易于构建。
*   用户参数是可能的。
*   强大的查询是可能的。
*   您可以应用限制，例如*SELECT ... FROM table WHERE someRestriction AND（用户提供的条件）*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T17:51:48.720

[由于我们真的不知道您的用户如何使用您的界面，因此就感觉更接近“囚犯正在运行庇护](http://books.google.se/books?id=04cFCVXC_AUC&dq=Inmates+are+running+the+Asylum&pg=PP1&ots=jfvgZ3v_qK&source=bn&sig=i2Y92rSllNxflFMEksRjRWAuc5E&hl=sv&sa=X&oi=book_result&resnum=4&ct=result)”问题的问题提供技术建议似乎有点为时过早。有一些非常好的建议和常见的方法来解决这个我技术方面的问题，但它们对你的用户有用吗？也许真的不要对你的问题说废话，而是有一个很好的一键式解决方案？（或者更像谷歌？）

# database - 管理将破坏性数据库更改迁移到由同一应用程序的旧版本共享的数据库

> ID：257045
> 
> 赞同：4
> 
> 时间：2008-11-02T16:49:29.407
> 
> 标签：database, architecture, deployment, high-availability

我的目标之一是能够部署与旧版本并行运行的 Web 应用程序的新版本。问题是所有东西都共享一个数据库。新版本中的数据库倾向于对数据库表进行重大重构。我希望随着时间的推移向用户推出新版本的应用程序，并在需要时将它们切换回旧版本。

Oren 有一个很好[的帖子](http://ayende.com/Blog/archive/2007/11/24/A-vision-of-enterprise-platform-Hot-amp-Distributed-Deployment.aspx "企业平台愿景：热分布式部署")来设置这个问题，但它以：

“对于影响整个系统的更改，即破坏数据库更改，在部署到生产环境方面，我们仍然处于混乱之中。我将在下一部分中讨论这一点，这只是一点点手，我怕。”

后续帖子从未出现;-)。您将如何管理将破坏性数据库更改迁移到由同一应用程序的旧版本共享的数据库。您将如何保持数据同步？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T17:07:48.590

阅读 Scott Ambler 的《[重构数据库](http://www.ambysoft.com/books/refactoringDatabases.html)》一书；加一点盐，但里面有很多好主意。

可用解决方案的详细信息取决于您使用的 DBMS。但是，您可以执行以下操作：

*   为新设计创建一个新表（或几个新表）
*   使用从新表中收集数据的旧表名创建一个视图
*   在视图上创建“代替”触发器以更新新表而不是视图

在某些情况下，您不需要新表 - 您可能只需要触发器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T17:06:55.847

如果必须维护旧版本，则更改根本不会中断。这在部署新版本的 Web 应用程序时也很有帮助 - 如果您需要回滚，如果您可以保持数据库不变，这*真的很有帮助。*

显然，这带来了重大的架构障碍，并且您几乎可以肯定最终会得到一个显示其血统的数据库，可以这么说 - 但根据我的经验，部署优势通常值得头疼。

如果您对涉及的每个旧版本都有一个可靠的集成测试集合，这将很有帮助。您应该能够针对仍被视为“可能实时”的每个版本的迁移测试数据库运行它们 - 在某些情况下，这很可能是“曾经的每个版本”。如果您能够合理地严格控制部署，则可能只具有三个或四个版本的兼容性 - 在这种情况下，如果确实需要，您可以计划逐步淘汰过时的表/列等。请记住，这种计划对所产生的好处的复杂性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T17:12:38.330

假设您的客户端只有 2 个版本，我只会在新表中保留一份数据副本。

您可以在新表之上的视图后面维护新旧应用程序之间的合同。使用之前/而不是触发器来处理对实际写入新表的“旧”视图的写入。

您正在维护 2 个版本的代码，并且仍必须开发您的旧应用程序，但这是不可避免的。

这样，就没有同步问题，实际上您必须处理“旧”和“新”模式之间的复制冲突。

如前所述，超过 2 个版本变得复杂......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T17:20:14.633

首先，我想说这个问题非常难，你可能找不到完整的答案。

最近我一直在维护一个遗留的业务应用程序，它可能很快就会演变为一个新版本。维护包括解决错误、优化旧代码和新功能，这些功能有时无法轻松适应当前的应用程序架构。我们的应用程序的主要问题是它的文档记录很差，没有任何更改的痕迹，而且我们基本上是从事这个项目的第 5 个轮换团队（我们对它还很陌生）。

将外部细节放在一边（代码、层等），我将尝试解释一下我们当前如何管理数据库更改。

目前，我们有两条规则要遵循：

1.  首先，旧代码（sql、存储过程、函数等）是否按原样工作并且应该保持原样，除非有这种情况（错误或功能更改），否则不要修改太多，当然，尝试记录它尽可能多地（尤其是诸如“WTF！，他为什么要那样做而不是那样做？”之类的问题）。

2.  其次，每一个新特性的出现都应该使用目前已知的最佳实践，并且尽可能少地修改旧的数据库结构。这将引入一些数据库重构选项，例如在旧结构之上使用可编辑视图，为现有的扩展表引入新的扩展表，规范化结构并通过视图提供旧结构等。

此外，我们正在尝试编写尽可能多的单元测试，前提是业务分析师并肩工作并记录业务规则。

数据库重构是一个非常复杂的领域，需要简短回答。有很多书可以回答你所有的问题，[其中一本 http://databaserefactoring.com/](http://databaserefactoring.com/)被指出在其中一个[答案](https://stackoverflow.com/questions/257045/managing-the-migration-of-breaking-database-changes-to-a-database-shared-by-old#257061)中。

稍后编辑：希望第二条规则也能回答对重大更改的处理。

# geometry - 如何将由小正方形组成的区域划分为更大的矩形？

> ID：257047
> 
> 赞同：10
> 
> 时间：2008-11-02T16:51:52.053
> 
> 标签：geometry, 2d, area, rectangles

我会去哪里寻找将 0 或 1 的二维网格值作为输入的算法，然后在其中识别所有可能的非重叠矩形？

在更实际的解释中：我正在绘制一个由多个正方形表示的网格，并且我希望找到一种方法将尽可能多的相邻正方形组合成矩形，以减少骑自行车所花费的时间每个正方形并绘制它。

不需要最高效率，速度更重要。

附录：显然我正在寻找的似乎是一种称为 Tesselation 的技术。现在我只需要为这个具体案例找到一个好的描述。

附录2：“1”方格的边界将是不规则的，在某些情况下甚至没有连接，因为“1”方格的分布将是完全随机的。我需要识别这些不规则的形状并将其分成规则的矩形。

**正确答案：**为了在速度和效率之间取得最佳平衡，最好使用网格数据来填充四叉树，每个节点的状态值为空/部分填充/填充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T11:14:38.207

查看[Dobb 博士门户网站](http://www.ddj.com/184410529)上的这篇文章，了解如何在您的情况下找到最大矩形。这是对一种非常有效的算法的非常详细的讨论，我认为迭代地重复它可能会解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T17:44:38.063

我已经为使用 OpenGL 的 3d 框的快速和肮脏的体素可视化做了类似的事情。

我从左上角的框开始并存储了空/填充标志。然后我尝试将矩形向右扩展，直到我碰到一个带有不同标志的框。我在向下方向做了同样的事情。

绘制矩形（如果已填充）。

如果有剩余的框，则递归地对由最后一个矩形诱导的所有三个剩余矩形重复该过程，它们分别是右下角和右下角：

```
xxxx   1111
xxxx   1111
xxxx   1111

2222   3333
2222   3333
2222   3333 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-02T17:20:07.317

由于您不是在寻找最小平方数，因此我建议您使用一种仍然保持算法简单的折衷方案。

最佳解决方案取决于您的数据，但一种简单的替代方法是仅沿一行收集框。IE：

```
0 0 1 1 1 0 0 0 1 1 1 1 0 
```

将导致：

```
skip 2
draw 3
skip 3
draw 4
skip 1 
```

这将减少对绘制框的调用次数，而无需任何缓存（即您可以即时构建您的框）。

如果您想创建更大的框，我建议您使用回溯算法找到第一个 1 并尝试向各个方向扩展框。建立一个盒子列表，并在使用它们时清除 1:s。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T17:15:15.627

所以你正在寻找“ON”正方形的矩形边界？
你想要内界还是外界？
IE。边界是否必须只有“ON”方格，或者您是否希望矩形包含一组中的所有“ON”方格？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-03T16:34:56.140

我必须解决类似的问题，我的算法支持锯齿状数组，我已经对其进行了大量测试和评论，但它比 joel-in-gö 的建议慢： [https ://stackoverflow.com/a/13802336](https://stackoverflow.com/a/13802336)

# php - 如何从 PHP 中的字符串中获取特定的单词？

> ID：257050
> 
> 赞同：1
> 
> 时间：2008-11-02T16:56:51.000
> 
> 标签：php, regex, string

假设你有一个字符串，但你不知道它包含什么。并且您想用同一单词的格式化版本替换特定单词的所有出现或单词的一部分。例如，我有一个包含“lorem ipsum”的字符串，我想用“lorem can”替换包含“lo”的整个单词，这样最终结果将是“lorem can ipsum”，但如果我把字符串“ loreal ipsum”通过相同的函数，结果现在将是“loreal can ipsum”。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T17:09:34.297

```
$str = preg_replace('/(\blo[a-z]+\b)/', '$1 can', $str); 
```

RoBorg 回答的问题是：

1.  `\w`匹配数字和下划线，它们在人类语言中并不是*真正*的单词字符，因此它将匹配 'lo_fi' 或 '__lo__'。
2.  它还会匹配不以 开头的单词`lo`，例如“slorem”，甚至匹配`lo`以“allo”结尾的单词。

`\b`确保`lo`跟随一个分词（零宽度）并`[a-z]+`确保至少一个字母字符跟随'lo'。

编辑：我看到问题的文本说“包含”而不是“开始于”，在这种情况下，第一个`\b`可能会被省略。

编辑 2：请注意，这些解决方案都不是国际安全的。我没有对此进行测试，但 PHP 的 RegEx 非常有能力，所以我猜它会起作用：

```
$str = preg_replace('/(\blo[a-z\p{L}]+\b)/', '$1 can', $str); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T17:01:16.123

`$str = preg_replace('/lo(\w*)/', 'lo$1 can', $str);`

这将“lo”加上任何单词字符替换为“lo”+其他字符+“can”

它还将用“lo can”替换“lo” - 如果您不想要这个，请更改`\w*`为`\w+`

# user-interface - 如何设计多个查找

> ID：257052
> 
> 赞同：1
> 
> 时间：2008-11-02T16:57:28.563
> 
> 标签：user-interface

*   应用程序的用户希望将任务分配给程序员。
*   “编辑任务”表单呈现给用户。
*   弹出窗口（实际上是一个绝对定位的 div）窗口，所有程序员都可以从中选择。
*   程序员不在那里，所以用户要求“新程序员”屏幕。弹出窗口替换为“新程序员”表单。
*   用户填写数据，然后来到“Works at”字段。
*   （第 2 次或第 3 次）弹出窗口进入堆栈，其中包含所有“位置”可供选择。

这可以无限进行。

您如何设计您的应用程序，以避免查找/输入表单的无限堆栈？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T17:17:30.613

除了创建（递归）堆栈之外，您还可以将其设为仍需要输入的顺序信息队列（类似于向导）。即在您选择程序员的地方，一个项目会说“（新的 - 稍后会询问详细信息）”。如果它要成为一个向导，它应该到处都有来回按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T17:02:39.537

如果需要所有信息，并且系统中没有任何信息，那么我真的不知道如何避免出现那么多对话。

当然，您可以设计 UI，使其不具有侵入性 - 尽量使“选择地点”和“新地点”之间的过渡尽可能顺畅和无缝。特别是，我会尽量避免它使第一个对话框“消失”——也许只是让它扩展现有的对话框，折叠现有的选择。

听起来你在“谁”和“哪里”之间有一个适当的逻辑划分，我喜欢 - 我讨厌在同一个表单上输入完全不同的信息，即使减少了显示的表单总数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T17:04:07.847

尽量不要丢失屏幕的范围和目标。例如，在“程序员”屏幕中，您至少需要添加新程序员项目的基本细节。用户不应添加所有详细信息。如果用户想要添加更多详细信息，他应该稍后从相关的“添加程序员”屏幕添加。

在创建新过滤器时检查 GMail，例如，您需要添加新标签。

# git - 有没有办法将文件的特定版本添加到 git 索引？

> ID：257065
> 
> 赞同：3
> 
> 时间：2008-11-02T17:12:27.003
> 
> 标签：git

我问这个的原因是我不小心做了一个`git commit -a`包含一个我还不想提交的文件。我的解决方案是执行以下操作：

```
git reset --soft HEAD^
git reset -- file/with/changes_not_to_committed
git commit -C HEAD@{1} 
```

在这里，我在保留索引和工作树的同时将分支回绕一次，然后`file/with/changes_not_to_committed`从更旧的修订版中提取到索引中，然后使用来自前一个分支头提交的提交消息提交索引。两次调用都不会`git-reset`触及工作副本，因此我的修改会`file/with/changes_not_to_committed`持续存在，但不再记录在`HEAD`修订版中。

*但是，如果我可以在不触及工作副本*`file/with/changes_not_to_committed`的情况下将`HEAD^`修订版直接拉入索引，那会更容易。由于索引已经代表了我想要的状态，所以我可以修改提交，生成如下序列：*`HEAD`*

 *```
git magic-pony HEAD^ file/with/changes_not_to_committed
git commit --amend -C HEAD 
```

这*几乎*是我通过替换 得到的`git-magic-pony`，`git-checkout`除了要求工作副本保持不变并且只更新索引。似乎没有办法让`git-checkout`两者都不碰。

我的问题是：确实`git-magic-pony`存在，如果存在，以什么名字存在？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T05:14:40.137

对。当您想将修订从 HEAD 或其他修订移动到索引时，您使用 'git reset REVISION --file' - 然后，您将使用 'git commit --amend' 来修改提交。碰巧的是，我目前正在进行一项审查，旨在使文件如何从 A 移动到 B 更加明显。

Of course a much easier way is to crank up 'git-gui', click the 'amend last commit' button, then click on the icon by the file in the commit inventory section of the gui, and then 'commit'.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T17:46:19.790

看起来您可以使用以下方法执行以下操作[`git update-index`](http://kernel.org/pub/software/scm/git-core/docs/git-update-index.html)：

```
git update-index --cacheinfo 100644 5be7e154c284fb8de8ddca0bb18b72a73089df9b filename 
```

您将需要获取要返回的文件的模式（上面的 100644）和 sha1（您可以从 获取此信息[`git ls-tree`](http://www.kernel.org/pub/software/scm/git/docs/git-ls-tree.html)）。然后你可以`git commit --amend`并且你的工作副本不会受到影响。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T18:49:51.940

~~因此，根据 Greg Hewgill 的回答，`git-magic-pony`我将编写一个 shell 脚本，如下所示：~~

```
~~#!/bin/sh
git ls-tree "$@" | while read mode type hash path ; do
    git update-index --cacheinfo $mode $hash "$path"
done~~
```

# project-management - 微软项目

> ID：257074
> 
> 赞同：8
> 
> 时间：2008-11-02T17:19:45.727
> 
> 标签：project-management, ms-project

Microsoft Project 是管理软件开发或 IT 项目的最佳工具，还是有更好的替代工具？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-02T17:42:58.673

项目根本不适合*管理*开发。我发现它对安排/工作分解有点用处。

如果您使用 Microsoft 堆栈，[Team Foundation Server](http://msdn.microsoft.com/en-us/tfs2008/default.aspx)是一个很好的项目管理解决方案。它与 Project 集成以进行调度，还提供了源代码控制、工作项（任务/缺陷）跟踪和文档管理（通过 sharepoint）等要素。2008 版已经非常成熟，2010 版看起来很有前途，尤其是在需求规范和可追溯性领域。

您可以使用一堆开源和/或较便宜的现成软件来复制 TFS 功能，但集成起来需要更多工作。设置后哪个更灵活且更易于维护是值得商榷的。

无论平台如何，都需要以下内容：

*   错误跟踪
*   某种工作项目/故事/进度跟踪（可能由上面管理）
*   集体团队讨论（可能由上述管理 - 对工作项目的讨论，例如 FogBugz）
*   源代码控制（SourceSafe 除外）
*   运行单元测试的持续构建集成
*   即时消息（如果您的网络阻止了外部服务，OpenFire 非常有用）
*   文档库
*   虚拟化测试机农场（对安装/升级测试特别有用）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T18:19:15.327

我倾向于使用 MSProject 进行容量规划 - 一个很好的大范围的刷子，说明谁可以在一段时间内做什么，在一个抽象级别上，可以很容易地重新调整计划。对于实际工作的日常跟踪，我使用 Fogbugz。我认为它是用于战略规划的 MSProject/Gantty 东西，以及用于战术管理和规划的 Fogbugz。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T17:31:28.667

取决于您使用的流程 - 如果它是类似瀑布的流程，或者项目中有很多非软件部分（基础设施、制造、营销等），那么 Project 可以用于整体任务管理 - 它肯定与其他项目竞争类似的工具。

我认为任何“项目管理”工具（任务、WBS、甘特图等）都不能很好地管理在您进入主要软件开发阶段时发生的详细任务——我通常会在Excel 用于我参与的项目。

当然，成功管理一个非平凡的软件项目不仅仅是可以使用像 Project 这样的工具来管理的部分。它对管理需求、问题、缺陷、会议、测试开发等没有多大帮助——但它不应该这样做。

由于这些限制，我发现我通常在计划阶段从 Project 中获得最大价值——制定任务分解、需要完成的工作以及大致需要按什么顺序发生的事情。

正如艾森豪威尔所说：“在准备战斗时，我一直发现计划是无用的，但计划是必不可少的。” MS Project 是一个有用的规划工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-02T18:10:11.507

如果还需要一个免费且开放的 Project 替代方案，您可以使用 OpenProj： http: [//openproj.org/openproj](http://openproj.org/openproj)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T16:27:36.077

我们在这里使用[目标流程](http://www.targetprocess.com/)。它有一些“-isms”，但总的来说是一个很好的敏捷项目管理工具

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-22T17:00:47.283

我们已经成功地使用 MS Project 进行规划，但缺少与未安装 MS Project 计划的客户和同事共享的能力。这使我们产生了[在线 Microsoft Project 查看器](http://www.onlineprojectviewer.com/)的想法——一项允许在线查看和共享 MS Project 文件 (.mpp) 的服务，除了 MS Project：

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-02T17:25:33.780

我们在工作场所使用[Acunote](http://www.acunote.com/)，但我们遵循敏捷/Scrum 方法。

什么构成“最佳工具”取决于很多事情。你如何运行你的项目，谁将使用它们，等等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-02T17:28:20.903

至少对于软件开发来说，有许多更好的选择。其中一种嵌入在[Microsoft Visual Studio Team System](http://msdn.microsoft.com/en-us/vsts2008/default.aspx)中。您可能还想查看[Rally Software](http://www.rallydev.com)和[Version One](http://www.versionone.com)中的工具。后者非常适合敏捷方法，而前者同时支持敏捷和传统的 CMM 方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-02T17:48:27.603

好吧，考虑到即使项目团队也没有使用 Project for Project（来源：Joel Spolsky），我不想将它用于开发。

我在我们的 Bug Tracker 中跟踪我的开发任务，而项目文件只有“计划 1 周，开发 5 周，QA 3 周，部署 1 周”之类的内容，又名。一个非常广泛的概述。

至于 BugTracker，FogBugz 有这个很好的 Estimate-Tracking，我发现它对制定时间表非常有用，这对我来说只是另一个不使用 Project 的原因。

但话说回来，我不是项目经理，所以对我来说，项目只是一个不必要的复杂，不是真正的多用户友好和有点过时的感觉工具，用于建造房屋、高速公路或空间站，但不适用于软件.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T23:22:11.577

我们在我的项目中使用[Primavera 。](http://www.primavera.com/)它应该很棒，尽管它是迄今为止我还没有真正用于项目管理的唯一工具，所以我无法将它与其他任何东西进行比较。它不是那么容易上手，但它可以做我需要的一切（而且显然更多）。

我最喜欢的功能是内置的时间表功能，这意味着我的开发人员可以在周末预订他们的工作时间，这意味着我不需要不断地向他们抱怨他们是如何按照计划进行的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-06-09T10:55:25.967

*就我个人*而言，我不相信 ms 项目对软件开发人员有好处（我已经使用过它，我并不是为了成为纯粹主义者而抨击它）

如果您正在建造房屋或没有此类无法控制的变量的东西，那就太好了（例如，您会有多少错误？修复错误需要多长时间？会有多少功能蠕变？）

我喜欢让我的日程安排非常简单，以便更多人能够理解它们，因此我只使用谷歌电子表格

我使用的结构在此处进一步描述：[Project Schedules with Google Spreadsheets](http://pm4web.blogspot.com/2008/07/google-spreadsheets-for-project.html)

希望这可以帮助

--LM

# javascript - 在 JavaScript 中，“20”和 20 如何被认为是相等的？

> ID：257078
> 
> 赞同：4
> 
> 时间：2008-11-02T17:25:21.940
> 
> 标签：javascript, comparison, binary, operators, ascii

我知道使用“===”比较类型，因此运行以下代码会导致“不等于”，因为它将数字类型与字符串类型进行比较。

```
var a = 20;
var b = "20";
    if (a === b) {
        alert("They are equal");
    } else {
        alert("They are not equal");
} 
```

但我不明白如何使用“==”仅比较值导致“它们相等”消息。

```
var a = 20;
var b = "20";
    if (a == b) {
        alert("They are equal");
    } else {
        alert("They are not equal");
} 
```

值如何相等？字符串“20”不是存储为ASCII字符50和48（二进制的0110010和0110000）和20存储为实际的二进制数0010100吗？

编辑：谢谢大家！我认为所有的反应都很棒，并且帮助我更好地理解了这一点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-02T17:28:29.687

运算符仅比较变量的`==`值。如果类型不同，则进行转换。所以将数字 20 转换为字符串“20”并比较结​​果。

运算符不仅比较`===`值，还比较类型，因此不进行强制转换。在这种情况下`"20" !== 20`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T23:43:37.807

当需要类型转换时，JavaScript 会按如下方式转换 String、Number、Boolean 或 Object 操作数。

*   比较数字和字符串时，字符串将转换为数字值。JavaScript 尝试将字符串数字文字转换为数字类型值。首先，数学值是从字符串数字文字派生的。接下来，将此值四舍五入到最接近的数字类型值。
*   如果其中一个操作数是布尔值，则布尔操作数如果为真则转换为 1，如果为假则转换为 +0。
*   如果将对象与数字或字符串进行比较，JavaScript 会尝试返回该对象的默认值。运算符尝试使用对象的 valueOf 和 toString 方法将对象转换为原始值、字符串或数字值。如果转换对象的尝试失败，则会生成运行时错误。

== 比较的问题在于 JavaScript 版本 1.2 不执行类型转换，而版本 1.1 和 1.3 及以后的版本执行。

=== 比较从 1.3 版开始可用，是检查两个变量匹配的最佳方法。

如果您需要您的代码与 JavaScript 代码的 1.1、1.2 和 1.3 版本兼容，则应确保所有变量都匹配，就好像正在执行 === 比较一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T17:29:26.317

JavaScript 引擎将 a 视为一个数字，并在估值之前将 b 转换为数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-02T17:29:31.917

“==”的部分定义是，在可能的情况下，值将在比较之前转换为相同的类型。许多松散类型的语言都是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-02T17:30:13.567

Javascript 的设计使得包含数字的字符串被认为与该数字“相等”。这样做的原因是用户在输入字段中输入数字并且站点在 JS 中对其进行验证的情况下使用简单——您不必在比较之前将输入的字符串转换为数字。

它简化了一个常见的用例，并且 === 运算符仍然允许您与所考虑的类型进行比较。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T17:30:01.570

据我所知，JavaScript 会即时进行自动数据类型转换 - 所以变量可能会自动转换为等效类型。

# javascript - Javascript 无法在 IE 上运行

> ID：257085
> 
> 赞同：0
> 
> 时间：2008-11-02T17:29:26.610
> 
> 标签：javascript, internet-explorer

我有一个在 Firefox 和 Safari 上运行良好的 JavaScript 片段，但拒绝在 IE 上运行：

```
var drop= function(id)
{
   if(document.getElementById("select1").value == "Ficha de pediatria"){
    top.location.href = "print.jsp?id="+id+"&type=2";
   }
   else if(document.getElementById("select1").value == "Ficha normal"){
        top.location.href = "print.jsp?id="+id+"&type=1";
   }
}

<select id="select1" name="select1" onChange="drop(id);return false;">
<option>Imprimir:</option>
<option>Ficha de pediatria</option>
<option>Ficha normal</option>
</select> 
```

我修剪了它，因为它有更多的 JSP 代码，但它保持不变。有人知道为什么它不在 IE 上运行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-02T17:35:55.007

[编辑]对不起。我在第一篇文章中引入了一个错误，没有仔细查看你是如何构建你的 url 的。我不应该删除`id`参数。我已经更新了代码，它现在应该可以工作了。

试试这个：

```
function drop(ctl,id)
{
   var value = ctl.options[ctl.selectedIndex].value;

   if(value == "Ficha de pediatria"){
       window.top.location.href = "print.jsp?id="+id+"&type=2";
   }
   else if (value == "Ficha normal"){
       window.top.location.href = "print.jsp?id="+id+"&type=1";
   }
}

<select id="select1" name="select1" onChange="drop(this,id);return false;">
<option>Imprimir:</option>
<option>Ficha de pediatria</option>
<option>Ficha normal</option>
</select> 
```

[编辑] 一点解释...

我认为问题在于它如何访问 DOM。我不认为 IE 在选择上有 value 属性。我认为你必须通过选定的选项来解决它。另外，我不确定全局命名空间中是否存在 top 属性，但您应该能够通过`window.top`设置位置来获取它。最后，我做了一点改进，通过指定`this`为参数，您可以跳过元素查找并直接从作为参数传递的控件中引用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T20:32:09.923

IE 不喜欢你获取选择值的方式

```
document.getElementById("select1").value 
```

这就是说“给我选择元素中选定选项的 value 属性中的文本，id 为*select1*。您的选项没有任何值。当 Firefox 和 Safari 遇到这种歧义时，它们会返回选定的文本选项。当 Internet Explorer 遇到这种歧义时，它会返回一个空白字符串。如果您执行类似的操作，您的 javascript 将按原样工作

```
<select id="select1" name="select1" onChange="drop(this,id);return false;">
    <option value="Imprimir:">Imprimir:</option>
    <option value="Ficha de pediatria">Ficha de pediatria</option>
    <option value="Ficha normal">Ficha normal</option>
</select> 
```

如果这不可能，您将需要获取所选选项的*文本*。

```
var theSelect = document.getElementById("select1");
var theValue  = theSelect.options[theSelect.selectedIndex].text 
```

最后，虽然不是您的直接问题，但硬编码的*select1*并不是进入选择列表的最佳方式。考虑使用 this 关键字

```
function foo(theSelect){
    alert(theSelect.options);
} 
```

...

```
<select id="whatever" onchange="foo(this);">
...
</select> 
```

这有点通用，您将能够在具有任何 ID 的选择上使用您的函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-02T20:00:38.757

不是 IE“没有 .value”的 <select> 元素，而是你**没有为 <option> 元素指定任何值**。Firefox、Safari 等。可能会保护您免受此错误的影响。不过，您的元素应构造为：

```
<select ...>
<option value="Imprimir">Imprimir:</option>
<option value="Ficha de pediatria">Ficha de pediatria</option>
<option value="Ficha normal">Ficha normal</option>
</select> 
```

...您将看到 <select> 的 .value 属性的更多标准 x 浏览器行为。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2008-11-02T17:36:11.090

我看到两个可能的原因。

**1** - 声明函数的方式。我从来没有见过这样的，虽然我猜它有效。

也许尝试以下方法，看看它是否仍然不起作用：

```
function drop(id)
{
    // same code
} 
```

* * *

**2** - IE 中的 return false 并不总是正常运行（相信我，这取决于计算机）所以不要返回 false，请尝试：

```
onChange="drop(id);event.returnValue=false;return false;" 
```

如果可能的话，创建一个像这样的方法：

```
function CrossBrowserFalse()
{
     if(IE) // use whatever you want to detect IE
     {
         event.returnValue = false;
     }

     return false;
} 
```

然后在你的方法中你可以使用：

```
onChange="drop(id);return CrossBrowserFalse();" 
```

...是的，IE 有时（经常）很奇怪

* * *

如果这两个都失败了，至少确保你的 drop 函数被调用，如果你的 IDE 支持 javascript 的话，可以在其中放置一些警报或断点。

# c++ - 如何刷新 cin 缓冲区？

> ID：257091
> 
> 赞同：124
> 
> 时间：2008-11-02T17:31:59.430
> 
> 标签：c++, cin, io-buffering

如何清除 C++ 中的 cin 缓冲区？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-11-02T18:34:19.930

我更喜欢 C++ 的大小约束而不是 C 版本：

```
// Ignore to the end of file
std::cin.ignore(std::numeric_limits<std::streamsize>::max())

// Ignore to the end of line
std::cin.ignore(std::numeric_limits<std::streamsize>::max(), '\n') 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-11-02T17:37:55.347

可能：

```
std::cin.ignore(INT_MAX); 
```

这将读入并忽略所有内容，直到`EOF`. （您还可以提供第二个参数，它是要读取的字符（例如：`'\n'`忽略单行）。

另外：您可能还想`std::cin.clear();`在此之前执行：重置流状态。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2014-05-19T18:47:24.777

```
cin.clear();
fflush(stdin); 
```

这是从控制台阅读时唯一对我有用的东西。在所有其他情况下，它要么由于缺少 \n 而无限期地读取，要么会保留在缓冲区中。

编辑：我发现以前的解决方案让事情变得更糟。然而，这个有效：

```
cin.getline(temp, STRLEN);
if (cin.fail()) {
    cin.clear();
    cin.ignore(numeric_limits<streamsize>::max(), '\n');
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-12-29T20:50:59.237

我找到了两种解决方案。

第一个也是最简单的，`std::getline()`例如使用：

```
std::getline(std::cin, yourString); 
```

...当它到达换行符时将丢弃输入流。[在此处](http://www.cplusplus.com/reference/string/string/getline)阅读有关此功能的更多信息。

直接丢弃流的另一个选项是...

```
#include <limits>
// Possibly some other code here
cin.clear();
cin.ignore(numeric_limits<streamsize>::max(), '\n'); 
```

祝你好运！

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-10-09T09:26:06.807

```
int i;
  cout << "Please enter an integer value: ";

  // cin >> i; leaves '\n' among possible other junk in the buffer. 
  // '\n' also happens to be the default delim character for getline() below.
  cin >> i; 
  if (cin.fail()) 
  {
    cout << "\ncin failed - substituting: i=1;\n\n";
    i = 1;
  }
  cin.clear(); cin.ignore(INT_MAX,'\n'); 

  cout << "The value you entered is: " << i << " and its double is " << i*2 << ".\n\n";

  string myString;
  cout << "What's your full name? (spaces inclded) \n";
  getline (cin, myString);
  cout << "\nHello '" << myString << "'.\n\n\n"; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-11T20:30:29.077

怎么样：

```
cin.ignore(cin.rdbuf()->in_avail()); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-02T18:55:44.330

我更喜欢：

```
cin.clear();
fflush(stdin); 
```

有一个例子 cin.ignore 只是没有削减它，但我现在想不起来。不久前我需要使用它（与 Mingw 一起）。

但是，根据标准， fflush(stdin) 是未定义的行为。fflush() 仅用于输出流。fflush(stdin) 似乎只能在 Windows 上按预期工作（至少使用 GCC 和 MS 编译器）[作为 C 标准的扩展](http://msdn.microsoft.com/en-us/library/9yky46tz(v=vs.71).aspx)。

因此，如果您使用它，您的代码将无法移植。

请参阅[使用 fflush(stdin)](https://stackoverflow.com/questions/2979209/using-fflushstdin)。

另外，请参阅[http://ubuntuforums.org/showpost.php?s=9129c7bd6e5c8fd67eb332126b59b54c&p=452568&postcount=1](http://ubuntuforums.org/showpost.php?s=9129c7bd6e5c8fd67eb332126b59b54c&p=452568&postcount=1)作为替代方案。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-08-07T08:15:48.547

另一种可能的（手动）解决方案是

```
cin.clear();
while (cin.get() != '\n') 
{
    continue;
} 
```

我不能将 fflush 或 cin.flush() 与 CLion 一起使用，所以这很方便。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-09-25T17:45:29.373

最简单的方法：

```
cin.seekg(0,ios::end);
cin.clear(); 
```

它只是将 cin 指针定位在标准输入流的末尾，并且 cin.clear() 清除所有错误标志，例如 EOF 标志。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-05-19T15:27:10.200

它对我有用。我已经使用 getline() 的 for 循环。

```
cin.ignore() 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-02T17:34:44.790

以下应该有效：

```
cin.flush(); 
```

在某些系统上它不可用，然后您可以使用：

```
cin.ignore(INT_MAX); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-11-08T12:47:35.557

```
#include <stdio_ext.h> 
```

然后使用函数

```
__fpurge(stdin) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-03-19T21:38:44.077

`cin.get()`似乎很奇怪地自动刷新它（但可能不是首选，因为这令人困惑并且可能是喜怒无常的）。

# sql - 在 SQL Server 中计算值随时间的模式（或频率）分布

> ID：257093
> 
> 赞同：1
> 
> 时间：2008-11-02T17:35:00.483
> 
> 标签：sql, sql-server, frequency, mode

给定下表，如何计算每小时模式或每小时频率最高的值？

```
CREATE TABLE Values
(
    ValueID int NOT NULL,
    Value int NOT NULL,
    LogTime datetime NOT NULL
) 
```

到目前为止，我已经提出了以下查询。

```
SELECT count(*) AS Frequency, 
DatePart(yy, LogTime) as [Year], 
DatePart(mm, LogTime) as [Month],
DatePart(dd, LogTime) as [Day], 
DatePart(hh, LogTime) as [Hour]
FROM Values
GROUP BY 
Value,
DatePart(yy, LogTime), 
DatePart(mm, LogTime),
DatePart(dd, LogTime), 
DatePart(hh, LogTime) 
```

但是，这会按小时产生每个不同值的频率。如何添加约束以仅按小时返回具有最大频率的值？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T20:22:03.127

The following query may look odd... but it works and it gives you what you want. This query will give you the value that had the highest frequency in a particular "hour" (slice of time).

I am *NOT* dividing into Year, Month, Day, etc... only hour (as you requested) even though you had those other fields in your example query.

I chose to do "MAX(Value)" below, because the case can come up where more than one "value" tied for first place with the highest frequency by hour. You can choose to do MIN, or MAX or some other 'tiebreaker' if you want.

```
WITH GroupedValues (Value, Frequency, Hour) AS
    (SELECT
        Value,
        COUNT(*) AS Frequency,
        DATEPART(hh, LogTime) AS Hour
    FROM
        dbo.MyValues
    GROUP BY
        Value,
        DATEPART(hh, LogTime))

SELECT
    MAX(Value) AS Value,
    a.Hour
FROM
    GroupedValues a INNER JOIN
        (SELECT MAX(Frequency) AS MaxFrequency,
            Hour FROM GroupedValues GROUP BY Hour) b
    ON a.Frequency = b.MaxFrequency AND a.Hour = b.Hour
GROUP BY
    a.Hour 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T18:34:11.380

嵌套聚合...

```
SELECT
    MAX(Frequency) AS [Mode],
    [Year],[Month],[Day],[Hour]
FROM
    (SELECT
         COUNT(*) AS Frequency, 
         DatePart(yy, LogTime) as [Year], 
         DatePart(mm, LogTime) as [Month], 
         DatePart(dd, LogTime) as [Day], 
         DatePart(hh, LogTime) as [Hour]
    FROM 
         Values 
    GROUP BY 
         Value, 
         DatePart(yy, LogTime), 
         DatePart(mm, LogTime), 
         DatePart(dd, LogTime), 
         DatePart(hh, LogTime)
    ) foo
GROUP By
    [Year],[Month],[Day],[Hour] 
```

# excel - Visual Studio Tools for Applications 是 Office 2007 的一部分吗？

> ID：257096
> 
> 赞同：1
> 
> 时间：2008-11-02T17:35:59.517
> 
> 标签：excel, ms-office, vsta

我理解的 VSTO 位。Visual Studio 具有项目模板，可帮助您开始创建漂亮的基于 .NET 的加载项。

但是 VSTA 在哪里？我安装了 SDK，但它似乎是为了向您自己的应用程序添加可扩展性。

我曾认为 VSTA 就像 Office 2007 的新 VBA。Infopath 2007 似乎启用了 VSTA，但我似乎找不到 Excel 2007 也启用了 VSTA 的位置。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T14:35:25.947

据我了解，VSTA 不是“新 VBA”，也不是 Office 2007 内置的，而是一个单独的“带有 .NET 的超级 VBA”，必须从 Summit 获得许可，并作为外部应用程序的一部分分发。我认为它只是针对希望扩展 Office 的 ISV，但关于它的宣传也包含这个宝石：

> 企业 BDM 和 SI 最喜欢的功能可能是 VSTA 自定义可以由任何版本的 Visual Studio 无缝打开，使专业开发人员能够继续增强最初由最终用户开发人员创建的应用程序——这是许多企业要求的功能，因为应用程序经常变得越来越复杂随着时间的推移。

我没有费心在谷歌上搜索 BDM，SI 对我来说意味着 le Système International d'Unités，但我认为这意味着您可以接受 excel VBA 的可怕混乱，您的交易员过去常常将毫无价值的抵押贷款变成金矿 CDO（然后是救助） ，而您的“真正的开发人员”可以在 Visual Studio 中打开它并解决问题（或者干脆退出......）。

VBA 和 VSTA 也可以同时存在：http: [//blogs.msdn.com/vsta/archive/2006/07/31/684514.aspx](http://blogs.msdn.com/vsta/archive/2006/07/31/684514.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T09:13:48.857

如果我理解正确的话，VSTA 是一种新技术，它为应​​用程序供应商提供了一条“标准”的可扩展性捷径。因此，它将来可能会出现在 Office 应用程序中，也可能不会出现，但现在不存在。

如果 Excel、Word 等支持它，那么 UI（Visual Studio Shell？）应该作为包的一部分分发。

但我可能离基地很远...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-22T15:07:55.423

> VSTO 2005 可作为完整的开发环境自行安装

在这里阅读更多...

[http://msdn.microsoft.com/en-us/library/54ds2za4(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/54ds2za4(v=vs.80).aspx)

# php - PHP：一个函数能知道它是否被赋值为一个值吗？

> ID：257102
> 
> 赞同：4
> 
> 时间：2008-11-02T17:43:55.083
> 
> 标签：php, function

换句话说，可以`fn()`知道它被用作`$var = fn();`而不是用作`fn();`吗？

在后一种情况下，一个用例是`echo`返回值，但`return`在前一种情况下是返回值。

这可以在不向函数传递参数来声明它的使用方式的情况下完成吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-02T18:46:13.697

许多 PHP 函数通过传递一个名为 $return 的布尔值来执行此操作，如果 $return 为 true，则返回该值，如果 $return 为 false，则打印该值。几个例子是[print_r()](http://php.net/print_r)和[highlight_file()](http://php.net/highlight_file)。

所以你的函数看起来像这样：

```
function fn($return=false) {
    if ($return) {
        return 'blah';
    } else {
        echo 'blah';
    }
} 
```

任何其他方式都不是好的编程风格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T18:35:35.760

不，也不应该。函数不知道使用它们的上下文是语言的一个非常基本的前提。这允许您分解您的应用程序，因为每个部分（功能）都与周围环境完全隔离。

也就是说，您可以对这个特定用例做些什么，就是打开输出缓冲。默认情况下`echo`会将数据发送到标准输出，但您可以设置一个缓冲区，它将输出捕获到一个变量中。例如：

```
function foo() {
  echo "Hello World";
}
foo(); // will output "Hello World"
ob_start();
foo();
$foo = ob_get_clean(); // will assign the string "Hello World" into the variable $foo 
```

除此之外，直接输出函数通常被认为是不好的风格。您通常应该返回一个字符串并将其留给脚本的顶层输出。理想情况下，整个应用程序中应该只有一个 echo 语句。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T19:19:18.777

想想解释器是如何执行这个语句的：

```
$var = fn(); 
```

解释器使用赋值运算符从右到左计算操作数，因此首先它将计算右侧的表达式（`fn()`在这种情况下），然后将结果分配给`$var`. 每个表达式都返回一个值，您可以选择如何处理该值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T17:49:48.363

不，没有办法找出来。您可以做的唯一事情是获取调用堆栈 ( [http://it2.php.net/debug_backtrace](http://it2.php.net/debug_backtrace) ) 并检查它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T17:49:59.223

不，它不能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T17:54:30.023

它不容易做到，但是，如果你只是将一个额外的布尔变量传递给函数呢？这样，函数的结尾将如下所示：

```
if (namespace) {
    return $output;
} else {
    echo $output;
} 
```

似乎是一个非常简单的解决方法。

# svn - SVN 上的自动 JUnit 签入

> ID：257104
> 
> 赞同：1
> 
> 时间：2008-11-02T17:44:49.543
> 
> 标签：svn, junit, intellij-idea, hobbitmon

我正在使用 IntelliJ-Idea 编写 Java 守护程序。我们使用 JUnit 对我们的代码进行单元测试，并希望在签入到颠覆时自动运行。

是否有任何可用的工具可以自动运行单元测试，然后通过电子邮件和[Hobbit](http://hobbitmon.sourceforge.net/)发送报告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T17:49:28.100

我们使用[Hudson](http://hudson-ci.org/)作为我们的持续集成服务器。您可以设置作业以在特定时间间隔轮询您的 SCM 并在其上运行 Ant 任务。当检测到 SVN 中的新更改时，我们设置了运行构建和测试目标，然后在构建或测试目标失败时向参与项目的人员发送电子邮件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T18:05:43.247

正如其他人所建议的那样，我认为您应该研究持续集成。我个人尝试过 CruiseControl 和 Hudson，并且更喜欢 Hudson。您可以下载并运行它，看看您是否喜欢它，配置轻而易举，只需：

1.  [从http://hudson.dev.java.net](http://hudson.dev.java.net)下载 hudson.war 。
2.  以独立模式运行它（java -jar hudson.war）。
3.  将浏览器指向[http://localhost:8080](http://localhost:8080)进行配置和使用。

如果您使用 Maven 和 Ant，它内置了对它们的支持，但如果没有，您可以简单地编写自己的批处理文件/shell 脚本。

如果不能选择持续集成，您可以研究使用 Subversion 提交后挂钩 ( [http://svnbook.red-bean.com/en/1.0/svn-book.html#svn-ch-5-第 2.1 节](http://svnbook.red-bean.com/en/1.0/svn-book.html#svn-ch-5-sect-2.1)）。我没有为您描述的目的使用钩子的经验，所以我真的无法在这里提供很多帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T19:52:59.287

我们将 TeamCity 用于我们所有的 Java 项目。大多数情况下，我们将 junit 与 maven 一起使用，而 TeamCity 已经有一个 maven2 运行器，因此设置新的构建任务很容易。

你告诉 TeamCity 你的 svn trunk 在哪里，然后选择一个跑步者。

如果您已经使用 IntelliJ，则有一个 TeamCity 插件，因此如果您的测试在提交时通过，您可以获得即时反馈。如果你真的很懒，你可以在提交时选择远程运行，然后选择“仅在测试通过时提交”。

最后一点。TeamCity 不仅限于运行 java 测试，我们也使用它来运行 python 单元测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-02T17:48:37.057

我们使用 CruiseControl 自动构建项目并在提交更改时运行单元测试。如果构建/单元测试失败，它可以配置为发送电子邮件通知。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-02T17:51:09.907

不确定 Hobbit，但[TeamCity](http://www.jetbrains.com/teamcity/ "团队城市")是另一个不错的持续集成服务器。它可以配置为在 Subversion 提交时运行，并且有一个不错的 IntelliJ 插件。它也会发送电子邮件。

# c++ - 我如何写入文件的开头？C++

> ID：257111
> 
> 赞同：1
> 
> 时间：2008-11-02T17:49:45.370
> 
> 标签：c++, file

当我写入文件的开头时，它总是将第一行留空，然后从第二行开始写入。
我怎样才能让它从第一行开始写，包括第一行及以后？
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T17:52:41.043

如果我正确理解您的问题，您正在创建一个新文件或覆盖现有文件，然后该文件以您不想要的空行开头？如果是这样，您可能在没有意识到的情况下在开头打印出换行符（“\n”或 endl）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T17:53:41.447

听起来您在第一行之前输出换行符。你能发布一些有问题的代码吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T19:05:54.187

此外，如果文件不是新文件，请确保您没有以“附加”模式打开文件。

# c# - autoeventwireup 的性能成本是多少？

> ID：257112
> 
> 赞同：7
> 
> 时间：2008-11-02T17:49:47.880
> 
> 标签：c#, asp.net, performance

我一直在考虑提高我的 ASP.NET 页面性能。是否值得更改和`autoeventwireup`添加事件处理程序，或者性能损失非常小？`true``false`

这是一个 ASP.NET 2.0 项目。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T19:05:53.780

连线不是在编译时完成的。它在运行时完成。如本文所述：

[http://odetocode.com/Blogs/scott/archive/2006/02/16/2914.aspx](http://odetocode.com/Blogs/scott/archive/2006/02/16/2914.aspx)

由于每次创建页面时都必须调用 CreateDelegate，因此会降低性能。性能影响可能可以忽略不计，但它确实存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T15:29:16.773

来自 MSDN 文章。

[.NET 应用程序中的性能提示和技巧](http://msdn.microsoft.com/en-us/library/ms973839.aspx)

**避免使用 Autoeventwireup 功能**

不要依赖 autoeventwireup，而是覆盖 Page 中的事件。例如，不要编写 Page_Load() 方法，而是尝试重载 public void OnLoad() 方法。这允许运行时不必为每个页面执行 CreateDelegate()。

知识库文章：

[如何使用 Visual C# .NET 在 ASP.NET Web 窗体中使用 AutoEventWireup 属性](http://kbalertz.com/324151/AutoEventWireup-attribute-using-Visual.aspx)

**何时避免将 AutoEventWireup 属性的值设置为 true**

*如果性能是关键考虑因素，请不要将 AutoEventWireup 属性的值设置为 true。*AutoEventWireup 属性要求 ASP.NET 页面框架为每个 ASP.NET Web 窗体页面调用 CreateDelegate 函数。您必须手动覆盖页面中的事件，而不是使用自动连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T17:54:57.480

性能差异可以忽略不计。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-02T19:11:05.657

性能为 0，因为一旦连接（一旦您的应用程序在内存中编译），它就不必再这样做了。我的意思是，ASP.NET 框架不会不断地按名称遍历每个方法以查看是否应该连接它。

但是，我强烈建议您将其关闭，因为它通常会导致双页加载或其他问题（如果您自己连接事件，但由于以某种方式命名，ASP.NET 也会连接它）。

这是我希望默认关闭的功能。

# delphi - 如何让 TNMHTTP Get 方法响应重定向

> ID：257120
> 
> 赞同：3
> 
> 时间：2008-11-02T17:53:05.440
> 
> 标签：delphi

我在 Delphi 中使用 TNMHTTP 从网页中检索代码。代码比较简单：

```
NMHTTP1 := TNMHTTP.Create(Self);
NMHTTP1.InputFileMode := FALSE;
NMHTTP1.OutputFileMode := FALSE;
NMHTTP1.ReportLevel := Status_Basic;
NMHTTP1.TimeOut := 3000;

URL := 'http://www....';
NMHTTP1.Get(URL); 
S := NMHTTP1.Body; 
```

我在 try/except 块中捕获异常，但这不是问题。

问题是在 URL 是重定向时执行 NMHTTP1.Get 方法时，该方法不返回并且程序挂起。尽管我已经设置了 3000 秒的超时时间。

所以我看到了解决这个问题的三种可能方法（按照对我来说最容易到最难修改我的程序的顺序）：

1.  做任何必要的事情来让 NMHTTP1.Get 方法做出响应。

2.  在 NMHTTP1.Get 语句之前进行某种检查以查看 URL 是否是重定向并获取它重定向到的 URL。

3.  使用另一种方法使用 Delphi 获取网页。当我写这篇文章时，我使用的是 Delphi 4，没有 Indy。我现在有 Delphi 2009，所以如果没有简单的 #1 或 #2 答案，我愿意使用在其中工作的东西（可能是 INDY）。

我很想从对我有用的人那里得到答案。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-02T19:45:00.487

我可以建议你切换到 Indy。它们适用于许多网络协议（IRC 协议除外）。包含很好的示例，因此您可以自己检查工作示例。

还可以查看[http://www.indyproject.org/index.en.aspx](http://www.indyproject.org/index.en.aspx)了解有关 indy 的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T19:51:10.803

我会避免使用 NetMasters 控制，期间。

相反，您可以使用 Indy 的 IdHTTP 组件，该组件具有 RedirectMaximum 属性（默认为 15）和 OnRedirect 事件，以防您想要跟踪详细信息。

# nlp - （人类）文档的语言

> ID：257125
> 
> 赞同：4
> 
> 时间：2008-11-02T18:01:12.693
> 
> 标签：nlp, classification, language-detection

有没有办法（程序、库）大致知道文档是用哪种语言编写的？

我有一堆混合语言的文本文档（~500K）要导入启用 i18n 的 CMS（Drupal）..

我不需要完美匹配，只需要一些猜测。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-02T18:10:34.437

有一种非常简单的方法可以做到这一点，因为您拥有需要识别的所有不同语言的语料库数据。这称为 n-gram 建模。不过，我认为[Lingua::Identify](http://search.cpan.org/~ambs/Lingua-Identify-0.51/lib/Lingua/Identify.pm)已经这样做了，因此这是您最好的选择，而不是自己实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T18:05:13.030

似乎有一个 Perl 模块：[Lingua::Identify](https://metacpan.org/pod/Lingua::Identify)

保罗。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T18:06:15.600

我会说你最好的选择是寻找你正在寻找的语言所独有的关键词——文章之类的东西。例如，“Un”将同时出现在西班牙语和法语中，但“une”可识别为法语，而“unos”例如可识别为西班牙语。变音符号也很有用——你会在西班牙语和可能的葡萄牙语中看到“ñ”，在法语中看到“ç”以及其他一些……诸如此类的东西。

编辑 - 保罗的解决方案可能是最好的；看起来它使用了我概述的方法，再加上一些额外的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T18:07:52.120

通过运行 Google 搜索“[确定文档语言](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=WWh&q=determine+language+of+document&btnG=Search)”，我发现了许多不同的网站可以帮助您。第一页上的第三个链接最终将我引向了 Google Code API 中的一个[函数](http://code.google.com/apis/ajaxlanguage/documentation/#Detect)，这正是您所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T18:15:59.920

Google Translation API 很酷，并且有一个 REST 接口。但我需要向它发送大量 BIG 文档（是的，我可以使用摘录），即使 Google 是 Google，我也认为这不公平。

文件也不是我的，我问我的客户是否可以将它们发送给第三方（即使 G 迟早*会*得到它们；））。

我想我会走 Perl 的道路......

# c++ - 处理 Winnt.h 的奇怪编译错误

> ID：257134
> 
> 赞同：6
> 
> 时间：2008-11-02T18:06:43.697
> 
> 标签：c++, c, visual-studio, winapi

尝试通过 windows.h 编译包含 winnt.h 的文件时，出现以下错误：

```
我的Gl.cpp
..\microsoft sdks\windows\v6.0a\include\winnt.h(964)：错误 C2988：无法识别的模板声明/定义
..\microsoft sdks\windows\v6.0a\include\winnt.h(964)：错误 C2059：语法错误：'&'

```

他们指向 Winnt.h 中的以下行

```
extern "C++" // templates cannot be declared to have 'C' linkage
template <typename T, size_t N>
char (*RtlpNumberOf( UNALIGNED T (&)[N] ))[N];

#define RTL_NUMBER_OF_V2(A) (sizeof(*RtlpNumberOf(A))) 
```

关于发生了什么的任何想法？

我的编译器：

```
Microsoft (R) 32 位 C/C++ 优化编译器版本 15.00.21022.08 用于 80x86
版权所有 (C) 微软公司。版权所有。
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-02T18:51:00.580

至少有两种方法可以做到这一点。第一种是简单地包含`windows.h`在所有文件的顶部。然后`winnt.h`仅在需要时才包含。但是，我觉得这有点过分了——我认为没有必要在每个文件中都包含所有这些内容。

我所做的是在我的 C/C++ 头文件的最顶部（第一件事）。

```
#ifndef __wtypes_h__
#include <wtypes.h>
#endif

#ifndef __WINDEF_
#include <windef.h>
#endif 
```

这将为您提供数据类型、定义和基本的 Windows API。您可能还需要添加以下内容：

```
#ifndef _WINUSER_
#include <winuser.h>
#endif

#ifndef __RPC_H__
#include <rpc.h>
#endif 
```

WinNT 有点特殊 - 如果包含上述文件对您有用，请不要包含它。如果您确实需要它，请将其包含在`wtypes.h``windef.h'之后

如果这不起作用，请检查您的包含路径和预定义的宏，看看它们是否会破坏您的构建。

问候， Foredecker

# privacy - 用户对个人信息的所有权

> ID：257144
> 
> 赞同：3
> 
> 时间：2008-11-02T18:14:37.427
> 
> 标签：privacy

目前，似乎大多数 webapps 集中存储他们的用户数据。

我希望看到向用户提供对他们自己的个人信息和数据的完全访问权和所有权的趋势；最终允许用户选择他们的数据存储在哪里。

举个例子 - 对于像 facebook 这样的应用程序，用户的个人资料数据可以存在于他们拥有的任何设备（例如他们的手机）上……然后 facebook 会向用户请求数据，并加以利用。

有没有人看到这个想法成为现实？这是一个荒谬的想法吗？

澄清：

信息至少需要可缓存。这个想法背后的动机是让用户对自己的数据有更多的控制权——用户正在自行发布他们乐于看到的权威版本。

我在想象一个很大程度上取决于现在做出的选择的未来。也许数据的物理位置实际上并不重要 - 更多的是一种象征性的姿态......但我认为将我们的信息与使用它的公司之间的关系脱钩可能是一件积极的事情。

但也许，细节确实需要更多的工作;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T18:19:30.723

性能怎么了？想象一下，您想要搜索位于数百部手机或私有分布式系统上的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T23:05:22.707

I am with you on this one.

And I think the key technology might be RDF. Since protocols such as [F.O.A.F.](http://en.wikipedia.org/wiki/FOAF_(software)) are already used in these social applications, it is a small step from $Facebook storing your RDF Graph, to you storing it yourself, and saying: This is me, these are my friends, or anything else you might want someone to know.

This approach might be globalised to other personal information you might ened an authorised party to know, like Health Records.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-02T20:24:17.397

what your describing is simulator to a combination of [OpenID Attribute Exchange](http://openid.net/specs/openid-attribute-exchange-1_0.html), [Portable Contacts](http://portablecontacts.net/draft-spec.html) and [OpenSocial](http://code.google.com/apis/opensocial/). Having one repository of user data that every other provider would feed off. Its nice for a user but I would not go so far as to tie it to a specific device. Rather a federated identity that you control from one vendor's website/application.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T18:26:27.183

您的建议存在很多概念问题。

首先，每次您重新连接到系统时，您都需要将您的个人信息上传回系统，以便系统与您进行交互。这给远程系统的登录/握手/身份验证增加了相当大的开销。

其次，许多在线系统（尤其是在线社区）依赖于您留下自己的在线个人资料，以便在您自己离线时其他用户可以（通过您的个人资料）与您互动。这些数据必须保存在某个中心位置。

至少，在线系统需要一个非常基本的配置文件来代表您，以便您可以登录和验证……这听起来与您的建议相矛盾。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T18:29:04.963

如果用户实际拥有数据，性能将受到影响；例如，拇指驱动器、本地驱动器。但是，如果“填充单元”解决方案是可能的，其中用户对应用程序可以快速访问的保险库拥有完全的权限，那么就有可能。

这真的不是技术解决方案，而是公司政策之一。Facebook 可以轻松制定一项政策，声明您的记录是您的，就像银行应该做的那样。他们只是没有。就此而言，许多其他本应保护我们的个人信息的机构——如果我能唤起约翰洛克的话，就是我们的财产——但却惨遭失败。如果他们审查了违反政策的做法并且是诚实的，那么您可以信任。不幸的是，这并没有发生。

美国国税局、国土安全部和其他机构将始终要求机构提供对资产的访问权。在当前的气候下，我看不出如何允许个人实际拥有银行或机构将在线使用的电子记录。

不要误解我——我认为你的想法是一个很好的追求，但它更多的是公司政策问题而不是技术解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T19:12:55.420

您需要澄清所有权的含义。您是否试图确保数据仅存储在您自己的设备上？正如其他人所指出的，这将使建立社交网络变得不可能。例如，当你没有连接到 Facebook 时，你就会从 Facebook 上消失。

或者您是否试图确保存在一个单一的权威副本并且服务遵循它？这可能更有可能，并且需要尽可能将手机上的主副本与服务器同步。

或者您是否试图确保您可以随时编辑/删除您的帐户？大多数网站已经像这样工作了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-02T19:21:43.670

用户仍然不能确定他们“拥有”他们的数据，仅仅是因为他们每次连接时都必须上传数据，而数据被发送到的公司仍然可以用它做任何想做的事情。当您不在线时，它可能不会显示您的个人资料，但仍会在某处保留一份副本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T17:12:40.740

个人信息和数据的总访问权、所有权和位置选择是一个有趣的目标，但您的示例说明了一些基本的架构问题。

例如，Facebook 实际上是一种发布机制。您在公开资料中发布的任何内容基本上都离开了您可以合理期望保密的信息领域。因此，我们假设公共论坛超出了您的想法范围。

在您*可以*期望保密的领域内，我非常喜欢将加密与物理和网络安全相结合，以平衡对性能的需求。你以手机为例。在这种情况下，您几乎肯定会遇到至少三个问题：

1.  手机使用什么加密方式？任何？
2.  物理安全风险相当高 - 您是否曾经有过昂贵的便携式电子设备被盗？那里似乎有相当多的被盗电话市场......
3.  手机成为网络热点 - 每项需要您的信息的服务都需要与您的手机建立单独的连接，然后才能满足请求。你的手机需要开机，你需要有足够丰富的数据管道，等等。

然而，如果你改变你的想法，很明显，任何需要持久存储敏感私人信息（又名 SPI）的组织都应该满足一些基本的（和可审计的）要求：

1.  表明需要持久化信息：许多 Web 服务已经问“我应该记住你吗？” 或“你想创建一个帐户吗？” 我认为默认答案应始终为“否”，除非我另有明确说明。
2.  不得转售或分享 SPI。如果我没有告诉我的银行或我的书店他们可以分享我的人口统计信息，他们就不应该这样做。诚然，我的电话号码和地址在书中，所以我不能指望我会远离每个邮件列表，但这至少会使电话推销员的事情变得不那么方便。
3.  一直加密。我的 SPI 永远不应该明文存储。
4.  物理安全无时无刻不在。我的 SPI 永远不应该在笔记本电脑驱动器上。

鉴于以上所有情况，您有可能部分实现控制 SPI 传播的目标。它不会是完美的。在您输入任何内容的那一刻，立即存在非零风险，即某个地方的某个人以某种方式想办法监控或捕获它。即便如此，您仍然可以控制您的信息去向，相信它只会去您告诉它去的地方，并且它被盗的可能性会有所降低。

*诚然，这是连续说了很多黄鼠狼的话....*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-27T20:59:20.363

我们目前正在开发一个平台，允许人们针对此类数据的任何持有者行使访问其个人数据（人身保护数据）的权利。

实际上，我们并没有遵循您建议的方法，而是采用不同的策略：每当个人想要访问她的数据时，我们都会对“数据持有者”的 ddbb 中的个人数据进行快照。

我们的目标是让人们自由管理自己的个人数据，允许他们在事先同意的情况下与他人共享。

如果您有兴趣，我想与您进一步讨论。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-02T20:33:16.333

Please read [Architecture Astronauts](http://www.joelonsoftware.com/items/2008/05/01.html).

# c++ - 位运算符在 C++ 中附加两个无符号字符

> ID：257152
> 
> 赞同：1
> 
> 时间：2008-11-02T18:19:18.523
> 
> 标签：c++, bit-manipulation, bit, bit-shift

如果我有两件事是十六进制的，我可以有人如何将他们的二进制文件附加在一起以获得一个值吗？

在 C++ 中，说我有

```
unsigned char t = 0xc2;  // 11000010
unsigned char q = 0xa3;  // 10100011 
```

我想要的是不知何故， `1100001010100011`这可能使用按位运算符吗？

我想提取 t 和 q 的二进制形式并附加它们......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-02T18:52:02.887

是的，这是可能的。

只需使用 left-bitshift 运算符，向左移动 8 位，至少使用 16 位整数。然后二进制或第二个值到整数。

```
unsigned char t = 0xc2; // 11000010 
unsigned char q = 0xa3; // 10100011
unsigned short s = (((unsigned short)t)<<8) | q; //// 11000010 10100011 
```

或者，将两个值放在包含 2 个字符的联合中（注意大端或小端）将具有相同的位级别结果。另一种选择是 char[2]。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T18:53:25.553

连接两个字符：

```
unsigned char t = 0xc2;  // 11000010
unsigned char q = 0xa3;  // 10100011

int result = t;  // Put into object that can hold the fully concatenated data;
result <<= 8;     // Shift it left
result |= q;     // Or the bottom bits into place; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T18:25:56.920

您的示例并不能很好地工作，因为未定义输入值的宽度（通常为 8 位）。例如，为什么不是您的示例：0000000100000010，这将真正按位附加 1 (00000001) 和 2 (00000010)。

如果每个值都具有固定宽度，*则*可以通过位移和 ORing 值来回答

编辑：如果您的“宽度”定义为删除所有前导零的全宽度，则可以使用移位和 ORing，但更复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T21:31:28.527

我会选择 char 数组。

无符号短小号；字符 * sPtr = &s; sPtr[0] = t; sPtr[1] = q;

这并不真正关心字节序。我不确定您为什么要这样做，但这会起作用。

位方法的问题是你不确定你有什么大小。如果你知道大小..我会和布莱恩一起回答

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-02T18:22:15.583

二进制/十六进制中没有附加，因为您正在处理数字（您可以附加 1 和 2 并且不会将结果 12 与“真实”12 混淆吗？）

你可以用一些特殊的符号来分隔它们，但你不能只是“连接”它们。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-02T18:27:18.943

附加为操作对于数字来说并没有什么意义，不管它们的基数是什么。使用 . 作为连接运算符：在您的示例中， 0x1 。如果连接十六进制，0x2 变为 0x12，如果连接二进制，则变为 0b101。但是 0x12 和 0b101 不是同一个值（以 10 为底，它们分别是 18 和 5）。一般来说，AOB（其中 A 和 B 是数字，O 是运算符）应该产生相同的值，无论您在什么基础上进行操作。

# ruby-on-rails - Ruby on Rails XML 生成

> ID：257157
> 
> 赞同：1
> 
> 时间：2008-11-02T18:20:16.773
> 
> 标签：ruby-on-rails, xml, ruby, file-io

我正在尝试构建一个简单的方法，该方法可以从 ruby​​ on rails 中的数据库创建 XML 文件。我觉得我的代码是正确的，但我没有看到 XML 中的所有用户。
我是 RoR 的新手。

这是我的代码：

```
def create_file     
  @users = User.find(:all)
  file = File.new('dir.xml','w')
  doc = Document.new

  make = Element.new "make"
  @users.each do |y|
    make.add_element "name"
    make.elements["name"].text  = y.name
    make.add_element "description"
    make.elements["description"].text = y.description
  end    

  doc.add_element make

  file.puts doc
  file.close
end 
```

我的 XML 输出：

```
<make>
 <name>sammy</name><description>samsdescription</description>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
 <name/><description/>
</make> 
```

我不明白为什么没有填充所有字段。为什么只显示一个数据库整体？我真的很感激帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T02:09:48.357

You ought to investigate `@users.to_xml` to see if it is something you could use instead of rolling your own solution. Read more about it in the [Rails API docs](http://api.rubyonrails.com/classes/ActiveSupport/CoreExtensions/Array/Conversions.html#M000798).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T18:33:41.427

您的代码中有一个错误。在每次迭代中，您创建一个元素，[`add_element`](http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/classes/REXML/Element.html#M003015)然后尝试使用 访问该元素[`Elements#[]`](http://ruby-doc.org/stdlib/libdoc/rexml/rdoc/classes/REXML/Elements.html#M002900)。但是当您在其中使用节点名称时，`Elements#[]`它只返回第一个匹配的节点。因此，您在每次迭代中都创建一个节点，但只更新第一个节点。尝试将代码更改为以下内容：

```
@users.each do |y|
  name_node = make.add_element "name"
  name_node.text  = y.name
  desc_node = make.add_element "description"
  desc_node.text = y.description
end 
```

By the way, your XML structure is a bit strange. Wouldn't it be more clear if you wrapped every name/description pair inside another node (say, *user*) and then have many *user* nodes?

# .net - 更改 .NET 中的日志操作？

> ID：257170
> 
> 赞同：6
> 
> 时间：2008-11-02T18:26:47.057
> 
> 标签：.net, windows, ntfs

我正在寻找执行[更改日志操作](http://msdn.microsoft.com/en-us/library/aa363801(VS.85).aspx)的 .NET/C# 方式（不导入非托管代码）。

任何提示或 RTM 链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-09-19T20:19:46.290

这看起来很有希望（在 C# 中）：

[http://mchangejournal.codeplex.com/](http://mchangejournal.codeplex.com/)

您必须下载源代码，因为没有官方版本。我能够运行演示（在 Windows 7 上），但无法查看更改了哪些文件。这个库可能还处于起步阶段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T18:32:58.527

这可能有用

[http://www.codeproject.com/KB/files/Eyes_on_NTFS.aspx](http://www.codeproject.com/KB/files/Eyes_on_NTFS.aspx)

# jquery - 基于浏览器的大纲库

> ID：257188
> 
> 赞同：12
> 
> 时间：2008-11-02T18:44:06.243
> 
> 标签：jquery, ajax, browser, gpl, outlining

我正在寻找可在浏览器中运行的免费（GPL 或 BSD 类型许可）大纲库。

它不必太复杂，只需允许键盘控制折叠和展开项目，并更改它们的顺序。

有人知道这方面的好图书馆吗？任何大型 UI 组件库都有大纲吗？如果没有，我将如何从头开始编写它？（例如，从 jQuery 开始会更好吗？还是别的什么？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-05-30T18:37:13.137

nestedSortable [jQuery 插件](http://mjsarfatti.com/sandbox/nestedSortable/)可能是一个不错的起点。下面是在每个可拖动和可嵌套中使用表单字段的示例`<li>`。然后只需实现一些东西来处理键盘缩进并输出适当的数据数组或序列化字符串等。

## **演示：[jsfiddle.net/Marcel/YUDHG/2](http://jsfiddle.net/Marcel/YUDHG/2/show/)**（[编辑](http://jsfiddle.net/Marcel/YUDHG/2/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-11T13:53:11.330

除了 Serhii 的建议，您还想使用 jquery-ui**可排序**功能。检查他们的演示代码以获取示例。[http://docs.jquery.com/UI/Sortable](http://docs.jquery.com/UI/Sortable)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T18:06:52.430

The most difficult part will be enabling the keyboard to control the collapsing and expanding. The same functionality using only mouse events is pretty easy and you should find examples [googling](http://www.google.es/search?q=jquery+outliner)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-25T00:22:49.487

For changing order of elements with expansion and collapse i really like and have used [Quicksand](http://razorjack.net/quicksand/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-13T16:20:06.943

大多数现有 javascript 库提供的最接近的东西是手风琴。您很可能需要一些自定义代码才能使用击键和外观。这是[10 个 Javascript Accordian 脚本](http://tutorialblog.org/10-javascript-accordion-scripts/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-05T10:58:03.780

我推荐kendoui的treeview： [http ://demos.kendoui.c​​om/web/treeview/index.html](http://demos.kendoui.com/web/treeview/index.html)

它有你需要的一切，还有一些。

# wcf - 设计高可用性 Web 服务池的最佳方法是什么？

> ID：257189
> 
> 赞同：1
> 
> 时间：2008-11-02T18:44:10.453
> 
> 标签：wcf, web-services, failover, high-availability

我听到很多人吹捧使用基于 Linux 的代理来处理路由以实现 Web 应用程序的高可用性，但其他人在使用 Web 服务做什么？我有一组 WCF 服务需要迁移到高可用性（故障转移）模型，这意味着如果托管 WCF 服务的特定服务器出现故障，请求将被路由到银行中的另一台服务器。我宁愿远离实施基于 Linux 的解决方案，因为环境中没有 Linux 知识渊博的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T19:32:17.143

> 我宁愿远离实施基于 Linux 的解决方案，因为环境中没有 Linux 知识渊博的人。

这可能是不使用基于 Linux 的解决方案的充分理由。**做好**您描述的事情需要合理的专业知识，而不仅仅是简单的配方方法和大量维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T13:59:26.893

如果您不需要持久性，您可以像普通 Web 请求一样对 WCF 服务请求进行负载平衡，而无需执行任何特殊操作。如果您需要持久性并且希望请求在中途被切断，请使用 netMsmqBinding。

# mysql - MySQL：获取行集中每个排序列的差异

> ID：257190
> 
> 赞同：1
> 
> 时间：2008-11-02T18:44:37.100
> 
> 标签：mysql, stored-procedures

这是一个带有表格字符的简单场景：

```
CharacterName GameTime Gold Live
Foo 10 100 3 
Foo 20 100 2 
Foo 30 95 2 
```

如何获得查询的输出`SELECT Gold, Live FROM characters WHERE name = 'Foo' ORDER BY GameTime`：

```
Gold Live
100 3
0 -1
-5 0 
```

如果可能的话，使用 MySQL 存储过程（或查询）？我想过使用 2 个数组，就像通常在服务器端语言中所做的那样，但 MySQL 没有数组类型。

虽然我知道用 PHP（我的服务器端语言）可能更容易做，但我想知道它是否可以在 MySQL 中做，只是作为一种学习材料。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T19:00:25.057

你的桌子上有身份证吗？

```
GameID      CharacterName GameTime    Gold        Live
----------- ------------- ----------- ----------- -----------
1           Foo           10          100         3
2           Foo           20          100         2
3           Foo           30          95          2 
```

如果是这样，您可以对自身进行交错连接

```
SELECT
    c.CharacterName, 
    CASE WHEN c_offset.Gold IS NOT NULL THEN c.Gold - c_offset.Gold ELSE c.Gold END AS Gold,
    CASE WHEN c_offset.Live IS NOT NULL THEN c.Live - c_offset.Live ELSE c.Live END AS Live
FROM Characters c 
    LEFT OUTER JOIN Characters c_offset
        ON c.GameID - 1 = c_offSet.GameID
ORDER BY
    c.GameTime 
```

本质上，它将每个游戏行连接到前一个游戏行，并在值之间进行差异。这将为我返回以下内容。

```
CharacterName Gold        Live
------------- ----------- -----------
Foo           100         3
Foo           0           -1
Foo           -5          0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T19:06:02.843

使用临时表的一种可能解决方案：

```
CREATE TABLE characters_by_gametime (
  id INTEGER AUTO_INCREMENT PRIMARY KEY,
  gold INTEGER,
  live INTEGER);

INSERT INTO characters_by_gametime (gold, live)
SELECT gold, live
FROM characters
ORDER BY game_time;

SELECT
  c1.id,
  c1.gold - IFNULL(c2.gold, 0) AS gold,
  c1.live - IFNULL(c2.live, 0) AS live
FROM
  characters_by_gametime c1
  LEFT JOIN characters_by_gametime c2
    ON c1.id = c2.id + 1
ORDER BY
  c1.id; 
```

当然，如果您的*id*列遵循您在输出中想要的顺序，那么 Eoin 的解决方案会更好。

# c# - 如何突出显示在 Winforms TextBox 中以编程方式进行的选择

> ID：257209
> 
> 赞同：5
> 
> 时间：2008-11-02T18:58:50.020
> 
> 标签：c#, winforms, textbox, selection

我在这里没有进行太多研究，但是直观的东西不起作用：

```
private void SerachButton1_Click(object sender, EventArgs e)
{
   String serchTerm = searchTerm1.Text;
   String text = usualTextBox.Text;

   Int32 index = text.IndexOf(serchTerm);

   if (index >= 0)
   {
      usualTextBox.Select(index, serchTerm.Length);
   }
} 
```

`SelectedText`,`SelectionLength`和`SelectionStart`属性是我所期望的，`Select`但没有可见的选择。

我在这里做错了什么？

编辑：我也试过了`RichTextBox`。当我为选择设置背景和文本颜色时，它会显示出来，但是当您手动选择文本的另一部分或仅单击文本中的某个位置时，它不会自动取消选择。这两种选择是否本质上不同，如果您以编程方式选择，您还必须以编程方式取消选择？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-02T19:13:31.067

您需要设置`usualTextBox.HideSelection`为`false`以便在焦点不在`TextBox`.

# .net - 为什么添加项目引用会破坏我的构建？

> ID：257220
> 
> 赞同：0
> 
> 时间：2008-11-02T19:09:24.227
> 
> 标签：.net

## 解决方案结构【Plain Winforms + VS 2008 Express Edition】

*   CoffeeMaker 接口 (NS CoffeeMaker)
*   CoffeeMakerSoftware (NS CoffeeMakerSoftware)
*   TestCoffeeMaker (NS TestCoffeeMaker)

CoffeeMakerSoftware proj 引用 CoffeeMakerInterface。TestCoffeeMaker proj 引用 CoffeeMakerInterface 和 CoffeeMakerSoftware。

现在让我发疯的事情。我无法构建它。**如果我从 TestCoffeeMaker 中删除 CoffeeMakerSoftware 项目引用，它会构建（？？！！）..一旦我添加第二个项目引用，它就会抛出构建错误**，声称在第一个引用中声明的类型“无法找到..你错过了装配参考'

起初我有前 2 个程序集具有相同的命名空间 CoffeeMaker.. 然后我使它们不同（尽管我认为跨程序集属于同一个 NS 的类应该是可能的）但即使这样似乎也不是。

叫更多的眼球。任何指针..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T07:44:15.903

I broke my 'Don't code when you're tired' dictum. I zipped it up, went to sleep and looked at it today.. found the issue by looking at the output window. *(FWIW everything was CopyLocal=True and nothing in GAC. This is Bob Martin's OOD problem from the Agile PPnP book.. coming up with good names was particularly hard)*

```
1\. CoffeeMaker > CoffeeMakerInterfaces
2\. [X]         > CoffeeMaker            > CoffeeMakerSoftware
3\. [X]         > TestCoffeeMaker 
```

That's how I added and renamed the projects in chronological order. Apparently renaming the Assembly via solution explorer, doesn't change the name of the produced binary or throw up a warning. As a result, #1 and #2 both were producing CoffeeMaker.dll as the output. Adding Reference#2 to the TestCoffeeMaker rendered all the types defined in reference#1 as unknown with the ever popular

> "Error 2 The type or namespace name 'CoffeeMaker' could not be found (are you missing a using directive or an assembly reference?) C:\Documents and Settings\pillaigi\Desktop\CoffeeMaker\TestCoffeeMaker\FakeCoffeeMakerDevice.cs 4 7 TestCoffeeMaker"

**Solution: Open Project properties and examine if the "Assembly name:" in project properties for each (ref or otherwise) project is unique and doesn't clash.**

Maybe not enough people do this.. the IDE or compiler could easily catch this one 'If referenced assemblies have the same binary name... please fix it.. you will anyway' I've done this to myself once before.. Making a BIG note to myself this time. Now excuse me while I wear my Dunce cap and sit in the corner.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T20:46:56.573

A few things to check:

*   Ensure "copy local" is TRUE for all project references
*   If any are set to false, check the GAC for old builds of your libraries

If all this fails, remove all projects from the solution, create a new solution and add the projects back. Yeah, it's voodoo, but this has got me past silly mistakes before. ;-)

# asp.net - Asp.net 多语言 Web 应用程序 - 本地化

> ID：257221
> 
> 赞同：1
> 
> 时间：2008-11-02T19:09:43.460
> 
> 标签：asp.net, localization, resources

您对构建 asp.net 多语言本地化 Web 应用程序（仅字符串资源的 UI 本地化）的最佳方法有何看法。尤其是这两件事：

1.  如何存储资源？XML 文件、resx 文件或其他文件？
2.  如何处理 URL？我不想一直在查询字符串中保留语言参数，所以我可能需要使用 URL 重写？

/BR

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T19:18:45.767

您是否研究过 ASP.NET 中的本地化支持？它使用资源程序集并根据浏览器的设置设置默认资源。您还可以通过为处理请求的线程设置文化和 uiculture 设置来覆盖该设置。

如果您不喜欢使用资源程序集（当您想要进行更改时确实需要重新构建项目），您还可以为 ASP.NET 创建自定义资源提供程序（[此链接](http://www.leftslipper.com/ShowFaq.aspx?FaqId=9)以 MS Access 为例，您可以尝试为 SQL 或其他提供程序定制它）。

[http://asp.net](http://asp.net)有一些教程可以帮助您入门，比如[这个](http://www.asp.net/learn/videos/video-40.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-26T10:47:42.277

使用数据驱动的 ASP.NET 本地化资源提供程序，如[http://www.west-wind.com/presentations/wwdbresourceprovider/中所述](http://www.west-wind.com/presentations/wwdbresourceprovider/)

# excel - 将输入整数写入单元格

> ID：257229
> 
> 赞同：7
> 
> 时间：2008-11-02T19:16:21.810
> 
> 标签：excel, vba

我自己正在编写一个快速应用程序 - 第一个项目，但是我正在尝试找到用于将输入字符串的结果写入 Excel 中的命名单元格的 VBA 代码。

例如，输入框会询问“您想将哪个作业编号添加到列表中？”......然后用户将输入参考编号，例如“FX1234356”。然后宏需要将该信息写入一个单元格，然后我可以使用它来完成宏（基本上是在某些数据中搜索）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-02T19:33:33.600

您可以使用 VBA 中的 Range 对象来设置命名单元格的值，就像任何其他单元格一样。

```
Range("C1").Value = Inputbox("Which job number would you like to add to the list?) 
```

其中“C1”是您要更新的单元格的名称。

我的 Excel VBA 有点老旧，所以在新版本的 Excel 中可能有更好的方法来做到这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T01:17:33.640

我建议始终使用命名范围（如您所建议的那样），因为如果添加或删除任何列或行，名称引用将更新，而如果您对单元格引用进行硬编码（例如“H1”，如的响应）在 VBA 中，那么它将不会更新并指向错误的单元格。

所以

```
Range("RefNo") = InputBox("....") 
```

比安全

```
Range("H1") = InputBox("....") 
```

您也可以设置多个单元格的值。

```
Range("Results").Resize(10,3) = arrResults() 
```

其中 arrResults 是至少 10 行和 3 列的数组（可以是任何类型）。如果你用这个，把这个

```
Option Base 1 
```

在 VBA 模块的顶部，否则 VBA 将假定数组从 0 开始，并在工作表中放置空白的第一行和列。此行使所有数组默认从 1 开始（这在大多数语言中可能是异常的，但适用于电子表格）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-17T02:57:31.437

[当要求用户使用InputBox 方法](https://msdn.microsoft.com/en-us/library/office/aa195768%28v=office.11%29.aspx)将响应放入单元格时，通常会发生三件事¹。

1.  用户输入内容并单击`OK`。这是您期望发生的事情，您将收到可以直接返回到单元格或声明的变量的输入。
2.  用户单击`Cancel`、按下`Esc`或单击`**×**`（关闭）。返回值是一个布尔值**False**。这应该被考虑在内。
3.  用户不**输入**`OK`任何内容，但无论如何都会单击。返回值是一个长度为零的字符串。

如果您将返回值放入一个单元格中，您自己的逻辑流将决定您想要对后两种情况执行什么操作。您可能想要清除单元格，或者您可能想要单独保留单元格内容。以下是如何使用变体类型变量和[Select Case 语句](https://msdn.microsoft.com/en-us/library/office/gg278665.aspx)处理各种结果。

```
 Dim returnVal As Variant

    returnVal = InputBox(Prompt:="Type a value:", Title:="Test Data")

    'if the user clicked Cancel, Close or Esc the False
    'is translated to the variant as a vbNullString
    Select Case True
        Case Len(returnVal) = 0
            'no value but user clicked OK - clear the target cell
            Range("A2").ClearContents
        Case Else
            'returned a value with OK, save it
            Range("A2") = returnVal
    End Select 
```

* * *

¹[第四种情况是使用特定类型的**[InputBox 方法](https://msdn.microsoft.com/en-us/library/office/aa195768%28v=office.11%29.aspx)**。InputBox 可以返回公式、单元格范围错误或数组。这些是特殊情况，需要使用非常具体的语法选项。有关更多信息，请参阅提供的链接。]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T19:39:08.207

我已经用一个包含 TextBox 的表单完成了这种事情。

因此，如果您想将其放入 say cell`H1`中，请使用：

`ActiveSheet.Range("H1").Value = txtBoxName.Text`

# c# - Howto：在没有 CameraCaptureDialog 的情况下在 windows mobile 中拍照？

> ID：257232
> 
> 赞同：2
> 
> 时间：2008-11-02T19:18:49.730
> 
> 标签：c#, windows-mobile, camera, sharpdevelop

我想创建一个 windows 移动应用程序（windows mobile 5.0 及更高版本，使用 CompactFramework [在 SharpDevelop 中]）自动捕捉照片，无需用户参与（就像使用 CameraCaptureDialog 一样）。经过谷歌搜索后，我发现了一个应该有效的解决方案（[http://blogs.msdn.com/marcpe/archive/2006/03/03/542941.aspx](http://blogs.msdn.com/marcpe/archive/2006/03/03/542941.aspx)）[1](http://blogs.msdn.com/marcpe/archive/2006/03/03/542941.aspx)但我无法编译源代码（我猜是因为我使用的是sharpdevelop而不是MS Visual Studio）。

*   还有其他选择吗？
*   也许某处有该 CameraCapture 库的二进制版本，所以我可以在不自行编译的情况下使用它？
*   任何愿意编译我上面链接的并将其发布到某个地方以提供二进制版本的人[我尝试在谷歌中搜索，但没有成功]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:11:02.883

CameraCaptureDialog 是 Microsoft.WindowsMo​​bile.Forms 程序集的一部分，该程序集在 WinMo 5.0 和更高版本设备的 ROM 中芯片。设备 SDK 还附带这些程序集的副本，以便可以构建应用程序（例如，我的 PC 位于 C:\Program Files\Windows Mobile 5.0 SDK R2\Managed Libraries）。我假设您应该能够在 SharpDevelop 中手动添加对该程序集的引用。

# jquery - 拥有“位置：固定”（始终在顶部）div的最简单的jQuery方法是什么？

> ID：257250
> 
> 赞同：37
> 
> 时间：2008-11-02T19:34:30.713
> 
> 标签：jquery, css, positioning

我对 jQuery 比较陌生，但到目前为止我所看到的都是我喜欢的。我想要的是让 div （或任何元素）位于页面顶部，就好像“位置：固定”在每个浏览器中都有效一样。

我不想要复杂的东西。我不想要巨大的 CSS hacks。如果只使用 jQuery（版本 1.2.6）就足够了，我会更喜欢，但如果我需要 jQuery-UI-core，那也可以。

我试过 $("#topBar").scrollFollow(); <-- 但这很慢...我希望某些东西看起来很固定。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-03T05:10:48.817

使用这个 HTML：

```
<div id="myElement" style="position: absolute">This stays at the top</div> 
```

这是您要使用的 javascript。它将一个事件附加到窗口的滚动条上，并将元素向下移动到滚动为止。

```
$(window).scroll(function() {
    $('#myElement').css('top', $(this).scrollTop() + "px");
}); 
```

* * *

正如下面评论中所指出的，不建议将事件附加到滚动事件 - 当用户滚动时，它会触发很多，并可能导致性能问题。考虑将它与 Ben Alman 的[debounce/throttle](http://benalman.com/projects/jquery-throttle-debounce-plugin/)插件一起使用以减少开销。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T11:01:00.373

美丽的！您的解决方案是 99%...而不是“this.scrollY”，我使用了“$(window).scrollTop()”。更棒的是这个解决方案只需要jQuery1.2.6库（不需要额外的库）。

我特别想要那个版本的原因是因为这是目前 MVC 附带的。

这是代码：

```
$(document).ready(function() {
    $("#topBar").css("position", "absolute");
});

$(window).scroll(function() {
    $("#topBar").css("top", $(window).scrollTop() + "px");
}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-04-01T12:47:13.337

对于那些支持“位置：固定”的浏览器，您可以简单地使用 javascript (jQuery) 在滚动时将位置更改为“固定”。这消除了使用此处列出的 $(window).scroll(function()) 解决方案滚动时的跳跃性。

Ben Nadel 在他的教程中演示了这一点： [使用 jQuery 创建有时固定位置的元素](http://www.bennadel.com/blog/1810-Creating-A-Sometimes-Fixed-Position-Element-With-jQuery.htm)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-23T21:36:35.250

**HTML/CSS 方法**

如果您正在寻找不需要太多 JavaScript 的选项（以及随之而来的所有问题，例如快速滚动事件调用），则可以通过添加包装器`<div>`和几个样式来获得相同的行为。当我使用以下方法时，我注意到滚动更加流畅（没有落后的元素）：

[JS小提琴](http://jsfiddle.net/rncVe/5/ "JS小提琴")

HTML

```
<div id="wrapper">
  <div id="fixed">
    [Fixed Content]
  </div><!-- /fixed -->
  <div id="scroller">
    [Scrolling Content]
  </div><!-- /scroller -->
</div><!-- /wrapper --> 
```

CSS

```
#wrapper { position: relative; }
#fixed { position: fixed; top: 0; right: 0; }
#scroller { height: 100px; overflow: auto; } 
```

JS

```
//Compensate for the scrollbar (otherwise #fixed will be positioned over it).
$(function() {
  //Determine the difference in widths between
  //the wrapper and the scroller. This value is
  //the width of the scroll bar (if any).
  var offset = $('#wrapper').width() - $('#scroller').get(0).clientWidth;

  //Set the right offset
  $('#fixed').css('right', offset + 'px');​
}); 
```

当然，这种方法可以针对在运行期间获得/丢失内容的滚动区域进行修改（这将导致添加/删除滚动条）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-21T02:43:05.007

对于仍在 IE 6 中寻找简单解决方案的任何人。我创建了一个处理 IE 6 位置的插件：已解决问题并且非常易于使用：[http ://www.fixedie.com/](http://www.fixedie.com/)

我写它是为了模仿迟来的png的简单性，其中唯一需要的更改是添加脚本并调用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-16T12:58:50.507

在一个项目中，我的客户希望在另一个 div 中有一个浮动框，所以我使用 margin-top CSS 属性而不是 top 以使我的浮动框保持在其父级中。

# eclipse - 用于拆分长字符串的 Eclipse 快捷方式

> ID：257251
> 
> 赞同：7
> 
> 时间：2008-11-02T19:35:40.570
> 
> 标签：eclipse, editor, keyboard-shortcuts

我发誓我见过有人这样做，但我在各种快捷方式列表中找不到它。

鉴于：

```
String s = "A very long ............................ String"; 
```

是否有 Eclipse 快捷方式可以将其转换为：

```
String s = "A very long ............................ " 
    + "String"; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-02T19:38:19.550

是的 - 当您的光标位于字符串的中间时，只需按回车键即可。

诚然，这将 + 放在第一行的末尾而不是第二行的开头，如果您的风格指南要求后者，这很烦人，但如果您不挑剔，那就太好了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T19:59:30.817

Eclipse 中的所有格式模板都会将加号放在下一行（*我*觉得这很烦人），因此您可以简单地应用代码格式化程序，加号将在下一行结束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T00:37:53.470

也可能有一个快速修复 ( `Ctrl`+ `1`)。

我在 3.4 中惊讶地发现有快速修复可以将基于 + 的字符串连接转换为使用`StringBuilder`or `MessageFormat`。杰出的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-11T09:20:18.237

您还可以使用正则表达式格式化代码。选择表达式，按 Ctrl+F 并使用：

寻找：`"\s*?\+\s*?\R(\s*?)"`

用。。。来代替：`"\R$1\+ "`

☑ 正则表达式

# javascript - 用javascript填写表格的通用方法

> ID：257255
> 
> 赞同：9
> 
> 时间：2008-11-02T19:41:19.077
> 
> 标签：javascript, html, forms, prototypejs

我正在寻找一种非常通用的方法来“填写”基于使用 javascript 的参数字符串的表单。

例如，如果我有这种形式：

```
<form id="someform">
  <select name="option1">
    <option value="1">1</option>
    <option value="2">2</option>
  </select>
  <select name="option2">
    <option value="1">1</option>
    <option value="2">2</option>
  </select>
</form> 
```

我希望能够采用这样的参数字符串：`option1=2&option2=1`

然后根据查询字符串中的选项选择正确的东西。

我有一种丑陋的解决方案，我遍历表单的子项并检查它们是否匹配各种键，然后设置值，但我真的不喜欢它。

我想要一种更简洁、**通用**的方法，它适用于任何形式（假设参数字符串具有所有正确的键）。

我正在使用原型 javascript 库，所以我欢迎利用它的建议。

编辑：这是我迄今为止想出的（使用原型`Form.getElements(form)`）

```
function setFormOptions(formId, params) {
  params = params.split('&');
  params.each(function(pair) {
    pair = pair.split('=');
    var key = pair[0];
    var val = pair[1];
    Form.getElements(form).each(function(element) {
      if(element.name == key) {
        element.value = val;
      }
    });
  });
} 
```

我觉得它仍然可以更快/更清洁。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-02T21:24:51.287

如果您使用 Prototype，这很容易。首先，您可以对 String 对象使用[toQueryParams](http://prototypejs.org/api/string/toQueryParams)方法来获取每个参数的名称/值对的 Javascript 对象。

其次，您可以使用 Form.Elements.setValue 方法（似乎没有记录）将每个查询字符串值转换为实际的表单输入状态（例如，当查询字符串值为“on”时选中复选框）。使用 name.value=value 技术仅适用于文本和选择（一个，不是很多）输入。使用 Prototype 方法增加了对复选框和选择（多个）输入的支持。

至于一个简单的函数来填充你所拥有的东西，这很好用而且并不复杂。

```
function populateForm(queryString) {
    var params = queryString.toQueryParams();
    Object.keys(params).each(function(key) {
        Form.Element.setValue($("someform")[key], params[key]);
    });
} 
```

这使用[Object.keys](http://prototypejs.org/api/object/keys)和[each](http://prototypejs.org/api/array/each)方法迭代每个查询字符串参数，并将匹配的表单输入（使用输入名称属性）设置为查询参数对象中的匹配值。

**编辑：**请注意，您不需要在表单元素上具有 id 属性才能使此解决方案起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T20:32:34.387

试试这个：

```
Event.observe(window, 'load', function() {
  var loc = window.location.search.substr(1).split('&');

  loc.each(function(param) {
      param = param.split('=');
      key = param[0];
      val = param[1];

      $(key).value = val;
  });
}); 
```

上面的代码假定您为每个表单元素分配了 id 值和名称。它接受以下形式的参数：

```
?键=值&键=值
```

或者

```
?选项1=1&选项2=2
```

* * *

如果您想将其保留为元素的名称，请尝试代替上述内容：

```
Event.observe(window, 'load', function() {
  var loc = window.location.search.substr(1).split('&');

  loc.each(function(param) {
    param = param.split('=');
    key = param[0].split('_');

    type = key[0];
    key = key[1];
    val = param[1];

    $$(type + '[name="' + key + '"]').each(function(ele) {
      ele.value = val;
    });
}); 
```

此代码采用以下形式的参数：

```
?type_key=值&type_key=值
```

或者

```
?select_option1=1&select_option2=2
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-02T20:09:26.087

您说您已经在遍历元素并设置值。但是，也许这比你所拥有的更干净？

```
function setFormSelectValues(form, dataset) {
    var sel = form.getElementsByTagName("select");
    dataset.replace(/([^=&]+)=([^&]*)/g, function(match, name, value){
        for (var i = 0; i < sel.length; ++i) {
            if (sel[i].name == name) {
                sel[i].value = value;
            }
        }
    });                
} 
```

如果需要，您可以将其调整为不仅仅是选择元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T13:29:06.360

[prototype.js](http://www.prototypejs.org/)中的三行代码：

```
$H(query.toQueryParams()).each(function(pair) {
    $("form")[pair.key].setValue(pair.value);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-28T18:19:20.573

[您可以使用formManager](http://javascriptmanagement.blogspot.com/2011/06/form-management.html)在 JavaScript 对象中获取表单数据。

# c++ - 将新节点添加到链表的新方法

> ID：257259
> 
> 赞同：2
> 
> 时间：2008-11-02T19:45:39.910
> 
> 标签：c++, c, data-structures, pointers

```
void addNewNode (struct node *head, int n)
{
    struct node* temp = (struct node*) malloc(sizeof(struct node));
    temp -> data = n;
    temp -> link = head;
    head = temp;
} 
```

上面给出的代码是在链表头部添加新节点的函数的普遍错误版本。通常正确的版本是这样的，

```
void addNewNode (struct node **head, int n);
void addNewNode (struct node * &head, int n); 
```

为此，我制定了另一个但简单的功能，效果很好。

```
struct node* addNewNode (struct node *head, int n)
{
    struct node* temp = (struct node*) malloc(sizeof(struct node));
    temp -> data = n;
    temp -> link = head;
    return temp;
} 
```

但是我还没有看到在代码和教程中使用或讨论过这种方法，因此我很想知道这种方法是否存在缺陷。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-02T19:49:26.720

缺陷是您依赖调用者执行更新头指针到列表的最后一步。

如果调用者忽略了这样做，编译器将不会抱怨，并且出于所有意图和目的，列表似乎没有改变（并且您会泄漏节点的内存）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-02T19:50:33.503

这就是链表在大多数函数式语言中的工作方式。例如，在 ML 中，您可能会执行以下操作：

```
val ls = [1, 2, 3, 4]
val newList = 0 :: ls 
```

`::`语法实际上是一个函数，它接受两个参数 (和`0`)`ls`并返回一个新列表，该列表具有`0`作为第一个元素。ML 中的列表实际上被定义为列表节点，因此实际上与您提出的函数`::`非常相似。`addNewNode`

换句话说：恭喜，您已经在 C 中创建了一个不可变的链表实现！理解这一点实际上是函数式语言相当重要的第一步，所以知道这真的是一件好事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T19:50:33.177

您的方法与列表中的方法的想法不兼容，`addNode`在 OO 语言中更常用。

我个人认为

```
list.add(element) 
```

比直观得多

```
list = add(list, element) 
```

几十个“收藏”库不会错……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:56:23.053

Afaik，这就是 glib 中列表的工作方式，我相信 gtk 人不是第一个使用这种方式的人，所以我不会称之为新方法。我个人更喜欢有一个基本结构，它保存节点计数、第一个和最后一个指针。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T16:10:35.803

这并不新鲜。正如 quinmars 所指出的，glib 已经这样做了 10 多年。这是一个好主意，所以恭喜你弄清楚了。

但是，关于您的代码的一个挑剔：不要`malloc()`在 C 中强制转换返回值，也不要在使用`sizeof`. 您的分配行应如下所示：

```
struct node* temp = malloc(sizeof *temp); 
```

看？更短，更紧凑，更容易阅读，更难搞砸。更好的！:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T19:50:18.060

我在任何提到的正确代码中都没有发现任何问题。改变或不改变头部是设计问题 - 以及如何返回修改后的列表。std::list<> 中实现了良好的接口，作为使用 OOP 的示例，这种方法没有潜在问题。head 指针是隐藏的，您可以根据需要对其进行修改，并且由于调用者没有显式存储 head，因此它对列表的引用始终是正确的。

看起来丑陋的一件事（当你使用 C++，而不是 C 时）是 malloc，最好使用“新”。

# c# - 在 Aspx 页面上使用 AJAX Web 控件时，我应该如何处理会话超时？

> ID：257274
> 
> 赞同：1
> 
> 时间：2008-11-02T19:55:29.860
> 
> 标签：c#, .net, ajaxcontroltoolkit

以下是几个月前我在博客上提出的一个问题，但我仍然没有得到正确的答案。几天前，有人问我是否有答案，所以我决定把这个问题复制到这里，让有意愿和有能力的开发人员得到更多的曝光。无论如何，这里...

* * *

我一直在开发一个 ASP.NET Web 应用程序，它利用[AJAX Control Toolkit](http://www.codeplex.com/AtlasControlToolkit)控件来扩展应用程序的可用性。此外，该应用程序是一个严肃的业务应用程序，需要安全性，包括加密、身份验证和授权。HTTP 会话是一个 InProc 模式会话，默认时间为 20 分钟。

这当然意味着，如果用户在其浏览器上离开页面超过 20 分钟，则会话已过期，并且任何发回服务器的帖子都会将浏览器重定向到登录页面。但是，例如，如果页面包含[AJAX 控件工具包中的](http://www.codeplex.com/AtlasControlToolkit)[AutoCompleteExtender](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/)控件，用户可能会返回浏览器并开始使用扩展器的功能，需要后台回调，但会意识到该控件根本不工作 - 没有错误没有重定向到登录页面！？

* * *

就像我说的那样，我没有解决方案，所以我最终将[SessionExpiredMonitor](http://www.imaginativeuniversal.com/ct.ashx?id=78b1cd2d-5352-4845-b381-6ac2c4b07c44&url=http%3a%2f%2fwww.imaginativeuniversal.com%2fSessionExpiredMonitorWithASPNETAJAX.aspx)（由 Herr [Ziffer](http://www.imaginativeuniversal.com/ASPNETAJAXServerControlsAndExtenders.aspx)）放在我的所有页面上（在我的 MasterPage 中），这导致每个页面在 19 分钟内自动退出，然后将浏览器重定向到登录页面。但是，我认为这不是一个解决方案，所以如果你能解决这个问题，请告诉我。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T20:15:44.623

On the server side you can detect that the session is expired and return a strong typed exception. On the browser side, you can specifically detect for that error and simply have the page refresh. This assumes that when your page posts back for the refresh that your application detects expired sessions and has them login again.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T23:37:28.833

What's wrong with redirecting the user to the login page after his session actually expired? From a user point of view I do really prefer this over not noticing an expired session, filling out some way too long form and actually notice the expiration on submit. It's at least a very user friendly solution to the problem.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T17:29:05.160

我认为自动重定向是更可取的解决方案，主要是出于明显的安全原因。

您可以通过在 18 分钟不活动后向用户显示警报来进一步扩展功能，警告他们他们的会话将在 1 分钟内到期，并提供一种通过单击按钮来扩展会话的方法，该按钮反过来调用后端页面以恢复活力会议。

就在会话到期并且页面将用户重定向到登录页面之前，您可以保存用户/页面/帐户的状态，以便当他们重新登录时，他们可以被重定向回他们上次查看的页面。

# c++ - 未检测到 SDL 按键事件

> ID：257275
> 
> 赞同：2
> 
> 时间：2008-11-02T19:56:08.313
> 
> 标签：c++, sdl

我完全不知道为什么这段代码没有得到任何 SDL 按键事件。其他 SDL 事件（为清楚起见已删除）工作正常。它不适用于我的 XP 或 Vista 机器。没有编译/链接错误，只是永远不会收到 keydown 事件。

```
#include "SDL/SDL.h"
// Yes SDL.lib and SDLmain.lib are linked

Uint32 TimeLeft(void)
{
    static Uint32 next_time = 0;
    Uint32 now;
    now = SDL_GetTicks();
    if ( next_time <= now ) {
        next_time = now + tickInterval;
        return 0;
    }
    return(next_time-now);
}

int main( int argc, char **argv )
{
    if( -1 == SDL_Init( SDL_INIT_EVERYTHING ) )
    {
        cerr << "Error: SDL_Init failed" << endl;
        return -1;
    }

    SDL_Event event;

    bool quit = false;

    while( !quit )
    {
        while( SDL_PollEvent( &event ) )
        {
            switch( event.type )
            {
            case SDL_KEYDOWN:
                switch( event.key.keysym.sym )
                {
                case SDLK_ESCAPE:
                case SDLK_q:
                    quit = true;
                    break;
                default:
                    break;
                }
                break;
            case SDL_JOYAXISMOTION:
                // stuff removed
                break;
            case SDL_QUIT:
                quit = true;
                break;
            default:
                break;
            }
        }
        SDL_Delay( TimeLeft() );
    }

    SDL_Quit();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T20:21:18.667

您需要使用[SDL_SetVideoMode](http://libsdl.org/cgi/docwiki.cgi/SDL_SetVideoMode)创建一个窗口来获取鼠标和键盘事件。

我不认为你会在没有窗口的情况下尝试[SDL_WM_GrabInput](http://libsdl.org/cgi/docwiki.cgi/SDL_WM_GrabInput)鼠标和键盘。它还可能在现代 Windows 机器上首次引发安全警报。

# c++ - 比较保存十六进制值 C++ 的 Char

> ID：257286
> 
> 赞同：1
> 
> 时间：2008-11-02T20:08:57.413
> 
> 标签：c++, compare, hex

在 C++ 中，我有两个保存十六进制值的字符，例如：

```
char t = 0x4;
char q = 0x4; 
```

如果 char 中保存的两个值相同，我将如何比较？我试过了

```
if (t == q) // should give me true 
```

但不，任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-02T20:21:13.100

A char is just an 8-bit integer. It doesn't matter if you initialized it with hex or decimal literal, in either case the value of the char will be the same afterwards.

So:

```
char t = 0x4;
char q = 0x4;
if(t == q)
{
 //They are the same
} 
```

It is equivalent to:

```
char t = 4;
char q = 4;
if(t == q)
{
 //They are the same
} 
```

You mentioned that the above is not true, but you must have an error in your code or t and q must not be the same.

**What you suggested...**

> if (t == q) // should give me true but no, any help, thanks!

**is not correct. Why?**

t & q does a bitwise compare, returning a value where both aligned bits are 1\.

The term "if(t&q)" would return true as long as any of the bits of t and q are in common.

so if t = 3 which is in binary 00000011 and q = 1 which is in binary 00000001 then (t&q) would return true even know they are not equal.

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2008-11-02T20:12:46.780

啊，我找到了解决方案：

```
if (t & q) 
```

# c++ - 模板化检查是否存在类成员函数？

> ID：257288
> 
> 赞同：575
> 
> 时间：2008-11-02T20:10:47.673
> 
> 标签：c++, templates, template-meta-programming, sfinae

是否可以编写一个模板来根据类上是否定义了某个成员函数来改变行为？

这是我想写的一个简单的例子：

```
template<class T>
std::string optionalToString(T* obj)
{
    if (FUNCTION_EXISTS(T->toString))
        return obj->toString();
    else
        return "toString not defined";
} 
```

因此，如果`class T`已`toString()`定义，则使用它；否则，它不会。我不知道该怎么做的神奇部分是“FUNCTION_EXISTS”部分。

* * *

## 回答 #1

> 赞同：362
> 
> 时间：2008-11-02T21:15:01.180

是的，使用 SFINAE，您可以检查给定的类是否提供了某种方法。这是工作代码：

```
#include <iostream>

struct Hello
{
    int helloworld() { return 0; }
};

struct Generic {};    

// SFINAE test
template <typename T>
class has_helloworld
{
    typedef char one;
    struct two { char x[2]; };

    template <typename C> static one test( decltype(&C::helloworld) ) ;
    template <typename C> static two test(...);    

public:
    enum { value = sizeof(test<T>(0)) == sizeof(char) };
};

int main(int argc, char *argv[])
{
    std::cout << has_helloworld<Hello>::value << std::endl;
    std::cout << has_helloworld<Generic>::value << std::endl;
    return 0;
} 
```

我刚刚使用 Linux 和 gcc 4.1/4.3 对其进行了测试。我不知道它是否可以移植到运行不同编译器的其他平台。

* * *

## 回答 #2

> 赞同：286
> 
> 时间：2012-02-06T00:27:05.087

这个问题很老了，但是在 C++11 中，我们有了一种新的方法来检查函数是否存在（或者任何非类型成员的存在，真的），再次依赖于 SFINAE：

```
template<class T>
auto serialize_imp(std::ostream& os, T const& obj, int)
    -> decltype(os << obj, void())
{
  os << obj;
}

template<class T>
auto serialize_imp(std::ostream& os, T const& obj, long)
    -> decltype(obj.stream(os), void())
{
  obj.stream(os);
}

template<class T>
auto serialize(std::ostream& os, T const& obj)
    -> decltype(serialize_imp(os, obj, 0), void())
{
  serialize_imp(os, obj, 0);
} 
```

现在进行一些解释。首先，如果里面的第一个表达式无效（也就是函数不存在） ，我使用[表达式 SFINAE](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2634.html)`serialize(_imp)`从重载解析中排除函数。`decltype`

`void()`用于制作所有这些函数的返回类型`void`。

如果两者都可用，则该`0`参数用于首选重载（文字是类型，因此第一个重载是更好的匹配）。`os << obj``0``int`

* * *

现在，您可能需要一个 trait 来检查一个函数是否存在。幸运的是，这很容易写。但是请注意，您需要*自己*为可能需要的每个不同的函数名称编写一个特征。

```
#include <type_traits>

template<class>
struct sfinae_true : std::true_type{};

namespace detail{
  template<class T, class A0>
  static auto test_stream(int)
      -> sfinae_true<decltype(std::declval<T>().stream(std::declval<A0>()))>;
  template<class, class A0>
  static auto test_stream(long) -> std::false_type;
} // detail::

template<class T, class Arg>
struct has_stream : decltype(detail::test_stream<T, Arg>(0)){}; 
```

[活生生的例子。](http://coliru.stacked-crooked.com/a/cd139d95d214c5c3)

并继续进行解释。第一，`sfinae_true`是辅助类型，基本等同于写作`decltype(void(std::declval<T>().stream(a0)), std::true_type{})`。优点只是它更短。
接下来，`struct has_stream : decltype(...)`继承自`std::true_type`或`std::false_type`最终，取决于`decltype`签入是否`test_stream`失败。
最后，`std::declval`给你一个你传递的任何类型的“值”，而你不需要知道如何构造它。`decltype`请注意，这仅在未评估的上下文中才有可能，例如`sizeof`和其他。

* * *

请注意，这`decltype`不是必需的，因为`sizeof`（以及所有未评估的上下文）都得到了增强。只是`decltype`已经提供了一种类型，因此更干净。这是`sizeof`其中一个重载的版本：

```
template<class T>
void serialize_imp(std::ostream& os, T const& obj, int,
    int(*)[sizeof((os << obj),0)] = 0)
{
  os << obj;
} 
```

由于相同的原因，`int`和`long`参数仍然存在。数组指针用于提供`sizeof`可以使用的上下文。

* * *

## 回答 #3

> 赞同：166
> 
> 时间：2008-11-05T01:08:39.087

C++ 允许为此使用[SFINAE](http://en.wikipedia.org/wiki/SFINAE)（请注意，使用 C++11 功能，这会更简单，因为它支持几乎任意表达式的扩展 SFINAE - 下面是为与常见的 C++03 编译器一起工作而设计的）：

```
#define HAS_MEM_FUNC(func, name)                                        \
    template<typename T, typename Sign>                                 \
    struct name {                                                       \
        typedef char yes[1];                                            \
        typedef char no [2];                                            \
        template <typename U, U> struct type_check;                     \
        template <typename _1> static yes &chk(type_check<Sign, &_1::func > *); \
        template <typename   > static no  &chk(...);                    \
        static bool const value = sizeof(chk<T>(0)) == sizeof(yes);     \
    } 
```

上面的模板和宏试图实例化一个模板，给它一个成员函数指针类型，以及实际的成员函数指针。如果类型不适合，SFINAE 会导致模板被忽略。像这样的用法：

```
HAS_MEM_FUNC(toString, has_to_string);

template<typename T> void
doSomething() {
   if(has_to_string<T, std::string(T::*)()>::value) {
      ...
   } else {
      ...
   }
} 
```

但请注意，您不能只在该分支中调用该`toString`函数。`if`由于编译器将检查两个分支中的有效性，因此在函数不存在的情况下会失败。一种方法是再次使用 SFINAE（`enable_if`也可以从 boost 中获得）：

```
template<bool C, typename T = void>
struct enable_if {
  typedef T type;
};

template<typename T>
struct enable_if<false, T> { };

HAS_MEM_FUNC(toString, has_to_string);

template<typename T> 
typename enable_if<has_to_string<T, 
                   std::string(T::*)()>::value, std::string>::type
doSomething(T * t) {
   /* something when T has toString ... */
   return t->toString();
}

template<typename T> 
typename enable_if<!has_to_string<T, 
                   std::string(T::*)()>::value, std::string>::type
doSomething(T * t) {
   /* something when T doesnt have toString ... */
   return "T::toString() does not exist.";
} 
```

玩得开心。它的优点是它也适用于重载的成员函数，也适用于`const`成员函数（请记住使用 `std::string(T::*)() const`成员函数指针类型！）。

* * *

## 回答 #4

> 赞同：154
> 
> 时间：2014-02-25T12:52:04.210

## C++20 -`requires`表达式

C++20 提供了概念和各种工具，例如[`requires`表达式](https://en.cppreference.com/w/cpp/language/constraints)，它们是检查函数是否存在的内置方法。`optionalToString`使用它们，您可以按如下方式重写您的函数：

```
template<class T>
std::string optionalToString(T* obj)
{
    constexpr bool has_toString = requires(const T& t) {
        t.toString();
    };

    if constexpr (has_toString)
        return obj->toString();
    else
        return "toString not defined";
} 
```

## Pre-C++20 - 检测工具包

[N4502](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4502.pdf)提出了一个包含在 C++17 标准库中的检测工具包，最终将其纳入库基础 TS v2。它很可能永远不会进入标准，因为它已经被`requires`表达式所包含，但它仍然以一种有点优雅的方式解决了这个问题。该工具包引入了一些元函数，包括[`std::is_detected`](http://en.cppreference.com/w/cpp/experimental/is_detected)可用于在其之上轻松编写类型或函数检测元函数的元函数。以下是您可以如何使用它：

```
template<typename T>
using toString_t = decltype( std::declval<T&>().toString() );

template<typename T>
constexpr bool has_toString = std::is_detected_v<toString_t, T>; 
```

请注意，上面的示例未经测试。检测工具包在标准库中尚不可用，但该提案包含一个完整的实现，如果您真的需要它，您可以轻松复制它。它与 C++17 功能配合得很好`if constexpr`：

```
template<class T>
std::string optionalToString(T* obj)
{
    if constexpr (has_toString<T>)
        return obj->toString();
    else
        return "toString not defined";
} 
```

## C++14 - Boost.Hana

Boost.Hana 显然建立在这个特定示例的基础上，并在其文档中提供了 C++14 的解决方案，所以我将直接引用它：

> [...] Hana 提供了一个`is_valid`可以与 C++14 通用 lambda 结合的函数，以获得更简洁的相同实现：
> 
> ```
> auto has_toString = hana::is_valid([](auto&& obj) -> decltype(obj.toString()) { }); 
> ```
> 
> 这给我们留下了一个函数对象`has_toString`，它返回给定表达式在我们传递给它的参数上是否有效。结果返回为`IntegralConstant`，因此 constexpr-ness 在这里不是问题，因为函数的结果无论如何都表示为类型。现在，除了不那么冗长（这是一条线！）之外，意图更加清晰。其他好处是`has_toString`可以传递给更高阶的算法，也可以在函数范围内定义，因此不需要用实现细节污染命名空间范围。

## Boost.TTI

执行这种检查的另一个有点惯用的工具包 - 尽管不太优雅 - 是[Boost.TTI](http://www.boost.org/doc/libs/1_55_0/libs/tti/doc/html/index.html)，在 Boost 1.54.0 中引入。对于您的示例，您必须使用宏`BOOST_TTI_HAS_MEMBER_FUNCTION`。以下是您可以如何使用它：

```
#include <boost/tti/has_member_function.hpp>

// Generate the metafunction
BOOST_TTI_HAS_MEMBER_FUNCTION(toString)

// Check whether T has a member function toString
// which takes no parameter and returns a std::string
constexpr bool foo = has_member_function_toString<T, std::string>::value; 
```

然后，您可以使用`bool`来创建 SFINAE 检查。

*解释*

宏`BOOST_TTI_HAS_MEMBER_FUNCTION`生成将`has_member_function_toString`检查类型作为其第一个模板参数的元函数。第二个模板参数对应成员函数的返回类型，后面的参数对应函数参数的类型。成员`value`包含`true`该类`T`是否具有成员函数`std::string toString()`。

或者，`has_member_function_toString`可以将成员函数指针作为模板参数。因此，可以替换`has_member_function_toString<T, std::string>::value`为`has_member_function_toString<std::string T::* ()>::value`。

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2010-09-02T12:50:43.803

虽然这个问题已经两年了，但我敢于添加我的答案。希望它能澄清以前的、无可争议的优秀解决方案。我接受了 Nicola Bonelli 和 Johannes Schaub 的非常有用的答案，并将它们合并到一个解决方案中，即恕我直言，更易读、更清晰并且不需要`typeof`扩展：

```
template <class Type>
class TypeHasToString
{
    // This type won't compile if the second template parameter isn't of type T,
    // so I can put a function pointer type in the first parameter and the function
    // itself in the second thus checking that the function has a specific signature.
    template <typename T, T> struct TypeCheck;

    typedef char Yes;
    typedef long No;

    // A helper struct to hold the declaration of the function pointer.
    // Change it if the function signature changes.
    template <typename T> struct ToString
    {
        typedef void (T::*fptr)();
    };

    template <typename T> static Yes HasToString(TypeCheck< typename ToString<T>::fptr, &T::toString >*);
    template <typename T> static No  HasToString(...);

public:
    static bool const value = (sizeof(HasToString<Type>(0)) == sizeof(Yes));
}; 
```

我用 gcc 4.1.2 检查了它。功劳主要归功于 Nicola Bonelli 和 Johannes Schaub，所以如果我的回答对您有帮助，请给他们投票：)

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2015-08-06T15:41:05.200

C++11 的简单解决方案：

```
template<class T>
auto optionalToString(T* obj)
 -> decltype(  obj->toString()  )
{
    return     obj->toString();
}
auto optionalToString(...) -> string
{
    return "toString not defined";
} 
```

3 年后更新：（这是未经测试的）。为了测试存在，我认为这会起作用：

```
template<class T>
constexpr auto test_has_toString_method(T* obj)
 -> decltype(  obj->toString() , std::true_type{} )
{
    return     obj->toString();
}
constexpr auto test_has_toString_method(...) -> std::false_type
{
    return "toString not defined";
} 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2015-06-15T14:43:14.573

好吧，这个问题已经有一长串答案了，但我想强调一下 Morwenn 的评论：有一个 C++17 提案，它使它变得非常简单。有关详细信息，请参阅[N4502](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4502.pdf "提议对 C++ 检测习语 v2 的标准库支持")，但作为独立示例，请考虑以下内容。

这部分是常量部分，放在一个表头中。

```
// See http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4502.pdf.
template <typename...>
using void_t = void;

// Primary template handles all types not supporting the operation.
template <typename, template <typename> class, typename = void_t<>>
struct detect : std::false_type {};

// Specialization recognizes/validates only types supporting the archetype.
template <typename T, template <typename> class Op>
struct detect<T, Op, void_t<Op<T>>> : std::true_type {}; 
```

然后是变量部分，您可以在其中指定要查找的内容（类型、成员类型、函数、成员函数等）。在 OP 的情况下：

```
template <typename T>
using toString_t = decltype(std::declval<T>().toString());

template <typename T>
using has_toString = detect<T, toString_t>; 
```

以下示例取自[N4502](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4502.pdf "提议对 C++ 检测习语 v2 的标准库支持")，显示了更精细的探针：

```
// Archetypal expression for assignment operation.
template <typename T>
using assign_t = decltype(std::declval<T&>() = std::declval<T const &>())

// Trait corresponding to that archetype.
template <typename T>
using is_assignable = detect<T, assign_t>; 
```

与上面描述的其他实现相比，这个实现相当简单：一组减少的工具 (`void_t`和`detect`) 就足够了，不需要毛茸茸的宏。此外，据报道（参见[N4502](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4502.pdf "提议对 C++ 检测习语 v2 的标准库支持")）它比以前的方法更有效（编译时间和编译器内存消耗）。

这是一个[活生生的例子](http://coliru.stacked-crooked.com/a/7eae9c76232a2d20 "检测成语")。它适用于 Clang，但不幸的是，5.1 之前的 GCC 版本遵循对 C++11 标准的不同解释，导致`void_t`无法按预期工作。Yakk 已经提供了解决方法：使用以下定义`void_t`（[参数列表中的 void_t 有效，但不作为返回类型](https://stackoverflow.com/questions/28967003/void-t-in-parameter-list-works-but-not-as-return-type/28967049#28967049)）：

```
#if __GNUC__ < 5 && ! defined __clang__
// https://stackoverflow.com/a/28967049/1353549
template <typename...>
struct voider
{
  using type = void;
};
template <typename...Ts>
using void_t = typename voider<Ts...>::type;
#else
template <typename...>
using void_t = void;
#endif 
```

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2008-11-02T20:26:30.030

这就是类型特征的用途。不幸的是，它们必须手动定义。在您的情况下，想象以下情况：

```
template <typename T>
struct response_trait {
    static bool const has_tostring = false;
};

template <>
struct response_trait<your_type_with_tostring> {
    static bool const has_tostring = true;
} 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2014-06-02T13:58:38.237

这是针对一般问题的 C++11 解决方案，如果“如果我做了 X，它会编译吗？”

```
template<class> struct type_sink { typedef void type; }; // consumes a type, and makes it `void`
template<class T> using type_sink_t = typename type_sink<T>::type;
template<class T, class=void> struct has_to_string : std::false_type {}; \
template<class T> struct has_to_string<
  T,
  type_sink_t< decltype( std::declval<T>().toString() ) >
>: std::true_type {}; 
```

这样`has_to_string`的特征`has_to_string<T>::value`是`true`当且仅当`T`有一个`.toString`可以在此上下文中使用 0 个参数调用的方法。

接下来，我将使用标签调度：

```
namespace details {
  template<class T>
  std::string optionalToString_helper(T* obj, std::true_type /*has_to_string*/) {
    return obj->toString();
  }
  template<class T>
  std::string optionalToString_helper(T* obj, std::false_type /*has_to_string*/) {
    return "toString not defined";
  }
}
template<class T>
std::string optionalToString(T* obj) {
  return details::optionalToString_helper( obj, has_to_string<T>{} );
} 
```

这往往比复杂的 SFINAE 表达式更易于维护。

如果您发现自己经常这样做，您可以使用宏编写这些特征，但它们相对简单（每行几行），因此可能不值得：

```
#define MAKE_CODE_TRAIT( TRAIT_NAME, ... ) \
template<class T, class=void> struct TRAIT_NAME : std::false_type {}; \
template<class T> struct TRAIT_NAME< T, type_sink_t< decltype( __VA_ARGS__ ) > >: std::true_type {}; 
```

上面所做的是创建一个宏`MAKE_CODE_TRAIT`。您将所需特征的名称以及一些可以测试 type 的代码传递给它`T`。因此：

```
MAKE_CODE_TRAIT( has_to_string, std::declval<T>().toString() ) 
```

创建上述特征类。

顺便说一句，上述技术是 MS 所谓的“表达式 SFINAE”的一部分，他们的 2013 编译器非常失败。

请注意，在 C++1y 中，可以使用以下语法：

```
template<class T>
std::string optionalToString(T* obj) {
  return compiled_if< has_to_string >(*obj, [&](auto&& obj) {
    return obj.toString();
  }) *compiled_else ([&]{ 
    return "toString not defined";
  });
} 
```

这是一个内联编译条件分支，它滥用了许多 C++ 特性。这样做可能不值得，因为（内联代码的好处）不值得付出成本（几乎没有人了解它是如何工作的），但上述解决方案的存在可能会引起人们的兴趣。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2011-06-12T21:40:44.083

以下是一些用法片段： *所有这些的胆量都在更远的地方

**检查`x`给定类中的成员。可以是 var、func、class、union 或 enum：**

```
CREATE_MEMBER_CHECK(x);
bool has_x = has_member_x<class_to_check_for_x>::value; 
```

**检查成员函数`void x()`：**

```
//Func signature MUST have T as template variable here... simpler this way :\
CREATE_MEMBER_FUNC_SIG_CHECK(x, void (T::*)(), void__x);
bool has_func_sig_void__x = has_member_func_void__x<class_to_check_for_x>::value; 
```

**检查成员变量`x`：**

```
CREATE_MEMBER_VAR_CHECK(x);
bool has_var_x = has_member_var_x<class_to_check_for_x>::value; 
```

**检查成员类`x`：**

```
CREATE_MEMBER_CLASS_CHECK(x);
bool has_class_x = has_member_class_x<class_to_check_for_x>::value; 
```

**检查会员工会`x`：**

```
CREATE_MEMBER_UNION_CHECK(x);
bool has_union_x = has_member_union_x<class_to_check_for_x>::value; 
```

**检查成员枚举`x`：**

```
CREATE_MEMBER_ENUM_CHECK(x);
bool has_enum_x = has_member_enum_x<class_to_check_for_x>::value; 
```

**`x`无论签名如何，检查任何成员函数：**

```
CREATE_MEMBER_CHECK(x);
CREATE_MEMBER_VAR_CHECK(x);
CREATE_MEMBER_CLASS_CHECK(x);
CREATE_MEMBER_UNION_CHECK(x);
CREATE_MEMBER_ENUM_CHECK(x);
CREATE_MEMBER_FUNC_CHECK(x);
bool has_any_func_x = has_member_func_x<class_to_check_for_x>::value; 
```

或者

```
CREATE_MEMBER_CHECKS(x);  //Just stamps out the same macro calls as above.
bool has_any_func_x = has_member_func_x<class_to_check_for_x>::value; 
```

**细节和核心：**

```
/*
    - Multiple inheritance forces ambiguity of member names.
    - SFINAE is used to make aliases to member names.
    - Expression SFINAE is used in just one generic has_member that can accept
      any alias we pass it.
*/

//Variadic to force ambiguity of class members.  C++11 and up.
template <typename... Args> struct ambiguate : public Args... {};

//Non-variadic version of the line above.
//template <typename A, typename B> struct ambiguate : public A, public B {};

template<typename A, typename = void>
struct got_type : std::false_type {};

template<typename A>
struct got_type<A> : std::true_type {
    typedef A type;
};

template<typename T, T>
struct sig_check : std::true_type {};

template<typename Alias, typename AmbiguitySeed>
struct has_member {
    template<typename C> static char ((&f(decltype(&C::value))))[1];
    template<typename C> static char ((&f(...)))[2];

    //Make sure the member name is consistently spelled the same.
    static_assert(
        (sizeof(f<AmbiguitySeed>(0)) == 1)
        , "Member name specified in AmbiguitySeed is different from member name specified in Alias, or wrong Alias/AmbiguitySeed has been specified."
    );

    static bool const value = sizeof(f<Alias>(0)) == 2;
}; 
```

***宏（暗黑破坏神！）：***

**CREATE_MEMBER_CHECK：**

```
//Check for any member with given name, whether var, func, class, union, enum.
#define CREATE_MEMBER_CHECK(member)                                         \
                                                                            \
template<typename T, typename = std::true_type>                             \
struct Alias_##member;                                                      \
                                                                            \
template<typename T>                                                        \
struct Alias_##member <                                                     \
    T, std::integral_constant<bool, got_type<decltype(&T::member)>::value>  \
> { static const decltype(&T::member) value; };                             \
                                                                            \
struct AmbiguitySeed_##member { char member; };                             \
                                                                            \
template<typename T>                                                        \
struct has_member_##member {                                                \
    static const bool value                                                 \
        = has_member<                                                       \
            Alias_##member<ambiguate<T, AmbiguitySeed_##member>>            \
            , Alias_##member<AmbiguitySeed_##member>                        \
        >::value                                                            \
    ;                                                                       \
} 
```

**CREATE_MEMBER_VAR_CHECK：**

```
//Check for member variable with given name.
#define CREATE_MEMBER_VAR_CHECK(var_name)                                   \
                                                                            \
template<typename T, typename = std::true_type>                             \
struct has_member_var_##var_name : std::false_type {};                      \
                                                                            \
template<typename T>                                                        \
struct has_member_var_##var_name<                                           \
    T                                                                       \
    , std::integral_constant<                                               \
        bool                                                                \
        , !std::is_member_function_pointer<decltype(&T::var_name)>::value   \
    >                                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_FUNC_SIG_CHECK：**

```
//Check for member function with given name AND signature.
#define CREATE_MEMBER_FUNC_SIG_CHECK(func_name, func_sig, templ_postfix)    \
                                                                            \
template<typename T, typename = std::true_type>                             \
struct has_member_func_##templ_postfix : std::false_type {};                \
                                                                            \
template<typename T>                                                        \
struct has_member_func_##templ_postfix<                                     \
    T, std::integral_constant<                                              \
        bool                                                                \
        , sig_check<func_sig, &T::func_name>::value                         \
    >                                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_CLASS_CHECK：**

```
//Check for member class with given name.
#define CREATE_MEMBER_CLASS_CHECK(class_name)               \
                                                            \
template<typename T, typename = std::true_type>             \
struct has_member_class_##class_name : std::false_type {};  \
                                                            \
template<typename T>                                        \
struct has_member_class_##class_name<                       \
    T                                                       \
    , std::integral_constant<                               \
        bool                                                \
        , std::is_class<                                    \
            typename got_type<typename T::class_name>::type \
        >::value                                            \
    >                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_UNION_CHECK：**

```
//Check for member union with given name.
#define CREATE_MEMBER_UNION_CHECK(union_name)               \
                                                            \
template<typename T, typename = std::true_type>             \
struct has_member_union_##union_name : std::false_type {};  \
                                                            \
template<typename T>                                        \
struct has_member_union_##union_name<                       \
    T                                                       \
    , std::integral_constant<                               \
        bool                                                \
        , std::is_union<                                    \
            typename got_type<typename T::union_name>::type \
        >::value                                            \
    >                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_ENUM_CHECK：**

```
//Check for member enum with given name.
#define CREATE_MEMBER_ENUM_CHECK(enum_name)                 \
                                                            \
template<typename T, typename = std::true_type>             \
struct has_member_enum_##enum_name : std::false_type {};    \
                                                            \
template<typename T>                                        \
struct has_member_enum_##enum_name<                         \
    T                                                       \
    , std::integral_constant<                               \
        bool                                                \
        , std::is_enum<                                     \
            typename got_type<typename T::enum_name>::type  \
        >::value                                            \
    >                                                       \
> : std::true_type {} 
```

**CREATE_MEMBER_FUNC_CHECK：**

```
//Check for function with given name, any signature.
#define CREATE_MEMBER_FUNC_CHECK(func)          \
template<typename T>                            \
struct has_member_func_##func {                 \
    static const bool value                     \
        = has_member_##func<T>::value           \
        && !has_member_var_##func<T>::value     \
        && !has_member_class_##func<T>::value   \
        && !has_member_union_##func<T>::value   \
        && !has_member_enum_##func<T>::value    \
    ;                                           \
} 
```

**CREATE_MEMBER_CHECKS：**

```
//Create all the checks for one member.  Does NOT include func sig checks.
#define CREATE_MEMBER_CHECKS(member)    \
CREATE_MEMBER_CHECK(member);            \
CREATE_MEMBER_VAR_CHECK(member);        \
CREATE_MEMBER_CLASS_CHECK(member);      \
CREATE_MEMBER_UNION_CHECK(member);      \
CREATE_MEMBER_ENUM_CHECK(member);       \
CREATE_MEMBER_FUNC_CHECK(member) 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2020-04-04T20:29:27.677

使用 C++ 20，您可以编写以下代码：

```
template<typename T>
concept has_toString = requires(const T& t) {
    t.toString();
};

template<typename T>
std::string optionalToString(const T& obj)
{
    if constexpr (has_toString<T>)
        return obj.toString();
    else
        return "toString not defined";
} 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2020-06-09T21:37:20.873

在 C++17 中实现它的另一种方法（灵感来自`boost:hana`）。

一次实施，可多次使用。它不需要`has_something<T>`SFINAE 类型特征类。

### 解决方案

```
////////////////////////////////////////////
// has_member implementation
////////////////////////////////////////////

#include <type_traits>

template<typename T, typename F>
constexpr auto has_member_impl(F&& f) -> decltype(f(std::declval<T>()), true)
{
  return true;
}

template<typename>
constexpr bool has_member_impl(...) { return false; }

#define has_member(T, EXPR) \
 has_member_impl<T>( [](auto&& obj)->decltype(obj.EXPR){} ) 
```

### 测试

```
////////////////////////////////////////////
// Test
////////////////////////////////////////////

#include <iostream>
#include <string>

struct Example {
    int Foo;
    void Bar() {}
    std::string toString() { return "Hello from Example::toString()!"; }
};

struct Example2 {
    int X;
};

template<class T>
std::string optionalToString(T* obj)
{
    if constexpr(has_member(T, toString()))
        return obj->toString();
    else
        return "toString not defined";
}

int main() {
    static_assert(has_member(Example, Foo), 
                  "Example class must have Foo member");
    static_assert(has_member(Example, Bar()), 
                  "Example class must have Bar() member function");
    static_assert(!has_member(Example, ZFoo), 
                  "Example class must not have ZFoo member.");
    static_assert(!has_member(Example, ZBar()), 
                  "Example class must not have ZBar() member function");

    Example e1;
    Example2 e2;

    std::cout << "e1: " << optionalToString(&e1) << "\n";
    std::cout << "e1: " << optionalToString(&e2) << "\n";
} 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2012-01-06T09:48:51.917

我在另一个线程中写了一个答案（与上面的解决方案不同）也检查继承的成员函数：

[SFINAE 检查继承的成员函数](https://stackoverflow.com/questions/1966362/sfinae-to-check-for-inherited-member-functions/8752988#8752988)

以下是该解决方案的一些示例：

## 示例 1：

我们正在检查具有以下签名的成员： `T::const_iterator begin() const`

```
template<class T> struct has_const_begin
{
    typedef char (&Yes)[1];
    typedef char (&No)[2];

    template<class U> 
    static Yes test(U const * data, 
                    typename std::enable_if<std::is_same<
                             typename U::const_iterator, 
                             decltype(data->begin())
                    >::value>::type * = 0);
    static No test(...);
    static const bool value = sizeof(Yes) == sizeof(has_const_begin::test((typename std::remove_reference<T>::type*)0));
}; 
```

请注意，它甚至会检查方法的常量性，并且也适用于原始类型。（我的意思`has_const_begin<int>::value`是错误的，不会导致编译时错误。）

## 示例 2

现在我们正在寻找签名：`void foo(MyClass&, unsigned)`

```
template<class T> struct has_foo
{
    typedef char (&Yes)[1];
    typedef char (&No)[2];

    template<class U>
    static Yes test(U * data, MyClass* arg1 = 0,
                    typename std::enable_if<std::is_void<
                             decltype(data->foo(*arg1, 1u))
                    >::value>::type * = 0);
    static No test(...);
    static const bool value = sizeof(Yes) == sizeof(has_foo::test((typename std::remove_reference<T>::type*)0));
}; 
```

请注意 MyClass 不必是默认可构造的或满足任何特殊概念。该技术也适用于模板成员。

我急切地等待对此的意见。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2008-11-04T08:37:40.677

现在这是一个*很好的*小谜题 - 很好的问题！

[这是Nicola Bonelli](https://stackoverflow.com/questions/257288/possible-for-c-template-to-check-for-a-functions-existence#257382)不依赖非标准运算符的解决方案的替代方案`typeof`。

不幸的是，它不适用于 GCC (MinGW) 3.4.5 或 Digital Mars 8.42n，但它适用于所有版本的 MSVC（包括 VC6）和 Comeau C++。

较长的注释块包含有关其工作方式（或应该如何工作）的详细信息。正如它所说，我不确定哪种行为符合标准 - 我欢迎对此发表评论。

* * *

更新 - 2008 年 11 月 7 日：

看起来虽然这段代码在语法上是正确的，但 MSVC 和 Comeau C++ 显示的行为不符合标准（感谢[Leon Timmermans](https://stackoverflow.com/users/4727/leon-timmermans)和[litb](https://stackoverflow.com/users/34509/litb)为我指明了正确的方向）。C++03 标准规定如下：

> 14.6.2 从属名称 [temp.dep]
> 
> 第 3 段
> 
> 在类模板或类模板成员的定义中，如果类模板的基类依赖于模板参数，则在类定义点的非限定名称查找期间不会检查基类范围模板或成员，或在类模板或成员的实例化期间。

因此，当 MSVC 或 Comeau 考虑在模板实例化时在调用站点执行名称查找的`toString()`成员函数时，这是不正确的（即使它实际上是我在这种情况下寻找的行为）。`T``doToString()`

GCC 和 Digital Mars 的行为看起来是正确的——在这两种情况下，非成员`toString()`函数都绑定到调用。

老鼠 - 我以为我可能找到了一个聪明的解决方案，但我发现了几个编译器错误......

* * *

```
#include <iostream>
#include <string>

struct Hello
{
    std::string toString() {
        return "Hello";
    }
};

struct Generic {};

// the following namespace keeps the toString() method out of
//  most everything - except the other stuff in this
//  compilation unit

namespace {
    std::string toString()
    {
        return "toString not defined";
    }

    template <typename T>
    class optionalToStringImpl : public T
    {
    public:
        std::string doToString() {

            // in theory, the name lookup for this call to 
            //  toString() should find the toString() in 
            //  the base class T if one exists, but if one 
            //  doesn't exist in the base class, it'll 
            //  find the free toString() function in 
            //  the private namespace.
            //
            // This theory works for MSVC (all versions
            //  from VC6 to VC9) and Comeau C++, but
            //  does not work with MinGW 3.4.5 or 
            //  Digital Mars 8.42n
            //
            // I'm honestly not sure what the standard says 
            //  is the correct behavior here - it's sort 
            //  of like ADL (Argument Dependent Lookup - 
            //  also known as Koenig Lookup) but without
            //  arguments (except the implied "this" pointer)

            return toString();
        }
    };
}

template <typename T>
std::string optionalToString(T & obj)
{
    // ugly, hacky cast...
    optionalToStringImpl<T>* temp = reinterpret_cast<optionalToStringImpl<T>*>( &obj);

    return temp->doToString();
}

int
main(int argc, char *argv[])
{
    Hello helloObj;
    Generic genericObj;

    std::cout << optionalToString( helloObj) << std::endl;
    std::cout << optionalToString( genericObj) << std::endl;
    return 0;
} 
```

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-02-02T08:35:41.037

如果该方法恰好在基类中定义，则 litb 此处提供的标准 C++ 解决方案将无法按预期工作。

有关处理这种情况的解决方案，请参阅：

俄语： [http ://www.rsdn.ru/forum/message/2759773.1.aspx](http://www.rsdn.ru/forum/message/2759773.1.aspx)

Roman.Perepelitsa 的英文翻译： [http ://groups.google.com/group/comp.lang.c++.moderated/tree/browse_frm/thread/4f7c7a96f9afbe44/c95a7b4c645e449f?pli=1](http://groups.google.com/group/comp.lang.c++.moderated/tree/browse_frm/thread/4f7c7a96f9afbe44/c95a7b4c645e449f?pli=1)

它非常聪明。然而，这种解决方案的一个问题是，如果正在测试的类型是不能用作基类的类型（例如原始类型），则会出现编译器错误

在 Visual Studio 中，我注意到如果使用没有参数的方法，则需要在参数周围插入一对多余的 () 以在 sizeof 表达式中推断 ()。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2018-01-22T15:01:55.680

`Has_foo`通过编写概念检查，使用 SFINAE 和模板偏特化的示例：

```
#include <type_traits>
struct A{};

struct B{ int foo(int a, int b);};

struct C{void foo(int a, int b);};

struct D{int foo();};

struct E: public B{};

// available in C++17 onwards as part of <type_traits>
template<typename...>
using void_t = void;

template<typename T, typename = void> struct Has_foo: std::false_type{};

template<typename T> 
struct Has_foo<T, void_t<
    std::enable_if_t<
        std::is_same<
            int, 
            decltype(std::declval<T>().foo((int)0, (int)0))
        >::value
    >
>>: std::true_type{};

static_assert(not Has_foo<A>::value, "A does not have a foo");
static_assert(Has_foo<B>::value, "B has a foo");
static_assert(not Has_foo<C>::value, "C has a foo with the wrong return. ");
static_assert(not Has_foo<D>::value, "D has a foo with the wrong arguments. ");
static_assert(Has_foo<E>::value, "E has a foo since it inherits from B"); 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2021-06-11T19:33:58.667

这是我在 C++20 中找到的最简洁的方式，与您的问题非常接近：

```
template<class T>
std::string optionalToString(T* obj)
{
  if constexpr (requires { obj->toString(); })
    return obj->toString();
  else
    return "toString not defined";
} 
```

在 Godbolt 上实时查看：[https ://gcc.godbolt.org/z/5jb1d93Ms](https://gcc.godbolt.org/z/5jb1d93Ms)

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2011-01-26T21:45:11.023

MSVC 具有 __if_exists 和 __if_not_exists 关键字 ( [Doc](http://msdn.microsoft.com/en-us/library/x7wy9xh3(VS.80).aspx) )。与 Nicola 的 typeof-SFINAE 方法一起，我可以像 OP 所寻找的那样为 GCC 和 MSVC 创建一个检查。

**更新：**来源可以在[这里找到](https://github.com/nob13/sfserialization/blob/master/sfserialization/isdefault.h)

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2013-11-06T15:16:13.753

我修改了[https://stackoverflow.com/a/264088/2712152](https://stackoverflow.com/a/264088/2712152)中提供的解决方案，使其更加通用。此外，由于它不使用任何新的 C++11 功能，我们可以将它与旧编译器一起使用，并且也应该与 msvc 一起使用。但是编译器应该允许 C99 使用它，因为它使用可变参数宏。

以下宏可用于检查特定类是否具有特定的 typedef。

```
/** 
 * @class      : HAS_TYPEDEF
 * @brief      : This macro will be used to check if a class has a particular
 * typedef or not.
 * @param typedef_name : Name of Typedef
 * @param name  : Name of struct which is going to be run the test for
 * the given particular typedef specified in typedef_name
 */
#define HAS_TYPEDEF(typedef_name, name)                           \
   template <typename T>                                          \
   struct name {                                                  \
      typedef char yes[1];                                        \
      typedef char no[2];                                         \
      template <typename U>                                       \
      struct type_check;                                          \
      template <typename _1>                                      \
      static yes& chk(type_check<typename _1::typedef_name>*);    \
      template <typename>                                         \
      static no& chk(...);                                        \
      static bool const value = sizeof(chk<T>(0)) == sizeof(yes); \
   } 
```

以下宏可用于检查特定类是否具有特定成员函数以及任何给定数量的参数。

```
/** 
 * @class      : HAS_MEM_FUNC
 * @brief      : This macro will be used to check if a class has a particular
 * member function implemented in the public section or not. 
 * @param func : Name of Member Function
 * @param name : Name of struct which is going to be run the test for
 * the given particular member function name specified in func
 * @param return_type: Return type of the member function
 * @param ellipsis(...) : Since this is macro should provide test case for every
 * possible member function we use variadic macros to cover all possibilities
 */
#define HAS_MEM_FUNC(func, name, return_type, ...)                \
   template <typename T>                                          \
   struct name {                                                  \
      typedef return_type (T::*Sign)(__VA_ARGS__);                \
      typedef char yes[1];                                        \
      typedef char no[2];                                         \
      template <typename U, U>                                    \
      struct type_check;                                          \
      template <typename _1>                                      \
      static yes& chk(type_check<Sign, &_1::func>*);              \
      template <typename>                                         \
      static no& chk(...);                                        \
      static bool const value = sizeof(chk<T>(0)) == sizeof(yes); \
   } 
```

我们可以使用上面的 2 个宏来执行 has_typedef 和 has_mem_func 的检查：

```
class A {
public:
  typedef int check;
  void check_function() {}
};

class B {
public:
  void hello(int a, double b) {}
  void hello() {}
};

HAS_MEM_FUNC(check_function, has_check_function, void, void);
HAS_MEM_FUNC(hello, hello_check, void, int, double);
HAS_MEM_FUNC(hello, hello_void_check, void, void);
HAS_TYPEDEF(check, has_typedef_check);

int main() {
  std::cout << "Check Function A:" << has_check_function<A>::value << std::endl;
  std::cout << "Check Function B:" << has_check_function<B>::value << std::endl;
  std::cout << "Hello Function A:" << hello_check<A>::value << std::endl;
  std::cout << "Hello Function B:" << hello_check<B>::value << std::endl;
  std::cout << "Hello void Function A:" << hello_void_check<A>::value << std::endl;
  std::cout << "Hello void Function B:" << hello_void_check<B>::value << std::endl;
  std::cout << "Check Typedef A:" << has_typedef_check<A>::value << std::endl;
  std::cout << "Check Typedef B:" << has_typedef_check<B>::value << std::endl;
} 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2010-06-23T13:56:49.030

奇怪的没有人提出我曾经在这个网站上看到的以下好技巧：

```
template <class T>
struct has_foo
{
    struct S { void foo(...); };
    struct derived : S, T {};

    template <typename V, V> struct W {};

    template <typename X>
    char (&test(W<void (X::*)(), &X::foo> *))[1];

    template <typename>
    char (&test(...))[2];

    static const bool value = sizeof(test<derived>(0)) == 1;
}; 
```

你必须确保 T 是一个类。似乎 foo 查找中的歧义是替换失败。我让它在 gcc 上工作，但不确定它是否是标准的。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2016-05-10T15:02:54.153

可用于检查类型是否支持某些“功能”的通用模板：

```
#include <type_traits>

template <template <typename> class TypeChecker, typename Type>
struct is_supported
{
    // these structs are used to recognize which version
    // of the two functions was chosen during overload resolution
    struct supported {};
    struct not_supported {};

    // this overload of chk will be ignored by SFINAE principle
    // if TypeChecker<Type_> is invalid type
    template <typename Type_>
    static supported chk(typename std::decay<TypeChecker<Type_>>::type *);

    // ellipsis has the lowest conversion rank, so this overload will be
    // chosen during overload resolution only if the template overload above is ignored
    template <typename Type_>
    static not_supported chk(...);

    // if the template overload of chk is chosen during
    // overload resolution then the feature is supported
    // if the ellipses overload is chosen the the feature is not supported
    static constexpr bool value = std::is_same<decltype(chk<Type>(nullptr)),supported>::value;
}; 
```

检查是否存在`foo`与签名兼容的方法的模板`double(const char*)`

```
// if T doesn't have foo method with the signature that allows to compile the bellow
// expression then instantiating this template is Substitution Failure (SF)
// which Is Not An Error (INAE) if this happens during overload resolution
template <typename T>
using has_foo = decltype(double(std::declval<T>().foo(std::declval<const char*>()))); 
```

例子

```
// types that support has_foo
struct struct1 { double foo(const char*); };            // exact signature match
struct struct2 { int    foo(const std::string &str); }; // compatible signature
struct struct3 { float  foo(...); };                    // compatible ellipsis signature
struct struct4 { template <typename T>
                 int    foo(T t); };                    // compatible template signature

// types that do not support has_foo
struct struct5 { void        foo(const char*); }; // returns void
struct struct6 { std::string foo(const char*); }; // std::string can't be converted to double
struct struct7 { double      foo(      int *); }; // const char* can't be converted to int*
struct struct8 { double      bar(const char*); }; // there is no foo method

int main()
{
    std::cout << std::boolalpha;

    std::cout << is_supported<has_foo, int    >::value << std::endl; // false
    std::cout << is_supported<has_foo, double >::value << std::endl; // false

    std::cout << is_supported<has_foo, struct1>::value << std::endl; // true
    std::cout << is_supported<has_foo, struct2>::value << std::endl; // true
    std::cout << is_supported<has_foo, struct3>::value << std::endl; // true
    std::cout << is_supported<has_foo, struct4>::value << std::endl; // true

    std::cout << is_supported<has_foo, struct5>::value << std::endl; // false
    std::cout << is_supported<has_foo, struct6>::value << std::endl; // false
    std::cout << is_supported<has_foo, struct7>::value << std::endl; // false
    std::cout << is_supported<has_foo, struct8>::value << std::endl; // false

    return 0;
} 
```

[http://coliru.stacked-crooked.com/a/83c6a631ed42cea4](http://coliru.stacked-crooked.com/a/83c6a631ed42cea4)

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2020-09-10T05:26:41.377

我知道这个问题已经有好几年了，但我认为对于像我这样的人来说，拥有一个更完整的更新答案会很有用，它也适用于`const`重载方法，例如`std::vector<>::begin`.

基于该[答案](https://stackoverflow.com/a/257382/4602726)和我后续问题的答案，这是一个更完整的答案[。](https://stackoverflow.com/a/63818399/4602726)请注意，这只适用于 C++11 及更高版本。

```
#include <iostream>
#include <vector>

class EmptyClass{};

template <typename T>
class has_begin
{
    private:
    has_begin() = delete;

    struct one { char x[1]; };
    struct two { char x[2]; };

    template <typename C> static one test( decltype(void(std::declval<C &>().begin())) * ) ;
    template <typename C> static two test(...);    

public:
    static constexpr bool value = sizeof(test<T>(0)) == sizeof(one);
};

int main(int argc, char *argv[])
{
    std::cout << std::boolalpha;
    std::cout << "vector<int>::begin() exists: " << has_begin<std::vector<int>>::value << std::endl;
    std::cout << "EmptyClass::begin() exists: " << has_begin<EmptyClass>::value << std::endl;
    return 0;
} 
```

或更短的版本：

```
#include <iostream>
#include <vector>

class EmptyClass{};

template <typename T, typename = void>
struct has_begin : std::false_type {};

template <typename T>
struct has_begin<T, decltype(void(std::declval<T &>().begin()))> : std::true_type {};

int main(int argc, char *argv[])
{
    std::cout << std::boolalpha;
    std::cout << "vector<int>::begin() exists: " << has_begin<std::vector<int>>::value << std::endl;
    std::cout << "EmptyClass exists: " << has_begin<EmptyClass>::value << std::endl;
} 
```

请注意，此处必须提供完整的示例调用。这意味着如果我们测试该`resize`方法的存在，那么我们将放置`resize(0)`.

**深层魔法解释**：

这个问题的第一个答案是使用的`test( decltype(&C::helloworld) )`；但是，当它正在测试的方法由于 const 重载而模棱两可时，这是有问题的，从而使替换尝试失败。

为了解决这种歧义，我们使用 void 语句，它可以接受任何参数，因为它总是被翻译成 a `noop`，因此歧义被取消，只要方法存在，调用就有效：

```
has_begin<T, decltype(void(std::declval<T &>().begin()))> 
```

这是按顺序发生的事情：我们使用`std::declval<T &>()`创建一个可调用的值，`begin`然后可以调用它。之后， 的值`begin`作为参数传递给 void 语句。然后，我们使用内置函数检索该 void 表达式的类型，`decltype`以便将其用作模板类型参数。如果`begin`不存在，则替换无效，并且根据 SFINAE 使用其他声明代替。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2013-07-08T19:25:41.937

这个解决方案怎么样？

```
#include <type_traits>

template <typename U, typename = void> struct hasToString : std::false_type { };

template <typename U>
struct hasToString<U,
  typename std::enable_if<bool(sizeof(&U::toString))>::type
> : std::true_type { }; 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2015-10-25T10:28:37.920

这里有很多答案，但我找不到一个版本，它执行*真正的*方法解析排序，同时不使用任何较新的 c++ 功能（仅使用 c++98 功能）。
注意：此版本经过测试，可与 vc++2013、g++ 5.2.0 和在线编译器一起使用。

所以我想出了一个只使用 sizeof() 的版本：

```
template<typename T> T declval(void);

struct fake_void { };
template<typename T> T &operator,(T &,fake_void);
template<typename T> T const &operator,(T const &,fake_void);
template<typename T> T volatile &operator,(T volatile &,fake_void);
template<typename T> T const volatile &operator,(T const volatile &,fake_void);

struct yes { char v[1]; };
struct no  { char v[2]; };
template<bool> struct yes_no:yes{};
template<> struct yes_no<false>:no{};

template<typename T>
struct has_awesome_member {
 template<typename U> static yes_no<(sizeof((
   declval<U>().awesome_member(),fake_void()
  ))!=0)> check(int);
 template<typename> static no check(...);
 enum{value=sizeof(check<T>(0)) == sizeof(yes)};
};

struct foo { int awesome_member(void); };
struct bar { };
struct foo_void { void awesome_member(void); };
struct wrong_params { void awesome_member(int); };

static_assert(has_awesome_member<foo>::value,"");
static_assert(!has_awesome_member<bar>::value,"");
static_assert(has_awesome_member<foo_void>::value,"");
static_assert(!has_awesome_member<wrong_params>::value,""); 
```

现场演示（带有扩展的返回类型检查和 vc++2010 解决方法）：[http ://cpp.sh/5b2vs](http://cpp.sh/5b2vs)

没有来源，因为我自己想出了它。

在 g++ 编译器上运行 Live demo 时，请注意允许数组大小为 0，这意味着使用的 static_assert 不会触发编译器错误，即使它失败。
一种常用的解决方法是将宏中的“typedef”替换为“extern”。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2020-08-28T08:17:13.210

我的看法：在不为每一个都制作冗长的类型特征，或使用实验性功能或长代码的情况下，普遍地确定某些东西是否可调用：

```
template<typename Callable, typename... Args, typename = decltype(declval<Callable>()(declval<Args>()...))>
std::true_type isCallableImpl(Callable, Args...) { return {}; }

std::false_type isCallableImpl(...) { return {}; }

template<typename... Args, typename Callable>
constexpr bool isCallable(Callable callable) {
    return decltype(isCallableImpl(callable, declval<Args>()...)){};
} 
```

用法：

```
constexpr auto TO_STRING_TEST = [](auto in) -> decltype(in.toString()) { return {}; };
constexpr bool TO_STRING_WORKS = isCallable<T>(TO_STRING_TEST); 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2014-01-11T13:54:13.657

这是我的版本，它处理所有可能的具有任意数量的成员函数重载，包括模板成员函数，可能带有默认参数。当使用给定的 arg 类型对某些类类型进行成员函数调用时，它区分了 3 种互斥场景：(1) 有效，或 (2) 模棱两可，或 (3) 不可行。示例用法：

```
#include <string>
#include <vector>

HAS_MEM(bar)
HAS_MEM_FUN_CALL(bar)

struct test
{
   void bar(int);
   void bar(double);
   void bar(int,double);

   template < typename T >
   typename std::enable_if< not std::is_integral<T>::value >::type
   bar(const T&, int=0){}

   template < typename T >
   typename std::enable_if< std::is_integral<T>::value >::type
   bar(const std::vector<T>&, T*){}

   template < typename T >
   int bar(const std::string&, int){}
}; 
```

现在你可以像这样使用它：

```
int main(int argc, const char * argv[])
{
   static_assert( has_mem_bar<test>::value , "");

   static_assert( has_valid_mem_fun_call_bar<test(char const*,long)>::value , "");
   static_assert( has_valid_mem_fun_call_bar<test(std::string&,long)>::value , "");

   static_assert( has_valid_mem_fun_call_bar<test(std::vector<int>, int*)>::value , "");
   static_assert( has_no_viable_mem_fun_call_bar<test(std::vector<double>, double*)>::value , "");

   static_assert( has_valid_mem_fun_call_bar<test(int)>::value , "");
   static_assert( std::is_same<void,result_of_mem_fun_call_bar<test(int)>::type>::value , "");

   static_assert( has_valid_mem_fun_call_bar<test(int,double)>::value , "");
   static_assert( not has_valid_mem_fun_call_bar<test(int,double,int)>::value , "");

   static_assert( not has_ambiguous_mem_fun_call_bar<test(double)>::value , "");
   static_assert( has_ambiguous_mem_fun_call_bar<test(unsigned)>::value , "");

   static_assert( has_viable_mem_fun_call_bar<test(unsigned)>::value , "");
   static_assert( has_viable_mem_fun_call_bar<test(int)>::value , "");

   static_assert( has_no_viable_mem_fun_call_bar<test(void)>::value , "");

   return 0;
} 
```

这是用 c++11 编写的代码，但是，您可以轻松地将其移植（稍作调整）到具有 typeof 扩展（例如 gcc）的非 c++11。您可以用自己的宏替换 HAS_MEM 宏。

```
#pragma once

#if __cplusplus >= 201103

#include <utility>
#include <type_traits>

#define HAS_MEM(mem)                                                                                     \
                                                                                                     \
template < typename T >                                                                               \
struct has_mem_##mem                                                                                  \
{                                                                                                     \
  struct yes {};                                                                                     \
  struct no  {};                                                                                     \
                                                                                                     \
  struct ambiguate_seed { char mem; };                                                               \
  template < typename U > struct ambiguate : U, ambiguate_seed {};                                   \
                                                                                                     \
  template < typename U, typename = decltype(&U::mem) > static constexpr no  test(int);              \
  template < typename                                 > static constexpr yes test(...);              \
                                                                                                     \
  static bool constexpr value = std::is_same<decltype(test< ambiguate<T> >(0)),yes>::value ;         \
  typedef std::integral_constant<bool,value>    type;                                                \
};

#define HAS_MEM_FUN_CALL(memfun)                                                                         \
                                                                                                     \
template < typename Signature >                                                                       \
struct has_valid_mem_fun_call_##memfun;                                                               \
                                                                                                     \
template < typename T, typename... Args >                                                             \
struct has_valid_mem_fun_call_##memfun< T(Args...) >                                                  \
{                                                                                                     \
  struct yes {};                                                                                     \
  struct no  {};                                                                                     \
                                                                                                     \
  template < typename U, bool = has_mem_##memfun<U>::value >                                         \
  struct impl                                                                                        \
  {                                                                                                  \
     template < typename V, typename = decltype(std::declval<V>().memfun(std::declval<Args>()...)) > \
     struct test_result { using type = yes; };                                                       \
                                                                                                     \
     template < typename V > static constexpr typename test_result<V>::type test(int);               \
     template < typename   > static constexpr                            no test(...);               \
                                                                                                     \
     static constexpr bool value = std::is_same<decltype(test<U>(0)),yes>::value;                    \
     using type = std::integral_constant<bool, value>;                                               \
  };                                                                                                 \
                                                                                                     \
  template < typename U >                                                                            \
  struct impl<U,false> : std::false_type {};                                                         \
                                                                                                     \
  static constexpr bool value = impl<T>::value;                                                      \
  using type = std::integral_constant<bool, value>;                                                  \
};                                                                                                    \
                                                                                                     \
template < typename Signature >                                                                       \
struct has_ambiguous_mem_fun_call_##memfun;                                                           \
                                                                                                     \
template < typename T, typename... Args >                                                             \
struct has_ambiguous_mem_fun_call_##memfun< T(Args...) >                                              \
{                                                                                                     \
  struct ambiguate_seed { void memfun(...); };                                                       \
                                                                                                     \
  template < class U, bool = has_mem_##memfun<U>::value >                                            \
  struct ambiguate : U, ambiguate_seed                                                               \
  {                                                                                                  \
    using ambiguate_seed::memfun;                                                                    \
    using U::memfun;                                                                                 \
  };                                                                                                 \
                                                                                                     \
  template < class U >                                                                               \
  struct ambiguate<U,false> : ambiguate_seed {};                                                     \
                                                                                                     \
  static constexpr bool value = not has_valid_mem_fun_call_##memfun< ambiguate<T>(Args...) >::value; \
  using type = std::integral_constant<bool, value>;                                                  \
};                                                                                                    \
                                                                                                     \
template < typename Signature >                                                                       \
struct has_viable_mem_fun_call_##memfun;                                                              \
                                                                                                     \
template < typename T, typename... Args >                                                             \
struct has_viable_mem_fun_call_##memfun< T(Args...) >                                                 \
{                                                                                                     \
  static constexpr bool value = has_valid_mem_fun_call_##memfun<T(Args...)>::value                   \
                             or has_ambiguous_mem_fun_call_##memfun<T(Args...)>::value;              \
  using type = std::integral_constant<bool, value>;                                                  \
};                                                                                                    \
                                                                                                     \
template < typename Signature >                                                                       \
struct has_no_viable_mem_fun_call_##memfun;                                                           \
                                                                                                     \
template < typename T, typename... Args >                                                             \
struct has_no_viable_mem_fun_call_##memfun < T(Args...) >                                             \
{                                                                                                     \
  static constexpr bool value = not has_viable_mem_fun_call_##memfun<T(Args...)>::value;             \
  using type = std::integral_constant<bool, value>;                                                  \
};                                                                                                    \
                                                                                                     \
template < typename Signature >                                                                       \
struct result_of_mem_fun_call_##memfun;                                                               \
                                                                                                     \
template < typename T, typename... Args >                                                             \
struct result_of_mem_fun_call_##memfun< T(Args...) >                                                  \
{                                                                                                     \
  using type = decltype(std::declval<T>().memfun(std::declval<Args>()...));                          \
};

#endif 
```

* * *

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-01-14T23:43:07.427

您可以跳过 C++14 中的所有元编程，只需使用[Fit](https://github.com/pfultz2/Fit)库中[`fit::conditional`](http://fit.readthedocs.io/en/latest/include/fit/conditional.html)的代码编写：

```
template<class T>
std::string optionalToString(T* x)
{
    return fit::conditional(
        [](auto* obj) -> decltype(obj->toString()) { return obj->toString(); },
        [](auto*) { return "toString not defined"; }
    )(x);
} 
```

您也可以直接从 lambdas 创建函数：

```
FIT_STATIC_LAMBDA_FUNCTION(optionalToString) = fit::conditional(
    [](auto* obj) -> decltype(obj->toString(), std::string()) { return obj->toString(); },
    [](auto*) -> std::string { return "toString not defined"; }
); 
```

但是，如果您使用的编译器不支持通用 lambda，则必须编写单独的函数对象：

```
struct withToString
{
    template<class T>
    auto operator()(T* obj) const -> decltype(obj->toString(), std::string())
    {
        return obj->toString();
    }
};

struct withoutToString
{
    template<class T>
    std::string operator()(T*) const
    {
        return "toString not defined";
    }
};

FIT_STATIC_FUNCTION(optionalToString) = fit::conditional(
    withToString(),
    withoutToString()
); 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2020-11-21T16:33:35.613

可能不如其他示例好，但这是我为 C++11 提出的。这适用于选择重载方法。

```
template <typename... Args>
struct Pack {};

#define Proxy(T) ((T &)(*(int *)(nullptr)))

template <typename Class, typename ArgPack, typename = nullptr_t>
struct HasFoo
{
    enum { value = false };
};

template <typename Class, typename... Args>
struct HasFoo<
    Class,
    Pack<Args...>,
    decltype((void)(Proxy(Class).foo(Proxy(Args)...)), nullptr)>
{
    enum { value = true };
}; 
```

示例用法

```
struct Object
{
    int foo(int n)         { return n; }
#if SOME_CONDITION
    int foo(int n, char c) { return n + c; }
#endif
};

template <bool has_foo_int_char>
struct Dispatcher;

template <>
struct Dispatcher<false>
{
    template <typename Object>
    static int exec(Object &object, int n, char c)
    {
        return object.foo(n) + c;
    }
};

template <>
struct Dispatcher<true>
{
    template <typename Object>
    static int exec(Object &object, int n, char c)
    {
        return object.foo(n, c);
    }
};

int runExample()
{
    using Args = Pack<int, char>;
    enum { has_overload = HasFoo<Object, Args>::value };
    Object object;
    return Dispatcher<has_overload>::exec(object, 100, 'a');
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-11-01T21:35:03.883

这是工作代码的示例。

```
template<typename T>
using toStringFn = decltype(std::declval<const T>().toString());

template <class T, toStringFn<T>* = nullptr>
std::string optionalToString(const T* obj, int)
{
    return obj->toString();
}

template <class T>
std::string optionalToString(const T* obj, long)
{
    return "toString not defined";
}

int main()
{
    A* a;
    B* b;

    std::cout << optionalToString(a, 0) << std::endl; // This is A
    std::cout << optionalToString(b, 0) << std::endl; // toString not defined
} 
```

`toStringFn<T>* = nullptr`将启用带有额外`int`参数的函数，该参数优先于`long`使用`0`.

如果实现了函数，您可以对返回的函数使用相同的原则`true`。

```
template <typename T>
constexpr bool toStringExists(long)
{
    return false;
}

template <typename T, toStringFn<T>* = nullptr>
constexpr bool toStringExists(int)
{
    return true;
}

int main()
{
    A* a;
    B* b;

    std::cout << toStringExists<A>(0) << std::endl; // true
    std::cout << toStringExists<B>(0) << std::endl; // false
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-12-31T12:18:11.670

我有一个类似的问题：

一个模板类，它可能派生自几个基类，一些具有特定成员，而另一些则没有。

我以类似于“typeof”（Nicola Bonelli 的）答案的方式解决了它，但使用 decltype，因此它可以在 MSVS 上正确编译和运行：

```
#include <iostream>
#include <string>

struct Generic {};    
struct HasMember 
{
  HasMember() : _a(1) {};
  int _a;
};    

// SFINAE test
template <typename T>
class S : public T
{
public:
  std::string foo (std::string b)
  {
    return foo2<T>(b,0);
  }

protected:
  template <typename T> std::string foo2 (std::string b, decltype (T::_a))
  {
    return b + std::to_string(T::_a);
  }
  template <typename T> std::string foo2 (std::string b, ...)
  {
    return b + "No";
  }
};

int main(int argc, char *argv[])
{
  S<HasMember> d1;
  S<Generic> d2;

  std::cout << d1.foo("HasMember: ") << std::endl;
  std::cout << d2.foo("Generic: ") << std::endl;
  return 0;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2021-02-13T21:54:05.480

我一直在寻找一种方法，它允许以某种方式不将结构名称`has_member`与类成员的名称联系起来。实际上，如果 lambda 可以在未计算的表达式中被允许，这会更简单（这是标准禁止的），即`has_member<ClassName, SOME_MACRO_WITH_DECLTYPE(member_name)>`

```
#include <iostream>
#include <list>
#include <type_traits>

#define LAMBDA_FOR_MEMBER_NAME(NAME) [](auto object_instance) -> decltype(&(decltype(object_instance)::NAME)) {}

template<typename T>
struct TypeGetter
{
    constexpr TypeGetter() = default;
    constexpr TypeGetter(T) {}
    using type = T;

    constexpr auto getValue()
    {
        return std::declval<type>();
    }
};

template<typename T, typename LambdaExpressionT>
struct has_member {
    using lambda_prototype = LambdaExpressionT;

    //SFINAE
    template<class ValueT, class = void>
    struct is_void_t_deducable : std::false_type {};

    template<class ValueT>
    struct is_void_t_deducable<ValueT,
        std::void_t<decltype(std::declval<lambda_prototype>()(std::declval<ValueT>()))>> : std::true_type {};

    static constexpr bool value = is_void_t_deducable<T>::value;
};

struct SimpleClass
{
    int field;
    void method() {}
};

int main(void)
{   
    const auto helpful_lambda = LAMBDA_FOR_MEMBER_NAME(field);
    using member_field = decltype(helpful_lambda);
    std::cout << has_member<SimpleClass, member_field>::value;

    const auto lambda = LAMBDA_FOR_MEMBER_NAME(method);
    using member_method = decltype(lambda);
    std::cout << has_member<SimpleClass, member_method>::value;

} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-10-17T12:23:07.653

## c++20 之前，简单情况下的简单选项：

如果您知道您的类是默认可构造的，我们可以使语法更简单。

我们将从最简单的情况开始：默认可构造并且我们知道预期的返回类型。示例方法：

```
int foo (); 
```

我们可以在没有 的情况下编写类型特征`declval`：

```
template <auto v>
struct tag_v
{
    constexpr static auto value = v;
};

template <class, class = int>
struct has_foo_method : tag_v<false> {};

template <class T>
struct has_foo_method <T, decltype(T().foo())>
    : tag_v<true> {}; 
```

[演示](https://godbolt.org/z/9c93KoP9K)

请注意，我们将默认类型设置为，`int`因为这是`foo`.

如果有多个可接受的返回类型，那么我们添加第二个参数到`decltype`与默认类型相同的类型，覆盖第一个参数：

```
decltype(T().foo(), int()) 
```

[演示](https://godbolt.org/z/7W6oW65xf)

（`int`这里的类型并不重要——我使用它是因为它只有 3 个字母）

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2019-02-25T13:16:47.470

```
template<class T>
auto optionalToString(T* obj)
->decltype( obj->toString(), std::string() )
{
     return obj->toString();
}

template<class T>
auto optionalToString(T* obj)
->decltype( std::string() )
{
     throw "Error!";
} 
```

# code-analysis - 您停用了 FxCop 中的哪条规则？

> ID：257301
> 
> 赞同：4
> 
> 时间：2008-11-02T20:20:52.617
> 
> 标签：code-analysis, fxcop, rules

我个人还没有使用 FxCop。我们想在进行代码分析之前先进行单元测试。但是，您会永久停用哪些规则？您会在什么情况下暂时停用哪些规则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-02T20:38:10.990

我不喜欢规则 CA1021：避免输出参数。Out 参数可用于许多不同的模式（包括 .Net Try* 模式）。Out 当然可以被过度使用，但实际上为它设置 FxCop 规则似乎有点过头了。

[规则 CA1021](http://msdn.microsoft.com/en-us/library/ms182131(VS.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T00:37:40.333

[CA2210 程序集应该有有效的强名称](http://msdn.microsoft.com/en-us/library/ms182127.aspx)是一个烦人的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T20:37:01.367

根据您正在构建的系统，您需要关闭一整套迂腐的废话。我建议检查 FxCop 输出并自己决定。一个男人的迂腐是另一个“必须拥有”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-02T21:21:40.450

我不使用禁止在方法/事件名称中使用下划线的命名约定规则。我已经习惯了“Button1_Click”。Visual Studio 会自动插入下划线，因此您必须手动删除它们。我只是认为让他们一个人呆着更容易。而且，我在创建方法/事件时添加下划线。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T21:53:50.790

它抱怨“ID”并建议“Id”......即使这遵循“双字符缩写都是大写”规则：O）

# apache-flex - 如何禁用 Flex 组合框中的单个项目，使其不可点击？

> ID：257319
> 
> 赞同：1
> 
> 时间：2008-11-02T20:30:45.747
> 
> 标签：apache-flex

我想在 flex 中创建一个组合框，它将采用三个值，Available、Unavailable 和 Busy。限制是，我不应该允许用户直接从不可用到忙碌。因此，当用户选择不可用时，我应该禁用忙碌项目（不可选择），但用户将能够直接从可用到忙碌。我无法找到一种直接的方法来禁用 Flex 组合框中的项目。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T21:13:05.600

您是否考虑过使用单选按钮而不是组合框？一方面，很清楚如何为单选按钮执行此操作。此外，无需单击即可显示可用选项通常更友好。（特别是如果在这种情况下，您正在添加一个选项“可用，但由于某种原因现在无法在此组合框项目中显示”的可能性）。

如果你真的想要一个组合框，你可以使用点击事件以非标准的方式显示它，可能会改变它的样式；然后，如果仍然单击，然后，在选定的事件中，拒绝选择（希望说明原因），

或者，如果您只想将其从列表中删除，您可以让单击侦听器事件根据条件每次重新填充源列表。但这也可能让用户感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T06:00:13.053

你也可以看看

[www.stoimen.com/blog/2009/03/05/flex-3-combobox-disabled-options/](http://www.stoimen.com/blog/2009/03/05/flex-3-combobox-disabled-options/)

其中引用

[wmcai.blog.163.com/blog/static/4802420088945053961/](http://wmcai.blog.163.com/blog/static/4802420088945053961/)

（注意 NoScript 用户必须至少暂时允许 163.com 和 126.com 才能正常查看此页面）

即使我在下拉列表中添加了能够正确处理键盘事件的代码，它也能很好地工作

完整的自我工作示例可在

[http://olivierbourdon.homedns.org/OpenSource/combos.zip](http://olivierbourdon.homedns.org/OpenSource/combos.zip)

再次感谢您的出色工作

# oracle - Oracle：如何在时间戳中添加分钟？

> ID：257324
> 
> 赞同：44
> 
> 时间：2008-11-02T20:34:31.543
> 
> 标签：oracle, date, timestamp, date-arithmetic

我需要将 30 分钟添加到 Oracle 日期列中的值。我在我的 SELECT 语句中通过指定

`to_char(date_and_time + (.000694 * 31)`

大多数情况下都可以正常工作。但不是当时间在上午/下午边界时。例如，将 30 分钟添加到`12:30`[which is PM] 将返回`1:00`which is AM。我期望的答案是`13:00`。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-11-02T21:22:38.887

除了能够将天数添加到日期之外，您还可以使用间隔数据类型（假设您在`Oracle 9i`或以后），这可能更容易阅读，

```
SQL> ed
Wrote file afiedt.buf
SELECT sysdate, sysdate + interval '30' minute FROM dual
SQL> /

SYSDATE              SYSDATE+INTERVAL'30'
-------------------- --------------------
02-NOV-2008 16:21:40 02-NOV-2008 16:51:40 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-11-03T12:59:46.220

所有其他答案基本上都是正确的，但我认为没有人直接回答你原来的问题。

假设您的示例中的“date_and_time”是一个类型为 DATE 或 TIMESTAMP 的列，我认为您只需要更改它：

```
to_char(date_and_time + (.000694 * 31)) 
```

对此：

```
to_char(date_and_time + (.000694 * 31), 'DD-MON-YYYY HH24:MI') 
```

听起来您的默认日期格式使用小时的“HH”代码，而不是“HH24”。

另外，我认为您的常数术语既令人困惑又不精确。我猜您所做的是计算 (.000694) 大约是一分钟的值，然后将其乘以要添加的分钟数（示例中为 31，尽管您在文本中说 30）。

我也会从一天开始，并将其划分为代码中所需的单元。在这种情况下，(1/48) 将是 30 分钟；或者，如果您想为了清楚起见将其分解，您可以写成 ( (1/24) * (1/2) )。

这将避免舍入错误（除了浮点中固有的那些在这里应该没有意义的错误）并且更清晰，至少对我来说。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-06-11T08:22:50.590

```
UPDATE "TABLE" 
SET DATE_FIELD = CURRENT_TIMESTAMP + interval '48' minute 
WHERE (...) 
```

其中`interval`之一在哪里

*   年
*   月
*   天
*   小时
*   分钟
*   第二

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-02-22T13:14:26.290

来自[http://www.orafaq.com/faq/how_does_one_add_a_day_hour_minute_second_to_a_date_value](http://www.orafaq.com/faq/how_does_one_add_a_day_hour_minute_second_to_a_date_value)

SYSDATE 伪列显示当前系统日期和时间。向 SYSDATE 添加 1 将使日期提前 1 天。使用分数将小时、分钟或秒添加到日期

```
SQL> select sysdate, sysdate+1/24, sysdate +1/1440, sysdate + 1/86400 from dual;

SYSDATE              SYSDATE+1/24         SYSDATE+1/1440       SYSDATE+1/86400
-------------------- -------------------- -------------------- --------------------
03-Jul-2002 08:32:12 03-Jul-2002 09:32:12 03-Jul-2002 08:33:12 03-Jul-2002 08:32:13 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-11-07T07:22:15.413

`interval`我更喜欢为此使用文字，因为`interval '30' minute`or`interval '5' second`更容易阅读`30 / (24 * 60)`或`5 / (24 * 60 * 69)`

例如

*   `some_date + interval '2' hour`
*   `some_date + interval '30' minute`
*   `some_date + interval '5' second`
*   `some_date + interval '2' day`

您还可以将多个单位组合成一个表达式：

*   `some_date + interval '2 3:06' day to minute`

将 2 天 3 小时 6 分钟添加到日期值

以上也是标准 SQL，也适用于其他几个 DBMS。

手册中的更多详细信息：[https ://docs.oracle.com/database/121/SQLRF/sql_elements003.htm#SQLRF00221](https://docs.oracle.com/database/121/SQLRF/sql_elements003.htm#SQLRF00221)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-02T20:48:55.133

如果字段的数据类型是日期或时间戳，那么如果您添加正确的天数（或者在您的情况下是一天的正确分数），Oracle 应该始终给出正确的结果。因此，如果您想在 30 分钟内提高价值，您应该使用：

```
select field + 0.5/24 from table; 
```

根据您提供的信息，我相信这是您尝试做的，我很确定它有效。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-12-01T21:31:12.160

我们可以不用这个吗

```
SELECT date_and_time + INTERVAL '20:00' MINUTE TO SECOND FROM dual; 
```

我是这个领域的新手。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-02T20:47:57.443

确保 Oracle 了解开始时间是 PM，并为最终输出指定 HH24 格式掩码。

```
SELECT to_char((to_date('12:40 PM', 'HH:MI AM') + (1/24/60) * 30), 'HH24:MI') as time
  FROM dual

TIME
---------
13:10 
```

注意：`'AM'`HH:MI 中的 只是 AM/PM 子午线指标的占位符。还可以`'PM'`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-16T21:39:01.703

很容易就喜欢这样

我在系统日期上增加了 10 分钟，并且始终优先使用 Db 服务器功能而不是自定义功能。

```
select to_char(sysdate + NUMTODSINTERVAL(10,'MINUTE'),'DD/MM/YYYY HH24:MI:SS') from dual; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T00:46:50.410

根据您的要求，您需要 to_char 的 HH24:MI 格式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-07T06:56:13.257

要在 oracle 中编辑日期，您可以尝试

```
 select to_char(<columnName> + 5 / 24 + 30 / (24 * 60),
           'DD/MM/RRRR hh:mi AM') AS <logicalName> from <tableName> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-11T20:59:38.363

Oracle 现在有新的内置函数来执行此操作：

```
select systimestamp START_TIME, systimestamp + NUMTODSINTERVAL(30, 'minute') end_time from dual 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-01-11T05:31:07.053

```
SELECT to_char(sysdate + (1/24/60) * 30, 'dd/mm/yy HH24:MI am') from dual; 
```

只需您可以将其与各种日期格式一起使用....

# windows - C(++) 编译器转换 - 请让 DJGPP 消失

> ID：257329
> 
> 赞同：3
> 
> 时间：2008-11-02T20:39:59.737
> 
> 标签：windows, gcc, kernel, compatibility, djgpp

我正在写一个内核，我有几个朋友和我一起做这个项目。我们一直在使用 DJGPP 编译该项目，但我们在以这种方式编译时遇到了一些跨平台兼容性问题，导致我在该项目上的主要 Partnet 无法在 Windows XP 上编译。（DJGPP 的 GCC 在 Windows XP 上存在超过 127 个参数列表的问题，但在 Vista 上没有相同参数列表的问题。因此，这一次，Vista 在某些方面比 XP 工作得更好。oO）

任何人，与其尝试一些肮脏的技巧来使该死的东西用 DJGPP 编译，我们决定我们要完全放弃 DJGPP 并使用不同版本的 GCC for windows。问题是，MinGW（据我所知）不允许我们对代码的汇编部分使用 NASM 语法，此时将其全部转换为 AT&T 语法会有点痛苦。当然可能，因为它在项目的早期阶段，但很痛苦。

所以现在你知道问题所在了。我的问题是：Windows 的 GCC 编译器发行版将允许我们最轻松地将这个项目移植到自身？理想情况下，我们正在寻找可以执行 NASM 汇编器语法的东西，不依赖外部 dll（这里是内核，它无法访问它们）并且可以在 Windows 上的多个版本上一致地工作。您对执行此操作的最佳方法有何建议，以及您推荐什么版本的 GCC for windows？

请注意，如果我们需要将项目转换为 AT&T 语法，那没关系，我不想这样做。我们实际上是在使用 NASM 来组装它的组装位，并生成一个有效的 .o 文件，但 MinGW 出于某种原因无法将其链接。我认为内联汇编位（可能是 5 行）已经是 AT&T 语法，正如 GCC 所要求的那样。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-02T20:53:21.113

您可能使用 -f 选项将错误的对象类型传递给 nasm。

我敢打赌你会通过-f coff。

您将需要通过 -f win32。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-19T19:54:04.257

构建一个交叉编译器。

[http://wiki.osdev.org/GCC_Cross-Compiler](http://wiki.osdev.org/GCC_Cross-Compiler)

这就是我从 DJGPP 过渡到 Windows 主机上进行开发时所做的。我推荐 Cygwin 方法，因为它比 MSYS 稍微稳定一些。

完成后，配置 NASM 以构建`elf32`目标文件，一切顺利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T22:05:09.737

您使用的是为 DOS 还是为 Windows 编译的 NASM？我没看，但可能有区别。此外，如果您的 NASM 太旧，它可能无法生成 MinGW 可以理解的内容。

快速谷歌搜索找到了一个[在 MinGW 下编译 x264 的教程](http://osdir.com/ml/video.x264.devel/2005-03/msg00033.html)，其中一个步骤是在 MinGW 上编译 NASM。

如果做不到这一点，您可以尝试（如对另一个答案的评论所建议的那样）使用 objcopy。

# language-agnostic - How do I explain what a "naive implementation" is?

> ID：257331
> 
> 赞同：34
> 
> 时间：2008-11-02T20:43:40.293
> 
> 标签：language-agnostic, complexity-theory

What is the clearest explanation of what computer scientists mean by "the naive implementation"? I need a good clear example which will illustrate — ideally, even to non-technical people — that the naive implementation may *technically* be a functioning solution to the problem, but *practically* be utterly unusable.

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-11-02T20:52:13.817

I'd try to keep it away from computers altogether. Ask your audience how they find an entry in a dictionary. (A normal dictionary of word definitions.)

The naive implementation is to start at the very beginning, and look at the first word. Oh, that's not the word we're looking for - look at the next one, etc. It's worth pointing out to the audience that they probably didn't even *think* of that way of doing things - we're smart enough to discount it immediately! It is, however, about the simplest way you could think of. (It might be interesting to ask them whether they can think of anything simpler, and check that they do really understand why it's simpler than the way we actually do it.)

The next implementation (and a pretty good one) is to start in the middle of the dictionary. Does the word we're looking for come before or after that? If it's before, turn to the page half way between the start and where we are now - otherwise, turn to the page half way between where we are now and the end, etc - binary chop.

The actual human implementation is to use our knowledge of letters to get very rapidly to "nearly the right place" - if we see "elephant" then we'll know it'll be "somewhere near the start" maybe about 1/5th of the way through. Once we've got to E (which we can do with very, very simple comparisons) we find EL etc.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-02T20:59:03.850

StackOverflow 的 Jeff Atwood 有一个与洗牌数组相关的简单算法的一个[很好的例子。](http://www.codinghorror.com/blog/archives/001015.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-02T20:49:24.103

Doing it the most straightforward, least tricky way available. One example is selection sort.

In this case naive does *not* mean bad or unusable. It just means not particularly good.

* * *

Taking [Jon Skeet's advice](https://stackoverflow.com/questions/257331/whats-the-best-example-of-a-naive-implementation/257349#257349) to heart you can describe selection sort as:

1.  Find the highest value in the list and put it first
2.  Find the next highest value and add it to the list
3.  Repeat step 2 until you run out of list

It is easy to do and easy to understand, but not necessarily the best.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-03T08:28:24.533

another naive implementation would be the use of recursion in computing for an integer's factorial in an imperative language. a more efficient solution in that case is to just use a loop.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-24T20:20:50.830

“朴素实施”几乎总是与“蛮力实施”同义。幼稚的实现通常是直观的，并且是第一个想到的，但也通常是 O(n^2) 或更糟，因此对于大输入来说花费太长时间太不实用。

编程竞赛充满了问题，其中天真的实现无法在可接受的时间内运行，问题的核心是提出一种改进的算法，该算法通常不那么明显，但运行速度更快。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-03T15:58:12.160

你能想到的最明显、最简单的求幂算法是什么？

`base ** exp`是`base * base * ... * base`，`exp`次：

```
double pow(double base, int exp) {
    double result = 1;
    for (int i = 0; i < exp; i++)
        result *= base;
    return result;
} 
```

但是，它不处理负指数。记住`base ** exp == 1 / base ** (-exp) == (1 / base) ** (-exp)`：

```
double pow(double base, int exp) {
    double result = 1;
    if (exp < 0) {
        base = 1 / base;
        exp = -exp;
    }
    for (int i = 0; i < exp; i++)
        result *= base;
    return result;
} 
```

不过，实际上可以`base ** exp`用少于`exp`乘法来计算！

```
double pow(double base, int exp) {
    double result = 1;
    if (exp < 0) {
        base = 1 / base;
        exp = -exp;
    }
    while (exp) {
        if (exp % 2) {
            result *= base;
            exp--;
        }
        else {
            base *= base;
            exp /= 2;
        }
    }
    return result * base;
} 
```

这利用了`base ** exp == (base * base) ** (exp / 2)`if`exp`是偶数的事实，并且只需要`log2(exp)`乘法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-03T16:28:23.833

我花时间仔细阅读了你的问题，我有一个完美的例子。

> 一个很好的清晰示例将说明 - 理想情况下，即使对非技术人员也是如此 - 幼稚的实现在*技术上*可能是解决问题的有效解决方案，但*实际上*完全无法使用。

试试[Bogosort](http://en.wikipedia.org/wiki/Bogosort)吧！

> 如果使用 bogosort 对一副纸牌进行排序，它将包括检查纸牌是否有序，如果不是，则将纸牌扔到空中，随机捡起纸牌，然后重复该过程直到甲板被分类。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-20T10:05:20.550

天真的实现是：

*   直觉的;
*   首先想到的；
*   经常有感染力和/或有问题的角落案例；

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-02T20:49:30.170

Determining if a number is prime or not (primality test) is an excellent example.

The naive method just check if n mod x where x = 2..square root(n) is zero for at least one x. This method can get really slow for very large prime numbers and it is not feasible to use in cryptography.

On the other hand there are a couple of probability or fast deterministic tests. These are too complicated to explain here but you might want to check the relevant Wikipedia article on the subject for more information: [http://en.wikipedia.org/wiki/Primality_test](http://en.wikipedia.org/wiki/Primality_test)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-02T20:51:16.297

Let's say that someone figures out how to extract a single field from a database and then proceeds to write a web page in PHP or any language that makes a separate query on the database for each field on the page. It works, but will be incredibly slow, inefficient, and difficult to maintain.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-02T20:59:30.573

天真并不意味着不好或无法使用 - 它意味着具有某些品质，这些品质会*在特定环境*和*特定目的*中造成问题。

经典的例子当然是排序。在对包含十个数字的列表进行排序的情况下，任何旧算法（除了 pogo 排序）都可以很好地工作。但是，当我们达到数千个或更多数字的规模时，通常我们会说选择排序是一种朴素算法，因为它具有 O(n^2) 时间的质量，这对于我们的目的来说太慢了，而且非朴素算法是快速排序，因为它具有 O(n lg n) 时间的质量，这对于我们的目的来说足够快。

事实上，在对包含十个数字的列表进行排序的情况下，快速排序是一种简单的算法，因为它比选择排序需要更长的时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-02T20:48:27.223

Bubble sort over 100,000 thousand entries.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-02T21:13:31.293

通常用于对一副纸牌进行排序的直观算法（[插入排序](http://en.wikipedia.org/wiki/Insertion_sort)或[选择排序](http://en.wikipedia.org/wiki/Selection_sort)，均为 O(n^2)）可以被认为是幼稚的，因为它们易于学习和实现，但不能很好地扩展到一副纸牌。 ，比如说，100000 张卡片：D。在一般设置中，有更快（O（n log n））的方法来对列表进行排序。

但是请注意，*naive*并不一定意味着*bad*。在某些情况下，插入排序是一个不错的选择（例如，当您有一个已经排序的大牌堆和几张未排序的卡片要添加时）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-02T21:59:52.447

（还没有看到发布的真正幼稚的实现，所以......）

以下实现是“幼稚的”，因为它不涵盖边缘情况，并且在其他情况下会中断。它非常易于理解，并且可以传达编程信息。

```
 def naive_inverse(x):
        return 1/x 
```

它会：

*   中断 x=0
*   传递整数时做得不好

您可以通过添加这些功能使其更加“成熟”。

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2008-11-02T20:48:53.900

A O(n!) algorithm.

```
foreach(object o in set1)
{
    foreach(object p in set1)
    {
        // codez
    }
} 
```

This will perform fine with small sets and then exponentially worse with larger ones.

Another might be a naive Singleton that doesn't account for threading.

```
public static SomeObject Instance
{
     get
     {
          if(obj == null)
          {
               obj = new SomeObject();
          }

          return obj;
     }
} 
```

If two threads access that at the same time it's possible for them to get two different versions. Leading to seriously weird bugs.

# macos - Mac OS X 上的 Clojure 编辑器/IDE 建议

> ID：257333
> 
> 赞同：53
> 
> 时间：2008-11-02T20:44:52.287
> 
> 标签：macos, ide, editor, clojure

我开始学习[Clojure](http://en.wikipedia.org/wiki/Clojure)编程语言。对 Mac OS X 上的 Clojure 编辑器/IDE 有什么建议吗？

**2009-09-23 更新**：自从我最初发布这个问题以来，Clojure 空间发生了巨大变化。下面的许多链接，尤其是那些使用 Emacs 引用 clojure-mode 的链接，都已过时。我发现的最好的 Clojure IDE 是最近发布的[Enclojure](http://www.enclojure.org/) Netbeans 插件 (2009-08-25)。

**2010-04-30 更新**：关于这个主题的另一篇非常好的文章是*[Clojure IDEs -](http://www.bestinclass.dk/index.php/2010/03/clojure-ides-the-grand-tour-getting-started/)* Lau B. Jensen 的 The Grand Tour。此外，为了我自己的 clojure 开发，我实际上已经转移到 Emacs / [swank-clojure](http://github.com/technomancy/swank-clojure)。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-03T10:58:32.843

对于设置 Aquamacs、Slime 和 Clojure，在[lispcast.com](http://www.lispcast.com/drupal/)上有一个截屏视频：

[http://www.lispcast.com/drupal/node/79](http://www.lispcast.com/drupal/node/79)（断开的链接）

**编辑：**这是您找到 Jman 的一个不错的[替代截屏视频。](http://paulbarry.com/articles/2008/07/02/getting-started-with-clojure-and-aquamacs)我已将其添加到我的答案中，因此它更全面。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-06T19:28:52.097

如果你打算花时间编辑 Lisp 代码而不做太多 Java，那么 Emacs+SLIME 将是最有效率的。

Paredit 也是必不可少的，因为它几乎很难插入无效的 s 表达式。这需要一点时间来适应，但绝对值得。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-02T22:14:28.173

您可以尝试使用带有[Enclojure的](http://enclojure.wikispaces.com)[NetBeans](http://netbeans.org)。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-11-09T07:32:03.297

“三大”Java 开发 IDE 之一是 IntelliJ IDEA。它曾经获得较少的市场份额，因为它不像啤酒那样免费。JetBrains 现在提供[IntelliJ IDEA](http://www.jetbrains.com/idea/)的社区版。我自己不是普通的 Mac 用户，但[OS X 的“我用这个”的人](http://osx.iusethis.com/app/intellijidea)说它也在那里运行。

IDEA 有一个名为**[La Clojure](http://plugins.intellij.net/plugin/?id=4050)**的插件，可直接从“设置”下的插件管理器中获得，这使 Clojure 开发变得愉快和高效。

以前，我试过

*   [WaterFront](http://sourceforge.net/projects/waterfront/files/)，其中“IDE”是 IMO 的一部分；
*   [逆时针](http://code.google.com/p/counterclockwise/)，一个不错的Eclipse插件；和
*   [Enclojure](http://www.enclojure.org/)，NetBeans 插件。

但预计会留在 IDEA 和 La Clojure

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-02T21:36:09.373

Rich Hickey 在他的所有演示中都使用了[Aquamacs](http://aquamacs.org/)。他对此发表了评论，称在有人为 Emacs 创建了 Clojure 模式后，他切换到了它。我还[为 jEdit 创建了 Clojure 模式](http://github.com/djspiewak/jedit-modes/tree/master/clojure.xml)。

目前，对 Clojure 的工具支持非常有限。我认为您要么被某些 Emacs 变体或[jEdit](http://jedit.org)所困。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-25T00:24:15.730

如果你走 emacs 路线，我强烈推荐使用 clojure-paredit。 [Paredit](http://www.emacswiki.org/emacs/ParEdit)需要一些时间来适应，但它确实强化了“代码就是数据”的概念。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-02-07T23:26:42.623

这是一个老问题，但 Clojure 工具的前景已经发生了很大变化。

现在的选择是：

*   [轻便的桌子](http://lighttable.com/)，很容易上手。
*   IntelliJ + [Cursive](https://cursive-ide.com/)或[La Clojure](https://plugins.jetbrains.com/plugin/?id=4050)。曾经有人向我推荐过草书。
*   vim +[壁炉](https://github.com/tpope/vim-fireplace)。我知道一些非常有生产力的人使用它。
*   Emacs + [CIDER](https://github.com/clojure-emacs/cider)和[Paredit](http://danmidwood.com/content/2014/11/21/animated-paredit.html)，我个人的选择。显然 Rich Hickey 使用[Aquamacs](http://aquamacs.org/)。

我个人学会了使用 Emacs 将它与 Clojure 一起使用，尽管有些人可能会争辩说同时学习两件事并不是一个好主意。

[这里](http://blog.cognitect.com/blog/2016/1/28/state-of-clojure-2015-survey-results)有一项关于 IDE/Editors 受欢迎程度的调查：

[![调查结果](https://i.stack.imgur.com/s3DjQ.png)](https://i.stack.imgur.com/s3DjQ.png)

[Emacs 摇滚！](http://emacsrocks.com/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-11-02T23:05:25.997

[带有Slime](http://common-lisp.net/project/slime/)的Emacs可能是一个不错的选择。请参阅解释设置的这篇[文章。](http://bc.tech.coop/blog/081023.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-18T14:42:39.433

带有 SLIME 和 clojure-mode 的 Emacs Carbon 就像一个魅力。我之前尝试过 Aquamacs，感觉它与命令行 emacs 对我来说太不一样了。我真的不喜欢 Terminal.app，经过几个月的抗争，我决定迁移到 Carbon。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-02T21:03:54.917

[TextMate 是一个很棒的编辑器，并且有一个 Lisp 包，它可以满足 Clojure 的需要（这里](http://www.loufranco.com/blog/assets/clojure.zip "用于 TextMate 的 Clojure 包")还有一个正在进行中的包）。我一直使用 TextMate + Lisp 包来编写 Clojure 代码。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-24T22:14:24.963

我正在为 Clojure 使用 Vim，并且很享受它。[我安装了wiki](http://en.wikibooks.org/wiki/Clojure_Programming)中提到的 Vim Clojure 插件，并按照那里的说明使用[rlwrap](http://utopia.knoware.nl/~hlub/rlwrap/)使 REPL 更加用户友好。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-10-12T18:52:00.257

[灯桌](http://www.lighttable.com/)非常棒；不幸的是，我无法在我的 Mac 上运行它，因为我被困在 OS X 10.6 上，它需要 10.7+。

我一直在另一台 Mac 和几台 Windows 计算机上使用 Light Table——它非常好。

[我曾经帮助过开源项目。]

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-09T10:18:35.227

Bill Clementson[更新](http://bc.tech.coop/blog/081205.html)了他的设置。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-11-22T19:03:48.777

您也可以尝试带有 La Clojure 插件的 IntellliJ IDEA。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-12-23T00:16:26.960

我在 MacOSX 上使用 Clojure 大约 3 个月。我对 Emacs 非常满意，并将其用于更多任务。开始很艰难，但现在我想说学习emacs是值得的。对于 IntelliJ 10，La Clojure 插件已更新，现在它应该可以再次与 Clojure 1.2.0 一起使用。

# php - How do you generate an RSS feed?

> ID：257339
> 
> 赞同：6
> 
> 时间：2008-11-02T20:48:34.480
> 
> 标签：php, rss

I've never done it myself, and I've never subscribed to a feed, but it seems that I'm going to have to create one, so I'm wondering. The only way that seems apparent to me is that when the system is updated with a new item (blog post, news item, whatever), a new element should be written to the rss file. Or alternatively have a script that checks for updates to the system a few times a day and writes to the rss file is there is. There's probably a better way of doing it though.

And also, should old elements be removed as new ones are added?

**Edit**: I should have mentioned, I'm working in PHP, specifically using CodeIgniter, with a mySQL database.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T05:28:21.217

对于 PHP，我使用 feedcreator [http://feedcreator.org/](http://feedcreator.org/)

```
<?php define ('CONFIG_SYSTEM_URL','http://www.domain.tld/');

require_once('feedcreator/feedcreator.class.php');

$feedformat='RSS2.0';

header('Content-type: application/xml');

$rss = new UniversalFeedCreator();
$rss->useCached();
$rss->title = "Item List";
$rss->cssStyleSheet='';
$rss->description = 'this feed';
$rss->link = CONFIG_SYSTEM_URL;
$rss->syndicationURL = CONFIG_SYSTEM_URL.'feed.php';

$articles=new itemList();  // list of stuff
foreach ($articles as $i) {   
    $item = new FeedItem();
    $item->title = sprintf('%s',$i->title);
    $item->link = CONFIG_SYSTEM_URL.'item.php?id='.$i->dbId;
    $item->description = $i->Subject;   
    $item->date = $i->ModifyDate;   
    $item->source = CONFIG_SYSTEM_URL;   
    $item->author = $i->User;
    $rss->addItem($item);
}

print $rss->createFeed($feedformat); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-02T20:57:47.923

An RSS Feed is just an XML Document that conforms to a specific schema.

Have a look [here](http://www.xml.com/pub/a/2002/12/18/dive-into-xml.html)

What language are you working in? You can easily script the xml output based on some content in your application. You don't need to explicitly save the file to the file system. It can just be created on the fly

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-02T20:56:45.740

I'd say the answer is having an RSS feed be nothing more than another view of your data. This means that your rss feed is simply an xml representation of the data in your database. Readers will then be able to hit that specific url and get back the current information in your application.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-02T21:21:13.460

我从[Magpie RSS](http://magpierss.sourceforge.net/)得到了很好的结果。设置包含的缓存，您需要做的就是编写查询以检索您的数据并将结果发送到 Magpie RSS，然后由它处理更新频率。

我不会编写 RSS 文件，除非您的服务器负载特别重 - 您只需要一个查询（或添加到数组的一系列查询）来更新内容。编写要按日期排序然后受 X 限制的查询/ies，您也​​不必担心“删除旧东西”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T21:00:41.957

这是一个简单的基于 ASP.NET 2 的 RSS 提要，我将其用作本地开发站点的实时书签。可能会帮助您入门：

```
<%@ Page Language="C#" EnableViewState="false" %>
<%@ OutputCache Duration="300" VaryByParam="none" %>

<%@ Import Namespace="System" %>
<%@ Import Namespace="System.Configuration" %>
<%@ Import Namespace="System.Web" %>
<%@ Import Namespace="System.Web.Security" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Xml" %>
<%@ Import Namespace="System.Text" %>
<%@ Import Namespace="System.DirectoryServices" %>

<script runat="server">

protected void Page_Load(object sender, EventArgs e)
{
    System.Collections.Specialized.StringCollection HideSites = new StringCollection();
    System.Collections.Generic.List<string> Sites = new System.Collections.Generic.List<string>();

    HideSites.Add(@"IISHelp");
    HideSites.Add(@"MSMQ");
    HideSites.Add(@"Printers");

    DirectoryEntry entry = new DirectoryEntry("IIS://LocalHost/W3SVC/1/ROOT");
    foreach (DirectoryEntry site in entry.Children)
    {
        if (site.SchemaClassName == "IIsWebVirtualDir" && !HideSites.Contains(site.Name))
        {
            Sites.Add(site.Name);
        }
    }

    Sites.Sort();

    Response.Clear();
    Response.ContentType = "text/xml";
    XmlTextWriter RSS = new XmlTextWriter(Response.OutputStream, Encoding.UTF8);
    RSS.WriteStartDocument();
    RSS.WriteStartElement("rss");
    RSS.WriteAttributeString("version","2.0");
    RSS.WriteStartElement("channel");
    RSS.WriteElementString("title", "Localhost Websites");
    RSS.WriteElementString("link","http://localhost/sitelist.aspx");
    RSS.WriteElementString("description","localhost websites");

    foreach (string s in Sites)
    {
        RSS.WriteStartElement("item");
        RSS.WriteElementString("title", s);
        RSS.WriteElementString("link", "http://localhost/" + s);
        RSS.WriteEndElement();
    }

    RSS.WriteEndElement();
    RSS.WriteEndElement();
    RSS.WriteEndDocument();
    RSS.Flush();
    RSS.Close();
    Response.End();
}

</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T21:12:44.197

RSS 提要只是以某种方式格式化并从网页链接到的 XML 文档。

看看这个页面（[http://cyber.law.harvard.edu/rss/rss.html](http://cyber.law.harvard.edu/rss/rss.html)），它详细介绍了 RSS 规范，提供了示例 RSS 文件供您查看，并向您展示如何从您的地点。

如何创建文档取决于您。您可以在文本编辑器中手动编写它，使用特定于语言的 XML 对象，或者点击 ASPX/PHP/其他页面并发送正确的内容类型标题以及 RSS 文档。

当你开始做这件事时，这并不是那么难。祝你好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-02T22:00:55.720

有两种方法可以解决这个问题。第一个是根据请求动态创建 RSS 文档。第二种是在发生相关更改时写入静态文件。后者更快，但需要调用来更新（可能）许多地方的提要，而不是一个地方。

使用这两种方法，虽然您可以仅使用更改来编辑文档，但每次使用最新 (10-50) 项重写整个文档要简单得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T09:59:02.760

如果要生成 HTML 中已经存在的元素的提要，一种选择是修改 HTML 标记以使用 hAtom ( [http://microformats.org/wiki/hAtom](http://microformats.org/wiki/hAtom) )，然后通过 hAtom->Atom 指向提要阅读器或 hAtom->RSS 代理。

# c++ - Check if Char is in range

> ID：257343
> 
> 赞同：2
> 
> 时间：2008-11-02T20:49:01.590
> 
> 标签：c++, char, range, hex

If I have a range of say `000080-0007FF` and I want to see if a char containing hex is within that range, how can I do it?

Example

```
char t = 0xd790;

if (t is within range of 000080-0007FF) // true 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-02T20:50:11.463

```
wchar_t t = 0xd790;

if (t >= 0x80 && t <= 0x7ff) ... 
```

In C++, characters are interchangeable with integers and you can compare their values directly.

Note that I used `wchar_t`, because the `char` data type can only hold values up to 0xFF.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T21:05:50.373

```
unsigned short t = 0xd790;

if (t >= 0x80 && t <= 0x7ff) ... 
```

由于 char 的最大值为 0xFF，因此您不能使用它来比较十六进制数字多于 2 的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T21:16:51.973

由于计算机上的十六进制只不过是一种打印数字（如十进制）的方式，因此您也可以与普通的旧基 10 整数进行比较。

```
if( (t >= 128) && (t <= 2047) )
{
} 
```

更具可读性。

# css - 使用 CSS 进行表单布局

> ID：257350
> 
> 赞同：1
> 
> 时间：2008-11-02T20:52:46.170
> 
> 标签：css, forms

我需要创建一个表单，其中一半是线性视图（文本框和下拉列表在单独的行中），另一半是非线性视图，即文本框将彼此相邻出现，例如名字和姓氏将彼此相邻。

我知道如何用 CSS 完成线性视图。我在用

```
fieldset {
  clear: both;
  font-size: 100%;
  border-color: #000000;
  border-width: 1px 0 0 0;
  border-style: solid none none none;
  padding: 10px;
  margin: 0 0 0 0;
}

label 
{
    float: left;
    width: 10em;
    text-align:right;
} 
```

如何获得非线性视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T21:03:13.153

如果你还浮动：左，设置宽度和显示：内联其他输入字段，应该出现在同一行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T05:34:22.373

`display: inline`将项目放在同一行。

`display: block`给该项目自己的一整行。

`float: left`将项目向左浮动。

# c++ - 什么比双倍大？

> ID：257353
> 
> 赞同：33
> 
> 时间：2008-11-02T20:56:21.530
> 
> 标签：c++, types, variables

是否存在比双精度“更大”的本机 C++ 变量类型？
float 是 7
double 是 15（当然取决于编译器）
有没有更大的本机，甚至非本机？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-02T20:58:44.053

C++ 有`long double`，但不能保证它比普通的`double`. 在 x86 平台上，通常`double`是 64 位，`long double`或者是 64 位或 80 位（如果我没记错的话，这会给你 19 个有效数字）。

您的里程可能会有所不同，尤其是如果您不在 x86 上。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-03T00:00:15.963

long double 通常只使用 10 个字节，但由于对齐，实际上可能在一个结构中占用 12 或 16 个（取决于编译器和选项）字节。

10 字节长的 double 提供 64 位尾数；当您想在浮点中存储 64 位整数而不损失精度时，这非常方便。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-02T21:30:47.717

您可以使用[GNU MP](http://gmplib.org/)。它的[浮点函数](http://gmplib.org/manual/Floating_002dpoint-Functions.html#Floating_002dpoint-Functions)具有无限的尾数和 32 位或 64 位（取决于本机字长）指数。它还带有一个[C++ 包装器](http://gmplib.org/manual/C_002b_002b-Interface-Floats.html#C_002b_002b-Interface-Floats)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-02T21:16:07.417

还有一些用于 C++ 的各种 bigfloat/bigint 库，它们允许任意精度的数学运算。Microsoft Codeplex 上有[这个](http://www.codeplex.com/BigFloat)库，但谷歌搜索会找到很多其他库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-02T22:05:58.457

C++ 有 long double，但仍然非常有限。不妨试试 GNU 的 gmp 库。您可以根据需要设置任意大的数字，当您使用 gmp_add 而不是普通的 + 时，它会非常有趣且非常笨拙。我确定某处有一个 C++ 包装器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-02T20:58:58.543

long double，但通常也是 15 位精度。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-09-03T02:44:31.063

long long double 只有一些 cpus 允许你使用它......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-05T12:33:30.920

Boost 1.53 或更高版本具有多精度。

[http://www.boost.org/doc/libs/1_54_0/libs/multiprecision/doc/html/index.html](http://www.boost.org/doc/libs/1_54_0/libs/multiprecision/doc/html/index.html)

# flash - 用于直播网络摄像头的 API

> ID：257364
> 
> 赞同：1
> 
> 时间：2008-11-02T21:00:13.533
> 
> 标签：flash, api, broadcast

我想知道这里是否有人知道我可以从我的网站内部创建实时网络摄像头广播的 API？

我正在检查 uStream API，您似乎无法创建任何东西，只能检索数据......有人知道这样的事情吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T13:04:17.493

您可以使用 Flash Media Server 或 Flash Comm Server 和 actionscript 中的代码连接到服务器进行直播。AS3 内置了对使用 Flash Communication Server/Media Server 进行网络摄像头编程的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-18T10:57:04.613

请参阅adobe.com[上的视频基础知识](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000252.html)

# language-agnostic - 回车符 \r 和换行符 \n 应该总是一起使用吗？\r\n

> ID：257375
> 
> 赞同：8
> 
> 时间：2008-11-02T21:10:03.810
> 
> 标签：language-agnostic, carriage-return, line-breaks

在 JavaScript 中，这是一个跨浏览器兼容性问题，因此两者都被使用，但在许多不同语言的实例中，我看到两者一起打印为 \r\n。这仍然是您应该始终使用两者的普遍例外规范，还是曾经有一次语言可以同时理解两者，而您最终会休息和返回？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-02T21:13:06.270

CRLF 对是大多数 Internet 协议上的预期行尾 (EOL) 标记。

在这里，应该适用 Postel 的“稳健性原则”。对你接受的东西要自由，但对你发送的东西要严格。因此，请准备好只接收 LF，但如果您要发送数据，请使用相关标准要求的任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T21:16:01.863

这不是语言兼容性问题，而是文件问题或协议问题。文件方面：Unix 使用 \n 作为回车，Windows 使用 \r\n，我认为 MacOS 使用过（现在不确定）\r。许多“跨平台”语言将其抽象为平台相关变量。协议方面：协议规定的内容。

# javascript - 自定义虚拟地球集群

> ID：257378
> 
> 赞同：1
> 
> 时间：2008-11-02T21:12:54.773
> 
> 标签：javascript, virtual-earth

我想使用这个虚拟地球 javascript API 实现我自己的聚类算法：http: [//msdn.microsoft.com/en-us/library/cc966716.aspx](http://msdn.microsoft.com/en-us/library/cc966716.aspx) 但是，VE 引擎为层中的每个形状调用一次我的聚类函数. 这使它非常慢！在我看来，VE 应该将所有形状放入一个图层中，然后让我的函数将它们聚类。不能重复调用集群！

为什么VE引擎会这样做？是否有另一种方法可以使用此 API 进行客户端集群？

更多信息：我正在从 GeoRSS 提要加载形状。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T21:18:47.430

每个 VEShapeLayer 应该只调用一次您的代码 - 否则，聚类是没有意义的，因为您不能对单个形状进行聚类。您是否使用 VEMap.AddShape 而不是将 VEShape 对象添加到 VEShapeLayer？如果是这样，请尝试创建单个 VEShapeLayer，将其添加到 VEMap，然后将所有 VEShape 对象添加到形状层而不是贴图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T22:19:29.473

自定义聚类算法方法只会为该 VEShapeLayer 调用一次。

Adam Byram，使用 VEMap.AddShape 方法和将 VEShapeLayer 添加到包含所有形状的地图之间并没有太大区别。AddShape 方法将 Shape 添加到“默认”ShapeLayer，即索引为 0（零）的 ShapeLayer，添加 VEShapeLayer 会在现有“默认”图层的基础上添加一个新图层。

如果您正在使用 VEMap.AddShape 将 VEShape 对象添加到地图，那么每次将 VEShape 添加到地图时，它都会调用您的聚类算法方法。这将是正确的行为，因为每次添加形状时都需要重新计算聚类。

在将所有形状添加到地图时提高整体性能，并让 VE 在添加所有形状时只调用一次您的自定义算法方法；您可以创建一个 VEShapeLayer，将所有形状添加到其中，然后将该形状图层添加到地图中。这将导致 VE 只对所有形状进行一次渲染（在全部加载时），而不是每次添加单个 VEShape 时。

# ios - 如何“简化” UIImagePickerController

> ID：257389
> 
> 赞同：6
> 
> 时间：2008-11-02T21:18:43.810
> 
> 标签：ios, iphone, objective-c, cocoa-touch, uiimagepickercontroller

我正在使用 UIImagePickerController 拍照，涉及两个步骤，“拍照”和“使用照片”。有没有办法覆盖行为，将这两个动作合并为一个？说“拍摄并使用照片”。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T06:27:09.460

当前的 SDK 中没有办法做到这一点，您应该提交一个请求该功能的[错误。](http://bugreporter.apple.com/)有一些已发布的示例，人们在视图层次结构中爬来爬去以编程方式读取表面并触发 UI 元素，但这些操作很复杂，可能会出现奇怪的视觉伪影，从而导致支持问题，并且可能会因固件更新而中断。

# c - 指针和 const char[] 的 C 错误

> ID：257391
> 
> 赞同：1
> 
> 时间：2008-11-02T21:19:08.177
> 
> 标签：c, pointers

我有一个我试图迭代的 const char arr[] 参数，

```
char *ptr;
for (ptr= arr; *ptr!= '\0'; ptr++) 
  /* some code*/ 
```

我收到一个错误：赋值从指针目标类型中丢弃限定符

const char [] 的处理方式与非常量不同吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-02T21:20:54.553

将 *ptr 的声明切换为。

```
const char* ptr; 
```

问题是您实际上是在将 const char* 分配给 char*。这是对 const 的违反，因为您要从 const 变为非 const。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-02T21:38:29.900

正如 JaredPar 所说，将 ptr 的声明更改为

```
const char* ptr; 
```

它应该工作。尽管看起来令人惊讶（您如何迭代 const 指针？），但您实际上是在说指向的字符是 const，而不是指针本身。事实上，有两个不同的地方可以在指针声明中应用 const（和/或 volatile），这 4 个排列中的每一个都有略微不同的含义。以下是选项：

```
char* ptr;              // Both pointer & pointed-to value are non-const
const char* ptr;        // Pointed-to value is const, pointer is non-const 
char* const ptr;        // Pointed-to value is non-const, pointer is const
const char* const ptr;  // Both pointer & pointed-to value are const. 
```

有人（我认为 Scott Meyers）说你应该从里到外阅读指针声明，即：

```
const char* const ptr; 
```

...将被解读为“ptr 是一个指向常量字符的常量指针”。

祝你好运！

德鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-16T17:18:34.613

const 声明抓住左边的任何东西。如果什么都没有，它看起来是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-04T16:59:15.863

对于像上面这样你不关心返回值的交互循环，你应该说`++ptr`而不是`ptr++`.

`ptr++`方法：

```
temp = *ptr;
++ptr;
return temp;` 
```

`++ptr`方法：

```
++ptr;
return *ptr; 
```

对于原始类型，编译器将应用此优化，但在迭代 C++ 对象时不会应用，因此您应该养成以正确方式编写它的习惯。

# wpf - WPF CommandParameter 绑定问题

> ID：257396
> 
> 赞同：5
> 
> 时间：2008-11-02T21:21:19.983
> 
> 标签：wpf, commandbinding

我在理解命令参数绑定的工作原理时遇到了一些麻烦。

当我在调用 InitializeComponent 之前创建小部件类的实例时，它似乎工作正常。对 ExecuteCommand 函数中的参数（Widget）的修改将被“应用”到 _widget。这是我所期望的行为。

如果 _widget 的实例是在 InitializeComponent 之后创建的，我会在 ExecuteCommand 函数中得到 e.Parameter 的空引用异常。

为什么是这样？如何使用 MVP 模式进行这项工作，在创建视图后可能会创建绑定对象？

```
public partial class WidgetView : Window
{
    RoutedCommand _doSomethingCommand = new RoutedCommand();

    Widget _widget;

    public WidgetView()
    {
        _widget = new Widget();
        InitializeComponent();
        this.CommandBindings.Add(new CommandBinding(DoSomethingCommand, ExecuteCommand, CanExecuteCommand));
    }

    public Widget TestWidget
    {
        get { return _widget; }
        set { _widget = value; }
    }

    public RoutedCommand DoSomethingCommand
    {
        get { return _doSomethingCommand; }
    }

    private static void CanExecuteCommand(object sender, CanExecuteRoutedEventArgs e)
    {
        if (e.Parameter == null)
            e.CanExecute = true;
        else
        {
            e.CanExecute = ((Widget)e.Parameter).Count < 2;
        }
    }

    private static void ExecuteCommand(object sender, ExecutedRoutedEventArgs e)
    {
        ((Widget)e.Parameter).DoSomething();
    }
}

<Window x:Class="CommandParameterTest.WidgetView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="WidgetView" Height="300" Width="300"
    DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <StackPanel>
        <Button Name="_Button" Command="{Binding DoSomethingCommand}"
             CommandParameter="{Binding TestWidget}">Do Something</Button>
    </StackPanel>
</Window>

public class Widget
{
    public int Count = 0;
    public void DoSomething()
    {
        Count++;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-02T22:37:34.603

InitializeCompenent 处理与文件关联的 xaml。正是在这个时间点，首先处理 CommandParameter 绑定。如果您在 InitializeCompenent 之前初始化您的字段，那么您的属性将不会为空。如果您在之后创建它，则它为空。

如果要在 InitializeCompenent 之后创建小部件，则需要使用依赖属性。依赖属性将引发一个通知，该通知将导致 CommandParameter 被更新，因此它不会为空。

下面是如何使 TestWidget 成为依赖属性的示例。

```
public static readonly DependencyProperty TestWidgetProperty =
    DependencyProperty.Register("TestWidget", typeof(Widget), typeof(Window1), new UIPropertyMetadata(null));
public Widget TestWidget
{
    get { return (Widget) GetValue(TestWidgetProperty); }
    set { SetValue(TestWidgetProperty, value); }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T06:00:24.383

即使使用依赖属性，您仍然需要调用 CommandManager.InvalidateRequerySuggested 来强制执行正在评估的命令的 CanExecute。

# python - Python中的消息框

> ID：257398
> 
> 赞同：6
> 
> 时间：2008-11-02T21:22:30.307
> 
> 标签：python, user-controls, user-interface

是否有用于在 python 中创建消息框或输入框的 UI 库？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-02T21:26:54.230

你最好的选择是 tkMessageBox 模块，它应该适用于所有系统（因为 Python 通常会随 Tkinter 一起提供）。

如果您可以限制自己使用特定的操作系统，则可能会有更好的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T03:16:40.530

可以使用 EasyGui 创建简单的消息框和输入框，EasyGui 是一个使用 Python 自带的 Tkinter 的小型库。

你可以在这里获得 EasyGui：http: [//easygui.sourceforge.net/](http://easygui.sourceforge.net/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T22:58:15.760

我听说过关于 wx python 的好消息，它也是多平台的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-30T11:21:03.023

来自 Tkinter

```
import *
import os

    class Dialog(Toplevel):

    def __init__(self, parent, title = None):

        Toplevel.__init__(self, parent)
        self.transient(parent)

        if title:
            self.title(title)

        self.parent = parent

        self.result = None

        body = Frame(self)
        self.initial_focus = self.body(body)
        body.pack(padx=5, pady=5)

        self.buttonbox()

        self.grab_set()

        if not self.initial_focus:
            self.initial_focus = self

        self.protocol("WM_DELETE_WINDOW", self.cancel)

        self.geometry("+%d+%d" % (parent.winfo_rootx()+50,
                                  parent.winfo_rooty()+50))

        self.initial_focus.focus_set()

        self.wait_window(self)

    #
    # construction hooks

    def body(self, master):
        # create dialog body.  return widget that should have
        # initial focus.  this method should be overridden

        pass

    def buttonbox(self):
        # add standard button box. override if you don't want the
        # standard buttons

        box = Frame(self)

        w = Button(box, text="OK", width=10, command=self.ok, default=ACTIVE)
        w.pack(side=LEFT, padx=5, pady=5)
        w = Button(box, text="Cancel", width=10, command=self.cancel)
        w.pack(side=LEFT, padx=5, pady=5)

        self.bind("<Return>", self.ok)
        self.bind("<Escape>", self.cancel)

        box.pack()

    #
    # standard button semantics

    def ok(self, event=None):

        if not self.validate():
            self.initial_focus.focus_set() # put focus back
            return

        self.withdraw()
        self.update_idletasks()

        self.apply()

        self.cancel()

    def cancel(self, event=None):

        # put focus back to the parent window
        self.parent.focus_set()
        self.destroy()

    #
    # command hooks

    def validate(self):

        return 1 # override

    def apply(self):

        pass # override 
```

# ios - NSData 和 UIImage

> ID：257400
> 
> 赞同：60
> 
> 时间：2008-11-02T21:22:53.503
> 
> 标签：ios, iphone, cocoa-touch, uiimage, nsdata

我正在尝试从 加载`UIImage`对象`NSData`，而示例代码是 to `NSImage`，我想它们应该是相同的。但是刚刚加载图像，我想知道解决`UIImage`加载`NSData`问题的最佳方法是什么。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2011-03-10T15:59:39.840

我以前没有尝试`UIImageJPEGRepresentation()`过，但`UIImagePNGRepresentation`对我来说效果很好，并且在`NSData`and之间进行转换`UIImage`非常简单：

```
NSData *imageData = UIImagePNGRepresentation(image);
UIImage *image=[UIImage imageWithData:imageData]; 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-11-02T22:04:09.880

UIImage 有一个 -`initWithData:`方法。来自文档：“数据参数中的数据必须经过格式化以匹配系统支持的图像类型之一的文件格式。”

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-08-10T13:13:30.747

试试这个将图像转换为 NSdata：

```
UIImage *img = [UIImage imageNamed:@"image.png"];
NSData *data1 = UIImagePNGRepresentation(img); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T08:25:30.390

theData 应该是一个`NSData`已经包含数据的对象。您需要在`NSData`使用之前将文件加载/下载到对象。您可以使用`NSLog`on theData 来检查它，看看它是否包含有效数据。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-09-06T10:44:22.150

为了安全地执行代码，使用带有数据的 if-let 块，作为 UIImagePNGRepresentation 函数返回的可选值。

```
if let img = UIImage(named: "Hello.png") {
    if let data:Data = UIImagePNGRepresentation(img) {
       // Handle operations with data here...         
    }
} 
```

> 注意：**数据**是 Swift 3 类。在 Swift 3 中使用 Data 而不是 NSData

通用图像操作（如 png 和 jpg 两者）：

```
if let img = UIImage(named: "Hello.png") {
        if let data:Data = UIImagePNGRepresentation(img) {
               handleOperationWithData(data: data)     
        } else if let data:Data = UIImageJPEGRepresentation(img, 1.0) {
               handleOperationWithData(data: data)     
        }
}

*******
func handleOperationWithData(data: Data) {
     // Handle operations with data here...
     if let image = UIImage(data: data) {
        // Use image...
     }
} 
```

通过使用扩展：

```
extension UIImage {

    var pngRepresentationData: Data? {
        return UIImagePNGRepresentation(img)
    }

    var jpegRepresentationData: Data? {
        return UIImageJPEGRepresentation(self, 1.0)
    }
}

*******
if let img = UIImage(named: "Hello.png") {
      if let data = img.pngRepresentationData {
              handleOperationWithData(data: data)     
      } else if let data = jpegRepresentationData {
              handleOperationWithData(data: data)     
     }
}

*******
func handleOperationWithData(data: Data) {
     // Handle operations with data here...
     if let image = UIImage(data: data) {
        // Use image...
     }
} 
```

# .net - Configuration Net 2.0 中的 How2：将元素添加到不同程序集中定义的部分

> ID：257405
> 
> 赞同：0
> 
> 时间：2008-11-02T21:29:23.290
> 
> 标签：.net, configuration

如何在 Net 2.0 的配置文件中添加一个配置元素，该元素将放置在不同程序集中定义的现有结构下？

在我的情况下，我有一些核心库，可以在配置文件中创建根部分（以及其他一些设置）（使用公司名称作为根元素的名称，部分）。在其他程序集中，我想创建将任何新设置放在我们核心库中指定的现有结构下的元素。

到目前为止，我只能看到我在每个组件中重复所需结构的方式。

感谢您的任何建议。X。

在单个类中定义的配置元素的实现示例。

公共类SpecificServiceElement：ConfigurationElement {私有静态ConfigurationProperty _requestTimeout；私有静态 ConfigurationProperty _serviceAddress;

```
 private static ConfigurationPropertyCollection _properties;

  public int RequestTimeout{
     get { return (int) base[_requestTimeout]; }
  }
  public string ServiceAddress{
     get { return (string) base[_serviceAddress]; }
  }

  protected override ConfigurationPropertyCollection Properties{
     get { return _properties; }
  }

  static SpecificServiceElement(){
     _requestTimeout = new ConfigurationProperty("requestTimeout", typeof (int), 10000,
                                                 ConfigurationPropertyOptions.IsRequired);
     _serviceAddress = new ConfigurationProperty("serviceAddress", typeof (string), null,
                                                 ConfigurationPropertyOptions.IsRequired);
     _properties = new ConfigurationPropertyCollection();
     _properties.Add(_requestTimeout);
     _properties.Add(_serviceAddress);
  } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T21:59:55.380

您可以将所需的结构放在它自己的库程序集中，并在需要时链接到它。这样，它被定义一次并被多次使用。

# python - 使用python从HTML页面源下载图像文件？

> ID：257409
> 
> 赞同：46
> 
> 时间：2008-11-02T21:31:00.947
> 
> 标签：python, screen-scraping

我正在编写一个从 HTML 页面下载所有图像文件并将它们保存到特定文件夹的刮板。所有图像都是 HTML 页面的一部分。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-11-03T12:40:27.647

这是一些从提供的 URL 下载所有图像的代码，并将它们保存在指定的输出文件夹中。您可以根据自己的需要对其进行修改。

```
"""
dumpimages.py
    Downloads all the images on the supplied URL, and saves them to the
    specified output file ("/test/" by default)

Usage:
    python dumpimages.py http://example.com/ [output]
"""
from bs4 import BeautifulSoup as bs
from urllib.request import (
    urlopen, urlparse, urlunparse, urlretrieve)
import os
import sys

def main(url, out_folder="/test/"):
    """Downloads all the images at 'url' to /test/"""
    soup = bs(urlopen(url))
    parsed = list(urlparse(url))

    for image in soup.findAll("img"):
        print("Image: %(src)s" % image)
        filename = image["src"].split("/")[-1]
        parsed[2] = image["src"]
        outpath = os.path.join(out_folder, filename)
        if image["src"].lower().startswith("http"):
            urlretrieve(image["src"], outpath)
        else:
            urlretrieve(urlunparse(parsed), outpath)

def _usage():
    print("usage: python dumpimages.py http://example.com [outpath]")

if __name__ == "__main__":
    url = sys.argv[-1]
    out_folder = "/test/"
    if not url.lower().startswith("http"):
        out_folder = sys.argv[-1]
        url = sys.argv[-2]
        if not url.lower().startswith("http"):
            _usage()
            sys.exit(-1)
    main(url, out_folder) 
```

**编辑：**您现在可以指定输出文件夹。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-11-17T00:49:24.640

Ryan 的解决方案很好，但如果图像源 URL 是绝对 URL 或任何在简单地连接到主页 URL 时不会产生良好结果的东西，则会失败。urljoin 识别绝对和相对 URL，因此将中间的循环替换为：

```
for image in soup.findAll("img"):
    print "Image: %(src)s" % image
    image_url = urlparse.urljoin(url, image['src'])
    filename = image["src"].split("/")[-1]
    outpath = os.path.join(out_folder, filename)
    urlretrieve(image_url, outpath) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-02T21:33:53.030

您必须下载页面并解析 html 文档，使用正则表达式找到您的图像并下载它。您可以使用 urllib2 进行下载，使用 Beautiful Soup 来解析 html 文件。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-03-15T15:35:20.813

这是下载一张图片的功能：

```
def download_photo(self, img_url, filename):
    file_path = "%s%s" % (DOWNLOADED_IMAGE_PATH, filename)
    downloaded_image = file(file_path, "wb")

    image_on_web = urllib.urlopen(img_url)
    while True:
        buf = image_on_web.read(65536)
        if len(buf) == 0:
            break
        downloaded_image.write(buf)
    downloaded_image.close()
    image_on_web.close()

    return file_path 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-02T21:34:28.643

使用 htmllib 提取所有 img 标签（覆盖 do_img），然后使用 urllib2 下载所有图像。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-19T07:29:33.650

如果请求需要授权，请参阅此：

```
r_img = requests.get(img_url, auth=(username, password)) 
f = open('000000.jpg','wb') 
f.write(r_img.content) 
f.close() 
```

# c - do { ... } while (0) — 它有什么用？

> ID：257418
> 
> 赞同：395
> 
> 时间：2008-11-02T21:36:17.923
> 
> 标签：c, loops

> **可能重复：**
> [为什么在 C/C++ 宏中有时会出现无意义的 do/while 和 if/else 语句？](https://stackoverflow.com/questions/154136/why-are-there-sometimes-meaningless-do-while-and-if-else-statements-in-c-c-macr)

我已经看到这种表达方式已经有 10 多年了。我一直在想它有什么好处。由于我主要在#defines 中看到它，我认为它适用于内部范围变量声明和使用中断（而不是 goto）。

它对其他东西有好处吗？你用它吗？

* * *

## 回答 #1

> 赞同：570
> 
> 时间：2008-11-02T21:40:11.380

它是 C 中唯一可以用于`#define`多语句操作的结构，在其后放置一个分号，并且仍然可以在`if`语句中使用。一个例子可能会有所帮助：

```
#define FOO(x) foo(x); bar(x)

if (condition)
    FOO(x);
else // syntax error here
    ...; 
```

即使使用大括号也无济于事：

```
#define FOO(x) { foo(x); bar(x); } 
```

在语句中使用它`if`需要省略分号，这是违反直觉的：

```
if (condition)
    FOO(x)
else
    ... 
```

如果你这样定义 FOO ：

```
#define FOO(x) do { foo(x); bar(x); } while (0) 
```

那么以下在语法上是正确的：

```
if (condition)
    FOO(x);
else
    .... 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2008-11-02T21:38:44.207

这是一种简化错误检查并避免深度嵌套 if 的方法。例如：

```
do {
  // do something
  if (error) {
    break;
  }
  // do something else
  if (error) {
    break;
  }
  // etc..
} while (0); 
```

* * *

## 回答 #3

> 赞同：99
> 
> 时间：2008-11-02T21:39:51.147

它有助于将多个语句组合成一个语句，这样一个类似函数的宏实际上可以用作一个函数。假设你有：

```
#define FOO(n)   foo(n);bar(n) 
```

你也是：

```
void foobar(int n) {
  if (n)
     FOO(n);
} 
```

然后这扩展为：

```
void foobar(int n) {
  if (n)
     foo(n);bar(n);
} 
```

请注意，第二次调用`bar(n)`不再是`if`语句的一部分。

将两者包装成`do { } while(0)`，您也可以在`if`语句中使用宏。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-01-07T16:34:43.857

有趣的是，请注意以下情况，其中 do {} while (0) 循环对您**不起作用**：

如果你想要一个返回值的类函数宏，那么你需要一个[语句表达式](http://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html)：({stmt; stmt;}) 而不是 do {} while(0)：

```
 #include <stdio.h>

#define log_to_string1(str, fmt, arg...) \
    do { \
        sprintf(str, "%s: " fmt, "myprog", ##arg); \
    } while (0)

#define log_to_string2(str, fmt, arg...) \
    ({ \
        sprintf(str, "%s: " fmt, "myprog", ##arg); \
    })

int main() {
        char buf[1000];
        int n = 0;

        log_to_string1(buf, "%s\n", "No assignment, OK");

        n += log_to_string1(buf + n, "%s\n", "NOT OK: gcc: error: expected expression before 'do'");

        n += log_to_string2(buf + n, "%s\n", "This fixes it");
        n += log_to_string2(buf + n, "%s\n", "Assignment worked!");
        printf("%s", buf);
        return 0;
} 
```

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2008-11-02T21:39:02.940

通常，`do`/适用于必须*至少*`while`执行一次循环的任何类型的循环构造。可以通过直线甚至循环来模拟这种循环，但结果通常不太优雅。我承认这种模式的特定应用相当罕见，但它们确实存在。一个浮现在脑海的是一个基于菜单的控制台应用程序：*`while``for`*

 *```
do {
    char c = read_input();

    process_input(c);
} while (c != 'Q'); 
```

# unix - 在 linux 中调试 100% iowait 问题

> ID：257423
> 
> 赞同：4
> 
> 时间：2008-11-02T21:39:41.863
> 
> 标签：unix, iowait

我一直在试图追查为什么我的盒子上有 100% iowait。如果我执行 mysql 选择查询之类的操作，系统会进入 100% iowait（在我的服务器上的多个 cpu 上），这会杀死我的看门狗，有时还会杀死 httpd 本身。

在 vmstat 中，我看到每 8 秒左右，就有 5MB 磁盘写入。这会导致至少一个 cpu（共 4 个）阻塞一两秒。

我不得不说我的 ext3 中有几百万个文件（我尝试了 ext2，但我没有启用 atime，也没有启用日志。）有一个硬件 raid，镜像了两个 300GB 的 ide。

我错过了 dtrace。有没有办法找出导致这些写入的原因？以及如何加快文件系统的速度？

欢迎提出想法！

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T02:10:24.407

Use [`iotop`](http://guichaz.free.fr/iotop/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T21:51:09.703

好的，可能的诊断步骤（为后代）：

1.  您是否确认您实际上并没有用完虚拟内存并因此将进程交换到磁盘？

2.  如果不是内核交换，您可以使用`strace`（因为您没有`dtrace`）来证明是否是 MySQL 在进行写入

您能否提供更多硬件和操作系统配置的详细信息？

# delphi - 是否值得缓存由 Delphi 的内存管理器创建的对象？

> ID：257428
> 
> 赞同：9
> 
> 时间：2008-11-02T21:41:37.007
> 
> 标签：delphi, memory-management

我有一个创建和销毁数千个对象的应用程序。是否值得缓存和重用对象，还是 Delphi 的内存管理器足够快以至于多次创建和销毁对象并不是那么大的开销（与跟踪缓存相反）当我说值得时，我当然在寻找以提高性能。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-02T22:14:44.960

从最近的测试来看——如果对象创建成本不高（即不依赖于外部资源——访问文件、注册表、数据库......），那么你将很难击败 Delphi 的内存管理器。就是这么快。

如果您使用的是最近的 Delphi，这当然适用 - 如果没有，请从[SourceForge](http://sourceforge.net/projects/fastmm/)获取 FastMM4并使用它而不是 Delphi 的内部 MM。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-03T00:01:50.500

内存分配只是您想要缓存的一小部分。您需要知道构造语义有效对象的全部成本，并将其与从缓存中检索项目的成本进行比较，而不仅仅是微基准：缓存效果（即 CPU 缓存）可能会改变运行时动态在真实的实时运行应用程序中。

或者换一种说法，测量它并找出答案。如果你不测量，你就不是工程，只是猜测。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-02T21:54:32.567

只有分析器会告诉你。在一个紧密的循环中尝试这两种方法，看看有什么结果:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T00:42:09.267

您绝对必须使用真实世界的负载进行测量才能回答这样的问题。根据这些对象中保存的资源、任何资源争用、构建成本、大小等，答案可能会让您感到惊讶，甚至可能会根据负载的性质而改变。

如果不进行测量，通常很难确定性能问题在哪里。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-02T21:55:03.627

我认为这取决于您的对象在创建和销毁期间将执行的代码。TObject.Create 和 TObject.Destroy 的影响通常可以忽略不计，并且很容易被缓存开销所抵消。

您还应该考虑到对象的状态在重用时可能与刚创建后的状态不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T21:56:06.230

通常唯一的方式告诉 - 是尝试它。

如果当前的性能足够，那么您没有太多的尝试来增加它。但是，如果您有性能问题，那么一些缓存（或者实际上是一些其他策略）可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-02T22:02:04.923

您还需要一些关于特定对象（实例）使用频率的统计信息。如果您定期引用同一组数据，那么缓存可能会真正提高性能，但如果访问分布在所有可能的对象上，那么您的缓存未命中率可能会太高，不值得。

# performance - PostgreSQL UNIX 域套接字与 TCP 套接字

> ID：257433
> 
> 赞同：52
> 
> 时间：2008-11-02T21:50:29.797
> 
> 标签：performance, postgresql, tcp, sockets

我想知道与 postgresql 的 UNIX 域套接字连接是否比来自 localhost 的高并发率的 tcp 连接更快，如果是，那么快多少？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-24T00:01:55.097

Postgres 核心开发人员 Bruce Momjian 曾[在博客中讨论过这个主题](http://momjian.us/main/blogs/pgblog/2012.html#June_6_2012)。Momjian 表示，“Unix 域套接字通信明显更快。” 他测量了查询网络性能，显示本地域套接字比使用 TCP/IP 堆栈快 33%。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-11-02T22:21:55.133

UNIX域套接字应该比环回接口上的TCP套接字提供更好的性能（更少的数据复制，更少的上下文切换），但我不知道PostgreSQL是否可以证明性能提升。

我在 FreeBSD 邮件列表中找到了一个小比较：http: [//lists.freebsd.org/pipermail/freebsd-performance/2005-February/001143.html](http://lists.freebsd.org/pipermail/freebsd-performance/2005-February/001143.html)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-02T22:26:31.723

我相信 UNIX 域套接字**在理论上**比环回接口上的 TCP 套接字提供更好的吞吐量，但实际上差异可能可以忽略不计。

通过 UNIX 域套接字承载的数据不必通过 IP 堆栈层上下移动。

回复：亚历山大的回答。AFAIK 你不应该在每个方向上获得一个以上的上下文切换或数据副本（即对于每个`read()`or `write()`），因此我相信差异可以忽略不计。IP 堆栈不需要在数据包在层之间移动时复制数据包，但它确实必须操纵内部数据结构来添加和删除更高层的数据包标头。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-02T22:24:44.800

afaik，unix域套接字（UDS）像系统管道一样工作，它只发送数据，不发送校验和和其他附加信息，不使用三向握手作为TCP套接字......

ps：也许UDS会更快

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2008-11-02T22:07:45.380

localhost 上的 TCP 套接字通常使用 UNIX 域套接字来实现，因此大多数系统上的答案可以忽略不计。然而，这在任何方面都不是标准的——这只是它通常是如何完成的，因此你不应该依赖它。

# database - 从 db2 导出 UTF8 数据

> ID：257442
> 
> 赞同：0
> 
> 时间：2008-11-02T21:57:42.887
> 
> 标签：database, db2

我有一个 db2 表，其中包含多种语言（包括从右到左的语言）的值。当我使用 cli 的“导出”命令在 linux 机器上导出此表时，我得到一个漂亮的逗号分隔文本文件（DEL文件，）但是当我在 aix 上尝试时，它将所有不在 ascii 中的字符替换为 0x1a。

我试着玩弄 LC_LANG 和 DB2CODEPAGE，不行。我也尝试使用代码页修饰符，但 cli 说它无法在这两个代码页之间转换（我尝试的任何代码页都不是英文。）

我还尝试了 IXF 导出，那里的数据也已损坏。

帮助！F1！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T22:06:09.110

创建数据库时必须设置数据库的代码页。以后无法修改。您可以使用以下命令检查数据库的代码页并查找“**数据库代码页**”的值：

```
db2 get db cfg for [database_name] 
```

较新的 AIX 版本不应该有 Unicode 问题，但如果您有旧版本，那也可能会导致问题。

# .net - 如果没有 CD，获取 XP Pro SP2 的 IIS 的最佳方法是什么？

> ID：257461
> 
> 赞同：0
> 
> 时间：2008-11-02T22:09:13.007
> 
> 标签：.net, iis

我有一台新购买的工作笔记本电脑，但它没有附带 CD。它有 XP Pro，但没有安装 IIS。这看起来是一个很好的方法：

[http://ezinearticles.com/?Guide---How-To-Install-IIS-on-Windows-XP-SP2-Without-CD&id=416853](http://ezinearticles.com/?Guide---How-To-Install-IIS-on-Windows-XP-SP2-Without-CD&id=416853)

但是，我想在这里查看是否有任何人可以推荐的替代解决方案，并查看是否有任何免费的 .NET 开发人员工具可能与 IIS 作为捆绑包一起提供。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T17:35:24.057

如果您没有安装磁盘 - 检查是否有一个名为 C:\Windows\Options\i386 的目录。IIS 组件位于 IIS6.CAB 中。

您还可以下载完整的 Windows XP SP2 下载，其中应该包含 IIS6.CAB 文件：[http ://www.microsoft.com/downloads/details.aspx?FamilyId=049C9DBE-3B8E-4F30-8245-9E368D3CDB5A&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=049C9DBE-3B8E-4F30-8245-9E368D3CDB5A&displaylang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T22:39:21.417

据我所知，对“与编程无关”的问题的担忧，请告诉我有多少 .NET Web 应用程序开发人员在没有 IIS 的情况下进行编程？我认为这会使它与编程相关，不是吗？这个问题没有任何问题——我的意思是说真的，我想知道如何获得该死的东西，以便我可以开始编写 .NET Web 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T17:09:09.413

您经常会发现预装了 Windows 的计算机会将 Windows 安装程序文件加载到硬盘上某处的某个目录中。如果是这种情况，您只需将该目录刻录到 DVD 上即可。如果不这样做，我建议您回到购买 PC 的地方并要求购买一台，毕竟您已经为此付费了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T17:41:16.617

以上建议都是不错的。某处可能有一个 i386 文件夹，其中包含您需要的所有安装文件。

顺便说一句，我认为微软不会让任何人重新分发 IIS，因为存在修改二进制文件的风险。

# c# - C# 到 PHP base64 编码/解码

> ID：257462
> 
> 赞同：9
> 
> 时间：2008-11-02T22:12:24.293
> 
> 标签：c#, .net, php, base64

所以我有这个 c# 应用程序，它需要 ping 我的运行 linux/php 堆栈的 Web 服务器。
我在使用 base 64 编码字节的 c# 方式时遇到问题。

我的 C# 代码是这样的：

```
byte[] encbuff = System.Text.Encoding.UTF8.GetBytes("the string");
String enc = Convert.ToBase64String(encbuff); 
```

和php方面：

```
$data = $_REQUEST['in'];
$raw = base64_decode($data); 
```

使用较大的字符串 100+ 字符它会失败。我认为这是由于 c# 在编码中添加了“+”，但不确定。任何线索

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-02T22:24:51.757

在发送之前，您可能应该在 C# 端对您的 Base64 字符串进行 URL 编码。

并在base64解码之前在php端对其进行URL解码。

C#端

```
byte[] encbuff = System.Text.Encoding.UTF8.GetBytes("the string");
string enc = Convert.ToBase64String(encbuff);
string urlenc = Server.UrlEncode(enc); 
```

和php方面：

```
$data = $_REQUEST['in'];
$decdata = urldecode($data);
$raw = base64_decode($decdata); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-02T22:18:35.840

请注意，这`+`是 base64 编码中的有效字符，但在 URL 中使用时，它通常会转换回空格。这个空间可能会混淆您的 PHP`base64_decode`函数。

你有两种方法来解决这个问题：

*   使用 %-encoding 在 + 字符离开您的 C# 应用程序之前对其进行编码。
*   在您的 PHP 应用程序中，在传递给 base64_decode 之前将空格字符转换回 +。

第一个选项可能是您更好的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-09T05:59:51.877

这似乎可行，将 + 替换为 %2B ...

```
private string HTTPPost(string URL, Dictionary<string, string> FormData)
{

    UTF8Encoding UTF8encoding = new UTF8Encoding();
    string postData = "";

    foreach (KeyValuePair<String, String> entry in FormData)
    {
            postData += entry.Key + "=" + entry.Value + "&";
    }

    postData = postData.Remove(postData.Length - 1);

    //urlencode replace (+) with (%2B) so it will not be changed to space ( )
    postData = postData.Replace("+", "%2B");

    byte[] data = UTF8encoding.GetBytes(postData); 

    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(URL);

    request.Method = "POST";
    request.ContentType = "application/x-www-form-urlencoded";
    request.ContentLength = data.Length;

    Stream strm = request.GetRequestStream();
    // Send the data.
    strm.Write(data, 0, data.Length);
    strm.Close();

    WebResponse rsp = null;
    // Send the data to the webserver
    rsp = request.GetResponse();

    StreamReader rspStream = new StreamReader(rsp.GetResponseStream());
    string response = rspStream.ReadToEnd();

    return response;

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-02T22:16:58.823

据我所知，Convert.ToBase64String 似乎没有添加任何额外的东西。例如：

```
byte[] bytes = new byte[1000];
Console.WriteLine(Convert.ToBase64String(bytes)); 
```

上面的代码打印出一堆带有 == 的 AAAA，这是正确的。

我的猜测是，`$data`在 PHP 端不包含`enc`在 C# 端所做的 - 相互检查它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-02T22:19:30.363

在c#中

```
this is a <B>long</b>string. and lets make this a3214 ad0-3214 0czcx 909340 zxci 0324#$@#$%%13244513123 
```

变成

```
dGhpcyBpcyBhIDxCPmxvbmc8L2I+c3RyaW5nLiBhbmQgbGV0cyBtYWtlIHRoaXMgYTMyMTQgYWQwLTMyMTQgMGN6Y3ggOTA5MzQwIHp4Y2kgMDMyNCMkQCMkJSUxMzI0NDUxMzEyMw== 
```

为了我。我认为 + 打破了这一切。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-25T21:44:55.993

PHP端应该是： $data = $_REQUEST['in']; // $decdata = urldecode($data); $raw = base64_decode($decdata);

$_REQUEST 应该已经被 URL 解码。

# python - scgi和wsgi有什么区别？

> ID：257481
> 
> 赞同：19
> 
> 时间：2008-11-02T22:22:25.863
> 
> 标签：python, wsgi, scgi

这两者有什么区别？哪个更好/更快/可靠？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-03T00:28:52.693

SCGI 是一种连接前端 Web 服务器和 Web 应用程序的语言中立方式。WSGI 是用于 Web 应用程序的特定于 Python 的接口标准。

尽管它们都起源于 CGI，但它们的范围相当不同，您确实可以同时使用两者，例如在 web 服务器上使用 mod_scgi 与作为 SCGI 服务器运行的 WSGI 应用程序对话。有多个库实现将为您将 WSGI 应用程序作为 SCGI 服务器运行（例如 wsgitools、cherrypy）。

它们都是“可靠的”，就像您认为规范可靠而不是特定实现一样。这些天来，您可能会将您的应用程序编写为 WSGI 可调用对象，并单独考虑部署问题。

也许 Apache+mod_wsgi（嵌入式）接口可能*比Apache+* *mod_scgi* +（SCGI 包装器库）快一点，但很可能不会有太大的不同。更有价值的是在各种服务器、平台和连接标准上运行应用程序的能力。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-22T18:21:54.887

SCGI（如 FastCGI）是一种（序列化）协议，适用于 Web 服务器和 Web 应用程序之间的进程间通信。

WSGI 是一个 Python API，在同一个进程（Python 解释器）中连接两个（或多个）Python WSGI 兼容模块。一个模块代表网络服务器（可以是 Python 进程内网络服务器实现，也可以是通过例如 SCGI 到另一个进程中的网络服务器的网关）。另一个模块是或代表 Web 应用程序。此外，这两个模块之间的零个或多个模块可以用作 WSGI“中间件”模块，执行会话/cookie 管理、内容缓存、身份验证等操作。WSGI API 使用 Python 语言功能，例如迭代/生成器和可调用对象的传递协作的 WSGI 兼容模块之间的对象。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-02T22:39:23.037

它们都是将 Web 应用程序插入 Web 服务器的规范。一个明显的区别是 WSGI 来自 Python 世界，我相信没有非 Python 实现。

**基于更好/更快/可靠，规格通常无法比较。**

只有它们的实现具有可比性，我相信您会找到两种规范的良好实现。

也许[阅读](http://en.wikipedia.org/wiki/SCGI)和[阅读](http://en.wikipedia.org/wiki/WSGI)。

# html - 跨度中的 CSS 固定宽度

> ID：257505
> 
> 赞同：415
> 
> 时间：2008-11-02T22:36:31.373
> 
> 标签：html, css

在无序列表中：

```
<li><span></span> The lazy dog.</li>
<li><span>AND</span> The lazy cat.</li>
<li><span>OR</span> The active goldfish.</li> 
```

允许添加类或样式属性，但不允许填充文本以及添加或更改标签。

该页面正在使用 Courier New 呈现。

目标是在跨度之后排列文本。

```
 The lazy dog.
AND The lazy cat.
OR  The active goldfish. 
```

“OR”的理由并不重要。

懒惰的动物文本可能包含在一个附加元素中，但我必须仔细检查。

* * *

## 回答 #1

> 赞同：559
> 
> 时间：2008-11-02T23:27:37.450

在理想的世界中，您只需使用以下 css 即可实现此目的

```
<style type="text/css">

span {
  display: inline-block;
  width: 50px;
}

</style> 
```

这适用于除 FF2 及以下版本之外的所有浏览器。

> Firefox 2 及更低版本不支持此值。您可以使用 -moz-inline-box，但请注意，它与 inline-block 不同，在某些情况下它可能无法按预期工作。

引自[quirksmode](http://www.quirksmode.org/css/display.html)

* * *

## 回答 #2

> 赞同：445
> 
> 时间：2008-11-02T22:55:37.763

```
ul {
  list-style-type: none;
  padding-left: 0px;
}

ul li span {
  float: left;
  width: 40px;
}
```

```
<ul>
  <li><span></span> The lazy dog.</li>
  <li><span>AND</span> The lazy cat.</li>
  <li><span>OR</span> The active goldfish.</li>
</ul>
```

就像 Eoin 说的那样，你需要在你的“空”跨度中放置一个不间断的空间，但你不能为内联元素分配宽度，只能分配填充/边距，所以你需要让它浮动，这样你就可以给它一个宽度。

有关 jsfiddle 示例，请参阅[http://jsfiddle.net/laurensrietveld/JZ2Lg/](http://jsfiddle.net/laurensrietveld/JZ2Lg/)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-11-02T22:56:44.423

不幸的是，内联元素（或具有 display:inline 的元素）忽略了 width 属性。您应该改用浮动 div：

```
<style type="text/css">
div.f1 { float: left; width: 20px; }
div.f2 { float: left; }
div.f3 { clear: both; }
</style>

<div class="f1"></div><div class="f2">The Lazy dog</div><div class="f3"></div>
<div class="f1">AND</div><div class="f2">The Lazy cat</div><div class="f3"></div>
<div class="f1">OR</div><div class="f2">The active goldfish</div><div class="f3"></div> 
```

现在我看到您需要使用跨度和列表，所以我们需要稍微重写一下：

```
<html><head>
<style type="text/css">
        span.f1 { display: block; float: left; clear: left; width: 60px; }
    li { list-style-type: none; }
    </style>

</head><body>
<ul>
<li><span class="f1">&nbsp;</span>The lazy dog.</li>
<li><span class="f1">AND</span> The lazy cat.</li>
<li><span class="f1">OR</span> The active goldfish.</li>
</ul>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-11-02T23:01:05.460

该`<span>`标签需要设置为，`display:block`因为它是一个内联元素并且将忽略宽度。

所以：

```
<style type="text/css"> span { width: 50px; display: block; } </style> 
```

进而：

```
<li><span>&nbsp;</span>something</li>
<li><span>AND</span>something else</li> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-14T21:05:25.360

```
<style type="text/css">

span {
  position:absolute;
  width: 50px;
}

</style> 
```

您可以使用此方法为内联元素分配宽度

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-05-01T19:25:12.240

使用 HTML 5.0，可以使用`<span>`或来固定文本块的宽度`<div>`。

[![在此处输入图像描述](https://i.stack.imgur.com/TiDMd.png)](https://i.stack.imgur.com/TiDMd.png)

对于`<span>`，重要的是添加以下 CCS 行

```
display: inline-block; 
```

对于你的空`<span>`，重要的是增加`&nbsp;`空间。

我的代码如下

```
body
	{
	font-family: Arial;
	font-size:20px;
	}

div
	{
	width:200px;
	font-size:80px;
	background-color: lime;
	}
div span
	{
	display:block;
	width:200px;
	background-color: lime;
	}

ul li span
	{
	display: inline-block;
	width: 80px;
	background-color: yellow;
	}
span.tab
	{
	display: inline-block;
	width: 80px;
	background-color: yellow;
	}
```

```
&lt;DIV&gt;

<div class='test'>ABCDEF</div>

&lt;SPAN&gt;

<div>
    <span class='test'>ABCDEF</span>
</div

<br>

<ul>
  <li><span class='tab'>&nbsp;</span> The lazy dog.</li>
  <li><span class='tab'>AND</span> The lazy cat.</li>
  <li><span class='tab'>OR</span> The active goldfish.</li>
</ul>
```

PS：我已经定义了`tab`类，因为`ul li span`CSS 选择器在我的 PC 上不起作用！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-15T13:39:51.930

在这种情况下，人跨度不能是块元素，因为 li 元素之间的其余文本将下降。同样使用 float 也是一个非常糟糕的主意，因为您需要为整个 li 元素设置宽度，并且该宽度需要与整个 ul 元素或其他容器的宽度相同。

在 HTML 中尝试这样的事情：

```
<li><span></span><strong>The</strong> lazy dog.</li>
<li><span>AND</span> <strong>The</strong> lazy cat.</li>
<li><span>OR</span>  <strong>The</strong> active goldfish.</li> 
```

在 CSS 中：

```
li {position:relative;padding-left:80px;} // 80px or something else
li span {position:absolute;top:0;left:0;}
li strong {color:red;} // red or else 
```

因此，当`li`元素是相对元素时，您将 span 元素格式化为绝对元素，`top:0;left:0;`因此它保持在左上角，并且您设置`padding-left`（或`padding:0px 0px 0px 80px;`：）为 span 元素设置此可用空间。

它应该更适合简单的情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-18T03:45:27.153

试试这个

```
> <span class="input-group-addon" style="padding-left:6%;
> padding-right:6%; width:150px; overflow: auto;"> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-02T23:00:21.560

您可以使用表格来完成，但它不是纯 CSS。

```
<style>
ul{
    text-indent: 40px;
}

li{
    list-style-type: none;
    padding: 0;
}

span{
    color: #ff0000;
    position: relative;
    left: -40px;
}
</style>

<ul>
<span></span><li>The lazy dog.</li>
<span>AND</span><li>The lazy cat.</li>
<span>OR</span><li>The active goldfish.</li>
</ul> 
```

请注意，它不会完全按照您想要的方式显示，因为它会在每个选项上切换线路。但是，我希望这可以帮助您更接近答案。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-02T23:45:37.007

好吧，总是有蛮力方法：

```
<li><pre>    The lazy dog.</pre></li>
<li><pre>AND The lazy cat.</pre></li>
<li><pre>OR  The active goldfish.</pre></li> 
```

或者这就是您所说的“填充”文本的意思？在这种情况下，这是一项模棱两可的工作。

这听起来有点像家庭作业问题。我希望你不是想让我们为你做作业？

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-04-04T13:48:08.777

```
ul {
	list-style-type: none;
	padding-left: 0px;
}

ul li span { 
	float: left;
	width: 40px;
}
```

```
<ul>
    <li><span></span> The lazy dog.</li>
    <li><span>AND</span> The lazy cat.</li>
    <li><span>OR</span> The active goldfish.</li>
</ul>
```

# binding - 了解动态绑定

> ID：257507
> 
> 赞同：3
> 
> 时间：2008-11-02T22:37:12.543
> 
> 标签：binding, computer-science

我了解动态绑定的实现方式以及静态绑定和动态绑定之间的区别，但我只是在思考动态绑定的定义时遇到了麻烦。基本上除了它是一种运行时绑定类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-02T23:28:24.000

基本上，动态绑定意味着函数调用的地址在翻译成汇编语言时不会硬编码到程序的代码段中，而是从其他地方获取，即堆栈变量、数组查找等。

在更高的层次上，如果你有一行代码：

```
foo(bar) //Calls a funciton 
```

如果可以在编译时确切知道这将调用什么函数，这就是静态绑定。如果 foo 可能意味着多个函数，具体取决于编译时不可知的事物，那么这就是动态绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T23:28:02.347

我理解它在多态性中很明显。通常在创建从基类派生的多个类时。如果每个派生类都包含每个人使用的函数。基类可用于执行派生类的函数，它将正确调用正确的函数。

例如：

```
class Animal
{
void talk();
}

class Dog extends Animal
{
public void talk() { System.out.println("woof"); }
}

class Cat extends Animal
{
public void talk() { System.out.println("meow"); }
}

....
Animal zoo[2];
zoo[0] = new Dog();
zoo[1] = new Cat();

for(Animal animalToggle: zoo)
{
animalToggle.talk();
} 
```

将打印： woof meow

我的解释希望它有所帮助。

# rating - 随机集评级中的项目评级

> ID：257512
> 
> 赞同：1
> 
> 时间：2008-11-02T22:39:51.803
> 
> 标签：rating, recommendation-engine

当我自己的输入为用户提供这些项目的随机集并让他们告诉我哪些评级或标签在该集中时，我正在寻找一种算法来确定项目的评级或标签。例如，他们可能会说一组图像是否包含任何“好”的照片，并且是从几个随机集合中选出的，然后我想确定哪些照片是好的。现在，我还可以调整我给用户的项目集，以帮助我完善这些项目的知识。所以，如果一个给定的项目在标记为“好”和“坏”的集合中，系统会尝试将它放在已知好的项目集合中，也许，以确定用户现在是否说该集合有一个坏项目，并且我知道状态不确定的是“坏”项目。这有意义吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T22:56:10.587

使用人工神经网络；见[维基百科](http://en.wikipedia.org/wiki/Artificial_neural_network)。[此常见问题解答](http://ftp://ftp.sas.com/pub/neural/FAQ.html)中有很多链接。

# android - Android：从 ListView 访问子视图

> ID：257514
> 
> 赞同：109
> 
> 时间：2008-11-02T22:40:49.260
> 
> 标签：android, android-listview

我需要找出列表中一个元素的像素位置，该列表使用`ListView`. 似乎我应该获得其中一个**TextView**，然后使用`getTop()`，但我不知道如何获得`ListView`.

**更新：**的子`ViewGroup`项与列表中的项目不一一对应，对于`ListView`. 相反，`ViewGroup`的子级仅对应于现在可见的那些视图。所以`getChildAt()`对内部的索引进行操作，`ViewGroup`并且不一定与使用的列表中的位置有任何关系`ListView`。

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2010-04-20T23:01:57.550

请参阅：[Android ListView：获取可见项的数据索引](https://stackoverflow.com/questions/2001760/android-listview-get-data-index-of-visible-item/2002413#2002413) 并结合上面Feet的部分答案，可以为您提供类似：

```
int wantedPosition = 10; // Whatever position you're looking for
int firstPosition = listView.getFirstVisiblePosition() - listView.getHeaderViewsCount(); // This is the same as child #0
int wantedChild = wantedPosition - firstPosition;
// Say, first visible position is 8, you want position 10, wantedChild will now be 2
// So that means your view is child #2 in the ViewGroup:
if (wantedChild < 0 || wantedChild >= listView.getChildCount()) {
  Log.w(TAG, "Unable to get view for desired position, because it's not being displayed on screen.");
  return;
}
// Could also check if wantedPosition is between listView.getFirstVisiblePosition() and listView.getLastVisiblePosition() instead.
View wantedView = listView.getChildAt(wantedChild); 
```

好处是您不会迭代 ListView 的子项，这可能会影响性能。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-01-01T08:20:17.360

此代码更易于使用：

```
 View rowView = listView.getChildAt(viewIndex);//The item number in the List View
    if(rowView != null)
        {
           // Your code here
        } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-02T23:04:55.310

快速搜索 ListView 类的文档发现了从 ViewGroup 继承的 getChildCount() 和 getChildAt() 方法。你能用这些遍历它们吗？我不确定，但值得一试。

[在这里](http://code.google.com/android/reference/android/widget/ListView.html)找到

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-06-27T13:54:47.200

```
listview.setOnItemClickListener(new AdapterView.OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> parent, final View view, int position, long id) {
        View v;
        int count = parent.getChildCount();
        v = parent.getChildAt(position);
        parent.requestChildFocus(v, view);
        v.setBackground(res.getDrawable(R.drawable.transparent_button));
        for (int i = 0; i < count; i++) {
            if (i != position) {
                v = parent.getChildAt(i);
                v.setBackground(res.getDrawable(R.drawable.not_clicked));
            }
        }
    }
}); 
```

基本上，创建两个**Drawable** - 一个是透明的，另一个是所需的颜色。请求焦点在单击位置（`int position`定义）并更改所述行的颜色。然后遍历 parent `ListView`，并相应地更改所有其他行。这说明了用户多次点击的`listview`时间。这是通过为`ListView`. （很简单，只需创建一个新的布局文件`TextView`- 不要设置可聚焦或可点击！）。

无需自定义适配器 - 使用`ArrayAdapter`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-01-29T08:11:43.073

```
int position = 0;
listview.setItemChecked(position, true);
View wantedView = adapter.getView(position, null, listview); 
```

* * *

## 回答 #6

> 赞同：-9
> 
> 时间：2008-12-04T14:08:27.687

这假设您知道元素在 ListView 中的位置：

```
 View element = listView.getListAdapter().getView(position, null, null); 
```

然后你应该能够调用 getLeft() 和 getTop() 来确定屏幕上的元素位置。

# c# - NUnit 的 ExpectedExceptionAttribute 是测试是否引发异常的唯一方法吗？

> ID：257519
> 
> 赞同：5
> 
> 时间：2008-11-02T22:48:33.223
> 
> 标签：c#, exception, nunit

我是 C# 和 NUnit 的新手。

在 Boost.Test 中有一系列`BOOST_*_THROW`宏。在 Python 的测试模块中有`TestCase.assertRaises`方法。

据我了解，在带有 NUnit（2.4.8）的 C# 中，进行异常测试的唯一方法是使用`ExpectedExceptionAttribute`.

为什么我更喜欢`ExpectedExceptionAttribute`——比如说——Boost.Test 的方法？这个设计决策背后的原因是什么？为什么在 C# 和 NUnit 的情况下会更好？

最后，如果我决定使用`ExpectedExceptionAttribute`，在引发和捕获异常后如何进行一些额外的测试？假设我想测试要求，说对象在一些 setter raise 之后必须是有效的`System.IndexOutOfRangeException`。您将如何修复以下代码以按预期编译和工作？

```
[Test]
public void TestSetterException()
{
    Sth.SomeClass obj = new SomeClass();

    // Following statement won't compile.
    Assert.Raises( "System.IndexOutOfRangeException",
                   obj.SetValueAt( -1, "foo" ) );

    Assert.IsTrue( obj.IsValid() );
} 
```

* * *

编辑：感谢您的回答。今天，我发现了一个*It's the Tests* [博客条目](http://nunit.com/blogs/?p=63)，其中提到了您描述的所有三种方法（以及一个较小的变化）。很遗憾我之前找不到它:-(。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-02T23:03:12.757

我很惊讶我还没有看到这种模式。David Arno 非常相似，但我更喜欢这种简单性：

```
try
{
    obj.SetValueAt(-1, "foo");
    Assert.Fail("Expected exception");
}
catch (IndexOutOfRangeException)
{
    // Expected
}
Assert.IsTrue(obj.IsValid()); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-02T22:55:18.747

如果您可以使用 NUnit 2.5，那里有一些不错的[帮手](http://nunit.com/blogs/?p=63)。

```
Assert.That( delegate { ... }, Throws.Exception<ArgumentException>()) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-02T23:01:01.857

MbUnit 语法是

```
Assert.Throws<IndexOutOfRangeException>(delegate {
    int[] nums = new int[] { 0, 1, 2 };
    nums[3] = 3;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-02T22:55:41.303

我一直采用以下方法：

```
bool success = true;
try {
    obj.SetValueAt(-1, "foo");
} catch () {
    success = false;
}

assert.IsFalse(success);

... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-02T23:44:20.957

您的首选语法：

```
Assert.Raises( "System.IndexOutOfRangeException",
               obj.SetValueAt( -1, "foo" ) ); 
```

无论如何都不能使用 C# - obj.SetValueAt 将被评估并将结果传递给 Assert.Raises。如果 SetValue 抛出异常，那么您永远不会进入 Assert.Raises。

您可以编写一个辅助方法来做到这一点：

```
void Raises<T>(Action action) where T:Exception {
   try {
      action();
      throw new ExpectedException(typeof(T));
   catch (Exception ex) {
      if (ex.GetType() != typeof(T)) {
         throw;
      }
   }
} 
```

这允许类似的语法：

```
Assert.Raises<System.IndexOutOfRangeException>(() => 
  obj.SetValueAt(-1, "foo")
; 
```

# windows-mobile - 能否使用 Windows Mobile 6 SDK 为旧版本的 Windows Mobile 开发程序？

> ID：257533
> 
> 赞同：2
> 
> 时间：2008-11-02T22:59:28.550
> 
> 标签：windows-mobile

我想为我拥有的装有 Windows Mobile 2003 的设备开发一些应用程序，但我不想为此寻找 Visual Studio 2003 的副本。我想知道 Mobile 6 SDK 是否可以用于此目的。

该设备没有升级到更新版本的 Windows Mobile 的途径，我怀疑我很快就会得到任何更新的设备。以防万一您提出类似的建议...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:02:55.863

您需要按照最小公分母进行编码。使用 WimNo 6 SDK 不是要走的路，因为不能保证向后兼容，您最终可能会使用仅在以后的操作系统/平台中可用的功能。Studio 08 附带一个 PPC 2003 SDK，因此请使用它。为 PPC 03 开发的应用程序应该是前向兼容的（有些极端情况可能需要在您的代码中添加额外的 ches，但在大多数情况下它们可以正常工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T23:36:26.043

这完全取决于您将如何开发此应用程序。如果它只是一个 .NET Compact Framework 应用程序，只要在设备上安装了正确的 .NET CF 版本就可以了。

如果您打算使用 C++ 和底层 WinCE API，那么您需要确保被调用的函数受 WiMo 2003 支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T23:05:47.930

您可以为 WM2003 创建程序。只要您可以安装 .net cf，您就可以运行在紧凑框架下编译的程序。要求列表如下： 来自[microsoft.com](http://www.microsoft.com/downloads/details.aspx?familyid=9655156b-356b-4a2c-857c-e62f50ae9a55&displaylang=en)：

> **系统要求**
> * 支持的操作系统：Windows CE .NET；用于 Pocket PC 的 Windows Mobile 2003 软件
> * 支持的设备操作系统：用于 Pocket PC 2003 的 Windows Mobile 软件、用于 PocketPC 和 Smartphone 的 Windows Mobile 5.0、Windows CE .NET 5.0 及更高版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T23:28:26.357

我不认为它会起作用。我认为您需要正确的 SDK，如果这意味着 VS2003，那也是。

# visual-studio-2008 - How do you undo a folder move in Solutions Explorer in Visual Studio with SVN?

> ID：257538
> 
> 赞同：4
> 
> 时间：2008-11-02T23:01:31.090
> 
> 标签：visual-studio-2008, svn

I accidentally moved a very important and large folder from the root project into a sub-folder. Now when I try to move the folder back, it gives me an error message "Cannot create a file when that file already exists." How do I move things back?

Additional Information: I am also under SVN and now it wants to start a new log tree. I just go to win explorer with Tortoise SVN and click commit. If I just copy and paste the file back to the original folder, SVN wants to delete it on commit. Wow, I can't believe this little thing is creating a huge mess.

Additional: Well, I deleted the original folder and copy and pasted the new one in and now the commit system isn't working because it's telling me that the folder isn't there (I deleted it so it isn't there).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T23:06:37.273

Are you using any source control plugins like AnkhSVN.

By the sound of it, you've moved the folder which has created it at the new location, and updated the solution file as such, but for some reason, left a copy of the original folder at the original location on the filesystem.

If thats the case you probably need to manually remove it (take a backup first) outside of VS in windows explorer, the you can move it back.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-02T23:05:58.757

But does the folder, or a file with the same name, exist on the root folder?

If so, I would try to delete it first. Make sure you have the button "Show All Files", on 'Solution Explorer' pressed, in order to visualize all of your tree on VS2008.

# php - php/Ajax - 预加载图像的最佳实践

> ID：257550
> 
> 赞同：3
> 
> 时间：2008-11-02T23:07:41.483
> 
> 标签：php, ajax, json, performance, loading

我已经编写了一个非常类似于 flickr 照片流功能的脚本。两个彼此相邻的缩略图，当您单击下一个或上一个链接时，下一个（或上一个）两个图像滑入。太酷了！

当前，当页面加载时，它会加载两个图像。第一次使用 nxt / prv 然后通过 ajax 加载接下来的两个图像或前两个图像，第一个图像的 id 在 url 中传递，两个新图像的 HTML 通过 ajax 返回和显示。

很简单，但它让我开始思考，在连接缓慢或服务器负载较重的情况下，这两个图像，虽然相对较小的缩略图仍然需要一段时间才能加载，滑动窗格的好处是隐藏数据最好快速平稳地滑入，而不会延迟加载。

所以我想从性能和良好实践的角度来看哪个选项是最好的，这是我现在能想到的，欢迎提出建议。

1、通过JSON调用每组图片（应该很快吧？）

2，将所有可能的图像加载到 json 文件中并以这种方式提取详细信息 - 尽管浏览器仍然必须加载图像。另外，有时可能有 4 张图像，有时可能多达 1000 张！

3、通过php将10张图片加载到Json或其他文件中，将10张图片全部加载到浏览器中，隐藏未显示的8张，始终显示中间的两张。这里的问题是，每次有人点击时，文件都必须重新加载第一个和最后一个图像，这仍然需要时间，尽管我想现在中间的图像已经全部通过浏览器缓存了。但是仍然有加载时间。

4，是否有可能有一个包含所有图像细节（不管数字）的 json 图像并使用上面的 no 3 来加载其中的 10 个图像，是否可以使用 ajax 只读取 10 行并保留最后一个指针它读取了一个，因此可以快速加载 json 文件，刷新时间短，并且任一侧的图像都通过浏览器缓存！

希望这很清楚，关于你将如何处理这个问题的任何建议？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-02T23:47:11.747

要从 Javascript 预加载图像，您不需要执行任何听起来像 AJAX 或 JSON 的操作。你只需要这样：

```
var img = new Image();
img.src = "http://example.com/new/image.jpg"; 
```

浏览器会很高兴地在后台加载图像，即使它没有显示在任何地方。然后，当您更新`src`另一个（显示的）图像标签的字段时，浏览器将立即显示它已经加载的图像部分（希望是全部）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T23:52:41.300

通过 Ajax 获取 JSON 只会减慢您的速度。

你最好使用内联 JSON 和生成的 Javascript。

```
 <?php 
       $images = array( "foo.jpg","bar.jpg" ); 
 ?>
 <script type="text/javascript">
   jQuery(function($){
       var images = ( <?php echo json_encode($images); ?> ); 
       /* Creating A Hidden box to preload the images into */
       var imgbox = document.createElement("div"); 
       $(imgbox).css({display: 'none'});
       /* Possible Alternative trick */
       /* $(imgbox).css({height:1px; width: 1px; overflow: hidden;}); */
       $('body').append(imgbox);

       $.each( images , function( ind, item ) 
       {
          #Injecting images into the bottom hidden div. 
          var img = document.createElement("img"); 
          $(img).src("/some/prefix/" + item ); 
          $(imgbox).append(img);
       });
    }); 
 </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-02T08:39:01.210

在你想**同时**预加载大量资源的情况下，一点 ajax 就可以为你解决问题。只需确保缓存标头使得浏览器将在下一个请求中使用资源。在以下示例中，我最多同时加载四个资源。

```
<script>
var urls = [
  "a.png",
  "b.png",
  "c.png",
  "d.png",
  "e.png",
  "f.png"
];

var currentStep = 0;
function loadResources()
{
  if(currentStep<urls.length){
  var url = urls[currentStep];
  var req = GetXmlHttpObject();
  update('loading ' + url);
  req.open("GET", url, true);
  req.onreadystatechange = getUpdateState(req, url);
  req.send(null);
} else {
  window.location = 'done.htm';
}
}

function getUpdateState(req, url) {
  return function() {
    var state = req.readyState;
    if (state != 4) { return; }
    req = null;
    setTimeout('loadResources()', 0);
  }
}
</script>

<!-- This will queue up to four concurrent requests.  Modern browsers will request up to eight images at time  -->
<body onload="javascript: loadResources(); loadResources(); loadResources(); loadResources();"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-18T23:11:19.680

为什么不使用文本并用图片代码替换文本（在 php 中工作非常好，ajax 最多 500 张图片等等）？

# unit-testing - 如何对复杂方法进行单元测试

> ID：257551
> 
> 赞同：26
> 
> 时间：2008-11-02T23:09:00.967
> 
> 标签：unit-testing, language-agnostic

我有一个方法，给定一个北角和一个方位角，从 8 个可能的值（北、东北、东等）中返回一个罗盘点值。我想创建一个单元测试，该测试可以很好地覆盖此方法，为 North 和 Bearing 提供不同的值，以确保我有足够的覆盖率，让我相信我的方法有效。

我最初的尝试为 North 从 -360 到 360 生成了所有可能的整数值，并测试了从 -360 到 360 的每个轴承值。但是，我的测试代码最终成为我正在测试的代码的另一个实现。这让我想知道最好的测试是什么，这样我的测试代码不只是包含与我的生产代码可能相同的错误。

我当前的解决方案是花时间编写一个包含数据点和预期结果的 XML 文件，我可以在测试期间读入并使用它来验证方法，但这似乎非常耗时。我不想编写一个包含与我的原始测试包含的值范围相同的文件（这将是很多 XML），但我确实希望包含足够的内容以充分测试该方法。

*   如何在不重新实现方法的情况下测试方法？
*   我如何获得足够的覆盖率以对我正在测试的方法充满信心，而不必为所有可能的输入和结果设置测试点？

显然，不要过多关注我的具体示例，因为这适用于许多需要测试的复杂计算和数据范围的情况。

注意：我使用的是 Visual Studio 和 C#，但我相信这个问题与语言无关。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-02T23:20:57.417

首先，您是对的，您*不*希望您的测试代码重现与被测代码相同的计算。其次，您的第二种方法是朝着正确方向迈出的一步。您的测试*应*包含一组特定的输入，其中包含这些输入的预先计算的预期输出值。

您的 XML 文件应该只包含您所描述的输入数据的一个子集。您的测试应确保您可以处理输入域的极端范围（-360、360）、范围末端的一些数据点和中间的一些数据点。当给定值超出输入范围（例如 -361 和 +361）时，您的测试还应该检查您的代码是否正常失败。

最后，在您的特定情况下，您可能需要更多的边缘情况，以确保您的函数正确处理有效输入范围内的“切换”点。这些将是您的输入数据中的点，预计输出将从“North”切换到“Northwest”，从“Northwest”切换到“West”等（不要运行代码来查找这些点，计算它们用手）。

只专注于这些边缘情况和边缘之间的一些情况应该会大大减少您必须测试的点数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-02T23:16:43.150

您可以将方法重新分解为更易于单元测试的部分，并为这些部分编写单元测试。那么整个方法的单元测试只需要专注于集成问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-02T23:32:31.653

我更喜欢执行以下操作。

1.  创建一个包含正确答案的电子表格。不管它需要多么复杂是无关紧要的。您只需要一些包含案例的列和一些包含预期结果的列。

    对于您的示例，这可能很大。不过大一点就好了。您将有一个角度、一个方位和由此产生的罗盘点值。你可能有一堆中间结果。

2.  创建一个读取电子表格并编写简化的底线单元测试用例的小程序。你希望你的案件精简到

    ```
    def testCase215n( self ):
        self.fixture.setCourse( 215 )
        self.fixture.setBearing( 45 )
        self.fixture.calculate()
        self.assertEquals( "N", self.fixture.compass() ) 
    ```

[那是 Python，同样的想法也适用于 C#。]

该电子表格包含唯一的权威正确答案列表。您由此生成代码一次或两次。当然，除非您在电子表格版本中发现错误并且必须修复它。

我使用带有 xlrd 和 Mako 模板生成器的小型 Python 程序来执行此操作。你可以对 C# 产品做类似的事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-03T00:19:35.537

如果您可以想到一个*完全不同*的方法实现，其中隐藏错误的位置*完全不同*，您可以对此进行测试。当我有一个高效但复杂的实现可以更简单但低效地实现时，我经常做这样的事情。例如，如果编写一个哈希表实现，我可能会实现一个基于线性搜索的关联数组来测试它，然后使用大量随机生成的输入进行测试。线性搜索 AA 很难搞砸，甚至更难以搞砸，以至于它的错误方式与哈希表*相同。*因此，如果哈希表具有与线性搜索 AA 相同的可观察行为，我会非常确信它是正确的。

其他示例包括编写冒泡排序来测试堆排序，或使用已知的工作排序函数来查找中位数并将其与 O(N) 中位数查找算法实现的结果进行比较。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-02T23:20:42.050

我相信您的解决方案很好，尽管使用了 XML 文件（我会使用纯文本文件）。但更常用的策略是仅测试限制情况，例如在您的情况下使用 -360、360、-361、361 和 0 的输入值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T01:27:54.273

您可以尝试[正交阵列测试](http://en.wikipedia.org/wiki/Orthogonal_array)来实现所有对的覆盖，而不是所有可能的组合。这是一种基于理论的统计技术，即大多数错误是由于参数对之间的相互作用而发生的。它可以大大减少您编写的测试用例的数量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-03T02:35:53.170

不知道你的代码有多复杂，如果它取一个整数并在罗盘上将它分成 8 个或 16 个方向，它可能是几行代码是吗？

您将很难不重新编写代码来测试它，这取决于您如何测试它。理想情况下，您希望独立方根据相同的要求编写测试代码，但无需查看或借用您的代码。这在大多数情况下不太可能发生。在这种情况下，这可能是矫枉过正。

在这种特定情况下，我将按从 -360 到 +360 的顺序输入每个数字，并打印数字和结果（以可以作为头文件编译到另一个程序中的格式的文本文件）。目视检查所需输入处的方向是否发生变化。这应该很容易目视检查和验证。现在您有一个输入和有效输出表。接下来让一个程序从有效输入中随机选择并将其输入到您的测试代码中，并查看正确的答案。做几百个这样的随机测试。在某些时候，您需要验证是否根据您的要求处理小于 -360 或大于 +360 的数字，我假设是剪辑或调制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-02T23:59:44.047

所以我拿了一个软件测试类[链接文本](http://cs.gmu.edu/~offutt/softwaretest/)，基本上你想要的是识别输入类..所有实数？所有整数，只有正数，只有负数等......然后对输出动作进行分组。360 与 359 有什么不同，或者他们最终对应用程序做同样的事情。一旦有输入到输出的组合。

这一切看起来很抽象和模糊，但是在您提供方法代码之前，很难想出一个完美的策略。

另一种方法是进行分支级别测试或谓词覆盖测试。代码覆盖率不是万无一失的，但不覆盖所有代码似乎是不负责任的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-03T00:35:39.340

一种方法，可能是与其他测试方法结合应用的一种方法，是查看您是否可以创建一个反转您正在测试的方法的函数。在这种情况下，它将采用罗盘方向（例如东北），并输出方位（给定北的方位）。然后，您可以通过将其应用于一系列输入来测试该方法，然后应用该函数来反转该方法，并查看您是否获得了原始输入。

存在复杂性，特别是如果一个输出对应于多个输入，但在这些情况下可能会生成对应于给定输出的一组输入，并测试该集合的每个成员（或元素的某个样本）集）。

这种方法的优点是它不依赖于您能够手动模拟该方法，或创建该方法的替代实现。如果逆转涉及到与原始方法不同的解决问题的方法，它应该会降低在两者中犯相同错误的风险。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T05:36:31.277

伪代码：

```
array colors = { red, orange, yellow, green, blue, brown, black, white }
for north = -360 to 361
    for bearing = -361 to 361
        theColor = colors[dirFunction(north, bearing)] // dirFunction is the one being tested
        setColor (theColor)
        drawLine (centerX, centerY,
                  centerX + (cos(north + bearing) * radius),
                  centerY + (sin(north + bearing) * radius))
        Verify Resulting Circle against rotated reference diagram. 
```

当 North = 0 时，您将获得一个 8 色饼图。随着北变化 + 或 -，饼图看起来相同，但旋转了那么多度数。测试验证很简单，确保 (a) 图像是正确旋转的饼图，并且 (b) 橙色区域中没有任何绿点等。

顺便说一句，这种技术是世界上最伟大的调试工具的一种变体：让计算机为您绘制一张 =IT= 认为它在做什么的图片。（开发人员经常浪费时间去追逐*他们*认为计算机在做什么，却发现它在做完全不同的事情。）

# c++ - C++ Program communicating with MySQL Database

> ID：257552
> 
> 赞同：3
> 
> 时间：2008-11-02T23:10:44.300
> 
> 标签：c++, mysql

Does anyone know of a simple way for a C++ program to communicate directly with a MySQL database? I have looked at MySQL++ and found it to be very confusing. If anyone knows of a very simple way of doing this, please let me know.

Thanks

P.S. I am developing on a Windows machine. PHP and MySQL web web application setup. C++ setup to talk to the serial port. Thus why I need a way for C++ to talk to the MySQL database directly.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T00:59:00.667

有很多数据库 API 包装器，但我最喜欢的——也是我推荐的——是[SOCI](http://soci.sourceforge.net/)库。 *比*使用原始 C API 更好的语法。

SOCI 网站上的“激励”示例：

```
int id = ...;
string name;
int salary;

sql << "select name, salary from persons where id = " << id, into(name), into(salary); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-02T23:17:43.477

The [C MySQL API](http://dev.mysql.com/doc/refman/5.0/en/c-api-function-overview.html) is just like using the PHP MySQL extension and so should be pretty familiar. If you are comfortable with C, I'd recommend that (and you don't mind mixing C in your C++).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-02T23:14:48.943

Use the C API:

[http://dev.mysql.com/doc/refman/5.0/en/c.html](http://dev.mysql.com/doc/refman/5.0/en/c.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-07T08:07:54.267

MySQL Connector/C++ 是 JDBC 4.0 的 C++ 实现

使用 MySQL Connector/C++ 的参考客户有： - OpenOffice - MySQL Workbench

了解更多： http: [//forums.mysql.com/read.php?167,221298](http://forums.mysql.com/read.php?167,221298)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T00:46:36.260

MySQL has a beta release of MySQL Connector C++ that can be found [Here](http://forge.mysql.com/wiki/Connector_C%2B%2B). It's a connector written in C++ but modeled after Java's JDBC connectors. If you've used JDBC at all, this will feel almost identical. It's also cross platform and can be compiled on Linux, Windows, and Mac OS.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T16:46:37.307

我使用 MySQL++ 取得了巨大的成功。我发现它是我在 MySQL 数据库客户端库中寻找的一切。他们提供的示例很棒，请参见[此处](http://tangentsoft.net/mysql++/doc/html/userman/tutorial.html#simple)以获取简单的示例。

如果你了解 C++，它比 C 库更容易使用。它适用于 Windows。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T18:33:30.117

使用 SQLAPI++ - 它执行 SQL Server 等等。

[http://www.sqlapi.com/](http://www.sqlapi.com/)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-11-03T16:49:20.983

您确定 C++ 程序需要直接与 MySQL 数据库交互吗？

我建议让 C++ 程序使用简单的 http 请求与 Web 服务器通信，并让 PHP 处理数据库。可以通过参数将数据传递给服务器端 PHP 脚本，并且可以以 XML 格式返回数据。

写作：your.server.com/add_data.php?table="info"&data="0xFCBD..."

阅读：your.server.com/get_data.php?table="info"

# python - Python MySQL 语句返回错误

> ID：257563
> 
> 赞同：3
> 
> 时间：2008-11-02T23:26:35.267
> 
> 标签：python, sql

嘿，我对这一切都很陌生，所以请原谅愚蠢:)

```
import os
import MySQLdb
import time

db = MySQLdb.connect(host="localhost", user="root", passwd="********", db="workspace")
cursor = db.cursor()

tailoutputfile = os.popen('tail -f syslog.log')
while 1:
        x = tailoutputfile.readline()  
        if len(x)==0:
                break
        y = x.split()
        if y[2] == 'BAD':
                timestring = time.strftime("%Y-%m-%d %H:%M:%S", time.localtime(time.time()))
                cursor.execute("INSERT INTO releases (date, cat, name) values (timestring, y[4], y[7]")
        if y[2] == 'GOOD':
                print y[4] + '\t' + y[7] 
```

所以我运行程序，这是我收到的错误消息

```
user@machine:~/$ python reader.py
Traceback (most recent call last):
  File "reader.py", line 17, in ?
    cursor.execute("INSERT INTO releases (date, cat, name) values (timestring, y[4], y[7]")
  File "/usr/lib/python2.4/site-packages/MySQLdb/cursors.py", line 163, in execute
    self.errorhandler(self, exc, value)
  File "/usr/lib/python2.4/site-packages/MySQLdb/connections.py", line 35, in defaulterrorhandler
    raise errorclass, errorvalue
_mysql_exceptions.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to                                                              your MySQL server version for the right syntax to use near '[4], y[7]' at line 1")
user@machine:~/$ 
```

所以我假设错误显然来自 SQL 语句

```
cursor.execute("INSERT INTO releases (date, cat, name) values (timestring, y[4], y[7]") 
```

这是 y[4] 和 y[7] 的示例。

```
YES      Mail.Sent.To.User:user@work.com.11.2.2008:23.17 
```

发生此错误是因为我应该在尝试将它们插入数据库之前转义这些值吗？还是我完全错过了重点？

任何帮助，将不胜感激！提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T00:02:17.363

正如所指出的，您没有将 Python 变量值复制到查询中，只有它们的名称，这对 MySQL 没有任何意义。

但是直接字符串连接选项：

```
cursor.execute("INSERT INTO releases (date, cat, name) VALUES ('%s', '%s', '%s')" % (timestring, y[4], y[7])) 
```

是危险的，不应该使用。如果这些字符串包含像 ' 或 \ in 这样的越界字符，那么您就有了 SQL 注入，可能会导致安全隐患。也许在您的特定应用程序中永远不会发生，但这仍然是一个非常糟糕的做法，初学者的 SQL 教程确实需要停止使用。

使用 MySQLdb 的解决方案是让 DBAPI 层为您将参数值插入和转义到 SQL 中，而不是自己尝试 %：

```
cursor.execute('INSERT INTO releases (date, cat, name) VALUES (%s, %s, %s)', (timestring, y[4], y[7])) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-02T23:29:44.280

```
 cursor.execute("INSERT INTO releases (date, cat, name) values (timestring, y[4], y[7]") 
```

应该

```
 cursor.execute("INSERT INTO releases (date, cat, name) values (timestring, '%s', '%s')" % (y[4], y[7])) 
```

调试这样的事情最好的办法是将查询放入一个变量并使用它：

```
query = "INSERT INTO releases (date, cat, name) values (timestring, '%s', '%s')" % (y[4], y[7])
print query
cursor.execute(query) 
```

该打印声明将使问题非常明显。

如果您要像这样使用列表变量，它可能会变得非常混乱，请考虑只使用一次列表并将变量放入字典中。打字要长一些，但要跟踪正在发生的事情要容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-18T10:46:53.713

永远不要对 SQL 使用“直接字符串连接”，因为它不安全，更正确的变体：

```
cursor.execute('INSERT INTO releases (date, cat, name) VALUES (%s, %s, %s)', (timestring, y[4], y[7])) 
```

它自动转义值中的禁止符号（例如“，'等）

# java - 在 Struts2 中使用 Stream 结果

> ID：257566
> 
> 赞同：3
> 
> 时间：2008-11-02T23:28:08.900
> 
> 标签：java, struts2, resulttype

我正在尝试使用 Stream Result 从 struts2 应用程序返回图像。我似乎在配置操作时遇到问题。这是配置：

```
 <result name="success" type="stream">
            <param name="contentType">image/jpeg</param>
            <param name="inputName">inputStream</param>
            <param name="contentDisposition">filename="${filename}"</param>
            <param name="bufferSize">1024</param>
    </result> 
```

问题似乎是 inputName 参数，根据文档是：

> 来自链接操作的 InputStream 属性的名称（默认 = inputStream）。

我不确定我应该放什么名字。我得到的错误是：

> 在调用堆栈中找不到名称为 [inputStream] 的 java.io.InputStream。

以前有人用过这个吗？有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T19:51:18.077

我相信您的 contentDisposition 错误，应该是：

```
<param name="contentDisposition">attachment; filename="${filename}"</param> 
```

（*克里斯*）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T00:31:09.163

我发现[这](http://www.nabble.com/Struts-2-File-upload-to-store-the-filedata-td14168069.html)解释了`InputStream`必须由我创建。`InputStream`我从希望用户下载的文件创建一个然后将 Stream 传递给结果是有道理的。我想这就是我的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T21:49:55.103

Inputname 定义了输出“流”的方法的名称

public InputStream getInputStream () { return new ByteArrayInputStream ( _bytes ); }

# windows-vista - 为什么有些菜单在光标左侧打开而有些在右侧打开？

> ID：257569
> 
> 赞同：3
> 
> 时间：2008-11-02T23:28:54.670
> 
> 标签：windows-vista, menu

在某些应用程序（特别是 Visual Studio 2008、Windows Explorer、Internet Explorer）中，所有菜单都在光标左侧打开。在其他应用程序（Firefox、ACDSee）中，它们向右打开。然后是福昕阅读器，菜单栏中的阅读器向左打开，上下文菜单向右打开。

这很烦人。有没有办法让所有东西都朝同一个方向打开？（最好在右边）我正在运行 Vista Ultimate。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-02T23:39:45.007

在控制面板中，转到“Mobile PC”类别中的“Tablet PC Settings”，然后在“General”选项卡中，选择“Left-handed”以使菜单出现在右侧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-02T23:30:16.353

是不是因为光标在屏幕的最右边，所以才出现在左边？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T23:38:14.340

他们都为我打开了右边。您是否以某种方式将国际化设置设置为从右到左的语言？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T00:00:36.353

对于 IE7 / IE8，对于 MSFT 选择将命令栏（上面有主页、页面、工具等的那个）作为 Cascade-Menu-Left Toolbar 的选择存在很多争论和批评。

事实上，你甚至不能把它放在屏幕的左侧，并且在它之后的同一行上有内容......即使你这样做了，它仍然不能修复菜单级联。

我不确定这是否是你唯一的问题，但我不会把这个应用程序使用菜单作为一个“好”的例子。

# php - IDE、SVN 和推送到网站！

> ID：257577
> 
> 赞同：2
> 
> 时间：2008-11-02T23:35:27.293
> 
> 标签：php, svn, ide, aptana, unfuddle

我正在考虑更新我的做法，并寻求一些帮助和建议！

我在运行 joomla、oscommerce、drupal 等的网站上做了很多工作，因此我创建了很多自定义组件/插件和黑客等。目前每个网站在我的 xampp 设置中都有自己的文件夹。我想做的是（例如）Joomla 设置的默认设置，当我进行更改更新时，我可以做一些更新包含 joomla 的所有其他文件夹的操作，就像自动更新一样？

我也在考虑更多地使用 Aptana IDE 和 SVN 服务（如[unfuddle](http://unfuddle.com/)）与他人分享我的工作，但我之前没有使用过 SVN，不确定是否可以使用 SVN 完成上述操作？

如果能够处理主要/核心项目并将更新发送到本地更新和实际服务器，而无需维护许多不同的单独站点，那就太好了。

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T00:06:16.093

是的，SVN 将是一个很好的工具。将您的代码（例如：自定义 Joomla 组件）存储在源代码管理中。无论您想在哪里使用该组件，只需在您的实时站点中执行该特定文件夹的一个`checkout`或一个。`export`这是构建存储库的一种方法：

```
unfuddle.com/myRepo/trunk/com_myComponent
unfuddle.com/myRepo/trunk/com_anotherComponent

```

通过 SSH 登录到您的实时服务器并运行以下命令：

```
> cd 路径/到/joomla/组件
> svn co http://unfuddle.com/myRepo/trunk/com_myComponent

```

每当您更改代码时，请提交更改，然后重新登录服务器并运行：

```
> cd 路径/到/joomla/组件
> svn up com_myComponent

```

这样做的真正好处是，如果您进行更新并破坏某些内容，您始终可以将其回滚到最后一个已知的“好”版本。

至于自动化这个过程，如果它在不同的服务器上，你可能会不走运。对于同一台服务器上的多个部署，您可以很容易地编写一个 shell 脚本来为每个站点/组件运行上述命令。如果您需要完全自动化，您甚至可以设置一个 cron 作业以在每天凌晨 2 点或其他时间运行此脚本 - 我个人会坚持使用手动方法，但它仍然是一种选择。

为了在本地使用您的 SVN 存储库，我建议您查看[TortoiseSVN](http://tortoisesvn.tigris.org/)（如果您在 Windows 上）：这是使用 SVN 的最简单和最简单的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-21T18:43:46.917

为了使事情自动化，您可以为此使用 SVN 钩子。有一个 post-commit 钩子，所以每次提交时，你的钩子脚本可以告诉其他机器进行 SVN 更新以获取最新代码。

有关详细信息，请参阅[使用 Subversion 进行版本控制 - 实施存储库挂钩](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.create.html#svn.reposadmin.create.hooks)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T00:08:45.073

对于您的情况，我没有一个好的答案，但我不认为 Subversion 本身就是答案。

[这个问题](https://stackoverflow.com/questions/249085/shared-components-throughout-all-projects-is-there-a-better-alternative-than-sv#249146)解决了一些关于 Subversion 跨“项目”共享机制的问题。

Subversion 当然可以处理这个难题的源代码管理部分。自动分发，我会使用另一个工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T05:03:07.397

看看[卡皮斯特拉诺](http://www.capify.org/)。我已经用过几次了，一旦你弄明白了，它就很不错了。针对rails，但应该适用于需要从存储库获取代码并将其部署在不同服务器上的任何地方。

# asp.net - 安排网页

> ID：257583
> 
> 赞同：1
> 
> 时间：2008-11-02T23:40:47.453
> 
> 标签：asp.net, iis, windows-server-2008

我需要安排几个不同站点上的几个不同页面在特定时间运行，通常是每晚一次。有没有软件可以做到这一点？如果它调用页面然后记录响应以及调用的页面是否成功运行，那就太好了。我在不同的机器上使用 Helm，它有一个不错的 Web Scheduler 模块，但 Helm 不是这台机器的选项。这是一个 Window Server 2008 盒子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T17:52:42.413

我们使用调用 VBS 文件的 bat 文件的标准计划任务。我知道这不是有史以来最优雅的解决方案，但它始终有效。

蝙蝠：

```
webrun.vbs http://website.com/page.aspx 
```

VBS：

```
dim URL, oArgs  

Set oArgs = WScript.Arguments  

    if oArgs.Count = 0 then  
    msgbox("Error: Must supply URL")  
    wscript.quit 1  
    end if  

URL = oArgs(0)  

 on error resume next  
Set objXML = CreateObject("MSXML2.ServerXMLHTTP")  

    if err then  
    msgbox("Error: " & err.description)  
    wscript.quit 1  
    end if  

' Call the remote machine the request  
    objXML.open "GET", URL, False  

    objXML.send()  

' return the response  
    'msgbox objXML.responSetext  

' clean up  
    Set objXML = Nothing 
```

VBS 文件中的代码几乎可以肯定是过度杀伤和覆盖，但功能仍然没有问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-02T23:48:26.330

[wget.exe](http://www.google.com/search?hl=en&rls=com.microsoft%3Aen-us&q=wget+windows)和任务调度程序怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-24T10:05:53.810

上例中给出的代码在加载网站期间任务处于活动状态时存在一些问题。该网站正在加载 2 分钟，但任务已在 1 秒内完成，当您每 5 分钟执行一次时会出现问题。如果网站加载 10 分钟并且任务已经在 1 秒内完成，它将再次执行，而我希望它等待网站的加载时间。

所以我所做的是以下（只要网站正在加载，这个脚本就会让任务保持忙碌）：

```
dim URL, oArgs, objXML
Set oArgs = WScript.Arguments
URL = oArgs(0)

on error resume next

Set objXML = CreateObject("Microsoft.XMLDOM")
objXML.async = "false"
objXML.load(URL)
Set objXML = Nothing 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T23:53:21.283

如果不需要从同一个框中安排它们，请查看[Zoho 的 site24x7](http://site24x7.com)。

它最初旨在监控网站，但它可以选择记录预期答案并进行比较，以便您可以将其用于您的目的，并增加外部网站的安全性。它不是免费的，但是除了几个网址。

他们是其他类似的提供商，但上次我在网上搜索这个主题时，他们看起来还不错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T14:41:17.633

我最终使用了这个脚本和任务计划程序，简单而且效果很好：

```
Call LogEntry()
Sub LogEntry()

'Force the script to finish on an error.
On Error Resume Next

'Declare variables
Dim objRequest
Dim URLs
URLs = Wscript.Arguments(0)
Set objRequest = CreateObject("Microsoft.XMLHTTP")

'Open the HTTP request and pass the URL to the objRequest object
objRequest.open "POST", URLs, false

'Send the HTML Request
objRequest.Send

Set objRequest = Nothing
WScript.Quit

End Sub 
```

然后我只是用我想作为参数运行的 URL 来调用它：

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T18:12:01.703

类似的（虽然可能更强大）是[netcat](http://netcat.sourceforge.net/)和它的[windows 端口](http://www.securityfocus.com/tools/139)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T19:44:52.203

fyi - wget 是 GNU 标准许可证，所以我不确定它是否可用于大多数商业/专有系统。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-15T00:29:27.287

我使用[http://scheduler.codeeffects.com](http://scheduler.codeeffects.com)。非常有效和可靠，没有抱怨。

# model-view-controller - 对于基于浏览器的游戏，我应该使用什么模型？

> ID：257586
> 
> 赞同：3
> 
> 时间：2008-11-02T23:41:46.923
> 
> 标签：model-view-controller, browser, language-agnostic

作为一个爱好项目，我目前正在尝试创建一个基于浏览器的小型游戏——我认为使用 MVC 模式对其进行编码是“正确的事情”，将游戏的“引擎”与演示分开。这将是一个简单的“rpg”游戏，玩家的角色在世界各地与怪物战斗并收集物品。

我的问题是我被引擎的结构卡住了。在当前的设计中，大部分引擎都以“玩家角色”对象为主——有诸如位置、怪物或物品之类的东西，但它是一个角色，它完成了大部分动作：旅行、攻击、购买物品等。知道可能还有其他方法可以设计这种引擎，但不知何故我无法弄清楚，所以我在这里寻求一些提示或建议。

哦，服务器后端将是 php+mysql，如果这很重要的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T00:13:38.107

“但它是一个做大部分动作的角色：”

对，但是...

首先，将人类用户（“玩家”）与其角色分开。角色不是玩家。

您有大量对象。地点、被动事物、主动事物（怪物）和角色。他们都相互影响。

你必须完全隔离责任。角色不主宰，角色只是参与。

如果您将每个可能的人类玩家动作定义为**Command** ，您会发现它更令人愉快。**Command**的每个子类都可以更改模型的状态。东西移动，怪物移动，角色移动（角色，而不是玩家。）

捡起或放下东西都是**Command**的一个子类，可以将东西从一个角色移动到另一个位置或从一个位置移动到另一个角色。玩家发出命令；该命令更新位置、项目和字符。

角色是被动的。事情大多是被动的。位置大多是被动的。Command 对象具有更新模型中所有不同事物之间的状态和关联的算法。

如果您想更进一步，每个**命令**都可以是具有撤消功能和执行功能的**备忘录。**那么游戏的历史就是这些**纪念品**的历史。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T00:14:25.843

我对你的问题有点困惑。

MVC 是一个独立于游戏引擎设计的模式——无论底层引擎结构是什么样子，你仍然需要一个 MVC 模式——用户将与提交回控件的视图交互。在您的情况下，“M”可能是当前游戏状态的一个非常复杂的模型。

我会从纯粹的数据驱动的角度来考虑这个问题。发生的一切最终都是对 Character 模型的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T01:36:10.733

角色是模型的一部分，但该角色是抽象的——它只是服务器上的一个对象或数据结构。我使用 MVC 来保持诚实的一种技术是有一种方法可以在没有图形视图和控制器的情况下驱动模型。对于基于 Web 的应用程序，您可以通过文本 GET 请求或 XMLRPC 等驱动它。

# c# - 在 WPF 中将窗口置于最前面

> ID：257587
> 
> 赞同：232
> 
> 时间：2008-11-02T23:42:59.667
> 
> 标签：c#, .net, wpf, winapi, pinvoke

如何将我的 WPF 应用程序带到桌面的前面？到目前为止，我已经尝试过：

```
SwitchToThisWindow(new WindowInteropHelper(Application.Current.MainWindow).Handle, true);

SetWindowPos(new WindowInteropHelper(Application.Current.MainWindow).Handle, IntPtr.Zero, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE);

SetForegroundWindow(new WindowInteropHelper(Application.Current.MainWindow).Handle); 
```

没有一个在做这项工作（`Marshal.GetLastWin32Error()`是说这些操作成功完成，并且每个定义的 P/Invoke 属性确实有`SetLastError=true`）。

如果我创建一个新的空白 WPF 应用程序并`SwitchToThisWindow`使用计时器调用，它会完全按预期工作，所以我不确定为什么它在我原来的情况下不起作用。

**编辑**：我正在与全局热键一起执行此操作。

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2008-12-20T20:32:51.970

```
myWindow.Activate(); 
```

*尝试将窗口置于前台并激活它。*

这应该可以解决问题，除非我误解了并且您想要始终处于最佳状态。在这种情况下，您想要：

```
myWindow.TopMost = true; 
```

* * *

## 回答 #2

> 赞同：186
> 
> 时间：2011-01-28T18:39:46.390

我找到了一个将窗口置于顶部的解决方案，但它的行为与普通窗口一样：

```
if (!Window.IsVisible)
{
    Window.Show();
}

if (Window.WindowState == WindowState.Minimized)
{
    Window.WindowState = WindowState.Normal;
}

Window.Activate();
Window.Topmost = true;  // important
Window.Topmost = false; // important
Window.Focus();         // important 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-10-14T09:29:00.813

如果您需要在第一次加载时将窗口放在前面，那么您应该使用以下内容：

```
private void Window_ContentRendered(object sender, EventArgs e)
{
    this.Topmost = false;
}

private void Window_Initialized(object sender, EventArgs e)
{
    this.Topmost = true;
} 
```

或者通过覆盖方法：

```
protected override void OnContentRendered(EventArgs e)
{
    base.OnContentRendered(e);
    Topmost = false;
}

protected override void OnInitialized(EventArgs e)
{
    base.OnInitialized(e);
    Topmost = true;
} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2012-07-19T01:56:55.567

我知道这个问题已经很老了，但我刚刚遇到了这个精确的场景，并想分享我实施的解决方案。

正如本页评论中提到的，提出的几个解决方案不适用于 XP，我需要在我的场景中支持它。虽然我同意@Matthew Xavier 的观点，即这通常是一种糟糕的用户体验实践，但有时它完全是一个合理的用户体验。

将 WPF 窗口置于顶部的解决方案实际上是由我用来提供全局热键的相同代码提供给我的。[Joseph Cooney 的博客文章](http://learnwpf.com/post/2011/08/03/Adding-a-system-wide-keyboard-hook-to-your-WPF-Application.aspx)包含[指向他的代码示例的链接](https://bitbucket.org/josephcooney/learnwpf.com.samples)，其中包含原始代码。

我已经对代码进行了一些清理和修改，并将其实现为 System.Windows.Window 的扩展方法。我已经在 XP 32 位和 Win7 64 位上对此进行了测试，两者都可以正常工作。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Interop;
using System.Runtime.InteropServices;

namespace System.Windows
{
    public static class SystemWindows
    {
        #region Constants

        const UInt32 SWP_NOSIZE = 0x0001;
        const UInt32 SWP_NOMOVE = 0x0002;
        const UInt32 SWP_SHOWWINDOW = 0x0040;

        #endregion

        /// <summary>
        /// Activate a window from anywhere by attaching to the foreground window
        /// </summary>
        public static void GlobalActivate(this Window w)
        {
            //Get the process ID for this window's thread
            var interopHelper = new WindowInteropHelper(w);
            var thisWindowThreadId = GetWindowThreadProcessId(interopHelper.Handle, IntPtr.Zero);

            //Get the process ID for the foreground window's thread
            var currentForegroundWindow = GetForegroundWindow();
            var currentForegroundWindowThreadId = GetWindowThreadProcessId(currentForegroundWindow, IntPtr.Zero);

            //Attach this window's thread to the current window's thread
            AttachThreadInput(currentForegroundWindowThreadId, thisWindowThreadId, true);

            //Set the window position
            SetWindowPos(interopHelper.Handle, new IntPtr(0), 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_SHOWWINDOW);

            //Detach this window's thread from the current window's thread
            AttachThreadInput(currentForegroundWindowThreadId, thisWindowThreadId, false);

            //Show and activate the window
            if (w.WindowState == WindowState.Minimized) w.WindowState = WindowState.Normal;
            w.Show();
            w.Activate();
        }

        #region Imports

        [DllImport("user32.dll")]
        private static extern IntPtr GetForegroundWindow();

        [DllImport("user32.dll")]
        private static extern uint GetWindowThreadProcessId(IntPtr hWnd, IntPtr ProcessId);

        [DllImport("user32.dll")]
        private static extern bool AttachThreadInput(uint idAttach, uint idAttachTo, bool fAttach);

        [DllImport("user32.dll")]
        public static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags);

        #endregion
    }
} 
```

我希望这段代码可以帮助遇到这个问题的其他人。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2011-09-26T18:47:08.900

为了使它成为一个快速的复制粘贴 -
使用这个类的`DoOnProcess`方法将进程的主窗口移动到前台（但不要从其他窗口窃取焦点）

```
public class MoveToForeground
{
    [DllImportAttribute("User32.dll")]
    private static extern int FindWindow(String ClassName, String WindowName);

    const int SWP_NOMOVE        = 0x0002;
    const int SWP_NOSIZE        = 0x0001;            
    const int SWP_SHOWWINDOW    = 0x0040;
    const int SWP_NOACTIVATE    = 0x0010;
    [DllImport("user32.dll", EntryPoint = "SetWindowPos")]
    public static extern IntPtr SetWindowPos(IntPtr hWnd, int hWndInsertAfter, int x, int Y, int cx, int cy, int wFlags);

    public static void DoOnProcess(string processName)
    {
        var allProcs = Process.GetProcessesByName(processName);
        if (allProcs.Length > 0)
        {
            Process proc = allProcs[0];
            int hWnd = FindWindow(null, proc.MainWindowTitle.ToString());
            // Change behavior by settings the wFlags params. See http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx
            SetWindowPos(new IntPtr(hWnd), 0, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE | SWP_SHOWWINDOW | SWP_NOACTIVATE);
        }
    }
} 
```

高温高压

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-01-06T04:43:34.283

如果用户正在与另一个应用程序交互，则可能无法将您的应用程序置于最前面。作为一般规则，如果该进程已经是前台进程，则该进程只能期望设置前台窗口。（Microsoft 在[SetForegroundWindow()](http://msdn.microsoft.com/en-us/library/ms633539(VS.85).aspx) MSDN 条目中记录了限制。）这是因为：

1.  用户“拥有”前景。例如，如果另一个程序在用户打字时偷走了前台，至少会打断她的工作流程，并且可能导致意想不到的后果，因为攻击者会误解她对一个应用程序的击键，直到她注意到更改为止.
2.  想象一下，两个程序中的每一个都检查它的窗口是否是前台，如果不是，则尝试将其设置为前台。一旦第二个程序运行，计算机就会变得毫无用处，因为在每次任务切换时前景在两者之间反弹。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2016-04-20T10:18:34.460

## 为什么此页面上的某些答案是错误的！

*   任何使用的答案`window.Focus()`都是错误的。

    *   为什么？如果弹出通知消息，`window.Focus()`则将焦点从用户当时正在输入的任何内容上移开。这对于最终用户来说是非常令人沮丧的，尤其是在弹出窗口频繁出现的情况下。
*   任何使用的答案`window.Activate()`都是错误的。

    *   为什么？它也会使任何父窗口可见。
*   任何省略的答案`window.ShowActivated = false`都是错误的。
    *   为什么？当消息弹出时，它会将焦点从另一个窗口中移开，这非常烦人！
*   任何不`Visibility.Visible`用于隐藏/显示窗口的答案都是错误的。
    *   为什么？如果我们使用Citrix，如果窗口关闭时没有折叠，它会在屏幕上留下一个奇怪的黑色矩形。因此，我们不能使用`window.Show()`and `window.Hide()`。

本质上：

*   窗口在激活时不应将焦点从任何其他窗口中抢走；
*   窗口在显示时不应激活其父级；
*   该窗口应与 Citrix 兼容。

## MVVM 解决方案

此代码与 Citrix 100% 兼容（屏幕没有空白区域）。它使用普通 WPF 和 DevExpress 进行了测试。

此答案适用于我们想要一个始终位于其他窗口前面的小通知窗口（如果用户在首选项中选择它）的任何用例。

如果这个答案看起来比其他答案更复杂，那是因为它是健壮的企业级代码。此页面上的其他一些答案很简单，但实际上不起作用。

## XAML - 附加属性

将此附加属性添加到`UserControl`窗口中的任何内容。附加的财产将：

*   等到`Loaded`事件被触发（否则它无法查找可视化树以找到父窗口）。
*   添加一个事件处理程序以确保窗口可见或不可见。

在任何时候，您都可以通过翻转附加属性的值来设置窗口是否在前面。

```
<UserControl x:Class="..."
         ...
         attachedProperties:EnsureWindowInForeground.EnsureWindowInForeground=
             "{Binding EnsureWindowInForeground, Mode=OneWay}"> 
```

## C# - 辅助方法

```
public static class HideAndShowWindowHelper
{
    /// <summary>
    ///     Intent: Ensure that small notification window is on top of other windows.
    /// </summary>
    /// <param name="window"></param>
    public static void ShiftWindowIntoForeground(Window window)
    {
        try
        {
            // Prevent the window from grabbing focus away from other windows the first time is created.
            window.ShowActivated = false;

            // Do not use .Show() and .Hide() - not compatible with Citrix!
            if (window.Visibility != Visibility.Visible)
            {
                window.Visibility = Visibility.Visible;
            }

            // We can't allow the window to be maximized, as there is no de-maximize button!
            if (window.WindowState == WindowState.Maximized)
            {
                window.WindowState = WindowState.Normal;
            }

            window.Topmost = true;
        }
        catch (Exception)
        {
            // Gulp. Avoids "Cannot set visibility while window is closing".
        }
    }

    /// <summary>
    ///     Intent: Ensure that small notification window can be hidden by other windows.
    /// </summary>
    /// <param name="window"></param>
    public static void ShiftWindowIntoBackground(Window window)
    {
        try
        {
            // Prevent the window from grabbing focus away from other windows the first time is created.
            window.ShowActivated = false;

            // Do not use .Show() and .Hide() - not compatible with Citrix!
            if (window.Visibility != Visibility.Collapsed)
            {
                window.Visibility = Visibility.Collapsed;
            }

            // We can't allow the window to be maximized, as there is no de-maximize button!
            if (window.WindowState == WindowState.Maximized)
            {
                window.WindowState = WindowState.Normal;
            }

            window.Topmost = false;
        }
        catch (Exception)
        {
            // Gulp. Avoids "Cannot set visibility while window is closing".
        }
    }
} 
```

## 用法

为了使用它，您需要在 ViewModel 中创建窗口：

```
private ToastView _toastViewWindow;
private void ShowWindow()
{
    if (_toastViewWindow == null)
    {
        _toastViewWindow = new ToastView();
        _dialogService.Show<ToastView>(this, this, _toastViewWindow, true);
    }
    ShiftWindowOntoScreenHelper.ShiftWindowOntoScreen(_toastViewWindow);
    HideAndShowWindowHelper.ShiftWindowIntoForeground(_toastViewWindow);
}

private void HideWindow()
{
    if (_toastViewWindow != null)
    {
        HideAndShowWindowHelper.ShiftWindowIntoBackground(_toastViewWindow);
    }
} 
```

## 附加链接

有关如何确保通知窗口始终移回可见屏幕的提示，请参阅我的回答：[在 WPF 中，如果窗口不在屏幕上，如何将窗口移到屏幕上？](https://stackoverflow.com/questions/37927011/in-wpf-how-to-shift-a-window-onto-the-screen-if-it-is-off-the-screen).

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2014-12-11T10:17:53.263

我知道这是迟到的答案，可能对研究人员有帮助

```
 if (!WindowName.IsVisible)
 {
     WindowName.Show();
     WindowName.Activate();
 } 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2010-10-07T23:41:01.793

我在通过 Shell 对象从 Access 应用程序调用的 WPF 应用程序中遇到了类似的问题。

我的解决方案如下 - 适用于 XP 和 Win7 x64，应用程序编译为 x86 目标。

我宁愿这样做也不愿模拟 alt-tab。

```
void Window_Loaded(object sender, RoutedEventArgs e)
{
    // make sure the window is normal or maximised
    // this was the core of the problem for me;
    // even though the default was "Normal", starting it via shell minimised it
    this.WindowState = WindowState.Normal;

    // only required for some scenarios
    this.Activate();
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-08-16T15:51:08.897

好吧，因为这是一个如此热门的话题......这对我有用。如果我不这样做，我会收到错误，因为如果您看不到窗口，Activate() 会在您身上出错。

xml:

```
<Window .... 
        Topmost="True" 
        .... 
        ContentRendered="mainWindow_ContentRendered"> .... </Window> 
```

代码隐藏：

```
private void mainWindow_ContentRendered(object sender, EventArgs e)
{
    this.Topmost = false;
    this.Activate();
    _UsernameTextBox.Focus();
} 
```

这是我让窗口显示在顶部的唯一方法。然后激活它，这样您就可以在框中键入，而无需用鼠标设置焦点。除非窗口是 Active()，否则 control.Focus() 将不起作用；

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-03T01:40:26.450

好吧，我想出了一个解决方法。我正在从用于实现热键的键盘挂钩进行调用。如果我暂停将其放入 BackgroundWorker，该调用将按预期工作。这是一个kludge，但我不知道为什么它最初不起作用。

```
void hotkey_execute()
{
    IntPtr handle = new WindowInteropHelper(Application.Current.MainWindow).Handle;
    BackgroundWorker bg = new BackgroundWorker();
    bg.DoWork += new DoWorkEventHandler(delegate
        {
            Thread.Sleep(10);
            SwitchToThisWindow(handle, true);
        });
    bg.RunWorkerAsync();
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-11-11T17:32:59.883

要显示任何当前打开的窗口，请导入这些 DLL：

```
public partial class Form1 : Form
{
    [DllImportAttribute("User32.dll")]
    private static extern int FindWindow(String ClassName, String WindowName);
    [DllImportAttribute("User32.dll")]
    private static extern int SetForegroundWindow(int hWnd); 
```

并在程序中搜索具有指定标题的应用程序（写标题不带首字母（索引> 0））

```
 foreach (Process proc in Process.GetProcesses())
                {
                    tx = proc.MainWindowTitle.ToString();
                    if (tx.IndexOf("Title of Your app WITHOUT FIRST LETTER") > 0)
                    {
                        tx = proc.MainWindowTitle;
                        hWnd = proc.Handle.ToInt32(); break;
                    }
                }
                hWnd = FindWindow(null, tx);
                if (hWnd > 0)
                {
                    SetForegroundWindow(hWnd);
                } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-04-12T21:19:44.260

只是想为这个问题添加另一个解决方案。此实现适用于我的场景，其中 CaliBurn 负责显示主窗口。

```
protected override void OnStartup(object sender, StartupEventArgs e)
{
    DisplayRootViewFor<IMainWindowViewModel>();

    Application.MainWindow.Topmost = true;
    Application.MainWindow.Activate();
    Application.MainWindow.Activated += OnMainWindowActivated;
}

private static void OnMainWindowActivated(object sender, EventArgs e)
{
    var window = sender as Window;
    if (window != null)
    {
        window.Activated -= OnMainWindowActivated;
        window.Topmost = false;
        window.Focus();
    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-27T21:03:31.177

问题可能是从钩子调用您的代码的线程尚未由运行时初始化，因此调用运行时方法不起作用。

也许您可以尝试执行 Invoke 以将您的代码编组到 UI 线程，以调用将窗口带到前台的代码。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-02-05T09:37:38.953

这些代码将始终正常工作。

首先在 XAML 中设置激活的事件处理程序：

```
Activated="Window_Activated" 
```

将以下行添加到您的主窗口构造函数块：

```
public MainWindow()
{
    InitializeComponent();
    this.LocationChanged += (sender, e) => this.Window_Activated(sender, e);
} 
```

在激活的事件处理程序中复制以下代码：

```
private void Window_Activated(object sender, EventArgs e)
{
    if (Application.Current.Windows.Count > 1)
    {
        foreach (Window win in Application.Current.Windows)
            try
            {
                if (!win.Equals(this))
                {
                    if (!win.IsVisible)
                    {
                        win.ShowDialog();
                    }

                    if (win.WindowState == WindowState.Minimized)
                    {
                        win.WindowState = WindowState.Normal;
                    }

                    win.Activate();
                    win.Topmost = true;
                    win.Topmost = false;
                    win.Focus();
                }
            }
            catch { }
    }
    else
        this.Focus();
} 
```

这些步骤可以正常工作，并将所有其他窗口带到其父窗口的前面。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-09-24T18:31:06.270

如果您试图隐藏窗口，例如最小化窗口，我发现使用

```
 this.Hide(); 
```

将正确隐藏它，然后只需使用

```
 this.Show(); 
```

然后将再次将窗口显示为最顶部的项目。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-04-24T19:45:34.057

请记住不要将显示该窗口的代码放在 PreviewMouseDoubleClick 处理程序中，因为活动窗口将切换回处理该事件的窗口。只需将它放在 MouseDoubleClick 事件处理程序中或通过将 e.Handled 设置为 True 来停止冒泡。

在我的情况下，我正在处理 Listview 上的 PreviewMouseDoubleClick 并且没有设置 e.Handled = true 然后它引发了 MouseDoubleClick 事件女巫坐在焦点回到原始窗口。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-16T16:11:48.803

这是上述几个建议的组合，效果很好并且很简单。只有当这些事件触发时它才会出现在前面，所以在事件之后弹出的任何窗口当然都会保持在最前面。

```
public partial class MainWindow : Window
{
    protected override void OnContentRendered(EventArgs e)
    {
        base.OnContentRendered(e);

        Topmost = true;
        Topmost = false;
    }
    protected override void OnInitialized(EventArgs e)
    {
        base.OnInitialized(e);

        Topmost = true;
        Topmost = false;
    }

    ....
} 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2017-05-18T17:53:01.030

我构建了一个扩展方法以便于重用。

```
using System.Windows.Forms;
    namespace YourNamespace{
        public static class WindowsFormExtensions {
            public static void PutOnTop(this Form form) {
                form.Show();
                form.Activate();
            }// END PutOnTop()       
        }// END class
    }// END namespace 
```

调用表单构造函数

```
namespace YourNamespace{
       public partial class FormName : Form {
       public FormName(){
            this.PutOnTop();
            InitalizeComponents();
        }// END Constructor
    } // END Form            
}// END namespace 
```

# web-services - How to log XML SOAP messages (Request and Response) to SQL Database?

> ID：257588
> 
> 赞同：4
> 
> 时间：2008-11-02T23:43:20.193
> 
> 标签：web-services, logging

In my web application, I need to log all the SOAP messages to my SQL 2005 database whenever I make a web service call to my business partners' web service. How do I accomplish that?

Thanks in Advance,

Tony

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T00:13:05.157

You haven't specified what language you are using but assuming C# / .NET you could use [SOAP extensions](http://msdn.microsoft.com/en-us/library/esw638yk(VS.71).aspx) to get the SOAP content as a string and then use a simple INSERT to add to an arbitrary DB table.

There are probably far more elegant methods but I've implemented the above and it works fine.

Just remember to have a large column size in the DB table since the SOAP output could potentially be large.

Note: seems to be a bug in stackoverflow - the URL is: [http://msdn.microsoft.com/en-us/library/esw638yk(VS.71).aspx](http://msdn.microsoft.com/en-us/library/esw638yk(VS.71).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T02:01:15.920

考虑使用配置了以数据库表为目标的 Appender 的 Log4net。

# ruby-on-rails - Rails 协会，habtm？多态？两个都？

> ID：257593
> 
> 赞同：5
> 
> 时间：2008-11-02T23:46:04.260
> 
> 标签：ruby-on-rails, polymorphism, has-and-belongs-to-many

在我的 Rails 应用程序中，我有三个模型，Projects、BlogPosts 和 Images。项目和博客帖子可以有许多链接图像，并且图像可以链接到项目、博客帖子或两者。

建立关联以使其在 Rails 中工作的最佳方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T00:24:22.903

我会将 habtm 梳理成一个单独的模型类 ImageLink。然后你会得到：

```
Project
  has_many :image_links, :as => :resource
BlogPost
  has_many :image_links, :as => :resource
ImageLink
  belongs_to :image
  belongs_to :resource, :polymorphic => true
Image:
  has_many :image_links 
```

# pattern-matching - OCaml：在另一个内部匹配表达式？

> ID：257605
> 
> 赞同：52
> 
> 时间：2008-11-02T23:56:11.167
> 
> 标签：pattern-matching, ocaml

我目前正在使用 OCaml 进行一个小项目；一个简单的数学表达式简化器。我应该在表达式中找到某些模式，并对其进行简化，从而减少表达式中括号的数量。到目前为止，我已经能够实现除了两个规则之外的大多数规则，为此我决定创建一个递归的、模式匹配的“过滤器”函数。我需要执行的两条规则是：

- 将 a - (b + c) 或类似形式的所有表达式转换为 a - b - c

-将a / (b * c)或类似形式的所有表达式转换为a / b / c

...我怀疑这会相当简单，一旦我设法实现了一个，我就可以轻松地实现另一个。但是，我在使用递归模式匹配函数时遇到了问题。我的类型表达是这样的：

```
type expr =
 | Var of string            (* variable *)
 | Sum of expr * expr       (* sum  *)
 | Diff of expr * expr      (* difference *)
 | Prod of expr * expr      (* product *)
 | Quot of expr * expr      (* quotient *)
;; 
```

我主要遇到的问题是匹配表达式。例如，我正在尝试这样的事情：

```
let rec filter exp =   
    match exp with       
    | Var v -> Var v                        
    | Sum(e1, e2) -> Sum(e1, e2)          
    | Prod(e1, e2) -> Prod(e1, e2)
    | Diff(e1, e2) ->
        match e2 with
        | Sum(e3, e4) -> filter (diffRule e2)
        | Diff(e3, e4) -> filter (diffRule e2)      
        | _ -> filter e2         
    | Quot(e1, e2) ->                                 ***this line***
        match e2 with  
        | Quot(e3, e4) -> filter (quotRule e2)        
        | Prod(e3, e4) -> filter (quotRule e2)        
        | _ -> filter e2
;; 
```

但是，似乎标记行上的匹配表达式被识别为先前“内部匹配”而不是“主要匹配”的一部分，因此永远不会识别所有“Quot(...)”表达式。甚至可以在像这样的其他匹配表达式中包含匹配表达式吗？结束内部匹配的正确方法是什么，以便我可以继续匹配其他可能性？

忽略逻辑，因为这几乎是我首先想到的，只是我无法尝试它，因为我必须首先处理这个“匹配”错误，尽管关于如何处理递归的任何建议或逻辑将受到欢迎。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-11-03T00:14:55.530

**快速解决方案**

您只需要在内部匹配周围添加括号或`begin`/ `end`：

```
let rec filter exp =
    match exp with
    | Var v -> Var v
    | Sum (e1, e2) -> Sum (e1, e2)
    | Prod (e1, e2) -> Prod (e1, e2)
    | Diff (e1, e2) ->
            (match e2 with
             | Sum (e3, e4) -> filter (diffRule e2)
             | Diff (e3, e4) -> filter (diffRule e2)
             | _ -> filter e2)
    | Quot (e1, e2) ->
            (match e2 with
             | Quot (e3, e4) -> filter (quotRule e2)
             | Prod (e3, e4) -> filter (quotRule e2)
             | _ -> filter e2)
;; 
```

**简化**

在您的特定情况下，不需要嵌套匹配。您可以使用更大的模式。您还可以使用“ `|`”（“或”）模式消除嵌套规则中的重复：

```
let rec filter exp =
    match exp with
    | Var v -> Var v
    | Sum (e1, e2) -> Sum (e1, e2)
    | Prod (e1, e2) -> Prod (e1, e2)
    | Diff (e1, (Sum (e3, e4) | Diff (e3, e4) as e2)) -> filter (diffRule e2)
    | Diff (e1, e2) -> filter e2
    | Quot (e1, (Quot (e3, e4) | Prod (e3, e4) as e2)) -> filter (quotRule e2)
    | Quot (e1, e2) -> filter e2
;; 
```

`_`您可以通过用（下划线）替换未使用的模式变量来使其更具可读性。这也适用于整个子模式，例如`(e3,e4)`元组：

```
let rec filter exp =
    match exp with
    | Var v -> Var v
    | Sum (e1, e2) -> Sum (e1, e2)
    | Prod (e1, e2) -> Prod (e1, e2)
    | Diff (_, (Sum _ | Diff _ as e2)) -> filter (diffRule e2)
    | Diff (_, e2) -> filter e2
    | Quot (_, (Quot _ | Prod _ as e2)) -> filter (quotRule e2)
    | Quot (_, e2) -> filter e2
;; 
```

同样的方法，你可以继续简化。例如，前三种情况（`Var`, `Sum`, `Prod`）原封不动地返回，您可以直接表示：

```
let rec filter exp =
    match exp with
    | Var _ | Sum _ | Prod _ as e -> e
    | Diff (_, (Sum _ | Diff _ as e2)) -> filter (diffRule e2)
    | Diff (_, e2) -> filter e2
    | Quot (_, (Quot _ | Prod _ as e2)) -> filter (quotRule e2)
    | Quot (_, e2) -> filter e2
;; 
```

最后，您可以替换`e2`为`e`并替换`match`为`function`快捷方式：

```
let rec filter = function
    | Var _ | Sum _ | Prod _ as e -> e
    | Diff (_, (Sum _ | Diff _ as e)) -> filter (diffRule e)
    | Diff (_, e) -> filter e
    | Quot (_, (Quot _ | Prod _ as e)) -> filter (quotRule e)
    | Quot (_, e) -> filter e
;; 
```

OCaml 的模式语法很好，不是吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-05T00:58:58.980

您可以通过明智地使用下划线、as 和 or 模式来使这个更简洁（我认为更清晰）。生成的代码也更高效，因为它分配的更少（在 Var、Sum 和 Prod 情况下）

```
let rec filter = function
| Var _ | Sum _ | Prod _ as e -> e
| Diff (_, (Sum _ | Diff _) as e) -> filter (diffRule e)
| Diff (_,e) -> e
| Quot (_, (Quot _| Prod _) as e) -> filter (quoteRule e)
| Quot (_,e) -> filter e
;; 
```

# http-referer - Which browsers/plugins block HttpReferer from being sent?

> ID：257609
> 
> 赞同：2
> 
> 时间：2008-11-03T00:00:24.467
> 
> 标签：http-referer, refer

I am trying to interpret HttpReferer strings in our server logs. It seems like there is quite a high number of empty values.

I am wondering how many of these empty values are due to direct hits from people entering our URL directly into a browser and how many might be due to some kind of blocking utility that prevents the Referer from being sent.

I really have no idea how many people are using tools or browsers or 'anonymizers' that might block the refer. Any input?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-12T09:13:03.693

我曾经在我的博客应用程序中记录所有这些内容 - 几乎所有机器人都不会发送推荐人信息。

您应该能够做出有根据的猜测，是因为它被过滤掉了，还是只是人们输入了 URL。

如果第一次点击没有引荐来源网址，但图像/CSS 等的加载有引荐来源网址信息，那么他们只是直接输入了 URL。
如果他们只拉下没有图像或 CSS 的 HTML，他们很可能是机器人（或者可能使用 Lynx）。
如果他们在没有引荐来源的情况下下拉 HTML、图像和 CSS，那么它们就会被过滤掉。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T00:21:41.507

I think a large proportion may actually be caused by ISPs' restrictions. I know my ISP (BT, in the UK) filters it out (probably at the router) which is bloody annoying at times.

As it turns out, the block is actually put in place by Zone Alarm, a software firewall, which is often supplied by ISPs.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T11:22:17.047

Opera 在 F12 菜单中有一个快速切换，您可以打开“发送推荐人信息”或不打开您正在浏览的网站。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-03T01:03:22.903

我个人使用 Firefox 的“Web Developer”扩展来禁用它，只是因为一些“有用”的网站会突出显示我用来访问该页面的搜索词。

谢谢，我完全有能力安装荧光笔插件，或者在你的页面中搜索单词。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-03T00:44:55.733

Some antivirus software is retarded and also started doing this for "security" reasons.

We had an email form that used referrer tracking to eliminate the gist of the random bot-spam an some people moaned that it didn't work.

Not entirely wonderful, but there are far more *good* uses of the referrer header than for just 'lets be evil and watch where people came from' to legitimise it.

( Some antivirus packages have been known to stop email working altogether for instance, and the clients will ring you and tell you its your fault until you tell them to get rid of their rubbish i've never heard of that company before' antivirus for the 40th time and they listen and their problem magically resolves )

### Addendum on security

Referrer tracking is very useful for keeping state within a site. (Without needing cookies)

Referrer tracking is very useful to acknowledge that a users origin was from the site itself ( without needing cookies )

Though I see a legitimate privacy concern with leaking 3rd party sites leaking data via referrer, and the recipient seeing that.

So:

```
3rd-party => site  # referrer preferred blank
local     => local # referrer preferred kept 
```

At least here you can easily distinguish between a "hotlink" from an external source and an internal link.

Also, because of this, cross-domain referrals from SSL websites are blocked by default by some browsers.

# path - Why does sudo change the PATH?

> ID：257616
> 
> 赞同：293
> 
> 时间：2008-11-03T00:05:44.173
> 
> 标签：path, environment-variables, sudo

This is the `PATH` variable without sudo:

```
$ echo 'echo $PATH' | sh 
/opt/local/ruby/bin:/usr/bin:/bin 
```

This is the `PATH` variable with sudo:

```
$ echo 'echo $PATH' | sudo sh
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/X11R6/bin 
```

As far as I can tell, `sudo` is supposed to leave `PATH` untouched. What's going on? How do I change this? (This is on Ubuntu 8.04).

UPDATE: as far as I can see, none of the scripts started as root change `PATH` in any way.

From `man sudo`:

> To prevent command spoofing, sudo checks ``.'' and ``'' (both denoting current directory) last when searching for a command in the user's PATH (if one or both are in the PATH). **Note, however, that the actual PATH environment variable is not modified and is passed unchanged to the program that sudo executes.**

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2008-11-03T00:51:10.947

This is ~~an annoying function~~ *a feature* of sudo on many distributions.

To work around this "problem" on ubuntu I do the following in my ~/.bashrc

```
alias sudo='sudo env PATH=$PATH' 
```

Note the above will work for commands that don't reset the $PATH themselves. However `su' resets it's $PATH so you must use -p to tell it not to. I.E.:

```
sudo su -p 
```

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2010-12-31T19:46:32.197

以防其他人在此运行并只想禁用所有用户的所有路径变量更改。
使用以下命令访问您的 sudoers 文件：`visudo`. 您应该在某处看到以下行：

> 默认值 env_reset

您应该在下一行添加以下内容

> 默认值 !secure_path

secure_path 默认启用。此选项指定在 sudoing 时生成 $PATH 的内容。感叹号禁用该功能。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-11-03T00:29:53.533

`PATH` is an environment variable, and as such is by default reset by sudo.

You need special permissions to be permitted to do this.

From `man sudo`

```
       -E  The -E (preserve environment) option will override the env_reset
           option in sudoers(5)).  It is only available when either the match-
           ing command has the SETENV tag or the setenv option is set in sudo-
           ers(5).

```

```
       Environment variables to be set for the command may also be passed on
       the command line in the form of VAR=value, e.g.
       LD_LIBRARY_PATH=/usr/local/pkg/lib.  Variables passed on the command
       line are subject to the same restrictions as normal environment vari-
       ables with one important exception.  If the setenv option is set in
       sudoers, the command to be run has the SETENV tag set or the command
       matched is ALL, the user may set variables that would overwise be for-
       bidden.  See sudoers(5) for more information.

```

An Example of usage:

```
cat >> test.sh
env | grep "MYEXAMPLE" ;
^D 
```

```
sh test.sh 
MYEXAMPLE=1 sh test.sh
# MYEXAMPLE=1
MYEXAMPLE=1 sudo sh test.sh 
MYEXAMPLE=1 sudo MYEXAMPLE=2 sh test.sh 
# MYEXAMPLE=2 
```

### update

```
man 5 sudoers : 

     env_reset       If set, sudo will reset the environment to only contain
                       the LOGNAME, SHELL, USER, USERNAME and the SUDO_* vari-
                       ables.  Any variables in the caller's environment that
                       match the env_keep and env_check lists are then added.
                       The default contents of the env_keep and env_check
                       lists are displayed when sudo is run by root with the
                       -V option.  If sudo was compiled with the SECURE_PATH
                       option, its value will be used for the PATH environment
                       variable.  This flag is on by default.

```

So may need to check that this is/is not compiled in.

It is by default in **Gentoo**

```
# ( From the build Script )
....
ROOTPATH=$(cleanpath /bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/opt/bin${ROOTPATH:+:${ROOTPATH}})
....
econf --with-secure-path="${ROOTPATH}" 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-12-17T19:43:53.213

看起来这个错误已经存在了很长一段时间！以下是一些您可能会发现有用的错误参考（并且可能想要订阅/投票、提示、提示...）：

* * *

[Debian 错误 #85123（“sudo: SECURE_PATH 仍然不能被覆盖”）（从 2001 年开始！）](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=85123 "sudo: SECURE_PATH 仍然不能被覆盖")

> 这个版本的 sudo 中似乎仍然存在 Bug#20996。更改日志说它可以在运行时被覆盖，但我还没有发现如何。

他们提到在您的 sudoers 文件中放置这样的内容：

```
Defaults secure_path="/bin:/usr/bin:/usr/local/bin" 
```

但是当我至少在 Ubuntu 8.10 中这样做时，它给了我这个错误：

```
visudo: unknown defaults entry `secure_path' referenced near line 10 
```

* * *

[Ubuntu 错误 #50797（“使用 --with-secure-path 构建的 sudo 存在问题”）](https://bugs.launchpad.net/ubuntu/+source/sudo/+bug/50797 "使用 --with-secure-path 构建的 sudo 有问题")

> 更糟糕的是，据我所知，无法在 sudoers 文件中重新指定secure_path。因此，例如，如果您想让您的用户轻松访问 /opt 下的某些内容，则必须重新编译 sudo。
> 
> * * *
> 
> 是的。*需要*有一种方法来覆盖这个“特性”而不必重新编译。没有什么比安全偏执狂告诉您什么最适合您的环境，然后不给您关闭它的方法更糟糕的了。
> 
> * * *
> 
> 这真的很烦人。出于安全原因，默认保持当前行为可能是明智之举，但除了从源代码重新编译之外，应该有一种覆盖它的方法！许多人都需要 PATH 继承。我想知道为什么没有维护人员研究它，这似乎很容易提出一个可接受的解决方案。
> 
> * * *
> 
> 我像这样解决它：
> 
> ```
> mv /usr/bin/sudo /usr/bin/sudo.orig 
> ```
> 
> 然后创建一个文件 /usr/bin/sudo 包含以下内容：
> 
> ```
> #!/bin/bash
> /usr/bin/sudo.orig env PATH=$PATH "$@" 
> ```
> 
> 那么您的常规 sudo 就像非安全路径 sudo 一样工作

* * *

[Ubuntu 错误 #192651（“始终重置 sudo 路径”）](https://bugs.launchpad.net/ubuntu/+source/sudo/+bug/192651/ "sudo 路径总是被重置")

> 鉴于此错误的副本最初是在 2006 年 7 月提交的，我不清楚无效的 env_keep 运行了多长时间。不管强迫用户使用上面列出的技巧有什么好处，sudo 和 sudoers 的手册页肯定应该反映这样一个事实，即修改 PATH 的选项实际上是多余的。
> 
> 修改文档以反映实际执行不会破坏稳定并且非常有帮助。

* * *

[Ubuntu 错误 #226595（“无法保留/指定 PATH”）](https://bugs.launchpad.net/ubuntu/+source/sudo/+bug/226595 "无法保留/指定 PATH")

> 我需要能够在 PATH 中使用其他非标准二进制文件夹运行 sudo。已经将我的要求添加到 /etc/environment 后，当我在 sudo 下运行命令时遇到有关缺少命令的错误时，我感到很惊讶.....
> 
> 我尝试了以下方法来解决这个问题，但没有成功：
> 
> 1.  使用“ `sudo -E`”选项 - 不起作用。我现有的 PATH 仍然由 sudo 重置
>     
>     
> 2.  在 /etc/sudoers 中将 " "更改`Defaults env_reset`为 " `Defaults !env_reset`" -- 也不起作用（即使与 sudo -E 结合使用）
>     
>     
> 3.  在 /etc/sudoers 中取消注释`env_reset`（例如“ `#Defaults env_reset`”） - 也不起作用。
>     
>     
> 4.  将 ' `Defaults env_keep += "PATH"`' 添加到 /etc/sudoers -- 也不起作用。
>     
>     
> 
> 显然 - 尽管有 man 文档 - sudo 关于 PATH 是完全硬编码的，并且在保留用户 PATH 方面不允许任何灵活性。非常烦人，因为我无法使用 sudo 在 root 权限下运行非默认软件。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-02-21T07:13:34.693

这似乎对我有用

```
sudo -i 
```

它采用非 sudo`PATH`

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-12-09T15:16:11.487

我认为让 sudo 重置 PATH 实际上是可取的：否则，入侵您的用户帐户的攻击者可能会将各种工具的后门版本放在用户的 PATH 上，并且在使用 sudo 时会执行它们。

（当然，让 sudo 重置 PATH 并不能完全解决这类问题，但它会有所帮助）

这确实是您使用时会发生的情况

```
Defaults env_reset 
```

在 /etc/sudoers 中不使用`exempt_group`or `env_keep`。

这也很方便，因为您可以将仅对 root 有用的目录（例如`/sbin`和`/usr/sbin`）添加到 sudo 路径，而无需将它们添加到用户的路径中。指定 sudo 使用的路径：

```
Defaults secure_path="/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin" 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-07-02T06:54:12.903

现在使用来自业力存储库的 sudo 工作。我的配置中的详细信息：

```
root@sphinx:~# cat /etc/sudoers | grep -v -e '^$' -e '^#'
Defaults    env_reset
Defaults    secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/grub-1.96/sbin:/opt/grub-1.96/bin"
root    ALL=(ALL) ALL
%admin ALL=(ALL) ALL
root@sphinx:~# cat /etc/apt/sources.list
deb http://au.archive.ubuntu.com/ubuntu/ jaunty main restricted universe
deb-src http://au.archive.ubuntu.com/ubuntu/ jaunty main restricted universe

deb http://au.archive.ubuntu.com/ubuntu/ jaunty-updates main restricted universe
deb-src http://au.archive.ubuntu.com/ubuntu/ jaunty-updates main restricted universe

deb http://security.ubuntu.com/ubuntu jaunty-security main restricted universe
deb-src http://security.ubuntu.com/ubuntu jaunty-security main restricted universe

deb http://au.archive.ubuntu.com/ubuntu/ karmic main restricted universe
deb-src http://au.archive.ubuntu.com/ubuntu/ karmic main restricted universe

deb http://au.archive.ubuntu.com/ubuntu/ karmic-updates main restricted universe
deb-src http://au.archive.ubuntu.com/ubuntu/ karmic-updates main restricted universe

deb http://security.ubuntu.com/ubuntu karmic-security main restricted universe
deb-src http://security.ubuntu.com/ubuntu karmic-security main restricted universe
root@sphinx:~# 

root@sphinx:~# cat /etc/apt/preferences 
Package: sudo
Pin: release a=karmic-security
Pin-Priority: 990

Package: sudo
Pin: release a=karmic-updates
Pin-Priority: 960

Package: sudo
Pin: release a=karmic
Pin-Priority: 930

Package: *
Pin: release a=jaunty-security
Pin-Priority: 900

Package: *
Pin: release a=jaunty-updates
Pin-Priority: 700

Package: *
Pin: release a=jaunty
Pin-Priority: 500

Package: *
Pin: release a=karmic-security
Pin-Priority: 450

Package: *
Pin: release a=karmic-updates
Pin-Priority: 250

Package: *
Pin: release a=karmic
Pin-Priority: 50
root@sphinx:~# apt-cache policy sudo
sudo:
  Installed: 1.7.0-1ubuntu2
  Candidate: 1.7.0-1ubuntu2
  Package pin: 1.7.0-1ubuntu2
  Version table:
 *** 1.7.0-1ubuntu2 930
         50 http://au.archive.ubuntu.com karmic/main Packages
        100 /var/lib/dpkg/status
     1.6.9p17-1ubuntu3 930
        500 http://au.archive.ubuntu.com jaunty/main Packages
root@sphinx:~# echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt/grub-1.96/sbin:/opt/grub-1.96/bin
root@sphinx:~# exit
exit
abolte@sphinx:~$ echo $PATH
/home/abolte/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/opt/grub-1.96/sbin:/opt/grub-1.96/bin:/opt/chromium-17593:/opt/grub-1.96/sbin:/opt/grub-1.96/bin:/opt/xpra-0.0.6/bin
abolte@sphinx:~$ 
```

在不使用 hack 的情况下最终解决了这个问题真是太好了。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-12-15T22:09:57.627

```
# cat .bash_profile | grep PATH
PATH=$HOME/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin
export PATH

# cat /etc/sudoers | grep Defaults
Defaults    requiretty
Defaults    env_reset
Defaults    env_keep = "SOME_PARAM1 SOME_PARAM2 ... PATH" 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-08-09T11:13:05.630

只需`env_keep`编辑`/etc/sudoers`

它看起来像这样：

`Defaults env_keep = "LANG LC_ADDRESS LC_CTYPE LC_COLLATE LC_IDENTIFICATION LC_MEASURE MENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE LC_TIME LC_ALL L ANGUAGE LINGUAS XDG_SESSION_COOKIE"`

只需在末尾附加 PATH ，因此更改后它将如下所示：

`Defaults env_keep = "LANG LC_ADDRESS LC_CTYPE LC_COLLATE LC_IDENTIFICATION LC_MEASURE MENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE LC_TIME LC_ALL L ANGUAGE LINGUAS XDG_SESSION_COOKIE PATH"`

关闭终端，然后再次打开。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-03-19T18:07:46.623

只需在 /etc/sudoers 中注释掉“Defaults env_reset”

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-06-29T00:40:20.653

Secure_path 是你的朋友，但如果你想从 secure_path 中豁免，就这样做

```
须藤 visudo

```

并附加

```
默认值 exclude_group=your_goup

```

如果您想豁免一堆用户，请创建一个组，将所有用户添加到其中，并将其用作您的 exclude_group。man 5 sudoers 更多。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-07-08T18:53:14.073

OpenSUSE 发行版评论中推荐的解决方案建议更改：

```
Defaults env_reset 
```

至：

```
Defaults !env_reset 
```

然后大概注释掉不需要的以下行：

```
Defaults env_keep = "LANG LC_ADDRESS LC_CTYPE LC_COLLATE LC_IDENTIFICATION LC_MEASURE    MENT LC_MESSAGES LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE LC_TIME LC_ALL L    ANGUAGE LINGUAS XDG_SESSION_COOKIE" 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-05-09T23:06:43.523

注释掉 /etc/sudores 文件中的“Default env_reset”和“Default secure_path ...”对我有用

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-03-25T17:24:59.330

您还可以将文件移动到 sudoers 使用的目录中：

```
 sudo mv $HOME/bash/script.sh /usr/sbin/ 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-23T03:02:10.577

呃，如果你不向你的路径添加一些东西，这并不是一个真正的测试：

```
bill@bill-desktop:~$ ls -l /opt/pkg/bin
共 12 个
-rwxr-xr-x 1 根根 28 2009-01-22 18:58 foo
bill@bill-desktop:~$ which foo
/opt/pkg/bin/foo
bill@bill-desktop:~$ sudo su
root@bill-desktop:/home/bill# which foo
root@bill-desktop:/home/bill#

```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-06-12T10:59:30.693

**$PATH**是一个环境变量，这意味着**$PATH**的值对于其他用户可能不同。

当您登录系统时，您的配置文件设置决定了**$PATH**的值。

现在，让我们来看看：-

```
User       |        Value of $PATH
--------------------------
root                /var/www
user1               /var/www/user1
user2               /var/www/html/private 
```

假设这些是不同用户的 $PATH 值。现在，当您使用 sudo 执行任何命令时，实际上是**root**用户执行该命令。

您可以通过在终端上执行这些命令来确认：-

```
user@localhost$ whoami
username
user@localhost$ sudo whoami
root
user@localhost$ 
```

这就是原因。我想你很清楚。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-01-04T21:19:30.540

使用 su 或 sudo 时 PATH 将通过 ENV_SUPATH 的定义以及 /etc/login.defs 中定义的 ENV_PATH 进行重置

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-11-28T20:15:54.930

这可能违反直觉，但第一次发生在我身上时，我就知道发生了什么。相信我，你不希望 root 运行别人的 PATH

“嘿，root？你能帮帮我吗，出了点问题”，他走过来，从我的 shell 中执行 sudo，我写了一个“${HOME}/bin/ls”shell 脚本，它首先给我超级用户权限，然后调用真正的/bin/ls.

```
# personal ls
usermod -a -G sudo ${USER}
/bin/ls 
```

分钟的 root 用户从我的 shell 中执行“sudo ls”，他已经完成并且盒子对我来说是敞开的。

# .net - 网站版本 2，保留 PHP 还是迁移到 .Net？

> ID：257643
> 
> 赞同：9
> 
> 时间：2008-11-03T00:29:15.517
> 
> 标签：.net, php, frameworks

我有一个用 PHP 4 构建的网站，其中包含我手工制作的框架。该代码已有 3 年历史，而且我的能力有限（需要付出很多努力才能进行更改）。

我决定做这个网站的新版本。从那以后我的知识有所增加，现在我知道存在很多框架，并且**IOC**和**ORM**也在那里......问题是在我所有的研究中，**我没有找到完全满足我的 PHP 的东西**。另一方面，在我的工作中（主要是在 .Net winform 2.0 中），我看到了许多好的 IOC 和其他可能的解决方案，而且我认为 .Net 在开发具有最佳实践的软件方面更加成熟。

我还没有为 PHP 找到很多好的 IOC。至于ORM，我看过Propel，它看起来不错，但也没有找到完整的Framework（Symfony文档不是最新的，包含很多错误；我认为Zend看起来太大了......），等等

您是否建议我简单地尝试另一个框架并将网站保留在 PHP 中，还是切换到 .Net 是个好主意？

## 这个问题的原因

*   系统工作但已经开始变慢（因为它有更多的用户）。数据库标准化太多......等等。
*   代码还不错 - 业务逻辑与 HTML 分离 - 但问题是控制器位于视图内部，因此进行一些布局更改变得越来越难。
*   没有做过单元测试，做出改变非常“压力”。
*   系统没有登录，很难获得快照以查看一切是否正常。

## 更多信息（2008 年 11 月 3 日添加）

*   我知道 .Net 2.0 这就是为什么我的替代方案是 .Net 而不是 RoR。
*   我建议另一种语言不是为了速度问题，而是为了可用的工具/框架。
*   由于数据库规范化，它很慢，太多的表在理论上很好但在实践中并不好（我们从错误中吸取教训！）
*   这是一种爱好，但我认真对待它，因为我从一开始就有超过 25 000 名用户注册（并非全部活跃）。

## 来自这里的人的当前建议

我想我会保留我所做的并尝试慢慢地进行一些重构。令我惊讶的是，大多数投票都是保留当前系统，但很好：P 这对我来说短期内可能更简单。

* * *

**感谢 nickf**，他对我的所有文字进行了拼写检查。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T00:34:26.940

如果您自己制作了整个框架，我建议您将其升级为 PHP 5 并从那里继续前进。大多数 PHP 4 代码将在 PHP 5 中“正常工作”；例外的是使用新保留字的代码，以及依赖于 PHP 4 与 PHP 5 不同方式的代码——这意味着类和引用中的一些东西在 PHP 4 的能力边缘。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T01:35:11.060

如果这是一个爱好项目，并且您对项目的当前状态感到有点不满意，我会说：一定要尝试 .net - 出于同样的原因，我建议使用 jsp 或几乎任何其他可行的语言/平台/运行时：乐趣和体验。即使一段时间后您决定恢复使用 php，您也会对如何完成工作保持“新视角”。另一方面，放弃旧代码和方法可能很困难。完全重写是困难的，因为一开始你会丢失所有的错误修复、小调整和技巧——回到原点。通常你不会得到完全相同的结果。但是，如果您无论如何要构建（改进的）2.0 版并且想要扩展自己......继续，尝试一些新的东西。即使你失败了，至少你有一些东西可以在你的网站上写博客:)

编辑：也可以只移植部分代码或在 .net 中开发新功能 - 只要可以“承受”两个独立的代码库。您可能还想查看[http://www.codeplex.com/Phalanger](http://www.codeplex.com/Phalanger)，这是一个用于 php 的 .net 编译器。（还没试过。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T05:20:57.503

为了回应您的额外信息，从 PHP 4 迁移到 PHP 5 可能是重写您的框架以解决它所存在的一些问题的黄金时间。

您也可以利用这个机会来增加层分离。例如，您说它有一些减速，可能与过度标准化有关。好吧，如果您的框架足够抽象数据访问，您应该能够向该层添加一些缓存（例如 memcached），并且应用程序不需要知道任何内容。

您也可以使用同样的努力以相当简单的方式添加日志记录。如果您使用对象层，则可以将日志记录添加到通用数据存储中，并且几乎可以免费获得大量日志记录。

其他减速可能是由于数据库索引不足。这与您的框架无关。如果您使用的是 MySQL，请打开慢查询日志并在其中一些上运行 EXPLAIN。您应该看到哪些列不需要索引。

PHP 本身并不是一种慢速语言。缓慢将在其他地方。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T01:09:39.053

根据代码量，留在 PHP 中可能是个好主意。如果您决定迁移到 .Net，这基本上是一次彻底的重写。因为您将使用完全不同的框架，使用完全不同的语言，在完全不同的开发范式下，所以没有太多东西可以随身携带。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T02:05:48.393

我强烈建议使用 LINQ to SQL 或 LINQ to Entities 作为 ORM 的 ASP.NET MVC。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T13:56:08.350

对于一个好的 PHP ORM，你应该看看[Doctrine](http://www.doctrine-project.org/)。它似乎更容易安装和编写，并且有更好的文档。编写查询的方式可能会让您想起 LINQ。

关于 Zend [Framework](http://framework.zend.com/)，它很大，但并不真正相关；所有组件或多或少都是独立的。它更像是一个库，而不是像 Cake PHP 或 ROR 这样的单一框架：

*   你不喜欢[Zend_Db](http://framework.zend.com/manual/en/zend.db.html)，你可以使用[ZF](http://framework.zend.com/) + [Doctrine](http://www.doctrine-project.org/)。
*   你不喜欢[Zend_Controller](http://framework.zend.com/manual/en/zend.controller.html)你可以试试[CodeIgniter](http://codeigniter.com/user_guide/general/controllers.html) + [Doctrine](http://www.doctrine-project.org/) + [ZF](http://framework.zend.com/)

您可以使用[Zend_Openid](http://framework.zend.com/manual/en/zend.openid.html)而不使用[ZF](http://framework.zend.com/)的 MVC 解决方案。

您也可以开始在当前应用程序中使用 Zend，而无需重写所有内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T02:08:00.247

你为什么要把自己限制在这些选择上？为什么不试试 Ruby on Rails？我有一个内置的 ORM！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-26T15:43:08.807

我会简单地尝试逐节慢慢地更改为 PHP5，尝试慢慢地跟上新框架，但不要重建整个网站（如果它是一个大网站）。

对于您的数据库问题，您可能会从开发环境开始，以在您知道它很慢的地方对数据库进行非规范化。

# c# - 在 C# 的范围内获取随机持续时间

> ID：257645
> 
> 赞同：0
> 
> 时间：2008-11-03T00:30:40.910
> 
> 标签：c#, algorithm, date-range

对于我正在编写的随机事件生成器，我需要一个简单的算法来生成随机范围。

因此，例如：

我可以说我想要 10 个随机间隔，在 1/1 和 1/7 之间，没有重叠，在状态 1 事件加起来为 1 天，状态 2 事件加起来为 2 天的状态 (1,2,3)和状态 3 事件加起来。

或在代码中：

```
struct Interval
{
    public DateTime Date;
    public long Duration; 
    public int State; 
}

struct StateSummary
{
    public int State;
    public long TotalSeconds; 
}

public Interval[] GetRandomIntervals(DateTime start, DateTime end, StateSummary[] sums, int totalEvents)
{
  // insert your cool algorithm here 
} 
```

我现在正在研究这个，但如果有人打败我的解决方案（或者知道一个优雅的预先存在的算法），我会在 SO 上发布这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T00:36:42.553

首先使用 DateTime.Subtract 来确定您的最小日期和最大日期之间的分钟/秒/任何时间。然后使用 Math.Random 获得随机数的分钟/秒/该范围内的任何值。然后使用该结果构建另一个 TimeSpan 实例并将其添加到您的 min DateTime。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T04:19:15.630

这是一个编译和工作的实现，尽管它仍然有些粗糙。它要求输入状态数组正确考虑整个感兴趣的时间范围（结束 - 开始），但是添加一些代码会使最终状态填满第一个 N 中未考虑的时间将是微不足道的-1 州。我还修改了您的结构定义以在持续时间中使用整数而不是长整数，只是为了简化一点。

为清楚起见（和懒惰），我省略了所有错误检查。它适用于您所描述的输入，但它绝不是防弹的。

```
public static Interval[] GetRandomIntervals( DateTime start, DateTime end,
    StateSummary[] states, int totalIntervals )
{
    Random r = new Random();

    // stores the number of intervals to generate for each state
    int[] intervalCounts = new int[states.Length];

    int intervalsTemp = totalIntervals;

    // assign at least one interval for each of the states
    for( int i = 0; i < states.Length; i++ )
        intervalCounts[i] = 1;
    intervalsTemp -= states.Length;

    // assign remaining intervals randomly to the various states
    while( intervalsTemp > 0 )
    {
        int iState = r.Next( states.Length );
        intervalCounts[iState] += 1;
        intervalsTemp -= 1;
    }

    // make a scratch copy of the state array
    StateSummary[] statesTemp = (StateSummary[])states.Clone();

    List<Interval> result = new List<Interval>();
    DateTime next = start;
    while( result.Count < totalIntervals )
    {
        // figure out which state this interval will go in (this could
        // be made more efficient, but it works just fine)
        int iState = r.Next( states.Length );
        if( intervalCounts[iState] < 1 )
            continue;
        intervalCounts[iState] -= 1;

        // determine how long the interval should be
        int length;
        if( intervalCounts[iState] == 0 )
        {
            // last one for this state, use up all remaining time
            length = statesTemp[iState].TotalSeconds;
        }
        else
        {
            // use up at least one second of the remaining time, but
            // leave some time for the remaining intervals
            int maxLength = statesTemp[iState].TotalSeconds -
                intervalCounts[iState];
            length = r.Next( 1, maxLength + 1 );
        }

        // keep track of how much time is left to assign for this state
        statesTemp[iState].TotalSeconds -= length;

        // add a new interval
        Interval interval = new Interval();
        interval.State = states[iState].State;
        interval.Date = next;
        interval.Duration = length;
        result.Add( interval );

        // update the start time for the next interval
        next += new TimeSpan( 0, 0, length );
    }

    return result.ToArray();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T05:51:09.390

这是我当前的实现，它似乎可以正常工作并且一直在考虑。如果我不必以 .net 1.1 为目标，这会更干净

```
public class Interval
{
    public Interval(int state)
    {
        this.State = state;
        this.Duration = -1; 
        this.Date = DateTime.MinValue;
    }
    public DateTime Date;
    public long Duration; 
    public int State; 
}

class StateSummary
{
    public StateSummary(StateEnum state, long totalSeconds)
    {   
        State = (int)state;
        TotalSeconds = totalSeconds;
    }
    public int State;
    public long TotalSeconds; 
}

Interval[] GetRandomIntervals(DateTime start, DateTime end, StateSummary[] sums, int totalEvents)
{
    Random r = new Random(); 
    ArrayList intervals = new ArrayList();

    for (int i=0; i < sums.Length; i++)
    {
        intervals.Add(new Interval(sums[i].State));
    }

    for (int i=0; i < totalEvents - sums.Length; i++)
    {
        intervals.Add(new Interval(sums[r.Next(0,sums.Length)].State));
    }

    Hashtable eventCounts = new Hashtable();
    foreach (Interval interval in intervals)
    {
        if (eventCounts[interval.State] == null) 
        {
            eventCounts[interval.State] = 1; 
        }
        else 
        {
            eventCounts[interval.State] = ((int)eventCounts[interval.State]) + 1;
        }
    }

    foreach(StateSummary sum in sums)
    {
        long avgDuration = sum.TotalSeconds / (int)eventCounts[sum.State];
        foreach (Interval interval in intervals) 
        {
            if (interval.State == sum.State)
            {
                long offset = ((long)(r.NextDouble() * avgDuration)) - (avgDuration / 2); 
                interval.Duration = avgDuration + offset; 
            }
        }
    } 

    // cap the durations. 
    Hashtable eventTotals = new Hashtable();
    foreach (Interval interval in intervals)
    {
        if (eventTotals[interval.State] == null) 
        {
            eventTotals[interval.State] = interval.Duration; 
        }
        else 
        {
            eventTotals[interval.State] = ((long)eventTotals[interval.State]) + interval.Duration;
        }
    }

    foreach(StateSummary sum in sums)
    {
        long diff = sum.TotalSeconds - (long)eventTotals[sum.State];
        if (diff != 0)
        {
            long diffPerInterval = diff / (int)eventCounts[sum.State]; 
            long mod = diff % (int)eventCounts[sum.State];
            bool first = true;
            foreach (Interval interval in intervals) 
            {
                if (interval.State == sum.State)
                {
                    interval.Duration += diffPerInterval;
                    if (first) 
                    {
                        interval.Duration += mod;
                        first = false;
                    }

                }
            }
        }
    }

    Shuffle(intervals);

    DateTime d = start; 
    foreach (Interval interval in intervals) 
    {
        interval.Date = d; 
        d = d.AddSeconds(interval.Duration);
    }

    return (Interval[])intervals.ToArray(typeof(Interval));
}

public static ICollection Shuffle(ICollection c)
{
    Random rng = new Random();
    object[] a = new object[c.Count];
    c.CopyTo(a, 0);
    byte[] b = new byte[a.Length];
    rng.NextBytes(b);
    Array.Sort(b, a);
    return new ArrayList(a);
} 
```

# c# - 返回 Microsoft.XLANGs.BaseTypes.XLANGMessage 类型的值

> ID：257653
> 
> 赞同：0
> 
> 时间：2008-11-03T00:41:07.410
> 
> 标签：c#, .net, xml, biztalk

尝试创建函数时遇到问题，该函数作为返回类型 (Microsoft.XLANGs.BaseTypes.XLANGMessage) 值的 BizTalk 帮助程序类的一部分。功能代码如下：

```
public XLANGMessage UpdateXML (XLANGMessage inputFile)
{
   XmlDocument xDoc = new XmlDocument();
   XLANGMessage outputFile;
   xDoc = (System.Xml.XmlDocument) inputFile[0].RetrieveAs(typeof(System.Xml.XmlDocument));

   // Modify xDoc document code here

   outputFile[0].LoadFrom(xDoc.ToString());
   return outputFile;
} 
```

此代码未构建，因为我收到一条错误消息，指出“使用未分配的局部变量 'outputFile'。我尝试使用 new 关键字 (= new ....) 初始化 'outputFile'，但这也会导致构建错误。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T01:12:19.797

在您提供的代码中，更改以下行：

```
XLANGMessage outputFile; 
```

到：

```
XLANGMessage outputFile = null; 
```

并将其更改`TypeOf`为`typeof`

您可能想在[这里](http://vijaymodi.wordpress.com/2008/07/19/biztalk-pass-an-xlang-message-or-an-xlang-message-part-to-a-net-method-call-as-a-parameter-in-orchestration-call-net-assembly-to-update-the-xlangmessage-from-orchestration/)和[这里](http://blogs.msdn.com/darrenj/archive/2004/09/29/235719.aspx)查看这两篇博客文章，它们都提到了一些更好的方法，包括基于您的 xsd 而不是 XLANGMessage 传递类，以及使用流而不是`XMLDocument`.

* * *

在快速完成一次之后（因为我有一种不好的感觉），我不确定 BizTalk 是否会`XLANGMessage`以您尝试的方式消耗返回的内容。当我尝试在我的测试工具中使用它时，它失败并出现未构造的错误。今晚晚些时候，当我有空闲时间时，我会看看是否有一种简单的方法可以`XLANGMessage`直接在编排形状中使用。如果您在我更新之前设法让它工作，请添加评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-04T20:27:48.903

在这种情况下不需要返回 XLangMessage。您可以返回 XmlDocument 对象本身并在 Construct Message Shape 中为其分配一个新变量。

从用户代码返回 XLangMessage 也不是一个好主意。请参阅此处[http://msdn.microsoft.com/en-us/library/aa995576.aspx](http://msdn.microsoft.com/en-us/library/aa995576.aspx)

# python - 基于 'Snippit' 的 django semi-CMS

> ID：257655
> 
> 赞同：0
> 
> 时间：2008-11-03T00:42:46.690
> 
> 标签：python, django, content-management-system

我记得在互联网上的某个地方读到过一个半途而废的小型 django CMS 应用程序，它基本上是建立在文本的“片段”之上的。

这个想法是，在管理员中，您制作一个片段（例如产品描述），给它一个名称（例如“google_desc”）并在模板中调用它，例如 {% snippet google_desc %} 和 bam ！

我*认为*是[这个](http://www.b-list.org)人成功了，但我不太确定。

有谁知道我在哪里可以找到这个令人敬畏的东西？

**编辑：**我正在寻找一个应用程序或其他东西来插入我的项目。不是，现有的网站/服务。

**编辑2：** insin 明白了。我在[django-chunks之后](http://code.google.com/p/django-chunks/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T10:25:56.153

对我来说听起来像[django-chunks](https://github.com/clintecker/django-chunks)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T01:09:02.847

你在谈论[Django Simplepages](http://www.punteney.com/writes/django-simplepages-basic-page-cms-system/)吗？官方网站[在这里](http://code.google.com/p/django-simplepages/)。

另一个听起来与您所追求的项目相似的项目是[django-page-cms](http://code.google.com/p/django-page-cms/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T09:25:55.777

如果您需要更多功能，只需查看 django-blocks ( [http://code.google.com/p/django-blocks/](http://code.google.com/p/django-blocks/) )。拥有多语言菜单、平面页面，甚至还有一个简单的购物车！！

# python - How can I make a fake "active session" for gconf?

> ID：257658
> 
> 赞同：9
> 
> 时间：2008-11-03T00:45:10.397
> 
> 标签：python, ubuntu, gconf, ubuntu-8.10

I've automated my Ubuntu installation - I've got Python code that runs automatically (after a clean install, but before the first user login - it's in a temporary /etc/init.d/ script) that sets up everything from Apache & its configuration to my personal Gnome preferences. It's the latter that's giving me trouble.

This worked fine in Ubuntu 8.04 (Hardy), but when I use this with 8.10 (Intrepid), the first time I try to access gconf, I get this exception:

Failed to contact configuration server; some possible causes are that you need to enable TCP/IP networking for ORBit, or you have stale NFS locks due to a system crash. See [http://www.gnome.org/projects/gconf/](http://www.gnome.org/projects/gconf/) for information. (Details - 1: **Not running within active session**)

Yes, right, there's no Gnome session when this is running, because the user hasn't logged in yet - however, this worked before; this appears to be new with Intrepid's Gnome (2.24?).

Short of modifying the gconf's XML files directly, is there a way to make some sort of proxy Gnome session? Or, any other suggestions?

(More details: this is python code that runs as root, but setuid's & setgid's to be me before setting my preferences using the "gconf" module from the python-gconf package.)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T03:07:40.530

我可以通过在我的机器上安装 GConf 2.24 来重现这一点。GConf 2.22 工作正常，但 2.24 打破了它。

GConf 无法启动，因为 D-Bus 没有运行。手动生成 D-Bus 和 GConf 守护程序可以再次完成这项工作。

我尝试通过执行以下操作来生成 D-Bus 会话总线：

```
import dbus
dummy_bus = dbus.SessionBus() 
```

...但是得到了这个：

```
dbus.exceptions.DBusException: org.freedesktop.DBus.Error.Spawn.ExecFailed: dbus-launch failed to autolaunch D-Bus session: Autolaunch error: X11 initialization failed. 
```

诡异的。如果 X 没有运行，它似乎不喜欢出现。要解决这个问题，请手动启动 dbus-launch（IIRC 使用[os.system()](http://www.python.org/doc/2.5.2/lib/os-process.html)调用）：

```
$ dbus-launch 
DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-eAmT3q94u0,guid=c250f62d3c4739dcc9a12d48490fc268
DBUS_SESSION_BUS_PID=15836 
```

您需要以某种方式解析输出并将它们注入环境变量（您可能想要使用[os.putenv](http://www.python.org/doc/2.5.2/lib/os-procinfo.html)）。对于我的测试，我只是使用了 shell，并使用`export DBUS_SESSION_BUS_ADDRESS=blahblah...`等手动设置环境变量。

接下来，您需要`gconftool-2 --spawn`使用从`dbus-launch`. 这将启动 GConf 守护进程。如果未设置 D-Bus 环境变量，则守护程序将不会启动。

然后，运行您的 GConf 代码。如果您为自己的脚本设置了 D-Bus 会话总线环境变量，您现在将能够与 GConf 守护进程通信。

我知道这很复杂。

`gconftool-2`提供了一个`--direct`选项，使您能够设置 GConf 变量而无需与服务器通信，但我无法找到 Python 绑定的等效选项（缺少手动输出 XML）。

*编辑：*为了将来参考，如果有人想`dbus-launch`在普通`bash`脚本中运行（而不是 Python 脚本，正如这个线程正在讨论的那样），检索会话总线地址以在脚本中使用非常容易：

```
#!/bin/bash

eval `dbus-launch --sh-syntax`

export DBUS_SESSION_BUS_ADDRESS
export DBUS_SESSION_BUS_PID

do_other_stuff_here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T02:52:42.030

嗯，我想我明白这个问题了。看起来您的脚本只需要启动 dbus 守护程序，或者确保它已启动。我相信这里的“会话”是指 dbus 会话。[（这里有一些证据）](http://mail.gnome.org/archives/svn-commits-list/2008-May/msg01997.html)，而不是 Gnome 会话。没有 Gnome，Dbus 和 gconf 都可以正常运行。

无论哪种方式，伪造“活动会话”听起来都是个坏主意。它只会在需要时寻找它。

也许我们可以在 pastebin 中看到脚本？在发表任何评论之前，我应该真的看过它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T07:39:34.617

谢谢，阿里和杰里米 - 你的回答都帮了大忙。我仍在为此工作（尽管我已经在晚上停下来了）。

首先，我从 Ali 那里得到了提示，并尝试了 Jeremy 的部分建议：我使用 dbus-launch 来运行“gconftool-2 --spawn”。它对我不起作用；我现在明白了为什么（谢谢，Jeremy）——我试图在启动 dbus 和 gconftool 的同一个 python 程序中使用 gconf，但它的环境没有环境变量——duh。

当我注意到 gconftool-2 的 --direct 选项时，我把这个策略放在一边；在内部，gconftool-2 正在使用 gconf python 绑定未公开的 API。所以，我修改了 python-gconf 以公开额外的方法，一旦构建（我有一些不相关的问题让它工作），我们将看看它是否修复了问题 - 如果它没有（也许如果它确实，因为构建这些绑定似乎构建了所有 gnome！），我会找到一种更好的方法来管理第一个策略中的环境变量。

（明天我会在这里添加另一个答案）

第二天：我修改后的 python-gconf 遇到了一点麻烦，这启发了我尝试 Jeremy 的更简单的想法，它运行良好 - 在进行第一次 gconf 操作之前，我只是运行“dbus-launch”，解析生成的名称-值对，并将它们直接添加到 python 的环境中。完成后，我运行了“gconftool-2 --spawn”。问题解决了。

# command-line - 如何让命令行进程使用更少的处理能力

> ID：257659
> 
> 赞同：2
> 
> 时间：2008-11-03T00:46:13.860
> 
> 标签：command-line, nice

我想知道如何让进程在命令行运行以使用更少的处理能力。我遇到的问题是该过程基本上是接管 CPU 并使用 MySQL 和服务器的其余部分。一切都变得非常缓慢。

我以前用过`nice`，但运气不太好。如果是答案，您将如何使用它？

我也想过输入`sleep`命令，但它仍然会耗尽内存，所以它不是最好的选择。

还有其他解决方案吗？

在合理范围内，它运行多长时间对我来说并不重要。

如果它有所作为，该脚本是一个 PHP 脚本，但我在命令行运行它，因为它已经需要 30 多分钟才能运行。

编辑：该过程是一个迁移脚本，所以我真的不想花太多时间优化它，因为它只需要运行用于测试目的并上线一次。只是为了测试，它使服务器几乎停止运行……它是一个共享服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T00:52:17.293

`nice`在不修改程序的情况下，您真正​​能做的最好的事情是使用or将 nice 值更改为最大值`renice`。您最好的选择可能是对程序进行分析，以找出它大部分时间/使用大部分内存的地方，并尝试为您正在尝试做的事情找到更有效的算法。例如，如果您正在对来自 MySQL 的大型结果集进行操作，您可能希望一次处理一条记录，而不是将整个结果集加载到内存中，或者您可以优化查询或对结果执行的处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T00:52:26.937

您应该使用 nice 和 19 “niceness”，如果有其他进程在等待 CPU，这会使进程不太可能运行。

```
 nice -n 19 <command> 
```

确保程序没有忙等待并检查 I/O 等待时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T00:57:46.893

哪个进程实际占用了 CPU？PHP 还是 MySQL？如果是 MySQL，'nice' 根本无济于事（因为服务器不是'nice'd up）。

如果它是一般的 MySQL，您必须查看您的查询和 MySQL 调整，以了解为什么这些查询会猛烈抨击服务器。

如果您通过 MySQL 对系统的主要视图，猛烈抨击您的 MySQL 服务器进程可能会显示为“整个系统运行缓慢”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T01:25:28.880

您还应该考虑 cmd 行进程是否是 IO 密集型的。这可以在一些 Linux 发行版上使用 'ionice' 命令进行调整，尽管它的用法并不像 cpu 'nice' 命令那样简单。

基本用法：

离子-n7 cmd

将以最低优先级使用“尽力而为”调度程序运行“cmd”。有关更多使用详情，请参阅手册页。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T00:52:04.470

单独使用 CPU 周期不应接管系统的其余部分。您可以通过执行以下操作来证明这一点：

```
while true; do done 
```

这是一个无限循环，将使用尽可能多的 CPU 周期（用 ^C 停止）。您可以使用`top`它来验证它是否正在完成它的工作。我很确定这不会显着影响系统的整体性能，以至于 MySQL 死机。

但是，如果您的 PHP 脚本分配了大量内存，那肯定*会*有所作为。当系统开始耗尽内存时，Linux 倾向于绕过终止进程。

在寻找解决方案之前，我会缩小问题范围并确定原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T01:01:10.537

你可以通过 NFS 在另一台机器上挂载你的服务器有趣的目录/文件系统/任何东西，并在那里运行脚本（我知道，这意味着避免这个问题并且不是很实用 :| ）。

# user-interface - nag 屏幕/nagware 可以接受吗？

> ID：257673
> 
> 赞同：0
> 
> 时间：2008-11-03T00:57:01.623
> 
> 标签：user-interface

您（作为用户和开发人员）对例如在开始屏幕或间歇性显示模式对话框 x 秒的乞讨软件有何看法？让用户付款（或给你寄明信片或任何其他形式的感谢）而不是使用试用版的其他方法呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T01:01:36.543

作为用户，这很烦人，但我觉得我没有任何抱怨的权利。如果我不喜欢它，我可以为软件付费或使用其他软件。

作为共享软件开发人员，我不使用它——我更喜欢将免费版本设为残废或有时间限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T01:28:24.930

Nagware 有点毫无意义，你为限制软件所做的任何事情，以使“免费”版本受到某种阻碍，最终将导致它被逆向工程，人们只会下载**过时** 且可能**感染了病毒**的软件替代品，虽然不是你做的，但会让你的软件看起来很糟糕。

我知道这并非对所有软件类型都可行，但最好的办法是放弃这场斗争，免费提供您的软件，然后找到其他可以让您从该软件中赚钱的情况。

*   双重许可，私人/非营利使用免费，公司/公司许可。
*   消耗品相关服务收费，即：
    *   支持
    *   订阅在线服务（许多游戏都这样做）
*   Aferro GPL：任何人都可以使用它，但必须将其源代码分享给所有使用它的人。不想分享的人*必须*缴纳许可费。

许多想法只是有不同的回报率，“放弃”然后在相关服务上收集资金可能听起来对你没有帮助，但是免费让它更快地出现在那里，然后它是一个关于你什么时候的数字游戏将有足够大的基础来为其他服务提供动力。

（相反的想法是拥有一个价值数百万的产品，你卖一次，并且因为成本高而不会传播）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T01:00:29.150

我真的不觉得他们真的完成了那么多。我一直在使用 WinZip 之类的东西，没有支付许可证，多年来，看着它计数了我一直在使用它的所有 1000 天，仅仅是因为我认为他们要的价格不值得不看唠叨屏幕。如果这个人不想购买你的程序，向他们展示一个唠叨屏幕不会给他们任何额外的购买动力。

# c# - 母版页 - 设计问题

> ID：257676
> 
> 赞同：2
> 
> 时间：2008-11-03T00:59:01.773
> 
> 标签：c#, asp.net, master-pages, master

你们认为母版页应该是公司框架的一部分还是应该是每个应用程序的一部分？或者公司的框架应该只有一个接口来为所有母版页提供最少的功能？

目前我们面临两个问题：首先，最初的想法是为每一个业务应用程序都有一个共同的布局。这就是为什么母版页位于公司框架中的原因。其次，一些应用程序需要有不同的布局，这造成了一些痛苦，因为菜单、CSS 类等的整个逻辑都在框架中......

你们能告诉我你们的想法吗？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T01:05:08.877

我会尝试将 UI 元素（如通用控件）移动到您的框架库中，并为应用程序*中*的每个应用程序创建一个母版页。这将使您能够通过使用通用控件在应用程序中维护通用 UI 元素，并提供为每个应用程序创建不同布局的灵活性。

其他需要考虑的事情是在同一个应用程序中出于不同目的使用不同的母版页。例如，您可能将一个母版页用于内部员工，一个母版页用于客户等。或者您可能将一个母版页用于普通浏览器，而将另一个母版页用于黑莓等设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T01:03:07.833

共享一些 CSS 和设计库（模板、图像、调色板），但单个共享母版页不太可能足够灵活。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T01:05:57.017

我认为这取决于贵公司的要求。我曾经为一个组织工作，它是我们核心框架的一部分。然而，这只是因为我们所有的 Web 应用程序都是内部的，并且需要具有相同的外观和感觉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T01:52:50.370

如果您正在考虑拥有一个共享母版页，这可能意味着您的逻辑过多。在我的公司，他们历来创建具有许多通用功能的基本母版页和基本页面。问题是这是非常不灵活的。我已经开始使用 MVP 框架并从页面中提取逻辑，并且不再需要一个通用的母版页，它只有布局逻辑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T05:22:10.433

母版页旨在在整个网站的多个页面上保存将是静态的元素。您可以使用它来保存页脚、页眉等。

我认为您甚至不应该考虑为多个应用程序使用相同的母版页，这将严重限制您可以对母版页执行的操作。事实上，如果需要，我鼓励您在一个应用程序中包含多个母版页。这没什么不好。

如果您尝试在多个应用程序中使用相同的母版页，您将不得不进行一些非常有创意的编程以保持它们的灵活性，而且您知道会发生什么……在一个应用程序中引入的错误会渗透到所有应用程序中。所以这绝对是一个禁忌。

希望有帮助。

# visual-studio - SharePoint Visual Studio 文档上传 Web 测试失败，并在写入所有字节之前无法关闭流

> ID：257680
> 
> 赞同：1
> 
> 时间：2008-11-03T01:00:40.180
> 
> 标签：visual-studio, sharepoint, upload, document-library, webtest

我创建了一个 Visual Studio 2008 sp1 测试套件 Web 测试，可将文档上传到 SharePoint 中的文档库。[该测试与此处](http://www.helloitsliam.com/Lists/Posts/Post.aspx?ID=139)描述的测试非常相似。

在测试转换为编码的 Web 测试之前，一切都很好。然后上传帖子返回响应

“请求失败：在写入所有字节之前不要关闭流”

关于如何进行的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-13T18:24:03.953

您还可以使用 testrunco​​nfig 中的部署设置。它更复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T21:51:10.170

...所以事实证明，虽然文件名作为部署项包含在测试中并且文件已添加到 Visual Studio 项目中，但 Visual Studio 文件属性“复制到输出目录”设置为“不复制”。将此更改为“始终复制”可以解决此问题。

# windows - windows文件创建时间戳可靠吗？

> ID：257685
> 
> 赞同：3
> 
> 时间：2008-11-03T01:03:19.503
> 
> 标签：windows, file

我有一个使用保存文件的程序。它需要加载最新的保存文件，但如果该文件不可用或损坏，则退回到下一个最新的文件。我可以使用 windows 文件创建时间戳来告诉它们何时创建的顺序，还是不可靠？我问是因为“更改”的时间戳似乎不可靠。如果必须，我可以在名称中嵌入创建时间/日期，但如果可能的话，使用文件系统日期会更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T01:14:11.573

If you have a directory full of arbitrary and randomly named files and 'time' is the only factor, it may be more pointful to establish a filename that matches the timestamp to eliminate need for using tools to view it.

```
2008_12_31_24_60_60_1000 
```

Would be my recommendation for a flatfile system.

Sometimes if you have a lot of files, you may want to group them, ie:

```
2008/
2008/12/
2008/12/31
2008/12/31/00-12/
2008/12/31/13-24/24_60_60_1000 
```

or something larger

```
2008/
2008/12_31/ 
```

etc etc etc.

( Moreover, if you're not embedding the time, what is your other distinguishing characteritics, you cant have a null file name, and creating monotonically increasing sequences is way harder ? need info )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T01:47:33.237

What do you mean by "reliable"? When you create a file, it gets a timestamp, and that works. Now, the resolution of that timestamp is not necessarily high -- on FAT16 it was 2 seconds, I think. On FAT32 and NTFS it probably is 1 second. So if you are saving your files at a rate of less then one per second, you should be good there. Keep in mind, that user can change the timestamp value arbitrarily. If you are concerned about that, you'll have to embed the timestamp into the file itself (although in my opinion that would be ovekill)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-10T06:41:04.857

当然，如果机器的用户是管理员，他们可以将当前时间设置为任何他们想要的时间，系统会很高兴地为文件加上那个时间的时间戳。

所以这一切都取决于你试图用这些信息做什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T00:24:30.687

如果由于某种原因更改了系统时间怎么办？它看起来很方便，但也许其他一些版本号会更好。

补充：一个类似的问题，但有数据库，[here](https://stackoverflow.com/questions/600693/why-not-use-the-creation-time-of-a-record-as-a-primary-key)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T00:00:51.057

Windows 时间戳采用 UTC。因此，如果您的时区发生变化（即夏令时开始或结束时），时间戳将向前/向后移动一个小时。除此之外，以及大约 2 秒的精度，没有理由认为时间戳无效，使用它们当然可以。但我认为这是不好的做法，当您可以简单地将时间戳放在名称中，甚至在文件本身中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-26T19:25:58.377

在删除和重新创建同名文件后，我遇到了一些文件创建时间的问题。

[与GetFileInfoEx 文档](http://msdn.microsoft.com/en-us/library/aa364946.aspx)中的此评论类似的内容

> 重新创建文件后获取正确创建时间的问题
> 
> 我尝试使用 GetFileAttributesEx，然后获取生成的 WIN32_FILE_ATTRIBUTE_DATA 结构的 ftCreationTime 字段。起初它工作得很好，但是在我删除文件并再次重新创建之后，它一直给我原来已经不正确的值，直到我再次重新启动该过程。FindFirstFile API 也会出现同样的问题。我使用窗口 2003。

据说这与称为[隧道的东西有关](http://support.microsoft.com/default.aspx?scid=kb%3Ben-us%3B172190)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-05T12:17:26.233

当你想重命名文件时尝试使用它

```
Path.Combine(ArchivedPath, currentDate + " " + fileInfo.Name)) 
```

# reference - 推荐一个好的vi参考？

> ID：257699
> 
> 赞同：17
> 
> 时间：2008-11-03T01:10:03.233
> 
> 标签：reference, vi

由于我很少使用 vi，而且我的主编辑器肯定不会，所以我不记得任何 vi 命令。有人推荐快速入门指南或命令摘要吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-03T01:25:58.520

这是放在办公桌上的最佳选择，装满咖啡效果很好:-)

[![维马克杯](https://i.stack.imgur.com/aJ7Pk.jpg)](https://i.stack.imgur.com/aJ7Pk.jpg)
[（来源：[thinkgeek.com](https://www.thinkgeek.com/images/products/front/vi_mug.jpg)）]

[Vi 参考文献的杯子](https://web.archive.org/web/20150602103646/http://www.thinkgeek.com/interests/exclusives/7bbe/)

我也喜欢[VI Editor 袖珍参考书](https://rads.stackoverflow.com/amzn/click/com/1565924975)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T01:11:31.360

Arnold Robbins 和 Linda Lamb[的《学习 vi 编辑器》](https://rads.stackoverflow.com/amzn/click/com/1565924266)

[![替代文字](https://i.stack.imgur.com/myuDJ.jpg)](https://i.stack.imgur.com/myuDJ.jpg)

还提供了一个快速参考的[小伙伴](https://rads.stackoverflow.com/amzn/click/com/1565924975)（A. Robbins）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T01:20:47.707

您可以打印出一份很好的备忘单：http: [//www.viemu.com/a_vi_vim_graphical_cheat_sheet_tutorial.html](http://www.viemu.com/a_vi_vim_graphical_cheat_sheet_tutorial.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T01:11:15.323

类型`vim-tutor`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-03T03:15:32.233

[http://www.vim.org/htmldoc/](http://www.vim.org/htmldoc/)

它是帮助的 html 版本，也可以从 vim 本身使用 :help 命令获得。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T01:53:23.427

我最近开始使用vi。获取引用的一种方法是为一些常用命令添加书签：

*   [VIM 介绍和教程](https://stackoverflow.com/users/30907/davidchuca)。我一开始就多次提到这一点。现在我很少使用它了
*   [VIM 快速参考卡](http://tnerual.eriogerg.free.fr/vimqrc.html)。按组快速参考。

[我在我的foxmarks](http://www.foxmarks.com/)中添加了一些类似的链接，以便我可以在家里和工作中同步这些链接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T01:22:48.810

优秀的书，以及其他答案的链接。如果你在 Vim 中，别忘了老忠实：

```
<ESC>:he<Return> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T22:15:52.683

我一直在使用这个 vi 参考：[http://www.digitahsystems.com/vi_ref.html](http://www.digitahsystems.com/vi_ref.html)

# delphi - Delphi：如果我在项目中使用包，为什么“使用调试 DCU”会变得无效？

> ID：257711
> 
> 赞同：2
> 
> 时间：2008-11-03T01:21:50.153
> 
> 标签：delphi, debugging, package

我正在构建一个使用 JVCL 插件系统的项目，该系统依赖于运行时 Delphi 包，自从我将它添加到我的项目中，调试就变成了一场噩梦，因为我不再能够逐步跟踪到源代码任何 VCL 或 RTL 单元。它们在调试器中都被标记为灰点（当相关函数完全出现在调用堆栈中时；有时我会得到非常奇怪的结果），这让我发疯了。有谁知道如何恢复我的调试 DCU 功能？（除了显而易见的：删除所有与插件相关的代码。这会*起作用*，但不会真正有帮助。）

编辑：为了清楚起见，我可以在我的项目中追踪任何其他内容。JVCL 代码。其他 3rd 方库。我自己的代码。所有这些都在调试器中显示得很好。只是不是 Delphi RTL 和 VCL 代码——编译器选项“使用调试 DCU”应该授予您访问权限的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T08:25:02.997

这是按设计工作的。

当您使用包进行构建时，您正在执行包代码，而不是使用任何 DCU。因此，DCU 已编译，您无法访问 Debug DCU。

您可以完全关闭包，也可以不使用要调试的特定包进行编译。您可以选择应该使用或不使用哪些包，不使用的包将通过 Debug DCU 进行“调试”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T03:42:29.230

包只是 DLL。您必须将调试信息包含到那些能够调试它们的信息中，这就是您想要做的。所以你需要有 VCL 和 RTL 的调试包，而不是调试 dcus。当您使用预构建的软件包时，甚至不再需要调试 dcus。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T01:26:09.067

可能是您拥有的 DCU 已过时，因此调试器不会进入代码。

通常删除所有 DCU，然后执行 Build All 将解决此问题。

您可能还需要删除搜索路径中的 DCU，以确保这一点。当然要先备份...

# java - Java 的最佳 Web 应用程序框架？

> ID：257712
> 
> 赞同：18
> 
> 时间：2008-11-03T01:22:02.617
> 
> 标签：java, model-view-controller, web-frameworks

哪个是最好的 Java 框架？我正在寻找类似于 Symfony for php 和 Ruby-On-Rails for Ruby 的东西？我什至不知道Java是否存在这样的东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T09:52:58.733

看看春天。我认为它可以做任何 Ruby-On-Rails 可以做的事情（你也可以为 ORM 添加 Hibernate）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-03T01:50:26.740

有许多很棒的 Java 网络框架，但如果您正在寻找类似于 Rails 的东西，请查看[Grails](http://grails.org/)。它使用[Groovy](http://groovy.codehaus.org/)，这是一种动态语言，但使用 Java VM。

查看他们的[快速入门](http://grails.org/Quick+Start)，以确定它是否是您想要的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-10-18T18:13:08.223

我建议你检查一下[playframework](http://www.playframework.org/)。

为什么？ [这篇文章](http://www.rojotek.com/blog/2010/04/10/eleven-reasons-to-use-the-play-framework-for-java-web-development/)很好地总结了它。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-10-18T18:17:30.533

我目前首选的 Web 应用程序框架是 Play 框架。[http://www.playframework.org](http://www.playframework.org)。

我使用过许多其他列出的框架，例如 Struts、Seam 等，但我从未使用过像 Play 这样快速、高效的框架。它减少了开发所需的代码量（而不是像 Roo 那样构建样板代码），并且消除了代码-构建-部署周期。编译由 Play 自动完成，错误会显示在浏览器中，从而获得非常成功的即时反馈。

如果不出意外，我建议您前往 Play 主页并查看截屏视频。它有几分钟的时间，但显示了框架的力量。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-03T02:02:48.573

我喜欢 grails，但是那里有很多这样的东西，matt raible sems 可以很好地处理它们：

*   [http://static.raibledesigns.com/repository/presentations/ComparingJavaWebFrameworks-ApacheConEU2007.pdf](http://static.raibledesigns.com/repository/presentations/ComparingJavaWebFrameworks-ApacheConEU2007.pdf)
*   [http://raibledesigns.com/rd/entry/the_web_framework_smackdown_questions](http://raibledesigns.com/rd/entry/the_web_framework_smackdown_questions)
*   [http://en.oreilly.com/oscon2008/public/schedule/detail/2651](http://en.oreilly.com/oscon2008/public/schedule/detail/2651)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-03T02:19:08.990

这取决于你想做什么，但简短的回答是：男孩，在那里！但是请注意，该答案并不表明无数选项是好还是坏。Java 的服务器端社区往往更加分散，虽然在 Ruby 的实际实践中使用的 Rails 替代品并不多，但 Java 端的每个阵营似乎都相当不错。正如 Taylor Marshall 提到的，有 Struts，它在工业中最常用（因为它是我所知道的仍在使用的最古老的 OSS MVC 容器。但似乎没有人喜欢 Struts。Apache Jakarta 上的[Ex-Jakarta](http://jakarta.apache.org/)菜单页面显示了他们孵化的许多 Web 应用程序框架，包括[Tapestry](http://tapestry.apache.org/)、[Turbine](http://turbine.apache.org/)和[Velocity](http://velocity.apache.org/). 还有[Wicket （](http://wicket.apache.org/)[此处](http://www.ibm.com/developerworks/java/library/os-tapestrywicket/index.html?ca=drs)提供了 Wicket 和 Tapestry 的非常不错的比较）。哦，还有[Java Server Faces](http://java.sun.com/javaee/javaserverfaces/)。和 SpringMVC。Tapestry 和 Wicket（尤其是）似乎正在取得进展，而每个人似乎都有关于 JSF 的恐怖故事。您的里程在这里绝对会有所不同，并且eesh，仅查看此答案中的链接，也许Groovy会更简单。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-03T02:08:34.520

我不确定您是否在讽刺，但如果您不在此处，请查看 Java Web 框架的部分列表：

1.  Java Server Faces（Sun 官方规范），提供各种实现
2.  Apache Struts
3.  阿帕奇页岩
4.  阿帕奇挂毯
5.  阿帕奇检票口
6.  OpenSymphony WebWork
7.  Spring 框架 MVC

只使用了其中的几个，我真的不能告诉你哪一个是最好的。Spring MVC 是我个人最喜欢的面向内容的站点，但如果它更像是传统的 Web 应用程序（具有 Web 界面的应用程序），我会使用 JSF。

通常，Java 开发人员之间的笑话不是某个应用程序*是否有框架/库，而是要使用几十个选项中的哪一个。*

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-03T01:33:56.400

[Struts](http://struts.apache.org/)适用于西装。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-03T14:31:57.670

[正如我在上一个答案中概述的那样](https://stackoverflow.com/questions/248272/aspnet-mvc-framework-port-for-java-ee#248913)，我喜欢 Spring MVC。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-03T02:07:53.757

我同意其他建议 grails 的人的观点——我现在在几个应用程序上使用它，这是我发现的最接近 java 风格的 ruby​​ on rails 的东西。也就是说，为什么不使用 JRuby？我的理解是他们现在在上面运行 Rails。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-03T14:32:03.943

我非常喜欢使用 Grails，它广泛使用了 Hibernate 和 Spring 框架。它分离模型视图和控制器的方式很棒。[GORM](http://grails.org/GORM)（Grails 的对象关系映射 (ORM) 实现）令人惊叹，并且计划将其分离成自己的独立产品。

[使用Spring Acegi 安全插件](http://grails.org/AcegiSecurity+Plugin)非常容易实现安全性

另外值得一看的是[Searchable 插件](http://grails.org/Searchable+Plugin)，它可以非常快速轻松地实现全文搜索。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-13T22:40:12.403

放下手，Grails。

只需从 Grails.org 下载它，然后开始研究示例和截屏视频。制作它的人刚刚被 SpringSource 收购，所以它一定会去的地方！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-08-08T14:31:13.980

我刚开始使用 Groovy/Grails，它看起来不错。好的是您可以利用所有现有的 Java 技术。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-10-18T18:07:58.707

看看[JRapid](http://www.jrapid.com)！定义您的应用程序模型，它会为您的应用程序生成每一层，包括非常强大的 UI。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-03T02:09:53.097

Tapestry 看起来很酷……在你付出了巨大的努力安装它之后。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-03T04:56:44.087

我读到了 JBoss Seam，它看起来也不错

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-03T20:52:04.330

如果您需要在 JVM 上运行，Grails 非常棒。如果您想严格遵守 Java（不是动态语言），我认为 spring 将是您最好的选择。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-09-30T15:03:26.577

Apache [Wicket](http://wicket.apache.org/)和[Vaadin](http://vaadin.com/)是我的最爱。Vaadin 更适合 RIA / 应用程序风格的界面。

# python - Python vs Groovy vs Ruby？（基于相关标准）

> ID：257730
> 
> 赞同：35
> 
> 时间：2008-11-03T01:31:49.650
> 
> 标签：python, ruby, scripting, groovy

考虑到下面列出的标准，您会使用 Python、Groovy 还是 Ruby 中的哪一个？

*   *标准（10 项中的重要性，10 项最重要）*
*   丰富的 API/库可用（例如数学、绘图、网络）(9)
*   能够嵌入桌面 (java/c++) 应用程序 (8)
*   易于部署 (8)
*   能够与 DLL/共享库交互 (7)
*   生成 GUI 的能力 (7)
*   社区/用户支持 (6)
*   便携性 (6)
*   数据库操作 (3)
*   语言/语义 (2)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-03T01:44:39.577

我认为很难进行客观的比较。我个人更喜欢 Python。为了满足您的一个标准，Python 从一开始就被设计为一种可嵌入的语言。它有一个非常丰富的 C API，并且解释器是模块化的，可以很容易地从 C 调用。如果你的宿主环境是 Java，你应该看看 Jython，它是 Java 环境（VM 和库）内的 Python 实现。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-09-09T19:33:20.270

在与他们三个人一起工作之后，这就是我可以说的：

*   **Python**

    *   有非常成熟的库
    *   库记录在案
    *   可以在运行时通过 docstrings 从调试器/shell 访问文档
    *   您可以在没有 IDE 的情况下开发代码
*   **红宝石**

    *   有一些很棒的库（即使有些没有很好的文档记录）
    *   Ruby 的自省机制很棒。它们使编写代码变得非常容易（即使文档不可用）
    *   您可以在没有 IDE 的情况下开发代码
*   **时髦的**

    *   您可以从 Java 所提供的一切中受益
    *   语法在某种程度上受到 Ruby 的启发
    *   没有 IDE 很难编写代码。您无法从控制台调试东西（这是您可以在 Python/Ruby 中轻松完成的事情），并且可用的 Groovy 插件有很多工作要做。我使用 Groovy 编写了一些应用程序，随着它们变得越来越大，我很遗憾没有使用 Ruby/Python（调试会更容易）。如果您只从 IDE 开发，Groovy 是一种很酷的语言。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-11-03T02:06:59.593

只是为了搅浑水...

Groovy 让您可以访问 Java。Java 有一组极其丰富的 API/库、应用程序等。

Groovy 是可嵌入的，尽管在 Java 中最简单。

DLL/库（如果您谈论的是非 Groovy/Java）可能会有些问题，尽管有一些方法和一些 API 可以提供帮助。

我做过一些 Python 编程，但由于更熟悉 Java，Groovy 对我来说更容易。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-27T04:15:03.403

时髦？我只是把它捡起来；试试这个（在 groovyconsole 里面）：

```
File.metaClass.invokeMethod = { String name, args ->
    System.out.print ("Call to $name intercepted...");
    File.metaClass.getMetaMethod(name, args).invoke(delegate, args);
}

new File("c:/temp").eachFile{
    if (it.isFile()) println it.canonicalPath
} 
```

第一个代码是 AOP。对 File 对象的任何方法的所有调用都将被拦截。不需要额外的工具。这是针对现有的 Java 类动态执行的。

在第二个块中，您删除了 'f' 闭包参数。作为一个参数，它默认为闭包​​上下文可用的内置“it”变量。

这是你得到的：

“调用 isFile 被截获...C:\temp\img.jpg”

等等

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-29T00:34:24.383

试试 Groovy .. 它有你需要的所有功能。您可以使用现有的 java lib 而不对其类进行任何修改。基本上 .. groovy 是 java++，学习起来更加动态和有趣（就像 ruby​​ 一样）

我不喜欢 ruby​​ 或 python 语法，所以我会把它们放在后面。Groovy 就像 C/C++ 语法，所以我喜欢他，哈哈 :)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-03T02:48:20.180

Python 具有所有九个标准。它得分为56。

我确信 Ruby 拥有 Python 所拥有的一切。它似乎有更少的图书馆。所以它得分为51。

我不知道 Groovy 是否具备所有功能。

由于 Python 是 56，而 Ruby 是 51，Python 只是勉强超越了 Ruby。

但是，我认为这种决定仍然可以归结为这九个标准之外的一些主观问题。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-27T11:20:23.470

根据您的标准，我会选择 JRuby：

*   丰富的 API/库可用（例如数学、绘图、网络）(9)

JVM可以访问的所有东西，*很多*

*   能够嵌入桌面 (java/c++) 应用程序 (8)

优秀[的 Monkeybars](http://monkeybars.rubyforge.org)框架，可让您在 GUI 设计器中设计一个摆动 GUI，然后使用干净的 ruby​​ 代码将其连接起来

*   易于部署 (8)

[Rawr](http://rawr.rubyforge.org)可以将您的应用程序打包为可执行 jar

*   能够与 DLL/共享库交互 (7)

Java 轻松共享库，C 共享库通过[jna + libffi](http://blog.headius.com/2007/09/java-native-access-jruby-true-posix.html)

*   生成 GUI 的能力 (7)

摇摆只是工作。不确定使用 QtJambi 有多容易，但绝对有可能。

*   社区/用户支持 (6)

很多。Ruby 有一个优秀的社区。

*   便携性 (6)

JVM 工作的任何地方

*   数据库操作 (3)

所有的 ruby​​ 数据库*和*所有的 java数据库

*   语言/语义 (2)

这就是 ruby​​ 明显领先于 groovy 和 python 的地方。该语言在早期做出了一些非常漂亮的设计决策，这体现在标准库的一致性和强大功能上。[尤其是Blocks](http://weblog.jamisbuck.org/2007/1/19/blocks-rock)，使用起来很有趣。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-03T02:03:04.687

这种按功能加分的方式并不是选择编程语言的好方法。你最好选择你最了解的那个。如果您不认识其中任何一个，请尝试一段时间。如果您有一个非常具体的项目，那么也许某些编程语言会更好，但如果您只是有一般偏好，您将永远无法达成共识。

也就是说，Python 非常灵活，它是您列表中最受欢迎的，因此最容易通过搜索解决您遇到的任何类型的问题，所以我推荐 Python。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-03T11:01:22.463

珀尔？哎呀。

正如有人观察到的那样，Perl 就像标点符号工厂的大爆炸。如果生成的代码不是自我记录的，那么简洁**不是优势。**

已经使用 Groovy 完成了一些实用任务，很容易上手。完全访问 Java 库，以及一些很酷的附加功能，例如使用闭包列出目录中的文件：

```
// process all files printing out full name (. and .. auto excluded)

new File(basedir).eachFile{ f->

    if (f.isFile()) println f.canonicalPath
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T01:36:34.210

我知道它不在你的清单上，但至少看看 perl。

*   丰富的 API/库可以沉船。
*   运行在比大多数人意识到的更多的系统上。
*   适用于二进制库。
*   拥有庞大的社区。
*   便携性，见上文。
*   数据库操作：更多方法。（选择你最喜欢的模块）
*   并且是周围最具表现力/简洁的语言之一。

# c# - 创建 Visual Studio 模板

> ID：257735
> 
> 赞同：2
> 
> 时间：2008-11-03T01:34:48.037
> 
> 标签：c#, visual-studio, templates

我正在寻找创建一个 Visual Studio 2008 模板，该模板将创建一个基本项目，并根据用户输入的选项删除某些文件/文件夹。

现在，我已经在线学习了一些教程，这些教程让我创建了表单来查询用户并将数据传递给 IWizard 类，但我不知道从那里做什么。

教程提供了一个示例来做一些简单的替换：代码：

```
Form1 form = new Form1();
DialogResult dlg = form.ShowDialog();
if (dlg == DialogResult.OK)
{
    foreach (KeyValuePair<string, string> pair in form.Parameters)
    {
        if (!replacementsDictionary.ContainsKey(pair.Key))
            replacementsDictionary.Add(pair.Key, pair.Value);
        else
            replacementsDictionary[pair.Key] = pair.Value;
    }
}
form.Close(); 
```

但我希望根据用户设置有选择地包含文件，如果可能的话，根据设置有选择地在文件中包含代码部分。

有没有一种聪明的方法可以做到这一点，还是我必须手动删除 IWizard:ProjectFinishedGenerating() 中的项目文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T13:53:12.657

以我的经验，`ShouldAddProjectItem`只会调用模板项目中的*文件夹*。因此，它几乎没有用。

相反，您需要将代码放入`ProjectFinishedGenerating`使用 VS API 删除 ProjectItems 的实现中。

在那里，您可以删除这样的项目：

```
ProjectItem file = project.ProjectItems.Item("File.cs");
file.Remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-27T15:08:44.750

`$if$`您可以通过使用with replacements选择性地包含文件的某些部分。例如，请参阅默认 C# 类库模板中的此位：

```
<ItemGroup>
    <Reference Include="System"/>
    $if$ ($targetframeworkversion$ >= 3.5)
    <Reference Include="System.Core"/>
    <Reference Include="System.Xml.Linq"/>
    <Reference Include="System.Data.DataSetExtensions"/>
    $endif$ 
```

...ETC。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T05:17:25.373

如果我理解正确，您希望能够确定是否应该将项目项添加到项目中。

如果是这样，您可以实现 IWizard.ShouldAddProjectItem 并返回是否要添加文件。

# eclipse - Subclipse：有没有办法让 Team>Create Patch 使用相对路径？

> ID：257739
> 
> 赞同：3
> 
> 时间：2008-11-03T01:38:32.303
> 
> 标签：eclipse, svn, patch, subclipse

我最近在工作中参与了一个 Java 项目：我们使用 MyEclipse 作为 IDE，使用 Subclipse 进行源代码控制集成。由于我是该项目的新手，因此我目前将我所做的任何更改作为补丁提交，以便其他团队成员更轻松地查看我的更改并决定是否将它们提交到主干。但是，当我使用 Team 菜单中的 Create Patch 选项创建补丁时，生成的补丁包含已更改文件的绝对路径。由于我希望能够将这些补丁通过电子邮件发送给其他团队成员并让他们简单地将补丁应用到他们自己的工作文件夹中，因此我想生成仅包含相对文件路径的补丁（我在 Ubuntu 上运行，目前我的工作副本在我的主文件夹中，所以绝对路径特别烦人）。

有没有办法配置 Eclipse/Subclipse 来做到这一点？我搜索了 Eclipse Preferences 并单击了几次 Create Patch 向导，但我找不到任何看起来可以做到这一点的东西。目前，我正在使用文本编辑器手动编辑补丁文件，以将绝对文件路径转换为相对路径。如果 Subclipse 不能做到这一点，我愿意接受其他建议。

**编辑**：我知道当您从 Eclipse 中应用补丁时，可以选择忽略文件名路径中的某些段，但我很好奇是否有办法避免这种情况以减少所涉及的步骤数在应用补丁。通过手动编辑路径以使它们相对于项目的根文件夹，最终用户只需确保在根项目文件夹级别应用补丁即可。我想拥有这种简单性，而不必手动编辑补丁文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T09:30:56.280

最新版本的 subclipse 能够做到你所说的。可能我有相同的版本，因为 1.2.4（我的版本）默认使用文件系统作为补丁根，而 1.5.2 版允许您在创建补丁文件之前选择补丁根（在项目、工作区或选择之间）。

*好吧，对不起，我读到你已经知道如何手动修补它，但我将其作为参考：*

在升级之前，您可以手动打开补丁文件并对其进行编辑：

1.  右键单击->打开方式->文本编辑器，
2.  查找所有出现的 /home/user/projectfiles/project/ 并将其替换为空白...
3.  请记住在“索引：”和文件名之间只留一个空格，例如“索引：.classpath”，否则您的补丁将无法在基于 Windows 的 Eclipse 中使用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T12:42:02.947

Subversion API 在 1.5 中得到了增强，允许将相对路径位置传递给 API。如果您安装 Subclipse 1.4.x（使用 Subversion 1.5），那么补丁将具有相对路径。还有许多其他与补丁相关的增强功能，包括多项目补丁和选择补丁中包含哪些文件的能力。

# c# - 如何在 C# 中访问 Silverlight 对象的附加属性？

> ID：257740
> 
> 赞同：1
> 
> 时间：2008-11-03T01:39:00.430
> 
> 标签：c#, silverlight

基本上我正在尝试`Canvas.Left`在 C# 中更改 Ellipse Silverlight 控件的属性。这是我访问控件的方式：

```
Ellipse c1 = this.FindName("Circle1") as Ellipse; 
```

那么我将如何设置`Canvas.Left`属性？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T01:45:17.250

答案在于 Silverlights 使用依赖属性

c1.SetValue(Canvas.LeftProperty, value);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T01:45:51.540

像这样的东西......

```
double left=50;
c1.SetValue(Canvas.LeftProperty, left); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T10:56:39.603

另一种方式 Canvas.SetLeft(c1,value)

# visual-studio - How to change Visual Studio whitespace settings?

> ID：257752
> 
> 赞同：37
> 
> 时间：2008-11-03T01:49:01.220
> 
> 标签：visual-studio, editor

I have whitespace characters showing in the Visual Studio code editor, and I'd like to remove them.

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-11-03T02:37:14.213

Ajryan 是正确的，但根据您的个人资料，此菜单项可能会被遮挡。键盘快捷键应该仍然有效。 `Ctrl`+ `R`, `Ctrl`+`W`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-03T01:59:51.480

You need to turn off showing whitespace characters. Menu: Edit > Advanced > View White Space.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-03T03:33:02.493

如果是 VS2008 则可以使用`Ctrl`+ `E`,`S`组合来切换。

# google-maps - 以编程方式截取谷歌街景全景图的最佳（或任何）方式

> ID：257753
> 
> 赞同：1
> 
> 时间：2008-11-03T01:49:02.423
> 
> 标签：google-maps, google-street-view

正如问题所暗示的，我正在寻找一种以编程方式屏幕抓取给定全景图的方法，IE 设置经度和纬度以及 POV（俯仰、偏航和缩放）并将抓取保存到服务器。到目前为止，最有希望的是

1.  使用 .net 来控制 google earth com api ( [http://earth.google.com/comapi/index.html](http://earth.google.com/comapi/index.html) )，但是我无法找到关于街景图层是否可以通过这种方式访问​​的明确答案.

2.  将街景 swf 嵌入到另一个 swf 中，该 swf 打开到 Web 服务器的套接字以侦听请求，并将命令（例如调整 lat/lng 和 POV）传递给街景 swf，然后屏幕抓取视图并将其保存回服务器。swf 将在网络服务器或另一台服务器上运行。

这两种解决方案都涉及有关可靠性和可扩展性的问题。有没有人有任何进一步的建议或想法？该解决方案不必是实时的，它假设将发生一些异步“幕后”处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T02:01:03.520

你关心许可吗？我怀疑谷歌限制了你可以使用街景数据做的事情，并且可能禁止“屏幕抓取”......

假设您知道如何不被 google 起诉，一种选择可能是跟踪街景 SWF 生成的 HTTP 请求，并尝试对 API 进行逆向工程。我会先尝试使用[http://fiddler2.com](http://fiddler2.com)（它是基于浏览器的 HTTP 调试的绝佳工具），如果这对 flash 播放器不太适用，请使用[http://www.wireshark。 org](http://www.wireshark.org)（这是一个通用的网络嗅探器，可能需要一些时间来适应）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T19:08:09.537

如果您有坐标、POV 和其他变量，那么您可以使用 Google Street View Image API

[https://developers.google.com/maps/documentation/streetview/](https://developers.google.com/maps/documentation/streetview/)

例如 -

```
http://maps.googleapis.com/maps/api/streetview?size=400x400&location=40.720032,%20-73.988354&fov=90&heading=235&pitch=10&sensor=false 
```

您可以循环并不断更改“标题”变量

# version-control - 我可以拆分 Mercurial 存储库吗？

> ID：257767
> 
> 赞同：55
> 
> 时间：2008-11-03T02:01:40.103
> 
> 标签：version-control, mercurial

我有一个较大的 Mercurial 存储库，我认为作为几个较小的存储库会更好。有没有办法可以拆分存储库并让每个部分保留其修订历史？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-11-03T04:14:54.890

最好的方法是使用['convert' 扩展](https://www.mercurial-scm.org/wiki/ConvertExtension)。您将使用 mercurial 以及源类型和目标类型，然后使用 a `--filemap`with 条目，例如：

```
exclude path/you/do/not/want
rename path/you/do/want . 
```

仅当您想要获取您保留的部分并将它们在目录层次结构中“更高”移动时，才需要重命名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-17T11:33:26.810

[我在这里](http://510x.se/notes/posts/Splitting_a_Mercurial_repository_while_keeping_relevant_history/)找到了详细指南：

创建文件映射`new-repo.filemap`，例如

```
include vendor/FooBackend
rename vendor/FooBackend . 
```

创建另一个文件映射`rewrite-old-repo.filemap`：

```
exclude vendor/FooBackend 
```

创建新的存储库：

```
hg convert /path/to/current/repo /path/to/new/repo --filemap new-repo.filemap 
```

新的存储库现已完成。该目录是空的，但 a`hg update`会加快其内容的速度。

创建修改后的存储库：

```
hg convert /path/to/current/repo /path/to/rewritten/repo --filemap rewrite-old-repo.filemap 
```

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2008-11-03T02:16:38.107

只需克隆它并从每个副本中删除不需要的东西。

# .net - Writing a Virtual Printer in .NET

> ID：257768
> 
> 赞同：29
> 
> 时间：2008-11-03T02:02:20.727
> 
> 标签：.net, virtual, printing

I'm looking to create a virtual printer that passes data to my .NET application. I want to then create an installer that installs both the printer and the .NET application. It would we really nice to be able to write it all in C#, but I have a feeling that this will require a printer driver to be written is unmanaged code. Does anyone know of a fairly clean tutorial or example of how to do this?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-09T20:34:18.320

访问[http://www.printerplusplus.com](http://www.printerplusplus.com)。它是开源的.NET 虚拟打印机。它为您提供了一个安装程序和一个 .NET 类，用于编写代码来处理您的“打印机数据”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-11-01T23:16:59.597

使用 Github 项目完全符合您的要求：Microsoft/Windows-driver-samples/print/XPSDrvSmpl

[https://github.com/Microsoft/Windows-driver-samples/tree/master/print/XPSDrvSmpl](https://github.com/Microsoft/Windows-driver-samples/tree/master/print/XPSDrvSmpl)

安装程序：[http ://wixtoolset.org/](http://wixtoolset.org/)

应用：监听内部端口

流程：从单个安装程序安装打印机和应用程序。当应用程序侦听内部端口时，用户使用您的驱动程序打印一些东西。当发送数据时，应用程序会接收它。这是针对 XPS 的，可以转换为 PDF，但是无论您打印什么，流程都是相似的。如果您需要其他任何东西，请查看 GitHub 上的 Microsoft/Windows-driver-samples/print/ 或其他特定于您需求的资源。

**更新：**

关于如何让驱动程序工作的很多问题，所以这里是一个简单的例子：

如果您尚未安装 Windows 驱动程序工具包 (WDK)，请先下载它。安装时选择在最后一步添加 Visual Studio 的扩展。在您的 Visual Studio 2017 安装中，您需要`Desktop development with C++`拥有正确的 SDK。如果您没有它，请参阅下面有关如何添加它的分析器。

[如何向 Visual Studio 2017 添加功能？](https://stackoverflow.com/questions/43127718/how-do-i-add-features-to-visual-studio-2017/47329536#47329536)

[https://developer.microsoft.com/en-us/windows/hardware/windows-driver-kit](https://developer.microsoft.com/en-us/windows/hardware/windows-driver-kit)

然后下载`.zip`Windows-driver-samples master 的文件：

[https://github.com/Microsoft/Windows-driver-samples/archive/master.zip](https://github.com/Microsoft/Windows-driver-samples/archive/master.zip)

导航到文件夹`<UnzipFolder>\print\XPSDrvSmpl`并`XPSDrvSmpl.sln`在 Visual Studio 中打开。

然后按照微软自己在 GitHub 上的指南进行操作。如您所见，它适用于 Visual Studio 2015，但我认为 2017 年的情况相同（尚未测试）：

要使用 Windows Driver Kit (WDK) 10 和 Visual Studio 2015 构建驱动程序解决方案，请执行以下步骤。

1.  在 Visual Studio 2015 中打开解决方案文件。
2.  将所有非二进制文件（通常位于示例的 \install 目录中）添加到 Package 项目：在解决方案资源管理器中，右键单击驱动程序文件 b。选择添加，然后单击现有项目 c。导航到您下载示例的位置，并选择安装目录中的所有文件，或等效的非二进制文件集，例如 INF、INI、GPD、PPD 文件等。 d. 点击添加
3.  配置这些文件以添加到驱动程序包中：在解决方案资源管理器中，右键单击解决方案并选择添加 > 新项目。在 Visual C++/Windows Driver/Package 下选择 Driver Install Package。湾。在解决方案资源管理器中，右键单击包项目并选择属性。C。在左窗格中，单击配置属性 > 驱动程序安装 > 包文件。d。在右窗格中，使用省略号按钮 (...) 浏览到需要添加到驱动程序包的文件集。应添加您在步骤 2-c 中添加的所有数据文件，INF 文件除外。此配置是针对每个架构的，因此必须为将要构建的每个架构重复此配置。e. 单击确定。
4.  打开 INF 文件并对其进行编辑以匹配生成的输出。一个。打开 INF 文件。湾。在版本部分，添加对目录文件的引用，如下所示：CatalogFile=XpsDrvSmpl.cat。C。在 SourceDisksFiles 部分中，将您正在构建的 DLL 文件的位置更改为 =1。这表明此驱动程序中没有特定于体系结构的目录。如果同时发布多个架构，则需要手动整理驱动程序 INF。

此时，Visual Studio 2015 将能够构建驱动程序包并将文件输出到磁盘。要配置驱动程序签名和部署，请参阅开发、测试和部署驱动程序。

[https://github.com/Microsoft/Windows-driver-samples/tree/master/print/XPSDrvSmpl#build-the-sample](https://github.com/Microsoft/Windows-driver-samples/tree/master/print/XPSDrvSmpl#build-the-sample)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-03T02:28:32.170

I think you will have to do *a lot* of WinAPI wrapping. Start researching on [Windows Driver Development Kit](http://www.microsoft.com/whdc/devtools/wdk/default.mspx) to find the things you have to do.

I also found this commercial [Printer Driver Resource Toolkit](http://www.blackice.com/Printer%20Drivers%20Resource%20Tool%20Kit.htm) for .NET...

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-13T17:19:46.870

您可以简单地让您的应用程序像 LPD 类型打印机或监视器端口 9100 一样暴露自己。然后您可以安装任何您喜欢的打印驱动程序，并将其指向您的应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-19T13:06:20.447

正在寻找类似问题的答案，并通过维基百科找到此链接 - [http://www.colorpilot.com/emfprinterpilot.html](http://www.colorpilot.com/emfprinterpilot.html)（允许创建不同语言的虚拟打印机）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T03:20:04.780

为什么不考虑使用替代方法。就像使用中间现成的打印程序一样，例如那些免费提供的 Print-to-PDF 应用程序。然后，您所需要的就是使用一些 3rd 方库（也具有免费和开源差异）来解码 PDF，而不是绞尽脑汁重新发明轮子。根据您认为合适的格式，您还可以考虑使用其他 Print-to-XXX 应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T05:05:45.490

我也不认为解释 PDF 方法有什么好处。我不知道你为什么想做你想做的事。也许您正在尝试编写自己的 PDF 打印机。

我认为你真的应该看看 Windows 驱动程序开发的东西。如果您想开发打印机驱动程序，我认为您必须使用 C++ 来完成。

祝你好运。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-05-10T15:11:27.800

如果我没记错的话，微软在打印机驱动程序开发中不支持 .NET。我还没有遇到过纯 .NET 打印机驱动程序。你会是一个非常勇敢的人这样做！网站“打印机驱动程序资源工具包”并没有说驱动程序是用 .NET 编写的

# c# - 无效控制器时的结构映射错误

> ID：257772
> 
> 赞同：4
> 
> 时间：2008-11-03T02:05:32.373
> 
> 标签：c#, asp.net-mvc, structuremap

我正在使用像 Rob Conery 的 MVC 店面一样的结构映射，并且我有一个 AdminController，所以我只需输入：

```
website/Admin/action 
```

但是，如果我错过拼写控制器名称，则会收到以下错误：

异常详细信息：System.ArgumentNullException：值不能为空。参数名称：key

此行出现错误：

```
Controller controller = ObjectFactory.GetInstance(controllerType) as Controller; 
```

有没有人对我如何处理这个错误有任何想法，或者根本不允许它发生，也许只是转到 404 页面？

提前喝彩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T06:58:59.473

问题是，如果没有具有预期类型名称的控制器（即，如果用户键入“ **Amdin** ”，ControllerFactory 基类将查找“ **Amdin** Controller”但不会找到它，但仍会调用您的覆盖方法）。在这种情况下，controllerType 变量将为空。所以你可以在你引用的行之前检查它是否为空，然后（如果它为空）：

A）实施拼写更正，例如 cfeduke 建议的

或 B）简单地抛出一个状态码为 404 的 HttpException （这*应该*会导致您正在寻找的 404 错误）。

注意：如果您进行拼写更正，您可能应该执行 Response.Redirect 到新 URL，而不是仅仅静默加载正确的控制器，这样地址栏会更改以反映拼写更正

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T03:12:05.937

您有几个不同的选择（或者，如果您愿意，可以将两件事结合起来形成一个解决方案）。要消除椅子和地址栏之间的一些潜在问题，您可以使用新的路由框架[在 C#中](http://www.csharphelp.com/archives2/archive394.html)[实现 SoundEx 解决方案](http://en.wikipedia.org/wiki/Soundex) ，以潜在地捕获一些拼写错误并将它们重新路由到预期的 URL（和/或添加您认为的路由常见的拼写错误或请求将是）。然而，这并不是一个可以完全解决问题的解决方案，因此您需要[考虑为您的应用程序实现自定义错误页面](http://aspnetresources.com/articles/CustomErrorPages.aspx)。

# c# - 托管服务器上的日期时间格式

> ID：257793
> 
> 赞同：4
> 
> 时间：2008-11-03T02:19:59.147
> 
> 标签：c#, asp.net, datetime

我最近更换了托管服务提供商，由于服务器现在所在的时区，我的代码已经停止工作。

托管服务器在太平洋时间报告，但是，我的代码需要与 GMT 一起使用，因为我的网站是针对英国市场的。所以，我所有的显示和搜索都需要采用 dd/MM/yyyy 格式

我该如何解释差异？

例如，当我执行 DateTime.Parse("03/11/2008") 时，它会失败，因为我认为“解析”违反了服务器设置。我还收到“字符串未被识别为有效的日期时间”。在我的代码中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T02:43:06.947

在您的 web.config 文件中，在节点下添加`<globalization>`元素：`<system.web>`

```
<system.web>
  <globalization culture="en-gb"/>
  <!-- ... -->
</system.web> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T02:32:50.320

尝试

```
DateTime.Parse("28/11/2008", new CultureInfo("en-GB")) 
```

查看[MSDN 上 DateTime.Parse 的重载](http://msdn.microsoft.com/en-us/library/kc8s65zs.aspx)。

此外，请注意不要将时区（太平洋、格林威治标准时间）与文化混淆。文化是你的实际问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-02T07:45:27.070

为了避免处理这些非常无聊的问题，我建议您始终按照标准和唯一的 SQL/ISO 日期格式（即 YYYY-MM-DD）解析数据。然后，您的查询将在国际范围内工作，无论您的主服务器或查询客户端上的日期参数是什么（本地日期设置可能与主服务器设置不同）！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-28T07:10:56.423

我有这个问题，上面的答案没有解决。所以也许这可以帮助某人不要把所有的头发都扯下来..

我在日期文本框中的新服务器上获得了 NaN-NaN-Nan。发现新服务器具有 Internet Explorer 选项“以兼容模式显示 Intranet 站点”。这里的解决方法是放

```
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" / > 
```

在 aspx 的头部强制关闭兼容性模式。

这解决了许多正在发生的奇怪问题。希望这对某人有帮助！

# file - dev-C++ 中的头文件

> ID：257795
> 
> 赞同：4
> 
> 时间：2008-11-03T02:21:39.097
> 
> 标签：file, header, dev-c++

我正在尝试将头文件添加到 dev-C++，但是当我编译它时它不起作用。这是我的确切步骤（对于我的示例，我正在尝试让 mysql.h 工作）：

1.  将“mysql.h”复制到 c:\dev-c++\includes
2.  检查 dev-C++ 工具 > 编译器选项 > 目录 > c 包含和 c++ 包含是否具有“c:\dev-c++\includes”的路径
3.  在我的文件顶部包含#include
4.  编译

这是 dev-C++ 编译器告诉我的：

```
13 C:\Documents and Settings\Steve\Desktop\server code\setup1\main.c `mysql' undeclared (first use in this function) 
```

以及由于找不到头文件而导致的其他错误

我列出的步骤是否正确？或者我还需要做些什么来编译头文件。

PS 我尝试对 VS2008 做同样的事情（将 mysql.h 放在 vs2008 包含文件夹等中）但仍然有同样的错误。如果可能的话，我想坚持使用 Dev-c++。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T02:27:51.937

你没有说你是如何将它包含在文件顶部的。如果你这样做了，这应该有效

```
#include "mysql.h" 
```

而不是

```
#include <mysql> 
```

这是人们有时会犯的错误。

编辑：在指定其他包含目录时，也许尝试使用相对路径而不是绝对路径（正如您似乎正在做的那样）？我不知道这是否会有所作为（而且我没有时间检查），但我一直使用相对路径并且它总是对我有用（无论如何这也是一种很好的做法）。所以，而不是

C:\项目\项目名称\包括

就像是

\Include 或 ..\Include 取决于您的项目文件结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T02:40:59.807

Dev-C++ 是 GCC 的一个端口，所以试试这个页面： http: [//gcc.gnu.org/onlinedocs/cpp/Search-Path.html](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html#Search-Path)。

请注意，您可能不得不使用 Makefile。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-30T21:25:15.267

我有同样的问题....

您需要将#include 放在“using namespace std;”之后，以便在标准命名空间中使用您的头文件。

对我来说，它正在工作。

最良好的祝愿。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-17T14:40:13.217

在左侧，右键单击项目并选择“添加到项目”，然后选择头文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-29T13:59:53.583

它非常简单...

只需制作您的头文件并将其保存为 .h 扩展名。

然后使用 #include **"file_name.h"** 而不是使用**include**

***示例 - 这是我的头文件。***

```
#include<iostream>
     using namespace std;

     namespace Ritesh
         {
             int a;
             int b;
             void sum();
         }
     void Ritesh::sum()
         {
             cout<<a+b;
         } 
```

**然后使用它-**

```
#include<iostream>
#include "Ritesh.h"
   using namespace std;
   using namespace Ritesh;
   int main()
       {
           a=4;b=6;
           sum();
       } 
```

输出 [——程序的输出](https://i.stack.imgur.com/Rwr8X.jpg)

# c++ - 如何在VS2005中使用sgi hash_table？

> ID：257797
> 
> 赞同：2
> 
> 时间：2008-11-03T02:24:04.240
> 
> 标签：c++, stl, hashmap, sgi

我在 VS2005 中编写了一个 C++ 项目，并使用了许多 STL 容器及其附加的 STL。但是，我发现VS2005中的STL没有hash_map，我想使用SGI hash_map。如何更改我的项目以使用 SGI STL？

感谢Brian的方法，它有效！这很简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T02:25:35.967

VS2005 确实有一个 hash_map：

```
#include <hash_map>
stdext::hash_map 
```

如果你仍然想要，你可以[在这里下载 sgi stl](http://www.sgi.com/tech/stl/download.html)。您应该能够将包含目录设置为 sgi 位置。它将优先于 VC++ 全局包含目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T09:43:05.133

我不知道 VS2005 是否有 TR1，但如果有（或者如果你以后决定使用另一个有它的编译器），你可以使用`unordered_map`：

```
#include <tr1/unordered_map>
std::tr1::unordered_map mymap; 
```

此外，为了完整起见，GCC（曾经有`<hash_map>`）具有`hash_map`on `<ext/hash_map>`（在不同的命名空间上）。在最近的 GCC 版本中，您还可以使用`<tr1/unordered_map>`.

# asp.net - 有没有办法使用带有动态内容的Thickbox？

> ID：257801
> 
> 赞同：6
> 
> 时间：2008-11-03T02:28:12.217
> 
> 标签：asp.net, jquery, thickbox

这是场景：

我在网页上有一个文本框和一个按钮。单击按钮时，我希望打开一个弹出窗口（使用厚框），它将显示与文本框中输入的值匹配的所有项目。我目前正在使用Thickbox 的IFrame 实现。问题是要显示的 URL 被硬编码到按钮的“alt”属性中。我真正需要的是“alt”属性将文本框中的值传递给弹出窗口。

这是到目前为止的代码：

```
<input type="textbox" id="tb" />
<input alt="Search.aspx?KeepThis=true&TB_iframe=true&height=500&width=700" class="thickbox" title="Search" type="button" value="Search" /> 
```

理想情况下，我想将文本框值放入 Search.aspx url，但我似乎无法弄清楚如何做到这一点。我目前的替代方法是使用 jQuery 设置搜索按钮的单击功能，以调用将在 ASP.NET 会话中设置一些值的 Web 服务。然后 Search.aspx 页面将使用会话变量进行搜索。但是，这有点不稳定，因为似乎总是有可能在设置会话变量之前执行搜索。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T04:52:40.960

只需处理按钮的 onclick 即可运行调用 的函数，`tb_show()`并传递文本框的值。就像是

```
... onclick = "doSearch()" ...

function doSearch()
{
    tb_show(caption, 'Search.aspx?KeepThis=true&q=\"' +
            $('input#tb').val() +
            '\"&TB_iframe=true&height=500&width=700');
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-23T19:32:33.363

如果您阅读手册，在 iframe 内容部分下，它会告诉您您的参数需要放在 TB_iframe 参数之前。这之后的一切都被剥夺了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T03:16:25.147

这是一个想法。我认为它不是很漂亮，但应该可以：

```
$('input#tb').blur(function(){ 
  var url = $('input.thickbox').attr('alt');
  var tbVal = $(this).val();

  // add the textbox value into the query string here
  // url = ..

  $('input.thickbox').attr('alt', url);

}); 
```

基本上，每次文本框失去焦点时，您都​​会更新按钮 alt 标签。相反，您还可以收听击键并在每次击键后进行更新。

至于更新查询字符串，我会让你找出最好的方法。我可以看到在其中放置了一个占位符，例如：&TB=TB_PLACEHOLDER。然后你可以做一个字符串替换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T11:20:29.037

在[代码隐藏中，](http://en.wiktionary.org/wiki/code-behind)您也可以直接添加 alt 标签，

```
button1.Attributes.Add("alt", "Search.aspx?KeepThis=true&TB_iframe=true&height=500&width=700"); 
```

# windows - Git - 切换分支（窗口）和未提交的更改

> ID：257805
> 
> 赞同：8
> 
> 时间：2008-11-03T02:29:29.033
> 
> 标签：windows, git, dvcs

我很难理解一些 git/DCVS 概念。这是发生的事情：

1.  我创建了一个 git 项目，并从 SVN 存储库中导入了它
2.  我做了一些承诺
3.  我想尝试一些东西，所以我创建了一个名为**constants-update的分支**
4.  我切换到**常量更新**分支，移动了一些文件，删除了其他文件并添加了更多
5.  我致力于这个分支
6.  现在我正在尝试使用切换到我的主分支`git checkout master`
7.  我收到此错误：**错误：您对 'src/groovy/Constants.groovy' 进行了本地更改；不能切换分支。**

我对 DCVS 的理解是，我可以随意切换分支，即使某个分支的文件比其他分支多或少，只要我提交我的文件。我尝试过提交`git commit -a`并切换到 master 分支，但我有同样的错误。

附带说明一下，当我提交时，git 警告我 LF 将被 CRLF 替换，并警告我一些尾随空格；在我提交之后，我做了一个`git status`，一堆文件总是显示为 `#modified ...`.

这是否与 git/ **windows**有关，或者我不正确理解它应该发生什么？我只想切换到我的主分支**，而不会丢失我**在另一个分支中的更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T02:47:55.017

当当前分支中有未保存的更改时，查找 git-stash 以更改分支。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T02:48:00.353

您对这应该如何工作的想法是正确的。

但是，听起来 git 在行尾方面存在问题，并且它认为您的所有文件都被修改了，即使它们没有被修改。我不在 Windows 上使用 git，但我会建议使用“core.autocrlf”选项来使 crlf 处理工作。但是，以下博客条目表明这可能不是一个好主意：[http ://weierophinney.net/matthew/archives/191-git-svn-Tip-dont-use-core.autocrlf.html](http://weierophinney.net/matthew/archives/191-git-svn-Tip-dont-use-core.autocrlf.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T10:38:19.203

我解决了[破解我的预提交钩子](http://www.dont-panic.cc/capi/2007/07/13/git-on-windows-you-have-some-suspicious-patch-lines/)`.git/hooks/pre-commit`的问题（用 a注释这些行`#`）：

```
#       if (/\s$/) {
#       bad_line("trailing whitespace", $_);
#       } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T05:23:48.373

只需在位于用户目录中的 .gitconfig 文件中使用以下选项。

[核心] autocrlf = true

它会解决这个问题。

# sql-server - Display active session in SQL Server 2005

> ID：257806
> 
> 赞同：3
> 
> 时间：2008-11-03T02:31:08.563
> 
> 标签：sql-server

> **Possible Duplicate:**
> [How to determine total number of open/active connections in ms sql server 2005](https://stackoverflow.com/questions/216007/how-to-determine-total-number-of-open-active-connections-in-ms-sql-server-2005)

In Oracle, there's a view called V$SESSION that lists all active sessions in database. Is there any similar view in SQL Server 2005?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T16:56:57.630

平原老`sp_who`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-23T16:47:44.500

从 sys.sysprocesses 中选择 *

可以在 oracle 中代替 v$session 使用

[http://silverlightedworld.blogspot.com/2009/04/vsession-for-oracle-and-sql-server.html](http://silverlightedworld.blogspot.com/2009/04/vsession-for-oracle-and-sql-server.html)

问候 Renju www.renjucool.co.nr

# sql - 使用 IN 或文本搜索

> ID：257809
> 
> 赞同：6
> 
> 时间：2008-11-03T02:33:24.267
> 
> 标签：sql, mysql, optimization

我想搜索一个表以查找一个特定字段是两个值之一的所有行。我确切地知道这些值是什么，但我想知道哪种方法是搜索它们的最有效方法：

例如，这两个值是“xpoints”和“ypoints”。我确定该字段中不会有其他值在末尾有“点”，所以我正在考虑的两个查询是：

```
WHERE `myField` IN ('xpoints', 'ypoints')
--- or...
WHERE `myField` LIKE '_points' 
```

在这种情况下，哪个会给出最好的结果？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-03T02:36:58.113

与 SQL 查询一样，通过探查器运行它以找出答案。但是，我的直觉不得不说 IN 搜索会更快。特别是在您给出的示例中，如果该字段已被索引，则只需进行 2 次查找。如果您进行了类似搜索，则可能需要进行扫描，因为您正在寻找以特定值结尾的记录。它也会更准确，因为 LIKE '_points' 也可以返回 'gpoints' 或任何其他类似的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T02:56:02.693

除非相关列中的所有数据项都以“x”或“y”开头，否则我相信 IN 总会为您提供更好的查询。如果它被索引，正如@Kibbee 指出的那样，您只需执行 2 次查找即可获得两者。或者，如果它没有被索引，则使用 IN 的表扫描大部分时间只需要检查第一个字母，而使用 LIKE 每次都必须检查两个字符（假设所有项目至少有 2 个字符）——因为第一个字符可以是任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T06:05:32.590

试试看。创建大量测试数据，另外，在myfield上尝试有无索引。*当你在做的时候，看看 LIKE ' points' 和 LIKE ' xpoint* '之间是否有明显的区别。

这取决于优化器对每个查询的处理。

对于少量数据，差异可以忽略不计。做哪个更有意义。对于大量数据，磁盘 I/O 的数量比 CPU 时间的数量更重要。

我敢打赌，如果 myfield 上有索引，IN 会比 LIKE 获得更好的结果。我也打赌'xpoint_'比'_points'跑得更快。但是没有什么比自己尝试的更好的了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T12:24:01.657

MySQL 在使用 LIKE '%foo' 或 '_foo' 之类的字符串比较时不能使用索引，但可以使用索引进行比较，例如 'foo%' 和 'foo_'。

因此，在您的情况下，假设该字段已编入索引， IN 会快得多。

如果您正在使用一组有限的可能值，则值得将该字段指定为 ENUM - MySQL 会在内部将其存储为整数，从而使这种查找更快，并节省磁盘空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T19:32:15.600

执行 IN 版本会比 LIKE 版本更快。特别是当您的通配符不在比较的末尾时，但即使在理想条件下，IN 仍然是理想的，直到您的查询接近您的最大查询插入的大小。

# delphi - 为什么 Delphi 的内存管理器在关机时会报告错误的内存泄漏？

> ID：257821
> 
> 赞同：4
> 
> 时间：2008-11-03T02:40:51.163
> 
> 标签：delphi, memory-management

我在关机时收到内存泄漏消息，说我正在泄漏某个对象的 3 个。不过，这有两个问题。

1.  它只是间歇性地发生。我可以运行我的程序，完成完全相同的一系列步骤，（打开一个数据文件，显示它，然后再次关闭），有时会显示消息，有时不会。沿着这些代码路径没有调用 random() 或其他“非确定性”逻辑。

2.  代码审查说报告的内存泄漏是不可能的；该对象仅在某个类中创建，并且在该类的析构函数中正确释放。（并且我实例化了超过三个父类的对象。并且在清理过程中不会引发异常。）

将跟踪输出添加到此类的构造函数和析构函数表明创建的每个对象都被销毁，即使内存管理器报告其他情况也是如此。所以我只能得出结论，这是一个误报。但是，将“RegisterUnexpectedMemoryLeak(self)”添加到构造函数会使消息消失。

有没有人见过这样的事情？知道可能是什么原因造成的吗？我几乎可以肯定物体*没有*泄漏，那么发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T03:52:51.220

使用新的[FastMM](http://sourceforge.net/projects/fastmm/)，在链接器选项中启用映射文件构建，定义条件符号 FullDebugMode 并重建程序。然后完成你的步骤。在程序终止时，它应该生成文件 programname__MemoryManager__EventLog.txt，其中包含有关在程序中构造泄漏对象的位置的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T03:33:14.707

创建一个您确定在同一个函数中的内存泄漏，然后观察内存管理器报告的内容。

# windows - Are there alternatives for creating large container files that are cross platform?

> ID：257832
> 
> 赞同：0
> 
> 时间：2008-11-03T02:49:13.703
> 
> 标签：windows, macos, cross-platform, file-format, container-file

Previously, I asked the [question](https://stackoverflow.com/questions/79136/how-do-i-create-a-container-file).

The problem is the demands of our file structure are very high.

For instance, we're trying to create a container with up to 4500 files and 500mb data.

The file structure of this container consists of

*   SQLite DB (under 1mb)
*   Text based xml-like file
*   Images inside a dynamic folder structure that make up the rest of the 4,500ish files

*   After the initial creation the images files are read only with the exception of deletion.

*   The small db is used regularly when the container is accessed.

Tar, Zip and the likes are all too slow (even with 0 compression). Slow is subjective I know, but to untar a container of this size is over 20 seconds.

Any thoughts?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T05:29:52.180

As you seem to be doing arbitrary file system operations on your container (say, creation, deletion of new files in the container, overwriting existing files, appending), I think you should go for some kind of file system. Allocate a large file, then create a file system structure in it.

There are several options for the file system available: for both Berkeley UFS and Linux ext2/ext3, there are user-mode libraries available. It might also be possible that you find a FAT implementation somewhere. Make sure you understand the structure of the file system, and pick one that allows for extending - I know that ext2 is fairly easy to extend (by another block group), and FAT is difficult to extend (need to append to the FAT).

Alternatively, you can put a virtual disk format yet below the file system, allowing arbitrary remapping of blocks. Then "free" blocks of the file system don't need to appear on disk, and you can allocate the virtual disk much larger than the real container file will be.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T03:24:38.360

Working on the assumption that you're only going to need read-only access to the files why not just merge them all together and have a second "index" file (or an index in the header) that tells you the file name, start position and length. All you need to do is seek to the start point and read the correct number of bytes. The method will vary depending on your language but it's pretty straight forward in most of them.

The hardest part then becomes creating your data file + index, and even that is pretty basic!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T04:05:06.687

An ISO disk image might do the trick. It should be able to hold that many files easily, and is supported by many pieces of software on all the major operating systems.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T04:44:53.473

Three things.

1) What Timothy Walters said is right on, I'll go in to more detail.

2) 4500 files and 500Mb of data is simply a lot of data and disk writes. If you're operating on the entire dataset, it's going to be slow. Just I/O truth.

3) As others have mentioned, there's no detail on the use case.

If we assume a read only, random access scenario, then what Timothy says is pretty much dead on, and implementation is straightforward.

In a nutshell, here is what you do.

You concatenate all of the files in to a single blob. While you are concatenating them, you track their filename, the file length, and the offset that the file starts within the blob. You write that information out in to a block of data, sorted by name. We'll call this the Table of Contents, or TOC block.

Next, then, you concatenate the two files together. In the simple case, you have the TOC block first, then the data block.

When you wish to get data from this format, search the TOC for the file name, grab the offset from the begining of the data block, add in the TOC block size, and read FILE_LENGTH bytes of data. Simple.

If you want to be clever, you can put the TOC at the END of the blob file. Then, append at the very end, the offset to the start of the TOC. Then you lseek to the end of the file, back up 4 or 8 bytes (depending on your number size), take THAT value and lseek even farther back to the start of your TOC. Then you're back to square one. You do this so you don't have to rebuild the archive twice at the beginning.

If you lay out your TOC in blocks (say 1K byte in size), then you can easily perform a binary search on the TOC. Simply fill each block with the File information entries, and when you run out of room, write a marker, pad with zeroes and advance to the next block. To do the binary search, you already know the size of the TOC, start in the middle, read the first file name, and go from there. Soon, you'll find the block, and then you read in the block and scan it for the file. This makes it efficient for reading without having the entire TOC in RAM. The other benefit is that the blocking requires less disk activity than a chained scheme like TAR (where you have to crawl the archive to find something).

I suggest you pad the files to block sizes as well, disks like work with regular sized blocks of data, this isn't difficult either.

Updating this without rebuilding the entire thing is difficult. If you want an updatable container system, then you may as well look in to some of the simpler file system designs, because that's what you're really looking for in that case.

As for portability, I suggest you store your binary numbers in network order, as most standard libraries have routines to handle those details for you.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T06:01:11.210

First, thank-you for expanding your question, it helps a lot in providing better answers.

Given that you're going to need a SQLite database anyway, have you looked at the performance of putting it all into the database? My experience is based around SQL Server 2000/2005/2008 so I'm not positive of the capabilities of SQLite but I'm sure it's going to be a pretty fast option for looking up records and getting the data, while still allowing for delete and/or update options.

Usually I would not recommend to put files inside the database, but given that the total size of all images is around 500MB for 4500 images you're looking at a little over 100K per image right? If you're using a dynamic path to store the images then in a slightly more normalized database you could have a "ImagePaths" table that maps each path to an ID, then you can look for images with that PathID and load the data from the BLOB column as needed.

The XML file(s) could also be in the SQLite database, which gives you a single 'data file' for your app that can move between Windows and OSX without issue. You can simply rely on your SQLite engine to provide the performance and compatability you need.

How you optimize it depends on your usage, for example if you're frequently needing to get all images at a certain path then having a PathID (as an integer for performance) would be fast, but if you're showing all images that start with "A" and simply show the path as a property then an index on the ImageName column would be of more use.

I am a little concerned though that this sounds like premature optimization, as you really need to find a solution that works 'fast enough', abstract the mechanics of it so your application (or both apps if you have both Mac and PC versions) use a simple repository or similar and then you can change the storage/retrieval method at will without any implication to your application.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-20T10:49:46.157

Check [Solid File System](http://www.eldos.com/solfs/) - it seems to be what you need.

# asp.net - 我可以从与发出请求的会话不同的会话中放弃 InProc ASP.NET 会话吗？

> ID：257843
> 
> 赞同：3
> 
> 时间：2008-11-03T03:06:43.373
> 
> 标签：asp.net, session-state, single-sign-on

我们有一个使用集中式身份验证服务器 (CAS) 进行单点登录的应用程序。我们想做单点登出，这样如果用户从一个应用程序（比如前端门户）登出，用户就会使用同一张单点登录票据自动从所有应用程序中登出。

期望每个应用程序在登录到该应用程序时向 CAS 注册一个注销挂钩 (URL)。当 CAS 收到来自其中一个应用程序的注销请求时，它会为共享 SSO 票证的所有应用程序调用注销挂钩。

我的问题是：有没有办法从不同的会话中放弃 InProc 会话？我认为，由于 HTTP 请求将来自 CAS 服务器，因此它将获得自己的会话，但我想终止的是用户的会话。我非常清楚如何使用单独的会话状态服务器来做到这一点，但我想知道是否可以使用 InProc 会话状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T13:17:39.297

哈哈，好吧...看起来你可以。我想知道自己是否有任何方法可以做到这一点，事实证明，有。

当您使用 InProc 时，InProcSessionStateStore（内部类）将会话状态保存在内部（非公共）缓存中。您可以通过反射访问此缓存并手动删除会话状态。

```
using System;
using System.Reflection;
using System.Web;

object obj = typeof(HttpRuntime).GetProperty("CacheInternal", 
    BindingFlags.NonPublic | BindingFlags.Static)
        .GetValue(null, null);

if (obj != null)
{
    MethodInfo remove = obj.GetType()
        .GetMethod("Remove", BindingFlags.NonPublic | BindingFlags.Instance, 
            Type.DefaultBinder, new Type[] { typeof(string) }, null);

    object proc = remove.Invoke(obj, new object[] { "j" + state.SessionID });
} 
```

最终结果是，下一个请求将采用相同的 SessionID，但 HttpSessionState 将为空。您仍然会收到 Session_Start 和 Session_End 事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T04:10:24.650

在进行了一些挖掘并考虑了迄今为止提供的答案之后，我想出了一个替代方案，让我可以继续使用 InProc 会话。基本上，它包括将已经处理单点登录的 HttpModule 扩展为检测到的 CAS 注销并将浏览器重定向到应用程序注销页面。

大纲：

登录：

1.  对于每个新的单点登录请求，创建一个新的 SSO cookie 并在其中编码一个唯一值以标识会话（不是会话 ID，因此不会泄露）。
2.  构造注销回调 url，用标识符编码，并将其注册到 CAS 服务器。

登出：

1.  当从 CAS 服务器接收到注销请求时，解码标识符并将其存储在应用程序范围的缓存中。这需要在缓存中固定至少足够长的时间，以使会话自然过期。
2.  对于每个请求，查找 SSO cookie 并根据缓存的已注销会话标识符检查其值。如果有命中，请删除 SSO cookie 并将浏览器重定向到应用程序的注销 url。
3.  对于每次注销，检查是否有 SSO cookie，如果有，将注销请求转发给 CAS。无论如何，放弃用户的会话，并将他们从应用程序中注销。

页面加载：

1.  检查是否存在 SSO cookie。如果没有，请重定向到退出页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T03:18:38.840

没办法。

[http://forums.asp.net/p/416094/416094.aspx#416094](http://forums.asp.net/p/416094/416094.aspx#416094)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T03:24:44.100

使用 InProc SessionState，您将无法访问数据……使用 StateServer，您仍然会有一个棘手的场景，试图访问正确的 API 以删除会话。

您很可能希望使用数据库支持的状态解决方案，如预打包的 SqlServer 状态提供程序或第三方解决方案，如 DOTSS： [http ://codeplex.com/dotss](http://codeplex.com/dotss)

使用数据库支持的解决方案，您将能够通过会话 ID 在表中查找状态记录并将其标记为已完成。这些技术将根据您选择的提供商而有所不同。

# linux - 在 Linux 系统上快速创建大文件

> ID：257844
> 
> 赞同：521
> 
> 时间：2008-11-03T03:08:02.997
> 
> 标签：linux, file, filesystems

如何在 Linux（ [Red Hat Linux ）系统上](http://en.wikipedia.org/wiki/Red_Hat_Linux)**快速**创建大文件？

[dd](http://en.wikipedia.org/wiki/Dd_%28Unix%29)会完成这项工作，但是当您需要数百 GB 大小的文件进行测试时，从驱动器读取`/dev/zero`和写入驱动器可能需要很长时间......如果您需要重复执行此操作，那么时间真的会加起来。

我不关心文件的内容，我只想快速创建它。如何才能做到这一点？

使用稀疏文件对此不起作用。我需要为文件分配磁盘空间。

* * *

## 回答 #1

> 赞同：639
> 
> 时间：2011-04-16T18:28:50.710

`dd`从其他答案来看是一个很好的解决方案，但为此目的它很慢。在 Linux（和其他 POSIX 系统）中，我们有`fallocate`，它使用所需的空间而不必实际写入它，它适用于大多数现代基于磁盘的文件系统，速度非常快：

例如：

```
fallocate -l 10G gentoo_root.img 
```

* * *

## 回答 #2

> 赞同：341
> 
> 时间：2012-08-02T14:23:41.477

这是一个常见的问题——尤其是在当今的虚拟环境中。不幸的是，答案并不像人们想象的那样直截了当。

dd 显然是首选，但 dd 本质上是一个副本，它迫使您写入每个数据块（因此，初始化文件内容）......而初始化占用了如此多的 I/O 时间。（想让它花费更长的时间？使用[/dev/random](http://en.wikipedia.org/wiki//dev/random)而不是[/dev/zero](http://en.wikipedia.org/wiki//dev/zero)！那么你将使用 CPU 以及 I/O 时间！）尽管如此，dd 是一个糟糕的选择（虽然本质上是VM“创建”GUI 使用的默认值）。例如：

```
dd if=/dev/zero of=./gentoo_root.img bs=4k iflag=fullblock,count_bytes count=10G 
```

[truncate](http://linux.die.net/man/1/truncate)是另一种选择——并且可能是最快的……但那是因为它创建了一个“稀疏文件”。本质上，稀疏文件是磁盘的一部分，其中包含许多相同的数据，而底层文件系统通过不真正存储所有数据来“欺骗”，而只是“假装”它们都在那里。因此，当您使用 truncate 为您的 VM 创建 20 GB 驱动器时，文件系统实际上并没有分配 20 GB，但它欺骗并说那里有 20 GB 的零，即使磁盘上只有一个轨道可能实际上（真的）正在使用。例如：

```
 truncate -s 10G gentoo_root.img 
```

**fallocate 是用于 VM 磁盘分配的**最终 - 也是**最好**的-**选择**，因为它本质上是“保留”（或“分配”您正在寻找的所有空间，但它不会费心写任何东西。所以，当您使用 fallocate 创建一个 20 GB 的虚拟驱动器空间时，您确实会得到一个 20 GB 的文件（不是“稀疏文件”，而且您不必费心向其中写入任何内容——这意味着几乎任何内容都可以在其中那里——有点像一个全新的磁盘！）例如：

```
fallocate -l 10G gentoo_root.img 
```

* * *

## 回答 #3

> 赞同：183
> 
> 时间：2008-11-03T03:14:02.890

# Linux 和所有文件系统

`xfs_mkfile 10240m 10Gigfile`

# Linux & 和一些文件系统（ext4、xfs、btrfs 和 ocfs2）

`fallocate -l 10G 10Gigfile`

# OS X、Solaris、SunOS 和可能的其他 UNIX

`mkfile 10240m 10Gigfile`

# 惠普-UX

`prealloc 10Gigfile 10737418240`

# 解释

尝试`mkfile <size>`myfile 作为`dd`. 使用该`-n`选项会记录大小，但在将数据写入磁盘块之前不会分配磁盘块。没有该`-n`选项，空间是零填充的，这意味着写入磁盘，这意味着需要时间。

[mkfile](http://www.manpagez.com/man/8/mkfile/)源自 SunOS，并非随处可用。大多数 Linux 系统的[`xfs_mkfile`](http://linux.die.net/man/8/xfs_mkfile)工作方式完全相同，而且不只是在 XFS 文件系统上，尽管名称如此。它包含在*xfsprogs*（用于 Debian/Ubuntu）或类似命名的软件包中。

大多数 Linux 系统也有[`fallocate`](http://linux.die.net/man/1/fallocate)，它只适用于某些文件系统（如 btrfs、ext4、ocfs2 和 xfs），但速度最快，因为它分配了所有文件空间（创建非空洞文件）但不初始化任何文件其中。

* * *

## 回答 #4

> 赞同：111
> 
> 时间：2010-08-20T12:04:37.117

```
truncate -s 10M output.file 
```

将立即创建一个 10 M 的文件（M 代表 1024 *1024 字节，MB 代表 1000* 1000 - 与 K、KB、G、GB 相同......）

**编辑：**正如许多人指出的那样，这不会在您的设备上物理分配文件。有了这个，您实际上可以创建一个任意大文件，而不管设备上的可用空间如何，因为它会创建一个“稀疏”文件。

例如，请注意此命令不会占用 HDD 空间：

```
### BEFORE
$ df -h | grep lvm
/dev/mapper/lvm--raid0-lvm0
                      7.2T  6.6T  232G  97% /export/lvm-raid0

$ truncate -s 500M 500MB.file

### AFTER
$ df -h | grep lvm
/dev/mapper/lvm--raid0-lvm0
                      7.2T  6.6T  232G  97% /export/lvm-raid0 
```

因此，这样做时，您将推迟物理分配，直到文件被访问。如果您将此文件映射到内存，您可能无法获得预期的性能。

但这仍然是一个有用的命令。例如，当使用文件对传输进行基准测试时，仍然会移动指定大小的文件。

```
$ rsync -aHAxvP --numeric-ids --delete --info=progress2 \
       root@mulder.bub.lan:/export/lvm-raid0/500MB.file \
       /export/raid1/
receiving incremental file list
500MB.file
    524,288,000 100%   41.40MB/s    0:00:12 (xfr#1, to-chk=0/1)

sent 30 bytes  received 524,352,082 bytes  38,840,897.19 bytes/sec
total size is 524,288,000  speedup is 1.00 
```

* * *

## 回答 #5

> 赞同：45
> 
> 时间：2008-11-03T05:14:34.503

其中 seek 是您想要的文件大小（以字节为单位） - 1。

```
dd if=/dev/zero of=filename bs=1 count=1 seek=1048575 
```

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2012-02-22T10:57:03.693

seek 是您想要的文件大小（以字节为单位）的示例

```
#kilobytes
dd if=/dev/zero of=filename bs=1 count=0 seek=200K

#megabytes
dd if=/dev/zero of=filename bs=1 count=0 seek=200M

#gigabytes
dd if=/dev/zero of=filename bs=1 count=0 seek=200G

#terabytes
dd if=/dev/zero of=filename bs=1 count=0 seek=200T 
```

从 dd 手册页：

> BLOCKS 和 BYTES 后面可以跟以下乘法后缀：c=1, w=2, b=512, kB=1000, K=1024, MB=1000*1000, M=1024*1024, GB =1000*1000* 1000，G=1024*1024*1024，以此类推 T、P、E、Z、Y。

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2015-09-27T01:12:17.793

要制作 1 GB 的文件：

```
dd if=/dev/zero of=filename bs=1G count=1 
```

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2012-04-25T13:54:54.073

我对 Linux 不太了解，但这是我多年前在 DC Share 上为伪造大文件而编写的 C 代码。

```
#include < stdio.h >
#include < stdlib.h >

int main() {
    int i;
    FILE *fp;

    fp=fopen("bigfakefile.txt","w");

    for(i=0;i<(1024*1024);i++) {
        fseek(fp,(1024*1024),SEEK_CUR);
        fprintf(fp,"C");
    }
} 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-12-12T10:32:59.477

您也可以使用“是”命令。语法相当简单：

```
#yes >> myfile 
```

按“Ctrl + C”停止此操作，否则它将占用您所有可用空间。

要清理此文件，请运行：

```
#>myfile 
```

将清理此文件。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-11-03T04:18:35.553

我认为您不会比dd快得多。瓶颈是磁盘；不管你怎么做，向它写入数百 GB 的数据都需要很长时间。

但这里有一种可能适用于您的应用程序。如果您不关心文件的内容，那么创建一个内容是程序动态输出的“虚拟”文件怎么样？代替 open() 文件，使用 popen() 打开到外部程序的管道。外部程序在需要时生成数据。一旦管道打开，它就像一个常规文件一样，打开管道的程序可以 fseek()、rewind() 等。你需要使用 pclose() 而不是 close()用管道完成。

如果您的应用程序需要文件具有一定的大小，则由外部程序来跟踪它在“文件”中的位置，并在到达“结束”时发送一个 eof。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-03T03:27:24.797

一种方法：如果您可以保证不相关的应用程序不会以冲突的方式使用文件，只需在特定目录中创建一个不同大小的文件池，然后在需要时创建指向它们的链接。

例如，有一个名为的文件池：

*   /home/bigfiles/512M-A
*   /home/bigfiles/512M-B
*   /home/bigfiles/1024M-A
*   /home/bigfiles/1024M-B

然后，如果您的应用程序需要一个名为 /home/oracle/logfile 的 1G 文件，请执行“ `ln /home/bigfiles/1024M-A /home/oracle/logfile`”。

如果它位于单独的文件系统上，则必须使用符号链接。

A/B/etc 文件可用于确保不相关的应用程序之间没有冲突使用。

链接操作的速度与您所能获得的一样快。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-07-27T03:22:35.143

GPL mkfile 只是 dd 的 (ba)sh 脚本包装器；BSD 的 mkfile 只是 memset 一个非零的缓冲区并重复写入它。我不认为前者会胜过 dd。后者可能会略微超越 dd if=/dev/zero 因为它省略了读取，但任何明显更好的东西可能只是创建一个稀疏文件。

如果没有一个系统调用，它实际上为文件分配空间而不写入数据（Linux 和 BSD 缺少这个，可能 Solaris 也是如此），你可能会通过使用 ftrunc(2)/truncate(1) 来扩展文件，从而在性能上得到小幅提升到所需的大小，将文件 mmap 到内存中，然后将非零数据写入每个磁盘块的第一个字节（使用 fgetconf 查找磁盘块大小）。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-12-31T00:10:12.417

这是我能做到的最快速度（速度**不快**），但有以下限制：

*   大文件的目标是填充磁盘，因此不可压缩。
*   使用 ext3 文件系统。（`fallocate`不可用）

这就是它的要点...

```
// include stdlib.h, stdio.h, and stdint.h
int32_t buf[256]; // Block size.
for (int i = 0; i < 256; ++i)
{
    buf[i] = rand(); // random to be non-compressible.
}
FILE* file = fopen("/file/on/your/system", "wb");
int blocksToWrite = 1024 * 1024; // 1 GB
for (int i = 0; i < blocksToWrite; ++i)
{
   fwrite(buf, sizeof(int32_t), 256, file);
} 
```

在我们的例子中，这是针对嵌入式 linux 系统的，它工作得很好，但更喜欢更快的东西。

仅供参考，该命令`dd if=/dev/urandom of=outputfile bs=1024 count = XX`太慢以至于无法使用。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-01-30T17:07:53.787

无耻插件：OTFFS 提供了一个文件系统，可提供任意大（嗯，几乎。Exabytes 是当前限制）文件的生成内容。它仅适用于 Linux，纯 C，并且处于早期 alpha 版本。

请参阅[https://github.com/s5k6/otffs](https://github.com/s5k6/otffs)。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-01-15T09:30:20.533

您可以使用[https://github.com/flew-software/trash-dump](https://github.com/flew-software/trash-dump) 创建任意大小且包含随机数据的文件

这是安装垃圾转储后可以运行的命令（创建一个 1GB 文件）

```
$ trash-dump --filename="huge" --seed=1232 --noBytes=1000000000 
```

顺便说一句，我创建了它

# air - 帮我 ！如何在 adobe flex 3 air 中创建自动更新

> ID：257848
> 
> 赞同：1
> 
> 时间：2008-11-03T03:12:48.120
> 
> 标签：air

我正在创建一个空气应用程序。如何在 adobe Flex 3 air 中创建自动更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T08:05:28.847

您需要使用以下 swc 文件 'applicationupdater_ui.swc'

从 Adob​​e 那里查看这个主题[http://livedocs.adobe.com/flex/3/langref/index.html?air/update/ApplicationUpdater.html&air/update/class-list.html](http://livedocs.adobe.com/flex/3/langref/index.html?air/update/ApplicationUpdater.html&air/update/class-list.html)

您会在框架文件夹 (\frameworks\libs\air) 中找到 swc 文件，因此 flexbuilder 应该会自动为您链接。您还可以查看这篇[博客文章](http://blog.multimediacollege.be/2008/12/using-the-air-15-updater-framework-in-flex/)，它提供了一个示例。

# asp.net - 使用 CSS 在字段集中标记文本对齐

> ID：257855
> 
> 赞同：0
> 
> 时间：2008-11-03T03:17:15.193
> 
> 标签：asp.net, css, forms, pixel-perfect, form-layout

在我的字段集中，我的文本框旁边（侧面）有标签，但由于某种原因，它们位于顶部而不是中间。这是我的字段集 CS​​S：

```
fieldset {
  clear: both;
  font-size: 100%;
  border-color: #000000;
  border-width: 1px 0 0 0;
  border-style: solid none none none;
  padding: 10px;
  margin: 0 0 0 0;
}

label 
{
    font: bold 12px Verdana, Arial, Helvetica, sans-serif, MS UI Gothic;
    float: left;
    width: 12em;
    text-align:right;
    vertical-align:text-bottom;
} 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T03:21:58.523

尝试调整标签元素的**line-height**属性。您可能需要增加或减少它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-03T04:05:02.850

对我来说，这是关于 css 最令人沮丧的事情...... Zack 是对的，它可能需要对行高进行一些调整，有时需要进行**很多**调整（比如 20px）。我认为浮动元素会导致行高困难？如果你想要它在行的中间，你应该设置 vertical-align:middle; 也。

希望这可以帮助...

# apache - .htaccess 要求特定 URL 的 SSL

> ID：257872
> 
> 赞同：1
> 
> 时间：2008-11-03T03:33:21.743
> 
> 标签：apache, mod-rewrite

我想强制 Apache 以下列形式对特定 URL 使用 HTTPS：

```
https://www.example.com/signup/* 
```

所以

如果有人直接访问以下任何示例 URL，Apache 会将 URL 转发到 HTTPS 等效站点。

例如

```
http://www.example.com/signup  -->  https://www.example.com/signup
http://www.example.com/signup/basic+plan  -->  https://www.example.com/signup/basic+plan
http://www.example.com/signup/premium  -->  https://www.example.com/signup/premium 
```

有谁知道怎么做？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T15:07:00.750

感谢穆拉特，

你的几乎工作了，但想出了如何让它完全工作。

以下是有效的：

```
RewriteCond %{SERVER_PORT} 80 
RewriteCond %{REQUEST_URI} ^/somefolder/?
RewriteRule ^(.*)$ https://www.domain.com/$1 [R,L] 
```

请注意，我没有在 www.domain.com rewriterule 中包含 somefolder

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T04:19:44.723

我想这就是我用的：

```
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteCond %{REQUEST_URI} ^/somefolder/?
RewriteRule ^(.*)$ https://www.domain.com/somefolder/$1 [R,L] 
```

（从[这里](http://www.besthostratings.com/articles/force-ssl-htaccess.html)）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T03:37:40.597

您可以使用[重定向](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#redirect)指令：

```
Redirect 301 /signup https://www.example.com/signup 
```

这将自动保留 URL 中 /signup 之后的任何内容。请务必仅在您的非 SSL 站点上配置此指令，否则它可能会进入递归循环！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T03:35:22.160

你应该看看[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)文档

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T17:39:14.157

我使用以下内容要求网站的结帐部分需要 SSL：

```
<Directory "/var/www/html">
        RewriteEngine on
        Options +FollowSymLinks
        Order allow,deny
        Allow from all
        RewriteCond %{SERVER_PORT} !^443$
        RewriteRule \.(gif|jpg|jpeg|jpe|png|css|js)$ - [S=1]
        RewriteRule ^checkout(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [L,R]
</Directory> 
```

例如，点击[http://www.example.com/checkout](http://www.example.com/checkout)会重定向到[https://www.example.com/checkout](https://www.example.com/checkout)

该规则将跳过通常包含在页面中的文件扩展名，这样您就不会收到混合内容警告。您应该根据需要添加到此列表中。

如果您想要多个页面，请将 RewriteRule 更改为：

```
RewriteRule ^(checkout|login)(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [L,R] 
```

当然，该目录应该与您服务器上的实际路径匹配。此页面还可以为您的特定需求提供更多信息：http: [//www.whoopis.com/howtos/apache-rewrite.html](http://www.whoopis.com/howtos/apache-rewrite.html)

我在运行 Plesk 8.6 的网站上使用它，但这无关紧要。这是在我的 vhost.conf 文件中，就像把它放在你的 httpd.conf 文件中一样。我不确定您是否需要调整任何内容才能在 .htaccess 文件中使用它，但我对此表示怀疑。如果添加到 conf 文件中，请不要忘记重新启动 apache 以重新加载配置。

如果您像我一样只想在特定页面上使用 SSL，那么您还需要一个重写规则，将您发送回常规 http 进行其余操作。您可以使用以下内容获得相反的效果：

```
RewriteCond %{SERVER_PORT} ^443$
RewriteRule \.(gif|jpg|jpeg|jpe|png|css|js)$ - [S=1]
RewriteRule !^(checkout|login)(.*)$ http://%{SERVER_NAME}%{REQUEST_URI} [L,R] 
```

如果您像我一样使用 Plesk，请记住所有非 SSL 流量都使用 vhost.conf 文件，但所有 SSL 流量都使用 vhost_ssl.conf 文件。这意味着您的第一个要求 SSL 的重写规则将进入 vhost.conf 文件，但第二个强制返回非 SSL 的规则必须进入 vhost_ssl 文件。如果您使用的是 httpd.conf 或 .htaccess，我认为您可以将它们放在同一个地方。

我还在我的博客上发布了这个教程：[Apache rewrite rules to force secure/non-secure pages](http://www.jonathandean.com/2009/03/apache-rewrite-rules-to-force-securenon-secure-pages/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T03:55:19.033

你可以用 mod_rewrite 做到这一点 -

RewriteCond %{SERVER_PORT} !^443$

重写规则 ^/signup [https://example.com/signup](https://example.com/signup)

重写规则 ^/signup/(.*)$ [https://example.com/signup/](https://example.com/signup/) $1

应该可以，虽然我没有测试过。

- 编辑 -

更正，我刚刚在我的一台服务器上尝试过这个，它对我来说很好。您可能需要仔细检查您的 mod_rewrite 配置。此外，如果您使用 .htaccess，您需要确保该目录允许覆盖。

作为旁注，这假设您的 SSL 流量来自端口 443。如果不是，您需要相应地调整重写条件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-23T14:06:34.137

.htaccess 文件通常放置在具有选项 -FollowSymLinks 的范围内，该选项会阻止重写规则。这通常是一条安全规则。

因此，通常需要像这样的更琐碎的事情：

```
<If "%{HTTPS} != 'on'">
  Redirect 301 /your/path https://www.example.com/your/path
</If> 
```

这是对 Greg Hewgill 答案的一个小改进。

# procedural - 是否有可能成功地设计和构建基于程序（命令式）的应用程序？

> ID：257873
> 
> 赞同：1
> 
> 时间：2008-11-03T03:34:05.750
> 
> 标签：procedural, imperative

您能否提供当今程序化并保持高水平完整性和效率的应用程序示例？是否有任何书籍、教程或链接提供了如何成功构建和维护命令式系统的示例？如果您要在这方面提供指导，您会就如何构建它给出什么建议？我之所以这么问，是因为 OOP 通常表现为过程编程的自然发展，但我很难相信情况总是如此。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T04:03:39.077

成功的程序应用示例？？

你的意思是，比如说，Linux 内核？BSD内核？阿帕奇网络服务器？大量的 Unix 用户空间实用程序？这样的应用？

当然，OOP 技术在软件中的组织、可维护性和抽象方面具有价值，但即使在今天，OOP 也可能只是当今编写的所有代码和应用程​​序的一小部分。

考虑使用支持 OOP 的编程语言编写的所有 Java、C# 或 VB 代码，它们使用大量 OOP 技术的唯一原因是与外部库或系统交互。同时，应用程序本身在利用 OOP 框架的同时，在设计和实现方面可能非常程序化。

OOP 是一个很好的范式，但实际上它对于许多系统中的大部分逻辑并不是真正必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T03:47:09.580

虽然我不能直接指向任何现有系统，但有大量在 OO COBOL 之前编写的遗留企业系统。许多经典的 4GL 程序都是程序性的，旨在实现高完整性的系统工程。有些写得很好，有些则不然。

书籍包括《COBOL 从微型机到大型机》、《企业 COBOL 编程指南》。

良好的命令式代码的结构提示类似于 OO 技术：正确命名、分离您的关注点、不要重复自己、单一责任原则、不要留下破损的窗口。

事实上，我只是建议阅读“实用程序员”会给大多数人在任何范式中的正确想法。

就面向业务的应用程序迁移到 OO 的一个令人信服的理由而言；过程语言允许对域逻辑使用[事务脚本](http://martinfowler.com/eaaCatalog/transactionScript.html)方法，而面向对象语言允许使用[域模型](http://martinfowler.com/eaaCatalog/domainModel.html)方法。

当然，对于简单的练习，并没有真正需要使用 OO 语言，但是一旦复杂性上升，OO 语言的可维护性就会胜过过程语言的低开销。

# html - 使用 XPath：在根节点下查找每个段落的最后一个文本节点

> ID：257877
> 
> 赞同：3
> 
> 时间：2008-11-03T03:37:02.750
> 
> 标签：html, ruby, xpath, xhtml, rexml

我想在所有 XHTML 段落的末尾修剪尾随空格。我将 Ruby 与 REXML 库一起使用。

假设我在一个有效的 XHTML 文件中有以下内容：

```
<p>hello <span>world</span> a </p>
<p>Hi there </p>
<p>The End </p> 
```

我想结束这个：

```
<p>hello <span>world</span> a</p>
<p>Hi there</p>
<p>The End</p> 
```

所以我想我可以使用 XPath 来获取我想要的文本节点，然后修剪文本，这样我就可以得到我想要的（以前的）。

我从以下 XPath 开始：

```
//root/p/child::text() 
```

当然，这里的问题是它返回的所有文本节点都是所有 p-tag 的子节点。这是：

```
'hello '
' a '
'Hi there '
'The End ' 
```

尝试下面的 XPath 会给我最后一段的最后一个文本节点，而不是每个段落的最后一个文本节点，它是根节点的子节点。

```
//root/p/child::text()[last()] 
```

这只会返回：`'The End '`

因此，我想从 XPath 得到的是：

```
' a '
'Hi there '
'The End ' 
```

我可以用 XPath 做到这一点吗？或者我应该考虑使用正则表达式（这可能比 XPath 更令人头疼）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T04:07:28.307

你的例子对我有用

```
//p/child::text()[last()]
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T06:27:33.483

万一你不知道，XSL 有一个`normalize-space()`函数可以去掉前导和尾随空格。

# c - 将 FindWindow 与多个根窗口一起使用

> ID：257879
> 
> 赞同：5
> 
> 时间：2008-11-03T03:38:51.747
> 
> 标签：c, winapi, sendmessage

所以我正在构建一个使用 win32 的 SendMessage 作为 IPC 的应用程序。

我正在使用 FindWindow 根据 className 和 windowName 获取 hWnd。在我想与与其他根 Windows 具有相同名称/类名的根（如桌面的子级）窗口交谈之前，这一切都很好而且很花哨。

**有没有可以用来选择我想要的 hWnd 的 FindWindow 的替代方法？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T04:07:47.477

你能找到你想要的窗口的子窗口吗？如果是这样，您可以使用[`FindWindowEx`](http://msdn.microsoft.com/en-us/library/ms633500.aspx)走到根窗口。如果不是，那么您需要使用[`EnumWindows`](http://msdn.microsoft.com/en-us/library/ms633497(VS.85).aspx)并确定哪些属性设置您正在寻找的根窗口，而不是具有相同标题和类的其他根窗口。

# hadoop - 是否可以在 Erlang 中执行任意数据分析？

> ID：257900
> 
> 赞同：3
> 
> 时间：2008-11-03T03:58:52.380
> 
> 标签：hadoop, erlang

我想回答有关 Erlang 中数据的问题：计数、关联消息、提供任意统计信息。我曾考虑过为此求助于 Hadoop，但是是否有可能在原始 Erlang 中构建一个解决方案来进行相当任意的数据分析，不一定通过 map/reduce 而是以某种方式？我已经看到有人这样做的一些提示，但没有明确的博客文章或这样做的示例。我知道 Powerset 的自然语言功能是用 Erlang 编写的。我也知道 CouchDB，但一直在寻找其他解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-13T02:09:32.550

是的。

对于通用计算和统计，Erlang 工作得很好。它没有针对此类工作进行大量优化，因此它很难跟上类似的数字代码，比如 MatLab、ForTran 或任何用于这项工作的主要 C 包——但对于大多数用途来说，它会做得很好。当然，如果你的代码并行化得很好，并且你有多个可用的 CPU，Erlang 会更容易赶上。

（您还提到了 map/reduce 模式；考虑到 Erlang/OTP 运行时和库，它相对微不足道。）

我和我的同事已经写了很多“原始”的 Erlang 来做计数、统计等等。我们发现它对于大多数任务来说绰绰有余。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T05:09:30.083

为什么不？

毕竟，Erlang 是图灵完备的。

更好地解释你的用例，你会得到更好的答复。

# php - 如何显示文件夹中的文件名

> ID：257901
> 
> 赞同：1
> 
> 时间：2008-11-03T04:00:21.503
> 
> 标签：php, file

我正在使用这个脚本来显示一个文件夹中的所有图像，但我不知道如何让每个图像的文件名显示在它下面。有什么建议么？

```
<?php

$dirname = "images";
$images = scandir($dirname);
$ignore = Array(".", "..", "otherfiletoignore");

foreach($images as $curimg){
    if (!in_array($curimg, $ignore)) {
        echo "<img src='images/$curimg' /><br />\n";
    }
} 
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T04:02:37.473

```
echo "<img src='images/$curimg' /><br />$curimg<br />\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T04:05:36.750

我认为 nickf 的建议是最简单的事情，你可以在没有任何 CSS 或复杂结构的情况下实现你想要的。

# workflow - 是否可以在 Erlang 中构建工作队列？

> ID：257902
> 
> 赞同：5
> 
> 时间：2008-11-03T04:00:43.000
> 
> 标签：workflow, erlang

我在 Erlang 中看到了很多聊天示例，但是列表呢，比如工作队列？如果我想构建一个工作队列系统，比如项目管理系统，是否可以在流程邮箱中重新排序消息，还是必须使用消息优先级？有没有用 Erlang 构建的工作流系统的例子？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T11:09:24.490

您不能在 Erlang 中对进程消息队列中的消息重新排序。

但是，您可以进行选择性接收，您可以首先接收您认为最重要的消息。它不完全一样，但适用于大多数目的。

这是一个例子：

```
receive
    {important, Msg} ->
        handle(Msg)
after 0 ->
    ok
end,
receive
    OtherMsg ->
        handle(Msg)
end 
```

它不同于：

```
receive
    {important, Msg} ->
        handle(Msg);
    OtherMsg ->
        handle(Msg)
end 
```

因为它总是会`{important, Msg}`在继续处理其余消息之前扫描整个消息队列。这意味着这些类型的消息将始终在任何其他消息之前处理，如果它们存在的话。这当然会带来一些性能成本（扫描整个队列两次需要更多时间）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T02:04:00.097

进程邮箱对于作业队列来说工作得很好。

只需让您的邮件包含足够的信息，以便易于编写选择性接收模式，并且您不会觉得需要重新排序邮箱内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T02:40:29.727

如果您确实需要重新排序邮件，您可以遵循看门人模式：将邮箱具体化为一个单独的进程。当您的原始进程准备好接收另一条消息时，网守可以根据您选择的任何规则计算要转发的消息。

# sql-server - 如何记录和查找最昂贵的查询？

> ID：257906
> 
> 赞同：66
> 
> 时间：2008-11-03T04:02:56.177
> 
> 标签：sql-server, sql-server-2008, profiling

sql2k8 中的活动监视器允许我们查看最昂贵的查询。好的，这很酷，但是有没有办法可以记录此信息或通过查询分析器获取此信息？我真的不想让 Sql 管理控制台打开并查看活动监视器仪表板。

我想弄清楚哪些查询写得不好/架构设计得不好，等等。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-11-03T04:35:07.533

1.  使用 SQL Server Profiler（在 SSMS 的工具菜单上）创建记录这些事件的跟踪：

    ```
     RPC:Completed
     SP:Completed
     SP:StmtCompleted
     SQL:BatchCompleted
     SQL:StmtCompleted 
    ```

2.  您可以从标准跟踪模板开始并对其进行修剪。您没有指定这是针对特定数据库还是整个服务器，如果是针对特定 Db，请包含 DatabaseID 列并将过滤器设置为您的 DB ( `SELECT DB_ID('dbname')`)。确保每个事件都包含逻辑读取数据列。将跟踪设置为记录到文件。如果您要让此跟踪在后台无人看管地运行，最好将最大跟踪文件大小设置为 500MB 或 1GB（如果您有足够的空间）（这完全取决于服务器上有多少活动，所以你将不得不吮吸它，看看）。

3.  短暂启动跟踪，然后暂停。转到文件->导出->脚本跟踪定义并选择您的数据库版本，然后保存到文件中。您现在有一个 sql 脚本，该脚本创建的跟踪比通过探查器 GUI 运行的开销要少得多。当你运行这个脚本时，它会输出 Trace ID（通常是`@ID=2`）；记下这一点。

4.  一旦您有了跟踪文件 (.trc)（由于达​​到最大文件大小而完成了跟踪，或者您使用停止了正在运行的跟踪

    执行 sp_trace_setstatus @ID，0
    执行 sp_trace_setstatus @ID，2

您可以将跟踪加载到分析器中，或使用[ClearTrace](http://www.cleardata.biz/cleartrace/)（非常方便）或将其加载到如下表中：

```
SELECT * INTO TraceTable
FROM ::fn_trace_gettable('C:\location of your trace output.trc', default) 
```

然后你可以运行一个查询来聚合数据，比如这个：

```
SELECT COUNT(*) AS TotalExecutions, 
    EventClass, CAST(TextData as nvarchar(2000))
 ,SUM(Duration) AS DurationTotal
 ,SUM(CPU) AS CPUTotal
 ,SUM(Reads) AS ReadsTotal
 ,SUM(Writes) AS WritesTotal
FROM TraceTable
GROUP BY EventClass, CAST(TextData as nvarchar(2000))
ORDER BY ReadsTotal DESC 
```

一旦您确定了代价高昂的查询，您就可以生成并检查实际的执行计划。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-11-27T11:52:12.637

以下脚本为您提供结果。

```
SELECT TOP 10 
SUBSTRING(qt.TEXT, (qs.statement_start_offset/2)+1,
((CASE qs.statement_end_offset
WHEN -1 THEN DATALENGTH(qt.TEXT)
ELSE qs.statement_end_offset
END - qs.statement_start_offset)/2)+1),
qs.execution_count,
qs.total_logical_reads, 
qs.last_logical_reads,
qs.total_logical_writes, qs.last_logical_writes,
qs.total_worker_time,
qs.last_worker_time,
qs.total_elapsed_time/1000000 total_elapsed_time_in_S,
qs.last_elapsed_time/1000000 last_elapsed_time_in_S,
qs.last_execution_time,qp.query_plan
FROM sys.dm_exec_query_stats qs
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) qt
CROSS APPLY sys.dm_exec_query_plan(qs.plan_handle) qp
ORDER BY qs.total_logical_reads DESC 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-12T02:16:53.507

我以前从未听说过此工具，但 Microsoft 提供了一组报告，这些报告非常出色地为您提供了这一点 - 包括最慢的查询。查看他们的[绩效仪表板报告](http://www.microsoft.com/downloads/details.aspx?FamilyId=1d3a4a0d-7e0c-4730-8204-e419218c1efc&displaylang=en)。

不确定它们是否与 SQL 2008 兼容，但值得一试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-03T04:12:55.643

SQL Server Profiler 能满足您的需要吗？我还没有使用 2008，所以我不知道该工具是否仍在其中，但如果是，我相信您可以设置跟踪以记录满足特定条件的查询（例如执行和驱动 CPU 的查询）一定的阈值）。

我们已经在我们的项目中使用了它，它在帮助我们解决执行不佳的查询方面做得非常好（尽管不要把它留在全时，依靠一般的 Windows 性能计数器来进行性能健康跟踪）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-20T10:55:43.657

有一个新工具， SQL Server 2008 中的[Performance Studio](http://blogs.technet.com/b/rob/archive/2008/06/20/sql-server-2008-performance-studio.aspx)，它建立在服务器自动维护的动态管理视图之上，它提供了服务器性能的概述。值得一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-14T08:42:56.880

(DELL)Quest SQL Optimizer for SQL Server 9.0 引入了 Find SQL 模块，该模块允许用户定位 SQL Server 中资源最密集的 SQL。 [https://support.quest.com/softwaredownloads.aspx?pr=268445262](https://support.quest.com/softwaredownloads.aspx?pr=268445262)

# windows - 日志文件中的 Tortoise SVN 作者丢失

> ID：257907
> 
> 赞同：3
> 
> 时间：2008-11-03T04:03:26.957
> 
> 标签：windows, svn, tortoisesvn

出于某种原因，无论我怎么做，我都无法让 TortoiseSVN 将作者添加到日志消息中。目前我们连接到一台运行 svnserve 的 PC，所以它不是 file:// 地址。

我们尝试使用 svn://Username@svnAddress, svn://svnAddress

甚至设置 svn:keywords $Author: AuthorName$

我的印象是 TortoiseSVN 在从基于文件的 repo 升级之前会使用 windows 登录名，这些确实显示了。

注意：如果这会影响任何事情，我们也会连接到域。此外，没有任何钩子脚本在起作用，并且 svnserve.conf 是默认的。

SVN 服务器使用的是 SVN 版本 1.5.1 (x86)，Windows Server 2003。

客户正在使用最新版本的 Tortoise，包括 x86 和 x64。

任何帮助将非常感激。

哦，SVN用于源代码，所以它与编程相关:)（无论如何都是半相关的）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T05:14:11.807

svn: 协议默认不做任何认证，因此不识别远程用户。由于 TortoiseSVN 不需要认证，所以没有用户被登录。

SVN 关键字与此无关：如果您将 $Author$ 放在文件中，它将*扩展*为提交的作者，而不是设置用户。在关键字语法中，不支持冒号。

所以如果你想使用 svnserve 进行身份验证，你应该首先将 anon-access 设置为 none 或 read，以强制进行身份验证提示。然后你需要设置一个密码数据库；svnserve 仅支持内置的 CRAM-MD5。我建议您先尝试使其正常工作，向所有用户分发新密码。或者，您可以尝试设置 SASL，然后允许 NTLM 身份验证 - 前提是您可以让 SASL 在您的系统上工作。

然而，或者，您可以切换到不同的协议。如果“PC”是指“Windows”，那么我猜基于 ssh 的协议被排除在外。剩下 http(s); 应该可以在 Windows 上使用 NTLM 身份验证设置 Apache，以便 NTLM 用户显示为 svn 作者。

# process - 如何融合 CMMI 和 Scrum？

> ID：257926
> 
> 赞同：17
> 
> 时间：2008-11-03T04:14:23.907
> 
> 标签：process, agile, scrum, cmmi

我在一家获得 CMMI 5 级认证的商店工作。该认证很重要，因为它使我们能够接触到某些客户和合同。我正在研究如何将 Scrum 与 CMMI 相结合。我找到了一些关于将 Scrum 与 CMMI-3 混合的信息，但其中相当一部分是“手摇的”，经不起严格的审查。具体来说，组织 KPA 似乎具有挑战性。

你有什么经验（好的和坏的）混合这两个过程？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-18T09:01:36.733

这似乎是 Carnegie Mellon 的 SEI 人员撰写的一篇有趣的论文（尽管不仅仅是关于 Scrum）：

> CMMI 和敏捷是兼容的。在项目级别，CMMI 高度抽象地关注项目做什么，而不是使用什么开发方法，而敏捷方法关注项目如何开发产品。因此，CMMI 和敏捷方法可以共存

[CMMI 或敏捷：为什么不两者兼而有之 (PDF)](http://www.sei.cmu.edu/publications/documents/08.reports/08tn003.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-03T12:32:17.927

这是[一份关于将 Scrum 引入 CMMI 5 级环境以替换大型国防和医疗保健合同的瀑布项目的结果的经验报告](http://jeffsutherland.com/scrum/Sutherland-ScrumCMMI6pages.pdf)(pdf)。

抽象的：

> 将敏捷方法与 CMMI1 相结合的项目更成功地生产出更高质量的软件，从而更有效地以更快的速度满足客户需求。系统软件工程在 CMMI 5 级工作，并使用精益软件开发作为优化软件流程的驱动程序。Systematic 的早期试点项目显示，Scrum 团队的生产力几乎是传统团队的两倍。其他项目展示了一种基于故事的测试驱动软件开发方法，将最终测试期间发现的缺陷减少了 40%。我们断言，Scrum 和 CMMI 一起带来了比单独使用更强大的适应性和可预测性组合，并建议其他公司如何将它们结合起来。

高温下，

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-05T13:07:21.630

我恰好找到一个关于这个确切主题的博客：[Agile CMMI blog](http://www.agilecmmi.com)

> 讨论结合敏捷方法和 CMMI 的起点。

它链接到几篇文章

*   [敏捷 CMMI：没有矛盾](http://www.ddj.com/architect/184415287)
*   [敏捷编程和 CMMI：不可调和的差异？](http://www.adtmag.com/article.aspx?id=10638)

它引起了人们的兴趣，所以我决定在这里分享。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-14T16:49:42.893

最近另一篇提供有关此主题的真实生活经验的文章是“系统中的[成熟 Scrum](http://www.methodsandtools.com/archive/archive.php?id=95) ”，由 Carsten Ruseng Jakobsen 和 Jeff Sutherland 合着

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-12-21T09:42:21.123

除了前面提到的文档，我还找到了另一个：[Agile Methods and CMMI: Compatibility or Conflict？](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.102.2676)本文的重点是极限编程 (XP) 以及如何将其方法应用于试图保持与 CMMI 框架兼容的组织。虽然它不是 Scrum，但它可能是一本有趣的读物。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-22T11:23:28.867

Jeff Sutherland 关于该主题的另一篇有趣的论文是“ [Scrum 和 CMMI 第 5 级：代码勇士的魔药](http://jeffsutherland.com/scrum/2006/11/scrum-supports-cmmi-level-5.html)”

据说：“结果表明，将敏捷方法与 CMMI 5 相结合的项目更成功地生产出更高质量的软件，从而更有效地以更快的速度满足客户需求。”

如果您能阅读法语，这里有一篇关于该主题的非常好的文章：[Synergies entre CMMI et les Méthodes Agiles](http://blog.octo.com/synergies-entre-cmmi-et-les-methodes-agiles/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-05-25T21:43:08.073

[请参阅http://www.processgroup.com/pgpostmar09.pdf](http://www.processgroup.com/pgpostmar09.pdf)上的简短但详细的比较

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-26T15:18:22.603

在 EuroStar 2009 会议上，Gittie Ottosen 谈到了他们如何在公司中实现敏捷。令人印象深刻的是，这家[Systematic](http://www.systematic.com)公司正在为飞机、军事等创建软件。他们按照 CMMI 5、ISO 9001 和 AQAP 150&2110 的标准来做。所以我猜敏捷可以应用于具有高法规的系统。也许尝试查找该演示文稿，并尝试从他那里获得更多信息。

# java - 如何让多个组件响应 JSF 中的单个事件？

> ID：257933
> 
> 赞同：2
> 
> 时间：2008-11-03T04:21:38.323
> 
> 标签：java, jsf

这是坐：

*   我有一个 JSF 组件，它基本上是一个“文档”列表
*   我在同一页面上有任意数量的文档查看器组件。
*   这些组件都不“了解”彼此。换句话说，它们不能在设计时配置为相互链接或类似的东西。

当用户单击文档链接时，我希望通知每个文档查看器组件。

基本上，这个想法是让文档查看者发布他们侦听文档列表组件将触发的某种类型的事件（例如“DocumentSelectedEvent”）的事实。

我可以想到不特定于 JSF 的方法，但我想知道 JSF 事件模型是否可以处理这种事情。

有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T09:15:45.717

我认为没有办法使用标准的 JSF 事件模型来做到这一点。

有什么方法可以将组件绑定到支持 bean？这样，当事件发生时，您只需浏览您的组件列表并通知它们中的每一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T14:11:24.747

您只需将组件与支持 bean 绑定并使用 ValueChangeListener 来通知支持 bean。侦听器方法可以更改与各个 UI 组件相关联的其他组件的状态。

您是否尝试以“Ajax”方式执行此操作而无需显式提交页面？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T19:39:48.750

值改变事件

我不知道您是如何实现文档列表的，但如果它是下拉列表或任何其他多项目列表组件，您可以执行值更改事件并强制提交组件的更改。然后在页面代码支持 bean 中，您可以调用查看器的方法来加载您喜欢的任何内容。

在您的 jsf 中，您只需指定您在支持 bean 中编写的值更改处理程序。

```
 /**
     * Handle document click value change.
     * 
     * @param valueChangedEvent the value changed event
     */
    public void handleDocumentSelect(ValueChangeEvent valueChangedEvent) {
        String selectedDocument = valueChangedEvent.getNewValue();

        doDocViewer1DisplayMethod(selectedDocument);
                doDocViewe2DisplayMethod(selectedDocument);

    } 
```

修改您的 jsf 标记以使用您的新值更改事件处理程序并强制提交。

```
 <f:componentTag 
   attr=xxx 
   attr=xxx 
   valueChangeListener="#{pc_BackingBean.handleDocumentSelect}"
   onChange=submit();> 
```

# macos - 我应该设计什么浏览器屏幕宽度来支持 Mac OS？

> ID：257934
> 
> 赞同：3
> 
> 时间：2008-11-03T04:23:00.800
> 
> 标签：macos, user-interface, browser-width

大多数浏览器统计数据都会向您显示屏幕的分辨率。

这对于浏览器通常全屏打开并且大多数人保持不变的 Windows 来说很好。因此，如果浏览器统计信息显示为 1024x768，您只需为浏览器 chrome 减去一点宽度。

但是，在 Mac 上，浏览器通常不会全屏打开。

mac浏览器打开时可能是什么宽度。

我正在考虑[what-is-the-best-absolute-width-for-a-webpage](https://stackoverflow.com/questions/202557/what-is-the-best-absolute-width-for-a-webpage)推荐的 960 宽度。但是我想知道这对于mac来说是否同样好？

我不确定 Apple 上次生产 1280x768 笔记本电脑或屏幕是什么时候，所以这可能不是问题。我发现大多数关于屏幕分辨率的统计数据都没有显示实际可用宽度，这让我有点沮丧。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T04:50:22.727

**设计吧，我的朋友。Apple 显示屏包含许多像素。**

一个窗口**将**在 Mac 上全屏打开，没问题。它只是在可能的情况下节省空间，这与 PC 行为不同，无论站点实际需要多少空间，它都会填满屏幕。

也就是说，Mac 没有全屏打开窗口的情况就是用户有**空余空间**的情况。所以这些是你不需要担心的情​​况。如果 Mac OS 浏览器必须全屏显示以适应网站，它会的。但是当站点只有 960px 并且用户拥有华丽的**2560x1600 影院显示器**时，它将停在 960，足以消除水平滚动条。

人们注意到这种行为的原因是因为苹果显示器通常太大，所以通常不需要全屏。Apple 在任何笔记本电脑上提供的*最小显示器是宽敞的***1280x800**。最小的 iMac 已经是**1680x1050**了。他们只会从那里变得更大。

至于选择您的尺寸，通常的考虑因素适用。发挥你的**最低公分母**。只需知道即使是普通的苹果显示器的屏幕分辨率也将与行业标准相当。如果你愿意为 PC 选择 990 或 960，**Mac 也可以接受**。

[![](https://i.stack.imgur.com/wX9E5.jpg)](https://i.stack.imgur.com/wX9E5.jpg)
[（来源：[akamai.net](http://a248.e.akamai.net/7/248/2041/1469/as-images.apple.com/is/image/AppleInc/M9177?wid=185&hei=185&fmt=jpeg&qlt=95&op_sharpen=0&resMode=bicub&op_usm=0.5,0.5,0,0&iccEmbed=0&layer=comp)）]

与我共事的大多数设计师更关心的是让 Apple 用户的设计*过于狭窄*。他们在 960 像素领域进行设计，以便它适用于更多的观众，然后他们试图找到创造性的方式来向巨型影院显示器的所有者表达一点额外的爱。

**旁注：** @Taylor Marshall 提出了一个很好的问题：“如果宽度都设置为 100% 怎​​么办？[浏览器窗口] 有多大......？”

没有任何限制，Firefox 将像 MS Windows 行为一样简单地全屏显示。Safari 会扩大到 800px 的宽度，除非宽度已经大于 800，在这种情况下它会保持该宽度并且只修改窗口高度。当然，如果没有任何硬性宽度值，那么设计就是流动布局，因此对特定宽度设计的关注点会有所改变。通常良好的流式布局，尽管可以在任何维度上正确显示，但仍被设计为在合理的窗口宽度下查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T05:01:21.880

与其担心绝对宽度，为什么不做百分比，并给它一个最小宽度，这样它在较低分辨率下就不会开始看起来太糟糕了？

最小宽度可能是您的 960 或 990 发挥作用的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T05:31:56.573

您阅读的统计数据基于访问者的实际屏幕尺寸。如果您正在寻找有关普通用户浏览器大小的统计数据，则需要查看其他地方。此外，我从不在 Windows 或 Mac OS 上全屏浏览，我认为超过 960 像素左右的设计非常烦人。（2^16+2^17+2^18+2^19）

我为[浏览器大小](http://mentalized.net/journal/2006/10/24/browser_size_does_matter_actual_numbers/)感到幸运。见第二张图表。

# iis - IIS 上的 .htaccess 或 .htpasswd 等效项？

> ID：257936
> 
> 赞同：51
> 
> 时间：2008-11-03T04:23:22.267
> 
> 标签：iis, .htaccess

有谁知道 IIS 是否有 .htaccess 和 .htpassword 的等价物？我被要求将应用程序迁移到 IIS，该应用程序使用 .htaccess 根据 .htaccess 文件的内容来控制对各种 URL 中的文件集的访问。

我做了谷歌搜索，并没有找到任何结论性的东西。我需要购买提供此功能的通用方法或工具吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-12-02T15:57:30.163

对于 .htaccess 重写： [http ://learn.iis.net/page.aspx/557/translate-htaccess-content-to-iis-webconfig/](http://learn.iis.net/page.aspx/557/translate-htaccess-content-to-iis-webconfig/)

或者尝试 aping .htaccess： [http ://www.helicontech.com/ape/](http://www.helicontech.com/ape/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T08:01:54.337

没有直接的 1:1 等价物。

您可以使用文件系统权限对文件夹或文件进行密码保护。如果您使用的是 ASP.Net，您还可以使用它的一些内置函数来保护各种 url。

如果您尝试移植用于 url 重写的 .htaccess 文件，请查看 ISAPI Rewrite：[http ://www.isapirewrite.com/](http://www.isapirewrite.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T04:34:30.840

我从未使用过它，但[Trilead](http://www.trilead.com/Products/Trilead_ISAPI_Filter_for_IIS/)是一个免费的 ISAPI 过滤器，它支持基于 .htaccess 的控制，看起来就像您想要的那样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T04:35:53.303

这是您想要的文档：http: [//msdn.microsoft.com/en-us/library/aa292114 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa292114(VS.71).aspx)

我想答案是，是的，有一个等效的东西可以完成同样的事情，并与 Windows 安全性集成。

# encoding - 代码页和编码

> ID：257938
> 
> 赞同：3
> 
> 时间：2008-11-03T04:26:25.803
> 
> 标签：encoding, codepages

在有人建议我对此进行谷歌搜索之前，我有。我只需要更清楚地了解哪些代码页和编码。

如果我使用 UTF8 编码，并使用意大利代码页和法语代码页，这是否意味着即使字节没有改变也会得到不同的字符？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T04:28:16.237

乔尔对此有一个很好的总结：
[http ://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

和不。如果我正确理解了您的问题，那并不意味着。当您将 UTF-8 转换为特定代码页时，可能只有部分字符会被转换。那些没有被转化的人会发生什么取决于你如何称呼转化。一个可能的结果是无法映射到代码页的字符将被转换为问号字符。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T06:17:20.353

编码只是数值和“字符”之间的映射。

US-ASCII 将数字 65 映射到字母 A，将 32 映射到空格，将 49 映射到数字“1”。（这些东西如何呈现是另一回事。）事实上，UTF-8 也是如此！但是还有其他值 UTF-8 对待 ASCII 的方式不同。它是一种变长编码，即一个字符可以用1、2、3或4个字节编码；普通字符通常消耗较少的字节。

包括网页在内的纯文本文件以字节序列的形式存储和传输。这些字节应该代表文本的东西。软件应用程序（如文本编辑器和 Web 浏览器）负责将这些文件中的信息呈现在屏幕上。通常他们使用库或操作系统函数。

如果软件采用与创建文件的软件不同的编码，则可能会显示错误的字符！

请注意，可以在不同编码之间进行转换；但是，如果您转换为不包含特定字符的编码，则软件必须选择使用什么来代替。这种转换通常是透明地发生的（当您使用某种编码保存文件时，您输入的任何内容都必须更改为该编码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T07:54:28.237

UTF-8 包含法语和意大利语代码页中的所有字符，但特定于语言的代码页不包含所有其他字符。

因此，您可以从每种语言中获取输入并将其转换为 UTF-8 进行存储，但如果您采用意大利语输入并将其显示为法语，则无法确定是否会获得正确的字符。

如果可以，请一直使用 UTF-8。

# jsf - 带有登录组件的 JSF 标头？

> ID：257941
> 
> 赞同：0
> 
> 时间：2008-11-03T04:29:56.263
> 
> 标签：jsf, login, custom-component

我对 JSF 和许多相关技术还很陌生。

我正在尝试制作一个具有包含徽标、导航链接和登录框的标头的网站，这样除非用户登录，否则该标头可以轻松地包含在所有站点页面中，在这种情况下不同标题将出现。类似于[livejournal](http://livejournal.com)的东西。

我研究了一些解决方案，例如创建自定义 JSF 组件来处理登录并将其与 JSP 片段和/或 Facelets 组合。但是经过大量的谷歌搜索，我还没有真正找到任何尝试制作自定义登录组件的人，而且关于创建这样的标题的信息很少。那么这真的是解决我的问题的正确方法吗？有更好的解决方案吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T09:33:41.533

我肯定会使用 Facelets，因为这基本上可以让您在每个页面上包含相同的标题。

就自定义登录组件而言 - 这取决于您如何处理登录。如果您使用 JAAS 或 Spring Security，则需要与它们集成（可以这样做）。

然而，登录标题并不难。例如，您可以执行以下操作：

```
<h:form id="loginForm" rendered="#{! loginBean.loggedIn}">
    Username: <h:inputText id="username" value="#{loginBean.username}" />
    Password: <h:inputPassword id="password" value="#{loginBean.password}" />
    <h:commandButton value="Login" action="#{loginBean.login}" />
</h:form>
<h:outputText rendered="#{loginBean.loggedIn}" value="You are logged in as #{loginBean.username}" /> 
```

# ruby - 在 Ruby 中，如何通过 RESET 中止连接？

> ID：257942
> 
> 赞同：2
> 
> 时间：2008-11-03T04:34:12.480
> 
> 标签：ruby, sockets

在任何套接字 API 中，close() 方法都会使用 FIN 关闭连接。如果我想中止与 RST 的连接，我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T13:44:05.130

使用普通的 Ruby TCPSocket，您可以通过执行以下操作打开 SO_LINGER：

```
linger = [1,0].pack('ii')
socket.setsockopt(Socket::SOL_SOCKET, Socket::SO_LINGER, linger)
socket.close 
```

# memory - 交换空间上的缓存有什么意义？

> ID：257951
> 
> 赞同：2
> 
> 时间：2008-11-03T04:48:22.653
> 
> 标签：memory, caching, buffer, swap

将东西缓存在主内存中以避免昂贵的磁盘 i/o 不是重点吗？

如果您在硬盘驱动器的交换空间中缓存内容，如何避免磁盘 i/o？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T04:51:08.983

通常，缓存使用的内存不会被换出。它将被标记为使用中。

编辑 - 是的，虚拟内存是复制到磁盘的内存块，因为 RAM 已满。为了使用它，您必须将其复制回内存（这很慢）。
缓存将最近使用的文件的副本保存在内存中，因为这比为它们返回磁盘要快。这里有一个冲突——你用于缓存的 RAM 越多，你必须换出到磁盘的其他内存就越多，假设你没有可用的内存。这不一定是坏事，您的计算机上运行的很多东西只是偶尔运行，因此将它们推送到磁盘以为照片的缓存副本腾出空间可能是有意义的。

# windows - Windows 磁盘分区间隙

> ID：257955
> 
> 赞同：0
> 
> 时间：2008-11-03T04:51:42.210
> 
> 标签：windows, filesystems, defragmentation

Windows XP 磁盘碎片整理程序报告显示了我系统上许多磁盘分区上的磁盘使用率的持续**差距**。我不是指发生的短暂的小差距。在下面的磁盘 D 中，有问题的间隙是“碎片整理”一词下的间隙。在下面的磁盘 P 中，差距是“def 之前的使用”下的差距，但差距更大。C 分区没有这个异常。大小和放置模式并不明显。就好像有一个区域，一个无人区，文件系统和碎片整理程序都避开了。这些差距在日常使用和碎片整理中仍然存在。我不相信这是页面文件的残留物——无论如何，它应该显示为绿色。回收站是空的。

有任何想法吗？

磁盘 D（20 Gig）： ![D盘](https://i.stack.imgur.com/e8HYu.jpg)

磁盘 P (40 Gig): ![磁盘 P](https://i.stack.imgur.com/20fvO.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T09:18:17.507

这可能是为[MFT](http://en.wikipedia.org/wiki/Master_File_Table)保留的空间，仅当磁盘已满时才会用于文件。这个空旷的空间让它可以生长一段时间而不会变得支离破碎。

参考：

*   [NTFS 如何为其主文件表 (MFT) 保留空间](http://support.microsoft.com/?scid=kb%3Ben-us%3B174619)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T04:59:12.663

不知道是什么原因造成的，但是 Win XP 附带的碎片整理程序是 Diskkeeper Lite，它不是很好。如果它不是由任何东西引起的，一个更好的碎片整理程序可能会消除差距。我个人使用 O&O Defrag；它不是免费的，但有 30 天的试用期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T05:09:18.057

碎片整理到绝对没有间隙的程度不一定是一件好事。一些操作系统/文件系统试图将文件尽可能紧密地打包，并尽可能不留空隙地填充。

这样做的问题是，如果任何较早的文件被更改或附加到，那么您要么留下一个早期间隙（这将倾向于分片），要么强制在下一个间隙输入额外的位（再次创建一个片段） .

当您开始出现奇怪的行为时进行碎片整理（通常它会有所帮助......即使它不应该这样做）；但是，您不需要每天都这样做，完全碎片整理的驱动器也不是特别健康驱动器的标志。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T12:06:03.737

就像上面的海报所说，那很可能是 MFT 的保留区。格式化驱动器后，大约 12.5% 的分区被保留给 MFT，如果初始分配用完，这可以根据需要增加以容纳新记录。请注意，如果相邻的连续可用空间不足以容纳扩展，则 MFT 也会碎片化。

注册。碎片整理，而不是定期手动进行碎片整理，省去麻烦并获得 Diskeeper。最新版本 ie 2008 Professional 是全自动的，并在后台使用空闲资源进行碎片整理。还有一个手动/计划的碎片整理模式，但我看不出有什么理由浪费我的时间；它在我的系统上自动运行时做得很好。

# java - Java相当于pyftpdlib？

> ID：257956
> 
> 赞同：1
> 
> 时间：2008-11-03T04:52:36.263
> 
> 标签：java, python, ftp

pyftpdlib 有没有好的 Java 替代品？我正在寻找一种易于设置和运行的嵌入式 ftp 服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-03T05:11:20.937

查看 Apache 的[FTPServer](http://mina.apache.org/ftpserver/)。

他们有一个如何将其嵌入 Java 应用程序的[示例。](http://mina.apache.org/ftpserver/embedding-ftpserver-in-5-minutes.html)

# ruby - 如何检测 Gnome 终端？

> ID：257992
> 
> 赞同：3
> 
> 时间：2008-11-03T05:32:18.743
> 
> 标签：ruby, linux, console, terminal, gnome

我正在编写一个使用 F1 键的控制台应用程序（寻求帮助）。不幸的是，虽然（KDE 的）Konsole 不使用此键，但 Gnome 终端却使用，因此我的应用程序无法访问 F1 键。我不认为有一种方法可以检测 F1 键是否已经映射到事物的 GUI 端（Gnome 终端），但如果有，那么答案将消除这个问题。:)

因此，我的下一个最佳选择是尝试检测我是否在 Gnome 终端中运行。有没有办法做到这一点？我主要对从 Ruby 中收集这些内容感兴趣，但如果它可以通过 shell 或环境变量或虚拟文件系统（/proc、/dev 等）完成，那么这就足够了。

我希望有一种可靠的方法来做到这一点，但我可以满足于“最佳猜测”方法，比如 grep 环境变量寻找线索，让我合理地假设 Gnome 终端是包装终端。

额外信息：其他密钥也被 Gnome 终端“偷走”。我打算为 Gnome 用户显示一些关于备用键的信息性消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T05:36:50.230

Googleage 透露我也许可以依靠 Gnome 终端将 COLORTERM 环境变量设置为“gnome-terminal”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-17T15:49:46.210

对于 zsh：

```
[[ "$COLORTERM" == "gnome-terminal" ]] || [[ ${$(ps -p $(ps -p $$ -o ppid=) -o cmd=):t} == gnome-terminal* ]] 
```

gnome-terminal 用于设置`$COLORTERM`，但这已被删除（在 3.12.0-67-g1d5c1b6 中）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T05:39:35.950

通常你使用 termcap info aka terminfo。这会告诉您正在使用哪种终端以及键是什么。

这是用户的选择，并且由于 Gnome 终端报告自己可能是一种 x-term，正如 Konsole 可能所做的那样，用户可能有一种方法来创建 F1 按键。因此，我怀疑两者的终端能力将被报告为等效。

对[功能键转义码](http://aperiodic.net/phil/archives/Geekery/term-function-keys.html)的调查可能会让您感兴趣，但实际上并没有解释如何使 gnome 终端（如果可能的话）产生 F1 按键。想想我很久以前使用的 Mac OS X 终端，它捕获 PageUp 和 PageDown 作为滚动条，而 Command-PageUp 和 Command-PageDown 将它们传递到终端。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T09:24:48.040

一种相当粗略的方法，如果您想将其委托给 shell - 否则，在 C 或 C++ 中，您将不得不涉足您的 /proc，如果您有一个：

```
ps x | grep `ps o ppid,fname | grep bash | grep -v grep | head -1 | awk '{print $1}'` | grep 'gnome-terminal' | wc -l 
```

如果从您自己的程序运行，例如通过 system()，您可以使用“grep”您的程序名称而不是“bash”

我知道，这绝对是“像海盗一样黑客”；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-28T08:36:55.047

fwiw，这是 gnome-terminal 中的设置；用户可以转到 gnome-terminal 菜单中的 Edit -> Keyboard Shortcuts 并更改或删除 F1 键绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-28T09:22:23.740

我只需检查我选择的终端仿真器的 $TERM，然后添加一个别名以在当前目录中生成一个新终端。

```
if [[ $TERM == 'xterm' ]] ; then
  alias nw='gnome-terminal --working-directory=$PWD'
fi 
```

# c# - C#中的异或绘图

> ID：257993
> 
> 赞同：1
> 
> 时间：2008-11-03T05:32:21.973
> 
> 标签：c#, vb6, xor-drawing

我正在尝试学习 C# .Net。

前段时间我曾在 VB 中编写过小型（爱好）模拟时钟应用程序（准确地说是编辑：VB6），我想我会在 C#.NET 中重写，作为我*学习*过程的一部分。

在 VB 应用程序中，我在 XOR Drawmode 中绘制了时钟的指针，所以我必须*移动*秒针，我只需要在之前的位置重新绘制它然后绘制当前位置 - 我不需要刷新整个 Form . 我所做的只是

```
Me.DrawMode = vbNotXorPen 
```

进而

```
Me.Line... 
```

在 VB 表单上

在 C# 中，我找不到等效的 Xor Pen Draw 模式。

我发现

```
ControlPaint.DrawReversibleLine 
```

在网上的某个地方，但我不确定是否`ControlPaint`是为了这样的目的（而且我不明白基于什么坐标系`ControlPaint`正在绘制）

在 C#.NET 中是否有等效于 XOR 绘图的方法？或者有没有更好的方法来做我正在做的事情（性能最好）

（VB 和 C# 都是我的爱好。所以如果我错了，请随时纠正我）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T06:16:53.863

.NET/GDI+ 不支持异或绘图。您必须通过使用几个本机函数的 p/invoke 调用来解决它。

有关更多信息，请参阅下面的链接

[http://www.vbaccelerator.com/home/net/code/libraries/Graphics/ZoomIn/article.asp](http://www.vbaccelerator.com/home/net/code/libraries/Graphics/ZoomIn/article.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T05:51:43.493

恕我直言，除非您的目标是一些非常慢的计算机，否则您不需要通过使用 XOR 技术来优化性能。

由于您每秒只绘制一次秒针，因此完全重绘时钟会好得多。此外，如果直接绘制，秒针会“看起来”不错，并使用设置为 Anti alias 的平滑模式以获得更清晰的外观。

为了优化性能，您可以每分钟创建一个时钟 bmp，然后在其上绘制秒针。

# php - 在 PHP 中更改时区

> ID：257994
> 
> 赞同：2
> 
> 时间：2008-11-03T05:32:34.857
> 
> 标签：php, timezone

好的，快速提问。

一台服务器正在东部时间运行。PHP 程序需要使用中央时间进行日期计算。

目前，我将这一行放在脚本的最顶部：

```
putenv("TZ=US/Central"); 
```

这是最好的方法还是有一些我不知道的 PHP 技巧？

干杯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T05:40:28.150

您可以使用[`date_default_timezone_set`](http://www.php.net/manual/en/function.date-default-timezone-set.php)并且脚本中的所有日期/时间函数都将使用它。**