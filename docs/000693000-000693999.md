# StackOverflow 问答 000693000-000693999

# git - 人们使用哪些标准设置来使用 GitHub？

> ID：693003
> 
> 赞同：0
> 
> 时间：2009-03-28T15:59:36.657
> 
> 标签：git, process, installation, github

换句话说，人们如何使用 Git？

我刚刚完成了我的第一个项目的上传，这远非一项简单的任务，无论如何，一旦事情启动并运行，什么是好的配置？

我看不出人们如何依赖 GitGUI 或命令行来完成他们的专业开发工作或更糟糕的代码直接进入浏览器 - 但我确信我在这里遗漏了一些巨大的东西。

另外，有没有比 GitGUI 更好的第三方客户端？

请赐教！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T16:05:10.060

我确实使用命令行来完成我的 Git（和 github）工作，使用 gitk 作为我的存储库浏览器（我觉得它是必不可少的）和 Emacs 作为我的编辑器。我与 github 的主要交互是推送提交，这在命令行上非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T16:08:11.160

我只使用 git 命令行，很少使用 gitk 或 tig 来查看一些精美的图形。我想我还没有进入真正的大型项目，需要像这样可视化历史。我的文本编辑器是 vim，我所有的其他工具也是基于命令行的。正如 github 指南非常清楚地解释的那样，设置遥控器很容易，这样您就可以无缝集成，甚至不需要浏览器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T16:17:24.307

我们通过命令行使用 git 来完成我们所有的工作，其中包括有许多 (10+) 开发人员的大型项目。

通常，我们在 Github 上托管一个远程 repo，在 Textmate 中工作，并保持一个终端窗口打开 cd 到我们使用 git 的应用程序目录。

这个设置工作得很好——我从来不需要使用任何 GUI 应用程序来与 git 交互。

在与其他开发人员合作时，我们唯一会遇到合并冲突是在我们在类似领域工作时，但是，定期推送到远程仓库，并且适当的分支往往可以最大限度地减少这个问题。

# java - 开源托管编程语言

> ID：693006
> 
> 赞同：5
> 
> 时间：2009-03-28T16:01:54.453
> 
> 标签：java, open-source, mono

除了 Mono 和 Java 之外，是否有任何好的、可移植的、开源的、高级的、静态类型的、命令式的、面向对象的、垃圾收集的、安全的语言/运行时具有合理的性能？Mono 很好，但它是 Microsoft 的技术，我有点害怕使用它（我不确定这种恐惧是否合理）。Java 的问题在于它太简单了（没有无符号数据类型，没有结构等）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T16:08:03.767

Mono 不是微软的技术。.NET 是，但 Mono 不是 - Mono 是 ECMA-334 和 ECMA-335 国际标准的开源实现。是的，它们起源于微软，但 Mono 本身*并不是*微软的技术。

当然，并不是说 Mono 是一种语言 - C# 是这种语言。但是*语言*不是真正的开源或不是 - 实现是。

听起来你可能对 C# 有一种非理性的恐惧——对 Java 也是如此。我当然希望在 Java 中看到一些东西（而且我更喜欢 C#），但仍然完全有可能在其中编写非常重要的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T16:22:18.693

[埃菲尔](http://en.wikipedia.org/wiki/Eiffel_(programming_language))满足您的所有要求

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T16:25:44.067

在 CLR 上，有[Boo](http://boo.codehaus.org/)。

> Boo 是一种新的面向对象的静态类型编程语言，用于公共语言基础架构，具有受 python 启发的语法，并特别关注语言和编译器可扩展性

[Boo Manifesto](http://boo.codehaus.org/BooManifesto.pdf)是一个很好的起点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T16:27:51.583

好吧，在 java 中没有无符号数据类型很少被认为是一个问题。

但是 Lisp 呢？它是引入垃圾收集的语言，而且可能是最强大的语言。

查看 Peter Norvig（谷歌的研究主管）的性能[比较](http://norvig.com/Lisp-retro.html)。你可能会惊讶于 Lisp 在某些领域甚至胜过 C++ 和 Java。

![替代文字](https://i.stack.imgur.com/u246B.jpg)

然而 Lisp 似乎不是主流语言 - 我[想知道](http://www.paulgraham.com/iflisp.html)为什么会这样？因为它是一种极简主义——它可能无法被任何当前或未来的语言所击败。

（我猜想是什么让 C# 或 Java 如此流行的不仅仅是语言，还有库。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-28T16:29:06.477

带有[垃圾收集器](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)的 C++ ？尽管您对 Java 的问题并不是什么大问题（除非您可以详细说明为什么需要这些东西，但从表面上看，这些论点通常不是很合理，但有时确实如此）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-28T17:29:43.913

我想指出[Vala](http://live.gnome.org/Vala)，它是一种基于 C# 语法的语言，但它的目标是 C 编译器（类似于 Eiffel）和轻量级的自托管运行时。但是，它缺乏垃圾收集。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T16:50:45.707

你怎么能说java太简单了？

好的，开发 Java 的原因之一是使其比具有 900 多页规范的 C++ 更简单。但是，它比 C 复杂得多。

大约 10 年前，我参加了[Les Hatton](http://www.leshatton.org/)的一门课程，他研究了如何让你的 C 程序更安全地使用。他争辩说，几乎没有人能记住 140 页的 C 标准，所以要理解像 C++ 这样的东西会异常困难。

当然，您的目标可能不需要安全，但如果您这样做，请记住这一点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-18T13:10:51.267

[scala](http://www.scala-lang.org/node/25)没有 java 那么冗长，它可以在 java 运行的任何地方运行，因为它编译为 java 字节码。twitter 在 scala 中重新实现了他们的一些核心基础设施。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-28T16:17:16.350

总有 Python 和 Ruby

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-28T16:38:22.273

首先，Mono 不是微软的技术。其次，只有两个具有上述特性的严肃虚拟机 (VM) - .Net/Mono 和 Java。但是，抛开静态类型语言的要求，您可以关注新推出的[Parrot 虚拟机](http://www.parrot.org)（[关于 Parrot 的维基百科文章](http://en.wikipedia.org/wiki/Parrot_virtual_machine)）。

当然，Ruby、Python Erlang等也是跨平台VM（针对单一动态语言）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-28T16:51:55.567

你可以看看 D 编程语言。

但说实话？我建议远离单声道/C#。为什么？很多原因...

此外，出于实际目的，请使用 Java 或 C++。

Java 与 C# 一样好，即使它有点不同。C++ 也很好，因为 99% 的 GC 问题都是使用引用计数解决的，所以......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-28T21:39:40.037

如果你想学习这个以便能够更适合工作，我建议你考虑 .NET（如果你想去微软平台）或 Java（如果你想去平台独立），并进行大量编码。两者都是非常大的平台！

其他任何东西都是只在少数地方使用的小众语言，这可能非常好，但不太可能让你在任何地方找到工作，除了那几个地方。

# asp.net - Application_Start 在 ASP.NET Web 应用程序中未命中

> ID：693020
> 
> 赞同：9
> 
> 时间：2009-03-28T16:08:48.540
> 
> 标签：asp.net, visual-studio-2008, events, web-applications, global-asax

我正在尝试在 ASP.NET Web 应用程序的 global.asax.cs 文件中调试某些内容，并在 Application_Start() 事件中设置了一个断点，但是当我在 VS2008 中启动 Web 应用程序时，该事件没有被触发。我的目标是 3.5 框架。

什么可以阻止此事件被触发？或者我怎么可能把项目搞砸了，以至于这个事件不再被连接起来？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-28T16:18:08.860

在 global.asax 文件中调试新编写的代码的一个简单技巧是保存 web.config 文件。每次保存 config.file 时，应用程序都会停止并启动。

您可以在此博客条目中找到有用的信息

[解决方法：在 Visual Studio 中使用 ASP.Net Web 服务器调试 Global.aspx.cs Application_Start()](http://blogs.msdn.com/webdevtools/archive/2007/12/13/workaround-debugging-global-aspx-cs-application-start-with-asp-net-web-server-within-visual-studio.aspx)

> 这背后的原因是我们不会在每次调试运行后终止 ASP.Net Web 服务器进程，因此每次都不会触发 Application_Start()。我们这样做是有充分理由的...启动 ASP.Net Web Server 进程是一项昂贵的任务，并且在大多数情况下，在每次调试后回收此进程都会对您的性能产​​生不利影响...如果您不想调试您的 Application_Start() 方法，那么您可能不需要重新启动进程并在大多数情况下节省性能......

建议的解决方法之一：

> 您可以转到 Web 应用程序的属性页面并启用编辑并继续，如下所示：

[![替代文字](https://i.stack.imgur.com/qfgmA.png)](https://i.stack.imgur.com/qfgmA.png)

（来自 Visual Web Developer 团队博客）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-28T16:14:01.630

如果我没记错的话，Application_Start 在调试器连接到应用程序之前运行。

尝试执行其他操作来检查 Application_Start 方法是否运行，例如设置应用程序变量：

```
Application("app") = "started" 
```

然后在页面中显示应用程序变量，看看是否设置了。

# latex - 重置页面格式？

> ID：693022
> 
> 赞同：0
> 
> 时间：2009-03-28T16:10:46.240
> 
> 标签：latex

我目前正在将乳胶与书籍文档类一起用于大型 CS 项目。现在大约有 150 页，但我注意到一些非常奇怪的地方。

随机大约在文档进行到一半时，页面格式中断。当我做一个

```
\chapter{newchapter} 
```

大约进行到一半时，它在它和所有部分之间创建了大约一页空间。例如：

好的：

```
PAGEHEADER

CHAPTER

SECTION #1
 Text goes here 
```

这工作正常，直到文档进行到一半，当这开始发生在所有以下章节/部分时：

坏的：

```
PAGEHEADER

CHAPTER 2

SECTION #1

Text goes here. 
```

我不知道为什么会发生这种情况，但是没有多少`\newpage`分页可以解决这个问题。直接在它之前的部分有很多嵌入的 PNG，但我不明白为什么这会导致格式问题。

在玩一些随机`\setlength`命令时，我设法有所作为，但不是真的。

有没有办法强制文档重置其格式？

*编辑*

所以我想通了，我`\newpage`在文本之后做了一个`Section1`并解决了问题，似乎乳胶试图将第一部分和下一部分与图像分组。我不知道为什么，但它有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T16:19:12.727

我的第一个嫌疑人是png的。要确认，请注释掉图像包含行并检查格式。图像一直是使用乳胶的弱点。

# post - 如何使用 PHP 登录服务

> ID：693045
> 
> 赞同：0
> 
> 时间：2009-03-28T16:25:27.313
> 
> 标签：post, methods, registration

我想使用 PHP（不使用其 API）登录服务（站点）如果服务登录是使用 a 并且方法是“GET”，我会使用

Service.com/signin.php?username=xxxx&password=xxxx

现在，有一个 POST 方法，我该怎么做？

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T17:15:46.617

[您可以使用 PHP 的cURL](http://php.net/curl)函数发送 POST 请求。

相关选项是：

*   CURLOPT_POST
*   CURLOPT_POSTFIELDS

# c# - 使用 WCF 实现观察者模式

> ID：693050
> 
> 赞同：3
> 
> 时间：2009-03-28T16:26:53.083
> 
> 标签：c#, .net, asp.net, wcf, web-services

当我第一次发布这个问题时，我的 Web 服务和应用程序控制器之间存在强耦合，其中控制器需要向服务打开多个线程，并且当它接收到返回的数据时，它必须对返回的数据进行大量处理并将其合并到一个数据集。我不喜欢客户端在准备好使用之前必须进行如此多的处理和合并返回的数据并希望将该层移动到服务并让服务向供应商打开异步线程并合并结果的事实在将它们返回给客户之前。

我遇到的一个挑战是我不能等到所有线程都完成并合并结果，我必须开始接收可用的数据。这要求我在服务上实现一个观察者模式，以便当新的结果集合并并准备好使用并将它们发送到应用程序时它会通知我的应用程序。

我一直在寻找如何在 ASMX webservices 或 WCF 上执行此操作，到目前为止，我发现使用 WCF 实现它，但该线程始终开放以寻求建议和改进。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T17:40:39.863

好的，我的问题的解决方案来自[WCF](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)

除了 ASMX Web 服务的经典请求-回复操作外，WCF 还支持其他操作类型，例如：单向呼叫、双工回调和流式传输。

不难猜，双工回调就是我要找的。

双工回调只是允许服务对客户端进行回调。在服务器上定义了一个回调合约，并且客户端需要在每次调用时提供回调端点。然后由服务决定何时以及多少次使用回调引用。

只有支持双向的绑定才支持回调操作。WCF 提供 WSDualHttpBinding 以支持通过 HTTP 的回调（NetNamedPipeBinding 和 NetTcpBinding 也存在回调支持，因为 TCP 和 IPC 协议支持双工通信）

这里要注意的一件非常重要的事情是，双工回调是非标准的纯 Microsoft 功能。这不会对我当前的任务造成问题，因为我的 Web 服务和应用程序都在 Microsoft ASP.NET 上运行

[对WCF 服务进行编程](https://rads.stackoverflow.com/amzn/click/com/0596521308)让我在 WCF 上有了一个良好的开端。它超过 700 页，深入探讨了所有 WCF 概念，并有专门的章节介绍回调和其他类型的操作。

我在网上找到的其他一些好资源是；

[Windows Communication Foundation (WCF) 截屏视频](http://social.msdn.microsoft.com/content/en-us/msft/netframework/wcf/screencasts)

[MSDN 网络广播：Windows Communication Foundation 自上而下](http://msevents.microsoft.com/CUI/WebCastEventDetails.aspx?culture=en-US&EventID=1032344313&CountryCode=US)

[网络服务软件工厂](http://www.codeplex.com/servicefactory)

[WCF 的服务工厂](http://msdn.microsoft.com/en-us/magazine/cc163481.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T00:32:39.763

这听起来像是 Windows Workflow Foundation 的完美用例。您可以轻松创建工作流程以从每个供应商处获取信息，然后在准备好时合并结果。它更干净，WF 会为你做所有的异步工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T07:43:03.917

我不太确定这里是否需要双工... IMO，带有回调的标准异步调用应该足以获得数据传递的通知。

最大的问题是什么？如果您谈论的是异步等，那么通常我们谈论的是将数据发送到客户端所花费的时间。这是由于纯粹的数据量吗？还是在服务器上生成数据的复杂性？

如果是数据量，那么我可以想到许多显着提高性能的方法 - 尽管其中大多数都涉及使用 DTO 对象（不是`DataSet`/ `DataTable`，这似乎暗示在问题中）。例如，[protobuf-net](http://code.google.com/p/protobuf-net/)显着减少了传输数据所需的数据量和处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T17:22:51.967

实现此目的的方法之一是**异步**调用您的 WS ( [http://www.stardeveloper.com/articles/display.html?article=2001121901&page=1](http://www.stardeveloper.com/articles/display.html?article=2001121901&page=1) , [http://www.ondotnet.com/pub/a/ dotnet/2005/08/01/async_webservices.html](http://www.ondotnet.com/pub/a/dotnet/2005/08/01/async_webservices.html)），然后在回调中更新 GUI。

但是，如果查询数据的时间过长，您可能会遇到超时问题。例如，如果供应商的网站之一出现故障或速度非常慢，这可能意味着整个查询可能会失败。如果您在客户端的业务逻辑进行合并而不是 WS 进行合并，也许会更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T11:22:45.713

不确定此解决方案是否适合您的特定任务，但无论如何：

1.  向您的 WS API 添加分页参数（int pageNumber、int pageSize、out int totalPages）
2.  添加一个将请求详细信息（可能是哈希值）与输出数据相关联的短期 TTL 缓存

当您的应用程序请求第一页时，一旦准备好就将其返回并将所有收集/合并的数据放入缓存，以便在需要下一页时您可以使用已经准备好的内容。

但请注意，您不会获得最新数据，请谨慎配置缓存重新加载间隔。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-02T13:33:06.860

在您的场景和技术中存档的绝对最佳方式是在您的 Web 应用程序/库与您的 Web 服务之间使用某种令牌，并且您的控制器需要有一个线程来检查是否有新结果等。但是请注意，您将需要从您的 WS 中获取完整的数据，因为它的合并可能会导致从初始响应中删除项目。

或者我仍然认为使用 WCF Webservices 从控制器处理线程会更好

# windows - 如何创建/编写复杂的语音快捷方式？（在远景中）

> ID：693055
> 
> 赞同：1
> 
> 时间：2009-03-28T16:29:35.527
> 
> 标签：windows, automation, windows-vista, speech

有 MS Vista 挂钩来创建这样的东西吗？

*   “我有一个想法” => 弹出我喜欢的想法经理
*   "commit $1" => 为项目 $1 打开 subversion 的提交窗口

对于热键，Microsoft 提供了一个很棒的 AP​​I。但我想用语音 API 做这样的事情。

我可以用脚本/配置/程序做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T01:54:02.017

绝对地。Windows 语音识别宏是实现此目的的好方法。它们允许您编写响应给定命令的小脚本。希望这可以帮助。

[http://www.microsoft.com/downloadS/details.aspx?FamilyID=fad62198-220c-4717-b044-829ae4f7c125&displaylang=en](http://www.microsoft.com/downloadS/details.aspx?FamilyID=fad62198-220c-4717-b044-829ae4f7c125&displaylang=en)

有关宏的一些示例：
[http ://code.msdn.microsoft.com/wsrmacros/Release/ProjectReleases.aspx?ReleaseId=1453](http://code.msdn.microsoft.com/wsrmacros/Release/ProjectReleases.aspx?ReleaseId=1453)

还有一个 ms-speech 雅虎组，经常讨论各种宏：
[http ://tech.groups.yahoo.com/group/ms-speech/](http://tech.groups.yahoo.com/group/ms-speech/)

# ruby-on-rails - 如果我在不同的子目录中有多个控制器，如何使用 redirect_to？

> ID：693059
> 
> 赞同：4
> 
> 时间：2009-03-28T16:36:07.710
> 
> 标签：ruby-on-rails, ruby

我创建了一个小应用程序来学习 RoR。（图书数据库）它由一个只读区域和一个读写管理区域组成。

在我让管理功能首先工作后，我将控制器移动到一个子目录并创建了只读控制器。

现在，当我在管理区域更新一本书时，该`redirect_to`功能会重定向到只读区域。

我错过了什么？

这是我正在使用的代码：

```
class Admin::BooksController < ApplicationController
  <snip>
  def update
    @book = Book.find params[:id]
    respond_to do |format|
      if @book.update_attributes params[:book]
        flash[:notice] = "Book updated"
        format.html { redirect_to @book }
        format.xml { head :ok }
      else
        <snip>
      end
    end
  end
  <snip>
end 
```

此更新本身有效，但它会将我重定向到`/books/1`，但我希望它重定向到`/admin/books/1`. 我可以硬编码正确的路径，但我想这不是很好的风格。

什么是正确的方法？

PS：如果您需要更多信息，请发表评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T17:03:05.617

您告诉它重定向到 book，因为您正在使用 rails 内置的神奇识别它应该对 @book 对象做什么（这是构建一个 url 以使用 book 控制器显示书籍。

```
format.html { redirect_to @book } 
```

如果您希望它去其他地方，您需要使用哈希明确说明您希望它去哪里[`url_for`](http://api.rubyonrails.org/classes/ActionController/Base.html#M000624)

```
format.html { redirect_to :controller => 'admin/book', :action => 'show', :id => @book   } 
```

或使用 klew 指出的路径。

所以更多细节 -

`redirect_to (@book)` 或者

```
redirect_to  book_path(@book) 
```

都是这个的捷径：

`redirect_to :controller => book, :action => 'show', :id => @book.id`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T17:14:13.950

Rails 根据您的 routes.rb 为您创建 url 助手。如果你有命名空间，那么你可以使用这个：

```
admin_book_path(@book)        # admin/books/2
admin_books_path              # admin/books
edit_admin_book_path(@book)   # admin/books/2/edit 
```

等等。

另一种方法是使用它为您的控制器自动创建的[resource_controller](http://github.com/giraffesoft/resource_controller/tree/master)，并在需要时提供一些修改它的方法。它还为您提供了一些有用的 url 助手

```
collection_path               # admin/books
object_path                   # admin/books/2 
```

当您在视图中使用上述帮助程序时，如果您在其中一个，它会生成带有命名空间的 url，否则会生成没有命名空间的 url。

resource_controller 并不完美，但在大多数情况下，它运行良好并节省了大量工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T20:17:24.417

您还可以传递一个数组来重定向，其中第一个元素是表示命名空间的符号，第二个元素是对象。

```
redirect_to [:admin_book, @book] 
```

您也可以将它用于 form_for、link_to 和任何其他需要路径的助手。

# unix - 索拉里斯。xterm显示问题

> ID：693061
> 
> 赞同：1
> 
> 时间：2009-03-28T16:36:21.063
> 
> 标签：unix

我通过 SSH 从我的 linux 机器连接到 solaris (10) 服务器。

但是，当我尝试使用 "xterm" 打开另一个终端时，它不起作用。

我将 DISPLAY 环境变量设置为 127.0.0.1:0.0，但它给出了以下错误：xterm Xt

> 错误：无法打开显示：127.0.0.1:0.0

请提出解决方案来纠正这个问题。

谢谢

-麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T17:15:54.587

那是目标机器上 X 服务器的地址。您需要在您正在工作的客户端计算机上寻址 X 服务器。最*简单*的方法是只使用 ssh -X 或 -Y，（参见*man ssh(1)*）作为

> **客户端**：ssh -Y solaris
> 
> > *为了连接到远程机器；你也需要登录信息*

这只是建立了一个 X 连接，通过 ssh 建立隧道。

否则，您可以手动完成

> **客户端**：
> $ echo $DISPLAY
> 客户端：3:4
> 
> > *记住它不是*总是* 0.0*
> 
> $ xhost +solaris
> 
> > *您必须允许来自远程机器的连接*
> 
> $ ssh 太阳能
> 
> > *设置一个远程 shell，你仍然需要 ssh 登录信息*
> 
> **solaris** :
> $ 出口显示客户端：3.4
> 
> > *确保它是您正在使用的“客户端”上的服务器*
> 
> $ xterm
> 
> > 这现在应该为您提供“客户端”上的“solaris”xterm 窗口

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T17:58:09.227

正如查理提到的，连接时使用*ssh -X 主机名*。

如果一切都失败了，请在您的远程机器上输入*xhost + 。*希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T17:14:44.747

将显示设置为您的 linux IP 地址，而不是 localhost。

127.0.0.1 是 localhost ：因此在 Solaris 服务器上，它是服务器本身。

# python - 如何在 Python 代码中找到未使用的函数？

> ID：693070
> 
> 赞同：69
> 
> 时间：2009-03-28T16:42:42.107
> 
> 标签：python, refactoring, dead-code

因此，您在一个相当庞大的项目中存在一些遗留代码。如何查找和删除死函数？

我看过这两个参考资料：[Findused code](https://stackoverflow.com/questions/245963)和[Tool to find unused functions in php project](https://stackoverflow.com/questions/11532)，但它们似乎分别特定于 C# 和 PHP。

是否有 Python 工具可以帮助您找到源代码中其他任何地方都没有引用的函数（尽管有反射/等）？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-03-22T15:06:44.297

在 Python 中，您可以使用动态或静态代码分析器找到未使用的代码。动态分析器的两个示例是[`coverage`](https://coverage.readthedocs.io/en/6.0/)和[`figleaf`](https://ctb.github.io/figleaf/doc/)。它们的缺点是您必须运行代码的所有可能分支才能找到未使用的部分，但它们也具有您获得非常可靠的结果的优点。

Alternatively, you can use static code analyzers that just look at your code, but don't actually run it. They run much faster, but due to Python's dynamic nature the results may contain false positives. Two tools in this category are [`pyflakes`](https://pypi.org/project/pyflakes/) and [`vulture`](https://pypi.org/project/vulture/). Pyflakes finds unused imports and unused local variables. Vulture finds all kinds of unused and unreachable code. (Full disclosure: I'm the maintainer of Vulture.)

The tools are available in the Python Package Index [https://pypi.org/](https://pypi.org/).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T19:21:31.260

我不确定这是否有帮助，但您可以尝试使用[coverage](http://nedbatchelder.com/code/modules/coverage.html)、[figleaf](http://darcs.idyll.org/~t/projects/figleaf/doc/)或其他类似模块，它们会记录在您实际运行脚本/应用程序时使用了源代码的哪些部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T17:11:40.527

由于 python 代码的呈现方式相当严格，基于 regex 寻找的函数列表会很难`def function_name(..)`吗？

然后搜索每个名称并计算它在代码中出现的次数。它自然不会考虑评论，但只要您查看少于两个或三个实例的函数......

这有点斯巴达，但听起来像是一个不错的困周末任务=）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T19:44:15.027

除非您知道您的代码使用反射，如您所说，否则我会选择一个简单的 grep。不要低估 vim 中星号的功能（搜索文件中光标下的单词），尽管这仅限于您当前正在编辑的文件。

您可以实施的另一个解决方案是拥有一个非常好的测试套件（不幸的是很少发生），然后用弃用例程包装例程。如果您得到弃用输出，则表示该例程已被调用，因此它仍在某处使用。这甚至适用于反射行为，但当然，您永远无法确定在执行例行调用时是否没有触发这种情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-26T20:54:24.177

它不仅搜索函数名称，还搜索所有未使用的导入包。您需要搜索所有导入包（包括别名）的代码并搜索使用的函数，然后从每个包创建特定导入的列表（示例而不是 import os，替换为 from os import listdir、getcwd、... ...)

# php - CakePHP 中的 Simpletest 缺失表

> ID：693071
> 
> 赞同：3
> 
> 时间：2009-03-28T16:42:52.920
> 
> 标签：php, cakephp, simpletest

我正在使用 cakePHP，并且正在使用 Simpletest 作为测试套件。每当我对模型进行测试时，都会出现错误：

```
Missing Database Table
Error: Database table account_types for model AccountType was not found." 
```

（随便）

有谁知道如何解决这个问题？

我的猜测是没有创建固定装置或类似的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T20:44:00.157

找到了我的特定问题的答案。在实际的测试用例文件中（我的在 app->tests->cases->models 中），使用的固定装置不会自动生成到 $fixtures 变量中。

对此的简单解决方案是，每当出现“缺少数据库表”错误时，我会确保将未找到的数据库名称（实际夹具）放在测试文件的 $fixture 变量中。

因此，可以说未找到 account_types。在我运行的实际测试用例中，$fixtures 变量所在的位置，我会这样做：

```
var $fixtures = array('whatever_fixtures_where_already_here', 'name_of_missing_fixture', 'name_of_another_missing_fixture'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-18T20:15:53.360

您将直接使用的所有夹具必须在夹具数组中，并且还必须为与夹具数组中的夹具相关的每个模型创建夹具（hasMany、belongsTo 等）

# java - 游戏逻辑问题

> ID：693072
> 
> 赞同：1
> 
> 时间：2009-03-28T16:45:10.510
> 
> 标签：java, logic

我正在制作一个 noughts and crosses 游戏（tic tac toe），在我的逻辑类中，我用 2d 数组表示游戏的状态，但这是问题所在，我像这样检查数组

```
 if(gameModel[0][0] == gameModel[1][1] && gameModel[0][0] == gameModel[2][2]){
     return true;
    }
 if(gameModel[2][0] == gameModel[1][1] && gameModel[2][0] == gameModel[0][2]){
     return true;
    } 
```

依此类推，对于所有 8 个条件，但是，数组在开始时使用 0 的所有值进行初始化，因此它总是找到三个匹配的值，我怎样才能解决这个问题而不必更改我的整个代码

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T16:50:39.750

在这种情况下，您只需要添加一个检查是否设置了值：

```
if (   gameModel[0][0] == gameModel[1][1] 
    && gameModel[0][0] == gameModel[2][2] 
    && gameModel[0][0] != 0) {
 return true;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T00:32:15.193

有一件事让我大吃一惊……你为什么使用整数而不是类来表示这个？的确，这是一个简单的游戏，但 Piece 类似乎作为一个相当明显的类跳出来了。

此外，使用 int 你真的有 3 个状态，大概是这样的：

```
0 = empty
1 = X
2 = Y 
```

所以你应该在检查它们是否是相同的值之前检查 0（空），它会更快（谁真的在乎，这不需要很快），并且更符合逻辑意义（是正方形空吗？如果是这样，那么不要费心检查方块是否保持相同的值）。

即使是这样简单的事情，尤其是当你刚开始的时候，试着拥抱 OOP，这是一种不同的思维方式，需要练习，所以尽可能多地练习！

# php - 如何使用 netbeans 和 Xdebug 调试 PHP

> ID：693074
> 
> 赞同：15
> 
> 时间：2009-03-28T16:46:11.820
> 
> 标签：php, debugging, netbeans, xdebug

我最近尝试使用[Netbeans](http://www.google.co.uk/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.netbeans.org%2F&ei=n1POSZS6HsONjAfRzKXcCQ&usg=AFQjCNGXEZrzV0QrmVNuy79PoebH7M4D7w&sig2=n-DjKReZuy7Us_MsWwNBbg) 6.5，因为它在 Smashing 杂志的 IDE 评论中获得如此高的评价。[http://www.smashingmagazine.com/2009/02/11/the-big-php-ides-test-why-use-oneand-which-to-choose/](http://www.smashingmagazine.com/2009/02/11/the-big-php-ides-test-why-use-oneand-which-to-choose/)

我从 Notepad++ 切换的主要原因是我希望能够调试我的代码并通过它进行设置。

[我已按照供应商http://xdebug.org/](http://xdebug.org/)和 netbeans 网站上有关如何安装 xdebug 的说明进行操作。[http://www.netbeans.org/kb/docs/php/debugging.html#gettingReady](http://www.netbeans.org/kb/docs/php/debugging.html#gettingReady)但无济于事。

**它是如何完成的，还有其他人在 netbeans 中进行调试吗？**

*（我的设置是：Windows XP、Wamp server 2.0、PHP 5、Netbeans 6.5.1）*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-22T16:06:41.917

在 php.ini 中添加这一行很重要：

```
xdebug.idekey="netbeans-xdebug" 
```

注意：在 NetBeans 中，转到设置并查看 xdebug 设置的位置。查找该会话 ID。就我而言，它是 netbeans-xdebug。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T12:26:04.597

嗯，对我来说，netbeans 是 php 调试开箱即用的第一个 ide。

xdebug 是否显示在 phpinfo 中？如果是这样，它应该使用默认设置。唯一需要的是：

```
xdebug.remote_enable=on 
```

因此，如果未启用，请将其放入您的 php.ini 文件中，重新启动 apache，调试应该可以工作。

如果没有，您将不得不提供更多信息让我帮助您。

sy

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T20:32:26.687

从那以后，我发现 WAMP 在与 Mod_rewrite 和 cURL 一起安装时无法应对 Xdebug。

这是一个**已知错误**并且每次都崩溃。

[http://phphints.wordpress.com/2008/10/24/wampserver-phpini-settings-for-use-with-xdebugdll-pear-and-silverstripe-cms-framework/](http://phphints.wordpress.com/2008/10/24/wampserver-phpini-settings-for-use-with-xdebugdll-pear-and-silverstripe-cms-framework/)

不幸的是，我也在使用这两个库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T09:15:36.537

xdebug 给出 curl 或 mod_rewrite 的问题并不是一个已知问题。我知道的唯一问题是 Vista 上的 Xdebug。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-30T19:21:13.410

您可以在这里看到： [http](http://ruilima.com/2010/11/ambiente_de_desenvolvimento_php_netbeans_xdebug/) : //ruilima.com/2010/11/ambiente_de_desenvolvimento_php_netbeans_xdebug/ 是葡萄牙语，但是有一个预配置的虚拟机，带有 Ubuntu 10.10、netbeans、php、mysql、xdebug，可以使用。看一看

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-06T15:12:07.247

我发现在 Netbeans 中，您需要将项目中的 webroot 路径设置为 app/webroot。如果你这样做调试工作完美无缺。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-26T03:40:36.793

如果您在 Windows 下使用 xampp：

您只需要打开您的**php.ini**文件并更改这两行

```
;xdebug.profiler_enable = 0
;zend_extension = "C:\xampp\php\ext\php_xdebug.dll" 
```

进入

```
xdebug.profiler_enable = 1
zend_extension = "C:\xampp\php\ext\php_xdebug.dll" 
```

（注意：如果你的xampp版本太旧，你必须从[http://xdebug.org/download.php](http://xdebug.org/download.php)下载，即使你的操作系统是64位也要下载32位。例如你下载的**xdebug的名字是php_xdebug-2.2.1 -5.4-vc9.dll** .首先将php_xdebug-2.2.1-5.4-vc9.dll复制到目录C:\xampp\php\ext\，然后你的第二行将是`zend_extension = "C:\xampp\php\ext\php_xdebug-2.2.1-5.4-vc9.dll`）

之后停止 apache 并重新开始，就是这样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T09:29:15.287

如果您遇到 Apache 决定在您运行调试器时崩溃的问题（这是我所拥有的并且非常烦人）。我很确定我重新安装了 xampp 并重新设置了 xdebug。我认为问题在于在 php.ini 中奇怪地设置了 zend-debugger，而我没有修改正确的 php.ini。

最终在重新安装并重置它之后，我让它工作正常。

我现在运行 Netbeans 的开发版本，它使用 xdebug 进行网络调试，所以我们在我们的开发服务器上运行它，它工作得很好。

祝你好运，没有关于如何使用 net beans 设置 xdebug 的特别好的文档。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-06T09:09:02.940

我偶尔会遇到 NetBeans 和 XDebug 的问题，这些问题归结为与正在调试的代码无关的 Watch 语句。

在这种情况下，调试器会因 Socket 异常而失败。

如果您发现这是导致您的问题的原因，请移除所有手表。一般来说，虽然我发现 XDebug 非常方便！

但是，我确实意识到这可能与您在这里遇到的问题无关，但值得注意。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-25T06:39:28.053

在同一个站点 PHP Netbeans 上找到了相同问题的解决方案[：xdebug 在每个 include() 或 require() 上停止](https://stackoverflow.com/questions/3913626/php-netbeans-xdebug-stops-on-every-include-or-require)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-10-07T10:12:29.003

错误的行为是，忘记了

```
[xdebug] 
```

作为 php-ini 中的节头。当然，在另一个部分开始之前“停放”你的东西（例如 [Date] 或 [iconv]），否则你会不小心将它们放在错误的部分中。（在 php.ini 的评论 djungle 中，这很容易发生。）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-06T03:14:06.593

在我的情况下，它是在我的机器（Windows 7）上运行的一个进程，它使用端口 9000，已经调用了 aeagent.exe

我将我的 php.ini 设置更改为“xdebug.remote_port=9001”，在 netbeans 中进行了相应的更改，然后重新启动了 Apache。现在它起作用了。

感谢 SysInternals TCPView 工具。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-08-16T21:14:09.643

转到[http://wiki.netbeans.org/HowToConfigureXDebug](http://wiki.netbeans.org/HowToConfigureXDebug)。您应该遵循大量步骤，这可能会对您有所帮助。

但很可能您只需要一个新版本的 xdebug-binary。转到[http://xdebug.org/wizard.php](http://xdebug.org/wizard.php)找出您需要什么二进制文件，您的问题可能会得到解决。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-10-25T10:16:21.313

在 Ubuntu 下运行 netbeans 时，我也遇到了这个问题，似乎我已经尝试了在互联网上找到的所有解决方案，但都是徒劳的。

唯一有帮助的是使用 SUDO 命令运行 netbeans！看起来普通用户没有权限监听端口 9000（或任何其他）。

```
sudo netbeans & 
```

...瞧，我可以再次调试！也许它会为你节省一两天

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-20T02:07:44.200

现在它在浪费 3 个小时让 xdebug 在 Windows8 上工作后工作，使用 wamp 2.2 将 [xdebug] 下面的原始行替换为以下

```
 zend_extension = "c:/wamp/bin/php/php5.3.13/zend_ext/php_xdebug-2.2.0-5.3-vc9.dll"
    ;make sure path of your own php_xdebug, dll version may vary.

    [xdebug]

    xdebug.remote_enable = on
    xdebug.remote_handler=dbgp
    xdebug.remote_host=localhost
    xdebug.remote_port=9000
;recheck your port number in netbeans [Tools=>options=>php=>debugging there it is: debugging port]
    xdebug.profiler_enable = on
    xdebug.profiler_enable_trigger = on
    xdebug.profiler_output_name = cachegrind.out.%t.%p
    xdebug.profiler_output_dir = "c:/wamp/tmp" 
```

现在单击任务栏中的 wamp 图标并“重新启动所有服务”

好吧..现在最后一步>>开始 NETBEANS 作为管理员 Holly windows8 的灵魂我恨你：<

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-10-09T17:32:46.637

浏览以下文档以使用 NetBeans 进行远程调试。 [http://stuporglue.org/setting-up-xdebug-with-netbeans-on-windows-with-a-remote-apache-server/](http://stuporglue.org/setting-up-xdebug-with-netbeans-on-windows-with-a-remote-apache-server/)

# windows - 如何强制删除文件？

> ID：693076
> 
> 赞同：29
> 
> 时间：2009-03-28T16:46:19.573
> 
> 标签：windows, batch-file, unlock

> 这个问题的存在是因为它具有历史意义，但它不被认为是本网站的一个好的、主题性的问题，所以请不要将它作为你可以在这里提出类似问题的证据。

如何强制 Windows XP 删除某些应用程序当前正在使用的文件？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-28T16:47:15.390

您必须先关闭该应用程序。如果它被某些应用程序使用，则无法删除它。

[UnLock IT](http://emcosoftware.com/unlock-it)是一个简洁的实用程序，可帮助您在任何文件或文件夹被某些应用程序或系统锁定时对其进行控制。对于每个锁定的资源，您都会获得一个锁定进程列表，并且可以通过终止这些进程来解锁它。EMCO Unlock IT 提供 Windows Explorer 集成，允许在上下文菜单中一键解锁文件和文件夹。

还有[Unlocker](http://www.emptyloop.com/unlocker/)（不推荐，请参阅下面的**警告**），这是一个免费工具，可帮助定位任何正在运行的文件锁定句柄，并为您提供关闭它的选项。然后你可以继续对这些文件做任何你想做的事情。

> **警告：安装程序包含很多不受欢迎的东西。几乎可以肯定，使用 UnLock IT 会更好。**

# linux - Linux链接器标志-lXi在编译Lazarus代码时找不到lib

> ID：693080
> 
> 赞同：0
> 
> 时间：2009-03-28T16:49:05.527
> 
> 标签：linux, linker, lazarus, freepascal, fpc

在我解决了我的[第一个问题](https://stackoverflow.com/questions/673086/faulty-fonts-on-lazarus)后，我进入了另一个问题。看起来我缺少某种库，使链接器抱怨 -lXi 不起作用。

我已经包含了大部分 Xorg 开发包，我还需要什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T08:55:26.293

链接到“-lXi”时，编译器会查找名称以“libXi.so”开头的文件（后跟一些版本号）。命令

```
locate libXi.so | xargs rpm -qf | sort -u 
```

给

```
libXi-1.1.3-4.fc9.i386
libXi-1.1.3-4.fc9.x86_64
libXi-debuginfo-1.1.3-4.fc9.x86_64
libXi-devel-1.1.3-4.fc9.x86_64 
```

在我的 Fedora 10 系统上，所以你可能缺少*libXi-devel*包。

# php - $_GET 没有 foo

> ID：693084
> 
> 赞同：4
> 
> 时间：2009-03-28T16:50:12.120
> 
> 标签：php, url, get

如何在没有 get 变量的情况下使用 download.php?get=file.exe，例如 download.php?=file.exe，在 PHP 中使用 $_GET？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T16:53:05.313

您可以使用 $_GET[0] 或 $_REQUEST[0]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-28T20:19:33.523

您可以使用`$_SERVER['request_uri']`which 将允许您省略 ? 完全，给你留下像 example.com/download.php/file.exe 这样的 URL

然后，通过一些 URL 重写（或实现引导控制器），您可以进一步清理它，从而生成 example.com/download/file.exe

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T16:54:24.497

你需要我解决重写[这篇维基百科文章](http://en.wikipedia.org/wiki/Rewrite_engine)应该给你足够的信息来统计。具体来说，如果您使用 apache，请阅读有关 mod_rewrite 的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T17:10:01.467

您可以使用 $_SERVER['QUERY_STRING'] 来获取 ? 之后的所有内容。

编辑：然后你可以使用 download.php?file.exe

# java - 使用 JUST Java 1.5（或更早版本）读取和写入 XML

> ID：693090
> 
> 赞同：5
> 
> 时间：2009-03-28T16:52:41.383
> 
> 标签：java, xml

对于读取 XML，Java 1.5 中内置了 SAX 和 DOM。您可以使用 JAXP，而无需了解可用的解析器的详细信息……那么，在 Java 1.5 和更早版本中**编写**XML 文档的一些规定 API 是什么？

*   我不想使用第三方二进制文件
*   我不想假设 Sun VM 或 IBM VM 等并使用一些专门的类
*   无论编写文档的方式是什么，我都想以一种互补的方式阅读。
*   大型 XML 文件的性能和适用性并不是特别重要

理想情况下，没有变化的读写只是几行代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T17:18:51.693

Java 1.4 带有[javax.xml.transform](http://java.sun.com/j2se/1.4.2/docs/api/javax/xml/transform/package-summary.html)，它可以采用[DOMSource](http://java.sun.com/j2se/1.4.2/docs/api/javax/xml/transform/dom/DOMSource.html)、[SAXSource](http://java.sun.com/j2se/1.4.2/docs/api/javax/xml/transform/sax/SAXSource.html)等：

```
// print document
InputSource inputSource = new InputSource(stream);
Source saxSource = new SAXSource(inputSource);
Result result = new StreamResult(System.out);
TransformerFactory transformerFactory = TransformerFactory
    .newInstance();
Transformer transformer = transformerFactory
    .newTransformer();
transformer.transform(saxSource, result); 
```

如果您想回到 J2SE 1.3 API，那么您几乎只能靠自己（尽管如果您使用的是那个时代的 J2EE API，可能会有一些东西——我不记得了）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T17:05:18.700

没有官方的“规定”API，但我们对以下技术非常满意：

创建一个`XmlWriter`用字符初始化并具有、和`Writer`等方法的类。`startElement( String name )``writeAttribute( String name, String value )``writeCData( String text )`

然后以明显的方式实施。内部方法可以做 SGML 字符转义之类的事情；有关有用的实用程序，请参阅 Apache Commons。

如果您希望输出更易于阅读，您可以执行诸如跟踪元素嵌套级别并添加换行符和制表符或空格之类的操作。同样可选的是跟踪诸如打开和关闭的元素之类的东西，其中没有任何内容，可以缩写为`<element/>`.

# svn - 如何设置 Apache 以使用此特定 URL 配置服务 SVN？

> ID：693098
> 
> 赞同：4
> 
> 时间：2009-03-28T17:00:59.257
> 
> 标签：svn, apache, path, httpd.conf

我有一个 VPS，我正在尝试托管几个 SVN 项目。我希望 URL 路径是这样的：

```
http://svn.domain.com -> Welcome HTML page (at /var/www/svn.domain.com/httpdocs/index.php)
http://svn.domain.com/project1 -> Project 1 SVN Root
http://svn.domain.com/project2 -> Project 2 SVN Root
http://svn.domain.com/project3 -> Project 3 SVN Root 
```

但是，使用下面的代码，第一件事（欢迎 HTML 页面）没有显示，因为 Location 块优先于 DocumentRoot。

将 Location 块设置为`<Location /repos>`有效，但随后我的 URL 变为`http://svn.domain.com/repos/project1`，这是我不喜欢的。

有什么建议么？

```
<VirtualHost *>
        ServerName svn.domain.com
        DocumentRoot /var/www/svn.domain.com/httpdocs
        <Location />
                DAV svn
                SVNParentPath /var/svn
                SVNIndexXSLT "/svnindex.xsl"

                AuthzSVNAccessFile /var/svn/access

                SVNListParentPath On
                # try anonymous access first, resort to real
                # authentication if necessary.
                Satisfy Any
                Require valid-user

                # how to authenticate a user
                AuthType Basic
                AuthName "Subversion repository"
                AuthUserFile /var/svn/passwd
        </Location>
</VirtualHost>

<Directory /var/svn>
        Allow from all
</Directory> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T17:24:44.067

您可以使用**SVNPATH**指令，但是您必须设置三个位置（每个项目都需要自己的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T20:30:31.187

您可以通过为 SVN 存储库添加子域来解决此问题，而无需在每次添加新项目时更改 Apache 配置。你最终会得到这样的东西：

```
<VirtualHost *>
    ServerName svn.domain.com
    DocumentRoot /var/www/svn.domain.com/httpdocs
    <Location /svn>
            DAV svn
            SVNParentPath /var/svn
            SVNIndexXSLT "/svnindex.xsl"

            AuthzSVNAccessFile /var/svn/access

            SVNListParentPath On
            # try anonymous access first, resort to real
            # authentication if necessary.
            Satisfy Any
            Require valid-user

            # how to authenticate a user
            AuthType Basic
            AuthName "Subversion repository"
            AuthUserFile /var/svn/passwd
    </Location>

    <Directory /var/svn>
    Allow from all </Directory>

    <Directory /var/www/svn.domain.com/httpdocs>
      # Doc. root directives here</Directory> 
```

[然后，您必须使用http://svn.domain.com/svn/project1/](http://svn.domain.com/svn/project1/)形式的 URL 访问您的存储库，但是如果您想添加 project4 等，您所要做的就是在 / 下添加新的存储库变量/svn。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T08:14:52.857

[mod_rewrite](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)呢？[您可以为非 SVN 内容（ http://example.com/info/](http://example.com/info/) ）设置一个文件夹，然后使用 mod_rewrite 将对“/”或“/index.php”的请求重定向到“/info/index.php” . 那行得通吗？

# linux - 如何将 linux 链接器中的 -lXi 标志转换为适当的库？

> ID：693109
> 
> 赞同：0
> 
> 时间：2009-03-28T17:05:41.740
> 
> 标签：linux, linker, flags

如何找出上述标志所指的库是什么？我将如何为其他人做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T17:21:05.417

-l 选项将库的名称作为参数，因此在这种情况下，库将被命名为 libXi.a（或 libXi.so 或类似名称）。要查找库，请查看您的发行版中可用的标准库位置（/usr/lib、/lib、/usr/local/lib 等）。还可以使用链接器的 -L 选项指定其他库目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T17:47:33.293

如果您的程序编译成功，或者如果您有另一个使用 的程序`-lXi`，那么您可以执行以下操作：

```
ldd /path/to/that/program | grep libXi 
```

例如：

```
$ ldd /usr/X11R6/bin/audacity | grep libXi
        libXinerama.so.1 => /usr/lib/libXinerama.so.1 (0x00007f53faaba000)
        libXi.so.6 => /usr/lib/libXi.so.6 (0x00007f53f8e2c000) 
```

这很可能会告诉您该库在哪里。（这不是 100%，因为构建过程*可能会*改变搜索路径，但这对于像 X11 这样的标准库来说通常不太可能。）

从那里，你可以询问你的发行版哪个包有那个文件，如果你在乎的话。例如在 Ubuntu 或 .deb-base 发行版上：

```
$ dpkg --search /usr/lib/libXi.so.6
libxi6: /usr/lib/libXi.so.6 
```

如果您不能使用 LDD，请检查您的系统`/etc/ld.so.conf`，这将指示运行时共享库​​链接的搜索路径。（`/lib`/ 并且`/usr/lib`默认包含在内。）

最坏的情况，你可以找到它：

```
find / -regex '.*libXi\.\(a\|so\).*' 2> /dev/null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T19:14:09.793

```
strace -f -e open gcc ... -lXi 
```

在输出中查找 libXi。

# c# - 如何使用 StringFormat 强制显示“+”号

> ID：693111
> 
> 赞同：9
> 
> 时间：2009-03-28T17:06:53.767
> 
> 标签：c#, wpf, string

有没有办法在`+`使用时强制在正数前面显示符号`StringFormat`？

例如：

```
<TextBlock Text="{Binding Path=PercentAgainstBudget, 
                          StringFormat={}{0:0.00}%}" /> 
```

如果`PercentAgainstBudget`是负数，我会看到`-`标志。但如果它是积极的，它不会。由于这个数字是一个偏移量，我想强制显示`+/-`. 我可以做一个`ValueConverter`，但我想知道是否有办法通过该`StringFormat`属性来做到这一点。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-28T17:16:34.477

格式字符串可以由分号分隔的两部分组成。第一部分是正数的格式，第二部分是负数。你会想要这个：+0.0%;-0.0%

```
PS C:\Users\jachymko> '{0:+0.0%;-0.0%}' -f 2.45
+245,0%
PS C:\Users\jachymko> '{0:+0.0%;-0.0%}' -f -2.45
-245,0% 
```

# internet-explorer-8 - 一台机器上有多个 Internet Explorer 实例

> ID：693112
> 
> 赞同：8
> 
> 时间：2009-03-28T17:07:30.737
> 
> 标签：internet-explorer-8, internet-explorer-7, internet-explorer-6

> **可能重复：**
> [在同一台计算机上运行 Internet Explorer 6、Internet Explorer 7 和 Internet Explorer 8](https://stackoverflow.com/questions/574463)

我正在寻找一种工具，可以让我在我的机器上运行 Internet Explorer 6、Internet Explorer 7（和 Internet Explorer 8，如果可能的话）。我在互联网上找到了类似[这样](http://www.my-debugbar.com/wiki/IETester/HomePage)的东西以及其他一些有趣的解决方案，但我需要您根据经验提出意见。从 Web 开发人员的角度来看，哪个是运行多个 Internet Explorer 实例的最佳选择？

* * *

编辑：感谢您的帮助，我安装了您建议的一些工具，我决定坚持使用这两个：[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)和[IE Collection](http://finalbuilds.edskes.net/iecollection.htm) - 易于安装、直观的 UI 和快速响应时间。

其他：

*   [xenocode](http://www.xenocode.com/Browsers/)刚刚崩溃，或者我无法正确安装它。
*   [多个 IE](http://download.microsoft.com/download/5/6/8/568F0D28-0434-4794-B7FC-FB293BCC98FB/SuperPreview%5FTrial%5Fen.exe)想要我安装 Microsoft .NET，它花了很长时间，最后，令人惊讶的是……没有任何效果。再说一次，这可能是我的安装技巧不佳
*   [IE Application Compatibility VPC Image](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)似乎是解决这个问题的最专业的方法，但我更喜欢 IETester 和 IE Collection。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-28T17:13:16.903

微软为此提供了带有各种操作系统映像和 IE 版本的 VPC 虚拟硬盘：

*   [Internet Explorer 应用程序兼容性 VPC 映像](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)

请注意，操作系统安装是定时炸弹，因此您必须定期从 MS 下载新图像。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T17:20:23.953

如果您使用的是 Windows，您可以尝试新的 SuperPreview 工具：http: [//download.microsoft.com/download/5/6/8/568F0D28-0434-4794-B7FC-FB293BCC98FB/SuperPreview_Trial_en.exe](http://download.microsoft.com/download/5/6/8/568F0D28-0434-4794-B7FC-FB293BCC98FB/SuperPreview_Trial_en.exe)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T17:15:01.627

我用过这个：

[http://tredosoft.com/Multiple_IE](http://tredosoft.com/Multiple_IE)

如果这是优先事项，这将使 IE 6 和更早的版本开始运行。然后你可以只安装 IE 8，因为它允许你使用 IE7 的“兼容模式”，这样你就可以有效地模仿 IE7。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T17:12:14.220

您可以使用此安装程序安装多个版本的 IE：http: [//finalbuilds.edskes.net/iecollection.htm](http://finalbuilds.edskes.net/iecollection.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T17:33:59.973

使用[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)。它是“免费的”并关注其更新。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-28T17:15:57.893

我使用[Xenocode](http://www.xenocode.com/Browsers/)进行浏览器测试取得了相当不错的结果

# wcf - 从 Windows 服务生成客户端代理

> ID：693114
> 
> 赞同：1
> 
> 时间：2009-03-28T17:07:39.740
> 
> 标签：wcf, proxy, client, stream, svcutil.exe

我正在尝试从 WCF 服务库生成客户端代理。我在 Windows XP Pro 工作站上使用 VS2005、.NET 3.0。WCF 服务托管在 Windows 服务中。当我将 Windows 服务作为控制台应用程序运行时，没有问题。我可以针对该地址运行 svcutil.exe 并生成代理。但是，当我在发布模式下编译该服务并使用 InstallUtil 将其安装在工作站上时，出现错误“错误：无法从 net.tcp://localhost:9090/Service2 获取元数据”。这些是我为服务使用 app.config 的设置

```
<behaviors>
  <endpointBehaviors>
    <behavior name="Test2">
      <dataContractSerializer maxItemsInObjectGraph="2147483647" />
    </behavior>
  </endpointBehaviors>
  <serviceBehaviors>
    <behavior name="serviceBehaviour">
      <serviceDebug includeExceptionDetailInFaults="true" />
      <serviceMetadata />
      <!--<serviceMetadata httpGetEnabled="true" />-->
      <dataContractSerializer maxItemsInObjectGraph="2147483647" />
    </behavior>
  </serviceBehaviors>
</behaviors>

<bindings>
  <customBinding>
    <binding name="TestBinding2" inactivityTimeout = "00:30:00"  openTimeout="00:30:00"
         receiveTimeout="00:30:00"
         sendTimeout="00:30:00">
      <binaryMessageEncoding />
      <tcpTransport transferMode="StreamedResponse" />

    </binding>
  </customBinding>
</bindings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T00:42:51.407

在黑暗中拍了几张...

您的 Windows 服务是否正在运行？除此之外，您的 WCF 服务是否在 Windows 服务中运行？[我的项目还在 Windows 服务中托管 WCF 服务（您可以在此处](https://stackoverflow.com/questions/686452/create-wcf-service-for-unmanaged-c-clients/687717#687717)查看一般步骤）。即使我将 Windows 服务标记为自动启动，我仍然必须在第一次手动启动它。也许 InstallUtil.exe 有一个命令行选项，我不知道它会为我做这件事。但关键是，如果你的 Windows 服务或你里面的 WCF 服务没有运行，你显然看不到 MEX 端点。

我注意到的另一件事。您的错误表明无法从 net.tcp://localhost:9090/Service2 获取元数据，但您在评论中发布的基地址显示为 net.tcp://localhost:9090/Service_2。也许这只是一个类型-o，但仔细检查所有内容是否拼写正确并没有什么坏处，特别是如果 add.config 是手动生成的。

# java - Junit4 + Spring 2.5：断言抛出“NoClassDefFoundError”

> ID：693115
> 
> 赞同：6
> 
> 时间：2009-03-28T17:07:51.080
> 
> 标签：java, spring, junit4

我一直在用 Spring 在 Junit4 中编写测试代码，我得到了这个有趣的行为：

如果我的测试是这样通过的，那么一切都很好：

```
@Test
public void truthTest(){

    assertTrue(true); //Ok

} 
```

但是，如果我的测试失败：

```
@Test
public void truthTest(){

    assertTrue(false); //ERROR

} 
```

然后，我收到的不是测试失败，而是丑陋而神秘的堆栈跟踪，就是这样：

[http://pastie.org/429912](http://pastie.org/429912)

抱歉这个丑陋的转储，但它是我必须解释问题的唯一数据（我“粘贴”它以提高可读性）

我真的很疑惑，有没有人遇到过这种问题？提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-28T19:53:53.193

[http://jira.springframework.org/browse/SPR-5145](http://jira.springframework.org/browse/SPR-5145)

这是 spring-test 2.5.x 的一个已知问题。它与 JUnit 4.5 不兼容。使用 4.0-4.4。

或者您可以尝试问题跟踪器中的补丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-31T17:58:50.863

我在编写 Spring JUnit 测试时遇到了同样的问题。就像网上的很多帖子一样，只有两种选择

1) 保持最新的 Spring 版本并使用最新版本的 JUnit 或 2) 保留当前的 ​​Spring 版本并使用 JUnit 4.4 或更低版本。

我选择了选项 #2，我们将 Spring 版本保留为 2.5 并下载了 JUnit 4.4。之后一切正常。

另外需要注意的一点是，如果您的项目，即您正在编写测试的项目 A 依赖于另一个具有另一个 Spring 版本的项目 B，您也会收到类似的错误。我很难学会。

-普拉桑特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T17:11:43.287

如果您将 AssumptionViolatedException 导入您的测试类怎么办？

看起来它找不到引发适当异常的类。

# actionscript-3 - 如何在flex中绘制一个显示数字的圆圈

> ID：693116
> 
> 赞同：2
> 
> 时间：2009-03-28T17:07:51.457
> 
> 标签：actionscript-3, flex3

我是 flex 新手，所以如果我没有使用正确的词来提出以下问题，请原谅我。我想知道是否有一种方法可以绘制一个显示数字的圆圈，例如 ex。表示其半径的[渐变圆圈以显示其相关性。](http://wardley.org/kites/freestyle/technical/gradcirc.html)是否有一个组件已经这样做了，如果没有，最好的方法是什么。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T02:10:34.740

这是一个关于如何做到这一点的快速示例（将继续满足您的特定需求）

```
package  
{
    import flash.text.TextFormatAlign;  
    import flash.text.TextField;    
    import flash.display.Sprite;
    import flash.text.TextFormat;   

    public class LabeledCircle extends Sprite 
    {
        private var textField:TextField;

        public function LabeledCircle(radius:Number, label:String = "")
        {
            // Prepares the textField

            var textFormat:TextFormat = new TextFormat();
            textFormat.align = TextFormatAlign.CENTER;

            textField = new TextField();
            textField.defaultTextFormat = textFormat;

            addChild(textField);

            // Sets the default parameters

            this.radius = radius;
            this.label = label;
        }

        public function set radius(radius:Number):void
        {
            // redraws the circle
            graphics.clear();
            graphics.beginFill(0x000000, .5);
            graphics.drawCircle(0, 0, radius);

            // recenters the textfield depending on the radius
            textField.width = radius * 2;
            textField.x = -radius;
        }

        public function set label(label:String):void
        {
            textField.text = label;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T17:20:50.893

[Flare](http://flare.prefuse.org/)的组件类似于您发布的链接中的同心圆示例。[请参阅演示](http://flare.prefuse.org/demo)中的布局 > CirclePack 。

我还不确定您所说的“关联数字”是什么意思。试试[这个](http://www.tom-carden.co.uk/2008/10/01/text-along-a-path-in-flash/)：在路径上渲染文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T18:50:01.803

*   Actionscript 绘图 API -[此处为示例](http://flash-creations.com/notes/dynamic_drawingapi.php)
*   [Degrafa](http://www.degrafa.org/) - 使绘图 API 更易于使用的图形框架，并包含一个圆形类

# asp.net - Rake 策略，DotNet 实施

> ID：693135
> 
> 赞同：0
> 
> 时间：2009-03-28T17:18:20.867
> 
> 标签：asp.net, rake, database-versioning

去年阅读和使用 Rails 时，给我留下最深刻印象的工具之一是 Rake。一个数据库版本控制系统，可以将所有开发数据库的相同内容直接集成到构建中......这样的事情会让生活变得更加轻松（和更安全）！

但是，我无法弄清楚的一件事是：当您实际上无法访问生产服务器时，如何将这些更改移动到生产服务器？我们在全国有多个服务器，通过安装包安装/升级应用程序。

注意：这个问题更多的是关于策略而不是 Rails/Rake 特定技术。我们不使用rails，我们使用.Net。但如果我能弄清楚这个发布场景，似乎有几个工具[Migratordotnet](http://code.google.com/p/migratordotnet/)可以让我们做类似的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T17:27:10.130

您也许可以使用[Red Gate 的 SQL Compare 之](http://www.red-gate.com/)类的工具来生成模式差异脚本，从而使您能够自动执行更新数据库的过程。我已经手动使用该工具进行了此类更改，并且可以轻松地看到创建一个程序来运行这些更新作为升级过程的一部分。但是，如果我要使其自动化，我会设计一些东西，使我能够检查架构的版本并以正确的顺序运行必要的脚本以将其调出所需的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T20:01:26.643

您可能知道，在生产环境中运行迁移的标准 Rails 方式是[Capistrano](http://www.capify.org)。它有一个 deploy:migrations 任务，使用 ssh 在远程服务器上运行迁移。

你也许可以调整 Capistrano 来做你想做的事。它本质上是一种在远程服务器组上运行命令的灵活方式。**您需要在要部署的**机器上安装 Ruby才能使用它，而不是在要部署**到**的机器上。

您最好的选择可能是编写自定义 Capistrano 任务来上传 setup.exe，运行它，然后运行迁移（可能使用 Migrator.NET）。

# hibernate - Hibernate：将对象持久化为字符串？

> ID：693137
> 
> 赞同：0
> 
> 时间：2009-03-28T17:18:45.377
> 
> 标签：hibernate, persistence

假设我有一个像

```
public class Handle {
    private String handle;
    public Handle(String name) {
        this.handle=name;
    }
    public String toString() {
      return this.handle;
    }
 } 
```

这是我想在 Hibernate 中坚持的一些 POJO 的属性。如何为我的 POJO 定义映射，使其 Handle 对象仅存储为字符串？

*澄清：*我在这里真正要问的是，我如何坚持自定义类型？答案是实现一个UserType。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T17:37:27.437

我可能不清楚，但我所问问题的基本解决方案是实现 Hibernate UserType。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T17:20:38.303

您应该将其映射为组件

# c - 有哪些令人信服的例子表明指针算法比数组下标更可取？

> ID：693139
> 
> 赞同：10
> 
> 时间：2009-03-28T17:19:37.620
> 
> 标签：c, pointer-arithmetic

我正在为介绍性 C 课程准备一些幻灯片，并且我正在尝试展示在数组下标上使用指针算术的好例子（和动机）。

我在书中看到的很多例子都是相当的。例如，许多书籍展示了如何反转字符串中所有值的大小写，但除了将 a[i] 替换为 *p 之外，代码是相同的。

我正在寻找一个好的（和简短的）一维数组示例，其中指针算术可以产生更优雅的代码。有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-28T17:23:20.387

**再次获取指针而不是值：**

当他们想要再次获得指针时，通常会使用指针算法。要在使用数组索引时获取指针：您是 1）计算指针偏移量，然后 2）在该内存位置获取值，然后 3）您必须使用 & 再次获取地址。那是更多的打字和不太干净的语法。

**示例 1：**假设您需要一个指向缓冲区中第 512 个字节的指针

```
char buffer[1024]
char *p = buffer + 512; 
```

比：

```
char buffer[1024];
char *p = &buffer[512]; 
```

**示例 2：**更高效的 strcat

```
char buffer[1024];
strcpy(buffer, "hello ");
strcpy(buffer + 6, "world!"); 
```

这比：

```
char buffer[1024];
strcpy(buffer, "hello ");
strcpy(&buffer[6], "world!"); 
```

* * *

**使用指针算术 ++ 作为迭代器：**

在遍历元素数组中的每个元素时，使用 ++ 递增指针并使用 -- 递减非常有用。它比使用用于跟踪偏移量的单独变量更干净。

* * *

**指针减法：**

您可以将指针减法与指针算术结合使用。在某些情况下，这对于在您指向的元素之前获取元素很有用。它也可以用数组下标来完成，但它看起来真的很糟糕而且令人困惑。特别是对于 python 程序员，其中给出了一个负下标来索引列表末尾的某些内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T17:23:30.637

```
char *my_strcpy(const char *s, char *t) {
  char *u = t;
  while (*t++ = *s++);
  return u;
} 
```

为什么要用索引来破坏这样的美丽？（参见 K&R，以及他们如何建立这种风格。）***我使用上面的签名是有原因的。不先要求澄清就停止编辑。对于那些认为他们知道的人，请查看现在的签名——你错过了一些`restrict`资格。***

结构对齐测试和`offsetof`宏实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-15T15:44:38.243

指针算术可能看起来很花哨和“hackerish”，但我从未遇到过它比标准索引更快的情况。恰恰相反，我经常遇到这样的情况，它会大大降低代码速度。

例如，在支持 SSE 扩展的现代处理器上，典型的使用指针的数组顺序循环可能比使用经典索引循环效率低。循环中的指针算术足以阻止编译器执行循环矢量化，这可以产生典型的 2x-4x 性能提升。此外，使用指针而不是简单的整数变量可能会由于指针别名而导致不必要的内存存储操作。

因此，通常不建议使用指针算法而不是标准索引访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T17:26:08.213

遍历二维数组，如果不使用指针，数据的位置并不重要
，您必须使用指针跟踪两个下标
，您可以指向数组的顶部，并使用单个循环，通过整个事情拉链

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T17:33:59.630

如果您使用的是旧的编译器，或者某种专业的嵌入式系统编译器，*可能*会有轻微的性能差异，但大多数现代编译器可能会优化这些（微小的）差异。

以下文章可能是您可以借鉴的 - 取决于您学生的水平：

[http://geeks.netindonesia.net/blogs/risman/archive/2007/06/25/Pointer-Arithmetic-and-Array-Indexing.aspx](http://geeks.netindonesia.net/blogs/risman/archive/2007/06/25/Pointer-Arithmetic-and-Array-Indexing.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T18:39:59.113

您是在专门询问 C，但 C++ 也以此为基础：

大多数指针算法自然地推广到前向迭代器的概念。由于运算符重载，遍历内存`*p++`可用于任何有序容器（链表、跳过列表、向量、二叉树、B 树等）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T18:44:02.440

我希望你永远不必处理一些有趣的事情：指针可以别名，而数组不能。别名会导致各种不理想的代码生成，其中最常见的是使用指针作为另一个函数的输出参数。基本上，编译器不能假设函数使用的指针没有别名本身或该堆栈帧中的任何其他内容，因此每次使用时都必须重新加载指针中的值。或者更确切地说，为了安全起见。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T18:22:56.610

通常选择只是一种风格——在特定情况下，一种看起来或感觉比另一种更自然。

还有一个论点是，使用索引会导致编译器不得不在循环中重复重新计算偏移量——我不确定这种情况的频率（除了非优化的构建），但我想它会发生，但是这可能很少有问题。

我认为从长远来看很重要的一个领域（可能不适用于介绍性 C 类 - 但我说要尽早学习）是使用指针算术适用于 C++ STL 中使用的习语。如果你让他们理解并使用指针算法，那么当他们转向 STL 时，他们就会在如何正确使用迭代器方面占得先机。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-18T10:21:07.020

```
#include ctype.h
void skip_spaces( const char **ppsz )
{
  const char *psz = *ppsz;
  while( isspace(*psz) )
    psz++;
  *ppsz = psz;
}

void fn(void)
{
  char a[]="  Hello World!";
  const char *psz = a;
  skip_spaces( &psz );
  printf("\n%s", psz);
} 
```

# msbuild - 查找 TeamCity Agent 的工作路径以在 MSBuild 脚本中使用

> ID：693152
> 
> 赞同：2
> 
> 时间：2009-03-28T17:23:45.287
> 
> 标签：msbuild, continuous-integration, teamcity

我想将输出文件从我的构建复制到登台服务器，但我不知道如何找到 TeamCity 用来在 MSBuild 中存储构建输出的路径。有什么帮助吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T20:17:08.147

物业`$(teamcity_build_workingDir)`做到了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T17:37:57.793

最好的方法是将文件上传到 teamcity。选择 step1（常规设置）并输入工件路径。它应该类似于 /SourceOfProject/bin/releaese/*.dll。

我在上传之前压缩文件，因为您只想下载 1 个包含完整构建的文件。我的构建总是在 nant 文件中有 2 个步骤。

第 1 步 - 调用 msbuild

Step2 - 使用 7zip 创建 zip

```
<?xml version="1.0"?>
<project name="MyProjectBuild"
 default="build"  basedir="."
 xmlns="http://nant.sf.net/release/0.85/nant.xsd">

 <description>Build Script</description>
 <target name="build" >
 <exec program="C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe"    >  
 <arg value="MyProject\MyProject.csproj" />
 <arg value="/t:Build" />
  <arg value="/p:Configuration=Release" />
 </exec>

   <exec program="7z"    >  
 <arg value="a" />
 <arg value="MyProject\bin\release\buildresult.zip" />
  <arg value="MyProject\bin\release\*.dll" />
 </exec>
 </target>

</project> 
```

无论如何我的工作路径是：C:\Programme\TeamCity\buildAgent\work

# jquery - 是否可以使用 jQuery 来操作 XUL 元素？

> ID：693174
> 
> 赞同：14
> 
> 时间：2009-03-28T17:34:58.910
> 
> 标签：jquery, firefox

我知道在 Firefox 插件中集成 jQuery 是可能的，但是我们是否能够自己操作（动画、移动、调整透明度等）XUL 元素？

据我了解，Firefox 插件可以使用 jQuery 来操作 HTML/DOM 元素，但不确定 XUL 元素。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-04-13T09:03:30.640

***简短的回答：***是的

***长答案：***

我自己进行了实验。我只能以有限的方式使用它。XUL 元素的操作是可能的。但是我很难观察事件，因为我对 jQuery 很陌生——我不知道如何调整它以观察 Firefox/XUL 级别的事件——我什至不知道是否需要调整：D

***例子：***

**覆盖.xul**

```
<?xml version="1.0"?>    
<?xml-stylesheet href="chrome://testaddon/content/overlay.css" type="text/css"?>

<overlay id="testaddon_overlay"
        xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
        xmlns:html="http://www.w3.org/1999/xhtml">

    <script type="application/x-javascript" src="chrome://testaddon/content/jquery-1.4.2.js" />
    <script type="application/x-javascript" src="chrome://testaddon/content/overlay.js" />

    <toolbox id="navigator-toolbox">
        <toolbar toolbarname="TestAddonToolbar" class="chromeclass-toolbar">
            <toolbaritem>
                <toolbarbutton id="btnHide" label="HideMe" onclick="hideMe();" />
            </toolbaritem>            
        </toolbar>
    </toolbox>

</overlay> 
```

**覆盖.js**

```
function hideMe()
{
    $('#btnHide').hide();
} 
```

上面的代码将在您单击按钮时隐藏按钮 - 使用 jQuery 进行基本的 XUL 操作！

但正如我所说，尝试观察文档加载和其他此类事件，它会很快变得复杂（或者我不太了解：D）。

**更新：**我尝试了一些效果。Effects.fadeIn() 有效 - 但由于与 HTML 相比，XUL 中的透明度属性设置不同，因此按钮会停留在那里，最后它会突然消失。现在，我们可以（不能）在多大程度上使用 jQuery 来操作 XUL 变得越来越清楚。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-07-07T23:32:23.383

XUL 和 HTML 实际上以完全相同的方式处理不透明度，正是 jQuery 错误地检测了浏览器可以做什么。jQuery 在 XUL 中时认为它在不同的浏览器中，因此不透明效果的处理方式不同 - 由 jQuery。由于它在 Firefox 中，并且它应该正常处理不透明度，因此您可以像这样覆盖它：

jQuery.support.opacity = true

在加载 jQuery 后立即执行此操作。

可能有一整类类似的修复可以后应用到 jQuery 以使其表现更好，但我还没有研究过。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-28T18:21:40.763

我最近自己也在想这个。显然 DHTML 没有意义，但传闻说基本的语法糖和东西可以工作。

*   jQuery 组中有[关于 XUL](http://groups.google.com/group/jquery-dev/browse_thread/thread/4545040bf26c6eea?pli=1)讨论的这个 jQuery，这表明它加载时会出现一些异常。
*   [另请参阅这篇关于XUL 中的 jQuery 和 DHTML 的](http://digitalmihailo.blogspot.com/2008/05/jquery-and-dynamic-html-in-xul.html)较新的博客文章。该人正在寻找 XUL 中的 HTML，这并不完全是您所需要的，但他确实有很好的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-17T17:05:12.230

现在的答案是“大部分”。

基本的东西有效，包括选择、删除和查找。我在扩展内部和扩展的内容页面上都大量使用 1.5.2。

$.ready() 也不起作用，因为 jQuery 假定并等待一个主体。这是破坏它的[提交。](https://github.com/jquery/jquery/commit/262fcf7b7b919da1564509f621cf7480a5d5572b)

有些东西不起作用，因为正如@Daniel 所描述的，jQuery 没有正确检测它在 XUL 中可以做什么和不能做什么（下面有更多背景知识）。通过单步执行 jQuery 代码，我发现您自己的代码中至少需要以下几行。

```
// Workarounds for jQuery not properly testing support in XUL environment

// These are done at jQuery init
// This is actually critical, otherwise elements are not properly removed from the cache and you get a cache[id] is undefined
crowdmash.$.support.deleteExpando = true;

// These are done at ready(), but jQuery never fires ready in XUL
// XUL doesn't seem to support offsetWidth and offsetHeight (without this :hidden is broken which breaks fadeIn)
crowdmash.$.support.reliableHiddenOffsets = false;
crowdmash.$.support.opacity = true; 
```

如果您想在扩展的内容页面上使用 jQuery，请参阅我的[提示](http://forums.mozillazine.org/viewtopic.php?f=19&t=2105087)。

[jquery-xul](https://github.com/ilyakharlamov/jquery-xul/wiki)修改了 1.4.4 以更好地使用 XUL。我还没有尝试过，但从它的变化来看，它看起来确实修复了现成的问题。我不知道它是否解决了支持问题。

作为 $.support 问题的背景。问题是 jQuery 的特征检测创建了一个然后使用 innerHTML 填充它。XUL div 不支持 innerHTML，因此支持代码无法将任何内容标记为受支持。实际上有一张关于 1.7 - [http://bugs.jquery.com/ticket/5206](http://bugs.jquery.com/ticket/5206)的开放和正在讨论的票。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-30T21:38:59.607

我的解释是指 jQuery 1.7.1。

我的目标是在 XUL 上下文中执行淡入淡出动画，但是会抛出错误，因为如果 jQuery.support.opacity 是虚假的，jQuery 会错误地假设它正在处理 IE。

由于无法与通过**document.createElement("div")**创建的 DOM 元素交互，填充**支持**对象的逻辑过早地返回一个空对象。**通过使用document.createElementNS**解决了我的问题：

 ****```
createElementNS("http://www.w3.org/1999/xhtml", "div"); 
```

在提出这个解决方案后，我搜索了 jQuery 错误跟踪器并找到了以下相关票证：[http ://bugs.jquery.com/ticket/5206](http://bugs.jquery.com/ticket/5206)

jQuery 没有被宣传为在 XUL 上下文中工作，因此团队没有解决这个问题的计划，尽管他们应该解决 IE 误报的问题。我对在我的应用程序的源代码中手动进行这一行更改感到满意。

干杯，安迪

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-02T16:12:24.077

不幸的是，jQuery 无法在 XUL 中初始化，因为 HTML 特定的函数（例如`document.body`，仅适用于 HTML 页面）。然而，有一个名为[jQuery-xul](https://github.com/ilyakharlamov/jquery-xul)的特殊分支，它针对在 FireFox 扩展中的使用进行了优化。我已经检查过了，它工作正常。

# qt - 使用 QXmlDefaultHandler 解析时如何获取行号？

> ID：693176
> 
> 赞同：1
> 
> 时间：2009-03-28T17:35:28.190
> 
> 标签：qt

我正在使用 QXmlDefaultHandler 解析一个 xml 文件，如下所示：

```
void Parser::ParseFilename(const char* pFilename)
{
  LOG_DEBUG("Parser::ParseFilename(%s)", pFilename);
  ClearState();

  m_inputFile.setFileName(pFilename);
  QXmlInputSource source( &m_inputFile );
  QXmlSimpleReader reader;

  reader.setContentHandler( this );
  reader.parse( source );
} 
```

我需要知道错误消息的行号。我怎样才能得到它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T18:26:04.450

使用传递给[QXmlErrorHandler::error()](http://doc.trolltech.com/4.5/qxmlerrorhandler.html#error)函数的异常。[您可以使用QXmlReader::setErrorHandler()](http://doc.trolltech.com/4.5/qxmlreader.html#setErrorHandler)设置自定义错误处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T06:47:31.013

自己回答。

我的问题并不完全清楚，因为我没有写到我需要生成自己的自定义错误消息。例如，我需要对某些属性进行复杂的验证。然后，如果属性无效，我需要编写如下消息：“第 15454 行第 48 列出错，属性‘数字’应该是质数，但为 65536’。

Ariya Hidayat 建议的方法仅适用于 SAX 解析器本身生成的消息（如格式错误的 XML）。

对于自定义消息，我需要重载 `setDocumentLocator ( QXmlLocator * locator )`告诉我当前定位器的信息，并将定位器的值保存在某处，例如`savedLocator = locator;` 实际行号是通过以下方式获得的`locator->lineNumber().`

# c# - 如何将 Linq 查询传递给方法？

> ID：693180
> 
> 赞同：13
> 
> 时间：2009-03-28T17:38:32.427
> 
> 标签：c#, .net, linq

我想将 Linq 查询传递给方法，如何指定参数类型？

我的链接查询看起来像：

```
var query =
    from p in pointList
    where p.X < 100
    select new {X = p.X, Y = p.Y} 
```

显然我是 Linq 的新手，当我转换其余代码时，最终可能会摆脱接收方法，但这似乎是我应该知道的......

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-28T17:42:29.937

您需要对投影使用普通类型，或者将您传递给通用的方法也设置为通用（这意味着您不能用它做太多事情）。你到底想做什么？如果您需要使用方法中的 X 和 Y 值，您肯定需要创建一个普通类型。（有很多可怕的方法来避免它，但它们不是一个好主意。）

注意：目前正在讨论其他一些答案`IQueryable<T>`，但没有迹象表明您使用的不仅仅是 LINQ to Objects，在这种情况下，它将是一个`IEnumerable<T>`替代 - 但`T`当前是一个匿名类型。如果您想在每个项目中使用单独的值，这就是您需要处理的部分。如果您*不*使用 LINQ to Objects，请澄清问题，我将编辑此答案。

例如，获取您当前的查询（这有点损坏，因为您不能两次使用同名 X 的两个投影初始化程序）。你会创建一个新类型，例如`MyPoint`

```
public sealed class MyPoint
{
    private readonly int x;
    private readonly int y;
    public int X { get { return x; } }
    public int Y { get { return y; } }

    public MyPoint(int x, int y)
    {
        this.x = x;
        this.y = y;
    }
} 
```

您的查询将是：

```
var query =
    from p in pointList
    where p.X < 100
    select new MyPoint(p.X, p.Y); 
```

然后，您将方法编写为：

```
public void SomeMethod(IEnumerable<MyPoint> points)
{
    ...
} 
```

并将其称为`SomeMethod(query);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-24T06:43:11.380

我认为您正在寻找的是 Expression 类。例如，

```
public void DoSomething()
{
    User user = GetUser(x => x.ID == 12);
}

IQueryable<User> UserCollection;

public User GetUser(Expression<Func<User,bool>> expression)
{
    return UserCollection.expression;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T17:43:37.110

```
public void DoSomething(IQueryable query) { ... }

public void DoSomething<T>(IQueryable<T> query) { ... } 
```

以防万一（如果您需要传递表达式）：

```
public void DoSomething(Expression exp) { ... } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T17:49:41.463

虽然 tvanfosson 和 Jon 都是正确的，但您可以编写函数以接受`IEnumerable<T>`LINQ to Objects 产生的（您可以使您的函数通用，也可以指定您想要的特定具体通用版本，这更有可能是正确的选项） an`IEnumerable<T>`和 LINQ to SQL 生成一个`IQueryable<T>`，它实现`IEnumerable<T>`. 此选项应允许您与源无关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-14T05:56:33.033

您还可以使用以下代码：

```
 IEnumerable <TableName> result = from x in dataBase.TableName
                                     select x;     
    methodName(result);

    private void methodName (IEnumerable<TableName> result) 
    {
      codes.....
    } 
```

# php - 如何在简单的php网站的每个页面上动态添加不同的标题、关键字和描述

> ID：693193
> 
> 赞同：1
> 
> 时间：2009-03-28T17:43:13.570
> 
> 标签：php

如何在`<head>`我的简单 php 网站的每个页面中动态添加不同的标题、关键字和描述？

例如

```
<title>this is title</title>
<meta name="keywords" content="keyword1, keyword2" />
<meta name="description" content="this is description" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T17:46:25.387

您可以创建方法来返回当前页面的标题，具体取决于用户的位置，然后像这样使用它。

```
<title><?php echo get_title(); ?></title> 
```

与关键字相同

```
<meta name="keywords" content="<?php echo get_keywords(); ?>" />
<meta name="description" content="<?php echo get_description(); ?>" /> 
```

实施将取决于您在网站上的导航方式。例如，如果你只有`index.php`, 并选择 content by `$_GET["page"]`，你可以有这样的东西

```
function get_title() {
   switch($_GET["page"]) {
      case "home":
         return "Welcome to my home page";
      case "guestbook":
         return "Welcome to guestbook";
   }
} 
```

或者你可以把它全部合二为一

```
function get_headers() {
    // here set $title, $description and $keywords according to current page 
    // ....

    // then just generate html
    $html = "<title>$title</title>";
    $html .= "<meta name='description' content='$description' />";
    $html .= "<meta name='keywords' content='$keywords' />";

    return $html;
} 
```

然后再做这样的事情

```
<head>
    ...
    <?php echo get_headers(); ?>
    ... 
```

# c# - 如何在 XML 文档中引用 C# 关键字？

> ID：693196
> 
> 赞同：70
> 
> 时间：2009-03-28T17:44:49.870
> 
> 标签：c#, keyword, xml-documentation

`<see cref="switch" />`，例如，不起作用 - 我收到编译警告：`XML comment on ... has syntactically incorrect cref attribute 'switch'`

* * *

有兴趣的人的上下文...

```
/// <summary>Provides base functionality for hand-coded abstractions of API method wrappers, mostly those that abstract over
/// parameters that are required to be JSON-encoded.</summary>
public class FacebookArgs : Dictionary<String, Object>
{
    /// <summary>Initializes an instance of <see cref="FacebookArgs" />.</summary>
    public FacebookArgs() { }

    /// <summary>Intializes an instance of <see cref="FacebookArgs" />, that contains elements copied from <paramref name="dictionary "/>.</summary>
    /// <param name="dictionary"></param>
    public FacebookArgs(IDictionary<String, Object> dictionary)
        : base(dictionary) { }

    /// <summary>Gets or sets the value associated with the specified key.</summary>
    /// <param name="key">The key of the value to get or set.</param>
    /// <returns>The value associated with the specified key.</returns>
    /// <remarks>This implementation hides the base indexer implementation such that specifying a key that does not exist returns null rather than throwing a <see cref="KeyNotFoundException" />.</remarks>
    public new Object this[String key]
    {
        get
        {
            Object value;
            if (this.TryGetValue(key, out value)) return value;
            else return null;
        }
        set { base[key] = value; }
    }

    /// <summary>In derived classes, provides specialized serialization logic for specific properties contained in this object.</summary>
    /// <param name="key">The key of the property to serialize.</param>
    /// <param name="args">A reference to a dictionary of arguments that will be passed directly to a <see cref="FacebookRequest" /> object.</param>
    /// <remarks>
    /// <para>This method allows specialized serialization logic, such as JSON encoding, to be applied to specific properties.</para>
    /// <para>To implement, use a <c>switch</c> (<c>Select</c> in VB.NET) statement to filter based on <paramref name="key" /> and provide the property-specific logic.
    /// The resulting value should then be added to <paramref name="args" /> using the same <paramref name="key "/>.
    /// </para>
    /// <para>Properties that do not require additional processing (strings, integral values, etc) should be ignored.</para>
    /// </remarks>
    protected virtual void SerializeProperty(String key, ref IDictionary<String, Object> args) { }

    /// <summary>Returns a dictionary of key/value pairs suitable to be passed a <see cref="FacebookRequest" /> object.</summary>
    /// <returns>A dictionary of key/value pairs suitable to be passed a <see cref="FacebookRequest" /> object.</returns>
    /// <remarks>This method calls the <see cref="SerializeProperty" /> for each key in the object, which allows property-specific processing
    /// to be done on any property.</remarks>
    /// <seealso cref="SerializeProperty" />
    public IDictionary<String, Object> GetArgs()
    {
        IDictionary<String, Object> args = new Dictionary<String, Object>();

        foreach (String key in this.Keys)
        {
            this.SerializeProperty(key, ref args);

            if (!args.ContainsKey(key) && this[key] != null)
            {
                args.Add(key, this[key]);
            }
        }

        return args;
    }
} 
```

* * *

有问题的标签可以在`<remarks>`标签中找到`SerializeProperty`。我在冗长的文档方面犯了错误。我还计划提供一些`<example>`s，我只是还没有开始。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-03-28T18:08:18.877

cref 是指另一个成员——一个类、一个方法等。

在这种情况下，您希望它链接到什么？一般来说，您希望整体效果如何？

根据这个[优秀的 XML 文档指南](http://web.archive.org/web/20080623060531/http://thoughtpad.net/alan-dean/cs-xml-documentation.html)，`<see>`标签有一个未记录的属性`langword`：

```
<see langword="switch" /> 
```

这对你有帮助吗？只是为了看看它的作用可能值得一试。

如果您只想使用普通超链接，请使用 href 而不是 cref：

```
<see href="http://msdn.microsoft.com/en-us/library/06tc147t.aspx">switch</see> 
```

# php - Zend Framework Forms - 如何使控件成为数组

> ID：693200
> 
> 赞同：0
> 
> 时间：2009-03-28T17:47:40.500
> 
> 标签：php, zend-framework

使用 Zend 表单如何将控件（元素）设为数组？

一个示例用例：

我有一个项目列表，我希望每个项目在表单上都有自己的复选框，但这些复选框应该作为数组发布。这意味着每个复选框名称都是“item[]”。如何使用 Zend Form 实现这一点？我尝试将复选框上的 isArray 属性设置为 true，但给它们赋予相同的名称，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T18:18:08.510

[http://framework.zend.com/manual/en/zend.form.standardElements.html#zend.form.standardElements.multiCheckbox](http://framework.zend.com/manual/en/zend.form.standardElements.html#zend.form.standardElements.multiCheckbox)

# wpf - 将键盘焦点从列表框移开

> ID：693203
> 
> 赞同：1
> 
> 时间：2009-03-28T17:49:32.383
> 
> 标签：wpf, vb.net, listbox, keyboard, focus

我正在开发一个仅依赖键盘导航的 WPF (VB) 程序。

在我的程序中，我有一个最多可显示 20000 个项目的列表框。

我想要的是，当列表框具有键盘焦点时，我移动到可见的底部项目（使用 ArrowDown），我希望焦点移动到列表框外的下一个项目。我正在使用 PgUp 和 PgDown 滚动列表框内容，并使用文本搜索跳转到项目。

有没有办法检测焦点/选定的项目是否是列表框中的最后一个/第一个可见项目？

如果是这样，我可以使用：

```
ListBox1.MoveFocus(New TraversalRequest(FocusNavigationDirection.Down)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T18:56:23.580

我建议您不要这样做，用户界面的行为应该与操作系统中的其他用户界面一致。

如果您想出一个与用户界面在目标操作系统上的行为方式一致的替代用户界面，您的用户会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-23T10:09:06.557

我使用一个简单的技巧将焦点移到列表框之外：我禁用列表框，以便焦点自动移动到下一个控件，然后我再次启用列表框:)

```
Lst.IsEnabled = False
Lst.MoveFocus(New TraversalRequest(FocusNavigationDirection.Next))
Lst.IsEnabled = True 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-10T03:54:35.707

从您的解释中可以看出一点点，但是您正在寻找：

1.  当最后一个项目被选中时，导航移动到列表框之外。
2.  当尝试导航超出列表中的最后一项时，导航会从列表框中弹出。

如果 ( **1** ) 是您的目标，则可能有一个合理的解决方案，使用触发器和/或一些自定义代码处理基于所选项目和所选项目更改的事件。如果是这种情况，我将不得不同意 Tom，并建议您不要以这种方式实现它，因为如果没有以编程方式删除焦点，最后一项将永远无法选择。

如果您希望这样做（**2**），那么根据我的经验，ListBox 的自然行为是在按下 Tab 键时移动到下一个控件，并且我也针对向下箭头键进行了测试，并且它可以工作相同。当我到达列表中的最后一项时，焦点会从列表框弹出并根据其父控件弹出到下一个控件。

**更新：**我必须撤回我的原始评论，因为我上面描述的行为没有描述 WPF 中 ListBox 的默认行为，但是它是您将看到我上面描述的行为的行为（我相信这是您正在寻找的行为）在实现 ItemsControl 并指定 ItemTemplate 时。看看下面的例子。

```
<ItemsControl ItemsSource="{Binding ElementName=TheWindow, Path=ListOStrings}">
    <ItemsControl.Template>
        <ControlTemplate TargetType="{x:Type ItemsControl}">
            <Border BorderBrush="Magenta"
                    BorderThickness="1">
                <ScrollViewer>
                    <ItemsPresenter />
                </ScrollViewer>
            </Border>
        </ControlTemplate>
    </ItemsControl.Template>
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <CheckBox Content="{Binding}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

碰巧，这恰好具有您描述的行为，因为列表中的每个项目的行为几乎就像一个控件，直接作为所有其他控件的对等放置。

# c++ - 寻求对分布在多个 dll 上的单元测试 C++ 应用程序的建议

> ID：693206
> 
> 赞同：1
> 
> 时间：2009-03-28T17:50:51.430
> 
> 标签：c++, unit-testing, dll

单元测试新手，拥有一个分布在多个 dll 上的应用程序。对应用程序进行单元测试有哪些建议？如果我将单元测试放在自己的项目中，我只能测试每个dll的发布接口。大多数人都是这样吗？或者我应该将单元测试与 dll 中的代码一起放入并在那里进行测试？那时协调所有测试的最佳方式是什么？

我看到的使用各种框架的大多数示例都没有真正解决这个问题，我在其他地方搜索过，但没有找到太多信息。

谢谢。

更新：

我想澄清一下，我在 dll 中有 A 类和 B 类。B 类被 A 类使用，但只有 A 类被暴露。我想在重构这个现有代码之前进行单元测试。所以问题是我应该将单元测试与 dll 代码一起直接测试 A 类和 B 类和/或在单独的项目中进行单元测试并通过暴露的 A 类测试 A 类和 B 类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T18:00:39.067

我的家庭滚动方法是建立两个不同的目标：

*   DLL 本身
*   一个测试可执行文件

代码库是相同的，除了 main.cpp 将包含一个用于 DLL 的 DLL main 和一个用于测试可执行文件的标准 C/C++ **int main() 。**所有单元测试都与实际代码一致，由预处理器#define 控制：

```
#ifdef TESTING
tests here    
#endif 
```

可执行文件的 main() 通过注册框架调用所有测试。

大多数时候，我使用定义了 TESTING 的可执行版本。当我想构建 DLL 时，我会切换目标并取消定义 TESTING。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T19:20:34.833

> 如果我将单元测试放在自己的项目中，我只能测试每个dll的发布接口。

与客户端代码无法访问的 DLL 中的功能相反？

如果代码对 DLL 公开的函数没有贡献，则将其从代码库中删除。如果是这样，那么您可以编写一个测试该代码路径的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T10:57:33.367

一般来说，彻底测试 DLL 的公共接口就足够了，而且正如 Pete 指出的那样，确实应该使用所有代码路径。

关于 Neils 的回答，选择一个不需要您构建 EXE 而是直接在 DLL 上运行的测试框架可以进一步简化问题。作为 cfix 的作者，我自然会推荐给 cfix 一个尝试：[http ://www.cfix-testing.org/](http://www.cfix-testing.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T11:21:53.947

C++ 中的单元测试意味着类测试。DLL 测试更像是集成测试。两者都是必要的，但最好在尽可能低的级别进行测试。看看 v-model：[http://en.wikipedia.org/wiki/V-Model_(software_development)](http://en.wikipedia.org/wiki/V-Model_(software_development))。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T22:13:43.737

我使用[boost.test](http://www.boost.org/doc/libs/1_38_0/libs/test/doc/html/index.html)来测试我的 dll 和可执行文件。我为每个要测试的 dll 和 exe 创建一个单独的单元测试项目/可执行文件。因为我测试了 dll 的内部结构，所以我没有将它们与测试项目链接，而是在项目中直接包含我想要测试的源代码。最后，自动构建运行所有单元测试项目。

我们使用[CMake](http://www.cmake.org/)来构建我们的项目，它有一个很好的组件 CTest，它为我们捆绑了所有测试并将它们作为一个组运行。

# objective-c - 在 Objective-C 中扩展使用 @synthesize 生成的属性

> ID：693217
> 
> 赞同：1
> 
> 时间：2009-03-28T17:59:33.267
> 
> 标签：objective-c

假设我有一个这样声明的@property：

```
@property (readwrite,retain) NSObject *someObject; 
```

我合成它是这样的：

```
@synthesize someObject = _someObject; 
```

这会为我生成 getter/setter。此外，根据文档，setter 将内置线程安全代码。

现在，假设我想向 setSomeObject: 方法添加一些代码。有什么方法可以从@synthesize 扩展现有的？我希望能够重用它自动生成的线程安全代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T21:17:03.287

你可以定义一个合成的“私有”属性，（把它放在你的`.m`文件中）

```
@interface ClassName ()

// Declared properties in order to use compiler-generated getters and setters
@property (nonatomic, strong <or whatever>) NSObject *privateSomeObject;

@end 
```

然后像这样在`ClassName`（`.h`和`@implementation`部分）的“公共”部分手动定义一个getter和setter，

```
- (void) setSomeObject:(NSObject *)someObject {
  self.privateSomeObject = someObject;
  // ... Additional custom code ...
}

- (NSArray *) someObject {
  return self.privateSomeObject;
} 
```

您现在可以`someObject`像往常一样访问“属性”，例如`object.someObject`. 您还可以获得自动生成`retain`/ `release`/的优势`copy`，与 ARC 兼容并且几乎不会失去线程安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T18:14:58.080

相当于`@synthesize`：

```
-(void)setSomeObject:(NSObject *)anObject {
    [anObject retain];
    [someObject release];
    someObject = anObject;
} 
```

或者

```
-(void)setSomeObject:(NSObject *)anObject {
    if(someObject != anObject) {
        [someObject release];
        someObject = [anObject retain];
    }
} 
```

因此您可以使用此代码并扩展该方法。

但是，正如您所说，此代码可能不是线程安全的。

为了线程安全，您可能想看看[`NSLock`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nslock_Class/Reference/Reference.html)or `@synchronized`（感谢[unwesen](https://stackoverflow.com/users/41081/unwesen)指出这一点）。

# domain-driven-design - DDD：在哪里保留域接口，基础设施？

> ID：693221
> 
> 赞同：25
> 
> 时间：2009-03-28T18:03:43.957
> 
> 标签：domain-driven-design

将领域层的所有接口（模块、模型、实体、领域服务等）全部归入基础设施层是否有意义？如果没有，创建一个“共享”项目/组件将所有这些组合到一个共享库中是否有意义？毕竟，“基础设施层”的定义包括“域、应用程序和 UI 层的共享库”。

我正在考虑围绕 DDD 层设计我的代码库：UI、应用程序、域、基础设施。这将创建 4 个项目。我的意思是，您从域层引用基础设施层。但是，如果您在域层项目中定义接口，例如 IPost，那么当您在定义 IPostRepository.Save(IPost post) 方法时必须从基础设施项目中引用域层项目时，您将有一个循环引用. 因此，“定义共享库中的所有接口”的想法。

也许存储库不应该期望保存对象（IPostRepository.Save(IPost post); 而是期望对象的参数（尽管这可能是 Save() 中的一长串参数）。鉴于，这可能是一种理想的情况，显示对象何时变得过于复杂，并且应该为它寻找额外的值对象。

想法？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-01T12:33:57.680

关于将存储库放在哪里，我个人总是将存储库放在专用的基础设施层（例如.MyApp.Data.Oracle）中，但声明存储库必须在域层中符合的接口。
在我的项目中，应用层必须访问域和基础设施层，因为它负责配置域和基础设施层。
应用层负责将适当的基础设施注入到域中。域不知道它正在与哪个基础设施通信，它只知道如何调用它。当然，我使用诸如 Structuremap 之类的 IOC 容器将依赖项注入到域中。同样，我并没有说这是 DDD 推荐的构建项目的方式，这只是我构建应用程序的方式。干杯。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T20:01:20.717

我是 DDD 的新手，所以如果您不同意，请随时发表评论，因为我在这里学习。

我个人不明白为什么你应该从你的域中引用基础设施层。在我看来，域不应该依赖于基础设施。域对象应该完全不知道它们在哪个数据库上运行或使用哪种类型的邮件服务器来发送邮件。通过从基础设施中抽象领域，更容易重用；因为域不知道它在哪个基础设施上运行。

我在代码中所做的是从我的基础设施层引用域层（但不是相反）。存储库知道域对象，因为它们的作用是保存域的状态。我的存储库包含我的根聚合的基本 CRUD 操作（get(id)、getall()、save(object)、delete(object)，并从我的控制器中调用。

我在上一个项目中所做的（我的方法不是纯粹的 DDD，但效果很好）是我用接口抽象了我的存储库。根聚合必须通过传递具体类型的存储库来实例化：

必须使用存储库的 Get(ID) 或 Create() 方法通过存储库实例化根聚合。构造对象的具体存储库通过自身传递，以便聚合可以保留他的状态和他的子对象的状态，但不知道存储库的具体实现。例如：

```
public class PostRepository:IPostRepository
{
     ...
    public Post Create()
    {
        Post post=new Post(this);
        dbContext.PostTable.Insert(post);
        return post;
     }
     public  Save(post)
     {
         Post exitingPost=GetPost(post.ID);
         existingPost = post;
         dbContext.SubmitChanges();
     }
}

public class Post
{

     private IPostRepository _repository
     internal  Post(IPostRepository repository)
     {
        _repository = repository;
     }
     ...
    Public Save()
    {
        _repository.Save(this);
     }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T22:23:03.403

我建议你考虑[洋葱架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-3/)。它非常适合 DDD。这个想法是您的存储库接口位于 Domain 之外的一层并直接引用实体：

`IPostRepository.Save(Post post)`

域根本不需要了解存储库。

基础设施层不被域或其他任何人引用，并且包含存储库的具体实现以及其他与 I/O 相关的内容。在这种情况下，具有各种帮助程序的公共库称为 Application Core，任何人都可以引用它。

# java - Eclipse 自动完成显示“内容辅助期间的问题”弹出窗口

> ID：693225
> 
> 赞同：0
> 
> 时间：2009-03-28T18:06:25.213
> 
> 标签：java, eclipse, ide

最近我在 Eclipse 中收到了这两条奇怪的错误消息。这些发生在我第一次按下`.`时，例如在`MyClass.myMethod()`，按下`.`会导致这些消息弹出。它们仅在 Eclipse 启动后第一次出现，并且在下次重新启动之前不会再次出现。

**第一个错误：**

[![](https://i.stack.imgur.com/4FkGo.jpg)](https://i.stack.imgur.com/4FkGo.jpg)

**第二个错误：**

[![](https://i.stack.imgur.com/Zf0kP.jpg)](https://i.stack.imgur.com/Zf0kP.jpg)

这些可能与我在 Eclipse 上安装的一些新更新有关。任何想法如何摆脱它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T19:01:30.073

应该记录任何 Eclipse 错误，因此请查看您是否可以在*错误日志*视图中看到它们。通过按**Ctrl+Shift+Q、L**或使用菜单**Window > Show View > Error Log**打开它。

正如 Yuval A[所建议](https://stackoverflow.com/questions/693225/weird-error-in-eclipse-autocomplete/693233#693233)的那样，要么找到现有的错误（并阅读任何解决方法），要么在[bugzilla](https://bugs.eclipse.org/bugs/buglist.cgi?quicksearch=content%2Bassist)中报告新的错误- 通过报告问题，您将帮助 Eclipse 开发人员和用户（更不用说您自己了）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T18:14:28.503

我有时也会得到这些。我相信 Eclipse 中的错误。

查看[内容辅助错误列表](https://bugs.eclipse.org/bugs/buglist.cgi?quicksearch=content+assist)。如果没有与您的具体情况相关的内容，您可以打开一个错误。

# iphone - 有没有办法在不使用 youtube 或自定义应用程序的情况下从网站在 iphone 上播放视频？

> ID：693228
> 
> 赞同：0
> 
> 时间：2009-03-28T18:09:36.190
> 
> 标签：iphone, video

我希望网站查看者能够在 iphone 上播放视频，而无需将视频发布到 youtube，也无需安装任何 iphone 应用程序。这里还有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T18:25:23.547

如果您托管 Quicktime 电影，则无需任何其他软件即可正常播放。我认为，Apple 网站上的某处有一个“为 iPhone 设计网页”文档，其中提供了有关支持格式的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T18:20:10.937

我相信只要有一个可以快速播放的视频文件的链接就可以了

# c# - 如何在 C# 中将 dword 转换为字节数组

> ID：693236
> 
> 赞同：0
> 
> 时间：2009-03-28T18:15:10.733
> 
> 标签：c#, byte, dword

您可能已经知道，我正在迁移到 C#，而 C++ 中的某些东西看起来有所不同。

C++ 代码

```
 BYTE packetBuffer[32] = {0};
    *(LPWORD)(packetBuffer + 0) = 0xC;
    *(LPWORD)(packetBuffer + 2) = 0x5000;
    *(LPDWORD)(packetBuffer + 6) = dwArgs[13];
    *(LPDWORD)(packetBuffer + 10) = *(keyArray2 + 0);
    *(LPDWORD)(packetBuffer + 14) = *(keyArray2 + 1); 
```

注意 dwArgs 和 keyArray2 是“DWORD 数组”

这是它的放置方式

1.  数据包缓冲区 [0] 将为 0xC
2.  数据包缓冲区 [1] 将为 0x00
3.  数据包缓冲区 [2] 将为 0x50
4.  数据包缓冲区 [3] 将为 0x00

等等

如何在 C# 中做到这一点？

我试过这个，但它不起作用

```
packetBuffer[0] = 0xC;
packetBuffer[2] = (byte)0x5000; //error
packetBuffer[6] = (byte)dwArgs[13]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T18:20:29.067

您可以使用[`BitConverter`](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)将数据与字节数组相互转换。不幸的是，没有工具可以复制到现有数组中。如果您需要，我`EndianBitConverter`在我的[MiscUtil 库](http://pobox.com/~skeet/csharp/miscutil)中自己的库允许这样做，当然也允许您指定要使用的字节序。（`BitConverter`在 .NET 中通常是小端 - 您可以使用该`IsLittleEndian`字段进行检查。）

例如：

```
EndianBitConverter converter = EndianBitConverter.Little;
converter.CopyBytes((short) 0xc, packetBuffer, 0);
converter.CopyBytes((int) 0x5000, packetBuffer, 2);
converter.CopyBytes(dwArgs[13], packetBuffer, 6); 
```

等等。`int`第二次调用 to 中的强制转换`CopyBytes`是多余的，但为了清楚起见（请记住前一行！）。

编辑：如果您宁愿坚持使用 .NET 标准库，则另一种选择是使用 .NET 标准[`BinaryWriter`](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx)库[`MemoryStream`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T18:22:50.057

你不能。C# 是强类型的。一个变量只有一种类型，而且只有一种类型。不允许使用像 C++ reinterpret_cast 这样的诡计。

不过，有几种方法可以解决您的问题。第一个也是显而易见的，是使用内置的序列化框架。除非必须，否则不要费心编写自己的序列化代码。而在 .NET 中，您不必经常这样做。

第二种是使用 BitConverter 类（GetBytes 方法应该可以完成转换为字节数组的技巧）

# smalltalk - Smalltalk 中的异步 GUI 更新

> ID：693244
> 
> 赞同：3
> 
> 时间：2009-03-28T18:19:43.887
> 
> 标签：smalltalk

我想知道是否有人可以帮助我解决 Smalltalk 中的以下问题。特别是Cincoms Visualworks。

我想编写一个简单的 GUI，它具有三个字段并按如下方式处理它们：

第一个字段输入一个数字（例如 5）。

第二个字段只显示第一个字段的两倍（因此在本例中显示为 10）

现在，有趣的一点……第三个字段显示了一个完全不同的类（我们称之为 X 类）的值。但是，每当 X 类中的值发生更改时，该值必须显示在 GUI 上——它不能等待来自更新按钮的按键。X 类中的值可以来自（例如）工作区。

我虽然可以通过方面适配器来做到这一点，但我似乎无法让“第三个字段值”异步更新。

任何技术、提示或技巧都将受到热烈欢迎——（尤其是代码片段！！）。

谢谢凯文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T18:09:40.907

这是我自己整理的。在尝试了依赖机制（工作正常 - 但根本不需要）后，查看公告（感谢 Cincom 的 James - 个人交流）我发现我需要做的就是简单地创建一个方法并向其发送带有参数的消息（我的值）该方法然后简单地使用“值：”消息更新值持有者（即 GUI 字段的方面）。我对 Smalltalk 的研究越多，我就越喜欢它！

# c++ - VS 2008 - 链接到旧的 C 运行时

> ID：693250
> 
> 赞同：3
> 
> 时间：2009-03-28T18:21:29.937
> 
> 标签：c++, visual-studio-2008

如何使用 Visual C++ 2008 进行编译并链接到旧版本的 C 运行时（我想要版本 7 而不是 9）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T18:34:42.777

我认为您需要做的是为您的项目找到 Linker -> Input 属性页，并告诉它专门忽略 msvcrtd.dll / msvcrt.dll，然后显式链接到您想要的版本（完整路径）。不知道如果他们有相同的名字会发生什么......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-27T10:16:05.070

VS 只是一个 IDE。你可以用它来构建一个旧的工具集，但它需要一些调整——你需要安装两个并排的 VS 安装（例如 VS2008 + vs6）并加载不同的 VSARGS。从 Bojan Resnik[一步一步](http://resnikb.wordpress.com/2009/10/28/using-visual-studio-2008-with-visual-c-6-0-compiler/)看这个优秀的。

请注意，在 VS2010 中，此解决方案不适用 - 它有一个新的每个项目设置->常规->“平台工具集”。如果需要，安装[它](http://daffodil.codeplex.com/)并手动更新项目设置->VC++ 目录（或手动更改默认[设置](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/dc9f28f0-4f56-4da2-8413-2116c10b31a6)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T23:22:46.000

我认为微软明确表示“不要这样做”。问题是，msvcrt.dll 现在被认为是操作系统的一部分，而不是任何特定应用程序的一部分，也不是可再发行的。MS 可能会使用 Service Pack 对其进行更新，并且可能会显着改变行为，就像他们对 XP SP2 所做的那样。这会破坏应用程序！所以......[不要这样做](http://msdn.microsoft.com/en-us/library/abx4dbyh.aspx)。

# asp.net - 在 ASP.NET 中调用类

> ID：693254
> 
> 赞同：1
> 
> 时间：2009-03-28T18:23:17.763
> 
> 标签：asp.net, vb.net, class, class-design

我知道我的 ASP.NET，但我不得不承认，我对类很笨，不确定它们是如何工作的。也没有和他们合作过，但我想。但我所知道的是，这是一个我可以保留代码以供重复使用的地方？我的课程将如何使用我的代码？

所以这是我在大约 3 个表单上使用的代码 - 但我想将它保存在 1 个位置，然后在我单击 btnSubmit 时调用它。

```
Dim strConnection As String = ConfigurationManager.ConnectionStrings("ConnectionString").ConnectionString
    Dim con As SqlConnection = New SqlConnection(strConnection)
    Dim cmd As SqlCommand = New SqlCommand
    Dim objDs As DataSet = New DataSet
    Dim dAdapter As SqlDataAdapter = New SqlDataAdapter

    cmd.Connection = con
    cmd.CommandType = CommandType.Text
    cmd.CommandText = "SELECT distinct FIELD FROM TABLE order by FIELD"

    dAdapter.SelectCommand = cmd
    con.Open()
    dAdapter.Fill(objDs)
    con.Close()

    If (objDs.Tables(0).Rows.Count > 0) Then

        lstDropdown.DataSource = objDs.Tables(0)
        lstDropdown.DataTextField = "FIELD"
        lstDropdown.DataValueField = "FIELD"
        lstDropdown.DataBind()
        lstDropdown.Items.Insert(0, "Please Select")
        lstDropdown2.Items.Insert(0, "Please Select")

    Else

        lblMessage.Text = "* Our Database seem to be down!"

    End If 
```

我必须在这里放什么来执行上面的代码？

```
Protected Sub btnSubmit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSubmit.Click

    ?????????????????????????????????

    End Try

End Sub 
```

艾蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T18:40:44.697

一个类（在 VB.Net 中）被定义为

```
Public Class Person

private _firstName as string
private _lastName as string

'''Constructor with no params
public Sub New()
  _firstName = ""
  _lastName = ""
End Sub

'Contructor with params
Public Sub New(FirstName as String, LastName as String)
  _firstName = FirstName
  _lastName = LastName
End Sub

Public Property FirstName As String
 Get
  return _firstName
 End Get
 Set(value as String)
  _firstName = value
 End Set
End Property

Public Property LastName As String
     Get
      return _lastName
     End Get
     Set(value as String)
      _lastName = value
     End Set
    End Property

Public Function HitHomeRun() As Boolean
  ....'Do some stuff here
End Function
End Class 
```

然后，您可以实例化该类并调用其成员。

```
Dim p as New Person()
p.FirstName = "Mike"
p.LastName = "Schmidt"

dim IsHomeRunHit As Boolean = p.HitHomeRun() 
```

[了解有关在 VB.Net 中创建和使用类的更多信息。](http://msdn.microsoft.com/en-us/library/ms973814.aspx)

这是一个非常大的话题，可以用许多不同的方式来定义。但通常你冒险进入的是 N 层架构。

数据访问层
业务逻辑
UI 逻辑

现在可以在您的问题中构建类的方式可以完成，但从长远来看，容易出现维护恐惧并且可修改性被缩短。更不用说很容易出现错误。在 UI 层中放置任何类型的数据访问代码都是不好的做法。

这就是在每一层中具有单独的类层（关注点分离）的强大之处，使您能够重用代码并能够轻松修改以适应未来的扩展/功能等。这是进入软件架构的一个非常广泛的主题放到一个帖子里。

但是，如果您真的对此感兴趣，这里有一些链接可以为您指明正确的方向。

1.  [来自维基百科的 N 层架构](http://en.wikipedia.org/wiki/N-tier_architecture)
2.  [数据访问层](http://en.wikipedia.org/wiki/Data_access_layer)
3.  [业务逻辑层](http://en.wikipedia.org/wiki/Business_logic_layer)
4.  [Martin Fowler 是建筑学专家](http://www.martinfowler.com/)

有软件可以减轻 DAL 的痛苦。
1\. [Linq-To-SQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx) 通过 .Net 对象（编译查询）查询数据的能力
2\. Linq-To-SQL 的[实体框架](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx) 版本 2

这可以有效地替换您所有的 SQL 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T18:46:52.170

如果你想重用代码，你应该把它放在一个单独的项目中。这样您就可以将该项目添加到不同的解决方案中（或仅引用已编译的 dll）。

在您的 Web 项目中，您添加对项目的引用（或者如果您之前编译过 dll 并且不想将项目添加到解决方案中，则添加对 dll 的引用）。

在您的新项目中添加一个类文件，例如名为`UIHelper`. 在为您创建的类骨架中，您添加一个方法。由于该类在一个单独的项目中，它不知道页面中的控件，因此您必须在方法调用中发送对这些控件的引用：

```
Public Shared Sub PopulateDropdowns(lstDropdown As DropDownList, lstDropdown2 As DropDownList)

   ... here goes your code

End Sub 
```

在您的页面中，您可以通过引用页面中的下拉列表来调用它：

```
UIHelper.PopulateDropdowns(lstDropdown, lstDropdown2) 
```

这会让你开始。还有很多关于使用类的知识......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T18:32:06.447

我有时会创建一个“Common”类，并在其中放入我想从不同地方调用的公共共享方法。

这些方面的东西：

```
Public Class Common

Public Shared Sub MyMethod
  'Do things.
End Sub

End Class 
```

然后我会使用它来调用它：

```
Common.MyMethod 
```

显然，您可以使用所需参数的子/函数定义。

对不起，如果我的 VB.NET 代码有点不对劲。我通常使用 C#。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T16:28:04.523

我认为您应该考虑使用 Visual Studio 设计器工具来进行数据访问和数据绑定。搜索类型化数据集

# .net - 如何获得正则表达式捕获的偏移量？

> ID：693255
> 
> 赞同：1
> 
> 时间：2009-03-28T18:24:04.843
> 
> 标签：.net, regex, offset

我正在尝试在 .NET 中获取正则表达式捕获的偏移量，就像`.IndexOf()`会返回一样。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T18:28:29.873

的结果`Regex.Match`将是一个`Match`对象。检查那个的 Index 属性

```
Match m = Regex.Match(input, pattern);
int i = m.Index; 
```

hth

# c - 如何在原始输入模式下发送终端转义序列？

> ID：693257
> 
> 赞同：0
> 
> 时间：2009-03-28T18:24:21.317
> 
> 标签：c, terminal, escaping, sequence

我有一个程序在原始模式下使用终端，我想移动光标。我在哪里可以找到这个转义序列，如何从我的 c 程序内部将它发送到终端？

这是我目前拥有的：

```
char code[4];
code[0] = 27;
code[1] = 91;
code[2] = '*';
code[3] = 'D';
write(1, code, 4); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T18:36:45.110

如果您想控制全屏，那么您应该查看[ncurses](http://www.gnu.org/software/ncurses/)库。这是一个用于全屏控制台程序的简单库，其中包含

*   文字全屏定位
*   使用全键盘，包括功能键、插入/删除等
*   使用属性进行着色，突出显示文本等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T18:32:42.610

您想使用[termcap](http://en.wikipedia.org/wiki/Termcap)来获取此信息，因为它会有所不同，具体取决于用户所在的终端类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T18:37:17.513

我建议您仔细研究[curses](http://www.opengroup.org/onlinepubs/9693989999/toc.pdf)或[ncurses](http://www.gnu.org/software/ncurses)库，并计划使用其中一个，而不是自己动手。您的目标应该是使用终端描述的[terminfo](http://en.wikipedia.org/wiki/Terminfo)系统，而不是旧的[termcap](http://en.wikipedia.org/wiki/Termcap)系统。另请参阅 O'Reilly 的书籍“ [Termcap 和 Terminfo](http://oreilly.com/catalog/9780937175224) ”以及我最喜欢的书名（主要是因为我在编程时似乎花了很多时间诅咒）“ [Progamming With Curses](http://oreilly.com/catalog/9780937175026) ”。（然而，那本书很古老——1986 年——还有其他关于同一主题的较新的书籍可能是更好的选择；不过，我仍然喜欢这个标题。）

# class - 如何在 CodeIgniter 中创建库类的多个实例？

> ID：693260
> 
> 赞同：5
> 
> 时间：2009-03-28T18:24:44.093
> 
> 标签：class, codeigniter, instance

我想在 CodeIgniter 中创建一个类的几个实例。我已经将我的类创建为一个库，但无法弄清楚用于创建多个实例的语法。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-28T20:31:02.403

来自 CodeIgniter 用户指南：

[CI 用户指南：加载程序类](http://codeigniter.com/user_guide/libraries/loader.html)

**将库分配给不同的对象名称**

如果第三个（可选）参数为空，则通常会将库分配给与库同名的对象。例如，如果库名为 Session，它将被分配给名为 $this->session 的变量。

如果您喜欢设置自己的类名，可以将其值传递给第三个参数：

```
$this->load->library('session', '',
 'my_session'); 
```

现在访问会话类。使用：

```
$this->my_session 
```

我想这就是你要找的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-10-19T21:00:48.363

我知道这个帖子早已过去，但这是我在寻找答案时遇到的问题之一。所以这是我的解决方案...

这是PHP。将您的类创建为一个库，使用标准 CI 加载器类加载它，但可以像在常规 PHP 脚本中一样使用它。

建立你的班级：

```
class My_class {

    var $number;

    public function __construct($given_number){
        $number = $given_number;
    }

    public function set_new_num($given_number){
        $number = $given_number;
    }
} 
```

加载它：

```
// This will load the code so PHP can create an instance of the class
$this->load->library('My_class'); 
```

然后在需要的地方实例化并使用该对象：

```
$num = new My_class(24);

echo $num->number;
// OUTPUT: 24

$num->set_new_num(12);

echo $num->number;
// OUTPUT: 12 
```

我唯一使用`$this->my_class`的是调用我编写的静态函数。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-15T06:45:38.933

很抱歉恢复这个话题，但我想我可能有一些合理的补充。

您可以这样做来添加一个类的多个实例。我不知道它是否违反了 Codeigniter 标准用法，但似乎比加载一个库（创建`$this->library_name`未使用的库）然后使用“new”关键字创建 2 个更多实例更 Codeigniterish。

```
$this->load->library( 'my_library', '', 'instance1' );
$this->load->library( 'my_library', '', 'instance2' );

$this->instance1->my_class_variable = 1; 
$this->instance2->my_class_variable = 2; 

echo $this->instance1->my_class_variable; // outputs 1
echo $this->instance2->my_class_variable; // outputs 2 
```

我在我的代码中使用它来生成不同的菜单。我有一个“菜单”类和每个菜单的不同实例，每个菜单都有不同的菜单项。

# php - 如何从命令行同步 FTP 目录？

> ID：693265
> 
> 赞同：7
> 
> 时间：2009-03-28T18:27:22.870
> 
> 标签：php, ftp, synchronization, copy

我有一个包含 PHP 文件和其他文件的网站。我想在我的本地网站副本和服务器上的网站之间进行一键同步。如果 Eclipse PDT 有一个命令行实用程序或插件来执行此操作，那就太好了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-28T18:37:11.257

我会推荐[lftp](http://lftp.yar.ru/)。它是一个复杂的、可编写脚本的命令行 FTP 客户端。

> ```
>  lftp has builtin mirror which can download or update a whole
>  directory tree. There is also  reverse  mirror  (mirror  -R)
>  which  uploads or updates a directory tree on server. Mirror
>  can also synchronize directories between two remote servers,
>  using FXP if available. 
> ```

lftp -f mirror.sh

**镜像.sh**

```
open sftp://<username>:<password>@<ip address>
mirror -c /<source> /<destination>
exit 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-28T19:46:06.800

我找到了 WinSCP。它是 FTP，免费和开源： [http ://winscp.net/eng/docs/start](http://winscp.net/eng/docs/start)

它可以从命令行使用文件比较（同步它）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-28T18:29:51.273

有一个名为**[FTP Synchronizer](http://www.ftpsynchronizer.com/)**（适用于 Windows）的工具，可以从命令行运行。如果不使用任何 FTP 库，您将无法通过 FTP 同步文件。这个库越成熟，它同步文件的速度就越快（例如，它可以在其内部数据库中缓存已经同步的文件信息）。

不喜欢 FTP 同步器？[谷歌替代](http://www.google.com/search?q=ftp+synchronization)。

*   [FTP 同步](http://www.ftpsynchronizer.com/)器 - Windows
*   [BatchSync FTP](http://www.sitedesigner.com/batchsync.htm) - Windows
*   [同步它](http://www.grigsoft.com/wndsync.htm)- Windows
*   [ScriptFTP](http://www.scriptftp.com/) - Windows
*   [Weex](http://weex.sourceforge.net/) - 免费、开源、Unix
*   [code.google.com 上的ftpsync2d](http://code.google.com/p/ftpsync2d/) - 免费、开源、Python

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T18:44:27.447

一年多以来，我一直在我的专用 Windows 服务器上使用[scriptFTP](http://www.scriptftp.com)来将我的数据库备份目录与我的本地服务器同步。这是一款出色的产品，可让您编写脚本（达到相当复杂的水平）并安排几乎任何 FTP 任务。

我与产品没有任何联系——只是一个印象深刻的用户。该产品准确地解决了它旨在解决的问题，并且对我来说完全可靠。它是商业的——35 美元——但这是我花在软件上的最好的 35 美元之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-26T07:09:00.907

你可以试试 Aptana ( [http://www.aptana.org/studio/download](http://www.aptana.org/studio/download) )，它提供了一个文件传输工具来使用 FTP 将项目与远程服务器同步。您可以使用脚本视图启用一个不错的功能：保存时上传当前文件！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-18T04:19:21.433

PhpStorm刚刚在他们最优秀的 PHP IDE 中[添加了双向同步（通过 FTP 和其他方式） 。](http://blog.jetbrains.com/webide/2011/11/phpstorm-webstorm-3-0-eap-110-437/)此功能在[当前 3.0 EAP](http://confluence.jetbrains.net/display/WI/Web+IDE+EAP)（测试版）中，不在 2.1 版本中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-21T15:44:56.217

我做了一个简单的脚本

```
#!/bin/bash

FTPLOCALFOLDER=$1
FTPLINK=$2

ls "$FTPLOCALFOLDER" > "./filesdownloaded.txt"

curl -sS "$FTPLINK" | grep -oE "(?href=\").*?(?\")" | awk -F '"' '{print $2}' > "./filesinlink.txt"

grep -v -f "./filesdownloaded.txt" "./filesinlink.txt" > "./filestodownload.txt"

echo "Start downloading"
while read p; do
    echo "downloading..... $p from $FTPLINK$p"
    wget "$FTPLINK""$p" -O "$FTPLOCALFOLDER""$p"
done < "./filestodownload.txt" 
```

你可以像这样使用：

./wgetSync.sh <本地文件夹> <FTPLINK>

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2011-12-15T23:46:43.613

在我看来，这是一个完美的版本控制软件应用程序。选择[mercurial](http://mercurial.selenic.com/)或[git](http://git-scm.com/)并将其用于两台机器上的目录中的版本控制和同步。Mercurial 总体上对用户更加友好，并且在 Windows 上的安装和显示更流畅，尽管在 Windows 上设置 git 也不再那么麻烦。

# java - 在哪里可以找到 Java 或 Oracle 中现代投资组合统计的实现（例如，锐化比率、排序比率等）

> ID：693269
> 
> 赞同：2
> 
> 时间：2009-03-28T18:30:32.893
> 
> 标签：java, oracle, statistics, finance

我需要一个 java 组件或 oracle 包来实现“现代投资组合理论”中的所有公式。（它们不需要是开源的，它们可以是商业组件。）

我的搜索还没有找到任何合适的东西。

对此的任何帮助将不胜感激，我想购买一个组件来执行此操作，而不是自己编写它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-30T07:14:29.490

[ojAlgo 具有 Markowitz 模型实现](http://www.ojalgo.org/generated/org/ojalgo/finance/portfolio/MarkowitzModel.html)以及与现代投资组合理论相关的其他类的集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T19:24:22.093

[WebCabComponents](http://www.webcabcomponents.com/Java/api/portfolio/index.shtml)似乎有一个用于进行投资组合理论和马科维茨相关工作的库，[这](http://www.ibm.com/developerworks/java/library/j-benchmark2/index.html)意味着它将执行夏普比率工作。

# php - Zend上的Php，如何转义查询的变量？

> ID：693270
> 
> 赞同：10
> 
> 时间：2009-03-28T18:30:51.647
> 
> 标签：php, mysql, zend-framework, sql-injection

我在 Zend Framework 中做一些查询，我需要确保在下一种格式中没有 SQL 注入是可能的。我可以使用 mysql_escape(deprecated) 并且不会做所有的工作。如果我尝试使用 real_mysql_escape，它将无法获取与数据库的连接，并且我无法找到 zend_filter 将如何解决问题。

我正在做的查询（简化）具有以下语法：

```
 $db = Zend_Registry::get('db'); 
    $select = "SELECT COUNT(*) AS num
                FROM message m
                WHERE m.message LIKE '".$username." %'";
    $row = $db->fetchRow($select); 
```

使用此框架防止 SQL INJECTION 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-28T18:41:08.050

简单的：

```
$db->quote($username); 
```

所以：

```
 $username = $db->quote($username . '%');
   $select = 'SELECT COUNT(*) AS num
                                FROM message m
                                WHERE m.message LIKE ' . $username;
   $row = $db->fetchRow($select); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-28T18:40:48.737

```
$sql = 'SELECT * FROM messages WHERE username LIKE ?';
$row = $db->fetchRow($sql, $username); 
```

**参考**： http: [//framework.zend.com/manual/en/zend.db.html](http://framework.zend.com/manual/en/zend.db.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-12T10:36:21.337

使用模型时，您可以使用：

```
$bugs = new Bugs();
$row = $bugs->fetchRow($bugs->select()->where('bug_id = ?', 1)); 
```

# sql - SQL INSERT/SELECT 不在插入表中

> ID：693286
> 
> 赞同：4
> 
> 时间：2009-03-28T18:43:43.517
> 
> 标签：sql, insert

```
INSERT INTO     `tableA`
SELECT          `Col1`, 
                `Col2`,
                 NOW() 

FROM            `tableB`

WHERE           tableA.Col1 is not already in tableB.Col1 
```

我无法正确使用 WHERE 子句来确保从 tableA 复制的记录只出现在表 B 中一次......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T18:47:29.593

应该读：

其中 tableA.col1 不在（从表 B 中选择 col1）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T20:27:55.997

您确实需要 SQL-2003 MERGE 语句。我已经从下面的标准（怪诞，但这是你的 SQL 标准）中包含了 MERGE 语句的 BNF（第 14.9 节，p837）。翻译后，可能会转化为：

```
MERGE INTO TableA
    USING TableB ON TableA.Col1 = TableB.Col1
    WHEN NOT MATCHED INSERT (Col1, Col2, Col3)
                     VALUES(TableB.Col1, TableB.Col2, NOW()); 
```

我没有通过一个知道 MERGE 语句的 SQL DBMS 运行它——这意味着它可能存在错误。请注意，标准中有一个 WHEN MATCHED 子句可以接受 UPDATE；IBM DB2 还支持 2003 标准中没有的 DELETE 子句（不确定 2008 标准）。

* * *

### 14.9 `<merge statement>`(p837)

> 有条件地更新表的行，或将新行插入表中，或两者兼而有之。

```
<merge statement>    ::= 
         MERGE INTO <target table> [ [ AS ] <merge correlation name> ]
         USING <table reference> ON <search condition>
         <merge operation specification>

<merge correlation name>    ::=
         <correlation name>

<merge operation specification>    ::=
         <merge when clause> ...

<merge when clause>    ::=
         <merge when matched clause> |
         <merge when not matched clause>

<merge when matched clause>    ::=
         WHEN MATCHED THEN <merge update specification>

<merge when not matched clause>    ::= 
         WHEN NOT MATCHED THEN <merge insert specification>

<merge update specification>    ::=   UPDATE SET <set clause list>

<merge insert specification>    ::= 
         INSERT [ <left paren> <insert column list> <right paren> ]
         [ <override clause> ] VALUES <merge insert value list>

<merge insert value list>    ::= 
         <left paren> <merge insert value element>
         [ { <comma> <merge insert value element> }... ] <right paren>

<merge insert value element>    ::=
         <value expression> |
         <contextually typed value specification> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T18:56:22.193

您可以使用[INSERT ... ON DUPLICATE KEY UPDATE](http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html)语法。

# mysql - 如何使用 hash('sha256', $salt . $password) 创建一个 mySQL 用户？

> ID：693288
> 
> 赞同：4
> 
> 时间：2009-03-28T18:44:04.860
> 
> 标签：mysql, hash, passwords, salt

我肯定错过了什么。

我想为仅选择事务设置数据库用户帐户，但 mysql 不允许我在创建用户帐户时为密码选择哈希方法。

这失败了：

```
GRANT SELECT ON myDB.* TO 'selectuser'@'localhost' 
IDENTIFIED BY hash('sha256', 'salted-myfakelongrandompasswordstring'); 
```

ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'hash('sha256', 'salted-myfakelongrandompasswordstring')' 附近使用正确的语法

这通过了：

```
GRANT SELECT ON myDB.* TO 'selectuser'@'localhost' 
IDENTIFIED BY 'salted-myfakelongrandompasswordstring'; 
```

我检查了 phpinfo 页面并且已经启用了 sha256 哈希引擎。

有没有办法更改 mysql 的默认散列算法，或者我的 SQL 上的语法不正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T19:10:02.643

不，您不应该使用自己的密码散列进行 MySQL 身份验证。

MySQL 使用自己的密码散列函数 ( [`PASSWORD()`](http://dev.mysql.com/doc/refman/5.1/en/encryption-functions.html#function_password))，它产生一个 41 字节的十六进制字符串（基于两次将 SHA1 应用于输入）。不幸的是，没有使用盐。

如果您能够`GRANT`以您在问题中显示的方式使用，那么 MySQL 会将其`PASSWORD()`函数应用于函数的字符串输出`hash()`。随后，当您想登录时，您必须输入密码的 256 位哈希，以使其与 MySQL 身份验证数据库中的内容相匹配。

此外，MySQL 支持从[`SHA2()`](http://dev.mysql.com/doc/refman/6.0/en/encryption-functions.html#function_sha2)MySQL 6.0.5 开始的哈希函数系列。

该[`hash()`](http://php.net/hash)函数可能是您从 PHP 中记住的。它不是 MySQL 的一部分。

* * *

更新：我本周参加了 MySQL 会议，发现他们正在完全改变未来产品版本号的路线图。该`SHA2()`函数目前是 MySQL 源代码的一部分，但尚未确定对应的产品版本。此外，您需要使用 OpenSSL/YaSSL 支持构建的 MySQL`SHA2()`才能正常工作。

* * *

回复您的评论：通常 MySQL 身份验证与给定 Web 应用程序中的用户帐户身份验证完全分开（出于多种原因，这是最佳实践）。

是的，您需要为 Web 应用程序的 MySQL 身份验证硬编码用户名/密码。可能在，但更好的是配置文件。当然，将这些放在 web 根目录之外。

当用户需要登录时，计算[`hash()`](http://php.net/manual/en/function.hash.php)他们的输入密码，并结合他们帐户记录的[盐](http://en.wikipedia.org/wiki/Salt_(cryptography))值。然后将其与该用户存储在数据库中的哈希值进行比较。在伪代码中：

```
$salt = $db->query("SELECT salt FROM Accounts WHERE account_name = ?", 
    $input_account_name);

$password_hash = hash('sha256', $salt + $input_password)

$is_password_correct = $db->query("SELECT password_hash = ? 
    FROM Accounts WHERE account_name = ?",
    $password_hash, $input_account_name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T19:01:15.613

该[文档页面](http://dev.mysql.com/doc/refman/5.1/en/encryption-functions.html)似乎表明 sha256 未在 MySQL 中实现：

> 另外，关于sha1的exploit，还有sha256、sha384、sha512等更强的版本，但是mysql没有实现它们；它们必须在代码中实现。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-09-24T15:19:50.600

...通过哈希（'your_password'，'256'）识别。这将导致 MySQL 对您的哈希密码进行哈希处理；-)

# asp.net - 如何部署我准备好的网站？

> ID：693302
> 
> 赞同：0
> 
> 时间：2009-03-28T18:54:41.090
> 
> 标签：asp.net, iis, web-applications, web-deployment

我已经用 SQL Server 2000 很好地开发了一个 ASP.NET 网站。如何将它放到服务器上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T02:17:25.137

您可能会发现这些资源很有帮助：

[ASP.NET 网站项目部署概述](http://msdn.microsoft.com/en-us/library/377y0s6t.aspx)

[使用数据库发布向导部署数据库](http://msdn.microsoft.com/en-us/library/bb907585.aspx)

[如何：使用 Web 应用程序项目部署数据库](http://msdn.microsoft.com/en-us/library/dd465343.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T19:04:26.790

取决于许多事情（例如，如果您可以直接访问服务器）。我倾向于将我的数据库结构导出为 SQL 脚本并针对生产数据库执行该脚本。然后，我使用 VS“发布”该站点并将其复制到 Web 服务器上的虚拟目录中。

如果我将应用程序传递给客户，我倾向于使用 WiX 或 VS 部署项目将应用程序包装在安装程序中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T09:05:12.363

有很多方法可以做到这一点。

阅读这个 - [http://www.beansoftware.com/ASP.NET-Tutorials/Deploy-ASP.NET.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/Deploy-ASP.NET.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T19:06:20.733

您可以使用 SQL Server Publisher（免费）向导将数据库从开发机器移动到服务器。或者您可以使用 Red-gate.com 的 SQL Server 数据库架构同步工具

和 SitePubisher 用于通过 FTP（和 VPN）部署文件

# visual-c++ - 从 Visual C++ dll 启动 cab 文件

> ID：693304
> 
> 赞同：0
> 
> 时间：2009-03-28T18:55:32.117
> 
> 标签：visual-c++, windows-mobile, compact-framework, cabwiz

有谁知道如何从 Visual C++ dll 启动 cab 文件，该文件在 windows mobile 上安装应用程序时用作设置 dll。基本上，我需要 dll 来检测是否未安装紧凑框架并在需要时运行所需的 cab 文件。

多年来，我一直在谷歌搜索类似的东西，但没有运气。当然，这已经完成，并且有一些例子。非常非常非常感谢您的帮助。托尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T19:09:24.563

您不会“启动” .CAB 文件。您从中提取文件。

这是一篇关于从 CAB 中提取文件的方法的 Microsoft 知识库文章。

[http://support.microsoft.com/kb/189085](http://support.microsoft.com/kb/189085)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T01:17:16.943

如果您谈论的是 windows mobile cab 文件，那么 Ants 的回答是不正确的。

您需要运行[wceload.exe](http://msdn.microsoft.com/en-us/library/bb158700.aspx)工具来开始在 WM 设备上安装 windows mobile cab 文件。

# asp.net-mvc - 中等信任中 MVC 控制器 + 依赖注入 (Ninject) 的问题

> ID：693308
> 
> 赞同：2
> 
> 时间：2009-03-28T18:56:50.833
> 
> 标签：asp.net-mvc, dependency-injection, inversion-of-control, ninject, medium-trust

我想在中等信任环境中使用依赖注入。为此，我选择了[Ninject](http://ninject.org/)，因为有人告诉我它的重量很轻。如何设置注入控制器？

当我尝试创建自定义控制器工厂时：

```
 public class NinjectControllerFactory : DefaultControllerFactory
    {
        private readonly IKernel _kernel;
        public NinjectControllerFactory(params IModule[] modules)
        {
            _kernel = new StandardKernel(modules);
        }

        public override IController CreateController(System.Web.Routing.RequestContext requestContext, string controllerName)
        {
            IController controller = base.CreateController(requestContext, controllerName);
            _kernel.Inject(controller);
            return controller;
        }
    } 
```

但我遇到了这个错误：

> ```
>  System.InvalidOperationException was unhandled by user code
>   Message="An error occurred while creating a controller of type 'xxx'. 
> ```
> 
> 如果控制器没有控制器工厂，请确保它具有无参数的公共构造函数。”

知道如何让 Ninject 或任何其他 IoC 框架在中等信任下工作（意味着不使用反射）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T10:19:03.963

我最终没有设法解决这个问题，我切换到了[Unity](http://codeplex.com/unity) - 以中等信任的方式工作，没有任何麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T18:26:40.930

要以中等信任运行 Ninject 1.x，您必须将`UseReflectionBasedInjection`选项设置为`true`. Ninject 2.0 不受此限制。

反射实际上不是中等信任的受保护操作，但轻量级代码生成（Ninject 默认使用它进行注入）至少在 .NET 3.5 SP1 之前是这样。

一旦切换到基于反射的注入，您的代码应该可以按预期工作。我还鼓励您查看 Ninject.Framework.Mvc（用于 Ninject 1.x）或 Ninject.Web.Mvc（用于 Ninject 2.0）。这些扩展为您处理繁重的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T19:03:42.597

创建容器时尝试设置此选项：

```
UseReflectionBasedInjection = true; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T19:13:21.777

好的提示（但你的意思是把它设置为 false 吗？），我改变了我的构造函数，使它像这样：

```
public NinjectControllerFactory(params IModule[] modules)
        {
            _kernel = new StandardKernel(modules);
            _kernel.Options.UseReflectionBasedInjection = false;
        } 
```

**不过，这得到了同样的例外。**

我也尝试过像这样覆盖 GetControllerInstance

```
 protected override IController GetControllerInstance(Type controllerType)
    {
        return _kernel.Get(controllerType) as IController;
    } 
```

但这会引发安全异常，因为它使用反射。

# nlp - 用于 OCR 的多层感知器

> ID：693311
> 
> 赞同：2
> 
> 时间：2009-03-28T19:01:42.743
> 
> 标签：nlp, ocr, backpropagation, neural-network

我打算使用经过反向传播训练的多层感知器网络（一个隐藏层，输入用作包含图像中黑白像素的 8x8 位矩阵）。出现以下问题：

1.  我应该使用哪种类型的学习：批量学习还是在线学习？
2.  我如何估计隐藏层中正确的节点数？我打算处理英文字母的26个字母。
3.  我怎样才能停止训练过程，以避免过度拟合？
4.  （不太相关）是否有另一个比 MLP 表现更好的 NN？我知道 MLP 会陷入局部最小值、过度拟合等问题，那么是否有更好的（基于软计算的）方法？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T19:19:18.130

这些问题中的大多数都是您需要尝试不同的选项以查看最有效的问题。这就是人工神经网络的问题。几乎没有“最好”的方式来做任何事情。您需要找出对您的特定问题有效的方法。不过，我会就你的问题给出我的建议。

1）我更喜欢增量学习。我认为在每个模式之后更新网络权重很重要。

2）这是一个棘手的问题。这实际上取决于您的网络的复杂性。有多少输入节点、输出节点和训练模式。对于您的问题，我可能会从 100 开始，然后尝试从 100 上下范围，看看是否有改进。

3）我通常在每个 epoch 之后计算网络在应用于测试集（而不是训练集）时的总误差。如果该误差增加了大约 5 个 epoch，我将停止训练，然后使用在增加之前创建的网络。在决定停止训练时不要使用训练集的误差，这一点很重要。这就是会导致过拟合的原因。

4) 如果您将输出表示为 26 个节点，每个节点代表字母表中的一个字母，您也可以尝试使用概率神经网络。这种网络架构适用于分类问题。同样，尝试几种不同的架构以查看最适合您的问题的架构可能是一个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T13:29:20.133

关于第 3 点，找出 ANN 何时开始过度拟合的一种方法是绘制网络在训练数据和测试数据上的准确度与执行的 epoch 数的关系图。在某些时候，随着您的训练准确度继续提高（趋于 100%），您的测试准确度实际上可能会开始*下降*，因为 ANN 对训练数据过度拟合。查看开始发生的时代，并确保不要训练超过那个时代。

如果您的数据*非常*规律且一致，那么它可能直到游戏的后期才过拟合，或者根本不会过拟合。如果您的数据非常不规则，那么您的 ANN 将更早开始过度拟合。

此外，测试数据的规律性的一种方法是执行[k-fold cross validation 之](http://en.wikipedia.org/wiki/Root-mean-square_error_of_cross-validation#K-fold_cross-validation)类的操作。

# php - 需要在 CSV 中适当地标题标题，而不是使用表格列标题

> ID：693318
> 
> 赞同：0
> 
> 时间：2009-03-28T19:06:37.457
> 
> 标签：php, mysql, csv

我有一个将表格导出为 CSV 文件的功能，然后我使用电子表格应用程序打开该文件。

有没有办法设置 CSV 的标题以适当地命名每一列。

例如：

我有一个表，其中包含名字、姓氏、电子邮件和评论。

并且表设置为：fname、lname、email、comments

所以表导出为：

```
fname, lname, email, comments
john, doe, johndoe@email.com, I am John Doe this is my comment 
```

我想将标题（fname、lname、email、comments）更改为更具可读性，所以它会是这样的：

```
First Name, Last Name, Email, Comments
john, doe, johndoe@email.com, I am John Doe this is my comment 
```

这是我的代码：

```
function exportNamesCommentsCSV($table,$filename = 'volunteer_2009_comments.csv') {
    $csv_terminated = "\n";
    $csv_separator = ",";
    $csv_enclosed = '"';
    $csv_escaped = "\\";
    $sql_query = "select lname, fname, comments from volunteers_2009";

    // Gets the data from the database
    $result = mysql_query($sql_query);
    $fields_cnt = mysql_num_fields($result);

    $schema_insert = '';

    for ($i = 0; $i < $fields_cnt; $i++) {
        $l = $csv_enclosed . str_replace($csv_enclosed, $csv_escaped . $csv_enclosed,
            stripslashes(mysql_field_name($result, $i))) . $csv_enclosed;
        $schema_insert .= $l;
        $schema_insert .= $csv_separator;
    } // end for

    $out = trim(substr($schema_insert, 0, -1));
    $out .= $csv_terminated;

    // Format the data
    while ($row = mysql_fetch_array($result)) {
        $schema_insert = '';
        for ($j = 0; $j < $fields_cnt; $j++) {
            if ($row[$j] == '0' || $row[$j] != '') {

                if ($csv_enclosed == '') {
                    $schema_insert .= $row[$j];
                } else {
                    $schema_insert .= $csv_enclosed . 
                    str_replace($csv_enclosed, $csv_escaped . $csv_enclosed, $row[$j]) . $csv_enclosed;
                }
            } else {
                $schema_insert .= '';
            }

            if ($j < $fields_cnt - 1) {
                $schema_insert .= $csv_separator;
            }
        } // end for

        $out .= $schema_insert;
        $out .= $csv_terminated;
    } // end while

    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Content-Length: " . strlen($out));
    header("Content-type: text/x-csv");
    header("Content-Disposition: attachment; filename=$filename");
    echo $out;
    exit;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T19:13:48.330

CSV 文件的标题只是第一行。所以你会改变这个块：

```
for ($i = 0; $i < $fields_cnt; $i++) {
    $l = $csv_enclosed . str_replace($csv_enclosed, $csv_escaped . $csv_enclosed,
            stripslashes(mysql_field_name($result, $i))) . $csv_enclosed;
    $schema_insert .= $l;
    $schema_insert .= $csv_separator;
} // end for

$out = trim(substr($schema_insert, 0, -1));
$out .= $csv_terminated; 
```

您可以将其更改为非常简单的内容，如下所示：

```
$out .= "First Name, Last Name, Email, Comments\n"; 
```

除非我完全误解了你的问题。

编辑：您的示例代码显示了一个特定的查询。如果它需要处理多个查询，您必须找到这些友好名称的来源。例如，您可以将名称作为参数传入或[将它们存储在数据库中](https://stackoverflow.com/questions/688198/generating-reports-from-mysql-tables/688219#688219)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T19:33:55.723

您可以根据需要更改查询以重命名字段名称。

```
$sql_query = "select lname, fname, comments from volunteers_2009"; 
```

变成

```
$sql_query = "select fname as 'First Name', lname as 'Last Name'," 
           . "Comments from volunteers_2009"; 
```

# vb6 - 并口编程

> ID：693319
> 
> 赞同：1
> 
> 时间：2009-03-28T19:07:20.340
> 
> 标签：vb6, hardware, parallel-port

快速提问：并行端口可以同时接收和发送数据吗？

如果您有更多关于 VB 和并口编程的技巧，请随时告诉我。:)

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T19:16:20.337

是的，您可以同时发送和接收。

试试这个页面使用 VB [http://www.aaroncake.net/electronics/vblpt.htm](http://www.aaroncake.net/electronics/vblpt.htm)

还有一个关于并行端口的好页面[http://www.lvr.com/parport.htm](http://www.lvr.com/parport.htm)

# workflow - 您将如何使用 Java 开发工作流应用程序？

> ID：693320
> 
> 赞同：3
> 
> 时间：2009-03-28T19:08:42.350
> 
> 标签：workflow, jbpm

我想开发一个允许其用户定义工作流然后执行它们的应用程序。

我的环境是 JBoss，所以我自然会考虑使用 jBPM。

我不能使用 jBPM 图形工作流设计工具，因为我的工作流非常具体，我不想让我的用户接触所有 jBPM 功能。

问题：

1.  jBPM 是否健壮且可扩展？
2.  jBPM 是标准的（即，被足够多的人使用）吗？
3.  如何将我自己的工作流 GUI 绑定到 jBPM 引擎？
4.  jBPM 是否适合这项工作，我应该考虑使用不同的平台还是自己做（工作流逻辑）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T14:10:59.827

1.  Is jBPM robust and scalable?

    Ans: Yes, Jbpm is robust and scalable. Need to configure/develop properly..

2.  Is jBPM standard (i.e., used by enough people)?

    Ans : You need to ask with jbpm forum.

3.  How do I tie my own workflow GUI to the jBPM engine?

    Ans : You need to develop processConfiguration file for each workflow, and deploy
    these config file(xml file), this updates jbpm related tables and your workflow related tables.

4.  Is jBPM suitable for the job, should I consider a different platform or maybe do it (the workflow logic) myself?

    Ans : Its suitable for big workflows( where the stages/Nodes and logic are more). And easy to Integrate with rule engine.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T11:59:42.077

不是您问题的直接答案，但我认为您还应该考虑：

*   当您希望您的用户定义工作流程时，您确定您不仅仅指的是有限状态机，而不是工作流程吗？
*   用户是否可以更改现有的工作流程，如果可以：如果工作流程发生更改，您是否希望正在运行的流程继续使用旧定义，或者您是否需要能够迁移正在运行的流程以使用新定义？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T18:28:05.170

> 如何将我自己的工作流 GUI 绑定到 jBPM 引擎？

在[jBPM 主页上](http://www.jboss.com/products/jbpm/)阅读：

> JBoss jBPM 提供了一个面向过程的编程模型 (jPDL)，它融合了 Java 和声明式编程技术的精华。

[jBPM jPDL API 文档概述](http://docs.jboss.org/jbpm/v3/javadoc/overview-summary.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-17T16:59:07.810

1.  jBPM 是否健壮且可扩展？

是的，您有多种选择可以将您的引擎扩展到大量流程定义、流程实例和/或每秒请求数。

1.  jBPM 是标准的（即，被足够多的人使用）吗？

很难定义标准 ;) 但它上周有几千次下载，并且它尽可能使用标准，例如流程定义的 BPMN 2.0 规范，目前几乎所有 BPM 供应商都在引入该标准。

1.  如何将我自己的工作流 GUI 绑定到 jBPM 引擎？

取决于 GUI 的用途。假设您指的是用于定义流程定义的 GUI，并且您不想使用默认提供的基于 Eclipse 或基于 Web 的编辑器，您可以： - 使用您喜欢的任何 GUI，只要它生成BPMN2 XML，然后可以由流程引擎读取 - 您的 GUI 使用流程流畅的 Java API 来使用 Java 创建流程，然后也可以将其加载到引擎中

1.  jBPM 是否适合这项工作，我应该考虑使用不同的平台还是自己做（工作流逻辑）？

尝试自己创建一个简单的工作流引擎可能比您想象的要付出更多的努力，因为您可能一开始很简单，但通常最终会添加诸如持久性、监控、集成、动态加载新流程定义和流程实例迁移等功能。最终得到一个您必须维护的本土工作流引擎；) 您可以使用 jBPM 开箱即用地获得这些功能。

克里斯

# c# - LINQ 除了运算符和对象相等

> ID：693324
> 
> 赞同：13
> 
> 时间：2009-03-28T19:09:31.023
> 
> 标签：c#, linq

这是我在使用`Except`Operator 时注意到的一个有趣问题：我有一个用户列表，我想从中排除一些用户：

用户列表来自一个 XML 文件：

代码如下：

```
interface IUser
{
     int ID { get; set; }
     string Name { get; set; }
}

class User: IUser
{

    #region IUser Members

    public int ID
    {
        get;
        set;
    }

    public string Name
    {
        get;
        set;
    }

    #endregion

    public override string ToString()
    {
        return ID + ":" +Name;
    }

    public static IEnumerable<IUser> GetMatchingUsers(IEnumerable<IUser> users)
    {
         IEnumerable<IUser> localList = new List<User>
         {
            new User{ ID=4, Name="James"},
            new User{ ID=5, Name="Tom"}

         }.OfType<IUser>();
         var matches = from u in users
                       join lu in localList
                           on u.ID equals lu.ID
                       select u;
         return matches;
    }
}

class Program
{
    static void Main(string[] args)
    {
        XDocument doc = XDocument.Load("Users.xml");
        IEnumerable<IUser> users = doc.Element("Users").Elements("User").Select
            (u => new User
                { ID = (int)u.Attribute("id"),
                  Name = (string)u.Attribute("name")
                }
            ).OfType<IUser>();       //still a query, objects have not been materialized

        var matches = User.GetMatchingUsers(users);
        var excludes = users.Except(matches);    // excludes should contain 6 users but here it contains 8 users

    }
} 
```

当我打电话时，`User.GetMatchingUsers(users)`我得到了预期的 2 场比赛。问题是当我打电话时`users.Except(matches)`，匹配的用户根本没有被排除在外！我期待 6 个用户“排除”包含所有 8 个用户。

由于我所做的 `GetMatchingUsers(IEnumerable<IUser> users)`只是获取`IEnumerable<IUser>`并返回`IUsers`其 ID 的匹配项（在本例中为 2 个 IUsers），因此我的理解是默认情况下`Except`将使用引用相等来比较要排除的对象。这不是`Except`行为方式吗？

更有趣的是，如果我使用物化对象`.ToList()`然后获取匹配的用户，然后调用`Except`，一切都会按预期工作！

像这样：

```
IEnumerable<IUser> users = doc.Element("Users").Elements("User").Select
            (u => new User
                { ID = (int)u.Attribute("id"),
                  Name = (string)u.Attribute("name")
                }
            ).OfType<IUser>().ToList();   //explicity materializing all objects by calling ToList()

var matches = User.GetMatchingUsers(users);
var excludes = users.Except(matches);   // excludes now contains 6 users as expected 
```

我不明白为什么我需要物化对象来调用`Except`，因为它定义在`IEnumerable<T>`?

任何建议/见解将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-12-29T15:44:35.380

a) 您需要重写 GetHashCode 函数。**它必须为相等的 IUser 对象返回相等的值**。例如：

```
public override int GetHashCode()
{
    return ID.GetHashCode() ^ Name.GetHashCode();
} 
```

b) 您需要在实现 IUser 的类中覆盖 object.Equals(object obj) 函数。

```
public override bool Equals(object obj)
{
    IUser other = obj as IUser;
    if (object.ReferenceEquals(obj, null)) // return false if obj is null OR if obj doesn't implement IUser
        return false;
    return (this.ID == other.ID) && (this.Name == other.Name);
} 
```

c) 作为*(b)*的替代方案， IUser 可以继承 IEquatable：

```
interface IUser : IEquatable<IUser>
... 
```

在这种情况下，用户类将需要提供 bool Equals(IUser other) 方法。

就这样。现在它无需调用 .ToList() 方法即可工作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-28T19:15:10.993

我想我知道为什么这不能按预期工作。因为初始用户列表是一个 LINQ 表达式，所以每次迭代时都会重新计算它（一次在 in 中使用，`GetMatchingUsers`然后在执行`Except`操作时再次），因此会创建新的用户对象。这将导致不同的引用，因此没有匹配。Using`ToList`解决了这个问题，因为它只迭代一次 LINQ 查询，因此引用是固定的。

我已经能够重现您遇到的问题并调查了代码，这似乎是一个非常合理的解释。不过我还没有证明。

***更新***
我刚刚运行了测试，但`users`在调用之前、调用`GetMatchingUsers`中和调用之后输出了集合。正如我所怀疑的，每次输出对象的哈希码时，它们确实每次都具有不同的值来指示新对象。

以下是每个调用的输出：

```
==> Start
ID=1, Name=Jeff, HashCode=39086322
ID=2, Name=Alastair, HashCode=36181605
ID=3, Name=Anthony, HashCode=28068188
ID=4, Name=James, HashCode=33163964
ID=5, Name=Tom, HashCode=14421545
ID=6, Name=David, HashCode=35567111
<== End
==> Start
ID=1, Name=Jeff, HashCode=65066874
ID=2, Name=Alastair, HashCode=34160229
ID=3, Name=Anthony, HashCode=63238509
ID=4, Name=James, HashCode=11679222
ID=5, Name=Tom, HashCode=35410979
ID=6, Name=David, HashCode=57416410
<== End
==> Start
ID=1, Name=Jeff, HashCode=61940669
ID=2, Name=Alastair, HashCode=15193904
ID=3, Name=Anthony, HashCode=6303833
ID=4, Name=James, HashCode=40452378
ID=5, Name=Tom, HashCode=36009496
ID=6, Name=David, HashCode=19634871
<== End 
```

而且，这是显示问题的修改后的代码：

```
using System.Xml.Linq;
using System.Collections.Generic;
using System.Linq;
using System;

interface IUser
{
    int ID
    {
        get;
        set;
    }
    string Name
    {
        get;
        set;
    }
}

class User : IUser
{

    #region IUser Members

    public int ID
    {
        get;
        set;
    }

    public string Name
    {
        get;
        set;
    }

    #endregion

    public override string ToString()
    {
        return ID + ":" + Name;
    }

    public static IEnumerable<IUser> GetMatchingUsers(IEnumerable<IUser> users)
    {
        IEnumerable<IUser> localList = new List<User>
         {
            new User{ ID=4, Name="James"},
            new User{ ID=5, Name="Tom"}

         }.OfType<IUser>();

        OutputUsers(users);
        var matches = from u in users
                      join lu in localList
                          on u.ID equals lu.ID
                      select u;
        return matches;
    }

    public static void OutputUsers(IEnumerable<IUser> users)
    {
        Console.WriteLine("==> Start");
        foreach (IUser user in users)
        {
            Console.WriteLine("ID=" + user.ID.ToString() + ", Name=" + user.Name + ", HashCode=" + user.GetHashCode().ToString());
        }
        Console.WriteLine("<== End");
    }
}

class Program
{
    static void Main(string[] args)
    {
        XDocument doc = new XDocument(
            new XElement(
                "Users",
                new XElement("User", new XAttribute("id", "1"), new XAttribute("name", "Jeff")),
                new XElement("User", new XAttribute("id", "2"), new XAttribute("name", "Alastair")),
                new XElement("User", new XAttribute("id", "3"), new XAttribute("name", "Anthony")),
                new XElement("User", new XAttribute("id", "4"), new XAttribute("name", "James")),
                new XElement("User", new XAttribute("id", "5"), new XAttribute("name", "Tom")),
                new XElement("User", new XAttribute("id", "6"), new XAttribute("name", "David"))));
        IEnumerable<IUser> users = doc.Element("Users").Elements("User").Select
            (u => new User
            {
                ID = (int)u.Attribute("id"),
                Name = (string)u.Attribute("name")
            }
            ).OfType<IUser>();       //still a query, objects have not been materialized

        User.OutputUsers(users);
        var matches = User.GetMatchingUsers(users);
        User.OutputUsers(users);
        var excludes = users.Except(matches);    // excludes should contain 6 users but here it contains 8 users

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T19:16:45.357

我认为你应该实现[IEquatable<T>](http://msdn.microsoft.com/en-us/library/ms131187.aspx)来提供你自己的 Equals 和 GetHashCode 方法。

来自 MSDN（[Enumerable.Except](http://msdn.microsoft.com/en-us/library/bb300779.aspx)）：

> 如果你想比较一些自定义数据类型的对象序列，你必须在你的类中实现 IEqualityComparer<(Of <(T>)>) 通用接口。以下代码示例展示了如何在自定义数据类型中实现此接口并提供 GetHashCode 和 Equals 方法。

# language-design - 不可为空的引用类型

> ID：693325
> 
> 赞同：12
> 
> 时间：2009-03-28T19:09:50.773
> 
> 标签：language-design, non-nullable

我正在设计一种语言，我想知道默认情况下使引用类型不可为空并使用“？”是否合理。对于可空值和引用类型。这有什么问题吗？你会怎么做：

```
class Foo {
    Bar? b;
    Bar b2;
    Foo() {
        b.DoSomething(); //valid, but will cause exception
        b2.DoSomething(); //?
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-28T19:32:30.797

我目前的语言设计理念是，可空性应该是程序员被迫要求的，而不是默认情况下在引用类型上给出的（在这一点上，我同意 Tony Hoare - Google 最近的 QCon 演讲）。

在这个特定的例子中，对于不可空的 b2，它甚至不会通过静态检查：保守分析不能保证 b2 不为 NULL，因此程序在语义上没有意义。

我的精神很简单。引用是对某些资源的间接句柄，我们可以遍历它以获取对该资源的访问。可空引用*要么*是对资源的间接句柄，*要么*是资源不可用的通知，而且人们永远无法预先确定正在使用哪种语义。这要么预先进行大量检查（它是空的吗？不？是的！），或者不可避免的 NPE（或等价物）。如今，大多数编程资源都没有受到大量资源限制或绑定到某些有限的底层模型 - 简单地说，空引用是......

*   懒惰：“我只会在这里打一个空”。坦率地说，我没有太多的同情
*   困惑：“我还不知道在这里放什么”。通常也是旧语言的遗留问题，您必须在知道资源是什么之前声明资源名称。
*   错误：“出错了，这里是 NULL”。因此，更好的错误报告机制在语言中是必不可少的
*   一个洞：“我知道我很快就会有东西，给我一个占位符”。这有更多的优点，我们可以想办法解决这个问题。

当然，通过更好的语言选择来解决 NULL 当前满足的每种情况并非易事，并且可能会增加更多的混乱，这会有所帮助。我们总是可以使用不可变的资源，所以 NULL 只是有用的状态（错误和漏洞）并没有太大的实际用途。尽管如此，势在必行的技术仍然存在，坦率地说，我很高兴——这使得在这个领域寻找更好的解决方案变得有价值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-28T19:36:01.600

默认情况下引用类型不可为空是唯一合理的选择。我们被搞砸了的语言和运行时所困扰；你应该做正确的事。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-28T21:10:22.480

此功能在[Spec#](http://research.microsoft.com/en-us/projects/specsharp/)中。他们默认为可空引用并使用！表示不可为空。这是因为他们想要向后兼容。

在我梦想的语言中（我可能是唯一的用户！）我会做出和你一样的选择，默认情况下不可为空。

我也会将使用 . 可空引用（或任何其他可以取消引用它的）上的运算符。你会如何使用它们？您必须先将它们转换为不可为空的值。你会怎么做？通过测试它们是否为空。

在 Java 和 C# 中，`if`语句只能接受`bool`测试表达式。我会扩展它以接受可以为空的引用变量的名称：

```
if (myObj)
{
    // in this scope, myObj is non-nullable, so can be used
} 
```

这种特殊的语法对于 C/C++ 程序员来说并不奇怪。我更喜欢这样的特殊语法，以清楚地表明我们正在检查修改`myObj`真值分支中名称的类型。

我还要加一点糖：

```
if (SomeMethodReturningANullable() into anotherObj)
{
    // anotherObj is non-nullable, so can be used
} 
```

这只是为`anotherObj`左边的表达式的结果命名`into`，因此它可以在有效的范围内使用。

我会为操作员做同样的事情`?:`。

```
string message = GetMessage() into m ? m : "No message available"; 
```

请注意，这`string message`是不可为空的，但上述测试的两个可能结果也是如此，因此赋值是值。

对于将值替换为 null 的可能常见情况，可能会有点糖：

```
string message = GetMessage() or "No message available"; 
```

显然`or`只会有效地应用于左侧的可空类型，而右侧的不可空类型。

（对于实例字段，我还有一个内置的所有权概念；编译器会`IDisposable.Dispose`自动生成方法，并且`~Destructor`语法将用于扩充`Dispose`，就像在 C++/CLI 中一样。）

Spec# 有另一个与非空值相关的语法扩展，因为在构造过程中确保非空值已被正确初始化的问题：

```
class SpecSharpExampleClass
{
    private string! _nonNullableExampleField;

    public SpecSharpExampleClass(string s)
        : _nonNullableExampleField(s) 
    {

    }
} 
```

换句话说，您必须以与使用`base`or调用其他构造函数相同的方式初始化字段`this`- 当然，除非您直接在字段声明旁边初始化它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-28T19:33:35.940

看看 Java 7 的[Elvis 运算符](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/000047.html)提案。它做了类似的事情，因为它在一个运算符中封装了 null 检查和方法分派，如果对象为 null，则具有指定的返回值。因此：

```
String s = mayBeNull?.toString() ?: "null"; 
```

检查 String s 是否为空，如果是则返回字符串“null”，如果不是则返回字符串的值。也许值得深思。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-28T19:19:04.337

其他语言中类似功能的几个示例：

*   [升压::可选](http://www.boost.org/doc/libs/1_38_0/libs/optional/doc/html/index.html)(C++)
*   [也许](http://www.haskell.org/onlinelibrary/maybe.html)（哈斯克尔）

还有`Nullable<T>`（来自 C#），但这不是一个很好的例子，因为引用类型与值类型的处理方式不同。

在您的示例中，您可以添加条件消息发送运算符，例如

```
b?->DoSomething(); 
```

`b`仅当消息为非空时才向其发送消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T11:13:57.403

让可空性成为配置设置，**在作者源**代码中可执行。这样，您将允许默认情况下喜欢可空对象的人在他们的源代码中享受它们，同时允许那些希望他们的所有对象默认为不可空对象的人完全拥有这些。此外，提供关键字或其他工具来显式标记您的对象和类型声明中的哪些可以为空，哪些不能，使用 and 之类的东西`nullable`来`not-nullable`覆盖全局默认值。

例如

```
/// "translation unit 1"

#set nullable
{ /// Scope of default override, making all declarations within the scope nullable implicitly
     Bar bar; /// Can be null
     non-null Foo foo; /// Overriden, cannot be null
     nullable FooBar foobar; /// Overriden, can be null, even without the scope definition above 
}

/// Same style for opposite

/// ...

/// Top-bottom, until reset by scoped-setting or simply reset to another value
#set nullable;

/// Nullable types implicitly

#clear nullable;

/// Can also use '#set nullable = false' or '#set not-nullable = true'. Ugly, but human mind is a very original, mhm, thing. 
```

许多人争辩说，给每个人他们想要的东西是不可能的，但如果你正在设计一门新语言，那就尝试新事物。托尼·霍尔（Tony Hoare）在 1965 年引入了这个概念，`null`因为他无法抗拒（他自己的话），从那时起我们就为此付出代价（同样，他自己的话，这个人对此感到遗憾）。重点是，聪明、有经验的人犯的错误会让我们其他人付出代价，不要在这个页面上接受任何人的建议，就好像这是唯一的真理，包括我的。评估和思考它。

我读过很多关于我们这些可怜的缺乏经验的程序员真的不知道在哪里真正使用`null`和在哪里不使用的咆哮，向我们展示了旨在防止自爆的模式和反模式。一直以来，数百万仍然缺乏经验的程序员使用允许`null`. 我**可能**没有经验，但我知道我的哪些对象不能从可空值中受益。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-28T20:00:02.057

我认为空值很好：它们清楚地表明您做错了。如果您未能在某处初始化引用，您将立即收到通知。

另一种选择是有时将值初始化为默认值。逻辑错误则更难检测，除非您将检测逻辑放入这些默认值中。这与仅获取空指针异常相同。

# sql - 如何加入多个表？

> ID：693327
> 
> 赞同：3
> 
> 时间：2009-03-28T19:10:08.370
> 
> 标签：sql, sql-server, join

我有以下表格（和示例值）：

```
**user:**
user_id (1, 2, 3)
username (john33, reddiamond...)
password (pass1, pass2...)

**session:**
session_id (4,5, 6)
user_id (1, 2, 3)

**activity**
activity_id (1, 2)
name (running, walking...)

**user_activity**
user_activity_id (1, 2, 3, 4, 5)
session_id (4, 5)
activity_id (1, 2) 
```

所有具有相同名称的列都是相关的。在表中`user_activity`，有几行描述了会话的活动，活动指的是用户。

但是，我想获取描述用户当前正在做什么的表格：

```
**result**
username(john33)
activity.name(walking) 
```

获取结果表的 SQL 语句是什么？

（我正在使用 MSSQL）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T19:14:51.570

```
SELECT u.username, a.name
FROM user_activity ua
INNER JOIN session s
ON ua.session_id = s.session_id
INNER JOIN user u
ON s.user_id = u.user_id
INNER JOIN activity a
ON ua.activity_id = a.activity_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T19:25:28.770

我假设`session.session_id`和`user_activity.user_activity_id`是`IDENTITY`列，所以它们是单调递增的。因此它们是唯一的，最大值表示最近的条目。

所以你需要做的是：

*   匹配具有最大值`user`的对应行（即，没有找到具有相同和更大的其他行）。 `session``session_id``user_id``session_id`

*   然后将该行匹配到具有最大`session`的相应行。`user_activity``user_activity_id`

*   然后将该行匹配`user_activity`到相应的行`activity`以获取`name`.

这是一个应该实现此目的的查询（尽管我尚未对其进行测试）：

```
SELECT u.username, a.name
FROM user u
 JOIN session s1 ON (u.user_id = s1.user_id)
 LEFT OUTER JOIN session s2 ON (u.user_id = s2.user_id 
   AND s1.session_id < s2.session_id)
 JOIN user_activity ua1 ON (ua1.session_id = s1.session_id)
 LEFT OUTER JOIN user_activity ua2 ON (ua2.session_id = s1.session_id 
   AND ua1.user_activity_id < ua2.user_activity_id)
 JOIN activity a ON (a.activity_id = ua1.activity_id)
WHERE s2.session_id IS NULL AND ua2.user_activity_id IS NULL; 
```

这是另一种查询形式，应该得到相同的结果，并且可能更容易可视化：

```
SELECT u.username, a.name
FROM user u
 JOIN session s1 ON (u.user_id = s1.user_id)
 JOIN user_activity ua1 ON (ua1.session_id = s1.session_id)
 JOIN activity a ON (a.activity_id = ua1.activity_id)
WHERE s1.session_id = (
     SELECT MAX(s2.session_id) FROM session s2 
     WHERE s2.user_id = u.user_id)
 AND ua1.user_activity_id = (
     SELECT MAX(ua2.user_activity_id) FROM user_activity ua2 
     WHERE ua2.session_id = s1.session_id); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T21:16:25.103

我从您对所需结果的陈述中假设您希望找到每个用户的当前活动。我还假设一个用户可能有很多会话，并且当前会话是具有最高 session_id 的会话。

当然，如果您每个用户只有一个会话并且每个用户只有一个 user_activity 记录，那么这不是问题，您接受的答案很好。

这里的关键问题是识别每个用户的最新 user_activity 记录并使用它来访问活动。

这可以按如下方式完成：-

```
SELECT  u.username,  
        a.name  
FROM    user_activity AS ua  
JOIN    session AS s ON ua.session_id = s.session_id  
JOIN    user AS u ON u.user_id = s.user_id  
JOIN    activity AS a ON ua.activity_id = a.activity_id  
WHERE   ua.user_activity_id IN (  
          SELECT  MAX(ua2.user_activity_id)  
          FROM    user_activity AS ua2  
          JOIN    session AS s2 ON ua2.session_id = s2.session_id  
          GROUP BY s2.user_id); 
```

以下测试数据证明了 SQL。它创建 4 个用户和 4 个活动，然后为每个做家务的用户创建一个 user_activity 记录。然后它将三个用户设置为他们的正常活动。

```
INSERT INTO user (username) VALUES ('sneezy');  
INSERT INTO user (username) VALUES ('grumpy');  
INSERT INTO user (username) VALUES ('happy');  
INSERT INTO user (username) VALUES ('snow_white');  

INSERT INTO session (user_id) SELECT u.user_id FROM user AS u;  

INSERT INTO activity(name) VALUES ("Sneezing");  
INSERT INTO activity(name) VALUES ("Frowning");  
INSERT INTO activity(name) VALUES ("Smiling");  
INSERT INTO activity(name) VALUES ("Housework");  

INSERT INTO user_activity (session_id, activity_id)  
SELECT s.session_id, a.activity_id  
FROM   session AS s JOIN activity AS a  
WHERE   a.name IN ("Housework");  

INSERT INTO user_activity(session_id, activity_id)  
SELECT  s.session_id, a.activity_id  
FROM    session AS s  
JOIN    USER as u ON s.user_id = u.user_id  
JOIN    activity AS a ON a.name = 'Sneezing'  
WHERE   u.username = 'sneezy' ;  

INSERT INTO user_activity(session_id, activity_id)  
SELECT  s.session_id, a.activity_id  
FROM    session AS s  
JOIN    USER as u ON s.user_id = u.user_id  
JOIN    activity AS a ON a.name = 'Frowning'  
WHERE   u.username = 'grumpy' ;  

INSERT INTO user_activity(session_id, activity_id)  
SELECT  s.session_id, a.activity_id  
FROM    session AS s  
JOIN    USER as u ON s.user_id = u.user_id  
JOIN    activity AS a ON a.name = 'Smiling'  
WHERE   u.username = 'happy' ; 
```

这会产生以下结果

```
  snow_white 家务
  打喷嚏打喷嚏
  脾气暴躁的皱着眉头
  快乐微笑

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T19:16:30.227

我认为这将是这样的：

```
select u.username, a.name
from user u
join session s on u.user_id = s.user_id
join user_activity ua on ua.session_id = s.session_id
join activity a on a.activity_id = ua.activity_id 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-02-24T12:00:52.867

```
SELECT user.user_name,
activity.name1
FROM activity 

INNER JOIN user 
INNER JOIN session 
  ON user.user_id = session.user_id

INNER JOIN user_activity 
  ON session.session_id = user_activity.session_id 
  ON activity.activity_id = user_activity.activity_id 
```

# iphone - iphone sqlite 问题：sqlite3_prepare_v2 上的“内存不足”

> ID：693329
> 
> 赞同：10
> 
> 时间：2009-03-28T19:11:40.957
> 
> 标签：iphone, sqlite

我想知道是否有人可以帮助我理解这段代码有什么问题。我从来没有通过 sqlite3_prepare_v2 语句，调试器说：

'NSInternalInconsistencyException'，原因：'创建添加语句时出错。'记不清''

```
 static sqlite3 *database = nil;
sqlite3_stmt *addStmt = nil;

if(addStmt == nil) {
    NSLog(@"About to add start time...\n");
    const char *sql = "INSERT INTO games_played(start) VALUES(?)";     
    if(sqlite3_prepare_v2(database, sql, -1, &addStmt, NULL) != SQLITE_OK)
        NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));
    NSLog(@"add statement created successfully!\n");
}
NSLog(@"About to bind start time...\n");
sqlite3_bind_text(addStmt, 1, @"start time", -1, SQLITE_TRANSIENT); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-28T19:22:04.957

我从来没有打开过数据库...我认为这就是问题所在。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-11-10T12:41:45.013

这不是错误，问题是您从不打开数据库。例如：

```
if (sqlite3_open([dbPath UTF8String], &database) == SQLITE_OK) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-21T13:11:18.560

I was also facing this problem, and solved it by reset the database for the sqlite statement.

# apache - 对使用 SSL 支持配置 Apache 感到茫然和困惑

> ID：693331
> 
> 赞同：2
> 
> 时间：2009-03-28T19:13:13.947
> 
> 标签：apache, configuration, ssl, openssl, mod-ssl

我花了几个小时试图将我的 Apache 服务器配置为使用没有公共 IP 的 SSL，只有 localhost。我已经创建了证书，我认为（这对我来说就像一个关于黑魔法的速成课程），当我尝试访问[https://localhost](https://localhost)时，浏览器在状态行，但只是永远加载。这是来自的片段`error_log`：

```
[Fri Mar 27 22:03:39 2009] [info] Loading certificate & private key of SSL-aware server
[Fri Mar 27 22:03:39 2009] [info] Configuring server for SSL protocol
[Fri Mar 27 22:03:39 2009] [info] Loading certificate & private key of SSL-aware server
[Fri Mar 27 22:03:40 2009] [info] Configuring server for SSL protocol 
```

那里一切似乎都还好，但与此同时，在`ssl_engine_log`...

```
[Fri Mar 27 22:03:39 2009] [info] Init: Initializing OpenSSL library
[Fri Mar 27 22:03:39 2009] [info] Init: Seeding PRNG with 136 bytes of entropy
[Fri Mar 27 22:03:39 2009] [info] Init: Generating temporary RSA private keys (512/1024 bits)
[Fri Mar 27 22:03:39 2009] [info] Init: Generating temporary DH parameters (512/1024 bits)
[Fri Mar 27 22:03:39 2009] [info] Init: Initializing (virtual) servers for SSL
[Fri Mar 27 22:03:39 2009] [info] mod_ssl/2.0.61 compiled against Server: Apache/2.0.61, Library: OpenSSL/0.9.7i
[Fri Mar 27 22:03:39 2009] [warn] module php5_module is already loaded, skipping
[Fri Mar 27 22:03:39 2009] [info] Init: Initializing OpenSSL library
[Fri Mar 27 22:03:39 2009] [info] Init: Seeding PRNG with 136 bytes of entropy[Fri Mar 27 22:03:39 2009] [info] Init: Generating temporary RSA private keys (512/1024 bits)
[Fri Mar 27 22:03:40 2009] [info] Init: Generating temporary DH parameters (512/1024 bits)
[Fri Mar 27 22:03:40 2009] [info] Init: Initializing (virtual) servers for SSL
[Fri Mar 27 22:03:40 2009] [info] mod_ssl/2.0.61 compiled against Server: Apache/2.0.61, Library: OpenSSL/0.9.7i
[Fri Mar 27 22:03:40 2009] [notice] Digest: generating secret for digest authentication ...
[Fri Mar 27 22:03:40 2009] [notice] Digest: done
[Fri Mar 27 22:03:40 2009] [notice] Apache/2.0.61 (Unix) mod_ssl/2.0.61 OpenSSL/0.9.7l DAV/2 PHP/5.2.5 configured -- resuming normal operations
[Fri Mar 27 22:03:40 2009] [info] Server built: Jan 17 2008 17:33:42
[Fri Mar 27 22:03:40 2009] [emerg] (13)Permission denied: apr_proc_mutex_lock failed. Attempting to shutdown process gracefully.
[Fri Mar 27 22:03:40 2009] [emerg] (13)Permission denied: apr_proc_mutex_lock failed. Attempting to shutdown process gracefully. 
```

...更像最后两行，直到我最终停止服务器...

```
[Fri Mar 27 22:03:43 2009] [info] removed PID file /usr/local/apache2/logs/httpd.pid (pid=8786)
[Fri Mar 27 22:03:43 2009] [notice] caught SIGTERM, shutting down 
```

一些关于这个`permission denied`的谷歌搜索和`apr_proc_mutex_lock`失败并没有产生任何有用的东西。只有一些与 MPM 和 perchild 选项相关的结果，但由于它们很旧（2002 年和 2003 年）而且我在阅读它们后真的不能得出任何结论，我问你是否有办法克服这个问题。好吧，首先：实际上是什么问题？模块之间是否存在某种不兼容？我是否必须重新编译某些东西（请主，不要再编译了，不）？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T01:59:44.280

只是感谢您没有使用 apache 1.3——在其上运行 SSL 要困难得多！

mod_ssl 需要几个文件的写权限才能工作。查看[此设置](http://httpd.apache.org/docs/2.0/mod/mod_ssl.html#sslmutex)并确保 apache 具有对该文件所在目录的写入权限。例如，如果说（例如）：

`SSLMutex file:/var/run/apache/ssl.mutex`

您需要验证 apache 是否可以写入`/var/run/apache`.

几乎所有这些类型的错误通常都是文件系统上的某种权限错误。

# math - 如何使用改进欧拉法做一个程序来解决三个函数？

> ID：693333
> 
> 赞同：2
> 
> 时间：2009-03-28T19:13:26.753
> 
> 标签：math, extension-methods, numerical-integration

我被赋予了三个功能：

```
dx/dt = a(y-x)
dy/dt = x(b-z)-y
dz/dt = xy-cz 
```

所有变量均由用户设置。如果它只是基本的单方程问题，我可以做到。但是现在，我需要使用改进的欧拉方法编写程序。该方法可以同时解决三个功能吗？或者我可以使用龙格-库塔法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T19:36:45.357

根据这个[描述](http://www.shodor.org/refdesk/Resources/Algorithms/ImprovedEulersMethod/)，改进的欧拉方法只是二阶龙格-库塔方法......无论如何，我看不出有任何理由不能使用改进的欧拉方法和三个方程。只需分别对每个变量应用相同的过程，例如

```
x(i+1) = x(i) + 0.5 * dt * (
                a*(y(i)-x(i)) +
                一个*（
                   y(i)-x(i) +
                   dt*a*(y(i)-x(i))
                )
         )
```

同样对于`y`和`z`。

# spring - Spring Acegi - 社交网络平台

> ID：693342
> 
> 赞同：2
> 
> 时间：2009-03-28T19:15:54.643
> 
> 标签：spring, spring-security

spring Acegi security 是否可以用于社交网络应用程序，用户可以设置他们的安全偏好以仅与他们的朋友共享他们的数据？

Acegi 教程的常见场景是您要授权每个用户角色的操作，但是授权用户查看特定数据（例如，仅他们朋友的数据）呢？

是否可以为此使用Acegi？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T19:46:53.100

简短的回答：是的。

请注意，Acegi 现在是[Spring](http://www.springsource.org/projects)的一部分，现在称为[Spring Security](http://static.springframework.org/spring-security/site/)。

至于如何去做，这是一个复杂得多的问题，并且可能有与愿意尝试的人一样多的正确答案。您的最终解决方案将取决于您开发的应用程序的需求、您所处的环境以及您设计的组织。我假设您希望每个人（或大多数人）都能看到基本信息，并且如果请求者是朋友，敏感信息只会出现在页面上。

我相信最基本的方法将涉及在您的 servlet/控制器/资源中使用[SecurityContext](http://static.springsource.org/spring-security/site/apidocs/org/springframework/security/core/context/SecurityContext.html)（设计 Web 应用程序的方法太多，无法在这里做出假设）和页面模板（jsf、jsp 等......等） ..)，以获取对当前经过身份验证的用户的访问权限，并且仅包含允许用户访问的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-02T19:54:09.720

Spring Security 的基本要素是

```
- Security Interceptor
  - Authentication Manager
  - Access Decision Manager 
  - Run-As Manager
  - After-Invocation Manager 
```

安全拦截器的实际实现将取决于要保护的资源。如果您要保护 Web 应用程序中的 URL，安全拦截器将作为 servlet 过滤器实现。但是，如果您要保护方法调用，则将使用方面来强制执行安全性。

安全拦截器只是拦截对资源的访问以加强安全性。它实际上并不应用安全规则。相反，它将责任委托给各个经理。

通过使用适当的经理，您将设法满足您的要求。

参考：Manning Spring in Action 第 2 版 2007 年 8 月

# coding-style - GoTo 标签的命名约定

> ID：693347
> 
> 赞同：6
> 
> 时间：2009-03-28T19:17:53.017
> 
> 标签：coding-style, naming-conventions, label, goto

您如何命名您的 GoTo 标签？我很少经常使用，所以我很难找到好名字。

*请避免经典的“goto is evil and eat your code alive Discussion”*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T19:21:52.740

在批处理文件中，我经常使用 HELL。

像：

```
some_command || GOTO HELL

...

HELL: 

echo "Ouch, Hot!" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-28T19:24:28.663

我的标签名称几乎总是属于以下模式之一：

*   称为“重新启动”，用于重新启动一组嵌套循环，因为更改使某些内容无效
*   在 return 语句之前称为“exit”或“return”，只是因为跟踪语句记录了返回值以进行调试
*   与它替换的布尔变量同名

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T19:45:37.973

*   “清理”，如果它在释放一些先前分配的资源（或类似的“最终”部分工作）之前

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T20:03:49.270

在 fortran 中，我使用 goto 进行回滚，我通常从 999 向后开始（在 fortran 中，goto 标签只是数字）

```
 call foo(err)
    if (err /= 0) goto 999

    call bar(err)
    if (err /= 0) goto 998

    call baz(err)
    if (err /= 0) goto 997

    ! everything fine
    error = 0
    return

997 call undo_bar()
998 call undo_foo()
999 error = 1
    return 
```

如果出于某种原因我想跳过回滚部分，我也会使用大于 1000 的标签。

在 C 和其他语言中，我会使用 rollbacknumber（例如 rollback1、rollback2），因此从标签中可以清楚地看出您将要回滚。这基本上是使用 goto 的唯一充分理由。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T19:50:43.310

我通常只需要2个案例。因此，我的 goto 标签是*begin*或*finally*。

# c# - 数组访问的安全元素

> ID：693353
> 
> 赞同：11
> 
> 时间：2009-03-28T19:20:38.797
> 
> 标签：c#, .net, arrays, tryparse

使用扩展方法或 LINQ访问数组元素的安全方法是什么`IndexOutOfRangeException`？`TryParse``TryRead`

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2018-06-18T19:49:34.847

使用`System.Linq` [`ElementAtOrDefault`](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.elementatordefault)方法。它在不引发异常的情况下处理超出范围的访问。如果索引无效，它会返回一个默认值。

```
int[] array = { 4, 5, 6 };
int a = array.ElementAtOrDefault(0);    // output: 4
int b = array.ElementAtOrDefault(1);    // output: 5
int c = array.ElementAtOrDefault(-1);   // output: 0
int d = array.ElementAtOrDefault(1000); // output: 0 
```

**另请参阅**：[DotNetPearls - ElementAt](https://www.dotnetperls.com/elementatordefault)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-28T19:22:56.967

您可以使用以下扩展方法。

```
public static bool TryGetElement<T>(this T[] array, int index, out T element) {
  if ( index < array.Length ) {
    element = array[index];
    return true;
  }
  element = default(T);
  return false;
} 
```

例子：

```
int[] array = GetSomeArray();
int value;
if ( array.TryGetElement(5, out value) ) { 
  ...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-08-06T01:49:28.037

将此扩展为空检查和超出范围检查。

```
public static class ArraySafe
{
    public static bool TryGetElement<T>(this T[] array, int index, out T element)
    {
        if(array == null || index < 0 || index >= array.Length)
        {
            element = default(T);
            return false;
        }

        element = array[index];
        return true;
    }
} 
```

用法：

```
public void Test()
    {
        int[] intAry = new Int32[10];
        int v;
        if (intAry.TryGetElement(6, out v))
        {
            //here got value
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T19:46:22.433

如果要安全地遍历数组中的元素，只需使用枚举器：

```
foreach (int item in theArray) {
   // use the item variable to access the element
} 
```

# c# - 远程 Winforms 应用程序的最佳方式是什么？

> ID：693355
> 
> 赞同：1
> 
> 时间：2009-03-28T19:21:05.677
> 
> 标签：c#, .net, winforms, wcf, remoting

所以我有一个项目，在专用网络上运行。我有一台与某些特定硬件连接的计算机，并通过 Winforms 提供一个用户界面来控制它们。

现在，我想要拆分应用程序的能力，这样所有界面和主要业务逻辑都运行在一台计算机上，但 GUI 运行在另一台计算机上，通过网络连接。只会运行一个 GUI。第一个冲动当然是“使用远程桌面”，但是显示的高帧率视频不太适合这种方式。

我可以通过多种方式流式传输视频，但是在 Winforms 前端和服务后端之间进行通信的最简单方式是什么？.Net 远程处理？WCF？自己滚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T19:24:43.403

WCF 运行良好，但您可能还想查看 RemObjects SDK。这很灵活。它具有您在表单/服务上放置的客户端和服务器组件，您可以通过更改属性在整个协议范围之间切换。如果您需要，有不同平台的版本。

[http://www.remobjectssdk.com/net.aspx](http://www.remobjectssdk.com/net.aspx)

除非我有非常具体的性能需求，否则我不会自己动手。使用已经完成了艰苦工作的东西要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T19:25:45.460

我会检查 WCF 作为第一个选项。使用 WCF 使得将应用程序拆分为服务变得非常容易和自然，并让您可以灵活地轻松更改“绑定”以在性能和互操作性之间找到平衡。

如果您需要高性能，请查看较低级别的二进制绑定，例如 NetTcp。

# c++ - 用于 C++ 的 Visual Studio 代码指标插件

> ID：693361
> 
> 赞同：5
> 
> 时间：2009-03-28T19:22:57.387
> 
> 标签：c++, visual-studio, visual-studio-2008, metrics

是否有用于 C++ 代码度量的 VS2008 插件？我有 Team System，但它不适用于非 .NET 代码。我尝试了 studioTools，但它只是冻结了。那么，有人知道真正有效的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T19:26:40.403

它不是一个插件，但来自[http://www.campwoodsw.com/](http://www.campwoodsw.com/)的 Source Monitor是一个很棒的免费指标工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-01T19:11:08.413

好吧，我发现 CodeRush 可以做到这一点。

# forum - 公司内网/网盘知识分享论坛

> ID：693371
> 
> 赞同：1
> 
> 时间：2009-03-28T19:29:55.013
> 
> 标签：forum, intranet, network-drive, messageboard

我正在研究在我的公司设立论坛/留言板以实现知识共享等的可行性。

实施此类解决方案涉及哪些步骤？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-08T03:22:30.353

我肯定会推荐一个 Wiki——我们在内部使用 Mindtouch 已经很多年了，并且还在外部发布了我们所有的文档在 wiki 上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T20:13:10.887

这些步骤将取决于您已经拥有的技术以及您的商店类型。如果您有 SharePoint（WSS 3.0 或 MOSS 2007），那么您已经内置了博客、wiki 和讨论组功能。不是世界上最好的，但它就在那里。

使用更多开源工具的商店不太可能发现 SharePoint 引人注目。;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T22:51:12.283

我会推荐一个 wiki 服务器，而不是（或者可能是除了）讨论论坛。通过这种方式，您可以获得不同的操作指南、列表、文档等，并且重要的内容往往会保持最新。我们部门有一个，它非常有用（如果只有人们[在编辑时登录](https://stackoverflow.com/questions/381169/how-to-encourage-non-anonymous-editing-on-a-wiki)......）。

我没有参与设置它，所以我不能提供任何细节，但它是基于[mediawiki](http://www.mediawiki.org/wiki/MediaWiki)的。

# c# - 在 C# 中用于赚钱的最佳数据类型是什么？

> ID：693372
> 
> 赞同：476
> 
> 时间：2009-03-28T19:30:39.630
> 
> 标签：c#, types, currency

在 C# 中用于赚钱的最佳数据类型是什么？

* * *

## 回答 #1

> 赞同：472
> 
> 时间：2009-03-28T19:32:54.867

正如[十进制](https://msdn.microsoft.com/en-us/library/364x0z75(v=vs.140).aspx)描述的那样：

> 十进制关键字表示 128 位数据类型。与浮点类型相比，十进制类型的精度更高，范围更小，**适用于金融和货币** 计算。

您可以按如下方式使用小数：

```
decimal myMoney = 300.5m; 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2009-03-28T19:32:13.760

[System.Decimal](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)

> Decimal 值类型表示从正数 79,228,162,514,264,337,593,543,950,335 到负数 79,228,162,514,264,337,593,543,950,335 的十进制数。Decimal 值类型适用于需要大量有效整数和小数位数且无舍入错误的财务计算。Decimal 类型不会消除舍入的需要。相反，它最大限度地减少了由于四舍五入引起的错误。

我想指出zneak 关于为什么不应该使用 double 的[出色答案。](https://stackoverflow.com/questions/3730019/why-not-use-double-or-float-to-represent-currency/3730040#3730040)

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2009-03-28T19:41:56.780

使用[企业应用程序架构模式中](http://martinfowler.com/books.html#eaa "Patterns of Enterprise Application Architecture")的[金钱模式](http://martinfowler.com/eaaCatalog/money.html)。将金额指定为小数，将货币指定为枚举。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-03-28T19:33:19.017

十进制。如果您选择双精度数，您将面临舍入错误

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-03-28T19:34:45.563

小数的范围更小，但精度更高 - 所以你不会随着时间的推移失去所有这些便士！

完整的细节在这里：

[http://msdn.microsoft.com/en-us/library/364x0z75.aspx](http://msdn.microsoft.com/en-us/library/364x0z75.aspx)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-03-28T20:07:43.380

同意货币模式：使用小数时处理货币太麻烦了。

如果你创建一个 Currency 类，你可以把所有与钱相关的逻辑放在那里，包括一个正确的 ToString() 方法，更多的解析值控制和更好的分割控制。

此外，使用 Currency 类，不可能无意中将钱与其他数据混在一起。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-02-16T22:21:03.373

另一种选择（特别是如果您正在滚动自己的课程）是使用 int 或 int64，并将低四位（甚至可能是 2）指定为“小数点右侧”。所以“在边缘”你需要一些“* 10000”在路上，一些“/ 10000”在离开的路上。这是微软的SQL Server使用的存储机制，见[http://msdn.microsoft.com/en-au/library/ms179882.aspx](http://msdn.microsoft.com/en-au/library/ms179882.aspx)

这样做的好处是你所有的求和都可以使用（快速）整数算术来完成。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-02-08T01:18:25.493

我使用过的大多数应用程序都`decimal`用来代表金钱。这是基于应用程序永远不会关注超过一种货币的假设。

这个假设可能基于另一个假设，即应用程序永远不会在其他国家使用不同的货币。我见过被证明是错误的案例。

现在，这一假设正以一种新的方式受到挑战：比特币等新货币正变得越来越普遍，而且它们并不特定于任何国家。仅在一个国家使用的应用程序可能仍需要支持多种货币并非不现实。

有些人会说，为了钱而创建甚至使用类型是“镀金”，或者增加了超出已知要求的额外复杂性。我强烈反对。一个概念在你的领域中越普遍，做出合理的努力来预先使用正确的抽象就越重要。如果您想了解复杂性，请尝试在过去使用的应用程序中工作，现在每个属性旁边都有`decimal`一个附加属性。`Currency``decimal`

如果你预先使用了错误的抽象，那么以后替换它将会增加一百倍的工作量。这意味着可能会在现有代码中引入缺陷，最好的部分是这些缺陷可能涉及大量金钱、金钱交易或任何金钱交易。

使用十进制以外的东西并不难。谷歌“nuget money type”，您会看到许多开发人员（包括我）创建了这样的抽象。这很容易。它就像使用`DateTime`而不是将日期存储在`string`.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-03-28T20:03:12.377

创建自己的班级。这看起来很奇怪，但 .Net 类型不足以涵盖不同的货币。

# ruby-on-rails - Rails named_scope 和 has_and_belongs_to_many

> ID：693381
> 
> 赞同：2
> 
> 时间：2009-03-28T19:35:36.420
> 
> 标签：ruby-on-rails, ruby

我有 3 个表 - 电影、电影流派（用于连接 2 个表）和流派。在模型 film.rb - has_and_belongs_to_many :genres 在模型genre.rb - has_and_belongs_to_many :films

那么，我该如何编写这个 sql 代码：

SELECT * FROM `genres`INNER JOIN `films_genres`ON `genres`.id = `films_genres`.genre_id WHERE ( `films_genres`.film_id = 1)

在 Model film.rb 中使用 named_scope 显示所有电影类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T23:32:05.370

```
class Model < ActiveRecord::Base
  named_scope :by_genre, lambda { |*genres|
    {
      :include => :genres,
      :conditions => [ "genres.id IN (?)", genres.map(&:id) ]
    }
  }
end

Film.by_genre(western, sci_fi).find(:all) 
```

为了将多种流派指定为命名范围的一部分，我将其制作得稍微复杂一些。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T22:18:10.990

用英语，你想从数据库中提取什么？要检索特定电影的类型，只需执行以下操作：

```
@genres = @film.genres 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T22:39:08.163

伙计！我尝试从与电影相关的类型的数据库列表中汇集。我的问题是：如何在 film.rb 模型中使用 named_scome 来做到这一点？我需要这个用于电影过滤器。例如链接：[http ://clearcove.ca/blog/2008/12/recipe-restful-search-for-rails/#more-218](http://clearcove.ca/blog/2008/12/recipe-restful-search-for-rails/#more-218)

数据库：

电影： id 名称 描述 年份

电影流派：id 电影 ID 流派 ID

流派：身份证名称

# ruby - Ruby XML解析异常

> ID：693382
> 
> 赞同：0
> 
> 时间：2009-03-28T19:35:41.583
> 
> 标签：ruby

每次我尝试在 Ruby 中解析 http get_response 数据时都会收到 ParseException。异常是因为数据中存在“&”。我该如何解决这个问题？

原始字符串中的非法字符 '&' (REXML::ParseException)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T02:44:39.760

检查以确保您尝试解析的数据是格式良好的 XML。如果您尝试从 Web 传递 HTML 或 RSS，那么它几乎肯定不是格式良好的 XML（HTML 不是 XML，尽管 XHTML 可能是，虽然 RSS 应该是 XML，但有很多不好的RSS 生成器一般 RSS 格式不正确或无效）。

如果您需要解析 HTML，请尝试[Hpricot](http://wiki.github.com/why/hpricot)。如果需要解析RSS，使用内置的RSS解析器；[这里](http://www.rubyrss.com/)有一些例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T19:41:11.400

您传递给解析器 XML 的数据是什么？其他解析器会抱怨吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T00:24:52.680

如果您尝试解析 HTML，请考虑使用[Nokogiri](http://nokogiri.rubyforge.org/nokogiri/)。

```
Nokogiri::HTML("<html>...</html>") 
```

您也可以尝试`Nokogiri::XML`，但我认为这需要有效的标记。

# curl - WAMP 的 CURL

> ID：693385
> 
> 赞同：5
> 
> 时间：2009-03-28T19:36:35.623
> 
> 标签：curl, wamp, libcurl

我是 PHP 新手，我正在尝试学习如何解析信息，我正在尝试使用 CURL，但我无法在 Windows Vista 上的桌面 WAMP 上安装它。如何安装 CURL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T10:38:17.790

某处似乎有一个错误。如果您在 Windows 7 64 位上遇到此问题，请尝试安装 Apache 插件版本 2.2.9 和 PHP 插件版本 5.3.1 并切换到 WAMP 中的插件，然后激活 CURL 扩展。这对我有用。

您可以从[http://www.wampserver.com/en/](http://www.wampserver.com/en/)下载它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T19:55:43.207

查看*[cURL 在 Windows 上使用 PHP 和 Apache](http://www.tonyspencer.com/2003/10/22/curl-with-php-and-apache-on-windows/)*的说明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T14:43:47.130

添加一个类似的问题。一旦我在这里升级到最新版本的 Wampserver 64x 就修复了[http://www.wampserver.com/](http://www.wampserver.com/)

# .net - 为什么执行 .Net 2.0 构建干净的解决方案会导致错误？

> ID：693387
> 
> 赞同：2
> 
> 时间：2009-03-28T19:38:07.100
> 
> 标签：.net, vb.net, visual-studio-2005, .net-2.0

我有一个创建 DLL 的 .net 解决方案。它由两个项目组成。（边信息一包含一些我用 VB.Net 编写的特殊函数/类等。第二个是特定于客户端的一些函数/类等，这些使用我的类）经过一些这个和那个和另一个工作我可以毫无困难地构建和重建解决方案。没有错误、警告等。

我检查了项目依赖关系，它们是正确的。例如，我的代码不依赖于客户端代码，但客户端代码确实依赖于我的代码。构建顺序：我的代码，然后是客户端代码。这一切对我来说都很好。

现在只是为了确定一切正常，我执行 Build>Clean Solution。导致以下问题：1 个警告（找不到参考组件 ADODB）6 个错误（所有错误都在我的代码中，它们以 ADODB 参考为中心）

我可以看到我的代码中的 ADODB 引用上有一个警告图标。但是我刚刚发现，如果我双击该图标（在解决方案资源管理器中），则会显示对象浏览器并且警告消失。

如果现在我进行两次重建，错误就会消失，一切都很开心。

底线问题：

1.  为什么进行清洁解决方案构建会导致这些警告和问题？
2.  我该怎么做才能使这些问题停止发生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T20:29:51.437

**（编辑以尝试尊重您实际提出的 2 个问题）**

黄色警告图标发生在我身上，链接到第三方控件的特定版本。我针对一个版本引用了它，然后用一个新版本替换了 DLL，并得到了警告图标。将引用的“特定版本”属性更改为“False”可以解决问题（将其保留为“True”并更改正在引用的版本号）

1.  干净的构建可能会删除存储的配置，这可能包括您忽略有关 ADODB 的警告。

2.  也许您正在参考 ADODB 的特定版本，并且应该将其更改为忽略版本号或更新版本号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T20:11:12.513

我通常尽量避免在 .NET 项目中使用 COM 对象。您可能已经找到了我偏爱的原因之一。;-)

两个项目都引用 ADODB 吗？它们是否都引用了相同版本的对象？

# c# - 我应该为我的域模型中的图像使用什么数据类型？

> ID：693389
> 
> 赞同：2
> 
> 时间：2009-03-28T19:38:40.187
> 
> 标签：c#, domain-driven-design

我将 Silverlight 与 DDD 方法一起使用。我有一个 Person 域对象，它具有 FirstName、LastName、Address 等属性。Person 需要有一个 Image。

处理这个问题的最佳方法是什么？

我真的不想在 Person 对象上放置 Windows.Controls.Image 属性，因为这将与 Silverlight/WPF 耦合，并且我可能希望在将来将此对象与其他一些技术（ASP、WinForms、下一个新事物等）。

我还需要能够在某处保存和加载图像。将图像保存到数据库或文件系统是最佳实践吗？我目前正在将 nHibernate 与 Microsoft SQL Server 一起使用，但我也希望能够通过 mySql 和可能的其他一些数据库支持 nHibernate。也有可能有一天我想用实体框架或其他技术替换 nHibernate（我正在使用存储库将其抽象出来）。

鉴于此信息，我应该如何处理我的 Person 的图像？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T20:04:02.623

好吧，`byte[]`（或包装 a 的东西`byte[]`）是相当可移植的......大多数其他东西都将是特定于实现的。

重新数据库 vs 文件...出于客户端应用程序（Silverlight、WPF 等）的目的，我可能会通过网页而不是 WCF（等）调用公开它们 - 即一些 ASP.NET 处理程序（或 ASP.NET MVC 路由），通过 http 调用返回图像。然后，您在客户端中**真正**需要的只是图像的路径（`/people/images/12345`或其他）。

对于存储 - 通常都可以...在 SQL Server 2008 中，您可以使用文件流类型同时执行这两项操作。在数据库中存储 BLOB 的问题之一是增加大小，但一些（小）图像通常不会受到伤害（除非您使用 SQL Express 并且有一个上限数据库大小）。但是使用数据库的优点是单个备份包含所有内容。

话虽如此：我所做的几乎所有实现都使用了文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:01:10.747

您实际上是否将二进制 blob 用于任何事情？如果没有，请传递对文件系统上某些内容的引用。`byte[]`如果您开始随身携带's 或其他东西，我会担心惹恼事情。

如果您是 WPF，则一切都将 URI 作为 ImageSource：

```
BitmapImage pic = new BitmapImage(new Uri("YourAssembly;components/images/something.jpg")); 
```

请记住，如果您按照我建议的路线并将其移至 Silverlight，您将需要`crossdomain.xml`在您正在分发这些内容的域上创建一个文件。

如果您确实需要弄乱二进制 blob，则将所有内容保留`Stream`为某种形式，并让您的`Person.Image`班级提供一种获取`StreamReader`/`StreamWriter`喜欢的方法`GetImageStream()`。然后你的数据库东西可以得到一个`StreamReader`并将这些东西写入数据库。如果不检查，我的猜测是几乎所有具有二进制 blob 的数据库都使用 a `Stream`，而不是`byte[]`.

...只是一些想法。不要忘记 BitmapImage 也可以让您利用它的 Stream，但是您必须在文档中查找它 :-) 希望对您有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T21:03:43.853

最佳实践是封装困难的决定。定义自己的 Image 类并隐藏实现。

假设您不是在编写图像编辑应用程序，那么 Image 类的域部分将会很薄。表示和存储不在您的域图像类中，它们在适配器中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T23:15:53.880

我会使用文件系统有几个原因：

1.  您不必将图像类型存储在单独的字段中（BMP？JPEG？PNG？）
2.  您可以选择使用轻量级、经过微调的服务器来提供图像（或者，如果您的缩放需要，可以使用多个）
3.  您无需在代码中弄乱 byte[]s - 只需使用字符串
4.  如果您决定更改数据库，您将遇到更少的问题 - 您甚至可以使用 INSERT 脚本进行迁移

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T22:10:27.610

嗯，`System.Drawing.Image`这几乎与技术无关。它准确地代表了您想要的（imo）：可以以某种众所周知的图像格式从某个流加载/保存到某个流并且可以显示在屏幕上（在 WinForms 或 WPF 中）的东西。

# c++ - 我如何开始使用 boost

> ID：693390
> 
> 赞同：11
> 
> 时间：2009-03-28T19:38:48.283
> 
> 标签：c++, boost

我在这里听到了很多关于 boost 的信息，我开始认为它对我的软件开发有很大帮助。在我的特殊情况下，在并发和内存管理方面更是如此，因为我们在这方面有很多错误。

我需要完善哪些关键语言功能才能有效地从使用 boost 中受益并缩短学习曲线？我已经看到***函数对象***是常用的，所以我可能需要对此进行改进。

此外，是否有任何教程和 101 资源我可以快速查看以感受和理解使用 boost。

我意识到有很多提升机会，我必须为正确的工作选择正确的工具，但任何潜在客户都会有所帮助。

### 有关的

*   [如何学习 boost](https://stackoverflow.com/questions/379290/how-to-learn-boost)（不再有效；HTTP 返回状态 404）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T19:55:31.800

Boost has an unimaginable number of libraries. Easy ones to get started on are

*   noncopyable
*   array
*   circular_buffer
*   foreach
*   operators (one of my personal favorites)
*   smart_ptr
*   date_time

More advanced ones include

*   lambda
*   bind
*   iostreams
*   serialization
*   threads

Getting used to boost takes time, but I assure you it will make your life much better. Plus, looking at how the boost libraries are coded will help you get better at c++ coding, especially templates.

You mentioned what should you look up before trying boost. I agree that function objects are a great thing to research. Also, make sure to look up about template programming. A common problem to make sure you know is when to use the `typename` qualifier for dependent types. For the most part, however, the libraries are very well documented, with examples and reference materials.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-28T19:47:24.677

Learning boost is discussed [here](https://stackoverflow.com/questions/379290/how-to-learn-boost/). As for language features that are useful? All of them. C++ is a dangerous language to use if you don't know enough of it. RAII, functors/function objects and templates probably cover the most important aspects. Boost is designed similarly to the STL, so knowing your standard library is essential. Boost itself uses a lot of template metaprogramming, but as a library user, you won't often need that (unless you start playing with Boost.MPL)

Bugs related to memory management are a good indicator that it's C++, rather than Boost you need to brush up on. The techniques for handling memory safely are well known, and not specific to Boost. (With the obvious exception of Boost's smart pointers). [RAII](http://en.wikipedia.org/wiki/RAII) is probably the most important concept to understand to deal with this kind of issues.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-28T19:43:30.317

> 我需要完善哪些关键语言功能才能有效地从使用 boost 中受益并缩短学习曲线？

*   模板
*   函子
*   例外
*   STL
    *   迭代器
    *   算法
    *   容器

……等等。

> 是否有任何教程和 101 资源我可以快速查看以感受和理解使用 boost。

Boost 有据可查。[从这里](http://www.boost.org/doc/libs/1_38_0/more/getting_started/index.html)开始。

有太多的图书馆迷路了。我想说从一些简单的东西开始，也许是智能指针或 Boost.Test（单元测试框架）——这将很快帮助你开始。另外，试着想想你不能用 STL 轻易解决的问题。然后查找 Boost 文档或在此处发布。

如果您对函数式编程感到满意，请查看 MPL/Lambda 库。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-28T20:01:28.807

The first ting IMO are [smart pointers](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/smart_ptr.htm). Integration into new code is simple, and usually not a problem for existing code. They make memory management easy, and work for many other ressources, too.

C++ gives you the power to manage your own memory, smart pointers let you (mostly) wing it when you don't need to.

The second would be - as you mentioned - function objects, they close a big gap within C++ that is traditionally solved through inheritance, which is to strong of a coupling in many cases.

I have only little experience with boost outside these two, but most of the remainder is fairly "situational" - you may or may not need it. Get an [overview over the libraries](http://www.boost.org/doc/libs/1_38_0), and see what you need.

`boost::any` and `boost::variant` are good of you need a variant data type, with two different approaches.

`boost::regex` if you need some text parsing.

`boost::thread` and `boost::filesystem` help you write portable code. If you already have *good* platform specific libraries, you might not need them - but they are better than API or C++ level in any case.

Maybe you like my introduction to [boost smart pointers](http://www.codeproject.com/KB/stl/boostsmartptr.aspx), and [a rather unorthodox](http://www.codeproject.com/KB/stl/boostsp_handleref.aspx) use for them.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T20:31:34.477

Try Björn Karlsson's book: [Beyond the C++ Standard Library: An Introduction to Boost](https://rads.stackoverflow.com/amzn/click/com/0321133544). Its pretty straightforward and easy to grasp. I read this after I'd finished Scott Meyers three c++ books (effective series).

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T11:49:05.580

After reading [Beyond the C++ Standard Library: An Introduction to Boost](https://rads.stackoverflow.com/amzn/click/com/0321133544), I would recommend casually browsing the documentation on [boost.org](http://www.boost.org/doc/libs/1_38_0), just to get an idea of what's available. You can do a deep dive into a specific boost library when it looks like a good fit for a particular application.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T19:46:40.123

I think shared_ptr sould be the easiest place to start . Start using it inplaces of simple pointer or auto_ptr data types.

You can also look into weak_ptr.

# javascript - JS / jQuery 中类似 Flash 的视觉效果

> ID：693397
> 
> 赞同：1
> 
> 时间：2009-03-28T19:41:51.663
> 
> 标签：javascript, jquery, dhtml

我知道有成千上万种用 JS 制作的视觉效果可以在 Google 上找到。但是大多数效果在网页设计中是无用的，或者像“鼠标光标后的时钟”一样过时了：| 我也知道[http://www.chromeexperiments.com](http://www.chromeexperiments.com)和[http://www.dhteumeuleu.com](http://www.dhteumeuleu.com)之类的网站，但这些示例使网络浏览器使用 100% 的 CPU 功率，并且大多看起来不错，仅作为示例。

我正在寻找的是没有 Flash 几乎不可能实现的效果，不使用 100% CPU，并且不打扰用户。**我需要它用于游戏网页。**一个很好的例子是这个：http: [//jqueryfordesigners.com/demo/trovster.html](http://jqueryfordesigners.com/demo/trovster.html) - 仔细查看标题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T20:10:25.557

看看**[jQuery UI——](http://jqueryui.com/)**它为低级交互和动画、高级效果和高级、可主题化的小部件提供抽象，构建在[jQuery JavaScript 库](http://jquery.com)之上，您可以使用它们来构建高度交互的 Web 应用程序。

以下是使用[jQuery UI](http://jqueryui.com/)的网站列表：

*   [Arcadya](http://www.arcadya.net/) – 电视剧的种子和字幕（iGoogle/Netvibes 风格）
*   [Beltrami](http://www.beltrami.be/) – 产品选择器、相册、搜索功能……</li>
*   [EA](http://www.ea.com/) – 电子游戏
*   [iRich](http://www.irich.tw/) – 在线跟踪您的开支。(中文 中文)
*   [kolko.bg](http://kolko.bg/) – 保加利亚唯一可靠的网络购物助手。
*   [MacWorld.fr](http://www.macworld.fr/)
*   [PCworld.fr](http://www.pcworld.fr/)
*   [Poker Square](http://plaes.org/games/poker_square/) – 单人纸牌游戏
*   [PartyHandbook](http://www.partyhandbook.co.uk/) – 英国夜总会活动列表指南

演示和文档：http: [//jqueryui.com/demos/](http://jqueryui.com/demos/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T01:55:33.463

[jParallax](http://webdev.stephband.info/parallax.html)是一个高效的 jQuery 插件，可以进行类似游戏的视差滚动。对网页设计有用吗？嗯……如果你*真的*想要像电子游戏一样的东西，也许。

# wpf - WPF 在其他 ControlTemplate 中重用模板

> ID：693403
> 
> 赞同：3
> 
> 时间：2009-03-28T19:44:12.687
> 
> 标签：wpf, controltemplate

我目前正在尝试弄清楚如何在其他控件模板中重用模板（如标题所示）。我想做的是制作一堆按钮，它们都略有不同，但有几个相似的功能。它们都共享几个相同的图形元素，并具有处理这些图形元素的相同触发器。我希望做的是能够将该代码取出并将其放入另一个模板中，并且只需让所有按钮都引用该模板。这样一来，管理起来更容易，整体上也更有意义。我确信有一种方法，但我对 WPF 还是很陌生。谢谢你的帮助！

编辑：这是一些显示我想要做的代码。

```
<ControlTemplate x:Key="LeftJustifyButtonTemplate" TargetType="{x:Type RadioButton}">
    <Grid Width="24" Height="24">
        <Rectangle HorizontalAlignment="Stretch" Fill="#00000000" Stroke="{x:Null}"/>
        <Rectangle x:Name="backRectangle" HorizontalAlignment="Stretch" Margin="0,0,0,0" Stroke="#FFB9B9B9" StrokeThickness="0.5" RadiusX="4" RadiusY="4" Visibility="Hidden">
            <Rectangle.Fill>
                <LinearGradientBrush EndPoint="0.146,0.146" StartPoint="2.057,2.057">
                    <GradientStop Color="#FF000000" Offset="0"/>
                    <GradientStop Color="#FFFFFFFF" Offset="1"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>
        <Rectangle x:Name="foreRectangle" Margin="1,1,1,1" VerticalAlignment="Stretch" Fill="#FFE0E0E0" Stroke="{x:Null}" StrokeThickness="0.5" RadiusX="4" RadiusY="4" Visibility="Hidden"/>
        <Path Margin="2.875,7,2.875,0" Fill="#FFFFFFFF" Stretch="Fill" Stroke="#FF000000" Data="M2.875,7.5 L21.145964,7.5" VerticalAlignment="Top" Height="1" StrokeThickness="0.5"/>
        <Path Margin="2.875,9.375,8,0" VerticalAlignment="Top" Height="1" Fill="#FFFFFFFF" Stretch="Fill" Stroke="#FF000000" Data="M3.625,4 L17.514069,4" StrokeThickness="0.5"/>
        <Path Margin="2.875,11.5,2.875,11.5" Fill="#FFFFFFFF" Stretch="Fill" Stroke="#FF000000" Data="M2.875,7.5 L21.145964,7.5" StrokeThickness="0.5"/>
        <Path Margin="2.875,0,8,9.375" VerticalAlignment="Bottom" Fill="#FFFFFFFF" Stretch="Fill" Stroke="#FF000000" Data="M3.625,4 L17.514069,4" Height="1" StrokeThickness="0.5"/>
        <Path Margin="2.875,0,2.875,7" Fill="#FFFFFFFF" Stretch="Fill" Stroke="#FF000000" Data="M2.875,7.5 L21.145964,7.5" VerticalAlignment="Bottom" Height="1" StrokeThickness="0.5"/>
    </Grid>
    <ControlTemplate.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
            <Setter TargetName="backRectangle" Property="Visibility" Value="Visible"/>
            <Setter TargetName="foreRectangle" Property="Visibility" Value="Visible"/>
        </Trigger>
        <Trigger Property="IsChecked" Value="True">
            <Setter TargetName="backRectangle" Property="Visibility" Value="Visible"/>
            <Setter TargetName="foreRectangle" Property="Visibility" Value="Visible"/>
            <Setter TargetName="foreRectangle" Property="Fill" Value="#FFFFFFFF"/>
        </Trigger>
    </ControlTemplate.Triggers>
</ControlTemplate> 
```

除了中间的 5 个路径之外，几乎所有这些都用于几个按钮。这是因为它用于鼠标悬停和检查触发器。我想要做的是能够将所有代码放在一个地方，然后让几个按钮能够引用该代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T05:08:51.697

我不相信您可以使用模板来做到这一点，但请查看 Style 的 BasedOn 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T19:49:56.823

你到底在说什么区别？您也许可以通过附加属性和触发器的组合来解决这个问题，但我们需要更多地了解您的问题。

# eclipse - 从 Eclipse PDT 执行外部文件？

> ID：693428
> 
> 赞同：2
> 
> 时间：2009-03-28T20:05:22.153
> 
> 标签：eclipse, command-line, executable, eclipse-pdt

我想在 Eclipse PDT 中将按钮添加到工具栏或菜单项到菜单以运行外部命令行 exe 或 bat 文件。如何在 Windows 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T17:39:21.520

您可以创建自定义“外部工具”运行配置。

单击“运行”按钮旁边的按钮，该按钮看起来与“运行”按钮相同，只是它有一个红色的小工具箱。选择“外部工具配置”并创建一个新的“程序”运行配置。

# iphone - 查询应用商店？

> ID：693430
> 
> 赞同：3
> 
> 时间：2009-03-28T20:07:07.407
> 
> 标签：iphone

Apptism 和 Appbeacon 等网站如何从 AppStore 构建应用程序列表？有没有办法查询商店并获取标题、作者、评分等信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T20:15:56.400

他们对 html 进行屏幕抓取。[这篇文章](http://benchatelain.com/2009/03/05/scraping-app-store-rankings-around-the-world/)可能对你有所帮助。

一些网站（例如 Pinch）使用这些数据来提供不同应用程序类别的 RSS 提要及其相关信息。根据您的需要，这可能是一个更简单的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:43:33.593

App Store 也有 XML 提要，其中包括类别、发布日期等。

这是一篇文章，描述了可用的内容以及如何使用它。 [您对 App Store 的看法](http://www.pinchmedia.com/your-view-into-the-app-store/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-11T00:56:44.930

一些专门从事 ASO 服务的公司提供对其底层架构的访问。他们抓取商店为他们的 SAAS 产品或咨询服务生成数据。他们通过 API 提供对数据的访问（收费）。

示例包括：

1.  [http://apptweak.io](http://apptweak.io)
2.  [https://developer.searchman.com/](https://developer.searchman.com/)

# java - 我在哪里可以找到 Open-Flash-Charts 和 Java 的好例子

> ID：693433
> 
> 赞同：0
> 
> 时间：2009-03-28T20:08:45.373
> 
> 标签：java, grails, plugins, groovy, charts

网上有一些 open-flash-charts 教程，大部分是我所看到的 php。我知道有一个 Java 助手类，但我还没有找到文档或示例。

辅助库也包含在 ofcharts grails 插件中。

欢迎提出 Java/Groovy 或 Grails 建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T20:35:38.070

我发现的最好的来源之一是[这里](http://www.ofc2dz.com/)

来自网站：“这个网站现在主要用于发布示例、帮助和补丁，供用户在我偶尔出没的 OFC2 论坛上寻求帮助。”

在我用它开发 Java/Grails 图表中证明是无价的。请记住，除了生成 JSON 之外，您几乎不需要做任何其他事情来使图表正常工作。为此，Grails 是理想的 - 但是您将花费大量时间来构建 JSON 数据。

链接站点提供了最详细的 JSON API 文档，这些文档适用于 OFC 支持的不同图表类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-11T00:48:23.093

还有一个托管在 Google Code 上的 Java API 参考开源项目：

[http://code.google.com/p/jofc2/](http://code.google.com/p/jofc2/)

这是嵌入在我一直使用的 Grails 插件中的代码，因此文档帮助了很多！

# svn - 在 Subversion 中修改历史文件的最佳实践是什么？

> ID：693439
> 
> 赞同：1
> 
> 时间：2009-03-28T20:11:03.230
> 
> 标签：svn, version-control

可以说我有文件

```
helloworld.c
helloworld.m 
```

15 次编辑前，有人在 helloworld.c 中泄露了 memroy，并且已经成功地将它变成了几个分支。我想在它设法进入的所有分支上更正该版本的历史记录。

还原文件并尝试重新签入的最终效果是什么？明明14变以后我就不想输了？

更新：我确信有人遇到过这个问题，我想知道他们发现什么对他们有用以及为什么。

我是否密集地认为管理分支和主干的方式是我必须在文件存在的每个上下文中访问该文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T20:16:41.547

为什么要更正历史？这个把戏一直让星际迷航陷入困境。

更好的是，在当前版本中进行更改 - 或恢复当前版本 - 并提交它。然后将更改合并到任何分支中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T20:16:15.917

您不想修改历史记录。历史是文件经历的编辑序列——不是你篡改的东西。

只需使用内存泄漏修复程序更新每个分支的头部和主干，然后就可以了。通常，在新提交中引用您正在恢复旧更改是一个好主意。例如：

1.  人在 r100 中引入泄漏
2.  团队在 r101-r115 中进行更改
3.  您使用提交消息提交 r116：“由于内存泄漏而恢复 r100”

祝你好运，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T20:13:44.003

您可以还原单个版本。可能存在冲突，但您可以解决它们。

或者您可以修复当前文件中的错误并提交它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T20:16:30.347

即使您恢复主干上的更改，已经创建的分支也会有问题 - 人们必须使用您的最新分支重新分支，或者只是将主干上的修复合并到他们的分支 - 我认为这可能是最好的 IF这个问题对他们中的任何一个人来说都是一个真正的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T10:30:51.230

不幸的是，您需要将修复程序添加到每个头部。虽然我确信在技术上可以使用 svnadmin dump 和 dumpfilter 来完成这个技巧，但至少可以说是对历史的一种狡猾的重写，并且需要重建你的存储库。

最新的 tortoisesvn 1.6 有一个非常好的修订图，它可以让你找出所有更改的去向。

# php - PHP 问题诊断提示？

> ID：693441
> 
> 赞同：0
> 
> 时间：2009-03-28T20:11:41.093
> 
> 标签：php, iis, iis-7

我不是PHP专家，仍在学习它。我想要一些关于如何解决问题的提示。

最近我在 Vista+IIS7 (phpIsapi) 上安装了 PHP 5.2.9。我运行了一个执行 opendir()/readdir() 的脚本。这个脚本在 5.2.0 上运行得很好。在 v5.2.9 上，它失败了，但我没有得到问题根源的迹象。

我在黑暗中四处寻找故障排除，最后尝试不同的目录并将其缩小到目录权限问题。更多地敲打以确定哪个用户需要烫发。尽管该页面作为网络服务运行，但在目录上需要 perms 的用户是 IUSR。它需要对整个遍历树进行 RX perms。谁知道？

我还使用了一堆 COM 组件。他们中的一些人工作，一些人没有。他们经常以“没有错误”而失败。在我解决问题之前，它再次在黑暗中颠簸。

我尝试了 error_reporting(E_ALL | E_STRICT) 但这没有给我更多有用的东西。我知道这不可能是人们在使用 PHP 开发时进行故障排除的方式。

当小问题出现时，您可以提供任何有效解决小问题的提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T20:36:13.187

[http://www.xdebug.org/](http://www.xdebug.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-24T18:44:22.727

好吧，我的回答是：不，没有好办法。

# c# - 为什么我的网站经常冻结？

> ID：693445
> 
> 赞同：1
> 
> 时间：2009-03-28T20:15:25.857
> 
> 标签：c#, asp.net, sql, sql-server

这是一个非常模糊的问题，得到答案似乎是一个很长的机会，但我不知道还能做什么。

自从我不时让我的网站上线以来，它就会冻结。你点击一个链接，浏览器就会在那里看起来像是在尝试连接。似乎冻结可以持续长达 2 分钟左右，然后一切都很好。然后过了一会儿，它会做同样的事情。

我在日志文件中跟踪我网站上发生的所有异常。

我得到这些相当多..

> 超时已过。操作完成前超时时间已过或服务器无响应

堆栈跟踪显示它导致了一些连接到数据库的方法。

我假设冻结与这个超时问题有关。我的网站托管在共享服务器上，我的数据库位于其他服务器上，其中还有大约十亿个其他数据库。

但即使在共享服务器上，这种冻结问题也一直在发生。它非常烦人。考虑到我的网站是基于电子商务的，并且人们在上面进行交易，我可以看到这是一个非常灾难性的问题。我想要的最后一件事是当我的用户点击“提交付款”按钮时网站冻结，然后由于网站冻结，导致他们一遍又一遍地点击提交付款按钮，然后信用卡被收取大约 10 次额外费用。

有人对处理此问题的最佳方法有任何建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T20:19:44.550

我猜它与数据库连接有关。检查他们是否被正确释放？如果没有，那么它将全部用完。

还要检查您的数据库是否配置了连接池。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:16:01.663

> 超时已过。操作完成前超时时间已过或服务器无响应

这是一个 Sql 命令超时异常 - 如果您的数据库负载不足，这可能会有些常见。确保您正在处理 SqlConnections 和 SqlCommands - 尽管这通常会导致池超时异常（无法从连接池中检索连接）。

奇怪的是，*有人*正在运行调整不当或以其他方式占用资源的查询。它可能是您的站点，但由于您在共享数据库服务器上，因此它可能很容易成为其他人的站点。它也可能是阻塞或打开的事务——因为这些事务将在您的数据库中，这将是一个编码问题。您可能需要让您的托管服务提供商参与来跟踪它或移动到专用的数据库服务器。

您可以减少 SqlCommands 的 CommandTimeout - 我知道这听起来有点违反直觉，但我经常发现早点失败比尝试 60 秒给服务器带来额外负载要好。如果您的 0.5 秒查询没有在 5 秒内完成，那么很有可能它也不会在 60 秒内完成。

或者，如果您是患者类型，则可以增加 CommandTimeout - 但如果您将其增加太多，您还需要修改 90 秒的 IIS 超时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T20:52:55.783

超时错误绝对是冻结页面的根源。当它发生时，页面将在返回错误消息之前等待数据库连接大约一分钟。由于 Web 服务器一次只处理来自每个用户的一个页面，因此整个站点对于用户来说似乎是冻结的，直到出现超时错误。即使它只是偶尔发生在少数用户身上，对他们来说似乎也很严重，因为他们一分钟左右根本无法访问该网站。

问题的严重程度取决于您得到多少错误。从你的描述看来，你得到的东西太多了，不正常。

确保您的所有数据读取器、命令对象和连接对象都得到正确处理，这样您就不会让连接保持打开状态。

还要在日志中查找死锁错误，因为它们可能导致超时。如果您有相互锁定的查询，您可以通过更改它们使用表的顺序来改进它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T22:06:31.270

检查 SQL Server 日志，尤其是死锁。

如果您打开了多个连接，则其中一个可能正在等待被另一个锁定的行。

# winforms - C# 窗口中的多个表单

> ID：693446
> 
> 赞同：1
> 
> 时间：2009-03-28T20:15:46.183
> 
> 标签：winforms

我正在尝试构建一个简单的应用程序来测试在一个应用程序中拥有多个表单的想法。例如，在 Visual Studio 中，您有 IDE - 设计区域，在右侧，您有一个名为 Properties and Solution Explorer 的表单

当您单击右侧设计区域中的某个内容（即文本框）时，所选对象的属性会自动更改。

我不想将 PropertyGrid 添加到对象所在的同一表单的顶部，它必须是独立的。

我的最终目标是拥有一个 3D 查看器/WPF，并在右侧有一个表单。当您在 3D 查看器中单击一条线或点时，所选对象的属性必须显示在 PropertyGrid 中

其次，我希望能够停靠表单，或重置为默认布局。

Screenesnhot：（ ![截屏](https://i.stack.imgur.com/Sn0an.jpg)属性应该停靠在主窗体内 - 不像屏幕截图）

示例：~~[http](http://dan.virgesystems.com/images/CPVimage.JPG)~~ ://dan.virgesystems.com/images/CPVimage.JPG （死链接）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T07:18:35.810

如果你决定使用 WinForms，有一个很好的 VS 风格对接的 C# 开源库：http: [//sourceforge.net/projects/dockpanelsuite/](http://sourceforge.net/projects/dockpanelsuite/)

这是使用它的应用程序的屏幕截图：[http ://wiki.openstreetmap.org/wiki/Image:Kosmos.2.0.png](http://wiki.openstreetmap.org/wiki/Image:Kosmos.2.0.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T23:26:17.380

尝试将您的查看器和表单封装到用户控件中。您可以根据需要使用拆分器控件或面板来布局容器表单。用户控件之间的通信可以通过事件或直接引用来完成。

# .net - 嵌入式系统的数据库

> ID：693450
> 
> 赞同：5
> 
> 时间：2009-03-28T20:16:31.453
> 
> 标签：.net, database, embedded

我正在寻找一个非常高性能和便宜（希望是免费的）数据库引擎，用于**Windows CE**中的 x86 嵌入式平台。任何人都可以提供一些建议吗？我正在寻找的重要内容是：

1.  高性能（用于实时系统）
2.  低成本
3.  可与 Compact .NET 框架一起使用

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T20:22:13.640

鉴于您的需求，最简单的可能是[SQL Server Compact Edition](http://www.microsoft.com/Sqlserver/2005/en/us/compact.aspx)

1.  性能相当不错。
2.  自由
3.  提供良好的 .NET 互操作性

[SQLite](http://www.sqlite.org/)是另一个满足上述所有条件的选项。有许多测试可以比较这两者在不同条件下的性能。

# c# - C# 和 Java 等语言如何避免类似 C/C++ 的独立编译？

> ID：693457
> 
> 赞同：6
> 
> 时间：2009-03-28T20:23:33.450
> 
> 标签：c#, java, compiler-construction, programming-languages

在我的编程语言课上，我正在写一篇关于语言设计史上一些重要人物的论文的研究论文。CAR Hoare 的一篇让我觉得很奇怪，因为它反对 C 和后来的 C++ 中使用的独立编译技术，甚至在 C 流行之前。

既然这主要是为了加快编译时间的优化，那么 Java 和 C# 是什么让它们能够避免依赖独立编译呢？它是一种编译器技术，还是语言中的元素有助于实现这一点？还有其他编译语言在它们之前使用过这些技术吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T21:58:27.060

简短的回答：Java 和 C# 不避免单独编译；他们充分利用它。

它们的不同之处在于它们不需要程序员在编写可重用库时编写一对单独的头文件/实现文件。用户编写一个类的定义一次，编译器从该单个定义中提取与“头”等效的信息，并将其作为“类型元数据”包含在输出文件中。因此，输出文件（Java 中的`.jar`完整`.class`文件，或`.dll`基于 .NET 语言的程序集）是单个包中的二进制文件和头文件的组合。

然后当编译另一个类并且它依赖于第一个类时，它可以查看元数据，而不必查找单独的包含文件。

碰巧它们针对的是虚拟机而不是特定的芯片架构，但这是一个单独的问题；他们可以将 x86 机器代码作为二进制文件放入，并且在同一个文件中仍然具有类似标题的元数据（这实际上是 .NET 中的一个选项，尽管很少使用）。

在 C++ 编译器中，通常尝试使用“预编译头文件”来加速编译。.NET`.dll`和`.class`文件中的元数据很像预编译的标头——已经解析和索引，可以快速查找。

结果是，在这些现代语言中，有一种模块化方式，它具有完美组织和手动优化的 C++ 模块化构建系统的特征——非常漂亮，说[ASFAC++B](http://www.earwicker.com/asfacppb.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T20:29:39.053

IMO，这里最大的因素之一是 java 和 .NET 都使用中间语言；这意味着编译单元（jar/程序集）作为先决条件包含许多关于类型、方法等的表达元数据；这意味着它已经很方便地进行了参考检查。无论如何，运行时仍然会检查，以防你拉一个快速的；-p

这与支持 COM 的 MIDL 相距不远，尽管 TLB 通常是一个单独的实体。

如果我误解了你的意思，请告诉我...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T22:53:56.520

您可以认为 java .class 文件类似于 C/C++ 中的预编译头文件。本质上，.class 文件是 C/C++ 链接器所需的中间形式以及包含在标头中的所有信息（Java 只是没有单独的标头）。

在另一篇文章中形成您的评论：

> “我基本上是指 C/C++ 中的想法，即每个源文件都是其自己的单独编译单元。在 C# 或 Java 中似乎并非如此。”

在 Java 中（我不能说 C#，但我认为它是相同的）每个源文件都是它自己的单独编译单元。我不知道为什么你会认为它不是......也许我们对编译单元有不同的定义？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T20:34:09.103

它需要一些语言支持（否则，C/C++ 编译器也会这样做）

特别是，它要求编译器生成自包含模块，这些模块公开元数据，其他模块可以引用以调用它们。

.NET 程序集就是一个简单的例子。一个项目中的所有文件编译在一起，生成一个dll。.NET 可以查询此 dll 以确定它包含哪些类型，以便其他程序集可以调用其中定义的函数。

为了利用这一点，引用其他模块的语言必须是合法的。

在 C++ 中，什么定义了模块的边界？该语言指定编译器仅考虑其当前编译单元（.cpp 文件 + 包含的头文件）中的数据。没有指定“我想在模块 Bar 中调用函数 Foo，即使我在编译时没有原型或任何东西”的机制。在文件之间共享类型信息的唯一机制是使用#includes。

有人提议在 C++ 中添加模块系统，但不会出现在 C++0x 中。最后我看到，计划是在 0x 出来后考虑将它用于 TR1。

（值得一提的是，最初使用 C/C++ 中的#include 系统是因为它可以*加快*编译速度。早在 70 年代，它就允许编译器以简单的线性扫描来处理代码。它不必构建语法树或其他此类“高级”功能。今天，表格已经转变，它已成为可用性和编译速度方面的巨大瓶颈。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-28T20:35:02.707

由 C/C++ 生成的目标文件只能由链接器读取，而不是由编译器读取。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T21:28:34.260

至于其他语言：IIRC Turbo Pascal 有“单元”，您可以在没有任何源代码的情况下使用。我认为重点是创建元数据以及编译后的代码，然后编译器可以使用这些元数据来确定模块的接口（即函数签名、类布局等）

C/C++ 的一个问题是，它阻止仅用某种#import 替换#include 也是预处理器，它可以完全改变包含/导入模块的含义/语法等。对于类似 Java 的模块系统，这将是非常困难的（如果不是不可能的话）。

# python - 有没有人为 Python（特别是 Python 3.0）开发成功配置了 NetBeans？

> ID：693459
> 
> 赞同：8
> 
> 时间：2009-03-28T20:23:37.053
> 
> 标签：python, ide, netbeans

通过转到 Python 平台管理器，创建一个新平台并将 NetBeans 指向我安装 2.6.1 的 python.exe，我能够为 2.6.1 配置 NetBeans。但是，当我按照与 3.0 完全相同的步骤操作时，我在 NetBeans 控制台中收到一个错误，显示“SyntaxError：无效语法”。

如果重要的话，Python 会以这种格式安装：

```
/Program Files
    /Python
        /2.6
            python.exe and everything else
        /3.0
            python.exe and everything else 
```

我想知道是否有其他人经历过这种情况以及他们为纠正问题所做的工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T00:05:55.787

是的-实际上很容易。插件中的脚本使用 'print' 作为关键字，在 Python 3 中已更改；您只需将 NetBeans 安装目录中“python1”文件夹下的 console.py 和 platform_info.py 文件中的所有“打印”语句转换为使用括号。例如，在 platform_info.py 中，第一行打印说：

```
print "platform.name="+ "Jython " + version 
```

将其更改为：

```
print("platform.name="+ "Jython " + version) 
```

并对所有打印语句执行此操作。然后进入 NetBeans 并将您的 Python30 目录导入 Python 平台管理器；它会工作得很好。

我还没有遇到任何其他问题，但是插件中可能还有其他一些小的语法问题；它们应该很容易修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T18:58:09.153

它不允许我在这里发表评论，所以我会在帖子中回答您的评论。

是的，它也可以让你使用 Python 2.x；'print' 方法在 Python 3 之前既是关键字又是函数，因此括号是可选的。与 3 一样，它们是必需的，因此此更改是向后兼容的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T19:19:31.410

调试存在一些问题，顺便说一句，当我成功找出必须在此处更新的内容时，我会告诉大家。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-16T15:49:05.833

感谢 Ben Flynn 提供将 python30 与 netbeans 6.71 集成的解决方案

但是，这段代码：

```
def fib(n):    # write Fibonacci series up to n
     """Print a Fibonacci series up to n."""
     a, b = 0, 1
     while b < n:
         print (b, end=' ')
         a, b = b, a+b

fib(2000) 
```

这是来自帮助站点的示例代码，在 IDE 中运行时没有出现错误，但编辑器抱怨：

```
Internal parser error
"no viable alternative at input'=' " 
```

这表明它正在解析 python2.5.1

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T01:07:27.347

从 3.0 版开始，打印语句必须写成函数...

您的

打印（b，结束=''）

变成

打印（“结束=”，乙）

# bash - 如何将特定分隔符之间的文本捕获到 shell 变量中？

> ID：693460
> 
> 赞同：6
> 
> 时间：2009-03-28T20:24:21.857
> 
> 标签：bash, unix, variables

指定我的变量我没有什么问题。我有一个带有普通文本的文件，其中某处有括号`[ ]`（整个文件中只有一对括号），以及它们之间的一些文本。我需要在 shell (bash) 变量中捕获这些括号内的文本。请问我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T20:33:11.337

重击/sed：

```
VARIABLE=$(tr -d '\n' filename | sed -n -e '/\[[^]]/s/^[^[]*\[\([^]]*\)].*$/\1/p') 
```

如果那是不可读的，这里有一点解释：

```
VARIABLE=`subexpression`      Assigns the variable VARIABLE to the output of the subexpression.

tr -d '\n' filename  Reads filename, deletes newline characters, and prints the result to sed's input

sed -n -e 'command'  Executes the sed command without printing any lines

/\[[^]]/             Execute the command only on lines which contain [some text]

s/                   Substitute
^[^[]*               Match any non-[ text
\[                   Match [
\([^]]*\)            Match any non-] text into group 1
]                    Match ]
.*$                  Match any text
/\1/                 Replaces the line with group 1
p                    Prints the line 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-28T23:33:08.923

我可以指出，虽然大多数建议的解决方案都可能有效，但*绝对没有理由*分叉另一个 shell，并产生多个进程来完成如此简单的任务。

Shell 为您提供了所需的所有工具：

```
$ var='foo[bar] pinch'
$ var=${var#*[}; var=${var%%]*}
$ echo "$var"
bar 
```

*   看：[http://mywiki.wooledge.org/BashFAQ/073](http://mywiki.wooledge.org/BashFAQ/073)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T21:26:51.597

sed 不是必需的：

```
var=`egrep -o '\[.*\]' FILENAME | tr -d ][` 
```

但它仅适用于单行匹配。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T10:14:26.447

使用 Bash 内置正则表达式匹配似乎是另一种方式：

```
var='foo[bar] pinch'
[[ "$var" =~ [^\]\[]*\[([^\[]*)\].* ]]   # Bash 3.0
var="${BASH_REMATCH[1]}"
echo "$var" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T20:34:23.893

关于什么：

```
shell_variable=$(sed -ne '/\[/,/\]/{s/^.*\[//;s/\].*//;p;}' $file) 
```

在 Korn shell 下的 Solaris 10 上为我工作；也应该与 Bash 一起使用。`$(...)`在 Bourne shell 中将' ' 替换为反引号。

*编辑*：当在一行上给出 [ 并且在另一行上给出 ] 时工作。对于单行情况，请使用：

```
shell_variable=$(sed -n -e '/\[[^]]*$/,/\]/{s/^.*\[//;s/\].*//;p;}' \
                        -e '/\[.*\]/s/^.*\[\([^]]*\)\].*$/\1/p' $file) 
```

第一个 ' `-e`' 处理多行传播；第二个 ' `-e`' 处理单行情况。第一个' `-e`'说：

*   从包含左括号的行开始，在同一行上`[`没有后跟右括号`]`
*   直到包含右括号的行`]`，
*   用空字符串替换任何内容，包括左括号，
*   用空字符串替换从右括号开始的任何内容，并且
*   打印结果

第二个' `-e`'说：

*   对于任何同时包含左括号和右括号的行
*   用中间记住的字符替换由“直到并包括左括号的字符”、“直到但不包括右括号的字符”（并记住这一点）、“从右括号开始的东西”组成的模式，以及
*   打印结果

对于多行情况：

```
$ file=xxx
$ cat xxx
sdsajdlajsdl
asdajsdkjsaldjsal
sdasdsad [aaaa
bbbbbbb
cccc] asdjsalkdjsaldjlsaj
asdjsalkdjlksjdlaj
asdasjdlkjsaldja
$ shell_variable=$(sed -n -e '/\[[^]]*$/,/\]/{s/^.*\[//;s/\].*//;p;}' \
                          -e '/\[.*\]/s/^.*\[\([^]]*\)\].*$/\1/p' $file)
$ echo $shell_variable
aaaa bbbbbbb cccc
$ 
```

对于单行情况：

```
$ cat xxx
sdsajdlajsdl
asdajsdkjsaldjsal
sdasdsad [aaaa bbbbbbb cccc] asdjsalkdjsaldjlsaj
asdjsalkdjlksjdlaj
asdasjdlkjsaldja
$
$ shell_variable=$(sed -n -e '/\[[^]]*$/,/\]/{s/^.*\[//;s/\].*//;p;}' \
                          -e '/\[.*\]/s/^.*\[\([^]]*\)\].*$/\1/p' $file)
$ echo $shell_variable
aaaa bbbbbbb cccc
$ 
```

在这里的某个地方，在 Perl 中完成整个工作变得更简单，在两个多行替换操作中对文件进行 slurping 和编辑结果字符串。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T20:34:56.263

假设您正在询问 bash 变量：

```
$ export YOUR_VAR=$(perl -ne'print $1 if /\[(.*?)\]/' your_file.txt) 
```

如果括号在同一行，则上述方法有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T20:35:43.280

```
var=`grep -e '\[.*\]' test.txt | sed -e 's/.*\[\(.*\)\].*/\1/' infile.txt` 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T21:03:02.060

感谢大家，我使用了 Strager 的版本并且运行良好，再次感谢...

```
var=`grep -e '\[.*\]' test.txt | sed -e 's/.*\[\(.*\)\].*/\1/' infile.txt` 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-29T12:10:30.007

反斜杠（BSL）被咀嚼了......：

```
var='foo[bar] pinch' 
[[ "$var" =~ [^\]\[]*\[([^\[]*)\].* ]]   # Bash 3.0 
# Just in case ...: 
[[ "$var" =~ [^BSL]BSL[]*BSL[([^BSL[]*)BSL].* ]]   # Bash 3.0 
var="${BASH_REMATCH[1]}" 
echo "$var" 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T15:36:53.747

*2个简单的步骤来提取文本。*

1.  在 [ 处拆分 var 并获得正确的部分
2.  在 ] 处拆分 var 并获取左侧部分

> ```
> cb0$ var='foo[bar] pinch'
> cb0$ var=${var#*[}
> cb0$ var=${var%]*} && echo $var
> bar 
> ```

# activex - 如何在我的应用程序中嵌入 Adob e Acrobat Professional 或 Standard（非 Reader）？

> ID：693462
> 
> 赞同：1
> 
> 时间：2009-03-28T20:24:42.417
> 
> 标签：activex, adobe, acrobat

如何在我的应用程序中嵌入 Adob​​e Acrobat Professional 或 Standard（非 Reader）？

它有 ActiveX 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T20:39:03.897

不，这些是全面的应用程序。没有办法嵌入这些。但是，您可以使用 PDF 库（用于操作 PDF）。Adobe 确实提供了一份 PDFL（付费）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-20T12:08:01.023

尽管 Acrobat 不能“嵌入”到您的应用程序中，但它的自动化类型库确实允许您使用其`OpenInWindowEx()`例程安排在应用程序的窗口中绘制 .PDF。这不会在您的应用程序中显示 Acrobat 的 UI，但您可以通过调用类型库中定义的对象来合并其大量 UI 功能。

# c# - 运算符 as 和泛型类

> ID：693463
> 
> 赞同：36
> 
> 时间：2009-03-28T20:27:06.420
> 
> 标签：c#, .net, generics, operators, on-the-fly

我想做一个方法：

```
object Execute()
{
    return type.InvokeMember(..);
} 
```

接受一个通用参数：

```
T Execute<T>()
{
    return Execute() as T;

    /* doesn't work:
    The type parameter 'T' cannot be used with the 'as' operator because
    it does not have a class type constraint nor a 'class' constraint */

    // also neither typeof(T), nor T.GetType() are possible

    return (T) Execute(); // ok
} 
```

但我认为 operator`as`将非常有用：如果结果类型不是`T`方法将返回`null`，而不是异常！有可能吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-03-28T20:29:59.770

您需要添加

```
where T : class 
```

到您的方法声明，例如

```
T Execute<T>()  where T : class
{ 
```

顺便说一句，作为建议，通用包装器并没有真正增加太多价值。调用者可以写：

```
MyClass c = whatever.Execute() as MyClass; 
```

或者如果他们想失败：

```
MyClass c = (MyClass)whatever.Execute(); 
```

通用包装器方法如下所示：

```
MyClass c = whatever.Execute<MyClass>(); 
```

所有三个版本都必须指定完全相同的三个实体，只是顺序不同，因此没有一个更简单或更方便，但是通用版本隐藏了正在发生的事情，而“原始”版本每个都清楚地表明是否存在是一个 throw 或一个`null`.

（如果您的示例从您的实际代码简化，这可能与您无关）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-28T20:31:35.177

您不能将`as`运算符与没有限制的泛型类型一起使用。由于`as`运算符使用 null 来表示它不是该类型，因此您不能在值类型上使用它。如果要使用**, 必须**`obj as T`是`T`引用类型。

 **```
T Execute<T>() where T : class
{
  return Execute() as T;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-10-15T10:47:16.103

这段代码是**as**关键字的异常安全替换：

```
return Execute() is T value ? value : default(T) 
```

它使用 C# 7 引入的模式匹配功能。如果您不想将泛型参数限制为引用类型，请使用它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T20:47:09.587

似乎您只是添加了一个包装器方法来转换为用户想要的类型，因此只会增加执行的开销。对于用户来说，写

```
int result = Execute<int>(); 
```

与

```
int result = (int)Execute(); 
```

您可以使用*out*修饰符将结果写入调用者范围内的变量中，并返回一个布尔标志来判断它是否成功：

```
bool Execute<T>(out T result) where T : class
{
    result = Execute() as T;
    return result != null;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T20:47:26.933

Execute() 是否有可能返回值类型？如果是这样，那么您需要 Earwicker 的类类型方法和值类型的另一种通用方法。可能看起来像这样：

```
Nullable<T> ExecuteForValueType<T> where T : struct 
```

该方法内部的逻辑会说

```
object rawResult = Execute(); 
```

然后，您必须获取 rawResult 的类型并查看它是否可以分配给 T：

```
Nullable<T> finalReturnValue = null;

Type theType = rawResult.GetType();
Type tType = typeof(T);

if(tType.IsAssignableFrom(theType))
{
    finalReturnValue = tType;     
}

return finalReturnValue; 
```

最后，让您的原始 Execute 消息找出 T 具有哪个（类或结构类型），并调用适当的实现。

**注意：这是粗略的记忆。大约一年前我这样做了，可能不记得每个细节。不过，我希望为您指明大方向会有所帮助。**

# sql - SQL 连接帮助

> ID：693466
> 
> 赞同：0
> 
> 时间：2009-03-28T20:29:29.847
> 
> 标签：sql, mysql

```
<?php

$query = mysql_query("SELECT * FROM threads 
                          INNER JOIN accounts
                          ON threads.author = accounts.id 
                          WHERE id = ".intval($_GET['threadID']));
$row = mysql_fetch_assoc($query);

$title = $row['title'];

?> 
```

如果我在两个表中都有一个名称相同的列怎么办？（标题）它怎么知道要买哪一个？我如何告诉它从帐户表中获取它，而不是从没有不同名称的线程中获取它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T20:35:07.667

您可以使用别名来获取具有不同名称的列

```
SELECT t.*, a.title AS account_title 
FROM threads t INNER JOIN accounts... 
```

如果您只想获取帐户标题，请列出您想要的线程中的列

```
SELECT t.wanted_column, t.another_column, a.* 
FROM threads t, INNER JOIN accounts a... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T20:32:07.673

就像在内部连接中一样限定它。

```
WHERE accounts.id = 'something' 
```

# objective-c - Cocos2d 中的 UITextField 示例

> ID：693483
> 
> 赞同：12
> 
> 时间：2009-03-28T20:34:51.397
> 
> 标签：objective-c, cocos2d-iphone, textfield

谁能建议一些在 cocos2d 中使用 UITextField 的链接。我想按下标签，然后`UITextField`应该被选中，我需要对其进行编辑`UITextField`。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-07T10:44:21.820

我在当前项目中这样做是为了允许输入要开始播放的关卡编号，这就是为什么我的变量和方法以它们的方式命名的原因；您可能应该调整这些以对您有意义。

在您的应用控制器中，将其定义为实例变量：

```
 UITextField *levelEntryTextField; 
```

在 applicationDidFinishLaunching 中创建它：

```
 levelEntryTextField = [[UITextField alloc] initWithFrame:
                                              CGRectMake(60, 165, 200, 90)];
  [levelEntryTextField setDelegate:self]; 
```

定义激活文本字段的方法。您还应该在应用控制器的头文件中声明它。

```
- (void)specifyStartLevel
{
    [levelEntryTextField setText:@""];
    [window addSubview:levelEntryTextField];
    [levelEntryTextField becomeFirstResponder];    
} 
```

这将使在键盘上按“返回”结束编辑

```
- (BOOL)textFieldShouldReturn:(UITextField*)textField {
  //Terminate editing
  [textField resignFirstResponder];
  return YES;
} 
```

这是在实际完成编辑时触发的。

```
- (void)textFieldDidEndEditing:(UITextField*)textField {
    if (textField==levelEntryTextField) {
        [levelEntryTextField endEditing:YES];
        [levelEntryTextField removeFromSuperview];
        // here is where you should do something with the data they entered
        NSString *result = levelEntryTextField.text;
    }
} 
```

现在要真正启动事物，你把它放在某个地方。我从我的一个场景类中调用它，以响应用户操作：

```
 [[[UIApplication sharedApplication] delegate] specifyStartLevel]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-14T16:03:51.000

我采用 Jack 提供的示例并实际创建了一个工作项目，这是使用 Cocos2D 0.7.1 XCode 模板完成的，然后仅编辑 *AppDelegate.m/.h 文件，这些文件在下面完整提供。我还修改了 Jack 所说的一些内容，因为我觉得在 appDidFinishLoading 中创建 UITextField 会占用太多内存，特别是如果不是一直使用文本字段...这个解决方案仅在它创建文本字段时需要时，示例绘制一个空的 Cocos2D 图层场景，并在屏幕触摸上显示文本字段供您开始输入文本。它会吐出您输入到控制台的结果 - 您可以将其传递给您自己的代码中所需的任何内容。

.h

```
#import <UIKit/UIKit.h>
#import "cocos2d.h"
@interface MYSCENE : Layer <UITextFieldDelegate>
{
    UITextField *myText;
}
-(void)specificStartLevel;
@end
@interface textFieldTestAppDelegate : NSObject <UIAccelerometerDelegate, UIAlertViewDelegate, UITextFieldDelegate, UIApplicationDelegate>
{
    UIWindow *window;
}
@end 
```

然后是.m

```
#import "textFieldTestAppDelegate.h"
@implementation MYSCENE
-(id) init
{
    self = [super init];
    isTouchEnabled = YES;
    return self;
}
-(BOOL)ccTouchesBegan:(NSSet  *)touches withEvent:(UIEvent *)event {
    [self specifyStartLevel];
    return kEventHandled;
}
-(void)specifyStartLevel {
    myText = [[UITextField alloc] initWithFrame:CGRectMake(60, 165, 200, 90)];
    [myText setDelegate:self];
    [myText setText:@""];
    [myText setTextColor: [UIColor colorWithRed:255 green:255 blue:255 alpha:1.0]];
    [[[[Director sharedDirector] openGLView] window] addSubview:myText];
    [myText becomeFirstResponder];
}
-(BOOL)textFieldShouldReturn:(UITextField *)textField {
    [myText resignFirstResponder];
    return YES;
}
-(void)textFieldDidEndEditing: (UITextField *)textField {
    if(textField == myText) {
        [myText endEditing:YES];
        [myText removeFromSuperview];
        NSString *result = myText.text;
        NSLog([NSString stringWithFormat:@"entered: %@", result]);
    } else {
        NSLog(@"textField did not match myText");
    }
}
-(void) dealloc
{
[super dealloc];
}
@end
@implementation textFieldTestAppDelegate
- (void)applicationDidFinishLaunching:(UIApplication *)application
{
    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    [window setUserInteractionEnabled:YES];
    [[Director sharedDirector] setDisplayFPS:YES];
    [[Director sharedDirector] attachInWindow:window];
    Scene *scene = [Scene node];
    [scene addChild: [MYSCENE node]];
    [window makeKeyAndVisible];
    [[Director sharedDirector] runWithScene: scene];
}
-(void)dealloc
{
    [super dealloc];
}
-(void) applicationWillResignActive:(UIApplication *)application
{
    [[Director sharedDirector] pause];
}
-(void) applicationDidBecomeActive:(UIApplication *)application
{
    [[Director sharedDirector] resume];
}
- (void)applicationDidReceiveMemoryWarning:(UIApplication *)application
{
    [[TextureMgr sharedTextureMgr] removeAllTextures];
}
@end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-30T06:14:40.663

在 cocos2d 中添加文本字段如下代码

首先，您在 Scene 中添加视图，然后在添加文本字段后添加视图，这非常容易。

```
-(id) init
{ 
   if( (self=[super init]) )
    {

       // add view in scene

        UIView *view = [[UIView alloc]initWithFrame:CGRectMake(0, 0, 320, 568)];
        view.backgroundColor  = [UIColor redColor];

     // add textfield in view

        UITextField *textField = [[UITextField alloc] initWithFrame:CGRectMake(10, 140, 300, 30)];
        textField.borderStyle = UITextBorderStyleRoundedRect;
        textField.font = [UIFont systemFontOfSize:15];
        textField.placeholder = @"enter text";
        textField.autocorrectionType = UITextAutocorrectionTypeNo;
        textField.keyboardType = UIKeyboardTypeDefault;
        textField.returnKeyType = UIReturnKeyDone;
        textField.clearButtonMode = UITextFieldViewModeWhileEditing;
        textField.contentVerticalAlignment = UIControlContentVerticalAlignmentCenter;
        textField.delegate = self;
        [view addSubview:textField];

   // add view in scene

      [[[CCDirector sharedDirector] view] addSubview:view];
}
    return self;
} 
```

你也可以在 cocos2d 中使用 CCTextfield 最好的例子是[https://github.com/iNinja/CCTextField](https://github.com/iNinja/CCTextField)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T07:48:13.190

尝试下面的 CCNode 子类 CCMenuItemTextField 来使用 cocos2d 中的文本字段。

该类是 CCMenuItemSprite 的直接子类。点击时，会调用“selected”方法并将 UITextField 添加到主窗口。编辑完成后，将调用“未选择”方法并将 UITextField 从屏幕中删除。用户的输入被保存到 CCLabelTTF 节点，该节点将自身定位为与原始 UITextField 完全相同。

CCMenuItemTextField.h

```
@interface CCMenuItemTextField : CCMenuItemSprite<UITextFieldDelegate> {
    UITextField     *textField_;
    CCLabelTTF      *label_;

    CGFloat         paddingLeft_;
}

@property (readonly, nonatomic) UITextField     *textField;
@property (readonly, nonatomic) CCLabelTTF      *label;
@property (assign, nonatomic)   CGFloat         paddingLeft;

- (void)selected;
- (void)unselected;
- (void)setFontSize:(CGFloat)size;

- (NSString*)text;
- (void)setText:(NSString*)text;

@end 
```

CCMenuItemTextField.m

```
#import "CCMenuItemTextField.h"

@implementation CCMenuItemTextField

@synthesize
textField = textField_,
label = label_,
paddingLeft = paddingLeft_;

- (id)init
{
    CCSprite *normalSprite = [CCSprite spriteWithFile:@"text_field_background.png"];
    CCSprite *selectedSprite = [CCSprite spriteWithFile:@"text_field_background.png"];
    CCSprite *disabledSprite = [CCSprite spriteWithFile:@"text_field_background.png"];

    return [self initWithNormalSprite:normalSprite selectedSprite:selectedSprite disabledSprite:disabledSprite];
}

- (id)initWithNormalSprite:(CCNode<CCRGBAProtocol> *)normalSprite
            selectedSprite:(CCNode<CCRGBAProtocol> *)selectedSprite
            disabledSprite:(CCNode<CCRGBAProtocol> *)disabledSprite 
{
    self = [super initWithNormalSprite:normalSprite
                        selectedSprite:selectedSprite
                        disabledSprite:disabledSprite
                                target:self
                              selector:@selector(selected)];

    if (self) {
        paddingLeft_ = 3.0;

        textField_ = [[UITextField alloc] init];
        [textField_ setTextColor:[UIColor blackColor]];
        [textField_ setFont:[UIFont systemFontOfSize:18]];

        label_ = [[CCLabelTTF node] retain];
        [label_ setAnchorPoint:ccp(0,0.5)];
        [label_ setFontSize:18];
        [label_ setVisible:NO];
        [label_ setColor:ccBLACK];
        [self addChild:label_];
    }

    return self;
}

- (void)dealloc
{
    [label_ release];
    [textField_ release];
    [super dealloc];
}

// --------------------------------
// Public
// --------------------------------

- (void)selected
{
    [super selected];

    [label_ setVisible:NO];

    CGAffineTransform transform = [self nodeToWorldTransform];
    float textFieldHeight = textField_.font.lineHeight;
    float width = self.contentSize.width;
    float height = self.contentSize.height;
    float left = transform.tx + paddingLeft_;
    float top = 480 - transform.ty - height + (height - textFieldHeight) / 2;

    [textField_ setFrame:CGRectMake(left, top, width, height)];
    [[[[CCDirector sharedDirector] view] window] addSubview:textField_];
    [textField_ becomeFirstResponder];
    [textField_ setDelegate:self];
}

- (void)unselected
{
    [super unselected];

    [label_ setVisible:YES];
    [label_ setPosition:ccp(paddingLeft_, self.contentSize.height/2)];

    NSString *text = textField_.text ? textField_.text : @"";
    [label_ setString:text];

    [textField_ resignFirstResponder];
    [textField_ removeFromSuperview];
}

- (NSString*)text
{
    return [label_ string];
}

- (void)setText:(NSString*)text
{
    [label_ setString:text];
    [textField_ setText:text];
}

// --------------------------------
// UITextFieldDelegate
// --------------------------------

- (BOOL)textFieldShouldReturn:(UITextField*)textField {
    [self unselected];
    return YES;
}

- (void)textFieldDidEndEditing:(UITextField*)textField {
    [self unselected];
}

- (void)setFontSize:(CGFloat)size
{
    [label_ setFontSize:size];
    [textField_ setFont:[UIFont systemFontOfSize:size]];
}

// --------------------------------
// CCNode
// --------------------------------

- (void)onExitTransitionDidStart
{
    [super onExitTransitionDidStart];
    [self unselected];
}

@end 
```

# php - 我可以使用哪些工具将 PHP 代码部署到 EC2 实例

> ID：693491
> 
> 赞同：0
> 
> 时间：2009-03-28T20:37:56.177
> 
> 标签：php, amazon-s3, amazon-ec2, amazon-web-services, amazon-ami

我们可以将所有文件捆绑到一个亚马逊机器实例中并上传。但我想看看是否有更有效的方法来定期上传源代码以测试我们的应用程序并不断启动和运行最新版本。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T22:03:32.757

不久前，我发现了一种使用 Git 推送部署 PHP 的简单方法。需要注意的是，该过程假设您已经在使用 Git 作为 VCS，并且您已经在开发机器和服务器上安装了它：

[使用 Git 推送部署项目](https://stackoverflow.com/questions/279169/deploy-php-using-git/327315#327315)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T22:00:34.513

我不确定我是否正确理解了您的问题，但 Amazon 机器实例就像任何其他运行 Linux（或 Windows）的机器一样。如果机器在您的网络中，您可以使用相同的工具。当然，您需要远程执行此操作。[从 Windows 机器上，您可以使用Putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/)或[WinScp](http://winscp.net/)等工具连接到实例- 如果您能够创建新映像，您可能知道这些。使用这些工具来配置您的实例，就像您在本地网络中配置机器一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T01:03:33.603

这取决于你所说的“部署”。我见过有人将 ftp-ing 文件调用到服务器“部署”:) 简而言之，您希望您的部署是：

*   自动化
*   原子
*   可逆的
*   管理数据库架构

更长的描述在这里： [http ://blog.astrails.com/2008/12/17/deployment-process-requirements](http://blog.astrails.com/2008/12/17/deployment-process-requirements)

请注意，您可以使用 ruby​​ 领域的部署工具来完成大部分工作：

*   [卡皮斯特拉诺](http://www.capify.org/)
*   [弗拉德](http://rubyhitsquad.com/Vlad_the_Deployer.html)

# .net - 如何在 .NET 中将双精度值舍入为选定的小数位数？

> ID：693493
> 
> 赞同：1
> 
> 时间：2009-03-28T20:40:05.143
> 
> 标签：.net, double, rounding

我使用加速度传感器来计算当前加速度并返回双精度值。

但是我想将当前加速度与值 9.8 进行比较。在此之前，我必须对从传感器接收到的值进行四舍五入，所以问题是：如何在 .NET 中将双精度值四舍五入为选定的小数位数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T20:43:16.647

Math.Round（数字，精度）

[http://msdn.microsoft.com/en-us/library/zy06z30k.aspx](http://msdn.microsoft.com/en-us/library/zy06z30k.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T20:42:20.550

[Math.Round](http://msdn.microsoft.com/en-us/library/75ks3aby.aspx) - 即

```
double val = Math.Round(current, 1); // 1dp 
```

# windows - 有哪些适用于 Windows 的 Subversion 客户端不需要安装？

> ID：693498
> 
> 赞同：28
> 
> 时间：2009-03-28T20:44:53.320
> 
> 标签：windows, svn

我的一位同事同意在我们的小项目中使用 Subversion (SVN)，但前提是他不必安装它。他有一个[U3 USB 记忆棒](http://en.wikipedia.org/wiki/U3)，用于保存项目文件，并且他希望 SVN 客户端也能保存在那里。我尝试搜索不可安装的 SVN 客户端，但找不到任何东西（尽管我怀疑如果只是从安装文件夹复制粘贴，许多可用的客户端会运行）。有什么可以推荐的？

我真的很想进行版本控制。如果它也有一个用于合并文件的 GUI，而不仅仅是命令行，那将是最好的。

**补充：**现有安装的复制粘贴是一种解决方案，但我想先看看是否可能没有某些客户端不需要按设计进行安装。如果没有，我猜 RapidSVN 已经足够好了（尽管它确实会在 Windows 注册表中留下一些东西）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T20:51:04.507

试试**[RapidSVN](http://www.rapidsvn.org/index.php/Main_Page)**。[**CollabNet 二进制文件**](http://www.collab.net/downloads/subversion/)可以以类似的方式用于命令行支持。是的，这些都有安装程序，但是您可以简单地复制二进制文件——我使用**[Universal Extractor](http://www.softpedia.com/get/Compression-tools/Universal-Extractor.shtml)**来获取二进制文件，而无需运行安装程序。

此外，一位有进取心的用户将**[RapidSVN 打包为 PortableApp](http://portableapps.com/node/6767)**。有一个“安装程序”，但它实际上只是将内容解压缩到您选择的目录中，并将默认配置文件写入该目录。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-09-10T09:48:53.247

试试[Alagazam.net 的 Subversion Windows Installer](http://alagazam.net/)。还有一个只有二进制文件的版本，没有安装程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T20:57:22.963

我会从 SlikSVN 复制并粘贴 bin 文件夹。

编辑：

似乎 SlikSVN 是几个图形 SVN 客户端背后的底层平台。根据我的经验，它似乎稳定可靠。

具体来说，[这个页面](http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=91&expandFolder=91&folderID=260)的底部链接似乎是一个非安装/xcopy 预编译包（虽然我自己没有尝试过这个，只是检查了它）。不过，它似乎不是最新的。您可以通过在自己的计算机上安装[最新的 SlikSVN](http://www.sliksvn.com/en/download)来帮您的朋友一个忙，然后与您的共同开发人员共享 bin 文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T01:20:22.690

如果 Java 在机器上可用，您可以使用[SVNKit](http://svnkit.com/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T21:40:41.160

我使用的是[SmartSVN](https://www.smartsvn.com/)的便携式版本。这是一个相当不错的 SVN 客户端，但它需要[JRE](http://en.wikipedia.org/wiki/Java_Virtual_Machine#Execution_environment)。它有一个很好的 GUI 和所有。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T20:50:41.403

[这里](http://portableapps.com/node/6767)有[RapidSVN](http://www.rapidsvn.org/index.php/Main_Page) 的便携版本。只需将其安装到闪存驱动器即可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T21:06:30.943

备选方案二应该足够了。但是这两种方法都需要将它安装到 USB 设备上，我猜这类似于复制到它上面。我查了[维基百科](http://en.wikipedia.org/wiki/Comparison_of_Subversion_clients)，那里列出了一些独立的。

* * *

编辑：SmartSVN、QSvn（便携式版本需要安装）、SyncrhoSVN（它们有需要您提取和运行的版本）等。但是复制+运行与安装到 USB 有什么不同吗？

* * *

**替代方法一** 在 USB 设备上加载 Cygwin，安装 SVN 支持并运行它。据我所知，没有 GUI，也没有尝试设置一个（我认为这是可能的），因为我有幸使用 TortoiseSVN（需要安装）。

**备选方案二** 在 USB 设备上安装 TortoiseSVN 并在关闭时使用。具有用于合并和差异的 GUI 界面。 [这](https://stackoverflow.com/questions/218904/how-do-i-automate-keeping-my-tortoisesvn-project-up-to-date)可能与您的兴趣有关。然而，谷歌有一些结果表明它们很慢。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-28T21:24:04.770

我能够使用安装在 USB 记忆棒上的命令行客户端。然后，我创建了几个批处理文件，它们执行基本的签出、签入工作，以及一个批处理文件，它给了我一个带有[PATH](http://en.wikipedia.org/wiki/PATH_%28variable%29)集的命令提示符。

它没有像[TortoiseSVN](http://en.wikipedia.org/wiki/TortoiseSVN)这样的所有集成，但我认为您无法通过 USB 记忆棒轻松地做到这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-09T08:11:58.187

我遇到了同样的问题，并认为它会比它更容易找到。Bert Huijben 将解决方案发布为对 Cecil 的回复，但他的链接已过时。

[http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=8100](http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=8100)

滚动到底部，您可以在其中获取二进制文件的 ZIP 文件。这个对我有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-06T11:16:42.130

最后，还有一个 RapidSVN 的 PortableApps 版本：

*   [http://portableapps.com/node/13470](http://portableapps.com/node/13470)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-06T17:38:15.333

我可能回答得太晚了。某些用户可能接受的另一种选择。

Eclipse IDE 是可移植的（不完全是，它依赖于 Java）。使用 Eclipse SVN 插件（Subversive 或 Subclipse）。这样可以满足日常需求。

您可以选择指向 Java Portable 安装以使其真正可移植。但是，我相信使用 USB 笔式驱动器可能会很慢。

# asp.net - ASP.NET System.Data.EntityClient 连接字符串帮助

> ID：693499
> 
> 赞同：6
> 
> 时间：2009-03-28T20:45:52.883
> 
> 标签：asp.net, connection-string

我在共享服务器上运行 ASP.NET MVC，并且在通过 System.Data.EntityClient 连接到 SQL 时遇到问题。下面是我的 hosing 提供商给我连接到 SQL 的连接字符串和 VS 在开发期间为我的本地机器配置的连接字符串，当我部署到服务器时我的连接字符串应该是什么样子？

来自我的托管服务提供商：

```
<add name="WeddingsDBEntities" 
  connectionString="data Source=<server name>; Initial Catalog=<db name>; User ID=<user ID>; Password=<password>;" 
  providerName="System.Data.EntityClient"/> 
```

来自 VS（在开发期间）：

```
connectionString="metadata=res://*/Models.WeddingsModel.csdl|res://*/Models.WeddingsModel.ssdl|res://*/Models.WeddingsModel.msl;provider=System.Data.SqlClient;provider connection string="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\WeddingsDB.mdf;Integrated Security=True;User Instance=True;MultipleActiveResultSets=True"" providerName="System.Data.EntityClient" 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-28T20:57:11.747

您必须将连接字符串包装在实体连接字符串中，其格式为

```
<add name="Name"
  connectionString="metadata=<Conceptual Model>|<Store Model>|<Mapping Model>;
  provider=<Underlying Connection Provider>;
  provider connection string=&quot;<Underlying ConnectionString>&quot;" 
  providerName="System.Data.EntityClient"/> 
```

**代替：**

```
<add name="WeddingsDBEntities" 
  connectionString="data Source=<server name>; Initial Catalog=<db name>; User ID=<user ID>; Password=<password>;" 
  providerName="System.Data.EntityClient"/> 
```

**用这个：**

```
<add name="WeddingsDBEntities"
  connectionString="metadata=res://*/Models.WeddingsModel.csdl|res://*/Models.WeddingsModel.ssdl|res://*/Models.WeddingsModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data Source=<server name>; Initial Catalog=<db name>; User ID=<user ID>; Password=<password>;MultipleActiveResultSets=True&quot;" 
  providerName="System.Data.EntityClient"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-25T04:36:51.307

将提供程序从 entityclient 更改为 sqlclient（假设代码优先 EF）。

providerName="System.Data.EntityClient" />

到

providerName="System.Data.SqlClient" />

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-23T02:24:20.233

```
<add name="Name" connectionString="metadata=res://*; provider=System.Data.SqlClient; provider connection string='; data source=YOURIP;Initial Catalog=YOURDB;Persist Security Info=True;User ID=YOURUSER;Password=YOURPASSWORD; Connect Timeout=15;Encrypt=False;Packet Size=4096;MultipleActiveResultSets=True'" 
  providerName="System.Data.EntityClient"/>

Hope this Will help you!! 
```

# ruby - 用 Ruby 从网站调用文件

> ID：693503
> 
> 赞同：1
> 
> 时间：2009-03-28T20:47:48.370
> 
> 标签：ruby, file, web, external

我正在尝试从我的网站调用资源（例如图像）以避免不断更新。到目前为止，我已经尝试过使用这个：

```
 @sprite.bitmap = Bitmap.new("http://www.minscandboo.com/minscgame/001-Title01.jpg") 
```

但是，这只会给出“找不到文件错误”。实现这一目标的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T20:55:36.587

首先尝试使用[**Net::HTTP**](http://www.ruby-doc.org/stdlib/libdoc/net/http/rdoc/index.html)获取本地文件：

```
require 'net/http'

Net::HTTP.start("minscandboo.com") { |http|
  resp = http.get("/miscgame/001-Title01.jpg")
  open("local-game-image.jpg", "wb") { |file|
    file.write(resp.body)
   }
}

# ...

@sprite.bitmap = Bitmap.new("local-game-image.jpg") 
```

# c# - 无法通过 IIS 访问 aspx 页面

> ID：693523
> 
> 赞同：3
> 
> 时间：2009-03-28T21:03:25.943
> 
> 标签：c#, .net, asp.net, iis

我在 Windows XP Professional 上运行 IIS 5

我创建了新的 Web 项目并配置了 VS 2008 以将此应用程序保存到位置 c:\Inteput\wwwroot。因此 VS 将项目保存到目录中：

```
c:\Inteput\wwwroot\WebApplication1 
```

然后我将此 WebApplication1 文件夹转换为虚拟目录（此虚拟目录也配置为 Web 应用程序）。但是每当我尝试访问时：

```
c:\Inteput\wwwroot\WebApplication1\WebApplication1\default.aspx 
```

通过浏览器使用 URL：

```
http://localhost/WebApplication1/WebApplication1/default.aspx 
```

，我得到一个例外说：

> 配置错误描述：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。
> 
> 解析器错误消息：在应用程序级别之外使用注册为 allowDefinition='MachineToApplication' 的部分是错误的。此错误可能是由未在 IIS 中配置为应用程序的虚拟目录引起的。

任何想法我做错了什么？

顺便说一句 - 虚拟目录确实设置了*读取*和*运行脚本*权限

Q2 - 如何配置 Visual Studio 以通过 IIS 而不是通过集成的 Web 服务器运行 Web 应用程序？因此，当我按下 CTRL+F5 时，浏览器将通过 IIS 提供页面而不是通过集成 Web 服务器提供服务？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T21:08:54.013

您说它作为应用程序运行 - 是否使用正确的 ASP.NET 版本？(2.x)

在IIS中重新调试；您在项目属性上执行此操作 - 我相信在 Web 面板上；将其更改为“使用本地 IIS Web 服务器”并在 localhost 上输入应用程序根目录的 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T21:21:57.023

好吧，您遵循了一个奇怪的（错误的）过程，作为参考，创建一个小项目并直接从“新建项目”对话框指向一个（新的）虚拟目录。这为您提供了一个检查（IIS 5 有点旧）和一个可供比较的项目。

和/或创建一个虚拟目录并使用 Web Publishing 或 Web Copy 工具将项目部署到它。

从表面上看，您的 URL 中似乎有一个 WebApplication1 文件夹。这与错误有关，某些 web.config 设置只允许在应用程序根目录中。

补充：关于第二季度，当您设置 IIS 进行调试时，您还必须将输出目录配置为虚拟目录。这通常在 VS 创建项目期间完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T21:22:16.600

我认为这是你的问题，你`web.config`能提供你的吗？你有更多的那个吗？

我以前遇到过这样的错误，它与您所说的不太相符，但也许您遗漏了一些细节。

基本上，如果您有应用程序，则不应在子目录`MachineToApplication`中配置 's 中的设置。`web.config`尽管我认为其他事情可能会导致此错误出现。

哦，我敢打赌你确实有两个 web.configs

这里`c:\Inteput\wwwroot\WebApplication1\web.config`

和这里`c:\Inteput\wwwroot\WebApplication1\WebApplication1\web.config`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T22:01:30.190

1 - 现在可以使用了。我创建了新的虚拟目录

```
c:\Inteput\wwwroot\Testing 
```

并从

```
c:\Inteput\wwwroot\WebApplication1\WebApplication1 
```

进入这个新目录，因此现在*web.config*位于应用程序的根目录中。

一个）

> 某些 web.config 设置仅允许在应用程序根目录中使用。

那么我的*web.config*是只允许在应用程序根目录中使用的吗？我怎么能确定呢？

2 -

> 在IIS中重新调试；您在项目属性上执行此操作 - 我相信在 Web 面板上；将其更改为“使用本地 IIS Web 服务器”并在 localhost 上输入应用程序根目录的 url。

找到了，但现在我收到以下错误：

> 访问被拒绝。说明：访问处理此请求所需的资源时出错。您可能无权查看请求的资源。
> 
> 错误消息 401.3：您无权使用您提供的凭据查看此目录或页面（由于访问控制列表而拒绝访问）。请求 Web 服务器的管理员授予您对“C:\Documents and Settings\kaja\My Documents\Visual Studio 2008\Projects\WebApplication8\WebApplication8\Default.aspx”的访问权限。

谢谢

# objective-c - 为什么 Cocoa 应用程序使用这么多内存？

> ID：693525
> 
> 赞同：9
> 
> 时间：2009-03-28T21:04:11.857
> 
> 标签：objective-c, cocoa, memory

即使是在 Xcode 中创建新 Cocoa 项目时构建的标准空白窗口 Cocoa 应用程序也使用近 6 MB 内存。这是什么原因？是否可以减少应用程序的使用，或者 OS X 是否只是为 Cocoa 应用程序以不同的方式管理内存？

不是我在抱怨。我知道性能“不再重要”（编辑：我的意思是，它比可读性/可维护性/程序员的时间更重要）。我只是好奇。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-29T14:45:12.583

OS X 对共享内存和写时复制页面做了很多神奇的事情，因此每个应用程序可能不会占用那么多物理 RAM。

您可以通过运行以下命令准确检查内存块的映射方式：

```
sudo vmmap <PID of the process> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T01:42:09.130

取决于您使用的所有框架 (API)。将其与低级操作完成的 VM 分配相结合。

只值得尝试减少堆分配（总数）以及代码的驻留大小。确保您的数据结构得到有效分配，并尝试使用著名的“-Os”优化标志（大小优化）进行编译。对于 Cocoa 吃掉的 VM，您无能为力。我真的不会担心。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T17:38:47.817

对于一般开发人员来说，这显然是一个“WTF”时刻。问题通常是 - 为什么我的微不足道的应用程序会占用这么多内存。

答案取决于底层框架。您可能会说 6MB 太多了，但实际上，这不算什么。

如今，计算机配备 2GB 内存的情况并不少见。库存 IMAC 为 4GB。计算机行业的重点是用尽机器拥有的所有资源，以便它继续发展。

是的，您应该尽可能避免效率低下（例如，不要在启动时加载 500 万点数组）。但是，除非您的测试版证明您是捏造的，否则请将其保留在待办事项列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T21:15:14.043

我在这里有点手足无措，但我想这是因为所有添加的库都必须进行大量设置，并且不需要垃圾收集，所以它们只会浪费内存；另外，即使所有内存都被自动释放，它也会等到第一个空闲事件，即创建窗口之后。删除不需要的库/框架，或者在从笔尖加载窗口后强制在某处进行垃圾收集，如果您如此担心，看看它下降了多少。

我不关心它。一些内存可能会在以后返回，其余的就是你为强大的框架付出的代价。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T23:48:32.630

一个与可可没有直接关系但通常对框架有效的因素是开销不是线性的。就开销而言，使用该框架通常有一个固定的和可变的“价格”。

When you create a simple blank window, the fixed overhead is crushing, but when you create an application with tens of windows, dialogs, controls and all, the initial fixed overhead becomes negligible, against the size of the application itself.

# c# - 通过用户输入扩展枚举

> ID：693531
> 
> 赞同：1
> 
> 时间：2009-03-28T21:10:26.380
> 
> 标签：c#, .net, asp.net, enums

我有以下枚举，可用于我的一个过滤器并且非常适合我的对象模型

```
public enum ColorGroups
{
    White = 1,
    Brown = 2,
    Red = 3,
    Black = 4
} 
```

我关心的是将来当客户想要为收藏添加另一种颜色时，我如何扩展收藏。我希望系统是完全动态的，并且不需要技术人员来更改此类事情的代码..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T21:13:57.683

如果您希望数据是用户可编辑的，则可能不适合使用枚举。枚举是编译时单元，因此需要开发人员（或一些 hacky 代码生成）。

相反，请考虑为这些数据使用数据库表，预先填充您的项目（并且可能使用“系统”列来控制哪些是用户定义的，哪些是系统要求的）。然后更改只是向表中插入（等）。

当然，您可以使用任何其他存储机制 - 例如，配置文件中的分隔字符串 - 但我猜您会想要系统中某处的数据库？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T21:15:52.187

在这种情况下，枚举可能不是该工作的正确工具。最好使用一组配置选项。这些可能位于配置文件、注册表或数据库中，具体取决于您可用的内容以及您是否希望由开发人员或顾问或系统用户进行配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T21:16:12.200

> 我希望系统是完全动态的，并且不需要技术人员来更改此类事情的代码..

`enum`如果您不希望技术人员参与进行更改，“完全动态”和“使用”是相互排斥的。数据库或配置文件在这里是更好的选择。

# jquery - jQuery回调没有被调用

> ID：693539
> 
> 赞同：3
> 
> 时间：2009-03-28T21:16:55.943
> 
> 标签：jquery, ajax, post, callback

我正在使用`.post`jQuery 的 AJAX 方法：

```
// completion toggling
$('.item input').click(function() {
    $.post('complete.php', {item: this.id}, function() {
        $(this).parent().fadeOut('slow');
    });
}); 
```

我在这里做错了什么？AJAX 在记录更新时工作，但回调事件永远不会发生。Firebug 中也没有错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T21:19:34.597

我想知道在这一点上它是否不是一个不同的“这个”。尝试使用捕获：

```
$('.item input').click(function() {
    var tmp = this;
    $.post('complete.php', {item: this.id}, function() {
        $(tmp).parent().fadeOut('slow');
    });
}); 
```

# java - 记住对话框的大小

> ID：693541
> 
> 赞同：1
> 
> 时间：2009-03-28T21:18:42.100
> 
> 标签：java, swt

在我的应用程序中，我有一个主*shell*窗口和许多对话框（类`extends Dialog`）。我`setSize(width,height)`在初始化它们时使用，但我知道用户会根据自己的喜好不断调整它们的大小。

什么是在大小更改时收到通知以便我可以存储/加载它们的聪明方法？

（为什么不让工具包提供开箱即用的东西，比如 XUL？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T21:33:53.063

看看[java.util.prefs.Preferences](http://java.sun.com/javase/6/docs/api/java/util/prefs/Preferences.html)。宽度和高度设置可以通过 putInt() 保存并通过 getInt() 检索。

将 Dialog 或 JDialog 子类化并创建 SizeRememberingDialog 或（可能更好）创建 SizeRememberer(Dialog) 类以在构造时设置大小、侦听调整大小事件并在调整大小时保存新大小将是一项非常小的任务发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T21:37:33.413

大多数（如果不是全部）GUI 工具包都有一个调整大小事件，只要用户（或其他人）调整给定小部件的大小，就会触发该事件。一些阅读示例[移动和调整大小 - SWT](http://book.javanb.com/swt-the-standard-widget-toolkit/ch04lev1sec3.html)

# jquery - jQuery Toggle - 有什么方法可以知道正在应用哪个（隐藏或显示）？

> ID：693544
> 
> 赞同：11
> 
> 时间：2009-03-28T21:19:55.530
> 
> 标签：jquery

我在 Adob​​e AIR 中工作，我有一个 div 列表，在单击时显示隐藏 div 中每个列表项的扩展信息 - 如下所示：

```
$(this).click(function(){
 $(this).next('div.info').toggle();
}); 
```

这扩展了整个应用程序的高度，所以最终，如果用户要展开所有 div，边上会有一个滚动条。为了解决这个问题，我想调整窗口的高度（取决于增长或缩小）。我的所有代码都在工作，除了我不知道如何进入 .toggle 函数以找出将应用哪种效果（隐藏或显示）。将我的 if() 语句设置为 info div 的最终状态的键不起作用，因为它会在单击时立即评估 div。

有什么方法可以知道在 jQuery 中应用了哪个 .toggle 以便我可以使用该状态更改来应用我的其他更改？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-28T21:48:59.970

切换完成后，你可以知道哪个 div 被切换了：

```
var visible = $(this).next('div.info').toggle().is(":visible");
if(visible){
  alert("Hey! I've just showed up here!");
} 
```

这样你就会知道最近的切换操作是否显示了 div。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-28T21:27:34.590

您可以使用以下方法进行测试：

```
if ($(selector).is(':visible')) {
   // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-29T15:20:50.997

```
$('.class_name').click(function (event)
{
    triggerHideShow('#id_name'); // autodetect    
});

function triggerHideShow(id)
{
    if ($(id).is(':visible'))
    {
        $(id).hide();
    }
    else
    {
        $(id).show();
    }
} 
```

# html - 是否可以在 FORM 帖子/获取中添加锚点？

> ID：693545
> 
> 赞同：4
> 
> 时间：2009-03-28T21:20:18.650
> 
> 标签：html, forms, input, submit

我注意到在 Firefox 中，我可以将 #MyAnchor 标记添加到 action 属性中，例如...

```
<form action="#MyAnchor">
   <input type="text" name="a" />
   <input type="text" name="b" />
   <input type="submit" />
</form> 
```

提交表单后，锚点会自动显示在 URL 中，例如

mypage.aspx?a=1&b=2#MyAnchor

但是，这在 IE 上不起作用。无论如何我可以为这两种浏览器找到一个快乐的媒介吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T21:43:33.290

只是猜测，但您是否尝试过使用页面 + 锚名称。

```
<form action="mypage.aspx#MyAnchor"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T21:45:10.633

您可以在客户端或服务器端处理此问题：

在服务器端：添加一个以锚点为值的隐藏元素，并对服务器上构建的 URL 进行重定向。

在客户端：例如，jQuery 允许您将表单的参数序列化为 URL；您只需要附加锚点并将其分配给 window.location。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T22:11:53.050

我用它来保留跨回发的片段：

```
 var f = document.forms[0];
    var index = f.action.indexOf("#");
    if(index>0)
        f.action = f.action.substr(0,index) + "#" + tabId;
    else
        f.action += "#" + tabId; 
```

# java - 在 Java 中链接两个抽象工厂模式

> ID：693550
> 
> 赞同：4
> 
> 时间：2009-03-28T21:22:24.370
> 
> 标签：java, design-patterns, factory

我正在编写一个引用匹配程序，其中需要两个抽象工厂模式，这是两个接口；**QuoteFactory**和***ModeFactory***。ModeFactory 在***EasyMode***和***HardMode***之间切换，而 QuoteFactory 在几个不同的主题（即， **PoliticalQuotes**，**SportsQuotes**）之间挑选出报价。简而言之，用户将选择一种模式，如果选择 EasyMode，则用户必须猜测报价，而如果用户选择 HardMode，则告诉用户是谁说的，然后必须猜测，所以 Quotes 的实现将根据模式以及选择的报价而变化。

到目前为止，我已经创建了 ModeFactory 作为接口并将其实现为 EasyMode 和 HardMode，但现在我需要以某种方式将另一个抽象工厂模式（或更多）集成到这些模式中，以便可以选择引号。如果有帮助，我还创建了一个 Quote 类，其中定义了我的 Quotes。

谁能帮我想出这些抽象工厂的基本实现？这是我到目前为止的大纲，虽然我不禁觉得我以某种方式过于复杂了......

编辑：为了澄清我的意思：如果用户选择简单模式，那么他们会获得报价的开头和该报价的作者，而如果他们选择硬模式，则只会提供报价的开头。例如

**简单模式：** “我感受到了……的力量”何塞·穆里尼奥

**困难模式：** “我感受到了……的力量”

硬模式不会让作者让用户更难猜出报价的其余部分。另外，这不是学校作业。我一直在阅读 Head First Design Patterns，现在我正在尝试将我学到的知识应用到不同的情况中（而不是他们的 Pizza 示例，我正在研究一个 Quote Guessing Game，在阅读完 QI（英国电视节目） 书。

```
public interface ModeFactory {
    public Mode retrieveMode(String s); 
}

public interface QuoteFactory {
    public Quote retrieveQuote(String s);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T21:37:56.580

你能退后一步，重述你正在尝试做的事情吗？我有时会发现，通过努力向不熟悉挑战的人解释挑战，解决方案自然而然地出现在我面前。

从您的描述来看，您似乎是从部分解决方案开始（“我想使用抽象工厂模式”），而不是从您真正想做的事情开始（例如，“我想提供一个报价类来提供不同的报价取决于口味（政治、体育）和模式（简单、困难）") 。

对我来说，它就像一个枚举，而不是一个工厂。{political,sports} 有一个枚举，mode 有一个单独的枚举。

**编辑**：再次考虑这一点之后，也许这是一项学校作业（“使用抽象工厂模式来......等等等等等等”），这就是你从半解决方案开始的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T21:52:38.383

您可能在这里过度设计。你首先需要的是一个 Quote 类。这应该封装引用，并且应该为简单模式和困难模式提供适当的访问器（getter）。然后你需要一个报价集合。如果这些都保存在数据库中，您可以轻松选择报价的类型。

我也认为 ModeFactory 是不必要的。为什么您需要一个界面来在两种模式之间进行选择？状态标志更简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T21:54:20.550

在我看来，您似乎缺少一个重要概念，即 Question 类。这是由模式和报价构成的，可以给出正确的问题并打电话告诉你答案是否正确：

```
public class Question
{
    public Question(Mode mode, Quote quote) { /* store these */ }

    public String getQuestion()
    {
        return quote.getQuote() + (mode == Mode.EASY ? quote.getAuthor() : "");
    }

    public boolean isCorrect(String answer)
    {
        return quote.getFullQuote().equals(answer);
    }
} 
```

我的想法是报价本身在模式之间并没有真正改变，只是报价的哪些部分呈现给用户。使用这种方法，您可以拥有一个可供任何人在任何地方使用的 Quote 对象存储库。问题负责向用户显示适量的信息，并决定他们是否有正确的回应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-28T21:58:22.693

没有太多的思考，并试图保持你的设计，这样的事情怎么样（我假设 Quote 类有 getText() 和 getAuthor 方法，你也可能想让它 getText(int numberOfWords) 所以你可以配置如何很多报价给）：

```
public enum Mode 
{
    EASY,
    HARD,
}

public enum Category 
{
    SPORTS,
    POLITICS,
}

public abstract class QuoteFactory 
{
    public QuoteFactory getQuoteFactory(final Mode mode)
    {
        // return either the Hard or Easy QuoteFactory
    }

    public abstract Quoute getQuote(Category category)
}

class HardQuoteFactory
    extends QuoteFactory
{
    public Quote getQuote(final Category category)  
    {
         // ...
    }
}

class EasyQuoteFactory
    extends QuoteFactory
{
    public Quote getQuote(final Category category)  
    {
         // ...
    }
} 
```

# c# - 下载速率限制 C#

> ID：693551
> 
> 赞同：3
> 
> 时间：2009-03-28T21:22:25.743
> 
> 标签：c#

我想从 ac# 应用程序下载一个文件，但是，我希望能够限制我使用的网络带宽，从客户端如何限制下载速度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T21:32:11.960

[位](http://msdn.microsoft.com/en-us/magazine/cc188766.aspx)

（更多[在这里](http://sharpbits.codeplex.com/)）

# django - Django - 无法检索上传的图像

> ID：693560
> 
> 赞同：0
> 
> 时间：2009-03-28T21:30:46.877
> 
> 标签：django, image, file

我正在探索 Django 中的文件/图像上传。我有一个带有拇指 ImageField 的 Photo 类模型。我用管理面板上传了拇指，并制作了只提供`<img src='{{photo.thumb.url}}' />`. 不幸的是，我没有得到任何图像，当我尝试获取直接链接时，它显示“找不到页面”。似乎 django 要么没有将它们移动到 media_url ，要么没有权限访问它？我想知道我能做些什么来解决它。

预先非常感谢。

PS：使用 sqlite db 在开发服务器上运行 django。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T22:20:41.563

默认情况下，开发服务器不提供静态文件（请参阅[文档](http://docs.djangoproject.com/en/dev/howto/static-files/?from=olddocs)）。您需要将以下代码添加到底部`urls.py`以启用静态文件服务：

```
from django.conf import settings

if settings.DEBUG:
    urlpatterns += patterns('',
        (r'%s(?P<path>.*)' % settings.MEDIA_URL[1:], 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),
    ) 
```

那应该让你解决。

# c# - LINQ InsertOnSubmit 丢失格式

> ID：693568
> 
> 赞同：0
> 
> 时间：2009-03-28T21:36:19.873
> 
> 标签：c#, .net, linq-to-sql

我有一个带有文本类型的可为空字段的表。当我运行 InsertOnSubmit() 时，它插入成功，但所有格式都丢失了。具体来说，我正在存储错误的堆栈跟踪。每个条目都已格式化为自己的行，看起来不错，但是当我从 SQL 中检索它时，它会丢失所有的 crlf4。

我有其他似乎保留其格式的文本字段，但它们是使用旧 ADO.NET 插入的。如何补救？

代码：

```
string[] stacktrace = Environment.StackTrace.Replace("\r", "").Replace("\n", "").Replace("  at", "\n").Split('\n');
string stack = "";

for (int i = 0; i < stacktrace.Length; i++)
    stack += stacktrace[i].Trim() + "\r\n";

Error err = new Error();
err.Severity = (byte)sev;
err.Product = (byte)prod;
err.Location = stacktrace[0];
err.Title = message;
err.datetime = DateTime.Now;
err.StackTrace = stack;

dc.Errors.InsertOnSubmit(err);
dc.SubmitChanges(); 
```

请注意，如果我调试应用程序，err.StackTrace 和堆栈在 SubmitChanges() 之前和之后看起来都是正确的。

错误定义：

```
[Column(Storage="_ID", AutoSync=AutoSync.OnInsert, DbType="Int NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)]
public int ID // ...
[Column(Storage="_AID", DbType="Int")]
public System.Nullable<int> AID // ...
[Column(Storage="_Severity", DbType="TinyInt NOT NULL")]
public byte Severity
[Column(Storage="_Product", DbType="TinyInt NOT NULL")]
public byte Product
[Column(Storage="_Location", DbType="VarChar(255) NOT NULL", CanBeNull=false)]
public string Location
[Column(Storage="_Title", DbType="VarChar(255) NOT NULL", CanBeNull=false)]
public string Title
[Column(Storage="_Ex", DbType="Text", UpdateCheck=UpdateCheck.Never)]
public string Ex
[Column(Storage="_Notes", DbType="Text", UpdateCheck=UpdateCheck.Never)]
public string Notes
[Column(Storage="_datetime", DbType="DateTime NOT NULL")]
public System.DateTime datetime
[Column(Storage="_InnerException", DbType="Text", UpdateCheck=UpdateCheck.Never)]
public string InnerException
[Column(Storage="_StackTrace", DbType="Text", UpdateCheck=UpdateCheck.Never)]
public string StackTrace

[Association(Name="Activity_Error", Storage="_Activity", ThisKey="AID", IsForeignKey=true)]
public Activity Activity 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T22:16:47.623

你确定你用来查看错误的任何东西都没有去掉空格吗？例如，任何 Web 浏览器都会忽略 \r\n。

您没有显示错误的定义是什么，因此很难看到发生了什么。

编辑：

在我看来，问题在于您之后如何查看数据。您如何确定格式错误？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T23:10:35.857

您是否真的尝试使用 Studio Manager 查看您的 SQL 数据库并查看数据库中实际存储的内容。通过查看那里的数据，您知道存储数据或检索数据是否存在问题。

我认为问题在于数据的检索。

# ruby-on-rails - Rails 迁移

> ID：693577
> 
> 赞同：0
> 
> 时间：2009-03-28T21:42:32.590
> 
> 标签：ruby-on-rails, ruby, activerecord, migration

我的迁移如下：

```
class CreateUsers < ActiveRecord::Migration
  def self.up
    create_table :users do |t|
      t.string :email
      t.string :password
      t.string :name
      t.boolean :male
      t.boolean :admin

      t.timestamps
    end
  end

  def self.down
    drop_table :users
  end
end 
```

当我转到脚本/控制台并键入“用户”时，Rails 无法识别该类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T22:30:04.973

你跑了吗`script/generate model User ...`？`script/generate migration CreateUser...`

如果您不生成模型，它在控制台中将不可用，因为 Rails 不知道它存在。

Rails also does not create a `modelname_id` field, it simply creates an `id` field which autoincrements.

I hope this helps.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T22:12:52.347

1) 迁移将创建一个自动递增的“id”列。（除非指定，否则我从未见过迁移创建 class_id 列）。

2) 你需要在 app/model/user.rb 文件中声明这个类

```
class User < ActiveRecord::Base
  #class methods go here
end 
```

更重要的是我想推荐[restful_authentication](http://github.com/technoweenie/restful-authentication/tree/master)插件。它是用户身份验证的社区标准（意味着它经过实战测试、定期更新并符合大多数用例）。

# asp.net - 具有多种父母类型的评论表

> ID：693581
> 
> 赞同：1
> 
> 时间：2009-03-28T21:44:04.613
> 
> 标签：asp.net, sql-server, foreign-keys, primary-key

我的网站 (ASP.NET/C#/MS-SQL 2005) 有多个允许评论的部分（用户配置文件、图像页面、视频等）。我想将所有内容存储在一个评论表中。

我的问题是将评论链接回其父级。用户配置文件的主键是唯一标识符，而图像和视频使用整数。我想有一个从评论到其父级的外键关系。

什么被认为是最好的做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T21:46:49.867

这里有关于最佳实践的争论。我的意见是对所有事情都使用代理 ID。甚至将其用于用户配置文件，无论您是否需要。然后，您只需处理一种“模式”即可连接相关实体。如果需要，这使您可以自动化许多样板代码。即使你*不*自动化样板，它也会更简单，更不容易出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T21:47:13.030

我会使用连接表，每个允许评论的部分一个。然后，您可以为评论表使用您想要的任何键，而您的连接表只需要从您的部分表和评论表中获取标识符。

```
 user_profiles
  id uniqueidentifier
  ...

  comments
  id int
  ...

  user_profile_comments
  profile_id uniqueidentifier
  comment_id int 
```

# php - 用php替换文件中的字符串

> ID：693584
> 
> 赞同：4
> 
> 时间：2009-03-28T21:45:27.513
> 
> 标签：php, parsing

我正在为我的网络应用程序编写一个电子邮件模块，该模块在完成诸如注册之类的任务时向用户发送一封 html 电子邮件。现在，由于这封电子邮件的格式可能会发生变化，我决定创建一个模板 html 页面作为电子邮件，其中包含需要替换的自定义标签，例如 %fullname%。

我的函数有一个数组格式为 array(%fullname% => 'Joe Bloggs'); 将键作为标签标识符，并使用需要替换它的值。

我尝试了以下方法：

```
 $fp = @fopen('email.html', 'r');

    if($fp)
    {
      while(!feof($fp)){

      $line = fgets($fp);                 

      foreach($data as $value){

          echo $value;
          $repstr = str_replace(key($data), $value, $line);           

      }

      $content .= $repstr;

      }
      fclose($fp);
    } 
```

这是最好的方法吗？因为目前只有 1 个标签被替换......我是在正确的道路上还是在数英里之外？

谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T21:54:13.327

我认为问题出在你的 foreach 上。这应该解决它：

```
foreach($data as $key => $value){
    $repstr = str_replace($key, $value, $line);               
} 
```

或者，我认为这应该更有效：

```
$file = @file_get_contents("email.html");
if($file) {
    $file = str_replace(array_keys($data), array_values($data), $file);
    print $file;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-28T05:41:24.293

```
//read the entire string
$str=implode("\n",file('somefile.txt'));

$fp=fopen('somefile.txt','w');
//replace something in the file string - this is a VERY simple example
$str=str_replace('Yankees','Cardinals',$str);

//now, TOTALLY rewrite the file
fwrite($fp,$str,strlen($str)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T21:50:55.003

看起来它应该可以工作，但我会使用“file_get_contents()”并在一次大爆炸中完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T21:51:59.540

一种稍微不同的方法是使用 PHP 的 heredocs 与字符串插值相结合，即：

```
$email = <<<EOD
<HTML><BODY>
Hi $fullname,
  You have just signed up.
</BODY></HTML>
EOD; 
```

这避免了一个单独的文件，并且应该使以后的简单替换之外的事情更容易。

# c# - 如何将 C# 类库项目转换为 Silverlight 项目？

> ID：693585
> 
> 赞同：6
> 
> 时间：2009-03-28T21:45:49.430
> 
> 标签：c#, visual-studio, silverlight

我不小心为很多 dll 创建了一个 C# 类库而不是 Silverlight 类库。是否可以轻松修改项目文件以进行转换而不是创建新文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T21:50:59.573

完成此操作后，IMO 最简单的事情就是重新开始。复制几个 .cs 文件并添加一些引用等并不需要很长时间。如果你*真的*想要你可以在 csproj 上进行比较；明显的变化是`<ProjectTypeGuids>`, `<SilverlightApplication>`, `<ValidateXaml>`,`<ProductVersion>`和`<ProjectExtensions>`... 可能还有很多参考资料... 嗯 - 是的，重新开始；会更安全！

如果您需要支持多个框架，您可以作弊（以避免维护 2 个以上的项目文件）——我在 protobuf-net 中这样做——包括：

```
<Compile Include="..\protobuf-net\**\*.cs" /> 
```

上面写着“编译 ..\protobuf-net 路径下任何级别的所有 .cs 文件”。

# xml - xslt 的优雅示例？

> ID：693596
> 
> 赞同：4
> 
> 时间：2009-03-28T21:52:16.170
> 
> 标签：xml, xslt, graph-theory, declarative

在通过 XAML 进行了长时间的学习循环之后，我回到了 HTML 和 javascript，并意识到声明性代码的概念——就转换规则而言——是一个非常强大的概念。

尽管语法过多，XML 的 XSLT 处理是声明式转换编程的基石。然而，我总是发现很难理解 XSLT 将如何用于日常任务（使用 XML）。

除了生成 HTML 之外，还有哪些 XSLT 优雅地解决编程问题的好例子？

我猜它擅长图形转换和数据再处理......

编辑：我希望有一些实际的例子——让我完全不了解 xslt 的一件事是代码的视觉复杂性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-29T01:41:44.573

**人们经常可以找到漂亮的 XSLT 代码示例，尤其是当 XSLT 用作一种函数式编程语言时**。

有关示例，请参阅[**这篇**](http://www.idealliance.org/papers/extreme/proceedings/xslfo-pdf/2006/Novatchev01/EML2006Novatchev01.pdf)关于FXSL 2.0 的文章[**——XSLT 2.0**](http://fxsl.sf.net)的函数式编程库。

作为一种 FP 语言，XSLT 也是一种*[**声明性语言**](http://en.wikipedia.org/wiki/Declarative_programming)*。除其他外，这意味着一个人声明，指定现有关系。

这样**的定义通常不需要任何额外的代码来产生结果——它本身就是它自己的实现，或者一个可执行的定义或可执行的规范**。

**这是一个小例子**。

**这个 XPath 2.0 表达式定义**了“*自然数的**最大[素因子](http://en.wikipedia.org/wiki/Prime_factor)*”：

```
if(f:isPrime($pNum))
  then $pNum
  else
    for $vEnd in xs:integer(floor(f:sqrt($pNum, 0.1E0))),
        $vDiv1 in (2 to $vEnd)[$pNum mod . = 0][1],
        $vDiv2 in $pNum idiv $vDiv1
      return
        max((f:maxPrimeFactor($vDiv1),f:maxPrimeFactor($vDiv2))) 
```

**用英语发音**，一个数的最大素因数**`pNum`**就是这个数本身，如果 **`pNum`** 是素数，否则如果 **`vDiv1`**和**`vDiv2`**是 的两个因数**`pNum`**，那么 的最大素因数是和的最大素因数中**`pNum`**较大的一个。**`vDiv1`****`vDiv2`**

**我们如何使用它来实际计算**XSLT 中的最大素因子？**我们简单地将上面的定义包装**在一个`<xsl:function>`和......得到结果！

```
 <xsl:function name="f:maxPrimeFactor" as="xs:integer">
  <xsl:param name="pNum" as="xs:integer"/>

  <xsl:sequence select=
   "if(f:isPrime($pNum))
      then $pNum
      else
        for $vEnd in xs:integer(floor(f:sqrt($pNum, 0.1E0))),
            $vDiv1 in (2 to $vEnd)[$pNum mod . = 0][1],
            $vDiv2 in $pNum idiv $vDiv1
          return
            max((f:maxPrimeFactor($vDiv1),f:maxPrimeFactor($vDiv2)))
   "/>
 </xsl:function> 
```

**然后，我们可以[计算任何自然数的 MPF](https://stackoverflow.com/questions/439814#445858)**，例如：

`f:maxPrimeFactor(600851475143)`= 6857

至于效率，嗯，**这个转换只需要 0.109 秒**。

**其他优雅高效的 XSLT 代码示例**：

*   [**Tim Bray**](http://www.tbray.org/ongoing/)的[**Wide Finder**](http://www.tbray.org/ongoing/When/200x/2007/09/20/Wide-Finder)，在[**这里**](http://dnovatchev.spaces.live.com/Blog/cns!44B0A32C2CCF7488!385.entry)解决。
*   [**级联**](http://dnovatchev.spaces.live.com/blog/cns!44B0A32C2CCF7488!341.entry) [**删除**](http://dnovatchev.spaces.live.com/blog/cns!44B0A32C2CCF7488!342.entry)
*   [**传递闭包**](http://dnovatchev.spaces.live.com/blog/cns!44B0A32C2CCF7488!384.entry)
*   [**查找**](http://dnovatchev.spaces.live.com/blog/cns!44B0A32C2CCF7488!357.entry)单词的
*   [**文本语料库的一致性**](http://fxsl.cvs.sourceforge.net/fxsl/fxsl-xslt2/Tests/testConcordance.xsl?revision=1.1&view=markup)（旧约）
*   [**拼写检查**](http://fxsl.cvs.sourceforge.net/fxsl/fxsl-xslt2/Tests/testFunc-spell.xsl?revision=1.2&view=markup)（莎士比亚的奥赛罗）
*   [**数独求解器**](http://ajwelch.blogspot.com/2006/03/dimitres-tuned-sudoku-solution.html)
*   一个通用的编译器-编译器系统[**——FXSL的LR-Parsing Framework**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/func-lrParse.xsl?revision=1.7&view=markup)，成功地用于[**JSON**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/func-json-document.xsl?revision=1.11&view=markup)和XPath2.0的解析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T21:55:08.207

代码生成怎么样？我在 protobuf-net 中使用它从 .proto 模型（导出为 xml）创建 .cs 文件 -[就像这样](http://code.google.com/p/protobuf-net/source/browse/trunk/ProtoGen/csharp.xslt)。在 .NET 4.0 中，T4 模板将是更明显的选择，但在此之前 T4 引擎不是独立的 (AFAIK)。

Xslt 还广泛用于在不同的 xml 布局之间进行转换 - 例如，在 biztalk 等中间件工具中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T22:09:53.803

前几天我使用了 XSLT。我需要提供一种方法让用户将树控件的内容保存到文件中，以便他们可以通过电子邮件将其发送给他们的老板，将其展示给他们的孙子等等。

要求他们能够将其保存为具有漂亮整洁外观的 HTML 文件，或者保存为 XML，以便他们可以根据需要进一步处理它。

所以我建议我们输出带有链接的 XSLT 的 XML，这样他们就有了原始的 XML，但是当他们在浏览器中打开它时看起来不错。

这并不理想（如果他们在没有 XSL 的情况下将 HTML 移动到其他地方，IE 将完全拒绝显示它！）但是如果我们改变计划，我可以修改产品以便让用户选择格式，如果他们选择HTML，我所要做的就是在保存之前在 XML 上运行 XSLT 以获取 HTML。

理想情况下，有一种方法可以制作一个包含 XML 和 XSLT 的自包含 HTML 文件，但我不知道......这本身就是一个问题。

# java - Java中的String concat和+运算符之间有区别吗？

> ID：693597
> 
> 赞同：20
> 
> 时间：2009-03-28T21:52:29.260
> 
> 标签：java, string

### 复制

> [java字符串连接](https://stackoverflow.com/questions/47605/java-string-concatenation)

我很好奇这两者有什么区别。

我理解字符串池的方式是这样的：

这会在字符串池中创建 3 个字符串对象，其中 2 个所有引用都丢失了。

```
String mystr = "str";
mystr += "end"; 
```

这不是也在字符串池中创建3个对象吗？

```
String mystr = "str";
mystr = mystr.concat("end") 
```

我知道当需要进行大量连接时，StringBuilder 和 StringBuffer 在内存使用方面的效率要高得多。我只是好奇 + 运算符和 concat 在内存使用方面是否有任何区别。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-28T22:04:01.663

在这种特殊情况下没有区别。**但是，它们通常不一样。**

`str1 += str2`相当于执行以下操作：

```
str1 = new StringBuilder().append(str1).append(str2).toString(); 
```

为了向自己证明这一点，只需创建一个简单的方法，它接受两个字符串，`+=`第一个字符串到第二个字符串，然后检查反汇编的字节码。

相比之下，只需创建一个由and`str1.concat(str2)`连接的新字符串，这对于少量连接字符串的成本较低（但会输给数量较多的第一种方法）。`str1``str2`

此外，如果`str1`为 null，请注意会`str1.concat(str2)`引发 NPE，但`str1 += str2`会简单地将`str1`其视为 null 而不会引发异常。（也就是说，它产生与 的值连接的“null” `str2`。如果`str2`是，比如说，“foo”，你最终会得到“nullfoo”。）

* * *

**更新：**查看**[这个 StackOverflow 问题](https://stackoverflow.com/questions/47605/java-string-concatenation)**，几乎相同。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-29T01:35:42.450

`+=`和之间的重要区别`concat()`不是性能，而是语义。 `concat()`将只接受一个字符串参数，但`+`（或`+=`）将接受*任何东西*。如果非字符串操作数是对象，则通过调用将其转换为字符串`toString()`；一个原语将被转换，就好像通过调用相关包装类中的适当方法一样，例如，`Integer.toString(theInt)`; 并且一个空引用变成了字符串`"null"`。

其实，我也不知道为什么`concat()`会存在。人们在 API 文档中看到它并认为它存在是有充分理由的——性能是最明显的原因。但这是一条红鲱鱼；如果性能确实是一个问题，您应该使用 StringBuilder，正如 John 链接到的线程中所讨论的那样。否则，`+`或者`+=`更方便。

编辑：至于“在字符串池中创建对象”的问题，我认为您误解了字符串池是什么。在运行时，实际的字符序列，“str”和“end”将存储在一个专用的数据结构中，无论你在哪里看到文字`"str"`和`"end"`源代码，字节码都会真正包含对相应条目的引用数据结构。

事实上，字符串池是在加载类时填充的，而不是在运行包含字符串文字的代码时填充的。这意味着您的每个片段只创建一个对象：连接的结果。（还有一些幕后的对象创建，每种技术略有不同，但性能影响不值得担心。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T21:58:41.380

除非 concat 的参数是空字符串，否则

```
String mystr = "str";
mystr = mystr.concat("end") 
```

还将创建 3 个字符串。

更多信息：[https](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html) ://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T00:17:09.770

> 我理解字符串池的方式是这样的：

你似乎对这个词有误解。没有“字符串池”之类的东西 - 你使用它的方式，看起来你只是指堆上的所有 String 对象。有一个运行时常*量*[池](http://java.sun.com/docs/books/jvms/second_edition/html/ConstantPool.doc.html#73272)，其中包含许多其他内容，编译时字符串常量和从返回的字符串实例`String.intern()`

# asp.net - 模拟共享主机信任级别

> ID：693611
> 
> 赞同：7
> 
> 时间：2009-03-28T22:01:09.207
> 
> 标签：asp.net, permissions, shared-hosting, medium-trust

我想在我的开发机器上模拟共享托管环境的信任级别，这样当我开始部署我的解决方案时就不会出现令人讨厌的意外。

我在 web.config 中添加了这个设置：

```
<trust level="Medium" originUrl="*"/> 
```

唯一的问题是当我尝试保存到我的数据库时遇到此异常：

> InnerException: System.Security.SecurityException Message="请求'System.Net.SocketPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'类型的权限失败。" 来源="mscorlib"

我如何在保持中等“喜欢”信任的同时特别允许这样做。还有其他我可以合理允许的事情吗？我将托管在 GoDaddy 上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T17:35:47.690

我联系了 Godaddy，得到了这样的回复：

> GoDaddy.com ASP.NET 共享托管服务器**使用默认的中等信任级别，并添加了 OleDbPermission、OdbcPermission 和限制较少的 WebPermission**。
> 
> 在中等信任级别下运行的应用程序**无法访问注册表，无法访问 Windows 事件日志，也无法使用反射**。此类应用程序只能与定义的网络地址范围进行通信，并且文件系统访问仅限于应用程序的虚拟目录层次结构。如果您遇到任何问题，请确保您的应用程序可以在中等信任环境中运行。

因此，人们可以使用它来指示共享托管权限通常是什么样的。

当我弄清楚如何按照@blowdards 链接中所述创建这些权限时，我会发布它们。或者，如果有人可以发布一个很棒的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T14:48:34.497

因此，您拥有的是默认的中等信任，并且您看到的错误是正确的。

当然，服务器管理员可以根据自己的喜好进行调整，您只需要准确了解他们对默认信任策略所做的更改即可。[您可以按照MSDN](http://msdn.microsoft.com/en-us/library/ms998341.aspx#paght000020_step3)中列出的步骤创建自定义信任级别。现在你需要做的就是找出 Godaddy 对他们做了什么:)

# iphone - iPhone 上的 OpenGLES 初学者指南

> ID：693613
> 
> 赞同：19
> 
> 时间：2009-03-28T22:02:28.987
> 
> 标签：iphone, objective-c, opengl-es

有谁知道在 iPhone 上使用 OpenGLES 的良好初学者指南？我找到了一些，但它们都需要我没有的假设知识。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-10-08T17:46:47.573

Simon Maurice 有一些关于第一步的很棒的教程。看一看：[http://www.cocoachina.com/wiki/index.php?title=Category%3aSimon_Maurice_iPhone_OpenGL_ES](http://www.cocoachina.com/wiki/index.php?title=Category%3aSimon_Maurice_iPhone_OpenGL_ES)。从一开始就做这些，你会对基础知识有很好的了解。

**编辑：**
[备份链接](http://web.me.com/smaurice/iPhone_OpenGL_ES_Blog/iPhone_OpenGL/Archive.html)
[源代码](https://github.com/mauriceatron/iPhone-OpenGL-ES-Tutorial-Series)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-28T23:49:28.323

您只需要一份参考资料：

*   [http://www.khronos.org/opengles/sdk/1.1/docs/man/](http://www.khronos.org/opengles/sdk/1.1/docs/man/)

是的，有些文档在您第一次阅读时并没有多大意义，但实际上，一遍又一遍地阅读句子/段落/页面。这确实有道理，而且非常准确。这是你真的不能从教程中说出来的东西。教程几乎总是由那些似乎不太在意遗漏重要细节的人编写，而像这样的文档通常是由非常挑剔的人编写的，他们将每一个重要的小事实都塞进（可能过于复杂）的句子中。

哦，还有一个黄金提示：在您的浏览器中添加一个搜索功能：

```
http://www.google.com/search?q=%s+site%3Awww.khronos.org%2Fopengles%2Fsdk%2F1.1%2Fdocs%2Fman%2F&btnI 
```

（替换`%s`为您浏览器的搜索词替换字符串，上面的示例适用于 Opera）

我已经将它绑定到`o`前缀，所以每当我需要在 OpenGL/ES 上查找某些内容时，我只需`o glDrawElements`在地址栏中键入并立即获取其上的文档页面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-29T19:57:14.003

再一次，如果我可以插入自己的工作，我会写一篇[简短](http://www.sunsetlakesoftware.com/2008/08/05/lessons-molecules-opengl-es)的文章，记录我在为 iPhone编写[Molecules](http://www.sunsetlakesoftware.com/molecules)时学到的东西。我在 OpenGL 的 3-D 方面没有经验（我之前做过一点 2-D 硬件加速），所以我对这个主题有一点不同的看法。Molecules的[源代码](http://www.sunsetlakesoftware.com/2008/10/02/molecules-source-code-now-available)是可用的，因此您可以通过在其中四处寻找一些东西来学习。我还[写了一篇](http://www.sunsetlakesoftware.com/2009/01/13/opengl-es-catransform3d)关于如何使用 Core Animation 结构和函数来加速 OpenGL ES 渲染的文章，如果你想要一些更技术的东西的话。

[Bill Dudney在这里](http://bill.dudney.net/roller/objc/entry/wavefront_obj_files_and_learning)有一篇关于他如何开始进入 OpenGL ES 的帖子，然后在[这里](http://bill.dudney.net/roller/objc/entry/wave_front_obj_textures_working)他提供了用于 iPhone 的 Wavefront OBJ 加载程序的代码。

我相信我已经在各种答案中看到了更多关于 Stack Overflow 的好资源，因此您可以四处搜索，看看您还能在这里找到什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T22:04:41.133

对于 OpenGL [NeHe](http://nehe.gamedev.net/)是一个很棒的教程。虽然，它并没有专门涵盖 OpenGLES，但它仍然应该很有帮助。只是准备好不时地遇到在 iphone 上不起作用的东西。

如果“红皮书”[在线](http://www.glprogramming.com/red/)，您也可以获得 v1.1 。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-05-19T20:55:31.200

西蒙莫里斯的教程可以在[这里找到](http://www.cocoachina.com/wiki/index.php?title=Category:Simon_Maurice_iPhone_OpenGL_ES)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-17T11:13:45.947

《红皮书》不推荐给 OpenGL/OpenGLES 初学者。这是专业人士的书。第一步是尝试运行从 OpenGL 网站下载的简单程序或简单代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-28T03:21:27.543

这是西蒙莫里斯教程的一个很好的（非中文）链接： [http ://web.me.com/smaurice/iPhone_OpenGL_ES_Blog/iPhone_OpenGL/Archive.html](http://web.me.com/smaurice/iPhone_OpenGL_ES_Blog/iPhone_OpenGL/Archive.html)

他的教程很棒。它们是我用来学习 OpenGL ES 的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-30T20:18:24.027

除了“红皮书”之外，另一本有用的书——带有教程和参考——是[OpenGL SuperBible](https://rads.stackoverflow.com/amzn/click/com/0321498828)。

再次不是 OpenGLES 特定的，但我相信学习 OpenGL 的一般特性很有用，然后过滤掉你不需要的特性。

# shared-ptr - ATL CAutoPtr 和 STL std::auto_ptr 之间的区别？

> ID：693614
> 
> 赞同：1
> 
> 时间：2009-03-28T22:02:31.030
> 
> 标签：shared-ptr, auto-ptr, cautoptr

我正在 MFC 中编写一些代码，我想使用自动指针。我遇到了两个不同的类，它们看起来做同样的事情：人们对这两种不同的实现有什么想法`CAutoPtr`？`std::auto_ptr`

此外，我知道有`std::tr1::shared_ptr`. `shared_ptr`ATL/MFC 中有类似的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T22:18:36.513

两者`CAutoPtr`并`auto_ptr`为您提供智能指针语义，包括所有权语义的转移。`CAutoPtr`是一个 ATL 类——使用 COM 构建。它是特定操作系统的非标准扩展。`auto_ptr`另一方面是标准C++。如果要使用此类对象的容器，则必须使用`CAutoPtrArray`或`CAutoPtrList`。

需要注意的重要一点是，有一个叫做的东西`auto_ptr_ref`允许您将`auto_ptr`s 作为返回值返回。没有这样的事情`CAutoPtr`。

`auto_ptr`在 C++0x 中已弃用。必要时使用`unique_ptr`：您可以在移动感知容器中使用它们，并且还可以从不安全的 l 值隐式移动中获得一些安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T22:44:37.153

在 ATL/MFC 中最接近 shared_ptr 的是 CComPtr。它旨在用于 COM 对象，但它可以用于任何包含 AddRef/Release 引用计数方法的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T22:24:51.367

CAutoPtr 是 ATL 特定的。

std:auto_ptr 和 CAutoPtr 都不提供引用计数。看起来两者具有相同的功能。[链接文本](https://stackoverflow.com/questions/139622/does-the-cautoptr-class-implement-reference-counting)

我猜 ATL/MFC 中没有 shared_ptr 。shared_ptr 在 boost 库中实现。

# javascript - dojox.charting 和 xDomain 对 dojo/dojox 库的引用的问题

> ID：693621
> 
> 赞同：0
> 
> 时间：2009-03-28T22:09:09.907
> 
> 标签：javascript, dojo

我有一个网页 HTML 页面，其中包含一些基于 dojox.charting 的客户端 JS 代码。我的本地网站中没有 dojo 库（实际上没有 Web 服务器）。我将 dojos 的 xDomain 参考功能与 src 一起用于 google 的托管站点，如下所示：

```
<head>
...
<script type="text/javascript"
    djConfig1="isDebug:true"        
    src="http://ajax.googleapis.com/ajax/libs/dojo/1.2.0/dojo/dojo.xd.js">
</script>
<script type="text/javascript"
  dojo.require("dojox.gfx");
    dojo.require("dojox.gfx.move");
    dojo.require("dojo.html");

    dojo.require("dojox.charting.Chart2D");
    dojo.require("dojox.charting.themes.PlotKit.green");

    dojo.require("dojox.charting.action2d.Highlight");
    dojo.require("dojox.charting.action2d.Magnify");
    dojo.require("dojox.charting.action2d.MoveSlice");
    dojo.require("dojox.charting.action2d.Shake");
    dojo.require("dojox.charting.action2d.Tooltip");
    dojo.require("dojox.charting.themes.MiamiNice");

    dojo.require("dojox.charting.widget.Legend");
</script>
....
</head> 
```

这是创建曲线图的功能，基于[Dojo 中的代码：Now With Drawing Tools](http://dojotdg.zaffra.com/2009/03/dojo-now-with-drawing-tools-linux-journal-reprint/)。

```
function drawCurve(nodeChart, nodeLegend) {
  var chart1 = new dc.Chart2D(nodeChart)
    .setTheme(dc.themes.PlotKit.green)
    .addPlot("default", {
      type: "Default",
      lines: true,
      markers: true,
      tension: 2
    })
   .addAxis("x", {
      min: 0,
      max: 6,
      majorTick: { stroke: "black", length: 3 },
      minorTick: { stroke: "gray", length: 3 }
    })
    .addAxis("y", {
      vertical: true,
      min: 0,
      max: 10,
      fixLower: "major", 
      fixUpper: "major",
      majorTick: { stroke: "black", length: 3 },
      minorTick: { stroke: "gray", length: 3 }
    })
    .addSeries("Series A", [
      { x: 0.5, y: 5 },
      { x: 1.5, y: 1.5 },
      { x: 2, y: 9 },
      { x: 5, y: 0.3 }
    ])
   .addSeries("Series B", [
      { x: 0.3, y: 8 },
      { x: 4, y: 6, tooltip: "Custom tooltip"},
      { x: 5.5, y: 2 }
    ]);
  var series = chart1.series;

  var anim_a = new dc.action2d.Tooltip(chart1, "default");
  var anim_c = new dc.action2d.Magnify(chart1, "default"); // not working
  chart1.render();

  var legendChart = new dc.widget.Legend(
    {chart: chart1, horizontal: false}, nodeLegend.id);
} 
```

我的第一个问题是，对于曲线图，y 轴上的数字只显示 0 和 10。中间的数字 1 到 9 都没有显示。从 1 到 6 的 x 轴值是可见的。文章中的原始图表快照也显示了 y 轴值，但[DojoToolKit Demos](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/charting/tests/test_event2d.html)上的快照确实显示了沿 y 轴的值。我不确定我在代码中遗漏了什么。如何启用显示 y 轴值？

下一个问题是关于 Magnify()。DojoToolKit 演示站点的曲线图工作正常，但我的图表的放大功能不起作用。我认为这可能是由 xDomain 引用引起的。我可能需要从 xDomain 的 dojox 库中指定一些指定的 js 文件。我不确定我必须指定哪一个。

我注意到的一件事是，我的 FireBug 在绘制曲线图后显示以下错误：

```
_4.fx.combine is not a function http://ajax.googleapis.com/ajax/libs/dojo/1.2.0/dojox/charting/action2d/Magnify.xd.js Line 8
_11.action is undefined http://ajax.googleapis.com/ajax/libs/dojo/1.2.0/dojox/charting/action2d/Magnify.xd.js Line 8 
```

我认为那些未定义的错误可能表明我错过了在我的 head 部分加载一些 dojox 库文件。

顺便说一句，我没有网络服务器，我更喜欢使用 dojo 的 xDomain 参考选项。这样，我可以在任何地方编辑一个html文件，然后发送给其他人。无需下载和安装 dojo 源库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T03:58:58.113

我想我得到了缺失的部分：

```
dojo.require("dojo.fx"); 
```

当我将这一行添加到我的 HTML 的 head setction 中时，Mangify() 设置的动画部分正在工作。这仅适用于您为 dojox.charting 库设置 xDomain 对 dojox 的引用的情况。

我发现这是通过使用 Firebug 查看[DojoToolKit 的 Event 2D 网页](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/charting/tests/test_event2d.html)。在头部有代码：

```
<script src="http://../action2/Magnify.js" type="text/javascript"></script> 
```

该页面已启用调试。因此，在 FireBug 窗口中，您将看到布局良好的 js 源代码。我看到了三个要求，一个是“dojo.fx”。我试图添加这个。然后没有更多的错误，当我将鼠标移到图表曲线中的点上时，我可以看到放大效果的动画。

<script src=".."> 有趣的一点是，如果 js 是 xDomain 引用的，那么 js 源代码会在很长一段时间内部分显示。如果您的网页上安装了dojo 库，即同一个域，则dojo 的源代码可以很好地显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T05:42:42.170

关于 y 轴值，我还找到了显示它们的简单方法（0 到 9）：

```
.addAxis("y", {
  vertical: true,
  //min: 0
  //max: 10
.... 
```

您也可以仅注释掉 min 并将 max 保留为 10（0、1、... 到 10）。有关轴设置的更多详细信息，请参见[DojoCampus.org](http://docs.dojocampus.org/dojox/charting#axis-stepping)。

# c# - 这个 C# 扩展方法是否不纯，如果是，代码错误？

> ID：693628
> 
> 赞同：4
> 
> 时间：2009-03-28T22:13:45.293
> 
> 标签：c#, functional-programming, extension-methods

我正在学习一些关于函数编程的知识，我想知道：

1）如果我的`ForEach`扩展方法是纯的？我这样称呼它似乎违反了“不要弄乱传入的对象”，对吗？

```
public static void ForEach<T>(this IEnumerable<T> source, Action<T> action)
{
  foreach ( var item in source )
     action(item);
}

static void Main(string[] args)
{
    List<Cat> cats = new List<Cat>()
    {
        new Cat{ Purring=true,Name="Marcus",Age=10},
        new Cat{ Purring=false, Name="Fuzzbucket",Age=25 },
        new Cat{ Purring=false, Name="Beanhead",Age=9 },
        new Cat{Purring=true,Name="Doofus",Age=3}
    };

    cats.Where(x=>x.Purring==true).ForEach(x =>
    {
        Console.WriteLine("{0} is a purring cat... purr!", x.Name);
    });

    // *************************************************
    //  Does this code make the extension method impure?
    // *************************************************
    cats.Where(x => x.Purring == false).ForEach(x =>
    {
        x.Purring = true; // purr,baby
    });

    // all the cats now purr
    cats.Where(x=>x.Purring==true).ForEach(x =>
    {
        Console.WriteLine("{0} is a purring cat... purr!", x.Name);
    });
}

public class Cat {
        public bool Purring;
        public string Name;
        public int Age;
} 
```

2）如果它不纯，它是坏代码吗？我个人认为它比旧的代码看起来更干净`foreach ( var item in items) { blah; }`，但我担心它可能不纯，可能会造成混乱。

3）如果它返回`IEnumerable<T>`而不是，它会是坏代码`void`吗？我会说，只要它是不纯的，是的，这将是非常糟糕的代码，因为它会鼓励链接一些会修改链的东西。例如，这是错误的代码吗？

```
// possibly bad extension
public static IEnumerable<T> ForEach<T>(this IEnumerable<T> source, Action<T> action)
{
    foreach ( var item in source )
        action(item);

    return source;

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-28T23:33:17.580

杂质并不一定意味着糟糕的代码。许多人发现使用副作用来解决问题既简单又有用。关键是首先要知道如何以纯粹的方式来做，这样你就会知道什么时候杂质是合适的:)。

.NET 在类型系统中没有纯度的概念，因此接受任意委托的“纯”方法总是不纯的，这取决于它的调用方式。例如，“Where”，又名“filter”，通常被认为是一个纯函数，因为它不会修改其参数或修改全局状态。

但是，没有什么能阻止您将此类代码放入 Where 的参数中。例如：

```
things.Where(x => { Console.WriteLine("um?"); 
                    return true; })
      .Count(); 
```

所以这绝对是对 Where 的不纯用法。Enumerables 可以在迭代时做任何他们想做的事情。

**你的代码不好吗？**不，使用 foreach 循环同样“不纯”——您仍在修改源对象。我一直在写这样的代码。将一些选择、过滤器等链接在一起，然后对其执行 ForEach 以调用一些工作。你是对的，它更干净，更容易。

示例：ObservableCollection。由于某种原因，它没有 AddRange 方法。所以，如果我想给它添加一堆东西，我该怎么办？

```
foreach(var x in things.Where(y => y.Foo > 0)) { collection.Add(x)); } 
```

或者

```
things.Where(x => x.Foo > 0).ForEach(collection.Add); 
```

我更喜欢第二个。至少，我看不出它如何被解释为比第一种方式更糟。

什么时候是坏代码？当它在一个意想不到的地方产生副作用时。这是我使用 Where 的第一个示例的情况。即便如此，有时范围非常有限且用途很明确。

**链接 ForEach**

我已经编写了执行此类操作的代码。为了避免混淆，我会给它另一个名字。主要的困惑是“这是立即评估还是懒惰？”。ForEach 意味着它将立即执行一个循环。但是返回 IEnumerable 的东西意味着将根据需要处理这些项目。所以我建议给它另一个名字（“Process”、“ModifySeq”、“OnEach”......类似的东西），并让它变得懒惰：

```
public static IEnumerable<T> OnEach(this IEnumerable<T> src, Action<T> f) {
  foreach(var x in src) {
    f(x);
    yield return x;
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-28T22:19:01.410

它不是纯的，因为它可以调用不纯的方法。我认为按照典型的定义，纯度是一个传递闭包——一个函数只有当它调用的所有函数（直接或间接）也是纯的，或者如果这些函数的效果被封装（例如，它们只改变一个非转义的局部变量）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-28T22:24:18.777

是的，它不是纯粹的，但这是一个有争议的问题，因为它甚至不是一个函数。

由于该方法不返回任何内容，因此它做任何事情的唯一选择是影响您发送的对象，或影响不相关的东西（如写入控制台窗口）。

编辑：
回答你的第三个问题；是的，那是糟糕的代码，因为它似乎在做一些它没有做的事情。该方法返回一个集合，所以它看起来是纯的，但由于它只是返回发送的集合，它实际上并不比第一个版本更纯。为了有意义，该方法应该将`Func<T,T>`委托用作转换，并返回转换项的集合：

```
public static IEnumerable<T> ForEach<T>(this IEnumerable<T> source, Func<T,T> converter) {
   foreach (T item in source) {
      yield return converter(item);
   }
} 
```

如果扩展调用是纯的，它当然仍然取决于转换器功能。如果它不复制输入项而只是更改并返回它，则调用仍然不是纯的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T22:20:52.467

事实上，因为您的 lambda 表达式包含一个赋值，所以该函数现在根据定义是不纯的。赋值是否与参数之一相关或与当前函数外部定义的另一个对象无关......函数必须没有任何副作用才能被称为*pure*。有关更精确（尽管非常简单）的定义，请参见[Wikipedia ，该定义详细说明了函数必须满足才能被视为](http://en.wikipedia.org/wiki/Pure_function)*纯函数的两个条件*（没有副作用就是其中之一）。我相信 lambda 表达式通常被用作纯函数（至少我会想象它们最初是从数学角度研究的），尽管显然 C# 对此并不严格，而纯函数语言则如此。所以这可能不是坏的做法，尽管这样的功能不纯绝对值得离开。

# python - 更改 Python 列表中的所有值？

> ID：693630
> 
> 赞同：5
> 
> 时间：2009-03-28T22:15:04.587
> 
> 标签：python

假设我有一个类似的列表：

```
my_list = [[1,2,3],[4,5,6],[7,8,9]] 
```

如何在不做的情况下更改列表中的每个值？：

```
for x in range(0, 3):
    for y in range(0, 3):
        my_list[x][y] = -my_list[x][y] 
```

我试图通过这样做来简化这一点

```
my_list = [[[-a, -b, -c] for [a, b, c] in d] for d in my_list] 
```

但值保持不变。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-29T00:09:02.707

另一种选择是使用内置`map`函数：

```
>>> my_list = [[1,2,3],[4,5,6],[7,8,9]]
>>> neg = lambda x: -x
>>> f = lambda x: map(neg, x)
>>> map(f, my_list)
[[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-29T00:37:37.660

许多答案是关于创建列表的更改*副本*，但问题的字面意思是关于列表的就地修改。

这是我最好的就地列表更改解决方案的版本：

```
def alter_elements(lst, func):
  for i, item in enumerate(lst):
    if isinstance(item, list):
      alter_elements(item, func)
    else:
      lst[i] = func(item) 
```

测试运行：

```
>>> sample = [[1,2,3],[4,5,6],[7,8,9]]
>>> alter_elements(sample, lambda x: -x)
>>> print sample
>>> [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]] 
```

没有列表副本。没有硬编码的界限。没有具有副作用的列表推导。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-28T23:05:53.980

可以编写一个更通用的解决方案来解决这个问题。以下适用于 Python 3.0，*无论嵌套级别如何*。

让我们定义`recursive_map`：

```
import collections

def recursive_map(f, iterable):
    for e in iterable:
        if isinstance(e, collections.Iterable):
            yield recursive_map(f, e)
        else:
            yield f(e) 
```

现在，请求的否定函数可以编码如下：

```
import functools
import operator

negate = functools.partial(recursive_map, operator.neg) 
```

因此，对于一些任意嵌套的*iterables* `x`集合，我们计算它的否定`y`是这样的：

```
y = negate(x) 
```

* * *

**附录：**

正如用户[chradcliffe](https://stackoverflow.com/users/77028/chradcliffe)所指出的，上述`negate`函数产生了一个生成器，该生成器可能包含其他生成器……等等。要扩展/评估所有这些生成器，我们需要应用`list()`到所有这些生成器。所以我们定义了另一个通用的映射函数，这一次是在迭代本身上工作的。

```
def recursive_iter_map(f, iterable):
    def rec(e):
        if isinstance(e, collections.Iterable):
            return recursive_iter_map(f, e)
        else:
            return e

    return f(map(rec, iterable)) 
```

现在，

```
all_lists = functools.partial(recursive_iter_map, list)
y = all_lists(negate(x)) 
```

实际上会立即否定每个元素并返回完整列表。

请注意，我们可以将可迭代的嵌套集合视为*树*。每个可迭代对象是一个子树，而非可迭代对象是叶子。因此，我定义的第一个函数适用于叶子，第二个函数适用于非叶子。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-28T22:18:45.060

“改变”我假设你的意思是“否定”（但你应该这么说）。

我注意到您正在迭代二维数组（列表列表）的每个元素并将每个元素视为三个元素的列表......但实际上每个元素只是一个数字，在您的问题中如所述. 所以我会做这样的事情：

```
my_list = [[-n for n in l] for l in my_list] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-28T22:20:16.320

试试这个：

```
my_list = [[-a, -b, -c] for [a, b, c] in my_list] 
```

请注意，这会创建一个新列表，而不是更改列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T22:36:22.477

正如其他人所指出的，有两个“级别”的列表和一个“级别”的整数，所以两个循环给你一个整数，而不是另一个列表。

为了比较，循环版本应该是：

```
for x in range(0, 3):
    for y in range(0, 3):
        my_list[x][y] = -my_list[x][y] 
```

这也固定了您的范围的界限。上限是排他性的，不包括在内。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T22:43:35.097

尽管康斯坦丁的回答是正确的，但我会做出两个改进：

1.  普遍性并不总是最好的方法。如果改变功能应该在列表上工作怎么办？
2.  使用`enumerate`和索引不如创建列表副本并使用`[:]`切片就地分配它快。

所以这是我的替代方案，它还就地修改了列表和所有内部列表：

```
def lst_apply(lst, func, lvl):
    if lvl:
        for x in lst:
            lst_apply(x, func, lvl - 1)
    else:
        lst[:] = [func(x) for x in lst]

>>> lst_apply(my_list, lambda x: -x, 1)
>>> my_list
[[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]] 
```

不过，我仍然相信，这里最好的方法是：

```
def simple_apply(lst, func):
    lst[:] = [[func(x) for x in y] for y in lst] 
```

`timeit`结果：

*   `simple_apply`: 4.0s
*   `lst_apply`: 5.4s
*   `alter_elements`: 11.5s

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-28T23:57:13.670

它很丑，但如果你真的想的话，你可以用列表理解就地修改列表。

```
>>> my_list = [[1,2,3],[4,5,6],[7,8,9]]
>>> [[slist.__setitem__(i, -n) for i, n in enumerate(slist)] for slist in my_list]
[[None, None, None], [None, None, None], [None, None, None]]
>>> my_list
[[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]] 
```

### 显式`for`循环

`for`但是，当涉及副作用时，使用显式循环（如其他答案所示）被认为是更好的样式。我认为`for`循环样式的一个不错的形式是：

```
for nested_list in my_list:
    for i, x in enumerate(nested_list):
        nested_list[i] = -x 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-29T07:57:39.133

如果您有一个 3x3 的数字数组，并且您想对其中的每个元素执行转换，我怀疑从长远来看，使用 NumPy/SciPy 之类的数字库并使用它提供的矩阵例程可能会更好地为您服务. 如果您以任何方式对高性能感兴趣，那么这将是必要的。python 的大部分灵活性可以在数组元素级别放弃，以换取优化的数值算法速度。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-08T22:40:30.820

lst 变量是指向列表 word_list 列表的指针。如果 i 的值在 set(lst) 中，则通过获取 i 的索引值并分配 j 来替换。

```
my_list = [[1,2,3],[4,5,6],[7,8,9]]
dictionary = {1: -1, 2: -2, 3: -3,4:-4,5:-5,6:-6,7:-7,8:-8,9:-9}

def replace_all(word_list, dictionary):
    for i, j in dictionary.items():
        for lst in word_list:
            if i in set(lst): 
                print("index",lst.index(i),"replace",j)
                lst[lst.index(i)] = j
        print(word_list)
    return word_list

result=replace_all(my_list, dictionary)
print("result",result) 
```

输出：

```
index 0 replace -1
[[-1, 2, 3], [4, 5, 6], [7, 8, 9]]
index 1 replace -2
[[-1, -2, 3], [4, 5, 6], [7, 8, 9]]
index 2 replace -3
[[-1, -2, -3], [4, 5, 6], [7, 8, 9]]
index 0 replace -4
[[-1, -2, -3], [-4, 5, 6], [7, 8, 9]]
index 1 replace -5
[[-1, -2, -3], [-4, -5, 6], [7, 8, 9]]
index 2 replace -6
[[-1, -2, -3], [-4, -5, -6], [7, 8, 9]]
index 0 replace -7
[[-1, -2, -3], [-4, -5, -6], [-7, 8, 9]]
index 1 replace -8
[[-1, -2, -3], [-4, -5, -6], [-7, -8, 9]]
index 2 replace -9
[[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]]
result [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]] 
```

# c# - 在 LINQ Select 中多次调用 First() 是不是很糟糕？

> ID：693634
> 
> 赞同：3
> 
> 时间：2009-03-28T22:18:26.513
> 
> 标签：c#, linq

我有一个 LINQ 语句，我想将第一个地址与“我”的昵称合并。

```
using (var ctx = new DataEntities())
{
  return from c in ctx.Customers.Include("Addresses")
         let m = from a in c.Addresses where a.Nickname == "Me" select a
         where m.Any()
         select new
         {
           Id = c.CustomerId,
           m.First().Name,
           m.First().Address1,
           m.First().Address2,
           m.First().City,
           m.First().State,
           m.First().Zip,
           m.First().Email,
           m.First().PhoneNumber
         };
} 
```

我在想：

1.  如果我像这样多次调用 First 会影响性能吗？
2.  对此有更好的 LINQ 语句吗？
3.  刚刚也意识到，我需要 .Include("Addresses") 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-28T22:21:00.250

对于 LINQ to SQL、EF 等，这*可能*无关紧要 - TSQL 转换完全有可能无论如何都会使其相同。当然，您可以确定；-p

但是对于 LINQ-to-Objects（这是非常字面的）它会。您可以通过使用来改善这一点`let`：

```
return from c in ctx.Customers.Include("Addresses")
     let m = from a in c.Addresses where a.Nickname == "Me" select a
     where m.Any()
     let first = m.First()
     select new
     {
       Id = c.CustomerId,
       first.Name,
       first.Address1,
       ...
       first.PhoneNumber
     }; 
```

# php - 从 PHP 数组输出（回显/打印）所有内容

> ID：693637
> 
> 赞同：24
> 
> 时间：2009-03-28T22:18:46.573
> 
> 标签：php, arrays

是否可以在不指定数组的哪一部分的情况下回显或打印数组的全部内容？

场景：我试图回应以下所有内容：

```
while($row = mysql_fetch_array($result)){
echo $row['id'];
} 
```

不指定“id”，而是输出数组的完整内容。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-28T22:32:29.350

如果您想自己格式化输出，只需添加另一个循环（foreach）来遍历当前行的内容：

```
while ($row = mysql_fetch_array($result)) {
    foreach ($row as $columnName => $columnData) {
        echo 'Column name: ' . $columnName . ' Column data: ' . $columnData . '<br />';
    }
} 
```

或者，如果您不关心格式，请使用前面答案中推荐的 print_r 函数。

```
while ($row = mysql_fetch_array($result)) {
    echo '<pre>';
    print_r ($row);
    echo '</pre>';
} 
```

print_r() 只打印数组的键和值，而 var_dump() 也打印数组中数据的类型，即 String、int、double 等。如果您确实关心数据类型 - 使用 var_dump() 而不是 print_r()。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-28T22:23:26.860

要获得漂亮且可读的结果，请使用以下命令：

```
function printVar($var) {
    echo '<pre>';
    var_dump($var); 
    echo '</pre>';
} 
```

上述函数将保留原始格式，使其在网络浏览器中（更）可读。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-28T22:21:09.050

`var_dump()`可以做到这一点。

> 此函数显示有关一个或多个表达式的结构化信息，包括其类型和值。使用缩进显示结构的值递归地探索数组和对象。

[http://php.net/manual/en/function.var-dump.php](http://php.net/manual/en/function.var-dump.php)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-28T22:21:58.783

我认为您正在寻找[print_r](http://us2.php.net/print_r)它将数组打印为文本。您无法控制格式，但更多的是用于调试。如果你想要很酷的格式，你需要手动完成。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-01-04T05:58:11.833

如果您正在调试数组，这是我一直使用的一个小功能，它很方便。它与 Darryl 和 Karim 发布的内容几乎相同。我刚刚添加了一个参数标题，这样你就有了一些调试信息作为你正在打印的数组。它还会检查您是否为它提供了有效的数组，并让您知道是否没有。

```
function print_array($title,$array){

        if(is_array($array)){

            echo $title."<br/>".
            "||---------------------------------||<br/>".
            "<pre>";
            print_r($array); 
            echo "</pre>".
            "END ".$title."<br/>".
            "||---------------------------------||<br/>";

        }else{
             echo $title." is not an array.";
        }
} 
```

基本用法：

```
//your array
$array = array('cat','dog','bird','mouse','fish','gerbil');
//usage
print_array("PETS", $array); 
```

结果：

```
PETS
||---------------------------------||

Array
(
    [0] => cat
    [1] => dog
    [2] => bird
    [3] => mouse
    [4] => fish
    [5] => gerbil
)

END PETS
||---------------------------------|| 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-28T22:22:15.460

您可以使用它`print_r`来获得人类可读的输出。

见[http://www.php.net/print_r](http://www.php.net/print_r)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T22:31:45.997

类似于 karim 的，但 print_r 的输出很小，我发现通常你只需要：

```
function PrintR($var) {
    echo '<pre>';
    print_r($var);
    echo '</pre>';
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-12T07:13:35.527

您可以使用 print_r 获得人类可读的输出。但要将其显示为文本，我们添加“echo '';”

回声''; 打印_r（$行）；

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-04T06:21:43.513

```
 //@parram $data-array,$d-if true then die by default it is false
 //@author Your name

 function p($data,$d = false){

     echo "<pre>"; 
         print_r($data);
     echo "</pre>"; 

     if($d == TRUE){
        die();
     } 
} // END OF FUNCTION 
```

每当您需要字符串或数组时使用此功能，它会非常好用。
有 2 个参数
1.$data - 它可以是数组或字符串
2.$d - 默认情况下它是 FALSE 但如果你设置为 true 那么它将执行 die() 函数

在您的情况下，您可以以这种方式使用....

```
while($row = mysql_fetch_array($result)){
    p($row); // Use this function if you use above function in your page.
} 
```

# asp.net - asp.net 设计器如何获取设计的页面类型

> ID：693640
> 
> 赞同：0
> 
> 时间：2009-03-28T22:19:58.240
> 
> 标签：asp.net, visual-studio-2008, designer, extensibility

我想在 Web 控件中找出在 Visual Studio 2008 中设计的页面的真实类型。

我可以获得 WebFormsRootDesigner，不知何故我知道有可能获得

aspx 页面的文件路径。

我宁愿获取该页面的 ProjectItem，因为让控件解析文件会有点过头了，但我找不到这样做的方法。

从aspx页面的projectitem我不知道如何获取页面类......

我希望我的 web 控件在设计时根据页面类型表现不同。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T22:26:40.767

这真是一个糟糕的设计。让“内部”的行为基于“外部”而有所不同，或者“孩子”基于“父母”而表现不同，这总是不好的。

相反，让页面通过设置属性来告诉控件如何运行。不同的页面会告诉同一个控件以不同的方式运行。这样，如果您添加新页面，它仍然可以选择使用现有行为之一。

# c++ - 构造函数定义中的 void 是什么意思？

> ID：693652
> 
> 赞同：16
> 
> 时间：2009-03-28T22:22:32.743
> 
> 标签：c++

给定以下代码：

```
#pragma once

class B
{
public:

    B(void)
    {
    }

    ~B(void)
    {
    }
}; 
```

我知道我也可以这样写：

```
#pragma once

class B
{
public:

    B()
    {
    }

    ~B()
    {
    }
}; 
```

`void`第一个例子的目的是什么？是不是某种类型的实践表明构造函数采用**零**参数？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-28T22:25:29.570

两者是相同的，至少在 C++ 中是一样的。在 C 中，提供一对空括号通常意味着未指定的参数列表（与空参数列表相反）。C++ 没有这个问题。

***一个正确的答案怎么会被多次否决？又一个 SO 错误？***

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-28T22:46:18.707

很久以前你在 C 中做过这样的事情（我的 pre-ISO C 已经生锈了:)）：

```
void foo(a, b)
   int a, 
   int b
{
} 
```

在创建 C++ 时，名称 mangling 需要参数的类型，因此对于 C++，它被更改为：

```
void foo(int a, int b)
{
} 
```

这种变化被带到了C.

在这一点上，我相信要避免破坏现有的 C 代码：

```
void foo() 
```

还有这个：

```
void foo(void) 
```

意味着两个非常不同的东西，`()`意味着*不检查参数编号或类型*，`(void)`意味着*不接受任何参数*。对于 C++ 来说*，不检查任何东西*是行不通的，所以在 C++中`()`意味着同样的事情。*`()``(void)`*

 *所以，对于 C++来说`()`，`(void)`总是一样的。

至少我是这么记得的……:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T22:25:28.743

afaik 如果您将 void 作为参数传递给构造函数或任何函数，则意味着该函数不接受任何参数，因此示例 a 和 b 相等。但我不确定他们中的任何一个是否以任何方式更改函数签名或使其运行得更快等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:55:11.797

我只是想补充一点，当您在 function():void 之类的参数之后使用 void 时，它用于指示函数不返回值。

# objective-c - 在 XCode 中调试“终止未捕获的异常”

> ID：693658
> 
> 赞同：1
> 
> 时间：2009-03-28T22:25:42.627
> 
> 标签：objective-c, xcode, debugging

所以我的应用程序崩溃了，我对如何使用 XCode 进行调试有点茫然。

我在 macforums 上找到了一个关于在“objc_exception_throw”处放置断点的论坛......虽然我不确定从那里去哪里。

在 XCode 中调试的任何一般准则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T22:28:53.883

当程序崩溃时，它将转储堆栈跟踪。您应该能够找到导致崩溃的行。然后在前几行放置一个断点并检查一下。

堆栈跟踪通常只包含数字。要获得人类可读的符号，您可以使用：

atos -o /Users/NNN/XXX/build/Debug-iphonesimulator/XXX.app/XXX [来自堆栈跟踪的编号]

大多数崩溃是由于内存在它应该被释放之前被释放。这通常是由于没有保留对象造成的。您可以使用 retainCount 方法打印任何对象的保留计数。

进入调试器后，您可以使用：

> po someObject

打印有关对象的信息。或获取保留计数：

> 打印 [someObject retainCount]

# c++ - Direct3D 和 iPhone 加速度计矩阵

> ID：693665
> 
> 赞同：1
> 
> 时间：2009-03-28T22:30:54.673
> 
> 标签：c++, iphone, directx, direct3d, matrix

我正在使用 WinSock 连接来获取加速度计信息和 iPhone 并进入 Direct3D 应用程序。我已经修改了 Apples GLGravity 的示例代码，让我的直升机相对于重力移动，但是我需要“限制”移动，这样直升机就不能倒飞！我试图像这样限制加速度计的输出

```
if (y < -0.38f) {
  y = -0.38f;
} 
```

除了这似乎不起作用！？我唯一能想到的是我需要修改自定义矩阵，但我似乎无法理解我需要更改的内容。矩阵代码如下。

```
 _x = acceleration.x;
_y = acceleration.y;
_z = acceleration.z;

float length;
D3DXMATRIX matrix, t;

memset(matrix, '\0', sizeof(matrix));

D3DXMatrixIdentity(&matrix);

// Make sure acceleration value is big enough.
length = sqrtf(_x * _x + _y * _y + _z * _z);

if (length >= 0.1f && kInFlight == TRUE) { // We have a acceleration value good enough to work with.
    matrix._44 = 1.0f; // 

    // First matrix column is a gravity vector.
    matrix._11 = _x / length;
    matrix._12 = _y / length;
    matrix._13 = _z / length;

    // Second matrix is arbitrary vector in the plane perpendicular to the gravity vector {Gx, Gy, Gz}.
    // defined by the equation Gx * x + Gy * y + Gz * z = 0 in which we set x = 0 and y = 1.
    matrix._21 = 0.0f;
    matrix._22 = 1.0f;
    matrix._23 = -_y / _z;
    length = sqrtf(matrix._21 * matrix._21 + matrix._22 * matrix._22 + matrix._23 * matrix._23);
    matrix._21 /= length;
    matrix._22 /= length;
    matrix._23 /= length;

    // Set third matrix column as a cross product of the first two.
    matrix._31 = matrix._12 * matrix._23 - matrix._13 * matrix._22;
    matrix._32 = matrix._21 * matrix._13 - matrix._23 * matrix._11;
    matrix._33 = matrix._11 * matrix._22 - matrix._12 * matrix._21;
} 
```

如果有人可以提供帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-28T21:26:16.753

我认为双重整合可能过于复杂了。如果我正确理解了这个问题，iPhone 会给你一个加速度计的值向量。假设用户没有挥动它，该向量将具有大致恒定的长度，并在重力作用下直接指向下方。

这样做有一个主要问题，那就是您无法判断用户何时围绕水平旋转手机。想象一下，您将手机放在桌子上，当您坐在它前面时，底部朝向您；重力矢量将是 (0, -1, 0)。现在将手机旋转 90 度左右，使底部朝向您的左侧，但仍平放在桌子上。重力矢量仍然是 (0, -1, 0)。但你真的希望你的直升机随手机转动。这是 iPhone 只有一个 2D 加速度计这一事实的基本限制，并且它正在从中推断出一个 3D 重力矢量。

所以让我们假设你已经告诉用户他们不允许像那样旋转他们的手机，他们必须把它和你的底点放在一起。没关系，您仍然可以从中获得很多控制权。

接下来，您需要限制输入，以使直升机在其一侧不会超过 90 度。想象一下，你得到的向量是一根附在你手机上的棍子，并在重力的作用下晃来晃去。您拥有的矢量描述了相对于手机平面的重力方向。如果是 (0, -1, 0)，则摇杆直接指向下方 (-y)。如果是 (1, 0, 0)，则摇杆指向手机的右侧 (+x)，并暗示手机已顺时针旋转 90 度（远离您看手机）。

在这个比喻中假设棍子具有完全的旋转自由度。它可以指向手机的任何方向。所以移动棍子描述了一个球体的表面。但至关重要的是，您只希望摇杆能够在该球体的下半部分移动。如果用户扭动手机使摇杆位于球体的上半部分，您希望它盖上盖子，使其指向球体赤道附近的某个地方。

您可以通过使用极坐标非常干净地实现这一点。3D 矢量和极坐标是可互换的 - 您可以相互转换而不会丢失任何信息。

将您拥有的向量（当然是标准化的）转换为一组 3D 极坐标（您应该能够很容易地在网络上找到这个逻辑）。这将为您提供围绕水平面的角度，以及垂直面的角度（以及与原点的距离 - 对于归一化向量，这应该是 1.0）。如果垂直角为正，则向量在球体的上半部分，负值在球体的下半部分。然后，限制垂直角，使其始终为零或更小（球体的下半部分也是如此）。然后，您可以获取水平和封顶垂直角度，并将其转换回矢量。

如果将这个新向量插入您已有的矩阵代码中，它将为您提供正确的方向，仅限于您需要的运动范围。如果用户将手机转动稍微超过 90 度标记，它也会保持稳定 - 此逻辑将使您的方向矢量尽可能接近用户当前的方向，而不会超出您设置的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-16T14:02:58.717

看起来您正在使用来自手机的加速度矢量来定义正交参考系的一个轴。我想 +Y 是指向地面的，所以你会担心向量指向天空的情况。

考虑 iphone 报告 {0, -6.0, 0} 的情况。您将此向量更改为 {0, -.38, 0}。但它们都归一化为 {0, -1.0, 0}。因此，将 y 钳位在 -.38 处的效果受向量的其他两个分量大小的影响。

您真正想要的是在 Y 为负时限制矢量与 XZ 平面的角度。

假设当 Y 为负时，您希望将其限制为与 XZ 平面的夹角不超过 30 度。首先对向量进行归一化，然后：

```
const float limitAngle = 30.f * PI/180.f; // angle in radians
const float sinLimitAngle = sinf(limitAngle);
const float XZLimitLength = sqrtf(1-sinLimitAngle*sinLimitAngle);

if (_y < -sinLimitAngle)
{
    _y = -sinLimitAngle;
    float XZlengthScale = XZLimitLength / sqrtf(_x*_x + _z*_z);
    _x *= XZlengthScale;
    _z *= XZlengthScale;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T17:01:42.557

首先尝试归一化加速度矢量。（编辑：检查长度后）（编辑编辑：我想我需要学习如何阅读......如何删除我的答案？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-17T02:09:18.483

因此，如果我理解正确，iPhone 正在为您提供加速度计数据，说明您在 3 轴上移动 iPhone 的难度。

我不熟悉那个苹果样品，所以我不知道它在做什么。但是，听起来您将加速度直接映射到方向，但我认为您想要做的是双重整合加速度以获得位置并查看位置变化以定位直升机。基本上，这更像是一个物理问题而不是 Direct3D 问题。

# d - 我应该使用 Phobos 还是 Tango？

> ID：693672
> 
> 赞同：26
> 
> 时间：2009-03-28T22:34:42.947
> 
> 标签：d, tango, phobos

我决定学习 D，我想知道我应该使用哪个标准库。我应该使用 Phobos 还是 Tango？各自的优缺点是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T01:10:14.540

如果您需要使用 D2，那么您现在应该使用 phobos，但 D2 的 tango 正在开发中。

[tangobos](http://www.dsource.org/projects/tangobos/)允许同时使用 tango 和 phobos。在 D2 中，两者都可以一起工作，因为它们都使用了单独的[druntime](http://www.dsource.org/projects/druntime)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-10-23T08:31:11.540

Tango 目前已经过时。它只适用于旧版本的 D。在我看来，Phobos 是唯一的出路。

当所有拆分库参数都在进行时，我并没有关注 d，但据我所知，当 D2 发布时，Tango 的很多原因都消失了。

有一些旨在复兴 Tango 的小努力，但在我看来，在标准库中分裂只会伤害整个 D。

此外，除非发生一些重大事件，否则几乎可以保证每个 D 版本都支持 Phobos。即使 Tango 成功移植到 D2，它也很容易再次被放弃。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-28T22:51:37.777

探戈。它在适当的地方更加面向对象，它包括容器（如 STL 或 Java 集合），它有一个活跃的开发团队，它有更多的动力（它可能很快会被纳入官方编译器），它有真实的文档，包括[Learn与 D 一起探戈](http://www.apress.com/book/view/1590599608)。

看起来 Tango 可能很快会被纳入 Walter 的版本中。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-28T23:10:45.950

我对两者都没有什么经验（有点..）

Phobos 更加扁平和类似蟒蛇，但相当不完整。

Tango 更像 Java，它使简单的事情变得复杂。

我个人更喜欢使用 phobos，除非您需要依赖于 Tango 的库（例如 DWT）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-11-20T08:13:53.850

从[消除常见的 D 神话](https://semitwist.com/articles/article/view/dispelling-common-d-myths#dmyths-tango)：

> Phobos 是 D 的标准库。Tango 现在是一个可选但与 Phobos 兼容的第三方库。这里的所有都是它的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-28T22:45:01.020

[火卫一 1* vs 探戈](http://docs.google.com/Doc?id=dcswwfd8_48hq4fdwhd)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-29T19:07:58.913

如果您使用 D2，请使用 Phobos

如果您使用 D1，请使用 Tango。

而且你必须学习 D2，所以使用 Phobos。容易，不是吗？

注意：D2 的 Phobos 比 D1 更强大和更大。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-20T19:52:54.143

在我看来，（从未真正使用过 Boost），Tango 更像 Boost，而 Phobos 更优雅。如上所述，使用 Phobos 很像 Python。

# java - 如何在 Java 中解析 REXX 代码？

> ID：693676
> 
> 赞同：5
> 
> 时间：2009-03-28T22:37:11.273
> 
> 标签：java, parsing, rexx

我想解析 REXX 源代码，以便我可以从 Java 分析程序的结构。

我需要做一些事情，比如规范化源中语法不同的等效逻辑结构，查找重复的变量声明等，而且我已经有 Java 背景。

有什么比编写大量代码更简单的方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-01T04:42:34.390

REXX 不是一种用常用工具解析的简单语言，尤其是那些需要 BNF 语法的工具。与大多数接触过 C 的人设计的语言不同，REXX 没有任何保留字，这使得任务有些复杂。每个看起来像保留字的术语实际上仅在其特定上下文中解析（*例如*，“PULL”仅保留为指令的第一个字`PULL`或指令的第二个字`PARSE PULL`- 您还可以有一个名为 PULL (" `PULL = 1 + 2`“））。此外，评论还有一些非常令人惊讶的效果。但是[ANSI REXX 标准](http://www.rexxla.org/rexxlang/standards/j18pub.pdf)具有完整的语法和所有规则。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-28T22:45:38.460

如果您有[BNF](http://en.wikipedia.org/wiki/Backus-Naur_form) Rexx 语法，那么**[javacc](https://javacc.dev.java.net/)**可以帮助您构建该 Rexx 代码的[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)（抽象语法树）表示。

更准确地说，javacc 将构建*Java 类*，这些类将：

*   解析 Rexx 代码和
*   实际上构建了 AST。

仍然会有“代码负载”，但您不会成为为该 Rexx 代码解析器编写类的人。只有它的一代。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-28T23:51:59.440

看看[ANTLR](http://www.antlr.org/)，它在构建 AST、转换它等方面确实做得很好......它有一个很好的编辑器 (ANTLRWorks)，基于 Java，并且可以在它们运行时调试你的解析器/tree walkers应用。真的值得研究任何类型的解析工作。

# c# - 带有 Smart Client Winform 应用程序的 IoC/DI 框架：我应该如何处理这个问题？

> ID：693690
> 
> 赞同：11
> 
> 时间：2009-03-28T22:48:03.430
> 
> 标签：c#, winforms, dependency-injection, inversion-of-control

我正在启动一个新的 Winforms 应用程序，并且打算使用 IoC/DI 框架（可能是 Ninject，但我也在考虑 StructureMap 和 LinFu）。

似乎几乎每个使用 IoC/DI 的人都是在基于 Web 的环境中这样做的，并且几乎没有发现任何使用 Winforms 的内容。

我想知道是否有人将 IoC/DI 与 Winforms 一起使用，以及您用于处理 Winforms 相关问题的方法（例如，您如何使容器在应用程序的各个部分中可用，您是否使用框架实例化您的表单等。）

如果有人知道任何使用 IoC/DI 的基于 Winforms 的开源项目（不管是哪个框架，我都应该能够翻译概念），我也想要这些链接。

编辑：

人们不再编写智能客户端了吗？

编辑：

如果您能指出一些在 Winforms 甚至控制台类型的应用程序中使用 IoC/DI 的真实代码（即不是基于 Web 的东西），我将不胜感激。

编辑：

我一直在使用 Ninject，发现如果您指定 IKernel 构造函数参数，Ninject 会很高兴地注入它的通用内核接口的实例。这一直很好，但我仍然想听听人们使用的其他方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T23:51:54.213

[维护Unity](http://www.codeplex.com/unity)注入容器的 Microsoft 模式和实践团队还为 winforms 创建了[Smart Client - Composite UI Application Block](http://msdn.microsoft.com/en-us/library/aa480450.aspx)，我相信它使用 Unity。[我知道名为Composite Client Application Guidance（代号 Prism）](http://msdn.microsoft.com/en-us/library/cc707819.aspx)的新 WPF 版本使用 Unity

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T17:02:26.687

我最近刚开始使用 StructureMap for IoC 从头开始​​编写一个新的 WinForms 应用程序。我以前看过 SCSF 和 CAB，但发现它们过于复杂。

我在 StructureMaps 注册表之上编写了一些流畅的 API，以便我们的模块可以注册命令、演示者和视图。

根据我的经验，所有方面的努力都是值得的，如果不再次使用这些工具和高度结构化的模块化方法，我将永远不想编写 WinForms 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T10:09:51.067

我编写了一个应用程序，用于显示来自 OpenStreetMap 矢量数据 ( [http://wiki.openstreetmap.org/index.php/Kosmos](http://wiki.openstreetmap.org/index.php/Kosmos) ) 的地图。我开发了自己的简单 MVP 框架，它使用 Windsor Castle 作为 IoC 容器。如果您有兴趣，可以下载源代码，它目前是 BSD 许可的。

现在我正在（慢慢地）重新设计这个框架，以便能够动态地生成表单（而不是使用可视化设计器）。我正在考虑引入某种流畅的界面来构建表单和控件，但我还没有为此想出一个优雅的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-24T22:54:18.597

If you just want an Inversion of Control container and want to get a little lower level than Unity, check out [ObjectBuilder](http://www.codeplex.com/ObjectBuilder) from the Microsoft Patterns and Practices group. Unity is an abstraction layer on top of ObjectBuilder.

# php - 如何初始化静态变量

> ID：693691
> 
> 赞同：215
> 
> 时间：2009-03-28T22:50:59.133
> 
> 标签：php, class, static-members

我有这个代码：

```
private static $dates = array(
  'start' => mktime( 0,  0,  0,  7, 30, 2009),  // Start date
  'end'   => mktime( 0,  0,  0,  8,  2, 2009),  // End date
  'close' => mktime(23, 59, 59,  7, 20, 2009),  // Date when registration closes
  'early' => mktime( 0,  0,  0,  3, 19, 2009),  // Date when early bird discount ends
); 
```

这给了我以下错误：

> 解析错误：语法错误，第 19 行 /home/user/Sites/site/registration/inc/registration.class.inc 中的意外 '(', expecting ')'

所以，我想我做错了什么......但如果不是那样，我该怎么做呢？如果我用常规字符串更改 mktime 内容，它就可以工作。所以我知道我可以像*那样*做..

有人有一些指示吗？

* * *

## 回答 #1

> 赞同：353
> 
> 时间：2009-03-28T23:50:04.017

PHP 无法解析初始化程序中的重要表达式。

我更喜欢通过在定义类之后添加代码来解决这个问题：

```
class Foo {
  static $bar;
}
Foo::$bar = array(…); 
```

或者

```
class Foo {
  private static $bar;
  static function init()
  {
    self::$bar = array(…);
  }
}
Foo::init(); 
```

* * *

[PHP 5.6](https://wiki.php.net/rfc/const_scalar_exprs)现在可以处理一些表达式。

```
/* For Abstract classes */
abstract class Foo{
    private static function bar(){
        static $bar = null;
        if ($bar == null)
            bar = array(...);
        return $bar;
    }
    /* use where necessary */
    self::bar();
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2010-12-17T11:24:07.307

如果您可以控制类加载，则可以从那里进行静态初始化。

例子：

```
class MyClass { public static function static_init() { } } 
```

在您的类加载器中，执行以下操作：

```
include($path . $klass . PHP_EXT);
if(method_exists($klass, 'static_init')) { $klass::staticInit() } 
```

一个更重量级的解决方案是使用带有 ReflectionClass 的接口：

```
interface StaticInit { public static function staticInit() { } }
class MyClass implements StaticInit { public static function staticInit() { } } 
```

在您的类加载器中，执行以下操作：

```
$rc = new ReflectionClass($klass);
if(in_array('StaticInit', $rc->getInterfaceNames())) { $klass::staticInit() } 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2011-10-16T15:20:19.903

与其想办法让静态变量工作，我更喜欢简单地创建一个 getter 函数。如果您需要属于特定类的数组并且实现起来更简单，这也很有帮助。

```
class MyClass
{
   public static function getTypeList()
   {
       return array(
           "type_a"=>"Type A",
           "type_b"=>"Type B",
           //... etc.
       );
   }
} 
```

无论您在哪里需要该列表，只需调用 getter 方法即可。例如：

```
if (array_key_exists($type, MyClass::getTypeList()) {
     // do something important...
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-10-21T18:41:06.863

我结合了 Tjeerd Visser 和porneL 的答案。

```
class Something
{
    private static $foo;

    private static getFoo()
    {
        if ($foo === null)
            $foo = [[ complicated initializer ]]
        return $foo;
    }

    public static bar()
    {
        [[ do something with self::getFoo() ]]
    }
} 
```

但更好的解决方案是取消静态方法并使用单例模式。然后你只需在构造函数中进行复杂的初始化。或者将其设为“服务”并使用 DI 将其注入到任何需要它的类中。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-28T23:13:10.563

这太复杂了，无法在定义中设置。您可以将定义设置为 null，然后在构造函数中检查它，如果它没有被更改 - 设置它：

```
private static $dates = null;
public function __construct()
{
    if (is_null(self::$dates)) {  // OR if (!is_array(self::$date))
         self::$dates = array( /* .... */);
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-28T22:53:04.980

您不能在这部分代码中进行函数调用。如果您创建了一个 init() 类型的方法，该方法在任何其他代码之前执行，那么您将能够填充该变量。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-09-03T14:52:50.570

最好的方法是创建这样的访问器：

```
/**
* @var object $db : map to database connection.
*/
public static $db= null; 

/**
* db Function for initializing variable.   
* @return object
*/
public static function db(){
 if( !isset(static::$db) ){
  static::$db= new \Helpers\MySQL( array(
    "hostname"=> "localhost",
    "username"=> "root",
    "password"=> "password",
    "database"=> "db_name"
    )
  );
 }
 return static::$db;
} 
```

然后你可以做 static::db(); 或 self::db(); 从任何地方。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-01-26T10:18:28.943

在 PHP 7.0.1 中，我可以这样定义：

```
public static $kIdsByActions = array(
  MyClass1::kAction => 0,
  MyClass2::kAction => 1
); 
```

然后像这样使用它：

```
MyClass::$kIdsByActions[$this->mAction]; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-07-11T18:23:54.193

这是一个希望有用的指针，在代码示例中。注意初始化函数如何只被调用一次。

此外，如果你反转调用`StaticClass::initializeStStateArr()`，`$st = new StaticClass()`你会得到相同的结果。

```
$ cat static.php
<?php

class StaticClass {

  public static  $stStateArr = NULL;

  public function __construct() {
    if (!isset(self::$stStateArr)) {
      self::initializeStStateArr();
    }
  }

  public static function initializeStStateArr() {
    if (!isset(self::$stStateArr)) {
      self::$stStateArr = array('CA' => 'California', 'CO' => 'Colorado',);
      echo "In " . __FUNCTION__. "\n";
    }
  }

}

print "Starting...\n";
StaticClass::initializeStStateArr();
$st = new StaticClass();

print_r (StaticClass::$stStateArr); 
```

产生：

```
$ php static.php
Starting...
In initializeStStateArr
Array
(
    [CA] => California
    [CO] => Colorado
) 
```

# php - img src 不适用于 php 变量

> ID：693698
> 
> 赞同：0
> 
> 时间：2009-03-28T22:52:51.877
> 
> 标签：php, variables, image, src

```
<a href="'.$productLink.'" alt="'.$productName.'">
<img src="'.$productImg1URL.'" alt="'.$productName.' '.$productType.' ">
</a> 
```

您好，img src 实际上位于不同的目录 /images

我知道这可能非常简单，但我已经花了一个小时在上面，什么也没做。该页面有效，但不显示目录。请帮助菜鸟。我把a href前面的<去掉，img src不能让页面显示

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T23:05:09.380

有两种方法可以做到这一点：

首先，在代码块之外：

```
<?php
// code here
?>
<a href="<?= $productLink ?>" alt="<?= $productName ?>">
<!-- or -->
<img src="<?echo $productImgURL; ?> alt="<?php echo $productName . ' ' . $productType ?>">
</a> 
```

第一种形式称为[短打开标记](http://au.php.net/ini.core)，必须在您的 php.ini 中启用，它几乎总是如此。

或者，如果您在代码块中执行此操作：

```
<?php
echo <<<END
<a href="$productLink" alt="$productName">
<img src="$productImgLURL" alt="$productName $productType">
</a>
END 
```

这`<<<END`是一个[heredoc](http://au.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)，我通常更喜欢在双引号内使用大字符串，这需要转义包含的双引号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:19:45.850

Job #1 when you have a problem with code that is generating HTML, is look at the output source and compare it with what you expect. I've had problems like this before and they usually vanished when I stopped thinking about the PHP code, and looked at the actual output.

What is the content of $productImg1URL - and if the images that it's referencing are in the URL starting /images/ - does that start $productImg1URL. If it's just the name of an image, but without the path - you have to put that into place.

# objective-c - NSArray（和其他容器）在 dealloc 上的行为

> ID：693702
> 
> 赞同：2
> 
> 时间：2009-03-28T22:54:45.583
> 
> 标签：objective-c, iphone

当 Objective C 容器被释放时，它们是释放对它们包含的对象的引用还是我需要手动这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T23:00:42.120

应该更仔细地阅读 NSArray 的文档：

> 数组维护对其内容的强引用——在托管内存环境中，每个对象在其 id 被添加到数组之前都会收到一条保留消息，并在从数组中删除或解除分配数组时收到一条释放消息。如果您想要一个具有不同对象所有权语义的集合，请考虑改用 CFArray Reference、NSPointerArray 或 NSHashTable。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T23:00:46.317

它们释放对它们包含的对象的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T23:02:07.470

当你添加一个对象时，它的引用计数会增加。当它被移除（手动枯萎或数组被销毁）时，它的引用计数会减少。

因此，使用以下代码，您不必释放对象

```
NSObject* someObject = [[[SomeClass alloc] init] autorelease];
[someArray addObject: someObject]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T23:02:14.660

[当一个数组被释放时，每个元素都会被发送一个释放消息。](http://developer.apple.com/documentation/Cocoa/Conceptual/Collections/Articles/Arrays.html#//apple_ref/doc/uid/20000132)

# php - 在 PHP 中定位函数定义的最佳实践

> ID：693703
> 
> 赞同：2
> 
> 时间：2009-03-28T22:55:29.840
> 
> 标签：php, file, function, path

有没有一种简单的方法可以找到定义函数的文件路径？我目前在整个目录中使用 Dreamweavers FIND。拥有不需要下载整个站点的东西会很好。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T23:00:41.217

我个人使用像 Netbeans 或 Eclipse PDT 这样的 IDE。对于 Netbeans，您可以按住 ctrl-click 一个函数，它会带您进入定义。有时有一个选择，在这种情况下它会让你选择一个。

但是在不同文件的代码中重用函数名称通常是不好的形式。它可能导致难以发现的错误，因为任何程序都很难准确地确定实际调用了哪个函数，因为可以动态包含源文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:28:07.110

> 拥有不需要下载整个站点的东西会很好。

我希望这并不意味着您正在远程修改站点。有一个本地工作副本，进行更改，在本地测试它们，然后上传更改。

vim 和 ctags 的简单组合使“去定义”任务变得轻而易举。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T23:05:06.167

除非您拥有它可能包含的所有文件的副本，否则您无法搜索（并期望找到它）。

许多 IDE 能够单击并从变量或函数的使用转到其定义。如果不是这样，那么编辑器中的多文件搜索工具，或者命令行中的一些更专业的搜索源代码的工具（例如[ack](http://betterthangrep.com/)）可以提供帮助。良好的命名约定也有助于保持一致性。

这不是问题，但您为什么不在本地拥有该站点的副本 - 当您使用它时，还要将其保留在版本控制中？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-10T06:07:44.887

我肯定会喜欢这种 get_functionPath() 功能，任何需要大量处理其他人代码的人都可能会发现它非常有用。我们有function_exists，如果它可以简单地返回为用户定义的函数定义函数的文件，它将节省大量的麻烦。不，不是我们所有人都使用 IDE，是的，我们中的一些人已经这样做了足够长的时间来在生产机器上编码。测试盒和沙盒是为新手准备的。

一个技巧是故意触发您尝试定位的函数中的错误。可以节省大量时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-10T06:14:59.213

您需要使用某种可以在远程文件系统上构建索引的工具，您可以下载并执行本地查找和搜索。我不知道有什么可以做到这一点，并且在谷歌上的片刻没有发现任何东西。

也许对于开源项目来说是个好主意？*提示提示*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T23:05:11.190

所以没有功能可以做到这一点？类似 get_class() 的东西会输出父类，但在服务器上的文件路径的情况下......

# silverlight - Silverlight 将一个控件数据绑定到另一个

> ID：693704
> 
> 赞同：2
> 
> 时间：2009-03-28T22:56:34.800
> 
> 标签：silverlight, data-binding, controls, listbox, checkbox

我在 Silverlight 工作。我有一个动态加载的 ListBox。在列表框中，我想放置一个与列表框的“选定”属性相关联的复选框。我不太清楚这是怎么做到的。谁能指出我正确的方向？如果这是一个winform的东西，我会为复选框创建“OnChecked”处理程序以找到复选框的父级并将其设置为选中。我正在研究有更好的方法。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T23:25:31.377

Silverlight 2 不支持他们所谓的元素到元素绑定。

此功能已添加到目前处于测试阶段的 Silverlight 3。Silverlight 3 可在[http://silverlight.net/getstarted/silverlight3/default.aspx获得](http://silverlight.net/getstarted/silverlight3/default.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T23:21:08.080

没有。

在 WPF 中，您可以通过在 CheckBox 上添加以下内容来实现：

`Checked="{Binding Source=Listbox.SelectedItem, Path=Something, Converter={StaticResource SomeConverter}}"`

但是，遗憾的是，Silverlight 2 不支持使用`Source=`.

换句话说，目前没有更好的方法。代码就是你所拥有的。

# ruby-on-rails - 如何获得包含在 Rails 中的已安装 ruby gem？

> ID：693706
> 
> 赞同：2
> 
> 时间：2009-03-28T22:57:31.380
> 
> 标签：ruby-on-rails, ruby, rubygems, nokogiri

我正在尝试让我在 Rails 应用程序中安装的 gem。我可以在从命令行运行的 Ruby 程序中要求 gem 很好：

```
require 'nokogiri' 
```

但是当我尝试在我的一个 Rails 控制器中做同样的事情时，它会出错，说“没有要加载的文件——nokogiri”。

我尝试使用 lib/nokogiri.rb 文件的完整路径，但由于找不到“nokogiri/native”而失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T23:08:02.540

更好的是，将以下内容放在您的 environment.rb 文件中：

```
Rails::Initializer.run do |config|
  ...
  config.gem :nokogiri
  ...
end 
```

这将告诉 Rails 你依赖于那个特定的 gem。它还允许您指定特定版本，并且它会自动保持所有 gem 同步，或者如果您愿意，可以将它们解压缩到 vendor/gems 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-30T01:48:47.683

我有一个类似的错误，但只是忘记将以下内容放在我的 environment.rb 文件中：（注意引号`"nokogiri"`）

```
Rails::Initializer.run do |config|
  ...
  config.gem "nokogiri"
  ...
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T23:32:54.760

好的，我想通了。这听起来很愚蠢……但是哦，好吧……

事实证明，我的机器上安装了两次 ruby​​。我使用 InstantRails 为我的测试应用程序提供服务，它预装了 ruby​​ 安装包。我有另一个安装，但是在此之外，这里安装了 nokogiri，而不是安装在 InstantRails 中。

无论如何，他们在不同的地方寻找宝石。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-28T22:59:07.773

尝试以下

```
require 'rubygems'  
gem 'nokogiri' 
```

如果您使用某种形式的 *nix，那么您在安装 gem 时是否遇到任何错误，特别是指出 gem 不在路径上的错误。如果您以自己而不是 root 身份安装了 gem，并且您的 gem 路径中没有您的个人 gem 库，则可能会发生这种情况。

如果您总是使用

```
sudo gem install some_gem_name 
```

那么你不应该遇到这个问题。

# iis - WordPress 可以安装在 IIS 上吗？如何安装？

> ID：693709
> 
> 赞同：4
> 
> 时间：2009-03-28T22:59:30.127
> 
> 标签：iis, wordpress, hosting

wordpress 可以安装在 IIS 主机上吗？如果是，在 IIS6 或 IIS7 上哪个更好更简单？以及如何在 IIS 上安装它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T23:17:01.660

您应该考虑使用支持 PHP的[Web Platform Installer Beta 2 。](http://www.microsoft.com/Web/downloads/platform.aspx)特色[网络应用程序页面](http://www.microsoft.com/Web/gallery/)将 WordPress 作为其首选

# c# - 如何在 C# 中将 byte[] 分配为指针

> ID：693710
> 
> 赞同：2
> 
> 时间：2009-03-28T22:59:46.103
> 
> 标签：c#, pointers, byte

我有一个函数可以根据任何数据包的内容生成 CRC 校验字节。问题在于将函数从 C++ 转换为 C#

C++ 代码：

```
unsigned char GenerateCheckByte( char* packet, int length, unsigned long seed )
{
if( !packet ) return 0;
unsigned long checksum = 0xFFFFFFFF;
length &= 0x7FFF;
char* ptr = packet;
unsigned long moddedseed = seed << 8;
for( int i = 0; i < length; i++ )
    checksum = ( checksum >> 8 ) ^ table[moddedseed + ( ( *(ptr++) ^ checksum ) & 0xFF )];
unsigned char result = ( (checksum>>24)&0xFF ) + ( (checksum>>8)&0xFF ) + ( (checksum>>16)&0xFF ) + ( checksum&0xFF );
return result;
} 
```

char*(packet) 也可以定义为 LPBYTE，这个想法是分配给 *packet 的值被分配给 *ptr 并且如您所见 *ptr 增加。意味着传入一个字节数组并通过增加指针指向下一个字节。

我尝试在 C# 中执行此操作，但多次失败。经过一番努力，我想出了一些代码，但我无法执行它：？

C# 代码

```
 public static unsafe byte GenerateCheckByte(byte *packet, int length, UInt32 seed )
    {
        if (*packet == 0)
        return 0;
        UInt32 checksum = 0xFFFFFFFF;
        length &= 0x7FFF;
        byte *ptr = packet;
        UInt32 moddedseed = seed << 8;
        for (int i = 0; i < length; i++)
            checksum = ( checksum >> 8 ) ^ Table.table[moddedseed + ( ( *(ptr++) ^ checksum ) & 0xFF )];
        byte result = (byte)(( (checksum>>24)&0xFF ) + ( (checksum>>8)&0xFF ) + ( (checksum>>16)&0xFF ) + ( checksum&0xFF ));
        return result;
    } 
```

它看起来没那么糟糕，但我不能称之为

```
 unsafe
  {
      packetBuffer[5] = Functions.GenerateCheckByte(&packetBuffer[0], 18, packet.seedCRC);
  } 
```

错误：“您只能在固定语句初始化程序中获取未固定表达式的地址”

**请注意**

C++ 和 C# 应用程序中的 packetbuffer 是 byte[] packetBuffer = new byte[18];

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T23:15:39.217

您可以使该方法接受一个字节数组：

```
public static unsafe byte GenerateCheckByte(byte[] packetArray, int length, UInt32 seed)
{
    fixed(byte *packet = packetArray)
    {
        ... etc
    }
} 
```

最好将不安全的东西尽可能地隐藏在托管接口后面。

然后调用它会很容易：

```
packetBuffer[5] = Functions.GenerateCheckByte(packetBuffer, 18, ... 
```

实际上，最好还是编写`GenerateCheckByte`对数组进行操作，而不是钻研`unsafe`技术：

```
public static unsafe byte GenerateCheckByte(byte[] packet, int length, UInt32 seed )
{
    if (packet == null)
        throw new ArgumentNullException("packet"); // the right way in C#

    UInt32 checksum = 0xFFFFFFFF;
    length &= 0x7FFF;

    UInt32 moddedseed = seed << 8;
    for (int i = 0; i < length; i++)
        checksum = ( checksum >> 8 ) ^ Table.table[moddedseed + ( ( packet[i] ^ checksum ) & 0xFF )];
    byte result = (byte)(( (checksum>>24)&0xFF ) + ( (checksum>>8)&0xFF ) + ( (checksum>>16)&0xFF ) + ( checksum&0xFF ));
    return result;
} 
```

尽可能编写最简单、最安全的实现，并且只有在发现性能分析瓶颈时才会使用指针。

您是否只是将大量现有的 C/C++ 转换为 C#？除非您从中获得一些新的安全性/可维护性，否则这样做毫无意义。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:30:22.033

您根本不必使用不安全的代码。如果你向函数发送一个字节数组，它可以在不使用指针的情况下访问它。

我还没有测试过代码，但它应该是这样的：

```
byte GenerateCheckByte(byte[] packet, ulong seed) {
    if (packet == null) return 0;
    int length = packet.Length & 0x7FFF;
    ulong checksum = 0xFFFFFFFF;
    ulong moddedseed = seed << 8;
    for (int i = 0; i < length; i++) {
            checksum = (checksum >> 8) ^ table[moddedseed + ((packet[i] ^ checksum) & 0xFF)];
    }
    return (byte)(
        ((checksum >> 24) & 0xFF) +
        ((checksum >> 16) & 0xFF) +
        ((checksum >> 8) & 0xFF) +
        (checksum & 0xFF)
    );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T23:15:59.713

您需要将字节数组“固定”到内存中以将其用作字节*。

```
byte checksum; 
fixed(byte* pPacketBuffer = packetBuffer)
{
    checksum = Functions.GenerateCheckByte(pPacketBuffer, 18, packet.seedCRC) 
}
packetBuffer[5] = checksum 
```

参考：

*   [编译器错误 CS0212](https://docs.microsoft.com/en-us/dotnet/csharp/misc/cs0212)
*   [固定语句 (C#)](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/fixed-statement)

# c# - 任何带有 TLS 和 SSL 的 OSS .Net FTP（客户端）？

> ID：693716
> 
> 赞同：6
> 
> 时间：2009-03-28T23:01:54.177
> 
> 标签：c#, .net, open-source, ftp

有谁知道使用 TLS 和 SSL 为 dotNET 执行 ftp-client 的开源库？

我们现在正在使用一个商业库，但我们对它不是很满意，所以我们正在考虑切换。因此，与其滚动我们自己，是否有任何 lgpl（或等效）库？

或者 - 如果我们必须推出自己的（它将是 LGPL 或 BSD 或 apache 风格的许可证），有没有人知道我们可以开始使用半成品代码库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-28T23:22:03.427

如果启用 SSL 的 FtpWebRequest 还不够，请查看这些库：

*   [http://code.google.com/p/sshsync/](http://code.google.com/p/sshsync/) - SshSync : 通过 SSH 同步目录
*   [http://ftpclient.codeplex.com](http://ftpclient.codeplex.com) - .NET 2.0 的 FtpRequest 库
*   [http://www.rebex.net/ftp.net/](http://www.rebex.net/ftp.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-28T23:13:16.037

嗯，[FtpWebRequest通过](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.aspx)[EnableSsl](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.enablessl.aspx)支持 SSL （使用“ `AUTH TLS`”）——这就足够了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T23:24:40.333

[这里](http://sourceforge.net/projects/libcurl-net/)有 libcurl 的 .Net 绑定。看起来最后一个版本是在 2005 年，所以也许这可能是您正在寻找的“半成品”代码库。libcurl 本身在 bsd 下，是一个被广泛使用的库，所以使用它似乎是值得的。

# javascript - Javascript：.className 更改与 .style 更改的性能

> ID：693719
> 
> 赞同：3
> 
> 时间：2009-03-28T23:04:59.257
> 
> 标签：javascript, performance

早在 2005 年，Quirksmode.com 就发布了这篇文章：

[http://www.quirksmode.org/dom/classchange.html](http://www.quirksmode.org/dom/classchange.html)

这表明“证明”通过更改元素的类（即“elem.className = x”）来更改元素的样式几乎是通过其样式属性更改其样式（即“elem.style.someStyle = x")，但在 Opera 中除外。作为那篇文章的结果，我们开始使用基于类名的解决方案来做一些事情，比如在我们的网站上显示/隐藏元素。

问题是，我们的一位开发人员更愿意使用 jQuery 的等效方法来处理这种事情（即“$(something).hide()”），我很难让他相信我们基于 className功能值得使用，因为我只能找到四年前写的一篇文章。

有谁知道对此问题有任何更新或更全面的调查？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-28T23:15:05.643

微优化是邪恶的。我认为，除非您一次隐藏大量元素或其他内容，否则如果这篇文章现在仍然相关，那么以毫秒为单位的差异并不重要。

考虑到这一点，我会使用 jQuery 的方法，因为它们经过了实战测试并且更简洁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T15:33:49.927

[文章使用的基准测试存在缺陷](http://webkit.org/blog/13/classname-vs-style/)。

根据我的个人经验，我从未见过更新 className 优于内联样式设置的情况。我没有具体的证据证明这一点（我模糊地记得我将要尝试挖掘的一篇文章），但我注意到大型客户端应用程序（例如 gmail 或 google 地图）更喜欢将内联样式设置为类名，并且正是在分析这些应用程序的背景下，我第一次听说这样做的速度有所提高。

请注意，我并不是在推崇另一个：动态设置 className 在可维护性/可读性和分离关注点方面大有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T23:17:14.203

虽然出于多种原因，我通常同意使用类而不是样式属性的做法。性能是一个，但一致性是另一个。我经常看到人们做这样的事情：

```
function toggle(element) {
  element.style.display = element.style.display == 'none' ? 'block' : 'none';
} 
```

（或 jQuery 等价物）

看起来很合理吧？直到您将其应用于具有默认显示值的表格元素，例如表格单元格（不是块）。类方法：

```
.hidden { display: none; }
...
function toggle(element) {
  $(element).toggleClass("hidden");
} 
```

由于这个和其他原因，好多了。

但是像 hide() 这样的 jQuery 方法是一个例外。他们正确处理显示设置并为您提供动画。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-28T23:34:08.017

自己测试一下。[您链接的页面上](http://www.quirksmode.org/dom/classchange.html)有一名测试人员。在您的目标浏览器上测试性能，以确定性能方面的最佳使用方法。

就个人而言，我会选择可读性而不是性能。此外，潮汐可能会在以后转向（如果还没有的话**）。如果使用类有意义（即，您对许多元素使用该样式），那么您不妨使用类。如果 CSS 用于元素上的动画，请使用`style`. 无论哪种方式，都更喜欢 jQuery 的函数，因为它们 (1) 更一致并且 (2) 更健壮且经过测试。

**至少对于 Opera 10，速度肯定有所提高。Opera 10 本地测试为 5/12ms，Firefox 3 为 57/88ms，Google Chrome 为 14/36ms，IE7 为 125/118ms (!)。IE7（可能是您的目标浏览器）两者的速度大致相同，但样式略有变化！

*过早的优化是万恶之源。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T15:46:36.447

您是否每秒隐藏数百个元素？如果没有，我会说有更大的鱼要炸。更糟糕的是，2005 年进行的一项研究没有说明现代浏览器的性能。没有 IE7 或 8，没有 Firefox 3（甚至是 2？），没有 Chrome。

但是如果你坚持并希望你的同事效仿，你应该编写一个 jQuery 插件，其中“hide()”使用类而不是样式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-28T23:11:21.520

不，但我可以告诉你，jQuery.hide() 可以隐藏一个具有平滑效果的元素。这不能通过更改类名来完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-28T23:17:45.700

您正在谈论客户端代码，它在用户浏览器中运行，因此不会加载您的服务器。我忽略了您客户端的javascript，但我想并没有占用太多CPU。

您的同事使用 jQuery 可能不会产生很大的影响，但它会产生更易读的代码。因此，我认为他根本不需要被说服。

# user-accounts - 在用户帐户终止时删除数据的最佳做法

> ID：693725
> 
> 赞同：11
> 
> 时间：2009-03-28T23:05:54.247
> 
> 标签：user-accounts

在拥有相当一部分用户生成内容的网站上，例如论坛主题、博客评论、提交的文章、私人和公共消息、用户资料等；如果用户终止其帐户，如何处理用户生成的数据的最佳做法是什么？

我不是在寻求法律建议，我也不认为这是一个法律问题，而是在用户、其他用户和网站之间取得平衡的问题，因为可以在达到平衡后制定使用条款. 当用户删除其帐户时，应考虑以下一些情况：

*   用户之间的私人消息 - 是否应该删除对话线索？如果是这样，您如何解释需要法律证据的骚扰案件？
*   论坛问题或答案 - 如果用户提出问题，是否应该删除整个线程？如果他们回答问题，是否应该删除答案？

我在将用户帐户实施到 CMS 时问这个问题。我知道 Facebook 最近在更改使用条款时遇到了[麻烦](http://www.readwriteweb.com/archives/facebook_launches_bill_rights_reverts_terms.php)，但是您如何平衡删除的愿望与其他参与其中的用户的需求和投资？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-28T23:12:04.153

一般来说，对于数据库，您很少删除任何内容。您可以将其标记为已删除，但一般来说，您至少会在数据库中保留一段时间。

这件事情是由很多原因导致的。其中一些是合法的。您可能需要在给定期间保留数据。其中一些是技术性的。有时它只是一种保障。您可能需要恢复信息。用户可能会要求重新打开他们的帐户，或者它可能由于垃圾邮件而被锁定，但那是因为该帐户已被盗用并且现在已经恢复。

旧数据可能会被删除或存档，但这可能需要几个月甚至几年的时间。

就我个人而言，我只是给相关数据一个状态列（例如 1 = 活动，0 = 已删除），然后在 99% 的时间里只更改状态而不是删除它。

数据完整性是这里的另一个问题。让我给你举个例子。

假设您有两个实体：

```
User: id, nick, name, email
Message: id, sender_id, receiver_id, subject, body 
```

您要删除特定用户。您如何处理他们发送和接收的消息？这些消息将出现在其他人的收件箱或已发送的项目中，因此您无法删除它们。您是否将 Message 中的相关字段设置为 NULL？这也没有多大意义，因为该消息确实来自（或去往）某人，即使他们不再活跃。

您最好将该用户标记为已删除并保留它们。它使这种情况和类似情况更容易处理。

您还提到了论坛主题等。您也不能删除它们（除非有其他原因，例如垃圾邮件或滥用），因为它们是与其他内容相关的内容（例如已回复的论坛消息）。

您可以安全合理地删除的唯一数据是子数据。这确实是聚合和组合之间的区别。上面的用户和消息关系是聚合。组合的一个例子是房子和房间。你删除一个房子，所有的房间都去。没有房子，房间就不能存在。这是组合，或者，在实体关系术语中，是父子关系。

但是你会发现聚合的实例比组合的多（根据我的经验），所以问题就变成了：你如何处理这些数据？不删除不应该删除的东西，真的很难抹去某人的所有痕迹。只需将它们标记为已删除、锁定或非活动状态并以这种方式处理即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T23:19:23.027

您可以将用户标记为已删除，然后每当您显示涉及该用户的任何内容时，您都会将名称显示为“前用户”或其他内容。

这可以保护已离开用户的身份，而不会破坏您的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T23:40:44.693

您应该保留所有内容并将用户标记为已删除，这样其他用户将无法看到他或她的个人资料、用户名等。然后另一个用户应该能够以相同的名称注册（因为它应该变得免费）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T15:16:13.250

很长一段时间以来，我一直在思考同样的问题。老实说，如果其他人为此付出了时间和精力，那么您不应该删除由要删除的用户发起的线程。我记得在一个论坛上有一条规则，在帖子发布 11 小时后，您不能删除您的帖子。我猜背后的想法是，在你发音之后你不能收回你的话。

因此，最好锁定帐户，但不要级联删除与用户相关的任何内容。

特别是，这样他们就可以删除他们的帐户，然后以相同的名称注册并重新开始。

# .net - 在自己的线程中运行连续进程的最佳方法是什么？

> ID：693729
> 
> 赞同：3
> 
> 时间：2009-03-28T23:08:18.030
> 
> 标签：.net, multithreading

我创建了一个应用程序，它必须使用线程定期执行一些任务。我不确定这是否是最好的方法，所以如果有人能提出更好的方法，我将不胜感激。

我就是这样做的：

这是一个包含连续过程功能的类（寻找非活动会话和清理空闲项目）：

```
public class SessionCleaner
{
    private SQLWorks sqlWorks;
    public SessionCleaner()
    {
        sqlWorks = new SQLWorks();
    }

    private void cleanIdleSessions()
    {
        //this function deletes sessions from database
        sqlWorks.CleanIdleSessions(10);
    }

    //this is an endless loop for executing the cleaning every 5 seconds
    public void DoCleanIdleSessions()
    {
        while(true)
        {
            cleanIdleSessions();
            Thread.Sleep(5000);
        }
    }
} 
```

这是线程初始化的主要形式：

```
public partial class FormMain : Form
{

...
public FormMain()
    {
        InitializeComponent();
...
        startSessionCleaner();
...
    }

private void startSessionCleaner()
    {
        initializeSessionCleanerThread();
        sessionCleanerThread.Start();
    }

private void initializeSessionCleanerThread()
    {
        sessionCleaner = new SessionCleaner();
        sessionCleanerThread = new Thread(new ThreadStart(sessionCleaner.DoCleanIdleSessions));
    }

private void terminateSessionCleanerThread()
    {
        try
        {
            sessionCleanerThread.Join(1000);
        }
        catch(Exception ex)
        {
            string sDummy = ex.ToString();
        }
    }

private void FormMain_FormClosing(object sender, FormClosingEventArgs e)
    {
        terminateSessionCleanerThread();
    } 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T23:20:00.093

我能看到的最大问题是……它为什么会退出？你做了 a `Join`，所以显然期望它终止，但 is is just `while(true)`。我将在某处（在 上`SessionCleaner`）有一个（易失性）布尔字段，该字段被设置/清除并用于`while`- 例如：

```
volatile bool keepRunning = true; 
```

或类似的（`false`在调用`Join`退出之前将其设置为）。

我也认为保留对的引用没有多大意义`sessionCleanerThread`（只需初始化并以一种方法启动它），并且异常吞咽可能是一个坏主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T23:51:40.797

显然，如 Marc 所述，terminateSessionCleanerThread() 方法将永远不会返回。除非有我们看不到的东西。

有一个关于使用 new Thread() 与 ThreadPool.QueueUserWorkItem()的[相关问题。](https://stackoverflow.com/questions/684640/advantage-of-using-thread-start-vs-queueuserworkitem)在我的猜测中，我认为这个应用程序想要使用 QUWI。没有理由不这样做。new Thread() 将创建一个前台线程。如果线程终止，这无关紧要，但这个应用程序没有必要。

Does the clean really need to run every 5 seconds? Seems like that would make sense on a server, under high load. But in that case a WinForms app seems like the wrong tool for the job. Should be a Windows Service that logs messages to the event log, etc.

# linux - 你能在 64 位机器上编译 32 位 Apache DSO（Oracle HTTP 服务器）吗？

> ID：693733
> 
> 赞同：1
> 
> 时间：2009-03-28T23:10:56.823
> 
> 标签：linux, oracle, apache, 32bit-64bit

我已将 Oracle 数据库和 Oracle HTTP 服务器安装从 32 位机器迁移到 64 位机器——两台机器都运行 Linux。Oracle 数据库是 64 位的，但 (Apache) HTTP 服务器是 32 位的。

我使用了一些非 Oracle DSO（一个是 mod_ntlm），但是每当我运行标准的“make install”类型的东西时，我最终都会得到一个 64 位模块。

是否有在 64 位机器上编译 32 位 Apache 模块的标准方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-28T23:51:32.280

作为 Andrew Medico 答案的替代方案，在 PPC 或 SPARC 或 Intel 机器上使用 ' `-m32`' 进行 32 位编译和 ' `-m64`' 进行 64 位编译 - 因为您实际上并没有提及您正在使用哪种芯片架构并且该符号适用所有这些。

我经常使用：

```
CC="gcc -m32" ./configure 
```

确保 32 位编译（或者，更频繁地，`CC="gcc -m64"`确保 64 位编译）。

* * *

问题：“CC 是 make 使用的环境变量吗？”

答：是的，虽然在这种情况下，它也被 识别`configure`，这是一个由 生成的 shell 脚本`autoconf`。我使用的符号 - 这是我在命令行中使用的 - 在`configure`命令运行时在环境中设置 CC。另一个答案建议使用：

```
./configure CC="gcc -m32" 
```

我认为它可以工作并达到几乎相同的效果；我没有尝试过，所以我不知道它是否有效。

如果您运行`./configure --help | less`，您将看到有关如何使用脚本的信息（通常只是标准信息）。最后，它会列出（一些）相关的环境变量，其中 CC 就是其中之一。

将 C 编译器设置为“gcc -m32”的好处是每次使用编译器时都会设置 32 位标志 - 出错的空间很小。如果设置标志变量（CFLAGS 等），则有可能某些命令不会使用它，然后事情可能会出错。

另外，回到这个问题，`make`当然使用了一个名为 CC 的变量（宏）。您可以在 make 命令行上进行设置：

```
make CC="gcc -m32" 
```

这会覆盖 makefile 中的任何设置。相比之下，使用环境变量，makefile 中的设置会覆盖环境中的值，因此将 CC 设置为环境变量的帮助较小。尽管`make -e`环境优先于 makefile，但它通常是一个危险的选择 - 它可能会产生意想不到的副作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-28T23:36:18.433

```
./configure CFLAGS="-march=i686" 
```

应该这样做

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T16:03:14.143

与 gcc 中的 -m32 标志一起，如果您同时拥有 32 位和 64 位库，您可能需要为 ld 包含 -melf_i386 标志以正确地将 32 位目标文件链接到 32 位库。64 位 linux 机器上的标准 ld 将默认为 64 位库，并且在发生链接时会出现兼容性错误。

# iphone - 您可以设置代码在收到短信时触发吗？

> ID：693739
> 
> 赞同：0
> 
> 时间：2009-03-28T23:14:23.540
> 
> 标签：iphone

我对 iOS SDK 还是很陌生。是否可以挂钩接收到的短信事件？例如，在收到文本消息时显示图像。

无法在文档中找到它，所以我假设没有，但想在我把它从我的列表中划掉之前仔细检查一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-28T23:40:32.760

这是不可能的。不多说了。

# python - VBox 的 Python 模块？

> ID：693752
> 
> 赞同：2
> 
> 时间：2009-03-28T23:20:16.957
> 
> 标签：python, virtualbox

我想制作一些 python 脚本来使用 VirtualBox 创建一个“设备”。但是，我在任何地方都找不到任何有关调用 VBoxService.exe 的文档。好吧，我找到了可以在机器外部工作的东西，但在机器内部工作却没有。

有人对这个有了解吗？如果有像 C 这样的另一种语言的库，我会接受它，尽管 Python 会更受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T09:13:21.213

考虑使用[libvirt](http://www.libvirt.org)。VirtualBox 支持是最前沿的（不在任何版本中，甚至可能还没有在源代码控制中，但在邮件列表中作为一组补丁提供）——但是这个单一的 API 可用于 C、Python 和其他几个语言，可让您控制在 Qemu/KVM、Xen、LXC（Linux 容器）、UML（用户模式 ​​Linux）、OpenVZ 等中运行的虚拟机和映像。

我使用带有 qemu/KVM 后端的 libvirt 构建和管理虚拟设备（在自动化 QA 环境中），它很好地满足了我的需求。

libvirt 可以配置为允许远程访问（例如从其中一个 VM 中控制或查询 VBoxService 或 libvirtd，您似乎想要这样做——尽管我质疑智慧和实用程序），并提供多种身份验证和传输选项。

[警告：libvirt 主要针对类 Unix 操作系统；它可以为win32构建，但是YMMV]

# c# - 如何向 Internet Explorer 添加自定义工具栏按钮？

> ID：693761
> 
> 赞同：2
> 
> 时间：2009-03-28T23:26:21.140
> 
> 标签：c#, internet-explorer, add-in

如何向 IE 添加一个简单的工具栏按钮以获取当前 url 并重定向到另一个 url？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T23:32:48.783

*   [使用 Internet Explorer 可扩展性启动](http://blogs.msdn.com/ie/archive/2005/09/06/461675.aspx)
*   在 MSDN[添加工具栏按钮](http://msdn.microsoft.com/en-us/library/aa753588.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T21:04:14.387

如果您不想深入了解所有 IE 扩展内容，您可以使用小书签并使用 javascript 来获得您正在寻找的相同行为：

```
javascript:if(location.href="http://www.google.com"){ location.href="http://www.yahoo.com"} 
```

这也具有在许多不同浏览器上工作的优势。

[书签信息](http://www.mvps.org/dmcritchie/ie/bookmarklets.htm)

# c# - Visual Studio 项目中的二进制依赖项

> ID：693765
> 
> 赞同：3
> 
> 时间：2009-03-28T23:28:28.733
> 
> 标签：c#, visual-studio-2008, build, binary

我的 c# 解决方案有一个本地二进制依赖项，它包含在 Debug 和 Release 变体中，我试图弄清楚如何最好地组织它，以便（1）它最终出现在构建输出中，并在运行时找到单元测试 (2) 它位于源代码控制中的 checkout 目录下 (3) 为每个构建配置复制正确的变体（调试/发布）

我在看

```
Solution  
    Libs  
        MyLibrary  
            Debug/x86/foo.dll  
            Release/x86/foo.dll   
    MyProject  
        src/com/acme/MyApplication.cs 
```

MyProject 引用 MyLibrary

我希望构建文件夹看起来像：

```
Solution/MyProject/bin/Debug/  
    x86/foo.dll <-- copied from MyLibrary/Debug  
    MyApplication.exe  
Solution/MyProject/bin/Release/
    x86/foo.dll <-- copied from MyLibrary/Release  
    MyApplication.exe 
```

我正在尝试在没有自定义 msbuild 文件的情况下执行此操作 - 理想情况下，一切都将从解决方案和项目文件构建。

任何人都有想法如何做到这一点？（或建议如何重组来源以实现类似的目标？）

我有几个这样的库，所以将它们分成两个（Library_Debug、Library_Release）并不是一个真正的选择。

任何帮助表示赞赏；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T02:55:47.283

您可以将构建前和构建后步骤添加到您的解决方案中。我不记得确定您是在进行调试还是发布构建的机制，但是您应该能够设置依赖项，使它们指向临时目录，并复制到适当的集合中的dll。

# flash - BasicView 和 CameraType.SPRING 的问题

> ID：693774
> 
> 赞同：0
> 
> 时间：2009-03-28T23:33:15.163
> 
> 标签：flash, actionscript-3, papervision3d, pv3d

在 Papervision 2.0 中使用 BasicView 类，编译时出现错误：

> 1119：通过静态类型 Class 的引用访问可能未定义的属性 SPRING。

如果我注释掉该静态属性的访问并手动添加常量值，它会按预期工作：

```
case "Spring": //CameraType.SPRING:
    _camera = new SpringCamera3D();
    _camera.target = DisplayObject3D.ZERO;      
    break; 
```

这是在`CameraType`类中定义的位置：

```
/*
 * the SPRING constant defines a SpringCamera3D
 */
public static var SPRING        :String = "Spring"; 
```

关于什么会导致这种情况发生的任何想法？我的第一个猜测是与另一个 static/const var 发生冲突，因为我遇到了类似 Actionscript 冲突的问题。也许这个 ASCollada 类（也在 PV 库中）：

```
public static const DAE_SPRING_ELEMENT:String = "spring"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T00:19:10.950

不直接与 pv3d 相关，但可以提供帮助……这听起来更像是旧版本和新版本之间的冲突。您是否引用了两个并发版本/类路径。我遇到过这样的问题，忘记删除包含与导入的类相同（但略有不同）的类的 SWC。

# asp.net - 在动态数据中设置服务字段值

> ID：693776
> 
> 赞同：3
> 
> 时间：2009-03-28T23:33:39.953
> 
> 标签：asp.net, linq-to-sql, dynamic-data

在我的项目中，许多表通过 ApplicationId 外键链接到 aspnet_Application 表。我不希望用户查看或编辑它，所以我正在寻找在执行插入查询之前预设此 sql 表字段值的方法。我仍然为此列启用了脚手架（以便 DD 生成正确的 sql 脚本），但我在所有编辑/列表/插入页面中隐藏了此列/字段。

理想情况下，我正在为我的 LinqToSql 类中的任何表执行 DynamicInsert 之前寻找一个注入代码的地方。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T04:07:52.570

因此，经过一番挖掘，我想出了一个可以接受的解决方案。我为我的数据上下文创建了一个部分类，并为每个链接到*aspnet_Applications的表添加了一个部分**Insert_*方法。在每种方法中，我都将*ApplicationId*字段设置为当前应用程序 ID。

 **它看起来像这样：

```
public partial class MyDataContext
{
    partial void InsertMyTable(MyTable instance)
    {
        instance.ApplicationId = HttpContext.Current.Session["ApplicationId"] as Guid?;
    this.ExecuteDynamicInsert(instance);
    }
} 
```

**请注意，在此方法中您不能执行其他 LINQ 语句。特别是我必须将应用程序 ID 存储在会话中，而不是查询*aspnet_Applications*表。**

虽然这是可以接受的解决方案，但它并不完美（大量重复的代码），所以如果有人知道更好，请在这里给我一个骨头:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T09:46:06.017

将来最好的解决方案是使用刚刚在 MIX09 发布的 .Net RIA 服务预览版的 DomainService 部分，请参阅此处的视频：

[.NET RIA 服务 - 使用 Microsoft Silverlight 和 Microsoft ASP.NET 构建数据驱动的应用程序](http://videos.visitmix.com/MIX09/T41F)

[Microsoft ASP.NET 4.0 数据访问：Web 表单的成功模式](http://videos.visitmix.com/MIX09/T47F)

第一个是从 Silverlight 的角度对 .net RIA 服务的介绍，但它更多地应用于 DD，第二个是 David Ebbo 在 MIX 上的演示，展示了 DomainService 如何与 DD 一起工作我认为这是前进的方向，因为你可以做DomainService 中的所有业务逻辑。

# svn - 从 svn merge 中排除特定用户的提交

> ID：693781
> 
> 赞同：2
> 
> 时间：2009-03-28T23:38:46.493
> 
> 标签：svn, merge

有各种自动化进程提交到我的 svn (1.5) repo。当我从 Trunk 分支并合并时，合并这些提交会导致虚假冲突。有什么简单的方法可以跳过特定用户的提交吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T16:46:10.187

I don't think there is. It would be weird too, as it would potentially corrupt the integrity of the source code. Instead, I'd consider two approaches:

1.  Not doing the automated commits (I haven't run into a situation that required this, but I don't know your usecase well enough)
2.  Resolve the conflicts automatically by scripting something (always taking one version over another for a specific set of files for example)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T04:33:20.433

您可能会考虑为每个“自动化流程”提供自己的存储库。除非这些过程在做有用的（即创造性的）工作，否则我不会将脑死亡的变化与脑力的变化混为一谈。我还没有看到自动化过程非常有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T21:47:49.043

这种情况需要分布式 VCS；svn 不是其中之一。

我会选择 git 或 bazaar （bzr-pqm 是这样做的代理：集成传入的合并）

[http://bazaar-vcs.org/](http://bazaar-vcs.org/)

# c# - 当 MSBuild 可用时，我为什么要继续使用 Nant？

> ID：693782
> 
> 赞同：8
> 
> 时间：2009-03-28T23:40:14.850
> 
> 标签：c#, .net, msbuild, nant

我已经看到了[之前](https://stackoverflow.com/questions/10634/should-i-switch-from-nant-to-msbuild)的问题和答案。在那个问题中，原始发帖人提出了一个后续问题：

> 使用 msbuild 的令人信服的理由是什么？有缺点吗？

我没有看到那个答案。我也想知道反过来。Nant 有哪些引人注目的特点？

我认为，对于 nant 来说，跨平台很大。对于 msbuild，它是与 Visual Studio 的通用和集成。这听起来对吗？还要别的吗？

**编辑/添加**：有人有功能列表比较吗？有人说“nant 有更多开箱即用的功能”。哪个？

把这些项目结合起来，共同努力，互惠互利，有意义吗？有没有人问过 MS，他们是否愿意为社区贡献 msbuild，比如 WiX？有哪些机会？

**EDIT2**：我刚刚找到[了这个先前的讨论](https://stackoverflow.com/questions/476163/nant-or-msbuild-which-one-to-choose-and-when)，不知道为什么我以前找不到它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-28T23:50:11.333

**Nant**具有更多开箱即用的功能，但**MSBuild**具有更好的基本结构（项目元数据岩石），这使得构建可重用的 MSBuild 脚本变得更加容易。

MSBuild 需要一段时间才能理解，但一旦你完成它就会非常好。

学习资料：

*   [在 Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)
    ，作者 Sayed Ibrahim Hashimi（2009 年 1 月）
*   [部署 .NET 应用程序：学习 MSBuild 和 ClickOnce](https://rads.stackoverflow.com/amzn/click/com/B001D25YT6)
    ，Sayed Y. Hashimi（2008 年 9 月）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T08:04:43.920

我只是觉得 NAnt 更容易使用。我敢说这部分是由于我在 Ant 方面的背景，但我发现为 Protocol Buffers 构建一个 NAnt 文件比为 MiscUtil 构建一个 MSBuild 文件要简单*得多。*（即使现在 MiscUtil 构建中有些东西我想包含但不能包含 - 将任务的输出转储到文本文件 IIRC 似乎非常困难。）这些概念更简单，而且似乎在评估文件集合等方面减少陷阱。

我目前喜欢使用我以前认为非常愚蠢的设置 - 我将 NAnt 用于我的“主”构建文件，但调用 MSBuild 来执行实际的“编译我的 .NET 项目”步骤。为同一个项目拥有两个构建系统的想法令人厌恶，但我基本上不会将 MSBuild 部分视为完整的构建系统——它只是一种简单的编译方式，而且我永远不需要手动检查项目文件。（我只通过 Visual Studio 与之交互。）我已经能够以这种方式非常轻松地改进我的 Protocol Buffers 构建，我怀疑如果我使用了 MSBuild，我是否会有同样的体验。

很快，我将尝试使用 Mono 构建它（当 2.4 发布时 - 在那之前 gmcs 中会出现展示停止器），此时我们将看到该策略的可移植性......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T00:47:52.893

您将继续使用 nant，因为您已经在使用它。如果您使用的是 msbuild，并且想知道为什么要切换到 nant，那么答案是没有真正的理由来切换。至少你知道 msbuild 不会继续，nant 自 2007 年 12 月以来就没有更新过。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T01:21:49.163

考虑到 NAnt 基于 Ant for Java，可能有足够的理由继续使用它。其他构建工具基于 Ant - Phing 就是其中之一，用于 PHP。当我开始使用该工具时，我很快就学会了它，因为我已经熟悉了 NAnt。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-29T02:27:00.643

我们使用混合方法，因为我们在 MS-Build 可用之前就开始使用 NANT。但是，MS-Build cna 在不依赖的项目上执行并行构建，这可以在适当的情况下显着减少构建时间。让 NANT 与 SVN 交互、部署和仅让 MS-build 进行编译将我们的构建时间缩短了约 45% YMMV，具体取决于您构建 sln 的方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-29T11:06:48.710

想到的几点：

*   如果您使用的是 Windows Workflow Foundation，则必须使用 msbuild（编译 *.xoml 文件，对于 WPF 可能也是如此）
*   如果您使用[wix](http://wix.sourceforge.net/)来构建 setup .msi 文件，您可以使用 VisualStudio 或 msbuild 来编译 wix 脚本（如果出现错误，VS 可以跳转到 wix 脚本中有问题的行）
*   msbuild 允许您拥有与开发/Visual Studio 环境非常相似的构建环境（例如，当使用 msbuild 构建 postbuild 事件时，您不必手动维护 *.cs 文件列表到 csc 任务，... )

在我工作的地方，我们目前正在使用 NAnt 脚本和来自 NAntContrib的[msbuild任务。](http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html)

# security - TFS 安全性

> ID：693786
> 
> 赞同：4
> 
> 时间：2009-03-28T23:41:02.227
> 
> 标签：security, tfs

任何人都有关于为安全环境强化/配置 TFS 的信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T01:07:35.653

TFS 使用 Windows 身份验证，因此它与您的网络一样安全。我建议您还查看有关加强网络安全性的资源。

[Team Foundation Server 安全概念](http://msdn.microsoft.com/en-us/library/ms253184(VS.80).aspx)

[Team Foundation Server 安全架构](http://msdn.microsoft.com/en-us/library/ms252473(VS.80).aspx)

[用户和组的 Team Foundation Server 安全性](http://msdn.microsoft.com/en-us/library/ms252512(VS.80).aspx)

[使用 HTTPS 和安全套接字层 (SSL) 保护 Team Foundation Server](http://msdn.microsoft.com/en-us/library/aa395265(VS.80).aspx)

[Team Foundation Server 权限和安全性疑难解答](http://msdn.microsoft.com/en-us/library/ms400712.aspx)

如果您还没有看过它，TFS 带有一个命令行安全工具，[TFSSecurity.exe](http://msdn.microsoft.com/en-us/library/ms252504.aspx)

# c - 使用 C void 参数“void foo(void)”还是不使用“void foo()”更好？

> ID：693788
> 
> 赞同：246
> 
> 时间：2009-03-28T23:44:29.940
> 
> 标签：c, void

什么更好：`void foo()`或`void foo(void)`？使用 void 它看起来丑陋且不一致，但有人告诉我它很好。这是真的？

编辑：我知道一些旧的编译器会做一些奇怪的事情，但是如果我只使用 GCC，可以`void foo()`吗？那么会`foo(bar);`被录取吗？

* * *

## 回答 #1

> 赞同：302
> 
> 时间：2009-03-28T23:48:30.727

```
void foo(void); 
```

这是在 C 中说“无参数”的正确方式，它也适用于 C++。

但：

```
void foo(); 
```

在 C 和 C++ 中意味着不同的东西！在 C 中，它的意思是“可以采用任意数量的未知类型的参数”，而在 C++ 中，它的意思与`foo(void)`.

可变参数列表函数本质上是非类型安全的，应尽可能避免使用。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2009-03-29T00:41:48.713

C语言中指定参数的方式有两种，一种是使用标识符列表，另一种是使用参数类型列表。标识符列表可以省略，但类型列表不能。因此，要说一个函数在函数定义中不接受任何参数，您可以使用（省略的）标识符列表来执行此操作

```
void f() {
    /* do something ... */
} 
```

这带有参数类型列表：

```
void f(void) {
    /* do something ... */
} 
```

如果在参数类型列表中唯一的一个参数类型是 void（那么它必须没有名称），那么这意味着该函数不接受任何参数。但是这两种定义函数的方式在它们声明的内容上有所不同。

### 标识符列表

第一个定义该函数采用特定数量的参数，但既没有传达计数也没有传达所需的类型 - 就像所有使用标识符列表的函数声明一样。所以调用者必须事先知道类型和计数。因此，如果调用者调用给它一些参数的函数，则行为是未定义的。例如，堆栈可能会损坏，因为被调用的函数在获得控制权时需要不同的布局。

不推荐在函数参数中使用标识符列表。它在过去被使用，并且仍然存在于许多生产代码中。由于这些参数提升，它们可能会导致严重的危险（如果提升的参数类型与函数定义的参数类型不匹配，那么行为也是未定义的！）当然，安全性要低得多。因此，在函数的唯一声明和定义中，始终将`void`thingy 用于不带参数的函数。

### 参数类型列表

第二个定义该函数接受零个参数并且也进行通信 - 就像所有使用参数类型列表声明函数的情况一样，该列表称为 a `prototype`。如果调用者调用函数并给它一些参数，那就是一个错误，编译器会吐出一个适当的错误。

声明函数的第二种方式有很多好处。其中之一当然是检查参数的数量和类型。另一个区别是因为编译器知道参数类型，它可以将参数的隐式转换应用到参数的类型。如果不存在参数类型列表，则无法完成，并且参数将转换为提升类型（这称为默认参数提升）。例如，将变为 ，而`char`将变为。`int``float``double`

### 函数的复合类型

顺便说一句，如果文件同时包含省略的标识符列表和参数类型列表，则参数类型列表“获胜”。最后的函数类型包含一个原型：

```
void f();
void f(int a) {
    printf("%d", a);
}

// f has now a prototype. 
```

那是因为这两个声明都没有说任何矛盾的东西。然而，第二个还有话要说。这是一个论点被接受。可以反过来做同样的事情

```
void f(a) 
  int a;
{ 
    printf("%d", a);
}

void f(int); 
```

第一个使用标识符列表定义函数，而第二个使用包含参数类型列表的声明为其提供原型。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-03-28T23:46:12.840

`void foo(void)`更好，因为它明确表示：不允许参数。

`void foo()`意味着您可以（在某些编译器下）发送参数，至少如果这是您的函数的声明而不是它的定义。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-03-29T18:35:57.647

**C99 报价**

本答案旨在引用和解释[C99 N1256标准草案](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)的相关部分。

**声明者的定义**

*声明符*这个词会出现很多，所以让我们理解它。

从语言语法中，我们发现以下下划线字符是声明符：

```
int f(int x, int y);
    ^^^^^^^^^^^^^^^

int f(int x, int y) { return x + y; }
    ^^^^^^^^^^^^^^^

int f();
    ^^^

int f(x, y) int x; int y; { return x + y; }
    ^^^^^^^ 
```

声明符是函数声明和定义的一部分。

有两种类型的声明符：

*   参数类型列表
*   标识符列表

**参数类型列表**

声明看起来像：

```
int f(int x, int y); 
```

定义如下：

```
int f(int x, int y) { return x + y; } 
```

它被称为参数类型列表，因为我们必须给出每个参数的类型。

**标识符列表**

定义如下：

```
int f(x, y)
    int x;
    int y;
{ return x + y; } 
```

声明看起来像：

```
int g(); 
```

我们不能声明具有非空标识符列表的函数：

```
int g(x, y); 
```

因为*6.7.5.3“函数声明符（包括原型）”*说：

> 3 函数声明器中不属于该函数定义的标识符列表应为空。

之所以称为标识符列表，是因为我们只给出标识符`x`，然后`y`是`f(x, y)`类型。

这是一种较旧的方法，不应再使用。*6.11.6 函数声明器*说：

> 1 使用带空括号的函数声明符（不是原型格式参数类型声明符）是一个过时的特性。

*简介*解释了什么是*过时的功能*：

> 某些特性已经过时，这意味着它们可能会在本国际标准的未来修订版中被考虑撤销。由于它们的广泛使用，它们被保留，但不鼓励在新实现（用于实现特性）或新程序（用于语言 [6.11] 或库特性 [7.26]）中使用它们

**f() vs f(void) 用于声明**

当你只写：

```
void f(); 
```

它必须是一个标识符列表声明，因为*6.7.5 “Declarators”*将语法定义为：

```
direct-declarator:
    [...]
    direct-declarator ( parameter-type-list )
    direct-declarator ( identifier-list_opt ) 
```

所以只有标识符列表版本可以为空，因为它是可选的（`_opt`）。

`direct-declarator`是唯一定义`(...)`声明符括号部分的语法节点。

那么我们如何消歧和使用没有参数的更好的参数类型列表呢？*6.7.5.3 函数声明器（包括原型）*说：

> 10 void 类型的未命名参数作为列表中唯一的项目的特殊情况指定函数没有参数。

所以：

```
void f(void); 
```

就是这样。

这是一种明确允许的神奇语法，因为我们不能`void`以任何其他方式使用类型参数：

```
void f(void v);
void f(int i, void);
void f(void, int); 
```

**如果我使用 f() 声明会发生什么？**

也许代码会编译得很好：*6.7.5.3 函数声明符（包括原型）*：

> 14 不属于该函数定义的函数声明器中的空列表指定不提供有关参数数量或类型的信息。

所以你可以逃脱：

```
void f();
void f(int x) {} 
```

其他时候，UB 会爬起来（如果你幸运的话，编译器会告诉你），你将很难弄清楚原因：

```
void f();
void f(float x) {} 
```

请参阅：[为什么空声明适用于具有 int 参数的定义，但不适用于 float 参数？](https://stackoverflow.com/questions/5481579/whats-the-difference-between-function-prototype-and-declaration)

**f() 和 f(void) 用于定义**

```
f() {} 
```

对比

```
f(void) {} 
```

相似，但不相同。

*6.7.5.3 函数声明器（包括原型）*说：

> 14 作为该函数定义的一部分的函数声明器中的空列表指定该函数没有参数。

这看起来类似于 的描述`f(void)`。

但*仍然......*似乎：

```
int f() { return 0; }
int main(void) { f(1); } 
```

符合未定义的行为，而：

```
int f(void) { return 0; }
int main(void) { f(1); } 
```

是不符合的，如讨论：[为什么 gcc 允许将参数传递给定义为没有参数的函数？](https://stackoverflow.com/questions/12643202/why-does-gcc-allow-arguments-to-be-passed-to-a-function-defined-to-be-with-no-ar)

TODO 明白为什么。与是否是原型有关。定义原型。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-04-29T11:20:13.113

除了句法上的差异，许多人还`void function(void)`出于实际原因更喜欢使用：

如果你正在使用搜索功能并想找到该功能的实现，你可以搜索`function(void)`，它会返回原型以及实现。

如果省略`void`，则必须搜索`function()`并因此也会找到所有函数调用，从而更难找到实际的实现。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-05-11T07:39:31.540

在 C++ 中，和**没有**区别。`main()``main(void)`

**但**在 C 中，`main()`将使用*任意*数量的参数调用。

例子：

```
main (){
    main(10, "abc", 12.28);
    // Works fine!
    // It won't give the error. The code will compile successfully.
    // (May cause a segmentation fault when run)
} 
```

`main(void)`将在*没有*任何参数的情况下调用。如果我们尝试传递它，那么最终会导致编译器错误。

例子：

```
main (void) {
     main(10, "abc", 12.13);
     // This throws "error: too many arguments to function ‘main’ "
} 
```

# sql - SQL查询中表的整个列的平均值，计数等或作为VBA中的函数以在表单中显示结果？

> ID：693796
> 
> 赞同：1
> 
> 时间：2009-03-28T23:48:43.393
> 
> 标签：sql, ms-access, vba

作为查询的结果，我需要计算列的计数、平均值和其他一些东西，然后将结果放在表单中的文本框中。

我正在考虑在查询中实现它并将结果放在一列或类似的东西中，或者使用 VBA 函数来计算它；但是我不知道如何为 VBA 中的整个列计算这个。

有什么建议/例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T14:34:37.203

实际上我发现这在 VBA 中很容易。我不想在我的查询中添加另一个字段，所以我这样做了：

```
Forms!MyForm!AvgTextBox = Avg([mytable.values2Baveraged])
Forms!MyForm!CountTextBox = Count([mytable.values2Bcounted]) 
```

这将计算整个列上的函数。这非常有效，以防万一有人关心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T00:59:04.007

您是否考虑过域聚合函数？这些大致采用以下形式：

```
DAvg("SomeField","SomeTable","Where Statement, If Required")
DCount("*","SomeTable") 
```

您可以将控件的 Control Soirce 设置为函数，但域聚合函数可能不适合大型记录集。

另一种方法是使用记录集：

```
 Dim rs As DAO.Recordset
 Set rs = CurrentDB.OpenRecordset("SELECT Count(*) As CountAll " _
        & "FROM SomeTable")

 Me!txtTextBox=rs!CountAll 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T02:28:58.937

您应该在 SQL 查询中执行此操作。像这样的聚合操作是 SQL 擅长的。它将为您提供最佳性能并成为最简单的解决方案。

# matlab - 逆时针从V1到V2怎么判断V3是否在V1和V2之间？

> ID：693806
> 
> 赞同：6
> 
> 时间：2009-03-28T23:52:23.870
> 
> 标签：matlab, vector, geometry, angle

我有三个向量 V1、V2 和 V3。它们的原点位于轴的原点上。当我从 V1 逆时针移动到 V2 时，如何确定 V3 是否在 V1 和 V2 之间？

[替代文字 http://www.freeimagehosting.net/uploads/1448ea8896.jpg](http://www.freeimagehosting.net/uploads/1448ea8896.jpg)

无法通过获取它们的角度并评估这些条件（伪代码）来完成：

```
if angle(V3) > angle(V1) && angle(V3) < angle(V2) 
   printf("V3 is between V1 and V2") 
else 
   printf("out of the interval") 
```

要查看它的缺陷，假设`angle`函数给出的角度在 [-pi pi] 的范围内。因此，如果 angle(V1) = 120 (in degree), angle(V2) = -130 and angle(V3) = 150 那么答案（根据上面的代码）是“超出区间”，尽管如果你四处走动从 V1 到 V2 逆时针，它在它们之间。

您可能会建议将 2*pi 添加到 angle(V2) 或类似的东西，但我已经尝试过这样的事情并且它不起作用。

我正在用 MATLAB 编程。

编辑 1：它是 2D 的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-29T01:51:26.190

由于您在 MATLAB 中执行此操作，因此这是一种应该可行的解决方案：

```
crossProds = [V1(1)*V2(2)-V1(2)*V2(1) ...
              V1(1)*V3(2)-V1(2)*V3(1) ...
              V3(1)*V2(2)-V3(2)*V2(1)];
if (all(crossProds >= 0) || ...
    (crossProds(1) < 0) && ~all(crossProds(2:3) < 0)),
  disp("V3 is between V1 and V2");
else
  disp("out of the interval");
end 
```

**解释：**

二维向量**V1**和**V2**之间的叉积存储在**crossProds**的第一个元素中。**如果V1**和**V2**之间的逆时针角度在 0 到 180 度之间（包括 0 到 180 度），则该值将大于或等于 0。在这种情况下，当**V3**在逆时针方向上位于**V1**和**V2之间时，叉积****(V1,V3)**和**(V3,V2)**也大于或等于零。这解释了第一个逻辑检查：

```
all(crossProds >= 0) 
```

**如果V1**和**V2**之间的逆时针角度大于 180 度，则这两个向量的叉积将小于零。在这种情况下，当**V3**在*顺时针*方向上位于**V1**和**V2**之间时，叉积**(V1,V3)**和**(V3,V2)**也小于零。因此，如果这些叉积*不*小于零，则**V3**必须在逆时针方向*上位于***V1**和**V2**之间。这解释了接下来的两个逻辑检查：

 *********```
(crossProds(1) < 0) && ~all(crossProds(2:3) < 0) 
```

上述逻辑检查应涵盖所有可能的情况。运营商 || 和 && 是MATLAB 中的[短路运算符](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/logicaloperatorsshortcircuit.html)：如果不需要，它们将跳过第二个语句。例如，如果 OR 中的第一个语句为真，则没有理由检查第二个语句，因为 OR 中只需要一个参数为真，结果为真。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T00:01:27.780

计算角度（V1），角度（V2）和角度（v3）（a1，a2，a3）。

修改 a2 和 a3（如果需要，添加 2*pi），以便

```
a1 <= a2 < a1 + 2*pi
a1 <= a3 < a1 + 2*pi 
```

现在您只需比较 a2 和 a3。V3 介于 V1 和 V2 之间，导致 a3 不如 a2。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-29T02:59:21.097

V1 是一个红鲱鱼。你只会让自己同时考虑 3 个角度而感到困惑。

2.  将所有内容顺时针旋转角度（V1）
3.  将剩余的两个角度归一化为 [0,360)

现在的问题只是比较范数（角度（V2）-角度（V1））和范数（角度（V3）-角度（V1））。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-06T13:47:21.210

对于大多数其他编程语言来说，这种方法更简单一些。

如果给定 V1、V2 和 V3 向量，我们需要确定天气 V3 在 V1 和 V2 之间，并且 Ri = atan2(Vi)（返回从 -pi 到 pi 的弧度角）：

**顺时针**：

```
R1 -= R3;
R2 -= R3;

if (R1 < 0) R1 += 2 * PI;
if (R2 <= 0) R2 += 2 * PI;

return (r1 < r2); 
```

对于**逆时针**，只需交换 R1 和 R2。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-29T00:55:22.703

要测试这种情况，您必须计算两个三角形的绕组：

1.  由 V1、原点和 V3 组成的三角形。这个三角形必须是逆时针的。

2.  由 V3、原点和 V2 组成的三角形。这个三角形也必须是逆时针的。

要测试三角形的缠绕，检查顶点的 2D 叉积的符号就足够了。

测试看起来像这样（抱歉 - C 代码）：

```
int IsBetween (vector v1, vector v2, vector v3)
{
  float winding1 = (v1.x * v3.y - v1.y * v3.x);
  float winding2 = (v3.x * v2.y - v3.y * v2.x);

  // this test could be exactly the wrong way around. This depends
  // on how you define your coordinate system (e.g. is Y going up or down?)

  if ((winding1 <0) && (winding2 < 0))
  {
    printf ("V3 is between them\n");
  }
  else
  {
    printf ("it's not\n");
  }
} 
```

# php - 返回两个数组时如何选择数组的特定部分？

> ID：693807
> 
> 赞同：0
> 
> 时间：2009-03-28T23:52:24.477
> 
> 标签：php, arrays

在一个while循环中，我有：

```
$row = mysql_fetch_array($result) 
```

下面`$row`是两个数组，当使用`print_r`显示以下内容显示时：

```
Array
(
[4] => Post Content
[value] => Post Content
)

Array
(
[4] => Post Title
[value] => Post Title
) 
```

如何从数组中选择“发布内容”和“发布标题”而不在 while 循环中重复？

这个问题的原始版本将重复与问题混淆了。问题是如何在第二个数组`[value]`都保存在`$row`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T08:38:57.973

您还可以确保不会使用 mysql_fetch_assoc() 或 mysql_fetch_row() 将值插入两次。
因此：

```
$row = mysql_fetch_assoc($result);
Array
(
['value'] => Post Content
)

Array
(
['value'] => Post Title
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T00:05:24.853

你想确保一个数组只有[唯一的](http://php.net/array_unique)值吗？如果这不适用于数组中的数组，那么它是经典的重复数据删除，存储您已经看到的内容。

```
$dedupedValues = array()
foreach ($row as $items) {
    if (! is_set($dedupedValues[$items['value']])) {
        $dedupedValues[$items['value']] = true;  // we have this value
        echo "echo the title/value....";
    }

} 
```

另一种选择是改进获取数据的 SQL，以避免首先出现重复（参见：[MySQL 'DISTINCT'](http://www.google.com/search?q=mysql+DISTINCT)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T12:14:01.810

Pim Jager 展示了更好的方法，但如果你坚持使用 mysql_fetch_array()：

```
$i = 0;
$size = count($row);
if ($size > 0) {
  while ($i < floor($size / 2)) {
   ..... = $row[$i];
   $i += 1;
  }
} 
```

编辑：

再次阅读后，我不确定我是否完全理解这个问题。

例如，如果您有嵌套数组：

```
$row = array('data1' => array('orange', 'banana', 'apple'),
             'data2' => array('carrot', 'collard', 'pea')); 
```

然后你想访问每个数组：

```
$data1 = $row['data1'];
// = array('orange', 'banana', 'apple')
$data2 = $row['data2'];
// = array('carrot', 'collard', 'pea')
// OR
$orange = $row['data1'][0];
$banana = $row['data1'][1];
$apple = $row['data1'][2];
$carrot = $row['data2'][0];
// ... so on.. 
```

考虑到这一点，循环看起来像这样：

```
$i = 0;
$size = count($row);
if ($size > 0) {
  while ($i < floor($size / 2)) {
   $something = $row['data1'][$i]; //Or $row[0][$i]; using your example
   $something = $row['data2'][$i]; //Or $row[1][$i]; using your example
   $i += 1;
  }
} 
```

但我真的建议使用 mysql_fetch_assoc() 和 foreach 循环，就像在 Pims Jagers 示例中一样

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T13:11:56.700

最终解决方案是根据 Topbit 的建议对原始查询进行轻微重组并使用两个 while 循环来找到的。

```
while($row_title = mysql_fetch_array($result_title)){
$row_body = mysql_fetch_array($result_body);

    // code
} 
```

感谢所有提出解决方案的人。

# c# - 识别 C# 源代码中的注释

> ID：693812
> 
> 赞同：2
> 
> 时间：2009-03-28T23:57:34.870
> 
> 标签：c#, visual-studio-2008

如何识别 C# 源代码中的注释？我想从评论中检索所有信息。

```
public class TestClass
    {
        /// <summary>
        /// Sample method
        /// </summary>
        /// <param name="a">1 argument</param>
        /// <param name="b">2 argument</param>
        /// <param name="c">3 argument</param>
        /// <returns>true or false</returns>
        /// <exception cref="NotImplementedException">Always throw exception</exception>
        public bool Method(int a, object b, Panel c)
        {
            throw new NotImplementedException();
        }
    } 
```

1.  方法描述 - “示例方法”
2.  参数说明 - “1 个参数，...”
3.  返回值说明 - “真或假”
4.  异常类型和描述
5.  其他用户标签

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T00:00:20.997

最简单的方法是启用 xml 注释生成（项目属性 -> 构建），并解析 xml 文件...

```
<?xml version="1.0"?>
<doc>
    <assembly>
        <name>ClassLibrary2</name>
    </assembly>
    <members>
        <member name="M:TestClass.Method(System.Int32,System.Object,System.Windows.Forms.Panel)">
            <summary>
            Sample method
            </summary>
            <param name="a">1 argument</param>
            <param name="b">2 argument</param>
            <param name="c">3 argument</param>
            <returns>true or false</returns>
            <exception cref="T:System.NotImplementedException">Always throw exception</exception>
        </member>
    </members>
</doc> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T05:49:02.467

如果你真的想获得成功，你可以构建一个解析器。我想这取决于您要实现的目标，原因以及必须投入的资源/时间。如果您要尝试解析 C#，请考虑使用[ANTLR](http://antlr.org/)或其他解析器/编译器生成器。

我跳到了复杂性范围的另一端，但我不知道你的情况，所以它可能是合适的。

如果没有成熟的解析器，注释可能会很棘手。考虑这些边缘情况：

```
// Blah blah // another double slash on the same line.
/* 
 What about multi-line comments? 
*/

/* 
   // What about double-slash comments inside of multi-line comments?
*/ 
```

（而且我只是用这些边缘案例来触及表面）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T00:00:33.867

我不确定您打算如何呈现这些数据，但是有一个名为[nDoc](http://ndoc.sourceforge.net/)的开源项目可以在网页中很好地格式化这些信息。

为了使用 nDoc，您需要在项目设置中启用 xml 输出。这将以 XML 格式获取您的所有评论。

即使您不使用 nDoc，它们也有一些关于启用 XML 输出的很好的[说明](http://ndoc.sourceforge.net/usersguide.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T00:04:55.867

马克的回答是你最好的选择。如果您希望（出于某种原因）手动执行此操作，则需要查找以 /// 开头的连续行，将它们连接起来，然后将该字符串视为 XML。

# php - 当网站部署在主机上时，MySql Insert 不起作用！

> ID：693820
> 
> 赞同：0
> 
> 时间：2009-03-29T00:01:33.660
> 
> 标签：php, mysql, deployment, insert, xampp

我在 Windows 下使用 XAPP，我的网站运行良好！

当我将它部署在主机服务器上时，它似乎工作正常，但是对 MySql 的插入请求没有任何效果，数据库没有任何变化！

以前有人遇到过这个问题吗？MySql 中是否有任何配置使其接受插入请求？或者只是让它发挥作用的最佳方法！

[**编辑**]

**我使用 PhpMyAdmin**，我有两个表**成员**和**通知**，我想配置权限以便我可以插入到**通知**表中，请问有什么提示吗？

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T00:06:58.670

检查数据库服务器上您正在使用的用户名和密码的权限。它也可以通过IP地址等来限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T00:08:07.543

实际上，管理员可以为用户或特定表设置只读权限。查看“ [grant](http://dev.mysql.com/doc/refman/5.1/en/grant.html) ”命令了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T05:53:25.687

如果您能找出 MySQL 返回的错误消息，那将会很有帮助。检查您的 Web 服务器日志文件。如果您使用一些共享主机计划，主机控制面板中应该有一个选项可以查看 Web 服务器日志文件。大多数地方都配置了 PHP，以便将错误消息存储在 Web 服务器日志文件中。找出那里实际发生的事情。它最有可能是权限。

# ruby-on-rails - 格式化时间戳

> ID：693823
> 
> 赞同：22
> 
> 时间：2009-03-29T00:04:19.050
> 
> 标签：ruby-on-rails, formatting, timestamp

如何将 Rails 时间戳格式化为更易于阅读的格式？如果我只是打印出来`created_at`或`updated_at`在我看来是这样的：

```
<% @created = scenario.created_at %> 
```

然后我会得到：

2009-03-27 23:53:38 UTC

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-29T01:42:06.040

（[`strftime`](http://www.ruby-doc.org/core/Time.html#method-i-strftime)来自 Ruby 的 Time）和[`to_formatted_s`](http://apidock.com/rails/Date/to_formatted_s)（来自 Rails 的 ActiveSupport）函数应该能够处理您所有的时间格式化需求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-28T07:54:18.577

看看 I18n 功能。它允许您在视图中执行以下操作：

```
<%= localize(scenario.created_at, :format => :long) %>
```

格式是在您的语言环境中定义的。 [更多信息](https://github.com/rails/rails/blob/1a93e93d1b26a73ed3707b27059542d6efa2cd04/actionpack/lib/action_controller/translation.rb#L8)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-22T13:35:42.117

还

```
<%= l scenario.created_at, :format => :sample) %> 
```

在 locales/en.yml 中（取决于语言）

```
 en:
    time:
      formats:
        sample: '%d.%m.%Y' 
```

要了解更多信息，请参阅 - [http://guides.rubyonrails.org/i18n.html](http://guides.rubyonrails.org/i18n.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-28T07:20:02.540

Time.now().to_i 效果很好。对于反向转换使用 Time.at(argument)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-08T14:06:39.410

您可以使用`strftime`多种方式格式化时间戳。我更喜欢[`some_data[:created_at].strftime('%F %T')`](http://apidock.com/ruby/DateTime/strftime). `%F`显示“2017-02-08”（日历日期延长），并`%T`显示“08:37:48”（当地时间延长）。

对于时区问题，将此行添加到您的`config/application.rb`文件中

```
config.time_zone = 'your_timezone_string'
config.active_record.default_timezone = :local 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-09-18T14:11:43.700

您必须修改时间戳文件，在我的情况下，此文件位于`/usr/local/rvm/gems/ruby-2.0.0-p195/gems/activerecord-4.2.0/lib/active_record/timestamp.rb`. 您必须搜索此行：

```
self.class.default_timezone == :utc ? Time.now.utc : Time.now 
```

并将其更改为：

```
self.class.default_timezone == :utc ? Time.now.utc : Time.now.strftime('%Y-%m-%d %H-%M-%S') 
```

诀窍是使用`strftime`方法修改格式，您可以根据需要更改格式。

现在，rails 将使用您的格式来更新“updated_at”列。

# python - python中两种方式散列的最佳实践？

> ID：693826
> 
> 赞同：2
> 
> 时间：2009-03-29T00:06:00.060
> 
> 标签：python

我希望允许用户通过单击链接来验证他们的电子邮件地址。该链接看起来像

[http://www.example.com/verifyemail?id=some-random-string](http://www.example.com/verifyemail?id=some-random-string)

当我发送这封电子邮件时，我希望能够从用户的行 id（一个整数）轻松生成这个“一些随机字符串”。当用户单击此链接时，生成该整数。

唯一的要求是这个“一些随机字符串”应该对用户尽可能不透明和不可猜测。

* * *

最后，这就是我决定的

```
def p3_encrypt_safe(plain, key):
    return base64.urlsafe_b64encode(p3_encrypt(plain, key)) 
```

[使用来自http://www.nightsong.com/phr/crypto/p3.py](http://www.nightsong.com/phr/crypto/p3.py)的不错的加密库 添加 base64 安全编码是我的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T00:10:10.317

使用加密，这正是它的设计目的。Blowfish、AES，甚至 DES3，如果您不需要特别高的安全性。

或者，您可以计算电子邮件地址的 SHA-256 或 SHA-512（或其他）哈希值，并将其与电子邮件地址本身一起存储在数据库中。这样您就可以使用哈希作为键来查找电子邮件地址。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T08:18:36.820

您最好的选择是生成一些用户数据的散列（单向函数）。例如，要生成用户行 id 的哈希，您可以使用如下内容：

```
>>> import hashlib
>>> hashlib.sha1('3').hexdigest()
'77de68daecd823babbb58edb1c8e14d7106e83bb' 
```

但是，仅基于行 id 的伪随机字符串不是很安全，因为用户可以轻松地反转这样一个短字符串的哈希（尝试[谷歌搜索 77de68daecd823babbb58edb1c8e14d7106e83bb](http://www.google.pl/search?q=77de68daecd823babbb58edb1c8e14d7106e83bb)）。

这里一个简单的解决方案是“加盐”散列字符串，即将相同的秘密字符串添加到每个散列值。例如：

```
>>> hashlib.sha1('3' + 'email@of.user' + 'somestringconstant').hexdigest()
'b3ca694a9987f39783a324f00cfe8279601decd3' 
```

如果你[用谷歌搜索 b3ca694a9987f39783a324f00cfe8279601decd3](http://www.google.pl/search?q=b3ca694a9987f39783a324f00cfe8279601decd3)，可能唯一的结果是这个答案的链接:-)，这不是一个证据，而是一个很好的暗示，这个哈希是非常独特的。

# asp.net - 使用 Profile API 保留自定义注册信息

> ID：693828
> 
> 赞同：0
> 
> 时间：2009-03-29T00:06:29.827
> 
> 标签：asp.net

我已经看到了生成自定义注册控件的示例，该控件将其信息与相应的 Sql Server 中的一些额外字段（或取决于问题的表）一起保存。

也有人说，有一种方法可以用 Profile API 做同样的事情（在注册控件中保留自定义信息）。有这方面的攻略吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T00:11:56.663

[从 MSDN使用 ASP.NET 2.0 Profiles Storing User Information](http://msdn.microsoft.com/en-us/library/ms379605.aspx)查看此链接

您还需要知道如何[为 SQL Server 创建应用程序服务数据库](http://msdn.microsoft.com/en-us/library/x28wfk74.aspx)

# debugging - 如何获得一些关于我的网络应用程序稳健性的外部输入？

> ID：693835
> 
> 赞同：0
> 
> 时间：2009-03-29T00:09:34.607
> 
> 标签：debugging

我正在寻找一些外界的眼睛来对我制作的一个简单的基于网络表单的实验/游戏进行黑盒测试。[uTest](http://www.utest.com/)看起来很不错，但它针对的是有大量现金的公司，而我的应用程序只是一个小型学术研究项目。我想确保我的应用程序不会轻易崩溃，并且能够抵抗基本的逆向工程/操作。这不是一个关键任务项目，因为没有金融交易或机密数据交换发生。但是，我最终可能会根据他们的分数向人们发放小奖品，我不希望作弊者占上风。

对负担得起的黑盒测试有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T01:07:13.423

你可以试试[香肠](https://chorizo-scanner.com/)。一台主机免费。它主要针对 PHP 应用程序，但您可以使用它来测试任何类型的网站是否存在 XSS 和类似漏洞。只需要您验证您是所有者，然后设置代理并开始浏览。

# asp.net - asp.net 管理多个 web.config 文件

> ID：693836
> 
> 赞同：3
> 
> 时间：2009-03-29T00:09:45.373
> 
> 标签：asp.net, visual-studio, web-config

任何人都可以提出一个管理多个 web.config 文件的好方法吗？

例如，我在本地机器上使用了一个名为“localWeb.config”的开发 web.config，然后将一个用于生产的 web.config 称为“prodWeb.config”。我保留了 .config 扩展名，因此没有人可以从 Web 服务器访问它们。

例如，localWeb.config 将有一个到开发数据库的连接字符串，而 prodWeb.config 将有一个到生产数据库的连接字符串。

目前，我正在使用一个 postbuild 事件，它将 localWeb.config 或 prodWeb.config 的内容复制到 web.config。这很好用，但我想知道是否有人知道更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T00:29:56.573

您可以查看此 CodeCarnage[页面](http://www.codecarnage.com/code/post/2008/11/05/web-config-configsource.aspx)上概述的方法是否更适合您的需求。它利用 configsource 属性指向 DB 和 APP 设置，每个设置都由环境分隔。这也许可以让您在 web.config 中保留一致的内容，并在其他配置文件中保留特定于环境的“内容”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T01:07:31.817

查看[Web 部署工具](http://learn.iis.net/page.aspx/346/web-deployment-tool/)：

> 以下是使用该工具完成的一些任务：
> 
> 1.  创建一个包含内容、配置和 SQL 数据库的包，以便部署或与他人共享。
>     
>     
> 2.  使用该包作为对应用程序进行版本控制或创建备份的一种方式。
>     
>     
> 3.  添加参数以在安装包期间替换文件中的连接字符串或其他值。
>     
>     
> 4.  使非管理员能够部署包并精细控制其访问。
>     
>     
> 5.  同步或迁移运行 IIS 6.0 和 IIS 7.0 的站点和服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T00:13:57.843

我保留一个配置文件并在运行时使用逻辑来检测要使用的配置子集。如果主机名是“prodsrvr-*”，那么我使用生产服务器配置，包括数据库连接等。如果主机名是“test-*”，那么我使用测试配置数据。等等。

编辑：这是一些我描述的代码。

```
public static string GetConnString()
{
    string connString = ConfigurationSettings.AppSettings[GetConfigKey("database")];
    return connString;
}

public static string GetConfigKey(string baseKey)
{
    string str = baseKey;
    if (Dns.GetHostName().StartsWith("dinoch"))
    {
        str = str + "-dev";
    }
    else if (Dns.GetHostName().StartsWith("prodsrvr"))
    {
        str = str + "-prod";
    }
    return str;
}

<configuration>
   <appSettings>
     <add key="database-dev" value="server=(local)\vsdotnet;database=ASPXAPPS;Integrated Security=SSPI" />
     <add key="database-prod" value="server=(local)\vsdotnet;database=ASPXAPPS;Integrated Security=SSPI" />
   </appSettings>
</configuration> 
```

我使用了一个简单的 StartsWith() ，并带有一些硬编码的“魔术字符串”。

为了避免这种情况，我可以想象在 web.config 文件中定义一个正则表达式映射到后缀。其中，如果 regex1 与主机名匹配，则使用 suffix1。如果是 regex2，则使用 suffix2。等等。您只需加载一次地图，然后只加载到 foreach() 中，通过正则表达式枚举并返回它们是否与主机名匹配。

或者，也许您想使用不同的标准来区分 prod 和 dev 和测试服务器，而不是主机名。由你决定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-29T00:57:08.970

在asp.net 4到来之前，这将继续是一个hack [http://www.asp.net/learn/whitepapers/aspnet40/#_Toc223325501](http://www.asp.net/learn/whitepapers/aspnet40/#_Toc223325501)

# geometry - 如何确定对角线在凹多边形内还是外？

> ID：693837
> 
> 赞同：4
> 
> 时间：2009-03-29T00:09:52.843
> 
> 标签：geometry, polygon

凹（非凸）多边形的对角线（对角线是连接不相邻顶点的线段）可以完全在多边形内部或外部（或可以与多边形的边相交）。如何判断是否完全在多边形内？（**一种不用多边形内点测试的方法**）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T02:33:33.163

如果对角线与边至少有一个交点，则部分在多边形内，部分在多边形外，如果对角线与边不相交，则只有两种状态：完全在多边形内或完全在多边形外.

要确定它是在多边形内还是在多边形外：

假设多边形的顶点逆时针排序。考虑位于名为 P[i] 的顶点上的对角线端点之一（另一个端点是 p[j]）。然后，制作三个向量，其第一个点是 p[i] ：

V1 : p[i+1] - p[i]

V2 : p[i-1] - p[i]

V3 : p[j] - p[i]

当我们从 V1 逆时针移动到 V2 时，当且仅当 V3 在 V1 和 V2 之间时，对角线完全在多边形中。

[![替代文字](https://i.stack.imgur.com/ZBjuB.jpg)](https://i.stack.imgur.com/ZBjuB.jpg)

逆时针从V1到V2怎么判断V3是否在V1和V2之间？去[这里](https://stackoverflow.com/questions/693806/how-to-determine-whether-v3-is-between-v1-and-v2-when-we-go-from-v1-to-v2-counter/693969#693969)。

我已经使用这种方法编写了一个程序，它可以有效地工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T00:27:01.273

> 如何判断是否完全在多边形中？

如果要确定对角线是否永远不会离开多边形的边界，只需确定它是否与两个相邻顶点之间的任何线相交。

*   如果是这样，则它部分在多边形内，部分在多边形外。

*   如果不是，它要么完全在多边形内，要么完全在多边形外。从那里开始，最简单的方法是在对角线上的任何点上使用多边形中的点，但如果您不想这样做，请使用**[缠绕算法](http://en.wikipedia.org/wiki/Point_in_polygon#Winding_number_algorithm)**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T00:37:46.867

我相信约翰的回答错过了一个重要的案例：当对角线从一开始就完全在多边形之外时。想象一下他的“u”形多边形的两座塔对角线“桥”。

![连接两座塔会创建一条不与任何边相交但仍在多边形外部的对角线。](https://i.stack.imgur.com/Bvomz.png)

几年前我不得不解决这个问题，所以如果我的回忆有点参差不齐，请原谅。

我解决这个问题的方法是对多边形中的每条边执行对角线的线相交测试。然后您有两种可能的情况：您至少有一个交叉口，或者您没有交叉口。如果有任何交点，则对角线不在多边形内。

如果没有得到任何交点，则需要确定对角线是完全在多边形内部还是完全在多边形外部。假设对角线将 p[i] 连接到 p[j]，即 i < j 并且您有一个顺时针缠绕的多边形。您可以通过查看连接 p[i] 和 p[i+1] 的边来确定对角线是否在多边形之外。计算出这条边的 2D 角度（例如，使用 x 轴作为基线。）旋转对角线，使 p[i]-p[i+1] 边是它的基线并计算它的 2D 角度。

![以稍微不那么罗嗦的方式显示上述过程的图像。](https://i.stack.imgur.com/Vq1x8.png)

完成此操作后，如果对角线在多边形外部，对角线的 2D 角度将为正，如果在多边形内部，则为负。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T03:09:29.113

关于检查线段之间的交叉点（这是您可能必须做的第一步），我发现[SoftSurfer](http://softsurfer.com/Archive/algorithm_0104/algorithm_0104B.htm)上的解释很有帮助。您必须检查对角线和多边形的任何边缘之间的交点。如果您使用的是 MATLAB，您应该能够找到一种有效的方法来使用矩阵和向量运算同时检查所有边缘的交点（我已经处理了以这种方式计算[射线三角形交点的交点](http://softsurfer.com/Archive/algorithm_0105/algorithm_0105.htm)）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-27T06:14:03.970

我知道这个问题在很多年前就得到了回答，但我有一种易于实施的新方法。

正如前面的答案所建议的，如果多边形的所有边与对角线段相交，您应该首先计算它们。[此处](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect)描述了计算交集并确定是否存在交集的代码。

如果所有边（不包括与对角线共享顶点的边）不与对角线相交，那么您知道对角线完全在多边形*内部*或*完全*在多边形外部，这意味着对角线的中点也分别*完全在内部*或*完全外部*. 中点是对角线的两个端点的平均值。

我们现在已经将问题转化为计算对角线是在多边形内部还是外部，而计算中点是在多边形内部还是外部。使用单点比使用线更容易。

[这里](https://stackoverflow.com/questions/217578/how-can-i-determine-whether-a-2d-point-is-within-a-polygon)描述了确定一个点是否在多边形内的方法，可以通过计算从该点开始的水平射线的交集量并查看该射线与多少个多边形边缘相交来总结。如果光线相交奇数次，则该点位于多边形内部，否则位于多边形外部。

此实现易于实现的原因是，当您遍历所有边以检查是否与对角线相交时，您现在还可以计算对角线的中点光线是否与正在处理的当前边相交。如果您的 for 循环返回时对角线和边之间没有交集，那么您可以查看偶数/奇数计数以确定对角线是在内部还是外部。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T00:32:07.317

约翰的回答很到位：

> 如果要确定对角线是否永远不会离开多边形的边界，只需确定它是否与两个相邻顶点之间的任何线相交。如果是这样，它就留下了多边形。

执行此检查的一种有效方法是对数据运行 Bentley-Ottman 扫描线算法。这很容易实现，但很难使数值稳定。如果您的多边形中的边少于...比如说... 20 条，那么蛮力搜索很可能会更快。

# design-patterns - 为多种类型实现观察者模式的最佳方法是什么？

> ID：693843
> 
> 赞同：1
> 
> 时间：2009-03-29T00:12:25.117
> 
> 标签：design-patterns

我有一个监视某些情况的代理。对于每个条件，我想通知不同的观察者，因为该条件的责任在于观察者。

根据维基百科，在 C++ 中为单个观察者/主题执行此操作的方法是创建一个虚拟类（类似于 Java 接口），它定义了观察者的更新方法，并定义了主题的注册方法。然后每个具体类继承其各自的接口。

但是，我可以设想这种情况发生在任意数量的条件下，每个条件都需要另一个接口和每个新条件的具体观察者类。这样的设计有意义吗？为每个新条件添加观察者界面听起来合理吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T00:41:36.700

如果您将此与 hoe Java 处理 GUI 组件上的事件进行比较（不完全相同，但总体思路相同），您最终会得到如下内容：

```
public void addActionListener(ActionListener listener) { }
public void addWindowListener(WindowListener listener) { }
public void addComponentListener(ComponentListener listener) {}
public void addMouseListener(MouseListner listener) {} 
```

所有 *Listener 的东西都是接口。然后，您提供一个或多个实现接口的类（我更喜欢每个侦听器类型一个类，其他人更喜欢创建一个实现所有侦听器的单一类）。

这被证明是非常灵活的，因为事物只能注册他们感兴趣的事件。

另一种方法是使用单个“addListener（Listener listener）”方法，其中 Listener 接口中包含每个可能的事件，这将是一个坏主意，除非您可以接受有关他们不关心的事件的通知。

那么，您是否期望对可以收听的内容进行细粒度控制？如果是这样，Java 模型运行良好（如果您也不关心它也可以运行，它非常灵活）。如果您认为所有事件都希望收到所有事件的通知，那么单一的“主”方式也可以。

听起来您想要细粒度的控制，所以我可以为每个一般事件类别使用接口的 Java 事件方式。

# javascript - 从当前页面的位置解析锚点的最简单方法是什么？

> ID：693844
> 
> 赞同：4
> 
> 时间：2009-03-29T00:12:48.470
> 
> 标签：javascript

我需要在 JavaScript 中锚出一个`window.location`，比如下面的 url：

```
http://www.example.com/page.html#anchor1 
```

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-29T00:18:03.527

[window.location.hash](https://developer.mozilla.org/en/DOM/window.location)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T00:17:43.747

这应该正是您想要的：

```
window.location.hash 
```

# wpf - 有没有办法在 ListBox Items 模板中进行迭代？

> ID：693848
> 
> 赞同：1
> 
> 时间：2009-03-29T00:15:33.720
> 
> 标签：wpf, data-binding, listbox, listboxitem, listboxitems

我有一个列表框，其中包含由单个文本框表示的项目。

当用户单击一个按钮时，我想遍历所有这些文本框并检查它们的绑定表达式是否没有错误；应该是这样的：

```
 Dim errCount = 0
    For Each item In MyListBox.ListBoxItems 'There is no such thing ListBoxItems which is actually what I am looking for.
        Dim tb As TextBox = item '.........Dig in item to extract the textbox from the visual tree.
        errCount += tb.GetBindingExpression(TextBox.TextProperty).HasError
    Next
    If errCount Then
        'Errors found!
    End If 
```

任何讨论将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-07T11:49:35.703

可能有一种更简单的方法可以做到这一点，但这里有一个可行的选择：

1) 遍历项目列表。

因为你使用的是items source，所以`ListBox.Items`会引用ItemsSource中的数据item。

```
for (int i = 0; i < ListBox.Items.Count; i++)
{
    // do work as follows below...
} 
```

2) 获取这些物品的容器。

```
DependencyObject obj = ListBox.ItemContainerGenerator.ContainerFromIndex(i); 
```

3) 使用 VisualTreeHelper 搜索容器视觉对象的 TextBox 子项。

```
TextBox box = FindVisualChild<TextBox>(obj); 
```

使用此函数搜索正确类型的可视子项：

```
public static childItem FindVisualChild<childItem>(DependencyObject obj)
    where childItem : DependencyObject
{
    // Search immediate children
    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(obj); i++)
    {
        DependencyObject child = VisualTreeHelper.GetChild(obj, i);

        if (child is childItem)
            return (childItem)child;

        else
        {
            childItem childOfChild = FindVisualChild<childItem>(child);

            if (childOfChild != null)
                return childOfChild;
        }
    }

    return null;
} 
```

4) 最后，检查 TextBox 上的绑定。

全部放在一起，是这样的：

```
private bool ValidateList(ListBox lb)
{
    for (int i = 0; i < lb.Items.Count; i++)
    {
        DependencyObject obj = lb.ItemContainerGenerator.ContainerFromIndex(i);
        TextBox box = FindVisualChild<TextBox>(obj);
        if (!TestBinding(box))
            return false;
    }

    return true;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-11T23:03:07.600

将上一篇文章翻译成 VB：

1)

```
For i As Integer = 0 To ListBox.Items.Count - 1 
    ' do work as follows below... 
Next 
```

2)

```
Dim obj As DependencyObject = ListBox.ItemContainerGenerator.ContainerFromIndex(i) 
```

3)

```
Dim box As TextBox = FindVisualChild(Of TextBox)(obj)
'************************
Public Shared Function FindVisualChild(Of ChildItem As DependencyObject)(ByVal obj As DependencyObject) As ChildItem
    ' Search immediate children 
    For i As Integer = 0 To VisualTreeHelper.GetChildrenCount(obj) - 1
        Dim child As DependencyObject = VisualTreeHelper.GetChild(obj, i)
        If TypeOf child Is ChildItem Then
            Return child
        Else
            Dim childOfChild As ChildItem = FindVisualChild(Of ChildItem)(child)
            If childOfChild IsNot Nothing Then Return childOfChild
        End If
    Next
    Return Nothing
End Function 
```

4)

```
Private Function ValidateList(ByVal lb As ListBox) As Boolean 
For i As Integer = 0 To lb.Items.Count - 1 
    Dim obj As DependencyObject = lb.ItemContainerGenerator.ContainerFromIndex(i) 
    Dim box As TextBox = FindVisualChild(Of TextBox)(obj) 
    If Not TestBinding(box) Then 
        Return False 
    End If 
Next 
Return True 
```

结束功能

# javascript - 最后一次按键 5 秒后调用 javascript 函数

> ID：693849
> 
> 赞同：26
> 
> 时间：2009-03-29T00:16:56.760
> 
> 标签：javascript, jquery

我有一个带有 an 的表单，`<input type=text />`我想在最后一次按键 5 秒后调用一个 javascript 函数，每次按下一个新键时，这个计时器应该重置并且只在 5 秒后调用该函数。

我怎样才能做到这一点？

我正在使用 jQuery。

谢谢！

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-29T00:25:01.733

这样的事情应该让你开始：

```
var timeout;
$('input[type=text]').keypress(function() {
    if(timeout) {
        clearTimeout(timeout);
        timeout = null;
    }

    timeout = setTimeout(myFunction, 5000)
}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-30T20:06:02.027

[这个答案](https://stackoverflow.com/a/693863/3303195)很好，但请记住，您需要在文档加载后和函数加载后启用此代码以清除超时。

这是完整的代码：

```
var timeout;
    $(document).ready(function(){
      $('input[type=text]').keypress(function() {
          if(timeout) {
              clearTimeout(timeout);
              timeout = null;
          }
          timeout = setTimeout(myFunction, 5000);
      });
    });

	var myFunction = new function() { 
	  alert('myFunction is running');
	  clearTimeout(timeout); // this way will not run infinitely
	} 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T10:04:34.367

虽然它不使用 jQuery，但您也可以查看[此处](http://unscriptable.com/index.php/2009/03/20/debouncing-javascript-methods/)描述的去抖动功能。

史蒂夫

# javascript - 如何将 'before' 方法与 jQuery 中的 'fadeIn' 方法结合使用？

> ID：693852
> 
> 赞同：4
> 
> 时间：2009-03-29T00:17:18.473
> 
> 标签：javascript, jquery, effects

我有一行 jquery 正在使用 jQuery 的 before 方法在页面上已经存在的另一个 div 之前插入一个 div：

```
$("#sendEmail").before('<div id="response"><h1>Success</h1><p>Your email was sent.</p></div>'); 
```

我希望新的 div 淡入，所以我尝试以两种不同的方式组合这些方法，但都不能正常工作。这是我尝试过的：

```
$("#sendEmail").before('<div id="response"><h1>Success</h1><p>Your email was sent.</p></div>').fadeIn("slow"); 
```

这不起作用，因为它试图淡出#sendmail div，而不是我插入的那个。这是我做的另一个尝试：

```
$("#sendEmail").before('<div id="response"><h1>Success</h1><p>Your email was sent.</p></div>');                             

$("#response").fadeIn("slow"); 
```

这也不起作用，因为当我尝试淡入它时已经插入了#response div，所以什么也没有发生。

我觉得我真的很接近，但我无法弄清楚。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-29T00:34:55.950

```
$('<div id="response"><h1>Success</h1><p>Your email was sent.</p></div>')
    .hide().insertAfter("#sendemail").fadeIn(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T00:23:36.353

尝试添加一个额外的 $() 这将在响应中调用 createElement 并将其淡入。然后它将在 sendEmail 元素之前添加该元素。

```
$("#sendEmail").before($('<div id="response"><h1>Success</h1><p>Your email was sent.</p></div>').fadeIn("slow")); 
```

基本上这是扩展的。

```
var responseDiv = $('<div id="response"><h1>Success</h1><p>Your email was sent.</p></div>')
  .fadeIn("slow");
$("#sendEmail").before(responseDiv); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T00:23:17.307

在 #response 上设置一个 CSS 规则以显示：无

然后它不会显示，直到你淡入

# winapi - How can I get the process filename under Vista?

> ID：693858
> 
> 赞同：3
> 
> 时间：2009-03-29T00:21:13.583
> 
> 标签：winapi, windows-vista

I have an application that aids people with disabilities. In order to work, it tracks the what window is currently in the foreground. Normally, I use this function to get process executable.

```
bool GetWindowProcessExe2(HWND hwnd, wxString& process_exe)  
                       //LPTSTR buf, DWORD size)
{
DWORD result = 0;
DWORD pid = 0;
GetWindowThreadProcessId(hwnd, &pid);
if (HANDLE process =
    OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid))
{
  char buff[512];
  LPTSTR pbuff = buff;
  result = GetModuleFileNameEx(process, 0, pbuff, 512);
  if(result == 0)
  {
    //failed.
    wxLogError("GetModuleFileNameEx failed with error code %d", GetLastError());
  }
  CloseHandle(process);
  process_exe = fromCString(pbuff);
}

return result > 0 ? true : false; 
```

}

Unfortunately, if the foreground window is the Vista file manager window (the window that opens when you click Start->Computer), `GetModuleFileNameEx()` fails with error code 299 which says I don't have privileges for this action. My code works for any regular application but not for the windows built in window (the file explorer). I need to know when this window is forefront. Is there another way to do it? I tried reading the window title but that just returns the current directory being shown. Any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T00:28:59.693

I'm not sure why this isn't working for explorer, but error 299 is `ERROR_PARTIAL_COPY`, meaning that attempting to read the module name out of explorer is failing.

On Vista, prefer `QueryProcessImageFileName` and only open the process with `PROCESS_QUERY_LIMITED_INFORMATION` - your code will work in more cases.

```
WCHAR exeName[512];
DWORD cchExeName = 512;
HANDLE process = OpenProcess(PROCESS_QUERY_LIMITED_INFORMATION, 0, pid);
QueryFullProcessImageName(process, 0, exeName, &cchExeName); 
```

EDIT: I also got `ERROR_PARTIAL_COPY` with your code running on 64-bit, but only when the querying process was 32-bit. 64-bit/64-bit worked fine.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T06:32:17.870

Looks like a 32 bit process can call GetModuleFileNameEx only on othere 32 bit processes. If you try to call it on 64 bit processes it fails with ERROR_PARTIAL_COPY.On a 64 bit platform make the calling process 64 bit and you should be able to call GetModuleFileNameEx on both 64 and 32 bit processes.

# sql - 使用 sql 查询的最佳方法

> ID：693874
> 
> 赞同：12
> 
> 时间：2009-03-29T00:37:03.280
> 
> 标签：sql

作为一名程序员，我想牢牢掌握编写查询的能力。在我的大学时代，我读了几本 sql 书籍，休息了几年，我刚刚学会了作为一名程序员工作。但由于这些查询与工作相关......它们并不那么“难”或复杂。

你们有什么建议？是否有一本好的高级 sql 书籍可以通过给出一些问题来教授然后测试知识？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-29T00:43:43.030

恕我直言，SQL 技能比任何其他编程技能都需要指导。

有三个主要原因。

1.  编写一条给出正确答案的 SQL 语句是很可能的（通常很容易）。因此，开发人员通常最终会告诉自己“嘿，它有效，（并且全部在一个声明中，）我完成了。” 通常情况并非如此，采取下一步的唯一有效方法是审查您的工作并获得建议（以及建议的原因）。

2.  技能并不像您预期​​的那样从“常规”编程中转移。分解、子程序等原理通常是死胡同。

3.  真正的 SQL 技能需要同样多的测试技能。只有彻底了解您的 SQL 查询分析工具，并在几乎每个查询中正确使用它们，您才能真正评估 SQL 执行情况。

因此，您的问题的答案是：尽早并经常获得尽可能多的帮助。并且不要不愿意问“为什么”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-29T00:53:56.653

我一直觉得 SQL 是你必须边做边学的东西。我发现自己参与了一个项目，该项目迫使我不停地编写 SQL 数周来分析一个相当大的数据库的各个方面。在许多情况下，我编写了许多 SQL，它们都产生了相同的结果，但以不同的方式得到它们。使用 Sql Server Management Studio 的执行路径工具，我能够查看查询选项并改进每个选项，最后选择适合情况的“最佳”选项。如果您能找到编写一堆 SQL 的理由或目的，我相信这将是您真正学习从数据库中提取数据的艺术的最佳催化剂。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-29T02:12:04.050

1.  集合论
2.  数据库理论，特别是。规范化规则
3.  学习如何阅读查询执行计划

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T00:47:10.260

我发现阅读 Ask Tom 网站有助于我了解您可以使用高级 SQL 做什么。它是甲骨文特有的，但尖刻的讽刺和可怕的！

[问汤姆](http://asktom.oracle.com/)

此外，请与您的数据库管理员（如果有的话）交谈，他们有丰富的经验可供您利用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T00:51:50.170

我发现最简单的方法是想知道您是否可以找到更好或更简单的方法并寻找这种方法（例如在[MySQL](http://www.mysql.com)网站上）或提出问题（例如在 SO 上）。这两种方式是我学习大部分 SQL 的方式。但这只是在获得基础知识之后。我还发现，数据库越复杂，你学到的就越多，即使是通过反复试验。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-15T23:48:43.530

令人惊讶的是，科学方法如何延续到许多不同的领域。如有疑问，请使用科学方法。
问一个问题（我如何擅长 sql？）

```
Do Background Research    (Research the topic)

Construct a Hypothesis     (If I research and practice a lot of different methods, test them, and ask for advice from peers, then I will be good at sql!)

Test Your Hypothesis by Doing an Experiment   (Do it and see if it works!)

Analyze Your Data and Draw a Conclusion
    (Did it work, and what happened)

Communicate Your Results
    (Tell us how you got good so we can get good too) 
```

# c++ - 创建无重复的随机数序列

> ID：693880
> 
> 赞同：38
> 
> 时间：2009-03-29T00:40:36.280
> 
> 标签：c++, c, algorithm, random

### 复制：

> [O（1）中的唯一随机数？](https://stackoverflow.com/questions/196017/unique-random-numbers-in-o1)

我想要一个伪随机数生成器，它可以以随机顺序生成不重复的数字。

例如：

随机(10)

可能返回 5, 9, 1, 4, 2, 8, 3, 7, 6, 10

除了确定数字范围并将它们改组或检查生成的列表是否有重复之外，还有更好的方法吗？

* * *

### 编辑：

此外，我希望它能够有效地生成没有整个范围的大数字。

* * *

### 编辑：

我看到每个人都建议洗牌算法。但是，如果我想生成大的随机数（1024 字节+），那么该方法会比我只使用常规 RNG 并插入到 Set 中直到达到指定长度需要更多的内存，对吧？有没有更好的数学算法。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-29T08:17:54.467

您可能对线性反馈移位寄存器感兴趣。我们曾经用硬件构建这些，但我也用软件完成了它们。它使用一个移位寄存器，其中一些位异或并反馈到输入，如果您选择正确的“抽头”，您可以获得与寄存器大小一样长的序列。也就是说，一个 16 位的 lfsr 可以产生一个 65535 长且没有重复的序列。它在统计上是随机的，但当然是可重复的。此外，如果做错了，你可能会得到一些令人尴尬的短序列。如果您查找 lfsr，您会发现如何正确构造它们的示例（即“最大长度”）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-29T00:45:11.200

洗牌是一种非常好的方法（前提是你没有使用朴素算法引入偏差）。参见[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-29T00:44:29.737

为了确保列表不重复，它必须保留以前返回的数字列表。由于它必须在算法结束时生成整个列表，这在存储要求上相当于生成有序列表然后洗牌。

更多关于洗牌的信息：[从有序列表中创建随机有序列表](https://stackoverflow.com/questions/168037/creating-a-random-ordered-list-from-an-ordered-list)

但是，如果随机数的范围很大，但所需的数字数量很少（您在评论中暗示这是实际要求），那么生成一个完整的列表并打乱它是浪费的。对一个巨大的数组进行洗牌涉及访问虚拟内存页面，这种方式（根据定义）会破坏操作系统的分页系统（在较小的规模上，CPU 的内存缓存也会出现同样的问题）。

在这种情况下，搜索到目前为止的列表会更有效率。因此，理想的做法是使用启发式（由实验确定）为给定参数选择正确的实现。（很抱歉用 C# 而不是 C++ 给出示例，但[ASFAC++B](http://www.earwicker.com/asfacppb.html)我正在训练自己用 C# 思考）。

```
IEnumerable<int> GenerateRandomNumbers(int range, int quantity)
{
    int[] a = new int[quantity];

    if (range < Threshold)
    {
        for (int n = 0; n < range; n++)
            a[n] = n;

        Shuffle(a);
    }
    else
    {
        HashSet<int> used = new HashSet<int>();

        for (int n = 0; n < quantity; n++)
        {
            int r = Random(range);

             while (!used.Add(r))
                 r = Random(range);

             a[n] = r;
        }
    }

    return a;
} 
```

检查重复数字、发生冲突时的循环等的成本将是昂贵的，但可能会有一些`Threshold`价值，它比分配整个范围更快。

对于足够小的数量要求，使用数组`used`并在其中进行线性搜索可能会更快，因为更大的局部性，更低的开销，比较的便宜......

同样对于大数量和大范围，最好返回一个根据请求生成序列中数字的对象，而不是预先为结果分配数组。这在 C# 中很容易实现，这要归功于`yield return`关键字：

```
IEnumerable<int> ForLargeQuantityAndRange(int quantity, int range)
{
    for (int n = 0; n < quantity; n++)
    {
        int r = Random(range);

        while (!used.Add(r))
            r = Random(range);

        yield return r;
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-29T08:16:19.540

如果保证一个随机数永远不会重复，它就不再是随机的，并且*随机性*的数量会随着数字的生成而减少（在九个数字之后`random(10)`是相当可预测的，即使只有八个之后你也有 50-50 的机会）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-29T08:27:54.207

我知道你不想要大范围的洗牌，因为你必须存储整个列表才能这样做。

相反，使用可逆的伪随机散列。然后依次输入值 0 1 2 3 4 5 6 等。

像这样的哈希有无数个。如果它们被限制为 2 的幂，它们不会太难生成，但可以使用任何基础。

例如，如果您想遍历所有 2^32 32 位值，则可以使用以下方法。它最容易编写，因为在这种情况下，整数数学的隐式 mod 2^32 对您有利。

```
unsigned int reversableHash(unsigned int x)
{
   x*=0xDEADBEEF;
   x=x^(x>>17);
   x*=0x01234567;
   x+=0x88776655;
   x=x^(x>>4);
   x=x^(x>>9);
   x*=0x91827363;
   x=x^(x>>7);
   x=x^(x>>11);
   x=x^(x>>20);
   x*=0x77773333;
   return x;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-29T01:08:53.437

对于特定范围内的随机数，无重复随机数是最好的方法。您描述的方法（随机生成数字并将它们放入 Set 直到达到指定长度）效率较低的原因是由于重复。从理论上讲，该算法可能永远不会完成。与 shuffle 相比，它充其量只会在无法确定的时间内完成，而 shuffle 总是在高度可预测的时间内运行。

* * *

对编辑和评论的回应：

如果正如您在评论中指出的那样，数字范围非常大，并且您想随机选择相对较少的数字而不重复，那么重复的可能性会迅速降低。范围和选择数量之间的大小差异越大，重复选择的可能性越小，您在问题中描述的选择和检查算法的性能就越好。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-29T07:44:36.590

如果您不介意平庸的随机性属性并且元素数量允许，那么您可以使用[线性同余随机数生成器](http://en.wikipedia.org/wiki/Linear_congruential_generator)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-29T08:30:58.960

如何使用 GUID 生成器（如 .NET 中的生成器）。当然，不能保证不会有重复，但是得到一个的机会非常低。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-29T19:25:10.417

以前有人问过这个问题 - 请参阅[我对上一个问题的回答](https://stackoverflow.com/questions/319524/algorithm-for-generating-a-random-number/320213#320213)。简而言之：您可以使用分组密码在您想要的任何范围内生成安全（随机）排列，而无需在任何时候存储整个排列。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-29T19:36:47.890

如果您想创建没有重复的大（例如，64 位或更大）随机数，那么只需创建它们。如果您使用的是一个好的随机数生成器，它实际上有足够的熵，那么生成重复的几率非常小，不值得担心。

例如，在生成加密密钥时，实际上没有人会费心检查他们之前是否生成过相同的密钥；既然你相信你的随机数生成器，一个专门的攻击者将无法获得相同的密钥，那么你为什么会期望你会意外地想出相同的密钥呢？

当然，如果你有一个糟糕的随机数生成器（比如[Debian SSL 随机数生成器漏洞](http://www.debian.org/security/2008/dsa-1571)），或者生成的数字足够小，以至于[生日悖论](http://en.wikipedia.org/wiki/Birthday_paradox)给你带来了很高的冲突机会，那么你需要实际做一些事情来确保你不会得到重复。但是对于具有良好生成器的大随机数，只需相信概率不会给您任何重复。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-30T03:09:42.373

生成数字时，请使用[Bloom 过滤器](http://en.wikipedia.org/wiki/Bloom_filter)来检测重复项。这将使用最少的内存。根本不需要在系列中存储较早的数字。

权衡是您的列表无法在您的范围内详尽无遗。如果您的数字确实在 256^1024 的数量级上，那几乎没有任何折衷。

（当然，如果它们实际上是那种规模的随机数，即使费心检测重复项也是浪费时间。如果地球上的每台计算机都生成数万亿年每秒大小的数万亿个随机数，那么碰撞的可能性仍然是绝对的微不足道。）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-30T13:26:54.793

我支持 gbarry 关于使用[LFSR](http://en.wikipedia.org/wiki/LFSR)的回答。即使在软件中，它们也非常高效且易于实现，并且保证不会在 (2^N - 1) 次使用中重复使用具有 N 位移位寄存器的 LFSR。

但是也有一些缺点：通过观察 RNG 的少量输出，可以重建 LFSR 并预测它将生成的所有值，这使得它们无法用于密码学和任何需要良好 RNG 的地方。第二个问题是全零字或全一字（以位为单位）无效，具体取决于 LFSR 实现。与您的问题相关的第三个问题是 LFSR 生成的最大数量始终是 2 - 1 的幂（或 2 - 2 的幂）。

第一个缺点可能不是问题，具体取决于您的应用程序。从您给出的示例中，您似乎不希望答案中出现零；因此，第二个问题似乎与您的情况无关。最大值（以及范围）问题可以通过重用 LFSR 来解决，直到你得到一个范围内的数字。这是一个例子：

假设您想要 1 到 10 之间的数字（如您的示例所示）。您将使用范围为 [1, 15] 的 4 位 LFSR。这是关于如何获取 [1,10] 范围内数字的伪代码：

```
x = LFSR.getRandomNumber();
while (x > 10) {
   x = LFSR.getRandomNumber();
} 
```

您应该将之前的代码嵌入到您的 RNG 中；这样调用者就不会关心实现。请注意，如果您使用大型移位寄存器并且您想要的最大数字不是 2 - 1 的幂，这会减慢您的 RNG。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-01T07:28:38.790

这个答案提出了一些策略来获得你想要的东西，并使用一些众所周知的算法确保它们是随机顺序的。

Fisher-Yates shuffle 算法有一个由内而外的版本，称为 Durstenfeld 版本，它在加载数组或集合时将顺序获取的项目随机分配到数组和集合中。

要记住的一件事是，加载时使用的 Fisher-Yates (AKA Knuth) shuffle 或 Durstenfeld 版本对对象数组非常有效，因为只有指向对象的引用指针被移动，而对象本身不必移动作为算法的一部分，进行检查或与任何其他对象进行比较。

我将在下面进一步给出这两种算法。

如果你想要非常大的随机数，大约 1024 字节或更多，那么一个非常好的随机生成器可以一次生成无符号字节或单词就足够了。随机生成尽可能多的字节或单词来构造数字，使其成为具有指向它的引用指针的对象，嘿，你有一个非常大的随机整数。如果您需要一个特定的非常大的范围，您可以将零字节的基值添加到字节序列的低位端以将值向上移动。这可能是您最好的选择。

如果您需要消除真正巨大的随机数的重复项，那就更棘手了。即使有非常大的随机数，删除重复项也会使它们有很大的偏差，而且根本不是随机的。如果您有一组非常大的不重复的非常大的随机数，并且您从尚未选择的随机数中随机选择，那么偏差只是为可供选择的非常大的数字集创建巨大值的偏差。Durstenfeld 的 Yates-Fisher 版本的反向版本可用于从非常大的一组值中随机选择值，将它们从剩余值中删除，然后将它们插入到一个新数组中，该数组是一个子集并且可以执行这仅使用原位的源和目标阵列。这将非常有效。

这可能是一个很好的策略，可以从一组非常大且不重复的随机数中获取具有巨大值的少量随机数。只需在源集中选择一个随机位置，获取它的值，将它的值与源集中的顶部元素交换，将源集的大小减一，然后用减小的源集重复，直到你选择了足够的值。这本质上是倒转的费舍尔-耶茨的 Durstenfeld 版本。然后，您可以使用 Fisher-Yates 算法的 Dursenfeld 版本将获取的值插入到目标集中。但是，这是大材小用，因为它们应该按照此处给出的随机选择和随机排序。

两种算法都假设您有一些随机数实例方法 nextInt(int setSize)，它生成一个从零到 setSize 的随机整数，这意味着存在 setSize 可能的值。在这种情况下，它将是数组的大小，因为数组的最后一个索引是 size-1。

第一种算法是 Fisher-Yates（又名 Knuth）洗牌算法的 Durstenfeld 版本，适用于任意长度的数组，该算法简单地将整数从 0 到数组长度随机定位到数组中。该数组不必是整数数组，而是可以是顺序获取的任何对象的数组，这实际上使其成为引用指针数组。它简单，简短且非常有效

```
int size = someNumber;
int[] int array = new int[size]; // here is the array to load
int location; // this will get assigned a value before used
// i will also conveniently be the value to load, but any sequentially acquired
// object will work
for (int i = 0; i <= size; i++) { // conveniently, i is also the value to load
      // you can instance or acquire any object at this place in the algorithm to load
      // by reference, into the array and use a pointer to it in place of j
      int j = i; // in this example, j is trivially i
    if (i == 0) { // first integer goes into first location
        array[i] = j; // this may get swapped from here later
    } else { // subsequent integers go into random locations
            // the next random location will be somewhere in the locations
            // already used or a new one at the end
            // here we get the next random location
            // to preserve true randomness without a significant bias
            // it is REALLY IMPORTANT that the newest value could be
            // stored in the newest location, that is, 
            // location has to be able to randomly have the value i
            int location = nextInt(i + 1); // a random value between 0 and i
            // move the random location's value to the new location
            array[i] = array[location];
            array[location] = j; // put the new value into the random location
    } // end if...else
} // end for 
```

瞧，你现在已经有了一个随机数组。

如果你想随机打乱你已经拥有的数组，这里是标准的 Fisher-Yates 算法。

```
type[] array = new type[size];

// some code that loads array...

// randomly pick an item anywhere in the current array segment, 
// swap it with the top element in the current array segment,
// then shorten the array segment by 1
// just as with the Durstenfeld version above,
// it is REALLY IMPORTANT that an element could get
// swapped with itself to avoid any bias in the randomization
type temp; // this will get assigned a value before used
int location; // this will get assigned a value before used
for (int i = arrayLength -1 ; i > 0; i--) {
    int location = nextInt(i + 1);
    temp = array[i];
    array[i] = array[location];
    array[location] = temp;
} // end for 
```

对于排序的集合和集合，即某种类型的列表对象，您可以只使用带有索引值的添加/或插入，允许您在任何地方插入项目，但它必须允许在当前最后一个项目之后添加或附加以避免产生偏差在随机化。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-29T01:04:13.183

洗牌 N 个元素不会占用过多的内存……想想看。您一次只能交换一个元素，因此使用的最大内存是 N+1 个元素的内存。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-29T08:39:33.523

假设您有一个随机或伪随机数生成器，即使不能保证返回唯一值，您也可以使用此代码实现每次返回唯一值的生成器，假设上限保持不变（即您总是用`random(10)`, 不要用`random(10); random(11)`.

该代码不检查错误。如果你愿意，你可以自己添加。
如果你想要大量的数字，它也需要大量的内存。

```
/* the function returns a random number between 0 and max -1
 * not necessarily unique
 * I assume it's written
 */
int random(int max);

/* the function returns a unique random number between 0 and max - 1 */
int unique_random(int max)
{

    static int *list = NULL;    /* contains a list of numbers we haven't returned */
    static int in_progress = 0; /* 0 --> we haven't started randomizing numbers
                                 * 1 --> we have started randomizing numbers
                                 */

    static int count;
    static prev_max = 0;

    // initialize the list
    if (!in_progress || (prev_max != max)) {
        if (list != NULL) {
            free(list);
        }
        list = malloc(sizeof(int) * max);
        prev_max = max;
        in_progress = 1;
        count = max - 1;

        int i;
        for (i = max - 1; i >= 0; --i) {
            list[i] = i;
        }
    }

    /* now choose one from the list */
    int index = random(count);
    int retval = list[index];

    /* now we throw away the returned value.
     * we do this by shortening the list by 1
     * and replacing the element we returned with
     * the highest remaining number
     */
    swap(&list[index], &list[count]);

    /* when the count reaches 0 we start over */
    if (count == 0) {
        in_progress = 0;
        free(list);
        list = 0;
    } else { /* reduce the counter by 1 */
        count--;
    }
}

/* swap two numbers */
void swap(int *x, int *y)
{
    int temp = *x;
    *x = *y;
    *y = temp;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-29T19:36:10.123

实际上，这里有一个小问题。不允许重复的随机数生成器不是随机的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-29T19:57:39.713

假设您想生成一系列 256 个不重复的随机数。

1.  创建一个用零初始化的 256 位（32 字节）内存块，我们称之为`b`
2.  您的循环变量将是`n`尚未生成的数字数量
3.  循环从`n = 256`到`n = 1`
4.  生成`r`范围内的随机数`[0, n)`
5.  在你的内存块中找到第`r`-th 个零位`b`，我们称之为`p`
6.  放入`p`你的结果列表，一个名为的数组`q`
7.  `p`将内存块中的第-位翻转`b`为`1`
8.  通过后`n = 1`，您就完成了生成数字列表

这是我正在谈论的一个简短示例，`n`最初使用 = 4 ：

```
**Setup**
b = 0000
q = []

**First loop pass, where n = 4**
r = 2
p = 2
b = 0010
q = [2]

**Second loop pass, where n = 3**
r = 2
p = 3
b = 0011
q = [2, 3]

**Third loop pass, where n = 2**
r = 0
p = 0
b = 1011
q = [2, 3, 0]

** Fourth and final loop pass, where n = 1**
r = 0
p = 1
b = 1111
q = [2, 3, 0, 1] 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-30T08:11:38.247

请检查答案

[以随机顺序生成整数序列，而无需预先构建整个列表](https://stackoverflow.com/questions/515665/generate-sequence-of-integers-in-random-order-without-constructing-the-whole-list/515704#515704)

我的答案也在那里

```
 very simple random is 1+((power(r,x)-1) mod p) will be from 1 to p for values of x from 1 to p and will be random where r and p are prime numbers and r <> p. 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-30T13:53:25.663

我之前问过一个类似的问题，但我的问题是关于 int 的整个范围，请参阅[寻找哈希函数 /Ordered Int/ 到 /Shuffled Int/](https://stackoverflow.com/questions/538738/looking-for-a-hash-function-ordered-int-to-shuffled-int)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-30T14:38:09.677

```
static std::unordered_set<long> s;
long l = 0;
for(; !l && (s.end() != s.find(l)); l = generator());
v.insert(l); 
```

generator() 是您的随机数生成器。只要条目不在您的集合中，您就滚动数字，然后添加您在其中找到的内容。你明白了。

我为这个例子做了很长时间，但如果你的 PRNG 是模板化的，你应该把它做成一个模板。

另一种方法是使用加密安全的 PRNG，它生成两倍相同数字的概率非常低。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-30T15:07:39.887

如果您的意思不是生成序列的统计特性较差，则有一种方法：

假设您要生成 N 个数字，每个数字 1024 位。您可以牺牲一些生成的数字作为“计数器”。

因此，您生成每个随机数，但是在您选择的某些位中放入二进制编码的计数器（从变量中，每次生成下一个随机数时都会增加）。

您可以将该数字拆分为单个位，并将其放入生成数字的一些不太重要的位中。

这样您就可以确保每次都获得唯一的号码。

我的意思是，例如，每个生成的数字看起来像这样：xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxyyxxxxyxyyyyxxyxx 其中 x 直接取自生成器，ys 取自计数器变量。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-04-03T12:30:12.300

梅森捻线机

可在 Wikipedia 上找到其描述：[Mersenne twister](http://en.wikipedia.org/wiki/Mersenne_twister)

查看页面底部以了解各种语言的实现。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-07-05T17:49:54.210

问题是从范围 1..M 中选择 N 个唯一数字的“随机”序列，其中对 N 和 M 之间的关系没有限制（M 可能比 N 大得多、大致相同，甚至更小；它们可能不是相对质数）。

扩展线性反馈移位寄存器答案：对于给定的 M，为大于 M 的 2 的最小幂构造一个最大 LFSR。然后从 LFSR 中获取您的数字，丢弃大于 M 的数字。平均而言，您将最多丢弃一半生成的数字（因为通过构造超过一半的 LFSR 范围小于 M），因此获取数字的预期运行时间为 O(1)。您没有存储以前生成的数字，因此空间消耗也是 O(1)。如果您在获得 N 个数字之前循环，则 M 小于 N（或 LFSR 构造不正确）。

您可以在此处（来自维基百科）找到最大长度 LFSR 的参数（最多 168 位）：[http ://www.xilinx.com/support/documentation/application_notes/xapp052.pdf](http://www.xilinx.com/support/documentation/application_notes/xapp052.pdf)

这是一些java代码：

/** * 在 [0,M) 中生成一系列唯一的“随机”数字 * @author dkoes * */

公共类 UniqueRandom { long lfsr; 长面具；长最大值；

```
private static long seed = 1;
//indexed by number of bits
private static int [][] taps = {
        null, // 0
        null, // 1
        null, // 2
        {3,2}, //3
        {4,3},
        {5,3},
        {6,5},
        {7,6},
        {8,6,5,4},
        {9,5},
        {10,7},
        {11,9},
        {12,6,4,1},
        {13,4,3,1},
        {14,5,3,1},
        {15,14},
        {16,15,13,4},
        {17,14},
        {18,11},
        {19,6,2,1},
        {20,17},
        {21,19},
        {22,21},
        {23,18},
        {24,23,22,17},
        {25,22},
        {26,6,2,1},
        {27,5,2,1},
        {28,25},
        {29,27},
        {30,6,4,1},
        {31,28},
        {32,22,2,1},
        {33,20},
        {34,27,2,1},
        {35,33},
        {36,25},
        {37,5,4,3,2,1},
        {38,6,5,1},
        {39,35},
        {40,38,21,19},
        {41,38},
        {42,41,20,19},
        {43,42,38,37},
        {44,43,18,17},
        {45,44,42,41},
        {46,45,26,25},
        {47,42},
        {48,47,21,20},
        {49,40},
        {50,49,24,23},
        {51,50,36,35},
        {52,49},
        {53,52,38,37},
        {54,53,18,17},
        {55,31},
        {56,55,35,34},
        {57,50},
        {58,39},
        {59,58,38,37},
        {60,59},
        {61,60,46,45},
        {62,61,6,5},
        {63,62},
};

//m is upperbound; things break if it isn't positive
UniqueRandom(long m)
{
    max = m;
    lfsr = seed; //could easily pass a starting point instead
    //figure out number of bits
    int bits = 0;
    long b = m;
    while((b >>>= 1) != 0)
    {
        bits++;
    }
    bits++;

    if(bits < 3)
        bits = 3; 

    mask = 0;
    for(int i = 0; i < taps[bits].length; i++)
    {
        mask |= (1L << (taps[bits][i]-1));
    }

}

//return -1 if we've cycled
long next()
{
    long ret = -1;
    if(lfsr == 0)
        return -1;
    do {
        ret = lfsr;
        //update lfsr - from wikipedia
        long lsb = lfsr & 1;
        lfsr >>>= 1;
        if(lsb == 1)
            lfsr ^= mask;

        if(lfsr == seed)            
            lfsr = 0; //cycled, stick

        ret--; //zero is stuck state, never generated so sub 1 to get it
    } while(ret >= max);

    return ret;
} 
```

}

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-12-06T10:39:35.597

这是一种随机而不重复结果的方法。它也适用于字符串。它在 C# 中，但 logig 应该在许多地方工作。将随机结果放入一个列表并检查新的随机元素是否在该列表中。如果不是，那么您有一个新的随机元素。如果它在那个列表中，重复随机直到你得到一个不在那个列表中的元素。

```
List<string> Erledigte = new List<string>();
private void Form1_Load(object sender, EventArgs e)
{
    label1.Text = "";
    listBox1.Items.Add("a");
    listBox1.Items.Add("b");
    listBox1.Items.Add("c");
    listBox1.Items.Add("d");
    listBox1.Items.Add("e");
}

private void button1_Click(object sender, EventArgs e)
{
    Random rand = new Random();
    int index=rand.Next(0, listBox1.Items.Count);
    string rndString = listBox1.Items[index].ToString();

    if (listBox1.Items.Count <= Erledigte.Count)
    {
        return;
    }
    else
    {
        if (Erledigte.Contains(rndString))
        {
            //MessageBox.Show("vorhanden");
            while (Erledigte.Contains(rndString))
            {
                index = rand.Next(0, listBox1.Items.Count);
                rndString = listBox1.Items[index].ToString();
            }
        }

        Erledigte.Add(rndString);
        label1.Text += rndString;
    }
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-02-24T20:12:21.027

对于随机序列，不应该有任何自相关。数字不应该重复的限制意味着下一个数字应该取决于所有以前的数字，这意味着它不再是随机的......

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2009-03-29T11:00:31.813

如果您可以生成“小”随机数，则可以通过整合它们来生成“大”随机数：为每个“前一个”添加一个小的随机增量。

```
const size_t amount = 100; // a limited amount of random numbers
vector<long int> numbers; 
numbers.reserve( amount );
const short int spread = 250; // about 250 between each random number
numbers.push_back( myrandom( spread ) );
for( int n = 0; n != amount; ++n ) {
    const short int increment = myrandom( spread );
    numbers.push_back( numbers.back() + increment );
}

myshuffle( numbers ); 
```

`myrandom`和功能我在`myshuffle`此慷慨地委托给其他人:)

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2011-05-29T16:30:47.937

要获得不重复的随机数并避免浪费时间检查双打数字并一遍又一遍地获取新数字，请使用以下方法，这将确保 Rand 的最低使用量：例如，如果您想获得 100 个不重复的随机数：1。用 1 到 100 的数字填充数组 2\. 使用 (1-100) 范围内的 Rand 函数获取随机数 3\. 使用生成的随机数作为索引从数组中获取第一个值 (Numbers[IndexGeneratedFromRandFunction] 4 . 将该索引之后的数组中的数字向左移动 5\. 从步骤 2 重复，但现在范围应该是 (1-99) 并继续

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2014-01-09T10:30:02.563

现在我们有了一个不同数字的数组！

```
int main() {
    int b[(the number
    if them)];
    for (int i = 0; i < (the number of them); i++) {
    int a = rand() % (the number of them + 1) + 1;
    int j = 0;
    while (j < i) {
        if (a == b[j]) {
        a = rand() % (the number of them + 1) + 1;
        j = -1;
        }
        j++;
    }
    b[i] = a;
    }
} 
```

# sql - 根据单个查询中的数据从两个表中获取数据

> ID：693881
> 
> 赞同：0
> 
> 时间：2009-03-29T00:41:36.263
> 
> 标签：sql

我正在制作一个简单的论坛，并且在线程列表中，我希望显示经典的“（用户）在（日期）发布的最新帖子”。我只使用一个表来包含论坛中的所有帖子，其中 parentPost-field 不等于 null 的帖子是对线程的回复。

这些是我需要来自以下数据的表格和必要字段：

论坛帖子

*   **id** : 整数，主键
*   **标题**：字符串值
*   **日期**：字符串值
*   **parentPost** : 整数（该字段 = 线程中初始帖子的 ID。如果为 NULL，则帖子为“初始线程帖子”）
*   **作者**：整数，用户表的外键
*   **countAnswers** : 整数
*   **lastPost** : 整数，（此字段 = 回复的最后一个帖子的 ID。仅在 parentPost-field = NULL 时使用）

用户

*   **userid** : 整数，主键
*   **firstName** : 字符串值
*   **姓氏**：字符串值

截至目前，我有这个查询：

```
SELECT forumPosts.id, forumPosts.title, forumPosts.date, forumPosts.author, forumPosts.countAnswers, users.firstName, users.lastName 
FROM forumPosts 
INNER JOIN users ON forumPosts.author = users.userid 
WHERE forumPosts.parentPost IS NULL ORDER BY id DESC; 
```

返回我需要的所有内容（ID、标题、日期、作者以及它有多少回复），但最后发布回复的日期和作者除外。

此外，我想获取以下内容：

帖子中最后一个帖子的日期，即 ID 最高*且*parentPost = forumPosts.id 的帖子。我还想从发布此回复的用户那里获取名字和姓氏。

很长一段时间以来，我一直在玩弄不同的连接和派生表等，但我似乎无法做到这一点。理想情况下，我希望返回一个包含以下字段的表：

*   ID
*   标题
*   日期
*   名
*   姓
*   计数答案
*   最后回复日期
*   最后回复名字
*   最后回复姓氏

对我来说，这似乎是可能的，但我显然做不到。

我希望你能理解我这个有点复杂的问题，我非常感谢你的所有回答。

### 解决方案

```
SELECT        forumPosts.id, forumPosts.title, forumPosts.date, forumPosts.author, forumPosts.countAnswers, users.firstName, users.lastName, 
                     lastPost.date AS lastPostDate, lastUser.firstName AS lastPostFirstName, lastUser.lastName AS lastPostLastName
FROM            forumPosts AS lastPost INNER JOIN
                     users AS lastUser ON lastPost.author = lastUser.userid INNER JOIN
                     forumPosts INNER JOIN
                     users ON forumPosts.author = users.userid ON lastPost.id = forumPosts.lastPost
WHERE        (forumPosts.parentPost IS NULL)
ORDER BY forumPosts.id DESC 
```

那行得通。如此典型，在我花了很多时间在这里写帖子后一分钟找到了自己的答案：-\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T01:09:18.600

如果“线程”对您的系统来说是一个重要的概念——看起来就是这样——我会将它建模为一个单独的实体。当您刚刚开始发现时，通过没有父级的帖子识别线程会让您感到悲伤。

一件事是找到所有线程：

```
SELECT ... FROM posts WHERE parent IS NULL 
```

取决于数据库供应商通常不是高性能的，因为 NULL 值通常不被索引。

创建一个 Thread 表，所有这些问题都消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T01:20:14.003

```
SELECT f.id, f.title, f.date, 
 u1.firstName, u1.lastName, f.countAnswers,
 r1.date AS lastReplyDate,
 u2.firstName AS lastReplyFirstName
 u2.lastName AS lastReplyLastName
FROM forumPosts f
 INNER JOIN users u1 ON (f.author = u1.userid)
 LEFT OUTER JOIN (forumPosts r1 INNER JOIN users u2 ON r1.author = u2.userid)
  ON (f.id = r1.parentPost)
 LEFT OUTER JOIN forumPosts r2 
  ON (f.id = r1.parentPost AND r1.id < r2.id)
WHERE f.parentPost IS NULL 
 AND r2.id IS NULL
ORDER BY f.id DESC; 
```

# c# - 什么是“你好世界！” 遗传算法的好处？

> ID：693889
> 
> 赞同：8
> 
> 时间：2009-03-29T00:45:13.790
> 
> 标签：c#, c++, genetic-algorithm

我发现了这个[非常酷的 C++ 示例](http://www.generation5.org/content/2003/gahelloworld.asp)，字面意思是“Hello World！” 的遗传算法。

所以我决定用 C# 重新编码整个事情，[这](http://dotnetbutchering.blogspot.com/2009/03/typing-monkeys-and-genetic-algorithms.html)就是结果。

现在我问自己：**是否有任何实际应用可以从一组随机字符串开始生成目标字符串？**

**编辑**：我在推特上的好友刚刚发推文说*“对于转录类型的东西（例如翻译）很有用。不一定是猴子的”*。我希望我有一个线索。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-29T00:51:56.363

> 从一组随机字符串开始生成目标字符串是否有任何实际应用？

当然。想象一下您知道如何评估特定字符串的适合度并且选择是离散的并且以某种方式受到约束的任何场景：

*   挑选可发音的名字（“Xhjkxc”适应度低；“Artekzo”适应度高）
*   尝试一系列国际象棋动作
*   猜测保险箱的密码，假设你知道你离解锁每个不倒翁还有多远
*   选择评估为单词的电话号码（例如，“843-2378”具有很高的适应度，因为它拼写为“THE-BEST”）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T00:52:17.267

不会。每次运行 GA 时，您都在给它最终的答案。这非常适合展示 GA 的工作原理以及它的强大功能，但除此之外没有任何目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T18:36:25.027

您可以编写一个使用 IronPython 等动态语言编写代码的 EA，其目标是创建以下代码：a) 在不崩溃的情况下执行，b) 分析股票市场并智能地买卖股票。

这是对必要的非常简单的看法，但这是可能的。您将需要一个为 IronPython 代码（技术指标等）提供大量方法的主机和一个报价数据库。

不只是生成任何旧的随机代码也很聪明，以免您格式化自己的硬盘驱动器。您需要一个沙箱，您需要限制可访问的命名空间，并且您需要提供时间限制以避免无限循环。您还可以提供语义指南，允许它选择适当的批准关键字，而不是仅仅将随机字母串在一起——这将大大加快进化速度。

所以，我参与了一个项目，除了 EA 之外什么都做。我们有一个卫星天线，它可以从纳斯达克获取实时股票报价，一个具有 API 的交易服务，以及一个原始的决策“大脑”，在报价进入时做出决策。

可悲的是，其中一位合伙人突然出局，辞掉了工作，分叉了项目（得到了自己的菜，等等），并开始使用尚未准备好的逻辑进行交易。他损失了一大笔钱。事实证明，对于某些人来说，这种类型的项目距离普通赌博仅一步之遥。但无论如何，该项目在那之后有点失败了。但是，发展逻辑部分是缺失的环节。我知道有人在做这种事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T07:46:54.953

我在 2 个现实生活中的研究问题中使用了 GA。

一个是功率优化问题（最大化打开的电器数量，满足每个电器的可用功率限制和服务保证）

另一个是用于无线电网络优化，在固定设备预算的情况下最大化覆盖区域

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-09T21:14:30.183

GA 有一个主要缺点，它通常以基因速度工作，因此在一些严重的时间依赖项目中使用它是非常冒险的。

# sql - 如何描述客户的全文搜索？

> ID：693902
> 
> 赞同：2
> 
> 时间：2009-03-29T00:56:39.893
> 
> 标签：sql, sql-server, sql-server-2005

我实现了一个全文搜索“在标签中搜索”，使用 SQL Server 2005，我想为客户描述我做了什么，通过简单的例子全文搜索是什么意思？我的客户不是程序员，而是优秀的互联网用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T01:08:47.773

我发现在向客户描述某事时会使用隐喻或使用非常具体的领域特定示例。

作为一个比喻，你可以说全文搜索就像你的网站的谷歌。它着眼于一切，试图帮助你。然而，我们之前所拥有的更像是使用 XP 中的查找功能。它有效，但如果您对要搜索的内容有很多了解，则效果很好。谷歌不是比 Find 更好吗:)

或者只是给他们一个他们以前不能做但现在可以做的事情的例子！经验和结果总是比文字更能传达信息。向他们展示您如何让他们的生活更轻松，他们会立即理解。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T01:00:01.850

“它现在发现东西的速度要快得多。”

其他一切都是用户不感兴趣的技术细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T01:01:34.763

“使用非精确匹配查找信息”

举几个例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-29T01:35:01.127

“更快地找到东西，并且更像谷歌”。

不得不与搜索引擎进行比较——见鬼，我什至无法真正描述“全文搜索”的含义。“全文搜索”确实是一个技术术语。

我可以描述我不喜欢搜索的地方。要求我输入诸如“猫和狗”之类的布尔垃圾，或者不向我提供替代查询。换句话说，也许想想旧方法有什么问题以及为什么这个方法更好。

# language-agnostic - 网站上的“实时订单”视图 - 需要建议！

> ID：693905
> 
> 赞同：1
> 
> 时间：2009-03-29T00:59:52.943
> 
> 标签：language-agnostic

我只是在接受一些建议 - 我正在建立一个在线商店（使用 php/mysql），目前可以通过点击相关部分并应用过滤器等来查看当前订单。一封电子邮件也会发送到我的收件箱。

由于业务的性质（需要在半小时内准备和发送订单），我希望在我的网站上有一个页面，显示通过网站“实时”的订单，我可以管理和标记因为它们已经实现。

对此采取的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T01:15:04.780

使用[AJAX 和基于 Comet 的方法](http://ajaxian.com/archives/comet-with-php)。

基本上，您有一个显示“实时”订单的网页，其中有一个 AJAX 查询不断运行并点击一个 PHP 页面，该页面有效地轮询实时订单，然后休眠 1-30 秒（取决于您需要它的响应速度）。您需要将最大执行时间设置为 0，这样它就永远不会结束。

网页还必须检测它何时关闭（或用户移动到另一个页面）并终止 AJax 请求并在错误或超时时重新启动它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T01:42:19.440

如果您不介意深入挖掘并使解决方案适合您，您知道我会做什么吗？

把它变成一个 Vista 侧边栏小工具或其他一些小工具。它们都是基于 HTML/Javascript 的。如果你走侧边栏路线，你甚至不需要保持浏览器打开。

只是想大声。不过，从技术上讲，Cletus 的钱几乎是对的。我只是在考虑 HTML 之上的后者 :-)

# c++ - 传递函数对象：错误

> ID：693910
> 
> 赞同：4
> 
> 时间：2009-03-29T01:04:44.553
> 
> 标签：c++, functional-programming, unary-function

下面这个传递函数对象的小程序有什么问题？

```
#include <iostream>
#include <functional>

void foo(const std::unary_function<const std::string&, void>& fct) {
  const std::string str = "test";
  fct(str); // error
}

class MyFct : public std::unary_function<const std::string&, void> {
public:
  void operator()(const std::string& str) const {
    std::cout << str << std::endl;
  }
};

int main(int argc, char** argv){
  MyFct f;
  foo(f);
  return 0;
} 
```

我在第 6 行收到以下错误：

```
 no match for call to 
`(const std::unary_function<const std::string&, void>) (const std::string&)' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-29T01:21:20.753

一个常见的错误。`unary_function`并且`binary_function`只是添加 typedef 的两个结构

```
argument_type
result_type 
```

和分别

```
first_argument_type
second_argument_type
result_type 
```

不多。它们是为了方便函数对象类型的创建者，所以他们不必自己做这些。但它们的行为不是多态的。你想要的是函数对象包装器。`boost::function`想到：

```
void foo(boost::function<void(const std::string&)> const& fct) {
  const std::string str = "test";
  fct(str); // no error anymore
} 
```

或者让它成为一个模板

```
template<typename FunctionObject>
void foo(FunctionObject const& fct) {
  const std::string str = "test";
  fct(str); // no error anymore
} 
```

您可以按值获取它，然后返回副本，`foo`如果使用它将其应用于某个序列。这将允许函数对象更新其成员之间的一些状态变量。`for_each`是一个这样做的例子。一般来说，无论如何，我会按价值接受它们，因为它们通常很小，复制它们可以提供更大的灵活性。所以我愿意

```
template<typename FunctionObject>
void foo(FunctionObject fct) {
  const std::string str = "test";
  fct(str); // no error anymore
} 
```

然后，您将能够获取 fct 的副本并将其保存在某处，并且`fct`' 的 operator() 可以是非常量并更新一些成员（这是整个观点的一部分`operator()`）。请记住，如果您通过 const 引用获取函数对象，通常不能复制它，因为用户可能已经传递了一个函数。然后复制它会尝试在本地声明一个函数而不是本地函数指针。但是，当传递函数时，按值接受将接受函数指针，可以安全地复制。

# apache-flex - Flex Mojo Maven 编译问题

> ID：693911
> 
> 赞同：1
> 
> 时间：2009-03-29T01:06:13.193
> 
> 标签：apache-flex, maven-2, maven-plugin

我正在尝试让 flex mojos maven 编译器运行我的项目。

任何对以下信息有反馈的人表示赞赏。

我将这个配置用于 maven 编译器插件，由于某种原因，每次我在我的 SWF 项目上运行全新安装时，我仍然在应用程序的编译步骤中看到以下内容。

info.rvin.mojo flex-compiler-mojo true true

-compiler.accessible=false -compiler.actionscript-file-encoding UTF-8 -compiler.allow-source-path-overlap=false -compiler.as3=true -compiler.debug=false

这意味着我无法通过 Flex Builder 的调试工具连接到我的应用程序。关于如何在 pom.xml 中正确配置插件的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T20:47:24.437

亚当，我们刚刚开始[在 Maven: The Definitive Guide 中构建关于 flexmojos 的章节](http://www.sonatype.com/books/maven-book/reference/ch20.html)。对于初学者，请使用该章节中列出的新插件 groupId、artifactId。velo 几个月前将 flexmojos 项目转移到了 Sonatype Forge，我们刚刚发布了 3.0 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-27T16:08:45.740

对于任何阅读本文的人：记住 Maven 是一个构建工具；它仅（通常）执行您的代码（部分）作为执行您已实现的测试的结果。

# opengl - 凹多边形绘图

> ID：693916
> 
> 赞同：4
> 
> 时间：2009-03-29T01:07:42.473
> 
> 标签：opengl, polygon, triangulation, concave, stencil-buffer

对于使用 OpenGL 绘制复杂的凹多边形，最好将其细分为三角形，还是使用[模板缓冲区](http://glprogramming.com/red/chapter14.html#name13)？我猜模板缓冲区对于单帧会更快，但如果多边形不改变，三角剖分对于多帧会更好。但是，我还没有真正尝试过，所以我不知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T01:34:55.480

这正是你所说的方式：

三角多边形渲染速度更快，但一次性 CPU 成本很高，即三角剖分本身。根据我的经验，如果您必须至少渲染两次多边形，那么对多边形进行三角测量是值得的。

不过，多边形的大小会有所不同。如果使用模板缓冲区方法，非常小的多边形比大多边形的成本要低得多，因为您可以将第二次渲染通道的大小限制为多边形的边界框。

# c++ - 如何使用遥控器与 Linux C 或 C++ 应用程序交互？

> ID：693922
> 
> 赞同：1
> 
> 时间：2009-03-29T01:11:30.217
> 
> 标签：c++, c

我想从电视遥控器捕获输入并检测在我的应用程序中按下了哪些按钮。操作系统是 Linux（Windows 的答案对我来说用处不大，但对其他人可能有用）。我正在使用 C++，但 C 代码也适用于我。

我想以与此类似的方式使用代码：

```
if (remoteControl.buttonPressed(PLAY_BUTTON))
{
    fooBar.doSomethingFun();
} 
```

另外，我在想可能有一个我可以使用的通用库，它可以用于所有遥控器，还是我必须做一些非常低级的编码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T01:28:37.943

首先，您将需要一些硬件来检测红外辐射，例如[USB-UIRT](http://www.usbuirt.com/)

[在 Linux 上， LIRC](http://www.lirc.org/)支持 USB-UIRT，它为您处理低级别的事情。

有许多开源包可以使用它来提供控制，因此您可以查看它们的代码以获取示例，例如。[神话电视](http://www.mythtv.org/wiki/USB-UIRT)

# ruby-on-rails - 如何（替换|创建）rails 2.0 迁移中的枚举字段？

> ID：693928
> 
> 赞同：29
> 
> 时间：2009-03-29T01:18:08.423
> 
> 标签：ruby-on-rails, ruby, migration

我想在我正在做的迁移中创建一个枚举字段，我尝试在谷歌中搜索，但我找不到在迁移中执行此操作的方法

我唯一发现的是

```
 t.column :status, :enum, :limit => [:accepted, :cancelled, :pending] 
```

但看起来上面的代码只在 rails 1.xxx 上运行，因为我正在运行 rails 2.0

这是我尝试过的，但失败了

```
class CreatePayments < ActiveRecord::Migration
  def self.up
    create_table :payments do |t|
      t.string :concept
      t.integer :user_id
      t.text :notes
      t.enum :status, :limit => [:accepted, :cancelled, :pending]

      t.timestamps
    end
  end

  def self.down
    drop_table :payments
  end
end 
```

那么，如果不允许这样做，您认为什么是好的解决方案？只是一个文本字段，并从模型中验证？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-07-09T22:40:20.367

`t.column`您可以改用该方法手动指定类型。Rails 会将其解释为字符串列，您可以像 Pavel 建议的那样简单地将验证器添加到模型中：

```
class CreatePayments < ActiveRecord::Migration
  def self.up
    create_table :payments do |t|
      t.string :concept
      t.integer :user_id
      t.text :notes
      t.column :status, "ENUM('accepted', 'cancelled', 'pending')"

      t.timestamps
    end    
  end

  def self.down
    drop_table :payments
  end
end

class Payment < ActiveRecord::Base
  validates_inclusion_of :status, :in => %w(accepted cancelled pending)
end 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-12T08:36:49.953

查看[http://zargony.com/2008/04/28/five-tips-for-developing-rails-applications上的提示 #3](http://zargony.com/2008/04/28/five-tips-for-developing-rails-applications)

这正是您所需要的！

```
 class User < ActiveRecord::Base
   validates_inclusion_of :status, :in => [:active, :inactive]

   def status
     read_attribute(:status).to_sym
   end

   def status= (value)
     write_attribute(:status, value.to_s)
   end
 end 
```

高温高压

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-08-12T00:00:14.613

您可以尝试（非常）全面的 jeff 的[enumerated_attribute gem](http://github.com/jeffp/enumerated_attribute "enumerated_attribute gem")或者使用这个简单的解决方法：

```
class Person < ActiveRecord::Base
  SEX = [:male, :female]

  def sex
    SEX[read_attribute(:sex)]
  end

  def sex=(value)
    write_attribute(:sex, SEX.index(value))
  end
end 
```

然后将`sex`属性声明为整数：

```
t.integer :sex 
```

这对我来说非常好！=D

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-29T22:11:21.950

我有几十个这样的小枚举，每个有 3-300 个条目。我将它们实现为查找表。我没有每个模型文件；我使用一些元编程为每个表生成一个模型，因为每个表都有相同的列集（id、name、description）。

由于某些系列有足够的元素来保证它们自己的表格，因此将它们全部移动到表格中会更加一致。如果稍后您将拥有更多这些枚举，则只是另一种选择。

**编辑：**这是我生成模型的方式：

```
ACTIVE_RECORD_ENUMS = %w{
  AccountState
  ClientType
  Country
  # ...
}

ACTIVE_RECORD_ENUMS.each do |klass|
  eval "class #{klass} < ActiveRecord::Base; end"
  klass.constantize.class_eval do
    class << self

      def id_for(name)
        ids[name.to_s.strip.humanize.downcase]
      end

      def value_for(id)
        values[id.to_i]
      end

      def values
        @values ||= find(:all).inject({}) {|h,m| h[m.send(primary_key)] = m.name; h}
      end

      def ids
        @ids ||= self.values.inject({}) {|h, {k, v}| h[v.downcase] = k; h}
      end

    end
  end
end 
```

该文件位于模型目录中，并包含在`application_config.rb`. 这让我可以做这样的事情：

```
AccountState.ids 
# => {"active" => 1, "deleted" => 2}
AccountState.values 
# => {1 => "Active", 2 => "Deleted"}
AccountState.id_for("Active") 
# => 1
AccountState.value_for(1) 
# => "active" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-10T13:11:58.247

你看过RubyForge上的[enum-column插件吗？](https://rubyforge.org/projects/enum-column/ "枚举列")

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-15T01:32:22.590

同样，*enumerated_attribute* gem 在对象级别管理枚举。

```
enum_attr :status, %w(accepted cancelled ^pending) 
```

在迁移中定义一个字符串

```
t.string :status 
```

还提供了一些不错的功能，例如动态谓词方法。

[http://github.com/jeffp/enumerated_attribute/tree/master](http://github.com/jeffp/enumerated_attribute/tree/master)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-29T10:28:58.147

添加以下内容：

```
模块 ActiveRecord
  模块 ConnectionAdapters #:nodoc:
    类表定义
      定义枚举(*args)
        选项 = args.extract_options！
        column_names = 参数

        column_names.each { |名称| 列（名称，'枚举'，选项）}
      结尾
    结尾
  结尾
结尾

```

到 lib/enum/table_definition.rb 并将其包含在您的 init.rb 中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-29T22:28:38.413

好的，只需阅读整个 rails api 并找到我需要的，我不喜欢 :( Rails 不支持 emum 作为迁移的本机类型，[这](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html#M001936)是信息，我需要搜索插件或其他方法。

我会及时向大家发布。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T18:34:42.547

另一种选择：使用 SQL。

```
def self.up
  execute "ALTER TABLE `payments` ADD `status` ENUM('accepted', 'cancelled', 'pending')"
end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-24T23:26:36.433

使用 simple_form 我使用这个：

```
<%= f.input :gender, :collection => {'Male' => 'male','Female' => 'female'}, :include_blank => false %> 
```

# c++ - 如何在 Linux 或 Windows 中为 OS X 编译？

> ID：693952
> 
> 赞同：80
> 
> 时间：2009-03-29T01:37:27.970
> 
> 标签：c++, c, macos, cross-compiling

我想将我的 C/C++ 应用程序移植到 OS X。

我没有 Mac，但我有 Linux 和 Windows。有什么工具可以做到这一点吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-26T21:07:13.490

对于 Linux，有一个预构建的 GCC 交叉编译器（来自公开可用的 Apple 修改后的 GCC 源）。

[https://launchpad.net/~flosoft/+archive/cross-apple](https://launchpad.net/~flosoft/+archive/cross-apple)

**2015 年更新**

1.  经过这么多年，业界标准的 IDE 现在支持 OSX/iOS/Android。

[http://channel9.msdn.com/Events/Visual-Studio/Connect-event-2014/311](http://channel9.msdn.com/Events/Visual-Studio/Connect-event-2014/311)

2.  Embarcadero 的 RadStudio 还支持在 Windows 上构建 OSX/iOS/Android 应用程序。

3.  [Thomas](https://stackoverflow.com/users/1392778/thomas)的这个[答案](https://stackoverflow.com/a/19891283/1182653)还提供了一个交叉编译工具。

对于所有这些选项，您仍然需要一个真正的 mac/i 设备来测试应用程序。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-11-10T15:06:33.307

我创建了一个名为[OSXCross](https://github.com/tpoechtrager/osxcross)的项目，旨在针对 Linux 上的 OS X (10.4-10.9)。

它目前支持`clang`3.2 到 3.8（主干）（你可以使用你的 dist's `clang`）。
此外，您还可以构建最新的香草`GCC`（4.6+）。

LTO 也适用于两者，`clang`和`GCC`.

目前使用 cctools-870 和 ld64-242。

[https://github.com/tpoechtrager/osxcross](https://github.com/tpoechtrager/osxcross)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-29T01:56:06.473

似乎已经编写了[一些脚本](http://www.sandroid.org/imcross/)来帮助您为 Mac 设置交叉编译；我不能说它们有多好，或者对你的项目有多适用。在文档中，他们参考了[这些](http://www.sandroid.org/imcross/)用于 10.4 的交叉编译的说明，以及[这些](http://devs.openttd.org/%7Etruebrain/compile-farm/apple-darwin9.txt)用于 10.5 的交叉编译的说明；这些说明可能比脚本更有帮助，具体取决于脚本是否适合您的需求。

如果您的程序是免费或开源软件，那么您可能希望创建一个[MacPorts端口文件（](http://www.macports.org/)[此处](http://guide.macports.org/)的文档），并允许您的用户使用 MacPorts 构建您的程序；这通常是在 Mac OS X 上安装便携式免费或开源软件的首选方式。过去，MacPorts 可以在 Linux 上运行，因此可以在 Linux 上开发和测试您的 Portfile（尽管它显然需要在 Mac 上进行测试）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-29T14:24:08.190

1.  获取“ [VMware Player](http://www.vmware.com/download/player/) ”
2.  获取“ [Mac OS X 虚拟机映像](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=SYb&q=mac+os+x+vm+image&btnG=Search)”
3.  在新操作系统上编译/调试/集成并测试您的代码，以确保一切正常

* * *

当您尝试在多个平台上工作时，您绝对**必须**在预期平台上编译/运行/集成/测试。您不能只在一个平台上编译/运行，然后说“哦，它应该在另一个平台上同样工作”。

即使使用像 Java 这样非常好的跨平台语言，您也会遇到一些问题，即它在其他平台上的工作方式并不完全相同。

**我发现尊重我的时间/生产力/在多个平台上快速迭代的能力的唯一方法是使用其他平台的 VM。**

还有其他解决方案，例如双启动和我没有提到的解决方案，但我发现它们不尊重我的生产力/时间。

以双启动为例：

1.  我在 OS 1 上进行了更改
2.  重新启动到 OS 2
3.  在 OS 1 上忘记一些东西
4.  重新启动到 OS 1
5.  在 OS 1 上进行更改
6.  重新启动到 OS 2 ...*再次*...

**BAM 花**了我 30 分钟的时间，但我没有做*任何有*成效的事情。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-29T01:50:55.987

你肯定会以某种方式需要 OS X。即使您没有 Mac，您仍然可以尝试一些[替代方案](http://www.osx86project.org/)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-29T01:52:03.817

你需要一个工具链来交叉编译 mach-o，但即使你有这个，你也没有 Apple 库可以用来开发。不幸的是，我不确定没有它们你将如何移植。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-29T02:26:31.237

苹果开发本身就是一头奇怪的野兽。OS X 使用 GCC 的一个端口并进行了一些修改以使其“appley”。理论上，可以获取 Apple GCC 和工具链以及 Apple 内核和库头文件的源代码，并在您的 Windows 机器上构建交叉编译器。

你为什么要走这条路，我无法理解。您可以从 600 美元购买便宜的 Mac mini。你投入的时间让交叉编译器正常工作（尤其是使用用于 Unix 工具的 Windows 主机）无论如何可能花费超过 600 美元。

如果你真的热衷于让你的应用程序跨平台查看 Qt、wxWidgets 或 FLTK。所有这些都提供跨平台支持，只需对基本代码进行最少的更改。至少这样，你需要做的就是找到一台 Mac 来编译你的应用程序，如果你有一些技术头脑的朋友不介意让你通过 SSH 访问他们的 Mac，这并不难。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-08T11:47:12.250

我在网上找到了这个小文档：http: [//devs.openttd.org/~truebrain/compile-farm/apple-darwin9.txt](http://devs.openttd.org/~truebrain/compile-farm/apple-darwin9.txt)

这准确地描述了你想要什么。我自己对它很感兴趣，虽然还没有测试过（10分钟前发现的）。不过，文档似乎不错。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-12-17T15:56:58.490

您可以从[该](http://www.macincloud.com/)网站**租用云中的 mac 。**你可以从 1 美元起租到他们，这应该足够了（除非你*需要*root 访问权限，否则你会看到 49 美元以上）。

 ** * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-29T06:16:18.457

有一些交叉编译器设置，但几乎所有这些设置都用于 distcc 风格的分布式编译。据我所知，如果没有真正的 Mac，就无法直接针对 Mac 平台。在不使用 QT 或 wxWidgets 的情况下，您可以获得的最接近的是 OpenStep 与 GNUStep 或类似的，但这不是一个真正的 Cocoa 平台，只是非常接近。

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2009-03-29T02:39:00.647

简短的回答是这样的。[您将需要使用像QT](http://qtsoftware.com)这样的跨平台库。有像 QT Creator 这样的 IDE，可以让您在一个操作系统上开发并为其他操作系统生成 Makefile。有关跨平台开发的更多信息，请查看[此播客](http://www.jupiterbroadcasting.com/?cat=153)的跨平台剧集（请注意，该系列尚未结束，新剧集似乎每周都会出现）。

正如其他答案所解释的那样，您可能可以在 Windows 或 Linux 上为 Mac 编译，但您将无法测试您的应用程序，因此如果您从事专业编程或工作，您可能应该花 600 美元购买 Mac在开源软件上找到可以帮助您的 Mac 开发人员。

# php - 在代码库中查找未使用的 PHP5 类/方法

> ID：693958
> 
> 赞同：3
> 
> 时间：2009-03-29T01:42:45.163
> 
> 标签：php, reflection, maintenance, dead-code

> **可能重复：**
> [如何在 PHP 项目中找到未使用的函数](https://stackoverflow.com/questions/11532/how-can-i-find-unused-functions-in-a-php-project)

如何检查 PHP5 中未使用的代码？像下面这样的东西？

*   [使用反射](http://php.net/manual/en/language.oop5.reflection.php)扫描类
*   遵循“正常”代码[`token_get_all()`](http://php.net/manual/en/function.token-get-all.php)并使用令牌 T_NEW 查找变量，然后扫描方法调用。
*   输出类似`classname (count of new declarations) methods (count of calls)`

# silverlight - SIlverlight VSM 状态更改为 ItemsControl 中的目标项目

> ID：693960
> 
> 赞同：0
> 
> 时间：2009-03-29T01:44:13.540
> 
> 标签：silverlight, prism, visualstatemanager

我有一个 ItemsControl，其中的 Items 通过数据绑定添加到一个可观察的集合。每个项目都有一个定义其外观的数据模板。

我试图弄清楚当 VisualStateManager 将 ItemsControl 置于特定状态时，是否可以对 ItemsControl 中的每个项目应用/触发动画。

下面是一张图片 - 当项目控件进入关闭状态时 - 我希望项目控件中的项目缩小并隐藏文本并让数字变得可见。这是否可能使用 VSM 或者我是否需要在创建每个项目时将动画附加到它们，然后在我希望它们更改视觉状态时手动启动它们。

[替代文字 http://www.edefine.com/images/misc/drawing1.jpg](http://www.edefine.com/images/misc/drawing1.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T09:36:23.153

使用 ObjectAnimationUsingKeyFrames 可以做到这一点，但是这样做非常困难，会导致你扯掉头发，经常让你的视觉工作室崩溃，并且让你用简单的方法做这件事几乎没有什么好处。

简单的方法：

```
public class TestSwapContentControl : ContentControl 
{
    object StoredOriginalContent;

    public object FullContent
    {
        get { return (object)GetValue(FullContentProperty); }
        set { SetValue(FullContentProperty, value); }
    }

    // Using a DependencyProperty as the backing store for FullContent.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty FullContentProperty =
        DependencyProperty.Register(
            "FullContent"
            , typeof(object)
            , typeof(TestSwapContentControl)
            , null);

    public void SwitchToFullContent()
    {
        if (FullContent != null)
        {
            StoredOriginalContent = Content;
            Content = FullContent;
        }
    }

    public void SwitchToNormalContent()
    {
        if(StoredOriginalContent != null)
        {
            Content = StoredOriginalContent;
        }
    }
} 
```

然后要使用的xaml：

```
 <local:TestSwapContentControl x:Name="mySwitch">
            <Rectangle Height="50" Width="100" Fill="Black" />
        <local:TestSwapContentControl.FullContent>
                <StackPanel>
                    <TextBlock>1</TextBlock>
                    <TextBlock>2</TextBlock>
                    <TextBlock>3</TextBlock>
                    <TextBlock>4</TextBlock>
                    <Rectangle Height="50" Width="100" Fill="Red" />
                </StackPanel>
            </local:TestSwapContentControl.FullContent>
    </local:TestSwapContentControl> 
```

在页面中使用以下cs：

```
 private void Button_Click(object sender, RoutedEventArgs e)
    {
        if (myTempBool)
        {
            mySwitch.SwitchToFullContent();
            myTempBool = false;
        }
        else
        {
            mySwitch.SwitchToNormalContent();
            myTempBool = true;
        }
    } 
```

现在，如果您真的需要让其他开发人员完全可以扩展控件，您将需要使用 visualstatemenager，但它确实是个婊子。如果您不知道如何通过 generic.xaml 设置可视状态管理器和状态，这里有一个操作指南：

[http://scorbs.com/2008/06/11/parts-states-model-with-visualstatemanager-part-1-of/](http://scorbs.com/2008/06/11/parts-states-model-with-visualstatemanager-part-1-of/)

这是一个工作示例，但它并不完美，因为我似乎无法直接设置 ContentPresenter 的内容。

```
using System.Windows;
using System.Windows.Controls;

namespace SilverlightTestApplication
{
    [TemplateVisualState(Name="Normal", GroupName="SizeStates")]
    [TemplateVisualState(Name="Expanded", GroupName="SizeStates")]
    public class TestVSMControl : ContentControl
    {
        public object SmallContent
        {
            get { return (object)GetValue(SmallContentProperty); }
            set { SetValue(SmallContentProperty, value); }
        }

        // Using a DependencyProperty as the backing store for SmallContent.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty SmallContentProperty =
            DependencyProperty.Register("SmallContent", typeof(object), typeof(TestVSMControl), null);

        public object LargeContent
        {
            get { return (object)GetValue(LargeContentProperty); }
            set { SetValue(LargeContentProperty, value); }
        }

        // Using a DependencyProperty as the backing store for LargeContent.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty LargeContentProperty =
            DependencyProperty.Register("LargeContent", typeof(object), typeof(TestVSMControl), null);

        public bool Pressed
        {
            get { return (bool)GetValue(PressedProperty); }
            set { SetValue(PressedProperty, value); }
        }

        // Using a DependencyProperty as the backing store for Pressed.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty PressedProperty =
            DependencyProperty.Register("Pressed", typeof(bool), typeof(TestVSMControl), 
                new PropertyMetadata(new PropertyChangedCallback(PressedPropertyChanged)));

        static void PressedPropertyChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            var me = sender as TestVSMControl;
            me.ChangeState();
        }

        public TestVSMControl()
        {
            DefaultStyleKey = typeof(TestVSMControl);
        }

        void ChangeState()
        {
            GoToState(true);
        }

        private void GoToState(bool useTransitions)
        {
            if (Pressed)
            {
                VisualStateManager.GoToState(this, "Normal", useTransitions);
            }
            else
            {
                VisualStateManager.GoToState(this, "Expanded", useTransitions);
            }
        }
    }
} 
```

在您的 generic.xaml 中（包括 xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"）：

```
<Style TargetType="local:TestVSMControl">        
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="local:TestVSMControl">
                <StackPanel>
                    <vsm:VisualStateManager.VisualStateGroups>
                        <vsm:VisualStateGroup x:Name="SizeStates">
                            <vsm:VisualState x:Name="Normal">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Content" Storyboard.TargetName="myContentPresenter" BeginTime="00:00:00" Duration="00:00:00.0010000" >
                                        <ObjectAnimationUsingKeyFrames.KeyFrames>
                                            <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <StackPanel>
                                                        <TextBlock>Rararasputin</TextBlock>
                                                        <Button Content="{TemplateBinding SmallContent}" />
                                                    </StackPanel>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames.KeyFrames>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </vsm:VisualState>
                            <vsm:VisualState x:Name="Expanded">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Content" Storyboard.TargetName="myContentPresenter" BeginTime="00:00:00" Duration="00:00:00.0010000" >
                                         <ObjectAnimationUsingKeyFrames.KeyFrames>
                                            <DiscreteObjectKeyFrame KeyTime="0:0:0"  >
                                                <DiscreteObjectKeyFrame.Value>
                                                    <StackPanel>
                                                        <TextBlock>Other one</TextBlock>
                                                        <Button Content="{TemplateBinding LargeContent}" />
                                                    </StackPanel>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames.KeyFrames>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </vsm:VisualState>
                        </vsm:VisualStateGroup>
                    </vsm:VisualStateManager.VisualStateGroups>                        
                    <ContentPresenter x:Name="myContentPresenter" />
                </StackPanel>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

以及如何在您的页面中使用：

```
 <local:TestVSMControl x:Name="myVSMControl" Height="200">
                <local:TestVSMControl.SmallContent>
                    <Rectangle Height="50" Width="100" Fill="Red" />
                </local:TestVSMControl.SmallContent>
                <local:TestVSMControl.LargeContent>
                    <Rectangle Height="50" Width="100" Fill="Green" />
                </local:TestVSMControl.LargeContent>        
            </local:TestVSMControl>
            <Button Content="Swap" x:Name="VSMButton" Click="VSMButton_Click"  /> 
```

在您的页面中包含以下内容：

```
 private void VSMButton_Click(object sender, RoutedEventArgs e)
    {
        myVSMControl.Pressed = !myVSMControl.Pressed;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T02:05:37.590

如果您正在谈论 Silverlight 视觉状态管理器，恐怕这是不可能的。

VisualStates 仅包含 Storyboard 对象，而 Storyboard 对象又包含动画。据我所知，您无法使用它更改模板。

我不确定 WPF VisualStateManager 的功能。

# javascript - 如何从 actionscript 中读取全局 javascript 变量

> ID：693971
> 
> 赞同：4
> 
> 时间：2009-03-29T01:52:30.850
> 
> 标签：javascript, actionscript, externalinterface

鉴于我的网页上有一个名为 myVar 的全局 javascript 变量，我如何使用 javascript 从我的 flash 电影中访问变量 myVar 的值？

我看到很多使用外部接口从 actionscript 执行 javascript 的示例，但我无法找到使用 actionscript 将值返回到 Flash 电影的示例。

提前致谢。我希望我的问题足够清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-29T02:04:41.290

ExternalInterface 的工作原理是允许 JavaScript 调用电影中的 ActionScript 函数，反之亦然。您可以选择从调用的函数接收返回值。这是一个非常简单的例子：

JavaScript：

```
<script language="JavaScript">
    function getMyVar()
    {
        return myVar;
    }
</script> 
```

闪存/AS：

```
import flash.external.ExternalInterface;
var result:string = ExternalInterface.call("getMyVar"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-26T14:19:36.897

您还可以提供一个匿名函数，将您的全局变量值返回给`ExternalInterface.call`方法，如下所示：

```
ExternalInterface.call("function(){ return myGlobalVariable; }"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T03:18:51.083

我注意到 Rex M 的回答有点不完整。

他是正确的使用...

```
import flash.external.ExternalInterface;
var result:string = ExternalInterface.call("getMyVar"); 
```

然后在你的javascript中你可以使用

```
<script language="JavaScript">
    function getMyVar() {
        return myVar;
    }
</script> 
```

然而，为了使用它，flash 电影必须在通过 http 访问的 html 中。不使用文件：//

这是一个从 actionscript 到 javascript 的通信教程，反之亦然。 [http://www.youtube.com/watch?v=_1a6CPPG-Og&feature=plcp](http://www.youtube.com/watch?v=_1a6CPPG-Og&feature=plcp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-22T21:29:16.903

你也可以这样做：

```
ExternalInterface.call("eval","getVar=function(obj){return obj}");
var yourVar:String = ExternalInterface.call("eval","getVar(JSvar)"); 
```

# c# - 加密 API <-> .NET RSA 互操作性

> ID：693974
> 
> 赞同：0
> 
> 时间：2009-03-29T01:55:59.937
> 
> 标签：c#, rsa, cryptoapi

我有一个使用 Crypto API 生成 RC4 加密密钥的非托管应用程序。此非托管应用程序使用此 RC4 密钥加密某些数据。还有一个客户端非托管应用程序使用此 RC4 密钥来解密信息。

但是，对于这个客户端应用程序，我们正在发送一个会话密钥 -> 使用在客户端生成的 RSA 公钥（SIMPLEBLOB）加密的 RC4 密钥。加密会话密钥的生成过去是使用非托管代码完成的，但现在必须将其转换为 C#，因为需要在部分信任下从 Web 应用程序运行此代码。

密钥是使用生成的

```
CryptGenKey(hProv, CALG_RC4, KEY_LENGTH | CRYPT_EXPORTABLE, &hKey); 
```

它被导出到文件系统使用

```
CryptExportKey(hKey, 0, OPAQUEKEYBLOB, 0, lpBuffer, &nSize); 
```

（注意我能够使用这篇文章 [http://www.codeproject.com/KB/security/plaintextsessionkey.aspx](http://www.codeproject.com/KB/security/plaintextsessionkey.aspx)导出纯文本密钥）

客户端公钥是使用创建的

```
CryptGetUserKey(hProv, AT_KEYEXCHANGE, &hKeyPair); 
```

使用导出客户端公钥

```
CryptExportKey(hKeyPair, 0, PUBLICKEYBLOB, 0, lpData, &nSize); 
```

会话密钥是在服务器端使用创建的

1.  客户端公钥是使用导入的

    CryptImportKey(hProv, lpData, nSize, NULL, 0, &hPublicKey

2.  会话密钥是通过使用客户端公钥加密 RC4 生成 SIMPLEBOB 格式来生成的

    CryptExportKey(hKey, hPublicKey, SIMPLEBOB, 0, lpData, &nSize);

现在我的要求是在托管版本中执行上述步骤（步骤 1 和 2），这就是我正在做的事情：

//读取使用代码项目文章提取的纯文本密钥数据 byte[] keyMaterial = File.ReadAllBytes(@"C:\keyMaterial.txt");

// 导入客户端公钥

```
CspParameters cspParams = new CspParameters();
            cspParams.KeyContainerName = "Container Name";
            cspParams.KeyNumber = (int)KeyNumber.Exchange;
            cspParams.ProviderType = 1;
            cspParams.ProviderName = "Microsoft Enhanced Cryptographic Provider v1.0";
            cspParams.Flags = CspProviderFlags.UseMachineKeyStore;

            RSACryptoServiceProvider rsaClient = new RSACryptoServiceProvider(cspParams);   
            rsaClient.ImportCspBlob(File.ReadAllBytes(@"C:\client.key"));

//Generate a SIMPLEBLOB session key
byte[] session = GetRC4SessionBlobFromKey(keyMaterial, rsaClient);

//Encrypt a key using public key and write it in a SIMPLEBLOB format
public byte[] GetRC4SessionBlobFromKey(byte[] keyData, RSACryptoServiceProvider publicKey)
        {  
            using(MemoryStream ms = new MemoryStream())  
            using(BinaryWriter w = new BinaryWriter(ms))
            {   
                w.Write((byte) 0x01); // SIMPLEBLOB    
                w.Write((byte) 0x02); // Version 2    
                w.Write((byte) 0x00); // Reserved    
                w.Write((byte) 0x00); // Reserved    
                w.Write(0x00006801);  // ALG_ID = RC4 for the encrypted key.
                w.Write(0x0000a400);  // CALG_RSA_KEYX    

                w.Write(publicKey.Encrypt(keyData, false));
                w.Flush();

                return ms.ToArray();  
            }
        } 
```

这会生成与其非托管版本相同大小的数据，但它不会像非托管版本的第 1 步和第 2 步那样生成正确的 SIMPLEBLOB 会话密钥。我在这段代码中做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-08T14:07:13.263

我是这里的新手，但我刚刚在 MSDN 文档中阅读了以下内容：

**与 Microsoft 加密 API (CAPI) 的互操作**

**与非托管 CAPI 中的 RSA 实现不同，RSACryptoServiceProvider 类在加密之后和解密之前反转加密字节数组的顺序。默认情况下，使用 RSACryptoServiceProvider 类加密的数据不能被 CAPI CryptDecrypt 函数解密，使用 CAPI CryptEncrypt 方法加密的数据不能被 RSACryptoServiceProvider 类解密。**

***如果在 API 之间进行互操作时不补偿反向排序，则 RSACryptoServiceProvider 类将引发 CryptographicException。***

这可能是问题吗？

# java - 如何在 Java 中为 Android 设置 HttpResponse 超时

> ID：693997
> 
> 赞同：336
> 
> 时间：2009-03-29T02:15:24.557
> 
> 标签：java, android, timeout, httpresponse

我创建了以下函数来检查连接状态：

```
private void checkConnectionStatus() {
    HttpClient httpClient = new DefaultHttpClient();

    try {
      String url = "http://xxx.xxx.xxx.xxx:8000/GaitLink/"
                   + strSessionString + "/ConnectionStatus";
      Log.d("phobos", "performing get " + url);
      HttpGet method = new HttpGet(new URI(url));
      HttpResponse response = httpClient.execute(method);

      if (response != null) {
        String result = getResponse(response.getEntity());
        ... 
```

当我关闭服务器以测试执行时，在线等待很长时间

```
HttpResponse response = httpClient.execute(method); 
```

有谁知道如何设置超时以避免等待太久？

谢谢！

* * *

## 回答 #1

> 赞同：625
> 
> 时间：2009-10-14T09:39:11.340

在我的示例中，设置了两个超时。连接超时抛出`java.net.SocketTimeoutException: Socket is not connected`和套接字超时`java.net.SocketTimeoutException: The operation timed out`。

```
HttpGet httpGet = new HttpGet(url);
HttpParams httpParameters = new BasicHttpParams();
// Set the timeout in milliseconds until a connection is established.
// The default value is zero, that means the timeout is not used. 
int timeoutConnection = 3000;
HttpConnectionParams.setConnectionTimeout(httpParameters, timeoutConnection);
// Set the default socket timeout (SO_TIMEOUT) 
// in milliseconds which is the timeout for waiting for data.
int timeoutSocket = 5000;
HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);

DefaultHttpClient httpClient = new DefaultHttpClient(httpParameters);
HttpResponse response = httpClient.execute(httpGet); 
```

如果您想设置任何现有 HTTPClient 的参数（例如 DefaultHttpClient 或 AndroidHttpClient），您可以使用函数**setParams()**。

```
httpClient.setParams(httpParameters); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-29T15:56:34.920

要在客户端上设置设置：

```
AndroidHttpClient client = AndroidHttpClient.newInstance("Awesome User Agent V/1.0");
HttpConnectionParams.setConnectionTimeout(client.getParams(), 3000);
HttpConnectionParams.setSoTimeout(client.getParams(), 5000); 
```

我已经在 J​​ellyBean 上成功使用了它，但也应该适用于旧平台....

高温高压

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-29T02:23:58.343

如果您使用的是 Jakarta 的[http 客户端库](http://hc.apache.org/httpclient-3.x/)，那么您可以执行以下操作：

```
 HttpClient client = new HttpClient();
        client.getParams().setParameter(HttpClientParams.CONNECTION_MANAGER_TIMEOUT, new Long(5000));
        client.getParams().setParameter(HttpClientParams.SO_TIMEOUT, new Integer(5000));
        GetMethod method = new GetMethod("http://www.yoururl.com");
        method.getParams().setParameter(HttpMethodParams.SO_TIMEOUT, new Integer(5000));
        method.getParams().setParameter(HttpMethodParams.RETRY_HANDLER,
        int statuscode = client.executeMethod(method); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-01-15T02:57:55.550

如果您使用的是默认的 http 客户端，以下是使用默认 http 参数的方法：

```
HttpClient client = new DefaultHttpClient();
HttpParams params = client.getParams();
HttpConnectionParams.setConnectionTimeout(params, 3000);
HttpConnectionParams.setSoTimeout(params, 3000); 
```

原始信用转到[http://www.jayway.com/2009/03/17/configuring-timeout-with-apache-httpclient-40/](http://www.jayway.com/2009/03/17/configuring-timeout-with-apache-httpclient-40/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-07-26T23:54:31.353

对于那些说@kuester2000的答案不起作用的人，请注意HTTP请求，首先尝试通过DNS请求找到主机IP，然后向服务器发出实际的HTTP请求，因此您可能还需要设置一个DNS 请求超时。

如果您的代码在 DNS 请求没有超时的情况下工作，那是因为您能够访问 DNS 服务器，或者您正在访问 Android DNS 缓存。顺便说一句，您可以通过重新启动设备来清除此缓存。

此代码扩展了原始答案以包含具有自定义超时的手动 DNS 查找：

```
//Our objective
String sURL = "http://www.google.com/";
int DNSTimeout = 1000;
int HTTPTimeout = 2000;

//Get the IP of the Host
URL url= null;
try {
     url = ResolveHostIP(sURL,DNSTimeout);
} catch (MalformedURLException e) {
    Log.d("INFO",e.getMessage());
}

if(url==null){
    //the DNS lookup timed out or failed.
}

//Build the request parameters
HttpParams params = new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(params, HTTPTimeout);
HttpConnectionParams.setSoTimeout(params, HTTPTimeout);

DefaultHttpClient client = new DefaultHttpClient(params);

HttpResponse httpResponse;
String text;
try {
    //Execute the request (here it blocks the execution until finished or a timeout)
    httpResponse = client.execute(new HttpGet(url.toString()));
} catch (IOException e) {
    //If you hit this probably the connection timed out
    Log.d("INFO",e.getMessage());
}

//If you get here everything went OK so check response code, body or whatever 
```

使用方法：

```
//Run the DNS lookup manually to be able to time it out.
public static URL ResolveHostIP (String sURL, int timeout) throws MalformedURLException {
    URL url= new URL(sURL);
    //Resolve the host IP on a new thread
    DNSResolver dnsRes = new DNSResolver(url.getHost());
    Thread t = new Thread(dnsRes);
    t.start();
    //Join the thread for some time
    try {
        t.join(timeout);
    } catch (InterruptedException e) {
        Log.d("DEBUG", "DNS lookup interrupted");
        return null;
    }

    //get the IP of the host
    InetAddress inetAddr = dnsRes.get();
    if(inetAddr==null) {
        Log.d("DEBUG", "DNS timed out.");
        return null;
    }

    //rebuild the URL with the IP and return it
    Log.d("DEBUG", "DNS solved.");
    return new URL(url.getProtocol(),inetAddr.getHostAddress(),url.getPort(),url.getFile());
} 
```

这门课来自[这篇博文](http://thushw.blogspot.com/2009/11/resolving-domain-names-quickly-with.html "这篇博文")。如果你会使用它，去检查一下备注。

```
public static class DNSResolver implements Runnable {
    private String domain;
    private InetAddress inetAddr;

    public DNSResolver(String domain) {
        this.domain = domain;
    }

    public void run() {
        try {
            InetAddress addr = InetAddress.getByName(domain);
            set(addr);
        } catch (UnknownHostException e) {
        }
    }

    public synchronized void set(InetAddress inetAddr) {
        this.inetAddr = inetAddr;
    }
    public synchronized InetAddress get() {
        return inetAddr;
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-08-07T04:15:15.970

一个选项是使用来自 Square的[OkHttp客户端。](http://square.github.io/okhttp/)

**添加库依赖**

在 build.gradle 中，包含以下行：

```
compile 'com.squareup.okhttp:okhttp:x.x.x' 
```

*`x.x.x`所需的库版本在哪里。*

**设置客户端**

例如，如果您想设置 60 秒的超时，请执行以下操作：

```
final OkHttpClient okHttpClient = new OkHttpClient();
okHttpClient.setReadTimeout(60, TimeUnit.SECONDS);
okHttpClient.setConnectTimeout(60, TimeUnit.SECONDS); 
```

* * *

ps：如果你的 minSdkVersion 大于 8，可以使用`TimeUnit.MINUTES`. 因此，您可以简单地使用：

```
okHttpClient.setReadTimeout(1, TimeUnit.MINUTES);
okHttpClient.setConnectTimeout(1, TimeUnit.MINUTES); 
```

有关单位的更多详细信息，请参阅[TimeUnit](http://developer.android.com/reference/java/util/concurrent/TimeUnit.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-03T12:38:05.287

```
HttpParams httpParameters = new BasicHttpParams();
            HttpProtocolParams.setVersion(httpParameters, HttpVersion.HTTP_1_1);
            HttpProtocolParams.setContentCharset(httpParameters,
                    HTTP.DEFAULT_CONTENT_CHARSET);
            HttpProtocolParams.setUseExpectContinue(httpParameters, true);

            // Set the timeout in milliseconds until a connection is
            // established.
            // The default value is zero, that means the timeout is not used.
            int timeoutConnection = 35 * 1000;
            HttpConnectionParams.setConnectionTimeout(httpParameters,
                    timeoutConnection);
            // Set the default socket timeout (SO_TIMEOUT)
            // in milliseconds which is the timeout for waiting for data.
            int timeoutSocket = 30 * 1000;
            HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-09-04T22:50:35.627

如果您使用的是，请按[此处](http://developer.android.com/reference/java/net/URLConnection.html#setConnectTimeout(int))`HttpURLConnection`所述调用：`setConnectTimeout()`

```
URL url = new URL(myurl);
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
conn.setConnectTimeout(CONNECT_TIMEOUT); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-11-24T07:37:28.437

您可以通过 Httpclient-android-4.3.5 的方式创建 HttpClient 实例，它可以正常工作。

```
 SSLContext sslContext = SSLContexts.createSystemDefault();
        SSLConnectionSocketFactory sslsf = new SSLConnectionSocketFactory(
                sslContext,
                SSLConnectionSocketFactory.STRICT_HOSTNAME_VERIFIER);
                RequestConfig.Builder requestConfigBuilder = RequestConfig.custom().setCircularRedirectsAllowed(false).setConnectionRequestTimeout(30*1000).setConnectTimeout(30 * 1000).setMaxRedirects(10).setSocketTimeout(60 * 1000);
        CloseableHttpClient hc = HttpClients.custom().setSSLSocketFactory(sslsf).setDefaultRequestConfig(requestConfigBuilder.build()).build(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-27T06:28:24.787

```
public boolean isInternetWorking(){
    try {
        int timeOut = 5000;
        Socket socket = new Socket();
        SocketAddress socketAddress = new InetSocketAddress("8.8.8.8",53);
        socket.connect(socketAddress,timeOut);
        socket.close();
        return true;
    } catch (IOException e) {
        //silent
    }
    return false;
} 
```*******************