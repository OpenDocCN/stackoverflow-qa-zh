# StackOverflow 问答 000209000-000209999

# matlab - How do properties work in Object Oriented MATLAB?

> ID：209005
> 
> 赞同：29
> 
> 时间：2008-10-16T15:22:20.350
> 
> 标签：matlab, oop, properties, matlab-class

I am trying to create a MATLAB class with a member variable that's being updated as a result of a method invocation, but when I try to change the property within the class it (apperently, from what I understood from MATLAB's memory management) creates a copy of the object and then modifies it, leaving the original object's property untouched.

```
classdef testprop  
    properties  
        numRequests=0;  
    end  
    methods  
        function Request(this, val)  
            disp(val);  
            this.numRequests=this.numRequests+1;  
        end  
    end  
end 
```

.

```
>> a=testprop;
>> a.Request(9);
>> a.Request(5);  
>> a.numRequests  

ans = 0 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-16T15:53:41.037

### 使用香草类

使用 vanilla 类时，您需要告诉 Matlab 存储对象的修改副本以保存属性值的更改。所以，

```
>> a=testprop
>> a.Request(5); % will NOT change the value of a.numRequests.
5

>> a.Request(5) 
5

>> a.numRequests
ans = 
       0

>> a=a.Request; % However, this will work but as you it makes a copy of variable, a.
5

>> a=a.Request; 
5

>> a.numRequests
ans =
       2 
```

### 使用句柄类

如果从句柄类继承，那就是

```
classdef testprop < handle 
```

然后你可以写，

```
>> a.Request(5);
>> a.Request(5);
>> a.numRequests
ans = 
       2 
```

### 更新：使用香草类

正如[Kamran](https://stackoverflow.com/questions/209005/object-oriented-matlab-properties/673190#673190)为上述工作所指出的，`Request`需要更改问题示例代码中的方法定义以包含类型*testprop*的输出参数。

谢谢卡姆兰。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-10T16:15:42.203

您必须记住，在 Matlab 中的语法上，您可能更接近于 C，而不是 C++ 或 Java，至少在对象方面是这样。因此，如果您想更改值对象（实际上只是一个特殊的`struct`）的“内容”，则需要从函数中返回该对象。

Azim 正确地指出，如果您想要[单例](http://en.wikipedia.org/wiki/Singleton_pattern)行为（从您的代码来看，您似乎是这样），您需要使用“句柄”类。从 Handle 派生的类的实例都指向一个实例，并且只对它进行操作。

您可以[阅读有关 Value 和 Handle 类之间差异的更多信息。](https://www.mathworks.com/help/matlab/matlab_oop/comparing-handle-and-value-classes.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-23T12:26:10.703

我创建了**testprop**类并尝试执行 Azim 建议的代码，但它不起作用。当我执行以下命令时：

```
a=a.Request(1) 
```

产生了以下错误：

> ？？？使用 ==> 时出错请求输出参数过多。

**我认为问题在于我们在声明Request**方法时没有确定任何输出。所以我们应该把它改成：

```
function this = Request(this, val) 
```

现在：

```
>> a = testprop;
>> a = a.Request(1);        
>> a.numRequests

ans = 1 
```

# agile - Scrum 和极限编程有什么区别？

> ID：209011
> 
> 赞同：25
> 
> 时间：2008-10-16T15:23:59.253
> 
> 标签：agile, scrum, methodology, extreme-programming

几年前，我参与了一个全新的项目，在那里我们进行了极限编程。我也看到很多人提到 Scrum 方法论。

有人能告诉我 Scrum 和 XP 之间的主要区别吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-16T15:30:12.363

Scrum 是一种软件开发方法，XP 是一种编程实践。两者都是“敏捷”技术，经常一起使用。

Scrum 概述了一个流程，用于识别和分类需要完成的工作，通过与客户或客户代表沟通来确定工作的优先级，并使用迭代发布来实施该工作。

当我的团队第一次开始试验 Scrum 时，我发现[实施 Scrum](http://www.implementingscrum.com/)网站很有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-06T07:05:45.927

Scrum 是用于构建具有高度复杂性和不确定性的产品的轻量级框架。它不是一种方法论，因为可以选择方法论和实践并将其与 Scrum 结合使用。它不仅仅针对软件开发，也可以用于其他类型的项目。

在软件工程方面，Scrum 没有定义要遵循的实践或遵循的方法，因为它不想为特定产品和环境规定什么是最好的。

许多 Scrum 团队使用多种 XP 实践，例如测试、反馈、结对编程和简单性。

核心差异

*   Scrum 计划冲刺并且不鼓励改变。XP 更愿意改变。
*   XP 会立即征求反馈，Scrum 至少会在 Sprint Review 时征求反馈，但 Scrum 不会尽可能拒绝早期反馈。
*   XP专注于编程，Scrum可用于非软件产品
*   Scrum 没有定义如何进行开发，但许多 Scrum 团队实施了许多 XP 实践

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T15:31:42.173

我在这两个方面都工作过。一些主要区别在于 SCRUM 专注于更短的结构化冲刺，并优先考虑积压的项目。XP 的一些重点更多地放在配对编程、任务优先级和更多的测试驱动开发上。两者都在迭代中工作，并且都足够灵活以处理易变的变化项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T15:30:26.683

Scrum 是敏捷开发方法论的一个组成部分，涉及为讨论进展而举行的每日会议，而 XP 是另一种强调结对编程和测试优先开发的方法论。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T05:03:01.207

Scrum 的主要目标是估计开发需要多长时间。XP 更多的是帮助开发人员尽可能快速和可维护地完成工作。

# documentation - 什么是自记录代码，它可以取代有良好记录的代码吗？

> ID：209015
> 
> 赞同：261
> 
> 时间：2008-10-16T15:24:55.307
> 
> 标签：documentation, comments

我有一位同事坚持认为他的代码不需要注释，这是“自我记录”。

我查看了他的代码，虽然它比我看到其他人编写的代码更清晰，但我仍然不同意自文档代码与注释和文档代码一样完整和有用。

帮助我理解**他**的观点。

*   什么是自记录代码
*   它真的可以取代注释良好和记录良好的代码吗
*   是否存在比有据可查和注释的代码更好的情况
*   有没有代码不可能在没有注释的情况下自我记录的例子

也许这只是我自己的局限性，但我不明白它如何成为一个好的做法。

这并不是要成为一个论点 - 请不要提出为什么注释良好和记录良好的代码是高优先级的原因 - 有很多资源表明这一点，但它们并不能说服我的同行。我相信我需要更充分地理解他的观点才能说服他。如果必须，请提出一个新问题，但不要在这里争论。

另外，那些反对自我记录代码的人——这主要是为了帮助我理解自我记录代码传播者的观点（即积极的方面）。

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2008-10-16T15:36:02.477

好吧，既然这是关于注释和代码的，让我们看一些实际的代码。比较这个典型的代码：

```
float a, b, c; a=9.81; b=5; c= .5*a*(b^2); 
```

对于这个自我记录的代码，它显示*了*正在做的事情：

```
const float gravitationalForce = 9.81;
float timeInSeconds = 5;
float displacement = (1 / 2) * gravitationalForce * (timeInSeconds ^ 2); 
```

然后是这个记录在案的代码，它更好地解释了*为什么*要这样做：

```
/* compute displacement with Newton's equation x = vₒt + ½at² */
const float gravitationalForce = 9.81;
float timeInSeconds = 5;
float displacement = (1 / 2) * gravitationalForce * (timeInSeconds ^ 2); 
```

最终版本的*代码作为文档*需要零注释：

```
float computeDisplacement(float timeInSeconds) {
    const float gravitationalForce = 9.81;
    float displacement = (1 / 2) * gravitationalForce * (timeInSeconds ^ 2);
    return displacement;
} 
```

这是一个糟糕的评论风格的例子：

```
const float a = 9.81; //gravitational force
float b = 5; //time in seconds
float c = (1/2)*a*(b^2) //multiply the time and gravity together to get displacement. 
```

在最后一个例子中，当变量应该被描述性命名时使用注释，当我们可以清楚地看到操作是什么时，总结了操作的结果。在任何一天，我都更喜欢自我记录的第二个示例，也许这就是你的朋友在说自我记录的代码时所说的。

我会说这取决于你正在做的事情的背景。对我来说，在这种情况下，自我记录的代码可能就足够了，但是详细说明背后的方法（在这个例子中，方程）的注释也是有用的。

* * *

## 回答 #2

> 赞同：182
> 
> 时间：2008-10-16T15:33:38.690

在我看来，任何代码都应该是自记录的。在良好的、自记录的代码中，您不必解释每一行，因为每个标识符（变量、方法、类）都有一个清晰的*语义*名称。有多余的评论实际上会使阅读代码变得更加困难（！），所以如果你的同事

*   为每个类、成员、类型和方法编写文档注释（Doxygen、JavaDoc、XML 注释等）和
*   *清楚地注释代码中不是*自记录的任何部分，并且
*   为解释意图的每个代码块编写注释，或者代码在更高的抽象级别上做了什么（即*查找所有大于 10 MB*的文件，而不是*循环遍历目录中的所有文件，测试文件大小是否大于 10 MB，如果为真则返回*）

在我看来，他的代码和文档很好。请注意，自我记录的代码并不**意味着**不应该有注释，而只是说不应该有不必要的注释。然而，问题是，通过阅读代码（包括注释和文档注释）应该可以立即理解代码的作用和原因。如果“自我记录”代码比注释代码需要更长的时间来理解，那么它并不是真正的自我记录。

* * *

## 回答 #3

> 赞同：173
> 
> 时间：2008-10-16T15:27:11.620

代码本身总是对您的代码所做的最新解释，但在我看来，它很难解释*意图*，这是注释中最重要的方面。如果编写得当，我们已经知道代码做*了什么*，我们只需要知道它到底*为什么会这样做*！

* * *

## 回答 #4

> 赞同：99
> 
> 时间：2008-10-16T16:16:44.157

曾经有人说过

> 1) 只为难以理解的代码写注释。
> 2）尽量不要编写难以理解的代码。

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2008-10-16T15:33:28.830

“自我记录”代码背后的想法是代码中的实际程序逻辑非常清晰，可以向阅读代码的任何人解释代码在做什么以及为什么要这样做。

在我看来，真正的自我记录代码的想法是一个神话。代码可以告诉您正在发生的事情背后的逻辑，但它无法解释**为什么**以某种方式完成它，特别是如果有不止一种方法可以解决问题。仅仅因为这个原因，它永远无法取代**注释良好**的代码。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-16T21:43:07.197

我认为这与质疑特定代码行是否是自记录的有关，但最终如果您不了解一段代码的结构和功能，那么大多数时候注释将无济于事。以 amdfan 的“正确注释”代码为例：

```
/* compute displacement with Newton's equation x = v0t + ½at^2 */
const float gravitationalForce = 9.81;
float timeInSeconds = 5;
float displacement = (1 / 2) * gravitationalForce * (timeInSeconds ^ 2); 
```

这段代码很好，但以下代码在大多数现代软件系统中同样提供信息，并且明确认识到使用牛顿计算是一种选择，如果其他一些物理范式更合适，可以改变：

```
const float accelerationDueToGravity = 9.81;
float timeInSeconds = 5;
float displacement = NewtonianPhysics.CalculateDisplacement(accelerationDueToGravity, timeInSeconds); 
```

以我个人的经验，很少有“正常”的编码情况是绝对需要注释的。例如，您最终多久滚动一次自己的算法？基本上，其他一切都是构建系统的问题，以便编码人员可以理解正在使用的结构以及驱使系统使用这些特定结构的选择。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-16T15:32:22.983

我忘记了我从哪里得到的，但是：

> 程序中的每一条评论都像是对读者的道歉。“很抱歉，我的代码太不透明了，以至于您无法通过查看它来理解它”。我们只需要接受我们并不完美，而是努力做到完美，并在需要时继续道歉。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2008-10-16T15:51:17.797

首先，很高兴听到您同事的代码实际上比您见过的其他代码更清晰。这意味着他可能不会以“自我记录”为借口，懒得评论他的代码。

自文档代码是不需要自由文本注释的代码，知情的读者可以理解它在做什么。例如，这段代码是自记录的：

```
print "Hello, World!" 
```

这是这样的：

```
factorial n = product [1..n] 
```

这是这样的：

```
from BeautifulSoup import BeautifulSoup, Tag

def replace_a_href_with_span(soup):
    links = soup.findAll("a")
    for link in links:
        tag = Tag(soup, "span", [("class", "looksLikeLink")])
        tag.contents = link.contents
        link.replaceWith(tag) 
```

现在，这种“知情读者”的想法是非常主观和情境化的。如果您或其他任何人在遵循您同事的代码时遇到问题，那么他最好重新评估他对知情读者的看法。为了调用代码自文档化，必须假定对所使用的语言和库有一定程度的熟悉。

我见过的编写“自记录代码”的最佳论据是，它避免了自由文本评论与编写的代码不一致的问题。最好的批评是，虽然代码可以描述它自己在做*什么*和*如何*做，但它不能解释*为什么*某事以某种方式完成。

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2008-10-16T17:57:22.533

自记录代码是“DRY”（不要重复自己）的一个很好的例子。不要在代码本身中或可能存在的注释中重复信息。

与其解释变量的用途，不如重命名变量。

与其解释一小段代码的作用，不如将其提取到一个方法中并给它一个描述性的名称（可能是您的注释文本的缩短版本）。

与其解释一个复杂的测试做了什么，不如把它提取到一个方法中并给它一个好名字。

等等。

在此之后，您最终会得到不需要太多解释的代码，它会自行解释，因此您应该删除仅在代码中重复信息的注释。

这并不意味着您根本没有评论，有些信息您不能放入代码中，例如有关意图的信息（“为什么”）。在理想情况下，代码和注释相互补充，每一个都增加了独特的解释价值，而不会在另一个中重复信息。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2008-10-16T15:37:50.100

自记录代码是一种很好的做法，如果做得好，可以很容易地传达代码的含义，而无需阅读太多注释。特别是在团队中的每个人都很好理解该领域的情况下。

话虽如此，评论对于新手或测试人员或生成文档/帮助文件非常有帮助。

自我记录的代码 + 必要的注释将大大有助于帮助跨团队的人。

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-10-16T15:37:10.007

为了：

*   自文档代码是向读者清楚地表达其意图的代码。
*   不是完全。评论总是有助于评论*为什么*选择特定策略。然而，解释一段代码正在做什么的注释*表明*代码的自我记录不足，可能需要进行一些重构。
*   评论撒谎并过时。代码~~总是告诉~~更有可能说真话。
*   我从未见过没有注释就无法清楚地说明代码内容的情况*。*但是，就像我之前所说的，有时有必要/有帮助，包括对*原因*的评论。

然而，重要的是要注意，真正的自我记录代码需要大量的自我和团队纪律。你必须学习更多的声明式编程，你必须非常谦虚，避免“聪明”的代码，而支持那些显而易见的代码，似乎任何人都可以编写它。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-10-21T22:09:05.330

当您阅读“自记录代码”时，您会看到它在做什么，但您不能总是猜到它为什么以这种特定方式做。

有大量的非编程约束，如业务逻辑、安全性、用户需求等。

当您进行维护时，这些背景信息变得非常重要。

只是我的一小撮盐...

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2008-10-16T15:35:47.030

首先，请考虑以下代码段：

```
/**
 * Sets the value of foobar.
 *
 * @foobar is the new vaue of foobar.
 */
 public void setFoobar(Object foobar) {
     this.foobar = foobar;
 } 
```

在此示例中，每 3 行代码有 5 行注释。更糟糕的是 - 注释不会添加您通过阅读代码看不到的任何内容。如果您有 10 种这样的方法，您可能会得到“评论盲区”，而不会注意到偏离模式的一种方法。

如果当然，更好的版本应该是：

```
/**
 * The serialization of the foobar object is used to synchronize the qux task.
 * The default value is unique instance, override if needed.
 */
 public void setFoobar(Object foobar) {
     this.foobar = foobar;
 } 
```

不过，对于琐碎的代码，我更喜欢没有评论。在代码之外的单独文档中可以更好地解释意图和整体组织。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-08-12T08:23:41.880

区别在于“什么”和“如何”。

*   您应该记录例程的“功能”。
*   你不应该记录它是如何做到的，除非有特殊情况（例如参考特定的算法论文）。那应该是自我记录的。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2008-10-16T15:35:28.170

您可能希望向您的同事指出的一件事是，无论他的代码如何自我记录，如果考虑并丢弃其他替代方法，则除非他使用该信息评论代码，否则该信息将丢失。有时同样重要的是要知道考虑了替代方案以及为什么决定反对它，并且代码注释最有可能随着时间的推移而存在。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2008-10-16T22:02:33.083

我很惊讶没有人提出“[文学编程](http://en.wikipedia.org/wiki/Literate_programming)”，这是一种由 TeX 的 Donald E. Knuth 于 1981 年开发的技术，并以“计算机编程的艺术”而闻名。

前提很简单：既然代码必须被人理解，而注释只是被编译器丢弃，为什么不给每个人他们需要的东西——代码意图的完整文本描述，不受编程语言要求的限制, 对于人类读者和编译器的纯代码。

文学编程工具通过为文档提供特殊标记来做到这一点，该标记告诉工具哪些部分应该是源代码，哪些是文本。该程序稍后会从文档中提取源代码部分并组装一个代码文件。

我在网上找到了一个例子：http: [//moonflare.com/code/select/select.nw](http://moonflare.com/code/select/select.nw)或 HTML 版本[http://moonflare.com/code/select/select.html](http://moonflare.com/code/select/select.html)

如果你能在图书馆找到 Knuth 的书（Donald E. Knuth，Literate Programming，Stanford，California：Center for the Study of Language and Information，1992，CSLI Lecture Notes，第 27 期。）你应该阅读它。

*那是*自我记录的代码，包含推理和所有内容。甚至制作了一份不错的文档，其他一切都只是写得很好的评论:-)

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2009-08-12T09:08:37.623

在我工作的一家公司中，其中一位程序员的显示器顶部贴有以下内容。

“记录你的代码，就像维护它的人是一个知道你住在哪里的杀人狂一样。”

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-10-16T15:30:21.537

自记录代码通常使用与代码所做的完全匹配的变量名，以便于理解正在发生的事情

然而，这样的“自我记录代码”永远不会取代注释。有时代码太复杂，而自记录代码是不够的，尤其是在可维护性方面。

我曾经有一位教授是这个理论的坚定信徒事实上我记得他说过的最好的一句话是“评论是给娘娘腔的”
一开始我们所有人都感到惊讶，但这是有道理的。
但是，情况是，即使您可能能够理解代码中发生的事情，但是经验不足的人可能会落后于您并且不了解发生了什么。这是评论变得重要的时候。我知道很多次我们不认为它们很重要，但很少有不需要评论的情况。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-12-13T23:57:06.840

我想为许多有效的答案提供另一种观点：

什么是源代码？什么是编程语言？

这些机器不需要源代码。他们很高兴运行大会。编程语言是为了我们的利益。我们不想写汇编。我们需要了解我们在写什么。编程就是写代码。

你应该能够阅读你写的东西吗？

源代码不是用人类语言编写的。它已经尝试过（例如 FORTRAN），但并不完全成功。

源代码不能有歧义。这就是为什么我们必须在其中添加比文本更多的结构。文本仅适用于上下文，我们在使用文本时认为这是理所当然的。源代码中的上下文总是明确的。想想 C# 中的“使用”。

大多数编程语言都有冗余，因此当我们不连贯时编译器可以捕捉到我们。其他语言使用更多的推理并试图消除这种冗余。

计算机不需要类型名称、方法名称和变量名称。它们被我们用作参考。编译器不懂语义，那是给我们用的。

编程语言是人与机器之间的语言桥梁。它必须对我们来说是可写的，对他们来说是可读的。次要要求是它应该对我们可读。如果我们擅长在允许的情况下使用语义并且擅长构建代码，那么即使对我们来说源代码也应该易于阅读。最好的代码不需要注释。

但是复杂性潜伏在每个项目中，你总是必须决定把复杂性放在哪里，以及吞下哪些骆驼。这些是使用评论的地方。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-10-16T15:31:15.887

我认为自文档代码是评论的一个很好的替代品。如果您需要注释来解释代码是如何或为什么是这样的，那么您有一个函数或变量名称应该修改为更具解释性。编码员是否会通过注释或重命名一些变量和函数以及重构代码来弥补不足，这可能取决于编码员。

但它并不能真正取代您的文档，因为文档是您提供给其他人以解释如何使用您的系统的东西，而不是它是如何做事的。

编辑：我（可能还有其他所有人）可能应该规定数字信号处理（DSP）应用程序应该得到很好的评论。这主要是因为 DSP 应用程序本质上是 2 个循环，其中包含值数组并添加/乘法/等表示值...要更改程序，您可以更改其中一个数组中的值...需要一些评论来说明什么在那种情况下你正在做;）

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-10-16T15:33:37.143

自我记录代码是解决问题的一个简单方法，随着时间的推移，代码、注释和文档会出现分歧。编写清晰的代码是一个纪律因素（如果你对自己这么严格的话）。

对我来说，这些是我试图遵循的规则：

*   代码应该尽可能简单明了地阅读。
*   注释应该说明我做出的设计决策的原因，例如：我为什么要使用此算法，或代码具有的限制，例如：当...时不起作用（这应该在代码中的合同/断言中处理）（通常在函数/过程中）。
*   文档应列出用法（调用转换）、副作用、可能的返回值。可以使用 jDoc 或 xmlDoc 等工具从代码中提取它。因此它通常在函数/过程之外，但接近它描述的代码。

这意味着所有三种记录代码的方式都紧密结合在一起，因此在代码更改时更有可能被更改，但它们表达的内容不重叠。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-10-16T15:35:00.417

所谓的自记录代码的真正问题在于它传达了它实际所做的事情。虽然一些评论可能有助于某人更好地理解代码（例如，算法步骤等），但它在一定程度上是多余的，我怀疑你会说服你的同行。

然而，文档中真正重要的是那些从代码中不能直接看出的东西：潜在的意图、假设、影响、限制等。

能够通过快速浏览来确定代码执行 X 比能够确定代码不执行 Y 要容易得多。他必须记录 Y...

例如，您可以向他展示一个看起来不错、很明显但实际上并未涵盖输入的所有基础的代码示例，然后看看他是否找到了它。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2008-10-16T18:23:41.280

在编写数学代码时，我有时会发现写长的、类似文章的注释、解释数学、代码使用的符号约定以及它们如何组合在一起很有用。我们在这里谈论数百行文档。

我尝试让我的代码尽可能地自我记录，但是当我在几个月后回来处理它时，我确实需要阅读解释以避免对其进行散列。

现在，对于大多数情况，当然不需要这种极端措施。我认为这个故事的寓意是：不同的代码需要不同数量的文档。有些代码可以写得很清楚，不需要注释——所以写得清楚，不要在那里使用注释！

但是很多代码确实需要注释才能有意义，所以尽可能清楚地写出来，然后根据需要使用尽可能多的注释......

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2008-10-17T05:43:10.050

我会争辩——正如你们中的许多人所做的那样——要真正实现自我记录，代码需要表现出某种形式的意图。但我很惊讶还没有人提到 BDD -[行为驱动开发](http://en.wikipedia.org/wiki/Behavior_driven_development)。部分想法是您有自动化测试（代码）来解释代码的意图，否则很难使之变得明显。

```
良好的领域建模
+ 好名字（变量、方法、类）
+ 代码示例（来自用例的单元测试）
= 自我记录软件

```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-10-16T18:42:22.460

除了代码之外的额外注释可能更清晰的几个原因：

*   您正在查看的代码是自动生成的，因此在下次编译项目时可能会破坏对代码的任何编辑
*   为了提高性能（展开循环、为昂贵的计算创建查找表等）而牺牲了一个不太简单的实现

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-10-16T18:55:42.400

这将是团队在其文档中所重视的全部内容。我建议记录为什么/意图而不是如何重要，这并不总是在自我记录代码中捕获。get/set 不，这些是显而易见的——但计算、检索等应该表达一些原因。

如果您来自不同的国籍，也请注意团队中的差异。措辞上的差异可能会影响方法的命名：

二分搜索

二进制搜索

BinaryChop

这三种方法由在 3 个不同大洲受过培训的开发人员提供，它们做同样的事情。只有通过阅读描述算法的评论，我们才能识别我们库中的重复。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-10-17T02:14:53.373

对我来说，阅读需要注释的代码就像阅读我不懂的语言的文本。我看到声明，但我不明白它的作用或原因 - 我必须查看评论。我读了一个短语，我需要查字典才能理解它的意思。

通常很容易编写代码来自我记录它所做的事情。告诉你为什么这样做，注释更合适，但即使是这里的代码也可以更好。如果您在每个抽象级别上都了解您的系统，您应该尝试像这样组织您的代码

```
public Result whatYouWantToDo(){
  howYouDoItStep1();
  howYouDoItStep2();
  return resultOfWhatYouHavDone;
} 
```

方法名称反映了您的意图，方法主体说明了您如何实现目标。无论如何，您无法在书名中说出整本书，因此仍然必须记录系统的主要抽象，以及复杂的算法、非平凡的方法契约和工件。

如果您的同事生产的代码确实是自我记录的 - 幸运的是您和他。如果您认为您的同事代码需要注释 - 它需要。只需打开其中最不平凡的地方，阅读一遍，看看你是否理解了所有内容。如果代码是自我记录的——那么你应该这样做。如果不是 - 向您的同事询问有关它的问题，在他给您答案之后询问为什么该答案没有事先记录在评论或代码中。他可以声称代码对于像他这样聪明的人来说是自文档，但无论如何他必须尊重其他团队成员——如果你的任务需要理解他的代码，而他的代码没有向你解释你需要理解的一切——它需要评论。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-10-20T05:06:59.967

大多数文档/评论有助于帮助未来的代码增强者/开发人员，从而使代码可维护。通常情况下，我们最终会在稍后返回我们的模块以添加新功能或优化。那时，通过阅读注释比单步执行大量断点更容易理解代码。此外，我宁愿花时间思考新逻辑，也不愿破译现有逻辑。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-10-16T15:31:08.227

我认为他可能会说，如果注释解释了代码在做什么，那么应该重写它以明确它的意图是什么。这就是他所说的自我记录代码的意思。通常这可能意味着简单地将长函数分解为具有描述性函数名称的逻辑小块。

这并不意味着不应评论代码。这意味着注释应该提供代码按原样编写的原因。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-16T15:33:11.327

我相信您应该始终努力实现自文档化代码，因为它确实使代码更容易阅读。但是，你也必须对事情务实。

例如，我通常为每个班级成员添加注释（为此我使用文档注释）。这描述了成员应该做什么，但不描述它是如何做的。我发现当我阅读代码时，尤其是旧代码时，这有助于我快速记住该成员的用途，而且我还发现它比阅读代码并解决它更容易，特别是如果代码流跳动很多.

这只是我的看法。我知道很多人在工作时完全没有评论，并说他们觉得这没问题。然而，我曾向某人询问他们六个月前编写的一种方法，他们不得不考虑几分钟才能确切地告诉我它做了什么。如果方法被注释，这不是问题。

最后，您必须记住，注释与代码一样是系统的一部分。当您重构和更改功能时，您还必须更新您的评论。这是完全反对使用注释的一个论点，因为如果它们不正确，它们比无用更糟糕。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-10-16T15:34:40.327

我认为这是一个正确数量的文档问题，而不是全部或没有。如果函数的参数命名良好，您通常不必准确说出它们是什么，例如 char *CustomerName 非常明显。如果您对参数使用断言值范围，则不必同时记录这些范围。IMO，文档应该涵盖所有不太明显的内容，因此需要一些解释，并且大多数代码都需要一些文档。就个人而言，在大多数情况下，我宁愿看一个给定函数如何工作的说明性示例，而不是描述性文档。

为了文档而编写文档可能会浪费时间，因为文档需要维护才能与代码库保持同步。如果没有人会从阅读中受益，请不要制作它。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2008-10-16T15:35:03.927

我会扭转这种局面。

问问自己你在他的代码中有什么不明白的地方，然后让他把这些记录下来。也许你也可以告诉我们一些。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2008-10-16T15:37:15.763

这是我对您的问题的最佳回答。

自我记录代码是用类、方法、函数和变量名清楚地编写的代码，使其意图和功能易于理解。如果做得好，它就是文档。

它*可以*替换注释和记录良好的代码，但我很少看到它。很多时候，程序员都认为自己足够优秀，可以做到这一点，但打倒他们的最好方法是开始提问。如果他们必须开始解释太多，那么他们的代码不够清晰。您不必阅读代码即可知道它的作用。

在某些情况下可能会更好。如果代码小而简单，那么您可能会通过添加文档来使​​事情变得混乱。

包含算法的代码应该包含注释。大多数时候，即使是最初的程序员也记不起几个月前他们在写一个长函数时到底在想什么。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2008-10-16T15:38:44.560

这是一个很好的问题。我敢肯定，它可以追溯到第一种允许注释的编程语言。代码当然应该尽可能地自我记录。指出显而易见的评论应该被删除。让我们更容易理解给定方法或代码部分的意图、目的和使用的注释对于我们这些可能不太熟悉所讨论的语言或代码的傻瓜来说是非常宝贵的。允许生成 API 文档的结构化注释就是一个很好的例子。只是不要评论检查复选框是否已选中的 IF 语句，并告诉我您正在检查复选框是否已选中。在评论中重申显而易见的是我们宇宙中最糟糕的浪费击键。

```
//For example, the above text deals with what is a useful comment 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2008-10-16T15:51:51.990

自我记录的代码是非常容易理解的代码。变量命名在使代码自我记录方面大有帮助，但我发现最好的策略是将任何复杂的逻辑分解成很小的小块，并将这些信息重构为具有详细信息和信息名称的单独方法。然后，您的复杂方法就变成了要执行的步骤列表。然后，微小的私有辅助方法通过它们自己的方法名称进行充分记录，并将复杂的方法记录为要执行的一系列抽象步骤。在实践中，这种策略不能总是完美地应用，所以评论仍然非常有用。另外，您永远不应该完全放弃任何可以帮助您编写更易于理解的代码的工具。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2008-10-16T20:38:02.757

如果您的代码在没有注释的情况下不完全清晰，那么您的代码还有改进的空间。

我不是说“不要评论不清楚的代码”。我说的是“让你的代码清晰”。

如果您最终以某种方式使您的代码不清楚，请*使用*注释来弥补。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2008-10-16T21:38:02.650

自我记录的代码是愚蠢的。*任何不得不在数周、数月或喘息*年后重新访问他们的代码的人都知道这一点（或数天，在我的情况下）。（也许宣传这个想法的那个人还在耳后！？！？！）

使用有意义的、描述性的数据名称，智能地考虑你的代码，并给自己留下一些提示，告诉你为什么你做了你所做的事情，你会过上更丰富、更充实的生活。

虽然……我确实读过比尔盖茨的一句话：“代码就是文档。”

去搞清楚。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2008-10-17T00:46:19.680

来自非评论阵营的一些观点。

“注释良好”（冗长）的代码更难阅读和理解。一方面，要扫描的文本更多。它增加了理解 CodeBase 的认知努力——非功能性文本占用了可用于显示代码的屏幕空间。

注释的另一个大问题是它们不可靠——尤其是在较旧的代码库中，注释腐烂设置比位腐烂更快。

当然，还有写评论的努力。除了偶尔的一行澄清，每次我开始评论代码时，我都会有两种内疚感之一

1.  此信息需要包含在整体支持文档中
2.  我需要清理我的代码

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2008-10-17T08:07:35.733

不管纯粹的自我记录代码是可以实现的，还是有一些事情浮现在脑海中应该做的：

*   永远不要有“令人惊讶”的代码。IE。不要使用愚蠢的宏来重新定义事物等。不要滥用运算符重载，不要试图在这方面变得聪明。
*   在正确的位置拆分代码。使用适当的抽象。与其内联滚动缓冲区（具有固定长度的缓冲区，具有两个指针，这些指针在一端添加项目并在另一端删除项目），而是使用具有正确名称的抽象。
*   保持低功能复杂度。如果它变得太长或太复杂，请尝试将其拆分为其他其他功能。

在实现特定的复杂算法时，添加描述算法的文档（或链接）。但在这种情况下，要格外努力地消除不必要的复杂性并增加易读性，因为太容易出错了。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2008-10-17T08:39:04.767

这里的输入似乎很混杂:)

我使用伪代码编程过程进行新的开发，这实际上使我的代码自我记录。我仅在编写新代码然后对其进行扩展时才开始编写伪代码。我不是说这是最佳实践或类似的东西，我只是强调一种我认为有用的技术，如果你知道你想要大量的代码文档，如果它去第三方，审阅者等......它也在我写一行代码之前，偶尔会为我突出问题。

```
' check database is available
  ' if it is then allow the procedure
  ' if it isnt roll back and tidy up 
' move onto something else 
```

变成；

```
' check database is available
  if checkDBStateResult(currentDB) = Open then 
     ' if it is then allow the procedure
          proc.Ok = True 
  else
     ' if it isnt roll back
          proc.Ok = False
          CleanUp()
  end if 
```

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2008-11-20T21:14:32.570

我曾经和一个准备把一套金融套件卖给一家大公司的人一起工作。他们坚持要他记录源代码，他为此制作了一个 30 多页的汇编程序例程并说“它已记录在案，看”——然后他翻到第 13 页，并有一条评论“反击计数器”。伟大的产品，伟大的实施者，但是......

无论如何，在我看来，上面的重要评论是为了设置上下文。该片段被声明为自记录：

```
> from BeautifulSoup import
> BeautifulSoup, Tag def
> replace_a_href_with_span(soup):
>     links = soup.findAll("a")
>     for link in links:
>         tag = Tag(soup, "span", [("class", "looksLikeLink")])
>         tag.contents = link.contents
>         link.replaceWith(tag) 
```

但是，我需要一个上下文来完全理解它。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2008-12-11T03:10:12.173

有人指出，评论应该抓住意图，但我会更进一步。

我认为对于任何一类问题，都有一个理想的（或几乎如此）的词汇和句法来描述它，如果你让有此类问题的人描述它们，你就可以看到它（假设这个人可以清楚地思考） .

如果这些词汇和语法很容易（通过定义类、方法等）映射到计算机语言的代码上，那么该代码可以是自记录的。此外，还创建了 IMO，一种特定于领域的语言。（这是我对“声明性”的粗略定义。）

如果这个理想失败了，如果问题没有直接映射到计算机代码上，那么你需要一些东西将两者联系在一起。IMO，这就是评论的目的。

这样，当问题发生变化时，您可以找到代码的相应部分进行更改。

编辑：顺便说一句，我不赞成 OOP 方法，其中每个名词都成为一个类，每个动词都是一个方法。我已经看到足够多的英国媒体报道软件**以这种**方式构建。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2009-08-12T08:18:57.100

良好的设计结构有助于指出一些功能是通用的，而一些是随机的业务逻辑，即使你没有评论说“这个功能是通用的”。

不过，我们不应该忘记设计和规范文档。那些有或至少应该有很多在评论中不一定需要的文本。软件通常还有用户手册和其他描述文件，这些文件应该与程序的功能同步。如果用户必须从源代码而不是手册中找出软件的功能，情况就不太好了。所以自我记录的代码仍然不意味着实际的软件已经记录在案。

还要考虑功能的可追溯性。当您拥有手册时，您应该能够将功能追溯到源代码并返回以获得更好的可维护性。手册和规范不是关于编程的，而是关于软件工程的。软件越大，需要的工程就越多。

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2008-10-16T15:35:56.267

自我记录的代码是非常清晰以至于不需要注释的代码。我举一个小例子：

```
//iterate from 0 to 100
for(int i=0; i < 100; i++) {
   println i
} 
```

注释没什么用，因为代码很清楚。文档是一种很好的做法，但是额外的文档会给代码添加不必要的噪音。您的同事需要知道的是，并非每个人都能阅读他人的代码并承认其所有细节。

```
int calc(int a, int b) {
   return sqrt(a*a + b*b); //pythagoras theorem
} 
```

如果没有注释，最后一个片段将很难破译。你可以想象其他更人为的例子。

# asp.net - 聚合登录控制 [ASP.NET]

> ID：209020
> 
> 赞同：1
> 
> 时间：2008-10-16T15:26:14.150
> 
> 标签：asp.net, login

世界上是否有一种控件允许用户使用 MS Passport（Windows Live ID 等）、Facebook、OpenID 等在一个控件中登录网站？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T15:31:31.220

我不知道有任何控件允许所有这些控件，但是 API 非常简单，可以让您自己实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T01:43:41.153

正如 StackOverflow 播客 30 中所述 - JanRain RPX 击败了我。为我悲伤的脸。

[JanRain RPX](https://rpxnow.com/how_it_works)

# jquery - Django template with jquery: Ajax update on existing page

> ID：209023
> 
> 赞同：3
> 
> 时间：2008-10-16T15:27:38.873
> 
> 标签：jquery, python, django, google-app-engine, django-templates

I have a Google App Engine that has a form. When the user clicks on the submit button, AJAX operation will be called, and the server will output something to append to the end of the very page where it comes from. How, I have a Django template, and I intend to use jquery. I have the following view:

```
<html>
<head>
<title></title>
<script type="text/javascript" src="scripts/jquery.js"></script>
<script type="text/javascript" src="scripts/scripts.js"></script>

</head>
<body>
welcome
<form id="SubmitForm" action="/" method="POST"> 
<input type="file" name="vsprojFiles" />
<br/>
<input type="submit" id="SubmitButton"/>
</form>

<div id="Testing">
{{thebest}}
</div>

</body>
</html> 
```

Here's the script in scripts.js:

```
$(function() {
    $("#SubmitForm").click(submitMe);
});

var submitMe = function(){
    //alert('no way');
    var f = $('#SubmitForm');
    var action = f.attr("action");
    var serializedForm = f.serialize();
  $.ajax( {
        type: 'post',
        data: serializedForm,
        url:  form_action,
        success: function( result ) {
          $('#SubmitForm').after( "<div><tt>" +
                                     result +
                                     "</tt></div>" );
        }
      } );

    }; 
```

And here's my controller code:

```
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext import db
from google.appengine.ext.webapp import template
from google.appengine.api.urlfetch_errors import *
import cgi
import wsgiref.handlers
import os
import sys
import re
import urllib
from django.utils import simplejson

class MainPage(webapp.RequestHandler):
    def get(self):
        path = os.path.join(os.path.dirname(__file__), 'Index.html')
        template_values={'thebest': 'thebest'}
        tmplRender =template.render(path, template_values)
        self.response.out.write(tmplRender)
        pass

    def Post(self):
        print >>sys.__stderr__,'me posting'
        result = 'grsgres'
        self.response.out.write(simplejson.dumps(result)) 
```

As you can see, when the user clicks on the submitbutton, the controller method Mainpage.post will be called.

Now I want to display the content of the 'result' variable right after the form, how can I do it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T21:53:18.323

如果无法测试代码，您的结果是什么？你检查过 AJAX 调用返回的结果吗？我建议您使用 Firebug 运行 Firefox，并将 AJAX 结果记录到 Firebug 控制台以查看您得到的结果：

```
//...
        success: function( result ) { 
        console.log( result );
      $('#SubmitForm').after( "<div><tt>" + 
// ... 
```

您还可以使用 Firebug 的 Net 面板查看来回传递的内容。

另外，“simplejson.dumps(result)”会导致什么结果？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T02:26:37.493

这是我的成功功能的一个例子

```
success: function(json){
                $('#gallons_cont').html(json['gallons']);
                $('#area_cont').html(json['area']);
                $('#usage_cont').html(json['usage'])
                $('#results_json').show('slow');            
            }, 
```

请注意，您必须使用 firebug 或类似的东西进行调试，因为可能存在一些序列化问题，这些问题会抛出并出错，但除非您使用 firebug 之类的东西或实现 .ajax 错误，否则无法查看

# wpf - Does WPF's TextBox support spell-check dictionaries for the Netherlands?

> ID：209026
> 
> 赞同：6
> 
> 时间：2008-10-16T15:28:01.400
> 
> 标签：wpf, xaml, localization, internationalization, richtextbox

The RichTextBox supports a spellcheck option which is very nice. (SpellCheck.IsEnabled = true)

But I cannot seem to get it to another language. (I live in the Netherlands.. ;))

Does any of you have an experience with the SpellCheck option of TextBox?

I know it can be change by changing the keyboard settings, but I want to change it in the application.

What I have tried so far (and did not work):

*   Changing the CurrentCulture on the current Thread.
*   Changing the Language property in xaml in "nl-NL"
*   Changing the Language property in code with the `XmlLanguage.GetLanguage("nl-NL");`

You should not get any spelling errors with the following line:

"Dit is een Nederlandse tekst."

The RFC 3066 language key of my language is "nl-NL"

Many thanks, Rick

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-12-14T23:29:45.720

WPF 的拼写支持仅限于 4 种语言；英语、西班牙语、法语和德语。

使用自定义词典只会将“特殊词”添加到当前词典中。它不允许新的语言词典。

# jquery - 在 jQuery 中删除事件处理程序的最佳方法？

> ID：209029
> 
> 赞同：1114
> 
> 时间：2008-10-16T15:28:47.933
> 
> 标签：jquery, html-input

我有一个`input type="image"`. 这就像 Microsoft Excel 中的单元格注释。`input-image`如果有人在与之配对的文本框中输入一个数字，我会为`input-image`. 然后，当用户单击 时`image`，他们会弹出一个小窗口来为数据添加一些注释。

我的问题是，当用户在文本框中输入零时，我需要禁用`input-image`的事件处理程序。我尝试了以下方法，但无济于事。

```
$('#myimage').click(function { return false; }); 
```

* * *

## 回答 #1

> 赞同：1734
> 
> 时间：2008-10-16T21:13:55.117

## jQuery ≥ 1.7

从 jQuery 1.7 开始，事件 API 已经更新，`.bind()`/`.unbind()`仍然可用于向后兼容，但首选方法是使用[on()](http://api.jquery.com/on/) / [off()](http://api.jquery.com/off/)函数。下面是现在，

```
$('#myimage').click(function() { return false; }); // Adds another click event
$('#myimage').off('click');
$('#myimage').on('click.mynamespace', function() { /* Do stuff */ });
$('#myimage').off('click.mynamespace'); 
```

* * *

## jQuery < 1.7

在您的示例代码中，您只是向图像添加另一个单击事件，而不是覆盖前一个：

```
$('#myimage').click(function() { return false; }); // Adds another click event 
```

两个点击事件都会被触发。

正如人们所说，您可以使用 unbind 删除所有点击事件：

```
$('#myimage').unbind('click'); 
```

如果要添加单个事件然后将其删除（不删除可能已添加的任何其他事件），则可以使用事件命名空间：

```
$('#myimage').bind('click.mynamespace', function() { /* Do stuff */ }); 
```

并仅删除您的活动：

```
$('#myimage').unbind('click.mynamespace'); 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-07-23T17:57:10.947

回答此问题时不可用，但您也可以使用[live()](http://api.jquery.com/live/)方法启用/禁用事件。

```
$('#myimage:not(.disabled)').live('click', myclickevent);

$('#mydisablebutton').click( function () { $('#myimage').addClass('disabled'); }); 
```

这段代码会发生什么，当您单击#mydisablebutton 时，它会将禁用的类添加到#myimage 元素中。这将使选择器不再与元素匹配，并且在删除“禁用”类使 .live() 选择器再次有效之前不会触发事件。

通过添加基于该类的样式，这还有其他好处。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-10-16T15:35:09.747

这可以通过使用 unbind 函数来完成。

```
$('#myimage').unbind('click'); 
```

您可以将多个事件处理程序添加到 jquery 中的同一对象和事件。这意味着添加新的不会取代旧的。

有几种更改事件处理程序的策略，例如事件命名空间。在线文档中有一些关于此的页面。

看看这个问题（这就是我了解 unbind 的方式）。答案中有对这些策略的一些有用描述。

[如何在 jquery 中读取绑定的悬停回调函数](https://stackoverflow.com/questions/48931/how-to-read-bound-hover-callback-functions-in-jquery)

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2011-08-05T07:29:01.517

如果您只想响应一次事件**，**以下语法应该非常有用：

```
 $('.myLink').bind('click', function() {
   //do some things

   $(this).unbind('click', arguments.callee); //unbind *just this handler*
 }); 
```

使用**arguments.callee**，我们可以确保删除一个特定的匿名函数处理程序，从而为给定事件拥有一个时间处理程序。希望这对其他人有帮助。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2008-10-16T15:31:02.110

也许 unbind 方法对你有用

```
$("#myimage").unbind("click"); 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2012-03-28T14:44:31.650

我必须使用 prop 和 attr 将事件设置为 null。我不能用其中一个来做。我也无法让 .unbind 工作。我正在研究一个 TD 元素。

```
.prop("onclick", null).attr("onclick", null) 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2012-06-26T13:02:06.530

如果事件以**这种方式**附加，并且目标是未附加的：

```
$('#container').on('click','span',function(eo){
    alert(1);

    $(this).off(); //seams easy, but does not work

    $('#container').off('click','span'); //clears click event for every span

    $(this).on("click",function(){return false;}); //this works.

});​ 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2014-01-21T22:25:16.247

您可能会将`onclick`处理程序添加为内联标记：

```
<input id="addreport" type="button" value="Add New Report" onclick="openAdd()" /> 
```

如果是这样，jquery `.off()`or`.unbind()`将无法正常工作。您还需要在 jquery 中添加原始事件处理程序：

```
$("#addreport").on("click", "", function (e) {
   openAdd();
}); 
```

然后 jquery 有一个对事件处理程序的引用，并且可以将其删除：

```
$("#addreport").off("click") 
```

VoidKing 在上面的评论中稍微倾斜地提到了这一点。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2017-12-12T07:18:42.980

对`remove` **所有人** `event-handlers`来说，这对我有用：

删除所有事件处理程序意味着拥有`HTML structure`没有所有`event handlers`附加到`element`及其`child nodes`. 要做到这一点，`jQuery's clone()`帮助。

```
var original, clone;
// element with id my-div and its child nodes have some event-handlers
original = $('#my-div');
clone = original.clone();
//
original.replaceWith(clone); 
```

有了这个，我们将用 no`clone`代替。`original``event-handlers`

祝你好运...

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2019-05-27T02:50:01.440

如果您使用`$(document).on()`将侦听器添加到动态创建的元素，则可能必须使用以下内容将其删除：

```
// add the listener
$(document).on('click','.element',function(){
    // stuff
});

// remove the listener
$(document).off("click", ".element"); 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2014-02-05T11:39:27.707

**2014 年更新**

使用最新版本的 jQuery，您现在只需执行以下操作即可取消绑定命名空间上的所有事件`$( "#foo" ).off( ".myNamespace" );`

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2015-01-02T14:43:04.697

删除内联 onclick 事件的最佳方法是`$(element).prop('onclick', null);`

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2010-07-02T21:54:25.443

谢谢你提供的详情。非常有帮助，我用它来锁定另一个用户在编辑模式下的页面交互。我将它与 ajaxComplete 结合使用。不一定是相同的行为，但有些相似。

```
function userPageLock(){
    $("body").bind("ajaxComplete.lockpage", function(){
        $("body").unbind("ajaxComplete.lockpage");
        executePageLock();      
    });
};  

function executePageLock(){
    //do something
} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-06-27T10:11:19.453

如果`.on()`方法以前与特定选择器一起使用，如下例所示：

```
$('body').on('click', '.dynamicTarget', function () {
    // Code goes here
}); 
```

`unbind()`和`.off()`方法都*不起作用*。

但是，[.undelegate()](http://api.jquery.com/undelegate/)方法可用于从事件中完全删除与当前选择器匹配的所有元素的处理程序：

```
$("body").undelegate(".dynamicTarget", "click") 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-06-15T12:31:23.850

这也可以正常工作。简单易行。请参阅[http://jsfiddle.net/uZc8w/570/](http://jsfiddle.net/uZc8w/570/)

```
$('#myimage').removeAttr("click"); 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-09-05T14:24:30.553

我知道这来晚了，但为什么不使用纯 JS 来删除事件呢？

```
var myElement = document.getElementById("your_ID");
myElement.onclick = null; 
```

或者，如果您使用命名函数作为事件处理程序：

```
function eh(event){...}
var myElement = document.getElementById("your_ID");
myElement.addEventListener("click",eh); // add event handler
myElement.removeEventListener("click",eh); //remove it 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2014-09-02T06:53:48.980

如果你设置`onclick`你`html`需要`removeAttr ($(this).removeAttr('onclick'))`

如果您通过 jquery 设置它（在我上面的示例中第一次单击之后），那么您需要`unbind($(this).unbind('click'))`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-02-12T08:00:07.117

所描述的所有方法都对我不起作用，因为我正在将 click 事件添加`on()`到在运行时创建元素的文档中：

```
$(document).on("click", ".button", function() {
    doSomething();
}); 
```

我的解决方法：

由于我无法取消绑定“.button”类，我只是将另一个类分配给具有相同 CSS 样式的按钮。通过这样做，live/on-event-handler 最终忽略了点击：

```
// prevent another click on the button by assigning another class
$(".button").attr("class","buttonOff"); 
```

希望有帮助。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-12-22T08:28:44.543

希望我下面的代码能解释一切。HTML：

```
(function($){

     $("#btn_add").on("click",function(){
       $("#btn_click").on("click",added_handler);
       alert("Added new handler to button 1");
     });

     $("#btn_remove").on("click",function(){
       $("#btn_click").off("click",added_handler);
       alert("Removed new handler to button 1");
     });

   function fixed_handler(){
    alert("Fixed handler");
  }

   function added_handler(){
    alert("new handler");
  }

  $("#btn_click").on("click",fixed_handler);
  $("#btn_fixed").on("click",fixed_handler);

})(jQuery);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<button id="btn_click">Button 1</button>
  <button id="btn_add">Add Handler</button>
  <button id="btn_remove">Remove Handler</button>
  <button id="btn_fixed">Fixed Handler</button>
```

# javascript - Browser & version in prototype library?

> ID：209043
> 
> 赞同：14
> 
> 时间：2008-10-16T15:31:01.923
> 
> 标签：javascript, prototypejs, browser-detection

I am used to using Atlas. Recently i have started transitioning to jQuery and sometimes prototype. The project that i'm currently working on is using prototype.

In Prototype, is there an easy way to get the browser name and version? I've looked over the API documentation and can't seem to find it.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T13:41:32.123

作为 nertzy 回答的补充，您可以使用以下方法添加检测 IE 版本的功能：

```
Prototype.Browser.IE6 = Prototype.Browser.IE && parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5)) == 6;
Prototype.Browser.IE7 = Prototype.Browser.IE && parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5)) == 7;
Prototype.Browser.IE8 = Prototype.Browser.IE && !Prototype.Browser.IE6 && !Prototype.Browser.IE7; 
```

另一方面，您也必须在服务器端检测用户代理的详细信息。无论如何，浏览器检测是编写跨浏览器脚本的一种严重缺陷策略，仅在浏览器功能检测失败时使用。用户很容易更改他/她的用户代理详细信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-26T23:39:46.153

Prototype 提供了一些标志，您可以检查以了解正在运行的浏览器。请记住，检查您希望使用的功能比检查特定浏览器要好得多。

这是`prototype.js`当前在源代码树中的浏览器和功能检测部分：

```
var Prototype = {
  Browser: {
    IE:     !!(window.attachEvent &&
      navigator.userAgent.indexOf('Opera') === -1),
    Opera:  navigator.userAgent.indexOf('Opera') > -1,
    WebKit: navigator.userAgent.indexOf('AppleWebKit/') > -1,
    Gecko:  navigator.userAgent.indexOf('Gecko') > -1 && 
      navigator.userAgent.indexOf('KHTML') === -1,
    MobileSafari: !!navigator.userAgent.match(/Apple.*Mobile.*Safari/)
  },

  BrowserFeatures: {
    XPath: !!document.evaluate,
    SelectorsAPI: !!document.querySelector,
    ElementExtensions: !!window.HTMLElement,
    SpecificElementExtensions: 
      document.createElement('div')['__proto__'] &&
      document.createElement('div')['__proto__'] !== 
        document.createElement('form')['__proto__']
  },
} 
```

因此，您可以通过调查 的值来检查当前浏览器是否是 IE `Prototype.Browser.IE`，或者，可以更加未来兼容并检查特定功能，例如带有`Prototype.BrowserFeatures.XPath`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-22T20:58:33.543

我在 Prototype 的浏览器定义之上使用它。

```
Object.extend(Prototype.Browser, {
    ie6: (/MSIE (\d+\.\d+);/.test(navigator.userAgent)) ? (Number(RegExp.$1) == 6 ? true : false) : false,
    ie7: (/MSIE (\d+\.\d+);/.test(navigator.userAgent)) ? (Number(RegExp.$1) == 7 ? true : false) : false,
    ie8: (/MSIE (\d+\.\d+);/.test(navigator.userAgent)) ? (Number(RegExp.$1) == 8 ? true : false) : false,
    ie9: (/MSIE (\d+\.\d+);/.test(navigator.userAgent)) ? (Number(RegExp.$1) == 9 ? true : false) : false
}); 
```

希望能帮助到你！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T17:33:43.423

你是对的 - 原型不提供用于确定浏览器名称或版本的实用程序。

如果您*特别*需要将浏览器信息作为插件获取，我建议添加以下内容（直接取自 jQuery）：

```
var Browser = Class.create({
  initialize: function() {
    var userAgent = navigator.userAgent.toLowerCase();
    this.version = (userAgent.match( /.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/ ) || [])[1];
    this.webkit = /webkit/.test( userAgent );
    this.opera = /opera/.test( userAgent );
    this.msie = /msie/.test( userAgent ) && !/opera/.test( userAgent );
    this.mozilla = /mozilla/.test( userAgent ) && !/(compatible|webkit)/.test( userAgent );
  }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-01T10:51:46.037

我在以下之后扩展了prototype.js：

```
var Prototype = { ... }; 
```

有了这个：

```
// extension
if (Prototype.Browser.IE) {
    if (/MSIE (\d+\.\d+);/.test(navigator.userAgent)) {
        Prototype.BrowserFeatures['Version'] = new Number(RegExp.$1);
    }
} 
```

对我来说很好，调用就像：

```
if (Prototype.Browser.IE && Prototype.BrowserFeatures['Version'] == 8) { ... } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-24T21:11:45.517

```
 <script type="text/JavaScript">

                function getBrowserVersion()
                {
                    var msg = "Not Recognised Browser";

                    if (/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))
                    {
                        var ffversion = new Number(RegExp.$1)

                        for (var i = 1; i < 20; i++)
                        {
                            if (ffversion == i)
                            {
                                msg = "FF" + i + "x";
                                break;
                            }
                        }
                    }
                    else if (/MSIE (\d+\.\d+);/.test(navigator.userAgent))
                    {
                        var ieversion = new Number(RegExp.$1)

                        for (var i = 1; i < 20; i++)
                        {
                            if (ieversion == i)
                            {
                                msg = "IE" + i + "x";
                                break;
                            }
                        }
                    }

                    alert(msg); // return msg; 
                }

           </script> 
```

# ms-access - 用于在 MS Access 2003 表单中自动调整控件/子表单大小的 VBA 脚本？

> ID：209067
> 
> 赞同：2
> 
> 时间：2008-10-16T15:33:52.107
> 
> 标签：ms-access

由于 Access 2003 没有 2007 年存在的控件锚定功能，我想知道是否有人拥有或知道可以提供此功能的某些 VBA 脚本或免费软件控件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T19:02:36.927

我知道 2007 年的功能在 2003 年没有完全重复。有多个组件用于解决独立性（根据用户监视器分辨率调整表单上的控件大小）和使用表单调整大小事件调整大小（例如[http://www .fmsinc.com/products/components/ControlTour/resize.htm](http://www.fmsinc.com/products/components/ControlTour/resize.htm)）。我所知道的没有一个完全复制 2007 年的经验，但可以在这里找到一个类似的问题（和处理它的代码）：[http ://www.experts-exchange.com/Microsoft/Development/MS_Access/Q_23662850.html](http://www.experts-exchange.com/Microsoft/Development/MS_Access/Q_23662850.html)

就个人而言，我只是自己处理了调整大小事件。最简单的方法是创建您希望支持的最小尺寸的表单，然后记录基本位置和宽度（在表格中或作为表单范围的常量）。从那里您可以使用以下方法调整大小：

```
resizeRatio = currentFormWidth / baseFormWidth

control.left = baseLeft * resizeRatio
control.width = baseWidth * resizeRatio 
```

自己做这件事的好处是随着时间的推移你会进化它，比如保持左侧的标签宽度相同但向右扩展字段（这是通过根本不调整标签的大小来完成的，并减去在应用位置和宽度更改之前，标签区域的末端远离表单的宽度，例如）：

```
resizeRatio = (currentFormWidth - labelsAreaWidth) / (baseFormWidth - labelsAreaWidth)

control.left = (baseLeft - labelsAreaWidth) * resizeRatio + labelsAreaWidth
control.width = baseWidth * resizeRatio 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-06T18:52:53.180

如果有人来寻找 2007 或更高版本，例如 - 2010、2013、2016 版本。这是答案。

在任何版本的 Access 中，字体大小都不会根据屏幕分辨率自动更改，但从**Microsoft Access 2007**开始，您可以使用控件的新属性使它们根据表单的大小进行**拉伸、收缩或移动（**[在此处](http://office.microsoft.com/en-us/access-help/make-controls-stretch-shrink-or-move-as-you-resize-a-form-HA010253986.aspx)描述）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-04T23:48:22.373

尝试在[此](https://stackoverflow.com/a/40965025/2363207)答案中使用 VBA 代码，看看它是否能满足您的需求。当窗体调整大小时，窗体上的所有控件和文本也将按比例调整大小，以便无论窗口大小或用户将监视器分辨率设置为什么，它看起来都一样。

# c# - C# 桌面应用程序？

> ID：209069
> 
> 赞同：4
> 
> 时间：2008-10-16T15:34:07.080
> 
> 标签：c#, .net

在查看 C# 在 ISV 设置中的使用时，我想知道有哪些著名的基于 C# 的桌面应用程序？我只能想到 Paint .NET。

C# 对于 ISV 来说是一个好主意，还是应该坚持使用更原生的环境，如 Delphi 甚至 QT？

当然，任何有经验的建议或反馈将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T15:38:23.330

是的，C# 可以非常有效地用于构建应用程序。关于那里有哪些应用程序，您在寻找什么？大应用，小应用？

我知道一个基于 .NET 框架的大型应用程序（不确定是 C# 还是 VB），那就是 Quickbooks。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T15:52:45.953

用 C# 开发桌面应用程序很棒。它不仅适用于 Web 应用程序。

WinForms 将为您节省大量时间。在桌面 Windows 开发方面，它确实是一等公民。如果互操作是一个问题，您总是可以使用 VS 为您做的 P/Invoke 和 COM 对象包装。

做得好，当客户改变他们想要的东西时，维护和更新将是一件轻而易举的事。

是的，框架需要在机器上，但如果他们曾经使用过 Windows 更新，这应该不是问题。现在什么语言没有运行时库。在 VS 中，您可以创建包含运行时的简单安装程序。

当然，如果你要部署到 Linux 和单声道，你的里程可能会很大。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-22T13:57:50.393

[塑料单片机](http://www.plasticscm.com/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-16T15:38:19.710

如果您可以控制应用程序的系统要求，C# 就可以了。出于某种原因，一些最终用户（即使我们现在已经快到 2009 年了）仍然反对 40MB 运行时，所以如果您希望在商业上部署应用程序，这对您来说可能是个问题。但是，在企业环境中，用户计算机上的软件有一些标准化，这可能不是问题。

Delphi 和 QT 都是问题。Delphi 实际上是一种死语言。这些天使用它的公司，在大多数情况下，尽可能快地从它那里移植他们的代码（这些天工作委员会似乎充满了从 Delphi 到 C# 的迁移工作）。你可能喜欢 QT，但它在 Windows 世界中的发展速度几乎与 Delphi 一样慢，所以我永远不会认为它是一个真正的选择。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-14T17:00:36.440

更多的：

*   商业计划书专业版
*   救援时间客户端
*   索尼维加斯
*   Sql 管理工作室
*   VS 2010（远远超过 VS 200x）
*   美国宇航局的世界风
*   宝贝粉碎
*   Windows Live 作家
*   微软办公会计
*   提琴手 2
*   Windows Mobile 设备中心
*   AdiIRC
*   Jetbrains dotTrace
*   许多联想实用程序
*   计划书

这些只是安装在我的PC上的那些......

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-16T15:41:02.123

我认为 Microsoft Expression Blend/Studio 是用 C# 编写的

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-16T15:53:47.760

为 Robotics Studio 所做的任何事情，任何 XNA 游戏（现在有不少商业游戏即将问世）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-16T15:53:56.417

我不明白您为什么不将 C# 用作 ISV。问题在于确保您的目标市场拥有 .NET 框架。如果您使用的是 3.5，您可以在您的发行版中构建一个迷你版本，尽管这当然会增加下载文件的大小。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-16T18:20:25.170

需要考虑的一些补充信息：

反对做桌面应用程序的典型点之一是分发模型更难管理。对于 Web 应用程序，如果您拥有庞大的用户群，您可以进行更新并立即让您的整个用户群在最新版本上运行。

使用传统的桌面应用程序，您必须发送一个 .msi 或自己构建一些东西。但是，使用 ClickOnce 和更新程序应用程序块 ( [http://msdn.microsoft.com/en-us/library/ms978574.aspx](http://msdn.microsoft.com/en-us/library/ms978574.aspx) )，在您的应用程序中构建智能更新非常容易，它可以很好地融入 ISV计划。

尽管 VS 2008/WPF 正在缩小差距，但在 WinForms 空间中开发客户端应用程序通常比在 Web 上快得多，因此我认为这是一种非常可行的方法。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-16T15:38:42.907

我相信 TimeSnapper 是用 C# 编写的

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-14T16:59:51.837

在使用 Delphi 之前，我曾为 ISV 工作过，它非常适合他们的需求。它仍然会产生出色的本地应用程序，虽然死了，但它肯定还没有死（还）。直到最近，我还是会推荐 Delphi 而不是 c# 用于桌面应用程序，因为我有性能和占用空间方面的考虑，但现在可以认为 .net 无处不在，而且该平台现在正在成熟，我的意见可能会与 c#（超过 Delphi）一起使用。如果您需要考虑员工，您会发现围绕 C# 的 Delphi 开发人员较少。因此，当您使用它时，您可能很难吸引优秀的开发人员。那就是说 Delphi 再次使用 Delphi prism VS 插件看起来令人兴奋。

顺便说一句，您知道 c# 编译器是用 c++ 编写的吗？Delphi 是从 v1.0 开始用 Delphi 编写的

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-21T16:37:23.863

Windows Media Center 由 .NET 提供支持。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-16T15:37:22.473

我相信 MS 使用 C# 来构建他们的许多 Windows 和 Web 应用程序。目前，由于语言/框架的灵活性，C# 是一种很好的语言。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-16T15:40:01.203

你的目标用户是谁？他们的需求将决定您对语言的选择。C# 和 VB.NET 是很好的通用语言，但如果你的目标是 Mac 或 *nix，你可能想要 C++ 之类的东西。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-16T15:45:31.817

zune 软件（v2 及更高版本）是用 c# 编写的。哦，Sage Timberline Office（大部分）是用 .net 编写的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-21T16:33:37.880

我相信matrox 显卡配置实用程序正在使用.net 框架。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-21T16:39:16.183

我仍然只是一个学生，但是对于它的价值（以及我之前的其他答案），C# 中似乎有很多应用程序。

我建议阅读 Head First C#（[亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0596514824 "Amazon.com 上的 HeadFirst C#")）一书。这本书会给你一个相当扎实的想法，让你知道你可以用这门语言做什么。

=-MDP-=

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-16T15:59:32.490

虽然它是一个开发工具，但优秀的开源 IDE [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Download/)是用 C# 构建的。我还研究了另一个（尽管是半商业可用的）我不能自由透露。（非常垂直的市场。）

我是 C#/WinForms 组合的忠实拥护者，如果您的开发人员已经熟悉 C# 并且您想进入桌面领域，我不明白您为什么不走这条路。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-21T16:47:16.840

[Creative Docs .NET](http://www.creativedocs.net)是一个非常好的 C# 应用程序示例。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-12-21T16:53:23.783

微软的 World Wide Telescope 软件是用 c# 编写的

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-11-27T20:31:35.677

如果您正在寻找一种快速入门的方法，我最近发布了[DesktopBootstrap](https://github.com/adamsmith/DesktopBootstrap "桌面引导")，这是我尝试找出您需要入门的元素。

希望有帮助！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-17T08:40:52.953

Microsoft Visual Studio 2005 本身就是商业成功应用程序的一个非常突出的例子。
如果您正在考虑使用 C# 为 Windows 生态系统构建客户端或服务器应用程序，.Net 是绝对有效的选择。你会得到一个非常丰富的框架、一个很棒的第三方应用生态系统和一个庞大的社区。
如果您的应用程序需要最小的内存占用或者非常以硬件为中心，那么 C++ 可能是一个选择。
如果您想针对 UNIX/LINUX 或 Apple 平台，您应该寻找更适合各自平台的原生框架，尽管您可以与 Mono 项目获得一定程度的互操作性（但我不知道如何完成他们的最新目前.Net的实施是）。

# ruby-on-rails - Rails x FastCGI

> ID：209074
> 
> 赞同：3
> 
> 时间：2008-10-16T15:34:39.840
> 
> 标签：ruby-on-rails

如果客户与不支持 mod_rails 的提供商提供廉价托管服务，我是否应该置身事外？rails + fast.cgi 会为用户提供良好的体验，还是应该在这种情况下选择 php + my-favorite-framework 作为平台？

问候，

胜利者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T15:38:35.747

Fastcgi应该没问题。尽管通常建议在您拥有的平台上托管 Rails 应用程序。有一些相当实惠的虚拟专用服务器可以让你做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T16:30:23.410

我在低端主机上的体验真的很糟糕。不断让我的杂种实例莫名其妙地死去。自从切换到切片后，我自己运行它的问题为零。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T19:08:13.233

我有三个使用 FastCGI 的廉价托管计划的客户，并且由于 FastCGI 本身没有遇到任何问题。这些都是不需要 Mongrel 的低流量站点。

> rails + fast.cgi 是否会为用户提供良好的体验

这一切都取决于你想要做什么。如果您要建立一个用户将上传和播放视频的网站，那么没有 FastCGI 不是一个好的选择。

> 或者我应该选择，在这种情况下，php + my-favorite-framework 作为平台

您总是为工作选择正确的工具。如果没有关于您要构建的内容的任何详细信息，我不确定这里的任何人都能够告诉您如何构建它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T15:59:55.873

我倾向于避免使用 FastCGI。我自己没有使用过它，但我已经阅读了足够多的关于它的恐怖故事，以至于永远不想使用它。

如果托管公司将完全负责管理服务器实例，并且您可以相信他们会确保应用程序始终启动并运行，那么它可能会起作用。不过我怀疑情况是否如此，如果您不拥有服务器，我认为您会遇到很多问题，以解决 FastCGI 不可避免地向您抛出的所有奇怪错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T19:30:55.043

不要担心 mod_rails：它是新的，Rails 站点在它出现之前运行良好。很高兴拥有，我敢肯定，但不是必需品。

当您希望让[Rails 扩展](http://railscantscale.com/)到真正需要 mod_rails 的卷时，应该值得将该站点放入运行它的环境中。

# java - 从 Keystore 获取私钥

> ID：209081
> 
> 赞同：0
> 
> 时间：2008-10-16T15:35:14.443
> 
> 标签：java, keystore

`keytool`我有以下代码从我在 Windows中创建的密钥库中导出证书和密钥：

```
final KeyStore keystore = KeyUtil.loadKeystore("keystore.jks", "pass");  
UserInfo userinfo = new UserInfo(WSusername, WSpassword);  
X509Certificate clientcert = KeyUtil.getCertificate(CLIENT_KEY_ALIAS, keystore);  
X509Certificate servercert = KeyUtil.getCertificate(SERVER_KEY_ALIAS, keystore);  
PrivateKey clientprivate = KeyUtil.getPrivateKey(CLIENT_KEY_ALIAS, CLIENT_KEY_PASSWORD, keystore); 
```

然而它在最后一行以“无法检索用于签名的私钥”失败它可以检索客户端证书，但是当它尝试客户端私有时，它失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T06:18:35.890

我的问题是，当我使用 keytool 生成密钥库时，它没有创建 PrivateKey 作为密钥条目。为了解决这个问题，我将 .p12 密钥库作为私钥导入，这很有效。我上面的原始代码然后工作了。

# c++ - 如何保证快速关闭我的 win32 应用程序？

> ID：209086
> 
> 赞同：7
> 
> 时间：2008-10-16T15:35:37.703
> 
> 标签：c++, multithreading, winapi, exit

我有一个 C++ Win32 应用程序，当用户想要关闭应用程序时，它有许多线程可能正忙于执行 IO（HTTP 调用等）。目前，我玩得很好，等待所有线程结束后再从`main`. 有时，这需要的时间比我想要的要长，事实上，当我可以退出时让用户等待似乎毫无意义。但是，如果我继续从 中返回`main`，我可能会崩溃，因为析构函数开始被调用，而仍然有线程在使用这些对象。

所以，认识到在一个理想的、柏拉图式的美德世界中，最好的办法是等待所有线程退出然后干净地关闭，下一个最好的现实世界解决方案是什么？简单地使线程退出更快可能不是一种选择。目标是尽快让进程停止运行，例如，可以在其上安装新版本。我正在做的唯一磁盘 IO 是在事务数据库中，所以我并不十分担心拔掉插头。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T19:42:26.753

使用重叠 IO，这样您就可以始终控制处理您的 I/O 的线程，并且可以随时停止它们；您可以让他们在 IOCP 上等待并可以向其发布应用程序级别的关闭代码，或者您可以等待 OVERLAPPED 结构中的事件并等待“所有线程请立即关闭”事件。

总之，避免阻止您无法取消的呼叫。

如果你不能并且你被困在一个阻塞的套接字调用中，那么你总是可以从已经决定是时候关闭的线程中关闭套接字，并让正在执行 IO 的线程总是检查'shutdown now ' 重试之前的事件...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T21:30:52.633

我使用了一种基于异常的技术，该技术在许多 Win32 应用程序中都非常有效。

为了终止一个线程，我使用[`QueueUserAPC()`](http://msdn.microsoft.com/en-us/library/ms684954(VS.85).aspx)对一个引发异常的函数的调用进行排队。但是，抛出的异常不是从“异常”类型派生的，因此只会被我线程的包装程序捕获。

这样做的好处如下：

*   线程中不需要特殊代码来使其“可停止” - 一旦它进入可警报等待状态，它将运行 APC 函数。
*   当异常在堆栈中运行时，所有析构函数都会被调用，因此您的线程干净地退出。

您需要注意的事项：

*   做任何事`catch (...)`都会吃掉你的例外。用户代码应始终使用`catch(const Exception &e)`或类似！
*   确保您的 I/O 和延迟以“可提醒”的方式完成。例如，这意味着调用[`sleepex(N, true)`](http://msdn.microsoft.com/en-us/library/ms686307(VS.85).aspx)而不是`sleep(N)`.
*   CPU 绑定线程需要`sleepex(0,true)`偶尔调用以检查是否终止。

您还可以“保护”代码区域以防止任务在关键部分终止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T15:42:42.697

最好的方法：在应用程序运行时做你的工作，在关闭时什么都不做（或接近）（也适用于启动）。如果您坚持这种模式，那么您可以在关闭请求到来时立即拆除线程（而不是“友好地”处理它），而不必担心仍然需要完成的工作。

在您的特定情况下，如果您在那里进行本地工作，您可能需要等待 IO 完成（至少写入）。HTTP 请求等你可能会直接放弃/关闭（同样，除非你正在写东西）。但是，如果您在此关闭期间编写并等待，那么您可能希望将此通知用户，而不是让您的进程在结束时看起来挂起。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T15:56:35.803

我建议让您的 GUI 和工作在不同的线程上完成。当用户请求关闭时，立即关闭 GUI，以显示应用程序已关闭。允许工作线程在后台优雅地关闭。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T21:09:48.917

无论你做什么，都**不要**使用 TerminateThread，尤其是在任何可能在 OS HTTP 调用中的东西上。您可能会破坏 IE，直到重新启动。

将所有 IO 更改为异步或非阻塞模型，以便它们可以监视终止事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T15:51:39.840

如果你想乱七八糟地拔掉插头，exit(0) 就可以了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T11:35:55.173

如果您需要突然关闭：只需调用 ExitProcess - 无论如何，只要您从 WinMain 返回就会调用它。Windows 本身会创建许多无法清理的工作线程 - 它们会因进程关闭而终止。

如果您有任何线程正在执行某种类型的写入 - 显然这些线程需要有机会关闭它们的资源。但除此之外 - 忽略边界检查器警告，只需将地毯从他们脚下拉出来。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T12:03:01.033

您可以调用 TerminateProcess - 这将立即停止该过程，无需通知任何人，也无需等待任何事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T20:27:40.983

我曾经遇到过类似的问题，尽管在 Visual Basic 6 中：来自应用程序的线程将连接到不同的服务器，下载一些数据，执行一些循环操作该数据，并将结果存储在中央服务器上。

然后，新的要求是线程应该可以从主窗体停止。我以一种简单但肮脏的方式实现了这一点，方法是让线程在 N 个循环后停止（大约相当于半秒）以尝试打开具有特定名称的互斥锁。成功后，他们立即停止正在做的任何事情并退出，否则继续。

该互斥锁仅由主窗体创建，一旦创建，所有线程很快就会自行关闭。缺点是用户需要手动指定它想要再次运行线程 - 另一个“启用线程运行”按钮通过释放互斥锁来实现这一点：D

保证这个技巧适用于互斥操作是原子的。问题是您永远无法确定线程是否真正关闭 - 处理“openMutex 成功”情况的逻辑失败可能意味着它永远不会结束。您也不知道何时/是否所有线程都已关闭（假设您的代码是正确的，这将与循环停止和“收听”所需的时间大致相同）。

使用 VB 的多线程“公寓”模型，从线程到主应用程序来回发送信息有点困难，“触发后忘记”或仅从主应用程序发送到线程要容易得多。因此，需要这种长切。使用 C++，您可以自由使用多线程模型，因此这些约束可能不适用于您。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-12-09T02:32:29.687

`*NULL = 0`是最快的方法。如果您不想崩溃，请致电`exit()`或其 win32 等效项。

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2008-10-16T15:50:09.093

指示用户拔下计算机。除此之外，您必须放弃异步活动。还是那是HWIND？我永远记不起C++。当然，您可以采取中间道路并在文本文件或注册键中快速记下放弃了哪些操作，以便下次程序运行时它可以再次自动执行该操作或询问用户是否愿意这样做。根据您放弃异步操作时丢失的数据，您可能无法做到这一点。如果您正在与用户交互，您可能需要考虑一个对话框或一些 UI 交互来解释为什么需要这么长时间。

就个人而言，我更喜欢用户的指令，即拔掉电脑。:)

# perl - 如何插入变量以从模块调用 Perl 函数？

> ID：209095
> 
> 赞同：3
> 
> 时间：2008-10-16T15:37:03.753
> 
> 标签：perl, variables, interpolation

要求是从命令行参数传递模块名称和函数名称。我需要在程序中获取命令行参数，并且需要从该模块调用该函数

例如，调用带有 2 个参数的 try.pl 程序： MODULE1(Module name) Display(Function name)

```
 perl try.pl MODULE1 Display 
```

我想要这样的东西，但它不起作用，请指导我：

```
use $ARGV[0];
& $ARGV[0]::$ARGV[1](); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-16T16:33:11.953

假设函数不是类方法，试试这个：

```
#!/usr/bin/perl
use strict;
use warnings;

my ( $package, $function ) = @ARGV;

eval "use $package (); ${package}::$function()";
die $@ if $@; 
```

请记住，这种技术对代码注入非常开放。（参数可以很容易地包含任何 Perl 代码而不是模块名称。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T16:17:35.170

There's many ways to do this. One of them is:

```
#!/usr/bin/perl
use strict;
use warnings;

my ( $package, $function ) = @ARGV;

eval "use $package; 1" or die $@;

$package->$function(); 
```

Note the the first argument of the function will be $package.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T16:25:10.833

假设模块导出函数，应该这样做：

```
perl -Mmodule -e function 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T19:50:04.320

如果你想确保你的 perl 脚本是安全的（或者至少，防止自己不小心做一些愚蠢的事情），我会避免在没有至少某种检查的情况下对传入脚本的数据进行任何类型的评估。但是，如果您无论如何都要进行某种检查，并且最终明确地检查了输入，那么您最好明确地拼出您想要调用的女巫方法。您可以使用“已知良好”方法设置散列，从而记录您想要调用的所有内容并同时保护自己。

```
my %routines = (
    Module => {
        Routine1 => \&Module::Method,
        Routine2 => \&Module::Method2, 
    },
    Module2 => { 
        # and so on
    },
);

my $module  = shift @ARGV;
my $routine = shift @ARGV;

if (defined $module
    && defined $routine
    && exists $routines{$module}            # use `exists` to prevent 
    && exists $routines{$module}{$routine}) # unnecessary autovivication
{
    $routines{$module}{$routine}->(@ARGV); # with remaining command line args
}
else { } # error handling 
```

作为此方法的一个简洁的副作用，您可以简单地遍历可用于任何类型帮助输出的方法：

```
print "Available commands:\n";
foreach my $module (keys %routines)
{
    foreach my $routine (keys %$module)
    {
        print "$module::$routine\n";
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-16T17:07:30.310

按照 Leon 的说法，如果 perl 模块*没有*导出它，你可以这样称呼它

```
perl -MMyModule -e 'MyModule::doit()' 
```

前提是子在该包中。

如果它一直导出子（in `@EXPORT`），那么 Leon's 将起作用：

```
perl -MMyModule -e doit 
```

如果它是可选的导出（in `@EXPORT_OK`），那么您可以这样做。

```
perl -MMyModule=doit -e doit 
```

但是第一个在 sub 被定义到包的任何情况下都可以工作，我可能会在最后一个上使用那个。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-17T01:26:50.270

总是像这样启动你的 Perl：

```
use strict;
use warnings 'all'; 
```

然后这样做：

```
no strict 'refs';
my ($class, $method) = @_;
(my $file = "$class.pm") =~ s/::/\//g;
require $file;
&{"$class\::$method"}(); 
```

无论你做什么，都尽量不要评估“$string”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-17T02:45:59.160

好吧，对于您*修改*后的问题，您可以这样做：

```
use strict;
use warnings;

{
    no strict;
    use Symbol qw<qualify>;
    my $symb = qualify( $ARGV[1], $ARGV[0] );
    unless ( defined &{$symb} ) { 
        die "&$ARGV[1] not defined to package $ARGV[0]\::";
    }
    &{$symb};
} 
```

而且因为您是在命令行中指定它，所以从命令行包含的最简单方法是`-M`标志。

```
perl -MMyModule try.pl MyModule a_subroutine_which_does_something_cool 
```

但你总是可以

```
eval "use $ARGV[0];"; 
```

但这很容易被注入：

```
perl try.pl "Carp; `do something disastrous`;" no_op 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-21T01:20:56.257

我会使用[UNIVERSAL::require](http://search.cpan.org/~mschwern/UNIVERSAL-require-0.10/lib/UNIVERSAL/require.pm)。它允许您从变量中获取或使用模块。所以你的代码会变成这样：

```
use UNIVERSAL::require;

$ARGV[0]->use or die $UNIVERSAL::require::ERROR;
$ARGV[0]::$ARGV[1](); 
```

免责声明：我没有测试该代码，并且我同意 Robert P 关于可能有比将这些作为命令行参数传递更好的解决方案的评论。

# c++ - MFC：显示/隐藏拆分器窗格

> ID：209110
> 
> 赞同：1
> 
> 时间：2008-10-16T15:39:25.230
> 
> 标签：c++, windows, winapi, mfc, csplitterwnd

在我的应用程序中，我有许多来自 m_wndspliter 类的窗格。我想要做的是在运行时显示和隐藏这些窗格之一。虽然使用以下代码可以显示和隐藏与窗格关联的视图，但我无法暂时删除窗格本身。

```
CWnd * pCurView = m_wndSplitter2.GetPane(2, 0);
if( !pCurView == NULL )
{
    if( fShow )
    {
        pCurView->ShowWindow(SW_SHOW);
        RecalcLayout();
    }
    else
    {
        pCurView->ShowWindow(SW_HIDE);
        RecalcLayout();
    }
} 
```

任何例子/想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T16:33:27.400

您需要调用 CSplitterWnd::DeleteView 来执行此操作，这基本上意味着如果您打算恢复它，您必须将 CView 保存在其他地方。通常这不是问题，因为所有数据都应该存储在 CDocument 而不是 CView 中，但实际上可能并非如此。

我过去处理这个问题的方法是为我的 CView 类创建一个复制构造函数，这样我就可以轻松地将它们存储在临时变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T17:39:25.363

这有帮助吗？

[http://www.codeguru.com/cpp/wd/splitter/article.php/c1543](http://www.codeguru.com/cpp/w-d/splitter/article.php/c1543)

我自己用过非常相似的东西，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-07T14:17:02.503

只有`CExtSplitter`CodeProject 文章[https://www.codeproject.com/Articles/2707/A-Static-Splitter-with-the-Ability-to-Hide-Show-Mu](https://www.codeproject.com/Articles/2707/A-Static-Splitter-with-the-Ability-to-Hide-Show-Mu)中的课程对我有用。

这仍然是 VC6 代码，但它进行了较小的修改。

# .net - .net 系统托盘应用程序在插入 USB 设备时启动

> ID：209120
> 
> 赞同：2
> 
> 时间：2008-10-16T15:42:49.810
> 
> 标签：.net, usb, system-tray

插入 USB 设备时，如何让我的 .net 系统托盘应用程序弹出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T15:50:15.473

您可能会[在此处](http://www.codeproject.com/KB/system/DriveDetector.aspx)查找执行您想要的操作的示例应用程序。

# jquery - jQuery - 实时验证插件

> ID：209127
> 
> 赞同：9
> 
> 时间：2008-10-16T15:44:31.803
> 
> 标签：jquery, validation, plugins

我正在寻找一个 jQuery 插件，它可以在按下一个键并在它失去焦点后（文本框）进行验证。

我目前正在使用[jVal - jQuery 表单字段验证插件](http://www.overset.com/2008/07/31/jval-jquery-form-field-validation-plugin/)。它工作得很好。我唯一的问题是我只能使用通用错误消息。

例如：我需要一个介于 2 到 5 个字符之间的字符串。如果它太短，我想显示一条错误消息，指示它太短，同样如果它太长。我知道我可以显示一条错误消息，要求字符串在 2 到 5 个字符之间。 **正在进行的验证更加复杂。**

其他验证器的任何想法或我如何使用此插件来显示独特的错误消息。

* * *

编辑：

验证工具需要防止特定的字母或数字，并且不需要表单。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-16T15:54:04.607

这个看起来很适合你的描述：

*   [jQuery插件：验证（主页）](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)
*   [演示](http://jquery.bassistance.de/validate/demo/)
*   [API 文档](http://docs.jquery.com/Plugins/Validation)

这是从演示源复制的代码片段：

```
// validate signup form on keyup and submit
$("#signupForm").validate({
    rules: {
        firstname: "required",
        lastname: "required",
        username: {
            required: true,
            minlength: 2
        },
        password: {
            required: true,
            minlength: 5
        },
        confirm_password: {
            required: true,
            minlength: 5,
            equalTo: "#password"
        },
        email: {
            required: true,
            email: true
        },
        topic: {
            required: "#newsletter:checked",
            minlength: 2
        },
        agree: "required"
    },
    messages: {
        firstname: "Please enter your firstname",
        lastname: "Please enter your lastname",
        username: {
            required: "Please enter a username",
            minlength: "Your username must consist of at least 2 characters"
        },
        password: {
            required: "Please provide a password",
            minlength: "Your password must be at least 5 characters long"
        },
        confirm_password: {
            required: "Please provide a password",
            minlength: "Your password must be at least 5 characters long",
            equalTo: "Please enter the same password as above"
        },
        email: "Please enter a valid email address",
        agree: "Please accept our policy"
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-23T18:21:48.053

试试这个：

[http://www.geektantra.com/2009/09/jquery-live-form-validation/](http://www.geektantra.com/2009/09/jquery-live-form-validation/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-08T13:01:56.710

对我来说最好的是[http://livevalidation.com/](http://livevalidation.com/) 或来自 baseassistance 的[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

jVal 和 live-form-validation 可以，但我认为使用 gjQuery 的全部意义在于使用干净、通畅的代码，而且它们需要大量的混乱，这对我来说不是一个选择。

我猜 live-form-validation 将在未来发展，真的很奇怪必须输入整个正则表达式来验证每个表单中的电子邮件......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T14:05:22.250

我使用 jQuery 插件：验证。它非常适合动态创建 DOM 元素。在动态创建它们时，请确保包含属性名称和 ID。我很确定插件使用 name 属性在 html 中找到它们。如果名称丢失，则无法找到。

这也可能是另一个很好的验证工具。 [http://www.livevalidation.com](http://www.livevalidation.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-28T02:08:17.030

在 jVal 0.1.4 的当前主干中，它可以处理比以前版本更强大的错误检查功能，允许您将字符串作为错误消息返回。[在http://jquery-jval.googlecode.com/svn/trunk/jVal.js](http://jquery-jval.googlecode.com/svn/trunk/jVal.js)获取当前修订版 11 jVal 0.1.4 主干

下面是一个将检查的密码字段示例：

1.  如果密码有 8 个字符或更多
2.  如果密码至少有一个数字字符
3.  如果密码至少有一个以上的字母字符

如果未通过特定检查，它将显示自定义消息

```
<input id="web_pswd" type="password" size="20"
    jVal="{valid:function (val) { if ( val.length < 8 ) return '8 or more characters required'; else if ( val.search(/[0-9]/) == -1 ) return '1 number or more required'; else if ( val.search(/[a-zA-Z]/) == -1 ) return '1 letter or more required'; else return ''; }, styleType:'pod'}" 
```

# oracle - 比较和对比变更数据捕获和数据库变更通知

> ID：209128
> 
> 赞同：5
> 
> 时间：2008-10-16T15:44:45.517
> 
> 标签：oracle, change-data-capture

Oracle 有两种看似相互竞争的技术。CDC 和 DCN。

各自的强项是什么？

你什么时候用一个而不用另一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T16:28:16.083

通常，您将使用 DCN 通知客户端应用程序客户端应用程序需要清除/更新应用程序的缓存。您将使用 CDC 进行 ETL 处理。

当您的 OLTP 应用程序需要立即通知数据库中的数据更改时，通常首选 DCN。由于这里的目标是最大限度地减少网络往返次数和数据库命中次数，因此您通常希望应用程序使用 DCN 进行大部分静态查询。如果大部分查询定期更改，您最好只以设定的频率刷新应用程序的缓存，而不是不断运行查询以获取更改的数据（DCN 不包含更改的数据，仅包含行的 ROWID (s) 发生了变化）。如果应用程序出现故障，我相信 DCN 允许丢失更改。

当您有一个 DSS 应用程序需要定期拉取在多个表中更改的所有数据时，CDC 通常更可取。CDC 可以保证订阅者已收到对基础表的所有更改，如果您尝试将更改复制到不同的数据库，这可能很重要。CDC 允许订阅者在方便时提取更改，而不是试图通知订阅者有更改，因此如果您希望订阅者每小时或每天而不是近乎实时地处理新数据，您肯定需要 CDC . *（注意：DCN 也有保证交付模式，请参阅下面的评论。--Mark Harrison）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:38:14.660

CDC 的设置似乎比 DCN 复杂得多。

我的意思是设置 DCN，我在开始和结束 DCN 块中包装一个选择，然后编写一个过程以调用一系列更改。就是这样。

CDC 需要发布者和订阅者，无论如何，这似乎需要更多的工作。

# jsp - JSP 支柱

> ID：209132
> 
> 赞同：1
> 
> 时间：2008-10-16T15:46:38.273
> 
> 标签：jsp, struts, jsp-tags

我将如何在 JSP <%> 中的 scriplet 代码中分配一个变量，然后使用 struts 逻辑标记根据在 scriplet 代码块中分配的变量的值来执行操作？

我尝试使用 struts:logic equal and greaterthan 无济于事....

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T19:16:10.550

你想要做的（如果我理解你是正确的）基本上是这样的：

```
<% String foo = "Test"; %>
<bean:write name="foo" /> 
```

正如您已经知道的那样，这是行不通的。这会给出这样的错误：

> 在任何范围内都找不到 bean foo

我通常做的是将我的数据放在页面范围内，如下所示：

```
<% pageContext.setAttribute("foo", "Test"); %>
<bean:write name="foo" /> 
```

（这是针对 Struts 1.1 的。较新的版本可能会提供更好的方法。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-21T06:40:11.337

我猜你会发现这个：

scriptlet 代码 你必须在 JSP 上编写 Java 代码

```
<%int var=1; %>in jsp its declaration ( <%! int i = 0; %> ) 
```

表达式元素可以包含根据 Java 语言规范有效的任何表达式，但不能使用分号结束表达式

```
<p>   Today's date: <%= (new java.util.Date()).toLocaleString()%></p> 
```

谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-04T14:31:34.910

在脚本中：

```
<%
   request.setAttribute("customerName", "rajesh");
%> 
```

您可以签入 struts 逻辑标签，例如，

```
<logic:match name="customerName" value="Vijay"></logic:match> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-29T15:28:29.463

您可以使用标签在 Struts2 中设置变量。例如：

```
<c:set var="contains" value="true" /> 
```

可以测试逻辑：

```
<c:if test="%{#variable=='String 1'}">
    This is String 1
</c:if> 
```

其他来源： [http ://www.mkyong.com/struts2/struts-2-if-elseif-else-tag-example/](http://www.mkyong.com/struts2/struts-2-if-elseif-else-tag-example/)

必需的标签库：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
```

# c# - 英文的异常信息？

> ID：209133
> 
> 赞同：327
> 
> 时间：2008-10-16T15:47:12.687
> 
> 标签：c#, .net, exception, localization

我们通过将 Exception.Message 写入文件来记录系统中发生的任何异常。但是，它们是按照客户的文化编写的。土耳其语错误对我来说意义不大。

那么我们如何在不改变用户文化的情况下用英语记录任何错误消息呢？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-10-16T16:11:59.110

这个问题可以部分解决。框架异常代码根据当前线程语言环境从其资源中加载错误消息。在某些例外情况下，这发生在访问 Message 属性时。

对于这些例外情况，您可以通过在记录消息时将线程区域设置短暂切换为 en-US 来获取消息的完整美国英语版本（事先保存原始用户区域设置并在之后立即恢复）。

在单独的线程上执行此操作会更好：这可以确保不会有任何副作用。例如：

```
try
{
  System.IO.StreamReader sr=new System.IO.StreamReader(@"c:\does-not-exist");
}
catch(Exception ex)
{
  Console.WriteLine(ex.ToString()); //Will display localized message
  ExceptionLogger el = new ExceptionLogger(ex);
  System.Threading.Thread t = new System.Threading.Thread(el.DoLog);
  t.CurrentUICulture = new System.Globalization.CultureInfo("en-US");
  t.Start();
} 
```

ExceptionLogger 类看起来像这样：

```
class ExceptionLogger
{
  Exception _ex;

  public ExceptionLogger(Exception ex)
  {
    _ex = ex;
  }

  public void DoLog()
  {
    Console.WriteLine(_ex.ToString()); //Will display en-US message
  }
} 
```

但是，正如[Joe](https://stackoverflow.com/users/13087/joe)在对此回复的早期版本的评论中正确指出的那样，在引发异常时，已经（部分）从语言资源中加载了一些消息。

例如，这适用于在引发 ArgumentNullException("foo") 异常时生成的消息的“参数不能为空”部分。在这些情况下，即使使用上述代码，消息仍将显示（部分）本地化。

除了使用不切实际的 hack，例如在具有 en-US 语言环境的线程上运行所有非 UI 代码之外，您似乎无能为力：.NET Framework 异常代码没有用于覆盖错误消息区域设置的工具。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2010-09-28T22:00:31.130

[您可以在unlocalize.com](http://www.unlocalize.com)上搜索原始异常消息

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2013-07-24T21:24:56.173

也许是一个有争议的观点，但`en-US`您可以将其设置为 ，而不是将文化设置为`Invariant`。在`Invariant`文化中，错误消息是英文的。

```
Thread.CurrentThread.CurrentCulture = CultureInfo.InvariantCulture;
Thread.CurrentThread.CurrentUICulture = CultureInfo.InvariantCulture; 
```

它的优点是看起来没有偏见，尤其是对于非美式英语语言环境。（又名避免同事的冷嘲热讽）

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-01-07T15:41:27.507

这是不需要任何编码的解决方案，即使对于加载得太早而我们无法通过代码更改的异常文本（例如，mscorlib 中的那些）也适用。

它可能并不总是适用于所有情况（这取决于您的设置，因为您需要能够在主 .exe 文件之外创建一个 .config 文件），但这对我有用。因此，只需创建一个包含以下行的`app.config`in dev（或 a `[myapp].exe.config`or `web.config`in production），例如：

```
<configuration>
  ...
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="mscorlib.resources" publicKeyToken="b77a5c561934e089"
                          culture="fr" /> <!-- change this to your language -->

        <bindingRedirect oldVersion="1.0.0.0-999.0.0.0" newVersion="999.0.0.0"/>
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Xml.resources" publicKeyToken="b77a5c561934e089"
                          culture="fr" /> <!-- change this to your language -->

        <bindingRedirect oldVersion="1.0.0.0-999.0.0.0" newVersion="999.0.0.0"/>
      </dependentAssembly>

      <!-- add other assemblies and other languages here -->

    </assemblyBinding>
  </runtime>
  ...
</configuration> 
```

这样做是告诉框架重定向`mscorlib`' 资源 和`System.Xml`' 资源的程序集绑定，对于 1 到 999 之间的版本，法语（文化设置为“ `fr`”）到......不存在的程序集（任意999 版）。

因此，当 CLR 为这两个程序集（mscorlib 和 System.xml）寻找法语资源时，它不会找到它们并优雅地回退到英语。根据您的上下文和测试，您可能希望将其他程序集添加到这些重定向（包含本地化资源的程序集）。

当然，我认为微软不支持此功能，因此使用风险自负。好吧，如果您发现问题，您可以删除此配置并检查它是否无关。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-01-07T16:27:41.663

Windows 需要安装您要使用的 UI 语言。它没有，它无法神奇地知道翻译的消息是什么。

在安装了 pt-PT 的 en-US windows 7 Ultimate 中，以下代码：

```
Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo("pt-PT");
string msg1 = new DirectoryNotFoundException().Message;

Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo("en-US");
string msg2 = new FileNotFoundException().Message;

Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo("fr-FR");
string msg3 = new FileNotFoundException().Message; 
```

在 pt-PT、en-US 和 en-US 中生成消息。由于没有安装法语文化文件，它默认为 windows 默认（安装？）语言。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-08-26T15:17:02.767

我知道这是一个老话题，但我认为我的解决方案可能与在网络搜索中偶然发现它的任何人都非常相关：

在异常记录器中，您可以记录 ex.GetType.ToString，这将保存异常类的名称。我希望类的名称应该独立于语言，因此总是用英语表示（例如“System.FileNotFoundException”），尽管目前我无法访问外语系统来测试主意。

如果您真的想要错误消息文本，您可以创建一个包含所有可能的异常类名称及其等效消息的字典，使用您喜欢的任何语言，但对于英语，我认为类名称就足够了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-15T21:36:03.883

```
CultureInfo oldCI = Thread.CurrentThread.CurrentCulture;

Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture ("en-US");
Thread.CurrentThread.CurrentUICulture=new CultureInfo("en-US");
try
{
  System.IO.StreamReader sr=new System.IO.StreamReader(@"c:\does-not-exist");
}
catch(Exception ex)
{
  Console.WriteLine(ex.ToString())
}
Thread.CurrentThread.CurrentCulture = oldCI;
Thread.CurrentThread.CurrentUICulture = oldCI; 
```

没有变通方法。

谢:)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-12-19T15:42:50.477

设置`Thread.CurrentThread.CurrentUICulture`将用于本地化异常。如果您需要两种异常（一种为用户，一种为您），您可以使用以下函数来翻译异常消息。它在 .NET-Libraries 资源中搜索原始文本以获取资源键，然后返回翻译后的值。但是有一个弱点我还没有找到一个好的解决方案：消息中包含 {0} 的资源将不会被找到。如果有人有好的解决方案，我将不胜感激。

```
public static string TranslateExceptionMessage(Exception ex, CultureInfo targetCulture)
{
    try
    {
        Assembly assembly = ex.GetType().Assembly;
        ResourceManager resourceManager = new ResourceManager(assembly.GetName().Name, assembly);
        ResourceSet originalResources = resourceManager.GetResourceSet(Thread.CurrentThread.CurrentUICulture, createIfNotExists: true, tryParents: true);
        ResourceSet targetResources = resourceManager.GetResourceSet(targetCulture, createIfNotExists: true, tryParents: true);
        foreach (DictionaryEntry originalResource in originalResources)
            if (originalResource.Value.ToString().Equals(ex.Message.ToString(), StringComparison.Ordinal))
                return targetResources.GetString(originalResource.Key.ToString(), ignoreCase: false); // success

    }
    catch { }
    return ex.Message; // failed (error or cause it's not smart enough to find texts with '{0}'-patterns)
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-04-28T12:34:30.037

.NET 框架分为两部分：

1.  .NET 框架本身
2.  .NET 框架语言包

所有文本（例如异常消息、MessageBox 上的按钮标签等）在 .NET 框架本身中都是英文的。语言包具有本地化文本。

根据您的具体情况，一个解决方案是卸载语言包（即告诉客户这样做）。在这种情况下，例外文本将为英文。但是请注意，所有其他框架提供的文本也将是英文的（例如 MessageBox 上的按钮标签，ApplicationCommands 的键盘快捷键）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-11-06T07:24:13.993

基于 Undercover1989 答案，但考虑到参数以及消息何时由多个资源字符串组成（如参数异常）。

```
public static string TranslateExceptionMessage(Exception exception, CultureInfo targetCulture)
{
    Assembly a = exception.GetType().Assembly;
    ResourceManager rm = new ResourceManager(a.GetName().Name, a);
    ResourceSet rsOriginal = rm.GetResourceSet(Thread.CurrentThread.CurrentUICulture, true, true);
    ResourceSet rsTranslated = rm.GetResourceSet(targetCulture, true, true);

    var result = exception.Message;

    foreach (DictionaryEntry item in rsOriginal)
    {
        if (!(item.Value is string message))
            continue;

        string translated = rsTranslated.GetString(item.Key.ToString(), false);

        if (!message.Contains("{"))
        {
            result = result.Replace(message, translated);
        }
        else
        {
            var pattern = $"{Regex.Escape(message)}";
            pattern = Regex.Replace(pattern, @"\\{([0-9]+)\}", "(?<group$1>.*)");

            var regex = new Regex(pattern);

            var replacePattern = translated;
            replacePattern = Regex.Replace(replacePattern, @"{([0-9]+)}", @"${group$1}");
            replacePattern = replacePattern.Replace("\\$", "$");

            result = regex.Replace(result, replacePattern);
        }
    }

    return result;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-16T16:04:11.607

我会想象其中一种方法：

1.  异常只能由您阅读，即它们不是客户端功能，因此您可以使用硬连线的非本地化字符串，当您在土耳其语模式下运行时，这些字符串不会改变。

2.  包括一个错误代码，例如`0x00000001`每个错误，以便您可以轻松地在英文表格中查找它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-04-20T16:24:58.100

我有同样的情况，我在这里和其他地方找到的所有答案都没有帮助或不令人满意：

*   [强制例外语言为英语](https://stackoverflow.com/questions/2092298/force-exceptions-language-in-english)
*   [C# - 当应用程序使用另一种语言时，以英语获取异常消息？](https://stackoverflow.com/questions/31681139/c-sharp-getting-exception-messages-in-english-when-the-application-is-in-anoth)
*   [如何在调试时将 Visual Studio 异常消息语言更改为英语](https://stackoverflow.com/questions/529951/how-to-change-visual-studio-exception-message-language-to-english-while-debuggin)
*   [如何处理异常消息的翻译？](https://stackoverflow.com/questions/17993946/how-to-handle-translation-of-exception-message)
*   [如何完全避免本地化的 .NET 异常消息](https://stackoverflow.com/questions/13272323/how-to-completely-avoid-localized-net-exception-messages?rq=1)

更改了 .net 异常的`Thread.CurrentUICulture`语言，但它不会更改 .net ，它`Win32Exception`以 Windows UI 本身的语言使用 Windows 资源。所以我从来没有设法`Win32Exception`用英语而不是德语打印消息，甚至没有`FormatMessage()`按照
[How to get Win32Exception in English?](https://stackoverflow.com/questions/34423129/how-to-get-win32exception-in-english/34622953#34622953)

因此，我创建了自己的解决方案，它将不同语言的大部分现有异常消息存储在外部文件中。您不会以您想要的语言收到非常准确的信息，但您会收到该语言的信息，这比您当前获得的信息要多得多（这是您可能不理解的语言的信息）。

此类的静态功能可以在具有不同语言的 Windows 安装上执行： `CreateMessages()`创建特定于文化的文本
`SaveMessagesToXML()`将它们保存到与创建或加载语言一样多的 XML 文件
`LoadMessagesFromXML()`加载所有带有特定语言消息的 XML 文件

在使用不同语言的不同 Windows 安装上创建 XML 文件时，您很快就会拥有所需的所有语言。
当您安装了多个 MUI 语言包时，也许您可​​以在 1 个 Windows 上创建不同语言的文本，但我还没有测试过。

经VS2008测试，即可使用。欢迎提出意见和建议！

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Globalization;
using System.Reflection;
using System.Threading;
using System.Xml;

public struct CException
{
  //----------------------------------------------------------------------------
  public CException(Exception i_oException)
  {
    m_oException = i_oException;
    m_oCultureInfo = null;
    m_sMessage = null;
  }

  //----------------------------------------------------------------------------
  public CException(Exception i_oException, string i_sCulture)
  {
    m_oException = i_oException;
    try
    { m_oCultureInfo = new CultureInfo(i_sCulture); }
    catch
    { m_oCultureInfo = CultureInfo.InvariantCulture; }
    m_sMessage = null;
  }

  //----------------------------------------------------------------------------
  public CException(Exception i_oException, CultureInfo i_oCultureInfo)
  {
    m_oException = i_oException;
    m_oCultureInfo = i_oCultureInfo == null ? CultureInfo.InvariantCulture : i_oCultureInfo;
    m_sMessage = null;
  }

  //----------------------------------------------------------------------------
  // GetMessage
  //----------------------------------------------------------------------------
  public string GetMessage() { return GetMessage(m_oException, m_oCultureInfo); }

  public string GetMessage(String i_sCulture) { return GetMessage(m_oException, i_sCulture); }

  public string GetMessage(CultureInfo i_oCultureInfo) { return GetMessage(m_oException, i_oCultureInfo); }

  public static string GetMessage(Exception i_oException) { return GetMessage(i_oException, CultureInfo.InvariantCulture); }

  public static string GetMessage(Exception i_oException, string i_sCulture)
  {
    CultureInfo oCultureInfo = null;
    try
    { oCultureInfo = new CultureInfo(i_sCulture); }
    catch
    { oCultureInfo = CultureInfo.InvariantCulture; }
    return GetMessage(i_oException, oCultureInfo);
  }

  public static string GetMessage(Exception i_oException, CultureInfo i_oCultureInfo)
  {
    if (i_oException == null) return null;
    if (i_oCultureInfo == null) i_oCultureInfo = CultureInfo.InvariantCulture;

    if (ms_dictCultureExceptionMessages == null) return null;
    if (!ms_dictCultureExceptionMessages.ContainsKey(i_oCultureInfo))
      return CreateMessage(i_oException, i_oCultureInfo);

    Dictionary<string, string> dictExceptionMessage = ms_dictCultureExceptionMessages[i_oCultureInfo];
    string sExceptionName = i_oException.GetType().FullName;
    sExceptionName = MakeXMLCompliant(sExceptionName);
    Win32Exception oWin32Exception = (Win32Exception)i_oException;
    if (oWin32Exception != null)
      sExceptionName += "_" + oWin32Exception.NativeErrorCode;
    if (dictExceptionMessage.ContainsKey(sExceptionName))
      return dictExceptionMessage[sExceptionName];
    else
      return CreateMessage(i_oException, i_oCultureInfo);
  }

  //----------------------------------------------------------------------------
  // CreateMessages
  //----------------------------------------------------------------------------
  public static void CreateMessages(CultureInfo i_oCultureInfo)
  {
    Thread oTH = new Thread(new ThreadStart(CreateMessagesInThread));
    if (i_oCultureInfo != null)
    {
      oTH.CurrentCulture = i_oCultureInfo;
      oTH.CurrentUICulture = i_oCultureInfo;
    }
    oTH.Start();
    while (oTH.IsAlive)
    { Thread.Sleep(10); }
  }

  //----------------------------------------------------------------------------
  // LoadMessagesFromXML
  //----------------------------------------------------------------------------
  public static void LoadMessagesFromXML(string i_sPath, string i_sBaseFilename)
  {
    if (i_sBaseFilename == null) i_sBaseFilename = msc_sBaseFilename;

    string[] asFiles = null;
    try
    {
      asFiles = System.IO.Directory.GetFiles(i_sPath, i_sBaseFilename + "_*.xml");
    }
    catch { return; }

    ms_dictCultureExceptionMessages.Clear();
    for (int ixFile = 0; ixFile < asFiles.Length; ixFile++)
    {
      string sXmlPathFilename = asFiles[ixFile];

      XmlDocument xmldoc = new XmlDocument();
      try
      {
        xmldoc.Load(sXmlPathFilename);
        XmlNode xmlnodeRoot = xmldoc.SelectSingleNode("/" + msc_sXmlGroup_Root);

        string sCulture = xmlnodeRoot.SelectSingleNode(msc_sXmlGroup_Info + "/" + msc_sXmlData_Culture).Value;
        CultureInfo oCultureInfo = new CultureInfo(sCulture);

        XmlNode xmlnodeMessages = xmlnodeRoot.SelectSingleNode(msc_sXmlGroup_Messages);
        XmlNodeList xmlnodelistMessage = xmlnodeMessages.ChildNodes;
        Dictionary<string, string> dictExceptionMessage = new Dictionary<string, string>(xmlnodelistMessage.Count + 10);
        for (int ixNode = 0; ixNode < xmlnodelistMessage.Count; ixNode++)
          dictExceptionMessage.Add(xmlnodelistMessage[ixNode].Name, xmlnodelistMessage[ixNode].InnerText);
        ms_dictCultureExceptionMessages.Add(oCultureInfo, dictExceptionMessage);
      }
      catch
      { return; }
    }
  }

  //----------------------------------------------------------------------------
  // SaveMessagesToXML
  //----------------------------------------------------------------------------
  public static void SaveMessagesToXML(string i_sPath, string i_sBaseFilename)
  {
    if (i_sBaseFilename == null) i_sBaseFilename = msc_sBaseFilename;

    foreach (KeyValuePair<CultureInfo, Dictionary<string, string>> kvpCultureExceptionMessages in ms_dictCultureExceptionMessages)
    {
      string sXmlPathFilename = i_sPath + i_sBaseFilename + "_" + kvpCultureExceptionMessages.Key.TwoLetterISOLanguageName + ".xml";
      Dictionary<string, string> dictExceptionMessage = kvpCultureExceptionMessages.Value;

      XmlDocument xmldoc = new XmlDocument();
      XmlWriter xmlwriter = null;
      XmlWriterSettings writerSettings = new XmlWriterSettings();
      writerSettings.Indent = true;

      try
      {
        XmlNode xmlnodeRoot = xmldoc.CreateElement(msc_sXmlGroup_Root);
        xmldoc.AppendChild(xmlnodeRoot);
        XmlNode xmlnodeInfo = xmldoc.CreateElement(msc_sXmlGroup_Info);
        XmlNode xmlnodeMessages = xmldoc.CreateElement(msc_sXmlGroup_Messages);
        xmlnodeRoot.AppendChild(xmlnodeInfo);
        xmlnodeRoot.AppendChild(xmlnodeMessages);

        XmlNode xmlnodeCulture = xmldoc.CreateElement(msc_sXmlData_Culture);
        xmlnodeCulture.InnerText = kvpCultureExceptionMessages.Key.Name;
        xmlnodeInfo.AppendChild(xmlnodeCulture);

        foreach (KeyValuePair<string, string> kvpExceptionMessage in dictExceptionMessage)
        {
          XmlNode xmlnodeMsg = xmldoc.CreateElement(kvpExceptionMessage.Key);
          xmlnodeMsg.InnerText = kvpExceptionMessage.Value;
          xmlnodeMessages.AppendChild(xmlnodeMsg);
        }

        xmlwriter = XmlWriter.Create(sXmlPathFilename, writerSettings);
        xmldoc.WriteTo(xmlwriter);
      }
      catch (Exception e)
      { return; }
      finally
      { if (xmlwriter != null) xmlwriter.Close(); }
    }
  }

  //----------------------------------------------------------------------------
  // CreateMessagesInThread
  //----------------------------------------------------------------------------
  private static void CreateMessagesInThread()
  {
    Thread.CurrentThread.Name = "CException.CreateMessagesInThread";

    Dictionary<string, string> dictExceptionMessage = new Dictionary<string, string>(0x1000);

    GetExceptionMessages(dictExceptionMessage);
    GetExceptionMessagesWin32(dictExceptionMessage);

    ms_dictCultureExceptionMessages.Add(Thread.CurrentThread.CurrentUICulture, dictExceptionMessage);
  }

  //----------------------------------------------------------------------------
  // GetExceptionTypes
  //----------------------------------------------------------------------------
  private static List<Type> GetExceptionTypes()
  {
    Assembly[] aoAssembly = AppDomain.CurrentDomain.GetAssemblies();

    List<Type> listoExceptionType = new List<Type>();

    Type oExceptionType = typeof(Exception);
    for (int ixAssm = 0; ixAssm < aoAssembly.Length; ixAssm++)
    {
      if (!aoAssembly[ixAssm].GlobalAssemblyCache) continue;
      Type[] aoType = aoAssembly[ixAssm].GetTypes();
      for (int ixType = 0; ixType < aoType.Length; ixType++)
      {
        if (aoType[ixType].IsSubclassOf(oExceptionType))
          listoExceptionType.Add(aoType[ixType]);
      }
    }

    return listoExceptionType;
  }

  //----------------------------------------------------------------------------
  // GetExceptionMessages
  //----------------------------------------------------------------------------
  private static void GetExceptionMessages(Dictionary<string, string> i_dictExceptionMessage)
  {
    List<Type> listoExceptionType = GetExceptionTypes();
    for (int ixException = 0; ixException < listoExceptionType.Count; ixException++)
    {
      Type oExceptionType = listoExceptionType[ixException];
      string sExceptionName = MakeXMLCompliant(oExceptionType.FullName);
      try
      {
        if (i_dictExceptionMessage.ContainsKey(sExceptionName))
          continue;
        Exception e = (Exception)(Activator.CreateInstance(oExceptionType));
        i_dictExceptionMessage.Add(sExceptionName, e.Message);
      }
      catch (Exception)
      { i_dictExceptionMessage.Add(sExceptionName, null); }
    }
  }

  //----------------------------------------------------------------------------
  // GetExceptionMessagesWin32
  //----------------------------------------------------------------------------
  private static void GetExceptionMessagesWin32(Dictionary<string, string> i_dictExceptionMessage)
  {
    string sTypeName = MakeXMLCompliant(typeof(Win32Exception).FullName) + "_";
    for (int iError = 0; iError < 0x4000; iError++)  // Win32 errors may range from 0 to 0xFFFF
    {
      Exception e = new Win32Exception(iError);
      if (!e.Message.StartsWith("Unknown error (", StringComparison.OrdinalIgnoreCase))
        i_dictExceptionMessage.Add(sTypeName + iError, e.Message);
    }
  }

  //----------------------------------------------------------------------------
  // CreateMessage
  //----------------------------------------------------------------------------
  private static string CreateMessage(Exception i_oException, CultureInfo i_oCultureInfo)
  {
    CException oEx = new CException(i_oException, i_oCultureInfo);
    Thread oTH = new Thread(new ParameterizedThreadStart(CreateMessageInThread));
    oTH.Start(oEx);
    while (oTH.IsAlive)
    { Thread.Sleep(10); }
    return oEx.m_sMessage;
  }

  //----------------------------------------------------------------------------
  // CreateMessageInThread
  //----------------------------------------------------------------------------
  private static void CreateMessageInThread(Object i_oData)
  {
    if (i_oData == null) return;
    CException oEx = (CException)i_oData;
    if (oEx.m_oException == null) return;

    Thread.CurrentThread.CurrentUICulture = oEx.m_oCultureInfo == null ? CultureInfo.InvariantCulture : oEx.m_oCultureInfo;
    // create new exception in desired culture
    Exception e = null;
    Win32Exception oWin32Exception = (Win32Exception)(oEx.m_oException);
    if (oWin32Exception != null)
      e = new Win32Exception(oWin32Exception.NativeErrorCode);
    else
    {
      try
      {
        e = (Exception)(Activator.CreateInstance(oEx.m_oException.GetType()));
      }
      catch { }
    }
    if (e != null)
      oEx.m_sMessage = e.Message;
  }

  //----------------------------------------------------------------------------
  // MakeXMLCompliant
  // from https://www.w3.org/TR/xml/
  //----------------------------------------------------------------------------
  private static string MakeXMLCompliant(string i_sName)
  {
    if (string.IsNullOrEmpty(i_sName))
      return "_";

    System.Text.StringBuilder oSB = new System.Text.StringBuilder();
    for (int ixChar = 0; ixChar < (i_sName == null ? 0 : i_sName.Length); ixChar++)
    {
      char character = i_sName[ixChar];
      if (IsXmlNodeNameCharacterValid(ixChar, character))
        oSB.Append(character);
    }
    if (oSB.Length <= 0)
      oSB.Append("_");
    return oSB.ToString();
  }

  //----------------------------------------------------------------------------
  private static bool IsXmlNodeNameCharacterValid(int i_ixPos, char i_character)
  {
    if (i_character == ':') return true;
    if (i_character == '_') return true;
    if (i_character >= 'A' && i_character <= 'Z') return true;
    if (i_character >= 'a' && i_character <= 'z') return true;
    if (i_character >= 0x00C0 && i_character <= 0x00D6) return true;
    if (i_character >= 0x00D8 && i_character <= 0x00F6) return true;
    if (i_character >= 0x00F8 && i_character <= 0x02FF) return true;
    if (i_character >= 0x0370 && i_character <= 0x037D) return true;
    if (i_character >= 0x037F && i_character <= 0x1FFF) return true;
    if (i_character >= 0x200C && i_character <= 0x200D) return true;
    if (i_character >= 0x2070 && i_character <= 0x218F) return true;
    if (i_character >= 0x2C00 && i_character <= 0x2FEF) return true;
    if (i_character >= 0x3001 && i_character <= 0xD7FF) return true;
    if (i_character >= 0xF900 && i_character <= 0xFDCF) return true;
    if (i_character >= 0xFDF0 && i_character <= 0xFFFD) return true;
    // if (i_character >= 0x10000 && i_character <= 0xEFFFF) return true;

    if (i_ixPos > 0)
    {
      if (i_character == '-') return true;
      if (i_character == '.') return true;
      if (i_character >= '0' && i_character <= '9') return true;
      if (i_character == 0xB7) return true;
      if (i_character >= 0x0300 && i_character <= 0x036F) return true;
      if (i_character >= 0x203F && i_character <= 0x2040) return true;
    }
    return false;
  }

  private static string msc_sBaseFilename = "exception_messages";
  private static string msc_sXmlGroup_Root = "exception_messages";
  private static string msc_sXmlGroup_Info = "info";
  private static string msc_sXmlGroup_Messages = "messages";
  private static string msc_sXmlData_Culture = "culture";

  private Exception m_oException;
  private CultureInfo m_oCultureInfo;
  private string m_sMessage;

  static Dictionary<CultureInfo, Dictionary<string, string>> ms_dictCultureExceptionMessages = new Dictionary<CultureInfo, Dictionary<string, string>>();
}

internal class Program
{
  public static void Main()
  {
    CException.CreateMessages(null);
    CException.SaveMessagesToXML(@"d:\temp\", "emsg");
    CException.LoadMessagesFromXML(@"d:\temp\", "emsg");
  }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-19T12:09:04.390

这对我有用：

```
 //Exception Class Extensions
    public static class ExceptionExtensions
    {
        public static string EnMessage(this Exception ex)
        {
            CultureInfo oldCI = Thread.CurrentThread.CurrentCulture;
            string englishExceptionMessage = ex.Message;
            Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture("en-US");
            Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US");
            try
            {
                var objectType = Type.GetType(ex.GetType().FullName);
                var instantiatedObject = Activator.CreateInstance(objectType);                
                throw (Exception)instantiatedObject;
            }
            catch (Exception e)
            {
                englishExceptionMessage = e.Message;
            }
            Thread.CurrentThread.CurrentCulture = oldCI;
            Thread.CurrentThread.CurrentUICulture = oldCI;
            return englishExceptionMessage;
        }
    } 
```

然后，您可以通过调用新方法 ex.EnMessage(); 来使用它。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-05-27T18:49:53.177

您应该记录调用堆栈，而不仅仅是错误消息（IIRC，简单的 exception.ToString() 应该为您执行此操作）。从那里，您可以准确地确定异常的来源，并且通常可以推断出它是哪个异常。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2014-03-28T11:57:35.587

使用扩展方法覆盖 catch 块中的异常消息，检查抛出的消息是否来自代码，如下所述。

```
 public static string GetEnglishMessageAndStackTrace(this Exception ex)
    {
        CultureInfo currentCulture = Thread.CurrentThread.CurrentUICulture;
        try
        {

            dynamic exceptionInstanceLocal = System.Activator.CreateInstance(ex.GetType());
            string str;
            Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US");

            if (ex.Message == exceptionInstanceLocal.Message)
            {
                dynamic exceptionInstanceENG = System.Activator.CreateInstance(ex.GetType());

                str = exceptionInstanceENG.ToString() + ex.StackTrace;

            }
            else
            {
                str = ex.ToString();
            }
            Thread.CurrentThread.CurrentUICulture = currentCulture;

            return str;

        }
        catch (Exception)
        {
            Thread.CurrentThread.CurrentUICulture = currentCulture;

            return ex.ToString();
        } 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2017-03-16T10:40:56.950

出于日志记录的目的，某些应用程序可能需要获取英文异常消息（除了在通常客户端的 UICulture 中显示它）。

为此，以下代码

1.  改变当前的 UICulture
2.  使用“GetType()”和“Activator.CreateInstance(t)”重新创建抛出的异常对象
3.  在新的 UICuture 中显示新的异常对象的消息
4.  然后最后将当前的 UICulture 改回更早的 UICulture。

    ```
     try
        {
            int[] a = { 3, 6 };
            Console.WriteLine(a[3]); //Throws index out of bounds exception

            System.IO.StreamReader sr = new System.IO.StreamReader(@"c:\does-not-exist"); // throws file not found exception
            throw new System.IO.IOException();

        }
        catch (Exception ex)
        {

            Console.WriteLine(ex.Message);
            Type t = ex.GetType();

            CultureInfo CurrentUICulture = System.Threading.Thread.CurrentThread.CurrentUICulture;

            System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo("en-US");

            object o = Activator.CreateInstance(t);

            System.Threading.Thread.CurrentThread.CurrentUICulture = CurrentUICulture; // Changing the UICulture back to earlier culture

            Console.WriteLine(((Exception)o).Message.ToString());
            Console.ReadLine();

         } 
    ```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2020-01-09T08:19:42.583

英语异常信息

```
try
{
    ......
}
catch (Exception ex)
{
      throw new UserFriendlyException(L("ExceptionmessagesinEnglish"));
} 
```

然后转到 Localization 文件夹并将其放在 projectName.xml 中并添加

```
<text name="ExceptionmessagesinEnglish">Exception Message in English</text> 
```

# debugging - 如何在不签入的情况下保留自己的调试行？

> ID：209135
> 
> 赞同：6
> 
> 时间：2008-10-16T15:48:01.030
> 
> 标签：debugging, version-control, logging

在处理某些代码时，我添加了某种额外的调试日志记录，以使我更容易跟踪我关心的状态和值以进行此特定修复。

但是，如果我将其签入源代码存储库，我的同事会因为我污染日志输出和代码而对我生气。

那么，我如何在本地保留这些对我很重要的代码行，而不将它们签入？

**澄清：** 许多与日志输出相关的答案，您的日志级别可以将其过滤掉。我同意这一点。

但。我还提到了污染实际代码的问题。如果有人在每隔一行代码之间放置一条日志语句，以始终打印所有变量的值。它确实使代码难以阅读。所以我也很想避免这种情况。基本上完全不签入日志代码。所以问题是：如何保留自己的专用日志行。因此，您可以将它们用于调试构建，而不会弄乱签入的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-17T22:02:49.060

如果您遇到问题的调试代码的唯一目标是跟踪某些变量的值，我认为您真正需要的是**调试器**。使用调试器，您可以随时查看任何变量的状态。

如果你不能使用调试器，那么你可以添加一些代码来打印一些调试输出中的值。但是这段代码应该只有几行，其目的是使您正在做的修复更容易。一旦它被提交到主干，它就被修复了，然后你不应该需要更多的调试行，所以你必须删除它们。不要删除所有的调试代码，好的调试代码很有用，只删除你的“个人”跟踪调试代码。

如果修复太长以至于你想保存提交到存储库的进度，那么你需要一个**分支**，在这个分支中你可以添加你想要的调试代码，但无论如何你应该在合并到主干时删除它.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T15:56:05.150

> 但是，如果我将其签入源代码存储库，我的同事会因为我污染日志输出和代码而对我生气。

我希望您的 Log 框架具有日志级别的概念，以便您可以轻松关闭调试。就我个人而言，我不明白为什么人们会对更多的调试日志感到愤怒——因为他们可以把它关掉！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T15:56:22.997

为什么不将它们包装在预处理器指令中（假设结构存在于您选择的语言中）？

```
#if DEBUG
    logger.debug("stuff I care about");
#endif 
```

此外，您可以使用不应在生产中打开的日志级别，如跟踪或调试。

```
if(logger.isTraceEnabled()) {
    logger.log("My expensive logging operation");
} 
```

这样，如果某天确实出现了该区域的某些问题，您可以重新打开该级别的日志记录，并实际获得一些（希望是）有用的反馈。

* * *

请注意，这两种解决方案仍然允许签入日志记录语句，但我认为没有充分的理由*不*签入它们。我正在提供解决方案以将它们排除在生产日志之外。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T16:32:57.073

如果这真的是一个持续存在的问题，我想我会假设中央存储库是主版本，我最终会使用补丁文件来包含正式版本（我工作的最后一个）和我的带有调试代码的版本。然后，当我需要恢复调试时，我会检查正式版本，应用我的补丁（使用`patch`命令），修复问题，然后在签入之前，删除补丁`patch -R`（对于反向补丁）。

但是，应该没有必要这样做。您应该能够就在官方代码行中保留信息的方法达成一致，并具有控制产生的调试量的机制。无论您的语言是否具有 C 或 C++ 意义上的条件编译，都应该可以使用 C 预处理器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T21:56:36.730

我知道我会为此获得反对票......
但如果我是你，我会构建自己的工具。

是的，这需要你一个周末，但你会保持你的编码风格和你的存储库干净，每个人都会很高兴。

不确定您使用什么源代码控制。使用我的，您可以轻松获得“待签入”的物品清单。您可以通过 API 触发提交。

如果我有同样的需求，我会编写一个程序来提交，而不是使用源代码控制 GUI 中的内置命令。您的程序将遍历待处理的内容列表，获取您添加/更改的所有文件，制作它们的副本，删除所有日志行，提交，然后将它们替换为您的版本。

根据您的日志行的样子，您可能需要在它们的末尾添加一个特殊的注释，以便您的程序能够识别它们。

再说一遍，不应该做太多的工作，以后使用也不会很痛苦。
我不希望您会找到已经为您（以及您的源代码控制）执行此操作的东西，我认为它非常具体。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T15:49:35.770

你用的是什么源代码控制系统？Git 允许你保留本地分支。如果情况变得更糟，您可以在存储库中创建自己的“Andreas”分支，尽管分支管理可能会变得非常痛苦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T16:28:58.873

如同

```
#if DEBUG #endif.... 
```

但这仍然意味着任何使用“调试”配置运行的人都会遇到这些问题。

如果您真的希望跳过它们，请使用其他人不使用的日志级别，或者....

创建一个名为 MYDEBUGCONFIG 的不同运行配置，然后将调试代码放在块之间，如下所示：

```
#if MYDEBUGCONFIG 
...your debugging code
#endif; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-17T21:19:19.007

如果你真的在做类似的事情：

> 在每隔一行代码之间放置一条日志语句，以始终打印所有变量的值。它确实使代码难以阅读。

那就是问题所在。考虑改用测试框架，并在那里编写*调试*代码。

另一方面，如果您只编写几行调试行，那么您可以设法避免手动执行（例如，在提交之前使用编辑器删除相关行并在完成后撤消更改） - 但它当然有非常罕见！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T17:33:00.540

恕我直言，您应该避免使用 #if 解决方案。这是执行条件调试例程的 C/C++ 方式。[而是使用ConditionalAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)属性所有日志记录/调试功能。属性的构造函数接受一个字符串。仅当定义了与属性字符串同名的特定预处理器定义时，才会调用此方法。这与#if/#endif 解决方案具有完全相同的运行时含义，但它在代码中看起来要好得多。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-28T17:03:56.280

下一个建议是疯狂不要这样做，但你可以......

在您的个人日志代码周围加上注释，例如

```
// ##LOG-START##
logger.print("OOh A log statment");
// ##END-LOG## 
```

在你提交代码之前，运行一个 shell 脚本来去除你的日志。

我真的不会推荐这个，因为这是一个垃圾想法，但这永远不会阻止任何人。

或者，您也不能在每个日志行的末尾添加评论并让脚本删除它们......

```
logger.print("My Innane log message"); //##LOG 
```

就个人而言，我认为使用具有调试日志记录级别等的适当日志记录框架就足够了。并在提交代码之前删除任何多余的日志。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-18T17:59:03.227

将其视为一流代码，并使用适当的日志记录 API 和构建选项保留代码以将其编译出来/完全禁用。

# jquery - 如何使用 jQuery 以对角线方式打开弹出菜单？

> ID：209138
> 
> 赞同：0
> 
> 时间：2008-10-16T15:48:27.177
> 
> 标签：jquery

我需要制作一个对角线打开的鼠标悬停菜单（从左上角到右下角）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T13:17:35.953

假设您的菜单的 id 为“mymenu”，请尝试以下代码来显示它：

```
$('#mymenu').animate({width: '80px', height: '200px'}) 
```

以及隐藏它的代码：

```
$('#mymenu').animate({width: '0px', height: '0px', opacity: 'hide'}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T15:58:59.887

使用 Tween 将高度从 0 补间到您想要的任何高度，并将宽度从 0 补间到您想要的任何宽度。

您可以从此处的代码中获取显示弹出菜单的示例，以及在悬停时执行操作的示例。

# unix - Unix：将导出路径设置为“Stick”

> ID：209145
> 
> 赞同：6
> 
> 时间：2008-10-16T15:50:49.327
> 
> 标签：unix, shell, path, terminal, export

在 Unix 中设置导出路径时，例如：

```
export PATH=$PATH: $EC2_HOME/bin 
```

如果我退出终端并重新打开它以继续工作，我必须再次完成所有步骤，每次都设置路径。我想知道如何设置路径并让它“粘住”，这样我的系统就知道下次打开终端时在哪里可以找到所有东西，而不必重新做一遍。谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T15:54:03.110

打开`~/.bashrc.`每次你启动一个新的 shell 时都会加载这个文件（如果你使用的是 Bash，大多数人都是这样）。如果您使用不同的 shell，该文件可能有不同的名称，例如`~/.shrc`.

在文件底部添加您需要的行：

```
export PATH=$PATH:$EC2_HOME/bi 
```

从线程的其他地方汇总的其他信息：

根据您的外壳和您的需要，有多个地方可以放置它。所有这些文件都在您的主目录中：

对于重击：

```
.bashrc (executed when you shart a shell) 
```

或者

```
.bash_profile (executed when you log in) 
```

对于 csh 和 tcsh：

```
.cshrc 
```

对于 sh 和 ksh：

```
.profile 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T15:54:53.263

将其添加到您的 .cshrc 文件（用于 csh 和 tcsh）、.profile 文件（用于 sh 和 ksh）或 .bash_profile 文件（用于 bash）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T15:53:54.967

您需要找到您的配置文件并将该行放在那里。假设您使用 bash，配置文件是 .bashrc 和 .bash_profile，在 ~ 中找到。这些文件将根据您使用的外壳而有所不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T15:53:56.697

您必须将这些命令放入 shell 的“自动启动”文件之一。

对于 bash，这将`.bashrc`在您的主目录中（如有必要，请创建它）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T15:53:48.710

将它添加到您的 .bashrc 或另一个 .bash 启动文件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T16:17:42.437

...对于 ksh 编辑**.profile**。

# c++ - MFC：到底什么是 CSplitterWnd Caret？

> ID：209148
> 
> 赞同：1
> 
> 时间：2008-10-16T15:51:35.063
> 
> 标签：c++, mfc, caret, cwnd

在 CSplitterWnd 类的上下文中，插入符号到底是什么？我找不到任何与 CSplitterWnds 明确相关的文档...

编辑：具体来说，这些功能*实际上*做了什么：

```
CWnd * pCurView = m_wndSplitter2.GetPane(2, 0);
pCurView->ShowCaret()
pCurView->HideCaret() 
```

EDIT2：请注意，我知道插入符号是什么，我专门询问 CSlitterWnd 类上下文中的功能。我看过 MSDN 文档，但没有提供真正的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T15:53:28.447

这是正常意义上的插入符号。仅当您在同一窗口中拆分两个 CEditView 时才适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:02:33.920

在 Windows SDK 世界中，光标实际上是鼠标指针，插入符号是您在文本控件等中看到的闪烁条......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T16:28:13.353

具体来说;

```
CWnd * pCurView = m_wndSplitter2.GetPane(2, 0); 
```

获取一个窗格，就像在 CView 派生类中一样，被拆分器窗口包围

```
pCurView->ShowCaret() 
```

在该视图的文本编辑位置显示较小的垂直条。这是在任何文本编辑控件（例如 CEdit）中使用的光标

```
pCurView->HideCaret() 
```

隐藏插入符号/垂直光标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:36:18.033

这是文本光标。

在早期版本的 Windows 中，文本光标就像校对者的插入符号（就像 ^ 仅在基线上）。这是有道理的，因为该标记是校对人员用来指示应在何处插入文本的标记。

将其称为插入符号似乎仍然很奇怪，但他们这样做了，可能是因为他们已经决定使用“光标”这个词来表示其他人所说的鼠标指针。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T18:01:46.957

任何 CWnd 都可以有一个插入符号，但只有 CreateCaret 首先实际显示一个插入符号的 CWnd 继承者。@DannySmurf 为您提供了一个示例 - CEditView - 一个创建可以显示和隐藏的插入符号的 CView。

根据您在窗格中获得的特定类型的 CView，ShowCaret 可能无关紧要。它与 CSplitterWnd 无关。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T15:56:02.497

也许他们指的是光标，屏幕上闪烁的垂直条。

# c# - 可空类型作为泛型参数可能吗？

> ID：209160
> 
> 赞同：332
> 
> 时间：2008-10-16T15:53:42.847
> 
> 标签：c#, generics

我想做这样的事情：

```
myYear = record.GetValueOrNull<int?>("myYear"), 
```

请注意可空类型作为泛型参数。

由于该`GetValueOrNull`函数可以返回 null 我的第一次尝试是这样的：

```
public static T GetValueOrNull<T>(this DbDataRecord reader, string columnName)
  where T : class
{
    object columnValue = reader[columnName];

    if (!(columnValue is DBNull))
    {
        return (T)columnValue;
    }
    return null;
} 
```

但我现在得到的错误是：

> 类型'int？必须是引用类型才能将其用作泛型类型或方法中的参数“T”

对！`Nullable<int>`是一个`struct`！所以我尝试将类约束更改为`struct`约束（并且作为副作用不能再返回`null`）：

```
public static T GetValueOrNull<T>(this DbDataRecord reader, string columnName)
  where T : struct 
```

现在的任务：

```
myYear = record.GetValueOrNull<int?>("myYear"); 
```

给出以下错误：

> 类型'int？必须是不可为空的值类型才能将其用作泛型类型或方法中的参数“T”

是否尽可能将可空类型指定为泛型参数？

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2008-10-16T16:04:01.670

将返回类型更改为`Nullable<T>`，并使用不可为空的参数调用方法

```
static void Main(string[] args)
{
    int? i = GetValueOrNull<int>(null, string.Empty);
}

public static Nullable<T> GetValueOrNull<T>(DbDataRecord reader, string columnName) where T : struct
{
    object columnValue = reader[columnName];

    if (!(columnValue is DBNull))
        return (T)columnValue;

    return null;
} 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2011-04-01T18:23:02.527

```
public static T GetValueOrDefault<T>(this IDataRecord rdr, int index)
{
    object val = rdr[index];

    if (!(val is DBNull))
        return (T)val;

    return default(T);
} 
```

像这样使用它：

```
decimal? Quantity = rdr.GetValueOrDefault<decimal?>(1);
string Unit = rdr.GetValueOrDefault<string>(2); 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2008-10-16T23:48:18.613

只需对您的原始代码做两件事 - 删除`where`约束，并将最后一个`return`从更改`return null`为`return default(T)`. 这样你就可以返回你想要的任何类型。

顺便说一句，您可以通过将语句`is`更改为 来避免使用。`if``if (columnValue != DBNull.Value)`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-02-19T15:31:56.140

**免责声明：**此答案有效，但仅用于教育目的。:) [James Jones 的解决方案](https://stackoverflow.com/a/5517264/70345)可能是这里最好的解决方案，当然也是我会选择的解决方案。

C# 4.0 的`dynamic`关键字使这更容易，如果不太安全的话：

```
public static dynamic GetNullableValue(this IDataRecord record, string columnName)
{
  var val = reader[columnName];

  return (val == DBNull.Value ? null : val);
} 
```

现在您不需要 RHS 上的显式类型提示：

```
int? value = myDataReader.GetNullableValue("MyColumnName"); 
```

事实上，你在任何地方都不需要它！

```
var value = myDataReader.GetNullableValue("MyColumnName"); 
```

`value`现在将是一个 int，或一个字符串，或从 DB 返回的任何类型。

唯一的问题是，这不会阻止您在 LHS 上使用不可为空的类型，在这种情况下，您会得到一个相当讨厌的运行时异常，例如：

```
Microsoft.CSharp.RuntimeBinder.RuntimeBinderException: Cannot convert null to 'int' because it is a non-nullable value type 
```

与所有使用`dynamic`:caveat coder 的代码一样。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-09-27T19:51:00.367

我认为您想处理引用类型和结构类型。我使用它来将 XML Element 字符串转换为更多类型的类型。您可以使用反射删除 nullAlternative。formatprovider 用于处理依赖于文化的 '.' 或 ',' 分隔符，例如小数或整数和双精度数。这可能有效：

```
public T GetValueOrNull<T>(string strElementNameToSearchFor, IFormatProvider provider = null ) 
    {
        IFormatProvider theProvider = provider == null ? Provider : provider;
        XElement elm = GetUniqueXElement(strElementNameToSearchFor);

        if (elm == null)
        {
            object o =  Activator.CreateInstance(typeof(T));
            return (T)o; 
        }
        else
        {
            try
            {
                Type type = typeof(T);
                if (type.IsGenericType &&
                type.GetGenericTypeDefinition() == typeof(Nullable<>).GetGenericTypeDefinition())
                {
                    type = Nullable.GetUnderlyingType(type);
                }
                return (T)Convert.ChangeType(elm.Value, type, theProvider); 
            }
            catch (Exception)
            {
                object o = Activator.CreateInstance(typeof(T));
                return (T)o; 
            }
        }
    } 
```

你可以像这样使用它：

```
iRes = helper.GetValueOrNull<int?>("top_overrun_length");
Assert.AreEqual(100, iRes);

decimal? dRes = helper.GetValueOrNull<decimal?>("top_overrun_bend_degrees");
Assert.AreEqual(new Decimal(10.1), dRes);

String strRes = helper.GetValueOrNull<String>("top_overrun_bend_degrees");
Assert.AreEqual("10.1", strRes); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-07-29T23:44:49.147

只需要做一些与此类似的令人难以置信的事情。我的代码：

```
public T IsNull<T>(this object value, T nullAlterative)
{
    if(value != DBNull.Value)
    {
        Type type = typeof(T);
        if (type.IsGenericType && 
            type.GetGenericTypeDefinition() == typeof(Nullable<>).GetGenericTypeDefinition())
        {
            type = Nullable.GetUnderlyingType(type);
        }

        return (T)(type.IsEnum ? Enum.ToObject(type, Convert.ToInt32(value)) :
            Convert.ChangeType(value, type));
    }
    else 
        return nullAlternative;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-04-29T07:56:06.863

多个通用约束不能以 OR 方式（限制较少）组合，只能以 AND 方式（限制较多）组合。这意味着一种方法不能同时处理这两种情况。通用约束也不能用于为方法制作唯一签名，因此您必须使用 2 个单独的方法名称。

但是，您可以使用通用约束来确保正确使用这些方法。

就我而言，我特别希望返回 null，而不是任何可能值类型的默认值。GetValueOrDefault = 不好。GetValueOrNull = 好。

我使用“Null”和“Nullable”这两个词来区分引用类型和值类型。这是我编写的几个扩展方法的示例，它们补充了 System.Linq.Enumerable 类中的 FirstOrDefault 方法。

```
 public static TSource FirstOrNull<TSource>(this IEnumerable<TSource> source)
        where TSource: class
    {
        if (source == null) return null;
        var result = source.FirstOrDefault();   // Default for a class is null
        return result;
    }

    public static TSource? FirstOrNullable<TSource>(this IEnumerable<TSource?> source)
        where TSource : struct
    {
        if (source == null) return null;
        var result = source.FirstOrDefault();   // Default for a nullable is null
        return result;
    } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2021-01-07T11:55:56.490

万一它可以帮助某人-我以前使用过它，并且似乎可以满足我的需要...

```
public static bool HasValueAndIsNotDefault<T>(this T? v)
    where T : struct
{
    return v.HasValue && !v.Value.Equals(default(T));
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-11-05T20:04:08.070

这可能是一个死线程，但我倾向于使用以下内容：

```
public static T? GetValueOrNull<T>(this DbDataRecord reader, string columnName)
where T : struct 
{
    return reader[columnName] as T?;
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-06-01T22:28:45.057

较短的方式：

```
public static T ValueOrDefault<T>(this DataRow reader, string columnName) => 
        reader.IsNull(columnName) ? default : (T) reader[columnName]; 
```

返回,和`0`_`int``null``int?`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-08-28T17:19:39.337

我知道这很旧，但这是另一种解决方案：

```
public static bool GetValueOrDefault<T>(this SqlDataReader Reader, string ColumnName, out T Result)
{
    try
    {
        object ColumnValue = Reader[ColumnName];

        Result = (ColumnValue!=null && ColumnValue != DBNull.Value) ? (T)ColumnValue : default(T);

        return ColumnValue!=null && ColumnValue != DBNull.Value;
    }
    catch
    {
        // Possibly an invalid cast?
        return false;
    }
} 
```

现在，您不在乎`T`是值类型还是引用类型。只有当函数返回 true 时，您才能从数据库中获得合理的值。用法：

```
...
decimal Quantity;
if (rdr.GetValueOrDefault<decimal>("YourColumnName", out Quantity))
{
    // Do something with Quantity
} 
```

这种方法非常类似于`int.TryParse("123", out MyInt);`

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-01-10T23:13:46.707

我自己也遇到了同样的问题。

`... = reader["myYear"] as int?;`工作并且很干净。

它适用于任何类型而没有问题。如果结果为 DBNull，则在转换失败时返回 null。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-03-04T21:21:42.943

这是我多年来使用的一种扩展方法：

```
public static T GetValue<T>(this DbDataReader reader, string columnName)
{
    if (reader == null) throw new ArgumentNullException(nameof(reader));
    if (string.IsNullOrWhiteSpace(columnName))
        throw new ArgumentException("Value cannot be null or whitespace.", nameof(columnName));

    // do not swallow exceptions here - let them bubble up to the calling API to be handled and/or logged
    var index = reader.GetOrdinal(columnName);
    if (!reader.IsDBNull(index))
    {
        return (T)reader.GetValue(index);
    }
    return default;
} 
```

# iphone - 开发一个 iPhone 应用程序需要多少钱？

> ID：209170
> 
> 赞同：270
> 
> 时间：2008-10-16T15:54:45.073
> 
> 标签：iphone, objective-c, jobs

[开发人员可以为Twitterrific](http://en.wikipedia.org/wiki/Twitterrific)等 iPhone 应用程序收取多少费用？

我想知道这一点，因为我需要一个具有相同功能的新社区网站的应用程序。我可以做 Ruby，但没有使用 Objective-C 的经验。因此，如果我应该开始阅读有关 iPhone 编程的书籍或将工作外包给 iPhone 程序员，这对我来说会很有趣。

* * *

## 回答 #1

> 赞同：1007
> 
> 时间：2010-10-13T17:53:48.000

我是 Twitterrific 的开发人员之一，老实说，我无法告诉您该产品投入了多少小时。我可以告诉你，所有支持 160 小时开发和 40 小时设计的人都觉得太高了。（我会使用另一个短语，但这是我在 Stack Overflow 上的第一篇文章，所以我很好。）

Twitterrific 从 iOS 1.0（越狱）开始有 4 个主要版本。这是很多代码，其中大部分都在比特桶中（我们在每个主要版本中都进行了很多重构。）

有趣的一件事是我们必须在 iPad 版本上工作的时间量。Apple 设定了一个产品发布日期，给了我们 60 天的时间来进行开发。（后来又延长了一周。）

我们从头开始开发 iPad，但我们的很多底层代码（主要是模型）都被重用了。该开发由两位经验丰富的 iOS 开发人员完成。其中一个甚至写了一本书：[http](http://appdevmanual.com) ://appdevmanual.com :-)

在如此短的时间安排下，我们工作了相当长的时间。让我们保守一点，每周工作 6 天，每天工作 10 小时。9 周的 60 小时给了我们 540 小时。有两个开发人员，这非常接近 1,100 小时。我们为客户提供的费率为每小时 150 美元，仅用于新代码即可获得 165,000 美元。还请记住，我们正在重用一堆现有代码：我将把代码的价值降低到 35,000 美元，总开发成本为 200,000 美元。

任何认真进行过 iPhone 开发的人都可以告诉您，任何项目都涉及大量设计工作。我们有两名设计师在产品的这方面工作。他们竭尽全力处理全新的交互机制。不要忘记他们也没有任何硬件可以接触（大量打印输出！）他们每周至少花费 25 个小时在该项目上。所以 225 小时每小时 150 美元大约是 34,000 美元。

还有许多开发人员忽略考虑的其他成本：项目管理、测试、设备。同样，如果我们把这个数字低到 16,000 美元，我们就是 250,000 美元。这个数字符合 Jonathan Wight (@schwa) 对 22 天奥巴马应用程序的 50-150K 美元估计。

再打一次，伙计。

现在，如果您想为您的应用程序构建后端服务，那么这个数字将会上升得更多。每个人似乎都对 Instagram 花费 50 万美元的风险投资来构建新的前端和后端感到惊讶。我不是。

* * *

## 回答 #2

> 赞同：323
> 
> 时间：2008-10-16T22:03:36.890

[Barack Obama 应用程序](http://news.cnet.com/8301-13578_3-10056519-38.html)从第一个代码开发到发布需要 22 天。三位开发人员（尽管并非所有人都是全职的）。一共10人。图500-1000工时。承包费率为 100-150 美元/小时。图 50000-150000 美元。将您的应用程序与 Obama.app 进行比较并相应地进行扩展。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2010-10-13T19:31:48.630

有很多方法可以花更少的钱来获得一个应用程序，开发比支付现行费率，但通常你得到你所支付的 - 没有经验的开发人员会给你留下一堆无法维护的意大利面条代码，或者有经验的开发人员与你一起必须跨越文化和语言鸿沟进行交流。

开发像 Twitterific 这样的应用程序并不容易。这是一款非常精致的应用程序，非常注重细节，大多数人——实际上是许多开发人员——都没有注意到或意识到背后的努力。你可能能够通过离岸或愿意“与没有经验的开发人员合作”以 3500 美元或 5000 美元的价格获得一个 Twitter iPhone 客户端，但你不会为此获得 Twitterific，而且你会得到平衡值得怀疑该金额的一半体面的申请。

你最终可能会花费大量时间来管理流程，来回考虑需求，并努力获得你真正想要的东西，而不是他们想要给你的东西。

“降价”开发也存在风险，无论是离岸开发还是仅仅使用没有经验的开发人员——你很可能最终得到一些你不能使用的东西，或者因为它崩溃或行为不正常而获得 1 星评级的东西。您可能会偶尔发现开发商的低价宝石，但鉴于目前这个市场的绝对需求，它们不会长期处于低价状态。

凭借我的书籍和博客，人们经常在他们需要有关 iPhone 应用程序的帮助时与我联系。我平均每个月收到 4 到 5 次咨询，这些人要求帮助修复他们在海外或美国没有经验的开发人员开发的应用程序。在大多数情况下，我最终不得不告诉他们，他们最好还是放弃他们的代码并与知道他们在做什么的开发人员一起重新开始，而不是试图修复他们以便宜的价格购买的代码。如果他们坚持试图“修复”他们拥有的东西，我会拒绝这项工作。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2010-10-13T19:20:48.493

我是一个非常优秀的 iPhone 应用程序开发人员，我的服务每小时收费超过 150 美元。我在构建 iPhone 应用程序及其服务器端组件方面拥有丰富的经验。我还多次被要求修复离岸开发的应用程序。这是我的看法。

*   设计要花钱，好的设计要花很多钱。预计每个应用程序屏幕的设计师工作数周。离岸团队不做设计。
*   如果应用程序要成功，服务器开发和基础设施至关重要。缓慢的服务器响应或过载的服务器会阻碍您的应用程序，并影响销售和满意度。等式的服务器端将花费最多并花费最多的时间来开发。根据我的经验，那些离岸开发服务器的人会发现质量和正常运行时间都很糟糕。
*   如果做得好，应用程序开发也需要时间。专业开发人员将确保遵循所有[HIG](http://en.wikipedia.org/wiki/Human_interface_guidelines)规则，应用程序结构正确且不包含已知错误，运行良好，并通过应用程序商店验证。离岸团队只是削减代码。

我正要为客户发布一个购物应用程序。设计工作由 2 位客户内部设计师在 2 周内完成，速度很快，因为他们已经拥有所有图像资产。想想 2 人 x 10 天 x 8 小时 = 约 24,000 美元。必须修改服务器端才能为 iPhone 应用程序提供数据。我们使用了他们的内部团队和内部平台以及内部 API，2 名开发人员，4 周，或大约 50,000 美元，那是因为他们已经有一个网上商店和 API。他们花了大约 400,000 美元才能到达那里（不包括平台）。我在 3 周内编写了应用程序，因为我的很多代码都是从以前的项目中复制的，另外大约 25,000 美元，这是我做过的最便宜的应用程序。

总花费：〜$ 100,000，这非常便宜！

他们将免费赠送此产品，以便客户从他们的商店通过他们的 iPhone 购买。

对于您的应用程序，Peter，如果您有服务器、API 和设计，我猜根据复杂性需要 30,000 到 60,000 美元。如果您没有设计，请加倍。如果您没有 API，请再次加倍...

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2010-05-04T05:12:56.913

我是一家网络和移动开发公司的客户主管，每天都会听到这个问题。不幸的是，iPhone 应用程序并不便宜。如果您住在美国土地上，您可以期望每小时 100 美元左右。我见过一些离岸的印度开发商，那里的价格低至每小时 20 美元。这完全取决于您希望应用程序执行的功能的数量和复杂性。简单的单一功能应用程序通常在 4-5k 左右。它们之所以如此昂贵，是因为您正在向一群人支付健康的小时工资，并且任何类型的原始原型设计、开发和编码都需要时间。应用程序可以很容易地超过 60-100k。西南航空公司制作了一个带有完整电子商务平台的应用程序，允许您通过手机购买机票就是一个例子。将所有这些移植到他们的 IT 中是一项艰巨的工作。

将项目外包肯定并不总是更好的选择。如果你这样做，你最好知道你在和谁打交道。不要误会我的意思，那里的人为了更好的交易而做坏事，但他们并不那么容易找到。那些家伙可能会在一个简单的项目上花 5 个月的时间在这里花 6 周时间，或者根本不完成它，把它交给一半完成。在我们完成工作的地方，我已经多次看到这种情况。项目管理成为一项挑战。很难准确地传达您希望应用程序执行的操作。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2010-10-15T04:31:50.663

用于 iPad 的 River of News 花了大约 400 小时开发到 1.0 版，我不知道我的设计师花了多少小时（20-50？）。以美国劳动力价格计算，这至少是 40,000 美元。但这种紧密的开发之所以成为可能，是因为它是一个人的操作。当您将编写代码的人与决定产品将要做什么的人分开时，会增加大量的开销。

如果您要将其发送到海外，您最好确切地知道您想要什么。由于语言和时差，很难在探索可能的情况下进行迭代设计。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-17T09:31:15.830

[Appsamuck iPhone 教程](http://www.appsamuck.com/)的目标是 31 天的教程，以 31 个为 iPhone 开发的小应用程序结尾，所有源代码都可供下载。他们还提供商业服务来构建应用程序！

如果您想知道是否可以进行编码，那么至少您可以下载代码并查看是否有任何对您的需求有帮助的东西。另一方面，您还可以从他们那里获得为您开发应用程序的报价，因此您可以尝试硬币的两面，外包和内部。当然这也取决于你有多少时间！这当然值得一看！

（好吧，在我上次尝试发布有用的帮助的灾难性尝试之后，我开始四处寻找！）

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2010-10-13T19:17:37.953

我是 Coupious 移动优惠券 iPhone 应用程序的开发人员，根据我在该应用程序 (v1.0 - v1.5) 上花费的时间，这可能是 15,000 - 20,000 美元的投资。然而，公平地说，我承认我是唯一的开发人员，当我开始这个项目时，我以前从未见过或使用过 Objective-C。尽管如此，三个月后，它还是发布了，所以数字可能有点偏差，因为除了编码之外还有大量的学习。

然而，有能力的 iPhone 开发人员的价格在 80 美元到 150 美元之间，具体取决于他们在平台上的技能和时间。我想说，对于一个简单的应用程序，一个应用程序可能运行 2K-5K，一个中等复杂性的应用程序将运行 5K-15K，一个相当复杂的应用程序运行 15K-30K。游戏应用可能更多。

之所以这么高，是因为技能比较专业，不是每个人都能做到

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2010-10-13T18:46:59.550

我不想承认我为 iPhone 应用程序做的很少，但我可以告诉你我不会再这样做了。那个说“简单，一个功能的应用程序就可以完成……[由独立开发者]……只需 5000 美元”的人是正确的；然而，这仍然是低调的，并且假定几乎没有项目设计、图形设计或网络后端工作。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-07-09T20:35:07.967

上面引用的费率是您希望支付给美国开发商的费用；但是，我确实知道有些人可以通过使用离岸开发人员以低至 4,000 美元的价格构建他们的应用程序。

这是一个小组的博客文章：[http ://www.lolerapps.com/why-outsourcing-iphone-apps-was-a-no-brainer-for-us](http://www.lolerapps.com/why-outsourcing-iphone-apps-was-a-no-brainer-for-us)

此外，Carla White 还写了一本精彩的电子书，讲述了她用于将名为“Inside Secrets to an iPhone App”的应用程序外包的过程。她谈到了她是如何获得大量收益的，因为她愿意与仍在学习 iPhone 应用程序开发的团队合作。

因此，除了上面讨论的价格较高的开发商之外，还有其他选择。

# flash - 通过 apache 5.5 显示视频

> ID：209186
> 
> 赞同：0
> 
> 时间：2008-10-16T15:57:51.400
> 
> 标签：flash, apache, tomcat, video

通过 apache 5.5 服务器显示 .flv 视频文件时出现问题。我在 html 中使用 jsp2.0 和 javascript，flash 视频播放器。每当我尝试通过 apache 5.5 服务器运行包含 10mb .flv 视频文件的 video.jsp 页面时，我的 C 盘已满。它也没有在页面上显示视频，而且我的整个笔记本电脑都变慢了。请尽快回复我，因为我的项目工作已停止。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T22:48:58.263

首先，确保您为 FLV 正确设置了 MIME 类型：

这应该在您的 httpd.conf 中

```
AddType video/x-flv flv 
```

您可能还需要确保未对 FLV 进行 gzip 压缩，如下所示：

```
<Location />

# Insert filter
SetOutputFilter DEFLATE

# Don't compress images
SetEnvIfNoCase Request_URI \\.(?:gif|jpe?g|png|flv)$ no-gzip dont-vary

</Location> 
```

希望有帮助...

麦克风

# embedded - Web 浏览器与硬件设备通信的方式是什么？

> ID：209188
> 
> 赞同：5
> 
> 时间：2008-10-16T15:58:04.240
> 
> 标签：embedded, device

我有一个通过 USB 连接到 PC 的数据采集硬件设备，我想发送一些信息和设置，获取一些数据，然后在客户端检索获取的数据并将其发送到服务器。该计划是使用 Web 门户与连接到客户端 PC 的设备进行通信。我正计划编写一个 DLL 来与设备通信。我在客户端的环境是使用 Internet Explorer 作为浏览器的 Windows。服务器端是 Windows 或 Linux。从 Web 浏览器客户端到客户端设备的最佳通信方式是什么？

*澄清：*第一个目标是允许客户端 PC 将采集设置发送到设备。这些设置可以在客户端手动输入，也可以来自服务器。第二个目标是将获取的数据获取到服务器的数据库中。我不需要在客户端显示获取的数据。

硬件设备有一个 CPU，但内存非常有限。与设备通信的协议未确定，但我可以像 USB 驱动器一样访问设备。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T17:41:31.987

您可以使用 Java 小程序并通过串行端口与设备通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T16:04:04.650

与设备通信的不是网络*浏览器，而是网络**服务器*。换句话说，编写一个小型 Web 应用程序，而不是（或除此之外）从数据库读取数据，而是从设备读取数据，并以 HTML 的形式呈现给用户。

实现相同目的的另一种方法是编写一个从设备轮询并写入数据库的守护程序，然后编写一个前端来呈现存储的数据。如果您想按时间呈现过去讲座的记录，则此方案更好。第一种方法最好将浏览器用作设备的简单界面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T16:30:29.573

编写一个 ActiveX 插件来收集数据，但我不确定它是否会授予您所需的权限。如果您可以在其他浏览器上运行，您也可以尝试编写 Netscape 插件。我不知道除了对插件主机施加的任何限制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-02T01:55:27.167

我们有同样的需求，并且正在评估在侦听 127.0.0.1:8080 的客户端上运行代理的选项。代理可以与设备对话，任何本地浏览器都可以通过 js 向 127.0.0.1:8080 发出请求，然后将结果转发到 Web 门户来与代理对话。不知道它是否会起作用，因为任何安全软件都可能禁止浏览器向 127.0.0.1 发出请求并压缩整个内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-07T17:02:12.670

许多设备可以以击键的形式发送输入。当焦点位于输入字段时，来自设备的数据将用文本填充它。

如果您的数据具有固定长度或可预测的模式，您甚至可以使用 ajax 或类似方法将数据自动提交到服务器。

这种方法已成功用于条形码扫描仪。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T16:25:32.873

您可以采取简单的方法，使用嵌入式 Web 服务器作为服务来收集数据并像从浏览器中访问普通网站一样访问它。它需要客户端启动服务。

您也可以将其用作门户的代理，在这种情况下，您不必处理多个域的安全限制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T16:39:57.900

通常，通过在客户端计算机上安装第三方软件/驱动程序可以解决此问题。GEM 智能卡读卡器采用这种方法。但是，我们需要记住，采用这种方法会使设计偏离瘦客户端模型。更好的方法是在客户端计算机上创建服务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T19:30:20.117

如果您使用 USB 接口来连接您的硬件，我建议您使用[USB CDC EEM](http://www.usb.org/developers/devclass_docs/CDC_EEM10.pdf)类，该类旨在提供以太网其他 USB 模拟并完全用于此目的 - 在嵌入式设备上公开 Web 服务器，[例如](http://barracudaserver.com/)，在各种设计中。
另外，您还需要在 PC 端实现 CDC EEM 类驱动程序才能使其正常工作。

# regex - 用正则表达式匹配时间字符串

> ID：209192
> 
> 赞同：4
> 
> 时间：2008-10-16T15:58:54.270
> 
> 标签：regex, time, pcre

我想将字符串中的时间（10.00）与日期和时间（“21.01.08 10.00”）相匹配。我正在使用以下正则表达式：

```
new RegExp("\\b[0-9]{1,2}\\.[0-9]{1,2}\\b" "g"); 
```

但这与 21.01.08 和 10.00 中的 21.01 匹配。

我使用 PCRE 作为我的常规表达式引擎。

更新：

对不起，我应该更清楚。数据和时间是较大字符串的一部分。我想从那个字符串中提取时间。

例如：

“21.01.08 从 10.00 开始，图书馆将举行派对” “21.08.08 - 10:00 将举行派对” “21.08.08 你被安排参加.................. 10:00 开始"

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T17:03:16.043

您的原始正则表达式不起作用，因为`\b`（单词边界）匹配“。” 在“21.01.08”中。您需要更健壮地对边界进行编码：

```
(?:[^\d:.]|^)(\d\d?[.:]\d\d)(?![.:\d]) 
```

这会以您使用的任何一种表示法捕获时间，但不包括日期。请注意，它不会验证时间。例如，它将匹配“88:99” 验证时间是可能的，但会使模式显着复杂化，并且在大多数情况下可能会过度杀伤力。

使用后视而不是非捕获分组会很好，但 PCRE 不支持可变宽度后视。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:07:49.307

```
^\d{2}\.\d{2}\.\d{2}\s(\d{2}\.\d{2})$ 
```

应该将时间部分放入捕获组中。

我不确定的“新RegExp”（也许是Java？）。在 Perl 中，您可以获得类似...

```
if ("21.01.08 10.00" =~ m/^\d{2}\.\d{2}\.\d{2}\s(\d{2}\.\d{2})$/g) {
  $time_part = $1;
} 
```

在.NET中，以下应该可以工作......

```
 Regex r = new Regex(@"^\d{2}\.\d{2}\.\d{2}\s(\d{2}\.\d{2})$");
  string dateTimeString = "21.01.08 10.00";
  if (r.IsMatch(dateTimeString)) {
    string timePart = r.Match(dateTimeString).Groups[1].Value;
    Console.Write(timePart);
  }
  Console.ReadKey(); 
```

如果您想使用比捕获组中的索引更不模糊的东西，也可以使用[命名捕获。](http://www.regular-expressions.info/named.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T16:05:20.280

尝试使用

```
new RegExp("\\b[0-9]{1,2}\\.[0-9]{1,2}$" "g"); 
```

$ 表示字符串结束

# xml - XML 中的特殊字符

> ID：209193
> 
> 赞同：12
> 
> 时间：2008-10-16T15:58:54.363
> 
> 标签：xml, xslt, special-characters, dtd, entities

我正在使用 xml 和 xsl 创建一个左侧导航系统。一切都很顺利，直到我尝试在我的 xml 文档中使用一个特殊字符。我正在使用`&raquo;`，我得到了错误。

> 原因：对未定义实体“raquo”的引用。
> 错误代码：-1072898046

我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-16T16:19:54.697

You are trying to use an [HTML entity](http://en.wikipedia.org/wiki/SGML_entity) in a non-HTML or non-XHTML document. These entities are declared in the document's [Document Type Definition (DTD)](http://en.wikipedia.org/wiki/Document_Type_Definition).

You should use the numerical Unicode version of the [entity reference](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references). For example, in the case of `&raquo;` you should use `&#187;`

Alternatively, you can [define them in your XML document's DTD](http://www.w3schools.com/dtd/dtd_entities.asp):

```
<!ENTITY entity-name "entity-value">
<!ENTITY raquo "&#187;"> 
```

Otherwise, if your document is UTF-8, I believe you can just use the actual character directly in your XML document.

```
» 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T16:14:49.823

did you specify a doc type for your file ?

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

I think you might get such errors if you forget to specify it.

Also sometimes the entities work if you specify them by number instead of name.

```
&#187; &#171; instead of &raquo; and &laquo; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T19:56:17.007

您不需要在 DTD 中声明实体，甚至不需要*使用*DTD。您可能不需要使用字符的 Unicode 表示。您*当然*不需要使用 CDATA 部分。

您需要做的是使用 DOM 来构建您的 XML，而不是尝试使用字符串操作来构建它。DOM 将为您解决此问题。

在 C# 中，此代码：

```
 XmlDocument d = new XmlDocument();
 d.LoadXml("<foo/>");
 char c = (char)187;
 d.DocumentElement.InnerText = "Here's that character: " + c;
 Debug.WriteLine(d.OuterXml);
 d.DocumentElement.InnerText = "Here it is as an HTML entity: &raquo;";
 Debug.WriteLine(d.OuterXml); 
```

产生这个输出：

```
<foo>Here's that character: »</foo>
<foo>Here it is as an HTML entity: &amp;raquo;</foo> 
```

从第一个示例中可以看出，» 字符在 XML 文本中是完全合法的。但我不认为你试图代表那个角色。

我认为您正在尝试根据您报告的错误消息执行第二个示例中的内容。您正在尝试表示字符串`&raquo;`。在 XML 文本中表示该字符串的正确方法是转义 & 符号；因此： `&amp;raquo;`。

因此，如果您*必须*使用字符串操作来构建 XML，只需确保您对源数据中的任何 & 符号进行转义即可。不赘述这一点，但如果您使用的是 DOM，这将自动为您完成。

另一件事。很有可能在您的原始问题中，现在显示为“我正在使用 »”，您实际*输入*的是“我正在使用 »”。不过，实际的帖子看起来不是那样的。如果您需要在 Markdown 中逐字表示文本，请将其括在反引号中；否则，HTML 实体将在呈现帖子时转换为它们的字符表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:21:34.350

这是一个问题，因为并非所有 HTML 实体都是 XML 实体。您可以按照 Pat 的建议将 HTML 的 DTD 导入文档，或执行以下操作之一：

用数字实体代码替换所有出现的特殊字符：

```
&raquo; becomes &#187; 
```

将所有出现的特殊字符包装在 CDATA 标记中

```
<![CDATA[&raquo;]]> 
```

在文档顶部定义实体

```
<!DOCTYPE ROOT_XML_ELEMENT [ <!ENTITY raquo "&#187;"> ]> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T21:37:50.143

我发现自己经常在谷歌上搜索此类信息，因此决定在我自己的网站上发布一个矩阵，以便快速进行查找：

[http://martinkool.com/characters](http://martinkool.com/characters)

使用 ＆＃...; 确实是形式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T16:02:49.113

您是直接使用 » 符号还是将其定义为 » ? 如果您使用转义符号，您是否忘记了分号？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T17:35:02.453

乔

当我使用 unicode 版本时显示一个正方形。

将实体声明放入 xml 文档会产生“不能在 DTD 之外有 DTD 声明”。错误。我想这是意料之中的。

当我使用 '' 在外部包含 dtd 时，它似乎没有任何效果。

我想知道这是否可能是服务器问题。我正在本地开发它并使用 Baby Web Server。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-17T14:56:09.403

只需将您的 HTML 实体替换为适用于任何 XML 和 HTML`&raquo;`的数字引用。`&#187;`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-05T13:17:44.947

如果您希望输出文档包含命名的 HTML 实体`&raquo;`而不是数字引用，请将以下元素添加到您的样式表（**仅限 XSLT2.0**）：

```
<xsl:output use-character-maps="raquo.ent"/>
<xsl:character-map name="raquo.ent">
    <xsl:output-character character="&#187;" string="&amp;raquo;"/>
</xsl:character-map> 
```

# tfs - 如何在不“获取”项目的情况下在 TFS 中搜索单词？

> ID：209196
> 
> 赞同：11
> 
> 时间：2008-10-16T15:59:02.803
> 
> 标签：tfs

我经常有机会在项目中搜索尚未从 Team Foundation Server (TFS) 检索到且不想检索的函数名称。有没有办法在 TFS 上搜索该函数名称（任何单词）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T08:00:26.140

这回答了你的问题了吗？

[在文件中查找：在 Team Foundation Server 中搜索所有代码](https://stackoverflow.com/questions/41039/find-in-files-search-all-code-in-team-foundation-server)

祝你好运，

马丁。

# c++ - Borland x86 内联汇编器；获取标签的地址？

> ID：209198
> 
> 赞同：8
> 
> 时间：2008-10-16T15:59:40.727
> 
> 标签：c++, assembly, x86, turbo-c++

我正在使用带有一些内联汇编代码的 Borland Turbo C++，所以大概是 Turbo Assembler (TASM) 风格的汇编代码。我希望执行以下操作：

```
void foo::bar( void )
{
    __asm
    {
      mov eax, SomeLabel
      // ...
    }
    // ...
SomeLabel:
    // ...
} 
```

所以 SomeLabel 的地址被放入 EAX 中。这不起作用，编译器抱怨：未定义的符号'SomeLabel'。

在 Microsoft Assembler (MASM) 中，美元符号 ($) 用作当前位置计数器，这对我的目的很有用。但这似乎在 Borlands Assember 中不起作用（表达式语法错误）。

更新：更具体地说，我需要编译器在编译/链接期间而不是在运行时生成它作为常量移动到 eax 中的地址，因此它会像“mov eax，0x00401234”一样编译。

任何人都可以建议如何让这个工作？

更新：为了回答 Pax 的问题（请参阅评论），如果 Windows 加载程序在运行时更改了基地址，则 DLL/EXE PE 映像仍将由 Windows 加载程序重新定位，并且标签地址将在运行时由加载程序使用基于重的地址，因此使用标签地址的编译/链接时间值不是问题。

提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T23:55:39.457

上次我尝试制作一些与 Borland 兼容的汇编代码时遇到了不能前向引用标签的限制。不知道这是否是你在这里遇到的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-28T12:49:01.847

我能找到的关于 Borland 的一切都表明这应该可行。[其他站点（此处](http://www.experts-exchange.com/Programming/Languages/Assembly/Q_21731289.html)和[此处](http://www.tek-tips.com/viewthread.cfm?qid=972872&page=10)）上的类似问题表明 Borland 可以处理标签的前向引用，但坚持标签位于 asm 块之外。但是，由于您的标签已经在 asm 块之外...

我很好奇您的编译器是否允许您在例如 jmp 指令中使用此标签。在玩弄它时（诚然，在完全不同的编译器上），我发现编译器有一种讨厌的倾向，即抱怨操作数类型。

语法完全不同，这是我很长时间以来第一次尝试内联 asm，但我相信我已经掌握了足够的能力，可以在 gcc 下工作。也许，尽管存在差异，但这可能对您有用：

```
#include <stdio.h>
int main()
{
    void *too = &&SomeLabel;
    unsigned int out;
    asm
    (
      "movl %0, %%eax;"
      :"=a"(out)
      :"r"(&&SomeLabel)
    );
SomeLabel:
    printf("Result: %p %x\n", too, out);

    return 0;
} 
```

这会产生：

```
...
        movl    $.L2, %eax
...
.L2: 
```

&& 运算符是一个非标准扩展，我不希望它可以在 gcc 以外的任何地方工作。希望这可能激起了一些新的想法......祝你好运！

编辑：虽然它被列为 Microsoft 特定的，但这是跳转到标签[的](http://msdn.microsoft.com/en-us/library/78cxesy1.aspx)另一个实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T16:34:18.380

3条建议：

1) 在程序集中的 SomeLabel 前面放一个 '_'，使其变为“mov eax, _SomeLabel”。通常编译器在将 C 转换为汇编时会加一个。

或者

2) 将标签放在组装部分。这将阻止编译器添加“_”。

或者

3) 注释掉程序集，编译并查看列表文件 (*.lst) 以查看标签名称变为什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T09:44:01.783

我认为您遇到的问题是`__asm`块内的标签和 C++ 代码中的标签是两个完全不同的东西。我不希望您可以从内联汇编中以这种方式引用 C++ 标签，但我必须说自从我使用 Turbo C++ 以来已经很长时间了。

您是否尝试过该`lea`指令而不是`mov`？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T09:14:11.460

Turbo C++ 环境是否有办法为 TASM 设置选项（我知道一些 Borland IDE 有）？

如果是这样，请查看是否将“最大通过次数 (/m)”选项更改为 2 次或更多帮助（它可能默认为 1 次通过）。

此外，如果您使用可能会造成问题的长标签名称 - 至少有一个 IDE 将默认设置为 12。更改“最大符号长度 (/mv) 选项”。

此信息基于 Borland 的 RAD Studio IDE：

*   [http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/devcommon/tasm32_options_xml.html](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/devcommon/tasm32_options_xml.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T19:22:16.100

还有几件事（在黑暗中拍摄）可以尝试：

*   看看使用以下汇编指令是否有帮助：

    ```
    mov eax, offset SomeLabel 
    ```

*   大多数编译器可以生成它们生成的代码的汇编列表（不确定 Turbo C++ 是否可以，因为 Codegear/Embarcadero 将其定位为免费的非专业编译器）。

    尝试使用具有使用标签（例如作为目标）的 C 代码生成列表，并`goto`在同一函数中使用一些内联程序集 - 但不要尝试从程序集中访问标签。这样您就可以获得没有错误的编译器和程序集列表。就像是：

    ```
    int foo()
    {
        int x = 3;
        printf( "x =%d\n", x);
        goto SomeLabel;
                               //
        __asm {
            mov eax, 0x01
        }
                               //
    SomeLabel:
        printf( "x =%d\n", x);
                               //
        return x;
    } 
    ```

    查看程序集列表，看看生成的程序集是否以您可以在内联程序集中复制的方式装饰标签名称。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T16:37:38.013

据我回忆，您不能在内联汇编中使用外部（C++）标签，尽管您可以在汇编指令本身可以引用的 asm 块中拥有 TASM 样式的标签。我想我会使用一个标志和一个后汇编器 switch 语句来处理分支。例如：

```
int result=0;

__asm__ {
    mov result, 1
}

switch (result){
    case 1:  printf("You wanted case 1 to happen in your assembler\n"); break;
    case 0:  printf("Nothing changed with the result variable.. defaulting to:\n");
    default: printf("Default case!\n"); break;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T17:56:26.810

我不具体了解您的编译器/汇编器，但我经常使用的一个技巧是调用下一个位置，然后将堆栈弹出到您的寄存器中。确保您拨打的电话只会推送返回地址。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-27T15:03:25.100

这是一种可能的方法：

```
// get_address
// gets the address of the instruction following the call
// to this function, for example
//     int addr = get_address (); // effectively returns the address of 'label'
//   label:
int get_address ()
{
    int address;
    asm
    {
        mov eax,[esp+8]
        mov address,eax
    }
    return address;
}
// get_label_address
// a bit like get_address but returns the address of the instruction pointed
// to by the jmp instruction after the call to this function, for example:
//     int addr;
//     asm
//     {
//       call get_label_address // gets the address of 'label'
//       jmp label
//       mov addr,eax
//     }
//     <some code>
//   label:
// note that the function should only be called from within an asm block.
int get_label_address()
{
    int address = 0;
    asm
    {
        mov esi,[esp+12]
        mov al,[esi]
        cmp al,0ebh
        jne not_short
        movsx eax,byte ptr [esi+1]
        lea eax,[eax+esi-1]
        mov address,eax
        add esi,2
        mov [esp+12],esi
        jmp done
    not_short:
        cmp al,0e9h
        jne not_long
        mov eax,dword ptr [esi+1]
        lea eax,[eax+esi+2]
        mov address,eax
        add esi,5
        mov [esp+12],esi
        jmp done
    not_long:
        // handle other jmp forms or generate an error
    done:
    }
    return address;
}
int main(int argc, char* argv[])
{
    int addr1,addr2;
    asm
    {
        call get_label_address
        jmp Label1
        mov addr1,eax
    }

    addr2 = get_address ();
Label1:
    return 0;
} 
```

这有点 hacky，但它适用于我拥有的 Turbo C++ 版本。它几乎可以肯定取决于编译器和优化设置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-28T10:22:05.277

只是猜测，因为我没有使用任何 C/++ 编译器的内联汇编程序......

```
void foo::bar( void )
{
    __asm
    {
      mov eax, SomeLabel
      // ...
    }
    // ...
    __asm
    {
      SomeLabel:
      // ...
    }
    // ...
} 
```

我不知道 TASM 的确切语法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-13T12:42:28.103

这是 Ivan 建议的变体，但试试看：

```
void foo::bar( void )
{
    __asm
    {
      mov eax, offset SomeLabel
      // ...
    }
    // ...
    __asm SomeLabel:
    // ...
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-10T05:14:38.587

一种选择是使用单独的“裸”（无序言）过程 SomeLabel 而不是标签

# c# - var 关键字的意义何在？

> ID：209199
> 
> 赞同：49
> 
> 时间：2008-10-16T15:59:54.517
> 
> 标签：c#, variables, boo

[var](http://msdn.microsoft.com/en-us/library/bb384061.aspx)关键字消除了对显式类型声明的需要，我感兴趣地阅读了关于何时可能合适的SO讨论[。](https://stackoverflow.com/questions/41479/use-of-var-keyword-in-c)

我还阅读了关于（但未使用过）[Boo的内容，它似乎通过](https://github.com/boo-lang/boo)[将声明局部变量设为可选](https://github.com/boo-lang/boo/wiki/Type-Inference)而使事情更进了一步。使用 Boo，类型和声明都可以隐含。

这让我想知道，为什么 C# 语言设计者要费心包含一个 var 关键字？

**更新**：是的， var 支持匿名类型，但匿名类型本身并不需要 var 关键字...

```
var anon = new { Name = "Terry", Age = 34 }; 
```

相对

```
anon = new { Name = "Terry", Age = 34 }; 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-16T16:04:35.973

如果没有 var 关键字，当您实际上打算使用已经存在的变量时，可能会意外地创建一个新变量。例如

```
name = "fred";
   ...
Name = "barney"; // whoops! we meant to reuse name 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-16T16:12:16.660

**更新：**这里有两个相关的问题，实际上：1.为什么我必须声明变量？2\. 让你声明变量的语言中的“var”有什么用？

（1）的答案很多，可以在其他地方找到这个问题的答案。我对（2）的回答如下：

正如其他评论者所说，LINQ 将其用于其匿名类型。但是，LINQ 实际上是一个更普遍问题的实例，其中表达式右侧的类型对于程序员来说要么是未知的，要么是非常冗长的。考虑：

```
SomeGeneric<VeryLongTypename<NestedTypename>> thing = new   
SomeGeneric<VeryLongTypename<NestedTypename>>(); 
```

冗长且容易出错，对吧？所以现在他们让你这样做：

```
var thing = new SomeGeneric<VeryLongTypename<NestedTypename>>(); 
```

通过减少信息重复，可以消除错误。请注意，这里不仅仅是输入错误：左侧表达式的类型可能会被错误输入，编译器可以默默地从左向右转换，但转换实际上丢失了一些属性右值。当右值返回的类型可能是未知的或匿名的时，这一点更为重要。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-04-29T22:27:09.173

我理解对 var 的需求，它非常有用。没有关键字并且只是在没有类型的情况下动态定义变量是可怕的。如果您需要返工一年多未接触过的代码，您会伤害下一个必须维护您的代码的人或您自己。我不确定那是一扇应该在 C# 中打开的门，我希望它不是因为 var 在不必要时过度使用时已经导致可读性问题。

我最近看到的几乎每个 .net 3.5 示例都包含用 var 定义的所有变量。

我提出的论点是，它确实牺牲了可读性，以便在过度使用时节省击键。例如：

```
// What myVar is, is obvious
SomeObject myVar = new SomeObject();

// What myVar is, is obvious here as well
var myVar = new SomeObject(); 
```

我看到的问题是人们到处都在使用它……例如：

```
// WTF is var without really knowing what GetData() returns?
// Now the var shortcut is making me look somewhere else when this should
// just be readable!
var myVar = GetData();

// If the developer would have just done it explicitly it would actually
// be easily readable.
SomeObject myVar = GetData(); 
```

所以下一个争论将是，只是更好地命名函数......

```
var weight = GetExactWeightOfTheBrownYakInKilograms(); 
```

还是不知道回来的是什么。它是 int、decimal、float、weight 对象，什么？我仍然不得不浪费时间查找它......需要智能拐杖来拯救我懒惰的编程。也许在函数名中包含返回类型。好主意，现在使用 var 除了让我的所有函数都具有真正的长名称之外，什么也没给我们节省。

我认为人们只是过度使用 var 并且它会导致懒惰的编程，这反过来会导致更难阅读代码。每次输入关键字 var 时，都应该有充分的理由使用它而不是显式地使用它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-16T16:06:34.660

这有点主观，但我认为将 C# 3.0 设计为具有隐式类型变量的“var”关键字而不是无关键字会使代码更具可读性。例如，下面的第一个代码块比第二个代码块更具可读性：

变量声明的位置很明显：

```
var myVariable = SomeCodeToSetVariableHere;
myVariable = SomeOtherCodeTOSetVariable; 
```

声明变量的位置不明显：

```
myVariable = SomeCodeToSetVariableHere;
myVariable = SomeOtherCodeTOSetVariable; 
```

这些都是过于简单化的例子。我想你可以看到这是怎么回事。在复杂的情况下，能够找到实际定义变量的位置可能会很好。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-16T16:54:36.390

在您的问题中，`var`通过告诉编译器该词`anon`现在可以在任何您希望看到赋值中隐含的类型的项目的任何地方使用来增加代码的价值。像这样要求向编译器引入名称允许编译器拒绝它没有被明确告知允许的东西，从而在编译时捕获某些类型的错误，这样它们就不会在运行时崩溃。

例如，在您问题的更新部分，您询问了以下代码段：

```
anon = new { Name = "Terry", Age = 34 }; 
```

以这种方式允许它的问题在于，它会将名称先前不存在的任何赋值左侧的任何内容转换为变量声明，即使它确实是一个错字。如果稍后在程序中为 anon 分配其他内容，然后进一步引用新值，但中间语句有错字，那么您将遇到一个直到运行时才会出现的问题。

您的回答是 Boo 做到了，所以它一定没问题或至少是可能的。但这是一个红鲱鱼。我们谈论的是 C#，而不是 Boo。C# 的目的之一是拥有一种编译器可以捕获尽可能多的错误的语言。Boo 也想这样做，但它也希望更像 Python。所以它牺牲*了一些*（不是全部）C#的编译时安全性来换取类似python的语法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-16T16:26:02.890

免责声明：我的示例是 Java，因为这是我所知道的，但概念应该是相同的。

我投票赞成我认为很关键的答案（很容易意外地创建一个新变量）。

```
bill=5;
bi11=bill+5 
```

票据的价值是多少？

也就是说，我有时觉得打字有点烦人：

```
DataOutputStream ds=new DataOutputStream(); 
```

看起来是多余的，但老实说，这并没有什么问题。无需再键入两次，而且非常有帮助。当您有疑问时需要时间——当您不确定如何使用某些 API 时。如果两次键入该类型声明真的让您感到困扰，那么您为什么要在这里浪费时间呢？自从您开始阅读本文以来，您可以输入 30 或 40 个声明，足以满足您接下来两周需要的每个声明。

我想我的意思是，虽然我理解重复自己可能导致的情绪压力，但一致性、清晰性和制作更智能工具的能力使其非常值得。

还有一件事，大多数时候代码不应该像我上面的例子。你应该做的是：

```
DataOutput ds=new DataOutputStream(); 
```

这立即隐藏了您在模板中使用具体类的事实。该模板应该能够在您的班级上执行您需要的所有操作。稍后，如果您想用其他类型的输出流替换 ds，只需更改该单行即可解决它。如果您通过转换为 DataOutputStream 来使用 DataOutput 不可用的功能，编辑器将很容易找出并通知您。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T16:01:07.293

我相信 var （和其他几个新关键字）是专门添加来支持 Linq 的。

var 是用于创建匿名类型的关键字 - 请参阅[http://msdn.microsoft.com/en-us/library/bb397696.aspx](http://msdn.microsoft.com/en-us/library/bb397696.aspx)

匿名类型可以用在 Linq 以外的其他地方。

var 对 Linq 非常有用。事实上，根据一位专家作者的说法，“[如果没有 'var'，LINQ 使用起来会很痛苦。](http://srtsolutions.com/blogs/billwagner/archive/2005/09/23/on-var-and-c.aspx) ”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-19T13:38:53.947

有时类型很大。想象一下在字典中有泛型类型的字典的类型。var 将使这更具可读性。它也是一种编码实践。

此外，如果您想创建匿名类型，例如 var randomData = { Id = 1, name = "Amit" }

我个人使用类型，因为有时您需要知道函数返回什么（以防万一，您想将结果传递给其他函数。）。比将光标悬停在 var 上更容易查看类型。例如： var result = GetSomethign();

此外，有时您需要导航到按 F12 的类型。这对于 var 是不可能的。当您处于调试模式时，这有点烦人，因为您在调试时看不到类型。您需要停止调试，查看类型并重新开始调试。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-16T16:01:37.463

对于匿名类型，其中包括支持 LINQ。

[http://www.blackwasp.co.uk/CSharpAnonTypes.aspx](http://www.blackwasp.co.uk/CSharpAnonTypes.aspx)

# javascript - 如何让 Dojo 更轻量级？

> ID：209201
> 
> 赞同：1
> 
> 时间：2008-10-16T16:00:17.590
> 
> 标签：javascript, dojo

我一直在看 Dojo，它有一些不错的技巧，但是恕我直言，它非常庞大。基本上在查看我的测试我的慢速机器（600mhz）时，仅加载 Dojo 有点痛苦，可以想象很多移动设备也不会对此感到满意。

有没有超薄版本或类似的版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-24T05:12:08.393

Dojo 并不庞大——它在基础为 26k gzip 压缩时加载多少就多少。显然对于任何实际部署：

*   使用 AOL 或 Google CDN。有关说明，请参阅[Dojo 下载页面](http://dojotoolkit.org/downloads)。
*   构建您自己的简化版 Dojo。有关详细信息，请参阅[包系统和自定义构建](http://dojotoolkit.org/book/dojo-book-0-9/part-4-meta-dojo/package-system-and-custom-builds)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:07:23.423

“加载 Dojo”是什么意思？
如果您的意思是打开一个具有干净缓存的页面，并且该站点需要很长时间才能加载，那么可能是因为您使用的是库的非缩小版本。

如果您的意思是加载一些 Dijit 或[功能齐全的页面](http://archive.dojotoolkit.org/nightly/dojotoolkit/dijit/themes/themeTester.html?theme=soria)，那么这可能是您的浏览器速度与 JS、您的计算机速度和 Dojo 速度的组合。

[尝试从另一个框架（如Ext JS](http://www.extjs.com)或[jQuery](http://ui.jquery.com) ）加载类似的东西，看看它们是否有任何不同。

# php - 关于拆分应用程序的建议

> ID：209206
> 
> 赞同：0
> 
> 时间：2008-10-16T16:01:08.820
> 
> 标签：php, svn

我目前有一个网络应用程序，它有 3 个前端（取决于您访问的 URL），在 3 个前端之间共享很少的代码。我的目录结构如下所示：

```
\app1
    \includes
    \html
\app2
    \includes
    \html
\app3
    \includes
    \html
\crons
\libs
\logs
\setup
    \db
\shared
    \globalFunctions
    \oldAPI
    \oldClasses 
```

App 文件夹是单独的前端，在“html”中具有自己的包含性包含和 docroot。Crons 仅用于 CLI 作业，libs 是较新的 PHP5 库，例如我们编写的新代码和 Zend Framework 之类的东西。日志是应用程序日志，设置是部署的设置信息，共享的是一些代码仍然依赖的旧 PHP4 代码库。一切都存储在一个大型 SVN 存储库中。

什么是一种明智的方法来分解它，以便我可以将这个大型 SVN 项目变成更小的项目，以便更容易分支和合并？无论如何，大多数项目都专注于单个应用程序，因此很少需要在多个地方更新代码。

还是保持这个当前的结构更好，然后我们将 PHP4 代码移植到 OO PHP5 并自然地放弃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T18:40:17.470

## 现实检查

你需要问问自己，分割这个应用程序会得到什么价值，我会付出什么代价。然后，如果您仍然想这样做，请考虑如何将大型应用程序分解为较小的应用程序是一项功能，以及添加不需要的功能如何比不添加所需的功能更糟糕。这属于[精益](http://en.wikipedia.org/wiki/Lean_software_development)软件开发。

## 将您的应用程序划分为多个应用程序

这就是我要做的。我会把你的共享代码变成一个库。该库将被记录并视为它自己的项目。我还将为每个应用程序创建单独的部署脚本，并创建一个主部署脚本来一次部署所有这些。

```
\app1
    \docs
    \includes
    \html
    \logs
    \setup
        \deploy
        \db
\app2
    \docs
    \includes
    \html
    \logs
    \setup
        \deploy
        \db
\app3
    \docs
    \includes
    \html
    \logs
    \setup
        \deploy
        \db
\crons
\deploy
    \docs
    \apps123
\libs
    \newSharedLibName
        \docs
        \globalFunctions
        \oldAPI
        \oldClasses
    \zend
    \etc ... 
```

我不理会cron，因为我不确定你用它做什么。

ps 将应用程序拆分成更小的部分总是比您想象的要难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T18:45:32.297

您可以将其拆分为四个 SVN 项目 - 三个应用程序各一个，其余代码的第四个。然后，您可以将此共享代码定义为每个单独应用程序的外部代码，以便它们可以作为独立的结帐运行。

这确实为您提供了单独的项目，但也带来了一系列问题 - 主要是如果您更新一个应用程序的共享部分，您必须对另外两个应用程序进行回归测试以检查您没有破坏任何依赖关系。

这可能更麻烦，但它取决于你的工作方式。

# performance - .htaccess 重定向性能

> ID：209209
> 
> 赞同：10
> 
> 时间：2008-10-16T16:01:46.917
> 
> 标签：performance, apache, .htaccess, redirect

htaccess 重定向是否比配置文件中的重定向更慢/对 Apache 造成更大的压力？此外，htaccess 中的重定向数量在开始降低性能之前可以达到多少？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T16:07:59.853

是的，它会减慢服务器的速度，因为每次访问该目录或其任何子目录中的资源时，它都必须访问该文件。

重定向的数量无关紧要，因为主要的性能损失是文件访问本身。这在合理的限制内（即一个 5 Kb htaccess 文件将花费或多或少相同的时间来解析一个 1 Kb 文件，不同的故事是一个 1Mb htaccess，尽管我从未见过这种怪物，希望我永远不会）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-16T16:12:32.650

虽然 .htaccess 确实在每个请求上都会被解析，因此在技术上比将规则放在主配置文件中要慢，但实际上这并不重要。apache 配置引擎是嵌入在 Web 服务器中的相当优化的 C 代码。除非您只提供根本没有数据库访问的小型静态文件，否​​则 .htaccess 和重定向的额外开销可以忽略不计。

现代处理器是如此之快，以至于你真的不得不做大量的流量来担心这个。如果您正在处理这么多的流量，并且因为它都是静态内容，请继续为自己购买第二台服务器来分担负载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T16:07:10.073

使用 .htaccess 文件比使用配置文件慢 - 每当对它影响的目录发出请求时，都会解析 .htaccess 文件 - 这允许在不重新启动服务器的情况下更改文件。由于配置文件在服务器启动时仅解析一次，因此速度更快。

您可以在 .htaccess 文件中拥有多少不会对性能产生重大影响的指令将取决于规则的复杂性和服务器的具体情况，尽管主要的性能影响将完全来自使用 .htaccess 文件。

# debugging - 最佳 XSLT 编辑器 &| 调试器

> ID：209211
> 
> 赞同：23
> 
> 时间：2008-10-16T16:02:23.437
> 
> 标签：debugging, xslt, editor

除了 Visual Studio，您还发现什么工具最适合创建、编辑、维护和调试您的 XSLT 文件？

我在一个相当大的项目上工作，我们有大量的 XSLT 文件，它们的实现变得相当复杂。

语言似乎很脆弱。更快地导航和识别错误会很好。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-16T16:28:20.670

我在使用[Oxygen](http://www.oxygenxml.com/)进行 XSLT 调试、XPath 构建和一般 XML 内容方面取得了很好的效果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T16:20:15.507

[Liquid XML Studio](http://www.liquid-technologies.com/Download.aspx)非常擅长实时解释 XPATH 查询。

[Cooktop](http://www.xmlcooktop.com/)还允许我运行我的 XPATH 查询并向我显示通过针对给定 XML 运行 XSLT 生成的 XML 和 HTML。

另外，一位同事告诉我，较新版本的[Adob​​e Dreamweaver](http://www.adobe.com/products/dreamweaver/)允许您将 XML 文件与 XSLT 文件相关联并运行转换。

只要有可能，我就使用[Subversion](http://subversion.tigris.org/)进行更改跟踪。

对于导航，我最常使用[VIM](http://www.vim.org/)（或[VIEmu](http://www.viemu.com/)），有时还使用自定义 Visual Studio 扩展来构建当前文档的 xsl:template 和 xsl:variable 节点的索引，以提供到根条目的一键式导航。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T16:27:22.777

在我的商店中，我们使用 Altova Xml spy。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T21:48:05.813

实际上，我自己最近一直在做一些这样的事情，我发现如果你是一个 .NET 开发人员，Visual Studio 实际上已经为 xslt 文件内置了相当不错的支持。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T22:54:16.720

我曾经使用过 Marrowsoft 的一款名为 Xselerator 的工具。您可以在互联网上找到试用版，但它们似乎已经停业，因此您无法再购买。这是一个很棒的工具。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T17:37:47.593

除了这里的 Visual Studio 天生的能力（我认为调试器特别强大），还有一个分析器插件：[http](http://code.msdn.microsoft.com/xsltprofiler) ://code.msdn.microsoft.com/xsltprofiler 。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T03:11:38.000

我也使用 Xselerator。如前所述，有一天它从互联网上消失了。幸运的是我在那之前获得了许可。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-28T20:42:10.300

Visual Studio Code有一个[XSLT 3.0 扩展](https://marketplace.visualstudio.com/items?itemName=deltaxml.xslt-xpath)：

> 为 XSLT 3.0 和 XPath 3.1 提供全面的语言支持

*披露：我管理这个开源项目*

# .net - 在安装程序中捆绑 .NET

> ID：209212
> 
> 赞同：6
> 
> 时间：2008-10-16T16:02:30.283
> 
> 标签：.net, installation

您（或您的客户）是否愿意下载 1mb 的安装程序，可能会被提示下载和安装 .NET，或者是 23mb 的安装程序，甚至不需要知道 .NET 是什么？

克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T16:14:09.467

Can't you detect if the framework is installed when they're downloading and serve up the appropriate installer? This way a user that hasn't isn't penalized, and a user that doesn't have it gets the full install.

As an aside, our app is a small download and dynamically downloads the frameworks it needs, but we don't target a "commercial" audience. Ours is much more of a niche app, so your YMMV.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T16:05:38.280

我建议使用 1mb 安装程序或“引导程序”方法。除非您想走在最前沿，否则大多数 Windows 机器现在都已经安装了 2.0 框架，并且快速下载和安装应用程序通常是大多数用户的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T16:04:36.240

第二个。客户希望所有功能都无需动手。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:05:11.607

通常，我发现将 .NET 框架与我的应用程序捆绑在一起变得越来越不重要。至少对于 2.0，因为它是最常安装的。

我想说的是，对于 3.5，因为它不一定已安装，所以最好将它包含在下载中以方便使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T16:08:42.533

虽然我个人讨厌那些只有 0.5 MB 的下载器，它们稍后会下载实际的可安装内容，因为您无法存档实际下载的安装文件，但我不得不说，在这种情况下，我更喜欢 1MB 的安装程序。.Net 运行时很常见，应该可以在大多数计算机上找到。如果不是，它应该直接来自 Microsoft，而不是试图在您的安装程序中保留最新版本的 .Net 框架。Eclipse 和 Netbeans 等 Java IDE 常见的另一种选择是同时拥有一个不包含 J2SDK 的版本，以及一个包含最新版本的 J2SDK 的版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T16:08:48.400

我在想 Adob​​e Acrobat，它有一个 1/2 Mb 的安装程序下载来引导一个更大的程序。Acrobat 是下载次数最多的软件包之一，他们仍然觉得有必要减少初始下载的大小。微软也在他们的一些较大的软件包上使用这种方法。

但是，这两个示例的问题在于，它们在下载完整应用程序时提供了比标准 Visual Studio 安装包允许下载框架时更好的体验。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T16:05:10.653

我宁愿在我的机器上安装一个并且完全是一个软件。当我们部署给客户时，我们希望能够自己控制依赖项的安装。

编辑：请注意，我说的是一个企业环境，我们在其中集中管理对客户的软件部署。我自己也有这种感觉，但我会将自己归类为高级用户，我可以看到普通乔用户的反驳论点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T16:05:29.343

我个人更愿意知道它正在安装.net。

大多数非技术人员不会在意，并且会对要求他们单击不必要的次数的安装程序感到恼火（思考过程会去“安装.net？Whats .net？你问我是因为我应该安装它吗？ ，或者因为我不应该？让我们在很多人中选择一个随机选项。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T16:13:36.707

Scott Hanselman had a really good [blog post](http://www.hanselman.com/blog/SmallestDotNetOnTheSizeOfTheNETFramework.aspx "blog post") recently where he talked about bundling the .net framework. One thing to also note is that .net 2.0 was included in Windows XP SP2 so an up to date machine should have at least that

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T16:24:20.490

记录框架依赖关系，并为用户提供安装它的可选方法（如果他们在安装过程中还没有）。如果您仍然通过互联网进行交付，这一点尤其重要。如果您在 CD/DVD 上交付，那么一定要在您的代码中包含可再发行组件，以防用户无法通过网络访问它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-16T16:26:33.823

无论哪种方式，如果您使用下载选项，请确保警告用户。没有什么比您在未连接互联网的机器上安装的新程序如此之小而感到高兴，然后发现您还没有完成更令人讨厌的事情......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-06T02:21:53.320

查看[minimumdotnet](http://www.hanselman.com/smallestdotnet/)以及新的客户端配置文件（取决于您的版本）

# .net - 具有 1000 多个表的数据库的 ORM

> ID：209216
> 
> 赞同：3
> 
> 时间：2008-10-16T16:03:11.780
> 
> 标签：.net, database, orm

我正在为.NET 寻找一个可以处理超过 1000 个表和实体的可靠 ORM。你有什么建议？任何评论都将不胜感激，但那些来自实际处理过这一挑战的人的评论以及他们如何处理它的描述将更加感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T16:17:32.877

You can give a try [LLBLGen](http://www.llblgen.com/defaultgeneric.aspx) and [ADO.NET Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx), but for the number of tables, the entity class generation will take a while in any ORM...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:05:34.897

[NHibernate](http://www.hibernate.org/343.html)是一个了不起的选择。一些指针将包括确保您完全理解会话生命周期以及其用于列表和对象引用的延迟加载技术。

# .net - .Net Consuming Web Service：两种不同服务中的相同类型

> ID：209224
> 
> 赞同：6
> 
> 时间：2008-10-16T16:04:33.493
> 
> 标签：.net, web-services

我必须使用 2 个不同的 Web 服务。两者都包含“用户”对象的定义。

当我使用“添加服务引用”引用服务时，我给每个服务一个唯一的命名空间：

```
com.xyz.appname.ui.usbo.UserManagement    
com.xyz.appname.ui.usbo.AgencyManagement 
```

我遇到的问题是生成的每个代理都包含一个新的用户类。一个位于 com.xyz.appname.ui.usbo.UserManagement.user，另一个位于 com.xyz.appname.ui.usbo.AgencyManagement.user。但是，用户对象是相同的，我想这样对待它们。

有没有一种方法可以以某种方式将用户对象作为一个对象引用，而不是将它们视为两个不同的对象？

我正在使用 .Net 3.5 来使用该服务。使用的服务是用 Java 编写的。

谢谢！！

编辑：

[该论坛主题](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/8c55f517-72c0-4add-8f9d-264acd334e83/ "此论坛主题")非常接近答案，但接受的答案最终是共享来自客户端和服务器的类型 - 我不能这样做，因为我们正在跨平台（Java 到 .Net）。真正的问题是，WCF 中的 svcutil 是否有 /sharetypes 类型的参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T11:52:19.323

最终为我工作的是为 svcutil.exe 提供我生成代码所需的所有 WSDL 地址。SVCUTIL 将查看每个服务的所有类型，并自动确定哪些是常见的并且应该重复使用。

您想要共享的类型也应该有一个共享命名空间，并且应该在每个想要共享该类型的 Web 服务上调用该命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T16:16:07.090

WSDL 工具有一个参数。

```
/sharetypes
    Turns on type sharing feature. This feature creates one code file with
    a single type definition for identical types shared between different
    services (namespace, name and wire signature must be identical).
    Reference the services with http:// URLs as command-line parameters
    or create a discomap document for local files. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-28T13:31:29.283

如果您正在使用本地文件，则可以执行以下操作：

```
wsdl.exe /sharetypes file://c:\path\to\file.wsdl file://c:\path\to\otherFile.wsdl /namespace:<your namespace> /output:(any switches etc...) 
```

sharetypes 开关要求您提供服务的 URL，如果您只是将 wsdl 指向文件，则该开关不起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:21:00.293

当使用来自同一提供者的不同端点的 Web 服务时，这是一种常见的情况。

您可以使用“wsdl.exe /sharetypes”命令行工具创建一个共享代理类，该类将查看您提供的所有端点，并推断哪些类可以“共享”。

在您的示例中，只要您的用户对象在两个服务中相同，它就会被拾取并包含在您的新共享代理类中。

将此共享代理类生成步骤添加为项目中的构建事件可能很有意义，因为它始终是最新的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T16:12:31.327

您可以将*用户*类型放在服务和客户端项目都引用的共享公共程序集中。然后在两个服务客户端的配置中，您可以选择在引用的程序集中重用类型的选项。这样，您将使用程序集中的类型，而不是单独生成的类。

# visual-studio - Visual Studio（6.0、2003 和 2008）与 Windows Vista 64 位 (x64) 的兼容性

> ID：209229
> 
> 赞同：5
> 
> 时间：2008-10-16T16:05:12.557
> 
> 标签：visual-studio, vb6, windows-vista, 64-bit

在 Windows Vista 64 位上运行 Visual Studio 6.0（包括 Visual SourceSafe 6.0 客户端）、Visual Studio 2003 和 Visual Studio 2008 是否存在兼容性问题？

我可以使用 Vista Web Server 交互式地调试应用程序吗？我还能制作/编译项目吗？

假设 Visual Studio 6.0 和 2003 将在 WoW64（Windows-on-Windows 64 位）下执行，而 Visual Studio 2008 是本机 x64 是否正确？

我注意到“Windows Vista 和 Windows Server 2008 上的 Visual Basic 6.0 支持声明”（[http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx](http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx)）指出“64 位 Windows 上的 VB6 开发不是并且不会被支持。”

我发现了一些尝试类似努力的其他人的用户网/新闻组讨论

*   [64 位操作系统，适用于 Windows 开发 PC 的应用程序？](http://groups.google.com/group/microsoft.public.dotnet.languages.vb/browse_thread/thread/dd07fdcf9701f81d/33d8b0c93b6501fb?lnk=st&q=64%20bit%20vista%20vb6#33d8b0c93b6501fb)
*   [无法在具有 Vista 64 位操作系统的计算机上安装 VB6.0](http://www.xtremevbtalk.com/showthread.php?t=300287)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T16:12:23.620

I can't answer for 6.0 but I have no problems whatsoever with 2003, 2005 and 2008.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T23:45:40.723

VS 2008 IDE 不是一个 64 位应用程序 - 它是一个 32 位应用程序，并且在 WoW 中运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T14:51:56.637

我在 Windows Vista Ultimate 64bit 上运行 vb6 已经有一段时间了。主要软件在初始配置调整后运行良好，但我遇到了与 ActiveReports 等第三方组件有关的问题。因此，我的一些项目工作正常，而其他项目则根本不工作，具体取决于依赖项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T00:08:42.533

在 Vista 上与旧版本的 Visual Studio 存在许多兼容性问题，但是这些问题可能都不适用于您，因此您必须根据自己的要求自行解决。

检查这些：

*   [http://msdn.microsoft.com/en-us/vs2005/aa948854.aspx](http://msdn.microsoft.com/en-us/vs2005/aa948854.aspx)
*   [http://msdn.microsoft.com/en-us/vs2005/bb188244.aspx](http://msdn.microsoft.com/en-us/vs2005/bb188244.aspx)
*   [http://www.theserverside.net/news/thread.tss?thread_id=42426](http://www.theserverside.net/news/thread.tss?thread_id=42426)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T14:54:30.413

如果您尝试安装所有组件，则不会安装 Visual Studio 6。它收到 DCOM 安装错误，然后失败。

当我只安装了我感兴趣的部分（VC++、VB6、一些数据访问）时，它就安装好了。为简单起见，请确保关闭 UAC。

之后，可以安装 Visual Studio 6 Service Pack 6...我认为无法安装 VS 6 Service Pack 5（由于 MDAC 错误），但我想如果 VS6 SP6 安装正常，则没有必要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T15:13:12.717

我在 vista64 上使用 VS 6。它安装得很好，减去了一个小问题或警告，我不记得了，但很容易修复。

我在 Vista/w2k8 上使用 VC6 时遇到的两个问题是，有时 C CLI 应用程序即使在从 IDE 中停止后仍然存在。我们有时必须手动关闭应用程序命令窗口。

如果您计划通过网络运行 VSS 源安全 6，尤其是通过 WAN，我强烈建议配置 Vista/W2k8 系统 VSS 托管以强制使用 SMB v1 进行文件服务。除了在 WAN 环境中使用带有新 SMB2 协议的 VSS 时，我们遇到的只是持续不断的损坏/签入流，而不是真正被“签入”的问题。切换到 SMB v1 后，一切立即恢复正常。让我想知道 MS 是否在尝试提高新平台上的文件性能时没有走太多弯路。

除了这两个问题还没有注意到任何其他兼容性问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T15:05:23.393

我阅读了有关 VS2003 “毒化”人们的 Vista 系统的报告，所以我没有冒险——而是将它安装在 Virtual PC Windows XP 32 位映像上。

由于我不再使用太多 .NET 1.1 代码，我认为这是一个很好的解决方法，直到可以让所有/每个人都迁移到 .NET 2.0 或更高版本。

VS2005 的第一个版本也存在与 Vista 的兼容性问题。这已经通过服务包解决了，但即便如此，我还是将 VS2008 放在了我的 Vista 64 机器上。如果您有 VS2008，则使用 VS2005 毫无意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T16:07:54.593

VB6-IDE 和程序在 Vista64 上运行良好。我唯一无法工作的是所谓的 WebClass-Projects（用于 ewb 应用程序的 VB6 方式）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-17T18:24:16.113

我在 Vista 64 机器上的 W2K Virtual PC 上使用 VB6 进行开发。我发现 VB6 应用程序在 W2K 上的构建速度比 XP 快得多。一直没弄明白为什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-20T18:41:45.797

2005 工作正常，MS 正式支持 6.0，所以你应该在这两个方面都做得很好。不幸的是，MS 不支持 2003，到目前为止，我无法让它在 Vista x64 上正确安装和运行。:-(

# php - 在字符串中使用 htmlentities

> ID：209237
> 
> 赞同：1
> 
> 时间：2008-10-16T16:06:05.393
> 
> 标签：php, html-entities

我知道我应该对所有表单文本输入字段使用 htmlentities 但这不起作用：

```
<?php
echo "<tr>
        <td align=\"right\">".Telephone." :</td>    
        <td><input type=\"text\" name=\"telephone\" size=\"27\"
            value=\"htmlentities($row[telephone])\"> Inc. dialing codes
        </td>    
</tr>";
?> 
```

它只是在表单中将输入值显示为“htmlentities(0123456789)”？请问我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T16:08:14.033

尝试使用

```
value=\"" . htmlentities($row[telephone]) . "\" 
```

那里。目前，您的字符串仅包含 htmlentities 字符串并将变量拼接到其中。您需要取出字符串，调用函数并将其结果放在适当的位置，如上所述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T16:08:37.650

您不能在字符串中间调用函数。您需要从函数调用中获取返回值，然后将其包含在字符串中。

然而...

```
<tr>
    <td align="right">
        <label for="telephone">Telephone:</label>
    </td>    
    <td>
        <input type="text" 
               name="telephone" 
               id="telephone"
               size="27" 
               value="<?php 
                   echo htmlentities($row[telephone]); 
               ?>"> 
        Inc. dialing codes 
    </td>
</tr> 
```

...会更干净。

就像摆脱不推荐使用的表示标记和使用表格进行布局一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T16:10:31.033

@workmad3: that won't work as he's doing PHP.

```
<?php echo '<tr>
                <td align="right">' . Telephone . ' :</td>    
                <td><input type="text" name="telephone" size="27" value="' . htmlentities($row[telephone]) . '" /> Inc. dialing codes</td>    
        </tr>'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:15:25.423

This will work:

```
<?php
echo "    <tr>
                    <td align=\"right\">Telephone :</td>    
                    <td><input type=\"text\" name=\"telephone\" size=\"27\" value=\"".htmlentities($row[telephone])."\"> Inc. dialing codes</td>    
            </tr>";
?> 
```

BTW, I also corrected some very strange syntax you have going on here, like where you concatenate the constant "Telephone", which really should be inside the string. These kinds of details are important and will break your code easily.

Also, I suggest using single quotes, instead of double, around a string like this so that you don't have to escape all of the double quotes inside the string.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T20:03:20.237

如果您只是在寻找使您的输出在 hml 中安全；您应该改用 htmlspecialchars()，因为它“只是”一个电话号码。

`htmlspecialchars($row[telephone], ENT_QUOTES);`

htmlentities() 有点慢，而且对多字节字符不太好。但我猜你并没有解决这些问题只是喷气机。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-30T02:39:19.857

如果您想组合一大段 HTML 和 PHP 变量，您可以做两件事。

一，使用HEREDOC结构。

```
$txt = <<<HERETEXT
Put your HTML here.
HERETEXT;

echo $txt; 
```

其次，使用第一个类变量来命名函数，然后在 HEREDOC 中使用它。

```
$he = 'htmlentities';

$txt = <<<HERETEXT
{$he($string, ENT_QUOTES, 'UTF-8')}
HERETEXT;

echo $txt; 
```

然而，HTML 不应该以非常大的块来处理，因为会增加出现严重错误的风险。此外，您可能会不必要地重复自己。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T16:09:32.627

首先，不要在字符串中回显您的 HTML。将代码与标记分开。

```
<tr>
    <td align="right">Telephone :</td>
    <td><input type="text" name="telephone" size="27"
        value="<?php echo htmlentities($row['telephone']); ?>"> Inc. dialing codes</td>
</tr> 
```

# c# - 使用 Active Directory 中的安全组的 Asp.Net 基于角色的身份验证

> ID：209242
> 
> 赞同：15
> 
> 时间：2008-10-16T16:07:46.467
> 
> 标签：c#, asp.net, security, authentication, role

我正在尝试做一些简单的事情（我认为） - 使用我们域中的 Active Directory 组使用基于角色的安全性来保护我的应用程序。

具体来说，我需要根据当前登录的用户是否属于`domain\groupA`Active Directory 来显示/隐藏页面上的项目。出于某种原因，很难找到有关为此使用 Active Directory 的信息。我似乎找到的所有内容都详细介绍了使用角色使用基于表单的身份验证，或者它使用数据库来存储信息。

我要做的就是在我们的 Active Directory 中使用我们已经概述的安全结构。有人可以解释我需要什么吗？

我需要：

1.  `<roleManager enabled="true"/>`在`web.config`
2.  `<allow roles ="domain\groupA"/>`在`web.config`
3.  IIS 设置为 windows 身份验证
4.  `if (User.IsInRole(@"domain\groupA")){ //do stuff }`在我的页面？

我还缺少什么？任何事物？因为它不工作。呵呵。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-16T16:11:52.433

您可能只需要在 web.config 中添加 RoleProvider 来告诉应用如何针对 AD 进行搜索。

示例代码来自[这里](http://msdn.microsoft.com/en-us/library/system.web.security.windowstokenroleprovider.aspx)。

```
<roleManager defaultProvider="WindowsProvider" 
  enabled="true"
  cacheRolesInCookie="false">
  <providers>
    <add
      name="WindowsProvider"
      type="System.Web.Security.WindowsTokenRoleProvider" />
  </providers>
</roleManager> 
```

# javascript - JQuery：在这么多毫秒内再次按下按钮

> ID：209254
> 
> 赞同：0
> 
> 时间：2008-10-16T16:11:06.150
> 
> 标签：javascript, jquery, morse-code

我正在编写一个 Web 应用程序来解码使用鼠标按钮点击的摩尔斯电码。

我最初使用传统的 JavaScript 进行了概念验证，但现在我正在使用 jQuery 重做它。

jQuery是否有一种聪明的方法来判断一个按钮是否在这么多毫秒内再次被按下 - 如果按钮没有被再次按下，则运行一些 jQuery 代码。

我一直在查看 jQuery API，但我没有看到这样做的聪明方法......

有任何想法吗...

德里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T16:14:42.163

我怀疑您需要监视按钮的单击事件并自己进行计时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:37:26.330

关于在这么多毫秒内没有再次按下按钮的观点，您需要使用`setTimeout()`and `clearTimeout()`，如 theracoonbear 所说，自己跟踪目标。您可能在您的 POC 中这样做了，而 JQuery 在 API 中没有这个（我已经看到了），所以只要重构就可以了。

# algorithm - 有效地遍历单向树

> ID：209255
> 
> 赞同：3
> 
> 时间：2008-10-16T16:11:09.033
> 
> 标签：algorithm, traversal, subtree

我有一个单向的对象树，其中每个对象都指向它的父对象。给定一个对象，我需要获取它的整个后代子树，作为对象的集合。这些对象实际上不在任何数据结构中，但我可以轻松获得所有对象的集合。

天真的方法是检查批次中的每个对象，查看给定对象是否是祖先，然后将其放在一边。这不会太有效......它带有 O(N*N) 的开销，其中 N 是对象的数量。

另一种方法是递归方法，这意味着搜索对象的直接子级并重复该过程以进行下一个级别。不幸的是，树是单向的……没有直接接近孩子的方法，这只会比以前的方法稍微便宜一点。

我的问题：我在这里忽略了一个有效的算法吗？

谢谢，

尤瓦尔=8-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T16:19:58.050

数据库的工作方式相同，数据库的工作方式也是如此。建立一个从父级映射到子级列表的哈希表。这需要 O(n)。然后使用该哈希表将使查找和查询可能更有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T17:05:58.767

正如其他人所提到的，将对象的哈希表/映射构建到它们的（直接）子级列表。

从那里您可以轻松地查找“目标对象”的直接子项列表，然后对于列表中的每个对象，重复该过程。

以下是我在 Java 中使用泛型的方法，使用队列而不是任何递归：

```
public static Set<Node> findDescendants(List<Node> allNodes, Node thisNode) {

    // keep a map of Nodes to a List of that Node's direct children
    Map<Node, List<Node>> map = new HashMap<Node, List<Node>>();

    // populate the map - this is O(n) since we examine each and every node
    // in the list
    for (Node n : allNodes) {

        Node parent = n.getParent();
        if (parent != null) {

            List<Node> children = map.get(parent);
            if (children == null) {
                // instantiate list
                children = new ArrayList<Node>();
                map.put(parent, children);
            }
            children.add(n);
        }
    }

    // now, create a collection of thisNode's children (of all levels)
    Set<Node> allChildren = new HashSet<Node>();

    // keep a "queue" of nodes to look at
    List<Node> nodesToExamine = new ArrayList<Node>();
    nodesToExamine.add(thisNode);

    while (nodesToExamine.isEmpty() == false) {
        // pop a node off the queue
        Node node = nodesToExamine.remove(0);

        List<Node> children = map.get(node);
        if (children != null) {
            for (Node c : children) {
                allChildren.add(c);
                nodesToExamine.add(c);
            }
        }
    }

    return allChildren;
} 
```

如果我记得如何计算正确的话，预期的执行时间介于 O(n) 和 O(2n) 之间。您可以保证查看列表中的每个节点，再加上一些操作来查找节点的所有后代 - 在最坏的情况下（如果您在根节点上运行算法），您正在查看列表中的每个节点列表两次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T16:17:39.193

您的问题有点抽象，但[嵌套集](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)（向下滚动，可能有点过于 mysql-specific）可能是您的一个选择。尽管任何修改都非常复杂（并且平均必须修改一半的树），但读取操作的速度非常快。

不过，这需要修改数据结构的能力。而且我想如果你可以修改结构，你也可以添加对子对象的引用。如果你不能修改结构，我怀疑有什么比你的想法更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T17:00:11.620

构建一个对象指向其直系子级的树可能是最好的方法，尤其是在您需要进行未来查找时。建造树很大程度上取决于原始树的高度。最多需要 O(n^2)。

在构建树时，构建一个哈希表。哈希表将使未来对特定对象的搜索更快（O(1) vs. O(n)）。

# c# - C# Remoting - 如何关闭 CustomErrors

> ID：209257
> 
> 赞同：32
> 
> 时间：2008-10-16T16:11:54.617
> 
> 标签：c#, .net, remoting, custom-errors

当我尝试使用远程处理连接到我的服务器应用程序时出现以下错误：

> *连接到远程服务器时似乎出现了问题：
> 服务器遇到内部错误。有关详细信息，请在服务器的 .config 文件中关闭 customErrors。*

这是我的服务器应用程序上的代码：

```
TcpChannel tcpChannel = new TcpChannel(999);
MyRemoteObject remObj = new MyRemoteObject (this);
RemotingServices.Marshal(remObj, "MyUri");
ChannelServices.RegisterChannel(tcpChannel); 
```

它似乎第一次工作，但除非重新启动服务器应用程序，否则会发生错误。

我猜有些东西没有被正确清理，但我不确定 customError 仍然存在。

我开始的任何想法。谢谢。

[编辑] - 感谢 Gulzar，我将上面的代码修改为以下内容，现在显示错误：

```
RemotingConfiguration.CustomErrorsMode = CustomErrorsModes.Off;
TcpChannel tcpChannel = new TcpChannel(999);
MyRemoteObject remObj = new MyRemoteObject (this);
RemotingServices.Marshal(remObj, "MyUri");
ChannelServices.RegisterChannel(tcpChannel); 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-16T16:16:08.853

对于 .Net 1.0/1.1 ，您需要一个用于远程服务器的配置文件

如果您没有`<ServerEXE>.config`文件，请创建一个并在其中包含以下内容：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
   <system.runtime.remoting>    
      <customErrors mode="off" />
   </system.runtime.remoting>
</configuration> 
```

对于 .Net 2.0，您可以使用[RemotingConfiguration.CustomErrorsMode](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.remotingconfiguration.customerrorsmode.aspx)属性

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T16:35:02.217

在服务器文件中，使用：

```
RemotingConfiguration.CustomErrorsEnabled(bool); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T16:19:43.883

要关闭 customErrors，请`web.config file`在服务器上打开。如果有`customErrors`标签，请更改它。如果没有，请添加它。

应该是`<customErrors mode="Off"/>`为了这个目的。

如果您确实在使用自定义错误页面，一旦发现问题，您将需要更改此设置。

# c# - DLLImport Int** - 如果可以的话怎么做

> ID：209258
> 
> 赞同：5
> 
> 时间：2008-10-16T16:11:56.163
> 
> 标签：c#, interop, pinvoke, dllimport

我正在尝试使用第三方 DLL，它需要一个 int** 作为该方法的参数之一。它将参数描述为指向内存分配的指针的地址。

很抱歉有任何混淆。我认为参数是双向的。DLL 用于与 FPGA 板通信，方法是在主机 PC 和 PCI 板之间建立 DMA 传输。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T16:14:09.373

使用 by-ref [`System.IntPtr`](http://msdn.microsoft.com/en-us/library/system.intptr.aspx)。

```
 [DllImport("thirdparty.dll")]
 static extern long ThirdPartyFunction(ref IntPtr arg);

 long f(int[] array)
  { long retval = 0;
    int  size   = Marshal.SizeOf(typeof(int));
    var  ptr    = IntPtr.Zero;

    try 
     { ptr = Marshal.AllocHGlobal(size * array.Length);

       for (int i= 0; i < array.Length; ++i) 
        { IntPtr tmpPtr = new IntPtr(ptr.ToInt64() + (i * size));
          Marshal.StructureToPtr(array, tmpPtr, false);
        }

       retval = ThirdPartyFunction(ref ptr);
     }
    finally 
     { if (ptr != IntPtr.Zero) Marshal.FreeHGlobal(ptr);
     }

    return retval;
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:14:37.950

在这种情况下，您将不得不使用 Marshal 类或变得不安全。

它也可能只是指向数组的指针，因此 a`ref int[] list`可能有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T17:11:44.950

一个 int** 将是 IntPtr 的数组，根据您的描述，我认为您可能想研究使用 C++/CLI 来帮助您进行转换，例如从非托管 int** 到托管数组^>^

# visual-studio - 是否有 devenv 标志可以在编译时禁用 pdb 生成？

> ID：209275
> 
> 赞同：2
> 
> 时间：2008-10-16T16:15:27.590
> 
> 标签：visual-studio, visual-studio-2005, pdb-files

我们的持续集成系统目前运行一个 perl 脚本来解析我们的 sln/proj 文件以设置以下选项：

DebugInformationFormat="0" GenerateDebugInformation="FALSE"

防止生成 pdbs 允许我们增加 CIS 编译的并行化。但是，这种方法看起来很老套，偶尔会失败——有更好的方法吗？

我能想到的唯一选择是添加一个名为 RELEASE_NOPDB 的配置，但我担心这会使 RELEASE 配置的维护变得复杂——维护人员必须确保在进行更改时反映对 NOPDB 版本的所有更改。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T16:30:09.310

[这个答案](https://stackoverflow.com/questions/111631/visual-studio-solutions-multiple-project-how-to-effectively-propagate-project-p#111648)提到 *.vsprops 文件作为跨项目传播“全局”信息的一种方式。也许他们也可以解决您的问题。

否则，[我建议](https://stackoverflow.com/questions/111631/visual-studio-solutions-multiple-project-how-to-effectively-propagate-project-p#111657)您让[CMake](http://www.cmake.org)生成您的解决方案和项目文件。

# c# - C#相当于java的等待和通知？

> ID：209281
> 
> 赞同：57
> 
> 时间：2008-10-16T16:16:55.700
> 
> 标签：c#, java, multithreading

我知道您可以使用 lock 在 c# 中锁定一个对象，但是您可以放弃锁定并等待其他东西通知您它已更改，就像您在 java 中使用 wait 和 notify 一样？

在我看来，java 和 c# 中的 synchronized 和 lock 分别是同义词。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-10-16T16:28:04.790

等效功能（包括正常锁定）在[Monitor](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)类中。

```
foo.notify() => Monitor.Pulse(foo)
foo.notifyAll() => Monitor.PulseAll(foo)
foo.wait() =>  Monitor.Wait(foo) 
```

C# 中的`lock`语句等效于调用`Monitor.Enter`并`Monitor.Exit`带有适当的 try/finally 块。

有关详细信息，请参阅[我的线程教程](http://pobox.com/~skeet/csharp/threads)或[Joe Albahari 的](http://www.albahari.com/threading/)教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:19:09.190

我认为等待句柄可能对你有用。看看[这](http://msdn.microsoft.com/en-us/library/ms173179.aspx)是否有帮助。

# asp.net - 如何将表单从 HTML 发布到 ASPX 页面

> ID：209301
> 
> 赞同：24
> 
> 时间：2008-10-16T16:22:30.167
> 
> 标签：asp.net

如何将表单从 HTML 页面发布到 ASPX 页面 (2.0) 并能够读取这些值？

我目前有一个使用 Membership 提供程序的 ASP.NET 站点，并且一切正常。用户可以从 Login.aspx 页面登录。

我们现在希望能够让用户直接从另一个网站登录——这基本上是一个静态 HTML 页面。用户需要能够在此 HTML 页面上输入他们的姓名和密码，并将其发布到我的 Login.aspx 页面（然后我可以在其中手动登录）。

是否可以将表单值从 HTML 传递到 ASPX？我什么都试过了，Request.Form.Keys 集合总是空的。我不能使用 HTTP GET，因为这些是凭据，不能通过查询字符串传递。

我知道的唯一方法是 iframe。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-16T17:07:32.603

这是*很有*可能的。我模拟了 3 页应该给你一个概念证明：

.aspx 页面：

```
<form id="form1" runat="server">
    <div>
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <asp:TextBox TextMode="password" ID="TextBox2" runat="server"></asp:TextBox>
        <asp:Button ID="Button1" runat="server" Text="Button" />
    </div>
</form> 
```

后面的代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    For Each s As String In Request.Form.AllKeys
        Response.Write(s & ": " & Request.Form(s) & "<br />")
    Next
End Sub 
```

单独的 HTML 页面：

```
<form action="http://localhost/MyTestApp/Default.aspx" method="post">
    <input name="TextBox1" type="text" value="" id="TextBox1" />
    <input name="TextBox2" type="password" id="TextBox2" />
    <input type="submit" name="Button1" value="Button" id="Button1" />
</form> 
```

...并且它按预期反刍表单值。如果这不起作用，正如其他人所建议的那样，请使用流量分析工具（fiddler，ethereal），因为某些事情可能不会按照您的预期进行。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-28T16:15:09.840

如果您的 html 输入都没有名称，则 Request.Form.Keys 集合将为空。在您使用 .NET 一段时间后，很容易忘记将它们放在那里。只需命名它们，您就可以开始了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T16:50:50.623

您确定您的 HTML 表单是正确的，并且确实执行了 HTTP POST 吗？我建议运行[Fiddler2](http://www.fiddler2.com/fiddler2/)，然后尝试通过 Login.aspx 登录，然后是远程 HTML 站点，然后比较发送到服务器的请求。对我来说，ASP.Net 一直运行良好——如果 HTTP 请求包含有效的 POST，我可以使用 Request.Form 获取值...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T17:10:50.117

你当然可以。

查看如何执行此操作的最简单方法是浏览到要发布到的 aspx 页面。然后将该页面的源代码保存为 HTML。将表单在新 html 页面上的操作更改为指向您最初从中复制它的 aspx 页面。

将值标签添加到您的表单字段并将您想要的数据放入其中，然后打开页面并点击提交按钮。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T17:33:58.713

你当然可以。创建一个 HTML 页面，其中包含来自 login.aspx 页面的必要组件（即用户名等），并确保它们具有相同的 ID。对于您的操作，请确保它是一个帖子。

您可能需要在 Page_Load 函数中的 login.aspx 页面上执行一些代码来读取表单（在 Request.Form 对象中）并调用适当的函数来登录用户，但除此之外，您应该有权访问表格，并且可以用它做你想做的事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-21T12:39:28.797

在 html 表单中，您需要提供额外的 viewstate 变量并在服务器页面中禁用 ViewState。不过，这需要双方进行一些控制。

表单 HTML：

```
<html><body> <form id='postForm' action='WebForm.aspx' method='POST'>
        <input type='text' name='postData' value='base-64-encoded-value' />
        <input type='hidden' name='__VIEWSTATE' value='' />  <!-- still need __VIEWSTATE, even empty one -->
    </form>

</body></html> 
```

注意空的__VIEWSTATE。

WebForm.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" 
CodeBehind="WebForm.aspx.cs" Inherits="WebForm"
 EnableEventValidation="False" EnableViewState="false" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="postForm" runat="server">
        <asp:TextBox ID="postData" runat="server"></asp:TextBox>
    <div>

    </div>
    </form>
</body>
</html> 
```

注意`EnableEventValidation="False", EnableViewState="false"`防止空视图状态的验证错误。代码隐藏/继承值不精确。

WebForm.cs：

```
public partial class WebForm : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string value = Encoding.Unicode.GetString(Convert.FromBase64String(this.postData.Text));
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-23T18:51:46.187

希望这会有所帮助 - 将此标签放入 html 和

删除您的 login.aspx 设计内容..只写页面指令

并且您将在提交按钮单击后获得 aspx 页面中的值-protected void Page_Load(object sender, EventArgs e) {

```
 if (!IsPostBack)
        {
            CompleteRegistration();
        }
    } 
```

公共无效完成注册（）{

```
 NameValueCollection nv = Request.Form;
        if (nv.Count != 0)
        {
            string strname = nv["txtbox1"];
            string strPwd = nv["txtbox2"];
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-29T15:42:06.743

删除数据发布/发布的 .aspx 页面的 runat="server" 部分。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-06-07T09:42:55.123

我在[https://www.mikesdotnetting.com/article/293/request-form-is-empty-when-posting-to-aspx-page](https://www.mikesdotnetting.com/article/293/request-form-is-empty-when-posting-to-aspx-page)找到了一个可行的解决方案。关键是，从 action 属性中删除 .aspx。

前任：`<FORM NAME="Logon" action="default" method="post">`

# c# - 退出后 C# 控制台应用程序仍驻留在内存中

> ID：209304
> 
> 赞同：2
> 
> 时间：2008-10-16T16:23:24.360
> 
> 标签：c#, .net, console-application

我有一个 .net C# 控制台应用程序（不是服务）。它基本上连接到一个 web 服务，获取一些 xml 文件，将这些文件复制到驱动器上的几个位置，验证 xml，处理它并将这些对象发送到另一个 web 服务。

但是，当 main 方法存在（并且控制台窗口关闭）时，我仍然可以在任务管理器中看到该进程。

我尝试尝试在 main 方法中包含所有内容，以捕获 ApplicationException，但我仍然对应用程序崩溃的原因一无所知，即使一切正常，否则...

有人知道从哪里开始检查有缺陷的部分吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T16:25:23.123

查看线程使用情况和异步调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T16:32:57.773

如果控制台窗口已关闭，则该进程仍在运行似乎确实很奇怪。您可以在 Visual Studio 调试器中附加到它吗？（显然是调试版本。）

您确定这不是仍在执行的先前运行吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T16:56:49.427

如果您正在调试应用程序，那么我已经看到 Visual Studio 创建一个主机 exe 的情况，该主机 exe 的名称与您的应用程序类似，最后带有 .vshost.exe。它使用该控制您的应用程序以获得更好的调试体验。在您完成程序调试后，此主机 exe 会一直存在，以便它等待并准备好，以便它可以快速启动新的调试会话。

你确定不是这个exe在闲逛吗？

如果你在没有调试的情况下运行你的应用程序，那么它仍然会挂起吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:47:21.427

您几乎可以肯定在您的应用程序中有一个未终止的线程。正如乔恩所说，附加调试器并查看哪些线程是活动的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T16:52:51.230

正如所有其他答案所暗示的那样，您可能确实有一个挥之不去的线程，但不一定是您明确创建的线程，您可能需要在一个或多个对象上调用 Dispose 或类似的东西

# linux - 如何丢弃原始套接字中的传入数据包？

> ID：209305
> 
> 赞同：3
> 
> 时间：2008-10-16T16:23:58.633
> 
> 标签：linux, sockets, flush, raw-sockets

我正在 Linux 下编写一个 C/C++ 应用程序，它从原始套接字（用于 ICMP 数据包）读取数据。问题：有没有办法丢弃仍在套接字上排队的所有数据？

问题是睡了一会儿后，socket上有我不感兴趣的数据排队；所以最好只是告诉套接字“忘记你现在缓冲的所有数据”，这样如果我进入一个 select()/recvfrom() 循环，我只会得到最近收到的数据。

有没有比先进入单独的 poll()/recvfrom() 循环更好的方法？可能是一些套接字 API 调用？便携，甚至？:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T12:41:40.797

在空闲时间，您可以通过将接收缓冲区大小设置为零来禁用套接字：

```
 int optval = 0; /* May need to be 1 on some platforms */

 setsockopt(sockDesc, SOL_SOCKET, SO_RCVBUF, (char *)(&optval), sizeof(optval)); 
```

通过将“optval”设置为更大的缓冲区（例如 4096）重新启用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T08:00:22.640

我建议不要睡觉。使用 select 调用在数据到达时立即处理数据。

```
while (1)
{

    FD_ZERO (&sockets);
    FD_SET (raw_socket, &sockets);

    timeout.tv_sec = 1;
    timeout.tv_usec = 0;

    if (select (raw_socket + 1, &sockets, NULL, NULL, &timeout))
    {
    if (FD_ISSET (raw_socket, &sockets))
    {
        // handle the packet
    }
    }
    else
    {
    /* Select Timed Out */
    fprintf(stderr, "Timed out");
    }
} 
```

此外，在创建原始套接字时，您可以指定您只对 icmp 数据包感兴趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T17:00:42.070

我知道如何可靠地做到这一点的唯一方法是关闭套接字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T21:14:38.513

你不能只做`recvfrom()`一个临时缓冲区并丢弃缓冲区吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T13:45:14.337

我没有尝试过，出于性能原因，这可能是完全不明智的（但如果您的应用程序无论如何都处于睡眠状态，这可能不是问题），但是：您可以尝试在睡眠之前将套接字的接收缓冲区设置为一些非常小的值。我希望这会导致套接字无法缓冲应用程序未侦听时到达的数据。这是一个很长的镜头。

或者，也许在睡眠后重置接收缓冲区大小，当您准备再次开始阅读时，也会导致它刷新它。当然，这些技巧仅此而已，即使它们有效，它们也肯定是不可移植的。我只是想我会分享这个想法，如果您有机会对其进行测试，它可能会对您有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T21:09:23.267

你能在睡前做这样的事吗？

```
for(n=0;n<=MAX_BUFFER_SIZE;n++)
{
recv_buffer[n] = 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-18T09:53:24.597

中间件应用程序中的标准过程是有一个专用线程来服务 IO 请求，其优先级设置为高于其他应用程序线程。当 IO 线程接收到一个数据包时，它会将其排入应用层。当应用程序有空闲时间时，它会将下一个数据包出列。

这是 TIBCO Rendezvous 背后的架构，用于许多实时市场数据和企业消息传递系统。需要注意的是，您通常希望对队列大小进行一些限制，这样应用程序就不会被 OOM 管理器获取。IO 线程和应用层之间的协议可以从简单的异步队列到更复杂的主题过滤、优先级列表以及支持线程池以并行解码传入数据。

# javascript - Javascript将事件注册到对象

> ID：209320
> 
> 赞同：0
> 
> 时间：2008-10-16T16:28:12.510
> 
> 标签：javascript, events, activex

我有一个加载到 html 页面中的 activex 对象。然后我使用该 activex 对象创建另一个对象，但我需要使用创建的新对象注册一个事件。该对象需要某种类型的事件侦听器。

我可以在 c# 中加载相同的 dll，它会正常工作。c# 的代码如下所示。

```
upload = obj.constructUploadObj(uploadConfig);
upload.stateChanged += new UploadActionEvents_stateChangedEventHandler(upload_stateChanged); 
```

在 javascript 中，我有类似的代码，但是我无法使用对象注册事件。

```
uploadAction = obj.constructUploadObj(uploadConfig);
uploadAction.stateChanged = upload_stateChanged;

function upload_stateChanged(sender){
    writeLine("uploadState changed " + sender.getState());
} 
```

我在javascript中列举了uploadAction对象的一些属性，以确保它是真正创建的。当我尝试使用 uploadAction 注册事件时，它会抛出一个错误，提示“对象不支持此属性或方法”。

对我来说，它似乎在期待一个强类型的事件。无论如何在javascript中注册类似于C#的事件吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-16T16:43:21.077

您的 javascript 应如下所示：

```
function uploadAction::stateChanged( parms )
{
    // ...
    // implementation
    // ...
} 
```

请注意，这是一个静态函数声明，假设您有一个名为“uploadAction”的 Active X 对象。我知道这确实有效 - 我们在我的公司使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T16:44:19.497

错误消息意味着 uploadAction 不支持 stateChanged 属性。您的 javascript 代码看起来正确，问题似乎出在您尝试将事件处理程序附加到的对象上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T22:24:45.177

我建议使用[此处](http://www.quirksmode.org/js/events_advanced.html)概述的高级事件注册模型。

`uploadAction.addEventListener('stateChanged', upload_stateChanged, false);`

请注意，您可能需要询问`upload_stateChanged`方法的参数，因为第一个参数应该是事件状态。例如：`upload_stateChanged(evt, sender)`...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:23:16.937

从公司发现这些属性无法通过 javascript 访问。他们需要将它们外部化以便在 javascript 中使用。

# url - URL 重写 - 国际信件

> ID：209327
> 
> 赞同：0
> 
> 时间：2008-10-16T16:30:25.377
> 
> 标签：url, url-rewriting, character-encoding

我应该如何格式化带有特殊/国际字符的 URL？

目前，我尝试使 URL “看起来不错”，以便：

```
www.myhost.com/this is a test, do you know how? 
```

转换为：

```
www.myhost.com/this_is_a_test_do_you_know_how 
```

我知道可以转换一些国际字母（ü = ue，æ = ae，å = aa），可以删除一些字符。我一般会尝试使 URL 看起来“不错”，但这很愚蠢吗？

但是，与我们的西方 ASCII 格式无关的中文、日文、阿拉伯字母怎么办？

我真的不喜欢用十六进制代码重写 URL 的想法，所以现在如果 url 包含太多“不可转换”字符，我只使用我的内部唯一 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T16:40:29.210

您使用什么语言？PHP 包含一个函数 filter_var() ，它似乎可以满足您的大部分需求。请参阅[http://us.php.net/manual/en/function.filter-var.php](http://us.php.net/manual/en/function.filter-var.php)。

一般来说，从任意字符串输入生成人类可读的 ASCII 字符串的成本可能太高了，不值得。如果用户给你一个汉字，你会怎么做？查字典并用拼音输出结果？

最好、最通用的解决方案是简单地获取输入，将其格式化为 UTF-8，然后对结果进行 url 编码。这将使非拉丁文本不可读，但无论如何，这些语言都没有好的通用解决方案。您使用的语言几乎肯定具有可以使这变得简单的库函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T17:17:10.260

但是谷歌没有利用 URL 吗？如果给定文章的某些文本在 URL 中，Google 搜索引擎会使用它吗？但是，如果真的没有很酷的方法来处理非 ascii 字母，那么这些语言在“google-internet”上的优先级较低？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T17:49:03.643

看看说，[http://ja.wikipedia.org/](http://ja.wikipedia.org/)。如果您将鼠标悬停在链接上，它们会在状态栏中显示为日文字符。当您点击链接时，在位置栏中看起来不是那么日本，但这可能无济于事。没有检查，但我认为它都是 utf8 十六进制编码的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T18:47:55.897

如果您使用 .NET 而不是

```
Server.URLEncode( myURL ); 
```

但是如果你想使用斯堪的纳维亚字符或任何你想要的字符，你只需要在你的 URL ReWriting 组件中设置规则，因为[DynamicWeb CMS](http://www.dynamicweb.dk)软件使用所有可用的字符，只用下划线 ('_') 替换空格

像这个网址：

```
http://www.gynækologen.dk/Undersøgelser_og_behandlinger.aspx
```

您可以在域中看到 æ 以及页面名称中的 ø

# c++ - 如何开始 Linux 编程

> ID：209334
> 
> 赞同：10
> 
> 时间：2008-10-16T16:32:58.053
> 
> 标签：c++, c, linux

从过去几年开始，我一直在 Windows 中研究 C++ 和 COM/ATL。现在我想转向 Linux 编程。我知道Linux的基本架构。我做了一些使用 ncurses、套接字和音频库（终端应用程序）的项目。我应该熟悉哪个工具来开始项目。在 Windows 中，我从 Win32 编程开始，然后转到 COM 和 ATL。Win32 Programming 让我了解了 Windows。

你能给我一些开始 Linux 编程的步骤吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-16T16:37:01.947

*   gcc/g++
*   了解 shell 基础知识：可能是 bash（通常是默认值）
*   make （你不必是专家，甚至在你自己的工作中使用它，但你应该了解它）
*   脚本语言（bash、ruby、python、tcl、perl；您选择）
*   基本的 unix 命令行实用程序（ls、cd 等....）
*   编辑器：vi 或 emacs 是最受欢迎的选择。
*   linux。特别是您的发行版（ubuntu 很受欢迎；您可能想从那里开始）。知道如何调整你的环境，以及如何在它们崩溃时修复它们。

其余的取决于你想做什么。

你不需要成为这方面的专家；你会随着时间的推移而学习。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-16T16:36:05.723

取决于你想做什么......

你打算做 GUI 应用程序吗？学习 Qt 或 GTK 或 wxWidgets。你打算做设备驱动程序开发吗？直接学习 C，而不仅仅是 C++。Linux 下的许多令人兴奋的软件开发都发生在 Python 和 Perl（以及在较小程度上的其他动态语言）中，因此您几乎肯定应该学习其中的一种。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-16T17:09:11.350

## 务实的答案

我理解你为什么这样问你的问题，但 Linux 不是 Windows，所以真的没有直接的答案。实际上我们在谈论 GNU/linux + 所有的自由软件生态系统，所以你必须学习什么很大程度上取决于你想做什么。

如果您更喜欢系统编程，您将查看 linux 内核并需要提高您的 C 技能。

如果您想编写实用程序代码，脚本语言（尤其是 ruby​​ 和 python）将是您选择的工具，并且您必须在此基础上选择一个 GUI 框架（GTK、QT 和 wxWidget 显示方式）。

如果更多的是关于网络和网络编程：python、ruby、php 或 java 可以做到。

## 好消息

在 Linux 环境中，您可以选择，因为很多人使用很多不同的工具。它可能看起来很混乱，而且经常如此，但它的效果还不错。

所以停止思考你必须学习什么，专注于两个问题：

*   我想加入一个项目吗？然后您加入的项目将选择技术。因此，选择一个使用您想学习的技术的项目。
*   我想开始我自己的项目吗？然后技术将由您将依赖的现有工具选择。大多数时候，您将拥有选择权，因此享受您的新自由并学习您想要的技术。

***Free，就像在freedom mate中一样，意味着你可以选择。***

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-31T20:56:56.410

开始阅读《[高级 Linux 编程](http://www.advancedlinuxprogramming.com/)》一书，该书也以免费 PDF 的形式提供。

不要害怕*高级*关键字。从您的帖子的详细信息（ncurses、sockets）来看，您已经“高级”了。

您还可以稍后查看[glib](http://www.gtk.org/overview.html)库（GTK+/GNOME 的标准组件，但也用于命令行应用程序。）

如果您绝对必须使用 C++ 编程，请阅读[QT](http://www.qtsoftware.com/developer)的整个文档， 您就可以开始了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-31T21:05:29.137

阅读 [UNIX 编程艺术 http://ecx.images-amazon.com/images/I/51HJF%2B%2BjseL._BO2,204,203,200_PIsitb-sticker-arrow-click,TopRight,35,-76_AA240_SH20_OU01_.jpg](https://rads.stackoverflow.com/amzn/click/com/0131429019)

这将帮助您理解为什么事情会像在基于 *unix 的系统中那样完成。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T17:46:03.057

我还建议您学习 STL 和 Boost——后者在 Linux 中编写 C++ 应用程序时特别有用，因为您可以获得用于线程、文件系统、正则表达式等的库。此外，如果需要，可以将代码移植回 Windows。这就是我开始使用 Linux 的方式——我采用了一个 Windows 项目并转换为使用 STL/Boost 并添加了一个基于浏览器的 UI。一旦它在 Windows 中启动并运行——但代码中没有实际的 Windows 细节——我开始学习 Linux 基础知识（gcc、make 等）并让它很快工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T18:26:08.077

利用您已经来之不易的 COM 知识，学习诸如[TAO](http://www.cs.wustl.edu/~schmidt/TAO.html)之类的东西。显然，unix 世界中没有 ATL 或 WTL……所以你必须花时间学习 STL——好消息是 Windows 上也存在 STL。[Boost](http://www.boost.org/)将帮助您更轻松地在平台之间切换，因此您也应该学习这一点。

除此之外，这真的取决于你想做什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-29T15:53:06.130

我建议学习 CMake——它是一个很棒的跨平台构建工具，比 make/autotools 更容易使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T18:39:20.903

我建议你从使用 Gentoo 开始，前几周应该很难，但过了一段时间（如果你对 linux 有基本了解的话，说 2 个月或更短时间）你将能够使用每个发行版，你会确切地知道会发生什么发生以及当您按下/数字某些东西时您的系统如何，我认为您将在Gentoo上花费更多时间（学习gentoo比其他发行版更难）。我认为这在为 linux 编程时会有所帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T20:06:56.627

在为 Linux 开发时，我倾向于坚持使用基础知识：vim、gcc、gdb（来自命令行，没有前端）、svn、cscope、Valgrind、make（我承认我并不是 make 的忠实粉丝）。存在各种图形前端，甚至 IDE，但我不喜欢其中任何一个。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-31T08:55:50.513

就 Linux 编程而言，您能否详细说明您希望做的事情？ [无论如何，这](http://www.tldp.org)可能包含您希望经历的大部分内容。

# excel - How to set X axis programmatically on a chart?

> ID：209335
> 
> 赞同：1
> 
> 时间：2008-10-16T16:33:04.560
> 
> 标签：excel, charts

I have a chart in a Worksheet in Excel and I have a macro set up so that when I change the value in a certain cell the range of data in the chart is set to `A2` down as far as the row number corresponding in this certain cell.

What I can't seem to be able to do is to modify the axis as the specified axis no longer covers the range of the graph i.e. the current X axis is set to:

```
=Sheet1!$C$2:$C$600 
```

I can't figure out how I can update this in a macro. Any help would be much appreciated.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T17:16:38.857

You should be able to set the XValues property in the same way you did in Lance's answer for your [other question](https://stackoverflow.com/questions/198045/excel-charts-setting-series-end-dynamically).

```
Charts("chartname").SeriesCollection(1).XValues = "=MYXAXIS" 
```

or whatever you call the named range for the x-axis values. If you have multiple series in your chart, you'll want to change the value in SeriesCollection to refer to the right series.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T04:56:10.733

Does the "certain cell" contain the last row number of the data? (it isn't quite clear)

Suppose cell F1 contains the last row in the data. You can construct an address and range like this:

```
Dim rXVals As Range
Dim sAddress AS String

sAddress = "Sheet1!$C$2:$C$" & Worksheets("Sheet1").Range("F1").Value
Set rXVals = Range(sAddress)
Worksheets("Sheet1").ChartObjects(1).Chart.SeriesCollection(1).XValues = rXVals 
```

# c# - 确定如何在 C# 中将对象转换为适当类型的最佳方法？

> ID：209354
> 
> 赞同：4
> 
> 时间：2008-10-16T16:37:09.373
> 
> 标签：c#, casting

我目前正在开发一个批准路由 WCF 服务，该服务将允许用户创建确定如何路由请求的“规则”。通过比较 Request 类的“ObjectToEvaluate”属性与“Rule”类的“ObjectToEvaluate”属性来确定路由。“UnitOfMeasurement”枚举确定如何为每个类转换“ObjectToEvaluate”属性。

```
public enum UnitOfMeasurement
{
    Currency = 1,
    Numeric = 2,
    Special = 3,
    Text = 4,
}

public class Request
{
    public object ObjectToEvaluate { get; set; }
}

public class Rule
{
    public object ObjectToEvaluate { get; set; }

    public virtual void ExecuteRule()
    {
        //logic to see if it passes the rule condition
    }
} 
```

实现使用“UnitOfMeasurement”枚举转换“ObjectToEvaluate”属性的方法的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T17:02:04.750

使用检查枚举值的隐式类型运算符。这样，调用者可以透明地将对象分配给您想要表示它们的类型。例如：

```
public class CastableObject {

    private UnitOfMeasurement eUnit; // Assign this somehow

    public static implicit operator int(CastableObject obj) 
    {
        if (obj.eUnit != UnitOfMeasurement.Numeric)
        {
            throw new InvalidCastException("Mismatched unit of measurement");
        }
        // return the numeric value
    }

    // Create other cast operators for the other unit types
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:49:19.783

你从哪里得到测量单位？我可以看到枚举，但我在 API 的其他地方看不到对它的任何引用。

假设你确实从某个地方得到它，最简单的解决方案可能是一个 switch 语句。这有点难看，但是：

*   它会工作
*   这很容易理解
*   会很快

我仍然不完全相信我理解这个问题的所有内容 - 特别是因为你还没有解释其他对象在投射后将用于什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T17:25:38.120

计量单位枚举包含在审批路由服务中。为了详细说明 Rule 类，它被用作所有其他类型规则的基类。它松散地基于 NxBRE 业务规则引擎[NxBRE 主页](http://www.agilepartner.net/oss/nxbre/)的流引擎。

这是 LessThanRule 类的示例（我修改了原始问题以反映正确的功能）：

```
public class LessThanRule : Rule
{
    private bool m_Result = false;
    private object m_ObjectToCompare = null;
    private object m_ObjectToEvaluate = null;

    public bool Result
    {
        get { return this.m_Result; }
    }

    public object ObjectToCompare
    {
        get { return this.m_ObjectToCompare; }
        set { this.m_ObjectToCompare = value; }
    }

    public object ObjectToEvaluate
    {
        get { return this.m_ObjectToEvaluate; }
        set { this.m_ObjectToEvaluate = value; }
    }

    public override void ExecuteRule()
    {
        if (((IComparable)this.m_ObjectToEvaluate).CompareTo(this.m_ObjectToCompare) < 0)
            this.m_Result = true;
    }
} 
```

希望这可以帮助....

# java - 我如何一般地判断 Java 类是否是原始类型？

> ID：209366
> 
> 赞同：13
> 
> 时间：2008-10-16T16:38:28.637
> 
> 标签：java

有什么方法可以获取一个 Class 并确定它是否代表原始类型（是否有不需要专门枚举所有原始类型的解决方案）？

注意：我见过[这个问题](https://stackoverflow.com/questions/180097/dynamically-find-the-class-that-represents-a-primitive-java-type)。我问的基本相反。我有班级，我想知道它是否是原始的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-16T16:42:39.813

Class 对象上有一个名为[isPrimitive](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#isPrimitive())的方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T16:43:50.247

[Class.isPrimitive()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Class.html#isPrimitive())会告诉你答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-17T16:32:27.810

此方法还将检查它是否是原始类型的包装器：

```
/**
* Checks first whether it is primitive and then whether it's wrapper is a primitive wrapper. Returns true
* if either is true
*
* @param c
* @return whether it's a primitive type itself or it's a wrapper for a primitive type
*/
public static boolean isPrimitive(Class c) {
  if (c.isPrimitive()) {
    return true;
  } else if (c == Byte.class
          || c == Short.class
          || c == Integer.class
          || c == Long.class
          || c == Float.class
          || c == Double.class
          || c == Boolean.class
          || c == Character.class) {
    return true;
  } else {
    return false;
  } 
```

# sql - 在 Linq 中交叉应用

> ID：209376
> 
> 赞同：4
> 
> 时间：2008-10-16T16:42:31.483
> 
> 标签：sql, sql-server, linq, linq-to-sql, sql-server-2008

是否可以将 SQL Server 2008 CROSS APPLY 与 LINQ-2-SQL 一起使用？

示例 SQL：

```
select d.dateCol, tvf.descr, tvf.value
from dateTable d
cross apply tvFunction(d.dt, 'anotherParam') tvf
where d.category='someCat' 
```

CROSS APPLY 允许使用表（示例中的 dateTable）中的值作为 tablevalue 函数的参数。如果您需要对一系列输入进行复杂的计算（封装在表值函数中），这将非常有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T15:52:58.150

使用它的唯一方法是将上述代码包装在一个存储过程中，然后用 LINQ to SQL 包装它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-07T09:53:17.857

试试这个：

```
from d in dateTable
from tvf in tvFunction(d.dt, 'anotherProgram')
where d.category = 'someCat' 
```

# sql-server - 从存储过程的结果集中选择列

> ID：209383
> 
> 赞同：474
> 
> 时间：2008-10-16T16:44:42.447
> 
> 标签：sql-server, tsql, select, stored-procedures

我有一个返回 80 列和 300 行的存储过程。我想编写一个获取其中 2 个列的选择。就像是

```
SELECT col1, col2 FROM EXEC MyStoredProc 'param1', 'param2' 
```

当我使用上述语法时，我得到了错误：

> “无效的列名”。

我知道最简单的解决方案是更改存储过程，但我没有编写它，我无法更改它。

有什么办法可以做我想做的事吗？

*   我可以制作一个临时表来放入结果，但是因为有 80 列，所以我需要制作一个 80 列的临时表才能获得 2 列。我想避免追踪所有返回的列。

*   我尝试`WITH SprocResults AS ....`按照 Mark 的建议使用，但出现 2 个错误

    > 关键字“EXEC”附近的语法不正确。
    > ')' 附近的语法不正确。

*   我尝试声明一个表变量，但出现以下错误

    > 插入错误：列名或提供的值的数量与表定义不匹配

*   如果我尝试
    `SELECT * FROM EXEC MyStoredProc 'param1', 'param2'`
    我得到错误：

    > 关键字“exec”附近的语法不正确。

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2008-10-16T16:48:54.683

你可以拆分查询吗？将存储的 proc 结果插入到表变量或临时表中。然后，从表变量中选择 2 列。

```
Declare @tablevar table(col1 col1Type,..
insert into @tablevar(col1,..) exec MyStoredProc 'param1', 'param2'

SELECT col1, col2 FROM @tablevar 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2008-10-16T17:37:27.533

这是一个非常好的文档的链接，解释了解决问题的所有不同方法（尽管其中很多方法无法使用，因为您无法修改现有的存储过程。）

[如何在存储过程之间共享数据](http://www.sommarskog.se/share_data.html)

Gulzar 的答案会起作用（它记录在上面的链接中）但是编写起来会很麻烦（您需要在 @tablevar(col1,...) 语句中指定所有 80 个列名。并且在将来如果将列添加到架构或更改输出，则需要在您的代码中更新它，否则会出错。

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2010-10-18T22:38:46.960

```
CREATE TABLE #Result
(
  ID int,  Name varchar(500), Revenue money
)
INSERT #Result EXEC RevenueByAdvertiser '1/1/10', '2/1/10'
SELECT * FROM #Result ORDER BY Name
DROP TABLE #Result 
```

资料来源：
[http ://stevesmithblog.com/blog/select-from-a-stored-procedure/](http://stevesmithblog.com/blog/select-from-a-stored-procedure/)

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2011-02-04T03:06:49.797

这对我有用：（即我只需要 30+ 返回的 2 列`sp_help_job`）

```
SELECT name, current_execution_status 
FROM OPENQUERY (MYSERVER, 
  'EXEC msdb.dbo.sp_help_job @job_name = ''My Job'', @job_aspect = ''JOB'''); 
```

在此之前，我需要运行它：

```
sp_serveroption 'MYSERVER', 'DATA ACCESS', TRUE; 
```

....更新`sys.servers`表格。（即在 OPENQUERY 中使用自引用似乎默认情况下被禁用。）

对于我的简单要求，我没有遇到Lance 的优秀链接的[OPENQUERY 部分中描述的任何问题。](http://www.sommarskog.se/share_data.html#OPENQUERY)

Rossini，如果您需要动态设置这些输入参数，那么使用 OPENQUERY 会变得更加繁琐：

```
DECLARE @innerSql varchar(1000);
DECLARE @outerSql varchar(1000);

-- Set up the original stored proc definition.
SET @innerSql = 
'EXEC msdb.dbo.sp_help_job @job_name = '''+@param1+''', @job_aspect = N'''+@param2+'''' ;

-- Handle quotes.
SET @innerSql = REPLACE(@innerSql, '''', '''''');

-- Set up the OPENQUERY definition.
SET @outerSql = 
'SELECT name, current_execution_status 
FROM OPENQUERY (MYSERVER, ''' + @innerSql + ''');';

-- Execute.
EXEC (@outerSql); 
```

我不确定使用`sp_serveroption`直接更新现有`sys.servers`自引用与使用`sp_addlinkedserver`（如 Lance 的链接中所述）创建重复/别名之间的差异（如果有的话）。

注意 1：我更喜欢 OPENQUERY 而不是 OPENROWSET，因为 OPENQUERY 不需要 proc 中的连接字符串定义。

注意 2：说了这么多：通常我只会使用 INSERT ... EXEC :) 是的，这是 10 分钟的额外打字，但如果我能帮助它，我不想乱搞：
（a）引号内的引号引号，和
(b) sys 表，和/或偷偷摸摸的自引用链接服务器设置（即，对于这些，我需要向我们全能的 DBA 辩护:)

但是在这种情况下，我不能使用 INSERT ... EXEC 构造，因为`sp_help_job`已经使用了一个。（“不能嵌套 INSERT EXEC 语句。”）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-01-31T03:21:45.007

如果您能够修改存储过程，您可以轻松地将所需的列定义作为参数并使用自动创建的临时表：

```
CREATE PROCEDURE sp_GetDiffDataExample
      @columnsStatement NVARCHAR(MAX) -- required columns statement (e.g. "field1, field2")
AS
BEGIN
    DECLARE @query NVARCHAR(MAX)
    SET @query = N'SELECT ' + @columnsStatement + N' INTO ##TempTable FROM dbo.TestTable'
    EXEC sp_executeSql @query
    SELECT * FROM ##TempTable
    DROP TABLE ##TempTable
END 
```

在这种情况下，您不需要手动创建临时表 - 它是自动创建的。希望这可以帮助。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-06-24T15:03:49.707

了解为什么这如此困难可能会有所帮助。存储过程可能只返回文本（打印'text'），或者可能返回多个表，或者根本不返回表。

所以类似的东西`SELECT * FROM (exec sp_tables) Table1` 不起作用

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-09-03T06:11:56.153

为了实现这一点，首先你创建一个`#test_table`像下面这样的：

```
create table #test_table(
    col1 int,
    col2 int,
   .
   .
   .
    col80 int
) 
```

现在执行程序并将值放入`#test_table`：

```
insert into #test_table
EXEC MyStoredProc 'param1', 'param2' 
```

现在您从以下位置获取值`#test_table`：

```
select col1,col2....,col80 from #test_table 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-10-16T18:09:25.397

（假设 SQL Server）

在 T-SQL 中处理存储过程结果的唯一方法是使用`INSERT INTO ... EXEC`语法。这使您可以选择插入临时表或表变量，然后从那里选择您需要的数据。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-01-28T00:48:22.813

一个快速的技巧是添加一个新参数`'@Column_Name'`并让调用函数定义要检索的列名。在存储过程的返回部分中，您将有 if/else 语句并仅返回指定的列，或者如果为空 - 则返回全部。

```
CREATE PROCEDURE [dbo].[MySproc]
        @Column_Name AS VARCHAR(50)
AS
BEGIN
    IF (@Column_Name = 'ColumnName1')
        BEGIN
            SELECT @ColumnItem1 as 'ColumnName1'
        END
    ELSE
        BEGIN
            SELECT @ColumnItem1 as 'ColumnName1', @ColumnItem2 as 'ColumnName2', @ColumnItem3 as 'ColumnName3'
        END
END 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2016-02-24T06:02:21.317

正如问题中提到的，在执行存储过程之前很难定义 80 列的临时表。

因此，解决此问题的另一种方法是根据存储过程结果集填充表。

```
SELECT * INTO #temp FROM OPENROWSET('SQLNCLI', 'Server=localhost;Trusted_Connection=yes;'
                                   ,'EXEC MyStoredProc') 
```

如果您遇到任何错误，您需要通过执行以下查询来启用临时分布式查询。

```
sp_configure 'Show Advanced Options', 1
GO
RECONFIGURE
GO
sp_configure 'Ad Hoc Distributed Queries', 1
GO
RECONFIGURE
GO 
```

要`sp_configure`使用这两个参数来更改配置选项或运行`RECONFIGURE`语句，您必须被授予`ALTER SETTINGS`服务器级权限

现在您可以从生成的表中选择您的特定列

```
SELECT col1, col2
FROM #temp 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2012-11-09T01:17:13.967

如果您这样做是为了手动验证数据，您可以使用 LINQPad 执行此操作。

在 LinqPad 中创建与数据库的连接，然后创建类似于以下内容的 C# 语句：

```
DataTable table = MyStoredProc (param1, param2).Tables[0];
(from row in table.AsEnumerable()
 select new
 {
  Col1 = row.Field<string>("col1"),
  Col2 = row.Field<string>("col2"),
 }).Dump(); 
```

参考[http://www.global-webnet.net/blogengine/post/2008/09/10/LINQPAD-Using-Stored-Procedures-Accessing-a-DataSet.aspx](http://www.global-webnet.net/blogengine/post/2008/09/10/LINQPAD-Using-Stored-Procedures-Accessing-a-DataSet.aspx)

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2016-02-19T22:55:42.723

对于 SQL Server，我发现这很好用：

创建一个临时表（或永久表，并不重要），并对存储过程执行插入语句。SP 的结果集应该与表中的列匹配，否则会出错。

这是一个例子：

```
DECLARE @temp TABLE (firstname NVARCHAR(30), lastname nvarchar(50));

INSERT INTO @temp EXEC dbo.GetPersonName @param1,@param2;
-- assumption is that dbo.GetPersonName returns a table with firstname / lastname columns

SELECT * FROM @temp; 
```

而已！

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2010-01-05T12:48:12.797

尝试这个

```
use mydatabase
create procedure sp_onetwothree as
select 1 as '1', 2 as '2', 3 as '3'
go
SELECT a.[1], a.[2]
FROM OPENROWSET('SQLOLEDB','myserver';'sa';'mysapass',
    'exec mydatabase.dbo.sp_onetwothree') AS a
GO 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-06-12T07:02:10.410

我知道从 sp 执行并插入临时表或表变量是一种选择，但我认为这不是您的要求。根据您的要求，以下查询语句应该可以工作：

```
Declare @sql nvarchar(max)
Set @sql='SELECT   col1, col2 FROM OPENROWSET(''SQLNCLI'', ''Server=(local);uid=test;pwd=test'',
     ''EXEC MyStoredProc ''''param1'''', ''''param2'''''')'
 Exec(@sql) 
```

如果您有受信任的连接，请使用以下查询语句：

```
Declare @sql nvarchar(max)
Set @sql='SELECT   col1, col2 FROM OPENROWSET(''SQLNCLI'', ''Server=(local);Trusted_Connection=yes;'',
     ''EXEC MyStoredProc ''''param1'''', ''''param2'''''')'
 Exec(@sql) 
```

如果您在运行上述语句时遇到错误，则只需在下面运行此语句：

```
sp_configure 'Show Advanced Options', 1
GO
RECONFIGURE
GO
sp_configure 'Ad Hoc Distributed Queries', 1
GO
RECONFIGURE
GO 
```

我希望这将帮助那些将面临这种类似问题的人。如果有人想尝试使用如下所示的临时表或表变量，但在这种情况下，您应该知道您的 sp 返回了多少列，那么您应该在临时表或表变量中创建那么多列：

```
--for table variable 
Declare @t table(col1 col1Type, col2 col2Type)
insert into @t exec MyStoredProc 'param1', 'param2'
SELECT col1, col2 FROM @t

--for temp table
create table #t(col1 col1Type, col2 col2Type)
insert into #t exec MyStoredProc 'param1', 'param2'
SELECT col1, col2 FROM #t 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-06-07T22:16:44.333

这是一个简单的答案：

```
SELECT ColA, ColB
FROM OPENROWSET('SQLNCLI','server=localhost;trusted_connection=yes;','exec schema.procedurename') 
```

SQLNCLI 是本机 SQL 客户端，“localhost”将使其利用您正在执行该过程的服务器。

无需构建临时表或任何其他爵士乐。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-12-18T12:31:11.217

**创建一个动态视图并从中获取结果.......**

```
CREATE PROCEDURE dbo.usp_userwise_columns_value
(
    @userid BIGINT
)
AS 
BEGIN
        DECLARE @maincmd NVARCHAR(max);
        DECLARE @columnlist NVARCHAR(max);
        DECLARE @columnname VARCHAR(150);
        DECLARE @nickname VARCHAR(50);

        SET @maincmd = '';
        SET @columnname = '';
        SET @columnlist = '';
        SET @nickname = '';

        DECLARE CUR_COLUMNLIST CURSOR FAST_FORWARD
        FOR
            SELECT columnname , nickname
            FROM dbo.v_userwise_columns 
            WHERE userid = @userid

        OPEN CUR_COLUMNLIST
        IF @@ERROR <> 0
            BEGIN
                ROLLBACK
                RETURN
            END   

        FETCH NEXT FROM CUR_COLUMNLIST
        INTO @columnname, @nickname

        WHILE @@FETCH_STATUS = 0
            BEGIN
                SET @columnlist = @columnlist + @columnname + ','

                FETCH NEXT FROM CUR_COLUMNLIST
                INTO @columnname, @nickname
            END
        CLOSE CUR_COLUMNLIST
        DEALLOCATE CUR_COLUMNLIST  

        IF NOT EXISTS (SELECT * FROM sys.views WHERE name = 'v_userwise_columns_value')
            BEGIN
                SET @maincmd = 'CREATE VIEW dbo.v_userwise_columns_value AS SELECT sjoid, CONVERT(BIGINT, ' + CONVERT(VARCHAR(10), @userid) + ') as userid , ' 
                            + CHAR(39) + @nickname + CHAR(39) + ' as nickname, ' 
                            + @columnlist + ' compcode FROM dbo.SJOTran '
            END
        ELSE
            BEGIN
                SET @maincmd = 'ALTER VIEW dbo.v_userwise_columns_value AS SELECT sjoid, CONVERT(BIGINT, ' + CONVERT(VARCHAR(10), @userid) + ') as userid , ' 
                            + CHAR(39) + @nickname + CHAR(39) + ' as nickname, ' 
                            + @columnlist + ' compcode FROM dbo.SJOTran '
            END

        --PRINT @maincmd
        EXECUTE sp_executesql @maincmd
END

-----------------------------------------------
SELECT * FROM dbo.v_userwise_columns_value 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-07-23T14:12:04.733

如果您只需要这样做一次，最简单的方法是：

在导入和导出向导中导出到 excel，然后将此 excel 导入表中。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-01-09T18:29:57.673

对于拥有 SQL 2012 或更高版本的任何人，我都能够使用非动态且每次输出相同列的存储过程来完成此操作。

一般的想法是我构建动态查询来创建、插入、选择和删除临时表，并在它全部生成后执行它。[我通过首先从存储过程中检索列名和类型来](https://stackoverflow.com/a/14575114/2133723)动态生成临时表。

注意：如果您愿意/能够更新 SP 或更改配置并使用`OPENROWSET`. 如果您没有其他方法，请使用以下方法。

```
DECLARE @spName VARCHAR(MAX) = 'MyStoredProc'
DECLARE @tempTableName VARCHAR(MAX) = '#tempTable'

-- might need to update this if your param value is a string and you need to escape quotes
DECLARE @insertCommand VARCHAR(MAX) = 'INSERT INTO ' + @tempTableName + ' EXEC MyStoredProc @param=value'

DECLARE @createTableCommand VARCHAR(MAX)

-- update this to select the columns you want
DECLARE @selectCommand VARCHAR(MAX) = 'SELECT col1, col2 FROM ' + @tempTableName

DECLARE @dropCommand VARCHAR(MAX) = 'DROP TABLE ' + @tempTableName

-- Generate command to create temp table
SELECT @createTableCommand = 'CREATE TABLE ' + @tempTableName + ' (' +
    STUFF
    (
        (
            SELECT ', ' + CONCAT('[', name, ']', ' ', system_type_name)
            FROM sys.dm_exec_describe_first_result_set_for_object
            (
              OBJECT_ID(@spName), 
              NULL
            )
            FOR XML PATH('')
        )
        ,1
        ,1
        ,''
    ) + ')'

EXEC( @createTableCommand + ' '+ @insertCommand + ' ' + @selectCommand + ' ' + @dropCommand) 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-09-16T20:23:09.477

我会剪切并粘贴原始 SP 并删除除您想要的 2 之外的所有列。或者。我会带回结果集，将其映射到适当的业务对象，然后 LINQ 出两列。

# java - java web服务客户端

> ID：209385
> 
> 赞同：1
> 
> 时间：2008-10-16T16:45:14.863
> 
> 标签：java, webservice-client

我有 stfw，但我找不到在 java 中创建 web 服务客户端的简单/独立方法。

有没有人有这个链接/样本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T16:56:42.157

[soapUI](http://www.soapui.org/)是测试 Web 服务的好工具。创建一个服务器存根来测试您的客户端或将客户端请求发送到任何 Web 服务都非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:53:30.680

使用[Axis2](http://ws.apache.org/axis2/)怎么样？

只需按照[快速入门指南](http://ws.apache.org/axis2/1_4_1/quickstartguide.html)进行操作，您就应该开始了。

这是另一个更具描述性的[指南](http://ws.apache.org/axis2/1_0/userguide3.html#Writing_Web_Service_Clients_using_Code_Generation_with_Data_Binding_Support)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T22:25:39.980

最简单的方法之一是使用 apache cxf。[这里](http://cwiki.apache.org/CXF20DOC/how-do-i-develop-a-client.html)有一个很好的文档来创建一个客户端。您将需要 java 5，而不是 1.4！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T16:59:29.640

我想您指的是 SOAP Web 服务？对于通过 HTTP GET 提交请求的 RESTful Web 服务，您实际上只需要一个 Web 浏览器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-27T22:49:48.367

您可以使用 AXIS WSDL2JAVA 从 WSDL 生成客户端存根。

此外，您可以使用 SAAJ 进行编程。

# c# - 使用什么价值？C#（添加表示为字符串的数字）

> ID：209389
> 
> 赞同：3
> 
> 时间：2008-10-16T16:47:27.807
> 
> 标签：c#, algorithm

如果我有一个字符串（010）并且我想向它添加 1（011）我应该使用什么值类型将此字符串转换为一个数字以进行添加，同时保留整数而不是 10 + 1 = 11 .

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T16:50:26.350

你可以使用这样的东西：

```
string initialValue = "010";
int tempValue = Int.Parse(initialValue) + 1;
string newValue = tempValue.ToString("000"); 
```

您像往常一样进行数学运算，然后使用`.ToString()`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T16:49:18.880

```
if (int.TryParse(str, out i))
    str = (i + 1).ToString("000"); 
```

HTH。

（**编辑**：修复了 BoltBait 和 steffenj 指出的问题）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T17:15:48.640

看起来您正在尝试使用编码为字符串的二进制数（嗯。也许在 Visual Studio 中有一个可以放置 Clippy 的地方）。您可以使用 Convert() 方法为您执行此操作。2 用于表示 base-2 格式。如果您需要字符串具有一定的大小，则可能必须添加零填充。

```
string s = "010";
s = Convert.ToString(Convert.ToInt32("010", 2) + 1, 2); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:51:34.460

好吧，您始终可以创建自己的结构，其中包含 int 和所需的输出长度（基于输入长度）。或者只是暂时记住它，如下所示......这取决于你需要多久。

```
string ParseAndAdd(string text, int add)
{
    int parsed = int.Parse(text);
    return (parsed + add).ToString().PadLeft(text.Length, '0');
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T16:52:36.050

```
int value = 10;// or, int value = Convert.ToInt32("010");
value += 1;
string text = value.ToString("000"); 
```

ToString 调用中的“000”称为[格式字符串](http://msdn.microsoft.com/en-us/library/427bttx3.aspx)。它告诉 .net 如何打印出数字。在这种情况下，字符“0”表示对于该位置的数字，如果数字不会显示，则应显示零。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T16:52:51.667

尝试这样的事情：

```
string a = "010";
string b = "1";
a = (int.Parse(a) + int.Parse(b)).ToString(new string('0', Math.Max(a.Length, b.Length)));
Console.WriteLine(a); 
```

这允许处理任意长度的 a 和 b 字符串。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T17:15:54.113

```
string str = "110";
int i = 0;
int maxSize = 3;
if (int.TryParse(str, out i))
{
    str = string.Concat(new string('0', maxSize - (i + 1).ToString().Length), i + 1);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T21:21:57.800

这是我的做法：

```
 public string AddOne (string text)
    {
        int parsed = int.Parse(text);
        string formatString = "{0:D" + text.Length + "}";
        return string.Format(formatString, parsed + 1);
    } 
```

通过将输入文本的长度放入格式字符串中，您可以确保生成的字符串与输入的长度相同。

根据您的需要，您可能需要围绕 int.Parse 进行异常处理。我想我会让异常冒泡，因为 int.Parse 抛出的异常（ArgumentException 或 ArgumentNullException）与我在方法中抛出的异常相同。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T16:50:09.690

是否有可能始终确保存在三位数字？

所以，你会像往常一样做数学，但如果需要，创建一个函数来在前​​面附加额外的零？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T16:54:46.903

它看起来像对字符串的二进制操作，我认为你应该创建一个`BinaryString`应该有内部二进制到十进制转换然后重载等的类`+`，`-`并在里面进行十进制操作。并将结果输出为二进制字符串。

# struts - Struts逻辑标签问题

> ID：209403
> 
> 赞同：1
> 
> 时间：2008-10-16T16:52:54.770
> 
> 标签：struts, logic, tags

我知道这不起作用，但我不知道为什么，我怎样才能使它起作用？

```
 <% int result = referer.indexOf("smlMoverDetail.do"); %>

 <% if (result == -1){%> 
 <%out.print("checking");%>
 <bean:define id="JOININGDATE" name="smlMoverDetailForm"
 property="empFDJoiningDate" type="java.lang.String" toScope="session"/>
 <%}%> 
```

请帮助我不明白

我试过这个

```
<logic:Equal name="result"   value = "-1">
<bean:define id="JOININGDATE" name="smlMoverDetailForm"
 property="empFDJoiningDate" type="java.lang.String" toScope="session"/>
</logic:Equal> 
```

但这确实有效，它不会执行 bean:define 部分

帮忙谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T14:03:45.203

猜猜这只是一个打字错误，但 Equal in

```
<logic:Equal name="result"   value = "-1"> 
```

实际上应该是

```
<logic:equal name="result"   value = "-1"> 
```

这种情况可能是发生错误的原因。

当然，如果您能告诉我们您遇到了什么错误，那将会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T10:24:39.403

如果您说出代码的实际作用，将会有很大帮助。我可以看到您正在尝试做什么，但实际发生了什么？有什么错误吗？它打印出“检查”吗？

# user-interface - 用于轻松同时调整多个控件的 UI

> ID：209407
> 
> 赞同：-1
> 
> 时间：2008-10-16T16:53:37.170
> 
> 标签：user-interface, user-controls, usability, ergonomics

我正在开发一个专业应用程序，最终用户需要同时操作多个控件。该应用程序用于“调整”电子设备的控制参数，以将设备校准到最佳性能。

目前，有一个带有多个图形滑块的 UI，操作员一次单击并拖动一个滑块。他还可以单击一个滑块，并使用鼠标滚轮，这更容易使用。

这有点工作，但有点麻烦。各种参数（在这种特殊情况下为 5 个）彼此充分独立，因此我不能将参数重构为单个调整。而且，如果操作员可以将注意力集中在正在调整的设备上，而不是控制应用程序的 UI 上，它将加快并简化他的工作。

我的一个想法是，我可能会购买一大堆 USB 缓动拨号产品，并将每个拨号绑定到特定的控件。这样，操作员可以快速调整任何参数，甚至可以同时调整两个参数。（顺便说一句，Griffin PowerMate 立即浮现在脑海中，但我知道那里还有其他一些缓动盘。）

你有什么建议吗？

添加：

请记住，在某些情况下，参数会朝不同的方向调整，并且在调整步骤中可能会有显着差异。这不是一个简单的“同时跟踪两个通道，然后微调最后一点差异”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T16:56:53.873

也许捕获按键并将一行对定义为您的上/下控制器。

就像是...

```
A/Z are the up/down keys for slider 1
S/X are the up/down keys for slider 2
D/C are the up/down keys for slider 3
F/V are the up/down keys for slider 4
G/B are the up/down keys for slider 5 
```

ETC...

或者也许只是保持鼠标滚轮进行调整并定义一系列热键来激活（即聚焦）每个滑块控件，这样您就可以用两只手快速切换您正在调整的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T16:57:49.207

每个控件的复选框将一组它们绑定在一起怎么样？然后当他们调整一个时，所有绑定在一起的其他人移动相同的量。提供一个按钮以取消选中它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T20:46:28.743

这是我的一些代码，它是公共领域的，可以适用于这类问题。解释它并不容易，但它已经在期刊上发表过两次。也许你会觉得很有趣：

[http://en.wikipedia.org/wiki/Differential_Execution](http://en.wikipedia.org/wiki/Differential_Execution)

在 sourceforge 上，DynDlgDemo 项目也有工作代码可供开始。

如果你愿意，我可以给你发一份最新文章的副本。

# c# - 为什么必须订阅某人才能发生事件？

> ID：209415
> 
> 赞同：12
> 
> 时间：2008-10-16T16:56:26.307
> 
> 标签：c#, events

代码前的一些文本，以便问题摘要不会被破坏。

```
class Tree
{
    public event EventHandler MadeSound;

    public void Fall() { MadeSound(this, new EventArgs()); }

    static void Main(string[] args)
    {
        Tree oaky = new Tree();
        oaky.Fall();
    }
} 
```

我在 C# 中使用的事件不多，但这会导致 NullRefEx 的事实似乎很奇怪。EventHandler 引用被认为是空的，因为它目前没有订阅者——但这并不意味着事件没有发生，不是吗？

EventHandler 与标准委托的区别在于**event**关键字。为什么语言设计者不让他们在没有订阅者的情况下默默地向虚空开火？（我认为您可以通过显式添加一个空委托手动执行此操作）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T17:01:04.240

好吧，规范形式是：

```
void OnMadeSound()
{
    if (MadeSound != null)
    {
        MadeSound(this, new EventArgs());
    }
}

public void Fall() {  OnMadeSound(); } 
```

这*比*调用空委托要快得多，因此速度胜过编程方便。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T17:08:33.613

我见过的另一种解决此问题的好方法，而不必记住检查 null：

```
class Tree
{
    public event EventHandler MadeSound = delegate {};

    public void Fall() { MadeSound(this, new EventArgs()); }

    static void Main(string[] args)
    {
        Tree oaky = new Tree();
        oaky.Fall();
    }
} 
```

请注意匿名委托 - 可能会对性能造成轻微影响，因此您必须确定哪种方法（检查 null 或空委托）最适合您的情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T23:36:24.940

推荐的模式是（.net 2.0+）

```
public class MyClass
{
    public event EventHandler<EventArgs> MyEvent; // the event

    // protected to allow subclasses to override what happens when event raised.
    protected virtual void OnMyEvent(object sender, EventArgs e)
    {
        // prevent race condition by copying reference locally
        EventHandler<EventArgs> localHandler = MyEvent;
        if (localHandler != null)
        {
            localHandler(sender, e);
        }
    }
    public void SomethingThatGeneratesEvent()
    {
        OnMyEvent(this, EventArgs.Empty);
    }
} 
```

我在初始化程序中看到了很多关于空委托{}的建议，但我完全不同意。如果您遵循上述模式，您只需检查`event != null`一处。空的 delegate{} 初始化程序是一种浪费，因为它是每个事件的额外调用，它浪费内存，并且如果 MyEvent 在我的类的其他地方设置为 null，它仍然会失败。

* 如果你的班级是密封的，你就不会做`OnMyEvent()`虚拟的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T17:03:01.147

很有禅意，嗯？

当你想引发一个事件时，你必须测试 null ：

```
protected void OnMyEvent()
{
    if (this.MyEvent != null) this.MyEvent(this, EventArgs.Empty);
} 
```

如果您不必为此烦恼，那就太好了，但它们是休息时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-16T17:04:52.390

您需要了解您的事件声明实际上在做什么。它同时声明了一个事件和一个变量，当您在类中引用它时，您只是在引用该变量，当没有订阅者时该变量将为空。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-16T17:04:10.473

James 提供了一个很好的技术推理，我还想补充一点，我已经看到人们利用这个优势，如果没有订阅者正在收听事件，他们将采取行动将其记录在代码或类似的东西中。一个简单的例子，但适合这种情况。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-16T17:07:20.480

**如果没有人在听，那么发起事件有什么意义？**从技术上讲，这正是 C# 选择实现它的方式。

在 C# 中，事件是具有一些特殊功能的委托。在这种情况下，委托可以被视为函数指针的链接列表（指向订阅者的处理程序方法）。当您“触发事件”时，依次调用每个函数指针。最初，委托是一个空对象，就像其他任何东西一样。当您为第一个订阅操作执行 += 时，会调用 Delegate.Combine 来实例化列表。（调用 null.Invoke() 会引发 null 异常 - 当事件被触发时。）

如果您仍然觉得“它一定不是”，请使用此处提到的辅助类 EventsHelper 以及旧的和改进的“防御性事件发布” [http://weblogs.asp.net/rosherove/articles/DefensiveEventPublishing.aspx](http://weblogs.asp.net/rosherove/articles/DefensiveEventPublishing.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-08-05T22:59:47.517

在这种情况下，使用扩展方法会很有帮助。

```
public static class EventExtension
{
    public static void RaiseEvent<T>(this EventHandler<T> handler, object obj, T args) where T : EventArgs
    {
        if (handler != null)
        {
            handler(obj, args);
        }
    }
} 
```

然后可以像下面这样使用它。

```
public event EventHandler<YourEventArgs> YourEvent;
...
YourEvent.RaiseEvent(this, new YourEventArgs()); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T18:20:14.577

感谢您的回复。我确实理解为什么会发生 NullReferenceException 以及如何解决它。

> **吉舒说**
> 
> 如果没有人在听，那么发起事件有什么意义？

好吧，也许这是一个术语。在我看来，“事件”系统的吸引力在于，发生的事件后果的所有责任都应该由观察者而不是表演者承担。

* * *

也许更好的问题是：如果委托字段在其前面使用 event 关键字声明，为什么编译器不翻译以下所有实例：

```
MadeSound(this, EventArgs.Empty) 
```

到

```
if (MadeSound != null) { MadeSound(this, EventArgs.Empty); } 
```

以与其他语法快捷方式相同的方式在幕后？人们必须手动编写的样板 OnSomeEvent 空值检查方法的数量必须是巨大的。

# c# - 在 WPF ListView 中，如何防止自动滚动？

> ID：209416
> 
> 赞同：4
> 
> 时间：2008-10-16T16:56:27.023
> 
> 标签：c#, wpf, xaml, listview, scroll

我有一个 WPF ListView，每次单击仅部分可见的项目时，它都会滚动。如何防止控件将该项目滚动到视图中（而不是简单地选择部分可见的项目）？从该控件进行拖动时，此行为非常烦人。

谢谢。

补充：我正在寻找一种解决方案，以在单击控件认为不完全可见的内容时防止控件本身滚动。通常这是几个像素，并且不需要滚动。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T04:33:50.160

项目滚动到视图中，因为单击列表项时的默认行为是调用 BringIntoView()。您可以为 RequestBringIntoView 事件添加一个事件处理程序，并在它从 ListViewItems 冒泡到 ScrollViewer 之前捕获它。在您的处理程序中，根据可见区域检查发送方的边界，如果您决定不需要滚动，请将事件的 Handled 标志设置为 true。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T13:42:33.310

由于我目前在路上，我不能尝试这个，但是您是否尝试过使用 CanContentScroll，和/或将可滚动内容包装到面板中，如[MSDN 上的 ScrollViewer 概述](http://msdn.microsoft.com/en-us/library/ms750665.aspx)所建议的那样？

在最坏的情况下，您可能希望将`ListView`'s替换为[`ItemsPanel`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemspanel.aspx)带有“模糊”因素的黑客 ScrollViewer，例如通过捕获[`RequestBringIntoView`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.requestbringintoview.aspx)事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:39:54.070

你试过[这种方法](http://www.codeproject.com/KB/WPF/DraggableListView.aspx)吗？

只是作为一个插件，我不知道你对这个主题了解多少，但这里是阅读更多关于它[的好地方。](http://www.codeproject.com/KB/WPF/ListViewDragDropManager.aspx)

添加：

我刚刚发现您也可以[防止鼠标滚轮滚动](http://serialseb.blogspot.com/2007/09/wpf-tips-6-preventing-scrollviewer-from.html)。

# javascript - 你使用过哪些 JavaScript 单元测试和模拟框架？

> ID：209418
> 
> 赞同：42
> 
> 时间：2008-10-16T16:56:34.497
> 
> 标签：javascript, jquery, unit-testing, mocking, qunit

我的主要 JavaScript 框架是[jQuery](http://jquery.com/)，所以我希望我的单元测试和模拟框架与它兼容。我宁愿不必介绍另一个 JavaScript 框架。

我目前使用[QUnit](http://docs.jquery.com/QUnit)进行单元测试，使用[Jack](https://github.com/keronsen/jack)进行模拟，但我对 JavaScript 的整个单元测试还是很陌生。

有没有更好的工具可以推荐？什么对你有用？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-10-27T06:35:00.820

我认为 Jack 是撰写本文时最好的 JavaScript 模拟框架。主要原因是适合 JavaScript 的东西不一定适合 Java 这样的强类型语言。

许多 JavaScript 模拟框架都受到 Java 模拟框架的启发（例如优秀的 JsMockito）。但问题在于它们**需要**依赖注入，因为这是在 Java 中使用模拟的唯一合理方法。但是在 JavaScript 中，有*很多*方法可以使用 mocking，而且你不会**被迫**到处使用依赖注入。

例如，使用 JsMockito，您必须制作模拟，然后**将这些模拟传递到**您的被测软件 (SUT)。SUT 必须直接调用模拟。因此，您被迫将 SUT 编码为将其所有依赖项作为参数的构造函数或函数。（有时，这是实现它的好方法，但并非在所有情况下。如果您的模拟框架的设计强制您的实现方法，那么尾巴就会摇摆不定。）

在 JavaScript 中，很容易“劫持”任何函数。因此，有很多方法可以构建一些东西，这样您就可以模拟它的一部分，而无需显式地将其依赖项注入其中。例如，Jack 允许您模拟*任何*函数，无论它是公共的还是本地对象上的。从那里你可以监视它，存根它，或表达对它的期望。关键是：**一旦你模拟了一个函数，*任何*对该原始函数的调用都将被定向到你的 mock**。换句话说，即使调用了原始的、未模拟的函数，你的模拟仍然会被使用。结果，您不会被迫注入依赖项，尽管在需要它的情况下您当然可以这样做。

JavaScript 是与 Java（和 C# 等）不同的语言。它允许不同的实现习惯用法。**[依赖注入](https://en.wikipedia.org/wiki/Dependency_injection)仍然是 JavaScript 工具箱中的一个有价值的工具，但它不再是唯一的游戏。**您的模拟框架需要了解并尊重这一事实。杰克和其他几个人这样做，但在这样做的人中，杰克似乎是最成熟和功能最丰富的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-16T18:22:56.430

[QUnit](http://docs.jquery.com/QUnit)
[jqUnit](http://code.google.com/p/jqunit/)
[使用 QUnit 和 jqUnit 编写 JavaScript 测试](http://wiki.fluidproject.org/display/fluid/Writing+JavaScript+Unit+Tests)

QUnit 是 jQuery JavaScript 框架的单元测试框架。测试框架本身使用 jQuery 库，但是可以为任何 JavaScript 编写测试，并且不需要使用 jQuery 的代码。

jqUnit 是 QUnit 的修改版本，它添加了更典型的 xUnit 框架的 setup、teardown 和 assert 函数，并将所有内容封装在一个全局变量中。

testrunner 页面的可视化界面很好，让您可以深入查看每个测试方法中的每个断言。编写测试相当容易，您可以直接在 testRunner 页面 [8] 上运行测试代码。这允许简单且可见的 DOM 测试。

QUnit：MIT 或 GPL（选择） jqUnit：MIT 许可证

**优点**

*   异步支持
*   适合 DOM 测试
*   测试总是按照它们添加到套件中的顺序依次运行
*   使用 firebug 在测试页面上调试
*   如果使用 jqUnit，语法类似于 JUnit，但如果使用 QUnit，则易于学习

**缺点**

*   自动化将难以实施

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-12-12T23:20:00.410

我不确定为什么没有人提到[JsTestDriver](http://code.google.com/p/js-test-driver/)！如果您在其他语言中使用过单元测试工具，它必须是唯一能够真正像您期望的那样工作的 JavaScript 测试工具之一。

运行测试可以在不接触浏览器的情况下完成，你可以将它与 IDE 集成，你可以将它与持续集成系统集成......哦，它速度很快，并且可以同时在多个浏览器中运行测试。

你也可以使用其他的测试框架，比如 YUITest，让它变得更好。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-16T18:29:29.067

[YUI 测试](http://developer.yahoo.com/yui/yuitest/)
[TDD 与 YUI 测试](http://www.slideshare.net/nzakas/test-driven-development-with-yui-test-presentation)

YUI Test 是[雅虎用户界面](https://en.wikipedia.org/wiki/Yahoo!_UI_Library)(YUI) 库的测试框架。Yahoo 使用它来测试自己的库，并且具有类似于 JUnit 的语法。

与 jsUnit 一样，YUI Test 带有自己的日志控制台，除了每次测试的结果之外，它还可以输出信息、警告和错误。

YUI 还提供了以 JSON 或 XML 格式[发送结果报告](http://developer.yahoo.com/yui/yuitest/#test-reporting)的能力。

YUI Test 是 BSD 许可的。

**优点**

*   非常好的文档
*   活跃的社区
*   定期发布
*   语法类似于 JUnit（测试套件、断言和设置/拆卸）
*   异步支持
*   适合 DOM 测试
*   测试总是按照它们添加到套件中的顺序依次运行

**缺点**

*   自动化实现起来并不简单，但比其他框架更容易实现

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-03-25T17:41:07.487

另请查看 [http://sinonjs.org/](http://sinonjs.org/)

它有测试间谍、测试存根、模拟、假计时器、假[XMLHttpRequest](https://en.wikipedia.org/wiki/XMLHttpRequest) (XHR)、假服务器、沙盒和断言

它确实与 QUnit 一起工作，到目前为止这是一个加分项。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-06-02T23:51:58.810

这是对可用于 JavaScript 的模拟框架的一个很好的回顾：

[http://testdrivenwebsites.com/2010/05/06/java-script-mock-frameworks-comparison](http://testdrivenwebsites.com/2010/05/06/java-script-mock-frameworks-comparison)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-20T10:24:19.513

对于 JavaScript 中的模拟，请查看[qMock](http://code.google.com/p/qmock)，这是我和同事编写的一个框架，用于补充我们对 QUnit 的使用。尽管后者非常适合单元测试，但它不允许非常有效的异步/业务逻辑测试。我们没有将任何版本“标记”为稳定版本，但那里有一些不错的文档，如果您查看 SVN 存储库，您会看到 qmock 本身有其背后的单元测试，这是不言自明的。

哦，为了在构建过程中自动化测试，我们使用了一个简单的 Selenium 脚本来浏览我们的测试套件（每个 JavaScript 文件一个测试页面），并“监听”通过或失败的 CSS 类（由 QUnit 添加）。这也适用于 Internet Explorer 和 Firefox 2、AFAIK。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-30T16:02:28.403

对于 Firefox 开发，我爱上了基于 MozUnit的[UXU ，但它仍然很活跃。](http://www.clear-code.com/software/uxu/index.html.en)它有很好的功能，比如模拟服务器和 sleep / yield 方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-12T23:09:34.020

我使用了Screw Unit 测试框架，并编写了我自己的[名为jsMocha 的模拟库](http://www.kernowsoul.com/page/jsmocha)，该库在我工作的公司中被大量使用了6 个多月。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T17:08:55.550

我知道您在要求兼容 jQuery 的框架，但我想将[script.aculo.us](http://github.com/madrobby/scriptaculous/wikis)加入其中以确保完整性。他们有一个不错的[单元测试套件。](http://github.com/madrobby/scriptaculous/wikis/unit-testing)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-16T18:07:08.020

当我查看 CrossCheck 时，它似乎非常强大，但我们目前还没有将它整合到我们的构建过程中。它具有无浏览器的优势，因此应该在自动化的构建和测试场景中运行良好。

[http://thefrontside.net/crosscheck](http://thefrontside.net/crosscheck)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-16T18:17:22.680

[JsUnit](https://github.com/pivotal/jsunit)可以从浏览器通过其 Eclipse 插件运行，也可以通过 Ant 任务自动运行。您创建了一个带有一堆测试函数的 HTML 页面，这些函数必须以前缀“test”命名，包括您正在测试的 JavaScript 文件。当函数中的任何断言失败时，整个函数都会失败并停止执行。这些测试的运行顺序没有保证。您可以创建`setup()`和`teardown()`功能。

许可证：GPL、GLPL 和 MPL

**优点**

*   自动化相对容易实现
*   很多功能
*   语法类似于 JUnit

**缺点**

*   不太适合 DOM 测试，因为它在 iFrame 中运行测试。
*   不保证测试将按照编写的顺序运行。
*   无法在 testrunner 页面上使用 Firebug。需要使用实际测试代码打开另一个选项卡。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-19T07:38:04.203

我们一直在使用[jsspec](http://jania.pe.kr/aw/moin.cgi/JSSpec)。如果您喜欢 rspec 和[BDD](https://en.wikipedia.org/wiki/Behavior-driven_development) ，那就太好了。我刚刚看到[Justin Gehtland 的一篇](http://blog.thinkrelevance.com/2008/7/31/fully-headless-jsspec)关于使用它“无头”的文章。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-19T07:57:27.393

你可以试试[HtmlUnit](http://htmlunit.sourceforge.net/) ，它在一年前有一个[jQuery 兼容版本。](http://mguillem.wordpress.com/2007/08/17/htmlunit-113-released/)

HtmlUnit 的优点是它不驱动浏览器，所以*速度很快*。

缺点是它没有驱动浏览器，所以有些 JavaScript 东西不起作用。但是抵消了他们可以运行 jQuery 测试，因此 JavaScript 支持可能足以满足您的需要。

# javascript - HTML 标签上的非标准属性。好东西？坏事？你的意见？

> ID：209428
> 
> 赞同：95
> 
> 时间：2008-10-16T16:58:42.917
> 
> 标签：javascript, html, standards

当涉及到标签的非标准属性时，HTML（或者可能只是 XHTML？）相对严格。如果它们不是规范的一部分，那么您的代码将被视为不合规。

然而，非标准属性对于将元数据传递给 Javascript 非常有用。例如，如果假设链接显示弹出窗口，您可以在属性中设置弹出窗口的名称：

```
<a href="#null" class="popup" title="See the Popup!" 
   popup_title="Title for My Popup">click me</a> 
```

或者，您可以将弹出窗口的标题存储在隐藏元素中，例如跨度：

```
<style>
    .popup .title { display: none; }
</style>
<a href="#null" title="See the Popup!" class="popup">
    click me
    <span class="title">Title for My Popup</span>
</a> 
```

然而，我对哪种方法应该是首选方法感到困惑。第一种方法更简洁，而且，我猜，不会像搜索引擎和屏幕阅读器那样搞砸。相反，第二个选项使存储大量数据更容易，因此更通用。它也符合标准。

我很好奇这个社区的想法是什么。你如何处理这样的情况？第一种方法的简单性是否超过了潜在的缺点（如果有的话）？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-16T17:00:38.653

`data-`我是提议的 HTML 5 解决方案（前缀属性）的忠实粉丝。编辑：我要补充一点，使用自定义属性可能有更好的例子。例如，自定义应用程序将使用的数据在标准属性中没有类似物（例如，基于不一定在 className 或 id 中表示的事件处理程序的自定义）。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-09-12T22:25:11.030

自定义属性提供了一种将额外数据传送到客户端的便捷方式。Dojo Toolkit 经常这样做，并且已经指出（[Debunking Dojo Toolkit Myths](http://www.sitepen.com/blog/2008/10/27/debunking-dojo-toolkit-myths/)）指出：

> 自定义属性一直是有效的 HTML，它们只是在针对 DTD 进行测试时不验证。[...] HTML 规范规定，任何无法识别的属性都将被用户代理中的 HTML 渲染引擎忽略，Dojo 可以选择性地利用这一点来提高开发的便利性。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-19T07:01:21.393

另一种选择是在 Javascript 中定义类似这样的内容：

```
<script type="text/javascript">
var link_titles = {link1: "Title 1", link2: "Title 2"};
</script> 
```

然后您可以稍后在您的 Javascript 代码中使用它，假设您的链接的 ID 与此哈希表中的 ID 对应。

它没有其他两种方法的缺点：没有非标准属性，也没有丑陋的隐藏跨度。

缺点是对于像您的示例这样简单的事情可能有点矫枉过正。但对于更复杂的场景，需要传递更多数据，这是一个不错的选择。特别是考虑到数据是作为 JSON 传递的，因此您可以轻松传递复杂的对象。

此外，您将数据与格式分开，这对可维护性是一件好事。

你甚至可以有这样的东西（你不能用其他方法真正做到）：

```
var poi_types = {1: "City", 2: "Restaurant"};
var poi = {1: {lat: X, lng: Y, name: "Beijing", type: 1}, 2: {lat: A, lng: B, name: "Hatsune", type: 2}}; 
```

...

```
<a id="poi-2" href="/poi/2/">Hatsune</a> 
```

而且由于您很可能使用某种服务器端编程语言，因此动态生成此哈希表应该很简单（只需将其序列化为 JSON 并将其放在页面的标题部分）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-19T07:13:09.797

那么在这种情况下，最佳解决方案是

```
<a href="#" alt="" title="Title of My Pop-up">click</a> 
```

并使用标题属性。

如果我真的需要它，有时我会打破规范。但很少，而且只有充分的理由。

编辑：不知道为什么是-1，但我指出有时你认为你需要打破规范，而你却不这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-02-10T14:05:20.667

为什么不在自定义 DTD 中声明 popup_title 属性？这解决了验证问题。我对每个非标准元素、属性和值都执行此操作，感谢此验证仅向我展示了我的代码的真正问题。这也使得此类 HTML 不太可能出现任何浏览器错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-30T11:04:06.903

您可以在锚元素内嵌套隐藏的输入元素

```
<a id="anchor_id">
  <input type="hidden" class="articleid" value="5">
  Link text here
</a> 
```

然后您可以轻松地通过以下方式提取数据

```
$('#anchor_id .articleid').val() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-11T14:23:48.343

最后我的解决方案是在 id 标签中隐藏额外的数据，用某种分隔符分隔（一个下划线是空格，两个是那个 arg 的结尾），第二个 arg 有一个 id：

```
<a href="#" class="article" id="Title_of_My_Pop-up__47">click</a> 
```

丑陋，它假设您还没有将 id 标签用于其他用途，但它在每个浏览器中都是兼容的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-16T17:01:13.160

在您的示例中，我个人的感觉是 span 路由更合适，因为它符合 XHTML 规范的标准。但是，我可以看到自定义属性的参数，但我认为它们增加了不必要的混乱程度。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-08-13T18:03:39.163

我也一直在为此绞尽脑汁。我喜欢非标准属性的可读性，但我不喜欢它会破坏标准。隐藏的 span 示例是兼容的，但它的可读性不是很高。那这个呢：

```
<a href="#" alt="" title="" rel="{popup_title:'Title of My Pop-up'}">click</a> 
```

由于 JSON 的键/值对表示法，这里的代码非常易读。您可以通过查看它来判断这是属于链接的元数据。除了劫持“rel”属性之外，我能看到的唯一缺陷是这对于复杂的对象来说会变得混乱。我真的很喜欢上面提到的“data-”前缀属性的想法。当前的浏览器是否支持此功能？

这是需要考虑的其他事情。不合规的代码对 SEO 有多大影响？

# python - 为什么我在运行其中一个 CherryPy 教程时会收到 ImportError

> ID：209429
> 
> 赞同：1
> 
> 时间：2008-10-16T16:58:43.620
> 
> 标签：python, cherrypy

我已经安装了 CherryPy 3.1.0，。以下是我尝试运行教程 9 时发生的情况：

```
$ cd /Library/Python/2.5/site-packages/cherrypy/tutorial/
$ python tut09_files.py
Traceback (most recent call last):
  File "tut09_files.py", line 48, in <module>
    from cherrypy.lib import static
ImportError: cannot import name static 
```

文件中的上一行：

```
import cherrypy 
```

通过没有错误，所以它似乎可以在路径上找到cherrypy。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T17:16:56.577

这对我有用，而且我也在使用 CherryPy 3.1.0，所以我不知道该告诉你什么。

在 /Library/Python/2.5/site-packages/cherrypy/lib 目录中查找名为 static.py 的文件；如果此文件存在，那么我不知道该告诉您什么。如果没有，那么您的 CherryPy 出现了问题，我建议您重新安装。如果是这样，那么您应该检查 的值`sys.path`以确保它检测到正确版本的 CherryPy。

您也可以尝试在命令行上运行 python 解释器，然后执行 a`from cherrypy.lib import static`以查看是否得到相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-19T13:43:18.863

我的站点包中有一个旧的 CherryPy-2.3.0-py2.5.egg 文件。删除旧的 .egg 后，我可以运行教程。

# java - DevPartner 的 Metric Publisher

> ID：209435
> 
> 赞同：-1
> 
> 时间：2008-10-16T17:00:53.037
> 
> 标签：java, devpartner

我正在使用 DevPartner（用于 Java），结果非常好。但是，有一个我无法使用的“公制发布”实用程序。

问题是所述实用程序（pubmetrics.exe）要求我不知道的站点/端口/用户/密码组合。它使用 localhost 预填充站点/端口数据，因此我假设它正在尝试联系本地 DevPartner，但 DevPartner 没有使用我知道的任何用户和密码。

电子手册也没有多大帮助。有谁知道如何使用该实用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-28T03:16:15.107

Ricardo，PubMetrics 实用程序是 Compuware 产品的一部分，称为 Optimal Delivery Manager。这是一个基于团队的解决方案，将来自 DevPartner、QACenter、Optimal Trace 和其他 CPWR 工具的高级管理输出绑定到 Changepoint 项目管理门户中。DevPartner Java 中的 PubMetrics 实用程序实际上所做的只是从分析器或静态分析会话文件中计算一些派生值，并将这些值作为 XML 文档发布到 Changepoint 报告引擎。如果没有 Optimal Delivery Manager 系统的消息传递主干，仅 PubMetrics 发布者本身就没有真正的用途。希望这可以帮助。-MPS PS。您知道，DevPartner 产品线现在由 Micro Focus 提供。查看[http://www.microfocus.com/products/micro-focus-developer/devpartner/index.aspx](http://www.microfocus.com/products/micro-focus-developer/devpartner/index.aspx)。此外，请认为这是一个无耻的插件，因为我是 Micro Focus 的员工，并且深入参与了 DevPartner 产品线。干杯。

# java - 查看 Jasper 报告执行的 SQL

> ID：209436
> 
> 赞同：8
> 
> 时间：2008-10-16T17:00:58.590
> 
> 标签：java, sql, jasper-reports

在运行将 SQL 嵌入报告文件 (.jrxml) 中的 Jasper 报告时，是否可以看到执行的 SQL？理想情况下，我还希望看到替换每个 $P{} 占位符的值。

干杯，

大学教师

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T17:13:31.310

JasperReports 使用 Jakarta Commons Logging API。Commons Logging 有一个发现机制，可以连接到您在项目中使用的日志记录 API。

您需要在日志记录配置文件中配置名为“net.sf.jasperreports”的记录器来控制 JasperReports 的日志记录级别。

如果您使用的是 Log4j，您可以阅读该文档的[这一部分](http://commons.apache.org/logging/commons-logging-1.1.1/guide.html#Configuring%20Log4J)以了解详细信息。

例如，您可以在 log4j.properties 文件中编写类似这样的内容

log4j.logger.net.sf.jasperreports=信息，每日

其中“每日”是在同一属性文件中配置的附加程序的名称。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T18:27:49.850

另一种选择是使用 p6spy。P6Spy 是一种位于应用程序和真正的 JDBC 驱动程序之间的“代理 JDBC 驱动程序”，它可以记录它看到的所有内容。您应该可以在此处下载副本： [http ://www.p6spy.com/](http://www.p6spy.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T17:07:39.000

如果您使用的是 Ms SQL，您可以使用 sql profiler 来查看服务器上执行的每个查询。

编辑：这是一篇关于在 MySql 服务器上启用 sql 查询日志记录的文章：http: [//www.howtogeek.com/howto/database/monitor-all-sql-queries-in-mysql/](http://www.howtogeek.com/howto/database/monitor-all-sql-queries-in-mysql/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T17:04:28.210

您可以调整 log4j 设置以记录正在运行的 SQL ...

# javascript - 如何防止 jQuery 选择器包含嵌套元素？

> ID：209449
> 
> 赞同：4
> 
> 时间：2008-10-16T17:05:44.667
> 
> 标签：javascript, jquery, html

我是 jQuery 新手，所以希望有一个简单的答案。

我有类似的html：

```
<table id="dataTable">
    <tr> <!-- I want this row -->
        <td>...</td>
    <tr>
    <tr>
        <td>
           <table>
               <tr> <!-- I do not want this row -->
                   <td>...</td>
               </tr>
           </table>
        </td>
    <tr>
</table> 
```

我正在使用与此类似的 jQuery：

```
$("#dataTable tr").length; 
```

我希望长度等于 2，但它返回 3（包括嵌套表中的 <tr>。）我的问题是：如何防止选择第三个 <tr>？

我知道我可以`ignorethisrow`在最后一行添加一个类并将其从我的结果中排除，但我更喜欢一个允许我控制选择引擎搜索*深度的选项。*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T17:07:35.740

我相信语法：

```
$("#dataTable > tr").length 
```

意思是“只是 tr 在下一个级别”。

# concatenation - VHDL中的连接位

> ID：209458
> 
> 赞同：16
> 
> 时间：2008-10-16T17:07:52.493
> 
> 标签：concatenation, vhdl

您如何连接 VHDL 中的位？我正在尝试使用以下代码：

案例 b0 & b1 & b2 & b3 是...

它抛出一个错误

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-16T17:16:38.763

连接运算符 '&' 允许在信号赋值运算符 '<=' 的右侧，仅

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-16T17:23:35.457

以下是连接运算符的示例：

```
architecture EXAMPLE of CONCATENATION is
   signal Z_BUS : bit_vector (3 downto 0);
   signal A_BIT, B_BIT, C_BIT, D_BIT : bit;
begin
   Z_BUS <= A_BIT & B_BIT & C_BIT & D_BIT;
end EXAMPLE; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-12-01T15:08:05.253

不允许在 case 语句中使用连接运算符。一种可能的解决方案是在流程中使用变量：

```
process(b0,b1,b2,b3)
   variable bcat : std_logic_vector(0 to 3);
begin
   bcat := b0 & b1 & b2 & b3;
   case bcat is
      when "0000" => x <= 1;
      when others => x <= 2;
   end case;
end process; 
```

# asp.net - 跟踪间歇性的“对象引用未设置为对象的实例。” 构建错误

> ID：209465
> 
> 赞同：14
> 
> 时间：2008-10-16T17:10:19.557
> 
> 标签：asp.net, visual-studio, compiler-construction

我可以使用一些帮助来尝试追踪我在我们的 ASP.Net 项目中一直存在的间歇性错误。

在构建解决方案时，构建将间歇性地失败，并出现错误“/: Build (web): Object reference not set to an instance of an object”。该错误没有关联的文件、行、列或项目信息。关于该错误的奇怪之处在于，它会在连续重建时消失，并且似乎不会导致我们在构建成功后遇到的任何运行时错误。有时错误只会弹出一次，有时会弹出 3-4 次，但最终构建将成功完成，然后似乎每次构建都很好。我无法确定错误发生的原因和时间，而且由于它总是最终生成，因此对我们来说并不是一个关键问题。只是一个烦恼。但是我想要的一个出于明显的原因而消失了。

我想我应该补充一点，这是一个最初在 ASP.net 1.1 中开发并转换为 2.0 的应用程序，之后我在某个地方继承了它，所以我不知道问题最初是什么时候出现的。就这里的每个人而言，它一直都在那里。

显然，我不希望有人找出我的问题的原因，因为这将要求他们查看我们的整个解决方案以找出潜在的问题。只是希望有人能给我一些关于如何追踪代码中错误的实际来源的新想法。它一定来自某个地方，对吧？你会怎么去找出哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T21:47:43.173

在命令行运行这个命令，看看你是否得到一些更详细的信息

%WINDIR%\Microsoft.NET\Framework\v3.5\msbuild.exe YourSolution.sln /v:n

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T18:12:33.190

当您在包含无效 HTML 的页面中有 Web 控件时，我已经看到了这一点。如果您的代码隐藏试图对控件执行某些操作，它将无法找到它，并且会在编译时为您提供对象引用...错误。根据我的经验，它不会产生运行时错误，并且如果在构建时关闭了相关文件，则项目将构建。HTH，祝你好运！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-06T22:52:10.833

为了解决这个问题，我们从未追查过错误的根源，但是当我们升级到 Visual Studio 2008 并将项目转换为 Web 应用程序时，它就消失了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-02-04T09:19:56.327

我有这个问题很长一段时间，终于找到了一个适合我的解决方案。这对我来说没有意义......但是使用以下内容更改我的 web.config 文件可以彻底消除这个间歇性构建错误：

```
<buildProviders>
    <add extension=".rdlc" type="Microsoft.Reporting.RdlBuildProvider, Microsoft.ReportViewer.Common, Version=9.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
    <!-- add this line below -->
    <remove extension=".rdlc"/> 
 </buildProviders> 
```

希望这有帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-20T12:26:58.313

我在构建时遇到了这个问题，当时我的项目包含自定义数据源（我自己的对象返回集合）和编译错误（也就是说，我的对象有错误）。

如果您尝试添加数据源并且您的项目在项目的根目录中没有任何数据源（例如，如果您已将所有数据源类放在子文件夹中），您也会收到此错误。我找到的唯一解决方案是在项目的根目录中创建一个数据源。

抱歉，不能更准确，但在编译时数据源/对象似乎有几件事可能出错。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T12:47:45.853

我会尝试的第一件事是增加编译器的详细程度。这可以在 Visual Studio 选项中设置 - 例如 VS2005 的“工具->选项->项目和解决方案-构建和运行->MSBuild 项目构建输出详细程度”。如果您将其设置为诊断，那么它至少应该告诉您在引发异常时它在做什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T17:15:52.010

“对象引用未设置为对象的实例”显然是运行时错误，而不是编译时错误。所以这对我说的是，Visual Studio 正在窒息某些东西，这可能不一定在您的代码中，或者您的代码中的某些东西只是间接导致的。

我要问的下一个问题是：这仅在 Visual Studio 中发生，还是在您使用 MSBuild 或 CSC 构建时会出现同样的情况？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T17:16:03.427

真正奇怪的是它是一个运行时错误。你不应该在编译时看到它。您是否有任何附加到解决方案的构建前或构建后步骤？您在“构建”过程中包含的任何单元测试？

这个错误出现在哪里？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T17:22:25.130

检查事件查看器的应用程序日志 - 它应该告诉您异常被抛出的位置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T17:31:36.360

只是为了澄清一下，是编译器本身窒息吗？您是否在代码中使用 #define 和 #if 指令做任何奇怪的事情？也许某些时候某些事情发生了故障......只是一个想法......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-16T17:42:49.257

*   查看是否有任何可能失败的构建后事件。这些可以在每个项目的属性页面上找到。

*   尝试使用重建解决方案而不是构建解决方案。您可能需要从工具 > 自定义添加重建解决方案。如果您的 Web 应用程序安装或注册了任何 Windows 服务，并且这些服务已启动，那么 Rebuilding 会解决这些类型的问题。

# python - 如何在 Python 中实现常见的 bash 习语？

> ID：209470
> 
> 赞同：242
> 
> 时间：2008-10-16T17:11:37.680
> 
> 标签：python, bash, shell

我目前通过一堆记不太清的 AWK、sed、Bash 和一点点 Perl 来处理我的文本文件。

我已经看到一些地方提到 python 对这种事情有好处。如何使用 Python 替换 shell 脚本、AWK、sed 和朋友？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2008-10-16T17:41:44.890

任何 shell 都有几组特性。

*   基本 Linux/Unix 命令。所有这些都可以通过[子流程](https://docs.python.org/3/library/subprocess.html)库获得。*这并不总是执行所有*外部命令的最佳首选。还可以在[shutil](https://docs.python.org/3/library/shutil.html)中查看一些单独的Linux 命令，但您可能可以直接在Python 脚本中实现。[os](https://docs.python.org/3/library/os.html)库中还有一大堆 Linux 命令；您可以在 Python 中更简单地完成这些操作。

    还有——奖金！ - 更快速。shell 中的每个单独的 Linux 命令（除了少数例外）都会派生一个子进程。通过使用 Python`shutil`和`os`模块，您无需创建子进程。

*   shell 环境特性。这包括设置命令环境的东西（当前目录和环境变量等等）。您可以直接从 Python 轻松管理它。

*   Shell 编程功能。这是所有进程状态代码检查、各种逻辑命令（if、while、for 等）、测试命令及其所有相关命令。函数定义的东西。这在 Python 中要容易得多。这是摆脱 bash 并在 Python 中实现的巨大胜利之一。

*   交互功能。这包括命令历史记录和其他内容。您不需要它来编写 shell 脚本。这仅用于人机交互，不适用于脚本编写。

*   shell 文件管理功能。这包括重定向和管道。这更棘手。其中大部分可以通过子流程完成。但是一些在 shell 中容易做的事情在 Python 中是不愉快的。特别像`(a | b; c ) | something >result`. 这将并行运行两个进程（输出`a`作为 的输入`b`），然后是第三个进程。该序列的输出与并行运行，`something`并将输出收集到一个名为`result`. 用任何其他语言来表达都是很复杂的。

特定程序（awk、sed、grep 等）通常可以重写为 Python 模块。不要过火。替换您需要的并改进您的“grep”模块。不要一开始就编写一个 Python 模块来代替“grep”。

最好的事情是您可以分步执行此操作。

1.  用 Python 替换 AWK 和 PERL。别管其他一切。
2.  看看用 Python 替换 GREP。这可能有点复杂，但您的 GREP 版本可以根据您的处理需求进行定制。
3.  查看将 FIND 替换为使用`os.walk`. 这是一个巨大的胜利，因为您不会产生尽可能多的进程。
4.  看看用 Python 脚本替换常见的 shell 逻辑（循环、决策等）。

* * *

## 回答 #2

> 赞同：103
> 
> 时间：2012-10-16T13:37:46.483

是的当然 ：）

看看这些库，它们可以帮助您***再也不要编写 shell 脚本***（Plumbum 的座右铭）。

*   [铅](http://plumbum.readthedocs.org/en/latest/)
*   [中士](https://bitbucket.org/vinay.sajip/sarge/)
*   [嘘](http://amoffat.github.com/sh/)

另外，如果你想用基于 Python 的东西替换 awk、sed 和 grep，那么我推荐[pyp](http://pyvideo.org/video/686/the-pyed-piper-a-modern-python-alternative-to-aw) -

> “The Pyed Piper”，或 pyp，是一个类似于 awk 或 sed 的 linux 命令行文本操作工具，但它使用标准的 python 字符串和列表方法以及演变为在密集的生产环境中生成快速结果的自定义函数。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2013-03-29T22:49:18.107

我刚刚发现了如何结合 bash 和 ipython 的最佳部分。到目前为止，这对我来说似乎比使用 subprocess 等更舒服。您可以轻松地复制现有 bash 脚本的大部分内容，例如以 python 方式添加错误处理:) 这是我的结果：

```
#!/usr/bin/env ipython3

# *** How to have the most comfort scripting experience of your life ***
# ######################################################################
#
# … by using ipython for scripting combined with subcommands from bash!
#
# 1\. echo "#!/usr/bin/env ipython3" > scriptname.ipy    # creates new ipy-file
#
# 2\. chmod +x scriptname.ipy                            # make in executable
#
# 3\. starting with line 2, write normal python or do some of
#    the ! magic of ipython, so that you can use unix commands
#    within python and even assign their output to a variable via
#    var = !cmd1 | cmd2 | cmd3                          # enjoy ;)
#
# 4\. run via ./scriptname.ipy - if it fails with recognizing % and !
#    but parses raw python fine, please check again for the .ipy suffix

# ugly example, please go and find more in the wild
files = !ls *.* | grep "y"
for file in files:
  !echo $file | grep "p"
# sorry for this nonsense example ;) 
```

[请参阅有关系统 shell 命令](https://ipython.readthedocs.io/en/stable/interactive/tutorial.html#system-shell-commands)并将其[用作系统 shell 的](https://ipython.readthedocs.io/en/stable/interactive/shell.html)IPython 文档。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2015-06-03T10:08:43.290

截至 2015 年和 Python 3.4 的发布，现在有一个相当完整的用户交互式 shell 可用：http: [//xon.sh/](http://xon.sh/)或[https://github.com/scopatz/xonsh](https://github.com/scopatz/xonsh/)

[演示视频](http://xon.sh/_static/xonsh-demo.webm)没有显示正在使用的管道，但在默认 shell 模式下它们是受支持的。

Xonsh ('conch') 非常努力地模仿 bash，所以你已经获得了肌肉记忆的东西，比如

```
env | uniq | sort -r | grep PATH 
```

或者

```
my-web-server 2>&1 | my-log-sorter 
```

仍然可以正常工作。

该教程非常冗长，似乎涵盖了人们通常在 ash 或 bash 提示符下期望的大量功能：

*   编译、评估和执行！
*   命令历史和选项卡完成
*   帮助和超级帮助`?`&`??`
*   别名和自定义提示
*   `*.xsh`执行也可以导入的命令和/或脚本
*   环境变量，包括查找`${}`
*   输入/输出重定向和组合
*   后台作业和作业控制
*   嵌套子进程、管道和协进程
*   存在命令时为子进程模式，否则为 Python 模式
*   捕获的子进程`$()`，未捕获的子进程`$[]`，Python 评估`@()`
*   带有反引号的文件名通配符`*`或正则表达式文件名通配符

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-10-16T18:16:52.290

*   如果你想使用 Python 作为 shell，为什么不看看[IPython](http://ipython.org/)呢？以交互方式学习语言也很好。
*   如果你做了大量的文本操作，并且如果你使用 Vim 作为文本编辑器，你也可以直接在 python 中为 Vim 编写插件。只需在 Vim 中输入 ":help python" 并按照说明进行操作或查看此[演示文稿](http://www.tummy.com/Community/Presentations/vimpython-20070225/vim.html)。编写将直接在编辑器中使用的函数非常简单和强大！

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-10-16T20:58:33.977

一开始有 sh、sed 和 awk（还有 find、grep 和...）。这很好。但是 awk 可能是一个奇怪的小野兽，如果你不经常使用它就很难记住它。然后大骆驼创造了 Perl。Perl 是系统管理员的梦想。这就像类固醇上的 shell 脚本。包括正则表达式在内的文本处理只是语言的一部分。然后它变得丑陋了……人们试图用 Perl 来制作大型应用程序。现在，不要误会我的意思，Perl 可以是一个应用程序，但如果你不小心的话，它可能（可以！）看起来像一团糟。然后就是所有这些平面数据业务。这足以让程序员发疯。

输入 Python、Ruby 等。这些确实是非常好的通用语言。它们支持文本处理，并且做得很好（尽管可能没有紧密地缠绕在语言的基本核心中）。但是它们也可以很好地扩展，并且在一天结束时仍然有漂亮的代码。他们还开发了相当庞大的社区，其中包含大量的图书馆，几乎可以满足任何需求。

现在，对 Perl 的很多负面看法都是见仁见智的，当然有些人可以编写非常干净的 Perl，但是有这么多人抱怨创建混淆代码太容易了，你知道其中有一些真相。那么问题就真的变成了，你是否会使用这种语言来代替简单的 bash 脚本。如果没有，请学习更多 Perl .. 这绝对是太棒了。另一方面，如果您想要一门可以随着您做更多事情而与您一起成长的语言，我建议您使用 Python 或 Ruby。

不管怎样，祝你好运！

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-16T17:40:43.050

我建议很棒的在线书籍*[Dive Into Python](http://www.diveintopython.net)*。这就是我最初学习语言的方式。

除了教你语言的基本结构和大量有用的数据结构之外，它还有一个关于[文件处理的好章节和关于](http://www.diveintopython.net/file_handling/index.html)[正则表达式](http://www.diveintopython.net/regular_expressions/index.html)的后续章节等等。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-16T22:05:19.617

添加到以前的答案：检查[pexpect](http://www.noah.org/wiki/Pexpect)模块以处理交互式命令（adduser、passwd 等）

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-05-24T01:23:24.253

我喜欢 Python 的一个原因是它比 POSIX 工具更标准化。我必须双重和三重检查每个位是否与其他操作系统兼容。在 Linux 系统上编写的程序在 OSX 的 BSD 系统上可能无法正常工作。使用 Python，我只需要检查目标系统是否具有足够现代的 Python 版本。

更好的是，用标准 Python 编写的程序甚至可以在 Windows 上运行！

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-12-01T14:40:14.067

我将根据经验在这里给出我的意见：

对于外壳：

*   shell 可以很容易地生成只读代码。写下来，当你回到它时，你永远不会再弄清楚你做了什么。很容易做到这一点。
*   shell 可以用管道在一行中进行大量的文本处理、拆分等。
*   在集成不同编程语言的程序调用时，它是最好的胶水语言。

对于蟒蛇：

*   如果您希望包含 Windows 的可移植性，请使用 python。
*   当您必须操作的不仅仅是文本（例如数字集合）时，python 会更好。为此，我推荐python。

我通常为大多数事情选择 bash，但是当我有一些必须跨越 Windows 边界的东西时，我只使用 python。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-09-13T05:55:20.460

[pythonpy](http://github.com/russell91/pythonpy)是一个工具，可以轻松访问 awk 和 sed 的许多功能，但使用 python 语法：

```
$ echo me2 | py -x 're.sub("me", "you", x)'
you2 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-16T21:49:19.400

我已经构建了半长的 shell 脚本（300-500 行）和具有类似功能的 Python 代码。当执行许多外部命令时，我发现 shell 更易于使用。当有大量文本操作时，Perl 也是一个不错的选择。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-10-03T20:21:33.967

在研究这个主题时，我发现[了这个概念验证代码](http://hg.mozilla.org/users/tmielczarek_mozilla.com/pyshell/file/tip/shell.py)（通过[http://jlebar.com/2010/2/1/Replacing_Bash.html](http://jlebar.com/2010/2/1/Replacing_Bash.html)上的评论），它可以让您“使用 Python 编写类似 shell 的管道”简洁的语法，并在有意义的地方利用现有的系统工具”：

```
for line in sh("cat /tmp/junk2") | cut(d=',',f=1) | 'sort' | uniq:
    sys.stdout.write(line) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-16T18:14:48.740

您最好的选择是专门针对您的问题的工具。如果它处理文本文件，那么 Sed、Awk 和 Perl 是最有力的竞争者。Python 是一种通用的*动态*语言。与任何通用语言一样，支持文件操作，但这不是它的核心目的。如果我特别需要动态语言，我会考虑使用 Python 或 Ruby。

简而言之，学习 Sed 和 Awk 非常好，再加上你的 *nix 风格的所有其他好东西（所有 Bash 内置插件、grep、tr 等等）。如果您感兴趣的是文本文件处理，那么您已经在使用正确的东西了。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-02-16T21:23:04.500

[您可以在ShellPy](https://github.com/lamerman/shellpy)库中使用 python 而不是 bash 。

下面是一个从 Github 下载 Python 用户头像的例子：

```
import json
import os
import tempfile

# get the api answer with curl
answer = `curl https://api.github.com/users/python
# syntactic sugar for checking returncode of executed process for zero
if answer:
    answer_json = json.loads(answer.stdout)
    avatar_url = answer_json['avatar_url']

    destination = os.path.join(tempfile.gettempdir(), 'python.png')

    # execute curl once again, this time to get the image
    result = `curl {avatar_url} > {destination}
    if result:
        # if there were no problems show the file
        p`ls -l {destination}
    else:
        print('Failed to download avatar')

    print('Avatar downloaded')
else:
    print('Failed to access github api') 
```

如您所见，重音符 ( ` ) 符号内的所有表达式都在 shell 中执行。在 Python 代码中，您可以捕获此执行的结果并对其执行操作。例如：

```
log = `git log --pretty=oneline --grep='Create' 
```

此行将首先`git log --pretty=oneline --grep='Create'`在 shell 中执行，然后将结果分配给 log 变量。结果具有以下属性：

**stdout**来自已执行进程的标准输出的整个文本

**stderr**来自已执行进程的 stderr 的整个文本

**returncode**执行的返回码

这是该库的一般概述，可以在[此处](https://github.com/lamerman/shellpy)找到带有示例的更详细说明。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-16T17:42:48.397

如果你的文本文件操作通常是一次性的，可能在 shell 提示下完成，你不会从 python 中得到更好的东西。

另一方面，如果您通常必须一遍又一遍地执行相同（或类似）的任务，并且您必须为此编写脚本，那么 python 很棒 - 您可以轻松创建自己的库（您可以也可以使用 shell 脚本，但更麻烦）。

一个很简单的例子来感受一下。

```
import popen2
stdout_text, stdin_text=popen2.popen2("your-shell-command-here")
for line in stdout_text:
  if line.startswith("#"):
    pass
  else
    jobID=int(line.split(",")[0].split()[1].lstrip("<").rstrip(">"))
    # do something with jobID 
```

还要检查 sys 和 getopt 模块，它们是您首先需要的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-01-10T21:14:27.067

我在 PyPI 上发布了一个包：[ez](https://pypi.python.org/pypi/ez)。
用来`pip install ez`安装它。

它在 shell 中打包了常用命令，而且我的 lib 使用与 shell 基本相同的语法。例如，cp(source, destination) 可以同时处理文件和文件夹！（shutil.copy shutil.copytree 的包装器，它决定何时使用哪一个）。更好的是，它可以支持像 R 一样的矢量化！

另一个例子：没有 os.walk，使用 fls(path, regex) 递归查找文件并使用正则表达式进行过滤，它返回带有或不带有完整路径的文件列表

最后一个示例：您可以将它们组合起来编写非常简单的脚本：
`files = fls('.','py$'); cp(files, myDir)`

一定要看看！我花了数百个小时来编写/改进它！

# ruby-on-rails - 我可以用鸭子打字改进这种方法吗？

> ID：209478
> 
> 赞同：5
> 
> 时间：2008-10-16T17:15:38.843
> 
> 标签：ruby-on-rails, ruby, refactoring, duck-typing

希望我没有误解“鸭子类型”的含义，但从我所读到的，这意味着我应该根据对象如何响应方法而不是它是什么类型/类来编写代码。

这是代码：

```
def convert_hash(hash)
  if hash.keys.all? { |k| k.is_a?(Integer) }
    return hash
  elsif hash.keys.all? { |k| k.is_a?(Property) }
    new_hash = {}
    hash.each_pair {|k,v| new_hash[k.id] = v}
    return new_hash
  else
    raise "Custom attribute keys should be ID's or Property objects"
  end
end 
```

我想要的是确保我最终得到一个散列，其中键是一个整数，表示 ActiveRecord 对象的 ID。我不是特别喜欢必须遍历哈希键两次`all?`以确定是否需要取出 ID。

当然，我也会接受任何其他改进此代码的建议 :)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-16T17:32:52.147

如何编写此方法应取决于您是否期望在正常程序执行过程中引发异常。如果您想要一个可读的异常消息，因为最终用户可能会看到它，那么手动抛出一个是有意义的。否则，我会做这样的事情：

```
def convert(hash)
    new_hash = {}
    hash.each_pair { |k,v| new_hash[ k.is_a?(Integer) ? k : k.id ] = v }
    return new_hash
end 
```

这将完成完全相同的事情，如果数组键没有 id 字段，您仍然会收到异常。更好的是，这使用了更多的鸭子类型，因为现在任何具有 id 字段的东西都是可以接受的，这比显式检查某个属性是否更好。这使您的代码更加灵活，尤其是在单元测试时。

我们仍然对整数对象进行显式检查，但这种偶尔出现的特殊情况通常是可以接受的，尤其是在检查内置数据类型时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T17:59:09.363

鸭子类型实际上只是多态性的细微差别。在像 Java 这样的静态类型语言中，您必须创建一个显式接口，告诉编译器特定变量可以接受的所有方法。对于像 Ruby 这样的动态语言，接口仍然以抽象的方式存在，它们只是隐含的。

问题是您在一种方法中接受两种不同的数据结构。使鸭子类型起作用的方法是要求传递给您的方法的所有对象都遵守相同的约定（即，它始终是整数到 [Foo] 对象的哈希值。）将带有属性键的哈希值转换为正确的结构应该是客户端代码的工作。这可以通过一个简单的包装类或仅由 elseif 子句的主体组成的转换函数来轻松完成。

归根结底，这取决于调用该方法的人，以确保他的参数都按照您的方法期望它们发出的嘎嘎声。如果他们不这样做，他就是需要弄清楚如何让他的火鸡像鸭子一样嘎嘎叫的人，而不是你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T11:31:27.727

> 我想要的是确保我最终得到一个散列，其中键是一个整数，表示 ActiveRecord 对象的 ID。

当您创建/插入哈希时，您可能应该检查一下。你可以尝试这样的事情：

```
h = {}
def h.put 对象
  自我[obj.id]=obj
结尾

```

或许

```
h = {}
def h.[]= 键，值
  引发“地狱”，除非 key == value.id
  极好的
结尾

```

# python - 如何做 python 命令行自动完成，但不仅仅是在字符串的开头

> ID：209484
> 
> 赞同：7
> 
> 时间：2008-10-16T17:16:34.097
> 
> 标签：python, linux, unix, command-line, autocomplete

Python，通过它的 readline 绑定允许很好的命令行自动完成（如[这里](https://stackoverflow.com/questions/187621/how-to-make-a-python-command-line-program-autocomplete-arbitrary-things-not-int)所述）。

但是，完成似乎只在字符串的开头起作用。如果要匹配字符串的中间或结尾，则 readline 不起作用。

我想在命令行 python 程序中通过将我键入的内容与可用字符串列表中的任何字符串匹配来自动完成字符串。

*   我想要的自动完成类型的一个很好的例子是当您在 To 字段中键入时在 GMail 中发生的类型。如果您输入其中一个联系人的姓氏，它就会出现，就像您输入她的名字一样。
*   可能需要使用向上和向下箭头或其他方法从匹配的字符串中进行选择（在 readline 的情况下不需要），这在我的情况下很好。
*   我的特定用例是一个发送电子邮件的命令行程序。
*   具体的代码示例将非常有帮助。

使用像 curses 这样的终端模拟器就可以了。它只需要在 linux 上运行，而不是 Mac 或 Windows。

这是一个示例：假设我在列表中有以下三个字符串

```
['Paul Eden <paul@domain.com>', 
'Eden Jones <ejones@domain.com>', 
'Somebody Else <somebody@domain.com>'] 
```

我想要一些代码，在我键入“Eden”后自动完成列表中的前两项，然后允许我选择其中一项（全部通过使用键盘的命令行）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T17:23:34.677

我不确定我是否理解这个问题。您可以使用 readline.clear_history 和 readline.add_history 来设置您想要的可完成字符串，然后使用 control-r 在历史记录中搜索 backword（就像您在 shell 提示符下一样）。例如：

```
#!/usr/bin/env python

import readline

readline.clear_history()
readline.add_history('foo')
readline.add_history('bar')

while 1:
    print raw_input('> ') 
```

或者，您可以编写自己的完整版本并将适当的密钥绑定到它。此版本使用缓存以防您的匹配列表很大：

```
#!/usr/bin/env python

import readline

values = ['Paul Eden <paul@domain.com>', 
          'Eden Jones <ejones@domain.com>', 
          'Somebody Else <somebody@domain.com>']
completions = {}

def completer(text, state):
    try:
        matches = completions[text]
    except KeyError:
        matches = [value for value in values
                   if text.upper() in value.upper()]
        completions[text] = matches
    try:
        return matches[state]
    except IndexError:
        return None

readline.set_completer(completer)
readline.parse_and_bind('tab: menu-complete')

while 1:
    a = raw_input('> ')
    print 'said:', a 
```

# css - 带有 cfinput type="datefield" 的 CSS 渗透

> ID：209491
> 
> 赞同：2
> 
> 时间：2008-10-16T17:17:27.217
> 
> 标签：css, coldfusion, internet-explorer-7, cfform, cfinput

我有一个使用多个`<cfinput type="datefield" ...>`. 它们的位置使得弹出的 CSS 日历应该出现在其他人的字段上。但是，其他日期的文本字段最终位于日历前面。

这只是一个 IE 问题，因为 Firefox 和 Safari 运行良好。

是否有一个简单的 CSS hack 或其他一些简单的事情可以让日历正常运行？重新排列表格不是很有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T13:51:57.007

好吧，你必须用 position:relative 和 Z-index 值封装你的日期字段，如：

```
<div style="position:relative; z-index:3">
<cfinput type="dateField" name="info_dateDebutPub" value="#dateformat(info_dateDebutPub,'dd/mm/yy')#" mask="dd/mm/yy">
</div> 
```

在 Cfinput 中定义 Z-index 将不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T17:37:03.990

IE6 的 z-index 和某些类型的控件存在问题。试试这个：[http ://brandonaaron.net/jquery/plugins/bgiframe/docs/](http://brandonaaron.net/jquery/plugins/bgiframe/docs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:24:15.897

我的第一个倾向是尝试为具有负 z-index 的文本字段添加样式。或者，您可以尝试将正 z-index 应用于弹出窗口。

考虑到弹出窗口是动态编写的，第一个可能会更容易——CF 将任何无法识别或未使用的属性传递给浏览器，因此您只需添加一个样式。就像是：

```
<cfinput type="datefiled" name="bob" value="" style="z-index: -1;"> 
```

未测试，YYMV。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-01T11:42:21.640

在你的 CSS 中试试这个，

对于带有 cfinput 字段的 DIV

```
position:relative;z-index:0 
```

日历

```
position:absolute;z-index:1 
```

# java - Struts ActionForm 属性应该是什么类型？

> ID：209493
> 
> 赞同：6
> 
> 时间：2008-10-16T17:19:39.083
> 
> 标签：java, struts, design-patterns, anti-patterns

我使用 Struts 1.2.4 继承了这个巨大的遗留 Java Web 应用程序。我有一个关于 ActionForms 的具体问题。其中一些只有字符串属性（即使是数字），其中一些使用看似合适的类型（整数、日期、字符串等）。这里的最佳做法是什么？

此外，如果一个属性是整数类型，并且用户输入的值不是整数值，Struts 会默默地接受它，只是不设置属性。这是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T17:35:40.877

对于 Struts 1.2x，用户在 HTML 表单上输入或选择值以及由 Struts HTML 标记自动填充到 ActionForm 实例上的属性必须是字符串或布尔值。但是，您的 ActionForm 没有理由不能使用 getter 方法将属性作为对您的应用程序更有意义的类型返回，例如 Date。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T17:49:48.383

如果您想自己进行一些验证（或使用在 1.2 之后从 struts 中重构出来的 struts 验证器功能），您将需要 String 属性，原因正是您引用的：一旦您将数值存储在 Integer 或 int 值中，它们*必须*是数字或“根本没有” - 否则：您如何将“很多”（字面意思）存储在 Integer 属性中？

客户端验证（例如在 Javascript 中）仍然可以工作，但您不想依赖它。

如果 - 在输入无效数字时 - 您可以接受为用户提供的空白字段，您可以将值存储在 Date-、Integer-、Whatever-Properties 中。如果您想在错误消息中显示原始值，则需要 String 属性。

这具有您需要手动进行转换的价格。由于 Struts 1.2 已经很老了，您可能需要考虑逐渐用更现代的技术替换您的应用程序基础架构，并同时在两种技术（旧的和新的）上运行一段时间，直到旧的部分变得足够小（或不重要）足够）被丢弃。

nb - 您还可以更好地控制要接受哪些值作为数字。我还记得一个旧的 Struts 信用卡银行应用程序，在该应用程序中，我问我的经理，当您想从卡中提取 3e2 欧元时，预期的结果是什么。他们没有说 300（因为 Struts 已转换），而是选择了一个错误。

# ruby - “零或零”的最佳红宝石成语

> ID：209495
> 
> 赞同：83
> 
> 时间：2008-10-16T17:19:55.043
> 
> 标签：ruby, design-patterns, idioms, null

我正在寻找一种简洁的方法来检查一个值，看看它是零还是零。目前我正在做类似的事情：

```
if (!val || val == 0)
  # Is nil or zero
end 
```

但这似乎很笨拙。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-16T18:55:03.510

对象[*有零？*方法](http://ruby-doc.org/core/Object.html#method-i-nil-3F)。

```
if val.nil? || val == 0
  [do something]
end 
```

或者，仅针对一条指令：

```
[do something] if val.nil? || val == 0 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-11-07T19:18:04.737

如果您真的喜欢末尾带有问号的方法名称：

```
 if val.nil? || val.zero?
  # do stuff
end 

```

您的解决方案很好，其他一些解决方案也很好。

如果你不小心的话，Ruby 可以让你寻找一种漂亮的方式来做任何事情。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2016-01-15T20:55:57.410

从 Ruby 2.3.0 开始，您可以将安全导航运算符 ( `&.`) 与[`Numeric#nonzero?`](http://ruby-doc.org/core-2.3.0/Numeric.html#method-i-nonzero-3F). 如果实例是并且- 如果数字是，则`&.`返回：`nil``nil``nonzero?``0`

```
unless val&.nonzero?
  # Is nil or zero
end 
```

或后缀：

```
do_something unless val&.nonzero? 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2008-10-16T17:35:04.280

首先，我认为这是检查特定条件的最简洁方法。

其次，对我来说，这是一种代码异味，表明您的设计存在潜在缺陷。一般来说，零和零不应该意味着同样的事情。如果可能，您应该尝试在点击此代码之前消除 val 为 nil 的可能性，方法是在方法的开头检查它或其他一些机制。

您可能有完全正当的理由这样做，在这种情况下，我认为您的代码很好，但我至少会考虑尽可能摆脱 nil 检查。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-16T17:45:23.353

你可以使用 Object.nil 吗？专门测试 nil （而不是陷入 false 和 nil 之间）。您也可以将方法修补到 Object 中。

```
class Object
   def nil_or_zero?
     return (self.nil? or self == 0)
   end
end

my_object = MyClass.new
my_object.nil_or_zero?
==> false 
```

不建议这样做，因为同事很难跟踪对 Object 的更改，并且可能会使您的代码对其他人无法预测。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-11-06T19:49:24.073

nil.to_i 返回零，所以我经常这样做：

```
val.to_i.zero? 
```

但是，如果 val 曾经是一个不响应 #to_i 的对象，则会出现异常。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-16T17:30:59.887

我相信您的代码不正确；它实际上会测试三个值：`nil`、**`false`**和零。这是因为`!val`表达式对于所有为假的值都为真，在 Ruby 中是`nil`and `false`。

我现在能想到的最好的就是

```
if val == nil || val == 0
  # do stuff
end 
```

这当然不是很聪明，但（非常）清楚。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-09-11T10:52:37.673

我的解决方案还使用细化，减去条件。

```
module Nothingness
  refine Numeric do
    alias_method :nothing?, :zero?
  end

  refine NilClass do
    alias_method :nothing?, :nil?
  end
end

using Nothingness

if val.nothing?
  # Do something
end 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-16T17:46:16.800

Rails 通过属性查询方法做到这一点，除了 false 和 nil 之外，0 和 "" 也计算为 false。

```
if (model.attribute?) # => false if attribute is 0 and model is an ActiveRecord::Base derivation 
```

然而，它也有批评者的份额。[http://www.joegrossberg.com/archives/002995.html](http://www.joegrossberg.com/archives/002995.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-20T04:54:33.907

为了尽可能地道，我建议这样做。

```
if val.nil? or val == 0
    # Do something
end 
```

因为：

*   它使用零？方法。
*   它使用“或”运算符，比 || 更可取。
*   它不使用括号，在这种情况下这不是必需的。括号只能在它们用于某些目的时使用，例如覆盖某些运算符的优先级。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-10-15T20:25:20.027

简短而清晰

`[0, nil].include?(val)`

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-10-27T18:32:20.267

最短和最好的方法应该是

```
if val&.>(0)
  # do something
end 
```

因为`val&.>(0)` 当 val 为 nil 时它返回 nil，因为 > 基本上也是一个方法，在 ruby​​ 中 nil 等于 false。时返回 false `val == 0`。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-16T21:31:35.970

我通过定义一个“是？”来处理这个问题。方法，然后我可以在各种类上以不同的方式实现。所以对于 Array，“是？” 表示“大小>0”；对于 Fixnum，它的意思是“自我！= 0”；对于字符串，它的意思是“自我！=''”。NilClass 当然定义了“是？” 就像返回零一样。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-25T23:44:59.747

`case`如果你喜欢，你可以使用：

```
 case val with nil, 0
      # do stuff
 end 
```

然后你可以使用任何与 一起工作的东西`===`，这有时很好。或者做这样的事情：

```
not_valid = nil, 0
case val1 with *not_valid
      # do stuff
 end
 #do other stuff
 case val2 with *not_valid, false    #Test for values that is nil, 0 or false
      # do other other stuff
 end 
```

它不是完全好的 OOP，但它非常灵活并且有效。无论如何，我`if`的 s 通常以 s 结尾。`case`

当然`Enum.any?`/`Enum.include?`也可以工作......如果你想变得非常神秘：

```
if [0, nil].include? val
    #do stuff
end 
```

正确的做法当然是定义一个方法或函数。或者，如果您必须对许多值执行相同的操作，请结合使用这些不错的迭代器。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-02-13T14:31:31.587

我真的很喜欢 Rails方法来处理这类事情，`blank?`但它不会返回`true`. `0`所以你可以添加你的方法：

```
def nil_zero? 
  if respond_to?(:zero?) 
    zero? 
  else 
    !self 
  end 
end 
```

它会检查某个值是 nil 还是 0：

```
nil.nil_zero?
=> true
0.nil_zero?
=> true
10.nil_zero?
=> false

if val.nil_zero?
  #...
end 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-09-25T16:32:52.407

这非常简洁：

```
if (val || 0) == 0
  # Is nil, false, or zero.
end 
```

只要您不介意`false`将`nil`. 在我从事的项目中，这种区别只在一段时间内很重要。其余时间我个人更喜欢跳过`.nil?`并且代码略短一些。

[**更新**：我不再写这种东西了。它有效，但太神秘了。我试图通过改变我做过的几个地方来纠正我的错误行为。]

顺便说一句，我没有使用，因为如果是字符串，`.zero?`这会引发异常。`val`但是`.zero?`，如果您知道情况并非如此，那就太好了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-01-21T10:39:20.743

[您可以使用](http://www.ruby-doc.org/core-2.1.2/doc/syntax/refinements_rdoc.html)从 Ruby 2.1 开始的改进，而不是猴子修补类。细化类似于猴子补丁；在那里，它们允许您修改类，但修改仅限于您希望使用它的范围。

如果您想进行一次此检查，这有点过头了，但如果您重复自己，这是猴子修补的一个很好的替代方案。

```
module NilOrZero
  refine Object do
    def nil_or_zero?
      nil? or zero?
    end
  end
end

using NilOrZero
class Car
  def initialize(speed: 100)
    puts speed.nil_or_zero?
  end
end

car = Car.new              # false
car = Car.new(speed: nil)  # true
car = Car.new(speed: 0)    # true 
```

[改进](https://www.ruby-forum.com/topic/4409740)在最后一分钟被更改为文件范围。所以早期的例子可能已经表明了这一点，这是行不通的。

```
class Car
  using NilOrZero
end 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-03-15T15:04:49.983

对于 nil 和零，计算结果为 true：`nil.to_s.to_d == 0`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-01-08T19:57:18.027

```
unless (val || 0).zero?

    # do stufff

end 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-03-18T10:07:36.500

在一个单一的伸展，你可以做到这一点：

```
[do_something] if val.to_i == 0 
```

`nil.to_i`将返回`0`

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-01-26T15:40:32.983

另一种解决方案：

```
if val.to_i == 0
  # do stuff
end 
```

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2008-11-05T00:15:54.183

```
val ||= 0
if val == 0
# do something here
end 
```

# sql - 使用 SQL Server 进行应用程序日志记录。优点缺点？

> ID：209497
> 
> 赞同：22
> 
> 时间：2008-10-16T17:20:27.773
> 
> 标签：sql, logging, text-files

我有一个多用户应用程序，它为活动保留一个集中的日志文件。目前，该日志记录正在以大约 10MB-50MB / 天的速度进入文本文件。文本文件由记录器每天轮换，我们保留过去 4 或 5 天的价值。我们不感兴趣。

它们很少被阅读：无论是在为错误消息、诊断消息开发应用程序时，还是在应用程序在生产中对用户报告的问题或错误进行分类时。

（这*严格来说*是一个应用程序日志。安全日志保存在其他地方。）

但是当他们被阅读时，他们是一个痛苦的屁股。即使使用 Perl 也不是什么有趣的 10MB 文本文件：文件中的字段（事务 ID、用户 ID 等）很有用，但只是文本。消息是按顺序写入的，一次一个，因此在尝试跟踪特定事务或用户时，交错的活动都会混淆。

我正在寻找有关该主题的想法。有人使用 SQL 数据库完成应用程序级日志记录并喜欢它吗？讨厌它？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-16T18:26:01.883

我认为直接记录到数据库通常是一个坏主意，我会避免它。

主要原因是：一个好的日志在您可以使用它来调试您的应用程序事后检查时最有用，一旦错误已经发生并且您无法重现它。为此，您需要确保日志记录本身是可靠的。为了使任何系统可靠，一个好的开始就是保持简单。

因此，只需几行代码（打开文件、追加行、关闭文件或保持打开状态、重复...），当您真正需要时，拥有一个简单的基于文件的日志通常会更加可靠和有用去工作。

另一方面，成功地记录到 SQL 服务器将需要更多的组件正常工作，并且将有更多可能的错误情况，您将无法记录所需的信息，这仅仅是因为日志基础架构本身不会工作。最糟糕的是：日志过程中的故障（如数据库损坏或死锁）可能会影响应用程序的性能，然后您将遇到次要组件阻止应用程序执行其主要功能的情况。

如果您需要对日志进行大量分析，并且您不习惯使用 grep 等基于文本的工具，则将日志保存在文本文件中，并定期将它们导入 SQL 数据库。如果 SQL 失败，您不会丢失任何日志信息，甚至不会影响应用程序的运行能力。然后您可以在数据库中进行所有数据分析。

我认为这些是我不记录到数据库的主要原因，尽管我过去做过。希望能帮助到你。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-16T17:39:36.360

我们在上一份工作中使用了一个日志数据库，它很棒。

我们有存储过程，可以为我可以从网页加载的不同指标提供一般系统健康状况的概述。我们还可以在给定的时间段内快速为给定的应用程序吐出跟踪，如果我想要它很容易得到一个文本文件，如果你真的只是喜欢 grep-ing 文件。

为了确保日志系统本身不会成为问题，当然我们在不同的应用程序中使用了一个通用的代码框架来处理日志表的写入。该框架的一部分*还*包括记录到文件，以防问题出在数据库本身，其中一部分涉及循环日志。至于空间问题，日志数据库的备份计划不同，这真的不是问题。空间（未备份）很便宜。

我认为这解决了其他地方表达的大部分担忧。这都是执行的问题。但是，如果我在这里停下来，那仍然是“不会更糟”的情况，这是麻烦设置数据库日志记录的一个不好的理由。我喜欢它的地方在于它**允许我们做一些***对平面文件来说更难做的***新*****事情。***

 *文件有四个主要改进。首先是我已经提到的系统概述。第二个，也是最重要的，是检查是否有任何应用程序丢失了我们通常期望找到的消息。这种事情在传统的文件记录中几乎是不可能发现的，除非你每天花费大量时间查看那些在 99% 的情况下告诉你一切正常的应用程序的令人麻木的日志。令人惊奇的是如何释放视图以显示丢失的日志条目。大多数时候，我们根本不需要查看大多数日志文件……如果没有数据库，这将是危险和不负责任的。

这带来了第三个改进。我们生成了一封每日状态电子邮件，这是我们在一切正常运行的日子里*唯一*需要查看的内容。包含的电子邮件显示错误和警告。发送电子邮件的同一个数据库作业将丢失的日志重新记录为警告，并且丢失电子邮件是一件大事。我们可以在每日电子邮件中一键将特定日志消息转发到我们的错误跟踪器（它是 html 格式的，从网络应用程序中提取数据）。

最后的改进是，如果我们确实想更密切地关注特定应用程序，比如在进行更改后，我们可以订阅该特定应用程序的 RSS 提要，直到我们满意为止。从文本文件中更难做到这一点。

我现在所处的位置，我们更多地依赖第三方工具及其日志记录能力，这意味着要回到更多的人工审查。我真的很想念数据库，我正在考虑编写一个工具来读取这些日志并将它们重新记录到数据库中以恢复这些能力。

同样，我们使用文本文件作为后备来执行此操作，而真正使数据库有价值的是新功能。如果您要做的只是写入数据库并尝试以与旧文本文件相同的方式使用它，它会增加不必要的复杂性，您不妨只使用旧文本文件。为新功能构建系统的能力使其值得。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-16T17:28:03.670

是的，我们在这里做，我受不了。我们在这里遇到的一个问题是，如果数据库出现问题（连接、损坏等），所有日志记录都会停止。我的另一个大问题是很难通过追踪问题。我们也遇到了表日志占用太多空间的问题，并且在移动数据库时不得不担心截断它们，因为我们的日志太大了。

与日志文件相比，我认为它很笨重。我发现很难看到存储在数据库中的“大图”。我承认我是一个日志文件的人，我喜欢能够打开一个文本文件并通过（正则表达式）它而不是使用 sql 来尝试搜索一些东西。

我工作的最后一个地方有超过 100 兆的日志文件。它们有点难以打开，但如果你有正确的工具，它还不错。我们也有一个记录消息的系统。您可以快速查看文件并确定哪组日志条目属于哪个进程。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-16T17:57:25.637

我们之前使用过 SQL Server 集中式日志记录，如前文所述，最大的问题是与数据库的连接中断意味着日志记录中断。实际上，我最终在日志记录中添加了一个排队例程，该例程将首先尝试 DB，如果失败则写入物理文件。您只需将代码添加到该例程中，在成功登录到数据库时，将检查是否有任何其他条目在本地排队，然后也写入。

我喜欢将所有东西都放在数据库中，而不是物理日志文件，但这只是因为我喜欢用我写的报告来解析它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-16T17:43:21.750

我认为日志记录问题可以通过将日志记录到 SQL 来解决，*前提*是您能够将感兴趣的字段拆分为不同的列。您不能将 SQL 数据库视为文本字段并期望它会更好，但事实并非如此。

一旦您将所有您感兴趣的内容都记录到您想要的列中，通过能够按列隔离某事物，跟踪某事物的顺序操作就容易得多。就像您有一个“进入”流程一样，您通常会记录所有内容，并将文本“进入流程”放入“logtype”列或“process”列。然后，当您遇到“进入流程”问题时，该列上的 WHERE 语句将隔离所有进入流程。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-16T18:19:16.983

我们在我们的组织中使用 SQL Server 大量执行此操作。由于搜索和过滤功能，在我的开放中写入数据库更好。性能方面 10 到 50 MB 的数据并仅保留 5 天，不会影响您的应用程序。与从文本文件中跟踪交易相比，跟踪交易和用户将非常容易，因为您可以按交易或用户进行过滤。

您提到文件很少读取。那么，决定是否值得花时间开发日志框架？计算一年中从日志文件中搜索日志所花费的时间与编码和测试所需的时间。如果每天花费 1 小时或更多时间来搜索日志，最好将日志转储到数据库中。这可以大大减少解决问题的时间。

如果您花费不到一个小时，那么您可以使用一些文本搜索工具，例如“SRSearch”，这是我使用的一个很棒的工具，从文件夹中的多个文件中搜索并以小片段的形式为您提供结果（“如谷歌搜索结果")，您可以在此处单击以打开感兴趣的结果的文件。还有其他可用的文本搜索工具。如果环境是 windows，那么你有 Microsoft LogParser 也是一个很好的免费工具，如果文件是以特定格式编写的，你可以像数据库一样查询文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-23T12:53:43.940

以下是一些额外的优点和缺点，以及我更喜欢日志文件而不是数据库的原因：

1.  使用 VPS 时，空间并不便宜。在实时数据库系统上恢复空间通常很麻烦，您可能必须在恢复空间时关闭服务。如果您的日志非常重要，以至于您必须将它们保存多年（就像我们一样），那么这是一个真正的问题。请记住，当您删除数据时，大多数数据库不会恢复空间，因为它只是重新使用空间 - 如果您实际上空间不足，则没有多大帮助。

2.  如果您经常访问日志，并且您必须从具有一个巨大日志表和数百万条记录的数据库中提取每日报告，那么您将在从数据库中查询数据时影响数据库服务的性能。

3.  可以每天创建日志文件并归档旧日志。根据日志的类型，可以通过归档日志来回收大量空间。当我们压缩日志时，我们节省了大约 6 倍的空间，在大多数情况下，您可能会节省更多。

4.  可以轻松压缩和传输单个较小的日志文件，而不会影响服务器。以前，我们在数据库中拥有 100 多 GB 数据的日志。在服务器之间移动如此大的数据库变得很麻烦，尤其是因为这样做时您必须关闭数据库服务器。我要说的是，在您必须开始移动大型数据库的那一天，维护变得非常痛苦。

5.  写入日志文件通常比写入数据库快得多。不要小看你的操作系统文件 IO 的速度。

6.  如果您没有正确构建日志，日志文件只会很糟糕。您可能必须使用其他工具，甚至可能需要开发自己的工具来帮助处理它们，但最终这将是值得的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-14T15:42:45.723

您可以将日志记录为逗号或制表符分隔的文本格式，或者将您的日志导出为 CSV 格式。当您需要从日志中读取 CSV 文件导出到 SQL 服务器上的表时，您可以使用标准 SQL 语句进行查询。要自动化该过程，您可以使用 SQL 集成服务。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-02T12:40:44.870

我一直在阅读所有答案，它们很棒。但是在我工作的一家公司中，由于一些限制和审核，必须登录数据库。无论如何，我们有几种记录方式，解决方案是安装一个管道，我们的程序员可以连接到管道并登录到数据库、文件、控制台，甚至将日志转发到端口以供其他应用程序使用。此管道不会中断正常进程，并在您登录数据库的同时保留一个日志文件，确保您很少丢失一行。我建议您进一步调查 log4net，它对此非常有用。

[http://logging.apache.org/log4net/](http://logging.apache.org/log4net/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T17:51:05.493

我可以看到它运行良好，前提是您能够过滤需要记录的*内容*以及*需要*记录的时间。如果您找不到您要查找的内容或包含不必要的信息，则日志文件（或表，例如它）是无用的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-01-26T21:50:08.583

由于您的日志很少被读取，因此我会将它们写入文件（更好的性能和可靠性）。

然后，当且仅当您需要阅读它们时，我会将日志文件导入数据库（更好的分析）。

这样做，您将获得这两种方法的优势。

# .net-3.5 - 当通过命名空间进行版本控制时，将 xml 序列化为适当对象的最佳方法是什么？

> ID：209502
> 
> 赞同：1
> 
> 时间：2008-10-16T17:23:09.903
> 
> 标签：.net-3.5, c#-3.0, xml-serialization

我的问题如下。

我有由命名空间版本控制的 xml。我想将此接收到的 xml 序列化为适当的对象，但我知道这样做的唯一方法意味着我必须处理 xml 两次。首先发现命名空间，然后根据发现的命名空间序列化为适当类型的对象。这对我来说似乎非常低效，并且必须有某种方法使用泛型或其他方法来获取适当类型的对象，而无需“if namespace == x then serialze to that”检查。

以下是我知道的唯一方法示例。有没有更好或更有效的方法？

谢谢

```
using System;
using System.Text;
using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.Xml.Linq;
using System.Xml;
using System.Xml.Serialization;
using System.IO;

namespace TestProject1
{
    [TestClass]
    public class UnitTest1
    {
        [TestMethod]
        public void TestMethod3()
        {
            //Build up an employee object to xml
            Schema.v2.Employee employee = new Schema.v2.Employee { FirstName = "First", LastName = "Last" };
            string xml = employee.ObjectToXml<Schema.v2.Employee>();

            //Now pretend I don't know what type I am receiving.
            string nameSpace = GetNamespace(xml);
            Object newemp;
            if (nameSpace == "Employee.v2")
                newemp = XmlSerializationExtension.XmlToObject<Schema.v2.Employee>(null, xml);
            else
                newemp = XmlSerializationExtension.XmlToObject<Schema.v1.Employee>(null, xml);

            // Check to make sure that the type I got was what I made.
            Assert.AreEqual(typeof(Schema.v2.Employee), newemp.GetType());
        }

        public string GetNamespace(string s)
        {
            XDocument z = XDocument.Parse(s);
            var result = z.Root.Attributes().
                    Where(a => a.IsNamespaceDeclaration).
                    GroupBy(a => a.Name.Namespace == XNamespace.None ? String.Empty : a.Name.LocalName,
                            a => XNamespace.Get(a.Value)).
                    ToDictionary(g => g.Key,
                                 g => g.First());

            foreach (System.Xml.Linq.XNamespace item in result.Values)
                if (item.NamespaceName.Contains("Employee")) return item.NamespaceName;

            return String.Empty;
        }
    }

    public static class XmlSerializationExtension
    {
        public static string ObjectToXml<T>(this T Object)
        {
            XmlSerializer s = new XmlSerializer(Object.GetType());
            using (StringWriter writer = new StringWriter())
            {
                s.Serialize(writer, Object);
                return writer.ToString();
            }
        }
        public static T XmlToObject<T>(this T Object, string xml)
        {
            XmlSerializer s = new XmlSerializer(typeof(T));
            using (StringReader reader = new StringReader(xml))
            {
                object obj = s.Deserialize(reader);
                return (T)obj;
            }
        }
    } 
}

namespace Schema.v1
{
    [XmlRoot(ElementName = "Employee", Namespace= "Employee.v1", IsNullable = false)]
    public class Employee
    {
        [XmlElement(ElementName = "FirstName")]
        public string FirstName { get; set; }
        [XmlElement(ElementName = "LastName")]
        public string LastName { get; set; }
    }
}
namespace Schema.v2
{
    [XmlRoot(ElementName = "Employee", Namespace = "Employee.v2", IsNullable = false)]
    public class Employee
    {
        [XmlAttribute(AttributeName = "FirstName")]
        public string FirstName { get; set; }
        [XmlAttribute(AttributeName = "LastName")]
        public string LastName { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T17:27:57.007

两个建议：

首先，也许根本不这样做。如果您正在序列化，除非调用者指定模式，否则首选一种方法而不是另一种方法。

其次，不要解析XML进行发现；只需在（比如说）文件的前 100 个字节内对“Employee.v2”和“Employee.v1”进行字符串匹配（或者无论您需要多远才能获取信息）。这应该有效，除非这些将是您数据中的常见字符串。

# javascript - 在 JavaScript 中是否可以以编程方式启动文件浏览器对话框？

> ID：209509
> 
> 赞同：13
> 
> 时间：2008-10-16T17:26:28.320
> 
> 标签：javascript, html

`<input type="file">`我不想使用标签，而是希望有一个按钮来启动文件浏览器对话框。

我的第一个想法是有一个隐藏的文件输入标签和一个按钮。我会使用按钮单击按钮来触发隐藏文件输入的 onclick，但我无法使其正常工作。

所以问题是，这甚至可能吗？其次，有没有更好的方法来做到这一点，并且仍然能够以表格的形式发回信息？

这将是降级功能的底层（从 Flash 到 JavaScript（我们的网站在没有 JS 的情况下无法运行）），因此它只能使用基本的 JS 和 HTML。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-16T17:27:58.990

是的，通过不透明度（在大多数浏览器中）是可能的。[这是一个教程](http://www.quirksmode.org/dom/inputfile.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T17:32:45.780

我过去曾这样做过（请参阅 ceejayoz 的回答），但现在建议不要这样做。这是一个安全问题，未来不能依赖。一个更好的解决方案是逐步增强您的上传表单，以便将文件输入替换为具有更多功能的基于 Flash 或 Java 的上传程序（或者在 HTML 5 中使用更好的功能，如果它们可用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T17:52:49.203

我建议不要尝试破解浏览器的文件输入控件，而是使用基于 Flash 的文件上传器，例如[SWFUpload](http://swfupload.org/)。我已经开始在我的一个项目中使用它并且对它非常满意。

你会得到 javascript 回调，你可以为 UI 做任何你想做的事情（flash 只是上传功能）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-12T00:32:06.583

我宁愿避免使用透明技巧。

这对我有用（使用 jQuery）：

```
$("#upload-box").change(function(){
    $("#upload-click-handler").val($(this).val());
});
$("#upload-click-handler").click(function(){
    $("#upload-box").click();
}); 
```

和 HTML：

```
<input id="upload-box" style="visibility:hidden;height:0;" name="Photo" type="file" />
<input id="upload-click-handler" type="text" readonly /> 
```

它创建一个文本输入和一个隐藏的上传输入，并将文本输入的点击修补（=路由）到隐藏文件输入。

选择文件后，它将在文本输入中回写文件名，这与大多数用户对界面的期望一致。

应该适用于 FF、Chrome、IE9 和 +。我没有在IE8上测试它。

这是一个[jsfiddle](http://jsfiddle.net/bM5L7/)。如果您喜欢，感谢您支持我的回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-15T09:15:43.047

您可以在没有任何安全问题的情况下执行此操作。只需在 onmouseenter 上编写代码，即可提升真正上传按钮的 zindex（您可以在其上使用不透明度或使其透明），然后您无需触发点击，只需使用用户的点击即可。

# python - 在 Python 中将十六进制字符串转换为 int

> ID：209513
> 
> 赞同：900
> 
> 时间：2008-10-16T17:28:03.497
> 
> 标签：python, string, hex

如何在 Python 中将十六进制字符串转换为 int？

我可能将其命名为“ `0xffff`”或只是“ `ffff`”。

* * *

## 回答 #1

> 赞同：1309
> 
> 时间：2008-10-16T17:37:52.340

**如果没有**0x 前缀，则需要显式指定基数，否则无法分辨：

```
x = int("deadbeef", 16) 
```

**使用**0x 前缀，Python 可以自动区分十六进制和十进制。

```
>>> print(int("0xdeadbeef", 0))
3735928559
>>> print(int("10", 0))
10 
```

（您*必须*指定`0`为基数才能调用此前缀猜测行为；如果省略第二个参数[`int()`](https://docs.python.org/library/functions.html#int)将假定基数为 10。）

* * *

## 回答 #2

> 赞同：202
> 
> 时间：2008-10-16T17:32:10.963

`int(hexstring, 16)`可以解决问题，并且可以使用和不使用 0x 前缀：

```
>>> int("a", 16)
10
>>> int("0xa", 16)
10 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2016-05-14T02:50:29.187

> # 在 Python 中将十六进制字符串转换为 int
> 
> 我可能有它作为`"0xffff"`或只是`"ffff"`。

要将字符串转换为 int，请将字符串`int`与要转换的基一起传递给。

这两个字符串都足以以这种方式进行转换：

```
>>> string_1 = "0xffff"
>>> string_2 = "ffff"
>>> int(string_1, 16)
65535
>>> int(string_2, 16)
65535 
```

## 让我们`int`推断

如果您将 0 作为基数传递，`int`则将从字符串中的前缀推断基数。

```
>>> int(string_1, 0)
65535 
```

没有十六进制前缀 ,`0x`没有`int`足够的信息来猜测：

```
>>> int(string_2, 0)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: invalid literal for int() with base 0: 'ffff' 
```

## 文字：

如果您正在输入源代码或解释器，Python 将为您进行转换：

```
>>> integer = 0xffff
>>> integer
65535 
```

这不起作用，`ffff`因为 Python 会认为您正在尝试编写一个合法的 Python 名称：

```
>>> integer = ffff
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'ffff' is not defined 
```

Python 数字以数字字符开头，而 Python 名称不能以数字字符开头。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2008-10-16T17:32:32.443

对于任何给定的字符串 s：

```
int(s, 16) 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-06-30T16:25:01.510

添加到上面丹的答案：如果您为 int() 函数提供十六进制字符串，则必须将基数指定为 16，否则它不会认为您给它一个有效值。对于不包含在字符串中的十六进制数字，不需要指定基数 16。

```
print int(0xdeadbeef) # valid

myHex = "0xdeadbeef"
print int(myHex) # invalid, raises ValueError
print int(myHex , 16) # valid 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-01-17T13:20:15.807

最糟糕的方式：

```
>>> def hex_to_int(x):
    return eval("0x" + x)

>>> hex_to_int("c0ffee")
12648430 
```

# *请不要这样做！*

[在 Python 中使用 eval 是一种不好的做法吗？](https://stackoverflow.com/questions/1832940/is-using-eval-in-python-a-bad-practice)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-10-19T01:10:29.010

或者`ast.literal_eval`（这是安全的，不像`eval`）：

```
ast.literal_eval("0xffff") 
```

**演示：**

```
>>> import ast
>>> ast.literal_eval("0xffff")
65535
>>> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-07-02T20:02:44.263

如果您使用的是 python 解释器，您只需键入 0x（您的十六进制值），解释器就会自动为您转换它。

```
>>> 0xffff

65535 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-06-22T11:10:32.680

格式化程序选项 '%x' % 似乎也适用于我的赋值语句。（假设 Python 3.0 及更高版本）

**例子**

```
a = int('0x100', 16)
print(a)   #256
print('%x' % a) #100
b = a
print(b) #256
c = '%x' % a
print(c) #100 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-11-22T15:21:54.347

**处理十六进制、八进制、二进制、整数和浮点数**

该函数使用标准前缀（即 0x、0b、0 和 0o）将任何合适的字符串转换为数字。我在这里回答了这个问题：[https](https://stackoverflow.com/a/58997070/2464381) ://stackoverflow.com/a/58997070/2464381但这是所需的功能。

```
def to_number(n):
    ''' Convert any number representation to a number 
    This covers: float, decimal, hex, and octal numbers.
    '''

    try:
        return int(str(n), 0)
    except:
        try:
            # python 3 doesn't accept "010" as a valid octal.  You must use the
            # '0o' prefix
            return int('0o' + n, 0)
        except:
            return float(n) 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2015-05-16T00:13:25.560

在 Python 2.7 中，`int('deadbeef',10)`似乎不起作用。

以下对我有用：

```
>>a = int('deadbeef',16)
>>float(a)
3735928559.0 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2012-08-21T06:39:36.013

带有 '0x' 前缀，你也可以使用 eval 函数

例如

```
>>a='0xff'
>>eval(a)
255 
```

# java - 如何处理可怕的 Struts Actions？

> ID：209516
> 
> 赞同：5
> 
> 时间：2008-10-16T17:28:27.257
> 
> 标签：java, struts, design-patterns, anti-patterns

我使用 Struts 1.2.4 继承了这个巨大的遗留 Java Web 应用程序。我有一个关于行动的具体问题。大多数页面只有一个 Action，而 processExecute() 方法是可怕的怪物（非常长且大量基于请求参数的嵌套 if 语句）。

鉴于动作是命令模式的一种实现，我正在考虑将这些动作拆分为每个用户手势一个动作。不过，这将是一次大型重构，我想知道：

1.  这是正确的方向吗？
2.  有没有我可以采取的中间步骤，一种处理单体操作内部混乱的模式？也许动作中的另一个命令模式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-16T18:19:28.167

我的处理方式是：

*   不要“一次做所有事情”
*   每当你改变任何东西时，让它比你发现它更好
    *   用单独的 Action 实现替换条件是一个步骤。
    *   更好的是：使您的实现与 Action 类分开，以便您在更改框架时可以使用它
    *   保持您的新 Command 实现*绝对*不引用 Struts，使用您的新 Actions 作为围绕这些实现的 Wrapper。
    *   您可能需要为您的 Struts ActionForms 提供接口，以便在不复制所有数据的情况下传递它们。另一方面-您可能希望传递通常是一堆字符串的 ActionForms 以外的其他对象（请参阅有关[Struts 1.2 ActionForms](https://stackoverflow.com/questions/209493/what-type-should-struts-actionform-properties-be)的其他问题）
*   开始将零件迁移到更新更好的技术。Struts 1.2 一出来就很棒，但绝对不是你想要永远支持的。现在有几代更好的框架。

肯定还有更多——抱歉，我没时间了……

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T02:57:43.253

在我看来，Struts Actions 中根本不应该有太多代码。他们应该直接与请求和响应交互——从表单或请求参数中获取一些数据，将这些信息传递给服务层，然后将一些内容放入 Response 对象中，或者将一些数据保存在用户的会话中。

我建议不要使用动作类进行继承。起初这听起来是个好主意，但我认为迟早你会意识到你在做一些事情，而不是让代码库变得健壮。Struts 有足够的基本操作，如果您正在创建新的操作，您可能在 Web 层中获得了不应该存在的代码。

这只是我个人的经验。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T01:59:26.693

我以前处理过这种类型的事情。一个好的第一步是将另一个基类插入到 Action 和一个原始的怪异动作类（我们称之为 ClassA）之间的继承链中。特别是如果你没有时间一次做所有事情。然后，您可以开始将功能块提取到较小的并行操作类（ClassB、ClassC）中。原始 ClassA 和新重构的类之间共有的任何东西都可以拉入新的基类中。所以层次结构现在看起来像这样：

```
Original Hierarchy:      New Hierarchy:

     Action                   Action
       |                        |
       |                      BaseA
  (old)ClassA                   |
                       +--------+----------+
                       |        |          |
                   ClassB (new)ClassA   ClassC 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T16:21:35.520

1.  一次使用一种方法
2.  记录一些您可以稍后回放的测试用例。 [此处的示例](http://www.naildrivin5.com/daveblog5000/?p=41)（确保在代码中点击尽可能多的路径，即页面上调用此操作的所有用户手势）
3.  通过创建更小的方法来做更小的事情，重构方法以降低其复杂性。
4.  执行此操作时重新运行测试

至此，你已经重构了巨大的恼人方法的版本。 **现在**您可以真正开始创建特定的操作了。

您可以将新重构的类用作基类，并使用那些重构的小方法将每个特定操作作为子类实现。

完成此操作后，您应该对类之间共享的逻辑有一个很好的了解，并且可以根据需要上拉或下推这些方法。

It's not fun, but if you will be working on the codebase for a while, it will save you time and headaches.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T18:26:49.900

棘手的问题，但典型的早期 Web 应用程序开发。

首先，您需要开始思考哪些逻辑构成业务行为，哪些逻辑构成“流程”（即用户看到的内容），以及哪些逻辑获取他看到的内容。

您不必走工厂和接口之类的路线；追溯实现的用处要小得多......但是将业务逻辑和数据检索逻辑整合到某种委托中......并让struts动作根据该逻辑的成功/失败来确定页面流。

从那里你只需要花几个星期的时间把它磨出来

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T18:34:39.823

一个长方法永远不会好，除非它恰好是一个单独的 switch 语句，其中的情况很短（令牌解析或类似的东西）。

您至少可以将 long 方法重构为具有描述性名称的较小方法。

如果可能的话，您可以通过检查表单来识别它应该做什么来开始您的方法，然后通过 if/else 进入各种选项。但是没有嵌套的 if，那些往往会使代码不可读。只是

```
enum Operation {
  ADD, DELETE;
}

...

Operation operation = determineOperation(form);
if (operation == Operation.DELETE) { 
  doDelete(form); 
} else if (operation == Operation.ADD) {
  doAdd(form);
} 
```

如果你能走得那么远，你的逻辑就会很好而且干净，你可以做任何你想做的重构。

困难的部分是让你的逻辑清晰，你可以逐步做到这一点。在您完全了解问题所在之前，不要选择模式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T18:45:45.383

如果您打算重构代码，您应该确保首先为现有代码编写测试，这样您就可以确保在开始重构后您没有更改它的功能。

# powershell - Powershell - 增加从 URL 检索 XML 的超时时间

> ID：209520
> 
> 赞同：9
> 
> 时间：2008-10-16T17:30:48.047
> 
> 标签：powershell

我正在尝试从 URL 检索 XML 流。对于大多数 URL，我下面的代码可以正常工作。但是，我有几个 URL 超时。有问题的 URL 可以在**Internet** Explorer 中使用。

```
$webclient=New-Object "System.Net.WebClient"
[xml]$data=$webclient.DownloadString($url) 
```

所以，我去寻找一种增加超时时间的方法。根据我的阅读，我相信我不能使用`System.Net.WebClient`. 我想我需要`System.Net.WebRequest`改用，但我无法让它工作。我一直在处理的代码如下：

```
$myHttpWebRequest = [system.net.WebRequest]::Create($url)
$myHttpWebRequest.Timeout = 600000
$myHttpWebResponse = $myHttpWebRequest.GetResponse()
$sr = New-Object System.IO.StreamReader($response.GetResponseStream())
[xml]$xml = [xml]$sr.ReadToEnd() 
```

我试图访问的 URL 是我公司内部的，所以我不能发布它们。但是，它们确实在 IE 中工作，实际的 URL 应该是无关紧要的。

想法？

编辑：初步测试表明添加`$myHttpWebRequest.AuthenticationLevel = "None"`有效。谢谢斯科特萨德。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T18:55:45.520

默认情况下**WebRequest.AuthenticationLevel**设置为**MutualAuthRequested**，因此它将等待某种类型的身份验证响应。因此，在等待身份验证发生时可能会超过超时。看起来您并没有弄乱凭据，所以除非您需要身份验证，否则您可能不需要这个。**创建WebRequest**后尝试以下操作：

```
$myHttpWebRequest.AuthenticationLevel = "None" 
```

我希望这有助于解决问题。

# mfc - 如何将某些内容拖放到静态控件中？

> ID：209528
> 
> 赞同：1
> 
> 时间：2008-10-16T17:31:51.180
> 
> 标签：mfc

我如何将某些东西拖放到静态控件中？看起来我需要创建一个 COleDropTarget 的子类，并将其作为成员变量包含在自定义 CStatic 中。但这似乎不起作用。当我尝试将某些东西拖到静态控件上时，我得到了 drop denied 光标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T19:13:23.380

调用 时，静态控件`m_hWnd`必须有效，这就是它在构造函数`COleDropTarget::Register`中不起作用的原因。`CMyStatic`您可以做的是`CWnd::PreSubclassWindow`在您的`CMyStatic`班级中覆盖：

```
class CMyStatic : public CStatic {
    ...
    virtual void PreSubclassWindow();
};

void CMyStatic::PreSubclassWindow()
{
    CStatic::PreSubclassWindow();

    m_MyDropTarget.Register(this);
} 
```

[这里](http://www.codeproject.com/KB/dialog/presubclasswindow.aspx)有一篇关于 CodeProject的非常好的文章，您可能会觉得很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T17:06:44.897

除了 PreSubClassWindow() 之外，您还必须将 CStatic 控件设置为在其资源参数中设置 Notify 标志。否则控件不会让应用程序知道鼠标移动，因此不会触发 OnDragEnter() 方法。

# gdb - 如何在交互式调试期间突出显示和着色 gdb 输出？

> ID：209534
> 
> 赞同：189
> 
> 时间：2008-10-16T17:33:08.277
> 
> 标签：gdb, terminal, colors

请不要回复我应该使用 ddd、nemiver、emacs、vim 或任何其他前端，我只是更喜欢 gdb，但希望看到它的输出带有一些终端颜色。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2013-06-27T10:58:52.330

# .gdbinit

你可以调整你`~/.gdbinit`的颜色。您可以使用`.gdbinit`这里提供的mammon：

[https://github.com/gdbinit/gdbinit](https://github.com/gdbinit/gdbinit)

您也可以随意调整它。由于[这个 SO answer](https://stackoverflow.com/questions/5526432/gdb-in-backtrack) ，我发现了这一点。这是您可以获得的输出类型：

![.gdbinit](https://i.stack.imgur.com/Nhuwf.png)

GitHub 存储库也可用：[https ://github.com/gdbinit/Gdbinit](https://github.com/gdbinit/Gdbinit)

另一方面，同样的想法也[适用于 lldb](https://github.com/deroko/lldbinit)。

# GDB 仪表板

遵循相同的概念，[GDB Dashboard](https://github.com/cyrus-and/gdb-dashboard)为 Python 中的 GDB 提供了模块化的可视化界面。

[![GDB 仪表板](https://i.stack.imgur.com/mHC8f.png)](https://i.stack.imgur.com/mHC8f.png)

# （无效）步行者

另一个类似的项目使用 GDB 的 Python 支持来提供更多的可扩展性，因此值得一试：[https ://github.com/dholm/voidwalker](https://github.com/dholm/voidwalker)

@dholm 还提供了他自己的[.gdbinit](https://github.com/dholm/dotgdb)，灵感来自前一个。

![（无效）步行者](https://raw.githubusercontent.com/dholm/voidwalker/master/screenshot.png)

# 密码数据库

一些项目提供了一组有用的功能，包括改进的显示。[PEDA](https://github.com/longld/peda)或[pwndbg](https://github.com/zachriggle/pwndbg)就是这种情况。后者给出以下描述：

> PEDA 替代品。在我们的好朋友的精神`windbg`，`pwndbg`是明显的`pwnd-bag`。
> 
> *   速度
> *   弹性
> *   干净的代码

它提供了类似于 PEDA 的命令来支持调试和利用开发，并提供更好的显示（尽管这不是项目的主要重点）。该软件仍在开发中，尚未正式发布。

[![密码数据库](https://i.stack.imgur.com/BuVHv.png)](https://i.stack.imgur.com/BuVHv.png)

# 伏创

项目[描述](https://github.com/snare/voltron)指出：

> Voltron 是一个面向黑客的可扩展调试器 UI。它允许您将在其他终端中运行的实用程序视图附加到您的调试器（LLDB 或 GDB），显示有用的信息，例如反汇编、堆栈内容、寄存器值等，同时仍为您提供您习惯的相同调试器 CLI。

您可以修改您的`.gdbinit`以自动集成它。但是，显示本身在 GDB 之外（例如在 tmux 拆分中）。

[![伏创](https://i.stack.imgur.com/7eWF1.png)](https://i.stack.imgur.com/7eWF1.png)

# 全球环境基金

[GEF](https://github.com/hugsy/gef)是另一种选择，它被描述为：

> 它主要由漏洞利用者和逆向工程师使用，使用 Python API 为 GDB 提供附加功能，以协助动态分析和漏洞利用开发过程。

[![全球环境基金](https://i.stack.imgur.com/EpxEz.png)](https://i.stack.imgur.com/EpxEz.png)

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2008-10-30T10:21:55.933

这不是颜色，而是考虑 gdb 的[文本 gui](http://davis.lbl.gov/Manuals/GDB/gdb_21.html)。它对 gdb 的可用性有很大的影响。

您可以使用以下命令启动它：

```
gdb -tui executable.out 
```

截屏：

![在此处输入图像描述](https://i.stack.imgur.com/wHN7R.png)

如您所见，主要特点是：

*   显示我们在源的哪一行和周围的行
*   显示断点

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-02-06T21:10:30.747

我知道你不想要前端。[但是cgdb](http://cgdb.github.io)怎么样，它非常接近 gdb，它是文本模式，但上面有一个源窗口，代码上有语法高亮显示。

![](https://i.imgur.com/T9Iepi9.png?1)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2019-04-09T14:38:33.763

即将推出的**GDB 8.3 中的新功能！**

[https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;a=blob;f=gdb/NEWS](https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;a=blob;f=gdb/NEWS)

> 终端样式现在可用于 CLI 和 TUI。GNU Source Highlight 还可用于提供源代码片段的样式。有关详细信息，请参阅下面的“设置样式”命令。

[![gdb 8.2.91.20190401-23.fc30 截图](https://i.stack.imgur.com/k7Ym4.png)](https://i.stack.imgur.com/k7Ym4.png)

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2010-07-15T14:33:58.557

通过使用颜色可以大大增强 gdb 的外观。这是通过以下任何一种方法完成的：

1.  通过“设置提示”进行彩色提示。例如，使提示变为粗体和红色：

    `set prompt \033[1;31m(gdb) \033[m`

    或者使提示变成新的形状，粗体和红色：

    `set prompt \033[01;31m\n\n#####################################> \033[0m`

    [![在此处输入图像描述](https://i.stack.imgur.com/f8NZl.png)](https://i.stack.imgur.com/f8NZl.png)

2.  通过钩子着色命令

3.  “list”命令的彩色语法突出显示。

Michael Kelleher 撰写的以下博客文章中提供了所有示例：

[“美化 GDB”，2010 年 5 月 12 日（来自 archive.org）](https://web.archive.org/web/20101217181141/http://www.michaelkelleher.info/?p=1)

[“实验性 GDB 语法高亮”，2010 年 5 月 15 日（通过 archive.org）](https://web.archive.org/web/20101217181206/http://www.michaelkelleher.info/?p=51)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-04-10T03:34:24.967

`cgdb`比`gdb -tui`

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-05-02T16:51:48.203

```
#into .gdbinit
shell mkfifo /tmp/colorPipe

define hook-disassemble
echo \n
shell cat /tmp/colorPipe | c++filt | highlight --syntax=asm -s darkness -Oxterm256 &
set logging redirect on
set logging on /tmp/colorPipe
end 

define hookpost-disassemble
hookpost-list
end 

define hook-list
echo \n
shell cat /tmp/colorPipe | c++filt | highlight --syntax=cpp -s darkness -Oxterm256 &
set logging redirect on
set logging on /tmp/colorPipe
end 

define hookpost-list
set logging off 
set logging redirect off 
shell sleep 0.1s
end 

define hook-quit
shell rm /tmp/colorPipe
end 

define re
hookpost-disassemble
echo \033[0m
end 
document re
Restore colorscheme
end 
```

警告：越野车。没有 TUI 支持，“用户模式”破解。

[在这里](http://bluec0re.blogspot.com/2011/05/gdb-disassembly-syntax-highlighting-cpp.html)找到了主要部分 并对其进行了一些修改。需要高亮，c++filt。如果颜色弄乱了发出重新命令。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-10-20T10:02:34.950

整洁，我刚刚使用 colout 发现了这个 hack：[https ://github.com/nojhan/colout/blob/master/colout/example.gdbinit](https://github.com/nojhan/colout/blob/master/colout/example.gdbinit)

![之前 - 之后](https://i.stack.imgur.com/TTZ9H.png)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-01-18T08:09:46.060

我想强调如下：强调属于我的源文件（而不是库）的堆栈跟踪行。

解决方案是使用 gdb-python （在 MSYS 上；在 Linux 上通常`gdb`已经内置了 Python？）， hook `backtrace`，使用

```
python stack_trace = gdb.execute('backtrace', False, True') 
```

然后`stack_trace`使用 Python 的正则表达式进行处理，并将它们打印出来。粗体和其他颜色是通过这样的函数实现的：

```
def term_style(*v):
    """1 is bold, 30--37 are the 8 colours, but specifying bold may also
    change the colour. 40--47 are background colours."""
    return '\x1B['+';'.join(map(str, v))+'m'

#Use like this:
print term_style(1) + 'This will be bold' + term_style(0) #Reset.
print term_style(1,30) + 'This will be bold and coloured' + term_style(0)
print term_style(1,30,40) + 'Plus coloured background' + term_style(0) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-10-13T15:31:35.080

[这种配置](https://github.com/RAttab/dotfiles/blob/master/colors.gdb "这个配置")提供了另一种很好的颜色组合。它使检查回溯变得更加容易。要使用它，只需将该文件另存为`~/.gdbinit`并正常运行 gdb

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-07-14T04:16:07.047

你可以得到任何你想要的颜色；

```
# gdb
(gdb) shell echo -en '\E[47;34m'"\033[1m"
...
anything is now blue foreground and white background
...
(gdb) shell tput sgr0
... back to normal 
```

# windows-mobile - 如何在 Windows 中创建虚拟 Com1 端口？

> ID：209541
> 
> 赞同：3
> 
> 时间：2008-10-16T17:35:03.343
> 
> 标签：windows-mobile, virtual-serial-port

我正在开发一个在袖珍电脑上运行的移动应用程序。我们有一个使用 com1 发送和获取信息的移动打印机和刷卡器。我正在使用设备模拟器并想在没有打印机的情况下进行测试。如何创建一个虚拟 com1 端口来读取和读取？我尝试了 com0com，但设备模拟器不会将其设置为串行 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T18:48:29.917

如果 PC 有 2 个串行端口（USB 到串行适配器工作良好），您可以使用空调制解调器从与仿真器共享的端口到 PC 上的另一个端口，并将超级终端连接到它。这会让你很容易重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T17:40:20.697

这不是一个直接的答案，但如果你足够绝望，我让一个朋友使用[Detours](http://research.microsoft.com/sn/detours/)将与 COM 接口相关的输出重定向到他无法编辑另一个程序的源代码时他想要的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:05:34.327

大约 2 天前，我对此进行了研究，以模拟 GPS 设备。我唯一能想到的是一堆低级汇编代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T03:23:59.300

我不确定我是否明白你在追求什么。模拟器可以绑定到 PC 上的 COM 端口，因此您可以使用它从模拟器上的应用程序读取和写入 PC 上的物理端口。

现在，如果您要问如何才能打开 COM 端口并在没有任何连接的情况下进行读写，那要困难得多。写作很简单——我只是抽象出通信层并把一个模拟类放在一起，然后让写作无处可去。读取更具挑战性，因为您将不得不编写某种模拟器来以与外围设备相同的方式呈现数据。

IMO，无论如何，您都应该进行这种抽象，以允许您为软件编写单元和集成测试。

# .net - “处于 EndRootElement 状态的令牌文本将导致无效的 XML 文档”

> ID：209554
> 
> 赞同：5
> 
> 时间：2008-10-16T17:39:45.173
> 
> 标签：.net, xml, xslt

我看到此异常消息来自 XslCompiledTransform.Transform()，但在处理异常后，XSL 转换似乎仍然成功。完整的异常消息是：

> EndRootElement 状态中的标记文本将导致无效的 XML 文档。如果要编写 XML 片段，请确保将 ConformanceLevel 设置设置为 ConformanceLevel.Fragment 或 ConformanceLevel.Auto。

样式表如下所示：

```
<xsl:stylesheet version="1.0" xmlns:ext="ext:extensions" xmlns:f="http://schemas.foo.com/FOAMSchema">
  <xsl:template match="/Root/Documents/PO/DROPSHIP">
    <Transactions>
      <Transaction>
        <f:partnerTransmission>
          <transmission_id>
            <xsl:value-of select="ext:NewGUID()"/>
          </transmission_id>
          <partner_code>
            <xsl:value-of select="/Root/@PartnerCode"/>
          </partner_code>
          <control_nbr>
            <xsl:value-of select="@GS_CNTRL_NUM"/>
          </control_nbr>
          <creationTime>
            <xsl:value-of select="ext:ConvertToStandardDateTime(@DATE,@TIME,'ISO8601Basic')"/>
          </creationTime>
          <direction>I</direction>
          <messageCount>
            <xsl:value-of select="count(ORDERS/ORDER)"/>
          </messageCount>
          <syntax>XML</syntax>
          <format>BARBAZ</format>
          <deliveryMethod>FTP</deliveryMethod>
        </f:partnerTransmission>
      </Transaction>
    </Transactions>
  </xsl:template>
</xsl:stylesheet> 
```

生成的 XML 如下所示：

```
<Transactions xmlns="http://schemas.foo.com/IntegrationProfile" xmlns:ext="ext:extensions">
  <Transaction>
    <f:partnerTransmission xmlns:f="http://schemas.foo.com/FOAMSchema">
      <transmission_id>a5e0ec76-6c24-426b-9eb5-aef9c45d913f</transmission_id>
      <partner_code>VN000033</partner_code>
      <control_nbr>650</control_nbr>
      <creationTime>9/27/2008 12:51:00 AM</creationTime>
      <direction>I</direction>
      <messageCount>2</messageCount>
      <syntax>XML</syntax>
      <format>BARBAZ</format>
      <deliveryMethod>FTP</deliveryMethod>
    </f:partnerTransmission>
  </Transaction>
</Transactions> 
```

以上是我捕获并忽略异常时得到的结果。

我还没有找到设置 ConformanceLevel 的方法（该属性是只读的），但同时我也不认为这里应该有问题。

我的输出是否构成 XML 片段？我在样式表中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-16T03:30:51.327

例外是试图告诉您您已尝试在根元素的关闭元素之后输出文本。您的输出看起来正常的原因是异常*阻止*了生成无效的 XML。

原因很简单：您没有文档根目录的转换。因此，将执行默认转换。这些会将所有元素的文本内容作为文本节点输出。

添加

```
<xsl:template match="/">
    <xsl:apply-templates select="/Root/Documents/PO/DROPSHIP"/>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T18:24:53.257

您的输出确实构成了格式良好的 XML 片段。换句话说，它看起来不错，您的 XSLT 也不错。

似乎错误消息试图告诉您以下内容：

> 应用此 XSLT 会生成一个根据 DTD 或 Schema 或我用来验证输出的任何内容无效的文档，并且我`conformanceLevel`告诉我抱怨输出无效。如果您不关心有效性，请将 my 设置`conformanceLevel`为不那么肛门的东西。

请注意“格式良好”（符合标准的非验证 xml 解析器可以读取它）和“有效”（结构不遵循模式中指定的语法）之间的重要区别。

另请注意，在 XSLT 中不可能生成格式不正确的 XML 输出。

# java - 为什么你会选择 Java 编程语言而不是其他语言？

> ID：209555
> 
> 赞同：21
> 
> 时间：2008-10-16T17:39:45.440
> 
> 标签：java

为什么你会选择java而不是其他人？你为什么选择 java 来编写你的应用程序？

请包括您使用 java 的用途（桌面应用程序/Web 应用程序/移动设备）。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-16T17:44:00.127

*   优秀的工具：IDE、CI等。
*   大量的 3rd 方库。
*   大量可用的文档。
*   大量的开发人员可用。
*   平台无处不在。
*   完美的表现。
*   优良的规格。
*   强大的垃圾收集。
*   托管内存。
*   本机线程。
*   选择 - 由多个供应商实施。

我用Java构建了各种中间件产品：Inventory mgmt；内容管理系统；化学登记；等等

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-16T18:26:27.763

Java 的优点之一是*每个人都*知道它。当然，既然我已经这么说了，我会收到 80 条来自声称从未学过这门语言的人的评论。是因为它可能...

不管你喜不喜欢，Java 是最接近我们今天在业界所拥有的通用语言（该成语意为“通用语言”）的东西。几乎每个人都在某个时候使用过 Java，或者（更常见的是）现在正在积极使用它。这种无处不在对一些公司极具吸引力，尤其是那些依赖顾问的公司。如果您使用 Java 开始一个项目，那么您几乎可以保证能够找到人才来维护代码库多年。

另一方面，Java 是一种用于开发跨平台桌面应用程序的优秀语言……只是没有人知道它。Java 的大部分优势在于服务器端，再加上 J2ME 人群的一点点喜爱。但是，如果您客观地考虑 Java 6uN 中的 Swing，则很难找到更好的工具来完成这项工作。不要误会我的意思，我发现它有缺陷，但其中许多已在最近的版本中得到修复。现在的大部分问题都在讨论：每个人都*知道*Java 又慢又丑（这两者都不再是绝对正确的）。另一个问题是 Swing 是一个非常跨平台的 UI 工具包。这意味着在 Swing 中创建专业的 UI 本质上比在 Cocoa 甚至 WinForms 中要困难得多。

最后，选择 Java（而不是 .NET 或 Objective-C）的一个非常重要的理由是生态系统。其他答案提到了图书馆，这确实值得关注；但我特别想的是不断上升的语言多样性。如果您现在使用 Java 编写应用程序，您可以随时无缝过渡到 Scala。您还可以选择在 Groovy 或 JRuby 中编写脚本，更不用说利用 Clojure 中强大的并发抽象了。由于其可移植性和高级特性，JVM 越来越成为语言编译器和解释器的首选目标（甚至超过 CLR）。Java 确实处于这种关系的中心，并没有真正直接受益于围绕它的大量语言云，但肯定会从所有互操作性中获得价值，

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-19T17:57:11.207

My reasons for prefering Java over other programming languages at this time are:

*   price - it's free
*   performance - really fast these days thanks to the HotSpot JIT compiler
*   effectiveness - lots of power with rigorous features like type-safe, sand-boxed, etc.
*   OOP capability
*   very good, well-thought out exception handliing; C++ exceptions are the opposite!
*   portability - it runs on almost everything
*   tool availability - awesome IDEs like Eclipse & NetBeans are free, as are web servers like Tomcat and application servers (JBoss, Glassfish, Geronimo, etc.)
*   flexibility - does graphics, desktop GUIs, web user interfaces - all kinds of things in all kinds of runtime environments
*   aptness - many enterprise apps today have to support HTML, SQL, and XML - Java has good support for all of them built in and you can get third-party libraries for free that make this even easier/better
*   well-supported - Sun keeps adding improvements and fixing thing going one or two versions back
*   forward compatibility - unlike something like VB which undergoes wrenching change in its syntax every couple versions or so, Java's syntax and semantics seem about 99.9% upward compatible from version to version

I have been writing programs in Java for over a decade and I am pretty satisfied with it. I have used other languages for almost two decades before that. So I am not biased by describing the one thing I know - it is one of many languages I know intimately.

When upgrades to the JDK/JRE come out, I look the documentation over to see what is changed. Sun is good about telling/explaining this. I have never had an extremely rough time porting from one JDK to the next.

When I have switched from one OS to another as my main OS at home or at work, it has not caused a problem for the Java applications I write - or the tools I use, generally. The one exception is Borland JBuilder, which some Borland marketing or technical genius decided to frequently stop supporting. Eclipse and Netbeans run terrifically on the Mac and probably always will. I have used Java on:

*   MS-Windows 95, 98, NT4, 2000, XP
*   Sun Solaris/SunOS Unix
*   IBM AIX
*   Mac OS X
*   Linux
*   Motorola cell phones (MIDP, CLDC)
*   Palm Pilot PDA

Java VMs (virtual machines) are everywhere! They are in:

*   web browsers
*   cell phones
*   PDAs
*   desktop computers
*   web servers
*   application servers

I have written programs on all of these. All you have to do is get an IDE with the right plugins, get the API documentation for the target environment you want, and start programming.

The GUI programs I write actually do look & work correctly on different platforms! I cannot tell you how long other vendors promised to do and how often/long they have failed. Just look around, some still exist.

Sun promised this in Java 1.0 and they sort of delivered it with AWT. However, the abstract windowing toolkit used native GUI components and the differences between these components (which followed no unifying standard at all) were too great to get same/nice look/behavior on all platforms.

Sun delivered very well upon this portable GUI promise when the Swing GUI API was delivered a decade ago, back in December 1998.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-16T20:26:47.490

1) 很好的免费文档
2) 很好的开发人员商业和免费工具
3) 很好的认证和培训资源
4) 很好的运行时和免费工具
5) 很好的分析和监控工具
6) 来自不同公司的很好的支持选项
7) 很好拥有大量库的开源社区

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-16T17:48:42.550

尚未提及的事情：

*   跨平台桌面应用程序，即使具有复杂的 GUI
*   一堆工具
*   静态类型（见[GWT](http://code.google.com/webtoolkit/)）
*   编译时的错误信息
*   非常清楚的错误信息

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-16T17:41:31.677

Java 提供了非常丰富的开箱即用 API，并且可以轻松生成最便携的应用程序，因为几乎每个平台都有一个 Java VM。

顺便说一句：自从我在微软商店工作以来，我从大学毕业后就没有使用过 Java，但是我想不出我在 C# 中可以做的一件我在 Java 中做不到的事情，无论是企业应用程序， Web 应用程序或桌面应用程序。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-16T18:23:48.673

可移植性是java的关键。我知道我正在编写的程序可以在任何系统上运行，无需为不同的操作系统创建不同的版本。Java 还提供内置的安全性，使安全程序的编码更容易。
Java 速度快，[代码简洁](http://www.idiom.com/~zilla/Computer/javaCbenchmark.html)Java 的基准测试范围与 C++ 相同。

C# 是最常与 java 进行比较的语言。C# 不像 java 那样可移植，并且几乎没有 java 没有的特性。这使得 java 更具吸引力，除非程序只能在单个操作系统上运行，在这种情况下，我可能会用 C++ 对其进行编码。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-16T20:45:46.813

已经提到了很多重要的原因。我想添加政治部分。我相信 Suns 的语言比微软的替代品要多得多。这不是因为我讨厌微软，只是 Sun 正在朝着我真正喜欢的 Java 方向发展，而微软正在朝着我非常不喜欢的 .net 等方向发展。

这是非常主观的，我知道。但在我看来，Sun 似乎真的想创造一种伟大的语言，并尝试以某种方式赚钱。虽然微软似乎对通过供应商锁定和看起来很棒、感觉很棒的系统赚钱更感兴趣，但从长远来看可能不如看起来那么好。

所以微软现在处理它的方式，我什至不在乎它在技术上是好是坏。我不在乎，我不会使用它。

Java 拥有我想要从这种编程语言中得到的一切，包括大多数人只是跳过的所有无聊的政治内容。我不知道任何其他当前具有所有这些的语言。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-16T18:40:08.377

另一个好处是可用的很棒的静态分析工具，例如[FindBugs](http://findbugs.sourceforge.net/)。这些对您的代码执行的检查超出了编译器执行的检查，并且可以帮助在测试开始之前识别错误和/或代码异味。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-16T18:33:22.103

我从多年的 C++ 转向 Java，因为我正在研究更高级别的东西，并且需要我使用 Java 获得的内存管理、反射和沙盒执行的好处。

我在九十年代末尝试过 COM，但无法触摸它。

.NET 看起来很有前途，而且在很多方面现在都比 Java 好得多。不幸的是，以窗口为中心对我来说是一个彻底的破坏。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-02-09T18:34:50.990

我在大多数桌面应用程序项目中使用 Java 的主要原因是为了跨平台兼容性。让您的应用程序在 OS X、Windows 和 Linux 上运行并在所有平台上看起来都是原生的非常容易。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-19T15:48:41.200

请不要盲目追随所有 java-entousiasts。Java有它自己的缺陷。Java 非常适合快速开发、面向企业的东西和“高生产力”项目（拥有大量项目、社区......）。如果有人向我展示了一个标杆，它强调了 Java 代码如何与 C 代码一样优化，但这并不意味着完整的 Java 解决方案是快速且轻量级的。

Java 永远不会在一些性能关键的应用程序上找到它的方式，例如游戏、编解码器、Web 浏览器。没有主要的游戏软件是用java开发的，并不是因为开发者没有能力编写一段与C或C++速度相同的Java代码，这是因为语言本身的局限性涉及到性能和内存消耗。永远不会达到好的 C/C++ 代码。采用 VisualStudio 和 Eclipse。Java 非常适合一个东西（生产力的东西，企业中间件），但如果你想编写编解码器、游戏、性能关键库，你最好尝试了解 C。但是，另一方面，你将编写 java 代码更快、更安全，使用 C 和 C++，您将承担更多风险（指针！），这通常需要更多时间。

并且不要忘记“一次编写，到处调试”这个笑话，这其实是真的。您必须使用 Java 处理不同的 JVM 实现噩梦。

其他编程语言也有他们的兴趣，用于本地脚本的 bash/python 脚本（重复动作、快速 UI 等）。用于 Web 应用程序的 PHP 或 ruby​​ 在 Web 上得到了很好的部署和记录。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-16T18:01:30.403

我将 Java 用于我们的 BPM 平台，过去将 Java 用于企业 Web 应用程序。

这取决于你想做什么。考虑到语言特性、可用库和 IDE 经验，我个人会选择 C# 而不是 Java。C# 3.0 有许多 Java 缺乏的有用特性，例如 LINQ、Lambda 表达式等。有些人更喜欢 Java 可用的庞大库选择，但我认为做事的方式太多了。Eclipse 和 NetBeans 等 Java IDE 越来越好，但我认为 Visual Studio 仍然更容易使用。

当然，如果您不使用 Windows，那么您别无选择，只能选择 Java。Ruby 和 Python 可以成为实用程序应用程序和 GUI（包括 Web 应用程序）之类的不错选择，但对于不使用 Windows 的企业应用程序，Java 几乎是唯一的选择。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-16T17:45:22.060

将其用于桌面应用程序。

提供优秀的 IDE，出色的 API，“C 风格”语法使其易于上手。JVM 启动后，性能非常好。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-17T02:53:39.940

为什么我会选择 Java——它是目前最流行的语言吗？如果不是，那肯定很接近，所以如果我正在构建一个产品，我可能会选择这个，因为它最容易雇佣开发人员。

我为什么选择 Java——因为它是我最了解的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-16T18:42:45.983

为什么我会选择 Java？如果我碰巧有一个~~[可替换的](http://www.perlmonks.org/?node_id=142987) [代码猴子](http://www.perlmonks.org/?node_id=41253)~~开发人员团队，他们对 Java 的了解比其他任何东西都好，那可能就是我会选择的。

# sql - rails ActiveRecord find_by_sql 调用的结果的列顺序

> ID：209558
> 
> 赞同：4
> 
> 时间：2008-10-16T17:40:47.870
> 
> 标签：sql, ruby-on-rails, ruby, activerecord

我正在尝试整理一些基本的报告屏幕。我有一些相当复杂的 SQL 查询，我将它们输入 ActiveRecord 的 find_by_sql 方法。我在这里遇到的问题是我丢失了原始查询中给出的列顺序。我假设这是因为 Hash 类不保留其键的输入顺序。

有没有办法解决这个问题？我应该使用不同的方法然后 find_by_sql 进行查询吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:08:44.433

我喜欢使用[Ruport](https://ruport.github.io/)进行报告。它具有良好的 ActiveRecord 集成，它使您能够控制列顺序和几乎任何其他内容。而且它使用起来非常简单，即使对于“基本”报告，我也不认为它过大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:21:28.917

您是正确的，因为 Ruby Hash 不保留顺序。这确实是重点的一部分——您可以使用密钥访问它。

我假设您的查询是按照您想要输出它们的顺序提供列并且您希望通过循环输出值？似乎是一个足够体面的想法，但如果没有至少一些额外的工作，我想不出一种方法来实现它。

我建议在模板中通过键显式访问列，因为您可能最终会应用样式，使用辅助函数（如 number_with_delimiter）进行格式化，诸如此类。

要获得类似于上述快捷方式的内容，我想您可以按所需顺序创建一个符号数组，并在循环中将值从散列中提取出来。像这样的东西？（请原谅潜在的狡猾的erb：我是一个[haml](http://haml.hamptoncatlin.com/)用户！）

```
<% for row in @report.rows %>
    <tr>
    <% for col in [:a, :b, :c] %>
        <td><%= row[col] %></td>
    <% end %>
    </tr>
<% end %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-22T11:48:27.683

在 Rails 3.2 及更高版本中，您可以将`attribute_names`其用于每个`find_by_sql`结果记录。这记录在[find_by_sql](http://api.rubyonrails.org/classes/ActiveRecord/Querying.html#method-i-find_by_sql)中：

> 对您的数据库执行自定义 SQL 查询并返回所有结果。结果将作为数组返回，请求的列封装为您从中调用此方法的模型的属性。如果您调用`Product.find_by_sql`，则结果将在具有`Product`您在 SQL 查询中指定的属性的对象中返回。
> 
> 如果您调用跨越多个表的复杂 SQL 查询，则 SELECT 指定的列将是模型的属性，无论它们是否是相应表的列

对于模型，您可以使用 column_names。有关变体的更多信息，请参阅其他 SA 答案：[您如何在 Rails 中发现模型属性](https://stackoverflow.com/questions/1289557/how-do-you-discover-model-attributes-in-rails)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T18:40:53.227

您是如何创建这些“报告屏幕”的？它们是 erb 模板吗？您是否只是在列上调用 .each 以将它们全部打印出来？

如果是这种情况，您可以覆盖模型中的 columns() 方法以返回一个有序数组。

# debugging - 需要帮助：VS 2005 属性更改

> ID：209582
> 
> 赞同：1
> 
> 时间：2008-10-16T17:47:44.613
> 
> 标签：debugging, visual-studio-2005, properties

我在 Visual Studio 2005 中工作。我在屏幕上有多个拆分器。我已经设置了拆分器 IsFixed 并且还设置了固定面板尺寸。除此之外，我还锁定了控件。出于某种原因，当我切换到调试模式时，分离器距离值会完全自行改变。这些变化不会以任何一致性发生，距离的变化发生了变化。其他也被锁定的组件也在自行移动。

有类似经历的人吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T17:55:36.423

设置将坚持您所处的任何一种模式。但有时插件或 VS 的部分确实会搞砸:(

我记得看到一个为保存“视图”而编写的插件，但是当我尝试它时，它没有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T17:59:31.127

我无法告诉你这是什么原因造成的。windows 窗体拆分器的工作方式是通过 Docking 属性。不需要锁定控件。窗体上的所有控件都应该停靠。（包括分线器）

例如，如果要垂直拆分，则将第一个面板停靠在左侧。然后拆分器（方向设置为垂直）也停靠在左侧。第二个面板停靠以填充。第一个面板（停靠在左侧）的宽度将确定拆分器的位置。现在不应该改变。

z 顺序在这里对于布局目的很重要。如果您想更详细地了解控件在表单上的放置方式，请打开文档大纲。这将在树中列出控件，您可以看到它们在 z 顺序中的位置。

# .net - 如何对 LINQ to XML 中的元素进行深层复制？

> ID：209595
> 
> 赞同：82
> 
> 时间：2008-10-16T17:52:02.153
> 
> 标签：.net, linq-to-xml

我想制作一个 LINQ to XML XElement 的深层副本。我想这样做的原因是文档中有一些节点我想创建修改后的副本（在同一个文档中）。我没有看到这样做的方法。

我可以将元素转换为 XML 字符串，然后重新解析它，但我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-12-10T15:35:21.423

无需重新解析。XElement 的构造函数之一采用另一个 XElement 并对其进行深层复制：

```
XElement original = new XElement("original");
XElement deepCopy = new XElement(original); 
```

这里有几个单元测试来演示：

```
[TestMethod]
public void XElementShallowCopyShouldOnlyCopyReference()
{
    XElement original = new XElement("original");
    XElement shallowCopy = original;
    shallowCopy.Name = "copy";
    Assert.AreEqual("copy", original.Name);
}

[TestMethod]
public void ShouldGetXElementDeepCopyUsingConstructorArgument()
{
    XElement original = new XElement("original");
    XElement deepCopy = new XElement(original);
    deepCopy.Name = "copy";
    Assert.AreEqual("original", original.Name);
    Assert.AreEqual("copy", deepCopy.Name);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-16T18:17:41.823

看起来 ToString 和 reparse 方法是最好的方法。这是代码：

```
XElement copy = XElement.Parse(original.ToString()); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T14:00:47.347

简而言之，直接从[C# 3.0 中](https://rads.stackoverflow.com/amzn/click/com/0596527578)提取：

当节点或属性被添加到元素时（无论是通过函数构造还是 Add 方法），节点或属性的 Parent 属性被设置为该元素。一个节点只能有一个父元素：如果您将一个已经成为父节点的节点添加到第二个父节点，该节点将自动进行深度克隆。在以下示例中，每个客户都有一份单独的地址副本：

```
var address = new XElement ("address",
                  new XElement ("street", "Lawley St"),
                  new XElement ("town", "North Beach")
              );
var customer1 = new XElement ("customer1", address);
var customer2 = new XElement ("customer2", address);

customer1.Element ("address").Element ("street").Value = "Another St";
Console.WriteLine (
  customer2.Element ("address").Element ("street").Value);   // Lawley St 
```

这种自动复制使 X-DOM 对象实例化没有副作用——函数式编程的另一个标志。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-08-16T15:26:17.170

这应该有效：

```
var copy = new XElement(original.Name, original.Attributes(),
                        original.Elements() ); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-10-16T17:58:21.517

我不相信存在允许您执行 XNode 样式树的深层副本的现有机制。我认为你有两个选择。

1.  按照您的建议执行转换为字符串，然后再转换回树
2.  用访客模式写在自己身上

访问者模式当然是可能的，但需要大量工作才能进行测试。我认为你最好的选择是#1。

# c++ - 从 C/C++ 程序使 LED 闪烁的步骤？

> ID：209603
> 
> 赞同：13
> 
> 时间：2008-10-16T17:55:34.143
> 
> 标签：c++, c, circuit

从 C/C++ 程序制作带有 LED 闪光灯的小电路最简单的步骤是什么？

我希望所需的依赖项和软件包数量最少。

*   我会将某些东西连接到哪个端口？
*   我会使用哪个编译器？
*   如何将数据发送到该端口？
*   我需要有一个微处理器吗？如果不是，我不想在这个简单的项目中使用一个。

编辑：对任何操作系统特定的解决方案感兴趣。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-16T18:11:54.890

这是使用[并行端口](http://ashishrd.blogspot.com/2006/11/controlling-leds-with-parallel-port.html)进行操作的教程。

虽然我会推荐一个可以非常便宜地购买并且只涉及以下代码的[Arduino ：](http://www.arduino.cc)

```
/* Blinking LED
 * ------------
 *
 * turns on and off a light emitting diode(LED) connected to a digital  
 * pin, in intervals of 2 seconds. Ideally we use pin 13 on the Arduino 
 * board because it has a resistor attached to it, needing only an LED

 * 
 * Created 1 June 2005
 * copyleft 2005 DojoDave <http://www.0j0.org>
 * http://arduino.berlios.de
 *
 * based on an orginal by H. Barragan for the Wiring i/o board
 */

int ledPin = 13;                 // LED connected to digital pin 13

void setup()
{
  pinMode(ledPin, OUTPUT);      // sets the digital pin as output
}

void loop()
{
  digitalWrite(ledPin, HIGH);   // sets the LED on
  delay(1000);                  // waits for a second
  digitalWrite(ledPin, LOW);    // sets the LED off
  delay(1000);                  // waits for a second
} 
```

![替代文字](https://arduino.cc/en/uploads/Tutorial/LedOnPin13.jpg)

[http://www.arduino.cc/en/Tutorial/BlinkingLED](http://www.arduino.cc/en/Tutorial/BlinkingLED)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T18:16:59.950

**哪个港口？** 并行端口是我最喜欢的选择，因为它输出 +5V（TTL 逻辑电平）并且编程非常简单。大多数并行端口都有足够的功率来驱动 LED。重要的是要记住，计算机端口通常设计为仅输出信号电压，而不是产生足够的电流来实际为大多数设备供电。

**哪个编译器？** 没关系。不过，这种硬件黑客在 Linux 下更有趣、更容易，所以 GCC 是一个不错的选择。

**如何发送数据？** 取决于端口和操作系统。USB 对于一个简单的项目来说非常复杂，所以忘记它吧。串行和并行端口可以通过各种不同的接口进行控制。我的偏好是使用`ioctl()`Linux 下的系统调用来直接控制并口引脚。以下是有关如何执行此操作的信息：[http ://www.linuxfocus.org/common/src/article205/ppdev.html](http://www.linuxfocus.org/common/src/article205/ppdev.html)

**我需要微处理器吗？** 不，您不需要外部设备中的微处理器（显然您的计算机有微处理器：-P）。如果您使用并行或串行端口，您可以只使用 LED 和一个或两个电阻器以及直接连接 LED 的必要部件。

（另外：可在线免费获得的*Linux 设备驱动程序书*，其中包含有关将简单电子设备连接到并行端口并为它们编写内核驱动程序的信息。）

*编辑：*这个线程似乎对OP的含义有很大的困惑，“我需要微处理器吗？” 强调一下，单独的并口可以驱动基于*计算机中*的软件的LED 。设备中不需要微处理器。但是，如果您希望设备能够在**不连接到计算机的情况下自行控制，****则**需要微处理器或其他一些数字逻辑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T18:25:00.420

如果您想在没有微处理器的情况下使 LED 闪烁（这意味着没有 C/C++），使用 555 定时器 IC 的简单电路就可以了。这些是初学者爱好者电子书籍或工具包中的常见项目，因为它们非常简单，您可以在任何 Radio Shack 类型的地方获得零件：

*   [http://www.kpsec.freeuk.com/projects/flashl.htm](http://www.kpsec.freeuk.com/projects/flashl.htm)
*   [http://www.electronics-project-design.com/LED-Flasher-Circuit.html](http://www.electronics-project-design.com/LED-Flasher-Circuit.html)

如果你想用软件来做，正如[Vlion 提到](https://stackoverflow.com/questions/209603/steps-to-make-a-led-blink-from-a-cc-program#209609)的，一切都取决于所使用的硬件和连接 LED 的电路的设计。

如果您想尝试在您的 PC 上弄乱一些东西，这里有一篇关于如何闪烁连接到 PC 并行端口上的引脚的 LED 的文章：

*   [http://www.codeproject.com/KB/cs/csppleds.aspx](http://www.codeproject.com/KB/cs/csppleds.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T18:10:28.887

您可以尝试在串行端口传输（引脚 3）上放置一个 LED 和一个 300 欧姆电阻器到接地（引脚 5）。然后发送数据将其打开。

串口可能只能提供 10mA 的电流。

祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T18:19:19.680

对于快速和肮脏的操作，您有 2 个简单的选择：串行或并行端口。串口更简单，但受 LED 数量限制。

要连接 LED，您需要一个正确性别的外壳连接器 (DB25/DB9)、LED 和一个电阻器。您必须自己查找电阻器的值。

串行端口具有受程序员控制的控制流信号。将正确的位输出到 MCR 寄存器是一件简单的事情（在打开串行端口之后）。

并行端口有点难，因为要进行更多的握手，但通常与写入寄存器的原理相同。

您可能必须与您的操作系统抗争才能获得对端口的控制权。

使用 Tx 线有点复杂，因为输出的信号是写入发送寄存器的数据的串行比特流。我会坚持 CTS 和 DSR 信号。

为了进行快速而肮脏的调试，我刚刚写入了寄存器并观察了调制解调器的指示灯。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T18:09:43.273

它还取决于操作系统。在 Linux 上，您可以将 LED 直接连接到并行端口（当然，使用适当的限流电阻）并简单地使用 C 函数“outb()”来打开和关闭它。

在 Windows 上，它要复杂得多，因为操作系统不允许用户应用程序直接与端口通信。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T18:11:34.517

最简单的端口是串行或并行。永远记得在 LED 上串联一个电阻器，否则会烧坏它。

# asp.net - 是否有任何工具可以从 JavaScript 代码中自动删除注释？

> ID：209607
> 
> 赞同：4
> 
> 时间：2008-10-16T17:56:48.183
> 
> 标签：asp.net, javascript, comments

我想在我的代码中添加注释，但我希望在部署之前将它们删除。是的，写这样的东西并不难，但是如果它已经存在的话……那么在 ASP 页面中的注释呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T18:04:37.060

[YUI Compressor](http://developer.yahoo.com/yui/compressor/)除了删除注释和空格外，还使用尽可能小的变量名来混淆局部变量......

除了实用程序之外，还有[适用于 .NET 的 YUI Compressor Library](http://www.codeplex.com/YUICompressor)，该库允许您以编程方式压缩 JavaScript 和 CSS，或与 MsBuild 一起自动使用它...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T18:02:26.407

听起来您正在寻找 JSMin 工具或类似工具。

您可以购买许多工具，但也可以使用一些在线工具：

[http://www.askapache.com/tools/online-compression-tool-compares-packer-jsmin-dojo-and-yui-compressor.html](http://www.askapache.com/tools/online-compression-tool-compares-packer-jsmin-dojo-and-yui-compressor.html)

[http://www.askapache.com/online-tools/js-compress/](http://www.askapache.com/online-tools/js-compress/)

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T18:06:45.790

你要在运行时压缩吗？我会使用[打包](http://www.smallsharptools.com/Projects/Packer/)程序并通过通用处理程序压缩您的 javascript。

# sql - 从提取多个值的列中查询单个值

> ID：209615
> 
> 赞同：0
> 
> 时间：2008-10-16T17:58:50.877
> 
> 标签：sql, function

使用以下查询：

```
 SELECT pe.prodtree_element_name_l, MAX(rs.resource_value) AS resource_value
    FROM prodtree_element pe
    LEFT JOIN resource_shortstrings rs
        ON pe.prodtree_element_name_l_rk = rs.resource_key
    WHERE rs.language_id = '5'
        AND pe.prodtree_element_name_l <> ''
    GROUP BY prodtree_element_name_l 
```

我试图弄清楚如何获取任何“resource_value”。问题是虽然这适用于许多其他查询，但我有一个使用 ntext 数据类型而不是 varchars 的特定表（它不能利用 MAX 函数）。所以基本上，MAX在这里不起作用。我可以在 MS SQL Server 2005 上使用替代品吗？

我需要对 prodtree_element_name_l 列进行分组，但我只需要 resource_value 列中的一个值，而且我不在乎它是什么，因为它们中的大多数都是相同的（尽管有些不是，因此我也不能对那个进行分组）。

更新：

哎呀，我错了，prodtree_element_name_l 也是一个 NTEXT。这可能会有所帮助：p

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T18:20:57.883

这将获得第一个随机条目

```
SELECT DISTINCT 
     pe.prodtree_element_name_l, 
    (SELECT TOP 1 rs2.resource_value
    FROM resource_shortstrings rs2
    WHERE rs2.language_id = '5'
      AND rs2.resource_key = pe.prodtree_element_name_l_rk) AS "resource_value"
FROM prodtree_element pe
LEFT JOIN resource_shortstrings rs
    ON pe.prodtree_element_name_l_rk = rs.resource_key
WHERE rs.language_id = '5'
    AND pe.prodtree_element_name_l IS NOT NULL
--GROUP BY prodtree_element_name_l 
```

**笔记**

在您的查询中，您使用的是 LEFT JOIN，但也使用了左连接表上的过滤器，因此限制了记录集。我把它留在了原地，因为我认为它会改变你的结果......但是做 LEFT JOIN 没有意义。

**编辑**

根据评论中的反馈，我将 group by 注释掉并切换到不同的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T18:01:37.907

```
 SELECT pe.prodtree_element_name_l, MAX(CAST(rs.resource_value AS NVARCHAR(MAX))) AS resource_value
    FROM prodtree_element pe
    LEFT JOIN resource_shortstrings rs
        ON pe.prodtree_element_name_l_rk = rs.resource_key
    WHERE rs.language_id = '5'
        AND pe.prodtree_element_name_l <> ''
    GROUP BY prodtree_element_name_l 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:13:38.117

我收到错误：

```
The data types ntext and varchar are incompatible in the not equal to operator. 
```

除非我错过了什么？

编辑：检查顶部。

# architecture - 架构设计模式

> ID：209641
> 
> 赞同：10
> 
> 时间：2008-10-16T18:07:57.207
> 
> 标签：architecture, design-patterns

我正在寻找一些用于企业应用程序开发的架构设计模式。我知道所有的 GoF 模式、MVC 和类似的东西，但我正在寻找在更大范围内出现的模式。特别是我有一个更大的企业桌面和网站应用程序，它们共享某些功能，有些是独一无二的，我正在寻找关于如何构建整个解决方案、如何通过工厂向其他人公开业务逻辑域的最佳实践，或者这样的，通常是这种性质的东西，它们将整个应用程序作为一个整体来处理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T18:14:25.447

看看 Jeffrey Palermo 的[洋葱架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)。这种架构将应用程序的核心（域模型、域服务、应用程序服务）置于中心位置。核心不引用其他任何东西，其他一切都引用核心。持久性是核心之上的一层，UI 也是如此，测试也是如此。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T18:17:11.900

Martin Fowler 有[企业应用架构模式](http://martinfowler.com/books.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T18:25:18.610

我建议 Eric Evans 的[领域驱动设计](http://domaindrivendesign.org/books/#DDD)- 特别是第 3 和第 4 节。

# sql - SQL 中的 REPLACE 和 Unicode 字符

> ID：209655
> 
> 赞同：6
> 
> 时间：2008-10-16T18:11:04.003
> 
> 标签：sql, sql-server, unicode

我有一些带有混乱重音字符的数据。例如在数据中，我们有类似的东西

`ClΘmentine`

那应该读

`Clémentine`

我想用脚本清理它，但是当我这样做时

```
 Select Replace('ClΘmentine', 'Θ', 'é') 
```

这就是我得到的：

`Clémenéine`

显然 Θ 匹配 Θ 和 t。任何想法发生了什么以及我能做些什么来完成这项工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-16T18:19:58.463

试试这个（假设你有 SQL 服务器，我可以在其中重现该行为）：

```
Select Replace(N'ClΘmentine', N'Θ', N'é') 
```

您必须告诉 SQL Server 它处理 Unicode 字符串，这就是 N 的用途。

# html - 如何使页脚垂直拉伸？

> ID：209657
> 
> 赞同：3
> 
> 时间：2008-10-16T18:11:40.010
> 
> 标签：html, css, footer

我有一个 1 x 70 像素的页脚，设置为背景和水平平铺。

如果网页上不包含很多内容，它将在页脚应该在的位置上方显示页脚。我希望它用纯色填充，所以如果他们向下滚动，它不会显示页脚，然后是页脚下的白色。

这是我为页脚设置的样式。

```
.footer{
    background:#055830 url('/images/footer_tile.gif') repeat-x top left;
    color:#fff;
    font-size:12px;
    height: 70px;
    margin-top: 10px;
    font-family: Arial, Verdana, sans-serif;
    width:100%;
} 
```

![替代文字](https://i.stack.imgur.com/pUzIQ.jpg)

我希望页脚看起来像这样： ![替代文字](https://i.stack.imgur.com/s96Ft.jpg)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T18:20:16.950

请澄清 - 你想要底部的纯绿色吗？如果是这样，只需为 body 设置一个绿色背景...

```
body {
    background-color:#060;
} 
```

这应该会在您的第二个屏幕截图中为您提供结果。更改颜色以匹配渐变图像的底部。

如果您希望脚钉在底部，请使用提到的绝对定位，并将背景设置为与渐变图像的顶部相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T18:25:49.620

你可以改变你的身体风格，让页脚融入其中。

```
body {

background: rgb(173, 173, 173);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:14:45.527

您可以使用

```
position:absolute;
bottom: 0; 
```

将页脚始终放在底部...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T18:15:33.840

尝试以下操作：

```
.footer{
    background:#055830 url('/images/footer_tile.gif') repeat top left;
    color:#fff;
    font-size:12px;
    height: 100%;
    margin-top: 10px;
    font-family: Arial, Verdana, sans-serif;
    width:100%;
} 
```

我改变了两件事：背景设置为“重复”而不仅仅是“重复-x”，这样它也会重复下来。并且高度设置为“100%”，这应该使其扩展以填充可用空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T18:28:51.877

```
.footer{
    background:#055830 url('/images/footer_tile.gif') repeat top left;
    color:#fff;
    font-size:12px;
    margin-top: 10px;
    font-family: Arial, Verdana, sans-serif;
    width:100%;
    position:absolute;
    bottom: 0;
} 
```

我尝试了将底部设置为零的绝对位置，这是它所做的屏幕。

[它在页脚和 col-middle alt 文本](http://img266.imageshack.us/img266/7051/picture4vb3.jpg)之间显示一个空格 http://img266.imageshack.us/img266/7051/picture4vb3.jpg

# wpf - 部署后如何更新 XBAP 的配置文件？

> ID：209661
> 
> 赞同：4
> 
> 时间：2008-10-16T18:12:49.477
> 
> 标签：wpf, deployment, config, xbap

我们有一个 WPF XBAP 应用程序，我们希望在部署后更改服务器上的配置。由于配置文件嵌入在部署文件中，这怎么可能？

例如，我们想要更改已部署的应用程序连接到的数据库连接字符串，或者我们想要更新它连接到的 WCF 服务绑定设置？我们希望更新服务器上的配置文件，而不必每次都重新编译和重新部署。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T18:09:48.403

SDK 目录中有一个名为 MageUI.exe 的程序。该程序允许您创建和编辑应用程序部署清单。您可以更新配置文件，然后使用 MageUI 编辑部署清单并导入新的配置文件。

根据应用程序的大小，在 Visual Studio 中点击发布可能比使用 MageUI 和编辑部署清单更容易。

或者，您可以让您的应用程序通过 HTTP 请求在部署服务器上查看更新配置的配置文件（重命名为 .config 以外的其他文件，因为 ASP.NET 默认阻止这些文件）。

# c# - 将 List<> 传递给 SQL 存储过程

> ID：209686
> 
> 赞同：51
> 
> 时间：2008-10-16T18:20:30.007
> 
> 标签：c#, sql, sql-server, tsql, stored-procedures

我经常不得不将多个项目加载到数据库中的特定记录中。例如：网页显示单个报表要包含的项目，所有这些项目都是数据库中的记录（Report 是 Report 表中的记录，Items 是 Item 表中的记录）。用户正在通过 Web 应用程序选择要包含在单个报告中的项目，假设他们选择了 3 个项目并提交。该过程将通过将记录添加到名为 ReportItems (ReportId,ItemId) 的表中来将这 3 个项目添加到此报告中。

目前，我会在代码中做这样的事情：

```
public void AddItemsToReport(string connStr, int Id, List<int> itemList)
{
    Database db = DatabaseFactory.CreateDatabase(connStr);

    string sqlCommand = "AddItemsToReport"
    DbCommand dbCommand = db.GetStoredProcCommand(sqlCommand);

    string items = "";
    foreach (int i in itemList)
        items += string.Format("{0}~", i);

    if (items.Length > 0)
        items = items.Substring(0, items.Length - 1);

    // Add parameters
    db.AddInParameter(dbCommand, "ReportId", DbType.Int32, Id);
    db.AddInParameter(dbCommand, "Items", DbType.String, perms);
    db.ExecuteNonQuery(dbCommand);
} 
```

这在存储过程中：

```
INSERT INTO ReportItem (ReportId,ItemId)
SELECT  @ReportId,
          Id
FROM     fn_GetIntTableFromList(@Items,'~') 
```

函数返回一列整数表。

我的问题是：有没有更好的方法来处理这样的事情？请注意，我不是在询问数据库规范化或类似的问题，我的问题与代码特别相关。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-21T20:48:47.787

如果您可以选择使用 SQL Server 2008，那么有一个名为“表值参数”的新功能可以解决这个确切的问题。

[在此处](http://blog.benhall.me.uk/2007/07/sql-server-2008-table-value-parameters.html)和[此处](http://www.mssqltips.com/tip.asp?tip=1483)查看有关 TVP 的更多详细信息，或者只是向 Google 询问“SQL Server 2008 表值参数” - 您会找到大量信息和示例。

强烈推荐 -*如果*您可以迁移到 SQL Server 2008...

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-16T18:28:31.333

您的字符串连接逻辑可能可以简化：

```
string items = 
    string.Join("~", itemList.Select(item=>item.ToString()).ToArray()); 
```

这将为您节省一些字符串连接，这在 .Net 中很昂贵。

我认为您保存项目的方式没有任何问题。您正在限制对数据库的访问，这是一件好事。如果您的数据结构比整数列表更复杂，我建议使用 XML。

**注意：**我在评论中被问到这是否会为我们节省任何字符串连接（确实如此）。我认为这是一个很好的问题，并愿意跟进。

If you peel open string.Join with [Reflector](http://www.red-gate.com/products/reflector/index.htm) you will see that Microsoft is using a couple of unsafe (in the .Net sense of the word) techniques, including using a char pointer and a structure called UnSafeCharBuffer. What they are doing, when you really boil it down, is using pointers to walk across an empty string and build up the join. Remember that the main reason string concatenation is so expensive in .Net is that a new string object is placed on the heap for every concatenation, because string is immutable. Those memory operations are expensive. String.Join(..) is essentially allocating the memory once, then operating upon it with a pointer. Very fast.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-16T19:21:55.687

您的技术的一个潜在问题是它不能处理非常大的列表 - 您可能会超过数据库的最大字符串长度。我使用一个辅助方法将整数值连接成一个字符串枚举，每个字符串都小于指定的最大值（以下实现还可以选择检查并删除重复的 id）：

```
public static IEnumerable<string> ConcatenateValues(IEnumerable<int> values, string separator, int maxLength, bool skipDuplicates)
{
    IDictionary<int, string> valueDictionary = null;
    StringBuilder sb = new StringBuilder();
    if (skipDuplicates)
    {
        valueDictionary = new Dictionary<int, string>();
    }
    foreach (int value in values)
    {
        if (skipDuplicates)
        {
            if (valueDictionary.ContainsKey(value)) continue;
            valueDictionary.Add(value, "");
        }
        string s = value.ToString(CultureInfo.InvariantCulture);
        if ((sb.Length + separator.Length + s.Length) > maxLength)
        {
            // Max length reached, yield the result and start again
            if (sb.Length > 0) yield return sb.ToString();
            sb.Length = 0;
        }
        if (sb.Length > 0) sb.Append(separator);
        sb.Append(s);
    }
    // Yield whatever's left over
    if (sb.Length > 0) yield return sb.ToString();
} 
```

然后你像这样使用它：

```
using(SqlCommand command = ...)
{
    command.Connection = ...;
    command.Transaction = ...; // if in a transaction
    SqlParameter parameter = command.Parameters.Add("@Items", ...);
    foreach(string itemList in ConcatenateValues(values, "~", 8000, false))
    {
        parameter.Value = itemList;
        command.ExecuteNonQuery();
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-16T18:25:54.940

你要么做你已经得到的，传入一个分隔的字符串，然后解析出一个表值，或者另一个选择是传入一个 XML 的 wodge，有点相同：

[http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx](http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx)

我还没有机会查看 SQL 2008，看看他们是否添加了任何新功能来处理这类事情。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-06-11T20:06:40.383

为什么不使用表值参数？ [https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/table-valued-parameters](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/table-valued-parameters)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-16T19:26:59.810

有关此问题的详细讨论以及您可以使用的不同方法，请参阅[http://www.sommarskog.se/arrays-in-sql-2005.html](http://www.sommarskog.se/arrays-in-sql-2005.html)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-09-28T14:24:38.240

这是 sqlteam.com 对表值参数的一个非常清晰的解释：[表值参数](http://www.sqlteam.com/article/sql-server-2008-table-valued-parameters)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T23:04:10.357

**在存储过程中查询单个字段的多个值**
[http://www.norimek.com/blog/post/2008/04/Query-a-Single-Field-for-Multiple-Values-in-a-Stored-Procedure .aspx](http://www.norimek.com/blog/post/2008/04/Query-a-Single-Field-for-Multiple-Values-in-a-Stored-Procedure.aspx)

# xml - 订购值

> ID：209687
> 
> 赞同：0
> 
> 时间：2008-10-16T18:20:38.447
> 
> 标签：xml, xslt

我正在尝试根据属性值订购商品：

```
<xsl:apply-templates select="Question">
    <xsl:sort order="ascending" select="@Value"></xsl:sort>
</xsl:apply-templates> 
```

这确实对它们进行了排序，但我可以有像 1,2,3, ... 10, 11, ... 20 这样的值，它会为它们排序 1,10,11, ... 2,20... 3。等等。
我也可以有像 1.A、1.B、2.A、2.B 等这样的值。

我如何排序这些值以在该优先级中考虑数字内容和字母？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T19:04:49.997

如果您知道每个问题都有一个多部分编号，则可以使用两条`<xsl:sort>`指令来处理它们：

```
<xsl:apply-templates select="Question">
  <xsl:sort select="substring-before(@Value, '.')" data-type="number" />
  <xsl:sort select="substring-after(@Value, '.')" />
</xsl:apply-templates> 
```

如果有些数字可能有多个部分，而有些则没有，我想最好的办法是：

```
<xsl:apply-templates select="Question">
  <xsl:sort select="substring-before(concat(@Value, '.'), '.')" data-type="number" />
  <xsl:sort select="substring-after(@Value, '.')" />
</xsl:apply-templates> 
```

额外的在值的末尾`concat(@Value, '.')`添加一个 ' `.`' 以便`substring-before()`始终获取数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T18:25:02.867

[`data-type`](http://www.w3.org/TR/xslt#sorting)您可以使用以下属性按数字顺序排序：

```
<xsl:sort order="ascending" select="@Value" data-type="number"></xsl:sort> 
```

内置排序功能不支持更复杂的排序（例如您提到的多部分键）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:39:59.810

对于[排序](http://www.w3schools.com/xsl/el_sort.asp)数字，您可以使用：

```
<xsl:template match="employees">
  <xsl:apply-templates>
    <xsl:sort select="salary" data-type="number"/>
  </xsl:apply-templates>
</xsl:template> 
```

请注意，[此处](http://www.xml.com/pub/a/2002/07/03/transform.html)`data-type`使用了该属性。对于像 1.A, 1.B, 2.A, 2.B 这样的值，您将再次返回文本，并且将不得不求助于可能求助于丑陋嵌套的聪明东西。请考虑可以以有趣方式使用的[元素。](http://www.w3schools.com/xsl/el_number.asp)`xsl:number`

# sql - 单个索引与多个字段索引

> ID：209691
> 
> 赞同：2
> 
> 时间：2008-10-16T18:22:14.730
> 
> 标签：sql, indexing

目前，我们有一个用于跟踪邀请的表。我们有一个已编入索引的电子邮件字段，但我们还有三个可选键，用户可以在添加新记录电子邮件时指定它们。我们不允许重复，因此我们必须查询电子邮件和可选键是否已经存在。目前，如果指定了键，则仅将键添加到 select 语句中。正常情况是仅指定电子邮件并使用索引它工作得相当快。添加键时性能下降。

添加三个索引会影响其他操作的性能吗？密钥可能很少使用，我们不想影响这种情况下的性能。

*   电子邮件，key1
*   电子邮件，key1，key2
*   电子邮件，key1，key2，key3

另一个想法是我们添加 1 个密钥。

*   电子邮件，key1，key2，key3

然后始终在查找中使用所有 3 个键（例如 key1 = mykey AND key2 为 NULL AND key3 为 NULL）

**也可以看看**

[完全重复的帖子](https://stackoverflow.com/questions/179085/multiple-indexes-vs-multi-column-indexes)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T18:26:56.560

我个人会推荐这种方法。

尝试使用涵盖所有内容的单个索引的方法，如果我没记错的话，如果您只查询包含的第一个列，它仍然会表现良好。建立索引后，运行 Index Advisor。

然后尝试另一条路线并重复。

这真的取决于你的数据。

我通常能够使用 1 个覆盖索引，首先从最常用的键开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T18:25:01.353

这取决于表的更新频率以及索引的复杂程度。如果您疯狂地创建索引，那么每次插入/更新/删除记录时，都必须修改每个索引以反映该信息。

如果你只放了三个索引，而且比较简单，那么你应该没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:30:36.163

我可能是错的，但我相信如果你添加：

*   电子邮件，key1，key2，key3

作为索引，如果您的查询使用“email”、“email/key1”、“email/key1/key2”等，大多数数据库都会使用它……而无需您为缺失的字段指定 Null 值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T08:27:25.537

正如其他人所说，大多数数据库在仅搜索 a、a 和 b 或 a、b 和 c 时将使用索引“a、b、c”。而且他们通常每个表只使用一个索引。所以添加“email，key1，key2，key3”可能是最好的。

也就是说，使用 EXPLAIN 来找出真正发生的事情。检查以确保您的查询正在使用哪些索引（如果有）。每个数据库都有其怪癖。

# http - 为什么服务器不设置 HTTP 响应代码？

> ID：209706
> 
> 赞同：2
> 
> 时间：2008-10-16T18:26:17.857
> 
> 标签：http, response

我在笼统地问 - 为什么任何服务器都不会设置并返回标头和/或状态码？我想不出一个很好的理由。也许我忽略了一些东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T18:32:53.693

状态码是 HTTP 响应的必需部分。

根据定义，服务器不提供状态行的唯一原因是它不是 HTTP 服务器。

[RFC 2616，第 6 节：响应](http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6)。

或者用一种稍微不那么迂腐的方式说：如果它这样做，服务器就会出现故障，你应该尖叫着逃离它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T20:32:57.120

状态码是在 HTTP/1.0 中引入的——在此之前，[事情要简单得多](http://www.w3.org/Protocols/HTTP/AsImplemented.html)——请求或响应中没有标头。

请求就是这样，没有说明协议版本

```
GET / 
```

响应将是全部正文，没有标题。

所以看起来你正在与某种只说 HTTP/0.9 的古董网络服务器交谈！

# javascript - YUI 数据表中的复选框

> ID：209717
> 
> 赞同：0
> 
> 时间：2008-10-16T18:30:03.340
> 
> 标签：javascript, yui

我在 YUI 数据表中使用一列复选框，我工作正常。但是我还没有找到一种方法来放置名称和值属性，以便在提交表单时可以使用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T23:01:31.167

[http://developer.yahoo.com/yui/docs/YAHOO.widget.CheckboxCellEditor.html](http://developer.yahoo.com/yui/docs/YAHOO.widget.CheckboxCellEditor.html)上的 API 参考有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T04:52:29.663

为了获得名称和值属性，您可以使用这样的复选框：

```
<input type="checkbox" name="the_name" value="the_value" /> 
```

在您的服务器端代码中，您将在 POST 或 GET 数据中查找复选框的名称。如果它在那里，则该复选框已选中。如果不存在，则未选中该复选框。

[http://www.w3schools.com/HTMLDOM/dom_obj_checkbox.asp](http://www.w3schools.com/HTMLDOM/dom_obj_checkbox.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:10:07.600

如果我使用雅虎的 YUI，我如何为复选框添加属性。Normaly 我可以使用“document.getElementById(objeto).checked”但是 YUI 不起作用？

# xml - 个人组织者的 XML 结构

> ID：209721
> 
> 赞同：2
> 
> 时间：2008-10-16T18:31:28.767
> 
> 标签：xml, calendar, organizer

我正在做一个用于学习目的的个人组织者，而且我从未使用过 XML，所以我不确定我的解决方案是否是最好的。这是我附带的 XML 文件的基本结构：

```
<calendar>
    <year value="2008">
        <month value="october">
            <day value="16">
                <activity name="mike's birthday" time="21:00" address="mike's apartment" urgency="10">
                     activity description.
                </activity>
            </day>
        </month>
    </year>
</calendar> 
```

urgency 属性应该在 1 到 10 的范围内。
我在 google 上进行了快速搜索，找不到一个很好的例子。也许这不是最好的解决方案，我想知道它是否足够。如果有任何相关性，我正在用 PHP 做应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T18:36:11.677

你的方法对我来说已经足够了。但是，我更喜欢子标签而不是属性，所以我的方式更像是：

```
<activity>
  <name>Mike's Birthday</name>
  <time>2100</time>
  <address>Mike's Place</address>
  <urgency>10</urgency>
  <description>activity description</description>
</activity> 
```

但就像我说的，你的方式很好。

不过，快速的问题 - 为什么不是数据库？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T19:15:55.230

您可能很天真地想到了这一点，但您的 XML 设计的主要特征是它针对按日期搜索进行了优化。如果您的 XML 文档很大，并且您按日期进行了大量搜索（我怀疑这是个人组织者中最常见的用例），那么这是一件好事。

执行此 XPath 模式：

```
/calendar/year[@value='2008']/month[@value='10']/day[@value='7']/activity 
```

将检查比使用您需要与 Kev 更简单的扁平化组织一起使用的模式更少的节点：

```
/calendar/activity[@year='2008' and @month='10' and @day='7'] 
```

基本上必须查看文档中的每个节点。

请注意，顺便说一下，我假设`month`and`day`属性是数字的。这很重要，因为您几乎肯定会在某个时候对这些数据进行排序，除非您要维护文档中的排序顺序（我承认，可以为此提出一个论点），否则您我希望这些属性以易于排序的形式出现。

在这些属性中存储数字数据的方式保持一致也很重要。（如果您想在会议中听起来很聪明，您可以说您正在建立数据类型的规范表示。）例如，如果您有时使用前导零而不是其他时间，那么这些 XPath 模式都不会可靠地工作，因为与设置为 的属性`@day='7'`不匹配。（您可以通过使用该函数将属性转换为 XPath 中的数字来解决此问题，但首先避免该问题会更好。）`day``"07"``number()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T18:44:02.503

您可以将该层次结构扁平化为：

```
<calendar>
    <activity
        id="123456"
        name="mike's birthday" 
        year="2008"
        month="10"
        day="16"
        time="21:00" 
        address="mike's apartment" 
        urgency="10">
            activity description.
        </activity>
</calendar> 
```

或者..

```
<calendar>
    <activity id="12345">
        <name>mike's birthday</name>
        <year>2008</year>
        <month>10<month>
        <day>16</day>
        <time>21:00</time>
              <urgency>10</urgency>
        <address>mike's apartment<address>
        <description>activity description.</description>
    </activity>
</calendar> 
```

执行 XPath 查询会让生活变得不那么痛苦。我还添加了一个 id 属性，以便您可以唯一地标识一个活动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T18:51:44.513

我认为你的结构适合你正在做的事情。

如果您打算部分使用它来了解 XML，您可能会考虑混合使用属性和元素，以便练习使用每个属性和元素的集合。一旦您对 XML 更加熟悉，您可能会开始定义规则，您将使用这些规则来确定哪些属性成为属性以及哪些属性成为元素。

使用正确的代码，您可以在 XML 文件和数据库表之间来回移动信息。您还可以开始学习[XSL](http://www.w3schools.com/xsl/default.asp)，以便练习在不更改原始 XML 文件的情况下移动事物（或者，一旦数据在表中，甚至没有原始 XML 文件）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T19:11:42.400

对于一些可能经过深思熟虑的想法，可能值得查看[xCal ，它是](http://en.wikipedia.org/wiki/XCal)[iCalendar](http://en.wikipedia.org/wiki/ICalendar)标准的 XML 兼容表示。

# algorithm - 最近/经常联系自动完成的算法？

> ID：209725
> 
> 赞同：8
> 
> 时间：2008-10-16T18:32:28.220
> 
> 标签：algorithm, language-agnostic, usability

我们有一个自动完成列表，当您向某人发送电子邮件时会填充该列表，这一切都很好，直到列表变得非常大，您需要输入越来越多的地址才能找到您想要的地址，这就是违背自动完成的目的

我在想应该添加一些逻辑，以便自动完成结果应该按最近联系或最常联系的某些功能进行排序，而不仅仅是按字母顺序。

我想知道的是这种搜索是否有任何已知的好算法，或者是否有人有任何建议。

我在想只是一个积分系统的东西，比如当天是5分，最后三天是4分，上周是3分，上个月是2分，最后6个月是1分。那么在大多数情况下，25+ 是 5 分，15+ 是 4，10+ 是 3，5+ 是 2，2+ 是 1。除了那些“感觉”正确的数字之外，没有真正的逻辑。

除了随意挑选的数字之外，还有没有人有任何意见？如果你能给出你认为它们比我的更好的理由，其他数字也很受欢迎

编辑：这将主要是在一个商业环境中，其中最近性（是的，是为了弥补单词）通常与频率一样重要。此外，在某个特定点之后，说与您交谈 80 次与说 30 次的人之间并没有太大区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:05:58.807

看看自组织列表。

快速而肮脏的外观：

Move to Front Heuristic：一个链表，这样每当一个节点被选中时，它就会被移到列表的前面。

频率启发式：一个链表，这样每当一个节点被选中时，它的频率计数就会增加，然后该节点会冒泡到列表的前面，这样访问频率最高的就在列表的头部。

看起来转向前端实施最适合您的需求。

编辑：选择一个地址后，将其频率添加一个，然后移动到具有相同权重的节点组的前面（或课程分组的（权重 div x））。我认为老化是您提议的实施的一个真正问题，因为它需要计算每个项目的权重。自组织列表是一个很好的方法，但算法需要一些调整才能完成你想要的。

进一步编辑：老化是指权重随着时间的推移而减少的事实，这意味着您每次使用地址时都需要知道。这意味着，当您构建列表时，您必须拥有整个电子邮件历史记录。

问题是我们希望仅在实际访问节点时才对节点执行计算（而不是搜索）——这为我们提供了良好的统计性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:15:54.543

这种事情似乎类似于 Firefox 在提示您正在输入的站点时所做的事情。

不幸的是我不知道firefox到底是怎么做的，积分系统似乎也不错，也许你需要平衡你的积分:)

我会去类似的东西：

NoM = 邮件数量

（今天发送给 X 的 NoM）+ 1/2 *（上周发送给 X 的 NoM）/7 + 1/3 *（上个月发送给 X 的 NoM）/30

您在上个月未写的联系人（可以更改）将获得 0 分。您可以开始为总共发送的 NoM 对它们进行排序（因为它在联系人列表中：）。这些将在与点数 > 0 接触*后显示*

这只是一个想法，无论如何它是对大多数和刚刚邮寄的联系人给予不同的重视。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T19:21:57.213

如果您想发疯，请通过以下几种方式之一标记最“活跃”的电子邮件：

*   上次访问
*   使用频率
*   有待处理销售的联系人
*   直接老板
*   ETC

然后，在列表顶部显示活动电子邮件。注意您的用户最常使用的“组”。在收集到足够的数据后，专门切换到该排序策略。

工作量很大，但很有趣……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T19:05:13.910

也许计算发送到每个地址的电子邮件数量。然后：

ORDER BY EmailCount DESC、姓氏、名字

这样一来，您最常用的地址就会排在第一位，即使它们已经有几天没有使用过了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T19:55:02.623

我喜欢基于积分的系统的想法，包括最近使用的积分、使用频率和潜在的其他因素（更喜欢本地域中的联系人？）。

我已经在一些这样的系统上工作过，“最近使用”和“最常用”都不能很好地工作。如果您不小心打错了一次，“最近的”可能会很痛苦。或者，如果您去年与某人有很多接触，但现在您的工作发生了变化，那么“最常用”不会随着时间的推移而发生很大变化。

一旦你有了想要使用的一组测量值，你就可以创建一个交互式应用程序来测试不同的权重，并查看哪些权重为你提供了一些样本数据的最佳结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-17T22:59:24.397

[本文](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.52.2668)描述了一个缓存驱逐策略的单参数系列，其中包括最近最少使用和最不常用策略作为特殊情况。

参数 lambda 的范围从 0 到 1。当 lambda 为 0 时，它的性能与 LFU 缓存完全相同，当 lambda 为 1 时，它的性能与 LRU 缓存完全相同。在 0 和 1 之间，它以自然的方式结合了新近度和频率信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-17T23:19:15.733

尽管已经选择了答案，但我想提交我的方法以供考虑和反馈。

我会通过每次使用增加一个计数器来计算频率，但是增加一些大于一的值，比如 10（为了增加第二点的精度）。

*我会通过将所有*计数器定期（例如 24 小时）乘以某个较小的值（例如 0.9）来计算新近度。

每次使用：

```
UPDATE `addresslist` SET `favor` = `favor` + 10 WHERE `address` = 'foo@bar.com' 
```

每个间隔：

```
UPDATE `addresslist` SET `favor` = FLOOR(`favor` * 0.9) 
```

通过这种方式，我将频率和新近度合并到一个字段，避免需要保留详细的历史来推导 {last day, last week, last month} 并保持数学（大部分）整数。

当然，增量和减量必须根据偏好进行调整。

# php - PHP 操作码缓存/Zend 加速和 include_once 与 require_once

> ID：209728
> 
> 赞同：7
> 
> 时间：2008-10-16T18:34:10.807
> 
> 标签：php, performance, opcode, zend-optimizer

我有一位同事正在研究我们基于 PHP 的应用程序的操作码缓存/Zend 加速（我一直认为这些是同一件事）。他的基准测试似乎表明，如果我们将（大型）类库包含在 require_once 中，我们并没有看到性能优势，但我们确实看到了使用 include_once 时的性能优势。

这对我们俩来说都很腥，但我没有时间亲自检查我们的基准方法，我的同事比我更能容忍鱼的气味。:)

有没有人遇到过这样的事情？如果没有，对可能通过从 include_once 切换到 require_once 导致性能提高的其他事情有什么想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T00:18:50.657

对于初学者，这两个调用（require_once 和 include_once）都会仔细检查一个文件是否之前没有被包含过。

因此，他们实现这一目标的方法是在所有可用路径中搜索文件，并从本质上检查它是否之前没有混合过等等。

在后台发生的事情是他们评估所有不同的选项（例如多个包含路径等），然后通过从这个缩写形式创建真实路径，他们创建一个唯一标识符*。*只有一条相同的路径——不是两条。

这已经不是这个星球上最快的过程，并且通常发生在 PHP 的每个请求上。然后添加另一个昂贵的操作，即 stat 创建我称之为*realpath*的内容（realpath，因为它是[realpath()](http://php.net/realpath)所做的）来检查文件是否存在。

如果我错了，请纠正我，但 APC 特别针对这种情况进行了优化。

所以无论如何-现在谈谈require_once和include_once之间**的区别**，这是require_once在包含文件时评估文件（对于*低级*解析错误等）。这是一个额外的检查，如果你有足够的质量保证，解析错误永远不会潜入包含中，你可以摆脱它。

否则很难找到。:-)

（需要考虑的一点：您可以使用 require_once 进行开发，并在部署时将所有调用替换为 include_once。）

至于操作码缓存 - 我推荐[APC](http://pecl.php.net/apc)。之前在stackoverflow上已经讨论过了。就个人而言，我/我们正在使用它一段时间（我们每天处理大约 10 万访问者，有 3 个前端和 1 个后端），我们非常高兴。APC 还针对 require_once/include_once 进行了优化。

一个非常酷的副作用是 APC 还允许您将 PHP 变量存储在内存中 - 某种持久性等。

几个额外的指针：

1.  [很多人声称可以使用__autoload](http://php.net/autoload)加速任何应用程序。
2.  使用操作码缓存，避免有条件的 require_once/include_once（例如在循环或控制流中）。
3.  有人说include_或require_once中的/absolute/path/to/file.php比依赖include_path要快。
4.  include_path 中路径的顺序也很重要。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T19:08:40.487

我不能保证任何事情，因为我没有深入研究它，但是是的，我已经看到了两者之间的速度差异。不过，它们对我来说从来都不够重要，无法转移到 include_once 而不是 require_once 。

我一直认为差异是因为 require_once 必须在水下做更多的工作。至少还有一个潜在的错误需要准备和处理，当所需的文件不存在时还有很多工作要做。

# java - 如何在 KDE 上的 Java 中强制/使用 GTKLookAndFeel？

> ID：209731
> 
> 赞同：5
> 
> 时间：2008-10-16T18:35:42.003
> 
> 标签：java, swing, gtk, look-and-feel, kde

首先，使用 gnome 不是一个选项（但可以安装它的库）。

我需要知道使用当前安装的 KDE 外观显示 Java Swing 桌面应用程序需要什么。理想情况下，该解决方案应该允许我应用类似于底层窗口系统的外观（即：Windows LNF 用于 Windows，GTK LNF 用于 Gnome（GTK），QT LNF 用于 KDE（QT），其他平台的默认设置）。

在 KDE 下，您也可以将其配置为使用 GTK 应用程序的当前 KDE 主题。因此，如果该解决方案适用于 GTK，那就没问题了。

当我在 Gnome (Ubuntu 8.04) 下运行以下代码时，Java 应用程序看起来很漂亮。它与其他应用程序集成得非常好：

```
try {
  // Set System L&F
  UIManager.setLookAndFeel(
  UIManager.getSystemLookAndFeelClassName());
} catch(Exception e) { //Handle it } 
```

但是，如果我在 Debian (Lenny) 下使用 KDE 运行相同的东西，则 UIManager.getSystemLookAndFeelClassName() 调用将返回 Java 默认值。如果我继续强制它使用 GTK LNF，应用程序将无法运行。有些字段是不可见的，有些是不合适的，一切都无法使用：

```
try {
  //Force the GTK LNF on top of KDE, but **it doesn't work**
  UIManager.setLookAndFeel("com.sun.java.swing.plaf.gtk.GTKLookAndFeel");
} catch (Exception e) { /*Handle it*/ } 
```

我也试过把下面的代码。它让用户选择任何一个可用的 LNF，然后尝试设置它。金属和主题工作正常。GTK 没有。滑块真的很乱。列表框看起来很难看并且消失了，但似乎可以工作。按钮和菜单看起来不错。相关代码如下所示：

```
(...)
    /** Creates new form SwingFrame */
    public SwingFrame() {

    initComponents();

    //Save all available lafs in a combobox
    cbLafs.removeAllItems();
    UIManager.LookAndFeelInfo[] lafs=UIManager.getInstalledLookAndFeels();

    for (int i=0,t=lafs.length;i<t;i++)
    {
        cbLafs.addItem(lafs[i]);
        System.out.println(lafs[i].getName());
    }

    }

public void changeLookAndFeel(String laf)
{
    //If not specified, get the default one
    if (laf==null) {
    laf=UIManager.getSystemLookAndFeelClassName();
    }

        try {
        // Set System L&F
        UIManager.setLookAndFeel(laf);
    }
    catch (Exception e) {
       // handle exception
        e.printStackTrace();
    }
    SwingUtilities.updateComponentTreeUI(this);

}

   private void cbLafsActionPerformed(java.awt.event.ActionEvent evt) {                                       
        // TODO add your handling code here:
        UIManager.LookAndFeelInfo laf=(UIManager.LookAndFeelInfo)cbLafs.getSelectedItem();
        if (laf==null)
            changeLookAndFeel(null);
        else
            changeLookAndFeel(laf.getClassName());
    } 
```

该系统的所有 GTK 应用程序（例如：Firefox）都按预期工作。所以：

1) 在 KDE 下运行 Java GTK LNF 应用程序的环境缺少什么？

2) JVM 检查什么以返回 GTK 作为默认系统主题？

谢谢你帮助路易斯费尔南多

PS->我也尝试过其他解决方案，例如 JGoodies、plain AWT 和 SWT。然而，使用 GTK LNF 的 Swing 将是避免 SWT 本机库和 JGoodies 额外 jar 的麻烦的最佳解决方案（此外，JGoodies LNF 看起来不像 Gnome 下的 Swing GTK 那样集成）。AWT 看起来很丑陋（类似主题）并且缺少很多功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T13:04:04.323

您可以从命令行设置外观：

java -Dswing.defaultlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel MyApp

此外，[SwingSet2.jnlp](http://java.sun.com/products/jfc/jws/SwingSet2.jnlp)提供了所有可以更改的不同内容的示例演示。来源和其他信息可以在这里找到：[链接文本](http://java.sun.com/docs/books/tutorial/uiswing/lookandfeel/plaf.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T19:30:25.137

引用文档：

> 1.  如果系统属性`swing.defaultlaf`不为空，则使用其值作为默认外观类名称。
>     
>     
> 2.  如果 Properties 文件`swing.properties`存在并包含 key `swing.defaultlaf`，则使用其值作为默认外观类名称。检查的位置`swing.properties`可能因 Java 平台的实现而异。在 Sun 的实现中，位置是`${java.home}/lib/swing.properties`
>     
>     
> 
> 有关更多详细信息，请参阅正在使用的实现的发行说明。

但我 99% 确定您的问题是这个问题（再次引用文档）：

> 一旦改变了外观和感觉，就必须调用`updateUI`all `JComponents`。该方法`SwingUtilities.updateComponentTreeUI(java.awt.Component)`可以轻松地将 updateUI 应用于包含层次结构。有关详细信息，请参阅它。未指定在更改外观后不调用 updateUI 的确切行为。很可能会收到意外的异常、绘画问题或更糟的情况。

如果您不想`updateUI`在 all上调用`JComponents`，请确保在所有其他摆动代码`UIManager.setLookAndFeel` **之前调用。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T03:29:29.900

也许这有效：

```
try {
// sure look and feel
UIManager.setLookAndFeel("com.sun.java.swing.plaf.gtk.GTKLookAndFeel");
// not-so-sure look and feel
System.setProperty("os.name", "Windows");
System.setProperty("os.version", "5.1");
UIManager.setLookAndFeel("com.sun.java.swing.plaf.windows.WindowsLookAndFeel");
} 
catch (Exception ex) {
ex.printStackTrace();
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-09T01:23:07.153

GTK Laf 是，恕我直言，破碎的时期。它不**支持**某些随机设置。我相信它不应该尊重大多数组件上的*任何*setBackground()、setForeground() 或 setFont()。

如果您使用的是 java >1.4.2，我建议使用 MetalLookAndFeel [应该是 UIManager.getCrossPlatformLookAndFeelClassName()]。如果您使用 >1.6.0_u10，您可以尝试 NautilusLookAndFeel。我个人觉得金属更好看。

# javascript - 为什么我看到不一致的 JavaScript 逻辑行为循环使用 alert() 与没有它？

> ID：209732
> 
> 赞同：22
> 
> 时间：2008-10-16T18:35:50.380
> 
> 标签：javascript, regex

我在对象数组中有类似于此过滤条目的代码：

```
var filterRegex = new RegExp(".*blah.*","ig");
if (filterRegex.test(events[i].thing) && events[i].show) {
    console.log("SUCCESS: filtering thing " + i + " " + events[i].thing);
    events[i].show = false;
    numevents--;
} 
```

我得到与此 if 条件不一致的结果（使用 Firebug 检查，两个条件分别为真，但*有时*整个表达式的计算结果为假）。但是，如果我实际上`alert()`在这个 if 语句中放置了一个调用（如第 4 行），它就会变得一致并且我得到我想要的结果。

你能看出这个逻辑有什么问题，并告诉我为什么它并不总是产生预期的结果吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-16T20:07:06.377

好的，我现在看到了。问题的关键是使用`g`（全局匹配）标志：当为正则表达式指定时，它将被设置为可以多次执行，每次从上次停止的地方开始. `lastIndex`它在其属性中保留了各种“书签” ：

```
var testRegex = /blah/ig;
// logs: true 4
console.log(testRegex.test("blah blah"), testRegex.lastIndex);
// logs: true 9 
console.log(testRegex.test("blah blah"), testRegex.lastIndex);
// logs: false 0
console.log(testRegex.test("blah blah"), testRegex.lastIndex); 
```

上面的例子创建了一个非常简单的正则表达式的实例：它匹配字符串中任何位置的“blah”，大写或小写，并且可以匹配多次（`g`标志）。在第一次运行时，它匹配第一个“blah”，并`lastIndex`设置为 4（第一个“blah”之后的空间索引）。第二次运行从 开始匹配`lastIndex`，匹配第二个 blah，然后`lastIndex`设置为 9 - 超过数组末尾的一个。第三次运行不匹配 -`lastIndex`是假的 - 并且`lastIndex`设置为 0。因此，第四次运行的结果与第一次相同。

现在，你的表达比我的更贪婪：它会匹配“blah”之前或之后的任意数量的任意字符。因此，无论您测试什么字符串，如果它包含“blah”，它将始终匹配整个字符串并保留`lastIndex`设置为刚刚测试的字符串的长度。意思是，如果你要调用`test()`两次，第二次测试总是会失败：

```
var filterRegex = /.*blah.*/ig;
// logs: true, 9
console.log(filterRegex.test("blah blah"), filterRegex.lastIndex);
// logs: false, 0 
console.log(filterRegex.test("blah blah"), filterRegex.lastIndex); 
```

幸运的是，由于您在调用之前立即创建了正则表达式`test()`，并且从不`test()`多次调用，因此您永远不会遇到意外行为......**除非**您使用的调试器允许您在`test()`旁边添加另一个调用。是的。运行 Firebug 时，包含您的调用的监视表达式`test()`将导致间歇性`false`显示结果，无论是在您的代码中还是在监视结果中，具体取决于哪个首先得到它。让你慢慢发疯……

当然，没有 g 标志，生活很容易：

```
var filterRegex = /.*blah.*/i;
// logs: true, 0
console.log(filterRegex.test("blah blah"), filterRegex.lastIndex);
// logs: true, 0 
console.log(filterRegex.test("blah blah"), filterRegex.lastIndex); 
```

### 建议

*   不需要时避免使用全局标志。
*   小心你在调试器中的评估：如果有副作用，它会影响你的程序的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T19:00:04.700

我无法想象在任何情况下，两个 JavaScript 表达式单独计算为 true，但在组合时不会。

您确定这两个表达式实际上每次都会产生一个布尔值吗？（好吧，`regex.test()`不产生布尔值是很困难的，但是`event.show`.

你说的时候指的是正确的索引`event[0].show`，不是`event[i].show`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T19:03:37.407

这似乎你正面临着事件数组的某种竞争条件，这就是为什么当你使用 alert() 时一切正常。

# apache - 用于外部访问的 Apache 身份验证，但不适用于本地访问

> ID：209738
> 
> 赞同：2
> 
> 时间：2008-10-16T18:37:50.190
> 
> 标签：apache, authentication

我需要我的 Apache 只需要对外部访问进行身份验证，但在我的本地网络中是免费的。我的 Apache 中有 mod_user。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T19:01:07.973

处理这个***最简单***的方法是使用两个虚拟主机。一个用于外部用户，一个用于内部用户……即“www.myhost.com”用于外部用户，“www-int.myhome.com”用于内部用户。仅将 www-int 限制为内部 IP，没有身份验证要求。

或者，您可以在 Auth 指令中使用类似的内容：

```
Require valid-user
Allow from 192.168.1
Satisfy Any 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T18:50:05.390

对apache身份验证不多，我只是不时使用tomcat来测试一些jsp。

你试过读这个吗？[http://httpd.apache.org/docs/1.3/howto/auth.html#basicconfig](http://httpd.apache.org/docs/1.3/howto/auth.html#basicconfig)

# scala - 任何使用软件事务内存的实际经验？

> ID：209751
> 
> 赞同：62
> 
> 时间：2008-10-16T18:41:15.957
> 
> 标签：scala, haskell, clojure, language-agnostic, stm

似乎最近对 STM（软件事务内存）框架和语言扩展的兴趣越来越大。 [Clojure](http://clojure.org)尤其具有出色的实现，它使用[MVCC（多版本并发控制）](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)而不是滚动提交日志。GHC Haskell 还有[一个非常优雅的 STM monad](http://research.microsoft.com/%7Esimonpj/papers/stm/beautiful.pdf)，它也允许事务组合。最后，为了稍微吹嘘一下我自己的号角，我最近[为 Scala 实现了一个 STM 框架，](http://www.codecommit.com/blog/scala/software-transactional-memory-in-scala)它静态地强制执行引用限制。

所有这些都是有趣的实验，但它们似乎仅限于那个领域（实验）。所以我的问题是：你们有没有人在现实世界中看到或使用过 STM？如果是这样，为什么？它带来了什么样的好处？性能呢？（在这一点上似乎有很多相互矛盾的信息）你会再次使用 STM 还是更喜欢使用其他一些并发抽象，比如演员？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-16T22:10:00.993

我参与了 Haskell（名为 conjure）的 BitTorrent 客户端的业余爱好者开发。它大量使用 STM 来协调不同的线程（每个节点 1 个 + 1 个用于存储管理 + 1 个用于整体管理）。

好处：更少的锁，可读的代码。

速度不是问题，至少不是由于 STM 的使用。

希望这可以帮助

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-26T21:28:33.337

文章“[软件事务内存：为什么它只是一个研究玩具？](http://pages.cs.wisc.edu/~cain/pubs/cascaval_cacm08.pdf) ” *（Călin Caşcaval 等人，ACM 通讯，2008 年 11 月）*，没有看 Haskell 的实现，这是一个很大的遗漏。正如文章所指出的那样，STM 的问题在于，实现必须在使所有变量访问都是事务性的，除非编译器可以证明它们是安全的（这会降低性能），还是让程序员指示哪些是事务性的（这会降低简单性）和可靠性）。然而，Haskell 实现使用 Haskell 的纯度来避免需要使大多数变量使用事务性，而类型系统提供了一个简单的模型以及对事务性变异操作的有效执行。因此，Haskell 程序可以将 STM 用于那些真正在线程之间共享的变量，同时保证非事务性内存使用是安全的。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2010-06-26T17:09:28.520

在 Galois（在 Haskell 中），我们经常将它用于高并发应用程序。它可以工作，在 Haskell 世界中被广泛使用，并且不会死锁（当然你可能有太多的争用）。有时我们会重写一些东西以使用 MVar，如果我们的设计正确的话——因为它们更快。

就用它吧。这没什么大不了的。就我而言，Haskell 中的 STM 已“解决”。没有进一步的工作要做。所以我们使用它。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-12-06T17:49:51.053

我们，[factis research GmbH](http://www.factisresearch.com)，正在生产中使用带有 GHC 的 Haskell STM。我们的服务器从临床“数据服务器”接收有关新的和修改的“对象”的消息流，它动态转换此事件流（通过生成新对象、修改对象、聚合事物等）并计算其中哪些是新的对象应同步到连接的 iPad。它还接收来自 iPad 的表单输入，这些输入经过处理、与“主流”合并并同步到其他 iPad。我们将 STM 用于需要在线程之间共享的所有通道和可变数据结构。Haskell 中的线程非常轻量级，因此我们可以拥有很多线程而不会影响性能（目前每个 iPad 连接 5 个）。构建一个大型应用程序总是一个挑战，有很多经验教训要学习，但我们在 STM 上从来没有遇到过任何问题。它总是像你天真地期望的那样工作。我们必须进行一些认真的性能调整，但 STM 从来都不是问题。（80% 的时间我们试图减少短期分配和整体内存使用。）

STM 是 Haskell 和 GHC 运行时真正大放异彩的一个领域。这不仅仅是一个实验，也不仅仅是玩具程序。

我们正在 Scala 中构建临床系统的不同组件，并且到目前为止一直在使用 Actors，但我们真的缺少 STM。如果有人对在生产中使用 Scala STM 实现之一有什么经验，我很乐意听取您的意见。:-)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-12-09T17:19:28.757

我们已经在我们自己用 C 语言实现的 STM 之上实现了我们的整个[系统（内存数据库和运行时）。在此之前，我们有一些基于日志和锁的机制来处理并发，但维护起来很痛苦。](http://www.staila.com/site/en/mercury)我们对 STM 非常满意，因为我们可以以同样的方式对待每个操作。几乎所有的锁都可以拆除。我们现在几乎将 STM 用于任何大小的任何东西，我们甚至在顶部实现了内存管理器。

性能很好，但为了加快速度，我们现在与苏黎世联邦理工学院合作开发了一个定制[操作系统。](http://nativesystems.inf.ethz.ch/WebHomeResearchStaila)系统本身支持事务内存。

但是STM也带来了一些挑战。尤其是较大的交易和热点会导致不必要的交易冲突。例如，如果两个事务将一个项目放入一个链表中，则会发生不必要的冲突，而使用无锁​​数据结构可以避免这种冲突。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-17T17:56:50.170

我目前在一些 PGAS 系统研究中使用 Akka。[Akka](http://akka.io/)是一个 Scala 库，用于使用 Actors、STM 和内置容错功能开发可扩展的并发系统，这些功能模仿 Erlang 的“让它失败/崩溃/火山口/ROFL”哲学。Akka 的 STM 实现据说是围绕 Clojure 的 STM 实现的 Scala 端口构建的。可以在[这里](http://doc.akka.io/stm-java)找到 Akka 的 STM 模块的概述。

# ruby-on-rails - 如何在“render :template => ...”之后访问“assigns”？

> ID：209753
> 
> 赞同：4
> 
> 时间：2008-10-16T18:42:13.270
> 
> 标签：ruby-on-rails, ruby, actionview

我的 ApplicationController 中有一个错误处理方法：

```
rescue_from ActiveRecord::RecordNotFound, :with => :not_found

def not_found(exception)
  @exception = exception
  render :template => '/errors/not_found', :status => 404
end 
```

在`RAILS_ROOT/app/views/errors/not_found.html.erb`，我有这个：

```
<h1>Error 404: Not Found</h1>
<%= debug @exception %> 
```

但`@exception`一直都`nil`在。我试过`debug assigns`了，但总是这样`{}`。调用时分配不会被复制`render :template`吗？如果是这样，我怎样才能得到它们？

我在边缘 Rails 上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T18:52:53.700

这很奇怪，我不知道为什么。作为替代方案，您是否尝试过将异常作为显式本地传递？

```
def not_found(exception)
  render :template => '/errors/not_found', 
         :status   => 404, 
         :locals   => {:exception => exception}
end 
```

和观点：

```
<h1>Error 404: Not Found</h1>
<%= debug exception %> <!-- Note no '@' --> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T18:54:54.197

从[ActionController::Base](http://api.rubyonrails.com/classes/ActionController/Base.html#M000848)的 API 文档看来，您应该尝试：

```
render :template => '/errors/not_found', :status => 404, :locals => {:exception => exception} 
```

# seo - 我的站点地图有什么问题？

> ID：209754
> 
> 赞同：2
> 
> 时间：2008-10-16T18:42:15.687
> 
> 标签：seo, sitemap

我们的网站有一个站点地图[http://www.appsamuck.com/](http://www.appsamuck.com/)

站点地图在这里[http://www.appsamuck.com/sitemap.xml](http://www.appsamuck.com/sitemap.xml)

但谷歌似乎讨厌它。我的问题是为什么？我只是盯着它现在对自己说它看起来不错。我错过了什么吗？

3 路径不匹配我们检测到您使用不包含 www 前缀的 URL 路径（例如[http://example.com/sitemap.xml](http://example.com/sitemap.xml)）提交了站点地图。但是，站点地图中列出的 URL 确实使用 www 前缀（例如[http://www.example.com/myfile.htm](http://www.example.com/myfile.htm)）。帮助帮助 URL：在以下位置检测到问题： [http](http://www.appsamuck.com/) ://www.appsamuck.com/ 2008 年 10 月 15 日

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T09:21:59.720

我刚刚输入了一个巨大的响应，FF 崩溃了，我失去了它，当这种情况发生时我讨厌它！

基本上它可能有两个具有不同内容的站点，一个在 www 下运行。一个没有 www 有点像子域。因此，当您提交站点地图时，谷歌会在 www 站点 ( [http://www.appsamuck.com/sitemap.xml](http://www.appsamuck.com/sitemap.xml) ) 上看到它，但站点地图中的所有 url 都不包含 www，因此谷歌想知道站点地图是否实际上是针对另一个站点的非 www 部分。通常这两个提供相同的内容但并非总是如此，所以谷歌说坚持你把站点地图放在 www，但你所有的页面都在一个非 www 域上那是什么！！

最好的办法是坚持一个或另一个，你是在宣传 www 还是非 www？无论您使用哪个（我建议使用 www 版本），请使用 www 提交您的站点地图，并确保站点地图中的所有网址都包含 www。这样谷歌就不会大吃一惊。对于 SEO 来说，坚持一个可能会稍微好一些。

正如尼克上面建议的那样，通过首选域选项让谷歌知道您更喜欢哪个也是一个好主意。我会设置这个选项

将 URL 显示为 www.appsamuck.com（适用于 www.appsamuck.com 和 appsamuck.com）

至少谷歌会知道你在谈论同一个网站。

至于站点地图，也有一些问题。首先，正如我指出的那样，它缺少每个 URL 中的 www。其次，您缺少文件顶部的 xml 声明等。你需要这样的东西

```
print("code sample");<?xml version="1.0" encoding="UTF-8"?>
<urlset
  xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9
        http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd"> 
```

就像上面的 Diodeus 建议的那样，您确实应该添加其他字段，例如优先级等。

这是我为您完成的快速操作（请注意，当我打开上面的 urlset 标记并在这组代码的底部关闭时，它是从上面开始的）

```
print("code sample");
 <url>
  <loc>http://www.appsamuck.com/</loc>
  <priority>1.00</priority>
  <lastmod>2008-10-17T03:01:05+00:00</lastmod>
  <changefreq>monthly</changefreq>
 </url>
 <url>
 <loc>http://www.appsamuck.com/index.html</loc>
  <priority>0.80</priority>
  <lastmod>2008-10-17T03:01:05+00:00</lastmod>
  <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/blog/</loc>
   <priority>0.80</priority>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/about.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-16T00:00:32+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/contact.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-16T00:00:33+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/iphonesdkdev.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-14T05:41:03+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/day16.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-17T03:13:21+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/day15.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-16T15:58:57+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/day14.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-15T16:58:06+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
 <url>
   <loc>http://www.appsamuck.com/day13.html</loc>
   <priority>0.80</priority>
   <lastmod>2008-10-13T17:52:08+00:00</lastmod>
   <changefreq>monthly</changefreq>
 </url>
</urlset> 
```

它不是一个完整的列表，我不会为你做所有的工作:)

还有一些很好的在线工具可以为您创建站点地图，他们抓取站点并构建它，只需 google xml-sitemaps，您应该会找到一些，还有一些很好的免费工具。此外，如果他们的蜘蛛无法找到您的内容，则它可能是谷歌也无法找到的标志，因此它具有双重目的。

希望有帮助:)保罗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T20:46:22.333

这可能与您的首选域设置有关。如果您的站点地图中有 www，但您提交的站点没有 www，则可能会导致混淆。我为我的网站所做的是将其与站点地图中的 wwww 一起提交，并确保我以相同的方式在网站管理员工具中提交给 Google。

然后您可以进入并在您的站点的工具区域中设置“首选域”。从那里，如果你愿意，你可以让谷歌只链接到非 www 版本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-16T18:45:15.073

我遇到过类似的问题。只需重新提交同一张地图。通常警告会消失。

尝试添加其他字段：`<lastmod></lastmod>, <changefreq></changefreq>, <priority></priority>`. 您的站点地图看起来正确。

此外，请确保您重新提交的地图的状态不是“待定”。Google 有时需要数小时来处理您的文件。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-09-16T05:48:07.617

我今天发现了一个类似的问题。我所做的是重新创建没有 www 的网站。Google 通常建议您将站点创建为 htttp://www.yoursitename.com，但您也可以输入 htttp:// yoursitename。com 并验证您是管理员。它对我很有效。希望这可以帮助。

# x++ - 如何在动态 Ax 表的 modifiedField 方法中获取上一个字段值？

> ID：209764
> 
> 赞同：5
> 
> 时间：2008-10-16T18:44:23.233
> 
> 标签：x++, axapta

我希望能够在 table.modifiedField 方法中执行一些逻辑，该方法将字段的先前值与新值进行比较。我如何获得以前的值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-16T20:23:13.550

任何修改之前的记录缓冲区都可以通过该`this.orig()`方法获得。

```
public void modifiedField(fieldId _fieldId)
{
    super(_fieldId);
    info(strfmt("Field number %1 changed from %2 to %3",_fieldId,this.orig().(_fieldId),this.(_fieldId)));
} 
```

# c# - 薪资系统设计、SP 或应用层 (C#.Net) 中的业务逻辑、可维护性 - 重新发布

> ID：209770
> 
> 赞同：1
> 
> 时间：2008-10-16T18:45:38.113
> 
> 标签：c#, database, oop, web-applications, n-tier-architecture

我们正在为客户设计工资单生成系统。

我们所针对的组织具有如下层次结构：公司 -> 集群 -> 业务部门 (BU) -> 部门 -> 员工

员工的工资由各种工资组成部分组成。每个工资组件都有 3 个与之关联的规则，一个计算规则（将组件计算为另一个组件的百分比，或一个固定数字或固定数字的百分比），一个资格规则（员工/部门是否有资格获得一个组件）和限制组件的最大值和最小值的约束规则。

****这些规则是可编辑的，并且可以由用户最终用户进行编辑**。这些规则也是自上而下继承的，但如果在较低级别定义，则较低级别的规则优先。**

**我们有一个包含出勤、休假、奖金表的数据库，这些规则也应该与这些表交互。**

客户将为多个客户生成工资单，每个客户都托管一个单独的数据库实例。它们可能对每个组件都有不同的解释，并且可能具有不同的组件。

我们只希望支持 SQL Server，工资单生成将是一项离线活动。

**我们对将使用这些规则生成单个税收组成部分（包括税收减免、税收核销、免税额等）的逻辑放在哪里存在分歧。**

有些人提倡神奇的 SP，它将获取员工 ID 并生成当月的工资单。其他人希望将逻辑拆分为单独的组件，这些组件将在应用层获取员工的相关数据并在那里计算这些组件。

我们的优先顺序是： 1\. 快速适应新客户变化的能力 2\. 长期可维护性 3\. 性能

1 和 2 在这里比 3 重要得多，因为这将是一个离线活动。

可维护性和快速可定制性非常重要，我们将为不同的客户部署应用程序。客户 A 的工资构成规则为 ((0.3 * Basic) + 800)，客户 B 为 (0.2 * Basic) + (0.1 * Atendance Bonus)

**SP 是否会在这里造成混乱，因为上面建议的规则将由最终用户指定，并且需要通过 Web UI 进行自定义。我们将不得不从 SQL 中解析公式。会有多难或容易？与使用 SP 相比，在应用层 (C# .Net) 中执行此操作有什么优势？**

原帖在这里： [设计提示，工资系统......重新发布](https://stackoverflow.com/questions/208707/design-hints-payroll-systemrepost) ......但没有一个问题得到正确回答。

对现有系统架构的建议和指示将非常有帮助。...是的，我们在系统的其他地方使用 LINQ to SQL。

亲切的问候， Ashish Sharma

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T18:58:53.843

我总是尽量避免将业务逻辑放在 DB 层。编写、调试和维护更加困难。此外，数据库通常是扩展成本最高的层。如果您最终需要增强系统以支持更多用户，则向系统添加新的网络服务器相对便宜且容易，但添加数据库实例变得昂贵，因为每个数据库都需要许可证和额外的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T18:58:27.823

如果您将公式存储为例如 JEP（用于 java），则问题不大。只需将完整的公式保留为字符串：即：“pay=((0.3 * Basic) + 800)，然后将其解析为树。

您可以查看一些 jep 文档以获取信息，并从那里获取想法。为您在此处发布的公式实施简单的求解器不应该是 2 个问题。

我的建议：

*   将其保存在数据库中的字符串中
*   为 eval 和 parser 创建一个小型库。
*   将其解析为二叉树。（如 '+' 指向 800 也指向 ' *'）然后 '* ' 指向 'basic' 和 '0.3'
*   在它之后，您只需要一个简单的递归函数来解决它。

如果这些公式的复杂性不是很大，您可以在任何您想要的方面执行此操作，因为它不会花费您太多时间来处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T00:00:38.897

If you are looking for a .Net solution that will evaluate formula represented in strings, here an is excellent article that details using [ANTLR and C#](http://www.codeproject.com/KB/recipes/sota_expression_evaluator.aspx) to create a calculation engine. There is a fully functional formula interpreter that parses strings, builds an AST, then evaluates the expression. In addition, the calculation engine is implemented using the Visitor pattern, so if you have functions that you wish to perform such as database lookups you can easily incorporate the customization into your solution.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T04:22:28.637

Have you heard of Relection or delegates ?

# php - PHP有线程吗？

> ID：209774
> 
> 赞同：135
> 
> 时间：2008-10-16T18:46:27.397
> 
> 标签：php, multithreading, apache, command-line-interface

我找到了这个[名为 threads 的 PECL 包](http://pecl.php.net/package/threads)，但还没有发布。PHP 网站上什么也没有出现。

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2013-01-27T15:20:43.503

[**来自pthreads**](http://php.net/pthreads)扩展的 PHP 手册：

> pthreads 是一个面向对象的 API，它允许 PHP 中的用户级多线程。它包括创建针对 Web 或控制台的多线程应用程序所需的所有工具。PHP 应用程序可以创建、读取、写入、执行以及与线程、Worker 和 Stackables 同步。

这听起来令人难以置信，但这是完全正确的。今天，PHP 可以为那些希望尝试它的人提供多线程。

PHP4 的第一个版本，2000 年 5 月 22 日，PHP 带有线程安全架构 - 一种在多线程 SAPI（服务器 API）环境中在单独线程中执行其解释器的多个实例的方法。在过去的 13 年中，这种架构的设计得到了维护和改进：从那时起，它一直在世界上最大的网站上投入生产使用。

用户空间中的线程从来不是 PHP 团队关心的问题，今天仍然如此。您应该了解，在 PHP 开展业务的世界中，已经有一种定义的扩展方法 - 添加硬件。PHP 存在多年以来，硬件变得越来越便宜，因此 PHP 团队越来越不关心这个问题。虽然它变得更便宜，但它也变得更强大。今天，我们的手机和平板电脑具有双核和四核架构以及大量的 RAM，我们的台式机和服务器通常具有 8 或 16 核、16 和 32 GB 的 RAM，尽管我们可能并不总是能够拥有两个在预算范围内，拥有两个桌面对我们大多数人来说很少有用。

此外，PHP 是为非程序员编写的，它是许多爱好者的母语。PHP 如此容易被采用的原因是因为它是一种易于学习和编写的语言。PHP 在今天如此可靠的原因在于它的设计投入了大量的工作，以及 PHP 团队做出的每一个决定。这么多年过去了，它的可靠性和卓越的性能使它成为人们关注的焦点。它的竞争对手已经落入时间或压力之下。

多线程编程对大多数人来说并不容易，即使有最连贯和可靠的 API，也有不同的事情需要考虑，也有很多误解。PHP 小组不希望用户空间多线程成为核心功能，它从未受到过认真的关注——这是正确的。对于每个人来说，PHP 不应该很复杂。

考虑到所有因素，允许 PHP 使用它的生产就绪和经过测试的特性仍然可以带来好处，从而可以充分利用我们所拥有的，当添加更多并不总是一种选择时，而且很多的任务从来都不是真正需要的。

pthreads 为那些希望探索它的人实现了一个 API，它允许用户对 PHP 应用程序进行多线程处理。它的 API 在很大程度上是一项正在进行的工作，并指定了 beta 级别的稳定性和完整性。

众所周知，PHP 使用的某些库不是线程安全的，程序员应该清楚 pthreads 无法更改这一点，并且不会尝试尝试。但是，任何线程安全的库都是可用的，就像在解释器的任何其他线程安全设置中一样。

pthreads 利用 Posix 线程（即使在 Windows 中），程序员创建的是真正的执行线程，但要使这些线程有用，他们必须了解 PHP——能够执行用户代码、共享变量并允许有用的通信方式（同步）。所以每个线程都是用解释器的一个实例创建的，但根据设计，它的解释器与解释器的所有其他实例隔离 - 就像多线程服务器 API 环境一样。pthreads 试图以理智和安全的方式弥合差距。C 中线程程序员的许多担忧对于 pthreads 程序员来说并不存在，根据设计，pthreads 是读取时复制和写入时复制（RAM 很便宜），因此没有两个实例会操作相同的物理数据，但它们都可以影响另一个线程中的数据。

**为什么读取时复制和写入时复制：**

```
public function run() {
    ...
    (1) $this->data = $data;
    ...
    (2) $this->other = someOperation($this->data);
    ...
}

(3) echo preg_match($pattern, $replace, $thread->data); 
```

(1) 当 pthreads 对象数据存储上持有读写锁时，数据会从其在内存中的原始位置复制到对象存储。pthreads 不会调整变量的引用计数，如果没有进一步的引用，Zend 能够释放原始数据。

(2) someOperation 的参数引用对象存储，存储的原始数据，它本身是 (1) 的结果的副本，被引擎再次复制到 zval 容器中，同时发生读锁被持有对象存储，锁被释放，引擎可以执行该功能。创建 zval 时，它的引用计数为 0，使引擎能够在操作完成时释放副本，因为不存在对它的其他引用。

(3) preg_match 的最后一个参数引用了数据存储，获得了一个读锁，将(1)中的数据集复制到一个 zval，再次使用 refcount 为 0。锁被释放，对 preg_match 的调用操作数据的副本，它本身就是原始数据的副本。

**要知道的事情：**

*   存储数据的对象存储的哈希表是线程安全的，它
    基于 Zend 随 PHP 提供的 TsHashTable。

*   对象存储有一个读写锁，为 TsHashTable 提供了一个额外的访问锁，这样如果需要（它确实，var_dump/print_r，直接访问属性，因为 PHP 引擎想要引用它们）pthreads 可以操作 TsHashTable在定义的 API 之外。

*   只有在复制操作发生时才会持有锁，当复制完成时，锁会以合理的顺序被释放。

**这表示：**

*   当发生写入时，不仅会持有读写锁，还会持有额外的访问锁。表本身被锁定，其他上下文不可能锁定、读取、写入或影响它。

*   当发生读取时，不仅读取锁被持有，而且附加的访问锁也被持有，表再次被锁定。

没有两个上下文可以物理地或同时访问对象存储中的相同数据，但是在任何具有引用的上下文中进行的写入将影响在具有引用的任何上下文中读取的数据。

这是无共享架构，唯一存在的方式是共存。那些有点精明的人会看到，这里有很多抄袭，他们会怀疑这是否是一件好事。相当多的复制在动态运行时中进行，这就是动态语言的动态。pthreads 是在对象级别实现的，因为可以对一个对象进行良好的控制，但是方法——程序员执行的代码——有另一个上下文，没有锁定和副本——本地方法范围。在 pthreads 对象的情况下，对象范围应被视为在上下文之间共享数据的一种方式，这就是它的目的。考虑到这一点，您可以采用技术来避免锁定对象存储，除非有必要，

大多数可用于 PHP 的库和扩展都是围绕 3rd 方的瘦包装器，PHP 核心功能在某种程度上是相同的。pthreads 不是 Posix 线程的薄包装；它是一个基于 Posix Threads 的线程 API。在 PHP 中实现用户不理解或无法使用的线程是没有意义的。没有理由不知道互斥锁是什么或做什么的人不应该在技能和资源方面利用他们所拥有的一切。一个对象的功能就像一个对象，但是在两个上下文可能发生冲突的地方，pthreads 提供了稳定性和安全性。

任何在 java 中工作过的人都会看到 pthreads 对象和 java 中的线程之间的相似之处，这些人无疑会看到一个名为 ConcurrentModificationException 的错误——因为如果两个线程写入相同的物理数据，这听起来是由 java 运行时引发的错误同时。我理解它为什么存在，但让我感到困惑的是，资源如此便宜，再加上运行时能够在它选择的确切且唯一的时间为用户实现安全性时检测到并发性在运行时抛出一个可能致命的错误，而不是管理执行和对数据的访问。

pthreads 不会发出这种愚蠢的错误，我相信，编写 API 是为了使线程尽可能稳定和兼容。

多线程不像使用新数据库，应该密切注意手册中的每个单词和 pthread 附带的示例。

最后，来自 PHP 手册：

> pthreads 曾经是，现在也是，结果非常好。它的任何限制或功能可能随时更改；这就是实验的本质。它的限制——通常是由实施强加的——是有充分理由存在的；pthreads 的目的是为任何级别的 PHP 多任务提供可用的解决方案。在 pthreads 执行的环境中，为了提供一个稳定的环境，一些限制和限制是必要的。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-10-17T02:18:48.683

以下是 Wilco 建议的示例：

```
$cmd = 'nohup nice -n 10 /usr/bin/php -c /path/to/php.ini -f /path/to/php/file.php action=generate var1_id=23 var2_id=35 gen_id=535 > /path/to/log/file.log & echo $!';
$pid = shell_exec($cmd); 
```

基本上这会在命令行执行 PHP 脚本，但会立即返回 PID，然后在后台运行。（echo $! 确保除了 PID 之外不返回任何其他内容。）这允许您的 PHP 脚本在需要时继续或退出。当我使用它时，我已将用户重定向到另一个页面，每隔 5 到 60 秒就会进行一次 AJAX 调用以检查报告是否仍在运行。（我有一个表来存储 gen_id 和与之相关的用户。）检查脚本运行以下内容：

```
exec('ps ' . $pid , $processState);
if (count($processState) < 2) {
     // less than 2 rows in the ps, therefore report is complete
} 
```

这里有一篇关于这种技术的简短文章：http: [//nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/](http://nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/)

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-10-16T18:55:23.133

我知道没有可用的东西。下一个最好的办法是让一个脚本通过 CLI 执行另一个脚本，但这有点初级。根据您要做什么以及它的复杂程度，这可能是也可能不是一个选项。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2013-01-07T18:10:51.660

简而言之：是的，php 中有多线程，但您应该改用多处理。

## 背景信息：线程与进程

关于线程和进程的区别总是有点混乱，所以我将简要描述两者：

*   **线程**是 CPU 将处理的一系列命令。它包含的唯一数据是程序计数器。每个 CPU 内核一次只能处理一个线程，但可以通过调度在不同线程的执行之间切换。
*   **进程**是一组共享资源。这意味着它由内存、变量、对象实例、文件句柄、互斥体、数据库连接等的一部分组成。每个进程还包含一个或多个线程。同一进程的所有线程共享其资源，因此您可以在一个线程中使用您在另一个线程中创建的变量。如果这些线程是两个不同进程的一部分，那么它们就不能直接访问彼此的资源。在这种情况下，您需要通过管道、文件、套接字等[进行进程间通信......](https://stackoverflow.com/questions/956245/interprocess-communication-within-php-with-a-continous-process)

## 多处理

您可以通过使用 php.ini 创建新进程（也包含新线程）来实现并行计算。如果您的线程不需要太多的通信或同步，这是您的选择，因为进程是隔离的，不会干扰彼此的工作。即使一个崩溃，这与其他人无关。如果您确实需要大量通信，您应该继续阅读“多线程”或 - 遗憾的是 - 考虑使用另一种编程语言，因为进程间通信和同步引入了很多复杂性。

在 php 中，您有两种创建新进程的方法：

**让操作系统为您完成**：您可以告诉您的操作系统创建一个新进程并在其中运行一个新的（或相同的）php 脚本。

*   对于**linux**，您可以使用以下内容或考虑[Darryl Hein 的回答](https://stackoverflow.com/questions/209774/does-php-have-threading/210919#210919)：

    ```
    $cmd = 'nice php script.php 2>&1 & echo $!';
    pclose(popen($cmd, 'r')); 
    ```

*   对于**Windows**，你可以使用这个：

    ```
    $cmd = 'start "processname" /MIN /belownormal cmd /c "script.php 2>&1"';
    pclose(popen($cmd, 'r')); 
    ```

**用 fork 自己做**：php 还提供了通过函数[pcntl_fork()](http://php.net/manual/en/function.pcntl-fork.php)使用 fork 的可能性。可以在[此处](http://www.electrictoolbox.com/article/php/process-forking/)找到有关如何执行此操作的好教程，但我强烈建议不要使用它，因为[fork 是危害人类的罪行](http://docs.oracle.com/cd/E19455-01/806-5257/gen-92888/index.html)，尤其是针对 oop 的罪行。

## 多线程

使用多线程，您的所有线程都共享它们的资源，因此您可以轻松地在它们之间进行通信和同步，而无需大量开销。另一方面，您必须知道自己在做什么，因为竞争条件和死锁很容易产生但很难调试。

标准 php 不提供任何多线程，但实际上有一个（实验性）扩展 - [pthreads](https://github.com/krakjoe/pthreads)。它的 api 文档甚至进入了[php.net](http://php.net/manual/en/book.pthreads.php)。有了它，您可以像在[真正的编程语言](http://en.wikipedia.org/wiki/Java_%28programming_language%29)中一样做一些事情:-)，如下所示：

```
class MyThread extends Thread {
    public function run(){
        //do something time consuming
    }
}

$t = new MyThread();
if($t->start()){
    while($t->isRunning()){
        echo ".";
        usleep(100);
    }
    $t->join();
} 
```

对于**linux** ，stackoverflow 上有一个[安装指南](https://stackoverflow.com/questions/14081444/how-to-use-pthreads-php-extension-in-ubuntu)。

对于**Windows**，现在有一个：

*   首先你需要 php 的线程安全版本。
*   您需要 pthreads 及其 php 扩展的预编译版本。他们可以在[这里](https://github.com/krakjoe/pthreads/downloads)下载。确保您下载的版本与您的 php 版本兼容。
*   将 php_pthreads.dll（从您刚刚下载的 zip 文件）复制到您的 php 扩展文件夹 ([phpDirectory]/ext)。
*   将 pthreadVC2.dll 复制到 [phpDirectory]（根文件夹 - 而不是扩展文件夹）。
*   编辑 [phpDirectory]/php.ini 并插入以下行

    ```
    extension=php_pthreads.dll 
    ```

*   使用上面的脚本进行测试，并在评论所在的位置进行一些睡眠或其他操作。

现在是大问题：虽然这确实有效，**但**php 最初并不是为多线程而设计的。存在 php 的线程安全版本，从 v5.4 开始，它似乎几乎没有错误，但[在 php 手册中仍然不鼓励在](http://www.php.net/manual/en/faq.installation.php#faq.installation.apache2)多线程环境中使用 php （但也许他们只是没有更新他们的手册这个，但是）。一个更大的问题可能是很多常见的[扩展都不是线程安全的](http://php.net/manual/en/faq.obtaining.php#faq.obtaining.optional)。所以你可能会得到这个 php 扩展的线程，但是你所依赖的函数仍然不是线程安全的，所以你可能会在你自己没有编写的代码中遇到竞争条件、死锁等等......

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-16T22:30:26.493

您可以使用[pcntl_fork()](http://us3.php.net/pcntl_fork)来实现类似于线程的功能。从技术上讲它是独立的进程，因此两者之间的通信并不像线程那么简单，我相信如果 apache 调用 PHP 将无法正常工作。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2010-08-24T23:58:12.517

如果有人在乎，我已经恢复了*php_threading*（与线程不同，但相似），我实际上已经将它工作到了（有点）很好的地步！

[项目页面](http://github.com/alecgorge/php_threading)

[下载（适用于 Windows PHP 5.3 VC9 TS）](http://github.com/alecgorge/php_threading/raw/master/binaries/Release/php_threading.dll)

[例子](http://github.com/alecgorge/php_threading/tree/master/source/samples/)

[自述文件](http://github.com/alecgorge/php_threading/blob/master/README.markdown)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-08-08T12:48:09.780

`pcntl_fork()`是您正在搜索的内容，但它的进程分叉不是线程。所以你会有数据交换的问题。要解决它们，您可以使用 phps 信号量函数 ( [http://www.php.net/manual/de/ref.sem.php](http://www.php.net/manual/de/ref.sem.php) ) 消息队列一开始可能比共享内存段更容易一些。

无论如何，我在我正在开发的 Web 框架中使用的一种策略，它并行加载网页的资源密集型块（可能带有外部请求）：我正在做一个工作队列以知道我在等待什么数据，然后我分叉关闭每个进程的工作。完成后，他们将数据存储在父进程可以访问的唯一键下的 apc 缓存中。一旦每个数据都在那里，它就会继续。我正在使用简单`usleep()`的等待，因为在 apache 中无法进行进程间通信（孩子将失去与父母的连接并成为僵尸......）。所以这让我想到了最后一件事：自我杀死每个孩子很重要！还有一些类可以分叉进程但保留数据，我没有检查它们，但 zend 框架有一个，它们通常执行缓慢但可靠的代码。你可以在这里找到它： [http://zendframework.com/manual/1.9/en/zendx.console.process.unix.overview.html](http://zendframework.com/manual/1.9/en/zendx.console.process.unix.overview.html) 我认为他们使用 shm 段！最后但并非最不重要的是这个zend网站上有一个错误，这个例子中的小错误。

```
while ($process1->isRunning() && $process2->isRunning()) {
    sleep(1);
}
should of course be:
while ($process1->isRunning() || $process2->isRunning()) {
    sleep(1);
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-10-24T04:38:17.720

[在https://github.com/krakjoe/pthreads](https://github.com/krakjoe/pthreads)上有一个基于 PThreads 正在积极开发的线程扩展，看起来很有希望

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-12-29T07:38:23.100

只是一个更新，似乎 PHP 人员正在支持线程并且它现在可用。

这是它的链接：http: [//php.net/manual/en/book.pthreads.php](http://php.net/manual/en/book.pthreads.php)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-02-07T22:10:09.043

我有一个 PHP 线程类，它已经在生产环境中完美运行了两年多。

编辑：现在可以作为作曲家库和我的 MVC 框架 Hazaar MVC 的一部分使用。

见：[https ://git.hazaarlabs.com/hazaar/hazaar-thread](https://git.hazaarlabs.com/hazaar/hazaar-thread)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-02-23T15:44:14.137

我知道这是一个老问题，但你可以看看[http://phpthreadlib.sourceforge.net/](http://phpthreadlib.sourceforge.net/)

双向通信，支持 Win32，无需扩展。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-07-28T08:30:47.597

听说过`appserver`techdivision吗？

它是用 php 编写的，用作管理高流量 php 应用程序的多线程的应用程序服务器。仍处于测试阶段，但很有前途。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2008-10-19T12:19:48.343

有一个相当晦涩且很快就会被弃用的功能，称为[ticks](http://docs.php.net/manual/en/control-structures.declare.php#control-structures.declare.ticks)。我唯一用过的就是允许脚本捕获 SIGKILL (Ctrl+C) 并优雅地关闭。

# java - 从 Java 在 Windows 服务器上运行远程命令的最佳方式？

> ID：209775
> 
> 赞同：3
> 
> 时间：2008-10-16T18:47:06.177
> 
> 标签：java, command-line, ssh

是否有任何现有的解决方案可以从 Java 本地远程执行 Windows 服务器上的命令？psexec.exe 不是一个选项，因为 Java 应用程序必须是跨平台的。

即使是使用 Java RM 的现有解决方案也足够了。

目前，我正在使用 SSH 客户端库通过 java SSH 进入运行 cygwin SSH 守护程序的 Windows 服务器。遗憾的是，SSH 守护进程在引用进入 CMD（而不是 bash）shell 的命令时存在一些问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T19:50:47.360

这需要一些工作，但是 Hudson 中的远程处理库对在远程计算机上通过网络运行命令和执行文件操作具有很好的支持。

请参阅[https://jenkins.io/projects/remoting/](https://jenkins.io/projects/remoting/)（您必须深入研究代码）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-17T06:17:48.623

查看[Java RDP 客户端](http://www.elusiva.com/opensource/)。不是真正开箱即用，但只需少量挖掘，您应该能够将其修剪为您需要的内容。

由于它使用 getopt，我认为它是 GPL 的。

# character-encoding - “lew”在“lew2”或“lew4”中代表什么？

> ID：209777
> 
> 赞同：0
> 
> 时间：2008-10-16T18:47:56.737
> 
> 标签：character-encoding

我看到术语 'lew2' 和 'lew4' 用于参考某些文件中的字符大小。我知道该数字表示用于存储某些类型的字符（可能是宽字符？）的字节数，但我不确定“lew”部分代表什么。我最好的猜测是“宽的长度”。任何人都可以启发我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T18:50:59.930

我的猜测是 Little Endian Word 2 Bytes（或 4 Bytes），而不是 Big Endian。

# windows - 本机 Windows 应用程序开发选项

> ID：209778
> 
> 赞同：7
> 
> 时间：2008-10-16T18:48:36.050
> 
> 标签：windows, winapi

冗长的标题，简短的问题：

如果一个人想为 Windows 开发，但不必依赖任何外部依赖项（没有运行时，因此排除了 .net），那么有哪些受支持、活跃且功能齐全的*替代方案？

Visual Basic 6 已经死了，Visual C++ 很明显，而 Delphi 似乎是首选，但我想知道是否还有其他选择？

*如：能够使用所有 Windows 功能，例如在通知区域中放置图标，使任务栏图标闪烁等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-16T18:56:01.777

看看这个 -

[http://www.codegear.com/products/delphi](http://www.codegear.com/products/delphi)

格林

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:06:44.983

[C](http://en.wikipedia.org/wiki/C_programming_language)（许多可用的编译器）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T19:08:01.533

[D](http://en.wikipedia.org/wiki/D_programming)使用[D 编译器](http://www.digitalmars.com/d/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T19:11:02.837

[埃菲尔](http://smarteiffel.loria.fr/)使用[SmartEiffel](http://en.wikipedia.org/wiki/Eiffel_(programming_language)) *

（*note SmartEiffel 解释 eiffel，并生成 ANSI C 代码，可以用任何标准 C 编译器编译。它还生成 Java 字节码。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T19:03:22.323

[Ada用](http://en.wikipedia.org/wiki/Ada_programming_language)[gnat](http://www.gnat.com)编译

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T19:18:13.587

[带有Borland](http://dn.codegear.com/article/20633)的C/C++ ，如果您不想完全受制于 MS。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T19:18:48.063

[Mercury](http://en.wikipedia.org/wiki/Mercury_(programming_language))使用[Mercury](http://www.cs.mu.oz.au/research/mercury/index.html)编译器（编译为 ANSI C，然后可以编译为本机代码）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T19:20:24.940

[Modula 2](http://en.wikipedia.org/wiki/Modula_2)使用[modula2](http://www.excelsior-usa.com/xdsx86.html)编译器

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-16T19:31:52.360

使用[FreePascal](http://www.freepascal.org/)编译器的[Pascal](http://en.wikipedia.org/wiki/Pascal_(programming_language))

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-16T19:39:15.887

[Vala](http://en.wikipedia.org/wiki/Vala_(programming_language)) （编译为 ANSI C）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-16T21:02:53.923

[Haskell](http://haskell.org/)使用[GHC](http://haskell.org/ghc/)。通过 C 编译或直接编译为本机代码，不需要特殊库。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-16T18:59:00.850

看看这个页面：

[http://dada.perl.it/shootout/](http://dada.perl.it/shootout/)

它是在 Win32 平台上编译的计算机语言枪战的一个端口。在使用的语言图表中，他列出了哪些语言可以编译为本机代码（编译器以粗斜体列出）。我确实注意到他将 C# 和 Java 列为编译为本机代码，但这当然是不正确的，所以一定要调查一下。

我将分别列出每种语言以允许单独投票。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-16T19:05:29.340

使用[awka](http://en.wikipedia.org/wiki/Awk) * [_](http://awka.sourceforge.net/)

（*注：awka 解释 awk，并生成 ANSI C，可以用任何 C 编译器编译为本机代码）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-16T19:09:57.317

PowerBasic

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-16T19:12:26.907

[Forth](http://en.wikipedia.org/wiki/Forth_(programming_language))使用[BigForth](http://www.jwdt.com/~paysan/bigforth.html)编译器

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-16T19:14:22.800

使用[ghc的](http://haskell.org/ghc/)[Haskell](http://en.wikipedia.org/wiki/Haskell_(programming_language))

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-16T19:23:08.693

使用[临界质量的](http://modula3.elegosoft.com/cm3/)[模数 3](http://en.wikipedia.org/wiki/Modula_3) *

（*注：编译为 ANSI C，可以使用任何标准 C 编译器编译为本机代码）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-16T19:26:56.440

使用[OCaml](http://en.wikipedia.org/wiki/Ocaml)编译器编译的[OCaml](http://caml.inria.fr/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-16T19:36:05.533

使用[Visual Prolog](http://www.visual-prolog.com/)[的Prolog](http://en.wikipedia.org/wiki/Visual_Prolog)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-16T19:41:59.640

使用[UberCode](http://en.wikipedia.org/wiki/Ubercode)编译器的[Ubercode](http://www.ubercode.com/index.html)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-16T19:51:29.450

[Goo](http://en.wikipedia.org/wiki/Goo_(programming_language))使用[Goo](http://people.csail.mit.edu/jrb/goo/)编译器（生成 ANSI C）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-03-12T07:55:17.133

[REALbasic](http://www.realsoftware.com/)为您提供了能够为 Mac 和 Linux 编译的额外好处。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-11-19T08:25:38.490

我认为你应该试试 Qt。至少，下载文件并运行示例，因为它附带了一个您想要的通知区域功能的工作示例。

[http://qt-project.org/](http://qt-project.org/)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-10-14T15:02:29.020

MASM32 ( [http://masm32.com/](http://masm32.com/) ) 如果您可以接受许可协议。

# c# - 如何使用 C# 中的代码更改网络设置（IP 地址、DNS、WINS、主机名）

> ID：209779
> 
> 赞同：70
> 
> 时间：2008-10-16T18:48:37.580
> 
> 标签：c#, .net, configuration, networking

我正在为要用作其他机器备份的机器开发向导。当它替换现有机器时，它需要设置其 IP 地址、DNS、WINS 和主机名以匹配被替换的机器。

.net (C#) 中是否有允许我以编程方式执行此操作的库？

有多个网卡，每个都需要单独设置。

**编辑**

谢谢[TimothyP](https://stackoverflow.com/questions/209779/how-can-you-change-network-settings-ip-address-dns-wins-host-name-with-code-in-c#209822)的例子。它让我走上了正确的轨道，快速回复很棒。

谢谢巴勒[山德](https://stackoverflow.com/questions/209779/how-can-you-change-network-settings-ip-address-dns-wins-host-name-with-code-in-c#209983)。你的代码很完美。我很着急，已经修改了 TimothyP 链接的示例，但我很想早点得到你的代码。

我还开发了一个使用类似技术更改计算机名称的例程。我将在未来发布它，如果您想了解更新，请订阅此问题的[RSS 提要。](https://stackoverflow.com/feeds/question/209779 "RSS订阅")我可能会在今天晚些时候或周一稍作清理后把它弄起来。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-10-16T19:46:36.823

几分钟后就做了这个：

```
using System;
using System.Management;

namespace WindowsFormsApplication_CS
{
  class NetworkManagement
  {
    public void setIP(string ip_address, string subnet_mask)
    {
      ManagementClass objMC =
        new ManagementClass("Win32_NetworkAdapterConfiguration");
      ManagementObjectCollection objMOC = objMC.GetInstances();

      foreach (ManagementObject objMO in objMOC)
      {
        if ((bool)objMO["IPEnabled"])
        {
          ManagementBaseObject setIP;
          ManagementBaseObject newIP =
            objMO.GetMethodParameters("EnableStatic");

          newIP["IPAddress"] = new string[] { ip_address };
          newIP["SubnetMask"] = new string[] { subnet_mask };

          setIP = objMO.InvokeMethod("EnableStatic", newIP, null);
        }
      }
    }

    public void setGateway(string gateway)
    {
      ManagementClass objMC = new ManagementClass("Win32_NetworkAdapterConfiguration");
      ManagementObjectCollection objMOC = objMC.GetInstances();

      foreach (ManagementObject objMO in objMOC)
      {
        if ((bool)objMO["IPEnabled"])
        {
          ManagementBaseObject setGateway;
          ManagementBaseObject newGateway =
            objMO.GetMethodParameters("SetGateways");

          newGateway["DefaultIPGateway"] = new string[] { gateway };
          newGateway["GatewayCostMetric"] = new int[] { 1 };

          setGateway = objMO.InvokeMethod("SetGateways", newGateway, null);
        }
      }
    }

    public void setDNS(string NIC, string DNS)
    {
      ManagementClass objMC = new ManagementClass("Win32_NetworkAdapterConfiguration");
      ManagementObjectCollection objMOC = objMC.GetInstances();

      foreach (ManagementObject objMO in objMOC)
      {
        if ((bool)objMO["IPEnabled"])
        {
          // if you are using the System.Net.NetworkInformation.NetworkInterface
          // you'll need to change this line to
          // if (objMO["Caption"].ToString().Contains(NIC))
          // and pass in the Description property instead of the name 
          if (objMO["Caption"].Equals(NIC))
          {
            ManagementBaseObject newDNS =
              objMO.GetMethodParameters("SetDNSServerSearchOrder");
            newDNS["DNSServerSearchOrder"] = DNS.Split(',');
            ManagementBaseObject setDNS =
              objMO.InvokeMethod("SetDNSServerSearchOrder", newDNS, null);
          }
        }
      }
    }

    public void setWINS(string NIC, string priWINS, string secWINS)
    {
      ManagementClass objMC = new ManagementClass("Win32_NetworkAdapterConfiguration");
      ManagementObjectCollection objMOC = objMC.GetInstances();

      foreach (ManagementObject objMO in objMOC)
      {
        if ((bool)objMO["IPEnabled"])
        {
          if (objMO["Caption"].Equals(NIC))
          {
            ManagementBaseObject setWINS;
            ManagementBaseObject wins =
            objMO.GetMethodParameters("SetWINSServer");
            wins.SetPropertyValue("WINSPrimaryServer", priWINS);
            wins.SetPropertyValue("WINSSecondaryServer", secWINS);

            setWINS = objMO.InvokeMethod("SetWINSServer", wins, null);
          }
        }
      }
    } 
  }
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2011-10-28T07:04:54.413

稍微重构了 balexandre 的代码，以便处理对象并使用 C# 3.5+ 的新语言特性（Linq、var 等）。还将变量重命名为更有意义的名称。我还合并了一些功能，以便能够以更少的 WMI 交互进行更多配置。我删除了 WINS 代码，因为我不再需要配置 WINS。如果需要，请随意添加 WINS 代码。

对于任何人都喜欢使用重构/现代化代码的情况，我将其放回社区。

```
/// <summary>
/// Helper class to set networking configuration like IP address, DNS servers, etc.
/// </summary>
public class NetworkConfigurator
{
    /// <summary>
    /// Set's a new IP Address and it's Submask of the local machine
    /// </summary>
    /// <param name="ipAddress">The IP Address</param>
    /// <param name="subnetMask">The Submask IP Address</param>
    /// <param name="gateway">The gateway.</param>
    /// <remarks>Requires a reference to the System.Management namespace</remarks>
    public void SetIP(string ipAddress, string subnetMask, string gateway)
    {
        using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
        {
            using (var networkConfigs = networkConfigMng.GetInstances())
            {
                foreach (var managementObject in networkConfigs.Cast<ManagementObject>().Where(managementObject => (bool)managementObject["IPEnabled"]))
                {
                    using (var newIP = managementObject.GetMethodParameters("EnableStatic"))
                    {
                        // Set new IP address and subnet if needed
                        if ((!String.IsNullOrEmpty(ipAddress)) || (!String.IsNullOrEmpty(subnetMask)))
                        {
                            if (!String.IsNullOrEmpty(ipAddress))
                            {
                                newIP["IPAddress"] = new[] { ipAddress };
                            }

                            if (!String.IsNullOrEmpty(subnetMask))
                            {
                                newIP["SubnetMask"] = new[] { subnetMask };
                            }

                            managementObject.InvokeMethod("EnableStatic", newIP, null);
                        }

                        // Set mew gateway if needed
                        if (!String.IsNullOrEmpty(gateway))
                        {
                            using (var newGateway = managementObject.GetMethodParameters("SetGateways"))
                            {
                                newGateway["DefaultIPGateway"] = new[] { gateway };
                                newGateway["GatewayCostMetric"] = new[] { 1 };
                                managementObject.InvokeMethod("SetGateways", newGateway, null);
                            }
                        }
                    }
                }
            }
        }
    }

    /// <summary>
    /// Set's the DNS Server of the local machine
    /// </summary>
    /// <param name="nic">NIC address</param>
    /// <param name="dnsServers">Comma seperated list of DNS server addresses</param>
    /// <remarks>Requires a reference to the System.Management namespace</remarks>
    public void SetNameservers(string nic, string dnsServers)
    {
        using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
        {
            using (var networkConfigs = networkConfigMng.GetInstances())
            {
                foreach (var managementObject in networkConfigs.Cast<ManagementObject>().Where(objMO => (bool)objMO["IPEnabled"] && objMO["Caption"].Equals(nic)))
                {
                    using (var newDNS = managementObject.GetMethodParameters("SetDNSServerSearchOrder"))
                    {
                        newDNS["DNSServerSearchOrder"] = dnsServers.Split(',');
                        managementObject.InvokeMethod("SetDNSServerSearchOrder", newDNS, null);
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-03-25T08:51:25.100

我喜欢 WMILinq 解决方案。虽然不能完全解决您的问题，但请在下面找到它的味道：

```
using (WmiContext context = new WmiContext(@"\\.")) {

  context.ManagementScope.Options.Impersonation = ImpersonationLevel.Impersonate;
  context.Log = Console.Out;

  var dnss = from nic in context.Source<Win32_NetworkAdapterConfiguration>()
          where nic.IPEnabled
          select nic;

  var ips = from s in dnss.SelectMany(dns => dns.DNSServerSearchOrder)
          select IPAddress.Parse(s);
} 
```

[http://www.codeplex.com/linq2wmi](http://www.codeplex.com/linq2wmi)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-10-22T07:13:36.770

一个更明确的解决方案是使用命令`netsh`更改 IP（或将其设置回 DHCP）

```
netsh interface ip set address "Local Area Connection" static 192.168.0.10 255.255.255.0 
```

其中“本地连接”是网络适配器的名称。您可以在 windows 网络连接中找到它，有时它被简单地命名为“以太网”。

这里有两种设置 IP 的方法，也可以将 IP 设置回 DHCP “自动获取 IP 地址”

```
public bool SetIP(string networkInterfaceName, string ipAddress, string subnetMask, string gateway = null)
{
    var networkInterface = NetworkInterface.GetAllNetworkInterfaces().FirstOrDefault(nw => nw.Name == networkInterfaceName);
    var ipProperties = networkInterface.GetIPProperties();
    var ipInfo = ipProperties.UnicastAddresses.FirstOrDefault(ip => ip.Address.AddressFamily == AddressFamily.InterNetwork);
    var currentIPaddress = ipInfo.Address.ToString();
    var currentSubnetMask = ipInfo.IPv4Mask.ToString();
    var isDHCPenabled = ipProperties.GetIPv4Properties().IsDhcpEnabled;

    if (!isDHCPenabled && currentIPaddress == ipAddress && currentSubnetMask == subnetMask)
        return true;    // no change necessary

    var process = new Process
    {
        StartInfo = new ProcessStartInfo("netsh", $"interface ip set address \"{networkInterfaceName}\" static {ipAddress} {subnetMask}" + (string.IsNullOrWhiteSpace(gateway) ? "" : $"{gateway} 1")) { Verb = "runas" }
    };
    process.Start();
    var successful = process.ExitCode == 0;
    process.Dispose();
    return successful;
}

public bool SetDHCP(string networkInterfaceName)
{
    var networkInterface = NetworkInterface.GetAllNetworkInterfaces().FirstOrDefault(nw => nw.Name == networkInterfaceName);
    var ipProperties = networkInterface.GetIPProperties();
    var isDHCPenabled = ipProperties.GetIPv4Properties().IsDhcpEnabled;

    if (isDHCPenabled)
        return true;    // no change necessary

    var process = new Process
    {
        StartInfo = new ProcessStartInfo("netsh", $"interface ip set address \"{networkInterfaceName}\" dhcp") { Verb = "runas" }
    };
    process.Start();
    var successful = process.ExitCode == 0;
    process.Dispose();
    return successful;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-03-03T00:49:15.543

一个更简洁的示例，建立在此处的其他答案之上。我利用 Visual Studio 附带的代码生成来删除大部分额外的调用代码，并将其替换为类型化对象。

```
 using System;
    using System.Management;

    namespace Utils
    {
        class NetworkManagement
        {
            /// <summary>
            /// Returns a list of all the network interface class names that are currently enabled in the system
            /// </summary>
            /// <returns>list of nic names</returns>
            public static string[] GetAllNicDescriptions()
            {
                List<string> nics = new List<string>();

                using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
                {
                    using (var networkConfigs = networkConfigMng.GetInstances())
                    {
                        foreach (var config in networkConfigs.Cast<ManagementObject>()
                                                                           .Where(mo => (bool)mo["IPEnabled"])
                                                                           .Select(x=> new NetworkAdapterConfiguration(x)))
                        {
                            nics.Add(config.Description);
                        }
                    }
                }

                return nics.ToArray();
            }

            /// <summary>
            /// Set's the DNS Server of the local machine
            /// </summary>
            /// <param name="nicDescription">The full description of the network interface class</param>
            /// <param name="dnsServers">Comma seperated list of DNS server addresses</param>
            /// <remarks>Requires a reference to the System.Management namespace</remarks>
            public static bool SetNameservers(string nicDescription, string[] dnsServers, bool restart = false)
            {
                using (ManagementClass networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
                {
                    using (ManagementObjectCollection networkConfigs = networkConfigMng.GetInstances())
                    {
                        foreach (ManagementObject mboDNS in networkConfigs.Cast<ManagementObject>().Where(mo => (bool)mo["IPEnabled"] && (string)mo["Description"] == nicDescription))
                        {
                            // NAC class was generated by opening a developer console and entering:
                            // mgmtclassgen Win32_NetworkAdapterConfiguration -p NetworkAdapterConfiguration.cs
                            // See: http://blog.opennetcf.com/2008/06/24/disableenable-network-connections-under-vista/

                            using (NetworkAdapterConfiguration config = new NetworkAdapterConfiguration(mboDNS))
                            {
                                if (config.SetDNSServerSearchOrder(dnsServers) == 0)
                                {
                                    RestartNetworkAdapter(nicDescription);
                                }
                            }
                        }
                    }
                }

                return false;
            }

            /// <summary>
            /// Restarts a given Network adapter
            /// </summary>
            /// <param name="nicDescription">The full description of the network interface class</param>
            public static void RestartNetworkAdapter(string nicDescription)
            {
                using (ManagementClass networkConfigMng = new ManagementClass("Win32_NetworkAdapter"))
                {
                    using (ManagementObjectCollection networkConfigs = networkConfigMng.GetInstances())
                    {
                        foreach (ManagementObject mboDNS in networkConfigs.Cast<ManagementObject>().Where(mo=> (string)mo["Description"] == nicDescription))
                        {
                            // NA class was generated by opening dev console and entering
                            // mgmtclassgen Win32_NetworkAdapter -p NetworkAdapter.cs
                            using (NetworkAdapter adapter = new NetworkAdapter(mboDNS))
                            {
                                adapter.Disable();
                                adapter.Enable();
                                Thread.Sleep(4000); // Wait a few secs until exiting, this will give the NIC enough time to re-connect
                                return;
                            }
                        }
                    }
                }
            }

            /// <summary>
            /// Get's the DNS Server of the local machine
            /// </summary>
            /// <param name="nicDescription">The full description of the network interface class</param>
            public static string[] GetNameservers(string nicDescription)
            {
                using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
                {
                    using (var networkConfigs = networkConfigMng.GetInstances())
                    {
                        foreach (var config  in networkConfigs.Cast<ManagementObject>()
                                                              .Where(mo => (bool)mo["IPEnabled"] && (string)mo["Description"] == nicDescription)
                                                              .Select( x => new NetworkAdapterConfiguration(x)))
                        {
                            return config.DNSServerSearchOrder;
                        }
                    }
                }

                return null;
            }

            /// <summary>
            /// Set's a new IP Address and it's Submask of the local machine
            /// </summary>
            /// <param name="nicDescription">The full description of the network interface class</param>
            /// <param name="ipAddresses">The IP Address</param>
            /// <param name="subnetMask">The Submask IP Address</param>
            /// <param name="gateway">The gateway.</param>
            /// <remarks>Requires a reference to the System.Management namespace</remarks>
            public static void SetIP(string nicDescription, string[] ipAddresses, string subnetMask, string gateway)
            {
                using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
                {
                    using (var networkConfigs = networkConfigMng.GetInstances())
                    {
                        foreach (var config in networkConfigs.Cast<ManagementObject>()
                                                                       .Where(mo => (bool)mo["IPEnabled"] && (string)mo["Description"] == nicDescription)
                                                                       .Select( x=> new NetworkAdapterConfiguration(x)))
                        {
                            // Set the new IP and subnet masks if needed
                            config.EnableStatic(ipAddresses, Array.ConvertAll(ipAddresses, _ => subnetMask));

                            // Set mew gateway if needed
                            if (!String.IsNullOrEmpty(gateway))
                            {
                                config.SetGateways(new[] {gateway}, new ushort[] {1});
                            }
                        }
                    }
                }
            }

        }
    } 
```

完整来源： [https ://github.com/sverrirs/DnsHelper/blob/master/src/DnsHelperUI/NetworkManagement.cs](https://github.com/sverrirs/DnsHelper/blob/master/src/DnsHelperUI/NetworkManagement.cs)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-17T19:14:51.580

现有答案的代码很糟糕。DNS方法根本不起作用。这是我用来配置网卡的代码：

```
public static class NetworkConfigurator
{
    /// <summary>
    /// Set's a new IP Address and it's Submask of the local machine
    /// </summary>
    /// <param name="ipAddress">The IP Address</param>
    /// <param name="subnetMask">The Submask IP Address</param>
    /// <param name="gateway">The gateway.</param>
    /// <param name="nicDescription"></param>
    /// <remarks>Requires a reference to the System.Management namespace</remarks>
    public static void SetIP(string nicDescription, string[] ipAddresses, string subnetMask, string gateway)
    {
        using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
        {
            using (var networkConfigs = networkConfigMng.GetInstances())
            {
                foreach (var managementObject in networkConfigs.Cast<ManagementObject>().Where(mo => (bool)mo["IPEnabled"] && (string)mo["Description"] == nicDescription))
                {
                    using (var newIP = managementObject.GetMethodParameters("EnableStatic"))
                    {
                        // Set new IP address and subnet if needed
                        if (ipAddresses != null || !String.IsNullOrEmpty(subnetMask))
                        {
                            if (ipAddresses != null)
                            {
                                newIP["IPAddress"] = ipAddresses;
                            }

                            if (!String.IsNullOrEmpty(subnetMask))
                            {
                                newIP["SubnetMask"] = Array.ConvertAll(ipAddresses, _ => subnetMask);
                            }

                            managementObject.InvokeMethod("EnableStatic", newIP, null);
                        }

                        // Set mew gateway if needed
                        if (!String.IsNullOrEmpty(gateway))
                        {
                            using (var newGateway = managementObject.GetMethodParameters("SetGateways"))
                            {
                                newGateway["DefaultIPGateway"] = new[] { gateway };
                                newGateway["GatewayCostMetric"] = new[] { 1 };
                                managementObject.InvokeMethod("SetGateways", newGateway, null);
                            }
                        }
                    }
                }
            }
        }
    }

    /// <summary>
    /// Set's the DNS Server of the local machine
    /// </summary>
    /// <param name="nic">NIC address</param>
    /// <param name="dnsServers">Comma seperated list of DNS server addresses</param>
    /// <remarks>Requires a reference to the System.Management namespace</remarks>
    public static void SetNameservers(string nicDescription, string[] dnsServers)
    {
        using (var networkConfigMng = new ManagementClass("Win32_NetworkAdapterConfiguration"))
        {
            using (var networkConfigs = networkConfigMng.GetInstances())
            {
                foreach (var managementObject in networkConfigs.Cast<ManagementObject>().Where(mo => (bool)mo["IPEnabled"] && (string)mo["Description"] == nicDescription))
                {
                    using (var newDNS = managementObject.GetMethodParameters("SetDNSServerSearchOrder"))
                    {
                        newDNS["DNSServerSearchOrder"] = dnsServers;
                        managementObject.InvokeMethod("SetDNSServerSearchOrder", newDNS, null);
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-04T08:37:19.920

这可能更清楚：

```
static NetworkInterface GetNetworkInterface(string macAddress)
{
    foreach(NetworkInterface ni in NetworkInterface.GetAllNetworkInterfaces())
    {
        if (macAddress == ni.GetPhysicalAddress().ToString())
            return ni;
    }
    return null;
}
static ManagementObject GetNetworkInterfaceManagementObject(string macAddress)
{
    NetworkInterface ni = GetNetworkInterface(macAddress);
    if (ni == null)
        return null;
    ManagementClass managementClass = new ManagementClass("Win32_NetworkAdapterConfiguration");
    ManagementObjectCollection moc = managementClass.GetInstances();
    foreach(ManagementObject mo in moc)
    {
        if (mo["settingID"].ToString() == ni.Id)
            return mo;
    }
    return null;
}
static bool SetupNIC(string macAddress, string ip, string subnet, string gateway, string dns)
{
    try
    {
        ManagementObject mo = GetNetworkInterfaceManagementObject(macAddress);

        //Set IP
        ManagementBaseObject mboIP = mo.GetMethodParameters("EnableStatic");
        mboIP["IPAddress"] = new string[] { ip };
        mboIP["SubnetMask"] = new string[] { subnet };
        mo.InvokeMethod("EnableStatic", mboIP, null);

        //Set Gateway
        ManagementBaseObject mboGateway = mo.GetMethodParameters("SetGateways");
        mboGateway["DefaultIPGateway"] = new string[] { gateway };
        mboGateway["GatewayCostMetric"] = new int[] { 1 };
        mo.InvokeMethod("SetGateways", mboGateway, null);

        //Set DNS
        ManagementBaseObject mboDNS = mo.GetMethodParameters("SetDNSServerSearchOrder");
        mboDNS["DNSServerSearchOrder"] = new string[] { dns };
        mo.InvokeMethod("SetDNSServerSearchOrder", mboDNS, null);

        return true;
    }
    catch (Exception e)
    {
        return false;
    }
} 
```

# java - 使用maven时开发环境与部署的不同spring XML文件

> ID：209786
> 
> 赞同：0
> 
> 时间：2008-10-16T18:50:44.017
> 
> 标签：java, eclipse, spring, maven-2, ldap

**概括**

我们有一个中央 LDAP 服务器，我们部署的 Java Web 应用程序应该连接到该服务器。我们的 JUnit 测试依赖于 LDAP 存储库中的特定数据，因此它们需要连接到嵌入式 ApacheDS LDAP 服务器，并以示例数据集为基础。当我们部署我们的 webapp 时，我们如何确保 ApacheDS 服务器不会启动？

**细节**

我们正在使用 Spring 安全性，并在 ldap-context.xml 中有以下行来启动嵌入式 LDAP 服务器：

```
<security:ldap-server root="dc=test,dc=com" port="33389" ldif="classpath:EmbeddedServerRoot.ldif" /> 
```

目前，我们的 web.xml 引用了这个测试上下文文件和我们的顶级 application-context.xml：

```
 <context-param>
       <param-name>contextConfigLocation</param-name>
       <param-value>
           classpath:ldap-context.xml
           classpath:application-context.xml 
       </param-value>
   </context-param> 
```

我们需要确保在运行 JUnit 测试以及直接从 eclipse（通过 WTP）运行 webapp 时包含 ldap-context.xml，但在打包 war 并将其部署到服务器时排除。

我们使用 maven 作为构建工具。我们可以很容易地为我们的 JUnit 测试处理这种情况，方法是确保它们在上下文配置中包含两个 spring 上下文文件：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath:ldap-context.xml", "classpath:application-context.xml" })
public class TestStuff {
} 
```

然后，我们的 web.xml 将只包含 application-context.xml，除了一件事——从 WTP 运行时这不起作用——在这种情况下我们也需要启动嵌入式服务器。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T20:26:10.313

如果您使用的是 Maven，为什么不使用 Assembly 插件来管理您的环境部署。看起来您的 spring 文件并不那么复杂，因此您可以拥有一个没有 ldap-context.xml 引用的通用 spring 文件，然后是一个具有 ldap 引用的特定于测试的版本。配置并运行程序集时，环境特定文件将覆盖通用版本，然后您可以部署打包的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T22:29:20.957

另一种可能性是使用 pom 中的一些属性和过滤的 spring bean 文件，为 bean 定义别名以在环境之间切换。但是您需要在配置中同时使用两个 bean，但您将使用其中一个。

# sql - SQL 一对多在多方面通过 ALL 匹配一方面

> ID：209787
> 
> 赞同：8
> 
> 时间：2008-10-16T18:50:49.853
> 
> 标签：sql, sql-match-all

在下面一对多

```
CREATE TABLE source(id int, name varchar(10), PRIMARY KEY(id));
CREATE TABLE params(id int, source int, value int); 
```

其中 params.source 是 source.id 的外键

```
INSERT INTO source values(1, 'yes');
INSERT INTO source values(2, 'no');

INSERT INTO params VALUES(1,1,1);
INSERT INTO params VALUES(2,1,2);
INSERT INTO params VALUES(3,1,3);

INSERT INTO params VALUES(4,2,1);
INSERT INTO params VALUES(5,2,3);
INSERT INTO params VALUES(6,2,4); 
```

如果我有一个参数值列表（比如 [1,2,3]），我如何在 SQL 中找到具有列表中所有值的所有源（源 1，“是”）？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-16T19:01:23.573

```
SELECT s.*
FROM source AS s
 JOIN params AS p ON (p.source = s.id)
WHERE p.value IN (1,2,3)
GROUP BY s.id
HAVING COUNT(DISTINCT p.value) = 3; 
```

您需要 DISTINCT 因为您的 params.value 不会被阻止重复。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T19:00:55.243

**编辑**修改以处理给定源的值可能多次出现的情况。

试试这个：

```
SELECT
    *
FROM
    source
WHERE
    (
        SELECT COUNT(DISTINCT value)
        FROM params
        WHERE params.source = source.id
          AND params.value IN (1, 2, 3)
    ) = 3 
```

您也可以将其重写为 GROUP BY：

```
SELECT
    source.*
FROM
    source
    INNER JOIN params ON params.source = source.id
WHERE
    params.value IN (1, 2, 3)
GROUP BY
    source.id,
    source.name
HAVING
    COUNT(DISTINCT params.value) = 3 
```

# eclipse - 使用特定工作区启动 Eclipse

> ID：209789
> 
> 赞同：168
> 
> 时间：2008-10-16T18:51:09.320
> 
> 标签：eclipse, zend-studio, eclipse-pdt

有没有办法启动 eclipse 的实例，传递某种参数告诉它使用特定的工作区？

我要解决的问题是我有一个用于工作项目的工作区和一个用于个人项目的工作区。我希望能够将这些与工作区联系起来，以分离我可以独立启动的快捷方式。

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2008-10-16T18:54:14.213

从[http://help.eclipse.org/help21/topic/org.eclipse.platform.doc.user/tasks/running_eclipse.htm](http://help.eclipse.org/help21/topic/org.eclipse.platform.doc.user/tasks/running_eclipse.htm)：

使用以下命令行参数：

```
-data your_workspace_location 
```

例如，

```
-data c:\users\robert\myworkspace 
```

您还可以使用 UNIX 风格的相对路径名，例如

```
-data ../workspace 
```

即使在 Windows 下，以防参数中不喜欢冒号或反斜杠，例如 Jumplist Launcher

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-16T18:56:20.013

使用 -data 开关

使用 -data 为工作区设置特定位置

要使用 -data 命令行参数，只需将 -data your_workspace_location（例如 -data c:\users\robert\myworkspace）添加到快捷方式属性中的 Target 字段，或将其显式包含在命令行中。

来自：[http ://help.eclipse.org/help21/index.jsp?topic=/org.eclipse.platform.doc.user/tasks/running_eclipse.htm](http://help.eclipse.org/help21/index.jsp?topic=/org.eclipse.platform.doc.user/tasks/running_eclipse.htm)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-08-15T18:15:12.873

我们通过修改快捷方式属性为高中学生设置默认工作区。在这种情况下，我们运行 Windows 7 环境。默认工作区位于映射为 H: 驱动器的学生网络共享上，因此我们添加了**-data h:\workspace**。屏幕截图显示了确切的位置。

![在此处输入图像描述](https://i.stack.imgur.com/CB1aj.png)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-05-08T22:21:49.803

请注意，您可以使用 UNIX 风格的相对路径名，例如

```
-data ../workspace 
```

即使在 Windows 下，以防参数中不喜欢冒号或反斜杠，例如 Jumplist Launcher

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-27T16:03:39.360

老问题，我知道，但只是想指出您可能需要在目标工作区路径周围添加引号。例如; 我试过`C:\Eclipse\eclipse.exe -data E:\Eclipse Projects2`了，它会打开一个空白的默认工作区，同时`C:\Eclipse\eclipse.exe -data "E:\Eclipse Projects2"`允许它使用现有的工作区。我猜这会根据操作系统和/或 Eclipse 版本而有所不同，但我不确定究竟是什么因素造成了这种情况，所以只需尝试两种方法，直到你找到一种方法来加载正确/现有的工作区。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-09T13:01:23.320

**使用 target 创建快捷方式文件：**

创建 Eclipse 的快捷方式。打开快捷方式文件的属性，设置目标如下，

```
E\STS.exe -data "WORKSPACE_LOCATION" 
```

**从 .bat 文件启动：**

```
cd ECLIPSE_LOCATION   
start STS.exe -data "WORKSPACE_LOCATION" 
```

例子：

```
cd /D D:\IDE\sts-bundle\sts-3.7.0.RELEASE    
start STS.exe -data "D:\My Workspace\workspace1" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-12T17:58:48.000

来自[https://help.eclipse.org/topic/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html](https://help.eclipse.org/topic/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html)

也可以使用`osgi.instance.area`JVM arg指定工作空间位置`-Dosgi.instance.area=../workspace`

这可以在 eclipse.ini 文件中与现有/其他 JVM 参数一起指定，例如`-Xms, -Xmx`.

对于那些只想附加到 eclipse.ini 文件（已经包含其他 JVM 参数）而不担心确保 JVM 参数出现在末尾的人来说，这个选项可能很方便。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-04-22T13:03:41.607

我希望人们给出一个实际的例子，我用例子而不是语法学得更好。所以这里...

```
"C:\MyEclipse Blue Edition\MyEclipse Blue Edition 10\myeclipse-blue.exe" -showlocation -data "C:\EclipseWork\WorkSpace" 
```

此命令将使用指定的工作区打开 eclipse。这是一个工作示例。

# unix - 适用于 unix 或 pc 的 VMS 编辑器 EDT 的免费软件克隆？

> ID：209790
> 
> 赞同：0
> 
> 时间：2008-10-16T18:51:09.447
> 
> 标签：unix, editor, vms, edt

我希望在我经常使用的所有平台上都可以使用相同的编辑器。

Emacs 和 Vi 不是理想的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T19:22:09.180

有[nu/TPU](http://www.asoft-dev.com/)更像 EVE/TPU，还有[JED](http://www.jedsoft.org/jed/)，我从来没有发现比这两个更好的东西。

我曾经是 VMS 和 EVE/EDT/TPU 的世界上最大的粉丝——你可能会因为这样说而给我-1，但为什么不[为 emacs 获取 edt 模式](http://www.bmen.tulane.edu/~rthart/EDTdescription.html)。在速度和设施方面，emacs 有很多话要说，值得花时间学习足够的知识，将它变成您选择的编辑器，我认为这就是为什么我们喜欢 emacs 的人喜欢它的原因——因为我们可以定制它来做我们想做的事......

目前我正在使用 Xemacs - 根据我的击键定制，其中一些来自 EDT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T19:44:41.023

[http://sourceforge.net/projects/edt-text-editor/](http://sourceforge.net/projects/edt-text-editor/)

# c++ - 有什么方法可以只用类运算符进行转换吗？

> ID：209793
> 
> 赞同：3
> 
> 时间：2008-10-16T18:54:13.060
> 
> 标签：c++, compiler-construction, casting

一个随机的问题...

我正在寻找的是一种表达转换操作的方法，该操作使用我要转换的类实例的已定义运算符，如果没有为该类型定义的转换运算符，则会生成编译时错误。因此，例如，我正在寻找的是类似的东西：

```
template< typename RESULT_TYPE, typename INPUT_TYPE >
RESULT_TYPE operator_cast( const INPUT_TYPE& tValue )
{
    return tValue.operator RESULT_TYPE();
}

// Should work...
CString sString;
LPCTSTR pcszString = operator_cast< LPCTSTR >( sString );

// Should fail...
int iValue = 42;
DWORD dwValue = operator_cast< DWORD >( iValue ); 
```

有趣的旁注：上面的代码使 VS2005 C++ 编译器崩溃，并且由于我猜测是编译器错误，因此无法在 VS2008 C++ 编译器中正确编译，但希望能证明这个想法。

有人知道有什么方法可以达到这种效果吗？

编辑：更多理由，解释为什么你可能会使用它。假设您有一个包装器类，它应该封装或抽象一个类型，并且您将它转换为封装的类型。您可以使用 static_cast<>，但是当您希望它失败时这可能会起作用（即：编译器选择一个允许转换为您要求的类型的运算符，当您想要失败时，因为该运算符不存在）。

诚然，这是一个不常见的情况，但令人讨厌的是我无法准确地表达我希望编译器在封装函数中执行的操作......因此这里有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T21:17:15.373

您发布的代码可与[Cameau 编译器](http://www.comeaucomputing.com/tryitout/)一起使用（这通常很好地表明它是有效的 C++）。

如您所知，有效的演员表不超过一个用户定义的演员表，所以我想到的一个可能的解决方案是通过在演员表模板中定义一个新类型并有一个[静态断言](http://www.boost.org/doc/libs/1_36_0/boost/static_assert.hpp)没有可用的演员表来添加另一个用户定义的演员表结果类型的新类型（使用[boost is_convertible](http://www.boost.org/doc/libs/1_36_0/boost/type_traits/is_convertible.hpp)），但是这不区分强制转换运算符和强制转换构造函数（带有一个参数的 ctor），并允许进行额外的强制转换（例如`void*`to `bool`）。我不确定区分强制转换运算符和强制转换构造函数是否*正确*，但这就是问题所在。

在考虑了几天之后，我想到了，您可以简单地获取演员表操作员的地址。由于 C++ 指向成员语法的毛茸茸的指针，这说起来容易做起来难（我花了比预期更长的时间才能把它弄好）。我不知道这是否适用于VS2008，我只在Cameau上检查过。

```
template< typename Res, typename T>
Res operator_cast( const T& t )
{
    typedef Res (T::*cast_op_t)() const;
    cast_op_t cast_op = &T::operator Res;
    return (t.*cast_op)();
} 
```

**编辑：**我有机会在 VS2005 和 VS2008 上对其进行测试。我的发现与原始海报的不同。

*   在 VS2008 上，原始版本似乎可以正常工作（就像我的一样）。
*   在 VS2005 上，原始版本仅在从内置类型（例如，将 int 转换为 int）转换为编译错误后崩溃编译器，这对我来说似乎还不错，而且我的版本似乎在所有情况下都有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T19:19:27.610

使用标记为[显式](https://stackoverflow.com/questions/121162/what-does-the-explicit-keyword-in-c-mean)的转换构造函数可以防止编译器允许隐式转换的类型初始化包装类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T21:12:09.957

由于模板相关的编译器错误消息通常很难解开，如果您不介意指定每个转换，您可以通过提供默认模板定义让编译器在失败情况下发出更具指导性的消息。这使用了编译器将仅尝试编译实际调用的模板中的代码这一事实。

```
#include <string>

// Class to trigger compiler warning   
class NO_OPERATOR_CONVERSION_AVAILABLE
{
private:
   NO_OPERATOR_CONVERSION_AVAILABLE(){};
};

// Default template definition to cause compiler error
template<typename T1, typename T2> T1 operator_cast(const T2&)
{
   NO_OPERATOR_CONVERSION_AVAILABLE a;
   return T1();
}

// Template specialisation
template<> std::string operator_cast(const std::string &x)
{
   return x;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T20:51:04.663

听起来你想要模板专业化，这样的事情会做：

```
/* general template */
template<typename T1, typename T2> T1 operator_cast(const T2 &x);

/* do this for each valid cast */
template<> LPCTSTR operator_cast(const CString &x) { return (LPCTSTR)x; } 
```

编辑：如另一篇文章中所述，如果执行了不受支持的强制转换，您可以在通用版本中添加一些内容，以便为您提供更有用的错误消息。

# .net - WCF WebHttp 混合身份验证（基本和匿名）

> ID：209795
> 
> 赞同：8
> 
> 时间：2008-10-16T18:54:19.533
> 
> 标签：.net, wcf, http, authentication, http-authentication

所有这些都与 WebHttp 绑定有关，托管在自定义服务主机中（此时 IIS 不是一个选项）。

我已经实现了自定义 UserNamePasswordValidator 和自定义 IAuthorizationPolicy。当我将端点的绑定配置为使用基本身份验证时，一切都按我的意愿工作（自定义主体、自定义角色等）。

我还想添加匿名 HTTP 访问的能力，并让我的自定义实现将匿名用户置于一些默认角色等。（如果没有发送 Authenticate 标头）。

现在发生的情况是，在我的任何自定义代码被命中之前，匿名用户都会收到 401。如果我关闭 HTTP Basic 身份验证要求，则完全忽略 Authenticate 标头。

如何配置**或注入 Authenticate 标头**，以两种方式执行此操作（不创建 2 个单独的端点）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T16:57:35.353

[首先，服务根据规范](http://www.faqs.org/rfcs/rfc2617.html)正确响应匿名呼叫。

其次，这是不可能的。当您自托管您的服务并且您有一些 http 绑定时，WCF 将使用一个`[System.Net.HttpListener](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)`实例来响应 http 请求（在 中创建`System.ServiceModel.Channels.SharedHttpTransportManager.OnOpen`）。此侦听器有一个调用方法，该方法`HandleAuthentication`在调用任何自定义代码之前被调用。它负责发回带有质询的 401 响应（WWW-Authenticate）。您对此无能为力。如果有，我想知道。

所以你有以下选择：

*   两个端点
*   配置您的客户端以了解默认凭据
*   改变您的客户，以便他们能够应对挑战

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T04:04:55.270

我过去对此进行了研究，发现除非您创建 2 个单独的端点（这不是您想要的），否则无法通过配置进行。WCF 根本不支持它。

但是，WCF 是非常可定制的，您可以通过编写一个自定义通道/绑定来完成您想要的操作。我建议您查看**[REST Chess](http://www.restchess.com/)源代码**。它应该让你开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T18:53:58.377

您最好的选择是通过角色提供程序实现默认角色，并让匿名用户自动加入该角色。然后以编程方式或通过策略注入（面向方面​​）策略进行设置，以便通过特定角色允许某些匿名访问。

至于通过配置进行设置，如果可能的话，这将是相当困难的并且有点“hacky”。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-17T17:32:36.937

我不这么认为...当我决定再次阅读您的问题并注意到您问题的最后陈述时，我只是在写您需要创建单独的端点。所以答案是否定的（据我所知）

# c# - C# 或 Java 有 lambda 的原因是什么？

> ID：209804
> 
> 赞同：18
> 
> 时间：2008-10-16T18:56:11.103
> 
> 标签：c#, java, lambda

C# 或 java 有 lambda 的原因是什么？这两种语言都不是以它们为基础的，它似乎是另一种编码方法，可以完成与 C# 相同的事情。
我不是在对抗，如果有原因我想知道原因。出于全面披露的目的，我是一名具有 C++ 背景且没有 lisp 经验的 Java 程序员，我可能只是错过了重点。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-16T19:02:48.440

有一些常见的用例需要传递（或存储）一个稍后执行的代码块。最常见的是事件监听器。信不信由你，以下代码在 Java 中使用了 lambda-ish 结构：

```
JButton button = new JButton("Push me!");
button.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        System.out.println("Pressed!");
    }
}); 
```

匿名内部类充当 lambda，尽管它非常冗长。通过一点隐式转换魔法，我们可以在 Scala 中编写以下等价物：

```
val button = new JButton("Push me!")
button.addActionListener { e =>
  println("Pressed!")
} 
```

C# 使用委托和（甚至更好的）lambda 使这种事情变得相当容易。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-16T18:57:36.810

我认为 C# 中的 lambdas 是一种非常方便的代理方式。将代码放在使用它的地方更具可读性，而不必在其他地方搜索委托定义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T19:03:13.603

语法糖。

它提供了一种方便且更具可读性的方式来表示一个想法，在这种情况下是一种很小的一次性方法。在引擎盖下，编译器将其扩展为委托和方法调用，但它是在做这项工作的人，而不是你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T19:02:08.473

Lambda 允许您编写更少冗长、更具表现力的代码。例如，[列表推导](http://martinfowler.com/bliki/CollectionClosureMethod.html)...

顺便说一句，正在探索向 Java 添加闭包的可能性 - 同时有必要使用匿名类（丑陋）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T19:11:58.577

C# 并不追求纯粹的语言设计学派（与 Java 不同，Java 是由 Smalltalkers 设计为某种纯粹的 OO 语言）。C# 是面向所有人的，而且它非常擅长。C# 的基础是将各种编程风格中的精华汇集到一种高质量、得到良好支持的语言中。这包括程序、面向对象、功能、动态、逻辑等风格的编程。显然，到目前为止，它还没有太多动态或逻辑风格的编程方式，但这很快就会到来（动态编程随 C# 4.0 而来）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T19:29:51.910

在 C# 的情况下，内部使用 lambda 来实现 LINQ。请参阅文章[LINQ 的演变及其对 C# 设计的影响](http://msdn.microsoft.com/en-us/magazine/cc163400.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T23:34:12.323

Lambda 允许更易读的代码，因为它们允许在更接近使用点的地方定义操作，而不是像当前使用函数对象的 C++ 方法，其定义有时远离使用点。（这不包括一些 boost 库）。我认为 lambdas 的关键在于它们允许更简洁和易于理解的代码。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-05-31T20:46:14.930

通过在许多情况下暗示“最终”选项，它们使用 Java 中的多线程提供了更好的安全性。所以你在多任务处理中不容易出错。

# c# - 如何确定 .NET 代码是否在 ASP.NET 进程中运行？

> ID：209806
> 
> 赞同：16
> 
> 时间：2008-10-16T18:56:40.260
> 
> 标签：c#, .net, asp.net

我有一个通用类的实例，它将在 ASP.NET 和独立程序下执行。此代码对其运行的进程很敏感——也就是说，如果在 ASP.NET 下运行，则不应调用某些方法。如何确定代码是否在 ASP.NET 进程中执行？

我目前使用的解决方案在下面回答。

* * *

我希望有人能就为什么这个问题被否决和/或提出更好的提问方式发表评论！我只能假设至少有些人已经看过这个问题并说“真是个白痴，ASP.NET 代码就是 .NET 代码”。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T19:49:02.543

如果您使用异步方法，则 ASP.NET 中的 HttpContext.Current 也可以为 null，因为异步任务发生在不共享原始线程的 HttpContext 的新线程中。这可能是也可能不是您想要的，但如果不是，那么我相信 HttpRuntime.AppDomainAppId 在 ASP.NET 进程中的任何地方都将为非空，而在其他地方则为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-11T17:46:16.680

尝试这个：

```
using System.Web.Hosting;

// ...

if (HostingEnvironment.IsHosted)
{
    // You are in ASP.NET
}
else
{
    // You are in a standalone application
} 
```

为我工作！

有关详细信息，请参阅[HostingEnvironment.IsHosted](https://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.ishosted(v=vs.110).aspx) ...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T19:25:20.500

我认为你真正想做的是重新考虑你的设计。更好的方法是使用 Factory 类，该类根据应用程序的启动方式生成您需要的不同版本的类（旨在实现接口，以便您可以互换使用它们）。这将本地化代码以在一个地方检测基于 Web 和非基于 Web 的使用，而不是将其分散在您的代码中。

```
public interface IDoFunctions
{
    void DoSomething();
}

public static class FunctionFactory
{
  public static IDoFunctions GetFunctionInterface()
  {
     if (HttpContext.Current != null)
     {
        return new WebFunctionInterface();
     }
     else
     {
        return new NonWebFunctionInterface();
     }
   }
}

public IDoFunctions WebFunctionInterface
{
    public void DoSomething()
    {
        ... do something the web way ...
    }
}

public IDoFunctions NonWebFunctionInterface
{
    public void DoSomething()
    {
        ... do something the non-web way ...
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-09T10:46:53.323

```
using System.Diagnostics; 

if (Process.GetCurrentProcess().ProcessName == "w3wp")
    //ASP.NET 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-16T18:57:06.407

这是我对这个问题的回答。

首先，确保您的项目引用 System.Web 并且您的代码文件是“使用 System.Web；”。

```
public class SomeClass {

  public bool  RunningUnderAspNet    { get; private set; }

  public SomeClass()
    //
    // constructor
    //
  {
    try {
      RunningUnderAspNet = null != HttpContext.Current;
    }
    catch {
      RunningUnderAspNet = false;
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-16T19:09:24.603

```
If HttpContext Is Nothing OrElse HttpContext.Current Is Nothing Then
  'Not hosted by web server'
End If 
```

# java - 如何更改 Java 中的默认应用程序图标？

> ID：209812
> 
> 赞同：65
> 
> 时间：2008-10-16T18:58:37.200
> 
> 标签：java, icons

我正在使用 NetBeans，试图将熟悉的 Java 咖啡杯图标更改为我保存在 jar 文件的资源目录中的 png 文件。我发现许多不同的网页声称他们有解决方案，但到目前为止它们都不起作用。

这是我目前所拥有的（省略了 try-catch 块）：

```
URL url = new URL("com/xyz/resources/camera.png");
Toolkit kit = Toolkit.getDefaultToolkit();
Image img = kit.createImage(url);
getFrame().setIconImage(img); 
```

包含此代码的类位于**com.xyz**包中，如果这有什么不同的话。该类还扩展了 JFrame。此代码在第一行引发 MalformedUrlException。

有人有有效的解决方案吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-16T19:01:24.370

```
java.net.URL url = ClassLoader.getSystemResource("com/xyz/resources/camera.png"); 
```

可能需要也可能不需要路径前面的“/”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-16T09:41:28.170

您可以简单地转到 Netbeans，在设计视图中，转到`JFrame`属性，选择图标图像属性，`iconImage`使用“自定义代码”选择设置表单的属性，然后在`Form.SetIconImage()`函数中输入以下代码：

```
Toolkit.getDefaultToolkit().getImage(name_of_your_JFrame.class.getResource("image.png")) 
```

不要忘记导入：

```
import java.awt.Toolkit; 
```

在源代码中！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T20:37:30.090

或者将图像放置在相对于类的位置，并且您不需要字符串本身中的所有包/路径信息。

```
com.xyz.SomeClassInThisPackage.class.getResource( "resources/camera.png" ); 
```

这样，如果您将类移动到不同的包中，则不必查找所有字符串，只需移动类及其资源目录即可。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-19T18:46:44.197

试试这个写后

```
initcomponents();

setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("Your image address"))); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-24T01:05:45.803

```
 /** Creates new form Java Program1*/
    public Java Program1() 

    Image im = null;
    try {
    im = ImageIO.read(getClass().getResource("/image location"));
    } catch (IOException ex) {
    Logger.getLogger(chat.class.getName()).log(Level.SEVERE, null, ex);
    }
    setIconImage(im); 
```

这是我在 netbeans 的 GUI 中使用的，它工作得很好

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-09-21T00:58:44.540

在扩展`javax.swing.JFrame`使用方法的类中`setIconImage`。

```
this.setIconImage(new ImageIcon(getClass().getResource("/resource/icon.png")).getImage()); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-07-24T00:48:46.133

您应该定义各种大小的图标，Windows 和 Linux 发行版（如 Ubuntu）在任务栏和 Alt-Tab 中使用不同的图标。

```
public static final URL ICON16 = HelperUi.class.getResource("/com/jsql/view/swing/resources/images/software/bug16.png");
public static final URL ICON32 = HelperUi.class.getResource("/com/jsql/view/swing/resources/images/software/bug32.png");
public static final URL ICON96 = HelperUi.class.getResource("/com/jsql/view/swing/resources/images/software/bug96.png");

List<Image> images = new ArrayList<>();
try {
    images.add(ImageIO.read(HelperUi.ICON96));
    images.add(ImageIO.read(HelperUi.ICON32));
    images.add(ImageIO.read(HelperUi.ICON16));
} catch (IOException e) {
    LOGGER.error(e, e);
}

// Define a small and large app icon
this.setIconImages(images); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-01-26T01:23:24.397

你可以试试**这个**，效果很好：

```
`   ImageIcon icon = new ImageIcon(".//Ressources//User_50.png");
    this.setIconImage(icon.getImage());` 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-21T18:32:24.467

内部框架构造函数

```
try{    
       setIconImage(ImageIO.read(new File("./images/icon.png")));   
   }
catch (Exception ex){
       //do something
   } 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-09-26T09:01:45.883

例子：

```
URL imageURL = this.getClass().getClassLoader().getResource("Gui/icon/report-go-icon.png");
ImageIcon iChing = new ImageIcon("C:\\Users\\RrezartP\\Documents\\NetBeansProjects\\Inventari\\src\\Gui\\icon\\report-go-icon.png");      
btnReport.setIcon(iChing); 
System.out.println(imageURL); 
```

# language-agnostic - 游戏开发和业务开发有什么区别？

> ID：209818
> 
> 赞同：14
> 
> 时间：2008-10-16T19:00:39.520
> 
> 标签：language-agnostic

像大多数开发人员一样，我是一名业务开发人员，其本质上是在一些后端数据存储上添加一个 UI。（我们都知道它的意义远不止于此，但这通常归结为它。）

我知道游戏开发与商业开发有很大不同，但我很难向我的朋友解释。我希望 SO 社区可以在这里帮助我。

对我来说，现代游戏开发人员在处理 3 维图形方面做了很多工作。在游戏代码中（我猜这里），你正在组装多边形（或类似的东西），旋转它们等。这涉及到与操作关系数据（例如）不同的思维方式。我不知道，真的。我只知道不一样。

**编辑：**

我应该强调，“开发”是指“编程”，而不是创建游戏或商业软件的所有方面。对不起，我最初没有说清楚。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T19:12:47.937

我从事游戏开发，但很久以前就从事业务开发。如果您从事物理或图形方面的工作，游戏开发在数学方面非常严格。即使是人工智能也可能需要相当多的数学来处理低级的东西。就在屏幕上绘图而言，硬件通常会处理很多多边形操作数学。使用（通常）许多在预处理步骤中运行的工具生成游戏内数据也有很多参与，如果您要生成可见性数据，这也可能是数学密集型的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-16T19:26:11.030

In terms of programming domains, amongst other things, we deal with:

*   Graphics programming (including shader development)
*   Animation
*   Physics simulation
*   AI and gameplay
*   Audio
*   Networking (typically fairly low-level stuff)

Some of these involve pretty serious maths and algorithms knowledge. On top of all that, we face extremely tough speed constraints, and typically have to be very careful with memory usage too. We face constantly changing hardware, and since we're trying to push hardware to the limit, this can be pretty tough - you can't just abstract it away. Most game development is still quite low-level C++ work. We probably deal with databases less than most other programmers nowadays (although online games are changing this)!

Programmers are often the minority on modern game projects: it's all about content creation (animation, modelling, texturing, audio and design). This means many game programmers are dedicated to making the content creation process efficient, rather than working on the game code itself. This work may have more relaxed speed and memory constraints, although it does have to deal with massive data sets.

Making the game 'fun' is one of the hardest things to do - in business terminology, it "means extremely unstable requirements" as the designers constantly change their mind about how things should work, to chase down that elusive fun factor.

Finally, games are generally a ship-once, no chance to fix stuff kind of deal. This actually means there's very little code maintenance involved, so traditionally there may have been less attention paid to code quality issues. This is changing now with the growth in post-launch content addition, online gaming and the sheer size of modern projects.

Overall it's an incredibly exciting field to be in, the downside is that it's often less well paid (because it's a very tough business financially for developers, and because it's popular, there's always a fresh supply of people looking for jobs).

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-16T19:30:29.803

Just some random thoughts about what is different in game development. Note that there might be some sarcasm in it, though I tried to suppress the urge.

*   Unless you're a lucky employee of one of those new-style studios (like Eidos Montreal or Blizzard), there is always a deadline to fear that is much too short. In business programming, you mostly make the deadline up for yourself.
*   A business application serves some specific need. A game's intent is to entertain people. You can't really predict if a game will fail until it's out.
*   Performance is essential, in every aspect of the game. Writing code that is good to maintain is second priority. In business programming, good code that works is top priority.
*   For a business application, a shiny UI is a bonus. For a game, it is a must.
*   Debugging games is much harder, because there is always some hardware dependence which results in bugs that can only be reproduced on some machines, none of which is in your company. And a game sucks up much more performance than a typical business application.
*   You have people dedicated to creating the art, story, music, sound, background and design, none of which necessarily needs programming knowledge (scripting is a little different), i.e. you have a lot of content which is what the users (players) will see. Nobody cares about how good your code is, unless performance is bad or there are bugs. The others get the praise.
*   For larger games, you have programmers dedicated just to 3D graphics, networking, audio, tools, scripting, physics and so on. Most of them are highly specialized and each of them can lead the game into a disaster. You'll only need advanced math skills if you're the graphics or physics guy. Well, or AI.
*   Most games are fire-and-forget, apart from some bugfixes, unless it's one of the more successful games, which get an expansion pack or a sequel.
*   Security is an important issue for online games, since there are much more annoying people trying to to put people off than there are for business applications, many of which are for (more or less) internal uses at the customer.
*   You are expected to work much more than when writing business applications.
*   To land a job for an AAA title, you need to have worked on at least three shipped AAA titles (no, no typo here, ever read some job descriptions at Blizzard or LucasArts? :P)

But here come the good things:

*   You can pretend to work when you're playing games.
*   And finally, programming games is fun. Priceless.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-16T20:38:57.030

Business development is generally much more forgiving.

The reason is basically this; usually, people ARE PAID to use business software. People PAY to use game software.

This may sound like it's not answering your question, but it really is. When my boss says "use microsoft word for that document", they're providing the software, and I'm obligated to use micosoft word. And so, when using it, when it decides to renumber all my chapter headings "just because" or a save to disk takes 30 seconds while it resolves OLE references (it's JUST ONE FREAKING EXCEL SPREADSHEET, for heaven's sake!), I just grit my teeth and remind myself I'm getting paid to do this.

Whereas, if I'm in a game, I'm expecting entertainment. I'm expecting the experience to work properly, and smoothly, and cleanly, with no major stutters or problems.

Again, getting down to why this is an issue for programming; those loops and structures in the game had better be DAMN good to make sure there is no major slowdown, no stuttering in the game engine, nothing that makes the consumer who just spent X amount of his hard-earned dollars say "this is a piece of crap" and walk away. With business software, you can get away with that sort of thing; in some ways, it's almost expected. Again, look at the performance of Microsoft Word; if it were a game, it would be laughed out of existence.

I know I sound like I'm picking on Microsoft Word, and I generally am, because I find it to be hideous, but the point is true for so many pieces of software. CAD software is another example. Same basic things going on as in games, but in general it's slow and hard to work with without a lot of training.

The difference comes down to polish, and the level of polish that's expected. Yes, there's generally more flexibility in business software than there is in games; but moreover and more importantly from a coding perspective, the code has GOT to work efficiently and cleanly in a game; business software is, generally, more forgiving of sloppy code.

In a business app, unoptimized and slow algorithms are generally accepted; and while they're never preferable, frequently the business decision gets made to add another feature instead of improving the performance. But in games, performance IS a feature, and one which is make-or-break.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-16T19:08:36.103

业务开发和游戏开发之间的一大区别是所涉及的学科数量。大多数商业软件是由一组开发人员创建的，他们都具有相同的基本技能。相比之下，游戏是由游戏设计师、视觉艺术家、3d 建模师、动画师、音乐家和开发人员组成的团队创建的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-16T19:11:59.777

一个应该有无限循环，一个不应该。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-16T19:46:25.030

> One should have infinite loops, one shouldn't. - Rich Bradshaw

Rich is right. Fundamentally, from a coding standpoint, a game loop creates a "frame" of action in which actions are taken based on the state of the game such as controller input, object collisions, etc. This loop repeats infinitely until some state of some game element or input tells it to stop or "quit." This approach keeps the CPU and graphics card pretty busy, hence the market for gamer machines with fast processors and even faster graphics cards.

Business applications do not have an active loop. Instead, they sit idle waiting for an event such as a click, a message from a web service client, an HTTP GET request, etc. Then they respond to the event.

Sure, gaming is generally more geometrically intensive than business applications, but that is not entirely true. Consider image editing, CAD and graphics tools. For many, these are business applications. But for the most part, a business application has to do with querying data, displaying that data, accepting user input, and modifying the data based on user input. In many cases, the business application does this across the network or even the Internet, but it's an apt nutshell.

The skillset and mindset of a business application developer and the game developer is often different. The game developer has a limited number of input constructs to consider in terms of creating a user experience with an unlimited choice of context or "world" if you will. The business developer is the opposite, with a limited set of potential contexts, usually the web page or the basic window, and an unlimited (or nearly so) set of input and data display combinations to create a user experience entirely different than the game developer sets out to achieve.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-16T19:22:59.333

关于数学以及团队中艺术家和其他专家的整合的优点。另外，我想说：

*   Game development, to some extend, will be more hardware dependent. In many cases, games are built simultaneously to several platforms and consoles (not to mention cellphones), with different architectures. That is abstracted up to a certain extent, but developers cannot completely avoid this fact.

*   Game development is often more performance sensitive, or at least the performance requirements are different. You're dealing with real-time experience, so a lot of time is spent optimizing those pesky fps.

*   In many cases, game development does not care as much about reuse and maintainability. The game engine will probably be reused, but the application code base will probably not live to see v2.0\. In the last stretch of a project, there is a lot of quick and dirty debugging going on. If it looks fine to the end user, there's no added value in making an elegant fix two days before the release.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-16T19:42:00.217

Let's start from the goal - the goal of game development is to create entertaining product. It should be accurate to the extend that it looks good and runs smoothly. The goal of a business software solution is to model a work process. It should be a tool which works fast enough. A stable product, which executes absolutely accurately and secure the tasks it should do.

Since we target different goals, we use different approaches to build a game and a business software. Let's move to the requirements. For a game, the requirements are determined by the game designer. For a software product the business defines the process and the requirements. For a game the requirements are not final - shall we have small cartoon figures or real human models - this does not matter for the game engine for example. But for a software product, the requirements should be strictly followed and cleared to the maximum possible detail before development.

From the different requirements come different software design and development approach. For a game the performance and gameplay are critical and the qualiity of the graphics and sounds (for example) could be reduced just to be compatible with weaker hardware. Also the physical model could be simplified just to run smoother and improve the gameplay. For the business software everything should be exact and cutting features means that your product will not be as functional as designed anymore.

For a game, the security is not important - there is no critical customer data which should be saved. For a business software a good security system should be supplied - starting from data encryption (while saving on data storage or transferring through network) moving through backup system and mentioning (but not last) the compatibility with previous versions.

I could continue with other aspects but I guess this is already too much for one post...

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-16T20:33:30.377

Business software (that isn't shrink-wrap software) can generally be much more poorly written but still considered a commercial success due to the bizarre disconnect between the quality of the product and saleability of the product. Game software, on the other hand, has to actually be **good** to survive the marketplace.

The bar for quality in specialized business software is *generally* much lower.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-16T19:35:42.180

Business software has to be reliable, maintainable, consistent, not be too annoyingly slow, and can build on lots of already written stuff, such as databases, controls, forms etc.

A games programmer often starts with a blank sheet - hardware reference manuals, some documentation about the hardware and usually thin vendor libraries around some advanced hardware that's completely different to the last job.

From this they have to build what you see - and make most of it work within a 20ms time period, reliably, and often within a ridiculously short time period, facing changing requirements and often a very hard deadline, working untold numbers of hours for a comparative pittance.

That's not to mention often having to master some fairly complex mathematics and physics....

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-16T19:40:34.633

Performance is really the difference, from what I can tell.

Technologywise, games are usually Windows/C++ driven.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-16T19:48:17.427

Game programming has more in common with scientific programming. You are modeling behavioral systems and anticipating results based upon a limited set of input.

# algorithm - 根据结果 销售订购“标语”活动的算法

> ID：209820
> 
> 赞同：0
> 
> 时间：2008-10-16T19:01:05.120
> 
> 标签：algorithm, statistics

我希望能够将新的“标签行”引入数据库中，这些“标签行”会“随机”显示给用户。（这些标语行显示为动画文本的介绍。）

根据这些标语产生的销售数量，我希望好的标语能够逐渐上升到顶部，但仍然不那么频繁地显示其他标语。

我可以很容易地想出一个基本算法，但我想要一些更“统计准确”的东西。

我真的不知道从哪里开始。自从我做了比基本统计更多的事情以来已经有一段时间了。我的模型需要对公差敏感，但显然它不需要值得 PHD。

**编辑：**我目前正在跟踪“转化率”——即每个订单的点击量。最好将此值计算为要输入算法的累积“所有时间”转换率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T15:08:23.340

看看你的问题，我会稍微修改一下要求 -

1）最受欢迎的应该最常显示。2) 标语应该“过时”，因此过去获得了很多选票（购买），但最近没有出现的应该不那么频繁地显示 3) 全新的标语应该在第一天更频繁地显示。

如果您同意这些，那么算法可能类似于：

```
START:
x = random(1, 3); 
if x = 3 goto NEW else goto NORMAL

NEW:
TagVec = Taglines.filterYounger(5 days); // I'm taking a LOT of liberties with the pseudo code,,,
x = random(1, TagVec.Length);
return tagVec[x-1]; // 0 indexed vectors even in made up language,

NORMAL:
// Similar to EBGREEN above
sum = 0;
ForEach(TagLine in TagLines) {
   sum += TagLine.noOfPurhcases;
}
x = random(1, sum);
ForEach(TagLine in TagLines) {
   x -= TagLine.noOfPurchase;
   if ( x > 0) return TagLine; // Find the TagLine that represent our random number
} 
```

现在，作为一种设置，我会给每条新的标语购买 10 次，以避免一次购买变得非常倾斜。

老化过程我会将一周以上的购买视为每周购买 0.8 件。所以 1 周大给 0.8 分，2 周给 0.8*0.8 = 0,64 等等......

您必须使用 Initial purhcases 参数（在我的示例中为 10）和老化速度（此处为 1 周）和老化因子（此处为 0.8）来找到适合您的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T03:59:53.313

这是javascript中的一个示例。并不是说我不建议运行这个客户端......还有很多可以做的优化。

注意：此处实现 createMemberInNormalDistribution()[将均匀分布转换为正态分布](https://stackoverflow.com/questions/75677/converting-a-uniform-distribution-to-a-normal-distribution#196941)

```
/*
 * an example set of taglines
 * hits are sales
 * views are times its been shown
 */
var taglines = [
    {"tag":"tagline 1","hits":1,"views":234},
    {"tag":"tagline 2","hits":5,"views":566},
    {"tag":"tagline 3","hits":3,"views":421},
    {"tag":"tagline 4","hits":1,"views":120},   
    {"tag":"tagline 5","hits":7,"views":200}
];

/*set up our stat model for the tags*/
var TagModel = function(set){ 
    var  hits, views, sumOfDiff, sumOfSqDiff; 
    hits = views = sumOfDiff = sumOfSqDiff = 0;
    /*find average*/
    for (n in set){
        hits += set[n].hits;
        views += set[n].views;  
    }
    this.avg = hits/views;
    /*find standard deviation and variance*/
    for (n in set){
        var diff =((set[n].hits/set[n].views)-this.avg);
        sumOfDiff += diff;
        sumOfSqDiff += diff*diff;   
    }
    this.variance = sumOfDiff;
    this.std_dev = Math.sqrt(sumOfSqDiff/set.length);
    /*return tag to use fChooser determines likelyhood of tag*/
    this.getTag = function(fChooser){
        var m = this;
        set.sort(function(a,b){
                return fChooser((a.hits/a.views),(b.hits/b.views), m);
            });
        return set[0];
    };
};

var config = {

    "uniformDistribution":function(a,b,model){
        return Math.random()*b-Math.random()*a;
    },
    "normalDistribution":function(a,b,model){
        var a1 = createMemberInNormalDistribution(model.avg,model.std_dev)* a;
        var b1 = createMemberInNormalDistribution(model.avg,model.std_dev)* b;
        return b1-a1;
    },
    //say weight = 10^n... higher n is the more even the distribution will be.
    "weight": .5,
    "weightedDistribution":function(a,b,model){
        var a1 = createMemberInNormalDistribution(model.avg,model.std_dev*config.weight)* a;
        var b1 = createMemberInNormalDistribution(model.avg,model.std_dev*config.weight)* b;
        return b1-a1;
    }
}

var model = new TagModel(taglines);

//to use
model.getTag(config.uniformDistribution).tag;
//running 10000 times: ({'tagline 4':836, 'tagline 5':7608, 'tagline 1':100, 'tagline 2':924, 'tagline 3':532})

model.getTag(config.normalDistribution).tag;
//running 10000 times: ({'tagline 4':1775, 'tagline 5':3471, 'tagline 1':1273, 'tagline 2':1857, 'tagline 3':1624})

model.getTag(config.weightedDistribution).tag;
//running 10000 times: ({'tagline 4':1514, 'tagline 5':5045, 'tagline 1':577, 'tagline 2':1627, 'tagline 3':1237})

config.weight = 2;
model.getTag(config.weightedDistribution).tag;
//running 10000 times: {'tagline 4':1941, 'tagline 5':2715, 'tagline 1':1559, 'tagline 2':1957, 'tagline 3':1828}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T20:09:56.353

你必须想出一个基于销售额的加权公式。

我不认为这里有任何“统计上准确”的公式——这完全取决于你的偏好。

没有人可以说“这是正确的权重，而另一个权重是错误的”，因为没有你试图模拟的最终结果——这不像试图权衡对即将举行的选举的民意调查的反应（你正在尝试对结果进行建模以表示将来会发生的事情）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T19:09:27.927

我建议根据以前的销售情况随机选择一个加权因子。所以假设你有这个：

*   tag1 = 1 次销售
*   tag2 = 0 销售额
*   tag3 = 1 次销售
*   tag4 = 2 个销售额
*   tag5 = 3 次销售

一个简单的加权公式是 1 + 销售额，所以这就是选择每个标签的概率：

*   标签1 = 2/12 = 16.7%
*   标记2 = 1/12 = 8.3%
*   标签3 = 2/12 = 16.6%
*   标签4 = 3/12 = 25%
*   标签5 = 4/12 = 33.3%

您可以轻松更改加权公式以获得您想要的分布。

# c# - 通过 AJAX 使用页面方法/Web 服务进行 ASP.NET 本地化

> ID：209831
> 
> 赞同：1
> 
> 时间：2008-10-16T19:03:17.610
> 
> 标签：c#, .net, asp.net, ajax, localization

那是一口...

这是问题所在，我们正在通过 AJAX 调用页面方法（本质上是 Web 服务）进行一些客户端验证。我们还在页面上添加了一个下拉菜单来选择您的语言，并创建了一个继承自 Page 的类，该类根据下拉选择初始化本地化。但是，当通过 AJAX 调用页面方法时，页面不会正常实例化，因此本地化的初始化不会发生。

我已经考虑将语言选择保存到会话中，但这并不能解决问题，因为每个页面方法都必须重新初始化本地化才能加载正确的语言文件。关于如何处理页面方法或 Web 服务中的动态本地化的任何想法？

这是我们第一次涉足本地化，所以我希望我遗漏了一些明显的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T01:13:10.970

我不确定您为什么会遇到这个问题，但一个简单的解决方案是简单地将 ajax 调用中的语言环境传递给页面方法或 Web 服务。

我在我的应用程序中所做的是使用语言环境设置一个 cookie。我在自动完成 Web 服务中所做的只是从我的所有公共 Web 服务方法中调用以下代码行： LavaBlastBasePage.SetCultureFromCookie();

然而，这类似于使用会话。

# python - 如何将两个列表转换为字典？

> ID：209840
> 
> 赞同：1554
> 
> 时间：2008-10-16T19:05:47.233
> 
> 标签：python, list, dictionary, type-conversion

想象一下，您有以下列表。

```
keys = ['name', 'age', 'food']
values = ['Monty', 42, 'spam'] 
```

生成以下字典的最简单方法是什么？

```
a_dict = {'name': 'Monty', 'age': 42, 'food': 'spam'} 
```

* * *

## 回答 #1

> 赞同：2628
> 
> 时间：2008-10-16T19:09:05.400

像这样：

```
keys = ['a', 'b', 'c']
values = [1, 2, 3]
dictionary = dict(zip(keys, values))
print(dictionary) # {'a': 1, 'b': 2, 'c': 3} 
```

瞧 :-) 成对的[`dict`](https://docs.python.org/3/library/functions.html#func-dict)构造函数和[`zip`](https://docs.python.org/3/library/functions.html#zip)函数非常有用。

* * *

## 回答 #2

> 赞同：196
> 
> 时间：2015-11-16T13:54:24.427

> 想象一下，你有：
> 
> ```
> keys = ('name', 'age', 'food')
> values = ('Monty', 42, 'spam') 
> ```
> 
> **生成以下字典的最简单方法是什么？**
> 
> ```
> dict = {'name' : 'Monty', 'age' : 42, 'food' : 'spam'} 
> ```

## 性能最高的`dict`构造函数`zip`

```
new_dict = dict(zip(keys, values)) 
```

在 Python 3 中， zip 现在返回一个惰性迭代器，这是现在性能最高的方法。

`dict(zip(keys, values))``dict`确实需要对和进行一次全局查找`zip`，但它不会形成任何不必要的中间数据结构，也不必处理函数应用程序中的本地查找。

## 亚军，听写理解：

使用 dict 构造函数的一个接近的亚军是使用 dict 推导式的本机语法（不是*列表*推导式，因为其他人错误地把它）：

```
new_dict = {k: v for k, v in zip(keys, values)} 
```

当您需要根据键或值进行映射或过滤时选择此项。

在 Python 2 中，`zip`返回一个列表，为避免创建不必要的列表，请`izip`改为使用（别名为 zip 可以在您迁移到 Python 3 时减少代码更改）。

```
from itertools import izip as zip 
```

所以仍然是（2.7）：

```
new_dict = {k: v for k, v in zip(keys, values)} 
```

## Python 2，适用于 <= 2.6

`izip`from在 Python 3中`itertools`变得比 zip 更好（因为它避免了不必要的列表创建），并且非常适合 2.6 或更低版本：`zip``izip`

```
from itertools import izip
new_dict = dict(izip(keys, values)) 
```

## 所有情况的结果：

在所有情况下：

```
>>> new_dict
{'age': 42, 'name': 'Monty', 'food': 'spam'} 
```

## 解释：

如果我们查看帮助，`dict`我们会发现它需要多种形式的参数：

```
 >>> help(dict)

class dict(object)
 |  dict() -> new empty dictionary
 |  dict(mapping) -> new dictionary initialized from a mapping object's
 |      (key, value) pairs
 |  dict(iterable) -> new dictionary initialized as if via:
 |      d = {}
 |      for k, v in iterable:
 |          d[k] = v
 |  dict(**kwargs) -> new dictionary initialized with the name=value pairs
 |      in the keyword argument list.  For example:  dict(one=1, two=2) 
```

最佳方法是使用可迭代对象，同时避免创建不必要的数据结构。在 Python 2 中， zip 创建了一个不必要的列表：

```
>>> zip(keys, values)
[('name', 'Monty'), ('age', 42), ('food', 'spam')] 
```

在 Python 3 中，等价于：

```
>>> list(zip(keys, values))
[('name', 'Monty'), ('age', 42), ('food', 'spam')] 
```

而 Python 3`zip`仅仅创建了一个可迭代对象：

```
>>> zip(keys, values)
<zip object at 0x7f0e2ad029c8> 
```

由于我们希望避免创建不必要的数据结构，我们通常希望避免使用 Python 2 `zip`（因为它会创建不必要的列表）。

## 性能较差的替代方案：

这是传递给 dict 构造函数的生成器表达式：

```
generator_expression = ((k, v) for k, v in zip(keys, values))
dict(generator_expression) 
```

或等效地：

```
dict((k, v) for k, v in zip(keys, values)) 
```

这是传递给 dict 构造函数的列表推导：

```
dict([(k, v) for k, v in zip(keys, values)]) 
```

在前两种情况下，在 zip 迭代上放置了额外的非操作（因此不必要的）计算层，在列表推导的情况下，不必要地创建了额外的列表。我希望他们所有人的性能都会降低，当然也不会更差。

## 性能评估：

在 Nix 提供的 64 位 Python 3.8.2 中，在 Ubuntu 16.04 上，从最快到最慢排序：

```
>>> min(timeit.repeat(lambda: dict(zip(keys, values))))
0.6695233230129816
>>> min(timeit.repeat(lambda: {k: v for k, v in zip(keys, values)}))
0.6941362579818815
>>> min(timeit.repeat(lambda: {keys[i]: values[i] for i in range(len(keys))}))
0.8782548159942962
>>> 
>>> min(timeit.repeat(lambda: dict([(k, v) for k, v in zip(keys, values)])))
1.077607496001292
>>> min(timeit.repeat(lambda: dict((k, v) for k, v in zip(keys, values))))
1.1840861019445583 
```

`dict(zip(keys, values))`即使使用较小的键和值集也会获胜，但是对于较大的集，性能差异会变得更大。

一位评论者说：

> `min`似乎是比较性能的不好方法。对于实际使用，肯定`mean`和/或`max`将是更有用的指标。

我们使用`min`这些算法是因为这些算法是确定性的。我们想知道算法在可能的最佳条件下的性能。

如果操作系统因任何原因挂起，这与我们要比较的内容无关，因此我们需要从分析中排除这些结果。

如果我们使用`mean`，这些事件会极大地扭曲我们的结果，如果我们使用，`max`我们只会得到最极端的结果——最有可能受到此类事件影响的结果。

一位评论者还说：

> 在 python 3.6.8 中，使用平均值，dict 理解确实更快，对于这些小列表大约快 30%。对于较大的列表（10k 个随机数），`dict`调用速度大约快 10%。

我想我们的意思是`dict(zip(...`10k 随机数。这听起来确实是一个相当不寻常的用例。最直接的调用将在大型数据集中占主导地位确实是有道理的，如果操作系统挂起占主导地位，我不会感到惊讶，因为运行该测试需要多长时间，从而进一步扭曲您的数字。如果你使用`mean`or`max`我会认为你的结果毫无意义。

让我们在上面的例子中使用更真实的尺寸：

```
import numpy
import timeit
l1 = list(numpy.random.random(100))
l2 = list(numpy.random.random(100)) 
```

我们在这里看到，`dict(zip(...`对于更大的数据集，它确实运行得更快了大约 20%。

```
>>> min(timeit.repeat(lambda: {k: v for k, v in zip(l1, l2)}))
9.698965263989521
>>> min(timeit.repeat(lambda: dict(zip(l1, l2))))
7.9965161079890095 
```

* * *

## 回答 #3

> 赞同：134
> 
> 时间：2008-10-16T19:16:02.377

试试这个：

```
>>> import itertools
>>> keys = ('name', 'age', 'food')
>>> values = ('Monty', 42, 'spam')
>>> adict = dict(itertools.izip(keys,values))
>>> adict
{'food': 'spam', 'age': 42, 'name': 'Monty'} 
```

在 Python 2 中，与`zip`.

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-10-16T19:09:18.393

```
>>> keys = ('name', 'age', 'food')
>>> values = ('Monty', 42, 'spam')
>>> dict(zip(keys, values))
{'food': 'spam', 'age': 42, 'name': 'Monty'} 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2012-06-10T20:03:34.183

您还可以在 Python ≥ 2.7 中使用字典推导：

```
>>> keys = ('name', 'age', 'food')
>>> values = ('Monty', 42, 'spam')
>>> {k: v for k, v in zip(keys, values)}
{'food': 'spam', 'age': 42, 'name': 'Monty'} 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2015-11-16T05:03:26.593

更自然的方法是使用字典理解

```
keys = ('name', 'age', 'food')
values = ('Monty', 42, 'spam')    
dict = {keys[i]: values[i] for i in range(len(keys))} 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2008-10-16T20:45:04.240

如果您需要在创建字典之前转换键或值，则可以使用[生成器表达式。](http://docs.python.org/ref/genexpr.html)例子：

```
>>> adict = dict((str(k), v) for k, v in zip(['a', 1, 'b'], [2, 'c', 3])) 
```

看看[Code Like a Pythonista：Idiomatic Python](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2013-05-25T13:47:03.623

使用 Python 3.x，适用于 dict 理解

```
keys = ('name', 'age', 'food')
values = ('Monty', 42, 'spam')

dic = {k:v for k,v in zip(keys, values)}

print(dic) 
```

更多关于[dict理解here](http://www.python.org/dev/peps/pep-0274/)，一个例子是：

```
>>> print {i : chr(65+i) for i in range(4)}
    {0 : 'A', 1 : 'B', 2 : 'C', 3 : 'D'} 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-03-29T19:13:45.220

对于那些需要简单代码但不熟悉的人`zip`：

```
List1 = ['This', 'is', 'a', 'list']
List2 = ['Put', 'this', 'into', 'dictionary'] 
```

这可以通过一行代码完成：

```
d = {List1[n]: List2[n] for n in range(len(List1))} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-11-16T13:36:39.547

您可以使用以下代码：

```
dict(zip(['name', 'age', 'food'], ['Monty', 42, 'spam'])) 
```

但请确保列表的长度相同。如果长度不同。则 zip 函数将较长的列表转换。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-04-18T02:41:00.477

*   2018-04-18

最好的解决方案仍然是：

```
In [92]: keys = ('name', 'age', 'food')
...: values = ('Monty', 42, 'spam')
...: 

In [93]: dt = dict(zip(keys, values))
In [94]: dt
Out[94]: {'age': 42, 'food': 'spam', 'name': 'Monty'} 
```

转置它：

```
 lst = [('name', 'Monty'), ('age', 42), ('food', 'spam')]
    keys, values = zip(*lst)
    In [101]: keys
    Out[101]: ('name', 'age', 'food')
    In [102]: values
    Out[102]: ('Monty', 42, 'spam') 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-02-20T12:25:19.300

这也是在您的字典中添加列表值的示例

```
list1 = ["Name", "Surname", "Age"]
list2 = [["Cyd", "JEDD", "JESS"], ["DEY", "AUDIJE", "PONGARON"], [21, 32, 47]]
dic = dict(zip(list1, list2))
print(dic) 
```

始终确保您的“密钥”（list1）始终位于第一个参数中。

```
{'Name': ['Cyd', 'JEDD', 'JESS'], 'Surname': ['DEY', 'AUDIJE', 'PONGARON'], 'Age': [21, 32, 47]} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-07-20T10:01:28.240

当我试图解决与图形相关的问题时，我有这个疑问。我遇到的问题是我需要定义一个空的邻接列表并想用一个空列表初始化所有节点，这就是我想如何检查它是否足够快的时候，我的意思是是否值得进行 zip 操作而不是简单的赋值键值对。毕竟大多数时候，时间因素是一个重要的破冰者。所以我对这两种方法都执行了 timeit 操作。

```
import timeit
def dictionary_creation(n_nodes):
    dummy_dict = dict()
    for node in range(n_nodes):
        dummy_dict[node] = []
    return dummy_dict

def dictionary_creation_1(n_nodes):
    keys = list(range(n_nodes))
    values = [[] for i in range(n_nodes)]
    graph = dict(zip(keys, values))
    return graph

def wrapper(func, *args, **kwargs):
    def wrapped():
        return func(*args, **kwargs)
    return wrapped

iteration = wrapper(dictionary_creation, n_nodes)
shorthand = wrapper(dictionary_creation_1, n_nodes)

for trail in range(1, 8):
    print(f'Itertion: {timeit.timeit(iteration, number=trails)}\nShorthand: {timeit.timeit(shorthand, number=trails)}') 
```

对于 n_nodes = 10,000,000 我得到，

迭代：2.825081646999024 简写：3.535717916001886

迭代：5.051560923002398 简写：6.255070794999483

迭代：6.52859034499852 简写：8.221581164998497

迭代：8.683652416999394 简写：12.599181543999293

迭代：11.587241565001023 简写：15.27298851100204

迭代：14.816342867001367 简写：17.162912737003353

迭代：16.645022411001264 简写：19.976680120998935

您可以清楚地看到，在某个点之后，第 n_th 步的迭代方法超过了 n-1_th 步的速记方法所花费的时间。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-04T19:58:59.200

**使用枚举作为字典理解的解决方案：**

```
dict = {item : values[index] for index, item in enumerate(keys)} 
```

**使用枚举的 for 循环解决方案：**

```
dict = {}
for index, item in enumerate(keys):
    dict[item] = values[index] 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2020-12-16T14:25:17.417

如果您正在使用一组以上的值并希望拥有一个*dicts 列表，*您可以使用它：

```
def as_dict_list(data: list, columns: list):
    return [dict((zip(columns, row))) for row in data] 
```

现实生活中的示例是来自 db 查询的元组列表与来自同一查询的列元组配对。其他答案仅提供 1 对 1。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-03-04T11:23:54.137

```
keys = ['name', 'age', 'food']
values = ['Monty', 42, 'spam']
dic = {}
c = 0
for i in keys:
    dic[i] = values[c]
    c += 1

print(dic)
{'name': 'Monty', 'age': 42, 'food': 'spam'} 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2017-05-24T05:47:22.937

没有zip功能的方法

```
l1 = [1,2,3,4,5]
l2 = ['a','b','c','d','e']
d1 = {}
for l1_ in l1:
    for l2_ in l2:
        d1[l1_] = l2_
        l2.remove(l2_)
        break  

print (d1)

{1: 'd', 2: 'b', 3: 'e', 4: 'a', 5: 'c'} 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2020-08-28T03:08:42.133

尽管有多种方法可以做到这一点，但我认为最根本的方法是；****创建一个循环和字典并​​将值存储到该字典****中。在递归方法中，想法仍然相同，但不是使用循环，而是函数调用自身，直到它到达末尾。当然还有其他方法，例如 using`dict(zip(key, value))`等。*这些都不是最有效的解决方案。*

```
y = [1,2,3,4]
x = ["a","b","c","d"]

# This below is a brute force method
obj = {}
for i in range(len(y)):
    obj[y[i]] = x[i]
print(obj)

# Recursive approach 
obj = {}
def map_two_lists(a,b,j=0):
    if j < len(a):
        obj[b[j]] = a[j]
        j +=1
        map_two_lists(a, b, j)
        return obj

res = map_two_lists(x,y)
print(res) 
```

两个结果都应该打印

```
{1: 'a', 2: 'b', 3: 'c', 4: 'd'} 
```

# visual-studio - 你如何移动 Visual Studio DataTip 窗口

> ID：209843
> 
> 赞同：1
> 
> 时间：2008-10-16T19:06:15.390
> 
> 标签：visual-studio

窗口在变量下方弹出，并遮盖了我要查看的代码。

我可以在不丢失位置的情况下移动窗户吗？我似乎记得有办法做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:41:49.313

我记得[我在哪里看到了提示](http://blogs.msdn.com/saraford/archive/2005/11/21/495496.aspx)。

答案是：你不能移动窗口，但是按 Ctrl 使它透明，这也很好。

# jquery - jQuery 和 jVal 验证插件。向元素添加属性

> ID：209858
> 
> 赞同：0
> 
> 时间：2008-10-16T19:09:41.577
> 
> 标签：jquery, validation, dom, attributes

我正在尝试将 jVal 属性添加到我在 HTML 中创建的文本框中。

```
<input id="subJobName" type="text" jval="{valid:function (val) { return validateSubJobName(val); }, message:'Name already exists or is longer than 14 characters.', styleType:'cover'}" /> 
```

我会让在javascript中添加/设置jVal。

2个原因——

第一：我不需要搜索 HTML 来查看每个项目是如何验证的

第二：我们正在使用 jqGrid，我想在动态创建时将此验证添加到每个文本框。

我以为我可以从 HTMl 中删除 jVal，让我留下纯旧的文本框。

```
<input id="subJobName" type="text" /> 
```

然后在 Doc.Ready 函数中，我将 jVal 添加到 SubJobName 元素，如下所示：

```
$("#subJobName").attr({ jval: { valid: function(val) { return validateSubJobName(val); }, message: "Nam", styleType: "cover"} }); 
```

这行不通。我不确定我是否能做到这一点？有人有想法么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-28T02:01:27.920

我有 jVal 0.1.4 作为正在进行的工作，它为您正在寻找的内容添加了一个 init() 函数。[从http://jquery-jval.googlecode.com/svn/trunk/jVal.js](http://jquery-jval.googlecode.com/svn/trunk/jVal.js)获取最新的 jVal.js 主干。

您可以将 jVal 和 jValKey 属性附加到字段，然后重新初始化 jVal 功能，如下所示：

```
$("#subJobName").attr({ jval: { valid: function(val) { return validateSubJobName(val); }, message: "Nam", styleType: "cover"} });
$.fn.jVal.init(); 
```

# javascript - 使用 JavaScript 设置 HTML 页面垂直位置

> ID：209861
> 
> 赞同：4
> 
> 时间：2008-10-16T19:10:45.507
> 
> 标签：javascript, scroll, position

我有一个可以上下滚动的 HTML 页面（不是很多，但确实滚动）。执行一些 JavaScript 后如何设置页面中的滚动位置？

我正在使用 jQuery 在页面底部注入一些额外的 HTML，我想在添加新内容后以编程方式滚动到该新内容的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T19:16:09.410

尝试使用[`window.scroll`](http://developer.mozilla.org/en/DOM/window.scroll).

> 例子：
> 
> ```
> // put the 100th vertical pixel at the top of the window
> <button onClick="scroll(0, 100);">click to scroll down 100 pixels</button> 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T19:55:36.040

执行此操作的另一种方法，以便您可以选择：

在您添加到页面底部的 HTML 中，您可以插入一个命名的锚标记，然后更改 URL，以便页面移动到那里（仅供​​参考：它不会刷新页面）。

```
// add HTML like this, dynamically:
// <a name="moveHere" />

// the javascript to make the page go to that location:
window.location.hash = "moveHere"; 
```

根据您在做什么，这可能是也可能不是有用的解决方案。

# html - 如何使该站点在非firefox浏览器中运行？

> ID：209862
> 
> 赞同：1
> 
> 时间：2008-10-16T19:10:45.507
> 
> 标签：html, css, internet-explorer

此页面在 Firefox 中显示精美，但在 Opera 或 Internet Explorer 中测试该站点时，我遇到了各种问题，主要是菜单。我想知道是什么技术导致了这种情况以及如何避免它们。

[http://www.jkhbdesign.se/](http://www.jkhbdesign.se/)

编辑2：以下是一些具体问题的截图

下拉列表应如下所示：

[替代文字 http://nibbo.se/slask/correct.png](http://nibbo.se/slask/correct.png)

它在 IE 7 中的外观：

[替代文字 http://nibbo.se/slask/dropdownie.png](http://nibbo.se/slask/dropdownie.png)

它在 Opera 中的外观：

[替代文字 http://nibbo.se/slask/dropdownopera.png](http://nibbo.se/slask/dropdownopera.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:30:36.200

至少你将不得不处理这样一个事实，即除了锚标签之外的任何标签在 IE 中都不支持 CSS :hover。你需要在 IE 中使用 onmouseover、onmouseout 来完成同样的事情。或者将 li:hover 更改为 a:hover 但我认为这将是对您的设计的更大改革。

具体来说，CSS是这样的：

```
ul.menu li:hover ul.submenu {
background:white none repeat scroll 0 0;
border:1px solid #A6A6A6;
display:block;
margin-left:-25px;
margin-top:23px;
padding:2px 0;
position:absolute;
} 
```

在 Internet Explorer 中无法正常工作。我不知道歌剧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:38:52.283

[我创建的网站](http://www.stannscatholicschool.com)遇到了这个问题。问题最终是我不应该在菜单中`<li>`的下一个标签开始之前结束标签。`<ul>`

例如：

```
<div id="menu">
  <ul><a href="/index.html">Home</a>

    <li><a href="/aboutus/index.html">About Us</a>
    <ul>
        <li><a href="/aboutus/history.html">History</a> 
```

注意没有结束`</li>`标签。

我在使用 IE 和 CSS 菜单时遇到了很多问题。我推荐以下资源，它们可能会为您节省大量时间：

*   [http://www.seoconsultants.com/css/menus/horizo​​ntal/](http://www.seoconsultants.com/css/menus/horizontal/)
*   [http://www.alistapart.com/articles/horizdropdowns](http://www.alistapart.com/articles/horizdropdowns)

让我知道情况如何。

对于它的价值，第一个资源包括一个 csshover.htc 文件及其用法——我创建的站点使用它来解决由 Internet Explorer 引起的问题。如果您查看该站点的源代码，您还会看到与 Internet Explorer 相关的条件注释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T19:43:58.560

在没有看到您网站的 CSS 的情况下，我怀疑您正在使用 css:hover 和 Lists 来创建菜单。IE 不支持这个，所以你必须提供一个行为文件来让 IE 有这个功能， [在这里链接一个文件](http://www.xs4all.nl/~peterned/csshover.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T20:06:44.193

如果您熟悉 javascript，则可能需要查看 JQuery Superfish 插件。（[http://plugins.jquery.com/project/Superfish](http://plugins.jquery.com/project/Superfish)）。大多数艰苦的工作和奇怪的浏览器问题已经为您解决了。

# javascript - 通过 JSON 发送 64 位值的公认方式是什么？

> ID：209869
> 
> 赞同：36
> 
> 时间：2008-10-16T19:13:17.483
> 
> 标签：javascript, json, 64-bit

我的一些数据是 64 位整数。我想将这些发送到在页面上运行的 JavaScript 程序。

然而，据我所知，大多数 JavaScript 实现中的整数都是 32 位有符号数。

我的两个选择似乎是：

1.  将值作为字符串发送
2.  将值作为 64 位浮点数发送

选项 (1) 并不完美，但选项 (2) 似乎远没有那么完美（数据丢失）。

你是如何处理这种情况的？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-16T19:20:29.620

这似乎不是 JSON 的问题，而是 Javascript 本身的问题。你打算用这些数字做什么？如果它只是您需要稍后传递回网站的魔术令牌，请务必使用包含该值的字符串。如果您实际上必须对值进行算术运算，您可以编写自己的 Javascript 例程来进行 64 位算术运算。

您可以在 Javascript（以及 JSON）中表示值的一种方法是将数字拆分为两个 32 位值，例如。

```
 [ 12345678, 12345678 ] 
```

要将 64 位值拆分为两个 32 位值，请执行以下操作：

```
 output_values[0] = (input_value >> 32) & 0xffffffff;
  output_values[1] = input_value & 0xffffffff; 
```

然后将两个 32 位值重新组合为一个 64 位值：

```
 input_value = ((int64_t) output_values[0]) << 32) | output_values[1]; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-01-25T09:43:58.140

事实上，JavaScript/ECMAScript 的整数精度限制为 53 位（它们存储在“类似双精度”的 8 字节内存缓冲区的尾数中）。因此，以 JSON 格式传输大数字不会像 JavaScript 客户端预期的那样被反序列化，这会将它们截断为 53 位分辨率。

```
> parseInt("10765432100123456789")
10765432100123458000 
```

查看[`Number.MAX_SAFE_INTEGER`常量](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER)和 `Number.isSafeInteger()`函数：

> 常数的`MAX_SAFE_INTEGER`值为`9007199254740991`。该数字背后的原因是 JavaScript 使用 IEEE 754 中指定的双精度浮点格式数字，并且只能安全地表示 和 之间的`-(2^53 - 1)`数字`2^53 - 1`。
> 
> 在这种情况下，安全是指准确表示整数并正确比较它们的能力。例如， `Number.MAX_SAFE_INTEGER + 1 === Number.MAX_SAFE_INTEGER + 2`将评估为`true`，这在数学上是不正确的。有关 `Number.isSafeInteger()`更多信息，请参阅。

由于 JavaScript 中浮点数的分辨率，使用您建议的“64 位浮点数”将受到同样的限制。

恕我直言，最好的选择是将这些值作为文本传输。它仍然是完全可读的 JSON 内容，并且很容易在 JavaScript 级别上使用。

“纯字符串”表示是[OData 为其指定的`Edm.Int64`或`Edm.Decimal`类型](https://stackoverflow.com/a/16549441/458259)。

在这种情况下，Twitter API 所做的是`".._str":`在 JSON 中添加一个特定字段，如下所示：

```
{
   "id": 10765432100123456789,           // for JSON compliant clients
   "id_str": "10765432100123456789",     // for JavaScript
    ...
} 
```

我非常喜欢这个选项，因为它仍然与支持 int64 的客户端兼容。在实践中，如果在 HTTP 级别对 JSON 中的此类重复内容进行压缩/压缩，则不会造成太大影响。

一旦以字符串形式传输，您就可以使用[strint 之类的库——一个用于字符串编码整数的 JavaScript 库](https://github.com/rauschma/strint)来处理此类值。

**更新：**较新版本的 JavaScript 引擎包括一个[BigInt](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt)对象类，它能够处理超过 53 位。事实上，它可以用于任意大的整数，因此非常适合 64 位整数值。但是当序列化为 JSON 时，BigInt 值[将被序列化为 JSON 字符串](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt#use_within_json)——这很奇怪，但我猜是出于兼容性目的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T16:08:16.243

Javascript 的数字类型（64 位 IEEE 754）只有大约 53 位的精度。

但是，如果您不需要进行任何加法或乘法运算，那么您可以将 64 位值保留为 4 个字符的字符串，因为 JavaScript 使用 UTF-16。

例如，1 可以编码为“\u0000\u0000\u0000\u0001”。这样做的好处是值比较（==、>、<）可以按预期对字符串起作用。编写位操作似乎也很简单：

```
function and64(a,b) {
    var r = "";
    for (var i = 0; i < 4; i++)
        r += String.fromCharCode(a.charCodeAt(i) & b.charCodeAt(i));
    return r;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T21:17:27.683

JS 数字表示是标准的 ieee double，所以不能表示 64 位整数。iirc 你可能会得到 48 位的实际 int 精度，但所有 JS bitops 都会降低到 32 位精度（这就是规范所要求的。耶！）所以如果你真的需要 js 中的 64 位 int，你需要实现你自己的64 位 int 逻辑库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T19:15:41.877

JSON 本身并不关心实现限制。您的问题是 JS 无法处理您的数据，而不是协议。换句话说，您的 JS 客户端代码必须使用这些不完美的选项中的任何一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-07T09:18:50.657

这件事发生在我身上。当通过 json 将大整数发送到 JSON.parse 时，一切都乱了套。我花了几天时间尝试调试。当我将值作为字符串传输时，问题立即解决。

使用 代替 ``{ "the_sequence_number": "20200707105904535" }`` ``{ "the_sequence_number": 20200707105904535 }``

更糟糕的是，每个 JSON.parse 的实现似乎都是 Firefox、Chrome 和 Opera 之间的一些共享库，因为它们的行为完全相同。Opera 错误消息中包含 Chrome URL 引用，几乎就像浏览器共享的 WebKit。

 ````
console.log('event_listen[' + global_weird_counter + ']: to be sure, server responded with [' + aresponsetxt + ']');
var response = JSON.parse(aresponsetxt);
console.log('event_listen[' + global_weird_counter + ']: after json parse: ' + JSON.stringify(response)); 
```` 

我得到的行为是指针数学变得非常糟糕的那种东西。鬼从我的工作站飞出，在我的睡眠中造成严重破坏。现在我切换到弦乐，它们都被驱除了。

# jquery - jQuery 多个单选按钮

> ID：209874
> 
> 赞同：2
> 
> 时间：2008-10-16T19:14:45.293
> 
> 标签：jquery, radio-button, this

javascript/jquery 新手，很难使用`this`或`$(this)`获取当前对象。

我有一个表，`radio buttons`每行都有一组，每个名为`s_<rowindex>`. 默认情况下不选中任何单选按钮：

```
<tr>
   <td align="left" style="width: 300px">
      <div id="div_s_0">
         <input type="radio" name="s_0" value="1" />Public
         <input type="radio" name="s_0" value="2" />Not Public
         <input type="radio" name="s_0" value="3" />Confidential
      </div>
   </td>
</tr>
<tr>
   <td align="left" style="width: 300px">
      <div id="div_s_1">
         <input type="radio" name="s_1" value="1" />Public
         <input type="radio" name="s_1" value="2" />Not Public
         <input type="radio" name="s_1" value="3" />Confidential
      </div>
   </td>
</tr> 
```

我正在尝试编写一个 jQuery 函数，以便在用户选择单选按钮时向表中添加新行，但前提是它们当前位于表的最后一行。我想做的是获取单击的单选按钮的名称属性，对其进行解析以获取行索引（即'_'之后的部分）并将其与表中的行数进行比较。如果它们相等，则添加一个新行，否则，什么也不做。

我的问题是双重的，取决于我应该如何解决这个问题：

1) 如何返回单选按钮的名称属性，或者 2) 如何返回当前所在行的行索引？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T19:36:58.107

这将为您提供索引，使用您提供的 HTML：

```
$(document).ready(function() {
    $("input:radio").click(function() {
        var index = parseInt(this.name.split('_')[1])
    });
}); 
```

另一件事可能对您有所帮助：检索表中的行数：

```
$($("table").children()[0]).children().length 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T20:04:44.693

对于您的具体问题 1 和 2，如果您为您的表提供了“mytable”的 ID，则此示例应该为您提供所需的内容：

```
var rowIndex = $("#mytable tr").index($(this).parents("tr"));
var inputName = $(this).attr("name");
alert("Input Name: " + inputName + "; RowIndex: " + rowIndex); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T19:29:56.107

这是一些未经测试的代码，在我的脑海中：

```
$("#div_s_0 input[type='radio']").onclick = function() {
    if ($("#div_s_0 input[type='radio']:last").attr('checked') == 'checked') {
    /* add a new element */
    }
} 
```

这样做是将 onclick 事件附加到 div 中的每个单选按钮。onclick 将检查该组中的最后一个单选按钮是否被选中，如果是，则添加另一个元素。

就像我说的，它还没有经过测试。我不确定选择器 (# `div_s_0 ... :last`)，所以先在 Firebug 中运行它。

# java - 从哪个 Linux 内核/libc 版本开始，Java Runtime.exec() 就内存而言是安全的？

> ID：209875
> 
> 赞同：23
> 
> 时间：2008-10-16T19:15:10.240
> 
> 标签：java, linux, memory, out-of-memory

在工作中，我们的目标平台之一是运行 Linux 的资源受限的小型服务器（内核 2.6.13，基于旧的 Fedora Core 的自定义发行版）。该应用程序是用 Java (Sun JDK 1.6_04) 编写的。Linux OOM 杀手配置为在内存使用量超过 160MB 时终止进程。即使在高负载期间，我们的应用程序也永远不会超过 120MB，并且与其他一些活动的本机进程一起，我们保持在 OOM 限制内。

然而，事实证明，Java Runtime.getRuntime().exec() 方法，从 Java 执行外部进程的规范方法，[在 Linux 上有一个特别不幸的实现](http://developers.sun.com/solaris/articles/subprocess/subprocess.html)，导致生成的子进程（暂时）需要相同数量的由于地址空间被复制，内存作为父进程。最终结果是，一旦我们执行 Runtime.getRuntime().exec()，我们的应用程序就会被 OOM 杀手杀死。

我们目前通过让一个单独的本机程序执行所有外部命令来解决这个问题，并通过套接字与该程序通信。这不是最佳的。

在[网上发布这个问题](http://aggregat4.net/2008/06/java-runtimeexec-dangerous-on-linux/)后，我得到了一些反馈，表明这不应该发生在“较新”版本的 Linux 上，因为它们使用写时复制实现了 posix fork() 方法，大概意味着它只会复制它需要的页面在需要时修改而不是立即修改整个地址空间。

我的问题是：

*   这是真的？
*   这是内核、libc 实现还是其他地方的东西？
*   从哪个版本的内核/libc/fork() 可用的写时复制？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-16T14:25:43.813

这几乎是 *nix（和 linux）从时间之初（或至少在 mmus 之初）开始工作的方式。

要在 *nixes 上创建一个新进程，请调用 fork()。fork() 使用其所有内存映射、文件描述符等创建调用进程的副本。内存映射是在写入时复制完成的，因此（在最佳情况下）实际上没有复制内存，只有映射。随后的 exec() 调用将当前内存映射替换为新可执行文件的映射。因此，fork()/exec() 是您创建新进程的方式，这就是 JVM 使用的方式。

需要注意的是，在繁忙的系统上有大量进程，在子 exec() 导致大量内存被复制之前，父进程可能会继续运行一段时间，因为写入时复制。在虚拟机中，内存可以移动很多，以促进垃圾收集器产生更多的复制。

The "workaround" is to do what you've already done, create an external lightweight process that takes care of spawning new processes - or use a more lightweight approach than fork/exec to spawn processes (Which linux does not have - and would anyway require a change in the jvm itself). Posix specifies the posix_spawn() function, which in theory can be implemented without copying the memory mapping of the calling process - but on linux it isn't.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T22:05:40.177

好吧，我个人怀疑这是真的，因为 Linux 的 fork() 是通过写时复制完成的，因为上帝知道什么时候（至少，2.2.x 内核有它，它是在 199x 的某个地方）。

由于 OOM 杀手被认为是一种相当粗糙的工具，已知会失火（fe，它没有必要杀死实际分配大部分内存的进程）并且应该仅用作最后的报告，因此尚不清楚我为什么将其配置为在 160M 上触发。

如果你想对内存分配施加限制，那么 ulimit 是你的朋友，而不是 OOM。

我的建议是不理会 OOM（或完全禁用它），配置 ulimits，然后忘记这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-16T14:07:18.340

是的，即使是新版本的 Linux（我们使用的是 64 位 Red Hat 5.2）也是如此。大约 18 个月以来，我一直遇到运行缓慢的子进程的问题，并且在我阅读您的问题并运行测试以验证它之前，我永远无法找出问题所在。

我们有一个 32 GB 的机器，有 16 个内核，如果我们使用 -Xms4g 和 -Xmx8g 等设置运行 JVM，并使用具有 16 个线程的 Runtime.exec() 运行子进程，我们无法以超过 20 个线程的速度运行我们的进程每秒处理调用。

在 Linux 中使用简单的“date”命令尝试此操作大约 10,000 次。如果你添加分析代码来观察正在发生的事情，它会很快开始，但随着时间的推移会变慢。

阅读您的问题后，我决定尝试将内存设置降低到 -Xms128m 和 -Xmx128m。现在我们的进程以每秒大约 80 个进程调用的速度运行。JVM 内存设置是我所做的全部更改。

即使我用 32 个线程尝试过它，它似乎也没有以我曾经内存不足的方式吸收内存。只是必须以某种方式分配额外的内存，这会导致沉重的启动（甚至可能是关闭）成本。

无论如何，似乎应该有一个设置来禁用这种行为 Linux 甚至在 JVM 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T21:02:01.537

1：是的。2：这分为两个步骤：任何像fork()这样的系统调用都被glibc包装到内核中。系统调用的内核部分在 kernel/fork.c 3：我不知道。但我敢打赌你的内核有它。

当 32 位机器上的低内存受到威胁时，OOM 杀手就会发挥作用。我从来没有遇到过这个问题，但是有一些方法可以阻止 OOM。这个问题可能是一些 OOM 配置问题。

由于您使用的是 Java 应用程序，因此您应该考虑迁移到 64 位 Linux。那绝对应该解决它。只要安装了相关库，大多数 32 位应用程序都可以在 64 位内核上毫无问题地运行。

您还可以尝试 32 位 Fedora 的 PAE 内核。

# python - Python 教程 - 我应该使用 2.x 还是 3.0？

> ID：209888
> 
> 赞同：7
> 
> 时间：2008-10-16T19:19:00.200
> 
> 标签：python, python-3.x, python-2.x

Python 3.0 处于测试阶段，最终版本即将发布。很明显，要普遍采用并最终取代 2.x 需要相当长的时间。

我正在写一篇关于 Python 编程某些方面的教程。我想知道是否应该在 Python 2.x 或 3.0 中执行此操作？（并不是说差异很大）

2.x 教程现在可能更有用，但最好开始制作 3.0 教程。

有人有想法吗？

（当然我可以两者都做，但我更愿意做其中之一）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-18T03:43:26.687

从 2.x 开始。大多数现有库将长期使用 2.x。去年，[Guido 本人表示，需要“两年”](http://www.artima.com/weblogs/viewpost.jsp?thread=211200)才能学习 3.0；还有一年的时间。个人认为会更长。在 2.x 上编写代码的人可以学习如何使用该`2to3`工具并拥有适用于两个版本的代码。没有 3to2，因此为 python 3 编写的代码价值明显降低。

更不用说让您的学生得知他们的 Linux 计算机上没有安装 python 3（`/usr/bin/python`至少在接下来的 5 年中将是 python 2.x），没有用于 python 的 django会多么令人失望3，python 3 没有 wxwindows，python 3 没有 GTK，python 3 没有 Twisted，python 3 没有 PIL……Python 的真正优势一直在于其广泛的库集合，而用于蟒蛇 3 现在。

如果你的教程写得很好，你应该可以轻松地将它更新到 python 2.6、2.7，最后是 python 3。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-16T19:23:38.677

Van Rossum（python 的创造者）解释说：“如果你要开始一个全新的东西，你应该使用 3.0。” 所以大多数想要开始的人甚至应该从 3.0 开始。这将很有用，尤其是因为现在可能很少。

[文章](http://www.linux.com/feature/150399)_

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T19:25:18.753

Python 2.x 已经发布了足够长的时间来构建相当多的教程，但是 3k 可用的资源要少得多。一些介绍级别 3k 的东西可能会看到更通用的用途。因此，除非您将其定制到缺少任何 python 资源的特定子域，否则 3k 会更有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T19:26:08.813

正如传染性所暗示的那样，学习 Python 3.0。

Python 2.x 并没有太大的不同，似乎有很多关于它们之间相当小的差异的 FUD。当然，差异很大，以至于大多数程序都需要修改，但几乎*所有*修改都很简单（比如将`print`语句更改为`print`函数）。

事实上，Python 2.6 可以选择启用 Python 3.0 的所有新语法特性。这是一个经过深思熟虑的过渡过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T19:21:18.620

这取决于你的听众。如果是普通观众，并且您打算将其发布很长时间，我建议您期待并使用 3.0。另一方面，如果它是用于在不久的将来进行工作的项目或团队，Python 2 可能更有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T19:25:54.587

差异很小，以至于实际上并没有多大关系。

# c# - 从报价中提取数据？

> ID：209890
> 
> 赞同：4
> 
> 时间：2008-10-16T19:19:42.477
> 
> 标签：c#, regex

我正在寻找一个正则表达式，它可以在字符串中提取带引号的部分，包括单引号和双引号。

IE：

```
"This is 'an example', \"of an input string\"" 
```

火柴：

*   一个例子
*   输入字符串的

我写了这个：

```
 [\"|'][A-Za-z0-9\\W]+[\"|'] 
```

它有效，但有人看到它有任何缺陷吗？

编辑：我看到的主要问题是它无法处理嵌套引号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:30:25.513

它如何处理双引号内的单引号（反之亦然）？

```
"This is 'an example', \"of 'quotes within quotes'\"" 
```

应该匹配

*   一个例子
*   '引号内的引号'

如果您需要支持这一点，请使用反向引用。

```
(\"|')[A-Za-z0-9\\W]+?\1 
```

编辑：固定使用不情愿的量词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T19:22:48.990

像那样？

```
"([\"'])(.*?)\1" 
```

您想要的匹配将在第 2 组中，而在第 1 组中的引用类型。

您的正则表达式中的缺陷是 1）贪婪的“+”和 2）[A-Za-z0-9] 并没有真正匹配很多。许多字符不在该范围内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T20:22:33.847

```
@"(\"|')(.*?)\1" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T21:50:58.397

您可能已经拥有其中一个，但如果没有，这里有一个免费的开源工具，我一直使用它来测试我的正则表达式。我通常对表达式应该是什么样子有一个大致的想法，但需要摆弄一些细节。

[http://renschler.net/RegexBuilder/](http://renschler.net/RegexBuilder/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T19:22:10.647

它可以工作，但不匹配引号中的其他字符（例如，非字母数字，如二进制或外语字符）。这个怎么样：

```
[\"']([^\"']*)[\"'] 
```

我的 C# 正则表达式有点生疏，所以如果不完全正确，请放轻松:)

# rest - 具象状态传输 (REST) 和简单对象访问协议 (SOAP)

> ID：209905
> 
> 赞同：732
> 
> 时间：2008-10-16T19:24:14.747
> 
> 标签：rest, soap

有人可以用简单的英语解释什么是[REST](https://stackoverflow.com/tags/rest/info)和什么是[SOAP吗？](https://stackoverflow.com/tags/soap/info)Web 服务是如何工作的？

* * *

## 回答 #1

> 赞同：1592
> 
> 时间：2012-01-24T07:02:02.637

## 关于 SOAP 和 REST 的简单解释

**SOAP - “简单对象访问协议”**

SOAP 是一种通过 Internet 传输消息或少量信息的方法。SOAP 消息采用 XML 格式，通常使用 HTTP（超文本传输​​协议）发送。

* * *

**休息 - 代表性状态转移**

Rest 是一种在客户端和服务器之间发送和接收数据的简单方法，它没有定义很多标准。您可以以 JSON、XML 甚至纯文本的形式发送和接收数据。与 SOAP 相比，它的重量很轻。

* * *

![在此处输入图像描述](https://i.stack.imgur.com/GwRYd.jpg)

* * *

## 回答 #2

> 赞同：327
> 
> 时间：2008-10-16T19:33:52.027

许多大玩家都使用这两种方法。这是一个偏好问题。我的首选是 REST，因为它更易于使用和理解。

**简单对象访问协议 (SOAP)：**

*   SOAP 在 HTTP 或有时 TCP/IP 之上构建 XML 协议。
*   SOAP 描述函数和数据类型。
*   SOAP 是 XML-RPC 的继承者，并且非常相似，但描述了一种标准的通信方式。
*   几种编程语言都对 SOAP 提供原生支持，您通常向其提供 Web 服务 URL，并且无需特定代码即可调用其 Web 服务功能。
*   必须首先将发送的二进制数据编码为 base64 编码等格式。
*   有几个与之相关的协议和技术：WSDL、XSD、SOAP、WS-Addressing

**表征状态转移（REST）：**

*   REST 不需要通过 HTTP，但我在下面的大部分观点都会有 HTTP 偏见。
*   REST 是非常轻量级的，它说等一下，我们不需要 SOAP 创建的所有这些复杂性。
*   通常使用普通的 HTTP 方法而不是描述所有内容的大型 XML 格式。例如，要使用 HTTP GET 获取资源，使用 HTTP PUT 将资源放在服务器上。要删除服务器上的资源，请使用 HTTP DELETE。
*   REST 非常简单，因为它使用 HTTP GET、POST 和 PUT 方法来更新服务器上的资源。
*   REST 通常最好与[面向资源的架构](https://en.wikipedia.org/wiki/Resource-oriented_architecture)(ROA) 一起使用。在这种思维模式下，一切都是资源，您将在这些资源上进行操作。
*   只要你的编程语言有一个 HTTP 库，而且大多数都有，你就可以很容易地使用 REST HTTP 协议。
*   二进制数据或二进制资源可以根据他们的请求简单地交付。

在 google 上有[无休止的关于 REST 与 SOAP 的争论](http://www.google.ca/search?rlz=1C1GGLS_enCA291&sourceid=chrome&ie=UTF-8&q=REST+vs+SOAP)。

[我最喜欢的是这个](http://prescod.net/rest/rest_vs_soap_overview/)。2013 年 11 月 27 日更新：Paul Prescod 的网站似乎已下线，这篇文章不再可用，但可以在[Wayback Machine](http://web.archive.org/web/20120421084456/http://www.prescod.net/rest/rest_vs_soap_overview/)上找到副本或在[CiteSeerX](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.97.1377&rep=rep1&type=pdf)上找到 PDF 。

* * *

## 回答 #3

> 赞同：265
> 
> 时间：2012-09-19T18:41:07.547

**休息**

我理解 REST 的主要思想非常简单。我们多年来一直使用网络浏览器，并且我们已经看到网站是多么简单、灵活、执行等等。HTML 站点使用超链接和表单作为用户交互的主要方式。他们的主要目标是让我们，客户，只知道我们**可以在当前状态下使用的**那些链接。REST 只是说“为什么不使用相同的原则来驱动计算机而不是人类客户端通过我们的应用程序？” 将此与 WWW 基础架构的强大功能结合起来，您将获得构建出色分布式应用程序的杀手级工具。

另一种可能的解释是针对具有数学思维的人。每个应用程序基本上都是一个状态机，其业务逻辑操作是状态转换。REST 的想法是将每个转换映射到对资源的​​某个请求，并为客户端提供表示当前状态下可用转换的链接。因此，它通过表示和链接对状态机进行建模。这就是为什么它被称为代表性状态转移。

令人惊讶的是，所有答案似乎都集中在消息格式或 HTTP 动词的使用上。事实上，消息格式根本不重要，只要服务开发人员记录在案，REST 可以使用任何一种格式。HTTP 动词仅使服务成为 CRUD 服务，但还不是 RESTful。真正将服务转变为 REST 服务的是与数据一起嵌入到服务器响应中的超链接（也称为超媒体控件），它们的数量必须足以让任何客户端从这些链接中选择下一个操作。

[不幸的是，除了Roy Fielding 的论文](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)之外，很难在 Web 上找到有关 REST 的正确信息。（他是派生 REST 的人）。我会推荐[“实践中的 REST”一书](https://rads.stackoverflow.com/amzn/click/com/0596805829)，因为它提供了关于如何从 SOAP 发展到 REST 的全面的分步教程。

**肥皂**

这是 RPC（远程过程调用）架构风格的一种可能形式。本质上，它只是一种允许客户端通过服务边界（网络、进程等）调用服务器方法的技术，就像调用本地方法一样。当然，它实际上在速度、可靠性等方面与调用本地方法不同，但想法就是这么简单。

**比较的**

在将任何形式的 RPC 与 REST 进行比较时，传输协议、消息格式、xsd、wsdl 等细节并不重要。主要区别在于 RPC 服务通过在 RPC API 中设计自己的应用程序协议，使用只有它知道的语义来改造自行车。因此，所有客户端在使用服务之前都必须了解该协议，并且由于所有请求的专有语义，无法构建像缓存这样的通用基础设施。此外，RPC API 不建议在当前状态下允许哪些操作，这必须从其他文档中得出。另一方面，REST 意味着使用统一的接口来允许各种客户端对 API 语义有一些了解，并使用超媒体控件（链接）来突出显示每个状态下的可用选项。因此，

在某种程度上，SOAP（与任何其他 RPC 一样）是一种通过服务边界的隧道尝试，将连接媒体视为只能传输消息的黑匣子。REST 决定承认 Web 是一个巨大的分布式信息系统，接受世界的现状并学习掌握它而不是与之抗争。

当您同时控制服务器和客户端并且交互不太复杂时，SOAP 似乎非常适合内部网络 API。开发人员使用它更自然。但是，对于许多独立方使用的公共 API，复杂且庞大，REST 应该更适合。但是最后一个比较是非常模糊的。

**更新**

我的经验出乎意料地表明 REST 开发比 SOAP 更困难。至少对于.NET。虽然有像 ASP.NET Web API 这样的优秀框架，但没有可以自动生成客户端代理的工具。没有像“添加 Web 服务引用”或“添加 WCF 服务引用”这样的东西。必须手动编写所有序列化和服务查询代码。伙计，那是很多样板代码。我认为 REST 开发需要类似于 WSDL 的东西以及每个开发平台的工具实现。事实上，似乎有一个很好的基础：[WADL](http://en.wikipedia.org/wiki/Web_Application_Description_Language "WADL")或[WSDL 2.0](https://stackoverflow.com/a/6030869/795861)，但是这两个标准似乎都没有得到很好的支持。

**更新（2016 年 1 月）**

事实证明，现在有[各种各样的工具](http://nordicapis.com/top-specification-formats-for-rest-apis/)用于 REST API 定义。我个人的偏好目前是[RAML](http://raml.org/)。

*Web 服务的工作原理*

嗯，这是一个过于宽泛的问题，因为它取决于特定 Web 服务中使用的架构和技术。但一般来说，Web 服务只是 Web 中可以接受来自客户端的请求并返回响应的一些应用程序。它暴露在 Web 上，因此它是一个*Web*服务，它通常 24/7 全天候可用，这就是它是一个*服务*的原因。当然，它为它的客户解决了一些问题（否则为什么有人会使用 Web 服务）。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2012-07-13T07:33:22.700

这是你能找到的最简单的解释。

这篇文章讲述了一对夫妻的故事，丈夫用纯粹的外行术语向他的妻子解释了 REST。必读！

[how-i-explained-rest-to-my-wife](http://tomayko.com/writings/rest-to-my-wife)（原始链接）
[how-i-explained-rest-to-my-wife](http://www.eioba.com/a/1htn/how-i-explained-rest-to-my-wife)（2013-07-19 工作链接）

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2014-03-14T20:28:05.577

**SOAP——简单对象访问协议**是一种*协议*！

**REST-REpresentational State Transfer**是一种*架构风格*！

`SOAP`是一种用于传输消息的 XML 协议，通常通过 HTTP

`REST`并且`SOAP`可以*说* ***不是***相互排斥的。RESTful 架构可能使用`HTTP`或`SOAP`或其他一些通信协议。`REST`针对网络进行了优化，因此`HTTP`是一个完美的选择。`HTTP`也是Roy Fielding 论文中讨论的*唯一协议。*

尽管 REST 和 SOAP 显然非常不同，但这个问题确实说明了一个事实，`REST`并且`HTTP`经常串联使用。这主要是由于 HTTP 的简单性及其与 RESTful 原则的非常自然的映射。

### 基本 REST 原则

**客户端-服务器通信**

客户端-服务器架构具有非常明显的关注点分离。以 RESTful 风格构建的所有应用程序原则上也必须是客户端-服务器。

**无状态**

每个客户端对服务器的请求都要求完全表示其状态。服务器必须能够在不使用任何服务器上下文或服务器会话状态的情况下完全理解客户端请求。因此，所有状态都必须保存在客户端上。稍后我们将更详细地讨论无状态表示。

**可缓存**

可以使用缓存约束，从而使响应数据能够被标记为可缓存或不可缓存。任何标记为可缓存的数据都可以重新用作对相同后续请求的响应。

**统一接口**

所有组件都必须通过一个统一的接口进行交互。因为所有的组件交互都是通过这个接口进行的，所以与不同服务的交互非常简单。界面是一样的！这也意味着可以单独进行实施更改。此类更改不会影响基本组件交互，因为统一接口始终保持不变。一个缺点是你被界面卡住了。如果可以通过更改接口为特定服务提供优化，那么您就不走运了，因为 REST 禁止这样做。然而，好的一面是，REST 针对 Web 进行了优化，因此 REST over HTTP 非常受欢迎！

上述概念代表了 REST 的定义特征，并将 REST 架构与其他架构（如 Web 服务）区分开来。请注意，REST 服务是一种 Web 服务，但 Web 服务不一定是 REST 服务。

**有关REST**和上述项目符号的更多详细信息，请参阅这篇关于**REST 设计原则**的博客[文章。](http://carminedimascio.com/2013/09/restful-design-principles/)

 ***** * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-16T19:47:34.340

我喜欢 Brian R. Bondy 的回答。我只是想补充一点，Wikipedia 提供了对[REST](http://en.wikipedia.org/wiki/REST)的清晰描述。这篇文章将它与 SOAP 区分开来。

REST 是状态信息的交换，尽可能简单地完成。

SOAP 是一种使用 XML 的消息协议。

许多人从 SOAP 迁移到 REST 的主要原因之一是与基于 SOAP 的 Web 服务相关的 WS-*（称为 WS splat）标准非常复杂。有关规格列表，请参阅[wikipedia](http://en.wikipedia.org/wiki/WS-*)。这些规范中的每一个都非常复杂。

编辑：由于某种原因，链接显示不正确。REST = [http://en.wikipedia.org/wiki/REST](http://en.wikipedia.org/wiki/REST)

WS-* = [http://en.wikipedia.org/wiki/WS-*](http://en.wikipedia.org/wiki/WS-)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-09-07T03:42:17.183

SOAP webservices 和 REST webservices 都可以使用 HTTP 协议和其他协议（只是提到 SOAP 可以是 REST 的底层协议）。我将只讨论与 HTTP 协议相关的 SOAP 和 REST，因为这是它们最常用的用法。

# 肥皂

[SOAP](http://en.wikipedia.org/wiki/SOAP)（“简单”对象访问协议）是一种协议（也是[W3C 标准](http://www.w3.org/TR/soap/)）。它定义了如何创建、发送和处理 SOAP 消息。

*   SOAP 消息是具有特定结构的 XML 文档：它们包含一个包含标头和正文部分的信封。正文包含 XML 格式的实际数据——我们要发送。有[两种编码风格](http://java.globinch.com/enterprise-java/web-services/soap-binding-document-rpc-style-web-services-difference/)，但[我们通常选择文字](http://www.coderanch.com/t/148480/java-Web-Services-SCDJWS/certification/encoding-style-literal-encoded)，这意味着我们的应用程序或其 SOAP 驱动程序对数据进行 XML 序列化和反序列化。

*   SOAP 消息作为带有 SOAP+XML MIME 子类型的 HTTP 消息传播。这些 HTTP 消息可以是多部分的，因此我们可以选择将文件附加到 SOAP 消息。

*   显然，我们使用客户端-服务器架构，因此 SOAP 客户端向 SOAP 网络服务发送请求，而服务将响应发送回客户端。大多数 Web 服务使用 WSDL 文件来描述服务。WSDL 文件包含我们要发送的数据的 XML Schema（以下称为 XSD）和 WSDL 绑定，它定义了 Web 服务如何绑定到 HTTP 协议。有[两种装订方式](http://java.globinch.com/enterprise-java/web-services/soap-binding-document-rpc-style-web-services-difference/): RPC 和文件。通过 RPC 样式绑定，SOAP 主体包含带有参数（HTTP 请求）或返回值（HTTP 响应）的操作调用的表示。参数和返回值根据 XSD 进行验证。通过文档样式绑定，SOAP 主体包含一个针对 XSD 进行验证的 XML 文档。我认为文档绑定风格更适合基于事件的系统，但我从未使用过这种绑定风格。RPC 绑定样式更为流行，因此大多数人通过分布式应用程序将 SOAP 用于 XML/RPC 目的。[Web 服务通常通过询问UDDI](http://en.wikipedia.org/wiki/Universal_Description_Discovery_and_Integration)服务器来找到彼此。UDDI 服务器是存储 Web 服务位置的注册表。

## SOAP RPC

所以 - 在我看来 - 最流行的 SOAP webservice 使用 RPC 绑定样式和文字编码样式，它具有以下属性：

*   它将 URL 映射到操作。
*   它发送带有 SOAP+XML MIME 子类型的消息。
*   它可以有一个服务器端会话存储，对此没有任何限制。
*   SOAP 客户端驱动程序使用服务的 WSDL 文件将 RPC 操作转换为方法。客户端应用程序通过调用这些方法与 SOAP Web 服务进行通信。因此，大多数 SOAP 客户端会因接口更改（导致方法名称和/或参数更改）而中断。
*   可以使用 RDF 编写不会因接口更改而中断的 SOAP 客户端，并通过语义查找操作，但[语义 Web](http://en.wikipedia.org/wiki/Semantic_Web_Services)服务非常罕见，它们不一定有非中断客户端（我猜）。

# 休息

REST（representational state transfer）是一种架构风格，在Roy Fielding的[论文中有所描述。](http://www.ics.uci.edu/%7Efielding/pubs/dissertation/top.htm)它不像 SOAP 那样关心协议。它从没有约束的空架构样式开始，并一一定义了 REST 架构的约束。人们使用术语 RESTful 来表示满足所有 REST 约束的 Web 服务，但根据 Roy Fielding 的说法，没有诸如[REST 级别](http://martinfowler.com/articles/richardsonMaturityModel.html)之类的东西。[当一个 Web 服务不满足每一个 REST 约束时，它就不是一个 REST Web 服务。](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

## REST 约束

*   客户端——服务器架构——我想这部分大家都很熟悉了。REST 客户端与 REST Web 服务通信，Web 服务维护公共数据 - 此后的资源状态 - 并将其提供给客户端。
*   无状态 - 缩写的“状态转移”部分：REST。客户端维护客户端状态（会话/应用程序状态），因此服务不能有会话存储。客户端通过每个请求将客户端状态的相关部分传输到服务，这些服务以资源状态的相关部分（由它们维护）进行响应。所以请求没有上下文，它们总是包含处理它们的必要信息。例如，通过 HTTP 基本身份验证，用户名和密码由客户端存储，并随每个请求一起发送，因此每个请求都会进行身份验证。这与仅通过登录进行身份验证的常规 Web 应用程序非常不同。我们可以使用任何客户端数据存储机制，如内存中（javascript）、cookies、localStorage 等...... 如果我们愿意，可以保留客户端状态的某些部分。无状态约束的原因是服务器可以很好地扩展 - 即使负载非常高（数百万用户） - 当它不必维护每个客户端的会话时。
*   缓存 - 响应必须包含有关它是否可以被客户端缓存的信息。这进一步提高了可扩展性。
*   统一的界面
    *   资源标识——REST 资源与[RDF](http://en.wikipedia.org/wiki/Resource_Description_Framework)资源相同。根据菲尔丁的说法，如果可以命名，那么它可以是资源，例如：“当前当地天气”可以是资源，或者“您的手机”可以是资源，或者“特定的网络文档”可以是资源。一种资源。要识别资源，您可以使用资源标识符：URL 和 URN（例如[ISBN number by books](http://en.wikipedia.org/wiki/International_Standard_Book_Number)）。一个标识符应该只属于一个特定的资源，但一个资源可以有很多标识符，我们经常利用这些标识符，例如使用`https://example.com/api/v1/users?offset=50&count=25`. URL 有一些[规范](https://www.rfc-editor.org/rfc/rfc3986#page-23)，例如具有相同路径但不同查询的URL不完全相同，或者路径部分应包含URL的分层数据，而查询部分应包含非分层数据。这些是如何通过 REST 创建 URL 的基础知识。顺便提一句。URL 结构只对服务开发人员很重要，真正的 REST 客户端与它无关。另一个常见问题是 API 版本控制，这是一个简单的问题，因为根据 Fielding 的说法，资源唯一不变的就是语义。如果语义发生变化，那么您可以添加新的版本号。您可以使用经典的[3 号版本控制](http://en.wikipedia.org/wiki/Software_versioning)并仅将主要编号添加到 URL（`https://example.com/api/v1/`）。因此，通过向后兼容的更改不会发生任何事情，通过非向后兼容的更改，您将拥有具有新 API 根的非向后兼容语义`https://example.com/api/v2/`。所以旧客户端不会中断，因为他们可以使用`https://example.com/api/v1/`旧语义。

    *   通过表示操作资源 - 您可以通过将资源的预期表示（连同 HTTP 方法和资源标识符）发送到 REST 服务来操作与资源相关的数据（资源状态）。例如，如果您想在结婚后重命名用户，您可以发送一个`PATCH https://example.com/api/v1/users/1 {name: "Mrs Smith"}`请求，其中`{name: "Mrs Smith"}`是预期资源状态的 JSON 表示，换句话说：新名称。反之亦然，服务将资源表示发送给客户端以更改其状态。例如，如果我们想读取新名称，我们可以发送一个`GET https://example.com/api/v1/users/1?fields="name"`检索请求，这会导致`200 ok, {name: "Mrs Smith"}`回复。所以我们可以使用这个表示来改变客户端状态，例如我们可以显示“欢迎来到我们的页面 Mrs Smith！” 信息。一个资源可以有多种表示形式，具体取决于资源标识符 (URL) 或`accept`我们随请求发送的标头。例如，如果需要，我们可以发送史密斯夫人的图像（可能不是裸体）`image/jpeg`。

    *   自描述消息 - 消息必须包含有关如何处理它们的信息。例如 URI 和 HTTP 方法、内容类型标头、缓存标头、描述数据含义的 RDF 等……使用标准方法很重要。了解HTTP 方法的[规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)很重要。例如 GET 表示检索由请求 URL 标识的信息，DELETE 表示要求服务器删除由给定 URL 标识的资源，等等...... HTTP 状态代码也有一个[规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，例如 200 表示成功，201 表示新资源已创建，404 表示在服务器上未找到请求的资源等...使用现有标准是 REST 的重要组成部分。

    *   超媒体作为应用程序状态的引擎（以下称为 HATEOAS）——超媒体是一种可以包含超链接的媒体类型。通过网络，我们跟随链接 - 由超媒体格式（通常是 HTML）描述 - 来实现目标，而不是在地址栏中输入 URL。REST 遵循相同的概念，服务发送的表示可以包含超链接。我们使用这些超链接向服务发送请求。通过响应，我们得到数据（可能还有更多链接），我们可以使用这些数据来构建新的客户端状态，等等……这就是为什么超媒体是应用程序状态（客户端状态）的引擎。您可能想知道客户如何识别和跟踪超链接？对人类来说，这很简单，我们阅读链接的标题，也许填写输入字段，然后单击一下。[JSON-LD](http://json-ld.org/) with [Hydra](http://www.markus-lanthaler.com/hydra/)）或超媒体特定解决方案（例如[IANA 链接关系](http://www.iana.org/assignments/link-relations/link-relations.xhtml)和[HAL+JSON](http://stateless.co/hal_specification.html)的[供应商特定 MIME 类型](http://en.wikipedia.org/wiki/Internet_media_type#Prefix_vnd)）。有许多机器可读的[XML](http://amundsen.com/hypermedia/)和[JSON 超媒体格式](http://sookocheff.com/posts/2014-03-11-on-choosing-a-hypermedia-format/)，只是其中的一小部分：

        *   [XHTML](http://www.w3.org/TR/xhtml1/)
        *   [原子+XML](http://en.wikipedia.org/wiki/Atom_%28standard%29)
        *   [RDF+XML](http://www.w3.org/TR/REC-rdf-syntax/)
        *   [HAL+XML](http://stateless.co/hal_specification.html)
        *   [哈尔+JSON](http://stateless.co/hal_specification.html)
        *   [JSON-LD](http://json-ld.org/)
        *   [RDF+JSON](https://dvcs.w3.org/hg/rdf/raw-file/default/rdf-json/index.html)
        *   [警笛](https://github.com/kevinswiber/siren)
        *   [集合+JSON](http://amundsen.com/media-types/collection/)

        有时很难选择...

*   分层系统——我们可以在客户端和服务之间使用多层。他们都不应该知道所有这些附加层，只是它旁边的层。这些层可以通过应用缓存和负载平衡来提高可伸缩性，或者它们可以强制执行安全策略。
*   按需代码 - 我们可以将扩展客户端功能的代码（例如 javascript 代码）发送回浏览器。这是 REST 的唯一可选约束。

# REST webservice - SOAP RPC webservice 区别

所以 REST webservice 与 SOAP webservice 非常不同（具有 RPC 绑定样式和文字编码样式）

*   它定义了一个统一的接口（而不是协议）。
*   它将 URL 映射到资源（而不是操作）。
*   它发送具有任何 MIME 类型的消息（而不仅仅是 SOAP+XML）。
*   它具有无状态通信，因此不能具有服务器端会话存储。（SOAP 对此没有限制）
*   它为超媒体提供服务，客户端使用该超媒体包含的链接来请求服务。（SOAP RPC 使用 WSDL 文件中描述的操作绑定）
*   它不会因 URL 更改而仅因语义更改而中断。（不使用 RDF 语义的 SOAP RPC 客户端会因 WSDL 文件更改而中断。）
*   由于其无状态行为，它比 SOAP Web 服务更易于扩展。

等等...

SOAP RPC 网络服务不满足所有 REST 约束：

*   客户端-服务器架构 - 总是
*   无状态 -[可能](http://www.ibm.com/developerworks/library/ws-spmyths/)
*   缓存 -[可能](http://weblogs.asp.net/cibrax/caching-strategies-for-soap-and-rest-services)
*   统一的界面——从不
*   分层系统 -[从不](http://weblogs.asp.net/cibrax/caching-strategies-for-soap-and-rest-services)
*   按需编码（可选） - 可能

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-10-11T07:39:07.400

好吧，我将从第二个问题开始：*什么是 Web 服务？*，原因很明显。

WebServices 本质上是公开某些功能或数据的逻辑片段（您可能模糊地称为方法）。客户端实现（从技术上讲，*消费*就是这个词）只需要知道该*方法*将接受的参数是什么以及它将返回的数据类型（如果有的话）。

以下*链接*以极其清晰的方式说明了有关**REST**和**SOAP的全部内容。**

[REST 与 SOAP](http://spf13.com/post/soap-vs-rest/)

如果您还想知道何时选择什么（REST 或 SOAP），那就更有理由去经历它！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-07-04T06:09:09.393

SOAP 和 REST 都指不同系统相互通信的方式。

REST 使用类似于您的浏览器与 Web 服务器的通信的技术来执行此操作：使用 GET 请求网页、在表单字段中发布等。

SOAP 提供了类似的功能，但所有事情都是通过来回发送 XML 块来完成的。SOAP 的另一个关键组件是 WSDL，它是一个 XML 文档，描述了支持的功能和数据元素。WSDL 可用于以编程方式“发现”支持哪些功能以及生成编程代码存根。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-07-20T17:54:23.117

SOAP 的问题在于它与 HTTP 堆栈背后的理想相冲突。任何中间件都应该能够在不了解请求或响应的内容的情况下处理 HTTP 请求，但是例如，常规的 HTTP 缓存服务器在不知道 SOAP 内容的哪些部分对缓存很重要的情况下将无法处理 SOAP 请求。SOAP 只是使用 HTTP 作为它自己的通信协议的包装器，就像代理一样。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-16T19:30:54.217

我认为这很容易解释。拜托，欢迎任何人纠正我或添加到此。

SOAP 是断开系统（如互联网）用来交换信息/数据的消息格式。它处理来回传输的 XML 消息。

Web 服务传输或接收 SOAP 消息。它们的工作方式不同，具体取决于它们所用的语言。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-06-11T10:13:38.090

REST 是一种用于设计网络应用程序的架构风格。这个想法是，不是使用复杂的机制，如 CORBA、RPC 或 SOAP 来连接机器，而是使用简单的 HTTP 在机器之间进行调用。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-02-04T16:34:00.887

***SOAP——“简单对象访问协议”***

**SOAP**只是在 Internet 上传输消息或少量信息。**SOAP**消息采用**XML**格式，通常以控制**HTTP**的方式发送。

***REST – “代表性状态转移”***

**REST**是在粉丝和服务器之间接收和接收信息的基本过程，它没有明确定义许多标准。**您可以以JSON**、**XML**甚至纯文本的形式发送和接受信息。**与SOAP**相比，它是轻量级的。

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2013-10-19T06:46:10.220

基于 SOAP 的 Web 服务 简而言之，基于 SOAP 的服务模型将世界视为一个同等对等点的生态系统，这些对等点不能相互控制，但必须通过遵守已发布的合同来协同工作。它是混乱现实世界的有效模型，基于元数据的合同形成了 SOAP 服务接口。

我们仍然可以将 SOAP 与基于 XML 的远程过程调用联系起来，但是基于 SOAP 的 Web 服务技术已经成为一种灵活而强大的消息传递模型。

SOAP 假定所有系统都是独立的，并且没有任何系统对另一个内部功能和内部功能有任何了解。这样的系统能做的最多的事情就是互相发送消息，并希望它们会被采取行动。系统发布他们承诺遵守的合同，其他系统依赖这些合同与他们交换消息。

系统之间的合同统称为元数据，包括服务描述、支持的消息交换模式和管理服务质量的策略（服务可能需要加密、可靠交付等）。反过来，服务描述是详细的系统将发送和接收的数据（消息文档）的规范。文档使用 XML 描述语言（如 XML Schema Definition）进行描述。只要所有系统都遵守其发布的合同，它们就可以互操作，并且系统内部的更改永远不会影响任何其他系统。每个系统都负责将自己的内部实现与合同进行转换

REST - 具象状态转移。物理协议是 HTTP。基本上，REST 是 Web 上所有可以通过 URL 唯一标识的不同资源。可以对这些资源执行的所有操作都可以通过一组有限的动词（“CRUD”动词）来描述，这些动词又映射到 HTTP 动词。

与 SOAP 相比，REST 的“重量级”要小得多。

[网络服务的工作](http://acs.lbl.gov/projects/gtg/projects/pyGridWare/doc/tutorial/html/x284.html)

# php - 在 PHP 中编译正则表达式

> ID：209906
> 
> 赞同：59
> 
> 时间：2008-10-16T19:25:06.257
> 
> 标签：php, regex

PHP中有没有办法编译正则表达式，以便可以将其与多个字符串进行比较而无需重复编译过程？其他主要语言可以做到这一点——Java、C#、Python、Javascript 等。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-16T20:09:13.657

Perl 兼容的正则表达式库可能已经针对您的用例进行了优化，而无需像其他语言那样提供 Regex 类：

> 此扩展维护已编译正则表达式的全局每线程缓存（最多 4096 个）。
> 
> [PCRE简介](http://www.php.net/manual/en/intro.pcre.php)

这就是[Imran](https://stackoverflow.com/questions/209906/compile-regex-in-php#210027)描述的 study 修饰符如何在调用之间存储编译后的表达式。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-16T19:55:31.063

preg 正则表达式可以使用大写的 S (study) 修饰符，这可能是您正在寻找的东西。

[http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php](http://www.php.net/manual/en/reference.pcre.pattern.modifiers.php)

> **小号**
> 
> 当一个模式要被多次使用时，值得花更多时间分析它以加快匹配时间。如果设置了此修饰符，则执行此额外分析。目前，研究模式仅对没有单个固定起始字符的非锚定模式有用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-08-19T08:59:24.933

线程是脚本当前正在运行的线程。第一次使用后，编译的正则表达式被缓存，下次使用 PHP 不会再次编译它。

简单测试：

```
<?php

function microtime_float() {
    list($usec, $sec) = explode(" ", microtime());
    return ((float)$usec + (float)$sec);
}

// test string
$text='The big brown <b>fox</b> jumped over a lazy <b>cat</b>';
$testTimes=10;

$avg=0;
for ($x=0; $x<$testTimes; $x++)
{
    $start=microtime_float();
    for ($i=0; $i<10000; $i++) {
        preg_match_all('/<b>(.*)<\/b>0?/', $text, $m);
    }
    $end=microtime_float();
    $avg += (float)$end-$start;
}

echo 'Regexp with caching avg '.($avg/$testTimes);

// regexp without caching
$avg=0;
for ($x=0; $x<$testTimes; $x++)
{
    $start=microtime_float();
    for ($i=0; $i<10000; $i++) {
        $pattern='/<b>(.*)<\/b>'.$i.'?/';
        preg_match_all($pattern, $text, $m);
    }
    $end=microtime_float();
    $avg += (float)$end-$start;
}

echo '<br/>Regexp without caching avg '.($avg/$testTimes); 
```

> 带缓存的正则表达式 avg 0.1 不带缓存的正则表达式 avg 0.8

缓存正则表达式使其速度提高 8 倍！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-17T15:34:31.360

正如另一位评论者已经说过的那样，PCRE 正则表达式已经编译，而无需您专门引用它们，PCRE 保留由您提供的原始字符串索引的内部哈希。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-16T19:38:14.700

我不肯定你可以。如果您查看[Mastering Regular Expressions](https://rads.stackoverflow.com/amzn/click/com/0596528124)，第 10 章：PHP 中讨论了一些 PHP 特定的优化技术。特别是使用 S 模式修饰符使正则表达式引擎在应用正则表达式之前对其进行“研究”。根据您的模式和文本，这可以为您带来一些速度改进。

*编辑*：您可以使用[books.google.com](http://books.google.ro/books?id=NYEX-Q9evKoC&dq=Mastering+Regular+Expressions&printsec=frontcover&source=bn&hl=ro&ei=XAraSZv9Kcma_AaTjPXPDA&sa=X&oi=book_result&ct=result&resnum=5#PPA478,M1)查看本书的内容。

# usb - 从 PC 读取吉他英雄或摇滚乐队控制器

> ID：209912
> 
> 赞同：5
> 
> 时间：2008-10-16T19:26:10.840
> 
> 标签：usb

与吉他英雄和摇滚乐队一起使用的“乐器”具有 USB 连接。是否有任何关于如何阅读它们生成的消息的文档或逆向工程信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-09-28T03:18:35.713

此消息可能太旧而无用。

我在运行 Ubuntu 10.04 (2.6.32-25) 的笔记本电脑上使用旧的 Nyko 3rd party Guitar Hero / Rock Band PS3 控制器，我发现 USB HID 模块无法立即识别硬件。它报告错误：“无法设置配置#1，错误-32”。

我开始使用 libusb-1.0 编写一个小型测试应用程序，并且能够直接应用配置。这样做时，我无意中触发了 USB HID 模块接管设备并通过 /dev/input/js* 接口使其可用作输入设备。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:28:17.873

查看[Wiiuse](http://www.wiiuse.net/?nav=docs) - 它支持 Guitar Hero 3 控制器以及 Wiimotes :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T19:28:48.310

根据我的 Google 搜索，Guitar Hero 和 Rock Band 控制器是 USB HID 设备。这意味着它们应该在大多数支持 HID 的机器上即插即用（大多数都支持）。有关详细信息，请参阅 Jan Axelseon 揭示的 USB。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T19:39:41.517

您可以查看[Frets on Fire](http://fretsonfire.sourceforge.net/)项目。这是一款类似 GH 的开源游戏，据我记得文档中说你可以使用 Guitar Hero 控制器而不是键盘。

这里有一些额外的半信息：[Frets on Fire 和 360 Guitar](http://kotaku.com/gaming/guitar-hero/frets-on-fire-and-the-360-guitar-249579.php)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T19:40:14.043

我在我的 WinXP 机器上尝试了 GH3 控制器，它显示为 HID 设备 - 并且显示为游戏控制器 - 所以我怀疑大部分工作已经为你完成了。

试试看...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T20:10:41.610

也许您可以 ping 这些家伙以获取信息？

*   [http://www.dxprog.com/entry/rock-band-drums-on-windows/](http://www.dxprog.com/entry/rock-band-drums-on-windows/)
*   [http://andrewrudson.com/drummachine/main.php](http://andrewrudson.com/drummachine/main.php)

# asp.net - linq中的switch语句

> ID：209924
> 
> 赞同：11
> 
> 时间：2008-10-16T19:28:52.397
> 
> 标签：asp.net, linq

我使用 linq 进行 sql 连接的代码是：

```
var query1 = from u in dc.Usage_Computers
          where u.DomainUser == s3
          select u; // selects all feilds from table

GridView1.DataSource = query1;
GridView1.DataBind(); 
```

我在“Domainuser”表中有一个名为“Operation”的字段，其值类似于“1、2、3”。当我将这些值填充到数据网格时，我想将它们转换为有意义的值，例如如果 Operation 的值为 1，则在 datagrid 中显示为“logon”，如果为 2，则为“logoff”等...

从数据库中检索后如何为它们分配值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-16T20:00:44.237

这种技术似乎并不特别适用于您的问题，但无论如何。

您可以使用 C# 在 LinqToSql 中创建 SQL 案例语句**？:**运营商。

```
var query1 =
  from u in dc.Usage_Computers
  where u.DomainUser == s3
  select new {usage = u, 
    operation =
      u.DomainUser.Operation == 1 ? "login" :
      u.DomainUser.Operation == 2 ? "logoff" :
      "something else"
  }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T19:50:52.523

在您的网格视图中使用模板字段：

```
<asp:GridView ID="gvDomain" runat="server" OnRowDataBound="gvDomain_RowDataBound">
    <Columns>
        <asp:TemplateField>
             <HeaderTemplate>
                 Operation
             </HeaderTemplate>
             <ItemTemplate>
                 <asp:Label id="lblLogon" runat="server" />
             </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

然后使用 gridviews RowDataBound 事件来发现标签并分配其文本：

```
Protected Sub gvDomain_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvStates.RowDataBound
    Dim lblLogon As Label = DirectCast(e.Row.FindControl("lblLogon"), Label)
    Dim drv As DataRowView = DirectCast(e.Row.DataItem, DataRowView)

    If lblLogon IsNot Nothing Then
        Select Case drv("Operation").ToString()
            Case "1" 
                lblLogon.Text = "Logon"
                Break
            Case "2"
                lblLogon.Text = "Logoff"
                Break
            //etc...
        End Select
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T19:59:50.743

```
static Func<int?, string> MapSqlIntToArbitraryLabel = (i =>
{
   // for performance, abstract this reference 
   //  dictionary out to a static property
   Dictionary<int, string> labels = new Dictionary<int, string>();
   labels.Add(1, "logon");
   labels.Add(2, "logoff");
   labels.Add(...);

   if (i == null) throw new ArgumentNullException();
   if (i < 1 || i > labels.Count) throw new ArgumentOutOfRangeException();

   return labels.Where(x => x.Key == i.Value)
                .Select(x.Value)
                .Single();
} 
```

该返回语句也可以表示为：

```
return (from kvp in labels
        where kvp.Key == i.Value
        select kvp.Value).Single(); 
```

然后，您可以像这样从 linq 查询中调用该函数：

```
var query1 = from u in dc.Usage_Computers 
             where u.DomainUser == s3 
             select {
                 Operation = MapSqlIntToArbitraryLabel(u.Operation)
                 // add other properties to this anonymous type as needed
             }; 
```

我已经尝试了所有建议的方法来欺骗 Linq2Sql 运行我的代码，并且这种方法是我发现的唯一一种允许我将代码作为延迟执行投影的一部分运行的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T19:33:29.483

我使用 TemplateFields 做了类似的事情。使用绑定到属性的 ASP:Label 并为控件添加 OnPreRender 事件处理程序。在控件的事件处理程序中，我根据当前值翻译文本并设置新值：

```
protected void label_OnPreRender( object sender, EventArgs e )
{
   Label l = (Label)sender;
   switch (l.Text) {
      case "1":
         l.Text = "Logon";
         break;
       ...
      default:
         break;
   }
} 
```

如果表单处于编辑模式，您需要以不同的方式处理它。您可能还需要将插入和更新处理程序添加到您用来将页面提供的数据转换为其数据库表示的视图控件。

# sql-server - SQL Server 2005 - 在不同的服务器上恢复加密的数据库

> ID：209927
> 
> 赞同：3
> 
> 时间：2008-10-16T19:30:11.660
> 
> 标签：sql-server, sql-server-2005, encryption, symmetric-key

我已经备份了一个加密数据库（对称密钥/证书）并将其恢复到另一台服务器上。

不幸的是，我们在解密时遇到了问题……希望有人能提供帮助。

在恢复的数据库中，我可以在 SSMS 中看到对称密钥和证书，但是当我尝试使用证书打开密钥（通过证书 CertB 打开对称密钥 KeyA 解密）时，我收到以下*非常描述性*的错误：

Msg 15466, Level 16, State 1, Line 1 解密时出错。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T14:30:32.493

[http://blogs.msdn.com/lcris/archive/2007/11/16/sql-server-2005-restoring-the-backup-of-a-database-that-uses-encryption.aspx](http://blogs.msdn.com/lcris/archive/2007/11/16/sql-server-2005-restoring-the-backup-of-a-database-that-uses-encryption.aspx)回答了这个问题：

“当您恢复使用加密功能的数据库时，您只需注意一件事 - 如果数据库主密钥 (DbMK) 需要服务主密钥 (SMK) 加密，则需要重新生成此加密。请注意，当您创建 DbMK 时，默认情况下会进行此加密，但如果您想要更严格地控​​制对加密数据的访问，它可能会被故意丢弃。无论如何，如果您确实对 DbMK 进行了此类 SMK 加密，则重新生成它的步骤是以下：

通过密码打开主密钥解密 = '密码' 更改主密钥 通过服务主密钥添加加密 关闭主密钥

就是这样 - 数据库加密功能现在应该像进行备份时一样工作。另请注意，如果您在进行备份的服务器上或其他地方恢复数据库，则无关紧要。对于此过程，唯一重要的是您知道保护 DbMK 的密码之一“

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-21T15:07:54.540

主密钥由源服务器上的服务主密钥解密，我们在目标服务器上使用密码解密主密钥。我将主密钥更改为由服务主密钥解密，它现在正在工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T22:31:01.997

您可能遇到的问题是服务器的数据库主密钥不同。据我了解，其他密钥基于此，在尝试解密数据时可能会导致问题。查看[加密层次结构](http://msdn.microsoft.com/en-us/library/ms189586.aspx)，了解数据加密步骤的描述。

我希望这个答案有所帮助，并且不会太偏离轨道。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T16:56:27.943

[http://social.msdn.microsoft.com/forums/en-US/sqlsecurity/thread/34c9c35c-2d08-4873-abfd-aae40240dfe7/?prof=required](http://social.msdn.microsoft.com/forums/en-US/sqlsecurity/thread/34c9c35c-2d08-4873-abfd-aae40240dfe7/?prof=required)

该链接对我有用，请按照 2 个链接进行备份/恢复

您可以使用 UNC 从目标服务器进行还原，而不必复制文件。

# linux - Apache 虚拟主机 - xxx.241.214.xxx:80 没有虚拟主机

> ID：209935
> 
> 赞同：1
> 
> 时间：2008-10-16T19:30:43.500
> 
> 标签：linux, apache, ubuntu

我正在尝试在 Ubuntu 服务器上使用 apache 2.x 在新 VPS 上设置虚拟主机。

启动 apache 时出现错误“xxx.241.214.xxx:80 has no VirtualHosts”，并且该站点的 url 仍然指向默认位置，这意味着我的虚拟主机文件没有生效：

```
<VirtualHost xxx.241.214.xxx:80>
ServerName xxx.co.uk
ServerAlias www.xxx.co.uk
DocumentRoot /var/www/vhosts/xxx.co.uk/httpdocs/xxx.co.uk
</VirtualHost> 
```

请帮忙，我不擅长所有这些服务器配置的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T13:44:09.703

我知道你发布问题已经有一段时间了，但我想我会想到

我们目前在这里运行一些内部站点用于不同的目的，它们都监听标准端口 80 和 apache 设置简单如下

```
Listen 80

NameVirtualHost *:80

# Site 1 Comment

<VirtualHost *:80>
  ServerName site1.intranet
  ServerAdmin administrator@whatever.com
  DocumentRoot /var/www/html/site1
</VirtualHost>

#  Site 2 Comment

<VirtualHost *:80>
  ServerName site2.intranet
  ServerAdmin administrator@whatever.com
  DocumentRoot /var/www/html/site2
</VirtualHost> 
```

我们的 DNS 设置为将`http://site1.intranet`等路由到 apache 服务器的 IP，其余的由 apache 配置完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T19:37:47.557

我总是用

```
<VirtualHost *> 
```

（而且 ISTR 总是在指定 IP 和端口号时遇到问题，我认为这就是我现在这样做的原因）。

# asp.net - 在呈现的 HTML 中为自定义 UserControl 提供一个 ID

> ID：209940
> 
> 赞同：4
> 
> 时间：2008-10-16T19:31:12.483
> 
> 标签：asp.net, javascript, user-controls

当我使用 ASP:Calendar 控件并给它一个 ID 时：

`<asp:Calendar runat="server" ID="MyCal" />`

在呈现的 html 中看起来像这样：

`<table id="NameMangled_MyCal"... />`

我可以通过 javascript 中的 ID 访问元素，如下所示：

`var cal= document.getElementById("<%= MyCal.ClientID%>")`

**但是，**当我制作具有日历的自定义用户控件时：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="WeeklyEventsCalendar.ascx.cs"
    Inherits="WeeklyEventsCalendar" %>

<div>
    <asp:Calendar runat="server" ID="InnerCal" Width="100%" OnDayRender="RenderCell" OnVisibleMonthChanged="ChangeMonth" Height="480px" />
</div> 
```

然后在我将它添加到我的页面时给它一个 ID...

`<mvs:WeeklyEventsCalendar ID="WeeklyCal" runat="server" />`

该 ID 不会出现在呈现的 HTML 中的任何位置。我得到的只是

`<div> stuff </div>`

当我想要

`<div id="NameMangled_WeeklyCal"> stuff <div>`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T19:40:12.077

UserControls 只呈现它们的内容，没有别的。你能做的是

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="WeeklyEventsCalendar.ascx.cs"
    Inherits="WeeklyEventsCalendar" %>

<div id="<%= this.ControlID %>">
    <asp:Calendar runat="server" ID="InnerCal" Width="100%" OnDayRender="RenderCell" OnVisibleMonthChanged="ChangeMonth" Height="480px" />
</div> 
```

# ruby-on-rails - Rails 中的路由组织——restful_authentication、session 和 /login

> ID：209953
> 
> 赞同：0
> 
> 时间：2008-10-16T19:37:37.730
> 
> 标签：ruby-on-rails, routes

我正在为 Rails 应用程序的路由设置而苦苦挣扎。我已经安装了 restful_authentication 并且大部分都按照说明进行操作。我以这种方式设置了路线：

```
map.login '/login', :controller => 'sessions', :action => 'new'
map.logout '/logout', :controller => 'sessions', :action => 'destroy'
map.resource :session 
```

如果您没有登录，您将被重定向到[http://localhost:3000/session/new](http://localhost:3000/session/new)。正如 lib/authenticated_system.rb 中的代码所说，它具有某种意义`redirect_to new_session_path`。

但我认为路由映射应该以两种方式工作（代码到 URL 和 URL 到代码）。有人可以解释吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:47:53.870

`map.resource :session`为您创建一些命名资源，包括`new_session_path`（参见[ActionController::Resources](http://api.rubyonrails.org/classes/ActionController/Resources.html#M000697)）。

`map.login`并且`map.logout`只是帮助您的代码更易于理解的路径。`map.login`（生成`login_path`）指向相同的控制器/动作组合`new_session_path`，只是更容易一目了然地记住它的作用。

# mysql - 根据另一个表上的条件查找一个 MySQL 表中的条目

> ID：209963
> 
> 赞同：2
> 
> 时间：2008-10-16T19:40:14.260
> 
> 标签：mysql, conditional, normalization

我有一张硬件表和一张事故表。每个硬件都有一个唯一的标签，事件与标签相关联。

如何选择至少有一个事件列为未解决的所有硬件？

我不能只是加入，因为如果一个硬件有多个未解决的问题，它会出现多次。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T19:41:36.363

```
select distinct(hardware_name) 
from hardware,incidents 
where hardware.id = incidents.hardware_id and incidents.resolved=0; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T19:46:48.320

这样的事情应该这样做：

```
Select A.HardwareID A.HadwareName, B.UnresolvedCount
From (Hardware A) 
Inner Join 
(
  Select HardwareID, Count(1) As UnresolvedCount 
  From Incidents 
  Where Resolved = 0 
  Group By HardwareID
) As B On A.HardwareID = B.HardwareID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-07T06:31:33.103

这也可以工作

```
SELECT hd.name, inc.issue, FROM hardware hd INNER JOIN inc ON hd.tag = inc.tag AND inc.issue = 'unresolved' group by hd.name 
```

# architecture - 管理多种持久性机制

> ID：209966
> 
> 赞同：2
> 
> 时间：2008-10-16T19:41:03.090
> 
> 标签：architecture

我有一组可能以不同方式持久化的业务对象，尽管对于应用程序的任何给定配置，只有一个持久性机制将处于活动状态。持久性是通过接口处理的。

在我看来，显而易见的架构是将一个配置的所有持久性对象放入一个包中，并将不同配置的所有对象放入另一个包中。但似乎这个计划最终可能会导致很多不同的包和包管理问题。这个问题还有其他好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T20:12:28.907

我通过制作一个可重用的存储库在我的公司实现了这一点。

基本上，我创建了一个带有接口的存储库抽象，它对传入的对象或一组对象执行基本的 CRUD 操作。然后我使用各种持久性机制实现了这一点。该库可以将*任何对象*持久化为XML、JSON、二进制或 SQL。所有这些存储库都使用相同的接口，因此所有需要与存储库交互的代码都使用接口，而不是具体的实现。每个实现都存在于它自己的库中，抽象也是如此，因此您只需要分发抽象库和程序所需的任何实现。

在对象模型中没有什么要实现的，因为它使用反射处理通用对象（该库是用 C# 为 .Net 编写的）。

我还让存储库对扩展开放，在某些应用程序中，默认的基于反射的东西被更高效的强类型存储库所取代，但仍然基于通用实现。

希望有帮助。

# javascript - 如何以编程方式在 PDF 文件中注入 JavaScript？

> ID：209972
> 
> 赞同：7
> 
> 时间：2008-10-16T19:42:59.077
> 
> 标签：javascript, pdf

如何以编程方式在 PDF 文件中注入 JavaScript？

可以在没有 Adob​​e Professional 的情况下完成吗？

* * *

我的目标是：我想在打开 PDF 时立即显示打印对话框。

我知道这可以通过嵌入在文档中的 JavaScript 代码来完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T19:46:55.370

如果您使用 Java 进行开发，请查看 iText：[http](http://www.lowagie.com/iText/) ://www.lowagie.com/iText/ 我认为它支持您正在寻找的内容。

还有一些.Net版本：[http ://www.ujihara.jp/iTextdotNET/en/](http://www.ujihara.jp/iTextdotNET/en/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-18T22:28:00.487

iText（和 iText_Sharp_）非常有能力将 JS 添加到现有的 PDF 中……页面操作、链接、文档级脚本，应有尽有。

[JavaDoc 可以在这里找到](http://api.itextpdf.com/)。

这是用 Java 编写的，但 C# 代码看起来几乎相同（如果不完全相同，异常处理会像这样被剥离）。

```
PdfReader myReader = new PdfReader( myFilePath ); // throws IOException
PdfStamper myStamper = new PdfStamper( myReader, new FileOutputStream(outPath) ); // throws IOE, DocumentException

// add a document script
myStamper.addJavaScript( myScriptString );

// add a page-open script, 1 is the first page, not zero0
PdfAction jsAction = PdfAction.javaScript( someScriptString );
myStamper.setPageAction( PdfWriter.PAGE_OPEN, jsAction, myStamper.getWriter(), pageNumber ); // throws PdfException (for bad first param)

PdfFormField button = PdfFormField.createButton(myWriter, PdfFormField.FF_PUSHBUTTON);
button.setWidget( myRectangle, PdfAnnotation.HIGHLIGHT_INVERT );

// the important part, adding jsAction
jsAction = PdfAction.javaScript( buttonScriptString );
button.setAdditionalActions( PdfAnnotation.AA_DOWN, jsAction ); // mouse down

myStamper.addAnnotation( pageNum, button );

myStamper.close(); // write everything out, throws DocumentException, IOE 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-15T15:05:05.253

我已经完成了[PDF Specifications](http://www.adobe.com/devnet/acrobat/pdfs/PDF32000_2008.pdf)的研究。

事实证明，PDF 文件格式并不难。

它有一个很好的功能，可以通过在文件末尾附加新内容来修改文档。

如果你想做同样的事情......不要害怕！去看看规格。

# syntax - 语义和语法是否相同？

> ID：209979
> 
> 赞同：78
> 
> 时间：2008-10-16T19:45:54.577
> 
> 标签：syntax, terminology, semantics

“语义”和“语法”之间的含义有什么区别？这些是什么？

此外，“语义网站与普通网站”、“语义社交网络与普通社交网络”等内容之间有什么区别？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2008-10-16T19:57:27.953

语法就是语法。它描述了构建正确句子的方法。例如，*这个水是三角形*的，在语法上是正确的。

语义与意义有关。*这水是三角形*的，但语法没问题。

谈论[语义网](http://en.wikipedia.org/wiki/Semantic_Web)最近变得很流行。这个想法是用额外的数据来增强标记（使用 HTML 的结构），这样计算机就可以更容易地理解网页。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-16T19:46:53.937

句法是一种语言的语法——构成句子或表达式的规则。

语义是你试图用你的代码表达的意思。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-08T14:26:46.307

语法正确的程序将编译并运行。

语义正确的程序实际上会按照程序员的意图执行您的操作。即它没有任何错误。

两个用不同语言编写以执行相同任务的程序将使用不同的语法，但它们在语义上是相同的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-16T19:51:27.110

如果您在谈论网络（而不是编程语言）：

语言的语法是浏览器（或处理程序）可以合法识别和处理并呈现给您的任何内容。例如，您的浏览器可以呈现 HTML，而您的 API 可以解析 XML 树。

语义涉及实际表示的内容。现在有很多关于语义网和所有这些东西的嗡嗡声，但它本质上意味着每个实体也与一些人类可读的信息或元数据相关联，因此某个标签将具有假定的含义并让您参考它。

社交网络也是如此。你把知识放在链接里

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T22:57:58.293

“蚂蚁吃了阿姨。” 有正确的语法，但在语义上没有意义。句法是一组规则，可以组合起来产生无限数量的语法上有效的句子，但其中很少，很少有语义。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-28T19:20:13.780

句法是句子的词序。在英语中，它将是主-动词-宾语形式。

语义是词背后的意义。例如：她吃了一把锯子。根据句子的含义，saw 一词不匹配。但它在语法上是正确的。所以它的语法是正确的。=)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-17T21:56:00.803

具体来说，语义社交网络意味着在页面标记中嵌入实际的社交关系。[由微格式](http://microformats.org/)定义的执行此操作的标准格式是[XFN](http://www.gmpg.org/xfn/)，XHTML Friends Network。一般来说，对于语义网，[微格式](http://microformats.org/)应该是定义嵌入式语义内容的首选指南。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T19:56:49.780

语义网站使用语义网的概念[，](http://en.wikipedia.org/wiki/Semantic_web)旨在通过使用特殊注释来识别页面中的某些概念，为网页内容带来意义。这使得对内容的自动（通过计算机，而不是人类）推理成为可能，从而改进了其聚合、提取、索引和搜索。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-23T17:52:03.500

上面的解释在语义方面是模糊的，语义可能意味着构建价值论点的不同元素（这些对于最终用户来说是可以理解的，并且对于机器来说是可以消化的）。

当然，这将语义和程序员 - 编辑 - 作家 - 沟通者置于中间：他决定应该为他的公众理想地定义，由他的公众理解，由他的公众的一般约定以及机器计算机可以消化的语义。语义应该是一致的，是概念性的，必须对双方都可以实施。

说脚注、内联和块引用、标题等等，最终形成一个定义明确的有限列表。Mediawiki，wikitext作为一个例子在这个角度上失败了，定义语义元素的语法未定义，没有达成一致的有限列表。“形式意义”作为标题作为示例的附加内容再次作为文本内容。示例“这是一个标题”变成了只是在约定语义范围内通过假设整合的语义，并且可以有不止一组说“这很重要，将详细说明”

Asciidoc 和 pandoc 标记的语义完全不同，无论它们如何通过语法约定将其转换为输出格式。

编程，输出格式如 html、pdf、epub 可以通过形式、语义产生相应的含义，语法作为一种临时的翻译工具已经消失，作为另一个结果，可以自动扫描输出的含义，算法的冠军'grep'：谷歌。根据是否考虑标题或脚注或链接，在“正在查找的内容”中查找“内容”的含义。

语义，并且可以有不止一层，甚至文本消息也带有（乔姆斯基）语义，因此可以按形式翻译为意义，从而对输出链中的任何其他事物（包括人类，读者）产生功能差异。

总而言之，程序员和学者应该结合起来，任何学者都不应该像任何面包和黄油木匠一样不了解他的工具。程序员应该是学者，因为他们完成的桥接的另一端是最终用户，桥梁……很像：语义。

米。

# css - 我怎样才能给每个 它自己的子弹图像？

> ID：209980
> 
> 赞同：19
> 
> 时间：2008-10-16T19:45:57.073
> 
> 标签：css, styling

我试过了

```
<ul id="contact_list">
    <li id="phone">Local 604-555-5555</li>
    <li id="i18l_phone">Toll-Free 1-800-555-5555</li>
</ul> 
```

和

```
#contact_list
{
    list-style: disc none inside;
}

#contact_list #phone
{
    list-style-image: url(images/small_wood_phone.png);
}

#contact_list #i18l_phone
{
    list-style-image: url(images/i18l_wood_phone.png);
} 
```

无济于事。只出现一张光盘。如果我希望每个单独的列表项都有自己的项目符号，我如何使用 css 来完成此操作，***而不使用背景图像***。

编辑：我发现，尽管萤火虫告诉我，list-style-image 规则正在以某种方式被覆盖。如果我内联规则，如下所示：

```
 <li id="phone" style="list-style-image: url(images/small_wood_phone.png);">Local 604-555-5555</li> 
```

那么一切都很好。由于我在选择器中包含 ul 或 li 的测试用例中没有其他规则，因此我不确定为什么内联会给出不同的结果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-16T19:52:43.707

试试这个：

```
#contact_list li
{
    list-style: none;
}

#contact_list li#phone
{
    list-style-image: url('images/small_wood_phone.png');
}

#contact_list li#i18l_phone
{
    list-style-image: url('images/i18l_wood_phone.png');
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T20:14:52.037

我不确定这是否是您的问题，但您使用的是图像的相对链接。当你在css中使用相对链接时，它是相对于css文件的，但如果是内联的，它将是相对于html页面的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T19:53:07.403

问题是，我试过你的代码，它可以工作。唯一不存在的情况是图像不存在。也许您需要检查您在 CSS 中指定的图像是否实际上在文件夹 images 中或没有拼写错误。

注意：在 firefox 和 ie 中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T22:33:15.097

首先确定您是否处于“怪癖”模式，因为对于许多 CSS 属性来说，它会有所不同。

其次，W3c[规定](http://www.w3.org/TR/CSS21/generate.html#propdef-list-style-image)URL 应该用双引号引起来（尽管我也不使用引号）。遵循规范可以为自己省去麻烦。

如果您在 DOCTYPE 中指定“严格”，则浏览器可能需要根据标准使用双引号。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-16T19:49:24.943

我建议在 CSS 中稍作不同 - 即：

```
#contact_list
{
  list-style: none;
}

#contact_list li {
  padding-left: 20px; /* assumes the icons are 16px */
}

#contact_list #phone
{
  background: url(images/small_wood_phone.png) no-repeat top left;
}

#contact_list #i18l_phone
{
  background: url(images/i18l_wood_phone.png) no-repeat top left;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-16T19:55:57.100

您可能会仔细检查这些图像是否在您认为的位置。除非图像丢失，否则此示例工作正常。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-16T20:44:21.713

我从来没想过。如果我引用网址，如下所示：

```
#contact_list #phone
{
    list-style-image: url("/images/small_wood_phone.png");
} 
```

它开始工作。我取消引用它，它停止了。我认为这不应该有所作为。

谢谢大家的帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T19:48:53.510

您可以尝试添加 list-style-type: none; 到#contact-list？甚至可能代替您的 list-style: 声明。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-16T20:30:48.543

建议它让我很痛苦，但是您是否尝试过 !important 标志？另外，它在其他浏览器中的行为是否相同？如果这是您的 Firefox userChrome.css 文件中的内容怎么办？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T20:35:40.640

您可以尝试在 list-style-image 属性之后添加 !important，这样可以防止它被覆盖。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-16T19:50:02.727

```
#contact_list
{
    list-style: disc none inside;
}

#contact_list #phone
{
    background-image: url(images/small_wood_phone.png) no-repeat top left;
    padding-left: <image width>px;
}

#contact_list #i18l_phone
{
    background-image: url(images/i18l_wood_phone.png) no-repeat top left;
    padding-left: <image width>px;
} 
```

# java - Java的代码/模板生成器

> ID：209987
> 
> 赞同：6
> 
> 时间：2008-10-16T19:47:14.450
> 
> 标签：java, templates, code-generation

对于 C#，我经常使用[CodeSmith](http://www.codesmithtools.com/)和最近的[T4 生成器](http://www.hanselman.com/blog/)，它是 Visual Studio 的一部分。

我正在为 Java 寻找类似的东西，特别是 Eclipse 插件，因为我使用 Eclipse IDE 进行所有 Java 开发。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-27T16:31:56.147

我使用过[Velocity](http://velocity.apache.org/)和[StringTemplate](http://www.stringtemplate.org/)。Velocity 更传统一些（想想 JSP/ASP 概念），而 StringTemplate 似乎更干净一些。在[这个 Artima 采访](http://www.artima.com/lejava/articles/stringtemplate.html)中描述的某种意义上。两者都是纯模板引擎，如果您想从模型中生成完整的代码，则需要您围绕它们编写一些代码。

StringTemplate 由[ANTLR](http://www.antlr.org/)内部使用，这可能对您的工作有用。

作为一种替代方法，您可以使用[Eclipse](http://www.eclipse.org/)，使用[EMF](http://www.eclipse.org/modeling/emf/)和[JET](http://www.eclipse.org/articles/Article-JET/jet_tutorial1.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T02:46:14.930

我发现[freemarker](http://freemarker.sourceforge.net/)可以很好地生成任何类型的代码。从网站：

> FreeMarker 是一个“模板引擎”；基于模板生成文本输出（从 HTML 到自动生成的源代码）的通用工具。它是一个Java 包，一个Java 程序员的类库。它本身不是最终用户的应用程序，而是程序员可以嵌入到他们的产品中的东西。

struts2 经常使用它。该网站有一长串使用 freemarker 的其他产品。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-08T17:21:20.690

您应该尝试使用 Telosys Tools，这是一个 Eclipse 插件，用于从具有可定制 Velocity 模板的现有数据库中生成代码

见：[http ://www.telosys.org/](http://www.telosys.org/)

Eclipse 市场：[http ://marketplace.eclipse.org/content/telosys-tools](http://marketplace.eclipse.org/content/telosys-tools)

教程在这里：[https ://sites.google.com/site/telosystutorial/](https://sites.google.com/site/telosystutorial/)

请参阅有关 CodeSmith 的另一个问题：[是否有任何可用的免费软件工具，例如 Codesmith？](https://stackoverflow.com/questions/24035599/is-there-any-freeware-tool-available-which-is-like-codesmith/24323355#24323355)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-08-02T08:14:38.363

我使用[JavaForger](https://github.com/daanvdh/JavaForger)从模板生成代码。它解析现有的类，以便您可以在模板中使用[该类数据。](https://github.com/daanvdh/JavaForger/blob/master/TemplateVariables.md)它既可以创建新类，也可以将代码插入现有类。您可以根据字符串转换规则（例如 myProject/dao/ProductDao.java => myProject/service/ProductService.java）确定将生成的代码插入到何处。

JavaForger 是开源的，使用[FreeMarker](https://freemarker.apache.org/docs/dgui_quickstart.html)作为模板引擎，[JavaParser](https://javaparser.org/)作为解析器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T12:44:19.583

这是一个老问题，但（对于 Java）唯一接近 CodeSmith Generator 所做的是[Spring Roo](http://www.springsource.org/spring-roo)。

原因是 Java 没有像 C# 那样的部分类。Spring Roo 通过使用[AspectJ ITDs](http://spring-roo.blogspot.com/2011/10/quick-introduction-to-aspectj-itd.html)解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-14T17:46:35.197

我的答案是使用 StringTemplate，但它不仅仅是使用什么工具。

生成java代码是问题吗？还是使用java工具？程序员通常会很自在地编写代码。因此，编写一些 java 类并编写将使用 StringTemplate 生成代码的 walk 并不是一个飞跃。我个人认为创建示例模型、从模型生成 Java 代码是一个很好的练习。根据您的用例，您最终可能会手动编写 JSON 模型，而无需编写任何 java 代码来生成 java 代码。或者，您最终可能会编写生成等效模型的 Java 类。

您可以使用读取 JSON的基于[StringTemplate的 STST。](http://hardlikesoftware.com/weblog/2007/04/26/on-learning-stringtemplate/ "STST")STST 是基于命令行的，我相信您可以将它连接到 eclipse 和/或 Visual Studio。

我个人认为可移植性，JSON是一种极其简单的语言。几乎每种语言都有支持它的库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T12:14:41.620

eclipse 有一个内置的模板系统。

查看窗口 -> 首选项 -> java -> 代码样式 -> 代码模板

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T20:01:06.183

我不是 C# 人，所以我不知道等价物是什么，但是我发现[xdoclet](http://xdoclet.sourceforge.net/xdoclet/index.html)在过去非常好。我不认为它与 eclipse 这样集成，但您可以从 ant 脚本运行它。执行诸如从带注释的 Java 类生成 Hibernate 映射文件之类的事情。如果这就是您要寻找的东西，这很有用:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-13T18:25:10.047

我编写了一个简单的基于 Web 的应用程序供我使用。它可在[https://github.com/harish2704/templates](https://github.com/harish2704/templates) 获得，演示可在[http://templates-harish2704.rhcloud.com/](http://templates-harish2704.rhcloud.com/)获得 它的语言独立工具。GUI 支持多种语言（突出显示、片段完成等）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-23T05:07:50.100

看看我的项目[https://github.com/karajdaar/templator](https://github.com/karajdaar/templator)看看是否有帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-10-12T14:52:06.130

你可以看看我的插件： http: [//fast-code.sourceforge.net/](http://fast-code.sourceforge.net/)。它允许选择多个字段并使用用户指定的速度模板生成代码。*****