# StackOverflow 问答 12065000-12065999

# rest - 尝试添加资源类时出现冲突的 URI 模板错误

> ID：12065001
> 
> 赞同：3
> 
> 时间：2012-08-22T00:47:57.030
> 
> 标签：rest, jersey, jax-rs, tomcat7

我有一个使用 Jersey 和 Tomcat7 的完整实现。我的 campher.rest 包中定义了 3 个名为 RegionService、ClientService 和 NoteService 的资源。

当我尝试添加另一个名为 TestResource 的资源并启动 Tomcat 时，它会在下面给出以下错误。我不明白 /{notes} 与 /{test} 有何冲突？？请帮忙，我的头发会感谢你的。

```
Aug 22, 2012 2:23:39 AM com.sun.jersey.api.core.ScanningResourceConfig logClasses
INFO: Root resource classes found:
  class campher.rest.NoteService
  class campher.rest.ClientService
  class campher.rest.TestResource
  class campher.rest.RegionService
Aug 22, 2012 2:23:39 AM com.sun.jersey.api.core.ScanningResourceConfig init
INFO: No provider classes found.
Aug 22, 2012 2:23:40 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.12 02/15/2012 04:51 PM'
Aug 22, 2012 2:23:40 AM com.sun.jersey.spi.inject.Errors processErrorMessages
SEVERE: The following errors and warnings have been detected with resource and/or provider classes:
  SEVERE: Conflicting URI templates. The URI template /{test} for root resource class campher.rest.TestResource and the URI template /{notes} transform to the same regular expression /([^/]+?)(/.*)?
Aug 22, 2012 2:23:40 AM org.apache.catalina.core.ApplicationContext log
SEVERE: StandardWrapper.Throwable 
```

以下是这 4 个服务的框架实现。

```
package campher.rest;
@Path("regions")
public class RegionService {
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Response regions() {}

    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    public Region addRegion(Region region){}

    @PUT
    @Consumes(MediaType.APPLICATION_JSON)
    public Region updateRegion(Region region){}

    @GET @Path("{id}")  
    @Produces(MediaType.APPLICATION_JSON)
    public Response getRegion(@PathParam("id") long id) {}

    @DELETE @Path("{id}")   
    @Produces(MediaType.APPLICATION_JSON)
    public Response deleteRegion(@PathParam("id") long id) {}

    @GET @Path("{id}/clients")  
    @Produces(MediaType.APPLICATION_JSON)
    public Response getClients(@PathParam("id") long id) {}
}

package campher.rest;
@Path("clients")
public class ClientService {
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Response clients() {}

    @GET @Path("{id}")  
    @Produces(MediaType.APPLICATION_JSON)
    public Response getClient(@PathParam("id") long id) {}

    @GET @Path("{id}/notes")    
    @Produces(MediaType.APPLICATION_JSON)
    public Response getNotes(@PathParam("id") long id) {}

    @GET @Path("{id}/alerts")   
    @Produces(MediaType.APPLICATION_JSON)
    public Response getAlerts(@PathParam("id") long id) {}

    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    public Client addClient(Client client){}

    @PUT
    @Consumes(MediaType.APPLICATION_JSON)
    public Client updateClient(Client client){}

    @DELETE @Path("{id}")   
    @Consumes(MediaType.APPLICATION_JSON)
    public Response deleteClient(@PathParam("id") long id){}
}

package campher.rest;
@Path("{notes}")
public class NoteService {  
    @GET @Path("{id}")  
    @Produces(MediaType.APPLICATION_JSON)
    public Response getNote(@PathParam("id") long id) {}

    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    public Note addNote(Note note){}

    @PUT
    @Consumes(MediaType.APPLICATION_JSON)
    public Note updateNote(Note note){}

    @DELETE @Path("{id}")   
    @Produces(MediaType.APPLICATION_JSON)
    public Response deleteNote(@PathParam("id") long id) {}     
}

package campher.rest;
import javax.ws.rs.Path;
@Path("{test}")
public class TestResource {

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:02:51.480

```
@Path("test") 
```

将匹配`<web-root>/test`

```
@Path("{test}") 
```

将匹配`<web-root>/foo`和`<web-root>/bar`。这里的 test 一词仅仅是关联`foo`和`bar`值的路径参数映射键。

`{}`注意名称周围的存在和不存在。它们完全改变了表达式的含义。它们的存在表明您希望将其提取出来并将其放入一个用 注释的实例变量中`@PathParam("name-between-brackets")`。

您`@Path("{test}")`和`@Path("{notes}")`两者本质上都是在要求 Jersey 查找表单的根 URL，`http://<host:port>/<webapp>/{capture-text}`并分别复制`capture-text`into`test`和`notes`path 变量。这是模棱两可的。

# android - 频繁执行dumpsys对Android系统的影响

> ID：12065003
> 
> 赞同：0
> 
> 时间：2012-08-22T00:48:15.190
> 
> 标签：android, linux, memory-management, sampling

我`dumpsys meminfo`每 2 秒执行一次以采样特定 Android 应用程序的内存使用情况。有时，应用程序（甚至模拟器）在应用程序做一些愚蠢的事情（例如，来回旋转屏幕）时崩溃。所以，我想了解“`dumpsys meminfo`频繁执行”如何影响整个系统的状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:21:52.460

我有一个内存监控脚本，它每秒执行几次 dumpsys meminfo 并将信息写入文件，它几乎从不崩溃，但我总是使用物理设备进行测试。

可能是您的模拟器运行速度不够快，无法处理它。Android 模拟器速度非常慢。

# ios - 适用于 iphone 和 ipad 的应用程序的启动图像

> ID：12065006
> 
> 赞同：1
> 
> 时间：2012-08-22T00:48:58.530
> 
> 标签：ios, uinavigationcontroller, uiimageview, uibutton, uisplitviewcontroller

我知道这可能听起来应该是微不足道的，但我发现它很痛苦......

我正在 iPhone 和 iPad 上创建一个应用程序，并希望有一个启动图像。一旦用户单击图像，UI 将转换为 iPhone 上的 TableVC 和 iPad 上的 UISVC。

1）iPhone。我可以在 iPhone 上做到这一点的最简单方法是实际上有一个带有所需图像的按钮（在第一个 VC 上），然后创建一个 IBAction 可以执行以下操作：

```
 MyCustomTVC *myInstanceOfCustomTVC=[self.storyboard instantiateViewControllerWithIdentifier:@"TVC"];
    [self presentViewController:myInstanceOfCustomTVC animated:YES completion:nil]; 
```

现在我可以通过在导航控制器中嵌入 MyCustomTVC 并使用 segues 来保存所有这些工作，但是有没有办法为第一个 VC 隐藏 UINavigationItem？

2）iPad。这有点痛苦，因为我似乎做不到：

```
 UISplitViewController *kmbSvc=[self.storyboard instantiateViewControllerWithIdentifier:@"KMBSvc"];
    [self presentViewController:kmbSvc animated:YES completion:nil]; 
```

SVC 必须是根，所以应用程序如何呈现全屏启动图像，然后转到 SVC。

谢谢九巴

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T03:49:11.087

也许我错过了您的观点，但是“启动映像”是无法关闭的功能-？Apple 将其称为“启动图像”，它是在用户点击应用程序图标时显示的图像，甚至在应用程序加载之前。加载应用程序后，启动图像将替换为您的故事板或 AppDelegate 首先显示的任何内容。不需要转场。

当您选择项目时，您会找到启动图像，然后是目标，然后是“摘要”，然后在“启动图像”部分中，您可以定义纵向和横向、标准和视网膜屏幕的启动图像。

问候，诺比

# .net - SolrNet 中的异步操作

> ID：12065017
> 
> 赞同：1
> 
> 时间：2012-08-22T00:51:55.777
> 
> 标签：.net, multithreading, solr, task-parallel-library, solrnet

是否可以在 SolrNET 中进行遵循 APM（开始，结束）模式的异步操作？我需要在我的 Asp.NET Web 应用程序中对不同的 Solr 搜索索引进行多次异步调用，并且我试图通过使用非阻塞线程来减少线程池的负载。请指教。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:42:02.833

至少查看[SolrNet 源代码](https://github.com/mausch/SolrNet)，虽然 IHttpWebRequest 接口包括 Begin/End 对，但在接口（如 IsolrConnection）中没有使用/暴露更高的对，所以 AFAICT 你必须更改（或重新实现）那些来支持它.

也就是说，可能值得按原样尝试（使用 Task.Run 等启动它们）并查看您是否真的最终使线程池挨饿 - 如果这样做，您可以重新配置它具有更高的限制，毕竟。:)

通过 TAP 使 SolrNet 基于任务可能是一项很大的工作，因为您通常需要通过堆栈的所有级别执行异步/任务（在 SolrNet 的情况下，可能应该只在针对 4.5 的分叉中执行此操作因此它可以依赖新的 HttpClient 及其基于任务的本机调用）

# python - Python，二维数组中的列表索引超出范围

> ID：12065019
> 
> 赞同：1
> 
> 时间：2012-08-22T00:52:19.240
> 
> 标签：python, list

我是 Python 新手，遇到了一堆问题，我需要一些帮助。我有一个 python 函数需要解析一些带有 0 和 1 的简单值。

```
 111000111
 111000111
 101111111
 101100001
 111111111 
```

我需要用 2D 数组存储每个 0，以便以后可以引用这些位置。但是我的索引超出范围，我做错了什么以及如何解决？

这是python代码：

```
def storeSubset(fileName):
locale = dataParser(fileName); test = [];
subset = []; subSetCount = 0; columnCt =0;
rowList = []; columnList=[];
for rowCount in range(0, len(locale)):
#   print " "; print " "
#   print "Values of one row locale[row]: ", locale[rowCount]; 
#   print "We are at row# 'row': ", rowCount;
#   print "Length of row is int(len(locale[rowCount]))", int(len(locale[rowCount]));
    test = locale[rowCount];

    for columnCount in range (0, int(len(locale[rowCount])-1)):
        rowVal = locale[rowCount][columnCount];
#       print "Value of column is :", rowVal;
        if (rowVal==0):
#           print "columnVal = 0, the column position is ", columnCount;
            subset[subSetCount].append(rowList[rowCount]);
            subset[subSetCount].append(rowList[columnCount]);
subSetCount+=1;
print "The Subsets is :", subset;
return subset; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T00:57:42.097

当您拥有时`subset[subSetCount]`，子集仍然是一个空列表，因此索引超出范围。`rowList[rowCount]`和也是如此`rowList[columnCount]`。

从这里开始，我将推测一下您正在尝试做些什么来帮助您修复它。似乎可能而不是

```
subset[subSetCount].append(rowList[rowCount]);
subset[subSetCount].append(rowList[columnCount]); 
```

你只想

```
rowList.append( rowCount )
columnList.append( columnCount ) 
```

然后，在`for columnCount`循环之后，也许你想要

```
subset.append( [rowList, columnList] ) 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T00:58:33.393

我不能 100% 确定你想要做什么，所以我只是在这里暗中刺伤。

```
subset[subSetCount].append(rowList[rowCount]);
subset[subSetCount].append(rowList[columnCount]); 
```

这似乎有问题。您正在附加到一个索引，但我看不到该索引中的任何内容。我假设这是问题所在。也许只是

```
subset.append(rowList[rowCount]) 
```

会完成你什么。

此外，您不需要分号 =D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T01:02:45.963

`numpy`这是一个有用的场合：

```
import numpy as np
with open(datafile) as f:
     lines = [list(l.strip()) for l in f]

array = np.array(lines)
zeros = array == 0
ones = array == 1 
```

# xcode - 故事板：什么是“索引行限制”字段？

> ID：12065020
> 
> 赞同：12
> 
> 时间：2012-08-22T00:52:20.267
> 
> 标签：xcode, cocoa-touch, uitableview, uikit, uistoryboard

在 Storyboards 中，TableView 有一个名为“Index Row Limit”的属性字段。默认值为 2。我找不到任何关于这是什么的信息。[Google 搜索](https://www.google.com/search?q=xcode%20%22index%20row%20limit%22&sugexp=chrome,mod=18&sourceid=chrome&ie=UTF-8)会返回一页结果，其中一半的结果是非英语的。有谁知道这个领域是干什么用的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-24T06:32:33.187

它与 上的`sectionIndexMinimumDisplayRowCount`属性有关`UITableView`。基本上，如果表中的行数少于该行数，则任何部分索引都将被隐藏。（部分索引是表格右侧的栏，通常带有字母 AZ，可让您快速浏览列表。）

**更新**：我已经验证在 .xib 或 .storyboard 中设置“索引行限制”确实会更改底层 XML 中名为 的值`sectionIndexMinimumDisplayRowCount`，因此很明显这就是该属性应该与之相关的内容。但是，UITableView 中似乎也存在一个错误（至少从 iOS 5.1 开始），因此当在运行时取消归档时，Interface Builder 中的设置实际上并未正确设置在对象上。是时候归档雷达了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-30T15:46:56.360

该值**用于决定何时在表格视图右侧显示特殊索引列表**。*如果表视图的行数（总行数）大于或等于此数字，则表视图右侧的索引列表将显示，否则未显示*。

这是 UIKit 文档：

`open var sectionIndexMinimumDisplayRowCount: Int // show special section index list on right when row count reaches this value. default is 0`

# php - PHP __FILE__ 为移动的文件提供了错误的位置

> ID：12065024
> 
> 赞同：3
> 
> 时间：2012-08-22T00:53:16.393
> 
> 标签：php

我正在使用 PHP 解压缩 PHP 应用程序本身的更新。这是通过从更新服务器获取一个 zip 文件，解压缩它，然后递归地将解压缩的文件移动到应用程序当前存在的文件上来完成的。

问题是我下次使用该应用程序时，__FILE__（在至少一个新文件中）给出了最初解压缩 zip 文件的目录中的位置。由于这不是文件的实际位置，因此在使用 __FILE__ 查找当前目录的后续 require 函数调用中出现错误。

最奇怪的部分：我所要做的就是在编辑器中打开文件并重新保存（例如添加和删除空格），然后 PHP 将正确解析文件路径。

有什么想法可能会出错吗？似乎PHP以某种方式“知道”文件来自哪里并且正在获取该信息而不是它当前所在的位置。重新保存文件会使 PHP（或者可能是文件系统）唤醒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:10:25.307

我发现了问题。我应该猜到这是一个缓存问题。问题是服务器正在使用 APC 操作码缓存。我需要此文件位于解压缩文件夹位置中的位置。由于该文件已经存在于 APC 缓存中（具有相同修改日期的完全相同的文件），当它在新位置需要它时，它正在使用 APC 操作码缓存中的缓存文件，包括其旧路径！

似乎是一个错误，它会像那样混淆路径，但修复很容易。如果我在移动文件后重置操作码缓存，它可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:05:55.020

PHP 将文件保存在具有不同名称的临时位置。我的猜测是解压缩过程会在临时目录中创建文件，然后它会移动它们并且找不到文件。

我可能弄错了，不太了解您的问题，但尝试在“移动”操作中输出文件的名称及其路径以及相同的内容

# php - 如何使用 generate:entity 在 Doctrine2 中生成访问器实体

> ID：12065026
> 
> 赞同：0
> 
> 时间：2012-08-22T00:53:20.927
> 
> 标签：php, symfony, doctrine-orm

我正在使用它为 Bundle 中的所有类生成 getter 和 setter。

```
php app/console doctrine:generate:entities Acme/UserBundle 
```

这工作正常。

当我使用它来更新单个实体时，我得到错误

```
php app/console doctrine:generate:entity AcmeUserBundle:User 
```

然后我得到错误

`Entity already exists.`. 但是在多实体方法中，我的实体仍然存在，但它会更新它们

我认为 eingle 实体生成器存在问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:14:26.753

如果您阅读[文档](http://symfony.com/doc/current/book/doctrine.html)，您会意识到这种行为完全符合预期。该命令从代码生成模板创建一个*新*实体，以便为您节省几行样板代码。

# sql-server - 如果字段可以非常小或非常大，我在 T-SQL 中使用哪种数据类型？

> ID：12065028
> 
> 赞同：0
> 
> 时间：2012-08-22T00:53:36.413
> 
> 标签：sql-server, database, tsql, types

假设我在表中有一个列，该列可能包含短至单个字符`'a'`或大至巨大二进制块的信息，可转换为 jpg、png、mp3 等。

我应该为此使用哪种数据类型？

我想`varbinary(max)`or `varchar(max)`，但是如果我只存储一个字符或一个短字符串，它会占用未使用的空间吗？

当字段的数据类型可能具有可变长度时，如何存储数据？

根据这个 qa，[https:](https://dba.stackexchange.com/questions/1767/how-do-too-long-fields-varchar-nvarchar-impact-performance-and-disk-usage-ms) //dba.stackexchange.com/questions/1767/how-do-too-long-fields-varchar-nvarchar-impact-performance-and-disk-usage-ms，没关系，除了这个：

**记忆**

`If the client application allocates memory using the maximum size, the application would allocate significantly more memory than is necessary. Special considerations would have to be done to avoid this.`

我怎么知道这个？对不起，如果我是愚蠢的，但它似乎太模糊了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:34:32.570

如果我是你，我会做的是使用 File-Stream 启用数据库。

您可以在此处了解更多信息：

[http://technet.microsoft.com/en-us/library/bb933993(v=sql.105).aspx](http://technet.microsoft.com/en-us/library/bb933993(v=sql.105).aspx)

网上也有很多信息，所以你在使用它时应该不会遇到任何问题。

通常，您将拥有一个包含许多列的表，其中一个列将以二进制格式或 BLOB（二进制大对象）存储信息。好消息是它可以存储的信息仅取决于您的硬盘驱动器空间，因为它存储在您的驱动器中。在其他列中，您可以有一个类型字段 - 对于 eaxmaple mp3/gpef/avi/etc，它将帮助您的应用程序将此 BLOB 转换为其原始类型。

# google-chrome - 在 chrome 扩展中重定向 URL

> ID：12065029
> 
> 赞同：39
> 
> 时间：2012-08-22T00:53:43.693
> 
> 标签：google-chrome, google-chrome-extension

访问给定 URL 时，如何在扩展程序中重定向 chrome？

例如：当我访问时，`http://yahoo.com/`我希望它重定向到`http://google.com/`

**注意：**此问题的前一个版本询问是否有任何 Google chrome 扩展程序在访问某个 URL 时自动重定向选项卡。因此，以下（目前的两个）答案解决了不同的问题。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-08-22T10:08:43.023

有很多选择，一个比另一个更复杂。

1.  [`webRequest`](https://developer.chrome.com/extensions/webRequest.html)API，特别是[`onBeforeRequest`事件](https://developer.chrome.com/extensions/webRequest.html#event-onBeforeRequest)。（更好的是，即将推出的[`declarativeWebRequest`API](http://developer.chrome.com/extensions/declarativeWebRequest.html)）。
2.  [内容脚本](http://developer.chrome.com/extensions/content_scripts.html)。`location.replace('http://example.com')`在页面中注入。
3.  [`tabs`](http://developer.chrome.com/extensions/tabs.html)API 。使用该[`onUpdated`事件](http://developer.chrome.com/extensions/tabs.html#event-onUpdated)来检测页面何时更改其位置，并[`chrome.tabs.update`](http://developer.chrome.com/extensions/tabs.html#method-update)更改其 URL。避免无限循环！

第一个是最好的，因为它在页面被请求之前就被激活了。第二个可以在请求完成后激活，但在页面呈现之前（`"run_at":"document_start"`）或呈现之后（`"run_at":"document_end"`）。为了完整起见，我提到了最后一个，但您不应该使用它，因为其他选项要好得多。

这是一个使用`webRequest`API 的示例，这是一个简单的扩展程序，它允许我浏览 Pirate bay 上的页面，即使主要主机已被我的 ISP 删除（实际的 URL 列表要长得多，但为了方便起见，我省略了它们的例子）。
有关 URL 格式的说明，请参阅[匹配模式](http://developer.chrome.com/extensions/match_patterns.html)。

## `manifest.json`

```
{
  "name": "The Pirate Bay",
  "description": "Redirect The Pirate Bay to a different host",
  "version": "1.0",
  "manifest_version": 2,
  "background": {"scripts":["background.js"]},
  "permissions": [
    "webRequest",
    "*://thepiratebay.se/*",
    "*://www.thepiratebay.se/*",
    "webRequestBlocking"
  ]
} 
```

## `background.js`

```
var host = "http://tpb.pirateparty.org.uk";
chrome.webRequest.onBeforeRequest.addListener(
    function(details) {
         return {redirectUrl: host + details.url.match(/^https?:\/\/[^\/]+([\S\s]*)/)[1]};
    },
    {
        urls: [
            "*://piratebay.se/*",
            "*://www.piratebay.se/*"
        ],
        types: ["main_frame", "sub_frame", "stylesheet", "script", "image", "object", "xmlhttprequest", "other"]
    },
    ["blocking"]
); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-07-07T12:51:37.783

我知道我回答这个问题有点晚了我仍然想为未来的读者回答这个问题。看一下

## [Requestly](https://chrome.google.com/webstore/detail/requestly-redirect-url-mo/mdnleldcmiljblolnjhpnblkcekpdkpa) - 用于修改网络请求的 Chrome 扩展程序。

目前，您可以设置规则

1.  **将请求 URL重定向**到另一个 URL。
2.  **阻止**一些请求。
3.  **用另一个字符串替换**URL 中的某些部分
4.  **修改标头**（添加/删除/修改请求和响应标头）

截图方便理解：

*   规则列表

> ![规则列表](../Images/f49fa64ca8f4beee0ea39043a19469d7.png)

*   规则类型卡

> ![规则类型卡](../Images/ee0d8f83848aa7e6e06aa5145f257590.png)

*   新的重定向规则

> ![创建重定向规则](../Images/0bc35aa812c267dcefe63a396bc35dc1.png)

*   标头修改规则

> ![修改标题](../Images/8b40289bdc3d20acbc53081277e25b90.png)

路线图中有很多东西需要包括在内，比如

*   切换用户代理

..还有更多。

PS：我已经创建了这个所以如果你觉得这没有帮助你可以责怪我:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-09-14T17:49:43.677

你可以使用我的扩展。转到“重写规则”选项卡，单击“+”按钮并添加新的重写规则。请注意，重写规则实际上是一个正则表达式，因此必须对 / 之类的字符进行转义

[https://chrome.google.com/webstore/detail/dev-helper/kbbgddcndpjnadfacanamniaomcohlcc?hl=en](https://chrome.google.com/webstore/detail/dev-helper/kbbgddcndpjnadfacanamniaomcohlcc?hl=en)

# javascript - 向对象添加新方法和值，同时避免重复

> ID：12065035
> 
> 赞同：1
> 
> 时间：2012-08-22T00:54:50.780
> 
> 标签：javascript, jquery

我正在努力学习面向对象的javascript。我有一个看起来像这样的对象构造函数：

```
//generic object
function myObject(value1, value2, value3){
this.value1 = value1;
this.value2 = value2;
this.value3 = value3;
this.method1 =method1;
}

function method1(){
alert('hello');
}

function method2(){
alert('hello again');
} 
```

我正在创建这个对象的新实例，如下所示：

```
instance1 = new myObject(
1, //value1
2, //value2
3  //value3
) 
```

我的问题是：在 myObject 的一些实例上，我需要自定义值和方法。我想在创建时添加它们。但是如果不再次编写实例名称，我无法弄清楚如何做到这一点，我试图避免这种情况，因为它会显着减慢添加新对象的过程。

有什么方法可以替换此代码..

```
 instance1 = new myObject(
 1, //value1
 2, //value2
 3  //value3
 )
 instance1.method2 =method2;
 instance1.value4 =4; 
```

..不需要重复名称“instance1”的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T01:01:28.437

您可以在 MyObject 上创建更新功能`prototype`

```
function MyObject(value1, value2, value3){
    this.value1 = value1;
    this.value2 = value2;
    this.value3 = value3;
    this.method1 =method1;
}

MyObject.prototype.update = function( args ) {
    for(var name in args) {
        this[ name ] = args[ name ];
    }
};

//using it
var instance1 = new MyObject( 1, 2, 3 );
instance1.update( {
    method2: method2,
    value4: 4
}); 
```

需要注意的是，我将构造函数的名称从`myObject`更改为`MyObject`。在 JavaScript 中，构造函数的名称是帕斯卡大小写而不是驼峰大小写，这是一种约定。这样，当开发人员看到一个帕斯卡大小写的函数时，他们知道他们需要使用`new`关键字。你可以在这里阅读更多：http: [//elegantcode.com/2010/12/21/basic-javascript-part-4-enforcing-new-on-constructor-functions/](http://elegantcode.com/2010/12/21/basic-javascript-part-4-enforcing-new-on-constructor-functions/)

`Learn jQuery and JavaScript`我还建议作为新的 JS 开发人员从 AppendTo.com [http://learn.appendto.com/](http://learn.appendto.com/)查看这个免费系列

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T01:06:18.717

Since you have jQuery available, you can use `jQuery.extend()` and avoid having to retype `instance1`. `jQuery.extend()` copies properties from one object to another.

```
jQuery.extend(instance1, {
    method2: method2
    value4: 4
}); 
```

This will copy all the properties of the second argument to the object in the first argument. See the [jQuery doc](http://api.jquery.com/jQuery.extend/) for more info.

* * *

If you wanted to specify this as part of the constructor, you could do so like this and not have any additional lines of code to type:

```
function myObject(value1, value2, value3, extraProperties){
    this.value1 = value1;
    this.value2 = value2;
    this.value3 = value3;
    this.method1 = method1;
    if (extraProperties) {
        jQuery.extend(this, extraProperties);
    }
} 
```

In that case, you would just code this:

```
var instance1 = new myObject(1, 2, 3, {method2: method2, value4: 4}); 
```

* * *

Of course, the more Object Oriented way to do this would be to create prototypes for each type of object you want (some could inherit from others) and then just instantiate the right type of object rather than add instance-specific methods and properties.

Or, create a single prototype that has all the methods/capabilities you might need on it for all the uses of the object rather than adding instance specific methods. In javascript, there is no penalty for having methods on an object that you don't use sometimes if they are on the prototype. Things on the prototype are free per instance (no storage consumption per instance, no initialization cost per instance, etc...).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:09:03.223

```
function myObject (value1, value2, value3, attributes)
{
    $.extend(this, attributes);
    // the rest of your code
}

// Usage
var obj = new myObject(1,1,1,{ abc: 123, something: "nothing" }); 
```

注意：这不会是全局的。Aka 如果您制作 2​​ 个具有不同属性值的对象，那么它们每个都有自己的自定义属性。如果您想让这些属性影响每个对象，请查看调整它的原型。

# php - 如何通过Codeigniter中的多维数组？

> ID：12065036
> 
> 赞同：0
> 
> 时间：2012-08-22T00:54:52.823
> 
> 标签：php, codeigniter, multidimensional-array

我正试图抓住我在 Codeigniter 中需要的所有变量，然后将这些值传递给视图。

我理解这个概念，但在遍历一个数组并将另一个数组添加到它的每个键上时遇到了困难。

$data['items'] 数组包含通过 get_all() 函数从模型传递的数据。查询基本上是“从项目中选择 *”。

每个项目都有多个功能和图片。为了获得适当的值，我需要一个项目的 id。我可以从第一个数组 ($data['items']) 中获取它，然后将其传递给模型函数。

尝试通过下面的代码执行此操作时，我不断收到各种错误。我已经尝试在 foreach 循环之前定义特征和图片数组 - 仍然会出错。

我确定我的语法是错误的。欢迎任何帮助。

```
$data['items'] = $this->amazon->get_all();
foreach ($data['items'] as $data )
    $id = $data->id;
    $data['features'] = $this->amazon->get_features($id);
    $data['pictures'] = $this->amazon->get_pictures($id);
} 
```

**编辑**

根据反馈，我已将代码更新为此（代码的第 24 - 30 行）：

```
 $items = $this->amazon->get_all();
    for($i=0; $i<count($items);$i++) {
        $data = $items[$i];
        $id = $data->id;
        $items[$i]['features'] = $this->amazon->get_features($id);
        $items[$i]['pictures'] = $this->amazon->get_pictures($id);
    } 
```

PHP 对此抱怨：PHP 致命错误：无法在第 28 行的 /var/www/ci/application/controllers/main.php 中使用 stdClass 类型的对象作为数组

以下是亚马逊模型的功能：

```
function get_all() 
{
    $query = $this->db->get('items');
    return $query->result();
}

function get_pictures($id) {
    $query = $this->db->query("SELECT link FROM pictures WHERE item_id='$id' AND type IN('thumb_set')");
    $style = "border-style:solid; border-width:1px";
    $class = "modal-thumb";
    $results = '';
    foreach ($query->result() as $row) {
        $results .= "<li style='$style' class='$class'><img src='$row->link' alt=''/></li>";
    }
    return $results;
}

function get_features($id) {
    $query = $this->db->query("SELECT content FROM features WHERE item_id='$id' ORDER BY feature_num DESC");
    $results = '';
    foreach ($query->result() as $row) {
        $results .= "<li>";
        $results .= $row->content;
        $results .= "</li>";
    }
    return $results;
} 
```

我想我需要使用'results_array()'而不是'results()'？我的结果是否像现在这样以对象而不是数组的形式返回？

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:04:10.157

As you said, you have syntax error in the foreach statement, you are redefining the $data array.

```
foreach ($data['items'] as $data ) 
```

Try this:

```
$items = $this->amazon->get_all();
for($i=0; $i<count($items);$i++){
    $data = $items[$i];
    $id = $data->id;
    $items[$i]['features'] = $this->amazon->get_features($id);
    $items[$i]['pictures'] = $this->amazon->get_pictures($id);
} 
```

# c++ - 使用 std::inner_product 时内积为零

> ID：12065041
> 
> 赞同：12
> 
> 时间：2012-08-22T00:55:37.120
> 
> 标签：c++, type-conversion, standard-library

下面的 C++ 程序应该返回一个严格的正值。但是，它返回`0`。

发生什么了 ？我怀疑是 int-double 转换，但我不知道为什么以及如何。

```
#include <iostream>
#include <vector>
#include <numeric>
using namespace std;
int main()
{

    vector<double> coordinates;
    coordinates.push_back(0.5);
    coordinates.push_back(0.5);
    coordinates.push_back(0.5);

     cout<<inner_product(coordinates.begin(), coordinates.end(), coordinates.begin(), 0)<<endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-22T01:01:59.123

因为您提供了`0`,的初始值`int`。您的代码在内部等效于：

```
int result = 0;

result = result + 0.5 * 0.5; // first iteration
result = result + 0.5 * 0.5; // second iteration
result = result + 0.5 * 0.5; // third iteration

return result; 
```

虽然`result + 0.5 * 0.5`产生正确的值（在此表达式`result`中提升为`double`），但当该值被分配回 时`result`，它会被截断（该表达式被强制转换为`int`）。你永远不会超越`1`，所以你看`0`。

`0.0`相反，给它一个初始值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T01:00:40.607

这是因为您提供了零作为整数常量。结果运算都是整数，因此最终值 ( `0.75`) 也被截断为 an `int`。

将零更改`0.0`为使其工作：

```
cout << inner_product(coord.begin(), coord.end(),coord.begin(), 0.0) << endl; 
```

这`0.75`在[ideone](http://ideone.com/hpD5r)上产生。

# xpath - 如何处理不一致的标记？

> ID：12065049
> 
> 赞同：1
> 
> 时间：2012-08-22T00:56:21.307
> 
> 标签：xpath, scrapy, web-crawler

我有一个项目，我必须从许多页面中抓取许多 URL。我认为每个页面的结构都将保持不变，但有时它会改变并破坏我的代码。

例如，我需要提取一篇文章的摘要及其关键字，它们都在一个单独`<p>`的同一个类`"marginB3"`中。所以我刮了一个页面，只得到了两个结果，一个是摘要，另一个是关键字：

```
hxs = HtmlXPathSelector(response)
lista =  hxs.select('//p[@class="marginB3"]/text()')  
self.abstracto = lista[0].extract()
self.keywords = lista[1].extract() 
```

然后我尝试了第三页，并`<p>`出现了一个新的页面，其中包含有关该文章的一些附加信息并更改了结构。这使它变得更加复杂，因为没有 id 而只有类。`<p>`如果它们上面有自己的关键字，我如何区分哪个是没有 id 的关键字`<h2>`：

```
<h2>Info</h2>
<p class="marginB3">a_url_I_want</p> 
```

我可以通过阅读`<h2>`然后阅读`<p>`下面的内容来进行区分吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:38:45.367

我不是 XPATH 专家，但我认为您需要查看`following`轴以捕获`<h2>`标记后的项目。

通常，当您尝试解析的文档没有很好地标记时，XPATH 的效果很差。冒着增加更多复杂性的风险，您可以查看诸如[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)模块之类的东西，它允许以更程序化的方式处理不一致的标记。XPATH 是（大部分）声明性语言，而声明性语言很难应对非常规输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T08:25:12.810

你当然可以。

试试这个：

```
# First <p>
hxs.select('//h2/following-sibling::p[@class="marginB3"][1]/text()').extract()
# Second <p>
hxs.select('//h2/following-sibling::p[@class="marginB3"][2]/text()').extract() 
```

# solr - Solr 中以什么顺序过滤器以及控制它的方法？

> ID：12065050
> 
> 赞同：2
> 
> 时间：2012-08-22T00:56:58.103
> 
> 标签：solr, filter, lucene

我理解语义：首先我们执行查询，然后我们将过滤器应用为 DocIdSets（从缓存中获取它们）。

对于某些查询，它是非常低效的，例如，如果主查询是所有文档的复杂双函数（sqrt（流行度）+距离（...）），首先我会为所有索引评估这个函数，然后过滤它。 .

有没有办法在过滤的文档 ID 集上运行原始查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T09:32:40.533

> 首先我们执行查询，然后我们将过滤器应用为 DocIdSets（从缓存中获取它们）。

这不是真的，Solr 只计算所需的分数，这意味着如果任何过滤器与文档不匹配，则不会计算该文档的分数。

但是，它确实需要执行磁盘访问。为了防止这种情况，Solr 具有[useFilterForSortedQuery](http://wiki.apache.org/solr/SolrCaching#useFilterForSortedQuery)选项，如果可用，它将首先在缓存中获取 DocSet，然后在内存中对其进行排序。我想这就是你要找的东西。

# sql - 如何使用 LEFT 子句提高此查询的性能？

> ID：12065052
> 
> 赞同：0
> 
> 时间：2012-08-22T00:57:14.463
> 
> 标签：sql, sql-server

我有一张桌子`TA`，有两列`C1`& `C2`。TA 有 1 亿多行。我运行一个查询来`DISTINCT`获取`C1 WHERE LEFT(C2, 5) = 'XXXXX'`. 我正面临性能问题。获取不同的数据需要几秒钟。

如何提高此查询的性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:08:18.767

通常，您不想在 WHERE 子句中使用字符串函数。

你没有提到 C2 是否被索引。至少如果它被索引，该函数可以应用于索引，而无需读取表中的每一行（扫描）以查看它是否符合您的条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T01:01:21.080

将一个新的文本列添加到您的表中，然后运行一个`UPDATE`查询，将结果`LEFT(C2, 5)`放入该列。索引列，然后运行新查询`WHERE new_column = 'XXXXX'`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T02:09:15.900

您还可以索引您拥有的列，然后尝试执行以下操作：

```
where c2 >= 'XXXXX' and
      c2 < 'XXXXY' 
```

或者：

```
where c2 >= 'XXXXX' and
      c2 <= 'XXXXXZ' 
```

这个想法是将查询从列上的函数切换到范围。如果您有索引，则范围过滤器可以使用列上的索引。

# java - 从 AWS Java API 中，我如何知道我的 EBS 快照何时创建？

> ID：12065059
> 
> 赞同：4
> 
> 时间：2012-08-22T00:58:35.007
> 
> 标签：java, amazon-ec2

我有多个 EBS 支持的 EC2 实例正在运行，我希望能够拍摄其中一个背后的 EBS 卷的快照，从该快照创建一个新的 EBS 卷，然后将该新的 EBS 卷挂载到另一个上作为附加驱动器. 我知道如何通过 AWS Web 控制台执行此操作，但我想通过使用 AWS Java API 来自动化该过程。

如果我只是一个接一个地调用以下命令：

```
CreateSnapshotResult snapRes
    = ec2.createSnapshot(new CreateSnapshotRequest(oldVolumeID, "Test snapshot"));
Snapshot snap = snapRes.getSnapshot();
CreateVolumeResult volRes
    = ec2.createVolume(new CreateVolumeRequest(snap.getSnapshotId(), aZone));
String newVolumeID = volRes.getVolume().getVolumeId();
AttachVolumeResult attachRes 
    = ec2.attachVolume(new AttachVolumeRequest(newVolumeID, instanceID, "xvdg")); 
```

我收到以下错误：

```
Caught Exception: Snapshot 'snap-8e822cfd' is not 'completed'.
Reponse Status Code: 400
Error Code: IncorrectState
Request ID: 40bc6bad-43e0-49e6-a89a-0489744d24e6 
```

为了解决这个问题，我显然需要等到快照完成后再从快照创建新的 EBS 卷。根据[亚马逊文档](http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/ec2/model/Snapshot.html)，Snapshot.getState() 的可能值是“待处理、已完成或错误”，因此我决定与 AWS 联系以查看快照是否仍处于“待处理”状态。我写了以下代码，但它没有工作：

```
CreateSnapshotResult snapRes
    = ec2.createSnapshot(new CreateSnapshotRequest(oldVolumeID, "Test snapshot"));
 Snapshot snap = snapRes.getSnapshot();

 System.out.println("Snapshot request sent.");
 System.out.println("Waiting for snapshot to be created");

 String snapState = snap.getState();

 System.out.println("snapState is " + snapState);
 // Wait for the snapshot to be created
 while (snapState.equals("pending"))
 {
    Thread.sleep(1000);
    System.out.print(".");
    snapState = snapRes.getSnapshot().getState();
 }
 System.out.println("Done."); 
```

当我运行它时，我得到以下输出：

```
Snapshot request sent.
Waiting for snapshot to be created
snapState is pending
............................................. 
```

在我终止程序之前，这些点会继续打印。在 AWS Web 控制台中，我可以看到快照已创建（现在有一个绿色圆圈将其标记为“已完成”），但不知何故我的程序没有收到消息。

当我用简单的等待一秒钟替换 while 循环时（在第一个代码片段中插入该行`Thread.sleep(1000)`）`Snapshot snap = snapRes.getSnapshot();`，程序通常会创建一个新的 EBS 卷而没有抱怨（然后当我尝试将卷附加到新的实例）。但是，有时即使等待一秒钟，我也会收到 IncorrectState 错误。我假设这意味着创建快照（即使是相同的 EBS 卷）所需的时间存在一些差异，并且一秒钟足以解决部分但不是全部可能的延迟时间。

我可以将硬编码延迟增加到肯定比预期时间更长的时间，但是这种方法有很多错误（它在我将使用它的大多数时间都不必要地等待，它仍然不能保证足够长，并且它不会很好地转化为第二步的解决方案，将 EBS 卷安装到实例上）。

我真的很希望能够定期检查 AWS，检查快照的状态是否已更改，然后在更改后继续。我做错了什么，我应该如何修复我的代码以允许我的程序动态确定快照何时完全创建？

编辑：我尝试过使用`getProgress()`而不是`getState()`按照建议。我更改的代码如下所示：

```
String snapProgress = snap.getProgress();

System.out.println("snapProgress is " + snapProgress);
// Wait for the snapshot to be created
while (!snapProgress.equals("100%"))
{
    Thread.sleep(1000);
    System.out.print(".");
    snapProgress = snapRes.getSnapshot().getProgress();
}
System.out.println("Done."); 
```

我得到与使用`getState()`. 我认为我的问题是我的代码引用的快照对象没有正确更新。有没有比简单地重复调用它的方法更好的方法来刷新/更新该对象？我怀疑我在 API 处理请求的方式上遇到了某种问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T21:13:39.190

解决了。我认为问题在于`Snapshot.getState()`调用实际上并没有对 AWS 进行新调用，而是在对象创建时不断返回对象的状态（这将始终处于挂起状态）。

我使用以下`describeSnapshots()`方法解决了这个问题：

```
String snapState = snap.getState();
System.out.println("snapState is " + snapState);

System.out.print("Waiting for snapshot to be created");
// Wait for the snapshot to be created
while (snapState.equals("pending"))
{
    Thread.sleep(500);
    System.out.print(".");
    DescribeSnapshotsResult describeSnapRes 
        = ec2.describeSnapshots(new DescribeSnapshotsRequest().withSnapshotIds(snap.getSnapshotId()));
snapState = describeSnapRes.getSnapshots().get(0).getState();
 }
 System.out.println("\nDone."); 
```

这每次都会对 AWS 进行适当的调用，并且可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:48:23.333

而不是 getstate() ，尝试使用 getProgress() 方法。如果您将其设为空白，则您的 EBS 快照尚未准备好。它以字符串百分比格式提供输出（快照准备就绪时为 100%）。希望它可以解决问题。让我知道它是否有效。

# string - 如何检查 Erlang 中是否有许多字符串不为空？

> ID：12065061
> 
> 赞同：2
> 
> 时间：2012-08-22T00:59:34.897
> 
> 标签：string, erlang, conditional

我有`S1`，`S2`并且`S3`，我想做一些类似的东西：

`if S1 != "" and S2 != "" and S3 != "" then do something`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T06:03:21.113

如果所有内容都必须为空才能执行某些操作，

```
情况 {S1,S2,S3} 的
    {[],[],[]} -> %% 空
    _ -> %% 不为空
结尾。

```

如果你需要知道哪个是空的

```
情况 {S1,S2,S3} 的
    {[],[],[]} -> %% 空
    {[],_,_} -> %% S1 为空
    {_,[],_} -> %% S2 为空
    {_,_,[]} -> %% S3 为空
结尾。

```

更简洁的代码！！

* * *

**编辑**

```
案例列表：member(true,[Each =:= [] || Each <- [S1,S2,S3]]) 的
    真->
        %% 至少其中一个是空的
    假->
        %% 都不是空的
结尾。

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T01:13:46.330

注意 Erlang 中的字符串只是整数列表，您可以执行以下操作：

```
case S1 =/= [] andalso S2 =/= [] andalso S3 =/= [] of
  true -> do_something;
  false -> do_something_else
end 
```

使用`""`而不是`[]`也可以。

# c# - 获取属性会影响结构的大小吗？

> ID：12065065
> 
> 赞同：3
> 
> 时间：2012-08-22T01:00:19.410
> 
> 标签：c#, properties, struct, get, size

我有一个结构可能比类更可取的情况：

*   包含 3 个布尔值
*   是不可变的
*   从不装箱

但是，我想添加一些只有 get 访问权限的属性，它们提供了上述 3 个布尔值的组合。例如，布尔值是“Same”、“Forward”和“Backward”。属性将是“All”、“None”、“UniDirectional”、“BiDirectional”等等，这可以从前 3 个中确定。

这些属性会增加堆栈上每个结构实例的大小，从而使类更合适吗？还是不会影响选择？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T01:02:38.183

简短的回答：

不，他们没有。

长答案：

不，他们没有；但...

属性本身只是常规方法，但具有类似字段的语法。因为方法只存在于内存中的一个位置（因为它们对于该类型的每个对象都是相同的）它们不会影响每个实例的大小。请注意，虚拟方法（包括虚拟属性）有点混乱，因为添加新的虚拟方法会增加 vtable 的大小，但是每个类只存在一个 vtable；但这没有实际意义，因为结构在 .NET 中没有 vtable（在 C++ 中它们有，但这是因为结构和类在语义上是相同的）。

“属性”可以增加结构类型的内存大小，但前提是编写它们的人不熟悉“自动属性”。C# 3.0 引入了自动实现的属性（或简称为“自动属性”），其中一个隐藏字段由编译器为琐碎的 getter/setter 属性创建。语法是`public PropertyName { get; set; }`.

返回主题：只有实例成员字段会影响结构的大小，除非您在使用自定义 StructLayout 时有重叠的字段（这是您`union`在 C# 中创建 s 的方式）。请注意，静态成员不会影响实例的大小，但是在 VB 中`Static`，当用于局部变量时，关键字会影响实例大小（尽管同一个词，“静态”，`Static`在 VB 中标记的局部变量不在类 static状态）。

最后，请注意，在 .NET 中存在与值相关的开销，但这些开销是 .NET 的“托管”性质所固有的，但它们不适用于互操作场景中使用的结构（即指针算术和`sizeof`所有工作都可以正常工作）在 C/C++ 下）。

# google-docs - Dart 应用程序如何从谷歌电子表格中读取单元格数据

> ID：12065071
> 
> 赞同：4
> 
> 时间：2012-08-22T01:01:47.383
> 
> 标签：google-docs, gdata, google-docs-api, dart

将 google docs 电子表格中的数据读取到 dart web 应用程序中需要哪些可能的选项和设置？dart 是否需要 gdata REST api 的包装器来执行此操作？是否有任何飞镖项目或示例与谷歌文档交互？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T01:07:41.273

较新的 Google API 具有通用 API 基础架构，其中客户端库始终是最新的。Dart 有一个这样的客户端库（http://docs.google-api-dart-client.googlecode.com/git/index.html）。

但是，看起来 Google 电子表格仍在使用称为 GData 的旧 API 基础架构。据我所知，没有适用于 Dart 的 GData 客户端库。

因此，我认为最明智的做法是进行原始 HTTP 调用。我不确定您是尝试在客户端还是服务器上执行此操作。如果您尝试在客户端上执行此操作，则必须确保 Google 电子表格支持 CORS。

如果你碰巧在服务器上使用了不同的编程语言，那么就会有一个用于该语言的 GData 客户端库。请参阅（https://developers.google.com/google-apps/spreadsheets/#setting_up_your_client_library）。

# python - 学习 Python，Python Web 应用程序在请求之间保持活跃

> ID：12065072
> 
> 赞同：0
> 
> 时间：2012-08-22T01:01:55.630
> 
> 标签：python

我是一名学习 Python 的 PHP 程序员，只要我有机会。

我读到 Python Web 应用程序在请求之间保持活动状态。这意味着数据保留在内存中并且在请求之间可用，对吗？

我想知道这是如何工作的。

在 php 中，我们放置一个带有唯一令牌的 cookie，并将数据保存在会话中。会话是数组，保存在磁盘或数据库上。在请求会话函数之间，根据具有唯一令牌的 cookie 恢复正确的会话数组。这意味着每个浏览器都有自己独特的会话，并且会话具有预设的到期时间。如果用户处于非活动状态并且触发了过期获取，则会话将被清除。当用户回来时，必须创建一个新会话。

我的理解是 Python 不需要这个，因为应用程序在请求之间保持活动状态。

在 Python 中不是每个请求都有一个唯一的线程吗？

它如何区分请求，请求者是谁？

是否有一种处理方法来分隔用户和应用程序之间的变量？

假设我保存了一个字典，这个字典在来自任何浏览器的所有请求之间是全局可用的，还是仅对那个浏览器可用。

何时以及如何清除内存。如果一切都留在记忆中。如果应用程序运行了几年而没有重新启动怎么办。必须有某种过期设置或内存处理？

一位评论者说这取决于网络应用程序。所以我正在使用 Bottle.py 来学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T09:16:26.460

[在使用Twisted 的](http://twistedmatrix.com/trac/)Web 服务器之前，我能够在请求之间在 Python 中保留一个对象。我没有尝试亲自查看它是否在浏览器中持续存在，但我有一种感觉。这是文档中的代码片段：

> Twisted 包括一个事件驱动的 Web 服务器。这是一个示例 Web 应用程序；**注意资源对象如何在内存中持久存在**，而不是在每次请求时重新创建：

```
from twisted.web import server, resource
from twisted.internet import reactor

class HelloResource(resource.Resource):
    isLeaf = True
    numberRequests = 0

    def render_GET(self, request):
        self.numberRequests += 1
        request.setHeader("content-type", "text/plain")
        return "I am request #" + str(self.numberRequests) + "\n"

reactor.listenTCP(8080, server.Site(HelloResource()))
reactor.run() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:40:23.577

是和不是。如果您[查看这个问题](https://stackoverflow.com/questions/11999198/how-can-i-share-a-dict-between-two-different-http-requests)，您就会了解它如何适用于 Django 应用程序。

但是，按照您所说的方式，它不起作用。在一个请求中定义一个字典而不将其传递到某个地方以使其在后续请求中可访问显然不会使其在进一步的请求中可用。所以，是的，你可以选择这样做，但它不是开箱即用的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:15:22.820

我认为答案将取决于您在 python 中使用的 Web 应用程序框架。其中一些具有会话管理部分，可以跨请求跟踪用户。但是，如果您只有一个基本的端口侦听器来响应 http，则您必须自己构建任何 cookie 支持或会话管理。

另一个很大的区别是，在 php 中，您在服务器上安装了一个模块，实际的 http 服务器委托给该模块以生成响应。PHP 不处理响应的路由或实际服务。其中 python 实际上可以是服务器和生成响应的资源。这取决于运行服务器的机器上如何安装/访问 python。因此，从这个意义上说，您可以在 python Web 应用程序中做任何您想做的事情。

如果你有兴趣，你应该看看一些可用的[python web 框架](http://wiki.python.org/moin/WebFrameworks)。

编辑：我看到你提到了bottle.py，并且开箱即用，它不提供身份验证和会话管理，因为它是一个用于快速原型设计的微型框架，不一定适合大型应用程序（尽管并非不可能，只是很多工作）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T10:15:59.980

首先你应该了解python中**局部**变量和**全局**变量的区别，以及**线程本地存储**是如何工作的。

这是一个（非常）简短的解释：

*   **全局**变量是在模块范围内声明的变量，并由所有线程共享。只要进程正在运行，它们就会存在，除非明确删除
*   **局部**变量是在函数内部声明并在每次调用该函数时实例化的变量。当函数结束时它们会被删除，除非它仍然在其他地方被引用。
*   **线程本地**存储允许定义特定于当前线程的全局变量。除非明确删除，否则与当前线程运行时一样活跃。

现在我将尝试回答您最初的问题（答案是特定于bottle.py，但它是python Web 服务器中最常见的实现）

`Doesn't each request get a unique thread in Python?`

每个**并发**都有一个单独的线程，未来的请求可能会重用以前的线程。

`How does it distinguish between requests, who the requester is?`

bottle.py 使用线程本地存储来访问当前请求

`Is there a handling method to separate vars between users and application?`

听起来你正在寻找一个`session`. 如果是这样，则没有标准的方法，因为不同的实现方式各有优缺点。例如[，这](http://bottlepy.org/docs/dev/recipes.html#keeping-track-of-sessions)是一个用于会话的 bottle.py 中间件。

> 假设我保存了一个字典，这个字典在来自任何浏览器的所有请求之间是全局可用的，还是仅对那个浏览器可用。何时以及如何清除内存。
> 
> 如果一切都留在记忆中。如果应用程序运行了几年而没有重新启动怎么办。必须有某种过期设置或内存处理？

确切地说，必须有一个过期设置。由于您使用的是自定义字典，因此您需要一个计时器来检查字典中的每个条目是否过期。

# php - 浏览器不会立即显示收到的套接字数据

> ID：12065076
> 
> 赞同：2
> 
> 时间：2012-08-22T01:02:18.080
> 
> 标签：php, sockets, browser

```
<?php
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_bind($socket, '127.0.0.1', 100);
socket_listen($socket);
$client = socket_accept($socket);
socket_write($client, 'output');
sleep(10);
socket_close($client);
socket_close($socket);
?> 
```

当我去终端并输入时，`nc localhost 100`我会立即得到*输出*，如我所愿。
但是当我`localhost:100`在浏览器的地址栏中输入“ ”时，10秒后会显示单词*输出。*

**但！**
如果我将代码更改为：

```
<?php
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_bind($socket, '127.0.0.1', 100);
socket_listen($socket);
$client = socket_accept($socket);
$str = '';
for ($index = 0; $index < 4096; $index++) {
    $str .= ' ';
}
socket_write($client, $str);
socket_write($client, 'output');
sleep(10);
socket_close($client);
socket_close($socket);
?> 
```

发送请求后，我立即在浏览器上获得*输出（以及之前的所有空格）。*

如何在不发送大量数据的情况下立即在浏览器中获取*输出？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T09:07:39.030

您可能会看到这种行为，因为在第一种情况下，您发送的数据太小，因此输出缓冲区可能会一直保留它，直到填充足够的数据或关闭连接。

尝试在每次写入后使用`ob_implicit_flush()`或显式调用刷新数据：`ob_flush()`

```
<?php
ob_implicit_flush();
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_bind($socket, '127.0.0.1', 100);
socket_listen($socket);
$client = socket_accept($socket);
socket_write($client, 'output');
sleep(10);
socket_close($client);
socket_close($socket);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T09:34:08.690

1.  有可能启用的 PHP 的输出缓冲。按照 Samyam A 的描述刷新缓冲区。或者使用以下命令禁用它： using ob_end_flush();

2.  浏览器本身可能会忽略数据，直到超过某个限制 (~1KB) 或连接已关闭。这是由于一些优化。他们假设文档的前 1KB 没有足够的有用信息来呈现文档的预览。解决方案：在开始时发送 1KB 的虚拟数据（例如空格）。然后正常发送数据。

3.  可能有病毒扫描程序或工具栏充当代理服务器，它以首先获取完整数据块（甚至整个文档）的方式处理 HTTP 流，然后在完成后处理并转发该块. 如果您在端口 100 上工作，则不应发生这种情况（这是防止此类工具延迟数据流的常用技巧）。更多的是你在 localhost 工作。如果您之间确实有互联网提供商（尤其是移动网络运营商），您的数据可能会通过透明代理服务器传输，这也会导致此类问题。

# wso2 - 如何以纯文本格式访问 Carbon 服务器上的服务参数

> ID：12065082
> 
> 赞同：0
> 
> 时间：2012-08-22T01:02:58.887
> 
> 标签：wso2, ws-discovery, wso2carbon

我所做的是破坏了我的 WSO2 DSS 上的默认“版本”服务，我尝试为 WS-Discovery 设置 Scopes 变量，并且在创建参数时没有放置结束标记/元素。
现在，当我尝试访问参数屏幕时，出现 xml Parse 错误

`TID: [0] [WSO2 Data Services Server] [2012-08-22 12:38:04,404] ERROR {org.wso2.carbon.service.mgt.ServiceAdmin} - Error occured while getting parameters of service : Version {org.wso2.carbon.service.mgt.ServiceAdmin}org.apache.axiom.om.OMException: com.ctc.wstx.exc.WstxUnexpectedCharException: Unexpected character '<' (code 60) in end tag Expected '>'. at [row,col {unknown-source}]: [2,58] at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:296) at`

我假设这存储在 H2 数据库中，我尝试使用记事本在 .db 文件中查找参数，但找不到。还有另一种连接/浏览 H2 数据库的方法吗？我已经扫描了存储库、数据库和 conf 目录以寻找线索，但没有成功。

更新：是的，您可以使用工具菜单下的数据库资源管理器连接到 H2 db。
使用 repository/conf/registry.xml 文件中的连接详细信息
然后您可以对其进行 SQL 查询 - （虽然我还没有找到答案）

更新 2：我不认为参数保存在 H2 数据库中，但我设法通过以下方式解决了我的问题：

1.  使用列表服务页面上的链接下载 Version.aar 文件
2.  删除版本服务
3.  将 Version.aar 文件复制到 repository/deployment/server/axis2services 目录

我想删除该服务会删除对我损坏的参数的任何记录/引用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T04:51:18.143

我相信您尝试过通过 UI 设置服务参数？通常，您通过 UI 指定的服务参数不会保存在原始 axis2 服务存档的 services.xml 中。相反，它们保存在 DSS 附带的注册表中，并在运行时应用到服务。但是，如果您指定了格式错误的参数，则不会将其保存在注册表中，而是在尝试使用该参数时引发异常。所以不会有对应于这种格式错误的参数的记录保存。

希望这可以帮助！

干杯，普拉巴斯

# php - uploading videos to server error

> ID：12065083
> 
> 赞同：-2
> 
> 时间：2012-08-22T01:03:04.860
> 
> 标签：php, html

i need your help, im trying to upload video files to server, below are videoadmininsert.php, this file is what the user see, and videosave.php, is where the verification for the file are made , then save the file on a folder in the server. the problem is when a choose a video file,for example the one i'm trying to upload got 25mb and the format is wmv, the server say that the file choosen was not the correct file extension. videoadmin.php

```
<?php
session_start();
$host="localhost"; // Host name
$username="ccili_userccili"; // Mysql username
$password="xxxxxxxxxxxxxxxx"; // Mysql password
$db_7name="ccili_BD"; // Database name
$tbl_name="Video"; // Table name

// Connect to server and select databse.
$con=  mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

mysql_query("SET NAMES 'utf8'");
$_SESSION['whattodo']="insert";
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org    /TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
   <title>Camara do comercio e industria Portugal - Iraque</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
   <link rel="stylesheet" type="text/css" href="StyleSheet.css" />

</head>
<body onload="display_ct(),display_ct2();">

<div id="wrap">
<div id="header">
 <div id="Div1">
<div class="row dropdown-container fixed">
<div class="col-220">
<a id="logo" title="Back to amin" href="login_sucess.php">
<img width="220" alt="logo" src="../Images/logo.jpg"/>
</a>
</div>
<div class="col-701 last">
<p>&nbsp;</p>
<p class="get-in-touch">
<img width="14" height="10" alt="" src="../Images/flagpt.jpg"/>
<strong>
<script type="text/javascript">
    function display_c() {
    var refresh = 1000; // Refresh rate in milli seconds
    mytime = setTimeout('display_ct()', refresh)
}

function display_ct() {
    var strcount
    var x = new Date()
    var horas = x.getHours();
    var min = x.getMinutes();
    var sec = x.getSeconds();
    if (horas < 10) {
        horas = "0" + horas;
    }
    if (min < 10) {
        min = "0" + min;
    }
    if (sec < 10) {
        sec = "0" + sec;
    }

    document.getElementById('ct').innerHTML = horas + ":" + min + ":" + sec + " ";
    tt = display_c();
}

      </script> <span id='ct' ></span>
</strong>
<img width="14" height="10" alt="" src="../Images/flagiraque.jpg"/>
<strong>
<script type="text/javascript">
function display_c2() {
    var refresh = 1000; // Refresh rate in milli seconds
    mytime2 = setTimeout('display_ct2()', refresh)
}

function display_ct2() {
    var strcount
    var x = new Date()
    var horas1 = x.getHours() + 2;
    var min1 = x.getMinutes();
    var sec1 = x.getSeconds();

    if (horas1 < 10) {
        horas1 = "0" + horas1;
    }
    if (horas1 > 24) {
        horas1 = "0" + (horas1 - 24);
    }

    if (min1 < 10) {
        min1 = "0" + min1;
    }
    if (sec1 < 10) {
        sec1 = "0" + sec1;
    }
    document.getElementById('ct2').innerHTML = horas1 + ":" + min1 + ":" + sec1 + " ";
    tt1 = display_c2();
}

</script> <span id='ct2' ></span>
</strong>
</p>
<p class="text-right">غرفة التجارة و الصناعة البرتغالية العراقية</p>
<p class="text-right1">Câmara do Comércio e Indústria Portugal-Iraque</p>
<p class="text-right">ژووری بازرگانی عیراق پۆرتگال</p>

</div>
</div>
</div>
</div>

<div id="content">
<div class="hr">
<p class="text-rightLogout"><a href="logout.php">Log Out!!!</a></p>
 </div> 
<div class="row fixed">
<div class="col-220">
<ul id="news-box">
<FORM name="form1" method="post" action="checkbutton.php">
<p><b>Home</b>
<INPUT TYPE="submit"  name ="Button1" ID="Button1" VALUE="Edit Home."  style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button2" ID="Button2" VALUE="Edit Culture PT" style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button3" ID="Button3" VALUE="Edit Culture IRAK" style="width:200px; height:30px;">
<b>About Us</b>
<INPUT TYPE="submit" name="Button4" ID="Button4" VALUE="Edit Mensagem Presidente"  style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button5" ID="Button5" VALUE="Edit Administration Board"  style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button6" ID="Button6" VALUE="Edit Consultive Board" style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button7" ID="Button7" VALUE="Edit General Assembly"  style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button8" ID="Button8" VALUE="Edit Financial Council"  style="width:200px; height:30px;">
<INPUT TYPE="submit"  name ="Button9" ID="Button9" VALUE="Edit Founding Members"  style="width:200px; height:30px;">
<b>Protocols</b>
<INPUT TYPE="submit"  name="Button10"ID="Button10" VALUE="Edit Protocols"     style="width:200px; height:30px;">
<b>Links</b>
<INPUT TYPE="submit"  name="Button11" ID="Button11" VALUE="Edit Links" style="width:200px;height:30px;">
<b>Photos/News/Videos</b>
<INPUT TYPE="submit"  name="Button12"ID="Button12" VALUE="Edit News" style="width:200px; height:30px;">
<INPUT TYPE="submit"  name="Button13"ID="Button13" VALUE="Edit Photos" style="width:200px;height:30px;">
<INPUT TYPE="submit"  name="Button14"ID="Button14" VALUE="Edit Videos" style="width:200px;height:30px;">
<b>Associates</b>
<INPUT TYPE="submit"  name="Button15"ID="Button15" VALUE="Edit How To Join" style="width:200px;height:30px;">
<INPUT TYPE="submit"  name="Button16"ID="Button16" VALUE="Edit List of Members" style="width:200px;height:30px;">
<INPUT TYPE="submit"  name="Button17"ID="Button17" VALUE="Edit Associates Prime" style="width:200px;height:30px;">
<b>Contacts</b>
<INPUT TYPE="submit"  name="Button18"ID="Button18" VALUE="Edit Adress" style="width:200px;height:30px;">
</FORM>
</p>
</ul>
</div>
<div class="col-460">
<?php
        echo "<center><h1>Videos</h1></Center>";
echo "<center><h1>Insert</h1></Center>";

 ?>

<form action="VideosAdminSave.php" method="post"
enctype="multipart/form-data">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Insert Video</strong></td>
</tr>
<tr>
<td width="78">Title</td>
<td width="6">:</td>
<td width="294"><input name="title" type="text" id="title"></td>
</tr>
<tr>
<td width="78">Text</td>
<td width="6">:</td>
<td width="294">
<?php
echo "<input type='textarea' name='text1'  size='61'> </textarea>" ;

?>
</td>
</tr>
<tr>
<td>File</td>
<td><label for="file">Filename:</label></td>
<td><input type="file" name="file" id="file" /></td>
</tr>
<tr>
<td><input type="submit" name="submitVideos" value="Submit" /></td>
</tr>
<input name="MAX_FILE_SIZE" value="40971520" type="hidden">

</table>
</td>
</form>

  </div>
</div>
<div id="footer">
<div class="row fixed">
<div class="col-220">
    <p >

        <img width="130" height="70"   alt="emb" src="Images/smartcom.jpg"/><br>
<strong>
&copy; 2012
<a href="http://www.smartcom.pt">Smartcom,
        <br/></a>Intelligent Communications&nbsp;

</strong>
</p>
<p >
All rights reserved.
<br/>

</p>
</div>
<div class="col-460 ">

</div>
</div>
</div>
</div>
</div>  

</body>
</html> 
```

And here goes the videosadminsave

```
<?php

session_start();
$host="localhost"; // Host name
$username="ccili_userccili"; // Mysql username
$password='xxxxxxxxxxxx'; // Mysql password
$db_name="ccili_BD"; // Database name
$tbl_name="Video"; // Table name

// Connect to server and select databse.
$con=  mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

if(isset($_POST['Videos']))
{

 $delete=$_POST['Videos'];
 mysql_query("DELETE FROM Videos WHERE titulo='$delete' ");
 echo "<script type='text/javascript'> 

  window.location = ('VideosAdmin.php');
</script>";
  }
   $title=$_POST['title'];
//echo $namept;
$texto=$_POST['text'];

 $path="Videos/";

 $allowedExts = array("avi", "mp4", "flv","mpeg","3ggp","wmv");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "video/mp4")
|| ($_FILES["file"]["type"] == "video/avi")
|| ($_FILES["file"]["type"] == "video/flv")
|| ($_FILES["file"]["type"] == "video/mpeg")
|| ($_FILES["file"]["type"] == "video/wmv")
|| ($_FILES["file"]["type"] == "video/3ggp"))
&& ($_FILES["file"]["size"] < 100000000000000000000000000000000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
{
 //echo "<script type='text/javascript'>
 //alert("Return Code: " . $_FILES["file"]["error"] . "<br />");
 //</script>"; 
//echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
 echo "<script type='text/javascript'> alert('Invalid File');window.location = ('VideosAdminInsert.php'); </script>";
  }
else
{
//echo "Upload: " . $_FILES["file"]["name"] . "<br />";
//echo "Type: " . $_FILES["file"]["type"] . "<br />";
//echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
//echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

if (file_exists($path . $_FILES["file"]["name"]))
  {

  //echo $_FILES["file"]["name"] . " already exists. ";
  //header("Location: editmsghome.php");
  echo "<script type='text/javascript'> alert('The file already exist, please change the file name.');window.location = ('VideosAdminInsert.php');
</script>"; 

  }
else
  {
  move_uploaded_file($_FILES["file"]["tmp_name"],
  $path . $_FILES["file"]["name"]);
        //header("Location: editmsghome.php");
//guardar na base de dados....
error_reporting(E_ALL);
ini_set('display_errors',1);
//ob_start();
//session_start();
if(isset($_FILES["file"]["name"]))
{
$video=$_FILES["file"]["name"];
}
else
{
$video="";
}

mysql_query("INSERT INTO Video ( titulo,ficheiro) VALUES ('$title','$video')");

mysql_close($con);
//session_destroy();

echo "<script type='text/javascript'> 
  alert('The video was stored in the server '); 
  window.location = ('VideosAdmin.php');
 </script>";

  //fim de guardar na base de dados...

     }
  }

  }  
  else
  {
  echo "<script type='text/javascript'> alert('Didnt choose the correct file... ');window.location = ('VideosAdmin.php'); </script>";
    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:55:44.360

已编辑 - 在 OP 澄清后。

您的错误处理说“出现任何问题，显示相同的消息”这不会帮助您调试。

最可能的问题是 $_FILES 为空。您不检查“isset($_FILES['file'])”。要调试，只需 print_r($_FILES); 看看你得到了什么。一些更严重的文件上传错误会导致 $_FILES 为空，其他错误会出现在 $_FILES[name]['error'] 中。

还要检查大小 - 使用合理的限制，因为大数字处理可能会令人困惑（除非您将其转换为浮点数，否则请坚持使用整数进行有效比较，最大整数是 20 亿或 9.3e16）。

您的错误检查应该是：

1.  isset($_FILES['file'])
2.  $_FILES['文件']['错误']
3.  is_uploaded_file（以防万一您在共享服务器上）
4.  其他标准（名称、大小等）

对于每一个，给出一个有意义的错误信息——这有助于准确地分解问题所在。

# c# - Am I using the LINQ .OfType() operator correctly?

> ID：12065084
> 
> 赞同：1
> 
> 时间：2012-08-22T01:03:21.087
> 
> 标签：c#, .net, linq

```
public class Stock
{
}

class Program
{
    static void Main(string[] args)
    {
        ObjectCache cache = MemoryCache.Default;
        cache["test"] = new Stock();
        var x = cache.OfType<Stock>().ToList();
    }
} 
```

This is returning empty ...I thought OfType is supposed to return all instances in a collection of type T ?

Just to rule out the ObjectCache as a possible culprit I also tried

```
List<object> lstTest = new List<object>();
        lstTest.Add(new Stock());
        var y = lstTest.OfType<Stock>().ToList(); 
```

This works however - so it seems like the problem is with the ObjectCache, which is an instance of a Dictionary underneath

**SOLUTION**

```
cache.Select(item => item.Value).OfType<T>().ToList() 
```

Thanks Alexei!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T01:18:06.793

MemoryChache 返回 的枚举数`KeyValuePair<string,Object>`，而不仅仅是值：[MemoryChache.GetEnumerator()](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.getenumerator)。

您需要相应地获取您的物品。就像是：

```
var y = cache.Select(item => item.Value).OfType<Stock>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T01:19:28.547

这会起作用

```
cache.GetValues(new string[] {"test"}).Values.OfType<Order>() 
```

但我认为你不应该使用它。`KeyValuePairs`缓存就像字典一样工作......所以你可以得到一套`GetValues`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:18:18.087

这对我有用。

公共类股票{公共股票（）{名称=“艾琳”；} 公共字符串名称 { 获取；放; } }

```
class Program
{
    static void Main(string[] args)
    {
        System.Collections.ArrayList fruits = new System.Collections.ArrayList(4);
        fruits.Add("Mango");
        fruits.Add("Orange");
        fruits.Add("Apple");
        fruits.Add(3.0);
        fruits.Add("Banana");
        fruits.Add(new Stock());

        // Apply OfType() to the ArrayList.
        var query1 = fruits.OfType<Stock>();

        Console.WriteLine("Elements of type 'stock' are:");
        foreach (var fruit in query1)
        {
            Console.WriteLine(fruit);
        }

    }
} 
```

记住 IEnumerable 是惰性求值的。使用 foreach 遍历 query1，您会看到它只找到 Stock 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T01:13:49.857

是的。对不起自己。ObjectCache 是一个 IEnumerable> 不是真正的 IDictionary。

这有效：

```
var c = cache.Select(o => o.Value).OfType<Stock>().ToList(); 
```

# java - how to run java program outside eclipse on a server that doesn't have eclipse

> ID：12065085
> 
> 赞同：1
> 
> 时间：2012-08-22T01:03:21.790
> 
> 标签：java, eclipse

I wrote a java program that contains many classes in eclipse, it is my first time that I write a code in java and in eclipse too, now I need to run this code on a server that doesn't have eclipse.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:05:33.073

[Compiling & Running a Simple Program](http://www.oracle.com/technetwork/java/compile-136656.html).

This is your best starting point.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:07:56.970

使用“文件 -> 导出 -> JAR 文件”向导创建一个包含已编译类的 .jar 文件。然后，您可以将此 .jar 文件复制到您的服务器并使用 java.exe 运行它。从命令行使用“java -help”获取说明。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-08-22T02:48:24.190

**请通过 Andrew 提供的链接**

Eclipse 是一个 IDE，它促进了开发，但实际上并不需要运行您的代码，如果您想在某处的服务器中运行您的 java 文件，请确保您在“服务器”和路径中安装了 JRE，然后运行以下命令在服务器的 shell 环境中

```
javac filename.java 
```

上面的命令将在同一目录中生成一个 .class 文件，这是可以使用以下命令执行的实际文件，

```
java filename 
```

假设您的代码位于名为 filename.java 的文件中

# c# - Correct way to handle roaming data storage with C# in Metro?

> ID：12065086
> 
> 赞同：2
> 
> 时间：2012-08-22T01:03:41.323
> 
> 标签：c#, microsoft-metro, windows-runtime, winrt-xaml

I'm creating a C# Metro/Modern UI app, and I need a way to handle some user data (mostly just small strings, but a fair amount of them), and specifically I'd like the data to 'roam' with a user's Microsoft Account. I know that you can handle this with [roamingSettings](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh700362.aspx), but it seems like that's supposed to be used more for like storing user IDs and other one-time settings, whereas I would be using it to store all of my app's data, and there seems to be a [limit](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.storage.applicationdata.roamingstoragequota.aspx#Y28) to the amount of space I get with that. I was thinking about using SkyDrive to host a "MyApp Data" folder, but [I can't seem to figure out](https://stackoverflow.com/questions/12015487/uploading-string-as-text-file-to-skydrive) how to upload a simple text file to it :(

It seems like the best way to handle it would be to set up an account on Azure or EC2 and then make a simple PHP API so I could access the SQL database from my app, but I'd rather not have to pay for hosting.

I've seen other questions about Metro app storage on StackExchange and Microsoft's own forums, but most of those are in reference to local storage and using SQL servers to handle the storage.

So should I just use roamingSettings and keep an eye on the quota, should I try to use cloud hosting, or is there a better solution I just haven't thought of yet?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T03:18:32.660

关于漫游设置的一些事情： - 它们是为此而设计的，设置。不是作为数据复制方案，因此是配额 - 它们不是即时的。您可以创建一个名为“highpriority”的设置，该设置将在不到一分钟的时间内复制，但其他设置可能需要几分钟才能复制。如果您需要立即使用数据，则不能选择漫游设置。此外，如果超出配额，所有数据都将停止复制，这是一件坏事。:) 即使设置相同，它也不会在您的应用程序的不同版本之间复制。此外，如果您有一段时间（默认为 30 天）不使用该应用程序，则漫游数据将从云端删除。我很确定漫游数据也可以通过企业设置中的组策略关闭。

您可以利用 SkyDrive。确保下载 Live SDK。使用 SkyDrive 的概述在这里... [http://msdn.microsoft.com/en-us/library/live/hh826521.aspx](http://msdn.microsoft.com/en-us/library/live/hh826521.aspx) 从根本上说，它只是 REST API 的集合。有关将文件上传到 SkyDrive 的应用程序，请参阅 SkyDrive 照片示例 [http://code.msdn.microsoft.com/windowsapps/Live-SDK-Windows-Developer-8ad35141](http://code.msdn.microsoft.com/windowsapps/Live-SDK-Windows-Developer-8ad35141)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T12:12:20.087

我会选择基于云的解决方案。一位 MS 员工告诉我，漫游数据是“尽力而为”，无法控制它是否真的有效，有时有效，有时无效。

就我个人而言，我会尝试使用 skydrive 选项

# java - Change image with if statement

> ID：12065088
> 
> 赞同：1
> 
> 时间：2012-08-22T01:04:00.053
> 
> 标签：java

When the program loads, there's already and image for a place holder

```
ImageIcon icon = new ImageIcon(Path + "Hangman1.jpg");   
JLabel label = new JLabel();
label.setIcon(icon); 
```

Now i know how to write an if statement that prints out the body part

```
if (guesses >= 1) System.out.print("HEAD ");
if (guesses >= 2) System.out.print("BODY ");
if (guesses >= 3) System.out.print("LEFT ARM ");
if (guesses >= 4) System.out.print("RIGHT ARM ");
if (guesses >= 5) System.out.print("LEFT LEG ");
if (guesses >= 6) System.out.print("RIGHT LEG "); 
```

But instead of using a normal System.out.print i want to call up my images (want the image to change)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:07:34.743

就像是

```
String imageName = null;    

if (guesses >= 1) imageName = "Head.jpg";
if (guesses >= 2) imageName = "Body.jpg";
if (guesses >= 3) imageName = "LeftArm.jpg";
if (guesses >= 4) imageName = "RightArm.jpg";
if (guesses >= 5) imageName = "LeftLeg.jpg";
if (guesses >= 6) imageName = "RightLeg.jpg";

ImageIcon icon = null;
if (imageName != null) {
    icon = new ImageIcon(Path + File.seperator + imageName);
}

label.setIcon(icon); 
```

显然，每个图像都需要相互添加......

**更新**

正如 PaulBellora 非常友好地指出的那样，前面的示例是满足 OP 要求的最简单的代码更改，但这并不意味着它是正确的

```
switch (guesses) {
    case 1:
        imageName = "Head.jpg";
        break;
    case 2:
        imageName = "Body.jpg";
        break;
    case 3:
        imageName = "LeftArm.jpg";
        break;
    case 4:
        imageName = "RightArm.jpg";
        break;
    case 5:
        imageName = "LeftLeg.jpg";
        break;
    case 6:
        imageName = "RightLef.jpg";
        break;
} 
```

会是一个稍微好一点的方法。

通过一些巧妙的布局管理，你可以有六个标签，每个身体部位一个......

```
// Global references to the body parts
public static final ImageIcon RIGHT_LEG_ICON = new ImageIcon(Path + File.seperator + "RightLeg.jpg");
public static final ImageIcon LEFT_LEG_ICON = new ImageIcon(Path + File.seperator + "LeftLeg.jpg");
public static final ImageIcon RIGHT_ARM_ICON = new ImageIcon(Path + File.seperator + "RightArm.jpg");
public static final ImageIcon LEFT_ARM_ICON = new ImageIcon(Path + File.seperator + "LeftArm.jpg");
public static final ImageIcon BODY_ICON = new ImageIcon(Path + File.seperator + "Body.jpg");
public static final ImageIcon HEAD_ICON = new ImageIcon(Path + File.seperator + "Head.jpg");

// Used as fillers to allow the layout manager to maintain the layout
public static final ImageIcon BLANK_LEG_ICON = new ImageIcon(Path + File.seperator + "BlankLeg.jpg");
public static final ImageIcon BLANK_ARM_ICON = new ImageIcon(Path + File.seperator + "BlankArm.jpg");
public static final ImageIcon BLANK_BODY_ICON = new ImageIcon(Path + File.seperator + "BlankBody.jpg");
public static final ImageIcon BLANK_HEAD_ICON = new ImageIcon(Path + File.seperator + "BlanHead.jpg");

...

// Setup the initial state...(probably in the constructor or when the game rests)
rightLegLabel.setIcon(BLANK_LEG_ICON);
leftLegLabel.setIcon(BLANK_LEG_ICON);
rightArmLabel.setIcon(BLANK_ARM_ICON);
leftArmLabel.setIcon(BLANK_ARM_ICON);
bodyLabel.setIcon(BLANK_BODY_ICON);
headLabel.setIcon(BLANK_BODY_ICON);

...

// As the guesses change...
switch (guesses) {
    case 6:
        rightLegLabel.setIcon(RIGHT_LEG_ICON);
    case 5:
        leftLegLabel.setIcon(LEFT_LEG_ICON);
    case 4:
        rightArmLabel.setIcon(RIGHT_ARM_ICON);
    case 3:
        leftArmLabel.setIcon(LEFT_ARM_ICON);
    case 2:
        bodyLabel.setIcon(BODY_ICON);
    case 1:
        headLabel.setIcon(HEAD_ICON);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:07:12.560

You should create 7 images, each in its own "hangman" state. And load the appropriate image after each failed guess. Replacing the `System.out.print("HEAD ")` calls with the `label.setIcon()` call instead.

# eclipse - Make Eclipse's Incremental Find wrap around the end of the page

> ID：12065089
> 
> 赞同：10
> 
> 时间：2012-08-22T01:04:05.800
> 
> 标签：eclipse, search

In Eclipse you can hit `Ctrl` + `J` to use Incremental Find which is awesome. But if you start out half way down the page, and try to find something in the top half it won't find it because it doesn't wrap around, it stops at the bottom of the page. So I often end up jumping to the top of the page, just to incremental find to the middle.

Is there a way to force incremental find to wrap around the bottom of the page?

Note: I realize there is also `Ctrl` + `Shift` + `J` to do a reverse incremental find, but that has the same limitations.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-05T21:16:04.000

所以我终于想通了，如果你第一次点击`Ctrl`+ `J`，它不会换行，所以它不会找到上半部分。如果您再次点击`Ctrl`+ `J`，它将换行并搜索整个页面。

**只需再次点击`Ctrl`+ `J`。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T02:44:37.333

一个接近但不是直接的解决方案是使用旧的`Ctrl`+方法`F`，并检查“换行搜索”和“增量”选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-08T16:41:36.107

有一个用于更好的增量搜索的插件，默认情况下会环绕，我每天都使用它。

[https://code.google.com/p/eclipse-glance/](https://code.google.com/p/eclipse-glance/)

# php - Open Word document in browser (Google Chrome) instead of downloading (with PHP)

> ID：12065092
> 
> 赞同：-2
> 
> 时间：2012-08-22T01:04:32.207
> 
> 标签：php, browser, ms-word

Is there way to tell browser (i care mainly about Google Chrome which looks to have "Microsoft Office 2010" plugin) to open Microsoft Word document inside of browser using PHP?

RESULT: all tries made browser to download file. Looks like this Chrome plugin serves for something else than rendering .doc files.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:09:32.387

尝试设置`Content-Disposition`为内联

```
header("Content-Disposition", "inline;filename=somefile.ext") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:09:43.243

是的。正确设置 MIME 类型，然后将`Content-Disposition`标头设置为`inline`.

```
<?php
header('Content-Disposition: inline; filename=blah.doc');
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:10:04.057

您可以使用 GET 请求中的文件 URL 创建重定向到谷歌文档查看器。

例如，如果您想在 URL [http://research.google.com/archive/bigtable-osdi06.pdf](http://research.google.com/archive/bigtable-osdi06.pdf)查看 PDF ，您可以使用 URL：[http ://docs.google.com/viewer?url =http%3A%2F%2Fresearch.google.com%2Farchive%2Fbigtable-osdi06.pdf](http://docs.google.com/viewer?url=http%3A%2F%2Fresearch.google.com%2Farchive%2Fbigtable-osdi06.pdf)

# java - Why am i getting 403 error reading a website url on java?

> ID：12065099
> 
> 赞同：1
> 
> 时间：2012-08-22T01:06:08.877
> 
> 标签：java

I'm trying to read [http://www.meuhumor.com.br/](http://www.meuhumor.com.br/) on java using this:

```
URL url;
        HttpURLConnection connection = null;        
        try{
            url = new URL(targetURL);
            connection = (HttpURLConnection)url.openConnection();

            connection.setRequestMethod("POST");
            connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
            connection.setRequestProperty("Content-Language", "en-US"); 
            connection.setRequestProperty("User-Agent", "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11");
            connection.setUseCaches(false);
            connection.setDoInput(true);
            connection.setDoOutput(true);

            DataOutputStream dataout = new DataOutputStream(connection.getOutputStream());
            dataout.flush();
            dataout.close();

            InputStream is = connection.getInputStream();
            BufferedReader br = new BufferedReader(new InputStreamReader(is));
            String line;
            StringBuffer response = new StringBuffer();

            while((line = br.readLine()) != null){
                response.append(line);
                response.append('\n');
            }
            br.close();
            String html = response.toString(); 
```

I can access the website using any browser, but when i try to get the html with Java im getting java.io.IOException: Server returned HTTP response code: 403 for URL:

Someone know a way to get the html?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:13:34.613

您很可能会收到 HTTP 403 响应，因为您的`POST`请求没有正文。您的代码看起来像是在尝试提交表单。如果您的意图是在不提交表单的情况下简单地下拉页面内容，请尝试`GET`请求，删除`Content-Type`标题，删除`connection.setDoOutput(true)`，然后删除 3`DataOutputStream`行。

# html - 浮动和自动高度

> ID：12065106
> 
> 赞同：1
> 
> 时间：2012-08-22T01:06:49.767
> 
> 标签：html, css, css-float

我在那里有几节课，所以让我先发布它们。

***HTML：***

```
<div class="content">
    <div class="sidebar">

    </div>

    <div class="area">

    </div>
</div><!-- content closed --> 
```

***CSS：***

```
.content {
    background-color: #eee;
    height: auto;
}

.sidebar {
    background-color: #555;
    width: 250px;
    height: auto;
    padding: 10px;
    float: right;
}

.area {
    background-color: #777;
    width: 590px;
    height: auto;
    padding: 10px;
} 
```

因此，您基本上可以看到每个班级都将高度设置为“自动”。这很好，因为我希望内容跟随侧边栏和区域。他们里面会有很多内容。

现在... .sidebar 设置在 float:right; 所以它并不真正影响移动下面的内容。在我的情况下，这是页脚。

我想知道如何使物体漂浮，移动它下面的部分，这取决于自动设置的高度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:13:48.163

我不确定我是否理解您的问题，但如果您尝试将页脚定位在您的内容下方，您需要清除浮动：

```
<div class="content">
    <div class="sidebar">

    </div>

    <div class="area">

    </div>
    <div style="clear:both"></div>
    This is the footer
</div><!-- content closed --> 
```

jsfiddle：http: [//jsfiddle.net/xmw7M/1/](http://jsfiddle.net/xmw7M/1/)

# database - Normalize to Boyce Codd Normal Form in relational data model

> ID：12065107
> 
> 赞同：0
> 
> 时间：2012-08-22T01:07:00.137
> 
> 标签：database, normalization

OK this is probably very basic for the majority of you, but I'm struggling to do this assignment (Yep, it's homework). I've attempted this twice now and failed both times so far.

I need to create a relational data model in Boyce Codd Normal Form. Here are the details:

> The Airport Authority in a small nation requires a database to store information about airlines, pilots and planes.
> 
> There is only one airport but several airlines use it. For each airline its identification code and full name is required together with the phone number of its local office. Several types of plane use the airport and for each type, the fuel capacity and maximum range is to be recorded.
> 
> Each pilot works for only one airline. For each pilot, their name, date of birth, address, the types of plane they can fly and their pilot‟s licence number is to be recorded. Further information is to be recorded to enable the production of a report listing the following details for each plane that uses the airport: Plane identification code, Plane type, Date of manufacture, Owning airline.

This is what I now have (After re-designing):

The table AIRLINES should include:

```
ID,
Name,
Phone # 
```

The table PLANES should include:

```
ID,
Date of Manufacture
Airline ID
FOREIGN KEY (Airline ID) references table AIRLINES
Plane Type ID 
FOREIGN KEY (Plane Type ID) references table PLANE TYPE 
```

The table PLANE TYPE should include:

```
ID,
Maximum range,
Fuel capacity, 
```

The table PILOTS should include:

```
ID,
Name,
Date of Birth,
Address,
License #,
Airline ID,
FOREIGN KEY (Airline ID) references table AIRLINES
PilotPlaneID
FOREIGN KEY (PilotPlaneID) references table PILOTPLANETYPE 
```

The table PILOTPLANETYPE should include:

```
 PilotID
   PlaneTypeID
   FOREIGN KEY (PilotID) references table PILOT
   FOREIGN KEY (PlaneTypeID) references table PLANE TYPE 
```

According to my marker, I had have left a many to many relationship between Pilot and Plane Type. Can someone with some database design knowledge please give me helping hand?

(EDIT: Tables now updated with PILOTPLANETYPE, which I think should satisfy the requirements)?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:16:01.323

您的设计为每位飞行员设计了一种飞机类型。

描述包含“他们可以驾驶的飞机类型”。这个复数表明每个飞行员可能驾驶许多飞机。

由于这是家庭作业，我将让您弄清楚如何将这些信息放入您的设计中。

# magento - How to get transaction id on magento success page?

> ID：12065108
> 
> 赞同：0
> 
> 时间：2012-08-22T01:07:01.807
> 
> 标签：magento, authorize.net

I am trying to get authorize.net transaction id on magento's success page. Here's the code I am using:

```
$orders = Mage::getModel('sales/order')->getCollection();
$order = $orders->getLastItem();

$transactionId = $order->getPayment()->getTransactionId(); 
```

As a result, $transactionId is an empty string.

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T20:48:13.657

首先，我想说的是，您用来获取最后一个订单的参考的方法并不是最有效或最准确的方法。这样做会更好：

```
$order = Mage::getModel('sales/order')
    ->load(Mage::getSingleton('checkout/session')->getLastOrderId()); 
```

在当前 Magento 版本（企业版 1.13 和社区 1.8）中，获取交易 ID（以及支付交易和卡中的其他字段）的最佳方式是从存储在“additional_information”字段中的“authorize_cards”字段中获取付款对象（Mage_Sales_Model_Order_Payment 或 sales_flat_order_payment 表）。

整个事情看起来像这样（你可以将此代码添加到'app/design/frontend/base/default/template/checkout/success.phtml'）：

```
<?php
$order = Mage::getModel('sales/order')
    ->load(Mage::getSingleton('checkout/session')->getLastOrderId());
$cardsStorage = Mage::getModel('paygate/authorizenet_cards')
    ->setPayment($order->getPayment());
foreach ($cardsStorage->getCards() as $card) {
    $lastTransId = $card->getLastTransId();
    echo '<p>' . $lastTransId . '</p>';
}
?> 
```

# ios - Is it possible to process a silent notification in iOS when your app is not running?

> ID：12065110
> 
> 赞同：1
> 
> 时间：2012-08-22T01:07:05.930
> 
> 标签：ios, notifications, apple-push-notifications

I haven't found the exact answer to this elsewhere on this site. The goal is to send a silent remote notification (no user alert/badge/sound) to my app, with a custom payload, and then have the app process this even if it was not running when the notification was received. If the app was not running, is it notified and given a chance to process the (silent) notification? Or is it only notified the next time the app is launched?

So far, I've only been able to confirm that you can receive a non-silent notification when the app is not running, or a silent notification when the app IS running. I haven't seen confirmation of what happens if you receive a silent notification and are not running.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T16:52:43.937

从本质上讲，到目前为止我能够找到的答案（并且@Sebrasi 同意上述）是我所要求的是不可能的。当通知进来时，应用程序不会获得任何处理时间，除非它已经在运行或用户以一种或另一种方式通过 UI 启动它。

# php - 通过 Balanced 引用现有买家和商家

> ID：12065114
> 
> 赞同：3
> 
> 时间：2012-08-22T01:07:38.737
> 
> 标签：php, balanced-payments

我正在查看问题（[获取对现有买家和商家帐户](https://stackoverflow.com/questions/11588911/balanced-payments-documentation-on-obtaining-references-to-existing-buyer-and)的引用），该问题询问如何通过电子邮件为 ruby​​ 引用帐户，并且想知道如何对 php 做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:13:51.797

[下面是一个示例，说明如何使用balance-php](https://github.com/balanced/balanced-php)库在 PHP 中通过电子邮件地址查找帐户：

```
$buyer = $marketplace->accounts->query()->filter(Balanced\Account::$f->email_address->eq("buyer2@example.org"))->one(); 
```

如果您查看 balance -php 库中包含的[example.php](https://github.com/balanced/balanced-php/blob/master/example/example.php#L114)文件，您可以了解如何通过 URI 查找现有帐户：

```
print "how do we look up an existing object from the URI?\n";
$the_buyer = Balanced\Account::get($buyer->uri);
print "we got the buyer " . $the_buyer->email_address . "\n"; 
```

# php - Php 仅显示来自 sql DATETIME 的年份

> ID：12065115
> 
> 赞同：0
> 
> 时间：2012-08-22T01:07:39.247
> 
> 标签：php, sql, datetime, foreach

我有一个用于 foreach 循环的函数，该循环来自 mySQL DB 的 3 个最新帖子。

```
function latest_posts_footer(PDO $dbh) {
    global $dbh;

    $stmt = $dbh->prepare("
        SELECT      *
        FROM        posts
        ORDER BY    post_date DESC
        LIMIT       0, 3
    ");
    $stmt->execute();
    return $stmt->fetchAll();
}
latest_posts_footer($dbh);
$latest_posts_footer = latest_posts_footer($dbh); 
```

post_date 类型是正确工作的 DATETIME。

我知道查询：`SELECT YEAR(post_date) FROM posts;`给了我 post_date 的年份。

要显示原始 DATETIME，我可以简单地执行以下操作：

![循环](../Images/a88faf73b2c55c6423b88b5dc5761102.png)

这会给我带来输出：*2000-01-01 00:00:00*。

如何只使用 PHP 从该输出中**获取年份？**帮助不胜感激。谢谢！

*PS 我已经查看过以前关于同一件事的帖子，但它们无济于事。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:12:00.807

```
$year = date("Y", strtotime($lpf['post_date']));

echo $year; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:14:41.057

你到底是什么意思`YEAR`？

```
$yearOnly = date("Y", $lpf['post_date']); 
```

**[PHP 日期手册](http://php.net/manual/en/function.date.php)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:10:23.543

这是一个提示

```
 $date = DateTime::createFromFormat("Y-m-d", "2068-06-15");
 echo $date->format("Y"); 
```

除非我在这里误解了什么

# grammar - 如何解决强制转变或减少的转变/减少冲突？

> ID：12065125
> 
> 赞同：3
> 
> 时间：2012-08-22T01:09:49.690
> 
> 标签：grammar, bison, yacc, shift-reduce-conflict

当 Yacc/Bison 中存在 shift/reduce 冲突时，是否可以强制冲突完全按照您的意愿解决？换句话说：是否可以明确强制它优先考虑转变或减少？

对于我所阅读的内容，如果您对默认分辨率感到满意，您可以告诉生成器[不要抱怨它](http://www.gnu.org/software/bison/manual/bison.html#Expect-Decl)。我真的不喜欢这样，因为它混淆了你的理性选择。

另一种选择是重写语法以解决问题。我不知道这是否总是可能的，而且这通常会使它更难理解。

最后，我已经阅读了优先规则可以解决这个问题。我无能为力地尝试了很多方法，但我无法让它发挥作用。是否可以为此使用优先规则？如何？

虽然我的模棱两可的语法非常不同，但我可以使用[Bison 手册](http://www.gnu.org/software/bison/manual/bison.html#Shift_002fReduce)中的经典 if-then-else来举一个具体的例子：

```
 %token IF THEN ELSE variable
 %%
 stmt:
   expr
 | if_stmt
 ;

 if_stmt:
   IF expr THEN stmt
 | IF expr THEN stmt ELSE stmt
 ;

 expr:
   variable
 ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T22:09:02.557

好吧，移位/减少冲突的默认解决方案是移位，所以如果这是你想要的，你不需要做任何事情（除了忽略警告）。

如果你想通过减少来解决移位/减少冲突，你可以使用优先规则——只要确保要减少的规则的优先级高于要移位的令牌。如果存在涉及相同规则和令牌的多个移位/减少冲突，则可能无法找到全局一致的规则和令牌优先级集，从而以您想要的方式解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:36:37.400

据我所知，不可能通过选择减少来指导解析器解决 S/R 冲突。虽然我可能是错的，但无论如何，这样做可能是不明智的。因此，唯一的可能性是要么重写语法，要么通过移位解决冲突。

以下右优先的用法`THEN`描述`ELSE`了`if-then-else`语句的期望行为（即`else`与最里面的`if`语句相关联）。

```
%token IF THEN ELSE variable
%right THEN ELSE

%%

stmt
    : expr
    | if_stmt
    ;

if_stmt
    : IF expr THEN stmt
    | IF expr THEN stmt ELSE stmt
    ;

expr
    : variable
    ; 
```

通过为上述标记选择正确的关联，以下序列：

```
IF expr1 THEN IF expr2 THEN IF expr3 THEN x ELSE y 
```

被解析为：

```
IF expr1 THEN (IF expr2 THEN (IF expr3 THEN (x ELSE (y)))) 
```

野牛不再抱怨这个案子。

请记住，您始终可以运行`bison file.y -r all`并检查`file.output`以查看生成的解析器状态机是否正确。

# java - 防止 Tika 使用 TNEFParser

> ID：12065126
> 
> 赞同：2
> 
> 时间：2012-08-22T01:09:56.003
> 
> 标签：java, apache-tika

我正在尝试解析 mbox 格式的电子邮件。但是，Tika 不断尝试在这些消息上使用 TNEFParser 导致错误：

```
2012-08-21 17:44:42,139 FATAL org.apache.hadoop.mapred.Child: Error running child : java.lang.OutOfMemoryError: Java heap space
    at org.apache.poi.hmef.attribute.TNEFAttribute.<init>(TNEFAttribute.java:50)
    at org.apache.poi.hmef.attribute.TNEFAttribute.create(TNEFAttribute.java:76)
    at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:74)
    at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98)
    at org.apache.poi.hmef.HMEFMessage.process(HMEFMessage.java:98)
    at org.apache.poi.hmef.HMEFMessage.<init>(HMEFMessage.java:63)
    at org.apache.tika.parser.microsoft.TNEFParser.parse(TNEFParser.java:80)
    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
    at org.apache.tika.parser.mail.MailContentHandler.body(MailContentHandler.java:102)
    at org.apache.james.mime4j.parser.MimeStreamParser.parse(MimeStreamParser.java:133)
    at org.apache.tika.parser.mail.RFC822Parser.parse(RFC822Parser.java:76)
    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)
    at org.lab41.asf.etl.mapred.MailboxToTextMapper.parse(MailboxToTextMapper.java:124)
    at org.lab41.asf.etl.mapred.MailboxToTextMapper.map(MailboxToTextMapper.java:88)
    at org.lab41.asf.etl.mapred.MailboxToTextMapper.map(MailboxToTextMapper.java:45)
    at org.apache.avro.mapred.HadoopMapper.map(HadoopMapper.java:81)
    at org.apache.avro.mapred.HadoopMapper.map(HadoopMapper.java:34)
    at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:50)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:391)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:325)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:266)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1278)
    at org.apache.hadoop.mapred.Child.main(Child.java:260) 
```

是否可以阻止 Tika 使用 TNEFParser？任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T05:06:59.230

这是@Gagravarr 建议的配置版本。

首先，创建一个 tika-config.xml 文件：

```
<properties>
  <parsers>

    <!-- use the default parser in most cases, it is a composite of all 
         the parsers listed in META-INF/services/org.apache.tika.parser.Parser -->
    <parser class="org.apache.tika.parser.DefaultParser"/>

    <!-- Disable tnef extraction-->    
    <parser class="org.apache.tika.parser.EmptyParser">
      <mime>application/vnd.ms-tnef</mime>
      <mime>application/x-tnef</mime>
    </parser>

  </parsers>
</properties> 
```

现在，从这个配置创建一个 TikaConfig（假设它在你的类路径的某个地方）：

```
ClassLoader loader = Thread.currentThread().getContextClassLoader();
TikaConfig config = new TikaConfig(loader.getResource("tika-config.xml"), loader); 
```

当你创建一个新的 Parser，或者使用 Tika 门面时，传入你的配置：

```
AutoDetectParser parser = new AutoDetectParser(config);
ParseContext context = new ParseContext();
context.set(Parser.class, parser);
parser.parse(input, handler, metadata, context); 
```

任何标识为 TNEF 的文档都将使用 EmptyParser，它不返回任何内容并且实际上不解析任何内容。

这实际上是一个黑名单，如果您想要一个白名单，您需要从 XML 中删除 DefaultParser 并手动配置每个解析器及其元数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T10:08:31.607

对于长期修复，您应该将其报告为 Apache Tika 中的错误，将有问题的文件附加到错误报告中，并与项目一起修复错误。

短期而言，解压 Tika-Parsers jar 文件，编辑`META-INF/services/org.apache.tika.parser.Parser`文件并从列表中删除 TNEF 解析器。这将阻止它被 AutoDetectParser 自动加载和使用

如果不更改 Tika Parsers jar 文件，这有点棘手。有两种选择。一种是自己创建一个 TikaConfig 实例，而不是依赖默认实例，并且只提供有限的解析器列表。根据您是要列入白名单还是列入黑名单，这可能更容易或更困难。或者，您可以使用最后注册的 mimetype 解析器获胜的事实。因此，使用服务文件和您自己的虚拟解析器创建您自己的 jar。让该解析器声明它处理 TNEF mimetype，但让它什么都不做。将 jar 添加到您的类路径中，然后将使用您的虚拟解析器

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T17:23:09.590

这是*@Gagravarr*建议的程序化版本。它将注册的不必要的解析器替换为[`EmptyParser`](http://tika.apache.org/1.2/api/org/apache/tika/parser/EmptyParser.html).

```
private Tika createTika(final Parser... unnecessaryParsers) 
        throws TikaException, IOException {
    final TikaConfig config = new TikaConfig();
    final AutoDetectParser autoDetectParser = new AutoDetectParser(config);

    final Set<MediaType> unnecessaryMimeTypes = 
        getUnnecessaryMediaTypes(unnecessaryParsers);
    disableParsing(autoDetectParser, unnecessaryMimeTypes);

    final Detector detector = config.getDetector();
    final Tika tika = new Tika(detector, autoDetectParser);
    return tika;
}

private Set<MediaType> getUnnecessaryMediaTypes(
        final Parser... unnecessaryParsers) {
    final Set<MediaType> unnecessaryTypes = new HashSet<MediaType>();
    for (final Parser unnecessaryParser: unnecessaryParsers) {
        final Set<MediaType> supportedTypes = 
            unnecessaryParser.getSupportedTypes(null);
        unnecessaryTypes.addAll(supportedTypes);
    }
    return unnecessaryTypes;
}

private void disableParsing(final CompositeParser mainParser, 
        final Set<MediaType> unnecessaryMediaTypes) {
    final EmptyParser emptyParser = new EmptyParser();

    final Map<MediaType, Parser> parsers = mainParser.getParsers();
    for (final MediaType unnecessaryType: unnecessaryMediaTypes) {
        parsers.put(unnecessaryType, emptyParser);
    }

    mainParser.setParsers(parsers);
} 
```

用法：

```
final Parser unnecessaryParser = new MP4Parser();
final Tika tika = createTika(unnecessaryParser); 
```

您也可以使用它来避免[TIKA-1040: Could not delete temporary file](https://issues.apache.org/jira/browse/TIKA-1040)。

# ios - 如何在 iOS 上编写草图应用程序

> ID：12065127
> 
> 赞同：0
> 
> 时间：2012-08-22T01:09:58.120
> 
> 标签：ios, drawing, paint, quartz-graphics, quartz-2d

我正在尝试创建可以通过手指绘制形状/路径的草图应用程序。

到目前为止，我所做的是在触摸开始时创建 UIBezierPath，并在手指移动时绘制路径。

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

```
UITouch *mytouch=[[touches allObjects] objectAtIndex:0];
CGPoint locationInDrawRect = [mytouch locationInView:self.drawingView];
[self.drawingView.currentPath addLineToPoint:locationInDrawRect];
[self.drawingView setNeedsDisplay]; 
```

}

触摸完成后，将其保存到 UIBezierPath 数组中。

```
-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    [self.drawingView.pathsArray addObject:self.drawingView.currentPath];  //add latest current path to pathArray
    [self.drawingView clearCurrentPath];  //clear current path for next line
    [self.drawingView setNeedsDisplay];
} 
```

在drawRect中，使用for循环绘制当前路径和数组中的路径

```
- (void)drawRect:(CGRect)rect
{
        if(!self.currentPath.empty){
            [self.currentPath stroke];
        }

        for (UIBezierPath *path in self.pathsArray){
            [path stroke];
        }

} 
```

这适用于几个路径对象，但是当数组包含超过 5 个路径时它会变慢。

我尝试使用 setNeedsDisplayInRect: 方法限制要渲染的区域。

```
[self.drawingView setNeedsDisplayInRect:rectToUpdateDraw]; 
```

并且仅当矩形大小为完整画布大小（即触摸结束时）时才在数组中渲染路径。但这会画出奇怪的形状线，并且当数组中有很多对象时也会变慢。

我不知道如何解决这个问题，需要一些帮助。

谢谢！

# objective-c - 正则表达式匹配时间过长

> ID：12065131
> 
> 赞同：1
> 
> 时间：2012-08-22T01:10:24.370
> 
> 标签：objective-c, regex, nsregularexpression

我想在 之间取字符串`"`，但是**正则表达式**匹配的时间太长。

代码如下：

```
NSRegularExpression *regexp =
[NSRegularExpression regularExpressionWithPattern:
 @"\".?\"" options:0 error:&error]; 
```

字符串匹配如下：

`what_i_want" "what_I_do_not_want`

你知道，我只想拿：

`what_i_want`

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:13:18.790

请改用以下内容`@"\"[^\"]+\""`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:37:08.667

我相信你想使用正则表达式模式`@"\".*?\""`

# asp.net-mvc - DbContext 'InRequestScope' 不适用于自定义成员资格提供程序

> ID：12065133
> 
> 赞同：1
> 
> 时间：2012-08-22T01:10:38.800
> 
> 标签：asp.net-mvc, entity-framework, asp.net-membership, repository

我正在实现一个自定义 ASP.NET 成员资格提供程序，该提供程序基于自定义存储库类进行操作，该存储库类又使用实体框架 DbContext 作为访问数据的手段。

由于这是一个 ASP.NET MVC 应用程序，因此 IoC 容器 (Ninject) 被设置为解析我的 DbContext InRequestScope 的实例。

我的用户数据表是单个主 DbContext 的一部分。

Repository 类也必须在 InRequestScope 中实例化。但是repository类是为了满足自定义MembershipProvider的需要而创建的，不能设置为实例化InRequestScope。结果，每当我尝试通过存储库访问角色数据时，我都会得到 DbContext 已处置异常。

有没有人设置了类似的配置，如果是这样，为了克服我遇到的问题，采取了哪些不同的实施方式。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:55:25.560

一个允许我继续项目开发的解决方法是在 Membership Provider 构造函数中手动创建一个 DbContext 实例，而不是让 Ninject 注入它。

也许有人最终会想出一个更好的方法来解决这个特定的问题，请在此处发布，我会将其作为答案而不是此解决方法。

# maven - 缺少工件 sun.jdk:tools:jar:1.6.0:system

> ID：12065135
> 
> 赞同：1
> 
> 时间：2012-08-22T01:10:46.500
> 
> 标签：maven, pom.xml

我使用的是 Mac，在我的一个 pom 文件中看到了这个错误。我四处搜索并将以下部分添加到 pom.xml：

```
<profiles>
    <profile>
      <id>osx</id>
      <activation>
        <os>
          <family>mac</family>
        </os>
      </activation>
      <properties>
        <toolsjar>${java.home}/../Classes/classes.jar</toolsjar>
      </properties>
    </profile>
  </profiles>

...
 <dependency>
   <groupId>com.sun</groupId>
   <artifactId>tools</artifactId>
   <version>1.6.0</version>
   <scope>system</scope>
   <systemPath>/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Classes/classes.jar</systemPath>
 </dependency>
    ... 
```

然后当我跑

```
mvn clean install -Posx 
```

我仍然遇到同样的错误。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-16T14:14:56.000

使用以下命令将 tools.jar 从已安装的 JDK 位置安装到 maven 存储库。

```
$mvn install:install-file -DgroupId=sun.jdk -DartifactId=tools -Dpackaging=jar -Dversion=1.6 -Dfile="C:\Program Files\Java\jdk1.6.0_27\lib\tools.jar" 
```

注意：请确保上述命令中的 JDK 安装路径正确。

# python-2.7 - 为什么python会跳过一行？

> ID：12065136
> 
> 赞同：0
> 
> 时间：2012-08-22T01:10:47.963
> 
> 标签：python-2.7

我对 Python 很陌生（一周前才开始自学），所以我的调试技能现在很弱。我试图制作一个程序，它会询问用户提交的随机生成的乘法问题数量，系数在 0 到 12 之间，就像乘法表测试一样。

```
import math
import random

#establish a number of questions
questions = int(input("\n How many questions do you want?     "))     

#introduce score
score = 1

for question in range(questions):
    x = random.randrange(0,13)
    y = random.randrange(0,13)

    #make the numbers strings, so they can be printed with strings
    abc = str(x)
    cba = str(y)
    print("What is " + abc + "*" + cba +"?")

    z = int(input("Answer here:   "))
    print z
    a = x*y

    #make the answer a string, so it can be printed if you get one wrong
    answer = str(a)

    if z > a or z < a:
        print ("wrong, the answer is " + answer)
        print("\n")

        #this is the line that's being skipped
        score = score - 1/questions
    else:
        print "Correct!"
        print ("\n")

finalscore = score*100
finalestscore = str(finalscore)
print (finalestscore + "%") 
```

这个想法是，每次用户答错问题时，分数（设置为 1）会下降 1/问题，因此当乘以 100 时，它会给出错误问题的百分比。但是，无论问题的数量或错误的数量，分数仍然是1，所以finalestscore仍然是100。第26行曾经是：如果math.abs（z）-math.abs（a）！= 0：但是2.7。 3 显然不承认数学具有 abs 函数。

这样一个简单的累加器模式似乎不会成为问题，即使对于旧版本的 Python 也是如此。帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T01:14:06.657

尝试`score = score - 1.0/questions`

问题是你正在做整数除法，它会截断到最接近的整数，所以`1/questions`总是会给出 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:15:24.520

问题是您在所有计算中都使用整数。特别是，当您计算 时`1/questions`，它会截断（向下舍入）为整数，因为计算中的两个值都是整数。

为避免这种情况，您可以改为`1.0/questions`使用浮点数进行计算（而不是截断）

# android - 在 android 中，我的拖动监听器不起作用

> ID：12065137
> 
> 赞同：0
> 
> 时间：2012-08-22T01:10:57.293
> 
> 标签：android, avd

我在表格的每个视图中设置了一个触摸监听器和一个拖动监听器：

```
view.setOnDragListener(new MyDragListener());
view.setOnTouchListener(new MyTouchListener()); 
```

我的拖动侦听器和触摸侦听器的代码几乎相同。我的触摸监听器工作正常，但我的拖动监听器甚至不会提供第一行的调试信息。

```
class MyDragListener implements OnDragListener {
    public boolean onDrag(View view, DragEvent event) {
        Log.d("DEBUG", "Drag");
        ...
        return true;
    }
} 
```

如果这很重要，我正在使用我在 Ubuntu 上随 Eclipse 安装的 AVD。知道出了什么问题吗？有什么我可以用的吗？拖动侦听器仅适用于更高版本的android，所以一定是一些贬值的方式，对吧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:42:56.667

您在哪个版本的 android 上运行您的应用程序？

要求`OnDragListener` [API 11](http://developer.android.com/guide/topics/ui/drag-drop.html) (HoneyComb)

# java - 设置在 linux 上运行的 Java 程序的 nice 值

> ID：12065142
> 
> 赞同：2
> 
> 时间：2012-08-22T01:12:28.567
> 
> 标签：java, linux, thread-priority

我希望我的 Java 程序降低它的优先级，这样它就不会压倒系统。我最初的想法是使用`Thread.currentThread().setPriority(5)`，但这似乎只是它在 JVM 中的优先级。

然后我想也许我会把它塞住并调用一个系统命令，但`Thread.getId()`也只是 JVM 的 id，所以我什至不知道要传递给什么进程 id `renice`。

Java程序有没有办法做这样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T20:58:31.547

由于我们必须以依赖于平台的方式执行此操作，因此我从 java 运行了一个 shell 进程，它改进了它的父进程。父进程恰好是我们的 java 进程。

```
import java.io.*;

public class Pid
{
  public static void main(String sArgs[])
    throws java.io.IOException, InterruptedException
  {
    Process p = Runtime.getRuntime().exec(
      new String[] {
        "sh",
        "-c",
        "renice 8 `ps h -o ppid $$`"
        // or: "renice 8 `cat /proc/$$/stat|awk '{print $4}'`"
      }
      );
    // we're done here, the remaining code is for debugging purposes only
    p.waitFor();
    BufferedReader bre = new BufferedReader(new InputStreamReader(
      p.getErrorStream()));
    System.out.println(bre.readLine());
    BufferedReader bro = new BufferedReader(new InputStreamReader(
      p.getInputStream()));
    System.out.println(bro.readLine());
    Thread.sleep(10000);
  }
} 
```

顺便说一句：你是 jEdit 的 Brad Mace 吗？很高兴见到你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T01:16:07.480

如果您的程序是唯一正在运行的 java 程序，那么您可以运行

```
renice +5 `pgrep java` 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T01:18:41.970

除了 renice - 您还可以使用 ionice 命令。例如 ：

```
ionice -c 3 -n 7 -p PID 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-20T16:50:25.163

另请查看[https://github.com/jnr/jnr-posix/](https://github.com/jnr/jnr-posix/)。

这个 POSIX 库应该允许您使用一些 Linux Posix *Nice*功能，例如...

[https://github.com/jnr/jnr-posix/blob/master/src/main/java/jnr/posix/LibC.java](https://github.com/jnr/jnr-posix/blob/master/src/main/java/jnr/posix/LibC.java)为OS级别setPriority()，即[setpriority(2)](http://linux.die.net/man/2/setpriority)

jnr-posix 也在 Maven 中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-22T04:15:21.167

利用：

```
nice --adjustment=5 java whatever 
```

只需一步即可运行您的 java 程序并分配优先级。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-22T01:19:50.073

我的建议是从 bash 脚本或启动/停止服务脚本调用您的 Java 应用程序，然后在启动后找到进程 ID 并对其进行修改。

# java - 读取客户端值 在 onchange 回调中

> ID：12065143
> 
> 赞同：2
> 
> 时间：2012-08-22T01:12:30.543
> 
> 标签：java, javascript, jsf-2, primefaces

鉴于这种：

```
<p:selectOneMenu value="#{myBean.selection}" onchange="handleChange();">
    <f:selectItem itemLabel="foo" itemValue="0"/>
    <f:selectItem itemLabel="bar" itemValue="1"/>
</p:selectOneMenu>

<script type="text/javascript">
    function handleChange() {
        // Do something here...
    }
</script> 
```

如何检测 JavaScript 中的选定项目，以便我可以在`handleChange()`函数中采取适当的操作（例如显示/隐藏 div）？这似乎没有任何文档。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T01:29:46.727

选定的值位于 HTML DOM 事件属性中，可由`this.value`.

```
<p:selectOneMenu value="#{myBean.selection}" onchange="handleChange(this.value)">
    <f:selectItem itemLabel="foo" itemValue="0"/>
    <f:selectItem itemLabel="bar" itemValue="1"/>
</p:selectOneMenu>

<script type="text/javascript">
    function handleChange(selection) {
        // Do something here with selection...
    }
</script> 
```

* * *

> *这似乎没有任何文档。*

这不是针对 JSF，而是针对一般的 HTML/JS，所以应该通过查看 JSF 在客户端生成的 HTML 输出并了解一些基本的 HTML/JS 来找到答案。

# javascript - 每月第二个星期一的 Javascript 日期

> ID：12065146
> 
> 赞同：2
> 
> 时间：2012-08-22T01:13:24.187
> 
> 标签：javascript, date

我正在与一个在本月的第二个星期一见面的小组工作，他们希望他们的网站反映下一次会议的日期。我有这个月的第二个星期一要显示的脚本，但是我遇到了 if else 语句的问题。我需要它来反映下一个即将发生的事件，而不仅仅是这个月的日期。IE。本月的事件日期是 2012 年 8 月 13 日，已超过当前日期（2012 年 8 月 21 日）。我希望它移动到下一个可用日期 2012 年 9 月 10 日。下面是我到目前为止的代码。

```
<script type="text/javascript">
Date.prototype.x = function () {
var d = new Date (this.getFullYear(), this.getMonth(), 1, 0, 0, 0)
d.setDate (d.getDate() + 15 - d.getDay())
return d
}
Date.prototype.getSecondMonday = function () {
var d = new Date (this.getFullYear(), 1, 1, 0, 0, 0)
d.setMonth(this.getMonth()+1)
d.setDate (d.getDate() + 15 - d.getDay())
return d
}
var today = new Date()
var todayDate = today.toDateString()

if (Date.prototype.x>todayDate)
  {
document.write (new Date().x().toDateString());
  }
else
  {
document.write (new Date().getSecondMonday().toDateString());
  }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:24:12.660

您缺少`()`该`x`功能，因此它没有执行它。：） 应该：

```
if (Date.prototype.x() > todayDate) 
```

* * *

更新：这是清理后的逻辑的固定/工作版本（可能被过度评论，但我想如果有人需要它至少在那里）。

```
Date.prototype.nextSecondMonday = function (){
    // Load the month.
    var target = new Date(this.getFullYear(), this.getMonth(), 1, 0, 0, 0);
    var today = new Date();

    // Check to see if the 1st is on a Monday.
    var isMonday = (target.getDay() == 1);

    // Jump ahead two weeks from the 1st, and move back the appropriate number of days to reach the preceding Monday.
    // i.e. If the 1st is a Thursday, we would move back three days.
    var targetDate = 15 - (target.getDay() - 1);

    // Quick adjustment if the 1st is a Monday.
    if (isMonday) targetDate -= 7;

    // Move to the second Monday in the month.   
    target.setDate(targetDate);

    // Second Monday is before today's date, so find the second Monday next month.
    if (today > target) {
        //return "<em>" + target.toLocaleDateString() + " is in the past...</em>";
        target.setMonth(target.getMonth() + 1);
        return target.nextSecondMonday();
    }

    // Format and return string date of second Monday.
    return target.toLocaleDateString();
}

// Working test for the year 2012.
//for (var i = 0; i < 12; i++)
    //$("#log").append(new Date(2012, i).nextSecondMonday() + "<br /><br />"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T05:02:10.857

如果当月第二个星期一的日期小于当前日期，则在下个月的第一天调用该函数。

```
Date.prototype.nextSecondMonday= function(){
    var temp= new Date(this), d= temp.getDate(), n= 1;
    while(temp.getDay()!= 1) temp.setDate(++n);
    temp.setDate(n+7);
    if(d>temp.getDate()){
        temp.setMonth(temp.getMonth()+1, 1);
        return temp.nextSecondMonday();
    }
    return temp.toLocaleDateString();
}

/*  tests

var x= new Date(2012, 7, 22);
x.nextSecondMonday()
Monday, September 10, 2012

var x= new Date(2012, 7, 12);
x.nextSecondMonday()
Monday, August 13, 2012
*/ 
```

# jmeter - 定义一组请求以获得Jmeter中的总时间

> ID：12065147
> 
> 赞同：2
> 
> 时间：2012-08-22T01:13:24.537
> 
> 标签：jmeter

我想知道是否有创建一组 HTTP 请求以获得请求的总时间？

让我更好地解释一下，当我开始登录过程时，加载了几个资源，因为我不知道如何对这个登录过程进行分组，我必须对所有这些资源进行总和，以获得完成登录的等待时间。在一个用户中很容易，但由于我同时测试 1000 个用户，所以它变得不可能。

（我想使用用户数量与等待时间创建一个图形）

最好的祝福。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T07:39:09.827

使用[事务控制器](http://jmeter.apache.org/usermanual/component_reference.html#Transaction_Controller)作为您需要组合在一起的请求的父级。

要生成图表，我建议您使用[JMeter 插件](https://stackoverflow.com/a/11589290/465710)及其 Ultimate Thread Group 来更好地控制用户数量并显示结果使用[复合图](http://code.google.com/p/jmeter-plugins/wiki/CompositeGraph)，您将在其中显示用户数量和响应时间。

如果您不想要时间组件，您可以使用[Response times vs Threads](http://code.google.com/p/jmeter-plugins/wiki/ResponseTimesVsThreads)。它会在 X 轴上显示用户数量，在 Y 轴上显示响应时间。

# php - php如何在单个查询中添加两个where

> ID：12065150
> 
> 赞同：-1
> 
> 时间：2012-08-22T01:13:35.807
> 
> 标签：php, mysql

我有以下 sql 查询，一切正常，但是当我**输入“and posted_date<>$datetime”**时 ，它没有按照给定的命令检索数据。

```
$datetime="0000-00-00";

$data = mysql_query("SELECT * FROM product_table where category_id=$cat1 or 
pid=$par or gpid=$gpar and posted_date<>$datetime
ORDER BY autoid desc limit $no2,$cacount")

or die(mysql_error()); 
```

请检查该行是否正常，也许我**在 category_id=$cat1 或 pid=$par 或 gpid=$gpar 和 posted_date<>$datetime 的地方犯了错误**

也许我需要两个，一个用于或另一个用于和...

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:16:56.747

尝试将您的条件分组并使用`DATE()`

```
SELECT * 
FROM product_table 
where (category_id=$cat1 or 
       pid=$par or gpid=$gpar) AND DATE(posted_date) <> DATE($datetime)
ORDER BY autoid desc 
LIMIT $no2, $cacount 
```

# hibernate - Grails 中的多对多关系

> ID：12065151
> 
> 赞同：1
> 
> 时间：2012-08-22T01:13:45.013
> 
> 标签：hibernate, grails, orm, grails-orm, grails-plugin

我正在使用带有 MySQL 和 vaadin 的 hibernate、spring security 和 spring security acl 插件编写一个带有 grails 的基本 Web 应用程序，用于管理委员会、成员以及委员会和成员之间的成员资格。所有 CRUD 都适用于成员和委员会，但是当我创建一个 CommitteeMember 对象时，它无法引用该类的 Member 字段来获取有关成员资格所涉及的成员的信息。这是我的课程：

```
class Committee {
    String name
    String description
    String bylaws
    static hasMany = [members: CommitteeMember]
    static constraints = {
        name blank: false, nullable: false, matches: "[a-zA-Z0-9 ]*", unique: true
        description blank: false, nullable: false, matches: "[a-zA-Z0-9 ]*"
        bylaws blank: false, nullable: false, matches: "[a-zA-Z0-9 ]*"
   }
}

class Member {
    String firstName
    String middleName
    String lastName
    String address
    String phone

    static hasMany = [committees: CommitteeMember]
    static constraints = {
        firstName blank: false, nullable: false, matches: "[a-zA-Z]*"
        middleName blank: false, nullable: false, matches: "[a-zA-Z]*"
        lastName blank: false, nullable: false, matches: "[a-zA-Z]*"
        address blank: false, nullable: false, matches: "[0-9a-zA-Z ]*"
        phone blank: false, nullable: false, minSize: 10, maxSize: 10, matches: "[0-9]*"
    }
}

class CommitteeMember {

    Member member
    Committee committee
    Date startDate
    Date endDate
    String title
    Date created = new Date()
    Date updated = new Date()

    static constraints = {
        startDate blank: false, nullable: false, format: 'mm/dd/yyyy'
        endDate blank: false, nullable: false, format: 'mm/dd/yyyy'
        title blank: false, nullable: false, matches: "[a-zA-Z0-9 ]*"
        created blank: false, nullable: false, editable: false, display: false
        updated blank: false, nullable: false, editable: false, display: false
    }

} 
```

以及添加这些类的服务层的方法：

```
@Transactional
def saveCommittee(name, desc, bylaws) {
    new Committee(name: name, description: desc, bylaws: bylaws).save(flush: true);
}

@Transactional
def saveMember(fname, mname, lname, address, phone) {
    new Member(firstName: fname, middleName: mname, lastName: lname,
                 address: address, phone: phone).save(flush: true);
}

@Transactional
def saveCommitteeMember(cname, lname, fname, title, start, end) {
    def cmem = new CommitteeMember(title: title, startDate: start, endDate: end);
    cmem.member = Member.findByLastNameAndFirstName(lname, fname);
    cmem.committee = Committee.findByName(cname);
    cmem.save(flush: true);
} 
```

创建这些类是可行的，它们存储在数据库中。我的更新和删除方法对成员和委员会非常有用。但是，当我尝试类似

```
//this works
def cm = CommitteeMember.get(1);
def title = cm.title;

//this does not
def firstName = cm.member.firstName; 
```

委员会成员引用的成员字段均不可访问。我在这里做错了什么？我做了很多研究，找不到任何与此完全一样的东西。帮助将不胜感激。在这件事上拉我的头发..

**更新

在服务层方法`saveCommitteeMember()`中，我添加了一行`println(cmem.member.firstName);`，并且在我的 grails 启动的终端中，它确实打印了我在调用该函数时添加到委员会的成员的名字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:09:49.980

耶稣。我终于弄明白了。好的，这就是发生的事情。Hibernate 确实如此`findByFirstNameAndLastName()`，并且工作正常，但由于 grails 默认情况下是 LAZY，它只返回对该 Member 对象的 REFERENCE，而不是表中数据的对象表示。当函数返回时，该引用被销毁，且 CommitteeMember 对象的成员字段指向空。`LazyInitializationException - no session exists`这特别好，因为使用 Vaadin 插件，除非您明确尝试从 @Transaction 引用某些内容，否则您不会收到错误消息或任何错误消息，所以这样做`def fname = cm.member.firstName`没有抛出上述异常，因为 @Transaction 被认为是成功的，我只是试图读取一个空值，除了终止发生错误的函数之外，没有任何错误消息。谈论一些严肃的公牛#$&%！

无论如何，要解决这个荒谬的问题，请将其添加到您遇到空问题的对象中

```
class CommitteeMember {

    Member member
    Committee committee
    etc......

    static mapping = {
        member lazy: false
        committee lazy: false
    }

} 
```

我真的希望其他有类似问题的人能找到这篇文章。这让我在如此荒谬的事情上花费了很多时间。在某些情况下，惰性评估非常好。数据库操作，IMO，不是那种情况。总之，加油。

# mysql - 使用 MySQL 同时选择用户条目和以下条目

> ID：12065153
> 
> 赞同：0
> 
> 时间：2012-08-22T01:13:47.437
> 
> 标签：mysql, database, photo

我有一个 MySQL 数据库，其中包含一个照片表（包含照片）和一个关注表（包含有关用户关注用户的信息）。

我有以下代码来加载当前用户关注的用户的照片：

```
SELECT photos.* FROM photos,follows 
WHERE follows.following = photos.uid AND 
      follows.follower=$current_uid 
ORDER BY photos.id DESC 
```

我想加载我的用户上传的照片以及用户正在关注的照片的列表。我尝试了以下方法，但我不断收到一大堆重复的条目：

```
SELECT photos.* 
FROM photos,follows 
WHERE (follows.following = photos.uid AND 
       follows.follower=$current_uid) OR 
       photos.uid=$current_uid
ORDER BY photos.id DESC 
```

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:17:25.090

试试这个：

```
SELECT
  photos.*
FROM
  photos
LEFT OUTER JOIN
  follows
ON
  photos.uid = follows.following AND follows.follower = $current_uid
WHERE
  photos.uid = $current_uid
OR
  follows.following IS NOT NULL 
```

或者：

```
SELECT
  photos.*
FROM
  photos
WHERE
  photos.uid = $current_uid
OR
  photos.uid IN (SELECT following FROM follows WHERE follower = $current_uid) 
```

# javascript - async memoized - 理解源代码

> ID：12065158
> 
> 赞同：2
> 
> 时间：2012-08-22T01:14:06.327
> 
> 标签：javascript, memoization, async.js

从`async.memoize()`, 这个函数中注释后的最后一个 else 块是做什么的？

[https://github.com/caolan/async/blob/master/lib/async.js#L671](https://github.com/caolan/async/blob/master/lib/async.js#L671)

```
async.memoize = function (fn, hasher) {
    var memo = {};
    var queues = {};
    hasher = hasher || function (x) {
        return x;
    };
    var memoized = function () {
        var args = Array.prototype.slice.call(arguments);
        var callback = args.pop();
        var key = hasher.apply(null, args);
        if (key in memo) {
            callback.apply(null, memo[key]);
        }
        else if (key in queues) {
            queues[key].push(callback);
        }
        else {
            // what does this else block do?
            queues[key] = [callback];
            fn.apply(null, args.concat([function () {
                memo[key] = arguments;
                var q = queues[key];
                delete queues[key];
                for (var i = 0, l = q.length; i < l; i++) {
                  q[i].apply(null, arguments);
                }
            }]));
        }
    };
    memoized.unmemoized = fn;
    return memoized;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:29:54.240

If the `key` is not found in either the `memo` or the `queues` objects (the first two parts of the `if` statement), then it calls the callback and assigns the return value from the callback to `queues[key]` as a one element array.

Then, it calls whatever functions where in the `queue[key]` array.

# javascript - Cufon builder字体js文件在Fabric.js中不起作用

> ID：12065161
> 
> 赞同：1
> 
> 时间：2012-08-22T01:14:15.550
> 
> 标签：javascript, cufon, fabricjs

我已经使用 Cufon builder 下载了字体 js 文件。但是当我在画布中使用该字体时，它不起作用。请帮我...

```
<script src="js/Verdana_400.font.js"></script>

                 var textObj = new fabric.Text("Sample", { 
                      fontFamily:'Verdana_400', 
                      left: 100,
                      fontSize: 80,
                      top: 100
                  }); 
canvas.add(textObj); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T15:48:07.247

你应该试试`fontFamily: 'Verdana'`

我记得 400 是字体的正常重量。通常，字体文件的名称与 fontFamily 名称不匹配。最好在您的计算机中查看字体通常是如何命名的，然后使用该名称。例如，我有一个名为 airalbd.tff 的字体文件，我只需说`fontFaimly: 'Arial'``fontWeight: 'Bold' 来使用它。

# c# - 应用程序 exe 在启动时崩溃。错误模块路径 c:\windows\syswow64\kernalbase.dll

> ID：12065164
> 
> 赞同：0
> 
> 时间：2012-08-22T01:14:33.253
> 
> 标签：c#, .net, winforms, c#-4.0, linq-to-sql

每当我尝试在不是我的机器上启动我的应用程序时，它都会在启动时崩溃。我不知所措，做了很多搜索却没有解决办法。没有真正的错误，我只是让标准 Windows 7 没有响应。所有机器都是win7Pro 64和.net4。我在下面看到事件查看器日志。

事件 ID 1000：

```
Faulting application name: MarketingRequests.exe, version: 1.0.0.0, time stamp: 0x5033e787

Faulting module name: KERNELBASE.dll, version: 6.1.7601.17651, time stamp: 0x4a5bdbdf

Exception code: 0xe0434352

Fault offset: 0x0000b9bc

Faulting process id: 0x1ecc

Faulting application start time: 0x01cd7fe56831cfd9

Faulting application path: C\Intranet\MarketingRequests.exe

Faulting module path: C:\Windows\syswow64\KERNELBASE.dll

Report Id: a78399b1-ebd8-11e1-9474-f04da20e6eaf 
```

我还看到事件 ID 1026，.net 运行时：

```
Log Name:      Application
Source:        .NET Runtime
Date:          8/21/2012 9:08:53 PM
Event ID:      1026
Task Category: None
Level:         Error
Keywords:      Classic
User:          N/A
Computer:      CORRIE-Z.msing.local
Description:
Application: ExpenseReport.exe
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.InvalidOperationException

Stack: 
```

在 System.Data.Linq.SqlClient.SqlProvider.Execute（System.Linq.Expressions.Expression，QueryInfo，System.Data.Linq.SqlClient.IObjectReaderFactory，System.Object[]，System.Object[]，System.Data.Linq .SqlClient.ICompiledSubQuery[], System.Object) 在 System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(System.Linq.Expressions.Expression, QueryInfo[], System.Data.Linq.SqlClient.IObjectReaderFactory, System.Object[ ]，System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute 的 System.Data.Linq.SqlClient.ICompiledSubQuery[]) 在 System.Data。 Linq.DataQuery `1[[System.__Canon, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]].System.Linq.IQueryProvider.Execute[[System.__Canon, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]](System.Linq.Expressions.Expression) at System.Linq.Queryable.First[[System.__Canon, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]](System.Linq.IQueryable`1) 在 ExpenseReport.frmMain.refreshEmpInfo() 在 ExpenseReport.frmMain..ctor() 在 ExpenseReport.Program.Main()

事件 Xml：1026 2 0 0x80000000000000 26474 应用程序 CORRIE-Z.msing.local 应用程序：ExpenseReport.exe 框架版本：v4.0.30319 描述：由于未处理的异常，该进程已终止。异常信息：System.InvalidOperationException 堆栈：在 System.Data.Linq.SqlClient.SqlProvider.Execute(System.Linq.Expressions.Expression, QueryInfo, System.Data.Linq.SqlClient.IObjectReaderFactory, System.Object[], System.Object []，System.Data.Linq.SqlClient.ICompiledSubQuery[]，System.Object) 在 System.Data.Linq.SqlClient.SqlProvider.ExecuteAll(System.Linq.Expressions.Expression，QueryInfo[]，System.Data.Linq。 System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider 的 SqlClient.IObjectReaderFactory、System.Object[]、System.Data.Linq.SqlClient.ICompiledSubQuery[])。`1[[System.__Canon, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]].System.Linq.IQueryProvider.Execute[[System.__Canon, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]](System.Linq.Expressions.Expression) at System.Linq.Queryable.First[[System.__Canon, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]](System.Linq.IQueryable`1<System.__Canon>) 在 ExpenseReport.frmMain.refreshEmpInfo() 在 ExpenseReport.frmMain..ctor() 在 ExpenseReport.Program.Main()

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:07:17.977

它看起来`frmMain.refreshEmpInfo`包含一个从数据库中检索记录的 LINQ 查询，并且 LINQ 查询调用`First()`以获取第一条记录。是否有可能没有记录被返回，这会导致`First()`抛出一个`InvalidOperationException`？

（如果您在 中发布代码可能会有所帮助`frmMain.refreshEmpInfo`。您可能还希望将该代码包装在一个`try...catch`块中并在消息框中显示异常详细信息。）

# xss - 使用 ckeditor 预防 xss

> ID：12065174
> 
> 赞同：3
> 
> 时间：2012-08-22T01:16:04.467
> 
> 标签：xss

我的情况有点不同，我使用 CKEditor 来编辑和显示内容，提交的字符串只会显示在 CKEditor 内部，没有其他地方。

我试过这个 XSS：

```
<IMG """><SCRIPT>alert("XSS")</SCRIPT>"> 
```

我直接从后端将它添加到数据库中，而不是通过 CKEditor，因为我知道 CKEditor 在进入数据库之前做什么并不重要，因为攻击者总是可以发送一些原始 http 请求而不处理 CKEditor。

令我惊讶的是，CKEditor 向我展示了这个：

```
{cke_protected_1}"> 
```

所以CKEditor正在做一些事情来防止XSS，我意识到XSS安全可以从客户端实现。

我的问题是，CKEditor 做得有多好，如果我只使用无属性标签加上它是否可靠

```
<a><img><table><span><pre>
(<a> and <table> could be disabled if it makes things easier) 
```

PS：CKEditor 使用默认设置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T20:26:34.130

您应该在服务器端防范 XSS。如果您有这种可能性，请在保存之前删除任何不安全的数据。

请注意，所见即所得编辑器必须以某种方式保护包含在已编辑 HTML 中的 JavaScript 代码，以免破坏已编辑内容，其中包括隐藏在所见即所得模式中的`<script>`标签或将`onclick`事件处理程序更改为“数据”属性。

{cke_protected_1} 是 CKEditor 试图隐藏 <script> 标记的结果，由于从 XSS 备忘单中获取的有点“hackish”的 HTML，该标记无法完全正常工作。

所见即所得编辑器中的部分内置保护不应被视为替代服务器端针对 XSS 的保护。

# jquery - Jquery append() 无法正常工作

> ID：12065177
> 
> 赞同：0
> 
> 时间：2012-08-22T01:16:10.133
> 
> 标签：jquery, html

所以我有一个动态插入的评论表单，在提交表单后，我将它与服务器 ajax，并将评论附加到评论部分，但附加部分不起作用。这就是我所拥有的：

```
$(".action-link-comment").click(function() {
  if ($(this).parent().parent().find('.comment-form')[0]){
    return false;
  }
  $(this).parent().parent().append('<div class="comment-form"><form class="comment-input"><input class="input-xlarge comment-val" type="text" placeholder="Write a comment..." style="height:14px;"/><input type="submit" style="position:absolute;left:-9999px;width:1px;height:1px;"/></form></div>');
  $(".comment-input").submit(function(event) {
    event.preventDefault();
    var comment = $(this).find('.comment-val').val();
    var post_id = $(this).parent().parent().find('.post-id').html();
    $.ajax({
      url:'/comment',
      type: 'POST',
      dataType: 'json',
      data : {'p' : post_id,
        'data' : comment},
        success: function(response, textStatus, jqXHR) {
          $(this).parent().parent().siblings('.comments-container').append('<div class="comment"><label class="hover><a href="/user/' + response.userid + '"><strong>' + response.name + '</strong><' + '/a><' + '/label><span class="displaynone comment-id">' + response.comment_id + '</span><span class="comment-content">' + response.data + '</span><div class="comment-actions"><a href="javascript:void(0)" class="c-action"><i class="icon-thumbs-up"></i>Like</a><a href="javascript:void(0)" class="c-action"><i class="icon-thumbs-down"></i>Dislike</a><a href="javascript:void(0)" class="c-action reply"><i class="icon-pencil"></i>Reply</a></div>');
        },
    });

  });
}); 
```

对于 HTML：

```
<div class="post-container">
    ...
    <div class="post-actions">
        <span class="p-action comment">
            <a class="action-link-comment" href="javascript:void(0)">Comment</a>
        </span>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:22:42.067

您应该缓存您的`this`对象，在`success`函数的上下文中`this`不引用您想要的对象。

```
$(".action-link-comment").click(function() {
         var $this = $(this);       
         //....  
         success: function(response, textStatus, jqXHR) {
              $this.parent().parent()
         // ...
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T01:22:51.923

`this`里面使用`success`的时候，*不*指代`.comment-input`。在进行`ajax`调用之前存储参考：

```
$(".action-link-comment").click(function() {
    var self = this;
    // ...
    $.ajax({
     // ...
     success: function(response, textStatus, jqXHR) {
       $(self).parent().parent()...
     }
    });
}); 
```

# php - 使用数组使用 foreach 填充其他变量

> ID：12065179
> 
> 赞同：3
> 
> 时间：2012-08-22T01:16:34.097
> 
> 标签：php, sql, arrays, post, foreach

简单来说，我有一个具有三个相同输入字段的表单。名称不同；但是，发布时它们具有相同的结构，只是名称前缀不同（即三个系统具有不同的名称前缀：它们是 windowstitle、mactitle、linuxtitle 等）。

目前，我有一个只能使用一个同名的过程，即 windowstitle（当然，如果表格已填写）

代码看起来像这样：

```
<?php
$title = $_POST['windowstitle'];
//validate info or redirect
if ($title != "" ) {
    $title = mysql_real_escape_string($title);
    $sql = "insert into newwindows (title) values ('$title');
    $result = mysql_query($sql) or die ("Could not insert data into DB: " . mysql_error());
?> 
```

表单块也看起来像这样

```
<form action="newuserprocess.php" method="post" enctype="multipart/form-data">
<div class="form">
    <h3>Windows</h3>

    <!-- title of system name -->
    <p><label for="windowstitle"> edition of system </lable></p>
    <input type="text" name="windowstitle"  size=20 /><br />
    </div>
    <div class="form">
    <h3>Mac</h3>

    <!-- title of system name -->
    <p><label for="mactitle"> edition of system </lable></p>
    <input type="text" name="mactitle"  size=20 /><br />
    </div>
<p><input type="submit" id="submit" class="bigbutton" value="Upload" /></p>
</form> 
```

然而，这留下了其他形式，唯一的区别是我想要输入的数据库和后值前缀不同。

所以我想出了一个我认为是聪明的解决方案：

```
<?php
$arr = array('windows', 'mac', 'linux');
foreach ($arr as &$value) {
    $title = $_POST['$valuetitle'];
    //validate info 
    if ($title != "" ) {
        $title = mysql_real_escape_string($title);
        $sql = "insert into new$value (title) values ('$title');
        $result = mysql_query($sql) or die ("Could not insert data into DB: " . mysql_error());
    }
?> 
```

但是，这不起作用。我知道部分原因；因为`''`使变量按原样显示，因此 my`$_Post`将始终以 $value 的形式返回。另一个原因与我的 new$value 数据库名称相同。什么是正确的格式？我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:21:53.477

你可能想要

```
$title = $_POST[$value . 'title']; 
```

和

```
$sql = "insert into new$value (title) values ('$title')"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:31:37.677

`Another reason is the same with my new$value database name. My question is what is the proper format for this?`

为了清楚起见，我会`$value`用括号括起来`{$value}`。您的格式有效，但可能更清晰。查看一些测试：http: [//ideone.com/A2kWU](http://ideone.com/A2kWU)

此外，如果您不更改数组中的值，`$arr`那么您应该使用

```
foreach ($arr as $value) { //... 
```

以防止意外更改。不过，在这种情况下，这没什么大不了的，因为您只使用了一次数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T11:16:08.310

编辑您的代码，如：

```
<?php
     $arr = array('windows', 'mac', 'linux');
     foreach ($arr as $value) { 
```

# actionscript - 动作脚本getUrl问题

> ID：12065187
> 
> 赞同：0
> 
> 时间：2012-08-22T01:17:33.420
> 
> 标签：actionscript, actionscript-2

在 as2 中使用 getUrl 时遇到问题，当我使用测试电影运行 swf 时，链接可能会起作用，但如果我运行已发布的文件，则会得到错误的 url，例如

-通过测试电影运行：getting -> www.google.com
-运行发布的 swf 文件：getting ->file:///C:/Users/moata/Desktop/actionScript/www.google.com

```
dots.ignoreWhite = true;
dots.load('links.xml');

dots.onLoad = function(success:Boolean){
    if(success){
        xmlNode = this.firstChild;
        var all:MovieClip = attachMovie("test","all",depth);
        setTimeout(startMe,6000);
    }else{
        trace("Could not load XML");
    }

    function startMe (){

        for(i=1;i<=6;i++){

            all['btn'+i].onRelease = function() {

                for(i=0;i<6;i++){
                    var name = this;
                    if(String(xmlNode.childNodes[i].attributes.TITLE) == String(name)){
                        getURL(xmlNode.childNodes[i].childNodes[0].nodeValue, "_blank");
                    }
                }       
            }

        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:32:50.740

i just need add http:// in getRUL as follow getURL("http://www.google.com"); , instead of getURL("www.google.com");

# iphone - 应用程序旋转，即使我告诉它不要

> ID：12065195
> 
> 赞同：0
> 
> 时间：2012-08-22T01:19:28.133
> 
> 标签：iphone, objective-c, ios, xcode

用 Xcode 编写了一个应用程序。单击将方向限制为两个纵向选项的按钮。将 plist 文件更改为仅允许两个纵向。以编程方式设置限制。

当我在手机上构建应用程序时，它会旋转为横向和竖直纵向。有没有搞错？

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return ((interfaceOrientation == UIInterfaceOrientationPortrait) ||
            (interfaceOrientation == UIInterfaceOrientationPortraitUpsideDown));
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T06:30:52.350

您正在使用的方法是控制器类的一部分，但如果控制器类未处于活动状态或无法控制屏幕上的视图，则该方法可能永远不会被调用。因此，您的应用程序可能会自动旋转，因为该消息实际上从未真正被调用过。解决方案是检查视图控制器类的连接或初始化，以确保它们按预期运行。

# html - 向 rails date_select 助手添加标签

> ID：12065198
> 
> 赞同：5
> 
> 时间：2012-08-22T01:20:44.943
> 
> 标签：html, ruby-on-rails, ruby, forms, accessibility

我目前正在对网站进行可访问性大修，遇到了一个我不知道如何在 Rails 中解决的问题。代码如下：

```
<%= f.label :birthdate %>
<%= f.date_select :birthdate, {:start_year => Time.now.year - 14, :end_year => 1900, :prompt => true, :order => [:day, :month, :year]} %> 
```

产生：

```
<label for="birthdate">Birthdate</label>
<select id="birthdate_3i" name="birthdate(3i)">
    <option value="">Day</option>
    <option value="1">1</option>
        ...
    <option value="31">31</option>
</select>
<select id="birthdate_2i" name="birthdate(2i)">
    <option value="">Month</option>
    <option value="1">January</option>
        ...
    <option value="12">December</option>
</select>
<select id="birthdate_1i" name="birthdate(1i)">
    <option value="">Year</option>
    <option value="1998">1998</option>
        ...
    <option value="1900">1900</option>
</select> 
```

有谁知道我是否必须为已生成的 3 个选择字段手动编写标签/字段集？或者我应该以不同的方式使用 rails 代码。我对 Rails 有点陌生……更像是一个前端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-12-15T16:53:18.487

我最近在一个项目中遇到了这个问题，我们发现`select`在 Rails 日期选择中每个之前添加标签的唯一方法是对 Rails 进行猴子补丁。我们在 Rails 5.1.4 上。这是构建月/日/年选择并在最后 2 个选择之前放置分隔符的原始方法，当`date_separator`作为参数传递时：

[https://github.com/rails/rails/blob/2c97fbf6503c9199f3fe5ed06222e7226dc6fcd9/actionview/lib/action_view/helpers/date_helper.rb#L1091](https://github.com/rails/rails/blob/2c97fbf6503c9199f3fe5ed06222e7226dc6fcd9/actionview/lib/action_view/helpers/date_helper.rb#L1091)

这是我们的猴子补丁，它使用正确的标签在*每个*日期选择之前放置一个图例分隔符：`for`

```
module ActionView
  module Helpers
    class DateTimeSelector

      # Given an ordering of datetime components, create the selection HTML
      # and join them with their appropriate separators.
      def build_selects_from_types(order)
        select = ""
        order.reverse_each do |type|
          separator = separator(type)
          select.insert(0, separator.to_s + send("select_#{type}").to_s)
        end
        select.html_safe
      end

      # Returns the separator for a given datetime component.
      def separator(type)
        return "" if @options[:use_hidden]
        field_name = "#{@options[:prefix]}_#{@options[:field_name]}"
        case type
          when :year
            "<label for='#{field_name}_1i'>Year</label>"
          when :month
            "<label for='#{field_name}_2i'>Month</label>"
          when :day
            "<label for='#{field_name}_3i'>Day</label>"
          when :hour
            (@options[:discard_year] && @options[:discard_day]) ? "" : @options[:datetime_separator]
          when :minute, :second
            @options[:"discard_#{type}"] ? "" : @options[:time_separator]
        end
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:23:39.413

```
date_select("DOB", :birthdate, :prompt => {
:day => 'Select day', :month => 'Select month', :year => 'Select year',
:start_year => Time.now.year - 14, :end_year => 1900
}) 
```

更多选项：
[http ://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-date_select](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-date_select)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:37:10.610

我认为不可能生成单独的标签。即使您愿意接受一个标签，还有一个额外的障碍是它不是严格有效的 HTML，因为没有“生日”表单控件。你应该在标签助手中使用 :birthdate_3i 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-07T18:32:58.707

只需将其包裹`date_select`在`div`or中即可`fieldset`。标签可以指向任何带有 ID 的东西，如果您有多个输入到一个数据类型中（如 rails `date_select`），那么您可以标记容器，并让选择框成为它的组件。

```
<%= f.label :birthdate %>
<div id="birthdate">
  <%= f.date_select :birthdate, {:start_year => Time.now.year - 14, :end_year => 1900, :prompt => true, :order => [:day, :month, :year]} %>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-13T07:56:30.910

有一种方法不包括修补 Rails。不过，它仍然很hacky。这个想法是增加由`date_select`. 我们将使用 Nokogiri 来执行此操作（`gem 'nokogiri'`在 Gemfile 中需要）。

下面的代码添加`date_select_with_labels`到执行此操作的股票表单构建器中：

```
class ActionView::Helpers::FormBuilder
  def date_select_with_labels(attribute, options = {})
    generated_selects = @template.date_select(object.model_name.singular, attribute, options)

    selects_with_labels = Nokogiri::HTML::Document.parse(generated_selects).css('select').map do |select|
      label(
        attribute,
        date_select_part_type_from_options(select, options[:include_blank]),
        options.reverse_merge(for: select.attr('id'))
      ) +
        select.to_s.html_safe
    end

    @template.content_tag(:div) do
      selects_with_labels.join('').html_safe
    end
  end

  private

  def date_select_part_type_from_options(select, include_blank)
    maybe_one = include_blank ? 1 : 0

    case select.css('option').size
    when 12 + maybe_one
      'Month'
    when (28 + maybe_one)..(31 + maybe_one)
      'Day'
    else
      'Year'
    end
  end
end 
```

# php - 访问 stdClass 对象

> ID：12065210
> 
> 赞同：-3
> 
> 时间：2012-08-22T01:23:26.523
> 
> 标签：php, object, multidimensional-array

访问这些对象的最佳方式是什么`tag_id`？

`Array ( [0] => stdClass Object ( [tag_id] => 100001 ) )`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:27:20.767

像这样：

```
echo $var[0]->tag_id; 
```

# javascript - 单个应用程序中的点云 www 和 TCP -

> ID：12065217
> 
> 赞同：2
> 
> 时间：2012-08-22T01:24:18.910
> 
> 标签：javascript, node.js, dotcloud, tcpsocket

我正在尝试运行一个 nodejs 套接字服务器，该服务器将允许两个运行 Flash 游戏的客户端之间进行远程通信，该游戏使用自定义协议进行通信。由于 Flash 安全限制，似乎套接字服务器必须与为 Flash 游戏提供服务的 Web 服务器运行在同一主机上。我一直在收到以下错误：

```
The service crashed at startup or is listening to the wrong port. It failed to respond on port "nodejs" (8080) within 30 seconds 
```

我需要的是一种运行我的 nodeJS 服务器代码的方法，同时提供 flash 文件。

我正在使用环境 JSON 变量来确定要监听的端口，我的 YML 与[此处](http://answers.dotcloud.com/question/340/simple-tcpudp-service-in-nodejs)讨论的类似，但没有运气......只是想知道我是否可以获得一些有关如何创建工作套接字服务器/网络的信息将为此工作的服务器（或者如果它实际上是可能的）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T04:34:59.970

您可以使用以下`dotcloud.yml`文件：

```
www:
  type: nodejs
  ports:
    mything: tcp 
```

然后在您的 Node.js 应用程序中，您可以将 HTTP 服务器绑定到端口 8080，并将任意 TCP 服务器绑定到环境变量包含的端口`$PORT_MYTHING`。然后`dotcloud info`在您的服务上运行；在该`ports`部分中，您将看到如下内容：

```
-   name: mything
    url: tcp://myapp-johndoe.dotcloud.com:12345 
```

从现在开始，如果您连接到`myapp-johndoe.dotcloud.com`on port `12345`，您将实际连接到`$PORT_MYTHING`您的应用程序中。

我希望这是有道理的，并且这就是您要寻找的东西！

# api - JIRA - 获取未解决问题的列表

> ID：12065222
> 
> 赞同：2
> 
> 时间：2012-08-22T01:25:24.253
> 
> 标签：api, jira

我是 JIRA API 编程的新手。我需要得到一份未解决问题的清单。从 API 来看，函数 getIssuesFromFilterWithLimit() 看起来很可能是候选函数。而且我还在另一个 SO 线程上读到，如果系统分辨率字段不包含任何值，则问题未解决。那么，我将如何用伪代码构造调用，例如（我在这里钓鱼）：

```
getIssuesFromFilterWithLimit(resolution=NULL) 
```

还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:45:24.200

根据 JIRA RPC 文档，[getIssuesFromFilterWithLimit](http://docs.atlassian.com/rpc-jira-plugin/latest/com/atlassian/jira/rpc/soap/JiraSoapService.html#getIssuesFromFilterWithLimit%28java.lang.String,%20java.lang.String,%20int,%20int%29)使用预定义的 JIRA 过滤器来检索问题。它不适用于调用者提供的查询或搜索词。

要使用此方法，您需要在 JIRA 中定义一个过滤器，以便可以在[getIssuesFromFilterWithLimit](http://docs.atlassian.com/rpc-jira-plugin/latest/com/atlassian/jira/rpc/soap/JiraSoapService.html#getIssuesFromFilterWithLimit%28java.lang.String,%20java.lang.String,%20int,%20int%29)调用中引用它。

另一种方法是使用[getIssuesFromJQLSearch](http://docs.atlassian.com/rpc-jira-plugin/latest/com/atlassian/jira/rpc/soap/JiraSoapService.html#getIssuesFromJqlSearch%28java.lang.String,%20java.lang.String,%20int%29)，它与调用者提供的 JQL 表达式一起使用来检索问题。现在解决问题的 JQL 将是`resolved is EMPTY`.

# c# - 线程安全货币管理器

> ID：12065225
> 
> 赞同：0
> 
> 时间：2012-08-22T01:26:27.947
> 
> 标签：c#, winforms, multithreading, currencymanager

我的 datagridview 绑定到一个列表，我在后台线程中将项目添加到列表中。如果我在 UI 线程中调用 CurrencyManager.refresh，是否需要同步。也就是 refresh 和 list.add 可以在不同步的情况下并发运行吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:15:39.000

`List<T>`不是线程安全的，您需要提供同步。`ArrayList`有[同步方法](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.synchronized.aspx)

# jquery - asp.net 4.5 Web 表单不显眼的验证 jQuery 问题

> ID：12065228
> 
> 赞同：5
> 
> 时间：2012-08-22T01:27:16.273
> 
> 标签：jquery, asp.net, webforms, asp.net-4.5

我一直在检查 4.5 中 Web 窗体的一些新功能，但我遇到了不显眼的验证障碍。

Web Forms 4.5 中的不显眼验证依赖于 jQuery，当启用它时，将导致页面正文中服务器表单内部的 jQuery 脚本引用。这听起来很棒，我喜欢这个概念。它在我看过的演示中效果很好，代码中的减少/清理是一件很漂亮的事情。

但是，当我在预先存在的项目中启用此功能时，我遇到了问题。问题是我有无数的页面和应用程序使用 jQuery 进行客户端交互（jQuery UI 是一个典型的例子），在这些页面中，我在页面的标题部分有一个 jQuery 参考和随附的代码。当启用不显眼的验证时，结果是页面上的第二个 jQuery 引用，并且标头中的 javascript 中断。

有没有办法让我告诉脚本管理器 jQuery 已经加载到页面中，这样就不会添加第二个引用？或者，我有没有办法告诉脚本管理器或 Web 窗体框架检查页面是否存在现有的 jQuery 参考？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-27T18:49:21.163

不幸的是，ScriptResourceMapping 是必需的。但是，通过一些工作，您可以从 ScriptManager 中删除引用，这样它就不会再次呈现 jQuery。

在您的 Web 项目中创建您自己的派生自 ScriptManager 的类：

```
using System;
using System.Linq;
using System.Web.UI;

namespace WebApplication46
{
    public class CustomScriptManager : ScriptManager
    {
        protected override void OnInit(EventArgs e)
        {
            Page.PreRenderComplete += Page_PreRenderComplete;
            base.OnInit(e);
        }

        private void Page_PreRenderComplete(object sender, EventArgs e)
        {
            var jqueryReferences = Scripts.Where(s => s.Name.Equals("jquery", StringComparison.OrdinalIgnoreCase)).ToList();
            if (jqueryReferences.Count > 0)
            {
                // Remove the jquery references as we're rendering it manually in the master page <head>
                foreach (var reference in jqueryReferences)
                {
                    Scripts.Remove(reference);
                }
            }
        }
    }
} 
```

接下来，在您的 web.config 中配置一个 tagMapping 条目，以便 ASP.NET 将使用您的自定义 ScriptManager 而不是框中的那个：

```
<system.web>
  <pages>
    <tagMapping>
      <add tagType="System.Web.UI.ScriptManager" mappedTagType="WebApplication46.CustomScriptManager" />
    </tagMapping>
  </pages>
</system.web> 
```

而已。现在，您的 CustomScriptManager 将确保在 ScriptManager 有机会启动其呈现逻辑之前从其自身中删除所有 jQuery 引用，并且您仍将满足 UnobtrusiveValidation 工作的所有要求（假设您在页面标签中有对 jQuery 的引用）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-31T00:59:22.537

正如[Damian Edwards 所说](https://stackoverflow.com/questions/12065228/asp-net-4-5-web-forms-unobtrusive-validation-jquery-issue/12628170#12628170)，您似乎无法删除引用，因此我采用的解决方案是创建一个指向空 JS 文件的假 jQuery 引用。这仍然会创建不可避免的额外脚本标签以尝试加载 jQuery，但它不会是实际的 jQuery 库，因此不会与 head 标签中的 jQuery 引用发生冲突。

```
public class Global : System.Web.HttpApplication
{
    protected void Application_Start(object sender, EventArgs e)
    {
        ScriptManager.ScriptResourceMapping.AddDefinition("jquery", new ScriptResourceDefinition
        {
            Path = "~/Scripts/empty-file.js"
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T05:12:37.473

是的，您可以使用 scriptmanager 注册一个脚本引用（名称=jquery），这将告诉不显眼的验证系统 jquery 已注册，并且由于您自己渲染脚本，所以它会全部工作

# google-drive-api - Google 云端硬盘文件 etag

> ID：12065231
> 
> 赞同：2
> 
> 时间：2012-08-22T01:28:16.630
> 
> 标签：google-drive-api

文件资源的 etag 是如何工作的？即使没有对文件进行任何更改，它看起来也正在发生变化。

有没有办法获得校验和或仅在文件更新时才更改的东西？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:25:22.537

当文件的元数据更改时，文件的 Etag 也会更改。如果您只想监视文件内容的更改，则可以使用该`md5Checksum`字段：

[https://developers.google.com/drive/v2/reference/files#resource](https://developers.google.com/drive/v2/reference/files#resource)

# spring - 如何劫持/拦截来自第三方（EclipseLink）jar甚至JDK的类的方法？

> ID：12065232
> 
> 赞同：1
> 
> 时间：2012-08-22T01:28:20.380
> 
> 标签：spring, aop, aspectj

我试图劫持/拦截 EclipseLink 中的一个类的方法。我曾尝试过 Spring AOP 和 AspectJ，但失败了。我想`org.eclipse.persistence.internal.localization.i18n.TraceLocalizationResource`在调用方法时类抛出异常时做一些事情`getString(..);`我的实现如下：

```
@AfterThrowing(pointcut = "execution(* org.eclipse.persistence.internal.localization.i18n.TraceLocalizationResource.getString(..))",throwing="error")
    public void logAfterThrowing(JoinPoint joinPoint,Throwable error) {
....
} 
```

并调用了 calss `TraceLocalizationResource`（我对其进行了调试）。但是劫持方法没有被调用。

我的问题：

1.  我做错了吗？
2.  我们要劫持或拦截的目标类必须是自定义类型？
3.  如果我想劫持 JDK 中的一个类，比如 java.lang.String 怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T11:19:41.467

1.  基本上语法看起来不错，但我没有尝试从您的代码片段中复制完整的方面。此外，我只使用原生 AspectJ 语法，对基于注解的语法不太熟悉，所以如果出现问题，我可能没有看到。

2.  不可以，但是如果您想编织一个由您的主应用程序使用的库（JAR 或解压缩到文件系统中），您必须确保它位于编织器的路径中。有关语法，请参阅 AspectJ 文档。**编辑：**我今天早些时候在[另一个答案](https://stackoverflow.com/a/12064531/1082681)中发布了一些有用的链接。

3.  默认情况下，包`org.aspectj`和`java`被`javax`排除在编织之外。对于后两者，有命令行开关来启用编织。但是 LTW 充其量是棘手的，最坏的情况是 a**（几乎是不可能的），因为你有一个先有后裔的问题：AspectJ weaver 运行时类需要 JDK，而 JDK 引导发生在任何 Java 之前像织布工这样的代理人被附上。所以你最好的选择是编译 JDK 类的编织，然后在你的应用程序中使用编织的 rt.jar。即使使用编译时编织，如果您的建议本身使用 JDK 编织类，您也可能会遇到问题。你要确保在那里避免无限递归。但这是可能的。

    **更新：**对于使用 AspectJ 一段时间的人来说，另一个提示有时似乎太简单了：不要使用`execution`需要编织目标类的`call`切入点，您可以只使用拦截（顾名思义）调用的切入点到您的客户类中的任何地方的目标。它的效率可能会稍低一些，但可能是您最好和最简单的选择，除非您真的想不厌其烦地编写 JDK。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-27T17:24:09.327

可以编织第三方库，但您必须配置 aspectj-maven-plugin 插件：

```
<project>
  ...
  <dependencies>
    ...
    <dependency>
      <groupId>org.aspectj</groupId>
      <artifactId>aspectjrt</artifactId>
      <version>1.8.9</version>
    </dependency>

     <dependency>
      <groupId>org.agroup</groupId>
      <artifactId>to-weave</artifactId>
      <version>1.0</version>
    </dependency>

    <dependency>
      <groupId>org.anothergroup</groupId>
      <artifactId>gen</artifactId>
      <version>1.0</version>
    </dependency>
    ...
  </dependencies>
  ...
  <build>
    <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>aspectj-maven-plugin</artifactId>
        <version>1.9</version>
        <configuration>
          <weaveDependencies>
            <weaveDependency>
              <groupId>org.agroup</groupId>
              <artifactId>to-weave</artifactId>
            </weaveDependency>
            <weaveDependency>
              <groupId>org.anothergroup</groupId>
              <artifactId>gen</artifactId>
            </weaveDependency>
          </weaveDependencies>
        </configuration>
        <executions>
          <execution>
            <goals>
              <goal>compile</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      ...
    </plugins>
  <build>
  ...
</project> 
```

来源：[http ://www.mojohaus.org/aspectj-maven-plugin/examples/weaveJars.html](http://www.mojohaus.org/aspectj-maven-plugin/examples/weaveJars.html)

# java - Getting Value of JTable Cells

> ID：12065244
> 
> 赞同：3
> 
> 时间：2012-08-22T01:30:35.340
> 
> 标签：java, swing, jtable, edit, tablecelleditor

I have this JTable of 3 columns and of variable rows. The user can edit the value of any of the cells (because the cells are selectable) and hit enter. Once s/he presses "SAVE", I then get every cell's value, and combine them into a single string, with each cell's value separated by a pipe ( | ). eg ( Col1|Col1|Col1|Col2|Col2|Col2| ) So far, so good.

The thing is, although this string conversion method works, when the user changes the value of the cells in the table, the code still gets the OLD value of the cells of the JTable. Follow me so far? I'm not sure how I can remedy this. Here's the code below, just in case it is required. (I realize my StringBuffer is something I should learn to move away from)

```
int rowNumber = inventoryData.getModel().getRowCount();
StringBuffer compiledData = new StringBuffer();
Object currentData = null;
for(int i=0;i<rowNumber;i++){
    if(inventoryData.getModel().getValueAt(i, 0) != null) currentData = inventoryData.getModel().getValueAt(i, 0).toString();
    compiledData.append(currentData.toString()+"|");
    if(inventoryData.getModel().getValueAt(i, 1) != null) currentData = inventoryData.getModel().getValueAt(i, 1).toString();
    compiledData.append(currentData.toString()+"|");
    if(inventoryData.getModel().getValueAt(i, 2) != null) currentData = inventoryData.getModel().getValueAt(i, 2).toString();
    compiledData.append(currentData.toString()+"|");
    currentData = "";
}
String repPipesRemoved = compiledData.toString().replaceAll("([|])\\1+", "");

StringBuffer tempBuffer = new StringBuffer(repPipesRemoved);
tempBuffer.append("|");
String finalString = tempBuffer.toString(); 
```

Thanks for reading - got any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T14:17:20.550

你可以试试这个[答案](https://stackoverflow.com/a/377937/261156)：

```
table.putClientProperty("terminateEditOnFocusLost", Boolean.TRUE); 
```

# git - what's wrong with my git-svn command? cannot fork git.pm, why?

> ID：12065245
> 
> 赞同：3
> 
> 时间：2012-08-22T01:30:36.230
> 
> 标签：git, svn, git-svn

I was cloning a opensource project using git-svn, but failed.

this issue is different from [https://superuser.com/questions/266338/git-svn-fails-with-fatal-error](https://superuser.com/questions/266338/git-svn-fails-with-fatal-error) since i am not using cygwin this time:(

The error message is different as before, it just cannot fork:(

```
r6686 = f7adf2ab3ed10abac505b6ee5c88f983f3080e28 (refs/remotes/tags/NaiveBayes-1.0.1@8503)
Can't fork at /usr/lib/perl5/vendor_perl/5.8.8/Git.pm line 1262.

real    550m4.292s
user    17m12.441s
sys     52m29.003s 
```

git svn failed after 10 hours hardworking, what i can do after that?

# haskell - Haskell：HList 和可选参数

> ID：12065246
> 
> 赞同：6
> 
> 时间：2012-08-22T01:30:51.363
> 
> 标签：haskell, hlist

我一直在尝试使用[HList](http://hackage.haskell.org/package/HList-0.2.3)来创建记录。

我一直在使用[HList-GHCSyntax](http://hackage.haskell.org/packages/archive/HList/0.2.3/doc/html/Data-HList-GhcSyntax.html)中定义的运算符。

到目前为止它工作得很好，让我可以写这样的东西：

```
myRecord = 
  (param1 .=. "param1value") .*. 
  (param2 .=. "param2value") .*. 
  emptyRecord 
```

这允许我执行以下操作：

```
myRecord .!. param1 
```

以及以下内容：

```
myRecord .!. param3 
```

按预期抛出编译错误。如果需要，这很好`param3`用，因为我得到编译时参数检查。

但我也想处理`param3`可选的情况。我怎样才能做到这一点？

* * *

**编辑：**以下似乎有效（`Empty`是一个空类型）：

```
getOptional r l = (hLeftUnion r ((l .=. Empty) .*. emptyRecord)) .!. l 
```

但我真的不知道如何检查`Empty`调用代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T12:43:37.887

定义的问题`getOptional`是确定结果类型。如果有人尝试：

```
class GetOptional r l v | r l -> v where
  getOptional :: l -> Record r -> Maybe vs 
```

或者

```
class GetOptional r l v | r l -> v where
  getOptional :: l -> Record r -> Maybe v 
```

那么`v`可以通过查找来确定当`l`在`r`时，但如果`l`不在`r`那么应该`v`从哪里来？选择（）还是空？离开函数依赖使用户在某处提供类型注释。

也许更好的方法是提供一个默认值（比如 fromMaybe）：

```
class GetOptional r l v where
  getOptional :: l -> v -> Record r -> v 
```

更复杂的版本可能会提供一个函数来使用现有值`(v->w)`和默认值`w`。

这对我有用：

```
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE FlexibleInstances #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE UndecidableInstances #-}
import Data.HList.FakePrelude(HEq,HTrue,HFalse)
import Data.HList.HListPrelude(HNil(HNil),HCons(HCons))
import Data.HList.GhcSyntax((.=.),(.*.))
import Data.HList.Record(Record(Record),LVPair(LVPair),emptyRecord)

class GetOptional l r v where
  getOptional :: l -> v -> Record r -> v

instance GetOptional l HNil v where
  getOptional _ v _ = v

instance ( HEq l l' b
         , GetOptional' b l (HCons (LVPair l' v') r) v
         )
         => GetOptional l (HCons (LVPair l' v') r) v where
  getOptional l v (Record r) = getOptional' (undefined :: b) l v r

class GetOptional' b l r v where
  getOptional' :: b -> l -> v -> r -> v

instance GetOptional' HTrue l (HCons (LVPair l v) r) v where
  getOptional' _ _ _ (HCons (LVPair v) _) = v

instance ( GetOptional l r v
         )
         => GetOptional' HFalse l (HCons (LVPair l' v') r) v where
  getOptional' _ l v (HCons _ r) = getOptional l v (Record r)

data L1 = L1
data L2 = L2

e = emptyRecord
f = L1 .=. True .*. emptyRecord

-- test1 :: Bool
test1 = getOptional L1 False f
-- test2 :: Bool
test2 = getOptional L1 False e
-- test3 :: ()
test3 = getOptional L2 () f
-- test4 gives a type error:
-- test4 = getOptional L1 () f 
```

我还包括使用“更高级别”HList 谓词的第二个实现。这将删除 GetOptional 类型类并使 getOptional 成为一个简单的函数：

```
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE FlexibleInstances #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE UndecidableInstances #-}
import Data.HList.FakePrelude(HFalse,HTrue)
import Data.HList.HListPrelude(HMember,hMember)
import Data.HList.GhcSyntax((.=.),(.*.))
import Data.HList.Record(RecordLabels,Record,HasField(hLookupByLabel),recordLabels,emptyRecord)

-- This type is inferred properly
-- getOptional :: ( RecordLabels r ls
--                , HMember l ls b
--                , GetOptional' b l r v )
--               =>  l -> v -> Record r -> v
getOptional l v rec = getOptional' (hMember l (recordLabels rec)) l v rec

class GetOptional' b l r v where
  getOptional' :: b -> l -> v -> Record r -> v

instance GetOptional' HFalse l rec v where
  getOptional' _ _ v _ = v

instance ( HasField l r v )
         => GetOptional' HTrue l r v where
  getOptional' _ l _ r = hLookupByLabel l r

data L1 = L1
data L2 = L2

e = emptyRecord
f = L1 .=. True .*. emptyRecord

-- test1 :: Bool
test1 = getOptional L1 False f
-- test2 :: Bool
test2 = getOptional L1 False e
-- test3 :: ()
test3 = getOptional L2 () f
-- test4 gives a type error:
-- test4 = getOptional L1 () f 
```

编辑：这是可能的版本，它需要所有无答案的类型注释：

```
{-# LANGUAGE MultiParamTypeClasses #-}
{-# LANGUAGE FlexibleInstances #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE UndecidableInstances #-}
import Data.HList.FakePrelude(HFalse,HTrue)
import Data.HList.HListPrelude(HMember,hMember)
import Data.HList.GhcSyntax((.=.),(.*.))
import Data.HList.Record(RecordLabels,Record,HasField(hLookupByLabel),recordLabels,emptyRecord)
import Data.HList.TypeCastGeneric1
import Data.HList.TypeEqGeneric1
import Data.HList.Label5

-- getOptional :: ( RecordLabels r ls
--                , HMember l ls b
--                , GetOptional' b l r v )
--               =>  l -> Record r -> Maybe v
getOptional l rec = getOptional' (hMember l (recordLabels rec)) l rec

class GetOptional' b l r v where
  getOptional' :: b -> l -> Record r -> Maybe v

instance GetOptional' HFalse l rec v where
  getOptional' _ _ _ = Nothing

instance ( HasField l r v )
         => GetOptional' HTrue l r v where
  getOptional' _ l r = Just (hLookupByLabel l r)

data L1 = L1
data L2 = L2

e = emptyRecord
f = L1 .=. True .*. emptyRecord

test1 = getOptional L1 f
test2 = getOptional L1 e
test3 = getOptional L2 f
-- test4 :: Maybe () -- this would be a type error
-- test4 = getOptional L1 f

main = print ( test1 -- inferred becuase it is Just {}
             , test2 :: Maybe () -- must specify for Nothing
             , test3 :: Maybe () -- must specify for Nothing
             ) 
```

# java - Java method arrangement, runtime error

> ID：12065247
> 
> 赞同：-2
> 
> 时间：2012-08-22T01:31:00.080
> 
> 标签：java, runtime

I've written a program that displays tokens dropped into a board depending on the user's selection of which column to drop it in. I'm getting a runtime error

```
java.lang.StringIndexOutOfBoundsExcepti… String index out of range: 42
    at java.lang.String.substring(Unknown Source)
    at A1Program.extractRow(A1Program.java:83)
    at A1Program.start(A1Program.java:19)
    at A1Application.main(A1Application.java:11…
    at sun.reflect.NativeMethodAccessorImpl.inv… Method)
    at sun.reflect.NativeMethodAccessorImpl.inv… Source)
    at sun.reflect.DelegatingMethodAccessorImpl… Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at edu.rice.cs.drjava.model.compiler.JavacC… 
```

when I run the program, and I'm a bit lost as to where I might have gone wrong.

My code is:

```
public class A1Program {

    public void start() {

        String inputString = "XOXOXOO X XXO X OXO ";
        boolean gameOver = false;

        String tokens = inputString;

        while (!gameOver) {
            int column = columnResult();
            tokens = enterToken("X", tokens, column); 
            System.out.println(tokens);
            displayBoard(extractRow(5, tokens));
            displayBoard(extractRow(4, tokens));
            displayBoard(extractRow(3, tokens));
            displayBoard(extractRow(2, tokens));
            displayBoard(extractRow(1, tokens));
            displayBoard(extractRow(0, tokens));
            System.out.println("---------------");
        }
    }

    private int columnResult(){
        System.out.println("Enter column for X:");
        String keyInput = Keyboard.readInput();
        int column1 = Integer.parseInt(keyInput);
        return column1;
    }
    private String enterToken(String tokenSymbol, String inputString, int column){
        String columnEdit = inputString.substring(column*6-6,column*… 

        String columnEdit1 = columnEdit.trim();
        String columnEdit2 = columnEdit1+tokenSymbol+" ";
        String columnEdit3 = columnEdit2.substring(0,6);
        String start = inputString.substring(0,column*6-6);
        String end = inputString.substring(column*6);

        System.out.println(start);
        return start+tokenSymbol+end;
    }

    private String extractRow(int row, String tokens) {
        String rowString1 = tokens.substring(row, row + 1);
        String rowString2 = tokens.substring(row + 6, row + 7);
        String rowString3 = tokens.substring(row + 12, row + 13);
        String rowString4 = tokens.substring(row + 18, row + 19);
        String rowString5 = tokens.substring(row + 24, row + 25);
        String rowString6 = tokens.substring(row + 30, row + 31);
        String rowString7 = tokens.substring(row + 36, row + 37);

        return "|" + rowString1 + "|" + rowString2 + "|"
                + rowString3 + "|" + rowString4 + "|" + rowString5
                + "|" + rowString6 + "|" + rowString7 + "|";

    }

    private void displayBoard(String extractRow) {

        System.out.println(extractRow);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:40:23.010

跟踪中的以下行：`java.lang.String.substring(Unknown Source)`表示问题出在`tokens.substring()`

这是因为标记的长度小于您要提取的子字符串。您可以打印令牌的长度并自己检查

# asp.net - 会话变量在 asp.net 应用程序中失去价值

> ID：12065249
> 
> 赞同：1
> 
> 时间：2012-08-22T01:31:31.340
> 
> 标签：asp.net, session, c#-4.0

在我的 asp.net 应用程序中，我有一些会话变量。在本地主机和网络主机上似乎只有几分钟，它们失去了价值。这种情况会周期性地发生，并非总是如此。我确实有便宜的爸爸，网络托管，这可能是网络服务器上的问题。感谢您的帮助，这是一个大问题。

```
 <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="3600" defaultUrl="~/" name="" />
    </authentication>
    <sessionState mode="InProc" cookieless="false" timeout="80" />

 public static User User
    {
        get
        {
            User userLogin = null;
            object sessionVar = Session[USERLOGIN];
            if (sessionVar != null)
            {
                userLogin = (User) sessionVar;
            }
            return userLogin;
        }
        set { Session[USERLOGIN] = value; }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:00:48.760

很有可能您的会话在服务器上因应用程序池被停止和启动、超时或许多其他事情而被清除。要点是会话变量本身是不可靠的持久性机制。

如果您需要为登录用户保留信息，请尝试在用户的计算机上存储一个 cookie，如果会话为空，则从 cookie 中的标识数据重新填充它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T02:31:36.790

如果我可以发表评论，我会的，显然我不够特别；P 大声笑。在这两点上，我都必须同意 KodeKreachor 和 Aristos 的观点。我不确定为什么有业务/合理需要将会话状态保存在内存中。

补充一点，主要是因为我讨厌 cookie，您可以推出一个解决方案以将会话状态记录在轻量级数据库中。我的意思是它真的是一个 cookie，用于平面文件数据库信息记录。SQLite 可能是一个很好的解决方案，但除非我能找到其他方法，否则您将在此基础上推出自己的解决方案。是的，作为一个热爱 Godaddy 的支持者，他们更便宜的服务有很多不足之处。几乎无法控制系统对共享主机的操作。我与他们的技术部门谈论什么是允许的，什么是不允许的，我的经验可以告诉你。

我还要提到，您可能希望使用诸如 Log4Net 之类的解决方案将一些非常详细的日志记录添加到系统中，然后解析日志以获取有关擦除会话状态时实际发生的情况的信息。然后带着这些信息继续寻找更清晰的解决方案。

或者只是放松自己并使用cookies；）

只需修改 SQLite =D
[HOW TO: Configure SQL Server to Store ASP.NET Session State](http://support.microsoft.com/kb/317604)

当然这里是一个 SQLite Session State Provider
[SQLiteSessionStateStore](https://github.com/micahlmartin/SQLiteSessionStateStore)

[Apache Log4Net](http://logging.apache.org/log4net/)

[BeefyCode 的关于使用 Log4Net 的精彩教程系列](http://www.beefycode.com/post/Log4Net-Tutorial-pt-1-Getting-Started.aspx)

# ios - Migrating an existing SQLite iOS app to iCloud: how atomic is iCloud?

> ID：12065253
> 
> 赞同：4
> 
> 时间：2012-08-22T01:32:29.523
> 
> 标签：ios, icloud

I'm working on enhancing an existing application to use iCloud so the same data can be accessed on multiple devices.

I'm planning to use document-based storage and to use a file package (i.e. a directory of files represented as single file and handled by `NSFileWrapper`).

My main question is: are file package updates guaranteed to be atomic? If I open the app and a few files within a single document package have been changed, will iOS download them and then inform my app only when all subfiles are present and in-place? Or is there a risk that the files will come in one by one, leaving me with a potentially inconsistent package?

Also, my existing app uses SQLite (not through Core Data, but rather through a custom wrapper). Some parts of the app will clearly require a nice, indexed SQL database for performance. So my plan is to use the iCloud data as a reference store, keep an SQLite database in the `Caches` directory for performance reasons (or somewhere else strictly local to the device) and update the database based on what's in iCloud. Changes the user makes in the app will be recorded both in iCloud and in the local database. Is this crazy or reasonable?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:18:45.860

所以我对你的主要问题的回答是学术性的，因为我没有用于测试这个的测试库，但是……</p>

鉴于您的目录被视为单个实体，如果您使用该实体作为 NSManagedDocument 操作的项目进行协调。

我将这个答案建立在我学习使用 NSManagedDocument 管理 iCloud 的笔记上：

```
// Conflict
// - what if a device detached from the network changed a document that another device changed?
//   and then the detached device re-attached and tried to apply the change and it conflicted?
//   one must manage the conflict by looking for the InConflict document state.
// - when it happens, a decision must be made which version of the document to use and/or
//   manage changes.  probably want to set NSManagedObjectContext's mergePolicy to other than
//   default (Error).
// - then update the old, conflicting NSFileVersion to no longer conflict (and remove those
//   versions). 
```

（是的，我以objective-c 注释格式记笔记。）

# android - AIR Native Extension 无法启动服务意图 Android GCM

> ID：12065255
> 
> 赞同：2
> 
> 时间：2012-08-22T01:32:51.173
> 
> 标签：android, actionscript-3, service, air, native

大家好，我最近一直在玩弄 Android 的原生扩展，我需要添加 Google Cloud Messaging。我能够让 Google Cloud Messaging 应用程序自行运行。但是现在我已经将它集成到 Flash 的本机扩展中，我发现了一个我无法解决的问题。

```
08-21 17:58:01.661: W/ActivityManager(180): Unable to start service Intent { act=com.google.android.c2dm.intent.REGISTRATION cat=[air.GCMAppTest.debug] flg=0x10 cmp=air.GCMAppTest.debug/com.xxxxxxxxx.extensions.GCM.GCMIntentService (has extras) }: not found 
```

当 GCM 广播接收器接收到

```
08-21 17:58:01.661: V/GCMBroadcastReceiver(7604): GCM IntentService class: com.gamecloudstudios.popsportsandroidane.extensions.GCM.GCMIntentService 
```

该错误是由 Flash Package Context 是默认包引起的。当我需要默认包是包含 GCMIntentService 的包时。

有没有人能够让 GCMIntentService 在 Android Flash Native Extension 中运行？或任何 AndroidIntentService 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T23:38:54.157

您需要确保将 Intent Service 添加到 AIR 应用程序描述符的清单添加中，而不是本机代码库的 Android 清单中。例如，以下代码是我们在 GCM 原生扩展的示例应用程序中使用的代码，[如果您有兴趣，请点击此处](http://labs.distriqt.com/native-extensions)。

里面有几件事要注意，尤其是“空气”。一些android名称的前缀。但只要您拥有所有这些附加功能，Android 代码的实际实现应该与 Google 示例非常相似。

```
<android>
    <manifestAdditions><![CDATA[
        <manifest android:installLocation="auto">
            <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="8"/>

            <uses-permission android:name="android.permission.INTERNET"/>
            <uses-permission android:name="android.permission.GET_ACCOUNTS" />
            <uses-permission android:name="android.permission.WAKE_LOCK" />
            <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />

            <!-- Only this application can receive the messages and registration result --> 
            <permission android:name="air.com.distriqt.test.debug.permission.C2D_MESSAGE" android:protectionLevel="signature" />
            <uses-permission android:name="air.com.distriqt.test.debug.permission.C2D_MESSAGE" />

            <application>
                <receiver android:enabled="true" android:exported="true" android:name="com.distriqt.extension.pushnotifications.PushNotificationsBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
                    <intent-filter>
                        <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                        <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
                        <category android:name="air.com.distriqt.test.debug" />
                    </intent-filter>
                </receiver>
                <service android:enabled="true" android:exported="true" android:name="com.distriqt.extension.pushnotifications.gcm.GCMIntentService" />

            </application>
        </manifest>

    ]]></manifestAdditions>
</android> 
```

# jquery - 为 AJAX 重写 Google 地图

> ID：12065256
> 
> 赞同：0
> 
> 时间：2012-08-22T01:34:02.653
> 
> 标签：jquery, google-maps, google-maps-api-3

我希望用户按下一个按钮，AJAX 加载将加载谷歌地图。我有几个问题。首先，我将脚本 API 密钥放在哪里。在原始文件还是 AJAX 文件中？其次，我不确定要写什么来加载谷歌地图事件初始化程序。这是代码。

第一个文件

```
<script type="text/javascript"
src="http://maps.googleapis.com/maps/api/js?key=mykey&sensor=false&libraries=drawing">
</script>

<div id="themapsection">

<input type="button" id="tour_dates" Value="Show Tour Dates" />

<script type="text/javascript" >

$(document).ready(function() {
  $('#tour_dates').click(function () {
  var theid = <?php echo $user_id; ?>;  
  $('#map_canvas').load(
  'ajax_map_tour_data.php', 
  {session_user_id: theid},
  function() {  google.maps.event.addDomListener(window, 'load', initialize)})
;});});

</script>

</div>

<div id="map_canvas"></div> 
```

在 ajax 文件中，我已经创建了函数初始化。我决定从 ajax 文件中获取下面的这段代码并将其附加到原始文件中，但我知道这是不对的。我只是不知道从这里去哪里。

```
 google.maps.event.addDomListener(window, 'load', initialize); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:40:29.633

尝试在 ajax 加载（成功）事件中调用初始化函数

```
$(document).ready(function() {
  $('#tour_dates').click(function () {
    var theid = <?php echo $user_id; ?>;  
    $('#map_canvas').load(
      'ajax_map_tour_data.php', 
      {session_user_id: theid},
      initialize
    );
  });
}); 
```

# c# - C# possible to compare string[] to 4 other string[]?

> ID：12065257
> 
> 赞同：2
> 
> 时间：2012-08-22T01:34:14.310
> 
> 标签：c#

I've been looking around for a while now for some answers, but I cant find it anywhere.

I need a solution for this in C#:

```
if (stringer[1] == stringer[2]||stringer[3]||stringer[4]||stringer[5])
{

} 
```

this obviously doesn't work in C#, so I need a way to do this.

thank you!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T01:36:01.897

Try this:

```
if (stringer.Skip(1).Any(v => v.Equals(stringer[0])) {
    ...
} 
```

This code compares every item in the `stringer` array from the second on to the initial item, returning `true` if the initial item is duplicated anywhere else in the array.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:50:31.673

您必须单独比较每个项目，或使用上述 LINQ 解决方案。

if (stringer[1] == stringer[2] || stringer[1] == stringer[3] || 等等)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T02:24:40.007

如果有一个字符永远不会出现在字符串中，您可以将其用作分隔符：

```
 ( "|" + stringer[2] + "|" + stringer[3] + "|" ).IndexOf( "|" + stringer[1] + "|" ) >= 0 
```

丑陋，古老的技术。

# syntax - Syntax error from older PHP script

> ID：12065259
> 
> 赞同：0
> 
> 时间：2012-08-22T01:34:30.480
> 
> 标签：syntax, syntax-error

Can someone please tell me what the error is in the following script? Was forced to update to php 5.3 instead of 4 and now site is down

```
<!--form action : <?=//MYSURL_DEV?>properties_features.php--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T01:44:44.770

您应该检查一下`php.ini`是否启用了**[短标签。](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)**默认情况下，它们通常被禁用。从 PHP 5.4 开始，短标签始终处于打开状态，但在 PHP 5.3 及更低版本中并非如此。

如果可以的话，在 php.ini 中你可以使用：

```
short_open_tag = On 
```

请注意，在某些托管环境中，您实际上可能无法启用短标签。尽管 5.4 始终提供它们，但通常不建议使用它们，因为您可能遇到了一个问题：您可能会移动到另一个没有启用它们的环境（甚至允许它）。

另一种方法是使用：

```
<?php echo $var; ?> 
```

更多信息可以在这里找到：[PHP 短标签是否可以使用？](https://stackoverflow.com/questions/200640/are-php-short-tags-acceptable-to-use)

# unit-testing - Creating easy to maintain tests

> ID：12065260
> 
> 赞同：2
> 
> 时间：2012-08-22T01:34:43.790
> 
> 标签：unit-testing, testing, mocking, bdd

During a proposal about implementing unit tests for our projects, my manager argued that it could be more expensive to create unit tests since you will be maintaining two sets of code. His argument is whenever there is a change in requirement/functionality, the unit tests can be obsolete, hence the developers should update the tests in order to pass the automated build. He said that it can be inconvenient for the developers since their coding time might be reduced and spent fixing the tests.

The reason I wanted to implement unit tests is to minimize bug occurence especially the critical ones before the codes are turned to validation team for functional test. I also believe that the cost of creating unit tests can be recovered by having better quality systems.

Right now, his challenge to me is to create easy to maintain tests that would be easy to modify or if possible tests that will not break easily. I am using xUnit testing frameworks like JUnit and mocking frameworks like mockito and powermock to help in testing.

I'm looking for tips and techniques on how to write easy to maintain tests or how to avoid brittle test. Are there other tools which can come handy in creating such tests. I'm writing codes in Java and C++. Thanks.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T08:58:02.023

我认为您正面临文化差异-您的经理担心测试提供的潜在时间损失。众所周知的事实是，TDD/BDD 流程的前期成本更高 - 但随着时间的推移，您开始获得回报，因为“只改变这一孤立的事情......” - 不再引发痛苦/尴尬/**代价高昂的**错误。

我的建议是你做一些研究并整理一份文件，试图将这个过程出售给你的经理，根据你的业务中已经发生的事情提出一个商业案例，这个案例可以/应该通过一个可靠的测试套件来解决。

有一本书比我见过的任何网站、文章等都更适合 TDD。我强烈推荐任何想要练习 TDD/BDD/OOP 的人阅读它：http: [//www.growth-object-orientated-software.com/](http://www.growing-object-oriented-software.com/)（我没有从链接中赚取任何钱！-但它是我办公桌的绝佳补充！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:24:34.507

根据我的经验，要真正说服“单元测试怀疑论者”几乎是不可能的。

我的建议：开始添加测试并增加对产品中最重要和经常变化的部分的选择范围。在你自己的时间做这件事，可能还有一个“同谋”，并为你的工作计时。

之后，向怀疑者展示这些测试发现的回归错误示例，以及您花费的时间实际上是值得的。如果您成功地做到了这一点，管理层将看到为单元测试投入资源的价值。

根据技术挑战，我同意这里的其他答案，熟能生巧，但有一些指导方针可以帮助你：

*   每次测试只测试一件事。如果您有 100 个断言相同条件的测试，则当此条件发生变化时，您将不得不更新 100 个测试。
*   如果您的“被测类”很大，其中包含大量逻辑，则很难对其进行测试。尝试将您的类重构为小的、连贯的逻辑单元。当这些单元之一发生变化时，破坏测试的数量将相对较少。
*   测试您的公共接口，而不是实现细节。这将允许开发人员修复错误、提高性能和重构，而对测试的影响最小。

在Google 的“单元测试指南”的第一页还有[更多](https://stackoverflow.com/questions/106800/unit-testing-guidelines) [指南，您可以阅读](http://geosoft.no/development/unittesting.html)[The Art Of Unit Testing](http://artofunittesting.com/)以获得关于编写良好单元测试的广泛报道。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T02:22:14.920

你是否编写单元测试不应该关心你的管理。通常重要的是功能可以快速实现并且没有错误。如何实现它取决于您，开发人员；单元测试只是一种方法。它最适用于松散耦合的代码，您可以轻松地模拟出依赖关系。

但是编写好的单元测试不仅仅是关于编写它们的决定，或者你使用的工具，它主要是关于你只能通过练习获得的经验。没有简单的方法可以让你编写好的单元测试，因为没有代码。如果你只是强迫没有经验的人编写单元测试，那么生产力肯定会下降，并且不会有明显的好处。最终，您应该编写单元测试，因为您相信它可以帮助您，而不是因为其他人认为它应该可以帮助您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T02:44:12.713

答案是单元测试应该测试实现而不是功能。因此，如果开发人员重构代码，单元测试不会发生任何变化，因为他们不是在测试内部，只是测试结果。

当然，如果你彻底改变界面或行为，测试当然会改变，但是你会想要测试新代码，所以你仍然会编写测试。

长话短说，有很多研究表明，从长远来看，一个好的测试套件可以大大节省时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T04:51:34.193

如果被测系统发生变化，拥有统一**的测试数据工厂**可以降低维护成本。

测试通常具有相似的测试设置，只有很小的变化。

当我开始进行单元测试时，我使用复制和粘贴从现有的测试中创建新的测试。

每个测试都有一个很长的测试设置。

在测试系统发生更改后，我不得不更新许多测试。

今天我使用测试数据工厂，其中只分配了与标准的差异。

例子

```
 void customerUnder18ShouldNotbeGrantedAccess() {
      // Arrange
      Customer customer = TestdataFactory.CreateStandardCustomer();
      customer.setAge(16);

      // Act...
      // Assert ..
  } 
```

[这里](https://softwareengineering.stackexchange.com/a/161817/9007)有更多有用的提示。

# crystal-reports - Crystal 报表交叉表列分组

> ID：12065262
> 
> 赞同：1
> 
> 时间：2012-08-22T01:35:25.290
> 
> 标签：crystal-reports, crosstab

我正在尝试在 Crystal XI 中构建一个交叉表报表，该报表具有日期，按月份分组为列标题，并且有 2 个我试图找到答案的问题。

1：有没有什么方法可以显示一个月，即使那个月没有要汇总的记录？即三月没有订单，但想显示一月、二月、三月？我很确定我可以创建一个日期表并使用它来欺骗它，但我不想走那条路，因为数据库是供应商包的一部分，我不想在那里发疯。

2：有没有办法指定或限制有多少列通过？例如，在预测交叉表中，我只希望显示当前月份和接下来的六个月。我想我可以在选择标准上做一个日期范围，但这对我来说似乎有点笨拙。

感谢您的任何回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T08:55:42.447

1.  简短的回答：不。
    我见过有关创建临时表的变通办法的讨论，但我自己从未尝试过任何此类解决方案。
2.  我会选择选择标准的日期范围。您可以将这些日期参数设置为更方便的使用。如果您有多个应具有不同日期范围的交叉表，则可以将交叉表放在子报告中。

# c++ - 使用计时器在带有 C++ 的 Windows Metro 中触发事件

> ID：12065264
> 
> 赞同：0
> 
> 时间：2012-08-22T01:35:53.810
> 
> 标签：c++, windows, timer, microsoft-metro

所以我正在开发一个在倒计时完成后拍照的应用程序。我在 Windows 7 中使用过 win32 计时器，但我不知道如何在 Windows Metro 中应用它。我需要一些帮助或 c++ 中的一些示例代码，这些代码与如何在设定的时间到期后触发事件有关。在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:41:30.773

在 C++ 中，声明 DispatcherTimer，并在其上注册一个事件处理程序。

DispatcherTimer 类 - [http://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.dispatchertimer](http://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.dispatchertimer)

[http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)

示例代码：

```
using namespace Windows::UI::Xaml;
using namespace Windows::Foundation;

void Application1::MainPage::Button_Click(Platform::Object^ sender, Windows::UI::Xaml::RoutedEventArgs^ e)
{
    DispatcherTimer^ timer = ref new DispatcherTimer;
    timer->Tick += ref new Windows::UI::Xaml::EventHandler(this, &Application1::MainPage::DispatcherTimer_Tick);
    TimeSpan t;
    t.Duration=1000;
    timer->Interval = t;
    timer->Start();
}

void Application1::MainPage::DispatcherTimer_Tick(Platform::Object^ sender, Platform::Object^ e)
{
   // Put TO DO stuff here...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:40:18.653

> [`Windows::UI::Xaml::DispatcherTimer`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.dispatchertimer.aspx)

该文档包括其使用示例。该示例使用 C# 编写，但将其转换为 C++/CX 应该很简单。

# php - PHPExcel not downloading in mobile Safari

> ID：12065269
> 
> 赞同：1
> 
> 时间：2012-08-22T01:36:32.537
> 
> 标签：php, mobile-safari, phpexcel, xlsx, force-download

I'm using [PHPExcel](http://phpexcel.codeplex.com/) to generate Excel files on the fly within my PHP application. I'm using the `Excel2007` format.

When a user visits the URL that creates and forces the download of the Excel file, everything works great in all browsers **except for mobile Safari** (iPhone and iPad).

Here are my headers and the `readfile` method:

```
header('Content-type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
header('Content-disposition: attachment; filename=' . $file_name . '.xlsx;');
header('Content-Length: ' . filesize($path_to_file . '.xlsx'));
readfile($path_to_file . '.xlsx'); 
```

When I browse in mobile Safari to the URL that is supposed to download the .xlsx file I can actually see the tabs representing each worksheet of the file, but I don't see the actual data like so:

![no output for phpexcel on mobile safari](../Images/cf121b461b58afe815c044d43902de7a.png)

Furthermore, there are two additional weird behaviors I'm encountering with this:

*   If I download this file on a desktop browser and email it to myself and open it with the Mail app in iOS, the file displays correctly.
*   If I then take that attachment from the Mail app in iOS and import into, say, Dropbox, it does NOT display properly (it displays the same as the screenshot above).
*   In Chrome, the file downloads properly and opens in Excel or even Numbers as expected, but in the console I see this message: `Resource interpreted as Document but transferred with MIME type application/vnd.ms-excel:`

Also, per the PHPExcel documentation, in place of `readfile` I have also tried:

```
$objWriter->save('php://output'); 
```

That, however, produces an error in mobile Safari that reads:

```
OfficeImportErrorDomain Error 912 
```

To eliminate the `Content-type` as being the issue I've experimented by adjusting the `Content-type` to other values (such as `application/vnd.ms-excel` or even `application/download`). Unfortunately (though not surprisingly) those don't work either.

Any guidance is greatly appreciate.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-08T07:22:02.543

我用`->addHeaderLine('Content-Type', 'application/octet-stream')`. 否则 Safari 会显示错误。虽然这个标题使它在浏览器中显示 xlsx 文件，而不是下载。我还没有找到任何强制移动 Safari 下载的解决方案。

# opengl-es - What's the static flow control in GLSL?

> ID：12065270
> 
> 赞同：1
> 
> 时间：2012-08-22T01:37:06.593
> 
> 标签：opengl-es, glsl, flow-control

[PowerVR documentation from Imagination](http://www.imgtec.com/powervr/insider/docs/POWERVR%20SGX.OpenGL%20ES%202.0%20Application%20Development%20Recommendations.1.8f.External.pdf) says there's *static flow control*. (7.9 Flow Contro)

What's the static flow control? Does it mean compiler preprocessor like `#if...#endif`? And they're saying,

```
Static flow control can be used to combine many shaders into one big shader. 
```

and what does this mean? Can I instantiate many variants of shaders from one source?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:11:17.110

根据 7.9 之前的文本：

> 当条件执行取决于统一变量的值时，这称为静态流控制

因此，您将拥有一个基于制服做出分支决策的着色器。那将是静态流量控制。

他们试图告诉你的是，设置制服可以动态地重新编程着色器——编译后的代码将使用新的制服值进行修补，而不是每次着色器运行时都要查找这些值。因此，在着色器中访问制服的成本与使用常量的成本相同，并且在着色器之外设置制服的成本可能比您想象的要大。

# c# - 是否可以有 2 个视图与一个操作相关联？

> ID：12065272
> 
> 赞同：3
> 
> 时间：2012-08-22T01:37:08.403
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我有以下自定义路线

```
routes.MapRoute("custom", "Groups/{groupname}/{action}/{id}", new { controller = "Groups", action = "Index", id = UrlParameter.Optional }); 
```

这个自定义路由是为了实现下面的url schema

*   Groups/pokerclub/members/ - 列出 pokerclub 组的所有成员。
*   Groups/pokerclub/members/bob - 列出 bob 的成员详细信息。

我尝试了以下但它不起作用。它混淆了 asp .net mvc 选择哪个动作。

```
public ActionResult Members(string groupName, string id)
    {
        return View();
    }

    public ActionResult Members(string groupName)
    {
        return View();
    } 
```

我可以想到两种可能的解决方案：

*   有不同的动作名称。例如Memberlist 动作和member 动作。
*   使用简单的 if 语句在视图中处理此问题。

我非常想维护我的 url 方案。因此，根据我最初的问题，如何将两种不同的观点与一个动作相关联？谢谢。

温迪

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:40:11.850

您只能有一个操作，但您可以在该操作中执行您想要的任何逻辑，并且您可以按名称调用视图：

```
return View("MyView"); 
```

`id`在您的示例中，如果该字段为空，您只需返回一个不同的视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T01:40:19.257

它说它`return View();` 需要参数，你可以让它使用你想要的任何视图

```
return View("Members", model); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T06:00:13.423

您可以使用不同的方法：

```
[HttpGet]
public ActionResult Members(string groupName, string id)
{
    return View();
}

[HttpPost]
public ActionResult Members(string groupName)
{
    return View();
} 
```

# jquery - 淡入淡出文本循环 - jQuery

> ID：12065273
> 
> 赞同：13
> 
> 时间：2012-08-22T01:37:14.167
> 
> 标签：jquery

我有两个引号包含在 H2 标记中，我想使用 jQuery 淡入和淡出。当页面加载时，我希望第一个报价淡入，延迟几秒钟并淡出，然后下一个报价做同样的事情。我希望它继续循环遍历这两个引号。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-22T01:45:43.140

你可以这样做：

CSS：

```
.quotes {display: none;}​ 
```

HTML：

```
<h2 class="quotes">first quote</h2>
<h2 class="quotes">second quote</h2>​ 
```

Javascript：

```
// code gets installed at the end of the body (after all other HTML)
(function() {

    var quotes = $(".quotes");
    var quoteIndex = -1;

    function showNextQuote() {
        ++quoteIndex;
        quotes.eq(quoteIndex % quotes.length)
            .fadeIn(2000)
            .delay(2000)
            .fadeOut(2000, showNextQuote);
    }

    showNextQuote();

})();​ 
```

工作演示：http: [//jsfiddle.net/jfriend00/n4mKw/](http://jsfiddle.net/jfriend00/n4mKw/)

此代码适用于您拥有的任意数量的引号，而不仅仅是两个。如果引号后面有内容，您可能希望修复引号所在容器的大小，以便在从一个引号到下一个引号时它不会改变大小（导致其他页面内容跳来跳去） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-30T09:10:09.873

这是使上述脚本正常工作所需要的。首先，您需要引用适当的 JQuery 框架，因此将此*脚本*标记添加到该**`<head>`**部分中，或者在`<body>`标记的末尾，在所有其他元素之后：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"> 
```

然后主 JavaScript 必须在上述`<script>`标记之后加载：

```
<script type="text/javascript">
(function() {

    var quotes = $(".quotes");
    var quoteIndex = -1;

    function showNextQuote() {
        ++quoteIndex;
        quotes.eq(quoteIndex % quotes.length)
            .fadeIn(2000)
            .delay(2000)
            .fadeOut(2000, showNextQuote);
    }

    showNextQuote();

})();
</script> 
```

# html - 向文本输入添加 :focus 边框，并摆脱默认边框

> ID：12065275
> 
> 赞同：1
> 
> 时间：2012-08-22T01:37:29.037
> 
> 标签：html, css, forms, border

在 css 中，当给定的文本框处于焦点时，我希望有一个 2 像素的浅蓝色边框。我有以下内容：

```
form input.text:focus
{
border:2px solid #09F;
} 
```

很简单。问题是，在我的新蓝色边框之外仍然可以看到默认的橙色边框。我怎样才能摆脱这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T01:39:21.307

我不确定它是否与该`outline`属性有关，因为它通常是蓝色的，而不是橙色的（您使用的是哪个浏览器？）。无论如何，尝试简单地添加 `outline: none;`到该规则集中。

# algorithm - 提高算法知识的材料和信息

> ID：12065277
> 
> 赞同：0
> 
> 时间：2012-08-22T01:37:46.267
> 
> 标签：algorithm, bit

最近我一直在努力提高我的算法技能。在这一点上，我发现自己没有很好的材料来解决基于 dfs 和 bsf 的网格问题。我以某种方式设法用蛮力逻辑做到了[http://www.spoj.pl/problems/POUR1/](http://www.spoj.pl/problems/POUR1/)但我最近发现这个问题可以由 bfs 解决。但我不知道该怎么做。有人可以提供一些文本来阅读或对上述问题进行某种解释，以便我可以将其添加到我的技能集中。如果你能在这些问题上帮助我解决这些问题，那就太好了[http://www.codechef.com/problems/MMANT/](http://www.codechef.com/problems/MMANT/).请尽快帮助我真的陷入了蚂蚁无法继续前进的这些问题。如果你能提供一个关于二叉索引树和分段树的好问题列表以及更多关于它们的使用示例，那也将非常友好。

谢谢您的帮助！！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:51:45.563

我发现有用的一种资源是[The Algorithmist](http://www.algorithmist.com/index.php/Main_Page)：

> The Algorithmist 是一个致力于任何算法的资源——从实践领域到理论领域。还有问题集的链接和解释。

Steve Skiena[的算法设计手册](https://rads.stackoverflow.com/amzn/click/com/0387948600)也非常有用，尤其是第二部分。

# linux - TCP内核实现

> ID：12065279
> 
> 赞同：2
> 
> 时间：2012-08-22T01:37:50.403
> 
> 标签：linux, tcp, kernel

我开发了一种新的 TCP 拥塞避免算法，我想在 linux 内核中实现它并测试它的性能。但为此我需要了解现有的 TCP 内核（2.6）实现。你建议我应该怎么做？请推荐一些文章/书籍等可以让我领先一步。我知道我最终将不得不深入研究源代码，但如果我至少了解广泛的实现方面以及如何浏览代码，那将会很有帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T02:09:09.917

我将直接深入研究内核中已经存在的更简单的拥塞避免算法的源代码。它们在`net/ipv4`目录中，并且[对 tcp_vegas.c](http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/net/ipv4/tcp_vegas.c?v=2.6.25.8)进行了非常彻底的评论。您可能还希望查看[tcp_highspeed.c](http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/net/ipv4/tcp_highspeed.c)和[tcp_bic.c](http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/net/ipv4/tcp_bic.c)，因为它们相当简单（少于 250 行代码）。

# android - 在android中切换布局

> ID：12065280
> 
> 赞同：0
> 
> 时间：2012-08-22T01:38:03.337
> 
> 标签：android, google-maps, android-layout, android-gridview

我想切换布局。当按下 ImageButton 地图时，它进入地图视图，当我按下 ImageButton gridview 时，它进入 GridView。

注意：地图是另一种布局。网格在另一个布局中，gridview 中的图片是从另一个布局调用的

![在此处输入图像描述](../Images/9a6bd9d054ab38a21cc4776bf6d27d24.png)

![在此处输入图像描述](../Images/fabf8a38635835607f94cc5b3a236681.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:41:33.970

查看[碎片](http://developer.android.com/reference/android/app/Fragment.html)

为每个视图创建一个片段。然后，根据您用于父布局视图的内容，您可以在特定视图首次显示时将适当的片段添加到父布局。

当您在视图之间切换时，将当前视图（将被隐藏的视图）放到片段后台堆栈（您还必须查看[FragmentManager](http://developer.android.com/reference/android/app/FragmentManager.html)）。然后当你再次切换时，你可以将已经存在的 Fragment 从堆栈中弹出，并将当前的 Fragment 放入堆栈。

编辑：根据您正在开发的 API（API 13 中引入了片段），您可能需要将兼容性库添加到您的项目中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T04:21:11.797

在您的主 xml 中创建一个持有者视图（例如，RelativeLayout）。然后，为 gridview 和 mapview 创建 2 个单独的 XML 文件。

当按下相应的按钮时，您可以充气并将正确的视图附加到您的持有人视图。为了提高效率，您甚至可以使用 ViewHolder 范例来缓存已经膨胀的视图。

希望这可以帮助...

**根据以下问题进行编辑**

示例代码（即时键入，因为在当前位置无法访问我的工作版本）。

main.xml 包含

```
 <RelativeLayout android:id="@+id/x".../> 
```

您还有 image.xml 和 map.xml。在您的 OnClick 中，尝试：

```
 ViewGroup myLayout = view.findViewById(R.id.x);
    View myView;
    if (clickedButton == imageButton) {
        myView = getInflater().inflate(R.layout.image, myLayout, false);
    } else if (clickedButton == mapButton) {
        myView = getInflater().inflate(R.layout.map, myLayout, false);
    }
    myLayout.addView(myView); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:53:28.473

从您的点击处理程序调用`setContentView(int layoutId)`或使用该 Activity 中的地图布局启动一个新 Activity。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T02:25:49.750

做到这一点的简单方法是进行 2 项活动，除非您有理由不进行多项活动。GridViewActivity
MapViewActivity
当您单击 GridViewActivity 上的图像时，您将启动 MapViewActivity 活动，反之亦然。
只需确保您在两种布局中都有 imagebutton（当然 id 应该不同）。

# php - 使用 .htaccess 文件删除 URL 的特定段

> ID：12065281
> 
> 赞同：0
> 
> 时间：2012-08-22T01:38:12.697
> 
> 标签：php, .htaccess, codeigniter

我的网址链接看起来像：

```
http://localhost/CodeIgniter_2.1.2/index.php/pages/home 
```

然后我使用谷歌编写了 .htaccess 文件，如下所示：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|themes|images|robots\.txt)
RewriteRule ^(.*)$ index.php/$1 [L] 
```

现在我的链接看起来像：

```
http://localhost/CodeIgniter_2.1.2/pages/home 
```

现在，我想`pages`从此链接中删除。谁能帮我解决这个问题？

因此，我的网址可能如下所示：

```
http://localhost/CodeIgniter_2.1.2/home 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:52:34.903

一种方法是在 application/config/routes.php 文件中创建一个自定义路由，它将 url 'http://localhost/CodeIgniter_2.1.2/home' 路由到 'http://localhost/CodeIgniter_2.1.2 /页面/主页'

[此处](http://codeigniter.com/user_guide/general/routing.html)描述了自定义路由

代码将类似于：

```
$route['home'] = "pages/home"; 
```

**编辑**

您的控制器、方法和变量分别命名为“pages”、“view”和“home”。因此，您应该尝试以下路线：

```
$route['home'] = "pages/view/home"; 
```

还：

** 保留路线 ** 来自 codeigniter 文档：

有两条预留路线：

```
$route['default_controller'] = 'welcome'; 
```

> 如果 URI 不包含数据，则此路由指示应加载哪个控制器类，当人们加载您的根 URL 时就是这种情况。在上面的示例中，将加载“欢迎”类。鼓励您始终使用默认路由，否则默认情况下会出现 404 页面。

因此，您不应该将默认控制器设置为“pages/view/home”。相反，您应该在控制器中创建一个默认为“home”视图的“index”方法。

**另外** 不要忘记将位于 application/config/config.php 中的 config.php 文件中的 $config['index_page'] 从 'index.php' 更改为 ''。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T01:50:34.490

尝试更改您的规则，以便目标是：

```
RewriteRule ^(.*)$ index.php/pages/$1 [L] 
```

# c - snprintf 用于字符串连接

> ID：12065286
> 
> 赞同：20
> 
> 时间：2012-08-22T01:39:36.860
> 
> 标签：c, string

我正在使用 snprintf 将字符串连接到 char 数组：

```
char buf[20] = "";
snprintf(buf, sizeof buf, "%s%s", buf, "foo");
printf("%s\n", buf);
snprintf(buf, sizeof buf, "%s%s", buf, " bar");
printf("%s\n", buf); 
```

问题是第二个连接`buf`而不是添加`"bar"`, 替换`"foo"`它。输出如下：

```
foo
bar 
```

第一个`%s`应该保留`buf`（在这种情况下保持`"foo"`）在那里。第二个`%s`应该附加`"bar"`到它。对？

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-22T01:42:54.160

您违反了`restrict`上的合同`snprintf`，该合同规定没有其他参数可以与缓冲区重叠。

无论如何，将输入复制到自身中是一种浪费。 `snprintf`返回格式化所需的字符数，因此利用它来追加：

```
char buf[20] = "";
char *cur = buf, * const end = buf + sizeof buf;
cur += snprintf(cur, end-cur, "%s", "foo");
printf("%s\n", buf);
if (cur < end) {
    cur += snprintf(cur, end-cur, "%s", " bar");
}
printf("%s\n", buf); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T01:52:56.563

试试这个：

```
char buf[20];
snprintf(buf, sizeof buf, "%s", "foo");
printf("%s\n", buf);
int len = strlen(buf);
snprintf(buf+len, (sizeof buf) - len, "%s", " bar");
printf("%s\n", buf); 
```

输出是“foo bar”。snprintf 的第一个参数，一个指向字符的指针，是它开始填充字符的地方。它不注意缓冲区中的内容。不过，函数 strlen 确实很注意。它计算 snprintf 放在那里的 nul (0) 之前的字符数。所以不要传递 buf，而是传递 buf+strlen(buf)。您也可以使用 strncat，它会稍微更有效率。

我在您的问题下看到了标签 C++。查找 std::string。好多了

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-22T02:28:00.447

虽然接受的答案没问题，但更好的（在我看来）答案是连接字符串是错误的。*您应该在一次*调用中构造整个输出`snprintf`。这就是使用格式化输出函数的全部意义所在，它比指针运算和多次调用更高效、更安全。例如：

```
snprintf(buf, sizeof buf, "%s%s%s", str_a, str_b, str_c); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T01:54:00.193

为什么不使用[`strncat()`](http://man.cx/strncat)？它旨在做到这一点：

```
char buf[20] = "";
strncat(buf, "foo", sizeof buf);
printf("%s\n", buf);
strncat(buf, " bar", sizeof buf - strlen(buf));
printf("%s\n", buf); 
```

如果您的系统支持它，您可以使用`strncat_s()`而不是`strncat`，因为它具有额外的溢出保护级别，并且无需计算输出缓冲区中剩余的字节数。

如果*必须*使用`snprintf`，则需要创建一个单独的指针来跟踪字符串的结尾。该指针将是您传递给的第一个参数`snprintf`。您当前的代码始终使用`buf`，这意味着它将始终打印到该数组的开头。您可以`strlen`在每次调用后使用来查找字符串的结尾`snprintf`，也可以使用的返回值`snprintf`来递增指针。

# linux - 如何从恐慌中定位错误

> ID：12065302
> 
> 赞同：0
> 
> 时间：2012-08-22T01:41:40.780
> 
> 标签：linux, usb, kernel, driver, panic

全部。我是内核新手。我想知道如何从 painc 中获取有用的信息，例如哪条线路或哪个功能是错误的。
比如下面是一个`panic-output`about `usb hiddev`，怎么读呢？谢谢。

* * *

```
 BUG: unable to handle kernel NULL pointer dereference at 0000000000000028
IP: [<ffffffff813b4aa1>] free_async+0xa1/0x100
PGD 2326c9067 PUD 230f4c067 PMD 0 
Oops: 0000 [#1] SMP 
last sysfs file: /sys/devices/pci0000:00/0000:00:1d.2/usb8/8-2/speed
CPU 3 
Modules linked in: ebtable_nat ebtables ipt_MASQUERADE iptable_nat nf_nat xt_CHECKSUM iptable_mangle bridge stp l]

Pid: 2400, comm: lsusb Tainted: G          I---------------    2.6.32-296.el664fixes.3.x86_64 #1 Dell Inc. OptiPlN
RIP: 0010:[<ffffffff813b4aa1>]  do_IRQ: 0.97 No irq handler for vector (irq -1)
[Firmware Bug]: the BIOS has corrupted hw-PMU resources (MSR 186 is 53003c)
�Mounting proc filesystem
Mounting sysfs filesystem
Creating /dev
Creating initial device nodes
setfont: KDFONTOP: Invalid argument
Free memory/Total memory (free %): 78672 / 114884 ( 68.4795 )
Loading dm-mod.ko module
Loading dm-log.ko module
Loading dm-region-hash.ko module
Loading dm-mirror.ko module
Loading dm-zero.ko module
Loading dm-snapshot.ko module
Loading freq_table.ko module
Loading mperf.ko module
Loading ipt_REJECT.ko module
Loading nf_defrag_ipv4.ko module
Loading ip_tables.ko module
Loading nf_conntrack.ko module
Loading ip6_tables.ko module
Loading ipv6.ko module
Loading fat.ko module
Loading macvlan.ko module
Loading tun.ko module
Loading kvm.ko module
Loading uinput.ko module
Loading parport.ko module
Loading dcdbas.ko module
Loading microcode.ko module 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T09:15:27.923

恐慌本身实际上是相当准确的。

BUG：无法在 0000000000000028 IP 处处理内核 NULL 指针取消引用：[] free_async+0xa1/0x100

已经告诉发生问题的函数是 free_async 并且该函数的长度正好为 0x100 字节，并且崩溃发生在偏移量 0xa1 处。您需要将该偏移量映射到确切的代码行中，但这现在取决于您的环境如何执行此操作。

有时手动代码审查已经会显示出哪一行有指针操作，所以你可以通过审查那个函数来做到这一点。

那么下一个问题是，为什么那里有一个 NULL 指针？

# vba - 组合框上的 MS Access 强制更新

> ID：12065303
> 
> 赞同：0
> 
> 时间：2012-08-22T01:42:07.623
> 
> 标签：vba, ms-access

当 ComboBox 值在代码中更改时，如何强制更新。下面是我尝试过但似乎不起作用的一段代码

```
 If (Not Mid(sCode, 1, 2) = ddlLevelID1) Then
     ddlLevelID1 = Mid(sCode, 1, 2) 'force change/force AFTER_UPDATE event to run. 
 End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:52:04.243

假设`ddlLevelID1`是组合框：

```
ddlLevelID1.value = foo 
```

会改变值。我不相信您可以将 ComboBox 中显示的值链接到变量值，而无需在更改值后将更改推送到用户窗体。

* * *

关于 AfterUpdate 方法，来自 msdn：

> 使用 Visual Basic 或包含 SetValue 操作的宏更改控件中的数据不会触发控件的这些事件。但是，如果您随后移动到另一条记录或保存该记录，则会发生窗体的 AfterUpdate 事件。

[http://msdn.microsoft.com/en-us/library/office/bb238392(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/office/bb238392(v=office.12).aspx)

# r - R：原型序列化/反序列化到列表

> ID：12065305
> 
> 赞同：1
> 
> 时间：2012-08-22T01:42:29.307
> 
> 标签：r, mongodb, serialization, deserialization, proto

我希望能够将一些简单[`proto`](http://cran.r-project.org/web/packages/proto/index.html)的对象存储在持久存储（[MongoDB](http://mongodb.org)）中，它们的属性可以通过其他编程语言的代码进行操作。简单地说，我的意思是它们不会引用其他原型对象。它们的属性将是常见的 R 类型：列表、向量等。此外，每个对象都可以有一个工厂方法，在给定具有其属性值的列表的情况下创建它。因此，MongoDB 到原型的路径似乎很简单。

我不了解`proto`的内部结构和 R 环境链接，足以知道是否有一种简单而可靠的方法可以将所有 proto 对象的属性作为 R 列表获取。这可以自动完成还是我应该考虑所有实现类似`to_list()`方法的原型对象？

我正在开发的一些示例代码`testthat`和一个新的 MongoDB 驱动程序 API 关于我希望在这里看到的行为：

```
test_that("proto persistence", {
  Person <- proto(
    ..Name = 'PersonFactory',
    has_tag = function(., tag) { 
     tag %in% .$tags 
    },
    new = function(., name, tags=c()) {
     .$proto(..Name='Person', name=name, tags=tags)
    } 
  )

  p1 <- Person$new(name='bob', tags=c('friend', 'coworker'))

  coll <- test_db()$collection('test') 
  coll$store('bob', p1)

  result <- coll$find_one(id='bob')
  expect_true(is.list(result))
  expect_true(is.list(result$proto))
  expect_equal(result$proto$name, 'bob')
  expect_equal(result$proto$tags, c('friend', 'coworker'))

  p2 <- coll$load('bob')
  expect_equal(p2$name, 'bob')
  expect_equal(p2$tags, c('friend', 'coworker'))
  expect_true(p2$has_tag('friend'))
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:20:26.347

从`p1`问题变成列表。`L1`：

```
L1 <- as.list(p1) 
```

并将其转回原始对象，`p1a`其父对象为`Person`：

```
p1a <- as.proto(L1, parent = Person) 
```

然后，您可以围绕这些基础构建任何您想要的结构。

# java - Spring + Tiles (+Portal) 基础错误页面

> ID：12065313
> 
> 赞同：0
> 
> 时间：2012-08-22T01:43:12.103
> 
> 标签：java, spring, tiles, portal

我正在尝试做一些看起来对我来说应该很简单的事情，但似乎没有工作......我有一个由瓷砖组成的页面，目前在一个的渲染阶段有一个例外的jsps，导致显示我的错误页面-但这仅显示*在它发生的磁贴中*。我真正想要的是显示错误的整个页面，而不仅仅是其中一个图块，这肯定是可能的吗？

显示的错误页面在 web.xml 中定义并包含`<%@ page isErrorPage="true" %>`，我也尝试添加`<%@ page errorPage="/errorPage.jsp" %>`到我的 baselayout.jsp 但这似乎无法识别 - 我可以输入任何值并且它不会给出错误或任何东西. 瓦片是否没有将异常传播到父 jsp 的选项，而不仅仅是在每个瓦片中显示错误？

例如 SimpleMappingExceptionResolver 将不起作用，因为异常处于渲染阶段。我已经尝试按照 Spring SimpleMappingExceptionResolver 中的建议实现 HandlerInterceptor[不会进入默认视图](https://stackoverflow.com/questions/2967016/spring-simplemappingexceptionresolver-not-going-to-default-view)，但是在 afterResourceCompletion() 方法中，异常参数为空，这是我认为我的异常所在的位置。

我还查看了[http://www.jguru.com/faq/view.jsp?EID=1071592](http://www.jguru.com/faq/view.jsp?EID=1071592)这似乎表明旧版本的 Struts 存在问题 - Spring 是否共享此问题？

希望我在这里遗漏了一些非常简单的东西，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T05:20:27.603

所以看起来这是 JSP 处理异常的方式的问题，在[http://www-01.ibm.com/support/docview.wss?uid=swg1PM22919中有概述](http://www-01.ibm.com/support/docview.wss?uid=swg1PM22919)

对我来说，WebSphere Portal 版本 7 的修订包 15 添加了一个新属性 com.ibm.ws.webcontainer.dispatcherRethrowSError，我将其设置为 true，它将异常传递给调用类。

所有属性都在[http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frweb_custom_props.html](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Finfo%2Fexp%2Fae%2Frweb_custom_props.html)

# sql - 如何根据组和排序查询记录？

> ID：12065316
> 
> 赞同：0
> 
> 时间：2012-08-22T01:43:31.313
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, postgresql, activerecord

给定以下模型：

```
User
    id
UserPulses
    id, user_id, group_id, created_at 
```

我想做的是获取按（group_id）分组的所有用户的UserPulse，并且只获取每个group_id 的最新UserPulse。我已经能够通过逐组循环来做到这一点，但这需要大量查询。这可以通过一个查询来实现吗？

类似于：user.user_pulses.group("group_id)")

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:36:07.333

您不能通过通常的 ActiveRecord 接口可靠地执行此操作，但您可以使用[窗口函数](http://www.postgresql.org/docs/current/static/functions-window.html)通过 SQL 执行此操作。你想要一些这样的 SQL：

```
select id, user_id, group_id, created_at
from (
    select id, user_id, group_id, created_at, 
           row_number() over (partition by group_id order by created_at desc, id desc) as r
    from user_pulses
    where user_id = :user_id
) dt
where r = 1 
```

然后将其包装在[`find_by_sql`](http://api.rubyonrails.org/classes/ActiveRecord/Querying.html#method-i-find_by_sql)：

```
pulses = UserPulses.find_by_sql([%q{
    select id, user_id, group_id, created_at
    from (
        select id, user_id, group_id, created_at, 
               row_number() over (partition by group_id order by created_at desc, id desc) as r
        from user_pulses
        where user_id = :user_id
    ) dt
    where r = 1
}, :user_id => user.id]) 
```

窗口函数部分本质上对每个 GROUP BY 执行本地 GROUP BY ，对`group_id`它们进行排序（`id desc`作为辅助排序键作为“以防万一”的决胜局），并将每组的行号添加到`r`. 然后外部查询过滤掉每个组 ( `where r = 1`) `and peels off the original`user_pulses 列中的第一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T18:15:03.647

您可以使用 SQL 特性的 PostgreSQL 特定扩展`DISTINCT`：[`DISTINCT ON`](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-DISTINCT)

```
SELECT DISTINCT ON (group_id)
       id, user_id, group_id, created_at
FROM   user_pulses
WHERE  user_id = :user_id
ORDER  BY group_id, created_at DESC, id; -- id just to break ties 
```

比窗口函数更简单（但不那么便携）并且可能最快。[此相关问题下的](https://stackoverflow.com/q/3800551/939860)
更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T01:51:57.877

可能是这样的。但是，如果用户/组 ID 组合的日期相同，则它们可能有多个记录。

```
SELECT p.id, p.user_id, p.group_id, p.created_at
  FROM UserPulses p
      ,( SELECT user_id, group_id, MAX(created_at) as max_date
           FROM UserPulses
           GROUP BY user_id, group_id ) m
  WHERE u.user_id = m.user_id
    AND u.group_id = m.group_id
    AND u.created_at = m.max_date 
```

# python - GAE 生成 HTTP 错误 400：从 Twitch.tv API 索引 URL 时请求回溯错误

> ID：12065320
> 
> 赞同：0
> 
> 时间：2012-08-22T01:44:13.130
> 
> 标签：python, api, google-app-engine

部署应用程序时，我似乎收到此错误，但在本地主机上提供服务时却没有：

```
E 2012-08-21 18:03:46.914 HTTP Error 400: Bad Request Traceback (most recent call last): File "/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py

E 2012-08-21 18:03:46.916 Traceback (most recent call last): File "/base/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py", line 195, in Handle 
```

生成此错误的代码位于此处（请原谅巨大的处理程序）：

```
class Dashboard(MainHandler):

def check_if_live(self,b):
    url = ('http://api.justin.tv/api/stream/list.json?channel=%s' %b)
    contents = urllib2.urlopen(url)
    if contents.read() == '[]':
        return 'Offline'
    else:
        return 'Live'

def get(self, profile_id):
    u = User.by_name(profile_id.lower())
    if not u:
        self.redirect('/')
    elif self.user.name != profile_id:
        self.redirect('/profile/%s' %self.user.name)
    elif self.user and profile_id:
        current_user = self.user.name
        name1 = ''
        friend_name = ''
        team_imagee = ''
        key = ''
        monthss = ''
        yearss = ''
        dayss = ''
        countryss = ''
        team_imagee2 = ''
        imgs2 = ''
        imgs = ''
        key2 = ''
        name22 = ''
        name2 = ''
        streamss = ''
        streams_title = ''
        imgs  = db.GqlQuery("select * from Profile_Images WHERE name =:1", profile_id)
        imgs2  = db.GqlQuery("select * from Profile_Images WHERE name =:1", current_user)
        team_name  = db.GqlQuery("select * from Teams WHERE name =:1", profile_id)
        team_images  = db.GqlQuery("select * from Teamimg WHERE user =:1", profile_id)
        team_images2  = db.GqlQuery("select * from Teamimg WHERE user =:1", current_user)
        friends  = db.GqlQuery("select * from Friends WHERE name =:1 order by added_date desc limit 10", profile_id)
        posts = db.GqlQuery("select * from Profile_Comments WHERE name_of_profile =:1 order by date_created desc", profile_id)
        name2 = db.GqlQuery("select * from User WHERE name =:1", profile_id)
        month = db.GqlQuery("select * from User WHERE name =:1", profile_id)
        day = db.GqlQuery("select * from User WHERE name =:1", profile_id)
        year = db.GqlQuery("select * from User WHERE name =:1", profile_id)
        country = db.GqlQuery("select * from User WHERE name =:1", profile_id)
        streams = db.GqlQuery("select * from Streams WHERE username =:1", current_user)
        for stream_title in streams:
            streams_title = stream_title.stream_title
        for stream in streams:
            streamss = stream.stream
        for months in month:
            monthss = months.month
        for countrys in country:
            countryss = countrys.country
        for days in day:
            dayss = days.day
        for years in year:
            yearss = years.year
        for clan in team_name:
                name1 = clan.team_name_anycase
        for clan in team_name:
                name2 = clan.team_name
        for image in team_images:
            team_imagee = image.key()
        for image2 in team_images2:
            team_imagee2 = image2.key()
        for img in imgs:
            key = img.key()
        for img2 in imgs2:
            key2 = img2.key()
        streamm = (streamss[(streamss.find('.tv/')+ 4):])
        check_if_life2 = self.check_if_live((streamss[(streamss.find('.tv/')+ 4):]))
        self.render('dashboard.html', streams = streams, stream_title2 = streamm, stream_title = streams_title, check_if_life = check_if_life2, team_name2 = name2,  imgs = imgs, team_img2 = team_imagee2, profile_image_posted = key2, posts = posts, profile_id = profile_id, country_var = countryss, day_var = dayss, year_var = yearss, month_var = monthss, current_user = current_user, friends = friends, team_img = team_imagee, team_name = name1, profile_image = key, username = self.user.name, email = self.user.email, firstname = self.user.first_name, last_name = self.user.last_name, country = self.user.country)
    else:
        self.redirect('/register') 
```

这就是造成它的具体原因：

```
 streamm = (streamss[(streamss.find('.tv/')+ 4):])
    check_if_life2 = self.check_if_live((streamss[(streamss.find('.tv/')+ 4):])) 
```

它利用了顶部的函数“check_if_live”。作为一个完全的python菜鸟，我一生都无法弄清楚为什么这个错误是实时生成的，而不是在本地主机上生成的。

编辑：

我仍然无法让 API 工作。有趣的是，如果您在地址栏中调用 API，例如[http://api.justin.tv/api/stream/list.json?channel=nasltv](http://api.justin.tv/api/stream/list.json?channel=nasltv)，它可以正常工作。但是一旦它接触到应用程序引擎，它就会失败。我只需要索引这个 API！啊!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:36:49.403

您调用的 API 中是否涉及身份验证？也许有一个重定向 cookie。IIRC prod 和 dev 之间的重定向行为不同。

# php - PHP 可以轻松地将 JSON 对象解析为 PHP 对象吗？

> ID：12065322
> 
> 赞同：-4
> 
> 时间：2012-08-22T01:44:30.587
> 
> 标签：php, json

或多或少，我的问题如上所述。

我有很多数据要序列化并发送到服务器。话虽如此，是否有一个 PHP 函数可以将其解析为 PHP 对象以在服务器端进行操作？

由于 PHP 的动态特性，我的想法是肯定的，但我不确定它会是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T01:49:13.867

你基本上回答了你自己的问题。从[json_decode 的 PHP 手册条目中](http://us2.php.net/manual/en/function.json-decode.php)：

> **json_decode**
> 
> 采用 JSON 编码的字符串并将其转换为 PHP 变量。

也就是说，您显然希望进行所有必要的错误检查等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:52:28.277

您还可以使用`json_decode`true 参数来有效地将其转换为 PHP 数组，如下所示：`$var = json_decode($object,true);`

# php - 从查询结果查询Mysql

> ID：12065325
> 
> 赞同：2
> 
> 时间：2012-08-22T01:44:59.623
> 
> 标签：php, mysql, subquery

我正在制作一个类似于公告板的东西，它要求读者承认他们已经阅读了它，并且想知道是否有更有效的方法来做到这一点。

我在 MySQL 端有 3 个表：

```
 +-----------------+        +-----------------+        +-----------------+
    |  Announcements  |        | Acknowledgement |        |      User       |
    +-----------------+        +-----------------+        +-----------------+
    | announce_id     |        | ack_id          |        | user_id         |
    | announce_msg    |        | announce_id     |        | user_name       |
    | ...             |        | user_id         |        | ...             |
    +-----------------+        +-----------------+        +-----------------+ 
```

当用户“阅读”公告（通过单击按钮）时，`Acknowledgment`将插入带有公告 ID 和用户 ID 的表格。当第二个用户“阅读”相同的公告时，`Acknowledgement`将再次插入具有相同公告 ID 和第二个用户 ID 的表，依此类推......

```
 +--------------------------------+
    |        Acknowledgement         |
    +--------+-------------+---------+
    | ack_id | announce_id | user_id |
    +--------+-------------+---------+
    |   1    |      1      |    1    |
    |   2    |      1      |    4    |
    |   3    |      1      |    3    |
    |   4    |      3      |    1    |
    |   5    |      3      |    6    |
    |   6    |      3      |    2    |
    +--------+-------------+---------+ 
```

现在来解决问题。在前端，当我在一个页面上列出所有公告时，我必须首先查询所有公告。然后，对于每个公告，我都必须对所有阅读过此公告的用户进行另一次查询。

```
 $sql = "select * from Announcements";
 $result = $pdo->query($sql);
 while ($row = $result->fetch())
 {
   $announce_id = $row['announce_id'];
   $announce_msg = $row['annouce_msg'];
   $readers = "";

   $sql2 = "select u.user_name from Acknowledgement as a INNER JOIN User as u where announcement_id =".$annouce_id;
   $result2 = $pdo->query($sql);
   while ($row2 = $result2->fetch())
   {
     $readers .= $row2['user_name'].", ";
   }

   echo "id:".$annouce_id.", message:".$announce_msg.", Readers:".$readers;
 } 
```

所以如果页面上有10条公告，那么每条公告就会有10个子查询。我现在所拥有的现在可以完成这项工作......但是如果有 1000 个公告怎么办？那么会有1000个子查询呢？听起来数据库真的会受到重创。所以我希望有更好的方法来做到这一点。

此外，如果用户表中的 1000 人阅读了所有 1000 条公告，则确认表将有 1000x1000 个条目。看起来确认表会变得非常长。随着时间的推移，这会成为问题吗？

这是我正在尝试做的一个非常粗略的例子，但我确实花了很长时间来写这一切。如果需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T02:04:40.550

有一个更好的办法。您可以对 group_concat 使用单个查询：

```
select a.*, group_concat(u.user_name separator ', ') as AllUsers
from Announcements a join
     Acknowledgement ak
     on a.Announce_Id = ak.Announce_Id join
     User u
     on u.user_ID = ak.User_ID
group by a.announce_id 
```

这使用隐藏列的 MySQL 功能仅按一个列（announce_id）分组，但仍然拉入一堆没有聚合的其他列（所有其他列都由“*”拉入）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T02:01:39.390

如果您在此处的目的是过滤掉当前用户已阅读的公告，则可以采用完全不同的方式来执行此操作。无需查询每个公告，然后找出所有已阅读这些公告的用户并检查*这些*结果以找到您的用户已阅读并从显示的列表中删除它们，您只需一次查询特定的所有内容用户（或用户列表）尚未阅读。

将您的查询更改为：

```
SELECT * FROM Announcements WHERE Announce_id NOT IN (SELECT ANNOUNCE_ID FROM Acknowledgement WHERE User_ID = <INSERT USER ID HERE>) 
```

这应该返回该特定用户尚未确认的所有 Announcement 行。如果将最后一个`WHERE`子句更改为，`WHERE User_ID IN ()`则可以指定用户 ID 列表。

**编辑：**鉴于您在上面发布的评论，您可以使用此查询来获取没有人阅读的所有公告：

```
SELECT * FROM Announcements WHERE Announce_id NOT IN (SELECT ANNOUNCE_ID FROM Acknowledgement WHERE User_ID IN (SELECT User_ID FROM User)) 
```

将查询放在一起以查找某人（如果不是所有人）尚未阅读的公告的逻辑在这一秒就逃脱了我的视线。

**编辑第二个：**每个公告，以及所有阅读过和未阅读过的人，都需要使用您在上面使用过的不同类型的连接，即`FULL OUTER JOIN`. 不幸的是 MySQL 没有 IIRC 的那个特性，但是[它可以](http://www.xaprb.com/blog/2006/05/26/how-to-write-full-outer-join-in-mysql/)用联合查询来模拟

```
SELECT A.*, ACK.*, U.* FROM Announcements AS A 
INNER JOIN Acknowledgement AS ACK ON A.Announce_ID = ACK.Announce_ID 
LEFT OUTER JOIN User AS U ON ACK.User_ID = U.User_ID 
WHERE U.User_ID IS NOT NULL
UNION ALL
SELECT A.*, ACK.*, U.* FROM Announcements AS A
LEFT OUTER JOIN Acknowledgement AS ACK ON A.Announce_ID = ACK.Announce_ID
RIGHT OUTER JOIN User AS U ON ACK.User_ID = U.User_ID 
```

我认为应该这样做。当然，目前没有可测试的设施。

# jquery - 使用 jQuery 将事件侦听器添加到动态添加的元素

> ID：12065329
> 
> 赞同：103
> 
> 时间：2012-08-22T01:45:40.097
> 
> 标签：jquery, events

所以现在，我知道为了将*事件侦听*器附加到**动态**添加的元素，您必须在添加元素后重新定义侦听器。

有没有办法绕过这个，所以你不必执行整个额外的代码块？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-08-22T01:48:21.580

使用[`.on()`](http://api.jquery.com/on/)你可以定义你的函数一次，它将为任何动态添加的元素执行。

例如

```
$('#staticDiv').on('click', 'yourSelector', function() {
  //do something
}); 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-08-22T01:47:54.497

```
$(document).on('click', 'selector', handler); 
```

where`click`是事件名称，`handler`是事件处理程序，例如对函数或匿名函数的引用`function() {}`

PS：如果您知道要向其中添加动态元素的特定节点 - 您可以指定它而不是`document`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-01T18:24:21.373

您正在动态生成这些元素，因此在页面加载上应用的任何侦听器都将不可用。我已经用正确的解决方案编辑了你的小提琴。基本上，jQuery 通过将事件附加到父元素并将其向下传播到正确的动态创建的元素来保存事件以供以后绑定。

```
$('#musics').on('change', '#want',function(e) {
    $(this).closest('.from-group').val(($('#want').is(':checked')) ? "yes" : "no");
    var ans=$(this).val();
    console.log(($('#want').is(':checked')));
}); 
```

[http://jsfiddle.net/swoogie/1rkhn7ek/39/](http://jsfiddle.net/swoogie/1rkhn7ek/39/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-18T16:04:16.043

使用 jquery 插件调用添加新元素时，您可以执行以下操作：

```
$('<div>...</div>').hoverCard(function(){...}).appendTo(...) 
```

# python - Python列表理解语法错误

> ID：12065331
> 
> 赞同：1
> 
> 时间：2012-08-22T01:45:50.800
> 
> 标签：python, list-comprehension

使用 for 循环，以下 python 代码可以工作。

```
for item in results:
    item ['currentservertime'] = int(time.time()) 
```

但是，我想通过列表理解来做到这一点。所以我尝试了以下方法，但在 = 上出现语法错误

```
item['currentservertime'] = int(time.time()) for item in results 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T01:50:05.720

列表理解在这里不起作用，因为您在任何时候都没有构建列表 - 您正在更改各种字典中的值。如果您的原始代码具有以下形式，则列表理解将是正确的工具：

```
currentservertime = []
for item in results:
    currentservertime.append(int(time.time()) 
```

这将转化为列表理解：

```
currentservertime = [int(time.time()) for item in results] 
```

就目前而言，您现有的循环是实现您正在做的事情的最清晰和最直接的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:07:39.937

```
[i.update({'currentservertime': int(time.time())}) for i in results] 
```

# python - 如何将 SQLAlchemy TIMESTAMP 列只读缓冲区转换为日期时间？

> ID：12065335
> 
> 赞同：1
> 
> 时间：2012-08-22T01:46:09.503
> 
> 标签：python, datetime, sqlalchemy, timestamp, buffer

我继承了一个连接到 MSSQL 数据库的 SQLAlchemy 模型。大多数表都有一`modified`列。这些列是在 db 中计算的，因此模型像这样声明它们：

```
modified = Column(TIMESTAMP, FetchedValue()) 
```

当我调用此属性时，它会作为只读缓冲区返回：

```
>>> Thing.modified
<read-only buffer for 0xa901fa0, size 8, offset 0 at 0xa901fc0>

# as a string...
>>> str(Thing.modified)
'\x00\x00\x00\x00\x00\x85o8' 
```

我需要做的是将其转换为`datetime`. 这可能吗？如何？任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:13:23.047

这个问题并没有真正的肯定答案。MSSQL 中的数据类型实际上是一个序列号，尽管有这个名字。所以实际上不可能将其转换为日期时间对象。

# javascript - 密码框文本

> ID：12065340
> 
> 赞同：1
> 
> 时间：2012-08-22T01:47:05.160
> 
> 标签：javascript, asp.net, html, textbox, login-control

我目前有一个我的网站的登录框。我想在密码框中添加文本以告诉用户使用哪个密码。IE。密码框将包含文字（请使用 windows 登录密码），当他们单击它时，文字将消失并允许他们输入密码。
我可以使用这样的登录框来做到这一点：

```
<asp:TextBox ID="UserName" class="txtbox" runat="server" text="NUID" Width="240px"
 onfocus="if(this.value==this.defaultValue) {this.value='';$(this).css('color','black');}"  
 onblur="if(this.value=='') {this.value=this.defaultValue;$(this).css('color','rgb(173,180,195)');}"></asp:TextBox> 
```

但是，使用密码似乎不起作用。这似乎是由于它具有 textmode="password" 参数。

有谁知道如何在密码模式下使用 ASP.NET 文本框执行此操作。不是 HTML 文本框。

这是我当前的代码。

HTML

```
<asp:Login ID="Login1" class="loginbox" runat="server" Font-Names="Verdana" Font-Size="8pt" 
      DisplayRememberMe="False" UserNameLabelText="NUID:" 
      FailureText="Incorrect login. Please try again."  TitleText="" DestinationPageUrl="default.aspx" onauthenticate="Login1_Authenticate">
      <TextBoxStyle Width="110px" />
      <LoginButtonStyle Font-Names="Arial, Helvetica, sans-serif" Height="24px" />
                                        <LayoutTemplate>
                                            <table border="0" cellpadding="1" cellspacing="0" 
                                                style="border-collapse:collapse; height:113px">
                                                <tr>
                                                    <td>
                                                        <table border="0" cellpadding="0"> 
                                                            <tr>
                                                                <td valign="baseline">
                                                                <div class="textlogin">NUID</div>
                                                                </td>
                                                            </tr>                                                               
                                                            <tr>
                                                                <td>
                                                                    <asp:TextBox ID="UserName" class="textloginbox" runat="server"  Font-Bold="true"></asp:TextBox>
                                                                    <asp:RequiredFieldValidator ID="UserNameRequired" runat="server" 
                                                                        ControlToValidate="UserName" ErrorMessage="User Name is required." 
                                                                        ToolTip="User Name is required." ValidationGroup="Login1" ForeColor="#FF0000" Font-Bold="true" Font-Size="14px">*</asp:RequiredFieldValidator>
                                                                </td>
                                                            </tr>
                                                            <tr><td style="height:3px;"></td></tr>
                                                            <tr>
                                                                <td>
                                                                <div class="textlogin">Password</div>
                                                                </td>
                                                            </tr>  
                                                            <tr>
                                                                <td>

                                                                    <asp:TextBox ID="Password" runat="server" class="textloginbox" TextMode="Password" Font-Bold="true"></asp:TextBox>
                                                                    <asp:RequiredFieldValidator ID="PasswordRequired" runat="server" 
                                                                        ControlToValidate="Password" ErrorMessage="Password is required." 
                                                                        ToolTip="Password is required." ValidationGroup="Login1" ForeColor="#FF0000" Font-Bold="true" Font-Size="14px">*</asp:RequiredFieldValidator>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td align="center" style="color:#DA6426;">
                                                                    <asp:Literal ID="FailureText" runat="server" EnableViewState="False"></asp:Literal>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td align="right">
                                                                <asp:ImageButton ID="LoginButton" runat="server" CssClass="loginbutton" CommandName="Login" ValidationGroup="Login1"  ImageUrl="~/Icons/Enter Arrow 30.png" />
                                                                &nbsp;&nbsp;       
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </table>
                                        </LayoutTemplate>
                                    <TitleTextStyle BackColor="#FFFFE0" Font-Bold="True" 
                                        ForeColor="#FFFFFF" Height="0px"/>
                                    </asp:Login> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:06:34.450

您是否尝试过占位符属性？所以在 ID="Password" 之后，放入 placeholder="Enter Test Here"。它不适用于 IE8 及以下版本……试试这个（使用 jQuery）

```
$("#Password").focus(function()
{
    if($(this).val() == "Your Text Here")
    {
        $(this).val("");
    }
});

$("#Password").blur(function()
{
    if($(this).val() == "")
    {
        $(this).val("Your Text Here");
    }
}); 
```

编辑：在阅读了上面的评论后，他有一点。使用此代码将使“您的文本在此处”不可读。但是，占位符属性将正确显示，即使它不适用于 IE 8 及更低版本

# php - 每次页面加载都请求唯一的 id

> ID：12065341
> 
> 赞同：1
> 
> 时间：2012-08-22T01:47:17.303
> 
> 标签：php, sql

我正在创建一个需要为每个页面加载选择唯一 ID 的页面。它基本上是一个采购订单系统，但 PO 只是 UID，因此任何用户都不能获得相同的 ID，这一点很重要。我尝试只调用最后一个 ID，然后添加 1 并提交，但如果两个或多个用户同时输入，这可能会产生冲突。为每个页面加载提取 UID 的最佳方法是什么？有什么解决办法吗？

谢谢

劳埃德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T01:49:58.873

您可以使用该[`uniqid`](http://php.net/uniqid)函数获取唯一密钥。[`hexdec`](http://php.net/hexdec)如果您需要一个整数，请运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:50:39.940

PHP有一个：

[http://php.net/manual/en/function.uniqid.php](http://php.net/manual/en/function.uniqid.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T06:11:21.173

UniqId() 是一种方法，但会产生大量数据。正如 V Patel 所说，还有“自动增量”，这可能是您想要的选项。

1.  在 MySQL 中设置一个带有字段“po_id”的表（比如“PurchaseOrders”）并将其设置为主键和[自动增量](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)。添加另一个字段“po_status”（TinyInt*1）和另一个“po_lastused”（日期*1）。状态将为 0=草稿、1=最终、2=已发货等。LastUsed 是用户最后一次访问详细信息。

2.  当您要创建新的采购订单时， INSERT INTO PurchaseOrders(po_status, po_lastused) VALUES(0, NOW()); 注意：您没有指定实际的采购订单

3.  您可以通过询问“最后插入 id”来获取 po_id (http://php.net/manual/en/mysqli.insert-id.php, [http://php.net/manual/en/function.mysql -insert-id.php](http://php.net/manual/en/function.mysql-insert-id.php) , [http://www.php.net/manual/en/pdo.lastinsertid.php](http://www.php.net/manual/en/pdo.lastinsertid.php)，取决于你的编码库）

4.  将 po_id 存储在会话变量中，以便当用户返回时，您知道他们的 po_id(*2)

5.  每次用户访问采购订单时，如果“上次更新”时间超过 5 分钟，则更新计时器。

6.  定期删除所有草稿且上次更新时间早于您的会话的采购订单（例如一天之后）

这样，您将获得易于引用的漂亮采购订单编号。

*1 对于纯粹主义者，您还可以使用 Enum 作为状态，使用 int 作为日期 - 取决于您的偏好。您还可以将日期设置为自动更新。但我保持简单。）

*2 同样，对于纯粹主义者，您可以在此处实施更多安全措施，以确保“其他”用户无法访问其他人的采购订单，但这足以开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T02:02:31.507

使用正在使用的数据库的自动增量功能，特别是如果你喜欢它是一个数字并且在你想要持久化它之前不需要它。

# dart - 为什么覆盖否定会导致 Dart 中的静态警告

> ID：12065346
> 
> 赞同：2
> 
> 时间：2012-08-22T01:48:16.597
> 
> 标签：dart

有一个如下的简单类被认为是一个静态警告，为什么？

> 运算符“否定”应返回数字类型

```

class Vector {
      final int x,y;
      const Vector(this.x, this.y);

      Vector operator +(Vector v) { // Overrides + (a + b).
        return new Vector(x + v.x, y + v.y);
      }

      Vector operator -(Vector v) { // Overrides - (a - b).
        return new Vector(x - v.x, y - v.y);
      }

      Vector operator negate() {    // Overrides unary negation (-a).
        return new Vector(-x,-y);
      }

      String toString() => '($x,$y)';
    }

    main() {
      final v = new Vector(2,3);
      final w = new Vector(2,2);
      assert((-v).x == -2 && (-v).y == -3); // -v  == (-2,-3)
    }

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T01:48:16.597

自 2012 年 8 月 21 日起，[Dart 规范](http://goo.gl/cj6DY)第 7.1.2 节运算符，考虑将具有可能的空值类型的 negate 定义为错误样式，并应向用户报告静态警告。

> 定义一个名为 negate 的空值方法或一个名为 equals 的二元方法将与定义运算符具有相同的效果，但被认为是不好的样式，并且会导致静态警告。
> 
> [...]
> 
> 如果用户声明的运算符 []= 的返回类型被显式声明并且不是 void，则这是一个静态警告。如果用户声明的运算符 equals 的返回类型被显式声明并且不是 bool，则这是一个静态警告。如果显式声明了用户声明的运算符 negate 的返回类型而不是数字类型，则这是一个静态警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T01:10:34.957

我们对此有一个未解决的错误：[http ://code.google.com/p/dart/issues/detail?id=3416](http://code.google.com/p/dart/issues/detail?id=3416)

# ruby-on-rails - 在 Heroku 上每周运行一次任务

> ID：12065350
> 
> 赞同：5
> 
> 时间：2012-08-22T01:48:31.160
> 
> 标签：ruby-on-rails, heroku

我的网站托管在 Heroku 上，我需要每周运行一次任务。调度程序插件只允许我每天运行一次任务......无论如何我可以改变它吗？

我的网站是用 Ruby on Rails 编写的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T01:51:43.557

检查今天是否是星期一，否则不要运行您的任务。

```
Time.now.wday
=> 2 
```

0：星期日.. 6：星期六

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-20T09:34:15.097

或者从调度程序任务中进行相同的检查

```
test `date +%w` -eq 2 && rake ... 
```

再次 0：星期日 ... 6：星期六

# c++ - 由于某种原因，使用 OR 运算符的 do-while 不起作用

> ID：12065357
> 
> 赞同：0
> 
> 时间：2012-08-22T01:50:14.193
> 
> 标签：c++

我想这个真的很简单，但我不知道有什么问题。问题是：

如果这有效：

```
char input;
do {
    cin >> input;
} while (input != '1');
system ("pause"); 
```

那么，为什么不这样做：

```
char input;
do {
    cin >> input;
} while ((input != '1') || (input != '2'));
system ("pause"); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T01:51:16.470

```
(input != '1') || (input != '2') 
```

此表达式的计算结果始终为，`true`因为`input`不能同时是`'1'`两者`'2'`。

您更有可能使用`&&`: 替换`||`为`&&`，表达式将计算为`true`if `input`is not`'1'`或`'2'`。

# shell - 如何在 Makefile 中获取 Unix 上的文件大小？

> ID：12065362
> 
> 赞同：2
> 
> 时间：2012-08-22T01:50:32.243
> 
> 标签：shell, unix, makefile

我想将此实现为 Makefile 任务：

```
# step 1:
curl -u username:password -X POST \
  -d '{"name": "new_file.jpg","size": 114034,"description": "Latest release","content_type": "text/plain"}' \
  https://api.github.com/repos/:user/:repo/downloads

# step 2:
curl -u username:password \
-F "key=downloads/octocat/Hello-World/new_file.jpg" \
-F "acl=public-read" \
-F "success_action_status=201" \
-F "Filename=new_file.jpg" \
-F "AWSAccessKeyId=1ABCDEF..." \
-F "Policy=ewogIC..." \
-F "Signature=mwnF..." \
-F "Content-Type=image/jpeg" \
-F "file=@new_file.jpg" \
https://github.s3.amazonaws.com/ 
```

但是，在第一部分中，我需要获取文件大小（如果很容易，还需要获取内容类型，但不是必需的），因此需要一些变量：

```
{"name": "new_file.jpg","size": $(FILE_SIZE),"description": "Latest release","content_type": "text/plain"} 
```

我试过了，但它不起作用（Mac 10.6.7）：

```
$(shell du path/to/file.js | awk '{print $1}') 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:54:02.817

如果你有 GNU coreutils：

```
FILE_SIZE=$(stat -L -c %s $filename) 
```

告诉它`-L`遵循符号链接；没有它，如果`$filename`是符号链接，它将为您提供符号链接的大小而不是目标文件的大小。

[MacOS stat](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/stat.1.html)等效项似乎是：

```
FILE_SIZE=$(stat -L -f %z) 
```

但我无法尝试。（我将其编写为 shell 命令，而不是 make 命令。）您可能还会发现该`-s`选项很有用：

> 在“shell 输出”中显示信息，适用于初始化变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:39:40.317

~~我认为这是解析输出`ls`是合法的情况：~~

 ~~```
% FILE_SIZE=`ls -l $filename | awk '{print $5}'` 
```~~ 

~~（不，不是：使用`stat`，正如 Keith Thompson 所指出的）~~

 ~~对于类型，您可以使用

```
% FILE_TYPE=`file --mime-type --brief $filename` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-23T14:05:27.020

作为参考，另一种方法是使用`du`字节`-b`输出并`-s`仅用于摘要。然后`cut`只保留返回字符串的第一个元素

```
FILE_SIZE=$(du -sb $filename | cut -f1) 
```

这应该返回与@Keith Thompson 答案相同的字节结果，但也适用于完整目录大小。

额外：我通常为此使用宏。

```
define sizeof
    $$(du -sb \
    $(1) \
    | cut -f1 )
endef 
```

然后可以这样称呼，

```
$(call sizeof,$filename_or_dirname) 
```~~

# android - 在行单击时更改表格行中文本视图中文本的颜色

> ID：12065366
> 
> 赞同：0
> 
> 时间：2012-08-22T01:50:49.487
> 
> 标签：android

我有一个表格，其中一些行具有 textview 和 imageview。我正在使用选择器可绘制更改单击时行的背景。我还需要更改文本的颜色和单击时的 imageview 图像。我尝试使用 textview 的选择器作为在[这里解释](https://stackoverflow.com/questions/4247385/how-to-change-color-of-listview-items-on-focus-and-on-click)

文本视图的颜色需要在单击父表行而不是单击文本视图时更改。更改的颜色不应持续存在。它应该只是选定行单击的指示

但它似乎不起作用。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:16:10.857

实现此目的的一种简单方法是在 xml 中为 textview 设置 onClick 属性

```
android:onClick="changeColor" 
```

然后在视图所属的activity中有一个方法

```
public void changeColor(View v){
    v.setBackgroundColor(color);
} 
```

v 将是调用该`changeColor()`方法的视图（因此它是您要更改颜色的视图）

您可以扩展它（或编写其他方法设置为其他视图的 onClick 方法）以通过将 v 转换为适当的视图来更改其他视图的属性（即 TextView 以更改文本颜色，或 ImageView 以更改可绘制的图像）

如果您想确切地找到调用该方法的视图，您可以打开 v.getId() ，其中 case 语句是 R 中设置的 id，即您使用`android:id="@+id/name`属性设置的那些

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:57:37.663

为表格行设置 OnTouchListener，如在[android TextView 中：单击时更改文本颜色](https://stackoverflow.com/questions/4468380/android-textview-change-text-color-on-click)

在 ontouch 事件中，从行中获取 textview 子项并更改其颜色..

# bluetooth - 与低功耗蓝牙兼容的消息访问配置文件 (MAP)？

> ID：12065367
> 
> 赞同：4
> 
> 时间：2012-08-22T01:51:07.500
> 
> 标签：bluetooth, bluetooth-lowenergy

是否可以将蓝牙消息访问配置文件 (MAP) 与蓝牙低功耗（蓝牙智能）技术一起使用？从规范的快速阅读来看，MAP 似乎只在传统的 BT 端可用。这将禁止将 MAP + LE 用于智能手表之类的东西。是这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T11:41:56.390

蓝牙 LE 不支持消息访问配置文件。蓝牙 LE 用于传输小数据包，而在 MAP 中，大数据包跨设备发送。MAP 是基于 OBEX 的配置文件，它依赖于 RFCOMM 和 L2CAP，RFCOMM 在 BT LE 上不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:04:39.033

好的，根据阅读 MAP [1](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=215400&ei=A6U3UKrzHK3qiQLBmoHQAg&usg=AFQjCNEqBPURzpAHujZMvoG-ps5_zrXRQw&sig2=G4IYYvet62fCWt_MDLZFfA)的蓝牙规范和其他人的反馈，答案是 MAP 仅在传统蓝牙中受支持，而不是蓝牙 LE。这对于小型电池供电的信息设备来说是个坏消息，比如智能手表，这些设备本来就非常适合 MAP。

# ruby-on-rails - 按 has_many 模型大小查找

> ID：12065376
> 
> 赞同：0
> 
> 时间：2012-08-22T01:52:12.053
> 
> 标签：ruby-on-rails, ruby-on-rails-2

我正在开发 Rails 2.3.8 Ruby 1.8.7 和 PostgreSQL。

当我想搜索小于特定大小的模型时，如何编写查找条件？

例如，我想搜索少于 5 条评论的主题。

```
class Topic < ActiveRecord::Base
     has_many :comments
end

class Comment < ActiveRecord::Base
     belongs_to :topic
end

Topic.find(:all,:include => :comments, :conditions => [(which has less than 5 comments)]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:11:46.533

这会解决你的问题吗？

Topic.find(:all, :select => 'topics.*, count(comments.id) AS comment_count', :joins => 'INNER JOIN comments ON comments.topic_id = topics.id', :group => 'comments .topic_id HAVING count(comments.topic_id) < 5' )

# c# - 如何在视图中引用隐式类型模型

> ID：12065381
> 
> 赞同：3
> 
> 时间：2012-08-22T01:52:34.710
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我正在学习 MVC，我正在尝试为我的模型创建一个隐式类型变量，但不确定如何在视图中引用它`@model IEnumerable<???>`

控制器...

```
public ActionResult Users() {
    var model = from MembershipUser u in Membership.GetAllUsers()
                select new {user = u, roles = string.Join(", ", Roles.GetRolesForUser(u.UserName))};

    View(model);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T02:00:19.610

您不能在视图中（或其本地范围之外的任何地方）引用匿名类型变量。可以使用*动态*类型：

```
@model IEnumerable<dynamic> 
```

但是这样你就没有智能感知/编译时类型检查；最好的方法是为您的模型创建一个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T01:57:20.053

那是您要返回的匿名类型。我相信您会想要使用实际类型。如果您在查询中选择的内容没有一个，则需要创建一个。

一旦你有了你的类型，下面是一个在视图中使用它的例子。

这是我认为的第一行：

```
@model IEnumerable<AutoTrackerCommon.Entities.TrackerJob> 
```

我在 WebGrid 中使用它：

```
@{
    var grid = new @WebGrid(
        source: Model,
        rowsPerPage: 10);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T02:04:31.767

您将其称为`Model`，但您为什么要这样做？使用 ViewModel，不要使用无类型或隐式类型的模型。这是一场噩梦：你失去了从 IDE 支持到自动验证的一切。不要让你的生活不必要地复杂化。视图模型（或强类型视图）是要走的路。

值得阅读的好文章：[在 ASP.NET MVC 中查看模型](http://blogs.msdn.com/b/simonince/archive/2010/01/26/view-models-in-asp-net-mvc.aspx)。

希望这对您有帮助并祝您好运

# javascript - struts2的Javascript代码

> ID：12065385
> 
> 赞同：0
> 
> 时间：2012-08-22T01:53:10.097
> 
> 标签：javascript, struts2

如何使用 struts2 标签库编写以下代码。因为 struts2 有很多标签，比如迭代器、if 等，但是如何使用它来实现下面的代码呢？

我们如何初始化 struts2 标记中的变量，然后如何应用递增或递减操作，如下所示的代码？

```
int j=-1;
for(int i=0;i<4;i++)
{
j++;
if(j==0)
{
}
if(j==1)
{
}
if(j==2)
{
j=-1;
}
} 
```

这是我的 jsp 页面，我在其中使用了 scriplet 标记中的 java 代码

```
<h3>Our Latest Projects</h3>
<%! int j = -1; %>

<%
  for (int i = 0; i < 4; i++) {
    j++;
%>
  <% if (j == 0) { %>
<div class="wrapper">
  <article class="grid_4 alpha">
    <h4 class="p2">Project 1</h4>
    <figure><a href="#"><img class="img-border" src="images/page4-img1.jpg" alt=""/></a></figure>
    <div class="box" style="height: 20px; width: 257px;">
      <div class="padding">
        <a href="#">View Details</a>
      </div>
    </div>
  </article>
  <% } %>

  <% if (j == 1) { %>
  <article class="grid_4">
    <div class="indent-left4">
      <h4 class="p2">Project 2</h4>
      <figure><a href="#"><img class="img-border" src="images/page4-img2.jpg" alt=""/></a></figure>
      <div class="box" style="height: 20px; width: 257px;">
        <div class="padding">
          <a href="#">View Details</a>
        </div>
      </div>
    </div>
  </article>
  <% } %>
  <% if (j == 2) { %>
  <article class="grid_4 omega">
    <div class="indent-left3">
      <h4 class="p2">Project 3</h4>
      <figure><a href="#"><img class="img-border" src="images/page4-img3.jpg" alt=""/></a></figure>
      <div class="box" style="height: 20px; width: 257px;">
        <div class="padding">
          <a href="#">View Details</a>
        </div>
      </div>
    </div>
  </article>
</div>
<br><br>
<% j = -1; %>
<% } %>
<% } %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:32:33.793

这悲剧。

这是除了`article > div`样式之外的所有内容，因为不清楚它与其他任何东西的关系；您应该能够根据此代码的其余部分弄清楚。

```
<div class="wrapper">
  <s:iterator begin="1" end="#session.count" status="stat">
    <s:set var="artClass" value="#stat.first ? 'alpha' : #stat.last ? 'omega' : ''" />

    <article class="grid_4 <s:property value="#artClass"/>">
      <div> <!-- Not really sure what you want here for the class. -->
        <h4 class="p2">Project <s:property value="#stat.count"/></h4>
        <figure><a href="#"><img class="img-border" src="images/page4-img<s:property value="#stat.count"/>.jpg" alt=""/></a></figure>
        <div class="box" style="height: 20px; width: 257px;">
          <div class="padding">
            <a href="#">View Details</a>
          </div>
        </div>
      </div>
    </article>
  </s:iterator>
</div> 
```

此外，如果“alpha”和“omega”用于第一列和最后一列，而不是列表中的第一个/最后一个项目，您可能需要稍微改变一下。就个人而言，我会在 Java 代码中将列表拆分为三个列表并进行两次迭代：

```
<s:iterator value="listOfLists" var="list">
  <s:iterator value="list" status="stat">
    <s:set var="artClass" value="#stat.first ? 'alpha' : #stat.last ? 'omega' : ''" />

    <article class="grid_4 <s:property value="#artClass"/>">
      <div> <!-- Not really sure what you want here for the class. -->
        <h4 class="p2">Project <s:property value="#stat.count"/></h4>
        <figure><a href="#"><img class="img-border" src="images/page4-img<s:property value="#stat.count"/>.jpg" alt=""/></a></figure>
        <div class="box" style="height: 20px; width: 257px;">
          <div class="padding">
            <a href="#">View Details</a>
          </div>
        </div>
      </div>
    </article>
  </s:iterator>
  <br/><br/> <!-- Use CSS. -->
</s:iterator> 
```

您还可以将其封装在自定义标记和实用程序方法中，并使事情变得非常干净。

# ruby-on-rails-3 - 没有模型的formtastic表单中选择字段的默认值

> ID：12065387
> 
> 赞同：1
> 
> 时间：2012-08-22T01:53:23.870
> 
> 标签：ruby-on-rails-3, formtastic

我有一个表格来收集报告生成的参数。我知道 formtastic 旨在与模型一起使用，但我需要在这里使用它，因为表单位于 activeadmin 页面中。

一切正常，但我无法为选择设置默认值。我愿意实施“卑鄙的黑客”来使其正常工作。我不希望仅仅为了在表单上设置默认值而实现假模型。

表单代码如下所示

```
<%= semantic_form_for "report", :url => report_admin_payments_path do |f| %>
  <%= f.inputs do %>
    <%= f.input :report_type, :as => :select, :collection => report_types, :input_html => {:style => "width:180px"}  %>    
    <%= f.input :start_date, :as => :string, :input_html => {:class => 'datepicker', :style => "width:60px", :value => 1.month.ago.strftime("%Y-%m-%d")} %>
    <%= f.input :end_date, :as => :string, :input_html => {:class => 'datepicker', :style => "width:60px", :value => Time.zone.now.strftime("%Y-%m-%d")} %>
    <%= f.input :country, :as => :select, :collection => locales, :input_html => {:style => "width:180px"}%>
  <% end %>
  <%= f.actions :submit %>
<% end %> 
```

提前致谢，

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:28:08.073

这个或类似的东西应该可以满足您的需求。

```
class LightModel

  # Subclass this for a model that looks like an ar model but has no persistence
  # good for formtastic forms

  include ActiveModel::Naming
  include ActiveModel::Validations

  def initialize(attributes = {})
    @attributes = attributes
  end  

  # read only atm
  def method_missing(m, *args, &block)
    @attributes[m]
  end  

end 
```

谢谢，

马特

# javascript - 如何访问在卸载前触发的 JavaScript href 事件

> ID：12065389
> 
> 赞同：4
> 
> 时间：2012-08-22T01:53:28.037
> 
> 标签：javascript, dom-events, mailto, onbeforeunload

我想访问导致 beforeunload 事件的事件。具体来说，如果我单击指向另一个页面的链接，我想知道 beforeunload 事件处理程序中的链接是什么。

这样，我将根据 URL 的内容在 beforeunload 事件处理程序中执行不同的操作。

例如 'http:' 或 'https:' 警告用户丢失未保存的更改；'mailto:' 或 'skype:' 不要警告用户，因为页面实际上不会被卸载。

我正在尝试为这样的问题构建一个好的解决方案： [mailto 链接（在 chrome 中）正在触发 window.onbeforeunload - 我可以防止这种情况吗？](https://stackoverflow.com/questions/9740510/mailto-link-in-chrome-is-triggering-window-onbeforeunload-can-i-prevent-this)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-22T02:53:44.410

我已经准备好告诉您这是不可能的，因为 onbeforeunload 事件仅在您检查 event.target、event.originaltarget 等时报告已被窗口触发。但是，如果您覆盖 window.onclick，我们可以修改它方法来注册页面上最后点击的元素。然后，通过为 window.onbeforeunload 提供代码，我们可以指定新的行为来检查最后点击的元素的 href。万岁，啤酒！

这里的代码将为您提供您想要的确切信息，在纯 javascript 中并且没有在您的锚标签中添加任何内容。我还输入了 preventDefault() ，它会弹出“此页面要求您确认是否要离开 - 您输入的数据可能不会被保存。” 确认框。希望这会有所帮助 - 你可以从这里弄清楚该怎么做。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <title>12065389</title>
    <meta charset="utf-8">
    <script type="text/javascript">
        var last_clicked;

        window.onclick = function(e) {
            last_clicked = e.target;
            return true;
        }

        window.onbeforeunload = function(e) {
            var e = e || window.event;
            if (last_clicked.href) {
                alert(last_clicked.href);
                e.preventDefault();
            }
        }
   </script>
</head>
<body>
<a href="http://google.com">google</a>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:00:34.313

我可能会将事件附加到页面上的所有链接，而不是 beforeunload 事件。

就像是：

```
$("a").click(function(evt) {
    if($(this).attr('href').indexOf('http') == 0) {
        if(confirm("Are you sure?")) {
            //continue
        } else {
            evt.preventDefault();
        }
    }
} 
```

# php - %5B% 和 %5B0% 之间的区别？

> ID：12065392
> 
> 赞同：12
> 
> 时间：2012-08-22T01:53:48.160
> 
> 标签：php, jquery

jQuery .serialize() 将 "[]" 变成 %5B%5D

PHP http_build_query 似乎将第一个“[]”变成了 %5B0%5D，第二个变成了 %5B1%5D，等等。所以它似乎在使用某种计数器。

**为什么这些几乎相同的功能存在差异？**

只是我的浏览器使它们与众不同吗？如何确保 http_build_query 不添加额外的计数器（或让 jQuery 知道我需要额外的计数器）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-22T01:56:52.653

`%5B0%5D`是 的编码版本`[0]`，`%5B1%5D`是 的编码版本`[1]`，等等。

```
%5B is [
%5D is ] 
```

中间的数字是文字字符，不是任何 %HH 编码的一部分。

# ruby-on-rails - Rails (PostgreSQL?) 隐式序列/索引警告

> ID：12065394
> 
> 赞同：4
> 
> 时间：2012-08-22T01:54:01.813
> 
> 标签：ruby-on-rails, postgresql, migration, database-migration

> **可能重复：**
> [在 postgresql 应用程序的 rails 中运行迁移后的序列通知](https://stackoverflow.com/questions/5296290/notices-for-sequence-after-running-migration-in-rails-on-postgresql-application)

使用 PostgreSQL 开发和测试数据库（以及生产）。当我使用`rake db:test:prepare`我的**PostgreSQL** `theapp_test`数据库时，我会收到每个表的这些消息：

```
NOTICE:  CREATE TABLE will create implicit sequence "events_id_seq" for serial column "events.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "events_pkey" for table "events"
NOTICE:  CREATE TABLE will create implicit sequence "users_id_seq" for serial column "users.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "users_pkey" for table "users"
... 
```

我没有收到这些通知`rake db:migrate`on `theapp_development`。而且我还没有在生产中注意到它们。这是什么意思，我应该努力摆脱它们吗？

仅供参考 - 过去当我使用 MySQL（或 SQLite3）进行测试时，这并没有发生......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-22T02:01:54.493

您可以通过在 中添加（或取消注释）一行来使这些消息静音`config/database.yml`：

```
# config/database.yml
development:
  adapter: postgresql
  min_messages: WARNING  # this line silences those NOTICE messages 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T01:59:07.850

不，这只是 Postgres 很棒，它会自动为你创建你真正想要的东西。这不是警告，只是仅供参考

# android - 我无法弄清楚为什么我的按钮没有出现在我的 Android VM 上？

> ID：12065397
> 
> 赞同：1
> 
> 时间：2012-08-22T01:54:37.200
> 
> 标签：android, xml, user-interface, button, imagebutton

我正在尝试配置我的按钮布局，但无法弄清楚为什么按钮不可见，尽管没有错误。我已经修补过，充其量只能获得一个按钮来显示它们的全部内容。每个图像按钮都引用一个存储在 drawable-ldpi 中的图像，每个按钮的大小大约为 1 KB。

以下是预期的布局外观：

```
 _______________________
|        logo          |
|______________________|
|       search         |
|______________________|
|                      |
|     featured         |
|                      |
|______________________|
|    |     |     |     |
|    |     |     |     |
|    |     |     |     |
|    |     |     |     |
|    |     |     |     |
|    |     |     |     |
|    |     |     |     |
|____|_____|_____|_____|
|     advertisement    |
|______________________| 
```

Android main.xml 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainlayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <LinearLayout
        android:id="@+id/toplayout"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="45" >

        <ImageButton
            android:id="@+id/mytastelogo"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="15"
            android:src="@drawable/mytastelogo_image" />

        <ImageButton
            android:id="@+id/search"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="10" />

        <ImageButton
            android:id="@+id/featuredpanel"
            android:layout_width="fill_parent"
            android:layout_height="0dp"
            android:layout_weight="20" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/bottomlayout"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="45" >

        <ImageButton
            android:id="@+id/mycollection"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:src="@drawable/mycollection_image" />

        <ImageButton
            android:id="@+id/myrecommendations"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:src="@drawable/myrecommendations_image" />

        <ImageButton
            android:id="@+id/topitems"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:src="@drawable/topitems_image" />

        <ImageButton
            android:id="@+id/randomitem"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:src="@drawable/randomitem_image" />
    </LinearLayout>

    <ImageButton
        android:id="@+id/advertisement"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="10" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:04:43.990

您已将高度和宽度设置为 0 dps。你不会看到任何东西。尝试先解决那些 0dps。

# android - android上传到imgur并检索img的路径

> ID：12065398
> 
> 赞同：0
> 
> 时间：2012-08-22T01:54:58.143
> 
> 标签：android, imgur

我一直在阅读 imgur.com 的示例以及关于如何将图像上传到 imgur.com 的 stackoverflow.com

上传图片我使用这个代码：

```
 Bitmap bitmap = image;

 // Creates Byte Array from picture
 ByteArrayOutputStream baos = new ByteArrayOutputStream();
 bitmap.compress(Bitmap.CompressFormat.PNG, 100, baos); // Not sure whether this should      be jpeg or png, try both and see which works best
 URL url = new URL("http://api.imgur.com/2/upload");

 //encodes picture with Base64 and inserts api key
 String data = URLEncoder.encode("image", "UTF-8") + "=" + URLEncoder.encode(Base64.encode(baos.toByteArray(), Base64.DEFAULT).toString(), "UTF-8");
 data += "&" + URLEncoder.encode("key", "UTF-8") + "=" + URLEncoder.encode(API_KEY, "UTF-8");

 // opens connection and sends data
 URLConnection conn = url.openConnection();
 conn.setDoOutput(true);
 OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
 wr.write(data);
 wr.flush(); 
```

此代码没有错误。但是当我添加以下代码时，应该检索图像的 url。我得到一个空指针异常。以下代码在 wr.flush() 下；

```
 BufferedReader in = new BufferedReader(
                        new InputStreamReader(
                        conn.getInputStream()));

 String inputLine;

 while ((inputLine = in.readLine()) != null) 
 System.out.println(inputLine);
 in.close(); 
```

任何人都知道为什么我会得到这个 NPE？或者更好的方法来做到这一点？

```
 08-22 04:58:52.810: E/AndroidRuntime(26104): FATAL EXCEPTION: main
 08-22 04:58:52.810: E/AndroidRuntime(26104): java.lang.NullPointerException
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at se.xflash.myapp.ViewContact.uploadImgur(ViewContact.java:540)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at se.xflash.myapp.ViewContact.onOptionsItemSelected(ViewContact.java:340)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at android.app.Activity.onMenuItemSelected(Activity.java:2507)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:979)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.view.menu.MenuBuilder.dispatchMenuItemSelected(MenuBuilder.java:735)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:149)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:874)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.view.menu.IconMenuView.invokeItem(IconMenuView.java:468)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.view.menu.IconMenuItemView.performClick(IconMenuItemView.java:126)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at android.view.View$PerformClick.run(View.java:14329)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at android.os.Handler.handleCallback(Handler.java:605)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at android.os.Handler.dispatchMessage(Handler.java:92)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at android.os.Looper.loop(Looper.java:137)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at android.app.ActivityThread.main(ActivityThread.java:4511)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at java.lang.reflect.Method.invokeNative(Native Method)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at java.lang.reflect.Method.invoke(Method.java:511)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
 08-22 04:58:52.810: E/AndroidRuntime(26104):   at dalvik.system.NativeStart.main(Native Method) 
```

这是完整的代码：

```
 public void uploadImgur() {

    String API_KEY = "***********************";
    String uploadpath = ((MyVariables) getApplication()).getUploadPath();

    Bitmap bitmap = BitmapFactory.decodeFile(uploadpath);

    // Creates Byte Array from picture
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    bitmap.compress(Bitmap.CompressFormat.JPEG, 80, baos);

    try {
        URL url = new URL("http://api.imgur.com/2/upload");
        String  data = URLEncoder.encode("image", "UTF-8")
                + "="
                + URLEncoder.encode(
                        Base64.encode(baos.toByteArray(), Base64.DEFAULT)
                                .toString(), "UTF-8");
        data += "&" + URLEncoder.encode("key", "UTF-8") + "="
                + URLEncoder.encode(API_KEY, "UTF-8");

        URLConnection   conn = url.openConnection();

        conn.setDoOutput(true);
        OutputStreamWriter  wr = new OutputStreamWriter(conn.getOutputStream());

        wr.write(data);
        wr.flush();

        Log.e("wr.write", "Writing data: " + data);

    // Get the response

    Log.e("GET THE RESPONSE", "Debug 1");

    BufferedReader in = new BufferedReader(
            new InputStreamReader(
            conn.getInputStream()));

    String inputLine;

    while ((inputLine = in.readLine()) != null)
            Log.e("Uploadpath is: ", inputLine);

        in.close();

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        Log.e("get response", "CRASH");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-28T09:49:57.893

告诉我项目中是否需要包含库，以及如何生成 KEY api

# core-data - 如果我只想要一个实体的一条记录，我应该使用 Core Data

> ID：12065399
> 
> 赞同：0
> 
> 时间：2012-08-22T01:55:08.430
> 
> 标签：core-data

我是 Core Data 的新手，想知道我是否应该使用它。我希望一个实体只有一个具有一堆属性的记录。我应该使用其他东西还是 Core Data 适合这个？

例如：我有一个用户的家实体，它有一堆关于房子的属性，但我希望用户只有一个家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T14:31:13.280

您应该使您的模型类符合 NSCoding 并将其存储在 NSUserDefaults 上。使用核心数据只存储一条记录会带来核心数据堆栈的开销，而且只存储一条记录的代价很高。

# ruby-on-rails-3 - 一个模型在导轨中具有多种形式

> ID：12065400
> 
> 赞同：0
> 
> 时间：2012-08-22T01:55:36.447
> 
> 标签：ruby-on-rails-3

我遇到了一种情况，我需要两种不同的形式，一种用于“新”操作，另一种用于“编辑”操作。

目前我的新动作视图有

```
 = render 'form' 
```

但是当我尝试创建另一个表单进行编辑时

编辑动作视图

```
 = render 'form2' 
```

它不起作用它返回错误消息

ActionView::MissingTemplate in Google_categories_to_masters#edit

显示 C:/master/EDM/app/views/google_categories_to_masters/edit.html.erb 其中第 3 行提出：

缺少部分 google_categories_to_masters/form2, application/form2 with {:handlers=>[:erb, :builder, :coffee, :haml], :formats=>[:html], :locale=>[:en, :en]} . 在以下位置搜索：*“C:/master/EDM/app/views”*“C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/kaminari-0.13.0/app/views”* “C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/devise-1.4.7/app/views”

谁能教我如何在rails应用程序中做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T04:26:04.470

您可以使用一种形式进行新建和编辑。

在新

```
render 'form' 
```

并在编辑中

```
render 'form' 
```

# git - git 初始化远程仓库

> ID：12065408
> 
> 赞同：7
> 
> 时间：2012-08-22T01:57:08.710
> 
> 标签：git

我按照[这篇](http://thelucid.com/2008/12/02/git-setting-up-a-remote-repository-and-doing-an-initial-push/)文章设置了一个远程 git repo。

与其从头开始，

1.  我在我的 pc1 上做了一些开发（repo 是用 git init 创建的）
2.  现在，我想将 repo 移动到服务器（同一子网）

    `ssh git@example.com
    mkdir my_project.git
    cd my_project.git
    git init --bare`

3.  然后，在本地

    `cd my_project
    git remote add origin git@example.com:my_project.git
    git push -u origin master`

现在，在远程（服务器）存储库中，我看到了这些文件夹

> 分支配置描述 HEAD hooks info objects refs

我期待/希望看到与我的本地 (pc1) git repo 相同的内容

> bin doc src

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T02:01:48.920

您在远程端初始化了一个裸存储库。这意味着它存储了历史记录，但没有工作目录（翻译——没有实际的项目签出）。你看到的结构是正常的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T02:04:33.343

`git init --bare`意味着您创建一个**裸**存储库，而不是**工作**存储库。裸存储库通常存储在服务器上，它看起来就像您`.git`的工作 r 存储库的目录。

# php - 在 Javascript 代码中显示 PHP 数组变量

> ID：12065416
> 
> 赞同：-5
> 
> 时间：2012-08-22T01:59:05.280
> 
> 标签：php, javascript, arrays

我有一个`$usershours`包含数组的 php 变量，我想在 Javascript 代码中回显它。我怎么做？

我试过这个，但它没有用：

```
$usershours = "
data.addRow([ new Date(2012,4,1),50119]).+'<br>+'.
data.addRow([ new Date(2012,4,2),242575])";

<script type="text/javascript">
document.write($arrayholder);
</script> 
```

我希望输出是这样的：

```
data.addRow([ new Date(2012,4,1),50119]) 
data.addRow([ new Date(2012,4,2),242575]) 
```

PS - 我需要这种格式，因为这是 Google 图表 API 接受正确呈现图表的格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:16:53.947

据我所知，您希望这段代码在客户端机器上由 javascript 运行：

```
data.addRow([ new Date(2012,4,1),50119]) 
data.addRow([ new Date(2012,4,2),242575]) 
```

简单地：

```
<script type="text/javascript">
<?php 
$usershours = "
data.addRow([ new Date(2012,4,1),50119])
data.addRow([ new Date(2012,4,2),242575])";

echo $usershours;
?>
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T02:30:04.387

尽管将 PHP 与 JS 混为一谈远非最佳方法，但这也会使您的代码更加整洁。

假设您的数据来自一个数组[从数据库或文件中获取]，如下所示：

```
$data = array(
    array("date" => "2012-04-01", "id" => 50119),
    array("date" => "2012-04-02", "id" => 242575)
); 
```

通过`json_encode($data)`你得到这个输出：

```
[
  { date : "2012-04-01", id : 50119},
  { date : "2012-04-02", id : 242575}
] 
```

现在您知道如何将您的数据从 PHP 结构转换为 Javascript 结构，只需编写代码即可：

```
<script>

  var serverData = <?php echo json_encode($data) ?>;

  for(var i = 0; i < serverData.length; i++)
  {

     data.addRow([ new Date( serverData[i].date ), serverData[i].id ]);

  }

</script> 
```

当然，这`data.addRow()`是在您的 JS 代码中某处声明的函数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-22T02:11:52.590

只需使用`var arrayholder = <?php json_encode($usershours);?>;`if`arrayholder`必须输出为**字符串**（而不是代码）

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-22T02:22:00.750

一般建议：不要尝试从 PHP 呈现有效的 JavaScript。它最终会咬你，一些替代解决方案：将数据嵌入 HTML 元素并通过 JavaScript 和 Ajax 提取它

话说回来

```
?>
(function () {
   console.log(<?= json_encode($phpVar); ?>);
}());
<? 
```

当我可以在脚上射击自己时，我就是这样做的

# excel - 在 DropButtonClick 中填充组合框

> ID：12065420
> 
> 赞同：0
> 
> 时间：2012-08-22T02:00:18.927
> 
> 标签：excel, vba

我正在尝试通过在 DropButtonClick 函数中进行填充来根据需要填充组合框。举个简单的例子：

```
Private Sub cmbAdvisor_DropButtonClick()
    cmbAdvisor.Clear

    cmbAdvisor.AddItem ("Test1")
    cmbAdvisor.AddItem ("Test2")
End Sub 
```

这工作正常，值显示在下拉列表中。但是，当我单击其中一个时，下拉列表消失，组合框现在不显示任何内容/空白。我希望它能够显示我选择的项目。我猜问题是我在这个函数内部做一个 Clear - 但我还能怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-11-10T06:22:34.480

我建议不要使用该`DropButtonClick`事件。这是另一种选择（方式**1**），但如果您仍想使用`DropButtonClick`，请参阅方式**2**

**方式一**

您可以在`UserForm_Initialize()`或按钮单击事件中填充组合框。例如

```
Private Sub UserForm_Initialize()
    cmbAdvisor.AddItem ("Test1")
    cmbAdvisor.AddItem ("Test2")
End Sub 
```

或者

```
Private Sub CommandButton1_Click()
    cmbAdvisor.Clear
    cmbAdvisor.AddItem ("Test1")
    cmbAdvisor.AddItem ("Test2")
End Sub 
```

**方式二**

如果您仍想填充组合框，请`DropButtonClick`使用它

```
Private Sub cmbAdvisor_DropButtonClick()
    Dim prevPos As Long
    '~~> Get the position of current selection
    prevPos = cmbAdvisor.ListIndex

    '~~> Switch off event so that when we select an
    '~~> item, it doesn't run this proc again
    Application.EnableEvents = False

    cmbAdvisor.Clear
    cmbAdvisor.AddItem ("Test1")
    cmbAdvisor.AddItem ("Test2")

    '~~> Set the selected value
    cmbAdvisor.ListIndex = prevPos

    '~~> Reset events
    Application.EnableEvents = True
End Sub 
```

**在行动**

[![在此处输入图像描述](../Images/491982b06ccc43e61609d359e81b091f.png)](https://i.stack.imgur.com/ewQPd.gif)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:16:42.440

对于嵌入工作表的 ActiveX 控件：

activeX 组合框处理项目选择上的单击事件，就好像它是一个实际的 dropbuttonclick - 这意味着我们需要一个状态对象。

```
Dim dropbuttonclicked As Boolean

Private Sub ComboBox1_DropButtonClick()
  dropbuttonclicked = Not dropbuttonclicked
  If dropbuttonclicked = True Then
    ComboBox1.Clear
    ComboBox1.AddItem ("Test1")
    ComboBox1.AddItem ("Test2")
  End If
End Sub 
```

对于 VBA 用户窗体上的 VBA 组合框，您可能希望`Enter`改用：

```
Private Sub cmbAdvisor_Enter()
    cmbAdvisor.Clear
    cmbAdvisor.AddItem ("Test1")
    cmbAdvisor.AddItem ("Test2")
End Sub 
```

# wordpress - 限制每个作者/角色的帖子

> ID：12065424
> 
> 赞同：0
> 
> 时间：2012-08-22T02:00:31.733
> 
> 标签：wordpress

我正在尝试创建一个函数，如果该人尝试发布超过五个帖子并且还处于特定角色（s2member 1），它将杀死 Wordpress。我正在使用自定义帖子类型。

```
global $current_user; // get the current author
$userid = $current_user->ID;
$args = array(
    'post_type' => 'listing',
    'post_status' => 'publish',
    'author' => $userid
);
$the_posts = get_posts ( $args ); // get the published posts for that author
$post_count = count($the_posts); // count the number of published posts for the author
$N = 5; // set number for max posts per user
if ($post_count > $N) {
    if (current_user_is('s2member_level1')) {   
        wp_die( 'message' ); // if the number of posts is more than N, kill the current post attempt so the author can't post
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T21:10:02.823

很简单：

```
$user_post_count = count_user_posts( $user_ID ); // get total post for user
if ($user_post_count > 1) { // define number 

<your code here> // code here

} 
```

# css - Visual Studio MVC Site.css 更改未生效

> ID：12065428
> 
> 赞同：0
> 
> 时间：2012-08-22T02:00:54.900
> 
> 标签：css, asp.net-mvc, visual-studio-2010

我尝试更改 MVC 应用程序 Site.css 的一些属性，但运行它似乎无法识别这些更改，因为我没有看到它们中的任何一个生效。为什么是这样？我只是 ASP.NET MVC 项目开发的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:12:58.047

请详细说明您做了哪些更改？确保您引用的是正确版本的 site.css。还可以尝试 Ctrl + F5 替换您的缓存版本的 css。

# delphi - 将 Tobject 传递给另一种形式？

> ID：12065429
> 
> 赞同：1
> 
> 时间：2012-08-22T02:00:57.863
> 
> 标签：delphi

我正在 Delphi XE2 中编写一个启用触摸屏的应用程序。

我有一个表格`TEdits`。当我点击它们时，我调用我编写的程序来显示另一个始终在顶部最大化的表单，带有一个`TTouchkeyboard`带有标签（用于标题）和一个`TEdit`用于键盘输入的表单。

我的程序（`vkeyboard`是我的表格名称`TTouchkeyboard`）：

```
procedure TLogin.showkeyboard(numeric,password: Boolean; 
  caption,value:string;Sender:TObject);
begin
  if numeric then 
    vkeyboard.TouchKeyboard1.Layout := 'NumPad' // make the TTouchkeyboard on the form numeric or alpha
  else 
    vkeyboard.TouchKeyboard1.Layout := 'Standard';
  if password then 
    vkeyboard.input.PasswordChar := '*' //make the TEdit show * or normal characters
  else 
    vkeyboard.input.PasswordChar := #0;
  vkeyboard.title.Caption := caption;
  vkeyboard.input.Text := value;
  vkeyboard.Show;
end; 
```

我正在尝试将`Form1.Edit1`对象发送到表单`vkeyboard`，但我不知道如何正确执行！

为什么？因为我希望能够在输入表单（`vkeyboard`）上单击完成，然后追溯谁是发件人，然后更新主表单编辑中的文本！

```
procedure Tvkeyboard.sButton1Click(Sender: TObject);
begin
  (temp as TEdit).Text := input.Text; // send back the text to the right object
  vkeyboard.Hide;
end; 
```

这个小部分当然没有用......我想我需要指定临时对象属于 X 形式？

为了清楚起见，我想追溯谁调用了该程序，或者至少能够在程序中指定它，然后将文本（从第二种形式到主要形式）返回到右边`TEdit`！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:10:21.237

欢迎您将您想要的任何参数传递给您想要的任何功能。如果您需要在另一个函数中使用传递的值，则需要将其保存在某个地方，以便后面的函数仍然可以访问它。

使用您的示例，您似乎已经为您的函数提供了一个`Sender`参数。`showkeyboard`我假设这是您传递对`TEdit`触发键盘显示的控件的引用的地方。`Tvkeyboard`存储在其中的对象`vkeyboard`稍后将需要使用该值，因此将该值的副本提供给该`Tvkeyboard`对象。声明一个`TEdit`字段：

```
type
  Tvkeyboard = class(...)
    ...
  public
    EditSender: TEdit; 
```

然后，在 中`showkeyboard`，设置该字段：

```
vkeyboard.EditSender := Sender; 
```

最后，在设置文本时使用该字段：

```
procedure Tvkeyboard.sButton1Click(Sender: TObject);
begin
  EditSender.Text := input.Text; // send back the text to the right object
  Self.Hide;
end; 
```

由于您知道它将始终是一个`TEdit`控件，因此您可以更改`Sender`参数的类型`showkeyboard`以反映该特定类型：

```
procedure TLogin.showkeyboard(..., Sender: TEdit); 
```

# java - 使用 BlobKey 在 Google AppEngine 的 BlobStore 中查找 blob

> ID：12065430
> 
> 赞同：1
> 
> 时间：2012-08-22T02:01:38.953
> 
> 标签：java, google-app-engine, servlets, blobstore

我正在尝试保存然后在 GoogleAppEngine 上提供 blob。

```
// Save the data as a blob
final FileService fileService = FileServiceFactory.getFileService();
final AppEngineFile file = fileService.createNewBlobFile("application/zip", "nameOfSavedFile");
final FileWriteChannel writeChannel = fileService.openWriteChannel(file, true);
writeChannel.write(ByteBuffer.wrap(data));
writeChannel.closeFinally();

// Load the blob data
Query query = new Query("__BlobInfo__"); 
query.addFilter("filename", FilterOperator.EQUAL, "nameOfSavedFile"); 
DatastoreService datastore = DatastoreServiceFactory.getDatastoreService(); 
PreparedQuery pq = datastore.prepare(query); 
List<Entity> entList = pq.asList(FetchOptions.Builder.withLimit(1)); 
String blobKeyString = entList.get(0).getKey().getName();

BlobstoreService blobStoreService = BlobstoreServiceFactory.getBlobstoreService();
BlobKey blobKeyLoaded = new BlobKey(blobKeyString);
blobStoreService.serve(blobKeyLoaded,response); 
```

如果我运行上面的代码一次它似乎工作。但是，当我再次运行相同的代码以用同名的新文件覆盖现有文件时，它只会为旧文件提供服务。

谁能解释一下如何用新文件覆盖旧文件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T07:11:14.763

AFAIK，仅当您通过[上传处理​​程序](https://developers.google.com/appengine/docs/java/blobstore/overview#Uploading_a_Blob)`BlobInfo`上传 blob 时才会生成/更新。

如果您“手动”更改 blob，即通过`FileService`，则`BlobInfo`不会创建/更新。在这种情况下，您应该`BlobInfo`手动更新，或者根本不使用它，只需将密钥/名称存储在您的自定义实体中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:36:04.710

如果文件存储在 Blobstore 中，则无法覆盖该文件。

如果您在创建文件时使用相同的名称，则可以覆盖存储在[Google Storage中的文件。](https://developers.google.com/appengine/docs/java/blobstore/overview)

# android - 在android中暂停后台服务

> ID：12065438
> 
> 赞同：-1
> 
> 时间：2012-08-22T02:02:40.677
> 
> 标签：android, service

我正在开发一个使用服务播放媒体播放器的应用程序。该应用程序运行良好，但当我接到电话或消息时，音乐继续播放。我的要求是当我接到电话时，音乐应该暂停，通话断开时，它应该从停止的地方恢复。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:16:52.713

我不确定您是如何编写应用程序的，但这应该对您有所帮助。看看这个[如何知道被叫人拿起电话的那一刻](https://stackoverflow.com/questions/7929750/how-to-know-the-moment-when-the-called-person-picks-up-his-phone)你只需要在指定事件的 switch 语句中暂停音乐

```
TelephonyManager tm = (TelephonyManager)getSystemService(TELEPHONY_SERVICE);
tm.listen(mPhoneListener, PhoneStateListener.LISTEN_CALL_STATE);

private PhoneStateListener mPhoneListener = new PhoneStateListener() {
    public void onCallStateChanged(int state, String incomingNumber) {
        try {
            switch (state) {
            case TelephonyManager.CALL_STATE_RINGING:
                // do something...
                break;

            case TelephonyManager.CALL_STATE_OFFHOOK:
                // this state is the one you're looking for
                break;

            case TelephonyManager.CALL_STATE_IDLE:
                // do something...
                break;
            default:
                Log.d(TAG, "Unknown phone state=" + state);
            }
        } catch (RemoteException e) {}
    } 
}; 
```

编辑：这是另一个链接 [检测是否已接听拨出电话](https://stackoverflow.com/questions/2250455/detect-if-an-outgoing-call-has-been-answered)

# drupal - 如何将链接添加到drupal中的块？

> ID：12065440
> 
> 赞同：0
> 
> 时间：2012-08-22T02:02:57.783
> 
> 标签：drupal, drupal-7, drupal-modules

drupal中有主菜单，导航，管理等块，

它们都以大字母的形式显示为纯文本，但我想将它们变成链接并充当实际菜单。

是否有任何扩展可以做到这一点，或者我必须自己编写代码？

我是drupal的新手，但我不想重新发明轮子，如果它已经在某个地方提供了。

编辑：

好吧，块的标题确实是纯文本，我想把它们变成链接，或者至少隐藏它们，这些字母太大了，不合适。如果我将标签设置为''，它会显示默认单词，例如'导航'......

![在此处输入图像描述](../Images/a849ae83d0158d2c21c7062023bdaa5c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T23:04:24.520

输入`<none>`作为标题以隐藏块标题。块不是页面，因此没有必要链接到它们。如果您想从块中获得更复杂的功能，请考虑使用视图。

# ios - 仅通过 wifi 下载内容或同时使用 wifi 和 3G 网络下载

> ID：12065442
> 
> 赞同：2
> 
> 时间：2012-08-22T02:03:07.220
> 
> 标签：ios, objective-c, iphone

我正在 iOS 应用程序中实现一种方法，该方法允许用户仅通过 WiFi 下载内容或同时使用 WiFi 和 3G 网络从 Web 服务器下载内容，我的问题是如何制作可以打开和关闭以下载 WiFi 或 3G 的开关唯一的选择？就像苹果将它用于 iOS 上的 iTunes Store 内容一样，因此如果用户打开仅 wifi 选项，则内容将仅使用 wifi 网络下载。

我应该使用可达性类还是其他东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T21:39:36.757

Reachability 类可以帮助您解决这个问题。根据连接需要对其进行初始化，例如：

```
Reachability *reachability = [Reachability reachabilityWithHostName:@"www.google.com"]; 
```

您现在可以查询“currentReachabilityStatus”属性以确定您是否已连接，以及 WiFi 是否可用。

```
NetworkStatus status = reachability.currentReachabilityStatus;
switch(status)
{
    case ReachableViaWiFi:
        // There's a wifi connection, go ahead and download
        break;
    case ReachableViaWWAN:
        // There's only a cell connection, so you may or may not want to download
        break;
    case NotReachable:
        // No connection at all! Bad signal, or perhaps airplane mode?
        break;
} 
```

当然，您可以在应用程序中正确处理状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-19T15:34:12.150

此外，您可以更改`URLSessionConfiguration's`属性 `var allowsCellularAccess: Bool`

该属性变为假，不允许会话通过蜂窝加载数据

[在这里查看更多](https://developer.apple.com/documentation/foundation/urlsessionconfiguration)

# android - 去其他活动时如何明确结束活动

> ID：12065443
> 
> 赞同：-1
> 
> 时间：2012-08-22T02:03:17.063
> 
> 标签：android

`Activity`有谁知道去另一个地方时如何完全结束`Activity`？我`finish()`在活动上放了一个来终止它。但是当我按下手机的后退键或在模拟器中时，它会回到`Activity`我打开的最后一个。例如：

Activity A 是菜单，B 是订单，C 也是订单，D 是付款。

`Activity A`去`Activity B`，`Activity B`去`Activity C`，`Activity C`去`Activity D`。如果我按下手机或模拟器的返回键，当我在其中时，`Activity D`它会返回到 C、B 和 A。但正确的应该是从`Activity D`返回到`Activity A`。如果我再次按返回键，它将关闭应用程序。

任何人都知道如何清楚地结束活动？

谢谢！

我有一个不同的程序，这是我的游戏菜单。

```
public class BodyPartsGameActivity extends Activity {

    protected boolean _active = true;
    protected int _splashTime = 1000;
     public void onAttachedToWindow() {
            super.onAttachedToWindow();
            Window window = getWindow();
            window.setFormat(PixelFormat.RGBA_8888);
        }

    MediaPlayer mp1;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        StartAnimations();       
    }

        private void StartAnimations() {
            Animation anim = AnimationUtils.loadAnimation(this, R.anim.alpha);
            anim.reset();
            LinearLayout l=(LinearLayout) findViewById(R.id.mainlay);
            l.clearAnimation();
            l.startAnimation(anim);

            anim = AnimationUtils.loadAnimation(this, R.anim.clouds);
            anim.reset();
            Button iv = (Button) findViewById(R.id.cloud);
            iv.clearAnimation();
            iv.startAnimation(anim);

        mp1 = MediaPlayer.create(this,R.raw.officialbackgroundmusic);
        mp1.start();

        final MediaPlayer mp = MediaPlayer.create(this, R.raw.button);
        final Vibrator mVibrator = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);

        Button newgameButton = (Button)findViewById(R.id.newgame);
        newgameButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent newgameIntent = new Intent(BodyPartsGameActivity.this,pgone.class);
                startActivity(newgameIntent);
                    mp.start();
                    mVibrator.vibrate(500);       
            }
        });

        final MediaPlayer ms = MediaPlayer.create(this, R.raw.button);

        Button highscoresButton = (Button)findViewById(R.id.highscores);
        highscoresButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent highscoresIntent = new Intent(BodyPartsGameActivity.this,highscores.class);
                startActivity(highscoresIntent);
                 ms.start();
                 mVibrator.vibrate(500);
            }
        });

        Button instructionButton = (Button)findViewById(R.id.settings);
       instructionButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent instructionsIntent = new Intent(BodyPartsGameActivity.this,settingstwo.class);
                startActivity(instructionsIntent);
                 mp.start();
                 mVibrator.vibrate(500);
            }
        });

       Button instructionsButton = (Button)findViewById(R.id.instructions);
      instructionsButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Intent instructionsIntent = new Intent(BodyPartsGameActivity.this,instructions.class);
            startActivity(instructionsIntent);
         ms.start();
        mVibrator.vibrate(500);
        }
       });

      final ImageView mNotification_on_btn=(ImageView)findViewById(R.id.on_btn);
      final ImageView mNotification_off_btn=(ImageView)findViewById(R.id.off_btn);

          mNotification_on_btn.setOnClickListener(new OnClickListener() {
                  public void onClick(View v) {
                      mNotification_on_btn.setVisibility(View.GONE);
                      mNotification_off_btn.setVisibility(View.VISIBLE);
                  }
              });
          ImageView pausresumeButton = (ImageView)findViewById(R.id.on_btn);
         pausresumeButton.setOnClickListener(new View.OnClickListener() {
                    public void onClick(View view) {

                    if(mp1.isPlaying())
                    {
                    mp1.pause();
                    }
                    else
                    {
                    mp1.start();
                    }
                            }});

          mNotification_off_btn.setOnClickListener(new OnClickListener() {
                  public void onClick(View v) {
                      mNotification_off_btn.setVisibility(View.GONE);
                      mNotification_on_btn.setVisibility(View.VISIBLE);
                  }
              });

    }

        @Override
        protected void onPause() {
          if (this.isFinishing()){ //basically BACK was pressed from this activity
            mp1.stop();
            Toast.makeText(BodyPartsGameActivity.this, "You Pressed Back Button on Your 'HOME'  The Game was ended.  ", Toast.LENGTH_SHORT).show();
          }
          Context context = getApplicationContext();
          ActivityManager am = (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);
          List<RunningTaskInfo> taskInfo = am.getRunningTasks(1);
          if (!taskInfo.isEmpty()) {
            ComponentName topActivity = taskInfo.get(0).topActivity; 
            if (!topActivity.getPackageName().equals(context.getPackageName())) {
              mp1.stop();
              Toast.makeText(BodyPartsGameActivity.this, "YOU LEFT YOUR APP", Toast.LENGTH_SHORT).show();
            }

          }
              super.onPause();
              mp1.reset();
          }

        } 
```

这是我的说明页面：

```
public class instructions extends Activity{

    MediaPlayer mPlayer;

    protected boolean _active = true;
    protected int _splashTime = 1000;
     public void onAttachedToWindow() {
            super.onAttachedToWindow();
            Window window = getWindow();
            window.setFormat(PixelFormat.RGBA_8888);
        }

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.instructions); 
        StartAnimations();

     }

    private void StartAnimations() {
        Animation anim = AnimationUtils.loadAnimation(this, R.anim.alpha);
        anim.reset();
        LinearLayout l=(LinearLayout) findViewById(R.id.instbg);
        l.clearAnimation();
        l.startAnimation(anim);

        anim = AnimationUtils.loadAnimation(this, R.anim.controll);
        anim.reset();
        Button iv = (Button) findViewById(R.id.hwtoply);
        iv.clearAnimation();
        iv.startAnimation(anim);

        anim = AnimationUtils.loadAnimation(this, R.anim.controlll);
        anim.reset();
        Button ib = (Button) findViewById(R.id.cntrls);
        ib.clearAnimation();
        ib.startAnimation(anim);

        anim = AnimationUtils.loadAnimation(this, R.anim.controllll);
        anim.reset();
        Button ic = (Button) findViewById(R.id.trivia);
        ic.clearAnimation();
        ic.startAnimation(anim);

        anim = AnimationUtils.loadAnimation(this, R.anim.controlllll);
        anim.reset();
        Button iz = (Button) findViewById(R.id.about);
        iz.clearAnimation();
        iz.startAnimation(anim);

        Button back4Button = (Button)findViewById(R.id.back4);
        back4Button.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent back4Intent = new Intent(instructions.this,BodyPartsGameActivity.class);
                startActivity(back4Intent);
                finish();

            }
         });

        Button howtoButton = (Button)findViewById(R.id.hwtoply);
        howtoButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent howtoIntent = new Intent(instructions.this,howto.class);
                startActivity(howtoIntent);

            }
        });

        Button ctrlsButton = (Button)findViewById(R.id.cntrls);
        ctrlsButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent ctrlsIntent = new Intent(instructions.this,controls.class);
                startActivity(ctrlsIntent);

            }
        });

        Button triviaButton = (Button)findViewById(R.id.trivia);
        triviaButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent triviaIntent = new Intent(instructions.this,trivia.class);
                startActivity(triviaIntent);

            }
        });

        Button abwtButton = (Button)findViewById(R.id.about);
        abwtButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent abwtIntent = new Intent(instructions.this,about.class);
                startActivity(abwtIntent);

            }
        });

}
    @Override
    protected void onDestroy() {
        setResult(2);
        super.onDestroy();
    }
} 
```

回到菜单然后我的游戏关卡：

```
public class gamelevel extends Activity { 
    protected boolean _active = true;
    protected int _splashTime = 1000;
     public void onAttachedToWindow() {
            super.onAttachedToWindow();
            Window window = getWindow();
            window.setFormat(PixelFormat.RGBA_8888);
        }
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.gamelevel); 

        StartAnimations();   
    }
        private void StartAnimations() {
            Animation anim = AnimationUtils.loadAnimation(this, R.anim.alpha);
            anim.reset();
            LinearLayout l=(LinearLayout) findViewById(R.id.gmlvl);
            l.clearAnimation();
            l.startAnimation(anim);

            anim = AnimationUtils.loadAnimation(this, R.anim.controll);
            anim.reset();
            Button iv = (Button) findViewById(R.id.easypg);
            iv.clearAnimation();
            iv.startAnimation(anim);

            anim = AnimationUtils.loadAnimation(this, R.anim.controlll);
            anim.reset();
            Button ib = (Button) findViewById(R.id.mediumpg);
            ib.clearAnimation();
            ib.startAnimation(anim);

            anim = AnimationUtils.loadAnimation(this, R.anim.controllll);
            anim.reset();
            Button ic = (Button) findViewById(R.id.hard);
            ic.clearAnimation();
            ic.startAnimation(anim);

        Button easypButton = (Button)findViewById(R.id.easypg);
        easypButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent easypIntent = new Intent(gamelevel.this,Maingame.class);
                startActivity(easypIntent);
                finish();
            }
        });

        Button mediumButton = (Button)findViewById(R.id.mediumpg);
        mediumButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent mediumIntent = new Intent(gamelevel.this,Mediumgame.class);
                startActivity(mediumIntent);
                finish();
            }
        });

        Button hardButton = (Button)findViewById(R.id.hard);
        hardButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent hardIntent = new Intent(gamelevel.this,Hardgame.class);
                startActivity(hardIntent);
                finish();
            }
        });

        Button back1Button = (Button)findViewById(R.id.back1);
        back1Button.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                Intent back1Intent = new Intent(gamelevel.this,BodyPartsGameActivity.class);
                startActivity(back1Intent);
                finish();
            }
        });
    }
        @override
        public boolean onKeyDown(int keyCode, KeyEvent event) {
         if (keyCode == KeyEvent.KEYCODE_BACK)
            {
                moveTaskToBack(true);
                return true; // return
            }

            return false;

         }
        @Override
        protected void onDestroy() {

            super.onDestroy();
        }
       } 
```

这是我的简单游戏：

```
public class Maingame extends Activity {
    int v,x,y,z;

    public void onAttachedToWindow() {
            super.onAttachedToWindow();
            Window window = getWindow();
            window.setFormat(PixelFormat.RGBA_8888);
             displayIntentData();

////////////////////////////////score calculation/////////////////////
             initControls();
      }
      private void initControls()
      {
          amount1=(EditText)findViewById(R.id.amount1);
          amount2=(EditText)findViewById(R.id.amount2);
          amount3=(EditText)findViewById(R.id.amount3);
          result=(TextView)findViewById(R.id.result);
          calculate=(Button)findViewById(R.id.finish);
          calculate.setOnClickListener(new Button.OnClickListener()
          {public void onClick
          (View  v) { calculate();}});
      }
      private void calculate()
      {

       if(amount1.getText().toString().equals(""))
          {
          x=0;
          }
       else
          {
          x=Integer.parseInt(amount1.getText().toString());
            }

       if(amount2.getText().toString().equals("")) 
          {
          y=0; 
            }
       else
          {
          y=Integer.parseInt(amount2.getText().toString());
            }
       if(amount3.getText().toString().equals(""))
          {
          v=0;
            }
       else
          {
       v=Integer.parseInt(amount3.getText().toString());
            }

          z=x+y+v;
          result.setText(Integer.toString(z));

      ////////////////////////////////score calculation/////////////////////

                findViewById(R.id.finish).setOnClickListener(new OnClickListener() {

                    public void onClick(View v) {
                        Intent intent = new Intent(Maingame.this,score.class);
                        intent.putExtra("key",((TextView)findViewById(R.id.result)).getText().toString());
                        startActivity(intent);
                    }
                });
            }
            @Override
            protected void onNewIntent(Intent intent) {
                super.onNewIntent(intent);
                setIntent(intent);
                displayIntentData();
            }

            private void displayIntentData(){
                Intent intent = getIntent();
                TextView tv = (TextView)findViewById(R.id.intentData);
                Bundle extras=intent.getExtras();

                if(extras!=null){
                    tv.setText(" "+extras.getString("key"));
                }else{
                    tv.setText("");
                }
            }

    private Gallery gallery;

    TextView select1;
    TextView select2;
    TextView select3;

    TextView result;

     EditText amount1;
     EditText amount3;
     EditText amount2;
     EditText pauseb;

     Button calculate;

    @Override
    public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.maingame);

     Button pauseButton = (Button)findViewById(R.id.pause);
     pauseButton.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            Intent backcreIntent = new Intent(Maingame.this,pauseg.class);
            startActivity(backcreIntent);

        }
       });

    gallery = (Gallery) findViewById(R.id.examplegallery);
    gallery.setAdapter(new AddImgAdp(this));

    gallery.setOnItemClickListener(new OnItemClickListener() {

    public void onItemClick(AdapterView parent, View v, int position, long id) {

        if (position == 0 ) {
            //Toast.makeText(Maingame.this, "heart", Toast.LENGTH_SHORT).show();
             select1 = (TextView) findViewById(R.id.txt1);
              select1.setText("Head");

            amount1.setText("1000");

        } else if (position == 1) {

            select1 = (TextView) findViewById(R.id.txt1);
              select1.setText("Eye");

              amount1.setText("0");

        } else if (position == 2) {

            select1 = (TextView) findViewById(R.id.txt1);
              select1.setText("Intestine");

              amount1.setText("0");

        } else if (position == 3) {

            select2 = (TextView) findViewById(R.id.txt2);
              select2.setText("Ear");

              amount2.setText("0");

        } else if (position == 4) {

            select2 = (TextView) findViewById(R.id.txt2);
              select2.setText("liver");

              amount2.setText("0");

        } else if (position == 5) {

            select2 = (TextView) findViewById(R.id.txt2);
              select2.setText("Arm");

              amount2.setText("1000");

        } else if (position == 6) {

            select3 = (TextView) findViewById(R.id.txt3);
              select3.setText("Hand");

              amount3.setText("0");
              Toast.makeText(Maingame.this, "Click Finish To Submit Your Answer", Toast.LENGTH_LONG).show();

        } else if (position == 7) {

            select3 = (TextView) findViewById(R.id.txt3);
              select3.setText("Foot");

              amount3.setText("0");
              Toast.makeText(Maingame.this, "Click Finish To Submit Your Answer", Toast.LENGTH_LONG).show();

        } else if (position == 8) {

            select3 = (TextView) findViewById(R.id.txt3);
              select3.setText("Legs");

              amount3.setText("1000");
              Toast.makeText(Maingame.this, "Click Finish To Submit Your Answer", Toast.LENGTH_LONG).show();

        }
    }
    });

    Button clear = (Button)findViewById(R.id.clear);
    clear.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            ((TextView) findViewById(R.id.txt1)).setText("");
            ((TextView) findViewById(R.id.txt2)).setText("");
            ((TextView) findViewById(R.id.txt3)).setText("");
        }
    });

    }

    public class AddImgAdp extends BaseAdapter {
    int GalItemBg;
    private Context cont;

    // Adding images.
    private Integer[] Imgid = {
    R.drawable.head,R.drawable.eye, R.drawable.largeintestine,R.drawable.ear, R.drawable.liver, R.drawable.arm
    ,R.drawable.hand,R.drawable.foot,R.drawable.legs};

    public AddImgAdp(Context c) {
    cont = c;
    TypedArray typArray = obtainStyledAttributes(R.styleable.BodyPartsGame);
    GalItemBg = typArray.getResourceId(R.styleable.BodyPartsGame_android_galleryItemBackground, 0);
    typArray.recycle();
    }

    public int getCount() {
    return Imgid.length;
    }

    public Object getItem(int position) {
    return position;
    }

    public long getItemId(int position) {
    return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imgView = new ImageView(cont);

    imgView.setImageResource(Imgid[position]);
    // Fixing width & height for image to display
    imgView.setLayoutParams(new Gallery.LayoutParams(80, 70));
    imgView.setScaleType(ImageView.ScaleType.FIT_XY);
    imgView.setBackgroundResource(GalItemBg);

    return imgView;
    }
    }
    } 
```

当我按下手机或模拟器的后退按钮时，它会回到我打开的最后一个活动。如果我打开游戏菜单 -----> 说明 -----> 返回菜单 -----> 新游戏 ----> 游戏关卡 -----> 简单游戏，然后按返回按钮回到我最近的开放活动。

如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:07:14.100

在`Activity A`中，您应该调用`startActivity`启动`Activity B`但不应该调用`finish()`. 在`Activity B`，该去的时候`Activity C`，你应该`startActivity`以适当的意图打电话并立即打电话`finish()`。例如：

```
private void timeForActivityC() {
    Intent intent = new Intent(this, ActivityC.class);
    startActivity(intent);
    finish();
} 
```

同样适用于`Activity C`何时启动`Activity D`。然后，当您从 回去时`Activity D`，您应该会`Activity A`再次看到。

如果你认为你已经这样做了，那么请发布你的代码，因为你不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:01:01.033

您不需要在每次开始下一个活动时显式调用完成，只需将 android:noHistory="true" 设置为您要从活动堆栈中删除的那些活动。

# asp.net-mvc-3 - jqgrid：过滤后如何修复分页？

> ID：12065445
> 
> 赞同：0
> 
> 时间：2012-08-22T02:03:29.153
> 
> 标签：asp.net-mvc-3, jqgrid

我有一个索引作为我的 jqGrid 的额外搜索选项：

```
<a class="letter" href="javascript:void">C</a>

 $(".letter").click(
        function (e) {
            e.preventDefault();
            var letter = this.innerHTML;
            $.ajax({
                url: '@Url.Action("Products")',
                type:'POST',
                data: '_search=true&nd=1345531875941&rows=5&page=1&sidx=ProductID&sord=asc&filters=%7B%22groupOp%22%3A%22AND%22%2C%22rules%22%3A%5B%7B%22field%22%3A%22ProductName%22%2C%22op%22%3A%22bw%22%2C%22data%22%3A%22'+letter+ '%22%7D%5D%7D&searchField=&searchString=&searchOper=',
                success: function(data){
                    jQuery("#jqgProducts")[0].addJSONData(data);
            }
            });
        }); 
```

检索到的数据很好（以“C”开头的行），寻呼机显示：“第 1 页，共 2 页”。但是，当我想转到第二页时，它不会显示正确的数据（这将是其他以“C”开头的名称）。如何使页面显示正确的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:37:09.623

```
data: '_search=true&nd=1345531875941&rows=5&page=1&sidx=ProductID&sord=asc&filters=%7B%22groupOp%22%3A%22AND%22%2C%22rules%22%3A%5B%7B%22field%22%3A%22ProductName%22%2C%22op%22%3A%22bw%22%2C%22data%22%3A%22'+letter+ '%22%7D%5D%7D&searchField=&searchString=&searchOper=' 
```

动态传递参数 test "page=1" 到 "page=2" 或手动进行测试

手动：

```
data: '_search=true&nd=1345531875941&rows=5&page=2&sidx=ProductID&sord=asc&filters=%7B%22groupOp%22%3A%22AND%22%2C%22rules%22%3A%5B%7B%22field%22%3A%22ProductName%22%2C%22op%22%3A%22bw%22%2C%22data%22%3A%22'+letter+ '%22%7D%5D%7D&searchField=&searchString=&searchOper=' 
```

动态：

```
data: '_search=true&nd=1345531875941&rows=5&page='+anyPage+'&sidx=ProductID&sord=asc&filters=%7B%22groupOp%22%3A%22AND%22%2C%22rules%22%3A%5B%7B%22field%22%3A%22ProductName%22%2C%22op%22%3A%22bw%22%2C%22data%22%3A%22'+letter+ '%22%7D%5D%7D&searchField=&searchString=&searchOper=' 
```

# mahout - 在 mahout(taste) 中使用 GenericItemSimilarity 时如何提高内存使用率

> ID：12065446
> 
> 赞同：0
> 
> 时间：2012-08-22T02:03:32.390
> 
> 标签：mahout

众所周知，在 genericItemSimilarity 中 item1 和 item2 之间的相似性是预先计算的。

当我们使用 GenericItemBasedRecommender 获得推荐时，`the recommender need datamodel and similarity in memory at the same time`.根据 genericItemSimilarity，它提供了这样的结构

```
 public GenericItemSimilarity(ItemSimilarity otherSimilarity, DataModel dataModel) throws TasteException {
        long[] itemIDs = GenericUserSimilarity.longIteratorToList(dataModel.getItemIDs());
        initSimilarityMaps(new DataModelSimilaritiesIterator(otherSimilarity, itemIDs));
  } 
```

只需使用 dataModel 及时生成相似度图。

是否有必要将相似度图存储到 Db/file ？

我发现 mahout 0.7 有一个名为的类 `FileItemItemSimilarityIterator`可以帮助从文件中读取相似度图。

是该`FileItemItemSimilarityIterator`或`AbstractJDBCInMemoryItemSimilarity(mahout 0.5)`冗余还是无奈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T11:15:46.503

如果它们可以在运行中快速重新计算，您根本不必将相似之处放在内存中。

如果不是，我建议您简单地修剪绝对值较小的相似性。这些对计算的影响最小。

# jquery - NiceForms 下拉更改中的 jQuery 事件

> ID：12065449
> 
> 赞同：0
> 
> 时间：2012-08-22T02:03:53.677
> 
> 标签：jquery, niceforms

我使用 niceForms 来制作我的下拉菜单，下面是我的 html 中的内容

```
<select style="width:1px;" class="NFhidden" size="1" id="aics_Enquiry" name="aics_Enquiry">
    <option value="0">General enquiry</option>
    <option value="1"> Request a statement</option>
    <option value="2"> Feedback</option>
    <option value="3"> Other</option>
</select> 
```

但是当我在我的下拉项上使用 firbug 时，它也会显示以下 html，如果我在浏览器上查看它，我只是无法在我的源代码中看到它。

```
 <dd style="width:" class="relative fl">
 <div class="NFSelect" style="width: 5px; left: 767px; top: 593px; z-index: 999;"><img src="/templates/liberty/images/0.png" class="NFSelectLeft">
 <div class="NFSelectRight">Feedback</div>
 <div class="NFSelectTarget" style="display: none;">
 <ul class="NFSelectOptions">
 <li><a href="javascript:;">General enquiry</a></li>
 <li><a href="javascript:;">Request a statement</a></li>
 <li><a href="javascript:;" class="NFOptionActive">Feedback</a></li>
 <li><a href="javascript:;">Other</a></li>
 </ul>
 </div>
 </div>
 <select style="width:1px;" class="NFhidden" size="1" id="aics_Enquiry" name="aics_Enquiry">
 <option value="0">General enquiry</option>
 <option value="1"> Request a statement</option>
 <option value="2"> Feedback</option>
 <option value="3"> Other</option>
 </select>
 </dd> 
```

我的问题是，当有人将菜单更改为“反馈”下拉项时，我想触发一个 jquery 事件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:21:27.573

使用[jQuery 的](http://api.jquery.com/change/)`change()`

```
$("#aics_Enquiry").change( function(){
 if(this.value == 2){
  //TODO: implement solution
 }
}); 
```

# php - 如何在 symfony2 中有自定义访问被拒绝页面

> ID：12065454
> 
> 赞同：1
> 
> 时间：2012-08-22T02:04:33.163
> 
> 标签：php, security, symfony, jms

我正在使用 JMS 安全包来保护方法和控制器。当非特权用户访问安全页面时，我收到此错误

```
Token does not have the required roles. 
```

有什么办法，我可以制作那个自定义页面和更多定义的错误消息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T03:44:40.197

如果 JMSSecurityExtraBundle 以`403`错误的方式回答您[并且[应该](http://symfony.com/doc/current/book/security.html)]，您可以按照[Symfony 指南](http://symfony.com/doc/current/cookbook/controller/error_pages.html)自定义它。

# iphone - CALayer 不在设备上渲染背景颜色，在模拟器中工作

> ID：12065460
> 
> 赞同：3
> 
> 时间：2012-08-22T02:05:15.830
> 
> 标签：iphone, ios, core-animation, calayer, cagradientlayer

我已经从图层中创建了一个自定义按钮。我在`init`. 一切都按预期工作，直到我去修改*它们。只有在实际设备上才会出现问题，在模拟器上代码按预期工作。

我尝试通过将 needsDisplay 和 needsLayout 设置为来强制图层渲染`YES`。

```
-(void) setBackgroundColor:(UIColor *)backgroundColor
{   
    //return; // if I return here, the button gets initialized with it's default royal blue color.  This works correctly on the simulator and device

    [primaryBackground setColors: [NSArray arrayWithObject:(id)backgroundColor.CGColor]];

    //return; //if I return here, primaryBackground will display a clear background on the device, but will display CGColor on the simulator.

    CALayer* ll = [CALayer layer];
    ll.frame=self.frame;
    ll.cornerRadius=primaryBackground.cornerRadius;
    [ll setBackgroundColor:backgroundColor.CGColor];
    [primaryBackground addSublayer:ll];

     //if I return here, primaryBackground will display the "expected" results on both platforms.  IE: it dispalys the new layer, but not it's background color.
} 
```

**模拟器**

![模拟器截图](../Images/c4d038339409a1e85c47e69d64e5de25.png)

**设备**

![设备截图](../Images/275f125bd2bffc607bd7fc336afef8c0.png)

**测试**

我已经在 iOS 5.1 和 4.2 上进行了测试，结果相同。似乎在模拟器版本 4.1、4.2 和 5.1 上工作相同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T01:53:17.320

我发现您的代码至少有 2 个问题：

1.  每次更改颜色时都添加一个新图层，而不会删除旧图层。首先，删除之前创建的子图层（或者只是更改其颜色而不创建和添加新子图层）。请记住，默认`opaque`属性`CALayer`设置为`NO`，这意味着它正在与所有其他子图层混合。

    **为什么还要添加另一个子层？**在您的代码中，您完全覆盖`primaryBackground`。不能`setBackgroundColor:`像这样运行：

    ```
    - (void)setBackgroundColor:(UIColor *)backgroundColor { 
        [primaryBackground setBackgroundColor:backgroundColor.CGColor];
    } 
    ```

    ?

2.  但是如果你真的必须有一个额外的层，你应该将`ll`'s设置`frame`为`bounds`of the `superlayer`(not `frame`)。应该是`ll.frame = self.bounds`。您还应该覆盖该`- (void)layoutSubivews`方法并`frame`再次将背景层的边界设置为根层的边界。

请记住，在*iPhone Simulator*上，事物由不同的子系统渲染，并且比在真实设备上快得多。并且某些帧计算可能会重叠等。

# java - CloudFoundry 上的 MySql 经常因查询执行中断而失败；

> ID：12065461
> 
> 赞同：1
> 
> 时间：2012-08-22T02:05:23.787
> 
> 标签：java, mysql, spring, cloud-foundry

我在 Cloud Foundry 上有一个带有 MySQL 数据库的 Spring MVC 应用程序，大约有 100 万条记录。它经常会抛出 SqlExceptions 并显示消息“查询执行被中断”。似乎很快就抛出了这个异常。有谁知道是什么原因造成的以及如何解决它？附带说明一下，有没有办法为 cloudfoundry 上的 MySQL 数据库获得超过 128MB 的数据库空间？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:28:17.867

感谢您联系 cf 支持。由于您同时打开了 StackOverflow 和官方 CF 支持票，让我们更新支持票并跟踪此链接： http: [//support.cloudfoundry.com/tickets/102525](http://support.cloudfoundry.com/tickets/102525)。

谢谢，威廉

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T21:32:59.907

我从 Cloud Foundry 支持人员那里了解到，他们会终止任何耗时超过 3 秒的查询，因此唯一的解决方案是优化您的查询（或将其分解）。此外，在今年晚些时候/明年初开放付费使用之前，无法为 MySQL 数据库获得超过 128MB 的数据库空间。

# java - package com.mysql.jdbc.PreparedStatement 有什么区别；和 java.sql.PreparedStatement？

> ID：12065464
> 
> 赞同：3
> 
> 时间：2012-08-22T02:06:13.263
> 
> 标签：java, mysql, jdbc

我已经将 JAVA 应用程序与 MySql 连接起来。当我写 PreparedStatement ps = null ; 然后显示导入包的两个选项。两个建议的包是：com.mysql.jdbc.PreparedStatement; 和 java.sql.PreparedStatement 。而且，当我导入 com.mysql.jdbc.PreparedStatement 包时，他们说要进行强制转换，如下所示。

```
ps = (PreparedStatement) con.prepareStatement("INSERT INTO Authors(Name) VALUES(?)"); 
```

当我使用 java.sql.PreparedStatement 时不需要在上面的句子中进行强制转换。

所以，我的问题是：为什么显示两个不同的导入包？为什么 com.mysql.jdbc.PreparedStatement 包需要强制转换？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-22T02:09:34.583

> *为什么显示两个不同的导入包？*

因为这两个类都存在于您的编译时类路径中，并且您的 IDE 试图提供帮助。

* * *

> *为什么 com.mysql.jdbc.PreparedStatement 包需要强制转换？*

因为`prepareStatement()`是[指定](http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#prepareStatement%28java.lang.String%29)返回`java.sql.PreparedStatement`，不是`com.mysql.jdbc.PreparedStatement`。

* * *

这`java.sql.PreparedStatement`是一个**界面**，您应该一直使用它。MySQL 是一个具体的实现，您不应该将 JDBC 代码与 MySQL 特定的实现紧密耦合。否则，如果您想将 DB 服务器（以及 JDBC 驱动程序）切换到不同的供应商，如 PostgreSQL，则必须对代码进行大量更改。如果您一直使用`java.sql`包中的标准 JDBC 接口，那么您只需要更改 JDBC URL，可能还需要更改用户名和密码以及一些特定于 DB 的 SQL 语句。

### 也可以看看：

*   [我什么时候应该在java中使用接口？](https://stackoverflow.com/questions/2586389/when-best-to-use-an-interface-in-java)
*   [简单来说，什么是工厂？](https://stackoverflow.com/questions/7550612/in-simplest-terms-what-is-a-factory)

# php - 将日期插入 MySQL 时遇到问题

> ID：12065467
> 
> 赞同：0
> 
> 时间：2012-08-22T02:07:06.063
> 
> 标签：php, mysql, sql, codeigniter, activerecord

我正在尝试使用 PHP (CI) 将一些日期（给定日期、+1 天和 +1 个月）插入 MySQL。

这是我的 CI 活动记录代码：

变量`$last_period_end`返回`2012-02-20`，它试图将其插入的字段是 MySQL`DATE`格式。

```
$data = array(
            'user_id'       =>  $user_id,
            'period_start'  =>  "DATE_ADD($last_period_end, INTERVAL 1 DAY)",
            'period_end'    =>  "DATE_ADD($last_period_end, INTERVAL 1 MONTH)",
            'cost'          =>  $cost
        );

    $result = $this->db->insert('invoices', $data);

    if ( $result )
        return true;
    else
        return false; 
```

这插入`0000-00-00`而不是我想要的。

我也尝试过纯 SQL：

```
INSERT INTO betterbill.invoices (user_id, period_start, period_end, cost)
VALUES(18, DATE_ADD(2012-02-20, INTERVAL 1 DAY), DATE_ADD(2012-02-20, INTERVAL 1 MONTH), 100.05); 
```

有趣的是，这没有插入*任何内容*，而不是`0000-00-00`

任何输入表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:08:55.707

您错过了`'`日期字符串的引号。

```
$data = array(
            'user_id'       =>  $user_id,
            'period_start'  =>  "DATE_ADD('$last_period_end', INTERVAL 1 DAY)",
            'period_end'    =>  "DATE_ADD('$last_period_end', INTERVAL 1 MONTH)",
            'cost'          =>  $cost
        ); 
```

# visual-studio-2010 - 无法连接到 TFS 虽然能够访问 Web Acess

> ID：12065473
> 
> 赞同：1
> 
> 时间：2012-08-22T02:07:29.217
> 
> 标签：visual-studio-2010, tfs, tfs-web-access

我们必须通过 Internet 向客户公开我们的 Team Foundation Server。一位客户能够使用 WebAcecss (http://MyDomain:8080/tfs) 登录，但是当他启动 TeamFoundationServer 2010 以从那里连接到服务器时，它根本不起作用，他收到消息：'底层连接已关闭：连接意外关闭'。你知道这个问题的答案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:03:23.587

这似乎是一个防火墙问题。当流量通过 Fiddler 路由时，它可以工作。（我在使用 Fiddler 了解发生了什么时意外发现了它）。这些是解决我遇到的此类问题的 2 篇有趣的文章：

[https://serverfault.com/questions/397999/team-foundation-server-an-existing-connection-was-forcibly-closed-by-the-remote](https://serverfault.com/questions/397999/team-foundation-server-an-existing-connection-was-forcibly-closed-by-the-remote)

[http://computech.in/2011/02/the-underlying-connection-was-closed-the-connection-was-closed-unexpectedly-team-foundation-server-does-not-exist-or-is-not-可访问的绕过代理为团队基金会服务器/](http://computech.in/2011/02/the-underlying-connection-was-closed-the-connection-was-closed-unexpectedly-team-foundation-server-does-not-exist-or-is-not-accessible-bypass-proxy-for-team-foundation-server/)

# deployment - 创建一个 Web 安装程序 msi 包，它在安装时读取配置文件

> ID：12065475
> 
> 赞同：0
> 
> 时间：2012-08-22T02:07:40.793
> 
> 标签：deployment, windows-installer

我需要创建一个 msi 包，它从配置文件（设置）中读取并安装该包。

请帮助我如何创建一个在安装时读取配置文件的 msi 包。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:49:14.363

您可以像这样传递自定义参数：

```
setup.msi /qb /l* log.txt WebSiteName=one PoolName=two 
```

如果您使用 Visual Studio 创建安装程序包，那么[这将](http://www.codeproject.com/Articles/16767/How-to-Pass-Command-Line-Arguments-to-MSI-Installe)显示如何将参数传递给自定义安装操作。

[Visual Studio 设置 - 项目和自定义操作 ](http://www.simple-talk.com/dotnet/visual-studio/visual-studio-setup---projects-and-custom-actions/)

# ruby-on-rails - 我将如何测试参数在 RSpec 控制器测试中被修改？

> ID：12065477
> 
> 赞同：0
> 
> 时间：2012-08-22T02:08:35.717
> 
> 标签：ruby-on-rails, rspec, rspec-rails

我通过修改参数而不是在表单中创建 hidden_​​field 来设置用户。据我了解，这是一种更安全的批量分配方式。

```
 def update
    @exercise = Exercise.find(params[:id])

    #this is the important part
    if params[:exercise][:log_entries_attributes].present?
      params[:exercise][:log_entries_attributes].each do |value|
        value[1].merge!(:user_id => current_user.id)
      end
    end
    #end the important part

    respond_to do |format|
      if @exercise.update_attributes(params[:exercise])
        format.html { redirect_to_back_or_default @exercise, notice: "Exercise was successfully updated." }
        format.mobile { redirect_to @exercise, notice: 'Exercise was successfully updated.' }
        format.json { head :ok }
      else
        format.html { render action: "edit" }
        format.mobile { redirect_to @exercise, notice: "#{@exercise.errors.full_messages.to_sentence}" }
        format.json { render json: @exercise.errors, status: :unprocessable_entity }
      end
    end
  end 
```

在我的规范中，我有以下内容：

```
describe "with log_entry_attributes" do
  it "updates log_entries_attributes and sets user" do
    exercise = FactoryGirl.create(:exercise)
    log_entry = FactoryGirl.build(:log_entry)
    exercise.log_entries << log_entry
    exercise.save
    controller.stub(:current_user).and_return(@user)
    put :update, :id => exercise.id, :exercise => FactoryGirl.build(:exercise, "log_entries_attributes" => {":0" => {"reps" => "5", "weight" => "5"}}).attributes.symbolize_keys
    assigns(:exercise).log_entries.first.user.should eq(@user)
  end
end 
```

我明白了`undefined method user for nil:NilClass`。我想我知道为什么我会得到未定义的方法用户。只是没有办法通过分配获得关联。我不确定如何测试 user_id 是否通过 current_user 正确设置。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T09:28:50.300

使用模拟对象：

```
exercise = double "exercise"
Exercise.should_receive(:find).and_return(exercise) 
```

并测试：

```
exercise.should_receive(:update_attributes).with(correct_params) 
```

# ios - 推送视图时如何在导航栏中重用uibarbutton

> ID：12065478
> 
> 赞同：0
> 
> 时间：2012-08-22T02:08:45.667
> 
> 标签：ios, uinavigationcontroller

当您希望在推送和弹出视图时相同的按钮（及其功能）出现在导航控制器的导航栏中时，最好的方法是什么。例如，在我的应用程序中，无论当前位于堆栈顶部的视图如何，我都希望导航栏中显示一个“用户设置”按钮。当点击按钮时，会出现一个弹出窗口，其中显示特定设置的列表。我是否必须为可以出现在堆栈中的每个视图设置此功能？或者有没有办法设置一次并允许它出现在堆栈中的所有视图中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:15:10.007

我认为最简单的方法是继承 UIViewController。让所有需要具有此行为的视图都从子类继承。

# javascript - 如何等待javascript函数响应？

> ID：12065479
> 
> 赞同：2
> 
> 时间：2012-08-22T02:08:46.697
> 
> 标签：javascript, facebook, function, wait

我正在使用 facebook API 制作网页。
我想在网页中显示用户的朋友。
所以我这样编码

```
function showFriends(){
    var result = getFriends();
    for(var i=0; i<result.length; i++){
        //show friends in webpage
    }
}

function getFriends(){
    FB.api( {
    method: 'fql.query', 
    query: 'SELECT uid, name, pic_square  FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me())'}, 
    function(response) {
    return response;
        }
    );
} 
```

问题是这样的：getFriends 函数需要一点时间，所以在得到 getFriends 的响应之前 for 循环过程。而且我不想在 getFriends 函数中定位 for 循环，因为 getFriends 函数将在许多其他函数中使用。

那么等待函数的响应有什么解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T02:12:32.540

将`showFriends`函数作为回调传递。

```
function showFriends(result){
    for(var i=0; i<result.length; i++){
        //show friends in webpage
    }
}

function getFriends(callback){
    FB.api({
      method: 'fql.query', 
      query: 'SELECT uid, name, pic_square  FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me())'
    }, 
    callback
  );
}

getFriends(showFriends); 
```

# ruby-on-rails - 将正则表达式作为参数传递给 ruby

> ID：12065480
> 
> 赞同：0
> 
> 时间：2012-08-22T02:08:49.400
> 
> 标签：ruby-on-rails, ruby, regex, view, params

所以我想在我的模型中的一个字段上公开正则表达式查询，以便用户可以要求

```
http://localhost:3000/myview.json?field=^hello, (there|world).* 
```

所以我知道我必须改变我的路线来识别通配符等，我可以很容易地`Regexp.new()`在我的控制器内部将它转换为一个真正的正则表达式（我在后面使用 mongomapper）。

问题是 XSS 潜在的巨大安全漏洞。

我应该担心这个吗？我怎样才能安全地使用户能够使用正则表达式字符串进行查询。

（我不太担心用户敲击数据库......但是）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T04:08:18.847

正则表达式将无法执行任意代码执行，除非`Regexp.new`. 因此，如果我们假设它`Regexp.new`要么生成一个有效的正则表达式，要么失败，或者做一些其他理智的事情，那么你就已经安全了，而不必清理传入的字符串。

# iphone - 如何将 UITableViewCell 从“正常”视图切换为透明，然后再返回

> ID：12065483
> 
> 赞同：0
> 
> 时间：2012-08-22T02:09:07.357
> 
> 标签：iphone, ios, uitableview

我有一个表格视图，可以在视图模式和编辑模式之间来回切换。我有一个单元格，我希望它在视图模式下是透明的，并且在编辑模式下看起来像一个“正常”单元格（即白色背景，圆角矩形轮廓）。基本上，当您进入和退出编辑模式时，您在联系人应用程序中看到名称单元格所做的事情是一样的。

我使用了[如何创建具有透明背景的 UITableViewCell](https://stackoverflow.com/questions/1008246/how-to-create-a-uitableviewcell-with-a-transparent-background)中的解决方案来获得透明背景，但我不知道如何恢复原始背景。

目前，我在 viewDidLoad 中创建了两个背景视图：

```
nameCellDefaultBackview = [[UIView alloc] initWithFrame:CGRectZero];
nameCellDefaultBackview.backgroundColor = [UIColor clearColor];

nameCellEditBackview = [[UIView alloc] initWithFrame:CGRectZero];
nameCellEditBackview.backgroundColor = [UIColor whiteColor]; 
```

然后我给我的单元格默认的背景视图：

```
nameCell.backgroundView = nameCellDefaultBackview; 
```

在 setEditing:animated: 我根据编辑模式设置单元格的背景：

```
if (editing) {
    nameCell.backgroundView = nameCellEditBackview;
} else {
    nameCell.backgroundView = nameCellDefaultBackview;
} 
```

问题是，在编辑模式下，我得到一个白色矩形而不是看起来像一个单元格的东西——这正是我所要求的，但不是我想要的:)。我尝试了其他一些事情，比如将 backgroundView 设置为 nil（这似乎 = 没有变化），并将“初始”背景视图保存在 viewDidLoad 中（这似乎不起作用，并在调试器中查看变量当我尝试将其分配给 setEditing 中的单元格时为 0x0）。

所以我想要的是在正常模式下看起来像这样：

![正常模式](../Images/9bb25714507b4fcdbcd0cd58377a2ee9.png)

在编辑模式下就像这样：

![编辑模式](../Images/9e02b6bb5a0c2084cfc1dcf437f1d216.png)

但我*目前*在编辑模式下得到的是：

![当前编辑视图](../Images/1313658499ad6fee50a7db5f480a3761.png)

那么我如何获得白色背景/边框/圆角呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:25:02.077

如果您想在编辑模式下使用原始单元格，您应该考虑显示和隐藏单元格，而不是设置背景视图。背景视图被添加为所有其他视图后面的子视图，因此，将其设置为透明无效。参考：[苹果文档](https://stackoverflow.com/questions/8121786/how-do-i-hide-a-uitableviewcell-please-see-the-screenshot)。

要隐藏或显示表格单元格，请参阅此[帖子](https://stackoverflow.com/questions/7545337/hiding-uitableviewcells-when-entering-edit-mode-in-uitableviewcell-similar-to-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T04:15:34.283

对于编辑模式，不要设置 backgroundView。`[tableView reloadData]`进入编辑模式时调用并设置 backgroundView`cellForRowAtIndexPath`如下：

```
if (!editing) {
    nameCell.backgroundView = nameCellDefaultBackview;
}
//if it is editing, then it will take the default style. 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T16:29:06.343

我决定稍微改变一下我的方法，现在它正在起作用：

我现在有两个单元格，而不是试图显示/隐藏一个单元格的背景：

```
IBOutlet UITableViewCell *nameCellViewMode;
IBOutlet UITableViewCell *nameCellEditMode; 
```

在 viewDidLoad: 我更改了 nameCellViewMode 的背景以使其透明：

```
UIView *clearBackgroundView = [[UIView alloc] initWithFrame:CGRectZero];
clearBackgroundView.backgroundColor = [UIColor clearColor];

nameCellViewMode.backgroundView = clearBackgroundView; 
```

按照 KDaker 的建议，我现在只需在 setEditing:animated: 中执行 tableView reloadData，然后在 cellForRowAtIndexPath 中执行此操作：

```
if (self.editing)
{
   return nameCellEditMode;
}
else
{
   return nameCellViewMode;
} 
```

# c++ - 如何引用类的静态私有对象？

> ID：12065484
> 
> 赞同：0
> 
> 时间：2012-08-22T02:09:08.607
> 
> 标签：c++, static, refer

这是上下文：

我有一个应该说“嗨”的 A 类，但由于 A 不知道说话，它使用 B 类的对象为他说话。由于 A 持有 B 的唯一目的是为 B 说话，所以有不需要每个 A 都拥有自己的 B 对象；因此，我选择为此使用唯一的静态私有 B。

像这样：

```
class A {
    static B b;
public:
    void sayHi();
};

void A::sayHi()
{
    b.sayHi();
} 
```

B 是这样的：

```
class B {
public:
    void sayHi();
};

void B::sayHi() 
{
    std::cout << "Hi!" << std::endl;
} 
```

问题是当我尝试用 g++ 编译器编译这段代码时......

```
int main() {
    A a;
    a.sayHi();
    return 0;
} 
```

我收到“未定义的引用”错误。我不确定为什么这不起作用，我想知道编译器认为我指的是 A 中的非静态 B，但我不知道它应该如何。

PS：在我的代码中，B 的声明在 A 的声明之前。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T02:11:52.910

您需要在代码中的某处实际创建静态对象。你所做的只是说班级有一个。将此添加到`.cpp`文件中：

```
B A::b; 
```

这假定对象应该是默认构造的。

# facebook - 使用 Facebook 进行身份验证的网站的 REST API

> ID：12065492
> 
> 赞同：86
> 
> 时间：2012-08-22T02:09:48.267
> 
> 标签：facebook, rest, authentication, openid, facebook-authentication

我们有一个网站，在该网站上登录和验证自己的*唯一*方法是使用 Facebook（这不是我的选择）。首次登录 Facebook 时，系统会自动为您创建一个帐户。

我们现在想为我们的网站创建一个 iPhone 应用程序，并为其他人创建一个公共 API 以使用我们的服务。

这个问题是关于如何通过应用程序/API 对我们的网站进行身份验证，分为两部分：

1.  处理从 API 到仅使用 Facebook OAuth 作为身份验证方法的网站的 REST 身份验证的正确方法是什么？

我已经阅读并研究了很多关于 REST API 的标准身份验证方法。我们不能使用诸如[Basic Auth over HTTPS](https://stackoverflow.com/questions/7919533/rest-api-authentication-tokens)之类的方法，因为这样的用户没有凭据。像[这样](http://acaasia.blogspot.com/2013/04/designing-secure-rest-web-api-without.html)的东西似乎只用于使用 API 验证应用程序。

目前，我能想到的最好方法是在我们的 API 上点击 /authorize 端点，它重定向到 Facebook OAuth，然后重定向回站点并提供 API 用户可以用来验证后续身份的“令牌”要求。

2.  对于我们创建的官方应用程序，我们不一定需要以相同的方式使用公共 API。那么与我们的网站交谈并验证用户身份的最佳方式是什么？

我了解（我认为）如何使用 API（公共）密钥和秘密（私有）密钥来验证使用我们 API 的第 3 方应用程序。但是，当涉及到对使用该应用程序的用户进行身份验证时，当我们必须对用户进行身份验证的唯一方法是 Facebook 时，我对如何去做感到相当困惑。

我觉得我遗漏了一些非常明显的东西，或者不完全理解公共 REST API 应该如何工作，所以任何建议和帮助将不胜感激。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-11-18T20:55:05.747

## 更新：见下文

我也一直在认真思考这个问题。我还不完全清楚，但这是我正在考虑的路线。我正在创建一个 REST API，我的用户*仅*通过 Facebook 连接进行身份验证。

在客户端：

1.  使用 Facebook API 登录并获取 OAUTH2 代码。
2.  将此代码交换为访问令牌。
3.  在每次调用我的自定义 API 时，我都会包含 Facebook 用户 ID 和访问令牌。

在 API 上（对于需要用户身份验证的每个方法）：

1.  使用上面的访问令牌向 /me Facebook 图发出请求。
2.  验证返回的 Facebook 用户 ID 是否与从上面传递给我的 API 的用户 ID 匹配。
3.  如果访问令牌已过期，则需要额外的通信。

我还没有对此进行测试。听起来怎么样？

## --- 更新：2014 年 7 月 27 日回答问题 ---

我只在登录时使用上述交换一次。一旦我确定了哪个用户正在登录，我就会创建自己的访问令牌，并且从那时起使用该令牌。所以新的流程看起来像这样......

在客户端：

1.  使用 Facebook API 登录并获取 OAUTH2 代码。
2.  将此代码交换为访问令牌。
3.  *从我的*API请求访问令牌，包括 Facebook 令牌作为参数

在 API 上

1.  接收访问令牌请求。
2.  使用 facebook 访问令牌向 /me Facebook 图发出请求
3.  验证 Facebook 用户是否存在并与我的数据库中的用户匹配
4.  创建我自己的访问令牌，保存它并将其返回给客户端，以便从现在开始使用

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-05-22T18:17:36.810

这是我使用 JWT（JSON Web 令牌）的实现，基本上类似于 Chris 的更新答案。我使用过 Facebook JS SDK 和 JWT。

这是我的实现。

1.  **客户端：**使用 Facebook JS SDK 登录并获取访问令牌。

2.  **客户端：**通过调用`/verify-access-token`端点从我的 API 请求 JWT。

3.  **MyAPI：**接收访问令牌，通过调用`/me`Facebook API 的端点进行验证。

4.  **MyAPI：**如果访问令牌有效，则从数据库中查找用户，如果存在则登录该用户。创建一个包含必填字段作为有效负载的 JWT，设置过期时间，使用密钥签名并发送回客户端。

5.  **客户端：**将 JWT 存储在本地存储中。

6.  **客户端：**发送令牌（来自步骤 5 的 JWT）以及对下一个 API 调用的请求。

7.  **MyAPI：**使用密钥验证令牌，如果令牌有效，则将令牌交换为新令牌，并将其与 API 响应一起发送回客户端。（之后没有外部 API 调用验证令牌）[如果令牌无效/过期，请求客户端再次进行身份验证并从 1 开始重复]

8.  **客户端**将存储的令牌替换为新令牌并将其用于下一次 API 调用。一旦令牌到期，令牌到期撤销对 API 的访问。

每个令牌都使用一次。

阅读有关安全性和 JWT 的更多答案

[JWT 的安全性如何](https://stackoverflow.com/questions/37041699/how-secure-is-jwt)

[如果您可以解码 JWT，它们的安全性如何？](https://stackoverflow.com/questions/27301557/if-you-can-decode-jwt-how-are-they-secure)

[JSON Web 令牌 (JWT) 作为用户标识和身份验证令牌](https://security.stackexchange.com/questions/51294/json-web-tokens-jwt-as-user-identification-and-authentication-tokens)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-03T17:38:40.583

我正在尝试回答同样的问题，并且最近阅读了很多内容...

我不会有“答案”，但对我来说事情变得更清楚了。您是否阅读了[您提到的文章中](http://www.thebuzzmedia.com/designing-a-secure-rest-api-without-oauth-authentication/)的评论？我发现它们真的很有趣也很有帮助。

因此，鉴于自第一篇文章写完以来事情的发展情况，我认为我会做以下事情：

*   HTTPS 无处不在——这让你忘记了 HMAC、签名、nonce，......

*   使用 OAuth2：

    *   当身份验证请求来自我自己的应用程序/网站时，请使用前面提到[的文章的回复中描述的这个“技巧”（或其变体）。](http://ahmetalpbalkan.com/blog/designing-a-secure-rest-api-with-oauth2-you-can-be-proud-of/)

    *   就我而言，我有两种类型的用户：具有经典登录/密码凭据的用户和使用 Facebook Connect 注册的用户。
        所以我会提供一个带有“用 Facebook 登录”按钮的常规登录表单。如果用户使用他的“经典”凭据登录，我只需将这些凭据发送到我的 OAuth2 端点并使用`grant_type=password`.
        如果他选择通过 Facebook 登录，我认为这将是一个两步过程：

        *   一、使用Facebook iOS SDK打开一个FBSession
        *   完成后，应用程序重新获得控制权，应该有一种方法可以为该用户获取 Facebook ID。我会单独将此 ID 发送到我的 OAuth2 端点，并带有我的服务器理解为“使用 FB 用户 ID”的[扩展授权。](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-30#section-4.5)

请注意，我仍在对所有这些东西进行大量研究，所以这可能不是一个完美的答案……甚至可能不是一个正确的答案！但我认为这将是一个很好的起点。为 Facebook 身份验证使用“扩展授权”的想法可能涉及必须注册它才能正确执行操作？我不太确定。

无论如何，我希望我能对你有所帮助，至少它可以开始讨论以找到解决这个问题的最佳方法:)

**更新**
Facebook 登录不是评论中指出的解决方案：任何人都可以发送任意用户 ID 并在 API 上以该用户身份登录。

这样做怎么样：

*   显示带有“Facebook 登录”按钮的登录表单
*   如果选择了这种登录方法，则有点像 Facebook SDK：从您的身份验证服务器打开一个网页，这将启动 Facebook 登录。
*   用户登录后，Facebook 将使用您的重定向 URL 进行确认；使该 URL 指向您的身份验证服务器的另一个端点（可能带有指示调用来自应用程序的额外参数？）
*   当身份验证端点被命中时，身份验证可以安全地识别用户，保留其 FB 用户 ID/FB 会话并使用自定义 URL 方案将访问令牌返回到您的应用程序，就像 Facebook SDK 所做的那样

看起来更好？

# iphone - 在 iPhone 上拨打电话并将用户带回应用程序？（UIWebView 做到了）

> ID：12065498
> 
> 赞同：2
> 
> 时间：2012-08-22T02:11:08.163
> 
> 标签：iphone, objective-c, ios, deep-linking

我使用此代码拨打电话：

```
NSString *phoneNumber = [@"tel://" stringByAppendingString:mymobileNO.titleLabel.text];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:phoneNumber]]; 
```

当通话结束时，它不会将用户带回应用程序。但是，如果我在 UIWebView 中显示一个网站并且该网站中有一个电话号码（即 UIWebView 识别它），并且如果我点击该电话号码链接拨打电话，我将在通话结束时返回应用程序.

我的初步想法是 UIWebView 在内部做一些事情，比如一个到电话应用程序的深层链接，然后在深层链接中另一个深层链接将用户带回应用程序。但我不确定。有没有办法实现这个功能？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T02:18:02.503

您需要使用`telprompt`URL，而不是`tel`.

所以：

```
NSString *phoneNumber = [@"telprompt://" stringByAppendingString:mymobileNO.titleLabel.text];
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:phoneNumber]]; 
```

这还将在拨打该号码之前为用户提供一个确认框。

编辑：

[这个](https://stackoverflow.com/questions/5456395/dial-a-phone-number-using-ios)问题涵盖了同样的问题。

**编辑2：**

对于那些想知道这个 URL 是否会导致 App Store 拒绝的人，答案通常是否定的。更大的风险是苹果会突然停止支持该`telprompt`计划。正如[这篇文章](http://www.raizlabs.com/dev/2014/04/getting-the-best-behavior-from-phone-call-requests-using-tel-in-an-ios-app/)所解释的，有一种稍微“更安全”的实现方式`telprompt`with `UIWebView`（它在`telprompt`内部使用，即使你用 调用它`tel`）。文章中的相关代码显示了如何使用记录的`tel`方案仍然可以给您带来以下效果`telprompt`：

```
+ (void)callWithString:(NSString *)phoneString {
    [self callWithURL:[NSURL URLWithString:[NSString     
        stringWithFormat:@"tel:%@",phoneString]]];
}

+ (void)callWithURL:(NSURL *)url {
    static UIWebView *webView = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{  
        webView = [UIWebView new];
    });
    [webView loadRequest:[NSURLRequest requestWithURL:url]];
} 
```

（代码取自我第二次编辑中的文章参考）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-08T17:08:55.880

网站：[http](http://www.raizlabs.com/dev/2014/04/getting-the-best-behavior-from-phone-call-requests-using-tel-in-an-ios-app/) ://www.raizlabs.com/dev/2014/04/getting-the-best-behavior-from-phone-call-requests-using-tel-in-an-ios-app/有讨论是否使用 telprompt（未记录，Apple 可能会在不通知的情况下更改 API），而是使用将数字发送到使用 telprompt 打开它的 Web 视图的类别。如果 Apple 做了一些奇怪的事情，这具有不会破坏的优点。

# svn - SVN Checkout 无需重新复制

> ID：12065500
> 
> 赞同：0
> 
> 时间：2012-08-22T02:11:26.367
> 
> 标签：svn, tortoisesvn, visualsvn

我已经将一个未版本控制的目录导入到一个空的 SVN 存储库中，然后希望对同一个目录进行版本控制，但是有很多文件并且 Checkout 需要很长时间。有没有办法将当前文件集设置为等于存储库中的当前版本或一些类似的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T02:13:12.357

我找到了一种方法：创建一个空存储库，然后将其检出到现有文件的文件夹中——不会添加或删除任何内容——然后提交文件。还有一个提示：如果可以，请使用 SVN 协议而不是 HTTP/S，因为它更快

# objective-c - 使用 Xcode 4.4 在 Objective C 中换行

> ID：12065501
> 
> 赞同：0
> 
> 时间：2012-08-22T02:11:27.827
> 
> 标签：objective-c, c, xcode, escaping, nslog

除了我之外，还有没有人遇到过 /n 没有在输出字符串中生成新行的问题？这是一个入门程序，取自 Stephen Kochan 的“Objective C 编程”第四版。代码运行没有错误，但打印 /n 而不是推进与文本相反的行。我需要查看 Xcode 对话框设置吗？

谢谢，

迈克尔

```
//  First programming example

#import <'Foundation/Foundation.h>

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        // insert code here...
        NSLog(@"Testing..../n....1/n....2/n....3");
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T02:13:33.167

Objective-C（以及许多其他编程语言......）中的换行符`\n`不是`/n`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T02:19:43.393

转义字符是当您使用反斜杠而不是正斜杠时，换行是：`\n`并且回车是`\r`

`/n`只是……好吧“/n”

# c++ - 根据一些输入文件预测“随机”文本生成中的下一个字符

> ID：12065503
> 
> 赞同：0
> 
> 时间：2012-08-22T02:11:42.247
> 
> 标签：c++, nlp

我正在编写一个基于马尔可夫模型生成随机文本的程序。我遇到了一个问题，有些文件在单词之间有很多空格，最初的种子被认为是一个空格。**问题是所有下一个字符也被视为空格，因此生成的随机文本只是一个空白文档，因为 nextChosenChar 始终是一个空格。**

有人可以提出一些解决这个问题的方法吗？

我试图提出一个解决方案，如下面代码的后半部分所示，但无济于事。

```
char ChooseNextChar(string seed, int order, string fileName){
    Map<string, Vector<char> > nextCharMap;
    ifstream inputStream;
    inputStream.open(fileName.c_str());
    int offset = 0;
    Vector<char> charsFollingSeedVector;
    inputStream.clear();
    char* buffer = new char [order + 1];
    char charFollowingSeed;
    static int consecutiveSpaces = 0;
    while (!inputStream.eof()) {    
        inputStream.seekg(offset);
        inputStream.read(buffer, order + 1);
        string key(buffer, order);
        if (equalsIgnoreCase(key, seed)) {
            //only insert key if not present otherwise overwriting old info 
            if (!nextCharMap.containsKey(seed)) {
                nextCharMap.put(seed, charsFollingSeedVector);
            }
            //read the char directly following seed
            charFollowingSeed = buffer[order];
            nextCharMap[seed].push_back(charFollowingSeed);
        }
        offset++;
    }
    //case where no chars following seed
    if (nextCharMap[seed].isEmpty()) {
        return EOF;
    }
    //determine which is the most frequent following char
    char nextChosenChar = MostFequentCharInVector(seed, nextCharMap);

    //TRYING TO FIX PROBLEM OF ONLY OUTPUTTING SPACES**********
     if (nextChosenChar == ' ') {
        consecutiveSpaces++;
        if (consecutiveSpaces >= 1) {
            nextChosenChar = nextCharMap[seed].get(randomInteger(0, nextCharMap[seed].size()-1));
            consecutiveSpaces = 0;
        }
    }
    return nextChosenChar;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T04:05:19.017

如果你真的想要一个基于字符的模型，你不会得到看起来很自然的文本作为输出，但这绝对是可能的，并且该模型从根本上也能够处理空格字符序列。如果您认为它们是文本的自然部分，则无需从输入中删除它们。

重要的是，马尔可夫模型并不总是回退到预测在任何给定阶段具有最高概率的一个字符。相反，它必须查看可能字符的整个概率分布，并随机选择一个。

在这里，*随机*意味着它选择了一个不是程序员预先确定的字符。尽管如此，随机分布并不是均匀分布，即并非所有字符的可能性都相同。它必须考虑各种可能字符的**相对概率。**一种方法是生成字符的累积概率分布，例如，如果概率是

```
p('a') == 0.2
p('b') == 0.4
p('c') == 0.4 
```

我们将它们表示为

```
p('a') == 0.2
p('b') == p('a') + 0.4 == 0.6
p('c') == p('a') + p('b') == 1.0 
```

那么生成一个随机字符，我们首先生成一个在0到1之间均匀分布的随机数N，然后选择第一个累积概率不小于N的字符。

我已经在下面的示例代码中实现了这一点。该`train()`过程为训练输入中的每个字符生成后续字符的累积概率分布。'predict()' 过程应用它来生成随机文本。

对于完整的实现，这仍然缺乏：

*   初始字符的概率分布的表示。正如您在“main()”函数中看到的，我的输出总是以“t”开头。
*   输出字符串长度或最终字符的表示。'main()' 总是生成一个长度为 100 的字符串。

该代码在 Linux 上使用 GCC 4.7.0（C++11 选项）进行了测试。下面的示例输出。

```
#include <iostream>
#include <string>
#include <vector>
#include <utility>
#include <map>
#include <numeric>
#include <algorithm>
#include <random>

template <typename Char>
class Markov
{
public:
  /* Data type used to count the frequencies (integer!) of
     characters. */
  typedef std::map<Char,unsigned>            CharDistributionMap;

  /* Data type used to represent a cumulative probability (float!)
     distribution. */
  typedef std::vector<std::pair<Char,float>> CharDistribution;

  /* Data type used to represent the Markov model. Each character is
     mapped to a probality distribution of the characters that follow
     it. */
  typedef std::map<Char,CharDistribution>    MarkovModel;

  /* The model. */
  MarkovModel  _model;

  /* Training procedure. */
  template <typename Iterator>
  void train(Iterator from, Iterator to)
  {
    _model = {};
    if (from == to)
      return;

    std::map<Char,CharDistributionMap> proto_model {};

    /* Count frequencies. */
    Char current = *from;
    while (true) {
      ++from;
      if (from == to)
        break;
      Char next = *from;
      proto_model[current][next] += 1;
      current = next;
    }

    /* Transform into probability distribution. */
    for (const auto &entry : proto_model) {
      const Char current              = entry.first;
      const CharDistributionMap &freq = entry.second;

      /* Calculate total frequency of current character. */
      unsigned total =
         std::accumulate(std::begin(freq),std::end(freq),0,
           [](unsigned res,const std::pair<Char,unsigned> &p){
                   return res += p.second;
               });

      /* Determine the probability distribution of characters that
         follow the current character. This is calculated as a cumulative
         probability. */
      CharDistribution dist {};
      float probability { 0.0 };
      std::for_each(std::begin(freq),std::end(freq),
             [total,&probability,&dist](const std::pair<Char,unsigned> &p){
                   // using '+=' to get cumulative probability:
                   probability += static_cast<float>(p.second) / total; 
                   dist.push_back(std::make_pair(p.first,probability));
             });

      /* Add probability distribution for current character to the model. */
      _model[current] = dist;
    }
  }

  /* Predict the next character, assuming that training has been
     performed. */
  template <typename RandomNumberGenerator>
  Char predict(RandomNumberGenerator &gen, const Char current)
  {
    static std::uniform_real_distribution<float> generator_dist { 0, 1 };

    /* Assume that the current character is known to the model. Otherwise,
       an std::out_of_range exception will be thrown. */
    const CharDistribution &dist { _model.at(current) };

    /* Generate random number between 0 and 1\. */
    float random { generator_dist(gen) };

    /* Identify the character that has the greatest cumulative probabilty
       smaller than the random number generated. */
    auto res =
         std::lower_bound(std::begin(dist),std::end(dist),
                          std::make_pair(Char(),random),
             [](const std::pair<Char,float> &p1, const std::pair<Char,float> &p2) {
                    return (p1.second < p2.second);
             });
    if (res == std::end(dist))
      throw "Empty probability distribution. This should not happen.";
    return res->first;
  }

};

int main()
{
  /* Initialize random-number generator. */
  std::random_device rd;
  std::mt19937 gen(rd());

  std::string input { "this   is    some   input text   with   many spaces." };

  if (input.empty())
    return 1;

  /* We append the first character to the end, to ensure that even the
     last character of the text gets a non-empty probability
     distribution. A more proper way of dealing with character that
     have empty distributions would be _smoothing_. */
  input += input[0];

  Markov<char> markov {};
  markov.train(std::begin(input),std::end(input));

  /* We set the initial character. In a real stochastic model, there
     would have to be a separate probality distribution for initial
     character and we would choose the initial character randomly,
     too. */
  char current_char { 't' };

  for (unsigned i = 0 ; i < 100 ; ++i) {
    std::cout << current_char;
    current_char = markov.predict(gen,current_char);
  }
  std::cout << current_char << std::endl;
} 
```

该程序生成的一些示例输出：

```
t  mext s.t th   winy  iny  somaces      sputhis inpacexthispace te  iny            me   mext mexthis

tes    is  manputhis.th is  wis.th with it    is  is.t  s   t   winy    it mext    is        ispany

this  maces      somany  t    s        it this  winy sputhisomacext manput    somanputes  macexte iso

t   wispanpaces maces  tesomacexte s  s  mes.th     isput t wit   t   somanputes   s  withit  sput ma 
```

如您所见，空格字符的分布很自然地遵循输入文本中的分布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:36:21.507

一种解决方案是从文件中逐个流式传输字符，以便您的阅读循环看起来更像这样：

```
char buffer[order];
inputStream.get(buffer,order);

char next_char;
while ( inputStream.get(next_char) )
{
   string key(buffer, order);
   if (equalsIgnoreCase(key, seed)) {
   // only insert key if not present otherwise overwriting old info 
   if (!nextCharMap.containsKey(seed)) {
      nextCharMap[seed] = Vector(charFollowingSeed);
   }
   else
   {
     nextCharMap[seed].push_back(charFollowingSeed);
   }
   // Update the buffer.
   for(unsigned int i=1; i<order; ++i) buffer[i-1]=buffer[i];
   buffer[order-1]=next_char;
} 
```

然后你可以像这样丢弃额外的空格：

```
....
while ( inputStream.get(next_char) )
{
   //Remove multiple spaces from input.
   if( next_char==' ' and buffer[order-1]==' ') continue

   string key(buffer, order);
   .... 
```

# java - GWT：模块与 ClientBundle？

> ID：12065511
> 
> 赞同：0
> 
> 时间：2012-08-22T02:12:44.187
> 
> 标签：java, gwt, module, clientbundle

我是 GWT 的新手，很难理解*Module*和*ClientBundle*之间的根本区别。在 GWT 文档的某些领域，两者似乎是同一件事，而在其他领域，它们显然是不同的。

我的理解是，模块是部署到用户浏览器的客户端代码。这是一个包含 HTML、CSS 和 JS 的 ZIP 文件。

我的理解是ClientBundle类似于Module，只不过它只包含图片等静态资源。

如果这些理解是正确的，那么为什么需要区分两者呢？HTML/CSS/JS 不也是静态资源吗？！？如果我偏离了基础，请帮助我了解差异是什么，并可能提供每个的具体示例以及何时适合使用每个示例。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T04:36:00.327

您对模块有了正确的认识——它（在开发方面）描述了要使用的 java 源路径、开始编译的入口点以及编译时要使用的各种属性（浏览器、语言环境）。编译后，模块也代表输出 - javascript 和任何相关的其他编译文件，无论是日志、图像、样式表等。

相比之下，ClientBundle 是开发人员可以告诉编译器 java 源路径中的某些资源在编译后将被使用的一种方式。CssResource 附带额外检查是否使用了 css 样式名称（如果没有，则应将其删除以最小化编译输出），ImageResource 确保文件在编译时存在，并且都以针对每个浏览器的最佳优化方式输出这些文件。大多数浏览器的图像实际上都包含在庞大的 JS 文件中，以最大限度地减少对服务器的调用次数，对于不支持此功能的那些，它们会自动组合在一起。

通过声明 ClientBundle 接口并调用`GWT.create(MyClientBundle.class)`，您要求编译器处理 ClientBundle 细节，以使这些引用的文件和类在您的应用程序中可用。*它与 GWT 生成器有*什么关系，这是一个比 SO 答案更高级的主题......

是的，ClientBundles*描述*了正在运行的应用程序所需的静态资源，是的，一个编译的模块*由*各种静态资源组成，但我会改写你的理解，这样说：ClientBundle 是可以包含静态内容的方式之一在 GWT 模块中，以使其尽可能高效地加载。

# python - pygame图像属性错误

> ID：12065512
> 
> 赞同：0
> 
> 时间：2012-08-22T02:12:50.710
> 
> 标签：python, pygame

我正在尝试使用 pygame 创建一个 pacman 游戏，但遇到了一些问题。它说“食物”没有形象。

这是我的吃豆人游戏[代码已编辑]。

问题是这个区域出了点问题，它告诉我食物没有属性图像

```
class Food(pygame.sprite.Sprite):
    def __init__(self,x,y,color):
        pygame.sprite.Sprite.__init__(self)

        pygame.image = pygame.Surface([7,7])
        self.image.fill(color)

        self.rect = self.image.get_rect()
        self.rect.top = y
        self.rect.left = x
    def update (self,player):
        collidePlayer = pygame.sprite.spritecollide(self,player,False)
        if collidePlayer:
            food.remove 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:24:23.480

去掉所有不相关的部分，你看到下面 Sprite 子类的`__init__`方法之间的区别了吗？

```
class Wall(pygame.sprite.Sprite): 

    def __init__(self,x,y,width,height, color):#For when the walls are set up later
        pygame.sprite.Sprite.__init__(self)

        self.image = pygame.Surface([width, height]) # <-------------
        self.image.fill(color)

class player(pygame.sprite.Sprite):

    def __init__ (self,x,y):

        pygame.sprite.Sprite.__init__(self)

        self.image = pygame.Surface([13,13])  # <-------------
        self.image.fill(white) 

class Food(pygame.sprite.Sprite)
    def __init__(self,x,y,color):
        pygame.sprite.Sprite.__init__(self)

        pygame.image = pygame.Surface([7,7])  # <----- this one is different!
        self.image.fill(color) 
```

您收到错误提示的原因是`self`没有`image`属性是因为您没有设置`self.image`，您将图像存储在`pygame`模块本身中。

PS：看起来像的线条

```
 food.remove 
```

对我来说似乎很可疑。If`remove`是一个方法，它会被 调用`food.remove()`，并且`food.remove`不会做任何事情。

# asp.net-mvc - @Html.ListBox 使用和创建问题

> ID：12065515
> 
> 赞同：1
> 
> 时间：2012-08-22T02:12:58.607
> 
> 标签：asp.net-mvc, razor, html.listboxfor

我有一个带有 2 个列表框（*list1, list2*）的网页，我可以将项目从一个列表框移动到另一个列表框并返回。当我单击提交按钮时，我想将*list2*中的所有项目值返回给 httppost 方法。

我有3个问题：

1.  如何确定所选列表的属性？
2.  如何有一个初始的空列表（对于*list2*）？*list1*已填充项目？
3.  单击提交按钮时，如何将所有*list2项返回模型？*

模型：

```
public class TestModel
{
    public List<SelectListItem> OptionList { get; set; }
    public List<SelectListItem> SelectedOptionList { get; set; }
    public string[] SelectedOptions { get; set; }
} 
```

控制器：

```
private TestModel testModel  = new TestModel();

public ActionResult TestPage()
{
    ViewBag.Message = "Test Page";

    testModel.OptionList = new List<SelectListItem>();

    for (int i = 1; i <= 100; i++)
    {
        SelectListItem item = new SelectListItem();
        item.Text = "Option " + i.ToString();
        item.Value = item.Text;

        testModel.OptionList.Add(item);
    }

    return View("TestView", testModel);
}

[HttpPost]
public ActionResult TestPage(TestModel formModel)
{
    testModel.SelectedOptionList = formModel.SelectedOptionList;
    testModel.SelectedOptions = formModel.SelectedOptions;

    //do something
    return RedirectToAction("TestPage");
} 
```

看法：

```
@model EngineeringDataAnalysisGui.Models.TestModel

@{
    ViewBag.Title = @ViewBag.Message;
}

@section Subtitle
{
    @ViewBag.Message
}

<table width="100%">
@using (Html.BeginForm("TestPage", "RetrieveData", FormMethod.Post))
{
    <tr>
        <td>Event List:</td>
        <td>@Html.ListBox("lstEventSelection", Model.OptionList, new { id = "list1", Multiple = "multiple", Size = 15, style = "width: 100%;" })</td>
    </tr>
    <tr>
        <td></td>
        <td>
            <table style="text-align:center; width: 100%">
                <tr>
                    <td id="buttonCol">
                        <input type="button" id="btnAddAllEvent" title="Add All Events" onclick="moveAllOptions('list1','list2', true)" />
                        <input type="button" id="btnAddEvent" title="Add Selected Events" onclick="moveSelectedOptions('list1','list2', true)" />
                    </td>
                    <td id="buttonCol">
                        <input type="button" id="btnRemoveEvent" title="Remove Selected Events" onclick="moveSelectedOptions('list2','list1', true)" />
                        <input type="button" id="btnRemoveAllEvent" title="Remove All Events" onclick="moveAllOptions('list2','list1', true)" />
                    </td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>Selected Event List:</td>
        @*Not sure how to add the listbox*@
        <td>@*Wrong*@@Html.ListBoxFor(x => x.SelectedOptions, Model.SelectedOptionList, new { id = "list2", Multiple = "multiple", Size = 15, style = "width: 100%;" })</td>
    </tr>
    <tr>
        <td><input type="submit" value="submit" /></td>
    </tr>
}
</table> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-22T04:21:45.027

1）如何确定所选列表的属性？
`@Html.ListBoxFor(x => x.SelectedOptions, new MultiSelectList(Model.SelectedOptionList), new { id = "list2", Multiple = "multiple", Size = 15, style = "width: 100%;" })`

2）如何有一个初始的空列表（对于list2）？list1 已填充项目。在控制器中设置一个空列表`testModel.SelectedOptionList = new List<SelectListItem>();`

3）单击提交按钮时如何将所有list2项目返回模型
可能您需要在提交之前将list2中的所有项目设置为选中（使用jquery）。list2 项目中的所有选定项目将在提交时绑定到 TestModel.SelectedOptions。

请环顾四周，SO 中已经有很多与 Html.ListBoxFor 相关的答案。例如 [，在 ListBoxFor 中选择值的挑战](https://stackoverflow.com/questions/3194143/challenges-with-selecting-values-in-listboxfor)

# url - ModX：资源别名不会自动在 URL 中插入斜杠

> ID：12065522
> 
> 赞同：0
> 
> 时间：2012-08-22T02:14:58.407
> 
> 标签：url, alias, modx, modx-revolution

一个奇怪的问题：我有一个使用 ModX 的网站，今天早上我在编辑了一个获取和错误后去预览一个页面。似乎 ModX 不再将 放在`/`资源别名之前。

因此我的网址变成`mysite.comabout-us`而不是`mysite.com/about-us`并且不起作用

手动输入斜线没有任何效果，因为 ModX 会在保存时将其删除。

我正在运行 Revo 2.1.3

有人知道如何解决这个问题吗？谢谢

编辑：进行了更多测试并发现当我关闭 FURL 时也会发生这种情况

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:19:27.667

好的，所以在黑暗中刺了一下，查看了 config.inc.php 文件并进行了更改：

`$modx_base_url= '';`到`$modx_base_url= '/';`，一切似乎又好了……真的很奇怪

# android - 如何让活动重新启动但不重新创建？

> ID：12065525
> 
> 赞同：0
> 
> 时间：2012-08-22T02:15:25.810
> 
> 标签：android, android-activity, android-lifecycle

这是场景：

我有两个活动。让我们命名它们`Activity A`和`Activity B`.

说`Activity A`是开放的。现在，当我去 open 时`Activity B`，`Activity A`因为`onStop()`调用了该方法而关闭。

现在，当我返回到 时`Activity A`，`onCreate()`会调用该方法，但我希望`onRestart()`改为调用该方法。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T02:22:54.770

你不能像那样影响你的应用程序的生命周期。应该没有理由依赖`onRestart()`。如果您使用`onStart()`它，无论 Android 操作系统是否在后台终止应用程序进程，它都会被调用。

查看此文档以获取更多信息：http: [//developer.android.com/reference/android/app/Activity.html#ActivityLifecycle](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T02:28:29.690

该死的打败了​​我，但不管怎样

如果由于操作系统认为另一个应用程序需要内存而从内存中删除了 Activity，则会再次调用Activity[生命周期。](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle) `onCreate()`在这种情况下，您无法确保`onRestart()`始终为您的 Activity 调用它。

如前所述，您必须通过使用其他生命周期方法（例如`onStart()`或`onResume`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T04:31:41.910

我不确定它是否符合您的需求，我必须执行更新服务，该服务在我第一次打开 ActivityA（主 Activity）时启动，并在从 ActivityA 退出时停止（不从 ActivityB 返回），

我已将“开始代码”放置在`onCreate()`when `savedInstanceState`is中`null`，并且将“停止代码”放置在`onDestroy()`if isFinishing() 为 true 中

# sql - 没有外键的数据库设计

> ID：12065526
> 
> 赞同：28
> 
> 时间：2012-08-22T02:15:51.617
> 
> 标签：sql, database-design

在不同的雇主工作后，我注意到其中*一些*公司的数据库设计“糟糕”的趋势——主要是排除*外键约束*。这些事务系统没有 FK 一直困扰着我，这会促进参照完整性。

> *   在交易系统中，是否存在省略 FK 有益的情况？
>     
>     
> *   有没有其他人经历过这种情况，如果有，结果如何？
>     
>     
> *   如果他们遇到这种情况并要求他们维护/增强系统，应该怎么做？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-08-22T02:22:47.820

我想不出*任何*情况，如果两列具有依赖关系，则它们之间不应设置 FK 约束。删除参照完整性当然*可以*加快数据库操作，但要为此付出相当高的成本。

我经历*过*这样的系统，通常的结果是数据损坏，即存在不应该存在的记录（反之亦然）。在这些系统中，人们认为他们没问题，因为应用程序会处理它，而不是关心它：

*   *每个*应用程序都必须处理它，而不是一个数据库服务器。
*   只需要一个错误或恶意应用程序就可以为每个人搞砸。
*   保护自己是数据库的责任*！*这是它最好的功能之一。

至于你应该做什么，我只是提出了可能出错的事情以及使用 FK 将如何防止这种情况（如果需要，通常会通过成本/收益分析“偏向”我的观点）。然后让公司决定——毕竟这是他们的数据库。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-22T02:33:24.093

有一种观点认为，编写良好的应用程序不需要参照完整性。如果应用程序做对了，那么就不需要约束。

这种想法类似于不进行防御性编程，因为如果您正确编写代码，就不会出现错误。虽然是真的，但它根本不会发生。不使用适当的约束要求数据损坏。

至于你应该做什么，你应该鼓励公司在每一个机会中增加约束。你不想把它推到惹麻烦或给自己留下坏名声的地步，但只要环境合适，继续推动它。从长远来看，每个人的生活都会更好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-22T02:35:47.897

就个人而言，我对没有明确声明外键的数据库没有任何问题。但是，这取决于数据库的使用方式。

我使用的大多数数据库都是从一个或多个事务系统派生的相对静态的数据。我并不特别关心影响数据库的恶意更新，因此明确定义外键关系并不是特别重要。

我确实拥有的一件事是非常一致的命名。基本上，每个表都有一个名为 ID 的第一列，这正是该列在其他表中的引用方式（或者，有时带有前缀，当两个实体之间存在多个关系时）。我还尝试坚持这样的数据库中的每一列都有一个描述属性的唯一名称（因此“CustomerStartDate”与“ProductStartDate”不同）。

如果我正在处理有更多“锅里的厨师”的数据，那么我希望更明确地了解外键关系。而且，我更愿意承担外键定义的开销。

这种开销出现在许多地方。创建新表时，我可能想使用“create table as”或“select into”，而不用担心约束的细节。运行更新或插入查询时，我可能不希望检查我知道没问题的事情的数据库开销。但是，我必须强调，一致的命名大大增加了我对一切正常的信心。

显然，我的观点不是 DBA，而是从业者。然而，表格之间的无效关系是我——或我团队的其他成员——几乎不需要处理的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-14T21:24:26.070

只要数据库有一个单一的入口点，最终哪个“层”维护参照完整性并不重要。使用外键约束的“内置层”似乎是最有意义的，但如果你有一个坚如磐石的服务层负责同样的事情，那么它可以在必要时自由地打破规则。

我个人使用外键约束并设计我的应用程序，这样他们就不必违反规则。具有保证参考完整性的关系数据更易于使用。

获得的性能可能等同于必须在数据库之外保持完整性而损失的性能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-22T08:14:26.200

在 OLTP 数据库中，我能想到的唯一原因是您是否关心性能而不是数据完整性。在将行插入子表时强制执行 FK 需要在父表上进行索引查找，我可以想象可能存在极端情况，即使这种相对快速的索引查找也太多了。例如，某种非常密集的日志记录，您可以忍受不正确的日志条目，并且执行写入的应用程序很简单，不太可能有错误。

话虽如此，如果您可以忍受损坏的数据，那么您可能一开始就可以在没有数据库的情况下生活。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-03T17:42:15.277

如果您主要使用存储过程并且每个应用程序都使用这些存储过程，而不是编写自己的查询，那么没有外键的防御性编程就可以工作。然后你可以很容易地控制它，比标准外键更灵活。

我能想到的一种情况是外键约束不容易使用的情况是权限模块，其中权限可以应用到每个用户或每个组，由布尔值确定。所以权限表中的一些记录有一个用户 ID，而其他记录有一个组 ID。如果您仍然需要外键约束，则必须为相同的互斥信息提供两个不同的字段，并允许它们为空。这意味着添加另一个约束，即允许一个为空，但它们不能都为空，并且 3 个字段的组合必须是唯一的，而不是 2 个字段的组合（用户/组 ID 和权限 ID）。另一种方法是包含相同数据的两个单独的表，这意味着分别维护两个表。

但也许在这种情况下，最好将数据分开。如果您需要相同的字段来根据该记录中的其他数据连接到不同的表，则不能使用外部字段约束，最好将约束保留在存储过程和视图中。

# c# - Twitter 授权/签名获取请求返回 401 未授权

> ID：12065528
> 
> 赞同：0
> 
> 时间：2012-08-22T02:15:55.550
> 
> 标签：c#, oauth, httpwebrequest, twitter

我正在尝试向 api.twitter.com/1/followers/ids.xml 发出授权获取请求它一直返回 401 未授权。.Ive 已将标头和基本字符串与 twitter 开发人员应用程序页面中的 OAuth 工具中生成的字符串进行对比，它们完全相同。我也尝试过更改发布的方法而不是无济于事。

这是代码：

```
 ServicePointManager.Expect100Continue = false;
        HttpWebRequest request =(HttpWebRequest)WebRequest.Create("http://api.twitter.com/1/followers/ids.xml");
        request.Headers.Add(Uri.EscapeDataString("Authorization: "), authHeader);
        request.Method = "GET";
        request.ContentType = "application/x-www-form-urlencoded";
        WebResponse response = request.GetResponse(); 
```

我发送请求的方式有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:45:31.553

您需要添加您感兴趣的 Twitter 用户的 screen_name 或 user_id。例如： [https ://api.twitter.com/1/followers/ids.json?cursor=-1&screen_name=twitterapi](https://api.twitter.com/1/followers/ids.json?cursor=-1&screen_name=twitterapi)

# ruby-on-rails - Ruby On Rails 教程第 8 章困惑

> ID：12065539
> 
> 赞同：1
> 
> 时间：2012-08-22T02:17:46.750
> 
> 标签：ruby-on-rails, session

大家！最近，我正在研究 Michael Hartle 的 RoR 教程。在第 8 章中，我遇到了一个困扰我两天的问题。这是问题所在。在第 8.2.3 节中。

```
module SessionsHelper

  def sign_in(user)
    .
    .
    .
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user     # Useless! Don't use this line.
  end
end 
```

迈克尔写道：

> 如果这样做，我们将有效地复制 attr_accessor 的功能，我们在第 4.4.5.5 节中看到了它。问题是它完全无法解决我们的问题：使用清单 8.21 中的代码，用户的登录状态将被遗忘：如用户一转到另一个页面——噗！——会话将结束，用户将自动退出。为了避免这个问题，我们可以通过代码清单 8.19 中的代码创建的记忆令牌找到对应的用户，如代码清单 8.22 所示。

清单 8.22。

```
module SessionsHelper
  .
  .
  .
  def current_user=(user)
    @current_user = user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end
end 
```

我的问题是：为什么以前的代码会在用户转到新页面时自动注销会话？为什么第二段代码不会？我认为，只要用户登录，@current_user 的值将始终为“用户”，直到他明确注销，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:34:33.447

前面的代码并没有将用户注销，也没有在后续请求中重新创建用户。

状态不会在请求之间共享，并且必须在每个请求中重新创建。`@current_user`是一个实例变量，并在单个请求的持续时间内保持它的值。

为了绕过状态不共享的事实，对于每个请求，我们需要重新加载必要的变量，例如`@current_user`从会话中常见的变量中加载，在这种情况下，它们正在使用`remember_token`cookie。

第一段代码不会`@current_user`在每个请求上重新加载，因此一旦用户登录后浏览到另一个页面就会忘记它持有的值，第二段代码尝试通过`remember_token`cookie 加载当前用户，所以在这之后当有人登录时设置，应该记住用户，直到该 cookie 过期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T02:35:15.637

他在这里说的是，当我们在第一个示例中使用@current_user 而不是在登录页面上时，我们没有调用@current_user = User.find(1)。我们依赖它已经设置好了。由于我们没有明确设置 @current_user 如下：

```
@current_user ||= User.find_by_remember_token(cookies[:remember_token]) 
```

表示如果 @current_user 未设置，则通过使用存储在 cookie 中的 id 查找用户来设置它。这样，当我们导航到没有明确设置 @current_user 的页面时，它将被填充。

# php - PDO 中的 MySQL 数据库连接管理

> ID：12065540
> 
> 赞同：10
> 
> 时间：2012-08-22T02:17:54.487
> 
> 标签：php, mysql, pdo, database-connection, database-management

我对 PHP/MySQL 很陌生，我边走边学。我学到的新知识之一是，对于给定的用户名，可以对数据库建立最大连接数。当我第一次开始在 Wordpress 上构建我的网站时，我使用的是旧的 mysql_query() 命令。我从来不需要连接到 MySQL 数据库，因为 Wordpress 只需在网站上登录就可以保持活动连接。当我决定将所有 MySQL 查询切换到 PDO 扩展时，我无法再利用 Wordpress 的活动连接，而不得不启动我自己的数据库连接。我在一个单独的 PHP 配置文件中执行此操作，该文件包含在运行脚本的每个页面中。PHP 代码如下所示：

```
try {
    $DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass);
}
catch(PDOException $e) {  
    echo "Select DB Error: " .$e->getMessage(). "</br>";
} 
```

不幸的是，现在我经常收到以下错误：

" SQLSTATE[42000] [1203] 用户已经有超过 'max_user_connections' 的活动连接"

根据一些在线研究，我尝试了各种不同的方法来解决这个问题。首先，我尝试在每个脚本的末尾将数据库连接设置为 null（尽管这应该是 PHP PDO 的默认设置？）。然后我尝试`null`在每次查询数据库之后将每个语句句柄设置为（这是一个无望的努力）。最后，我尝试通过更改配置文件中的以下行来使用持久连接：

```
$DBH = new PDO("mysql:host=$host;dbname=$dbname", $user, $pass, array(PDO::ATTR_PERSISTENT => true)); 
```

这些似乎都不起作用，我仍然得到同样的错误。该网站准备就绪后，每天需要能够处理 100-200 人输入无数不同的数据。即使我能弄清楚如何使用 PDO 来利用 Wordpress 的主动连接，那也是一个好的开始。我会很感激我能得到的任何帮助。

更新：

我在我`SHOW FULL PROCESSLIST`的一个代码中作为 MySQL 查询运行，并且出现了非常奇怪的行为。这是我的脚本的第一部分（不包括`SHOW FULL PROCESSLIST`查询）：

```
<?php

include 'config.php';

if(isset($_POST['submit']))
{
//Get Current User Login
global $current_user;
$current_user = wp_get_current_user();
$ulog = $current_user->user_login;
$tablename_cc = "cc_".$ulog;
$tablename_db = "db_".$ulog;
$tablename_misc = "misc_".$ulog;
$tablename_cash = "cash_".$ulog;

try {
    $DBH->exec("CREATE TABLE IF NOT EXISTS " .$tablename_cc. " (ID bigint(100) NOT NULL AUTO_INCREMENT, PRIMARY KEY(ID), accnt TEXT(20), cc_num TEXT(4), cc_amnt DECIMAL(8,2), cc_app TEXT(20), cc_date VARCHAR(10), cc_time VARCHAR(10))");            
    $DBH->exec("CREATE TABLE IF NOT EXISTS " .$tablename_db. " (ID bigint(100) NOT NULL AUTO_INCREMENT, PRIMARY KEY(ID), accnt TEXT(20), db_num TEXT(20), db_amnt DECIMAL(8,2), db_date VARCHAR(10), db_time VARCHAR(10))");        
    $DBH->exec("CREATE TABLE IF NOT EXISTS " .$tablename_misc. " (ID bigint(100) NOT NULL AUTO_INCREMENT, PRIMARY KEY(ID), accnt TEXT(20), misc_item TEXT(1000), misc_amnt DECIMAL(8,2), misc_date VARCHAR(10), misc_time VARCHAR(10))");       
    $DBH->exec("CREATE TABLE IF NOT EXISTS " .$tablename_cash. " (ID bigint(100) NOT NULL AUTO_INCREMENT, PRIMARY KEY(ID), accnt TEXT(20), cash_amnt DECIMAL(8,2), cash_time VARCHAR(10))");
}
catch(PDOException $e) {  
    echo "Create Tables Error: " .$e->getMessage();
}
} ?> 
```

如果我尝试`SHOW PROCESS LIST`在 if 语句之外运行查询，我会得到一个结果，说明我有一个活动连接；但是，如果我尝试在 if 语句中运行*查询*`SHOW FULL PROCESSLIST`，则会收到超出连接数的错误。基于这个结果，我认为当用户提交他们的表单（基本上是尝试连接到数据库两次）时，我在页面顶部的行可能会导致问题，所以我将它移到 if 语句中，但是也没有什么区别。我不知道为什么会这样。*`include`*

 *更新/回答（还有一些问题）：

我弄清楚我的问题是什么。完成我的一个脚本后，有一个 javascript 命令会弹出一个窗口，另一个脚本将在该窗口中为他们打印发票。第二个脚本还尝试使用配置文件连接到数据库。用户正在使用的表单是动态的（他们可以根据需要放入尽可能少的数据集），因此当用户插入少量数据时，PDO 查询执行得非常快，并且之间没有冲突连接数；但是，如果用户输入大量数据，则需要花费大量时间，并且服务器会达到最大连接数。问题实际上在于服务器环境不佳和我的查询效率低下（仍在学习 PHP）。在这一点上我能想到的唯一解决方案是在我的第二个脚本上放置更长的睡眠时间（已经使用了 3 秒的睡眠时间），让另一个脚本赶上来，但在某些时候，这将花费太长时间。不知道大家有没有更好的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:36:31.247

如果您有另一个工具可以为您提供与数据库的连接，您可能想查看您实际建立了多少连接。在紧要关头，`phpmyadmin`可以做到这一点。

通常你可以看到你所有的活动查询和连接：

```
SHOW PROCESSLIST 
```

如果您在 PDO 连接例程中犯了错误，则您可能正在为您尝试运行的每个查询建立连接，而不是在请求期间建立一个连接。您可能还需要检查每个请求是否没有为您创建大量未正确关闭的连接池。您可能需要尝试连接选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T05:33:36.613

在文件中使用`include_once('config.php')`或`require_once('config.php')`代替`include 'config.php'`可能是避免重复数据库连接的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T14:14:28.003

您需要的是一个 PDO“单例”类。这是一个例子：

[http://tonylandis.com/php/php5-pdo-singleton-class/](http://tonylandis.com/php/php5-pdo-singleton-class/)

这不是最好的例子，因为构造函数需要太多参数。只需将 $dsn,.., args 硬编码到构造函数中，即。_construct(){...} 并且您可以在使用 PDO() 的任何地方使用 new sdb()。不需要任何 include 或 require 语句，除了一次用于类。

$pdo 对象作为静态变量存储在类中，因此始终可以访问。*

# java - 功能切换 Java 注释

> ID：12065541
> 
> 赞同：6
> 
> 时间：2012-08-22T02:17:59.647
> 
> 标签：java, spring, jpa, annotations, featuretoggle

如何使用切换 Java 注释？

简单的功能切换：- if(toggle enabled) do x

Spring 允许使用“配置文件”来切换 bean。

我使用这些，它们很好，但我想在字段或类上切换注释.. 我该怎么做？

用例，我有一个具有 jpa 注释的类。我希望能够在某些环境中通过配置标记某些字段是@transient。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T08:06:55.513

如前所述，尝试“禁用”注释虽然可能是可能的，但并不是解决问题的最佳方法。

就像 Adrian Shum 所说，您应该更改框架处理注释的方式。在您的情况下，您的 JPA 实现下面应该有一些 ORM 提供程序（例如 Hibernate）。

大多数 ORM 都有一些方法来提供自定义功能，例如在 Hibernate 的情况下，您可以创建一个[拦截器](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/events.html)并通过将 hibernate.ejb.interceptor 添加到 JPA 配置中的持久性单元来注册它，详见[此处](http://docs.jboss.org/hibernate/entitymanager/3.6/reference/en/html/configuration.html#setup-configuration-bootstrapping)。

这个拦截器应该做什么取决于你，但我建议使用不同的注释（例如@ConditionalTransiet），一种方法是通过反射检查字段，检查它们是否有注释，如果它在错误的环境中然后使用onLoad 和 onSave 从对象中擦除相关字段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T05:05:49.377

一种可能的选择是使用[aspectj](http://www.eclipse.org/aspectj/)及其[声明注释](http://www.eclipse.org/aspectj/doc/next/adk15notebook/annotations-declare.html)的能力和 spring 的[加载时方面编织](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/aop.html#aop-aj-ltw)的能力。

我想注解不能有条件地声明，但你总是可以在一个单独的 jar 中编译它们，可以根据特定环境将其放入类路径中，以便加载时编织器能够找到它。

* * *

**更新**

虽然这里有很多有用的答案，但我发现使用 aspectj 禁用/启用注释非常有趣，因此示例如下。

最新版本的 aspectj 支持删除注释，但目前此功能仅适用于字段注释，因此非常有用的方法是根本不声明注释并且如果必须启用它们 - 将带有预编译方面的 jar如前所述，将启用类路径中的注释。

* * *

**样本**

* * *

**第一个罐子**

主要班

```
package org.foo.bar;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Main {

    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("/applicationContext.xml");
        MyClass myObj = context.getBean("myObj", MyClass.class);

        System.out.println(myObj);
        System.out.println(myObj.getValue1());
        System.out.println(myObj.getValue2());
    }

} 
```

我们将在其中声明注释的类

```
package org.foo.bar;

public class MyClass {

    @MyAnn("annotated-field-1")
    private String field1;
    private String field2;

    @MyAnn("annotated-method-1")
    public String getValue1() {
        String value = null;
        try {
            MyAnn ann = getClass().getDeclaredMethod("getValue1").getAnnotation(MyAnn.class);
            if(ann != null) {
                value = ann.value();
            }
        } catch (NoSuchMethodException e) {
            throw new RuntimeException(e);
        }
        return value;
    }

    public String getValue2() {
        String value = null;
        try {
            MyAnn ann = getClass().getDeclaredMethod("getValue2").getAnnotation(MyAnn.class);
            if(ann != null) {
                value = ann.value();
            }
        } catch (NoSuchMethodException e) {
            throw new RuntimeException(e);
        }
        return value;
    }

    @Override
    public String toString() {
        String field1 = null;
        try {
            MyAnn ann = getClass().getDeclaredField("field1").getAnnotation(MyAnn.class);
            if(ann != null) {
                field1 = ann.value();
            }
        } catch (NoSuchFieldException e) {
            throw new RuntimeException(e);
        }

        String field2 = null;
        try {
            MyAnn ann = getClass().getDeclaredField("field2").getAnnotation(MyAnn.class);
            if(ann != null) {
                field2 = ann.value();
            }
        } catch (NoSuchFieldException e) {
            throw new RuntimeException(e);
        }

        StringBuilder sb = new StringBuilder();
        sb.append("MyClass");
        sb.append("{field1='").append(field1).append('\'');
        sb.append(", field2='").append(field2).append('\'');
        sb.append('}');
        return sb.toString();
    }
} 
```

注释本身

```
package org.foo.bar;

import java.lang.annotation.Documented;
import java.lang.annotation.ElementType;
import java.lang.annotation.Inherited;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@Target({ElementType.FIELD, ElementType.METHOD})
public @interface MyAnn {

    String value();

} 
```

应用程序上下文

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:load-time-weaver />

    <bean id="myObj" class="org.foo.bar.MyClass" />

</beans> 
```

* * *

**第二个罐子**

方面

```
package org.foo.bar;

public aspect ToggleAnnotationAspect {

    declare @field : private String org.foo.bar.MyClass.field1 : -@MyAnn;
    declare @field : private String org.foo.bar.MyClass.field2 : @MyAnn("annotated-field-2");

    declare @method : public String org.foo.bar.MyClass.getValue2() : @MyAnn("annotated-method-2");

} 
```

元信息/aop.xml

```
<?xml version="1.0"?>

<aspectj>
    <aspects>
        <aspect name="org.foo.bar.ToggleAnnotationAspect"/>
    </aspects>
</aspectj> 
```

* * *

在类路径中没有第二个 jar 的情况下运行应用程序

```
java -javaagent:spring-instrument-3.1.3.RELEASE.jar \
     -classpath app1.jar;<rest_of_cp> org.foo.bar.Main 
```

将打印

```
MyClass{field1='annotated-field-1', field2='null'}
annotated-method-1
null 
```

使用类路径中的第二个 jar 运行应用程序

```
java -javaagent:spring-instrument-3.1.3.RELEASE.jar \
     -classpath app1.jar;app1-aspects.jar;<rest_of_cp> org.foo.bar.Main 
```

将打印

```
MyClass{field1='null', field2='annotated-field-2'}
annotated-method-1
annotated-method-2 
```

因此根本没有对应用程序源进行任何修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T03:44:35.703

我认为这在现场级别是不可能的。您可能做的是将整个班级排除在 JPA 考虑的范围之外（通过持久性单元配置）。我相信这应该可以按照个人资料来完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T03:28:50.377

不，你不能这样做。

注释只是一段元数据。编译源代码后，它会附加到字节码（嗯，取决于保留）。因此它总是在那里。您不能使用正常方式使其在运行时消失。

然而，注释只是元数据。它自己什么都不做。应该有其他人检查注释，并相应地做他们的工作。因此，您应该研究的是，您应该找到某种方法来告诉检查注释的“某人”，并告诉它解释注释的正确方法是什么（例如忽略某些注释等）

没有执行此操作的通用方法，因为这完全取决于检查注释的人。

* * *

如果您坚持采取麻烦的方式，我相信您可能会在运行时更改类。这将是一项乏味的工作。我记得，像 Javassist 这样的工具允许您“重写”由类加载器加载的类并将其保存回来。但是您将面临很多问题，例如，您的类替换过程应该在任何其他代码运行之前发生，如果没有，例如，Hibernate 将已经检查了未修改的类并完成了它的设置，甚至您删除了之后来自类的注释，它不会做任何事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T08:00:54.903

你可以试试这个（使用方面）：

```
@Profile("active")
privileged aspect AddField {
    private String MyClass.name;
}

@Profile("inactive")
privileged aspect AddFieldTransient {
    @Transient
    private String MyClass.name;
} 
```

不确定配置文件注释是否适用于方面类。此外，这种方式需要您为要应用此行为的每个字段添加这些方面。很难使它比这更通用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-26T23:39:50.177

在 Hibernate 开始时，他们将其设计为将配置与实际类分开，使用单独的映射 xml 文件。注释只是后来作为方便的妥协而添加的。

在标准化的 JPA 中仍然可以使用 orm.xml 配置来覆盖注释。请参阅[http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/xml-overriding.html](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html/xml-overriding.html)以获取参考。

在您的情况下，如果您使用`metadata-complete="true"`，则所有元数据都来自 orm.xml 文件而不是注释。然后你可以使用两个不同的 orm.xml。

```
<entity class="Administration" access="PROPERTY" metadata-complete="true">
    <attributes>
       <basic name="status"/>
       <basic name="optional">
     </attributes> 
```

```
<entity class="Administration" access="PROPERTY" metadata-complete="true">
    <attributes>
       <basic name="status"/>
       <!-- omitted optional property -->
     </attributes> 
```

# iphone - iOS 混合音频，音频工具箱与音频单元

> ID：12065543
> 
> 赞同：0
> 
> 时间：2012-08-22T02:18:23.313
> 
> 标签：iphone, objective-c, ios, xcode, audio-recording

我一直在寻找一段时间，无法得出一个好的结论。

我正在尝试创建一个可以“记录”用户在 4x4 按钮阵列上的节拍的应用程序。每个按钮都有一个与之相关的声音，在他们点击录音后，我想混合播放的音频并将其保存到文件中，以便他们可以收听并稍后播放。

更棘手的是，会有节拍器在播放，我不想将节拍器的声音混入正在保存的音频中。

根据我的发现，唯一的方法是使用这些功能的音频单元，但我不愿意，因为它看起来有点矫枉过正，而且学习起来有些复杂。Audio Toolbox 能让这一切变得更容易吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T16:19:24.050

一般来说，使用 AudioToolBox 很容易实现。

更多信息，请参见下面的示例代码。这很有帮助。

[混音主机](http://developer.apple.com/library/ios/#samplecode/MixerHost/Introduction/Intro.html)

# c++ - 使用 C++0x std::thread 在新对象中调用成员函数

> ID：12065544
> 
> 赞同：1
> 
> 时间：2012-08-22T02:18:32.207
> 
> 标签：c++, c++11, stdthread

我想做这样的事情：

```
class A {
public:
    void a_start () {
        // somewhere in A: my_b = new B();
        std::thread t(my_b->b_start);   // won't compile
    }

private:
    B* my_b;
};

class B {
public:
    void b_start();
}; 
```

但它不会编译。我试图查看[http://accu.org/index.php/journals/1584](http://accu.org/index.php/journals/1584)但它没有提到成员函数位于新对象中的情况。什么是正确的语法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:27:55.210

指向成员函数的指针与函数不同。你不能把一个传给`std::thread`. 您可以做的是声明一个`my_b`以参数为参数并调用`b_start`它的函数，然后将函数传递`my_b`给`std::thread`. 或者，这是 C++11，您可能可以使用 lambda：

```
void a_start() {
    std::thread t([](B* b){b->b_start();}, my_b);
} 
```

（注意：我没有尝试自己编译这个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:34:22.157

有很多方法可以实现这一点，例如使用 std::bind 或使用 trampoline 成员函数，但我可能只使用 lambda，如下所示：

```
std::thread t([&](){my_b->b_start();}); 
```

# c# - 将数据从 form1.richTextBox 复制到 form2.richTextbox

> ID：12065547
> 
> 赞同：1
> 
> 时间：2012-08-22T02:19:02.440
> 
> 标签：c#, winforms

我正在制作一个有趣的时钟并学习 C#。

我有时间下来，开始，停止，清除。

但是，我遇到了“注释”部分的问题。理想情况下，我希望能够将注释写入字段，并有一个“编辑”按钮以允许用户打开一个窗口以获取与文本编辑相关的更多选项。（使用 Form1 富文本框中的文本）

我的问题来自将数据从一种形式复制到另一种形式。

这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace PunchOut
{
public partial class PunchOut : Form
{
    public PunchOut()
    {
        InitializeComponent();
    }
    int i = 0;
    private void button3_Click(object sender, EventArgs e)
    {
        timer1.Enabled = true;
        i++;

        TimeSpan t = TimeSpan.FromSeconds(i);

        textBox2.Text = string.Format("{0:D2}:{1:D2}:{2:D2}",
                                        t.Hours,
                                        t.Minutes,
                                        t.Seconds);
    }

    private void button2_Click(object sender, EventArgs e)
    {
        timer1.Enabled = false;

    }

    private void button1_Click(object sender, EventArgs e)
    {
        textBox2.Clear();
        textBox2.Text = ("00:00:00").ToString();
    }

    private void button6_Click(object sender, EventArgs e)
    {

    }

    public void button4_Click(object sender, EventArgs e)
    {
        new Form2().Show();
        richTextBox1.Text = Form2.richTextBox1.Text;

    }
}
} 
```

这是Form2代码：

```
namespace PunchOut
   {
    public partial class Form2 : Form
    {
       public Form2()
       {
            InitializeComponent();
       }

        public void richTextBox1_TextChanged(object sender, EventArgs e)
        {
            richTextBox1.Text = PunchOut.richTextBox1.Text;
        }
    }
} 
```

目前，我收到一条错误消息：

> 非静态字段、方法或属性“PunchOut.PunchOut.richTextBox1”需要对象引用

和

> 非静态字段、方法或属性“PunchOut.Form2.richTextBox1”需要对象引用

为什么我会收到这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:03:21.963

那里有很多不需要的工作。我希望我解释得足够好

分解：我们添加一个字符串成员变量，以便我们可以将 RichTextBox 的内容放入字符串中并传递它，而不是使用 RichTextbox 控件。我们将构造函数更改为采用字符串参数，该参数是您要更改的 RTF 文本。现在 Form2 可以更改任何 RTF 文本，而不是专门绑定到 punchoutForm 上的richTextbox1。

然后，我们将成员变量的更新更改为表单关闭时，否则您将在每次击键时更改它，这是很多不必要的方法调用。

```
namespace PunchOut
{
    public partial class Form2 : Form
    {
         public String richText;
         public Form2(String rText)
         {    
              InitializeComponent();
              this.richTextBox1.Rtf = rText;

         }

        private void Form2_FormClosing(object sender, FormClosingEventArgs e)
        {
            richText = this.richTextBox1.Rtf;
        }
    }
} 
```

然后在您的 button4_Click 中。使用 Rtf 包含代码，否则只需使用纯文本框

现在在您的按钮单击事件处理程序中，我们创建一个新表单并将其分配给一个变量。然后我们调用 showdialog。showdialog 的原因是，这将使表单成为最顶层的表单，这样用户就无法返回到打孔表单并更改 Richtextbox，这将使 Form2 中的文本过时，因为它不再代表正确打孔表单中的 RTF 文本。当用户完成文本编辑并关闭表单后，我们通过访问 Form2 的 RichText 成员变量来请求编辑的 rtf 文本。您可以在表单关闭后访问它的原因是表单在方法返回之前不会被释放，您的局部变量位于方法的范围内。

```
public void button4_Click(object sender, EventArgs e)
{              
    Form2 f2 = new Form2(richTextBox1.Rtf);
    f2.ShowDialog();
    richTextBox1.Rtf= f2.richText;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:28:21.403

您没有在 Form2 中对 PunchOut 进行新的引用。在您的表格 2 中，在类声明下添加：

```
PunchOut punchOut; 
```

然后你进入 Form2：

```
namespace PunchOut
{
    public partial class Form2 : Form
    {
       PunchOut punchOut;

       public Form2(PunchOut PUNCHOUT)
       {
            punchOut = PUNCHOUT;
            InitializeComponent();
       }

        public void richTextBox1_TextChanged(object sender, EventArgs e)
        {
            richTextBox1.Text = punchOut.richTextBox1.Text;
        }
    }
} 
```

在原来的替换 button4_CLick 为：

```
public void button4_Click(object sender, EventArgs e)
{
        Form2 form2 = new Form2(this);
        form2.Show();
        richTextBox1.Text = form2.richTextBox1.Text;

} 
```

已编辑：您应该传递旧的 PunchOut 而不是创建新的。我已经更新了代码。

您可以将文本存储在更易于访问的字符串中。然后让您的其他表单调用该字符串。

```
public string yourText;

// down further

yourText = textBox1.Text; 
```

# sencha-touch - 煎茶框架。三栏轮播

> ID：12065548
> 
> 赞同：1
> 
> 时间：2012-08-22T02:19:20.513
> 
> 标签：sencha-touch, extjs, carousel

我是 Sencha 的新手。我想制作 3 列垂直轮播。比如[iPad的天猫界面](https://dl.dropbox.com/u/3480160/carousel.png)

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T07:50:25.280

我想这就是你想要的

```
{
xtype: container,
layout: 'hbox',
items: [
{
xtype: 'carousel',
direction: 'vertical',
...what the carousel should contain
},
{
xtype: 'carousel',
direction: 'vertical',
...what the carousel should contain
},
{
xtype: 'carousel',
direction: 'vertical',
...what the carousel should contain
}
]
} 
```

希望能帮助到你

# vb.net - 如何在 VB.NET 中向计算 CRC32 校验和的代码添加 ProgressBar？

> ID：12065555
> 
> 赞同：0
> 
> 时间：2012-08-22T02:20:08.510
> 
> 标签：vb.net, winforms, progress-bar, crc32

感谢阅读 - 我正在使用下面的类来计算指定文件的 CRC32 校验和。

我的问题是如何将文件完成的进度（以 % 为单位）报告到不同表单上的进度条。我已经在 New() 子下尝试了 (i / count) * 100 但我没有任何运气，或者为此设置进度条。任何人都可以帮忙吗？

提前致谢

史蒂夫

```
Public Class CRC32

Private crc32Table() As Integer
Private Const BUFFER_SIZE As Integer = 1024

Public Function GetCrc32(ByRef stream As System.IO.Stream) As Integer

    Dim crc32Result As Integer
    crc32Result = &HFFFFFFFF

    Dim buffer(BUFFER_SIZE) As Byte
    Dim readSize As Integer = BUFFER_SIZE

    Dim count As Integer = stream.Read(buffer, 0, readSize)
    Dim i As Integer
    Dim iLookup As Integer

    Do While (count > 0)
        For i = 0 To count - 1

            iLookup = (crc32Result And &HFF) Xor buffer(i)
            crc32Result = ((crc32Result And &HFFFFFF00) \ &H100) And &HFFFFFF
            crc32Result = crc32Result Xor crc32Table(iLookup)
        Next i

        count = stream.Read(buffer, 0, readSize)
    Loop

    GetCrc32 = Not (crc32Result)

End Function

Public Sub New()

    Dim dwPolynomial As Integer = &HEDB88320
    Dim i As Integer, j As Integer

    ReDim crc32Table(256)
    Dim dwCrc As Integer

    For i = 0 To 255
    Form1.CRCWorker.ReportProgress((i / 255) * 100)  'Report Progress
        dwCrc = i
        For j = 8 To 1 Step -1
            If (dwCrc And 1) Then
                dwCrc = ((dwCrc And &HFFFFFFFE) \ 2&) And &H7FFFFFFF
                dwCrc = dwCrc Xor dwPolynomial
            Else
                dwCrc = ((dwCrc And &HFFFFFFFE) \ 2&) And &H7FFFFFFF
            End If
        Next j

        crc32Table(i) = dwCrc
    Next i

    'file complete
End Sub

End Class
  '------------- END CRC32 CLASS--------------
   '-------------- START FORM1 --------------------------
Private Sub CRCWorker_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles CRCWorker.DoWork

 For i = CurrentInt To dgv.Rows.Count - 1
              CRCWorker.ReportProgress(0, i & "/" & Total_Files)
              Current_File_Num = (i + 1)
              SetControlText(lblCurrentFile, Str(Current_File_Num) & "/" & Total_Files)
              result = CheckFile(SFV_Parent_Directory & "\" & dgv.Rows(i).Cells(0).Value, dgv.Rows(i).Cells(1).Value)
           Select Case result
               Case 0 ' missing file
                   UpdateRow(i, 2, "MISSING")
                   'dgv.Rows(i).Cells(2).Value = "MISSING"
                    Missing_Files = Missing_Files + 1
                    SetControlText(lblMissingFiles, Str(Missing_Files))
               Case 1 ' crc match
                    UpdateRow(i, 2, "OK")
                  ' dgv.Rows(i).Cells(2).Value = "OK"
                    Good_Files = Good_Files + 1
                    SetControlText(lblGoodFiles, Str(Good_Files))
              Case 2 'crc bad
                    UpdateRow(i, 2, "BAD")
                    ' dgv.Rows(i).Cells(2).Value = "BAD"
                    Bad_Files = Bad_Files + 1
                    SetControlText(lblBadFiles, Str(Bad_Files))
            End Select
            If CRCWorker.CancellationPending = True Then
                e.Cancel = True
                Exit Sub
            End If

      Next
       End Sub
    Private Sub CRCWorker_ProgressChanged(ByVal sender As Object, ByVal e As System.ComponentModel.ProgressChangedEventArgs) Handles CRCWorker.ProgressChanged

    Dim val As Integer = e.ProgressPercentage
    ProgressBar2.Maximum = 100
    ProgressBar2.Value = e.ProgressPercentage
    Debug.Print(val)

    End Sub

     Function CheckFile(ByVal tocheck_filepath As String, ByVal expected_crc As String) As Integer 'returns result of a file check 0 = missing 1 = good 2 = bad

    If File.Exists(tocheck_filepath) = False Then
        Return 0 'return file missing
    End If
    Dim f As FileStream = New FileStream(tocheck_filepath, FileMode.Open, FileAccess.Read, FileShare.Read, 8192)
    Dim c As New CRC32()

    crc = c.GetCrc32(f)
    Dim crcResult As String = "00000000"
    crcResult = String.Format("{0:X8}", crc) 
    f.Close()

End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T06:30:47.630

您的 .ReportProgress() 调用似乎在 New() 子例程中，这是为 CRC 计算制作查找表的部分。New() 子例程在主 CRC 例程之前调用一次。主要的CRC例程是占用所有时间并且需要进度条的例程。

进度条更新不应该在 GetCrc32() 函数中吗？像这样的东西：

```
 Public Function GetCrc32(ByRef stream As System.IO.Stream, _
                             Optional prbr As ProgressBar = Nothing) As UInteger
    Dim crc As UInteger = Not CUInt(0)
    Dim buffer(BUFFER_SIZE) As Byte
    Dim readSize As Integer = BUFFER_SIZE
    Dim left As Long = stream.Length
    If Not (prbr Is Nothing) Then ' ProgressBar setup for counting down amount left.
        prbr.Maximum = 100 
        prbr.Minimum = 0 
        prbr.Value = 100
    End If
    Dim count As Integer : Do
        count = stream.Read(buffer, 0, readSize)
        For i As Integer = 0 To count - 1
            crc = (crc >> 8) Xor tbl((crc And 255) Xor buffer(i))
        Next
        If Not (prbr Is Nothing) Then ' ProgressBar updated here
            left -= count 
            prbr.Value = CInt(left * 100 \ stream.Length)
            prbr.Refresh()
        End If
    Loop While count > 0
    Return Not crc
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T22:30:33.473

在 Windows 窗体中， [BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)通常用于在另一个线程中运行密集型任务并在不阻塞界面的情况下更新进度条。 在 VB.Net 中使用 BackgroundWorker 的[示例](http://www.dreamincode.net/forums/topic/88605-the-background-worker/)

问题是当您在代码中使用表单而不实例化它`Form1.CRCWorker.ReportProgress((i / 255) * 100)`时，会发生一种隐藏的“[自动实例化](http://visualbasic.about.com/od/quicktips/qt/formasclass.htm)`Form1`”，并且每次都会创建新的实例。

# user-interface - TYPO3 - 自定义后端 UI

> ID：12065557
> 
> 赞同：0
> 
> 时间：2012-08-22T02:20:26.450
> 
> 标签：user-interface, typo3, backend

我对 TYPO3 很陌生，想知道您能否给我一个如何解决我的问题的建议。基本上，我正在尝试制作一个为 templavoila 扩展创建自定义 UI 的扩展。基本上我的问题是，如果你想自定义后端编辑表单的 BE UI，你怎么可能做到这一点？我想做的更改是在类 t3lib_TCEforms 创建的通用编辑页面的选项卡式编辑表单的左侧为某些选项添加另一个容器。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T13:42:42.193

创建一个扩展，使用 kickstarter 扩展 templavoila 扩展。在“扩展现有表格”下添加您的字段。使用生成的 tca.php 文件并为您的新选项卡和字段或您想要的东西添加一个 --DIV--。

# java - Google Eclipse 插件：自动生成的文件

> ID：12065560
> 
> 赞同：0
> 
> 时间：2012-08-22T02:20:40.180
> 
> 标签：java, google-app-engine, gwt, log4j, google-eclipse-plugin

我刚刚为 Eclipse 安装了 Google 插件，并使用**Web 应用程序项目**向导创建了一个新的 GWT/GAE 应用程序。

在它为我生成的大量文件中，三个引起了我的注意：

*   `META-INF/jdoconfig.xml`
*   `META-INF/persistence.xml`
*   `log4j.properties`

关于这两个`META-INF/*`文件，它们是什么以及它们的用途是什么？我在官方 GAE 文档中找不到对它们的任何引用。

另外，我的理解是 GAE 默认使用 JUL 进行日志记录，所以我的计划是让我的应用程序使用 SLF4J 记录日志，然后在运行时类路径中抛出`slf4j-jdk14`, `log4j-over-slf4j.jar`, and `jcl-over-slf4j.jar`（强制使用 JUL 记录所有内容，从而符合 GAE 的要求） .

为什么这个`log4j.properties`文件一开始就在那里？如果我放在`log4j-over-slf4j.jar`类路径上，我是否保证使用 log4j 的任何内容（因此通过此属性文件进行配置）最终将被桥接到 JUL？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T07:03:33.363

1.  `jdoconfig.xml`显然是一个[JDO 配置文件](https://developers.google.com/appengine/docs/java/datastore/jdo/overview-dn2#Creating_the_jdoconfig_xml_File)。

2.  `persistence.xml`是一个[JPA 配置文件](https://developers.google.com/appengine/docs/java/datastore/jpa/overview-dn2#Setting_Up_JPA_2_0)。即使您不使用 JDO/JPA，Thay 也默认存在。

3.  AFAIK，您不能强制 GAE 服务通过 SLF4J，但您可以将 slf4j 和 JUL 结合使用：[Using logback-access with Google App Engine (GAE)](https://stackoverflow.com/questions/9820164/using-logback-access-with-google-app-engine-gae)

# git - 如何将未提交的本地开发代码推送到 heroku 服务器？

> ID：12065565
> 
> 赞同：0
> 
> 时间：2012-08-22T02:21:30.743
> 
> 标签：git, heroku

目前，当我运行`git push test-server development:master`它时，它正在推送我的 github 提交代码。我想要做的是在我的分支中推送我正在本地工作的内容，`test`以便在服务器上运行测试，而无需将其提交到 github。这可能吗？如果是这样，我使用什么命令？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:46:44.570

将分支推送到 heroku 是：

```
git push heroku your_branch:master
# Where [master:branch_name] = master is heroku, branch_name is your local branch 
```

推主本身就是

```
git push heroku master 
```

* * *

* * *

例如，最近我有一个分支 -`v311`我想推送到 heroku 但既不合并（尚未）到 master 也不推送到 github，所以我使用了：

```
git push heroku v311:master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:22:22.427

这是可能的。只需将您的测试分支推送到heroku。

```
$ git push test-server test:master 
```

# regex - 在 shell 中将“20120821203354”（非定界时间戳）转换为“2012-08-21 20:33”？

> ID：12065566
> 
> 赞同：3
> 
> 时间：2012-08-22T02:21:45.513
> 
> 标签：regex, bash, time

我要拿`/home/deploy/releases/20120821203354`

并返回：

```
2012-08-21 20:33

```

基本上拿东西后`'releases/'`根据数字的位置进行拆分。

背景：OS X 10.7；将在 bash 脚本中使用。

```
/尴尬的

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T02:36:34.240

给你。

```
a=/home/deploy/releases/20120821203354                                          
b=${a#/home/deploy/releases/}                                                   
c="${b:0:4}-${b:4:2}-${b:6:2} ${b:8:2}:${b:10:2}" 
```

都是关于[shell参数扩展的](http://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html#Shell-Parameter-Expansion)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T03:02:29.647

在 OSX 中，在 bash 中，您可以`date`像在 FreeBSD 中一样使用该命令。

```
$ text="/home/deploy/releases/20120821203354"
$ date -j -f "%Y%m%d%H%M%S" "${text##*/}" '+%Y-%m-%d %H:%M'
2012-08-21 20:33 
```

请注意，`date`BSD 操作系统中的选项与 Linux 中的选项不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T02:34:17.040

您应该能够根据自己的需要进行调整：

```
echo " /home/deploy/releases/20120821203354" | awk -F/ '{print $5}' | awk '{print substr($0,0,4)"-"substr($0,5,2)"-"substr($0,7,2)" "substr($0,9,2)":"substr($0,11,2)}' 
```

# vb.net - 将图像从 My.Resources 加载到 Picturebox (VB.NET)

> ID：12065568
> 
> 赞同：2
> 
> 时间：2012-08-22T02:21:55.190
> 
> 标签：vb.net, picturebox, my.resources

我在从 My.Resources 加载图像时遇到问题。我已经试过了。像......这样的代码：

1.  `PictureBox1.Image = My.Resources.Online_lime_icon;`和

2.  `PictureBox1.Image = CType(My.Resources.ResourceManager.GetObject("Online_lime_icon"), Image)`

但它仍然会返回：

```
Picturebox1.Image = Nothing 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T02:52:35.480

尝试转换它`ToBitMap()`

```
 PictureBox1.Image = My.Resources.Online_lime_icon.ToBitmap() 
```

编辑：

@user1615710：My.Resources.Online_lime_icon 没有 .ToBitmap。它只有 .ToString。

这意味着你有`String`资源，我认为它代表`fileName`有或没有绝对路径。

尝试打印/显示的内容`My.Resources.Online_lime_icon`

```
 Debug.Print(My.Resources.Online_lime_icon) 'or
 MsgBox(My.Resources.Online_lime_icon) 
```

如果是*真实*路径，则通过以下方式加载图像，

```
 PictureBox1.Image = Image.FromFile(My.Resources.Online_lime_icon) 
```

# python - 如何使用默认属性描述符并从 __init__() 成功分配？

> ID：12065570
> 
> 赞同：3
> 
> 时间：2012-08-22T02:22:04.567
> 
> 标签：python, properties, default, propertydescriptor

请问这个的正确成语是什么？

我想定义一个包含可以（可选）从字典初始化的属性的对象（字典来自 JSON；它可能不完整）。稍后我可能会通过设置器修改属性。实际上有 13+ 属性，**我希望能够使用默认的 getters 和 setters**，但这似乎不适用于这种情况：

但我不想为所有内容编写显式描述符`prop1... propn` 另外，我想将默认分配移出`__init__()`和移入访问器......但是我需要显式描述符。

什么是最优雅的解决方案？（除了将所有 setter 调用移出`__init__()`和移入方法/类方法`_make()`？）

[删除评论 使用默认描述符的 badprop 的代码是由于以前的 SO 用户的评论，他给人的印象是它给了你一个默认的设置器。但它没有 - setter 是未定义的，它必然会抛出`AttributeError`.]

```
class DubiousPropertyExample(object):
    def __init__(self,dct=None):
        self.prop1 = 'some default'
        self.prop2 = 'other default'
        #self.badprop = 'This throws AttributeError: can\'t set attribute'
        if dct is None: dct = dict() # or use defaultdict 
        for prop,val in dct.items():
            self.__setattr__(prop,val)

    # How do I do default property descriptors? this is wrong
    #@property
    #def badprop(self): pass

    # Explicit descriptors for all properties - yukk
    @property
    def prop1(self): return self._prop1
    @prop1.setter
    def prop1(self,value): self._prop1 = value

    @property
    def prop2(self): return self._prop2
    @prop2.setter
    def prop2(self,value): self._prop2 = value

dub = DubiousPropertyExample({'prop2':'crashandburn'})

print dub.__dict__
# {'_prop2': 'crashandburn', '_prop1': 'some default'} 
```

如果你在第 5 行`self.badprop = ...`未注释的情况下运行它，它会失败：

```
self.badprop = 'This throws AttributeError: can\'t set attribute' 
```

AttributeError：无法设置属性

[和以往一样，我阅读了关于描述符、隐式描述符、从**init**调用它们的 SO 帖子]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T02:44:29.420

我认为您对属性的工作方式略有误解。没有“默认设置器”。它抛出一个`AttributeError`on 设置`badprop`不是因为它还不知道这`badprop`是一个属性而不是一个正常的属性（如果是这种情况，它只会设置没有错误的属性，因为现在这是正常的属性行为），而是因为你没有没有为 提供一个 setter `badprop`，只提供一个 getter。

看看这个：

```
>>> class Foo(object):
    @property
    def foo(self):
        return self._foo
    def __init__(self):
        self._foo = 1

>>> f = Foo()
>>> f.foo = 2

Traceback (most recent call last):
  File "<pyshell#12>", line 1, in <module>
    f.foo = 2
AttributeError: can't set attribute 
```

`__init__`在构造实例之后，即使从外部也无法设置这样的属性。如果您*只*使用`@property`，那么您所拥有的是一个只读属性（实际上是一个看起来像读取属性的方法调用）。

如果您在 getter 和 setter 中所做的只是将读/写访问重定向到同名但带有下划线的属性，那么**到目前为止**最简单的事情就是完全摆脱这些属性而只使用普通属性. Python 不是 Java（即使在 Java 中，我也不相信私有字段具有明显的公共 getter/setter 的优点）。外部世界可以直接访问的属性是您的“公共”界面中完全合理的部分。如果您后来发现在读取/写入属性时需要运行一些代码，您可以将其设置为属性**，然后**无需更改接口（这实际上是描述符最初的用途，*而不是*这样我们就可以开始为每个属性编写 Java 风格的 getter/setter）。

如果您实际上是在属性中做一些事情而不是更改属性的名称，并且您*确实*希望您的属性是只读的，那么您最好的选择可能是将初始化`__init__`视为直接使用下划线设置基础数据属性前置。然后你的类可以在没有 的情况下直接初始化`AttributeErrors`，然后属性将在读取属性时完成它们的工作。

如果您实际上是在属性中做一些事情而不是更改属性的名称，并且您希望您的属性是可读和可写的，那么您需要实际指定在获取/设置它们时会发生什么。如果每个属性都有独立的自定义行为，那么没有比为每个属性显式提供 getter 和 setter 更有效的方法了。

如果您在每个 getter/setter 中运行完全相同（或非常相似）的代码（并且不仅仅是在真实属性名称中添加下划线），这就是您反对将它们全部写出来的原因（正确如此！） ，那么通过实施一些 、 和 ，您可能会得到更好`__getattr__`的`__getattribute__`服务`__setattr__`。这些允许您每次将属性读取/写入重定向到*相同*的代码（使用属性名称作为参数），而不是每个属性的两个函数（获取/设置）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T02:36:38.653

似乎最简单的方法就是实现`__getattr__`，`__setattr__`这样他们就可以访问您解析的 JSON 字典中的任何键，您应该将其设置为实例成员。或者，您可以使用已解析的 JSON 调用`update()`，`self.__dict__`但这并不是最好的处理方式，因为这意味着您的输入 dict 可能会践踏您的实例的成员。

至于你的 setter 和 getter，你应该只在它们实际上做了一些特殊的事情而不是直接设置或检索有问题的值时才创建它们。Python 不是 Java（或 C++ 或其他任何东西），您不应该尝试模仿这些语言中常见的私有/设置/获取范式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-19T16:53:37.233

我只是将字典放在本地范围内并在那里获取/设置我的属性。

```
class test(object):
    def __init__(self,**kwargs):
        self.kwargs = kwargs
        #self.value = 20 asign from init is possible
    @property
    def value(self):
        if self.kwargs.get('value') == None:
            self.kwargs.update(value=0)#default
        return self.kwargs.get('value')
    @value.setter
    def value(self,v):
        print(v) #do something with v
        self.kwargs.update(value=v)

x = test()
print(x.value)
x.value = 10
x.value = 5 
```

* * *

**输出**

```
0
10
5 
```

# desire2learn - desire2learn 电子邮件功能 API

> ID：12065575
> 
> 赞同：0
> 
> 时间：2012-08-22T02:23:11.717
> 
> 标签：desire2learn

我正在寻找desire2learn 的电子邮件功能api，我已经阅读了所有我无法找到的api 文档。web ui 的用例是点击课程 -> 班级列表 -> 显示用户列表 -> 您可以选择用户，然后点击底部的电子邮件图标，这将打开一个用于输入电子邮件文本的窗口。

我打算通过调用 rest api 来集成这个功能。

请帮助在文档中查找 api 或确认这些 api 不可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:47:47.843

目前在 Desire2Learn 中有直接用于发送或处理电子邮件的 API。一种方法是使用 User 和 Profile api 访问地址，然后使用标准 smtp 中继发送电子邮件。

# linux - 创建 SOCK_RAW 套接字仅用于发送数据而无需任何 recvform()

> ID：12065584
> 
> 赞同：8
> 
> 时间：2012-08-22T02:25:14.543
> 
> 标签：linux, sockets, raw-sockets

如果我创建一个类型为 SOCK_RAW 的套接字仅发送一些数据而不接收任何数据，那么当内核继续接收网络数据包并将其数据报复制到某个缓冲区（应用程序？）时是否有任何问题。换句话说，在 somebuffer 被填满之后会发生什么？错误还是忽略？

我不知道如何防止内核将数据报副本传递给我的应用程序。

参考[http://sock-raw.org/papers/sock_raw](http://sock-raw.org/papers/sock_raw) 0x4 raw_input

在 IP 层处理新的传入 IP 数据报后，它调用 ip_local_deliver_finish() 内核函数，该函数负责通过检查 IP 标头的协议字段来调用已注册的传输协议处理程序（请记住上面的内容）。但是，在将数据报传递给处理程序之前，它每次都会检查应用程序是否创建了具有*相同*协议号的原始套接字。如果有一个或多个这样的应用程序，它会制作数据报的副本并将其传递给它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T15:21:17.077

您可以使用**shutdown(2)**来关闭套接字的接收部分。请参阅[关机手册页](http://linux.die.net/man/2/shutdown)

**编辑：**我发现**关闭**只适用于连接的（即 TCP）套接字。使用原始套接字，有两种可能性：

*   将数据接收到临时缓冲区（使用**recv**）并丢弃它们（可能在另一个线程中）
*   如果我没记错的话，当套接字缓冲区已满时，传入的数据会被自动丢弃（并且缓冲区中的数据不会被修改），因此您可以将套接字接收缓冲区大小设置为 0（如果需要，稍后再增加）。

以下是将接收缓冲区大小设置为 0 的方法：

```
int opt = 0;
setsockopt(sock_fd, SOL_SOCKET, SO_RCVBUF, &opt, sizeof(opt)); 
```

**测试**

```
/**
 * @file raw_print_pkt.c
 * @brief 
 * @author Airead Fan <fgh1987168@gmail.com>
 * @date 2012/08/22 12:35:22
 */

#include <stdio.h> 
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <sys/ioctl.h>
#include <netinet/ip.h>
#include <netinet/tcp.h>

int main(int argc, char *argv[])
{
    int s;
    ssize_t rn;                 /* receive number */
    struct sockaddr_in saddr;
    char packet[4096];
    int count;

    if ((s = socket(AF_INET, SOCK_RAW, IPPROTO_TCP)) < 0) {
        perror("error:");
        exit(EXIT_FAILURE);
    }

    memset(packet, 0, sizeof(packet));
    socklen_t *len = (socklen_t *)sizeof(saddr);
    int fromlen = sizeof(saddr);
    int opt = 0;

    count = 0;
    while(1) {
        if ((rn = recvfrom(s, (char *)&packet, sizeof(packet), 0,
                           (struct sockaddr *)&saddr, &fromlen)) < 0)
            perror("packet receive error:");
        if (rn == 0) {
            printf("the peer has performed an orderly shutdown\n");
            break;
        }

        printf("[%d] rn = %lu \n", count++, rn);

        if (count == 16) {
            if (setsockopt(s, SOL_SOCKET, SO_RCVBUF, &opt, sizeof(opt)) < 0) {
                perror("setsocketopt failed");
            } else {
                fprintf(stdout, "setsocketopt successful\n");
            }
            // int shutdown(int sockfd, int how);
            /* if (shutdown(s, SHUT_RD) < 0) {
             *     perror("shutdown failed");
             * } */
        }
    }

    return 0;
} 
```

**测试 2（同样包括）：**

```
int main(int argc, char *argv[])
{
int s;
ssize_t rn;                 /* receive number */
char packet[4096];
int count;

if ((s = socket(AF_INET, SOCK_RAW, IPPROTO_TCP)) < 0) {
    perror("error:");
    exit(EXIT_FAILURE);
}

memset(packet, 0, sizeof(packet));
int opt = 0;
count = 0;

//Set recv buffer size
if (setsockopt(s, SOL_SOCKET, SO_RCVBUF, &opt, sizeof(opt)) < 0) {
    perror("setsocketopt failed");
} else {
    fprintf(stdout, "setsocketopt successful\n");
}

//10 seconds countdown
int i = 10;
while(i > 0)
{
    printf("\r%d              ", i);
    fflush(stdout);
    i--;
    sleep(1);
}
printf("\n");
while(1) {
    if ((rn = recv(s, (char *)&packet, sizeof(packet), 0)) <= 0)
        perror("packet receive error:");

    printf("[%d] rn = %lu \n", count++, rn);
    }
return 0;
} 
```

以下是如何进行测试 2：

首先，将缓冲区大小设置为 4096（如果网络上有大量流量，则设置更大）。编译并启动。在开始接收数据前的 10 秒内，向套接字发送大量数据。10 秒后，程序将收到您在倒计时期间发送的所有内容。

之后，将缓冲区大小设置为 0。像以前一样继续。10 秒后，程序将不会收到您在倒计时期间发送的数据。但是，如果您在**recvfrom**中发送数据，它将正常读取它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T11:29:11.800

我真的不明白你想要什么！如果您只想注入一些数据包，这很简单：

```
#include<netinet/tcp.h> /* TCP header */
#include<netinet/ip.h>  /* IP header */

/* Checksum compute function */
/* source : http://www.winpcap.org/pipermail/winpcap-users/2007-July/001984.html */
unsigned short checksum(unsigned short *buffer, int size)
{
    unsigned long cksum=0;
    while(size >1)
    {
        cksum+=*buffer++;
        size -=sizeof(unsigned short);
    }
    if(size)
        cksum += *(UCHAR*)buffer;

    cksum = (cksum >> 16) + (cksum & 0xffff);
    cksum += (cksum >>16);
    return (unsigned short)(~cksum);
}

int main (int argc, char **argv)
{
    char packet_buffer[BUFFER_SIZE];
    struct sockaddr_in sin;     
    struct iphdr *ip_header;    /* IP header */
    struct tcphdr *tcp_header;  /* TCP header */
    int flag = 1;

    /* Creating RAW socket */
    int raw_socket = socket (PF_INET, SOCK_RAW, IPPROTO_TCP);

    ip_header = (struct iphdr *) packet_buffer;

    tcp_header = (struct tcphdr *) (packet_buffer + sizeof (struct ip));

    sin.sin_family = AF_INET;
    sin.sin_port = htons(PORT_NUMBER);
    sin.sin_addr.s_addr = inet_addr (IP_ADDRESS);

    /* Zeroing the bbuffer */ 
    memset (packet_buffer, 0, BUFFER_SIZE);

    /* Construct your IP Header */
    ip_header->ihl = 5;
    ip_header->version = 4;
    ip_header->tos = 0;
    ip_header->tot_len = sizeof (struct ip) + sizeof (struct tcphdr);
    ip_header->id = htonl(CHOOSE_PACKET_ID);
    ip_header->frag_off = 0;
    ip_header->ttl = 255;
    ip_header->protocol = 6;    /* TCP. Change to 17 if you want UDP */
    ip_header->check = 0;
    ip_header->saddr = inet_addr (SOURCE_IP_ADDRESS_TO_SPOOF);
    ip_header->daddr = sin.sin_addr.s_addr;

    /* Construct your TCP Header */
    tcp_header->source = htons (SOURCE);
    tcp_header->dest = htons(DEST);
    tcp_header->seq = random();
    tcp_header->ack_seq = 0;
    tcp_header->doff = 0;
    tcp_header->syn = 1; 
    tcp_header->window = htonl(65535);
    tcp_header->check = 0;
    tcp_header->urg_ptr = 0;

    /* IP Checksum */
    ip_header->check = checksum((unsigned short *) packet_buffer, ip_header->tot_len >> 1);

    if (setsockopt(raw_socket, IPPROTO_IP, IP_HDRINCL, &flag, sizeof(flag)) < 0)
    {
        /* ERROR handling */
    }

    while (1)
    {
        /* Send the packet */
    if (sendto(raw_socket, packet_buffer, ip_header->tot_len, 0,  (struct sockaddr *) &sin, sizeof (sin)) < 0)
    {
        /* ERROR handling */
    }
    /* The rest of your need */
 }

 return 0;
} 
```

# c# - Windows 8 Metro 检查文件是否存在

> ID：12065590
> 
> 赞同：1
> 
> 时间：2012-08-22T02:26:02.407
> 
> 标签：c#, windows-8, microsoft-metro

我正在尝试编写一个例程来检查应用程序包中是否存在文件。在阅读了很多关于该主题的内容后，很明显 MS 忘记在 API 中放置一个 FileExists 函数（无论是否有意），但这是我目前所处的位置......

```
 public async Task<bool> CheckFile(string filePath)
    {
        bool found = false;
        try
        {
            Windows.ApplicationModel.Package package = Windows.ApplicationModel.Package.Current;
            Windows.Storage.StorageFolder installedLocation = package.InstalledLocation;
            StorageFile file = await installedLocation.GetFileAsync("Assets\\" + filePath); 
            found = true;
        }
        catch (System.IO.FileNotFoundException ex)
        {
            found = false;
        }
        return found;
    } 
```

然后从以下位置调用：

```
 private ImageSource _image = null;
    private String _imagePath = null;
    public ImageSource Image
    {
        get
        {
            if (this._image == null && this._imagePath != null)
            {
                Task<bool> fileExists = CheckFile(this._imagePath);
                bool filefound = fileExists.Result;

                string realPath = string.Empty;
                if (filefound)
                {
                    Windows.ApplicationModel.Package package = Windows.ApplicationModel.Package.Current;
                    Windows.Storage.StorageFolder installedLocation = package.InstalledLocation;
                    realPath = installedLocation + "Assets\\" + this._imagePath;
                }
                else
                {
                    realPath = "http://<<my url>>/images/" + this._imagePath;
                }
                this._image = new BitmapImage(new Uri(realPath));
            }
            return this._image;
        }

        set
        {
            this._imagePath = null;
            this.SetProperty(ref this._image, value);
        }
    } 
```

所以基本上它是检查本地是否存在图像，如果不存在则从我的网站获取它。

对于第一张图片来说，这一切似乎都很好，但是当它“返回 this._image;”时 对于第二张图片，一切都冻结了......

我只是不确定这里到底发生了什么..

有什么帮助吗？

干杯院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:30:23.247

检查文件然后尝试打开该文件是一种竞争条件。也就是说，可以在检查存在和打开之间删除文件。所以，你不应该那样做。您从 GetFile 中捕获 GetFileAsync 异常是正确的，但您应该捕获[FileNotFoundException](http://msdn.microsoft.com/en-us/library/windows/apps/system.io.filenotfoundexception.aspx)然后您知道该文件不存在。

但是，您的 CheckFile 代码做了一些有趣的事情。您有一个内部 try-catch 块，它将吞噬所有异常，显示一个消息框，然后设置 found = true ，无论 try 块中发生什么。我不认为那是你想要的。此外，周围的 try-catch 块不是必需的，因为只有在创建新的 MessageDialog 或 ShowAsync 引发异常时才会命中它——即当你将 found 设置为 false 时——这不是我认为你想要的。

# java - Google Eclipse 插件：App Engine ORM 增强？

> ID：12065591
> 
> 赞同：0
> 
> 时间：2012-08-22T02:26:08.370
> 
> 标签：java, google-app-engine, gwt, orm, google-eclipse-plugin

我刚刚安装了 Google Plugin for Eclipse 并使用内置向导创建了我的第一个 Web 应用程序项目。转到`MyProject >> Properties >> Google >> App Engine >> ORM`我看到一个列表框和一段文本，内容如下：

> 增强以下类以供 ORM 使用：

在线搜索此内容，我能找到的唯一文档指出，使用 JDO（DataNucleus）的 GAE 需要编译后“增强”（我*认为*这意味着字节码生成？！？），并且此对话框使您能够指定哪些类得到“增强”？

*   仍然对这种“增强”的东西是什么以及为什么它是必要的感到困惑
*   对我想选择哪些类进行增强感到困惑
*   另外，我*假设*这种增强只发生在从 Eclipse 内部构建/部署我的应用程序时，我如何从我的 Ant 构建中访问这个“增强”功能？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T06:44:18.100

1.  [JDO 类增强](http://db.apache.org/jdo/enhancement.html)使数据类能够检测“脏”字段，即自上次加载数据以来已更改的字段。这需要有效地决定哪些对象需要保存。

2.  [JDO 数据类](https://developers.google.com/appengine/docs/java/datastore/jdo/dataclasses)，例如映射到数据库中数据的那些。

3.  GAE SDK 包含几个与 GAE 开发相关的 ant 任务，其中[一个是做 JDO 增强。](https://developers.google.com/appengine/docs/java/tools/ant#Enhancing_JDO_Classes)

# ruby-on-rails-3 - Rails 与 Ransack 的排序关联

> ID：12065592
> 
> 赞同：13
> 
> 时间：2012-08-22T02:26:18.223
> 
> 标签：ruby-on-rails-3, sorting, ransack

第一次海报。我正在尝试使用 Ransack gem 和 Kaminari 对用户表进行排序以进行分页。当我使用名称、ID 等时，排序有效，但当我尝试与posts_count 关联时，排序中断并且不起作用。注意：在视图中，'u.posts.count' 工作正常。我已经在用户模型中尝试了自定义范围，并为搜索参数创建了自定义对象，但似乎没有任何效果。我认为我在默认范围或@search 对象没有数据时遇到了问题。需要帮忙！

以下是一些相关的片段：

**模型/用户.rb**

```
 has_many :posts, :dependent => :destroy 
```

**模型/post.rb**

```
 belongs_to :user 

  default_scope :order => 'post.created_at DESC' 
```

**控制器/users_controller.rb**

```
 def index
    @title = "User Index"
    @search = User.search(params[:q]) # Ransack
    @total_users = User.all.count
    # .per(10) is the per page for pagination (Kaminari).
    @users = @search.result.order("updated_at DESC").page(params[:page]).per(10) #This displays the users that are in the search criteria, paginated.
  end 
```

**意见/用户/index.html.erb**

```
 ..
  <%= sort_link @search, :posts_count, "No. of Posts" %> #Sort links at column headers
  .. 
  <% @users.each do |u| %> #Display everything in the table
    <%= u.posts.count %>
  <% end %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T07:55:15.390

您可以为`User`模型添加范围：

```
def self.with_posts
  joins(:posts).group('posts.id').select('users.*, count(posts.id) as posts_count')
end 
```

并像这样使用它：

```
@search = User.with_posts.search(params[:q]) # Ransack 
```

然后，您可以`posts_count`像对待任何其他属性一样对待。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-09T04:29:01.957

我找到了一个解决方案：

**控制器：**

```
def index
    sql = "users.*, (select count(posts.id) from posts\
    where posts.user_id = users.id) as count"
    @search = User.select(sql).search(params[:q])

    if params[:q] && params[:q][:s].include?('count')
      @users = @search.result.order(params[:q][:s])
    else
      @users = @search.result
    end
    .......
end 
```

**看法：**

```
<th><%= sort_link @search, :count, "posts count" %></th> 
```

# sql-server-2008 - 逗号分隔的结果集 + SQL 查询

> ID：12065594
> 
> 赞同：2
> 
> 时间：2012-08-22T02:26:51.787
> 
> 标签：sql-server-2008, tsql, sql-server-2008-r2, for-xml-path

我得到了两个数据表，如下所示：

表 1：学生

![在此处输入图像描述](../Images/b037f8764ef7271c00fbf100a3b0df6a.png)

表 2：主题

![在此处输入图像描述](../Images/0cdba39c97d906d72fa3a2c9382196c1.png)

我需要输出为：

![在此处输入图像描述](../Images/28d8f95542a2fe4e4bcd3b95baecb4a2.png)

我通过使用 XML PATH 的以下查询实现了这一点

代码：

```
WITH    cte
      AS ( SELECT   Stu.Student_Id ,
                    Stu.Student_Name ,
                    ( SELECT    Sub.[Subject] + ','
                      FROM      [Subject] AS Sub
                      WHERE     Sub.Student_Id = Stu.Student_Id
                      ORDER BY  Sub.[Subject]
                    FOR
                      XML PATH('')
                    ) AS [Subjects]
           FROM     dbo.Student AS Stu
         )
SELECT  Student_id [Student Id] ,
        student_name [Student Name] ,
        SUBSTRING(Subjects, 1, ( LEN(Subjects) - 1 )) AS [Student Subjects]
FROM    cte 
```

我的问题是不使用 XML Path 有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:36:55.617

这是一种非常好的方法，并且已被广泛接受。有几种方法，这篇[博](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/#_Toc205129495)文描述**了很多**方法。

存在的一种有趣的方法是使用 CLR 为您完成工作，这将通过权衡运行外部代码显着降低查询的复杂性。这是该类在程序集中的外观示例。

```
using System;
using System.Collections.Generic;
using System.Data.SqlTypes;
using System.IO;
using Microsoft.SqlServer.Server;

[Serializable]
[SqlUserDefinedAggregate(Format.UserDefined,  MaxByteSize=8000)]
public struct strconcat : IBinarySerialize{

    private List values;

    public void Init()    {
        this.values = new List();
    }

    public void Accumulate(SqlString value)    {
        this.values.Add(value.Value);
    }

    public void Merge(strconcat value)    {
        this.values.AddRange(value.values.ToArray());
    }

    public SqlString Terminate()    {
        return new SqlString(string.Join(", ", this.values.ToArray()));
    }

    public void Read(BinaryReader r)    {
        int itemCount = r.ReadInt32();
        this.values = new List(itemCount);
        for (int i = 0; i <= itemCount - 1; i++)    {
            this.values.Add(r.ReadString());
        }
    }

    public void Write(BinaryWriter w)    {
        w.Write(this.values.Count);
        foreach (string s in this.values)      {
            w.Write(s);
        }
    }
} 
```

这将使查询更像这样。

```
SELECT CategoryId,
           dbo.strconcat(ProductName)
      FROM Products
     GROUP BY CategoryId ; 
```

这显然要简单得多。把它当作它的价值:)

再会！

# codeigniter - 如何在 php-activerecord 中大量删除 id 不在列表中的位置？

> ID：12065596
> 
> 赞同：0
> 
> 时间：2012-08-22T02:27:26.607
> 
> 标签：codeigniter, codeigniter-2

我正在运行安装了 PHP-Activerecord 的 CodeIgniter 应用程序，我需要进行大量删除。PHP-AR 库支持海量更新和删除，但该函数只获取您要删除/更新的 id。我正在尝试进行大规模删除，其中 id 不在列表中。

> 从 id 不在 (1,2,3...,500) 中的表中删除

不幸的是，PHP-Activerecord 网站没有任何帮助，而且他们的论坛构建得非常糟糕（没有搜索......认真吗？）我真的被卡住了。

**编辑：**请注意，**CodeIgniter 的内置 ORM 与 PHP-Activerecord 不同。** 只是想我会澄清这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-06T16:57:47.137

有点晚了，但这可能对其他人有帮助。在**PHPActiveRecord**中，这样做：

```
$ids_to_delete = array(1,2,3);
YourModel::delete_all(array('conditions' => array('id NOT IN (?)', $ids_to_delete))); 
```

参考：[http ://www.phpactiverecord.org/docs/ActiveRecord/Model#methoddelete_all](http://www.phpactiverecord.org/docs/ActiveRecord/Model#methoddelete_all)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T03:02:26.753

既然活动记录实际上是使用函数构建字符串查询，您可以使用此方法： - 将列表设为字符串 - 进行此查询：$this->db->where('id not in',$string)->delete( '桌子'）

# c# - 无法加载 DLL 'fbembed'

> ID：12065598
> 
> 赞同：3
> 
> 时间：2012-08-22T02:27:42.390
> 
> 标签：c#, asp.net, .net, dll, firebird

即使我有 dat dll 并且如果通过引用添加，我也无法加载 ddl 它正在显示

> 无法添加对“Path\fbembed.dll”的引用。请确保该文件是可访问的，并且该文件是有效的程序集或 COM 组件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T08:41:05.327

一个单独的 fbembed.dll 是不够的。最小的文件集包括：

```
icudt30.dll
icuin30.dll
icuuc30.dll
fbembed.dll                   
Microsoft.VC80.CRT.manifest
firebird.msg                               
msvcp80.dll
msvcr80.dll
ib_util.dll                   
Intl\fbintl.dll     (Intl -- it is a subdirectory) 
```

从 FB2.5 分发版中获取它们并放在您的可执行文件附近。

如果您的数据库使用自定义 UDF，您还需要在 UDF 子目录中放置适当的 DLL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:56:23.680

您必须将 fbmebed.dll 放在应用程序路径中。对于 ASP.NET 应用程序，最好将其放入系统文件夹中。另请参阅[http://web.firebirdsql.org/dotnetfirebird/blog/2005/11/how-to-use-embedded-firebird-in-aspnet.html](http://web.firebirdsql.org/dotnetfirebird/blog/2005/11/how-to-use-embedded-firebird-in-aspnet.html)

# excel - VBA 替换错误 - 字符串被视为公式

> ID：12065601
> 
> 赞同：3
> 
> 时间：2012-08-22T02:28:12.443
> 
> 标签：excel, vba, replace

我正在尝试通过将所有实例“<br />”替换为单个空格（“”）来清理非常大的 Excel 电子表格中包含的一些文本。我尝试了两种方法：使用 Excel 中的普通查找/替换所有选项，以及使用这个非常简单的 VBA 宏：

```
Sub CleanUp()
    Application.Cells.Replace What:="<br />", Replacement:=Chr(32), LookAt:=xlPart
End Sub 
```

在这两种情况下，我都会收到一条错误消息，指出：*“您键入的公式包含错误。有关修复常见公式问题的信息，请单击帮助。要获得输入函数的帮助，请单击函数向导（公式选项卡，函数库组)。如果您不尝试输入公式，请避免使用等号 (=) 或减号 (-)，或在其前面加上单引号 (')。"*

当然，我不是要输入公式。但是，按照 Excel 的建议，在“<br />”前面加上单引号并不能解决问题。

即使我的搜索字符串不包含任何通配符（据我所知），我也尝试在宏中使用文字字符，看看是否有帮助。它不能解决问题，但无论如何这里是代码：

```
Sub CleanUp()
  Dim SearchFor As String
  SearchFor = Chr$(60) & "br" & Chr$(32) & Chr$(47) & Chr$(62)
    Application.Cells.Replace What:=SearchFor, Replacement:=Chr$(32), LookAt:=xlPart
End Sub 
```

有用的事实：

*   我可以使用普通的查找/替换方法和 VBA 宏轻松地查找和替换此电子表格中的其他字符串。
*   我有其他类似的电子表格，可以在其中查找和替换“<br />”。
*   在我朋友的计算机上，可以使用这两种方法查找和替换“<br />”的所有实例。

有谁知道为什么会这样？它与我的 Excel 设置有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T11:06:18.643

你有没有尝试过：

```
Cells.Replace What:="<br/>", Replacement:=" ", LookAt:=xlPart, _
SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
ReplaceFormat:=False 
```

# android - getContentResolver 查询导致 CursorWrapperInner 警告

> ID：12065606
> 
> 赞同：6
> 
> 时间：2012-08-22T02:28:38.177
> 
> 标签：android, warnings, android-cursor

在 4.0.3 上，以下代码会导致警告“W/CursorWrapperInner(11252): Cursor finalized without prior close()”。

```
 Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(number));
    getContentResolver().query(uri, null, null, null, null); 
```

在sorce，我发现它来自哪里的警告，有人告诉我如何避免，因为我怀疑它与一些奇怪的问题有关？

![在此处输入图像描述](../Images/daa58cc6dadad317fb36df58962eb2c6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T07:02:13.913

我也遇到过这个奇怪的问题。我正在使用 ContentProvider 为我提供 Cursor 和 CursorLoader 来处理我的 Fragment/Activity 中的获取。所以我正在“为书”做所有事情。

我在使用 4.1.1 设备时遇到了此警告消息，但它似乎在我的 Nexus 7（即 4.2）上消失了。就我个人而言，我不会认真注意这个警告。

更新：我正在使用 Android v2.2 测试我的代码，我从这个错误中得到了完整的堆栈跟踪。事实证明，我的代码正在获取另一个游标（不是使用加载器获取的游标），这就是有问题的代码。手动关闭它就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T02:10:45.880

这行代码返回一个 Cursor 对象：

```
getContentResolver().query(uri, null, null, null, null); 
```

您正在执行查询但忽略结果，这很奇怪。执行查询的唯一目的是在游标中获取结果。您应该将其存储到一个变量中，如下所示：

```
Cursor cursor = getContentResolver().query(uri, null, null, null, null); 
```

然后，您可以使用光标获取所需的任何数据，并在完成后调用：

```
cursor.close(); 
```

您可以关闭或更早关闭光标`Activity#onDestroy()`，但您必须在 Activity 完全完成之前关闭它，否则您将看到此警告。这是因为 Cursor 由另一个进程中的内存支持，并且您不想泄漏该内存。

# r - 使用 lapply 制作表格

> ID：12065607
> 
> 赞同：2
> 
> 时间：2012-08-22T02:28:38.850
> 
> 标签：r, apply

我有一个非常基本的问题，更有经验的编码人员可能很容易回答。
我有几列数据。`x1`我已经通过将它们变成了向量`x9`。
我按如下方式运行表函数：

```
table(x1,x2) 
```

**我的问题是：**

我怎样才能使我有一组表，例如：`table(x1,x2)`，等`table(x1,x3)`，`table(x1,x4)`而无需重复输入表函数（或我正在使用的任何函数；我还需要制作条形图）？我怀疑这涉及一个应用功能，但我一直无法让它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T02:36:22.913

您可以`lapply`按如下方式使用：

```
# First, some sample data
set.seed(1)
yo = data.frame(x1 = sample(letters[1:5], 20, replace=TRUE),
                x2 = sample(0:2, 20, replace=TRUE),
                x3 = sample(0:2, 20, replace=TRUE),
                x4 = sample(0:2, 20, replace=TRUE))
lapply(2:ncol(yo), function(x) table(yo[, 1], yo[, x])) 
```

要获取条形图，您可以保存该输出并一起使用`lapply`and `barplot`，或者您可以执行以下操作：

```
par(mfrow = c(3, 1)) # To plot them all at once...
lapply(2:ncol(yo), function(x) barplot(table(yo[, 1], yo[, x]), 
                                       beside=TRUE, legend=TRUE)) 
```

这是一个示例图。如果需要，可以进行更多自定义以“美化”。

![在此处输入图像描述](../Images/604700692b1b4490167b6968987b4137.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T02:55:57.053

只需使用 lapply 将列表的元素串行传递给函数。使用 mrdwab 的向量`table`：

```
x1 = sample(letters[1:5], 20, replace=TRUE)
x2 = sample(0:2, 20, replace=TRUE)
x3 = sample(0:2, 20, replace=TRUE)
x4 = sample(0:2, 20, replace=TRUE)

lapply(list(x2,x3,x4), table, x1)
[[1]]
   x1
    a b c d e
  0 0 1 2 2 2
  1 1 1 0 2 0
  2 4 2 1 1 1

[[2]]
   x1
    a b c d e
  0 1 2 1 2 1
  1 3 0 0 2 2
  2 1 2 2 1 0

[[3]]
   x1
    a b c d e
  0 2 2 0 3 3
  1 2 2 2 0 0
  2 1 0 1 2 0 
```

Barplot 不适用于字符向量，因此对于 ttmaccer 的向量，同样的方法也适用：

```
X1<-1:10
X2<-2:11
X3<-3:12
X4<-4:13
lapply(list(X1,X2,X3,X4), barplot) 
```

# c# - 是否可以使用交替的垂直列填充 DataGridView？

> ID：12065611
> 
> 赞同：3
> 
> 时间：2012-08-22T02:29:04.183
> 
> 标签：c#, winforms, data-binding, datagridview, tablelayoutpanel

我需要显示混合“硬编码”字符串和来自数据库的数据的数据。具体来说，每个偶数列都包含不是来自数据库的字符串值，每个奇数列都包含数据。因此，例如，第 1 列将包含数据库中的值 1 到 12，因此前两列看起来像这样（并且相同的模式重复多次）：

```
00:00    BoundVal1
00:15    BoundVal2
. . .
02:45    BoundVal12 
```

这可能吗？

现在我正在为此使用 TableLayoutPanel，但它的编码有点花哨（不是 Steely Dan 参考）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T11:16:00.090

您可以只构建一个 DataTable 对象并将其设置为 DataGridView 的 DataSource。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:23:48.740

我终于得到了这个工作，基于来自[http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/ca89a857-6e17-44a7-8cdb-90d64a0a7bbe的 Mohamed Mansour 的代码](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/ca89a857-6e17-44a7-8cdb-90d64a0a7bbe)

```
int RowCount = 12; 
Dictionary<int, string> PlatypusPairs;

. . .

private void button3_Click(object sender, EventArgs e) {
    // Retrieve data as dictionary 
    PlatypusPairs = InterpSchedData.GetAvailableForPlatypusAndDate(oracleConnectionTestForm, 42, DateTime.Today.Date);
    int ColumnCount = 16;
    // Add the needed columns
    for (int i = 0; i < ColumnCount; i++) {
        string colName = string.Format("Column{0}", i + 1);
        dataGridView1.Columns.Add(colName, colName); 
    }

    for (int row = 0; row < RowCount; row++) {
        // Save each row as an array
        string[] currentRowContents = new string[ColumnCount];
        // Add each column to the currentColumn
        for (int col = 0; col < ColumnCount; col++) {
            currentRowContents[col] = GetValForCell(row, col);
        }
        // Add the row to the DGV
        dataGridView1.Rows.Add(currentRowContents);
    }
}

private string GetValForCell(int Row, int Col) {
    string retVal;

    if (Col % 2 == 0) {
        retVal = GetTimeStringForCell(Row, Col);
    } else {
        retVal = GetPlatypusStringForCell(Row, Col);
    }
    return retVal;
}

private string GetTimeStringForCell(int Row, int Col) {
    const int TIME_INCREMENT_STEP = 15;
    var dt = new DateTime(DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day, 0, 0, 0);
    dt = dt.AddMinutes(((Col * (RowCount / 2)) + Row) * TIME_INCREMENT_STEP);
    return dt.ToString("HH:mm");
}

private string GetPlatypusStringForCell(int Row, int Col) {
    int multiplicand = Col / 2;
    string val = string.Empty;
    int ValToSearchFor = (multiplicand * RowCount) + (Row + 1);
    if (PlatypusPairs.ContainsKey(ValToSearchFor)) {
        PlatypusPairs.TryGetValue(ValToSearchFor, out val);
        if (val.Equals(0)) {
            val = string.Empty;
        }
    }
    return val;
} 
```

# excel - microsoft excel 上的必填字段验证

> ID：12065612
> 
> 赞同：0
> 
> 时间：2012-08-22T02:29:13.920
> 
> 标签：excel, excel-2007, excel-2003, vba

我在 excel（2003/2007）中有 5 列（SNO、姓名、电话、地址、密码）。
Excel 可以有“n”号。的记录。
我想应用验证，这样，当我们保存 Excel 表时，“SNO”（包含整数值）列的值永远不应为空，当任何一个（名称、电话、地址、引脚）列具有值时。
如果不是这种情况，则应该出现错误消息。
我正在手动输入数据。
我试过了：
编辑：

```
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    If Worksheets("Sheet1").Range("SNO").Value = "" Then
        MsgBox "You must fill in SNO."
        Cancel = True
    End If
End Sub 
```

我们可以在不编写代码的情况下应用验证吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:42:23.430

据我所知，VBA 是最好的（唯一的？）方法。

尝试

```
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Dim rng As Range
    Dim rw As Range
    Dim dat As Variant

    ' change to your sheet name
    With Worksheets("Sheet4")
        ' Get data range to check
        ' Assumes SNO is column A and Name etc is Column B to E
        Set rng = .Range(.UsedRange.Columns(1), .UsedRange.Columns(5))
        For Each rw In rng.Rows
            ' If SNO cell is empty
            If rw.Cells(1, 1) = "" Then
                ' Check if other cells are not blank
                dat = Join(Application.Transpose(Application.Transpose(rw.Value)))
                If dat <> "" Then
                    MsgBox "You must fill in SNO."
                    Cancel = True
                    Exit For
                End If
            End If
        Next
    End With
End Sub 
```

# c# - 如何在给定索引和长度的情况下选择 RichTextBox 文本

> ID：12065616
> 
> 赞同：11
> 
> 时间：2012-08-22T02:29:27.417
> 
> 标签：c#, .net, wpf, richtextbox

如果只给你一个特定文本的索引和长度（或 EndIndex）来选择，你如何在 WPF 版本的 RichTextBox 中执行此操作？

这在 Textbox 中非常可行，因为您可以调用 Textbox.Select(startIndex,Length) 但我在 RTB 中看不到任何等效项。

编辑：我找到了选择的答案

```
internal string Select(RichTextBox rtb, int index, int length)
        {
            TextRange textRange = new TextRange(rtb.Document.ContentStart, rtb.Document.ContentEnd);

            if (textRange.Text.Length >= (index + length))
            {
                TextPointer start = textRange.Start.GetPositionAtOffset(index, LogicalDirection.Forward);
                TextPointer end = textRange.Start.GetPositionAtOffset(index + length, LogicalDirection.Backward);
                rtb.Selection.Select(start, end);
            }
            return rtb.Selection.Text;
        } 
```

但是，当我在选择后尝试突出显示该行时：

```
rtb.Selection.ApplyPropertyValue(TextElement.BackgroundProperty, new SolidColorBrush(Colors.LightBlue)); 
```

突出显示功能仅在第一次尝试时有效，在第二次尝试后中断。有谁知道这是什么原因？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-31T12:46:25.447

好的，这个问题很老，但我终于找到了答案，所以我把它放在这里。

当我尝试使用 RichTextBox 制作一些 Syntaxhighlighter 时，我遇到了类似的问题。我发现，当您使用 ApplyPropertyValue 玩**arround**时，您不能再简单地使用**GetPositionAtOffset**。我相信应用 propertyvalues 似乎改变了 TextTokens 在 Document 中的“内部位置”，因此“制动”了这个功能。

解决方法：

每次您需要使用**GetPositionAtOffset 时**，首先在文档的完整 TextRange 上调用**ClearAllProperties ，然后使用****ApplyPropertyValue**重新应用所有属性，但这次**是从右到左**。（右表示最高偏移）

我不知道您是否应用了任何 PropertyValues 期望选择突出显示，因此您可能需要在其中进行更多思考。

这是我的代码在导致问题时的样子：

```
 private void _highlightTokens(FlowDocument document)
    {
        TextRange fullRange = new TextRange(document.ContentStart, document.ContentEnd);
        foreach (Token token in _tokenizer.GetTokens(fullRange.Text))
        {
            TextPointer start = fullRange.Start.GetPositionAtOffset(token.Position);
            TextPointer end = start.GetPositionAtOffset(token.Length);

            TextRange range = new TextRange(start, end);
            range.ApplyPropertyValue(TextElement.ForegroundProperty, _getTokenColor(token));
        }
    } 
```

我像这样修复它：

```
 private void _highlightTokens(FlowDocument document)
    {
        TextRange fullRange = new TextRange(document.ContentStart, document.ContentEnd);
        fullRange.ClearAllProperties(); // NOTICE: first remove allProperties.
        foreach (Token token in _tokenizer.GetTokens(fullRange.Text).Reverse()) // NOTICE: Reverse() to make the "right to left" work
        {
            TextPointer start = fullRange.Start.GetPositionAtOffset(token.Position);
            TextPointer end = start.GetPositionAtOffset(token.Length);

            TextRange range = new TextRange(start, end);
            range.ApplyPropertyValue(TextElement.ForegroundProperty, _getTokenColor(token));
        }
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-22T02:48:44.313

[对RichTextBox.Selection](http://msdn.microsoft.com/en-us/library/system.windows.controls.richtextbox.selection.aspx)属性使用[Select()](http://msdn.microsoft.com/en-us/library/system.windows.documents.textrange.select.aspx)方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-12-19T21:01:09.450

> Blockquote你可以得到空格之间的文字.....

私有字符串 RichWordOver(RichTextBox rch, int x, int y) {

```
 int pos = rch.GetCharIndexFromPosition(new Point(x, y));
        if (pos <= 0) return "";

        string txt = rch.Text;

        int start_pos;
        for (start_pos = pos; start_pos >= 0; start_pos--)
        {

            char ch = txt[start_pos];
            if (!char.IsLetterOrDigit(ch) && !(ch=='_')) break;
        }
        start_pos++;
        int end_pos;
        for (end_pos = pos; end_pos < txt.Length; end_pos++)
        {
            char ch = txt[end_pos];
            if (!char.IsLetterOrDigit(ch) && !(ch == '_')) break;
        }
        end_pos--;

        if (start_pos > end_pos) return "";
        return txt.Substring(start_pos, end_pos - start_pos + 1);
    } 
```

private void rchText_MouseClick(object sender, MouseEventArgs e) { MessageBox.Show(RichWordOver(rchText, eX, eY)); }

# macos - 使用 NSMediaQueries 和沙盒

> ID：12065617
> 
> 赞同：0
> 
> 时间：2012-08-22T02:30:01.647
> 
> 标签：macos, cocoa, sandbox, nsurl

我正在使用 NSMediaQueries 来检测已拍摄的新屏幕截图。但是要将我的应用程序推送到商店，我需要将其沙盒化。

不幸的是，沙盒破坏了我的 NSMediaQueries，因为我无法访问返回的 URL。

我知道 Cloud App 是沙盒的，并且能够获取最新的屏幕截图。

有没有人知道如何解决这个问题？

谢谢。

代码摘录：

```
query = [[NSMetadataQuery alloc] init];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(queryUpdated:) name:NSMetadataQueryDidStartGatheringNotification object:query];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(queryUpdated:) name:NSMetadataQueryDidUpdateNotification object:query];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(queryUpdated:) name:NSMetadataQueryDidFinishGatheringNotification object:query];

[query setDelegate:self];
[query setPredicate:[NSPredicate predicateWithFormat:@"kMDItemIsScreenCapture = 1"]];
[query startQuery]; 
```

* * *

```
numberOfScreenshots = [query resultCount];
[self uploadToAmazonS3:[[[query results]objectAtIndex:([query resultCount]-1)]valueForAttribute:NSMetadataItemURLKey]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T19:26:21.903

我与苹果进行了讨论。事实证明，如果您无权访问该文件夹，则 URL 将只是`nil`.

# php - 如何限制使用会话下载的文件数

> ID：12065625
> 
> 赞同：0
> 
> 时间：2012-08-22T02:31:06.560
> 
> 标签：php, mysql, session

我一直在使用数据库实现来限制我的服务器上一次只能下载一次。这很容易出错并且存在已知问题，因此我考虑尝试使用会话变量来代替。唯一的问题是我在开始发送文件之前使用了以下命令，以便用户在下载时仍然可以浏览该站点：

```
session_write_close(); 
```

我想检查会话中的变量是否存在，如果不添加，则关闭会话，然后重新打开同一会话并删除我添加的旧变量。这可能吗？或者有没有更简单的方法来解决这个问题？或者我应该坚持使用 db 实现。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:36:51.073

```
<?php

session_start();

if (isset($_SESSION['downloading']))
    die("You already have a download in progress.");

$_SESSION['downloading'] = 1;

session_write_close();

//send the file

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T15:12:40.280

最后我找不到稳定的会话解决方案，因为它导致会话损坏，所以我最终只坚持我的数据库实现现在。抱歉，这个问题对以后的搜索没有帮助:(

# java - Google Eclipse 插件：浏览器插件与开发模式

> ID：12065628
> 
> 赞同：1
> 
> 时间：2012-08-22T02:31:25.703
> 
> 标签：java, google-app-engine, plugins, google-eclipse-plugin, development-mode

我知道 Google 的 Eclipse 插件试图强调“代码-测试-调试”循环并使其尽可能快，并且它附带了用于执行此操作的多种工具。

我不明白的是需要一个“开发人员”浏览器插件来在 Eclipse 中运行您的应用程序并在`localhost`. 为什么插件不能启动嵌入式网络服务器并从那里托管它？为什么浏览器首先需要这个插件？

与此相切的是它与一般发展模式的关系问题。在开发模式下，Eclipse 是否以某种“特殊配置”运行，让它在后台与这个浏览器插件对话？如果是这样，为什么有必要这样做？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T06:33:17.793

我相信你在这里混合了两个不同的东西：GWT 和 GAE。GAE 不需要浏览器插件来运行本地开发服务器，而 GWT 需要浏览器插件来运行本地开发模式（甚至这在 2.5 [super devmode 中也会消失](https://developers.google.com/web-toolkit/articles/superdevmode)）。

令人困惑的原因是 Google 将这两种独立的技术捆绑到一个插件包[GPE](https://developers.google.com/eclipse/)中。

为了避免这种情况，只需[在创建新 GAE 应用程序时取消选中 GWT](https://developers.google.com/eclipse/docs/creating_new_webapp)。

**编辑：**

只有在开发模式下才需要 GWT 开发插件。在这种模式下，GWT Java 源代码不会被翻译成 javascript，而是实际上作为 Java 在 JVM 中运行。这是支持调试所必需的：[https ://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#DevGuideDevMode](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging#DevGuideDevMode)

**编辑2：**

如果您不喜欢浏览器插件，则可以在本地服务器上使用生产模式。这样做的缺点是 compile-run 将大大扩展，因为 devmode 就地编译：您可以简单地更改 GWT 代码并通过简​​单地重新加载浏览器窗口来查看更改。

# php - 通过传递 Cookie 键/值对的 PHP CURL

> ID：12065631
> 
> 赞同：0
> 
> 时间：2012-08-22T02:31:47.823
> 
> 标签：php, cookies, curl, key-value

我想知道是否有人知道相当于做（从终端）：

curl --cookie "session_id=12345" [http://www.example.com](http://www.example.com)

在 php 中使用 CURL。我宁愿不使用 cookies.txt 文件，只通过传递一个 cookie 键/值对来执行 php curl 调用。请让我知道这是否有意义，否则我可以进一步澄清。我正在使用它连接到需要通过 cookie 发送会话变量的 API。

更多说明：

规范指定了这个......

“必须做的第一件事是登录。响应中有一个会话 ID。它应该被存储并用于后续调用。这应该作为 cookie session_id 添加，以便进一步调用 API。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:35:51.857

您希望`CURLOPT_COOKIE`在[`curl_setops`](http://php.net/manual/en/function.curl-setopt.php)页面中指定。

```
$ch = curl_init('http://www.example.com'); 
curl_setopt($ch, CURLOPT_COOKIE, 'session_id=12345');
curl_exec($ch);
curl_close($ch); 
```

对于多个 cookie，用分号和空格分隔：

```
curl_setopt($ch, CURLOPT_COOKIE, 'session_id=12345; fruit=apple'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T02:35:39.107

您可能正在寻找以下标志：

*   `CURLOPT_COOKIESESSION`

和：

*   `CURLOPT_COOKIE`
*   `CURLOPT_COOKIEFILE`
*   `CURLOPT_COOKIEJAR`

# x86-64 - 预取写入是否会影响单核性能？

> ID：12065632
> 
> 赞同：5
> 
> 时间：2012-08-22T02:31:57.560
> 
> 标签：x86-64, multicore, cpu-architecture, prefetch, cpu-cache

某些架构具有“预取写”指令，以在实际执行之前向 CPU 指示您将要写入内存位置。我知道在多核机器上，核心可以使用这作为提示，它现在应该尝试获取给定缓存行的所有权，以便以后可以更快地写入该位置。但是，AFAICT 仅在有两个内核可能竞争缓存线的情况下才有意义。对于仅由单个内核读取和写入的高速缓存行，预取写入是否有任何用处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:19:15.117

在其他条件相同的情况下，对于仅由单个内核访问的行，Prefetch-Write 与 Prefetch-Read 相比没有任何优势。在任何类型的预取之后，核心将拥有处于**独占**状态的线路。在随后的写入中，该行更改为已**修改**状态。Exclusive-to-Modified 转换是免费的，因为根据定义，没有其他内核具有这条线。E->M 状态更改在本地完成，无需窥探。

请注意，内核有自己的硬件预取逻辑。对一条线的访问可能会导致核心自动抓取相邻的线。如果全局变量或其他数据驻留在附近，SMP 系统可能会遇到很多意外的交叉侦听。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T21:46:14.257

我认为如果缓存线不在内存中并且写预取标志从现在开始需要一些周期，它可能会有所帮助。诸如为写入腾出一条线之类的家务活可能会更麻烦。当然，这应该允许 CPU 完成写入，而不是简单地将写入卸载到高速缓存的一圈？

还是我错过了一些基本的东西？

# asp.net - 计算嵌套 sql 查询中的 if 函数

> ID：12065635
> 
> 赞同：2
> 
> 时间：2012-08-22T02:32:11.160
> 
> 标签：asp.net, sql, sql-server-2008

我在 sql server 2005 中有以下查询和一个表

```
select t1.id, CONVERT(VARCHAR,t1.dt,103) date_1, CONVERT(VARCHAR,t2.dt,103) date_2, t1.hotel,
    t1.price price_1, t2.price price_2, t2.price - t1.price difference, ((t2.price - t1.price)/t1.price)*100 as Diff_percentage
from test t1
inner join
(
    select *
    from test
) t2
    on t1.hotel = t2.hotel
    and t1.dt < t2.dt and t2.dt=(SELECT MAX(dt) from TEST) and t1.dt=(SELECT MAX(dt-1) from TEST) 
```

我想在这个查询中使用 count if 函数。基于差异列。这样我就可以计算“增加多少，减少多少，相同多少，不可用多少”

1.  COUNT IF Difference>0 //增加了多少
2.  COUNT IF Difference<0 //减少了多少
3.  COUNT IF Difference=0 //有多少相同
4.  COUNT IF Difference="" //有多少不可用 --Difference 为空。

演示：[http ://sqlfiddle.com/#!3/b6f37/29](http://sqlfiddle.com/#!3/b6f37/29)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:56:37.190

这种方法使用您的查询，然后只总结结果：

```
with t as (
    select t1.id, CONVERT(VARCHAR,t1.dt,103) as date_1,
            CONVERT(VARCHAR,t2.dt,103) as date_2,
           t1.hotel,
           t1.price as price_1, t2.price as price_2,
           t2.price - t1.price as difference,
           ((t2.price - t1.price)/t1.price)*100 as Diff_percentage
    from test t1 join
         test t2
    on t1.hotel = t2.hotel and
       t1.dt < t2.dt and
       t2.dt=(SELECT MAX(dt) from TEST) and
       t1.dt=(SELECT MAX(dt-1) from TEST)
)
select sum(case when diff_percentage > 0.0 then 1 else 0 end) as numIncrease,
       sum(case when diff_percentage < 0.0 then 1 else 0 end) as numDecrease,
       sum(case when diff_percentage = 0.0 then 1 else 0 end) as numSame,
       sum(case when diff_percentage is NULL then 1 else 0 end) as numBlank
from t 
```

我不确定“dt - 1”是什么意思。对于 SQL Server 中的日期/日期时间值，通常使用“dateadd(day, -1, )”来减去日期。无论如何，可能有其他方法可以计算您想要的，但这回答了您的具体问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T04:03:37.083

如果我想要您现有的查询结果，我会将查询重写为：

```
select t1.id, 
       CONVERT(VARCHAR,t1.dt,103) date_1, 
       CONVERT(VARCHAR,t2.dt,103) date_2, 
       t1.hotel,
       t1.price price_1, 
       t2.price price_2, 
       t2.price - t1.price difference, 
       ((t2.price - t1.price)/t1.price)*100 as Diff_percentage
  from test t1
  join (select max(dt) maxDt from test) d
    on t1.dt = d.maxDt-1
  join test t2
    on t2.hotel = t1.hotel
   and t2.dt = d.maxDt 
```

扩展您的原始查询以包括缺少行的酒店：

```
select t1.id, 
       CONVERT(VARCHAR,t1.dt,103) date_1, 
       CONVERT(VARCHAR,t2.dt,103) date_2, 
       h.hotel,
       t1.price price_1, 
       t2.price price_2, 
       t2.price - t1.price difference, 
       ((t2.price - t1.price)/t1.price)*100 as Diff_percentage
  from (select distinct hotel from test) h
  cross join (select max(dt) maxDt from test) d
  left join test t1
    on t1.hotel = h.hotel
   and t1.dt = d.maxDt-1
  left join test t2
    on t2.hotel = h.hotel
   and t2.dt = d.maxDt 
```

使用规范化的 HOTEL 表（每家酒店 1 行）来替换 SELECT DISTINCT 子查询，上述查询会更有效。

为了获得您要求的结果，我会使用：

```
select count(case when (t2.price-t1.price) < 0 then 1 end) decrease_count,
       count(case when (t2.price-t1.price) > 0 then 1 end) increase_count,
       count(case when (t2.price-t1.price) = 0 then 1 end) same_count,
       count(distinct t1.hotel) - count(case when (t2.price-t1.price) is not null then 1 end) unavailable_count
  from test t1
  left join (select max(dt) maxDt from test) d
    on t1.dt = d.maxDt-1
  left join test t2
    on t2.hotel = t1.hotel
   and t2.dt = d.maxDt 
```

再次使用标准化的 HOTEL 表，上述方法会更有效。我将重组查询更像前一个：从 HOTEL 中选择交叉连接到 MAX 日期查询，然后外部连接到 TEST 表两次以获取 2 个日期的数据。然后可以更直接地测量不可用计数，计算差异计算为 NULL 的行数。

这是所有查询的[SQL Fiddle](http://sqlfiddle.com/#!3/4defa/2)，以及一些扩展的测试数据。

# git - Git-tf 签入失败：提交 [commitid] 有多个父项。使用 --deep 选项在 TFS 中创建历史记录

> ID：12065640
> 
> 赞同：4
> 
> 时间：2012-08-22T02:33:01.107
> 
> 标签：git, tfs, branching-and-merging, git-tf

似乎两者都不起作用`--deep`或`--shallow`似乎不起作用。`git-tf checkin --deep`尝试对TFS 中的新文件夹（当前为空）执行操作时出现错误。我有一个历史悠久的 git repo。作为 git-tf 的一部分，我很想保留/迁移到 TFS。

我的理解是，这`checkin --deep`将为每次提交在 TFS 中创建一个类似的变更集。问题是 git repo 中的任何提交似乎是合并的结果（我们在这个 repo 中有很多合并）似乎使`git-tf`命令非常不愉快，并报告了我在标题中提到的错误消息（带有[commitid] 的异常被替换为真实的提交 ID（例如 9a26d8））。

我不确定我是否完全错过了这里的船或什么。是否有一种可靠的方法可以将具有多个历史合并提交的预先存在的 git 存储库移植到 TFS？我希望这是一个原始功能/修复。我希望我错过了一些东西。我对 TFS 非常精通，但对 git 没有经验，因此不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-22T14:19:59.870

这里的问题是在 TFS 中表示复杂的合并历史很困难。很简单，git 提交可以有多个父级，而 TFS 变更集只能有一个。

考虑一下我的 git 存储库在某个提交时有 HEAD 的状态，比如说`9c42ef...`. 现在我进行更改并提交它，创建一个新的 commit `1f23cd...`。同时，我也从 Bob 那里得到一个改变，这也是一个基于`9c42ef...`. 他的更改是 commit ID `f41ac3...`。如果我想合并这两个更改，我将不得不进行合并，假设我最终得到了 commit ID `7acdfe...`。现在您的图表如下所示：

```
 1f23cd
        /        \
9c42ef             7acdfe (HEAD)
        \        /
          f41ac3 
```

这在 TFS 中不容易表示，因为单个变更集只能有一个祖先（直接在它之前的变更集）。所以我们需要线性化历史。这就是存在`--squash`and`--auto-squash`选项的原因`git-tf checkin`（在进行深度签入时）。

该`--squash`选项允许您在浏览历史时选择要遵循的路径。例如：

```
git-tf checkin --deep --squash f41ac3 
```

`f41ac3`遍历图表时将省略，您将拥有三个变更集`9c42ef`，即`1f23cd`和的内容`7acdfe`。但是在大图中，指定每个提交到 squash 需要做很多工作。在那种情况下，`--auto-squash`将使用一些魔法来确定要遵循的路径。（它更喜欢具有最长提交链的路径，以便您获得尽可能多的历史记录，如果两个段长度相等，将使用时间戳来确定要遵循的路径。）

```
git-tf checkin --deep --auto-squash 
```

您还可以重新设置基准，以便您签入的提交是线性的，并且每个提交只有一个父级。

`git-tf`开发人员根据树的复杂性、对输入无穷无尽的 SHA1 哈希字符串的受虐感受和月相来使用这些策略中的每一个。

# javascript - 命名空间 Javascript 的多个实例

> ID：12065642
> 
> 赞同：1
> 
> 时间：2012-08-22T02:33:11.287
> 
> 标签：javascript, object, namespaces

我有一些命名空间实用程序，我想创建多个实例，但似乎无法使其正常工作。

我的模块看起来像：

```
Project.utilities.gallery.position = (function() {

// WILL CREATE THE BUBBLES FOR THE SLIDESHOW AND WILL THEN MOVE THEM AUTOMATICALLY AFTER BEING TRIGGERED

var slide_container, position_container;    
var create = function(_container) {//this function will be responsible for creating the bubbles for the slideshow

    if (typeof _container == "undefined"){
        return false;
            }

    slide_container = _container.children('.content');      
    slide_container = _container;
};

var update = function() {//this will be responsible for updating the slideshow!     
    console.log(slide_container);
}; 
```

当我尝试做类似的事情时

```
var test = Project.utilities.position;
test.create("hello world from test");

var test_2 = Project.utilities.position;
test_2.create("Hello world from test_2");

test.update() // outputs "hello world from test_2", not "hello world from test" 
```

我该怎么做才能正常工作？

# java - 使用 for 循环将使用 DOM 的节点添加到 XML

> ID：12065645
> 
> 赞同：0
> 
> 时间：2012-08-22T02:33:23.680
> 
> 标签：java, xml, dom, nodes

好的，所以我有一个程序需要很多人。然后，它会询问每个人的衣领：衬衫和油漆。我希望 java 使用 DOM 将所有这些信息放入 XML 中。

这是我到目前为止所拥有的：

```
import java.io.*;
import org.w3c.dom.*;
import org.xml.sax.*;
import javax.xml.parsers.*;
import javax.xml.transform.*;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;

public class calcWithMem {
    public static void main(String[] args) throws Exception{
        System.out.println("Program launched");
        BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
        DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        Document doc = builder.newDocument();
        Element root = doc.createElement("People");
        doc.appendChild(root);
        System.out.print("Number of people: ");
        String in = bf.readLine();
        int ppl = Integer.parseInt(in);
        String[] pants = new String[ppl];
        String[] shirt = new String[ppl];
        for (int i=0;i<ppl;i++) {
                    //So what I want is for here to add a new node to the root called "Person 1, Person2, ... etc.)
            System.out.print("Colour of PANTS for person #" + String.valueOf(i+1) + ": ");
            in = bf.readLine();
            pants[i] = in;
                    //And then have a node added to the person with pants
            System.out.print("Colour of SHIRT for person #" + String.valueOf(i+1) + ": ");
            in = bf.readLine();
            shirt[i] = in;
                    //and one last node added to the person with shirt, after this it repeats for each person
            System.out.println();
        }
        for (int i=0;i<ppl;i++) {
            System.out.println("Person #" + String.valueOf(i+1) + ":");
            System.out.println("    Pants: " + pants[i]);
            System.out.println("    Shirt: " + shirt[i]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:43:55.813

您可以使用创建*新*元素`doc.createElement`

```
Element person=document.createElement("Person");
person.setAttribute("ID", String.valueOf(i+1)); // to add attribute
Element pantsColor=doc.createElement("PantsColor");
Element shirtColor=doc.createElement("ShirtColor");
pantsColor.appendChild(doc.createTextNode(in));
person.appendChild(pantsColor);
person.appendChild(shirtColor);
root.appendChild(person);
... 
```

并保存`doc`,

```
TransformerFactory transFactory=TransformerFactory.newInstance();
Transformer trans=transFactory.newTransformer();

trans.setOutputProperty(OutputKeys.INDENT, "yes");
trans.setOutputProperty("{http://xml.apache.org/xslt}indent-amount", "5");

trans.transform(new DOMSource(doc),new StreamResult("c:\\file.xml")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:42:27.040

怎么样：

```
for (int i=0;i<ppl;i++) {
    Element person = root.addElement("Person");
    root.appendChild(person);
    in = bf.readLine();
    pants[i] = in;
    Element pants = person.addElement("pants");
    // [add subelements/attributes to pants]
    in = bf.readLine();
    shirt[i] = in;
    Element shirt = person.addElement("shirt");
    // [add subelements/attributes to shirt]

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T02:44:47.963

```
 // Use a Transformer for output
  TransformerFactory tFactory = TransformerFactory.newInstance();
  Transformer transformer = tFactory.newTransformer();

  DOMSource source = new DOMSource(document);
  StreamResult result = new StreamResult(System.out);
  transformer.transform(source, result); 
```

基本上在上面的示例中，我使用了 System.out。您可以打开一个文件并写入其中。只有在您关闭它之后，它才会真正写出 XML 文件。

# javascript - 对绑定元素的角度访问

> ID：12065646
> 
> 赞同：4
> 
> 时间：2012-08-22T02:33:31.410
> 
> 标签：javascript, angularjs

这可能是我构建应用程序的方式的一个问题，但我一直需要能够通过我的 items 数组访问 dom 元素：

```
$scope.items = [{"src": src, "url": url, "title": title, "top": 0, "left": -500 }]; 
```

绑定到html：

```
<div class="block" ty-stacked-block ng-repeat="item in items" ng-style="{ 'top' : item.top+'px', 'left' : item.left+'px' }">
  <a href="{{ item.url }}" title="{{ item.title }}">
    <img ng-src="{{ item.src }}" alt="{{ item.title }}" />
  </a>
  <br />
  <p>{{ item.title }}</p>
</div> 
```

基本上我有另一段代码想要通过 $scope.items 并更改 div 的位置（基于每个 div 的高度）。

```
 scope.repositionItems = function() {
        _.each(scope.items, function(item) {
            // TODO get item's height somehow
        });
    }; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T03:21:18.963

我在 div "item-{{ $index }}" 中添加了一个 id，所以我可以通过 id 从我的循环中获取它。感觉不是很“棱角分明”，但它奏效了！

```
<div id="item-{{ $index }}" class="block" ty-stacked-block ng-repeat="item in items" ng-style="{ 'top' : item.top+'px', 'left' : item.left+'px' }">
  <a href="{{ item.url }}" title="{{ item.title }}">
    <img ng-src="{{ item.src }}" alt="{{ item.title }}" />
  </a>
  <br />
  <p>{{ item.title }}</p>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T00:18:37.283

我不确定为什么您的项目列表中有布局属性，希望您没有充分的理由，这会有所帮助。如果您的意图是将多个元素块堆叠在一起，每个元素块都包含来自项目的结果，那么您应该让 angular 重复这些项目，而不是自己定位它们。您在 class='block' 中的样式属性应该创建所需的间距和布局。我已将您的代码包装在一个无序列表中，并将 div 标签更改为 li 标签。您始终可以将 div 保留在 li 标签内。如果您不想用 ul 包装，请在 class="block" 中应用 float:left

```
 <ul>
    <li class="block" ng-repeat="item in items">
      <a href="{{ item.url }}" title="{{ item.title }}">
       <img ng-src="{{ item.src }}" alt="{{ item.title }}" />
      </a>
      <br />
      <p>{{ item.title }}</p>
    </li>
    </ul>

.block {
    background-color:#fff;
    width:400px;
    padding:10px;
    border-radius:8px;
    margin:10px;
    position: relative;
} 
```

# php - 如何从数组中排除数据？

> ID：12065648
> 
> 赞同：0
> 
> 时间：2012-08-22T02:33:51.073
> 
> 标签：php

在产品页面上，我想显示随机选择的 4 个其他产品，但绝不是已经显示的产品。显示的产品 id 是`$_product->getId()`，所有产品都进入一个`$result[]`数组，如下所示：

```
foreach($collection as $product){
    $result[]=$product->getId();
} 
```

我`$need = array_rand($result, 4);`用来获取 4 个随机产品的 id，但它可能包括展示产品的 id。如何`$_product->getId()`从`$need[]`数组中排除？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:41:25.207

不要将您不想展示的产品的 id 放入`$result`：

```
$currentProductId = $_product->getId();
foreach ($collection as $product) {
  if ($product->getId() != $currentProductId) $result[] = $product->getId();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:50:22.053

如果您使用产品 id 作为结果中的索引，则可以在调用之前从数组`$result[]`中删除当前产品，如下所示：`$result``unset()``array_rand()`

```
foreach($collection as $product){
    $result[$product->getId()] = $product->getId();
}
unset($result[$_product->getId()]);
$need = array_rand($result, 4); 
```

这种方法使您不必使用 in 的值`$need`来查找`$result[]`数组中的产品 id，因为 in 的值`$need`将是您的产品 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T02:40:29.177

不将当前产品 ID 放入数组中是否可以接受？

```
foreach($collection as $product) {
    if( $product != $_product) $result[] = $product->getId();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T02:42:52.257

您可以先生成随机数，如下所示：

```
$rands = array();
while ($monkey == false){
    $banana = rand(0,4);
    if (in_array($banana, $rands) && $banana != $_product->getId()){ $rands[] = $banana; }

    if (sizeOf($rands) == 4){
        $monkey = true;
    }

} 
```

然后你可以通过你的产品抓取器来管道它们。显然，您需要自己弄清楚界限，`rand`但您比我更了解您的应用程序。首先选择您的号码在计算上比提取记录然后检查以确保它们是唯一的要便宜得多。

当然，如果这是由数据库支持的，您可以通过编写新查询来更优雅地解决它。

# python - 根据对角线对 numpy 矩阵进行排序

> ID：12065649
> 
> 赞同：8
> 
> 时间：2012-08-22T02:33:53.463
> 
> 标签：python, matrix, numpy, scipy

我有一个矩阵，它应该在对角线上有一个，但列是混合的。

![混乱的矩阵](../Images/79e1ab29dfd0ec985d6121f0870a3e85.png)

但我不知道如何在没有明显的 for 循环的情况下有效地交换行以在对角线上获得统一。我什至不确定我会传递什么键来排序。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T02:56:00.333

您可以使用 numpy[`argmax`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.argmax.html#numpy.argmax)来确定目标列排序，并使用 argmax 结果作为列索引重新排序矩阵：

```
>>> z = numpy.array([[ 0.1 ,  0.1 ,  1\.  ],
...                  [ 1\.  ,  0.1 ,  0.09],
...                  [ 0.1 ,  1\.  ,  0.2 ]])

numpy.argmax(z, axis=1)

>>> array([2, 0, 1]) #Goal column indices

z[:,numpy.argmax(z, axis=1)]

>>> array([[ 1\.  ,  0.1 ,  0.1 ],
...        [ 0.09,  1\.  ,  0.1 ],
...        [ 0.2 ,  0.1 ,  1\.  ]]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T02:47:59.667

```
>>> import numpy as np
>>> a = np.array([[ 1\. ,  0.5,  0.5,  0\. ],
...               [ 0.5,  0.5,  1\. ,  0\. ],
...               [ 0\. ,  1\. ,  0\. ,  0.5],
...               [ 0\. ,  0.5,  0.5,  1\. ]])
>>> np.array(sorted(a, cmp=lambda x, y: list(x).index(1) - list(y).index(1)))
array([[ 1\. ,  0.5,  0.5,  0\. ],
       [ 0\. ,  1\. ,  0\. ,  0.5],
       [ 0.5,  0.5,  1\. ,  0\. ],
       [ 0\. ,  0.5,  0.5,  1\. ]]) 
```

它实际上按行排序，而不是按列排序（但结果是相同的）。它通过按所在列的索引进行排序来工作`1`。

# jsf - JSF按钮onclick事件调用bean方法

> ID：12065650
> 
> 赞同：1
> 
> 时间：2012-08-22T02:34:15.737
> 
> 标签：jsf

在 JSF 2 中，我需要在显示对话框之前准备好数据。在下面的代码中，在 viewscoped 托管 bean 中定义了方法“newAuto”。单击按钮后，我想先调用此方法，然后显示对话框。

我尝试了很多方法，都失败了。

谢谢

```
<h:commandButton  type="button" value="Add Dialog"   onclick="jsf.ajax.request(this, event, {execute: 'newAuto'});  autoDialog2.show(); return false;" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T12:03:33.383

您应该使用`<f:ajax>`标签，然后使用它的`onevent`属性。

```
<h:commandButton value="Add Dialog" action="#{bean.newAuto}">
    <f:ajax onevent="function(data) { if (data.status == 'success') autoDialog2.show(); }" />
</h:commandButton> 
```

也许您还想添加`render="someDialogId"`应该`<f:ajax>`事先更新对话框内容的内容。

# ruby-on-rails - 将角色添加到 OmniAuth 登录，以便 Cucumber 不会通过测试

> ID：12065654
> 
> 赞同：0
> 
> 时间：2012-08-22T02:34:56.107
> 
> 标签：ruby-on-rails, cucumber, omniauth, cancan

我一直在开发一个用于学习目的的应用程序，其中包括用于 Facebook 登录的 OmniAuth、用于 BDD 的 Cucumber 以及用于权限和角色的 CanCan & Rolify。到目前为止没有使用任何设计。我正在尝试编写一个测试，该测试涉及记录具有管理员角色的用户，然后访问受限路径。此外，使用 OmniAuth 创建的用户具有简单的属性：如果用户已被确认使用该站点，则他/她将已确认：1 和确认令牌：无；否则将被确认：0 和确认令牌：。如果我不在 Cucumber 环境中，这个想法实际上是有效的，但是在其中，页面给了我一个 CanCan::AccessDenied 错误。哦，我还设置了 OmniAuth 测试模式，效果很好， env["omniauth.auth"] 返回一个正确的模拟哈希。

这是我的测试（我还在学习，所以请耐心等待）

```
@omniauth_test
Given /^I am logged as an admin$/ do
  #ensure no session is active
  visit '/signout'
  @user = FactoryGirl.create(:user, confirmed: 1, confirmation_token: nil)
  @user.add_role :admin
  visit root_url
  click_link "log_in" #means going to '/auth/facebook/callback'
end

And /^I check the user list$/ do
  visit users_path #fails
end 
```

这是我的用户工厂，没什么复杂的：

```
FactoryGirl.define do
  factory :user do |u|
    u.email 'test@example.com'
  end
end 
```

这是我的会话控制器：

```
class SessionsController < ApplicationController

  def create
    reset_session
    service = Service.from_omniauth(env["omniauth.auth"])
    session[:user_id] = service.user.id
    session[:service_id] = service.id
    session[:expires_at] = 5.minutes.from_now
    if service.user.confirmed == 0
      redirect_to edit_user_path(service.user)
    elsif service.user.confirmed == 1
      if service.user.has_role? :member
        redirect_to root_url
      elsif service.user.has_role? :admin
        redirect_to users_path
      else
        redirect_to root_url, :notice => "Work in progress!"
      end
    end
  end 
```

最后，Service.rb：

```
class Service < ActiveRecord::Base

  attr_accessible :user_id, :provider, :uid, :name, :token, :updated_at

  validates_uniqueness_of :uid, :scope => [:provider]

  belongs_to :user

  def self.from_omniauth(auth)
    where(auth.slice(:provider, :uid)).first_or_initialize.tap do |service|
      if !service.user
       user = User.create(:email => auth.info.email)
       service.user = user
       #for some reason, instance variable @user created by FactoryGirl is nil at this point (test env)
       user.add_role :signedup
      end
      service.provider = auth.provider
      service.uid = auth.uid
      service.name = auth.info.name
      service.token = auth.credentials.token
      service.save!
    end
  end 
```

我想要以某种方式使用 OmniAuth 哈希并仅为测试模式添加管理员角色和确认的属性，而不会过多地混淆生产代码（如果可能的话），可能会向 env.rb 添加帮助方法，然后登录与该用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-26T23:53:33.757

傻我。这成功了：

```
@omniauth_test
  Given /^I am logged as an admin$/ do
    @user = FactoryGirl.create(:user, confirmed: 1, confirmation_token: nil)
    @user.add_role :admin
    @service = FactoryGirl.create(:service, user: @user, uid: '1234567', provider: 'facebook')
  end 
```

# python - Python 的 __reduce__/copy_reg 语义和有状态的 unpickler

> ID：12065657
> 
> 赞同：6
> 
> 时间：2012-08-22T02:35:16.190
> 
> 标签：python, pickle

我想为属于我的扩展库的对象实现酸洗支持。有一个在启动时初始化的类 Service 的全局实例。所有这些对象都是由于某些 Service 方法调用而产生的，并且本质上属于它。服务知道如何将它们序列化为二进制缓冲区以及如何将缓冲区反序列化回对象。

看来 Pythons __reduce__ 应该满足我的目的 - 实现酸洗支持。我开始实现一个，并意识到 unpickler 存在问题（第一个元素 od 预计将由 __reduce__ 返回的元组）。这个 unpickle 函数需要一个 Service 实例才能将输入缓冲区转换为一个对象。这里有一些伪代码来说明这个问题：

```
class Service(object):
   ...
   def pickleObject(self,obj):
      # do serialization here and return buffer
      ...

   def unpickleObject(self,buffer):
      # do deserialization here and return new Object
      ...

class Object(object):
    ...
    def __reduce__(self):
        return self.service().unpickleObject, (self.service().pickleObject(self),) 
```

注意元组中的第一个元素。Python pickler 不喜欢它：它说它是 instancemethod 并且不能被pickle。显然，pickler 试图将例程存储到输出中，并希望 Service 实例与函数名称一起，但这不是我想要发生的。我不想（而且真的不能：服务不可选择）将服务与所有对象一起存储。我希望在调用 pickle.load 之前创建服务实例，并且在 unpickle 期间以某种方式使用该实例。

在这里，我来到了 copy_reg 模块。它再次出现，因为它应该可以解决我的问题。这个模块允许动态注册每个类型的pickler和unpickler例程，这些应该在以后用于这种类型的对象。所以我将此注册添加到服务构造中：

```
class Service(object):
  ...
  def __init__(self):
      ...
      import copy_reg
      copy_reg( mymodule.Object, self.pickleObject, self.unpickleObject ) 
```

self.unpickleObject 现在是一个绑定方法，将服务作为第一个参数，缓冲区作为第二个参数。self.pickleObject 也是将服务和对象绑定到 pickle 的方法。copy_reg 要求 pickleObject 例程应该遵循 reducer 语义并返回与以前相似的元组。这里问题又出现了：我应该返回什么作为第一个元组元素？

```
class Service(object):
  ...
  def pickleObject(self,obj):
      ...
      return self.unpickleObject, (self.serialize(obj),) 
```

在这种形式中，泡菜再次抱怨它不能泡菜实例方法。我试过无 - 它也不喜欢它。我放了一些虚拟功能。这很有效 - 意味着序列化阶段顺利进行，但在 unpickling 期间它调用这个虚拟函数而不是 unpickler 我在 Service 构造函数中为 mymodule.Object 类型注册。

所以现在我很茫然。对不起，解释太长了：我不知道如何用几行来问这个问题。我可以这样总结我的问题：

1.  如果我希望独立注册一个，为什么 copy_reg 语义要求我从 pickleObject 返回 unpickler 例程？
2.  是否有任何理由更喜欢 copy_reg.constructor 接口来注册 unpickler 例程？
3.  如何制作泡菜以使用我注册的 unpickler 而不是流中的一个？
4.  我应该返回什么作为元组中的第一个元素作为 pickleObject 结果值？有“正确”的价值吗？
5.  我是否正确地处理了整个事情？有不同/更简单的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T08:12:17.147

首先，该`copy_reg`模块在这里不太可能对您有太大帮助：它主要是一种向`__reduce__`没有该方法的类添加类似功能而不是提供任何特殊功能的方法（例如，如果您想从某个库中提取对象本身不支持它）。

由返回的可调用`__reduce__`对象需要在要取消提取对象的环境中可定位，因此实例方法并不合适。如[Pickle 文档](http://docs.python.org/library/pickle.html#pickling-and-unpickling-extension-types)中所述：

> 在 unpickling 环境中，该对象必须是一个类，一个注册为“安全构造函数”（见下文）的可调用对象，或者它必须具有一个 `__safe_for_unpickling__`具有真值的属性。

所以如果你定义了一个函数（不是方法）如下：

```
def _unpickle_service_object(buffer):
    # Grab the global service object, however that is accomplished
    service = get_global_service_object()
    return service.unpickleObject(buffer)

_unpickle_service_object.__safe_for_unpickling__ = True 
```

`_unpickle_service_object`您现在可以在方法的返回值中使用此函数，`__reduce__`以便您的`Service`对象在取消腌制时链接到新环境的全局对象。

# java - 当有多个 SLF4J 绑定时如何使用 SLF4J

> ID：12065658
> 
> 赞同：4
> 
> 时间：2012-08-22T02:35:24.360
> 
> 标签：java, eclipse, slf4j

当我将 SLF4J 记录器添加到我的代码中时，我收到一条错误消息，“类路径包含多个 SLF4J 绑定”。在网站 slf4j.org/codes 上，它声明我应该将它们从类路径中删除。但是，这两个记录器包含在我的 Maven 依赖项中。我的整个 maven 依赖文件夹都包含在类路径中。我不负责 maven 依赖项中的内容，因此不是我编辑它的地方，因此它在 maven 依赖项文件夹中只有一个记录器依赖项。我可以指定 Java 程序以便它只使用其中一个记录器吗？

杰伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T08:31:31.763

如果您确定无法调整现有的 maven 依赖项来解决问题，您可以确保您的 SLF4J 绑定首先出现在类路径中，因为第一个绑定是在多个绑定的情况下使用的绑定。

但是，您仍然会收到警告，但您的 SLF4J 记录器将被使用。

您还可以考虑使用 maven 模块将项目拆分为多个部分，以便您可以在每个模块的 pom.xml 文件中以不同方式管理每个部分中的依赖关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T11:58:33.610

找出您项目的哪些依赖项包含 slf4j 实现，然后将其排除：

```
 <dependency>
        <groupId>other-group</groupId>
        <artifactId>dependency-id</artifactId>
        <exclusions>
            <exclusion>
                <groupId>org.slf4j</groupId>
                                    <!-- or slf4j-jdk14, etc -->
                <artifactId>slf4j-simple</artifactId>
            </exclusion>
        </exclusions>
    </dependency> 
```

# java - Google Eclipse 插件：保护环境

> ID：12065662
> 
> 赞同：2
> 
> 时间：2012-08-22T02:35:52.087
> 
> 标签：java, security, google-app-engine, deployment, google-eclipse-plugin

我刚刚下载了 Eclipse 的 Google 插件并开始使用它。到目前为止，我发现的最酷、最可怕的功能之一是能够直接从 Eclipse（您的“本地/开发”环境）内部将 Web 应用程序部署到 Google App Engine（“生产”环境）。

这对于拥有少量开发人员且都是核心贡献者和“所有者”的小型项目来说是完全可以的，但是一旦你将这种能力引入到一个中等规模的开发团队中，它就变成了一把双刃剑。

初级开发人员可能会用他/她在本地破坏的应用程序的错误、完全失能的版本来破坏生产，这一事实让我感到恐惧！

是否有限制哪些*用户/组*可以使用此部署功能？如果没有，是否有任何解决方法或补救措施？我无法想象我是第一个对此感到震惊的人！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T02:47:32.583

是的。转到[AppEngine 网络界面](http://appengine.google.com/)并单击您的应用程序。在左侧导航面板中，单击 Administration -> Permissions 并将初级开发人员设置为“查看者”，而不是“开发人员”或“所有者”。

# c# - 是否可以在 MonoTouch 中使用 System.Windows.ResourceKey 的替代方法？

> ID：12065679
> 
> 赞同：0
> 
> 时间：2012-08-22T02:37:33.257
> 
> 标签：c#, iphone, dll, xamarin.ios, monodevelop

我需要使用 ResourceKey 作为我的 Dictionary 中的键，并且想知道我是否可以在 MonoTouch 中使用类似的类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:09:39.040

我认为你只需要使用一个字符串。

如果您需要使用其他东西作为键（如 WPF 中的 System.Type），则创建自己的类来处理此问题。但是，我不确定这项工作是否值得。

# android - Android ProgressDialog 未显示

> ID：12065680
> 
> 赞同：0
> 
> 时间：2012-08-22T02:37:48.090
> 
> 标签：android, android-dialog

我正在尝试向用户显示登录对话框（带有自定义视图的自定义对话框），然后单击“登录”时，我正在尝试显示 ProgressDialog，然后在登录完成后将其关闭。

问题是我无法显示 ProgressDialog。

这是我的代码：

```
 private final MyActivity activity;

    public MyPresenter(MyActivity activity) {
        this.activity = activity;
    }

    public Dialog getLoginSignupDialog() {
        final Dialog dialog = new Dialog(activity);
        dialog.setContentView(R.layout.dialog_signup);
        dialog.setTitle("Login");
        final TextView email = (TextView)dialog.findViewById(R.id.textViewEmail);
        final TextView password = (TextView)dialog.findViewById(R.id.textViewPassword);
        Button signupButton = (Button)dialog.findViewById(R.id.buttonSignup);           
        signupButton.setOnClickListener(new OnClickListener() {                 
            public void onClick(View v) {   
                ProgressDialog progressDialog = null;

                try {
                    progressDialog = ProgressDialog.show(activity, "", "Signing up...",false);
                    activity.signup(email.getText().toString(), password.getText().toString());
                    progressDialog.dismiss();
                    dialog.dismiss();
                } catch (ParseException e) {
                    if (progressDialog != null) progressDialog.dismiss();
                    Toast.makeText(activity, "Sorry, an error occured.", Toast.LENGTH_SHORT).show();
                    e.printStackTrace();
                }
            }
        });     
        return dialog;
    } 
```

这段代码在一个 Presenter 中，它传递了主要的活动实例。只是为了保持 UI 逻辑独立。

在主要活动（`onCreate`）中，我这样做：

```
showDialog(DIALOG_SIGNUP); 
```

然后我覆盖`onCreateDialog`方法：

```
@Override
protected Dialog onCreateDialog(int id) {   
    Dialog dialog = null;   
    switch (id) {
        case DIALOG_SIGNUP: {
            dialog = presenter.getLoginSignupDialog();                              
            break;
        }
    }   
    return dialog;

} 
```

另一个对话框（自定义登录）显示正常，一切正常，关闭等。但我无法显示 ProgressDialog。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:27:40.100

我认为将您的进度对话框放入您的函数 activity.signup() 并在那里将其关闭会有所帮助。这应该在主 ui 线程中创建对话框。

也许您应该在登录过程中使用 AsyncTask。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:48:19.510

您应该将注册活动作为 AsyncTask 执行，如下所示：

```
 new AsyncTask<String, Void, Void>() {

        ProgressDialog progressDialog=null;

        @Override
        protected void onPreExecute() {
            progressDialog = ProgressDialog.show(activity, "", "Signing up...",false);
        }

        @Override
        protected Void doInBackground(String... params) {
            try {
                activity.signup(params[0], params[1]);

            } catch (ParseException e) {
                Toast.makeText(activity, "Sorry, an error occured.", Toast.LENGTH_SHORT).show();
                e.printStackTrace();
            }

            return null;
        }

        @Override
        protected void onPostExecute(Void result) {
            if (progressDialog != null) progressDialog.dismiss();
            dialog.dismiss();
        }
    }.execute(email.getText().toString(), password.getText().toString()); 
```

# python-2.7 - 如何更改目录或 Python 下载

> ID：12065682
> 
> 赞同：0
> 
> 时间：2012-08-22T02:38:13.490
> 
> 标签：python-2.7

我有这个脚本来下载图像。但问题是它将文件与脚本保存在同一目录中。如何更改为保存在另一个目录中？我喜欢它在这里 G:\Downloads\PICTURES

这是脚本[http://pastebin.com/raw.php?i=2PnuMNnW](http://pastebin.com/raw.php?i=2PnuMNnW)

这不是我做的，所以感谢写它的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:40:00.403

可以在[Python Docs](http://docs.python.org/library/os.html "Python 文档")中找到：

```
import os
os.chdir(/path/to/directory) 
```

将当前工作目录更改为路径。

# asp.net - .net 哪种风格更适合电子商务网站

> ID：12065687
> 
> 赞同：-1
> 
> 时间：2012-08-22T02:39:08.233
> 
> 标签：asp.net, asp.net-mvc, e-commerce

我是 ASP.NET 的新手。并且有很大的工作将 ASP 电子商务网站（它有很多定制的东西，比如业务逻辑，有自己的数据库结构）到 ASP.NET。在这里，我对一些问题感到困惑......在对这些问题进行了很多思考之后，我在这里写了这篇文章，但仍然没有解决。我估计这些工作需要 8-10 周，这是第 2 周。

*   从头开始创建电子商务网站还是修改当前可用的解决方案更好？
*   如果创建新的，比哪个更好？使用 N 层结构或 MVC 的 ASP.NET Web 窗体（没有这方面的经验）
*   MVC 使网站访问速度比 Web 窗体更快，这是真的吗？

*   还是最好花点时间，学习 MVC 并继续前进？

我想，可能有这样的问题，而不是请重定向我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:47:53.050

如果您了解 Web 表单，请使用 Web 表单。Web 表单仍然是一项很好的技术，具有出色的第三方控件。没有理由使用不熟悉的技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T19:09:57.873

我查看了提到的 EF 并遇到了[http://efvote.wufoo.com/forms/z7x3p9/](http://efvote.wufoo.com/forms/z7x3p9/) 显然有一个列表接近 1000 名专家，包括 MVP，指出除非 MS 投资于其改进，否则 EF 不再是一个可行的选择.

# iphone - UITextView 检测字符已删除

> ID：12065690
> 
> 赞同：3
> 
> 时间：2012-08-22T02:39:29.980
> 
> 标签：iphone, objective-c, ios, xcode, uitextview

我创建了一个`UITextView`允许在用户键入时进行动态标记的`@`.

是否可以检测到已`@`删除，以停止我创建的特定标记过程？如果是这样，我该怎么做？`UITextView`没有这样的委托方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:05:28.423

我会用

`- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text`

然后创建一个`NSString`用于存储添加到`UITextView`. 在上述方法中，添加以下代码段。

```
if ([text isEqualToString:@""] && [lastRecordedString isEqualToString@"@"]) {
  //do whatever you want to do when an @ is deleted
}

lastRecordedString = [textView.text substringFromIndex:[string length]-1]; 
```

编辑：请参阅上面的编辑代码。现在是删除字符后`lastRecordedString`的最后一个字符。`UITextView`这应该有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T15:52:24.657

你可以得到将被使用替换的原始文本：

```
NSString *originalText = [textView.text substringWithRange:range]; 
```

在你的

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text 
```

方法。

然后做

```
if ([originalText rangeOfString:@"tag"].length > 0) {
    NSLog(@"delete tag string");
} 
```

您将检测用户是否删除了特定字符串。

希望有帮助！

# android - 如何让音乐恢复播放？

> ID：12065696
> 
> 赞同：0
> 
> 时间：2012-08-22T02:40:34.473
> 
> 标签：android, android-activity, android-mediaplayer, android-lifecycle

我在活动 A 中开始播放音乐。当活动 B 打开时，活动 A 关闭，活动 A 中的音乐停止播放。当我返回活动 A 时，我希望音乐从中断的地方继续播放。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T13:27:48.120

您需要（持久地）存储您的媒体在活动 A 中的位置`onPause()`，`onStop()`然后`onResume()`检查存储的值并调用您的媒体`seekTo()`播放器。像这样的东西：

获取您的 SharedPreferences 对象：

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
SharedPreferences.Editor prefsEdit = prefs.edit(); 
```

存储和调用位置。

```
public void onPause(){
  super.onStop();
  //It might make more sense to do this right before you call startActivity()
  //to launch activityB then here.
  int position = mp.getCurrentPosition();
  prefsEdit.putInt("mediaPosition", position);
  prefsEdit.commit();
}

public void onResume(){
  super.onResume();
  int position = prefs.getInt("mediaPosition", 0);
  mp.seekTo(position);
} 
```

*请注意，如果您使用此方法，则当您退出 ActivityA 而不转到 B 时，您还需要将位置设置为 0。否则当您回到它时，音乐不会从头开始。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T02:46:18.310

在 Activity A 中，重写 onPause() 方法以暂停 MediaPlayer，并重写 onResume() 以恢复 MediaPlayer。并确保进入 Activity B 时 mediacontroller 对象不会被破坏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T03:28:33.483

如果您仔细观察，实际上可以看到实时媒体播放器是在服务上处理的，而不是在活动上处理的。所以我的建议是尝试在服务中编写媒体播放器，并更好地使用媒体播放器类和活动与服务的生命周期方法

# delphi - 当设置为 500 毫秒时，*某些* PC 上的 TCP 连接超时为 20 或 21 秒

> ID：12065700
> 
> 赞同：12
> 
> 时间：2012-08-22T02:41:15.587
> 
> 标签：delphi, tcp, indy10

我得到了 10 台新 PC，全部（据说）都安装了新的 Windows 7 Pro，并且没有对它们进行任何其他操作。

我有一个程序，用 Delphi XE2 编码，使用 Indy 10 组件进行网络连接。我将 TIdTcpCleint 的“连接超时”和“读取超时”属性设置为 500 毫秒，将“重新使用套接字”设置为“o/s 依赖””（我还尝试了将其设置为“否”的构建）并保留“使用 Nagle” （无论设置为真（我也尝试过假）。

这就是问题所在：当我在这些 PC 上运行相同的 .EXE 并测试我拉网线的情况时，我的调试跟踪显示连接尝试/连接超时发生在同一秒或下一秒（粒度为 1秒） - 但在其他情况下，我看到连接超时之前是 20 或 21 秒。

尽管我看到没有安装任何应用程序，但似乎有些 PC 并不像声称的那样完全“全新安装”。也许有人安装了某些东西然后将其删除，也许他们试图调整性能。

在我在 10 台 PC 上重新安装 Windows 之前，有人可以建议在哪里查看吗？关于 TCP 客户端连接超时，20（或 21）秒是否会响铃？

[更新] 我正在尝试直接连接到特定的 IP 地址，所以我不确定@Nikolai 检查 DNS 的建议是否相关。很抱歉最初没有提到这一点。

[更新] 程序不会尝试保持套接字打开。它连接、发送一些数据和断开连接——对于每条新数据重复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T11:21:38.827

可悲的是，这正在按预期工作。连接确实已经超时。Indy 确定连接将在您要求的 500 毫秒内失败。但是，这并不能保证函数会*返回*。

连接超时后，Indy 会关闭连接以释放其所有资源。它同步执行此操作。这意味着您最终会等待底层 TCP 操作失败。这通常需要 20 秒。

解决方案是在线程中调用connect。信不信由你，这就是 Indy 已经为实现超时所做的事情。但是，当它等待线程超时时，它会尝试关闭主线程中的连接。您需要将其推迟到工作线程。

至于为什么它在某些系统上立即发生，而在其他系统上则在 20 秒内发生，这取决于精确的网络配置。例如，如果启用了 IPv6，堆栈可能会尝试使用 IPv6 到 IPv4 的连接，即使物理接口关闭，也可能不会报告关闭。无法保证立即检测到无法连接，您不应依赖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T12:21:59.153

过去我在使用 INDY 时遇到过同样的问题（使用 D6 时，1998-2000 年）。我将组件更改为 IP*Works。当时它是一个外部组件，但据我所知，它包含在 XE2 中。Ip*Works 一开始有点难以理解，但他们处理通信结构的方式却大不相同。

我认为值得一试。

# linux - Oprofile 警告“无法检查二进制文件”

> ID：12065706
> 
> 赞同：1
> 
> 时间：2012-08-22T02:42:30.307
> 
> 标签：linux, linux-kernel, oprofile

我们使用 Oprofile 对内核模块进行分析，并且在 opreport 中有如下警告

```
warning: could not check that the binary file /lib/modules/2.6.32-191.el6.x86_64/kernel/fs/ext4/ext4.ko has not been modified since the profile was taken. Results may be inaccurate.
1591    samples % symbol name
1592    1622 9.8381 ext4_iget
1593    1591 9.6500 ext4_find_entry
1594    1231 7.4665 __ext4_get_inode_loc
1595    783 4.7492 ext4_ext_get_blocks
1596    752 4.5612 ext4_check_dir_entry
1597    644 3.9061 ext4_mark_iloc_dirty
1598    583 3.5361 ext4_get_blocks
1599    583 3.5361 ext4_xattr_get 
```

任何人都可以解释什么是警告，它会影响 oprofile 输出的准确性吗？无论如何可以避免这个警告吗？

任何建议表示赞赏。非常感谢！

添加更多信息：在`daemon/opd_mangling.c`

```
if (!sf->kernel)
    binary = find_cookie(sf->cookie);
else
    binary = sf->kernel->name;
...
fill_header(odb_get_data(file), counter,
        sf->anon ? sf->anon->start : 0, last_start,
        !!sf->kernel, last ? !!last->kernel : 0,
        spu_profile, sf->embedded_offset,
        binary ? op_get_mtime(binary) : 0); 
```

对于内核模块文件，`sf->kernel->name`是内核模块名称，所以填充头将始终填充`mtime`为 0 并生成不需要的警告

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:09:40.700

此失败表示有`stat`问题的文件的一个失败。做一个`strace -e stat`看看具体的故障模式。

```
time_t op_get_mtime(char const * file)
{
    struct stat st;

    if (stat(file, &st))
        return 0;

    return st.st_mtime;
}
...
    if (!header.mtime) {
        // FIXME: header.mtime for JIT sample files is 0\. The problem could be that
        //        in opd_mangling.c:opd_open_sample_file() the call of fill_header()
        //        think that the JIT sample file is not a binary file.
        if (is_jit_sample(file)) {
            cverb << vbfd << "warning: could not check that the binary file "
                  << file << " has not been modified since "
                  "the profile was taken. Results may be inaccurate.\n"; 
```

> 它是否会影响 oprofile 输出的准确性，是否有办法避免此警告？

是的，它会影响输出，因为它没有机会警告您是否“ `the last modified time of the binary file does not match that of the sample file...`”。只要您确定您测量的内容与现在安装的二进制文件相匹配，您看到的警告就是无害的。

# ruby - 使用分组时如何使用 gsub 在 Ruby 正则表达式 (regex) 中反向引用？

> ID：12065707
> 
> 赞同：29
> 
> 时间：2012-08-22T02:42:45.177
> 
> 标签：ruby, regex, reference, gsub, backreference

我想修补一些从网页中提取的文本数据。样本：

```
t="First sentence. Second sentence.Third sentence." 
```

第二句末尾的点后面没有空格。这表明第 3 句在原始文档中位于单独的行中（在 br 标记之后）。

我想使用这个正则表达式将“\n”字符插入适当的位置并修补我的文本。我的正则表达式：

```
t2=t.gsub(/([.\!?])([A-Z1-9])/,$1+"\n"+$2) 
```

但不幸的是它不起作用：“NoMethodError: undefined method `+' for nil:NilClass” 如何正确反向引用匹配的组？在 Microsoft Word 中非常简单，我只需要使用 \1 和 \2 符号。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-22T02:51:12.413

您可以在替换字符串中反向引用`\1`（以匹配捕获组 1）。

```
t = "First sentence. Second sentence.Third sentence!Fourth sentence?Fifth sentence."
t.gsub(/([.!?])([A-Z1-9])/, "\\1\n\\2") # => "First sentence. Second sentence.\nThird sentence!\nFourth sentence?\nFifth sentence." 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-08-22T03:23:29.263

*   如果您使用`gsub(regex, replacement)`, 则使用`'\1'`, `'\2'`, ... 来指代匹配。确保不要在 周围加上双引号`replacement`，或者像 Joshua 的回答那样转义反斜杠。从`'\1'`到匹配的转换将在 内完成`gsub`，而不是通过字面解释。
*   如果您正在使用`gsub(regex){replacement}`, 则使用`$1`, `$1`, ...

但是对于您的情况，不使用匹配项更容易：

```
t2 = t.gsub(/(?<=[.\!?])(?=[A-Z1-9])/, "\n") 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-02-09T00:55:09.460

如果你是因为 Rubocop 抱怨“避免使用 Perl 风格的反向引用”而来到这里的。大约 1 美元、2 美元等……你可以这样做：

```
some_id = $1
# or
some_id = Regexp.last_match[1] if Regexp.last_match

some_id = $5
# or
some_id = Regexp.last_match[5] if Regexp.last_match 
```

它也会希望你做

```
%r{//}.match(some_string) 
```

代替

```
some_string[//] 
```

跛脚（Rubocop）

# oracle - Oracle BI Publisher 10g 中的消息框

> ID：12065708
> 
> 赞同：0
> 
> 时间：2012-08-22T02:42:47.047
> 
> 标签：oracle, bi-publisher

在 Oracle BI Publisher 10g 中，我有两个参数用于起始日期和截止日期，并且输入的日期应大于起始日期。如何显示消息以提示用户重新输入截止日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:09:22.730

我认为您不能在 BI Publisher 中显示消息框。最好的方法是在用户输入此类日期时在空白报告中显示警报文本（因为查询不会返回任何数据）。

其他选项是默认`from_date`使用`{$SYSDATE()$}`和`to_date`使用，`{$SYSDATE()+7$}`即从今天开始一周的范围。

# excel - 如何将组合框的 .List 保存到变量中

> ID：12065713
> 
> 赞同：1
> 
> 时间：2012-08-22T02:44:08.560
> 
> 标签：excel, vba

我想将组合框中的所有项目存储在一个变量中。变量应该是什么类型？我试着做一个

```
Dim ComboBoxItems() As String ' dynamic array of strings 
```

但是我不确定如何将组合框中的项目复制到这个动态数组中？

我可以循环执行：

```
for i = 1 to combobox.ListCount - 1
 ComboBoxItems(i+1) = combobox.List(i)
next i 
```

（注意，我说得对吗，它真的很疯狂，动态数组是 1 索引的，而组合框列表是 0 索引的？？）

这是要走的路吗？或者肯定有一种方法可以在没有循环的情况下复制整个列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:27:52.923

对于名为的工作表上的 ActiveX ComboBox，`Combobox1`您可以使用：

```
Sub Test()
Dim vArr()
ReDim vArr(1 To ComboBox1.ListCount)
vArr = ComboBox1.List
End Sub 
```

`ComboBox1`具有组合框和命令按钮的用户窗体的相同方法`CommandButton1`

```
Private Sub CommandButton1_Click()
Dim S()
ReDim S(1 To Me.ComboBox1.ListCount)
S = Me.ComboBox1.List
End Sub

Private Sub UserForm_Initialize()
'Load some items into ComboBox
With Me.ComboBox1
.AddItem "fred, jones'"
.AddItem "mary"
.AddItem "wayne"
End With
End Sub 
```

# ios - 如何从 UITableViewController 回调到另一个 UIViewController

> ID：12065714
> 
> 赞同：0
> 
> 时间：2012-08-22T02:44:11.480
> 
> 标签：ios, uiview, uitableview

我关注了这个讨论：[UITableView issue when using separate delegate/dataSource](https://stackoverflow.com/questions/254354/uitableview-issue-when-using-separate-delegate-datasource)，尽管我发现它信息丰富且有用，但我有一个后续问题：

所以我有一个类似的设置，我在 UIView 中有一个 UITableView。UIView 由它自己的 UIViewController（我们称之为 MyUIViewController）控制，并且我将 UITableView 的委托和数据源移动到 UITableViewController 的单独子类（例如 MyUITableViewController）中。

tableView 一切正常。

问题是，如何从 MyUITableViewController 回调到 MyUIViewController？例如，如果用户在 tableView 下选择了一个触发*didSelectRowAtIndexPath*的单元格，我需要更新 UIView 上的某些内容，它实际上是这个 UITableView 的父级。所以我基本上需要向 MyUITableViewController 发送消息。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:03:56.577

在这种情况下，您可以使用委托模式。[我对这个SO](https://stackoverflow.com/questions/8055052/call-a-parent-view-controller-through-a-navigationcontroller/8055480#8055480) 中的示例代码有类似的答案。在您的情况下，父视图控制器是 MyUIViewController。而子视图控制器是 MyUITableViewController。

# php - 用逗号内爆并与 SQL 'IN' 一起使用的数组

> ID：12065717
> 
> 赞同：0
> 
> 时间：2012-08-22T02:44:33.820
> 
> 标签：php, sql, arrays, implode

为什么这个 PDO 查询不能正常工作？

```
$colors = $_GET['color'];
$colors = explode(' ', $colors);
$colors = implode(',',$colors);
$items = $con -> prepare("SELECT * FROM item_descr WHERE color_base1 IN (".$colors.")");
$items ->execute();
while($info = $items->fetch(PDO::FETCH_ASSOC)) 
{
echo $info['color_base1'];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T02:57:13.287

如果正在处理字符串，您需要`$colors`使用引号转义项目以适应语句：`IN()`

```
SELECT * FROM item_descr WHERE color_base1 IN ('blue', 'yellow', '#FF0000') 
```

可能您的`$color`变量只是逗号分隔 - 添加引号。

顺便说一句，要检查您的 MySQL 错误，请在运行查询后使用[PDO::errorInfo ：](http://php.net/manual/en/pdo.errorinfo.php)

```
var_dump($con -> errorInfo()); 
```

它将显示如下内容：

```
You have an error in your SQL syntax; [...] 
```

所以你可以修复你的查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T03:56:43.860

您需要逃避，`$colors`否则您将受到 SQL 注入攻击。有一个鲜为人知的 PHP 函数`array_fill`对此非常有用：

```
$colors = explode(' ', $_GET['color']));
$parameters = join(', ', array_fill(0, count($colors), '?');
$items = $con->prepare("SELECT * FROM item_descr WHERE color_base1 IN ({$parameters})");
$items ->execute($colors);
while($info = $items->fetch(PDO::FETCH_ASSOC))  {
    echo $info['color_base1'];
} 
```

* * *

看来您的问题是您的颜色没有用引号括起来，但是这个问题在我的代码中消失了，因为它使用了绑定参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T03:37:58.190

如果 $colors 可以包含字符串，那么您应该使用

```
function quote_value(& $value, $key) { $value = "'$value'"; }

$colors = $_GET['color'];
$colors = explode(' ', $colors);
array_walk($colors, 'quote_value');
$colors = implode(',',$colors);
// the rest of your code 
```

# android - original-package AndroidManifest 属性是做什么用的？

> ID：12065720
> 
> 赞同：16
> 
> 时间：2012-08-22T02:44:54.537
> 
> 标签：android, android-manifest

我使用 apktool 提取了 Jelly Bean 上默认浏览器的清单，这行出现在清单中——

```
 <manifest ... package="com.google.android.browser">
    <original-package android:name="com.android.browser" />
    ...
  </manifest> 
```

知道这是做什么用的吗？这

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-22T07:26:10.093

查看android/platform_frameworks_base 源代码中的[attrs_manifest.xml ：](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/values/attrs_manifest.xml#L1150)

```
<!-- Private tag to declare the original package name that this package is
     based on.  Only used for packages installed in the system image.  If
     given, and different than the actual package name, and the given
     original package was previously installed on the device but the new
     one was not, then the data for the old one will be renamed to be
     for the new package.

     <p>This appears as a child tag of the root
     {@link #AndroidManifest manifest} tag. -->
<declare-styleable name="AndroidManifestOriginalPackage" parent="AndroidManifest">
    <attr name="name" />
</declare-styleable> 
```

评论应该回答你的问题。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-22T02:59:58.227

我相信当用户 ID 不与任何其他包共享时使用原始包 AndroidManifest 属性

# performance - 为什么 RDTSC 不是序列化指令？

> ID：12065721
> 
> 赞同：24
> 
> 时间：2012-08-22T02:45:26.550
> 
> 标签：performance, x86, x86-64, cpu-architecture, cpu-cycles

RDTSC 指令的[Intel 手册](http://www.ccsl.carleton.ca/~jamuir/rdtscpm1.pdf)警告说，当 RDTSC 实际执行时，乱序执行可能会发生变化，因此他们建议在其前面插入一条 CPUID 指令，因为 CPUID 会序列化指令流（CPUID 永远不会乱序执行）。我的问题很简单：如果他们有能力让指令序列化，为什么他们不让 RDTSC 序列化？它的全部目的似乎是获得周期准确的计时。是否存在您不想在其前面使用序列化指令的*情况*？

较新的 Intel CPU 有一个单独的 RDTSCP 指令正在序列化。英特尔选择引入单独的指令，而不是更改 RDTSC 的行为，这向我表明，在某些情况下，您想要的可能是时序乱序。它是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T03:00:20.220

时间戳计数器是在 Pentium 微架构上引入的。乱序执行直到 Pentium Pro 才出现。英特尔本可以进行`rdtsc`序列化（架构上或内部），但似乎他们决定将其保持为非序列化，这对于通用时间测量来说是可以的，并留给程序员在必要时添加序列化指令。这有利于减少测量的开销。

这实际上在您提供的文档中得到了证实，并附有以下关于 Pentium 和 Pentium/MMX 的评论（在 4.2 中，稍作解释）：

> 第 4.1 节（Pentium Pro 和 Pentium II）中描述的所有规则和代码示例也适用于 Pentium 和 Pentium/MMX。唯一的区别是，CPUID 指令不是序列化所必需的。

而且，来自[维基百科](http://en.wikipedia.org/wiki/Time_Stamp_Counter)：

> 时间戳计数器是一个 64 位寄存器，自 Pentium 以来所有 x86 处理器都存在。
> 
> : : :
> 
> 从 Pentium Pro 开始，英特尔处理器支持乱序执行，其中指令不一定按照它们在可执行文件中出现的顺序执行。这可能会导致 RDTSC 的执行晚于预期，从而产生误导性的循环计数。

* * *

[RDTSCP](https://stackoverflow.com/questions/37682939/what-is-the-gcc-cpu-type-that-includes-support-for-rdtscp)的两个用途之一是为您提供*除了*时间戳信息之外的处理器 ID（它就在名称中`Read Time-Stamp Counter *AND* Processor ID`），这在跨内核或插槽的 TSC 不同步的系统上很有用（请参阅：[如何获取 CPU来自 C++ 的 x86_64 中的循环计数？](https://stackoverflow.com/questions/13772567/how-to-get-the-cpu-cycle-count-in-x86-64-from-c/51907627#51907627)）。的附加序列化属性`rdtscp`使其在感兴趣区域的末尾更方便（参见：[在测量执行时间方面，(rdtsc + lfence + rdtsc) 和 (rdtsc + rdtscp) 之间有什么区别吗？](https://stackoverflow.com/questions/59759596/is-there-any-difference-in-between-rdtsc-lfence-rdtsc-and-rdtsc-rdtscp)）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-23T11:09:32.490

如果您尝试使用 rdtsc 来查看分支是否预测错误，则非序列化版本就是您想要的。

```
//math here
rdtsc
branch if zero to done
//do some work that always takes 1 cycle
done: rdtsc 
```

如果分支预测正确，则增量会很小（甚至可能是负数？）。如果分支被错误预测，则增量会很大。

使用序列化版本，分支条件将得到解决，因为第一个 rdtsc 等待数学完成。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-22T02:54:38.873

> 他们为什么不进行 RDTSC 序列化？它的重点似乎是获得周期准确的计时

好吧，大部分时间都是为了获得高分辨率的时间戳。至少在某些时候，这些时间戳用于性能指标。使指令序列化可能需要管道刷新，这对于受 CPU 限制的应用程序来说可能非常昂贵。

> 英特尔选择引入单独的指令，而不是更改 RDTSC 的行为，这向我表明，在某些情况下，您想要的可能是时序乱序。

改变行为几乎总是不可取的。英特尔的客户会失望地发现它`RDTSC`在新部件上做了不同的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T17:18:38.963

正如 paxdiably 解释的那样，`RDTSC`它早于“序列化”指令的概念，因为它是在有序 CPU 上实现的。稍后添加该行为会改变使用它的代码的内存访问行为，因此对于某些目的是不兼容的。

相反，最近的 CPU 有一条相关的`RDTSCP`指令，**被**定义为序列化（实际上更强大：它承诺等到**所有**指令在它完成之前发出，而不仅仅是内存访问已经完成），正是出于这个原因。如果您在现代 CPU 上运行，请使用它。

# ios - 发送到已释放实例的消息 - 程序停止

> ID：12065728
> 
> 赞同：1
> 
> 时间：2012-08-22T02:46:39.933
> 
> 标签：ios, xcode

我在 xcode 上遇到了一些奇怪的行为。我没有得到确切的错误，但代码执行停止在`bkpt #207`不提供堆栈跟踪。

在我的程序中，每当切换标签时，我都会弹出ToRootViewController。上述行为发生在我以编程方式从 MyViewController（堆栈中的第 3 个）弹出然后再次单击选项卡之后。我可以确认 MyViewController 被正确弹出。

使用 NSZombiesEnabled，我得到以下输出：

`*** -[MyViewController tableView:titleForHeaderInSection:]: message sent to deallocated instance 0x6a4a00`

我的预感是 MyViewController 的一些残余仍然链接到该选项卡栏。我正在使用 [self.tabBarController setSelectedIndex:kOtherTab] 以编程方式切换选项卡。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T21:21:33.487

我在 bkpt #207 停止调用 NSTimer：

```
[Timer invalidate];
[Timer release]; 
```

正确只是打电话

```
[Timer invalidate]; 
```

并且在 bkpt #207 的停止消失了。

*   无效包括发布。
*   人们会期望获得一个 SIGABRT 或 EXC_BAD_ACCESS 错误，以便将释放发送到一个不存在的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T23:35:44.673

看起来由于某种原因，在委托被解除分配后，tableview 正在调用它的委托（MyViewController）。

最好的办法是让 MyViewController 在释放时将 tableView 的委托设置为 nil。

# php - PHP preg_replace 需要改进

> ID：12065730
> 
> 赞同：0
> 
> 时间：2012-08-22T02:47:02.113
> 
> 标签：php, regex, preg-replace

好的，我有一个字符串如下：

```
$disallowedBBC = 'abbr|acronym|anchor|bdo|black|blue|br|color|email|flash|font|ftp|glow|green|html|hr|img|iurl|li|list|ltr|url|quote'; 
```

而不是`preg_replace`实际字符串（变量）上的a 应该摆脱根据变量`$message`不允许的所有 bbc 代码：`$disallowedBBC`

```
$message = preg_replace("/\[($disallowedBBC)[^]]*](.*?)\[\/($disallowedBBC)\]/is", "$2", $message); 
```

但是，由于某种原因，`[hr]`标签正在通过这个 preg_replace。所以，在这种情况下：

```
$message = '[hr]Test'; 
```

它输出`[hr]`标签，但应该删除它。我的正则表达式有什么问题？

基本上...

如何更改它以完全删除所有 [hr] 和/或 [hr]Test[/hr]？但也需要摆脱 [url=http://someurl.com]Some Url[/url] 的实例。它应该`[color=red]`从字符串中删除，如下所示：`[color=red]Testing`

例如，它需要去掉`[{tag}]`并且如果它有一个结束标签`[/{tag}]`，但如果没有结束标签，它需要去掉开始标签，反之亦然。它应该能够捕获括号内 {tag} 内的任何内容，例如： `[quote author=Solomon time=7834783470]Just a quote here[/quote] Additional text here...`

所以，这应该输出： `Just a quote here Additional text here...`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:05:41.457

我认为你需要两个 preg_replaces。一个是首先摆脱成对的 [hr]...[/hr]，然后是第二个摆脱任何剩余的 [hr]...

```
$message = preg_replace("/\[($disallowedBBC)[^\]]*](.*?)\[\/($disallowedBBC)\]/is", "$2", $message);
$message = preg_replace("/\[($disallowedBBC)[^\]]*]/is", "", $message); 
```

如果您尝试一步完成，那么“abc[br]blahblah[hr]gak[/hr]def”之类的内容将变为“abcdef”。如果您可以对 blahblah 部分设置限制，您也许可以做到这一点。

当然，您可以使用数组语法将这些组合成一个 preg_replace 调用（但请记住，顺序很重要）：

```
$patterns = array("/\[($disallowedBBC)[^\]]*](.*?)\[\/($disallowedBBC)\]/is",
                  "/\[($disallowedBBC)[^\]]*]/is", );
$replacements = array("$2", "");
$message = preg_replace($patterns, $replacements, $message); 
```

# django - 带有表单集和表单的 Django 表单向导在同一页面上

> ID：12065743
> 
> 赞同：2
> 
> 时间：2012-08-22T02:49:16.077
> 
> 标签：django, django-forms, django-1.4, django-formwizard

我正在使用 Django 1.4 FormWizard（特别是 NamedUrlFormWizard）

首先，基础知识。我正在构建一个 3 步表单向导。最终的结果是定义一个模板，然后选择一些人来使用它，然后给他们发送一封电子邮件。

*   第 1 步 - 输入基本模板数据（名称、描述等）
*   第 2 步 - 定义 N 个字段的列表，每个字段都有自己的属性集，但结构相同
*   第 3 步 - 选择一个或多个用户发送电子邮件，并在保存前自定义此电子邮件的内容

到目前为止，在表单向导中：

*   第 1 步是一个标准的 Form 类，工作得很好。
*   第 2 步是一个标准的 Formset 类，工作得很好。
*   第3步给我带来了一些麻烦。它需要是一个表单集（电子邮件地址列表），还需要一个带有电子邮件文本的附加表单输入字段。我不知道如何在表单向导的同一页面上同时拥有一个表单集和非重复表单输入。

在一个完美的世界中，我可以将 Formset 定义为表单定义中的另一个表单字段。IE：

```
class EmailAddressForm(forms.Form):
    email = forms.EmailField()

class EmailAddressesAndText(forms.Form):
    emailText = forms.Textarea()
    emailAddressFormSet = formset_factory(EmailAddressForm, etc etc) 
```

然后将我的 FormWizard 页面指向“EmailAddressesAndText”并完成它。但它不是一个完美的世界。关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T04:16:49.103

您可以使用`get_form()`的方法`WizardView`自定义特定步骤的表单。参考：[WizardView.get_form](https://docs.djangoproject.com/en/dev/ref/contrib/formtools/form-wizard/#django.contrib.formtools.wizard.views.WizardView.get_form)。[这个答案可以帮助你添加一个字段](https://stackoverflow.com/questions/6142025/django-dynamically-add-field-to-a-form)

另一种选择是在表单集中添加字段，并通过 JS 禁用和隐藏除第一个之外的所有实例。

# sql-server - 为了将基于 Entity Frameworks 4.1 的代码转换为使用与 SQL Server 的常规连接，我应该做些什么更改？

> ID：12065745
> 
> 赞同：0
> 
> 时间：2012-08-22T02:49:32.740
> 
> 标签：sql-server, entity-framework-4.1

VS2010 C# SQL Server 2008 Express 我使用 Entity Frameworks 4.1 开发了几个应用程序。我使用了数据库优先方法（我认为），因为我在 Visual Studio 2010 中创建了一个数据库，然后创建了一个模型，最后创建了模型中的代码来访问数据库。这很有效，我发现 IDE 和应用程序使用 SQL Server 2008 Express 的用户实例。

我发现用户实例不再流行并且已被弃用。所以我想我应该将数据库基础文件移动到 SQL Server 的数据目录中。很容易。

但是现在，如果我从连接字符串中删除用户实例并将其指向主 SQL Server，EF 基础结构会继续工作吗？我必须重新生成模型吗？我还应该采取其他措施吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:31:23.497

您可以使用 app.config 或 web.config 文件为您的应用程序设置连接字符串。像添加任何其他应用程序一样添加连接字符串：

```
<configuration>
    <connectionStrings>
       <add name="sampleName"
            providerName="System.Data.SqlClient"
            .... 
```

接下来，为您的 DbContext 将其指向您的连接字符串：

```
public class sampleContext : DbContext
{
    public sampleContext() : base("name=sampleName")
} 
```

有了这些，您应该能够设置您喜欢的任何配置字符串。考虑到这一点，我还想向您指出这篇关于迁移数据库的文章：http: [//msdn.microsoft.com/en-us/data/jj554735](http://msdn.microsoft.com/en-us/data/jj554735)

# java - Java中的装饰器

> ID：12065750
> 
> 赞同：19
> 
> 时间：2012-08-22T02:50:44.977
> 
> 标签：java, python, annotations

我在 Python 中看到了装饰器[示例：](https://stackoverflow.com/questions/739654/understanding-python-decorators)

```
def makebold(fn):
    def wrapped():
        return "<b>" + fn() + "</b>"
    return wrapped

def makeitalic(fn):
    def wrapped():
        return "<i>" + fn() + "</i>"
    return wrapped

@makebold
@makeitalic
def hello():
    return "hello world"

print hello() ## returns <b><i>hello world</i></b> 
```

并且很好奇它是如何在 Java 中实现的，所以我搜索并获得了一些使用[Decorator Design Pattern](http://sourcemaking.com/design_patterns/decorator)的示例。

```
public class Main {

    public static void main(String[] args) {
        Wrapper word = new BoldWrapper(new ItalicWrapper());
        // display <b><i>hello world</i></b>
        System.out.println(word.make("Hello World"));
    }
}

public interface Wrapper {

    public String make(String str);

}

public class BoldWrapper implements Wrapper {

    private Wrapper wrapper;

    public BoldWrapper() {

    }

    public BoldWrapper(Wrapper wrapper) {
        this.wrapper = wrapper;
    }

    @Override
    public String make(String str) {
        if(wrapper != null) {
            str = wrapper.make(str);
        }

        return "<b>" + str + "</b>";
    }

}

public class ItalicWrapper implements Wrapper {

    private Wrapper wrapper;

    public ItalicWrapper() {

    }

    public ItalicWrapper(Wrapper wrapper) {
        this.wrapper = wrapper;
    }

    @Override
    public String make(String str) {
        if(wrapper != null) {
            str = wrapper.make(str);
        }

        return "<i>" + str + "</i>";
    }

} 
```

**如何使用像上面的 Python 示例一样使用这样的 Java 注释**：

```
public class Main {
    public static void main(String[] args) {
        @BoldWrapper
        @ItalicWrapper
        String str = "Hello World";
        // Display <b><i>Hello World</i></b>
    }
}

public @interface BoldWrapper {
    public void wrap() default "<b>" + str + "</b>";
}

public @interface ItalicWrapper {
    public void wrap() default "<i>" + str + "</i>";
} 
```

当我尝试制作示例时遇到了一些问题，问题是我不知道**如何将`str`值从`main`方法传递给`BoldWrapper`，`ItalicWrapper`所以它可以连接**以及**如何返回它，所以`main`方法可以显示结果已串联**。

*请告知我对注释的理解是否有问题。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T03:23:49.490

如果您对使用注释做这种事情特别感兴趣（您不必真的这样做）：

这个例子应该让你开始：

```
public class AnnotationTest
{
    @Target( ElementType.METHOD )
    @Retention( RetentionPolicy.RUNTIME )
    public static @interface TagWrapper
    {
        public String[] value() default {};
    }

    public static interface TextFragment
    {
        public String getText();
    }

    public static class TagWrapperProcessor
    {
        public static String getWrapperTextFragment( TextFragment fragment )
        {
            try
            {
                Method getText = fragment.getClass().getMethod( "getText" );
                TagWrapper tagWrapper = getText.getAnnotation( TagWrapper.class );
                String formatString = "<%s>%s</%s>";
                String result = ( String ) getText.invoke( fragment );
                for ( String tag : tagWrapper.value() )
                {
                    result = String.format( formatString, tag, result, tag );
                }
                return result;
            }
            catch ( Exception e )
            {
                throw new RuntimeException( e );
            }
        }
    }

    public static class BoldItalicFragment implements TextFragment
    {

        private String _text;

        public BoldItalicFragment( String text )
        {
            _text = text;
        }

        @Override
        @TagWrapper(
        {
            "b", "i"
        } )
        public String getText()
        {
            return _text;
        }

    }

    @Test
    public void testStuff()
    {
        System.out.println( TagWrapperProcessor.getWrapperTextFragment( new BoldItalicFragment( "Hello, World!" ) ) ); // prints: <i><b>Hello, World!</b></i>
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-04-04T04:35:33.203

这已经晚了，但我认为它可能会帮助其他人。从带有 Function 接口的 Java 8 开始，我们可以编写类似于 python 装饰器的东西，如下所示：

```
Function<Function<String, String>, Function<String, String>> makebold = func -> input -> "<b>" + func.apply(input) + "</b>";
Function<Function<String, String>, Function<String, String>> makeitalic = func -> input -> "<i>" + func.apply(input) + "</i>";

Function<String, String> helloWorld = input -> "hello world";
        System.out.println(makebold.apply(makeitalic.apply(helloWorld)).apply("")); // <b><i>hello world</i></b> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T03:00:34.593

1）您引用的链接是一个很好的链接 - 它对 Java 的“装饰器模式”很公平。当然，“设计模式”本身独立于任何特定的 OO 语言：

*   [http://en.wikipedia.org/wiki/Design_Patterns](http://en.wikipedia.org/wiki/Design_Patterns)

2）这是另一个很好的链接：

*   [何时使用装饰器模式](https://stackoverflow.com/questions/1549743/when-to-use-the-decorator-pattern)

在 Java 中，装饰器模式的一个经典示例是 Java I/O Streams 实现。

```
FileReader       frdr = new FileReader(filename);
LineNumberReader lrdr = new LineNumberReader(frdr); 
```

4）所以是的，“装饰者模式”是这个问题的一个很好的候选者。

就个人而言，我更喜欢这种解决方案：

```
 String myHtml = 
     new BoldText (
       new ItalicText (
         new HtmlText ("See spot run"))); 
```

5）但是注释也是一种选择。例如：

*   [http://docs.oracle.com/javase/1.5.0/docs/guide/language/annotations.html](http://docs.oracle.com/javase/1.5.0/docs/guide/language/annotations.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-30T00:24:23.113

尽管这不能解决如何根据需要使用注释，而不是使用“装饰器设计”，但如果它更适合您的需求（看起来如此），我可以建议您使用“构建器设计”。

快速使用示例：

```
public class BuilderPatternExample {

    public static void main(String args[]) {

        //Creating object using Builder pattern in java
        Cake whiteCake = new Cake.Builder()
                                 .sugar(1)
                                 .butter(0.5)
                                 .eggs(2)
                                 .vanilla(2)
                                 .flour(1.5)
                                 .bakingPowder(0.75)
                                 .milk(0.5)
                                 .build();

        //Cake is ready to eat :)
        System.out.println(whiteCake);
    }
} 
```

**输出：** 蛋糕{糖=0.75，黄油=0.5，鸡蛋=2，香草=2，面粉=1.5，发酵粉=0.0，牛奶=0.5，樱桃=0}

有关完整的实现和很好的解释，请查看 [http://javarevisited.blogspot.mx/2012/06/builder-design-pattern-in-java-example.html](http://javarevisited.blogspot.mx/2012/06/builder-design-pattern-in-java-example.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-22T12:24:20.490

Python 装饰器非常喜欢 java 注释，但原理却大不相同。

> 注释是元数据的一种形式，提供有关程序的数据，这些数据不属于程序本身。注释对其注释的代码的操作没有直接影响。

但是您可以使用字节码增强处理类文件。我做了一个简单的项目来实现这种方法。它在构建后使用`javassist`处理类文件。它在类中搜索具有指定注释的方法。并在包装方法和原始方法之间添加桥接方法进行调用。看起来，调用`bridgeMethod() -> wrapperMethod() -> originalMethod()`. 您可以参考[https://github.com/eshizhan/funcwraps](https://github.com/eshizhan/funcwraps)。

# c - 如何按顺序打印 ZOJ 字符串？

> ID：12065758
> 
> 赞同：0
> 
> 时间：2012-08-22T02:52:12.800
> 
> 标签：c, algorithm

我必须按“ZOJ”顺序输出每个字符串。字符串的长度是从 1 到 100。“E”表示输入的结尾。

我用 gcc 测试我的程序。我尝试了很多例子，输出很好。然而，网上的判断竟然是错误的答案。

例子：

输入：

ZZOOOJJJ

ZZZZOOOOOOJJJ

动物园

乙

输出：

ZOJZOJOJ

ZOJZOJZOJZOO

ZOJOJO

谢谢！这是我的代码。

```
#include<stdio.h>
#include<string.h>

#define MAX_SIZE 100

main() {

char data[MAX_SIZE];
int len;
int z,o,j;
int i;
char c;

int z_index, o_index,j_index;

while(scanf("%s", data)!= EOF && (strlen(data)>=1 && data[0] != 'E')) {
    len = strlen(data);

    z = -1;
    o = -1;
    j = -1;
    z_index = -1;
    o_index = -1;
    j_index = -1;

    for(i=0; i<len; i++) {
        c = data[i];
        switch(c) {
            case 'Z':
                if(z==-1)
                    z_index=i,z=i;
                else
                    z = i;
                break;
            case 'O':
                if(o==-1)
                    o_index=i,o=i;
                else
                    o = i;
                break;
            case 'J':
                if(j==-1)
                    j_index=i,j=i;
                else
                    j = i;
                break;
        }

    }

    while(z_index!=-1 || o_index!=-1 || j_index!=-1) {
        if(z_index!=-1 && z_index<=z)
            putchar('Z'), z_index++;
        else
            z_index = -1;

        if(o_index!=-1 && o_index<=o)
            putchar('O'), o_index++;
        else
            o_index = -1;

        if(j_index!=-1 && j_index<=j)
            putchar('J'), j_index++;
        else
            j_index = -1;

    }
    putchar('\n');
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T09:07:33.313

你真的应该让你的函数 int main() 而不仅仅是 main() 因此你应该在最后返回 0 。

```
#include<stdio.h>
#include<string.h>

#define MAX_SIZE 100

int main() {
    char data[MAX_SIZE];
    int len;
    int z,o,j;
    int i;
    char c;

    int z_index, o_index,j_index;

    while(scanf("%s", data)!= EOF && (strlen(data)>=1 && data[0] != 'E')) {
        len = strlen(data);

        z = -1;
        o = -1;
        j = -1;
        z_index = -1;
        o_index = -1;
        j_index = -1;

        for(i=0; i<len; i++) {
            c = data[i];
            switch(c) {
                case 'Z':
                    if(z==-1)
                    z_index=i,z=i;
                    else
                    z = i;
                    break;
                case 'O':
                    if(o==-1)
                    o_index=i,o=i;
                    else
                    o = i;
                    break;
                case 'J':
                    if(j==-1)
                        j_index=i,j=i;
                    else
                        j = i;
                    break;
            }
        }

        while(z_index!=-1 || o_index!=-1 || j_index!=-1) {
            if(z_index!=-1 && z_index<=z)
                putchar('Z'), z_index++;
            else
                z_index = -1;

            if(o_index!=-1 && o_index<=o)
                putchar('O'), o_index++;
            else
                o_index = -1;

            if(j_index!=-1 && j_index<=j)
                putchar('J'), j_index++;
            else
                j_index = -1;
        }
        putchar('\n');
    }
    return 0;
} 
```

# node.js - 如何使用 mongoexport 和 mongoimport？

> ID：12065759
> 
> 赞同：-3
> 
> 时间：2012-08-22T02:52:14.797
> 
> 标签：node.js, mongodb

我需要使用 mongoexport 来存储一些文档，并使用 mongoimport 将它们放在远程服务器上。我查看了手册页并四处寻找一些好的示例，但我还没有看到任何足够具体的内容。

我的数据库中有一堆“Office”类型的文档要导出，但我不知道如何正确使用 mongoexport。非常感谢任何提示或指向好的示例的链接。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T13:23:00.213

要指定一个集合，请使用 -c 开关

例如：

```
mongoexport -d databasename -c CollectionName -o outputfile.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T04:42:02.977

从文档[http://www.mongodb.org/display/DOCS/Import+Export+Tools](http://www.mongodb.org/display/DOCS/Import+Export+Tools)

```
This utility takes a single file that contains 1 JSON/CSV/TSV string 
per line and inserts it. You have to specify a database and a collection. 
```

说你不知道它做了什么很奇怪。

# iphone - 在 self.view 上加载子视图

> ID：12065761
> 
> 赞同：0
> 
> 时间：2012-08-22T02:52:50.103
> 
> 标签：iphone, ios, uiview

我正在尝试在当前视图上添加 UIView，但没有运气.. 我确定我的代码是正确的，但不确定还要检查什么，插入子视图时我还应该考虑什么

这就是我添加到 viewDidLoad 中的内容

```
//..
    cellContainer = [[UIView alloc] init];

    cellContainer.frame = CGRectMake(0.0, 480.0, 320.0, 300.0);

    [self.view addSubview:cellContainer];

    self.view.backgroundColor = [UIColor greenColor];
//.. 
```

cellContainer 在标题中声明为 UIView ......任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T03:00:21.073

`cellContainer`可能会添加到 的视图层次结构中`UIViewController`，但您已将框架设置为不在屏幕上。试试这个：

```
 cellContainer = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 300)];
 [self.view addSubview:cellContainer];
 self.view.backgroundColor = [UIColor greenColor]; 
```

这将显示`cellContainer`在视图的左上角，在右 x 方向上延伸 320 像素，在下 y 方向上延伸 300 像素。

# resources - Dns Server (edns)opt 资源记录类型

> ID：12065762
> 
> 赞同：1
> 
> 时间：2012-08-22T02:52:53.420
> 
> 标签：resources, dns, record

我想向 dns 服务器绑定 9 请求一个 opt 资源记录消息。

但我不知道格式和服务器配置。

[http://www.ietf.org/rfc/rfc2671.txt](http://www.ietf.org/rfc/rfc2671.txt)这个文档是 edns 文档。

我创建了按照文档格式化的消息，但它不起作用。服务器告诉我格式错误。

请求消息：

```
Question Record:
QName:a6.debian.com
QType:0x41(OPT type)
QClass:0x01(Internet)
Additional Record:
Resource Name:0xc0,0x0c( pointer to QName)
Resource Type:0x41
ResourceClass:512(udp payload size)
TimeToLive:0x1EF0000(split to extent-code version and Z)
ResourceDataLength:0x08
Rdata:(OPTRdata):
    OptCode:0x4000
    OptLength:0x04
    OptData:0x0A,0x0A,0x0A,0x0A 
```

怎么了？？？你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T08:18:30.667

没有 OPT 类型记录。OPT 是*伪*记录类型。你不能查询它。您使用 OPT 将一些特定参数传递给 DNS 服务器，例如 EDNS。此外，它只能出现在“附加”部分

# jquery - 按下Ctrl键时jQuery单击功能在IE中不起作用

> ID：12065763
> 
> 赞同：2
> 
> 时间：2012-08-22T02:52:59.370
> 
> 标签：jquery, click

我正在使用 jQuery 为 IE 浏览器开发 Web 应用程序。我们知道，要在新选项卡中打开链接，用户通常在单击该链接时按住 Ctrl 键。但是，在我的代码中，不会调用绑定到链接的点击函数。我在 Chrome 和 Firefox 中尝试了相同的页面。它工作完美。这是为什么？有没有想过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:04:31.433

您可以指定在 ctrl+click 的情况下要执行的操作。见这里：http: [//forum.jquery.com/topic/jquery-detecting-ctrl-click-on-an-element#14737000000282851](http://forum.jquery.com/topic/jquery-detecting-ctrl-click-on-an-element#14737000000282851)

# c# - LINQ C#从字符串中选择字符

> ID：12065764
> 
> 赞同：7
> 
> 时间：2012-08-22T02:53:34.143
> 
> 标签：c#, linq

我有一个字符串，我将其转换为 char 数组，然后使用 LINQ 选择 char 数组中的不同字符，然后按降序对它们进行排序，但只捕获字符，而不是标点符号等...

这是代码：

```
string inputString = "The black, and, white cat";
var something = inputString.ToCharArray();
var txtEntitites = something.GroupBy(c => c)
                   .OrderByDescending(g => g.Count())
                   .Where(e => Char.IsLetter(e)).Select(t=> t.Key); 
```

我得到的错误信息：

*   错误 CS1502：“char.IsLetter(char)”的最佳重载方法匹配有一些无效参数 (CS1502)

*   错误 CS1503：参数“#1”无法将“System.Linq.IGrouping<char,char>”表达式转换为“char”类型 (CS1503)

有任何想法吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T02:56:29.357

试试这个：

```
string inputString = "The black, and, white cat"; 
var something = inputString.ToCharArray();  
var txtEntitites = something.GroupBy(c => c)
                            .OrderByDescending(g => g.Count())
                            .Where(e => Char.IsLetter(e.Key))
                            .Select(t=> t.Key); 
```

注意`Char.IsLetter(e.Key))`

另一个想法是重新排列您的查询：

```
var inputString = "The black, and, white cat"; 
var txtEntitites = inputString.GroupBy(c => c)
                              .OrderByDescending(g => g.Count())
                              .Select(t=> t.Key)
                              .Where(e => Char.IsLetter(e)); 
```

另请注意，您不需要调用，`inputString.ToCharArray()`因为`String`已经是`IEnumerable<Char>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T02:56:10.567

在您的 where 子句中，`e`在这种情况下是您的分组，而不是字符。如果要检查字符是否为字母，则应测试密钥。

```
//...
.Where(g => Char.IsLetter(g.Key)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-02T14:42:03.290

```
List<char> charArray = (
      from c in inputString
      where c >= 'A' && c <= 'z'
      orderby c
      select c
   ).Distinct()
   .ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T04:03:26.287

我想这就是你要找的

```
string inputString = "The black, and, white cat";
var something = inputString.ToCharArray();
var txtEntitites = something.Where(e => Char.IsLetter(e))
                   .GroupBy(c => c)
                   .OrderByDescending(g => g.Count()).Select(t=> t.Key); 
```

# webpage - 如何制作缺少文件扩展名的网站？

> ID：12065767
> 
> 赞同：0
> 
> 时间：2012-08-22T02:53:46.580
> 
> 标签：webpage, directory, subdirectory

所以我习惯于在 asp.net 中使用母版页和 .aspx 文件扩展名对站点进行编码。然而，我越来越多地看到完全缺少文件扩展名的网站。示例：www.example.com/subpage1。因为我的非工作电脑是一台 mac，而且 asp.net 几乎没有，我认为我的下一个自由职业项目将是一个很好的起点。

我想我会给页面 .php 扩展名，因为 php 包含功能很容易实现。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:03:24.990

URL 不代表文件。它们就是资源位置。

Web 服务器决定如何将位置解释为资源，并发送回响应。

Apache，一个与 PHP 一起使用的通用 Web 服务器，可以使用该`mod_rewrite`模块来配置带有正则表达式的路径，并将它们映射到不同的本地资源（例如 PHP 文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:04:01.737

这些称为搜索引擎优化 (SEO) URL（有时称为搜索引擎友好 URL）。听起来首先你可能需要对 PHP 和其他通用编程基础有一个很好的基本了解。

这里有一些链接可以让您走上正确的道路：

*   [初学者的 URL 重写](http://www.addedbytes.com/for-beginners/url-rewriting-for-beginners/)
*   [Apache URL 重写指南](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)
*   [初学者 PHP 教程](http://www.webmonkey.com/2010/02/php_tutorial_for_beginners/)

我相信其他人可以提供一些更有用的链接。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T01:10:14.230

阅读上面 bdares 和 tptcat 提供的链接。这是我用过的一些...

这两个给每个人一个 URL，比如`example.com/~person/`and `example.com/~person/gallery`：

```
RewriteRule   ^~([^/]+)/?$ artist.php?name=$1
RewriteRule   ^~([^/]+)/([^/]+)/?$ artist.php?name=$1&gallery=$2 
```

这三个允许查看/添加/删除链接显示为`example.com/View/Some_group/~person/55/`, `example.com/Add/Some_group/~person/55/`, `example.com/Delete/Some_group/~person/55/`:

```
RewriteRule   ^View/([a-z0-9]+)_group/~([^/]+)/([0-9]+)/?$ details.php?a=$2&p=$3&c=$1 [NC]
RewriteRule    ^Add/([a-z0-9]+)_group/~([^/]+)/([0-9]+)/?$ details.php?a=$2&p=$3&c=$1&add=1 [NC]
RewriteRule ^Remove/([a-z0-9]+)_group/~([^/]+)/([0-9]+)/?$ details.php?a=$2&p=$3&c=$1&remove=1 [NC] 
```

等等...

# java - 获取Java中的绝对路径

> ID：12065772
> 
> 赞同：0
> 
> 时间：2012-08-22T02:54:40.083
> 
> 标签：java

我有字符串：

`String s = "~/abc/d.png"`

如何获取此文件的绝对路径？

我试过了：

```
File file = new File(s);
String absolutePath = file.getAbsolutePath(); 
```

但它不能爱～符号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T02:57:26.540

Java 不会知道这`~`意味着什么，因为它是您主目录的外壳扩展。您可以在将其交给以下人员之前执行此操作`File`：

```
s = s.replace("~",System.getProperty("user.home")); 
```

# arrays - 为什么缓存位置对阵列性能很重要？

> ID：12065774
> 
> 赞同：82
> 
> 时间：2012-08-22T02:55:23.117
> 
> 标签：arrays, language-agnostic, linked-list

在下面的[博客](http://www.geeksforgeeks.org/archives/10245)中，有一个关于数组优于链表的声明：

> 数组具有更好的缓存局部性，可以在性能上产生相当大的差异。

这意味着什么？我不明白缓存局部性如何提供巨大的性能优势。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-08-22T03:00:10.853

[请参阅我关于时空局部性](https://stackoverflow.com/a/7812002/950912)的回答。

特别是，数组是连续的内存块，因此它们中的大块将在第一次访问时加载到缓存中。这使得访问数组的未来元素相对较快。另一方面，链表不一定位于连续的内存块中，并且可能导致更多的缓存未命中，从而增加了访问它们所需的时间。

考虑以下可能的内存布局，用于数组和大型结构的`data`链表`l_data`

```
Address      Contents       | Address      Contents
ffff 0000    data[0]        | ffff 1000    l_data
ffff 0040    data[1]        |   ....
ffff 0080    data[2]        | ffff 3460    l_data->next
ffff 00c0    data[3]        |   ....
ffff 0100    data[4]        | ffff 8dc0    l_data->next->next
                            | ffff 8e00    l_data->next->next->next
                            |   ....
                            | ffff 8f00    l_data->next->next->next->next 
```

如果我们想遍历这个数组，第一次访问`ffff 0000`将需要我们去内存中检索（CPU 周期中的一个非常慢的操作）。但是，在第一次访问之后，数组的其余部分将在缓存中，后续访问会快得多。使用链表，第一次访问`ffff 1000`也需要我们去记忆。不幸的是，处理器将直接缓存该位置周围的内存，比如说一直到`ffff 2000`. 如您所见，这实际上并没有捕获列表的任何其他元素，这意味着当我们访问时`l_data->next`，我们将再次访问内存。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-22T03:01:17.630

通常，在使用数组时，您会访问彼此靠近的项目。在顺序访问数组时尤其如此。

当你访问内存时，它的一部分被缓存在不同的级别。 *缓存局部性*是指连续操作在缓存中的可能性，因此速度更快。在数组中，您可以最大限度地提高顺序元素访问在缓存中的机会。

对于列表，作为反例，不能保证在列表中按顺序出现的项目实际上在内存中彼此靠近排列。这意味着更少的缓存命中和性能下降。

# php - 如何在 symfony2 中将三个 Doctrine 查询转换为单个查询

> ID：12065778
> 
> 赞同：-1
> 
> 时间：2012-08-22T02:56:00.540
> 
> 标签：php, symfony, doctrine-orm

我在我的控制器中这样做

```
$C100 = $em->getRepository('AcmeJunkieBundle:Junk')->findBy(array('type'=> 'C100'),array('day' => 'ASC'));
$C200 = $em->getRepository('AcmeJunkieBundle:Junk')->findBy(array('type'=> 'C200'),array('day' => 'ASC'));
$C300 = $em->getRepository('AcmeJunkieBundle:Junk')->findBy(array('type'=> 'C300'),array('day' => 'ASC')); 
```

'type' 只是字符串字段

有没有办法在单个查询中做到这一点，然后做类似的事情

```
$C100 = $result['C100']
$C200 = $result['C200']
$C300 = $result['C200'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:19:51.687

我们需要了解您的`Junk`实体：`type`只是一个字符串字段吗？

无论如何，您可以在关联的存储库类中编写自己的存储库方法：您的`Junk`类源将是这样的，我假设：

**src/Acme/JunkieBundle/Entity/Junk.php**

```
namespace Acme\JunkieBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity(repositoryClass="Acme\JunkieBundle\Repository\JunkRepository")
 * @ORM\Table(name="junk")
 */

class Junkie{ ... } 
```

确保您有一个带有存储库类名称的注释，然后编写该类 - 由`$C100 = $em->getRepository()`控制器中的方法获取的类。

**src/Acme/JunkieBundle/Repository/JunkRepository.php**

```
namespace Acme\JunkieBundle\Repository;

use Doctrine\ORM\EntityRepository;

class JunkRepository extends EntityRepository
{

    public function findByTypes(array $types)
    {

        //we build our query here           
        $qb = $this -> createQueryBuilder();

        $query = $qb -> where( $qb -> expr() -> in ('type', $types) )
        -> getQuery();

        return $query -> getResults();

    }

} 
```

现在你可以打电话

```
$em->getRepository('AcmeJunkieBundle:Junk')->findByTypes(array('C100', 'C200', 'C300')) 
```

在您的控制器中。

请务必查看[Doctrine](http://docs.doctrine-project.org/en/latest/index.html)文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T05:43:00.700

你可以这样做：

```
$em->getRepository('AcmeJunkieBundle:Junk')
   ->findBy(array('type'=> array('C100', 'C200', 'C300')),array('day' => 'ASC')); 
```

;） 谢谢

# php - onClick 按钮不起作用 javascript/php/jquery mobile

> ID：12065782
> 
> 赞同：0
> 
> 时间：2012-08-22T02:56:34.263
> 
> 标签：php, javascript, jquery-mobile

谁能告诉我为什么这个 onClick 不起作用？该函数位于一个单独的 .js 文件中，并且已经过测试可以正常工作。我没有收到错误 - 什么都没有发生。

```
<?php
blah blah
$int = 1;
$listno = 3;
?>

<input type="button" onClick="test(<?php echo $int;?>, <?php echo $listno;?>);" data-theme="mybutton" value="<?php echo $name;?>">

<?php
.... 
```

我在这里需要脚本标签吗？抱歉，如果 php 位有点错误，我只是输入它来向您展示 - 按钮是问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:00:28.983

我没有看到 JavaScript 中定义的 test() 函数

# xcode - 更新 Xcode 4.4 SVN 中的单个文件

> ID：12065785
> 
> 赞同：2
> 
> 时间：2012-08-22T02:57:09.740
> 
> 标签：xcode, svn

我可以在 Xcode 4.3 的 SVN 项目中“更新”时选择单个文件。我可以查看哪些文件已更改和提交。

但是在我将 Xcode 升级到 4.4 后，当我从菜单栏中单击“文件 > 源代码管理 > 更新”或单击管理器中的“更新”时，没有更新的文件列表出现，只有很小的更新幻灯片下来。它无需我的选择即可更新整个更改的文件。

我知道我可以通过右键单击特定文件并选择“源代码管理 > 更新选定文件”来更新它，但我想在 Xcode 4.4 之前的一个窗口中查看整个更改的文件。

我该怎么做？谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T05:43:47.627

看起来您想做“更新...”而不是“更新”。

您可以在 File-->Source Control 下显示它并按住 control 键。

它看起来像在 XCode 4.4 中。默认源代码管理选项已切换如下：

**Xcode 4.4+** - 默认 = “*更新*”

“*更新*” (Cmd+Opt+X) - 静默更新所有文件，除非存在需要手动更正的合并冲突

“*更新...* ” (Ctrl+Cmd+Opt+X) - 更新所有文件，允许您验证/合并更新的文件

**Xcode 4.3** - 默认 = “*更新...* ”

“*更新...* ” (Ctrl+Cmd+Opt+X) - 更新所有文件，允许您验证/合并更新的文件

“*全部更新*” (Cmd+Opt+X) - 静默更新所有文件，除非存在需要手动更正的合并冲突

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T00:01:18.667

这在 XCode 4.5 中再次被打破。静默将更新所有文件，忽略您选择的文件。如果您控制单击或右键单击或文件-> 源代码控制...无论您选择哪种方式，xcode 都会更新整个项目。糟糕，糟糕的苹果！

# ruby-on-rails - 将控制器的实例变量与 jruby on rails 和多线程支持一起使用是否危险？

> ID：12065787
> 
> 赞同：2
> 
> 时间：2012-08-22T02:57:17.047
> 
> 标签：ruby-on-rails, multithreading, jruby, mt

这是一个关于 MT safe on jruby on rails 的问题。

我只是想确认使用控制器实例变量不存在 MT 安全问题。

实际上，同样的问题是，对于每个 http 请求，rails 会生成一个控制器实例来处理它，还是 rails 会用不同的线程重用同一个控制器实例（就像 servlet 实例一样）？

IE，如果一个控制器实例用于一个 http 请求，则控制器实例变量没有 MT 安全问题，

如果多个线程共享一个控制器实例，则控制器实例变量存在 MT 安全问题

另一个类似的问题是[线程安全的 Rails 控制器操作 - 设置实例变量？](https://stackoverflow.com/questions/12003714/thread-safe-rails-controller-actions-setting-instance-variables)

# php - 基于用户时区的PHP偏移日期（）结果？

> ID：12065791
> 
> 赞同：0
> 
> 时间：2012-08-22T02:57:43.477
> 
> 标签：php, date, timezone

我正在使用该函数将我的站点上发生的事件存储在数据库中，`time()`并使用该函数将它们回显出来`date()`。

我唯一的问题是它与 UTC 相呼应，但如果我的用户在世界其他地方怎么办？我将如何检测他们的时区并将其传递给`date()`函数？

这甚至可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:30:38.973

OK，如果你更喜欢 session 的方式，在用户登录表单中放置一个隐藏字段，并使用 JS 给它一个值。简单说明：

```
<form>
<input type="text" name="username">
<input type="password" name="password">
<input type="hidden" name="offset" id="offset">
</form>
<script language="JavaScript">
document.getElementById("offset").value=(new Date).getTimezoneOffset();
</script> 
```

而在 PHP 方面，操作这样的结果`date`：

```
$_SESSION["offset"]=intval($_GET["offset"]);
/*works here...*/
$date=date("Y-m-d",time()-($_SESSION["offset"]*60)); 
```

如果您想以所有客户端的方式进行操作，也可以使用它`Date().getTimezoneOffset()`来操纵结果。

[MDN 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)

# asp.net - 在 ASP.NET 中交换轴

> ID：12065792
> 
> 赞同：0
> 
> 时间：2012-08-22T02:57:55.667
> 
> 标签：asp.net

我一直在尝试从 MSSQL 数据库中提取一些信息，并通过 ASP.NET v4 将其存入图表，这很容易。我真正苦苦挣扎的问题是 X 轴和 Y 轴。出于某种原因，它只允许我在特定轴上拥有某些数据，而这些数据恰好与我想要的相反（轴）。有人可以为我指出正确的方向，以便我可以选择哪些表数据（从表 1 中提取名称和表 2 中的数据）到哪个轴，或者是否有办法通过代码强制交换？感谢你们提供的任何帮助！

如果有帮助，这是我的 ASP.NET 代码。

```
<asp:Chart ID="Chart1" runat="server" DataSourceID="SqlDataSource1" 
Width="900px" Height="500px" style="margin-top: 5px" Palette="EarthTones">
    <Series>
        <asp:Series Name="Series1" XValueMember="ActualWOB" 
            YValueMembers="Rig_ID" Legend="Legend" ChartType="Bar" YValuesPerPoint="4">
        </asp:Series>
    </Series>
    <ChartAreas>
        <asp:ChartArea Name="ChartArea1">
        </asp:ChartArea>
    </ChartAreas>
    <Legends>
        <asp:Legend Name="Legend" Title="Legend">
        </asp:Legend>
    </Legends>
</asp:Chart> 
```

我希望 ID/名称位于 X 轴上，而 ActualWOB 数据位于 Y 轴上，但似乎无法弄清楚。这可能与我的 SQL 查询有关吗？如前所述，有 2 个表。一个具有 ID、名称、经理、状态，另一个表包含所有实际记录的数据，ID 将 2 个表绑定在一起。因为有多个名称，我想让名称在图表上向上，所有数据字段都在底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T04:56:36.370

我仍然不是 100% 确定如何，但我解决了这个问题。我认为这只是一个狡猾的 SQL 查询。

# c++ - 数组有效，而向量无效。我究竟做错了什么？

> ID：12065796
> 
> 赞同：0
> 
> 时间：2012-08-22T02:59:12.780
> 
> 标签：c++, vector

我正在制作一个井字游戏，我有一个棋盘类，其中包含 9 个 tile 类的实例，并用它们做一些事情。起初我使用 C 数组来创建这些实例`Tile board[MAX_TILES]`，并且一切正常。但是，我想改用向量，因为它们更安全，所以我尝试了与向量相同的方法，`std::vector<Tile> board(MAX_TILES);`但是我的 .cpp 文件中出现了一堆错误，而 .h 文件中出现了 2 个错误。

我还不习惯向量，因为我们的大学教授教我使用 C 风格的数组。我究竟做错了什么？

这是我的 Board.h 和错误，如果您需要 .cpp，我将提供：

```
#ifndef BOARD_H
#define BOARD_H

#include <SFML\Window.hpp>
#include <vector>

#include "tile.h"

#define MAX_TILES 9

enum Position
{
    TOP_LEFT        = 0,
    TOP_MIDDLE      = 1,
    TOP_RIGHT       = 2,
    MIDDLE_LEFT     = 3,
    MIDDLE_MIDDLE   = 4,
    MIDDLE_RIGHT    = 5,
    BOTTOM_LEFT     = 6,
    BOTTOM_MIDDLE   = 7,
    BOTTOM_RIGHT    = 8
};

class Board
{
private:
    std::vector<Tile> board(MAX_TILES);
    //Tile board[MAX_TILES];
    void positionTiles();
public:
    //Constructors
    Board();
    Board( TileState tileState );
    //Methods
    void clearBoard();
    void drawBoard(sf::RenderWindow& window);

};

#endif 
```

错误 1 ​​和 2 来自 .h，其他来自 .cpp：

```
Error   1   error C2059: syntax error : 'constant'  
Error   2   error C2059: syntax error : 'constant'  
Error   3   error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   4   error C2228: left of '.setTilePosition' must have class/struct/union    
Error   5   error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   6   error C2228: left of '.setTilePosition' must have class/struct/union    
Error   7   error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   8   error C2228: left of '.setTilePosition' must have class/struct/unio
Error   9   error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   10  error C2228: left of '.setTilePosition' must have class/struct/union    
Error   11  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   12  error C2228: left of '.setTilePosition' must have class/struct/union    
Error   13  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   14  error C2228: left of '.setTilePosition' must have class/struct/union    
Error   15  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   16  error C2228: left of '.setTilePosition' must have class/struct/union    
Error   17  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   18  error C2228: left of '.setTilePosition' must have class/struct/union    
Error   19  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   20  error C2228: left of '.setTilePosition' must have class/struct/union    
Error   21  error C3867: 'Board::board': function call missing argument list; use '&Board::board' to create a pointer to member 
Error   22  error C2109: subscript requires array or pointer type   29
Error   23  error C2228: left of '.setTileState' must have class/struct/union   
Error   24  error C3867: 'Board::board': function call missing argument list; use '&Board::board' to create a pointer to member 
Error   25  error C2109: subscript requires array or pointer type   
Error   26  error C2228: left of '.setTileState' must have class/struct/union   
Error   27  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   28  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   29  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)       45
Error   30  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   31  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   32  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   33  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   34  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   35  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   36  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   37  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)       49
Error   38  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   39  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   40  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   41  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   42  error C2228: left of '.getTileSprite' must have class/struct/union  
Error   43  error C2677: binary '[' : no global operator found which takes type 'Position' (or there is no acceptable conversion)   
Error   44  error C2228: left of '.getTileSprite' must have class/struct/union 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T03:03:46.713

你不能在 C++03 中做到这一点。

```
std::vector<Tile> board(MAX_TILES); 
```

你应该在 c-tor 中使用它。

```
Board():board(MAX_TILES)
{
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:02:59.927

快速浏览一下，您需要在 Board 的构造函数中初始化向量，而不是在类定义中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T03:02:23.930

C++03 不支持初始化列表。如果这是 C++11，那么您必须使用 {}。

# arm - STM32 旋转编码器配置

> ID：12065800
> 
> 赞同：0
> 
> 时间：2012-08-22T03:00:02.340
> 
> 标签：arm, microcontroller

我正在尝试在编码器模式下使用计时器 8，我的设置如下。引脚 PC8 和 PC9 (timer8) 连接到一个廉价的 3 端子编码器，该编码器的 C 引脚接地，因此在这些引脚上激活了上拉电阻。

```
TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;
GPIO_InitTypeDef GPIO_InitStructure;
RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOC, ENABLE);
GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9;
GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN;
GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP;
GPIO_Init(GPIOC, &GPIO_InitStructure);
RCC_APB2PeriphClockCmd(RCC_APB2Periph_TIM8, ENABLE);
TIM_TimeBaseStructure.TIM_Period = 0x0FFF;
TIM_TimeBaseStructure.TIM_Prescaler = 0;
TIM_TimeBaseStructure.TIM_ClockDivision = 0;
TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up;
TIM_EncoderInterfaceConfig(TIM8,TIM_EncoderMode_TI1,TIM_ICPolarity_Falling,
TIM_ICPolarity_Falling);
TIM_TimeBaseInit(TIM8, &TIM_TimeBaseStructure);
TIM_Cmd(TIM8, ENABLE); 
```

然后我读了计数器`temp=TIM_GetCounter(TIM8);`

我已经尝试了所有可能的模式和下降/上升组合，但我一无所获。Timer 通道是否有任何作用。它正在使用通道 3 和 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:52:46.007

T8 的通道 3 和 4 不能用于编码器接口模式。所以，管脚必须是 pc6、pc7，而不是 pc8、pc9。无论如何，如果没有适当的防弹跳，廉价编码器的工作就很难看。您可以同时配置两个引脚。

# ios - 未观察到 AVPlayerItem 初始 timedMetadata (KVO)

> ID：12065811
> 
> 赞同：4
> 
> 时间：2012-08-22T03:01:08.853
> 
> 标签：ios, cocoa-touch, avfoundation, avplayer

我有一个处理 AVPlayer（和 AVPlayerItem）的类，它向委托报告返回状态、时间和 timedMetadata。

效果很好，除了大约 70-80% 的时间，初始 timedMetadata 不是“观察到的键值”。但是，在错过了第一个 timedMetadata 实例之后，似乎可以毫无问题地观察到所有其他 timedMetadata。

作为一个临时修复，我已经开始在视频的开头嵌入虚拟的 timedMetadata 标签，可以说除了“踢轮胎”之外什么都不做，之后一切正常。然而，这似乎很笨拙。我怀疑要么我以次优方式设置 AVPlayerItem 和 KVO，要么这里只是一个错误。

任何关于为什么会发生这种情况的想法都非常感谢！下面的代码......

```
// CL: Define constants for the key-value observation contexts.
static const NSString *ItemStatusContext;
static const NSString *ItemMetadataContext;
static const NSString *ItemPlaybackForcastContext;

- (id)initWithURL:(NSURL *)url
{
    if (self = [super init]) {

        __weak TFPAVController *_self = self;

        AVURLAsset *asset = [AVURLAsset URLAssetWithURL:url options:nil];
        NSString *tracksKey = @"tracks";

        [asset loadValuesAsynchronouslyForKeys:[NSArray arrayWithObject:tracksKey] completionHandler:
         ^{
             dispatch_async(dispatch_get_main_queue(),
                            ^{
                                NSError *error = nil;
                                AVKeyValueStatus status = [asset statusOfValueForKey:tracksKey error:&error];

                                if (status == AVKeyValueStatusLoaded) {
                                    AVPlayerItem *item = [AVPlayerItem playerItemWithAsset:asset];
                                    [item addObserver:_self forKeyPath:@"status" options:0 context:&ItemStatusContext];
                                    [item addObserver:_self forKeyPath:@"timedMetadata" options:0 context:&ItemMetadataContext];
                                    [item addObserver:_self forKeyPath:@"playbackLikelyToKeepUp" options:0 context:&ItemPlaybackForcastContext];

                                    [[NSNotificationCenter defaultCenter] addObserver:_self
                                                                             selector:@selector(playerItemDidReachEnd:)
                                                                                 name:AVPlayerItemDidPlayToEndTimeNotification
                                                                               object:item];

                                    AVPlayer *player = [AVPlayer playerWithPlayerItem:item];
                                    _self.totalRunTime = CMTimeGetSeconds(item.duration);
                                    [_self.delegate avPlayerNeedsView:player];

                                    _self.playerItem = item;
                                    _self.player = player;
                                }
                                else {
                                    NSLog(@"The asset's tracks were not loaded: %@ // [%@ %@]",
                                          error.localizedDescription,
                                          NSStringFromClass([self class]),
                                          NSStringFromSelector(_cmd));
                                }

                                _self.playerObserver = [_self.player addPeriodicTimeObserverForInterval:CMTimeMake(1, _FrameRate_) 
                                                                                                  queue:NULL
                                                                                             usingBlock: ^(CMTime time) {
                                                                                                 _self.currentVideoTime = CMTimeGetSeconds([_self.playerItem currentTime]);
                                                                                             }];
                            });
         }];
    }

    return self;
}
#pragma mark - KVO Response Methods
- (void)observeValueForKeyPath:(NSString *)keyPath 
                      ofObject:(id)object 
                        change:(NSDictionary *)change 
                       context:(void *)context 
{    
        __weak TFPAVController *_self = self;

    if (context == &ItemStatusContext) {
        dispatch_async(dispatch_get_main_queue(),
                       ^{
                           if (((AVPlayerItem *)object).status == AVPlayerItemStatusReadyToPlay) {

                               [_self.delegate videoIsLoadedInPlayer:_self];
                           }
                       });
        return;
    }
    else if (context == &ItemMetadataContext) {
        dispatch_async(dispatch_get_main_queue(),
                       ^{
                           [_self checkMetaDataForPlayerItem: (AVPlayerItem *)object];
                       });
        return;
    }
    else if (context == &ItemPlaybackForcastContext) {
        dispatch_async(dispatch_get_main_queue(),
                       ^{
                           AVPlayerItem *playerItem = object;                           
                           if (CMTimeGetSeconds([playerItem currentTime]) <= 0) return;

                           NSDictionary *notificationDictionary = [NSDictionary dictionaryWithObject:[NSNumber numberWithBool:playerItem.playbackLikelyToKeepUp] 
                                                                                              forKey:kAVPlayerStateKey];

                           [[NSNotificationCenter defaultCenter] postNotificationName:kAVPlayerNotification 
                                                                               object:self 
                                                                             userInfo:notificationDictionary];
                        });
        return;
    }

    [super observeValueForKeyPath:keyPath ofObject:object change:change context:context];

}

- (void)checkMetaDataForPlayerItem:(AVPlayerItem *)item
{
    NSMutableDictionary *metaDict = [NSMutableDictionary dictionary];

    // CL: make sure there's stuff there
    if (item.timedMetadata != nil && [item.timedMetadata count] > 0) {
        // CL: if there is, cycle through the items and create a Dictionary
        for (AVMetadataItem *metadata in item.timedMetadata) {
            [metaDict setObject:[metadata valueForKey:@"value"] forKey:[metadata valueForKey:@"key"]];
        }
        // CL: pass it to the delegate
        [self.delegate parseNewMetaData:[NSDictionary dictionaryWithDictionary:metaDict]];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-21T14:03:58.123

啊，KVO。可能是苹果有史以来最糟糕的设计决策之一。

我想它不再相关，但猜测你遇到的问题是，有时当你将自己添加为观察者时，你试图观察的值已经分配给键，所以你的观察者选择器不叫。

为避免这种情况，您可以在调用时添加`NSKeyValueObservingOptionInitial`，`options`并且`addObserver:forKeyPath:options:context:`您的观察者方法将立即使用当前值调用。

# ms-access - 访问 2010 递归数据

> ID：12065813
> 
> 赞同：1
> 
> 时间：2012-08-22T03:01:46.210
> 
> 标签：ms-access, ms-access-2010

我不仅仅是 Access 2010 的新手，但肯定不是专家。我每天都在使用 Access，但这个问题让我很困惑。

我有一张表需要查询以检索一组组、子组和所有可能的子成员。该表的布局如下：

所需组 | 当前田纳西州 | 冲刺电话号码 | 姓氏 | 名字
5553215255 | 5553210001 | 4143210009 | 威尔鲍勃
5553215255 | 5553210002 | 4143210008 | 加西亚·杰瑞
5553215255 |5553210003 | 4143210007 | 亨德里克斯吉米
5553215255 | 5553210004 | 4143210006 | Peds 页面
5553210004 | 3144230009 | 4143210005 | 现金强尼
5553210004 | 3144230008 | 4143210003 | 莫里森吉姆
5553210004 | 3144230007 | 4143210002 |
贝多芬路德维希 5553210004 | 3144230911 | 4143210001 | 急救人员页面
3144230911 | 6362341101 | 4143210099 |弹奏者乔
3144230911 | 6362341101 | 4143210098 | 水星房地美
3144230911 | 6362341101 | 4143210097 |普雷斯利·埃尔维斯
3144230911 | 6362341101 | 4143210096 | 波普大

定义的字段：

*   Desired GROUP：基于角色或其他标准的一组人。寻呼时，此号码将向给定组的成员发送寻呼。
*   当前 TN：给定成员的电话。成员可以是一个人或一个 Desired GROUP
*   Sprint 电话号码：有些人会用 Sprint 电话替换他们的寻呼机。
*   姓氏：一个人的角色或姓氏。有时是组名或类似名称。
*   名字：一个人的名字

我需要一个查询，在运行时返回所有分页组的所有成员的列表。假设我向医生发送页面。寻呼医生还寻呼 Peds 的所有成员，这反过来又寻呼紧急 Peds 的所有成员结果将显示所有医生成员、所有 Peds 成员（除组名）和所有被寻呼的紧急 Peds 成员的初始页面。注意 Peds Page 和 Emergency Peds Page 被排除在外。此处图解：

所需组 | 当前田纳西州 | 冲刺电话号码 | 姓氏 | 名字
5553215255 | 5553210001 | 4143210009 | 威尔鲍勃
5553215255 | 5553210002 | 4143210008 | 加西亚·杰瑞
5553215255 |5553210003 | 4143210007 | 亨德里克斯吉米
5553210004 | 3144230009 | 4143210005 | 现金强尼
5553210004 | 3144230008 | 4143210003 | 莫里森吉姆
5553210004 | 3144230007 | 4143210002 |
贝多芬路德维希 3144230911 | 6362341101 | 4143210099 |弹奏者乔
3144230911 | 6362341101 | 4143210098 | 水星房地美
3144230911 | 6362341101 | 4143210097 |普雷斯利猫王
3144230911 | 6362341101 | 4143210096 | 波普大

1.  一位同事建议手动查询多次，将结果保存到多个表中，然后将所有结果表附加到一个表中。我该怎么做呢？看来这是我在我的水平上很容易理解的解决方案，但我不太明白，尽我所能。
2.  除了上述解决方案还有其他方法吗？
3.  如果我将第二个类似的表格与第一个进行比较，我还有什么需要知道的吗？第二个成员可能是第一个中的组领导。

提前非常感谢。

* * *

编辑以包含评论中的 sql。

```
SELECT * 
FROM   (SELECT tbl_group_build.[desired group],tbl_group_build.[current tn], 
                   tbl_group_build.[sprint telephone number], 
                   tbl_group_build.[last name], 
                   tbl_group_build.[first name] 
    FROM   tbl_group_build 
    UNION 
    SELECT tbl_Group_build_1.[desired group],tbl_Group_build_1.[current tn], 
           tbl_Group_build_1.[sprint telephone number], 
           tbl_Group_build_1.[last name],tbl_Group_build_1.[first name] 
    FROM   tbl_group_build 
           INNER JOIN tbl_group_build AS tbl_Group_build_1 
                   ON tbl_group_build.[current tn] = 
                      tbl_Group_build_1.[desired group] 
    UNION 
    SELECT tbl_Group_build_2.[desired group],tbl_Group_build_2.[current tn], 
           tbl_Group_build_2.[sprint telephone number], 
           tbl_Group_build_2.[last name],tbl_Group_build_2.[first name] 
    FROM   (tbl_group_build 
            INNER JOIN tbl_group_build AS tbl_Group_build_1 
                    ON tbl_group_build.[current tn] = 
                       tbl_Group_build_1.[desired group]) 
           INNER JOIN tbl_group_build AS tbl_Group_build_2 
                   ON tbl_Group_build_1.[current tn] = 
                      tbl_Group_build_2.[desired group]) g 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T09:15:55.983

这是一个想法的开始。我注意到在样本数据中，组长的电话号码与页面的电话号码相同。还有其他可能的连接，但这是迄今为止最干净的。

```
SELECT * 
FROM   (SELECT groups.group_name, 
               groups.[group_lead member], 
               groups.tn, 
               groups.last_name, 
               groups.first_name 
        FROM   groups 
        WHERE  groups.group_name = [enter page] 
        UNION 
        SELECT Groups_1.group_name, 
               Groups_1.[group_lead member], 
               Groups_1.tn, 
               Groups_1.last_name, 
               Groups_1.first_name 
        FROM   groups 
               INNER JOIN groups AS Groups_1 
                       ON groups.tn = Groups_1.[group_lead member] 
        UNION 
        SELECT Groups_2.group_name, 
               Groups_2.[group_lead member], 
               Groups_2.tn, 
               Groups_2.last_name, 
               Groups_2.first_name 
        FROM   (groups 
                INNER JOIN groups AS Groups_1 
                        ON groups.tn = Groups_1.[group_lead member]) 
               INNER JOIN groups AS Groups_2 
                       ON Groups_1.tn = Groups_2.[group_lead member]) g 
WHERE  Trim(Replace([last_name], "page", "")) 
       NOT IN (SELECT DISTINCT group_name FROM groups) 
```

* * *

新数据

```
SELECT * 
FROM   (SELECT groups.[desired group],groups.[current tn], 
                       groups.[sprint telephone number], 
                       groups.[last name],groups.[first name] 
        FROM   groups 
        WHERE  groups.[desired group] = [enter desired group] 
        UNION 
        SELECT Groups_1.[desired group],Groups_1.[current tn], 
               Groups_1.[sprint telephone number],Groups_1.[last name], 
               Groups_1.[first name] 
        FROM   groups 
               INNER JOIN groups AS Groups_1 
                       ON groups.[current tn] = Groups_1.[desired group] 
        UNION 
        SELECT Groups_2.[desired group],Groups_2.[current tn], 
               Groups_2.[sprint telephone number],Groups_2.[last name], 
               Groups_2.[first name] 
        FROM   (groups 
                INNER JOIN groups AS Groups_1 
                        ON groups.[current tn] = Groups_1.[desired group]) 
               INNER JOIN groups AS Groups_2 
                       ON Groups_1.[current tn] = Groups_2.[desired group]) AS g 
WHERE  g.[last name] NOT IN (SELECT [last name] 
                                    FROM   groups 
                                    WHERE  [current tn] IN (SELECT DISTINCT 
                                                           [desired group] 
                                                            FROM   groups)) 
```

# clang - 如何从 Clang 2.9 获得未初始化的变量警告？

> ID：12065814
> 
> 赞同：0
> 
> 时间：2012-08-22T03:01:57.120
> 
> 标签：clang

我有这个文件：

```
#include <stdio.h>
int main(void)
{
   int i;
   printf("%d\n",i);
   return 0;
} 
```

如果我在 Mint 12 上使用 gcc 4.6.1 编译：

```
CC -Wall -O test_gcc.c
test_gcc.c: In function ‘main’:
test_gcc.c:8:10: warning: ‘i’ is used uninitialized in this function [-Wuninitialized] 
```

那些与 clang 2.9 相同的选项不会发出警告。Clang在线手册显示一个-Weverything，但是这个版本不知道

```
clang -Weverything test_gcc.c
warning: unknown warning option '-Weverything' [-Wunknown-warning-option] 
```

还

```
clang -Wuninitialized test_gcc.c 
```

不发出警告

对于在 clang 2.9 中读取的未初始化变量，我将如何获得警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:27:28.580

获取更新版本的clang；2.9 已经一年多了。

# xml - 使用 XPath 字符串解析 SOAP 消息

> ID：12065817
> 
> 赞同：1
> 
> 时间：2012-08-22T03:02:31.627
> 
> 标签：xml, soap, xpath, xml-parsing

[使用http://www.w3schools.com/xpath/xpath_examples.asp](http://www.w3schools.com/xpath/xpath_examples.asp)中定义的 XPath 方法， 我可以轻松访问 XML 字符串中的元素。但这不适用于像我下面这样的 SOAP 数据包。我得到的错误是“未声明 SOAP-ENV”。

我的 XPath 字符串

`/SOAP-ENV:Envelope/SOAP-ENV:Body/SpRc:ScanPortsResponse/SpRc:PortDescs[1]`

XML/SOAP 消息

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:SpRc="urn:SpRc">
    <SOAP-ENV:Body>
        <SpRc:ScanPortsResponse>
            <SpRc:PortDescs>
                <SpRc:item>
                    <SpRc:Serial>4215002032</SpRc:Serial>
                    <SpRc:TypeNumber>215</SpRc:TypeNumber>
                    <SpRc:Ip>4M5rAQ==</SpRc:Ip>
                    <SpRc:Mac>GDAAURgk</SpRc:Mac>
                    <SpRc:FirmwareVersion>1</SpRc:FirmwareVersion>
                    <SpRc:FirmwareVariant>0</SpRc:FirmwareVariant>
                    <SpRc:Port>1</SpRc:Port>
                    <SpRc:OutputType>28738</SpRc:OutputType>
                    <SpRc:Capabilities>97</SpRc:Capabilities>
                    <SpRc:InUse>1</SpRc:InUse>
                </SpRc:item>
            </SpRc:PortDescs>
            <SpRc:SpRcResult>0</SpRc:SpRcResult>
        </SpRc:ScanPortsResponse>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:33:12.137

这似乎是 XML 命名空间的问题。您的 XPath 解析器似乎可以识别名称空间。在解析 XML 之前尝试在解析器中设置 SOAP 命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T02:29:22.233

Abhinav Sarkar 上面的答案是正确的，但我想详细说明一下。你需要使用

```
/SOAP-ENV:Body/SpRc:ScanPortsResponse/SpRc:PortDescs[1] 
```

代替

```
/SOAP-ENV:Envelope/SOAP-ENV:Body/SpRc:ScanPortsResponse/SpRc:PortDescs[1] 
```

因为 XPATH 向后查找命名空间，如果父标记是定义命名空间的位置，那么它将不起作用。

# selenium - Selenium IDE：比较/验证变量的文本

> ID：12065818
> 
> 赞同：1
> 
> 时间：2012-08-22T03:02:56.497
> 
> 标签：selenium

我是 Selenium IDE 的新手。现在我正在尝试将图像的文件路径/URL 存储在网页上，然后验证文件路径/文件名是否遵循一组文件名约定。

到目前为止的进展：我已经安装了一个用户扩展，它允许我使用一个名为“storeImagePath”的命令。我可以存储图像的文件路径/文件名并将其保存为名为 imagePath 的变量。

我坚持的是：我可以回显 ${imagePath} 它给了我正确的文件路径，但我什至不知道如何将 imagePath 变量与真实的文件路径进行比较。我想做类似变量的 VerifyEval 并将其与我粘贴的路径进行比较以进行测试。我尝试将变量“键入”到输入元素中，然后对其进行某种验证文本，但它没有用。我是否忽略了一个非常简单的解决方案？

请记住，我正在使用 Selenium IDE，我想坚持使用它，直到我精通它，然后再转向 RC。虽然如果我想要做的事情在 IDE 中是不可能的，你可以告诉我。提前致谢。

编辑：我不确定我说得有多清楚；目前我只想将 ${imagePath} 与我自己粘贴的 URL 进行比较。完成后，我可以开始弄清楚如何定义接受的文件路径/文件名约定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:32:34.220

如果您的最终目的是验证存储的变量是否与特定格式匹配，那么您可以使用 verifyeval 函数，例如。验证评估 | storedVars['imagePath'].search("ur reg ex")>0 | true 或任何 javascript 字符串方法来进行比较

# django - 登录后保留 Django 会话数据？

> ID：12065820
> 
> 赞同：6
> 
> 时间：2012-08-22T03:03:18.413
> 
> 标签：django, session-state

我最近编写了依赖于 Session 对象的购物车代码。这似乎是为匿名用户存储数据的合理方式。

在进行大量测试时，我遇到了一个烦人的问题——当用户在结帐过程中（或只是在浏览其他产品时）部分登录时，Django 发出一个新的 session_key，我无法访问我的会话数据。

有没有办法保留旧的会话数据？还是我的设计方法错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T07:06:42.907

尝试编写自己的 SessionBackend 继承现有的并覆盖该`cycle_key`方法。

1 在您的`settings.py`：

```
SESSION_ENGINE = 'my_app.session_backend' 
```

2 `my_app.session_backend.py`：

```
from django.contrib.sessions.backends.db import SessionStore as DbSessionStore

class SessionStore(DbSessionStore):
    def cycle_key(self):
        pass 
```

`cycle_key``login`身份验证后正在视图中调用。

如果它有效，现在让我;）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-25T10:43:14.923

您可以考虑通过and视图上的装饰器恢复值，而不是禁用`cycle_key()`（这是一种避免会话固定漏洞的安全措施） 。看：`login``logout`

[https://stackoverflow.com/a/41849076/146289](https://stackoverflow.com/a/41849076/146289)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-14T19:11:52.190

我正在尝试做类似的事情。Django 可以更改`session_key`以减轻会话固定漏洞，因此它不适合外键。我想要一些更永久的东西。所以我将把永久标识符放在`request.session['visitor_id']`：

```
from django.utils.crypto import get_random_string
import string

VALID_KEY_CHARS = string.ascii_lowercase + string.digits

def example_view(request):
    if not request.session.get('visitor_id'):
        self.request.session['visitor_id'] = get_random_string(32, VALID_KEY_CHARS)
    # Now code the rest of the view, using the visitor_id instead of
    # session_key for keys in your model.
    # ... 
```

# jquery - 隐藏/显示特定表格行

> ID：12065825
> 
> 赞同：0
> 
> 时间：2012-08-22T03:03:40.887
> 
> 标签：jquery, html, css

我需要能够隐藏表中默认的特定行。

基本上，这是电子商务网站中的“我的购物车”页面，这里的想法是能够显示多个相同产品的所有实例。

示例：假设您选择数量为 3 只山羊 - 在显示的产品下方有一个链接，上面写着“显示所有实例”。这意味着如果您要单击锚点，则显示您想要的总共 3 只山羊的每个实例。

这是我正在做/尝试实现的图像：

![在此处输入图像描述](../Images/778c58c517f7a454435998b7e9c5d319.png)

所以，我遇到的问题是如何在 HTML 中结构化地将“显示所有实例”行放在一起。在父行下创建另一个表？我想到了这一点，并遇到了如何用正确的产品定位“实例”的问题。

到目前为止，这是我的 HTML 代码 - 此代码仅显示了我为实现每个产品行所做的工作：

```
<div class="item-section">
        <span class="section-heading">Smiles Gifts</span>
        <table cellpadding="0" cellspacing="0" border="0" width="100%" style="border-bottom: 1px dotted #666666;padding: 0 0 5px 0;" >
            <tr>
                <th class="col-1">&nbsp;</th>
                <th class="col-2">Qty</th>
                <th class="col-3">Frequency</th>
                <th class="col-4">Card Type</th>
                <th class="col-5">Edit/Remove</th>
                <th class="col-6">Subtotal</th>
            </tr>
        </table>
        <table cellpadding="0" cellspacing="0" border="0" width="100%">
            <tr>
                <td class="item col-1 clearfix">
                    <table cellpadding="0" cellspacing="0" border="0">
                        <tr>
                            <td>
                                <img src="images/cart_dummy_image.jpg" alt="" />
                            </td>
                            <td>
                                <span class="product">World Food Programme</span>
                                <!-- LINK TO SHOW OTHER INSTANCES -->
                                <a class="show-instances" href="#">Show all instances</a>
                            </td>
                        </tr>
                    </table>
                </td>
                <td class="col-2"">1</td>
                <td class="col-3">One Off</td>
                <td class="col-4">&nbsp;</td>
                <td class="col-5">
                    <a href="#" class="blue-anchor">Edit</a>
                    <a href="#">Remove</a>
                </td>
                <td class="col-6">$45.00</td>
            </tr>
</div> 
```

希望提供的信息足够详细，但如果没有让我知道任何问题，我会尽力提供帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T05:36:18.103

为了`HTML`简单地为每个条目添加更多行，那么您需要在 java-script 中进行一些调整以隐藏和显示这些行。我更喜欢[jQuery](http://jquery.com/)，因为它可以`DOM`优雅地处理。

这是完成任务的简单方法，（*仅发布 javascript*）

```
var link = $('<a class="show-instances" href="#">Show all instances</a>');
$('tr.main').hide().first().find('.product').parent().remove('a').append(link);
$('tr.main').first().show();

$('table').on('click', 'a.show-instances', function() {
    var selectedClass = $(this).closest('tr.main').attr('class').split(' ');
    $('.' + selectedClass[1]).not(':has("a.show-instances")').toggle();
    return false;
});​ 
```

看看工作的**[DEMO](http://jsfiddle.net/thujeevan/HSDXd/)**

# javascript - 将 JavaScript 函数分配给提交按钮，该按钮应有条件地执行

> ID：12065827
> 
> 赞同：3
> 
> 时间：2012-08-22T03:03:48.593
> 
> 标签：javascript, post, get, form-submit, onsubmit

我有一个带有一个隐藏输入字段和一个提交按钮的简单表单。当用户单击提交按钮时，我希望它首先运行带有确认（）函数的 JavaScript 函数。根据用户是点击“确定”还是“取消”，我希望表单提交或不提交。如何成功地将点击功能分配给提交按钮，并使其按上述方式工作？

```
function confirmDelete() {
var del = confirm("Are you sure you wish to delete this post?");

if (del)
  //continue and submit the form
else
  //the form should not be submitted
} 
```

这是表格：

```
<form action="/delete/" method="post">
<input type="hidden" name="path" value="'.$path.'" />
</form> 
```

我意识到我可以完全废弃表单，只需将隐藏变量作为 GET 变量传递给 /delete/ 页面，但是出于安全原因，我更喜欢使用 POST 变量。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T03:05:25.800

这就足够了：

```
<input type="submit" value="Delete" onClick="return confirm('Are you sure?');" /> 
```

# sql - 确定哪些表具有对特定自定义角色的 GRANT SELECT

> ID：12065830
> 
> 赞同：1
> 
> 时间：2012-08-22T03:04:33.103
> 
> 标签：sql, sql-server-2008

我们被要求获取 SQL Server 2008 数据库中所有表的列表，这些表对特定角色具有 SELECT 权限。它需要在查询中，因为那时我们需要编写一个脚本来撤销该 GRANT SELECT 权限。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:22:49.363

这不是一个完整的答案（也不可能——我没有安装 SQL Server 可以摆弄），但希望它能让你走上正轨。它正在执行一个存储过程。

```
USE yourDB;
GO
EXEC sp_table_privileges 
   @table_name = '%'; 
```

在结果集中，您将主要对第三列`table_name`和第六列感兴趣`privileges`。

来源：[MSDN：sp_table_privileges](http://msdn.microsoft.com/en-us/library/ms173835.aspx)

在我看来，下一步 - 假设这是您要查找的数据 - 将使用一个将 EXEC 语句的结果插入到一个临时表中的 SQL 语句来包装，然后您可以根据需要对其进行切片和切块。这种努力留给读者作为练习（*轻推*）。[关于这个堆栈溢出问题](https://stackoverflow.com/questions/209383/select-columns-from-result-set-of-stored-procedure)的第三个答案可能对扩展上面给出的查询有用，但一如既往，YMMV。

# android - 在安卓中使用 MotionEventCompat

> ID：12065834
> 
> 赞同：0
> 
> 时间：2012-08-22T03:05:26.757
> 
> 标签：android, touch-event, motionevent

我正在寻找如何在 Android 中使用 MotionEventCompat 的示例。我正在使用 API 级别 10，它不支持手指“悬停”或“拖动”到视图上。我需要检测到这一点，最好是从视图本身。这是一些关于我如何尝试使用它的代码片段：

```
**my class:** 
 import android.support.v4.view.MotionEventCompat;
        public class GridButton extends View 

    overriding onTouchEvent:
            @Override
        public boolean onTouchEvent(MotionEvent event) {
            super.onTouchEvent(event);
            switch (event.getAction() & MotionEventCompat.ACTION_MASK) {
            case (MotionEvent.ACTION_DOWN): {
                set_active(true);
                return true;
            }
            case (MotionEventCompat.ACTION_HOVER_ENTER): {
                set_active(true);
                break;
            }
            }
            return false;
        } 
```

我将 MotionEventCompat.ACTION_MASK 基于我在某处找到的示例，但它不会触发我的 set_active() 代码。

任何有关使用它的帮助将不胜感激。网上关于这方面的内容很少。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T04:31:58.930

当设备支持鼠标或触摸板时发送悬停事件。当光标悬停在视图上时，这些事件将发送到 onGenericMotionEvent，而不是 onTouchEvent。它们不会帮助您检测未接触电容式触摸屏表面的手指或在不同位置触地然后滑过相关视图的手指。它们永远不会在 API 10 (Android 2.3) 设备上发送。

# regex - 正则表达式不匹配字符串

> ID：12065837
> 
> 赞同：1
> 
> 时间：2012-08-22T03:05:45.837
> 
> 标签：regex

是否存在不匹配字符串的正则表达式？如果是这样，它是什么？

准确地说，我正在寻找一个正则表达式，以便为任何字符串`r`输出以下 Python 代码：`True``s`

```
import re
print(re.match(r, s) is None) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T03:08:51.047

如果您的正则表达式引擎支持前瞻（Python 支持）：

```
(?!) 
```

否则这样的事情也会起作用：

```
^\b$ 
```

断字不能自行发生！

或者，

```
$a^ 
```

除非字符串为空，否则字符串的结尾不能匹配字符串的开头，并且我们通过要求我们至少匹配一个字符来防止它为空。

话又说回来，`^`/ `$`/`\b`真的只是变相的环顾四周。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:22:39.447

以下正则表达式不应匹配任何字符串。它将匹配任何既不是空白字符也不是非空白字符的单个字符。

```
[^\S\s] 
```

# nhibernate - 带有引用的休眠删除批处理

> ID：12065839
> 
> 赞同：1
> 
> 时间：2012-08-22T03:06:48.273
> 
> 标签：nhibernate, hql

termInfo 类

```
public class TermInfo
{
    public TermInfo()
    {
        this.Breviary = string.Empty;
        this.CreateBy = string.Empty;
        this.CreateDate = DateTime.Now;
        this.Group = 0;
        this.Name = string.Empty;
    }

    public override int GetHashCode()

    public virtual int TermId { get; set; }

    public virtual string Name { get; set; }

    public virtual string Breviary { get; set; }

    public virtual int Group { get; set; }

    public virtual string CreateBy { get; set; }

    public virtual DateTime CreateDate { get; set; }

    public virtual IList<Taxonomy> Taxonomies { get; set; }
} 
```

分类学类

```
public class Taxonomy
{
    public Taxonomy()
    {
        this.TermTaxonomy = string.Empty;
        this.Description = string.Empty;
        this.ParentId = 0;
        this.OrderId = 0;
        this.PostCount = 0;
    }

    public virtual int TaxonomyId { get; set; }

    public virtual string TermTaxonomy { get; set; }

    public virtual string Description { get; set; }

    public virtual int ParentId { get; set; }

    public virtual int OrderId { get; set; }

    public virtual int PostCount { get; set; }

    public virtual TermInfo Term { get; set; }
} 
```

映射

```
internal class TaxonomyMap :  ClassMap<Taxonomy>
{
    public TaxonomyMap()
    {
        Table("Smart_TermTaxonomy");
        Id(x=>x.TaxonomyId).GeneratedBy.Identity();
        Map(x => x.Description);
        Map(x => x.OrderId);
        Map(x => x.ParentId);
        Map(x => x.PostCount);
        Map(x => x.TermTaxonomy).Column("Taxonomy");

        References(x => x.Term, "TermId");

        DynamicUpdate();
        DynamicInsert();
    }
}

internal class TermInfoMap : ClassMap<TermInfo>
{
    public TermInfoMap()
    {
        Table("Smart_PostTerms");
        Id(x=>x.TermId).GeneratedBy.Identity();
        Map(x => x.Breviary);
        Map(x => x.CreateBy);
        Map(x => x.CreateDate);
        Map(x => x.Group).Column("[Group]");
        Map(x => x.Name).Column("[Name]");

        HasMany<Taxonomy>(x => x.Taxonomies).KeyColumn("TermId");
    }
} 
```

我的问题是如何按术语删除分类法。命名我预期的 sql 将是：

> '从 smart_postTaxonomy 中删除，其中 termId=（从 smart_PostTerms 中选择 termId，其中 [Name]=@Name）'

那么，我应该为此编写什么 hql 查询字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T16:18:00.163

您是否尝试过在 HQL 中做类似的事情？

```
session.CreateQuery(
    "delete from Taxonomy t where t.Term.id = " +
    "  (select ti.id from TermInfo ti where ti.Name = :name)")
    .SetParameter("name", termName)
    .ExecuteUpdate(); 
```

# java - signature.verify() 总是返回 False？

> ID：12065840
> 
> 赞同：1
> 
> 时间：2012-08-22T03:07:02.953
> 
> 标签：java, rsa, signature

我发现了 2 个类似的问题，并尝试运行作为解决方案给出的代码，因为这些答案对我来说不起作用，所以用代码片段提出问题。

1.  [signature.verify() 总是返回 False](https://stackoverflow.com/questions/3151407/signature-verify-always-returns-false)
2.  [Signature.verify() 总是返回 false](https://stackoverflow.com/questions/11312619/signature-verify-is-always-returning-false)

两者都说答案不起作用，所以请不要将此问题视为重复

这是我的代码。

```
import com.sun.org.apache.xml.internal.security.utils.Base64;
import java.io.FileInputStream;
import java.security.PublicKey;
import java.security.Signature;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;
import xmlread.ReadXMLFile;

public class CertificateTest {

    public static void main(String[] sdd)  {

        try{
        FileInputStream fin = new FileInputStream("pub.arm");
        CertificateFactory f = CertificateFactory.getInstance("X.509");
        X509Certificate certificate = (X509Certificate) f.generateCertificate(fin);
        PublicKey pk = certificate.getPublicKey();
        byte[] sign = "Qn/rlJRdZAdlPpu1UmmjE+rup8rv8d6XlS9MngAorzYDXefw0vWEP4eHil3YHoA1JUkoQQOgmw0w0QZFmrQbS33sa2t76iuqXI7EtnAPU798K+hEXP88tsYDWJNJFo9DdhkGltP5dQ02DN030Q1w58aTF+yZFfY1KVOPx2bIoL8=".getBytes();

        Signature sig = Signature.getInstance("SHA1withRSA");
        sig.initVerify(pk);
        sig.update(Base64.decode(ReadXMLFile.getString().getBytes()));

        boolean verifies = sig.verify(Base64.decode(ReadXMLFile.getString().getBytes()));

        System.out.println("signature verifies: " + verifies);

        }catch(Exception ex){}
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:16:02.153

在我知道`ReadXMLFile.getString`不是正在测试其完整性的数据而是编码签名本身之前，下面是解释。请参阅[我们的讨论](https://chat.stackoverflow.com/rooms/15641/discussion-between-ashish-agarwal-and-veer)以获取解决方案！

* * *

您的代码是错误的——您正在尝试将 base64 解码的 RSA 加密 SHA1 摘要与`ReadXMLFile.getString()`自身进行比较。

```
final byte[] data = Base64.decode(ReadXMLFile.getString().getBytes());
sig.update(data);
boolean verifies = sig.verify(data); 
```

从[规范中`Signature.update`](http://docs.oracle.com/javase/7/docs/api/java/security/Signature.html#update(byte%5B%5D))：

> 使用指定的字节数组更新要签名或验证的数据。

然后，从[`Signature.verify`](http://docs.oracle.com/javase/7/docs/api/java/security/Signature.html#verify(byte%5B%5D))：

> 验证传入的签名。

现在，您实际上并没有将签名数据传递到`verify`! 你的意思是`sig.verify(Base64.decode(sign))`代替吗？

如果您需要进一步的证明，请发布`pub.arm`，我可以演示有效的正确代码:-)

# php - Simplexml 问题.. 尝试访问这些数据时遇到了困难

> ID：12065847
> 
> 赞同：0
> 
> 时间：2012-08-22T03:07:56.350
> 
> 标签：php, simplexml

我正在尝试使用以下结构访问 simplexml 对象中的这些元素。

我在尝试获取此 xml 块中的值时遇到了很多麻烦：

```
<result name="doclist" numFound="9" start="0">
    <doc>
        <str name="merchant_name_url_title">accuscore</str>
        <str name="end_date_time"/>
        <str name="category">betting & gaming</str>
        <str name="merchant_name">Accuscore</str>
        <str name="link_type">Text Link</str>
    </doc>
</result> 
```

我正在尝试获取“numFound”的值以及每条记录的所有“doc/str”数据。

## 下面是完整的结构。我只是展示了 2 个“doc”元素，但可能有数千个。

```
<response>
    <lst name="responseHeader">
        <int name="status">0</int>
        <int name="QTime">5</int>
        <lst name="params">
            <str name="indent">true</str>
            <str name="start">0</str>
            <str name="q">*:*</str>
            <str name="rows">2</str>
        </lst>
    </lst>
    <lst name="grouped">
        <lst name="merchant_name">
            <int name="matches">5143</int>
            <arr name="groups">
                <lst>
                    <str name="groupValue">accuscor</str>
                    <result name="doclist" numFound="9" start="0">
                        <doc>
                            <str name="merchant_name_url_title">accuscore</str>
                            <str name="end_date_time"/>
                            <str name="category">betting & gaming</str>
                            <str name="merchant_name">Accuscore</str>
                            <str name="link_type">Text Link</str>
                        </doc>
                    </result>
                </lst>
                <lst>
                    <str name="groupValue">acdse</str>
                    <result name="doclist" numFound="3" start="0">
                        <doc>
                            <str name="merchant_name_url_title">acdsee</str>
                            <str name="end_date_time"/>
                            <str name="category">computer hardware & software</str>
                            <str name="merchant_name">ACDSee</str>
                            <str name="link_type">Text Link</str>
                        </doc>
                    </result>
                </lst>
            </arr>
        </lst>
    </lst> 
```

几个小时以来一直把我的头撞在墙上，并决定在这里寻求帮助！

任何帮助或提示将不胜感激。

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T20:23:42.633

您粘贴的 XML 无效，不仅因为您错过了 . `</response>`，还因为其中有未转义的`&`符号，应该是`&amp;`.

我还要说它显然是由不懂 XML 的人编写的，因为元素名称（`str`、`arr`、`lst`等）似乎只定义了数据的类型。

但是，假设您修复了该问题并将其加载到名为 的 SimpleXML 对象`$sx`中，您可以使用 XPath 表达式查找所有`result`元素，然后从那里继续：

```
foreach ( $sx->xpath('//lst[@name="grouped"]//result') as $result )
{
        echo 'Begin Result; numFound: ' . (string)$result['numFound'] . PHP_EOL;
        foreach ( $result->doc as $doc )
        {
                echo 'Begin doc:' . PHP_EOL;
                foreach ( $doc->str as $str )
                {
                        echo (string)$str['name'] . ': ' . (string)$str . PHP_EOL;
                }
                echo 'End doc' . PHP_EOL . PHP_EOL;
        }
        echo 'End result' . PHP_EOL . PHP_EOL;
} 
```

# mysql - 使用 FOR UPDATE 替代 READ UNCOMMITED

> ID：12065850
> 
> 赞同：1
> 
> 时间：2012-08-22T03:08:23.337
> 
> 标签：mysql, transactions, isolation-level

我们有 2 个脚本/mysql 连接，它们从表中获取行。一旦一个脚本抓取了一些行，另一个脚本就不能访问这些行。

到目前为止，我所得到的似乎可行的是：

```
SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
START TRANSACTION

SELECT * FROM table WHERE result='new' FOR UPDATE

// Loop over update
UPDATE table SET result='old' WHERE id=...

COMMIT 
```

据我了解，相同的连接可以读取脏数据，但由于行被锁定，其他连接不应该能够读取。这个对吗？

还有一种更好的方法来保证每行只能在`SELECT`两个脚本运行的情况下运行一次吗？

编辑：哦......引擎是Innodb

编辑：我也想尽量避免死锁，除非它们真的没有效果，我可以为它们做准备并重新运行查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T06:45:45.633

`SELECT ... FOR UDATE`在行上设置排他锁，如果不可能等待锁被释放，`SELECT ... FOR UDATE`语句的主要目的是防止其他人在您操作它们时读取某些行。

如果我的问题是正确的，那么“脏数据”是指那些锁定的行吗？不明白为什么您称它们为“脏”，因为它们只是被锁定，但实际上在同一事务中您可以读取已锁定的行（显然）。

关于你的第二个问题

> 还有一种更好的方法来保证在两个脚本都运行的情况下每一行只能选择一次吗？

`SELECT ... FOR UDATE`保证在每个时刻，某些行只能在一个事务中读取。只要此语句是专门为此目的而设计的，我就没有更好的方法来做到这一点。

# git - RA 层请求失败？git-svn 对 repo 做了什么？

> ID：12065852
> 
> 赞同：4
> 
> 时间：2012-08-22T03:08:26.660
> 
> 标签：git, svn, git-svn

[与git-svn fetch 时](https://stackoverflow.com/questions/750120/ra-layer-request-failed-while-git-svn-fetch)此RA 层请求失败不同，没有网络问题

[与git-svn 期间的“RA 层请求失败：报告请求失败”](https://stackoverflow.com/questions/8451480/ra-layer-request-failed-report-request-failed-during-git-svn)有点相似，但我没有在 cygwin 中使用 git-svn

错误信息如下：

```
RA layer request failed: Server sent unexpected return value (403 Forbidden) in response to REPORT request for '/repos/asf/!svn/vcc/default' at /usr/libexec/git-core/git-svn line 5669 
```

这是403错误：（

发生了什么？

实际上并没有名为 !svn 的目录（点击[http://svn.apache.org/repos/asf/!svn](http://svn.apache.org/repos/asf/!svn)你可能知道这个目录不存在，那么 git-svn 是怎么产生这么荒谬的目录名的） ,

那么为什么 git-svn 想要找到这个目录呢？

git-svn 的行为令人困惑:( 它想对 svn repo 做什么？

为什么会出现 403 错误？

如何避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T05:58:11.147

据我所知，apache.org 只是禁止人们将 git-svn 用于他们的大型存储库（通常在此类克隆的中间）。“！svn”来自该服务器上的 DAV 协议实现。为避免您可以尝试为该位置找到任何镜像。如果没有任何镜像，您可以尝试不克隆整个历史记录，而是从某个修订开始，以免获取太多修订（-r 选项）。

# javascript - javascript 编程和 css 问题

> ID：12065853
> 
> 赞同：0
> 
> 时间：2012-08-22T03:08:35.977
> 
> 标签：javascript, html, css, css-float

[http://jsfiddle.net/rajkumart08/8p2mZ/2/embedded/result/](http://jsfiddle.net/rajkumart08/8p2mZ/2/embedded/result/)

当我单击更多选项时会弹出​​一个弹出窗口，但是当我在浏览器使用鼠标时减小宽度和高度时...弹出窗口不会与更多选项 div 一起移动...

我该如何解决这个问题？请帮忙。

我的代码在这里：http: [//jsfiddle.net/rajkumart08/8p2mZ/3/](http://jsfiddle.net/rajkumart08/8p2mZ/3/)

```
.openme {
            display: inline-block;
            padding: 10px;
            cursor: pointer;
            padding: 0;
            margin: 0 20px 0 0;
            width: 200px;
            height: 200px;
            list-style-type: none;
            background: white;
            border: 1px solid #999;
            line-height: 200px;
            padding: 0;
        }

        #menu{
            display: inline-block;
            opacity: 0;
            visibility: hidden;
            position: absolute;
            padding:0px;
            border: solid 1px #000;
            margin: 0 auto 0 auto;
            background: white;
            top: 350px;
            left: 649px;
            -webkit-box-shadow: 0px 2px 13px rgba(50, 50, 50, 0.48);
        }
        #menu.show {
            opacity: 1;
            visibility: visible;
        }

        #menu a{
            float:left;
            /*margin: 7px;*/
            padding: 10px 20px;
            font-weight: bold;
            font-size: 10px;
            text-align: center;
            background: white;
            color: black;
            word-wrap: normal;
            /*border: 1px solid red;*/

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T07:31:57.483

首先，事情是给父容器一个最小宽度 - `.app-home`div 并使其成为“位置：相对”。接下来，为菜单 div 使用右位置而不是左位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:13:34.187

一种方法是根据窗口大小的百分比来指定菜单的位置。

例如

代替

```
top: 350px;
left: 649px; 
```

指定

```
top: 15%;
left: 15%; 
```

这将确保菜单在调整大小时始终位于窗口宽度。

# excel - 在 Excel 和 Oracle 数据库中导入或导出数据

> ID：12065856
> 
> 赞同：0
> 
> 时间：2012-08-22T03:08:46.753
> 
> 标签：excel, oracle10g

我正在使用 SQLTools 1.5 编写 Oracle SQL 脚本。我想将数据从 Excel 文件导入 Oracle 数据库。我该怎么做？

另外，如何将数据从 Oracle 数据库导出到 Excel 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T05:54:51.073

SQL Tools 支持将数据从 Excel 文件导入 Oracle。您可以使用 Oracle 的 SQL Developer 将数据从 Excel 文件导入数据库。

杰夫史密斯在他的[博客文章](http://www.thatjeffsmith.com/archive/2012/04/how-to-import-from-excel-to-oracle-with-sql-developer/)中解释了如何做到这一点

> *   右键单击表格 -> 导入数据
> *   选择您的文件
> *   注意标题！您的 Excel 文件是否有列标题？我们想把它们当作表格的一行吗？可能不是。默认选项会处理这个问题。
> *   选择要导入的 Excel 列
> *   告诉 SQL Developer 电子表格中的哪些列与 Oracle 表中的哪些列相匹配。
> *   点击“验证”按钮。修正任何错误。
> *   一切看起来都不错！单击“完成”按钮。
> *   验证导入查看您的新表数据

您也可以从 SQL Developer 执行相反的操作，只需右键单击表并选择导出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-28T05:57:43.810

```
Below sniplet works...

Imports Oracle.DataAccess.Client
Imports System.Configuration
Imports System.IO
Imports Excel = Microsoft.Office.Interop.Excel

Module Module1

    Sub Main()
        Dim dt As New DataTable
        Dim connString = ConfigurationManager.ConnectionStrings("oraConnectionString").ConnectionString
        Using conn As New OracleConnection(connString)
            Dim cmd As New OracleCommand
            cmd.Connection = conn
            cmd.CommandText = "select Doc_name,Doc_id from Document;"
            conn.Open()
            Using oda As New OracleDataAdapter(cmd.CommandText, conn)
                oda.Fill(dt)
            End Using
            conn.Close()
        End Using
        'exportTOExcel
        savetoXcel(dt, dt.Rows.Count)

    End Sub

    Private Sub savetoXcel(dt As DataTable, rows As Int64)
        Dim appXL As Excel.Application
        Dim wbXl As Excel.Workbook
        Dim shXL As Excel.Worksheet
        Dim raXL As Excel.Range
        ' Start Excel and get Application object.
        appXL = CreateObject("Excel.Application")
        appXL.Visible = True
        ' Add a new workbook.
        wbXl = appXL.Workbooks.Add
        shXL = wbXl.ActiveSheet
        ' Add table headers going cell by cell.
        shXL.Cells(1, 1).Value = "Document ID"
        shXL.Cells(1, 2).Value = "Document Name"
        Console.WriteLine("rows:" + rows.ToString)
        ' Format A1:D1 as bold, vertical alignment = center.
        With shXL.Range("A1", "B1")
            .Font.Bold = True
            .VerticalAlignment = Excel.XlVAlign.xlVAlignCenter
        End With
        ' Create an array to set multiple values at once.
        Dim students(rows, 2) As String
        Dim i As Int32 = 0
        For Each Dr As DataRow In dt.Rows
            students(i, 0) = Dr.Item(0)
            students(i, 1) = Dr.Item(1)
            i = i + 1
        Next

        Dim BRange As String = "B" + rows.ToString
        'Console.WriteLine("BRange:" + BRange)
        shXL.Range("A2", BRange).Value = students

        'AutoFit columns A:D.
        raXL = shXL.Range("A1", "B1")
        raXL.EntireColumn.AutoFit()
        ' Make sure Excel is visible and give the user control
        ' of Excel's lifetime.
        appXL.Visible = True
        appXL.UserControl = True
        'Export to excel
        wbXl.SaveAs(Filename:="d:\Db_report.xls", FileFormat:=50, ReadOnlyRecommended:=True)
        ' Release object references.
        raXL = Nothing
        shXL = Nothing
        wbXl = Nothing
        appXL.Quit()
        appXL = Nothing
        Exit Sub

    End Sub
End Module 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-09T10:31:05.160

检查这个，它可能会有所帮助

WebUtil：如何将 Excel 文件读入 Oracle 表单

[https://sites.google.com/site/craigsoraclestuff/oracle-forms-webutil/read-excel-into-forms](https://sites.google.com/site/craigsoraclestuff/oracle-forms-webutil/read-excel-into-forms)

# android - android 无法使用 ViewPager --> ScrollView --> Imageview 滚动图像

> ID：12065858
> 
> 赞同：0
> 
> 时间：2012-08-22T03:08:56.830
> 
> 标签：android, layout, imageview, scrollview, android-viewpager

我在我的主视图中使用视图寻呼机。根据框架的内容，我添加了两个 xml 文件之一。第一个是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical">        

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical"
        android:background="#ffffff"
        android:layout_margin="6dip">   

        <!-- header -THIS is the source of the problem! -->
        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">

            <TextView            
                android:textSize="32dip"
                android:gravity="center"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" />

        </LinearLayout>

        <!-- content -->
       <ScrollView
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:fillViewport="true">

           <TextView
                    android:text=""
                    android:gravity="center"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"/>

        </ScrollView>

        <!-- footer -->

        <LinearLayout 
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">

            <TextView
                android:text="Expires on..."
                android:gravity="right"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" />

        </LinearLayout>
        </LinearLayout>

</LinearLayout> 
```

除了滚动视图的子项是 ImageView 而不是 TextView 之外，替代 xml 文件是相同的。

现在，使用 textview 时一切正常。我可以使用滚动视图来上下滚动视图中的文本。但是，当我将布局与 imageview 一起使用时，图像被冻结并且滚动视图不会上下移动它。

有谁知道这是为什么？

# plone - 将主页更改为子文件夹中的对象

> ID：12065865
> 
> 赞同：1
> 
> 时间：2012-08-22T03:10:25.933
> 
> 标签：plone

如何更改克隆网站的主页？

我能找到的最接近的东西是 ZMI 中 /portal_properties/site_properties 下的 default_page。但它列出了 index.html 和 index.htm，我觉得这很混乱，因为 plone 安装中没有任何 html 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T05:29:34.607

“显示”下拉菜单包括“选择默认项目”，可用于选择您希望显示为 Plone 站点中任何文件夹的默认视图的对象，包括主文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T11:48:44.183

在 siteroot 添加内容类型“链接”，输入您选择的标题并将目标设置为“/yourSiteId/yourSubfolder”，确保已发布，将链接设置为您网站的默认视图。

在子文件夹中将内容项设置为默认视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T12:47:57.103

你可能想看看[拼贴](http://plone.org/products/collage)。您可以定义一个布局，然后从任何子文件夹中选择内容项，并将其呈现在您的拼贴布局中。然后，您可以选择拼贴作为 plone 站点的默认视图（通过选择它作为默认视图）。

拼贴的用户界面有点令人生畏，但经过一些试验和错误后你应该能够得到它。

# iphone - 如何使用 drawRect 在 UIView 中绘制镜像 UIImage？

> ID：12065866
> 
> 赞同：3
> 
> 时间：2012-08-22T03:10:35.240
> 
> 标签：iphone, ios, uiview, uiimage

我以这种方式加载图像并创建镜像：

```
 originalImg = [UIImage imageNamed:@"ms06.png"];
 mirrorImg = [UIImage imageWithCGImage:[originalImg CGImage] scale:1.0 orientation:UIImageOrientationUpMirrored]; 
```

然后我将上面的 UIImage 对象设置为 UIView 的子类，并覆盖 drawRect：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);

    CGAffineTransform t0 = CGContextGetCTM(context);
    CGContextConcatCTM(context, t0);

    CGContextDrawImage(context, self.bounds, [image CGImage]);
    CGContextRestoreGState(context);
} 
```

无论我绘制哪张图片，显示的图像始终是原始图像，设置为 UIView 子类时永远不会显示镜像图像。我确定镜像图像已正确设置为 UIView，因为调试信息显示方向成员变量等于 4，这意味着“UIImageOrientationUpMirrored”，而原始图像等于 0。有没有人可以帮我解决这个问题， 谢谢。

我还尝试使用 setImage: 在 UIImageView 中显示镜像图像，并且它可以正常工作。顺便我发现在调用UIImageView的setImage时drawRect中的断点从来没有命中过，我们如何定义在加载图像到UIImageView时的绘制行为（例如在图像上方画一条线）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:38:25.477

您将图像镜像到 UI 级别。这将返回一个新的 UIImage，但 CGImage 保持不变。如果你做一些 NSLogs，你会注意到这一点。

您还可以在 UI 级别进行转换。如果您使用这种方法，我建议使用 originalImg.scale 而不是 1.0。然后代码将适用于视网膜和非视网膜显示器。

```
[UIImage imageWithCGImage:[originalImg CGImage] scale:originalImg.scale orientation:UIImageOrientationUpMirrored]; 
```

如果您确实需要镜像 CGImage，请查看 GitHub 上的 NYXImagesKit（请参阅 UIImage+Rotating.m）

# iphone - 应用程序因未捕获的异常 NSUnknownKey 异常而终止，键值不符合编码

> ID：12065868
> 
> 赞同：1
> 
> 时间：2012-08-22T03:11:32.167
> 
> 标签：iphone, xcode, crash, outlet, nsunknownkeyexception

抱歉问了这么简单的问题，但我是初学者

我正在关注有关构建应用程序的教程。我正在创建一个按钮，但我不小心把它命名错了，我命名它而不是在创建插座时。虽然我在创建动作时命名它是正确的。我运行了我的应用程序但它失败了，因为我的实例调用了，而不是（至少我认为这就是我的应用程序崩溃的原因。所以删除了插座和 xcode 为插座编写的自动代码，我重新制作了插座并将其命名为正确时间。但是现在当我运行我的应用程序时它终止了，报告如下：

2012-08-21 20:42:07.602 FieldButtonFun[973:c07] *** 由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[setValue:forUndefinedKey:]：此类不符合键值编码的键 theNutton 。***第一掷调用堆栈：（0x14b2022 0xeb2cd6 0x14b1ee1 0x9c3022 0x934f6b 0x934edb 0x94fd50 0x23771a 0x14b3dea 0x141d7f1 0x23626e 0xdc1fc 0xdc779 0xdc99b 0x3b401 0x3b670 0x3b836 0x4272a 0x13596 0x14274 0x23183 0x23c38 0x17634 0x139cef5 0x1486195 0x13eaff2 0x13e98da 0x13e8d84 0x13e8c9b 0x13c65 0x15626 0x271d 0x2685）终止叫做抛出一个异常

我不知道出了什么问题，我根本不理解错误报告。我以为我已经删除了创建插座并重新制作它时生成的所有自动代码 Xcode。谁能帮助我找出可能出了什么问题？

我可以从头开始重建这个应用程序，但我想了解为什么会出错，以供将来参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T03:35:41.373

`theNutton`Xcode在类中找不到键的值`FieldButtonFun`。

如果不看实际代码，很难说哪里出了问题。但在大多数情况下，XIB 文件中可能存在错误连接。请检查XIB，ctrl-click `File's Owner`，看是否有黄色警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T04:01:59.767

![在此处输入图像描述](../Images/9d50d1cb088168eebb9e119cf2401bba.png)

单击您的.xib，然后您将看到文件'在右上角单击它并检查您是否有任何黄色连接，如果有，请单击交叉按钮（X）并从xib右键单击并将连接拖动到文件管理器'来自您的 uibutton 的所有者以进行操作（方法）连接。

然后右键单击并从 filer'owner 拖动到 IBOutlet（您在界面中声明为 IBOutlet 的 uiobject）。

# configuration - nginx 更改默认字符集

> ID：12065872
> 
> 赞同：0
> 
> 时间：2012-08-22T03:13:26.780
> 
> 标签：configuration, nginx

我设置了字符集 utf-8；在 http 标记处，但给出了 error.log：2012/08/22 10:47:33 [error] 6588#1560: *1 在读取响应标头时，字符集“GB2312”和“utf-8”之间没有“charset_map”上游，客户端：127.0.0.1，服务器：localhost，请求：“GET /index2.php HTTP/1.1”，上游：“fastcgi://127.0.0.1:9000”....有什么想法吗？我只想将默认语言设置为 utf-8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T19:09:52.333

从您给出的错误看来，您的 fastcgi-app 正在将 gb2312 编码的文本传递给 nginx。所以要么：

*   确保它正在发送 utf-8 文本，或者
*   确保您在 nginx 中设置了适当的 charset_map（请参阅[http://nginx.org/en/docs/http/ngx_http_charset_module.html#charset_map](http://nginx.org/en/docs/http/ngx_http_charset_module.html#charset_map)）

# objective-c - 我在哪里可以从 UIController 中找到 instantiateViewControllerWithIdentifier 的标识符？

> ID：12065877
> 
> 赞同：2
> 
> 时间：2012-08-22T03:14:50.230
> 
> 标签：objective-c, ios, xcode

我在哪里可以找到 UIController 的标识符（参见下面代码中的“xxx”）？

我尝试了一切都没有奏效，我一直在寻找没有人提到从哪里得到它......听起来很明显但我不知道......

```
 -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIStoryboard*  sb = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                                  bundle:nil];
    BookMenuController* bookControll = [sb instantiateViewControllerWithIdentifier:@"xxx"];

    bookControll.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    [self presentModalViewController:bookControll animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:24:41.797

您在控制器的界面构建器身份检查器中设置标识符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:38:41.163

要在 StoryBoard 中查找标识符，请单击 UIViewController，然后在属性检查器下，您应该会看到一个名为 Identifier 的字段。那是你的“xxx”。

![标识符](../Images/19777e28ee42f1aac1a34f4f60c92eed.png)

# c++ - 从 Qt 中的内存映射文件流式传输

> ID：12065879
> 
> 赞同：1
> 
> 时间：2012-08-22T03:15:40.383
> 
> 标签：c++, visual-studio-2010, qt, memory-mapped-files

有没有办法在 Qt 中创建位于内存映射文件开头的数据流？一旦我使用`QFile::map`方法，我得到一个`uchar*`. 那么有没有办法用它来初始化数据流呢？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T10:44:02.410

我还没有尝试过，但是有一个`QDataStream::readRawData()`函数可以接受 a`char *`和一个长度，您应该可以将其`uchar *`输入。这会给你你的流。

# ruby-on-rails - 如何获取模型实例变量

> ID：12065882
> 
> 赞同：2
> 
> 时间：2012-08-22T03:16:04.950
> 
> 标签：ruby-on-rails, ruby, model

我有一个简单的 Rails 应用程序用来尝试学习 Rails。

它有一个我使用 ActiveRecord 创建的数据库表：

```
class CreateMovies < ActiveRecord::Migration
  def up
    create_table :movies do |t|
      t.string :title
      t.string :rating
      t.text :description
      t.datetime :release_date
      t.timestamps
    end
  end

  def down
    drop_table :movies
  end
end 
```

这是我相应的模型类：

```
class Movie < ActiveRecord::Base
  def self.all_ratings
    %w(G PG PG-13 NC-17 R)
  end

  def name_with_rating()
    return "#{@title} (#{@rating})"
  end
end 
```

当我在 Movie 的实例上调用 name_with_rating 时，它返回的只是任何 Movie 的“()”。从 Movie 的实例方法中调用以获取 Movie 实例的字段的正确语法或方法是什么？

请注意，数据库已正确填充电影行等。我已经完成了 rake db:create、rake db:migrate 等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T03:25:17.577

活动记录属性不作为实例变量实现。尝试

```
class Movie < ActiveRecord::Base
  def name_with_rating()
    return "#{title} (#{rating})"
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:39:18.813

```
class Movie < ActiveRecord::Base
  def name_with_rating
     "#{title} (#{rating})"
  end
end 
```

然后在控制台中`Movie.first.name_with_rating`应该可以工作。

# asp.net - ASP.NET 在 Web 应用程序而不是网站中添加 Razor 页面，没有 MVC

> ID：12065884
> 
> 赞同：4
> 
> 时间：2012-08-22T03:16:32.990
> 
> 标签：asp.net, asp.net-mvc-3, visual-studio-2010, web-applications, razor

我刚刚在 Visual Studio 2010 中发现了一件奇怪的事情。

我可以将 Razor 页面添加到网站项目中，但不能在 Web 应用程序项目中执行此操作。

我知道我可以创建一个 ASP.NET MVC(1-4) 项目，它允许我在其中添加一个 Razor 页面。

在我检查了网站（WS）项目和 Web 应用程序（WA）项目之间的差异之后，在我看来，在大多数情况下，WA 将趋向于比 WS 具有更多的功能。

所以我的问题是：Visual Studio 2010 允许我们将 Razor 页面添加到 WS 项目中（您可以在模板列表中添加新页面时找到它），但是为什么它没有在模板中提供 Razor 页面WA项目？

我很好奇。等待你的答案:)

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T15:04:36.420

创建新的空 Web 应用程序时，我遇到了同样的问题。我想使用 MVC。尽管添加了所需的引用，但它仍然不允许我通过右键单击文件夹来创建文件。

但是，如果您在 Visual Studio 2010 上安装了 SP1，则可以：

*   右键单击 > 添加 > 从模板新建 > Razor MVC 视图

希望这可以帮助。

# python - 如果列中的值在一组值列表中，则过滤数据框行

> ID：12065885
> 
> 赞同：534
> 
> 时间：2012-08-22T03:16:56.393
> 
> 标签：python, pandas, dataframe

我有一个 Python 熊猫数据框`rpt`：

```
rpt
<class 'pandas.core.frame.DataFrame'>
MultiIndex: 47518 entries, ('000002', '20120331') to ('603366', '20091231')
Data columns:
STK_ID                    47518  non-null values
STK_Name                  47518  non-null values
RPT_Date                  47518  non-null values
sales                     47518  non-null values 
```

我可以过滤股票 id 是`'600809'`这样的行：`rpt[rpt['STK_ID'] == '600809']`

```
<class 'pandas.core.frame.DataFrame'>
MultiIndex: 25 entries, ('600809', '20120331') to ('600809', '20060331')
Data columns:
STK_ID                    25  non-null values
STK_Name                  25  non-null values
RPT_Date                  25  non-null values
sales                     25  non-null values 
```

我想把一些股票的所有行放在一起，比如`['600809','600141','600329']`. 这意味着我想要这样的语法：

```
stk_list = ['600809','600141','600329']

rst = rpt[rpt['STK_ID'] in stk_list] # this does not works in pandas 
```

既然 pandas 不接受上面的命令，那如何达到目标呢？

* * *

## 回答 #1

> 赞同：774
> 
> 时间：2012-08-22T03:21:12.067

使用`isin`方法：

`rpt[rpt['STK_ID'].isin(stk_list)]`

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2014-11-03T22:49:27.230

`isin()`如果您有一个完全匹配的列表是理想的，但是如果您有一个部分匹配或子字符串的列表要查找，您可以使用[`str.contains`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.core.strings.StringMethods.contains.html)方法和正则表达式进行过滤。

例如，如果我们要返回一个 DataFrame，其中所有的股票 ID 都以开头，`'600'`然后是任意三位数字：

```
>>> rpt[rpt['STK_ID'].str.contains(r'^600[0-9]{3}$')] # ^ means start of string
...   STK_ID   ...                                    # [0-9]{3} means any three digits
...  '600809'  ...                                    # $ means end of string
...  '600141'  ...
...  '600329'  ...
...      ...   ... 
```

假设现在我们有一个字符串列表，我们希望其中的值以这些字符串`'STK_ID'`结尾，例如

```
endstrings = ['01$', '02$', '05$'] 
```

我们可以将这些字符串与正则表达式“或”字符连接起来`|`，并将字符串传递`str.contains`给过滤 DataFrame：

```
>>> rpt[rpt['STK_ID'].str.contains('|'.join(endstrings)]
...   STK_ID   ...
...  '155905'  ...
...  '633101'  ...
...  '210302'  ...
...      ...   ... 
```

最后，`contains`可以忽略大小写（通过设置`case=False`），让您在指定要匹配的字符串时更加通用。

例如，

```
str.contains('pandas', case=False) 
```

将匹配`PANDAS`, `PanDAs`, `paNdAs123`, 等等。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2013-10-10T12:26:29.810

您还可以通过以下方式使用范围：

```
b = df[(df['a'] > 1) & (df['a'] < 5)] 
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2015-03-17T20:12:10.800

您也可以直接[查询](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html)您的 DataFrame 以获取此信息。

```
rpt.query('STK_ID in (600809,600141,600329)') 
```

或类似地搜索范围：

```
rpt.query('60000 < STK_ID < 70000') 
```

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2017-04-27T13:24:17.697

# 使用 pandas 切片数据

给定这样的数据框：

```
 RPT_Date  STK_ID STK_Name  sales
0 1980-01-01       0   Arthur      0
1 1980-01-02       1    Beate      4
2 1980-01-03       2    Cecil      2
3 1980-01-04       3     Dana      8
4 1980-01-05       4     Eric      4
5 1980-01-06       5    Fidel      5
6 1980-01-07       6   George      4
7 1980-01-08       7     Hans      7
8 1980-01-09       8   Ingrid      7
9 1980-01-10       9    Jones      4 
```

有多种选择或切片数据的方法。

### 使用 .isin

最明显的是`.isin`特征。您可以创建一个掩码，为您提供一系列`True`/`False`语句，可以将其应用于数据框，如下所示：

```
mask = df['STK_ID'].isin([4, 2, 6])

mask
0    False
1    False
2     True
3    False
4     True
5    False
6     True
7    False
8    False
9    False
Name: STK_ID, dtype: bool

df[mask]
    RPT_Date  STK_ID STK_Name  sales
2 1980-01-03       2    Cecil      2
4 1980-01-05       4     Eric      4
6 1980-01-07       6   George      4 
```

屏蔽是问题的临时解决方案，但在速度和内存方面并不总是表现良好。

### 带索引

通过为`STK_ID`列设置索引，我们可以使用 pandas 内置的切片对象`.loc`

```
df.set_index('STK_ID', inplace=True)
         RPT_Date STK_Name  sales
STK_ID                           
0      1980-01-01   Arthur      0
1      1980-01-02    Beate      4
2      1980-01-03    Cecil      2
3      1980-01-04     Dana      8
4      1980-01-05     Eric      4
5      1980-01-06    Fidel      5
6      1980-01-07   George      4
7      1980-01-08     Hans      7
8      1980-01-09   Ingrid      7
9      1980-01-10    Jones      4

df.loc[[4, 2, 6]]
         RPT_Date STK_Name  sales
STK_ID                           
4      1980-01-05     Eric      4
2      1980-01-03    Cecil      2
6      1980-01-07   George      4 
```

这是执行此操作的快速方法，即使索引可能需要一点时间，如果您想要执行多个这样的查询，它也可以节省时间。

### 合并数据框

这也可以通过合并数据帧来完成。这更适合您拥有比这些示例更多的数据的场景。

```
stkid_df = pd.DataFrame({"STK_ID": [4,2,6]})
df.merge(stkid_df, on='STK_ID')
   STK_ID   RPT_Date STK_Name  sales
0       2 1980-01-03    Cecil      2
1       4 1980-01-05     Eric      4
2       6 1980-01-07   George      4 
```

# 笔记

即使有多行相同，上述所有方法都有效`'STK_ID'`

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2017-09-28T03:04:39.613

你也可以通过使用'query'和@来获得类似的结果：

例如：

```
df = pd.DataFrame({'A': [1, 2, 3], 'B': ['a', 'b', 'f']})
df = pd.DataFrame({'A' : [5,6,3,4], 'B' : [1,2,3, 5]})
list_of_values = [3,6]
result= df.query("A in @list_of_values")
result
   A  B
1  6  2
2  3  3 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-04-26T20:09:12.843

您可以使用`query`，即：

```
b = df.query('a > 1 & a < 5') 
```

# qt - QAudioOutput::start() 是否需要从主线程调用？

> ID：12065886
> 
> 赞同：0
> 
> 时间：2012-08-22T03:17:02.113
> 
> 标签：qt, phonon

我在我的代码中播放音频，如下所示：

```
// decode routine

QAudioFormat format;
format.setFrequency(aCodecCtx->sample_rate);
format.setChannels(2);
format.setSampleSize(16);
format.setCodec("audio/pcm");
format.setByteOrder(QAudioFormat::LittleEndian);
format.setSampleType(QAudioFormat::SignedInt);
QAudioDeviceInfo info(QAudioDeviceInfo::defaultOutputDevice());
if (!info.isFormatSupported(format)) {
    cout<<"raw audio format not supported by backend, cannot play audio." <<endl;
    format = info.nearestFormat(format);
}
QAudioOutput * audio = new QAudioOutput(format);
connect(audio,SIGNAL(stateChanged(QAudio::State)),SLOT(stateChanged(QAudio::State)));
if( !buffer->open(QBuffer::ReadWrite) )
    cout << "Couldnt open Buffer" << endl;
cout << "buffer.size()=" << buffer->size() <<endl;
audio->start(buffer); 
```

我在工作线程中运行此代码，因为解码器例程很重。但是没有声音在播放。我将此代码转移到主线程，一切正常。

为什么会这样？QAudioOutput 文档没有说明它需要在哪个线程上运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:07:28.823

我忘了在工作线程中启动一个事件循环。否则线程退出，这就是音频不播放的原因

# debugging - VS2008中的堆栈调试

> ID：12065888
> 
> 赞同：0
> 
> 时间：2012-08-22T03:17:26.370
> 
> 标签：debugging, visual-studio-2008, opencv

我正在使用 OpenCV 包中的原始源代码进行一些编辑以完成我的任务。我修改后还有一些其他的编译错误。但我已经修复了它们。这是我不知道如何删除它的最后一个：

![在此处输入图像描述](../Images/9c5787243881c66a318957a963aadefd.png)

此外，此运行时错误不会向命令行提供任何输出以方便调试

当出现这样的错误时，有什么解决方案吗？

PS：原代码是calib3d.cpp的函数cvFindExtrinsicCameraParams2

为了方便起见，我在这里发布了原始的 OpenCV 函数：

```
CV_IMPL void cvFindExtrinsicCameraParams2( const CvMat* objectPoints,
              const CvMat* imagePoints, const CvMat* A,
              const CvMat* distCoeffs, CvMat* rvec, CvMat* tvec,
              int useExtrinsicGuess )
{
const int max_iter = 20;
Ptr<CvMat> matM, _Mxy, _m, _mn, matL, matJ;

int i, count;
double a[9], ar[9]={1,0,0,0,1,0,0,0,1}, R[9];
double MM[9], U[9], V[9], W[3];
CvScalar Mc;
double param[6];
CvMat matA = cvMat( 3, 3, CV_64F, a );
CvMat _Ar = cvMat( 3, 3, CV_64F, ar );
CvMat matR = cvMat( 3, 3, CV_64F, R );
CvMat _r = cvMat( 3, 1, CV_64F, param );
CvMat _t = cvMat( 3, 1, CV_64F, param + 3 );
CvMat _Mc = cvMat( 1, 3, CV_64F, Mc.val );
CvMat _MM = cvMat( 3, 3, CV_64F, MM );
CvMat matU = cvMat( 3, 3, CV_64F, U );
CvMat matV = cvMat( 3, 3, CV_64F, V );
CvMat matW = cvMat( 3, 1, CV_64F, W );
CvMat _param = cvMat( 6, 1, CV_64F, param );
CvMat _dpdr, _dpdt;

CV_Assert( CV_IS_MAT(objectPoints) && CV_IS_MAT(imagePoints) &&
    CV_IS_MAT(A) && CV_IS_MAT(rvec) && CV_IS_MAT(tvec) );

count = MAX(objectPoints->cols, objectPoints->rows);
matM = cvCreateMat( 1, count, CV_64FC3 );
_m = cvCreateMat( 1, count, CV_64FC2 );

cvConvertPointsHomogeneous( objectPoints, matM );
cvConvertPointsHomogeneous( imagePoints, _m );
cvConvert( A, &matA );

CV_Assert( (CV_MAT_DEPTH(rvec->type) == CV_64F || CV_MAT_DEPTH(rvec->type) == CV_32F) &&
    (rvec->rows == 1 || rvec->cols == 1) && rvec->rows*rvec->cols*CV_MAT_CN(rvec->type) == 3 );

CV_Assert( (CV_MAT_DEPTH(tvec->type) == CV_64F || CV_MAT_DEPTH(tvec->type) == CV_32F) &&
    (tvec->rows == 1 || tvec->cols == 1) && tvec->rows*tvec->cols*CV_MAT_CN(tvec->type) == 3 );

_mn = cvCreateMat( 1, count, CV_64FC2 );
_Mxy = cvCreateMat( 1, count, CV_64FC2 );

// normalize image points
// (unapply the intrinsic matrix transformation and distortion)
cvUndistortPoints( _m, _mn, &matA, distCoeffs, 0, &_Ar );

if( useExtrinsicGuess )
{
    CvMat _r_temp = cvMat(rvec->rows, rvec->cols,
        CV_MAKETYPE(CV_64F,CV_MAT_CN(rvec->type)), param );
    CvMat _t_temp = cvMat(tvec->rows, tvec->cols,
        CV_MAKETYPE(CV_64F,CV_MAT_CN(tvec->type)), param + 3);
    cvConvert( rvec, &_r_temp );
    cvConvert( tvec, &_t_temp );
}
else
{
    Mc = cvAvg(matM);
    cvReshape( matM, matM, 1, count );
    cvMulTransposed( matM, &_MM, 1, &_Mc );
    cvSVD( &_MM, &matW, 0, &matV, CV_SVD_MODIFY_A + CV_SVD_V_T );

    // initialize extrinsic parameters
    if( W[2]/W[1] < 1e-3 || count < 4 )
    {
        // a planar structure case (all M's lie in the same plane)
        double tt[3], h[9], h1_norm, h2_norm;
        CvMat* R_transform = &matV;
        CvMat T_transform = cvMat( 3, 1, CV_64F, tt );
        CvMat matH = cvMat( 3, 3, CV_64F, h );
        CvMat _h1, _h2, _h3;

        if( V[2]*V[2] + V[5]*V[5] < 1e-10 )
            cvSetIdentity( R_transform );

        if( cvDet(R_transform) < 0 )
            cvScale( R_transform, R_transform, -1 );

        cvGEMM( R_transform, &_Mc, -1, 0, 0, &T_transform, CV_GEMM_B_T );

        for( i = 0; i < count; i++ )
        {
            const double* Rp = R_transform->data.db;
            const double* Tp = T_transform.data.db;
            const double* src = matM->data.db + i*3;
            double* dst = _Mxy->data.db + i*2;

            dst[0] = Rp[0]*src[0] + Rp[1]*src[1] + Rp[2]*src[2] + Tp[0];
            dst[1] = Rp[3]*src[0] + Rp[4]*src[1] + Rp[5]*src[2] + Tp[1];
        }

        cvFindHomography( _Mxy, _mn, &matH );

        if( cvCheckArr(&matH, CV_CHECK_QUIET) )
        {
            cvGetCol( &matH, &_h1, 0 );
            _h2 = _h1; _h2.data.db++;
            _h3 = _h2; _h3.data.db++;
            h1_norm = sqrt(h[0]*h[0] + h[3]*h[3] + h[6]*h[6]);
            h2_norm = sqrt(h[1]*h[1] + h[4]*h[4] + h[7]*h[7]);

            cvScale( &_h1, &_h1, 1./MAX(h1_norm, DBL_EPSILON) );
            cvScale( &_h2, &_h2, 1./MAX(h2_norm, DBL_EPSILON) );
            cvScale( &_h3, &_t, 2./MAX(h1_norm + h2_norm, DBL_EPSILON));
            cvCrossProduct( &_h1, &_h2, &_h3 );

            cvRodrigues2( &matH, &_r );
            cvRodrigues2( &_r, &matH );
            cvMatMulAdd( &matH, &T_transform, &_t, &_t );
            cvMatMul( &matH, R_transform, &matR );
        }
        else
        {
            cvSetIdentity( &matR );
            cvZero( &_t );
        }

        cvRodrigues2( &matR, &_r );
    }
    else
    {
        // non-planar structure. Use DLT method
        double* L;
        double LL[12*12], LW[12], LV[12*12], sc;
        CvMat _LL = cvMat( 12, 12, CV_64F, LL );
        CvMat _LW = cvMat( 12, 1, CV_64F, LW );
        CvMat _LV = cvMat( 12, 12, CV_64F, LV );
        CvMat _RRt, _RR, _tt;
        CvPoint3D64f* M = (CvPoint3D64f*)matM->data.db;
        CvPoint2D64f* mn = (CvPoint2D64f*)_mn->data.db;

        matL = cvCreateMat( 2*count, 12, CV_64F );
        L = matL->data.db;

        for( i = 0; i < count; i++, L += 24 )
        {
            double x = -mn[i].x, y = -mn[i].y;
            L[0] = L[16] = M[i].x;
            L[1] = L[17] = M[i].y;
            L[2] = L[18] = M[i].z;
            L[3] = L[19] = 1.;
            L[4] = L[5] = L[6] = L[7] = 0.;
            L[12] = L[13] = L[14] = L[15] = 0.;
            L[8] = x*M[i].x;
            L[9] = x*M[i].y;
            L[10] = x*M[i].z;
            L[11] = x;
            L[20] = y*M[i].x;
            L[21] = y*M[i].y;
            L[22] = y*M[i].z;
            L[23] = y;
        }

        cvMulTransposed( matL, &_LL, 1 );
        cvSVD( &_LL, &_LW, 0, &_LV, CV_SVD_MODIFY_A + CV_SVD_V_T );
        _RRt = cvMat( 3, 4, CV_64F, LV + 11*12 );
        cvGetCols( &_RRt, &_RR, 0, 3 );
        cvGetCol( &_RRt, &_tt, 3 );
        if( cvDet(&_RR) < 0 )
            cvScale( &_RRt, &_RRt, -1 );
        sc = cvNorm(&_RR);
        cvSVD( &_RR, &matW, &matU, &matV, CV_SVD_MODIFY_A + CV_SVD_U_T + CV_SVD_V_T );
        cvGEMM( &matU, &matV, 1, 0, 0, &matR, CV_GEMM_A_T );
        cvScale( &_tt, &_t, cvNorm(&matR)/sc );
        cvRodrigues2( &matR, &_r );
    }
}

cvReshape( matM, matM, 3, 1 );
cvReshape( _mn, _mn, 2, 1 );

// refine extrinsic parameters using iterative algorithm
CvLevMarq solver( 6, count*2, cvTermCriteria(CV_TERMCRIT_EPS+CV_TERMCRIT_ITER,max_iter,FLT_EPSILON), true);
cvCopy( &_param, solver.param );

for(;;)
{
    CvMat *matJ = 0, *_err = 0;
    const CvMat *__param = 0;
    bool proceed = solver.update( __param, matJ, _err );
    cvCopy( __param, &_param );
    if( !proceed || !_err )
        break;
    cvReshape( _err, _err, 2, 1 );
    if( matJ )
    {
        cvGetCols( matJ, &_dpdr, 0, 3 );
        cvGetCols( matJ, &_dpdt, 3, 6 );
        cvProjectPoints2( matM, &_r, &_t, &matA, distCoeffs,
                          _err, &_dpdr, &_dpdt, 0, 0, 0 );
    }
    else
    {
        cvProjectPoints2( matM, &_r, &_t, &matA, distCoeffs,
                          _err, 0, 0, 0, 0, 0 );
    }
    cvSub(_err, _m, _err);
    cvReshape( _err, _err, 1, 2*count );
}
cvCopy( solver.param, &_param );

_r = cvMat( rvec->rows, rvec->cols,
    CV_MAKETYPE(CV_64F,CV_MAT_CN(rvec->type)), param );
_t = cvMat( tvec->rows, tvec->cols,
    CV_MAKETYPE(CV_64F,CV_MAT_CN(tvec->type)), param + 3 );

cvConvert( &_r, rvec );
cvConvert( &_t, tvec );
} 
```

我想这很复杂！:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T08:34:57.643

这里出了问题的是，在其中一个函数调用中，编译器将局部变量`tvecmat_ar`放在了堆栈上，但在调试构建中，它还在变量之后放置了一些保护块。当函数即将返回并且堆栈被弹出时，调试运行时会检查保护块的状态。如果它们具有不同的值，那么这会生成您所看到的堆栈损坏错误。所以这意味着该函数中的代码正在破坏内存。我敢打赌，您正在写入超出该数组大小的数组。

您尚未附加包含警告您的变量的代码源，因此无法进一步说明，但我建议您检查函数中的所有数组分配和索引。

# iphone - 模拟器的 iPhone 静态库问题

> ID：12065894
> 
> 赞同：3
> 
> 时间：2012-08-22T03:18:35.430
> 
> 标签：iphone, xcode, ios-simulator, i386

所以我有一个我正在尝试构建的 iPhone 静态库。我有这个问题中使用的脚本（http://stackoverflow.com/questions/3520977/build-fat-static-library-device-simulator-using-xcode-and-sdk-4），但是我遇到的问题是我似乎仍然无法成功地为模拟器构建静态库。当我在静态库项目中构建时，我收到以下警告：

```
warning: no rule to process file '$(PROJECT_DIR)/GDInAppStore/GDInAppStore.m' of type sourcecode.c.objc for architecture i386
warning: no rule to process file '$(PROJECT_DIR)/GDInAppStore/SKProduct+priceAsString.m' of type sourcecode.c.objc for architecture i386
warning: no rule to process file '$(PROJECT_DIR)/GDInAppStore/VerificationControllerPBK.m' of type sourcecode.c.objc for architecture i386 
```

我相信这个问题导致了导致我从构建脚本获得的通用库的问题，导致我的其他项目中出现此错误

```
ld: warning: ignoring file /Users/abotkin/Projects/Static Libraries/GDInAppStore/libGDInAppStore.a, missing required architecture i386 in file
"_OBJC_CLASS_$_GDInAppStore", referenced from:
objc-class-ref in SubscribeNowInAppController.o
ld: symbol(s) not found for architecture i386 
```

我正在使用 Xcode 4.3.2 并在静态库 Xcode 项目中设置了标志，以便 i386 包含在架构和有效架构中。有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-19T17:50:07.523

如果您正在为 i386 编译，请确保您正在为模拟器构建。基本上，您的 arch 参数必须与您的 sdk 参数相匹配。IE

xcodebuild -project proj.xcodeproj -arch armv64 -sdk iphoneos8.1 build

和

xcodebuild -project proj.xcodeproj -arch i386 -sdk iphonesimulator8.1 build

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T14:48:35.230

我能够通过使用 Karl 的 iOS 通用框架来解决这个问题，他在[https://stackoverflow.com/a/5721978/497718的另一个主题中提到了该框架](https://stackoverflow.com/a/5721978/497718)

也就是说，如果有人能指出我在同一主题中使用脚本时可能做错了什么，我很想学习如何以正确的方式去做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-19T18:03:44.790

在 Xcode 6 中，Apple 在其构建工具中添加了 iOS 框架支持。

对所有新项目使用 Apple 的框架目标，因为它不那么 hacky 并且由 Apple 自己支持。

# c++ - c ++在函数内部创建引用变量

> ID：12065897
> 
> 赞同：2
> 
> 时间：2012-08-22T03:19:08.293
> 
> 标签：c++, reference

假设我有以下功能：

```
void myFunc(P& first, P& last) {
    std::cout << first.child.grandchild[2] << endl;
    // ...
} 
```

现在，让我们假设这`first.child.grandchild[2]`对我的目的来说太长了。例如，假设它会经常出现在里面的方程式中`myFunc(P&,P&)`。所以，我想在函数内部创建某种符号引用，这样我的方程就不会那么混乱了。我怎么能这样做？

特别是，考虑下面的代码。我需要知道我可以插入什么语句，这样不仅 line_1a 的输出始终与**line_1b**的输出相同，而且 line_2a 的输出始终与**line_2b**的**输出****相同**。换句话说，我不想要 的值的副本`first.child.grandchild`，而是到对象的引用或符号链接`first.child.grandchild`。

```
void myFunc(P& first, P& last) {
    // INSERT STATEMENT HERE TO DEFINE "g"

    std::cout << first.child.grandchild[2] << endl; // line_1a
    std::cout << g[2] << endl;                      // line_1b

    g[4] = X; // where X is an in-scope object of matching type

    std::cout << first.child.grandchild[4] << endl; // line_2a
    std::cout << g[4] << endl;                      // line_2b
    //...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:21:34.097

使用指针 - 然后您可以在函数中更改它。

```
WhateverGrandchildIs *ptr=&first.child.grandchild[2];

std::cout << *ptr << std::endl; 

ptr=&first.child.grandchild[4];

std::cout << *ptr << std::endl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:31:30.830

说`grandchild`is`T`和 size 的类型是`N`; 那么下面是为数组创建引用的方法。

```
void myFunc(P& first, P& last) {
  T (&g)[N] = first.child.grandchild;
  ...
} 
```

我不喜欢这里的指针，尽管它也是一种可能的方式。因为，数组的静态大小有助于静态分析器进行范围检查。

如果您使用的是 C++11 编译器，那么`auto`这是最好的方法（@SethCarnegie 已经提到过）：

```
auto &g = first.child.grandchild; 
```

# php - 登录时黑屏

> ID：12065907
> 
> 赞同：-4
> 
> 时间：2012-08-22T03:21:28.200
> 
> 标签：php, html

我的代码需要一些帮助。它可以在我的计算机上的 XAMPP 上运行，但是当它在我的服务器上运行时，它将无法运行，我得到的只是一个空白屏幕。你可以看看在`<a href="http://www.redhotessentials.com/prototype/pages/login.php</a>`put username allanallan password allanallan 会发生什么，你可以看看会发生什么谢谢

```
<?php
if (isset($_POST['email'])) {
//Connect to the database through our include 
require("db.php");

$email = stripslashes($_POST['email']);
$email = strip_tags($email);
$email = mysql_real_escape_string($email);
$password = preg_replace("[^A-Za-z0-9]", "", $_POST['password']); // filter everything but numbers and letters
$password = md5($password);
// Make query and then register all database data that -
// cannot be changed by member into SESSION variables.
// Data that you want member to be able to change -
// should never be set into a SESSION variable.
$sql = mysql_query("SELECT * FROM members WHERE email='$email' AND password='$password' AND emailactivated='1'"); 
$login_check = mysql_num_rows($sql);
if($login_check>0){ 
    while($row = mysql_fetch_array($sql)){ 
        // Get member ID into a session variable
        $id = $row['id'];  
        session_register('id'); 
        $_SESSION['id'] = $id;
        // Get member username into a session variable
        $username = $row['username'];   
        session_register('username'); 
        $_SESSION['username'] = $username;
        // Update last_log_date field for this member now
        mysql_query("UPDATE members SET lastlogin=now() WHERE id='$id'"); 
        // Print success message here if all went well then exit the script
        header("location: endlessnails_blog.php");

        exit();
    } // close while
} else {
// Print login failure message to the user and link them back to your login page
  print '<br /><br /><font color="#FF0000">No match in our records, try again </font><br />
<br /><a href="index.php">Click here</a> to go back to the login page.';
  exit();
}
}// close if post
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Login to your profile</title>
<link rel="stylesheet" type="text/css" href="../../css/main4.css" />
<script type="text/javascript">
<!-- Form Validation -->
function validate_form ( ) { 
valid = true; 
if ( document.logform.email.value == "" ) { 
alert ( "Please enter your User Name" ); 
valid = false;
}
if ( document.logform.pass.value == "" ) { 
alert ( "Please enter your password" ); 
valid = false;
}
return valid;
}
<!-- Form Validation -->
</script>
</head>
<?php include("header.php"); ?>
<?php include("nav.php"); ?>
<body>
       <div id="container">
        <div id="box3">
     <div align="center">
       <h3 id="login2"><br />
         <br />
       Log into Endless Nails Blog<br />  
       <br />
       </h3>
     </div>
     <div id="loginformmove">
     <table class="style7" align="center" cellpadding="5">
      <form action="index.php" method="post" enctype="multipart/form-data" name="logform" 
id="logform" onsubmit="return validate_form ( );">
        <tr>
          <td class="style7"><div align="right">Email Address:</div></td>
          <td class="style7"><input name="email" type="text" id="email" size="30" maxlength="64" /></td>
        </tr>  
        <tr>
          <td class="style7"><div align="right">Password:</div></td>
          <td class="style7"><input name="password" type="password" id="password" size="30" maxlength="24" /></td>
        </tr>
        <tr>
        <td class="style7">&nbsp;</td>
          <td id="login3"><input name="Submit" type="submit" value="Login" class="login_pad" /></td>
        </tr>
      </form>
     </table>
    </div>
   </div>
  </div>
  </div> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:26:20.990

从您的 FORM 属性中删除 enctype，因为您没有上传文件，只需使用方法 =“POST”

# java - 使用随机枢轴进行简单的快速排序实现

> ID：12065910
> 
> 赞同：2
> 
> 时间：2012-08-22T03:22:11.163
> 
> 标签：java, algorithm, quicksort

我正在审查算法的东西并停留在java中的一个简单的快速排序算法实现中

```
import java.util.Arrays;
import java.util.Random;

public class QuickSort {
    int arr[];
    boolean randomPick;
    Random rand = null;

    public QuickSort(int[] inputArray) {
        arr = inputArray;
        randomPick = false;
    }

    public QuickSort(int[] inputArray, boolean random) {
        arr = inputArray;
        if (random) {
            randomPick = true;
            rand = new Random(System.currentTimeMillis());
        }
        else {
            randomPick = false;
        }
    }

    public int[] sort() {
        int start = 0;
        int end = arr.length - 1;
        try {
            _sort(start, end);
        }
        catch (StackOverflowError e) {
            System.out.println("StackOverflow: " + Arrays.toString(arr));
        }
        return arr;
    }

    private void _sort(int start, int end) {
        int i = start;
        int j = end;
        int pivotLoc;
        if (!randomPick) {
            pivotLoc = (j + i) / 2;
        }
        else {
            pivotLoc = rand.nextInt(j - i) + i;
        }
        int pivot = arr[pivotLoc];
        while (i < j) {   // swapping numbers around the pivot
            while (arr[i] < pivot) {
                i++;
            }
            while (arr[j] > pivot) {
                j--;
            }
            if (i < j) {
                int t = arr[i];
                arr[i] = arr[j];
                arr[j] = t;
                i++;
                j--;
            }
        }
        if (i - start > 1) {
            _sort(start, i);
        }
        if (end - i > 1) {
            _sort(i, end);
        }
    }
} 
```

该代码可以选择中间数字作为枢轴，也可以随机选择一个数字作为枢轴，并通过`_sort`循环调用对数组进行排序。它在第一种情况下有效，但在第二种情况下失败。

情况是：当它到达像这个{3,5,5}这样的子数组时，i==start==0和j==end==2。最后交换 5 和 5，i 变为 2，j 变为 1（i++ 和 j--）。然后因为`i - start>1`它会`_sort`一遍又一遍地调用并最终引发stackoverflow错误。然而，错误应该发生在第一种情况（固定枢轴）中，到目前为止还没有发生......

我不知道我的代码有什么问题。我知道阅读其他人编写的代码并不令人愉快，但有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:54:30.420

您在递归条件中犯了一个小错误， the`start`和`end`compare 都是反对`i`的，`start`应该反对`j`

你有：

```
 if (i - start > 1) {
        _sort(start, i);
    }
    if (end - i > 1) {
        _sort(i, end);
    } 
```

需要是：

```
 if (j > start) {
        _sort(start, j);
    }
    if (end > i) {
        _sort(i, end);
    } 
```

并且您的`i`和`j`比较需要允许等于：

```
 // here ----v
        if (i <= j) {
            int t = arr[i];
            arr[i] = arr[j];
            arr[j] = t;
            i++;
            j--;
        } 
```

# assembly - ARM汇编十六进制乘法

> ID：12065912
> 
> 赞同：2
> 
> 时间：2012-08-22T03:22:31.723
> 
> 标签：assembly, hex, arm

任何人都可以向我解释以下内容吗？

以下是`0x0110 003F`不使用乘法指令将R1 乘以常数的最小长度 ARM 指令序列

```
ADD r2, r1, r1, LSL #4      //r2 = 0x11 * r1
RSB r3, r1, r1, LSL #6      //r3 = 0x3F * r1
ADD r3, r3, r2, LSL #20     //r3 = 0x0110 003F * r1 
```

我不知道为什么`0x11`并且`0X3F`习惯于得到`0x0110 003F`

任何熟悉 ARM 架构或十六进制的人都可以为我解释一下这个过程吗？为什么要使用 RSB？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T03:57:20.130

数学与ARM无关...

```
ADD r2,r1,r1, LSL #4    r2 = r1 + (r1 << 4);
RSB r3,r1,r1, LSL #6    r3 = (r1 << 6) - r1;
ADD r3,r3,r2, LSL #20   r3 = r3 + (r2 << 20); 
```

还记得小学的乘法吗？

```
 123
 x 12
=====
  246
+123
=====
 1476 
```

现在关于二进制乘法的真正酷的事情是，您可以将每列的数字乘以 1 或 0（2 的幂）。在个数列上方的十进制数学中，以 (10) 为底的 0 次方，其中包含 2。在二进制（base 2）中，我们不会有。对于十列（以 1 的幂为底），就像我们将在二进制中看到的那样，取顶部的数字并将其乘以以 1 为底的幂（左移一位）并将其添加/累加到结果中。

因此，如果我想在基数 2（二进制）中将某个值乘以 0b1011，我设置了位 3、1 和 0，

```
result = (x<<3) + (x<<1) + (x<<0); 
```

乘以 0x0110003F，我们可以对 8 位中的每一个进行加法运算

```
result = (r1<<24)+(r1<<20)+(r1<<5)... 
```

但我们可以使用更基础的数学。

```
rx * 0x3F
0x3F = 0x40 -1
rx * 0x3F = rx * (0x40 - 1)
distribute
rx * 0x3F = (rx * 0x40) - (rx * 1)
rx * 0x3F = (rx * 0x40) - rx
we know from the comments above that
rx * 0x40 = rx << 6
rx * 0x3F = (rx << 6) - rx 
```

现在

```
ADD r2,r1,r1,lsl 4    r2 = r1 + (r1 << 4) 

r2 = r1 + (r1 << 4)
r2 = r1 + (r1 * 0x10)
r2 = (r1 * 1) + (r1 * 0x10)
r2 = r1 * (1 + 0x10)
r2 = r1 * 0x11 
```

所以

```
r3 = r1 * 0x3F 
r2 = r1 * 0x11 
```

最后一步是

```
result = r3 + (r2<<20)
result = (r1 * 0x3F) + ((r1*0x11)<<20)
result = (r1 * 0x3F) + ((r1*0x11)*0x100000)
result = (r1 * 0x3F) + (r1*0x1100000)
result = r1 * (0x3f + 0x1100000)
result = r1 * 0x110003F 
```

之所以使用反向减法是因为要执行

```
r3 = (r1 << 6) - r1 
```

使用 ARM 指令可以通过以下几种方式完成：

```
mov r3,r1,lsl 6  r3 = (r1 << 6)
sub r3,r3,r1     r3 = r3 - r1 
```

或者

```
rsb r3,r1,r1,lsl 6   r3 = (r1 << 6) - r1 
```

rsb 只是意味着反向减法，一个正常的减法

```
sub ra,rb,rc means ra = rb - rc 
```

反向减法意味着反转操作数的顺序

```
rsb ra,rb,rc means ra = rc - rb 
```

要对像这样的三种寄存器格式的 arm 上的操作数进行移位，它必须是最后一个操作数，所以如果你想移位减法的左操作数，那么使用 rsb。

```
sub ra,rb,rc,lsl x means ra = rb - (rc << x)
rsb ra,rb,rc,lsl x means ra = (rc << x) - rb 
```

我们想要 rsb 表单来保存指令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:50:26.233

这是伪代码（和小数）中的行：

```
r2 = r1 + (r1 <<4) == r1 * 16 + r1 == r1 * 17
r3 = r1 << 6 - r1 = r1 * 64 - r1 = r1 * 63
r3 = r3 + r2 << 20 = r3 + r2 * 1048576 
```

将第 1 行和第 2 行代入第 3 行：

```
r3 = (r1 * 63) + 1048576 * (17 * r1) = r1 * (63 + 17825792) = r1 * 17825855 
```

...`17825855`在十六进制是`110003F`！

要回答为什么使用这些数字的问题，这将与[农民乘法](http://en.wikipedia.org/wiki/Multiplication_algorithm#Peasant_or_binary_multiplication)以及分解为移位和加法有关。你的常数值`110003F`实际上是这样的：

(2 ⁴ + 1) * 2 ^(20) + 2 ⁶ - 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T03:56:12.543

如果您熟悉 C，这里是逐行翻译（使用变量而不是寄存器）：

```
r2 = r1 + (r1 << 4);
r3 = (r1 << 6) - r1;
r3 = r3 + (r2 << 20); 
```

回想一下，这`r1 << 4`与 相同`r1 * 16`，所以第一行说`r2 = r1 + r1*16`，或`r2 = r1*17`。

同样，`r1 << 6`is `r1 * 64`，所以第二行说`r3 = r1 * 64 - r1`， or `r3 = r1*63`。

按照相同的模式，最后一行表示`r3 = r3 + r2 * 1048576`，将前几行的值替换为`r3 = r1*63 + r1*17*1048576`。这简化为`r3 = 17825855 * r1`或`r3 = 0x0110003f * r1`。

# ios - 大子视图以适应另一个小子视图

> ID：12065913
> 
> 赞同：1
> 
> 时间：2012-08-22T03:22:36.827
> 
> 标签：ios, uiview, uilabel, subview

我试图为我的主视图创建一个辅助视图。这个子视图需要很小的高度，它需要适合另一个带有标签的大 UIView。

问题是当我使用 UIView addSubview 时，第三个 UIView 将显示在辅助 UIView 的范围之外。

为了便于理解我的情况，我使用带有照片的界面生成器创建了这些子视图，并在带有照片的模拟器上创建了结果。

任何帮助将非常感激。

谢谢

1.  界面生成器 [http://postimage.org/image/ofi3m05v3/](http://postimage.org/image/ofi3m05v3/)

2.  模拟器 [http://postimage.org/image/x2qps3w2f/](http://postimage.org/image/x2qps3w2f/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T03:59:33.547

您需要将剪辑激活到其中一些视图的边界属性。

```
fooView.clipsToBounds=YES; 
```

那应该可以解决您的问题。只需设置适当的视图以剪辑到它们的边界。

# javascript - 将 iPhone 位置数据导入 Google 地图

> ID：12065914
> 
> 赞同：0
> 
> 时间：2012-08-22T03:22:38.850
> 
> 标签：javascript, iphone, google-maps, geolocation

我正在为我正在开发的浏览器应用程序开发一项功能。我希望得到关于这个话题的任何建议：

1.  一位用户拿着他们的 iPhone 到处走动。

2.  在此期间，他们步行的位置数据被记录下来

3.  然后可以将这些数据导出到谷歌地图，我可以在浏览器中看到覆盖在谷歌地图上的路线。

**这可能吗？我从哪里开始，如何记录数据？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:30:19.540

是的，这是可能的（假设您想使用 Javascript，因为它被标记为您的问题）。

可以在 iPhone 上获取位置数据，[请参阅此问题](https://stackoverflow.com/questions/221592/geolocation-api-on-the-iphone)。您可以使用[Google Maps API](https://developers.google.com/maps/)显示地图并在其上绘制记录的路径。我宁愿直接在您的应用程序中显示步行路线，而不是导出/导入记录路线的坐标。

在实施该应用程序之前，我会查看 Google Maps API 和[OpenStreemMap API](http://wiki.openstreetmap.org/wiki/API)以找出您更喜欢哪个最适合您的需求。在实现您的应用程序之前尝试一些示例可能是一个很好的起点。

# events - ExtJS 4.1 从另一个控制器调用一个控制器

> ID：12065926
> 
> 赞同：8
> 
> 时间：2012-08-22T03:24:22.350
> 
> 标签：events, extjs, controller

*注意：我对 javascript 完全无知。*

我已经将我的 ExtJS 4.1 MVC 应用程序分解为几个控制器，例如：

```
/app/controller/Auth
    |          |Quiz
    |          |Result
    |          |Blah...
    |model/... 
```

我想通过调用我和控制器中*的*函数来响应“事件”，而不是*DOM Event*，而是一个事件。第一部分的总结代码在这里：`Ext.form.action.Submit.success`*`Auth``Quiz`*

 *```
// File: app/controller/Auth.js
attemptLogin : function() {
    var form = Ext.ComponentQuery.query('#loginpanel')[0].form;
    if (form.isValid()) {
        form.submit({
        success : function(form, action) {
            // THIS IS THE FUNCTION FROM THE CURRENT CONTROLLER
            Assessor.controller.Auth.prototype.finishLogin();
            // THIS IS THE FUNCTION FROM THE OTHER CONTROLLER
            Assessor.controller.Quiz.prototype.setupAssessment();
        }, 
```

这有效，但感觉不对。有没有合适的方法来做到这一点？似乎我应该触发一个由两个控制器监听的独特事件，但我不明白如何使用`Ext.Event`. 有什么指导吗？

***谢谢！**我真的很感谢所有伟大的想法和建议。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T04:18:03.543

对我来说，从表单触发自定义事件并在两个控制器中简单地听它是有意义的，就像你在这里所说的那样：

> 似乎我应该触发一个由两个控制器监听的独特事件

```
// File: app/controller/Auth.js
attemptLogin : function() {
    var form = Ext.ComponentQuery.down('#loginpanel').form;
    if (form.isValid()) {
        form.submit({
        success : function(form, action) {
            // fire the event from the form panel
            form.owner.fireEvent('loginsuccess', form.owner);
        }, 
```

然后在每个控制器中，您*可以*使用 Controller#control 来收听它，如下所示：

```
Ext.define('YourApp.controller.Auth', {
    extend: 'Ext.app.Controller',

    init: function() {
        var me = this; 

        me.control({

            '#loginpanel': {

                loginsuccess: me.someHandler

            }
        });
    },

    someHandler: function(form) {
        //whatever needs to be done
        console.log(form);
    }
} 
```

然后将相同的内容添加到您的`Quiz`控制器中：

```
Ext.define('YourApp.controller.Quiz', {
    extend: 'Ext.app.Controller',

    init: function() {
        var me = this; 

        me.control({

            '#loginpanel': {

                loginsuccess: me.someOtherHandler

            }
        });
    },

    someOtherHandler: function(form) {
        //whatever needs to be done
        console.log(form);
    }
} 
```

我在 4.1.0 和 4.1.1 中成功使用了这种方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T04:04:55.217

真的应该是

```
Assessor.controller.Auth.prototype.finishLogin.apply(this, arguments) 
```

或类似的东西（为了有一个正确的`this`引用指向方法的“所有者”，控制器对象）

但是，为什么要使用这种非正统的方式来调用当前控制器的方法。只需设置`scope`成功回调，然后调用 this.finishLogin()。

```
form.submit({
    success : function(form, action) {
        // THIS IS THE FUNCTION FROM THE CURRENT CONTROLLER
        this.finishLogin();
        ...
    },
    scope: this
}); 
```

此外，您可以使用检索另一个控制器实例`Controller#getController`。

```
this.getController('Assessor.controller.quiz').setupAssignment(); 
```

然后，如果您的控制器方法不相互依赖，您可以让它们都监听同一个事件。

另一种解决方案是在登录完成后触发自定义事件。您可以在应用程序对象上执行此操作

```
this.application.fireEvent('logincomplete'); 
```

在你的控制器的 init 方法中：

```
this.application.mon('logincomplete', this.setupAssignment, this); 
```

请注意，您不能通过以下方式收听这些事件`Controller#control`- 请参阅 Alexander Tokarev 的博客文章以获取 Ext 的补丁以实现此目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T03:38:24.243

没有标准的方法来触发控制器之间的事件，但可以通过一些自定义黑客来实现。请参阅我最近[的博客文章](http://nohuhu.org/development/improving-ext-js-mvc-implementation/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-07T08:47:28.620

我也一直在寻找这个，你只需要 Asanda.app.getController('quiz').setupAssignment();，其中 Asanda 是你的应用程序的名称

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-07T12:50:59.680

如果必须在控制器之间发送事件，则应使用 MessageBus：

```
Ext.define('MyApp.utils.MessageBus', {
        extend : 'Ext.util.Observable'
}); 
```

将消息总线存储在全局变量中

```
MsgBus = Ext.create('MyApp.utils.MessageBus'); 
```

您必须在哪里发送事件：

```
MsgBus.fireEvent('eventName',eventArg_1,eventArg_2); 
```

您必须在哪里接收事件：

```
MsgBus.on('eventName', functionHandler,scope); //scope is not mandatory
...
functionHandler:function(eventArg_1,eventArg_2){
...
//do whatever you want
...
} 
```*

# android - Android 网络连接状态

> ID：12065927
> 
> 赞同：1
> 
> 时间：2012-08-22T03:24:24.327
> 
> 标签：android, connection, broadcastreceiver, network-state

我正在尝试使用 BroadcastReceiver 建立这个网络连接。当连接不存在时，它会显示一个警告对话框，告诉用户重试连接。我无法让这部分工作。它说“ `The constructor AlertDialog.Builder(ConnectionDetector) is undefined`”和“ `The method makeText(Context, CharSequence, int) in the type Toast is not applicable for the arguments (ConnectionDetector, String, int)`”。我想我搞砸了我的代码。最后一个问题是如何做一个重试按钮？这里对 Android 来说很新。谢谢

```
 import android.app.AlertDialog;
    import android.content.BroadcastReceiver;
    import android.content.Context;
    import android.content.DialogInterface;
    import android.content.Intent;
    import android.net.ConnectivityManager;
    import android.widget.Toast;

    /**
     * This broadcast receiver is awoken after boot and registers the service that
     * checks for new photos from all the known contacts.
     */

   public class ConnectionDetector extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent) {

    boolean noConnectivity = intent.getBooleanExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,false);

     if(noConnectivity){

             Toast.makeText(context, "Internet Connection Required" , Toast.LENGTH_LONG).show();

             AlertDialog.Builder builder = new AlertDialog.Builder(context);
             builder.setCancelable(true);
            // builder.setIcon(R.drawable.dialog_question);
             builder.setTitle("Title");
             builder.setInverseBackgroundForced(true);
             builder.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
               @Override
               public void onClick(DialogInterface dialog, int which) {
                 dialog.dismiss();
               }
             });
             builder.setNegativeButton("No", new DialogInterface.OnClickListener() {
               @Override
               public void onClick(DialogInterface dialog, int which) {
                 dialog.dismiss();
               }
             });
             AlertDialog alert = builder.create();
             alert.show();

         //System.exit(0);
         //Show Warning Message
         //Close Application the way i suggested
     }

    }

    } 
```

Logcat：应用程序崩溃

```
 08-22 13:56:31.899: E/AndroidRuntime(29026): FATAL EXCEPTION: main
    08-22 13:56:31.899: E/AndroidRuntime(29026): java.lang.RuntimeException: Unable to start receiver com.example.androidhive.ConnectionDetector: android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.app.ActivityThread.handleReceiver(ActivityThread.java:2140)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.app.ActivityThread.access$1500(ActivityThread.java:127)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1211)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.os.Handler.dispatchMessage(Handler.java:99)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.os.Looper.loop(Looper.java:137)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.app.ActivityThread.main(ActivityThread.java:4512)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at java.lang.reflect.Method.invokeNative(Native Method)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at java.lang.reflect.Method.invoke(Method.java:511)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:982)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:749)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at dalvik.system.NativeStart.main(Native Method)
    08-22 13:56:31.899: E/AndroidRuntime(29026): Caused by: android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.view.ViewRootImpl.setView(ViewRootImpl.java:693)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:301)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:215)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.view.WindowManagerImpl$CompatModeWrapper.addView(WindowManagerImpl.java:140)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.app.Dialog.show(Dialog.java:278)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at com.example.androidhive.ConnectionDetector.onReceive(ConnectionDetector.java:52)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    at android.app.ActivityThread.handleReceiver(ActivityThread.java:2133)
    08-22 13:56:31.899: E/AndroidRuntime(29026):    ... 10 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:04:13.077

**这是因为您试图传递错误的上下文**

代替

```
AlertDialog.Builder builder = new AlertDialog.Builder(this); 
```

经过

```
AlertDialog.Builder builder = new AlertDialog.Builder(context); 
```

和

代替

```
Toast.makeText(this, "Internet Connection Required" , Toast.LENGTH_LONG).show(); 
```

经过

```
Toast.makeText(context, "Internet Connection Required" , Toast.LENGTH_LONG).show(); 
```

# jquery - 无法从 ajax 响应 div 中获取值

> ID：12065930
> 
> 赞同：0
> 
> 时间：2012-08-22T03:24:56.530
> 
> 标签：jquery, ajax, django

当我的 ajax 响应成功时，我有以下代码：

```
success : function(response) {
               $('#texto').append(response);
          } 
```

这是我附加的响应html：

```
<body>
{% load custom_filters %}
{% for modulo in modulos %}
<div align="left" class="result" value="{{ modulo.nome }}">
    {{ modulo.nome }} {{ modulo.versao }}.{{ modulo.chave_revisao|soma_um|mascara_versao }}
</div>
{% endfor %} 
```

出现了 div，但是当我要使用它们的值时，我得到一个空字符串。比较是错误的。

```
$('.result').each(function(){
                    for (i=0; i<=vetBuscar.length;i++){
                        if($(this).val() == vetBuscar[i]){
                            return true;
                        } else {
                            vetBuscar.pop(i)
                        }
                    } 
```

任何人都知道我怎样才能得到这个值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T07:43:32.237

我认为问题可能是当您的页面加载时，您正在寻找的元素尚未加载，因此您的选择器尚未绑定到任何东西。这实际上是使用 javascript 加载 html 时的常见问题。

查看 jQuery .on() 事件处理程序，我认为它可能正是您正在寻找的：

[http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:27:13.280

尝试：

```
$(this).attr("value") 
```

代替：

```
$(this).val() 
```

通常 div 没有`value`属性，并且该`.val()`方法适用于具有属性的（表单）元素。

或者您可能喜欢使用 html5`data-`属性并使用：

```
<div align="left" class="result" data-value="{{ modulo.nome }}"> 
```

接着：

```
$(this).attr("data-value") 
```

# mysql - MySQL 在每个唯一值第一次出现时选择行

> ID：12065931
> 
> 赞同：49
> 
> 时间：2012-08-22T03:25:08.210
> 
> 标签：mysql, sql

假设您有下表（此处感兴趣的列是`cid`）：

```
+-----+-------+-------+-------+---------------------+--------------+
| cid | pid   | rid   | clink | time                | snippet      |
+-----+-------+-------+-------+---------------------+--------------+
| 155 | 11222 |  1499 |  1137 | 2012-08-22 03:05:06 | hi           |
| 138 | 11222 |   241 |  1136 | 2012-08-21 05:25:00 | again        |
| 138 | 11222 |   241 |  1135 | 2012-08-21 05:16:40 | hi           |
| 155 | 11222 |  1499 |  1134 | 2012-08-21 05:11:00 | hi cute      |
| 140 | 11222 | 11223 |  1133 | 2012-08-21 05:05:18 | hi           |
| 154 | 11222 |   565 |  1132 | 2012-08-21 05:04:47 | 7            |
| 153 | 11222 |   272 |  1131 | 2012-08-21 05:04:41 | 6            |
| 146 | 11222 |   362 |  1130 | 2012-08-21 05:04:33 | 5            |
| 152 | 11222 |   364 |  1129 | 2012-08-21 05:04:27 | 4            |
| 151 | 11222 |   390 |  1128 | 2012-08-21 05:04:22 | 3            |
| 150 | 11222 |   333 |  1127 | 2012-08-21 05:04:16 | 2            |
| 148 | 11222 |   268 |  1126 | 2012-08-21 05:04:10 | 1            |
| 140 | 11222 | 11223 |  1125 | 2012-08-21 04:59:57 | hi sir       |
| 147 | 11222 |   283 |  1123 | 2012-08-21 03:29:55 | yo           |
| 140 | 11222 | 11223 |  1121 | 2012-08-21 02:12:13 | hello!       |
| 139 | 11222 |   249 |  1120 | 2012-08-21 02:11:53 | hi :)        |
| 140 | 11222 | 11223 |  1119 | 2012-08-21 02:11:26 | hi :)        |
| 140 | 11222 | 11223 |  1118 | 2012-08-21 02:11:08 | hi too       |
| 139 | 11222 |   249 |  1117 | 2012-08-21 02:11:00 | :P           |
| 139 | 11222 |   249 |  1116 | 2012-08-21 02:10:57 | hi           |
| 139 | 11222 |   249 |  1115 | 2012-08-21 02:10:51 | helo         |
| 139 | 11222 |   249 |  1114 | 2012-08-21 02:06:19 | hi           |
| 139 | 11222 |   249 |  1113 | 2012-08-21 02:05:45 | hi baby      |
| 139 | 11222 |   249 |  1112 | 2012-08-21 02:05:00 | hi           |
| 139 | 11222 |   249 |  1111 | 2012-08-21 02:04:41 | hi           |
| 140 | 11222 | 11223 |  1110 | 2012-08-21 02:04:26 | hi           |
| 140 | 11222 | 11223 |  1108 | 2012-08-21 01:47:40 | hey :)       |
| 139 | 11222 |   249 |  1107 | 2012-08-21 01:44:43 | hi           |
| 138 | 11222 |   241 |  1106 | 2012-08-21 01:44:11 | hi           |
| 138 | 11222 |   241 |  1105 | 2012-08-21 01:09:20 | conv 1 msg 1 |
+-----+-------+-------+-------+---------------------+--------------+ 
```

如何仅提取每个的第一次出现`cid`？结果表将是：

```
+-----+-------+-------+-------+---------------------+--------------+
| cid | pid   | rid   | clink | time                | snippet      |
+-----+-------+-------+-------+---------------------+--------------+
| 155 | 11222 |  1499 |  1137 | 2012-08-22 03:05:06 | hi           |
| 138 | 11222 |   241 |  1136 | 2012-08-21 05:25:00 | again        |
| 140 | 11222 | 11223 |  1133 | 2012-08-21 05:05:18 | hi           |
| 154 | 11222 |   565 |  1132 | 2012-08-21 05:04:47 | 7            |
| 153 | 11222 |   272 |  1131 | 2012-08-21 05:04:41 | 6            |
| 146 | 11222 |   362 |  1130 | 2012-08-21 05:04:33 | 5            |
| 152 | 11222 |   364 |  1129 | 2012-08-21 05:04:27 | 4            |
| 151 | 11222 |   390 |  1128 | 2012-08-21 05:04:22 | 3            |
| 150 | 11222 |   333 |  1127 | 2012-08-21 05:04:16 | 2            |
| 148 | 11222 |   268 |  1126 | 2012-08-21 05:04:10 | 1            |
| 147 | 11222 |   283 |  1123 | 2012-08-21 03:29:55 | yo           |
| 140 | 11222 | 11223 |  1121 | 2012-08-21 02:12:13 | hello!       |
| 139 | 11222 |   249 |  1120 | 2012-08-21 02:11:53 | hi :)        |
+-----+-------+-------+-------+---------------------+--------------+ 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-08-22T03:28:50.177

mysql对此有一个“作弊”：

```
select *
from mytable
group by cid; 
```

这就是你所需要的，因为在 mysql 中它允许你*不*聚合非分组列（其他数据库会抛出语法错误），在这种情况下它只输出每个分组值的第一次出现。请注意，尽管这不能保证确定“第一次”出现的*方式*（这将是读取行的方式）

如果您想要*特定*的第一次出现，请先排序，然后应用分组作弊：

```
select *
from (
    -- order by the "time" column descending to get the "most recent" row
    select * from mytable order by time desc
    ) x
group by cid 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-22T03:28:54.957

试试这个，

```
SELECT *
FROM tableName a 
INNER JOIN (
    SELECT cid, MIN(`time`) AS MinTime
    FROM tableName
    GROUP BY cid
) b 
ON a.CID = B.cid AND a.time = b.MinTime 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-09-19T19:51:51.003

在 MySQL 8 中，您将为此使用窗口[函数](https://blog.jooq.org/2013/11/03/probably-the-coolest-sql-feature-window-functions/)

```
SELECT cid, pid, rid, clink, time, snippet
FROM (
  SELECT t.*, ROW_NUMBER() OVER (PARTITION BY cid ORDER BY time) rn
  FROM t
) t
WHERE rn = 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T03:27:08.537

您可以使用过滤连接：

```
select  *
from    (
        select  cid
        ,       min(time) as min_time
        from    YourTable
        group by
                cid
        ) filter
join    YourTable yt
on      filter.cid = yt.cid
        and filter.min_time = yt.time 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-31T09:10:06.487

我知道这是一个旧线程，接受的解决方案只会检索我出现多次的列。

这对我有用：

```
SELECT cid, pid, rid, clink, MAX(time), snippet 
FROM mytable 
GROUP BY cid 
```

# ruby-on-rails - 将图像从 Photoshop Extension 上传到 Rails Server

> ID：12065933
> 
> 赞同：0
> 
> 时间：2012-08-22T03:25:18.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, actionscript-3, flash, apache-flex

我已经苦苦挣扎了 2 天，试图将图像从 Photoshop 扩展上传到 Rails 服务器，并希望能得到一些帮助。

我用来上传图片的代码如下所示：

```
 doc.selection.fill(color);
        var saveOptions:JPEGSaveOptions = new JPEGSaveOptions();
        doc.saveAs(File.applicationStorageDirectory, saveOptions);

        var req:URLRequest;

        var UPLOAD_URL:String = "http://localhost:3000/designs"; 
        var myFile:File = File.applicationStorageDirectory.resolvePath("Untitled-1.jpg");
        var file:FileReference = FileReference(myFile);

        var urlRequest:URLRequest = new URLRequest();
        urlRequest.url = UPLOAD_URL; 
        urlRequest.method = URLRequestMethod.POST;
        urlRequest.contentType = "image/jpeg";
        urlRequest.requestHeaders.push(new URLRequestHeader('Cache-Control', 'no-cache'));
        var params:URLVariables = new URLVariables();
        params['design[option]'] = 'iphone';
        params['design[title]'] = 'title';
        params['design[description]'] = 'description';
        params['design[app_store_url]'] = 'app_store_url';
        params['design[tags]'] = 'tags';
        params['design[temp_number]'] = 1;

        urlRequest.data = params;
        file.upload(urlRequest, "design[image0]"); 
```

像这样输出参数（取自 rails 服务器）：

```
Parameters: {
    "Filename"=>"Untitled-1.jpg", 

    "design"=>{
        "option"=>"iphone", 
        "title"=>"title", 
        "app_store_url"=>"app_store_url", 
        "tags"=>"tags", 
        "temp_number"=>"1", 
        "description"=>"description", 
        "image0"=>#<ActionDispatch::Http::UploadedFile:0x007fa24150c720 
        @original_filename="Untitled-1.jpg", 
        @content_type="application/octet-stream", 
        @headers="Content-Disposition: form-data; 
        name=\"design[image0]\"; 
        filename=\"Untitled-1.jpg\"\r\nContent-Type: application/octet-stream\r\n", 
        @tempfile=#<File:/var/folders/46/5zb4wnk14c9gtw_lfggfrvy40000gn/T/RackMultipart20120821-8131-1of709u>>
    }, 

"Upload"=>"Submit Query"} 
```

它很好地创建了设计并放入了所有参数，除了图像，它仍然是空白的。

我可以看到这些参数和我通常得到的参数之间的唯一区别是内容类型。但这不应该像这样影响它，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T08:01:55.947

我设法做到了。这是后端的错误

# asp.net - ADFS 2.0 和用户创建

> ID：12065936
> 
> 赞同：0
> 
> 时间：2012-08-22T03:25:49.663
> 
> 标签：asp.net, adfs2.0

我想了解 ADFS 中的用户创建过程。从下面的链接我知道我们无法使用 ADFS 创建用户。

[是否可以通过 ADFS 创建新用户？](https://stackoverflow.com/questions/9520252/is-it-possible-to-create-a-new-user-via-adfs)

然后我们如何创建一个用户，例如在 Internet Scenoria 的情况下。我想知道经过验证的做法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T18:55:28.177

您需要某种将用户置备到 AD 中的 Identity Manager。根据上面的链接，您可以添加指向 ADFS 登录页面的链接，以提供此功能以及您需要的任何自助服务功能。

在预配到 AD 方面，请参阅

*   [Howto：（几乎）通过 C# 在 Active Directory 中的所有内容](http://www.codeproject.com/Articles/18102/Howto-Almost-Everything-In-Active-Directory-via-C)
*   [通过 C#.Net 3.5 在 Active Directory 中的所有内容（使用 System.DirectoryServices.AccountManagement）](http://anyrest.wordpress.com/2010/06/28/active-directory-c/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T02:30:01.337

在实践方法 ADFS 中，它的使用如下：

1 用户登录到他们的本地 PC（就像他们通常在早上开始工作时那样）

2 用户需要在合作伙伴公司的外联网网站上获取信息——例如获取定价或产品详细信息

3 用户导航到合作伙伴公司外联网站点 - 例如：[http ://example.com](http://example.com)

4 合作伙伴网站现在不需要输入任何密码 - 而是使用 AD FS 将用户凭据传递到合作伙伴外联网站点

5 用户现在已登录到合作伙伴网站并可以与“登录”的网站进行交互 AD FS 与 Active Directory 域服务集成，**将其用作身份提供者**。AD FS 可以与其他符合 WS-* 和 SAML 2.0 的联合服务作为联合伙伴进行交互。

您可以通过多种方式将用户创建到域中

# javascript - Event.observe() 不工作；ProtoytypeJS 库

> ID：12065938
> 
> 赞同：0
> 
> 时间：2012-08-22T03:26:02.783
> 
> 标签：javascript, html, prototypejs

我有这个代码。

```
<html>
    <head>
        <script src="//ajax.googleapis.com/ajax/libs/prototype/1.7.1.0/prototype.js">    </script>
        <script>
            Event.observe('clickme', 'click', function(event) {
                alert('clicked');
            });

            Event.observe('uploadme', 'change', function(event) {
                alert('hola');
            });

        </script>
    </head>
    <body>
        <form enctype="multipart/form-data" action="insertimage.php" method="post" name="changer">
            <input name="MAX_FILE_SIZE" value="10240000" type="hidden">
            <input id="uploadme"  type="file">
            <input type="button"  id="clickme" value="Upload Stuff!" />
            <input id="sub" type="submit" />
        </form>
    </body>
</html> 
```

这是行不通的。我无法对任何事情保持警惕。任何人都可以提出解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T05:51:40.827

**尝试在正文**结束标记上方添加脚本，例如：

```
</head>
<body>
<form enctype="multipart/form-data" action="insertimage.php" method="post" name="changer">
<input name="MAX_FILE_SIZE" value="10240000" type="hidden">
<input id="uploadme"  type="file">
<input type="button"  id="clickme" value="Upload Stuff!" />
<input id="sub" type="submit" />
</form>
<script>
Event.observe('clickme', 'click', function(event) {
    alert('clicked');
});
Event.observe('uploadme', 'change', function(event) {
    alert('hola');
});
</script>
</body> 
```

演示：[jsFiddle](http://jsfiddle.net/ZU5dF/1/)

或者，如果您想将**脚本**标签保留在**head**中，其他选项是：

```
Event.observe(window, 'load', function() {
    Event.observe('clickme', 'click', function(event) {
        alert('clicked');
    });
    Event.observe('uploadme', 'change', function(event) {
        alert('hola');
    });
}); 
```

# jquery - 拖动div时移动线连接div

> ID：12065942
> 
> 赞同：0
> 
> 时间：2012-08-22T03:26:34.403
> 
> 标签：jquery, html, jquery-ui, canvas, drag-and-drop

我目前在此处绘制了这些线来连接这些 div 标签：http: [//sandbox.brightboxstudios.com/orgmap/index2.html](http://sandbox.brightboxstudios.com/orgmap/index2.html)

但是，当 div 被拖动时，线条不跟随..

如何保持线路连接？谢谢！！

找到资源但不确定如何实现： [http ://docs.jquery.com/UI/Draggable#event-drag](http://docs.jquery.com/UI/Draggable#event-drag)

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:11:43.193

为您的可拖动调用添加一个 updateCanvas 回调，如下所示：

```
$(document).ready(function() {
    $(".blk").draggable(
        {drag: function() {updateCanvas($("#canvas"), $(".blk"));}}   
    );
}); 
```

# c# - 如何在 C# 中创建一个用于显示矩形的好面板？

> ID：12065943
> 
> 赞同：1
> 
> 时间：2012-08-22T03:26:59.543
> 
> 标签：c#, wpf

我不太擅长 C#，但请耐心等待，我正在尝试创建一个可以编辑小尺寸（16x16、32x32 等）图片的程序，特别是 Minecraft 纹理文件。我需要创建一个可以在其上显示矩形的绘图表面。我想使用 WPF 矩形，因为到目前为止它们对我有用。我尝试将它们放在 WPF Grid 面板上，但创建一个具有 1 像素宽的行和列的大小合适的网格面板大约需要 30 秒，而且时间相当长。任何想法都是有帮助的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:40:06.200

我建议使用更轻量级的东西，例如[`DrawingVisuals`](http://msdn.microsoft.com/en-us/library/ms742254.aspx). 或者，如果您真的只想显示纹理，您可以对它们进行预处理并将结果显示为 normal `Image`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T07:56:39.810

我觉得你的方向可能不是最有效的。当然，将图像转换成很多矩形是完全可能的，但是一旦你有很多像素，它就真的没有效率了。（32x32 = 1024 个矩形。）

因此，与其像您想要的那样与 WPF 矩形一起使用，我会敦促您重新考虑。相反，请尝试使用[WriteableBitmap](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap%28v=vs.110%29.aspx)。

根据您模糊的描述，我假设您正在编写一个类似绘画的程序，用户可以在其中选择一种颜色并用鼠标在具有该颜色的纹理上绘制。通过将 WriteableBitmap 绑定到 Image 标签，并为 MouseMove 事件添加事件侦听器，您可以获得鼠标位置，以及是否按下鼠标左键/右键。将其与一些涉及图像的 x 位置和 ActualWidth 以及 y 位置和 ActualHeight 的数学相结合，您可以找到鼠标所在的像素，并设置该像素的颜色。

所以基本上，矩形不是你最好的选择。特别是如果您尝试制作一个 32x32 的网格来包含它们。使用可写位图。

# android - 如何从android中的url解析xml？

> ID：12065951
> 
> 赞同：14
> 
> 时间：2012-08-22T03:28:03.233
> 
> 标签：android, url, xml-parsing

我目前正在使用已从那里下载并解析的 xml。我想直接从 url 本身做。我怎样才能做到这一点？

我在下面添加了我正在使用的代码段。请帮助提供一个片段或示例。谢谢。

```
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
DocumentBuilder builder = factory.newDocumentBuilder();
File file = new File(this.getFilesDir(), FILE_EXTRACTED);
Document dom = builder.parse(file);
Element root = dom.getDocumentElement();
root.normalize(); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-22T04:43:37.830

使用以下代码从 android 中的 url 解析 xml

```
public class XMLParsingDOMExample extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /** Create a new layout to display the view */
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(1);

        /** Create a new textview array to display the results */
        TextView name[];
        TextView website[];
        TextView category[];

        try {

            URL url = new URL("http://www.androidpeople.com/wp-content/uploads/2010/06/example.xml");
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse(new InputSource(url.openStream()));
            doc.getDocumentElement().normalize();

            NodeList nodeList = doc.getElementsByTagName("item");

            /** Assign textview array lenght by arraylist size */
            name = new TextView[nodeList.getLength()];
            website = new TextView[nodeList.getLength()];
            category = new TextView[nodeList.getLength()];

            for (int i = 0; i < nodeList.getLength(); i++) {

                Node node = nodeList.item(i);

                name[i] = new TextView(this);
                website[i] = new TextView(this);
                category[i] = new TextView(this);

                Element fstElmnt = (Element) node;
                NodeList nameList = fstElmnt.getElementsByTagName("name");
                Element nameElement = (Element) nameList.item(0);
                nameList = nameElement.getChildNodes();
                name[i].setText("Name = " + ((Node) nameList.item(0)).getNodeValue());

                NodeList websiteList = fstElmnt.getElementsByTagName("website");
                Element websiteElement = (Element) websiteList.item(0);
                websiteList = websiteElement.getChildNodes();
                website[i].setText("Website = " + ((Node) websiteList.item(0)).getNodeValue());

                category[i].setText("Website Category = " + websiteElement.getAttribute("category"));

                layout.addView(name[i]);
                layout.addView(website[i]);
                layout.addView(category[i]);
            }
        } catch (Exception e) {
            System.out.println("XML Pasing Excpetion = " + e);
        }

        /** Set the layout view to display */
        setContentView(layout);

    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-05-12T09:08:08.800

我的解决方案使用已接受答案中的代码，但是我发现如果不使用 AsyncTask 它将无法工作

这是我的代码，首先我检索 XML 并在使用 AsyncTask 的方法中解析它

```
public class RetrieveFeed extends AsyncTask {

URL url;
ArrayList<String> headlines = new ArrayList();
ArrayList<String> links = new ArrayList();
@Override
protected Object doInBackground(Object[] objects) {
    // Initializing instance variables

    try {
        url = new URL("http://feeds.bbci.co.uk/news/rss.xml?edition=uk");

        XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
        factory.setNamespaceAware(false);
        XmlPullParser xpp = factory.newPullParser();

        // We will get the XML from an input stream
        xpp.setInput(getInputStream(url), "UTF_8");

        /* We will parse the XML content looking for the "<title>" tag which appears inside the "<item>" tag.
         * However, we should take in consideration that the rss feed name also is enclosed in a "<title>" tag.
         * As we know, every feed begins with these lines: "<channel><title>Feed_Name</title>...."
         * so we should skip the "<title>" tag which is a child of "<channel>" tag,
         * and take in consideration only "<title>" tag which is a child of "<item>"
         *
         * In order to achieve this, we will make use of a boolean variable.
         */
        boolean insideItem = false;

        // Returns the type of current event: START_TAG, END_TAG, etc..
        int eventType = xpp.getEventType();
        while (eventType != XmlPullParser.END_DOCUMENT) {
            if (eventType == XmlPullParser.START_TAG) {

                if (xpp.getName().equalsIgnoreCase("item")) {
                    insideItem = true;
                } else if (xpp.getName().equalsIgnoreCase("title")) {
                    if (insideItem)
                        headlines.add(xpp.nextText()); //extract the headline
                } else if (xpp.getName().equalsIgnoreCase("link")) {
                    if (insideItem)
                        links.add(xpp.nextText()); //extract the link of article
                }
            } else if (eventType == XmlPullParser.END_TAG && xpp.getName().equalsIgnoreCase("item")) {
                insideItem = false;
            }

            eventType = xpp.next(); //move to next element
        }

    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (XmlPullParserException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

return headlines;
}

    public InputStream getInputStream(URL url) {
        try {
            return url.openConnection().getInputStream();
        } catch (IOException e) {
            return null;
        }
    }

public ArrayList<String> heads()
{
    return headlines;
}
} 
```

然后在主要活动中：

```
public class MainActivity extends ListActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ArrayList<String> headlines = new ArrayList<>();

    RetrieveFeed getXML = new RetrieveFeed();
    getXML.execute();
    headlines = getXML.heads();

    // Binding data
    ArrayAdapter adapter = new ArrayAdapter(this,
            android.R.layout.simple_list_item_1, headlines);

    setListAdapter(adapter);

}
} 
```

确保您在清单中具有正确的使用权限，将其放在应用程序标签内但在任何活动标签之外

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

最后，在扩展 ListActivity 时，您需要确保在主布局 xml 中有一个 ListView，其 id 为：

```
android:id="@android:id/list" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-22T03:40:02.620

使用此代码。

```
public class XMLResourceDemo extends ListActivity {

private final static String TAG = XMLResourceDemo.class.getSimpleName();
TextView selection;
ArrayList<String> items = new ArrayList<String>();

@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.main);
    selection = (TextView) findViewById(R.id.selection);

    try {
        XmlPullParserFactory factory = XmlPullParserFactory.newInstance();       
        factory.setNamespaceAware(true);
        XmlPullParser xpp = factory.newPullParser(); 
        xpp.setInput(new InputStreamReader(
            getUrlData("url")));

        while (xpp.getEventType() != XmlPullParser.END_DOCUMENT) {
            Log.i(TAG, "doc started");
            if (xpp.getEventType() == XmlPullParser.START_TAG) {
                if (xpp.getName().equals("entry")) {
                    items.add(xpp.getAttributeValue(0));
                }
            }
            xpp.next();
        }
    } catch (Throwable t) {
        Toast.makeText(this, "Request failed: " + t.toString(),
                Toast.LENGTH_LONG).show();
    }

    setListAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, items));
}

public InputStream getUrlData(String url) throws URISyntaxException, ClientProtocolException, IOException {

    DefaultHttpClient client = new DefaultHttpClient();
    HttpGet method = new HttpGet(new URI(url));
    HttpResponse res = client.execute(method);
    return res.getEntity().getContent();
} 
```

# java - 通过 HTTPURLConnection 发送 cookie

> ID：12065953
> 
> 赞同：3
> 
> 时间：2012-08-22T03:28:10.130
> 
> 标签：java, jsp, servlets, cookies, response

我正在尝试使用 HTTPURLConnection 类打开与 JSP 的连接并接收来自 servlet 的响应。在 JSP 中设置了需要在 servlet 中读取的响应标头。

代码示例如下

```
String strURL = "http://<host>:<port>/<context>/mypage.jsp";
String sCookies = getCookie();//method to get the authentication cookie(**SSOAUTH**) and its value for the current logged in user

URL url = new URL(strURL);
HttpURLConnection urlConnection = (HttpURLConnection)url.openConnection();
urlConnection.setRequestProperty("Cookie", URLEncoder.encode(sCookies, "UTF-8"));
urlConnection.setRequestMethod("POST");
urlConnection.setDoInput(true);
urlConnection.setDoOutput(true);

DataOutputStream out = new DataOutputStream(urlConnection.getOutputStream());
out.writeBytes("lang=en");
out.flush();
out.close();

 //reading the response received from JSP and retrieve header value
response.write(urlConnection.getHeaderField("commAuth") + "<br />"); 
```

问题是传递的**SSOAUTH** cookie 没有发送到 JSP。如果我如下发送 UID/PWD 而不是 cookie，则身份验证成功并且响应正确发送。

```
urlConnection.setRequestProperty("username", "testuser");
urlConnection.setRequestProperty("password", "testpwd"); 
```

这是通过 HTTPURLConnection 发送 cookie 的正确方法吗？还是需要设置其他参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:45:44.163

您可能想尝试从整个 sCookies 字符串中删除 URLEncoder.encode。cookie 格式应采用 NAME=VALUE 的形式，但通过 URLEncoding 整个字符串，您将转义 =。

# scala - WriterT 可以做协方差吗？WriterT[F[_], W, A] 可以用 +A 来声明吗？

> ID：12065954
> 
> 赞同：1
> 
> 时间：2012-08-22T03:28:12.033
> 
> 标签：scala, covariance, scalaz

我有如下代码：

```
type StringValidation[+A] = Validation[String, A]
type WriterValidation[A] = WriterT[StringValidation, String, A]
type Result[A] = WriterValidation[A]

private def someResult: Result[Int]
def implementTrait: Result[Any] = someResult    // type mismatch 
```

它给出了 type mismatch, found `Result[Int]`, required `Result[Any]`，但是如果我将其更改为：

```
type WriterValidation[+A] = WriterT[StringValidation, String, A] 
```

它给出“协变类型 A 出现在 WriterT 中的不变位置......”

在我看来，操作在概念上应该没问题，`Validation`可以是协方差，为什么`WriterT`不能（或不）decared `WriterT[F[_], W, +A]`（或什至`+W`）？

我正在使用 scalaz7 快照，但我看到 6.0.4 中 WriterT 的声明是相同的。

* * *

解决了。
原来是我用错了版本，我用的是`"org.scalaz" %% "scalaz-core" % "7.0-SNAPSHOT"`，换了`"org.scalaz" % "scalaz-core_2.9.2" % "7.0.0-M2"`就ok了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T04:05:47.350

不确定您的情况，但 scalaz-7 树（以及 M2 版本）具有[协变类型 args](http://github.com/scalaz/scalaz/blob/scalaz-seven/core/src/main/scala/scalaz/WriterT.scala)。

```
 sealed trait WriterT[F[+_], +W, +A] { ... 
```

还有以下作品：

```
 scala> type SV[+A] = Validation[String, A]
defined type alias SV

scala> type WV[+A] = WriterT[SV, String, A]
defined type alias WV

scala> type Result[+A] = WV[A]
defined type alias Result

scala> def someResult: Result[Int] = ???
someResult: Result[Int]

scala> def implementTrait: Result[Any] = someResult
implementTrait: Result[Any] 
```

# java - 聊天应用部署

> ID：12065958
> 
> 赞同：0
> 
> 时间：2012-08-22T03:28:59.980
> 
> 标签：java, deployment, applet, installation, chat

我创建了一个示例聊天应用程序。在那个聊天应用程序中，我使用了 JApplet 和前端。

直到现在我还在我的桌面上测试我的应用程序。它工作正常。现在我想在任何网络服务器上部署我的应用程序。

现在我有几个问题。目前我在聊天服务器中使用服务器套接字作为 8989。当我在桌面上测试应用程序时，我曾经单独启动服务器。

1.  在 tomcat 或任何其他 Web 服务器上部署应用程序时，我必须遵循哪些步骤？客户端会监听哪个端口？
2.  如何启动我的聊天服务器？我是套接字概念的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T04:02:19.280

当您说您在网络服务器上托管时，我相信它是一个基于 servlet/jsp 的应用程序，它将侦听您的请求，在这种情况下，侦听器将在网络服务器默认端口 80 / 8080（默认）处被调用。如果您想更改或检查，您可以转到 TOMCAT_INSTALLATION_DIR/conf/server.xml 并检查包含 weblistener 端口号的标记，并将其更改为您喜欢的任何值。

如果情况并非如此，并且您有自己的线程为您打开一个套接字，那么您真的不需要网络服务器，您只需要一台主机，它将启动套接字侦听器（您的自定义），然后它将在端口侦听您已将其配置为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T05:16:56.887

据我所知，您拥有独立的应用程序作为服务器，您可以在其中处理与特定端口的连接。

我认为有一些混乱需要澄清。

最基本的问题是：
**为什么需要在 Web 服务器上运行聊天服务器？**

在任何后续步骤之前，您都应该清楚这一点。
因为 web 服务器基本上是用来处理 HTTP/S 请求的，而这不是你的情况，据我所知。因为您可能正在运行套接字 TCP/UDP 通信。

但是，对于 Web 服务器，您的客户端小程序实现可能会受益。如果它是在一个简单的 html 页面上引用（部署在战争中），它可以简单地通过 Web 浏览器中的 url 调用重新分发给客户端。

也许我更喜欢使用 HTTP + JSON 通信，在那里您可以从 Web 服务器的使用中受益（也在服务器端）并且不需要任何其他端口而不是标准端口。

不确定回答您的问题是否仍然有意义，因为它可能与您无关，但让我们看看。

回答您的问题：

*   基本上，您需要战争档案（而不是 jar 档案），因为这是 Web 服务器接受的档案。创建后（您需要遵循正确的文件夹/文件结构），您的应用程序就可以部署到 Web 服务器。

客户端会监听哪个端口？基本上服务器是这里的监听器=>这里没有客户端端口监听。

*   这取决于您的通信实施决策。如果仍然坚持使用 TCP/UDP 之一，我认为 Web 服务器在这里没有用处。

# batch-file - 返回具有特定卷名的 USB 驱动器号的批处理

> ID：12065959
> 
> 赞同：0
> 
> 时间：2012-08-22T03:29:01.120
> 
> 标签：batch-file

我对批处理没有太多经验，需要批处理脚本的帮助。任务是，将驱动器号作为参数返回给 %disk_letter%

想法是用它来搜索：

WMIC LogicalDisk 其中 VolumeName='MY_USB' 获取 /Format:list | 查找“标题=”

结果是“Caption = G：”。我需要 %disk_leter% 参数等于 "G:" 需要帮助来完成这个脚本。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T03:53:38.047

现在在 Linux 上，但这是我认为你需要做的。第 1 部分：将`FIND`命令结果保存到变量中，第 2 部分：获取变量的子字符串。第二部分很简单，所以我将从它开始（假设在第一步中你命名了你的变量`var`

```
@echo %var:~-2% 
```

这大约是我对批量感到满意的程度，所以接下来的一点是拼凑在一起的：

要将查找结果存储为变量，请尝试将代码修改为：

```
set cmd="WMIC LogicalDisk Where VolumeName='MY_USB' Get /Format:list | FIND "Caption=" "

FOR /F %%i IN (' %cmd% ') DO SET var=%%i 
```

然后（记住上面）输出它：

```
@echo %var:~-2% 
```

我正在拼凑第二部分的相关问题是[这个问题](https://stackoverflow.com/questions/1427218/how-to-store-the-result-of-a-command-expression-in-a-variable-using-bat-scripts)，所以如果这不能按预期工作，我会先跳到那个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T22:24:05.280

开始...

```
@echo off

for /F "usebackq tokens=1,2,3,4 " %%i in (`wmic logicaldisk get caption^,description^,drivetype 

2^>NUL`) do (

if %%l equ 2 (
echo %%i is a USB drive.
)
) 
```

# jquery - jquery手风琴自定义导航

> ID：12065964
> 
> 赞同：0
> 
> 时间：2012-08-22T03:29:48.177
> 
> 标签：jquery, jquery-ui, accordion

我需要为 jquery 手风琴创建一个全部展开并折叠所有导航。

我让每个手风琴都能正常工作：

```
$('.accordion h3').click(function() {
        $(this).next().toggle('slow');
        return false;
    }).next().hide();

<div class="accordion">
<h3 class="head"><a href="#">Section 1</a></h3>
<div>
    <p>
    Mauris mauris ante, blandit et, ultrices a, suscipit eget, quam. Integer
    ut neque. Vivamus nisi metus, molestie vel, gravida in, condimentum sit
    amet, nunc. Nam a nibh. Donec suscipit eros. Nam mi. Proin viverra leo ut
    odio. Curabitur malesuada. Vestibulum a velit eu ante scelerisque vulputate.
    </p>
</div> 
```

```
<div class="accordion">
    <h3><a href="#">Section 2</a></h3>
    <div>
        <p>
        Sed non urna. Donec et ante. Phasellus eu ligula. Vestibulum sit amet
        purus. Vivamus hendrerit, dolor at aliquet laoreet, mauris turpis porttitor
        velit, faucibus interdum tellus libero ac justo. Vivamus non quam. In
        suscipit faucibus urna.
        </p>
    </div>
</div> 
```

ETC.....

我需要为全部展开做这样的事情，而对全部折叠做相反的事情：

```
$('#nav .expand').click(function(){
    $('.accordion h3').next().animate({
            height: "auto"
        });
        return false;
}); 
```

对 jquery 来说还是新手，所以不知道它所提供的一切。有人可以指出我正在尝试做的事情的正确方向。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:45:20.620

您似乎没有使用 jQuery ui Accordion。

这是一个小提琴`$.accordion()`：http: [//jsfiddle.net/C3Gra/1/](http://jsfiddle.net/C3Gra/1/)

没有小提琴：http `$.accordion()`: [//jsfiddle.net/w2uXZ/](http://jsfiddle.net/w2uXZ/)

编辑：`$.accordion()`扩展 all 并不能很好地发挥作用，因为它的内部状态最多可以容纳一个活动元素。

# embedded - 错误：从平台构建器下载引导映像 (Windows Embedded Compact 7)

> ID：12065970
> 
> 赞同：1
> 
> 时间：2012-08-22T03:30:50.377
> 
> 标签：embedded, windows-virtual-pc

为什么我的 windows 虚拟 PC 设备正在发送 BOOTME 消息，但我的平台构建器仍在等待来自设备的下载请求？有什么我需要配置的吗？请看下图。

![在此处输入图像描述](../Images/0a9c50209c0aac59917fcc87001e9ef3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T11:58:05.760

发现问题... BOOTME 消息被我的 Windows FireWwll 阻止。解决问题的最简单方法是禁用防火墙或创建“允许”规则。

# ios - 使用 arm-apple-darwin10-llvm-gcc-4.2 在 MacOS 上交叉编译问题

> ID：12065971
> 
> 赞同：0
> 
> 时间：2012-08-22T03:30:58.723
> 
> 标签：ios, xcode4.2, cross-compiling

我正在遵循教科书中的基本“Hello World”示例，其目的是在 MacOS 上使用 Xcode 创建和交叉编译一个简单的*命令行*程序，然后在越狱的 iPad 上运行它。我在 MacOS 10.6.8 上使用 Xcode 4.2 安装的 arm-apple-darwin10-llvm-gcc-4.2 交叉编译器。示例代码是：

```
#include <stdio.h>

main ( ) {
printf("Hello, World!");
} 
```

我正在尝试的编译是这样的：

```
/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/arm-apple-darwin10-llvm-gcc-4.2 -o hello hello.c -isysroot /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk 
```

这会在使用 file 命令显示时生成一个对象：

```
$ file hello
hello: Mach-O executable arm 
```

好的。到目前为止，一切都很好。我应该可以将它复制到我的 iPad 并使用 ldid。

但是它失败了：

```
MyiPad: /Applications root# ldid -S hello
codesign_allocate: object: hello malformed object (unknown load command 8)
util/ldid.cpp(582): _assert(78:WEXITSTATUS(status) == 0) 
```

此外，如果我在 MacOS 上运行字符串，它会显示相同的错误。

```
$ strings hello
strings: object: hello malformed object (unknown load command 8) 
```

我认为 Xcode 的配置或设置有问题。或者我还没有喝足够的咖啡。但这是一个教科书的例子，很明显我在我的设置中遗漏了一些东西。[我还尝试根据iOS 5.1 和 iPad 3 中的 Xcode 4.2 和视网膜](https://stackoverflow.com/questions/9611596/ios-5-1-with-xcode-4-2-and-retina-in-ipad-3)设置 iPhoneOS5.1.sdk 和平台、sdk 和 Sim 目录

任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T18:05:37.717

是的。我可以回答我自己的问题……或者至少大部分。

首先，MacOS 上的 strings 命令是一条红鲱鱼。我认为这告诉我二进制文件有问题。但我可以在上面使用 otools 和 nm。所以，忽略字符串。除非有人想回答这个难题，否则我不会担心。它仍然很好奇。

所以从根本上说，ldid 是Patrick Toomey解释[的问题。](http://labs.neohapsis.com/2012/01/)短篇小说，ldid 使用 codesign_allocate 似乎不支持 arm-apple 交叉编译器正在添加的加载命令。

我的解决方案是使用钥匙串访问在 MacOS 上创建我自己的自签名证书，并使用 /usr/bin/codesign 对二进制文件进行签名。

详细信息： $ export CODESIGN_ALLOCATE=/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/codesign_allocate $ codesign -fs "certname" 程序名

将其复制到 iPad 上并*运行*它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T18:13:06.057

不要创建自己的证书，而是查看 ldid：http: [//iphonedevwiki.net/index.php/Theos/Getting_Started](http://iphonedevwiki.net/index.php/Theos/Getting_Started)

只需`ldid -S binary`在您的主机上运行（在从源代码构建它或从 Dropbox 下载它之后），它就会在越狱的 iOS 5.1 上运行。

# facebook - Facebook Auth Dialog 未请求用户的电子邮件权限

> ID：12065980
> 
> 赞同：3
> 
> 时间：2012-08-22T03:32:22.287
> 
> 标签：facebook, facebook-oauth

我将电子邮件权限添加到我的身份验证对话框的“用户和朋友权限”中。

不幸的是，当我的用户授权我的应用程序时，它没有请求此权限。

身份验证对话框只是请求基本信息。

有趣的是，当我预览身份验证对话框时，它显示它正在请求电子邮件权限。

还有其他人有这个问题吗？

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T03:56:39.723

您需要`email`像在第二个示例中所做的那样传递一个范围：http: [//developers.facebook.com/docs/reference/javascript/FB.login/](http://developers.facebook.com/docs/reference/javascript/FB.login/)

```
 FB.login(function(response) {
   // handle the response
 }, {scope: 'email'}); 
```

# javascript - 未分配 Javascript 值

> ID：12065983
> 
> 赞同：-1
> 
> 时间：2012-08-22T03:32:54.993
> 
> 标签：javascript, jquery, ajax, post

我在获取为 等分配的值时遇到问题`fname`，`lname`这些在页面上不存在，直到调用成功函数并将其发布到`template/orderForm.php`. 例如，如果`console.log(fname)`我得到一个空字段。

发生的第一件事是在登录按钮提交时，它通过 phpscripts/login.php 检查数据库信息，成功后它发布到另一个页面以获取表单数据，例如他们的姓名等，这些数据会自动填充php回声。

```
$("#loginSubmit").click(function() {
  var username = $("#username").val();
  var password = $("#password").val();
  $.ajax({
    type: "POST",
    url: "phpscripts/login.php",
    dataType: 'text',
    data: {
      username: username,
      password: password
    },
    success: function(data){
      if(data == 'worked') {
        $("#loginForm").hide(500);
        $("#loginBtn").hide(500);
        $("#registerBtn").hide(500);
        $("#forgotPasswordBtn").hide(500);
        $.post('template/orderForm.php', function(data) {
          $('#approveData').html(data);
          $("#updateInfo").click(function() {
            var fname = $('#fname').attr('value');
            var lname = $('#lname').attr('value');
            var address = $('#address').attr('value');
            var city = $('#city').attr('value');
            var state = $('#state').attr('value');
            var zip = $('#zip').attr('value');
            var phone = $('#phone').attr('value');
            console.log(fname);
            $.ajax({
              type: "POST",
              //change to update script that is in myaccount.php
              url: "phpscripts/update.php",
              data: {
                fname: fname,
                lname: lname,
                address: address,
                city: city,
                state: state,
                zip: zip,
                phone: phone
              },
              success: function(){
                //do nothing
              }

            });
          });
        });

      }
      else {

      }
    }

  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T03:38:23.847

尝试`$('#fname').val()`代替`$('#fname').attr('value')`，和其他人一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T03:48:48.340

我不知道您的 HTML 发生了什么，所以这是我的猜测：

这一行：

```
$('#approveData').html(data); 
```

包含您的 html，其中包含 id 为 fname 的元素。

这个js：

```
$("#updateInfo").click(function() { ... }); 
```

应该是这样的：

```
$("#updateInfo").live('click', function() { ... }); 
```

并在外面准备好声明或其他东西。未在另一个侦听器的结果中定义。

这个链接解释了.live： [http ://api.jquery.com/live/](http://api.jquery.com/live/)

它注册新插入的 dom 元素，作为您提供的基本侦听器，如果 fname 元素是由您的请求写入的 - 假设，所以如果我在这里错了，请不要大喊大叫。

# erlang - 在服务器 ping 客户端之前，Erlang 客户端无法 ping 服务器

> ID：12065984
> 
> 赞同：1
> 
> 时间：2012-08-22T03:33:02.187
> 
> 标签：erlang, firewall, ping

**问题**

我有两个 Erlang 节点，两台计算机各一个。我使用唯一的 sname 和相同的 cookie 启动每个节点。当我尝试从客户端到服务器的 net_adm:ping/1 时，它总是超时，*除非*我首先从服务器 ping 到客户端。

例如，在客户端：

```
(client@client_machine)1> net_adm:ping(server@server_machine).
pang 
```

然后在服务器上：

```
(server@server_machine)1> net_adm:ping(client@client_machine).
pong 
```

*然后*再次从客户端：

```
(client@client_machine)2> net_adm:ping(server@server_machine).
pong 
```

我已经允许 erl.exe 和 werl.exe 通过防火墙，用于两台机器上的所有入站和出站连接。我无法使用 -name ping 任一方向；我必须使用-sname。

**问题**

这仍然是防火墙问题还是已知行为？如果是已知问题，解决方法是什么？服务器是否定期尝试 ping 任何可能的客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T05:54:15.220

首先，如果你从 ping （通常`ping`不是 erlang ping）`server_machine`，`client_machine`你得到了`is alive`吗？通常，当节点不在同一台计算机/服务器上时，您需要使用`-name`and NOT`-sname` 选项。

如果两台机器可以正常看到对方`ping`，则尝试使用`IP Adresses`机器的 启动节点。可以说，`client_machine = 192.168.100.2`虽然`server_machine = 192.168.100.5`，节点应该像这样启动：

```
# erl -name client@192.168.100.2 -setcookie mycookie

```

```
# erl -name server@192.168.100.5 -setcookie mycookie

```

然后做`erlang ping`，看看会发生什么。另外，由于您使用的是`Resolvable names`ie `client_machine`，如果您在使用，则`UNIX / LINUX`需要添加 IP 地址和机器的名称，`/etc/hosts`或者至少使两台机器使用相同的 DNS 服务器，这可以解析这些名称。另外，当您阅读[`net_adm`](http://www.erlang.org/doc/man/net_adm.html)erlang 的文档时，您会发现[erlang 也有 等价物`/etc/hosts`](http://www.erlang.org/doc/man/net_adm.html#host_file-0) 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T02:23:57.077

After double-checking everything I figured it out: I had firewall rules on the server to allow C:\Program Files\erl5.9.1\bin\erl.exe but was running C:\Program Files\erl5.9.1\**erts-5.9.1**\bin\erl.exe.

I feel stupid for missing something like that but figured I'd better own up to it so somebody else can benefit from this :/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T05:35:00.080

“client_machine”和“server_machine”都可以解析吗？`ping server_machine`你可以从命令行检查它。

因为您在同一个物理实例上执行此操作，并且每个虚拟节点具有不同的 sname，所以它们都应该是可访问的，例如，两者都在 /etc/hosts 中有记录（windows/system32/drivers/etc/hosts 在 Windows 案例中）

# asp.net-mvc-3 - jqGrid：布局坏了？

> ID：12065986
> 
> 赞同：0
> 
> 时间：2012-08-22T03:33:21.580
> 
> 标签：asp.net-mvc-3, jqgrid

我在对话框中使用 jqgrid，但看起来布局已损坏：

1.  底部网格的搜索按钮出现两次？
2.  字体太大。

当我将网格显示为普通视图时，没有问题。

index.cshtml 打开弹出窗口：

```
<div id="btnGo">
    <img id="UserProfileLookUp" src="../../Content/images/ui-flag_blue.png" />
</div>
<script>
    $(document).ready(function () {
        $('#btnGo').click(function () {
            $("#Dialog").dialog("open");
        });
        $("#Dialog").dialog({
            modal: true,
            autoOpen: false,
            height: 413,
            width: 626
        });
    }); 
</script>
<div id="Dialog" title="Product Select" style="display: none;">
    @{Html.RenderAction("Test", "Home");}
</div> 
```

实际的jqgrid：

```
<link href="@Url.Content("~/Content/site.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Content/jqGrid/jquery-ui-jqgrid.css")" rel="stylesheet" type="text/css" />
@{ ViewBag.Title = "jqGrid in ASP.NET MVC - Searching [Advanced]"; }
<table id="jqgProducts" cellpadding="0" cellspacing="0">
</table>
<div id="jqgpProducts" style="text-align: center;">
</div>
<div id="dlgSupplier">
</div>
<script id="tmplSupplier" type="text/x-jquery-tmpl">
        ${CompanyName}<br /><br />
        ${Address}<br />
        ${PostalCode}, ${City}<br />
        ${Country}<br /><br />
        ${Phone}<br />
        ${HomePage}
</script>
<script type="text/javascript">
        $(document).ready(function () {

            $('#jqgProducts').jqGrid({
                //url from wich data should be requested
                url: '@Url.Action("Products")',
                //type of data
                datatype: 'json',
                //url access method type
                mtype: 'POST',
                //columns names
                colNames: ['ProductID', 'ProductName', 'Supplier', 'Category', 'QuantityPerUnit', 'UnitPrice', 'UnitsInStock'],
                //columns model
                colModel: [
                            { name: 'ProductID', index: 'ProductID', align: 'left', search: true, stype: 'text', searchoptions: { sopt: ['eq', 'ne'] } },
                            { name: 'ProductName', index: 'ProductName', align: 'left', search: true, stype: 'text', searchoptions: { sopt: ['eq', 'ne', 'bw', 'bn', 'ew', 'en', 'cn','nc']} },
                            { name: 'Supplier', index: 'SupplierID', align: 'left',  search: true, stype: 'select', searchoptions: { sopt: ['eq', 'ne'], dataUrl: '@Url.Action("Suppliers")' } },
                            { name: 'Category', index: 'CategoryID', align: 'left', search: true, stype: 'select', searchoptions: { sopt: ['eq', 'ne'], dataUrl: '@Url.Action("Categories")' } },
                            { name: 'QuantityPerUnit', index: 'QuantityPerUnit', align: 'left', search: false },
                            { name: 'UnitPrice', index: 'UnitPrice', align: 'left', formatter: 'currency', formatoptions: { decimalSeparator: '.', thousandsSeparator: ',', decimalPlaces: 2, prefix: '$' }, search: false },
                            { name: 'UnitsInStock', index: 'UnitsInStock', align: 'left', search: false }
                          ],
                //pager for grid
                pager: $('#jqgpProducts'),
                //number of rows per page
                rowNum: 5,
                //initial sorting column
                sortname: 'ProductID',
                //initial sorting direction
                sortorder: 'asc',
                //we want to display total records count
                viewrecords: true,
                //grid height
                height: '100%'
            });
            $('#jqgProducts').jqGrid('navGrid', '#jqgpProducts', { edit: false, add: false, del: false, search: false }).jqGrid('navButtonAdd', '#jqgpProducts', {
                caption: 'Search',
                buttonicon: 'ui-icon-search',
                onClickButton: function() {
                    $('#jqgProducts').jqGrid('searchGrid', { multipleSearch: true });
                },
                position: 'last',
                title: 'Search'
            });
            $('#dlgSupplier').dialog({ autoOpen: false, bgiframe: true, resizable: false, title: 'Supplier' });
            $('a[data-supplier-id]').live('click', function (e) {
                if (e.preventDefault)
                    e.preventDefault();
                else
                    e.returnValue = false;

                var dialogPosition = $(this).offset();

                $.post('@Url.Action("Edit")', { id: $(this).attr('data-supplier-id') }, function(data) {

                });
            });
        });

</script> 
```

控制器：

```
public ActionResult Index()
{
   return View();
}

public ActionResult Test()
{
  return PartialView();
} 
```

# java - 将图像（png）转换为字符串，然后加密图像

> ID：12065987
> 
> 赞同：3
> 
> 时间：2012-08-22T03:33:24.350
> 
> 标签：java, image, encryption

我想加密图像然后解密它。是否有任何好的参考资料或教程或示例显示如何将图像转换为字符串然后加密字符串？或者还有其他加密图像的方法？因为我是新手，所以我也去搜索过，但没有任何简单的例子让我理解和遵循。

如果我没记错的话，我必须使用 FileInputstream 和 ImageIO，但我不知道它是如何完全工作的。任何人都可以指导我吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T03:40:06.747

图像是二进制文件，因此我认为将其转换为字符串以进行加密没有多大意义。这将增加相当多的开销和复杂性，而没有额外的好处。

您可能应该直接加密二进制文件。

看：

*   [如何在 Java 中加密/解密文件？](https://stackoverflow.com/questions/2442264/how-to-encrypt-decrypt-a-file-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T03:45:40.587

如果您的问题是“我如何在 Java 中执行加密”，那么请查看我在[Java cryptography](http://www.javamex.com/tutorials/cryptography/)上写的一些内容，尤其是关于[symmetric key encryption](http://www.javamex.com/tutorials/cryptography/symmetric.shtml)的部分。本质上，您创建了一些密钥，它可以只是用 SecureRandom 生成的一串随机字节：

```
byte[] key = new byte[16];
(new SecureRandom()).nextBytes(key); 
```

然后你构造一个 Cipher 对象并用密钥初始化它，然后将你需要加密的数据传递给它：

```
public byte[] encryptData(byte[] key, byte[] data) {
  Cipher c = Cipher.getInstance("AES/CTR/PKCS5PADDING");
  byte[] initialCounter = new byte[16];
  c.init(Cipher.ENCRYPT_MODE,
    new SecretKeySpec(key, "AES"),
    new IvParameterSpec(initialCounter));
  byte[] encryptedData = c.doFinal(plaintextData);
  return encryptedData;
} 
```

加密图像并没有什么特别之处——归根结底，它只是一堆字节，就像其他任何东西一样。

密码学的主要问题是您需要了解各种微妙之处才能使其安全。

这里的这个链接也可以帮助你很多：

*   [将 AES 与 Java 技术结合使用](http://java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html)

注意，您不需要将其转换为`String`更像字节数组-

# python - Google App Engine 上 Jinja2 中的分页

> ID：12065988
> 
> 赞同：1
> 
> 时间：2012-08-22T03:33:24.617
> 
> 标签：python, django, google-app-engine, pagination, jinja2

1.  Google App Engine 上的 Jinja2 有分页功能吗？

2.  我正在考虑`from django.core.paginator import Paginator`从 django 使用。 [https://docs.djangoproject.com/en/dev/topics/pagination/?from=olddocs](https://docs.djangoproject.com/en/dev/topics/pagination/?from=olddocs)

我想我需要在 app.yaml 中包含 django 库：

```
libraries:
- name: django
  version: "1.2" 
```

但我想知道这是否会使我的应用程序运行速度变慢，因为我包含更多库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T07:31:16.313

对于分页，建议[使用 cursor 进行查询](https://developers.google.com/appengine/docs/python/ndb/queries#cursors)：

```
q = ndb.query()
cursor = ndb.Cursor(urlsafe=self.request.get('cursor'))
items, next_curs, more = q.fetch_page(10, start_cursor=cursor) 
if more:
    next_c = next_curs.urlsafe()
else:
    next_c = None
self.generate('home.html', {'items': items, 'cursor': next_c }) 
```

并在模板中添加一个“更多”按钮

```
{% if cursor %}
    <a class="btn" href="?cursor={{cursor}}">more..</a>
{% endif %} 
```

'旧' db.Model 是否有类似的东西

# c# - asp.net 中的事务和连接池

> ID：12065989
> 
> 赞同：0
> 
> 时间：2012-08-22T03:33:31.560
> 
> 标签：c#, asp.net, transactions, database-connection, connection-pooling

我使用了我的数据库访问代码，如下所示：

```
//gets the connection and create transaction
SqlTransaction transaction = SelectConnection();

try
{
    dsRecordDataset = new DataSet();
    SqlParameter[] param = new SqlParameter[1];
    string[] taleNames = new string[1];
    taleNames[0] = "RecordSet";
    param[0] = new SqlParameter("@Mode", Mode);
    SqlHelper.FillDataset(transaction, CommandType.StoredProcedure, 
                          "spProject", dsRecordDataset, taleNames, param);
    transaction.Commit();
    return dsRecordDataset;
}
catch (Exception ex)
{
    transaction.Rollback();
    throw ex;
} 
```

我发现的问题是我从未关闭过连接，因此连接池有时会溢出并给用户一个错误。我需要澄清以下内容

1.  连接池什么时候根据asp.net中的默认设置重置？
2.  提交事务与连接有什么关系吗？

在 try catch 块之后我尝试使用以下代码

```
finally
{
    if (transaction.Connection.State == ConnectionState.Open)
    {
        transaction.Connection.Close();
    }
} 
```

但随后连接为空并给出错误。

1.  有什么方法可以关闭上面代码中的连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T04:11:12.480

连接池何时根据asp.net中的默认设置重置？

***如果 MinPoolSize 未在连接字符串中指定或指定为零，则池中的连接将在一段时间不活动后关闭。但是，如果指定的 MinPoolSize 大于零，则连接池不会被破坏，直到 AppDomain 被卸载并且进程结束。***

提交事务与连接有什么关系吗？ ***不，提交连接不会（不应该）关闭连接***

有什么方法可以关闭上面代码中的连接吗？

***您可以使用 Connection 对象的 Close 或 Dispose 方法来执行此操作，或者通过在 C# 中的 using 语句中打开所有连接，以便将它们返回到连接池。未明确关闭的连接可能不会添加或返回到池中。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T06:15:15.807

您得到了答案，但是对于问题 3)，您可能会发现 using 语句在这种情况下很有趣。然而，这意味着代码更改，但它是保持资源关键对象安全的好方法。（就像你的 SqlConnection）

```
using (SqlConnection connection = new SqlConnection(connectionString))  
{  
    SqlCommand command = connection.CreateCommand();  

    command.CommandText = "mysp_GetValue";  
    command.CommandType = CommandType.StoredProcedure;  

    connection.Open();  
    object ret = command.ExecuteScalar();  
} 
```

这只是一个非常简单的示例，但是该语句会自动调用实现 IDisposable 接口的对象的 Dispose 方法。（如 SqlConnection）

如果您对此感兴趣，可以在这里找到更多详细信息和解释： [Your Friend the C# Using Statement](http://www.w3enterprises.com/articles/using.aspx)

# jquery - 在loadingMessage出现在jquery mobile之前删除延迟

> ID：12065992
> 
> 赞同：1
> 
> 时间：2012-08-22T03:33:52.510
> 
> 标签：jquery, jquery-mobile

在我的平板电脑上，从按下页面链接按钮到出现 jquery-mobile 默认的“loadingMessage”（只是一个显示“正在加载”的透明黑框）之间存在 0.75 到 1.5 秒的延迟。我想让它立即出现。

澄清一下，目前的流程是这样的：

```
finger touches button ---- ~1s delay ---> "loading" appears ---- 1-2s ----> new page finishes loading via ajax and slides into view 
```

我希望它是：

```
finger touches button ---- 0s delay ---> "loading" appears ---- 2-3s ----> new page finishes loading via ajax and slides into view 
```

如果它是相关的，我的链接按钮的代码如下所示：

```
<div class="ui-block-a"><a href="/Buynow" data-role="button" class="name-button">Alan Jones</a></div> 
```

感谢您的任何想法！

# jsf - 过滤 在组成成分中

> ID：12065993
> 
> 赞同：1
> 
> 时间：2012-08-22T03:33:56.153
> 
> 标签：jsf, richfaces

希望有人可以提供帮助，因为我非常坚持这个问题。我在其他地方找不到太多帮助...

高级目标：创建一个自定义标签，有助于在 Richfaces 中重用扩展数据表。我有一个自定义标签，我希望类似于：

```
<mytag:customTable bean="#{myBean}"/> 
```

包含表格代码的（简化）文件如下（table.xhtml）

```
 <!--...header stuff -->
<ui:component>
<a4j:outputPanel>
    <h:form>
    <rich:extendedDataTable
        value="#{bean.theData}"
        var="entity"
            id="table">

        <rich:column filterMethod="#{...}">
                     <f:facet name="header">                  
                            <h:inputText value="#{bean.filterValue}">
                               <a4j:support event="onkeyup" reRender="table"/>
                            </h:inputText>
                     </f:facet>
                     <h:outputText value="#{entity.item}"/>
        </rich:column>

    </rich:extendedDataTable>
    </h:form>
</a4j:outputPanel>
</ui:component> 
```

由于应用程序的限制，在`<rich:column>`标签内使用 filterBy="#{...}" 属性并不能满足我的需求。
因此，我必须使用 filterMethod 属性。当我对表格进行硬编码时，

```
<rich:column filterMethod="#{bean.filterFunction}"> 
```

然后一切正常。但是，我想保持标签更通用，而不是硬编码。相反，我还想传递过滤函数的名称（例如`<mytag:customTable bean="#{myBean}" flFcn="#{myBean.filterFunction}">`）。问题是我无法让任何版本的它正常工作。

通过搜索其他线程，我看到将方法传递给“操作”属性的方式具有如下语法：`action="#{bean[fcnName]}"`其中 fcnName 只是一个字符串（参见[http://digitaljoel.nerd-herders.com/2009/08/25 /passing-action-methods-in-facelets-using-array-notation/](http://digitaljoel.nerd-herders.com/2009/08/25/passing-action-methods-in-facelets-using-array-notation/)）。
我已经确认这种方式在动作时可以正常工作。但是，在这种情况下，这似乎对我使用 filterMethod 没有帮助（也许 b/c 函数签名不同？）。基于这些解决方案，我需要类似 `<mytag:customTable bean="#{myBean}" flFcn="filterFunction">`的东西：`<rich:column filterMethod="#{bean[flFcn]}">`

在有效的 EL 语法的许多排列中，我没有找到任何东西。每次，这种方法都会抛出一个异常，说“bean”解析为空。为了检查 bean 是否被真正识别，我让它通过打印一个字符串`<h:outputText value="#{bean.someString}"/>` （删除有问题的 filterMethod=...）并且没有问题。因此，问题似乎完全取决于 filterMethod 收到的任何内容。[我在这里](https://community.jboss.org/message/65354)发现了一个我认为非常相似的问题，但似乎没有得到回答。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-21T06:41:44.970

我在使用 RichFaces 3.3.3 和 JSF 1.2 时遇到了同样的问题，但没有可用的解决方案。

在 RichFaces找到了一个[JIRA 条目](https://issues.jboss.org/browse/RF-8894)，该条目仍然打开，因此可能不再修复。

# vb.net - 使用 vb 从特定的 html div 之间读取文本

> ID：12065995
> 
> 赞同：0
> 
> 时间：2012-08-22T03:35:09.157
> 
> 标签：vb.net

好的，所以我正在开发一个程序，该程序可以读取网页并在页面有更新时弹出一个消息框。现在我的目标是登录网站并在我的程序中显示登录帐户的用户名

如何从welcome_user div 中获取文本？另外我如何检查welcome_user div是否在页面上，如果没有登录网站（我知道如何部分登录）

Html 示例：

```
`<div id="usrpnl" style="float:right;">
     <div class="frm_login" style="text-align:right;">
          <div class="welcome_user"><b>Welcome (Username here)!</b></div>
     </div>
</div>`
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T10:58:52.533

尝试使用正则表达式来匹配用户名：

```
Imports System.Text.RegularExpressions

Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        '~~~ Sample HTML
        Dim strHtml As String = "<div id=""usrpnl"" style=""float:right;"">" & _
                                    "<div class=""frm_login"" style=""text-align:right;"">" & _
                                        "<div class=""welcome_user""><b>Welcome Akhilesh!</b></div>" & _
                                    "</div>" & _
                                "</div>"

        '~~~ Regular Expression to match the username from the HTML
        Dim m As Match = Regex.Match(strHtml, "Welcome\s(.*)!", RegexOptions.IgnoreCase)
        If m.Success Then   '~~~ if found...
            Dim strUsername As String = m.Groups(1).Value   '~~~ ...gets the matched username
            MessageBox.Show(strUsername)    '~~~ display it
        Else
            MessageBox.Show("Username not found !") '~~~ not found !
        End If

    End Sub
End Class 
```

我希望这将有所帮助。祝你好运。

# clojure - 在clojure中生成n位数的二进制数

> ID：12065997
> 
> 赞同：6
> 
> 时间：2012-08-22T03:35:57.067
> 
> 标签：clojure

我想生成`n`从 0 到 2^n-1 的二进制数字。例如 3 位数字，“000”、“001”、“010”、...、“111”（十进制的 0 到 7）。我使用的方法是使用`java.lang.Integer.toBinaryString()`方法并在必要时添加零，如下所示：

```
(defn pad-zero [s n]
  (str (reduce str (repeat (- n (count s)) "0")) s))

(defn binary-permutation [n]
  (map (fn [s] (pad-zero s n))
       (map #(Integer/toBinaryString %) (range 0 (Math/pow 2 n))))) 
```

使用这段代码，我可以像这样生成我想要的东西。3位数：

```
(binary-permutation 3)
=> ("000" "001" "010" "011" "100" "101" "110" "111") 
```

但是这段代码看起来有点冗长。有没有更好或更clojure的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T06:50:27.443

您可以使用[clojure.pprint中的](http://clojure.github.com/clojure/clojure.pprint-api.html)[cl-format](http://clojure.github.com/clojure/clojure.pprint-api.html#clojure.pprint/cl-format)简化格式设置：

```
(defn binary-permutation [n]
  (map (partial cl-format nil "~v,'0B" n) (range 0 (Math/pow 2 n)))) 
```

您可能也有兴趣知道这`(Math/pow 2 n)`相当于`(bit-shift-left 1 n)`.

另一种表达方式是从[clojure.math.combinatorics中进行](https://github.com/clojure/math.combinatorics/)[选择](https://github.com/clojure/math.combinatorics/blob/math.combinatorics-0.0.3/src/main/clojure/clojure/math/combinatorics.clj#L107)：

```
(defn binary-permutation [n]
  (map (partial apply str) (selections [0 1] n))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T12:19:48.113

```
(defn binary-permutation [n]
  (for [x (range (Math/pow 2 n))]
    (apply str (reverse (take n (map #(bit-and 1 %) (iterate #(bit-shift-right % 1) x)))))))

(defn pad-zero [s n]
  (apply str (take-last n (concat (repeat n \0) s)))) 
```