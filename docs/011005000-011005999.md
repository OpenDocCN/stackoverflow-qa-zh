# StackOverflow 问答 11005000-11005999

# spotify - libspotify API：由轨道 uri 产生的艺术家和专辑的数量

> ID：11005000
> 
> 赞同：0
> 
> 时间：2012-06-12T21:17:02.700
> 
> 标签：spotify

困惑 - 给定一个曲目 uri，我可以获得一张专辑，但可能不止一位艺术家（请参阅**sp_track_album**和**sp_track_artist**）。但是给定一张专辑，我通常只会得到一个艺术家。因此，如果我从 track uri 中获取专辑，然后从专辑中获取艺术家，则将有一位艺术家；如果我直接从 track uri 获取艺术家，可能会有不止一位艺术家。如何解释差异？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:59:44.960

在 Spotify 客户端中查看这张专辑：`spotify:album:0MYABBSxz6JqujXq2JBvsF`

这张专辑的艺术家是“蕾哈娜”。

专辑中的一些曲目由不止一位艺术家创作，比如“我们找到了爱”，卡尔文·哈里斯和蕾哈娜都有。

一张专辑只能由一位艺术家创作，而曲目可以由多位艺术家创作。合辑通常具有“各种艺术家”的艺术家。

# c# - 意外创建多个进程

> ID：11005003
> 
> 赞同：0
> 
> 时间：2012-06-12T21:17:08.157
> 
> 标签：c#, asp.net, xml, file

我是 Web 编程新手（Visual Web Developer 中的 C#），我的非 C 编程技能也有点生疏。

我创建了一个表格，其中一些单元格提示用户输入，一旦给出输入，输入就会替换提示。因此，表格只能由第一个访问该页面的人注释。稍后需要将带注释的页面提供给其他人查看，所以我需要在第一次完成后加载页面而没有提示。为此，我（尝试）识别用户，以便该人获得可编辑页面，所有编辑都保存到 xml 文件中，如果另一个用户运行该页面，则表设置会从 xml 文件中读回的编辑。

我无法始终写入 xml 文件。具体来说，我有时似乎会创建多个访问文件的进程，并且当我的代码尝试更新它时会引发运行时异常。

因为我不想在每次页面加载时创建一个新文件，所以我认为静态类是要走的路。这是代码：

```
static class XMLReaderWriter
{
    static String fileLocation = "D:\\WebApp\\dashboard.xml";
    static XMLReaderWriter()
    {
        FileStream fs = File.Create(fileLocation);
        if (File.Exists(fileLocation))
        {
            // The opening tag
            writeToFile(fileLocation, "<Dashboard>\n");
        }
        else
        {
            Exception e = new Exception("Failed to create " + fileLocation);
            throw e;
        }
    }
    public static void writeXML(String xml)
    {
        if(File.Exists(fileLocation))
        {
            writeToFile(fileLocation, xml);
        }
        else
        {
            File.Create(fileLocation);
            writeToFile(fileLocation, xml);
        }
    }

    private static void writeToFile(String fileLocation, String xml)
    {
        StreamWriter sw = new StreamWriter(fileLocation, true);
        sw.WriteLine(xml);
        sw.Close();
        sw.Dispose();
    }

    public static string readXML(String trendID)
    {
        StringBuilder result = new StringBuilder("");
        if (File.Exists(fileLocation))
        {
            XDocument xDoc = XDocument.Load(fileLocation);
            var image = from id in xDoc.Descendants(trendID) select new
                        {
                            source = id.Attribute("image").Value
                        };
            foreach (var imageSource in image)
            {
                result.AppendLine(imageSource.source);
            }
        }
        return result.ToString();
    }

    public static void done()
    {
        // The closing tag
        writeToFile(fileLocation, "</Dashboard>");
    }
} 
```

这是我调用方法的地方：

```
XMLReaderWriter.writeXML("\t<trend id=\"" + trendID +"\">\n\t\t" + innerHTML + "\" />\n\t</trend>"); 
```

最后有一个提交按钮，可以将结束标记添加到 xml 文件中：

```
<asp:Button runat="server" Text="Submit Changes" OnClick="Submit_Click" />

protected void Submit_Click(Object sender, EventArgs e)
{
    XMLReaderWriter.done();
} 
```

有时一切正常——尽管我似乎生成了格式错误的 xml。但大多数时候，我得到多个访问 xml 文件的进程。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:28:28.900

Web 编程意味着在多线程环境中工作。

从浏览器到 Web 服务器的每个请求都是一个单独的*线程*。

这就是为什么有时无法访问您的文件的原因，因为其他请求（例如*thread*）可能对其具有排他锁。

还有一点是*using 语句*应该是你的朋友，所以替换：

```
StreamWriter sw = new StreamWriter(fileLocation, true);
sw.WriteLine(xml);
sw.Close();
sw.Dispose(); 
```

... 和：

```
using(StreamWriter sw = new StreamWriter(fileLocation, true))
{
    sw.WriteLine(xml);
} 
```

这相当于一个*try-finally*块，它调用`Dispose`任何实现的方法`IDisposable`。因此，如果您的块失败，它将始终调用`Dispose()`.

在上面的评论中，可以提一下，如果在某个线程中的某些操作期间出现问题，文件的锁定将永远保留在其上，直到 IIS 应用程序停止或应用程序池被回收。

概括：

1.  在您的情况下，可能不止一个线程正在尝试写入同一个文件。
2.  一些错误可能会在受影响的文件中留下一些锁定。

解决方案：*永远不要在 Web 应用程序中处理文件，有更好的方法来保存数据：数据库 - 这些解决了并发场景中的很多问题！-*。

# hadoop - 在 PIG UDF 中调试

> ID：11005004
> 
> 赞同：7
> 
> 时间：2012-06-12T21:17:11.697
> 
> 标签：hadoop, apache-pig, hdfs

我是 Hadoop/PIG 的新手。我有一个基本问题。

我们在 PIG UDF 中是否有日志记录工具？我写了一个 UDF，我需要验证我需要记录某些语句来检查流程。是否有可用的日志记录工具？如果是，Pig 日志在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T23:45:04.713

假设您的 UDF 扩展`EvalFunc`，您可以使用从返回的 Logger [`EvalFunc.getLogger()`](http://pig.apache.org/docs/r0.8.1/api/org/apache/pig/EvalFunc.html#getLogger%28%29)。日志输出应该在 pig 执行的关联 Map / Reduce 任务中可见（如果作业在多个阶段执行，那么您必须通过它们来查找关联的日志条目）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-18T08:51:41.553

也许很明显，但我建议在部署到集群/伪集群之前以本地模式调试您的 UDF。这样，您可以直接在 IDE 中调试它（在我的例子中是 eclipse），这比日志调试更容易。

# sql - 无法与重定向器建立连接。确保“sql browser”服务正在运行

> ID：11005007
> 
> 赞同：4
> 
> 时间：2012-06-12T21:17:19.993
> 
> 标签：sql, sql-server, ssis, sql-server-2012, ssid

所以我尝试这个 sql server 2012，由于这个错误，我无法打开任何 ssis 包

无法与重定向器建立连接。确保“sql browser”服务正在运行

我的 Sql Browser 肯定在运行，我尝试在本地服务、本地系统和网络下更改它，仍然没有结果，任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-27T12:08:58.383

此错误似乎仅与命名实例有关。原因是 SQL 客户端无法解析实例，因为 SQL 客户端无法访问 SQL Browser 服务。SQL 浏览器服务解析实例名称

1.  确保 SQL 浏览器服务正在运行
2.  确保运行 SQL 浏览器服务的端口未被 PC 阻止（默认端口 2382）

或者，您可以通过在客户端连接属性中提及“服务器：端口”而不是“服务器\实例名称”来绕过 SQL 浏览器服务

# android - Android 递归文件搜索

> ID：11005008
> 
> 赞同：0
> 
> 时间：2012-06-12T21:17:23.040
> 
> 标签：android, file, list, search, recursive-query

有人可以指出这里出了什么问题：

下面的代码循环遍历 /sdcard 上的目录。如果它找到一个文件，它会将名称等添加到一个数组中。如果它找到一个目录，它就会进入并扫描它。

system.out 返回 /sdcard 上的所有文件。

数组适配器仅列出它在顶级目录中找到的内容

在我的 sd 卡上，我希望它返回两个 mp3 文件，一个在顶级目录中，一个埋在树中。system.out 行找到了两者。

我怀疑 fls arraylist 正在被破坏。如果是，我该如何保存这个？

提前致谢！

```
 public void fill(File f) {     
        File[]files = f.listFiles();
          List<Option>fls = new ArrayList<Option>();
          if (files != null) {
                for(File ff: files){
                    if(!ff.isDirectory())
                        {
                        /** Only Add MP3's to the list    */
                        String filename=ff.getName();
                        String ext = filename.substring(
                                    filename.lastIndexOf('.')+1, filename.length());
                                           if(ext.equals("MP3")||ext.equals("mp3")||ext.equals("Mp3")||ext.equals("mP3"))
                        fls.add(new Option(ff.getName(),"File Size: "+ff.length()/1048576 + "MB",ff.getAbsolutePath()));
                        System.out.println( ff.getName() );
                        }
                    else
                        fill(ff);
               }    
          }

        Collections.sort(fls);
        adapter = new FileArrayAdapter(getActivity(),R.layout.folder_view,fls);
        this.setListAdapter(adapter);   
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:32:27.707

使用代码，每次进入新文件夹时都会重新创建arraylist，您需要将适配器代码从函数中取出，并让fill函数将arraylist作为参数，以便每次调用都采用相同的arraylist。

IE。

```
List<Option>fls = new ArrayList<Option>();

fill(f,fls);

Collections.sort(fls);
adapter = new FileArrayAdapter(getActivity(),R.layout.folder_view,fls);
this.setListAdapter(adapter); 
```

如果你想把它减少到一个电话（我不推荐），你可以做

```
fill(f,null); 
```

并在填充函数中检查 arraylist 是否为空，如果它正在初始化它，但您仍然必须将它传递给其他调用。

# javascript - Rails 逐步表单 - 几乎转换为 Ajax - 除了浏览器后退按钮

> ID：11005011
> 
> 赞同：2
> 
> 时间：2012-06-12T21:17:33.790
> 
> 标签：javascript, jquery, ajax, ruby-on-rails-3

我目前正在我的网站上创建分步注册过程。

整个过程已成功创建，设置与此处投射的轨道完全相同：[http ://railscasts.com/episodes/217-multistep-forms](http://railscasts.com/episodes/217-multistep-forms)

在我完成所有这些工作之后，我将整个东西转换为 Ajax！使用每一步的提交按钮或表单，我只是添加了：

```
remote:true 
```

然后，在添加正确的响应处理之后：

```
respond_to do|format|
  format.js { render 'new' }
  format.html { render 'new' }
end 
```

在 new.js.erb 我有这个：

```
$('#steps_content').fadeOut('fast', function(){
  $('#steps_content').html("<%= j render "#{@subscription.current_step}_step" %>", 
     $('#steps_content').fadeIn('fast', function(){})
  )
}); 
```

这是 new.html.erb：

```
<div id='steps_content' >
   <%= render "#{@subscription.current_step}_step" %>
</div> 
```

一步一步的Ajaxified！

无论如何，由于整个事情已经被 Ajaxified，我一直试图让**浏览器后退按钮**转到我的上一步以及有一个页面后退按钮。

我通过将它添加到我的 new.js.erb 的开头来达到那里：

```
history.pushState(
   null, 
   '', 
   '#step=<%= j "#{@subscription.current_step}" %>'
); 
```

到最后：

```
if (!$(window) || !$(window).data('events') || 
    !$(window).data('events')['popstate']) {

      $(window).bind('popstate', function() {
        $.getScript(location.href);
      });

} 
```

这给我带来了相当多的麻烦！

使用当前设置：JQuery 动画触发。想了想，它只是fadeIn，fadeOut到同一步骤。我发现发生这种情况的原因是因为所有步骤代码都在创建操作（发布）中，而不是后退按钮触发的新操作（获取）。尽管即使我将代码放在那里，浏览器中的后退按钮也不会抛出 :back_button 参数。

我一直在做很多关于让后退按钮与 Ajax 一起工作的研究，但我发现的所有情况都并不适用！这部分是因为我的整个设置更改了我猜的控制器代码中的 current_step。即使我确实将控制器代码放入新操作中，也不会加载上一步，因为没有 :back_button 参数。

我想我的第一个问题是： **有没有办法只在按下浏览器的后退按钮时添加 :back_button 参数？**

那将是理想的，因为这样我当前的所有代码都可以正常工作。我知道可以通过以某种方式绑定到 ajax 发送回调来添加该参数，但我只希望它在按下浏览器后退按钮时发生。我想也许我可以以某种方式绑定到 history.back ，但这似乎不可能。

我的主要问题： **如何解决此问题以使浏览器返回正确的步骤？**

我可以以某种方式读取锚参数来设置当前步骤吗？

我是否必须更改用于执行每个步骤的整个方法？

也许我只是失败并做错了什么？

我觉得我很接近！

提前感谢各位程序员，任何指引我正确方向的指南，或者任何更漂亮的替代方法也会有所帮助。另外，我不想使用任何预制插件来实现这一点。

如果您需要更多信息，请告诉我。

谢谢！

**编辑：**

我提出这个问题可能包括体面的预制插件/宝石/库，这些插件/宝石/库有强大的支持，并且得到足够的支持以进入生产环境。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T01:06:52.237

我使用了一个名为 jQuery BBQ 的 jQuery 插件，取得了很好的成功

基本上，它允许您在用户离开当前页面时推送一组数据（通常用于记录您的 ajax 状态）。如果用户单击后退按钮，它会弹出状态数组并让您编写一个事件处理程序来恢复您的 ajax 状态，基于数组

无论哪种方式，它都值得一看，因为自从我一年前开始使用它以来，它从未给我带来任何支持问题.. [http://benalman.com/code/projects/jquery-bbq/docs/files/jquery-ba-烧烤-js.html](http://benalman.com/code/projects/jquery-bbq/docs/files/jquery-ba-bbq-js.html)

它还在现代浏览器（包括 safari）上进行了测试。诚然，我不知道它引入了哪些更改来解决 Safari 缺乏 hashchange 事件支持的问题，但无论如何它都可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T21:05:49.703

您可以使用 jquery 观看名为“hashchange”的事件

```
$(window).bind('hashchange',function(){ 
/*
    do stuff where you want when the back button is hit here
*/
}); 
```

无论您想放在那里的任何逻辑都应该有效。当您按下后退按钮时。您应该能够跟踪该呼叫或其他任何内容中的更改。

在创建完全动态的页面并使用锚标记在页面之间导航时，我使用了这个技巧。它适用于前进和后退。在您的情况下，您可能希望确保在重新提交或您拥有的任何验证逻辑的情况下不允许转发按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T15:24:28.250

您可以使用插件 Jquery Adress 做到这一点： [http ://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)

# io - 使用 Pandas 导入数据表 - 异常：索引（第 0 列）具有重复值 [nan]

> ID：11005012
> 
> 赞同：1
> 
> 时间：2012-06-12T21:17:34.847
> 
> 标签：io, pandas

我是新手，`pandas`所以如果我忽略了一些明显的东西，请原谅我，但我似乎无法在以前的问题中找到答案。

我正在尝试将一个表导入到 Pandas 中，该表具有任意数量的空格作为分隔符。以下是数据示例：

```
*PRODUCT : Backscatter Ratio - 1064.0 nm ^

Altitude                  2010/03/23 17:01:00       2010/03/23 17:03:00       ...

1.50                      1                         1                         ...

4.50                      1                         1                         ...

.                         .                         .

.                         .                         .

.                         .                         .* 
```

表的实际大小是 1310 列 x 6009 行。我不一定要使用固定宽度解析器，因为将来这些表格的间距可能会改变，所以我使用了以下内容：

```
df = pandas.io.parsers.read_csv(filepath,sep='s*',header=2,index_col=None, skiprows=2) 
```

当我这样做时，我收到以下错误：

> 文件“C:\Python27\lib\site-packages\pandas\io\parsers.py”，第 187 行，在 read_csv 返回 _read(TextParser, filepath_or_buffer, kwds)
> 文件“C:\Python27\lib\site-packages\pandas \io\parsers.py”，第 160 行，在 _read 返回 parser.get_chunk()
> 文件“C:\Python27\lib\site-packages\pandas\io\parsers.py”，第 613 行，在 get_chunk 中引发 Exception(err_msg )
> 
> 例外：索引（第 0 列）具有重复值 [nan]

请注意，我已将索引列设置为无。我已经尝试使用第一列作为索引列并得到相同的错误。数据集中没有空行或第一列中没有重复值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T18:21:53.973

问题是，当您使用任意数量的空格作为分隔符时，每行的列数都会不同。

在这种情况下，标题中的这个字段`2010/03/23 17:01:00`，将被转换为两列。既然标题和数据之间的列数不同，pandas 假设它必须索引第一列。这就是您收到错误的原因。要修复它，您可以尝试指定一定数量的空格作为分隔符。您还可以使用逗号或制表符或其他会导致明确的字段描述的东西。

# c# - 使用 PDFCreator 通过 IIS 创建 .ps 文件

> ID：11005013
> 
> 赞同：1
> 
> 时间：2012-06-12T21:17:36.097
> 
> 标签：c#, pdf-generation, iis-7.5

我正在将 .docx、.doc 文件转换为 .ps 文件。在本地机器上工作正常并打印 .ps 文件，但在 IIS 7.5 上它不打印，我只是收到此错误

“ActiveX-Server 尚未启动！请使用函数“cStart()”启动 ActiveX-Server！”

我试过 cStart("/NoProcessingAtStartup", false) 没有运气，并进行了多次搜索，但没有解决。有没有人遇到过这样的事情？

IIS：匿名授权、应用程序池标识

```
PDFCreator.clsPDFCreator creator = new PDFCreator.clsPDFCreator();
PDFCreator.clsPDFCreatorOptions options = new PDFCreator.clsPDFCreatorOptions();
options = creator.cOptions;
PDFCreator.clsPDFCreatorError perr = new PDFCreator.clsPDFCreatorError();

if (!creator.cStart("/NoProcessingAtStartup", false))
{
     Console.Write("Can't Initiase PDF Converter, letter Generation Error");
}

options.UseAutosave = 1;
options.UseAutosaveDirectory = 1;
options.AutosaveDirectory = path;
options.AutosaveFilename = name;
options.AutosaveFormat = 6; //0=PDF, 1=PNG, 2=JPG, 3=BMP, 4=PCX, 5=TIFF, 6=PS, 7= EPS, 8=ASCII
creator.cOptions = options;
creator.cSaveOptions();
creator.cClearCache();
creator.cPrinterStop = false;
creator.cDefaultPrinter = "PDFCreator";
creator.cPrintFile(pathFull);

err = creator.cError.Description.ToString(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:00:24.107

这可能是因为应用程序池用户没有运行 PDFCreator 的权限，或者因为它在第一次运行之前和首次运行时从未运行过 PDFCreator，它试图以交互方式进行一些安装或设置，而应用程序池用户没有交互式上下文。尽管我会倾向于后者，因为如果是前者，我预计会出现不同的错误。

如果可以通过计算机管理/组件服务中的 DCOM 配置部分访问 PDFCreator，那么您可以尝试将其设置为始终以特定用户身份运行，可能是您自己的身份。您还需要授予应用程序池用户权限启动和激活和访问权限。

或者，您可以在应用程序配置或代码中尝试模拟，并模拟您通常用于 PDFCreator 的帐户。

**更新**：虽然 Word 是实际问题并且 PDFCreator 试图激活它，但上述建议仍然完全适用。
如果另一个进程正在尝试激活 Word，则运行该进程的用户需要对其具有 DCOM 权限，并且如果激活进程的用户没有权限或以前从未使用过 Word，则 Word 可能需要以特定用户身份运行.

作为一个具体的例子，假设您在网络服务帐户下运行该进程并尝试激活 Word，当新用户第一次尝试运行 Word 时，Word 将抛出一些安装窗口进行首次配置，但由于用户未以交互方式登录这些窗口无法看到且无法响应，因此安装挂起。在这种情况下，最好将 Word 设置为始终以 DCOM 配置中的特定身份启动。

# algorithm - 在具有任意基数的数字系统之间转换

> ID：11005016
> 
> 赞同：1
> 
> 时间：2012-06-12T21:17:42.607
> 
> 标签：algorithm, math, logic

考虑一种情况，其中需要以下功能：

```
convert(val1, base1, base2) 
```

它将数字 ( `val1`) 从`base1`数字系统转换为`base2`数字系统。在这个函数中，所有参数都是字符串，例如

```
convert("34", "012345", "01234567890ABCDEF") 
```

调用以转换 34 [6] -> X [16]。

当我开始考虑实现时，很明显将具有较大基数的数字转换为较小的数字需要为较大基数的数字定义除法运算，例如 12 [10] -> X [2] = 12 / 2 | 6 / 2 | 3 / 2 | 1 / 2 | = 1100 [2]。

接下来是关于进行两步转换 X [b1] -> X [10] -> X [b2]。这肯定会更容易实现，但是伙计们，你能确认我在前面的结论中没有错吗，或者有没有一种明确的方法可以在`convert()`没有中间到十进制转换的情况下实现这样的功能？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:21:59.603

假设您正在计算机程序中寻找实用的解决方案，您不想转换为基数 10 作为中间值，而是转换为计算机的本机表示，其基数无关紧要。编写两个单独的函数，一个将字符串解析为整数，另一个将整数转换为字符串。

# android - 事件监听器不工作

> ID：11005018
> 
> 赞同：0
> 
> 时间：2012-06-12T21:17:55.860
> 
> 标签：android

以下是`main activity class`. 它将内容设置为`main.xml`，其中包括一个按钮`btn`。单击此按钮时，内容设置为`pic.xml`，其中有两个按钮，`btn1`和`btn2`。单击时`btn1`，它应该将内容设置回，`main.xml`但这没有发生。

```
package com.asin.amit;

import java.io.BufferedOutputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.Bitmap.CompressFormat;
import android.graphics.PixelFormat;

import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.MediaController;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.VideoView;

public class AsinActivity extends Activity {
/** Called when the activity is first created. */
private TextView tv ;
private VideoView myVideoView;
private Button btn;
private Button btn1;
private Button btn2;

@Override

public void onCreate(Bundle savedInstanceState) {

    try {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        btn = (Button) findViewById(R.id.b);
        btn1 = (Button) findViewById(R.id.button1);
        btn2 = (Button) findViewById(R.id.button2);

        String str= "/sdcard/DCIM/a.mp4";

        tv = (TextView) findViewById(R.id.tv1);

        myVideoView = (VideoView)findViewById(R.id.myvideoview);
        myVideoView.setVideoPath(str);
        myVideoView.setMediaController(new MediaController(this));
        myVideoView.requestFocus();
        myVideoView.start();

        btn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                myVideoView.pause();                         
                setContentView(R.layout.pic);
            }                                   
        });

        btn1.setOnClickListener(new ButtonListener());

    } 
    catch (Exception e) {
        // handle any errors
        Log.e("HelloWorld", "1", e);  // log the error
        // Also let the user know something went wrong
        Toast.makeText(
                getApplicationContext(),
                e.getClass().getName() + " " + e.getMessage(),
                Toast.LENGTH_LONG).show();
    }
}

class ButtonListener implements View.OnClickListener{
    @Override
    public void onClick(View v) {

        setContentView(R.layout.main);
    }
}
} 
```

在电话线上`btn1.setOnClickListener(new ButtonListener());` ，logcat 说`java.lang.NullPointerException`

我在做什么错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:31:03.120

根据您所写的内容，`When this button is clicked, content is set to pic.xml, which has two buttons, btn1 and btn2`您的 btn1 和 btn2 位于*R.layout.pic*，但您正试图在*R.layout.main*布局中找到它们

`btn1 = (Button) findViewById(R.id.button1);`

`btn2 = (Button) findViewById(R.id.button2);`

您应该仅在之后才将值设置为 btn1 和 btn2 变量（当然还有 onClickListener）`setContentView(R.layout.pic)`，因为只有这样您的布局才会包含这些按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:38:22.947

`setContentView()`在一项活动中多次使用（几乎？）总是一个坏主意。`main.xml`您正在从您的布局中选择ID 为 R.id.button1 的按钮`onCreate()`，并为该按钮设置一个侦听器。当您随后调用`setContentView(R.layout.pic)`该按钮时不再有效。`btn = (Button)findViewById(R.id.button1)`设置内容视图后，您必须再说一遍。这只是一个糟糕的设计，因为它有很多破坏的机会。`pic.xml`当您单击按钮时，有什么理由不能简单地启动一个新的 Activity作为其内容视图？

# sed - sed 's/.../...': 是否可以存储子表达式供以后使用？

> ID：11005027
> 
> 赞同：0
> 
> 时间：2012-06-12T21:18:19.293
> 
> 标签：sed, backreference

假设我有类似的东西：

```
echo "bLah BLaH blAH" | sed -r 's/([a-zA-Z ]+)/\L&; s/[a-z]/\u&/g' 
```

sed 的典型用法是将“疯狂大小写”字符串转换为混合大小写（第一个字母大写，其余字母小写）

但是，这将始终影响整个字符串。例如，如果我想解析各种风格的“疯狂”mp3 文件名（$tracknr - $artist - $title 与 $artist - $tracknr - $title），事情会变得更加复杂，因为有时标题是外语的像法语和混合大小写在法语或意大利语中看起来很糟糕。这就是为什么我只想继续直到达到某个分隔符，例如空格-破折号-空格。

因此，我想使用组合的 's/.../...' 表达式来一步一步地做事。*但是，如果有一种方法可以从 PREVIOUS 表达式中“存储”子表达式，让我能够将保留的子匹配用作*下一个 sed 替换表达式的源表达式，那就太好了。

如果您认为无论如何都可以使用 OOTB，那您就错了。您只是不能在分号后的第二个表达式中使用 '\1' 语法来引用前一个表达式的子表达式（当然，一旦您在*第二个*表达式本身中定义了子表达式，它就可以工作，但现在不考虑这种可能性）。在我的情况下，解析器不知道，你会得到错误

```
sed: -e expression #1, char (xx): invalid reference \1 on `s' command's RHS 
```

有什么东西可以执行这种事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:38:54.633

### 问题

您想将每个单词的第一个字母大写。

### 您的问题使您的生活变得比必要的更艰难

您可以将文本存储在保持空间中，或使用顺序和嵌套表达式对匹配模式执行多个操作。您甚至可以利用保持空间拉一些恶作剧来重新处理生产线。然而，经过一定程度的复杂性，真正的问题不是“语言 X 能做到这一点吗？” 而是“为此优化了什么语言？”

如果您想使用规范的 PCRE 引擎进行繁重的文本处理并通过复杂的逻辑跟踪子表达式，Perl 是一个更好的选择。任何图灵完备的语言都可以，但是 Perl 的反义词之一是“病态折衷垃圾列表”是有原因的。

### 简单的 GNU sed 解决方案

您不需要您要求的所有复杂性。一些基本的 GNU sed 扩展可以满足您的需求。

```
echo "bLah BLaH blAH" |
sed -r 's/(\b[a-zA-Z ]+\b)/\L&/g; s/\b[a-zA-Z ]/\u&/g' 
```

这产生了将每个单词的第一个字符大写的所需输出：

> 等等等等等等

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:43:10.803

假设@CodeGnome 做对了，你想要的是

> 您想将每个单词的第一个字母大写。

您可以使用这个替代方案（它仍然是 GNU 主义，请参阅`\L` `\U`）：

```
sed 's;\(.\)\([^ ]*\) \?;\U\1\L\2 ;g' 
```

你的例子：

```
$ echo "bLah BLaH blAH" | sed 's;\(.\)\([^ ]*\) \?;\U\1\L\2 ;g'
Blah Blah Blah 
```

* * *

如果您可以选择其他解决方案，除了`sed`您可以使用`awk`并摆脱 GNU-isms（感谢 IRC 上的 dualbus）

```
awk '{for(i=1;i<=NF;i++){$i=toupper(substr($i,1,1))tolower(substr($i,2))}}1' 
```

例子：

```
$ echo "bLah BLaH blAH" | awk '{for(i=1;i<=NF;i++){$i=toupper(substr($i,1,1))tolower(substr($i,2))}}1'
Blah Blah Blah 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T21:55:35.967

Perl 单线方法;)

```
echo "bLah BLaH blAH" |
    perl -ne '@_ = map { ucfirst } split; print join " ", @_, $/'
BLah BLaH BlAH 
```

我猜这适用于任何*Unices* =)

我会分解它：

```
perl         # ?! dunno =)
-n           # assume "while (<>) { ... }" loop around program
-e           # one line of program (several -e's allowed, omit programfile)
@_           # default array name
=            # what you expect
map          # take a list as argument, and perform modification. Return a list
{ ucfirst }  # modification on the list
split        # without argument, takes the current line (we use -n switch)
;            # end of the first instruction
print        # what you expect
join " ", @_ # join a space on the list
$/           # by default, a newline (see perldoc perlvar) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T22:06:39.597

或者在 awk 中，没有正则表达式的开销：

```
[ghoti@pc ~]$ echo "bLah BLaH blAH" | awk 'BEGIN{RS=" ";ORS=RS} {print toupper(substr($0,1,1)) tolower(substr($0,2))}'
Blah Blah Blah 
```

# sap - BO Webi中的级联提示而不使用Universe？

> ID：11005028
> 
> 赞同：0
> 
> 时间：2012-06-12T21:18:21.070
> 
> 标签：sap, business-objects, webi

是否可以在不使用 Universe 的情况下在 Business object webi 中创建级联提示？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T01:28:47.573

唯一的办法就是修改viewer.js和prompts.js的代码或者开发一个新的接口来接受报表参数。

# c# - 需要从 ConstructorInfo 获取可选参数

> ID：11005030
> 
> 赞同：1
> 
> 时间：2012-06-12T21:18:25.897
> 
> 标签：c#, c#-4.0, reflection

> **可能重复：**
> [通过反射调用带有可选参数的方法](https://stackoverflow.com/questions/2421994/invoking-methods-with-optional-parameters-through-reflection)
> [c# 中构造函数参数的名称](https://stackoverflow.com/questions/6606515/name-of-the-constructor-arguments-in-c-sharp)

现在我正在使用反射构造对象。我正在使用它来填写 API 文档。在许多情况下，我想要一个非默认构造函数，但有时它们具有可选参数。这些可选参数需要用默认对象以外的新对象覆盖。问题是我不知道如何获得它们。使用constructorInfo.GetParameters() 可以很容易地使用普通参数，但似乎可选参数不会回来。我在这里错过了什么吗？

示例代码：

```
 ConstructorInfo[] constructorInfoList = type.GetConstructors(BindingFlags.Instance | BindingFlags.Public);
            foreach (ConstructorInfo constructorInfo in constructorInfoList)
            {
                var parameters = constructorInfo.GetParameters();
                if (parameters.Count() > 0)
                { 
```

答：事实证明他们确实回来了……这是用户错误。

样本：

```
void Main()
{
    var ctors = typeof(Foo).GetConstructors();
    foreach(var ctor in ctors)
    {
        foreach(var param in ctor.GetParameters())
        {
            Console.WriteLine("Name: {0} Optional: {1}", param.Name, param.IsOptional);
        }
    }   
}

public class Foo
{
    public Foo(string option1, string option2 = "")
    {
    }
} 
```

输出：

名称：option1 可选：False 名称：option2 可选：True

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:38:24.697

可能重复。看来您可以调用参数，但必须手动设置值。

我在这里发现了一个类似的问题：

[通过反射调用带有可选参数的方法](https://stackoverflow.com/questions/2421994/invoking-methods-with-optional-parameters-through-reflection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:28:52.560

看这里，它有效：

```
var parameterName =
    typeof(Foo)
    .GetConstructor(new[] { typeof(string) })
    .GetParameters()
    .Single().Name;

public class Foo
{
    public Foo(string paramName)
    {   
    }
} 
```

# c++ - 将 C++ 与 CUDA 结合使用

> ID：11005033
> 
> 赞同：2
> 
> 时间：2012-06-12T21:18:42.710
> 
> 标签：c++, cuda

我刚刚开始使用 CUDA，想知道如何最好地将**主机端**API 与 C++ 一起使用。我对任何 C API 的最初倾向是用内联函数和方法包装它，在错误返回时添加异常，以便它与我的其余代码很好地融合。我已经简要介绍了推力，但这似乎是一个更高级别的东西，并且不包含您可能需要使用的其他 API。

是否存在我缺少的现有包装器，或者是否有充分的理由直接使用我忽略的 C API？

**更新**：我确实找到了一个类似于我正在寻找的名为[<Cuda> 模板](http://cudatemplates.sourceforge.net/)的库。它比我想要的更抽象，所以我可能不会使用它，但我把它放在这里作为参考，以防其他人有同样的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T17:07:45.443

CUDA 调用通常与内核调用密切相关。例如，您可能会分配一些内存，`cudaMalloc()`然后在该内存上运行内核。内核本身、调用内核的代码（使用三括号语法）和设置一些资源（如纹理）的代码都必须在 .cu 文件中。

正因为如此，我认为最好只创建小型 C 风格的库来包装与一个内核（或几个紧密相关的内核）相关的功能。然后，如果需要，可以将该 C 样式库封装在 C++ 接口中。

因此，例如，C 风格的库可能有一个`init()`调用来设置内核运行所需的所有资源`compute()`、调用一个或多个内核的`deinit()`调用以及释放所有内容的调用。然后，如果需要，您可以拥有一个 C++ 类，该类`init()`在其构造函数、`deinit()`析构函数中`compute()`调用，并使用检查返回值并可能引发异常的方法包装调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T01:07:12.750

据我所知，不存在这样的事情。如果您只想在出错时抛出异常，请考虑使用[`thrust::system_error`](http://thrust.github.com/doc/classthrust_1_1system_1_1system__error.html#details).

例如：

```
#include <thrust/system_error.h>

void my_cudaMalloc_wrapper(void **devPtr, size_t size)
{
  cudaError_t error = cudaMalloc(devPtr, size);
  if(error != cudaSuccess)
  {
    throw thrust::system_error(error, thrust::cuda_category());
  }
} 
```

`thrust::system_error`源自`std::runtime_error`。它的`.what()`成员函数将为您解码 CUDA 运行时错误：

```
#include <iostream>

void foo()
{
  int *ptr = 0;
  size_t n = 13;
  try
  {
    my_cudaMalloc_wrapper(&ptr, n);
  }
  catch(std::runtime_error &error)
  {
    std::cerr << "Uh oh: " << error.what() << std::endl;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T21:49:23.570

你可以这样做。但是，在最低级别用 C++ 替换 C 习语并不总是可行的。例如，执行完整的 RAII 通常是低效的：在 GPU 上初始化数组可能比在 CPU 上慢得多，并且通常可以使用“未初始化”模式设计内核来替代这个昂贵的步骤。您可以直接在 C++ 类中管理此类内容，但 IMO 将其放在额外的 C 层中会更安全一些，因为没有人*期望*一切都很好地 RAIIed。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T21:26:11.460

我的回答并不完整。根据我研究 CUDA 时的记忆，可以在这些内核中运行的代码类型非常有限。分配给每个内核的私有内存空间非常少，因此不能有大的堆栈、堆分配的对象以及 C++ 擅长的所有好东西，这使得 C++ 对于 CUDA 目的几乎毫无用处。因此，即使有包装器，由于限制，使用起来也不实用

# sql - PostgreSQL 是否支持“不区分重音”排序规则？

> ID：11005036
> 
> 赞同：121
> 
> 时间：2012-06-12T21:19:14.597
> 
> 标签：sql, postgresql, localization, indexing, pattern-matching

在 Microsoft SQL Server 中，可以指定“不区分重音”排序规则（针对数据库、表或列），这意味着可以进行类似的查询

```
SELECT * FROM users WHERE name LIKE 'João' 
```

查找具有`Joao`名称的行。

我知道可以使用[unaccent_string](http://wiki.postgresql.org/wiki/Strip_accents_from_strings,_and_output_in_lowercase) contrib 函数从 PostgreSQL 中的字符串中去除重音符号，但我想知道 PostgreSQL 是否支持这些“重音不敏感”排序规则，所以`SELECT`上面的方法可以工作。

* * *

## 回答 #1

> 赞同：250
> 
> 时间：2012-06-13T01:51:07.453

为此使用[**unaccent 模块**](https://www.postgresql.org/docs/current/unaccent.html)- 这与您链接的内容完全不同。

> unaccent 是一个文本搜索字典，可以从词位中删除重音符号（变音符号）。

每个数据库安装一次：

```
CREATE EXTENSION unaccent; 
```

如果您收到如下错误：

> ```
> ERROR: could not open extension control file
> "/usr/share/postgresql/<version>/extension/unaccent.control": No such file or directory 
> ```

按照相关答案中的说明在您的数据库服务器上安装 contrib 包：

*   [在 PostgreSQL 上创建非重音扩展时出错](https://stackoverflow.com/questions/12100638/error-when-creating-unaccent-extension-on-postgresql)

除其他外，它提供了`unaccent()`您可以在示例中使用的功能（`LIKE`似乎不需要）。

```
SELECT *
FROM   users
WHERE  unaccent(name) = unaccent('João'); 
```

## 指数

[要为此类查询使用索引，请在表达式上](https://www.postgresql.org/docs/current/indexes-expressional.html)创建索引。**但是**，Postgres 只接受`IMMUTABLE`索引函数。如果函数可以为相同的输入返回不同的结果，则索引可能会静默中断。

### `unaccent()`只是`STABLE`没有`IMMUTABLE`

不幸的是，`unaccent()`只是`STABLE`，不是`IMMUTABLE`。根据[pgsql-bugs 上的这个线程](https://www.postgresql.org/message-id/flat/201012021544.oB2FiTn1041521@wwwmaster.postgresql.org#201012021544.oB2FiTn1041521@wwwmaster.postgresql.org)，这是由于*三个*原因：

1.  这取决于字典的行为。
2.  这本词典没有硬连线连接。
3.  因此它也取决于电流`search_path`，它很容易改变。

[网络上的一些教程](https://django-orm.readthedocs.org/en/latest/orm-pg-fulltext.html)指示只需将函数波动性更改为`IMMUTABLE`. 这种蛮力方法可以在某些条件下破坏。

其他人建议一个[简单的`IMMUTABLE`包装函数](https://www.postgresql.org/message-id/flat/CAANrE7rpWjvZgdKX_hArNp8ynUezZ-Ehp8QEqC7hwfXuNqa91g@mail.gmail.com#CAANrE7rpWjvZgdKX_hArNp8ynUezZ-Ehp8QEqC7hwfXuNqa91g@mail.gmail.com)（就像我过去自己做的那样）。

是否使用两个显式声明使用的字典的[参数](https://www.postgresql.org/docs/12/unaccent.html#id-1.11.7.52.7) 来制作变体一直存在争议。`IMMUTABLE`阅读[这里](https://www.postgresql.org/message-id/flat/20120826134701.GM10814@momjian.us#20120826134701.GM10814@momjian.us)或[这里](https://www.postgresql.org/message-id/flat/CAFj8pRDi0LRcmgyvd0ttC9J=VwOxe094fVRG2KTR_AQC86y-wg@mail.gmail.com#CAFj8pRDi0LRcmgyvd0ttC9J=VwOxe094fVRG2KTR_AQC86y-wg@mail.gmail.com)。

另一种选择是这个模块，它[具有由 Musicbrainz提供的](https://github.com/metabrainz/postgresql-musicbrainz-unaccent)[IMMUTABLE`unaccent()`](https://github.com/metabrainz/postgresql-musicbrainz-unaccent)功能，在 Github 上提供。自己没有测试过。我想我想出了一个***更好的主意***：

# 现在最好

这种方法**比其他解决方案更有效，也更安全**。
创建一个`IMMUTABLE`SQL 包装函数，使用硬连线的模式限定函数和字典执行两参数形式。

由于嵌套非不可变函数会禁用函数内联，因此它基于 C 函数的副本，（假的）也声明`IMMUTABLE`了。它的*唯一*目的是在 SQL 函数包装器中使用。不打算单独使用。

需要复杂性，因为无法在 C 函数的声明中硬连线字典。（需要破解 C 代码本身。）SQL 包装函数执行此操作，并允许函数内联*和*表达式索引。

```
CREATE OR REPLACE FUNCTION public.immutable_unaccent(regdictionary, text)
  RETURNS text LANGUAGE c IMMUTABLE PARALLEL SAFE STRICT AS
'$libdir/unaccent', 'unaccent_dict';

CREATE OR REPLACE FUNCTION public.f_unaccent(text)
  RETURNS text LANGUAGE sql IMMUTABLE PARALLEL SAFE STRICT AS
$func$
SELECT public.immutable_unaccent(regdictionary 'public.unaccent', $1)
$func$; 
```

从 Postgres 9.5 或更早版本的两个函数中删除`PARALLEL SAFE`。

`public`是您安装扩展的架构（`public`是默认值）。

显式类型声明 ( `regdictionary`) 可防御恶意用户使用函数的重载变体进行的假设攻击。

[*之前，我提倡基于unaccent 模块附带的`STABLE`函数的包装函数。`unaccent()`那个禁用的[函数内联](https://wiki.postgresql.org/wiki/Inlining_of_SQL_functions)。这个版本的执行速度比我之前在这里的简单包装函数**快十倍。**
这已经是添加到函数中的第一个版本的两倍`SET search_path = public, pg_temp`——直到我发现字典也可以是模式限定的。[仍然（Postgres 12）从文档中不太明显。](https://www.postgresql.org/docs/12/unaccent.html#id-1.11.7.52.7)*]

**如果**您缺乏创建 C 函数所需的权限，那么您将回到第二好的实现：模块提供`IMMUTABLE`的函数的函数包装器`STABLE` `unaccent()`：

```
CREATE OR REPLACE FUNCTION public.f_unaccent(text)
  RETURNS text AS
$func$
SELECT public.unaccent('public.unaccent', $1)  -- schema-qualify function and dictionary
$func$  LANGUAGE sql IMMUTABLE PARALLEL SAFE STRICT; 
```

最后，使查询*快速的***表达式索引**：

 *```
CREATE INDEX users_unaccent_name_idx ON users(public.f_unaccent(name)); 
```

请记住在对函数或字典进行任何更改后**重新创建涉及此函数的索引**，例如不会重新创建索引的就地主要版本升级。最近的主要版本都对该`unaccent`模块进行了更新。

调整查询以匹配索引（因此查询计划器将使用它）：

```
SELECT * FROM users
WHERE  f_unaccent(name) = f_unaccent('João'); 
```

您不需要正确表达式中的函数。在那里，您还可以`'Joao'`直接提供无重音字符串。

**[使用表达式 index](https://www.postgresql.org/docs/current/indexes-expressional.html)**，更快的函数不会转换为更快的查询。这在预先计算的值上运行，并且已经非常快了。但是不使用索引的索引维护和查询有好处。

Postgres 10.3 / 9.6.8 等版本加强了客户端程序的安全性。您*需要*对函数和字典名称进行模式限定，如在任何索引中使用时所示。看：

*   [postgres 日志中的“文本搜索字典“unaccent”不存在”条目，据说是在自动分析期间](https://dba.stackexchange.com/questions/202490/text-search-dictionary-unaccent-does-not-exist-entries-in-postgres-log-supp?noredirect=1#comment421020_202490)

### 连字

在 Postgres **9.5 或更早版本**中，像 'Œ' 或 'ß' 之类的连字必须手动扩展（如果需要），因为`unaccent()`总是替换*单个*字母：

```
SELECT unaccent('Œ Æ œ æ ß');

unaccent
----------
E A e a S 
```

在 Postgres **9.6**中，您会喜欢[这个不重音的更新](https://www.postgresql.org/message-id/flat/201012021544.oB2FiTn1041521@wwwmaster.postgresql.org#201012021544.oB2FiTn1041521@wwwmaster.postgresql.org)：

 **> 扩展`contrib/unaccent`的标准`unaccent.rules`文件以处理 Unicode 已知的所有变音符号，并**正确扩展连字**(Thomas Munro, Léonard Benedetti)

大胆强调我的。现在我们得到：

```
SELECT unaccent('Œ Æ œ æ ß');

unaccent
----------
OE AE oe ae ss 
```

### 模式匹配

对于**`LIKE`**或**`ILIKE`**具有任意模式，将其与[**`pg_trgm`**](https://www.postgresql.org/docs/current/pgtrgm.html)PostgreSQL 9.1 或更高版本中的模块结合使用。创建三元组 GIN（通常更可取）或 GIST 表达式索引。杜松子酒的例子：

```
CREATE INDEX users_unaccent_name_trgm_idx ON users
USING gin (f_unaccent(name) gin_trgm_ops); 
```

可用于以下查询：

```
SELECT * FROM users
WHERE  f_unaccent(name) LIKE ('%' || f_unaccent('João') || '%'); 
```

GIN 和 GIST 索引的维护成本比普通 btree 高：

*   [GiST和GIN索引的区别](https://stackoverflow.com/questions/28975517/difference-between-gist-and-gin-index/28976555#28976555)

对于左锚模式有更简单的解决方案。有关模式匹配和性能的更多信息：

*   [在 PostgreSQL 中使用 LIKE、SIMILAR TO 或正则表达式进行模式匹配](https://dba.stackexchange.com/a/10696/3684)

`pg_trgm`[还为“相似性”（`%`）和“距离”（`<->`）](https://www.postgresql.org/docs/current/pgtrgm.html#PGTRGM-OP-TABLE)提供了有用的运算符。

Trigram 索引还支持简单的正则表达式`~`等。和**不区分大小写**的模式匹配`ILIKE`：

*   [PostgreSQL 重音 + 不区分大小写的搜索](https://stackoverflow.com/questions/28627951/postgresql-accent-case-insensitive-search/28636000#28636000)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-05-30T01:33:17.413

# 不，PostgreSQL 不支持这种意义上的排序规则

PostgreSQL 不支持这样的排序规则（不区分重音或不区分重音），因为除非事物是二进制相等的，否则没有比较可以返回相等。这是因为在内部它会为哈希索引之类的东西引入很多复杂性。出于这个原因，严格意义上的排序规则**只影响排序**而不影响相等。

# 解决方法

## 不含重音词位的全文搜索字典。

对于 FTS，您可以使用定义自己的字典`unaccent`，

```
CREATE EXTENSION unaccent;

CREATE TEXT SEARCH CONFIGURATION mydict ( COPY = simple );
ALTER TEXT SEARCH CONFIGURATION mydict
  ALTER MAPPING FOR hword, hword_part, word
  WITH unaccent, simple; 
```

然后您可以使用功能索引对其进行索引，

```
-- Just some sample data...
CREATE TABLE myTable ( myCol )
  AS VALUES ('fóó bar baz'),('qux quz');

-- No index required, but feel free to create one
CREATE INDEX ON myTable
  USING GIST (to_tsvector('mydict', myCol)); 
```

您现在可以非常简单地查询它

```
SELECT *
FROM myTable
WHERE to_tsvector('mydict', myCol) @@ 'foo & bar'

    mycol    
-------------
 fóó bar baz
(1 row) 
```

也可以看看

*   [在字段上创建不区分大小写和重音/变音符号的搜索](https://dba.stackexchange.com/a/177044/2639)

## 本身不重音。

该[`unaccent`模块](https://www.postgresql.org/docs/current/static/unaccent.html)也可以在没有 FTS 集成的情况下单独使用，查看[Erwin 的答案](https://stackoverflow.com/a/11007216/124486)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T21:54:48.687

我很确定 PostgreSQL 依赖于底层操作系统进行排序。它*确实*支持[创建新排序规则](http://www.postgresql.org/docs/9.1/static/sql-createcollation.html)和[自定义排序规则](http://archives.postgresql.org/pgsql-hackers/2010-10/msg02063.php)。不过，我不确定这对你来说有多少工作量。（可能很多。）***

# python - 详细的 SQL 查询，count(*) 限制器不起作用

> ID：11005040
> 
> 赞同：1
> 
> 时间：2012-06-12T21:19:41.057
> 
> 标签：python, mysql, mysql-python

恐怕我在 SQL 方面并没有什么大的动摇，所以我对此有问题并不感到惊讶，但如果你能帮助我让它工作（甚至不必是一个查询），我会很感激。试图在 Python 中使用 MySQLdb 分析一些 Twitter 数据，我正在运行：

```
for u_id in list:
"
select e.user_id
from table_entities e
inner join table_tweets t on e.id = t.id
where e.type='mention' and t.user_id=%s
group by e.type having count('hashtag') < 3
"
%
(u_id) 
```

（python 语法稍微伪造以不显示不重要的东西）

现在，“group by”语句之前的所有内容都可以正常工作。我能够提取给定推文中提到的 user_ids（id 是 table_tweets 的 PK，而 table_entities 中每个提及、主题标签或 URL 都有另一行）匹配我循环的当前位置。

但是——而且我认为我没有正确地格式化它—— group by 语句没有做任何事情。我的意思是排除所有属于推文（ids）的user_ids，这些user_ids 在table_entity 中有3 个或更多条目，type=hashtag。我可以说它不会按原样工作，因为它实际上并不引用 id 列，而是我尝试过的任何方式（例如，通过尝试使其成为 join 子句的一部分）引发语法错误。

建议表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:29:24.690

这并没有真正做到你想要的。

```
select e.user_id
from table_entities e
inner join table_tweets t on e.id = t.id
where e.type='mention' and t.user_id=%s
group by e.type having count('hashtag') < 3 
```

*   Select And group by 子句没有达到您的预期。通过放入`e.user_id`SELECT 子句而不是 GROUP BY MySQL 将为每个 e.type 选择一个任意的 user_id。
*   `Having count('literalString')`相当于`Having COUNT(*)` 您可以通过将 Count('hashtag') 移动到 select 子句自己看到这一点。

这是这些点的[现场演示](http://sqlfiddle.com/#!2/ad7bb/2)

结果是您的查询将仅在用户提及少于 3 次时才记录。

有很多方法可以完成你正在尝试的我选择 IN （你也可以使用 Exists 或 INNER JOIN 到子查询）

```
SELECT e.user_id 
FROM   table_entities e 
       INNER JOIN table_tweets t 
               ON e.id = t.id 
WHERE  e.type = 'mentions' 
       AND t.user_id =% s 
       AND e.user_ID  IN (SELECT e.user_id 
                             FROM   table_entities e 
                                    INNER JOIN table_tweets t 
                                            ON e.id = t.id 
                             WHERE  e.type = 'hashtag' 
                                    AND t.user_id =% s 
                             GROUP  BY e.user_id 
                             HAVING Count(*) >= 3) 
```

子选择查找 table_enties 中具有少于 3 条记录且 e.type 为“hashtag”的所有用户 ID 以及匹配的用户`% s`

'提及'和用户ID的主要选择过滤器。这使您可以选择一个 e.type 并根据另一个 e.type 的计数进行过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:31:36.603

我认为您错误地解析了我的帖子的一部分（我的错，因为它有点混乱）—— user_id 列仅在 type='mention' 时填充。我试图通过*id*列进行限制。也就是说，多亏了您的帮助，我才能让它工作！

```
select e.user_id
from table_entities e
inner join table_tweets t on e.id = t.id
where e.type='mention' and
e.id in
(select e.id
from table_entities e
where e.type='hashtag' group by e.id having count(*) < 3) 
```

我决定将它移到 for u_id in list 循环的上方，因为查询现在需要一段时间才能运行，但我可以在这里很好地处理列表输出。谢谢！

# c# - Facebook C# SDK 授权失败：IsSecureConnection = False

> ID：11005041
> 
> 赞同：0
> 
> 时间：2012-06-12T21:19:41.997
> 
> 标签：c#, facebook, ssl, authorization, facebook-c#-sdk

我正在开发一个 Facebook 画布应用程序：

1.  视觉工作室 2010
2.  .NET 框架 4.0.30319 RTMrel
3.  Facebook C# SDK 版本 5.0/5.5
4.  Windows 7家庭高级版

（我很抱歉，我试图包含图片，但 stackoverflow 拒绝了我，因为我没有足够的帖子......）

我有一个解决方案，其中包括画布应用程序以及 Facebook 和 Facebook.Web 项目的网站。

我已经获得了证书（godaddy.com）并安装了。

我已经为端口 443 添加了 https 绑定。

我已将默认站点和我的虚拟目录设置为使用 SSL。

我已经在 Facebook 应用设置页面和 web.config 文件中设置了secureCanvas URL。

因此，我的解决方案编译完成，ASP.NET 页面显示在 Facebook 画布上，但无法授权。

当我单步执行代码时，FacebookWebContext.IsSecureConnection 返回“False”，因为 _httpContext.Request.Url.Scheme 是“http”。

我已经阅读了另一篇关于产生此问题的 SDK 5.0 版的错误的帖子，因此我将我的项目更新到了 5.5 版。仍然没有喜悦。

我错过了什么？如有任何建议，我将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:58:21.503

根据来源[https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/blob/master/Source/Facebook/FacebookClient.cs](https://github.com/facebook-csharp-sdk/facebook-csharp-sdk/blob/master/Source/Facebook/FacebookClient.cs)（第157行）IsSecureConnection是

> 获取或设置指示是否在每个请求中添加 return_ssl_resource 作为默认参数的值。

你可以设置它。参见示例（第 73 行）： [https ://github.com/facebook-csharp-sdk/facebook-canvas-aspnet-sample/blob/master/src/facebook-canvas-aspnet-sample/App_Start/NinjectMVC3.cs](https://github.com/facebook-csharp-sdk/facebook-canvas-aspnet-sample/blob/master/src/facebook-canvas-aspnet-sample/App_Start/NinjectMVC3.cs)

希望它有所帮助。[您也可以在https://stackoverflow.com/questions/tagged/facebook-c%23-sdk](https://stackoverflow.com/questions/tagged/facebook-c%23-sdk)上提问

# r - 重复汇总数据框中的一组特定行

> ID：11005042
> 
> 赞同：1
> 
> 时间：2012-06-12T21:19:55.703
> 
> 标签：r, data.table

我有以下内容：

像数据框中行的哈希一样工作的环境。例如，环境“inc”具有键“hello”`get("hello", envir = inc)`并将返回“row1”“row2”“row50”，其中这些是数据框中行的名称。在为环境中的键选择这些行后，我想对它们执行 colSums。

该环境大约有 400,000 个条目，我想根据这些 colSums 创建一个包含 400,000 行的新数据框。我的工作代码基本上使用 lapply/foreach 来执行此操作，并且我已经在一小部分数据上使用了它……但是速度非常慢。如...它已经使用 doMC 在 3 个内核上运行了 20 分钟，但仍未完成。这是代码：

```
incCounts <- foreach(key = ls(inc)) %dopar% {
       transNames <- get(key, envir = inc)
       transCounts <- df[transNames, ]
       if ( ! is.null(dim(transCounts)) )
           transCounts <- colSums(transCounts)
       return(transCounts)
}
incCounts <- as.data.frame(t(simplify2array(incCounts))) 
```

编辑：这是我试图用 data.frame 和 data.table 做的一个例子：

```
library(data.table)
set.seed(20)
transEnv <- new.env(hash = TRUE)
assign("hash1", paste("trans", 2:4, sep = ""), envir = transEnv)
assign("hash2", paste("trans", c(1, 3), sep = ""), envir = transEnv)

df <- data.frame(matrix(rnorm(5 * 4), nrow = 4, ncol = 5))
rownames(df) <- paste("trans", 1:4, sep = "")
colSums(df[transEnv$hash1, ]) # what I want
       X1         X2         X3         X4         X5 
0.9476963 -3.2149230  0.7603257 -1.8494967  1.7569055

dt <- data.table(trans = rownames(df), df)
setkey(dt, trans)

# This isn't working as I expected... 
dt[transEnv$hash1, list(sum(X1), sum(X2), sum(X3), sum(X4), sum(X5))]

      trans         V1         V2         V3        V4         V5
[1,] trans2 -0.1444402 -1.4720633 -0.6135086  1.108451 1.24556891
[2,] trans3  0.7222297 -0.5961595 -0.2163115 -1.097342 0.08785472
[3,] trans4  0.3699069 -1.1467001  1.5901458 -1.860606 0.42348190 
```

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T13:58:31.333

可能适合[`data.table`](http://datatable.r-forge.r-project.org/). 请参阅[wiki 点 5](http://rwiki.sciviews.org/doku.php?id=packages:cran:data.table)和[这个答案](https://stackoverflow.com/questions/4322219/whats-the-fastest-way-to-merge-join-data-frames-in-r/4483202#4483202)。如果您确实尝试过，请从`vignette('datatable-intro')`.

```
DT[,lapply(.SD,sum),by=grp] 
```

要回答编辑，相关部分`?data.table`是：

> 高级：将已知组的一个子集的聚合在传递这些组时特别有效`i`。当`i`是 a`data.table`时，`DT[i,j]`计算`j`的每一行`i`。我们将其称为不带 by 或 grouping by `i`。

所以而不是

```
dt[transEnv$hash1, list(sum(X1), sum(X2), sum(X3), sum(X4), sum(X5))] 
```

尝试 ：

```
dt[transEnv$hash1, list(sum(X1),sum(X2),sum(X3),sum(X4),sum(X5)), mult="last"] 
```

或者，

```
dt[transEnv$hash1][, list(sum(X1), sum(X2), sum(X3), sum(X4), sum(X5))] 
```

或者，

```
dt[transEnv$hash1,lapply(.SD,sum),by="",.SDcols=names(dt)[-1]] 
```

或者，

```
dt[transEnv$hash1][,trans:=NULL][,sapply(.SD,sum)] 
```

# java - 一次导入eclipse中的所有导入？

> ID：11005043
> 
> 赞同：44
> 
> 时间：2012-06-12T21:20:04.083
> 
> 标签：java, android, eclipse, import

好的，我最近开始学习 Java/Android，所以我查了很多教程并做了很多复制/粘贴，但大多数时候教程没有导入导入，所以我必须点击下线所有的错误然后导入这个，导入那个，导入别的东西！所以......我的问题：有没有办法一次导入所有这些？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-06-12T21:23:05.553

在 Windows 上，您可以使用：++`Ctrl`这 是组织导入的快捷方式`shift``o`

在 Mac 上是`Command`++ （感谢 orip `Shift`）`O`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-22T18:22:43.767

使用：++`Ctrl`查看 可用的快捷键列表`shift``L`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T21:25:02.907

有些类具有相同的名称但做不同的工作。看看有多少班`Date`。起初这看起来不舒服，但你会很快习惯。您可以自动组织导入，在 NetBeans 中我使用`Ctrl`++`shift`热键`i` 。其他IDE中必须有模拟。

导入整个包（像这样：）`java.util.*`也是一种不好的做法

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-12T21:28:32.703

您在 Eclipse 上有一些快捷方式，请查看此页面。

[http://www.allapplabs.com/eclipse/eclipse_shortcuts.htm](http://www.allapplabs.com/eclipse/eclipse_shortcuts.htm)

我希望它对你有帮助，你有他们和其他人之前命名的快捷方式。

对不起，我的英语希望对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-11T06:22:20.123

`alt(option) + enter(return)`适用于mac系统中的Android Studio。

# python - 删除具有多对多关系的行

> ID：11005044
> 
> 赞同：0
> 
> 时间：2012-06-12T21:20:04.033
> 
> 标签：python, orm, sqlalchemy

我有两张桌子，`image`和`restaurant`。我已经在它们之间建立了多对多的关系。

以下是表定义的相关部分：

```
images_assoc = Table('restaurant_image_assoc', Base.metadata,
        Column('restaurant', Integer(unsigned=True),
            ForeignKey('restaurant.id')),
        Column('image', Integer(unsigned=True),
            ForeignKey('image.id')))

class Image(Base):
    __tablename__ = 'image'
    id = Column(Integer(unsigned=True), primary_key=True)
    reports = Column(TinyInt, nullable=False, default=0)
    created_at = Column(DateTime, default=datetime.now)

class Restaurant(Base):
    __tablename__ = 'restaurant'
    id = Column(Integer(unsigned=True), primary_key=True)
    images = relationship(Image, secondary=images_assoc) 
```

我需要删除 中的一行，但当然我需要先删除指向它`image`的所有行。`restaurant_image_assoc`我该怎么做呢？

我试过这个：

```
request.db.query(images_assoc)\
        .filter(images_assoc.c.image==image.id).delete()
request.db.delete(image)
request.db.commit() 
```

`image`我要删除的行在哪里，但出现此错误：

```
AttributeError: 'Table' object has no attribute 'class_' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T08:51:35.990

The issue is that SA does not track the relationship between Restaurant and the Image from the side of the Image, and therefore it "does not know" that there is a dependency. As soon as you configure the relationship from the other side, the respective rows in the association table will be also deleted automatically. In order to add the other side of the relationship it is enough to simply use the `backref`:

```
class Restaurant(Base):
    images = relationship(Image, secondary=images_assoc, backref="restaurants") 
```

but you can also define those explicitly on each object (`back_populates` is required in this case):

```
class Image(Base):
    restaurants = relationship("Restaurant", secondary=images_assoc, back_populates="images")
class Restaurant(Base):
    images = relationship(Image, secondary=images_assoc, back_populates="restaurants") 
```

But the latter is semantically the same as using `backref`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:36:05.413

如果您删除图像中的一行，您应该获得该图像 ID。然后你可以在你的关联表中删除图像 id == 你的图像 id。

# cocos2d-iphone - 确定 CCLabelTTF 的尺寸

> ID：11005045
> 
> 赞同：5
> 
> 时间：2012-06-12T21:20:11.367
> 
> 标签：cocos2d-iphone

我正在创建一个 CCLabelTTF 而不指定大小。initWithString:fontName:fontSize：将尺寸设置为 CGSizeZero，以便自动确定尺寸以适合指定的文本。

但是，我想稍后找出最终的大小。我对宽度最感兴趣。

如何确定标签的实际尺寸？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T21:59:36.183

There are two properties you can look at in the texture, which gets updated every time you set a new string or change font-size, etc.

*   `yourTTFLabel.texture.contentSizeInPixels`

or

*   `yourTTFLabel.texture.contentSize` (in points)

# java - 流行的 Java REST 服务框架

> ID：11005050
> 
> 赞同：-2
> 
> 时间：2012-06-12T21:20:41.180
> 
> 标签：java, rest

什么是流行的 Java REST 服务框架？基本上 WCF 相当于 Java 的 REST 服务？

我认为 javax 之上的 JAX-RS 和 DropWizard 就是其中的一部分。还有更多还是这些是主要的？

编辑：

我发现最好的是dropwizard。虽然和其他人一样，但它非常包含[http://dropwizard.codahale.com/](http://dropwizard.codahale.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:31:35.263

您正在寻找的是 JAX-RS。其实现包括：

*   Jersey（来自 Oracle 的参考实现）
*   阿帕奇 CXF
*   高枕无忧
*   雷斯特莱特

也许还有更多。我只提到了最受欢迎的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-08-07T06:01:26.353

我发现 Jersey 既稳定又有用（满足大部分需求），可以在 Internet 上提供很少的服务器端应用程序。我使用 Jersey 让 Web 和 Android 客户端可以使用部署在 Google App Engine 上的自定义 Java 服务。自过去 2 年多以来，其中一些服务完全没有问题。在部署生产/企业质量软件时，我特别喜欢这种稳定性。

我最喜欢的……</p>

1.  超级稳定……自过去 2 年多以来绝对没有问题。
2.  将服务器端与客户端解耦非常容易。这对我来说尤其重要。在 UI 方面，每 6 个月就会发生一次令人惊叹的漂亮创新……在 Web UI 和 Native UI（在我的例子中是 Android）中。不断需要更新 UI。在这种情况下，不必担心在服务器端进行更改是一件幸事。
3.  使现有的 Java 服务在线可用同样容易。我只需要通过对内部类的有限调用来创建外部包装器（使用 Jax-RS 注释）。将它们部署到 Google App Engine……就是这样。

# qt - OpenGL——如何使用 gluLookAt 移动场景以响应鼠标输入

> ID：11005051
> 
> 赞同：1
> 
> 时间：2012-06-12T21:20:43.317
> 
> 标签：qt, opengl, glulookat

我在 Qt 中通过 OpenGL 使用 OpenGL `QGLWidget`，并且我正在尝试实现一些基本的鼠标和键盘驱动的交互。

例如，键盘方向键将用于“平移”场景，鼠标滚轮用于放大场景，鼠标用于旋转模型。

我已经想出了如何实现平移和缩放，但是在实现旋转时遇到了麻烦。

这是我到目前为止所拥有的：

```
void MyGLWidget::paintGL() {
    glLoadIdentity();
    gluLookAt(0+camDelta[0],0+camDelta[1],-100+camDelta[2],centerCoords[0]+lookAtDelta[0],centerCoords[1]+lookAtDelta[1],centerCoords[2]+lookAtDelta[2],0,1,0);
    // draw stuff here
} 
```

所以基本上我设置了初始`gluLookAt`参数，然后我添加了两个数组`float camDelta[3]`和`float lookAtDelta[3]`，以跟踪相机位置的变化以及它正在寻找的位置以响应用户与场景的交互。

对于鼠标滚轮，我这样做：

```
void MyGLWidget::wheelEvent(QWheelEvent *event) {
    camDelta[2] += (event->delta() / 8.0 / 15.0) * WHEEL_DELTA;
    lookAtDelta[2] += (event->delta() / 8.0 / 15.0) * WHEEL_DELTA;
    updateGL();
} 
```

同样在 中`MyGLWidget::keyPressEvent`，我修改了用于左右平移的 deltas 字段，以及用于上下平移的 deltas'`[0]`字段。`[1]`

所以我的问题是，我如何实现类似的东西来支持鼠标旋转？我有点困惑，因为我猜我不仅要改变相机的视线方向，还要改变向上的向量，但我对如何做到这一点并不清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T21:08:13.347

我为这样的事情所做的就是所谓的轨道相机模型。

您可以跟踪摄像机目标位置（或观察方向）和 3 个其他参数：方位角、偏角（或倾角）和距离（或半径）。方位角是相机围绕目标水平旋转的角度（就好像目标在地面上，而您一边看着它一边绕着它走一圈）。偏角是垂直旋转。距离就是目标和相机之间的距离。

这些也称为球坐标：

[http://mathworld.wolfram.com/SphericalCoordinates.html](http://mathworld.wolfram.com/SphericalCoordinates.html)

你想要这样的方程：

```
x = r * sin(phi) * cos(theta)
y = r * sin(phi) * sin(theta)
z = r * cos(phi) 
```

其中 r 是距离，theta 是方位角，phi 是偏角。这为您提供了从相机观察位置到相机位置的偏移量。

所以这就是你要做的。保留相机目标位置，但不保留相机位置。平移相机时，移动目标位置。旋转相机时，调整方位角和偏角。变焦相机时，调整距离。然后，在调用 gluLookAt 之前的每一帧，使用上述公式计算相机位置。您只需将 x、y 和 z 添加到目标位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T21:29:12.227

最好的方法是使用四元数。就像复数在 2D 中旋转非常有用一样，四元数非常适合 3D 旋转。

标准的“围绕 x、y、z 轴旋转”可以工作，它的行为会很奇怪，而且不像预期的那样。

您可以在以下位置获得关于这一切的精彩教程：http://content.gpwiki.org/index.php/OpenGL:Tutorials: [Using_Quaternions_to_represent_rotation](http://content.gpwiki.org/index.php/OpenGL:Tutorials:Using_Quaternions_to_represent_rotation)

# c# - 带有 flexigrid 的资源字符串

> ID：11005053
> 
> 赞同：0
> 
> 时间：2012-06-12T21:20:52.753
> 
> 标签：c#, asp.net-mvc-3, flexigrid

我刚刚开始使用`flexigrid`并想使用资源字符串来显示列，但由于某种原因它不起作用。

像这样：

```
{ display: @Resources.stringname, name: 'number',
                                  width: 200, sortable: false, align: 'left' }, 
```

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:29:20.047

我想我忘了用像这样的单引号'@Resources.stringname'。这就是诀窍。

# c# - 使用 ClickOnce 运行程序，而不是安装它

> ID：11005054
> 
> 赞同：2
> 
> 时间：2012-06-12T21:20:55.477
> 
> 标签：c#, clickonce

我希望我的 ClickOnce 项目在不安装游戏的情况下立即运行，因为它只是一个简单的“展示”游戏，我真的不想强迫版主事后必须从控制面板中卸载它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T21:24:49.480

ClickOnce 专为安装和简化应用程序的未来更新而设计。如果您希望有人打开您的应用程序而不安装它，只需给他们您的 exe。（假设你没有 dll ......如果你有，那么也包括它们）。

您可以在项目文件夹\Debug 或 \Release 中找到它们（取决于您已编译的目录）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:23:17.787

在 Visual Studio 中，选择使应用程序仅在线可用的选项。然后，在启动时，应用程序将每次都下载新鲜，而不是安装在本地。

您使用 ClickOnce 是否有特定原因？

# ruby-on-rails - 导轨中的链接检查器

> ID：11005055
> 
> 赞同：0
> 
> 时间：2012-06-12T21:21:02.990
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, net-http

我将以下内容存储在 rake 任务中。基本上，如果来自 url 的响应代码不是 200，我需要将“已发布”属性从 1 更新为 0。当我运行此命令时，我得到：`undefined method 'request_uri' for #<URI::Generic:0x00000102136408 URL:url>`

```
desc "Problem products"
task :update_broken_links => :environment do
  require 'net/http'

  Product.find(:all, :conditions =>["published = ? AND feed_id = ?", '1', 820]).each do |product|
    url = product.url 
    uri = URI('url')
    response = Net::HTTP.get_response(uri)
    x = response.code.to_i    

    if x != 200
      published = '0'
    else
      published = product.published
    end

    product.update_attribute(:publsihed, publsihed) 

  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:26:48.247

您`uri = URI('url')`需要将其更改为`uri = URI(url)`. 您当前的代码正在尝试将字符串`'uri'`转换为 URI，而不是使用`uri`变量的内容。

`product.update_attribute(:publsihed, publsihed)`一旦你到达那里，你也会在接近尾声时遇到问题。你有一个错字：'publsihed' 而不是 'published'。

# c# - 使用 Aforge.Net 将灰度图像转换为黑白图像

> ID：11005067
> 
> 赞同：5
> 
> 时间：2012-06-12T21:21:31.167
> 
> 标签：c#, image-processing, grayscale, aforge

我对 Aforge.Net 很陌生，我正在寻找一种将灰度图像转换为黑白的方法。我真的找不到任何支持吗？

通过应用灰度滤镜，我设法将普通图像转换为灰度图像。但我找不到任何关于黑白转换的信息

有人可以帮我一把吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-12T23:22:16.457

使用阈值类将图像转换为黑白。

```
 // create filter
Threshold filter = new Threshold( 100 );
// apply the filter
filter.ApplyInPlace( image ); 
```

Threshold Class 的详细信息可以在[Aforge](http://www.aforgenet.com/framework/docs/html/503a43b9-d98b-a19f-b74e-44767916ad65.htm)中找到。

过滤器使用指定的阈值进行图像二值化。所有强度等于或高于阈值的像素都被转换为白色像素。强度低于阈值的所有其他像素都将转换为黑色像素。过滤器接受 8 和 16 bpp 灰度图像进行处理。注意：由于过滤器可应用于 8 bpp 和 16 bpp 图像，因此应将 ThresholdValue 值设置为像素格式。在 8 bpp 图像的情况下，阈值在 [0, 255] 范围内，但在 16 bpp 图像的情况下，阈值在 [0, 65535] 范围内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-12T21:51:02.657

试试这三种**阈值**技术。链接中给出了示例片段。

大津：[http ://www.aforgenet.com/framework/docs/html/b2bd54da-46c2-cb64-3577-0962d8f56554.htm](http://www.aforgenet.com/framework/docs/html/b2bd54da-46c2-cb64-3577-0962d8f56554.htm)

SIS：[http ://www.aforgenet.com/framework/docs/html/39e861e0-e4bb-7e09-c067-6cbda5d646f3.htm](http://www.aforgenet.com/framework/docs/html/39e861e0-e4bb-7e09-c067-6cbda5d646f3.htm)

迭代：[http ://www.aforgenet.com/framework/docs/html/e01406a7-511d-ae4d-79b6-5f7eba523824.htm](http://www.aforgenet.com/framework/docs/html/e01406a7-511d-ae4d-79b6-5f7eba523824.htm)

我相信这些链接会让您更多地了解将灰度图像转换为黑白图像，这就是所谓的*二值化*。

# ant - 是否可以在 Ant 属性文件中抑制自动时间戳？

> ID：11005068
> 
> 赞同：1
> 
> 时间：2012-06-12T21:21:36.487
> 
> 标签：ant, netbeans-7

当我在 Netbeans 中编译我的项目时，我想自动生成一个包含自动递增和日期的内部版本号的文件，因此我将以下内容添加到我的项目 build.xml 文件中。

```
<target name="-pre-jar" >
    <propertyfile file="${src.dir}\buildstring.txt" >
        <entry key="devbuild" value="1" type="int" operation="+"/>
        <entry key="devbuildtime" type="date" value="now" pattern="yyyy MM dd hh_mm" />
    </propertyfile>
</target> 
```

当 Ant 任务执行时，Ant 自动添加一个日期戳作为文件的第一行

```
#Tue, 12 Jun 2012 16:09:24 -0500
devbuild=8
devbuildtime=2012 06 12 04_09 
```

有什么方法可以阻止 Ant 自动添加带有日期注释的第一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:06:20.710

[PropertyFile](http://ant.apache.org/manual/Tasks/propertyfile.html) Ant 任务是使用[java.util.Properties](http://docs.oracle.com/javase/6/docs/api/java/util/Properties.html)对象实现的。该`Properties.store()`方法记录在以下注释中：

> 接下来，总是写入一个注释行，由一个 ASCII # 字符、当前日期和时间（就好像由 Date 的 toString 方法生成的当前时间一样）和一个由 Writer 生成的行分隔符组成。

因此，无法使用`PropertyFile`任务禁用日期注释。删除日期注释将需要不同的解决方案，例如后处理属性文件或使用不同的技术（例如，使用 Ant 脚本或自定义 Ant 任务）编写属性文件。

请参阅：[删除属性文件 java 中的注释](https://stackoverflow.com/questions/6058638/remove-comments-in-properties-file-java)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-27T10:37:25.697

这是我的解决方案： 1\. 将属性写入临时文件 2\. 将临时文件复制到最终的属性文件中使用`filterchain`以跳过第一行 3\. 删除临时文件

```
<propertyfile file="temp.properties" >
    <entry  key="property.1" value="value1"/>
    <entry  key="property.2" value="value2"/>
</propertyfile>

<copy file="temp.properties" tofile="final.properties">
  <filterchain>
      <headfilter skip="1"/>
  </filterchain>
</copy>
<delete file="temp.properties"/> 
```

# jquery - 使用 jQuery 从 DropDownList 项目中删除一个选项

> ID：11005071
> 
> 赞同：1
> 
> 时间：2012-06-12T21:21:47.827
> 
> 标签：jquery, asp.net, html, html-select

我有一种情况，在某些情况下，下拉列表可以包含一个不可选择的默认值，一旦另一个值被更改，默认值就不再是一个选项。据我所知，这个概念本身并不存在，所以我试图用 jQuery 对其进行编码。所有具有此条件的 DropDownLists 都分配了一个类“valueSkippedHyperSwap”。需要删除的值是插入符号“^”。这是我所拥有的，但不起作用：

```
 $('.valueSkippedHyperSwap').change(function () {
        var node = $(this).has("value='^'");
        node.remove();
    }); 
```

根据人们的要求，这是 HTML，尽管我无法为我的世界弄清楚如何将其放入代码块中：

```
<!-- snip -->

<div class="questionItem">
<!-- snip -->
<select class="valueSkippedHyperSwap" id="answers_2__Answer" name="answers[2].Answer">
<option selected="selected" value="^">(^) Blank (skip pattern)</option>
<option value="0">(0) No</option>
<option value="1">(1) Yes</option>
<option value="-">(-) Not assessed</option>
</select></div>

<div class="questionItem">
<!-- snip -->
<select class="valueSkippedHyperSwap" id="answers_3__Answer" name="answers[3].Answer">
<option selected="selected" value="^">(^) Blank (skip pattern)</option>
<option value="0">(0) Clear speech-distinct intelligible words</option>
<option value="1">(1) Unclear speech-slurred or mumbled words</option>
<option value="2">(2) No speech-absence of spoken words</option>
<option value="-">(-) Not assessed</option>
</select></div>

<!-- snip --> 
```

这里要注意的关键事项之一是 valueSkippedHyperSwap 类名称的输入不止一个，因此在事件中，我们必须使用 $(this) 来确定正确的选项，不能再进行搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:30:27.290

假设你的 HTML 是这样的

```
<select id="dd" class="valueSkippedHyperSwap"> 
    <option value="^">None</option>
    <option value="1">One</option>
    <option value="2">Two</option>    
</select> 
```

`^`如果选择了任何其他选项，则以下脚本应删除具有值的项目

```
$(function(){

    $('.valueSkippedHyperSwap').change(function () {
       var item=$(this);
      if(item.val()!="^")
      {
        item.find("option[value='^']").remove();
      }
    });            

}); 
```

JsFiddle 示例[http://jsfiddle.net/He5gP/10/](http://jsfiddle.net/He5gP/10/)

# java - android 应用程序如何从基于 Django 的站点获取视图并查询数据库？

> ID：11005072
> 
> 赞同：1
> 
> 时间：2012-06-12T21:21:48.967
> 
> 标签：java, android, python, django, xml-rpc

android 应用程序可以从基于 Django 的站点获取视图和查询数据库的最佳方式是什么？

我正在使用 Django 框架开发一个网站。网络/移动服务带有一个 Android 应用程序，该应用程序对用户进行身份验证，从数据库中获取与用户相关的授权数据、地图位置和来自网站的视图，并将它们显示在 android 设备上。

到目前为止，我一直在考虑使用 XML-RPC 来执行此操作，但我不确定这是否是最佳解决方案。

对于 XML-RPC 客户端，我使用以下库： [http ://code.google.com/p/android-xmlrpc/](http://code.google.com/p/android-xmlrpc/)

对于我正在使用此 python 代码的服务器： [https ://code.djangoproject.com/wiki/XML-RPC](https://code.djangoproject.com/wiki/XML-RPC)

我想知道这样做是否有更好或标准的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:24:54.647

您应该为您的站点创建一个 API。使用 TastyPie 或活塞。您的 API 应该能够接受用户令牌以获取特定于用户的数据。

在您的 Android 应用程序中，让用户提供用户名和密码。您将用户名和密码发送到您网站的 API，然后返回一个令牌。从现在开始，Android 应用程序将使用该令牌访问 API。

这是一篇关于访问 API 和解析 JSON 输出的文章：[http ://www.androidhive.info/2012/01/android-json-parsing-tutorial/](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)

# python - Python subprocess.call 带参数

> ID：11005074
> 
> 赞同：0
> 
> 时间：2012-06-12T21:21:54.040
> 
> 标签：python, django, shell, subprocess

我正在尝试使用带有 args 的 python subprocess.call 来调用 shell 脚本。我所拥有的 args 没有被传递给 shell 脚本，但是脚本被调用没有问题。这就是我所拥有的

```
prepend = str(prepend)
print "prepend = " + str(prepend)
filename = str(request.FILES['mdbfile'])
print "filename = " + str(filename)
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__))
print "PROJECT_ROOT = " + str(PROJECT_ROOT)
filename = str(PROJECT_ROOT) + '/%s' % filename
print "full_filename = " + str(filename)
cmd = '%s/buildcsvs.sh' % (PROJECT_ROOT)
print "full_cmd = " + str(cmd)
p = subprocess.call([cmd, filename, prepend], shell=True)
output = p.stdout.read()
print output 
```

这是 shell 脚本的样子

```
#${1} is the file name, ${2} is the prepend code
echo "mdb-export ${1} TEAM > \"${2}team.csv\""
mdb-export ${1} TEAM > "${2}team.csv" 
```

这是输出的样子

```
prepend = 749176818
filename = 2011ROXBURY.mdb
PROJECT_ROOT = /Planner
full_filename = /Planner/2011ROXBURY.mdb
full_cmd = /Planner/buildcsvs.sh
Exception AttributeError: AttributeError("'_DummyThread' object has no attribute   '_Thread__block'",) in <module 'threading' from '/usr/lib/python2.7/threading.pyc'> ignored
mdb-export  TEAM > "team.csv"
Usage: mdb-export [options] <file> <table> 
```

有谁知道我做错了什么？谢谢 - 我感谢您的帮助

**编辑：** 现在，我有这个：

```
print "full_cmd = " + str(cmd)
args = "%s %s" % (filename, prepend)
print "full_args = " + str(args)
(out, err) = Popen(cmd,  stdin=PIPE, stdout=PIPE, stderr=PIPE, close_fds=True).communicate(args) 
```

并且看起来它没有成功完成对脚本的调用。

你知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T11:20:09.137

如果传递`shell=True`args 必须是字符串而不是列表：

```
In [4]: from subprocess import check_output

In [5]: check_output(['echo', '123'])
Out[5]: '123\n'

In [6]: check_output(['echo', '123'], shell=True)
Out[6]: '\n'

In [7]: check_output('echo 123', shell=True)
Out[7]: '123\n' 
```

**编辑：**而不是 using `call`and `p.stdout.read`you should use `Popen().communicate`, 这是为此目的而制作的，它有助于避免死锁。

**编辑²（上面编辑的答案）：**

```
cmd = ' '.join([cmd, args])
(out, err) = Popen(cmd,  stdin=PIPE, stdout=PIPE, stderr=PIPE, close_fds=True, shell=True).communicate(None) 
```

您必须将完整的命令行传递给`Popen`. 参数 to`communicate`将被写入`process.stdin`（`process`=`Popen`返回的内容）。

# scintilla - 为什么我从 scintillawrappers 演示项目中收到构建错误？

> ID：11005076
> 
> 赞同：1
> 
> 时间：2012-06-12T21:22:10.980
> 
> 标签：scintilla, scilexer.dll

`CScintillaCtrl`, `CScintillaView`&`CScintillaDoc` `v1.28`下载并在 VS 2005 中打开它，但是当我尝试构建它时，我收到了 100 多个与闪烁函数有关的错误；例子：

`scintillactrl.cpp(1129)`：`error C2065: 'SCI_MARKERSETBACKSELECTED : undeclared identifier ;`

为什么有些标识符无法识别，而其他标识符则无法识别`SCI_ADDTEXT`？

# javascript - 我可以在函数中使用什么来代替 document.write 以程序生成 html？

> ID：11005080
> 
> 赞同：1
> 
> 时间：2012-06-12T21:22:26.757
> 
> 标签：javascript, html

因此，由于堆栈溢出，我确定 document.write 每次运行时都会破坏我的网页/程序。我经常看到答案是使用 innerhtml 和 document.getElementById，但是，在以下情况下，我无法理解下面将如何使用它，因为您必须为它分配一个 id 来替换。我希望下面的整个内容在一个 div 中重绘。它所做的只是取出该数组，将其垂直吐出，并突出显示与变量“速度”匹配的数字。当您重新运行 speedcounter 函数时，该变量将发生变化，因此突出显示的数字也会发生变化。

有一个更好的方法吗？

并感谢您的关注。

```
function speedcounter() {

var spx;
var speed = 3;
var sp=["0","3","4","4","4","5","6","7","8"];

document.write('   <h2>Speed</h2></br>');
document.write('<input type="button" onclick="addspeed();" value="+"><br />');   

 for (spx=8; spx>=0; spx--) {
    if (spx == speed) { 
      document.write('<font color=#00FF00>');
     }
    document.write(sp[spx]); 
    document.write('<font color=#000000><br />');
    }
 document.write ('<input type="button" onclick="remspeed();" value="-">');    
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:26:11.820

有什么阻止你使用 jquery 吗？

以下链接使用 jquery 创建/附加 dom 元素。 [如何将 DOM 节点创建为对象？](https://stackoverflow.com/questions/759887/how-to-create-a-dom-node-as-an-object)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:34:18.817

如果您出于某种原因不想使用 jQuery，这里有一个仅限 javascript 的解决方案。

我创建了一个 div

```
<div id="speed"></div>​ 
```

然后使用`document.getElementById()`and`innerHTML`向其中添加 HTML。我保留了您的代码结构以说明如何完成。我`+=`用来添加到 div 中的现有 HTML。在函数的顶部，我清除它。如果你不这样做，每次调用函数时都会得到多个输出副本。

```
function speedcounter() {
document.getElementById('speed').innerHTML = "";
var spx;
var speed = 3;
var sp=["0","3","4","4","4","5","6","7","8"];

document.getElementById('speed').innerHTML += '<h2>Speed</h2></br>';
document.getElementById('speed').innerHTML += '<input type="button" onclick="addspeed();" value="+"><br />';

 for (spx=8; spx>=0; spx--) {
    if (spx == speed) { 
        document.getElementById('speed').innerHTML += '<span style="color:#00FF00">' + sp[spx] + '</span><br />';
    } else {
        document.getElementById('speed').innerHTML += sp[spx] + "<br />"; 
    }
 }
 document.getElementById('speed').innerHTML += '<input type="button" onclick="remspeed();" value="-">';    
}

speedcounter(); 
```

我还删除了您的`font`标签并将其替换为`span`内联 CSS 以设置颜色。

[演示](http://jsfiddle.net/JNx7b/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T21:33:38.647

可以`innerHTML`直接修改body的属性：

```
var body = document.getElementsByTagName('body')[0];
body.innerHTML += '<h2>Speed</h2></br>'; 
```

[http://jsfiddle.net/YB8HU/](http://jsfiddle.net/YB8HU/)

请记住，每次修改 时`innerHTML`，浏览器都会重新处理布局，因此请考虑将 HTML 字符串分配给变量，并在脚本末尾实际将其添加到正文中。

# android - 仅将字符串转换为时间？

> ID：11005081
> 
> 赞同：0
> 
> 时间：2012-06-12T21:22:26.967
> 
> 标签：android

我从数据库中获取一个字符串并将其转换为时间，例如 12:19，然后将其添加到时间选择器中。问题是它需要时间和日期，我似乎无法摆脱日期部分。我的代码如下

```
 public static final String TIME_FORMAT = "kk:mm";
    String StartTime = reminder.getString(reminder.getColumnIndexOrThrow(DatabaseStore.START_TIME));

 SimpleDateFormat dateTimeFormat = new SimpleDateFormat(TIME_FORMAT);
    startTime = dateTimeFormat.parse(StartTime); 

    addTimeTopicker.setTime(startTime); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:31:57.473

> 并渴望它进入时间，例如 12:19，然后我将它添加到时间选择器中

你的模式不好，你不能使用kk。

**所以你可以使用这些方法：**

```
public static final String TIME_FORMAT = "h:mm";
Result: 12:01 [h is hour in AM / PM (1-12)]

public static final String TIME_FORMAT = "k:mm";
Result: 12:01 [k is hour in day (1-24)] 
```

看看[SimpleDateFormat 模式](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:28:34.220

您没有告诉日期格式化程序使用您的特定格式：

```
Date d = new Date(timeString);
SimpleDateFormat sdf = new SimpleDateFormat("hh:mm aa");
String newtimeString = sdf.format(d); 
```

这将返回，例如：12:19 PM

# applescript - 在 AppleScript 中设置剪贴板的内容

> ID：11005086
> 
> 赞同：1
> 
> 时间：2012-06-12T21:22:40.867
> 
> 标签：applescript, clipboard

我想将剪贴板的内容设置为一个变量。我以前做过，应该很简单，但是我遇到了一个错误。

```
on checkiPadFinished()
    set tempiPadSerial to "b"
    tell application "System Events"
        tell process "iTunes"
            keystroke "c" using {command down}
            set tempiPadSerial to the clipboard as string
            if firstiPadSerial is tempiPadSerial then
                return true
            else if firstiPadSerial is "a" then
                set firstiPadSerial to the clipboard as string
            end if
        end tell
    end tell
    return false
end checkiPadFinished 
```

在我的代码前面，我声明了全局变量

global XXX, yyy, zzz, firstiPadSerial 将 firstiPadSerial 设置为“a”

对 checkiPadFinished() 的调用如下所示：

```
set doneiPads to my checkiPadFinished() 
```

据我所知，一切都应该正常工作，但我收到了一条神秘的错误消息。

编辑：不改变它正在运行的任何东西。我不知所措。我希望我已经写下了错误信息。但是我第 10 次点击了开始按钮，它起作用了，所以我什至不能说出消息是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:56:11.193

尝试：

```
 activate application "iTunes"
tell application "System Events"
    tell process "iTunes"
        select row 15 of outline 1 of scroll area 2 of window "iTunes"
        keystroke "c" using {command down}
        delay 0.5 -- jackjr300's suggestion
        set xxx to the clipboard
    end tell
end tell 
```

![在此处输入图像描述](../Images/f618dc4db86c25efb1b339ef219bde04.png)

# user-controls - 使 Windows Metro 控件可拖动

> ID：11005088
> 
> 赞同：1
> 
> 时间：2012-06-12T21:22:45.960
> 
> 标签：user-controls, drag-and-drop, microsoft-metro

我想让 Metro 用户控件可拖动。用户应该能够将它拖放到其他控件上，从而导致事情发生。如何实现此功能？

我发现唯一可行的方法是使用 GridView 和 ListView 控件。它们有一个“CanDragItems”属性，当它为真时，意味着视图中的任何项目都可以拖放。[我尝试将我的控件包装在 gridview 或 listview 中，但它们以我不理解](http://i.stack.imgur.com/nHnIW.png)的方式干扰了布局。

我不想模仿操作系统提供的功能。我可以通过使用原始鼠标/点击事件来做到这一点，但它不会正确遵守系统设置，例如防止意外拖动的死区大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T14:12:24.663

我最终只是通过观察鼠标事件来模拟功能。我要求正在拖动的控件获得一个看起来相同但没有功能的“doppleganger”副本，将其放置在顶级网格上，并调整其渲染变换以移动它。

但是，请注意，如果我的要求略有不同，我可能能够使用*操作*模式/事件来做我想做的事。它们特别好，因为它们内置了惯性，但它们对焦点有点挑剔，我没有设法用它跨越父控件的界限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T13:28:12.133

我要说的是，您必须在 Grid 上创建一个附加属性并绘制一个连接到 MouseDown/MouseUp 事件的装饰器，然后从那里设置 Grid.Column 的 Width/Grid.Row 的高度。这将使 Grid 可拖动。

我不建议使用内置属性 ShowGridLines，因为它仅用于调试。如果需要，您可以尝试使用 Grid Splitters 并减少代码。

有关附加属性的更多信息，请参见此处[附加属性](http://www.wpftutorial.net/AttachedProperties.html)

# android - 在自定义列表视图中动态设置图像

> ID：11005096
> 
> 赞同：0
> 
> 时间：2012-06-12T21:23:19.953
> 
> 标签：android, android-listview, android-adapter

有人可以解释一下我做错了什么/我必须做什么？

我有一个从 json 数组获取信息的列表视图。但它是一个自定义列表视图，每行有 5 个图像和一些文本。每个图像都有一个 /drawable/image_selector 根据启用/禁用的不同图像。我可以使用 hashmap 和 ListAdapter 为每一行动态设置文本。但我试图对图像做同样的事情，但我做不到。使用自定义适配器是正确的选择吗？如果是这样怎么办？我还没有从示例中了解如何使用它们。

谢谢

这是给定活动的代码： public class DisponiveisActivity extends ListActivity { ; //para os icones 做布局

```
private ProgressDialog pDialog;

//Object of class JSON Parser
JSONParser jsonParser = new JSONParser();
ArrayList<HashMap<String, String>> disponiveislist;

public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.list);

    disponiveislist = new ArrayList<HashMap<String, String>>();
    new Loaddisp().execute();

}
//Background ASYNC task to load

class Loaddisp extends AsyncTask<String, String, String>{
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pDialog = new ProgressDialog(DisponiveisActivity.this);
        pDialog.setMessage("Carregando");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    protected String doInBackground(String... args) {

                String nome = l.getString("NOME");
                String preco = l.getString("PRECO");
                String cfotografia = l.getString("COMFOTOGRAFIA");
                String cdados = l.getString("COMDADOS");
                String copiniao = l.getString("COMOPINIAO");

                String cdeslocacao = l.getString("COMDESLOCACAO");

                String distancia = l.getString("DISTANCIA");

                //create new HASHMAP                    
                HashMap<String,String> map = new HashMap<String,String>();
                map.put("NOME", nome);  
                map.put("PRECO", preco);
                map.put("DISTANCIA", distancia);
                map.put("COMOPINIAO", copiniao);
                map.put("COMDADOS", cdados);
                map.put("COMFOTOGRAFIA", cfotografia);
                //------------------------------

                disponiveislist.add(map);

            }

    @Override
    protected void onPostExecute(String file_url) {
        // TODO Auto-generated method stub

        pDialog.dismiss();
        runOnUiThread(new Runnable() {
            public void run() {
                /**
                 * Updating parsed JSON data into ListView
                 * */

                    Log.d("PP",disponiveislist.toString());
                ListAdapter adapter = new SimpleAdapter(DisponiveisActivity.this, disponiveislist, R.layout.listrow,new String[]{"NOME","PRECO","DISTANCIA"}, new int[]{R.id.mission_name, R.id.preco, R.id.cdistancia});

                setListAdapter(adapter);

            }
        });
    }

    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:32:03.510

我刚刚在谷歌上找到的一个很好的例子：在这种情况下，你只有一张图片，我真的希望你能理解如何为连续 5 张图片复制代码。

```
public class ItemsList extends ListActivity {

private ItemsAdapter adapter;

@Override
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.items_list);

        this.adapter = new ItemsAdapter(this, R.layout.items_list_item, ItemManager.getLoadedItems());
        setListAdapter(this.adapter);
}

private class ItemsAdapter extends ArrayAdapter<Item> {

        private Item[] items;

        public ItemsAdapter(Context context, int textViewResourceId, Item[] items) {
                super(context, textViewResourceId, items);
                this.items = items;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
                View v = convertView;
                if (v == null) {
                        LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                v = vi.inflate(R.layout.items_list_item, null);
                }

                Item it = items[position];
                if (it != null) {
                        ImageView iv = (ImageView) v.findViewById(R.id.list_item_image);
                        if (iv != null) {
                                iv.setImageDrawable(it.getImage());
                        }
                }

                return v;
        }
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
        this.adapter.getItem(position).click(this.getApplicationContext());
}
} 
```

# performance - 分别循环两次和在一个循环内循环之间的性能

> ID：11005099
> 
> 赞同：0
> 
> 时间：2012-06-12T21:23:49.807
> 
> 标签：performance, loops

分别循环两次和在一个循环内循环之间有什么性能差异吗？如何证明或计算？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:32:54.560

这完全取决于循环。以下是`O(n^2)`运行时间的一些示例：

```
1) Nested loops to n

for(i from 1 to n){
    for(j from 1 to n){
        ...
    }
}

2) Nested loops to n with the inner loop starting from i

for(i from 1 to n){
    for(j from i to n){
        ...
    }
}

3) Second loop iterates n^2 times since i == n

for(i from 1 to n){
    ...
}
for(j from 1 to i*n){
    ...
}

4) One loop up to n*n/50

for(i from 1 to n*n/50){
    ...
} 
```

以下是一些`O(n)`循环示例：

```
1) Simple loop

for(i from 1 to n){
    ...
}

2) Nested loop with constant iterations

for(i from 1 to n){
    for(j from 1 to 5){
        ...
    }
} 
```

然后你有一个事实，更好的时间复杂度并不总是足够小`n`，比如循环到`n*n/50`. If `n`is less than `8`(a positive int) 则该循环根本不会迭代，因此它显然比具有 的 Simple 循环更快`O(n)`，后者将精确地迭代`n`次数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:35:23.927

通常来说，一般来说：

`O(n + m)`如果您有两个不同长度的不同循环（`n`和 `m`） ，则可能是这样。

```
for (int i = 0; i < n; i++) {}
for (int i = 0; i < m; i++) {} 
```

可能是`O(n * m)`您在循环中循环。

```
for (int i = 0; i < n; i++) {
   for (int j = 0; j < m; j++) {
   }
} 
```

# javascript - IE8 在脚本之外抛出 JavaScript 语法错误

> ID：11005105
> 
> 赞同：4
> 
> 时间：2012-06-12T21:24:30.227
> 
> 标签：javascript, internet-explorer, internet-explorer-8

我遇到了一个奇怪的问题，IE8 在脚本标签之外报告了一个 JavaScript 错误（或者它声称），并破坏了页面上所有进一步的 JS。这是有问题的代码：

```
<script type="text/javascript">//<![CDATA[
    function emailReport() {
        var params = window.location.search;
        var url = "scripts/someScript.php" + params;
        ajaxwl(url, false, null, function() {
            alert("Report successfully sent.");
        });
    }
//]]></script>
<h2>Analyst Report</h2> 
```

ajaxwl() 只是 jQuery.ajax() 的一个包装器，并且在整个站点的数百个地方使用，没有任何问题。

IE 声称语法错误（它没有详细说明什么类型）位于带有`</script>`标记的行的字符 23 处。这特别奇怪，因为该行只有 15 个字符。但是，如果我检查 IE8 开发人员工具中的假定位置，它实际上会将错误`<h2>`放在下一行标记的中间。

这是官方的 IE 错误信息：

```
User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.0.3705; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E; InfoPath.1; MS-RTC LM 8)
Timestamp: Tue, 12 Jun 2012 21:19:38 UTC

Message: Syntax error
Line: 175
Char: 23
Code: 0 
```

鉴于 IE 没有告诉我实际的错误消息，到目前为止我还没有在网上找到任何关于此的信息。JSLint 也没有产生任何有用的东西，它在 Chrome 和 FF 中完美运行。我错过了一些明显的东西吗？

* * *

编辑：我的预感是，尽管 IE 在上面的代码片段中报告了错误，但它实际上正在其他地方死去。这似乎是共识。我想我会搜索页面，看看我是否幸运并找到错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T21:55:05.160

IE 因*未指定*发生错误的文件或未正确指定而臭名昭著。尝试在 IE 调试器中运行它，看看错误是否完全不在其他文件的第 175 行。

**编辑** 调试器没有工作，所以你将不得不这样做：*将页面保存*到磁盘；将所有 Javascript 文件连接成一个大文件；从其他空白页面中包含该文件。现在行号将有所不同，但在您拥有的唯一 JS 文件中是准确的。

我的预测：终端逗号。以下代码行在 Javascript 中是合法的，但在 IE“JScript”中不合法。

```
 var x = [ 0, ]; 
```

> “史蒂夫·乔布斯死了，比尔·盖茨还活着，因为没有上帝。但100年后，乔布斯将与爱迪生和伊莱·惠特尼一起被人们铭记，而盖茨将被遗忘，因为有*正义*。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:49:51.240

我刚刚启动了运行 IE 8.0.7601 的 windows 框，并且没有报告此代码的语法问题

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
   <title>I AM YOUR DOCUMENT TITLE REPLACE ME</title>
   <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
 </head>
 <body>
   <div>

<script type="text/javascript">//<![CDATA[
    function emailReport() {
        var params = window.location.search;
        var url = "scripts/someScript.php" + params;
        ajaxwl(url, false, null, function() {
            alert("Report successfully sent.");
        });
    }
//]]></script>
<h2>Analyst Report</h2>

   </div>
 </body>
</html> 
```

# ios - UITableView 展开和折叠以显示部分或全部单元格

> ID：11005106
> 
> 赞同：2
> 
> 时间：2012-06-12T21:24:30.937
> 
> 标签：ios, uitableview

我有 UITableView，它使用一个高约 200 像素的 commentTableCell，它既有文本又有图像。

我希望当未选择一行时，该行的高度约为 65 像素，这将隐藏所有图像，当该行扩展到 200 像素时，commentTableCell 将完全展开，因此单元格内的图像会得到裸露。

**但是我遇到的问题是，当所有行都折叠到 65 像素的高度时，commentTabelCell 中的任何图像都不应该显示，但是我从表格的某些部分显示的单元格中得到了重影或部分图像。为什么？**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{            
        static NSString *CellIdentifier = @"customCell";

        CommentTableCell *cell = (CommentTableCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

        return cell;    
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
        if(selectedIndex == indexPath.row)
        {

            return 200;
        }
        else {

            return 65;
        }  
}

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

        //The user is selecting the cell which is currently expanded
        //we want to minimize it back
        if(selectedIndex == indexPath.row)
        {
            selectedIndex = -1;
            [tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];

            return;
        }

        //First we check if a cell is already expanded.
        //If it is we want to minimize make sure it is reloaded to minimize it back
        if(selectedIndex >= 0)
        {
            NSIndexPath *previousPath = [NSIndexPath indexPathForRow:selectedIndex inSection:0];
            selectedIndex = indexPath.row;
            [tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:previousPath] withRowAnimation:UITableViewRowAnimationFade];        
        }

        //Finally set the selected index to the new selection and reload it to expand
        selectedIndex = indexPath.row;
        [tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T00:50:45.120

我有一个替代解决方案。尝试这个：

```
// ----------------------------//

// Put this somewhere in your .h file:  
NSIndexPath *selectedCellIndexPath;  

// ----------------------------//

// Set your default row height
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {  
    return 65;  
}  

// In the implementation file:  
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {  
    selectedCellIndexPath = indexPath;  

   // Forces the table view to call heightForRowAtIndexPath  
   [tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationNone];  
}  

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {  
    // Note: Some operations like calling [tableView cellForRowAtIndexPath:indexPath]  
    // will call heightForRow and thus create a stack overflow  
    if(selectedCellIndexPath != nil && [selectedCellIndexPath compare:indexPath] == NSOrderedSame)  
        return 200;  

    return 65;  
} 
```

# android - 安卓usb主机通讯

> ID：11005110
> 
> 赞同：3
> 
> 时间：2012-06-12T21:24:49.010
> 
> 标签：android, usb, communication

我需要我的硬件通过 USB 进行通信，充当 USB 主机。如果我使用的是 android 2.3.3，有没有办法做到这一点？正如我研究的那样，android api 3.1 及更高版本都支持这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:32:05.600

可能不是，...

摩托罗拉 Xoom (3.1) 上引入了 Android USB 托管。并非所有设备都具有此功能。

您需要的是 USB 附件套件（但这适用于 2.3.4）

[http://developer.android.com/guide/topics/usb/accessory.html](http://developer.android.com/guide/topics/usb/accessory.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:30:57.853

你必须找到一个定制的 android 2.3.3 ROM，它有支持这个的 USB 驱动程序。

即使您这样做了，您的手机也只能使用 2.3.3 及更低版本的应用程序，这些应用程序没有[此处](http://developer.android.com/guide/topics/usb/host.html)的 USB 主机硬件代码。因此，除非您[在手机上安装 ubuntu 发行版，](http://androlinux.com/android-ubuntu-development/how-to-install-ubuntu-on-android/)否则您将无法使用 USB 外围设备做很多事情。

# flash - Adobe CS3 ActionScript 3 按钮图形更改

> ID：11005112
> 
> 赞同：0
> 
> 时间：2012-06-12T21:24:50.040
> 
> 标签：flash, button, actionscript

我对 Flash 完全陌生，作为一个学校项目，我被告知要使用 Flash 创建一个功能齐全的网页。我已经在 Photoshop 中完成了大量的纹理，并且相当成功地让它们执行正确的动画。但是我想在角落有一个静音按钮，当激活时会在两个纹理之间切换。我遇到的问题是让他们实际做任何事情。

正如我所说，我完全知道并且不知道编码的语法或布局。我已经阅读了大量的教程，我总是收到编译器错误，比如“无法嵌套包”或“无法访问静音等等”。

目前我有两个按钮层名为：“静音”和“取消静音”。我真的需要一些建议，因为我很快就会失去耐心。我目前没有代码可以给你们，因为我得到的一切都不起作用，而且似乎非常不准确。

提醒一下，我使用 Adob​​e Flash CS3 和 ActionScript 3。

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T02:32:25.087

我真的很讨厌听起来像“Programatticus Takeoveriticus”（我的团队一直在开玩笑），但是大多数 Flash 程序员都知道的“纹理”可能不是最好的方法。通常，纹理是指用于填充区域的图像。

根据您的信息，我假设您的“纹理”是图像......可能以 .png 或 .gif 格式保存？您要做的就是将这些导入到您的库中。

我使用的是 CS5.5，所以这可能有点偏离，但对于 CS3 来说应该很接近。

转到文件->导入->导入到库...

选择要使用的图像，然后按“导入”。它们将出现在您的库窗格中，通常位于屏幕的右侧（但可能在其他位置，具体取决于您的布局。如果您遇到问题，请使用“窗口”菜单找到它。）

现在，转到插入-> 新符号...

为符号命名。符号名称的最佳做法是仅使用字母数字字符和下划线（无空格或其他标点符号）。

现在，选择一个类型。我为此推荐 MovieClip。

不理会其他所有内容，然后按“确定”。您的舞台将切换到仅编辑该影片剪辑。

看看你的时间线。这个很重要。单击时间轴上的第一帧，然后将您想要用于未静音图像的图像从库中拖到舞台上。使用自由变换工具根据需要调整大小。

现在，单击您刚刚放置的图像。转到“属性”窗格并将其位置设置为 0 left, 0 top。

现在，在时间轴中，单击第二帧。对图像重复上述步骤以进行静音。请注意，第二张图片的大小与第一张图片完全相同。

将两个图像放在时间轴上后，在相应的帧中，单击第一帧。转到“操作”选项卡（右键单击框架并单击“操作”）。

输入以下语句。

```
stop(); 
```

对第二帧重复此操作。

停止（）；声明只是告诉 Flash 停留在该帧上，直到代码告诉它不这样做。

现在，在顶部，单击蓝色的“返回”按钮返回主舞台。您刚刚创建的对象将位于舞台上的某个位置。（如果不是，请将其从库中拖到舞台上。）将此对象放置在您想要的位置，并根据需要调整其大小。

单击对象以选择它，然后转到“属性”窗格。在顶部显示“”的位置，输入该对象实例的工作名称。如果您在这个阶段只使用过一次，只需将其命名为与库中相同的名称（无论您之前如何命名）。对于本示例，我将称其为“btnMute”。

现在，在您拥有所有代码的区域，您需要输入以下内容：

```
//Here we create a boolean (true/false) variable for whether sound is muted.
var muted:Boolean = false;

//Create the event listener for when the mute button is clicked.
btnMute.addEventListener(MouseEvent.CLICK, muteSound);

//Here is the event handler for the above listener.
function muteSound(evt:MouseEvent):void
{
    //If muted is true...
    if(muted)
    {
        //Set muted to false
        muted = false;
        //Change button to "unmuted" state.
        btnMute.gotoAndStop(1);
    }
    //If muted is false...
    else
    {
        //Set muted to true
        muted = true;
        //Change button to "muted" state.
        btnMute.gotoAndStop(2);
    }
} 
```

很多代码应该看起来很熟悉。我要指出的主要内容是这行`btnMute.gotoAndStop(...)`这允许您更改特定 MovieClip 上显示的帧。只需将语句中的“...”替换为您要转到的帧号即可。

或者，您可以使用代码`btnMute.gotoAndPlay(...);`。因为您`stop();`在每个框架上都有代码，所以将完成相同的事情。

`gotoAndStop(...);`和之间的主要区别在于`gotoAndPlay(...);`“AndStop”不执行帧上的任何代码，也不会在没有该`stop();`函数的情况下播放帧，而“AndPlay”会。

我希望这会有所帮助。再一次，很抱歉推荐一种不同的方法，因为当人们对我这样做时，这是我最讨厌的。但是，在大多数情况下，您会发现这种方式比隐藏和显示不同的项目来做同样的事情要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:04:50.047

我不太确定，你的问题是什么，但试试这个。

1.  创建一个按钮，放入您的舞台并在属性视图中命名为“btnAudio”
2.  创建纹理 1，放入您的舞台并在属性视图中命名为“img1”，对名称为“img2”的纹理 2 执行相同操作
3.  创建一个新层，调用“actions”并编写以下代码：

    ```
    //Listener added to your button.
    btnAudio.addEventListener(MouseEvent.CLICK, f_muted);

    //Init method to hide your textures.
    function f_init():void {
        img1.visible = false;//Texture 1
        img2.visible = false;//Texture 2
    }

    // function to switch your textures
    function f_muted(event:MouseEvent):void{
        trace("switch images");
        img1.visible = true;
    }

    f_init();//Hide Textures. 
    ```

我希望这可以帮助你。

# c# - 彩色输出到richtextbox不起作用

> ID：11005116
> 
> 赞同：0
> 
> 时间：2012-06-12T21:25:00.780
> 
> 标签：c#, regex, richtextbox

我有一个应该输出彩色文本 RichTextBox 的函数。所有匹配项都应为红色，不匹配的文本应为黑色。以下函数尝试在插入我的条目时更改 RichTextBox 内容颜色（如在[为 RichTextBox 字符串的不同部分](https://stackoverflow.com/questions/1926264/color-different-parts-of-a-richtextbox-string)着色）

```
public void OutputColoredMatches(String InputText, MatchCollection Matches, RichTextBox OutputBox)
{
    int LastMatchEndIndex = OutputBox.TextLength;
    foreach (Match CurrentMatch in Matches)
    {
        OutputBox.SelectionColor = Color.Black;
        OutputBox.AppendText(InputText.Substring(LastMatchEndIndex, CurrentMatch.Index - LastMatchEndIndex));
        OutputBox.SelectionColor = Color.Red;
        OutputBox.AppendText(InputText.Substring(CurrentMatch.Index, CurrentMatch.Length));
        LastMatchEndIndex = CurrentMatch.Index + CurrentMatch.Length;
    }
    OutputBox.SelectionColor = Color.Black;
    OutputBox.Text += InputText.Substring(LastMatchEndIndex, InputText.Length - LastMatchEndIndex);
} 
```

该函数将选择颜色设置为黑色后才添加应该为黑色的文本，将选择颜色设置为红色后才添加找到的匹配文本。尽管单步执行代码并看到它*正确*插入文本，但所有输出都是黑色的。

我还尝试更改以插入所有（或部分）文本，然后更改 RichTextBox 选择的大小。然后设置选择颜色，这也不起作用。尽管我检查并仔细检查了选择在适当的位置开始和结束，但所有文本最后都是红色或黑色。（我尝试了类似的方法：[在 RichTextBox 中选择性地为文本着色](https://stackoverflow.com/questions/455713/selectively-coloring-text-in-richtextbox)）。这是该功能的另一种变体，我插入部分文本，然后更改其颜色。我还在调试器中逐步执行了此操作，并验证它正在按照我的预期选择项目，然后设置它们的颜色，所有输出都是黑色的：

```
public void OutputColoredMatches(String InputText, MatchCollection Matches, RichTextBox OutputBox)
{
    int SelPos = 0;
    int LastMatchEndIndex = OutputBox.TextLength;
    foreach (Match CurrentMatch in Matches)
    {
        SelPos = OutputBox.TextLength;
        OutputBox.AppendText(InputText.Substring(LastMatchEndIndex, CurrentMatch.Index - LastMatchEndIndex));
        OutputBox.SelectionStart = SelPos;
        OutputBox.SelectionLength = OutputBox.TextLength - SelPos;
        OutputBox.SelectionColor = Color.Black;

        SelPos = OutputBox.TextLength;            
        OutputBox.AppendText(InputText.Substring(CurrentMatch.Index, CurrentMatch.Length));
        OutputBox.SelectionStart = SelPos;
        OutputBox.SelectionLength = OutputBox.TextLength - SelPos;
        OutputBox.SelectionColor = Color.Red;

        LastMatchEndIndex = CurrentMatch.Index + CurrentMatch.Length;
    }
    OutputBox.SelectionColor = Color.Black;
    OutputBox.Text += InputText.Substring(LastMatchEndIndex, InputText.Length - LastMatchEndIndex);
} 
```

更具体地说，如果我有一个正则表达式“s”和一个输入文本“asdf”，则此函数将“a”插入到输出框中。然后它将选择位置设置为 0，将选择长度设置为 1，然后将颜色设置为黑色。然后插入's'，选择位置为1，长度为1，颜色为红色。然后它插入'df'将选择位置设置为2，长度设置为2，颜色设置为黑色。然后所有的输出都是黑色的。

我还尝试了各种选择起始位置和长度的方法，然后插入文本而没有任何效果。我认为我很可能在做一些不正确的事情，只是与文本框模糊相关。

还有什么会影响我可能没有注意的着色行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:07:34.050

您没有对颜色进行任何选择，在您提供的链接中，他们在设置颜色之前定义了一个选择。

```
box.SelectionStart = jx;
box.SelectionLength = phrase.Length;
box.SelectionColor = color; 
```

您需要找到并选择匹配项，然后为它们着色。

编辑：我还没有测试过这个，但它看起来是正确的..

```
//set the start of the selection to the current end of the text box
OutputBox.SelectionStart = OutputBox.Text.Length - 1; 
//set the selections length
OutputBox.SelectionLength = CurrentMatch.Length;
//and finally set the color
OutputBox.SelectionColor = Color.Red; 
```

# c# - C#.NET Excel 和 OLEDB 连接字符串

> ID：11005121
> 
> 赞同：4
> 
> 时间：2012-06-12T21:25:30.443
> 
> 标签：c#

我正在尝试将 Excel 文件中的数据读取到我的 Windows 应用程序中。

连接字符串：

```
provider = Microsoft.Jet.OLEDB.4.0; Data Source = "Excel File"; 
Extended Properties =    \"Excel 8.0; HDR = Yes; ImportMixedTypes = Text;
Imex = 1;\" 
```

**使用此连接字符串，即使计算机上未安装 Microsoft office-Excel，**我也可以从 Excel 文件中读取数据。但是有些方法，我的程序与此连接字符串不兼容。

我现在使用的连接字符串是

```
provider = Microsoft.ACE.OLEDB.12.0; Data Source = "Excel file"; 
Extended Properties = "Excel 12.0; HDR = Yes; Imex = 1; 
```

此连接字符串与我的程序兼容，但**它仅适用于安装了 Microsoft Office - Excel 的计算机。**

任何人都可以建议我在哪里犯错。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T21:32:04.727

Microsoft 在 2003 年之后的所有 Windows 版本中删除了 JET 引擎，包括 64 位 Windows 2003。ACE 是现代替代品，但它也没有随 Windows 的基本安装一起分发。

为了使用 ACE，您需要从 Microsoft 将免费的 ACE 可再发行版部署到所有未安装 Office 的目标计算机。然后，您可以使用您在其中任何一个上列出的第二个连接字符串。

在此处从 Microsoft 获取：http: [//www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:33:16.400

如果您可以使用第三方库，那么有一个非常不错的项目可以使用 Linq 来访问 excel 文件。看看：[http ://code.google.com/p/linqtoexcel/](http://code.google.com/p/linqtoexcel/)

# c - C/C++ 执行 Adjacency2Distance 矩阵的最佳算法 [由 Floyd-Warshall 解决]

> ID：11005122
> 
> 赞同：1
> 
> 时间：2012-06-12T21:25:31.000
> 
> 标签：c, algorithm

```
INITIAL ISSUE 
```

大家好，

我已经找到了几种算法来完成这项任务。但是所有这些代码都考虑了每个节点或边缘的权重值。

我的目标比这更容易，它是从邻接矩阵中获取距离矩阵。

输入将是：

```
 a b c d e f    connected vertices to i
a 0 1 0 0 0 0    1
b 1 0 1 1 0 0    3
c 0 1 0 0 0 0    1
d 0 1 0 0 1 0    2
e 0 0 0 1 0 1    2
f 0 0 0 0 1 0    1
                ---
            Sum: 10  -> Edges = Sum/2 = 5 
```

输出将是：

```
 a b c d e f
a 0 1 2 2 3 4
b 1 0 1 1 2 3
c 2 1 0 2 3 4
d 2 1 2 0 1 2
e 3 2 3 1 0 1
f 4 3 4 2 1 0 
```

提前感谢您的任何建议，

大卫亚历杭德罗。

```
SOLUTION FOUND 
```

Floyd-Warshall Kernell C 中

```
for (k = 0; k < n; ++k) 
{
    for (i = 0; i < n; ++i)
    {
        for (j = 0; j < n; ++j)
        {
            if ((dist[i][k] * dist[k][j] != 0) && (i != j))
            {
                if ((dist[i][k] + dist[k][j] < dist[i][j]) || (dist[i][j] == 0))
                {
                    dist[i][j] = dist[i][k] + dist[k][j];
                }
            }
        }
    }                   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:40:12.060

如果您已经找到仅使用权重关联的算法，请使用它们，但将每个权重设置为 1。

无论如何，[BFS都是我的建议。](http://en.wikipedia.org/wiki/Breadth-first_search)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:51:44.723

将邻接矩阵中的“无限”（即大于任何合理距离）值更改为零，然后在结果矩阵上运行[Floyd-Warshall](http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm)。

NominSim 建议的 BFS 需要从每个起始顶点运行，以获得*所有*顶点的距离。

# java - 如何在 SWIG 生成的 Java 绑定中转换为 SWIGTYPE_p_void 类型？

> ID：11005123
> 
> 赞同：5
> 
> 时间：2012-06-12T21:25:44.500
> 
> 标签：java, c, java-native-interface, swig

我正在为 C 库开发一些 SWIG 生成的 Java 绑定。该库包含接受类型参数的函数`void *`。在 C 端，这些通常作为指向类型数组的指针传递`float`或`int`强制转换为`void *`. 在生成的 Java 绑定中，这会导致方法采用 type 参数`SWIGTYPE_p_void`。

在 Java 绑定中构造浮点数/整数数组以便它们可以作为类型传递`SWIGTYPE_p_void`给这些方法的最佳方法是什么？

目前我在我的 example.i 文件中定义了一个辅助函数：

```
void *floata_to_voidp(float f[])
{
    return (void *)f;
} 
```

然后在 Java 端做这样的事情：

```
float foo[] = new float[2];
SWIGTYPE_p_void av = null;

// do something with foo

av = example.floata_to_voidp(foo);
example.myfunction(av); 
```

`inta_to_voidp()`这看起来相当难看，特别是因为对于我想要支持的每种类型转换，我还需要在我的 SWIG 接口文件中添加一个 etc。

有没有办法在没有辅助函数的情况下做到这一点，并且在 Java 端涉及更少的额外代码来转换数据类型？

**更新（2012 年 17 月 6 日）：**为问题提供更多细节：我要做的是采用一组 C 函数，带有原型`int foo(const float *data, int N, const void *argv, float *result)`并将它们映射到 Java 端的方法，其中任意类型的数组可以作为`argv`. 请注意`argv`is`const void *`和 not `void *`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T18:11:11.863

[这个答案](https://stackoverflow.com/a/11018918/168175)有一个替代方案，它非常不同，并且为这个问题提供了一个更自然的解决方案，更接近你最初寻找的东西。其他建议集中在添加重载（繁琐、手动）或使`array_class`es 以一种或另一种方式实现公共接口。

它忽略了大部分时间在 Java中`Object`是一个很好的匹配。`void*`甚至[Java 中的数组也是`Object`s](https://stackoverflow.com/questions/8781022/is-an-array-an-object-in-java)。这意味着，如果您有 SWIG 映射`void*`到`Object`它，它将接受您可能想要传入的任何数组作为输入。稍加注意和一些 JNI，我们就可以获取指向该数组开头的指针以传递给函数。显然，我们需要拒绝非数组`Object`，但有一个例外。

我们最终仍然会编写一些（私有）辅助函数来安排提取真正的底层指针并在完成后释放它，但是这个解决方案的好处是我们只需要这样做一次，然后我们最终得到一个类型映射可用于任何`void*`像这样采用数组的函数。

我最终得到了这个解决方案的以下 SWIG 界面：

```
%module test

%{
#include <stdint.h>

void foo(void *in) {
  printf("%p, %d, %g\n", in, *(jint*)in, *(jdouble*)in);
}
%}

%typemap(in,numinputs=0) JNIEnv *env "$1 = jenv;"

%javamethodmodifiers arr2voidd "private";
%javamethodmodifiers arr2voidi "private";
%javamethodmodifiers freearrd "private";
%javamethodmodifiers freearri "private";
%inline %{
jlong arr2voidd(JNIEnv *env, jdoubleArray arr) {
  void *ptr = (*env)->GetDoubleArrayElements(env, arr, NULL);
  return (intptr_t)ptr;
}

void freearrd(JNIEnv *env, jdoubleArray arr, jlong map) {
  void *ptr = 0;
  ptr = *(void **)&map;
  (*env)->ReleaseDoubleArrayElements(env, arr, ptr, JNI_ABORT);
}

jlong arr2voidi(JNIEnv *env, jintArray arr) {
  void *ptr = (*env)->GetIntArrayElements(env, arr, NULL);
  return (intptr_t)ptr;
}

void freearri(JNIEnv *env, jintArray arr, jlong map) {
  void *ptr = 0;
  ptr = *(void **)&map;
  (*env)->ReleaseIntArrayElements(env, arr, ptr, JNI_ABORT);
}
%}

%pragma(java) modulecode=%{
  private static long arrPtr(Object o) {
    if (o instanceof double[]) {
      return arr2voidd((double[])o);
    }
    else if (o instanceof int[]) {
      return arr2voidi((int[])o);
    }
    throw new IllegalArgumentException();
  }

  private static void freeArrPtr(Object o, long addr) {
    if (o instanceof double[]) {
      freearrd((double[])o, addr);
      return;
    }
    else if (o instanceof int[]) {
      freearri((int[])o, addr);
      return;
    }
    throw new IllegalArgumentException();
  }
%}

%typemap(jstype) void *arr "Object"
%typemap(javain,pre="    long tmp$javainput = arrPtr($javainput);",post="      freeArrPtr($javainput, tmp$javainput);") void *arr "tmp$javainput"

void foo(void *arr); 
```

这为两种数组类型实现了它，有一个小的有限数，您也可以使用片段或宏来帮助解决这个问题。在内部 SWIG 使用 a`jlong`来表示指针。因此，对于每种数组类型，我们都需要一个函数，该函数返回一个给定数组的指针并释放另一个指针。这些是私有的并且是模块类的一部分——除了模块之外没有人需要知道它是如何工作的。

然后有两个函数接受`Object`并使用`instanceof`（丑陋，但Java中的数组没有任何其他公共基础或接口，泛型没有帮助）并调用正确的函数来获取/释放指针。

有了这些，只需两个类型图即可设置 SWIG 以将其用于所有`void *arr`参数。jstype 类型映射指示 SWIG在这些情况下使用`Object`for 。`void*`javain 类型映射安排一个临时局部变量来保存指针（在 a 中`long`），然后将其用于进行调用，并在调用成功或失败后进行清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T16:03:48.770

最简单的解决方案是[使用 SWIG`<carrays.i>`创建一个类型，该类型包含一个数组](https://stackoverflow.com/a/10495755/168175)和`float`一个数组`int`以及您关心的任何其他类型。这些可以使用成员函数简单地转换为`SWIGTYPE_p_float`等。`cast()`问题是这不能`SWIGTYPE_p_void`从Java 中自动转换为a。理论上你可以调用：

```
new SWIGTYPE_p_void(FloatArray.getCPtr(myfloatarr)); 
```

但是由于各种原因（尤其是很麻烦），这并不理想。（它还存在内存所有权和垃圾收集问题）。

所以我定义了一个接口：

```
public interface VoidPtr {
  public long asVoidPtr();
} 
```

我们可以使您的库的包装版本作为输入，并为我们实现数组类`FloatArray`等`IntArray`。

这以模块文件结束：

```
%module test

%include <carrays.i>

%typemap(javainterfaces) FloatArray "VoidPtr"
%typemap(javainterfaces) IntArray "VoidPtr"

%typemap(javacode) FloatArray %{
  public long asVoidPtr() {
    return getCPtr(this);    
  }
%}

%typemap(javacode) IntArray %{
  public long asVoidPtr() {
    return getCPtr(this);
  }
%}

%array_class(float, FloatArray);
%array_class(int, IntArray);

%typemap(jstype) void *arr "VoidPtr"
%typemap(javain) void *arr "$javainput.asVoidPtr()"

void foo(void *arr); 
```

修改`void *arr`为我们的`VoidPtr`类型并自动调用该`asVoidPtr()`方法。您可以使用[类型映射复制](http://www.swig.org/Doc1.3/Typemaps.html#Typemaps_nn13)或宏来减少重复性。（注意，[过早的垃圾收集](http://www.swig.org/Doc1.3/Java.html#java_pgcpp)可能存在问题，可能需要在此处解决，具体取决于您计划如何使用它）

这允许我们编写如下代码：

```
public class run {
  public static void main(String[] argv) {
    FloatArray arr = new FloatArray(100);
    test.foo(arr);    
  }
} 
```

我认为这是最简单、最干净的解决方案。不过，还有其他几种方法可以解决这个问题：

1.  还可以编写一些代码，这些代码将采用实际的 Java 数组而不仅仅是 SWIG `array_class`，并通过调用 JNI 函数来获取底层指针来实现此接口。不过，就像上面一样，您必须为每种原始类型编写一个版本。

    接口文件可能看起来像：

    ```
    %module test

    %{
    void foo(void *arr);
    %}

    %typemap(in,numinputs=0) JNIEnv *env "$1 = jenv;"

    %rename(foo) fooFloat;
    %rename(foo) fooInt;
    %inline %{
    void fooFloat(JNIEnv *env, jfloatArray arr) {
      jboolean isCopy;
      foo((*env)->GetFloatArrayElements(env, arr, &isCopy));
      // Release after call with desired semantics
    }

    void fooInt(JNIEnv *env, jintArray arr) {
      jboolean isCopy;
      foo((*env)->GetIntArrayElements(env, arr, &isCopy));
      // Release after call
    }
    %}

    void foo(void *arr); 
    ```

    然后，它会为您提供`foo`take`float[]`和`int[]`以及 的重载`SWIGTYPE_p_void`。

2.  您可以使用联合的技巧：

    ```
    %inline %{
      union Bodge {
        void *v;
        float *f;
        int *i;
      };
    %} 
    ```

    尽管这被认为是不好的形式，但它确实为您生成了一个 Java 接口，可用于从 转换`SWIGTYPE_p_int`为`SWIGTYPE_p_void`.

3.  我认为可以`FloatArray`继承 from `SWIGTYPE_p_void`，类似于以下已编译但未经测试的代码：

    ```
    %module test

    %include <carrays.i>

    %typemap(javabase) FloatArray "SWIGTYPE_p_void"
    %typemap(javabody) FloatArray %{
      private long swigCPtr; // Minor bodge to work around private variable in parent
      private boolean swigCMemOwn;
      public $javaclassname(long cPtr, boolean cMemoryOwn) {
        super(cPtr, cMemoryOwn);
        this.swigCPtr = SWIGTYPE_p_void.getCPtr(this);
        swigCMemOwn = cMemoryOwn;
      }
    %}

    %array_class(float, FloatArray);

    void foo(void *arr); 
    ```

    这在 Java 端复制了指针，但在 void 指针或数组类中（当前）没有任何改变，因此这不像最初看起来那么大的问题。（您也可以使用我认为的替代类型映射在基类中对其进行保护，或者使用通过函数`carrays.i`获取的修改版本）`swigCPtr``getCPtr`

# bash - 查找重复的结果

> ID：11005128
> 
> 赞同：0
> 
> 时间：2012-06-12T21:26:09.823
> 
> 标签：bash

我有一个在海量文件管理器设备上查找文件的脚本。每天，它搜索大约 250,000 个文件并创建一个简单的报告，计算我们收到的文件数量，按发件人 ( `$1`) 和日期 ( `$11`) 细分。

为了提高效率，我`‑exec`在 find() 表达式中使用加号来将文件名分组。

```
find . -exec ls '{}' +| awk -F~ '{print $1"\t"$11}'|sort|uniq -c 
```

它工作得很快，但会像这样重复结果

```
 9632 ./Reynosa    20120607
   9632 Reynosa 20120607
  20328 ./Reynosa   20120608
  20328 Reynosa 20120608
  15354 ./Reynosa   20120609
  15354 Reynosa 20120609 
```

我究竟做错了什么？我应该使用 `basename`剥离`./`还是有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:32:21.423

尝试`ls -d`代替`ls`. 从手册页：

```
-d, --directory
          list directory entries instead of contents, and do not  dereference symbolic links 
```

您当前的命令也列出了目录的条目，然后通过 find 再次列出这些条目，从而导致重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:01:17.403

你应该在 find 中使用 -type f

```
 find . -type f -exec .... 
```

# android - Facebook Hackbook 示例 (android) 未登录

> ID：11005133
> 
> 赞同：2
> 
> 时间：2012-06-12T21:26:32.100
> 
> 标签：android, facebook

我已按照[本](https://developers.facebook.com/docs/mobile/android/hackbook/)演练中的所有说明进行操作，并一直安装实际的 Facebook 应用程序。

当我构建并运行代码时（在虚拟设备或带有 USB 线的实际 android 上），主 ui 弹出消息“您已注销！” 和用于登录的按钮，但每次单击该按钮时，都会显示一个带有蓝色 Facebook 标题栏和旋转进度条的白色屏幕，但随后会被转回主 UI，而不会显示登录对话框或做任何事。

如果我单击“更新状态”或“应用程序请求”，我会被告知我没有登录，但可以输入我的电子邮件/密码。通过这些登录后，我可以使用这两个功能，但不能使用其他功能。（其余的仍然都说我没有登录）。

我比较有信心我已经生成并使用了正确的哈希键来向 facebook 注册我的应用程序。

其他问题： 应用请求：如果按下实际的“取消”按钮，吐司仍显示为“应用请求已发送”。

对此问题的任何帮助将不胜感激，因为我对 Android 开发和 Facebook 集成非常陌生，我想开始自己的进步。

* * *

编辑：跟进，过去几周我在使用 Hackbook 登录和执行 Graph API 功能以及我个人使用类似代码通过我正在开发的应用程序登录 Facebook 方面取得了成功。这个工作周的四天中有两天突然停止工作，即使我没有更改我的代码的任何 SSO 或 Facebook 部分。完全相同的特征：Facebook 式的标题栏和旋转的进度条，然后转储回前一个屏幕，没有登录对话框或会话识别。我可以通过他们自己的 Android 应用程序正确登录 Facebook，但 Hackbook 和我自己的应用程序要么一起工作，要么一起失败。

# php - 使用 htmlspecialchars 时对 BBCodes 进行例外处理

> ID：11005139
> 
> 赞同：-2
> 
> 时间：2012-06-12T21:27:01.163
> 
> 标签：php, html, special-characters, bbcode

我用 htmlspecialchars 来清理网站评论，它变成`<>`了 html 特殊字符。但我还需要在评论中添加一些链接，就像这里一样。我认为像 perg_replace 这样的东西可以为 htmlspecialchars 设置一个例外，例如`LINK]<a href="...">...</a>[/LINK]`从 htmlspecialchars 中隐藏 [。我怎么能在php中做到这一点？或者有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T21:10:36.113

您可以使用以下代码：

```
$comment = preg_replace('/'.preg_quote('[link]','/').'(.*?)'.preg_quote('[/link]','/').'/eisU',"htmlspecialchars_decode('$1')", $comment); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:40:46.260

我建议使用一个库来解析 BBCode 或类似的东西——一般来说，这会清理输入本身。一个快速的谷歌出现了[NBBC](http://nbbc.sourceforge.net/)，尽管这对于您的目的来说可能有点矫枉过正。你甚至不需要使用 BBCode，除非你已经下定决心 - 有非常好的用于[Markdown](http://michelf.com/projects/php-markdown/)之类的 PHP 库。

# database - 如何从数据库生成 Flex VO

> ID：11005141
> 
> 赞同：0
> 
> 时间：2012-06-12T21:27:07.870
> 
> 标签：database, apache-flex, actionscript, value-objects

我们已经拥有包含真实数据的数据库。现在我们想在此之上构建一个 Flex-Java。我们知道如何使用 Hibernate 工具从数据库生成/逆向工程 Java 代码。现在的问题是如何生成 VO 动作脚本！这个想法很简单，就像 Hibernate 从 DB 生成 POJO。

注意：我们尝试了 Adob​​e 的数据模型驱动方法，但我们不喜欢它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T08:25:29.267

如果您已经在服务器端使用 Java / Hibernate，那么Farata 公司的[ClearToolkit](http://sourceforge.net/projects/cleartoolkit/)将是从 Hibernate 已经生成的内容生成 Flex 代码的一个很好的候选者。更不用说它是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:51:59.107

```
The question now is just how to generate the VO action script 
```

1.  手写VO
2.  使用代码生成工具。[我相信Adob​​e Flash Builder](http://help.adobe.com/en_US/Flex/4.0/AccessingData/WSbde04e3d3e6474c4-668f02f4120d422cf08-8000.html)中内置了一些东西。那是你试过的吗？
3.  使用其他一些代码生成工具。我不知道有什么开箱即用的。我以前使用[Enteprise Architect](http://www.sparxsystems.com/products/ea/index.html)从 UML 图生成代码，但不是很长时间了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T13:04:51.220

我们使用 GraniteDS

[http://www.graniteds.org/](http://www.graniteds.org/)

# macros - 如何将 2 个文本保存在同一个 file.csv 但在 iMacros 的两个不同列中

> ID：11005147
> 
> 赞同：2
> 
> 时间：2012-06-12T21:27:37.257
> 
> 标签：macros, imacros

我正在努力了解如何在同一个 file.csv（或 .txt）上但在两个不同的列上保存两个不同的文本。

我已经构建了一个`.JS`生成随机文本，然后填充一些字段，然后继续使用宏的其余部分。

我想要做的是将那些文本（电子邮件，密码）保存在 .csv 但在`{{!COL1}}`&`{{!COL2}}`

有没有办法建立这样的东西？太感谢了！

eiifq83234

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T22:24:22.437

简单的解决方案只是将值添加到 !extract - 保存在 csv 文件中后，它会自动将其格式化为 2 个不同的列

```
set !extract username
add !extract password
saveas type=extract folder... 
```

# iphone - DismissViewController UIButton 导致应用程序在 iPod touch 上崩溃

> ID：11005152
> 
> 赞同：0
> 
> 时间：2012-06-12T21:27:51.753
> 
> 标签：iphone, user-interface, ipod-touch

`DismissViewController`UIButton 导致我的应用程序在 iPod touch 上进行测试时崩溃。否则，它在 iPhone 上运行良好。iPod 版本是 4.2.1。

我收到的信息是：

> dismissViewControllerAnimated:completion:]: 无法识别的选择器发送到实例 0x153720'

```
-(void)dismissViewDidFinish:(UIViewController *)viewController 
{

[self dismissViewControllerAnimated:YES completion:nil];

} 
```

这是 modalviewcontroller h 文件：

```
@class Info;

@protocol InfoDelegate 

-(void)dismissViewDidFinish:(UIViewController *)viewController;

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T02:00:05.787

您收到黄色警告

> 实例方法 -dismissViewController 未找到返回类型默认为 id -</p>

因为旧的弃用方法，dismissModalViewController 不需要“完成：”参数

iOS6 中的新方法可以。所以你应该改写：

```
[self dismissViewControllerAnimated:YES completion:nil]; 
```

它会找到它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:33:23.623

方法“dismissViewController”在哪里定义？这不是一个框架方法。如果您使用了示例中的代码，请确保您定义了您想要的方法。它不是 UIViewController 上的方法。

如果您试图从模态视图控制器中关闭模态视图控制器，方法是：

```
[self dismissModalViewControllerAnimated:YES]; 
```

# asp.net - 后退或前进时 ASP.net GridView 为空

> ID：11005155
> 
> 赞同：2
> 
> 时间：2012-06-12T21:28:17.287
> 
> 标签：asp.net, gridview

我有一个数据绑定`asp:GridView`：

```
<asp:GridView ID="gridUsers" runat="server" ShowHeaderWhenEmpty="True" Width="100%" AllowSorting="True" AutoGenerateColumns="False" DataSourceID="SqlDataSource1">
   <Columns>
       <asp:BoundField DataField="UserGUID" HeaderText="UserGUID" SortExpression="UserGUID" Visible="False" />
       <asp:HyperLinkField DataNavigateUrlFields="UserGUID" DataNavigateUrlFormatString="~\UserManagement\UserProperties.aspx?userGuid={0}" DataTextField="Username" HeaderText="User name" SortExpression="Username" />
       <asp:BoundField DataField="Fullname" HeaderText="Full name" SortExpression="Fullname" />
       <asp:BoundField DataField="Description" HeaderText="Description" SortExpression="Description"/>
       <asp:BoundField DataField="Email" HeaderText="E-mail" SortExpression="Email"/>
       <asp:BoundField DataField="IsActive" HeaderText="Active" SortExpression="IsActive" Visible="False" />
       <asp:BoundField DataField="AuthenticationType" HeaderText="Account type" SortExpression="AuthenticationType" />
    </Columns>
</asp:GridView>

<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:db %>"
    SelectCommand="SELECT UserGUID, Username, Fullname, Description, Email, IsActive, AuthenticationType FROM Users WHERE IsActive = 1 ORDER BY Username">
</asp:SqlDataSource> 
```

使用相应的代码隐藏：

```
public partial class FooItToHoo : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
    }
} 
```

当我浏览到页面时，网格可以正确填充：

但是当我**返回**然后**前进**（或导航到另一个页面并**返回**）时，网格是空的：

如果我按 F5，页面会刷新，并且网格存在并填充：

我究竟做错了什么？

* * *

**更新**：我的页面的初始请求没有被缓存；服务器的响应是：

```
HTTP/1.1 200 OK
Server: ASP.NET Development Server/10.0.0.0
Date: Wed, 13 Jun 2012 13:16:32 GMT
X-AspNet-Version: 4.0.30319
Cache-Control: private
Content-Type: text/html; charset=utf-8
Content-Length: 53219
Connection: Close 
```

在提供*的*html`asp:GridView`中呈现内容：

 *导航离开然后**返回**，没有服务器请求；所以页面必须从缓存中提供。

ASP.net 在做什么，呈现的页面包含内容，但“缓存”页面不包含内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T10:40:21.207

This seems to be cache problem. remove cache from your browser and use below code on your page to prevent your page from being caching.

The Meta tags:

```
 <meta http-equiv="Expires" CONTENT="0">
 <meta http-equiv="Cache-Control" CONTENT="no-cache">
 <meta http-equiv="Pragma" CONTENT="no-cache"> 
```

And the code:

```
Response.ExpiresAbsolute = DateTime.Now;
Response.Expires = -1441;
Response.CacheControl = "no-cache";
Response.AddHeader("Pragma", "no-cache");
Response.AddHeader("Pragma", "no-store");
Response.AddHeader("cache-control", "no-cache");
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.Cache.SetNoServerCaching(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T12:10:56.053

网格显示为空的原因是，当您单击下一步按钮时，没有可用于与网格绑定的数据源。所以为此你需要

选择gridview->转到属性窗口->单击事件按钮

双击 pageindexchangeing 事件

并设置

`Allowpaging=true`对于网格视图

在 pageindex 更改事件中编写以下代码

```
gridview1.pageindex=e.newpageindex;
//gridbindingcode

gridview1.databind(); 
```*

# activerecord - 由于属性更改而创建相关对象时出现 NameError

> ID：11005159
> 
> 赞同：0
> 
> 时间：2012-06-12T21:28:37.347
> 
> 标签：activerecord, camping

这就是我想要发生的事情：我的项目有很多动作。当 Item 的状态发生变化时，创建一个新的 Action。稍后，我将询问一个项目的相关操作。不幸的是，当我尝试通过状态更改进行操作时遇到以下异常：`NameError at /create; uninitialized constant Shiny::Models::Item::Action`.

这是我的模型：

```
module Models
  class Item < Base
    has_many :actions

    def status=(str)
      @status = str
      actions.create do |a|
        a.datetime = Time.now
        a.action = str
      end
    end
  end

  class Actions < Base
    belongs_to :item
  end

  class BasicFields < V 1.0
    def self.up
      create_table Item.table_name do |t|
        t.string :barcode
        t.string :model
        t.string :status
      end

      create_table Actions.table_name do |t|
        t.datetime :datetime
        t.string   :action
      end
    end
  end
end 
```

然后，在控制器中：

```
class Create
  def get
    i = Item.create
    i.barcode = @input['barcode']
    i.model = @input['model']
    i.status = @input['status']
    i.save

    render :done
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:02:15.547

在提交更好的答案来解释它的来源之前`Item::Action`，这是我修复它的方法：

```
module Models
  class Item < Base
    has_many :actions

    def status=(str)
      # Instance variables are not propagated to the database.
      #@status = str
      write_attribute :status, str
      self.actions.create do |a|
        a.datetime = Time.now
        a.action = str
      end
    end
  end

  # Action should be singular.
  #class Actions < Base
  class Action < Base
    belongs_to :item
  end

  class BasicFields < V 1.0
    def self.up
      create_table Item.table_name do |t|
        t.string :barcode
        t.string :model
        t.string :status
      end

      create_table Action.table_name do |t|
        # You have to explicitly declare the `*_id` column.
        t.integer  :item_id
        t.datetime :datetime
        t.string   :action
      end
    end
  end
end 
```

显然我是一个 AR 菜鸟。

# php - Xdebug 在启用远程调试的情况下使网站负载挂起

> ID：11005160
> 
> 赞同：3
> 
> 时间：2012-06-12T21:28:42.173
> 
> 标签：php, apache2, xdebug, virtualbox

我会尽量详细说明情况，但这让我困惑了太久。

我有一个在 Win7 主机上运行的 Ubuntu Server 12.04 来宾。我为 VBox 配置了 2 个 NIC：一个用于与外界通信的 NAT 适配器和一个用于为主机和来宾创建专用网络以进行通信的 Host-Only 适配器。LAMP 堆栈是 Ubuntu Server 12.04 提供的默认堆栈。来宾可以识别 NIC，并且 Host-Only NIC 具有静态 IP 配置。主机称为 192.168.56.1，来宾称为 192.168.56.101。我使用[本](http://christophermaier.name/blog/2010/09/01/host-only-networking-with-virtualbox)指南进行设置。`ifconfig`显示两个适配器。我通过 ping 测试了主机是否可以访问，我确实收到了回复。

我的一切工作正常：MySQL、PHP、Apache2、APC、共享文件夹挂载，并且该项目可以访问并尽可能快地加载。

这就是 xdebug 发挥作用的地方。只要我禁用远程调试器或告诉 xdebug 我的远程主机是 localhost，项目就会以不错的速度加载。但是，一旦我告诉 xdebug 远程主机不是 localhost 或者它应该连接回任何请求，页面加载似乎会在最终交付结果之前挂起*几分钟。*

我使用 Symfony2 开发，它有一个漂亮的开发人员工具栏，这个工具栏实际上告诉我页面加载花了 1174 毫秒。这让我怀疑它可能是 xdebug 和 Apache 玩得不好。以下是我尝试使用 xdebug 的非常基本的配置：

```
zend_extension=/usr/lib/php5/20090626/xdebug.so

xdebug.remote_enable=on
xdebug.remote_handler=dbgp
;xdebug.remote_connect_back=on
xdebug.remote_host=192.168.56.1
xdebug.remote_port=9000
xdebug.remote_log = /var/log/xdebug.log 
```

对于可能导致此问题的原因，我完全一无所知，非常感谢任何帮助。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:37:37.413

好吧，它并没有我想象的那么复杂。

Windows 防火墙阻止了该端口。在我认为我允许端口 9000 通过防火墙后，我决定通过完全关闭它来再次检查。低头看：它运行完美。所以我会把这个回复留在这里给遇到同样问题的人：

确保在使用类似结构时允许通过您选择的调试器端口进行通信！

# c - 如何在 ARM Cortex-M 上使用 GCC 定点类型扩展？

> ID：11005162
> 
> 赞同：12
> 
> 时间：2012-06-12T21:29:07.193
> 
> 标签：c, gcc, embedded, arm, fixed-point

我正在使用 ARM Cortex-M3 和 Cortex-M4。我想利用 GCC 的[定点类型扩展](http://gcc.gnu.org/onlinedocs/gcc/Fixed_002dPoint.html#Fixed_002dPoint)。我正在使用*summ-arm-toolchain*。以下代码行

```
_Fract f = 0.1; 
```

抛出以下编译错误：

```
error: fixed-point types not supported for this target 
```

GCC 真的不支持 Cortex-M3/M4 的定点类型，还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-14T22:26:21.463

只是为了记录，我会回答我自己的问题。

**TL;DR ：在 gcc 的***嵌入式*分支（4.6 版及更高版本）中，ARM Cortex-M/R 架构支持定点类型扩展。[在这里](https://launchpad.net/gcc-arm-embedded)可以找到基于该 gcc 分支的工具链。

**长答案**：

在撰写本文时，[*召唤臂工具链*](https://github.com/esden/summon-arm-toolchain)默认下载 linaro-gcc-4.5-2011.02（或 gcc-4.5.2）。默认情况下，它**没有启用***定点类型*扩展。我尝试将参数添加`--enable-fixed-point`到`configure`，但我得到了这个错误描述的编译[错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=34422)。我尝试使用较新版本的 (linaro-)gcc，但在将其自己提供的 gcc 补丁应用到此较新版本时，*召唤臂工具链遇到了问题。*我还尝试使用此工具链的*dev*分支（使用 linaro-gcc-4.6-2011.10）但没有成功。看起来，在这一点上，ARM Cortex-M/R 既不支持定点扩展，linaro-gcc 也不支持*gcc的主要*分支。

然后我尝试了[gcc-arm-embedded toolchain](https://launchpad.net/gcc-arm-embedded)，它基于 gcc 的*嵌入式*分支。对于目标 ARM Cortex-M3 和 Cortex-M4，我能够毫无问题地编译我*的定点类型示例程序。*2011 年末增加了对 Cortex-M/R 扩展的支持，正如在[这个线程](https://answers.launchpad.net/gcc-arm-embedded/+question/200553)中看到的那样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-14T18:10:40.333

根据[GCC Wiki](http://gcc.gnu.org/wiki/FixedPointArithmetic)`--enable-fixed-point` ，您可以通过在配置时将其作为参数传递给 GCC 来启用定点扩展。

此外，根据对此 gcc[错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=34422)和[此](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=38617)错误的评论。

> 目前仅 MIPS 目标支持定点支持。

# google-maps-api-3 - WOEID 到纬度，经度

> ID：11005163
> 
> 赞同：0
> 
> 时间：2012-06-12T21:29:07.887
> 
> 标签：google-maps-api-3, latitude-longitude

我正在制作一个简单的 web 应用程序，用户在其中输入 WOEID 并在地图上绘制位置。我目前正在使用 Google Maps API，据我所知它不支持 WOEID 绘图，所以我试图找到一种简单的方法来从 WOEID 获取 Lat/Lng 坐标。我知道雅虎的 PlaceFinder 应该可以工作，但它是为 Lat/Lng 到 WOEID 而设计的，而不是相反。

有没有从 WOEID 获取 Lat/Lng 的简单方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:38:07.617

您可以直接从 Yahoo 获取 Lat/Long。

[文档](http://developer.yahoo.com/geo/geoplanet/guide/api_docs.html)显示在 XML 响应中返回了 lat/long 。

```
<?xml version="1.0" encoding="UTF-8"?>
<place yahoo:uri="http://where.yahooapis.com/v1/place/2507854" xml:lang="en">
  <woeid>2507854</woeid>
  <placeTypeName code="7">Town</placeTypeName>
  <name>Trenton</name>
  <country type="Country" code="US">United States</country>
  <admin1 type="State" code="NJ">New Jersey</admin1>
  <admin2 type="County" code="">Mercer</admin2>
  <admin3/>
  <locality1>Trenton</locality1>
  <locality2/>
  <postal/>
  <centroid>
    <latitude>40.21777</latitude>
    <longitude>-74.759361</longitude>
  </centroid>
  <boundingBox>
    <southWest>
      <latitude>40.183868</latitude>
      <longitude>-74.819519</longitude>
    </southWest>
    <northEast>
      <latitude>40.248291</latitude>
      <longitude>-74.728798</longitude>
    </northEast>
  </boundingBox>
</place> 
```

您感兴趣的可能是`centroid`元素。

# android - osmdroid 中的 MyLocationOverlay

> ID：11005168
> 
> 赞同：1
> 
> 时间：2012-06-12T21:29:45.810
> 
> 标签：android, mapping, location, osmdroid, mylocationoverlay

我正在使用 osmdroid 映射 API 的 android 映射应用程序中工作，直到现在我能够显示地图（使用 MapView 类），但我想知道如何在地图上显示我的位置，在我阅读后我知道有一个名为 MyLocationOverlay 的类我正在尝试使用它，但应用程序返回一个空白页。这是我的代码：

```
public class AbodyActivity extends Activity 
{
private MapView mapView; 
private MapController mapController;
private MyLocationOverlay myLocationoverlay;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    initializemap();
    myLocationoverlay = new MyLocationOverlay(this, mapView);
    myLocationoverlay.disableMyLocation(); // not on by default
    myLocationoverlay.disableCompass();
    myLocationoverlay.disableFollowLocation();
    myLocationoverlay.setDrawAccuracyEnabled(true);
    myLocationoverlay.runOnFirstFix(new Runnable() {
    public void run() {
            mapController.animateTo(myLocationoverlay
                    .getMyLocation());
        }
    });
    mapView.getOverlays().add(myLocationoverlay);
}
public void initializemap()
{
mapView = (MapView) this.findViewById(R.id.mapView); 
mapView.setTileSource(TileSourceFactory.MAPNIK); 
mapView.setBuiltInZoomControls(true); 
mapView.setMultiTouchControls(true); 
mapController = this.mapView.getController();     
mapController.setZoom(6);
}

} 
```

这也是我使用的权限：

```
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T17:34:40.923

Are you sure that:

```
myLocationoverlay.disableMyLocation(); 
```

Doesn't disable the location finder methods so your `Runnable` is never called?

# javascript - 调试：未调用 Mouseover 函数

> ID：11005172
> 
> 赞同：0
> 
> 时间：2012-06-12T21:29:51.693
> 
> 标签：javascript, debugging, function

我曾经有过这样的事情：

```
$(function() {
$(".PortfolioFade img")
    .mouseover(function() { 
                    popup('PORTFOLIO');
                    var src = $(this).attr("src").replace("images/paperclip.png", "images/paperclip-black.png");
        $(this).attr("src", src);
    })
    .mouseout(function() {
                    ;
    });
    }); 
```

当我试图把它变成一个函数并调用它时，它根本不起作用。图像没有被替换。

以下是不起作用的函数和后续调用，我不知道为什么它不起作用。

```
 $(document).ready(function() {
   // put all your jQuery goodness in here.
   $('body').hide().fadeIn(1000);

   //Changing Fonts
   function changeFont(element, fontFamily, fontSize)
{
    $(element).css("font-family", fontFamily);
    $(element).css("font-size", fontSize);
}
    function ImageRollover(image_element, popup_name, original, replacement)
{
    $(element)
        .mouseover(function(){
            popup(popup_name);
            var src = $(this).attr("src").replace(original,replacement);
            $(this).attr("src",src);

        })
        .mouseout(function(){
            ;
        });
}

$(function) {
   ImageRollover(".Portfolio img",'PORTFOLIO',"images/paperclip.png","images/paperclip-black.png");
});

 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:32:40.567

编辑：对不起，我首先应该看到的是你的`ImageRollover()`函数声明了一个参数`image_element`，但是在你使用的函数中`element`。所以在功能变化中：

```
$(element)
    .mouseover(function(){ 
```

至：

```
$(image_element)
    .mouseover(function(){ 
```

（忘记我之前说过的话。）

~~您的原始版本具有但新版本没有的是文档就绪处理程序。尝试将您的`ImageRollover`函数调用放入准备好的文档中，如下所示：~~

 ~~```
$(function() {
   ImageRollover(".Portfolio img",'PORTFOLIO',"images/paperclip.png","images/paperclip-black.png");
}); 
```~~ 

您不能将事件处理程序附加到尚未解析的元素 - 在整个文档被解析之前不会调用文档就绪处理程序，因此此时您*可以*附加事件处理程序。或者，您可以将脚本放在它所操作的元素之后的某个位置，例如，在正文的末尾。

~~我也倾向于将`ImageRollover`函数声明移动到准备好的文档中，只是为了让它远离全局命名空间（假设你只从准备好的文档中调用它），尽管这不是让它工作的必要条件。~~

# jquery - jQuery box shuffle 动画

> ID：11005175
> 
> 赞同：0
> 
> 时间：2012-06-12T21:30:30.803
> 
> 标签：jquery, animation

我目前正在尝试使用三个图像用jquery创建一个（我认为的）简单动画，基本上我想做的是在点击功能上让三个盒子从左到右快速移动然后停止回到同一个位置，然后在最后有一个函数，我可以在最后输入代码，

HTML

```
<div id="shuffleGame" class="clearfix" style="position: relative; overflow: visible;">
<img src="http://dev.thefragilemachine.com/capita/instantwin/imgs/gift_close.png" >
<img src="http://dev.thefragilemachine.com/capita/instantwin/imgs/gift_close.png" style="margin-left:10px; margin-right:10px;">
<img src="http://dev.thefragilemachine.com/capita/instantwin/imgs/gift_close.png" >
</div> 
```

查询

```
 $("a.goBtn").click(function (e) {
        e.preventDefault()
        $("div#theCards").hide();
        $("div#shuffleGame").fadeIn("fast");
        $("a.goBtn").fadeOut("slow");

        //Animations

     }); //$("a.goBtn").click(function { }); 
```

您可以在此处查看我尝试执行的操作：dev.thefragilemachine.com/capita/instantwin/ani2.html，尽管实际上并没有发生任何事情。

感谢您的帮助，抱歉，如果这没有多大意义，请写这种快速谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:11:48.347

刚刚想通了，通过使用带有动画的jQuery队列，谢谢！

[http://api.jquery.com/queue/](http://api.jquery.com/queue/)

# mysql - 需要帮助创建 SQL 查询

> ID：11005178
> 
> 赞同：2
> 
> 时间：2012-06-12T21:30:50.240
> 
> 标签：mysql, sql

因此，我有两张桌子：

```
 CREATE TABLE `workers` (
  `id` int(7) NOT NULL AUTO_INCREMENT,
  `number` int(7) NOT NULL,
  `percent` int(3) NOT NULL,
  `order` int(7) NOT NULL,
      PRIMARY KEY (`id`)
 );
 CREATE `data` (
  `id` bigint(15) NOT NULL AUTO_INCREMENT,
  `workerId` int(7) NOT NULL,
  PRIMARY KEY (`id`)
 ); 
```

我想返回第一个工人（按`order`ASC 排序），他的表中的行数`data`乘以`percent`（来自 table `workers`）/100 小于`number`（来自 table `workers`.

我试过这个查询：

```
SELECT workers.id, COUNT(data.id) AS `countOfData`
FROM `workers` as workers, `data` as data
WHERE data.workerId = workers.id
   AND workers.percent * `countOfData` < workers.number
LIMIT 1 
```

但我得到了错误：

```
#1054 - Unknown column 'countOfData' in 'where clause' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:39:13.120

这应该有效：

```
SELECT A.id
FROM workers A
LEFT JOIN (SELECT workerId, COUNT(*) AS Quant
            FROM data
            GROUP BY workerId) B
ON A.id = B.workerId
WHERE (COALESCE(Quant,0) * `percent`)/100 < `number`
ORDER BY `order`
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:40:57.520

您可以计算子查询中每个工作人员的行数。子查询可以连接到工作表。如果您使用 a `left join`，将考虑没有数据行的工作人员：

```
select  *
from    workers w
left join    
        (
        select  workerId
        ,       count(*) as cnt
        from    data
        group by
                workerId
        ) d
on      w.id = d.workerId
where   coalesce(d.cnt, 0) * w.percent / 100 < w.number
order by
        w.order
limit   1 
```

# ruby-on-rails-3 - Ruby on Rails - 电子邮件解析中字符串到数组的奇怪格式

> ID：11005186
> 
> 赞同：0
> 
> 时间：2012-06-12T21:31:39.900
> 
> 标签：ruby-on-rails-3

我可以像这样以字符串格式获取电子邮件的正文

> 身体 = 参数 [:plain]

当我输出它时，它看起来像：

> 你好呀。
> 
> ——
> 约翰·B。
> 
> 从我的iPhone发送。

现在，当我尝试按换行符拆分时，`body.split("\n")`我得到：

> ----
> - ！'你好呀。'
> - ''
> - ！'-'
> - John B.
> - ''
> - 从我的 iPhone 发送。

我真的不明白额外的连字符和刘海。有什么想法吗？

另外，如果我这样做，`body[2]`我会得到`--`，但`body.index("--")`什么也没给我。

更新

在我的 ReceivingMails 控制器中：

```
...

def create
  body = params[:plain]
  parsed_body = parse_body(body)
  Comment.new(:content => parsed_body)
end

private

def parse_body(body)
  split = body.split("\n")
  sig_index = split.index("-- ")
  return split[0, sig_index].join("\n")
end 
```

在我看来，评论显示为：`<%= simple_format(comment.content)%>`

更新 2

当我做类似的事情时，`body.split("\n").to_s`我得到了预期的数组应该是什么样的（作为字符串）：`["Hi there. ", "", "-- ", "John B.", "", "Sent from my iPhone."]`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:48:46.053

我不认为 params[:plain] 实际上是一个字符串 - 我认为你应该测试它以找出它实际上是什么。例如尝试：

`puts params[:plain].class`

# java - BroadcastReceiver onReceive函数中调用类函数

> ID：11005187
> 
> 赞同：1
> 
> 时间：2012-06-12T21:31:40.990
> 
> 标签：java, android

我有一个服务`BroadcastReceiver`。
如何从 的函数调用服务类中的`onReceive`函数`BroadcastReceiver`？
如果我不能，我能做什么？
这是一些代码：

```
public class MyService extends Service {
    private BroadcastReceiver broadcastReceiver;

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    }

    @Override
    public void onCreate() {
        broadcastReceiver = new BroadcastReceiver() {
            @Override
            public void onReceive(Context context, Intent intent) {
                ... // How to call myFunction() here?
            }
        };
        ... // intentFilter, registerReceiver, etc...
    }

    private void myFunction() {
        ... // do something
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T21:49:45.567

你可以这样称呼它：

```
 broadcastReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            myFunction();
        }
    }; 
```

或者，如果与方法`myFunction`同名`BroadcastReceiver`，您可以像这样显式调用外部类方法：

```
 broadcastReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            MyService.this.myFunction();
        }
    }; 
```

# javascript - 如何访问backbone.js 中的特定视图？

> ID：11005188
> 
> 赞同：0
> 
> 时间：2012-06-12T21:31:50.157
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我有一个生成列表项视图的主干 viev。在渲染函数中，它遍历集合并使用一些标准代码生成每个子项视图，如下所示：

```
render: function () {
    _(this.collection.models).each(function(item){
        $this.appendItem(item);
     }, this);          
}, 
```

我想知道如何从项目列表中访问特定视图，比如在位置 0 或其他位置。我希望能够从该特定项目的项目列表视图中触发一个功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:42:56.957

嗯，这取决于`appendItem`函数是如何实现的，我猜你在哪里构建*SubViews*。

您可以将每个创建的子视图存储在一个数组中，这样数组将为您提供一种操作子视图的方法。

但如果我能提供一条建议，我会说这从一开始就是一种*代码味道*。您可以操作与 SubView 关联的 Model 并使 SubView 监听此更改，而不是尝试操作具体的 SubView。

然后您将开始考虑操作模型而不是视图。

# php - 使用图像创建功能

> ID：11005197
> 
> 赞同：1
> 
> 时间：2012-06-12T21:32:34.077
> 
> 标签：php, gd

我正在使用创建图像功能使用以下代码创建带有确切文本消息的图像

```
<?PHP
header ("Content-type: image/gif");
$image=imagecreatefromgif("myimage.gif"); // will be background img
$black = imagecolorallocate($image, 0,0,0);
$message = "Hello Egypt";
imagestring($image, 4, 25, 10, $message, $black);
imagegif($image);
imagedestroy($image);
?> 
```

输出应该是这样的

![你好埃及](../Images/172155043ddad0d49c47203a6cefe44e.png)

**现在我的问题**是有什么办法我可以在它上面写图像，而不仅仅是文本，这样如果我在同一路径（`flag.gif` ![旗帜](../Images/bee7e6861203791ceb20b2f654b79892.png)）上标记图像并且我想在我之后写它`$message`就像这样

![你好埃及国旗](../Images/2eaa25726d53375e5093f63c8d866522.png)

这可能吗？怎么可能！~ 非常感谢

**更新** 基于@MarcB 使用`imagecopy`函数的思想

```
<?PHP
header ("Content-type: image/gif");
$image=imagecreatefromgif("myimage.gif"); // will be background img

$src = imagecreatefromjpeg('flag.jpg');// new image will add
imagecopy($image, $src, 120, 10, 0, 0, 32, 20);

$black = imagecolorallocate($image, 0,0,0);
$message = "Hello Egypt";
imagestring($image, 4, 25, 10, $message, $black);

imagegif($image);
imagedestroy($image);
?> 
```

输出不是真彩色为什么:(

![在此处输入图像描述](../Images/65007284391ae5fbc5c1d17cad53a4f6.png)

关于这个新问题的任何帮助~谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T22:34:19.867

在和的帮助下`Surreal Dreams`，`Marc B` 这个工作正常

```
<?PHP
header ("Content-type: image/gif");

$image=imagecreatefromjpeg("myimage.jpg"); // will be background img

$src = imagecreatefromjpeg('flag.jpg');// new image will add

imagecopy($image, $src, 120, 10, 0, 0, 32, 20);

$black = imagecolorallocate($image, 0,0,0);
$message = "Hello Egypt";

imagestring($image, 4, 25, 10, $message, $black);
imagegif($image);
imagedestroy($image);
?> 
```

输出

![在此处输入图像描述](../Images/15f76ad235a553a214dfd122c059ca46.png)

我应该已经学会了以下功能

1.  [`imagecopy`](http://www.php.net/manual/en/function.imagecopy.php)
2.  [`imagecreatefromjpeg`](http://www.php.net/manual/en/function.imagecreatefromjpeg.php)
3.  [`imagecreatefromgif`](http://www.php.net/manual/en/function.imagecreatefromgif.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:50:25.000

imagecopy() 应该正确[处理图像调色板之间的差异](http://www.boutell.com/gd/manual2.0.33.html#gdImageCopy)；但是，GIF 格式不支持超过 256 种颜色，GD 在处理基于调色板的图像时也不支持。如果 GD 尝试使用新颜色时已经存在 256 个调色板条目，GD 将选择最接近的匹配，这可以产生您看到的结果。

为避免此问题，应使用[imagecreatetruecolor()](http://us.php.net/manual/en/function.imagecreatetruecolor.php)在内存中创建 24 位真彩色图像。然后，您可以使用 imagecopy() 插入每个 GIF 图像（包括背景）和[imagepng()](http://us.php.net/manual/en/function.imagepng.php)生成 PNG 输出，这比 JPEG 更适合线条艺术，提供比 GIF 更好的压缩，并且可以支持超过 256 种颜色。

# php - 在 PHP 字符串中格式化 MySQL 代码

> ID：11005200
> 
> 赞同：24
> 
> 时间：2012-06-12T21:32:39.710
> 
> 标签：php, mysql, format

是否有任何程序 IDE 可以在 PHP 字符串中格式化 MySQL 代码，例如我使用 PHPStorm IDE，但它不能这样做。

它适用于 PHP 和 MYSQL，但不适用于 php 字符串中的 MYSQL。我已经准备好使用新的 IDE，因为现在我必须手动格式化数百个单行且不可读的数据库请求。我选择的唯一标准是 ide 可以自动执行此操作。

```
<?php
...
$request1 = "select * from tbl_admin where admin_id= {$_SESSION['admin_id']} and active= 1 order By admin_id Asc";
...
?> 
```

应该成为

```
<?php
...
$request1 = "SELECT * 
               FROM tbl_admin 
                  WHERE admin_id = {$_SESSION['admin_id']}
                  AND active = 1
                      ORDER BY admin_id ASC";
...
?> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-20T16:33:51.080

在我看来，最好的方法是使用正则表达式或 SED/AWK 来格式化所有内容，它为我们提供了即时替换地图的好处。不过，您可能有代码错误的可能性很高，所以这有点困难。

让我稍微研究一下，看看我能不能想出一个好的解决方案。是否保证您将所有 SQL 封装在双引号中？

**编辑**

尝试这个

```
cd {{directory}} && find . -type f -print0 |
  xargs -0 perl -i.bak -pe 's/select/SELECT/g ; s/from/\n\tFROM/g ; s/where/\n\t\tWHERE/g ; s/and/\n\t\tAND/g ; s/order by/\n\t\tORDER BY/g ; s/asc/ASC/g ; s/desc/DESC/g ;' 
```

这是一个例子

```
$ printf '"select * from whatever where this = that and active = 1 order by something asc";\n' |
> perl -pe 's/select/SELECT/g ; s/from/\n\tFROM/g ; s/where/\n\t\tWHERE/g ; s/and/\n\t\tAND/g ; s/order by/\n\t\tORDER BY/g ; s/asc/ASC/g ; s/desc/DESC/g ;'

"SELECT * 
    FROM whatever 
        WHERE this = that 
        AND active = 1 
        ORDER BY something ASC"; 
```

漂亮吗？不，一点也不，它有用吗....是的。

我会尝试创建一个过滤器文件，也许是一个小 bash 程序或其他东西，因为我有时间运行这个热的烂摊子。

**编辑**

这是一些修改后的代码，看起来更漂亮（排序）

```
printf '$request1 = "select * from whatever where this = that and active = 1 order by something asc";\n' | 
perl -pe 's/select/SELECT/gi ; s/from/\n  FROM/gi ; s/where/\n    WHERE/gi ; s/and/\n    AND/gi ; s/order by/\n      ORDER BY/gi ; s/asc/ASC/gi ; s/desc/DESC/gi ;' | 
awk 'NR == 1 {pad = length($0)/2; print} NR > 1 {gsub(/\r/,""); printf "%*s%s\n", pad, " ", $0}'

__OUTPUTS__
$request1 = "SELECT * 
             FROM whatever 
               WHERE this = that 
               AND active = 1 
                 ORDER BY something ASC"; 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-12T21:42:50.343

据我所知，PhpStorm 可以做到，如果你使用 heredoc 语法

```
$request1 = <<<SQL
   SELECT * 
           FROM tbl_admin 
              WHERE admin_id = {$_SESSION['admin_id']}
              AND active = 1
                  ORDER BY admin_id ASC
SQL; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-20T10:28:47.873

## 答案是不。

作为替代解决方案，我可以建议将文本（*.php 文件中的所有 PHP 代码）复制到[Heidisql](http://www.heidisql.com/)的查询编辑器中，单击重新格式化并复制回 NetBeans 并按 Alt+Shift+F。这将格式化 sql 并在之后格式化 php 代码，保留 sql 格式。因此，您不是在使用插件，而是在复制、格式化整个文件、复制回来并再次格式化。

您可以使用此工具代替 HeidiSQL，如果您对此类 Web 工具感到满意，[该工具专注于格式化。](http://www.dpriver.com/pp/sqlformat.htm)

如果您想要更多的自动化，您可以使用 netbeans 的正则表达式支持来格式化与反斜杠 n = \n 的新行之前的每个“插入、更新、删除、选择、位置和值”术语运行这 6 次将替换所有“插入” <- 空白加插入，在您的项目中使用新行。您可以编写一个正则表达式来搜索所有“空白加保留字”组合并将它们替换为新行。

您也可以使用它，例如搜索“insert”并替换为“\n\t insert”，这将创建一个新行和一个选项卡

![在此处输入图像描述](../Images/98ffe613d45f6c99ad2d961c65a36218.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-22T23:01:22.787

由于您的问题是格式化现有代码体，因此您不需要 IDE。您需要一个脚本来批处理所有文件一次，然后您就可以忘记它。这是脚本需要做的：

1.  正确解析*PHP*字符串，包括带有各种嵌入或转义引号的字符串。这应该是防弹的，并且应该只关心 PHP 语法。
2.  使用检测 SQL 命令的算法检查每个 PHP 字符串。这可以根据您的需要变得聪明（例如，无需盲目地接受每个包含单词“insert”的字符串）。
3.  通过 SQL 漂亮打印机提供已识别的字符串。
4.  编辑输入文件，用格式化字符串替换原始文件。

理想情况下，第 1 部分和第 3 部分应由现成的模块处理。其余的应该很容易自己组装，对吧？

**更新：**解释这听起来很简单，我决定自己做。这是一个快速的解决方案。它在 python 中，但如果你愿意切换 IDE，你可以处理安装 python，对吗？

将任意数量的 php 文件拖放到脚本上，或从命令行调用它，它将通过@Parahat 建议的[SQLFormat API过滤 SQL 位。](http://sqlformat.appspot.com/api/)**它会在原地**编辑文件，因此请保留一份副本！

```
"""Format sql strings embedded in php code, editing source IN PLACE"""
import sys, re, urllib, urllib2

def processfile(fname):
    with open(fname) as fp:
        text = fp.read()

    with open(fname, "w") as out:
        for token in chunk(text):
            if is_sql_string(token):
                token = token[0] + sqlformat(token[1:-1]) + token[0]
            out.write(token)

def sqlformat(query):
    sqlapi = 'http://sqlformat.appspot.com/format/?keyword_case=upper&reindent=1&n_indents=4&'
    return urllib2.urlopen(sqlapi+urllib.urlencode({'data':query})).read()

php_mode = False # global, so that is_sql_string() can examine it
def chunk(src):
    """Chunk the php file into interesting units"""
    global php_mode
    while src:
        if not php_mode: # Read up to the next php group, if any
            m = re.match(r".*?<\?php", src, re.S)
            if m:
                tok, src = _usematch(m, src)
                yield tok
                php_mode = True
            else: # No more php groups: EOF
                yield src
                return

        else:  # Reading php code
            # PHP ends without another string?
            m = re.match(r"[^'\"]*?\?>", src, re.S)
            if m:
                tok, src = _usematch(m, src)
                yield tok
                php_mode = False
                continue

            # at non-string material?
            m = re.match(r"[^'\"]+", src) 
            if m:
                tok, src = _usematch(m, src)
                yield tok
                continue

            # Parse a string: Smallest quote-delimited sequence,
            # where closing quote is not preceded by backslash
            m = re.match(r'".*?(?<!\\)"|' + r"'.*?(?<!\\)'", src, re.S)
            if m:
                tok, src = _usematch(m, src)
                yield tok
                continue

            # Something I can't parse: advance one char and hope for the best
            tok, src = src[0], src[1:]
            yield tok

def _usematch(m, inp):
    return m.group(), inp[m.end():] # Matched chunk & remaining input

# To recognize an sql command, it MUST begin with one of these words
sql_commands = set("select insert update delete create drop alter declare".split())
def is_sql_string(tok):
    if not php_mode or len(tok) < 3 or tok[0] not in set("\"'"):
        return False    
    tokwords = tok[1:-1].split()
    return tokwords and tokwords[0].lower() in sql_commands

for fname in sys.argv[1:]:
    processfile(fname) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-22T10:06:21.963

考虑到这个问题：是否有一个IDE会自动格式化sql查询，我必须同意ugurcode。答案很简单：没有。并且有充分的理由。

基本上，SQL 查询只不过是任何 IDE 中的字符串。由于字符串可以包含有意的空格和制表符，如果 IDE 重新格式化字符串内容，那将是非常糟糕的。

适用于任何 IDE 的唯一选项是在字符串的开头检测 INSERT、UPDATE、DELETE，然后格式化字符串的其余部分。当然，它也会尝试对显示“插入引号”的字符串执行相同操作这里..”，这又是一件坏事。

因为我不想让你一无所有，所以我会就一个好的 IDE 给你建议，让你选择哪个实际上可以进行正确的代码格式化、代码完成、良好的缩进、插件等。基本上是 php 的最佳 IDE开发（至少它是我多年专业 php 开发中发现的最好的）。

Netbeans 将是您的首选 IDE。它比 Eclipse/PHP 更快，比 codelobster 等更稳定。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-06-26T20:38:24.437

在 PHPStorm 中，您可以为您的项目指定 SQL 方言：http: [//www.jetbrains.com/phpstorm/webhelp/sql-dialects.html](http://www.jetbrains.com/phpstorm/webhelp/sql-dialects.html)

接下来，您必须设置数据源： http: [//www.jetbrains.com/phpstorm/webhelp/data-sources-2.html](http://www.jetbrains.com/phpstorm/webhelp/data-sources-2.html)

之后，您的 IDE 将支持表（字段）的 SQL 语法和自动完成功能。

* * *

此外，还有一个页面，您可以在其中指定 SQL 代码样式： http: [//www.jetbrains.com/phpstorm/webhelp/code-style-sql.html](http://www.jetbrains.com/phpstorm/webhelp/code-style-sql.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-21T21:12:15.990

1.  记录、分析您的 SQL 语句。
2.  使用一个外部服务，比如这个 - [SQLFormat API](http://sqlformat.appspot.com/api/) - 来格式化你的 SQL 语句
3.  您也可以在下载 Python 源代码的机器上运行它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-06-25T09:05:37.657

我总是使用[SQLyog](http://www.webyog.com/en/sqlyog_feature_matrix.php)来格式化我的 SQL 语句并将它们粘贴回 IDE，因为我也没有找到能够在 php 块中格式化 sql 的 IDE。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-06-19T23:28:44.803

没有这样的IDE。也许某些 SQL 被分解为多个字符串连接，或者某些 SQL 是使用某个迭代器生成的。或者它可能包含无效的 SQL，例如`{$_SESSION['admin_id']}`.

您唯一的机会是编写一个小脚本，调整以匹配编码风格和可能的无效 SQL 内容，这将修复所有应用程序源代码文件。你需要几个小时才能把它弄好，但最终你将不需要一个不存在的 IDE，你将拥有一个漂亮的僵化 SQL 和更好的源代码。

（以上是一个解决方案，认为您在整个应用程序中有数百条 SQL 语句；如果没有，则只需手动修复它们）。

编辑：确保将所有更改记录在比较表中，以便您可以查看脚本格式化的所有内容。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-06-21T16:32:21.480

在 MySQL Workbench 中编写查询，然后编辑->格式->美化查询

然后将查询粘贴到 netbeans 中，选择测试和选项卡。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-06-20T10:51:16.143

可能是 nuSphere 调试器以某种方式帮助您执行此操作这里是链接[nuSphere](http://www.nusphere.com/download.php.ide.htm)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-06-25T08:10:27.463

您可以使用[`tokenizer`](http://sg.php.net/tokenizer)扩展来编写格式化 SQL 的脚本。

可以从命令行调用以下脚本，它从标准输入读取并写入标准输出。它处理两种引用样式（双引号或单引号）。

根据起始词扫描所有字符串以查找可能的 SQL 语法，并在每个关键字之前插入换行符；起始词和关键字都是可扩展的，所以去狂野吧:)

```
<?php

$tokens = token_get_all(file_get_contents('php://stdin'));

function token_value($token)
{
        return is_array($token) ? $token[1] : $token;
}

function sql_format($s)
{
        if (preg_match("/^(?:select|insert|update|delete)/i", $s)) {
                // prefix newline and tab before every keyword
                return preg_replace('/\b(from|where|and|order|group by)/i', "\n\t\\0", $s);
        }
        return $s;
}

$target = '';
$i = 0; $n = count($tokens);
while ($i < $n) {
        $token = $tokens[$i];
        if ($token === '"') {
                $s = ''; ++$i;
                while ($i < $n && $tokens[$i] !== '"') {
                        $s .= token_value($tokens[$i]);
                        ++$i;
                }
                if ($i < $n) {
                        ++$i;
                }
                $target .= '"' . sql_format($s) . '"';
        } elseif (is_array($token) && $token[0] === T_CONSTANT_ENCAPSED_STRING) {
                $quote_style = $token[1][0];
                $target .= $quote_style . sql_format(trim($token[1], "'\"")) . $quote_style;
                ++$i;
        } else {
                $target .= token_value($token);
                ++$i;
        }
}

echo $target; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-06-24T08:26:40.517

我为 MS SQL Server 和 C# 代码构建了一个工具来执行此操作。我很乐意为此目的更改工具，但需要支付少量费用。 [http://www.softfrontiers.com/Downloads/ReIndenter.shtml](http://www.softfrontiers.com/Downloads/ReIndenter.shtml)

我的一两个小时的时间将为您节省许多小时的挫败感。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-06-26T10:47:47.890

您问：

> 是否有任何程序IDE可以在PHP字符串中格式化MySQL代码

特别是这个 PHP 字符串定义：

> ```
> $request1 = "select * from tbl_admin where admin_id= {$_SESSION['admin_id']} and active= 1 order By admin_id Asc"; 
> ```

答案是否定的。IDE 中的 PHP 解析器或运行 PHP 的`token_get_all`.

首先，`token_get_all`您应该能够提取对您的情况有意义的部分进行编辑。这里有上下文：

> `<309:T_VARIABLE> "$request1" <371:T_WHITESPACE> " " "=" <371:T_WHITESPACE> " " """ <314:T_ENCAPSED_AND_WHITESPACE> "select * from tbl_admin where admin_id= " <375:T_CURLY_OPEN> "{" <309:T_VARIABLE> "$_SESSION" "[" <315:T_CONSTANT_ENCAPSED_STRING> "'admin_id'" "]" "}" <314:T_ENCAPSED_AND_WHITESPACE> " and active= 1 order By admin_id Asc" """ ";"`

正如这些标记所示，有很多额外的工作要从中提取你所说的字符串：

> `$request1 = "select * from tbl_admin where admin_id= {$_SESSION['admin_id']} and active= 1 order By admin_id Asc"`

这需要在令牌中进行管理和标识：

> `<314:T_ENCAPSED_AND_WHITESPACE> "select * from tbl_admin where admin_id= " <375:T_CURLY_OPEN> "{" <309:T_VARIABLE> "$_SESSION" "[" <315:T_CONSTANT_ENCAPSED_STRING> "'admin_id'" "]" "}" <314:T_ENCAPSED_AND_WHITESPACE> " and active= 1 order By admin_id Asc"`

如本例所示，这不是真正的 SQL。因此，您不仅需要找到一个 SQL 解析器（它存在于 PHP 中，请参阅[Parsing sql query PHP](https://stackoverflow.com/q/11051711/367456)），而且您还需要让该 SQL 解析器知道 PHP 变量替换，就像`{$_SESSION['admin_id']}`您的情况一样。对你来说它是一个变量，对于 SQL 解析器来说，如果不是错误的话，这只是一个怪异的语法汤。

您的小代码示例是一个很好的示例：它已经表明没有关于将被替换的字符串的性质的信息。由于此信息被隐藏，SQL 解析器将永远无法将此字符串视为格式正确的内容。

所以为了让我的回答“不”更深刻：因为没有关于如何在高级语言级别处理多个结果的通用工具（PHP 字符串在 SQL 中有多个可能正确的表示，只有变量内容的作者才能知道哪个一个是正​​确的）已经存在，没有可用的通用解决方案。

您可能只想在您的代码库中启动一些正则表达式，然后将您感到满意的结果一起闪电战，并且确实值得考虑使用[ehime](https://stackoverflow.com/a/11124066/367456)排队的工具。

但可能值得花时间并首先从 PHP 令牌流中提取字符串，重新格式化字符串，然后继续输出结果。这是 perl 和正则表达式不能给你的东西，因为它们没有 PHP 标记器。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-06-26T21:16:33.563

如果所有许多 IDE 都不支持这样的事情，那么在大多数情况下是有原因的。请考虑为您的工作准备好的语句或对象包装器。我知道这两件事不能在几分钟内在每个系统中实现，但是您的代码将变得可维护。

简而言之：**IDE 无法纠正设计错误。他们只是让他们看起来漂亮和有色。**

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-10-09T09:36:13.220

我用过 PHPDesigner。我认为这将满足您的期望。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-01T09:12:12.587

派对迟到了，但是...

```
function formatSQL($txt){
    $txt = str_replace('SELECT ', "\nSELECT", $txt);
    $txt = str_replace(' MATCH', "\nMATCH", $txt);
    $txt = str_replace(' AGAINST', "\nAGAINST", $txt);
    $txt = str_replace(' OR ', "\nOR", $txt);
    $txt = str_replace(' AND ', "\n\tAND ", $txt);
    $txt = str_replace(' FROM ', "\nFROM", $txt);
    $txt = str_replace(' WHERE ', "\nWHERE", $txt);
    $txt = str_replace(' ORDER ', "\nORDER", $txt);
    return $txt;
} 
```

# javascript - 在 Google Chrome 中捕获下载

> ID：11005202
> 
> 赞同：3
> 
> 时间：2012-06-12T21:32:49.460
> 
> 标签：javascript, google-chrome, google-chrome-extension, download

我环顾四周，找不到任何可以让我检测到 Chrome 中下载何时完成的东西。

我想这样做的原因是我想在下载后更好地“排序”我的下载，自动根据各种标准。

我尝试使用以下命令设置侦听器：webRequest.onCompleted 虽然这似乎适用于大多数资源（图像、.ico 等），但我无法让它捕获 .ZIP 或 .EXE 文件下载。我不确定为什么它不会，但它可以毫无问题地适用于其他资源。

我没有对其设置过滤器，因此它应该（据我所知）拉入所有资源并检查它们是否有指定的扩展。我知道这可能不是最好的检查方法，但我还没有找到更好的方法。

查看实验性下载 API，这似乎也没有达到我想要的效果，因为它主要只是启动下载，这不是我想要做的。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T08:52:43.510

Haven't seen an extension for this, but when you think about it this kind of makes sense. It almost seems like something that should be native to the browser...I guess it does give you the most recent downloads though and that is relevant to your current task. Anyways, thought I would mention that there is an experimental api that allows interaction with the native download interactions. This may be a reference needed in getting the extension cooking. Good luck

Link to Experimental API:
[http://developer.chrome.com/extensions/experimental.downloads.html](http://developer.chrome.com/extensions/experimental.downloads.html)

# ios - ios 6.0 版不推荐使用最小字体大小

> ID：11005207
> 
> 赞同：92
> 
> 时间：2012-06-12T21:33:17.683
> 
> 标签：ios, xcode, uilabel, deprecated, font-size

我刚刚升级到带有 iOS 6.0 的 xcode 4.5，它突出显示了我的 XIB 文件中所有 UILabel 的警告，上面写着“ios 6.0 版不推荐使用最小字体大小”。有谁知道这是指什么以及如何解决它？

**更新：** 图像不再可用（位于[https://skitch.com/hahmadi82/eyk51/cloud](https://skitch.com/hahmadi82/eyk51/cloud)）

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-03-03T06:19:34.023

`minimumFontSize`的属性`UILabel`从 iOS 6.0 开始被弃用。

`minimumFontSize`is的替代方案`minimumScaleFactor`。如果分配`minimumFontSize/defaultFontSize`给`minimumScaleFactor`，它的工作方式与 minimumFontSize 相同。

代码如下 - 例如字体大小为 30.0，如果您希望最小字体大小为 12.0

```
YOURLABEL.font= [UIFont fontWithName:@"FONT_NAME" size:30.0];
[YOURLABEL setMinimumScaleFactor:12.0/[UIFont labelFontSize]]; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-18T11:53:51.777

改用 minimumScaleFactor... [链接](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UILabel_Class/#//apple_ref/occ/instp/UILabel/minimumFontSize)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-06-24T05:24:00.530

**快速修复**...这里最小字体大小为 8.0

```
 CGFloat size = textLabel.font.pointSize;// font size of label text
            [textLabel setMinimumScaleFactor:8.0/size]; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-05-20T10:43:10.623

我回答得很晚，但可能会帮助其他任何人。正如每个人都知道`setMinimumFontSize`已被弃用，因此其他替换方法`setMinimumFontSize`是`setAdjustFontToFitWidth`采用`BOOL` 例如

```
[yourLabel setAdjustsFontSizeToFitWidth:YES];
//or
yourLabel.adjustsFontSizeToFitWidth = YES; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-07-13T21:27:28.537

对于 Swift，请使用以下内容：

```
//set the number (ex. 8 to your desired minimum font size)
myLabel!.minimumScaleFactor = 8/myLabel!.font.pointSize;` 
```

奇迹般有效！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-16T06:42:27.393

我有类似的问题。快速修复是使用 UILabel 的 MinimumScaleFactor 属性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-19T20:44:30.200

进入查找器并找到`.storyboard`文件或您的文件`.xib`并使用 TextEdit 打开。使用 find 定位字符串`"autoshrinkMode"`并将值替换`"minimumFontSize"`为`"minimumFontScale"`

奇怪的是转换没有写在更新脚本中......

还要感谢上面评论中的@Rob 说明了相同的答案。他应该为此获得荣誉。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-24T10:43:27.833

是`minumumFontSize`的已弃用。

使用以下`minimumScaleFactor:`-

```
Obj.minimumScaleFactor= (floatValue); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-16T13:28:36.680

您可以在那里使用最小比例因子或拖动标签并设置 autoshrik-> 最小字体。

也许这可以帮助你。

# sql - 为什么我不能在 DELETE 语句中使用别名？

> ID：11005209
> 
> 赞同：196
> 
> 时间：2012-06-12T21:33:22.057
> 
> 标签：sql, sql-server, sql-server-ce

在 Visual Studio 2010 的 SQL Server Compact Edition 中（可能是 SQL Server 和一般的 SQL，我不知道），此命令有效：

```
DELETE FROM foods WHERE (name IN ('chickens', 'rabbits')) 
```

但是此命令会产生以下错误：`Error near identifier f. Expecting OUTPUT.`

```
DELETE FROM foods f WHERE (f.name IN ('chickens', 'rabbits')) 
```

* * *

## 回答 #1

> 赞同：286
> 
> 时间：2012-06-12T21:36:43.670

要给表起别名，您必须说：

```
DELETE f FROM dbo.foods AS f WHERE f.name IN (...); 
```

我看不到这个特定`DELETE`语句的别名点，特别是因为（至少 IIRC）这不再符合严格的 ANSI。但是是的，正如评论所暗示的那样，其他查询形式（例如相关性）可能是必要的。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2012-06-12T21:37:06.950

delete 语句有奇怪的语法。它是这样的：

```
DELETE f FROM foods f WHERE (f.name IN ('chickens', 'rabbits')) 
```

# .net - WCF 管理会话状态信息

> ID：11005211
> 
> 赞同：1
> 
> 时间：2012-06-12T21:33:29.130
> 
> 标签：.net, wcf

在 WCF 中管理状态的最可扩展的方法是什么。

我只需要一个变量来指示会话，我将在 MSSQL 中管理与会话相关的信息。我不需要知道会话何时结束。每天一次，我将清除所有旧会话。

看来 SessionID 就是那个变量。

对于规模，我使用 Per Call，因为 ctor 是空的。我认为我不需要每次会话。

在我简单的 EightBall 测试中，我得到了一个代表会话的 SessionID。但我只是在一个盒子上测试。

让我担心的是，我看到一些文档需要将 ReliableSessionBindingElement 设置为 On 并且默认情况下它是 Off 。

在以下配置中，SessionID 是否会成为会话的可靠指标？

```
<system.serviceModel>
    <services>
      <service name="MajicEightBallServiceLib.MagicEightBallService"
               behaviorConfiguration="EightBallServiceMEXBehavior" >
        <endpoint address=""
                  binding="wsHttpBinding"
                  contract="MajicEightBallServiceLib.IEightBall" />
        <endpoint address="mex"
                  binding ="mexHttpBinding"
                  contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8000/MagicEightBallService"/>
          </baseAddresses>
        </host>             
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="EightBallServiceMEXBehavior">
          <serviceMetadata httpGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>

[ServiceBehavior (InstanceContextMode=InstanceContextMode.PerCall)]
public class MagicEightBallService : IEightBall
{
    public MagicEightBallService()
    {
        Console.WriteLine("Eightball awaits your question ...");
    }
    public string ObtainAnswerToQuestion(string userQuestion)
    {
        return "maybe " + OperationContext.Current.SessionId.ToString();
    }

    public sDoc GetSdoc(int sID)
    {
        List<sDocProp> props = new List<sDocProp>();
        sDocProp prop1 = new sDocProp { ID = 1, Name = "Prop1", ArrivalStatus = ArrivalStatus.OnTime };
        props.Add(prop1);
        sDocPropStringSV prop2 = new sDocPropStringSV { ID = 1, Name = "Prop1", ArrivalStatus = ArrivalStatus.OnTime, Value = "StrValue1" };
        props.Add(prop2);
        sDoc sDoc = new sDoc { sID = sID, sParID = 1, Props = props, SessionID = OperationContext.Current.SessionId.ToString() };
        return sDoc;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T03:55:35.027

WCF 支持 4 种类型的会话，可靠会话只是其中一种。所以你不需要打开 set ReliableSessionBindingElement On 来启用会话。您可以使用其他会话类型。

> 实现了 WS-ReliableMessaging 规范的`System.ServiceModel.Channels.ReliableSessionBindingElement`WS-ReliableMessaging 规范提供了对可靠会话的支持，在这些会话中，消息按顺序且只传递一次，即使消息在会话期间跨多个节点传输，也能保证信心。

实际上`wsHttpBinding`，默认情况下使用安全会话来加密和数字签名消息。

> 在以下配置中，SessionID 是否会成为会话的可靠指标？

服务可以检查您的绑定是否配置为使用会话使用`ServiceContractAttribute.SessionMode`属性。

以下服务合同要求配置的绑定使用会话。

```
[ServiceContract(SessionMode = SessionMode.Required)]
public interface IEightBall 
```

[http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.sessionmode.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.sessionmode.aspx)

> 在 WCF 中管理状态的最可扩展的方法是什么。

`InstanceContextMode.PerCall`如果您的代码不依赖于除 Session ID 之外的任何会话数据，那么它是正确的选择。会话 ID 是 WCF 消息的一部分，因此无需保留`InstanceContext`超过处理请求所需的时间。

另一个问题：

> 在以下配置中，SessionID 是否会成为会话的可靠指标？

答案是肯定的。下面是逆向工程的 property 代码`System.ServiceModel.OperationContext.SessionId`。正如你所看到`SessionId`的，只有在不为空时才返回`Channel.Session`非空值。`SessionId``Session`

```
public string SessionId
{
    get
    {
        if (this.channel != null)
        {
            IChannel innerChannel = this.channel.InnerChannel;
            if (innerChannel != null)
            {
                ISessionChannel<IDuplexSession> sessionChannel = innerChannel as ISessionChannel<IDuplexSession>;
                if (sessionChannel != null && sessionChannel.Session != null)
                {
                    return sessionChannel.Session.Id;
                }
                ISessionChannel<IInputSession> sessionChannel2 = innerChannel as ISessionChannel<IInputSession>;
                if (sessionChannel2 != null && sessionChannel2.Session != null)
                {
                    return sessionChannel2.Session.Id;
                }
                ISessionChannel<IOutputSession> sessionChannel3 = innerChannel as ISessionChannel<IOutputSession>;
                if (sessionChannel3 != null && sessionChannel3.Session != null)
                {
                    return sessionChannel3.Session.Id;
                }
            }
        }
        return null;
    }
} 
```

# jquery - $.mobile.loadPage 是否提供回调函数？

> ID：11005212
> 
> 赞同：4
> 
> 时间：2012-06-12T21:33:34.890
> 
> 标签：jquery, ajax, jquery-mobile

如果我想将内容加载到需要自己的 jquery 脚本的 jquery 移动页面中，例如幻灯片插件，我将如何将幻灯片 html 页面“和”幻灯片 jquery 文件加载到 $.mobile.loadPage 中？有回调函数吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-04T07:46:20.727

您也可以在 loadPage 之后使用“done”。加载页面后将调用此方法..

```
 $.mobile.loadPage("page2.html", true).done(function (e, ui, page) {
      //page has been loaded
}).fail(function () {
        alert("sorry, no dice");
    }); 
```

谢谢

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T14:07:38.620

.loadPage 没有回调函数。但是，您可以绑定事件页面加载以运行所需的脚本。

```
 $( document ).bind( "pageload", function( event, data ){
    //your script, and potentially testing you are on a page requiring it
}); 
```

您可以查看[Jquery Mobile 文档](http://jquerymobile.com/test/docs/api/events.html)以获取有关此事件的完整详细信息。另外，如果您使用的是更常见的 .changePage 方法，您可能会使用页面事件“pageshow”或“pagebeforeshow”，具体取决于您将使用的脚本类型。

# xpages - 在 XPages 扩展库移动控件中使用 DataView

> ID：11005215
> 
> 赞同：0
> 
> 时间：2012-06-12T21:33:46.217
> 
> 标签：xpages, xpages-extlib

在移动应用程序的第 1 页上，我需要从分类视图中显示类别。当用户选择一个类别时，应用程序应该转换到第 2 页，显示所选类别中的文档。客户不希望类别在应用程序的第一页上展开/折叠。

我会为此使用 DataView 吗？关于如何最好地实现这一目标的任何建议？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T07:16:31.550

如果像这样的[http://sutol.mapsys.cz/](http://sutol.mapsys.cz/)（应用程序是捷克语，但你仍然可以看到它是关于什么的）是你需要的，我可以把代码发给你。“dopoledne”和“odpoledne”是类别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:05:58.303

是的，您想要的是一个数据视图，有一个属性可以禁用类别部分的折叠/展开。

我的建议是查看 ExtLib 附带的改造模板“Discussion 853 XL”或“Teamroom 853 XL”，这些应用程序已被修改以添加移动前端，并且是如何构建移动应用程序的绝佳示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T18:49:18.193

我在 XPages 帮助应用程序的移动页面中按照这些思路进行操作 - 内容和索引视图都从类别向下钻取到类别中的文档。我想我只是使用重复控制。

要记住的一件事是，您当前无法使用不同的参数重定向到当前的移动页面。这就是为什么我在两个使用相同自定义控件的移动页面之间切换的原因。

# html - 已弃用的 HTML 元素仍然有效

> ID：11005222
> 
> 赞同：2
> 
> 时间：2012-06-12T21:34:23.483
> 
> 标签：html, tags

W3C 已宣布一些元素已被弃用，例如`<font>`、`<frameset>`和`<strong>`，其中大部分可以用 CSS 替换。据说这种变化是在 HTML 5 中带来的，但是，如果我将 HTML 5 doctype 放在文档上，这些元素似乎仍然有效。我是在不知不觉中没有实际应用 HMTL 5 文档类型，还是我只是完全误解了 W3C 的通知？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:39:04.960

在这种情况下，已弃用意味着这些功能仍然存在，但它们的使用可能会引发警告消息，推荐替代做法，而弃用可能表明该功能将在未来被删除。

基本上尽量不要使用，因为有更好的选择 [http://en.wikipedia.org/wiki/Deprecation](http://en.wikipedia.org/wiki/Deprecation)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T21:39:51.670

`DOCTYPE`不确定将支持哪些元素。如果您的浏览器支持某个元素，则该元素将“工作”。浏览器支持已弃用的元素，因为它们在用于查看旧站点时必须正常工作。

作为一个思想实验，你认为这段代码会做什么？

```
bluefire {
    display: block;
    padding: 1em;
    border: 2px solid black;
}

<bluefire>
    Hello world!
</bluefire> 
```

元素是否“有效”的定义并不明确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T21:44:22.573

> 不定式“反对”的意思很简单，就是“强烈反对（某事）”。- [http://en.wikipedia.org/wiki/Deprecation](http://en.wikipedia.org/wiki/Deprecation)

这是真的。标签仍然有效，但强烈建议避免使用它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T21:45:20.720

不，只是误解了“弃用”的含义。当元素被弃用时，它们不会突然停止工作。查看此线程以获取更多讨论和链接；

[不推荐使用的元素会从未来的浏览器中删除吗？](https://stackoverflow.com/questions/2237235/will-deprecated-elements-be-removed-from-future-browsers)

# javascript - 如何通过 postMessage 执行一个函数

> ID：11005223
> 
> 赞同：12
> 
> 时间：2012-06-12T21:34:24.103
> 
> 标签：javascript, jquery, postmessage

我在 iframe 中有这段代码：

```
window.addEventListener('message', function(e){

  if(e.data == 'test')
    console.log(e);

}, false); 
```

这在父文档中：

```
$('#the_iframe').get(0).contentWindow.postMessage('test', 'http://localhost/'); 
```

因此，父文档向 iframe 发送一条“测试”消息并且它可以工作。

但是如何在父文档中定义一个函数，并以某种方式通过 postMessage 将该函数发送到 iframe，iframe 将在本地执行该函数？

该函数对文档进行一些更改，如下所示：

```
var func = function(){
  $("#some_div").addClass('sss');
} 
```

（`#some_div`存在于 iframe 中，而不是父文档中）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-18T04:12:16.173

没有什么可以阻止您将字符串化函数作为消息后事件数据传递。对于任何函数声明，如

```
function doSomething(){
    alert("hello world!");
} 
```

你可以`encodeURI`解释它的字符串：

```
console.log(encodeURI(doSomething.toString()));
//function%20doSomething()%20%7B%0A%20%20%20%20alert(%22hello%20world!%22);%0A%7D 
```

然后它可以作为闭包的一部分执行——不要过于想象

```
eval('('+decodeURI(strCallback)+')();'); 
```

*在没有*跨框架架构的情况下有一个[小提琴的概念证明](http://jsfiddle.net/ovfiddle/eT3Vn/1/) - 我会看看我是否可以组合一个 postMessage 版本，但托管 w/jsfiddle 并非易事

 *## 更新

正如所承诺的，一个完整的模型可以工作（下面的链接）。通过正确的`event.origin`检查，这将是非常难以穿透的，但我知道我们的安全团队永远不会`eval`像这样投入生产:)

给定选项，我建议在两个页面之间对功能进行规范化，以便只需要传递参数消息（即传递参数而不是函数）；但是，在某些情况下，这是首选方法。

父代码：

```
document.domain = "fiddle.jshell.net";//sync the domains
window.addEventListener("message", receiveMessage, false);//set up the listener

function receiveMessage(e) {
    try {
        //attempt to deserialize function and execute as closure
        eval('(' + decodeURI(e.data) + ')();');
    } catch(e) {}
} 
```

框架代码：

```
document.domain = "fiddle.jshell.net";//sync the domains
window.addEventListener("message", receiveMessage, false);//set up the listener

function receiveMessage(e) {
    //"reply" with a serialized function
    e.source.postMessage(serializeFunction(doSomething), "http://fiddle.jshell.net");
}

function serializeFunction(f) {
    return encodeURI(f.toString());
}

function doSomething() {
    alert("hello world!");
} 
```

原型样机：[父代码](http://jsfiddle.net/ovfiddle/yEnjS/)和[iframe 代码](http://jsfiddle.net/ovfiddle/GTZsV/)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-12T23:31:17.830

你真的不能。尽管[postMessage 规范（草案）](http://www.whatwg.org/specs/web-apps/current-work/multipage/web-messaging.html#posting-messages)讨论了*结构化对象，例如嵌套对象和数组，[...] JavaScript 值（字符串、数字、日期等）和 [...] 某些数据对象，例如 File Blob、FileList , 和 ArrayBuffer 对象*大多数浏览器只允许字符串（当然包括 JSON）。[在MDN](https://developer.mozilla.org/en/DOM/window.postMessage)或[dev.opera](http://dev.opera.com/articles/view/window-postmessage-messagechannel/)上阅读更多内容。但是我很确定不可能发送函数对象，至少不能作为保留其范围的闭包。

`eval()`因此，如果您真的想从父窗口执行一些代码，您将在 iframe 中对函数和它进行字符串化。但是，我认为任何应用程序都没有理由允许评估任意代码（即使来自已注册的域）；最好构建一个可以接收（JSON-）字符串命令并调用自己的方法的消息 API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-17T13:28:43.850

在这种情况下，我会尝试不同的方法。为什么？Bergi 已经解释了为什么它不能按照你想要的方式工作。

您可以在父页面中定义（和重新定义您的函数）：

```
<html>                                                                  
<head>                                                                  
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
<script type="text/javascript">                                        
    var fun = function() { alert('I am a function!'); };

    $(function() {
        // use this function to change div background color
        fun = function() { 
            // get desired div
            var theDiv = $('#frame').contents().find('#some_div');
            theDiv.css('background', '#ff0000');
        };

        // or override it, if you want to change div font color
        fun = function() { 
            var theDiv = $('#frame').contents().find('#some_div');
            theDiv.css('color', '#ff0000');
        };

        // in this example second (font color changing) function will be executed
    });
</script>                                                               
</head>                                                                 
<body>                                                                  
    <iframe id="frame" src="frame.htm"></iframe>
</body>                                                                 
</html> 
```

并从框架页面中调用您的函数：

```
<html>                                                                  
<head>                                                                  
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
<script type="text/javascript">                                         
    $(function() {
        parent.fun();
    });
</script>                                                               
</head>                                                                 
<body>                                                                  
    <div id="some_div">I am a div (but inside frame)!</div>
</body>                                                                 
</html> 
```

这可能不方便，但它有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-18T05:36:56.180

扩展[以下问题](https://stackoverflow.com/q/10060857/783743)，您可以对函数进行字符串化，用于`postMessage`发送函数体，然后用于`eval`执行它。

本质上，您所做的是对函数进行编组，以便将其发送到 iframe，然后在另一端对其进行解组。为此，请使用以下代码：

框架：

```
window.addEventListener("message", function (event) {
    var data = JSON.parse(event.data);
    var callback = window[data.callback];
    var value = data.value;

    if (data.type === "function")
        value = eval(value);

    var callback = window[data.callback];

    if (typeof callback === "function")
        callback(value);
}, false);

function callFunction(funct) {
    funct();
} 
```

家长：

```
var iframe = $("#the_iframe").get(0).contentWindow;

postMessage(function () {
    $("#some_div").addClass("sss");
}, "callFunction");

function postMessage(value, callback) {
    var type = typeof value;

    if (type === "function")
        value = String(value);

    iframe.postMessage({
        type: type,
        value: value,
        callback: callback
    }, "http://localhost");
} 
```

一旦你在你的 iframe 中获得了函数体，`eval`你就可以像使用普通函数一样使用它。您可以将它分配给一个变量，传递它，使用它，`call`它等等。`apply``bind`

但是请注意，函数的范围是动态的（即函数中的任何非局部变量必须已经在 iframe 窗口中定义）。

在您的情况下，您在函数中使用的 jquery`$`变量是非本地的。因此 iframe 必须已经加载了 jquery。它不会使用`$`父窗口中的 jquery 变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-29T07:37:01.330

您可以随时发送`postMessage`回 iframe 并让 iframe 处理消息。当然，您必须计算它不会在 iframe 中的下一个命令之前执行。*

# c++ - QuadTrees 和递归构造函数堆栈溢出

> ID：11005224
> 
> 赞同：1
> 
> 时间：2012-06-12T21:34:35.767
> 
> 标签：c++, recursion, tree, stack-overflow, quadtree

我正在创建一个分块的 QuadTree 地形，并试图确保两个节点之间的细节差异不会超过一个级别。我当前的构造函数代码是这样的：

```
QuadNode::QuadNode(Rect area, QuadNode * p, QuadRoot * r)
{
    Root = r;

    Parent = p;
    Level = p->Level + 1;

    InitializeGeometry(area);

    for(int iii = 0; iii < 4; iii++)
            Children[iii] = 0;

    for(int iii = 0; iii < 4; iii++)
    {
            if(QuadrantNeedsChild(iii))
                    Children[iii] = new QuadNode(GetRect(iii), this, Root);
    }
} 
```

这很好用。但是为了强制两个相邻节点之间的差异不超过一个级别，我试图将其添加到构造函数的末尾：

```
QuadNode * neighbour;

for(int direction = 0; direction < 4; direction++)
{
    neighbour = FindNeighbour(direction);
    if(neighbour)
    {
        while(Level - neighbour->Level > 1)
        {
            neighbour->Subdivide();
            neighbour = FindNeighbour(direction);
                    //neighbour should now be a child of the previous neighbour
        }
    }
} 
```

但是那个堆栈溢出了。*我认为*的一个原因是该`Children[iii] = new QuadNode(GetRect(iii), this, Root);`语句的赋值部分永远不会执行，并且`FindNeighbour()`需要设置孩子以找到合适的邻居。但我认为这不是唯一的问题，因为代码实际上从未到达第二`neighbour = FindNeighbour(direction);`行，而且我不知道是什么原因造成的。

如果我在树的基本创建之后在新函数中运行第二个代码片段，它或多或少可以工作，但是它需要多次传递以确保新创建的节点本身不会产生大于 1 的级别差异。所以我如果可能的话，我宁愿在构造函数中包含这段代码。谁能想到实现这一目标的方法？

课堂上的一些笔记，以防它有助于`QuadrantNeedsChild(int quadrant)`确保水平永远不会超过 8，所以我知道我不仅仅是太深了。`Subdivide()`只是`Children[iii] = new QuadNode(GetRect(iii), this, Root);`在所有象限上运行。`FindNeighbour(int direction)`可以返回父级或祖先。例如，如果 D 正在寻找北邻居，如果 B 从未细分为以下内容，它将获得其祖父母（整个图表）：

```
 - - - - - -
|     |     |
|  A  |  B  |
|     |     |
|- - - - - -|
|     | D|  |
|  C  |-----|
|     |  |  |
 - - - - - - 
```

如果提供了超出范围的象限，则细分功能仅细分给定的象限或所有象限。

```
void QuadNode::Subdivide(int quadrant)
{
    if(quadrant > -1 && quadrant < 4)
    {
        if(!Children[quadrant])
            Children[quadrant] = new QuadNode(GetRect(quadrant), this, Root);
    }
    else
        for(int iii = 0; iii < 4; iii++)
            if(Children[iii] == 0)
                Children[iii] = new QuadNode(GetRect(iii), this, Root);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T01:47:19.697

当构造节点的第一个子节点时，它是否发现*它自己的父节点*作为邻居，因为该父节点还没有子节点（第一个节点即将创建）？

这将导致节点`Subdivide()`在其自己的父节点上进行校准，这将构造一个新的子节点，该子节点将再次调用`Subdivide()`,...

即使没有这个，在新级别上构建第一个节点将`Subdivide()`是它的所有邻居，这反过来又会递归地细分这些邻居的所有邻居。这是它应该如何工作的吗？对于最深的级别，这将导致类似 4 ⁸级别的递归。

# c# - 如何在企业项目中使用依赖注入

> ID：11005225
> 
> 赞同：3
> 
> 时间：2012-06-12T21:34:36.427
> 
> 标签：c#, architecture, dependency-injection, inversion-of-control

想象一下，您有一个包含数百个类的应用程序，这些类实现了数十个“高级”接口（即组件级）。是否有推荐的依赖注入方式（如统一）。是否应该有一个可用于引导的“通用容器”，可以作为单例访问？是否应该传递一个容器，所有实例都可以RegisterInstance？一切都应该由 RegisterType 在启动时的某个地方完成吗？如何在需要时使容器可访问。构造函数注入似乎是错误的，与标准方式存在争议，您必须将接口从组件级别传递到在启动时使用它的最底层，或者引用以“知道你住在哪里”反模式结束. 并且：拥有一个“可用”的容器 可能会让开发人员想到在客户端上下文中解析服务器组件。如何避免？

欢迎任何讨论！

* * *

**编辑澄清**

我想出了一个有点现实的例子，以便更好地了解我看到的问题。

让我们想象一下该应用程序是一个高保真系统。该系统有 cd 播放器（集成在 cd 机架中）和一个 USB 端口（集成在 USB 机架中）来播放音乐。

现在，CD 播放器和 USB 端口应该可以播放 mp3 音乐了。

我在某个地方有一个 mp3 解码器，它是可注入的。

现在我启动高保真系统。还没有插入 CD，也没有插入 USB 棒。我现在不需要 mp3 解码器。

但是通过构造函数注入，我必须已经将依赖项注入到 cd 机架和 USB 机架中。

如果我从不插入 mp3 cd 或 mp3 usb 棒怎么办？

我应该在 cd 架上放一个参考，所以当插入 mp3 cd 时，我手头有一个解码器吗？（对我来说似乎错了）

cd 机架的子系统需要解码器，该子系统仅在插入 mp3 时启动。现在我在 cd 机架中没有容器，这里的构造函数注入呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T21:45:47.797

首先，[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)是一种不需要容器的设计模式。DI 模式指出：

> 依赖注入是一种软件设计模式，允许在运行时而不是编译时选择组件

以 Guice（java 依赖注入框架）为例，在 Java 中 Guice 是一个 DI 框架，但它本身不是容器。

.Net 中的大多数 DI 工具实际上都是容器，因此您需要填充容器才能注入依赖项

我不喜欢每次都必须在容器中注册每个组件的想法，我只是讨厌这样。有几个工具可以帮助您根据约定自动注册组件，我不使用 Unity，但我可以为您指出例如[Ninject](http://www.ninject.org/)或[AutoFac](http://code.google.com/p/autofac/)

我实际上正在编写一个[小实用程序](https://github.com/jupaol/NAutoRegister)来根据约定使用几乎任何 DI 工具自动注册组件，它仍处于开发阶段

关于您的问题：

> 是否应该有一个可用于引导的“通用容器”，可以作为单例访问？

答案是肯定的，（有一个工具可以抽象出所使用的 DI 工具，称为[ServiceLocator](http://commonservicelocator.codeplex.com/)）这就是 DI 工具的工作原理，有一个静态容器可供应用程序使用，但是不建议在域对象中使用它创建实例，这被认为是一种[反模式](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)

顺便说一句，我发现这个工具对于在运行时注册组件非常有用：

[http://bootstrapper.codeplex.com/](http://bootstrapper.codeplex.com/)

> 是否应该传递一个容器，所有实例都可以RegisterInstance？

不，那会违反得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)。如果您决定使用容器，最好在应用程序启动时注册组件

> 如何在需要时使容器可访问

使用 Common Service Locator，您可以在应用程序的任何位置使用它，但就像我说的，不建议在域对象中使用它来创建所需的实例，而是在对象的构造函数中注入对象并让DI 工具自动注入正确的实例。

现在基于此：

> 构造函数注入似乎是错误的，与标准方式存在争议，您必须将接口从组件级别传递到在启动时使用它的最底层，或者引用以“知道你住在哪里”反模式结束

让我觉得你没有为你的应用程序编写**大量**的单元测试，这很糟糕。所以我的建议是，在选择要使用的 DI 工具之前，或者在考虑到这个问题的所有答案之前，请参考以下链接，这些链接专注于一件事：**编写干净的可测试代码**，这是到目前为止，您可以回答自己的问题的最佳来源

清洁代码会谈：

*   [http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded](http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded)

*   [http://www.youtube.com/watch?v=RlfLCWKxHJ0&feature=player_embedded](http://www.youtube.com/watch?v=RlfLCWKxHJ0&feature=player_embedded)

文章

*   [http://misko.hevery.com/2010/05/26/do-it-yourself-dependency-injection/](http://misko.hevery.com/2010/05/26/do-it-yourself-dependency-injection/)

*   [http://misko.hevery.com/code-reviewers-guide/](http://misko.hevery.com/code-reviewers-guide/)

*   PDF 中的上一个链接[http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf](http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf)

以下链接**超级强烈推荐**

[http://misko.hevery.com/2008/09/30/to-new-or-not-to-new/](http://misko.hevery.com/2008/09/30/to-new-or-not-to-new/)

[http://www.loosecouplings.com/2011/01/how-to-write-testable-code-overview.html](http://www.loosecouplings.com/2011/01/how-to-write-testable-code-overview.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:00:03.003

首先，有Composition Root模式，你尽快建立你的依赖，Main()在桌面，global.asax/app_start在web。然后，依赖构造函数注入，因为这使您的依赖关系清晰。

但是，您仍然需要一些东西来真正解决依赖关系。我知道至少有两种方法。

第一个在于使用服务定位器（这几乎等于使容器成为单例）。对于很多人来说，这被认为是一种反模式，但它确实很好用。每当您需要服务时，您都可以向容器索取它：

```
 ... business code...
 var service = ServiceLocator.Current.GetInstance<IMyService>();
 service.Foo(); 
```

Service Locator 仅使用您在 Composition Root 中设置的容器。

另一种方法是依赖对象工厂作为单例提供，并将容器注入其中：

```
 var service = IMyServiceFactory.Instance.CreateService(); 
```

诀窍是工厂的实现在内部使用容器来解析服务。但是，这种方法带有一个额外的工厂层，使您的业务代码**独立**并且**不知道**IoC！您可以自由地完全重新设计工厂，使其内部**不使用**IoC，并且仍然维护每一行业务代码。

换句话说，将容器/定位器隐藏在工厂层后面只是一个技巧。

虽然很想使用前一种方法（直接依赖于定位器），但我更喜欢后者。只是感觉更干净。

我想知道这里是否还有其他可行的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T08:44:44.707

> 是否应该传递容器

不，因为这会导致[Service Locator 反模式](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx "Mark Seemann - 组合根")。

> 所有实例都可以 RegisterInstance 的地方

服务应该在应用程序的启动路径中注册，而不是类型本身。当您有多个应用程序（例如 Web 应用程序、Web 服务、WPF 客户端）时，通常会有一个公共引导程序项目将所有服务连接在一起以共享层（但每个应用程序仍然有其独特的连接，因为没有应用程序表现相同的）。

> 是否应该在启动时的某个地方由 RegisterType 完成所有操作

是的，你应该在启动时把所有东西都连接起来。

> 如何在需要时使容器可访问。

你不应该。应用程序应该忽略容器的使用（如果使用了任何容器，因为这是可选的）。如果你不这样做，你会让很多事情变得更加困难，比如测试。但是，您可以将容器注入应用程序启动路径中定义的类型（也称为[Composition Root](http://blog.ploeh.dk/2011/07/28/CompositionRoot.aspx "Mark Seemann - 组合根")）。这样，应用程序就不会知道有关容器的任何信息。

> 构造函数注入似乎是错误的，有争议的是标准方式

构造函数注入是注入依赖项的**首选**方式。但是，将现有应用程序重构为构造函数注入可能具有挑战性。在构造函数注入不起作用的**罕见*情况下，您可以恢复为属性注入，或者当无法构建完整的对象图时，您可以注入工厂。当工厂实现是组合根的一部分时，您可以让它依赖于容器。

我发现一个非常有用的模式，可以建立在依赖注入模式和[SOLID](https://en.wikipedia.org/wiki/SOLID "SOLID 设计原则")设计原则之上，是[命令/处理程序模式](https://cuttingedge.it/blogs/steven/pivot/entry.php?id=91 "同时……在我的架构的指挥方面")。我发现这在较小的应用程序中很有用，但当应用程序变大时它会大放异彩，例如企业应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T09:38:57.447

> 现在我启动高保真系统。还没有插入 CD，也没有插入 USB 棒。我现在不需要 mp3 解码器。

这似乎非常适合**Setter 注入**（= C# 中的属性注入）。使用 NeutralDecoder 或 NullDecoder 作为默认值，并在需要时注入 Mp3Decoder。您可以手动完成，也可以使用 DI 容器和条件/后期绑定。

[http://blog.springsource.com/2007/07/11/setter-injection-versus-constructor-injection-and-the-use-of-required/](http://blog.springsource.com/2007/07/11/setter-injection-versus-constructor-injection-and-the-use-of-required/)

> 我们通常建议人们对所有 *强制协作者*使用构造函数注入，对所有其他属性使用 setter 注入。

# javascript - 将所有元素包裹起来，直到 :nth-child

> ID：11005226
> 
> 赞同：0
> 
> 时间：2012-06-12T21:35:02.183
> 
> 标签：javascript, jquery

我很难弄清楚这一点，但我相信这很简单。

我知道我必须用它`:nth-child`来计算我想要包装的每一组元素。我想知道如何计算`:nth-child`和包装所有以前的元素，包括`:nth-child`在 div 中匹配的每组元素`:nth-child`。我假设有一个`.each()`参与。

代码的布局如下：

```
<div class="wrapper"> 
<h3>Heading</h3>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>

<h3>Heading</h3>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>

<h3>Heading</h3>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>

<h3>Heading</h3>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
<a href="#">Link</a>
</div> 
```

**更新** 尝试了这段代码，它似乎给了我想要的结果，但在 16 处停止。

```
 $(".wrapper").each( function () {
$(this).children(":lt(16)").wrapAll("<div></div>")
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:14:30.223

jQuery 的`.each()`函数有一个内置的`index`——所以我们可以利用它来选择每 16 个元素。

```
$("div.wrapper").children().each(function(i){
    if(i % 16 == 0 && i != 0){
        // We get the elements we need to wrap, but they're going to be in reverse order (thanks to .prevAll())
        var elementsToWrap = $(this).prevAll().not('.wrap2');
        var temp = [];
        for(var j=0; j < elementsToWrap.size(); j++){
            // Reverse the objects selected by placing them in a temporary array.
            temp[(elementsToWrap.size()-1) - j] = elementsToWrap.eq(j)[0];
        }
        // Wrap the array back into a jQuery object, then use .wrapAll() to add a div around them
        $(temp).wrapAll('<div class="wrap2" />');
    }
}); 
```

**​演示** [http://jsfiddle.net/CRz7E/1/](http://jsfiddle.net/CRz7E/1/)

如果您想单独包装每个元素 - 而不是作为一个组，那么您不需要反转选择，您可以使用`.wrap()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:53:47.220

有几种方法，我认为最简单的方法是使用[.filter](http://api.jquery.com/filter/) 我将简单地向您展示一个简单的示例，也许您可​​以修改您的问题以获得更具体的答案。

假设您的 HTML 很简单，如下所示：

```
<body>
    <style type="text/css">
        .goober {
            background: #ffa;
            color: #696969;
        }
    </style>

    <div>1</div>
    <p>1</p>
    <div>2</div>
    <p>2</p>
    <div>3</div>
    <p>3</p>
    <div>4</div>
    <p>4</p>​
</body> 
```

假设你想用“goober”类将所有 p 元素包装在一个 div 中。当然，除了*最后*一个。

然后你可以 jQuery 如下：

```
$(function() {
    // here i use .filter and in the return i recall the same jQuery array 
    // object that i'm filtering in order to compare the index value to 
    // its length
    $("p").filter(function(i) { 
        return i != $("p").length-1; 
    }).wrap('<div class="goober" />'); // then of course our wrapper
});​ 
```

使用的 jQuery 方法：

*   .filter = [http://api.jquery.com/filter/](http://api.jquery.com/filter/)
*   .length = [http://api.jquery.com/length/](http://api.jquery.com/length/)
*   .wrap = [http://api.jquery.com/wrap/](http://api.jquery.com/wrap/)

# c# - 当对象从 List 继承时序列化对象

> ID：11005227
> 
> 赞同：1
> 
> 时间：2012-06-12T21:35:05.173
> 
> 标签：c#, serialization, xml-serialization

> **可能重复：**
> [从 BindingList<T> 派生的类的公共字段/属性不会序列化](https://stackoverflow.com/questions/1225750/public-fields-properties-of-a-class-derived-from-bindinglistt-wont-serialize)

当我尝试序列化这个对象时，只有 list 属性被序列化。

对象代码：

```
public class checkList<T>: List<T>
{
        public bool check = true;
        public string path;
        public string type;
} 
```

我有一个要序列化的实例：

```
List<checkList<Keys>> hookKeys; 
```

反序列化代码：

```
FileStream fs = new FileStream("list", FileMode.Open, FileAccess.Read);
XmlSerializer ser = new XmlSerializer(typeof(List<checkList<Keys>>));
hookKeys = (List<checkList<Keys>>)ser.Deserialize(fs);
fs.Close(); 
```

序列化代码：

```
FileStream fsK = new FileStream("list", FileMode.Create, FileAccess.Write);
XmlSerializer serK = new XmlSerializer(typeof(List<checkList<Keys>>));
serK.Serialize(fsK, (List<checkList<Keys>>)hookKeys);
fsK.Close(); 
```

序列化后的xml文件：

```
<ArrayOfArrayOfKeys xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<ArrayOfKeys>
<Keys>X</Keys>
<Keys>Z</Keys>
<Keys>C</Keys>
</ArrayOfKeys>
</ArrayOfArrayOfKeys> 
```

我如何也序列化其他属性？

# css - ::selection 和 ::-moz-selection 的多个规则（以及用户选择？）

> ID：11005228
> 
> 赞同：6
> 
> 时间：2012-06-12T21:35:13.793
> 
> 标签：css, selection

我有网站，我第一次设置的地方

```
::selection
{
    background: transparent;
}
::-moz-selection
{
    background: transparent;
}
*
{
    -moz-user-select: none; 
    -khtml-user-select: none; 
    -webkit-user-select: none; 
    -o-user-select: none;
    user-select: none;
 } 
```

（只是为了艺术效果，不是因为我试图阻止人们复制某些东西。）

但是，稍后，我希望用户能够从文本区域中选择文本。
我能够使选择再次可见，使用

```
#commentarea::selection
{
    background: #070707;
}
#commentarea::-moz-selection
{
    background: #070707;
}
#commentarea
{
    -moz-user-select: element; 
    -khtml-user-select: element; 
    -webkit-user-select: element; 
    -o-user-select: element;
    user-select: element;
} 
```

但是如果用户从 textarea 中选择了某些东西，则不能通过单击某处来取消选择它。您只能通过移动插入符号（使用箭头键）来取消选择文本。

这是为什么？我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:08:11.767

Enve 的回答是正确的.. 对于 Firefox 以外的浏览器（至少 13.0）。

对于有同样问题的人：

在通用选择器 ( `*`) 中，您必须使用`-moz-user-select: -moz-none;`, 而不是`-moz-user-select: none;`. 这将解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:52:26.877

改变

```
#commentarea
{
    -moz-user-select: element; 
    -khtml-user-select: element; 
    -webkit-user-select: element; 
    -o-user-select: element;
    user-select: element;
} 
```

至

```
#commentarea {
    -webkit-user-select: text;
    -moz-user-select: text;
    -khtml-user-select: text;
    -webkit-user-select: text;
    -o-user-select: text;
} 
```

演示：http: [//jsfiddle.net/dWjPQ/1/](http://jsfiddle.net/dWjPQ/1/)

# android - 确定画布滚动条的尺寸

> ID：11005230
> 
> 赞同：0
> 
> 时间：2012-06-12T21:35:20.677
> 
> 标签：android, android-canvas, android-scrollbar

我有一个带滚动条的画布（不使用 ScrollView），我需要知道滚动条的尺寸，即宽度和高度。有什么方法可以确定它们吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:44:30.243

您可以使用 View.getScrollbarSize()。它将返回垂直滚动条的宽度或水平滚动条的高度。

# python - 有效的 Cython cProfiling 是否意味着编写许多子函数？

> ID：11005233
> 
> 赞同：0
> 
> 时间：2012-06-12T21:35:50.327
> 
> 标签：python, optimization, profiling, cython, cprofile

我正在尝试使用 Cython 优化一些代码，但**cProfile**没有提供足够的信息。

为了做好分析，我应该创建许多子例程 func2, func3,... , func40 吗？

请注意下面我有一个函数`func1`in `mycython.pyx`，但它有许多 for 循环和内部操作。但是 cProfile 没有告诉我这些循环的统计信息。

```
 2009 function calls in 81.254 CPU seconds

Ordered by: standard name

ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.000    0.000   81.254   81.254 <string>:1(<module>)
    2    0.000    0.000    0.021    0.010 blah.py:1495(len)
 2000    0.000    0.000    0.000    0.000 blah.py:1498(__getitem__)
    1    0.214    0.214    0.214    0.214 mycython.pyx:718(func2)
    1   80.981   80.981   81.216   81.216 mycython.pyx:743(func1)
    1    0.038    0.038   81.254   81.254 {mycython.func1}
    2    0.021    0.010    0.021    0.010 {len}
    1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:48:17.127

是的，它确实。可用的最细粒度`cProfile`是函数调用。您必须将 func1 拆分为多个函数。（请注意，您可以将它们定义为在 func1 中定义的函数，因此仅对 func1 可用。）

如果您想要更细粒度的分析（行级），那么您需要一个不同的分析器。看看[这个 line-level profiler](http://packages.python.org/line_profiler/)，但我认为它不适用于 Cython。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T17:56:09.937

您需要为 Cython 代码启用分析支持。利用

```
# cython: profile=True 
```

[http://docs.cython.org/src/tutorial/profiling_tutorial.html](http://docs.cython.org/src/tutorial/profiling_tutorial.html)

# html - 我可以更好地重写这个布局吗？

> ID：11005235
> 
> 赞同：1
> 
> 时间：2012-06-12T21:36:01.530
> 
> 标签：html, layout

我觉得我写得不正确，这是我在这种性质下的第一个布局。我有一个网站，它有几个背景可以横跨整个屏幕。内部容器为 960 像素，然后居中。

唯一的问题是每个具有不同背景的部分都需要自己的外部和内部 div。

*Dabblet*
[http://dabblet.com/gist/2920465](http://dabblet.com/gist/2920465)

![在此处输入图像描述](../Images/21a51849d5f540f47a996f0806693cc1.png) 富

```
 <section class="hero">
   <div class="hero-container">
   Hero content  
   </div>
 </section>

 <section class="popular">
   <div class="popular-container">
   Header content  
   </div>
 </section>

 <div class="main">
   <div class="main-container">
     Main content
   </div>
 </div>

 <footer>
   <div class="footer-container">
     Footer content
   </div>
 </footer> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:01:48.480

到目前为止，代码看起来还可以。出错太简单了。现在我唯一要改变的是5个班级

```
.header-container,
.hero-container,
.popular-container,
.main-container,
.footer-container 
```

合并成一个类`inner-section-container`并将这个类应用于相应的元素，因为*现在*你对所有这些类做同样的事情。

# mysql - 使用左连接和连接表的另一个字段中的位置

> ID：11005238
> 
> 赞同：1
> 
> 时间：2012-06-12T21:36:24.877
> 
> 标签：mysql, sql

我有两个表用户和工作订单。现在我需要通过从 users 表字段中过滤来获取 work_orders 结果。

我的以下查询没有返回结果。

```
SELECT `work_orders`.`id` as id, `work_orders`.`type` as type
     , `work_orders`.`title` as title, `work_orders`.`status` as status
     , `work_orders`.`publish_date` as publish_date
     , `work_orders`.`priority` as priority, `work_orders`.`assigned_to` as assigned_to
     , `work_orders`.`client_id` as client_id, `work_orders`.`due_date` as due_date 
  FROM (`work_orders`) 
  LEFT JOIN `users` 
    ON `users`.`id` = `work_orders`.`assigned_to` 
 WHERE `work_orders`.`status` != 'closed' 
   AND users.manager_id = '143' 
 ORDER BY `work_orders`.`id` DESC 
 LIMIT 30 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:44:04.633

您的 WHERE 子句是否过滤掉了所有结果？

此外，如果您想显示仅与某些用户相关的工作订单，请将您的 LEFT JOIN 更改为 INNER JOIN，或使用 EXISTS。

试试这个...

```
SELECT field1, field2, ...
FROM work_orders
WHERE EXISTS (
    SELECT 1 
    FROM users 
    WHERE  users.id = work_orders.assigned_to 
       AND manager_id='143'
) 
```

# javascript - 如何忽略 $1 替换 JavaScript 中的反向引用

> ID：11005248
> 
> 赞同：0
> 
> 时间：2012-06-12T21:37:48.397
> 
> 标签：javascript, regex, replace, backreference

我有一个用户可以随时编辑的字符串，以及一个正在对该字符串执行的正则表达式，以将其添加到 xml 中，然后将其保存，但他们可以将“$1”添加到字符串中。我只想保存文本'$1'，但我必须对 $1 所在的同一字符串执行正则表达式。它每次都用正则表达式中的字符替换 $1。

如何找到并替换此字符串中的 $1？

正在发生的事情的例子：

```
string1 = '<item id="1">i have $100</item>'

regexp = new RegExp('<item id="1"([^<]|<[^\/]|<\/[^i]|<\/i[^t]|<\/it[^e]|<\/ite[^m]|<\/item[^>])*<\/item>');

data = '<data><item id="1">i have no money</item><item id="2">i have no money</item></data>'

data = data.replace(regexp, string1); 
```

结果

```
<data><item id="1">i have >00</item><item id="2">i have no money</item></data> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-24T14:27:38.790

如果您想在`replace()`调用中放入一个可能包含`$N`' 的变量字符串，则可以通过替换为来防止 '被`$N`视为反向引用。显然，与 JS 正则表达式中的其他特殊字符不同，该字符不能用 a 转义- 它必须用前面的转义（见图）。`$``$$``$``\``$`

在您的示例中，您可以执行以下操作来解决此问题：

```
data = data.replace(regexp, string1.replace('$', '$$$')); 
```

这应该将任何`$`'s 变成`$$`in `string1`，防止它们被视为反向引用。

[（注意：我在这里](http://gotofritz.net/blog/code-snippets/escaping-in-replace-strings-in-javascript/)找到了这个小金块）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T21:40:30.453

只有当您在正则表达式中有一个捕获组时，才会发生这种情况。

如果您不希望您的组捕获，则放置`?:`在组的开头。

```
/foo(?:bar)/ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-12T22:00:52.220

你可以逃脱`$`. 例如：

```
var replacement = '<item id="1">i have \\$100</item>'; 
```

当您有捕获组并需要编写一个`$`.

# javascript - 谷歌地图多边形

> ID：11005250
> 
> 赞同：0
> 
> 时间：2012-06-12T21:37:53.157
> 
> 标签：javascript, maps, polygon

我想在同一个谷歌地图中绘制多个多边形，我需要做的是从列表框中读取纬度，它们是这样的：

lat1,lng1,1 lat2,lng2,1 lat3,lng3,1 lat1,lng1,2 lat2,lng2,2 lat3,lng3,2

并根据右侧的值（1或2）我将读取相应的纬度并绘制多边形，实际上我正在这样做，在我的循环中绘制了多边形但是有一条线连接它们，我能做什么？，我的意思是，如果没有这些连接线，我如何绘制多边形？，非常感谢！

这是我的代码：

```
 <script type="text/javascript">

        var bermudaTriangle=[];
        var places = [];
        var geoDataSplit;
        function initialize() {

            var mapDiv = document.getElementById('map_canvas');
            var coords = document.getElementById("selPoly");

            var map = new google.maps.Map(mapDiv, {
                center: new google.maps.LatLng(19.3162200000000, -99.2204930000000),
                zoom: 12,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            });

            var latlng;

            for (var i = 0; i < coords.options.length; i++) 
                {
                    var geoData = coords.options[i].text;
                    geoDataSplit = geoData.split(",");
                    var counter = geoDataSplit[2];

                    for (geoDataSplit[2] = 1; geoDataSplit[2] <= 2; geoDataSplit[2]++)

                    {

                        if (counter == geoDataSplit[2]) {

                            latlng = new google.maps.LatLng(parseFloat(geoDataSplit[0]), parseFloat(geoDataSplit[1]));
                            places.push(latlng);

                            bermudaTriangle = new google.maps.Polygon({
                                paths: places,
                                strokeColor: "#FF0000",
                                strokeOpacity: 0.8,
                                strokeWeight: 2,
                                fillColor: "#FF0000",
                                fillOpacity: 0.35
                            });
                        }
                    }
                }
                bermudaTriangle.setMap(map);
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
    </head>

  <body style="font-family: Arial; border: 0 none;">
    <form id="form1" runat="server">
    <div>
        <asp:ListBox ID="selPoly" runat="server"></asp:ListBox>
    </div>
    </form>

    <div id="map_canvas" style="width: 1024px; height: 768px"></div>
  </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T11:53:17.007

绘制多边形是在点之间绘制线（您给出的后续点，可能还有列表中的第一个和最后一个点）。当它们包围一个空间时 - 你会得到一个多边形并且空间充满了颜色。这条线总是在两个后续点之间。

如果您想要单独的多边形，您必须创建单独的多边形（使用`new google.maps.Polygon`）。如果你得到的只是一个点列表，你可以想出或找到一个算法来检测空间是否已经被封闭，并且应该创建一个新的多边形。

顺便说一句，使用现在的算法，`new google.maps.Polygon`可以（并且可能应该）将行向下推到循环之外，在前面的行中 `bermudaTriangle.setMap(map)`；

哦，等等，实际上有一个解决方案。或者至少是一个半解决方案。您可以使线条不可见 ( `strokeOpacity: 0`)。由于填充，多边形仍然可见，或多或少像这样： ![在此处输入图像描述](../Images/fd2721d1a3b41efa5721eada75d6adec.png)

# c# - 关闭 Windows 窗体时 Excel 锁定

> ID：11005255
> 
> 赞同：1
> 
> 时间：2012-06-12T21:38:09.330
> 
> 标签：c#, excel

使用 C# 我正在开发一个 Excel 加载项。此加载项打开一个 Windows 窗体并需要设置`ScreenUpdating`为 false，因此我使用以下代码。

```
using Excel = Microsoft.Office.Interop.Excel;
[...]
ExcelApp = Globals.ThisWorkbook.ThisApplication;
ExcelApp.ScreenUpdating = false; 
```

到目前为止，这工作正常。但是 Excel 在关闭表单时锁定，我不知道为什么。删除以下行时，关闭表单成功。

```
ExcelApp = Globals.ThisWorkbook.ThisApplication;
ExcelApp.ScreenUpdating = false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T12:56:41.510

`ExcelApp.ScreenUpdating = true;`在关闭表单之前设置可以解决问题。

# javascript - 在浏览器会话之间持续的 Chrome 标签的持久唯一 ID

> ID：11005258
> 
> 赞同：10
> 
> 时间：2012-06-12T21:38:20.320
> 
> 标签：javascript, google-chrome, google-chrome-extension, guid

我正在尝试确定某种方法来为满足以下条件的 Chrome 选项卡建立唯一 ID：

*   唯一标识每个选项卡
*   浏览器重新启动之间的给定选项卡保持不变（会话恢复选项卡）
*   如果选项卡已关闭然后使用撤消关闭的选项卡 (Ctrl+Shift+T) 重新打开，则保持不变
*   如果选项卡重复，则保持不同

我进行了一些相当积极的研究以找到一个全面的解决方案，但似乎没有什么能完全奏效。以下是我尝试过的方法，按功效递增的顺序：

*   **使用 Chrome 提供的 tab.id：**不会在浏览器会话或关闭/撤消关闭之间持续存在
*   **将 GUID 放入 cookie：**每个选项卡不是唯一的，仅每个域/URL
*   **将 GUID 放入 localStorage：**在浏览器会话和关闭/撤消关闭之间持续存在，但每个选项卡不是唯一的，仅每个域
*   **将 GUID 放入 sessionStorage：**每个选项卡唯一，在关闭/撤消关闭期间持续存在，对于重复的选项卡是唯一的，但在浏览器会话之间被清除
*   **使用可识别的网页文档属性作为唯一键：**这是迄今为止我发现的最佳方法。可以通过内容脚本从以下值构造密钥：`[location.href, document.referrer, history.length]`.

关于最后一种方法，构造的键在所有共享公共 URL、引荐来源和历史长度的选项卡中是唯一的。对于浏览器重新启动/会话恢复和关闭/撤消关闭之间的给定选项卡，这些值将保持不变。虽然这个键是“相当”独特的，但在某些情况下它是模棱两可的：例如，打开到[http://www.google.com](http://www.google.com)的 3 个新标签都将具有相同的键（这种事情发生得很经常在实践中）。

在当前浏览器会话期间，“将 GUID 放入 sessionStorage”方法还可用于消除具有相同构造键的多个选项卡之间的歧义，以用于关闭/撤消关闭和重复选项卡的情况。但这并不能解决浏览器重启之间的歧义问题。

在会话恢复期间，可以通过观察 Chrome 在哪些窗口中同时打开哪些选项卡，并根据预期的“兄弟”选项卡的存在推断给定的模棱两可键哪个选项卡属于哪个窗口（在前一个浏览器期间记录会议）。正如您可能想象的那样，实施此解决方案非常复杂且相当狡猾。它只能消除 Chrome 恢复到不同窗口的相同键选项卡之间的歧义。这使得恢复到同一个窗口的相同键的选项卡变得不可调和的模棱两可。

有没有更好的办法？在浏览器重新启动（会话恢复）和关闭/撤消关闭之间保持唯一的、浏览器生成的、每个选项卡的 GUID 是理想的，但到目前为止我还没有找到类似的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T09:23:45.727

这里的问题完成了大部分发现工作，并且接受的答案基本上完成了它，但是对于希望实现需要持久选项卡 ID 的东西的人来说，仍然存在很大的实现差距。我试图将其提炼成实际的实现。

回顾一下：通过维护一个选项卡寄存器，可以（几乎）根据问题的要求唯一且一致地识别选项卡，该寄存器将以下变量组合存储在本地持久存储中：

*   `Tab.id`
*   `Tab.index`
*   在选项卡中打开的文档的“指纹” -`[location.href, document.referrer, history.length]`

可以使用以下事件组合上的侦听器来跟踪这些变量并将其存储在注册表中：

*   `onUpdated`
*   `onCreated`
*   `onMoved`
*   `onDetached`
*   `onAttached`
*   `onRemoved`
*   `onReplaced`

仍然有方法可以欺骗这种方法，但实际上它们可能非常罕见 - 主要是边缘情况。

因为看起来我不是唯一需要解决这个问题的人，所以我将我的实现构建为一个库，目的是它可以在任何 Chrome 扩展程序中使用。它是 MIT 许可的，[可在 GitHub 上](https://github.com/drzax/chrome-tab-registry)用于分叉和拉取请求（事实上，欢迎任何反馈 - 肯定有可能的改进）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T06:25:54.297

如果我正确理解了您的问题，那么您的第 5 种方法应该可以解决问题，但要符合以下两个标准：

*   `chrome.tabs.windowId`（包含选项卡的窗口的 ID）
*   `chrome.tabs.index`（其窗口中选项卡的从零开始的索引）

所有这些值都需要存储在您的扩展中。`chrome.tabs.onUpdated()`除此之外，当标签被拖动、跨所有者窗口等移动时，您还必须连接您的扩展并相应地更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-10T17:53:50.917

把它作为一个持久的后台脚本放在 manifest.json 中：

```
"background": {
        "scripts": [ "background.js" ],
        "persistent": true
}, 
```

这是背景.js。希望代码是不言自明的。

```
var tabs_hashes = {};
var tabs_hashes_save_queued = false;

function Start(){
    chrome.tabs.query({windowType: "normal"}, function(querytabs){
        querytabs.forEach(function(tab){
            tabs_hashes[tab.id] = GetHash(tab.url);
        });

        if (localStorage.getItem("tabs_hashes") !== null){

            var ref_load = JSON.parse(localStorage["tabs_hashes"]);
            var ref_tabId = {};

            querytabs.forEach(function(tab){
                for (var t = 0; t < ref_load.length; t++){
                    if (ref_load[t][1] === tabs_hashes[tab.id]){
                        ref_tabId[ref_load[t][0]] = tab.id;
                        ref_load.splice(t, 1);
                        break;
                    }
                }
            });

            // do what you have to do to convert previous tabId to the new one
            // just use ref_tabId[your_previous_tabId] to get the current corresponding new tabId
            console.log(ref_tabId);

        }
    });
}

function SaveHashes(){
    if (!tabs_hashes_save_queued && Object.keys(tabs_hashes).length > 0){
        tabs_hashes_save_queued = true;
        chrome.tabs.query({windowType: "normal"}, function(querytabs){
            var data = [];
            querytabs.forEach(function(tab){
                if (tabs_hashes[tab.id]){
                    data.push([tab.id, tabs_hashes[tab.id]]);
                } else {
                    data.push([tab.id, GetHash(tab.url)]);
                }
            });
            localStorage["tabs_hashes"] = JSON.stringify(data);
            setTimeout(function(){ tabs_hashes_save_queued = false; }, 1000);
        });
    }
}

function GetHash(s){
    var hash = 0;
    if (s.length === 0){
        return 0;
    }
    for (var i = 0; i < s.length; i++){
        hash = (hash << 5)-hash;
        hash = hash+s.charCodeAt(i);
        hash |= 0;
    }
    return Math.abs(hash);
}

chrome.tabs.onCreated.addListener(function(tab){
    SaveHashes();
});
chrome.tabs.onAttached.addListener(function(tabId){
    SaveHashes();
});
chrome.tabs.onRemoved.addListener(function(tabId){
    delete tabs_hashes[tabId];
    SaveHashes();
});
chrome.tabs.onDetached.addListener(function(tabId){
    SaveHashes();
});
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo){
    if (changeInfo.pinned != undefined || changeInfo.url != undefined){
        delete tabs_hashes[tabId];
        SaveHashes();
    }
});
chrome.tabs.onMoved.addListener(function(tabId){
    SaveHashes();
});
chrome.tabs.onReplaced.addListener(function(addedTabId, removedTabId){
    delete tabs_hashes[removedTabId];
    SaveHashes();
});

Start(); 
```

我使用数组来保存数据，因为这样我可以保留制表符顺序，如果数据保存在对象中，这是不太可能的。在浏览器重新启动后加载数据时，即使 url 不是唯一的，我可以相信它会在某个“足够接近”的索引下。我会做的更复杂，例如反向检查是否找不到选项卡，但到目前为止这工作正常。

# php - 远程 Symfony2 + Netbeans 工作流程（feat.git）

> ID：11005260
> 
> 赞同：0
> 
> 时间：2012-06-12T21:38:23.847
> 
> 标签：php, git, postgresql, netbeans, symfony

## 我希望有人以前遇到过这个问题并且能够提供帮助

所以，问题是这样的：有 2 个开发人员，每个人都需要一个网站的 2 个版本（开发 + 生产）。由于非常不同的操作系统、三重配置困难和对它们的管理限制，不可能在本地运行项目。但是远程运行时会出现很多问题：

*   如何在 Netbeans 中运行 Symfony2 CLI 命令（因为这些命令需要访问 db）？
*   如何区分生产/开发？我已允许 2 个 IP 地址对 db 的外部访问，但只有一个`parameters.ini`文件。一旦它用于连接到 localhost（当通过 http 运行时），第二次它用于通过远程主机连接（当 CLI 命令在 netbeans 中运行时）

您可能会问更多信息，所以这里是：

*   开发 #1：Kubuntu 12.04 x64 3.2.0-25-generic NB@7.1.2
*   开发 #2：Windows 7 x64 NB@7.1.2
*   服务器：Ubuntu 服务器 12.04 x64
*   SQL: PostgreSQL
*   网络服务器：Apache2

我们的工作流程现在看起来（或至少应该看起来）是这样的：

1.  Dev #1 在本地做一些事情，但是在运行时，更改会被移到服务器上，这样他就可以检查它是如何进行的`beta1.sitename.com`。
2.  每个更改都会在合适的时候提交到 git 中的用户分支。
3.  测试后，更改将合并到 master，经过测试，拉到 a `sitename.com`，然后再次测试。
4.  在此之后循环重复:)

PS。有效的答案也将暗示在这种情况下工作流程应该如何正确。我已经尝试过使用 post-* git 句柄，但它也没有很好地工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T10:33:38.257

首先，我强烈建议尝试解决开发机器问题。有[vagrant](http://www.vagrantup.com)可以与 chef 或 puppet（或专用虚拟基础机）一起使用，将开发环境移动到开发人员 pc 上执行的虚拟机中。这也将解决有关远程服务器的许多问题。

如果无法做到这一点，这里有一些想法：

Netbeans 命令无法远程工作。让您的开发人员 ssh 进入机器并执行他们的命令。

我没有得到您的开发/生产环境问题。他们应该至少在虚拟主机上为每个开发人员提供不同的配置/缓存/日志，以便可以正确设置配置。parameters.ini 不应在您的 git 存储库中（您可以通过创建 parameters.ini.dist 并忽略 parameters.ini 文件来处理此问题），因此您可以使用不同的参数。另一个有趣的事情（在 symfony live 2012 Paris 上展示）是你可以在你的 apache vhost 中执行 SET_ENV SMFONY_ *PARAMETER* _NAME然后在你的配置文件中使用 %parameter.name% （注意两个下划线）。这对您的情况可能很有用。

确实没有我知道的工作流程可以在一台机器上处理具有不同配置等的多个开发人员。这只是一团糟，您要么使用每次发生事情时运行的复杂脚本来解决您的问题，要么通过找到更好的解决方案，例如虚拟机或服务器上具有不同目录的不同虚拟主机。

# javascript - Javascript从函数动态读取数组值

> ID：11005265
> 
> 赞同：0
> 
> 时间：2012-06-12T21:38:44.547
> 
> 标签：javascript

如何将数组名称传递给函数并动态读取值？

***我动态地生成了如下数组***

```
fruits[0] = "Banana";
fruits[1] = "Orange";
fruits[2] = "Apple"; 
```

//下面的超链接激活功能

```
I have a function in hyeperlink <a href="javascript: activate('1', 'fruits')">Click Me</a> 
```

下面是函数

```
function activate(idNumber, arrayName)
{
  alert('id is:'+ idNumber); **//Working** 
  alert(arrayName[idNumber]); **//Not working must print fruits[1]**

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:41:58.737

这取决于定义“水果”的范围。

假设它是全局的，`window[arrayName]`将在`arrayName=='fruits'`. 这是因为`window`持有对所有全局对象的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:41:42.250

您正在传递字母“f”、“r”、“u”、“i”、“t”和“s”而不是变量，只需从变量周围删除引号：

```
<a href="javascript: activate('1', fruits)">Click Me</a> 
```

# python - 线程数据库中的看门狗时间？

> ID：11005269
> 
> 赞同：0
> 
> 时间：2012-06-12T21:38:59.800
> 
> 标签：python, multithreading, timer, watchdog

我有一个程序，它从一个名为 daemon.py 的 python 脚本开始，这个守护程序脚本启动了 4 个线程，这些线程在程序运行的整个过程中都处于活动状态。

我想使用初始守护程序作为其他线程的看门狗。我在想每个线程在 sqlite 数据库中都有自己的时间，守护进程会倒计时。它的线程作业是重置自己的计时器。如果有任何计时器将其设为 0，则守护程序将重新启动一切。

这是这样做的好方法吗？如果不是，我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T04:27:15.803

您的方法在高层次上似乎是有效的，尽管没有关于 4 个线程的功能的更多细节，很难肯定地说。主线程可以通过修改线程的实例变量来为这4个线程提供指导。您不需要使用数据库作为通信机制。Python 有一些有用的线程特性可以为你解决大部分问题。

此外，听起来您希望线程在一段时间后超时或死亡，然后重新创建。为此，您可以让 4 个线程中的每一个都重置一个实例变量，例如`last_active`，主线程可以使用该信息对线程进行相应的操作。没有简单的方法可以杀死 python 中的任意线程。我的首选方法是这样的：

```
def run():
    while not self.kill_requested:
        ... 
```

# c++ - 如果附加在末尾，则 const 字符串不起作用

> ID：11005271
> 
> 赞同：1
> 
> 时间：2012-06-12T21:39:06.477
> 
> 标签：c++, string

> **可能重复：**
> [连接两个字符串文字](https://stackoverflow.com/questions/6061648/concatenate-two-string-literals)

为什么这不起作用？

```
const std::string exclam = "!";          
const std::string message = "Hello" + ", world" + exclam; 
```

但这很好用

```
const std::string exclam = "!";       
const std::string message = exclam +
"Hello" + ", world" ; 
```

请给我解释一下。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T21:46:07.427

原因是没有`operator+`添加两个字符串文字，也不需要。如果您只*删除*.`+`

```
const std::string message = "Hello"  ", world" + exclam; 
```

因为~~预处理器~~编译器 magic*) 会将两个相邻的文字加在一起。

第二个示例有效，因为`std::string`确实有一个`operator+`添加字符串文字的。结果是另一个字符串，它可以连接下一个文字。

* * *

*) 翻译阶段 6 -*连接相邻的字符串文字标记。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T21:43:11.397

因为表达式`"Hello" + ", world"`不涉及任何`std::string`，而是两个`const char[]`参数。并且没有带有该签名的 operator+。您必须将其中一个转换为`std::string`第一个：

```
const std::string message = std::string("Hello") + ", world" + exclam; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T21:42:26.450

std::string 有一个 + 运算符，这是第二个示例中使用的。const char * 没有第一个示例中使用的那个运算符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T21:45:59.507

这取决于关联性。

第二种情况开始（从左侧）评估与`std::string`连接`operator+`。第一种情况以 开头，并且不存在`const char *`任何连接。`operator+`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T21:49:35.330

“如果附加在末尾，则 const 字符串不起作用”是一条红鲱鱼。这也不起作用：

```
const std::string message = "Hello" + ", world"; 
```

这不起作用的原因已在其他答案中进行了解释。

# iframe - 如何将当前索引传递给fancybox iframe

> ID：11005272
> 
> 赞同：0
> 
> 时间：2012-06-12T21:39:06.977
> 
> 标签：iframe, fancybox

我有一组链接，我称之为 fancybox 并启用了箭头，以便用户可以单击下一个和上一个。每个链接都用 iframe 类和 href='/editdata.aspx' 装饰。我会删除箭头并传入当前索引，以便 editdata.aspx 保存按钮可以说“保存并下一步”，直到它到达最后一个链接，然后会说“保存并关闭”。

从我使用的editdata.aspx

```
var numLinks = $(".link-items", parent.document.body).children("a.iframe").size(); 
```

这给了我链接的总数。我只需要知道正在向用户显示的当前链接，以便我可以更新保存按钮文本。

这是我在editdata.aspx中的代码示例：

```
// change the save button to save and next if fancybox is loading multiple links
        if (parent.$.fancybox) {
            var links = $(".links", parent.document.body);
            if (links && links.length > 0) {
                var numlinks  = $(links).children("a.popup").size();
                var index = getParameterByName('index');
                if (index == numlinks ) {
                    // this element is the last item to display so change the "save and next" to "save and close"
                    $("#btnSave").val("Save & Close");
                    $("#btnSave").click(function () {
                        parent.$.fancybox.close();
                    });
                }
                else {
                    $("#btnSave").val("Save & Next");
                    $("#btnSave").click(function () {
                        parent.$.fancybox.next();
                    });
                }
            }                
        }

function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regexS = "[\\?&]" + name + "=([^&#]*)";
        var regex = new RegExp(regexS);
        var results = regex.exec(window.location.href);
        if (results == null)
            return "";
        else
            return decodeURIComponent(results[1].replace(/\+/g, " "));
    } 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:32:03.000

这对 v2 来说很容易 -

```
jQuery(".fancybox").fancybox({
    beforeLoad : function() {
        this.href = this.href + '?index=' + this.index;
    }
}); 
```

# python - 找到函数“in”的文档页面

> ID：11005277
> 
> 赞同：2
> 
> 时间：2012-06-12T21:39:50.477
> 
> 标签：python

我正在尝试查找该功能的文档

```
in 
```

蟒蛇内部。这非常困难，因为搜索引擎无法使用像 in 这样的词。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T21:43:54.027

" `in`" 不是函数。它是一个内置关键字。使用它可以触发目标对象`__contains__()`

[http://docs.python.org/reference/datamodel.html#object。**包含**](http://docs.python.org/reference/datamodel.html#object.__contains__)

```
>>> l = ['a']
>>> l.__contains__('a')
True
>>> 'a' in l
True 
```

我说“可以触发”是因为逻辑有不同的方式可以在后台解决：

> 对于未定义`__contains__()`的对象，成员资格测试首先尝试迭代 via `__iter__()`，然后尝试旧的序列迭代协议 via`__getitem__()`

请注意，此示例仅涵盖成员资格测试，而不是使用它来循环迭代。

为了说明`in`在循环操作期间如何解决，首先使用以下方法查找迭代器`__iter__()`：

```
l = range(5)
l.__iter__()
# <listiterator object at 0x1004e4fd0>
it = l.__iter__()
it.next()
# 0
it.next()
# 1
it.next()
# 2 
```

如果对象没有`__iter__()`定义，它将尝试使用较旧的`__getitem__()`. 以一个字符串为例，它没有`__iter__()`. 这只是一个例证……

```
>>> i = 0
>>> s = "string"
>>> while i < len(s):
...  print s.__getitem__(i)
...  i+=1
... 
s
t
r
i
n
g 
```

并显示一个类似的迭代器（这里的生成器）：

```
gen = (s.__getitem__(i) for i in xrange(len(s)))
# <generator object <genexpr> at 0x1004e8780>
gen.next()
# 's'
gen.next()
# 't'
gen.next()
# 'r' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T21:44:27.473

对于该`in`结果的布尔值的使用，请参阅[http://docs.python.org/reference/expressions.html#membership-test-details](http://docs.python.org/reference/expressions.html#membership-test-details)。您还可以`in`在表单中以几种不同的方式使用`for item in collection`，其信息可在同一页面上找到。

运算符的内部机制`in`在此页面上有详细说明：http: [//docs.python.org/reference/datamodel.html](http://docs.python.org/reference/datamodel.html) - 它的要点是支持它的对象需要提供`__contains__()`布尔使用的方法，我考虑`__iter__()` 使用`for item in collection`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T21:47:13.743

我认为它被称为“ [`__contains__`](http://docs.python.org/reference/datamodel.html?highlight=contains#object.__contains__)”。

# java - 如何对调用 Jersey 客户端 API 的代码进行单元测试？

> ID：11005279
> 
> 赞同：28
> 
> 时间：2012-06-12T21:39:57.387
> 
> 标签：java, unit-testing, junit, jersey, jax-rs

我编写了调用 Jersey 客户端 API 的代码，而后者又调用了我无法控制的 Web 服务。我不希望我的单元测试调用实际的 Web 服务。

为调用 Jersey 客户端 API 的代码编写单元测试的最佳方法是什么？我应该使用 Jersey 服务器 API 编写 JAX-RS Web 服务，然后使用 Jersey 测试框架进行单元测试吗？或者我应该模拟 Jersey Web 服务调用？我可以访问 JMock。还是我应该尝试另一种方法？

在我的研究中，我发现[这个讨论](http://jersey.576304.n2.nabble.com/Unit-Testing-code-that-uses-the-Jersey-Client-API-td7071519.html)描述了各种选项，但我确实找到了一个完整的解决方案。是否有可用的代码示例显示建议的 JUnit 方法？我在泽西岛的文档中找不到任何东西。

以下是相关的源代码：

```
public String getResult(URI uri) throws Exception {
  // error handling code removed for clarity
  ClientConfig clientConfig = new DefaultClientConfig();
  Client client = Client.create(clientConfig);
  WebResource service = client.resource(uri);
  String result = service.accept(accept).get(String.class);
  return result;
} 
```

以下是我想通过的测试代码示例。我想测试（1）传入一个有效的 URI 并返回一个有效的字符串，以及（2）传入一个无效的（无论出于何种原因 - 无法访问或未经授权）的 URI 并返回一个异常。

```
@Test
public void testGetResult_ValidUri() throws Exception {
  String xml = retriever.getResult(VALID_URI);
  Assert.assertFalse(StringUtils.isBlank(xml));
}

@Test(expected = IllegalArgumentException.class)
public void testGetResult_InvalidUri() throws Exception {
  retriever.getResult(INVALID_URI);
} 
```

以上所有内容都是对我的代码功能的简单描述。实际上，在它之上有一层接受两个 URI，首先尝试调用第一个 URI，如果该 URI 失败，则它会尝试调用第二个 URI。我希望进行单元测试，涵盖（1）第一个 URI 成功，（2）第一个 URI 失败，第二个 URI 成功，以及（3）两个 URI 都失败。这段代码非常复杂，我想使用 JUnit 测试这些不同的场景，但要做到这一点，我需要运行实际的备用 Web 服务或模拟 Jersey 客户端 API 调用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-12T22:27:54.613

尝试使用 Mockito 或 Easymock 来模拟服务调用。您只需要模拟这些实际使用的方法 - 无需模拟每个方法。您可以为 WebResource 类创建模拟对象，然后模拟接受方法调用。

在@BeforeClass/@Before JUnit 测试方法中编写类似（Mockito 示例）

```
WebResource res = mock(WebResource.class);
when(res.accept(something)).thenReturn(thatWhatYouWant); 
```

然后在您的测试中，您可以像使用真实对象一样使用 res 对象并在其上调用模拟方法。除了返回值，您还可以抛出异常。[Mockito](http://code.google.com/p/mockito/)很酷。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-10-22T05:17:53.990

通常，您真正追求的是*“我使用 Jersey Client DSL 的方式是否会使用正确的有效负载和 URL 参数生成对正确 URL 的请求”*。使用 Mockito 进行测试非常冗长，设置代码通常最终看起来像这样：

```
 when(authentication.queryParam(eq("sa"), anyBoolean())).thenReturn(testAuthentication);
    when(testAuthentication.resolveTemplate("channel", "smf")).thenReturn(testAuthentication);
    when(testAuthentication.request(
            MediaType.APPLICATION_JSON_TYPE)).thenReturn(mockRequestBuilder);
    when(mockRequestBuilder.post(any(Entity.class))).thenReturn(mockResponse);
    when(mockResponse.readEntity(ResponseWrapper.class)).thenReturn(successfulAuthResponse()); 
```

这基本上只是针对单个 REST 请求。它过于冗长，您只是在复制您认为在使用 Jersey Client DSL 时正确的步骤，而不是测试希望的结果。

而不是上面的，我的目标是模拟一个简单的服务。为此，我使用[了 WireMock](http://wiremock.org/)，它启动了一个 Jetty 服务器，我可以在其中存根诸如*“期望对这个 URL 的请求，用这个消息响应并验证有效负载是这个”之*类的东西。

我知道这是一个集成测试，它比仅使用 Mockito 慢一点，但我重视测试实际结果，并且在这种情况下我更重视测试的可读性。

基于 WireMock 的 Jersey 客户端测试的设置如下所示：

```
@Test
public void exactUrlOnly() {
    stubFor(get(urlEqualTo("/some/thing"))
            .willReturn(aResponse()
                .withHeader("Content-Type", "text/plain")
                .withBody("Hello world!")));

   assertThat(testClient.get("/some/thing").statusCode(), is(200));
   assertThat(testClient.get("/some/thing/else").statusCode(), is(404));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T00:53:54.663

只需实现一个类似工作的服务，并在您的单元测试设置中使用 HttpServerFactory 启动该服务。

# asp.net-mvc-3 - 在 MVC3 控制器之外调用 Ninject 时 HttpContext 为空

> ID：11005282
> 
> 赞同：1
> 
> 时间：2012-06-12T21:40:25.303
> 
> 标签：asp.net-mvc-3, ninject, ninject.web.mvc

这个问题[Ninject Dependency Injection in MVC3 - Outside of a Controller](https://stackoverflow.com/questions/8097338/ninject-dependency-injection-in-mvc3-outside-of-a-controller)与我所经历的很接近，但并不完全如此。

我有一个使用 Ninject 3 的 ASP.NET MVC3 站点，它与构造函数注入完美配合。我的所有依赖项都已解决，包括那些在 HttpContext.Current 中传递的依赖项。

我的问题是，在 global.asax 中，我启动了一个 TaskManager 类，该类定期在计时器上执行一些任务。在 TaskManager 类中，我没有控制器，所以如果我需要访问我的依赖项之一（比如我的错误日志服务），我使用一个可以访问内核对象的静态包装类：

```
var logger = MyContainer.Get<ILoggingService>();
logger.Error("error doing something...", ex); 
```

.Get 方法只是执行一个 kernel.Get 调用来解决我的依赖。每次我在其他依赖项上使用此方法时效果都很好。但是， ILoggingService 有一个名为 MyWebHelper 的依赖项，它通过其构造函数注入，并在其构造函数中包含 HttpContext。

```
 public class DefaultLogger : ILoggingService
    {     
        public DefaultLogger(IRepository<Log> logRepository, IWebHelper webHelper)
        {
            _logRepository = logRepository;
            _webHelper = webHelper;
       }
    }

    public class MyWebHelper : IWebHelper
    {
      public MyWebHelper(HttpContext httpContext)
      {
          _httpContext = httpContext;
      }
    } 
```

在我的网站的其余部分，这一切都很好，因为所有依赖项都被注入到我的 MVC 控制器中。但是，如果我手动调用我的静态包装类来获取我的依赖项，那是行不通的。我得到错误：

> 使用从 HttpContext 到方法的绑定激活 HttpContext 时出错
> 
> 提供者返回 null。

所以，它并没有像我的 MVC 应用程序的其余部分那样给我一个 HttpContext。我希望这是有道理的，我还不是 ninject 专家，但我正在尝试......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T06:23:45.243

> 我的问题是，在 global.asax 中，我启动了一个 TaskManager 类，该类定期在计时器上执行一些任务。

[正如 Phil Haack详细解释的](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)那样，这是一个坏主意。不要在您的 Web 应用程序中执行此操作。这些重复性任务应在单独的应用程序（Windows 服务或计划定期运行的某些控制台应用程序）中完成。

现在问题是您正在运行后台线程。这些后台线程在任何用户 HTTP 请求之外运行，因此`HttpContext.Current`在它们内部显然是空的。因此，即使您不遵循 Phil Haack 的建议并继续在 ASP.NET 应用程序中运行后台任务，您也必须重新构建您的方法，使其不再依赖于任何 HttpContext，因为这些后台线程中没有这样的东西。

# java - 检查 null Boolean 是否为真导致异常

> ID：11005286
> 
> 赞同：210
> 
> 时间：2012-06-12T21:40:32.550
> 
> 标签：java

我有以下代码：

```
Boolean bool = null;

try 
{
    if (bool)
    {
        //DoSomething
    }                   
} 
catch (Exception e) 
{
    System.out.println(e.getMessage());             
} 
```

为什么我对布尔变量“bool”的检查会导致异常？当它“看到”它不是真的时，它不应该直接跳过 if 语句吗？ **当我删除 if 语句或检查它是否为空时，异常消失了。**

* * *

## 回答 #1

> 赞同：509
> 
> 时间：2013-09-13T15:36:34.273

如果您不喜欢额外的空检查：

```
if (Boolean.TRUE.equals(value)) {...} 
```

* * *

## 回答 #2

> 赞同：193
> 
> 时间：2012-06-12T21:42:26.910

当您有 a`boolean`时，它可以是`true`或`false`。但是，当您拥有 a 时`Boolean`，它可以是`Boolean.TRUE`，`Boolean.FALSE`也可以是`null`任何其他对象。

在您的特定情况下，您的`Boolean`is`null`和`if`语句会触发隐式转换，`boolean`从而产生`NullPointerException`. 您可能需要：

```
if(bool != null && bool) { ... } 
```

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2014-05-09T01:51:14.917

**使用[Apache BooleanUtils](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/BooleanUtils.html)。**

*（如果峰值性能是您项目中最重要的优先事项，那么请查看不需要包含外部库的本机解决方案的其他答案之一。）*

不要重新发明轮子。利用已经构建和使用的内容`isTrue()`：

```
BooleanUtils.isTrue( bool ); 
```

检查一个`Boolean`值是否为真，`null`通过返回来处理`false`。

*如果您不限于“允许”包含的库，那么有一堆很棒的辅助函数可用于各种用例，包括`Booleans`和`Strings`. 我建议你仔细阅读各种 Apache 库，看看它们已经提供了什么。*

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2019-07-30T22:35:22.690

或者借助 Java 8 Optional 的强大功能，您也可以这样做：

```
Optional.ofNullable(boolValue).orElse(false) 
```

:)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-06-12T21:42:28.777

`Boolean`类型可以`null`。您需要进行`null`检查，因为您已将其设置为`null`.

```
if (bool != null && bool)
{
  //DoSomething
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-12T22:14:34.147

Boolean 是原始布尔值的对象包装类。这个类，与任何类一样，确实可以为空。出于性能和内存原因，最好始终使用原语。

**Java API 中的包装类有两个主要用途：**

1.  提供一种在对象中“包装”原始值的机制，以便可以将原始值包含在为对象保留的活动中，例如添加到集合中，或从具有对象返回值的方法返回。
2.  为原语提供各种实用功能。这些函数中的大多数都与各种转换有关：将基元与字符串对象相互转换，以及将基元和字符串对象与不同的基数（或基数）相互转换，例如二进制、八进制和十六进制。

[http://en.wikipedia.org/wiki/Primitive_wrapper_class](http://en.wikipedia.org/wiki/Primitive_wrapper_class)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-12T21:48:37.813

由于您的变量 bool 指向空值，因此您将始终得到 NullPointerException，您需要先在某个地方使用非空值初始化变量，然后再对其进行修改。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-20T07:11:59.057

`if (bool)`将被编译为`if (bool.booleanValue())`并且会抛出一个`NPE`if `bool`is `null`。

可空盒装布尔评估的其他解决方案：

*   JDK 9+

    ```
    import static java.util.Objects.requireNonNullElse;

    if (requireNonNullElse(bool, false)) {
        // DoSomething 
    ```

*   谷歌番石榴 18+

    ```
    import static com.google.common.base.MoreObjects.firstNonNull;

    if (firstNonNull(bool, false)) {
        // DoSomething 
    ```

`false`此处用于空情况。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-06T18:50:54.693

## 对象.equals()

K-ballo 接受的答案没有任何问题。如果您喜欢一个简单的条件并且像我一样不喜欢 Yoda 条件，那么从 java 1.7 开始，答案是

```
 if (Objects.equals(bool, true)) { 
```

或者如果同时你更喜欢非常明确

```
 if (Objects.equals(bool, Boolean.TRUE)) { 
```

## 或者更好：避免这个问题

不建议使用`Boolean`对象，从而首先允许`Boolean`引用`null`。像你看到的那样的风险`NullPointerException`太大了。如果您需要一种三态逻辑，最好定义一个具有三个值的枚举。例如

```
enum MyTristateBoolean { FALSE, DONT_KNOW, TRUE } 
```

现在我们根本不需要`null`。中间常数可能应该命名为`UNKNOWN`,或其他名称`UNDEFINED`，`NOT_EXISTING`具体取决于您的具体情况。`NULL`如果合适的话，你甚至可以命名它。现在根据口味，您的比较成为以下两者之一。

```
 if (myBool.equals(MyTristateBoolean.TRUE)) {

    if (myBool == MyTristateBoolean.TRUE) { 
```

后者有效，因为编译器保证每个枚举常量只有一个实例。正如你们大多数人所知`==`，对于比较非枚举类型的对象是否相等是无效的。

# javascript - javascript 多行字典声明

> ID：11005290
> 
> 赞同：-1
> 
> 时间：2012-06-12T21:40:48.330
> 
> 标签：javascript

我有一个问题。我想要一个静态字典

```
var myDict={"aaa":true,"aab":false,"aac":false,"aad":true, [...] }; 
```

有很多条目，我希望能够轻松访问所有条目，以防我需要更改它们的值。因此，我不喜欢单行声明。

作为替代方案，我确实设法执行以下操作，因为 Javascript 中允许使用多行文本：

```
var dict = {};
var loadDict = function() {

    text = "aaa,true\n\
aab,false\n\
aac,false\n\
aad,true\n\[...]";

    var words = text.split( "\n" );
    for ( var i = 0; i < words.length; i++ ) {
        var pair = words[i].split(",");
        dict[ pair[0].trim() ] = pair[1].trim();
    }   
} 
```

有没有更好/更优雅的方式来声明一个dict的多行？

注意：[在 JavaScript 中创建多行字符串](https://stackoverflow.com/questions/805107/how-to-create-multiline-strings)是一种仅适用于字符串的解决方案。它不适用于字典。

编辑：我在每行的末尾添加了一个“\”。这就是问题所在。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T21:42:11.293

```
var myDict = {
    "aaa": true,
    "aab": false,
    "aac": false,
    "aad": true,
    [...]
}; 
```

我希望这就是您的意思，因为它是基本的 Javascript 语法。

此外，如果出于某些原因您想将简单对象（由字符串、数字、布尔值、数组或上述实体的对象组成）“存储”到字符串中，您可以考虑使用 JSON：

```
var myDictJSON = '{\
    "aaa": true,\
    "aab": false,\
    "aac": false,\
    "aad": true,\
    [...]
}';
var myDict = JSON.parse(myDictJSON); 
```

对所有主要浏览器的支持`JSON`都是本机的，包括 IE 自版本 8 以来。对于其他浏览器，有这个通用库 json2.js 可以解决问题。

您还可以使用 . 将简单对象转换为字符串`JSON.stringify`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:46:35.950

这很容易-

```
var myDict={
  "aaa":true,
  "aab":false,
  "aac":false,
  "aad":true
}; 
```

请记住，不要将大括号放在下一行。

我喜欢回应。请回答

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T21:45:52.433

这（包含“字符串”和“布尔值”的复杂数据结构）：

```
var myDict={"aaa":true,"aab":false,"aac":false,"aad":true, [...] }; 
```

可以这样表达：

```
var myDict={
  "aaa":true,
  "aab":false,
  "aac":false,
  "aad":true, 
  [...] 
}; 
```

同样，这个：

```
 var myBigHairyString = "Supercalifragilsticexpialidocious"; 
```

可以这样表达：

```
 var myBigHairyString = 
    "Super" +
    "califragilstic" +
    "expialidocious"; 
```

# objective-c - iOS后台任务完成编程

> ID：11005291
> 
> 赞同：3
> 
> 时间：2012-06-12T21:40:54.090
> 
> 标签：objective-c, xcode, ios4, multitasking

我正在尝试在退出我的 iOS 应用程序的前台后添加对完成任务的支持。我在互联网上看到的所有教程都指向我在 Application Delegate 中编写类似这样的内容：

```
- (void)applicationDidEnterBackground:(UIApplication *)application {
    if ([[UIDevice currentDevice] isMultitaskingSupported]) {
        UIApplication *application = [UIApplication sharedApplication];
        __block UIBackgroundTaskIdentifier background_task;
        background_task = [application beginBackgroundTaskWithExpirationHandler: ^ {
            [application endBackgroundTask: background_task];
            background_task = UIBackgroundTaskInvalid;
        }];

        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

            //DO STUFF IN BACKGROUND HERE
            MyTask *task = [[MyTask alloc] initWithURL:@"http://google.com"];
            [task setDelegate:self];
            [task start];

            [application endBackgroundTask: background_task];
            background_task = UIBackgroundTaskInvalid;
        });
    }
} 
```

该任务能够启动，但在它启动后，下一行被处理并且我的应用程序被终止。我能够知道`MyTask`由于委托调用而停止的时间，但是如何更改我的程序以便在委托被调用后将后台任务设置为无效。我会搬家吗

```
[application endBackgroundTask: background_task];
background_task = UIBackgroundTaskInvalid; 
```

到委托功能，还是我需要做其他事情。

提前感谢您的帮助，古维

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-06T21:40:44.280

根据您对 的调用，您已经在后台线程中`dispatch_async`。该方法将立即返回，但您的块将继续运行。

您的问题似乎是您的 start 方法运行另一个异步进程，因此该方法立即返回，并且您的后台任务在`[task start]`能够做任何有意义的事情之前被杀死。

如果你`background_task`在你的委托中走上杀戮之路，你还必须创建一个 ivar 来存储`background_task`，以便你的委托方法可以访问它。这似乎有点沉重。

由于您已经在后台线程中，因此我的建议是您进行重构`[task start]`，使其同步。这样，所有有意义的工作都将在下一行被处理并被`background_task`杀死之前执行。这看起来更简洁，后台任务的所有内容都很好地包装在发送到 dispatch_async 的块中。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-09-24T09:37:43.550

您可以完全删除以下代码：

```
[application endBackgroundTask: background_task];
background_task = UIBackgroundTaskInvalid; 
```

当你的任务过期时，iOS 会调用你的 handlerExpiration 方法来杀死它。有关更多信息，请访问[iOS 后台](http://www.raywenderlich.com/29948/backgrounding-for-ios)

# javascript - Mootools 类扩展调用重写的父方法

> ID：11005292
> 
> 赞同：2
> 
> 时间：2012-06-12T21:40:57.713
> 
> 标签：javascript, inheritance, mootools

我正在玩 Mootools 类继承等，我正在尝试使用 .parent 属性调用基类覆盖的方法（对于长代码片段）。

```
var app = this.app = {},
    //ultimate base class
    Animal = new Class({
        initialize : function(param){
            this.age = param.age;
            this.name = param.name;
        },
        doStuff : function(param){
            alert("animal doStuff");
        }
    }),
    //herbivore functionality
    HerbivoreBehaviour = new Class({
        eat : function(){
            alert('Plants are scrumptious');
        }
    }),
    //carnivore functionality
    CarnivoreBehaviour = new Class({
        eat : function(){
            alert('Meat tastes gooood');
        }
    })
    //mammal base class
    Mammal = new Class({
        Extends : Animal,
        initialize : function(param){
            this.parent(param);
            this.numberOfNipples = param.numberOfNipples;
        },
        doStuff : function(){
            alert("mammal doStuff");
            this.doStuff.parent();
        }
    }),
    //reptile base class
    Reptile = new Class({
        Extends : Animal,
        initialize : function(param){
            this.parent(param);
            this.numberOfScales = param.numberOfScales;
        },
        doStuff : function(){
            alert('reptile doStuff');
            this.doStuff.parent();
        }
    }),
    //final top class animal->mammal-cow!
    //and it's a herbivore
    Cow = new Class({
        Extends : Mammal,
        Implements : HerbivoreBehaviour,
        initialize : function(param){
            this.parent(param);
            this.isMooCrazy = param.isMooCrazy;
        },
        doStuff : function(){
            alert('I am a cow');
            this.doStuff.parent();
        }
    }),
    //final top level class animal->reptile->mutantLizard!
    //and it's a carnivore
    MutantLizard = new Class({
        Extends : Reptile,
        Implements : CarnivoreBehaviour,
        initialize : function(param){
            this.parent(param);
            this.isDestroyingEverything = param.isDestroyingEverything;
        },
        doStuff : function(){
            alert('STOMP STOMP STOMP CRRRRRASH');
            this.doStuff.parent();
        }
    });

    app.run = function(){
        var daisy = new Cow({
                name : 'Daisy',
                age : 2,
                numberOfNipples : 6,
                isMooCrazy : true
            }),
            godzilla = new MutantLizard({
                name : 'Godzilla',
                age : 1123,
                numberOfScales : 123456,
                isDestroyingEverthing : true
            });

        daisy.eat();
        godzilla.eat();
        daisy.doStuff();
        godzilla.doStuff();
    }; 
```

daisy.eat() 和 godzilla.eat() 的当前输出是正确的，但是在 daisy.doStuff() 的第一个打印语句之后执行停止，然后它不会调用 daisy 父类 doStuff() 方法，这就是我希望。你能告诉我我怎么会这样称呼 doStuff 吗？

更新：

我设法通过用 this.parent() 替换 this.doStuff.parent() 来修复他的调用顺序。然而，这引发了关于“this”指的是什么的问题。我认为这将是该类的实际实例，即。daisy 或 godzilla，但在 doStuff 方法中使用 this.parent() 似乎至少对我来说意味着“this”指的是它当前在其中的实际 Function 对象，除非调用 parent() 方法在函数内部会自动查找您所在的方法并调用它的第一个覆盖方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T08:39:27.823

对。基本上，一切都很好，这就是好消息。唯一需要的改变是把你换`this.doStuff.parent()`到`this.parent()`周围。

[http://jsfiddle.net/dimitar/njQBN/](http://jsfiddle.net/dimitar/njQBN/)

似乎工作正常。

做`this.doStuff.parent()`开始并不是很干，而且它还引用了一个本地属性——在一个用相同方法扩展和实现其他人的类的上下文中——同时，会产生……意想不到的结果。

# python - 使用 PyLZMA 解压

> ID：11005301
> 
> 赞同：2
> 
> 时间：2012-06-12T21:41:44.450
> 
> 标签：python, compression, zip, lzma

我使用这个脚本压缩我的文件

```
import pylzma, struct
i = open(path+fileName,'rb')
o = open(path+zipName+'.zip','wb')
data = i.read()
c = pylzma.compressfile(data, eos=1)
result = c.read(5)
result += struct.pack('<Q', len(data))
o.write(result + c.read())
i.close()
o.close() 
```

[我使用PyLZMA 文档](https://github.com/fancycode/pylzma/blob/3d308de8b559ef5b7b5e1566cbc929d1fe278eda/doc/usage.txt)中显示的这种方法，因为它允许 7zip 或 lzma.exe 读取我的文件。使用 7zip 解压可以正常工作，但是当我使用 PyLZMA 时它不起作用。我用这个：

```
i = open(path+name+'.zip', 'rb')
o = open(path+name, 'wb')
data = i.read()
u = pylzma.decompress(data)
o.write(u) 
```

它在 pylzma.decompress 上停止，我收到以下错误：

> TypeError：解压缩时出错：1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T06:46:42.933

如果我正确阅读了[文档](https://github.com/fancycode/pylzma/blob/master/doc/USAGE.md)（我在安装 PyLZMA 时遇到问题，所以我无法验证），`compress()`输出一个`decompress()`可以处理的字符串。

但是，为了使压缩字符串与其他实用程序兼容，有必要在前 5 个字节和其余压缩数据之间插入 8 字节长度。

因此，如果您想使用 PyLZMA 解压缩数据，我怀疑您需要手动删除该 8 字节长度字段（最快的方法可能是打开输入文件，读取 5 个字节，跳过 8 个字节，然后读取文件）。

# python - 使用python在mac中获取文件的“获取信息”属性

> ID：11005303
> 
> 赞同：1
> 
> 时间：2012-06-12T21:41:51.330
> 
> 标签：python, macos, fileinfo

我已经安装了一个驱动器。

在它的“获取信息”中，我有一个名为`Image Disk`

那个地点：`/private/var/run/vmware/fuse/10323660103412696815/flat`

如何使用 python 获取此属性？

`os.stat`不给我这个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:58:56.687

Use the `getxattr` function from the `xattr` module, which is a Python binding to the native function [`getxattr(2)`](https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man2/getxattr.2.html). For example:

```
import xattr
print xattr.getattr('/Volumes/MyDrive', 'Image Disk') 
```

See [this blog post](http://technosophos.com/2009/02/09/python-mac-using-xattr-functions-get-extended-attributes.html) for a more detailed example.

# scala - Oauth：在哪里设置 oauth_callback？

> ID：11005304
> 
> 赞同：0
> 
> 时间：2012-06-12T21:41:51.750
> 
> 标签：scala, oauth, playframework, dropbox, playframework-2.0

我在理解 OAuth 1.0 规范时遇到问题。

oauth 身份验证有 3 个步骤：

1.  获取 request_token（服务器 <-> 服务器）
2.  重定向用户并授权（客户端被重定向）
3.  交换 request_token 为 access_token（服务器 <-> 服务器）

我想设置一个 oauth_callback，以便用户在第 2 步中被重定向到我的站点。

考虑到[https://www.rfc-editor.org/rfc/rfc5849#section-2.1](https://www.rfc-editor.org/rfc/rfc5849#section-2.1)我必须将 oauth_callback 参数放在步骤 1 中。

考虑到[http://oauth.net/core/1.0/#auth_step2](http://oauth.net/core/1.0/#auth_step2)我必须把它放在第 2 步。

什么是正确的？

Dropbox oauth 文档说明了它的第 2 步：[https ://www.dropbox.com/developers/reference/api](https://www.dropbox.com/developers/reference/api)

但是play框架（scala web framework）实现在步骤1中发送了这个参数。

这导致我的 Web 应用程序在身份验证后不会将用户重定向回我的站点。

但是哪个实现是错误的？Dropbox 还是 Play？还是我完全误解了某些东西并且两者都是正确的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:40:45.670

这是一个不同的 OAuth 版本。

*   OAuth 1.0 在步骤 2 中指定参数
*   OAuth 1.0a 指定第 1 步中的参数

RFC 针对 1.0a 进行了更新，而[http://oauth.net/core/1.0/#auth_step2](http://oauth.net/core/1.0/#auth_step2)是针对 1.0 版本的。1.0a 有一个新文档 (http://oauth.net/core/1.0a/)

# android - Android：如何检测两个圆之间的碰撞

> ID：11005305
> 
> 赞同：1
> 
> 时间：2012-06-12T21:41:54.903
> 
> 标签：android, collision-detection, geometry

我在画布上绘制了多个不同大小和位置的圆圈，但我需要检测它们之间的碰撞。

```
public void run() {         
            while(Run){
                if(!sHold.getSurface().isValid())
                    continue;

                c[0][cnum].r++;
                canvas = sHold.lockCanvas();
                canvas.drawRGB(02, 02, 150);
                Paint white = new Paint();
                white.setColor(Color.WHITE);
                if(c[0][cnum].x != 0 && c[0][cnum].y != 0)
                    canvas.drawCircle(c[0][cnum].x, c[0][cnum].y, c[0][cnum].r, white);
                if(cnum!=0)
                    for(int i=0; i<cnum; i++)
                        canvas.drawCircle(c[1][i].x, c[1][i].y, c[1][i].r, white);
                sHold.unlockCanvasAndPost(canvas);
                if(((c[0][cnum].x - c[0][cnum].r)<0)||((c[0][cnum].y-c[0][cnum].r)<0)||((c[0][cnum].y+c[0][cnum].r)>height)||((c[0][cnum].x+c[0][cnum].r>width))){
                    c[1][cnum].x = c[0][cnum].x;
                    c[1][cnum].y = c[0][cnum].y;
                    c[1][cnum].r = c[0][cnum].r;
                    broken = true;
                    break;
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T21:45:33.667

你不应该在渲染阶段这样做。

在处理逻辑时，您应该检查圆圈是否相交，如下所述：

v1 = 圆心 1 v2 = 圆心 2

相交 = v1 - v2 < circle1radius + circle2radius

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-31T05:50:40.457

这个链接非常有用！

[圆-圆碰撞](http://gamedevelopment.tutsplus.com/tutorials/when-worlds-collide-simulating-circle-circle-collisions--gamedev-769)

它非常详细和教学

* * *

在该页面的底部还有另一个链接，指向更详细的内容！

* * *

我使用了中心之间的距离方法--- [圆](https://cdn.tutsplus.com/active/uploads/legacy/tuts/393_qtCollisionDetection123/assets/circles_distance.png)

通过测量每个中心之间的距离，您可以判断它们是否正在碰撞。距离不应大于 2 半径之和。

这是我所做的：

```
private boolean checkDrawContains(ShapeDrawable newHole) 
{
    long newCenterX = newHole.getBounds().left + (newHole.getBounds().width()/2); //Get the center of my shapes
    long newCenterY = newHole.getBounds().top + (newHole.getBounds().height()/2);

    for(ShapeDrawable hole: mHoles) // I was storing the circles in an ArrayList
    { 
        long centerX = hole.getBounds().left + (hole.getBounds().width()/2); //Get the center of my shapes
        long centerY = hole.getBounds().top + (hole.getBounds().height()/2);
        long x = centerX - newCenterX;
        long y = centerY - newCenterY;
        long aux = (long) ((Math.pow(Math.abs(x),2)) + (Math.pow(Math.abs(y),2))); //Pythagoras the hard way :P
        long distance = (long) Math.sqrt(aux);
        long sRads = (newHole.getBounds().width()/2) + (hole.getBounds().width()/2);

        if(distance <=  sRads ) {
            return true;  //Is Colliding!
        }
    }
    return false; // Is not Colliding!
} 
```

# javascript - 当文档已知时，我们如何获取选项卡元素？

> ID：11005316
> 
> 赞同：0
> 
> 时间：2012-06-12T21:42:49.307
> 
> 标签：javascript, gwt, firefox-addon, jsni

在解释问题之前，我想解释一下我的主要目标（如果有比我的方法更好的方法）：

我有可用的*文档*元素，理想情况下我想获得一个浏览器元素，以便它唯一地标识一个选项卡。在我以前的方法中，我使用

```
gBrowser.getBrowserForDocument(doc); 
```

这返回的浏览器确实对选项卡来说是唯一的（从某种意义上说，存储在其中的属性会跨页面持续存在）。相反，如果我不存储浏览器元素，并且在移动到*同一选项卡中的另一个页面*后，我再次尝试上述命令，那么浏览器不再与以前相同（从某种意义上说，它已经丢失了所有存储的属性）。

这就是我的主要问题。我想掌握标签浏览器，我可以使用在同一个标​​签中加载的不同文档来引用它。

我读到了一个类似的功能：

```
gBrowser.getBrowserForTab(tab); 
```

我有一种感觉，这可能会奏效。但同样，我无法理解从哪里可以获得参数“tab”（给定一个文档）。

注意：我正在使用 GWT 开发扩展

* * *

**编辑：**为了澄清问题的意图，这里是*用例*以及我的方法：

在我的扩展中，我对监控特定网站上的用户行为感兴趣。在某种程度上，它可以被认为是一个*会话*，在用户停留在同一个网站之前，它一直处于活动状态。在会话期间，我经常需要存储特定于用户行为的各种属性。“isSessionActive”中与问题有关的属性之一：“Y”或“”（空白字符串代表否）

为了使代码更优化，我没有在开始时为所有选项卡实例化浏览器。相反，我使用 onLoad 函数等待提示。: 如果访问了相关网站

一旦发生这种情况，我使用当前文档元素调用浏览器，查看它是否具有属性 isSessionActive 的非空值。如果不是，我将属性值设置为“Y”并实例化我的类，该类在此之后处理分析。

如果它的值为“Y”，我知道会话仍然处于活动状态并且我不需要初始化。

我面临的问题是，在第一次实例化之后，当我移动到同一选项卡中的另一个页面时，我希望调用 gBrowser.getBrowserforDocument(doc);

会让我之前实例化的浏览器，因为它基本上是相同的选项卡。

这没有发生。每次我得到一个新的 Browser 实例，它的属性 isSessionActive 不为“Y”（可能是因为新页面有一个新的文档元素）。因此，目前我所有的代码都会一遍又一遍地实例化，这是我不想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:11:39.270

如果您只使用当前选项卡（而不是任何背景选项卡），那么您可以只使用 gBrowser.selectedTab [https://developer.mozilla.org/en/XUL/tabbrowser#p-selectedTab](https://developer.mozilla.org/en/XUL/tabbrowser#p-selectedTab)

# xcode - 如何在 Xcode 中找到错误的位置

> ID：11005317
> 
> 赞同：1
> 
> 时间：2012-06-12T21:42:50.177
> 
> 标签：xcode, debugging

如何更改 Xcode 中的首选项，以便它像其他编程环境一样突出显示错误的确切位置，而不是简单地返回 SIGABRT？或者这是不可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T02:25:34.457

当 SIGABRT 等信号发生时，Xcode 应该已经停止并显示执行的位置。（它对我有用，没有任何特殊配置）。

> 发生 NSInvalidArgumentException Xcode 仅突出显示 main.m

这不是您需要捕获的信号，而是例外。转到断点导航器并添加异常断点。

# jquery - 文档点击错误？（火狐 - 窗户）

> ID：11005320
> 
> 赞同：1
> 
> 时间：2012-06-12T21:42:54.477
> 
> 标签：jquery, windows, firefox

这是问题所在。**SELECT打开时， Firefox（Windows）**不会触发文档单击事件。它只是关闭选择，只有下一次点击才会被计为一次点击。

重现：

1.  点击选择（会出现下拉菜单）
2.  单击下拉菜单外部，在文档外部（选择将被关闭）

但是，第二次点击不会触发文档点击事件。

正如您在这个[Youtube 视频](http://www.youtube.com/watch?v=yzoTbRCLBUg)中看到的，有 3 次点击，但有 2 个事件。

[jsFiddle 上的演示](http://jsfiddle.net/acrashik/AWYMb/)

**HTML**

```
<select>
    <option value="1">Value1</option>
    <option value="2">Value2</option>
    <option value="3">Value3</option>
</select>
<div id="debug"></div> 
```

**JS**

```
var n = 0;
$(document).ready(function(){
    $('select').click(function(e){
      e.stopPropagation();
      n++;
      $('#debug').text('select clicked ' + n);
    });

    $(document).click(function(){
        n++;        
        $('#debug').text('document clicked '+ n);
    });
}) 
```

# java - 似乎无法运行 jar 文件

> ID：11005322
> 
> 赞同：1
> 
> 时间：2012-06-12T21:43:06.363
> 
> 标签：java, jar, classpath

如何使用 tsch 脚本在 unix 环境中设置类路径。我尝试如下设置路径，但它给了我错误

setenv CLASSPATH $CLASSPATH : 路径，但是说 -Bad : $(/) 中的修饰符不起作用。我不明白为什么我不能设置这个类路径。因此，我无法按我的意愿运行我的 .jar 可执行文件，而且我的时间不多了。当我尝试运行 .jar 文件时，它给了我以下错误

新错误...当我尝试运行 jar 文件以及我的 jar 文件实际所在的路径时，它显示了这一点，这是我收到的错误

```
Error occurred during initialization of VM
java.lang.Error: Properties init: Could not determine current working directory.
    at java.lang.System.initProperties(Native Method)
    at java.lang.System.initializeSystemClass(System.java:1070) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:49:33.853

类路径应在 jar 内的清单文件中设置。如果没有，您可以尝试解压缩 jar 并使用`java -cp *myClassPath* *myMainClass*`命令运行它。

您可以使用环境变量设置类路径 - 但何必呢？如果您仍然从脚本运行，我认为指定该`-cp`选项不太容易出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:54:05.837

听起来这里至少有两个问题：

> 1) setenv CLASSPATH $CLASSPATH : path 但它不起作用说 -Bad : 在 $(/) 中的修饰符。

这听起来像调用“setenv”的“tsch”错误，“$CLASSPATH”的值不正确。看看你的 $CLASSPATH（或在此处发布）：问题应该很明显。

> 2）VM初始化时出错

这是因为您还没有*类*路径。但是修复你的“setenv()”语法不一定能解决“java init”问题——我们只需要一步一步地解决。

Please post the value of `echo $CLASSPATH`, the value *before* you try "setenv". That should help us fix problem 1)

# jquery - ajaxStop 不触发

> ID：11005333
> 
> 赞同：0
> 
> 时间：2012-06-12T21:44:09.983
> 
> 标签：jquery, ajax

我无法`ajaxStop`在我的页面上开火。我在这里遗漏了一些明显的东西吗？？？

```
var photoArray = [];
var urls = [URL1, URL2] //these are proper URLS in the complete script
_.each(urls, function(url) {
    $.ajax({
        url: url,
        dataType: 'jsonp',
        error: function(x,y,z) {
            console.log(x,y,z);
        },
        success: instagrab
    });
});

$(document).ajaxStop(function() {
    console.log("ajaxstop");
    $(this).unbind('ajaxStop');
}); 
function instagrab(data) {
    _.each(data.data, function(val){
        var tagged = $.inArray(tag, val.tags);
        if (tagged !== -1) {
            photoArray.push(val);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:20:27.177

应该是`$.each`。你有一个下划线。

# .net - 使用自定义 VirtualPathProvider 加载继承自定义 WebViewPage 的嵌入视图

> ID：11005334
> 
> 赞同：4
> 
> 时间：2012-06-12T21:44:15.007
> 
> 标签：.net, asp.net-mvc, virtualpathprovider

与[此问题](https://stackoverflow.com/questions/7746253/using-custom-virtualpathprovider-to-load-embedded-resource-partial-views)类似，我正在使用自定义 VirtualPathProvider 来检索嵌入在 dll 中的视图。如果我不`@inherits System.Web.Mvc.WebViewPage`发表观点，我会收到此错误：

```
The view at '~/Views/Home/Index.cshtml' must derive from ViewPage, ViewPage<TModel>, ViewUserControl, or ViewUserControl<TModel>. 
```

我正在使用从 WebViewPage 继承的自定义 BaseViewPage。在我开始使用这个自定义 VirtualPathProvider 之前，在 web.config 中设置新的基本页面是可行的。现在，如果我尝试在页面上继承我的自定义类，`@inherits My.BaseViewPage`我会得到与上面相同的错误。

为了完整起见，我将补充说，如果我从 WebViewPage 继承，页面确实开始编译，但它会引发错误，因为有代码期望视图具有来自 BaseViewPage 的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T19:50:29.550

事实证明，问题与我使用的视图引擎有关。为了让 VirtualPathProvider 正常工作，我用一个添加了我需要的视图位置的自定义视图引擎替换了视图引擎。`WebFormsViewEngine`我不小心从而不是继承了`RazorViewEngine`这就是为什么我一直得到的错误是 for`ViewPage`而不是`WebViewPage`. 既然这一切都已经解决了，我的自定义基本视图页面就可以正常工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T18:29:19.403

嗯......它是否可能无法从您的 dll 正确解析的基类？

如果是这种情况，您需要做的是在...（从内存中）AppDomain.AssemblyResolve 添加一个自定义程序集/类型解析器处理程序 - 在该处理程序中，您需要从您的 dll 中获取适当的类型并把它还回来。

不幸的是，这纯粹是一种猜测——在我的手机上，所以研究能力有限。

# python - Python求和excel文件

> ID：11005335
> 
> 赞同：2
> 
> 时间：2012-06-12T21:44:15.447
> 
> 标签：python, excel

我有一个包含 3 列的 excel 文件。
请在下面举例

```
Name      Produce     Number
Adam      oranges     6
bob       Apples      5
Adam      Apples      4
steve     Peppers     7
bob       Peppers     16
Adam      oranges     5 
```

我需要以这种方式在python中生成总和

```
Name      Produce     Number
Adam      oranges     11
bob       apples      5
steve     peppers     7
etc 
```

我是 python 新手，想弄清楚如何编写每个人总计的输出？有没有一种简单的方法可以从 excel 中收集这些数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T01:24:53.357

这是它的代码：

如果您有任何问题（或者如果我犯了任何错误），请务必查看评论并在此处回复

```
import csv

file  = open('names.csv', "rb") #Open CSV File in Read Mode
reader = csv.reader(file)      #Create reader object which iterates over lines

class Object:                   #Object to store unique data
    def __init__(self, name, produce, amount):
        self.name = name
        self.produce = produce
        self.amount = amount

rownum = 0 #Row Number currently iterating over
list = []  #List to store objects

def checkList(name, produce, amount):

    for object in list:  #Iterate through list        
        if object.name == name and object.produce == produce:  #Check if name and produce combination exists
            object.amount += int(amount) #If it does add to amount variable and break out
            return

    newObject = Object(name, produce, int(amount)) #Create a new object with new name, produce, and amount
    list.append(newObject)  #Add to list and break out

for row in reader:  #Iterate through all the rows
    if rownum == 0:  #Store header row seperately to not get confused
        header = row
    else:
        name = row[0]  #Store name
        produce = row[1]  #Store produce
        amount = row[2]  #Store amount

        if len(list) == 0:  #Default case if list = 0
            newObject = Object(name, produce, int(amount))
            list.append(newObject)
        else:  #If not...
            checkList(name, produce, amount)

rownum += 1

for each in list: #Print out result
    print each.name, each.produce, each.amount

file.close() #Close file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:55:59.510

打开 Excel 文件后应该非常简单。如果保存为 .csv 文件，请使用以下文档：[http ://docs.python.org/library/csv.html](http://docs.python.org/library/csv.html)

然后使用此链接遍历记录并获取每个名称和类型的总和：[http ://www.linuxjournal.com/content/handling-csv-files-python](http://www.linuxjournal.com/content/handling-csv-files-python)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T21:50:50.933

[1) 使用http://pypi.python.org/pypi/xlrd](http://pypi.python.org/pypi/xlrd)读取 Excel 文件

2）遍历记录，并使用字典中的复合键（名称，生产）（[自定义类型的对象作为字典键](https://stackoverflow.com/questions/4901815/object-as-a-dictionary-key)）来累加总和

# ssrs-2008 - 以编程方式显示报表生成器 3.0 中另一个报表的链接？

> ID：11005342
> 
> 赞同：1
> 
> 时间：2012-06-12T21:45:03.033
> 
> 标签：ssrs-2008, reporting-services, reportbuilder

我的报告中有一个分组，我想用它来链接到另一个报告。我的困境是，我只希望当单元格中的值满足特定条件（例如，数字 > x）时链接是可点击的。如果条件不成立，那么我不希望单元格可点击。有没有办法做到这一点？

编辑：我尝试将`IIF`语句设置为 url 的一部分，但我在语句的“错误部分”中链接到什么？使用`""`实际上只是刷新报告，这也不是我真正想要的。当我尝试`about:blank`说 url 必须以`http://`etc开头时，它也会抱怨。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:01:30.897

动作不是动态的，因此无法根据条件打开和关闭它。但是您用来打开另一个报表的表达式可以使用表达式 - 无论您是使用跳转到报表还是跳转到 URL 操作。您可能会考虑的一件事是，当您不想跳转到另一个报告时，条件是跳转到同一个报告。也就是说，假设您在报告 A 中，并且您只想在 number > x 时跳转到报告 B。然后你使用表达式：

```
=iif(number > x, "Report B", "Report A") 
```

报告 A 将被缓存，因此最终效果是您没有单击，即使用户可以看到光标变为手并且实际上可以执行单击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-19T04:19:47.643

在 iif 表达式中使用 Nothing 关键字作为 false 部分。如果没有为 Action 指定任何链接，则不会创建任何链接。

```
=iif(YOUR_CONDITION, "Other Report", Nothing) 
```

# javascript - 在 Javascript 中强制 dom 重新加载/调整大小

> ID：11005346
> 
> 赞同：1
> 
> 时间：2012-06-12T21:45:25.350
> 
> 标签：javascript, jquery, css, dom, webkit

我的应用程序中有一个侧边栏，可以通过切换按钮隐藏/显示。它只是在“body”上切换一个类，为内容区域添加一些边距并隐藏/显示侧边栏。问题是内容区域在切换时没有调整其子内容的大小。一旦我调整浏览器的大小，内容区域就会调整以适应内容，但我需要它在切换后执行此操作，而无需调整窗口大小。有没有办法触发元素大小刷新或 dom 刷新来解决这个问题？使用 Chrome 19.x。

```
 $('#sidebar-toggle').click(function(event) {
   event.preventDefault();
   $('body').toggleClass('with-sidebar-left');
 }); 
```

**编辑：**似乎它可能是一个 Webkit 问题。在 Firefox 中运行良好。

**编辑 2：**在以下位置设置简化版本：

[https://dl.dropbox.com/u/189605/misc/build-test/grid.html](https://dl.dropbox.com/u/189605/misc/build-test/grid.html)

您可以看到这些框是浮动的：左侧，当您使用小箭头按钮最小化侧边栏时，它应该调整右侧，以便更多框适合。在 Webkit 中，您必须调整浏览器的大小才能实现它有更多的空间。在火狐中工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T21:48:42.307

您可以在点击处理程序中触发调整大小，例如：

```
$(window).trigger('resize') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T00:23:13.667

[我在这里回答](https://stackoverflow.com/questions/8927478/jquery-css-rendering-works-in-firefox-not-in-chrome/8928389#8928389)的解决方法适用于您的情况。

这是一个快速演示：http: [//jsbin.com/amakex](http://jsbin.com/amakex)

它适用于 Chrome 和 Safari（不出所料，您的原始演示也不适用于 Safari）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T22:02:48.103

你说 - “但我需要它在切换后执行此操作而无需调整窗口大小”。您可以使用 jquery 回调来做到这一点

# c# - 使用 ItemsControl 类将对象添加到工具箱

> ID：11005350
> 
> 赞同：0
> 
> 时间：2012-06-12T21:45:42.760
> 
> 标签：c#, .net, wpf

我使用两个类作为从 ItemsControl 派生的 Toolbox 和从 ContnentControl 派生的 ToolboxItem

```
// Implements ItemsControl for ToolboxItems    
public class Toolbox : ItemsControl
{

    // Defines the ItemHeight and ItemWidth properties of
    // the WrapPanel used for this Toolbox
    public Size ItemSize
    {
        get { return itemSize; }
        set { itemSize = value; }
    }

    private Size itemSize = new Size(50, 50);

    // Creates or identifies the element that is used to display the given item.        
    protected override DependencyObject GetContainerForItemOverride()
    {
        return new ToolboxItem();
    }

    // Determines if the specified item is (or is eligible to be) its own container.        
    protected override bool IsItemItsOwnContainerOverride(object item)
    {
        return (item is ToolboxItem);
    }
}

// Represents a selectable item in the Toolbox/>.
public class ToolboxItem : ContentControl
{
    // caches the start point of the drag operation
    private Point? dragStartPoint = null;

    static ToolboxItem()
    {
        // set the key to reference the style for this control
        FrameworkElement.DefaultStyleKeyProperty.OverrideMetadata(
            typeof(ToolboxItem), new FrameworkPropertyMetadata(typeof(ToolboxItem)));
    }

    protected override void OnPreviewMouseDown(MouseButtonEventArgs e)
    {
        base.OnPreviewMouseDown(e);
        this.dragStartPoint = new Point?(e.GetPosition(this));
    }

    protected override void OnMouseMove(MouseEventArgs e)
    {

        base.OnMouseMove(e);
        if (e.LeftButton != MouseButtonState.Pressed)
            this.dragStartPoint = null;

        if (this.dragStartPoint.HasValue)
        {
            // XamlWriter.Save() has limitations in exactly what is serialized,
            // see SDK documentation; short term solution only;
            string xamlString = XamlWriter.Save(this.Content);
            DragObject dataObject = new DragObject();
            dataObject.Xaml = xamlString;

            WrapPanel panel = VisualTreeHelper.GetParent(this) as WrapPanel;
            if (panel != null)
            {
                // desired size for DesignerCanvas is the stretched Toolbox item size
                double scale = 1.3;
                dataObject.DesiredSize = new Size(panel.ItemWidth * scale, panel.ItemHeight * scale);
            }

            DragDrop.DoDragDrop(this, dataObject, DragDropEffects.Copy);

            e.Handled = true;
        }
    }
}

// Wraps info of the dragged object into a class
public class DragObject
{
    // Xaml string that represents the serialized content
    public String Xaml { get; set; }

    // Defines width and height of the DesignerItem
    // when this DragObject is dropped on the DesignerCanvas
    public Size? DesiredSize { get; set; }
}

public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {

        DesignerItem ni = new DesignerItem();
        ni.AllowDrop = true;
        ni.ToolTip = "tooltip goes here";
        ni.Width = 100;
        ni.Height = 200;
        ni.Background = Brushes.Red;

        //somehow code should introduce the object shape as object. in the sample on codeproject it is reading shape information from xaml but I need to add it from code behind. 

        Toolbox tb = new Toolbox();
        tb.Items.Add(ni); 
```

ItemsControl 中的 AddChild() 方法必须是在工具箱上添加新对象的方法。但是，当我从这个类实例化一个对象时，它并没有给我这个方法。为简单起见，我只想在其上添加一个矩形，这将允许我将其拖放到画布上。所以问题是我如何在工具箱上添加一个矩形。

任何帮助表示赞赏。

谢谢。阿米特

解决方案：

```
var TheToolbar = ToolboxContainer.Content as Toolbox;

// Instantiate a ToolboxItem
ToolboxItem TheToolboxItem = new ToolboxItem();

Rectangle myRect = new Rectangle();
myRect.StrokeThickness = 1;
myRect.Stroke = some value for stroke;
myRect.Fill = some value for filling the object;
myRect.IsHitTestVisible = false;
//add to Toolbar
TheToolboxItem.Content= myRect;
TheToolbar.Items.Add(TheToolboxItem); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:18:55.723

AddChild() 是一个受保护的方法（= 只能从自身或继承的类访问）。尝试使用这样的代码：

```
Toolbox tb = new Toolbox();
tb.Items.Add(myNewItem); 
```

实例化对象后，您需要将它们作为子元素添加到画布/父元素中。

```
myParentElement.Children.Add(tb); 
```

如果您正在这样做，请将其包含在您的示例代码中。

# php - 将 foreach 循环结果作为关键 php

> ID：11005354
> 
> 赞同：3
> 
> 时间：2012-06-12T21:46:00.060
> 
> 标签：php, arrays

我试图弄清楚是否可以在数组中循环一个 foreach 循环，循环结果应该作为新数组的键，像这样，

```
$names = array('joe', 'piter', 'jack');
$dates = array('06/22/1987', '05/25/1988', '08/26/1990');
$arr = array();
foreach($names as $v){
     $arr[] = $v;
}
$arr2 = array($arr => $dates);
print_r($arr2); 
```

我怎么做？

伙计们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T21:48:16.940

不需要 foreach 循环来实现这一点。只需使用[array_combine](http://php.net/array-combine)：

```
$names = array('joe', 'piter', 'jack');
$dates = array('06/22/1987', '05/25/1988', '08/26/1990');
$arr2 = array_combine($names, $dates); 
```

`print_r($arr2)`输出：

```
大批
(
    [乔] => 1987 年 6 月 22 日
    [piter] => 1988 年 5 月 25 日
    [杰克] => 1990 年 8 月 26 日
)

```

在这种情况下，您不需要这样做，但如果您想知道如何在循环中`$v`用作键，`$arr2`您可以在循环中进行分配：

```
$arr2[$v] = ...; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:52:23.163

好吧，在我输入这个之后看到@ascii-lime的答案（这要好得多），但我猜只是作为替代......

```
$names = array('joe', 'piter', 'jack');
$dates = array('06/22/1987', '05/25/1988', '08/26/1990');
$arr = array();
$i=0;
foreach($names as $v){
    $arr[$v] = $dates[$i];
    ++$i;
}
print_r($arr); 
```

# xpath - 如何使用 jMeter 提取 wddx 数据包中的信息？

> ID：11005356
> 
> 赞同：0
> 
> 时间：2012-06-12T21:46:24.243
> 
> 标签：xpath, jmeter, wddx

我是使用 XPath 和 JMeter 的新手。我有一个包含 wddx 数据包的 XML 文件。以下是一个示例文件。实际数据一次最多可包含 100 条记录。

```
<wddxPacket version='1'>
    <header/>
    <data>
        <recordset rowCount='2' fieldNames='FIELD1, FIELD2' type='coldfusion.sql.QueryTable'>
            <field name='FIELD1'>
                <string>MyValue1</string>
                <string>MyValue2</string>
            </field>
            <field name='FIELD2'>
                <string>MyValue3</string>
                <string>MyValue4</string>
            </field>
        </recordset>
    </data>
</wddxPacket> 
```

我需要做的是根据`recordset`标记中指定的行数循环遍历 XML 文件，然后提取 、 等中的字符串值`FIELD1`，`FIELD2`并在其他一些 WebService (SOAP) 采样器中使用它们。为了确保可以提取值，我使用了 JMeter 函数 XPath。XPath 调用如下（我正在尝试获取`MyValue1`），

```
${__XPath(c:\test.xml, /wddxPacket/data/recordset/field[@name='FIELD1']/string)} 
```

只是为了确保文件读取部分正确，我使用该`FileToString()`函数并将内容分配给一个变量。根据我在调试采样器中的功能，该变量确实显示了正确的内容。但是，使用上述对 XPath 的函数调用并将结果分配给一个变量，该变量是空白的。这是我的问题，就提取 XML 文件中的值而言，我是否走错了路？如果是这样，我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T01:42:24.710

我不知道 JMeter，但是这个 XPath

```
/wddxPacket/data/recordset/field[@name='FIELD1']/string 
```

不返回字符串值，它返回包含两个节点的节点集

```
<string>MyValue1</string> 
<string>MyValue2</string> 
```

如果你只想要第一个节点，你可以使用这个 XPath：

```
/wddxPacket/data/recordset/field[@name='FIELD1']/string[1] 
```

如果你只想要第一个字符串值，你可以试试这个 XPath：

```
string(/wddxPacket/data/recordset/field[@name='FIELD1']/string) 
```

最后但同样重要的是：您确定您的 XML 文件不使用任何命名空间吗？因为如果确实如此，您需要在 XPaths 中明确指定它们。

# php - 使用 PHP 上传由 URL 生成的文件

> ID：11005359
> 
> 赞同：0
> 
> 时间：2012-06-12T21:46:42.533
> 
> 标签：php, url, upload

所以，我有一个使用 Kaywa 生成和显示二维码的 PHP 代码：

```
 echo "<img src='http://qrcode.kaywa.com/img.php?s=10&d=$qr_url' alt='QR code' />"; 
```

十分简单。但为了备份，我想将此图像保存到我的服务器，可能在“myserver/qrbackups”中。我知道如何让 PHP 从表单中上传文件，但我可以从检索到的图像 URL 中进行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:52:50.277

请参阅[file_get_contents](http://php.net/file_get_contents)。

```
$data = file_get_contents("http://qrcode.kaywa.com/img.php?s=10&d=$qr_url");
$saved = file_put_contents('/path/to/myserver/qrbackups/the-code.png', $data); 
```

请记住`/path/to/myserver/qrbackups/the-code.png`，每个 QR 码应该是唯一的文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:52:35.437

您可以使用 cURL 以编程方式访问 URL。

[http://us3.php.net/manual/en/curl.examples-basic.php](http://us3.php.net/manual/en/curl.examples-basic.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T21:53:39.497

您可以尝试使用 curl 或 file_get_contents 从服务器中提取文件。

例如： [http ://www.phpriot.com/articles/download-with-curl-and-php](http://www.phpriot.com/articles/download-with-curl-and-php)

获取文件后，只需显示您从服务器或远程获取的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T21:55:04.737

```
copy('http://domain.com/path', '/tmp/file.jpeg'); 
```

应该为你工作。而且，正如其他人指出的那样，cURL 也可以。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T23:37:37.700

如果你的服务器上有 GD 扩展，你可以使用[PHP QR Code](http://phpqrcode.sourceforge.net/)之类的库来消除对 Kaywa 的依赖。无论您想生成二维码，使用都只需要一行代码。

# java - URL.openStream 很慢

> ID：11005360
> 
> 赞同：2
> 
> 时间：2012-06-12T21:46:49.470
> 
> 标签：java, android, url, upload, inputstream

我正在从 SQL 数据库下载安卓设备上的图片；一切正常，除了打开 Stream 需要很长时间（即使没有图片可下载）。在实际下载开始之前大约需要 5 秒。这是我的代码片段：

```
URL url = new URL(sUrl[0]);
URLConnection connection = url.openConnection();
connection.connect();

int fileLength = connection.getContentLength();

//input = connection.getInputStream();
InputStream input = new BufferedInputStream(url.openStream());

File file = new File(
        Environment
                .getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES),
        "MyCameraApp" + "/testpic.jpg");
OutputStream output = new FileOutputStream(file);
byte data[] = new byte[1024];

//---blabla progressbar update etc.. 
```

这条线`InputStream input = new BufferedInputStream(url.openStream());`给出了问题。关于如何加快速度的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T22:00:41.050

这就是创建实际 TCP 连接的地方。这是网络问题，不是编码问题。您无法在代码中执行任何操作来修复它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T22:02:25.297

我使用此代码从 url 获取位图。:)

```
Bitmap bitmap = null;
    URL imageUrl = new URL(url);
    HttpURLConnection conn = (HttpURLConnection)imageUrl.openConnection();
    conn.setConnectTimeout(30000);
    conn.setReadTimeout(30000);
    InputStream is = conn.getInputStream();
    OutputStream os = new FileOutputStream(f);

try
{
   byte[] bytes=new byte[1024];
   for(;;)
   {
      int count=is.read(bytes, 0, 1024);
      if(count==-1)
         break;
      os.write(bytes, 0, count);
    }
 }
 catch(Exception ex){}
os.close();
bitmap = decodeFile(f); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-02T10:38:31.883

您`url.openStream()`在创建 时调用`InputStream`，但在此之前您正在创建新连接并调用`connection.connect()`。

**来自android JavaDoc：** `openStream()`是“等效于`openConnection().getInputStream(types)`”

[http://developer.android.com/reference/java/net/URL.html#openStream](http://developer.android.com/reference/java/net/URL.html#openStream) ()

总之，我认为您应该`connection.getInputStream()`在初始化`InputStream`.

# java - Java：从没有 ImageReader 的动画 GIF 中获取帧

> ID：11005362
> 
> 赞同：0
> 
> 时间：2012-06-12T21:46:55.123
> 
> 标签：java, decode, animated-gif

我正在开发 AppEngine 应用程序。它的功能之一是将动画 .gif 图像分割成单独的帧。我进行了很多搜索以找到如何做到这一点的方法，最后找到了解决方案。不幸的是，该解决方案基于`ImageReader`，我无法在服务器上使用它，因为：

> Google App Engine 的 Java 运行时环境不支持 javax.imageio.ImageReader

没有这个类，还有其他方法可以解码 GIF 图像吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-20T19:00:48.990

首先是关于框架本身的一些事情。将动画 .gif 图像拆分为单独的帧有两个含义。1) 从字面上看，帧是动画 GIF 意义上的帧。问题是构成动画 GIF 图像的帧是相关的。动画 GIF 的处理方法决定了在绘制当前帧时如何处理前一帧。你可以覆盖它；在绘制新框架之前填充背景颜色，或者您可以在绘制新框架之前执行任何您认为合适的操作。如果您认为上述情况很复杂，那么框架的透明度呢？绘制每一帧的逻辑位置？

如果我们沿着这条路走，就不需要使用专用的ImageReader，只需读取图像的相关部分并复制每一帧数据，将其与标题和调色板一起保存。结果是：生成的图像可能看起来很奇怪且毫无意义。看下面的例子：

第一帧![框架0](../Images/75405b6051b1b7419d00963a44bf801e.png)

第二帧![框架1](../Images/c819146378b332f8569e608ae7b15cc5.png)

和原来的![原来的](../Images/1c511a3d6ae1fc380e8fb6b000250a0e.png)

你可以看到第二帧看起来不太好。事实是，第二帧是建立在第一帧之上的透明帧（此动画 GIF 仅包含 2 帧）。您应该看透第二帧，并且它们会制作动画。

现在让我们看看将动画 .gif 图像分割成单独的帧的第二个含义。2）在这种情况下，帧实际上是一个合成的，它建立在前面的帧上，这就是我们在查看动画 GIF 时看到的。为了实现这一点，我们必须考虑到帧循环的历史、每个帧的逻辑位置以及帧本身的透明度。

让我们看看我们现在得到了什么：

第一帧 ![框架0](../Images/0c24e4e4a4b0621a076717c1d43a2a33.png)

第二帧![框架1](../Images/4a0384fa7c01411dcd1d608667757574.png)

现在第一帧与第一种情况相同，但第二帧构建在第一帧之上，不再透明。

在第二种情况下，我们必须对帧进行解码和编码才能达到预期的效果。除了看起来不错，另一个好处是您可以将生成的图像保存为编码器支持的任何格式。

[本文中的示例由iCafe](https://github.com/dragon66/icafe)的 GIF 相关部分生成

# facebook - 将 Facebook 应用程序添加到 Facebook 页面

> ID：11005366
> 
> 赞同：1
> 
> 时间：2012-06-12T21:47:02.073
> 
> 标签：facebook

所有，我在developers.facebook.com 中创建了一个facebook 应用程序。然后在它如何与 Facebook 集成的基本页面上，我选择页面选项卡。我提供了这些信息，因为我正在托管该页面，现在我想在我的 Facebook 页面上显示它。

如何在我的 Facebook 页面上实际显示此应用程序？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T09:46:25.243

添加作为将来参考的答案：

检查[http://developers.facebook.com/docs/appsonfacebook/pagetabs](http://developers.facebook.com/docs/appsonfacebook/pagetabs)并确保您已添加“添加页面选项卡”对话框工作所需的所有字段；如果您包含的`redirect_uri`字段的 URL 不是页面选项卡 URL 或站点 URL 中的 URL，则对话框很可能会失败并显示错误 191

# perl - perl 结合 map 和 each

> ID：11005367
> 
> 赞同：2
> 
> 时间：2012-06-12T21:47:04.617
> 
> 标签：perl

我只是想知道这是否可能：

```
use Modern::Perl;

my @list = ('a' .. 'j');

map { func($_) } each(@list);

sub func {
  my ($index, $value) = @_;
  say "$index => $value";
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T22:04:01.847

不，你不能，因为`each`每次调用它都会返回一个键/值对。您只调用它一次，因此它将传递`(0, $list[0])`给`map`，并且将为每个值调用一次子例程。

如果你想`func`用每个键/值对调用你可以写

```
map { func($_, $list[$_]) } keys @list; 
```

但这是滥用`map`，因为它旨在将一个列表映射到另一个列表。你应该`for`像这样使用

```
func($_, $list[$_]) for keys @list; 
```

你也可以`each`这样使用

```
my ($i, $v);
func($i, $v) while ($i, $v) = each @list; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T02:09:31.070

最直接的方法是：

```
func($_, $a[$_]) for 0..$#a; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T22:08:56.860

在列表上下文中，`each @array`返回一个包含两个元素的列表——一个数组索引和该索引处的数组元素的值。打电话

```
map { ... } each @array 
```

因此就像

```
($index,$value) = each @array;
map { ... } ($index,$value); 
```

这可能不是你想要的。如果`func`应该采用索引参数和值参数，那么也许你想做类似的事情

```
map { func($_, $list[$_]) } 0 .. $#list; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T21:54:00.127

只需使用`for`：

```
for ( my $index = 0; $index < scalar @list; $index++ ){
   my $value = $list[$index];
   say "$index => $value";
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T22:03:18.883

您将`map`其视为循环，丢弃返回值。在这种情况下，您不妨使用循环。但是，您不能将`each @list`其用作这样的循环条件，因为它不会扩展为完整列表。来自`perldoc -f each`：

> 在列表上下文中调用时，返回一个 2 元素列表，其中包含哈希的下一个元素的键和值，或者数组的下一个元素的索引和值，以便您可以对其进行迭代。

此外，您只向子例程传递了一个值，而不是两者。您的`each`语句扩展为两个元素的列表，即数组的下一个索引和元素。但`map`每次迭代只需要其中一个。所以你得到输出：

```
Use of uninitialized value $value in concatenation...
0 =>
Use of uninitialized value $value in concatenation...
a => 
```

你可能想要的是这样的：

```
func($_) for keys @list;

sub func {
    my $index = shift;
    say "$index => $list[$index]";
} 
```

`keys`可以以这种方式用于获取数组的索引。

# iphone - 刷新参考ManagedObjectContext

> ID：11005369
> 
> 赞同：4
> 
> 时间：2012-06-12T21:47:24.780
> 
> 标签：iphone, ios, nsmanagedobjectcontext

在我的 iOS 应用程序中，我有一个核心数据，我注意到有时，在特定视图中，当我从核心数据中检索信息时，并不总是最新的，我解释得很好：

如果我更新核心数据中的某些值，然后进入特定视图以查看此信息，则该信息不是最新的，现在我将展示我如何访问我的数据库：

。H

```
@property (nonatomic, retain) NSManagedObjectContext *managedObjectContext; 
```

.m

```
@synthesize managedObjectContext;

- (NSArray *)sortInformation{

if (managedObjectContext == nil) {

    managedObjectContext = [(AppDelegate *) [[UIApplication sharedApplication] delegate] managedObjectContext];

}

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription 
                               entityForName:@"MyEntity" inManagedObjectContext:managedObjectContext];
[fetchRequest setEntity:entity];

.... 
```

然后我在表格视图中显示我的信息，一切正常，只有这个问题，有时我在另一个视图中所做的更新似乎没有在这个视图中读取，但是如果我关闭应用程序，我从后台关闭它，然后我重新打开它一切正常......所以我已经正确地将更新保存在核心数据中，所以我认为问题出在这个视图中，也许我有核心数据的旧参考和不是更新版本，可能问题是这样的：

```
if (managedObjectContext == nil) {

    managedObjectContext = [(AppDelegate *) [[UIApplication sharedApplication] delegate] managedObjectContext];

} 
```

仅当变量 managedObjectContext 为 nil 时才刷新，因此仅当视图被解除分配时……所以永远不会，因为它是我在 UITabbarController 中的根视图控制器之一，所以我的问题是，我如何才能始终访问核心数据它的更新版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T05:43:01.050

无需刷新上下文，只需在 managedObjectContext 上调用 save 方法，`[managedObjectContext save];` 或者如果您使用多个托管对象上下文，您应该合并上下文所做的更改

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:24:03.257

在数据库类的实现上，你可以这样做

```
-(id) initWithContext: (NSManagedObjectContext *)managedObjContext {
    self = [super init];
    [self setManagedObjectContext:managedObjContext];
    return self;    
} 
```

managedObjContext 是通过并设置的

在调用数据库类时，在您的应用程序委托上，它应该是这样的

```
database = [[Database alloc] initWithContext:self.managedObjectContext]; 
```

然后你就可以像这样访问数据库了

```
- (NSArray *)sortInformation {
           NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
           NSEntityDescription *entity = [NSEntityDescription entityForName:@"MyEntity" inManagedObjectContext:managedObjectContext];
[fetchRequest setEntity:entity];

           NSMutableArray *mutableFetchResults = [[[managedObjectContext_ executeFetchRequest:request error:&error] mutableCopy] autorelease];
           [request release];
           return mutableFetchResults;
} 
```

# jquery - 在函数调用之间链接 ajax 延迟

> ID：11005372
> 
> 赞同：0
> 
> 时间：2012-06-12T21:47:53.743
> 
> 标签：jquery, jquery-deferred

我在使用 jQuery Deferred 时遇到了一些麻烦。

我在函数包装器中使用 jQuery ajax 调用，并且尝试按照范围顺序依次链接两个成功回调。但是，两个成功回调同时执行，这会导致问题。

我的初始函数调用如下所示（system.log 是更智能的 console.log。）：

```
serverpaths.setConfig(path).then(system.log("BAM! SERVERPATHS: " + serverpaths)); 
```

在这个 setConfig 方法中，我有一个 AJAX 调用，其中链接了一个 .then() 。（system.defer 是一个包装器，它返回一个 jQuery.Deferred 对象；http.get 是一个 jQuery.ajax 的包装器。）

```
config.setConfig = function (configObj) {
    var that = this;
    var inlineHelper = function (data) {
        return system.defer(function (dfd) {
            for (var key in data) {
                system.log("Config[" + key + "]: " + that[key]);
                system.log("Data[" + key + "]: " + data[key]);
                that[key] = data[key];
                system.log("New Config[" + key + "]: " + that[key]);
            }
        }).promise();
    };

    if (typeof configObj === "string") {
        http.get("api/getPathConfig")             // The problem seems to be in this area
            .then(function (data) {
                return system.defer(function () {
                    inlineHelper(data);
                }).promise();
            });
    } else {
        return system.defer(function () {
            inlineHelper(configObj);
        }).promise();
    }
}; 
```

理想情况下，应该调用 ajax 请求，然后调用 inlinehelper，然后调用 system.log，因为我正在使用 return 语句将我的 promise 对象踢回链。这里的问题是调用ajax请求，然后同时调用system.log和inlinehelper。

有没有人遇到过这样的问题？函数作用域和异步调用似乎在这里互相争斗。我确定我可以解决这个问题，但这似乎不太合乎逻辑 - 我的猜测是，当我的 ajax 请求触发成功时，它会在我的主范围内触发 .then() 调用，而我并不想要它。我确信我可以解决这个问题，但它有助于拥有一个伟大的开发者社区来反弹想法。

我感谢你的所有建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T11:52:59.930

只做`.then(function() { return promise })`无济于事。您返回的承诺不会传播到下一个延迟回调。

如果您想这样做，请使用`.pipe()`而不是`.then()`. 这样，您将能够链接承诺。

如果要链接 3 个异步调用，请执行以下操作：

```
firstDeferredCall.pipe(secondDeferredCall).pipe(thirdDeferredCall) 
```

如果你写

```
firstDeferredCall.then(secondDeferredCall).then(thirdDeferredCall) 
```

`thirdDeferredCall`不会等待`secondDeferredCall`调用被执行。

**编辑：**正如 tim 所说，[自 jQuery 1.8 以来](http://api.jquery.com/category/deprecated/deprecated-1.8/)`.pipe`已弃用。

如果您使用的是 jQuery 1.8+，则可以使用`.then`which now 替换`.pipe`. [请参阅 .then 的文档](http://api.jquery.com/deferred.then/)。在这种情况下，您的代码应该是好的，无需任何修改。

# jpa - JPA/EclipseLink：EntityManager.getTransaction() 是创建新事务还是返回活动事务？

> ID：11005373
> 
> 赞同：13
> 
> 时间：2012-06-12T21:48:05.147
> 
> 标签：jpa, transactions, eclipselink

我正在使用 EclipseLink 2.3.0。我有一个从单元测试中调用的方法（因此在容器之外，没有 JTA），如下所示：

```
EntityManager em = /* get an entity manager */;
em.getTransaction().begin();
// make some changes
em.getTransaction().commit(); 
```

这些更改没有被持久化到数据库中，并且看了很长时间，最终意识到 EntityManager.getTransaction() 实际上返回了一个 NEW EntityTransaction，而不是两个调用中的同一个。效果是第一个调用创建一个新事务并开始它，第二个调用创建另一个事务并提交它。因为从未提交过第一个事务，所以不会保存更改。我们这样验证：

```
log.info(em.getTransaction().toString());
log.info(em.getTransaction().toString()); 
```

这导致了这些日志消息：

```
INFO: org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl@1e34f445
INFO: org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl@706a4d1a 
```

两个不同的对象 ID 验证存在两个不同的实例。将代码更改为：

```
EntityManager em = /* get an entity manager */;
EntityTransaction tx = em.getTransaction();
tx.begin();
// make some changes
tx.commit(); 
```

...解决了这个问题。现在，当我运行代码时，我看到为执行数据库工作而生成的 SQL 语句，并且查看数据库，数据已更改。

我对这个结果有点惊讶，因为我在网上看到了很多代码示例（一般针对 JPA，特别针对 EclipseLink），这些示例推荐了我们用于管理事务的代码。我专门搜索了有关此的信息，但没有找到任何信息。发生什么了？

我在 JPA 规范中查找了确切指定 getTransaction() 功能的内容，并且没有具体说明事务是新的还是相同的。persistence.xml 中是否有控制此设置的设置？行为是否特定于 JPA 规范的每个实现？

非常感谢您提供任何信息或指导。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T13:55:06.970

在 JPA 和 EclipseLink 中使用 getTransaction() 确实有效（这是我们自己的测试的工作方式）。

我的猜测是你正在做一些非常奇怪的事情。

您使用的是 Spring 还是其他层？请为您的测试包括整个代码和 persistence.xml。确保您没有在 persistence.xml 中使用 JTA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:58:23.610

The JPA spec (see paragraph 7.5.4) has explicit examples showing the use of `getTransaction()` to begin and commit the transaction. So your code should be fine.

Your test shows that you get two different objects, but that doesn't mean the same transaction is not used. Maybe the returned object is just some proxy to a single, real, transaction object.

Or maybe the transaction is committed or rollbacked inside the code hidden under `// make some changes`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-04T07:06:37.407

你有没有试过[在提交之前使用持久化：](http://www.objectdb.com/java/jpa/persistence/store)？

```
 Employee employee = new Employee("Samuel", "Joseph", "Wurzelbacher");
  em.getTransaction().begin();
  em.persist(employee);
  em.getTransaction().commit(); 
```

# ios - 避免在进入编辑模式时自动调整 uitableview 单元格内容视图的大小

> ID：11005380
> 
> 赞同：4
> 
> 时间：2012-06-12T21:48:40.030
> 
> 标签：ios, uitableview

我有一个包含一些自定义视图的内容视图的 uitableviewcell。当表格视图进入编辑模式时，内容视图会调整大小（变窄），内容视图中的图像会水平缩小

有谁知道如何防止这种情况？

我已将单元格缩进设置为无。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:05:19.070

您是否尝试过设置`shouldIndentWhileEditing`为`NO`

看看属性：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:03:02.643

您是否尝试过在视图上设置自动调整大小的蒙版？

```
theView.autoresizingMask = UIViewAutoresizingNone; 
```

您可能需要在内容视图和/或图像视图上设置它 - 尚不清楚您的视图层次结构的确切结构。但是，框架可能由框架显式设置（而不是自动调整大小），在这种情况下，这将不起作用。

如果您尝试为整个表格单元格设置背景图像，您可能还想尝试另一种方法，即`backgroundColor`像这样设置单元格的：

```
UIImage* someImage = [UIImage imageNamed:@"someImage"];
cell.backgroundColor = [UIColor colorWithPatternImage:someImage]; 
```

请记住确保`backgroundColor`您放置在其中的所有其他视图都`[UIColor clearColor]`可以看到背景图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-09T10:02:58.647

我做了类似的事情来避免在使用单元格自动尺寸时调整单元格内容的大小。

我的问题是单元格内的 textView 在选择之后将其内容包装在更多行中，我只是想避免这种情况。

要解决这个“问题”：

*   我在单元格内容中添加了 40px（附件视图的大小）的尾随约束
*   在单元格选择中，我将约束更改为 0，因此文本大 40 px，但是当附件显示时，您看不到任何更改。

这个解决方案的优点是当用户选择一行时内容维度不再改变。缺点是单元格右侧始终有 40px 的可用空间，即使未选中也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-26T15:00:59.333

你总是可以得到一个带有 indexpath 的 tableviewcell。使用该 tableviewcell 重用标识符，您可以避免调整或不调整 tableview 单元格内容大小。我需要实现类似的功能以避免调整单独单元格的大小。PFB 代码。

```
-(BOOL)tableView:(UITableView *)tableView shouldIndentWhileEditingRowAtIndexPath:(NSIndexPath *)indexPath{

BOOL shouldIndentWhileEditingRow = NO;

UITableViewCell *lTableViewCell = [tableView cellForRowAtIndexPath:indexPath];

/*Change the position of the target rect based on Sending messages or Receiving messages*/
if ([lTableViewCell.reuseIdentifier isEqualToString:@"SendingChatCellIdentifier"]) {

    shouldIndentWhileEditingRow = NO;

}else if ([lTableViewCell.reuseIdentifier isEqualToString:@"ReceivingChatCellIdentifier"]){

    shouldIndentWhileEditingRow = YES;
}

return shouldIndentWhileEditingRow;
} 
```

# php - Wordpress - 在“wp 获取附件图像”中包含页面标题

> ID：11005387
> 
> 赞同：2
> 
> 时间：2012-06-12T21:49:31.323
> 
> 标签：php, wordpress

好的，我已经设置了一些代码来搜索作为 ID 8 的子页面的所有页面，然后将这些页面的所有附件（在库中）输出为无序列表项。你可以在这里看到到目前为止的效果[http://goo.gl/eq4UF](http://goo.gl/eq4UF)。

我遇到的问题是我需要在每个页面之前包含每个页面的标题，以便您可以轻松识别哪些图像位于哪个页面下方。通常我只会添加它，但列表项使用砖石结构并使用一些 JS 定位在整个页面上，因此它们永远不会出现在列表中的第一个图像旁边。

因此，我会将页面的标题添加到其中的每个 标题`<li>`中，`<ul>`这将允许标题与每个图像一起运行，但我不知道如何将其包含在 wp 获取附件图像功能中。两者都在这个循环`the_title`中`wp_title`不起作用。`apply_filters( 'the_title', $attachment->post_title );`明明是取图片标题，但是取页面标题有什么好处吗？

在此先感谢，希望这是有道理的，R

```
<?php $postslist = get_pages('number=9999&sort_order=DESC&sort_column=post_date&child_of=8');
foreach ($postslist as $post) :
setup_postdata($post); ?>
<ul class="main-projects-list">
<?php

$args = array(
   'post_type' => 'attachment',
   'numberposts' => -1,
   'post_status' => null,
   'post_parent' => $post->ID,
   'orderby' => 'menu_order',
   'order' => 'ASC',
  );

  $attachments = get_posts( $args );
     if ( $attachments ) {
        foreach ( $attachments as $attachment ) {
           echo '<li class="each-image">';
           echo wp_get_attachment_image( $attachment->ID, 'large' );
           echo '<p>';
           echo apply_filters( 'the_title', $attachment->post_title );
           echo '</p></li>';
          }
     }

?>
</ul>
<?php endforeach; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:01:17.493

你可以试试这个：

```
<?php $postslist = get_pages('number=9999&sort_order=DESC&sort_column=post_date&child_of=8');
foreach ($postslist as $post) :
setup_postdata($post); ?>
<ul class="main-projects-list">
<?php

$args = array(
   'post_type' => 'attachment',
   'numberposts' => -1,
   'post_status' => null,
   'post_parent' => $post->ID,
   'orderby' => 'menu_order',
   'order' => 'ASC',
  );

  $attachments = get_posts( $args );
     if ( $attachments ) {
        $post_title = get_the_title($post->ID); // We get the post title
        foreach ( $attachments as $attachment ) {
           $img_title = apply_filters( 'the_title', $post_title . ' - ' . $attachment->post_title ); // We create the image title with the 2 strings
           echo '<li class="each-image">';
           echo wp_get_attachment_image( $attachment->ID, 'large' , false, array('title' => $img_title));
           echo '<p>';
           echo $img_title;
           echo '</p></li>';
          }
     }

?>
</ul>
<?php endforeach; ?> 
```

# c - “热”和“内联”组合对函数定义的性能影响

> ID：11005390
> 
> 赞同：6
> 
> 时间：2012-06-12T21:49:38.190
> 
> 标签：c, linux, gcc, compiler-optimization

我有一个函数，它只执行一些操作，例如增量。我已经声明了`inline`和`__attribute__((hot))`.

[Gcc Doc](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html)建议以下`hot`属性：

> hot 属性用于通知编译器某个函数是已编译程序的热点。该功能进行了更积极的优化，并且在许多目标上它被放置在文本部分的特殊小节中，因此所有热门功能看起来都非常接近，从而提高了局部性。

这可以解释为对于非`inline`热函数，它们将被放置在进程地址映射的较低地址区域。但是`inline`函数调用应该被它们的代码替换。`inline`所以问题是和的组合如何`hot`真正起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:05:53.610

请参阅[何时应该为函数/方法编写关键字“内联”？](https://stackoverflow.com/questions/1759300/when-should-i-write-the-keyword-inline-for-a-function-method)`inline`对关键字的一个很好的解释。`hot` *将函数声明为and* 似乎是矛盾的`inline`；如果函数未在头文件中定义，或者未在多个编译单元中定义，则不应将其声明为`inline`.

实际上，用函数定义替换函数调用并将其“内联”放置的决定取决于编译器。因此，和的组合`inline`很`hot`可能只是忽略了该`inline`部分并将其放置在`text.hot`程序的部分中。链接器是过程中唯一真正关心`inline`关键字的部分，然后它不一定会按照您的想法执行。

# python - 改组 SQLAlchemy 结果？

> ID：11005391
> 
> 赞同：5
> 
> 时间：2012-06-12T21:49:40.137
> 
> 标签：python, database, django, sqlalchemy, flask

有问题的代码：

```
 random_items = random.shuffle(Item.query.all())[20:30] 
```

它位于 Flask/SQLAlchemy 应用程序中。`Item`是模型。

这就是我现在正在做的事情并且它有效，但是当我开始使用真实的数据集时，我预见到了一场灾难。

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-13T03:27:13.233

我不完全确定你的担心。是不是您将返回一个大型数据集，所以大型列表将在内存中进行操作？

如果是这样，如果您不太担心可移植性，您可以在 SQL 语句中执行此操作；即，如果您使用的是 MySQL，您可以执行以下操作：

```
from sqlalchemy.sql.expression import func
Item.query.order_by(func.rand()).offset(20).limit(10).all() 
```

或者，在 PostgreSQL 中：

```
from sqlalchemy.sql.expression import func
Item.query.order_by(func.random()).offset(20).limit(10).all() 
```

其他数据库具有类似的机制，因此调用的函数将取决于您的目标。当然，如果您尝试编写一个可以在任何 SQLAlchemy 后端上运行的通用应用程序，您可能需要坚持使用提供的示例。

# linux - 如何编写 bash shell 脚本以 ssh 连接到远程机器并更改用户并导出 env 变量并执行其他命令

> ID：11005396
> 
> 赞同：4
> 
> 时间：2012-06-12T21:49:58.983
> 
> 标签：linux, bash, ssh, perforce, redhat

我有一个在多个不同的远程 redhat 机器上运行的 web 服务。每当我想更新服务时，我都会从版本控制库（我使用 perforce）同步使用 perl 编写的新 Web 服务源代码，并使用新同步的 perl 代码重新启动服务。我觉得一个一个地登录到远程机器上然后手动执行那一系列命令来一个一个地重启服务太无聊了。所以我写了一个 bash 脚本 update.sh 如下所示，以便“一次在一个地方执行，更新所有机器”。我将在我的本地机器上运行这个 shell 脚本。但它似乎不起作用。它只执行第一个命令“sudo -u webservice_username -i”，我可以从本地机器的命令行中看出这一点。（下面的代码仅显示了它将如何更新远程 Web 服务之一。“

```
#!/bin/sh
    ssh myname@remotehost1 'sudo -u webservice_username -i ; export P4USER=myname; cd dir ; p4 sync ; cd bin ; ./prog --domain=config_file restart ; tail -f ../logs/service.log' 
```

为什么我知道唯一的第一个命令被执行？好吧，因为在我在本地机器上输入 ssh 的密码后，它显示：

```
Your environment has been modified. Please check /tmp/webservice.env. 
```

它只是卡在那里。我的意思是没有回报。

根据评论员的建议，我为 ssh 添加了“-t”

```
#!/bin/sh
        ssh -t myname@remotehost1 'sudo -u webservice_username -i ; export P4USER=myname; cd dir ; p4 sync ; cd bin ; ./prog --domain=config_file restart ; tail -f ../logs/service.log' 
```

这将使本地命令行返回。但它看起来很奇怪，它不能 cd 到那个“dir”，它说“cd:dir: No such file or directory”它还说“p4: command not found”。所以看起来 sudo -u 命令执行没有效果，而 export 命令没有执行或执行没有效果。
详细的本地日志文件如下：

```
Your environment has been modified. Please check /tmp/dir/.env.
bash: line 0: cd: dir: No such file or directory
bash: p4: command not found
bash: line 0: cd: bin: No such file or directory
bash: ./prog: No such file or directory
tail: cannot open `../logs/service.log' for reading: No such file or directory
tail: no files remaining 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T18:46:55.810

与其通过 ssh 连接然后立即更改用户，不如先使用`ssh -t webservice_username@remotehost1`所需的用户名连接吗？那将`sudo`完全避免需要。

如果这不可能，请尝试将您要运行的所有命令封装在一个 shell 脚本中并将其存储在远程计算机上。如果您可以从脚本中完成任务，那么您的`ssh`调用会变得更加简单，并且应该会遇到更少的问题：

```
ssh myname@remotehost1 '/path/to/script' 
```

为了轻松更新此脚本，您可以为本地计算机编写一个简短的脚本，通过它上传最新版本`scp`，然后使用`ssh`它来调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T04:29:25.143

导出命令根本无法像这样使用 ssh，您要做的是远程修改 ~/.bashrc，并且每次您进行 ssh 登录时它都会自行获取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T19:07:32.563

请注意，当您运行时：

```
#!/bin/sh
    ssh myname@remotehost1 'sudo -u webservice_username -i ; export P4USER=myname; cd dir ; p4 sync ; cd bin ; ./prog --domain=config_file restart ; tail -f ../logs/service.log' 
```

您的 ssh 会话运行`sudo -u webservice_username -i`等待它退出，然后运行其余命令；它不执行`sudo`，然后运行以下命令。这与您运行一系列命令的上下文有关。所有命令都在 shell 中执行，`myname@remotehost1`并且所有命令都`sudo -u webservice_username - i`为 webservice_username 启动一个 shell，实际上并不运行任何命令。

真正最好的解决方案就像 bta 所说的那样；编写一个脚本，然后将其 rsync/scp 到目的地，然后使用`sudo`.

# android - android gridview与来自webservice数据的适配器类

> ID：11005398
> 
> 赞同：0
> 
> 时间：2012-06-12T21:50:08.543
> 
> 标签：android, arrays, web-services, gridview, adapter

这是我的 gridview.java 类

```
public class TextGridActivity extends Activity {

String[] _cataId=new String[100] ;
String[] _cataName=new String[100];
  String[] _cataDes=new String[100];
  String[] _cataCode=new String[100];
      int num,k=0;
         int len=10;
      String[] temp ;
DataAdapter mAdapter;

GridView gridView;
private static String SOAP_ACTION = "http://tempuri.org/GetItemCategory";

 private static String NAMESPACE = "http://tempuri.org/";

     String METHOD_NAME = "GetItemCategory";

 String res="";
  private static String URL = "http://10.0.2.2:63395/Service1.asmx";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

fillTitle();

    createViews();
}

    public void createViews()
      { 

         mAdapter = new DataAdapter(this,_cataId,_cataName,_cataDes,_cataCode,len);
      GridView gridview = (GridView) findViewById(R.id.gridview);  

    gridview.setAdapter(mAdapter);}
//method for soap call
       public void fillTitle(){
       SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = true;
    envelope.setOutputSoapObject(request);
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
    try {

     androidHttpTransport.call(SOAP_ACTION, envelope);
     KvmSerializable response = (KvmSerializable)envelope.bodyIn;

    res= response.getProperty(0).toString();
    Toast.makeText(this, res,Toast.LENGTH_LONG).show();

    String delimiter = ";";
      temp= res.split(delimiter);

    for(int i=0;i<len; i++)
    {
        _cataId[i]=temp[i].substring(29);
    //Toast.makeText(this, _cataId[i],Toast.LENGTH_LONG).show();

        _cataName[i]=temp[i+1].substring(9);
        //Toast.makeText(this, _cataName[i],Toast.LENGTH_LONG).show();

        _cataDes[i]=temp[i+2].substring(9);
        //Toast.makeText(this, _cataDes[i],Toast.LENGTH_LONG).show();

        _cataCode[i]=temp[i+3].substring(10);
        //Toast.makeText(this, _cataCode[i],Toast.LENGTH_LONG).show();

     i=i+4;

    }

} 
    catch (Exception e) {

    Toast.makeText(this, e.toString(),
    Toast.LENGTH_LONG).show();
    } }
    } 
```

这是我的 DataAdapter.java 类

```
public class DataAdapter extends BaseAdapter
{                  
       Context mContext;

      private String[] _cataId ;
     private  String[] _cataName;
      private String[] _cataDes;
      private String[] _cataCode;
       int len;

     public DataAdapter(Context mContext, String [] cataId, String [] cataName, String[] cataDes, String[] cataCode,int len) {

         super();
          this.mContext=mContext;
         this._cataId=cataId;
         this._cataName = cataName;
         this._cataDes = cataDes;
         this._cataCode = cataCode;
           this.len = len;
         }

       private LayoutInflater mInflater;
       public DataAdapter(Context c)
       {
              mContext=c;
              mInflater = LayoutInflater.from(c);
       }
       public int getCount()
       {
              return len;
       }

       public Object getItem(int position)
       {

           return  position;

       }

    public long getItemId(int position)
       {
              return position;
       }

       public View getView(int position, View convertView, ViewGroup parent)
       {
              ViewHolder holder=null;
              if(convertView==null)
              {
                     convertView = mInflater.inflate(R.layout.customgrid, null);
                     holder = new ViewHolder();
                     holder.txtId=(TextView)convertView.findViewById(R.id.txtId);
                    // holder.txtId.setPadding(30, 10,10 , 10);
                     holder.txtName=(TextView)convertView.findViewById(R.id.txtName);
                    //holder.txtName.setPadding(30, 10, 10, 10);
                     holder.txtDes=(TextView)convertView.findViewById(R.id.txtDes);
                   // holder.txtDes.setPadding(30, 10, 10, 10);
                     holder.txtCode=(TextView)convertView.findViewById(R.id.txtCode);
                   // holder.txtCode.setPadding(30, 10, 10, 10);
                     if(position==0)
                     {                             
                           convertView.setTag(holder);
                     }
              }
              else
              {
                     holder = (ViewHolder) convertView.getTag();
              }
              holder.txtId.setText(_cataId[position]);
              holder.txtName.setText(_cataName[position]);
              holder.txtDes.setText(_cataDes[position]);
              holder.txtCode.setText(_cataCode[position]);

              return convertView;
       }
       static class ViewHolder
       {        

            TextView txtId;        
              TextView txtName; 
              TextView txtDes;
            TextView txtCode;
       }
} 
```

数据来自 res 变量。它由 (;) 分隔。我已经烘烤了所有数据及其进入 ,_cataId,_cataName,_cataDes,_cataCode 并被烘烤以确保它的到来与否。

现在我的问题是我在 CreateViews() 方法上强制关闭.. 使用的 madapter n 网格已被清除。请告诉我在调用此方法时我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:53:50.150

由于通信在 UI 线程上，因此您会得到[ANR 。](http://developer.android.com/guide/practices/design/responsiveness.html)从安卓 4 开始。

对于所有长时间（或未知时间）的操作，请在不是 UI 线程的线程上使用它们，并仅在需要时更新 UI 线程。

阅读此内容以获取更多信息：

[http://developer.android.com/resources/articles/painless-threading.html](http://developer.android.com/resources/articles/painless-threading.html)

为了避免它，您可以使用严格模式：

[http://developer.android.com/reference/android/os/StrictMode.html](http://developer.android.com/reference/android/os/StrictMode.html)

# python - Tkinter lambda 函数

> ID：11005401
> 
> 赞同：4
> 
> 时间：2012-06-12T21:50:26.937
> 
> 标签：python, lambda, tkinter

（正如“作业”标签所示，这是计算机科学中一个*大项目的一部分。）*

我在写*危险！*使用 tkinter 在 Python 中进行模拟，我在按钮中使用 lambda 函数时遇到了一个大问题。假设`root = Tk()`和`categories`是一个列表。

```
# Variable to keep the buttons
root._buttons = {}

# Display headers on top of page
for i in range(5):
    # Get category name for display in main window
    name = categories[i]
    b = Label(root, text=fill(name.upper(), 10), width=18, height=3,\
        bg="darkblue", fg="white", font=("Helvetica bold", "", 11))
    b.grid(row=0, column=i)

    # Create list of buttons in that variable (root._buttons)
    btnlist = [None]*5

    # Display individual questions
    for j in range(5):

        # Make a button for the question
        b = Button(root, text="$" + str(200 * (j+1)), width=8, height=1,
            bg="darkblue", fg="orange", font=("Impact", "", 30))
        b.cat = name
        b.value = 200 * (j + 1)
        b.sel = lambda: select(b.cat, b.value)

        # Add callback event to button
        print(b.cat, b.value, b.sel)
        b.config(command=b.sel)

        # Add button to window
        b.grid(row=j+1, column=i)

        # Append to list
        btnlist[j] = b

    root._buttons[categories[i]] = btnlist 
```

有关所有代码，请参阅[我的小代码查看器（正在建设中！）](http://chancehenrik.x10.mx/code/view.php?file=jeopardy.py)

问题似乎出现在`lambda: select(b.cat, b.value)`哪里，因为当我单击板上的任何按钮时，它总是会转到板上的最后一个按钮。我尝试了其他方法，不幸的是都使用了`lambda`，我还没有看到任何不涉及`lambda`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-12T21:52:27.250

改变

```
lambda: select(b.cat, b.value) 
```

至

```
lambda b = b: select(b.cat, b.value) 
```

在您的原始代码中，`b`不是`lambda`;的局部变量 它位于封闭范围内。一旦`for-loop`完成，`b`保留它的最后一个值。这就是为什么`lambda`功能都使用最后一个按钮的原因。

如果您将 lambda 定义为采用一个具有默认值的参数，则默认值在定义 lambda 时确定（并固定*）*。Now`b`是 的局部变量`lambda`，当不带参数调用 lambda 时，Python 设置`b`为默认值，该默认值很高兴根据需要设置为各种不同的按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:14:46.650

如果你用函数工厂替换 lambda 表达式，它会让你更有表现力。（假设您要多次调用它）。这样你就可以在以后进行分配、添加更复杂的逻辑等，而不必处理 lambda 的限制。

例如：

```
def button_factory(b):
    def bsel():
        """ button associated with question"""
        return select(b.cat, b.value)
    return bsel 
```

给定一个 input `b`，`button_factory`返回一个可调用的函数，该函数`()`返回你想要的。唯一的区别是你可以做作业等。

尽管它最初可能会占用更多的代码行，但它会在以后为您提供更大的灵活性。（例如，您可以将计数器附加到 bsel 并能够计算选择特定问题的次数等）。

它还有助于自省，因为您可以使每个文档字符串清楚地识别它与哪个问题相关联，等等。

# python - Python，试图从子进程中获取输入？

> ID：11005404
> 
> 赞同：4
> 
> 时间：2012-06-12T21:50:50.713
> 
> 标签：python, multiprocessing, subprocess

主文件

```
import subprocess,sys
process = subprocess.Popen([sys.executable]+['example.py'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)

while True:
    out = process.stdout.read(1)
    if not out:
        out=process.stderr.read(1)
    if out == '' and process.poll() != None:
        break
    if out != '':
        print out 
```

例子.py

```
f=raw_input('WHats your favorite animal') 
```

好的，我想知道如何在主循环中检查输入并能够为其提供一些数据。现在，当我使用 raw_input 时，我的程序会冻结。

这是我想要的

```
while True:
    out = process.stdout.read(1)
    if not out:
        out=process.stderr.read(1)
    if out == '' and process.poll() != None:
        break
    #showing what i want
    if request_input==True:
        give_input('cat') #Give input to the raw_input
    #
    if out != '':
        print out 
```

不知道有没有这样的功能。如果您需要更多解释，请发表评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T23:20:50.267

这实际上并不是进行进程间通信的最佳方式，我建议您使用多处理或线程库以及诸如队列或 PIPE 之类的东西来进行通信和同步。

队列将是共享数据的最简单方式，一个进程将输入一个值，另一个进程将获取这些值。

我已经修改了你的原始代码，所以它现在可以工作了，注意 raw_input 不会刷新标准输出，如果那里没有任何东西会挂起，[http://code.activestate.com/lists/python-list/265749/](http://code.activestate.com/lists/python-list/265749/)这是为什么你的代码只是在等待标准输出......

**这是危险的，它会产生死锁，使用风险自负，尝试另一种方法。**

```
import sys
print 'Whats your favorite animal\n' #raw_input doesn't flush :( and we want to read in a whole line
sys.stdout.flush()
f = raw_input()
print f 
```

和相应的 main.py

```
import subprocess, sys, os
process = subprocess.Popen([sys.executable]+['example.py'],
     stdout = subprocess.PIPE, stderr = subprocess.PIPE, stdin = subprocess.PIPE)

while True:
    if process.poll() != None:
        break
    request_input = process.stdout.readline() # read line, this will wait until there's actually a line to read.
    if request_input == "Whats your favorite animal\n":
        print 'request: %s sending: %s' % (request_input, 'cat')
        process.stdin.write('cat\n')
       process.stdin.flush() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T14:42:57.243

**编辑：** 好像我误解了你的问题，对此感到抱歉。

这并不像您想象的那么容易：

您必须使用`select`检查是否有可用的数据`stdin`，如果有数据，请阅读！

最小的例子：

```
STDIN, STDOUT = 0, 1

while not process.poll() is None:
    out = process.stdout.read(1)

    if not out:
        break

    try:
        fds = select.select([STDIN], [], [])[0]
    except select.error:
        pass
    else:
        if STDIN in fds:
            data = os.read(STDIN, 1024)

            if data_requested:
                process.stdin.write(data) 
```

要选择的信息：[http](http://docs.python.org/library/select.html#module-select) ://docs.python.org/library/select.html#module-select、http : [//linux.die.net/man/2/select](http://linux.die.net/man/2/select)和[http://en.wikipedia.org/ wiki/Select_(Unix)](http://en.wikipedia.org/wiki/Select_(Unix))

不确定这是否适用于 Windows，因为 Windows 仅支持`select`套接字。关于 SO 的相关问题：[Windows 上最好的 epoll/kqueue/select 等效项是什么？](https://stackoverflow.com/questions/67082/what-is-the-best-epoll-kqueue-select-equvalient-on-windows)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:09:41.873

除非您坚持使用“原始 python”，否则最好使用 pexpect 模块。我已经在您的 example.py 中添加了一个输出，否则它一点也不好玩。

这是example.py：

```
 f=raw_input('WHats your favorite animal')
    print f.upper() 
```

这是您正在寻找的 pexpect-example.py：

```
 # see http://pexpect.sourceforge.net/pexpect.html
    import pexpect

    PY_SCRIPT = 'example.py'

    child = pexpect.spawn('python %s' % PY_SCRIPT)

    child.expect ('WHats your favorite animal')

    # comment out these three lines if you run unmodified example.py script
    child.setecho(False)
    child.sendline ('cat')
    print PY_SCRIPT, 'said:', child.readline() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T21:08:36.110

尝试使用多处理模块

```
from multiprocessing import Process, Value, Array

def f(n, a):
    n.value = 3.1415927
    for i in range(len(a)):
        a[i] = -a[i]

if __name__ == '__main__':
    num = Value('d', 0.0)
    arr = Array('i', range(10))

    p = Process(target=f, args=(num, arr))
    p.start()
    p.join()

    print num.value
    print arr[:] 
```

# c# - 将 C# 应用程序移植到 Mono，需要使用 FirewallAPI。有单声道等价物吗？

> ID：11005407
> 
> 赞同：3
> 
> 时间：2012-06-12T21:51:00.030
> 
> 标签：c#, mono, windows-firewall, windows-firewall-api

我已经编写了一个 Windows 服务，我需要将它移植到 Mono 上，这样它就可以在 Mac / Linux 平台上使用。

它利用了 FirewallAPI.dll（我认为这是实际名称......）。其他名称是 NetFwTypeLb、NATUPNPLib 和 NETCONLib。

我一直在谷歌搜索，试图找到一种在 Mac / Linux 平台上实现此功能的方法，但我找不到可以用来执行此操作的方法。

这可能吗？并将另一个问题与这个问题结合起来：Mac / Linux 平台是否允许轻松安装和运行服务（我认为另外称为“守护程序”）？

谢谢，玛德琳

请注意，这是我正在使用的当前代码，我从另一个 StackOverflow 问题中得到它：

```
public class Firewall
{
    public static INetFwMgr WinFirewallManager()
    {
        Type type = Type.GetTypeFromCLSID(
            new Guid("{304CE942-6E39-40D8-943A-B913C40C9CD4}"));
        return Activator.CreateInstance(type) as INetFwMgr;
    }
    public bool AuthorizeProgram(string title, string path,
        NET_FW_SCOPE_ scope, NET_FW_IP_VERSION_ ipver)
    {
        Type type = Type.GetTypeFromProgID("HNetCfg.FwAuthorizedApplication");
        INetFwAuthorizedApplication authapp = Activator.CreateInstance(type)
            as INetFwAuthorizedApplication;

        authapp.Name = title;
        authapp.ProcessImageFileName = path;
        authapp.Scope = scope;
        authapp.IpVersion = ipver;
        authapp.Enabled = true;

        EventLog.WriteEntry("MachineVerification", authapp.Name + " " + authapp.Scope + " " + authapp.IpVersion);

        INetFwMgr mgr = WinFirewallManager();
        try
        {
            mgr.LocalPolicy.CurrentProfile.AuthorizedApplications.Add(authapp);

            EventLog.WriteEntry("MachineVerification", authapp.Name + " " + authapp.Scope + " " + authapp.IpVersion);
        }
        catch (Exception ex)
        {
            EventLog.WriteEntry("MachineVerification", "MROW!" + ex.Message);
            return false;
        }
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:36:27.150

当我弄清楚这一切时，我忘了回答这个问题！

在 OS X 上，不需要设置防火墙例外。OS X 将要求用户授予您的应用程序访问 Internet 的权限。

虽然我不确定 Linux，但 Mono 在 Linux 上的覆盖率要高得多，所以我相信以前有人已经为 Linux 回答过这个问题。

# ruby-on-rails - Rspec 仅在第二次测试运行后返回结果

> ID：11005408
> 
> 赞同：2
> 
> 时间：2012-06-12T21:51:07.393
> 
> 标签：ruby-on-rails, rspec, integration-testing

我正在测试我的 REST API，我遇到的问题是我使用工厂女孩创建了一个视频，而我第二次运行测试时才从 API 获得结果。即使我在第一次运行后注释掉了视频创建，所以也没有创建第二个视频。

这仅在我配置时有效

```
config.use_transactional_fixtures = false 
```

所以测试数据将保留在数据库中。

我的规格文件

```
describe "API Version 1" do
  describe "Videos" do

let(:video) { FactoryGirl.create(:video) }
before { get api_v1_videos_path }

it "should work" do
  response.status.should be(200)
end

it "should return the video" do
    output = JSON.parse(response.body)
    output.should == video.title
end

end
end 
```

首次运行后出错

```
1) API Version 1 Videos should return the video
 Failure/Error: output.should == video.title
   expected: "Darknight"
        got: [] (using ==)
 # ./spec/requests/api/v1_spec.rb:15:in `block (3 levels) in <top (required)>' 
```

第二次运行后出错（仍然出错但返回结果）

```
1) API Version 1 Videos should return the video
 Failure/Error: output.should == video.title
   expected: "Darknight"
        got: [{"id"=>3, "title"=>"Darknight", "video"=>"thevideo.mp4", "stream"=>"playlist.m3u8", "poster"=>"/uploads/test/video/3_darknight/poster/testimage.jpg", "categories"=>[{"id"=>3, "title"=>"test category"}]}] (using ==)
   Diff:
   @@ -1,2 +1,7 @@
   -"Darknight"
   +[{"id"=>3,
   +  "title"=>"Darknight",
   +  "video"=>"thevideo.mp4",
   +  "stream"=>"playlist.m3u8",
   +  "poster"=>"/uploads/test/video/3_darknight/poster/testimage.jpg",
   +  "categories"=>[{"id"=>3, "title"=>"test category"}]}]
 # ./spec/requests/api/v1_spec.rb:15:in `block (3 levels) in <top (required)>' 
```

好像 rspec 在创建视频后没有访问 API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:58:34.120

更改以下行...

```
let(:video) { FactoryGirl.create(:video) } 
```

至

```
let!(:video) { FactoryGirl.create(:video) } 
```

# python - Vpython绘制半球

> ID：11005413
> 
> 赞同：2
> 
> 时间：2012-06-12T21:51:27.343
> 
> 标签：python, 3d, shapes, vpython

我在我的程序上绘制了一个球体，如下所示：

```
ball=sphere(pos=vector(0,0,0),opacity = 0.5,radius=0.95,color=color.black) 
```

有没有办法让它只显示球体的上半部分？

我正在使用 vpython。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T00:44:43.370

最好的方法是进行挤压。使你的形状变成四分之一圆，然后将挤压成整个 60 度。如果您看到挤压示例，他们会对此有很多帮助，vpython 的纪录片也是如此。

前任：

```
 circle = shapes.circle(radius=20) #you can use the size of your choice
    square1 = Polygon[(-10,-20),(-10,20),(0,20),(0,-20)]
    square2 = Polygon[(0,0),(0,20),(20,20),(20,0)]

    rotation = paths.arc(radius=20, angle2=pi)

    Hemisphere = extrusion(pos=rotation,shape=circle-square1-square2) 
```

不确定这是否完全没有语法错误等，但我认为你理解这背后的想法。四分之一圆从中心旋转，直到它形成一个完整的半球。希望你明白这一点，只是做了这个，但要制作一个完整的球体，并取出一个夹头，就好像一片蛋糕从球体中取出一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-01T19:24:55.290

为了清楚起见，我已经使用挤压来完成此操作，只需要一个 3/4 的球体。通过调用 circle 制作一个半圆形，然后在半个圆形上减去一个正方形。在此之后，使您的旋转等于 1pi（半圈）。这是如何做到的：

```
S1 = shapes.circle(radius=1)

angle = 180  # degrees
angle = angle * (pi/180)  # convert to radians (1pi)

sq = Polygon([(-10, -20), (-10, 20), (0, 20), (0, -20)])
semicircle = paths.arc(radius=0.000000001, angle1=pi/2, angle2=2.2*pi)

mf = frame()
Layer20_Extrusion = extrusion(frame=mf, pos=semicircle, shape=S1-sq, color=wh)

mf.rotate(angle=angle)
mf.pos = (0, 0, 0) 
```

您将不得不旋转它，使其失去上半部分而不是侧面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T15:07:22.380

你可以做一个黑色的盒子，让它覆盖半个球体，但除此之外，我不知道对不起

# c# - 带参数的 C# OdbcDataReader 存储过程调用不返回数据

> ID：11005414
> 
> 赞同：0
> 
> 时间：2012-06-12T21:51:36.207
> 
> 标签：c#, .net

我认为我忽略了一些微不足道的问题，我正在调用存储过程，我知道调用是在分析器中看到的，当我从查询分析器运行存储过程时，它确实返回记录如预期。问题是当我从 C# 代码调用它时，正在执行但没有检索到结果。

我的调试表明，如果我有一个代码，例如如果 OBJECT_ID ('tempdb..##base') IS NOT NULL drop table ##base 在存储过程中，它不会使用 OdbcDataReader 返回任何数据，否则它会返回数据，有人能告诉我这是为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:54:46.470

请记住，返回给 .NET 的结果是在过程中发出 SELECT 的 LAST 语句的结果。如果 OBJECT_ID 查询是在您想要返回数据的 SELECT 语句之后，那么您可能不会得到结果。

但是，我需要查看您的存储过程才能确定地告诉您。

```
SET QUOTED_IDENTIFIER ON 
GO

SET ANSI_NULLS ON 
GO

ALTER         PROCEDURE dbo.proc_myStoredProc
AS

if OBJECT_ID ('tempdb..##base') IS NOT NULL drop table ##base
SELECT * FROM mytable
GO

SET QUOTED_IDENTIFIER OFF 
GO

SET ANSI_NULLS ON 
GO 
```

如果我删除上面的 drop table 语句，我会得到数据，否则没有

**如何检查和删除临时表**

[http://blog.sqlauthority.com/2009/05/17/sql-server-how-to-drop-temp-table-check-existence-of-temp-table/](http://blog.sqlauthority.com/2009/05/17/sql-server-how-to-drop-temp-table-check-existence-of-temp-table/)

# asp.net - 从外部源连接到 2007 共享点服务器的方法

> ID：11005418
> 
> 赞同：0
> 
> 时间：2012-06-12T21:51:48.173
> 
> 标签：asp.net, sharepoint, sharepoint-2007, sharepoint-list

我正在尝试从外部源连接到共享点服务器。我希望能够查看和编辑列表。我曾尝试从服务器内部执行此操作，但它都指向我将服务器升级到 Sharepoint 2010，目前这不是一个选项。使用asp.net 还有哪些其他选项可供我研究？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T01:53:14.383

SharePoint 2007 提供了允许您执行此操作的 ASMX Web 服务。

[从这里](http://msdn.microsoft.com/en-us/library/aa979690%28v=office.12%29)开始。有获取列表和从感兴趣的列表中获取项目的操作方法。

# javascript - 按键后如何删除背景图像？

> ID：11005419
> 
> 赞同：0
> 
> 时间：2012-06-12T21:51:50.947
> 
> 标签：javascript, jquery, css

当用户在文本框中键入时，我正在显示一个旋转的轮子图像，并且在完成 ajax 调用后，我想删除该图像。问题是图像不会消失。我确定代码已执行，因为我可以看到代码中所述的日志信息。我究竟做错了什么？

```
$(document).ready(function () {
    $("[NeedSpellCheck='true']").each(function () {
        $(this).keypress(function (e) {
            $(this).css("background-image", "url(images/loading.gif)");
            $(this).css("background-repeat", "no-repeat");
            $(this).css("background-position", "right");

            $(this).spellchecker(
            {
                url: "~/JQuerySpellCheckerHandler.ashx",
                lang: "en",
                engine: "google",
                suggestBoxPosition: "bottom"
            }).spellchecker("check", function (result) {
                $(this).css("background-image", "none"); // <-- corrected typo
                console.log("removed"); //<-- displayed in console
            });
        });
    });
});

<input type="text" NeedSpellCheck="true" /> 
```

**更新** 我纠正了错字，但它仍然不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:53:59.883

你有一个错字：

```
$(this).css("background-image", "none"); 
```

如果这不是问题，您可能需要在插件之外引用它：

```
$(document).ready(function () {
    $("[NeedSpellCheck='true']").each(function () {
        $(this).keypress(function (e) {
            var $this = $(this);  // you could use $this for the following as well
            $(this).css("background-image", "url(images/loading.gif)");
            $(this).css("background-repeat", "no-repeat");
            $(this).css("background-position", "right");

            $(this).spellchecker(
            {
                url: "~/JQuerySpellCheckerHandler.ashx",
                lang: "en",
                engine: "google",
                suggestBoxPosition: "bottom"
            }).spellchecker("check", function (result) {
                $this.css("background-image", "none");  // reference object
                console.log("removed"); //<-- displayed in console
            });
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T21:54:55.517

代替：

```
$(this).css("backbround-image", "none"); 
```

和：

```
$(this).css("background-image", "none"); 
```

# javascript - ASP.net MVC 缩小和捆绑 - 如何缩小单个 JavaScript 文件

> ID：11005425
> 
> 赞同：2
> 
> 时间：2012-06-12T21:52:27.050
> 
> 标签：javascript, asp.net-mvc

为了保持不显眼的 JavaScript 指南，我将所有 JavaScript 从我的每个视图中移出并放入单独的 .js 文件中。

但是，在 1 个视图中，我需要动态创建一些 JavaScript 变量，以便将这些变量插入 ViewBag 并直接呈现到视图中：

```
 $(document).ready(function () {
        @(ViewBag.PrePop)
        @(ViewBag.PreDiscount)
    }); 
```

在我尝试使用新的 ASP.net 捆绑和缩小功能之前，这一切正常。

将所有这些小的外部 JavaScript 文件捆绑在一起，然后从每个页面调用组合脚本意味着每个页面（包含 ViewBag 发出的变量的页面除外）都有一个变量引用错误：

```
Uncaught ReferenceError: quotes is not defined 
```

所以这基本上意味着我不能捆绑这个特定的 JavaScript 文件。

但是，我想缩小它。为此，我是否只需声明一个仅包含一个 JavaScript 文件的包：

```
bundles.Add(new ScriptBundle("~/bundles/mypagescript").Include(
            "~/Scripts/mypagescript.js")); 
```

还是有另一种方法可以单独执行缩小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T22:28:38.323

是的，目前我们并没有真正公开任何方法让您轻松调用优化只是为了缩小字符串（`JsMinify.Process`如果您真的想要，您可以通过一个实例来实现）即：

```
string js = "//I am a comment\r\nfoo = bar;\r\nfoo = yes;";
JsMinify jsmin = new JsMinify();
BundleContext context = new BundleContext();
BundleResponse response = new BundleResponse(js, null);
response.Content = js;
jsmin.Process(context, response);
Assert.AreEqual("foo=bar,foo=yes", response.Content); 
```

但是您的建议可能是最好的（创建一个文件的捆绑包）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-02T10:47:09.110

抱歉回复晚了 ;）

您可以使用 Microsoft.Ajax.Utilities.Minifier。创建一个实例并调用 MinifyJavaScript - 它将一个字符串（JS 代码）作为参数并返回缩小后的代码。

```
Dim minifier As New Microsoft.Ajax.Utilities.Minifier()
minifier.MinifyJavaScript(script) 
```

然后，您可以创建自己的 HTML 助手或操作来调用它。这至少在我的情况下效果很好；）

# core-data - 如何使用核心数据的添加和删除（NSSet）访问器方法？

> ID：11005427
> 
> 赞同：7
> 
> 时间：2012-06-12T21:52:32.417
> 
> 标签：core-data, subclass, insertion, nsset

在这个测试核心数据项目中，我有一个从“客户”到“产品”的一对多关系，这种关系被命名为“产品”。客户的属性是“名称”，产品的属性是“项目”。我对实体进行了子类化，Xcode 为客户生成了以下内容：

```
@interface Customer : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSSet *products;
@end

@interface Customer (CoreDataGeneratedAccessors)

- (void)addProductsObject:(Products *)value;
- (void)removeProductsObject:(Products *)value;
 - (void)addProducts:(NSSet *)values;
- (void)removeProducts:(NSSet *)values;

@end 
```

假设要添加一个客户（John Doe）和两个项目（Widget 1 和 Widget 2），我可以使用访问器方法***addProductsObject***，如下所示：

```
...
// Add (1) customer object
Customer *custObj = [NSEntityDescription insertNewObjectForEntityForName:[entity name] inManagedObjectContext:context];
[custObj setValue:@"John Doe" forKey:@"name"];

// Add (2) products for John Doe
for (int foo=0; foo<2; foo++) {
    self.product = [NSEntityDescription insertNewObjectForEntityForName:@"Products" inManagedObjectContext:context];
    NSString *objString = [NSString stringWithFormat:@"Widget %d", foo];
    self.product.item = objString;
    [custObj addProductsObject:self.product];
}
... 
```

这很好用，但如果可能的话，我想使用***addProducts***访问器。

我假设生成的访问器方法***addProducts***是为了方便插入一组对象，例如：

```
...
NSSet *itemSet = [[NSSet alloc] initWithObjects:@"Widget 1", @"Widget 2", nil];
[custObj addProducts:itemSet];
... 
```

但这失败了。在这次尝试中，我知道一个产品对象没有被显式创建，因此，一个显式的产品分配没有发生，但我认为，也许访问器会处理这个问题。

因此， addProducts以及**removeProducts**的正确用法是**什么**？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-13T14:39:29.743

您传递给 addProducts 的集合包含 NSString，而不是 Products。

```
NSMutableSet* products = [NSMutableSet set];

Products* product = [NSEntityDescription insertNewObjectForEntityForName: @"Products" inManagedObjectContext: context];
product.item = @"Widget 1";
[products addObject: product];

product = [NSEntityDescription insertNewObjectForEntityForName: @"Products" inManagedObjectContext: context];
product.item = @"Widget 2";
[products addObject: product];

[customer addProducts: products]; 
```

本质上，访问者无法知道您首先给它的字符串是做什么用的。您必须提供一个包含正确类型实体的集合。

也就是说，您可以定义自己的访问器，获取一组字符串并在您的关系中插入正确初始化的产品：addProductsWithStrings：例如。

# git - 我可以在不将其历史合并到主线的情况下对项目中的点文件进行版本控制吗？

> ID：11005429
> 
> 赞同：1
> 
> 时间：2012-06-12T21:52:48.497
> 
> 标签：git, branch, gitignore

我敢肯定这个标题相当晦涩。我想知道是否有某种方法`git`可以告诉它您希望某个文件在分支之间移动时使用不同版本的文件，但总体上是 .gitignored 从存储库中。

这是我的场景：我有一个使用 git 控制的 Flash Builder 项目（用于 Flex 应用程序）。Flash Builder 项目中的 Flex 应用程序创建三个文件： `.actionScriptProperties`、`.flexProperties`和`.project`. 这些文件包含大量本地文件系统引用（源文件夹、输出文件夹等），因此我们自然而然地从我们的 repo 中将它们 .gitignore。

今天，我想在我的项目中使用一个新的库，所以我做了一个单独的 git 分支，名为`lib`，删除了旧版本的库并放入了新的库。不幸的是，这个 Flex 库信息存储在这三个点文件之一中（不确定是哪个临时文件）。因此，当我必须`master`早先切换回第一个分支（`master``lib`

所以我想知道是否有任何方法让我继续 .gitignore 这些文件（所以我的其他开发人员没有得到它们），但告诉 git 我希望它使用某种本地“分支版本”，所以我可以在本地为不同的分支使用不同版本的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:27:53.460

### TL;博士

文件要么被忽略，要么不被忽略。但是，即使文件被忽略，您也可以将文件提交到分支；你只需要确保你不会在错误的分支上再次提交它们。

### 选项

1.  如果您想在 git 下维护修订，但在单独的项目中，您可能能够使用子模块或子树合并。
2.  使用 RCS 对 Git 忽略的文件进行版本控制。小心 git-clean；如果您删除了***,v**文件，您将丢失 RCS 修订历史记录。
3.  保留一个只包含您的自定义文件的分支，并定期将忽略的文件合并到您的工作树中

### 选项 3，详细

忽略 master 分支上的文件。

```
git checkout master
cat << EOF >> .gitignore
.actionScriptProperties
.flexProperties
.project
EOF
git add .gitignore
git commit .gitignore 
```

创建一个空分支来保存您的配置文件。

```
git symbolic-ref HEAD refs/heads/flexconfig
rm .git/index 
git clean -fdx
touch .actionScriptProperties .flexProperties .project
git add .
git commit 
```

将您忽略的文件合并到您的主分支中，但忽略它们。

```
git checkout master
git merge --no-ff flexconfig 
```

如果`git status`此时运行，它将显示一个干净的工作树，但实际上您的工作树中有 Flex 点文件。只是不要使用`git add .`或类似的，因为这会覆盖你的 .gitignore 设置。

# ruby-on-rails-3 - Rails 3 迁移搞砸了

> ID：11005433
> 
> 赞同：0
> 
> 时间：2012-06-12T21:53:00.557
> 
> 标签：ruby-on-rails-3, migration

我最近将`Devise`and添加`CanCan`到我的`Rails 3.2.3`应用程序中，并且需要运行`rake db:migrate`才能使它们正常工作。我有一个我已经创建的链接的迁移文件，它与我运行时发生冲突`rake db:migrate`

```
==  CreateLinks: migrating ====================================================
-- create_table(:links)
rake aborted!
An error has occurred, this and all later migrations canceled:

SQLite3::SQLException: table "links" already exists: CREATE TABLE "links" ("id"INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "url" varchar(255), "description" var
char(255), "created_at" datetime NOT NULL, "points" integer, "updated_at" dateti
me NOT NULL) 
```

我尝试跑步`rake db:migrate:reset`，但这似乎对我的情况没有任何帮助。我仍然无法为我的新 gem 运行数据库迁移。我怎样才能解决这个问题？我可以以某种方式省略链接迁移吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:14:48.077

s您在运行迁移之前是否手动创建了链接表？不知何故，您似乎使您的迁移与您的数据库不同步。

如果你不关心数据库中的任何数据，你可以先做一个`rake db:drop`，然后做`rake db:migrate`. 这会清除数据库中的所有表，并从头开始再次运行所有迁移。

如果您确实需要维护现有的数据库表，那么您可以用语句包装该`create_table :links`语句`unless table_exists? :links`。

# html - CSS div 位置

> ID：11005434
> 
> 赞同：0
> 
> 时间：2012-06-12T21:53:03.617
> 
> 标签：html, css, css-position

我看了一遍，似乎找不到正确的答案。这些 div 都是从数据库动态创建的。前任。

```
<div class="accordian_header"><div class="title"> any title </div></div>
<div class="accordian_body">
    <div class="topleft"> info....</div>
    <div class="topright"> info...</div>
</div> 
```

现在我希望“topleft”类位于“accordian_body”div 的左上角，而“topright”类位于右上角。问题是如果我给他们分配位置：absolute 那么他们就会走到页面的右上角。如果我选择任何其他类型的定位，它就不起作用。

现在，如果我将 "accordian_body" 设置为 position: absolute ，然后 topright 和 topleft 工作。问题是我正在动态创建它们，所以它们不能是绝对的。它们需要在彼此之上创建，并且没有任何位置属性可以完美地工作。我发现对于“topleft”和“topright”，我可以使用 float: left 或 right 并且可以，但是如果我想要顶部或底部的文本或图像，到目前为止我还没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T21:55:33.237

制作容器`relative`，然后您可以绝对定位孩子。

**CSS**

```
.accordian_body {
    position: relative;
}
.topleft {
    position: absolute;
    top: 0;
    left: 0;
}
.topright {
    position: absolute;
    top: 0;
    right: 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T21:56:34.020

尝试设置`position: relative`为`.accordion_body`. 然后其中的绝对定位元素将关注该容器而不是他们使用的任何祖先，而不会破坏文档的正常流程。

# .net - WCF服务在jsdebug中生成的URL可以改吗？

> ID：11005436
> 
> 赞同：3
> 
> 时间：2012-06-12T21:53:10.773
> 
> 标签：.net, wcf, web-services

我有一个 WCF 服务将与代理交谈，该代理将与用户的浏览器交谈。代理需要通过 http 与服务通信，浏览器需要使用 https 与代理通信。我遇到的问题是 WCF 服务使用 http 生成 servicePath，所以当用户的浏览器与代理对话时，它也在使用 http。有什么方法可以覆盖在 /jsdebug 和 WCF 服务生成的其他 javascript 中创建的 servicePath？

总而言之，我希望通过 http 访问该服务，但使用 https 的 URL 提供其 javascript

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T19:15:42.360

这里只是一个快速的想法：

如果您在 IIS 中托管您的服务，您能否同时启用 HTTP 和 HTTPS 绑定。然后，您可以为您的应用程序创建一个服务引用并通过 HTTP 生成代理，并在您的站点中创建一个指向 HTTPS 的脚本引用。

更适合您的网站，尝试始终使用所谓的“协议相对”网址，`src='//myservice.domain.com?js`而不是`src='https://myservice.domain.com?js`.

这可确保您网站上的脚本引用将遵循浏览器地址栏中当前使用的协议。保罗爱尔兰有一篇关于它的好[文章](http://paulirish.com/2010/the-protocol-relative-url/)......

让我们知道这些是否对您有所帮助。

格，

沃特

# mercurial - Mercurial subrepos 和 bitbucket 帐户

> ID：11005437
> 
> 赞同：0
> 
> 时间：2012-06-12T21:53:14.333
> 
> 标签：mercurial, subrepos

我在 bitbucket 上建立了一个拥有多个用户的团队，并且我正在使用 mercurial 的密钥环扩展。我需要设置一个 subrepo，并且在`.hgsub`文件中我需要提供 subrepo 的 url。

如果我使用`https://bitbucket.org/team/subrepo`，那么用户每次尝试拉取时都需要进行身份验证。

如果我使用`https://userX.bitbucket.org/team/subrepo`，那么每个用户都需要使用 userX 的密码进行身份验证。

如果我使用`https://team.bitbucket.org/team/subrepo`，那么每个用户都需要团队的密码。

有没有办法可以设置它，以便可以使用密钥环扩展保存身份验证，但仍然为每个用​​户提供单独的凭据，而不使用 ssh？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T08:45:53.303

是的，您可以在配置文件中输入您的身份验证信息。这方面的文档在[这里](http://www.selenic.com/mercurial/hgrc.5.html#auth)。

在`auth`每个用户的配置文件部分，您可以输入以下详细信息：

```
[auth]
bb.schemes = http https
bb.prefix = bitbucket.org/team
bb.username = userX 
```

该`bb`部分只是将设置组合在一起的标签 - 您可以使用您喜欢的内容，如果您使用多个 Mercurial 服务器，则可以拥有多个设置。

示例设置表明所有启动`http://bitbucket.org/team`或`https://bitbucket.org/team`应该使用`userX`. 之后，密钥环扩展将处理密码。

# javascript - 关于将 Javascript 重构为 JavaScript MVC 框架的好教程？

> ID：11005438
> 
> 赞同：0
> 
> 时间：2012-06-12T21:53:17.343
> 
> 标签：javascript, model-view-controller, refactoring

我正在寻找有关如何使用现有 JS MVC 框架之一将 JavaScript 应用程序重构为 JavaScript 应用程序的教程。有人有吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T21:59:54.950

Yes, I recommend the Backbone-Boilerplate located at [GitHub](https://github.com/tbranyen/backbone-boilerplate).

This is beneficial because, not only do you get the Backbone MVC, but also require.js AMD, and underscore.js templates. The authors have been consistently active, and the code is impressive to work with.

Here are the associated tutorials:

1.  [Introduction](http://weblog.bocoup.com/introducing-the-backbone-boilerplate/)
2.  [AMD Module setup](http://backbonetutorials.com/organizing-backbone-using-modules/)
3.  [Boilerplate](http://backboneboilerplate.com/)
4.  [Overview](http://robdodson.me/blog/2012/05/17/getting-familiar-with-backbone-boilerplate/)
5.  [Router Explanation](http://backbonetutorials.com/what-is-a-router/)

These were the tutorials I used to get it up and running. Also included is Node.js and Grunt build system. They are very much worth the effort if you are not familiar with them. I just saw today that a jQuery project is incorporating the Grunt build system. This is a good setup.

UPDATE: Apologies if you were already aware of the boilerplate. I realize it does not directly relate to refactoring. This looks like a good post on refactoring [MVC](https://stackoverflow.com/questions/1685282/refactor-to-use-oop-mvc).

Documentation may be sparse as it would be specific to how your codebase is architected. The key notion would be Data maps to Model, GUI maps to View, Collections contain multiple models, and the Router is used to route events.

Hope that helps. All the best! Nash

# asp.net - ASP.NET Response.Redirect URL 参数通过 ReverseProxy

> ID：11005443
> 
> 赞同：2
> 
> 时间：2012-06-12T21:53:41.927
> 
> 标签：asp.net, relative-path, reverse-proxy, response.redirect

我们有一个使用 Response.Redirect 的基于 Web 的应用程序

> 例如 Response.Redirect(" [http://app_domain.com/userhome.aspx](http://app_domain.com/userhome.aspx) ")

在基于表单的身份验证之后立即将 Web 浏览器重定向到适当的主页。当客户端和服务器在同一网络上时，这可以正常工作。

我们有一个用例，需要通过反向代理从外部访问此应用程序（我们使用的是 EZProxy）。因此，Web 浏览器连接到反向代理，而反向代理连接到应用程序服务器。在这种情况下，反向代理会重写所有请求和响应。Web 浏览器地址栏中的 URL 类似于[http://app_domain.com.reverseproxy.com/](http://app_domain.com.reverseproxy.com/)。用户可以浏览登录页面，输入凭据并单击登录按钮。但是，成功登录后的 Response.Redirect 似乎通过将浏览器重定向到[http://app_domain.com/userhome.aspx](http://app_domain.com/userhome.aspx)来中断流程。浏览器无法直接连接到此域，因为它位于防火墙后面。

这个问题类似于[ASP.NET AJAX 调用中的 Response.Redirect](https://stackoverflow.com/questions/8078641/response-redirect-in-asp-net-ajax-calls?answertab=active#tab-top)。但是我看到这个问题没有令人满意的答案。

是否可以使用相对路径，例如

> Request.Redirect("~/Userhome.aspx")

还是在传递给浏览器之前在服务器端解决？

期望的结果将是一种重定向机制，该机制将考虑 Web 浏览器地址栏中存在的域/url。

使用提琴手，这就是我所看到的。最后一个重定向不是反向代理友好的。

> HTTP/1.1 200 正常
> 
> 缓存控制：无缓存
> 
> Pragma：无缓存
> 
> 内容类型：文本/纯文本；字符集=utf-8
> 
> 过期：-1
> 
> 服务器：Microsoft-IIS/7.0
> 
> 设置 Cookie：.ASPXAUTH=BE3D7796245FEEA18FF92C9BD4B3F68F08C9E22CA209A139FBDC45BD6633788E6E68EE30F2BAE7EB223CA8F492FA93DFE7AB2723A848C6E75DF87B61327027AF418D42249 路径=/; HttpOnly
> 
> Set-Cookie: .ASPXAUTH=693B8AC69ABB53F7468466C6D10C9BF5BAFB860F76FC557E3DAD9C733223957E3A46FF8E21E6822CD5420F1724C61809DC83FDE7C8E3DF9D4E972E61F7DDEE05C61E8D8AA97107B5B68412AFC347; 路径=/; HttpOnly
> 
> X-Powered-By: ASP.NET
> 
> 日期：格林威治标准时间 2012 年 6 月 15 日星期五 20:41:32
> 
> 内容长度：64
> 
> 46|页面重定向|| [http://app_domain.com/UserHome.aspx|](http://app_domain.com/UserHome.aspx|)

# php - Zend RESTful 身份验证

> ID：11005444
> 
> 赞同：2
> 
> 时间：2012-06-12T21:53:44.487
> 
> 标签：php, zend-framework, authentication, rest

我有一个网站（称为siteA）我使用了php和Zend，我正在尝试实现一个api来从另一个（称为SiteB）访问我的站点（SiteA）的受限区域。

我希望能够使用 SiteB 凭据对 siteB 上的用户进行身份验证，在 siteA 上有一个 html iframe，用户已通过 API 进行身份验证。

我是新手，我真的不知道我是否朝着正确的方向前进。

到目前为止，我一直在考虑使用 restful api，并且在框架之外验证用户，但在框架中用户没有。

建议和帮助？我的代码如下：

----- SiteB 用户/index.php ----

```
<html>
<body>
<?php
  $postdata = http_build_query(
   array(            
    'userid' => 'someid',
    'key' => 'somekey',
    'public' => '1'
   )
  );

$opts = array('http' =>
  array(
    'method'  => 'POST',
    'header'  => 'Content-type: application/x-www-form-urlencoded',
    'content' => $postdata
   )
 );

$context = stream_context_create($opts);
file_get_contents('https://www.siteA.com/api', false, $context);
?>

<iframe src="https://www.siteA.com/" width="950" height="700"></iframe>
</body>
</html> 
```

----- 站点A ---------

```
<?php

class ApiController extends Zend_Controller_Action
{

    public function init()
    {
        /* Initialize action controller here */
        $this->_helper->viewRenderer->setNoRender(true);
        $this->_helper->layout->disableLayout();
    }

    public function indexAction() {
        if($this->getRequest()->isPost()){        
            $data = $this->_request->getPost();
            $this->_authenticateApi($data);
        }
        else{
            //error
        }

}
 public function _authenticateApi($data){
    $db = Zend_Registry::get('db_local');

    $authAdapter = new Zend_Auth_Adapter_DbTable($db);

    $authAdapter->setTableName('sometable');
    $authAdapter->setIdentityColumn('id');
    $authAdapter->setCredentialColumn('key');

    $authAdapter->setIdentity($data['id']);
    $authAdapter->setCredential($data['key']);

    $auth = Zend_Auth::getInstance();
    $result = $auth->authenticate($authAdapter);

    if($result->isValid()){
        if($data['public'] == "1"){
            Zend_Session::rememberMe(1209600);
        }else{
            Zend_Session::forgetMe();
        }
        return true;
    } else {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:30:41.837

我最近遇到了这个问题。您是否有理由必须使用 iframe？这对我来说有点骇人听闻。

有很多方法可以做到这一点，但在我的阅读中，最佳实践似乎是让 API 要求客户端使用 HTTP Auth Basic 进行身份验证，并使用 HTTPS（SSL 证书）来加密连接。在这种情况下，API 不管理会话！每个请求都包含 Auth Basic 标头，就像您直接浏览 API 时常规 Web 浏览器所做的一样。

然后，使用您的 SiteB，当用户登录时，您会将他们的凭据存储在您的`$_SESSION`或类似的地方，并在每次发出 API 请求时使用它们。

[Subbu Allamaraju 的RESTful Web Services Cookbook](https://rads.stackoverflow.com/amzn/click/com/0596801688)是我最近读到的一本很棒的书，它讨论了这个和其他重要的 RESTful API 细节。

顺便说一句，它并不是真正的 RESTful，除非您的客户端能够仅通过输入 URL 和 API 功能的媒体类型知识自行找出所有 URL。搜索 HATEOAS 了解更多信息。

此外，如果您尝试在 JavaScript 中执行所有这些操作，并且 SiteA 和 SiteB 不共享同一个域，您可能会被迫使用 JsonP 来处理您的 API 请求。虽然可以做到，但恕我直言，这是不可取的。`Zend_Http_Client`在您的 SiteB 的 PHP 代码中使用来执行所有 API 通信。这样您就可以解决域名问题。这也使您的 API 不被窥探（右键单击，查看源代码！），并最大限度地减少任何跨浏览器兼容性问题干扰您网站核心功能的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:30:32.553

您可以尝试使用令牌，使用 JS 进行身份验证获取存储在 Javascript 变量中的令牌，然后使用该令牌与站点 A 或站点 B 进行“新”连接。

另请阅读 OAuth 以了解有关安全问题的想法。不确定你的最终目标是什么......这是我的 2 美分。

此致，

# java - 在 Java 客户端和 Twisted Python 套接字服务器之间发送缓冲图像

> ID：11005446
> 
> 赞同：1
> 
> 时间：2012-06-12T21:53:52.443
> 
> 标签：java, python, sockets, twisted

我有一个使用 Python Imaging Library 绘制图像的服务器端函数。Java 客户端请求一个图像，该图像通过套接字返回并转换为 BufferedImage。

我在数据前面加上要发送的图像大小，然后是 CR。然后我从套接字输入流中读取这个字节数，并尝试使用 ImageIO 转换为 BufferedImage。

在客户端的缩写代码中：

```
public String writeAndReadSocket(String request) {
    // Write text to the socket
    BufferedWriter bufferedWriter = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream()));
    bufferedWriter.write(request);
    bufferedWriter.flush();

    // Read text from the socket
    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));

    // Read the prefixed size
    int size = Integer.parseInt(bufferedReader.readLine());

    // Get that many bytes from the stream
    char[] buf = new char[size];
    bufferedReader.read(buf, 0, size);
    return new String(buf);
}

public BufferedImage stringToBufferedImage(String imageBytes) {
    return ImageIO.read(new ByteArrayInputStream(s.getBytes()));
} 
```

和服务器：

```
# Twisted server code here

# The analog of the following method is called with the proper client
# request and the result is written to the socket.
def worker_thread():
    img = draw_function()
    buf = StringIO.StringIO()
    img.save(buf, format="PNG")
    img_string = buf.getvalue()
    return "%i\r%s" % (sys.getsizeof(img_string), img_string) 
```

这适用于发送和接收字符串，但图像转换（通常）失败。**我试图理解为什么图像没有被正确读取。**我最好的猜测是客户端没有读取正确的字节数，但老实说我不知道​​为什么会这样。

**旁注：**

*   我意识到 char[]-to-String-to-bytes-to-BufferedImage Java 逻辑是迂回的，但是直接读取字节流会产生相同的错误。
*   我有一个版本，其中客户端套接字不是持久的，即。处理请求并断开连接。该版本工作正常，因为我不需要关心图像大小，但我想了解*为什么*建议的方法不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:16:29.130

1.  `BufferedReader.read()`不能保证填充缓冲区，并且将图像转换为字符串并返回不仅没有意义而且是错误的。

2.  字符串不是二进制数据的容器，并且不能保证往返工作。

最好重新设计协议，这样您就可以摆脱`readLine()`，并以二进制形式发送长度，并且可以使用`DataInputStream`.

一般来说，在处理二进制协议时，答案总是`DataInputStream`and `DataOutputStream`，除非字节顺序不是规范的网络字节顺序，这是一个协议设计错误，在这种情况下你需要查看 byte-ordered `ByteBuffers`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:20:01.980

在服务器代码中，您的使用`sys.getsizeof`是错误的。这将返回字节串对象的大小，而您想要的是字节串中的字节数，即它的长度`len(img_string)`。

此外，在客户端代码中，该`.readLine`方法读取字符，直到它看到`'\r'`可能跟随`'\n'`或`'\n'`，因此`'\r'`如果图像数据的第一个字节恰好是 0x0A，即 0x0A，则用作终止符将导致问题`'\n'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T22:29:58.590

我预计问题在于您正在尝试使用 a`Reader`并`getBytes()`读取二进制数据（图像）。

`Reader`堆栈将从底层套接字流中获取字节，将它们转换为字符（使用平台的默认字符编码），并将它们作为字符串返回。然后再次使用默认编码将字符串内容转换回字节。对于二进制数据，字节到字符的初始转换可能是“有损”的。

解决方法是不使用`Reader`/ `BufferedReader`。使用一个`InputStream`和一个`BufferedInputStream`。通过发送编码为文本的图像大小并不能让自己变得容易，但是您可以通过一次读取一个字节直到获得换行符并将它们“手动”转换为整数来处理它。

（如果大小以“网络顺序”作为固定大小的二进制整数发送，您可以`DataInputStream`改用...）

# performance - 编写页眉和页脚、“全局”页眉/页脚或“本地”页眉和页脚的最有效方法是什么？

> ID：11005452
> 
> 赞同：0
> 
> 时间：2012-06-12T21:54:26.203
> 
> 标签：performance, header, logic, httprequest, footer

我即将开始编写网站代码，因为这是我第一次为网页编写代码，所以我一直想知道一些事情。
编写单独的 header.php 和 footer.php 可能是最快和最简单的方法。
问题是，如果某些页面我想使用特定的 javascript 文件和代码，而某些我想使用其他页面怎么办？
这将导致更多的 HTTP 请求，并最终影响站点的性能。
我考虑过在标题中使用 if 语句，只为每个页面提供它所需要的内容，仅此而已。

但是哪种方式更**有效**？：
编码全局 header.php 和 footer.php 文件并使用 if 语句分隔代码或将整个页眉+页脚代码添加到每个文件（即本地页眉/页脚）？

PS 全局和本地页眉/页脚是我刚编出来的，不知道怎么称呼它，哈哈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:01:22.567

您的“全局”页眉和页脚的优点是 1）它们是一致的并且更改是“全局的”并且 2）它们包含在服务器代码的页面中。因此，如果您在服务器端进行包含，则不会有很多 HTTP 流量。

如果可能的话，您可以（并且应该）在服务器端使用确定在请求时加载什么的逻辑来执行特定于页面的包含。

还有其他方法可以实现这一点，但直接使用 PHP，您正在考虑的是最好的方法。

如果你使用的是 Yii 之类的框架，你可以在布局中做这种事情，但是使用简单的 PHP，你就走在了正确的轨道上。

在每个页面（本地）中定义页眉和页脚，会导致您重复大量代码并导致后续维护问题。您有很多页面要更新以进行简单的页眉/页脚更改。

# c# - Actionscript 3 相当于 XNA ElapsedGameTime

> ID：11005453
> 
> 赞同：1
> 
> 时间：2012-06-12T21:54:35.160
> 
> 标签：c#, actionscript-3, xna, flashdevelop

我通常使用 XNA 开发游戏，使用 XNA 时要做的一件常见事情是确保根据 ElapsedGameTime 更新每个实体。即使在可变帧速率下，这也允许平滑移动。

我正在使用 FlashDevelop 在 AS3 中寻找该功能。

到目前为止，我想出了：

```
public function Update():void
{
    var currentTime:Number = getTimer();
    var elapsedTime:Number = currentTime - lastFrame;
    elapsedTime /= 1000;

    //use elapsedTime here for movement
    player.x += speed.x * elapsedTime

    lastFrame = getTimer();
} 
```

使用它，我无法真正判断它是否真的有效。当我实现这个时，我真的看不出有什么区别。

这是相似的吗？还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:42:05.243

如果是这种情况，您可能会发现使用 this 与使用 enter_frame 处理程序没有区别在 1/24 秒（默认 frameRate 为 24）。测试差异的一种方法是修改 frameRate 属性并查看“角色”的速度是否受到 frameRate 变化的影响。您还可以使用 trace(elapsedTime) 之类的跟踪语句，您还可以添加一个 enter_frame 事件处理程序并跟踪帧并跟踪它，以便更好地了解它的执行方式以及它产生的任何差异。这似乎是一个完全有效的方法，虽然我没有'

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/Application.html#frameRate](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/Application.html#frameRate)

如果使用纯 AS3，您将使用主类上的元数据进行设置，例如：

[http://flassari.is/2009/02/swf-metadata-in-pure-as3-projects/](http://flassari.is/2009/02/swf-metadata-in-pure-as3-projects/)

[http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf680e1-7ffe.html#WS4b4ddee4904fe7796d38fa291219d46bcb4-8000](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf680e1-7ffe.html#WS4b4ddee4904fe7796d38fa291219d46bcb4-8000)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T08:20:06.563

您可以尝试使用 Timer Class 而不是 ENTER_FRAME

```
var myTimer:Timer = new Timer(1000, 1); // (ms, repeats = set to 0 for infinity)
myTimer.addEventListener(TimerEvent.TIMER, runOnce);
myTimer.start();

function runOnce(event:TimerEvent):void {
    trace("runOnce() called @ " + getTimer() + " ms");
}

var myTimer:Timer = new Timer(1000); // (ms)
myTimer.addEventListener(TimerEvent.TIMER, runMany);
myTimer.start();

function runMany(event:TimerEvent):void {
    trace("runMany() called @ " + getTimer() + " ms");
} 
```

# python-3.x - 如何删除/删除 virtualenv？

> ID：11005457
> 
> 赞同：643
> 
> 时间：2012-06-12T21:54:54.767
> 
> 标签：python-3.x, virtualenvwrapper, python-venv, virtual-environment, virtualenv-commands

我使用以下命令创建了一个环境：`virtualenv venv --distribute`

我无法使用以下命令将其删除：`rmvirtualenv venv`- **这是 virtualenvwrapper 的一部分，[如](http://virtualenvwrapper.readthedocs.io/en/latest/command_ref.html#rmvirtualenv)下面[的 virtualenvwrapper 回答中所述](https://stackoverflow.com/a/18624789/452708)**

我`ls`在当前目录上做了一个，我仍然看到 venv

我可以删除它的唯一方法似乎是：`sudo rm -rf venv`

请注意，环境未激活。我正在运行 Ubuntu 11.10。有任何想法吗？我试过重新启动我的系统无济于事。

* * *

## 回答 #1

> 赞同：609
> 
> 时间：2012-06-12T21:58:56.483

> "*The only way I can remove it seems to be: `sudo rm -rf venv`*"

That's it! There is no command for deleting your virtual environment. Simply deactivate it and rid your application of its artifacts by recursively removing it.

Note that this is the same regardless of what kind of virtual environment you are using. `virtualenv`, `venv`, Anaconda environment, `pyenv`, `pipenv` are all based the same principle here.

* * *

## 回答 #2

> 赞同：185
> 
> 时间：2013-09-04T22:23:57.337

只是为了呼应@skytreader 之前的评论，`rmvirtualenv`是由`virtualenvwrapper`, not提供的命令`virtualenv`。也许你没有`virtualenvwrapper`安装？

有关详细信息，请参阅[VirtualEnvWrapper 命令参考。](http://virtualenvwrapper.readthedocs.org/en/latest/command_ref.html)

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2016-10-24T05:16:42.853

利用`rmvirtualenv`

删除环境，在`$WORKON_HOME`.

句法：

```
rmvirtualenv ENVNAME 
```

在删除当前环境之前，您必须使用 deactivate。

```
$ rmvirtualenv my_env 
```

参考：http: [//virtualenvwrapper.readthedocs.io/en/latest/command_ref.html](http://virtualenvwrapper.readthedocs.io/en/latest/command_ref.html)

* * *

## 回答 #4

> 赞同：103
> 
> 时间：2016-05-11T06:11:29.743

您可以通过递归卸载所有依赖项来删除所有依赖项，然后删除 venv。

**编辑**包括艾萨克·特纳的评论

```
source venv/bin/activate
pip freeze > requirements.txt
pip uninstall -r requirements.txt -y
deactivate
rm -r venv/ 
```

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2019-05-07T10:06:13.277

如果您使用的是 pyenv，则可以删除您的虚拟环境：

```
$ pyenv virtualenv-delete <name> 
```

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2016-09-21T18:16:21.207

只需从系统中删除虚拟环境。没有特殊的命令

```
rm -rf venv 
```

* * *

## 回答 #7

> 赞同：38
> 
> 时间：2018-03-03T12:27:34.623

来自 virtualenv 的官方文档[https://virtualenv.pypa.io/en/stable/userguide/](https://virtualenv.pypa.io/en/stable/userguide/)

> # 删除环境
> 
> 删除虚拟环境只需将其停用并删除环境文件夹及其所有内容即可：
> 
> ```
> (ENV)$ deactivate
> $ rm -r /path/to/ENV 
> ```

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2020-08-13T16:59:21.900

### 1.移除Python环境

没有删除 virtualenv 的命令，因此您需要手动执行此操作，`deactivate`如果您打开它并删除文件夹，则需要这样做：

```
deactivate
rm -rf <env path> 
```

### 2\. 创建环境。使用另一个 Python 版本

当您创建环境时，python 默认使用当前版本，因此如果您想要另一个环境，则需要在创建时指定。制作和环境。使用 Python 3.X`MyEnv`只需键入：

```
python3.X -m venv MyEnv 
```

现在使用 Python 2.X`virtualenv`代替`venv`：

```
python2.X -m virtualenv MyEnv 
```

### 3.列出我机器上的所有Python版本

如果前面的任何代码行都不起作用，您可能没有安装特定版本。首先列出您的所有版本：

```
ls -ls /usr/bin/python* 
```

如果您没有找到它，请使用以下命令安装 Python 3.X `apt-get`：

```
sudo apt-get install python3.X 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2017-12-19T00:32:11.383

我`pyenv uninstall my_virt_env_name`以前删除了虚拟环境。

注意：我使用的是通过安装脚本安装的 pyenv-virtualenv。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2018-10-25T16:58:49.740

以下命令对我有用。

```
rm -rf /path/to/virtualenv 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2019-03-08T22:37:32.487

如果您是 Windows 用户，并且在 Anaconda 提示符下使用 conda 管理环境，您可以执行以下操作：

确保停用虚拟环境或重新启动 Anaconda Prompt。使用以下命令删除虚拟环境：

```
$ conda env remove --name $MyEnvironmentName 
```

或者，您可以前往

```
C:\Users\USERNAME\AppData\Local\Continuum\anaconda3\envs\MYENVIRONMENTNAME 
```

（这是默认文件路径）并手动删除该文件夹。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2021-03-10T00:47:28.443

实际上需要两次删除。

该线程中的每个人都已经说过您只需手动删除或使用的项目文件夹`rm -r projectfoldername`

但是您还需要删除位于 macOS 中的实际 virtualenv `/Users/edison/.pyenv/versions/3.8.0/envs/myspecialenv`。

您可以通过执行`pyenv virtualenv-delete myspecialenv`或手动删除来做到这一点。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-04-01T11:35:56.580

如果您是 Windows 用户，则它位于 C:\Users\your_user_name\Envs 中。您可以从那里删除它。

也可以在命令提示符 rmvirtualenv 环境名称中尝试。

我尝试使用命令提示符，所以它说已删除，但它仍然存在。所以我手动删除它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-07-03T11:34:47.117

如果您是 Windows 用户，您还可以通过以下方式删除环境：`C:/Users/username/Anaconda3/envs` 在这里您可以看到虚拟环境列表并删除您不再需要的环境。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-11-11T00:31:34.483

`deactivate`是您要查找的命令。就像已经说过的那样，没有删除虚拟环境的命令。只需停用它！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-05-14T12:59:50.517

您可以按照以下步骤删除与 virtualenv 关联的所有文件，然后再次重新安装 virtualenv 并使用它

```
cd {python virtualenv folder}

find {broken virtualenv}/ -type l                             ## to list out all the links

deactivate                                           ## deactivate if virtualenv is active

find {broken virtualenv}/ -type l -delete                    ## to delete the broken links

virtualenv {broken virtualenv} --python=python3           ## recreate links to OS's python

workon {broken virtualenv}                       ## activate & workon the fixed virtualenv

pip3 install  ... {other packages required for the project} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-24T19:48:09.963

cd \environmentfolder_name\Scripts\deactivate.bat

[![在此处输入图像描述](../Images/05d1249042d480b3157b2c3f939acdc4.png)](https://i.stack.imgur.com/7NgrE.png)

* * *

## 回答 #18

> 赞同：-9
> 
> 时间：2019-02-25T12:52:09.797

步骤1：通过复制并粘贴以下命令来删除virtualenv virtualenvwrapper：

```
$ sudo pip uninstall virtualenv virtualenvwrapper 
```

第 2 步：转到 .bashrc 并删除所有 virtualenv 和 virtualenvwrapper

打开终端：

```
$ sudo nano .bashrc 
```

向下滚动，您将看到下面的代码，然后将其删除。

```
# virtualenv and virtualenvwrapper
export WORKON_HOME=$HOME/.virtualenvs
export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3
source /usr/local/bin/virtualenvwrapper.sh 
```

接下来，获取 .bashrc：

```
$ source ~/.bashrc 
```

最后步骤：没有终端/外壳转到/ home并查找`.virtualenv`（我忘记了名称，所以如果您的查找类似于`.virtualenv`或`.venv`只是删除它。那会起作用。

# c++ - 定义接收指向其他类成员函数的指针的成员函数模板添加应用函数

> ID：11005459
> 
> 赞同：0
> 
> 时间：2012-06-12T21:55:03.317
> 
> 标签：c++

我有一个`A`有成员变量的类`vector<B>`。我想定义一个名为的函数模板`DoToAll(funcPtr)`，它将迭代所有向量并应用该函数。

```
class A 
{
vector<B> v;
template <?????>
void DoToAll(f);
loop on v and apply the member function f;
}

class B{
void f1();
void f2();
.
.
.
} 
```

我该怎么写`DoToAll`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:58:46.913

Do you insist that the argument must be a function pointer? Otherwise, it could be just

```
template <class F>
void DoToAll(F f) {
  std::for_each(v.begin(), v.end(), f);
} 
```

That works for every `f` st. `f(x)`, where `x` is an element of the vector, is valid. That means function pointers and functors such as `std::function` and `std::bind` are all right. Unfortunately, that doesn't include member function pointers, since you call them `x->*f()`, not `f()`. But that is possible to overcome, too, by wrapping the member function pointer into a functor that would correctly forward the call. The standard already provides such adapters, the one appropriate for you would be [`mem_fun_ref_t`](http://www.cplusplus.com/reference/std/functional/mem_fun_ref/). You could add an overload of `DoToAll` that takes function pointers:

```
template <class This, class Ret>
void DoToAll(Ret (*This::f)()) {
  std::for_each(v.begin(), v.end(), std::mem_fun_ref(f));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T23:46:01.457

如果在这里只使用函数，则根本不需要模板。

```
void DoToAll(void (*f)(B&)) { /*...*/ } 
```

所以你可以写这样的东西

```
void Change(const B& what)
{
    what.ChangeSomething();
}
//...
a.DoToAll(Change) // or a.DoToAll(&Change) 
```

# c# - 为什么 Form1 中的 label2.Text 没有从新类更新？

> ID：11005463
> 
> 赞同：1
> 
> 时间：2012-06-12T21:55:07.573
> 
> 标签：c#

在 Form1 中，我在设计器中有 label2，我添加了一个代码：

```
public void lbl2(string text)
        {
            label2.Text = text;
        } 
```

在新的班级顶部，我添加了：

```
private static AnimationEditor.Form1 fr1 = new AnimationEditor.Form1(); 
```

在新的类事件中，我像这样更新 label2.Text：

```
int ISampleGrabberCB.BufferCB(double sampleTime, IntPtr pBuffer, int bufferLen)
        {
            using (var bitmap = new Bitmap(_width, _height, _width * 3, PixelFormat.Format24bppRgb, pBuffer))
            {
                bitmap.RotateFlip(RotateFlipType.Rotate180FlipX);
                if (SaveToDisc)
                {
                    String tempFile = _outFolder + _frameId + ".bmp";
                    if (File.Exists(tempFile))
                    {
                        fr1.lbl2(_frameId.ToString();
                    }
                    else
                    {
                        bitmap.Save(Path.Combine(_outFolder, _frameId + ".bmp"));
                    }
                    _frameId++;
                }
                else
                {
                    if (Images == null)
                        Images = new List<Bitmap>();
                    Images.Add((Bitmap)bitmap.Clone());
                }
            }
            return 0;
        } 
```

正在更新的线程是：

```
fr1.lbl2(_frameId.ToString(); 
```

现在我在新类的这一行以及公共函数的 label2.Text 上的 Form1 中使用了断点，我看到 label2 文本首先更改它的 0，然后是 1，然后是 2，依此类推。

但实际上，当我实时运行应用程序时，label2 会一直将其更改为 label2 的文本

这是当我单击它执行新类代码时的 Form1 按钮单击事件：

```
private void button5_Click(object sender, EventArgs e)
        {
            wmv = new Polkan.DataSource.WmvAdapter(@"d:\VIDEO0040.3gp", sf);
            wmv.SaveToDisc = true;
            wmv.Start();
            wmv.WaitUntilDone();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:10:09.083

我认为快速的答案是将标签的引用传递给类：

```
private Label lbl;

public WmvAdapter(string file, string outFolder, Label label) {
  // yada-yada-yada
  lbl = label;
} 
```

您的例程将更改为：

```
if (File.Exists(tempFile))
{
  lbl.Text = _frameId.ToString();
} 
```

您的点击事件：

```
private void button5_Click(object sender, EventArgs e)
{
  wmv = new Polkan.DataSource.WmvAdapter(@"d:\VIDEO0040.3gp", sf, this.Label2);
  wmv.SaveToDisc = true;
  wmv.Start();
  wmv.WaitUntilDone();
} 
```

更长的答案是让你的班级引发一个事件并让你的表单监听它。

让您的班级了解表格并不是最佳的编码实践。

# javascript - 用 html 将字符串分隔成两个字符串

> ID：11005464
> 
> 赞同：2
> 
> 时间：2012-06-12T21:55:23.557
> 
> 标签：javascript, jquery

我正在尝试将其中包含 html 和非 html 的字符串分成两个字符串。

我的javascript字符串是：

```
<span>1x</span> Front-line zero tolerance productivity 
```

我希望将其分为两个变量

```
var quantity = "1x";
var name = "Front-line zero tolerance productivity"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:00:53.000

`<span>`找到或`</span>`标记时拆分。

```
string = "<span>1x</span> Front-line zero tolerance productivity"

tokens = string.split(/<\/?span>/);  // returns ["", "1x", " Front-line zero tolerance productivity"]
var quantity = tokens[1]  // "1x"
var name = tokens[2];     // "Front-line zero tolerance productivity" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T22:07:02.207

鉴于您将始终拥有这种类型的标记，最简单的方法是使用[jQuery 。`contents()`](http://api.jquery.com/contents/)

**HTML**

```
<div id="split-me">
    <span>1x</span> Front-line zero tolerance productivity
</div> 
```

**jQuery**

```
var $contents = $("#split-me").contents();
var quantity = $contents.eq(1).text();
var name = $contents.eq(2).text(); 
```

[**例子**](http://jsfiddle.net/xnrNB/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T22:00:12.147

假设它`<span>1x</span> Front-line zero tolerance productivity`被包裹在一个像下面这样的 div 中，

```
<div id="test">
    <span>1x</span> Front-line zero tolerance productivity
</div> 
```

**JS：**

```
var $clonedTest = $('#test').clone();
var $span = $clonedTest.find('span');
var quality = $span.text();
$span.remove();
var name = $.trim($clonedTest.text()); 
```

**演示：http:** [//jsfiddle.net/skram/Agfyk/2/](http://jsfiddle.net/skram/Agfyk/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T22:10:58.707

这可能不是很优雅，但您可以`.replace()`为第二个 var 使用 javascript 函数，例如：

```
$(document).ready(function(){
    $('#outp').html('first: ' + $('#inp span').html() + '<br/>' +
                    'second: ' + $('#inp').html().replace($('#inp span').html(),''));
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T22:15:57.960

这是一个更加动态和模块化的功能，可以获取您想要的所有潜文本块

```
jQuery.fn.extend({
    texts: function() {
        var texts = [];
        var blocks = this.contents();
        $.each(blocks, function(i, block) {
            if(block.nodeName === '#text') {
                var data = $.trim(block.data);
                data && texts.push(data);
            } else {
                texts = jQuery.merge(texts, $(block).texts());
            }
        });
        return texts;
    }
});

$(function() {
    console.debug($('<span><span>1x</span> Front-line zero tolerance productivity</span>').texts());            
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T21:59:43.750

Since the format of the string won't change, you can split on the first space to get the two parts. Then remove tags from the first returned element, and preserve the structure of the second half:

```
var str = "<span>1x</span> Front-line zero tolerance productivity";
var ndx = str.indexOf(" ");
var rst = []; // Array of results

rst.push( str.substr( 0,ndx ).replace(/<\/?.+?>/g,"") );
rst.push( str.substr( ndx+1 ) ); 
```

Which results in the following array:

```
["1x", "Front-line zero tolerance productivity"] 
```

Fiddle: [http://jsfiddle.net/jonathansampson/dBTKZ/](http://jsfiddle.net/jonathansampson/dBTKZ/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-12T22:37:20.680

```
<div class="container">
    <span>1x</span> Front-line zero tolerance productivity
</div>

<script type="text/javascript">
var matches = $('.container').html().match(/<span>(.*)<\/span> ?(.*)/);

var spanText = matches[1];   // 1x
var textNode = matches[2];   // Front-line zero tolerance productivity
</script> 
```

# macos - 在 Mac OS X 上安装基于 fortran 的 R 包

> ID：11005465
> 
> 赞同：1
> 
> 时间：2012-06-12T21:55:25.053
> 
> 标签：macos, r, linker, fortran

我正在尝试`cts`在 OS X 上从 CRAN 安装 1.10 版软件包，但遇到了一些链接器问题。我需要从源代码安装，因为我正在对源代码进行一些更改（实际上，`cts`作者 Zhu Wang 进行了更改并向我发送了新的 tarball - 但同样的问题也发生`cts`在 CRAN 上的库存源代码中）。

它似乎可以很好地编译所有源代码，但是在链接过程中失败并出现以下错误：

```
> install.packages('~/Downloads/cts_1.0-11.tar.gz', .libPaths()[1], repos=NULL, type='source')
* installing *source* package ‘cts’ ...
** libs
*** arch - i386
gfortran-4.2 -arch i386   -fPIC  -g -O2 -c a9rntc.f -o a9rntc.o
gfortran-4.2 -arch i386   -fPIC  -g -O2 -c a9rntd.f -o a9rntd.o
gfortran-4.2 -arch i386   -fPIC  -g -O2 -c a9rnti.f -o a9rnti.o
[bunch of other compilation lines snipped ...]
gfortran-4.2 -arch i386   -fPIC  -g -O2 -c u9dmp.f -o u9dmp.o
gfortran-4.2 -arch i386   -fPIC  -g -O2 -c update.f -o update.o
gcc-4.2 -arch i386 -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/lib -o cts.so a9rntc.o a9rntd.o a9rnti.o a9rntl.o a9rntr.o balanc.o balinv.o cinvert.o complete.o cspec.o d1mach.o d1rply.o d2rply.o d3rply.o d4rply.o d5rply.o d6rply.o d7rply.o d8rply.o d9rply.o dgetrf.o dgetrs.o display.o dpca.o drpoly.o e9rint.o envirn.o eprint.o fdump.o forecast.o frmatd.o frmati.o frmatr.o getmin.o hqrort.o i0tk00.o i10wid.o i1mach.o i8save.o iceil.o iflr.o isamax.o istkgt.o istkqu.o istkrl.o kfilsm.o kfilsm1.o loop.o lybsc.o lycsr.o mepad.o mutil.o newline.o orthes.o ortran.o rejuce.o repar.o resg0.o resg0new.o resg1d.o resg1dpre.o resg1dpre1.o resgen.o revg1.o roots.o s88fmt.o saxpy.o sdata.o sdot.o sdump.o search.o setcom.o seterr.o setfor.o setkfilsm.o setup1.o setupdate.o simi.o sscal.o stkdmp.o store.o u9dmp.o update.o -L/Library/Frameworks/R.framework/Resources/lib/i386 -lRlapack -L/Library/Frameworks/R.framework/Resources/lib/i386 -lRblas -lgfortran -lgfortran -F/Library/Frameworks/R.framework/.. -framework R -Wl,-framework -Wl,CoreFoundation
ld: warning: can't find atom for N_GSYM stabs mdeps:G(0,10)=s32base:(0,6),0,64;big:(0,6),64,64;small:(0,6),128,64;eps:(0,6),192,64;; in balanc.o
ld: warning: can't find atom for N_GSYM stabs base:G(0,6) in balanc.o
ld: warning: can't find atom for N_GSYM stabs setcon:G(0,3)=s252cso:(0,4)=r(0,2);8;0;,0,64;csz:(0,4),64,64;lam:(0,4),128,64;ssold:(0,4),192,64;gmold:(0,4),256,64;gmnew:(0,4),320,64;sigsq:(0,4),384,64;oldb:(0,5)=ar(0,2);0;21;(0,4),448,1408;conv:(0,6)=@s32;-16;,1856,32;fail:(0,6),1888,32;np:(0,2),1920,32;itct:(0,2),1952,32;ppind:(0,2),1984,32;; in cinvert.o
ld: warning: can't find atom for N_GSYM stabs cso:G(0,4) in cinvert.o
ld: warning: can't find atom for N_GSYM stabs resgn2:G(0,7)=s59364wk:(0,8)=ar(0,2);0;19;(0,4),0,1280;vt:(0,9)=ar(0,2);0;4999;(0,4),1280,320000;bi:(0,10)=ar(0,2);0;799;(0,4),321280,51200;r:(0,11)=ar(0,2);0;799;(0,4),372480,51200;ri:(0,12)=ar(0,2);0;799;(0,4),423680,51200;errno1:(0,2),474880,32;; in cinvert.o
ld: warning: can't find atom for N_GSYM stabs wk:G(0,8) in cinvert.o
ld: in cinvert.o, sectionForAddress(0xE7F0) address not in any section for architecture i386
collect2: ld returned 1 exit status
make: *** [cts.so] Error 1
ERROR: compilation failed for package ‘cts’
* removing ‘/Users/ken/R-dev/cts’
* restoring previous ‘/Users/ken/R-dev/cts’
Warning message:
In install.packages("~/Downloads/cts_1.0-11.tar.gz", .libPaths()[1],  :
  installation of package ‘/Users/ken/Downloads/cts_1.0-11.tar.gz’ had non-zero exit status 
```

有没有我应该传递给的编译/链接标志`install.packages()`，也许？CRAN 二进制构建机器使用哪些选项？

# java - 与 Java System.Time 混淆

> ID：11005470
> 
> 赞同：1
> 
> 时间：2012-06-12T21:55:48.083
> 
> 标签：java, time

预先感谢您的帮助。我正在开发一个基于 java 的工具，它正在执行一些数据库工作。我有一个非常简单的问题。由于某种原因，报告的完成任务的时间不正确。

```
public static void makeDatabaseThreaded() throws IOException, InterruptedException {        
    final long startTime = System.nanoTime();       

    ArrayList<String> tablesMade = new ArrayList<>();
    File rootDirectory = root;
    String[] files = rootDirectory.list();
    double percentDone = 0;
    double numOfTablesMade = 0;
    double numberOfTables = 62.0;
    DatabaseBuilderThread lastThread = null;
    for (int i = 0; i <= files.length - 1; i++) {

        if (!files[i].contains(".csv")) {
            continue;
        }
        File file = new File(rootDirectory + File.separator + files[i]);

        String tableName = getTableNameFromFile(file);
        if (!tablesMade.contains(tableName)) {
            tablesMade.add(tableName);

            DatabaseBuilderThread thread = new DatabaseBuilderThread(i, file);
            lastThread = thread;
            thread.start();
            threadsRunning++;

            numOfTablesMade++;
            percentDone = (int) (100.0 * (numOfTablesMade) / (numberOfTables));

            while (threadsRunning > 10) {
                Thread.sleep(1000);
            }
            System.out.println(percentDone + "% done. Making Table For File: "  + file.getName());
        }
    }

    //Make Sure all threads are done
    lastThread.join();

    final long endTime = System.nanoTime();
    final long duration = endTime - startTime;
    Time time = new Time(duration);
    System.out.println("Done Making The Database. It took " + time.toString());
} 
```

该程序报告说，它对我运行的案例的实际工作时间大约是实际工作时间的两倍。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T21:58:18.010

System.nanoTime() returns time values in nanoseconds. Time() takes a value in milliseconds as a parameter. This would throw your time value off by a factor of 10^-6.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T21:58:50.927

`Time` takes milliseconds as a constructor parameter, where as `nanoTime()` gives you nanoseconds precision, could that be the problem?

discussion here: [System.currentTimeMillis vs System.nanoTime](https://stackoverflow.com/questions/351565/system-currenttimemillis-vs-system-nanotime)

# jdbc - Hue Hive -- Beeswax 服务器找不到 MySQL 的 JDBC 驱动程序

> ID：11005472
> 
> 赞同：3
> 
> 时间：2012-06-12T21:56:00.787
> 
> 标签：jdbc, hadoop, hive, cloudera, hue

我们正在使用 Cloudera 3.7.5，并且很难配置 Beeswax 服务器，以便 Hue 可以访问 Hive 数据库。我按照 Cloudera 文档中的所有说明将 MySQL 设置为 Hive 的元存储，但是当我重新启动 Hue 服务并检查 Beeswax 服务器的 StdErr 日志时，我仍然看到痛苦的“javax.jdo.JDOFatalInternalException：创建事务连接工厂时出错“这是由

```
org.datanucleus.exceptions.NucleusException: Attempt to invoke the "DBCP" plugin to create a ConnectionPool gave an error : The specified datastore driver ("com.mysql.jdbc.Driver") was not found in the CLASSPATH. Please check your CLASSPATH specification, and the name of the driver. 
```

这对我来说很奇怪，因为日志还表明环境变量 HIVE_HOME 等于“/usr/lib/hive”，果然我已经复制了“mysql-connector-java-5.1.15-bin.jar”按照文档的指示，进入 /usr/lib/hive/lib 目录。

我还尝试了博客文章[http://hadoopchallenges.blogspot.com/2011/03/hue-120-upgrade-and-beeswax.html](http://hadoopchallenges.blogspot.com/2011/03/hue-120-upgrade-and-beeswax.html)上的说明，其中涉及将 mysql-connector jar 复制到“/usr/共享/色调/应用程序/蜂蜡/hive/lib/”。不幸的是，我在蜂蜡文件夹中没有 hive/lib 子目录，所以我尝试制作一个。这也没有奏效。

有什么建议可以让我将 MySQL JDBC 库放到 Beeswax 的类路径中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T18:36:22.910

我们最终决定硬着头皮去`upgrade to CDH4`。将 JDBC jar 放入`/usr/share/hive/lib`其中可以让 Beeswax 服务器完美运行而不会出现问题。

如果其他人遇到此问题**，我建议从 CDH3 升级到 CDH4**，UI 更干净、更流畅，并且安装和维护错误更少`CDH4`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T05:29:14.573

您必须将 mysql 连接器粘贴到 HUE_HOME/apps/beeswax/hive/lib 中。如果此路径不存在，请创建 hive/lib，然后粘贴 mysql 连接器。我希望你的问题能得到解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T15:35:36.347

当您开始使用 cloudera 4.5 时，它们会将所有内容都移动到包裹中，因此我的配置单元元服务器上的这个确切问题已通过此命令（如下）修复。本质上，您只是重新添加模块。我相信您可以修改 hive 配置文件中的额外类路径，以使其忽略包裹更新。

```
cp /usr/lib/hive/lib/mysql-connector-java-5.1.17-bin.jar /opt/cloudera/parcels/CDH-4.2.0-1.cdh4.2.0.p0.10/lib/hive/lib/. 
```

所以真正的修复可能是这样的：

```
 cp `locate mysql-connector | grep jar | head -n 1` /opt/cloudera/parcels/*/lib/hive/lib/. 
```

这会将罐子复制到每个包裹中。

# gnuplot - 如何在 gnuplot 中设置 pngcairo 终端？

> ID：11005473
> 
> 赞同：3
> 
> 时间：2012-06-12T21:56:09.180
> 
> 标签：gnuplot, cairo

我和[这个问题](https://stackoverflow.com/questions/10496469/how-do-i-enable-the-pngcairo-terminal-in-gnuplot)有同样的问题。我尝试使用命令安装 libcairo 库

```
sudo yum install cairo-devel 
```

之后，我通过 yum 删除并安装了 gnuplot。我仍然得到同样的错误。我还需要做什么才能让 gnuplot 让我使用 pngcairo？

我还通过 yum 安装了 pango。

当我尝试从源代码安装 gnuplot 时，我在 config.log 中收到这些消息：

```
configure:11776: checking for CAIROPANGO
configure:11784: $PKG_CONFIG --exists --print-errors "cairo >= 0.9.0 pango >= 1.10 pangocairo >= 1.10"
Package pango was not found in the pkg-config search path.
Perhaps you should add the directory containing `pango.pc'
to the PKG_CONFIG_PATH environment variable
No package 'pango' found
Package pangocairo was not found in the pkg-config search path.
Perhaps you should add the directory containing `pangocairo.pc'
to the PKG_CONFIG_PATH environment variable
No package 'pangocairo' found 
```

我究竟要向 PKG_CONFIG_PATH 添加什么？我什至不确定在哪里可以找到我安装的 pango 和 cairo-devel 库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T18:24:58.847

pango 只提供运行时库。对于开发文件，您需要安装*pango-devel*：

```
$ sudo yum install pango-devel 
```

如果对包名称有疑问，请使用：

```
$ sudo yum search foo 
```

其中*foo*是您要查找的内容。*yum*将搜索名称、描述等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T12:48:24.540

libcairo 功能在 gnuplot 4.4 或更高版本中默认可用。gnuplot44 包可以在 epel 存储库中找到：[https ://fedoraproject.org/wiki/EPEL](https://fedoraproject.org/wiki/EPEL)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-27T21:39:27.083

在编译之前，为基于 cairo 的终端安装依赖库，比如 pdfcairo，

```
sudo apt-get install libcairo2-dev
sudo apt-get install libpango1.0-dev 
```

* * *

安装 gnuplot 5.0.1 的完整步骤：

[从这里](http://sourceforge.net/projects/gnuplot/files/)下载源文件，然后：

```
#decompress it:
tar -xvf gnuplot-5.0.1.tar.gz

#install the dependency libraries for cairo-based terminals, like pdfcairo
sudo apt-get install libcairo2-dev
sudo apt-get install libpango1.0-dev

#build it:
cd gnuplot-5.0.1 
./configure 
make

#install it:
sudo make install 
```

# r - 如何在 emacs-ess 中从 R 中访问 bash 环境变量

> ID：11005478
> 
> 赞同：7
> 
> 时间：2012-06-12T21:56:26.190
> 
> 标签：r, bash, emacs, environment-variables, ess

在我的 .bashrc 中，我有一行：

```
export SETTINGS=/home/user/settings.xml 
```

如果我在 bash 中加载 R，我可以使用以下`Sys.getenv`函数访问此变量：

```
Sys.getenv("SETTINGS")
"/home/user/settings.xml" 
```

如果我在 Emacs (Mx R) 中打开 R，则 SETTINGS 为空：

```
Sys.getenv("SETTINGS")
"" 
```

我试过的：

1.  根据 [如何使 Emacs 识别 bash 环境变量进行编译，将以下内容添加到 .emacs？](https://stackoverflow.com/questions/9663396/how-do-i-make-emacs-recognize-bash-environment-variables-for-compilation)

    ```
    ;; get environment vars from .bashrc
    (let ((path (shell-command-to-string ". ~/.bashrc; echo -n $SETTINGS")))
      (setenv "SETTINGS" path)) 
    ```

2.  使用在 emacs 中打开 bash`M-x term`

    ```
    echo $SETTINGS         # works
    R
    Sys.getenv("SETTINGS") #works 
    ```

3.  如果我从终端打开 emacs，则 SETTINGS 变量可以按预期使用。从“应用程序”菜单（使用命令`/usr/bin/emacs23 %F`或`emacs`）打开 emacs 不起作用。

4.  比较`session("env")`在 bash 和 emacs 中加载 R 时的输出，但除了 (bash = <, emacs = >) 之外没有什么特别突出的：

    ```
    > INSIDE_EMACS=23.3.1,comint
    6d5
    < SETTINGS=/home/user/settings.xml
    9c8
    < SHLVL=1
    > SHLVL=0
    14a14
    > PAGER=cat
    16d15
    < PAGER=/usr/bin/pager
    19d17
    < COLORTERM=gnome-terminal
    25c23
    < WINDOWID=14680069
    > DESKTOP_AUTOSTART_ID=1020ce948b944a88113395253627645060000001863000
    < TERM=xterm
    > TERM=dumb 
    ```

我也可以吗

1.  在 emacs-ess 中从 R 中访问 SETTINGS
2.  将设置导出到我可以访问的地方？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:43:52.527

我不知道 R 和自定义环境变量，但我将 emacs 中的 PATH 变量设置为与我的 bashrc 中相同的值。我根据您的问题修改了我的代码，试一试，让我知道它是否有效。

```
;; set env variable in Emacs
(getenv "SETTINGS")
(setenv "SETTINGS" "/home/user/settings.xml") 
```

原始代码（用于 PATH）是：

```
;; Emacs has its own path variable
(getenv "PATH")
 (setenv "PATH"
(concat
 "/usr/local/texlive/2011/bin/x86_64-linux" ":"
(getenv "PATH"))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T02:47:13.677

启动 xsession 时可能无法读取 .bashrc。尝试添加

```
export SETTINGS=/home/user/settings.xml 
```

在`.xsessionrc`或 中`.gnomerc`（如果您使用的是 gnome）。这些文件在 X 会话启动时加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T23:58:38.493

如果您在 emacs 中启动 R 会话，则 R 会话将具有与 emacs 相同的环境变量。所以你应该首先确保你启动 emacs 时它的环境包含你的 SETTINGS 变量。这样，您在 emacs 中启动的 R 会话也将在其环境中具有 SETTINGS。究竟如何实现这一点取决于您的系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T03:05:04.737

你可以把

```
SETTINGS <- "/home/user/settings.xml" 
```

作为`.Rprofile`一种解决方法。

# c# - 如何将文本框中的行与数据库的行同步？

> ID：11005481
> 
> 赞同：0
> 
> 时间：2012-06-12T21:56:35.717
> 
> 标签：c#, winforms, sql-server-ce

我有一个文本框，其中包含与此类似的数据行：

```
sheep
haggis
red squirrels
chickens
rabbits 
```

和一个 SQL CE 表，其中有一列名为`foods`，用于存储这些值。同步这两个数据源的最佳方式是什么？例如，如果用户从文本框中删除`red squirrels`and并添加，则包含和应该删除的表行并插入包含 的新行。`chickens``carrots``red squirrels``chickens``carrots`

现在，我的解决方案是将旧列表与新列表进行比较并执行两个操作。1）通过使用比较列表来查找已删除的项目`Except`：

```
List<String> removedFoods = oldList.Except(newList).ToList(); 
```

这些标签用 删除`DELETE`。另一个`Except`语句查找已添加的标签，然后添加`INSERT`.

```
List<String> addedFoods = newList.Except(oldList).ToList(); 
```

他们是一种更好的方法，它涉及我缺少的一个 C#/SQL 语句（或者一般来说是一种更好的方法）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:53:23.217

你的问题是关于性能的，对吗？从您已经在做的事情来看，我认为性能改进的空间不大。无论如何，您都必须进行删除和插入。正如蒂姆在回答您的问题时所问的那样，这取决于您餐桌上的食物数量。

您可以清除表数据，如下所示：

```
TRUNCATE TABLE foods 
```

> MSDN：TRUNCATE TABLE 类似于没有 WHERE 子句的 DELETE 语句；但是，TRUNCATE TABLE 速度更快，使用的系统和事务日志资源更少

然后使用文本框数据重新插入正确的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T04:00:55.233

制作一个看起来像多行文本框的数据网格比自己进行所有解析和处理要容易得多。

跟踪行/行会容易得多。

也删除和更新。

# javascript - 使用 JS 隐藏元素中的文本（不是元素本身）

> ID：11005486
> 
> 赞同：0
> 
> 时间：2012-06-12T21:56:51.477
> 
> 标签：javascript, jquery, html

有没有办法使用 JavaScript 隐藏 HTML 元素中的*文本*，而不是元素本身？所以如果有

```
<span style="border: 1px solid green">Hello world!</span> 
```

怎么能隐藏“你好世界！” 但不是边界？如果还有一个简化的 jQuery 解决方案，你也可以包含它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:01:33.437

`$(<mydiv>).css('color', $(<mydiv>).css('background-color'))`是唯一不改变 DOM 的解决方案。

如果你接受改变，你可以使用类似的东西`$(<mydiv>).html($('<div>'+$(<mydiv>).html())+'</div>').css({visibility: 'hidden'}))`

或类似的东西。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:18:43.960

如果它是块级元素，则可以使用`text-indent:-9999px;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T22:23:26.150

就在这里。它被称为`.wrapInner()`。

```
$("div").wrapInner('<span class="hide" />'); 
```

**演示：http:** [//jsfiddle.net/9KzgJ/](http://jsfiddle.net/9KzgJ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T22:00:35.330

您可以使用嵌套跨度并将其隐藏...

```
<span style="border: 1px solid green"><span id="text1">Hello world!</span></span> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T22:02:37.293

简短的回答没有。

可悲的是，如果不一起替换元素、隐藏元素或将元素文本更改为空白，则无法仅隐藏文本......

但是，您可以使用 javascript 附加相同的元素..然后隐藏您想要的元素...

但除了那个选项，戈登贝尔的回答可能是你最好的选择......

# spring - Spring Hibernate 配置导致会话 NPE

> ID：11005488
> 
> 赞同：2
> 
> 时间：2012-06-12T21:57:19.663
> 
> 标签：spring, hibernate, maven-2

我在正确设置 Hibernate 配置时遇到问题。在尝试将 HibernateDaoSupport 扩展到 GenericDao 并将其扩展到特定于类的 daos 之后，但是当我在我的 dao 中调用 findByNamedQuery 时，getSession() 会引发 NPE。

当我尝试切换到扩展 HibernateTemplate 时，hibernateTemplate 没有正确实例化，并且仍然为空：

```
java.lang.NullPointerException
at org.springframework.orm.hibernate3.support.HibernateDaoSupport.getSession(HibernateDaoSupport.java:143)
at com.jmt.hibernate.dao.GenericDaoImpl.findByNamedQuery(GenericDaoImpl.java) 
```

我错过了什么？？

我使用maven2构建项目，1.将hibernate插件添加到我的pom.xml中：

```
 <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>hibernate3-maven-plugin</artifactId>
    <version>3.0</version>

    <configuration>
        <components>
            <component>
            <name>hb2ddl</name>
            <implementation>jpaconfiguration</implementation>
            </component>
        </components>
        <componentProperties>
        <drop>true</drop>
        <outputfilename>output.sql</outputfilename>
        <format>false</format>
        <persistenceunit>MyEntityManager</persistenceunit>
        <ejb3>true</ejb3>
        </componentProperties>

    </configuration>
</plugin> 
```

2.在persistence.xml中定义了我的实体管理器：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">

   <persistence-unit name="MyEntityManager" transaction-type="RESOURCE_LOCAL"> <!-- "JTA"> -->
      <provider>org.hibernate.ejb.HibernatePersistence</provider>
      <jta-data-source>java:/DefaultDS</jta-data-source>

        <class>com.jmt.model.UserEntity</class>

      <shared-cache-mode>ENABLE_SELECTIVE</shared-cache-mode>
      <validation-mode>CALLBACK</validation-mode>
      <properties>

            <property name="hibernate.archive.autodetection" value="class"/>
            <property name="hibernate.connection.driver_class" value="org.postgresql.Driver"/>
         <property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQLDialect"/><!-- org.hibernate.dialect.HSQLDialect" -->
         <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
         <property name="hibernate.connection.url"  value="${jdbc.url}"/>
         <property name="hibernate.connection.username" value="${jdbc.username}"/>
         <property name="hibernate.connection.password" value="${jdbc.password}"/>

      </properties>
   </persistence-unit>
</persistence> 
```

3\. 在 applicationContext.xml 中连接我的 daos：

```
 <bean id="hibernateDaoSupport" abstract="true"
class="org.springframework.orm.hibernate3.support.HibernateDaoSupport">
<property name="sessionFactory" ref="sessionFactory"/>
</bean>
    <bean id="hibernateHelper" class="org.springframework.orm.hibernate3.HibernateTemplate" >
        <constructor-arg ref="sessionFactory"/>
    </bean>
    <bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory"/>
    <property name="hibernateManagedSession" value="true"/>
</bean>

    <bean class="com.jmt.model.UserEntity"/>

    <bean id="multipartResolver"
        class="org.springframework.web.multipart.commons.CommonsMultipartResolver" />

    <bean
        class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
        <property name="order" value="1" />
    </bean>

    <bean
        class="org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping">
        <property name="order" value="2" />
    </bean>

    <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
            <property name="basename"><value>messages</value></property>
    </bean>

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="org.postgresql.Driver"/>
        <property name="url" value="${jdbc.url}"/>
        <property name="username" value="${jdbc.username}"/>
        <property name="password" value="${jdbc.password}"/>
        <property name="poolPreparedStatements" value="true"/>
        <property name="defaultAutoCommit" value="true"/>
        <property name="maxActive" value="100"/>
        <property name="maxIdle" value="30"/>
        <property name="maxWait" value="1000"/>
        <property name="removeAbandoned" value="true"/>
        <property name="removeAbandonedTimeout" value="60"/>
        <property name="logAbandoned" value="true"/>
        <property name="testOnBorrow" value="false"/>
        <property name="testWhileIdle" value="true"/>
        <property name="timeBetweenEvictionRunsMillis" value="10000"/>
        <property name="minEvictableIdleTimeMillis" value="60000"/>        
    </bean>   

    <tx:annotation-driven mode="aspectj" transaction-manager="transactionManager"/>
    <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource"/>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</prop>
                <prop key="hibernate.query.substitutions">true 'Y', false 'N'</prop>
                <prop key="hibernate.jdbc.batch_size">15</prop>   
                <prop key="hibernate.connection.isolation">2</prop>
            </props>       
        </property>
         <property name="packagesToScan">
            <list>
                <value>com.jmt.model</value>
                <value>com.jmt.hibernate.dao</value>
            </list>
        </property>        
    </bean>
    <bean id="userDao" class="com.jmt.hibernate.dao.UserDaoImpl">
        <constructor-arg value="com.jmt.hibernate.dao.UserDaoImpl"/>
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean> 
```

4\. 甚至在我的 web.xml 中添加了一个过滤器，希望能正确注入会话：

```
<filter>
        <filter-name>sessionLoadingFilter</filter-name>
        <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
    </filter> 
```

我还没有添加管理器，希望更少的层数可以让一些东西工作......

任何帮助/想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T16:39:41.550

糟糕，我没想过在哪里调用了 dao，是的，这就是为什么没有公开会议的原因。有人使用 spring dwr 直接从 jsp 文件中调用 dao。一旦我摆脱了它并从我的控制器进行调用，会话终于被正确实例化了。谢谢你的帮助，日本人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T02:48:23.630

我认为您应该尝试执行 openSession() 而不是执行 getSession()。因为那时可能会出现您的会话未打开并且您正在尝试获取它的情况，因此它将导致 NPE。

希望这对您有所帮助。干杯。

# jquery - jQuery 切换 div 和文本

> ID：11005489
> 
> 赞同：2
> 
> 时间：2012-06-12T21:57:28.693
> 
> 标签：jquery, jquery-selectors, toggle

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:04:58.160

您只是将其设置为`less..`. 您还需要评估它并将其设置回`more...`如果当前值为`less...`.

参见[**演示：比较 HTML**](http://jsfiddle.net/FranWahl/5rZVr/1/)

```
$(document).ready(function() {
    $(".overview-continued").hide();
    $(".show-overview").html("more...");
    $(".show-overview").click(function() {
        var text = $(this).html();
        $(".overview-continued").slideToggle("1000");
        $(".show-overview").html(text == "less..." ? "more..." : "less...");
        return false;
    });
});​ 
```

**编辑**
`freakish`在评论中提到比较 HTML 是不好的做法。
（还更新了示例以使用 OP 指定的文本和标签）

为此，请参阅替代[**演示：使用属性**](http://jsfiddle.net/FranWahl/BFq4t/1/)

`anchor`收到一个新的自定义属性：

```
<a class="show-overview" data-item-state="showLess">...</a>​ 
```

脚本已更新并进行了一些重构：

```
$(document).ready(function() {
    $(".overview-continued").hide();

    setState();

    $(".show-overview").click(function() {
        $(".overview-continued").slideToggle("1000");
        setState();
        return false;
    });

    function setState() {
        var control = $(".show-overview");
        var state = control.attr("data-item-state");

        control.html(state == "showLess" ? "more..." : "less...");
        control.attr("data-item-state", state == "showLess" ? "showMore" : "showLess");
    };
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:05:13.767

您需要在 click 函数中添加条件，因为您总是将 .show-overview 设置为“less...”

可能不是正确的语法，但是：

```
$(".show-overview").click(function()

    {
        $(".overview-continued").slideToggle("1000");
        if($(".show-overview").html() == "less...")
        {
        $(".show-overview").html("more...");
        }
        else
        {
        $(".show-overview").html("less...");
        }
        return false;

    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T22:05:44.013

您需要`div`从 JavaScript 的角度知道何时打开/关闭。尝试这个：

```
$(document).ready(function() {
    var overview = $(".overview-continued");
    overview.hide();
    var show = $(".show-overview");
    show.html("more...");
    show.click(function(e) {
        e.preventDefault();
        var is_opened = overview.data('is_opened');
        if (!is_opened) {
            overview.slideDown(500, function() {
                show.html("less...");
            });
        } else {
            overview.slideUp(500, function() {
                show.html("more...");
            });
        }
        overview.data('is_opened', !is_opened);
    });
}); 
```

检查这个[jsFiddle](http://jsfiddle.net/9yJz9/2/)代码。请注意，我稍微重构了您的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T22:09:00.473

你在点击功能中告诉它用“.less”标记它。如果你把它分成两种方法，它会更容易理解……沿着这些思路：

```
$(document).ready(function() {
    function close(){  
      $(".overview-continued").slideToggle("1000");
      $(".show-overview").html("more...");
    }
    function open(){  
      $(".overview-continued").slideToggle("1000");
      $(".show-overview").html("less...");
    }
    $(".overview-continued").hide();
    $(".show-overview").toggle(open,close);
});​ 
```

编辑：由于评论

# javascript - 加载书签时未捕获的 ReferenceError

> ID：11005492
> 
> 赞同：1
> 
> 时间：2012-06-12T21:57:52.487
> 
> 标签：javascript

我正在尝试构建一个简单的 Bookmarklet，它将一些外部 Javascript 加载到页面中，目标是将像 Stackoverflow 这样的降价编辑器添加到另一个站点。我让它工作，但它需要我点击我的书签按钮 2 次而不是 1 次。

第一次点击给出了这个错误...

```
Uncaught ReferenceError: Markdown is not defined init.js:46 
```

第46行是这个...

```
var converter1 = Markdown.getSanitizingConverter(); 
```

现在，在第二次单击我的 Bookmarklet 之后，一切都运行良好，但第一次单击总是会出现该错误并且什么也不做。

这是Bookmarklet文件的代码，请帮我修复，我的Javascript技能不太好。

加载外部 JS 和 CSS 文件

```
function loadScripts(scriptURL) {
    var scriptElem = document.createElement('SCRIPT');
    scriptElem.setAttribute('language', 'JavaScript');
    scriptElem.setAttribute('src', scriptURL);
    void(document.body.appendChild(scriptElem));
}

// Load these 3 Javascript files into the page
// jQuery is already loaded into the page being used so no need to load it
loadScripts('http://codedevelopr.com/labs/javascript/forrst/Markdown.Converter.js');
loadScripts('http://codedevelopr.com/labs/javascript/forrst/Markdown.Sanitizer.js');
loadScripts('http://codedevelopr.com/labs/javascript/forrst/Markdown.Editor.js');

// Load the CSS file into the Page
var head = document.getElementsByTagName('head')[0];
$(document.createElement('link')).attr({
    type: 'text/css',
    href: 'http://codedevelopr.com/labs/javascript/forrst/demo.css',
    rel: 'stylesheet'
}).appendTo(head); 
```

加载文件后，我们运行这个......

```
// Find and replace the curent textarea with the HTML we
// need for our markdown editor to work 
$(document).ready(function () {
    var htmlToReplace = ' \
  <div class="wmd-panel"> \
    <div id="wmd-button-bar"></div> \
      <textarea class="wmd-input" id="wmd-input" name="description"></textarea> \
  </div> \
  <div id="wmd-preview" class="wmd-panel wmd-preview"></div>';

    $("#description").replaceWith(htmlToReplace);

    //Run the Markdown editor!
    var converter1 = Markdown.getSanitizingConverter();

    var editor1 = new Markdown.Editor(converter1);
    editor1.run();

}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T22:37:53.970

在您使用降价时，您的脚本文件尚未加载。您只是发送了请求。您必须等到收到并解析响应。

我已经清理了你的代码以及你使用 jQuery：

```
var urls = [
  'http://codedevelopr.com/labs/javascript/forrst/Markdown.Converter.js',
  'http://codedevelopr.com/labs/javascript/forrst/Markdown.Sanitizer.js',
  'http://codedevelopr.com/labs/javascript/forrst/Markdown.Editor.js'
];

// map urls to getScript calls, and pass them to $.when
$.when.apply($, $.map(urls, $.getScript)).then(function() {
  // use markdown here
});

$("<link>", {
  href: 'http://codedevelopr.com/labs/javascript/forrst/demo.css',
  rel: 'stylesheet'
}).appendTo("head"); 
```

# java - Hadoop MR hold array reference in reduce method

> ID：11005496
> 
> 赞同：0
> 
> 时间：2012-06-12T21:58:10.620
> 
> 标签：java, hadoop, mapreduce

I would like to have an arrayList that holds reference to object inside the reduce function.

```
@Override
public void reduce( final Text pKey,
                    final Iterable<BSONWritable> pValues,
                    final Context pContext )
        throws IOException, InterruptedException{
    final ArrayList<BSONWritable> bsonObjects = new ArrayList<BSONWritable>();

    for ( final BSONWritable value : pValues ){
        bsonObjects.add(value);
        //do some calculations.
    }
   for ( final BSONWritable value : bsonObjects ){
       //do something else.
   }
   } 
```

The problem is that the bsonObjects.size() returns the correct number of elements but all the elements of the list are equal to the last inserted element. e.g. if the

> {id:1}
> 
> {id:2}
> 
> {id:3}

elements are to be inserted the bsonObjects will hold 3 items but all of them will be {id:3}. Is there a problem with this approach? any idea why this happens? I have tried to change the List to a Map but then only one element was added to the map. Also I have tried to change the declaration of the bsonObject to global but the same behavior happes.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:01:09.397

这是记录在案的行为。原因是 pValues 迭代器重用了 BSONWritable 实例，并且当它在循环中的值发生变化时，bsonObjects ArrayList 中的所有引用也会更新。当您在 bsonObjects 上调用 add() 时，您正在存储一个引用。这种方法允许 Hadoop 节省内存。

您应该在第一个循环中实例化一个新的 BSONWritable 变量，该变量等于变量值（深拷贝）。然后将新变量添加到 bsonObjects 中。

尝试这个：

```
for ( final BSONWritable value : pValues ){
    BSONWritable v = value; 
    bsonObjects.add(v);
    //do some calculations.
}
for ( final BSONWritable value : bsonObjects ){
   //do something else.
} 
```

然后，您将能够在第二个循环中遍历 bsonObjects 并检索每个不同的值。

但是，您也应该小心——如果您进行深度复制，此 reducer 中的所有键值都需要适合内存。

# javascript - Jquery Qtip multi ajax load form fail javascript control

> ID：11005497
> 
> 赞同：1
> 
> 时间：2012-06-12T21:58:15.733
> 
> 标签：javascript, jquery, ajax, forms, qtip2

Hello I whant to call this:

```
$(function() {
$('a[href*=editar_domicilio]').each(function(){
    $(this).qtip({
        //id: 'modal', // Since we're only creating one modal, give it an ID so we can style it
        content: {
            // Set the text to an image HTML string with the correct src URL to the loading image you want to use
            text: 'Cargando...',
            ajax: {
                url: './abm_info_contacto_modificar.php?iddomicilio=' + $(this).attr('rel') + '&idpersona=' + $('#idpersona').val(),
                once: false // Re-fetch the content each time I'm shown
            },
            title: {
                text: 'Modificar Domicilio',
                button: true
            }
        },
        position: {
            my: 'center', // ...at the center of the viewport
            at: 'center',
            target: $(window)
        },
        show: {
            event: 'click', // Show it on click...
            solo: true, // ...and hide all other tooltips...
            modal: true // ...and make it modal
        },
        hide: function() { $('#formulario_domicilio').remove(); },
        style: 'ui-tooltip-light ui-tooltip-rounded'
    })
}).click(function(event) { event.preventDefault(); });// Make sure it doesn't follow the link when we click it 
```

from a table like this

```
<table align='center'><thead><tr><th></th><th id='DOMICILIO'>DOMICILIO</th><th id='FECHA'>FECHA</th><th id='LOCALIDAD'>LOCALIDAD</th><th id='TIPO'>TIPO</th><th id='ACTUAL'>ACTUAL</th></tr></thead><tbody><tr id='tr10'><td><a href="editar_domicilio?var=10" title="Modificar" rel="10"><img src='../../tema_blanco/modificar.png' border='0' style='margin:0px 1px 0px 1px;'></a>&nbsp;</td><td>&nbsp;5 N° 1 PISO 23 DEPTO 23&nbsp;</td><td>&nbsp;12/06/2012&nbsp;</td><td>&nbsp;MISIONES - COL. ALBERDI&nbsp;</td><td>&nbsp;COMERCIAL&nbsp;</td><td>&nbsp;NO&nbsp;</td></tr><tr id='tr3'><td><a href="editar_domicilio?var=3" title="Modificar" rel="3"><img src='../../tema_blanco/modificar.png' border='0' style='margin:0px 1px 0px 1px;'></a>&nbsp;</td><td>&nbsp;666 N° 67 PISO 68 DEPTO 69&nbsp;</td><td>&nbsp;11/06/2012&nbsp;</td><td>&nbsp;CATAMARCA - LAS JUNTAS&nbsp;</td><td>&nbsp;PARTICULAR&nbsp;</td><td>&nbsp;NO&nbsp;</td></tr><tr id='tr4'><td><a href="editar_domicilio?var=4" title="Modificar" rel="4"><img src='../../tema_blanco/modificar.png' border='0' style='margin:0px 1px 0px 1px;'></a>&nbsp;</td><td>&nbsp;5 N° 5&nbsp;</td><td>&nbsp;11/06/2012&nbsp;</td><td>&nbsp;MISIONES - COL. ALBERDI&nbsp;</td><td>&nbsp;PARTICULAR&nbsp;</td><td>&nbsp;NO&nbsp;</td></tr><tr id='tr5'><td><a href="editar_domicilio?var=5" title="Modificar" rel="5"><img src='../../tema_blanco/modificar.png' border='0' style='margin:0px 1px 0px 1px;'></a>&nbsp;</td><td>&nbsp;5 N° 11 PISO 22 DEPTO 22&nbsp;</td><td>&nbsp;11/06/2012&nbsp;</td><td>&nbsp;BUENOS AIRES - J. B. ALBERDI&nbsp;</td><td>&nbsp;PARTICULAR&nbsp;</td><td>&nbsp;NO&nbsp;</td></tr></table> 
```

the problem occurs in the form called width ajax, i call once and work perfect but if i close it and try to open from another link on the table the javascript that controls the inputs (included in the form width ajax) fails, "I Think" the previus form is still present in the dom, i hope you can understandme because my english suck! thank you very much.

# parsing - Antlr 空白令牌错误

> ID：11005510
> 
> 赞同：2
> 
> 时间：2012-06-12T21:59:19.137
> 
> 标签：parsing, antlr, grammar

我有以下语法，我想匹配字符串“{name1，name2}”。我只想要包含至少一个元素的名称/整数列表。但是我收到错误：
第 1:6 行在字符“”处
没有可行的替代方案 第 1:11 行在字符“}”处没有可行的替代方案
第 1:7 行不匹配的输入“名称”期待 SIMPLE_VAR_TYPE

我希望空格等被忽略......另外有趣的是输入“{name1，name2}”不会发生错误（'，'之后没有空格）。这是我的语法

```
grammar NusmvInput;
options {
  language = Java;
}
@header {
  package secltlmc.grammar;
}
@lexer::header {
  package secltlmc.grammar;
}
specification : 
     SIMPLE_VAR_TYPE EOF
     ;     
INTEGER 
    : ('0'..'9')+
    ;
SIMPLE_VAR_TYPE 
    : ('{' (NAME | INTEGER) (',' (NAME | INTEGER))* '}'  )
    ;
NAME 
    : ('A'..'Z' | 'a'..'z') ('a'..'z' | 'A'..'Z' | '0'..'9' | '_' | '$' | '#' | '-')*
    ;
WS 
    : (' ' | '\t' | '\n' | '\r')+ {$channel = HIDDEN;} 
    ; 
```

这是我的测试代码

```
package secltlmc;
public class Main {
    public static void main(String[] args) throws 
            IOException, RecognitionException {
        CharStream stream = new ANTLRStringStream("{name1, name2}");
        NusmvInputLexer lexer = new NusmvInputLexer(stream);
        CommonTokenStream tokenStream = new CommonTokenStream(lexer);
        NusmvInputParser parser = new NusmvInputParser(tokenStream);
        parser.specification();
    }
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:11:27.427

问题是您正在尝试`SIMPLE_VAR_TYPE`使用词法分析器进行解析，即您正在尝试使其成为单个标记。实际上，看起来您想要一个多令牌生产，因为您希望空格通过`WS`.

您应该将`SIMPLE_VAR_TYPE`词法分析器规则更改为解析器规则，方法是将其首字母（或者更好的是，整个名称）更改为小写。

```
specification : 
     simple_var_type EOF
     ;    

simple_var_type 
    : ('{' (NAME | INTEGER) (',' (NAME | INTEGER))* '}'  )
    ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:15:28.377

的定义`SIMPLE_VAR_TYPE`指定以下表达式：

*   打开`{`
*   后跟一个`NAME`或`INTEGER`
*   后跟零个或多个：
    *   逗号 ( `,`) 后跟一个`NAME`或`INTEGER`
*   然后关闭`}`

它在任何地方都不允许输入中的空格（也`NAME`不允许`INTEGER`），因此在提供空格时会出现错误

尝试：

```
SIMPLE_VAR_TYPE 
: ('{' (NAME | INTEGER) (WS* ',' WS* (NAME | INTEGER))* '}'  )
; 
```

# database - 从多个 SQL 查询输出生成报告的工具/库？

> ID：11005517
> 
> 赞同：-1
> 
> 时间：2012-06-12T22:00:28.617
> 
> 标签：database, reporting

我希望生成一个报告，其中数据来自多个 SQL 查询。一些查询将有几个列/行作为输出，我想控制什么去哪里。

数据位于 mySQL 数据库中。格式化文本或 CSV 可以作为输出。希望能够自动生成此报告。

有没有人有关于这样做的工具/库的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:48:47.513

您几乎可以使用任何报告系统来做到这一点。[Windward Reports](https://www.windwardstudios.com/)或 Crystal Reports 付费。Jasper 或 Pentaho 免费。[（SSRS 已退出，因为您使用的是 MySQL。）您可以在Reporting Software](http://www.reportingsoftware.info/)找到一个很好的列表。您面临的最大问题是易用性与价格。

如果您愿意为商业系统付费，请查看 Windward（免责声明，我是那里的 CTO）。使用 Windward，您设计的报告是 Excel（最适合您使用）、Word 或 PowerPoint。所以设计和布局轻而易举。是的，您可以将输出输出到 XLSX、CSV 或其他任何东西。

# wolfram-mathematica - 清理 Mathematica 中一根长线上的数据

> ID：11005522
> 
> 赞同：3
> 
> 时间：2012-06-12T22:00:41.723
> 
> 标签：wolfram-mathematica

我有一个大约 12Mb 的文件，它具有以下类型

```
[["1",-154],["2",-100],["3",-28],["4",-66],["5",-222],["6",-309],["7",-196],["8",-50],["9",-53],["10",-209],["11",-355],["12",-350],["13",-269],["14",-264],["15",-392],["16",-513],["17",-515],["18",-434],["19",-418],["20",-505],["21",-592],["22",-559],["23",-422],["24",-384],["25",-539],["26",-716],["27",-713],["28",-593],["29",-534],["30",-647],["31",-813],["32",-857],["33",-711],["34",-582],["35",-594],["36",-700],["37",-721],["38",-600],["39",-487],["40",-490],["41",-589],["42",-630],["43",-502],["44",-365],["45",-340],["46",-403],["47",-420],["48",-291],["49",-136],["50",-98],["51",-218],["52",-285],["53",-198],["54",-52],["55",-58],["56",-213],["57",-334],["58",-301],["59",-195],["60",-195],["61",-324],["62",-470],["63",-465],["64",-378],["65",-381],["66",-546],["67",-734],["68",-767],["69",-695],["70",-683],["71",-804],["72",-991],["73",-1050],["74",-937],["75",-850],["76",-912],["77",-1041],["78",-1065],["79",-972],["80",-931],["81",-1030],["82",-1186],["83",-1233],["84",-1113],["85",-992],["86",-1051],["87",-1206],["88",-1299],["89",-1218],["90",-1112],["91",-1150],["92",-1287],["93",-1345],["94",-1239],["95",-1140],["96",-1147],["97",-1276],["98",-1363],["99",-1312],["100",-1206],["101",-1184],["102",-1297],["103",-1378],["104",-1297],["105",-1141],["106",-1113],["107",-1219],["108",-1325],["109",-1284],["110",-1147],["111",-1103],["112",-1179],["113",-1300],["114",-1262],["115",-1141], 
```

我想使用 Mathematica 来清理它，删除引号之间的所有符号和数字，只用以下格式的空格分隔它们：

```
-154 -100 -28 -66 -222 -309 -196 etc… 
```

我怎么能这样做？我对 Mathematica 相当陌生，关于“如何清理 HTML 文件”或“如何清理 ZIP 文件”的教程并没有很好地阐明我的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:08:28.850

您可以尝试将其作为字符串导入，用 和 替换`[`，`{`然后`]`用`}`.`Eval`去掉每个元组的第一个元素`Last@Tranpose`。

```
data = Import["your_data.txt"];
Last@Transpose@
  ToExpression[StringReplace[data, {"[" -> "{", "]" -> "}"}]] 
```

当然，还有更好的方法可以做到这一点。斯莱特的想法也很有效。你会发现在 Mathematica 中确实有上百万种方法可以做这种事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T22:09:26.167

Mathematica 确实支持正则表达式，以及一个通用的字符串操作包。类似于以下内容：

```
string = "[["1",-154],["2",-100],["3",-28],["4",-66]]"
StringSplit[string, "],["]

StringReplace[strings, RegularExpression["[\"[0-9]+\"]] -> " "] 
```

您可能需要稍微尝试一下，但这就是想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T17:23:08.497

这是另一种避免的方法`ToExpression`（理论上可以运行您不打算运行的代码）：

```
Import["data.txt", "Text"];

StringSplit[%, {"[[", "],[", "]]", ","}][[2 ;; ;; 2]];

StringJoin[Riffle[%, " "]]

Export["out.dat", %, "Text"] 
```

# jquery - 未找到来自 jQuery Ajax 调用的 MVC4 JsonResult

> ID：11005526
> 
> 赞同：7
> 
> 时间：2012-06-12T22:00:59.980
> 
> 标签：jquery, asp.net-mvc-4

我的 Ajax 调用如下所示：

```
 $.ajax({
            type: "POST",
            url: "/Home/GetStuff",
            success: function (data) {
                getStuff_callback(data);
            },
            dataType: "json",
            traditional: true
        }); 
```

在本地一切正常，但是当我将项目发布到我的 FTP 服务器上名为“ws”的文件夹时，找不到 GetStuff JsonResult 函数，除非我喜欢这个**“url：”/ws/Home/GetStuff“”** ...这是我每次想要发布时都不想做的事情。

我尝试**了 @Url.Action("GetStuff", "Home")**但在 Chrome 调试器中得到“未捕获的 SyntaxError：提供给 RegExp 构造函数 'GetStuff' 的无效标志”。

# python - 使用 nltk 处理一般同义词和词性

> ID：11005529
> 
> 赞同：8
> 
> 时间：2012-06-12T22:01:02.503
> 
> 标签：python, machine-learning, nlp, nltk, wordnet

我正在尝试为句子中重要的单词（即不是“a”或“the”）创建一个通用同义词标识符，并且我正在使用 python 中的自然语言工具包（nltk）。我遇到的问题是 nltk 中的同义词查找器需要词性参数才能链接到它的同义词。我尝试的解决方法是使用 nltk 中存在的简化词性标注器，然后减少第一个字母以便将此参数传递给同义词查找器，但这不起作用。

```
def synonyms(Sentence):
    Keywords = []
    Equivalence = WordNetLemmatizer()
    Stemmer = stem.SnowballStemmer('english')
    for word in Sentence:
        word = Equivalence.lemmatize(word)
    words = nltk.word_tokenize(Sentence.lower())
    text = nltk.Text(words)
    tags = nltk.pos_tag(text)
    simplified_tags = [(word, simplify_wsj_tag(tag)) for word, tag in tags]
    for tag in simplified_tags:
        print tag
        grammar_letter = tag[1][0].lower()
        if grammar_letter != 'd':
            Call = tag[0].strip() + "." + grammar_letter.strip() + ".01"
            print Call
            Word_Set = wordnet.synset(Call)
            paths = Word_Set.lemma_names
            for path in paths:
                Keywords.append(Stemmer.stem(path))
    return Keywords 
```

这是我目前正在使用的代码，正如你所看到的，我首先对输入进行词形还原以减少从长远来看我将拥有的匹配数量（我计划在数万个句子上运行它），并且在理论上，我会在此之后对单词进行词干处理以进一步提高这种效果并减少我生成的冗余单词的数量，但是这种方法几乎总是以以下形式返回错误：

```
Traceback (most recent call last):
  File "C:\Python27\test.py", line 45, in <module>
    synonyms('spray reddish attack force')
  File "C:\Python27\test.py", line 39, in synonyms
    Word_Set = wordnet.synset(Call)
  File "C:\Python27\lib\site-packages\nltk\corpus\reader\wordnet.py", line 1016, in synset
    raise WordNetError(message % (lemma, pos))
WordNetError: no lemma 'reddish' with part of speech 'n' 
```

我对将要运行的数据没有太多控制权，因此简单地清理我的语料库并不是一个真正的选择。关于如何解决这个问题的任何想法？

我做了一些更多的研究，我有一个有希望的领先优势，但我仍然不确定如何实现它。在未找到或错误分配的单词的情况下，我想使用相似度度量（Leacock Chodorow、Wu-Palmer 等）将单词链接到最接近正确分类的其他关键字。也许与编辑距离测量相结合，但我仍然无法找到任何类型的文档。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T04:03:30.873

显然 nltk 允许检索与单词相关的所有同义词。当然，通常有许多反映不同的词义。为了在功能上找到同义词（或者如果两个词是同义词），您必须尝试匹配最接近的同义词集，这可以通过上述任何相似性度量来实现。我编写了一些基本代码来执行此操作，如下所示，如何查找两个单词是否是同义词：

```
from nltk.corpus import wordnet
from nltk.stem.wordnet import WordNetLemmatizer
import itertools

def Synonym_Checker(word1, word2):
    """Checks if word1 and word2 and synonyms. Returns True if they are, otherwise False"""
    equivalence = WordNetLemmatizer()
    word1 = equivalence.lemmatize(word1)
    word2 = equivalence.lemmatize(word2)

    word1_synonyms = wordnet.synsets(word1)
    word2_synonyms = wordnet.synsets(word2)

    scores = [i.wup_similarity(j) for i, j in list(itertools.product(word1_synonyms, word2_synonyms))]
    max_index = scores.index(max(scores))
    best_match = (max_index/len(word1_synonyms), max_index % len(word1_synonyms)-1)

    word1_set = word1_synonyms[best_match[0]].lemma_names
    word2_set = word2_synonyms[best_match[1]].lemma_names
    match = False
    match = [match or word in word2_set for word in word1_set][0]

    return match

print Synonym_Checker("tomato", "Lycopersicon_esculentum") 
```

我可能会尝试实现更强大的词干提取算法，但在我做的前几个测试中，这段代码实际上适用于我能找到的每个单词。如果有人对如何改进这个算法有任何想法，或者有任何东西可以以任何方式改进这个答案，我很想听听。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T00:11:33.903

你能用 a 包装你`Word_Set = wordnet.synset(Call)`的`try:`并忽略`WordNetError`异常吗？看起来您遇到的错误是某些单词没有正确分类，但是对于无法识别的单词也会发生此异常，因此捕获异常对我来说似乎是个好主意。

# r - 颜色=因子（foo）的ggplot2标签

> ID：11005531
> 
> 赞同：3
> 
> 时间：2012-06-12T22:01:10.503
> 
> 标签：r, ggplot2

在 ggplot2 图中很难使用标签。这是示例页面中的类似图：

```
mt <- ggplot(mtcars, aes(mpg, wt, colour = factor(cyl))) + geom_point() 
mt + facet_grid(. ~ cyl, scales = "free") 
```

我将如何定义因子（cyl）的标签列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T22:09:09.880

我会自己做`data.frame`：

```
mtcars$cyl_factor <- factor(mtcars$cyl, labels=c('Four', 'Six', 'Eight'))

ggplot(mtcars, aes(mpg, wt, colour = cyl_factor)) + 
  geom_point() +
  facet_grid(. ~ cyl, scales = "free") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:59:50.260

`labels`您可以在颜色比例的参数中定义它：

```
ggplot(mtcars, aes(mpg, wt, colour=factor(cyl))) + 
  geom_point() +
  scale_colour_discrete(breaks = c("4", "6", "8"),
                        labels = c("Four", "Six", "Eight")) 
```

# sass - 在悬停时使用 CSS 的平滑效果

> ID：11005539
> 
> 赞同：4
> 
> 时间：2012-06-12T22:01:40.883
> 
> 标签：sass, less, css

我在这里找到了这个漂亮的光滑效果 - [http://www.red-team-design.com/wp-content/uploads/2011/04/css3-box-shadow.html](http://www.red-team-design.com/wp-content/uploads/2011/04/css3-box-shadow.html)。

这是一个副本 - [http://jsfiddle.net/cyvvilek/cL7x6/3/](http://jsfiddle.net/cyvvilek/cL7x6/3/)

我想知道是否有任何方法可以在悬停时产生这种效果。我认为，再加上一些 CSS 动画会产生很好的效果。在 CSS 中有大量使用 :after 和 :before 所以它不能是 #box:after:hover 或类似的东西:) 我听说过在 SASS 或 LESS 中嵌套东西的可能性.. 这可以用 CSS 完成吗独自的？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:08:11.290

不幸的是，像 :after 和 :before 这样的伪元素还不能转换。SASS 和 LESS 可以编译成 CSS，所以在技术上可以使用 SASS 或 LESS 的一切，都可以使用纯 CSS。

您可以做的是有一个带有顶部阴影的单独元素（可能是 div），并在悬停时淡入淡出。或者，您可以使用图像。

# android - 本地主机在 mac 上运行.. 我可以在我的 Android 手机上查看它吗？

> ID：11005540
> 
> 赞同：63
> 
> 时间：2012-06-12T22:01:45.637
> 
> 标签：android, macos, localhost

在我的 Mac 上运行 ruby​​ on rails 项目。我需要在我的安卓手机上测试它。有没有办法在我的安卓手机上查看我的 mac localhost？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-06-12T22:08:34.083

名称“localhost”只是对您自己计算机的回送。要在您的 Android 上访问它，您需要找到计算机的 IP 地址。

查找此信息的最通用方法（适用于 Mac 和 Linux）是进入终端并键入`ifconfig`. 查找“en0”或“en1”，然后在该条目下查找“inet”列表。它将类似于“192.168.1.100”。当您找到该地址时，这就是您想要放入浏览器地址栏中的内容。

（特别是在 Mac 上，您可以转到“系统偏好设置”中的“共享”窗格，它会在那里告诉您。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-06T20:23:21.700

这是让您的 localhost 可用于在其他设备上进行测试的快速操作：

1）识别您的Android的IP：选择您连接的Wi-Fi（与Mac上的相同），您将获得详细的IP）。例如：我们假设您的 Android IP 是：192.168.0.10

2）在你的 Mac 上打开一个 Shell 并编辑你的主机：

```
sudo nano /etc/hosts 
```

3）编辑文件是这样的：

```
127.0.0.1 192.168.0.10 
```

4）识别你的Mac IP：（正如@Chuck完美解释的那样）（在你的shell中）：

```
ifconfig 
```

5）打开您在手机上使用的最喜欢的网络浏览器，并直接连接到您的 Mac IP（如果需要，使用端口）：

```
http://192.168.x.x:8000/ 
```

6）享受你的测试:)

请注意，您可以为 Wi-Fi 上连接的每个支持执行此操作。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-06-13T09:39:33.717

Chunk 的回答是正确的，假设您的移动设备和您的计算机在同一个网络上。但是，如果您希望您的 localhost 服务器对更广泛的 Internet 可见（例如，用于通过 3G 进行测试、开发 webhook 或与远程同事/客户端协作），则需要更多本地地址（以 10.* 或 192.168.* 开头） ) 对更广泛的 Internet 不可见。

传统的解决方案是端口转发和动态 DNS，但最近出现了一些旨在简化此过程的服务（免责声明：我是其中之一，PageKite 的作者）。

这些服务为您提供公共 DNS 名称和软件，将您的“本地主机”与云端中继服务器（也称为反向代理）连接起来。例如，如果您使用的是 PageKite，您可以在终端中运行以下命令：

$ pagekite.py 80 你的名字.pagekite.me

...创建一个映射`http://yourname.pagekite.me/`到运行在`http://localhost:80`. 当程序运行时，您的 localhost 站点将对 Internet 的其余部分可见。为了再次使其私有化，您只需关闭 pagekite.py 连接器程序即可。

为了完整起见，以下是我知道的一些 localhost 隧道服务：

*   [PageKite](https://pagekite.net/)是免费软件 (Python)，具有“按需付费”在线服务。您可以根据需要创建任意数量的长期子域，包括通配符 SSL 证书，并且前端中继在多个地理位置运行以提供冗余和响应能力。
*   [Localtunnel](http://progrium.com/localtunnel/)是一个免费（由 Twilio 赞助）的 Ruby 解决方案，它为连接提供临时名称。请注意，名称会被回收，因此您可能会在连接处于活动状态时看到意外流量。
*   Showoff.io 和 Tunnlr.com 是类似于 Localtunnel 的专有付费服务，基于相同的基本技术（ssh 隧道）。

（很抱歉没有链接到最后两个，所以垃圾邮件保护阻止我对我的竞争对手公平。;-)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-04-11T17:55:27.383

今天发现了这个很棒的免费工具 -*非常*容易设置并且工作起来就像一个魅力！还提供适用于 Mac OS、Linux 和 Windows 的版本。

[https://ngrok.com/](https://ngrok.com/)

（与它没有任何关联）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-01-18T11:54:45.950

这对我来说可以通过本地网络使用 IP 访问 rails 服务器：

*   防火墙必须关闭。
*   /etc/hosts 应该有这个条目：

    ```
    127.0.0.1 192.168.100.12 
    ```

    其中 192.168.100.12 是可以在终端中通过 ifconfig 命令找到的 IP 地址。

*   使用以下命令启动 rails 服务器：

    ```
    rails server -b 0.0.0.0 -p 8080 
    ```

我能够通过[http://192.168.100.12:8080/访问我的本地主机](http://192.168.100.12:8080/)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-09-13T16:54:03.693

此外，如果您想在 Android/iOS 设备上测试使用**Angular**开发的**PWA 应用程序**，您将需要使用：

 **`ng serve --host 0.0.0.0`启动服务器 CLI。

如果您收到“无效的主机标头”，请使用：

`ng serve --host 0.0.0.0 --disableHostCheck true`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-04-13T17:23:38.397

在阅读了这个线程（并且建议有效！）之后，我整理了一个解决这个问题的指南。[此链接指向该指南，其中包含每个步骤的屏幕截图和查看位置](https://mynamessebastian.com/2016/04/13/mobile-web-dev-access-localhost-on-android-from-osx/)。或者文字粘贴在下面。感谢您的帮助！

首先，您的手机和笔记本电脑必须连接到同一个 WiFi 网络。如果您使用手机移动热点，它仍然可以工作。但是，请确保在继续之前将两个设备连接到同一网络。

接下来，收集您的手机 IP 地址。为此，我使用 Network Info II 应用程序。绝对有另一种方法可以做到这一点。但是，Network Info II 可以根据需要工作，并且是本教程的文档。

现在在您的计算机上打开终端（不要担心您在哪个目录中）并运行命令 sudo nano /etc/hosts/。输入系统密码后，您会在终端顶部附近看到一串数字，后面跟着单词 localhost。localhost 实际上只是您计算机自己的服务器地址的别名，因此当您在浏览器中访问 localhost 时，它只是将 http 请求路由到您的本地计算机。为了将您的手机绑定到此循环中，请在数字字符串和本地主机之间输入其 IP 地址。

要保存此内容，请在提示保存时点击 control + X，然后点击 Y。之后，回车键将带您回到标准命令行。

在终端中打开第二个选项卡并启动本地服务器。我只使用一个简单的 python 服务器对此进行了测试，它可以通过在终端运行 python -m SimpleHTTPServer 8000 来运行。但是，我假设你可以启动任何你喜欢的本地服务器，这就是你所需要的参考是端口号。如果您确实使用简单的 python 服务器，则该端口号为 8000。

在终端中运行 ifconfig。这将显示大量信息，您应该向下滚动大约一半。您正在寻找的是在 inet 之后和 en0: 或 en1: 键内的网络掩码之前跟随的一串数字。

完毕！在您的 Android 上，打开浏览器并访问 inet 号，后跟冒号 (:) 和端口号。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-03-25T04:19:46.497

虽然一个答案已被接受，但这对我有用：

1.  确保您的计算机和安卓设备都在同一个网络上。
2.  获取您计算机的 IP 地址。`ifconfig`（如果在终端内使用 mac 类型并查找`en0/en1 -> inet`它应该类似于`19*.16*.1.4`。）
3.  打开您的移动设置并转到网络-> 长按您的 wifi 网络-> 修改网络-> 向下滚动到高级选项-> 选择代理手册并在代理主机名中输入您的地址，即`19*.16*.1.4`在端口内输入您的端口。并保存它。

4.  在谷歌浏览器中搜索`what is my ip`，并获取您的 IP，假设它是`1**.1**.15*.2**`

5.  尝试 `1**.1**.15*.2**:port/`从您的移动设备访问。

就这么简单。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-04-23T16:16:34.857

**MacOS Catalina 10.15.4**

1.  转到*设置 -> 安全和隐私*。

[![在此处输入图像描述](../Images/7125e8ee68225d34fb61695ae66d6dd5.png)](https://i.stack.imgur.com/2AnML.png)

2.  选择*防火墙*选项卡并使用您的笔记本电脑密码解锁设置：

[![在此处输入图像描述](../Images/1011a5789690a999d91f577a293e5741.png)](https://i.stack.imgur.com/jLmu6.png)

3.  选择*防火墙选项...*，然后在对话框中取消选中**阻止所有传入连接**的框，然后单击确定。

[![在此处输入图像描述](../Images/395ef8c86f3fd0eae7b17e78bc79b257.png)](https://i.stack.imgur.com/sTXKV.png)

4.  打开终端并输入 ifconfig。寻找**en0**。在该部分中找到位于**inet**附近的地址- 这是您的笔记本电脑在本地网络中的地址。

```
en0: flags0=<UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST> mtu 0
...
        inet 192.168.0.123 netmask 0xffffff00 broadcast 192.168.0.255
... 
```

5.  使用 IP 地址 + 端口（如果您使用 localhost:4200 进行开发），否则省略端口：

```
http://<IP address found in en0 -> inet>:<port if needed> 
```

6.  利润！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-11-18T13:06:07.647

如果您使用 php 运行 localhost，则解决方案将替换`localhost`为 Macs IP

`php -S 192.168.x.x:8080`

代替

`php -S localhost:8080`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-22T21:25:16.137

正如其他答案中提到的，url 必须由计算机的 IP 地址而不是 localhost 组成。如果这不起作用，在尝试其他任何操作之前，请检查在 Android 应用程序中进行 api 调用时是否正确提及了端口以及 IP 地址。也就是说，您应该对以下格式的 url 进行 api 调用：`http://192.168.X.X:80/api/..`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-06-30T18:54:20.517

对于 MacO，打开系统偏好设置 > 网络。

您应该会看到消息“并且有 IP 地址：my-ip-address”

这将是您的 IP 地址，然后在浏览器中导航到 http://my-ip-address/port-number。切记不要在 http 中添加“s”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-31T06:18:22.533

要在 Android 上使用 localhost，您应该在连接时使用本地 IP 地址。首先检查您计算机的本地IP地址。然后跟着：

除了公认的答案之外，如果您需要通过本地 IP 地址使用 localhost，请按照以下步骤操作：

将您的本地 IP 地址添加到 httpd.conf (/etc/apache2/httpd.conf) 中，如下所示：

（根据您使用的服务器更改端口）

```
Listen 12.34.56.78:80 
```

Listen：允许您将 Apache 绑定到特定的 IP 地址和/或端口，而不是默认值。

保存，关闭并重新启动 apache。**

# android - 如何让 Android 在我不需要它之前不回收我的位图？

> ID：11005548
> 
> 赞同：1
> 
> 时间：2012-06-12T22:02:40.703
> 
> 标签：android, bitmap, garbage-collection

我正在获取视图的绘图缓存，该缓存设置为 Activity 的 contentView。然后我为活动设置新的内容视图并将该绘图缓存传递给它。但是 Android 回收了我的位图，我得到了这个异常：

> 06-13 01:58:04.132: E/AndroidRuntime(15106): java.lang.RuntimeException: Canvas: 试图使用回收的位图 android.graphics.Bitmap@40e72dd8

有什么办法解决吗？我有一个扩展 Bitmap 类的想法，但它是最终的。为什么GC要回收它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:17:35.887

被回收的位图并不意味着它是垃圾收集的，它意味着`Bitmap.recycle()`被故意调用它。我不熟悉具体的代码，但我很确定当你`setContentView()`用新的东西调用时，它会破坏以前的视图（因为假设你不再想要它们了）。它似乎遇到了一个问题`ImageView`，它要求`recycle()`它的位图成为一个好公民，然后给你你的错误。我的猜测是不支持您尝试执行的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:35:12.627

问题解决了，我只是将位图克隆到新的。我认为，发生异常是因为缓存视图与它的绘图缓存一起被删除。

# c# - 将 M 添加到 MVC？从 Webforms/DataTable 转换

> ID：11005554
> 
> 赞同：2
> 
> 时间：2012-06-12T22:03:36.777
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

在编写 Web 表单多年后，我正在尝试过渡到 MVC。我无法摆脱数据表并理解如何正确创建模型类。最大的问题是我的数据源是一个返回 XML 的宁静 Web 服务。

目前，我强烈地将视图模型键入为数据表。我是否因为不使用模型类而放弃了任何东西？我是否在控制器中包含太多信息？

下面只是一个简单的应用程序，它接受一个查询字符串值，使用一个 RESTful Web 服务执行搜索，然后在页面上输出结果。它可以工作，但我不觉得我已经创建了一个实际的 MVC 应用程序。

我的控制器：

```
using System.Web.Mvc;
using System.Data;
using System.Configuration;

namespace mvc1.Controllers
{
    public class HomeController : Controller
    {
        dhRestful _datahandler = new dhRestful(ConfigurationManager.ConnectionStrings["service"].ConnectionString);

        //
        // GET: /Home/
        public ActionResult Index(string search = "")
        {
            ViewBag.Title = "You searched for: " + search;

            using (DataTable dt = _datahandler.get("tv_show?name=" + search))
            {
                return View(dt);
            }
        }

    }
} 
```

dhRestful 是我从之前的项目中移植的一个辅助类。它会进行安静的 Web 服务调用并将响应 XML 序列化为 DataTable。如果我应该继续使用这个类，我应该把它放在项目文件的哪里？

```
using System.Data;
using System.Xml;

namespace mvc1
{
    public class dhRestful
    {
        string _hostPath = "";

        public dhRestful(string hostPath)
        {
            _hostPath = hostPath;
        }

        public DataTable get(string partialUrl)
        {
            using (XmlTextReader xr = new XmlTextReader(_hostPath + partialUrl))
            {
                using (DataSet ds = new DataSet())
                {
                    ds.ReadXml(xr);

                    if (ds.Tables.Count > 0)
                    {
                        return ds.Tables[0];
                    }
                    else
                    {
                        return new DataTable();
                    }
                }
            }
        }
    }
} 
```

使用剃刀的视图：

```
@model System.Data.DataTable

<h2>@ViewBag.Title</h2>

<table border="1">
    <thead>
        <tr>
            <th>ID</th>
            <th>Show Name</th>
        </tr>
    </thead>
    <tbody>
        @foreach (System.Data.DataRow row in Model.Rows)
        {
            <tr>
                <td>@row["id"].ToString()</td>
                <td>@row["name"].ToString()</td>
            </tr>
        }       
    </tbody>
</table> 
```

搜索名称为“Stargate”的示例 XML：

```
<myService>
  <tv_show>
    <id>72449</id>
    <name>Stargate SG-1 </name>
  </tv_show>
  <tv_show>
    <id>83237</id>
    <name>Stargate Universe </name>
  </tv_show>
  <tv_show>
    <id>70852</id>
    <name>Stargate: Infinity </name>
  </tv_show>
  <tv_show>
    <id>70851</id>
    <name>Stargate Atlantis </name>
  </tv_show>
</myService> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:13:56.023

我建议您在 Composition 根目录中通过依赖注入来编写此数据访问层。因此，稍后您可以注入一个满足合同的不同客户端，而不是休息客户端。

另一个注意事项是创建视图模型。如果您是直接在您的应用程序中使用的 VO 或 DTO，那么包装它们是一个很好的做法。我想这就是你的答案。您可以在模型文件夹中查看模型，也可以创建子文件夹等。

像这样的东西：

```
 // you need to adjust your dependency accordingly
   Interface IRepository<T> : where t has a value
   {
     void Set(T item);
     T Get(some value that you indicate in T);
   }

    namespace mvc1.Controllers
    {
        public class HomeController : Controller
        {
            IRepository<SomeObject> _repo;

            public HomeController(IRepository<SomeObject> repository)
            {
               _repo = repository;
            }             

            //
            // GET: /Home/
            public ActionResult Index(string search = "")
            {
                ViewBag.Title = "You searched for: " + search;

                using (SomeObject obj = _repo.get("tv_show?name=" + search))
                {
                    // here you can use automapper to map a DTO or VO to View model.
                    FooViewModel model = someobject;
                    return View(model);
                }
            }

        }
    } 
```

在组合根：global.asax，您可以引导容器。很多方法，看看结构图和如何使用容器。

# java - Zip 文件作为 InputStream，然后分离其中的每个文件，然后将其转换为图像。在 Java 中

> ID：11005556
> 
> 赞同：0
> 
> 时间：2012-06-12T22:03:42.020
> 
> 标签：java, zip, bytearray, inputstream, pdfbox

我得到一个 zip 文件作为`InputStream`. 然后我将其中的每个文件分开。然后我将其传递给内部用于将其转换为图像`byte array`的[pdfbox 。](https://code.google.com/p/do-pdf/)`Apace pdf box 1.6.0`

但是，当我将其传递`byte array`给时，`PDFDocumentReader`我得到以下异常-

```
SEVERE: expected='endstream' actual='' org.apache.pdfbox.io.PushBackInputStream@44c2beb9
java.io.IOException: expected='endstream' actual='' org.apache.pdfbox.io.PushBackInputStream@44c2beb9
at org.apache.pdfbox.pdfparser.BaseParser.parseCOSStream(BaseParser.java:439)
at org.apache.pdfbox.pdfparser.PDFParser.parseObject(PDFParser.java:530)
at org.apache.pdfbox.pdfparser.PDFParser.parse(PDFParser.java:172)
at org.apache.pdfbox.pdmodel.PDDocument.load(PDDocument.java:862)
at org.apache.pdfbox.pdmodel.PDDocument.load(PDDocument.java:829)
at org.dopdf.document.read.pdf.PDFDocumentReader.init(PDFDocumentReader.java:98) 
```

要从 zip 中获取每个文件，我使用以下代码 -

```
 ZipInputStream zis = new ZipInputStream(aZipFile); // aZipFile is byte array
    ZipEntry entry;
    ArrayList<String> nameOfIgnoredFiles = new ArrayList<String>();
    byte data[] = null;
    while ((entry = zis.getNextEntry()) != null) {
        if (entry.getName().endsWith(".pdf")) {
            int dataSize = (int)entry.getSize();
            data = new byte[dataSize];
            zis.read(data);
            // i use data and pass it to the pdf box.
        } else {
            nameOfIgnoredFiles.add(entry.getName());
        } 
```

然后将我在上面获取的`data`字节数组传递给如下 -

```
PDFDocumentReader document = new PDFDocumentReader(data); // here i get the error 
```

我究竟做错了什么？你能提出一个解决方案吗？我猜数据字节数组的获取是一个问题。如何做到最好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:07:59.677

您假设`zis.read(data)`填充缓冲区。检查 API 文档。不能保证这样做。您还假设大小适合 int，并且项目本身适合内存。这些假设都不成立。

当然，您可以将条目传递`InputStream`给`pdfbox`API 吗？

# mysql - 如何判断 MySQL 客户端脚本中是否发生错误

> ID：11005558
> 
> 赞同：0
> 
> 时间：2012-06-12T22:04:15.417
> 
> 标签：mysql, transactions, commit, rollback

我无法发现如何判断 MySQL 客户端脚本中是否发生错误（经过几个小时的谷歌搜索和阅读 MySQL 文档。我希望在出现错误时会设置错误标志或错误号之类的东西发生并且您可以使用以下内容进行测试：

开始交易error_flag = false；#只是为了安全...做一些工作... ...做更多工作... if (error_flag == true) then rollback else commit ;

这样做的规范是什么？我是否认为这种方法可行？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:10:55.487

```
 $result = mysql_query($query);
    if (!$result) {
        $errm = "[SQL" . mysql_errno() . "] " . mysql_error();
        $this->rollback(); //implement your rollback
        throw new Exception($errm);
    } 
```

这是旧的 mysql_* 方式。请改用 pdo。

# python - 对于 Django 中的 1 对 1 关系，这 2 个模型是否共享 id？

> ID：11005562
> 
> 赞同：1
> 
> 时间：2012-06-12T22:04:43.907
> 
> 标签：python, django, django-models

如果我的模型与另一个模型具有 1 对 1 的关系，它们是否共享主 ID？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:07:01.910

绝对不。

> `OneToOneField`用于自动成为模型主键的类。这不再是真的（尽管您可以根据需要手动传入 `primary_key`参数）。因此，现在可以`OneToOneField`在单个模型上拥有多个类型的字段。

*来源：* [https ://docs.djangoproject.com/en/dev/topics/db/models/#one-to-one-relationships](https://docs.djangoproject.com/en/dev/topics/db/models/#one-to-one-relationships)

# image-processing - 如何根据颜色和大小分割对象？

> ID：11005569
> 
> 赞同：3
> 
> 时间：2012-06-12T22:05:16.820
> 
> 标签：image-processing, opencv, computer-vision, image-segmentation

我有两个使用 Open-CV 处理的图像处理问题。

1.  识别彼此不同颜色的相似物体。
2.  识别彼此不同大小的相似颜色对象。

场景 1 和 2 的示例图像；

1

![不同颜色](../Images/0b0e455b497683b425ec56afacf2a9d6.png)

2

![大小不一](../Images/ec468633acc3df8afa32865d148cfe9d.png)

两幅图像都具有三种类型的感兴趣对象。（三种颜色或尺寸）

我遇到的技术包括阈值化，然后使用带有像素计数的腐蚀，使用 RGB 值进行颜色分割。

什么是好的工作链，什么是好的起点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T12:22:13.950

对于颜色分割，您应该远离 RGB，因为相似的颜色不是线性相关的。

例如，2 种相似的颜色（具有相同的色调）可能具有非常不同的 RGB 值：

![相同的色调和非常不同的 RGB 值](../Images/1782f52109022cac1fe1ba432d6a35ae.png)

最好使用颜色空间，如 LUV 或 HSV，它们已将颜色与亮度分开。例如，您可以尝试对 LUV 的 U、V 分量进行聚类算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:14:17.877

看看[cvBlob](http://code.google.com/p/cvblob/)，它工作得很好，可以处理复杂的形状。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T02:19:12.853

1.  显然，使用 RGB 值可能是从这里开始的最佳方式。使用函数 cvSplit，它将为您提供三个分离的计划 B、G 和 R（使用 OpenCV 的 BGR 顺序，而不是 RGB）。在每一个中，您应该只看到相应颜色的圆圈。

2.  我建议在这里首先使用 Canny 算法执行边缘检测，通过函数 cvCanny 在 OpenCV 中实现，然后使用 Hough 算法进行圆检测，也在 OpenCV 中实现。如果我没记错的话，霍夫圆的 OpenCV 函数会返回圆属性（半径...），这将允许您根据圆的大小来识别圆。2\. 的另一个选项是使用形态学的 Hit&Miss 算法。我从来没有在 OpenCV 中使用过形态学，只在 Matlab 中使用过。

玩得开心

# java - 获取派生类中字段的java注释

> ID：11005570
> 
> 赞同：2
> 
> 时间：2012-06-12T22:05:17.930
> 
> 标签：java, android, annotations

在我的 Android 应用程序中，我有以下类：

```
public abstract class A implements IA {
    private void findAnnotations() {
        Field[] fields = getClass().getFields();

        // Get all fields of the object annotated for serialization
        if (fields != null && fields.length > 0) {
            for (Field f : fields) {
                Annotation[] a = f.getAnnotations();

                if (annotation != null) {
                    // Do something
                }
            }
        }

        return serializationInfoList
                .toArray(new SoapSerializationFieldInfo[serializationInfoList
                        .size()]);
    }
} 
```

和

```
public abstract class B extends A {
    @MyAnnotation(Name="fieldDelaredInB")
    public long fieldDelaredInB;
} 
```

当我调用时`B.findAnnotations()`，我可以看到`getClass().getFields()`返回在 B - 中声明的字段`fieldDelaredInB`，例如，但没有返回这些字段的注释 - 即，当我调用时，我得到 null `f.getAnnotations()`，`f.getDeclaredAnnotations()`或其他任何情况。

这是不熟悉派生类属性的超类的问题吗？考虑到派生类的字段在我`getFields()`从超类调用时出现的事实，这似乎很奇怪。

关于我错过了什么的任何想法？

谢谢，哈雷尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T22:19:23.280

除非使用 标记为运行时保留，否则不会在运行时加载注释`@Retention(RetentionPolicy.RUNTIME)`。您必须将此`@Retention`注释放在`@MyAnnotation`注释上：

```
@Retention(RetentionPolicy.RUNTIME)
public @interface MyAnnotation {
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:11:44.520

反而

```
if (annotation != null) {
    // Do something
} 
```

你应该有

```
if (a != null) {
    //do something
} 
```

此外，如果您搜索所需的注释会更快，如下所示：

```
Annotation a = f.getAnnotation(MyAnnotation.class); 
```

# ruby-on-rails - 从模型中访问 c urrent_user 的最优雅方式是什么？或者为什么这是一个坏主意？

> ID：11005574
> 
> 赞同：2
> 
> 时间：2012-06-12T22:05:34.123
> 
> 标签：ruby-on-rails, ruby, activerecord

所以，我已经在我的用户和用户修改的对象之间实现了一些权限。我想减少视图/控制器与模型之间的耦合（调用所述权限）。为此，我有一个想法：在 // 回调中实现一些`before_save`权限功能`before_create`。`before_destroy`但由于权限与用户 ( `current_user.can_do_whatever?`) 相关联，我不知道该怎么做。

这个想法甚至可能会增加耦合，`current_user`特别是控制器级别。

我最初想这样做的原因是：在我的控制器中，我必须检查用户是否有能力`save`// `create`。那么，`destroy`为什么不像 rails'已经做的那样返回 false `save`，然后向模型对象添加错误并返回 false ，就像 rails 的验证一样？`create``destroy``.save`

Idk，这是好事还是坏事？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T22:35:57.370

让控制器检查用户的权限。让模型处理授权逻辑会导致*更多的*耦合（只是在不同的地方，并且仍然会耦合到控制器以获取当前用户）。检查权限并不是模型的真正*内部*逻辑。

明喻：想象一下，如果检查您是否可以读取/写入文件是文件的责任，而不是让操作系统（实际上是所有控制器的母亲）处理访问。

如果您想要更清洁的控制器，您可以（例如）制作一些通用的 before_filters，根据当前用户限制对 CRUD 操作的访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T11:50:06.740

Flambino 给了你派对路线 :) 但让我加上我的 2 美分。当然可以将访问控制逻辑视为模型的一部分。

模型验证是一种检查操纵用户对 crud 操作的权限的方法。这样做的一个缺点正是访问逻辑通常跨模型泛化这一事实，因此我们喜欢​​将它们抽象出来，就像在一个整洁的 cancan 能力文件中一样。

实际上，您可以通过使您的操作本身成为模型上的多态关联来获得您的蛋糕并吃掉它。这就是大多数审计/版本控制系统的实现方式。 [https://github.com/collectiveidea/audited](https://github.com/collectiveidea/audited) 你可以扩展它并将你的访问控制逻辑放在审计类验证中，所以它在一个地方。Audited gem 还提供了一种巧妙的方法，通过使用观察者作为控制器上的环绕过滤器，将当前用户传递到模型级别。 [https://github.com/collectiveidea/audited/blob/master/lib/audited/sweeper.rb](https://github.com/collectiveidea/audited/blob/master/lib/audited/sweeper.rb) 但也有其他方法[https://github.com/bokmann/sentient_user](https://github.com/bokmann/sentient_user)通常被认为是 hacky。

注意事项

*   在任何一种情况下，当 current_user 定义不正确时，您都必须防止在请求周期之外（在后台例程、cronjob、控制台中）操作模型的情况。

*   您通常不想使用验证错误来处理访问冲突，而是使用标准的 http 状态代码响应。

*   第三，在网络应用程序设置中，您通常通过表单操作对象，并且通常您已经可以控制访问权限，例如更新表单，实际上通常与更新本身具有相同的访问权限（甚至可以具有新建/创建和编辑的通用别名/update) 因此，如果后者通过验证处理，则此通用访问逻辑将丢失。更不用说模型验证无法处理读取访问逻辑。

希望这可以帮助

# mysql - MySQL - 在重复键上插入 - 2 列

> ID：11005575
> 
> 赞同：5
> 
> 时间：2012-06-12T22:05:43.407
> 
> 标签：mysql

我将记录我的用户登录时使用的 IP 地址。为此，我有一个包含 3 列的简单表：用户、IP、时间。time 是他们最后一次使用该地址登录的时间。

当他们登录时，我想在数据库中插入一行，其中包含他们登录的 IP 以及他们登录的时间。

如果已经存在具有相同用户和相同 ip 的行，我只想更新时间。一个更普遍的问题：

如果其中的两个（或更多）列相同，我如何插入一行或更新它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-12T22:07:18.803

您只需要创建复合唯一键`user + ip`并使用`INSERT ON DUPLICATE KEY UPDATE`

```
INSERT INTO tbl (user, ip, `time`) VALUES (1, '1.2.3.4', NOW())
ON DUPLICATE KEY UPDATE `time` = NOW() 
```

要创建索引，请使用类似

```
CREATE UNIQUE INDEX tbl_user_ip ON tbl (user, ip) 
```

# javascript - 将 SVG 与 Jquery 一起使用

> ID：11005577
> 
> 赞同：0
> 
> 时间：2012-06-12T22:05:45.107
> 
> 标签：javascript, jquery, html, svg

我想在我的 HTML 中嵌入一个 SVG，并使用 Jquery 在其上绑定事件。但是我的 Jquery 调用得到了意想不到的结果。这*有时会*导致*Uncaught ReferenceError: sayHello is not defined*在我的浏览器中。但在其他时候，它根本没有正确地将控制台打印绑定到单击事件。

```
<a href='#'> Click me! </a>
<embed id='board' src="tictactoe.svg" height="100%" width="100%" style="border:solid #999 1" >

<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" viewBox="0 0 100 100" onload="sayHello()"> 
...
</svg>

function sayHello() {
    $('a').on('click',function(e){e.preventDefault(); console.log('hello');});
} 
```

# html - Rails + HTML 代码；尴尬的结果=错误的方法？

> ID：11005579
> 
> 赞同：0
> 
> 时间：2012-06-12T22:05:59.320
> 
> 标签：html, ruby-on-rails, ruby

我有一个 Portfolio 模型，其中包含一个文本类型的注释字段，其值是一组由 cr 和 nl 字符组合分隔的段落。目标是将段落提取到一个数组中，将它们包装在 <p> 标签中，然后重新加入它们以输出到浏览器；所以下面代码的重点是第 6-8 行。

我遇到的问题是 < 和 > 字符被呈现为 HTML 实体 < 和>。

我是 Ruby 和 Rails 的新手，所以我的猜测是这不能按预期工作的原因是因为我可能采用了不正确的方法——我想知道一个有经验的 Ruby 编码器将如何解决这个问题种情况。在将内容发送到视图之前，如何将 HTML 标记插入到内容中？或者这总是违反 MVC 模型——在这种情况下，解决这类问题的正确方法是什么？

这是代码：

```
1\.   module ApplicationHelper
2\.   
3\.     def portfolio_featured
4\.       @portfolios = Portfolio.all
5\.       @portfolios.each do |p|
6\.         paras = p.comments.split(/\r?\n\r?\n/)
7\.         paras.collect! { |p| "<p>" + p + "</p>" }
8\.         p.comments = paras.join
9\.       end
10\.    end
11.
12\.  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:18:41.243

看看[simple_format](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format) TextHelper。

这可能是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:20:02.540

您可以使用[TextHelper#simple_format](http://apidock.com/rails/ActionView/Helpers/TextHelper/simple_format)或[Bluecloth](http://deveiate.org/projects/BlueCloth/) (Markdown) 之类的花哨的东西，但如果您想自己做饭，那就是您可以编写的（关键是使用[safe_join](http://apidock.com/rails/ActionView/Helpers/OutputSafetyHelper/)）：

```
def portfolio_featured
   safe_join(Portfolio.all.map do |portfolio|
     portfolio.comments.lines.map { |line| content_tag(:p, line.chomp) }
   end)
end 
```

# sql - 列操作

> ID：11005580
> 
> 赞同：0
> 
> 时间：2012-06-12T22:06:06.200
> 
> 标签：sql, excel

我有一个查询，它从唯一 ID 列表中生成 8 列数据。然后将这些列复制到 Excel 表中以供保存。我试图找到一种方法来编写查询或找到一个 excel 函数来让它生成 2 列：1 带有唯一 ID 列表，另一个带有它在最初 8 列中出现的次数。任何想法或评论都将受到欢迎。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:23:36.393

如果我正确理解您的问题，您可以编写一个返回两列的查询。不幸的是，这有点乏味，但它应该可以工作。这是通用的，足以在任何 RMDBS 中工作。使用特定 RMDBS 的特定功能可能有更优雅的解决方案。

```
SELECT DISTINCT A.UniqueID, SUM(A.IDCounter) AS IDCount FROM
(
SELECT UniqueIDCol1 AS UniqueID, Count(UniqueIDCol1) AS IDCounter
FROM MyTable
GROUP BY UniqueIDCol1

UNION ALL

SELECT UniqueIDCol2 AS UniqueID, Count(UniqueIDCol2) AS IDCounter
FROM MyTable
GROUP BY UniqueIDCol2

UNION ALL 
.
.
.
SELECT UniqueIDCol8 AS UniqueID, Count(UniqueIDCol8) AS IDCounter
FROM MyTable
GROUP BY UniqueIDCol8

) AS A

GROUP BY A.UniqueID 
```

# mysql - 在mysql中正确使用where？

> ID：11005583
> 
> 赞同：1
> 
> 时间：2012-06-12T22:06:23.140
> 
> 标签：mysql, where

我开始学习php和我的sql。

我不知道这段代码有什么问题。

```
$result = mysql_query("SELECT * FROM tbl where field1 (1,2,3)"); 
```

我收到这个错误。

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in test.php on line 52 
```

当我用这个替换那个特定的行时

```
$result = mysql_query("SELECT * FROM tbl"); 
```

它工作正常，但它返回所有行。

我正在尝试使用 mysql 中的 where 命令过滤行显示。

什么是正确的语法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T22:07:44.547

你需要一个`IN`子句：

```
$result = mysql_query("SELECT * FROM tbl where field1 IN (1,2,3)"); 
```

此查询类似于：

```
SELECT * FROM tbl where field1=1 OR field1=2 OR field1=3 
```

**另外**，请记住，它`mysql_query`已被[弃用](http://www.php.net/manual/en/function.mysql-query.php)，不鼓励使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:11:25.353

首先.. 停止使用 mysql 扩展，因为它已被弃用...

除此之外，您还可以执行以下操作：

`$result = mysqli_query("SELECT * FROM tbl WHERE field IN (1,2,3)");`

这里还有一些不完全适合你的例子......

`$result = mysqli_query("SELECT * FROM tbl WHERE date BETWEEN "2012-06-01 00:00:00" AND "2012-06-12 23:59:59");`

[http://dev.mysql.com/doc/refman/5.0/en/where-optimizations.html](http://dev.mysql.com/doc/refman/5.0/en/where-optimizations.html)将为您提供有关 WHERE 子句本身以及如何正确利用和优化它的一些信息。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T22:08:16.620

尝试这个：

```
$result = mysql_query("SELECT * FROM tbl where field1 IN (1,2,3)"); 
```

# search - 谷歌地图栏

> ID：11005592
> 
> 赞同：0
> 
> 时间：2012-06-12T22:07:32.267
> 
> 标签：search, maps

我正在尝试简单地将 Google 搜索栏添加到我自己的地图上，但遇到了问题。我似乎无法让它工作！我试过 map.enableGoogleBar(); 但这只是摆脱了我的 KML 层并且没有添加搜索框！

这是代码：

```
 function initialize() {
        // set up startup options for the map 
        // disabled double click as it was annoying and streetview control removed. 
        var myOptions = {
            zoom: 10,
            //minZoom: 16,
            center: new google.maps.LatLng(50.45750, -3.84521),
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            disableDoubleClickZoom: true,
            streetViewControl: false,

            mapTypeControl: true,
            navigationControl: true,
            navigationControlOptions: {
                style: google.maps.NavigationControlStyle.ZOOM_PAN,
                position: google.maps.ControlPosition.TOP_LEFT
            },
            scaleControl: true,
                scaleControlOptions: {
                position: google.maps.ControlPosition.BOTTOM_LEFT
            }

            enableGoogleBar: true,
            googleBarOptions: {showOnLoad:true},
        };

        // create the new map
        map = new google.maps.Map(document.getElementById('map_canvas'),
            myOptions); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:01:41.630

我看到了 2 个问题

1.  您在 myOptions 对象中的“enableGoogleBar”之前缺少一个逗号。
2.  您正在使用 Google Maps v3 API 并检查 [https://developers.google.com/maps/documentation/javascript/reference](https://developers.google.com/maps/documentation/javascript/reference)上的文档，它根本没有提到对 enableGoogleBar 选项的支持。它仅在 Google Maps API 的第 2 版中可用。

# c++ - 如何使用具有网格三角形的绝对坐标和光线开始/结束的 rayTestSingle？

> ID：11005594
> 
> 赞同：1
> 
> 时间：2012-06-12T22:07:34.180
> 
> 标签：c++, collision-detection, bullet, raycasting

我创建了一个简单的`btCollisionShape`（从一个三角形制成的 triMesh）：

```
btTriangleMesh *mTriMesh = new btTriangleMesh();

btVector3 v0(1, 1,0);
btVector3 v1(-1,-1,0);
btVector3 v2(1,-1,0);

mTriMesh->addTriangle(v0,v1,v2);

btCollisionShape *mTriMeshShape = new btBvhTriangleMeshShape(mTriMesh,true); 
```

我创造了`ClosestRayResultCallback`

```
btVector3 Start(-1, -1,-1);
btVector3 End(1,1,1);

btCollisionWorld::ClosestRayResultCallback RayCallback(Start, End); 
```

如何[`btCollisionWorld::rayTestSingle`](http://bulletphysics.com/Bullet/BulletFull/classbtCollisionWorld.html#aca2a9413508b4a2449fe83ff93ea564e)在`btCollisionShape`我的光线开始和结束并且没有应用转换时执行？

同时，我在整个世界上尝试了 rayccast（实际上我不需要），但似乎我做错了 =( 因为我没有看到[`hasHit`](http://bulletphysics.com/Bullet/BulletFull/structbtCollisionWorld_1_1RayResultCallback.html#aae67fea02049a28c09ed6c3807611b57)：

```
int i;

btDefaultCollisionConfiguration* collisionConfiguration = new btDefaultCollisionConfiguration();

btCollisionDispatcher* dispatcher = new btCollisionDispatcher(collisionConfiguration);

btBroadphaseInterface* overlappingPairCache = new btDbvtBroadphase();

btSequentialImpulseConstraintSolver* solver = new btSequentialImpulseConstraintSolver;

btDiscreteDynamicsWorld* World = new btDiscreteDynamicsWorld(dispatcher,overlappingPairCache,solver,collisionConfiguration);

btTriangleMesh *mTriMesh = new btTriangleMesh();

btVector3 v0(1, 1,0);
btVector3 v1(-1,-1,0);
btVector3 v2(1,-1,0);

mTriMesh->addTriangle(v0,v1,v2);

btCollisionShape *mTriMeshShape = new btBvhTriangleMeshShape(mTriMesh,true);
btCollisionObject *mTriMeshCO = new btCollisionObject ();

mTriMeshCO->setCollisionShape(mTriMeshShape);
World->addCollisionObject(mTriMeshCO);
btVector3 End(-1, -1,-1);
btVector3 Start(1,1,1);

btCollisionWorld::ClosestRayResultCallback RayCallback(Start, End);

World->rayTest(Start, End, RayCallback);

if(RayCallback.hasHit()) {
    btVector3 End = RayCallback.m_hitPointWorld;
    btVector3 Normal = RayCallback.m_hitNormalWorld;

    // Do some clever stuff here
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T11:37:01.443

![在此处输入图像描述](../Images/2fbbb1fc1212a6c0e6df6f16de22377c.png)

请看上图。我试图画出你的三角形和光线投射矢量。光线投射矢量在 (0,0,0) 处与 XY 平面相交。现在，点 (0,0,0) 实际上位于三角形的边缘。如果命中位于边缘，则光线投射算法返回命中测试 true 取决于实现。如果您正在对此进行测试，为什么不尝试使用修改后的光线投射矢量，您肯定知道它会击中其中的三角形？

# android - 将 gettimeofday() 微秒转换为秒

> ID：11005598
> 
> 赞同：0
> 
> 时间：2012-06-12T22:07:57.710
> 
> 标签：android

在 Android 框架代码中，有一段代码以微秒为单位计算当前时间，如下所示。有谁知道为什么因子是 1000000ll 而不是 1000000？

```
static int64_t getNowUs() {
    struct timeval tv;
    gettimeofday(&tv, NULL);

    return (int64_t)tv.tv_usec + tv.tv_sec * 1000000ll;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:11:15.557

我很确定这可能只是一个 64 位整数后缀，比如 C++。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:18:25.097

1000000ll 是 1000000 长，整数末尾的 l 表示长，如果你看这里[http://androidxref.com/source/xref/frameworks/ex/variablespeed/jni/integral_types.h](http://androidxref.com/source/xref/frameworks/ex/variablespeed/jni/integral_types.h)它有

```
typedef long long int64;  // NOLINT 
```

[http://androidxref.com/source/xref/frameworks/base/media/libstagefright/rtsp/ARTPAssembler.cpp](http://androidxref.com/source/xref/frameworks/base/media/libstagefright/rtsp/ARTPAssembler.cpp)

# jquery - 如何调整 jScrollPane 的大小并让滚动识别内容的高度

> ID：11005605
> 
> 赞同：0
> 
> 时间：2012-06-12T22:08:31.813
> 
> 标签：jquery, jscrollpane

我继承了一个使用`jScrollPane`（使用 jQuery）折叠和展开的项目。当 scrollPane 展开时，我们注意到您可以滚动到内容的末尾。有没有办法告诉 jScrollPane 在调整大小时内容的高度不同？

我试图销毁/重新创建`jScrollpane`using `api.destroy`，但我只看到它消失了，或者使用原始尺寸重新创建，这不是我需要的。

我在[http://jsfiddle.net/tssparky/4StG2/10/创建了一个示例](http://jsfiddle.net/tssparky/4StG2/10/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T19:00:46.510

我必须为 jScrollPane 创建一个包装器 div，然后在包装器上设置固定宽度。对于 jScrollPane，我将宽度设置为 100%。当我调整包装器 div 的大小时，我重新实例化了 jScrollPane 并重新排列了内容。这给了我想要的结果。

```
$('#scrollpanecontainer').animate({
    'width': '700px',
    'left': '0'
    }, 100, function() {
        $('#scroll-pane').jScrollPane({ width: '100%', contentWidth: '100%', autoReinitialise: false});                 
}); 
```

# visual-studio-2010 - F# 停止控制台关闭

> ID：11005607
> 
> 赞同：16
> 
> 时间：2012-06-12T22:08:34.487
> 
> 标签：visual-studio-2010, f#, console

> **可能重复：**
> [F#：此表达式应具有“unit”类型，但具有“ConsoleKeyInfo”类型](https://stackoverflow.com/questions/324947/f-this-expression-should-have-type-unit-but-has-type-consolekeyinfo)

我正在学习 F#，所以我在 VS2010 中编写了 3 行代码，我想查看结果但控制台关闭。System.Console.Read System.Console.ReadKey 或类似的命令不起作用。还有其他方法可以阻止控制台关闭吗？

```
let x = 20
let y = x = 20
printf "is x 20? %d" y
System.Console.ReadKey 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-12T22:14:10.547

你需要做

```
System.Console.ReadKey() |> ignore 
```

最后需要按键退出 - 这`()`是实际调用该函数并且`|> ignore`是因为您不关心结果

# scala - Scala警告擦除以防万一

> ID：11005608
> 
> 赞同：3
> 
> 时间：2012-06-12T22:08:36.917
> 
> 标签：scala, warnings, pattern-matching, type-erasure, case-statement

我在 scala 函数中有以下模式匹配案例：

```
def someFunction(sequences: Iterable[Seq[Int]]):Seq[Int] = sequences match{
    case Seq() => Seq(1)
    case _ => ...
    ...
} 
```

我收到以下警告：

```
warning: non variable type-argument A in type pattern Seq[A] is unchecked since it is eliminated by erasure
case Seq(_) => Seq(1)
        ^
one warning found 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T23:50:25.807

这个警告有点虚假，在 Scala 2.10 上不会出现。事实上，我认为这是 Scala 2.8 的回归（也就是说，它不存在于那里）。

警告的原因是它解释`Seq(_)`为 mean `Seq(_: Seq[Int])`，因为这是 的类型参数`sequences`，然后抱怨它不能保证在`Int`那里，因为在编译时，它将被删除。正如我所说，这是虚假的。

# ruby-on-rails-3 - 与 WickedPDF 和 Heroku 的环境冲突

> ID：11005609
> 
> 赞同：2
> 
> 时间：2012-06-12T22:08:40.630
> 
> 标签：ruby-on-rails-3, heroku, wicked-pdf

我正在使用 WickedPDF，我基本上有两个包含二进制文件的 gem：

```
gem "wkhtmltopdf-heroku", "1.0.0"
gem "wkhtmltopdf-binary", "0.9.5.3" 
```

第一个应该只用于生产，第二个用于开发。如果我的 Gemfile 如下所示，则部署到 Heroku 将不起作用：

```
group :development do
  gem "wkhtmltopdf-binary", "0.9.5.3"
end

group :production do
  gem "wkhtmltopdf-heroku", "1.0.0"
end 
```

如果我有它，它也不起作用：

```
group :production do
  gem "wkhtmltopdf-heroku", "1.0.0"
end 
```

如果我没有分组，它就可以工作。就像：

```
gem "wkhtmltopdf-heroku", "1.0.0" 
```

我得到的错误是：

**RuntimeError：wkhtmltopdf 的位置未知**

为什么会发生这种情况？为什么 Heroku 不使用生产组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T18:49:35.603

WickedPdf 试图找出 wkhtmltopdf 二进制文件的位置，但在某些系统（尤其是共享服务器）上可能会遇到困难。

您可能必须在初始化程序中手动设置它，如下所示：

```
bin_location = case Rails.env
  when 'production' then "/wherever/your/binary/is/bin/wkhtmltopdf"
  when 'development' then "/local/path/to/wkthmltopdf"
  else `which wkhtmltopdf`
end
WickedPdf.config = { :exe_path => bin_location } 
```

# java - 等待从 JFrame 2 返回以继续在 JFrame 1 中执行一些语句

> ID：11005618
> 
> 赞同：-1
> 
> 时间：2012-06-12T22:10:02.507
> 
> 标签：java, swing, jframe

假设我有 2 个 JFrames (A) & (B)

框架 (A) 触发框架 (B)，如下所示

```
line 1: private void fun1()
line 2: {
line 3:      new B();
line 4:      Do something
line 5: } 
```

在第 3 行中，我激活了 B 帧 .. 我不想转到第 4 行，直到我从 JFrame (B) 转回来，因为根据 Frame (B) 中的一些动作，我做了一些这样的动作

```
new (B);
container.add(JPanel); 
```

`container.add(JPanel);`--> 依赖于从 JFrame (B) 触发的标志

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T22:16:47.673

考虑使用[模式对话框](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)来显示框架 B 的内容。

# php - 从另一个页面的 div 中提取和嵌入代码

> ID：11005624
> 
> 赞同：0
> 
> 时间：2012-06-12T22:10:53.787
> 
> 标签：php, html, simple-html-dom

我正在使用 simple-html-dom 尝试从另一个站点提取一些代码。这是一些简单的示例代码，可以复制我想要完成的工作。

```
<html>
  <body>
    <h1>Title!</h1>
    <div class="sample">
        <div class="another_class">...</div>
        <div class="one_more">
          Some awesome text!
        </div>
    </div>
    <div class="sample">
        <div class="another_class">...</div>
        <div class="one_more">
          Some awesome text!
        </div>
    </div>
    <div class="sample">
        <div class="another_class">...</div>
        <div class="one_more">
          Some awesome text!
        </div>
    </div>
  </body>
</html> 
```

所以我试图拉出所有 div 样本块......包括标签。所以基本上我想将以下代码回显到我的网站、标签和所有内容上：

```
 <div class="sample">
        <div class="another_class">...</div>
        <div class="one_more">
          Some awesome text!
        </div>
    </div>
    <div class="sample">
        <div class="another_class">...</div>
        <div class="one_more">
          Some awesome text!
        </div>
    </div>
    <div class="sample">
        <div class="another_class">...</div>
        <div class="one_more">
          Some awesome text!
        </div>
    </div> 
```

我今天刚刚了解了 simple-html-dom，所以我仍在努力解决。这是我到目前为止收集的内容，但不起作用。

```
<?php
  include('simplehtmldom_1_5/simple_html_dom.php');
  $page = 'http://www.sampleURL.com';
  $html = file_get_html($page);
  foreach($html->find('div.sample') as $element) 
    echo $element->outertext . '<br />';    
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:58:47.277

我解决了自己的问题...我试图从错误的 URL 中提取>_>

难怪它没有返回任何东西！我发布的代码是正确的。

# javascript - JavaScript：将继承的类添加到数组不起作用

> ID：11005628
> 
> 赞同：5
> 
> 时间：2012-06-12T22:11:15.030
> 
> 标签：javascript, arrays, inheritance, prototype

我在使用 JavaScript 时遇到了一些问题。我有以下代码：

```
<html>
<head>
<title>Test</title>
<script  type="text/javascript">
function Control(){
    var name;

    this.setName = function(newName){
        name = newName;
    };

    this.getName = function(){
        return name;
    };
}

function SpecializedControl(){
}
SpecializedControl.prototype = new Control();

function Form(){
    var formControls = [];

    this.addControl = function(control){
         formControls.push(control);

         alert(formControls[0].getName());
    };
}

var form = new Form();

var control1 = new SpecializedControl();
control1.setName("Control1");
form.addControl(control1);

var control2 = new SpecializedControl();
control2.setName("Control2");
form.addControl(control2);

</script>
</head>
<body>
</body>
</html> 
```

SpecializedControl 继承自 Control 类。

Form 类中的 addControl 函数只是将控件添加到数组中。

问题是当我添加多个 SpecializedControl 时，数组中的值会被覆盖，这意味着当我访问数组中的第一项，应该是“Control1”时，我会得到“Control2”。Control1 不再在数组中。

当我使用与 Control 对象相同的函数作为参数时，一切都按预期工作。

有人知道为什么会发生这种情况以及可以采取哪些措施来纠正这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:23:59.153

您的`get/setName`函数正在获取/设置构造函数`name`本地变量的值。`Control`

您调用该函数的唯一一次是创建一个实例`prototype`作为`SpecializedControl`. 因此，每次`setName`从`SpecializedControl`实例调用时，都会更新该单个变量。

因此，由于`get/setName`引用该变量的方法在所有`SpecializedControl`实例的原型链中，它们都将观察到相同的`name`.

* * *

在`setName`，你应该做...

```
this.name = newName; 
```

在`getName`，你应该做...

```
return this.name; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T22:32:26.960

数组中的值没有被覆盖；问题是两个控件共享相同的`name`变量。因为`Control`函数只执行一次，所以只`name`声明了一个变量。

您有两个主要选项来解决此问题。(1) 制作`name`一个特定于每个单独控件的实例变量（例如`this._name`）。(2)`Control`从构造函数内部执行函数`SpecializedControl`。（实际上，IMO，对于平衡且彻底的继承模型，您应该对这两种方法都做一些事情）。

以下是三个可行的解决方案。前两个分别使用选项 (1) 和 (2)。第三个结合了这两种方法，是我会做的方式（但需要[joi](http://joijs.com)）。

选项1：

```
function Control(){

    this.setName = function(newName){
        this._name = newName;
    };

    this.getName = function(){
        return this._name;
    };
} 
```

选项 2：

```
function SpecializedControl(){
    Control.apply(this, arguments);
} 
```

选项 3：

```
var Control = joi.Unit.sub(function() {

    function constructor() {
        this.base();
    }

    constructor.prototype = {
        '#name': null,
        setName: function(name) {
            this['#name'] = name;
        },
        getName: function() {
            return this['#name'];
        }
    };

    return constructor;

}());

var SpecializedControl = Control.sub(function() {

    function constructor() {
        this.base();
    }

    return constructor;

}());

var Form = joi.Unit.sub(function() {

    function constructor() {
        this.base();
        this['#formControls'] = [];
    }

    constructor.prototype = {
        '#formControls': null,
        addControl: function(control) {
            this['#formControls'].push(control);
            alert(this['#formControls'][0].getName());
        }
    };

    return constructor;

}());

var form = new Form();

var control1 = new SpecializedControl();
control1.setName("Control1");
form.addControl(control1);

var control2 = new SpecializedControl();
control2.setName("Control2");
form.addControl(control2);​ 
```

# c# - 如何在 C# 中以编程方式查找运行应用程序的路径

> ID：11005631
> 
> 赞同：3
> 
> 时间：2012-06-12T22:11:21.800
> 
> 标签：c#, .net, visual-studio-2010, sqlite

我正在开发一个使用 SQLite 数据库的 C# 应用程序。在我的项目中，我创建了一个名为“数据库”的新文件夹。在数据库文件夹中，我有一个名为“ldm”的数据库。我这样定义我的数据源：

数据源=/database/ldm；版本=3；新=假；压缩=真；

当我在 VS2010 中运行代码时，它运行良好。当我发布它时，它找不到数据库。显然，这必须是一个路径问题，但我不知道如何解决它。

谁能给我一些指示？

谢谢！安东尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:14:06.680

如果是winforms，您可以使用[`Application.ExecutablePath`](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.executablepath.aspx).

否则，您可以使用`Assembly.GetExecutingAssembly().Location`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:32:21.453

你在跑什么？

如果是 asp.net 你可以 MapPath

[http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)

# include - 如何防止绑定 DNS 更新删除 $INCLUDE 指令

> ID：11005639
> 
> 赞同：0
> 
> 时间：2012-06-12T22:12:23.240
> 
> 标签：include, dns, bind

我有一个 dns 服务器启动并运行，并为我的域配置了一个启用了 allow-update 指令的区域。我在文件 /var/cache/bind/db.mydomain.com 中有域的初始配置，该文件有一行带有“$INCLUDE db.aux.mydomain.com”指令的行，用于从该文件加载记录。当我使用 nsupdate 更新区域时出现问题，因为 bind 通过删除 $INCLUDE 行并将 db.aux.mydomain.com 的内容直接放在 db.mydomain.com 文件中来重写文件 db.mydomain.com。我怎样才能防止这种情况？

# c# - HTML Agility Pack 问题查找 div

> ID：11005640
> 
> 赞同：1
> 
> 时间：2012-06-12T22:12:36.600
> 
> 标签：c#, html-agility-pack

我正在尝试提取具有特定类/ID 名称的 div 中的所有内容。我正在使用以下代码：

```
var webGet = new HtmlWeb();
var document = webGet.Load("http://www.4guysfromrolla.com/articles/011211-1.aspx");

var partOfWebpage = from completeWebpage in document.DocumentNode.Descendants("div")
                             where
                                 completeWebpage.Attributes["class"].Value == "content" &&
                                 completeWebpage.Attributes["class"].Value != null
                             select completeWebpage.InnerHtml;

foreach (var s in partOfWebpage)
{
    textBox1.AppendText(s);
} 
```

我收到**“未处理 NullReferenceException - 对象引用未设置为对象的实例”**错误。

显然它根本找不到 div。当我在 Descendants() 方法中放置“table”而不是“div”时，一切正常，我可以选择我选择的带有 class/id 定义的表。

我究竟做错了什么？

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:19:26.860

在取消引用之前尝试检查 Attribute 是否存在：

```
from completeHomepage in document.DocumentNode.Descendants("div")
where completeHomepage.Attributes["class"] != null &&
      completeHomepage.Attributes["class"].Value == "content" &&
      completeHomepage.Attributes["class"].Value != null
select completeHomepage.InnerHtml; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:20:19.780

您可以使用 XPath 按类（或如果需要，按 Id）选择 div。

```
var results = document.DocumentNode.SelectNodes("//div[@class='content']"); 
```

# entity-framework-4.3 - 实体框架迁移未检测到模型更改

> ID：11005646
> 
> 赞同：2
> 
> 时间：2012-06-12T22:13:04.187
> 
> 标签：entity-framework-4.3, entity-framework-migrations

我正在尝试将 EF Migrations 与现有数据库一起使用。

启动项目是 MVC 3 项目，域对象位于同一解决方案的单独项目中。

以下是我采取的步骤：

> 添加迁移 InitialMigration -IgnoreChanges -Verbose

创建了 Configuration.cs 和 ###_InitialMigration.cs。必须编辑 Configuration.cs 以添加我的上下文对象的名称，因为它位于单独的项目中。

> 更新数据库

将 dbo.__MigrationHistory 添加到我的数据库

> 向现有类添加了新属性

```
private ulong? myProp;
[DataMember]
public ulong? MyProp
{
    get { return myProp; }
    set
    {
        if (myProp != value)
        {
            myProp = value;
            RaisePropertyChanged(() => this.MyProp);
        }
    }
} 
```

成功编译解决方案。

> 添加迁移 MyNewMigration

创建了###_MyNewMigration.cs，其中没有迁移：

```
public partial class MyNewMigration : DbMigration
{
    public override void Up()
    {
    }

    public override void Down()
    {
    }
} 
```

*看起来不太好......迁移在哪里？*

> 更新数据库-详细-脚本

*升级脚本中没有提及新属性*

> 插入 [__MigrationHistory]（[MigrationId]、[CreatedOn]、[Model]、[ProductVersion]）值（'201206122137444_MyNewMigration'、'2012-06-12T22:07:49.170Z'、0x1F8B080YadaYada、'4.3.1'）

如何让 EF Migrations 接受模型更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:22:12.110

事实证明，EF Migrations 不喜欢`ulong?`我使用的数据类型。该属性被忽略而没有任何警告。

更改类型以`long?`允许迁移成功。

# mysql - MySQL 不区分大小写但区分重音的 UTF8 唯一键

> ID：11005647
> 
> 赞同：6
> 
> 时间：2012-06-12T22:13:44.603
> 
> 标签：mysql, unicode, utf-8, collation

我知道在 SF 上有很多类似的问题，但我认为我的不同之处足以保证提出一个新问题。我有一个表，它有一个带有 utf8_unicode_ci 的 utf8 列。它在此列上还有一个唯一键以及另一个标记语言代码的列。列中的数据有许多不同的文字（带有各种口音的拉丁文、中文和俄文等）。

问题是我有时会想输入两个具有不同含义的单词，它们的区别仅在于变音符号（即西班牙语ano vs año）。由于 utf8_unicode_ci 不区分大小写和重音，它认为这些是相同的，只会让我输入一个。太糟糕了。理想情况下，我只需将整个列切换到不区分大小写但区分重音的排序规则，但这似乎不存在。很多不同的东西都使用这个列，所以我宁愿不要将列的默认排序规则更改为 utf8_bin ，以免混淆大小写。

因此，综上所述，我需要一些解决方案，该解决方案不会影响命中此列的许多现有查询中的默认大小写敏感度，但可以让我添加仅相差一个变音符号的单词。想法？如果必须，我将仅将唯一键约束切换为 utf8_bin，但我宁愿不这样做，因为我从不希望表中有两个仅因大小写而异的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T00:47:47.160

您不必在这里重新发明爆胎（重新发明轮子）。

MySQL 中有两种西班牙语排序规则：

utf8_spanish_ci（现代西班牙语）和 utf8_spanish2_ci（传统西班牙语）

这些人非常了解语言，知道 N 和 n 应该放在一起，但 Ñ 和 ñ 是 N 和 O 之间的不同字母。在西班牙语中，Ñ 实际上是不同的字母，而不是重音。

将您的列排序规则设置为 utf8_spanish_ci ，一切都会按照您想要的方式工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T00:26:22.027

我能想到的唯一一件事（没有找到适合您需要的排序规则）是在应用程序层（MySQL 之外）进行更改，以处理差异化。

例如，由于您不关心大小写，您可以通过编程方式降低数据库中所有行的大小写。然后将排序规则更改为 utf8_bin。

然后，您可以在应用程序中将所有内容在进入数据库之前转换为小写（我猜这不会影响变音符号）。这样，如果人们尝试输入多个案例，您仍然会出错，您只需要更改几行代码即可对进入表格的内容进行预处理，并且您不会遇到变音符号问题。

# python - Python中根据列表中对象名称中的数字进行索引

> ID：11005648
> 
> 赞同：0
> 
> 时间：2012-06-12T22:13:48.753
> 
> 标签：python, python-2.7

抱歉我的头衔不是最好的。这是我要完成的工作：我有一个清单：

```
list1 = [a0_something, a2_something, a1_something, a4_something, a3_something] 
```

我有另一个列表，其中条目是元组，包括名称，例如：

```
list2 = [(x1,y1,z1,'bob'),(x2,y2,z2,'alex')...] 
```

第二个列表中的第 0 个名称对应于 a0_something，第二个列表的第一个条目中的名称对应于 a1_something。基本上第二个列表是按写入顺序排列的，但第一个列表不是。

我正在使用的程序有一个 setName 函数我想这样做

```
a0_something.setName(list2[0][4]) 
```

等等循环。

所以我真的只能说

```
for i in range(len(list1)):
    a(i)_something.setName(list2[i][4]) 
```

无论如何我可以在 a#_something 中引用该数字，以便我可以使用循环进行迭代？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:19:57.523

不。

变量名在运行时没有意义。（除非你在做内省，我保证你是*不应该做*的事情。）

使用适当的列表，以便：

```
lst = [a0_val, a1_val, a2_val, a3_val, a4_val] 
```

然后通过`lst[0]`.

或者，如果这些名称有意义，请使用 dict 其中：

```
dct = {
    'a0' : a0_val,
    'a1' : a1_val,
    # ...
} 
```

并将其与`dct['a0']`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:25:22.827

enumerate 函数可让您获取当前项目的值和索引。因此，对于您的示例，您可以执行以下操作：

```
for i, asomething in enumerate(list1):
    asomething.setName(list2[i][3]) 
```

由于您的 list2 长度为 4，因此最终元素是索引 3（您也可以使用 -1）

# android - Android onNewIntent Uri 始终为空

> ID：11005657
> 
> 赞同：3
> 
> 时间：2012-06-12T22:14:28.893
> 
> 标签：android, android-intent, callback, uri, twitter4j

在我活动的 onNewIntent() 方法中， `getIntent().getData();`始终为空。`onCreate()`在去或任何其他生命周期函数之前肯定会去这个方法。它从浏览器返回这里，但我不知道为什么`getIntent().getData()`为空。

这个活动像这样启动浏览器`context.startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(requestToken.getAuthenticationURL())));`

并返回这里

```
@Override
public void onNewIntent(Intent intent){
    super.onNewIntent(intent);

    Uri uri = getIntent().getData();
    if (uri != null && uri.toString().startsWith(TwitterConstants.CALLBACK_URL)) {...}
} 
```

但 uri 始终为空。

清单的东西：

```
 <activity
        android:name="myapp.mypackage.TweetFormActivity"
        android:configChanges="orientation|keyboardHidden"
        android:label="@string/app_name"
        android:launchMode="singleInstance"
        android:screenOrientation="portrait"
        android:theme="@android:style/Theme.Black.NoTitleBar">
         <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="oauth" android:host="myapp"/>
        </intent-filter>
        </activity>

static final String CALLBACK_URL = "oauth://myapp"; 
```

我在这里想念什么？谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-12T22:20:02.773

您应该在获取 URI 之前调用`getData()`参数或`intent`执行。不会自动设置新意图。`setIntent(intent)``onNewIntent()`

**更新：**所以，这里有两种方法可以实现`onNewIntent()`。第一个用新的意图替换旧的意图，因此当您`getIntent()`稍后调用时，您将收到新的意图。

```
@Override
protected void onNewIntent(final Intent intent) {
    super.onNewIntent(intent);
    // Here we're replacing the old intent with the new one.
    setIntent(intent);
    // Now we can call getIntent() and receive the new intent.
    final Uri uri = getIntent().getData();
    // Do something with the URI...
} 
```

第二种方法是使用来自新意图的数据，让旧意图保持原样。

```
@Override
protected void onNewIntent(final Intent intent) {
    super.onNewIntent(intent);
    // We do not call setIntent() with the new intent,
    // so we have to retrieve URI from the intent argument.
    final Uri uri = intent.getData();
    // Do something with the URI...
} 
```

当然，您可以使用两种变体的组合，但**不要期望收到新的意图，`getIntent()`直到您明确设置它`setIntent()`**。

# c# - 套接字开始变慢并且没有响应

> ID：11005667
> 
> 赞同：1
> 
> 时间：2012-06-12T22:15:56.230
> 
> 标签：c#, sockets, actionscript

我正在开发一个服务器（使用 c#）和一个客户端（使用 flash，actionscript 3.0）应用程序。服务器连续向客户端发送数据（数据约为 90 字节），客户端根据收到的数据运行（数据为 json 格式）

有一段时间，一切都按预期工作，但经过一段时间后，客户端开始接收延迟消息。他们继续等待一段时间，然后他们根据最后一条消息（一些消息丢失）行事。经过一段时间后，客户端开始等待并同时处理所有消息。我不知道是什么原因造成的。我的网络状况稳定。

这是我的 C# 代码的一部分，发送消息：

```
public void Send(byte[] buffer)
    {
        if (ClientSocket != null && ClientSocket.Connected)
        {
            ClientSocket.BeginSend(buffer, 0, buffer.Length, 0, WriteCallback, ClientSocket);
        }
    }

    private void WriteCallback(IAsyncResult result)
    {
        //
    } 
```

和我的客户的某些部分，接收消息（动作脚本）

```
socket.addEventListener(ProgressEvent.SOCKET_DATA, onResponse);
function onResponse(e:ProgressEvent):void {
trace(socket.bytesAvailable);
if(socket.bytesAvailable > 0) {
    try
    {
        var serverResponse:String = socket.readUTFBytes(socket.bytesAvailable); 
```

……

我希望我能解释我的问题。我应该如何优化我的代码？什么可能导致滞后。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T02:24:09.567

您确实需要详细说明如何设置套接字（是 TCP 还是 UDP？）

假设它是一个 TCP 套接字，那么您的客户端似乎依赖于每个接收调用，它们返回的字节数与服务器`Send()`调用发送的字节数相同。然而，情况并非如此，如果在客户端上仅收到部分消息，或者一次收到多条消息，则很可能是您的问题的原因。

例如，服务器可能会在一次调用中发送一条 90 字节的消息，但您的客户端可能会以一个 90 字节的接收、或两个 45 字节的块、甚至 90 x 1 字节的块或介于两者之间的任何方式接收它。服务器发送的多条消息在客户端接收时也可能部分组合。例如，可以在一个 180 字节的块中接收两个 90 字节的消息，或者一个 150 字节和一个 30 字节的块等。

因此，您需要为您的消息提供某种框架，以便当客户端接收到数据流时，它可以可靠地重建为单独的消息。

最基本的成帧机制是在每条发送的消息前加上一个固定长度的字段来指示消息的大小。如果您可以保证您的消息永远不会超过 255 个字节，那么您可能能够摆脱单个字节，这将简化接收代码。

在客户端，您首先需要接收长度前缀，然后从套接字读取那么多字节来构造消息数据。如果您收到的字节数少于所需的字节数，您的接收代码必须等待更多数据（在最终收到时将其附加到部分接收的消息中），直到它有完整的消息。

一旦收到完整的消息，就可以按您当前的方式处理它。

不幸的是，我不了解 ActionScript，因此无法为您提供客户端代码的示例，但您可以使用 C# 编写服务器和客户端框架：

服务器端：

```
public void SendMessage(string message)
{
    var data = Encoding.UTF8.GetBytes(message);
    if (data.Length > byte.MaxValue) throw new Exception("Data exceeds maximum size");
    var bufferList = new[]
    {
        new ArraySegment<byte>(new[] {(byte) data.Length}),
        new ArraySegment<byte>(data)
    };
    ClientSocket.Send(bufferList);
} 
```

客户端：

```
public string ReadMessage()
{
    var header = new byte[1];
    // Read the header indicating the data length
    var bytesRead = ServerSocket.Receive(header);
    if (bytesRead > 0)
    {
        var dataLength = header[0];
        // If the message size is zero, return an empty string
        if (dataLength == 0) return string.Empty;
        var buffer = new byte[dataLength];
        var position = 0;
        while ((bytesRead = ServerSocket.Receive(buffer, position, buffer.Length - position, SocketFlags.None)) > 0)
        {
            // Advance the position by the number of bytes read
            position += bytesRead;
            // If there's still more data to read before we have a full message, call Receive again
            if (position < buffer.Length) continue;
            // We have a complete message - return it.
            return Encoding.UTF8.GetString(buffer);
        }
    }
    // If Receive returns 0, the socket has been closed, so return null to indicate this.
    return null;
} 
```

# sql-server-2008 - 存储过程仅返回 SELECT 行

> ID：11005670
> 
> 赞同：0
> 
> 时间：2012-06-12T22:16:26.330
> 
> 标签：sql-server-2008

我只是设置了一个 SQL 存储过程以特定顺序（从重要到不重要）返回特定行：

```
-- 1st Level -> Query a more detailed object...
SELECT ... WHERE something
-- if a result is find, the SP is returning the correct row.
-- if rowcount = 0 then, the SP is returning an empty row 
-- and continues with the next query (less specific than the 1st one).

IF @@ROWCOUNT = 0
BEGIN
SELECT .... WHERE something else... 
 -- Again, if a result exists, the SP returns the correct row, but also 
 -- the result of the 1st query is returned without rows...
 IF @@ROWCOUNT = 0
 BEGIN
 SELECT .... WHERE something else again...
 END
END 
```

是否有任何选项只返回返回非空行的 SELECT 语句？我不想返回空行......每次该行是第一个查询的“子级别”时，我都会在正确的行之前得到空结果。

我正在考虑创建一个表变量。有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:21:53.803

既然您正在寻找缺少的行，为什么不在您的过程中使用 if/else 语句。就像是：

```
If exists(/*firstQuery*/ SELECT ... WHERE something) begin
   SELECT ... WHERE something
end else if exists (/*secondQuery*/ SELECT .... WHERE something else... ) begin
   SELECT .... WHERE something else... 
end else /*Third query*/ begin
    SELECT .... WHERE something else again...
end 
```

请记住，当检查是否存在某些内容时，您应该只选择一列（例如 id），就好像您已经计算了列一样，那么这会减慢您的过程。

# php - PHP如何找出memcached数组上的文件大小

> ID：11005672
> 
> 赞同：2
> 
> 时间：2012-06-12T22:16:38.150
> 
> 标签：php, mysql, memcached

根据我的阅读，您不能使用 memcached 一次存储超过 1mb 的值或数据。如果是这种情况，有没有办法在将数组提交给 memcached 之前找出数组的文件大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:21:54.147

Memcache 是一个键/值存储，因此不“知道”更多*“复杂”*的对象。该模块所做的是将值序列化并将其存储为字符串。因此，总大小 =`strlen(serialize($value));`请注意，您需要!的[**非**重载版本`strlen`](http://www.php.net/manual/en/mbstring.overload.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:33:38.060

这不会直接回答您的问题，但是如果需要，您可以将 1MB 限制更改为更大的值。

见： http: [//linux.die.net/man/1/memcached](http://linux.die.net/man/1/memcached)

> -I 覆盖每个slab 页面的默认大小。默认为 1mb。默认为 1m，最小值为 1k，最大值为 128m。调整此值会更改项目大小限制。注意这也会增加slab的数量（使用-v查看），以及memcached的总体内存使用量。

您还可以启用压缩以减小值的大小。见：[http ://ca.php.net/manual/en/memcache.setcompressthreshold.php](http://ca.php.net/manual/en/memcache.setcompressthreshold.php)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-12T22:21:39.160

或者你尝试一种复杂的方式`strlen(serialize($array));` 或者你尝试简单的方式

```
$before = memory_get_usage();
$myarray = array(<content>);
$size = memory_get_usage() - $before; 
```

想不出别的办法对不起

# r - 使用 gridExtra 和 grid.pattern() 跨面板对齐模式

> ID：11005675
> 
> 赞同：1
> 
> 时间：2012-06-12T22:17:01.423
> 
> 标签：r, graphics, lattice

该`gridExtra`包添加了一组“模式”类，可以让一个人用模式填充矩形。例如，

```
library(gridExtra)
grid.pattern(pattern = 1) 
```

创建一个填充有对角线的框。我想创建一堆面板，其中每个面板都填充有这些对角线。这很简单：

```
library(lattice); library(gridExtra)
examplePlot <- xyplot(
  1 ~ 1 | 1:2, 
  panel = function () grid.pattern(pattern = 1),
  layout = c(1, 2),

  # Remove distracting visual detail
  scales = list(x=list(draw=FALSE), y=list(draw=FALSE)),
  strip = FALSE, xlab = '', ylab = ''
)
print(examplePlot) 
```

问题是对角线没有跨面板对齐。也就是说，在第一个面板的底部与第二个面板的顶部相交的地方有一个视觉“中断”：在这一点上，线条没有对齐。这是我要解决的问题。

`pattern.offset = c(.2005, 0)`我可以通过将参数添加到调用中来消除大部分视觉中断`grid.pattern`，并确保它仅适用于底部面板。但是这个解决方案并不能一概而论。例如，如果我更改模式（例如，通过使用`granularity`参数`grid.pattern`），此解决方案将不起作用。有更通用的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:56:38.347

要完成这项工作，您必须负责`panel.height`设置`print.trellis`. （要了解原因，请在运行示例代码后尝试调整绘图设备的大小：随着设备和面板的大小发生变化，线条的匹配/不匹配也会发生变化）：

```
## Calculate vertical distance (in mm) between 45 degree diagonal lines
## spaced 5mm apart (the default distance for grid.pattern).
vdist <- 5 * sqrt(2)

nLines <- 8L    ## can be any integer
panelHeight <- list(x = nLines*vdist, units = "mm", data = NULL)

## Plot it
print(examplePlot, panel.height=panelHeight) 
```

![在此处输入图像描述](../Images/bc5e98a398fd5ee2884837b7c9443f83.png)

# c# - 使用 GetInvocationList 取消订阅事件处理程序

> ID：11005676
> 
> 赞同：3
> 
> 时间：2012-06-12T22:17:07.540
> 
> 标签：c#, events, memory-leaks, event-handling, robustness

我的基类中有一些事件，我想在 IDisposable 或 Finalizer 中应用以下模式。

```
var onCategorizedMessage = this.OnCategorizedMessage.GetInvocationList().ToList();
foreach (var item in onCategorizedMessage)
    this.OnCategorizedMessage -= item; 
```

我会在每个事件中重复此代码一次。

这是处理取消订阅事件以防止内存泄漏的合理且可靠的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-30T08:09:02.527

无需使用`for`or `foreach`，因为您可以访问支持字段（存储代表），您只需要这样做：

```
this.OnCategorizedMessage = null; 
```

有关更多信息，您可以在此处查看：http: [//www.codeproject.com/Articles/864690/Simplifying-Events-in-NET](http://www.codeproject.com/Articles/864690/Simplifying-Events-in-NET)

# c++ - 读取文件并将行拆分为单个变量

> ID：11005678
> 
> 赞同：0
> 
> 时间：2012-06-12T22:17:33.703
> 
> 标签：c++, getline

程序

```
#include <iostream>
#include <fstream>
#include <string>
using namespace std;

int main () {
  string line,p1,p2,p3;
  ifstream myfile ("infile.txt");
  if (myfile.is_open())
  {
    while ( myfile.good() )
    {
/*
      myfile >> p1 >> p2 >> p3 ;
      cout << "p1 : "  << p1 << "   p2 :  " << p2 << "   p3 :  "  << p3 << endl;
*/

      getline (myfile,line);
      cout << "line : " << line << endl;

    }
    myfile.close();
  }

  else cout << "Unable to open file";

  return 0;
} 
```

INFILE.TXT

```
name
param1 = xyz
param2 = 99
param3
param_abc = 0.1
june 2012 
```

输出

```
line : name
line : param1 = xyz
line : param2 = 99
line : param3
line : param_abc = 0.1
line : june 2012
line : 
```

我想搜索 param2 并打印它的值，即 99

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:21:01.760

阅读该行后，您可以对其进行解析：

```
stringstream ss(line);
string token;
if (ss >> token && token == "param2") {
    ss >> token; // '='
    ss >> token; // value of param2
    cout << "param2 is: " << token << endl;
  }
} 
```

您应该为读取操作的成功添加更多测试（也许“param2”之后的令牌确实是`=`）

如果“param2”的值预计是一个整数，您可以提取它而不是最后一个令牌提取：

```
int val;
ss >> val; 
```

# image-processing - 通过命令行压缩具有不同页面格式的多页 TIF 文件

> ID：11005682
> 
> 赞同：3
> 
> 时间：2012-06-12T22:17:55.070
> 
> 标签：image-processing, automation, compression, imagemagick

我们的文档管理系统中包含大量多页 TIF 文件（主要是文档扫描）。由于各种历史问题和最终用户的误解，其中很大一部分比它们需要的要大得多（例如，它们将以比要求更高的分辨率进行扫描，或者未经压缩存储）。

我一直在研究其中一些文档并进行一些优化，以收回一些宝贵的存储空间（我已经恢复了 25GB，只是取出了非常低的果实）。

到目前为止，我一直在使用 ImageMagick 和 Irfanview 的组合，但我真的很想更加自动化这个过程，因为它目前非常耗费人力。我在创建一些脚本方面很擅长，但不幸的是，所讨论的 TIF 的性质被证明是有问题的。

特别是，它们中的大多数包含混合页面格式；用于基本字母页面的双级/1 位页面和用于图像/地图/计划的全彩色 RGB 页面。大多数文档将混合使用这些类型，并且并不总是以任何特定的顺序排列（实际上它们可能在这两种格式之间来回切换）。

理想情况下，我想在双层页面上使用第 4 组传真压缩并在彩色页面上使用 JPEG 压缩（因此 ImageMagick 中的 -compress group4 / -compress jpeg 标志）但似乎没有任何方法（我可以告诉 - 我IM 方面的经验有限）以按页面格式设置压缩。有谁知道这是否可能？或者任何人都可以推荐一个具有此功能的可编写脚本的工具吗？

Irfanview 可以进行逐页压缩，但必须通过 GUI 逐页手动设置，这显然不理想。

任何提示将非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T22:24:39.603

由于我没有显示您描述的特征（混合格式、不同压缩方案和不同页面的色彩空间......）的示例 TIFF 文件，所以这是第一个镜头。

要自动处理多页 TIFF，您需要知道可以通过将其从零开始的索引号附加`[n]`到文件名来单独访问每张图片。

此外，您应该查找[ImageMagick escpape 快捷方式列表](http://imagemagick.org/script/escape.php)，这样您就可以构建一个`identify -format <%escapestrings>`自动从文件中提取有趣位的命令，然后您将使用它来进行进一步处理。

`identify`因此，通过使用自定义字符串运行此类来识别不同 TIFF 页面之间的各种特征来开始您的项目`-format`，例如：

```
for i in $(seq 1 $(identify -format %n multipage.tiff)); do 
  identify -format \
    "scene-number:%s \
     image-width-in-pixels:%w \
     image-height-in-pixels:%h \
     x-resolution:%x \
     y-resolution:%y \
     image-depth:%z \
     imageclass+colorspace:%r \
     image-compression-type:%C \
     image-compression-quality:%Q \
     page-width:%W \
     page-height:%H" \
   multipage.tiff[$i]; 
 done 
```

（出于教育原因，故意写得比需要的更冗长……）

在此基础上，您应该能够提出一个 shell 脚本来满足您的需求。

# css - 使用 CSS Viewport 缩放移动网站

> ID：11005684
> 
> 赞同：0
> 
> 时间：2012-06-12T22:18:12.323
> 
> 标签：css, opera, scale, viewport

我想在移动 Opera 浏览器上更改网站的外观。我使用用户样式来更改一些 CSS 值，目前效果很好，但页面无法缩放到设备的全宽（任一方向）。因为无论如何我只会将它用于 Opera，所以我可以使用 Opera-CSS 属性“@-o-viewport”

这是一个关于如何使用它的教程： [http ://dev.opera.com/articles/view/an-introduction-to-meta-viewport-and-viewport/](http://dev.opera.com/articles/view/an-introduction-to-meta-viewport-and-viewport/)

页面有一个固定的宽度，我仍然希望设备放大网站，所以它尽可能大，同时仍然显示页面的整个宽度。

当我尝试这个时，它不起作用。页面以不同的用户样式显示，但 css 视口属性无法按我的预期工作，页面以大约 0.4 的缩放比例显示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:23:14.350

您可以使用元标记视口来做到这一点：

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:47:13.340

@-o-viewport {宽度：$px}

其中 $ = 您尝试优化的页面宽度（以像素为单位）（例如 800）

# odata - Odata $top 不适用于 MongoDb

> ID：11005686
> 
> 赞同：2
> 
> 时间：2012-06-12T22:18:30.470
> 
> 标签：odata, mongodb-.net-driver

我陷入了一些奇怪的问题。这是代码 AccountsController.cs

```
// GET /api/accounts
[HttpGet]
[Queryable(ResultLimit = 50)]
public IQueryable<AccountDto> Get()
{
    return this.service.Get();
} 
```

服务在这里 - 它是 AccountService.cs

```
public IQueryable<AccountDto> Get()
{
    return this.readModel.Get();
} 
```

并且 readModel 是 AccountsReadModel 类型

```
public IQueryable<AccountDto> Get()
{
    return Database.GetCollection<AccountDto>("Accounts").AsQueryable();
} 
```

数据库是 MongoDb.Driver.Database

问题如下：当我尝试在没有任何参数的情况下查询 Get 方法时 - `localhost/api/accounts`当我使用 skip 时它返回所有帐户（按预期）：`localhost/api/accounts?$skip=n`- 它跳过 n 并返回其余项目（也按预期）但是`localhost/api/accounts?$top=1`返回所有帐户，而不是之一。

我该如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T11:48:25.900

问题出在**[Queryable(ResultLimit=50)] 中：**

它和`$top=1`一起产生以下表达式： `coll.Take(1).Take(50)`它返回的不是 1，而是 50（或集合中的所有元素，以防元素少于 50）。
顺便说一句，`Database.GetCollection<A>("A").AsQueryable().Take(1).Take(50)`- 不再返回 1 个元素。
这看起来像 MongoDbDriver 中的错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T20:52:26.543

与`$orderby`

```
localhost/api/accounts?$top=1&$orderby=... 
```

# c# - 在字符串中查找关键字和关键短语的算法

> ID：11005687
> 
> 赞同：12
> 
> 时间：2012-06-12T22:18:31.107
> 
> 标签：c#, sql, sql-server, algorithm, search

我需要有关如何编写算法来查找字符串中的**关键字或关键短语的建议或指导。**

该字符串包含：

*   用英语 (GB) 编写的技术信息
*   单词大多用空格隔开
*   **关键字不包含空格**，但可以包含连字符、撇号、冒号等。
*   关键词可以**包含空格、逗号或其他标点符号**
*   如果**两个或多个关键字同时出现，**那么它很可能是一个关键词，例如“逆变器驱动器”
*   该文本还包含 HTML，但如有必要，可以事先将其删除
*   非关键字是“and”、“the”、“we”、“see”、“look”等词。
*   关键字不区分大小写，例如“Inverter”和“inverter”是相同的关键字

该算法有以下要求：

1.  在**批处理**场景中运行，例如每天运行一次或两次
2.  处理长度从大约**200 到 7000 个字符不等的字符串**
3.  **在不到 1 小时内处理 1000 个字符串**
4.  将在功率适中的服务器上执行
5.  使用以下语言之一编写：**C#、VB.NET 或 T-SQL**甚至可能是 F#、Python 或 Lua 等。
6.  **不**依赖于预定义关键字或关键短语的列表
7.  **但可以**依赖关键字排除列表，例如“and”、“the”、“go”等。
8.  **理想情况下可转移**到其他语言，例如不依赖于特定语言的功能，例如元编程
9.  输出关键词列表（频率降序），后跟关键字列表（频率降序）

如果它可以在几秒钟内处理多达 8000 个字符，那就太酷了，这样它就可以实时运行，但我已经问够了！

**只是寻找建议和方向：**

*   这应该被视为两个独立的算法吗？
*   有没有我可以遵循的既定算法？
*   我的要求可行吗？

非常感谢。

PS 字符串将从 SQL Server 2008 R2 数据库中检索，因此理想情况下该语言将支持此功能，如果不支持，则它必须能够读取/写入 STDOUT、管道、流或文件等。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-12T23:31:11.853

所涉及的逻辑使得在 T-SQL 中编程变得复杂。选择像 C# 这样的语言。首先尝试制作一个简单的桌面应用程序。稍后，如果您发现将所有记录加载到此应用程序太慢，您可以编写一个在 SQL-Server 上执行的 C# 存储过程。根据 SQL-Server 的安全策略，它需要有一个强密钥。

* * *

现在到算法。排除词列表通常称为停用词列表。如果您对该搜索词进行一些谷歌搜索，您可能会找到可以开始使用的停用词列表。将这些停用词添加到 a `HashSet<T>`（我将在此处使用 C#）

```
// Assuming that each line contains one stop word.
HashSet<string> stopWords =
    new HashSet<string>(File.ReadLines("C:\stopwords.txt"), StringComparer.OrdinalIgnoreCase); 
```

稍后您可以查看关键字候选是否在停用词列表中

```
If (!stopWords.Contains(candidate)) {
    // We have a keyword
} 
```

HashSet 很快。它们的访问时间为 O(1)，这意味着进行查找所需的时间不取决于它包含的项目数。

使用正则表达式可以轻松查找关键字。

```
string text = ...; // Load text from DB
MatchCollection matches = Regex.Matches(text, "[a-z]([:']?[a-z])*",
                                        RegexOptions.IgnoreCase);
foreach (Match match in matches) {
    if (!stopWords.Contains(match.Value)) {
        ProcessKeyword(match.Value); // Do whatever you need to do here
    }
} 
```

如果您发现 az 对字母过于严格并且需要重音字母，您可以将正则表达式更改为`@"\p{L}([:']?\p{L})*"`. 字符类`\p{L}`包含所有字母和字母修饰符。

词组比较复杂。您可以尝试先将文本拆分为短语，然后对这些短语应用关键字搜索，而不是在整个文本中搜索关键字。这将为您同时提供一个短语中的关键字数量。

将文本拆分为短语涉及搜索以“。”结尾的句子。或者 ”？” 或者 ”！” 或者 ”：”。您应该排除出现在单词中的点和冒号。

```
string[] phrases = Regex.Split(text, @"[\.\?!:](\s|$)"); 
```

这会搜索后跟空格或行尾的标点符号。但我必须同意这并不完美。它可能会错误地将缩写词检测为句子结尾。您将不得不进行实验以改进拆分机制。

# git - git status 显示修改，即使 autocrlf=false

> ID：11005688
> 
> 赞同：38
> 
> 时间：2012-06-12T22:18:36.377
> 
> 标签：git, revert, git-status, core.autocrlf

我遇到了与这个问题相同的问题：[git status shows modify, git checkout -- <file> doesn't remove them](https://stackoverflow.com/questions/2016404/git-status-shows-modifications-git-checkout-file-doesnt-remove-them)

Git 继续显示工作目录修改，即使是`git config --global core.autocrlf false`：

```
E:\_dev\github\Core [master +0 ~93 -0]> git config --get-all core.autocrlf
false
false 
```

（请注意，我什`--system`至将设置设置为`false`）

*为什么看起来 Git 仍在修改我的行尾？*

# 尝试摆脱修改

## 基线

```
E:\_dev\github\Core [master +0 ~93 -0]> git status
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   tools/StatLight/StatLight.EULA.txt
... more changes ...
no changes added to commit (use "git add" and/or "git commit -a") 
```

## 混帐结帐 - 。

```
E:\_dev\github\Core [master +0 ~93 -0]> git checkout -- .
E:\_dev\github\Core [master +0 ~93 -0]> git status
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed) 
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   tools/StatLight/StatLight.EULA.txt
... more changes ...
no changes added to commit (use "git add" and/or "git commit -a") 
```

有时这会以一种奇怪的方式产生影响：

```
E:\_dev\github\Core [master +0 ~628 -0]> git checkout -- .
E:\_dev\github\Core [master +0 ~361 -0]> git checkout -- .
E:\_dev\github\Core [master +0 ~93 -0]> git checkout -- .
E:\_dev\github\Core [master +0 ~93 -0]> git checkout -- .
E:\_dev\github\Core [master +0 ~93 -0]> git checkout -- . 
```

## git reset --hard

```
E:\_dev\github\Core [master +0 ~93 -0]> git reset --hard
HEAD is now at 11a7f9a Merge pull request #8 from RemiBou/master
E:\_dev\github\Core [master +0 ~93 -0]> 
```

## 混帐添加 .; 混帐藏匿；git 存储下降

```
E:\_dev\github\Core [master +0 ~93 -0]> git add .
... warnings ....
warning: CRLF will be replaced by LF in tools/StatLight/StatLight.EULA.txt.
The file will have its original line endings in your working directory.

E:\_dev\github\Core [master +0 ~93 -0]> git stash
Saved working directory and index state WIP on master: 11a7f9a Merge pull request #8 from 
RemiBou/master
HEAD is now at 11a7f9a Merge pull request #8 from RemiBou/master

E:\_dev\github\Core [master +0 ~93 -0]> git stash drop
Dropped refs/stash@{0} (de4c3c863dbad789aeaf563b4826b3aa41bf11b7)

E:\_dev\github\Core [master +0 ~93 -0]> git status .\tools\StatLight\StatLight.EULA.txt
# On branch master
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   tools/StatLight/StatLight.EULA.txt
#
no changes added to commit (use "git add" and/or "git commit -a") 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-01T15:39:37.580

这似乎确实是 msysgit 中的一个错误。作为一种解决方法，请尝试创建一个[.gitattributes](https://www.kernel.org/pub/software/scm/git/docs/gitattributes.html)文件，其中包含

```
* -text 
```

这将告诉 git 不要对任何文件执行 EOL 转换。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-13T09:14:25.200

检查您是否没有`.gitattributes`文件

如[手册页的](http://git-scm.com/docs/gitattributes#_effects)[“效果”部分所述`gitattributes`](http://git-scm.com/docs/gitattributes#_effects)，这些文件也可以对 eol 和自动转换产生影响：

```
text ^^^^^^ 
```

> 此属性启用和控制行尾标准化。
> 当一个文本文件被规范化时，它的行尾被转换为`LF`存储库中的。
> 要控制工作目录中使用的行尾样式，请对单个文件使用 eol 属性，`core.eol`对所有文本文件使用配置变量。

还要检查您的配置`core.eol`，如“[如何`git core.autocrlf`在不同操作系统之间进行](https://stackoverflow.com/questions/3206843/how-line-ending-conversions-work-with-git-core-autocrlf-between-different-operat/3209806#3209806)行尾转换”中所述。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-03T11:18:28.457

我正在调查 MSysGit 中 core.autocrlf 的奇怪行为，我发现有：

```
[core]
    autocrlf = false
    safecrlf = true
    ignorecase = true
    eol = native 
```

在全局配置文件和从另一台 PC 复制的 repo 中的 no *core.autocrlf*设置（未克隆，仅复制），发出 `git status`命令会导致所有文本文件标记为已修改（周围没有 gitattributes）。

但是，如果您将本地（存储库）*core.autocrlf*设置添加为 true，然后发出`git status`命令，**所有更改都会消失，存储库会恢复为 clean**。

但是（这是奇怪的行为）如果您从存储库配置文件中删除刚刚添加的 core.autocrlf 设置（从而返回到确切的初始状态），**git status 命令继续报告没有更改**！

鉴于尚未对存储库执行任何操作，仅更改配置设置并恢复到原始状态就可以了...

如果这不是错误，我无法想象世界上谁能称其为“正常”行为。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-28T17:05:48.560

这个问题可能是由[gitattributes 的 text 选项引起的。](https://www.kernel.org/pub/software/scm/git/docs/gitattributes.html)

请仔细阅读文档，但基本上`autocrlf`只有在`text`没有设置时才重要`.gitattributes`：

> 未指定
> 如果未指定 text 属性，git 使用 core.autocrlf 配置变量来确定是否应该转换文件。

通过以下方式查找您的`.gitattributes`文件：

```
find <root-dir> -name .gitattributes 
```

和`grep`for `text`, `eol`or`crlf`找到你的罪魁祸首并根据需要进行修改。

您可以只更改此文件并恢复更改，而无需提交足够长的时间来解决您的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-13T08:36:52.657

“autocrlf”问题是~~跨~~多平台 repo 的典型问题（即在 linux 下的服务器上使用与 tortoisegit 的 samba 共享）

我意识到，有时（通常），它更像是一个“chmod”问题而不是 autocrlf 问题：-git status windows 显示挂起的修改-git status linux 什么也不显示

“模式更改 100755 => 100644 config/packager.xml”

检查您的“静态”文件是否不是 +x，（在这种情况下，tortoisegit 不会喜欢它）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-14T22:45:56.463

虽然我不知道是什么导致了这种奇怪的行为，但我知道另一种丢弃可能有效的更改的方法。

**警告！**要非常小心，先做备份；这可能具有高度破坏性。

*如果您关心的所有数据都提交到存储库*中，您可以简单地删除工作目录中的所有内容（当然除了隐藏的 .git 目录）并运行`git reset --hard HEAD`以让 git 仅从存储库数据重新创建工作目录。

请记住在执行此操作之前仔细检查您是否没有任何 git 未跟踪的重要数据。检查未提交的更改是不够的`git status`- 请记住，从工作目录中删除所有文件也会删除您告诉 git 忽略的文件，并且它们不会被重新创建，`git reset --hard HEAD`因为它们根本没有被跟踪。

# java - vba运行java类

> ID：11005691
> 
> 赞同：0
> 
> 时间：2012-06-12T22:18:45.757
> 
> 标签：java, excel, vba, macos

如何从 VBA 运行 java 类。我正在尝试使用 Excel VBA 发布到服务器。我只能在 PC 上使用 VBA 来执行此操作，但是在使用 MAC 时，`DomDocument`对象会返回编译错误。所以我所做的是创建一个 java 类，它将发布并从服务器获取响应。现在我要做的是让 VBA 运行 java 类等待返回码并处理返回。如果这可以用不同的语言（然后是 Java）来完成，我也对此持开放态度。但我们更喜欢Java。

我尝试使用

```
Dim obj as Object 
Set obj = GetObject("java:SendXML") '(sendXML is class name) 
```

但得到一个自动化失败的运行时错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T08:07:25.113

应该不需要使用 Java 来做 HTTP POST，你可以使用标准的 VBA 库。请参阅[如何使用 VBA 从 Excel 向服务器发送 HTTP POST 请求？](https://stackoverflow.com/q/158633/116509).

编辑：如果您无法让 Mac 答案正常工作，我建议您使用可用于许多平台的 CURL： http: [//curl.haxx.se/download.html](http://curl.haxx.se/download.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T08:11:52.047

我自己尝试过类似的事情，但在我看来，Excel 2012 for Mac 似乎（几乎）“没有出路”。我考虑的一种解决方案是使用 AppleScript，这里有几个例子：[http ://www.rondebruin.nl/mac.htm](http://www.rondebruin.nl/mac.htm)

如果您可以使用 OpenOffice / LibreOffice，您可以尝试[Obba](http://www.obba.info)（Excel 和 OpenOffice 的 Java 对象处理程序）。这也适用于 Windows 上的 Excel，我尝试将 Mac 支持添加到 Obba，但到目前为止没有找到解决方案。

# azure - 如何使用 Azure 网站预览设置自定义 DNS？

> ID：11005699
> 
> 赞同：0
> 
> 时间：2012-06-12T22:19:38.160
> 
> 标签：azure, dns, azure-web-app-service

我创建了一个新的 Azure 网站，使用 Umbraco 作为 CMS。我有一个页面，并且我已经有了一个带有 www.domains4less.com 的 .co.nz 域。互联网上有很多关于将 URL 指向 Azure 的内容，但这似乎更像是一种重定向服务（即，一旦我登陆我的网站，我的 URL 仍然使用 azurewebsites.net）。

有没有人有运气让它去？

这是我尝试将 DNS 条目添加到 Azure 时遇到的错误（我处于保留模式，reemdairy 是网站的名称）：

> 处理您的请求时出错。请稍后重试。
> 
> 浏览器：5.0（Windows NT 6.1；WOW64）AppleWebKit/536.5（KHTML，如 Gecko）Chrome/19.0.1084.56 Safari/536.5 用户语言：未定义门户版本：6.0.6002.18488（rd_auxportal_stable.120609-0259）订阅：3aabe358-d178- 4790-a97b-ffba902b2851 用户电子邮件地址：touchmaniacs@live.com
> 
> 最近 10 个请求
> 
> 消息：失败：Ajax 调用：网站/UpdateConfig。失败，状态为：错误（500）在 2.57 秒内。x-ms-client-request-id 为：38834edf-c9f3-46bb-a1f7-b2839c692bcf-2012-06-12 22:25:14Z 日期时间：2012 年 6 月 13 日星期三 10:25:17 GMT+1200（新西兰标准时间) durationSeconds: 2.57 url: Websites/UpdateConfig status: 500 textStatus: error clientMsRequestId: 38834edf-c9f3-46bb-a1f7-b2839c692bcf-2012-06-12 22:25:14Z sessionId: 09c72263-6ce7-422b-84d7-4c21acded7 [https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) 主机：manage.windowsazure.com 响应：{"message":"重试。如果问题仍然存在，请联系支持。","ErrorMessage":"重试。如果问题仍然存在，请联系支持。","httpStatusCode":"InternalServerError ","operationTrackingId":"","stackTrace":null}
> 
> 消息：完成：Ajax 调用：网站/GetConfig。完成状态：成功（200）在 1.021 秒内。x-ms-client-request-id 为：a0cdcced-13d0-44e2-866d-e0b061b9461b-2012-06-12 22:24:43Z 日期时间：2012 年 6 月 13 日星期三 10:24:44 GMT+1200（新西兰标准时间) durationSeconds: 1.021 url: Websites/GetConfig status: 200 textStatus: success clientMsRequestId: a0cdcced-13d0-44e2-866d-e0b061b9461b-2012-06-12 22:24:43Z sessionId: 09c72263-6ce7-422b-84d7-4c21acded7 [https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) 主机：manage.windowsazure.com
> 
> 消息：完成：Ajax 调用： [https](https://manage.windowsazure.com/Service/OperationTracking?subscriptionId=3aabe358-d178-4790-a97b-ffba902b2851) ://manage.windowsazure.com/Service/OperationTracking?subscriptionId=3aabe358-d178-4790-a97b-ffba902b2851 。完成状态：成功（200）在 1.887 秒内。x-ms-client-request-id 为：a7689fe9-b9f9-4d6c-8926-734ec9a0b515-2012-06-12 22:24:40Z 日期时间：2012 年 6 月 13 日星期三 10:24:42 GMT+1200（新西兰标准时间) durationSeconds: 1.887 url: [https://manage.windowsazure.com/Service/OperationTracking?subscriptionId=3aabe358-d178-4790-a97b-ffba902b2851](https://manage.windowsazure.com/Service/OperationTracking?subscriptionId=3aabe358-d178-4790-a97b-ffba902b2851) 状态: 200 textStatus: 成功 clientMsRequestId: a7689fe9-b9f9-4d6c-8926-7314ec9a0b515-2 -06-12 22:24:40Z sessionId：09c72263-6ce7-422b-84d7-4c21acded759 推荐人： [https ://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) 主机：manage.windowsazure.com
> 
> 消息：完成：Ajax 调用：/Service/GetUserSettings。完成状态：成功（200）在 0.941 秒内。x-ms-client-request-id 为：805e554d-1e2e-4214-afd5-be87c0f255d1-2012-06-12 22:24:40Z 日期时间：2012 年 6 月 13 日星期三 10:24:40 GMT+1200（新西兰标准时间） durationSeconds：0.941 url：/Service/GetUserSettings 状态：200 textStatus：成功 clientMsRequestId：805e554d-1e2e-4214-afd5-be87c0f255d1-2012-06-12 22:24:40Z sessionId：09c72263-6ce7-422b-84d7-421referracer ： [https](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) ://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure 主机：manage.windowsazure.com
> 
> 消息：完成：Ajax 调用：Extensions/ApplicationsExtension/SqlAzure/ClusterSuffix。完成状态：成功（200）在 0.483 秒内。x-ms-client-request-id 为：85157ceb-c538-40ca-8c1e-5cc07c57240f-2012-06-12 22:24:39Z 日期时间：2012 年 6 月 13 日星期三 10:24:40 GMT+1200（新西兰标准时间) durationSeconds: 0.483 url: Extensions/ApplicationsExtension/SqlAzure/ClusterSuffix status: 200 textStatus: success clientMsRequestId: 85157ceb-c538-40ca-8c1e-5cc07c57240f-2012-06-12 22:24:39Z sessionId: 09c72263-6ce7-422b -4c21acded759 推荐人： [https](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) ://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure 主机：manage.windowsazure.com
> 
> 消息：完成：Ajax 调用：Extensions/ApplicationsExtension/SqlAzure/GetClientIp。完成状态：成功（200）在 0.309 秒内。x-ms-client-request-id 为：2eb194b6-66ca-49e2-9016-e0f89164314c-2012-06-12 22:24:39Z 日期时间：2012 年 6 月 13 日星期三 10:24:40 GMT+1200（新西兰标准时间) durationSeconds: 0.309 url: Extensions/ApplicationsExtension/SqlAzure/GetClientIp 状态: 200 textStatus: 成功 clientMsRequestId: 2eb194b6-66ca-49e2-9016-e0f89164314c-2012-06-12 22:24:39Z sessionId: 09c72263-6ce7-422b- -4c21acded759 推荐人： [https](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) ://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure 主机：manage.windowsazure.com
> 
> 消息：完成：Ajax 调用：Extensions/ApplicationsExtension/SqlAzure/DefaultServerLocation。完成状态：成功（200）在 0.309 秒内。x-ms-client-request-id 为：1bc165ef-2081-48f2-baed-16c6edf8ea67-2012-06-12 22:24:39Z 日期时间：2012 年 6 月 13 日星期三 10:24:40 GMT+1200（新西兰标准时间) durationSeconds: 0.309 url: Extensions/ApplicationsExtension/SqlAzure/DefaultServerLocation 状态: 200 textStatus: 成功 clientMsRequestId: 1bc165ef-2081-48f2-baed-16c6edf8ea67-2012-06-12 22:24:39Z sessionId: 09c72263-6ce7-422b-84 -4c21acded759 推荐人： [https](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) ://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure 主机：manage.windowsazure.com
> 
> 消息：完成：Ajax 调用：Extensions/ApplicationsExtension/SqlAzure/ServerLocations。完成状态：成功（200）在 0.309 秒内。x-ms-client-request-id 为：e1fba7df-6a12-47f8-9434-bf17ca7d93f4-2012-06-12 22:24:39Z 日期时间：2012 年 6 月 13 日星期三 10:24:40 GMT+1200（新西兰标准时间) durationSeconds: 0.309 url: Extensions/ApplicationsExtension/SqlAzure/ServerLocations 状态: 200 textStatus: 成功 clientMsRequestId: e1fba7df-6a12-47f8-9434-bf17ca7d93f4-2012-06-12 22:24:39Z sessionId: 09c72263-6ce7-422b-84 -4c21acded759 推荐人： [https](https://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure) ://manage.windowsazure.com/#Workspaces/WebsiteExtension/Website/reemdairy/configure 主机：manage.windowsazure.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T10:05:40.990

我已经使用完全相同的设置（Umbraco，在 Azure 上运行，带有 domain4less.co.nz 域）成功地完成了这项工作。使用 Domains4less 进行 DNS 设置可能很迟钝 - 但以下是如何为您的应用设置 CNAME：

从“管理域”中，点击所需域上的“设置”。下一页，“高级控制面板”并登录。展开“服务”，打开“域模板”，然后单击“添加域模板”

为您的模板命名（例如“yourdomain.co.nz”），然后向下滚动到 CNAME 记录部分。单击“添加 CNAME 记录”，前缀字段：`www`，目标地址：`YOURAPPNAME.azurewebsites.net.`。节省。

打开左侧菜单中的“域”，然后单击要设置的域上的“[编辑]”，打开“高级模式”选项卡并从“模板”下拉列表中选择您的模板。保存，完成。

呸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:37:07.537

拥有 Windows Azure 网站（保留）很好，因为只有保留网站才能拥有指向 your_site.azurewebsites.net 的 CNAME 或 A 记录点。

请问你设置的是CNAME还是A记录？

以下是设置 CNAME 的分步说明（建议用于网站和 webroles），因此请遵循并建议您在哪一步遇到问题：

[在 Windows Azure 中配置自定义域名](https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/)

# .net - .NET 类多边形

> ID：11005704
> 
> 赞同：0
> 
> 时间：2012-06-12T22:20:05.847
> 
> 标签：.net, f#, polygon

我需要使用凹多边形。基本上我需要知道它们的宽度和高度，一种方法来知道一个点是否在多边形内，以及可能是包围它的矩形的 x,y 坐标（这样我就可以轻松实现拖放功能）。我可以使用什么？

我可以定义一个自定义的多边形类型，但是考虑到多边形是凹的，我在实现“包含”经典方法时会遇到问题。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T11:13:28.937

您可以使用[`Shape`](http://msdn.microsoft.com/en-us/library/ms604615)Class ，尤其是与这些对象交互特别简单，但如果您要处理数千条边，我建议使用[`Polygon`Class](http://msdn.microsoft.com/en-us/library/system.windows.shapes.polygon)，这是一个可用于在屏幕上渲染矢量图形的可视对象，[`DrawingVisual`并且](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingvisual.aspx)它的`RenderOpen`方法。

`DrawingVisual`不提供事件处理，所以如果`Shape`你可以使用事件与边缘交互，`DrawingVisual`你需要实现[Hit-Testing](http://en.wikipedia.org/wiki/Hit-testing)。

`Polygon`了解[`Height`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.height)并简单地使用[`Width`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.width)元素属性。

如果要检查 a`Point`是否在多边形内，可以使用[`InputHitTest`Method](http://msdn.microsoft.com/en-us/library/system.windows.uielement.inputhittest)或 esle [`VisualTreeHelper.HitTest`Method](http://msdn.microsoft.com/en-us/library/ms608752.aspx)：

```
let res = yourPolygon.InputHitTest(new Point(x, y))
let res = VisualTreeHelper.HitTest(yourPolygon, new Point(x, y)) 
```

总之：如果您寻求一种优雅的方法来检查一个点是否在多边形内，请查看[此](https://stackoverflow.com/a/218081/995246)答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T00:10:17.933

您可以使用`System.Drawing.Drawing2D.GraphicsPath`：

```
GraphicsPath path = new GraphicsPath();
path.AddPolygon(new[] {new Point(0,1), new Point(5,8), new Point(2,4)});

bool isPointInPolygon = path.IsVisible(4, 1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T00:02:18.263

有一些很好的例程可以确定一个点是否在多边形内。查看[http://www.softsurfer.com/Archive/algorithm_0103/algorithm_0103.htm](http://www.softsurfer.com/Archive/algorithm_0103/algorithm_0103.htm)

# objective-c - 苹果审查团队的 iOS 应用程序崩溃并且无法复制

> ID：11005707
> 
> 赞同：-1
> 
> 时间：2012-06-12T22:20:22.557
> 
> 标签：objective-c, ios

我的应用程序在苹果审查团队中崩溃，但我无法复制该问题。他们给我发了崩溃日志。

```
Incident Identifier: 
CrashReporter Key:   d91f018f5afc31f948a80025c7a09bb112a3caf4
Hardware Model:      iPhone3,1
Process:         
Path:            
Identifier:      
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-06-12 09:27:55.479 -0700
OS Version:      iPhone OS 5.1.1 (9B206)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x3766b88f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x35370259 objc_exception_throw + 33
2   CoreFoundation                  0x3766ea9b -[NSObject doesNotRecognizeSelector:] + 175
3   CoreFoundation                  0x3766d915 ___forwarding___ + 301
4   CoreFoundation                  0x375c8650 _CF_forwarding_prep_0 + 48
5   Sportal_TDF                     0x00031515 -[MenuViewController showStageList:] (MenuViewController.m:62)
6   CoreFoundation                  0x375ca1fb -[NSObject performSelector:withObject:] + 43
7   Sportal_TDF                     0x00005d93 -[DataViewControllerBase retrieveCachedJson:json:cacheAction:] (DataViewControllerBase.m:468)
8   Sportal_TDF                     0x00005e57 -[DataViewControllerBase callWebService:json:cacheAction:successAction:] (DataViewControllerBase.m:480)
9   Sportal_TDF                     0x000314f9 -[MenuViewController loadUpcomingStage] (MenuViewController.m:57)
10  Sportal_TDF                     0x000317b9 -[MenuViewController viewWillAppear:] (MenuViewController.m:142)
11  UIKit                           0x31381b95 -[UIViewController _setViewAppearState:isAnimating:] + 145
12  UIKit                           0x31525ad1 __52-[UIViewController _setViewAppearState:isAnimating:]_block_invoke_0 + 137
13  CoreFoundation                  0x3765f631 __NSArrayEnumerate + 365
14  CoreFoundation                  0x375c4ed5 -[NSArray enumerateObjectsWithOptions:usingBlock:] + 65
15  UIKit                           0x31381c39 -[UIViewController _setViewAppearState:isAnimating:] + 309
16  UIKit                           0x31381a49 -[UIViewController viewWillMoveToWindow:] + 233
17  UIKit                           0x31342b05 -[UIView(Hierarchy) _willMoveToWindow:withAncestorView:] + 529
18  UIKit                           0x313424ab -[UIView(Internal) _addSubview:positioned:relativeTo:] + 303
19  UIKit                           0x31342377 -[UIView(Hierarchy) addSubview:] + 31
20  UIKit                           0x31377555 -[UIWindow addRootViewControllerViewIfPossible] + 289
21  UIKit                           0x31369e87 -[UIWindow _setHidden:forced:] + 295
22  UIKit                           0x313da7d5 -[UIWindow makeKeyAndVisible] + 25
23  Sportal_TDF                     0x000030b3 -[Sportal_TDFAppDelegate application:didFinishLaunchingWithOptions:] (Sportal_TDFAppDelegate.m:107)
24  UIKit                           0x31377cab -[UIApplication _callInitializationDelegatesForURL:payload:suspended:] + 1183
25  UIKit                           0x313717dd -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 409
26  UIKit                           0x3133fac3 -[UIApplication handleEvent:withNewEvent:] + 1011
27  UIKit                           0x3133f567 -[UIApplication sendEvent:] + 55
28  UIKit                           0x3133ef3b _UIApplicationHandleEvent + 5827
29  GraphicsServices                0x33d8122b PurpleEventCallback + 883
30  CoreFoundation                  0x3763f523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 39
31  CoreFoundation                  0x3763f4c5 __CFRunLoopDoSource1 + 141
32  CoreFoundation                  0x3763e313 __CFRunLoopRun + 1371
33  CoreFoundation                  0x375c14a5 CFRunLoopRunSpecific + 301
34  CoreFoundation                  0x375c136d CFRunLoopRunInMode + 105
35  UIKit                           0x3137086b -[UIApplication _run] + 551
36  UIKit                           0x3136dcd5 UIApplicationMain + 1081
37                      0x00002a07 main (main.m:16)
38                      0x000029a0 0x1000 + 6560 
```

上线就崩溃了

```
 @autoreleasepool
    {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
    } 
```

当我无法复制问题时如何调试？有没有人遇到过这个问题。我的应用在以前的版本中运行良好，但这次它在 5.1.1 中崩溃了。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:26:16.400

`[MenuViewController showStageList:]`第 62 行包含什么！？

显然你正在调用一个方法，那是不存在的：`[NSObject doesNotRecognizeSelector:]`。

# android - 在 Android 中稳定、准确的计时

> ID：11005708
> 
> 赞同：2
> 
> 时间：2012-06-12T22:20:39.077
> 
> 标签：android, handler, timing

我正在尝试为 Android 设备创建一个音乐音序器应用程序，并希望获得一些关于如何实现坚如磐石的计时功能的建议。

如果我将 Runnable 传递给 Handler.postDelayed 并指定 x 毫秒的延迟时间，那么 Runnable 是否保证在 x ms 时间内执行？

如果我无法使用 Handler 实现稳定准确的计时，我还有哪些其他选择？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T13:44:41.550

经过多次谷歌搜索，我设法在这里找到了答案：

[http://masterex.github.com/archive/2012/05/28/android-audio-synthesis.html](http://masterex.github.com/archive/2012/05/28/android-audio-synthesis.html)

处理程序， Thread.sleep() 和计时器似乎不是要走的路。

谢谢 DrA 的回答，非常感谢 - 很抱歉没有早点承认，我已经离开一段时间了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T13:05:02.940

我认为“硬实时”编程是不可能的。选项似乎是寻找事件发生时发出信号的事件。这可以通过创建您自己的标志并在另一个线程中轮询该标志的值来完成。

您可以使用 CountDownTimer 指定必须以毫秒为单位的特定时间长度。

您可以通过轮询已经过去了多少时间来使用系统时钟并制作自己的计时器。

还有一个名为 FileObserver 的有用类，它允许您查看特定文件，并听到诸如打开和关闭之类的事件。使用这些信号，您可以知道是时候进行下一个操作了。

最坏的可能错误是在特定硬件上发生时间问题，但在大多数情况下不会发生。如果我不拥有所有这些，那么问题是很难找到时间问题。我希望其他人对此问题会有更好或更多的答案。

# php - 变量的PHP设置/配置文件？

> ID：11005709
> 
> 赞同：0
> 
> 时间：2012-06-12T22:20:42.307
> 
> 标签：php, bash, settings, config, ini

我目前正在为我们的 linux 托管公司编写脚本。我们需要将版本和上次更新检查等变量存储在 config.ini 文件中，该文件需要根据更新程序脚本所做的任何更新进行访问和写入。

我真的需要帮助将变量写入 config.ini 文件（然后在更新变量时覆盖或更改变量），创建 config.ini 文件并从 config.ini 文件中读取变量。

变量在不同时间存储，而不是一次存储，因此一个数组不起作用。我也有 if 语句，所以在某些情况下会在文件中放入一些变量，而在其他情况下，文件中会有不同的变量。

例子：

Server1 已安装 game1。Server2 已安装 game2。

脚本检查 game1，然后检查数据库的最新版本，与配置文件进行比较。如果配置文件为空或旧，则更新然后将配置文件版本更改为数据库版本。每场比赛再次重复。如果游戏不存在，则不存储任何变量并跳到下一步。

我正在努力尝试以不同的时间间隔读取和写入文件而不覆盖前面的行。

得到一些支持会很棒。

问候， 斯考特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T02:01:17.310

我猜你想要想法。尝试使用 yaml、xml、sqlitedb 来存储您的配置设置。XML 可能有点难，因为您必须读写。对我来说，yaml 文件似乎是一个不错的选择。我还没有尝试过PHP yaml 函数，[symfony](http://symfony.com/doc/current/components/yaml.html)有一个很好的yaml 组件。

我提到的另一个选择是如果你有很多复杂的配置，使用 sqlitedb 可能会派上用场。

# c#-4.0 - 无法序列化为 XML

> ID：11005712
> 
> 赞同：0
> 
> 时间：2012-06-12T22:21:07.907
> 
> 标签：c#-4.0, xml-serialization, expression-blend

我正在尝试将某些文本的内容序列化为 XML 文件（在用户保存他们的选择时执行），然后将其反序列化（当用户选择显示他们保存的选择时）。

我一直在关注以下关于序列化的[教程。](http://www.switchonthecode.com/tutorials/csharp-tutorial-xml-serialization)

我也尝试通过 LINQ to XML 执行此操作，但要么出现命名空间错误，要么该工具没有返回错误，但没有工作（与下面描述的相同问题）。

我遇到的问题是我的代码没有返回任何错误，但函数不起作用（我有一个标签控件，可以让我看到正在返回的“catch”）。我正在使用 C# 在 Expression Blend 中构建该工具。

这是我的 SaveSelection.cs 类

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;
using System.Xml.Serialization;
using System.Xml;

namespace DYH
{
public class SaveSelections
{
    [XmlAttribute("Title")]
    public string Title
    { get; set; }

    [XmlElement("Roof")]
    public string RoofSelection
    { get; set; }

    [XmlElement("Cladding")]
    public string CladdingSelection
    { get; set; }

    [XmlElement("MixedCladding")]
    public string MixedCladdingSelection
    { get; set; }

    [XmlElement("FAJ")]
    public string FAJSelection
    { get; set; }

    [XmlElement("GarageDoor")]
    public string GarageDoorSelection
    { get; set; }

    [XmlElement("FrontDoor")]
    public string FrontDoorSelection
    { get; set; }
}
} 
```

这是我的 C# 代码

```
// Save Selection Button
        private void Button_SaveSelection_MouseLeftButtonDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
        {   
            try
            {
                // Save selections into the SavedSelections.xml doc
                SaveSelections userselection = new SaveSelections();
                userselection.Title = TextBox_SaveSelection.Text;
                userselection.RoofSelection = Button_Roof_Select.Text;
                userselection.CladdingSelection = Button_Cladding_Select.Text;
                userselection.MixedCladdingSelection = Button_MixedCladding_Select.Text;
                userselection.FAJSelection = Button_FAJ_Select.Text;
                userselection.GarageDoorSelection = Button_GarageDoor_Select.Text;
                userselection.FrontDoorSelection = Button_FrontDoor_Select.Text;

                SerializeToXML(userselection);

//              XDocument xmlSaveSelections = XDocument.Load("../SavedSelections.xml");
//          
//              XElement newSelection = new XElement("Selection", //xmlSaveSelections.Element("Selections").Add(
//                      //new XElement("Selection",
//                      new XElement("Title", TextBox_SaveSelection.Text),
//                      new XElement("RoofSelection", Button_Roof_Select.Text),
//                      new XElement("CladdingSelection", Button_Cladding_Select.Text),
//                      new XElement("MixedCladdingSelection", Button_MixedCladding_Select.Text),
//                      new XElement("FAJSelection", Button_FAJ_Select.Text),
//                      new XElement("GarageDoorSelection", Button_GarageDoor_Select.Text),
//                      new XElement("FrontDoorSelection", Button_FrontDoor_Select.Text));
//              
////                xmlSaveSelections.Add(newSelection);
////                xmlSaveSelections.Save("../SavedSelections.xml");

                SelectionLabel.Text = "Your selection has been saved as " + "'" + TextBox_SaveSelection.Text + "'. We suggest you write down the name of your selection.";
            }
            catch(Exception ex)
            {
                            throw ex;
                SelectionLabel.Text = "There was a problem saving your selection. Please try again shortly.";
            }
        }

        // Saves SaveSelection.cs to XML file SavedSelections.xml
        static public void SerializeToXML(SaveSelections selection)
        {
            XmlSerializer serializer = new XmlSerializer(typeof(SaveSelections));
            TextWriter textWriter = new StreamWriter(@"/SavedSelections.xml");
            serializer.Serialize(textWriter, selection);
            textWriter.Close();
        } 
```

我已将我先前尝试的证据之一注释掉，因此您可以查看我尝试过的先前格式。

我的问题是，当我尝试使用该工具时，SelectionLabel.Text 返回“保存您的选择时出现问题。请稍后再试。” 所以我知道代码正在返回捕获而不是执行“尝试”。

有什么帮助吗？？

**2012 年 6 月 18 日编辑：**下面的代码是根据问题的正确答案工作的代码。

```
public void Button_SaveSelection_MouseLeftButtonDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
    {
        string roofSelection = TextBox_SaveSelection.Text + "_RoofSelection";
        string claddingSelection = TextBox_SaveSelection.Text + "_CladdingSelection";
        string mixedCladdingSelection = TextBox_SaveSelection.Text + "_MixedCladdingSelection";
        string fajSelection = TextBox_SaveSelection.Text + "_FAJSelection";
        string garageDoorSelection = TextBox_SaveSelection.Text + "_GarageDoorSelection";
        string frontDoorSelection = TextBox_SaveSelection.Text + "_FrontDoorSelection";

        try
        {
            using (var store = IsolatedStorageFile.GetUserStoreForApplication())
            {
                // Gives us 6Mb of storage space in IsoStore
                Int64 isoSpaceNeeded = 1048576 * 6;
                Int64 currentIsoSpace = store.AvailableFreeSpace;

                // If space needed is greater than (>) space available, increase space
                if (isoSpaceNeeded > currentIsoSpace)
                {
                    // If user accepts space increase
                    if (store.IncreaseQuotaTo(currentIsoSpace + isoSpaceNeeded))
                    {
                        IsolatedStorageFileStream file = store.CreateFile("SavedSelections.txt");
                        file.Close();

                        // Stream writer to populate information in
                        using (StreamWriter sw = new StreamWriter(store.OpenFile("SavedSelections.txt", FileMode.Open, FileAccess.Write)))
                        {
                            appSettings.Add(roofSelection, Button_Roof_Select.Text);
                            sw.WriteLine(roofSelection);
                            appSettings.Add(claddingSelection, Button_Cladding_Select.Text);
                            sw.WriteLine(claddingSelection);
                            appSettings.Add(mixedCladdingSelection, Button_MixedCladding_Select.Text);
                            sw.WriteLine(mixedCladdingSelection);
                            appSettings.Add(fajSelection, Button_FAJ_Select.Text);
                            sw.WriteLine(fajSelection);
                            appSettings.Add(garageDoorSelection, Button_GarageDoor_Select.Text);
                            sw.WriteLine(garageDoorSelection);
                            appSettings.Add(frontDoorSelection, Button_FrontDoor_Select.Text);
                            sw.WriteLine(frontDoorSelection);
                        }

                        SelectionLabel.Text = "Your selection has been saved as " + "'" + TextBox_SaveSelection.Text + "'. We suggest you write down the name of your selection.";
                    }
                }
            }

            SelectionLabel.Text = "Your selection has been saved as " + "'" + TextBox_SaveSelection.Text + "'. We suggest you write down the name of your selection.";
        }
        catch //(Exception ex)
        {
            //throw ex;
            SelectionLabel.Text = "There was a problem saving your selection. Please try again shortly.";
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T17:55:52.980

看起来您的问题是因为您正在尝试文件，但该文件并非来自用户操作启动的 FileSaveDialog。您遇到了 Silverlight 的安全功能，不允许您访问本地文件系统。相反，请尝试写入 IsolatedStorage。但是，请注意最终用户可以完全（以及有选择地）禁用应用程序存储，因此您还需要处理这些异常。

[这是一篇关于如何使用 IsolatedStorage 的快速文章。](http://blogs.silverlight.net/blogs/msnow/archive/2008/07/16/tip-of-the-day-19-using-isolated-storage.aspx)

# api - 修改记录的一个字段的正确 RESTful API 方法？

> ID：11005727
> 
> 赞同：0
> 
> 时间：2012-06-12T22:22:30.370
> 
> 标签：api, rest

假设我的 RESTful API 处理文件和文件夹。有了它，我可以创建和编辑文件和文件夹。

一个文件可以属于一个文件夹。因此，假设我想将文件移动到不同的文件夹。根据规范和/或最常见的情况，哪个最合适？

1.  POST 到 /file/:id，发送新文件夹的 id，只更改 folder_id 的值，保持所有其他属性不变。API 方法仅更新 folder_id。
2.  POST 到 /file/:id/location，发送新文件夹的 id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T03:32:20.987

这并不是一个直接的答案，但我想我会问自己的问题是：*移动文件*操作是否更适合文件资源或文件夹资源来处理。在我得到问题的答案之前，我不会太担心 URI 结构。

移动动作触及三个资源；文件、原始文件夹和目标文件夹。客户端至少需要知道文件 URI 和目标文件夹 URI，因为可以推断出原始文件夹。我可以看到这两种方法都有一个案例。文件资源表示（POST 的内容）可以将新的目标文件夹指示为一个值，如果不需要移动，则假定为空。文件夹资源可以假设 POST 中包含的文件表示意味着将该文件移动到文件夹。无论哪种方法对您的业务流程最有意义，我都会采用。

# php - PHP验证24小时时间格式

> ID：11005728
> 
> 赞同：9
> 
> 时间：2012-06-12T22:22:38.600
> 
> 标签：php, date, time

我允许用户从 to 中选择一个小时`00:00:00`，`23:00:00`并且需要检查他们是否提交了正确的格式。是否有验证 24 小时格式的正则表达式或 php 函数，例如`HH:MM:SS`？

我找到了一些正则表达式示例，但我验证的 24 小时时间始终设置`00`为分钟和秒。只有小时不同。

例如

```
18:00:00, 23:00:00, 01:00:00 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-12T22:26:13.810

这匹配 24 小时时间，包括秒

```
([01]?[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9] 
```

如果你只想要 00 表示分钟和秒，那么

```
([01]?[0-9]|2[0-3]):00:00 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-17T11:13:05.560

这是一个可以使用的最终样本。

```
$myTime = '23:00:00';

$time = preg_match('#^([01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#', $myTime);

if ( $time == 1 )
{
  // make a error!
}
else
{
  // make a error!
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-27T02:49:49.563

试试这个

```
$time="23:00:00";

preg_match('#^([01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#', $time); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-19T19:39:05.443

通过这个函数检查它，你可以在 CodeIgniter 的帮助文件中添加这个函数`Laravel global helper functions file`并调用它更多次

```
<?php
if(!function_exists("check_24_timeFormat")) {
    /**
     *
     * This for check time is in  24 time format  
     * 
     * @param string $time  [ $time => time in 24 hours format like 23:00:00 ]
     * @author Arafat Thabet <arafat.733011506@gmail.com> 
     * @return bool
     */
    function check_24_timeFormat($time){
        if (preg_match("#((0([0-9])|(1[0-9]{1})|(2[0-4])):([0-5])([0-9]):([0-5])([0-9]))#", $time)) {
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-09T12:24:20.633

必须是正则表达式吗？您可以轻松地使用 PHPs `strtotime`-function 来验证日期和时间（也可以在没有日期的情况下使用）。 如果给定时间无效，则`strtotime`返回`false`（在 PHP 5.1 之前）。`-1`因此不要忘记使用`===`操作数！

```
if (strtotime("12:13") === false) { echo("Wrong Time!"); } // Echos nothing
if (strtotime("19:45") === false) { echo("Wrong Time!"); } // Echos nothing
if (strtotime("17:62") === false) { echo("Wrong Time!"); } // Echos 'Wrong Time!' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-27T12:34:27.490

这对我来说就像一个魅力。

```
$time = "23:59:60";    
preg_match("/^([0-1][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$/", $time) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-02T20:11:29.137

尽管选择的答案绝对没问题，但我不是强加格式的坚持者。我的想法是，如果您可以解释数据，那么格式并不重要。当然，格式越输，你做出的假设越多，承担的风险就越大。但提供确认屏幕通常可以修正假设。所以，我写道：

```
/* Sample usage:
 *  echo '<ol>',
 *       '<li>validateTime ("13:23") = ',       (validateTime ('13:23')     ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("03:23 ") = ',      (validateTime ('03:23 ')    ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("03:23 Am") = ',    (validateTime ('03:23 aM')  ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("03:23Am") = ',     (validateTime ('03:23aM')   ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("03:23 pM") = ',    (validateTime ('03:23 pM')  ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("323") = ',         (validateTime ('323')       ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("058") = ',         (validateTime ('058')       ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("1323pm") = ',      (validateTime ('1323pm')    ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("1323am") = ',      (validateTime ('1323am')    ? 'TRUE' : 'FALSE'), '</li>',   // TRUE - I think this one makes sense, but I'm not sure. 13th hour of the day, starting in the AM?
 *       '<li>validateTime ("323pm") = ',       (validateTime ('323pm')     ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("3") = ',           (validateTime ('3')         ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("3PM") = ',         (validateTime ('3PM')       ? 'TRUE' : 'FALSE'), '</li>',   // TRUE
 *       '<li>validateTime ("13:73") = ',       (validateTime ('13:73')     ? 'TRUE' : 'FALSE'), '</li>',   // FALSE
 *       '<li>validateTime ("25:23") = ',       (validateTime ('25:23')     ? 'TRUE' : 'FALSE'), '</li>',   // FALSE
 *       '<li>validateTime ("Any crap") = ',    (validateTime ('Any crap')  ? 'TRUE' : 'FALSE'), '</li>',   // FALSE
 *       '</ol>';
 */
function validateTime ($testTime)
{
    define ('regExpPattern', '/^([01]?[0-9]|2[0-3])([:]?[0-5][0-9])?[ ]?([apAP][mM])?$/');

/*      regExpPattern explanation
            /^          # String must begin with.
            (           # Start group.
            [01]        # A 0 or 1.
            ?           # Optionally.
            [0-9]       # 0 through 9.
            |           # Or.
            2           # 2.
            [0-3]       # 0 through 3.
            )           # End of group. This group will match hour in a 24 hour clock.
            (           # New group.
            [:]?        # Optional colon.
            [0-5][0-9]  # Minutes, 00 through 59.
            )           # End of group.
            ?           # Make previous group optional.
            [ ]?        # Optional space.
            (           # New group.
            [apAP]      # One of the following 'apAP'.
            [mM]        # One of the following 'mM'.
            )           # End of group.
            ?           # Make previous group optional. This allows for things like 3 o'clock.
            $/          # Must end with. */

    return preg_match (regExpPattern, trim ($testTime));
}   // function validateTime ($testDate) 
```

如果您发现改进或错误，请告诉我。

我应该接受其他分隔符吗？如果有人选择进入 13.45 怎么办？那应该是有效时间吗？毕竟，我确实知道用户的意思。

现在下一步是获取所有可能格式的用户输入并使其对 SQL 友好。

享受，

# ios - ios TDD 与 Kiwi、OCHamcrest 和 OCMockiti，它们可以混合使用吗？

> ID：11005731
> 
> 赞同：1
> 
> 时间：2012-06-12T22:22:45.067
> 
> 标签：ios, tdd, ocmockito, ochamcrest

有没有人成功让 OCHamcrest 与 Kiwi 合作？我已经开始了一个 Kiwi 项目，然后我添加了 OCHamcrest 框架并成功构建。

但是，当我尝试使用 hamcrest 在我的 Kiwi 测试文件中断言条件时：

```
 it(@"has 3 elements.", ^{
         assertThat(stack, hasCountOf(3));  <------ this line is in hamcrest format
    //            [[stack should] haveCountOf:3];

    }); 
```

我的测试不会运行。它只是冻结了，我不得不手动杀死它。

主要是我想坚持使用 OCMockito，因为我熟悉并喜欢它（不太喜欢 OCHamcrest）。

我想知道是否有人可以帮助我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T05:37:12.160

这是一个猕猴桃虫。现在应该修好了。

[https://github.com/allending/Kiwi/issues/206](https://github.com/allending/Kiwi/issues/206)

# django - 在 Django 中从 direct_to_template 移动到新的 TemplateView

> ID：11005733
> 
> 赞同：18
> 
> 时间：2012-06-12T22:22:59.363
> 
> 标签：django, generics, migration, views

希望将我的项目更新到 django 的最新版本，并发现通用视图发生了很大变化。查看文档，我发现他们将所有通用内容更改为基于类的视图。我在很大程度上了解其用法，但是对于为视图返回大量对象时需要做什么感到困惑。当前网址可能如下所示：

```
(r'^$', direct_to_template, { 'template': 'index.html', 'extra_context': { 'form': CodeAddForm, 'topStores': get_topStores, 'newsStories': get_dealStories, 'latestCodes': get_latestCode, 'tags':get_topTags, 'bios':get_bios}},  'index'), 
```

我如何将类似的东西转换成这些新视图？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-27T21:45:53.157

[通用视图迁移](https://docs.djangoproject.com/en/1.4/topics/generic-views-migration/)描述了基于类的视图替换了什么。根据文档，传递 extra_context 的唯一方法是继承 TemplateView 并提供您自己的 get_context_data 方法。这是我想出的一个 DirectTemplateView 类，它允许`extra_context`使用`direct_to_template`.

```
from django.views.generic import TemplateView

class DirectTemplateView(TemplateView):
    extra_context = None
    def get_context_data(self, **kwargs):
        context = super(self.__class__, self).get_context_data(**kwargs)
        if self.extra_context is not None:
            for key, value in self.extra_context.items():
                if callable(value):
                    context[key] = value()
                else:
                    context[key] = value
        return context 
```

使用此类，您将替换：

```
(r'^$', direct_to_template, { 'template': 'index.html', 'extra_context': { 
    'form': CodeAddForm, 
    'topStores': get_topStores, 
    'newsStories': get_dealStories, 
    'latestCodes': get_latestCode, 
    'tags':get_topTags, 
    'bios':get_bios
}},  'index'), 
```

和：

```
(r'^$', DirectTemplateView.as_view(template_name='index.html', extra_context={ 
    'form': CodeAddForm, 
    'topStores': get_topStores, 
    'newsStories': get_dealStories, 
    'latestCodes': get_latestCode, 
    'tags':get_topTags, 
    'bios':get_bios
}), 'index'), 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-27T17:41:47.387

我在使用 DirectTemplateView 子类时遇到了 Pykler 的回答问题。具体来说，这个错误：

```
AttributeError at /pipe/data_browse/ 'DirectTemplateView' object has no attribute 'has_header' Request Method:  
  GET Request URL:  http://localhost:8000/pipe/data_browse/ Django Version: 1.5.2
  Exception Type:   AttributeError
  Exception Value:   'DirectTemplateView' object has no attribute 'has_header'
  Exception Location:   /Library/Python/2.7/site-packages/django/utils/cache.py in patch_vary_headers, line 142 
  Python Executable:    /usr/bin/python 
  Python Version:   2.7.2 
```

对我有用的是转换任何这样的行：

```
return direct_to_template(request, 'template.html', {'foo':12, 'bar':13}) 
```

对此：

```
return render_to_response('template.html', {'foo':12, 'bar':13}, context_instance=RequestContext(request)) 
```

# asp.net - Visual Studio 2010 源代码格式化 HTML div 标签

> ID：11005738
> 
> 赞同：3
> 
> 时间：2012-06-12T22:23:26.720
> 
> 标签：asp.net, html, visual-studio-2010, code-formatting

我已将 div 标签设置为“在打开之前、内部和关闭之后”插入换行符，但我没有在内容之后获得换行符。

我得到这个：

```
<div>
   content</div> 
```

但我想要这个：

```
<div>
   content
</div> 
```

同样，我在选项中做出了正确的选择。它甚至在预览框中显示正确的方式。如果我将选择更改为无换行符，则格式正确。

这是其他人的问题吗？

请注意，这是在 aspx/c 页面中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:16:35.000

它不分隔结束 div 元素的原因是因为在那里添加空格可能会改变渲染的空白语义。
看看 scott gutherie 的最后一条评论：[http ://weblogs.asp.net/scottgu/archive/2006/07/07/Tip_2F00_Trick_3A00_-Custom-formatting-HTML-in-Visual-Web-Developer-and- Visual-Studio-2005.aspx](http://weblogs.asp.net/scottgu/archive/2006/07/07/Tip_2F00_Trick_3A00_-Custom-formatting-HTML-in-Visual-Web-Developer-and-Visual-Studio-2005.aspx)

# android - 需要有关 android 基本事情的帮助，这让我困惑了几天

> ID：11005741
> 
> 赞同：0
> 
> 时间：2012-06-12T22:23:42.943
> 
> 标签：android, emulation

我是android开发的大一新生，遇到了一个让我困惑了几天的问题。

我运行简单的“hello world”代码（我保证代码中没有错误，因为我直接从 SDK 的主页复制它），然后模拟器运行但我的应用程序没有安装在其中。控制台是这样的：

[2012-06-12 23:05:50 - HelloPig] ------------------------------

[2012-06-12 23:05:50 - HelloPig] Android 发布！

[2012-06-12 23:05:50 - HelloPig] adb 运行正常。

[2012-06-12 23:05:50 - HelloPig] 执行 com.example.hellopig.HelloPigActivity 活动启动

[2012-06-12 23:05:50 - HelloPig] 自动目标模式：启动具有兼容 AVD 'aaa' 的新模拟器

[2012-06-12 23:05:50 - HelloPig] 使用虚拟设备“aaa”启动新模拟器

[2012-06-12 23:05:55 - Emulator] 模拟器：模拟器窗口不在视野范围内，并被重新定位

[2012-06-12 23:05:55 - 模拟器]

它只是保持在那里，我认为应该有安装应用程序和成功之类的东西。我首先认为问题是eclipse找不到我的模拟器，但没有错误。我检查了构建调试密钥库路径，它是我的模拟器所在的地方。我也检查了环境变量，但我认为它们没有问题（我可以在cmd中运行java和adb）

我真的不知道，所以有人可以帮助我吗？

以下是软件版本： jdk 1.6 ADT 18.0.0 SDK platform 1.5 eclipes java EE IDE for developer

期待收到你们任何人的来信：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:34:52.300

我建议在尝试安装您的应用程序之前启动您的模拟器。看起来您正在等待 Android 为您启动模拟器。

否则这里没有足够的信息。我建议运行 logcat（打开命令提示符，然后输入“adb logcat”），这将为您提供更详细的日志记录信息。

发布 logcat 的输出（如果您的问题不是很明显）。

# facebook - 发布动作有效...但没有图像

> ID：11005743
> 
> 赞同：1
> 
> 时间：2012-06-12T22:23:49.657
> 
> 标签：facebook, image, facebook-graph-api, facebook-opengraph, meta-tags

我可以使用以下 url 向 facebook 发布一个开放的图形操作：

[https://graph.facebook.com/me/video.watches](https://graph.facebook.com/me/video.watches)

使用以下帖子数据：

视频= [http://eqnetwork.com/home/video.html?f=8e7b4f27-8cbd-4430-84df-d9ccb46da45f.mp4](http://eqnetwork.com/home/video.html?f=8e7b4f27-8cbd-4430-84df-d9ccb46da45f.mp4)

[图片链接 http://www.brianrice.com/downloads/actionpost.png](http://www.brianrice.com/downloads/actionpost.png)

它似乎是从“视频”对象的开放图形元标记中获取标题。但是，它没有得到图像（即使在元标记“og:image”中指定了一个）。

另外，如果我将其添加到帖子数据中：

图片= [http://eqnetwork.com/icons/mgen/overplayThumbnail.ms?drid=14282&subType=ljpg&w=120&h=120&o=1&thumbnail=](http://eqnetwork.com/icons/mgen/overplayThumbnail.ms?drid=14282&subType=ljpg&w=120&h=120&o=1&thumbnail=)

仍然没有图像。

有什么想法吗？

*   布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:31:35.483

这是我用 facebook 调试器测试后得到的结果：

```
developers.facebook.com/tools/debug/og/echo?q=http%3A%2F%2Feqnetwork.com%2Ficons%2Fmgen%2FoverplayThumbnail.ms%3Fdrid%3D15162%26subType%3Dljpg%26w%3D120%26h%3D120%26o%3D1%26thumbnail%3D 
```

下面是抓取的网址。所以很明显有一个CDN错误。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<b>06/12/2012 15:33:12 ***** CDNMGEN2 reported an error *****</b><br><br><tt>
MRL: /mgen/overplayThumbnail.ms?drid=15162&amp;subType=ljpg&amp;w=120&amp;h=120&amp;o=1&amp;thumbnail<br><br>
A filter error occurred while processing '/mgen/overplayThumbnail.ms?drid=15162&amp;subType=ljpg&amp;w=120&amp;h=120&amp;o=1&amp;thumbnail':<br>Missing value for overplayThumbnail.ms?drid=15162&amp;subType=ljpg&amp;w=120&amp;h=120&amp;o=1&amp;thumbnail at thumbnail</tt>
</head></html> 
```

这是对应该提供的缩略图值的抱怨。

# cpu - 为什么不使用 GPU 作为 CPU？

> ID：11005746
> 
> 赞同：21
> 
> 时间：2012-06-12T22:24:13.943
> 
> 标签：cpu, opencl, gpu

我知道这个问题只是部分与编程相关，因为我想得到的答案最初来自这两个问题：

为什么 CPU 内核数量如此之低（与 GPU 相比）？为什么我们不使用 GPU 而不是 CPU、仅使用 GPU 或仅使用 CPU？（我知道 GPU 是专门的，而 CPU 则更多地用于多任务等）。我也知道存在内存（主机与 GPU）限制以及精度和缓存能力。但是，在硬件比较方面，高端到高端 CPU/GPU 比较 GPU 的性能要高得多。

所以我的问题是：**我们能否在操作系统、应用程序等中使用 GPU 而不是 CPU**

我问这个问题的原因是因为我想知道为什么当前的计算机仍然使用 2 个主处理单元 (CPU/GPU) 和两个主内存和缓存系统 (CPU/GPU)，即使它不是一个程序员愿意。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-12T22:32:46.187

当前的 GPU 缺乏现代 CPU 的许多功能，这些功能通常被认为对操作系统之类的东西很重要（真的很重要）。

例如，操作系统通常使用虚拟内存和分页来管理进程。分页允许操作系统为每个进程提供自己的地址空间，（几乎）与其他所有进程完全隔离。至少根据公开可用的信息，大多数 GPU 根本不支持分页（或者至少不支持操作系统所需的方式）。

GPU 的时钟速度也比 CPU 低得多。因此，它们*只*为令人尴尬的并行问题提供高性能。CPU 通常为单线程代码提供更高的性能。操作系统中的大多数代码都不是高度并行的——事实上，很多代码都很难实现并行（例如，多年来，Linux 有一个巨大的锁来确保只有一个线程执行大多数内核代码）任何给定时间）。对于此类任务，GPU 不太可能提供任何好处。

从编程的角度来看，GPU 是喜忧参半（充其量）。人们花了数年时间研究编程模型，以使 GPU 编程更加理智，即便如此，它（通常）比 CPU 编程要困难得多。考虑到即使是相对微不足道的事情也很难在 GPU 上正常运行，我无法想象尝试编写任何接近于像操作系统一样大和复杂的东西来在 GPU 上运行。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-12T22:33:08.680

GPU 是为与图形相关的处理而设计的（显然），这本质上是从并行处理（一次执行多个任务/计算）中受益的东西。这意味着，与您可能知道的通常具有 2-8 个内核的现代 CPU 不同，GPU 具有数百个内核。这意味着它们特别适合处理光线追踪或您在 3D 游戏或其他图形密集型活动中可能遇到的任何其他事情。

另一方面，CPU 的内核数量相对有限，因为 CPU 面临的任务通常不会像渲染 3D 场景那样从并行处理中受益。事实上，CPU 中的内核过多实际上会降低机器的性能，因为 CPU 通常执行的任务的性质以及许多程序不会被编写以利用多个内核的事实. 这意味着对于互联网浏览或大多数其他桌面任务，具有几个强大内核的 CPU 比具有许多更小内核的 GPU 更适合这项工作。

另一件需要注意的是，更多的内核通常意味着需要更多的功率。这意味着从功率和热量的角度来看，256 核手机或笔记本电脑将非常不切实际，更不用说制造挑战和成本了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-05T14:03:23.500

如果您查看它们的结构，通常操作系统非常简单。但是并行化它们不会大大提高速度，只有原始时钟速度可以。

GPU 只是缺少操作系统需要的指令集中的部件和大量指令，这是一个复杂的问题。想想虚拟化功能（Intel VT-x 或 AMD 的 AMD-v）。

GPU 核心就像是哑蚂蚁，而 CPU 就像一个复杂的人，可以这么说。两者因此具有不同的能量消耗并产生非常不同的热量。

有关更多信息，请[在此处](https://superuser.com/questions/308771/why-are-we-still-using-cpus-instead-of-gpus)查看此广泛的超级用户答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-22T06:25:57.627

因为没有人会为此花费金钱和时间。除了像这样的一些爱好者：http: [//gerigeri.uw.hu/DawnOS/history.html](http://gerigeri.uw.hu/DawnOS/history.html)（现在在这里：[http](http://users.atw.hu/gerigeri/DawnOS/history.html) ://users.atw.hu/gerigeri/DawnOS/history.html ）

> Dawn 现在可以在 GPU-s 上运行：借助新的支持 OpenCL 的模拟器，Dawn 现在可以在显卡、GPU-s 和 IGP-s（使用 OpenCL 1.0）上启动并运行。Dawn 是第一个也是唯一一个在图形芯片上完全启动和工作的操作系统。

# java - 是否有 Util 将美国州名转换为州代码。例如。亚利桑那州到亚利桑那州？

> ID：11005751
> 
> 赞同：28
> 
> 时间：2012-06-12T22:25:17.937
> 
> 标签：java, android

我需要将全州名称转换为其官方州地址代码。例如来自 String New York，我需要制作 NY。现在我可以把这一切都放在一个哈希图中，但似乎必须有一个实用程序？我在Android环境中。但是，我不想只为这个工具导入一个大型库。谢谢

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-06-12T23:24:03.913

我有现成的 - 你可以使用它：

```
Map<String, String> states = new HashMap<String, String>();
states.put("Alabama","AL");
states.put("Alaska","AK");
states.put("Alberta","AB");
states.put("American Samoa","AS");
states.put("Arizona","AZ");
states.put("Arkansas","AR");
states.put("Armed Forces (AE)","AE");
states.put("Armed Forces Americas","AA");
states.put("Armed Forces Pacific","AP");
states.put("British Columbia","BC");
states.put("California","CA");
states.put("Colorado","CO");
states.put("Connecticut","CT");
states.put("Delaware","DE");
states.put("District Of Columbia","DC");
states.put("Florida","FL");
states.put("Georgia","GA");
states.put("Guam","GU");
states.put("Hawaii","HI");
states.put("Idaho","ID");
states.put("Illinois","IL");
states.put("Indiana","IN");
states.put("Iowa","IA");
states.put("Kansas","KS");
states.put("Kentucky","KY");
states.put("Louisiana","LA");
states.put("Maine","ME");
states.put("Manitoba","MB");
states.put("Maryland","MD");
states.put("Massachusetts","MA");
states.put("Michigan","MI");
states.put("Minnesota","MN");
states.put("Mississippi","MS");
states.put("Missouri","MO");
states.put("Montana","MT");
states.put("Nebraska","NE");
states.put("Nevada","NV");
states.put("New Brunswick","NB");
states.put("New Hampshire","NH");
states.put("New Jersey","NJ");
states.put("New Mexico","NM");
states.put("New York","NY");
states.put("Newfoundland","NF");
states.put("North Carolina","NC");
states.put("North Dakota","ND");
states.put("Northwest Territories","NT");
states.put("Nova Scotia","NS");
states.put("Nunavut","NU");
states.put("Ohio","OH");
states.put("Oklahoma","OK");
states.put("Ontario","ON");
states.put("Oregon","OR");
states.put("Pennsylvania","PA");
states.put("Prince Edward Island","PE");
states.put("Puerto Rico","PR");
states.put("Quebec","QC");
states.put("Rhode Island","RI");
states.put("Saskatchewan","SK");
states.put("South Carolina","SC");
states.put("South Dakota","SD");
states.put("Tennessee","TN");
states.put("Texas","TX");
states.put("Utah","UT");
states.put("Vermont","VT");
states.put("Virgin Islands","VI");
states.put("Virginia","VA");
states.put("Washington","WA");
states.put("West Virginia","WV");
states.put("Wisconsin","WI");
states.put("Wyoming","WY");
states.put("Yukon Territory","YT"); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2014-05-28T17:15:19.000

我知道这并不能回答问题，但以防万一有人需要相反的情况：使用州/省的缩写作为键和名称作为值。我花了几分钟重新格式化地图。此外，接受的答案中魁北克的缩写是错误的。

```
public static final Map<String, String> STATE_MAP;
static {
    STATE_MAP = new HashMap<String, String>();
    STATE_MAP.put("AL", "Alabama");
    STATE_MAP.put("AK", "Alaska");
    STATE_MAP.put("AB", "Alberta");
    STATE_MAP.put("AZ", "Arizona");
    STATE_MAP.put("AR", "Arkansas");
    STATE_MAP.put("BC", "British Columbia");
    STATE_MAP.put("CA", "California");
    STATE_MAP.put("CO", "Colorado");
    STATE_MAP.put("CT", "Connecticut");
    STATE_MAP.put("DE", "Delaware");
    STATE_MAP.put("DC", "District Of Columbia");
    STATE_MAP.put("FL", "Florida");
    STATE_MAP.put("GA", "Georgia");
    STATE_MAP.put("GU", "Guam");
    STATE_MAP.put("HI", "Hawaii");
    STATE_MAP.put("ID", "Idaho");
    STATE_MAP.put("IL", "Illinois");
    STATE_MAP.put("IN", "Indiana");
    STATE_MAP.put("IA", "Iowa");
    STATE_MAP.put("KS", "Kansas");
    STATE_MAP.put("KY", "Kentucky");
    STATE_MAP.put("LA", "Louisiana");
    STATE_MAP.put("ME", "Maine");
    STATE_MAP.put("MB", "Manitoba");
    STATE_MAP.put("MD", "Maryland");
    STATE_MAP.put("MA", "Massachusetts");
    STATE_MAP.put("MI", "Michigan");
    STATE_MAP.put("MN", "Minnesota");
    STATE_MAP.put("MS", "Mississippi");
    STATE_MAP.put("MO", "Missouri");
    STATE_MAP.put("MT", "Montana");
    STATE_MAP.put("NE", "Nebraska");
    STATE_MAP.put("NV", "Nevada");
    STATE_MAP.put("NB", "New Brunswick");
    STATE_MAP.put("NH", "New Hampshire");
    STATE_MAP.put("NJ", "New Jersey");
    STATE_MAP.put("NM", "New Mexico");
    STATE_MAP.put("NY", "New York");
    STATE_MAP.put("NF", "Newfoundland");
    STATE_MAP.put("NC", "North Carolina");
    STATE_MAP.put("ND", "North Dakota");
    STATE_MAP.put("NT", "Northwest Territories");
    STATE_MAP.put("NS", "Nova Scotia");
    STATE_MAP.put("NU", "Nunavut");
    STATE_MAP.put("OH", "Ohio");
    STATE_MAP.put("OK", "Oklahoma");
    STATE_MAP.put("ON", "Ontario");
    STATE_MAP.put("OR", "Oregon");
    STATE_MAP.put("PA", "Pennsylvania");
    STATE_MAP.put("PE", "Prince Edward Island");
    STATE_MAP.put("PR", "Puerto Rico");
    STATE_MAP.put("QC", "Quebec");
    STATE_MAP.put("RI", "Rhode Island");
    STATE_MAP.put("SK", "Saskatchewan");
    STATE_MAP.put("SC", "South Carolina");
    STATE_MAP.put("SD", "South Dakota");
    STATE_MAP.put("TN", "Tennessee");
    STATE_MAP.put("TX", "Texas");
    STATE_MAP.put("UT", "Utah");
    STATE_MAP.put("VT", "Vermont");
    STATE_MAP.put("VI", "Virgin Islands");
    STATE_MAP.put("VA", "Virginia");
    STATE_MAP.put("WA", "Washington");
    STATE_MAP.put("WV", "West Virginia");
    STATE_MAP.put("WI", "Wisconsin");
    STATE_MAP.put("WY", "Wyoming");
    STATE_MAP.put("YT", "Yukon Territory");
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-02-14T17:37:52.387

使用枚举更好。

```
import java.util.HashMap;
import java.util.Map;

public enum State {

    ALABAMA("Alabama", "AL"), ALASKA("Alaska", "AK"), AMERICAN_SAMOA("American Samoa", "AS"), ARIZONA("Arizona", "AZ"), ARKANSAS(
    "Arkansas", "AR"), CALIFORNIA("California", "CA"), COLORADO("Colorado", "CO"), CONNECTICUT("Connecticut", "CT"), DELAWARE(
    "Delaware", "DE"), DISTRICT_OF_COLUMBIA("District of Columbia", "DC"), FEDERATED_STATES_OF_MICRONESIA(
    "Federated States of Micronesia", "FM"), FLORIDA("Florida", "FL"), GEORGIA("Georgia", "GA"), GUAM("Guam", "GU"), HAWAII(
    "Hawaii", "HI"), IDAHO("Idaho", "ID"), ILLINOIS("Illinois", "IL"), INDIANA("Indiana", "IN"), IOWA("Iowa", "IA"), KANSAS(
    "Kansas", "KS"), KENTUCKY("Kentucky", "KY"), LOUISIANA("Louisiana", "LA"), MAINE("Maine", "ME"), MARYLAND("Maryland", "MD"), MARSHALL_ISLANDS(
    "Marshall Islands", "MH"), MASSACHUSETTS("Massachusetts", "MA"), MICHIGAN("Michigan", "MI"), MINNESOTA("Minnesota", "MN"), MISSISSIPPI(
    "Mississippi", "MS"), MISSOURI("Missouri", "MO"), MONTANA("Montana", "MT"), NEBRASKA("Nebraska", "NE"), NEVADA("Nevada",
    "NV"), NEW_HAMPSHIRE("New Hampshire", "NH"), NEW_JERSEY("New Jersey", "NJ"), NEW_MEXICO("New Mexico", "NM"), NEW_YORK(
    "New York", "NY"), NORTH_CAROLINA("North Carolina", "NC"), NORTH_DAKOTA("North Dakota", "ND"), NORTHERN_MARIANA_ISLANDS(
    "Northern Mariana Islands", "MP"), OHIO("Ohio", "OH"), OKLAHOMA("Oklahoma", "OK"), OREGON("Oregon", "OR"), PALAU("Palau",
    "PW"), PENNSYLVANIA("Pennsylvania", "PA"), PUERTO_RICO("Puerto Rico", "PR"), RHODE_ISLAND("Rhode Island", "RI"), SOUTH_CAROLINA(
    "South Carolina", "SC"), SOUTH_DAKOTA("South Dakota", "SD"), TENNESSEE("Tennessee", "TN"), TEXAS("Texas", "TX"), UTAH(
    "Utah", "UT"), VERMONT("Vermont", "VT"), VIRGIN_ISLANDS("Virgin Islands", "VI"), VIRGINIA("Virginia", "VA"), WASHINGTON(
    "Washington", "WA"), WEST_VIRGINIA("West Virginia", "WV"), WISCONSIN("Wisconsin", "WI"), WYOMING("Wyoming", "WY"), UNKNOWN(
    "Unknown", "");

    /**
     * The state's name.
     */
    private String name;

    /**
     * The state's abbreviation.
     */
    private String abbreviation;

    /**
     * The set of states addressed by abbreviations.
     */
    private static final Map<String, State> STATES_BY_ABBR = new HashMap<String, State>();

    /* static initializer */
    static {
        for (State state : values()) {
            STATES_BY_ABBR.put(state.getAbbreviation(), state);
        }
    }

    /**
     * Constructs a new state.
     *
     * @param name the state's name.
     * @param abbreviation the state's abbreviation.
     */
    State(String name, String abbreviation) {
        this.name = name;
        this.abbreviation = abbreviation;
    }

    /**
     * Returns the state's abbreviation.
     *
     * @return the state's abbreviation.
     */
    public String getAbbreviation() {
        return abbreviation;
    }

    /**
     * Gets the enum constant with the specified abbreviation.
     *
     * @param abbr the state's abbreviation.
     * @return the enum constant with the specified abbreviation.
     * @throws SunlightException if the abbreviation is invalid.
     */
    public static State valueOfAbbreviation(final String abbr) {
        final State state = STATES_BY_ABBR.get(abbr);
        if (state != null) {
            return state;
        } else {
            return UNKNOWN;
        }
    }

    public static State valueOfName(final String name) {
        final String enumName = name.toUpperCase().replaceAll(" ", "_");
        try {
            return valueOf(enumName);
        } catch (final IllegalArgumentException e) {
            return State.UNKNOWN;
        }
    }

    @Override
    public String toString() {
        return name;
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-13T21:50:38.833

这是带有美国 (US) 和美国领土、加拿大和墨西哥的代码的更新版本。这是一张2路地图。因此，这为给定代码提供了名称，反之亦然。向下滚动以查看这两个选项。

```
private static final Map<String, String> stateCodeToNameMap = new HashMap<>();

private static final Map<String, String> stateNameToCodeMap = new HashMap<>();

static {
    // Load US Codes.
    stateCodeToNameMap.put("AK", "Alaska");
    stateCodeToNameMap.put("AL", "Alabama");
    stateCodeToNameMap.put("AR", "Arkansas");
    stateCodeToNameMap.put("AZ", "Arizona");
    stateCodeToNameMap.put("CA", "California");
    stateCodeToNameMap.put("CO", "Colorado");
    stateCodeToNameMap.put("CT", "Connecticut");
    stateCodeToNameMap.put("DC", "District of Columbia");
    stateCodeToNameMap.put("DE", "Delaware");
    stateCodeToNameMap.put("FL", "Florida");
    stateCodeToNameMap.put("GA", "Georgia");
    stateCodeToNameMap.put("HI", "Hawaii");
    stateCodeToNameMap.put("IA", "Iowa");
    stateCodeToNameMap.put("ID", "Idaho");
    stateCodeToNameMap.put("IL", "Illinois");
    stateCodeToNameMap.put("IN", "Indiana");
    stateCodeToNameMap.put("KS", "Kansas");
    stateCodeToNameMap.put("KY", "Kentucky");
    stateCodeToNameMap.put("LA", "Louisiana");
    stateCodeToNameMap.put("MA", "Massachusetts");
    stateCodeToNameMap.put("MD", "Maryland");
    stateCodeToNameMap.put("ME", "Maine");
    stateCodeToNameMap.put("MI", "Michigan");
    stateCodeToNameMap.put("MN", "Minnesota");
    stateCodeToNameMap.put("MO", "Missouri");
    stateCodeToNameMap.put("MS", "Mississippi");
    stateCodeToNameMap.put("MT", "Montana");
    stateCodeToNameMap.put("NC", "North Carolina");
    stateCodeToNameMap.put("ND", "North Dakota");
    stateCodeToNameMap.put("NE", "Nebraska");
    stateCodeToNameMap.put("NH", "New Hampshire");
    stateCodeToNameMap.put("NJ", "New Jersey");
    stateCodeToNameMap.put("NM", "New Mexico");
    stateCodeToNameMap.put("NV", "Nevada");
    stateCodeToNameMap.put("NY", "New York");
    stateCodeToNameMap.put("OH", "Ohio");
    stateCodeToNameMap.put("OK", "Oklahoma");
    stateCodeToNameMap.put("OR", "Oregon");
    stateCodeToNameMap.put("PA", "Pennsylvania");
    stateCodeToNameMap.put("RI", "Rhode Island");
    stateCodeToNameMap.put("SC", "South Carolina");
    stateCodeToNameMap.put("SD", "South Dakota");
    stateCodeToNameMap.put("TN", "Tennessee");
    stateCodeToNameMap.put("TX", "Texas");
    stateCodeToNameMap.put("UT", "Utah");
    stateCodeToNameMap.put("VA", "Virginia");
    stateCodeToNameMap.put("VT", "Vermont");
    stateCodeToNameMap.put("WA", "Washington");
    stateCodeToNameMap.put("WI", "Wisconsin");
    stateCodeToNameMap.put("WV", "West Virginia");
    stateCodeToNameMap.put("WY", "Wyoming");
    stateCodeToNameMap.put("GU", "Guam");
    stateCodeToNameMap.put("VI", "Virgin Islands");
    stateCodeToNameMap.put("PR", "Puerto Rico");
    stateCodeToNameMap.put("AE", "Armed forces - Europe");
    stateCodeToNameMap.put("AA", "Armed forces - America");
    stateCodeToNameMap.put("AP", "Armed forces - Pacific");

    // Load Canada Codes.
    stateCodeToNameMap.put("AB", "Alberta");
    stateCodeToNameMap.put("BC", "British Columbia");
    stateCodeToNameMap.put("MB", "Manitoba");
    stateCodeToNameMap.put("NB", "New Brunswick");
    stateCodeToNameMap.put("NL", "Newfoundland and Labrador");
    stateCodeToNameMap.put("NT", "Northwest Territories");
    stateCodeToNameMap.put("NS", "Nova Scotia");
    stateCodeToNameMap.put("NU", "Nunavut");
    stateCodeToNameMap.put("ON", "Ontario");
    stateCodeToNameMap.put("PE", "Prince Edward Island");
    stateCodeToNameMap.put("QC", "Quebec");
    stateCodeToNameMap.put("SK", "Saskatchewan");
    stateCodeToNameMap.put("YT", "Yukon");

    // Load México Codes.
    stateCodeToNameMap.put("AGU", "Aguascalientes");
    stateCodeToNameMap.put("BCN", "Baja California");
    stateCodeToNameMap.put("BCS", "Baja California Sur");
    stateCodeToNameMap.put("CAM", "Campeche");
    stateCodeToNameMap.put("CHP", "Chiapas");
    stateCodeToNameMap.put("CHH", "Chihuahua");
    stateCodeToNameMap.put("COA", "Coahuila");
    stateCodeToNameMap.put("COL", "Colima");
    stateCodeToNameMap.put("DIF", "Distrito Federal");
    stateCodeToNameMap.put("DUR", "Durango");
    stateCodeToNameMap.put("GUA", "Guanajuato");
    stateCodeToNameMap.put("GRO", "Guerrero");
    stateCodeToNameMap.put("HID", "Hidalgo");
    stateCodeToNameMap.put("JAL", "Jalisco");
    stateCodeToNameMap.put("MEX", "México");
    stateCodeToNameMap.put("MIC", "Michoacán");
    stateCodeToNameMap.put("MOR", "Morelos");
    stateCodeToNameMap.put("NAY", "Nayarit");
    stateCodeToNameMap.put("NLE", "Nuevo León");
    stateCodeToNameMap.put("OAX", "Oaxaca");
    stateCodeToNameMap.put("PUE", "Puebla");
    stateCodeToNameMap.put("QUE", "Querétaro");
    stateCodeToNameMap.put("ROO", "Quintana Roo");
    stateCodeToNameMap.put("SLP", "San Luis Potosí");
    stateCodeToNameMap.put("SIN", "Sinaloa");
    stateCodeToNameMap.put("SON", "Sonora");
    stateCodeToNameMap.put("TAB", "Tabasco");
    stateCodeToNameMap.put("TAM", "Tamaulipas");
    stateCodeToNameMap.put("TLA", "Tlaxcala");
    stateCodeToNameMap.put("VER", "Veracruz");
    stateCodeToNameMap.put("YUC", "Yucatán");
    stateCodeToNameMap.put("ZAC", "Zacatecas");

    // Load US State Names.
    stateNameToCodeMap.put("Alabama","AL");
    stateNameToCodeMap.put("Alaska","AK");
    stateNameToCodeMap.put("Arizona","AZ");
    stateNameToCodeMap.put("Arkansas","AR");
    stateNameToCodeMap.put("California","CA");
    stateNameToCodeMap.put("Colorado","CO");
    stateNameToCodeMap.put("Connecticut","CT");
    stateNameToCodeMap.put("Delaware","DE");
    stateNameToCodeMap.put("District Of Columbia","DC");
    stateNameToCodeMap.put("Florida","FL");
    stateNameToCodeMap.put("Georgia","GA");
    stateNameToCodeMap.put("Hawaii","HI");
    stateNameToCodeMap.put("Idaho","ID");
    stateNameToCodeMap.put("Illinois","IL");
    stateNameToCodeMap.put("Indiana","IN");
    stateNameToCodeMap.put("Iowa","IA");
    stateNameToCodeMap.put("Kansas","KS");
    stateNameToCodeMap.put("Kentucky","KY");
    stateNameToCodeMap.put("Louisiana","LA");
    stateNameToCodeMap.put("Maine","ME");
    stateNameToCodeMap.put("Maryland","MD");
    stateNameToCodeMap.put("Massachusetts","MA");
    stateNameToCodeMap.put("Michigan","MI");
    stateNameToCodeMap.put("Minnesota","MN");
    stateNameToCodeMap.put("Mississippi","MS");
    stateNameToCodeMap.put("Missouri","MO");
    stateNameToCodeMap.put("Montana","MT");
    stateNameToCodeMap.put("Nebraska","NE");
    stateNameToCodeMap.put("Nevada","NV");
    stateNameToCodeMap.put("New Hampshire","NH");
    stateNameToCodeMap.put("New Jersey","NJ");
    stateNameToCodeMap.put("New Mexico","NM");
    stateNameToCodeMap.put("New York","NY");
    stateNameToCodeMap.put("North Carolina","NC");
    stateNameToCodeMap.put("North Dakota","ND");
    stateNameToCodeMap.put("Ohio","OH");
    stateNameToCodeMap.put("Oklahoma","OK");
    stateNameToCodeMap.put("Oregon","OR");
    stateNameToCodeMap.put("Pennsylvania","PA");
    stateNameToCodeMap.put("Rhode Island","RI");
    stateNameToCodeMap.put("South Carolina","SC");
    stateNameToCodeMap.put("South Dakota","SD");
    stateNameToCodeMap.put("Tennessee","TN");
    stateNameToCodeMap.put("Texas","TX");
    stateNameToCodeMap.put("Utah","UT");
    stateNameToCodeMap.put("Vermont","VT");
    stateNameToCodeMap.put("Virginia","VA");
    stateNameToCodeMap.put("Washington","WA");
    stateNameToCodeMap.put("West Virginia","WV");
    stateNameToCodeMap.put("Wisconsin","WI");
    stateNameToCodeMap.put("Wyoming","WY");
    stateNameToCodeMap.put("Guam", "GU");
    stateNameToCodeMap.put("Puerto Rico","PR");
    stateNameToCodeMap.put("Virgin Islands","VI");
    stateNameToCodeMap.put("Armed Forces (AE)","AE");
    stateNameToCodeMap.put("Armed Forces Americas","AA");
    stateNameToCodeMap.put("Armed Forces Pacific","AP");

    // Load Canada State Names.
    stateNameToCodeMap.put("Alberta","AB");
    stateNameToCodeMap.put("British Columbia","BC");
    stateNameToCodeMap.put("Manitoba","MB");
    stateNameToCodeMap.put("New Brunswick","NB");
    stateNameToCodeMap.put("Newfoundland and Labrador","NF");
    stateNameToCodeMap.put("Northwest Territories","NT");
    stateNameToCodeMap.put("Nova Scotia","NS");
    stateNameToCodeMap.put("Nunavut","NU");
    stateNameToCodeMap.put("Ontario","ON");
    stateNameToCodeMap.put("Prince Edward Island","PE");
    stateNameToCodeMap.put("Quebec","QC");
    stateNameToCodeMap.put("Saskatchewan","SK");
    stateNameToCodeMap.put("Yukon Territory","YT");

    // Load México State Names.
    stateNameToCodeMap.put("Aguascalientes", "AGU");
    stateNameToCodeMap.put("Baja California", "BCN");
    stateNameToCodeMap.put("Baja California Sur", "BCS");
    stateNameToCodeMap.put("Campeche", "CAM");
    stateNameToCodeMap.put("Chiapas", "CHP");
    stateNameToCodeMap.put("Chihuahua", "CHH");
    stateNameToCodeMap.put("Coahuila", "COA");
    stateNameToCodeMap.put("Colima", "COL");
    stateNameToCodeMap.put("Distrito Federal", "DIF");
    stateNameToCodeMap.put("Durango", "DUR");
    stateNameToCodeMap.put("Guanajuato", "GUA");
    stateNameToCodeMap.put("Guerrero", "GRO");
    stateNameToCodeMap.put("Hidalgo", "HID");
    stateNameToCodeMap.put("Jalisco", "JAL");
    stateNameToCodeMap.put("México", "MEX");
    stateNameToCodeMap.put("Michoacán", "MIC");
    stateNameToCodeMap.put("Morelos", "MOR");
    stateNameToCodeMap.put("Nayarit", "NAY");
    stateNameToCodeMap.put("Nuevo León", "NLE");
    stateNameToCodeMap.put("Oaxaca", "OAX");
    stateNameToCodeMap.put("Puebla", "PUE");
    stateNameToCodeMap.put("Querétaro", "QUE");
    stateNameToCodeMap.put("Quintana Roo", "ROO");
    stateNameToCodeMap.put("San Luis Potosí", "SLP");
    stateNameToCodeMap.put("Sinaloa", "SIN");
    stateNameToCodeMap.put("Sonora", "SON");
    stateNameToCodeMap.put("Tabasco", "TAB");
    stateNameToCodeMap.put("Tamaulipas", "TAM");
    stateNameToCodeMap.put("Tlaxcala", "TLA");
    stateNameToCodeMap.put("Veracruz", "VER");
    stateNameToCodeMap.put("Yucatán", "YUC");
    stateNameToCodeMap.put("Zacatecas", "ZAC");
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-06-13T17:15:03.383

作为键和值：

```
public enum State {

    AK("AK", "Alaska"),
    AL("AL", "Alabama"),
    AR("AR", "Arkansas"),
    AZ("AZ", "Arizona"),
    CA("CA", "California"),
    CO("CO", "Colorado"),
    CT("CT", "Connecticut"),
    DE("DE", "Delaware"),
    FL("FL", "Florida"),
    GA("GA", "Georgia"),
    HI("HI", "Hawaii"),
    IA("IA", "Iowa"),
    ID("ID", "Idaho"),
    IL("IL", "Illinois"),
    IN("IN", "Indiana"),
    KS("KS", "Kansas"),
    KY("KY", "Kentucky"),
    LA("LA", "Louisiana"),
    MA("MA", "Massachusetts"),
    MD("MD", "Maryland"),
    ME("ME", "Maine"),
    MI("MI", "Michigan"),
    MN("MN", "Minnesota"),
    MO("MO", "Missouri"),
    MS("MS", "Mississippi"),
    MT("MT", "Montana"),
    NC("NC", "NorthCarolina"),
    ND("ND", "NorthDakota"),
    NE("NE", "Nebraska"),
    NH("NH", "NewHampshire"),
    NJ("NJ", "NewJersey"),
    NM("NM", "NewMexico"),
    NV("NV", "Nevada"),
    NY("NY", "NewYork"),
    OH("OH", "Ohio"),
    OK("OK", "Oklahoma"),
    OR("OR", "Oregon"),
    PA("PA", "Pennsylvania"),
    RI("RI", "RhodeIsland"),
    SC("SC", "SouthCarolina"),
    SD("SD", "SouthDakota"),
    TN("TN", "Tennessee"),
    TX("TX", "Texas"),
    UT("UT", "Utah"),
    VA("VA", "Virginia"),
    VT("VT", "Vermont"),
    WA("WA", "Washington"),
    WI("WI", "Wisconsin"),
    WV("WV", "WestVirginia"),
    WY("WY", "Wyoming");

    private final String key;
    private final String value;

    State(String key, String value) {
        this.key = key;
        this.value = value;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-12T22:29:26.357

使用代码和值构建一个`Map<String, String>`，操作简单，数据很少。这没有“实用程序”，它对于您正在构建的应用程序非常具体。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-12T22:33:29.773

我认为最简单的方法是使用 HashMap。即使有一个库可以转换它，它也可能使用相同的东西。

```
Map<String, String> states = new HashMap<String, String>();
states.put("Arizona", "AZ");
states.put("California", "CA");
// So on and so forth...

// Then you could create a method like
public String toStateCode(String s) {
    return states.get(s);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-12T22:30:19.823

我不这么认为（至少我从未听说过）。但是您始终可以使用字典来完成此操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-28T03:48:45.470

这是 Kotlin 代码：

```
enum class State(val stateName: String) {
    AK("Alaska"),
    AL("Alabama"),
    AR("Arkansas"),
    AZ("Arizona"),
    CA("California"),
    CO("Colorado"),
    CT("Connecticut"),
    DE("Delaware"),
    FL("Florida"),
    GA("Georgia"),
    HI("Hawaii"),
    IA("Iowa"),
    ID("Idaho"),
    IL("Illinois"),
    IN("Indiana"),
    KS("Kansas"),
    KY("Kentucky"),
    LA("Louisiana"),
    MA("Massachusetts"),
    MD("Maryland"),
    ME("Maine"),
    MI("Michigan"),
    MN("Minnesota"),
    MO("Missouri"),
    MS("Mississippi"),
    MT("Montana"),
    NC("NorthCarolina"),
    ND("NorthDakota"),
    NE("Nebraska"),
    NH("NewHampshire"),
    NJ("NewJersey"),
    NM("NewMexico"),
    NV("Nevada"),
    NY("NewYork"),
    OH("Ohio"),
    OK("Oklahoma"),
    OR("Oregon"),
    PA("Pennsylvania"),
    RI("RhodeIsland"),
    SC("SouthCarolina"),
    SD("SouthDakota"),
    TN("Tennessee"),
    TX("Texas"),
    UT("Utah"),
    VA("Virginia"),
    VT("Vermont"),
    WA("Washington"),
    WI("Wisconsin"),
    WV("WestVirginia"),
    WY("Wyoming")
} 
```

将其用作：

```
val alaska = State.valueOf("AK").stateName
val virginia = State.VA.stateName 
```

# mysql - Propel - propel:build-sql - 能够添加 CREATE DATABASE .. 如果不存在

> ID：11005753
> 
> 赞同：0
> 
> 时间：2012-06-12T22:25:20.837
> 
> 标签：mysql, orm, propel

我正在自定义一个 phpUnderControl 构建文件，以使用该`symfony propel:build-sql`功能生成要为每个构建（不是每个测试）加载的 .sql 文件。我遇到的是生成的 .sql 文件期望数据库存在，但作为构建过程的一部分，我想删除并重新创建在 schema.yml 文件中找到的每个数据库，以确保一个干净的测试环境。

我的问题是，是否可以将 propel:build-sql 配置为就像我通过了 --add-drop-database [mysqldump 标志一样？](http://dev.mysql.com/doc/refman/5.5/en/mysqldump.html#option_mysqldump_add-drop-database)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T12:27:26.560

不，这是不可能的。在运行 symfony/propel 命令之前删除/创建数据库是你的工作。

# linux - 如何在 Linux 的终端中循环执行可执行命令？

> ID：11005756
> 
> 赞同：17
> 
> 时间：2012-06-12T22:25:28.593
> 
> 标签：linux, loops, file-io

让我先描述一下我的情况，我在一个 Linux 平台上工作，并且有一组`.bmp`文件，这些文件从`filename0022.bmp`最多`filename0680.bmp`. 所以一共有658张图片。我希望能够通过对图片进行操作的 .exe 文件运行这些图片中的每一个，然后将文件踢出到用户指定的文件中，它还有一些阈值参数：lower、upper。所以可执行文件的典型调用是：

```
./filter inputfile outputfile lower upper 
```

有没有一种方法可以让我仅从终端或通过创建某种 bash 脚本来循环调用所有文件？我的问题与此类似：[使用批处理文件对多个文件执行命令，](https://stackoverflow.com/questions/10740655/execute-a-command-over-multiple-files-with-a-batch-file)但这次我在 Linux 命令行终端中工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-13T15:28:29.273

您可能有兴趣研究 bash 脚本。

您可以直接从 shell 执行 for 循环中的命令。

一个简单的循环来生成您特别提到的数字。例如，从外壳：

```
user@machine $ for i in {22..680} ; do
> echo "filename${i}.bmp"
> done 
```

这将为您提供从`filename22.bmp`到的列表`filename680.bmp`。这只是处理您提到的范围的迭代。这不包括零填充数字。为此，您可以使用`printf`. `printf`语法`printf format argument`是. 我们可以使用`$i`上一个循环中的变量作为参数，并应用`%Wd`W 是宽度的格式。前缀 W 占位符将指定要使用的字符。例子：

```
user@machine $ for i in {22..680} ; do
> echo "filename$(printf '%04d' $i).bmp"
> done 
```

在上面`$()`充当变量，执行命令以获得与预定义值相反的值。

这现在应该为您提供您指定的文件名。我们可以把它应用到实际的应用程序中：

```
user@machine $ for i in {22..680} ; do
> ./filter "filename$(printf '%04d' $i).bmp" lower upper
> done 
```

这可以重写为一行：

```
user@machine $ for i in {22..680} ; do ./filter "filename$(printf '%04d' $i).bmp" lower upper ; done 
```

从问题中需要注意的一点是，.exe 文件通常以`COFF`linux 期望`ELF`格式可执行文件的格式编译。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-27T11:40:47.183

这是一个简单的例子：

```
for i in {1..100}; do echo "Hello Linux Terminal"; done 
```

追加到文件：（>>用于追加，也可以使用>覆盖）

```
for i in {1..100}; do echo "Hello Linux Terminal" >> file.txt; done 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-12T22:43:29.363

你可以试试这样的...

```
#! /bin/bash
for ((a=022; a <= 658 ; a++))
do
   printf "./filter filename%04d.bmp outputfile lower upper" $a | "sh"
done 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-15T09:59:33.233

您可以利用`xargs`迭代：

```
ls | xargs -i ./filter {} {}_out lower upper 
```

笔记：

*   {} 对应管道输出的一行，这里是输入文件名。
*   输出文件将使用后缀“_out”命名。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T22:32:42.983

你可以`AS-IS`在你的 shell 中测试它：

```
for i in *; do
    echo "$i" | tr '[:lower:]' '[:upper:]'
done 
```

如果您有特殊路径，`*`请通过您的路径 + a glob 进行更改：例如：

```
for i in /home/me/*.exe; do ... 
```

见[http://mywiki.wooledge.org/glob](http://mywiki.wooledge.org/glob)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T22:35:26.203

这同时添加输出图像的名称，例如`filtered_filename0055.bmp`

```
for i in *; do
    ./filter $i filtered_$i lower upper
done 
```

# entity-framework - 实体框架问题映射 - 两个映射片段

> ID：11005757
> 
> 赞同：2
> 
> 时间：2012-06-12T22:25:33.633
> 
> 标签：entity-framework

我正在使用 .net 4 和实体框架 4.x

我在 sql server 中有 3 个表。例如 Persons、PersonClasses 和 Classes

Persons 有 pk PersonId Classes 有 pk ClassId PersonClasses 有 PersonId fk 和 ClassId fk

添加到我的 EDMX 后，我收到以下错误。如何解决？

错误 3034：从第 691、768 行开始映射片段时出现问题：具有可能不同键的两个实体映射到同一行。确保这两个映射片段将 AssociationSet 的两端映射到相应的列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T11:20:00.447

我发现这个问题的唯一解决方案是从模型中删除所有实体并从数据库中更新模型。这对我有用。在您删除几张表并仅替换那几张表之后，设计器中可能无法正常工作。目前不确定。

# javascript - 日期选择器计算

> ID：11005759
> 
> 赞同：0
> 
> 时间：2012-06-12T22:25:39.590
> 
> 标签：javascript, calculated-field

我有以下代码来确保如果用户选择与会议的退房日期相同的入住日期，那么如果日期差异> 0，则“total_days”= 1 - 那么它应该再更新一天每一个人。即“会议日期 = 13.06.12”“会议日期结束 = 13.06.12” - 总天数 = 1 - 这是正确的。但是，如果“会议日期 = 13.06.12”和“会议日期结束 = 14.06.12”，那么“total_days”需要为 2，而不是 1。我做错了什么？我尝试了以下方法：

```
<td>Conference Date In</td>
    <td><input type="text" name="conference_date_in" id="conference_date_in" class="datepicker" /></td>
    <td>&nbsp;</td>
    <td>Conference Date Out</td>
    <td><input type="text" name="conference_date_out" id="conference_date_out" class="datepicker" /></td>
  </tr>
<td>Total Days</td>
    <td><input type="text" name="total_days" id="total_days" /></td>
  </tr>

<script type="text/javascript">

$(function() {
    $(".datepicker").datepicker({ minDate: -0, maxDate: "+100M +10D",dateFormat: 'dd-mm-yy'})
    ({
        changeMonth: true,
        changeYear: true,
    });
        });

var enquiry_date = $.datepicker.formatDate('dd-mm-yy', new Date());
document.getElementById('enquiry_date').value = enquiry_date;

var calcDate = function() {
    var start = $('#conference_date_in').datepicker('getDate');
    var end = $('#conference_date_out').datepicker('getDate');
    var days = (end - start) / 1000 / 60 / 60 / 24;

    if(days==0) {days=1
    }
    if( days >= 0 ) {
    document.getElementById('total_days').value = days;
    } 
        }

$('#conference_date_out').change(calcDate);
$('#conference_date_in').change(calcDate); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:12:40.297

发布这个屁股答案以关闭问题。

你不能在结果中加 1`(end - start) / 1000 / 60 / 60 / 24;`吗？你必须 if's not if..else 所以这应该可以解决你的问题。

# php - 允许用户使用通配符的安全性

> ID：11005760
> 
> 赞同：5
> 
> 时间：2012-06-12T22:26:09.090
> 
> 标签：php, mysql

我需要让我的用户在搜索中使用星号 (*) 作为通配符。

将星号转换为 % 并在 sql 查询中使用 LIKE 是否安全。

我知道用户正则表达式可能会导致需要永远计算的常规 epressions。我认为在这种情况下我不可能，但是这样做是否还有其他安全问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:34:01.207

表达式中的通配符`like`会导致查询执行发生变化，从而使 RDBMS 使用全表扫描而不是使用索引。当有大量数据时，这可能会减慢查询速度。我建议检查用户输入的第一个星号前是否存在至少一些非通配符。

另请注意，如果您转换`*`为`%`, 并使用`LIKE`，您也需要注意`_`，否则它将匹配任何单个字符，而不仅仅是下划线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T01:34:27.597

真正的问题是，让用户决定部分查询是否安全。

即使在简单的情况下，向数据库提供用户数据也是**不安全**的。

允许用户输入直接提供给数据库可能是危险的，但就您的过滤器和使用**数据库转义策略**而言（即：（`mysql_real_escape_string()`准备充分的语句或任何 ORM 将为您执行此操作）应该足够安全。

但是，它可能会导致性能问题，一个简单`EXPLAIN`的查询应该会警告您 RDBMS 引擎扫描了多少行。

实现此类功能的最佳方法是使用搜索引擎。（这不是你想要做的吗？）

有很多选择可以帮助您实现这一点。

你可以看看 Sphinx、Solr、Xapian 甚至 Lucene。都有很好的选择。

它们基本上允许您“索引”您的内容以进行全文搜索，同时提高性能。

它们还可以提供一些令人难以置信的功能，例如`OR`、`AND`、`LIKE`、`MINUS`等。比较器/运算符。

然后您可能会对这个问题感兴趣：[选择一个独立的全文搜索服务器：Sphinx 还是 SOLR？](https://stackoverflow.com/questions/1284083/choosing-a-stand-alone-full-text-search-server-sphinx-or-solr)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T01:21:26.617

如果您所做的只是像这样的简单替换

```
str_replace('*','%',$query) 
```

那么我没有预见到任何*安全*问题，我相信这是您所关心的。你不会打开任何 SQL 注入的可能性或任何东西（至少不会通过这种替换，如果你不逃避输入，你可能仍然有安全问题）。

但是，正如其他一些用户指出的那样，您将打开一些*性能*问题。如果我搜索 just 会发生什么`*`，我会拿回你的整个桌子吗？最好的方法（如果你不想使用[数据库搜索引擎](http://en.wikipedia.org/wiki/Database_search_engine)）是做一些用户验证。如果您想防止对查询进行全表扫描，最有可能的是，您需要限制用户只使用前导通配符或尾随通配符。

好的：

*   `*foo`
*   `bar*`

不太好：

*   `*foo*`
*   `ba*r`

这实际上取决于您拥有多少行以及您对用户提供实际输入的信任程度。

# java - 语法书写语言

> ID：11005764
> 
> 赞同：-1
> 
> 时间：2012-06-12T22:26:16.207
> 
> 标签：java, syntax

1.  我有一些必须验证的格式的文件。例如，一个。前 4 个字符是数字 b. 第一个单词从 0 开始。这是第 3 个和第 4 个字符的结果。

2.  这些规则因文件而异。也就是说，将来会写入一些具有不同规则的新文件。

3.  我打算用 xml 之类的语言编写这些规则/语法。我正在使用java进行编程。Java 应该读取语法文件并验证必要的文件。

4.  我的问题：是否有任何语言可以编写易于阅读和应用的自定义语法？- 我认为，xml 不适用于规则/语法编写语言

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:29:05.750

看看[ANTLR 解析器生成器](http://www.antlr.org/)。您可以指定 ANTLR 为其生成解析器的语法。然后，您可以使用该解析器来解析输入文件。

当然，您必须拥有每种可识别文件格式的语法，以便您可以在运行时根据文件（扩展名？）选择要使用的解析器

# javascript - 将json从文件加载到对象中

> ID：11005767
> 
> 赞同：13
> 
> 时间：2012-06-12T22:27:06.617
> 
> 标签：javascript, jquery, json, object

努力将 json 从 URL 上的文件 (myData.json) 加载到对象中，以便我可以访问属性值。

-- 数据立即加载，我在应用程序中非常需要它。

-- 我将访问整个应用程序中的数据，而不仅仅是在数据加载后立即发生的一个功能的一部分。

-- 我已经确保我的文件中的数据是正确格式的 json。

按照 jquery API 上的示例，我不应该做一些简单的事情，比如：

警报（jqxhr.myProperty）；

并获得价值？*我在这里缺少什么步骤？*我试过运行 eval 和各种各样的东西，比如

var myObj=JSON.parse(jqxhr);

无济于事。

求求你了，谢谢你。

```
// Assign handlers immediately after making the request,
// and remember the jqxhr object for this request
var jqxhr = $.getJSON("example.json", function() {
  alert("success");
})
.success(function() { alert("second success"); })
.error(function() { alert("error"); })
.complete(function() { alert("complete"); });

// perform other work here ...

// Set another completion function for the request above
jqxhr.complete(function(){ alert("second complete"); }); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-12T22:30:44.237

我认为你让它太复杂了:)

```
 var JSON;

 $.getJSON('example.json', function(response){
       JSON = response;
       alert(JSON.property);
 })
 //feel free to use chained handlers, or even make custom events out of them!
 .success(function() { alert("second success"); })
 .error(function() { alert("error"); })
 .complete(function() { alert("complete"); }); 
```

getJSON 函数会自动将您的响应转换为正确的 JSON 对象。无需解析。

您提到您正在到处使用这些数据，因此您必须等待 ajax 调用完成才能访问数据。这意味着要么将整个应用程序包装在`getJSON`回调中。或者使用自定义事件来确定：

```
 var JSON;

 $(window).on('JSONready', function(){
       alert(JSON.property);
 });

 $.getJSON('example.json', function(response){
       JSON = response;
       $(window).trigger('JSONready');
 });

 $('#elem').on('click', function(){
       //event likely to take place after ajax call has transpired
       //it would still be better to assign this listener in a callback, 
       //but you can get away with not doing it, if you put in a catch
       if(JSON){
           alert(JSON.property);
       }          
 }); 
```

**编辑**

经过快速实时调试后，数据不可用的真正原因是：使用 JSON 的 javascript 位于一个文件中，包括执行调用的内联 javascript 的页面文档 NORTH。结果 JSON 不是一个全局变量，并且作用域阻止了它的使用。如果你真的需要一个全局变量，以便它可以与内联 JS 以及任何和所有包含的 js 文件一起使用，你可以这样做：

```
 (function(){
      var limitedScopeVariable = 25;
      window.globalScopeVariable = 30;
  })();

  $(function(){
       alert(globalScopeVariable); //works!
       alert(limitedScopeVariable); //fails!
  }); 
```

**编辑 2**

> 自 jQuery 3.0 起，回调函数有所不同：自 jQuery 3.0 起，jqXHR.success()、jqXHR.error() 和 jqXHR.complete() 回调方法被删除。您可以改用 jqXHR.done()、jqXHR.fail() 和 jqXHR.always()

来自@mario-lurig 的评论

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T22:33:31.367

json 数据被传递给 $.getJSON 的回调函数。所以这会起作用：

```
var jqxhr;

$.getJSON("example.json", function(data) {
  jqxhr = data;
});

// alert(jqxhr.property);
// caution: this won't work immediately on load, since the ajax call runs asynchronously and hasn't finished at that time

// it should be available at a later time, like a click event
$('a#something').click(function(){
     if(jqxhr){
          alert(jqxhr.property);
     }else{
          alert('getJSON not yet complete or failed');
     }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T22:33:37.057

我认为这将是您正在寻找的，您正在尝试访问从您的调用返回的数据，而不是调用者对象本身。在您的示例中， jqxhr 是处理 JSON 调用而不是数据的对象。所以，

```
$.getJSON("example.json", function(data) {
  yourDATA = data;
})

//Use your data here
alert(yourDATA.aProperty); 
```

[此页面](http://api.jquery.com/jQuery.getJSON/)上的第一个示例与我解释的类似。

# facebook - 授权 Web 应用连接到之前连接的第三方服务

> ID：11005772
> 
> 赞同：0
> 
> 时间：2012-06-12T22:27:54.643
> 
> 标签：facebook, oauth

我们的仪表板网络应用程序包含来自多个第三方会员网站的 API 提要。当我们加入新用户时，我们希望使用 FB Connect 和 OAuth

1.  验证用户身份
2.  授予我们的应用程序访问 FB 图形数据的权限，以及
3.  确定用户之前是否已批准我们纳入的某些第​​三方服务。

我们希望用户能够授予我们代表用户连接这些服务的权限，所有这些都在一个 OAuth 会话中完成。这可能吗？

即，如果我们向 FB 提供我们连接到的服务列表，我们是否可以从 FB Connect 获得关于用户是否已使用 FB Connect 在其他地方预先批准这些服务的是/否？然后，我们会向用户提供一个辅助批准页面，说“看起来您已经登录到我们在仪表板中使用的这些 X、Y 和 Z 应用程序。您是否也想授予我们对这些应用程序的访问权限并将它们拉到您的仪表板中？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:09:56.890

不，这不是 Facebook API 的功能 - 您需要连续使用每个站点的 Oauth 流程

# php - 带有数据结构的 PHP 类定义

> ID：11005775
> 
> 赞同：-1
> 
> 时间：2012-06-12T22:28:01.023
> 
> 标签：php, oop, object

我想要做的是以下......在我的其他类之一中包含*类文件，然后执行以下操作：*

```
 $zSubscription = new zSubscription();
    $zSubscription->Account->AccountNumber = "ABCD-230948";
    $zSubscription->BillToContact->Address1= "123 Dirt Lane Road";
    $this->createContact($zSubscription);

public function createContact($subscriptionObj){
    if (strlen($subscriptionObj->Account->AccountNumber) > 10){
        // Do something special
        echo "Batch Processing<br />";
        if ($subscriptionObj->Account->Batch == "Batch1"){
            echo "Running Batch 1";
        }
    }
} 
```

BATCH1 应该被设置（这是预期的结果） 目前它没有被设置。

通过 require_once 包含的类文件如下：

```
/**
* Zuora Definition Class
* @author Will H
* @license MIT
*/

class Account{
    /** @var string */
    public $AccountNumber  = null;
    /** @var bool */
    public $AllowInvoiceEdit   = true;
    /** @var bool */
    public $AutoPay = true;
    /** @var string */
    public $Batch    = "Batch1";
    /** @var string */
    public $BcdSettingOption    = "ManualSet";
    /** @var int */
    public $BillCycleDay     = 31;
    /** @var string */
    public $CrmId;
    /** @var string */
    public $Currency = "USD";
    /** @var string */
    public $CustomerServiceRepName = "Online Order";
    /** @var string */
    public $Name;
    /** @var string */
    public $PaymentTerm = "Due Upon Receipt";
    /** @var string */
    public $PurchaseOrderNumber = null;
    /** @var string */
    public $SalesRepName = "Online Order";
}

class PaymentMethod{ 
    /** @var string */
    public $CreditCardAddress1;
    /** @var string */
    public $CreditCardAddress2;
    /** @var string */
    public $CreditCardCity;
    /** @var string */
    public $CreditCardCountry;
    /** @var int */
    public $CreditCardExpirationMonth;
    /** @var int */
    public $CreditCardExpirationYear;
    /** @var string */
    public $CreditCardHolderName;
    /** @var string */
    public $CreditCardNumber;
    /** @var string */
    public $CreditCardPostalCode;
    /** @var string */
    public $CreditCardState;
    /** @var string */
    public $CreditCardType;
    /** @var string */
    public $Type = 'CreditCard';
}
class BillToContact{

    /** @var string */
    public $Address1;
    /** @var string */
    public $Address2;
    /** @var string */
    public $City;
    /** @var string */
    public $Country;
    /** @var string */
    public $FirstName;
    /** @var string */
    public $LastName;
    /** @var string */
    public $PostalCode;
    /** @var string */
    public $State;
    /** @var string */
    public $WorkEmail;
    /** @var string */
    public $WorkPhone;

}
class SubscribeOptions{
    /** @var bool */
    public $GenerateInvoice = true;
    /** @var bool */
    public $ProcessPayments = true;
}

class Subscription{
    /** @var bool */
    public $AutoRenew = true;
    /** @var string */
    public $ContractAcceptanceDate;
    /** @var string */
    public $ContractEffectiveDate;
    /** @var int */
    public $InitialTerm = 12;
    /** @var int */
    public $RenewalTerm = 12;
    /** @var string */
    public $ServiceActivationDate;
    /** @var string */
    public $TermStartDate;
}
class RatePlan{
    /** @var string */
    public $ProductRatePlanId;
}
class RatePlanData{
    /** @var RatePlan */
    public $RatePlan;
}
class SubscriptionData{
    /** @var Subscription */
    public $Subscription;
    /** @var RatePlanData */
    public $RatePlanData;
}
class zSubscription{
    /** @var Account */
    public $Account;
    /** @var PaymentMethod */
    public $PaymentMethod;
    /** @var BillToContact */
    public $BillToContact;
    /** @var SubscribeOptions */
    public $SubscribeOptions;
    /** @var SubscriptionData */
    public $SubscriptionData;
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T10:04:10.817

说您的代码正在泄漏封装，这是轻描淡写的。根本没有封装。你可以用一个数组替换你的“对象”，然后就结束了。

在编写良好的课程中，您将只有`private`和`protected`变量。它们仅通过*Getters*和*Setters*可用，即使那样你也必须小心。您应该阅读这篇文章：[*Martin Fowler 的*](http://martinfowler.com/bliki/GetterEradicator.html)[“GetterEradicator”](http://martinfowler.com/bliki/GetterEradicator.html)*。*

 *您代码中的另一个问题是您似乎在构造函数中做了一些巫术。看看这个例子：

```
$zSubscription = new zSubscription();
$zSubscription->Account->AccountNumber = "ABCD-230948";
$zSubscription->BillToContact->Address1= "123 Dirt Lane Road"; 
```

`Account`和从何`BillToContact`而来？您将对象*（在`zSubscription::__construct()`方法 .. 中创建并因此导致与两个类的名称紧密耦合）*暴露给完全不相关的上下文。这是违反[得墨忒耳定律](http://c2.com/cgi/wiki?LawOfDemeter)，导致抽象泄漏。*

# jquery - 如何为复选框标签添加突出显示？

> ID：11005778
> 
> 赞同：1
> 
> 时间：2012-06-12T22:29:04.253
> 
> 标签：jquery, checkbox, label, syntax-highlighting

我有一个像下面这样的复选框，一旦单击该复选框，我想添加 font style="BACKGROUND-COLOR: yellow" 。我该怎么做？

```
<input type="checkbox" name = "checkbox" id="prime">
<label for="checkbox" name="checkboxlabel" id="primelabel">Checkbox</label> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T22:35:58.753

**HTML**

```
<input type="checkbox" name ="prime" id="prime">
<label for="prime" name="checkboxlabel" id="primelabel">Checkbox</label>​ 
```

**JS**

```
if($("#prime").is(":checked"))
    $('label[for="prime"]').addClass("highlight");

$("#prime").change(function() {
    $('label[for="' + this.id + '"]').toggleClass("highlight");
}); 
```

**CSS**

```
.highlight { background-color: yellow; }​ 
```

[演示](http://jsfiddle.net/YN9aK/3/)| 稍长但不太可能导致任何问题：[演示](http://jsfiddle.net/YN9aK/1/)

# r - ggplot2 geom_bar position = "dodge" 不闪避

> ID：11005782
> 
> 赞同：9
> 
> 时间：2012-06-12T22:29:21.837
> 
> 标签：r, ggplot2, bar-chart

我有下面的数据框 p3：

```
 test     result
    1      1    26.87778
    2      1    24.52598
    3      1    24.02202
    4      1    20.32632
    5      1    22.00618
    6      2    19.84013
    7      2    19.68983
    8      2    19.84013
    9      2    19.23892
    10     2    19.23892
    11     3    34.36430
    12     3    33.28196
    13     3    33.82313
    14     3    33.82313
    15     3    32.47020
    16     4    25.55169
    17     4    26.90442
    18     4    25.40138
    19     4    24.19895
    20     4    25.85230
    21     4    25.70199
    22     4    24.95047
    23     5    18.64646
    24     5    18.64646
    25     5    17.80653
    26     5    18.64646
    27     5    18.31049 
```

我正在尝试使用以下代码制作带有闪避结果的条形图：

```
 ggplot(p3, aes(x = test, y = result))+ geom_bar(position="dodge", stat="identity") 
```

但它根本不起作用。我不明白为什么它不起作用，因为我之前使用了相同的代码并且它起作用了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-12T22:48:07.427

```
ggplot(p3, aes(x = test, y = result, group = result)) + 
    geom_bar(position="dodge", stat="identity") 
```

如果将`group`参数更改为 ，您可以看到发生了什么`color`。

```
ggplot(p3, aes(x = test, y = result, color = result)) + 
    geom_bar(position="dodge", stat="identity") 
```

编辑评论：

看起来有奇数个组，因为有。在您提供的数据中，第 4 组有 7 个元素。第 3 组有 5 个，但其中 2 个是相同的。该图正确显示了高度，并将相似的元素组合在一起。`unique`就像你对每个小组都打电话一样。

我认为绘图：

```
ggplot(p3, aes(x=test, y=result, group=result, color=result)) + 
  geom_bar(position='dodge', stat='identity') 
```

很好地展示了这一点。至于每组有 5 个元素，情况并非如此。第 4 组有 7 个。要查看您所描述的内容，您可以执行以下操作：

```
ggplot(p3, aes(x=as.integer(row.names(p3)), y=result, fill=factor(test))) +   
  geom_bar(position='dodge', stat='identity') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T08:21:32.863

丹尼斯墨菲回答了这个问题：

```
p3$test <- factor(p3$test)
p3$fac <- factor(unlist(sapply(as.vector(table(p3$test)), seq_len)))
ggplot(p3, aes(x = test, y = result, fill = fac)) + 
      geom_bar(position = 'dodge', stat = 'identity') 
```

调整变量：

```
ggplot(p3, aes(x = test, y = result, color = fac, fill = test)) +
    geom_bar(position = 'dodge', stat = 'identity', linetype = 0) 
```

我几乎得到了我想要的，除了颜色（轮廓）应该是一样的。但它已经足够接近了。

# asp.net - ASP.NET Web Api：请求的资源不支持 http 方法“GET”

> ID：11005788
> 
> 赞同：99
> 
> 时间：2012-06-12T22:29:54.707
> 
> 标签：asp.net, asp.net-web-api

我对 ApiController 执行了以下操作：

```
public string Something()
{
    return "value";
} 
```

我已经将我的路线配置如下：

```
routes.MapHttpRoute(
    name: "DefaultApi",
    routeTemplate: "api/{controller}/{action}/{id}",
    defaults: new { id = RouteParameter.Optional }
); 
```

在测试版中，这工作得很好，但我刚刚更新到最新的候选发布版，现在我看到这样的调用错误：

> 请求的资源不支持 http 方法“GET”。

为什么这不再起作用了？

（我想我可以摆脱 {action} 并制作大量控制器，但这感觉很乱。）

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2012-06-12T23:52:29.590

如果您没有在控制器中的操作上配置任何 HttpMethod，则假定它只是 RC 中的 HttpPost。在 Beta 中，假定支持所有方法 - GET、PUT、POST 和 Delete。这是从 beta 到 RC 的一个小变化。您可以使用 [AcceptVerbs("GET", "POST")] 在您的操作中轻松装饰多个 httpmethod。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2012-07-20T22:56:44.340

以上所有信息都是正确的，我还想指出该`[AcceptVerbs()]`注释存在于 System.Web.Mvc 和 System.Web.Http 命名空间中。

如果它是 Web API 控制器，您想使用 System.Web.Http。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2014-01-29T10:49:10.227

尽管这不是对 OP 的回答，但由于完全不同的根本原因，我遇到了完全相同的错误；因此，以防万一这对其他人有帮助...

对我来说，问题是一个错误命名的方法参数，它导致 WebAPI 意外地路由请求。我的 ProgrammesController 中有以下方法：

```
[HttpGet]
public Programme GetProgrammeById(int id)
{
    ...
}

[HttpDelete]
public bool DeleteProgramme(int programmeId)
{
    ...
} 
```

对 .../api/programmes/3 的 DELETE 请求没有像我预期的那样路由到 DeleteProgramme，而是路由到 GetProgrammeById，因为 DeleteProgramme 没有参数名称 id。GetProgrammeById 然后当然拒绝 DELETE，因为它被标记为只接受 GET。

所以修复很简单：

```
[HttpDelete]
public bool DeleteProgramme(int id)
{
    ...
} 
```

一切都很好。确实是愚蠢的错误，但很难调试。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2014-06-24T10:08:26.687

如果您使用 装饰您的方法，请在控制器顶部`HttpGet`添加以下内容：`using`

```
using System.Web.Http; 
```

如果您正在使用`System.Web.Mvc`，则可能会出现此问题。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-06-28T22:43:57.397

这当然是从 Beta 到 RC 的变化。在问题中提供的示例中，您现在需要使用 [HttpGet] 或 [AcceptVerbs("GET")] 来装饰您的操作。

如果您想将基于动词的动作（即“GetSomething”、“PostSomething”）与非基于动词的动作混合使用，则会出现问题。如果您尝试使用上述属性，它将导致与控制器中任何基于动词的操作发生冲突。解决这个问题的一种方法是为每个动词定义单独的路由，并将默认操作设置为动词的名称。此方法可用于在 API 中定义子资源。例如，以下代码支持：“/resource/id/children”，其中 id 和 children 是可选的。

```
 context.Routes.MapHttpRoute(
           name: "Api_Get",
           routeTemplate: "{controller}/{id}/{action}",
           defaults: new { id = RouteParameter.Optional, action = "Get" },
           constraints: new { httpMethod = new HttpMethodConstraint("GET") }
        );

        context.Routes.MapHttpRoute(
           name: "Api_Post",
           routeTemplate: "{controller}/{id}/{action}",
           defaults: new { id = RouteParameter.Optional, action = "Post" },
           constraints: new { httpMethod = new HttpMethodConstraint("POST") }
        ); 
```

希望未来的 Web API 版本能够更好地支持这种情况。当前在 aspnetwebstack codeplex 项目 [http://aspnetwebstack.codeplex.com/workitem/184](http://aspnetwebstack.codeplex.com/workitem/184)上记录了一个问题。如果这是您希望看到的内容，请对该问题进行投票。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-07-19T10:20:03.153

具有与 OP 相同的设置。一个控制器有很多动作......不那么“凌乱” :-)

就我而言，我在添加新操作时忘记了“[HttpGet]”。

```
[HttpGet]
public IEnumerable<string> TestApiCall()
{
    return new string[] { "aa", "bb" };
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-04-27T16:34:16.180

与上述相同的问题，但根源大不相同。对我来说，这是我使用 https 重写规则到达了一个端点。在 http 上点击它会导致错误，与 https 一样可以正常工作。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-05-20T15:47:33.593

替换此路径中的以下代码

小路 ：

App_Start => WebApiConfig.cs

代码：

```
config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{action}/{id}/{Param}",
            defaults: new { id = RouteParameter.Optional,
                            Param = RouteParameter.Optional }
                          ); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-10-11T12:54:14.940

我不知道这是否与 OP 的帖子有关，但我错过了 [HttpGet] 注释，这就是导致错误的原因，正如@dinesh_ravva 所述，默认情况下假定方法是 HttpPost。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-09T23:16:38.317

我的问题很简单，就像返回的消息中没有显示空引用一样，我必须调试我的 API 才能看到它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-17T22:21:03.433

在没有 SSL 的情况下运行查询时出现此错误。

只需将我的请求的 URL 方案从 HTTP 更改为 HTTPS 即可修复它。

# java - 我如何在这个 java 项目中使用 maven

> ID：11005790
> 
> 赞同：0
> 
> 时间：2012-06-12T22:30:00.633
> 
> 标签：java, maven

[![文件夹](../Images/8837476fe3cbace154b6a4ffdab44c6e.png)](https://i.stack.imgur.com/WsN6M.png)
[（来源：[gyazo.com](http://gyazo.com/96d7e528c86d0dd1d3e995bba27332c9.png)）]

maven 网站上的基础教程只展示了如何从头开始制作一个新项目。我对在现有项目中使用 Maven 感到困惑

我只想将 .java 文件编译到 bin 中，而不是将它们打包到 jar 中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:33:18.523

如果你设置了默认的 maven 配置，编译后的 .class 文件将放在 target/classes 中。

注意：确保您的项目具有正确的布局，以便 maven 工作（无需额外的麻烦）：

```
project root
  - pom.xml
  - src
    - main
      - java
        - <.java classes and directories for packages> 
```

# java - eclipse错误导出插件

> ID：11005794
> 
> 赞同：17
> 
> 时间：2012-06-12T22:30:32.257
> 
> 标签：java, eclipse, eclipse-plugin, imp

尝试从 Eclipse 导出 IMP 插件时遇到一个奇怪的错误。使用 eclipse indigo 时，我得到：

```
C:\Users\Shachar\workspace jee\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86.xml:88: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86.xml:103: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86.xml:26: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\ide\build.xml:293: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\ide\build.xml:368: Problem: failed to create task or type apitooling.apigeneration
Cause: The name is undefined.
Action: Check the spelling.
Action: Check that any custom tasks/types have been declared.
Action: Check that any <presetdef>/<macrodef> declarations have taken place.

The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86.xml:103: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\.metadata\.plugins\org.eclipse.pde.core\temp\org.eclipse.pde.container.feature\assemble.org.eclipse.pde.container.feature.win32.win32.x86.xml:26: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\ide\build.xml:293: The following error occurred while executing this line:
C:\Users\Shachar\workspace jee\ide\build.xml:368: Problem: failed to create task or type apitooling.apigeneration
Cause: The name is undefined.
Action: Check the spelling.
Action: Check that any custom tasks/types have been declared.
Action: Check that any <presetdef>/<macrodef> declarations have taken place. 
```

当我使用 eclipse indigo rcp & rap 版本时出现同样的错误。

出于同样的原因，我无法为插件创建更新站点。

在 eclipse jee 版本中似乎不会发生此错误。虽然导出成功，但插件本身不起作用（当我运行项目时它确实起作用）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-17T16:44:20.853

我遇到过同样的问题。重新安装“Eclipse Plug-in Development Environment”插件最终为我修复了它。

# javascript - 在 javascript 中访问对象变量

> ID：11005804
> 
> 赞同：0
> 
> 时间：2012-06-12T22:31:52.207
> 
> 标签：javascript, html, canvas

所以，我刚开始使用javascript，一切都很好，直到我找到对象。这种代码和平应该使用javascript在html画布中创建一个弹跳球，但它不起作用。

```
 var canvas = document.getElementById("myCanvas");
  var ctx = canvas.getContext("2d");

//clear

function clear() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
} 
```

这是我的球对象

```
//ball

var ball = {

x: canvas.width / 2,
getX: function() {
    return this.x;
},
setX: function(a) {
    this.x = a;
},

y: canvas.height / 2,
getY: function() {
    return this.y;
},
setY: function(a) {
    this.y = a;
},

mx: 2,
getMx: function() {
    return this.mx;
},
setMx: function(a) {
    this.my = a;
},
my: 4,

getMy: function() {
    return this.my;
},

setMy: function(a) {
    this.my = a;
},
r: 10,
getR: function() {
    return this.r;
} 
```

};

绘制我的球的代码

```
function drawBall()
{
    ctx.beginPath();
    ctx.arc(ball.getX, ball.getY, ball.getR, 0, Math.PI * 2, true);
    ctx.fillStyle = "#83F52C";
    ctx.fill();

}

function circle(x, y, r) {
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2, true);
    ctx.fillStyle = "#83F52C";
    ctx.fill();
}
//draws ball and updates x,y cords 
function draw() {
    clear();
    drawBall();
    if (ball.getX() + ball.getMx() >= canvas.width || ball.getX()+ ball.getMx() <= 0) {
        ball.setMx(-ball.getMx());
    }
    if (ball.getY() + ball.getMy() >= canvas.height|| ball.getY()+ ball.getMy() <= 0) {
        ball.setMy(-ball.getMy());
    }

    ball.setX(ball.getX() + ball.getMx());
    ball.setY(ball.getY() + ball.getMy());

} 
```

设置间隔

```
function init() {
    return setInterval(draw, 10);
}

init(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:35:38.900

用于`this`引用调用方法的对象的属性。

```
var ball = {

    x: canvas.width / 2,
    getX: function() {
        return this.x;
    },
    setX: function(a) {
        this.x = a;
    },

    y: canvas.height / 2,
    getY: function() {
        return this.y;
    },
    setY: function(a) {
        this.y = a;
    },

    mx: 2,
    getMx: function() {
        return this.mx;
    },
    my: 4,
    getMy: function() {
        return this.my;
    },
    r: 10,
    getR: function() {
        return this.r;
    }
}; 
```

此外，要调用方法，您需要使用`()`.

```
ctx.arc(ball.getX(), ball.getY(), ball.getR(), 0, Math.PI * 2, true); 
```

否则，您将传递方法而不是调用方法的结果。

# php - 基于 PHP 的网站如何为网站的不同版本提供服务？

> ID：11005805
> 
> 赞同：0
> 
> 时间：2012-06-12T22:31:57.313
> 
> 标签：php

如果我有一个专为桌面 Web 使用而设计的网站，但我想创建一个面向移动设计的版本，我将如何在不维护两个具有非常相似逻辑的页面版本的情况下显示它。

我不能只为移动版本使用不同的 CSS，因为我计划提供不同的 HTML 结构，有没有比在每个页面中使用大量 if 语句更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T23:14:49.343

您将有两个版本的站点，一个用于桌面，另一个用于移动设备。然后根据`$_SERVER['HTTP_USER_AGENT']`您重定向用户。

例如：

```
<?php

// Let's define a function to make it easier to read
function is_mobile(){
 $list = array('Android', 'Iphone'); // Add more yourself

 foreach ($mobile as $agent) {
    if (stripos($agent, $_SERVER['HTTP_USER_AGENT']) {
        // Looks like mobile
        return true; 
      }
  }
  // Assuming desktop by default
  return false;
}

// Then before rendering a template, you'd it approach like this:
if (is_mobile()) {
   require 'mobile.php';
} else {
  require 'desktop.php';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:39:01.633

一个想法是实现一个模板系统，如 Smarty 或 Zend View（那里有很多）。从您的主站点，您的控制器代码将为您执行所有逻辑并将值分配给模板变量。然后根据用于查看您的站点的版本（桌面/移动），加载适当的模板文件。这些可能有非常不同的 HTML/CSS 规则和结构，但在渲染视图之前仍然使用相同的 PHP 逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T22:43:55.697

我使用如下示例的代码来确定用户是否是移动用户以重定向到网站的移动版本。该站点使用相同的模型和控制器文件，但使用不同的视图文件。

```
if (preg_match('/(up.browser|up.link|mmp|symbian|smartphone|midp|wap|phone|android)/i', strtolower($_SERVER['HTTP_USER_AGENT']))
    or strpos(strtolower($_SERVER['HTTP_ACCEPT']),'application/vnd.wap.xhtml+xml') > 0 
    or ((isset($_SERVER['HTTP_X_WAP_PROFILE']) or isset($_SERVER['HTTP_PROFILE'])))
)
{
    header('location: /m/index.php');
    exit();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T22:39:33.627

> 有没有比在每个页面中使用大量 if 语句更好的方法？

是的，有一个更好的方法。不幸的是，如果您在设计网站时考虑到这一点，会容易得多。您可以做的是使用模板引擎将您的 PHP 代码和实际内容完全分开。因此，如果您想更改/添加一些新的客户端页面，这将非常简单。您只需将内容添加到您的模板中。您还可以根据用户的用户代理字符串（包括操作系统信息）选择要加载的模板。PHP 本身只负责从您的数据库/文件/获取动态数据的任何地方获取数据。

看看现有的许多[PHP 模板引擎](http://www.webresourcesdepot.com/19-promising-php-template-engines/)。

# python - 如何将数组保存到文件

> ID：11005809
> 
> 赞同：1
> 
> 时间：2012-06-12T22:32:08.247
> 
> 标签：python, arrays, save

我想知道如何将数组保存到文件中。你已经帮了我很多，但我有更天真的问题（我是 Python 新手）：

```
@<TRIPOS>MOLECULE 
NAME123 
line3 
line4 
line5 
line6 
@<TRIPOS>MOLECULE 
NAME434543 
line3 
line4 
line5 
@<TRIPOS>MOLECULE 
NAME343566 
line3 
line4 
```

我目前有这个代码，但它只保存数组中的**最后一项**`items_grep`，而不是. 如何解决这个问题？

```
items = []
with open("test.txt", mode="r") as itemfile: 
    for line in itemfile: 
        if line.startswith("@<TRIPOS>MOLECULE"): 
            items.append([]) 
            items[-1].append(line) 
        else: 
            items[-1].append(line)      
#
# list to grep
items_grep = open("list.txt", mode="r").readlines()
# writing files
for i in items:
    if i[1] in items_grep:
        open("grep.txt", mode="w").write("".join(i)) 
```

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:37:37.820

您的文件只显示最后一个值的原因是因为每次您打开带有`w`标志的文件时，它都会删除现有文件。如果你打开它一次然后使用文件对象，你会没事的，所以你会这样做（注意，这不是一个非常干净/pythonic 的方式，只是清楚 open 命令是如何工作的）

```
myfile = open("grep.txt", "w")
for i in ...
    if i[1] ...:
         myfile.write(i + '\n') 
```

处理这个问题的简单方法是先做一个列表理解然后加入，例如：

```
newstr = '\n'.join([''.join(i) for i in items if i[1] in items_grep]) 
```

然后一次将整个字符串写入文件。请注意，如果不添加`\n`项目之间的内容，您最终不会将每个项目都放在新行上，而是将它们都一个接一个地添加，没有空格。

您还应该考虑使用`with`关键字自动关闭文件。

```
with open("grep.txt","w") as f:
    f.write(newstr) 
```

# git - Git将文件夹放入文件夹中 - 在存储库中

> ID：11005813
> 
> 赞同：1
> 
> 时间：2012-06-12T22:32:22.240
> 
> 标签：git, github, repository, directory

所以，我对整个 GitHub 的事情还是很陌生。因此，我的回购看起来像一堆乱七八糟的狗屎。无论如何，我想花一点力气来清理它，所以我把它拉下来，将文件夹系统更新到我想要的样子，然后把它推回来。无论如何，新文件夹都显示在那里，里面有子文件夹。但是，子文件夹仍显示在我的存储库中。我宁愿它们在这些文件夹中，这样我可以更好地组织它。有没有办法做到这一点，有人介意带我走过吗？

提前为帮助喝彩。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T06:49:33.707

还在学习SOF。认为这将结束我的问题，因为它已在 uDaY 的感谢下得到解决。

原始问题：我的远程仓库中的文件夹目录与我的本地仓库不同。推送不会正确更新。

解决方案：最后我删除了我的远程仓库并重新推送了我的本地仓库。这将文件夹目录更正为我的本地存储库的目录并解决了问题。我的回购现在很好很漂亮，谢谢你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T07:55:15.320

正如@Healsgood 上面解释的问题。

**最简单的解决方案：**

由于本地 repo 是所需的形式，并且是最新的，还有其他更改。首先删除远程仓库（当前），创建一个与本地同名的新远程仓库，并将更改**推送**（`git push`）到远程。您将拥有相同/所需版本的远程仓库。

干杯！！

# python - 我怎样才能反向追加？Python

> ID：11005814
> 
> 赞同：5
> 
> 时间：2012-06-12T22:32:22.577
> 
> 标签：python

`.append` 函数将元素添加到列表中。如何将元素添加到列表中？相反？那么索引零是新值，旧值在索引中向上移动？什么附加

```
[a,b,c,d,e] 
```

我想要什么。

```
[e,d,c,b,a] 
```

非常感谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-12T22:52:23.273

假设你有一个列表`a`，`a = [1, 2, 3]`

现在假设您想知道可以对该列表执行哪些操作：

```
dir(a) 
```

嗯……想知道这个`insert`东西是做什么的……

```
help(a.insert) 
```

在索引之前插入对象，你说？为什么，这听起来很像我想做的事！如果我想在列表的开头插入一些东西，那就是*在*索引 0 之前。我想插入什么对象？让我们试试 7...

```
a.insert(0, 7)
print a 
```

好吧，看看列表前面的那 7 个！

TL;DR：`dir()`将让您查看可用的功能，`help()`向您展示它是如何工作的，然后您可以使用它并查看它的作用，或者谷歌搜索一些文档，因为您现在知道您想要的功能被称为什么。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-12T22:58:43.270

[`deque`](http://docs.python.org/library/collections.html#collections.deque)为此使用（双端队列）会更有效。在索引 0 处插入在列表中的成本非常高，因为每个元素都必须移动，这需要 O(N) 的运行时间，在`deque`相同的操作中是 O(1)。

```
>>> from collections import deque
>>> x = deque()
>>> x.appendleft('a')
>>> x.appendleft('b')
>>> x
deque(['b', 'a']) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-12T22:34:07.743

用于`somelist.insert(0, item)`放置`item`在 的开头`somelist`，将所有其他元素向下移动。请注意，对于大型列表，这是一项*非常昂贵*的操作。如果您要在序列的两端添加或删除项目，请考虑使用[deque 。](http://docs.python.org/library/collections.html#deque-objects)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-12T22:34:01.557

使用 Python 的 list`insert`命令和 0 作为位置值将在列表的头部插入值，因此以相反的顺序插入：

```
your_list.insert(0, new_item) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-12T22:50:32.473

你可以做

```
your_list=['New item!!']+your_list 
```

但是插入方法也有效。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-03T06:27:55.443

```
lst=["a","b","c","d","e","f"]
lst_rev=[]
lst_rev.append(lst[::-1])
print(lst_rev) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-02-06T15:21:43.830

这是一个如何以相反顺序在列表中添加元素的示例：

```
liste1 = [1,2,3,4,5]
liste2 = list()
for i in liste1:
    liste2.insert(0,i) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-07-10T13:52:38.960

使用以下内容（假设 x 是您要添加的内容）：

```
your_list = [x] + your_list 
```

或者：

```
your_list.insert(0, x) 
```

# sql-server-2008 - 如何确保不会将相同的值插入数据库？

> ID：11005817
> 
> 赞同：0
> 
> 时间：2012-06-12T22:32:30.883
> 
> 标签：sql-server-2008, constraints

我有一个 PK = BookId 和另一个非键 - BookName 的表。我能否确保用户不会在数据库级别再次将同一本书添加到数据库中。还是我必须在应用程序级别进行？

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:55:19.127

我更喜欢将其添加为约束而不是唯一索引，即使它们在幕后实现相同。约束正确地暗示了意图（防止重复），而索引对许多人暗示它是出于性能原因而创建的。

```
ALTER TABLE dbo.Books ADD CONSTRAINT UQ_BookName
  UNIQUE (BookName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:37:53.343

你可以使用一个`Unique Index`

```
CREATE UNIQUE NONCLUSTERED INDEX <idx_name> ON <table_name> (column1, column2) 
```

假设您的表名为 Books，您可以使用

```
CREATE UNIQUE NONCLUSTERED INDEX IDX_IdAndName_Unique ON [dbo].[Books] (BookId, BookName) 
```

# html - 强制 FireFox 像 Chrome 一样渲染？

> ID：11005818
> 
> 赞同：0
> 
> 时间：2012-06-12T22:32:31.130
> 
> 标签：html

是否有一个属性或标签会强制 FF 在没有插件的情况下像 chrome 一样呈现？或者可能将其强制转换为另一个 FF 版本，例如 IE 你可以`<meta http-equiv="X-UA-Compatible" content="IE=7" />`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T22:34:48.713

不，那是不可能的。Firefox 不是旧版本的 Chrome 或任何东西 - 它是具有不同渲染引擎的不同浏览器。

这有点像询问您是否可以强制 Internet Explorer 3 像 Mobile Safari 一样呈现。没有发生。

# c++ - 命名循环成语：危险？

> ID：11005822
> 
> 赞同：15
> 
> 时间：2012-06-12T22:32:59.353
> 
> 标签：c++, c

我读过一篇关于 C++ 中“命名循环成语”的文章：[http ://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Named_Loop](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Named_Loop)

这个成语允许我们这样写：

```
named(outer) 
for(int i = 0 ; i < rows ; ++i) {

   named(inner) 
   for(int j = 0 ; j < cols ; ++j) {

        if(some_condition)
            break(outer);   // exit the 'outer' loop 

   }
} 
```

这种结构已经作为许多语言的核心特性存在，例如 Java。

根据文章，它可以通过定义两个邪恶的宏在 C++ 中实现：

```
#define named(blockname) goto blockname; \
                         blockname##_skip: if (0) \
                         blockname:

#define break(blockname) goto blockname##_skip; 
```

我知道很多人想禁止使用`goto`. 我个人发现它在极少数情况下很有用，尤其是当我想要`break`一堆嵌套循环时。在我看来，这个成语是一个更干净的解决方案，但是可以在实际代码中使用它吗？

在文章的讨论页面上，可以阅读：

> “不要这样做。你会下地狱的”

所以我的问题是：**使用命名循环习语有什么缺点？危险吗 ？如果是，为什么？**

*额外的问题：是否可以实现`continue`类似的命名？（我认为使用语法是不可能的`named(...) for(...;...;...) {}`，但谁知道呢？）*

编辑：我同意你的看法，重新定义关键字很讨厌。用什么`#define breakLoop()`代替呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T23:01:55.280

正如评论中所述，#defining`break`是有问题的。假设您使用其他东西。

我仍然认为这是危险的。这是一个非常不寻常的习语（对 C++ 程序员而言），因此他们不太可能理解，因此他们可能会做出重大更改。鉴于完成同一件事的方式不那么令人惊讶，因此也不那么危险，我建议不要这样做。

考虑将循环放在函数或 lambda 中。然后你可以`return`打破外循环。作为一个好处，您可以返回有关过早退出的信息，这可能对外部代码有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T23:00:29.700

我发现这有几个问题。

首先，您要定义一个与语言的保留字之一同名的宏。即使您的编译器对此没有抱怨，它也很容易出错并且不会（至少在 IMO）很危险。

其次，我总是对以编程方式创建标签犹豫不决。即使您的编译器可能会抱怨如果您不小心在同一范围内创建了两个具有相同名称的标签，但如果程序员不剖析这些宏（这部分违背了额外抽象的目的），它生成的错误消息可能不会很容易理解.

可能我的主要问题是宏引入了一些与普通语言语法不同的东西。这些`named(...)`行不以分号结尾，也不是后面跟着一个`{ ... }`块。添加任何类型的新语法都会为开发人员的困惑和意外误用打开大门。

总的来说，我有点喜欢命名循环的想法，但这不是您想要使用宏创建的那种东西。这是一种真正需要由语言本身提供的机制。使用 C 或 C++ 时，使用手动创建的标签和`goto`. 明确的几乎总是比隐藏宏背后发生的事情要好。

# ruby - 如何将参数传递给 MiniTest::Unit::TestCase 套件？

> ID：11005828
> 
> 赞同：2
> 
> 时间：2012-06-12T22:33:26.170
> 
> 标签：ruby, rake, minitest

我正在使用一个带有密钥字符串的外部 API，并希望将此密钥字符串传递给测试套件。就像是：

```
rake test [key=api_key] 
```

代码和测试将是开源的，但我不能将我的密钥字符串分发给其他用户，所以我不能把它放在测试文件中。我可以将它作为参数传递吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:43:56.317

你有两个选择。将其作为环境变量传递：

```
API_KEY='key' rake test 
```

然后，您可以通过测试中的 ENV 对象访问它：

```
key = ENV['API_KEY'] 
```

第二种选择是将这个密钥放在一个文件中（例如 key.txt），然后从中读取它。为确保您不会将该文件与您的代码一起分发，请将其添加到您的 .gitignore 文件（或 SCM 使用的任何忽略文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T02:06:07.790

非常感谢！

我实际上正在考虑将它放入一个文件并 gitignoring 它，但最终将一个参数传递给 rake。可能是，我将两者结合起来（这是一个长键）。

1.  修改 :test 任务的 Rakefile 代码，例如为其添加参数。

    > ```
    > task :test, :key do |t, k|
    >   result = system("ruby -Ilib -Itest -e 'ARGV.each { |f| load(f) if File.exists?(f)}' test/unit/* '#{k[:key]}'")
    >   exit(result ? 0 : 1)
    > end 
    > ```

2.  调用 rake test['blah-blah']

如果需要，它可能需要不止一把钥匙。

# php - PHP 不适用于 shell_exec()、system() 或 passthru()

> ID：11005831
> 
> 赞同：3
> 
> 时间：2012-06-12T22:33:36.467
> 
> 标签：php, command-line, wamp

我正在尝试从文件夹中读取最新的文件。找到最新文件后，我正在逐行读取并使用条形码套印软件在条形码打印机上打印。此条码打印机是我服务器上的默认打印机。

这是我的PHP代码：

```
<?php
    $files = glob('C:\barcode\*.*');
    $files = array_combine($files, array_map('filectime', $files));
    arsort($files);
    echo key($files);  // for testing

    $handle = @fopen(key($files), "r");
    if ($handle) {
         while (($buffer = fgets($handle, 4096)) !== false) {
             echo $buffer; // for testing
              $retval=passthru("BarcodeGenerator.exe ".$buffer.",,Code128,0");
// based on http://www.free-barcode.com/CommandLineBarcode.htm
            echo $retval;
         }
            if (!feof($handle)) {
                echo "Error:\n";
         }
         fclose($handle);
    }
    ?> 
```

上面的命令行在我的命令行提示符下运行良好，但在 php 脚本中却没有。程序挂起。什么都没发生。如果我评论 passthru 行，一切都很好。程序执行。

这是我迄今为止尝试过的：

*   检查 PHP 是否在安全模式下运行。它不是。
*   关闭 Windows 防火墙。
*   我已经运行了命令`calcs /g BarcodeGenerator.exe everyone:F`
*   我已将可执行文件和相关文件复制到 wamp\www 文件夹。上面的代码（坏主意，但我还是这样做了）并重新计算。
*   我已将 UAC 设置更改为最低
*   我的系统上当前没有运行任何防病毒软件。
*   我也试过`system()`了`shell_exec()``exec()`
*   我试过打开安全模式并将上面的目录放在`safe_mode_include_dir`
*   我尝试用`"`单引号 ( ) 替换双引号 ( `'`)。
*   我试过给出完整路径（`C:\\wamp\\www\\`）

这些命令在命令提示符下运行良好。

那么，有没有办法`shell_exec`在 PHP 下以管理员身份运行命令呢？它似乎根本不想运行可执行文件（不仅是这个）。我正在`WAMP`运行`Windows 7`。

例如，`shell_exec('dir')`工作正常，但`shell_exec('java')`没有。为什么不？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:53:49.057

由于您无法运行任何可执行文件，例如 Java，这绝对是权限问题。该解决方案虽然出于安全原因不推荐用于生产服务器，但以管理员身份运行您的 WAMP 服务器。

有关如何执行此操作的详细信息，请参阅[此链接。](http://forum.wampserver.com/read.php?2,61302,71833)

# algorithm - 返回数组中重复数字序列的索引

> ID：11005835
> 
> 赞同：0
> 
> 时间：2012-06-12T22:34:00.770
> 
> 标签：algorithm

给定一个数组：

```
array = [16 16 16 22 23 23 23 25 52 52 52] 
```

我想返回一个指向三个重复数字元素的索引列表。在这种情况下，这将是：

```
indices = find_sequence(nbr_repeats = 3)
print indices
 [0 1 2  4 5 6  8 9 10] 
```

为了实现而使用的最快和最优雅的算法是`find_sequence`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T23:11:19.740

我所知道的最简单的方法……记录你第一次看到数字的地方。继续直到你找到一个不同的数字，然后如果序列足够长，将所有数字从序列的开头添加到结尾之前。

（当然，在检查完元素后，您还必须检查序列长度。我通过迭代一个结束并在最后一次迭代中跳过元素检查来做到这一点。）

```
To find_repeats (input : list, minimum : integer):
    start := 0
    result := []
    for each x from 0 to (input length):
        ' "*or*" here is a short-circuit or
        ' so we don't go checking an element that doesn't exist
        if x == (input length) *or* array[x] != array[start]:
            if (x - start) >= minimum:
                append [start...(x - 1)] to result
            start := x
    return result 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T23:07:20.320

基于OP的假设：

1.  列表已排序
2.  最大频率是`nbr_repeats`

这可能有效：

```
def find_sequence(nbr_repeats, l):
    res = []
    current = -1
    count = 0
    idx = 0
    for i in l:
        if i == current:
            count += 1
            if count == nbr_repeats:
                for k in reversed(range(nbr_repeats)):
                    res.append(idx-k)
        else:
            current = i
            count = 1
        idx += 1
    return res 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T00:17:44.840

[这在我看来像是Boyer-Moore 字符串搜索算法](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)的一个特例，并且由于您使用的任何语言都将包含字符串搜索的优化，也许最优雅的答案是将您的数据视为字符数组（即字符串）和使用您的语言的内置字符串搜索功能...请注意，这仅适用于您的数字适合您的语言支持的字符集（例如，ASCII 中没有大于 128 的数字）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T22:41:29.083

由于您没有指定语言，因此这是一个伪代码：

```
find_sequence(array: array of int, nbr_repeats: int) : array of int
  retVal = emty array of int // the return'd array
  last = empty array of int  // collection of last seen same elements
  i = -1
  for each element e in array
    ++i
    if (isempty(last))
      add(last, e)   // just starting
    else if (count(last, e) >= nbr_repeats)
      add(retVal, i-nbr_repeats) // found an index
    else if (e == first(last))
      add(last, e)   // we have encountered this element before
    else
      if (count(last, e) >= nbr_repeats)
        for (j=nbr_repeats-1; j>0; --j)
          add(retVal, i-j) // catching up to i with indices
      last = [e]     // new element

    if (count(last, e) >= nbr_repeats)
      for (j=nbr_repeats-1; j>0; --j)
        add(retVal, i-j) // handle end of array properly

  return retVal 
```

编辑：删除了关于排序的评论，因为它会破坏原始索引。

注意：您也可以只保留最后一个元素及其所见计数，而不是维护最后一个相同元素的列表

# coldfusion - Windows 7 上的 ColdFusion 8 应用服务器/Apache2.2

> ID：11005839
> 
> 赞同：2
> 
> 时间：2012-06-12T22:34:05.593
> 
> 标签：coldfusion

我已经设置 Eclipse Indigo 通过端口 80 使用 CFEclipse 进行线路调试（我也在 CF Admin 中进行了更改以匹配）。现在，当我转到服务并重新启动 ColdFusion 8 服务时，它崩溃了。

我做了一些研究，发现这是因为 Apache 2.2 正在使用端口 80。所以我停止了 Apache2.2 服务并启动了 ColdFusion 8 服务，这样我就可以进入 CF Admin 并将端口更改为其他内容。问题是 CF Admin 将不再加载，即使 ColdFusion 8 服务正在运行。

任何人都知道我需要做什么才能让 CF Admin 工作，以便我可以进入并更改端口，这样就不会再发生这种情况了？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T00:22:27.337

在 cfusion9/lib 目录（或您的实例的 lib 所在的任何位置）中查找 neo-debug.xml 文件。找到“LINE_DEBUGGER_ENABLED”的值并将布尔值设置为 false。停止 CF，启动 Apache，启动 CF - 看看你的管理员是否会加载。

一旦你在那里做的第一件事就是选择一个不同的端口:)

另一种方法是编辑您的 httpd.conf 文件并更改 Apache 正在侦听的端口。在某处寻找“*：80”......（我认为这是正确的）。将其更改为.. 8080 说 - 并重新启动 Apache。

# jquery - 如何从跨度 ID 中获取文本

> ID：11005841
> 
> 赞同：1
> 
> 时间：2012-06-12T22:34:14.263
> 
> 标签：jquery

在 JQM 下，如何获取 SPAN 中的文本？

当我搜索时，有数百种方法可以做到这一点。但我的情况下没有任何可用的东西。

我想在“mainPage”部分将这些 SPAN 值显示为 123 - 456。

```
<script>
$('a[name=submit_button]').click(function(){
 var Val1 = $('#zip1').text(text);
 var Val2 = $('#zip2').text(text);

 ...
</script>

<section id="mainPage" data-role="page">
 ...
</section>

<section id="zipSearch" data-role="dialog" data-theme="d">
 ...
 <ul><li><a name="sumit_button href="#mainPage"><span id="zip1">123</span><span id="zip2">456</span></li>
 </ul>
 ...
 </section> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:39:53.153

我想你只是想要

```
var Val1 = $('#zip1').text();
var Val2 = $('#zip2').text(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:43:13.427

只需使用

```
var Val1 = $("#zip1").text();
var Val2 = $("#zip2").text(); 
```

它可能对您不起作用，因为您的 a 标签中有语法错误（忘记了“之一”）。将其更改为：

```
<a name="sumit_button" href="#mainPage"> 
```

**编辑**：我也刚刚注意到你也没有关闭你的 a 标签。清除您的 HTML 标签，当您的字符串或标签没有在正确的位置终止时，会发生令人毛骨悚然的事情 :)

# cuda - 在 cuda 内核运行时访问 cuda 设备内存

> ID：11005842
> 
> 赞同：2
> 
> 时间：2012-06-12T22:34:19.247
> 
> 标签：cuda, gpgpu

我已使用 cudaMalloc 在设备上分配内存并将其传递给内核函数。是否可以在内核完成执行之前从主机访问该内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T14:42:21.270

我能想到的在内核仍在执行时启动 memcpy 的唯一方法是在与内核不同的流中提交异步 memcpy。（如果您将默认 API 用于内核启动或异步 memcpy，NULL 流将强制这两个操作被序列化。）

但是由于无法将内核的执行与流同步，因此该代码将受到竞争条件的影响。即复制引擎可能会从尚未被内核写入的内存中提取。

提到映射固定内存的人很喜欢：如果内核写入映射固定内存，它实际上是在完成处理数据时将数据“复制”到主机内存。这个习惯用法很好，只要内核不会再次接触数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T23:09:10.513

这是可能的，但不能保证您以这种方式检索的内存内容，因为您不知道内核的进度是什么。

您想要实现的是重叠数据传输和执行。这可以通过使用流来实现。您创建多个 CUDA 流，并在每个流中排队内核执行和设备到主机 cudaMemcpy。例如，将填充位置“0”的内核和 cudaMemcpy 从该位置返回到主机流 0，将位置填充“1”的内核和 cudaMemcpy 从“1”放入流 1，等等。然后会发生什么GPU将从“0”复制并执行“1”重叠。检查 CUDA 文档，它记录在某处（我认为在最佳实践指南中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T23:40:58.070

无论内核是否正在运行，您都无法直接从主机访问 GPU 内存。

如果您正在谈论在内核完成写入之前将该内存复制回主机，那么答案取决于您设备的计算能力。但是除了最古老的芯片之外，所有芯片都可以在内核运行时执行数据传输。

不过，您似乎不太可能想要复制仍在由内核更新的内存。您将获得部分完成数据的一些随机快照。相反，您可能希望在设备上有两个缓冲区的情况下进行设置。您可以在 GPU 处理另一个缓冲区时复制其中一个缓冲区。

更新：

根据您的说明，我认为您可以获得的最接近的是使用映射页面锁定的主机内存，也称为零拷贝内存。使用这种方法，值在内核写入时被复制到主机。无法查询内核以查看它执行了多少工作，因此我认为您必须反复扫描内存以查找新写入的值。有关更多信息，请参阅 CUDA 编程指南 v4.2 中的第 3.2.4.3 节，映射内存。

我不会推荐这个。除非您有一些非常不寻常的要求，否则可能会有更好的方法来完成您的任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T23:00:40.043

当您启动内核时，它是一个异步（非阻塞）调用。接下来调用 cudaMemcpy 将阻塞，直到内核完成。

如果您希望将结果用于调试目的，您可以使用 cudaDebugging 来单步执行内核并检查内存。

对于小的结果检查，您还可以在内核代码中使用 printf()。

或者，如果您对该特定结果感兴趣，则仅运行大小为 (1,1) 的线程块。

# perl - 如何在 Perl 中将部分子字符串更改为混合大小写

> ID：11005845
> 
> 赞同：4
> 
> 时间：2012-06-12T22:34:47.637
> 
> 标签：perl, rename, partial, utility, lowercase

Perl 重命名实用程序在日常文件工作中做得很好，尤其是在我不时检查我的 MP3 收藏时。

有些人有一个*可怕*的习惯，总是把艺术家的名字大写，就像这样

```
03 - ARTIST NAME - Song Title.mp3 
```

我希望将其重命名为看起来更平静的混合案例，就像这样

```
03 - Artist Name - Song Title.mp3 
```

但是，它也应该以一种智能的方式完成。

可能有法语或意大利语标题，例如：

```
05 - JEAN BAGUETTE - Honi soit qui mal y pense.mp3 
```

或者

```
07 - SIGNORE AL FORNO - Pazzi sono tutti i calciatori.mp3 
```

因此，我*不*希望这些在 之后变成混合大小写`-`，只有艺术家部分。

一种行不通的方法是

```
rename 's/(\d{1,2} - )([A-Z ]+)([\s\S]+)/$1lc($2)$3/' filename 
```

无论如何我都会发布它，因为它总能让你更好地了解我正在尝试做什么。

我也尝试用`$2`临时变量替换 （因为我不允许更改 $2 因为它是只读的）并`lc()`在打印结果之前执行此操作，但我没有成功。但无论如何，我是一个 Perl 初学者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T23:03:35.967

我知道的最清楚的方法是进行两阶段评估（使用`/e`修饰符）替换。

在下面的代码中，外部替换选择艺术家姓名，包括其边界连字符并替换它。

内层采用`$1`- 艺术家姓名 - 并将非空格字符的每个子序列替换为相同的字符串，首先小写`lc`字母，然后大写字母`ucfirst`。

就目前而言，该程序将打印之前和之后的名称。`#`从重命名行中删除以进行重命名。

```
use strict;
use warnings;

my @data = (
  '05 - JEAN BAGUETTE - Honi soit qui mal y pense.mp3',
  '07 - SIGNORE AL FORNO - Pazzi sono tutti i calciatori.mp3',
);

for my $file (@data) {

  (my $new = $file) =~ s{(-[^-]+-)}{
    (my $artist = $1) =~ s/(\S+)/ucfirst lc $1/eg;
    $artist;
  }e;

  print "$file\n";
  print "$new\n";
  print "\n";
  # rename $file, $new;
} 
```

**输出**

```
05 - JEAN BAGUETTE - Honi soit qui mal y pense.mp3
05 - Jean Baguette - Honi soit qui mal y pense.mp3

07 - SIGNORE AL FORNO - Pazzi sono tutti i calciatori.mp3
07 - Signore Al Forno - Pazzi sono tutti i calciatori.mp3 
```

* * *

**更新**

您可能喜欢的另一种方法是在连字符上拆分文件名，编辑第二部分并将它们重新连接在一起。

上面的主循环变成

```
for my $file (@data) {

  my @file = split /-/, $file;
  $file[1] =~ s/(\S+)/ucfirst lc $1/eg;
  my $new = join '-', @file;

  print "$file\n";
  print "$new\n";
  print "\n";
  # rename $file, $new;
} 
```

功能和输出不变。

* * *

**更新 2**

> 我刚刚尝试使用 /-.*?-/ 然后使用 substr($_, $-[0], $+[0]) 作为 =~ s/// 的左值，但遗憾的是它没有用

这似乎是一个很好的想法，我不得不尝试一下。

您的调用`substr`是错误的，因为`$-[0]`和`$+[0]`是字符串的偏移量。第三个参数`substr`必须是字符串*长度*，所以你需要写`substr($_, $-[0], $+[0] - $-[0])`

此代码工作正常，并再次产生与以前相同的结果

```
for my $file (@data) {

  next unless $file =~ /-[^-]+-/;
  my $new = $file;
  substr($new, $-[0], $+[0]-$-[0]) =~ s/(\S+)/ucfirst lc $1/eg;

  print "$file\n";
  print "$new\n";
  print "\n";
  # rename $file, $new;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T00:42:18.900

`ucfirst`您可以在正则表达式中使用( `\u`) 和`lc`( )的转义序列`\L`，并结合需要进一步向前冲刺的前瞻断言：

```
perl -pe 's/(\w)(\w+)(?=.*-)/\u$1\L$2/g' 
```

如果您想更正确，可以使用`\pL`(字母) 代替`\w`. 我认为这将适用于该`rename`工具。

**ETA：**更新为使用`\u`而不是`\U`.

# php - 如何在不替换 URL 和图像标签中找到的关键字的情况下替换字符串中所有出现的 $keyword？

> ID：11005851
> 
> 赞同：1
> 
> 时间：2012-06-12T22:34:57.887
> 
> 标签：php, replace

如何在不替换超链接 URL、图像标记 URL、图像标记标题和 alt 标记中找到的关键字的**情况下**替换字符串中**所有**出现的**$keyword ？**

 **例子：

```
$keywords = 'sports';

$string = '<a href="http://my_domain_name.com/sports/info.php"><img class="icon" src="http://my_domain_name.com/sports/images/football.gif" title="Get the latest football sports news" alt="Get the latest football sports news" />Football sports news</a>'; 
```

请注意，关键字“ **sports** ”与超链接 URL、图像标记 URL 以及图像标记标题和 alt 标记一起出现。

我想将 $keywords (sports) 替换为：

```
<span style="color: #000000; background-color: #FFFF00; font-weight: normal;">sports</span> 
```

产生以下结果：

```
<a href="http://my_domain_name.com/sports/info.php"><img class="icon" src="http://my_domain_name.com/sports/images/football.gif" title="Get the latest football sports news" alt="Get the latest football sports news" />Football <span style="color: #000000; background-color: #FFFF00; font-weight: normal;">sports</span> news</a> 
```

提前致谢。

**编辑 - 附加信息**

目前我正在使用以下两步方法，它**仅适用于 URLs**，**而不适用**于 title 和 alt 标签。**我也不**需要替换 title 和 alt 标签中的关键字。

```
// Replaces both the website and general images path urls with character strings (used to prevent highlighting keywords found within the path urls)
   if(strpos('http://my_domain_name.com/sports', $keywords) != false) {
     $description = str_ireplace('http://my_domain_name.com/sports', '1q2w3e4r5t6y7u', $description);
   }
   if(strpos('http://my_domain_name.com/sports/images', $keywords) != false) {
     $description = str_ireplace('http://my_domain_name.com/sports/images', '7u6y5t4r3e2w1q', $description);
   }

// Highlights the Search Keywords
   $description = str_ireplace($keywords, '<span style="color: #000000; background-color: #FFFF00; font-weight: normal;">'.$keywords.'</span>', $description);

// Replaces the character strings with the website and general images path urls
   if(strpos('http://my_domain_name.com/sports', $keywords) != false) {
     $description = str_ireplace('1q2w3e4r5t6y7u', 'http://my_domain_name.com/sports', $description);
   }
   if(strpos('http://my_domain_name.com/sports/images', $keywords) != false) {
     $description = str_ireplace('7u6y5t4r3e2w1q', 'http://my_domain_name.com/sports/images', $description);
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T23:33:08.550

这是我使用 PHP 的[`DOMDocument`](http://php.net/domdocument).

```
$str = '<a href="http://my_domain_name.com/sports/info.php"><img class="icon" src="http://my_domain_name.com/sports/images/football.gif" title="Get the latest football sports news" alt="Get the latest football sports news" />Football sports news</a>';

$doc = new DOMDocument();
$fragment = $doc->createDocumentFragment();
$fragment->appendXML( $str);
$doc->appendChild( $fragment);

// Create the <span>
$node = $doc->createElement( 'span');
$node->setAttribute( 'style', 'color: #000000; background-color: #FFFF00; font-weight: normal;');
$node->nodeValue = 'sports';

foreach( $doc->getElementsByTagName( 'a') as $tag)
{
    $img_tag = $tag->firstChild->cloneNode();
    $text = $doc->createTextNode( $tag->textContent);
    $tag->nodeValue = ''; // Clear out the contents of the <a>

    // Get the text before and after the replacement
    $start = strpos( $text->wholeText, 'sports');
    $before = $text->substringData( 0, $start);
    $after = $text->substringData( $start + strlen( 'sports'), strlen( $text->wholeText));

    // Put the image tag back, along with the before text, the <span>, and the after text
    $tag->appendChild( $img_tag);
    $tag->appendChild( $doc->createTextNode( $before));
    $tag->appendChild( $node);
    $tag->appendChild( $doc->createTextNode( $after));
}
echo htmlentities( $doc->saveHTML()) . "\n"; 
```

这输出：

```
<a href="http://my_domain_name.com/sports/info.php">
    <img class="icon" src="http://my_domain_name.com/sports/images/football.gif" title="Get the latest football sports news" alt="Get the latest football sports news">Football <span style="color: #000000; background-color: #FFFF00; font-weight: normal;">sports</span> news
</a> 
```

[演示](http://codepad.viper-7.com/deZmRJ)

（您需要 PHP > 5.3）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:53:34.693

xml_parse 可用于去除 HTML 代码中的标签。 [http://www.w3schools.com/php/func_xml_parse.asp](http://www.w3schools.com/php/func_xml_parse.asp)是一个很好的使用教程。

我会从我的字符串中剥离所有 html 标签，然后使用：
`str_replace($keyword, $replace_string, $string);`

做剩下的。

[http://www.php.net/manual/en/function.str-replace.php](http://www.php.net/manual/en/function.str-replace.php)

* * *

```
$replace_string = "<span fancy colours>{$keywords}</span>";
$string = '<a href="http://my_domain_name.com/sports/info.php"><img class="icon"     src="http://my_domain_name.com/sports/images/football.gif" title="Get the latest football     sports news" alt="Get the latest football sports news" />Football sports news</a>';

$exploded = explode("<", $string);

$tmp_array = array();
foreach ($exploded as $abit) {
    $pos = (strpos($abit, ">") + 1);            //get end of tag
    $tmp_string = substr($abit, $pos);
    if (strlen($tmp_string) > 1) {  // has text outside of tags
        $tmp_string = str_ireplace($keywords, $replace_string, $tmp_string);
        $tmp_array[] = substr($abit,0,$pos) . $tmp_string;
    } else {
        $tmp_array[] = $abit;
    }
}

$newstring = implode("<", $tmp_array);
echo $newstring; 
```

现在能有rep吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T23:51:40.493

只需使用字符串，我只需执行以下操作，因为所有属性值总是在元素值之前很容易获得正确的匹配，然后只需使用回调将“运动”替换为您喜欢的任何内容。

可能更多你需要的东西：

```
function replacer($match)
{
    global $replace_match_with_this, $string_to_replace;
    return str_ireplace($string_to_replace, $replace_match_with_this, $match[0]);
}

$new_string = preg_replace_callback(sprintf('/>[^<>]*[\s-]+%s[\s-]+[^<>]*<\/a>/i', $keyword), 'replacer', $string, 1); 
```

大概 $keyword 和 $string_to_replace 持有相同的值，可以组合成一个变量。**

# sql-server - 为什么需要将现有数据库文件附加到 SQL Server 实例？

> ID：11005852
> 
> 赞同：0
> 
> 时间：2012-06-12T22:34:58.943
> 
> 标签：sql-server

假设我们有一个使用 mdf 文件的网站。该网站在 web.config 文件中存储了一个连接字符串，该连接字符串包含要使用的 SQL Server 实例的名称和 mdf 文件的物理路径，这是网站使用数据库所需的所有信息. 从这里我得出结论，应用程序不需要向 SQL Server 实例注册其 mdf 文件才能工作，那么将 mdf 文件附加到实例有什么意义呢？这样我们就可以在 mdf 文件上使用 Management Studio 了吗？

**编辑：**存储在我网站的 web.config 中的连接字符串是：

```
<add name="MyConnectionString" connectionString="Data
Source=.;AttachDbFilename=|DataDirectory|\OnlinePhotoGalleryDB.MDF;Integrated
Security=True;User Instance=True" /> 
```

我不需要附加到实例以便我的网站使用数据库，而且我很确定它不是基于文件的数据库。

# c - 释放已使用数据的内存会导致分段错误

> ID：11005855
> 
> 赞同：4
> 
> 时间：2012-06-12T22:35:18.013
> 
> 标签：c, pointers, hashtable, resize

我写了一个哈希表，它基本上由这两种结构组成：

```
typedef struct dictEntry {
    void *key;
    void *value;
    struct dictEntry *next;
} dictEntry;

typedef struct dict {
    dictEntry **table;
    unsigned long size;
    unsigned long items;
} dict; 
```

`dict.table`是一个多维数组，其中包含所有存储的键/值对，它们又是一个链表。

如果哈希表的一半已满，我会通过将大小加倍并重新散列来扩展它：

```
dict *_dictRehash(dict *d) {
    int i;
    dict *_d;
    dictEntry *dit;

    _d = dictCreate(d->size * 2);

    for (i = 0; i < d->size; i++) {
        for (dit = d->table[i]; dit != NULL; dit = dit->next) {
            _dictAddRaw(_d, dit);
        }
    }

    /* FIXME memory leak because the old dict can never be freed */
    free(d); // seg fault

    return _d;
} 
```

上面的函数使用旧哈希表中的指针并将其存储在新创建的哈希表中。释放旧`dict d`的时会发生分段错误。

我如何能够释放旧的哈希表结构而不必再次为键/值对分配内存？

编辑，为了完整起见：

```
dict *dictCreate(unsigned long size) {
    dict *d;

    d = malloc(sizeof(dict));
    d->size  = size;
    d->items = 0;
    d->table = calloc(size, sizeof(dictEntry*));

    return d;
}

void dictAdd(dict *d, void *key, void *value) {
    dictEntry *entry;

    entry = malloc(sizeof *entry);

    entry->key   = key;
    entry->value = value;
    entry->next  = '\0';

    if ((((float)d->items) / d->size) > 0.5) d = _dictRehash(d);

    _dictAddRaw(d, entry);
}

void _dictAddRaw(dict *d, dictEntry *entry) {
    int index = (hash(entry->key) & (d->size - 1));

    if (d->table[index]) {
        dictEntry *next, *prev;

        for (next = d->table[index]; next != NULL; next = next->next) {
            prev = next;

        }

        prev->next = entry;
    } else {
        d->table[index] = entry;
    }
    d->items++;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:42:15.143

1.  最好的调试方法是针对 valgrind 运行代码。

但是给你一些观点：

1.  当您`free(d)`期望`destructor`对您进行更多调用时`struct dict`，它将在内部释放分配给指向指针的指针的内存`dictEntry`

2.  为什么要删除整个has表才能展开呢？无论如何，您有一个`next`指针，为什么不将新的哈希条目附加到它呢？

解决方案不是释放，`d`而是`d`通过分配更多`struct dictEntry`并将它们分配给适当 的来扩展`next`。

收缩时，`d`您将不得不迭代`next`以到达末尾，然后开始释放`struct dictEntry`s 内部的内存`d`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T04:49:41.853

为了阐明 Graham 的观点，您需要注意这个库中的内存是如何被访问的。用户有一个指向其字典的指针。当您重新哈希时，您释放了该指针引用的内存。虽然你为他们分配了一个新的字典，但新的指针永远不会返回给他们，所以他们不知道不要使用旧的。当他们再次尝试访问他们的字典时，它指向已释放的内存。

一种可能性是不要完全丢弃旧字典，而只丢弃您在字典中分配的 dictEntry 表。这样，您的用户将永远不必更新他们的指针，但您可以重新调整表以适应更有效的访问。尝试这样的事情：

```
void _dictRehash(dict *d) {
    printf("rehashing!\n");
    int i;
    dictEntry *dit;

    int old_size = d->size;
    dictEntry** old_table = d->table;
    int size = old_size * 2;

    d->table = calloc(size, sizeof(dictEntry*));
    d->size = size;
    d->items = 0;

    for (i = 0; i < old_size; i++) {
        for (dit = old_table[i]; dit != NULL; dit = dit->next) {
            _dictAddRaw(d, dit);
        }
    }

    free(old_table);
    return;

} 
```

* * *

作为旁注，我不确定你的哈希函数是做什么的，但在我看来，这条线

```
int index = (hash(entry->key) & (d->size - 1)); 
```

有点不正统。你得到一个哈希值并按位和表的大小做一个，我想这在某种意义上是有效的，它可以保证在（我认为？）之内`[0, max_size)`，我认为你可能是`%`指模数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T22:41:49.330

您正在释放一个传递给您的函数的指针。仅当您知道调用您的函数的人并未仍在尝试使用的旧值时，这才是安全的`d`。检查所有调用的代码`_dictRehash()`并确保没有任何东西挂在旧指针上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T22:59:35.173

实际上是做什么的`dictCreate`？

我认为您在（固定大小）对象和指向in`dict`的（可能是可变大小的）指针数组之间感到困惑。`dictEntries``dict.table`

也许您可以只`realloc()`使用 指向的内存`dict.table`，而不是创建一个新的“dict”对象并释放旧对象（顺便说一句，这并没有释放 dictentries 表！）

# java - 通过 MediaRecorder 录制音频

> ID：11005859
> 
> 赞同：2
> 
> 时间：2012-06-12T22:35:39.510
> 
> 标签：java, android, audio, audio-recording

我正在尝试通过 MediaRecorder 录制音频，但出现错误，我尝试更改所有内容，但没有任何效果。最近两个小时我试图找到错误，我也使用了 Log 类，我发现它在调用 recorder.start() 方法时发生了错误。可能是什么问题呢？

```
public class AudioRecorderActivity extends Activity {

MediaRecorder recorder;
File audioFile = null;
private static final String TAG = "AudioRecorderActivity";
private View startButton;
private View stopButton;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    startButton = findViewById(R.id.start);
    stopButton = findViewById(R.id.stop);

    setContentView(R.layout.main);
}

public void startRecording(View view) throws IOException{

    startButton.setEnabled(false);
    stopButton.setEnabled(true);

    File sampleDir = Environment.getExternalStorageDirectory();

    try{
        audioFile = File.createTempFile("sound", ".3gp", sampleDir);
    }catch(IOException e){
        Toast.makeText(getApplicationContext(), "SD Card Access Error", Toast.LENGTH_LONG).show();
        Log.e(TAG, "Sdcard access error");
        return;
    }

    recorder = new MediaRecorder();
    recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    recorder.setAudioEncodingBitRate(16);
    recorder.setAudioSamplingRate(44100);
    recorder.setOutputFile(audioFile.getAbsolutePath());
    recorder.prepare();
    recorder.start();
}

public void stopRecording(View view){
    startButton.setEnabled(true);
    stopButton.setEnabled(false);
    recorder.stop();
    recorder.release();
    addRecordingToMediaLibrary();
}

protected void addRecordingToMediaLibrary(){
    ContentValues values = new ContentValues(4);
    long current = System.currentTimeMillis();
    values.put(MediaStore.Audio.Media.TITLE, "audio" + audioFile.getName());
    values.put(MediaStore.Audio.Media.DATE_ADDED, (int)(current/1000));
    values.put(MediaStore.Audio.Media.MIME_TYPE, "audio/3gpp");
    values.put(MediaStore.Audio.Media.DATA, audioFile.getAbsolutePath());
    ContentResolver contentResolver = getContentResolver();

    Uri base = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
    Uri newUri = contentResolver.insert(base, values);

    sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, newUri));
    Toast.makeText(this, "Added File" + newUri, Toast.LENGTH_LONG).show();
    }

} 
```

这是xml布局。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/RelativeLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/start"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="146dp"
    android:onClick="startRecording"
    android:text="Start Recording" />

<Button
    android:id="@+id/stop"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/start"
    android:layout_below="@+id/start"
    android:layout_marginTop="41dp"
    android:enabled="false"
    android:onClick="stopRecording"
    android:text="Stop Recording" />

 </RelativeLayout> 
```

我添加了对 AndroidManifest 文件的权限。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="in.isuru.audiorecorder"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="8" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".AudioRecorderActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.RECORD_AUDIO" />

</manifest> 
```

这是我得到的错误，

```
 06-11 18:27:44.548: E/AndroidRuntime(765): java.lang.IllegalStateException: Could not execute method of the activity
 06-11 18:27:44.548: E/AndroidRuntime(765):     at android.view.View$1.onClick(View.java:2072) 
```

我需要录制高质量的音频。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T23:02:46.673

我没有花时间寻找你的代码，但这段代码有效：

```
public class ExampleActivity extends Activity implements OnClickListener {
private Button startButton;
private Button stopButton;
private MediaRecorder mediaRecorder;
private File audioFile;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.your_layout);
    startButton = (Button) findViewById(R.id.button1);
    startButton.setOnClickListener(this);
    startButton.setText("start");

    stopButton = (Button) findViewById(R.id.button2);
    stopButton.setOnClickListener(this);
    stopButton.setEnabled(false);
    stopButton.setText("stop");

    audioFile = new File(Environment.getExternalStorageDirectory(),
            "audio_test4.3gp");
}

// this process must be done prior to the start of recording
private void resetRecorder() {
    mediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    mediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    mediaRecorder.setAudioEncodingBitRate(16);
    mediaRecorder.setAudioSamplingRate(44100);
    mediaRecorder.setOutputFile(audioFile.getAbsolutePath());

    try {
        mediaRecorder.prepare();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

@Override
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.button1:
        mediaRecorder = new MediaRecorder();
        resetRecorder();
        mediaRecorder.start();

        startButton.setEnabled(false);
        stopButton.setEnabled(true);
        break;
    case R.id.button2:
        mediaRecorder.stop();
        mediaRecorder.release();
        mediaRecorder = null;

        startButton.setEnabled(true);
        stopButton.setEnabled(false);
        break;
    }
}

@Override
protected void onPause() {
    super.onPause();

    if (mediaRecorder != null) {
        mediaRecorder.stop();
        mediaRecorder.release();
        mediaRecorder = null;
    }
}
} 
```

# javascript - 无法使用 CSS 定位 Google +1 按钮？

> ID：11005860
> 
> 赞同：3
> 
> 时间：2012-06-12T22:35:48.137
> 
> 标签：javascript, html, css, positioning

我在我的网站上定位 Google +1 按钮时遇到了一些问题。div如下：

```
<div class="g-plusone"></div> 
```

我使用的 CSS 非常简单：

```
.g-plusone
{ 
position: absolute; 
top:95px;
left:715px; 
} 
```

尽管看起来很简单，但它简单并不想移动。

我知道有问题的 div 正在被访问。奇怪的是，其他社交分享按钮，例如下面的 FB 遵循相同的语法并且位置完美。

```
.fb-like 
{
position: absolute; 
top:62px;
left:715px; 
} 
```

不幸的是，将 !important 添加到值中没有任何作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-12T22:45:44.613

当 Google 加载 +1 按钮时，`.g-plusone`该类似乎消失了，因此请尝试将此 DIV 放入另一个 DIV 中，如下图所示：

**HTML：**

```
<div class="google-button">

    <div class="g-plusone"></div>

</div> 
```

**CSS：**

```
.google-button
{ 
position: absolute; 
top:95px;
left:715px; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-21T11:21:52.767

页面加载后，名为**g-plusone**的 Google div会变成大量代码，但是，您可以使用生成的 id 操作此按钮。

例如，在我的情况下，将按钮对齐在我放置的行的中间：

```
 #___plusone_0{
    vertical-align: middle !important;
} 
```

注意：id **___plusone_0**是google代码生成的id。用这个 id 做任何你想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T22:46:26.603

使用诸如 Firebug 之类的东西来确保您定位到正确的元素。+1 按钮嵌套得很深，因此您很可能需要进一步查看 DOM 树才能找到它的最外层包装器。您将能够设置它的位置而无需使用 !important 或任何东西，所以我肯定会先检查一下。

抱歉，我只是将其添加为上面的评论，但我似乎无法:)

# javascript - 和弦图 - 单击即可跳至键

> ID：11005861
> 
> 赞同：0
> 
> 时间：2012-06-12T22:35:53.840
> 
> 标签：javascript, jquery

我有一个和弦图表应用程序，它基本上可以在整个键中上下转换和弦图表，但现在我想扩展该应用程序并允许某人选择一个键并在点击事件时使用一个函数自动转到该键javascript 或 jquery。有人可以帮我解决这个问题吗？逻辑似乎很简单，但我只是不确定如何实现它。这是我当前允许用户上下转置的功能......

```
var match;
var chords = ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B','C','Db','D','Eb','E','F','Gb','G','Ab','A','Bb','B','C'];
var chords2 = ['C','Db','D','Eb','E','F','Gb','G','Ab','A','Bb','B','C','C#','D','D#','E','F','F#','G','G#','A','A#','C'];
var chordRegex = /(?:C#|D#|F#|G#|A#|Db|Eb|Gb|Ab|Bb|C|D|E|F|G|A|B)/g;

function transposeUp(x) {   
  $('.chord'+x).each(function(){ ///// initializes variables /////  
  var currentChord = $(this).text(); // gatheres each object 
  var output = "";      
  var parts = currentChord.split(chordRegex);       
  var index = 0;        
  /////////////////////////////////         
  while (match = chordRegex.exec(currentChord)){            
    var chordIndex = chords2.indexOf(match[0]);             
    output += parts[index++] + chords[chordIndex+1]; 
  }         
  output += parts[index];       
  $(this).text(output);     
  }); 
} 
```

* * *

```
function transposeDown(x){
    $('.chord'+x).each(function(){
    var currentChord = $(this).text(); // gatheres each object
    var output = "";
    var parts = currentChord.split(chordRegex);
    var index = 0;
    while (match = chordRegex.exec(currentChord)){
        var chordIndex = chords2.indexOf(match[0],1);
        //var chordIndex = $.inArray(match[0], chords, -1);
        output += parts[index++] + chords2[chordIndex-1];
    }
    output += parts[index];
    $(this).text(output);
});
} 
```

任何帮助表示赞赏。答案将被接受！谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:43:56.163

这就是你想要的吗？一个会创建点击事件的函数？

```
$('[class^="chord"]').click(function() {
    alert($(this).text() + ' clicked');
}); 
```

*根据您的评论：*这里有一些伪代码可以让您朝着正确的方向前进：

*   还存储每个和弦数组的转置版本
*   单击音符时，在原始 chords 数组中找到它的元素（使用`$(this).text()`上面来匹配音符名称）
*   找到匹配项后，您可以使用相同的数组索引找到其转置版本

# iphone - 自动化：使用 Xcode iPhone 模拟器捕获网络的 Selenium iphone（移动）驱动程序

> ID：11005865
> 
> 赞同：1
> 
> 时间：2012-06-12T22:36:10.143
> 
> 标签：iphone, mobile, selenium, automation, webdriver

我正在使用 Xcode iPhone(Mobile) 模拟器为移动网站运行 Selenium iPhone WebDriver 自动化脚本。无论如何要在 iPhone 模拟器上捕获 Network-Traffic，类似于 Selenium RC Network capture 或 BrowserMob Proxy for Web Driver。

如果您知道以编程方式在 iPhone 模拟器上捕获网络流量的方法，请告诉我。

我确实看到了一些工具，如 Wireshark 或 HTTPScoop 来捕获网络流量，但我需要以一种程序化的方式来自动化。

我需要这种情况来进行像素跟踪。

谢谢桑迪普

# android - getView only shows Flagged Backgrounds for drawn Views, It does not show Flagged Background when scroll to view more items on list

> ID：11005868
> 
> 赞同：0
> 
> 时间：2012-06-12T22:36:25.383
> 
> 标签：android, android-listview, flags, recycle

I am trying to create a listview that receives a flagged list of items to indicate a status to the user. I have been able to create the flag display by using a yellow background (see image at bottom). In Theory, the flagged list can have many flagged items in it. However in my app, only the first three flagged backgrounds are shown. I believe this is because they are initially drawn to the screen. The Flagged background that are **not** drawn initially to the screen do not show. I'd like to know how to get the remaining flags to show in the list.

ListView Recycling: The backgrounds in the listView are being recycled in getView(). This recycling goes from position 0 to position 9\. I have flags that need to match at positions 13, 14 and so on. Those positions are not being displayed.

listView.getCheckedItemPositions() for multiple selections: This method will not work in my case because the user will not selected the flags. The flags are coming from the server.

setNotifyOnChange() and/or public virtual void SetNotifyOnChange (bool notifyOnChange): I'm not adding new data to the list, so I don't see how this method would work for my program. Does this method communicate to getview when it is recycling data? I was unable to find an answer to this in my research.

public void registerDataSetObserver: This may be overkill for my problem, but is it possible to have an observer object that keeps track of the all the positions in my items list and in my flag list no matter if the view is recycled and match them on the screen?

[![flagged backgrounds from server](../Images/094d90625dbb664a7157033ea28ad8e6.png)](https://i.stack.imgur.com/PGjur.jpg)
[(source: [leobee.com](http://www.leobee.com/android/push/so/flag.jpg))]

Code:

```
package com.convention.notification.app;

import java.util.Iterator;
import java.util.ArrayList;
import java.util.List;
import android.app.Activity;
import android.content.Context;
import android.graphics.Color;
import android.os.Bundle;
import android.text.Html;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewParent;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.TextView;

public class NewsRowAdapter extends ArrayAdapter<Item> {

    private Activity activity;
    private List<Item> items;
    private Item objBean;
    private int row;
    private List<Integer> disable;
    View view ;
    int disableView;

    public NewsRowAdapter(Activity act, int resource, List<Item> arrayList, List<Integer> disableList) {
        super(act, resource, arrayList);
        this.activity = act;
        this.row = resource;
        this.items = arrayList;
        this.disable=disableList;

        System.out.println("results of delete list a:"+disable.toString()); 

    }

    public int getCount() {
        return items.size();        
    }
    public Item getItem(int position) {
        return items.get(position);
    }
    public long getItemId(int position) {
        return position;
    }

        @Override
        public int getItemViewType(int position) {

        for(int k =0;k < disable.size();k++){
            if(position==disable.get(k)){

            //System.out.println( "is "+position+" value of disable "+disable.get(k));
                disableView=disable.get(k);

                //AdapterView.getItemAtPosition(position);
            } 

        }

    return position;
}

            @Override
            public View getView(final int position, View convertView, ViewGroup parent) {
                View view = convertView;
                ViewHolder holder;

                if (view == null) {
                    LayoutInflater inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    view = inflater.inflate(row, null);

                    getItemViewType(position);
                    long id=getItemId(position);

                    if(position==disableView){ 
                        view.setBackgroundColor(Color.YELLOW);
                        System.out.println(" background set to yellow at position "+position +" disableView is at "+disableView);

                        }else{
                            view.setBackgroundColor(Color.WHITE);
                            System.out.println(" background set to white at position "+position +" disableView is at "+disableView);

                            }

                    //ViewHolder is a custom class that gets TextViews by name: tvName, tvCity, tvBDate, tvGender, tvAge;
                    holder = new ViewHolder();

                    /* setTag Sets the tag associated with this view. A tag can be used to
                     *  mark a view in its hierarchy and does not have to be unique 
                     *  within the hierarchy. Tags can also be used to store data within
                     *   a view without resorting to another data structure.

        */
                    view.setTag(holder);
                } else {

                    //the Object stored in this view as a tag
                    holder = (ViewHolder) view.getTag();
                }

                if ((items == null) || ((position + 1) > items.size()))
                    return view;

                objBean = items.get(position);

        holder.tv_event_name = (TextView) view.findViewById(R.id.tv_event_name);
        holder.tv_event_date = (TextView) view.findViewById(R.id.tv_event_date);
        holder.tv_event_start = (TextView) view.findViewById(R.id.tv_event_start);
        holder.tv_event_end = (TextView) view.findViewById(R.id.tv_event_end);
        holder.tv_event_location = (TextView) view.findViewById(R.id.tv_event_location);

        if (holder.tv_event_name != null && null != objBean.getName()
                && objBean.getName().trim().length() > 0) {
            holder.tv_event_name.setText(Html.fromHtml(objBean.getName()));

        }
        if (holder.tv_event_date != null && null != objBean.getDate()
                && objBean.getDate().trim().length() > 0) {
            holder.tv_event_date.setText(Html.fromHtml(objBean.getDate()));
        }
        if (holder.tv_event_start != null && null != objBean.getStartTime()
                && objBean.getStartTime().trim().length() > 0) {
            holder.tv_event_start.setText(Html.fromHtml(objBean.getStartTime()));
        }
        if (holder.tv_event_end != null && null != objBean.getEndTime()
                && objBean.getEndTime().trim().length() > 0) {
            holder.tv_event_end.setText(Html.fromHtml(objBean.getEndTime()));
        }
        if (holder.tv_event_location != null && null != objBean.getLocation ()
                && objBean.getLocation ().trim().length() > 0) {
            holder.tv_event_location.setText(Html.fromHtml(objBean.getLocation ()));

        }

        return view;
    }

    public class ViewHolder {
        public TextView 
        tv_event_name,
        tv_event_date,
        tv_event_start,
        tv_event_end,
        tv_event_location
        /*tv_event_delete_flag*/;

    }

} 
```

Logcat:

```
06-12 20:54:12.058: I/System.out(493): item disalbed is at postion :0
06-12 20:54:12.058: I/System.out(493): item disalbed is at postion :4
06-12 20:54:12.069: I/System.out(493): item disalbed is at postion :5
06-12 20:54:12.069: I/System.out(493): item disalbed is at postion :13
06-12 20:54:12.069: I/System.out(493): item disalbed is at postion :14
06-12 20:54:12.069: I/System.out(493): item disalbed is at postion :17
06-12 20:54:12.069: I/System.out(493): results of delete list :[0, 4, 5, 13, 14, 17]
06-12 20:54:12.069: I/System.out(493): results of delete list a:[0, 4, 5, 13, 14, 17]
06-12 20:54:12.069: I/System.out(493):  set adapaer to list view called;
06-12 20:54:12.128: I/System.out(493):  background set to yellow at position 0 disableView is at 0
06-12 20:54:12.628: I/System.out(493):  background set to white at position 1 disableView is at 0
06-12 20:54:12.678: I/System.out(493):  background set to white at position 2 disableView is at 0
06-12 20:54:12.708: I/System.out(493):  background set to white at position 3 disableView is at 0
06-12 20:54:12.738: I/System.out(493):  background set to yellow at position 4 disableView is at 4
06-12 20:54:12.778: I/System.out(493):  background set to yellow at position 5 disableView is at 5
06-12 20:54:12.808: I/System.out(493):  background set to white at position 6 disableView is at 5
06-12 20:54:12.838: I/System.out(493):  background set to white at position 7 disableView is at 5 
```

This is a link to my first question a day ago:

[Change Background on a specific row based on a condition in Custom Adapter](https://stackoverflow.com/questions/10973504/change-background-on-a-specific-row-based-on-a-condition-in-custom-adapter)

I appreciate your help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T00:23:06.920

Ok, the answer was that I had to repeat the code out side of the if(view==null) in the else section.

```
if (view == null) {
                    LayoutInflater inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    view = inflater.inflate(row, null);

                    getItemViewType(position);
                    long id=getItemId(position);

                    if(position==disableView){ 
                        view.setBackgroundColor(Color.YELLOW);
                        System.out.println(" background set to yellow at position "+position +" disableView is at "+disableView);

                        }else{
                            view.setBackgroundColor(Color.WHITE);
                            System.out.println(" background set to white at position "+position +" disableView is at "+disableView);

                            }

                    //ViewHolder is a custom class that gets TextViews by name: tvName, tvCity, tvBDate, tvGender, tvAge;
                    holder = new ViewHolder();

                    /* setTag Sets the tag associated with this view. A tag can be used to
                     *  mark a view in its hierarchy and does not have to be unique 
                     *  within the hierarchy. Tags can also be used to store data within
                     *   a view without resorting to another data structure.

        */
                    view.setTag(holder);
                } else {

                    getItemViewType(position);
                    long id=getItemId(position);

                    if(position==disableView){ 
                        view.setBackgroundColor(Color.YELLOW);
                        System.out.println(" background set to yellow at position "+position +" disableView is at "+disableView);

                        }else{
                            view.setBackgroundColor(Color.WHITE);
                            System.out.println(" background set to white at position "+position +" disableView is at "+disableView);

                            } 
```

# javascript - 如何修复有时加载两次、一次或根本不加载的 Facebook JSDK？

> ID：11005870
> 
> 赞同：1
> 
> 时间：2012-06-12T22:36:45.347
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我在我的网站上使用 facebook javaSDK，但我遇到了一个奇怪的问题。当我使用“Internet Explorer”加载网站时，它总是运行良好。当我用 firefox 加载网站时，它总是加载两次，而当我使用 chrome 时，JSDK 有时会加载一次，有时根本不加载，给我错误“未捕获的 ReferenceError：FB 未定义”。我尝试对 SDK 使用异步加载，但仍然是同样的问题。顺便说一句，我在 Firefox 上有萤火虫，这可能是 JSDK 加载两次的原因吗？

这是加载jssdk的代码

```
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
FB.init({
  appId      : '108437552626598', // App ID
  status     : true, // check login status
  cookie     : true, // enable cookies to allow the server to access the session
  xfbml      : true  // parse XFBML
});

};

 // Load the SDK Asynchronously
 (function(d){
 var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "//connect.facebook.net/en_US/all.js";
 ref.parentNode.insertBefore(js, ref);
  }(document));
</script> 
```

我正在尝试使用 FB.getlogin，我正在尝试在 Wordpress 网站中整合 facebook opengraph。完成加载主要内容后，我立即退出了我的脚本 这是代码

```
 </div><!-- end #content -->

<script type="text/javascript"      src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
 <script type="text/javascript">
 FB.getLoginStatus(function(response) {
 if (response.status == 'connected') {
alert('in');
window.facebooklogin = 'true';
    window.myValue = response.authResponse.accessToken;  
window.myId = response.authResponse.userID;
$('.userimage img').attr('src','http://graph.facebook.com/' + window.myId +         '/picture');
 $.ajax({ url: 'http://ballvids.com/check/admin_checkuser.php',
     data: {action: window.myId},
 dataType:'json',
     type: 'post',
     success: function(output) {
    if (output.message == 'true'){
        $('.thumbnail   img').attr('src',"http://ballvids.com/images/on2.png");
        alert(window.myValue);
        FB.api('/me/video.watches?video=<?php echo   urlencode(get_permalink($post->ID));?>&access_token='+window.myValue,'post',function(response) {
             if (!response || response.error) {
            alert(response.error.message);
            } else {
            alert(response.id);
            postID=response.id;
            showStuff('removeTimeline');
            }  
                });
    }else{

        $('.thumbnail img').attr('src',"http://ballvids.com/images/off2.png");
    }

        }
});
}else{
    alert('inside2');
    $('.thumbnail img').attr('src',"http://ballvids.com/images/off2.png");
    window.facebooklogin = 'false';
} 
```

}，真的）;

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T08:29:06.453

> 当我用 Firefox 加载网站时，它总是加载两次，

尝试设置一个 channel.html 文件并在初始化时引用它。

> 当我使用 chrome 时，JSDK 有时会加载一次，有时根本不加载，给我错误“未捕获的 ReferenceError：FB 未定义”。

*如果*您将对 FB 方法的调用封装到 window.fbAsyncInit 中，这是不可能的，因为如果未加载 SDK，则永远不会调用该回调。结论：您没有，而是将 FB.getLoginStatus 调用放在其他地方（您还没有在代码中向我们展示）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T06:02:36.733

你必须调用`FBLoginStatus()`, 在里面`fbAsyncInit`

```
window.fbAsyncInit = function() {
    FB.init({
        appId  : APP_ID,
        status : true,
        cookie : true,
        xfbml  : true
    });

    FB.getLoginStatus( function(response) {
        console.log(response);
    }, true);
}; 
```

如果从返回的缓存对象有问题，则`FB.getLoginStatus()`必须传递第二个参数`true`。

文档：[https ://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/](https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/)

# android - 如何使用屏幕上的按钮打开 MenuInflater？

> ID：11005876
> 
> 赞同：0
> 
> 时间：2012-06-12T22:37:35.107
> 
> 标签：android, button, view, menu

有什么方法可以使用 onClick 调用打开 MenuInflater 吗？

如果您使用：

```
public void onClick(View v)
{ 
```

我无法初始化菜单。

```
Menu menu = new Menu()
inflater.inflate(R.menu.picture_menu, menu); 
```

我相信没有办法称之为

```
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.picture_menu, menu);
} 
```

如果不是通过菜单按钮；

是这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:42:30.673

您可以在 onClick() 中调用[Activity.openOptionsMenu( )](http://developer.android.com/reference/android/app/Activity.html#openOptionsMenu%28%29)

# c - 静态库加载两次

> ID：11005881
> 
> 赞同：7
> 
> 时间：2012-06-12T22:38:06.760
> 
> 标签：c, linker, static-libraries, static-linking, double-free

我有共享对象 A.so ，它静态链接到 libssl.a 和另一个共享对象 B.so ，它也静态链接 libssl.a 。

A.so & B.so 在全球范围内具有来自 libssl.a 的符号。我通过 readelf -s A.so 检查了这个

我有一个可执行的 a.out 加载 A.so 和 B.so。当 a.out 终止时，我在 A.so 中的 libssl.a 中的一个符号中出现双重释放错误。

尽管 libssl.a 静态链接到每个共享对象，但由于它们是全局公开的，因此有可能共享相同的符号而不是选择它的本地副本。

这是什么解决方法？如何在这里使符号本地化？

请帮忙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T23:42:33.907

这确实是意料之中的。一个实例`libssl.a`插入另一个实例（可能是另一个实例的子集），结果并不漂亮。您可以使用版本脚本（`--version-script`to ld，with for cc）来控制从and`-Wl,`导出的内容。如果某些东西没有被导出，它也不能被插入。`A.so``B.so`

`libssl.a`或者，您可以使用可见性标志进行编译，例如`-fvisibility=hidden`. 这些标志只影响动态链接器而不影响静态链接。无论如何，您可能需要自己编译它，因为交付的`.a`文件往往包含与位置相关的代码，用于链接到可执行文件。只有某些平台（例如 32 位 x86）允许您将此类代码链接到共享对象中，并且仅以文本重定位为代价。

评论中建议的`dlopen`with也应该有效，但用于此目的`RTLD_LOCAL`似乎很不自然。`dlopen`

`libssl.so`另一种选择是在两个库中使用相同的共享。

# android - 有没有办法增加 Google Console API 项目创建限制？

> ID：11005883
> 
> 赞同：1
> 
> 时间：2012-06-12T22:38:23.640
> 
> 标签：android, google-api, android-c2dm

我正在为 c2dm 推送消息获取 OAuth 密钥。为了做到这一点，我正在为每个应用程序创建一个单独的 Google Console Api 项目。

问题是我必须做大约 100 个 Android 应用程序，并且在尝试创建新项目时，我一直在 Google API 控制台中遇到以下消息。

> 您已达到创建项目的每日限额。明天再试。

这真的让我的团队放慢了速度，这可能是一个反复出现的问题，因为我们有时会快速连续地生产许多应用程序。我们很乐意为更大的容量付费，但不知道在哪里要求他们为此上限。页面中没有任何明显的东西可以帮助我提高这个限制。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T23:35:14.313

您不需要为每个应用程序创建一个新项目，实际上我认为这样做没有意义。OAuth 密钥（或 ClientLogin 凭据）的目的是验证您注册 C2DM 时使用的发件人电子邮件。如果您为所有 100 个应用程序使用同一个发件人，那么您只需要一个 OAuth 密钥。如果您使用 100 个不同的发件人地址分别注册 C2DM，那么每个人都可以创建一个新的 API 项目。无论哪种方式，您都不必担心每日项目创建限制。

# objective-c - 在开发过程中测试 iOS 应用程序存档并保持现有的 sqlite 数据库已在使用中

> ID：11005885
> 
> 赞同：1
> 
> 时间：2012-06-12T22:38:43.530
> 
> 标签：objective-c, core-data, icloud

按照此链接 [使用 Xcode 的存档功能测试工作流程](https://developer.apple.com/library/ios/#qa/qa1764/_index.html#//apple_ref/doc/uid/DTS40012028)

我正在尝试构建和测试 iOS 应用程序存档。

该应用程序之前通过 Xcode 在 iOS 设备上构建和开发，有一个核心数据数据库，该数据库在开发期间已填充并在几个月前放入 iCloud。

我想通过保留现有数据库来开发存档，但是正如指令中所述，这似乎是不可能的：

**3) 从您的设备中删除应用程序的任何版本**

如果我没记错的话，通过设备删除应用程序也意味着删除 sqlite 文件。我知道有 iCloud，但我不确定整个 sqlite 事务日志文件是否仍然可用。您对此有任何解决方案或解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T08:02:55.443

通过使用 Xcode Organizer，可以将应用程序的数据与应用程序本身分开保存。

**在设备下方**左侧的设备选项卡上，有几个类别。在屏幕截图和设备日志中，还有应用程序。在主窗口中，您可以选择您的应用程序，在应用程序数据的*上传*和*下载*操作下方可用。

因此，您可以随时保存数据并在以后恢复以进行测试。

# javascript - 离开网站时弹出

> ID：11005887
> 
> 赞同：4
> 
> 时间：2012-06-12T22:38:50.160
> 
> 标签：javascript, popup, function-exit

我遇到了 JavaScript 的问题。我想要一个脚本，它会在退出整个网站时弹出一条带有问题的消息，如果访问者回答“否”网页关闭，如果他回答“是”，他将被重定向到另一个页面。[我在http://www.pgrs.net/2008/01/30/popup-when-leaving-website/](http://www.pgrs.net/2008/01/30/popup-when-leaving-website/)找到了一个例子，但它似乎对我不起作用。我找不到任何解决方案。请检查我的代码并告诉我也许我做错了什么？这是我的源代码。

也许有人会看到问题。

```
 <!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="utf-8">
    <title>PUA.LT</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="">
    <meta name="author" content="Perfect WEB Solutions">
    <link rel="stylesheet" href="<?php echo base_url("additional/style.css") ?>">
    <script src='<?php echo base_url("additional/prototype.js")?>' type='text/javascript' ></script>
</head>
<body>
<script type="text/javascript">

Event.observe(document.body, 'click', function(event) {
  if (Event.element(event).tagName == 'A') {
    staying_in_site = true;
  }
});

window.onunload = popup;

function popup() {
  if(staying_in_site) {
    return;
  }
  alert('I see you are leaving the site');
}
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-12T22:48:47.427

试试这个：

```
window.onbeforeunload = popup;

function popup() {
  return 'I see you are leaving the site';
} 
```

# class - 是否可以编写被 GWT 编译器忽略的代码？

> ID：11005890
> 
> 赞同：0
> 
> 时间：2012-06-12T22:39:08.960
> 
> 标签：class, gwt

我正在寻找一种方法来编写被 GWT 编译器忽略的代码。例如，某些方法应该被忽略，因为它们使用 GWT 中不可用的类。

是否可以使用一些 @Attribute 魔法来标记这些方法或在编译期间删除代码？当在 GWT 平台上运行时，无论如何都不会访问该代码，但是当该代码在 JVM 中运行/测试时，将它放在那里将非常有用。

我知道我可以编写一些虚拟类（实际上我已经在这样做了）。我仍在寻找一种更简单的方法。此外，对于某些类，我无法创建虚拟对象，因为 GWT 已经拥有像 System 这样的类，但只支持一小部分功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T13:57:01.417

不在方法层面。您可以过滤掉源包中的特定类：

```
<source path="client">
  <exclude name="XMLNamespaceContext.java"/>
  <exclude name="XMLUtils.java"/>
  <!-- exclude test classes, they always end with Test.java -->
  <exclude name="**/*Test.java" />
</source> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T06:33:00.760

例如，我有一些像你这样的课程

```
private DateFormat dateFormat = new SimpleDateFormat("yy-MM-dd"); 
```

SimpleDateFormat 类不是 GWT 类，它带有红色下划线，当我指向它时，它说：JRE Emulation Library 中不存在 Class 'java.text.DateFormat'，因此它不能在客户端代码中使用，但是我的测试使用没问题。这是我的项目结构和我的项目测试类之一的图片。![在此处输入图像描述](../Images/11166e740836e5c147555c1173f5ab53.png)

无论如何，您在 gwt.xml 中声明的任何内容都会检查已声明包中的类是否具有 GWT 仿真，但是您的测试在 JVM 环境中运行，因此您不必关心没有 GWT 仿真的类。但是如果你使用 GWTTestcase 事情会有所不同，因为 GWTTestcase 会触发浏览器并将测试放在环境浏览器下。要解决这个问题，请使用 MVP 模式设计。[MVP1](https://developers.google.com/web-toolkit/articles/mvp-architecture)

[MVP2](https://developers.google.com/web-toolkit/articles/mvp-architecture-2) 。祝您好运

# php - 使用 API 发布链接不包含图片、标题或 Meta Desc PHP

> ID：11005891
> 
> 赞同：2
> 
> 时间：2012-06-12T22:39:11.097
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk, facebook-wall

使用 API 发布时，我收到以下信息：

[https://www.facebook.com/weather.warnings/posts/329128793830700](https://www.facebook.com/weather.warnings/posts/329128793830700)

注意标题、缩略图和元描述是如何从事物中丢失的。

以下是我正在使用的代码。

```
$allalert = array
(
'oauth_token' => 'not pasting this thanks :P',
'message' => "New $type for $where",
'link' => $url,
);
$sendalert = $facebook->api('/125291287567922/links/','POST',$allalert); 
```

参考[如何将缩略图发布到 Facebook /links 对象？](http://facebook.stackoverflow.com/questions/6327996/how-does-one-post-a-thumbnail-picture-to-a-facebook-links-object)它说该项目从页面本身中提取图片

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T06:15:34.053

您可以通过在数组中传递以下项目来做到这一点：

```
'name' => "post title",
'link' => "url to the page",
'message'=> "message",
'description' => "longer description",
'picture'=>"url of the picture",
'caption' => "Another bit of text" 
```

这消除了对 FB 抓取工具的任何依赖来获取 url 并抓取和解析数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T23:40:02.570

您需要将所需的 og 标签添加到您的页面。

# c++ - 是否可以/建议将向量存储在结构中？C++

> ID：11005892
> 
> 赞同：11
> 
> 时间：2012-06-12T22:39:23.717
> 
> 标签：c++, vector, struct

我一直认为 struct 是一个固定大小的对象，虽然似乎没有任何明显的编译器错误，但我想知道这样做是否通常是一种好的做法。将结构更改为类是否更可取，或者结构也可以这样做？

代码，只是因为人们变得挑剔：

```
struct Sprite
{
    float x;
    float y;
    std::vector<Sprite> sprite;
} 
```

我所做的本质是让一个班级的孩子与父母的类型相同。父母死了，孩子也死了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-12T22:41:21.327

An`std::vector`具有特定的已知大小，并且包含它的任何类或结构都具有特定的已知大小。`std::vector`在堆上分配内存以充当可变大小的数组并存储指向所述内存的指针。结构和类之间的唯一区别是结构默认是公共的，而类默认是私有的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-12T22:42:35.977

与成员可见性的区别`struct`和`class`关系：最显着的区别是`struct`' 的成员默认是公共的，而`struct`' 的继承默认是公共的；`class`默认情况下，成员和`class`继承都是私有的。除此之外，没有区别：您始终可以编写代码`struct`，生成与使用编写的代码等效的代码`class`，反之亦然。

# android - Android有没有办法让列表框设置大小，而不是填充父级或内容？

> ID：11005893
> 
> 赞同：0
> 
> 时间：2012-06-12T22:39:24.670
> 
> 标签：android

我想在顶部有一个 TextView，如果它超过 5 行文本，它会滚动。然后是底部的文本列表，简单地归档剩余空间。

我正在使用带有 TextView 的 ScrollView。问题是如果我将顶部滚动设置为扭曲内容，如果文本超过 5 行，它将继续变大。如果我将其设置为填充父级，则不会显示按钮文本视图。有没有办法做到这一点？

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Tell a Furtune Chat"
        android:textSize="38px" />

    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Tell a Furtune \n ted \n teda \n rob \n fred \n bed \n jack \n junk \n more"
            android:textSize="38px" />
    </ScrollView>

    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Tell a Furtune \n ted \n teda \n rob \n fred \n bed \n jack \n junk \n more"
            android:textSize="38px" />
    </ScrollView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:44:41.063

如果我理解您的问题，只需使用此属性：

```
<TextView
    ...
    android:maxLines="5" /> 
```

此外，如果您的 ScrollViews 将其他视图“推”出屏幕底部，您可以像这样限制它们的高度：

```
<ScrollView
    ...
    android:height="100dp" > 
```

**添加**

从[文档](http://developer.android.com/reference/android/widget/EditText.html)：

> EditText 是 TextView 之上的一个薄薄的饰面，将自身配置为可编辑。

但是在这种情况下：`maxLines`以两种截然不同的方式表现。我似乎记得 TextView 在定义后会自动滚动，`maxLines`就像我经常使用的 EditTexts 一样。（多么疯狂的想法！）无论如何，这是实现您想要的最简单的方法：

```
<ScrollView
    android:layout_width="wrap_content"
    android:layout_height="90sp" >

    <TextView
        android:id="@+id/text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        ... />
</ScrollView> 
```

ScrollView 的高度是字体大小与要显示的行数的比率。您可以使用`maxLines`此处描述的属性（[在 Android 上使 TextView 可滚动](https://stackoverflow.com/questions/1748977/making-textview-scrollable-in-android)），但此解决方案不支持投掷手势，并在用户滚动时创建“闪烁”效果。

# ironpython - IronRuby / IronPython 在同一个项目中？

> ID：11005895
> 
> 赞同：1
> 
> 时间：2012-06-12T22:39:45.797
> 
> 标签：ironpython, ironruby

我一直在尝试构建和使用 IronRuby 和 IronPython 的应用程序，但我一直遇到共享 DLL 的引用错误，特别是 Microsoft.Scripting.dll。我得出的结论是，这是由于 IP/IR 使用了不同的版本。

我的问题是除了重新编译 IronPython/IronRuby是否还有*其他解决方法？*如果没有，是否有人已经这样做并提供了快速下载链接？

谢谢！

# javascript - 如何限制每分钟在 http-on-modify-request 一定次数后触发的 JavaScript 函数的执行？

> ID：11005898
> 
> 赞同：0
> 
> 时间：2012-06-12T22:40:16.897
> 
> 标签：javascript, firefox, firefox-addon

在我的 Firefox 扩展代码中，我在观察 Facebook 中的 AJAX 请求后执行了某种（相当繁重的计算）功能。鉴于现在 Facebook 非常依赖它们，并且在较短的第二周期内生成了许多请求，它正在减慢扩展程序的性能！简而言之，现在我有以下内容：

```
var httpRequestObserver =
{
  observe: function(subject, topic, data) 
  {
    if (topic == "http-on-modify-request") 
    {
     var httpChannel = subject.QueryInterface(Components.interfaces.nsIHttpChannel);
     if (httpChannel.URI.spec.search("facebookj.com")!=-1)       
     {
      //setTimeout(function () {my_function();}, 2000);
     }
    }      
  }
}; 
```

但是，现在我想`my_function`通过限制执行次数来执行，比如每分钟。换句话说，我想简单地跳过一些观察到的 HTTP 请求，如果它们发生的频率超过每三秒一次！

我是否将超时附加到观察者功能？或者我是否声明一个观察到的全局计数器，`http-on-modify-requests`然后`my_function`仅在每三个之后调用一次？还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T06:30:07.063

最简单的方法是忽略在前一个请求的 333 毫秒内进入的所有请求 - 这将确保您每秒处理的请求永远不会超过 3 个：

```
var httpRequestObserver =
{
  previousRequest: 0,
  observe: function(subject, topic, data) 
  {
    if (topic == "http-on-modify-request") 
    {
     var httpChannel = subject.QueryInterface(Components.interfaces.nsIHttpChannel);
     var now = Date.now();
     if (httpChannel.URI.spec.search("facebookj.com")!=-1 &&
         now - this.previousRequest > 333)
     {
      this.previousRequest = now;
      my_function();
     }
    }      
  }
}; 
```

# c# - Foreach 循环遍历列表的错误

> ID：11005900
> 
> 赞同：2
> 
> 时间：2012-06-12T22:40:37.107
> 
> 标签：c#, list, foreach, invalidoperationexception, argumentexception

我有以下给我带来问题的代码，我将不胜感激：

```
private static string CreateOptionString(List<VehicleOption> Options)
{
    StringBuilder returnValue = new StringBuilder();
    foreach (VehicleOption option in Options)
    {
        if (option.OptionStatus == ExtendedResponse.OptionState.Included)
        {
            if (returnValue.Length > 0)
            {
                returnValue.Append(", ");
            }
            returnValue.Append(option.OptionName);
        }
    }
    return returnValue.ToString();
} 
```

我最初的问题是我在 foreach 循环中收到 System.InvalidOperationException: collection was modified 错误。

1）我仍然无法弄清楚为什么我会收到这个错误，因为我没有看到它被修改的任何地方。

有人建议我将列表复制到新列表并循环遍历新列表。我这样做了，它摆脱了 InvalidOperationException。但是，我尝试了 2 种不同的方式来处理列表，并且都给了我一个 System.ArgumentException：目标数组不够长。这是我尝试复制列表的两种方法

```
List<VehicleOption> newOptions = new List<VehicleOption>(Options); 
```

和

```
List<VehicleOption> newOptions = new List<VehicleOption>();
newOptions.AddRange(Options); 
```

这两个都给了我一个 System.ArgumentException：目标数组不够长。

2）为什么这些方法中的任何一种都会给我这个例外？

任何帮助将不胜感激，因为我很难过。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:46:18.800

确保在迭代时没有其他线程正在更改集合。

此外，另一种方法是：

```
return string.Join(", ", options.Where(
    op => op.OptionStatus == ExtendedResponse.OptionState.Included)); 
```

在这种情况下，这比使用 StringBuilder 更好并且（令人惊讶地）更快。

尽管如此，这并不能解决您的问题 - 这可能是由更改集合的不同线程引起的。

我的第一次尝试是：

```
private static string CreateOptionString(List<VehicleOption> Options)
{
    lock (Options)
    {
        return string.Join(", ", options.Where(
            op => op.OptionStatus == ExtendedResponse.OptionState.Included));
    }
} 
```

但是，当然，如果我们有任何关于其他线程与该集合混在一起的信息，那么提供更好的线程安全解决方案会更容易。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T22:46:06.087

听起来好像引用的列表对象`Options`正在被另一个线程更改。这将解释这两个问题。

1.  显然，如果另一个线程在您迭代列表时更改了它，您会看到“集合已修改”异常，因为在枚举其元素时您无法更改列表。
2.  在后一种情况下，它听起来像构造函数并且`AddRange`正在分配数组，然后从提供的枚举中填充它。如果列表在分配和枚举以填充新数组之间增长，突然分配的存储空间不够大，您会看到这种行为。

您需要设计一些锁定机制，以便此代码可以在处理元素或制作副本以供以后处理时阻塞可能正在写入列表的任何线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T16:27:22.740

好的，我最终解决了这个问题。我在对方法的调用周围加了一个锁（在选项列表上）。这解决了我所有的问题。

感谢大家！

# client-server - 在 Microsoft IDL 中生成存根

> ID：11005901
> 
> 赞同：1
> 
> 时间：2012-06-12T22:40:39.937
> 
> 标签：client-server, rpc, idl

在 Microsoft IDL 中提供接口

```
[
    uuid(04802821-F237-486D-BC90-B6BB048DC8B2),
    version(1.0)
]
interface RPC
{
    void foo([in, string] char * string)
} 
```

生成的存根和头文件是 rpc_c.c、rpc_s.c 和 rpc_h.h。在头文件 rpc_h.h 中声明函数 foo

```
void foo( char * string ); 
```

在 rpc_c.c 中自动定义客户端版本

```
void foo( char * string)
{
    NdrClientCall(...);
} 
```

但是现在我想在同一个程序中实现客户端和服务器以进行测试，这应该会出现

```
#include "rpc_h.h"
#include "rpc_c.c"
#include "rpc_s.c"

/*server foo*/

void foo(char * string)
{
    printf("%s\n", string);
}

/*server*/

void server()
{
    //RpcServerRegisterIfEx(...);
    //RpcServerUseProtseqEp(...);
    //RpcServerListen(...);
}

int main(int args, char * argv[])
{
    /*server runs*/

    CreateThread(NULL, 0, server, argv[1], 0, NULL);

    /*make RPC as client*/

    foo(argv[2]);
} 
```

如您所见，客户端和服务器 foo 的重新定义肯定存在错误。所以我不得不手动将 rpc_c.c 中的客户端 foo 重命名为

```
void foo_client( char * string)
{
    NdrClientCall(...);
} 
```

并在 rpc_h.h 中与服务器版本一起声明

```
void foo_client( char * string );
void foo( char * string ); 
```

因此，当我在 main 中将 RPC 作为客户端时，我会

```
foo_client(argv[2]); 
```

它可以解决，但看起来有点hacky。有没有一个体面的解决方案呢？

**PS：对于可能关心的人，我使用纯系统RPC进行开发。它根本与 COM、COM+、DCOM 甚至面向对象无关。我正在开发一个基于 DHT 的点对点应用程序，所以我必须在同一个应用程序中实现客户端和服务器。对 com 和 dcom 标签感到抱歉，它们现在已被删除**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T13:38:18.817

不要在同一个应用程序中创建客户端和服务器。

在同一台机器上创建一个虚拟客户端应用程序。你只是让你的生活变得困难。

# c - 如何转换 到 使用 libxml（将空元素转换为开始-结束标记对）

> ID：11005902
> 
> 赞同：4
> 
> 时间：2012-06-12T22:40:40.610
> 
> 标签：c, xml, libxml2, canonicalization

在生成 XML 内容时，我得到一个空节点`<node/>`，我希望它是`<node></node>`. （由于`<node></node>`是 c14n 的正确形式，所以进度称为“将空元素转换为起始标签对”）

我应该如何转换它？

Jim Garrison（谢谢）暗示了一种方法来做到这一点，通过使用 xmlBufferCreate、xmlSaveToBuffer、xmlSaveDoc、xmlSaveClose 和 xmlSaveOption：XML_SAVE_NO_EMPTY

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:58:36.033

查看 libxml2 文档，特别是[xmlSaveOption](http://www.xmlsoft.org/html/libxml-xmlsave.html#xmlSaveOption)值`XML_SAVE_NO_EMPTY`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T00:52:32.467

我发现了另一种在控制下生成节点时更容易的方法，只需将值“”赋予节点。

# javascript - 如何制作一个按钮，当悬停在上面时，它会滑过并显示链接（JS）？

> ID：11005904
> 
> 赞同：1
> 
> 时间：2012-06-12T22:40:46.803
> 
> 标签：javascript, animation, button

谁能指导我在 JS 中创建一个简单的应用程序？

该应用程序是这样的：会有一个显示“主题”的按钮，当您将鼠标放在该按钮上时，它会滑到左侧，显示两个链接（链接会显示“浅色”和“深色”） .

我对JS没有那么经验，所以有人可以帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:56:12.530

这是一个滑动覆盖的示例：http: [//jsfiddle.net/vWpmT/3/](http://jsfiddle.net/vWpmT/3/)

这是一个挤压覆盖直到没有宽度的例子：http: [//jsfiddle.net/vWpmT/2/](http://jsfiddle.net/vWpmT/2/)

它需要 jQuery。给出的 CSS 是除了背景颜色之外的最低要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:58:30.900

啊，你打败了我：http: [//jsfiddle.net/5Ls9y/](http://jsfiddle.net/5Ls9y/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T23:04:53.713

这是一个带有纯 CSS 转换的版本[http://jsfiddle.net/69z3y/](http://jsfiddle.net/69z3y/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-13T00:45:48.307

此方法使用纯**JavaScript 动画引擎**，以几种方式模仿 jQuery 动画！

参考： [**jsFiddle Demo**](http://jsfiddle.net/xHJd7/)

jsFiddle 只展示了众多原生 JavaScript 动画中的 1 个。

有关可以使用的动画示例的完整列表以及相关教程，请查看 HTML 评论部分中的链接以获取更多信息。

如需**灵感**，请查看此 webkit CSS3 滑动[**演示和**](http://www.zurb.com/playground/sliding-vinyl)专辑中唱片的教程。

**状态更新：**如果您的 Button 是图像，那么这[**5 个用于 CSS3 浏览器的演示**](http://tympanus.net/Tutorials/3DHoverEffects/)很好。

# excel - 从外部主表更新工作簿的现有结构化表？

> ID：11005905
> 
> 赞同：0
> 
> 时间：2012-06-12T22:41:02.920
> 
> 标签：excel, vba

**目前：** 我有几张包含一个或多个表格的表格（例如，Sheet1 有一个表格，而 Sheet2 有三个表格）。在多个最终用户工作簿中都可以找到这些相同的工作表。这些工作表中的表格供工作簿中单元格公式中的结构化引用使用。

**目标：** 我想要另一个工作簿（主工作簿），其中只有包含表格的工作表。将手动对主工作簿进行更新，即添加一行、删除一行、编辑一行、添加一列、删除一列、编辑一列。 *使用主工作簿完成更新后，更新后的 [主] 工作表将被放置到各种用户工作簿中，替换现有工作表和表格（使用 VBA）......而不会破坏结构化引用！没有#REF 错误！* 嗯，这就是我所设想的，但是，它不必完全是这样。此外，公用表必须在最终用户工作簿中，不能外部引用！除非它是使我需要工作的过程的一部分，当然:-)

我对 VBA 非常方便，但不是 MVP。假设所有工作簿（最终用户和主用户）都存在于同一目录中。主工作簿将包含将更新的工作表传递给最终用户工作簿的代码。Windows 7 环境中的 Excel 2007 和 2010。

我没有任何代码，因为我试图先手动找出它而不破坏任何东西。欢迎提出建议！谢谢你。

* * *

**[更新 13Jun2012]**希望这个更冗长的解释会有所帮助。

**我在做什么：** 我有一个工作簿（基本上）将自身复制到最终用户工作簿中（基于用户表单输入的 1 到 n 次）。最终用户工作簿受到保护，以防止最终用户在某些公式中出错（各种形式的工作表/单元格保护）。有些工作表包含表格，这些表格对所有用户都是相同的。这些表用于数据验证（例如，允许：列表；来源：=timing_droplist）和 VLOOKUP（例如，=VLOOKUP($W8,Timing_table,FE$5+1,FALSE)）。这些最终用户工作簿每年创建一次，但在一年中更新了三次（它们用于财务/预算）。表格可以随时更新。由于数据被添加到最终用户工作簿中，因此使用更新的表重新生成这些工作簿然后让最终用户重新输入他们的所有数据是不方便的。

**发生了什么（仅一个示例）：** “Timing”表存在并包含表“Timing_table”。如果将主“Timing”表添加到工作簿，Excel 会将其重命名为“Timing (2)”。这个是正常的。但是添加的工作表中的表*变成了本地而不是全局*表，并且它也被重命名，例如，“Timing_table12”。我不知道 Excel 是如何得出表名的数字的，它们可能会改变。如果我删除旧的“计时”表，所有对它的引用都会被破坏（当然）——拉起名称管理器会显示#REF！在值列中。重命名新引用并不能解决问题，因为新引用在新工作表中是本地的。

我尝试手动将一个表格剪切并粘贴到另一个表格中，粘贴为文本，但这不保留公式（基本上它执行粘贴为值操作），总的来说，不起作用。只是在寻找选项。对这些表的外部引用不是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T07:47:41.863

我认为这个线程可能会帮助你：[http ://www.ozgrid.com/forum/showthread.php?t=66791](http://www.ozgrid.com/forum/showthread.php?t=66791)

直接给你回复（假设问题主要涉及外部引用）： Aaron Blood 回复： Re: Copy Formula To New Worksheet without Path

您已经开发了复制/粘贴到新工作表和工作簿的代码。现在您需要做的就是扫描新工作表的公式并从公式中删除 ext refs。

在现有的复制/粘贴宏的末尾运行类似的东西......

VB：

```
Sub ExtRef_Remover() 

Dim cell As Range, n As Variant 

For Each cell In Workbooks("New_WB").Sheets("Sheet1").Cells.SpecialCells(xlFormulas) 
    n = Application.Find("]", cell.Formula) 
    If Not IsError(n) Then 
        cell.Formula = "='" & Right(cell.Formula, Len(cell.Formula) - n) 
    End If 
Next cell 
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T14:30:01.640

使用广泛的外部参考在这个项目中没有奏效，所以我说服项目经理我们需要改变路线。她同意，除了影响工作簿的生成和稳定性之外，她想要的要求太多，实施起来也花费了太多时间。我最终通过命令按钮将数据拉入必要的表中。Waaaay 更易于使用且稳定。

# javascript - 使用 javascript 替换 HTML 值

> ID：11005909
> 
> 赞同：-2
> 
> 时间：2012-06-12T22:41:09.130
> 
> 标签：javascript

我在 HTML 中有以下代码，并想使用 javascript 替换它们

原始代码

```
<td class="tabButton dijitHidden tweetsTabButton selectedTab" dojoattachpoint="tweetsTabButton" data-type="twitter" style="display: none;">
Tweets
<div class="arrow-up"><div class="arrow-up-content"></div></div>
</td> 
```

将其替换为

```
<td  dojoattachpoint="tweetsTabButton" data-type="twitter" style="display: none;">
<h2>Tweets</h2>

</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T00:06:46.343

这是另一种方法：

```
//index [0] assumes you want to modify the first td matching this set of class rules..
var td = document.getElementsByClassName("tabButton dijitHidden tweetsTabButton selectedTab")[0];

//remove the attributes, as requested
td.removeAttribute('class');
td.removeAttribute('dojoattachpoint');

//sets the innerHTML of the element, overwriting the original one
td.innerHTML = '<h2>Tweets</h2>'; 
```

请注意，`td`仍然会`display:none`使其不可见，您可以添加：

```
td.style.display = "table-cell"; 
```

使其动态可见。不要忘记在 DOM 准备好/加载后运行脚本。

[**JSFiddle**](http://jsfiddle.net/ult_combo/Lfxur/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T23:48:27.400

根据问题内容和当前出现的评论，您需要：

1.  `Tweets`用元素包装文本，特别是`<h2></h2>`
2.  从 中删除`class`属性`td`以禁用 CSS
3.  使用纯 JavaScript
4.  假设`table` `ID`礼物并使用`data-type`属性作为验证！

请参阅此[工作小提琴](http://jsfiddle.net/zuul/Bcb7r/)示例！

**脚本**

```
// get the table by ID
var table = document.getElementById("table-id");   

// get the table cells
var cells = table.getElementsByTagName("td");   

// for each table cell found
for (var i = 0; i < cells.length; i++) {   

    // get the attribute 'data-type'
    var status = cells[i].getAttribute("data-type");

    // if 'data-type' contains the value 'twitter'
    if ( status == "twitter" ) {   

        // create the 'h2' element
        var h2 = document.createElement("h2");

            // append a textnode to the created element with the text 'Tweets'
            h2.appendChild(document.createTextNode('Tweets'));

        // remove the current text 'Tweets'
        cells[i].removeChild(cells[i].firstChild);

        // remove the class atrribute
        cells[i].removeAttribute('class');

        // append the new element to the current 'td'
        cells[i].appendChild(h2);
    }  
} 
```

**注意：**可以进行优化，但您可以看到正在发生的事情。还有评论可以指导您完成，在生产时删除。

# android - 以编程方式获取片段父视图的大小以调整子视图的大小

> ID：11005916
> 
> 赞同：0
> 
> 时间：2012-06-12T22:42:03.620
> 
> 标签：android, view, fragment

我有一个包含片段的布局。我将布局的宽度设置为 300dip。

我想以编程方式计算与父级 300dip 相关的子级宽度。

我不能在 XML 中做到这一点，因为它有一些“技巧”并且使用重量或相对布局将不起作用，我必须使用数学。

这是包含布局的片段...

```
<LinearLayout 
    android:layout_width="300dip"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    >

    <fragment
        android:id="@+id/tabbar"
        android:name="com.test.MyFragment"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
</LinearLayout> 
```

在 MyFragment 中有方法：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    Log.d("test", "container: "  + container);
    View view = inflater.inflate(R.layout.mylayout, container, false);
    Log.d("test", "view width: "  + view.getWidth());

    //do things with view

    return view;
} 
```

我得到输出 container: null 和 view width: 0 并且我在片段或类似中找不到任何 onMeasure 方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:55:01.497

`onCreateView`在您的布局膨胀之前调用，因此它们没有`height`or `width`。如果您想摆弄布局和`views`绘制方式，您可以创建自己的视图、扩展`View`和实现`onLayout()`；如果你谷歌，有很多这样的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T00:06:55.313

我认为您可以在 onActivityCreated 方法中以编程方式找到父视图（LinearLayout）的尺寸：

```
@Override 
public void onActivityCreated(Bundle savedInstanceState){
     super.onActivityCreated(savedInstanceState);

     myActivityView =  (LinearLayout)  
             getActivity().findViewById(((View) getView().getParent()).getId());

     myFragment = (RelativeLayout) getView().findViewById(R.layout.mylayout);
//Change RelativeLayout to whatever your fragment is using
} 
```

那么 myActivityView 应该是你的父视图。

**编辑**

然后，您可以在 onActivityCreated 中使用[ViewTreeObserver](http://developer.android.com/reference/android/view/ViewTreeObserver.html)来获取父视图的尺寸。myFragment 应该是您的片段，因此您可以相对于从 myActivityView 返回的尺寸放置它。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-30T08:36:54.287

使用 Handler 将获得高度和宽度。但这不是正确的方法。

```
new Handler().postDelayed(new Runnable() {
      @Override
      public void run() {
         Log.d("test", "view width: "  + view.getWidth());
      }
    },1000); 
```

# javascript - 不使用 jquery 通过索引选择元素

> ID：11005922
> 
> 赞同：1
> 
> 时间：2012-06-12T22:42:28.457
> 
> 标签：javascript

我只有这个无用的代码：

```
document.getElementsByClassName('dynamic_area').index(input+4); 
```

我的错误是什么？

重要的：

*   不要使用 jQuery，

*   `input`是一个变量

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T22:43:59.410

只需使用常规数组索引：

```
document.getElementsByClassName('dynamic_area')[input + 4]; 
```

这是小提琴：http: [//jsfiddle.net/eYmXE/](http://jsfiddle.net/eYmXE/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:47:28.503

如果您想使用一种方法，请更改`.index`为`.item`...

```
document.getElementsByClassName('dynamic_area').item(input+4); 
```

[http://jsfiddle.net/FfMJz/](http://jsfiddle.net/FfMJz/)

# .net - 当我的项目嵌入另一个项目时访问它的图像

> ID：11005924
> 
> 赞同：0
> 
> 时间：2012-06-12T22:42:33.520
> 
> 标签：.net, wpf, xaml, binding, prism

我有以下情况：

*   ProjectA 需要在`UserControl`.
    它在其项目中有图像（可以是资源或其他）。

*   但 ProjectA 只是一个 dll。ProjectB（通过 Prism）使用它。

因此，在 ProjectA 中执行此操作适用于**设计时间**（如果 MyImage.png 文件设置为“资源”编译操作）：

```
<Image Source="pack://application:,,,/ProjectA;component/MyImage.png"></Image> 
```

但是在运行时，复制到 ProjectB 的所有内容都是 dll（这就是我想要复制的所有内容。所以 MyImage.png 存在于运行文件夹中......并且它不显示图像。

我认为 Make it Resource 会嵌入它，但它似乎不起作用。

我还尝试使用 Resources.resx，但这似乎根本不起作用（或者我找不到在 xaml 中绑定图像的方法）。

**如何将图像放在我的 dll 中，然后从那里引用它（或其他一些非文件系统依赖的方式来获取图像）？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T04:38:11.373

我将一个带有 2 个项目的 WPF 应用程序放在一起，看看是否可以重现问题。不幸的是，这一切都奏效了。我使用了与您的帖子相同的包 uri 格式，并且能够直接在两个项目的图像控件中显示图片，并且当将“项目 A”中的用户控件放入项目 B 的窗口时，也可以显示图像。注意：我将图片设置为具有资源的构建操作并将其设置为“不复制”。

鉴于它在一个简单的场景中工作，我的下一个想法是问题是否与您使用 PRISM 的事实有关。我会看看，看看我能找到什么。

# google-apps - 获取调用服务的电子邮件的帐户详细信息

> ID：11005926
> 
> 赞同：0
> 
> 时间：2012-06-12T22:42:54.340
> 
> 标签：google-apps, google-apps-script

我的脚本上有一个已发布的服务。然后我将它传递给一封电子邮件，当有人单击服务 URL 时，可以从该电子邮件中调用脚本。我想获取调用服务的帐户的用户名。例如，假设调用服务的电子邮件的用户名是 example@account.com，我想将用户名“example”传递回脚本以进行进一步处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T23:49:56.300

除非这是 Google 消费者帐户，否则您不能这样做。如果是 Google Apps，请使用

`Session.getActiveUser()`

# asp.net - 用户输入和服务器/用户控制

> ID：11005935
> 
> 赞同：1
> 
> 时间：2012-06-12T22:43:56.243
> 
> 标签：asp.net, sharepoint, user-controls, web-parts, servercontrols

在创建应用程序页面或 Web 部件时，我偶尔会发现我的页面周围的多个位置都有相同的几个下拉列表和标签。

```
Application Page
 _____________________
| lbl ddl    lbl dll  |
| lbl ddl    lbl ddl  |
|                     |
| lbl ddl    lbl dll  |
| lbl ddl    lbl ddl  |
----------------------- 
```

最初，我会采用其中的一个实例，例如 2 个标签和 2 个下拉控件，然后在 ascx 文件中对其进行模拟，将其称为用户控件（包含后面的代码），然后将其粘贴到我的主应用程序中多个位置的页面。

```
Application Page
 _____________________
| user        user    |         User Control
| control    control  |          ___________
|                     |          | lbl ddl |
| user        user    |          | lbl ddl |
| control    control  |          -----------
----------------------- 
```

**问题** 最近，有人告诉我，如果每个用户控件中显示的下拉列表或标签等的数量是动态的，那么我应该使用服务器控件而不是用户控件。

但我似乎无法做到这一点！在服务器控件中，似乎没有 html 模型，因此您只有代码可以使用。我不知道如何存储用户输入，或将用户输入从生成的代码移到后面的代码中。

**那么这是否意味着服务器控件仅用于创建单独的控件，例如 MySpecialTextBox？还是我完全错了？** （有没有人可以查看一个好的、复杂的示例项目？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T23:58:14.787

> 我不知道如何存储用户输入，或将用户输入从生成的代码移到后面的代码中。

此下拉控件的用户输入总是在回发时出现。总有一种简单的方法可以通过 获取它们`Request.Form`，因此您可以使用以下命令获取用户输入：

```
Request.Form[Control.UniqueID] 
```

因此，您只需在控件上添加唯一名称，并在回发时记住/知道/重新创建该名称以获得回发值。

# c# - 编译时出现“Microsoft 资源文件到 COFF 对象转换实用程序已停止工作”错误

> ID：11005939
> 
> 赞同：2
> 
> 时间：2012-06-12T22:44:35.370
> 
> 标签：c#, resources, coff

由于我不知道的原因，我最近在编译我的 C# 应用程序时遇到了一个错误，它只是声明

“ `Microsoft Resource File to COFF Object Conversion Utility has stopped working`”。

在错误列表中，总是出现一个错误说

“ `'[project folder]\obj\x86\Debug\CSC[random number].tmp' is not a valid Win32 resource file`”。

在过去的一个小时里，我一直在用谷歌搜索这个问题，而任何人想出的唯一实际解决方案就是`sfc /scannow`在提升的命令提示符下运行。好吧，它对我来说没有发现任何损坏，而且这里似乎没有任何问题。我希望有人能给我一个解决这个问题的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T13:32:06.513

我正在使用 VS C++，但有一个非常相似的错误，不确定您使用的是什么。
我也在网上搜寻修复程序，最终做到了（我应该早点做）是**对 VS C++ SP1 的更新**。
希望这适用于您并有所帮助。

# sql - 为什么 Wordpress 有单独的 'usersmeta' 和 'users' SQL 表。为什么不把它们结合起来？

> ID：11005941
> 
> 赞同：2
> 
> 时间：2012-06-12T22:44:54.520
> 
> 标签：sql, wordpress, query-optimization

除了 users 表，Wordpress 还有一个 usersmeta 表，其中包含以下列

*   meta_id
*   用户身份
*   meta_key（例如 first_name）
*   元值（例如汤姆）

每个用户在 usersmeta 表中有 20 行，不管这些行是否有填充的 meta_value。也就是说，将始终存在的元行添加到 users 表不是更有效吗？

我猜测 users 表中的信息被查询得更频繁（例如 user_id、username、pass），因此保持这些行更小更有效。这是真的？这种表格分离还有其他原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T15:03:18.457

## 实体属性值

它被称为[实体属性值](http://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model)(EAV) 数据模型，允许将任意数量的属性分配给给定实体。这意味着每个用户有任意数量的元数据条目。

## 为什么使用它

默认情况下，wordpress 设置了几个键（问题中说明了 20 个），但可以有任意数量。如果所有用户都有一千个元数据条目 - 每个用户的 usermeta 表中只有一千个条目 - 它没有（就数据库结构而言）用户可以拥有的元数据条目数量的限制. 它还允许一个用户拥有一千个元数据整体，而所有其他用户拥有 20 个并且仍然有效地存储数据 - 或其任何排列。

除了灵活性之外，使用这种结构还允许主用户表保持较小 - 这意味着更有效的查询。

## 备择方案

使用 EAV 的替代方法包括：

*   每当属性数量发生变化时修改架构
*   将所有属性存储在序列化字符串中（在用户对象上）
*   使用无模式数据库

权限是第一点的最大问题，授予全面访问权限以更改数据库表的架构并不是一个好主意，并且对于许多（如果不是大多数）wordpress 安装（托管在 wordpress.com 或在 db 用户没有更改权限的共享主机上）。Mysql 也有[4096 列和每行 65,535 字节](http://dev.mysql.com/doc/refman/5.6/en/column-count-limit.html)的硬限制。尝试在单个表中存储大量列最终将失败，同时创建查询效率低下的表。

将所有属性存储在序列化字符串中会使通过元数据值查询变得困难且缓慢。

Wordpress 与 mysql 密切相关，因此更改数据存储不是一个现实的选择。

## 更多 WP 信息

If you aren't using any/many plugins it's possible you will have a constant number of rows in the usermeta table for each user, but typically each plugin you add may need to add meta-data for users; the number added may not be trivial and this data is stored in the usermeta table.

The docs for [add_meta_user](http://codex.wordpress.org/Function_Reference/add_user_meta) may add some clarity as to why the database is structured that way. If you put code like this somewhere:

```
add_user_meta($user_id, "favorite_color", "blue"); 
```

It will create a row in the usermeta table for the given user_id, without the need to add a column (favorite_color) to the main users table. That makes it easy-ish to find users by favorite color without the need to modify the schema of the users table.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T14:42:57.960

这确实是一个关于数据库规范化的问题。您可以在许多地方查找有关该主题的信息。

**基本答案**由于有大量关于此的文献，并且存在很多差异，因此我将仅举一些示例说明为什么会发生这种情况-归结为权衡取舍；速度与存储要求，或易用性与数据复制。效率是多维的，由于 wordpress 做了很多不同的事情，可能有各种原因将它们分开 - 空间可能是一个问题，查询速度可能取决于此，可能更容易只查看元表而不是出于某些目的使用整个表格，反之亦然。

**进一步阅读**这是一个很深的话题，你可能想了解更多——关于这些问题有数百本书和数千篇学术论文。例如，看看之前关于设计数据库的 SO 问题： [数据库设计：一个巨大的表还是单独的表？](https://stackoverflow.com/questions/2766334/database-design-one-huge-table-or-separate-tables)，或者这个：[第一次数据库设计：我是否过度设计？](https://stackoverflow.com/questions/2320633/first-time-database-design-am-i-overengineering) 或About.com 上的[数据库规范化基础知识 。](http://databases.about.com/od/specificproducts/a/normalization.htm)

# iphone - 如何在objective-c中现有字符串的开头添加一个字符？

> ID：11005944
> 
> 赞同：0
> 
> 时间：2012-06-12T22:45:25.977
> 
> 标签：iphone, objective-c, ios, xcode, ios5

如何在现有字符串的开头添加单个字符，例如 ' `$`' 或 ' '？`+`

我尝试使用 appendingString 方法，但是在字符串的末尾添加了`$`or 。`+`

我知道我总是可以将`$`or保存`+`在一个新字符串中，然后附加另一个字符串，但我只想知道是否有更好的方法来做到这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T23:25:08.980

这实际上非常简单：

```
[@"+" stringByAppendingString:existingString]; 
```

这肯定对你有用:) 并且`+`会在一开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T22:48:34.080

字符串是不可变的。您在使用时正在创建一个新字符串`stringByAppendingString:`为了预先添加，您必须制作现有字符串的可变版本，然后[`insertString:atIndex:`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableString_Class/Reference/Reference.html#//apple_ref/doc/uid/20000156-insertString_atIndex_)像这样使用：

```
[[NSMutableString stringWithString:myString] insertString:@"$" atIndex:0]; 
```

为什么没有`stringByPrependingString:`，我不知道。

最好的解决方案是您已经提到的那个：

```
[@"$" stringByAppendingString:myString]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T22:47:48.050

只要字符串是可变的，即你可以使用它是一个 NSMutableString。

```
[str insertString:@"$" atIndex:0]; 
```

在这里阅读文档，[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsmutablestring_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsmutablestring_Class/Reference/Reference.html)

# php - Zend_Cloud_Storage 如何将文件发送到浏览器？

> ID：11005945
> 
> 赞同：0
> 
> 时间：2012-06-12T22:45:44.370
> 
> 标签：php, zend-framework, file-io, cloud, cloud-storage

我想将我的资产存储在云中。我认为 Zend_Cloud_Storage 可能是正确的库？现在它们使用 Zend_Cloud_StorageService_Adapter_Filesystem 保存在本地。上传作品到目前为止。

将文件从 Zend_Cloud_StorageService_Adapter_Filesystem 发送到浏览器的正确方法是什么？我想这只有通过 php 流式传输才能实现？如果是的话，任何代码示例都在那里，因为我无法让它与所有文件头一起工作。

使用 S3 我可能会进行重定向或直接将文件链接到 s3 存储桶？

我对云存储还很陌生，所以非常感谢您的帮助。

亲切的问候，曼努埃尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T01:32:54.067

Zend Cloud 服务相当新，根据我的经验，文档仍然需要一些工作。根据云服务，您可以选择获取对象并将其交付给用户，或者在某些情况下，您可以为用户提供资产的直接 URL（这在很大程度上取决于您是否需要控制对对象的访问）。

要以编程方式获取项目，您应该能够使其与正确的标题一起使用，例如：

```
$image = $storage->fetchItem("/my/remote/path/picture.jpg");
header("content-type: image/jpg");
echo file_get_contents($image); 
```

理论上，您可以从元数据中获取标头的内容类型，但我不确定适配器之间是否一致。

直接链接取决于您的云。对于文件系统，您应该知道文件所在的路径，因此如果可以访问它们，您可以从那里链接。在 Amazon 中，您可以在上传文件时将权限设置为 public - S3 doco 中有一个示例[here](http://framework.zend.com/manual/en/zend.service.amazon.s3.html#zend.service.amazon.s3.objects)。

我建议看一下[Zend Service S3](http://framework.zend.com/manual/en/zend.service.amazon.s3.html) doco，Zend Cloud 只是它的一个包装器，并且在尝试通用时它失去了很多功能。如果您长时间使用它，我怀疑您最终会直接调用该服务。

祝你好运！

# objective-c - 自定义 NavigationBar iOS 5 兼容性

> ID：11005947
> 
> 赞同：0
> 
> 时间：2012-06-12T22:45:47.317
> 
> 标签：objective-c, ios5, xcode4.2

我试图用自定义导航栏实现一个项目；但是，以下代码：

```
@implementation UINavigationBar (CustomImage)

// Set the navigation bar background
- (void)drawRect:(CGRect)rect {
    UIImage *image = [UIImage imageNamed:@"TopBar.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height + 1)];
}
@end 
```

不适用于 iOS 5。我使用的是 Xcode 4.2。

问题：如何在不影响使用上述代码的早期版本（< iOS 5）的情况下实现自定义导航栏？

任何帮助，将不胜感激。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T22:48:18.753

我终于明白了……这可能有助于其他人实现这一点。

```
@implementation UINavigationBar (CustomImage)

// Set the navigation bar background
- (UIImage *)barBackground{
    UIImage *image = [UIImage imageNamed:@"TopBar.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height + 1)];
    return image;
}

- (void)didMoveToSuperview{
    // Applies to iOS 5
    if ([self respondsToSelector:@selector(setBackgroundImage:forBarMetrics:)])
    {
        [self setBackgroundImage:[self barBackground] forBarMetrics:UIBarMetricsDefault];
    }
}

// This doesn't work on iOS5 but is needed for iOS4 and earlier
- (void)drawRect:(CGRect)rect
{
    // Draw the image
    [[self barBackground] drawInRect:rect];
}
@end 
```

# javascript - 使插件中的方法可以全局访问？

> ID：11005948
> 
> 赞同：0
> 
> 时间：2012-06-12T22:45:56.460
> 
> 标签：javascript, jquery

鉴于下面的 jQuery 下拉插件。有没有办法添加一个允许下拉菜单之外的单独功能到“hideMenu”的方法？谢谢

例如，如果我将插件应用到具有如下 ID 的 div：

```
$('#settings.dropdown').dropDownMenu(); 
```

然后我怎么能从插件外部调用以关闭 dropDownMenu w hideMenu？谢谢

```
jQuery.fn.dropDownMenu = function() {

    // Apply the Dropdown
    return this.each(function() {

        var dropdown = $(this),
            menu = dropdown.next('div.dropdown-menu'),
            parent = dropdown.parent();

        // For keeping track of what's "open"
        var activeClass = 'dropdown-active',
            showingDropdown = false,
            showingMenu,
            showingParent,
            opening;

        // Dropdown Click to Open
        dropdown.click(function(e) {

            opening = true; // Track opening so that the body click doesn't close. This allows other js views to bind to the click
            e.preventDefault();

            if (showingDropdown) {
                dropdown.removeClass(activeClass);
                parent.removeClass(activeClass);
                showingMenu.hide();
                showingDropdown = false;
            } else {
                showingDropdown = true;
                showingMenu = menu;
                showingParent = parent;
                menu.show();
                dropdown.addClass(activeClass);
                parent.addClass(activeClass);
            }
        });

        // When you click anywhere on the page, we detect if we need to blur the Dropdown Menu
        $('body').click(function(e) {       
            if (!opening && showingParent) {
                var parentElement = showingParent[0];

                if (!$.contains(parentElement, e.target) || !parentElement == e.target) {
                    hideMenu();
                }
            }

            opening = false;

        });

        // hides the current menu
        var hideMenu = function() {
            if(showingDropdown) {
                showingDropdown = false;
                dropdown.removeClass(activeClass);
                parent.removeClass(activeClass);
                showingMenu.hide();
            }
        };

    });

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T22:54:00.453

jQuery 建议通过插件本身提供多种方法：

```
jQuery.fn.dropDownMenu = function(method) {

    var methods = {
        init: function() {
            // Put all your init code here
        },
        hide: function() {
            hideMenu();
        }
    };

    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist on jQuery.tooltip' );
    }

    function hideMenu() {
        // ...
    }

}; 
```

请参阅[http://docs.jquery.com/Plugins/Authoring#Plugin_Methods](http://docs.jquery.com/Plugins/Authoring#Plugin_Methods)

**更新：**像这样使用：

```
// Use the plugin normally to run the init method
$('#settings.dropdown').dropDownMenu();

// Call the hide method
$('#settings.dropdown').dropDownMenu('hide'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T22:48:39.500

当然。给`hideMenu`全局窗口对象，如下所示：

```
 window["hideMenu"] = function() {
        if(showingDropdown) {
            showingDropdown = false;
            dropdown.removeClass(activeClass);
            parent.removeClass(activeClass);
            showingMenu.hide();
        }
    }; 
```

然后，您可以在需要的任何地方照常调用它。

# java - 是否有必要从应用程序的 main 方法切换到 Swing 线程？

> ID：11005950
> 
> 赞同：5
> 
> 时间：2012-06-12T22:46:12.833
> 
> 标签：java, swing, thread-safety

在我的`main(String[] args)`方法中，除了调用在 Swing 线程上`SwingUtilities.invokeAndWait`运行方法外，我什么都没有。`main1`我一直认为我需要这个来保证线程安全。有人告诉我这不是必需的，因为执行任何 GUI 代码的第一个线程*成为*GUI 线程。或者换一种说法，你只能从一个线程中使用 Swing，但不管是哪个线程。但我找不到这方面的来源，我想确定一下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T23:05:33.877

你被告知的是错误的。该`main`方法最初将由主线程调用。所有与 GUI 相关的活动都必须在称为*Event Dispatch Thread*的完全独立的线程上执行。主线程**不会**成为 EDT。

一个很好的例子来看看我在说什么：

```
public class ThreadTest {
    public static void main(String[] args) {
        final Thread main = Thread.currentThread();
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                Thread edt = Thread.currentThread();

                System.out.println(main);
                System.out.println(edt);
                System.out.println(main.equals(edt));
            }
        });
    }
} 
```

# html - 为什么浮动元素在使用宽度时不能并排对齐？

> ID：11005954
> 
> 赞同：4
> 
> 时间：2012-06-12T22:46:25.830
> 
> 标签：html, css

我在下面有以下代码，但是如果我对其应用宽度属性，为什么 div 元素会`rightnav`出现在 div 元素下方，我对此感到困惑。`leftnav`我做错了什么或者我误解了浮动的使用？

**代码**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTMl 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="content-language" content="en-us" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <meta name="copyright" content="&copy; 2012" />

    <title>DIV example</title>

    <base href="" />

    <link rel="stylesheet" href="" />

    <style type="text/css">

    * {
        margin: 0px;
        padding: 0px;
        font-family: Arial, Verdana, sans-serif;
        font-size: 100%;
    }

    #content {
        width: 700px;
        margin-top: 20px;
        margin-right: auto;
        margin-bottom: 0px;
        margin-left: auto;
    }

    #leftnav {
        float: left;
        width: 200px;
        border-width: 1px;
        border-color: #000000;
        border-style: solid;
    }

    #rightnav {
        border-width: 1px;
        border-color: #000000;
        border-style: solid;
    }

    </style>
</head>
<body>
    <div id="container">
        <div id="content">
            <div id="leftnav">left nav</div>
            <div id="rightnav">right nav</div>
        </div>
    </div>
</body>
</html> 
```

**输出**

![在此处输入图像描述](../Images/40a23337d01009ad1d48b95b5a85de01.png)

`width`现在，如果我通过将属性应用于声明来修改代码如下`rightnav`，则该元素将出现在下面`leftnav`。我认为这可能与 div 元素的宽度有关，`content`但是两个 div 元素的组合有足够的宽度，即 200px + 200px < 700px

**代码**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTMl 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="content-language" content="en-us" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <meta name="copyright" content="&copy; 2012" />

    <title>DIV example</title>

    <base href="" />

    <link rel="stylesheet" href="" />

    <style type="text/css">

    * {
        margin: 0px;
        padding: 0px;
        font-family: Arial, Verdana, sans-serif;
        font-size: 100%;
    }

    #content {
        width: 700px;
        margin-top: 20px;
        margin-right: auto;
        margin-bottom: 0px;
        margin-left: auto;
    }

    #leftnav {
        float: left;
        width: 200px;
        border-width: 1px;
        border-color: #000000;
        border-style: solid;
    }

    #rightnav {
        width: 200px;
        border-width: 1px;
        border-color: #000000;
        border-style: solid;
    }

    </style>
</head>
<body>
    <div id="container">
        <div id="content">
            <div id="leftnav">left nav</div>
            <div id="rightnav">right nav</div>
        </div>
    </div>
</body>
</html> 
```

**输出**

![在此处输入图像描述](../Images/18f31c0baf2b293274f140071d0ea820.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T23:32:52.427

在您的第一个示例中，#rightnav 不是浮动的，但它保持在右侧，因为它没有`clear:left;`规则。见这里：http: [//jsfiddle.net/5sHdg/](http://jsfiddle.net/5sHdg/)

在您的第二个示例中，当您为#rightnav 指定宽度时，浏览器对 div 的大小有一个明确的规则，因此它将其呈现为块元素应该。但它不会在#l​​eftnav 旁边浮动，因为它缺少`float:left;`规则。见这里：http: [//jsfiddle.net/Br4Lm/](http://jsfiddle.net/Br4Lm/)

所以请记住：

1.  `div`在每个需要定位的地方都使用浮点数，从而覆盖它的块元素外观。
2.  如果您希望`div`在 div 下方有一个重新浮动的元素，请务必包含`clear:both;`( `left`、`right`或`both`)；

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T23:26:41.213

添加`overflow: hidden`到`#rightnav`将解决您的问题。[http://jsfiddle.net/Wexcode/gCVaz/](http://jsfiddle.net/Wexcode/gCVaz/)

可以在此处找到有关此工作原理的解释：http: [//colinaarts.com/articles/the-magic-of-overflow-hidden](http://colinaarts.com/articles/the-magic-of-overflow-hidden)

# jquery - Facebook jQuery 搜索脚本

> ID：11005957
> 
> 赞同：0
> 
> 时间：2012-06-12T22:46:45.370
> 
> 标签：jquery

我正在关注[本教程](http://www.9lessons.info/2009/06/autosuggestion-with-jquery-ajax-and-php.html)，但对于我的生活，我无法弄清楚如何使搜索结果可点击。

如果您按照脚本进行操作，您会看到他使用的`div`是搜索结果 ( `<div class="display_box" align="left">`)。

我在`<div class="display_box" align="left">`显示器内部使用了一个超链接，并且我设法解决了它，但我无法使用`.click(function () {`.

我无法捕捉到任何标签内的事件`<div class="display_box" align="left"> </div>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:56:00.403

这可能是因为在附加点击处理程序后链接被添加到 dom 中。您可以使用 jquery`on`方法，例如：

```
$('.display_box').on('click', 'a', function(){
  // your code here
}); 
```

此示例假定链接是`display_box`

# python - 没有名为 disutils 的模块

> ID：11005963
> 
> 赞同：1
> 
> 时间：2012-06-12T22:47:23.527
> 
> 标签：python

我正在尝试分发我编写的 python 模块。出于某种原因，我找不到 disutils 模块。我在哪里可以找到它？

```
Python 2.7.3 (v2.7.3:70274d53c1dd, Apr  9 2012, 20:52:43) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import disutils
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
ImportError: No module named disutils 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T22:48:42.537

该模块被称为`distutils`，而不是`disutils`。

# javascript - Javascript 在 Safari 中工作，但在 Chrome 或 Firefox 中不工作

> ID：11005964
> 
> 赞同：7
> 
> 时间：2012-06-12T22:47:24.463
> 
> 标签：javascript, firefox, google-chrome, javascript-events

我根本不是程序员，所以我很抱歉，但是在搜索网络后我找不到答案。

我正在尝试从[该网站](http://www.erikschevrolet.com/VehicleSearchResults?search=new&make=Chevrolet&modelId=33963&minYear=2012&maxYear=2012&cs%3aa%3ai=GM_Chevrolet-Showroom_HomePage-Chevrolet-Emblem_Hero-Image-Rotator)进行库存搜索并将其放在 Facebook 选项卡中。我从网站上获取了代码，并在 TextEdit 中编辑了我不想要的页眉和页脚。我只是想采取库存搜索部分。

当我在 Safari 中对其进行测试时，它似乎可以正常工作。库存搜索出现了，所有按钮和过滤器都运行良好，当我转到不同的页面时，页眉和页脚仍然消失了，只有库存搜索在那里——完美。

但是，在 Chrome 和 Firefox 中进行测试时，按钮和过滤器根本不起作用，您不能越过第一页或应用过滤器。

所以我决定去该网站（库存搜索的第一页，如上面的链接）并将源代码保存到我的桌面，看看我在 Chrome 或 Firefox 中打开它时是否可以工作，但它没有，没有按钮或过滤器起作用，卡在第一页。但它确实在 Safari 中工作。

这是什么意思？我现在应该放弃吗？我会包含代码，但这是我见过的最长的。我通过 TextEdit 对代码进行的所有测试。

**编辑**：
以下是 Chrome 中的错误：

Uncaught SyntaxError: Unexpected token < Chevy.html:4608 XMLHttpRequest cannot load [http://www.erikschevrolet.com/searchVehicles.ajax](http://www.erikschevrolet.com/searchVehicles.ajax)。Access-Control-Allow-Origin 不允许 Origin null。
未捕获的错误：XmlRenderEngine = >未知错误 bundle.js:1 XMLHttpRequest 无法加载[http://www.erikschevrolet.com/searchVehicles.ajax](http://www.erikschevrolet.com/searchVehicles.ajax)。Access-Control-Allow-Origin 不允许 Origin null。
未捕获的错误：XmlRenderEngine = >未知错误 bundle.js:1 XMLHttpRequest 无法加载[http://www.erikschevrolet.com/searchVehicles.ajax](http://www.erikschevrolet.com/searchVehicles.ajax)。Access-Control-Allow-Origin 不允许 Origin null。
未捕获的错误：XmlRenderEngine = >未知错误 bundle.js:1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T00:53:20.533

这些 Chrome 警告与此处无关。上面给出的错误是关于跨域问题的。由于可能导致从 Javascript 中访问远程资源的真正邪恶的事情，现代浏览器会阻止它们，除非明确允许。

例如，http://example.com 中的大部分内容[都](http://example.net)无法通过 http://example.net 域下的 javascript[访问](http://example.com)。由于您下载了大多数文件并尝试在本地运行它们，但其中一些文件仍然引用[http://www.erikschevrolet.com](http://www.erikschevrolet.com)域下的文件，因此不允许这样做。

AFAIK 没有一种非常简单的方法可以避免这个问题。最安全的解决方案是让您下载所有使用过的文件并手动更改对[http://www.erikschevrolet.com](http://www.erikschevrolet.com)的引用以及对本地路径的引用。或者，可以将 XMLHttpRequest 的 withCredentials 值设置为 true （但由于你不是程序员，你真的可以把它搞砸......）像这样（来自[http://hacks.mozilla.org/2009/07的示例/cross-site-xmlhttprequest-with-cors/](http://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/)）：

```
var request = new XMLHttpRequest();
var url = 'http://bar.other/resources/credentialed-content/';
function callOtherDomain(){
  if(request)
  {
   request.open('GET', url, true);
   request.withCredentials = "true";
   request.onreadystatechange = handler;
   request.send();
  }
} 
```

即使这样也可能不会得到预期的结果，因为很多这些文件可能是在服务器上动态生成的并且可能会发生变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T12:42:53.720

您似乎在使用特定加载文件方案读取 javascript 中的 xml 或文本文件时遇到问题。它发生在http请求工作的浏览器中，在这种情况下，您可以尝试使用javascript工作，

```
if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
    }
else
  {// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  } 
```

这将在 chrome safari firefox 上起作用，也可以试试这个。

# android - Android SlidingDrawer 中的组合处理程序

> ID：11005970
> 
> 赞同：1
> 
> 时间：2012-06-12T22:48:31.553
> 
> 标签：android, layout, slidingdrawer

我的问题如下：我想创建一个滑动抽屉，其中处理程序（滑动用于打开/关闭的视图）是一个组合视图，其中存在一个按钮，如下图所示：

![在此处输入图像描述](../Images/38619dd5791914bfbe45c9ed0032c524.png)

期望的行为是：

1.  当用户在处理程序中单击时，抽屉打开（按钮跟随视图，因为它附加在其上）；
2.  如果我点击按钮，系统会做出一些不同的事情（在我的例子中，我打开一个对话框，其中包含将视图添加为抽屉子项的选项）；

这种类型实现的主要问题是监听器发生冲突，因为按钮“+”是处理程序的一部分，不能在点击时创建覆盖的监听器。作为第一种方法，我正在考虑以编程方式完成所有这些，但我真的想知道是否有另一种简单的方法来进行这种布局。

有没有人可以给出提示，或者知道一种仅使用 xml 来实现它的方法？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T21:22:17.977

您可以使用*LinearLayout*作为 SlidingDrawer 容器的句柄或内容元素的容器。如下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">
    <SlidingDrawer android:id="@+id/drawer"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:onClick="showPopUp"
        android:handle="@+id/handle"
        android:content="@+id/content">
        <LinearLayout android:id="@id/content"
            android:layout_width="match_parent"
            android:layout_height="match_parent">
            <!-- here goes your content -->
        </LinearLayout>
        <LinearLayout android:id="@id/handle"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="#ffff5600"
            android:orientation="horizontal">
            <TextView android:layout_width="0dp"
                android:layout_height="match_parent"
                android:layout_weight="4"
                android:layout_gravity="left"
                android:text="musicas" />
            <Button android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:onClick="showPopUp"
                android:text="+" />
        </LinearLayout>
    </SlidingDrawer>
</LinearLayout> 
```

它允许您像上面的屏幕截图一样进行布局，但它不允许捕获按钮按下事件。为此，我进行了一些研究，并建议覆盖 MultiDirectionSlidingDrawer（来源[http://blog.sephiroth.it/2011/03/29/widget-slidingdrawer-top-to-bottom/](http://blog.sephiroth.it/2011/03/29/widget-slidingdrawer-top-to-bottom/)）。我这样做如下：在*onInterceptTouchEvent()*方法中，我添加了以下代码`final View handle = mHandle;`

```
 boolean handleTouch = false;
    if (mHandle instanceof ViewGroup) {
        ViewGroup group = (ViewGroup) mHandle;

        int count = group.getChildCount();
        for (int i = 0; i < count; i++) {
            View v = group.getChildAt(i);
            v.getHitRect(frame);
            if (frame.contains((int) x, (int) y)) {
                handleTouch = v.onTouchEvent(event);
                if (handleTouch) {
                    return false;
                }
            }
        }
    } 
```

现在它分别处理来自按钮和抽屉本身的事件。

# ios - IOS：在uitableview中跳转位置

> ID：11005978
> 
> 赞同：0
> 
> 时间：2012-06-12T22:49:17.020
> 
> 标签：ios, uitableview

在方法中

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

通常你使用一个数组来设置

```
[cell.textLabel setTex:@"row"]; 
```

但是如果我想跳一排呢？

例如在 indexpath.row 我不想在我的表格视图中有这个单元格，可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:53:54.453

试试这个：合并行高的 tableView 数据源方法。

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    if (indexPath.row == NUMBER_TO_AVOID) {
        return 0.0f;
    }
    return 44.0f; //standard cell height
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T12:53:32.233

我已经在几个类似的情况下这样做了。您要做的是创建第二个数组“activeItems”。或类似的东西。遍历您的主数据数组并使用有效项目构建活动数组。而不是让您的数据源引用此数组。这为您提供了一个准确索引到您的表的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T00:21:02.547

您可以在 cellForRowAtIndexPath 中放置一个条件。尝试这个：

```
data = [array objectAtIndex:indexPath.row];

If (data != nil){
    [cell.textLabel setText:data];
}
else{
    // code that handles data if null
} 
```

# iphone - 我的 Xcode 配置文件是否需要我的私钥才能在另一台 Mac 上使用？

> ID：11005980
> 
> 赞同：0
> 
> 时间：2012-06-12T22:49:50.517
> 
> 标签：iphone, ios, xcode, provisioning-profile

我真的需要从我的计算机中导出私钥并将其与配置文件一起传递给我的队友，以便他构建 IPA 文件吗？如果是这样，我从哪里获得私钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T22:56:56.610

是的，您确实需要导出它，从 Keychain Access 导出它。

这是它的外观截图： [http ://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12/keychain-access-3-export-private-key](http://www.raywenderlich.com/3443/apple-push-notification-services-tutorial-part-12/keychain-access-3-export-private-key)

# java - 文件未找到异常

> ID：11005983
> 
> 赞同：1
> 
> 时间：2012-06-12T22:50:10.687
> 
> 标签：java, filenotfoundexception

我在从存储库中签出的文件夹中有一堆文件。我有一个代码必须将文件从文件夹复制到另一个文件夹。我执行以下操作：

```
File f = new File(/* path of folder */);
File[] fs = f.listFiles();
for(int i=0; i<fs.length; i++){
        FileChannel in = new FileInputStream(fs[i]).getChannel();
        FileChannel out = new FileOutputStream(/* output directory */ +File.separatorChar+files[i].getName()).getChannel();
        in.transferTo(0, in.size(), out);
} 
```

但是，签出目录中的 .svn 文件会导致问题。我得到了例外：

```
java.io.FileNotFoundException: /checked_out_folder/.svn (No such file or directory)
[x]     at java.io.FileInputStream.open(Native Method)
[x]     at java.io.FileInputStream.<init>(FileInputStream.java:120) 
```

是因为它是隐藏文件吗？这可能是什么解决方案？或者我在这里错过了什么？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:55:21.407

我认为这是因为它是一个目录而不是一个文件。

您必须使用[mkdir](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#mkdir%28%29)方法创建的目录。据我所知，整个目录不能在java中复制。

有关如何复制目录的示例，请参阅[此](http://www.mkyong.com/java/how-to-copy-directory-in-java/)博客文章。

# ruby-on-rails - Rails 3.2 对用户帐户和配置文件使用单独的模型有什么好处吗？

> ID：11005987
> 
> 赞同：1
> 
> 时间：2012-06-12T22:50:38.690
> 
> 标签：ruby-on-rails, authentication, devise, models

我只想知道对用户和用户个人资料使用不同的模型是否有任何优势。

通过这种方式，我可以将用户详细信息（例如名字和姓氏、地址和出生日期）与身份验证分开存储。

目前我想使用设计进行身份验证，但我希望如果我将来需要或想要更改它，这样做会更容易。

另外我认为不使用具有更多行数的模型可能会带来一些轻微的性能优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T23:09:35.100

如果您想准备多提供者身份验证（例如使用[omniauth](https://github.com/intridea/omniauth)），最好在架构中[分离身份验证和身份](http://blog.railsrumble.com/blog/2010/10/08/intridea-omniauth)。例如

```
class User < ActiveRecord::Base
  has_many :authorizations
end

class Authorization < ActiveRecord::Base
  belongs_to :user
end 
```

然后，对于用户用于登录的每个提供商，您将拥有单独的身份验证记录，例如您的本地登录、Twitter、Facebook 等。

`Authority`拥有一个模型`has_many :authorizations`作为保存特定于每个提供者的数据（例如图标、api 键）的好地方也可能很有用。

# actionscript-3 - 在 AS3 中生成和销毁事物

> ID：11005989
> 
> 赞同：0
> 
> 时间：2012-06-12T22:51:07.833
> 
> 标签：actionscript-3, oop, actionscript, mouseevent, addeventlistener

好的，所以我正在制作一个小游戏，用户可以选择随机生成的花朵。当一朵花被采摘时，它会消失并且用户获得积分。

这是我的一些代码：

```
import flash.events.MouseEvent;

function makeFlower() {

    var flower:Flower = new Flower();

    addChild(flower);
    flower.x = Math.random() * 500;
    flower.y = Math.random() * 400;
}

function removeFlower(event:MouseEvent):void {
    flower.pick();
}

setInterval(makeFlower, 2500);
addEventListener(MouseEvent.CLICK, removeFlower); 
```

所以在上面的代码中，`flower.pick()`它不起作用，因为它超出了范围（顺便说一句，我如何让它在范围内？）......这是一个问题。但是这个问题让我质疑花的创造应该发生在哪里。`addChild()`放入我的构造方法会更好吗？

然后是破坏部分......检测被点击的花的事件监听器......这应该是分开的（就像我拥有它一样）还是应该放入Flower类？我是 ActionScript 的新手，想知道应该把东西放在哪里。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T23:00:45.057

尝试：

```
import flash.events.MouseEvent;

var flower:Flower;

function makeFlower() {
    flower = new Flower();
    addChild(flower);
    flower.x = Math.random() * 500;
    flower.y = Math.random() * 400;

    flower.addEventListener(MouseEvent.CLICK, removeFlower);
}

function removeFlower(event:MouseEvent):void {
    event.target.pick();
    //removeChild(event.target); // active this to remove the clicked flower
}

setInterval(makeFlower, 2500); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T23:05:35.543

你应该在哪里处理事情取决于很多因素，我的列表中的第一个是你是否使用 Flex 框架，第二个是最适合给定应用程序的。对于您的情况，您似乎只是在使用 Flash IDE。

您需要收集添加到显示树的花卉对象。然后在点击时，您将希望使用点击的目标来了解他们采摘了哪朵“花”，而不是随意移除一些花。

收集花朵的另一个好处是您实际上可以切换可见性（这也可以切换触摸/单击与对象交互的能力）。然后，您可以一次创建全部 Flower 对象，或者至少重复使用，而不必进行垃圾收集并制造大量对象（正如 Daniel 在下面所指出的，该术语是对象池）。

```
import flash.events.MouseEvent;

var allFlowers:Array = [];
var oldFlowers:Array = [];

function makeFlower() {
    var flower:Flower;

    if(oldFlowers.length>0)  //if there's stale ones, already created but since picked
    {
        flower = oldFlowers.pop();//grab the last one from the list
        flower.visible=true;//show it, update to position below should happen fast enough so you won't see it move
    }
    else
        flower = new Flower();

    allFlowers.push(flower);

    addChild(flower);

    flower.addEventListener(MouseEvent.CLICK, removeFlower);  //Adding the listener directly to the Flower object, assuming it's a Sprite/MovieClip/InteractiveObject of some sort

    flower.x = Math.random() * 500;
    flower.y = Math.random() * 400;
}

function removeFlower(event:MouseEvent):void {
    var clickedFlower:Flower = (event.target as Flower); //this is a local reference
    clickedFlower.pick();  //assuming this toggles the visibility
    oldFlowers.push(allFlowers.splice(clickedFlower,1)); //removing it from the "active array" putting it in the "stale array"
}

setInterval(makeFlower, 2500); 
```

理想情况下，这将全部包含在一个类中，真正的作用域变量在类的上下文中对我来说比仅仅在某个地方的某个代码块中晃来晃去更有意义。

由于在您的原始代码中您声明花是一个 var 并为其提供存储在该 var (Flower) 中的对象类型，因此它的范围仅限于该函数的打开和关闭花括号。对于我定义的变量，只要包含代码的对象可用，它们就应该可用。

在 AS3 中的类中声明变量或函数时，可以使用三种主要的“作用域修饰符”（即 public、protected 或 private）。使用公共意味着属性/方法（成员）可以在类定义（通常是文件，something.as）以及其他任何东西中访问，如果你将变量设为公共，它可以被任何使用代码的东西修改，这个如果来自外部的更改是无意的，可能会导致您的应用程序出现不可预测的行为。使用受保护意味着从类继承或扩展类的任何东西都可以访问/使用受保护的成员，但是只有对象实例的任何东西都不能访问这些成员（因此称为访问修饰符）。第三级是私有的，这意味着只有该类中的代码（跨所有方法）可以访问该成员，但该类的继承/子类不能访问该成员。这本质上是计算机科学中通常称为封装的概念的实现。还有更多细节，但实际上对于一个像样的 SO 帖子来说已经太长了。

# ruby-on-rails - Rails 3：Twitter-Bootstrap 工具提示拒绝工作

> ID：11005990
> 
> 赞同：2
> 
> 时间：2012-06-12T22:51:27.317
> 
> 标签：ruby-on-rails, twitter-bootstrap, popover

这让我非常疯狂，而且实现起来似乎很简单。我无法让工具提示（或者，就此而言，弹出窗口）起作用。我安装了**“twitter-bootstrap-rails”gem**，并生成了适当的 .js 和 .css 文件。

我认为这不是 JQuery 问题，因为我的网站上还有其他运行良好的 JQuery 功能。

这是一些相关的代码。

**应用程序.js**

```
//= require jquery
//= require jquery_ujs
//= require twitter/bootstrap
//= require bootstrap-tooltip
//= require bootstrap-popover
//= require prototype
//= require prototype_ujs
//= require effects
//= require dragdrop
//= require controls
//= require_tree .
$('a').tooltip(); 
```

**应用程序.css**

```
 *= require_self
 *= require_tree .
 *= reqire_twitter/bootstrap 
```

**我想为工具提示工作的代码**

```
<a href="#" title="test" rel="tooltip" id="test-url">test</a> 
```

上面的代码，当悬停在上面时，只显示 Chrome 的正常工具提示。我在 Safari 中得到了相同的行为，所以我怀疑它是特定于浏览器的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T12:11:19.407

我正在使用 Rails 3.2.7，手动添加 Bootstrap。一切正常。

**应用程序.css**

```
*= require style
*= require bootstrap.min
*= require bootstrap-responsive.min
*= require_tree . 
```

**应用程序.js**

```
//= require jquery
//= require jquery_ujs
//= require bootstrap.min
$(document).ready(function(){
    $('a').tooltip();
});
//= require_tree . 
```

和**布局/application.html.erb**

```
<head>
  <%= stylesheet_link_tag("application", :media => "all") %>
</head>
<body>
<%= yield %>
  <!-- scripts concatenated and minified via build script -->
  <%= javascript_include_tag "application" %>
  <!-- end scripts -->
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T00:16:20.620

您的 application.js 代码将在您的网页完全加载到浏览器之前执行，因此您的代码行在页面加载之前不会找到任何元素。

您需要在 DOM 完全加载时执行：

```
$(document).ready(function () {
  $('a').tooltip();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T14:54:45.520

经过一番努力，为了让它在 Rails 3.2 中正常工作，我必须执行以下操作：

1.  在 application.js 中：

    > //= 需要引导

2.  在我想要工具提示的视图模板中，包括 rel='tooltip' 属性：

    > = link_to "链接文本", title: '点击显示曲目', 'data-placement' => 'top', rel: :tooltip

或者如果您不使用 HAML：

```
<a href="#" data-placement="top" rel="tooltip" title="Click to reveal tracks">Link text</a> 
```

1.  在任何咖啡脚本文件（我创建了一个新文件）中输入：

    > jQuery ->
    > $('[rel="tooltip"]').tooltip()

这行得通，虽然工具提示的样式不起作用，但我不知道为什么，但 javascript 似乎至少可以工作。

希望这会对其他人有所帮助。

正如有人已经评论过的那样，bootstrap-sass 包含一个咖啡脚本文件，其中包含以下内容：

```
jQuery ->
  $("a[rel=popover]").popover()
  $(".tooltip").tooltip()
  $("a[rel=tooltip]").tooltip() 
```

如果你调用这个文件，就不需要包含上面的另一个咖啡脚本文件，因为这个文件做同样的事情。在我的情况下，我已经`bootstrap.js`调用过，`application.js`所以没有调用这个（我删除了 require_tree 以便我可以按我想要的顺序调用我想要的文件）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-14T14:12:13.027

解决这个问题的方法有两个。

1.  `$`将代码中的更改为`jQuery`. 这摆脱了“对象#没有方法‘准备好’”的错误。

2.  我有一个包含无关代码的 bootstrap.js.coffee 文件。当我删除文件时，一切又开始工作了。这消除了“Uncaught TypeError: Cannot call method 'tooltip' of null”错误。

# javascript - Javascript替换匹配组

> ID：11005991
> 
> 赞同：14
> 
> 时间：2012-06-12T22:51:53.867
> 
> 标签：javascript, regex

我正在尝试构建一个文本格式化程序，它将根据换行符将 p 和 br 标记添加到文本中。我目前有这个：

```
s.replace(/\n\n/g, "\n</p><p>\n"); 
```

这对于创建段落结尾和开头非常有效。但是，尝试查找
实例效果不佳。尝试进行匹配组替换不起作用，因为它忽略括号并替换整个正则表达式匹配：

```
s.replace(/\w(\n)\w/g, "<br />\n"); 
```

我试过删除 g 选项（仍然替换整个匹配，但仅在第一场匹配）。还有另一种方法可以做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-12T22:55:21.820

您可以捕获不想替换的部分并将它们包含在替换字符串中，`$`后跟组号：

```
s.replace(/(\w)\n(\w)/g, "$1<br />\n$2"); 
```

有关在替换字符串中引用部分输入字符串的更多信息，[请参阅 MDN 文档中的此部分。](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T22:56:24.553

还可以捕捉周围的字符：

```
s.replace(/(\w)(\n\w)/g, "$1<br />$2"); 
```

# iphone - Iphone4设计中的背景问题

> ID：11005992
> 
> 赞同：0
> 
> 时间：2012-06-12T22:52:12.097
> 
> 标签：iphone, jquery-mobile, mobile, mobile-safari

我的 iPhone 网页布局有问题，我的背景图片不适合 safari 的视图（在 iPhone4 中），我的背景图片大小：`w:480 px / h:720px`。

我的身体CSS代码：

```
body
{
height:100%;
margin:0px;
background-image:url(../images/bg.png);
background-repeat:no-repeat;
background-size: cover;
} 
```

实际上，我真的不知道视网膜显示器和普通3g显示器的背景分辨率应该是多少......以及如何调整它们......

如果有人可以帮助我，我会很高兴...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T05:52:42.277

嗨，请使用此代码而不是您的身体：

```
body{
font-size:100%;
background:url(../images/bg.png) no-repeat center top;
background-size:100% auto;
margin:0 auto;
} 
```

# iphone - CocoaLumberjack - 如何访问设备上的日志文件？

> ID：11005996
> 
> 赞同：4
> 
> 时间：2012-06-12T22:52:24.493
> 
> 标签：iphone, objective-c, ios, logging

我正在使用[CocoaLumberjack](https://github.com/robbiehanson/CocoaLumberjack)进行日志记录，因为它似乎是一个非常通用的日志记录框架。

在我的应用程序中，我需要登录到一个文件，并将该文件的内容显示在应用程序本身中：这是为了应用程序用户的诊断目的（主要是让他们可以看到应用程序访问他们的网络的程度，我将其记录到文件中）。

有`DDFileLogger`和`DDLogFileManager`类。我可以看到如何使用`DDLogFileManager`该类在包装后访问文件，但我想做的是在 a 中显示文件的内容`UITextView` - 以便它显示当前内容..而不仅仅是在包装时。

无论哪种方式，我都看不到如何访问应用程序本身的日志文件 - 任何人都可以阐明如何做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-26T02:20:01.757

在这里查看我的答案：

[https://stackoverflow.com/a/11544657/620577](https://stackoverflow.com/a/11544657/620577)

而这些字符只是达到最低30个。