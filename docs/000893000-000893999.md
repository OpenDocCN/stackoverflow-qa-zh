# StackOverflow 问答 000893000-000893999

# visual-studio - 根据配置更改程序集名称 (Visual Studio 2005/2008)

> ID：893003
> 
> 赞同：28
> 
> 时间：2009-05-21T13:45:34.063
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005

是否可以根据项目配置更改程序集名称？

我在 assemblyinfo.cs 文件上尝试了条件编译指示，但这只会更改程序集属性，而不是名称本身。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-21T14:33:13.980

如果您右键单击您的项目并选择“编辑项目文件”（我在这里是 2008 年，它可能是一个新选项，如果是，则只需在任何旧文本编辑器中打开项目文件）您应该会看到类似于以下：

```
 <PropertyGroup>
    ...
    <AssemblyName>ClassLibrary1</AssemblyName>
    ...
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    ...
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    ...
  </PropertyGroup> 
```

基本上，在更具体的属性组中未覆盖的任何属性都是从更一般的第一组继承的。因此，要实现您想要的内容，只需编辑文件，以便在每个特定组中定义 AssemblyName 标记：

```
 <PropertyGroup>
    ...
    <AssemblyName>ClassLibrary1</AssemblyName>
    ...
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    ...
    <AssemblyName>ClassLibrary1Debug</AssemblyName>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    ...
    <AssemblyName>ClassLibrary1Release</AssemblyName>
  </PropertyGroup> 
```

这将根据每个配置更改程序集名称。

# iphone - 如何确定无效的 CFSocket

> ID：893013
> 
> 赞同：4
> 
> 时间：2009-05-21T13:46:57.820
> 
> 标签：iphone, objective-c, sockets

如何避免通过`CFSocketSendData`无效套接字发送数据？我尝试使用 确定套接字状态`CFSockerIsValid`，但是当另一端关闭时，此方法仍然返回 true。

如何确定套接字是否有效？为了避免错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-12T21:18:01.400

如果另一方关闭套接字，您的回调（您在 CFSocketCreate 中指定）将使用回调类型 kCFSocketDataCallBack 调用，但数据将为空。像这样测试它：

```
void SocketCallback (CFSocketRef s, CFSocketCallBackType callbackType,
                 CFDataRef address, const void *data, void *info)
{
    if (callbackType == kCFSocketDataCallBack) {
        NSData *nsData = (NSData *)data;
        if (nsData.length == 0) {
            NSLog(@"got kCFSocketDataCallBack, but with 0 bytes -- connection terminated");
            // do whatever you want to do here when connection is dropped
        }
    } else {
        NSLog(@"SocketCallback type %d", callbackType);
    }

} 
```

您可以在那里设置一个标志并使用它来知道您的连接已断开，然后当您写入断开的连接时，尝试重新连接或通知用户或您想做的任何事情。

# python - 覆盖python中的静态方法

> ID：893015
> 
> 赞同：59
> 
> 时间：2009-05-21T13:47:09.067
> 
> 标签：python, static, overriding

参考这里关于python的绑定和未绑定方法的[第一个答案，我有一个问题：](https://stackoverflow.com/questions/114214/class-method-differences-in-python-bound-unbound-and-static/114267#114267)

```
class Test:
    def method_one(self):
        print "Called method_one"
    @staticmethod
    def method_two():
        print "Called method_two"
    @staticmethod
    def method_three():
        Test.method_two()
class T2(Test):
    @staticmethod
    def method_two():
        print "T2"
a_test = Test()
a_test.method_one()
a_test.method_two()
a_test.method_three()
b_test = T2()
b_test.method_three() 
```

产生输出：

```
Called method_one
Called method_two
Called method_two
Called method_two 
```

有没有办法覆盖python中的静态方法？

我希望`b_test.method_three()`打印“T2”，但它没有（改为打印“Called method_two”）。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-05-21T13:56:59.780

在您在那里使用的表单中，您明确指定`method_two`要调用的类的静态。如果`method_three`是一个类方法，并且你调用`cls.method_two`了 ，你会得到你想要的结果：

```
class Test:
    def method_one(self):
        print "Called method_one"
    @staticmethod
    def method_two():
        print "Called method_two"
    @classmethod
    def method_three(cls):
        cls.method_two()

class T2(Test):
    @staticmethod
    def method_two():
        print "T2"

a_test = Test()
a_test.method_one()  # -> Called method_one
a_test.method_two()  # -> Called method_two
a_test.method_three()  # -> Called method_two

b_test = T2()
b_test.method_three()  # -> T2
Test.method_two()  # -> Called method_two
T2.method_three()  # -> T2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T14:00:27.353

您看到的行为是预期的行为。静态方法是……静态的。当你调用`method_three()`定义在`Test`它肯定会调用`method_two()`定义的`Test`。

至于如何“绕过”这种正确的行为......

最好的方法是在您需要虚拟行为时将方法设为虚拟。如果你被一些库代码困住了，你希望它是虚拟的静态方法，那么你可能会更深入地查看是否有原因，或者它是否只是一个疏忽。

否则，您可以`method_three()`在`T2`该调用中定义一个新的`T2.method_two()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-30T09:45:09.350

此外，如果您想在没有实例的情况下调用“虚拟静态”函数，您可以这样进行：

1.  在非静态基类中声明函数，如下所示：

    ```
    class Base:
        def my_fun(self):
            print('my_fun base')

    class Derived(Base):
        def my_fun(self):
            print('my_fun derived') 
    ```

2.  通过传递不是实例的类类型来调用它，如下所示：

    ```
    Derived.my_fun(Derived) 
    ```

请注意，如果您有一个仅在运行时已知的变量“class_type”，这将很有用。

# jquery - 删除使用 jQuery 添加的表行的问题

> ID：893018
> 
> 赞同：3
> 
> 时间：2009-05-21T13:47:39.393
> 
> 标签：jquery, html

我是一个 jQuery 新手，我在创建一个小脚本时遇到了麻烦。

首先，我有一个包含 5 个默认行的表。这些是可排序的，使用一个名为“Table Drag'n'Drop”的插件。该表中的一列由一个链接的 X 组成，单击该 X 会删除表行。

该表如下所示：

```
<table id="tracks">
  <thead>
    <tr>
      <th>Title</th>
      <th>File</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr class="track">
      <td><input type="text" /></td>
      <td><input type="file" /></td>
      <td><a href="#" class="deleteme">X</a></td>
    </tr>
  </tbody>
</table> 
```

在`tr.track`代码中重复五次。通过单击 X，这些是完全可拖动和可移动的。

这是 jQuery 代码：

```
// makes the table sortable
$("#tracks").tableDnD();

// adds more rows (just a link)
$("#addRow").click(function() {
    newTrack = 'same code as tr.track'
    $("tbody").append(newTrack);
    return false;
});

// delete rows
$("a.deleteme").click(function() {
    $(this).parents("tr.track").fadeOut("fast", function() {
        $(this).remove();
        return false;
    });
}); 
```

当我添加一个新的表格行时，该行不会通过单击 X 对其进行排序或删除。似乎 jQuery 没有注意到它的存在？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T13:50:04.193

您需要使用[`live`](http://docs.jquery.com/Events/live#typefn)：

> 将处理程序绑定到所有当前和未来匹配元素的事件（如单击）。

听起来像赢家。所以只需替换这一行：

```
$("a.deleteme").click(function() { 
```

有了这个，`live`改为使用：

```
$("a.deleteme").live('click', function() { 
```

### 编辑：

至于排序，显然您使用的插件并没有在`live`内部发挥优势。唯一的解决方案是在添加新表行后再次调用初始化代码。你可以用一些插件很好地做到这一点，而另一些插件则不能很好地处理它。让我们知道怎么回事。只需添加以下内容：

```
$("#tracks").tableDnD(); 
```

在`#addMore`点击处理程序中，在您附加`newTrack`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T13:52:16.873

您需要使用[live](http://docs.jquery.com/Events/live)将当前和未来的元素绑定到事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T13:54:05.510

您必须在 JQuery 中刷新 Sortable。

$("#tracks").sortable("刷新");

这是假设您使用的是开箱即​​用的 Sortable 插件。.tableDnD 看起来像一个自定义扩展方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-17T07:10:29.883

tableDnD 插件有一个方法，自从这个问题最初发布以来可能已经添加了，但为了同样的完整性，我将在此处添加它：

```
.tableDnDUpdate() 
```

正如 tableDnD 文档所述，

> 导致表格更新其行，以便拖放功能在例如您添加了一行时起作用。

# java - 阻塞队列 - 需要更多信息

> ID：893021
> 
> 赞同：5
> 
> 时间：2009-05-21T13:47:55.290
> 
> 标签：java, data-structures, concurrency, queue

这个问题与我之前的一个问题有关。

[上一篇文章](https://stackoverflow.com/questions/827831/what-are-the-advantages-of-blocking-queue-in-java)

在那里，阻塞性质被认为是一个优势。

我试图开发一些简单的代码来展示阻塞性质，但我被卡住了。我只是尝试制作`BlockingQueue`大小为 4 的 a 并尝试添加 5 个元素并最终得到一个`java.lang.IllegalStateException`. 有人可以给我看一个阻止性质的代码示例`BlockingQueue`吗？

* * *

```
public static void main(String[] args) {
    BlockingQueue<String> bq = new LinkedBlockingQueue<String>(4);

    try {
        bq.offer("A");
        bq.offer("B");
        bq.offer("C");
        bq.offer("D");
        bq.offer("E");

        System.out.println("1 = " + bq.take());
        System.out.println("2 = " + bq.take());
        System.out.println("3 = " + bq.take());
        System.out.println("4 = " + bq.take());
        System.out.println("5 = " + bq.take());
        System.out.println("6 = " + bq.take());
    } catch (Exception e) {
        // TODO: handle exception
        e.printStackTrace();
    }
} 
```

我使用了这个代码段。在这种情况下，我试图将 5 个元素放入大小为 4 的队列中。在这种情况下，应将 4 个元素（A、B、C、D）添加到队列中。然后我`take()`在打印时调用方法。我打电话时不应该将“E”自动插入队列**`System.out.println("1 = " + bq.take());`**吗？因为它有一个免费插槽？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-21T14:00:32.613

你是用[`add`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#add(E)), [`offer`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#offer(E)), 还是加的[`put`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#put(E))？我假设您正在使用`add`; 因为它是唯一可以抛出`IllegalStateException`; 但是如果您阅读[table](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)，您会发现如果您想要阻塞语义，您应该使用[`put`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#put(E))（并[`take`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html#take())删除）。

**编辑：**您的示例存在一些问题。

`take()`首先，我将回答“为什么我第一次调用时没有插入 E ？”这个问题。答案是，当您调用 时`take()`，您已经尝试插入 E*并且失败*。一旦空间被释放，就没有什么可插入的了。

现在，如果您更改`offer()`为`put()`，`put("E")`将永远不会返回。为什么？因为它正在等待*其他线程*从队列中删除一个元素。请记住，`BlockingQueues`是为多线程访问而设计的。如果您有一个单线程应用程序，阻塞是无用的（实际上比无用更糟糕）。

这是一个改进的示例：

```
public static void main(String[] args) {
    final BlockingQueue<String> bq = new LinkedBlockingQueue<String>(4);

    Runnable producer = new Runnable() {
        public void run() {
            try {
                bq.put("A");
                bq.put("B");
                bq.put("C");
                bq.put("D");
                bq.put("E");
            } catch (InterruptedException ex) {
                Thread.currentThread().interrupt(); 
            }
        }
    };
    Runnable consumer = new Runnable() {
        public void run() {
            try {
                System.out.println("1 = " + bq.take());
                System.out.println("2 = " + bq.take());
                System.out.println("3 = " + bq.take());
                System.out.println("4 = " + bq.take());
                System.out.println("5 = " + bq.take());
                System.out.println("6 = " + bq.take());
            } catch (InterruptedException ex) {
                Thread.currentThread().interrupt();
            }
        }
    };
    new Thread(producer).start();
    new Thread(consumer).start();
} 
```

现在`put("E")`调用实际上会成功，因为它现在可以等到消费者线程从队列中删除“A”。最后一个`take()`仍然会无限阻塞，因为没有第六个元素要删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T13:53:00.427

mmyers 打败了我：P (+1)
这应该是你需要的，祝你好运！

**注意：** put() 在您的示例中将失败，因为 put() 将阻塞直到空间可用。由于空间永远不可用，程序永远不会继续执行。

==== 旧答案======

BlockingQueue 是一个接口，您必须使用其中一个实现类。

“阻塞性质”只是说明您可以从队列中请求某些内容，如果它为空，则它所在的线程将*阻塞*（等待），直到将某些内容添加到队列中然后继续处理。

`ArrayBlockingQueue
DelayQueue
LinkedBlockingQueue
PriorityBlockingQueue
SynchronousQueue` 

[http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/BlockingQueue.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/BlockingQueue.html)

 `````
//your main collection
LinkedBlockingQueue<Integer> lbq = new LinkedBlockingQueue<Integer>();

//Add your values
lbq.put(100);
lbq.put(200);

//take() will actually remove the first value from the collection, 
//or block if no value exists yet.
//you will either have to interrupt the blocking, 
//or insert something into the queue for the program execution to continue

int currVal = 0;
try {
    currVal = lbq.take();
} catch (InterruptedException e) {
    e.printStackTrace();
} 
````  `* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T14:23:08.760

要专门回答您的问题： Offer 是一个非阻塞的 offer 调用，因此在像您发布的那样的单线程方法中，对 offer('E') 的调用只是返回 false 而不修改整个队列。如果您使用阻塞 put('E') 调用，它将休眠直到空间可用。永远在你的简单例子中。您需要有一个单独的线程从队列中读取，以便为 put 完成创建空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-24T15:16:40.393

嗨更多信息这门课

```
 /**
 * Inserts the specified element into this queue if it is possible to do
 * so immediately without violating capacity restrictions, returning
 * {@code true} upon success and throwing an
 * {@code IllegalStateException} if no space is currently available.
 * When using a capacity-restricted queue, it is generally preferable to
 * use {@link #offer(Object) offer}.
 *
 * @param e the element to add
 * @return {@code true} (as specified by {@link Collection#add})
 * @throws IllegalStateException if the element cannot be added at this
 *         time due to capacity restrictions
 * @throws ClassCastException if the class of the specified element
 *         prevents it from being added to this queue
 * @throws NullPointerException if the specified element is null
 * @throws IllegalArgumentException if some property of the specified
 *         element prevents it from being added to this queue
 */
boolean add(E e);

/**
 * Inserts the specified element into this queue if it is possible to do
 * so immediately without violating capacity restrictions, returning
 * {@code true} upon success and {@code false} if no space is currently
 * available.  When using a capacity-restricted queue, this method is
 * generally preferable to {@link #add}, which can fail to insert an
 * element only by throwing an exception.
 *
 * @param e the element to add
 * @return {@code true} if the element was added to this queue, else
 *         {@code false}
 * @throws ClassCastException if the class of the specified element
 *         prevents it from being added to this queue
 * @throws NullPointerException if the specified element is null
 * @throws IllegalArgumentException if some property of the specified
 *         element prevents it from being added to this queue
 */
boolean offer(E e);

/**
 * Inserts the specified element into this queue, waiting if necessary
 * for space to become available.
 *
 * @param e the element to add
 * @throws InterruptedException if interrupted while waiting
 * @throws ClassCastException if the class of the specified element
 *         prevents it from being added to this queue
 * @throws NullPointerException if the specified element is null
 * @throws IllegalArgumentException if some property of the specified
 *         element prevents it from being added to this queue
 */
void put(E e) throws InterruptedException;

/**
 * Inserts the specified element into this queue, waiting up to the
 * specified wait time if necessary for space to become available.
 *
 * @param e the element to add
 * @param timeout how long to wait before giving up, in units of
 *        {@code unit}
 * @param unit a {@code TimeUnit} determining how to interpret the
 *        {@code timeout} parameter
 * @return {@code true} if successful, or {@code false} if
 *         the specified waiting time elapses before space is available
 * @throws InterruptedException if interrupted while waiting
 * @throws ClassCastException if the class of the specified element
 *         prevents it from being added to this queue
 * @throws NullPointerException if the specified element is null
 * @throws IllegalArgumentException if some property of the specified
 *         element prevents it from being added to this queue
 */
boolean offer(E e, long timeout, TimeUnit unit)
    throws InterruptedException;

/**
 * Retrieves and removes the head of this queue, waiting if necessary
 * until an element becomes available.
 *
 * @return the head of this queue
 * @throws InterruptedException if interrupted while waiting
 */
E take() throws InterruptedException;

/**
 * Retrieves and removes the head of this queue, waiting up to the
 * specified wait time if necessary for an element to become available.
 *
 * @param timeout how long to wait before giving up, in units of
 *        {@code unit}
 * @param unit a {@code TimeUnit} determining how to interpret the
 *        {@code timeout} parameter
 * @return the head of this queue, or {@code null} if the
 *         specified waiting time elapses before an element is available
 * @throws InterruptedException if interrupted while waiting
 */
E poll(long timeout, TimeUnit unit)
    throws InterruptedException; 
```

# asp.net - 构建搜索应用程序的最佳实践？

> ID：893036
> 
> 赞同：1
> 
> 时间：2009-05-21T13:51:01.227
> 
> 标签：asp.net, sql-server, linq-to-sql, search

我将很快开始一个简单的数据存储和搜索项目。基本上，其中之一是“将我巨大的 Excel 电子表格放入数据库，为其构建 Web GUI，并使其可搜索”类型的东西。

困扰我的一件事是用户输入某些条件时将使用的实际搜索逻辑。我正在想象一个带有文本字段的搜索界面，以及一些其他过滤工具——下拉组合框和复选框等。

虽然这给了我对我可以执行的过滤的非常强大、精细的控制，但我想知道 SO 对实际执行搜索的想法是什么。我将在这里使用 ASP.NET、MS SQL Server 和 Linq-To-SQL，因此请记住这些技术。

在我的脑海中，我想我会做类似的事情：

```
var results = from s in db.Stuff
              where (s.Prop1.Contains(textFilter) ||
                     s.Prop2.Contains(textFilter) ||
                     s.Prop3.Contains(textFilter)) &&
                     checkbox1.IsChecked ?
                          s.Prop4.ToLower().Equals(combobox1.Text) : true
              select s; 
```

这是我所知道的：

*   必要时如何进行分组和加入
*   我可以对各个属性使用*Contains()*方法来生成 SQL *LIKE*查询
*   我可以按属性过滤事物，如上所述构建我的搜索逻辑。

这就是我要问的：

*   有没有办法搜索所有属性（不将所有对象拉入内存 - 我认为这意味着通过反射构建每个对象属性的列表，将它们字符串化，然后检查出来）？如果没有，这似乎非常麻烦，因为我必须为我可能添加的每个新属性构建新逻辑。*上面的s.Contains(textFilter)*之类的东西是理想的。
*   SQL *LIKE*查询实际上是如何工作的？那是我想做的事吗？
*   是否有实现搜索规则的标准方法，例如完全匹配和逻辑运算符（例如*AND*和*OR* ）的引用字符串？如果每个实现它们的应用程序都使用自定义解析逻辑这样做，我会感到惊讶。
*   我在吠叫错误的树吗？我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T13:59:55.547

我最近不得不为评论系统创建一个类似的搜索。我所做的是从评论中创建了一些扩展方法，这些方法允许我传入通用过滤对象。

这是我使用的示例代码：

这只是一个部分方法，没有返回，但它会给你一个我在做什么的图片：

```
public List<oComment> GetComments(oCommentSearch filters)
{

    using (CommentDataContext db = CommentContextFactory.CreateContext())
    {
        var query = from comment in db.COMMENTs.FilterComments(filters)
                    select comment;
    }
} 
```

正如你所看到的评论我有过滤评论。这是一种扩展方法。这个方法看起来像这样（这是我拥有的整个类）：

```
public static class CommentExtensions
    {
        public static IQueryable<COMMENT> FilterComments(this IQueryable<COMMENT> Comments, oCommentSearch Filters)
        {
            Filters = CheckFilter(Filters);

            IQueryable<COMMENT> tempResult = Comments;

            if(Filters.Classes.Count() > 0)
            {
                tempResult = from t in tempResult
                             where
                                 Filters.Classes.Contains(t.CLASS_ID)
                             select t;
            }

            if (Filters.Flags.Count() > 0)
            {
                tempResult = from t in tempResult
                             where
                                 Filters.Flags.Contains((int) t.FLAG_ID)
                             select t;
            }

            if (Filters.Types.Count() > 0)
            {
                tempResult = from t in tempResult
                             where
                                 Filters.Types.Contains(t.CommentTypeId)
                             select t;
            }
            return tempResult;
        }

        private static oCommentSearch CheckFilter(oCommentSearch Filters)
        {
            Filters.Classes  = CheckIntArray(Filters.Classes);
            Filters.Flags =  CheckIntArray(Filters.Flags) ;
            Filters.Types =  CheckIntArray(Filters.Types) ;
            return Filters;
        }

        private static int[] CheckIntArray(int[] ArrayToCheck)
        {
            return ArrayToCheck == null || ArrayToCheck.Count() == 0 ? new int[] {} : ArrayToCheck;
        }
    } 
```

这应该让您朝着正确的方向开始您正在尝试做的事情。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T14:01:48.913

您没有在您正在使用的技术列表中提到它，但不要忽视使用[Lucene.NET](http://incubator.apache.org/lucene.net/)。它的搜索效果非常好，并且相当容易设置。基本上，您将文档添加到索引中，Lucene 有效地管理索引。这样，您可以搜索索引，而不是一个一个地加载文档并查看它们的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T14:02:08.177

> 有没有办法搜索所有属性（不将所有对象拉入内存 - 我认为这意味着通过反射构建每个对象属性的列表，将它们字符串化，然后检查出来）？如果没有，这似乎非常麻烦，因为我必须为我可能添加的每个新属性构建新逻辑。上面的 s.Contains(textFilter) 之类的东西是理想的。

为此，我们正在使用 MsSql 全文搜索功能。

# java - 在 Spring 中如何管理对象池？

> ID：893041
> 
> 赞同：15
> 
> 时间：2009-05-21T13:52:01.163
> 
> 标签：java, spring, spring-mvc, aop, object-pooling

据我了解，在 Spring 中，默认情况下所有对象都被视为单例。如果单例设置为 false，则每次请求都会提供一个新对象。

但是如果我想合并对象怎么办？说设置从最小 1 到最大 10 个实例的范围？这可能使用Spring吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T14:27:08.503

池化可以应用于任何带有 spring 的 POJO。

请参阅[此处](http://static.springframework.org/spring/docs/2.5.x/reference/aop-api.html#aop-ts-pool)了解更多信息。

# python - 在 python shell 中按箭头键时看到转义字符

> ID：893053
> 
> 赞同：214
> 
> 时间：2009-05-21T13:55:32.420
> 
> 标签：python, shell, ssh, arrow-keys

在交互式 python shell 等 shell 中，您通常可以使用箭头键在当前行中移动或获取先前的命令（带箭头）等。

但是在我 ssh 进入另一台机器并从`python`那里开始之后，我会得到如下会话：

```
>>> import os 
>>> ^[[A 
```

最后一个字符来自箭头。或者，使用左箭头：

```
>>> impor^[[D 
```

我怎样才能解决这个问题？

在常规 bash 中，箭头键可以正常工作。奇怪的行为只是在交互式 python（或 perl 等）shell 中。

* * *

## 回答 #1

> 赞同：118
> 
> 时间：2014-10-14T08:46:59.450

我已经通过安装`readline`包解决了这个问题：

```
pip install readline 
```

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2017-01-10T02:50:07.567

在 OS X 上，我有不同的问题。

当我使用系统 python shell 时，键没有问题，但 virtualenv 有问题。我会尝试重新安装/升级 virtualenv/readline 并没有解决任何问题。

当我尝试`import readline`在问题 python shell 中时，收到此错误消息：

```
ImportError: dlopen(/Users/raptor/.virtualenvs/bottle/lib/python2.7/lib-dynload/readline.so, 2): Library not loaded: /usr/local/opt/readline/lib/libreadline.6.dylib
Referenced from: /Users/raptor/.virtualenvs/bottle/lib/python2.7/lib-dynload/readline.so
Reason: image not found 
```

因为有`/usr/local/opt/readline/lib/libreadline.7.dylib`但没有`libreadline.6.dylib`，所以我做了一个符号链接：

```
ln -s libreadline.7.dylib libreadline.6.dylib 
```

问题已解决！

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2016-10-25T01:20:17.777

在 OS X 上，Xcode 更新有时会中断`readline`. 解决方案：

```
brew uninstall readline
brew upgrade python3
brew install readline
pip3 install readline 
```

如果问题仍然存在，请尝试删除`readline`using`pip`并使用以下方式安装`easy_install`：

```
pip3 uninstall readline
easy_install readline 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-05-21T14:27:22.183

看起来 readline 没有启用。检查是否`PYTHONSTARTUP`定义了变量，对我来说它指向`/etc/pythonstart`并且该文件在交互之前由 python 进程执行，这设置了 readline/history 处理。

感谢@chown，这里有关于此的文档：http: [//docs.python.org/2/tutorial/interactive.html](http://docs.python.org/2/tutorial/interactive.html)

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2017-05-26T21:04:13.247

在 OS X 上，使用 python 3.5 和 virtualenv

```
$ pip install gnureadline 
```

在解释器中执行：

```
import gnureadline 
```

现在箭头键应该可以正常工作了。

* * *

附加信息...

请注意，截至 2015 年 10 月 1 日 - readline 已被**弃用**（来源[https://github.com/ludwigschwardt/python-readline](https://github.com/ludwigschwardt/python-readline)）

改用**gnureadline**（参见：[https](https://github.com/ludwigschwardt/python-gnureadline) ://github.com/ludwigschwardt/python-gnureadline ）

如果我使用 python 3.5 安装 readline 而不是 gnureadline，我会在尝试导入解释器后收到错误：

```
>>> import readline
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: dlopen(/Users/pi/tmp/python-readline-test/.venv/lib/python3.5/readline.so, 2): Library not loaded: /usr/local/opt/readline/lib/libreadline.6.dylib
  Referenced from: /Users/pi/tmp/python-readline-test/.venv/lib/python3.5/readline.so
  Reason: image not found 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2019-03-11T13:30:58.863

我最近遇到了这个问题，在阅读了很多关于`pip install readline`（不适用于 mac osx）并且`pip install gnureadline`不满意之后，现在这是我的设置，可以在任何 python 控制台中使用箭头键：

1.  使用安装 gnureadline`pip install gnureadline`

现在你可以做`import gnureadline`并且箭头键应该按预期工作。要使它们自动工作，请执行以下步骤：

2.  创建（或附加到）文件`~/.startup.py`：`import gnureadline`
3.  附加到文件`~/.bash_profile`：`export PYTHONSTARTUP=~/.startup.py`

* * *

一件事不起作用，但在我之前的设置中是：自动导入 gnureadline on `pdb.set_trace()`。如果有人对此问题有很好的解决方案，我将不胜感激。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2018-05-21T18:24:32.693

我在 Ubuntu 16.04 LTS 上遇到了 Python 3.6.x 的 shell 历史记录（选项卡/箭头命令）问题。

Python 3.6.x 是从源代码安装的。

为我解决的问题是使用以下命令行安装 user12345 所说的模块“gnureadline”：

```
sudo pip3.6 install gnureadline 
```

:)

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2010-05-10T20:04:31.253

1.  安装 readline-devel 包。
2.  使用 readline 模块重新编译 python
3.  答对了！

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2013-06-30T19:44:05.433

以下是在 ubuntu 12.04 for python 3.3 中对我有用的步骤。

1）打开终端并写入`sudo apt-get install libreadline-dev`

[2）从http://www.python.org/ftp/python/3.3.2/Python-3.3.2.tar.xz](http://www.python.org/ftp/python/3.3.2/Python-3.3.2.tar.xz)下载python 3.3.2的源文件

3) 解压并导航到 shell 中的 Python-3.3.2/ 目录

4）执行以下命令：

```
./configure
make
make test
sudo make install 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-10-10T00:13:19.763

将Mac升级到High Sierra后受到影响，这为我成功解决了：

```
brew unlink python
xcode-select --install
brew install python 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-01-24T22:32:03.773

在 CentOS 上，我通过

`yum install readline-devel`

然后重新编译python 3.4。

在 OpenSUSE 上，我通过

```
pip3 install readline 
```

遵循 Valerio Crini 的回答。

也许“pip3 install readline”是一个通用的解决方案。还没有在我的 CentOS 上尝试过。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-02-10T21:32:46.083

如果你使用 Anaconda Python，你可以通过运行来解决这个问题：

```
conda install readline 
```

为我工作！

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2019-10-16T15:31:45.023

这些答案都不适用于我在两个不同版本的 Ubuntu 上。对我有用但不是真正的解决方法是将我的 python 代码包装在对`rlwrap`（在 ubuntu 存储库中可用）的调用中：

`rlwrap python mycode.py`

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-01-15T03:24:25.493

我通过执行以下操作解决了这个问题：

*   百胜安装 readline-devel
*   点安装阅读线

    *   我在这里遇到了另一个错误：

        `gcc: readline/libreadline.a: No such file or directory`

        `gcc: readline/libhistory.a: No such file or directory`

        我通过安装解决了这个问题`patch`：

        `yum install patch`

之后，我成功运行`pip install readline`，解决了我的 python shell 中的转义字符。

仅供参考，我正在使用 RedHat

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-09-20T08:19:21.607

对于那些使用 conda 的人，从 conda-forge 频道安装 readline 包将解决问题：

```
conda install -c conda-forge readline=6.2 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-05-21T14:22:24.440

*您是否使用-t*参数调用 ssh来告诉 ssh 为您分配一个虚拟终端？

从手册页：

> -t
> 强制伪 tty 分配。这可用于在远程机器上执行任意基于屏幕的程序，这非常有用，例如在实现菜单服务时。多个 -t 选项强制分配 tty，即使 ssh 没有本地 tty。

此外，您可能还必须按照另一篇文章中的建议正确设置服务器上的*TERM*环境变量。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-11-28T02:56:56.410

readline 模块已被弃用，这将在最新的 python 版本中导致在 python shell 中执行 quit() 或 exit() 时出现无效指针错误。 `pip install gnureadline`反而

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-08-11T01:53:45.943

在具有各种历史安装的 Mac OS X Mojave 10.14.6 上，`brew`我通过以下方式解决了这个问题：

```
brew reinstall python2 
```

鉴于每个人都有不同的安装场景，可能没有灵丹妙药。我也尝试了上述方法，所以它可能是几个答案的组合。Brew 默认是`python3`这样，如果你安装了这个`python2`包，它也需要重新安装。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-05-21T13:57:57.283

您是否尝试过使用不同的 SSH 客户端？一些 SSH 客户端具有用于不同远程进程的特殊内置键映射。我经常用emacs遇到这个问题。

你用的是什么客户端？我建议尝试使用 Putty 和 SecureCRT 来比较它们的行为。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-21T14:03:52.153

当一切正常时，您的环境变量 $TERM 如何设置 [a]，而当它们不正常时，您的环境变量如何设置 [b]？环境设置通常是此类问题的关键。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-06-25T20:49:56.227

尝试在服务器上运行一个关键代码库。如果这不起作用，请尝试下载具有读取密钥能力的库。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-05-13T16:14:22.530

我正在尝试在 Ubuntu 14.0 上构建 Python 2.7。您将需要 libreadline-dev。但是，如果从 apt-get 获取，当前版本是 6.3，与 Python 2.7 不兼容（不确定 Python 3）。例如，在先前版本的 readline 中定义的数据类型“Function”和“CPPFunction”已在 6.3 中删除，如下所述：

[https://github.com/yyuu/pyenv/issues/126](https://github.com/yyuu/pyenv/issues/126)

也就是说你需要获取一个较早版本的readline的源代码。我从 apt-get 为库安装了 libreadline 5.2，并为头文件获取了 5.2 的源代码。将它们放在 /usr/include 中。

终于问题解决了。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-09-27T18:59:27.883

在 MacOsx 上，我通过重新安装 readline 解决了这个问题

```
brew reinstall readline 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-03-22T03:55:14.313

在 Unbuntu 或 Mint 中，如果您使用的是**pyenv**，

```
sudo apt install libreadline-dev
pyenv uninstall 3.8.8
pyenv install 3.8.8 
```

安装 libreadline-dev 后，您无需在每个 python 版本上都安装 pip install gnureadline。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-09T05:26:05.807

您可以通过以下方式从“sh”切换到“bash”

```
$ /sh/bash 
```

# c - 检查套接字文件描述符是否可用？

> ID：893055
> 
> 赞同：3
> 
> 时间：2009-05-21T13:56:03.400
> 
> 标签：c, select, sockets

如果我有一个文件描述符（socket fd），如何检查这个 fd 是否可用于读/写？在我的情况下，客户端已连接到服务器，我们知道 fd。但是，服务器会断开套接字，有什么线索可以检查吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T14:13:14.927

您要`fcntl()`检查 fd 上的读/写设置：

```
#include <unistd.h>
#include <fcntl.h>

int    r;

r = fcntl(fd, F_GETFL);
if (r == -1)
        /* Error */
if (r & O_RDONLY)
    /* Read Only */
else if (r & O_WRONLY)
    /* Write Only */
else if (r & O_RDWR)
    /* Read/Write */ 
```

但这是一个与不再连接套接字时不同的问题。如果您已经在使用`select()`，或者`poll()`您就快到了。`poll()`如果您指定`POLLERR`in`events`并在 中检查它，将很好地返回状态`revents`。

如果您正在执行正常的阻塞 I/O，那么只需在读/写错误进入时处理它们并优雅地恢复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:18:13.107

[在 C# 中，这个问题在这里](https://stackoverflow.com/questions/722240/instantly-detect-client-disconnection-from-server-socket)得到了回答

一般来说，套接字断开是异步的，需要以某种方式轮询。如果套接字也关闭，对套接字的异步读取通常也会返回，让您有机会更快地了解状态变化。Winsock (Windows) 能够注册以接收断开连接的通知（但同样，这可能不会在对方“消失”后很长时间内发生，除非您使用某种类型的“keepalive”（SO_KEEPALIVE，通过默认可能几个小时都不会注意到，或者应用程序级的心跳）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T03:16:01.953

我发现recv可以检查。当 socket fd 坏时，会设置一些 errno。

```
ret = recv(socket_fd, buffer, bufferSize, MSG_PEEK); 
if(EPIPE == errno){
// something wrong
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:09:48.303

您可以为此使用`select()`或。`poll()`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-21T14:09:55.370

好吧，你可以调用 select()。如果服务器已断开连接，我相信您最终会返回一个错误代码......如果没有，您可以使用 select() 来判断您的网络堆栈是否准备好发送更多数据（或接收它）。

# macos - Interface Builder 的示例代码来创建像 Preview.app 这样的 UI？

> ID：893058
> 
> 赞同：0
> 
> 时间：2009-05-21T13:56:44.787
> 
> 标签：macos, interface-builder

我见过几个使用类似于 Preview 的 UI 的程序。我想做同样的事情，所以，我认为某处可能有一些示例代码显示了如何做到这一点。我真的不需要“自定义工具栏”选项，尽管那会很酷。我只是想知道如何让 Interface Builder 为默认界面生成正确的 Nib...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T11:19:15.483

我认为您可能只需要通过位于 /Developer/Examples/AppKit/ 中的示例来工作

本质上，Preview.app 只不过是一个带有可滚动内容视图的窗口，外加一个工具栏和一个抽屉。然而，在许多方面，它是 AppKit 功能（拖放、分层菜单、上下文菜单、聚光灯、文本编辑、用户默认值、标尺，甚至是厨房水槽）的完美体现。 ..)

玩 appKit 的例子，你会很高兴你做到了！

# asp.net - 项目接近完成。是时候开始测试了。哪些方法在开发周期结束时是可行的？

> ID：893059
> 
> 赞同：1
> 
> 时间：2009-05-21T13:56:46.847
> 
> 标签：asp.net, vb.net, testing-strategies

让我们假设一个人在其开发周期接近尾声时加入了一个项目。该项目已在许多团队中传递，并且总体上是免费的，在整个过程中没有进行任何测试。这个团队的其他成员对测试一无所知（耻辱！），并且在这一点上对每种方法进行单元测试似乎是不可行的。

除了可用性测试之外，此时推荐的产品测试策略是什么？这通常是您陷入手动点击预期输出/实际输出工作的地方吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:05:06.643

我通常采用自下而上的方法进行测试，但我认为在这种情况下你想要自上而下。测试可以包装单元测试的最大组件，看看它们是如何失败的。这些失败应该指出哪些子组件需要自己进行测试。完成后，您将拥有一个相当参差不齐的测试套件，但这是一个开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T14:32:21.470

如果您有预算，请购买测试自动化套件。HP/Mercury QuickTest 是该领域的领导者，但价格非常昂贵。这个想法是通过用例驱动 GUI 来记录测试用例，如宏。您在表单（web、.net、swing，几乎任何类型的 GUI）上填写输入，引擎会学习表单元素的名称。然后您可以在 GUI 和数据库中检查预期的输出。然后，您可以插入包含各种测试输入的表格或电子表格，包括应该失败的无效案例，并根据需要在数百个场景中运行它。记录测试后，您还可以编辑生成的脚本以自定义它们。它最终会为您构建一份简洁的报告，向您展示失败的确切原因。

还有一些便宜且免费的 GUI 自动化测试套件，它们的功能几乎相同，但功能更少。一般来说，套件越贵，需要的手动定制就越少。查看此列表：[http ://www.testingfaqs.org/t-gui.html](http://www.testingfaqs.org/t-gui.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:12:29.130

> 除了可用性测试之外，此时推荐的产品测试策略是什么？

我建议由知道（或可以开发）产品功能规范的人/人进行代码检查。

一种极端的、纯粹的方式是这样说，因为它“一直是完全免费的，没有任何测试”，因此人们不能信任其中的任何一个：不是现有的测试，也不是代码，也不是开发人员，也不是开发过程，也不是管理，与项目无关。此外，测试不会增加软件的质量（质量必须是内置的，是开发过程的一部分）。拥有优质产品的唯一途径是打造优质产品；该产品在其构建中没有质量，因此需要对其进行重建：

*   将现有源代码视为一次性原型或文档
*   逐步构建新产品，可选择合并旧源代码的合适片段（如果有）。

但是进行代码检查（并纠正通过代码检查发现的缺陷）可能会更快。那将是功能测试的补充。

您是否不仅要对其进行测试，还要花费额外的时间来开发自动化测试，这取决于您是否要维护该软件（即，将来以任何方式对其进行更改然后重新测试）它）。

您还需要：

*   任何一个：
    *   了解功能规范（和非功能规范）
    *   有线索的开发人员和/或 QA 人员
*   或者：
    *   一个小而简单的产品
    *   耐心、宽容的最终用户
    *   产品交付后的持续技术支持

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:02:13.793

我认为这是一个好的质量保证测试的用武之地。写出老式的测试用例并分发给团队中的多个人进行测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T18:57:44.180

在生命周期的这个时候进入项目时，我在开发实践中采用的一种技术是在报告缺陷时添加单元测试（由 QA 或最终用户）。您不会获得现有代码库的完整代码覆盖率，但至少通过这种方式可以通过测试驱动和记录未来的开发。同样，您应该确保您的测试在实施之前失败。如果您编写测试并且它没有失败，则测试是错误的。

此外，当您向系统添加新功能时，请通过测试启动这些功能，以便至少测试这些子系统。当新系统与现有系统交互时，请尝试围绕旧边界层添加测试，并随着时间的推移逐步适应。虽然这些不会是单元测试，但这些集成测试总比没有好。

重构是测试的另一个主要目标。没有测试的重构就像没有网的绳索。您可能会成功到达另一边，但风险值得回报吗？

# .net - 在 wcf 请求中停止执行

> ID：893061
> 
> 赞同：0
> 
> 时间：2009-05-21T13:57:04.163
> 
> 标签：.net, wcf

我正在尝试以`AfterReceiveRequest`消息检查器的方法回复 WCF 请求（实现`IDispatchMessageInspector`）

```
 XmlReader xmlReader = XmlReader.Create(
    new StringReader(string.Format(@"<{0}Response xmlns='{1}' />",methodName,namespace)));

  Message replyMsg = Message.CreateMessage(request.Version, request.Headers.Action, xmlReader);
  OperationContext.Current.RequestContext.Reply(replyMsg); 
```

客户端通过这种方式立即得到响应。

剩下的任务是中断服务器上的执行并最终没有错误。

request.Close() 会中断执行，但是如果您查看 'BeforeSendReply' 中的消息，则会产生错误。

好吧，它不适合我们，正在寻找一个方便的终止。有什么办法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T14:22:00.667

这可能是预期的行为。我不认为你能解决这个问题。

在将消息传递给方法之前使用消息检查器进行除观察或调整之外的任何事情可能是一个坏主意。看起来您正在尝试做的事情更适合您的操作实施。您应该看到消息检查器作为在将消息传递给调度员之前查看或调整消息的机会。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-25T15:48:57.737

我知道这是一个老问题，但我遇到了同样的问题并最终找到了解决方案，现在我将与您分享。

您真正想要做的事情是防止根据您在`AfterReceiveRequest`方法中发现的某些条件调用服务操作。为此，您需要添加`IOperationInvoker`与您的消息一起使用的`IDispatchMessageInspector`

```
class CustomMessageInspector : IDispatchMessageInspector
{
    public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)
    {
        if (SuppressRequest(request, channel, instanceContext))
        {
            request.Properties.Add("SuppressMe", true);
        }
    }

    // Other code omitted
}

class CustomInvoker : IOperationInvoker
{
    public object Invoke(object instance, object[] inputs, out object[] outputs)
    {
        // If the message inspector added the "SuppressMe" property, then don't
        // invoke anything and create an empty output.
        if (OperationContext.Current.IncomingMessageProperties.ContainsKey("SuppressMe"))
        {
            bool suppress  = (bool)OperationContext.Current.IncomingMessageProperties["SuppressMe"];
            if (suppress)
            {
                outputs = null;
                return null;
            }
        }

        // Otherwise, go ahead and invoke the operation
        return invoker.Invoke(instance, inputs, out outputs);
    }
} 
```

然后，您可以使用常规方法（通过配置文件中指定的属性或端点行为）将此消息检查器和此调用程序与您的操作联系起来。

# gis - 有没有办法让图形文本在 ArcMap 中按比例缩放？

> ID：893065
> 
> 赞同：0
> 
> 时间：2009-05-21T13:57:38.903
> 
> 标签：gis, arcgis, arcobjects, arcmap

我正在使用此代码在 ArcMap 中创建文本。但是当你放大时，我似乎无法让它像注释文本一样缩放。

有谁知道如何做到这一点？

```
//'First setup a color.  We'll use RGB red    
                IRgbColor pRGBcolor = new RgbColor();
                pRGBcolor.Blue = 0;
                pRGBcolor.Red = 255;
                pRGBcolor.Green = 0;

                //'Next, cocreate a new TextElement    
                ITextElement pTextElement = new TextElementClass();

                //'Query Interface (QI) to an IElement pointer and set    
                //'the geometry that was passed in    
                IElement pElement = pTextElement as IElement;
                pElement.Geometry = Point;

                //'Next, setup a font
                stdole.IFontDisp pFontDisp = new stdole.StdFont() as stdole.IFontDisp;
                pFontDisp.Name = "Arial";
                pFontDisp.Bold = true;

                //'Next, setup a TextSymbol that the TextElement will draw with    
                ITextSymbol pTextSymbol = new ESRI.ArcGIS.Display.TextSymbolClass();
                pTextSymbol.Font = pFontDisp;
                pTextSymbol.Color = pRGBcolor;
                pTextSymbol.Size = Size;
                pTextSymbol.HorizontalAlignment = esriTextHorizontalAlignment.esriTHACenter;
                pTextSymbol.VerticalAlignment = esriTextVerticalAlignment.esriTVACenter;
                pTextSymbol.Angle = Angle;
                pTextSymbol.Text = Text;

                //'set the size of the text symbol here, rather than on the font        
                //'Next, Give the TextSymbol and text string to the TextElement    
                pTextElement.Symbol = pTextSymbol;
                pTextElement.Text = pTextSymbol.Text;
                pTextElement.ScaleText = true;

                ESRI.ArcGIS.Carto.IElementProperties3 aoElementPro = pTextElement as ESRI.ArcGIS.Carto.IElementProperties3;
                aoElementPro.ReferenceScale = cGISHelpers.MapDomain.Map.MapScale; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:05:39.857

据我所知，您无法将 TextSymbol 与地图一起缩放。这是因为 TextElement 不能根据地图的范围进行更改，而是使用字体大小来确定它将出现在屏幕上的大小。

在仍然使用 TextSymbol 的同时，我能想到的最好方法是随着范围的变化改变点的大小（如果范围足够大，隐藏/显示元素）。我不知道“关注范围的文本控件”，这是您真正需要的。

或者，您不能只使用注释图层或标记要更改文本大小的图层吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T13:58:35.480

我们可以很好地添加根据比例改变大小的文本。为此，我们需要使用 IElementProperties3.ReferenceScale 属性。

我没有 C# 代码，但附上了一些您可以修改的示例 VBA 代码。

```
'--------------------------------
Sub ChangeTextElemRefScale()
    Dim pDoc As IMxDocument
    Dim pContainer As IGraphicsContainer
    Dim pElement As IElement
    Dim pTextElement As ITextElement
    Dim pActiveView As IActiveView

    Set pDoc = ThisDocument
    Set pActiveView = pDoc.ActiveView
    Set pContainer = pActiveView

    'Loop through the graphics container
    pContainer.Reset
    Set pElement = pContainer.Next
    While not pElement Is Nothing
        'Get the specific text element
        If TypeOf pElement Is ITextElement Then
           Set pTextElement = pElement
           If pTextElement.Text = "oregon" Then  'change this to your text element's text
                Dim pElemProp As IElementProperties3
                Set pElemProp = pTextElement
                pElemProp.ReferenceScale = 15000000
            End If
        End If
        Set pElement = pContainer.Next
    Wend

    pDoc.ActiveView.PartialRefresh esriViewGraphics, Nothing, Nothing
End Sub
'-------------------------------- 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T12:19:39.110

有`ITextElement`一个财产`ITextElement.ScaleText`。将此设置为`true`，文本大小将自动适应。

# c# - GdiPlus 溢出异常

> ID：893069
> 
> 赞同：3
> 
> 时间：2009-05-21T13:59:02.693
> 
> 标签：c#, gdi+

我最近通过第 3 方工具在 GDI+ 中遇到了一个溢出异常，这给我带来了一些问题。我正在尝试找出造成这种情况的原因，然后决定是否有任何解决方案。

SafeNativeMethods.Gdip.GdipFillPath() 中发生错误，返回错误代码 11，它等于 GpStatus.ValueOverflow。我不知道这意味着什么，或者可能是什么原因造成的。后果是相当高的，因为我有大面积的屏幕无法绘制。

此错误的堆栈跟踪是：

System.OverflowException：溢出错误。在 System.Drawing.Graphics.CheckErrorStatus(Int32 状态) 在 System.Drawing.Graphics.FillPath(Brush Brush, GraphicsPath path) at Northwoods.Go.GoShape.DrawPath(Graphics g, GoView view, Pen pen, Brush Brush, GraphicsPath path ) 在 Northwoods.Go.GoRoundedRectangle.Paint(Graphics g, GoView view) at Northwoods.Go.GoLayer.Paint(Graphics g, GoView view, RectangleF clipRect) at Northwoods.Go.GoView.PaintObjects(Boolean doc, Boolean view, Graphics g, RectangleF clipRect) at Northwoods.Go.GoView.PaintView(Graphics g, RectangleF clipRect) at Northwoods.Go.GoView.onPaintCanvas(PaintEventArgs evt) at Northwoods.Go.GoView.OnPaint(PaintEventArgs evt) at System.Windows.Forms System.Windows.Forms 中的 .Control.PaintWithErrorHandling(PaintEventArgs e, Int16 layer, Boolean disposeEventArgs)。

显然这里使用了 2 个参数。我无法控制的 GraphicsPath 和 Brush。画笔是由静态方法返回的，为了确保它没有被 Disposed 我尝试更改 Brush 属性以返回如下所示的克隆。然而，这似乎没有产生任何影响。

```
public Brush 
{
   get {
         return MappingLinearGradient(this.Bounds).Clone();
       }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:06:06.767

IIRC，Graphics 对象的最大平面区域为 (1 << 24) - 1 => 1670 万像素。

我不确定该地区本身是否有限制，但我会调查一下。

# java - 极其高效的服务器

> ID：893070
> 
> 赞同：3
> 
> 时间：2009-05-21T13:59:27.950
> 
> 标签：java, networking

我正在开发一个基于客户端-服务器的金融警报应用程序，客户端可以将一个值设置为所选金融工具的警报，当达到该值时，监控服务器将以某种方式提醒客户端（电子邮件、短信 .. . 不重要） . 服务器将监视来自数据生成器程序的更新。现在，服务器必须非常高效，因为它必须处理许多客户端（可能超过 50-100.000 个警报，更新时间为 1.2 秒）。我以前写过服务器，但从来没有这样强加的性能，我我只是害怕一个基本的方法（像以前一样）不会这样做。那么我应该如何设计服务器？，什么样的数据结构最适合？..多线程呢？....

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:43:34.240

您可能想考虑使用经过验证的[消息队列](http://en.wikipedia.org/wiki/Message_queue)系统，因为听起来这基本上就是您在应用程序中所做的事情。

[Apache 的 ActiveMQ](http://activemq.apache.org/)或[RabbitMQ](http://www.rabbitmq.com/)等项目已经被广泛使用并经过高度调整，并且应该能够支持您所说的开箱即用的负载类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T14:04:51.700

我以前在这样的服务器上工作过。它们都是用 C（或相当简单的 C++）编写的。但它们的性能甚至更高——每秒处理 20K 更新（所有更新都来自大多数主要证券交易所）。

我们将专注于不复制内存。我们在使用什么 STL 类时*非常*小心。就更新而言，每个金融工具都是一个对象，任何想了解该工具的客户都会订阅它（即被添加到列表中）。

服务器是多线程的，但不是很重——也许一个线程处理传入的更新，一个处理传出的客户端更新，一个处理客户端订阅/发布通知（不记得那部分——只记得它的线程比我少本来可以预期的，但不仅仅是一个）。

编辑：哦，在我忘记之前，发生的金融交易数量正在以指数速度增长。那台 20K/秒的服务器只是勉强跟上，架构师们对明年要做什么感到压力重重。我听说所有主要的金融公司都面临着类似的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:08:38.823

当心任何需要集群应用服务器才能获得合理性能的架构。伦敦证券交易所最近遇到[了这样的问题](http://www.reuters.com/article/ousiv/idUSL01084620080908)，当时他们取消了现有的基于 Tandem 的系统并用集群 .Net 服务器替换它。

从单个 Java 或 .Net 服务器获得这种类型的性能会遇到很多麻烦——确实需要考虑 C 或 C++。集群架构更容易构建和部署错误，并且更难保证正常运行时间。

对于非常大的容量，您需要考虑将异步 I/O 用于网络（即 poll()、select() 和异步写入或它们的 Windows 等效项），可能使用工作线程池。阅读有关 C10K 问题的更多信息，以了解更多信息。

有一个*非常*成熟的 C++ 框架，称为[ACE](http://www.cs.wustl.edu/~schmidt/ACE-overview.html)（自适应通信环境），专为电信中的大容量服务器应用程序而设计。它可能是您产品的良好基础——它支持多种并发模型并处理框架内的大多数同步细节。您可能会发现，花在学习如何驱动此框架上的时间可以让您减少开发并简化实施和测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:57:46.973

最好的建议是设计您的服务器，使其水平扩展。

这意味着将您的输入事件分发到一个或多个服务器（在相同或不同的机器上），这些服务器单独决定它们是否需要处理特定的消息。

您会在第一天支持 50,000 个客户吗？那么这应该是您关注的重点：您如何轻松地定义单个客户端的需求，以及您可以在单个服务器上支持多少个客户端？

第二好的建议是不要人为地限制自己。如果您说“我们不能拥有一台以上的机器”，那么您已经为失败做好了准备。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T21:02:15.710

您应该尝试找到一种将警报组织为树的方法，并能够快速确定更新可以触发哪些警报。

例如，假设警报是某个指标的级别。所述指标可以具有0、n的范围。我会将希望通知该指标级别的客户分组在一种二叉树中。这样您就可以适当地扩展它（您实际上可以在不同的机器上将子树实现为进程），并且找到正确的客户端子集所需的匹配数始终是对数的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T14:02:36.447

我认为从它中挤出每一滴性能*并不是*您想要做的，因为您真的不希望该服务器承受足够大的负载以使其脱离实时响应场景。

相反，我会使用一台单独的机器来处理消息传递客户端，并让那个主要的、关键的服务器直接专注于“实时”处理输入数据以观察警报标准。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T18:01:41.440

一个用于接收仪器更新的线程，它将处理更新并将其放入 BlockingQueue。

一个线程从 BlockingQueue 获取更新并将其交给处理该工具或一组工具的进程。此过程需要将事件序列化到仪器，以便客户不会收到乱序通知。

此过程（线程）将需要遍历注册以接收通知的客户列表，并根据其标准创建应通知的客户列表。然后，该流程应将列表移交给另一个将更改通知客户的流程。

通知进程应该遍历列表并将每个通知事件发送到另一个处理客户希望如何被通知的进程（电子邮件等）。

问题之一是 100,000 名客户同步访问客户列表及其要监控的标准。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T12:32:51.640

[Apache Mina](http://mina.apache.org/)网络应用程序框架以及用于消息路由的[Apache Camel](http://camel.apache.org/)可能是一个很好的起点。[Kilim](http://www.malhar.net/sriram/kilim/)消息传递框架看起来也很有前途。

# language-agnostic - 什么是文档齐全、稳定、安全且可扩展的 Web 应用程序框架？

> ID：893076
> 
> 赞同：6
> 
> 时间：2009-05-21T14:00:29.273
> 
> 标签：language-agnostic, web-frameworks

我们正在为我们的公司构建一个 RESTful API，它将提供 XML、JSON 和可能的其他内容类型。

我的团队正在寻找一个框架（按优先级排序）：

1.  有据可查
    *   理想情况下，拥有良好的教程、蓬勃发展的社区和知识库
2.  遵循合理的设计模式
    *   大多数情况下，我们希望框架保持一致。不会根据您调用的方法调用而改变的命名约定。
3.  安全的
    *   专注于*强制*开发人员对 GET、POST、PUT 和 DELETE 变量执行某种形式的验证
4.  稳定的
    *   部分原因是成熟度，因为框架不会经常变化
    *   另一部分是一个有据可查的错误列表，它并不大
5.  可扩展/面向性能
    *   我们在全球拥有超过 50,000 个需要高可用性的用户。如果我们的应用程序出现故障，人们的家中就没有互联网。所以这是一个非常关键的环境。
    *   理想情况下，我们可以在 10 台服务器上启动相同的代码库，然后继续添加负载均衡器。我们不想定义哪个服务器在哪个方法上......
6.  与 Linux/MySQL 环境完美集成
    *   我们没有单一的 MS 服务器。我们不会改变这一点。对不起.Net粉丝:-D

我意识到这是一个模糊的目标。不会有任何一种框架可以满足所有这些需求，实际上可能会有许多框架以不同的方式、形状和形式满足它们。

这与语言无关。我们已经有 PHP 方面的经验，但我们也有一些开发人员在他们的生活中从未编写过 Web 应用程序，因此学习 Python 或 Ruby 或 Java 是可以接受的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T22:09:14.463

我会在这里冒险并建议 Ruby 与**[Sinatra](http://www.sinatrarb.com/)一起使用。**

为什么？

1.  Sinatra 不是“有据可查”，而是“有据可查”。考虑到它比其他框架简单得多，因此不需要太多的文档，而且由于它是基于 Rack 作为网络服务器构建的，因此它与它共享一些通用文档。但是你需要知道的是在网站上，它写得很好，没有我发现的错误（IE，都是最新的）。

    您需要了解的大部分内容都在[Sinatra 手册](http://www.sinatrarb.com/book.html)、[自述文件](http://www.sinatrarb.com/intro.html)和[常见问题解答](http://www.sinatrarb.com/faq.html)中。尽管这本书的工作正在进行中，但它的内容非常准确和有用。而且，如果您仍然遇到问题，请访问 IRC 聊天室 freenode.net#sinatra。

2.  Sinatra 能够在基于功能/路由的逻辑方法中使用，或者通过覆盖 Sinatra::Application 对象。您可以使用其中任何一种，将您的逻辑和方法拆分为不同的文件，或者将它们全部保存在一个文件中。全取决于你。

3.  Sinatra 本身就是安全的。您必须验证用户发送的所有变量，因为除了解析它们并将它们传递给您之外，Sinatra 并不关心它的有效性。因此，您要么强制执行变量的有效性，要么后悔。 `;-)`

4.  Sinatra 在过去四个月里并没有改变很多，但它肯定有维护和小更新。此外，我没有发现错误列表很大或有威胁性。它几乎拥有我构建应用程序所需的一切。

5.  Sinatra 不必与Passenger 一起部署，但可以轻松定制以提高速度。如果你使用[Enterprise Ruby](http://www.rubyenterpriseedition.com/)和[Thin](http://code.macournoyer.com/thin/)之类的东西，你可以代理到 Nginix 或 LightHTTPd。如果您使用两台服务器，您可以将一台作为主服务器（使用代理和多个线程），将第二台作为数据库服务器（使用 MySQL 和许多线程）并让它们松动。这样，任务就分布在服务器上。它会给你比我想象的Passenger更多的控制权。（更不用说更好的性能了。）

    我发现，与 Rack、Mongrel 或 Thin 运行的线程相比，Passenger（在 Dreamhost 上）的性能相对较差。也就是说，一旦加载，应用程序即使在那个环境中也是响应式的。如果我要预测的话，扩展应用程序不会有问题，因为您只需要重新部署代码并重新启动线程——没有什么是不能放入 Capistrano 的。

6.  Linux 上的 Ruby 速度很快，实现起来也不成问题。使用 Ruby 的 MySQL 很简单，并且有几个非常好的 ORM 包可用，比如[ActiveRecord](http://ar.rubyonrails.org/)和[Sequel](http://sequel.rubyforge.org/)。Sinatra 不会让你选择一个你讨厌的。

除了你的问题的答案，我还有几个原因。

1.  Sinatra 的学习曲线很简单，而且很容易上手。我遇到的最大问题是将它安装到我的 Dreamhost 服务器上，因为 Rack 是旧版本，但是使用 Rack 的供应商版本，问题就消失了。如果可以的话，我会用 ActiveRecord 重写我在 Sinatra 中的最新 Rails 项目，以便于自己进行维护；已经花费了太多的精力。

    由于它易于使用和易于学习，我发现自己在没有代码生成器的 Sinatra 中比在具有所有代码生成器的 Rails 中更有效率。这说明了一些事情。

2.  Sinatra 支持Rack 的*中间件*，因此可以灵活地使用它。

3.  如果我要平均一下 Sinatra 社区的帮助，在 IRC 上，我会说他们比普通的 Rails 用户更了解该框架——只是作为粗略的比较。原因是 Rails 更容易被新手和没有业务编程的人使用。

4.  Sinatra 将支持 Ruby 1.9。我仍然不能完全确定 Sinatra 目前对 1.9 有多少支持，但我知道他们最初在 Rack 上等待。 [从 4 月 25 日起](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/334996)，这不再是一个问题，所以大概 Sinatra 已经为 1.9 做好了准备；事实上，我知道 1.9 支持将在 2009 年中期进行，但我不知道那会持续多久。

    假设您可以让 Sinatra 与 Ruby 1.9 一起工作（版本 0.9.2 已经支持 Rack 1.0，并且在 Rack 的代码中通过代理 1.9），在支持 1.9 的公共 1.0 之前，您在 Ruby 方面的表现将是一流的. 即使您不能，Enterprise Ruby 也会帮助提高速度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T14:20:08.173

Django 和 Rails 都非常接近您的大多数标准，除了我认为 Django 的文档*比*Ruby on Rails 的文档要好得多；Django 的文档*简直太棒*了（我不是在这里夸张）。

不过，我不知道 Django 的可扩展性。我知道 Rails 的扩展性很好（在一定程度上），但我不知道 Django 是否也可以这样说。（我并不是说它*不能*；我只是说我真的不*知道*，因为我从来没有使用 Django编写过*大型应用程序。）*

Django 也有[一匹小马](http://djangopony.com/)，以防你也暗中想要它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T14:19:18.097

出色地。可扩展性并非易事。对于类似 Google 的响应时间，您需要类似[MapReduce](http://en.wikipedia.org/wiki/MapReduce)的东西。好的。不要自欺欺人，超级可扩展性对初学者来说毫无意义。

至于所有其他点，[Seaside](http://seaside.st)显然是最好的。至于安全性，请查看[seaside.st](http://www.seaside.st/about/security)以了解为什么它本质上比我所知道的所有其他框架（包括 Rails 和 Seam，例如）更安全。Seaside 的文档相当完备，而且查看 seaside 的内部结构也非常简单方便，几乎没有一个问题可供社区回答，通常情况下它会很快回答。Seaside 多年来一直很稳定，所以我想你会没事的。

至于面向性能：运行商业 Seaside，[GLASS](http://seaside.gemstone.com/)，与类似 LAMP 的设置相比，您将获得惊人的性能，因为集成了更快的数据库解决方案，以及以内存换取速度并获得大量性能的框架速度。

Seaside 的架构非常好，以至于许多人发现编写 Seaside 应用程序比桌面应用程序更容易。试试看，你会喜欢的。

PS：作为记录，Seaside 不是 RESTful。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T14:24:24.640

你可以看看 Django, Python 框架。这是一个文档齐全的框架，它在数据库上有一个自动 CRUD 管理员界面，它还有一本免费的在线书籍，当然你可以真正购买 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T14:06:11.743

试一试，找出正确答案！

好吧，那些会建议“一个框架来统治他们所有人”的人也不会尝试所有这些！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T14:20:18.190

我认为就绝对数量的文档而言，您无法击败 J2EE。它也被认为具有疯狂的可扩展性和稳定性。

现在，从那里到真正令人向往......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T14:05:00.683

我想如果有这样的框架，那将是唯一的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T14:07:20.523

对于 PHP，我喜欢 Zend 框架（尽管对我来说它并不是一个真正的框架）。它的最佳功能之一是每个组件都独立于其他组件......因此，如果您不喜欢其中的某些部分，请不要使用它。另外，您提到了 JSON ...... Zend 完全支持两个方向的 JSON ......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T14:12:33.557

Ruby on Rails 包含大量插件的大量文档，并且已经在可扩展性方面进行了测试（请参阅 BaseCamp 和其他在 rails 中制作的解决方案）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-21T14:14:56.653

如果您正在考虑使用 Java，我会推荐[Jersey](http://jersey.java.net)，它效果很好，我认为它可以达到您的 5 个目标......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T14:15:40.320

查看您的优先事项列表，很难说任何一条路线都是“正确”的方式。在 PHP 方面，我花费了大量时间使用 CakePHP，它完成了您所寻找的大部分工作。但作为一个讨厌 PHP 的人，我建议避开该领域的任何事情。

一切都与风格和经验有关。我使用过 Ruby On Rails，它不是最优雅的语言，但它的工作非常出色。它还没有像在 Java 上使用 Spring/Hibernate 堆栈或使用 .Net 那样成熟，后者可以直接处理几乎所有内容，但它的工作非常出色。我更喜欢基于 Java/.Net 的项目，因为它更适合我喜欢的编程方式。

没有“正确”的答案，只有很多好的答案。例如 ASP.Net MVC 就是一个不错的选择。很久以前，我在 Java 上使用 Spring，它在完成这项工作方面也相当有效。甚至 PHP 也不是一个错误的选择。Ruby On Rails，我只做过两个项目，它很容易上手，它使其他语言中一些相当复杂的任务变得相当简单。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-22T21:27:16.153

如果您的工具包中有 Java，请查看 Stripes。

摇滚稳定，热情，虽然没有一个壮观的大社区。好的文档，有些已经过时了，但是系统非常稳定，即使是“旧的东西”也是相关的。一本非常好的，最近（去年底）的书。条纹足够小，这本书可以而且确实“涵盖了所有内容”。

它是一个动作框架，在演示区域中并没有做太多事情（主要是表单除外，它有一个完全可选的模板/布局工具）。您可以使用 JSP 或 FreeMarker，或者，实际上，其他任何东西。它也可以做网络服务（虽然不如泽西岛）。

它与后端无关，但有一个 JPA 集成项目。

最后，您可以根据需要利用所有其他 Java/Java EE 工具包。由于 Stripes 不会占用整个堆栈，因此您可以灵活地挑选所需的部分。全船 Java EE、事务、会话 Bean、JMS。与 Spring 一起工作（它“意识到”Spring 并具有良好的集成）JPA、iBatis、Hibernate、原始 JDBC、Lucene、JSR-170 内容存储库等等。

这是一个很棒的套件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-10T13:51:26.620

对于 2014 年的答案，我会推荐 Laravel/Slim Framework (PHP)、Ruby on Rails/Sinatra (Ruby)、Django/Flask (Python)、Grails（Groovy、基于 JVM 的语言）、Play！框架 (Java/Scala) 或 Sails.js/Kraken.js (Javascript)。

对于我提到使用“/”的两个框架的语言，提到的第一个框架要大一些，而第二个框架要小一些。

我希望这对 5 年后有类似问题的人有所帮助。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-08-14T09:43:34.553

试试[cppcms](http://cppcms.com/wikipp/en/page/main)

它是一个高性能的 Web 开发框架

# wpf - 我想在 wpf 中创建一个组合框

> ID：893078
> 
> 赞同：0
> 
> 时间：2009-05-21T14:00:40.490
> 
> 标签：wpf, c#-3.0

我想创建一个具有某种风格的组合框。我不想要我们得到的旧下拉列表。我想要一些看起来很不错的新下拉列表。有没有办法创建这样的下拉菜单。请给我建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:12:17.923

[在 msdn 上查看此链接。](http://msdn.microsoft.com/en-us/library/ms752094.aspx) 这是组合框的实际控制模板。您可以将其复制并粘贴到您的应用程序中（在您的[应用程序的 Resources](http://msdn.microsoft.com/en-us/library/ms746624.aspx)中）。

创建一个表单并在其上添加一个组合框，其中包含一些数据。然后开始更改控制模板并查看结果。只需更改颜色并在元素周围添加边框即可开始，以查看是什么控制了哪个部分。然后，您可以开始切换模板的较大部分以匹配您要查找的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:04:28.250

可以从标准的组合框开始，然后使用各种控件和样式来改变控件的外观和感觉，并对应下拉。

# sql - MS Access - 选择 Char 作为日期并进行日期差异

> ID：893080
> 
> 赞同：0
> 
> 时间：2009-05-21T14:01:54.527
> 
> 标签：sql, ms-access

我有两列。ColA 和 ColB 包含带有数据“20090520”和“20090521”的 char(10)。

我想以天为单位选择并获取日期差异。我曾尝试使用 Format() 和 CDate() 但 MS Access 始终显示为 #ERROR。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:08:09.087

Access 更喜欢这种格式的日期：

```
#2009-12-01# 
```

您可以将日期转换为 Access 可以理解的日期：

```
CDate(Format([ColA], "0000-00-00")) 
```

或者：

```
DateSerial(Left([ColA],4),Mid([ColA],5,2),Right([ColA],2)) 
```

并以您喜欢的格式显示结果：

```
Format(<date here>, "dd-mm-yyyy") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:08:03.703

尝试使用 DateSerial() 转换日期：

```
DateSerial(Left([FieldName],4),Mid([FieldName],5,2),Right([FieldName],2)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:40:21.823

如果可能，请将数据类型更改为日期数据类型。您不应将日期存储为字符数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T01:49:46.457

我正在连接到另一个我无法控制的数据库。这就是为什么会出现这个问题。感谢您的反馈。

# perl - 我应该如何处理来自同一字符串中不同 UNICODE 数字集的数字？

> ID：893083
> 
> 赞同：4
> 
> 时间：2009-05-21T14:02:30.767
> 
> 标签：perl, unicode

我正在编写一个将 UNICODE 数字音译为 ASCII 数字的[函数](http://gist.github.com/115461)，如果字符串包含来自不同 UNICODE 数字集的数字，我有点难过。例如，如果我有字符串“\x{2463}\x{24F6}”（“④⓶”）。如果我的功能

1.  返回 42？
2.  呱呱说字符串包含混合集？
3.  鲤鱼字符串包含混合集并返回 42？
4.  给用户一个额外的参数来指定上述三种行为之一？
5.  做别的事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:17:53.047

您当前的功能似乎执行 #1。

我建议你也应该写另一个函数来做#4，但**只**在需求出现时，**而不是之前**。

我敢肯定 Joel 最近某个时候在一篇博客文章中写过关于“过早实现”的文章，但我找不到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T05:43:17.563

如果您必须处理大于 10 的基数的输入，您最终可能不得不将拉丁字母 ('ABCDEF') 前 6 个字母的许多变体视为所有形式的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T14:24:33.500

我不确定我是否看到了问题。

您支持从一系列脚本进行数字转换，也就是说，您知道其数字字符的 Unicode 代码点。

如果您在输入数据中发现未知代码点，则为错误。

发生错误时如何处理取决于您；您可以插入空格或下划线，也可以中止转换。你会做什么取决于你的函数执行的环境；这不是我们可以告诉你的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T16:11:31.130

我最初的想法是#4；严格基于我喜欢选项的事实。但是，当我查看您的功能时，我改变了主意。

该函数的目的似乎很简单，就是得到结果数字 0..9。用户可能会发现发送混合组很有用（一个功能:)。我会用它。

# iphone - iPhone 的 libbz2.dylib 的标头在哪里？

> ID：893087
> 
> 赞同：1
> 
> 时间：2009-05-21T14:03:05.727
> 
> 标签：iphone, compression, header

iPhone 上的 libbz2.dylib 标头丢失，或者包含在不太明显的位置。我已经寻找 bzlib.h、bz2lib.h、bz2.h 等，寻找模式，但一无所获 - 它们是否包含在 SDK 中，或者我是否需要从主 libbz2 发行版中提取标题和改用那个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:19:47.847

由于该库显然在设备上可用，因此标头确实应该在 SDK 中，但似乎不是。我会使用为模拟器打包的那个，因为这很可能与设备上的那个相同：

```
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk/usr/include/bzlib.h 
```

然后打开一个[Radar](http://bugreport.apple.com/)案例，要求修复分布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-19T06:32:05.540

从以下站点获取 bzlib-0.5.0.0.tar.gz 文件并将 cbits 目录中的文件（.h 和 .c）复制到您的 Xcode 项目中。

[http://hackage.haskell.org/package/bzlib](http://hackage.haskell.org/package/bzlib)

到目前为止，它似乎有效，我已经设法使用函数 BZ2_bzReadOpen 和 BZ2_bzRead 读取了 .bz2 文件的内容。

# php - 使用外键关系同时创建两行

> ID：893091
> 
> 赞同：0
> 
> 时间：2009-05-21T14:04:03.353
> 
> 标签：php, mysql

使用 php 和 mysql

我有两个表，一个用户表和一个配置文件表。

在我的网站上创建新帐户时，会同时创建用户行和个人资料行。

我想要一个外键从用户表引用到配置文件表，以便用户配置文件信息将存储在单独的表中。

我的问题是，如何确保外键链接到正确的配置文件表。

我将要这样做的当前方法是，在创建新用户和配置文件行后，我将按降序查询配置文件以创建最后一行并获取配置文件 ID 并将其插入用户表配置文件 ID 外键参考。我确信必须有更好的方法来做到这一点......不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:05:41.540

*   [使用mysql_query()](http://au2.php.net/mysql_query)创建用户；
*   假设 users 表的主键是一个自增字段，调用[mysql_insert_id()](http://au2.php.net/manual/en/function.mysql-insert-id.php)；
*   插入配置文件时将其用作外键。

# deployment - ClickOnce 存储元数据“AppType”无效

> ID：893108
> 
> 赞同：1
> 
> 时间：2009-05-21T14:07:05.720
> 
> 标签：deployment, registry, clickonce

我有使用 ClickOnce 部署的应用程序。它可以在大约十几台机器上运行，但只有一台。我收到以下错误。我从[http://groups.google.com/group/microsoft.public.dotnet.distributed_apps/msg/42d44ffe781d3610](http://groups.google.com/group/microsoft.public.dotnet.distributed_apps/msg/42d44ffe781d3610)找到了解决方案，但它需要去注册表并删除 AppType，这不是最好的解决方案，因为每次我有新版本，它会再次失败。

有没有人知道这种类型的错误，以及如何处理它。

非常感谢。

真诚的，弗拉德。

=========================================== 平台版本信息 Windows : 5.1.2600.131072 （Win32NT）公共语言运行时：2.0.50727.3053 System.Deployment.dll：2.0.50727.3053（netfxsp.050727-3000）mscorwks.dll：2.0.50727.3053（netfxsp.050727-3000）dfdll.dll：2.0.50727（netfxsp.050727-3000）dfdll.dll：2.0.50727\. 050727-3000) dfshim.dll : 2.0.50727.3053 (netfxsp.050727-3000)

来源部署网址：file://xxx\yyy.application

错误摘要 下面是错误摘要，这些错误的详细信息在日志后面列出。* 激活 file://\xxx\yyy.application 导致异常。检测到以下失败消息： + 存储元数据“AppType”无效。+ 输入字符串的格式不正确。

组件存储事务失败摘要未检测到事务错误。

警告 此操作期间没有警告。

操作进度状态 * [5/20/09 12:22:26 PM]：file://\xxx\yyy.application 的激活已开始。

错误详细信息 在此操作期间检测到以下错误。* [5/20/09 12:22:27 PM] System.Deployment.Application.DeploymentException (SubscriptionState) - 存储元数据“AppType”无效。- 来源：System.Deployment - 堆栈跟踪：在 System.Deployment.Application.SubscriptionStore 的 System.Deployment.Application.ComponentStore.GetSubscriptionStateInternal(DefinitionIdentity subId) 的 System.Deployment.Application.ComponentStore.GetPropertyAppType(DefinitionAppId appId, String propName)。 GetSubscriptionStateInternal(SubscriptionState subState) 在 System.Deployment.Application.SubscriptionState.Validate() 在 System.Deployment.Application.SubscriptionState.get_IsInstalled() 在 System.Deployment.Application.SubscriptionStore.CheckAndReferenceApplication(SubscriptionState subState, Deployment.Application.ApplicationActivator.ActivateDeploymentWorker(Object state) --- 内部异常 --- System.FormatException - 输入字符串的格式不正确。- 来源：mscorlib - 堆栈跟踪：在 System.Number.ParseUInt32 的 System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal) (String value, NumberStyles options, NumberFormatInfo numfmt) 在 System.UInt16 .Parse(String s, NumberStyles style, NumberFormatInfo info) at System.Convert.ToUInt16(String value) at System.Deployment.Application.ComponentStore.GetPropertyAppType(DefinitionAppId appId, String propName)

组件商店交易详情 没有可用的交易信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T16:24:03.320

我在以下位置找到了答案：[MS 帮助和支持](http://support.microsoft.com/kb/942460)。遵循 Microsoft 的这些步骤后，您还需要做的是重新启动机器。重新启动机器后，一切都应该正常。

# .net - .NET 引用静态字段的序列化问题

> ID：893111
> 
> 赞同：1
> 
> 时间：2009-05-21T14:08:01.957
> 
> 标签：.net, serialization

我正在使用`SerializableAttribute`将对象写入`jack`磁盘。该对象有一个`department`引用`accounts`另一个类的静态字段的成员`Department`。在反序列化时，我发现`department`反序列化对象的成员不再指向与静态字段相同的对象，`accounts`而是指向另一个相同的副本。

所涉及的所有类和对象都是引用类型。我该如何解决这个问题？

（对不起，长代码帖子。）

```
#include "stdafx.h"

using namespace System;
using namespace System::IO;
using namespace System::Runtime::Serialization;
using namespace System::Runtime::Serialization::Formatters::Binary;

[Serializable]
ref class Department {
    static Department(){ accounts = gcnew Department(L"Accounts"); }
public:
    static Department ^accounts;
    // similarly other departments come here...

    String ^name;
    Department(String ^name) : name(name) { }
};

[Serializable]
ref class Employee {
public:
    String ^name;
    Department ^department;

    Employee(String ^name, Department ^department) : name(name),
        department(department) { }

};

int main(array<System::String ^> ^args)
{
    Employee ^jack;
    IFormatter ^formatter = gcnew BinaryFormatter();

    String ^option = Console::ReadLine();
    if(option == L"read"){
        Stream ^stream = gcnew FileStream(L"dingdong.bin", FileMode::Open,
            FileAccess::Read, FileShare::Read);
        jack = (Employee^) formatter->Deserialize(stream);

        if(jack->department != Department::accounts)
            Console::WriteLine(L"Different objects");
        else
            Console::WriteLine(L"The same object");
        stream->Close();
        Console::ReadLine();
    }
    else {
        jack = gcnew Employee(L"Jack", Department::accounts);
        Stream ^stream = gcnew FileStream(L"dingdong.bin", FileMode::Create,
            FileAccess::Write, FileShare::None);
        formatter->Serialize(stream, jack);
        stream->Close();
    }

    return 0;
} 
```

**编辑：**添加示例代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:36:22.867

在最简单的情况下，`[NonSerialized]`使用`IDeserializationCallback`恢复引用就可以了。您可以改为序列化部门代码。通常，如果您需要序列化此类单例对象，您可以[手动序列化引用对象并替换实现的 «reference» 对象](http://msdn.microsoft.com/en-us/magazine/cc301767.aspx)，`IObjectReference`或者可能使用[序列化代理](http://msdn.microsoft.com/en-us/magazine/cc188950.aspx)代替手动序列化来替换 «reference» 对象。

PS：一般来说，我不建议对任何严重的事情使用默认的二进制序列化，因为它往往会产生各种程序集绑定和版本控制问题。简而言之，*序列化是困难*的，不能做太多的简化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:11:16.007

我不认为你这样做。`f`序列化时，是静态字段当前值的序列化副本。当它被反序列化时，会创建一个相关类型的对象，并且它的值会从序列化的数据中得到水合。这些可能是引用类型，但序列化是关于在 A 和 B 之间传输对象的值，而不是它们的引用。

您正在保存到磁盘。当您从磁盘加载并反序列化时，您怎么知道它`f`及其静态字段仍在范围内？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T14:11:41.217

如果您查看 [NonSerialized] 属性文档，我想您会在那里找到这个示例。

* * *

好的，既然您已经发布了代码，那么问题就变得更加清晰了。您应该将 Department 类的静态部分分离为一个`Departments`类。部门列表或枚举与各个部门对象无关。

# c# - 我可以用动态 LInq 做到这一点还是有更好的方法 - Linq、C#、VS2008

> ID：893115
> 
> 赞同：2
> 
> 时间：2009-05-21T14:08:25.310
> 
> 标签：c#, linq

这是我的静态查询

```
 var results = from v in users
              join d in orders on v.UserId equals d.UserId
              join p in Products on d.ProductId equals p.ProductId
              where v.UserName.Contains(UserName)
              where v.FirstName.Equals(FirstName)
              where v.ZipCity.Equals(ZipCity)
              where v.OrderDate >= OrderDate && v.OrderDate < OrderDate
              where p.ProductName.Equals(ProductName)
              select v.Email, v.ShippingCity, v.TrackingNo; 
```

我正在查看动态 Linq 并试图扩展我对它的感觉。上面的查询在一个名为的方法中

```
GetOrder(string UserName, string FirstName, string ZipCity, DateTime OrderDate, ProductName) 
```

我可以使用 Dynamic Linq 执行此操作吗，仅当输入参数中 ProductName 不为空时才加入产品表？

我正在关注这个 [http://blog.bvsoftware.com/post/2008/02/27/How-to-create-a-Dynamic-LINQ-Query-Programmatically.aspx](http://blog.bvsoftware.com/post/2008/02/27/How-to-create-a-Dynamic-LINQ-Query-Programmatically.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:27:33.260

我想我会在 IEnumerable 上使用扩展方法而不是动态 LINQ。

```
var result = from v in users
             join d in orders on v.UserId equals d.UserId
             where v.UserName.Contains(UserName)
             where v.FirstName.Equals(FirstName)
             where v.ZipCity.Equals(ZipCity)
             where v.OrderDate >= OrderDate && v.OrderDate < OrderDate
             select v.Email, v.ShippingCity, v.TrackingNo, d.ProductId;

if (!string.IsNullOrEmpty(ProductName))
{
   result = result.Join( Products.Where( p=> p.ProductName == ProductName ),
                         d => d.ProductId,
                         p => p.ProductId,
                         (d,p) => new
                                  {
                                      d.Email,
                                      d.ShippingCity,
                                      d.TrackingNo
                                  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:20:32.197

看看我为这个问题给出的答案：

[构建搜索应用程序的最佳实践？](https://stackoverflow.com/questions/893036/best-practices-for-building-a-search-app/893072#893072)

# oracle - Oracle 分层查询：如何包含顶级父级

> ID：893118
> 
> 赞同：2
> 
> 时间：2009-05-21T14:09:12.830
> 
> 标签：oracle, hierarchical-data

我有一个分层查询来跟踪报告结构。这几乎可以工作，只是它没有报告最顶层的节点，可能是因为顶层的人向自己“报告”。

查询是：

```
select
  level,
  empid, 
  parentid
from usertable
connect by nocycle prior parentid= empid
start with empid = 50 
```

这会产生：

```
LEVEL  EMPID PARENTID               
------ ----- --------  
1      50    258            
2      258   9555
3      9555  17839 
```

我没有达到 4 级，因为它看起来像：

```
4      17839 17839 
```

在不更改数据的情况下，有没有办法修改我的查询以便返回所有 4 个级别？目标是得到 empids，所以我可以检查

`id in (hierarchical subquery)`

顺便说一句，如果我从查询中删除 nocycle，我会收到错误消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T15:17:29.383

克里斯，

您只得到 3 行，因为您的顶级行未设置为处理分层查询的方式。通常，Oracle 著名的 EMP 表中的顶级行或总裁 KING 没有经理。在您的情况下，您不应将 17389 的 parentid 设置为 17389 本身，而应设置为 NULL。要么相应地更新表，要么使用视图来适应这种情况。

一个例子：

```
SQL> select empno
  2       , mgr
  3    from emp
  4   where empno in (7876,7788,7566,7839)
  5  /

     EMPNO        MGR
---------- ----------
      7566       7839
      7788       7566
      7839       7839
      7876       7788

4 rijen zijn geselecteerd. 
```

EMP 表的这一部分有四个级别，其顶层行 (7839) 设置为自身。与您的 empid 17839 相同。这会导致使用您的查询仅三行：

```
SQL>  select level
  2        , empno
  3        , mgr
  4     from emp
  5  connect by nocycle prior mgr = empno
  6    start with empno = 7876
  7  /

     LEVEL      EMPNO        MGR
---------- ---------- ----------
         1       7876       7788
         2       7788       7566
         3       7566       7839

3 rijen zijn geselecteerd. 
```

使用（内联）视图将顶级的 mgr/parentid 列设置为 null：

```
SQL>  select level
  2        , empno
  3        , mgr
  4     from ( select empno
  5                 , nullif(mgr,empno) mgr
  6              from emp
  7          )
  8  connect by nocycle prior mgr = empno
  9    start with empno = 7876
 10  /

     LEVEL      EMPNO        MGR
---------- ---------- ----------
         1       7876       7788
         2       7788       7566
         3       7566       7839
         4       7839

4 rijen zijn geselecteerd. 
```

或者使用 UPDATE 语句修复您的数据：

```
SQL> update emp
  2     set mgr = null
  3   where empno = 7839
  4  /

1 rij is bijgewerkt.

SQL>  select level
  2        , empno
  3        , mgr
  4     from emp
  5  connect by nocycle prior mgr = empno
  6    start with empno = 7876
  7  /

     LEVEL      EMPNO        MGR
---------- ---------- ----------
         1       7876       7788
         2       7788       7566
         3       7566       7839
         4       7839

4 rijen zijn geselecteerd. 
```

完成修复后，您也可以省略 NOCYCLE 关键字。

问候，罗布。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T14:30:17.670

您需要以相反的方式进行层次结构，从根到叶。

```
select
  level,
  empid, 
  parentid
from usertable
start with empid = 17839
connect by empid != 17839 and prior empid = parentid

LEVEL                  EMPID                  PARENTID               
---------------------- ---------------------- ---------------------- 
1                      17839                  17839                  
2                      9555                   17839                  
3                      258                    9555                   
4                      50                     258                    

4 rows selected 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-10T09:44:45.457

你不必改变你的结构。

只需使用以下查询

```
select
  level,
  empid,
  parentid
from usertable
connect by prior parentid = empid
       AND parentid <> empid  -- This line prohibits cycling and ALLOWS a row where parentid = empid
start with empid = 50 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-06T10:51:08.683

Van Heddegem Roeland 的回答对我不起作用，我已经尝试过了，但是我设法在连接子句中没有内联视图的情况下通过添加：-

```
and prior empid <> parentid 
```

以下帖子解释了为什么会这样 - 如果你能理解它！虽然一旦你“明白”它确实合乎逻辑。（这与 <> 运算符每一侧的求值顺序有关。）

[Oracle：在用户数据中按循环连接](https://stackoverflow.com/questions/26464590/oracle-connect-by-loop-in-user-data)

内联视图可以工作，但如果不对您的特定数据集进行研究，我不知道内联视图可能对查询路径产生什么影响。在大多数情况下，添加额外的子句可能是“正确”的方法，恕我直言。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-21T14:32:52.920

好像你有一个数据周期。没有“nocycle”，它不会立即工作。如果您知道所有数据的最大嵌套级别为 4，那么您可以添加条件“和级别 <= 4”并删除 nocycle。应该管用。

# reporting-services - SSRS 报告网站存在问题

> ID：893128
> 
> 赞同：0
> 
> 时间：2009-05-21T14:12:11.590
> 
> 标签：reporting-services

所以我正在使用 SSRS (SQL Server 2005)，我们的一些应用程序使用它来生成下载。但是，它的问题在于用于管理它的报告网站似乎随机崩溃。我还没有找到它的押韵或理由——只是它会突然出现“指定的演员表无效”异常，并且任何进一步的尝试都会失败

> 找不到项目“/” (RsItemNotFound)

有什么地方可以让我开始寻找帮助我调试这个问题的地方吗？是否有比我收到的无用错误消息更深入的信息的日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:53:57.107

标准事件日志中有任何内容吗？您可能会在 (C:\Program Files\Microsoft SQL Server\MSSQL.3\Reporting Services\LogFiles) 中找到很多要查看的日志……至少这是默认路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:46:28.190

我们有一个网络应用程序在我工作的地方，偶尔在它被单独放置一段时间后，必须“重新编译”并且需要几秒钟才能显示页面。我注意到 ssrs 有时会这样做，它可能会也可能不会导致您的问题。

您可以通过在本地计算机上设置一个 ssrs 实例（您知道没有人会上）并针对它运行您的下载来测试这一点。

另外，请检查并确保在下载时没有人关闭任何东西或进行任何备份。

# django - Django 和通用视图

> ID：893130
> 
> 赞同：2
> 
> 时间：2009-05-21T14:12:23.417
> 
> 标签：django, views

我已经在 Django 中非常成功地编写了一个完整的应用程序，但是我有这个烦人的问题，我想我知道答案，但我只是想确定一下。

我真正喜欢 Django 的一件事是数据模型和不必做“显而易见”的事情的能力。例如，我们在应用程序中广泛使用管理界面。我不需要为每个模型编写编辑屏幕并在每次模型更改时保持最新状态，这一点非常好。

我感到困惑的是，我想让应用程序的一部分呈现模型的“只读”版本。本质上，我想要我在管理界面中拥有的东西，但没有可编辑的小部件。现在我注意到，从 Django 代码中，该管理界面实际上通过并替换了小部件以使用可编辑的小部件，因此我知道肯定存在不可编辑的。

但据我所知，没有办法只说“渲染这个对象”并让 Django 做“显而易见”的事情并像管理界面一样渲染它，但使用不可编辑的字段。我觉得这很难相信，因为它看起来像 a) 这比管理的东西更容易 b) 我知道小部件已经在那里。但我已经看遍了，甚至 Django 示例似乎总是创建一个模板并准确说明页面应该是什么样子。

一般来说，编写模板可能是一个好主意，但在开发的早期，当事情发生变化时，考虑到模型中可用的信息，最好有一些只做一些基本的东西。

我错过了什么吗？对不起，如果这是一个愚蠢的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:18:31.420

是不是大多数非玩具网站都想要自定义布局/html？

或者，您在寻找[Databrowse](http://docs.djangoproject.com/en/dev/ref/contrib/databrowse/)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T00:33:13.270

我用过这样的东西：http: [//www.djangosnippets.org/snippets/937/](http://www.djangosnippets.org/snippets/937/)

如果你用谷歌搜索“django read-only admin”或类似的东西，还有其他类似的东西。

永远不要低估 Django Admin 的灵活性……

# html - 更改文本字段的外观

> ID：893132
> 
> 赞同：0
> 
> 时间：2009-05-21T14:12:45.443
> 
> 标签：html, ruby-on-rails, css

当您发布新问题时，如何更改我的文本字段，使它们看起来更像 Twitter 登录文本字段，甚至是 Stackoverflow 的标题文本字段。

我目前只使用：

```
<%= text_field_tag 'name', @name, :size => 30 %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:34:03.277

# 用于 CSS 检查的 Firebug

您是否尝试过使用 FireFox 的[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)工具？

您可以检查网站上的元素并查看使用了哪些样式。

在 StackOverflow 标题输入的情况下，使用了以下样式：

```
input {
    margin:5px 0pt;
    padding:3px;
}
input, select, button {
    border:1px solid #999999;
    font-family:Trebuchet MS,Helvetica,sans-serif;
    font-size:100%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:26:26.443

我认为您需要添加：

```
<%= text_field_tag 'name', @name, :size => 5, :class => "cssclassname"  %> 
```

...然后定义一个名为'cssclassname'（或任何你想要的）的css类来设置css的样式。

一个不错的文本框 CSS 指南：

[http://www.cssportal.com/form-elements/text-box.htm](http://www.cssportal.com/form-elements/text-box.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T14:14:16.983

看看这里。

[http://www.webcredible.co.uk/user-friendly-resources/css/css-forms.shtml](http://www.webcredible.co.uk/user-friendly-resources/css/css-forms.shtml)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T14:16:52.877

实现您想要的一般原则是在 CSS 中的文本字段上指定细边框。要匹配 Stack Overflow Title 文本字段，请将其添加到您的 CSS 文件中：

```
input {
  border: 1px solid #999;
} 
```

# c# - 为多人共享一个简单的可执行文件？

> ID：893134
> 
> 赞同：3
> 
> 时间：2009-05-21T14:13:47.967
> 
> 标签：c#

*初级问题*

场景：有简单的字符串同音字工具，我以后可能会扩展。随着时间的推移，我对保持更新和“升级”很感兴趣。他们有权访问共享驱动器。

1.  共享一个可执行文件，他们只是有快捷方式吗？多个用户使用它？（可能有我可以稍后设置的个性化问题。）
2.  让他们将安装文件复制到他们的个人计算机并单独安装吗？
3.  如果适用，请告诉我如何使用“发布工具”简单地发布更新。是否相当简单并更新他们告诉他们更新可用？

我是初学者，所以一点帮助或指向初学者级别解释的链接会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T14:15:48.370

查看[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:17:32.327

我认为在共享/可广泛访问的驱动器上执行文件可能不是最好的主意。我们在谈论多少人？

由于您的组中只有 7-8 人，也许这里最好的解决方案是简单地在您的共享驱动器上提供安装程序可执行文件，这样您的用户就可以随时访问您的工具的最新版本并且可以安装闲暇时将其放在他们的机器上。

当然这里有更优雅的解决方案，但是对于这样一个小团体来说实施起来可能会很麻烦，特别是如果你没有得到报酬来分发这个工具给你的同行。

有时最简单的方法是最好的，我通常不会容忍手动操作，但在这种情况下，它可能最适合您。

祝你好运，
-罗伯特

# user-interface - UI/UX 设计或审计——如何衡量成本？

> ID：893140
> 
> 赞同：0
> 
> 时间：2009-05-21T14:15:39.773
> 
> 标签：user-interface

最近我被要求进行 UI 或 UX 审核，老实说，我真的不知道如何为此向人们收费......故事是我使用了一些门户 X，我开始抱怨这是多么不友好，他们要求我为他们做一个全面的审计......所以我做了......我花了 8 小时写了一份关于什么是好的和什么是坏的文档 - 总的来说，因为我们已经同意签订一份新合同进行详细审核（包括图形、与人交谈等），如果他们想要一般性的合同。

简而言之：

如何充电？我可以做类似的事情：价格*小时。但就像我已经使用那个门户网站大约两个月了，所以我不必去了解它，我什至不知道如何衡量它。我花了 8 小时写文档……我已经向他们收取了大约 200 美元，但我之前没有做过那种事情（不是在商业领域），所以我不能展示任何推荐或任何东西……我'我觉得这必须值得一些真正的现金，因为这真的很难而且经常人们会弄错......就像......真的真的错了......

很高兴听到 UI/UX 行业的人对此有什么看法。TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-23T23:40:01.547

我是一名专业的 UI 开发人员，我可以告诉你，我们会根据手头的情况以多种不同的方式处理这些问题。如果这项工作“在包里”，那么我们将预先“免费”做很多预先计划工作（而不是用户调查），然后将其收回实际工作的成本。在较小的工作中，我什至会做几个线框作为规划和投标过程的一部分。对于一些客户，我被要求提供半工作模型，在这种情况下，将分别收取“规范”和“设计”阶段的费用。我工作的 100 万美元帐户聘请了我的团队来制定开始计划过程的要求，这似乎有点过火了。

我经常被要求设计或建造一些我以前从未做过的事情，所以不要让你在定价方面陷入困境。重要的是最终推出一款您乐于冠名的优质产品。与结果相比，经验算不了什么。

我遵循的一条硬性规定。如果我能看到一个我非常擅长的“具有挑战性的”客户来了，那么费用总是按小时计费，没有例外。如果事情进展顺利，我可以灵活地“给”他们几个额外的时间，但如果客户开始利用这种情况，我最终仍然可以获得报酬。

无论您采用何种流程，此业务成功的关键是文档。写下您的费用、更改管理策略、保修期等。签名！客户试图将我用于一个网站，然后在等式中插入一个低球承包商，所以我被烧毁了，所以不要害怕说明谁会做什么，什么时候会发生，什么时候交付从每个人。

smasmingmagazine.com 上有数百个关于这个主题的资源。这是 UI 人员获取此类信息的首选。

祝你好运！

# python - 如何在 Python 中创建具有不同值的动态数组

> ID：893143
> 
> 赞同：0
> 
> 时间：2009-05-21T14:16:00.240
> 
> 标签：python, sqlite

我在文件中有行，例如：

```
20040701         0  20040701         0      1  52.965366  61.777687  57.540783 
```

如果可能的话，我想把它放在一个动态数组中吗？

就像是

```
try:
    clients = [
        (107, "Ella", "Fitzgerald"),
        (108, "Louis", "Armstrong"),
        (109, "Miles", "Davis")
        ]
    cur.executemany("INSERT INTO clients (id, firstname, lastname) \
        VALUES (?, ?, ?)", clients )
except:
    pass 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:20:25.847

您可以轻松地从字符串中创建一个数字列表，就像您的第一个示例一样，只是`[float(x) for x in thestring.split()]`- 但“Something like”与第一个示例完全不同，并且似乎与问题的主题无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T14:23:55.637

```
In [1]: s = "20040701 0 20040701 0 1 52.965366 61.777687 57.540783"

In [2]: strings = s.split(" ")

In [3]: strings
Out[3]: ['20040701', '0', '20040701', '0', '1', '52.965366', '61.777687', '57.540783']

In [6]: tuple(strings)
Out[6]: ('20040701', '0', '20040701', '0', '1', '52.965366', '61.777687', '57.540783') 
```

这就是你要找的东西吗？我不确定你的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T14:29:26.923

从我阅读你的问题来看，我认为你想要这样的东西：

```
rows=[map(Decimal,x.split(' ')) for x in lines]
```

# javascript - ~/ 等价于 javascript

> ID：893144
> 
> 赞同：43
> 
> 时间：2009-05-21T14:16:09.820
> 
> 标签：javascript, asp.net, web-applications, relative-path

在 JavaScript 中进行基于“根”的路径引用的任何智能方式，就像我们`~/`在 ASP.NET 中的方式一样？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-21T14:18:14.060

让您的页面生成带有以下内容的标签：

```
<link rel="home" id="ApplicationRoot" href="http://www.example.com/appRoot/" /> 
```

然后，在 JavaScript 中有一个函数来提取值，例如：

```
function getHome(){
    return document.getElementById("ApplicationRoot").href;
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-21T14:30:52.410

使用[基本](http://www.w3schools.com/TAGS/tag_base.asp)标签：

```
<head>
   <base href="http://www.example.com/myapp/" />
</head> 
```

...

从现在开始，此页面上使用的任何链接，无论是 javascript 还是 html，都将与基本标记相关，即“ [http://www.example.com/myapp/](http://www.example.com/myapp/) ”。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-21T15:16:24.050

您还可以使用 asp.net 功能`VirtualPathUtility`：

```
<script>
var basePath = '<%=VirtualPathUtility.ToAbsolutePath("~/")%>';
</script> 
```

注意：我没有将路径编码为[JSON](http://www.json.org/)字符串（转义引号、控制字符等）。我认为这没什么大不了的（例如，引号不允许在 URL 中转义），但永远不知道......

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-21T14:19:57.893

我通常在 js 文件的顶部创建一个变量，并为其分配根路径。然后我在引用文件时使用该变量。

```
var rootPath = "/";
image.src = rootPath + "images/something.png"; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-21T14:18:12.157

~/ 是应用程序根而不是字面根，它解释 ~/ 表示`<YourAppVirtualDir>/`

要在 JavaScript 中做一个字面根，它只是 /，即“/root.html”。没有办法在 JavaScript 中获得这样的应用程序级路径。

您可以在 ASPX 文件中破解它并将其输出到标签中，但我会考虑这样做的安全隐患。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-09-26T16:04:45.683

可以改进 Kamarey 的答案以支持动态基本路径：

```
<head>    
      <base href="http://<%= Request.Url.Authority + Request.ApplicationPath%>/" />    
</head> 
```

无论部署配置如何，这都将确保正确的根路径。

公平地说，这并没有回答最初的问题，但它消除了从 javascript 获取根路径的大多数需求。只需在任何地方使用相对 URL，而不用斜杠作为前缀。

如果您仍需要从 javascript 访问它，请添加一个 id 属性并`document.getElementFromId()`按照 MiffTheFox 的建议使用 - 但在基本标签上。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-09-09T17:45:53.283

另一个更简单、更通用的选择是采用以下方法：

```
<script src="/assets/js/bootstrap.min.js"><script> 
```

并像这样使用 Page.ResolveClientUrl：

```
<script src='<%=ResolveClientUrl("~/assets/js/bootstrap.min.js")%>'></script> 
```

那么无论在哪个子目录中，url 都将始终正确呈现。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-11T00:14:31.500

以下函数将计算当前正在运行的应用程序的根。当从应用程序树的某个深处调用时，我使用它来定位资源的绝对位置。

```
 function AppRoot() {
        //
        // Returns the root of the currently running ASP application.
        // in the form: "http://localhost/TRMS40/"
        //
        //   origin: "http://localhost"
        // pathname: "/TRMS40/Test/Test%20EMA.aspx"
        //
        // usage:
        //           window.open( AppRoot() + "CertPlan_Editor.aspx?ID=" + ID);
        //

        var z = window.location.pathname.split('/');

        return window.location.origin + "/" + z[1] + "/";
    } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-03-17T02:33:34.730

在 .NET 基本页面的 PreRender 中，添加以下内容：

```
 protected override void
 OnPreRender(EventArgs e) {
     base.OnPreRender(e);

     if (Page.Header != null)
     {
         //USED TO RESOLVE URL IN JAVASCRIPT
         string baseUrl = String.Format("var baseUrl='{0}';\n", 
           HttpContext.Current.Request.ApplicationPath);
         Page.Header.Controls.Add(new LiteralControl(String.Format(Consts.JS_TAG,
           baseUrl)));
     }
} 
```

然后在您的全局 JavaScript 函数中，添加以下内容：

```
 function resolveUrl(url) {
   if (url.indexOf("~/") == 0) {
     url = baseUrl + url.substring(2);
   }
 return url; } 
```

现在你可以像这样使用它：

```
 document.getElementById('someimage').src = resolveUrl('~/images/protest.jpg'); 
```

对于某些项目来说可能有点多，但对于成熟的应用程序来说非常有用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-23T17:51:57.650

**ASP.NET MVC 应用解决方案**

这在 VS 中使用 IIS 和 IIS Express 时有效。

将此代码段放在所有脚本加载之前，以便让根 url 变量“approot”。

在脚本中为您服务：

```
<script>
        var approot = "@Url.Content("~")";
</script>

 --> other scripts go here or somewhere later in the page. 
```

然后在您的脚本或页面脚本中使用它。例子：

```
var sound_root_path = approot + "sound/";
var img_root_path = approot + "img/"; 
```

approot 变量将是：

> "/YourWebsiteName/" <-- IIS

要不就：

> "/" <-- IIS Express

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-13T20:27:35.927

对于 ASP.net MVC Razor 页面，在标签中创建如下所示的基本`<Head>`标签

```
<base href="http://@Request.Url.Authority@Request.ApplicationPath" /> 
```

并且在您所有的相关 javascript URL 中，确保以不带斜杠 (/) 的方式开始，否则它将从根目录引用。

例如。创建您所有的网址，例如

```
"riskInfo": { url: "Content/images/RiskInfo.png", id: "RI" }, 
```

或者

```
$http.POST("Account/GetModelList", this, request, this.bindModelList); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-31T16:05:47.047

如果你想在 HTML 中使用它仍然可以使用~，看这个

```
 href = @Url.Content("~/controllername/actionName") 
```

查看我的 MVC 应用程序中的复选框单击事件

```
@Html.CheckBoxFor(m=>Model.IsChecked,  
   new {@onclick=@Url.Content("~/controller/action("+ @Model.Id + ", 1)"), 
   @title="Select To Renew" }) 
```

# python - 什么是 Mac OS X 上 Python 的好 IDE？

> ID：893162
> 
> 赞同：134
> 
> 时间：2009-05-21T14:20:01.043
> 
> 标签：python, macos, ide

我即将开始一份新工作，其编码实践主要围绕 TDD 和重构，其主要开发语言是 Python。我来自 Java 世界，并且长期以来一直是 Eclipse 的自信用户。不使用 Java 时，我使用 emacs。

我正在寻找一个适用于 Python 的 IDE，它将为我提供很多我已经习惯使用 Eclipse 的功能，不仅用于重构，而且在代码完成、项目管理、SCM 集成方面（目前是 CVS，但可能这些天切换到git）等。

我应该使用什么 IDE？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2011-04-21T17:22:58.357

我的 2 便士，请查看 PyCharm [http://www.jetbrains.com/pycharm/](http://www.jetbrains.com/pycharm/)

（也是多平台）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-23T07:52:39.550

尝试了许多不同的（Kate、Eclipse、Scite、Vim、Komodo）：每个都有一些故障，要么功能有限，要么速度慢且无响应。多年后的最终选择：Emacs +ropemacs + flymake。绳索项目文件打开对话框非常快。绳索重构和代码辅助功能非常有用。Flymake 显示语法错误。Emacs 是最可配置的编辑器。我对这个配置非常满意。配置的 Python 相关部分在这里：public.halogen-dg.com browser/alex-emacs-settings/configs/cfg_python.el

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-21T14:23:03.410

我使用[TextMate](http://macromates.com/)来满足我所有的 Python 编程需求。它本身不是 IDE，但它做了很多 IDE 所做的事情（没有 IDE 的所有繁琐）。它具有语法高亮、代码折叠、通过使用附加包与各种 SCM 集成（我知道它支持 SVN、Git、Mercurial、Darcs，可能还有其他一些）。它还具有很强的可扩展性和可定制性（同样，通过使用捆绑包）。它还具有项目的基本概念。但是，它不发光的一个地方是代码完成。一些包对代码完成的支持有限，但它通常不如大多数特定于语言的 IDE 那样令人惊奇。不过，鉴于 TextMate 有多棒，我不知道要牺牲它。TextMate 绝对让我更有效率。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-05-21T14:39:20.723

正如其他人所提到的，用于[Eclipse的](http://www.eclipse.org/)[Pydev](http://pydev.sourceforge.net/)很好。

[Netbeans](http://www.netbeans.org/)有一个测试版 Python 插件，它的边缘有点粗糙，但可以变成非常酷的东西。

此外，还有一长串以编程为中心的 mac 文本编辑器，它们可能符合您的需求，也可能不符合您的需求。

*   [Textmate](http://macromates.com/) - 花钱，人们喜欢这个程序，但我还没有充分使用它来了解所有的大惊小怪。
*   [Jedit](http://www.jedit.org/) - 基于 Java 的文本编辑器，有一些不错的功能，但启动时间不是很好（由于 Java）。
*   [CarbonEmacs](http://homepage.mac.com/zenitani/emacs-e.html) - 体面的 Emacs 端口。
*   [AquaEmacs](http://aquamacs.org/) - 更好的 Emacs 端口。
*   [TextWrangler](http://www.barebones.com/products/TextWrangler/) - BBEdit 的 Lite、免费（如啤酒）版本。
*   [BBEdit](http://www.barebones.com/products/bbedit/) - 老守卫。Textmate 之前的事实编辑器抢尽风头。昂贵的。
*   [Smultron](https://www.peterborgapps.com/smultron/) - 非常好的编辑器，用户界面类似于 Textmate。
*   [Idle](http://docs.python.org/library/idle.html) - Python 自己的小编辑器，有一些不错的功能，但也有一些主要问题。我个人发现它对我的使用来说太不稳定了。
*   [Sublime Text](http://www.sublimetext.com/) - 这是一个非常棒的文本编辑器，它有一些非常好的 Python 支持。
*   [Pycharm](http://www.jetbrains.com/pycharm/) - 另一个完整的 Python IDE。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-21T14:22:22.413

[带有Pydev](http://pydev.org/)的Eclipse在任何平台上都最适合我。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-03-29T02:41:44.333

我真的很喜欢使用 PyCharm。[http://www.jetbrains.com/pycharm/](http://www.jetbrains.com/pycharm/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-21T14:25:38.163

我通常将[komodo edit](http://www.activestate.com/komodo_edit/)或[aquamacs](http://aquamacs.org/)与[ropemacs](http://rope.sourceforge.net/ropemacs.html)一起使用。尽管我应该警告您，但如果您来自 Java 或 C# 背景，IDE 功能将不会是您所习惯的。我个人发现功能强大的 IDE 对我的阻碍大于帮助。

**更新**：我还应该指出，如果你有钱[Komodo IDE](http://www.activestate.com/komodo/)是值得的。这是 Komodo Edit 的付费版本。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-05-21T14:33:38.363

macvim + pyflakes.vim

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-03-15T20:01:35.430

我喜欢 Spyder，它有很多工具，例如 profiling、智能缩进助手和良好的自动补全支持

[https://code.google.com/p/spyderlib/](https://code.google.com/p/spyderlib/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-21T14:29:48.607

如果您对 IDE 有预算，您应该尝试一下 Wingware Professional，请参阅wingware.com。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-21T14:28:11.370

我用过[WingIDE](http://www.wingware.com/)，很开心。Intellisense 非常好，其他一些东西有点古怪，但总的来说它是一个非常高效的工具

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-11-08T07:11:08.300

如果您正在寻找交互式环境并且不需要编写模块代码，我建议您使用[IPython](http://ipython.org/)。尽管这是在考虑科学家/统计学家的情况下开发的，但它在没有安装任何科学软件包的情况下也能正常运行。功能强大，具有代码补全、集成帮助、集成调试等功能，兼具Markdown和MathJax集成的笔记本功能。到目前为止，对于那些需要强大功能而不希望将兆字节的 GUI 加载到 RAM 中的人来说，这是最好的选择——因为它是基于浏览器的，所以它用于*始终加载*的chrome/safari 实例。;-)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-21T14:21:46.047

Eclipse PyDev 插件。

[http://pydev.sourceforge.net/](http://pydev.sourceforge.net/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-21T14:23:16.123

既然你熟悉 Eclipse，也许你对[Pydev感兴趣](http://pydev.sourceforge.net/)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-21T14:32:53.593

netbeans 上的 Python 支持出奇的好，并且带有您正在寻找的大部分功能。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-21T15:03:42.843

TextMate 或 Panic 的尾声。如果您想要一个成熟的厨房水槽 IDE，NetBeans 工作得非常好。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-01-11T14:52:56.277

“哪个编辑器/IDE用于...？” 是一种长期的方式来开始“我的狗比你的更漂亮！” 啪啪啪。现在大多数`vim`以上的编辑器都可以使用，有多种不错的选择，甚至以 C 或 Java 工具开始的 IDE 也可以很好地与 Python 和其他动态语言一起使用。

也就是说，在尝试了一堆 IDE（Eclipse、NetBeans、XCode、Komodo、PyCharm，...）之后，我是 ActiveState 的 Komodo IDE 的粉丝。我主要在 Mac OS X 上使用它，尽管我在 Windows 上也使用了多年。一个许可证可以跟随您到任何平台。

Komodo 与语言本身的流行 ActiveState 构建（尤其是 Windows）很好地集成，与神话般的（和 Pythonic）Mercurial 变更管理系统（以及其他）配合良好，并且在核心任务方面具有从优秀到优秀的能力，例如代码编辑、语法着色、代码完成、实时语法检查和可视化调试。当涉及到预集成的重构和代码检查工具（例如rope、pylint）时，它有点弱，但它是可扩展的，并且具有集成外部和自定义工具的良好设施。

我喜欢 Komodo 的一些东西超出了 write-run-debug 循环。ActiveState 长期以来一直支持开发社区（例如，使用免费语言构建、包存储库、食谱站点……），因为在动态语言成为趋势之前。基本的 Komodo Edit 编辑器是免费和开源的，是 Mozilla Firefox 技术的扩展。Komodo 是多语言的。我永远不会只做 Python、Perl 或其他任何东西。Komodo 使用核心语言（Python、Perl、Ruby、PHP、JavaScript）以及支持语言（XML、XSLT、SQL、X/HTML、CSS）、非动态语言（Java、C 等）和助手（ Makefiles、INI 和配置文件、shell 脚本、自定义小语言等）其他人也可以这样做，但 Komodo 将它们全部放在一个地方，准备就绪。它是动态语言的瑞士军刀。

Komodo IDE 绝不是完美的，编辑器/IDE 是 YMMV 的终极选择。但我经常很高兴使用它，而且每年我都会非常高兴地重新订阅我的支持订阅。确实，我才想起来！这个月就要到了。信用卡：出。我与 ActiveState 没有商业联系——只是一个快乐的客户。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-04-21T16:15:01.280

我在 Google 上搜索过这样的应用程序有一段时间了，我发现只有界面笨重且丑陋的选项。

然后我打开 Mac App Store 并找到[CodeRunner](http://krillapps.com/coderunner/)。非常漂亮和干净的界面。支持 Python、Lua、Perl、Ruby、Javascript 等多种语言。价格为 10 美元，但物有所值！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-12-05T21:46:07.630

您可能想研究一下[Eclim](http://eclim.org/)，这是一个 Eclipse 服务器，它允许您在自己喜欢的文本编辑器中使用 Eclipse 功能。对于与 python 相关的功能，它在底层使用[Rope](http://rope.sourceforge.net/)、[PyFlakes](http://pypi.python.org/pypi/pyflakes)和[PyLint](http://www.logilab.org/857)。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-02-06T19:48:55.053

我一直在使用[`Sublime Text`](http://www.sublimetext.com/). 好的是它并没有真正过期。

到目前为止一切都很好，而且很容易上手。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-03-09T15:47:44.307

我可能有点晚了，但我会推荐**Aptana Studio 3.x**。它基于 Eclipse，并且为`python`. 它对`DJango, HTML5 and JQuery`. 对我来说，它是一个完美的网络开发工具。我也做`HTML5 and Android`开发，这样我就不需要不断切换不同的IDE。这是我的多合一解决方案。

注意：你需要大量的内存才能让它变得时髦！4+ GB 太棒了！！

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-07-24T10:48:40.000

## [Visual Studio Code](https://code.visualstudio.com) +[官方 Python 插件](https://marketplace.visualstudio.com/items?itemName=ms-python.python)

在这里，您可以看到其当前 Python 功能的概述：

[https://code.visualstudio.com/docs/languages/python](https://code.visualstudio.com/docs/languages/python)

## ~~巧克力~~

[http://chocolatapp.com](http://chocolatapp.com)

~~它是轻量级的，并提供代码完成。花钱。~~

编辑：显然，巧克力在 2013 年是一个有趣的选择，但从那时起，许多其他人出现并且发展停滞不前。现在我推荐 Visual Studio Code + Python Plugin。

# powershell - 如何使用 PowerShell 删除文件上的只读属性？

> ID：893167
> 
> 赞同：101
> 
> 时间：2009-05-21T14:20:31.590
> 
> 标签：powershell, powershell-1.0, scripting

如何使用 PowerShell（1.0 版）脚本删除文件的 ReadOnly 属性？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2009-05-21T23:57:08.383

您可以使用`Set-ItemProperty`：

```
Set-ItemProperty file.txt -name IsReadOnly -value $false 
```

或更短：

```
sp file.txt IsReadOnly $false 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-21T14:22:52.597

```
$file = Get-Item "C:\Temp\Test.txt"

if ($file.attributes -band [system.IO.FileAttributes]::ReadOnly)  
{  
  $file.attributes = $file.attributes -bxor [system.IO.FileAttributes]::ReadOnly    
} 
```

上面的代码片段摘自这篇[文章](http://www.skyeagle.net/blog/post/Managing-Podcasts-with-Powershell-(Part-2).aspx)

**更新** 使用评论中[的 Keith Hill 的](https://stackoverflow.com/users/99491/keith-hill)实现（我已经测试过了，它确实有效），这变成了：

```
$file = Get-Item "C:\Temp\Test.txt"

if ($file.IsReadOnly -eq $true)  
{  
  $file.IsReadOnly = $false   
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-22T15:49:21.303

即使它不是本*机*PowerShell，仍然可以为此使用简单的[Attrib](http://technet.microsoft.com/en-us/library/bb490868.aspx)命令：

```
attrib -R file.txt 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-09-24T07:09:26.663

或者您可以简单地使用：

```
get-childitem *.cs -Recurse -File | % { $_.IsReadOnly=$false } 
```

以上将适用于当前文件夹子树中的所有 .cs 文件。如果您需要包含其他类型，则只需根据您的需要调整“*.cs”。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-21T15:01:03.723

如果您碰巧使用[PowerShell 社区扩展](http://pscx.codeplex.com)：

```
PS> Set-Writable test.txt
PS> dir . -r *.cs | Set-Writable
# Using alias swr
PS> dir . -r *.cs | swr 
```

你可以像这样做相反的事情：

```
PS> dir . -r *.cs | Set-ReadOnly
# Using alias sro
PS> dir . -r *.cs | sro 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-08-13T02:56:52.150

```
Shell("net share sharefolder=c:\sharefolder/GRANT:Everyone,FULL")
Shell("net share sharefolder= c:\sharefolder/G:Everyone:F /SPEC B")
Shell("Icacls C:\sharefolder/grant Everyone:F /inheritance:e /T")
Shell("attrib -r +s C:\\sharefolder\*.* /s /d", AppWinStyle.Hide) 
```

感谢任何帮助解决某些问题的人......并帮助此代码

此代码对我有用.. 与具有读写权限的每个人共享一个文件夹，您可以在.net 中使用它

# tsql - 跨表中多个日期的 tsql 数学运算

> ID：893169
> 
> 赞同：1
> 
> 时间：2009-05-21T14:20:56.267
> 
> 标签：tsql

我有一个简单定义为 EOMDate(datetime)、DandA(float)、Coupon(float)、EarnedIncome(float) 的 @variabletable

```
04/30/2008, 20187.5,17812.5,NULL
05/31/2008, 24640.63, 22265.63, NULL
06/30/2008, 2375, 26718.75,NULL 
```

我要做的是在填充表格后，我需要返回并计算 EarnedIncome 字段来填充它。公式是当月的 DandA 减去上个月的 DandA 加上息票。我遇到问题的地方是如何进行更新？所以对于 6/30，值应该是 4453.12 (2375-24640.63)+26718.75

我很乐意在头顶上杵一下来解决这个问题。谢谢。此外，在 MS SQL2005 下运行，因此如果可能，可以使用任何 CTE ROW_OVER 类型的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:31:32.253

您需要使用这样的子查询：

```
UPDATE @variabletable v1
SET EarnedIncome = DandA 
- (SELECT DandA FROM @variabletable v2 WHERE GetMonthOnly(DATEADD(mm, -1, v2.EOMDate)=GetMonthOnly(v1.EOMDate))
+ Coupon 
```

我正在使用这个辅助函数

```
DROP FUNCTION GetMonthOnly
GO
CREATE FUNCTION GetMonthOnly
(
    @InputDate DATETIME 
)
RETURNS DATETIME
BEGIN
    RETURN CAST(CAST(YEAR(@InputDate) AS VARCHAR(4)) + '/' +
                CAST(MONTH(@InputDate) AS VARCHAR(2)) + '/01' AS DATETIME)
END
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:01:56.533

肯定有很多方法可以做到这一点。根据数据集的大小和其他因素，您会发现优缺点。

这是我的建议...

```
Declare @table as table 
(
    EOMDate DateTime, 
    DandA float,
    Coupon Float,
    EarnedIncome Float
)

Insert into @table Values('04/30/2008', 20187.5,17812.5,NULL)
Insert into @table Values('05/31/2008', 24640.63, 22265.63, NULL)
Insert into @table Values('06/30/2008', 2375, 26718.75,NULL)

--If we know that EOMDate will only contain one entry per month, and there's *always* one entry a month...
Update @Table Set
EarnedIncome=DandA-
(Select top 1 DandA 
from @table t2 
where t2.EOMDate<T1.EOMDate 
order by EOMDate Desc)+Coupon
From @table T1
Select * from @table

--If there's a chance that there could be more per month, or we only want the values from the previous month (do nothing if it doesn't exist)

Update @Table Set
EarnedIncome=DAndA-(
Select top 1 DandA
From @table T2
Where DateDiff(month, T1.EOMDate, T2.EOMDate)=-1
Order by EOMDate Desc)+Coupon
From @Table T1

Select * from @table
--Leave the null, it's good for the data (since technically you cannot calculate it without a prior month). 
```

我最喜欢第二种方法，因为它只会计算上个月是否存在记录。

（将以下内容添加到上述脚本中以查看差异）

```
--Add one for August
Insert into @table Values('08/30/2008', 2242, 22138.62,NULL)

Update @Table Set
EarnedIncome=DAndA-(
        Select top 1 DandA
        From @table T2
        Where DateDiff(month, T1.EOMDate, T2.EOMDate)=-1
        Order by EOMDate Desc
)+Coupon
From @Table T1

--August is Null because there's no july
Select * from @table 
```

这完全取决于您想要什么。使用直接处理当前记录的记录（无论日期如何），或仅使用当前记录前一个月的记录。

对格式感到抱歉... Stackoverflow.com 的答案编辑器和我一起玩得不好。

:D

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T14:40:01.567

您可以使用子查询来执行计算，唯一的问题是您如何处理第一个月，因为没有以前的 DandA 值。在这里，我使用 isnull 将其设置为 0。查询看起来像

```
Update MyTable
Set EarnedIncome = DandA + Coupon - IsNull(  Select Top 1 DandA 
                                             From MyTable2 
                                             Where MyTable.EOMDate > MyTable2.EOMDate 
                                             Order by MyTable2.EOMDate desc), 0) 
```

这还假设每个表中每个月只有一条记录，并且月份之间没有任何间隔。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:01:57.513

另一种选择是在插入数据时计算运行总计，并有一个约束保证您的运行总计是正确的：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/23/denormalizing-to-enforce-business-rules-running-totals.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/23/denormalizing-to-enforce-business-rules-running-totals.aspx)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-21T14:32:55.450

可能有一种方法可以在单个语句中执行此操作，但在这种情况下，我倾向于设置一个游标来遍历每一行，计算该行的新 EarnedIncome 字段，更新该行，然后移动到下一行。

前任：

```
DECLARE @EOMDateVal DATETIME
DECLARE @EarnedIncomeVal FLOAT

DECLARE updCursor CURSOR FOR
    SELECT EOMDate FROM @variabletable

OPEN updCursor

FETCH NEXT FROM updCursor INTO @EOMDateVal 

WHILE @@FETCH_STATUS = 0
BEGIN
    // Compute @EarnedIncomeVal for this row here.
    // This also gives you a chance to catch data integrity problems
    // that would cause you to fail the whole batch if you compute
    // everything in a subquery.

    UPDATE @variabletable SET EarnedIncome = @EarnedIncomeVal
        WHERE EOMDate = @EOMDateVal  

    FETCH NEXT FROM updCursor INTO @EOMDateVal 
END
CLOSE updCursor 
DEALLOCATE updCursor 
```

# perl - Perl：使用基于索引的方法循环输入行

> ID：893173
> 
> 赞同：3
> 
> 时间：2009-05-21T14:22:11.820
> 
> 标签：perl, text-processing

这是 perl 中的初学者最佳实践问题。我是这种语言的新手。问题是：

如果我想处理程序的输出行，如何以特殊方式格式化 THE FIRST LINE？

我想到了两种可能：

1) 一个标志变量，一旦第一次执行循环就被设置。但它将针对每个周期进行评估。不好的解决方案

2) 基于索引的循环（如“for”）。然后我会在 i=1 中开始循环。这个解决方案要好得多。问题是我该怎么做？

我刚刚找到了使用 while ( <> ) 结构进行循环的代码。

在这里你可以看得更清楚：

```
$command_string = "par-format 70j p0 s0 < " . $ARGV[0] . "|\n";                                                                                

open DATA, $command_string  or die "Couldn't execute program: $!";

print "\t    <div>&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;|-- <strong>Description</strong></div>\n";
while ( defined( my $line = <DATA> )  ) {
   chomp($line);
   # print "$line\n";
   print "\t    <div>&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;&‎nbsp;|&‎nbsp;&‎nbsp;&‎nbsp;-- " . $line  . "</div>\n";
}

close DATA; 
```

请不要犹豫在这里更正任何代码，这是我的第一首 perl 诗。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T14:39:00.350

您始终可以使用`$.`或英文名称`$INPUT_LINE_NUMBER`来控制循环中的逻辑：

```
while (my $line = <>) {
    if ($. == 1) {
        # do cool stuff here
    }
    # do normal stuff here
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T14:30:56.310

要以不同的方式处理第一行，您可以将

```
$line = <DATA>; 
```

在你的循环上方。

通过正确检查读取问题（空文件等），这应该是

```
if ($line = <DATA>) {
    ...do special things...
}

while (my $line = <DATA>) {
    ...do regular things...
} 
```

我不确定`defined()`电话的情况。您可能不需要它，因为空字符串具有错误的真值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T19:49:44.327

从“最佳实践”的角度来看，该代码示例有很多错误：

```
open DATA, $command_string  or die "Couldn't execute program: $!"; 
```

*   安全漏洞，请利用我。
*   DATA 是一个神奇的值，它指向`__DATA__`当前文件末尾的一个节。
*   你应该使用

    ```
    open my $fh 
    ```

    它使用词法变量作为文件句柄而不是全局变量。

*   您应该使用 3 arg open，即：

    ```
    open my $fh, '<'  , $filename
    open my $fh, '-|' , $command
    open my $fh, '-|' , $command, @args 
    ```

    遗憾的是，我还没有弄清楚 3-arg 如何与双管道一起工作。有这个 IPC::Open2 的东西，但我还没有弄清楚如何有效地使用它。欢迎提出建议。

# php - 激烈辩论 Javascript Chops URL

> ID：893186
> 
> 赞同：0
> 
> 时间：2009-05-21T14:24:27.087
> 
> 标签：php, javascript

Intense Debate 使用以下 javascript 代码在我的博客上显示评论编号，我已将其包含在一个方便的小 php 函数中。通过将此 php 函数传递给博客文章的 ID，它会创建指向该特定文章的评论部分的链接。

```
function show_comments_number($id) {
$url="index.php?p=post&id=$id";
?>
<script>
var idcomments_acct = 'xxx';
var idcomments_post_id = '<? echo $id;?>';
var idcomments_post_url = '<? echo $url;?>';
</script>
<script type="text/javascript" src="http://www.intensedebate.com/js/genericLinkWrapperV2.js"></script>
<?} 
```

问题是 Intense Debate 解析了我试图传递它的 URL，省略了 & 和它之后的所有内容。所以 Intense Debate 产生的链接只是“index.php?p=post”——显然这是一个问题。

关于为什么以这种方式切割 URL 的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T17:16:50.267

很可能，您的 URL 中的 &id 被解释为无效的 HTML 实体。将您的`<script>`标签包含在注释 ( `<!--<script></script>//-->`) 中应该会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:10:15.760

将 更改`&id`为`&amp;id`，您应该解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T00:50:52.580

或者按照[W3C 的建议](http://www.w3.org/QA/2005/04/php-session#separator)将 & 更改为 ; （确保相应地修改你的 argument_separator.input 和 argument_separator.output）。

# version-control - TeamCity 项目和多个 SVN 分支

> ID：893193
> 
> 赞同：7
> 
> 时间：2009-05-21T14:26:06.103
> 
> 标签：version-control, teamcity

本着保持我的 SVN 主干干净并准备好部署的精神，我一直在使用[以下源代码控制模型](http://www.infoq.com/articles/agile-version-control)。对于不耐烦的人，基本概念是您创建开发分支来进行实际开发，并随时保持主干干净并准备好部署（主干中没有垃圾）。

除此之外，我正在配置 TeamCity 以进行持续集成。在 TeamCity 中，我想确保所有开发分支以及部署就绪分支（在我的情况下为主干）正确构建并通过所有单元测试。

这可能是一个愚蠢的问题，但对 TeamCity 不太熟悉，我应该为每个分支创建一个新的 TeamCity 项目吗？特别是，部署就绪分支比开发分支有一些额外的规则。例如，发布应该保存在文件系统上的版本化目录中（例如，C:\Projects\MyProject\1.0.187...、C:\Projects\MyProject\1.0.188...），以便轻松访问二进制文件，在任何时间点。另一方面，在开发分支中保存程序集的版本副本是不必要的，并且会浪费硬盘空间。

在 TeamCity 中，我希望每个软件项目只看到一个项目。换句话说，如果我的公司正在开发 X 个开发项目，我希望该项目只列出一次，而不是 X * 2（假设每个项目只有两个分支）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T14:53:11.227

您只需要创建一个项目，但您将需要多个构建配置 - 每个分支 1 个。据我所知，您无法自定义磁盘上的工件文件夹名称（它是一个自动递增的编号），但是您可以从 UI 下载 TeamCity 4.5 中的所有工件作为 zip 文件。TeamCity 还包含一个调度程序，可让您清理工件，以免占用过多磁盘空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-01-02T10:37:30.183

**TeamCity 2018.1.5**

[![在此处输入图像描述](https://i.stack.imgur.com/o3TXx.png)](https://i.stack.imgur.com/o3TXx.png)

TeamCity 不支持 SVN 和 GIT 的多分支 - 所以我用**配置参数**解决了这个问题- 我设置了我需要构建的活动分支，之后可以通过运行自定义构建或更改配置轻松切换到另一个分支范围。 [![在此处输入图像描述](https://i.stack.imgur.com/kGPbx.jpg)](https://i.stack.imgur.com/kGPbx.jpg)

在需要之后只需配置触发器以从特定分支开始构建：

[![在此处输入图像描述](https://i.stack.imgur.com/GOWVa.jpg)](https://i.stack.imgur.com/GOWVa.jpg)

所以在项目方面你可以看到不同的分支 [![在此处输入图像描述](https://i.stack.imgur.com/TCLej.jpg)](https://i.stack.imgur.com/TCLej.jpg)

并通过运行自定义构建和更改分支轻松地在分支之间切换：

[![在此处输入图像描述](https://i.stack.imgur.com/w7gQ3.jpg)](https://i.stack.imgur.com/w7gQ3.jpg)

# c# - 具有自动命名属性的通用组合框

> ID：893196
> 
> 赞同：0
> 
> 时间：2009-05-21T14:26:41.967
> 
> 标签：c#, generics, .net-3.5, user-controls

我正在为 WinForms ComboBox 控件编写一个包装器，它可以让我使用 List<T> 填充下拉列表，并且有一个 Selected 属性，该属性返回一个 T 类型的项目（如果没有选择，则返回 null）。

我不想拥有 Selected 属性，而是希望它自动基于泛型类型命名。例如：

*   MyDropDownList<User> 将具有 SelectedUser 属性
*   MyDropDownList<Department> 将具有 SelectedDepartment 属性
*   MyDropDownList<State> 将具有 SelectedState 属性

使用 LINQ，我可以在分组期间创建匿名类型，如下所示：

```
var usersByGender = users
    .GroupBy(x => x.Gender)
    .Select(group => new {Gender = group.Key, List = group.ToList()}); 
```

这将导致生成的匿名类型列表包含 IntelliSense 可检测到的 Gender 属性和 List<User>。问题是，我能以某种方式对泛型类中的属性执行此操作吗？

**编辑**：我现在意识到我本质上是在 C# 3.0 中要求“method_missing”，这可能是不可能的。不过，我愿意接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:43:00.170

不，你不能那样做。泛型类型背后的整个想法是它们同样适用于可以在泛型参数中指定的所有类型。如果允许每个专业化声明不同名称的成员，情况就不会如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:49:37.317

我不认为你能做到。唯一有可能工作的方法是创建某种工厂方法来创建类型并返回它。基本上，您的泛型类型成为基类，IL 是动态编写的，创建一个从泛型继承但添加了新属性的具体类。当然，返回的对象将是真正的匿名对象，您只能访问它通过反射，因为你不会有一个类型来实际转换为：

```
public static class CrazyFactory
{
     public static object CreateTypedComboList<T>()
     {
          //magic happens
          return object;
     }
} 
```

然后使用它需要

```
object userCombo = CrazyFactory.CreateTypedComboList<User>();
PropertyInfo selectedUserProperty = userCombo.GetType().GetProperty("SelectedUser");
selectedUserProperty.SetValue(userCombo, user); 
```

这与简单的 T SelectedItem 属性相差无几。

* * *

简单看一下，当 c# 4.0 为我们带来动态类型时，这种类型的事情会变得更容易。通过实现 IDynamicObject 接口，可以捕获对未定义属性的所有调用并处理它们，因此您可以使用如下逻辑：

```
public override MetaObject GetMember(GetMemberAction action, MetaObject[] args)
{
     //not sure on the real property name here...
     string actionName = action.Name;

     if (actionName = "Selected" + typeof(T).Name)
     {
          return SelectedItem; //in some MetaObject wrapper 
     }
} 
```

我一直在关注[这篇文章](http://www.codeproject.com/KB/cs/moemeka.aspx?display=Print)，但我自己还没有接触过动态，但看起来你想要的肯定是可能的。不过我仍然不会这样做——你不会得到 Intellisense，而且它似乎是一种定义功能的脆弱而复杂的方法。

# cmd - .bat 文件，非阻塞运行/启动

> ID：893203
> 
> 赞同：37
> 
> 时间：2009-05-21T14:27:39.687
> 
> 标签：cmd, batch-file

如何在 .bat 文件中一次启动 2 个应用程序？我目前的文字是

```
cd mydir
my.exe
my.exe difParams
//bat is finished. i dont want my.exe to close 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-21T14:30:04.923

```
start "MY EXE" my.exe 
```

这会在后台启动 exe（并避免标题问题，见下文）。

start 命令也提供了一些选项，用于`start /?`列出它们：

```
C:>start /?  
Starts a separate window to run a specified program or command.

START ["title"] [/D path] [/I] [/MIN] [/MAX] [/SEPARATE | /SHARED]
      [/LOW | /NORMAL | /HIGH | /REALTIME | /ABOVENORMAL | /BELOWNORMAL]
      [/NODE <NUMA node>] [/AFFINITY <hex affinity mask>] [/WAIT] [/B]
      [command/program] [parameters]

    "title"     Title to display in window title bar.
    path        Starting directory.
    B           Start application without creating a new window. The
                application has ^C handling ignored. Unless the application
                enables ^C processing, ^Break is the only way to interrupt
                the application.
    I           The new environment will be the original environment passed
                to the cmd.exe and not the current environment.
    MIN         Start window minimized.
    MAX         Start window maximized.
    SEPARATE    Start 16-bit Windows program in separate memory space.
    SHARED      Start 16-bit Windows program in shared memory space.
    LOW         Start application in the IDLE priority class.
    NORMAL      Start application in the NORMAL priority class.
    HIGH        Start application in the HIGH priority class.
    REALTIME    Start application in the REALTIME priority class.
    ABOVENORMAL Start application in the ABOVENORMAL priority class.
    BELOWNORMAL Start application in the BELOWNORMAL priority class.
    NODE        Specifies the preferred Non-Uniform Memory Architecture (NUMA)
                node as a decimal integer.
    AFFINITY    Specifies the processor affinity mask as a hexadecimal number.
                The process is restricted to running on these processors.

                The affinity mask is interpreted differently when /AFFINITY and
                /NODE are combined.  Specify the affinity mask as if the NUMA
                node's processor mask is right shifted to begin at bit zero.
                The process is restricted to running on those processors in
                common between the specified affinity mask and the NUMA node.
                If no processors are in common, the process is restricted to
                running on the specified NUMA node.
    WAIT        Start application and wait for it to terminate.
    command/program
                If it is an internal cmd command or a batch file then
                the command processor is run with the /K switch to cmd.exe.
                This means that the window will remain after the command
                has been run.

                If it is not an internal cmd command or batch file then
                it is a program and will run as either a windowed application
                or a console application.

    parameters  These are the parameters passed to the command/program. 
```

一个棘手的问题可能是“标题”出现在可执行文件及其参数之前，因此有时您需要给应用程序一个标题才能开始正确解析参数。:-|

# sorting - 两遍多路归并排序？

> ID：893205
> 
> 赞同：3
> 
> 时间：2009-05-21T14:28:10.840
> 
> 标签：sorting

如果我有一个不适合内存的关系 (SQL)，并且我想使用 TPMMS（两遍多路合并排序方法）对关系进行排序。我将如何将表划分为可以放入内存的子表（以及多少个）而不是合并它们？假设我正在使用 C#。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T15:59:15.197

我还没有找到两遍多路合并排序的当前定义，但是“外部排序”（数据太大而无法放入内存）的理论几乎是标准的。任何关于算法的好书都会涵盖它；在许多其他人中，您可以查看 Knuth、Sedgewick 或（对于软件考古学家而言）Kernighan & Plauger [Software Tools](https://rads.stackoverflow.com/amzn/click/com/020103669X)。

基本技术很简单：

1.  读取数据直到没有剩余空间。
2.  解决。
3.  写入临时文件。
4.  从 1 开始重复，直到没有数据可供读取。
5.  你知道你有多少临时文件，N。
6.  您需要确定一次可以读取多少个文件，M。
7.  如果 N > M，那么您设计合并阶段，以便最后一个阶段将合并 M 个文件。
8.  您将 M 文件集合并到新的临时文件中，直到最后一次合并。
9.  您合并最后一组 M 个文件（如果 N < M，则为 N 个）写入最终目的地。

所有标准都非常标准 - 但有一些挑剔的细节需要做对。

AT&T 的 Unix System Readings Volume II 中有一篇很好的文章，名为“Theory and Practice in the Construction of a Working Sort Routine”，如果您认真学习如何处理外部排序，您应该找到并阅读该文章。但是，当您阅读它时，请记住，自从它被写入以来，机器已经发生了巨大的变化，拥有千兆字节的主内存（而不是兆字节）和 TB 的磁盘空间（或 SSD — 也不是兆字节）。

# javascript - 更改 HTML 按钮的 onclick 事件委托？

> ID：893208
> 
> 赞同：2
> 
> 时间：2009-05-21T14:28:24.693
> 
> 标签：javascript, prototypejs

如何更改单击表单按钮时将执行的 JavaScript？

我试过改变它的 onClicked 和它的 onclicked 子属性，如下所示：

```
$('mybutton').onClick = 'doSomething'; 
```

和

```
$('mybutton').attributes["onclick"] = 'doSomething()'; 
```

两者似乎都不起作用。我的其他选择是：

1.  有两个按钮并隐藏一个并显示另一个。
2.  将其定向到评估字符串并将字符串更改为我要执行的函数的函数。

两者看起来都不是很优雅。

我使用 Prototype 作为 js 库，所以它有任何有用的工具，我可以使用它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T07:30:08.720

如果原始的 onclick 事件是通过 HTML 属性设置的，则可以使用以下内容覆盖它：

```
$("#myButtonId").setAttribute("onclick", "myFunction();"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T14:37:24.893

使用原型框架，您可以：

```
Event.observe("mybutton", "click", clickHandler); 
```

或者：

```
Event.observe("mybutton", "click", function() {
  alert("Button clicked!");
}); 
```

或者：

```
$("mybutton").observe("click", clickHandler); 
```

或者：

```
$("mybutton").observe("click", function() {
  alert("Button clicked!");
}); 
```

*   请参阅[事件类文档](http://www.prototypejs.org/api/event)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T14:32:17.040

对于原型，我相信它会是这样的：

```
$("mybutton").observe('click', function() {
     // do something here
}); 
```

编辑：或者，正如它在[文档](http://www.prototypejs.org/api/event)中所说，您可以简单地指定要在单击时调用的函数：

```
$('mybutton').observe('click', respondToClick);

function respondToClick(event) {
    // do something here
} 
```

但这又是原型特定的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T14:32:26.433

在 javascript 中设置 onclick 处理程序的一般方法是设置`onclick`一个函数，方法是直接将函数的名称传递给它，而不是在字符串中。因此，如果`myButton`设置为 DOM 元素，您将编写：

```
myButton.onclick = doSomething; 
```

因此，当您单击“mybutton”按钮时，该`doSomething`函数将被称为`doSomething()`. 对于匿名函数，您可以编写：

```
myButton.onclick = function() {
    alert("myButton was clicked!");
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T14:36:10.060

在 JQuery 中是

```
$("#myButtonId").click(myFunction);

function myFunction(){
 alert("Clicked");
} 
```

或者，如果您想将函数内联：

```
$("#myButtonId").click(function(){
     alert("Clicked");
}); 
```

如果您首先使用 JQuery，请确保使用相关的选择器前缀（IE：如果您使用元素的 Id，请在其前面放置一个 #）。其次，它是为点击事件分配回调的点击方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T14:37:10.167

上次我使用 Prototype，它是这样的：

```
Event.observe('mybutton', 'click', doSomething); 
```

顺便说一句，如果您不引用函数名称，您的示例甚至可能会起作用。

编辑：是的， Element.observe(element, eventName, handler) 和 someElement.observe(eventName, handler) 也可以。并且不要引用处理程序名称 - 您要传递函数而不是字符串！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-24T09:38:59.317

我为您在 Firefox 下的原型问题找到了解决方案：

```
$("#myButtonId").writeAttribute('onclick', ''); // first remove the attribute
$("#myButtonId").observe('click', function () { ... }); // then add the event 
```

# sql - 从 SQL 表中获取城市和国家的列表

> ID：893209
> 
> 赞同：1
> 
> 时间：2009-05-21T14:28:31.980
> 
> 标签：sql, linq, linq-to-sql

我有一个 SQL 表，在每行中我存储了一个事物位置的国家和城市。例如：

```
记录 1，美国纽约
记录2，罗马，意大利
record3，意大利米兰
record3, Birghiman, 英国
record4，伦敦，英国
record5，伦敦，英国
record6，英国伦敦
record7，英国伯明翰

```

我想生成一个按国家和城市排序的列表，每个城市在结果中只出现一次。

我想知道如何以优雅的方式在 SQL 和 Linq To SQL 中解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T14:39:45.387

```
select distinct country, city
from <Table>
order by country, city; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:31:33.360

```
SELECT MIN(record) AS record, City, Country
FROM [MyTable]
GROUP BY City, Country
ORDER BY Country, City 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T15:07:15.410

我也想出了如何用 Linq 做到这一点。它似乎工作正常。虽然不确定性能

```
 var result = from p in table
                     group p by p.country into country_group
                     select new
                     {
                         country = country_group.Key,
                         cities = from ci in country_group
                                  group ci by ci.city into city_group
                                  select new { city = city_group.Key, cig = city_group }
                     };                          

        foreach(var co in result)
        {
            string country = co.country; 

            foreach(var ci in co.cities)
            {
                string city = ci.city;
            }
        } 
```

# hudson - Hudson 构建在浏览器中运行时失败，但可以从命令行运行

> ID：893210
> 
> 赞同：1
> 
> 时间：2009-05-21T14:28:40.653
> 
> 标签：hudson

我正在为一个生成 javascript 文件的项目设置一个新的 Hudson 任务（在 WinXP 上），并在构建过程中执行 xslt 转换。

当从 Hudson 运行时，ant 构建在 XSL 转换上失败，但是当从命令行运行相同代码库（即在 Hudson 的工作区）上的相同构建时，它工作正常。

失败消息是：

*第 208 行：变量“screen”在同一范围内多次定义。*

我尝试将 Hudson 配置为直接使用 ant 和使用批处理脚本 - 在 Hudson 中都失败了。

我已经在 Firefox、IE6 和 Chrome 中尝试过，并且看到了同样的问题。

谁能建议我们如何解决哈德逊的这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:01:44.507

问题解决了。

我们的构建实际上依赖于 jdk 1.4.2，而 Hudson 似乎使用 1.6 运行。当我将 Hudson 设置为作为服务运行时，它以我的本地用户身份运行，这意味着它选择了 1.4.2 JAVA_HOME 环境变量 - 因此可以工作。

我想另一种可能的解决方案是将 Hudson 配置为默认使用 1.4.2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:37:31.180

我认为这不是 Hudson 的直接问题，因为它与构建脚本和/或环境本身有关。

您的构建脚本是否依赖于定义的某些环境变量，或者更糟糕的是，从某个目录结构中运行的作业（即，如果它从 /home/mash/blah 下运行，但不能从 /tmp 等另一个目录下运行，它可以工作）？构建脚本是否通过相对路径引用外部文件？

这些是我要研究的事情。对于环境变量，您可以告诉 Hudson 将它们传递给 Ant。对于其他问题，您可能想要更改构建脚本。检查 Hudson 提供的控制台输出，并可能将 Ant 设置为打印详细/调试消息以更好地了解环境/文件路径。

# regex - 重写所有 URL

> ID：893218
> 
> 赞同：3
> 
> 时间：2009-05-21T14:30:18.463
> 
> 标签：regex, apache, mod-rewrite

我想重写类似的东西：

`http//www.example.com/index.php?var1=val1&var2=val2&var3=val3`

进入

`http://www.example.com/var1/val1/var2/val2/var3/val3/`

我正在寻找一种解决任意数量变量的解决方案。可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T14:33:16.260

看看这个问题：[mod_rewrite 可以转换任意数量的任意名称的参数吗？](https://stackoverflow.com/questions/884377/can-modrewrite-convert-any-number-of-parameters-with-any-names)

[我的答案](https://stackoverflow.com/questions/884377/can-modrewrite-convert-any-number-of-parameters-with-any-names)也可以用于您的情况：

```
$_SERVER['REQUEST_URI_PATH'] = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
$segments = explode('/', trim($_SERVER['REQUEST_URI_PATH'], '/'));
for ($i=0, $n=count($segments); $i<$n; $i+=2) {
    $_GET[rawurldecode($segments[$i])] = ($i+1 < $length) ? rawurldecode($segments[$i+1]) : null;
} 
```

以及相应的规则：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [L] 
```

此规则将无法映射到现有文件或目录的任何请求重写为`index.php`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:35:04.353

是的。诀窍是编写一个[RewriteRule](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)，用斜杠替换一个字符（等号或 & 号），然后使用“next”标志重新启动重写过程。

以下可能是一个不错的起点：

```
RewriteRule ^/index.php - [chain]
RewriteRule ^(.*)[=&](.*)$ $1/$2 [next]
RewriteRule ^/index.php\? "/" 
```

如果我做对了，第一条规则什么都不做，但只有当路径以“/index.php”开头时才匹配。“chain”选项意味着除非第一条规则匹配，否则第二条规则不会运行。第二条规则将尝试用 / 替换 = 或 &，如果成功，它将重新启动整个重写过程。第三条规则，只有在所有 = 和 & 都被替换后才能达到，它将删除“/index.php?”。一开始。

# visual-studio-2008 - Visual Studio 2008 SP1 不允许添加网站数据源

> ID：893219
> 
> 赞同：0
> 
> 时间：2009-05-21T14:30:26.653
> 
> 标签：visual-studio-2008, dataset, reporting, datasource

我有一个包含两个报告（master.rdlc 和 detail.rdlc）的项目，它们都使用数据集来填充数据。到现在为止还挺好。他们工作正常，或者过去工作正常。出于某种原因，他们丢失了对数据集的引用，并且数据集未显示在网站数据源窗口中，因此我无法使用它们。

此外，在“网站数据源”窗口中，除“刷新”之外的所有按钮都被禁用。

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-26T10:33:55.340

尝试

[https://msdn.microsoft.com/en-us/library/yft2c9ad.aspx](https://msdn.microsoft.com/en-us/library/yft2c9ad.aspx)

在菜单栏上，选择查看、其他窗口、数据源（或选择 Shift+Alt+D 键）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-09T16:01:23.350

同样的问题 - 除了我什至还没有运行报告，卡在一个空文档中并且无法添加数据源。

当我转到 Report>Datasources 菜单项时收到一条非常奇怪的消息，它无法加载 ajaxtoolkit 程序集...？！

*** 更新 ***** 将我的目标框架从 3.5 设置为 3.0 - 似乎现在可以工作了

# fluent-nhibernate - 如何在nhibernate中映射外键列？

> ID：893231
> 
> 赞同：2
> 
> 时间：2009-05-21T14:32:49.567
> 
> 标签：fluent-nhibernate, nhibernate-mapping

实际上，这个问题比描述的要复杂。我是 nhibernate 的新手，我想用外键列映射一个表。在大多数 nhibernate 示例中，外键列分配通常是通过设置引用实体来实现的。我的意思是，如果我有一个 CategoryId 列，那么我需要一个 Category 属性，并且在我查看的示例中，通常会设置 Category 属性。就我而言，我不想设置实体属性，而是设置外键属性。

```
public class Post
{
    public virtual long Id { get; set; };
    public virtual string Content { get; set; };
    public virtual long CategoryId { get; set; };
    public virtual Category Category { get; set; };
} 
```

当我尝试像下面的示例一样保存 Post 实体时，我不想设置类别属性。

```
Post post = new Post { Content = "content", Category = aCategoryEntity };
session.Save(post); 
```

下面的示例是我想要实现的方式。

```
Post post = new Post { Content = "content", CategoryId = 3 };
session.Save(post); 
```

我怎样才能摆脱它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-30T06:38:54.647

Session.Load 是我在这里使用的解决方案。

```
Post post = new Post 
{ 
   Content = "content", 
   Category = Session.Load<Category>(categoryId)
};

session.Save(post); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:45:09.777

您的实体“发布”不需要 CategoryId 和 Category 属性。

通常，您也会映射 Category，并且您的 Post 映射将使用外键将两者关联起来。

你可以尝试这样的事情

```
session.Save(new Post(){ Category = new Category(){ Id = 3 } }); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T21:51:43.097

我不知道这对于 NHibernate 是否可行。ORM 的全部意义在于处理对象，而不是 RDMS 外键。

# windows - 如何使用 VBScript 终止进程

> ID：893237
> 
> 赞同：16
> 
> 时间：2009-05-21T14:33:06.523
> 
> 标签：windows, vbscript, wmi, kill

我有这个 VBScript 代码来终止一个进程

```
 Const strComputer = "." 
  Dim objWMIService, colProcessList
  Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
  Set colProcessList = objWMIService.ExecQuery("SELECT * FROM Win32_Process WHERE Name = 'Process.exe'")
  For Each objProcess in colProcessList 
    objProcess.Terminate() 
  Next 
```

它适用于某些进程，但是当涉及在 SYSTEM 下运行的任何进程时，它无法停止它。

我需要添加什么来杀死 SYSTEM 下的进程吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-21T15:36:07.723

过去，我使用**[PsKill](http://technet.microsoft.com/en-us/sysinternals/bb896683.aspx)**的方法是使用Microsoft SysInternals 的 PsKill。PsKill 可以终止系统进程和任何被锁定的进程。

您需要下载可执行文件并将其放在与脚本相同的目录中，或者在 WshShell.Exec 调用中添加它的路径。这是您更改为使用 PsKill 的示例代码。

```
Const strComputer = "." 
Set WshShell = CreateObject("WScript.Shell")
Dim objWMIService, colProcessList
Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
Set colProcessList = objWMIService.ExecQuery("SELECT * FROM Win32_Process WHERE Name = 'Process.exe'")
For Each objProcess in colProcessList 
  WshShell.Exec "PSKill " & objProcess.ProcessId 
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-31T22:16:46.047

尝试显式断言调试权限`{impersonationLevel=impersonate,(debug)}`：

```
Set wmi = GetObject("winmgmts:{impersonationLevel=impersonate,(debug)}!\\.\root\CIMV2")
Set procs = wmi.ExecQuery("SELECT * FROM Win32_Process WHERE Name='SearchIndexer.exe'", , 48)
For Each proc In procs
    proc.Terminate
Next 
```

# nhibernate - NHibernate Joins 返回对象数组。为什么？

> ID：893242
> 
> 赞同：2
> 
> 时间：2009-05-21T14:33:53.933
> 
> 标签：nhibernate

我不明白为什么 NHibernate 在执行连接时返回一个 object[] 但 Hibernate 没有。例如。

映射

查询 session.CreateQuery("From CameraMount m left join m.Presets").List();

这将返回一个 object[]，我希望它返回一个已初始化其预设集的 CameraMount。

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:40:37.210

我想这只是由于.NET 中对泛型和非泛型集合的支持而略有不同的实现。如果您想要强类型的 CameraMount 对象，您可以请求：

```
List<CameraMount> cameramounts = 
session.CreateQuery("From CameraMount m left join m.Presets")
.List<CameraMount>(); 
```

反而。希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T08:29:51.380

此外，您可以尝试`Select m from CameraMount m left join m.Presets`这应该会返回 CameraMount 对象。

# newline - Informix - ALLOW_NEWLINE

> ID：893246
> 
> 赞同：1
> 
> 时间：2009-05-21T14:34:39.190
> 
> 标签：newline, informix

我了解 ALLOW_NEWLINE 的工作原理。但是，我不明白为什么首先存在该选项。我原以为永久使用它会更有用，而不是没有。然后，您可以通过在代码中插入“\n”来控制何时出现换行符。

谁能解释为什么有这个选项？开启时计算成本更高吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:54:33.673

有几个原因：

1.  SQL 标准不允许在字符串中间出现换行符——您必须适度地努力才能在 SQL 字符串中插入换行符。

2.  对于大多数人来说，大多数时候，字符串中的换行符表示错误 - 忘记匹配的右引号。

因此，默认值接近标准并防止愚蠢的错别字变得混乱。但是，在没有其他方法将换行符转换为字符串的情况下，该功能是必要的。

# java - 抽象类是否应该有一个 serialVersionUID

> ID：893259
> 
> 赞同：72
> 
> 时间：2009-05-21T14:37:26.780
> 
> 标签：java, serialization, abstract-class, serialversionuid

在java中，如果一个类实现了Serializable但是是抽象的，它应该有一个长声明的serialVersionUID，还是子类只需要这个？

在这种情况下，确实是所有子类都处理序列化，因为类型的目的是在 RMI 调用中使用。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-21T14:50:40.250

提供 serialVersionUID 以确定反序列化对象与类的当前版本之间的兼容性。 ~~因此，在类的第一个版本中，或者在这种情况下，在抽象基类中，它并不是真正需要的。您永远不会有该抽象类的实例来序列化/反序列化，因此它不需要 serialVersionUID。~~

（当然，它确实会生成一个编译器警告，你想摆脱它，对吧？）

事实证明，詹姆斯的评论是正确的。抽象基类的 serialVersionUID*确实*会传播到子类。鉴于此，您的基类中*确实*需要 serialVersionUID。

要测试的代码：

```
import java.io.Serializable;

public abstract class Base implements Serializable {

    private int x = 0;
    private int y = 0;

    private static final long serialVersionUID = 1L;

    public String toString()
    {
        return "Base X: " + x + ", Base Y: " + y;
    }
}

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;

public class Sub extends Base {

    private int z = 0;

    private static final long serialVersionUID = 1000L;

    public String toString()
    {
        return super.toString() + ", Sub Z: " + z;
    }

    public static void main(String[] args)
    {
        Sub s1 = new Sub();
        System.out.println( s1.toString() );

        // Serialize the object and save it to a file
        try {
            FileOutputStream fout = new FileOutputStream("object.dat");
            ObjectOutputStream oos = new ObjectOutputStream(fout);
            oos.writeObject( s1 );
            oos.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

        Sub s2 = null;
        // Load the file and deserialize the object
        try {
            FileInputStream fin = new FileInputStream("object.dat");
            ObjectInputStream ois = new ObjectInputStream(fin);
            s2 = (Sub) ois.readObject();
            ois.close();
        } catch (Exception e) {
            e.printStackTrace();
        }

        System.out.println( s2.toString() );
    }
} 
```

在 Sub 中运行一次 main 以使其创建和保存对象。然后更改 Base 类中的 serialVersionUID，注释掉 main 中保存对象的行（因此它不会再次保存它，您只想加载旧的），然后再次运行它。这将导致异常

```
java.io.InvalidClassException: Base; local class incompatible: stream classdesc serialVersionUID = 1, local class serialVersionUID = 2 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-21T14:53:42.567

是的，一般来说，出于同样的原因，任何其他类都需要一个序列号——以避免为它生成一个序列号。基本上，任何实现可序列化的类（不是接口）都应该定义序列版本 ID，否则当相同的 .class 编译不在服务器和客户端 JVM 中时，您将面临反序列化错误的风险。

如果您想做一些花哨的事情，还有其他选择。我不确定“这是子类的意图……”是什么意思。你打算编写自定义序列化方法（例如 writeObject、readObject）吗？如果是这样，还有其他处理超类的选项。

见：http: [//java.sun.com/javase/6/docs/api/java/io/Serializable.html](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)

HTH 汤姆

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-30T14:00:34.157

实际上，指出汤姆的链接是否缺失`serialVersionID`实际上是由序列化运行时计算的，即不是在编译期间

> 如果可序列化类没有显式声明 serialVersionUID，则序列化运行时将根据类的各个方面计算该类的默认 serialVersionUID 值...

这使得拥有不同版本的 JRE 的事情变得更加复杂。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-05T10:43:32.297

从概念上讲，序列化数据如下所示：

```
subClassData(className + version + fieldNames + fieldValues)
parentClassData(className + version + fieldNames + fieldValues)
... (up to the first parent, that implements Serializable) 
```

因此，当您反序列化时，层次结构中任何类的版本不匹配都会导致反序列化失败。没有为接口存储任何内容，因此无需为它们指定版本。

**所以答案是：**是的，你确实需要`serialVersionUID`在基础抽象类中提供，即使它没有字段：`className`+`version`仍然存储。

另请注意以下几点：

1.  如果一个类没有在序列化数据中遇到的字段（已删除的字段），则将其忽略。
2.  如果类具有序列化数据中不存在的字段（新字段），则将其设置为 0/false/null。它没有像人们期望的那样设置为默认值。
3.  如果字段更改类型，则反序列化的值必须可分配给新类型。例如，如果您有一个`Object`带`String`值的字段，将字段类型更改为`String`会成功，但将其更改为`Integer`不会。但是，即使您可以将值分配给变量，将字段从更改`int`为将不起作用。`long``int``long`
4.  如果子类不再扩展它在序列化数据中扩展的父类，则忽略它（如情况 1）。
5.  如果子类现在扩展了序列化数据中未找到的类，则使用 0/false/null 值恢复父类字段（如情况 2）。

简而言之：您可以重新排序字段，添加和删除它们，甚至更改类层次结构。您不应该重命名字段或类（它不会失败，但会像删除和添加该字段一样处理）。您不能更改原始类型的字段类型，并且可以更改引用类型字段，前提是新类型可以从所有序列化值中分配。

注意：如果基类没有实现`Serializable`而只有子类实现了，那么基类中的字段将表现为`transient`.

# javascript - flash元素上方的图像

> ID：893261
> 
> 赞同：2
> 
> 时间：2009-05-21T14:38:00.213
> 
> 标签：javascript, html, css, flash

我有一个嵌入的闪存，它是上传文件所必需的，我想在它上面放置一个图像。

```
Image1 Shows the expected result: http://i42.tinypic.com/2jcfshv.png 
```

但是我不知道如何实现它，它看起来像这样：

```
Image2 Shows the actual result rendered by browser:   
http://i40.tinypic.com/2hnp848.png 
```

这是我的闪光灯

```
<OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="16" HEIGHT="16" id="flashUpload" ALIGN="">

<PARAM NAME=movie VALUE="{swf_upload_url}?UploadSession={upload_session}&AccessKey={AccessKey}&ServerID={ServerID}&ShowTopBtn=1&TopBtnIcon={SKIN_DIR}/images/a.png">  
 <PARAM NAME=quality VALUE=high>  
 <PARAM NAME=allowScriptAccess VALUE=always>  
 <PARAM NAME=bgcolor VALUE=#000000>  
 <EMBED src="{swf_upload_url}?UploadSession={upload_session}&AccessKey={AccessKey}&ServerID={ServerID}&ShowTopBtn=1&TopBtnIcon={SKIN_DIR}/images/a.png" quality=high bgcolor=#000000  WIDTH="32" HEIGHT="32" NAME="flashUpload" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED>  
</OBJECT> 
```

虽然有 "&TopBtnIcon={SKIN_DIR}/images/a.png" 它不起作用。

谢谢你。

问候，

什尚特·托迪

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T14:48:24.153

为了使 HTML 元素显示在 Flash 上方，您必须将 Flash 嵌入中的“wmode”参数设置为“透明”。

`<PARAM NAME=wmode VALUE=transparent>` `<EMBED src="{swf_upload_url}?UploadSession={upload_session}&AccessKey={AccessKey}&ServerID={ServerID}&ShowTopBtn=1&TopBtnIcon={SKIN_DIR}/images/a.png" quality=high bgcolor=#000000 wmode=transparent WIDTH="32" HEIGHT="32" NAME="flashUpload" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED>`

添加我在上面放置的额外 PARAM 标记，然后将“wmode”属性添加到 EMBED 标记（如我的示例中所示），您应该是金色的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-21T14:47:33.377

您应该能够通过使用图像的 z-index css 属性来纠正它。

尝试将其设置为一个巨大的数字，例如：z-index:100000;

发生这种情况是因为 Flash 播放器试图高于其所在页面上的所有其他元素。

已编辑：如果您使用上述 Flash 播放器中的“wmode”，则此方法有效。

# iphone - 从 iPhone 应用程序流式传输 MP3 的最佳方式？

> ID：893263
> 
> 赞同：2
> 
> 时间：2009-05-21T14:39:08.337
> 
> 标签：iphone, objective-c, audio-streaming

我正在开发一个应用程序，它将通过 iPhone 应用程序从我的服务器流式传输音乐。

这是我的第一个 iPhone 应用程序，所以我有点困惑：

1.  最好的方法是什么？

2.  是否已经内置了我可以使用的东西，比如我只需要指向正确服务器的 MP3 播放器？

3.  我需要流媒体服务器吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T19:40:21.070

我对 Objective-C/Cocoa（触摸）比较陌生，但我在 cocoawithlove 网站上阅读了一篇题为“流式传输和播放 MP3 流”的文章，并在我的 iPhone 上测试了示例代码，它运行良好。我不知道许可或任何事情，如果您能够使用它，但我相信有人甚至您可以弄清楚。

再次抱歉无法提供更多信息甚至链接。这是我对 SO 的第一个回答，不能发布超链接 :(

（编辑：这是链接：[流式传输和播放 MP3 流](http://cocoawithlove.com/2008/09/streaming-and-playing-live-mp3-stream.html)）

# .net - 来自多个项目的单个组件

> ID：893267
> 
> 赞同：7
> 
> 时间：2009-05-21T14:39:32.580
> 
> 标签：.net, assemblies

在一个解决方案中涉及多个项目的 .net 应用程序中，我有一个项目的名称空间设置为 Company.Product.UI，另一个项目的名称空间设置为 Company.Product.UI.WebPages。我的问题是构建这两个项目会产生两个 dll。我怎样才能拥有一个 dll 并仍然保留当前的解决方案结构。我使用 Visual Studio 2008 和 C#。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-21T14:43:26.473

您必须将两个项目合并为一个项目，或使用[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)之类的工具将生成的程序集合并为一个程序集。

> ILMerge 是一个实用程序，可用于将多个 .NET 程序集合并为一个程序集。它可从 Microsoft .NET Framework 开发人员中心的工具和实用程序页面免费使用。

如果您想将 ILMerge 自动化为 MSBuild 任务，那么我建议您查看[ilmerge-tasks](http://code.google.com/p/ilmerge-tasks/)：

> 有兴趣在自动构建期间使用 ILMerge？ILMerge Tasks 包含两个可构建的项目，可让您从 MSBuild 和 NAnt 作为任务访问 ILMerge。它甚至包括一个合并 ILMerge 和任务 dll 的构建后事件，这样您就可以在不存在 ILMerge.exe 的情况下使用该任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T15:26:15.123

我想您可以创建一个新的项目文件，其中包含两个项目中的所有文件。这样，您可以保留当前的开发结构，并使用合并的项目文件来构建要从项目中发布的输出。项目文件是相当简单的 xml 文件，因此如果您在文本编辑器中打开其中一个文件，您可能会很快弄清楚它们是如何工作的。

这种方法的明显缺点当然是，当在其中一个项目中添加或删除文件时，您需要维护第三个项目文件，但如果这种情况不经常发生，我认为它可以很好地工作.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-10T05:33:17.160

有一种简单的方法可以做到这一点，但它可能不是最好的方法。使用所需的 dll 名称创建一个新的解决方案。在这个项目中创建与两个项目名称相同的文件夹结构。然后在特定文件夹上，执行“添加现有项目”。在该名称的项目中添加 cs 文件。添加文件时，在添加按钮上选择“添加为链接”（添加按钮旁边有一个下拉菜单可供您选择）。继续这样做并构建。您将拥有该 dll。

例如。如果您有一个名为 A 的项目和一个名为 B 的项目，并且您想将它们合并到一个名为 C 的 dll 中。创建一个名为 C 的新项目。在此项目中添加一个名为 A 的文件夹和另一个名为 B 的文件夹。现在说项目 A 有一个cs 文件 X.cs 和 B 有一个叫 Y.cs。在名为 A 的文件夹上，右键单击并添加现有项目。转到项目 A 并选择 X.cs。在添加按钮旁边，您会看到一个向下箭头。单击它并选择添加为链接。对 B 执行相同操作。构建此项目，您将在 bin 文件夹中获得 dll。

# java - 在摆动中处理溢出的组件

> ID：893270
> 
> 赞同：0
> 
> 时间：2009-05-21T14:39:48.773
> 
> 标签：java, swing

在我的应用程序中，我有一些较长的标签，在中文操作系统上，标签也会溢出并推出其他组件。这仅在中文操作系统上观察到。如何检测和处理溢出的组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:32:14.033

JComponent 有一个[setMaximumSize](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html#setMaximumSize(java.awt.Dimension))方法可以帮助您。根据您使用的 LayoutManager，结果可能会有所不同。要在布局级别设置这样的约束，请检查[SpringLayout](http://java.sun.com/docs/books/tutorial/uiswing/layout/spring.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:40:30.297

我猜这对某些人来说是个问题，具体取决于窗口大小和语言。

也许不是你想要的，但你可以像这样检查文本的大小：

```
// get metrics from the graphics
FontMetrics metrics = graphics.getFontMetrics(font);
// get the height of a line of text in this font and render context
int hgt = metrics.getHeight();
// get the advance of my text in this font and render context
int adv = metrics.stringWidth(text); 
```

如果文本长于限制（您必须摆脱困境），您可以截断甚至缩写它 - 如果它是已知的，或者可能用图标替换它并使用工具提示来显示全文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T20:03:03.643

您可以使用一些额外的代码使 JTextArea 表现得像一个标签，但它会根据需要将文本换行，而不是使用省略号 (...) 进行缩写。设计你的 UI 时要考虑到包装。

```
JTextArea label = new JTextArea();
label.setText( text );
label.setWrapStyleWord( true );
label.setLineWrap( true );
label.setEnabled( false );
label.setOpaque( false ); 
```

# c# - Windows 服务在异常时重新启动

> ID：893273
> 
> 赞同：0
> 
> 时间：2009-05-21T14:40:13.657
> 
> 标签：c#, asp.net, windows-services, timeout, system.net.webexception

我正在构建一个定期从网站获取信息的 Windows 服务 当捕获到异常时如何重新开始查找？例如，当互联网随后出现故障时。

### 代码：

```
public string cadena(string pagina)
        {
            try
            {
                String cadena;
                WebRequest myWebRequest = WebRequest.Create(pagina);
                myWebrequest = 10000;
                WebResponse myWebResponse = myWebRequest.GetResponse();
                Stream ReceiveStream = myWebResponse.GetResponseStream();
                Encoding encode = System.Text.Encoding.GetEncoding("ISO-8859-1");
                StreamReader readStream = new StreamReader(ReceiveStream, encode);
                cadena = readStream.ReadToEnd();
                readStream.Close();
                myWebResponse.Close();
                return cadena;
            }
            catch (WebException error)
            {
                myTimer.Enabled = true;
                return "error";
            }
        }
public void inicia(object sender, System.Timers.ElapsedEventArgs e)
        {
                myTimer.Enabled = false;
                String strSite = cadena("www.something.com");
                //Do something with strSite...
                myTimer.Enabled = true;            
        }
    protected override void OnStart(string[] args)
            {           
                    myTimer = new System.Timers.Timer();                    
                    myTimer.Interval = 1500;         
                    myTimer.Elapsed += new System.Timers.ElapsedEventHandler(inicia);      
                    myTimer.Enabled = true;            
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T14:50:29.937

这是一个非常粗略的示例来帮助您入门，这将使您的程序无法继续，直到您得到有效的响应。有更好的方法可以做到这一点，但这是您想要的想法。祝你好运！

```
myWebResponse = myWebRequest.GetResponse();
while (myWebResponse.ContentLength == -1) {  
  //sleep
 myWebResponse = myWebRequest.GetResponse();
}  

//continue execution 
```

您可能应该检查远程站点是否可用，然后轮询直到可用，或者在服务可用时中断。这样您就不必从抛出的异常中恢复。

我认为应该为对您的应用程序带来更多灾难性的事情保留使用异常。

# vb.net - 有没有更好的方法让 Visual Studio 在调试模式下忽略 try/catch

> ID：893277
> 
> 赞同：6
> 
> 时间：2009-05-21T14:40:57.757
> 
> 标签：vb.net, if-statement, debugging, try-catch

我希望设计人员在我调试时捕捉到错误，并且我希望用户在他们发生错误时看到我的友好消息。我知道我可以通过以下方式完成此操作：

```
#If Debug=False Then

Try

#End If

'some code here

#If Debug=False Then

Catch ex as exception

    Messagebox.Show("Errors suck")

End Try

#End If 
```

我不想写所有的#statements 并让它们弄乱我的代码。看起来这应该是一个共同的需求，并且必须有更好的方法。有谁知道更好的方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T14:45:08.340

在 VS.NET 中，您可以说是否希望调试器在**抛出**异常时中断（而不仅仅是在未处理时）。

查看调试 | 例外...菜单项（我的键盘快捷键上的 Ctl-Alt-E）。选择您感兴趣的异常，然后勾选该异常的“抛出”框。

您可以在多个级别勾选该框（所有 CLR 异常、给定命名空间中的所有 CLR 异常或非常具体的异常）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T14:46:17.513

除了您所做的之外，没有其他好方法可以让它忽略尝试捕获。但是您可以使代码更简洁一些，并且基本上可以获得相同的效果。您实际上是在尝试阻止 catch 块中的操作运行。一个更好的方法是条件编译方法。

```
Try
... 
Catch ex As Exception
  DebugLog(ex)
  Throw
End Try

<Condition("DEBUG)> _
Public Sub DebugLog(ByVal ex As Exception) 
  Messagebox.Show("errors suck")
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T14:44:52.087

在 Try..Catch 的 catch 部分中，您应该将异常消息、堆栈跟踪以及您可能想要的任何其他内容写入日志文件——此外，您还可以将该数据写入 Windows 事件日志。

在最坏的情况下，您可以在 Try..Catch 块的 Catch 部分放置断点，因为您通常不应该碰到它们，一旦设置它就不应该有什么大不了的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-07T22:51:54.507

这是我的做法：

启用：

```
Try ' : Catch: End Try
  doSomething
  andSomeMore
  etcEtc
' Try
Catch ex As Exception
  handleException
End Try 
```

通过删除两个注释字符禁用上述：

```
Try : Catch : End Try
  doSomething
  andSomeMore
  etcEtc
Try
Catch ex As Exception
  handleException
End Try 
```

# video - 什么视频格式最小又不失画质？

> ID：893278
> 
> 赞同：2
> 
> 时间：2009-05-21T14:41:14.230
> 
> 标签：video, hosting, file-format

我们有一个新客户，我们将为其托管内容。客户正在制作大量视频内容。他们问我们希望文件采用什么格式。

现在，此视频内容将上传并存储在我们基于 Web 的 CRM 中。客户的客户将可以通过浏览器直接下载（非流式传输）此内容。

什么文件格式可以产生最小的文件，同时仍然保持良好的质量，并且在大多数媒体播放器（Winamp、Windows Media Player 等）中都足够普遍？

**更新：**我应该更清楚一点。首先，我们没有流式传输视频。它们仅供下载。他们必须在 Winamp 和 Windows Media Player 等常用媒体播放器中播放。我们客户的一些客户是大公司，因此部署新的编解码器来播放内容并不是一个有利的选择。它需要开箱即用，以便排除 Flash 和 Xvid。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T14:46:18.947

我更喜欢[XviD](http://www.xvid.org/)，但它需要第三方编解码器。

如果兼容性取代压缩，我会推荐[ASF](http://msdn.microsoft.com/en-us/library/aa390652(VS.85).aspx)，它基本上只是 WMA 和 WMV 的容器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T14:49:27.397

为什么不看看大玩家已经在网络上做什么呢？[此 Wikipedia 页面](http://en.wikipedia.org/wiki/Youtube#Video_format)描述了 YouTube 用于其视频格式的内容（FLV 根据目标使用各种编解码器等）。

最优质的视频是您的最终用户可以实际看到的视频，因此在为 Web 构建时要采用最大兼容性的方法，除非您的内容有足够的吸引力，用户愿意为安装而付出额外的麻烦他们可能没有的编解码器或视频播放器。

您无法在市场渗透方面击败 Flash。您可以使用 Flash 制作质量相当好的视频，但会增加文件大小 - 这是您必须根据您的目标市场自行决定的权衡。

**编辑：**根据您的更新，听起来您的目标是 Windows。因此，您可能需要使用 .WMV，而哪个版本取决于您的客户端用户使用的 Windows 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T14:46:42.190

质量最好的最小的是 Flash 视频。这是你可以支持的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:56:46.493

这是一个加载的问题，您是否在询问媒体播放器支持哪些编解码器以及提供最佳质量压缩比的编解码器。

如果您可以很好地将编解码器部署到客户端，否则您会受到限制，并且可能最终会使用基于闪存的解决方案，例如 youtube。

如果您可以让他们安装编解码器，请使用 xvid：

[http://www.codecguide.com/download_kl.htm](http://www.codecguide.com/download_kl.htm)

如果不是 flv 媒体播放器：

[http://www.longtailvideo.com/players/jw-flv-player/](http://www.longtailvideo.com/players/jw-flv-player/)

# c# - 不安全的每像素访问，30ms 访问 1756000 像素

> ID：893283
> 
> 赞同：7
> 
> 时间：2009-05-21T14:42:39.017
> 
> 标签：c#, performance, gdi+

因此，我一直在我的网站上就上述主题标题分享一些关于快速、不安全的像素访问的想法。一位先生给了我一个粗略的例子，说明他如何在 C++ 中做到这一点，但这对我在 C# 中没有帮助，除非我可以互操作，而且互操作也很快。我在互联网上找到了一个使用 MSDN 帮助编写的类，用于不安全地访问像素。上课速度特别快，但还不够快。这是课程：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Drawing;
using System.Drawing.Imaging;

namespace DCOMProductions.Desktop.ScreenViewer {
public unsafe class UnsafeBitmap {
    Bitmap bitmap;

    // three elements used for MakeGreyUnsafe
    int width;
    BitmapData bitmapData = null;
    Byte* pBase = null;

    public UnsafeBitmap(Bitmap bitmap) {
        this.bitmap = new Bitmap(bitmap);
    }

    public UnsafeBitmap(int width, int height) {
        this.bitmap = new Bitmap(width, height, PixelFormat.Format32bppArgb);
    }

    public void Dispose() {
        bitmap.Dispose();
    }

    public Bitmap Bitmap {
        get {
            return (bitmap);
        }
    }

    private Point PixelSize {
        get {
            GraphicsUnit unit = GraphicsUnit.Pixel;
            RectangleF bounds = bitmap.GetBounds(ref unit);

            return new Point((int)bounds.Width, (int)bounds.Height);
        }
    }

    public void LockBitmap() {
        GraphicsUnit unit = GraphicsUnit.Pixel;
        RectangleF boundsF = bitmap.GetBounds(ref unit);
        Rectangle bounds = new Rectangle((int)boundsF.X,
      (int)boundsF.Y,
      (int)boundsF.Width,
      (int)boundsF.Height);

        // Figure out the number of bytes in a row
        // This is rounded up to be a multiple of 4
        // bytes, since a scan line in an image must always be a multiple of 4 bytes
        // in length. 
        width = (int)boundsF.Width * sizeof(Pixel);
        if (width % 4 != 0) {
            width = 4 * (width / 4 + 1);
        }
        bitmapData =
      bitmap.LockBits(bounds, ImageLockMode.ReadWrite, PixelFormat.Format32bppArgb);

        pBase = (Byte*)bitmapData.Scan0.ToPointer();
    }

    public Pixel GetPixel(int x, int y) {
        Pixel returnValue = *PixelAt(x, y);
        return returnValue;
    }

    public void SetPixel(int x, int y, Pixel colour) {
        Pixel* pixel = PixelAt(x, y);
        *pixel = colour;
    }

    public void UnlockBitmap() {
        bitmap.UnlockBits(bitmapData);
        bitmapData = null;
        pBase = null;
    }
    public Pixel* PixelAt(int x, int y) {
        return (Pixel*)(pBase + y * width + x * sizeof(Pixel));
    }
} 
```

}

基本上我正在做的是复制整个屏幕并将每个像素与旧副本进行比较。在 1680x1050 位图上，使用以下代码大约需要 300 毫秒。

```
private Bitmap GetInvalidFrame(Bitmap frame) {
        Stopwatch sp = new Stopwatch();
        sp.Start();

        if (m_FrameBackBuffer == null) {
            return frame;
        }

        Int32 pixelsToRead = frame.Width * frame.Height;
        Int32 x = 0, y = 0;

        UnsafeBitmap unsafeBitmap = new UnsafeBitmap(frame);
        UnsafeBitmap unsafeBuffBitmap = new UnsafeBitmap(m_FrameBackBuffer);
        UnsafeBitmap retVal = new UnsafeBitmap(frame.Width, frame.Height);

        unsafeBitmap.LockBitmap();
        unsafeBuffBitmap.LockBitmap();
        retVal.LockBitmap();

        do {
            for (x = 0; x < frame.Width; x++) {
                Pixel newPixel = unsafeBitmap.GetPixel(x, y);
                Pixel oldPixel = unsafeBuffBitmap.GetPixel(x, y);

                if (newPixel.Alpha != oldPixel.Alpha || newPixel.Red != oldPixel.Red || newPixel.Green != oldPixel.Green || newPixel.Blue != oldPixel.Blue) {
                   retVal.SetPixel(x, y, newPixel);
                }
                else {
                    // Skip pixel
                }
            }

            y++;
        } while (y != frame.Height);

        unsafeBitmap.UnlockBitmap();
        unsafeBuffBitmap.UnlockBitmap();
        retVal.UnlockBitmap();

        sp.Stop();

        System.Diagnostics.Debug.WriteLine(sp.Elapsed.Milliseconds.ToString());

        sp.Reset();

        return retVal.Bitmap;
    } 
```

是否有任何可能的方法/手段/方法可以将其加速到大约 30 毫秒？我可以使用 Graphics.CopyFromScreen() 在大约 30 毫秒内复制屏幕，从而每秒产生大约 30 帧。但是，一个程序的运行速度与其较慢的对应程序一样快，因此 GetInvalidFrame 中的 300 毫秒延迟将其减慢到每秒大约 1 - 3 帧。这对会议软件不利。

任何朝着正确方向的建议、方法和指示都会非常棒！此外，用于在客户端绘制位图的代码也在下面。

要评论 Dmitriy 的回答/评论：

```
#region RootWorkItem

    private ScreenClient m_RootWorkItem;
    /// <summary>
    /// Gets the RootWorkItem
    /// </summary>
    public ScreenClient RootWorkItem {
        get {
            if (m_RootWorkItem == null) {
                m_RootWorkItem = new ScreenClient();
                m_RootWorkItem.FrameRead += new EventHandler<FrameEventArgs>(RootWorkItem_FrameRead);
            }
            return m_RootWorkItem;
        }
    }

    #endregion

    private void RootWorkItem_FrameRead(Object sender, FrameEventArgs e) {
        if (e.Frame != null) {
            if (uxSurface.Image != null) {
                Bitmap frame = (Bitmap)uxSurface.Image;

                Graphics g = Graphics.FromImage(frame);
                g.DrawImage(e.Frame, 0, 0); // Draw only updated pixels

                uxSurface.Image = frame;
            }
            else {
                uxSurface.Image = e.Frame; // Draw initial, full image
            }
        }
        else {
            uxSurface.Image = null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-22T15:34:48.403

使用整数而不是像素和单循环的不安全方法：

```
private static Bitmap GetInvalidFrame(Bitmap oldFrame, Bitmap newFrame)
{
    if (oldFrame.Size != newFrame.Size)
    {
        throw new ArgumentException();
    }
    Bitmap result = new Bitmap(oldFrame.Width, oldFrame.Height, oldFrame.PixelFormat);

    Rectangle lockArea = new Rectangle(Point.Empty, oldFrame.Size);
    PixelFormat format = PixelFormat.Format32bppArgb;
    BitmapData oldData = oldFrame.LockBits(lockArea, ImageLockMode.ReadOnly, format);
    BitmapData newData = newFrame.LockBits(lockArea, ImageLockMode.ReadOnly, format);
    BitmapData resultData = result.LockBits(lockArea, ImageLockMode.WriteOnly, format);

    int len = resultData.Height * Math.Abs(resultData.Stride) / 4;

    unsafe
    {
        int* pOld = (int*)oldData.Scan0;
        int* pNew = (int*)newData.Scan0;
        int* pResult = (int*)resultData.Scan0;

        for (int i = 0; i < len; i++)
        {
            int oldValue = *pOld++;
            int newValue = *pNew++;
            *pResult++ = oldValue != newValue ? newValue : 0 /* replace with 0xff << 24 if you need non-transparent black pixel */;
            // *pResult++ = *pOld++ ^ *pNew++; // if you can use XORs.
        }
    }

    oldFrame.UnlockBits(oldData);
    newFrame.UnlockBits(newData);
    result.UnlockBits(resultData);

    return result;
} 
```

我认为你真的可以在这里使用 XORed 帧，我希望这可以在双方都有更好的性能。

```
 private static void XorFrames(Bitmap leftFrame, Bitmap rightFrame)
    {
        if (leftFrame.Size != rightFrame.Size)
        {
            throw new ArgumentException();
        }

        Rectangle lockArea = new Rectangle(Point.Empty, leftFrame.Size);
        PixelFormat format = PixelFormat.Format32bppArgb;
        BitmapData leftData = leftFrame.LockBits(lockArea, ImageLockMode.ReadWrite, format);
        BitmapData rightData = rightFrame.LockBits(lockArea, ImageLockMode.ReadOnly, format);

        int len = leftData.Height * Math.Abs(rightData.Stride) / 4;

        unsafe
        {
            int* pLeft = (int*)leftData.Scan0;
            int* pRight = (int*)rightData.Scan0;

            for (int i = 0; i < len; i++)
            {
                *pLeft++ ^= *pRight++;
            }
        }

        leftFrame.UnlockBits(leftData);
        rightFrame.UnlockBits(rightData);
    } 
```

您可以通过以下方式在双方使用此过程：
在服务器端，您需要评估新旧框架之间的差异，将其发送给客户端并用新框架替换旧框架。服务器代码应如下所示：

```
 XorFrames(oldFrame, newFrame); // oldFrame ^= newFrame
  Send(oldFrame); // send XOR of two frames
  oldFrame = newFrame; 
```

在客户端，您需要使用从服务器收到的 xor 帧更新当前帧：

```
 XorFrames((Bitmap)uxSurface.Image, e.Frame); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T14:48:14.683

`unsafe`是的，您可以通过使用代码来做到这一点。

```
BitmapData d = l.LockBits(new Rectangle(0, 0, l.Width, l.Height), ImageLockMode.ReadOnly,l.PixelFormat);
IntPtr scan = d.Scan0;
unsafe
{
    byte* p = (byte*)(void*)scan;
    //dostuff               
} 
```

查看[http://www.codeproject.com/KB/GDI-plus/csharpgraphicfilters11.aspx](http://www.codeproject.com/KB/GDI-plus/csharpgraphicfilters11.aspx)了解此类内容的一些基本示例。我的代码就是基于此。

注意：这比您的要快得多的原因之一是您分别比较每个通道，而不是仅使用一个操作比较整个字节。同样，更改 PixelAt 为您提供一个字节来促进这一点可能会给您带来改进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T14:55:00.333

这里：[Utilizing the GPU with c#](https://stackoverflow.com//questions/375011/utilizing-the-gpu-with-c)提到了一些从 C# 中使用 GPU 的库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T14:49:36.773

无需检查每个像素，您只需执行 2 个位图的基本内存比较即可。在 C 中，类似于 memcmp()。

这将为您提供更快的测试，让您知道图像是否相同。只有当您知道它们不同时，您才需要使用更昂贵的代码来帮助您确定它们的不同之处（如果您甚至需要知道的话）。

我不是 C# 人，所以我不知道访问原始内存有多么容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T07:57:39.447

能够切断大约 60 毫秒。我认为这将需要 GPU。我没有看到任何使用 CPU 的解决方案，即使一次比较多个字节/像素，除非有人可以编写代码示例来向我展示。仍然坐在大约 200-260 毫秒，对于 30 fps 来说太慢了。

```
private static BitmapData m_OldData;
private static BitmapData m_NewData;
private static unsafe Byte* m_OldPBase;
private static unsafe Byte* m_NewPBase;
private static unsafe Pixel* m_OldPixel;
private static unsafe Pixel* m_NewPixel;
private static Int32 m_X;
private static Int32 m_Y;
private static Stopwatch m_Watch = new Stopwatch();
private static GraphicsUnit m_GraphicsUnit = GraphicsUnit.Pixel;
private static RectangleF m_OldBoundsF;
private static RectangleF m_NewBoundsF;
private static Rectangle m_OldBounds;
private static Rectangle m_NewBounds;
private static Pixel m_TransparentPixel = new Pixel() { Alpha = 0x00, Red = 0, Green = 0, Blue = 0 };

private Bitmap GetInvalidFrame(Bitmap frame) {
    if (m_FrameBackBuffer == null) {
        return frame;
    }

    m_Watch.Start();

    unsafe {
        m_OldBoundsF = m_FrameBackBuffer.GetBounds(ref m_GraphicsUnit);
        m_OldBounds = new Rectangle((Int32)m_OldBoundsF.X, (Int32)m_OldBoundsF.Y, (Int32)m_OldBoundsF.Width, (Int32)m_OldBoundsF.Height);
        m_OldData = m_FrameBackBuffer.LockBits(m_OldBounds, ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);

        m_NewBoundsF = m_FrameBackBuffer.GetBounds(ref m_GraphicsUnit);
        m_NewBounds = new Rectangle((Int32)m_NewBoundsF.X, (Int32)m_NewBoundsF.Y, (Int32)m_NewBoundsF.Width, (Int32)m_NewBoundsF.Height);
        m_NewData = frame.LockBits(m_NewBounds, ImageLockMode.ReadWrite, PixelFormat.Format32bppArgb);

        m_OldPBase = (Byte*)m_OldData.Scan0.ToPointer();
        m_NewPBase = (Byte*)m_NewData.Scan0.ToPointer();

        do {
            for (m_X = 0; m_X < frame.Width; m_X++) {

                m_OldPixel = (Pixel*)(m_OldPBase + m_Y * m_OldData.Stride + 1 + m_X * sizeof(Pixel));
                m_NewPixel = (Pixel*)(m_NewPBase + m_Y * m_NewData.Stride + 1 + m_X * sizeof(Pixel));

                if (m_OldPixel->Alpha == m_NewPixel->Alpha // AccessViolationException accessing Property in get {}
                    || m_OldPixel->Red == m_NewPixel->Red
                    || m_OldPixel->Green == m_NewPixel->Green
                    || m_OldPixel->Blue == m_NewPixel->Blue) {

                    // Set the transparent pixel
                    *m_NewPixel = m_TransparentPixel;
                }
            }

            m_Y++; //Debug.WriteLine(String.Format("X: {0}, Y: {1}", m_X, m_Y));
        } while (m_Y < frame.Height);
    }

    m_Y = 0;

    m_Watch.Stop();
    Debug.WriteLine("Time elapsed: " + m_Watch.ElapsedMilliseconds.ToString());
    m_Watch.Reset();

    return frame;
} 
```

# powershell - PowerShell 语言中有哪些最有用但鲜为人知的功能

> ID：893295
> 
> 赞同：26
> 
> 时间：2009-05-21T14:45:23.863
> 
> 标签：powershell

不久前，我正在阅读有关 PowerShell 中的多变量分配的信息。这可以让你做这样的事情

```
64 >  $a,$b,$c,$d = "A four word string".split()

65 >  $a
A

66 >  $b
four 
```

或者您可以在单个语句中交换变量

```
$a,$b = $b,$a 
```

您遇到过哪些鲜为人知的 PowerShell 掘金，您认为它们可能没有应有的知名度？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-21T14:49:35.803

`$$`命令。我经常不得不对同一个文件路径进行重复操作。例如签出一个文件，然后在 VIM 中打开它。该`$$`功能使这变得微不足道

```
PS> tf edit some\really\long\file\path.cpp
PS> gvim $$ 
```

它简短而简单，但可以节省大量时间。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-24T22:40:41.670

到目前为止，PowerShell 最强大的功能是它的[ScriptBlock](http://msdn.microsoft.com/en-us/library/system.management.automation.scriptblock(VS.85).aspx)支持。您可以如此简洁地传递有效的匿名方法而无需任何类型约束，这一事实与 C++ 函数指针一样强大，并且与 C# 或 F# lambda 一样简单。

我的意思是，使用 ScriptBlocks 可以实现“使用”语句（PowerShell 本身没有该语句），这有多酷。或者，在 v2 之前，您甚至可以实现[try-catch-finally](http://weblogs.asp.net/adweigert/archive/2007/10/10/powershell-try-catch-finally-comes-to-life.aspx)。

```
function Using([Object]$Resource,[ScriptBlock]$Script) {
    try {
        &$Script
    }
    finally {
        if ($Resource -is [IDisposable]) { $Resource.Dispose() }
    }
}

Using ($File = [IO.File]::CreateText("$PWD\blah.txt")) {
   $File.WriteLine(...)
} 
```

多么酷啊！

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-22T13:13:32.087

我发现一个经常被忽视的特性是将文件传递给 switch 语句的能力。

Switch 将遍历行并匹配字符串（或带有 -regex 参数的正则表达式）、变量的内容、数字，或者可以将行传递到要评估为 $true 或 $false 的表达式

```
switch -file 'C:\test.txt' 
{   
  'sometext' {Do-Something}   
  $pwd {Do-SomethingElse}  
  42 {Write-Host "That's the answer."}  
  {Test-Path $_} {Do-AThirdThing}  
  default {'Nothing else matched'} 
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-21T15:23:20.463

$OFS -[输出字段分隔符](http://keithhill.spaces.live.com/blog/cns!5A8D2641E0963A97!6957.entry)。一种指定在呈现为字符串时如何分隔数组元素的便捷方法：

```
PS> $OFS = ', '
PS> "$(1..5)"
1, 2, 3, 4, 5
PS> $OFS = ';'
PS> "$(1..5)"
1;2;3;4;5
PS> $OFS = $null # set back to default
PS> "$(1..5)"
1 2 3 4 5 
```

[始终保证您获得数组结果](http://keithhill.spaces.live.com/blog/cns!5A8D2641E0963A97!816.entry)。考虑这段代码：

```
PS> $files = dir *.iMayNotExist
PS> $files.length 
```

在这种情况下，$files 可能是 $null、标量值或值数组。$files.length 不会为您提供为 $null 或单个文件找到的文件数。在单个文件的情况下，您将获得文件的大小！每当我不确定我会得到多少数据时，我总是将命令包含在一个数组子表达式中，如下所示：

```
PS> $files = @(dir *.iMayNotExist)
PS> $files.length # always returns number of files in array 
```

那么 $files 将永远是一个数组。它可能是空的或只有一个元素，但它将*是*一个数组。这使得对结果的推理变得更加简单。

数组协方差支持：

```
PS> $arr = '127.0.0.1','192.168.1.100','192.168.1.101'
PS> $ips = [system.net.ipaddress[]]$arr
PS> $ips | ft IPAddressToString, AddressFamily -auto

IPAddressToString AddressFamily
----------------- -------------
127.0.0.1          InterNetwork
192.168.1.100      InterNetwork
192.168.1.101      InterNetwork 
```

[使用 Compare-Object 比较数组](http://keithhill.spaces.live.com/blog/cns!5A8D2641E0963A97!6159.entry)：

```
PS> $preamble = [System.Text.Encoding]::UTF8.GetPreamble()
PS> $preamble | foreach {"0x{0:X2}" -f $_}
0xEF
0xBB
0xBF
PS> $fileHeader = Get-Content Utf8File.txt -Enc byte -Total 3
PS> $fileheader | foreach {"0x{0:X2}" -f $_}
0xEF
0xBB
0xBF
PS> @(Compare-Object $preamble $fileHeader -sync 0).Length -eq 0
True 
```

更多类似的内容，请查看我的免费电子书 - [Effective PowerShell](http://tinyurl.com/efposh)。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-22T02:53:15.017

沿着多变量分配的路线。

$list = 1,2,3,4

While($list) {
$head, $list = $list
$head
}

1
2
3
4

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-26T14:44:26.273

我一直在使用这个：

```
if (!$?) {  # if previous command was not successful
    Do some stuff
} 
```

而且我也经常使用 $_ （当前管道对象），但这些可能比其他东西更广为人知。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-24T04:41:47.727

许多运算符也适用于数组并返回比较为真的元素或独立地对数组的每个元素进行操作的事实：

```
1..1000 -lt 800 -gt 400 -like "?[5-9]0" -replace 0 -as "int[]" -as "char[]" -notmatch "\d" 
```

这比`Where-Object`.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-03-05T06:53:29.017

不是语言功能，但超级有用

`f8`-- 获取您已经输入的文本并搜索以该文本开头的命令。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-10-15T03:53:03.520

使用标签搜索您的历史记录#

例子：

PS> Get-Process explorer
PS> 《福特探索者》
PS> 《麦哲伦》 | Add-Content "great explorers.txt"
PS> type "great explorers.txt"
PS> #expl *<-- 按 <tab> 键循环浏览具有术语“expl”的历史条目*

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-26T21:19:54.233

喜欢这个线程。在阅读 Windows Powershell in Action 之后，我可以列出很多东西。那本书和文档之间存在脱节。我实际上试图在此处的其他地方列出它们，但因“不是问题”而被搁置。

我将从具有三个脚本块（开始/处理/结束）的 foreach 开始：

```
Get-ChildItem | ForEach-Object {$sum=0} {$sum++} {$sum} 
```

说到交换两个变量，这里交换两个文件：

```
${c:file1.txt},${c:file2.txt} = ${c:file2.txt},${c:file1.txt} 
```

搜索和替换文件：

```
${c:file.txt} = ${c:file.txt} -replace 'oldstring','newstring' 
```

使用程序集和使用命名空间语句：

```
using assembly System.Windows.Forms
using namespace System.Windows.Forms
[messagebox]::show('hello world') 
```

foreach 的较短版本，带有属性和方法

```
ps | foreach name
'hi.there' | Foreach Split . 
```

在字符串之外使用 $() 运算符来组合两个语句：

```
$( echo hi; echo there ) | measure 
```

使用变量获取内容/设置内容：

```
$a = ''
get-content variable:a | set-content -value there 
```

匿名函数：

```
1..5 | & {process{$_ * 2}} 
```

给匿名函数起一个名字：

```
$function:timestwo = {process{$_ * 2}} 
```

带参数的匿名函数：

```
& {param($x,$y) $x+$y} 2 5 
```

您可以使用这些从 foreach () 流式传输，通常您不能：

```
& { foreach ($i in 1..10) {$i; sleep 1} } | out-gridview 
```

在后台运行进程，如 unix '&'，然后等待它们：

```
$a = start-process -NoNewWindow powershell {timeout 10; 'done a'} -PassThru
$b = start-process -NoNewWindow powershell {timeout 10; 'done b'} -PassThru
$c = start-process -NoNewWindow powershell {timeout 10; 'done c'} -PassThru
$a,$b,$c | wait-process 
```

或工作流程中的 foreach -parallel：

```
workflow work {
  foreach -parallel ($i in 1..3) { 
    sleep 5 
    "$i done" 
  }
}

work 
```

或者一个工作流并行块，您可以在其中运行不同的东西：

```
function sleepfor($time) { sleep $time; "sleepfor $time done"}

workflow work {
  parallel {
    sleepfor 3
    sleepfor 2
    sleepfor 1
  }
  'hi'
}

work 
```

使用 api 在另外三个运行空间中的三个并行命令：

```
$a =  [PowerShell]::Create().AddScript{sleep 5;'a done'}
$b =  [PowerShell]::Create().AddScript{sleep 5;'b done'}
$c =  [PowerShell]::Create().AddScript{sleep 5;'c done'}
$r1,$r2,$r3 = ($a,$b,$c).begininvoke()

$a.EndInvoke($r1); $b.EndInvoke($r2); $c.EndInvoke($r3) # wait
($a,$b,$c).Streams.Error # check for errors
($a,$b,$c).dispose() # cleanup 
```

使用调用命令的并行进程，但您必须在远程 powershell 工作的提升提示下：

```
invoke-command localhost,localhost,localhost { sleep 5; 'hi' } 
```

赋值是一个表达式：

```
if ($a = 1) { $a } 
$a = $b = 2 
```

使用 -1 获取最后一个数组元素：

```
(1,2,3)[-1] 
```

用 [void] 丢弃输出：

```
[void] (echo discard me) 
```

打开数组和两边的 $_：

```
switch(1,2,3,4,5,6) {
  {$_ % 2} {"Odd $_"; continue}
  4 {'FOUR'}
  default {"Even $_"}
} 
```

获取和设置模块中的变量：

```
'$script:count = 0
$script:increment = 1
function Get-Count { return $script:count += $increment }' > counter.psm1 # creating file

import-module .\counter.psm1

$m = get-module counter
& $m Get-Variable count
& $m Set-Variable count 33 
```

见模块函数定义：

```
& $m Get-Item function:Get-Count | foreach definition 
```

使用 commandinfo 对象和调用运算符运行命令：

```
$d = get-command get-date
& $d 
```

动态模块：

```
$m = New-Module {
  function foo {"In foo x is $x"}
  $x=2
  Export-ModuleMember -func foo -var x
} 
```

标志枚举：

```
[flags()] enum bits {one = 1; two = 2; three = 4; four = 8; five = 16}
[bits]31 
```

-replace 运算符鲜为人知的代码：

```
$number Substitutes the last submatch matched by group number.
${name} Substitutes the last submatch matched by a named capture of the form (?).
$$ Substitutes a single "$" literal.
$& Substitutes a copy of the entire match itself.
$` Substitutes all the text from the argument string before the matching portion.
$' Substitutes all the text of the argument string after the matching portion.
$+ Substitutes the last submatch captured.
$_ Substitutes the entire argument string. 
```

使用检查点在中断中幸存的工作流演示。杀死窗口或重新启动。然后重新启动PS。使用 get-job 和 resume-job 恢复作业。

```
workflow test1 {
  foreach ($b in 1..1000) {
    $b
    Checkpoint-Workflow
  }
}
test1 -AsJob -JobName bootjob 
```

Emacs 编辑模式。按制表符完成一次列出所有选项。很有用。

```
Set-PSReadLineOption -EditMode Emacs 
```

任何以“get-”开头的命令，都可以省略“get-”：

```
date
help 
```

结束解析`--%`和结束参数`--`运算符。

```
write-output --% -inputobject
write-output -- -inputobject 
```

通配符上的制表符补全：

```
cd \pro*iles # press tab 
```

编译并导入带有 cmdlet 的 C# 模块，即使在 Osx 中也是如此：

```
Add-Type -Path ExampleModule.cs -OutputAssembly ExampleModule.dll
Import-Module ./ExampleModule.dll 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-27T10:13:56.267

在序列上向后迭代只需使用`len`序列的 1 在范围的另一侧：

```
foreach( x in seq.length..1) { Do-Something seq[x] } 
```

# c++ - 如何从 QTransform 中提取旋转角度？

> ID：893305
> 
> 赞同：9
> 
> 时间：2009-05-21T14:46:47.167
> 
> 标签：c++, qt, math, transform

我有一个 QTransform 对象，想知道对象旋转的角度，但是没有明确的示例说明如何执行此操作：

[http://doc.trolltech.com/4.4/qtransform.html#basic-matrix-operations](http://doc.trolltech.com/4.4/qtransform.html#basic-matrix-operations)

设置它很容易，将其重新取出很难。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T14:54:25.750

最简单的通用方法是将(0,0)和(1,0)变换，然后用三角函数(arctan)得到角度

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-21T14:54:36.933

假设变换**只**包含一个旋转，这很简单：只需取 m11 元素的 acos 即可。

如果变换包含平移，它仍然有效，但如果它包含剪切或缩放，那么你就不走运了。这些可以通过将矩阵分解为剪切、缩放和旋转矩阵来重建，但你得到的结果很可能不是你想要的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T14:56:08.787

转换矩阵是用于 3d 图形的实现。它简化了数学，以加快点/对象的 3d 位置/旋转方向。由于它累积连续平移/旋转/比例的方式，确实很难从转换中提取方向。

这是一个建议。取一个指向简单方向（如 (1,0,0)）的向量，然后对其应用变换。你得到的向量将被平移和旋转，得到类似这样的东西：(27.8, 19.2, 77.4)。将变换应用于 (0,0,0)，得到类似 (26.1, 19.4, 50.8) 的结果。您可以使用这两个点来计算基于知道它们的起点 (1,0,0) 已应用的旋转。

这有帮助吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T15:30:20.887

通常你需要一个反三角函数，但你需要注意象限模糊，这就是你应该使用的 atan2（有时拼写为 arctan2）。因此，要么将单位向量 [0, 1] 旋转到 [x, y]，然后使用 atan2(y,x)，或者如果矩阵仅实现旋转，则可以使用 atan2(m12,m11)。（这些类似于 Javier 和 Nils 的答案，但它们不使用 atan2。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-17T13:15:51.840

我使用 QGraphicsItem 只是 setRotate 并且没有任何问题，直到我添加了旋转组功能。问题是当destroyItemGroup 被调用时，它会将旋转作为变换应用于项目，而不是作为旋转。因此，我不得不从这个 QTransform 对象中恢复旋转。

我的解决方法是将以下几行添加到 itemChange 方法中（归功于 tom10 的回答）：

```
QVariant MyGraphicItem::itemChange(GraphicsItemChange change, const QVariant &value)
{
    if(change == ItemTransformChange)
    {
        auto transform = value.value<QTransform>();
        setRotation(rotation() + qRadiansToDegrees(qAtan2(transform.m12(), transform.m11())));
        return QVariant();
    }
    ...
} 
```

PS.：使用 acos 和 m11() 的其他解决方案不起作用。正如 tom10 所解释的，它会因某些值而崩溃。

# php - 在 Dreamweaver 中创建记录集时出现此错误 - 使用 MAMP

> ID：893307
> 
> 赞同：0
> 
> 时间：2009-05-21T14:47:04.030
> 
> 标签：php, database, phpmyadmin, dreamweaver, mamp

安装 mamp 并在 Dreamweaver 上设置我的网站后，我收到此错误。我连接到我在 phpMyAdmin 中创建的数据库，然后我尝试为我的应用程序创建一个记录集，然后出现此错误。

在 Recordset.htm 中执行 addDynamicSource 时，发生 JavaScript 错误。

任何想法任何人这是什么以及如何解决它。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T11:25:42.213

如果您希望有人回答，您将需要提供更多信息。可能是没有链接名称的访问脚本的副本，并确保在给出答案时您的链接是正确的，以查看您是否有在编译时注意到的脚本错误。或者可能使用会看到这些错误的编译器

# jquery - 单击页面上的任何其他内容时隐藏元素

> ID：893311
> 
> 赞同：26
> 
> 时间：2009-05-21T14:47:47.523
> 
> 标签：jquery

提到在[这里](https://stackoverflow.com/questions/714471/jquery-hide-element-when-clicked-anywhere-on-the-page "这里")找到的弗兰内克的问题，我还有一个问题。

上面链接上的解决方案对我有用，直到我在我的页面中引入了另一个菜单。在这种情况下，有两个相邻的菜单。当我单击其中一个时，将显示相关的 div，其中显示了可供选择的选项。然后，当我单击文档时，div 会关闭。但是当我单击任何其他元素时，它仍会显示。

对我来说，一个解决方案是运行代码以在任何其他元素单击以及文档单击时关闭菜单。

我怎样才能做到这一点？

（菜单：不可见的 div 元素，当单击其标题时变得可见）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-23T23:59:41.560

这稍微好一点，因为它还检查被单击元素的父级：

```
$(document).click(function(e) {
    var target = e.target;

    if (!$(target).is('#menu') && !$(target).parents().is('#menu')) {
        $('#menu').hide();
    }
}); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-23T23:38:43.567

单击除要隐藏的菜单以外的每个元素对吗？

```
$(function() {
    $('*').click(function(e) {
        if(e.target.id != 'menu') {
            $('#menu').hide();
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-22T08:38:31.310

我的html代码是

```
<div class="filter-show">
    <ul style="display:none;">
        <li>menu 1</li>
        <li>menu 2</li>
        <li>menu 3</li>
    </ul>
</div> 
```

和jQuery代码是

```
<script>
    $('html').click(function(event){
        if(!$(event.target).children().is('.filter-show > ul')){
            $(".filter-show > ul").fadeOut();
        }
    });
    $(".filter-show").click(function(){
        $(".filter-show > ul").fadeOut();
        $(this).children('ul').fadeIn();
    });
    $(".filter-show > ul").hover(function(){
        //
    },function(){
        $(".filter-show > ul").fadeOut();
    });
</script> 
```

# mysql - 对表中的所有列执行求和、平均和乘法？

> ID：893316
> 
> 赞同：0
> 
> 时间：2009-05-21T14:48:45.807
> 
> 标签：mysql

我有一个看起来像这样的表：

```
id    test1    test2    test3    test4 ... test200
1      90       87       85        86        70
2      100      95       83        92        80
.
.
18000 
```

我知道有标准操作可以对单列执行求和和平均，并将两列的值相乘，但是是否可以在具有给定 ID 的行中的所有列上执行此操作？如果不清楚，我想跨行而不是跨列做[这样的事情。](http://www.freeopenbook.com/mysqlcookbook/mysqlckbk-chp-13-sect-6.html)谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T15:01:29.277

您最好重新设计表格，使其没有 200 列。

例如

```
Id  testnum  score
1    1        90
1    2        87
...
2    1        100
2    2        95
...
180000 
```

现在您可以执行如下查询：

```
select sum(score) as totalscore
from mynewtable
where id=1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T14:55:56.447

怎么样：

```
select id, sum(test1 + test2 + ...) as summation
group by id 
```

是你有这么多列的问题吗？该解决方案不能顺利处理许多列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:00:50.307

可能有一些扭曲的 SQL 可以处理整行的内容（我对此表示怀疑），但您仍然必须指定列名，否则您将在计算中包含 ID 号。

# c++-cli - 在 cli 类中声明本机类型？

> ID：893317
> 
> 赞同：0
> 
> 时间：2009-05-21T14:49:09.627
> 
> 标签：c++-cli

我有一个

```
public ref class Test 
```

在这堂课中，我有：

```
int frameWidth;
int frameHeight;
int frameStride; 
```

当我尝试编译它时，我得到了错误：

```
error C2664: 'GetImageSize' : cannot convert parameter 1 from 'cli::interior_ptr<Type>' to 'int *' 
```

GetImageSize 是一个本机函数，只有当我将上面 3 个整数的声明移到类外部或调用 GetImageSize 的块内时，它才有效。

我该如何解决这个问题？

这 3 个整数需要被类中的多个函数访问，现在我使它工作，因为我将它们移到了类之外，但我相信这不是正确的做法，因为它们变得全局。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T15:36:06.943

根据[这篇文章](http://bytes.com/groups/net-vc/444370-cannot-convert-parameter-cli-interior_ptr-type)，你看到这个的原因是因为整数在一个 ref 类中，垃圾收集器可以随意在堆周围移动，整数的地址可能会改变，你不会被告知。

为了克服这个问题，您需要告诉 GC 在您使用对象时不要移动它们。为此，您需要使用

```
pin_ptr<int*> pinnedFrameWidth = &frameWidth; 
```

然后将 pinnedFrameWidth 传递给 GetImageSize。当传递给方法时， pin_ptr 将自动转换为 int*。

使用 pin_ptr 时需要小心。因为 GC 不能在收集期间移动 Test 类的实例，所以托管堆可能会变得碎片化，最终性能会受到影响。理想情况下，在尽可能少的时间内固定尽可能少的对象。

[在这个](http://www.dotnetrocks.com/default.aspx?showNum=443).Net Rocks 节目中有一个关于 pin 指针的简短讨论。

# c# - VS2005，C# - 数据绑定组合框 - 默认情况下，后面的代码会给我错误

> ID：893319
> 
> 赞同：1
> 
> 时间：2009-05-21T14:49:25.697
> 
> 标签：c#, desktop-application

在代码的designer.cs部分，我只是让组合框数据库驱动（它预览数据很好，所以工作）但是当我尝试编译时，它抛出了2个独特的错误：

1) 错误 1 ​​类型名称“mtdDesktopApplicationDataSet”在类型“DesktopApplication.DesktopApplication”中不存在

2) 错误 2 类型名称“mtdDesktopApplicationDataSetTableAdapters”在类型“DesktopApplication.DesktopApplication”中不存在

第一个错误在第一行，另一个错误显示在“mtdDesktopApplicationDataSetTableAdapters”所在的位置（4 行）

所有适当的文件似乎都在那里，但它们只是没有连接对吗？

```
this.mtdDesktopApplicationDataSet = new DesktopApplication.mtdDesktopApplicationDataSet();
this.tblStudyBindingSource = new System.Windows.Forms.BindingSource(this.components);
this.tblStudyTableAdapter = new DesktopApplication.mtdDesktopApplicationDataSetTableAdapters.tblStudyTableAdapter();
this.tblDeliveryGroupBindingSource = new System.Windows.Forms.BindingSource(this.components);
this.tblDeliveryGroupTableAdapter = new DesktopApplication.mtdDesktopApplicationDataSetTableAdapters.tblDeliveryGroupTableAdapter();
this.tblDeliveryBindingSource = new System.Windows.Forms.BindingSource(this.components);
this.tblDeliveryTableAdapter = new DesktopApplication.mtdDesktopApplicationDataSetTableAdapters.tblDeliveryTableAdapter();
this.tblDeliveryDataSetBindingSource = new System.Windows.Forms.BindingSource(this.components);
this.tblDeliveryDataSetTableAdapter = new DesktopApplication.mtdDesktopApplicationDataSetTableAdapters.tblDeliveryDataSetTableAdapter();
 ((System.ComponentModel.ISupportInitialize)(this.mtdDesktopApplicationDataSet)).BeginInit();
 ((System.ComponentModel.ISupportInitialize)(this.tblStudyBindingSource)).BeginInit();
 ((System.ComponentModel.ISupportInitialize)(this.tblDeliveryGroupBindingSource)).BeginInit();
 ((System.ComponentModel.ISupportInitialize)(this.tblDeliveryBindingSource)).BeginInit();
 ((System.ComponentModel.ISupportInitialize)(this.tblDeliveryDataSetBindingSource)).BeginInit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:53:50.460

您是否在任何时候移动/重命名了文件/类，和/或更改了项目的默认命名空间？我已经看到所有这些都具有与上述类似的效果。

重新（生成）行：

```
this.mtdDesktopApplicationDataSet =
        new DesktopApplication.mtdDesktopApplicationDataSet(); 
```

可能值得避免将字段 ( `this.mtdDesktopApplicationDataSet`) 命名为与类型 ( `DesktopApplication.mtdDesktopApplicationDataSet`) 相同的名称——这只会导致潜在的错误。目前尚不清楚（无法重现）这是否是这里的一个因素，但它无济于事......

该字段`mtdDesktopApplicationDataSet`代表什么？可以重命名吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T14:59:12.040

我猜您在命名空间方面遇到了一些问题。如果此代码隐藏文件驻留在`DesktopApplication`命名空间中，并且您在命名空间中还有一个`DesktopApplication`类`DesktopApplication`，您将体验到上述情况。

（基本上它正在查看`DesktopApplication.DesktopApplication`它应该查看的时间`DesktopApplication`。）

尝试清理您的命名空间，使上述不正确，或者使用`global`关键字逃避命名空间地狱：

```
this.mtdDesktopApplicationDataSet = new global::DesktopApplication.mtdDesktopApplicationDataSet(); 
```

# c# - WPF：显示快速变化的图像的更有效方式？

> ID：893324
> 
> 赞同：2
> 
> 时间：2009-05-21T14:49:52.107
> 
> 标签：c#, wpf, image-processing, performance

我正在使用**Image**控件来显示一个 8 位灰度图像，我自己在后台线程上处理该图像。处理完图像后，我将 Image.BitmapSource 属性设置为指向通过**BitmapSource.Create() 创建的新位图。**这一切都很好——直到我必须快速重新处理图像并将其放回屏幕上。

我正在进行的项目要求我能够以 ~15-20 FPS 的速度重新处理和刷新图像。我可以快速将图像发送到 UI - 这不是问题。问题是显示器以令人不快的方式闪烁。我想避免这种情况。

我的项目的 WPF 之前的版本依赖 GDI 来执行此操作，并且能够在没有闪烁的情况下处理它。我宁愿不使用 GDI（或 GDI+）。

有没有更有效的 WPF 方式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:08:42.130

我想问题已经被问过了，[在这里](https://stackoverflow.com/questions/812288/how-to-display-quick-updating-images-without-large-memory-allocation)。

# javascript - JS：body 标签 onload 等效？

> ID：893325
> 
> 赞同：3
> 
> 时间：2009-05-21T14:50:14.477
> 
> 标签：javascript

我需要基本上将其添加到我的页面：

```
<body onload="document.getElementById('WeddingBandBuilder').focus()"> 
```

但是由于我的模板，我无法更改标签。那么有没有办法用 <head> 标签中的脚本或其他东西来做等效的事情？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T14:55:29.520

```
<script>
window.onload = function() {document.getElementById('WeddingBandBuilder').focus()};
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:59:44.373

您应该始终小心没有`window.onload`定义。`<body onload="...">`假设我将是唯一一个将东西附加到or的人，我已经被烧伤了很多次`window.onload`。

有关此问题的解决方案，请参阅[此答案和评论](https://stackoverflow.com/questions/807878/javascript-that-executes-after-page-load/807997#807997)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-21T14:54:14.407

使用 jQuery 或 Prototype 之类的 JS 库并创建一个外部脚本文件，如下所示：

对于 jQuery：

```
$(function() { $('#WeddingBandBuilder').focus(); }); 
```

对于原型：

```
Event.observe(window, 'load', function() { $('WeddingBandBuilder').focus(); }); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-21T14:55:25.527

我可能会检查该页面是否已经包含 jQuery？如果是这样，您可以执行以下操作：

```
$(document).ready(function() {
    $('#WeddingBandBuilder').focus();
}); 
```

# c# - 线程安全的异步字节队列

> ID：893327
> 
> 赞同：4
> 
> 时间：2009-05-21T14:50:26.117
> 
> 标签：c#, multithreading, .net-3.5, queue, producer-consumer

我有一个回调方法，只要有新数据可用就会调用它：

```
public delegate void DataCallback(
    byte[] buffer,
    int offset,
    int count); 
```

我想将它包装在一个实现类似于此的接口的类中：

```
public interface IDataSource
{
    IAsyncResult BeginRead(
        byte[] buffer,
        int offset,
        int size,
        TimeSpan timeout,
        AsyncCallback callback,
        object state);

    int EndRead(
        IAsyncResult asyncResult);

    int Read(
        byte[] buffer,
        int offset,
        int size,
        TimeSpan timeout);
} 
```

这显然是一个经典的生产者-消费者问题：字节是通过调用回调方法产生的，并由 Begin/EndRead 和 Read 方法消耗。如果没有数据可用，Begin/EndRead 和 Read 方法应该阻塞（直到发生超时）。实现应该使用固定大小的内部缓冲区，因此当缓冲区当前已满时，回调方法需要阻塞。

由于考虑多线程通常会导致严重的头痛，所以我的问题是：**是否已经实现了这种数据结构？**

（我认为实现 Read 方法应该很简单，但我想避免使用 Read./ 实现 Begin/EndRead `Begin`。`EndInvoke`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:00:20.307

它必须是异步的`IAsyncResult`吗？我[这里有一个通用的](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)*阻塞*队列（即读者阻塞直到有数据或它被关闭；写入器阻塞直到有空间）；它没有专门针对 进行优化，但只要大小不是很大，它就可以应付——但作为一个阻塞队列，它需要（至少一个）专用的消费者线程，这样做：`byte[]`

```
T val;
while(queue.TryDequeue(out val)) {
    // process val
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T14:59:07.033

我认为您应该在“无锁队列”上进行谷歌搜索。这样我得到了很多有用的命中。

# windows - 确定推荐的系统要求

> ID：893329
> 
> 赞同：6
> 
> 时间：2009-05-21T14:50:36.177
> 
> 标签：windows, system-requirements

我们最近更改了对轻量级应用程序的一些系统要求（它本质上是一个瘦 gui 客户端，连接到运行 IBM UniVerse 的“大型机”）。我们根本没有改变我们的最低要求，而是改变了我们推荐的要求以匹配 Windows 7 和 Vista 的要求（因为我们在这些机器上运行）。

一些系统要求相当容易确定（即：网卡、硬盘空间等...）。但是 CPU 和 RAM 更难确定。

我们当前对 CPU 和 RAM 的最低要求列表都表明您必须满足操作系统的最低要求。这对我们来说似乎相当合理，因为我们的应用程序仅使用 15MB 或活动内存和非常少的 CPU（在这种情况下，它是一个简单的 GUI），因此可以正常工作。这似乎很好，没有人抱怨这一点。

但是，当谈到推荐的要求时，我们在确定具体细节时遇到了麻烦，尤其是现在，当你开始谈论多核处理器、原子处理器等时，说最低 1.6 GHz（或类似的）可能意味着任何事情......瘦客户端开始做更密集的工作（例如，它现在包含一个嵌入式 Web 浏览器，以帮助显示对用户更友好的 html 页面）。

*   确定 CPU 和 RAM 的推荐值的好方法是什么？
*   您是否采用推荐的操作系统并将您的使用值添加到顶部（那么我们是否说 1GB 用于 Vista 机器？）？
*   有更好的方法吗？

（注意：这本质上与[此处](https://stackoverflow.com/questions/379478/whats-the-best-way-to-determine-the-hardware-requirements-for-an-application)的服务器问题相似，但来自应用程序库）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T14:56:20.613

提出一些与响应延迟、吞吐量和启动时间等相关的具体非功能性要求，然后在几台不同的机器上对它们进行基准测试。尝试推断哪些硬件将允许典型用户获得符合您要求的体验。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T17:41:54.960

让我们从另一个角度尝试一下。

首先，在最低配置机器上测试您的应用程序。如果存在瓶颈是什么？

*   它会导致大量磁盘交换吗？如果是这样，您需要更多的 RAM。
*   执行常规操作（不包括内存使用）时通常会很慢，然后增加处理器要求。
*   它是否需要超出应用程序占用空间的磁盘空间，例如用于文件处理？列出来。
*   您的应用程序是否依赖于芯片上的某些指令集？（以 SSE、执行禁用位、英特尔虚拟化等为例）。如果是这样，那么您必须列出哪些处理器将实际与该应用程序一起使用。

通常来说，如果应用程序在使用操作系统的最低配置时运行良好；那么您的“推荐”配置应该与操作系统的推荐配置相同。

归根结底，您可能需要手头有几台机器来进行分析。在这种情况下，虚拟机不是一个好的选择。根据定义，VM 和主机操作系统会产生影响。此外，仅仅因为您可以降低某个处理器的速度，并不意味着它运行在与通常为该级别构建的处理器相似的级别上。

例如，双核 1.8 GHz 处理器被限制为仅使用一个内核，与 P4 1.8 GHz 处理器相比仍然是一个非常不同的野兽。存在架构差异以及 L2 和 L3 缓存更改。

同样，具有 P4 处理器的机器使用的 RAM 类型与具有双核（DDR 与 DDR2）的机器不同。RAM速度确实有影响。

因此，请尝试坚持操作系统建议，因为它们已经为您完成了困难的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T14:58:41.247

要确定 CPU 和 RAM，您可以尝试使用 Microsoft Virtual PC，它允许您设置 CPU 和 RAM 设置。然后，您可以测试一些不同的设置，看看对于普通用户来说什么是足够的。

至于推荐的要求，将它们添加到基本操作系统要求之上可能是安全的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T15:07:46.610

微软在 Vista 中引入了 Windows 体验指数来解决这个确切的问题。

**更新更多信息**

它考虑了整个系统。请记住，他们可能有一个最低级别的处理器，但如果他们有一个垃圾视频卡，那么大量的处理器时间将花费在绘制窗口上......如果你选择一个像 3.0 这样的体面的体验指数，那么你可以合理地保证他们会对您的应用程序有很好的体验。如果您需要更多马力，请将要求提高到 4.0。

一个例子是我用来打字的戴尔。这是一台使用了 2 年的机器，但在体验指数上仍为 4.2。大多数商务舱机器应该能够注册至少一个3；对于您描述的应用程序，这应该足够强大。

顺便说一句，我 5 岁的笔记本电脑注册为 2.0，在我购买它时它是中等水平。

# python - 'with'语句中的多个变量？

> ID：893333
> 
> 赞同：510
> 
> 时间：2009-05-21T14:51:27.487
> 
> 标签：python, with-statement

`with`是否可以在 Python 中使用语句声明多个变量？

就像是：

```
from __future__ import with_statement

with open("out.txt","wt"), open("in.txt") as file_out, file_in:
    for line in file_in:
        file_out.write(line) 
```

...或者是同时清理两个资源的问题？

* * *

## 回答 #1

> 赞同：823
> 
> 时间：2009-07-02T11:25:50.873

[从 v3.1](http://docs.python.org/3.1/reference/compound_stmts.html#with)和 [Python 2.7](http://docs.python.org/dev/whatsnew/2.7.html#other-language-changes)开始，它在 Python 3 中是可能的。新[`with`语法](https://docs.python.org/3/reference/compound_stmts.html#the-with-statement)支持多个上下文管理器：

```
with A() as a, B() as b, C() as c:
    doSomething(a,b,c) 
```

与 不同`contextlib.nested`，这保证`a`了'`b`将`__exit__()`被调用，即使`C()`它的`__enter__()`方法引发了异常。

您还可以在以后的定义中使用较早的变量（下面的 h/t [Ahmad](https://stackoverflow.com/questions/893333/multiple-variables-in-a-with-statement#comment78254813_1073814)）：

```
with A() as a, B(a) as b, C(a, b) as c:
    doSomething(a, c) 
```

从 Python 3.10 开始，[您可以使用括号](https://docs.python.org/3/whatsnew/3.10.html#parenthesized-context-managers)：

```
with (
    A() as a, 
    B(a) as b, 
    C(a, b) as c,
):
    doSomething(a, c) 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2018-06-20T23:32:09.757

请注意，如果将变量拆分为行，在 Python 3.10 之前，您必须使用反斜杠来换行。

```
with A() as a, \
     B() as b, \
     C() as c:
    doSomething(a,b,c) 
```

括号不起作用，因为 Python 会创建一个元组。

```
with (A(),
      B(),
      C()):
    doSomething(a,b,c) 
```

由于元组缺少`__enter__`属性，您会收到错误（无法描述且无法识别类类型）：

> ```
> AttributeError: __enter__ 
> ```

如果您尝试`as`在括号内使用，Python 会在解析时捕获错误：

```
with (A() as a,
      B() as b,
      C() as c):
    doSomething(a,b,c) 
```

> ```
> SyntaxError: invalid syntax 
> ```

## 什么时候会解决这个问题？

此问题在[https://bugs.python.org/issue12782](https://bugs.python.org/issue12782)中进行了跟踪。

Python 在[PEP 617](https://www.python.org/dev/peps/pep-0617/)中宣布他们将用新的解析器替换原来的解析器。因为 Python 的原始解析器是 LL(1)，它[无法区分](https://www.python.org/dev/peps/pep-0617/#some-rules-are-not-actually-ll-1)“多个上下文管理器”`with (A(), B()):`和“值元组” `with (A(), B())[0]:`。

新的解析器可以正确解析被括号包围的多个上下文管理器。新解析器已在 3.9 中启用。据报道，在 Python 3.10 中删除旧的解析器之前，该语法仍将被拒绝，并且此语法更改已在[3.10 发行说明](https://docs.python.org/3/whatsnew/3.10.html)中报告。但在我的测试中，它也适用于 trinket.io 的 Python 3.9.6。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2009-05-21T14:55:42.423

[`contextlib.nested`](http://docs.python.org/2/library/contextlib.html#contextlib.nested)支持这个：

```
import contextlib

with contextlib.nested(open("out.txt","wt"), open("in.txt")) as (file_out, file_in):

   ... 
```

**更新：**
引用文档，关于[`contextlib.nested`](http://docs.python.org/2/library/contextlib.html#contextlib.nested)：

> *2.7 版后已弃用*：with 语句现在直接支持此功能（没有容易混淆的错误倾向）。

有关更多信息，请参阅[Rafał Dowgird 的回答](https://stackoverflow.com/a/1073814/1217270)。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2018-05-10T06:18:05.900

从 Python 3.3 开始，您可以使用模块中的[`ExitStack`](https://docs.python.org/3/library/contextlib.html#contextlib.ExitStack)类[`contextlib`](https://docs.python.org/3/library/contextlib.html#module-contextlib)。

它可以管理*动态*数量的上下文感知对象，这意味着如果您不知道要处理多少文件，它将证明特别有用。

文档中提到的规范用例是管理动态数量的文件。

```
with ExitStack() as stack:
    files = [stack.enter_context(open(fname)) for fname in filenames]
    # All opened files will automatically be closed at the end of
    # the with statement, even if attempts to open files later
    # in the list raise an exception 
```

这是一个通用示例：

```
from contextlib import ExitStack

class X:
    num = 1

    def __init__(self):
        self.num = X.num
        X.num += 1

    def __repr__(self):
        cls = type(self)
        return '{cls.__name__}{self.num}'.format(cls=cls, self=self)

    def __enter__(self):
        print('enter {!r}'.format(self))
        return self.num

    def __exit__(self, exc_type, exc_value, traceback):
        print('exit {!r}'.format(self))
        return True

xs = [X() for _ in range(3)]

with ExitStack() as stack:
    print(stack._exit_callbacks)
    nums = [stack.enter_context(x) for x in xs]
    print(stack._exit_callbacks)
print(stack._exit_callbacks)
print(nums) 
```

输出：

```
deque([])
enter X1
enter X2
enter X3
deque([<function ExitStack._push_cm_exit.<locals>._exit_wrapper at 0x7f5c95f86158>, <function ExitStack._push_cm_exit.<locals>._exit_wrapper at 0x7f5c95f861e0>, <function ExitStack._push_cm_exit.<locals>._exit_wrapper at 0x7f5c95f86268>])
exit X3
exit X2
exit X1
deque([])
[1, 2, 3] 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-05-21T14:55:22.890

我想你想这样做：

```
from __future__ import with_statement

with open("out.txt","wt") as file_out:
    with open("in.txt") as file_in:
        for line in file_in:
            file_out.write(line) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-02-26T15:37:46.390

从 Python 3.10 开始，有一个带[括号的上下文管理器](https://docs.python.org/3.10/whatsnew/3.10.html#parenthesized-context-managers)的新功能，它允许以下语法：

```
with (
    A() as a,
    B() as b
):
    do_something(a, b) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-09-18T14:56:52.157

在 Python 3.1+ 中，您可以指定多个上下文表达式，它们将像`with`嵌套多个语句一样被处理：

```
with A() as a, B() as b:
    suite 
```

相当于

```
with A() as a:
    with B() as b:
        suite 
```

这也意味着您可以在第二个表达式中使用第一个表达式的别名（在使用 db 连接/游标时很有用）：

```
with get_conn() as conn, conn.cursor() as cursor:
    cursor.execute(sql) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-10-21T13:12:43.867

您还可以[将](https://stackoverflow.com/a/39611597)创建上下文管理器（`__init__`方法）和输入上下文（`__enter__`方法）分开来增加可读性。所以不要写这段代码：

```
with Company(name, id) as company, Person(name, age, gender) as person, Vehicle(brand) as vehicle:
    pass 
```

您可以编写以下代码：

```
company = Company(name, id)
person = Person(name, age, gender)
vehicle = Vehicle(brand)

with company, person, vehicle:
    pass 
```

请注意，在语句之外创建上下文管理器`with`给人的印象是创建的对象也可以在语句之外进一步使用。如果您的上下文管理器不是这样，则错误印象可能与可读性尝试相对应。

[文档](https://docs.python.org/3/library/contextlib.html#single-use-reusable-and-reentrant-context-managers)说：

> 大多数上下文管理器的编写方式意味着它们只能在 with 语句中有效使用一次。这些一次性上下文管理器必须在每次使用时重新创建 - 尝试再次使用它们将触发异常或无法正常工作。
> 
> 这种常见的限制意味着通常建议直接在使用它们的 with 语句的标题中创建上下文管理器。

# opensso - OpenSSO 权利

> ID：893334
> 
> 赞同：1
> 
> 时间：2009-05-21T14:51:33.400
> 
> 标签：opensso

OpenSSO 的路线图表示权利将在 09 年夏天结束。任何人都知道它是否能够解决数据级别的安全问题，例如“userA 只能在屏幕上的此字段中输入 <500”或“UserA 只能在下拉列表中看到这些值”。
这是如何在组织中实现的，每个应用程序都控制数据级别的安全性，或者是否有一些人拥有一个企业存储库。
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T17:45:28.110

是的，这正是 OpenSSO 权利旨在解决的问题。上周我在 JavaOne 做了一个演示，展示了一个演示手机帐户管理系统，其中包含三个策略：

1.  每个电话用户都可以阅读他们自己的权限（例如可以下载音乐/视频）和通话记录。
2.  账户持有人可以读写账户上所有电话的权限，可以查看账户上所有电话的通话记录。
3.  帐户持有人可以读取和写入帐户范围的数据（例如帐单地址）。

[我会将源代码发布到演示中，并在我的博客](http://blogs.oracle.com/superpat/)上解释如何部署它。

为了回答您问题的第二部分，有一个企业策略存储库，但它是在逐个应用程序的基础上强制执行的。在演示中，大多数强制执行由 servlet 过滤器完成，该过滤器对每个请求的 URL 进行权利调用。这很有效，因为我们使用 RESTful Web 服务在 URL 中表达所请求的资源。有一次，我们进行了明确的策略调用，因为 URL 模式与策略不对应 - 客户端可以通过电话 URL 导航到帐户资源。我希望我可以构建另一个策略来处理这个问题，但我实际上想显示一个明确的权利调用。

# wcf - 具有 netTcpBinding 和证书传输安全性的 WCF

> ID：893336
> 
> 赞同：3
> 
> 时间：2009-05-21T14:51:55.567
> 
> 标签：wcf, certificate, nettcpbinding

我需要保护使用 netTcpBinding 并直接与基于 Windows 窗体的应用程序连接的 WCF 服务。我只需要在传输层保护它。

我很确定我让它在本地工作，即我可以在本地运行该服务，并与客户端连接到它。

当我尝试设置服务以使其在服务器而不是本地计算机上运行时，我遇到了证书问题。错误日志表明证书必须具有能够进行密钥交换的私钥，并且该进程必须具有对私钥的访问权限。

我正在使用使用 makecert 创建的开发证书。

```
makecert -n "CN=MY COMPANY DEBUG" -pe -sky exchange Debug.cer 
```

我必须承认我对使用证书很陌生。有没有人对我如何解决这个问题有任何指示，或者有更好的方法来使用证书向使用 netTcpBinding 的 WCF 服务添加传输安全性？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T15:01:51.443

尝试这个：

```
makecert -n "CN=MY COMPANY DEBUG" -pe -sky exchange Debug.cer -sv Debug.pvk
pvk2pfx -pvk Debug.pvk -spc Debug.cer -pfx Debug.pfx 
```

然后您将得到三个文件，.cer 文件（公钥）、.pvk（私钥）和 .pfx（与两者交换密钥）。然后，您可以像这样在服务器上安装 .pfx 文件：

```
certutil -p "" -importPFX Certificates\Debug.pfx 
```

在客户端，您只需要安装 .cer 文件。这些安装（上面的 .cer 和 .pfx）您也可以通过证书 MMC 管理单元（开始、运行、MMC.exe，然后为当前计算机添加证书管理单元）来完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:00:10.137

阅读[此](http://www.codeproject.com/KB/WCF/WCFSSL.aspx)（涵盖 https 案例，但仍可能有所帮助）和[此](http://msdn.microsoft.com/en-us/library/ms733791.aspx).

由于我们谈论的是传输级安全性，我认为您的服务器进程不应该知道您用来提供它的证书的任何信息。

# java - 为什么不推荐使用struts2 FilterDispatcher？

> ID：893337
> 
> 赞同：0
> 
> 时间：2009-05-21T14:52:28.670
> 
> 标签：java, struts2

在 API 文档中我发现了这个

从 Struts 2.1.3 开始，使用 StrutsPrepareAndExecuteFilter 代替，或者如果需要使用 ActionContextCleanUp 过滤器，则使用 StrutsPrepareFilter 和 StrutsExecuteFilter。

为什么 ？据我所知，StrutsPrepareAndExecuteFilter 在 I18n 中有一些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:06:25.693

www.nabble.com/-s2--New-filter-strategy-RFC-to18045478.html#a18045478

基本上，较旧的过滤器设置令人困惑并导致问题。新的设置也是面向 OSGi 插件的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:48:28.183

*   让用户清楚地知道如何部署 Struts
*   让开发人员清楚地知道哪些过滤器正在执行哪些流程
*   更好地启用高级用户的自定义和覆盖

# java - 非法 XML 字符 /Axis

> ID：893339
> 
> 赞同：5
> 
> 时间：2009-05-21T14:52:56.063
> 
> 标签：java, service, axis

我开发了一个 Web 服务并使用 Axis 部署它。一切都运行得很好，但是当我使用包含不可打印字符（例如 ETX、FS、..）的字符串使用服务时遇到问题。我有以下错误：

```
exception: java.lang.IllegalArgumentException: The char '0x1c' after '....' is not a valid XML character. 
```

请问你有什么想法吗？

编辑 ：

我必须使用 Web 服务向我的服务器发送一个帧。我的框架有一个严格的形式（包含一些不可打印的字符作为分隔符）

```
class Automate {void checkFrame(String frame){// checking the frame}} 
```

wsdl 文件

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
 <wsdl:part element="impl:checkFrameResponse" name="parameters"/> 
```

```
 <wsdl:part element="impl:checkFrame" name="parameters"/> 
```

```
 <wsdl:operation name="checkFrame">

     <wsdl:input message="impl:checkFrameRequest" name="checkFrameRequest"/>

     <wsdl:output message="impl:checkFrameResponse" name="checkFrameResponse"/>

  </wsdl:operation> 
```

```
 <wsdlsoap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>

  <wsdl:operation name="checkFrame">

     <wsdlsoap:operation soapAction=""/>

     <wsdl:input name="checkFrameRequest">

        <wsdlsoap:body use="literal"/>

     </wsdl:input>

     <wsdl:output name="checkFrameResponse">

        <wsdlsoap:body use="literal"/>

     </wsdl:output>

  </wsdl:operation> 
```

```
 <wsdl:port binding="impl:AutomateSoapBinding" name="Automate">

     <wsdlsoap:address location="http://localhost:8080/Gateway/services/Automate"/>

  </wsdl:port> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T15:01:38.667

不幸的是，这是 SOAP 的一个自然问题 - 它使用 XML 作为文本，而这些字符不能用 XML 表示（即使是实体）。

你能以某种方式逃避不可打印的字符吗？不幸的是，您需要找到一些不将它们表示为直接文本的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T03:14:19.280

当您形成要塞入 SOAP XML 信封的 XML 时，您需要确保在属性值和元素中的任何文本节点中没有任何未转义的字符。那是：

```
<your_elt your_attr="Don&apos;t put unescaped chars here, eg, apostrophe">
    <foo>
        Be sure to escape stuff here too, like: 2 &lt; 100
        A greek lambda is escaped like this: &#955;
    </foo>
</your_elt> 
```

我假设您在 Java 中执行此操作，因此您应该查看自动为您执行此操作的库。例如， Apache 有[StringEscapeUtils](http://commons.apache.org/lang/api-2.1/org/apache/commons/lang/StringEscapeUtils.html)。

您的控制字符需要通过 XML[数字字符引用](http://en.wikipedia.org/wiki/Character_encodings_in_HTML)进行转义。希望 StringEscapeUtils 为您处理。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-05T20:46:14.353

将 CDATA 用于不属于 xml 结构（即内容）的数据，如果我理解正确并且您只是在路由消息，那么您应该这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:52:09.923

听起来您的文本不可能用 XML 表示。您将不得不转义这些字符，但老实说，我怀疑您应该“转义”整个字符串。Base64 编码字符串可能有效，但您也可以查看 MTOM 或其他一些跨 Web 服务传递二进制数据的机制。

如果您拥有该系统的双方（客户端和 Web 服务），那么添加编码/解码步骤应该不会太难，并且 base64 编码应该足够了。

# javascript - Javascript中的繁忙指标竞争条件

> ID：893348
> 
> 赞同：2
> 
> 时间：2009-05-21T14:54:27.747
> 
> 标签：javascript, jquery, race-condition

我有以下（javascript/jquery）代码在加载图像时显示繁忙指示器（延迟后）：

```
function imgUpdate(arg) {
    var loaded = false;

    $("#image").one("load", function(){
        loaded = true;
        $("#busyIndicator").hide();
    });

    setTimeout(function(){
        if (!loaded) {
            $("#busyIndicator").show();
        }
    }, 250);

    $("#image")[0].src = arg;
} 
```

有时，指标会出现并保持不变。如果浏览器的 javascript 引擎是单线程的，这怎么可能？（顺便说一下，这是在 Firefox 3 上。）

注意：这似乎发生在正在加载的图像已经缓存时。

另一个注意事项：如果我登录到我的 firebug 控制台，imgUpdate 中的所有行都会执行，但 onload 处理程序中的日志消息永远不会在后续调用 imgUpdate 时打印。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:00:40.820

我很难复制这一点。

这是您正在执行的操作的实现：

使用缓存的版本：http: [//jsbin.com/uwuho](http://jsbin.com/uwuho)

阻止缓存的版本：（使用参数避免缓存） [http://jsbin.com/oguvi](http://jsbin.com/oguvi)

按 F5/Ctrl-F5 看它。（尤其是防止缓存的版本）

无论有没有缓存，这两个版本都没有按照您的描述进行。

您的问题*可能*出在其他地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T15:02:01.537

页面上是否有任何其他 javascript 中断？如果是这样，这可能不是竞争条件——JS 可以在busyIndi​​cator 再次隐藏之前停止执行......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T15:46:12.493

清除图像的 src 标签似乎可以解决问题：

```
function imgUpdate(arg) {
    var loaded = false;

    $("#image").one("load", function(){
        loaded = true;
        $("#busyIndicator").hide();
    });

    setTimeout(function(){
        if (!loaded) {
            $("#busyIndicator").show();
        }
    }, 250);

    $("#image")[0].src = "";
    $("#image")[0].src = arg;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:09:09.900

您可能希望清除回调中的超时，以便在加载图像时不会触发。

```
var timer = null;
function imgUpdate(arg) {
    var loaded = false;
    timer = setTimeout(function(){ 
        $("#busyIndicator").show();
        timer = null;
    }, 250);        
    $("#image").one("load", function(){
        if (timer) {
            clearTimeout(timer);
            timer = null;
        }
        $("#busyIndicator").hide();
    });
    $("#image")[0].src = arg;
} 
```

# java - 蚂蚁脚本示例

> ID：893371
> 
> 赞同：1
> 
> 时间：2009-05-21T14:58:07.817
> 
> 标签：java, eclipse, ant, jar

我想做一个非常简单的 ant 脚本来做一件事，那就是构建一个 jar 文件。但是当我尝试使用一个非常简单的示例时，由于依赖于我的源所依赖的 jar，它会失败。因此，在构建 Ant 目标时，您如何指定 jars 需要在类路径中。

```
<project name="project" default="default">
<property name="src.dir"     value="src"/>
<property name="build.dir"   value="build"/>
<property name="classes.dir" value="${build.dir}/classes"/>
<property name="jar.dir"     value="${build.dir}/jar"/>
<property name="lib.dir"     value="//tomcat/common/lib"/>
<description> description </description>

<!-- ================================= 
      target: default              
     ================================= -->
<target name="default" depends="compile" description="description">
    <jar destfile="/path/to/dir/Library.jar">

    </jar>
</target>
  <target name="compile">
        <mkdir dir="${classes.dir}"/>
        <javac srcdir="${src.dir}" destdir="${classes.dir}"/>
    </target>

</project> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T15:09:59.930

你的问题并不完全清楚 - 我怀疑你的意思是你想编译你的源代码（带有`javac`任务），*然后*从结果中构建一个 jar 文件。如果不是这种情况，我看不出你的源依赖关系在哪里。如果*是*这样，那么`jar`任务就无关紧要了。

在[`javac`](http://ant.apache.org/manual/Tasks/javac.html)任务中，使用 classpath 属性指定其他 jar 依赖项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T15:11:53.263

这是使用 Eclipse Runnable JAR Export Wizard 生成的 ANT 脚本。这是一个与一些朋友一起更新小型梦幻棒球联盟的 Google 电子表格上的统计数据的项目。它通过抓取 ESPN.com 播放器页面来获取统计信息。

元素内部的 Class-Path 属性`manifest`用于设置 jar 使用的类路径。这是默认的“。” 但我必须明确添加我的 src 路径，以便 log4j 可以获取 log4j.properties。

`zipfileset`元素是我希望包含在我的 jar 中的源使用的外部 jar。我怀疑这可能是你正在寻找的。

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jar" name="Create Runnable Jar for Project cob_fantasy_baseball">
    <!--this file was created by Eclipse Runnable JAR Export Wizard-->
    <!--ANT 1.7 is required                                        -->
    <target name="create_run_jar">
        <jar destfile="C:/workspace/cob_fantasy_baseball/cob_fantasy_baseball.jar" filesetmanifest="mergewithoutmain">
            <manifest>
                <attribute name="Built-By" value="${user.name}"/>
                <attribute name="Main-Class" value="com.me.cob_fantasy_baseball.UpdateCobStats"/>
                <attribute name="Class-Path" value=".;src/com/me/cob_fantasy_baseball"/>
            </manifest>
            <fileset dir="C:/workspace/cob_fantasy_baseball/classes"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/gdata/java/lib/gdata-core-1.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/gdata/java/lib/gdata-spreadsheet-2.0.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/jericho-html-2.6/lib/jericho-html-2.6.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/apache-log4j-1.2.15/log4j-1.2.15.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/jaf-1.1.1/activation.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/javamail-1.4.2/mail.jar"/>
            <zipfileset excludes="META-INF/*.SF" src="C:/workspace/javamail-1.4.2/lib/smtp.jar"/>
            <fileset dir="C:/workspace/cob_fantasy_baseball/src/com/me/cob_fantasy_baseball"/>
        </jar>
    </target>
</project> 
```

此外，这里是 jar 任务的 Ant 文档的链接：http: [//ant.apache.org/manual/Tasks/jar.html](http://ant.apache.org/manual/Tasks/jar.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T15:18:00.880

根据您的示例，您可以将库放在 javac 中：

```
<javac srcdir="${src.dir}" destdir="${classes.dir}">
    <classpath>
        <pathelement location="${lib.dir}/lib1.jar"/>
        <pathelement location="${lib.dir}/lib2.jar"/>
    </classpath>
</javac> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:04:30.893

这是我们用来构建 Timeline 开源项目的 ant 文件。这很简单。它不构建 jar，但确实使用库来最小化 JS 文件。

[http://simile-widgets.googlecode.com/svn/timeline/trunk/build.xml](http://simile-widgets.googlecode.com/svn/timeline/trunk/build.xml)

拉里

# asp.net - 特定网页的总选择语句数？

> ID：893372
> 
> 赞同：1
> 
> 时间：2009-05-21T14:58:13.697
> 
> 标签：asp.net, sql-server, ado.net

我想知道 从我的 ASP.Net (.NET 2.0) 应用程序中查看**数据库查询总数的最简单方法是什么。**

我的应用程序大量使用 sql 2005 数据库，因为所有数据都是动态的，并且所有内容都通过 web.config 中的一个连接字符串。那里启用了连接池。

所以，我想知道我在浏览器中加载的特定页面**执行了多少选择语句。**

我不在乎是否可以从 .net 端或 db 端看到该信息，只要我只能看到与我的数据库的连接。并非所有与该数据库服务器的连接，因为我使用共享数据库服务器并且还有很多其他数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:10:02.660

最好的方法是[在您的数据库上设置一个探查器](http://sqlprofiler.googlepages.com/)，然后向您的 ASP.NET 应用程序发出一个请求。探查器将聚合您希望的任何数据，您将能够使用该数据来确定从您的应用程序发送到 SQL Server 的查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T15:10:33.813

SQL Server Profiler 将列出对您的数据库执行的所有操作。如果您为您的项目使用不同的数据库登录名（如果您不使用，这可能是一个非常好的主意），您可以进行过滤，使其仅显示您登录时的操作（请参阅事件选择、列过滤器和登录名）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:09:58.510

使用 SQL 事件探查器。您可以将其配置为按您想要的数据库过滤并仅显示选择语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:10:54.920

如果您的代码中有某种数据库层，您可以修改它以在每次运行 select 语句时写出一条日志消息。然后只需加载一次页面并计算日志语句的数量。这可能有效，也可能无效，具体取决于您的代码的结构，但这是一种选择。

编辑：我误读了这个问题。我以为您有多个客户端连接到同一个数据库，而不是同一个数据库服务器。在这种情况下，分析器可能是最佳选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T15:12:40.157

您是否有权访问 SQL Server Profiler？您可以通过加载页面并查看分析器中的效果来设置跟踪以监视此类事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T16:38:48.970

请注意 Profiler 会影响性能，因此最好在 dev 上执行此操作。

# jakarta-ee - WebLogic“MDB 应用程序未连接到消息传递系统”

> ID：893373
> 
> 赞同：3
> 
> 时间：2009-05-21T14:58:29.187
> 
> 标签：jakarta-ee, weblogic, portal

我们有一个在 WebLogic Portal 10.2 上运行的 J2EE/门户应用程序。我们最近引入了一个异步 EJB 调用，但是在将它投入生产之后，我们收到一条错误消息，上面写着

> MDB 应用程序*XXX*未连接到消息传递系统

这是一个编码问题，可以通过运行时参数进行调整，还是我们可以忽略的问题？（或者我没有想到的第四个选项？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-02-09T16:04:59.773

这也可能来自消息传递子系统的启动问题。这通常是由持久性存储问题引起的。如果您使用管理控制台查看 Services->Messaging->JMS 服务器，您可以看到 JMS 服务器的状态。如果它们不“正常”，则说明出了点问题，需要进行故障排除......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-22T18:50:25.907

当您的 MDB 无法查找外部目标时，通常会发生此错误。如果您使用的是外部消息传递提供程序，则类路径中可能缺少客户端 jar。

或者，JNDI 查找本身可能存在问题。您可以通过查看 JNDI 树并确保您正在查找的对象已绑定来验证这一点。

# tfs - 源代码管理资源管理器的上下文菜单上没有可用的命令

> ID：893376
> 
> 赞同：2
> 
> 时间：2009-05-21T14:58:58.063
> 
> 标签：tfs

我不知道我做了什么，但是在我的 TFS 源代码控制资源管理器中，上下文菜单上有“没有可用的命令”！（恐慌正在酝酿中）

从团队资源管理器中，我可以看到他是 Team Foundation 管理员的成员，我也是团队项目管理员的成员。

什么会导致 TFS 在弹出的上下文菜单上给出“没有可用的命令”？

附加信息：我可以访问源代码控制浏览器并使用另一台机器的附加命令，所以也许这是我的设置中的一些东西（尽管它在一小时前工作！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:25:55.827

在 Visual Studio 中，转到工具 > 选项... 单击树中的“源代码管理” 选择“Visual Studio Team Foundation Server”作为当前源代码管理插件。

如果此选项不可用，请确保您已安装 Team Foundation Client。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-24T10:27:48.097

在右键单击您错过的上下文菜单之前，您需要将这些文件/文件夹签出（映射不足以移动和重命名 - 为此您必须签出）到本地磁盘。我遇到了同样的问题，从[MSDN 官方页面上](https://www.visualstudio.com/en-us/docs/tfvc/rename-move-files-folders)我并没有太聪明:)

无论如何，我想知道有什么好的理由，你不能在 TFS 服务器存储库中移动文件而不将这些项目检出到我的磁盘。在 SVN 中，这没有问题。（SVN 中甚至没有路径映射——只有 CheckOut :)

# iis-7 - 基于主机头的转发

> ID：893382
> 
> 赞同：1
> 
> 时间：2009-05-21T14:59:32.400
> 
> 标签：iis-7, proxy, hostheader

我正在尝试解决 1 个 IP 地址的 ISP 限制。这是我想要做的。我的网络上有两台网络服务器在内部运行。一个是运行 4 或 5 个站点的主 IIS 框，我刚刚添加了一个 Windows 主服务器。我为它创建了一个名为 home.mydomain.com 的 dns 条目，另一台服务器响应 www.mydomain.com。

我的路由器设置为将 80 转发到 www.mydomain.com 的服务器（192.168.1.3），因此当对 home.mydomain.com 的请求进入时，请求失败，因为 www 服务器未设置为侦听该主机标头。

我想知道 IIS 7 是否有办法“代理”对 home.mydomain.com (192.168.1.4) 的请求。我曾尝试在 IIS 中设置 HttpRedirect，但这并没有像我希望的那样工作，因为它向客户端发送了一个 302，其名称指向主 IP 地址，然后发生了恶性重定向循环。

我在apache中被告知这可以通过为另一个服务器代理来完成。这可以在 IIS 7 中完成吗？如果没有，有人知道我可以使用的网络服务器代理类型的软件吗？

提前致谢，

富有的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:04:18.613

您正在寻找的是“反向代理”。在 Apache 中，您可以通过 mod_proxy 执行此操作。在 IIS 中，您需要尝试[应用程序请求路由](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1712)包。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-07-30T22:50:52.287

[IIS 的URL 重写](http://www.iis.net/download/URLRewrite)也可用于进行反向代理。

另一个反向代理包是[Managed Fusion URL Rewriter and Reverse Proxy](http://urlrewriter.codeplex.com/)

# asp.net - UpdatePanel 中的“预览区域”不刷新

> ID：893383
> 
> 赞同：0
> 
> 时间：2009-05-21T14:59:53.383
> 
> 标签：asp.net, asp.net-ajax, updatepanel

问候！

我有一个“代码生成器”页面，用户可以在其中选择各种单选按钮并生成 HTML 标记（主要是 SCRIPT 标记），他们可以在页面上使用这些标记来显示一些数据。还有一个“预览”区域，因此他们可以在将代码复制/粘贴到他们的站点之前查看结果。表单存在于 FormView 控件中，并由 UpdatePanel 包装，如下所示：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>
        <asp:FormView ID="FormView1" runat="server" DataSourceId="XmlDataSource1">
            <ItemTemplate>
                <div id="configArea">
                    <ul>
                        <li>
                            <%# XPath("Steps/Step1/ServerStatus") %><br />
                            <asp:RadioButton ID="RadioButton1" runat="server" GroupName="OneA" Checked="true" AutoPostBack="true" Text='<%# XPath("Steps/Step1/YesOption") %>' />
                            <asp:RadioButton ID="RadioButton2" runat="server" GroupName="OneA" AutoPostBack="true" Text='<%# XPath("Steps/Step1/NoOption") %>' />
                        </li>
                        <li>
                            <%# XPath("Steps/Step1/Uptime") %><br />
                            <asp:RadioButton ID="RadioButton3" runat="server" GroupName="OneB" Checked="true" AutoPostBack="true" Text='<%# XPath("Steps/Step1/YesOption") %>' />
                            <asp:RadioButton ID="RadioButton4" runat="server" GroupName="OneB" AutoPostBack="true" Text='<%# XPath("Steps/Step1/NoOption") %>' />
                        </li>
                        <li>
                            <%# XPath("Steps/Step1/IPAddress") %><br />
                            <asp:RadioButton ID="RadioButton5" runat="server" GroupName="OneC" Checked="true" AutoPostBack="true" Text='<%# XPath("Steps/Step1/YesOption") %>' />
                            <asp:RadioButton ID="RadioButton6" runat="server" GroupName="OneC" AutoPostBack="true" Text='<%# XPath("Steps/Step1/NoOption") %>' />
                        </li>
                    </ul>
                </div>
                <div id="copyCode">
                    <%# XPath("Steps/Step2/CopyPasteCode") %><br />
                    <asp:TextBox ID="Textbox1" runat="server" TextMode="MultiLine" Width="300" Height="300" />
                </div>
                <div id="previewArea">
                    <%# XPath("Steps/Step3/PreviewTitle") %><br />
                    <asp:Literal ID="Literal1" runat="server" />
                </div>
            </ItemTemplate>
        </asp:FormView>
    </ContentTemplate>
</asp:UpdatePanel>
<asp:XmlDataSource ID="XmlDataSource1" runat="server" XPath="Root/Data" /> 
```

它成功生成了copycode TextBox (TextBox1) 中的代码，可能看起来像这样：

```
<script src="http://example.com/src/Constants.js"></script>
<script>
    showIPAddress = 0;
    DisplayServerStatus();
</script> 
```

同时，我使用复制代码 TextBox (TextBox1) 中的文本更新“预览”区域的 Literal 控件 (Literal1)。预览在不在 UpdatePanel 内时完美显示，但在它内时不起作用（我更喜欢使用 UpdatePanel 来防止页面刷新）。我在 PreRender 事件期间更新“预览”区域和复制代码文本：

```
protected override void OnPreRender(EventArgs e)
{
    base.OnPreRender(e);

    UpdateCodeSnippetAndPreviewArea();
} 
```

任何想法为什么预览在 UpdatePanel 中时不更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T15:12:07.507

使用 UpdatePanel 时它不更新的原因是 ASP .NET AJAX 框架不处理服务器返回的任何内联 javascript。查看在服务器端使用[ScriptManager.RegisterStartUpScript](http://www.asp.net/Ajax/Documentation/Live/mref/M_System_Web_UI_ScriptManager_RegisterStartupScript_5_0feb167c.aspx)方法来注册内联 javascript 的执行。本质上，一旦面板更新，您可以使用此方法启动自定义 javascript 的执行。在您的情况下，您的自定义 javascript 需要适当地解释预览脚本（即检测脚本标签，动态注册它们然后执行给定的函数）。

希望这可以帮助！

罗兰

# javascript - 为焦点创建事件观察器？

> ID：893387
> 
> 赞同：22
> 
> 时间：2009-05-21T15:00:27.797
> 
> 标签：javascript, prototypejs

是否有可能在原型中出现焦点事件？

我试图避免必须在每个输入元素上分配一个观察者。

```
<script language="javascript" type="text/javascript">
document.observe('dom:loaded', function() {

    // Doesn't work
    $('editForm').observe('focus', function(evnt){
        console.log('FOCUS!');
    });

    // Works
    $('editForm').select('INPUT').each(function(elem) {
        elem.observe('focus', function(evnt){
            console.log('FOCUS!');
        });
    });

}); 
</script>

<form method="post" name="editForm" id="editForm" action="">
<input type="text" name="foobar" />
</form> 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-21T15:16:00.993

焦点和模糊事件不会冒泡。

您可以在捕获阶段触发事件处理程序。当使用标准 DOM 方法时，你会写

```
document.addEventListener('focus',function(e){/*some code */}, true); 
```

'true' 值在这里是最重要的。

问题是 IE 不支持事件传播的捕获阶段，但对于 IE，您可以使用 focusin 和 focusout 事件，这与 focus 和 blur 事件不同 - 会冒泡。我建议阅读由 Peter Paul Koch 撰写的关于此主题的[文章。](http://www.quirksmode.org/blog/archives/2008/04/delegating_the.html)其他浏览器（Firefox、Opera、Safari）可能（我没有测试过）支持 DOMFocusIn、DOMFocusOut 等事件，它们相当于 IE 的 focusin 和 focusout 事件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-13T13:31:44.203

你可以使用这个：

```
function focusInHandler(event){
    Event.element(event).fire("focus:in");
}
function focusOutHandler(event){
    Event.element(event).fire("focus:out");
}

if (document.addEventListener){
    document.addEventListener("focus", focusInHandler, true);
    document.addEventListener("blur", focusOutHandler, true);
} else {
    document.observe("focusin", focusInHandler);
    document.observe("focusout", focusOutHandler);
}

document.observe('focus:in', function(event) {
    // Your code
}); 
```

My jsFiddle : [http://jsfiddle.net/EpokK/k7RPE/3/](http://jsfiddle.net/EpokK/k7RPE/3/)

# visual-studio - 在 Visual Studio 中取消停靠代码窗口

> ID：893388
> 
> 赞同：2
> 
> 时间：2009-05-21T15:00:39.590
> 
> 标签：visual-studio

我终于加入了 21 世纪并获得了第二台显示器。我可以愉快地取消停靠所有侧窗（解决方案资源管理器、工具箱等），然后在任一显示器上随意放置它们。我不知道如何取消停靠代码窗口。是否可以？（我使用的是 vs2008）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:03:17.617

正如许多开发人员所要求的那样，多显示器是新的 vs 2010 的一个关键功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-06T10:55:10.043

实际上有一种方法可以做到这一点。
您只需要从 Exact Magic 安装一个名为[StudioTools](http://www.exactmagic.com/products/studiotools/index.html)
的免费插件， 它有一个名为“Tear Off Editor Window”的功能。
您只需激活要撕下的选项卡，然后从 StudioTools 菜单中选择 Tear Off Editor。

我还强烈建议您查看其余功能，尤其是震撼的“Smart Goto”！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:07:46.517

[只为你](http://marcgravell.blogspot.com/2009/05/multi-monitor-bliss.html)（VS2010）;-p

![多显示器幸福](https://lh5.ggpht.com/_feJtUp7IGuI/ShVuDHT__oI/AAAAAAAAAIw/jxd0y4dCYFA/image_thumb%5B1%5D.png?imgmax=800)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T12:31:59.020

您可以调整 Visual Studio 的大小以覆盖两个监视器，然后右键单击代码窗口并单击新建垂直选项卡组

# python - Python doctest 在 0.0 上失败！= -0.0——什么给出了？

> ID：893398
> 
> 赞同：2
> 
> 时间：2009-05-21T15:01:39.867
> 
> 标签：python

给定以下代码：

```
def slope(x1, y1, x2, y2):
    """
      >>> slope(5, 3, 4, 2)
      1.0
      >>> slope(1, 2, 3, 2)
      0.0
      >>> slope(1, 2, 3, 3)
      0.5
      >>> slope(2, 4, 1, 2)
      2.0
    """
    xa = float (x1)
    xb = float (x2)
    ya = float (y1)
    yb = float (y2)
    return (ya-yb)/(xa-xb)

if name_ == '__main__':
    import doctest
    doctest.testmod() 
```

第二个 doctest 失败：

```
Failed example:
    slope(1, 2, 3, 2)
Expected:
    0.0
Got:
    -0.0 
```

但是，我们都知道-0.0 == 0.0。doctest 是否在此处进行字符串比较以检查结果？为什么第二次测试失败？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T15:04:23.013

它失败了，因为[doctest](http://docs.python.org/3.0/library/doctest.html)*进行字符串比较*。它仅检查输出是否与在 Python 交互式解释器中执行代码时的输出相同：

```
>>> 0 / -2
-0.0 
```

**编辑: : 下面**[Daniel Lew](https://stackoverflow.com/users/60261/daniel-lew)[引用](http://docs.python.org/library/doctest.html#doctest.OutputChecker.check_output)的链接给出了更多关于它是如何工作的提示，以及你如何能够影响这种行为。

# ms-access - MS Access 的图表插件模块

> ID：893404
> 
> 赞同：1
> 
> 时间：2009-05-21T15:03:08.070
> 
> 标签：ms-access, plugins, charts

我在使用内置 Access 图表时遇到问题，[请参阅此问题](https://stackoverflow.com/questions/888184/)。现在我正在寻找 Access 插件的 MSCharts 的替代品。我在谷歌上的最初搜索只发现了噪音。

它不必是开源的，它可以花费真钱。

# python - Python中的项目频率计数

> ID：893417
> 
> 赞同：67
> 
> 时间：2009-05-21T15:04:36.210
> 
> 标签：python, count, frequency, counting

假设我有一个单词列表，并且我想找到每个单词在该列表中出现的次数。

一个明显的方法是：

```
words = "apple banana apple strawberry banana lemon"
uniques = set(words.split())
freqs = [(item, words.split().count(item)) for item in uniques]
print(freqs) 
```

但我觉得这段代码不是很好，因为程序运行了两次单词列表，一次是构建集合，第二次是计算出现次数。

当然，我可以编写一个函数来遍历列表并进行计数，但这不会像 Python 那样。那么，有没有更高效和 Pythonic 的方式呢？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-05-21T15:16:59.447

模块中的[`Counter`类](http://docs.python.org/library/collections.html#collections.Counter)`collections`是专门为解决此类问题而构建的：

```
from collections import Counter
words = "apple banana apple strawberry banana lemon"
Counter(words.split())
# Counter({'apple': 2, 'banana': 2, 'strawberry': 1, 'lemon': 1}) 
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2009-05-21T15:10:59.647

[defaultdict](http://docs.python.org/library/collections.html#defaultdict-objects)来救援！

```
from collections import defaultdict

words = "apple banana apple strawberry banana lemon"

d = defaultdict(int)
for word in words.split():
    d[word] += 1 
```

这在 O(n) 中运行。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-11T20:21:44.627

```
freqs = {}
for word in words:
    freqs[word] = freqs.get(word, 0) + 1 # fetch and increment OR initialize 
```

我认为这与 Triptych 的解决方案相同，但没有导入集合。也有点像 Selinap 的解决方案，但更易读恕我直言。几乎与 Thomas Weigel 的解决方案相同，但没有使用异常。

但是，这可能比使用集合库中的 defaultdict() 慢。由于该值被获取，递增然后再次分配。而不是仅仅增加。但是使用 += 可能在内部做同样的事情。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-21T15:11:47.257

标准方法：

```
from collections import defaultdict

words = "apple banana apple strawberry banana lemon"
words = words.split()
result = defaultdict(int)
for word in words:
    result[word] += 1

print result 
```

Groupby oneliner：

```
from itertools import groupby

words = "apple banana apple strawberry banana lemon"
words = words.split()

result = dict((key, len(list(group))) for key, group in groupby(sorted(words)))
print result 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-21T15:09:57.370

如果您不想使用标准字典方法（循环通过列表递增正确的 dict.key），您可以试试这个：

```
>>> from itertools import groupby
>>> myList = words.split() # ['apple', 'banana', 'apple', 'strawberry', 'banana', 'lemon']
>>> [(k, len(list(g))) for k, g in groupby(sorted(myList))]
[('apple', 2), ('banana', 2), ('lemon', 1), ('strawberry', 1)] 
```

它在 O(n log n) 时间内运行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-21T15:59:30.047

没有默认字典：

```
words = "apple banana apple strawberry banana lemon"
my_count = {}
for word in words.split():
    try: my_count[word] += 1
    except KeyError: my_count[word] = 1 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-08-07T07:10:09.713

```
user_input = list(input().split(' '))

for word in user_input:

    print('{} {}'.format(word, user_input.count(word))) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-12T16:17:28.383

```
words = "apple banana apple strawberry banana lemon"
w=words.split()
e=list(set(w))       
word_freqs = {}
for i in e:
    word_freqs[i]=w.count(i)
print(word_freqs) 
```

希望这可以帮助！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-04-07T05:36:08.643

你不能只使用计数吗？

```
words = 'the quick brown fox jumps over the lazy gray dog'
words.count('z')
#output: 1 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-26T06:02:07.303

我碰巧做了一些 Spark 练习，这是我的解决方案。

```
tokens = ['quick', 'brown', 'fox', 'jumps', 'lazy', 'dog']

print {n: float(tokens.count(n))/float(len(tokens)) for n in tokens} 
```

**#以上输出**

```
{'brown': 0.16666666666666666, 'lazy': 0.16666666666666666, 'jumps': 0.16666666666666666, 'fox': 0.16666666666666666, 'dog': 0.16666666666666666, 'quick': 0.16666666666666666} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-23T18:03:45.900

使用 reduce() 将列表转换为单个字典。

```
from functools import reduce

words = "apple banana apple strawberry banana lemon"
reduce( lambda d, c: d.update([(c, d.get(c,0)+1)]) or d, words.split(), {}) 
```

返回

```
{'strawberry': 1, 'lemon': 1, 'apple': 2, 'banana': 2} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-11T01:11:02.803

```
list = input()  # Providing user input passes multiple tests
text = list.split()

for word in text:
    freq = text.count(word) 
    print(word, freq) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-02-27T02:17:20.163

**下面的答案需要一些额外的周期，但它是另一种方法**

```
def func(tup):
    return tup[-1]

def print_words(filename):
    f = open("small.txt",'r')
    whole_content = (f.read()).lower()
    print whole_content
    list_content = whole_content.split()
    dict = {}
    for one_word in list_content:
        dict[one_word] = 0
    for one_word in list_content:
        dict[one_word] += 1
    print dict.items()
    print sorted(dict.items(),key=func) 
```

# matlab - MATLAB中未初始化的持久变量的值

> ID：893419
> 
> 赞同：4
> 
> 时间：2009-05-21T15:04:47.740
> 
> 标签：matlab

如果我在 MATLAB 中将变量声明为“持久”，如何检查它是否已初始化？

exists() 函数显然不起作用（因为一旦我声明它是持久的，该变量就被视为存在）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-21T15:07:16.377

isempty() 是我正在寻找的功能。教我查看文档中的示例代码。

# javascript - IE/Firefox 中的 Ajax 问题

> ID：893421
> 
> 赞同：1
> 
> 时间：2009-05-21T15:05:12.590
> 
> 标签：javascript, ajax

嗨，我有一个 ajax 脚本，可以验证放入文本框中的用户信息。这在 Internet Explorer 中运行良好，但在 FireFox 中，我从列表框中获取性别时出错。我已将性别放入隐藏的文本框中，以便于处理。我在 FF 中得到的错误是

dd 为 null [打破此错误] theindex = dd.options[dd.selectedIndex].value;

我在 javascript 中的函数如下，这是在身体负载时加载的，或者在更改选择的性别后加载，

函数 get_gender() {
{

```
 var dd = document.getElementById("gender_select");
    theindex = dd.options[dd.selectedIndex].value;
    thevalue = dd.options[dd.selectedIndex].text;
    }

    document.getElementById("gender_text").value = thevalue;    

} 
```

我遇到的另一个问题是隐藏一个 div 框，这在其他所有浏览器中都可以正常工作，但在 IE 中却不行。它应该只在出现错误时显示 div 框，但在 IE 中始终显示 div 框。

我正在使用这一行来执行此操作： document.getElementById("username_div").style.visibility = "hidden";

无需粘贴我的所有代码，可以在以下位置查看实时页面

[http://elliottstocks.com/assignment/sign_up/](http://elliottstocks.com/assignment/sign_up/) 忽略登录框，这很好用。

任何意见/帮助将不胜感激。非常感谢 =)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T15:09:46.933

getElementByID 要求 HTML 元素有一个 ID，只是一个名称是不够的。

```
<select name="gender_select" id="gender_select" onChange="get_gender()">
  <option>Male</option> <option>Female</option>  
</select> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T15:08:01.477

对于空错误更改：

```
<select onchange="get_gender()" name="gender_select"> 
```

到

```
<select onchange="get_gender()" name="gender_select" id="gender_select"> 
```

`document.getElementById`正在寻找 DOM 中具有给定`id`属性的元素。它在 IE 中工作的原因是因为它也允许按`name`属性进行选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:15:33.850

对于第二个问题，您可能想尝试 display = 'none'; 为您的元素。请注意，此行为不同于可见性 = 隐藏。

# iphone - 无法在 NSMutableDictionary 中设置对象：forKey：

> ID：893422
> 
> 赞同：5
> 
> 时间：2009-05-21T15:05:15.570
> 
> 标签：iphone, nsdictionary

我确定我在尝试编写的一个简单的 iPhone 程序中遗漏了一些明显的东西，但是代码看起来很基本，我看不出有什么问题。

我正在尝试使用 NSMutableDictionary 来存储类列表及其关联的保存文件名。在头文件中我声明了字典

```
@interface ClassList : UITableViewController {
NSString *homedirectory;
NSString *masterindexpath;
NSMutableDictionary *classFilenameGlossary;
NSMutableArray *listofclasses;
}

@property (retain, nonatomic) NSString *homedirectory;
@property (retain, nonatomic) NSString *masterindexpath;
@property (retain, nonatomic) NSMutableDictionary *classFilenameGlossary;
@property (retain, nonatomic) NSMutableArray *listofclasses; 
```

当然，在实现文件中：

```
@implementation ClassList

@synthesize homedirectory;
@synthesize masterindexpath;
@synthesize classFilenameGlossary;
@synthesize listofclasses; 
```

我在 ViewDidLoad 从保存类列表的现有文件中初始化此字典：

```
- (void)viewDidLoad {
[super viewDidLoad];

// Get home directory

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
homedirectory = [paths objectAtIndex:0];
masterindexpath = [homedirectory stringByAppendingPathComponent:@"MasterIndex"];

// Get master course list or create it if necessary

NSFileManager *fm = [NSFileManager defaultManager];
if ([fm fileExistsAtPath:masterindexpath] == NO)
{
    NSMutableDictionary *temporarydictionary = [NSMutableDictionary dictionary];
    [temporarydictionary writeToFile:masterindexpath atomically:NO];
    [temporarydictionary release];
}

[classFilenameGlossary initWithContentsOfFile:masterindexpath];

[homedirectory retain];
[masterindexpath retain]; 
```

}

后来，我使用 setObject:forKey: 添加了一个项目，但字典永远不会改变。最初我在另一个视图控制器中使用指向此 ClassList 文件的指针执行此操作，但一旦我发现这不起作用，我简化并尝试在 ClassList 文件中设置任何示例对象和键：

```
 [classFilenameGlossary setObject:@"sample filename" forKey:@"sample classname"]; 
```

我查看了调试器变量列表，它显示 classFilenameGlossary 正确标识为具有 0 个键/值对的 NSMutableDictionary。我没有收到任何错误；字典永远不会改变。目前，从文件 masterindexpath 加载的字典是空的（因为我还不能添加任何项目），但这不应该阻止我向字典中添加项目。

我是 iPhone 编程的初学者，所以我确信我缺少一些基本的东西。我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T15:21:01.357

这一行：

```
[classFilenameGlossary initWithContentsOfFile:masterindexpath]; 
```

应该是这样的：

```
classFilenameGlossary = [[NSMutableDictionary alloc] initWithContentsOfFile:masterindexpath]; 
```

您忘记为 NSMutableDictionary 分配内存，所以这就是它从不初始化的原因。

# c# - 如何在 C# 4 中创建动态类？

> ID：893423
> 
> 赞同：4
> 
> 时间：2009-05-21T15:05:31.170
> 
> 标签：c#, dynamic

我想在 C# 中创建一个对象，并让它根据获取的不存在方法的名称做一些有趣的事情。

在 ruby​​ 中，这是 method_missing。在 Perl 中，这是自动加载。

我似乎无法在 C# 中找到进入 System.Dynamic 的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T15:36:09.020

尝试使用[System.Dynamic.DynamicObject](http://msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject(VS.100).aspx)作为简单的起点和基类。[您可以在http://winterdom.com/2009/05/dynamicobject-in-c-40](http://winterdom.com/2009/05/dynamicobject-in-c-40)找到一个示例。

# oracle - Oracle 资源管理器计划设计

> ID：893424
> 
> 赞同：2
> 
> 时间：2009-05-21T15:06:22.573
> 
> 标签：oracle, oracle10g, resourcemanager

我是 Oracle 10g 资源管理器的新手，正在寻找有关如何制定计划以实现我的目标的指导。我将测试该计划，但我希望得到一些指导，这样我就不必尝试数百种不同的计划配置。我有以下目标：

1.  不要让非系统会话显着减慢系统会话。
2.  不要让任何 OLTP 用户会话显着减慢任何其他 OLTP 用户会话。
3.  不要让批处理减慢 OLTP。

鉴于这些目标，我的第一个想法是创建以下消费者组/计划指令：

```
Consumer Group       Level 1     Level 2    Level 3
SYS                  100%           0%        0%
OLTP1                  0%          10%        0%
OLTP2                  0%          10%        0%
OLTP3                  0%          10%        0%
OLTP4                  0%          10%        0%
OLTP5                  0%          10%        0%
OLTP6                  0%          10%        0%
OLTP7                  0%          10%        0%
OLTP8                  0%          10%        0%
OLTP9                  0%          10%        0%
OLTP10                 0%          10%        0%
BATCH                  0%           0%      100% 
```

使用这种方法，可以将每个 OLTP 用户放入不同的 OLTP 组（假设有 10 个用户）。文档对此不是很清楚，但听起来如果 OLTP1 组中的 OLTP 用户需要的份额超过其 10% 的份额，只要其他所有 OLTP 组在需要时获得 10% 的份额，它就会获得它。我的理解准确吗？这会起作用还是有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-26T12:37:36.860

如果他们有相同的要求，我会稍微简化一下，为 OLTP 创建一个组。仅当新组在优先级方面的要求与其他组不同时才创建一个新组。还要确保当 OLTP 用户启动了长时间运行的重型进程时，该会话被切换到批处理组，或者根本不启动。资源管理器仅在 cpu 消耗为 100% 时启动。从那时起，它将开始划分资源，以确保每个组都能根据您的指令获得应得的东西。其他要考虑的事情是最大并行度、会话池和（从 11g 及更高版本）撤消使用和 io 限制。

最好的问候，罗纳德 [http://ronr.blogspot.com](http://ronr.blogspot.com)

# wpf - WPF 全局字体大小

> ID：893428
> 
> 赞同：78
> 
> 时间：2009-05-21T15:07:13.007
> 
> 标签：wpf, fonts

我正在创建一个 WPF 应用程序，我想知道能够更改 ui 中每个元素的字体大小的最佳方法。我是否创建资源字典并设置样式以设置我使用的所有控件的字体大小？

最佳做法是什么？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-05-21T17:57:47.657

我会这样做：

```
<Window.Resources>
        <Style TargetType="{x:Type Control}" x:Key="baseStyle">
            <Setter Property="FontSize" Value="100" />
        </Style>
        <Style TargetType="{x:Type Button}" BasedOn="{StaticResource baseStyle}"></Style>
        <Style TargetType="{x:Type Label}" BasedOn="{StaticResource baseStyle}"></Style>
        <Style TargetType="{x:Type TextBox}" BasedOn="{StaticResource baseStyle}"></Style>
        <Style TargetType="{x:Type ListView}" BasedOn="{StaticResource baseStyle}"></Style>
        <!-- ComboBox, RadioButton, CheckBox, etc... -->
    </Window.Resources> 
```

这样，如果我想更改所有控件，我只需要更改“baseStyle”样式，其余的将继承自它。（这就是 BasedOn 属性，如果您在继承的样式中创建其他设置器，您也可以扩展基本样式）

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2010-08-13T09:02:39.520

FontSizeProperty 继承自父控件。所以你只需要改变你的主窗口的 F​​ontSize 。

如果您不需要动态行为，这应该可以工作：

将 Window 的样式添加到您的 ResourceDictionary

```
<Style TargetType="{x:Type Window}">
     <Setter Property="FontSize" Value="15" />
</Style> 
```

将样式应用于您的主表单（不会被隐式应用，因为它是派生类型）

```
 Style = (Style)FindResource(typeof (Window)); 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2014-06-06T11:44:51.677

`<Window>`有一个属性 FontSize。

因此，如果要更改该窗口内所有元素的字体大小，可以在元素中设置所需的字体大小。

```
<Window FontSize="12">

</Window> 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2010-12-04T13:41:07.473

另一种选择是将 FontFamily 和 FontSize 定义为资源。

```
<FontFamily x:Key="BaseFontFamily">Calibri</FontFamily>
<sys:Double x:Key="BaseFontSize">12</sys:Double> 
```

这样你就可以在你的设置器中使用它们。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-05-21T13:42:30.290

```
Application.Current.MainWindow.FontSize = _appBodyFontSize; 
```

这样您也可以在运行时更改字体大小。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-07-16T10:06:04.197

`TextElement.FontSize`是一个继承属性，这意味着您可以简单地在根元素处设置字体大小，并且所有子元素都将使用该大小（只要您不手动更改它们）

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-21T17:06:08.510

对于 WPF 中的任何样式，您应该有一个单独的资源字典，其中包含您的应用程序的样式。

如果您想要在整个应用程序中重复使用的单个字体大小，那么只需为该字体大小创建一个样式。您可以给它一个唯一的名称/键以显式使用，也可以设置一个将超越整个应用程序的 targetType。

显式键：

```
<Style
    x:Key="MyFontSize"
    TargetType="TextBlock">
    <Setter
        Property="FontSize"
        Value="10" />
</Style>

<Control
    Style="{StaticResource MyFontSize}" /> 
```

*请注意，此样式可用于具有 contentPresenters 的控件

对于应用程序中的所有文本块：

```
<Style
    TargetType="TextBlock">
    <Setter
        Property="FontSize"
        Value="10" />
</Style>

<TextBlock
        Text="This text will be size 10" /> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-10T16:19:43.497

如果您需要以编程方式更改全局 FontSize，而不是静态 (XAML)，以便对所有窗口应用一次，您可以执行以下操作：

```
TextElement.FontSizeProperty.OverrideMetadata(
            typeof(TextElement),
            new FrameworkPropertyMetadata(16.0));

        TextBlock.FontSizeProperty.OverrideMetadata(
            typeof(TextBlock),
            new FrameworkPropertyMetadata(16.0)); 
```

此值适用于任何文本块、标签和几乎任何窗口中的任何文本，但它没有明确定义 FontSize。但这对 TextBox 没有影响，您必须为它或任何其他特殊控件编写类似的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-01-08T09:43:45.323

让我们有一些黑魔法的东西：

1.  将双重资源添加到您的应用程序资源中

```
<Application.Resources>
    <sys:Double xmlns:sys="clr-namespace:System;assembly=mscorlib" x:Key="GlobalFontSize">12</sys:Double>
</Application.Resources> 
```

2.  在 App 类中添加静态属性

```
public static double GlobalFontSize
{
    get => (double)Current.Resources["GlobalFontSize"];
    set => Current.Resources["GlobalFontSize"] = value;
} 
```

3.  在您想要的任何地方使用此资源`DynamicResource`

```
FontSize="{DynamicResource GlobalFontSize}" 
```

4.  以任何方式访问属性`App.GlobalFontSize`来改变值，`binding`没关系！

```
App.GlobalFontSize = 20;
//Or
{Binding Path=(local:App.GlobalFontSize)} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-11-05T13:50:30.990

要使用 ctrl-mousewheel 全局动态更改字体大小：

XAML：

```
<Window Name="MainWindow" ... PreviewMouseWheel="MainWindow_PreviewMouseWheel"> 
```

后面的代码：

```
private void MainWindow_PreviewMouseWheel(object sender, MouseWheelEventArgs e)
{
    if ((Keyboard.Modifiers & ModifierKeys.Control) != 0)
    {
        if (e.Delta > 0)
            ++mainCtrl.FontSize;
        if (e.Delta < 0 && mainCtrl.FontSize > 1)
             --mainCtrl.FontSize;
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-12T09:59:55.380

在 XAML 中使用资源是要走的路。尽管这个问题有很多很好的答案，但我想将我的两分钱添加到资源的范围中。

对于项目的所有 Windows 和用户控件中的全局可访问性，您可以将资源放在**App.xaml**文件中

```
<Application.Resources>
    <Style TargetType="{x:Type Control}" x:Key="GlobalFontSize">
        <Setter Property="FontSize" Value="28"/>
    </Style>
</Application.Resources> 
```

对于 Window 级别的可访问性，您可以将资源放在**Window的 xaml 文件中**

```
<Window.Resources>
    <Style TargetType="{x:Type Control}" x:Key="GlobalFontSize">
        <Setter Property="FontSize" Value="28"/>
    </Style>
</Window.Resources> 
```

例如，您甚至可以将其置于控制级别

```
<DockPanel.Resources>
    <Style TargetType="{x:Type Control}" x:Key="GlobalFontSize">
        <Setter Property="FontSize" Value="28"/>
    </Style>
</DockPanel.Resources> 
```

# serialization - 在同一个源文件上使用来自不同 JDK 版本的编译器会破坏（反）序列化吗？

> ID：893433
> 
> 赞同：2
> 
> 时间：2009-05-21T15:08:00.307
> 
> 标签：serialization, build-process, jar, java

我有一个分布式应用程序。客户端和服务器共享一些公共库。客户端必须使用 JDK 5 编译器或 target=1.5 进行编译（也可以在 PowerPC 和 CoreDuo Mac 上的任何地方运行）。但我想在仅服务器代码中使用 SE 6 功能。

是否可以两次编译公共库 - 一次使用 JDK 5，一次使用 JDK 6，并使用使用 JDK 5 编译的类文件在客户端序列化对象，并使用使用 JDK 6 编译的类文件在服务器端反序列化它们反之亦然？还是会破坏序列化？

构建应该使用使用不同 JDK 版本编译的代码运行的库的最佳实践是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T15:14:18.250

如果您明确定义您的`serialVersionUID`，则*应该*可以在不同的 JVM 版本中进行序列化和反序列化。这就是定义它的重点。见[规格](http://java.sun.com/javase/6/docs/platform/serialization/spec/class.html#4100)：

> **注意**- 强烈建议所有可序列化的类都显式声明`serialVersionUID`值，因为默认`serialVersionUID`计算对类细节高度敏感，这些细节可能因编译器实现而异，因此可能会在反序列化`serialVersionUID`期间导致意外冲突，从而导致反序列化失败。

# language-agnostic - 使用 Lucene 搜索单词的替代形式的最佳实践

> ID：893436
> 
> 赞同：4
> 
> 时间：2009-05-21T15:08:28.233
> 
> 标签：language-agnostic, search, lucene, linguistics

我有一个可以使用 Lucene 搜索的网站。我从日志中注意到，用户有时找不到他们正在寻找的内容，因为他们输入了一个单数术语，但网站上只使用了该术语的复数版本。我希望搜索也能找到其他形式的单词的用法。这是一个我确信已经解决了很多次的问题，那么最好的做法是什么？

**请注意：本站只有英文内容**。

我想到的一些方法：

1.  在某种同义词库文件中查找单词以确定给定单词的替代形式。
    *   一些例子：
        *   搜索“汽车”，还将“汽车”添加到查询中。
        *   搜索“carry”，还将“carries”和“carried”添加到查询中。
        *   搜索“small”，还将“smaller”和“smallest”添加到查询中。
        *   搜索“can”，还将“can't”、“cannot”、“cans”和“canned”添加到查询中。
        *   它应该反向工作（即搜索“carries”应该添加“carry”和“carried”）。
    *   缺点：
        *   除非词典/词库经常更新，否则不适用于许多新的技术词汇。
        *   我不确定搜索词库文件的性能。
2.  基于一些启发式算法生成替代形式。
    *   一些例子：
        *   如果单词以“s”或“es”或“ed”或“er”或“est”结尾，去掉后缀
        *   如果单词以“ies”或“ied”或“ier”或“iest”结尾，则转换为“y”
        *   如果单词以“y”结尾，则转换为“ies”、“ied”、“ier”和“iest”
        *   尝试在单词中添加“s”、“es”、“er”和“est”。
    *   缺点：
        *   为大多数输入生成大量非单词。
        *   感觉就像一个黑客。
        *   看起来像你可以在 TheDailyWTF.com 上找到的东西。:)
3.  更复杂的东西？

我正在考虑对前两种方法进行某种组合，但我不确定在哪里可以找到同义词库文件（或者它的名称，因为“同义词库”不太正确，但“词典”也不是）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T16:33:15.923

考虑将 包含[`PorterStemFilter`](http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/analysis/PorterStemFilter.html)在您的分析管道中。确保对构建索引时使用的查询执行相同的分析。

我还使用了[兰开斯特词干](http://www.comp.lancs.ac.uk/computing/research/stemming/index.htm)算法，效果很好。以`PorterStemFilter`为指导，很容易与 Lucene 集成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T12:25:26.117

词干对英语来说效果很好，但是对于词干几乎不可能的语言（比如我的）选项＃1是可行的。我知道我的语言（冰岛语）的 Lucene 至少有一种这样的实现，它似乎工作得很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T15:25:43.767

其中一些看起来很巧妙。就个人而言，我只会在查询（查询转换）中添加一些标签以使其模糊，或者您可以使用内置的[FuzzyQuery](http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/search/FuzzyQuery.html)，它使用 Levenshtein 编辑距离，这将有助于拼写错误。

使用模糊搜索“[查询标签](http://lucene.apache.org/java/2_3_2/queryparsersyntax.html)”，Levenshtein 也被使用。考虑搜索“汽车”。如果将查询更改为“car~”，它将找到“car”和“cars”等。查询的其他转换应该可以处理您需要的几乎所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T19:09:36.333

如果你在一个专业领域工作（我是在园艺方面做的）或者使用一种不能很好地使用普通词干提取方法的语言，你可以使用查询日志来创建一个手动词干提取表。

只需为您能想到的/人们正在搜索的所有不匹配创建一个词-> 词干映射，然后在索引或搜索时用适当的词干替换表中出现的任何词。由于查询缓存，这是一个非常便宜的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T20:27:19.927

词干提取是解决此问题的一种非常标准的方法。我发现 Porter 词干分析器对于标准关键字搜索来说是一种激进的方式。它最终将具有不同含义的单词混为一谈。试试 KStemmer 算法。

# msbuild - MSBuild 和 _PublishedWebsites

> ID：893440
> 
> 赞同：2
> 
> 时间：2009-05-21T15:08:48.713
> 
> 标签：msbuild

在 MSbuild 构建了我的解决方案（带有一个 asp.net 网站）之后，webdeployment 项目已经构建并将网站放在目录 _PublishedWebsites 中：

c:\mybuilds\buildName\Daily_20090519.3\Release_PublishedWebsites\MyWebsite。

如何将其复制到 IIS 指向测试网站的固定目录？

我找到了大量的代码片段，但我似乎找不到一个会考虑到此目录名称更改这一事实的代码片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T04:36:53.733

这很容易。您可以编辑项目并插入类似于以下内容的内容。

```
<PropertyGroup>
  <OutputDest>$(MSBuildProjectDirectory)\..\OutputCopy\</OutputDest>
</PropertyGroup>
<Target Name="AfterBuild">
  <!-- Create an item with all the output files -->
  <ItemGroup>
    <_OutputFiles Include="$(OutputPath)**\*" Exclude="$(OutputPath)obj\**\*" />
  </ItemGroup>
  <!-- You probably don't want to include the files in the obj folder so exclude them. -->

  <Message Text="OutputDest : $(OutputDest)" />
  <Copy SourceFiles="@(_OutputFiles)"
        DestinationFiles="@(_OutputFiles->'$(OutputDest)%(RecursiveDir)%(Filename)%(Extension)')"/>
</Target> 
```

这是你想要的？

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-30T18:56:25.230

我正在使用不同的技术。

```
<PropertyGroup>
    <BinariesRoot>c:\BinariesForIis\</BinariesRoot>
</PropertyGroup> 
```

将`c:\BinariesForIis\`用于直接输出编译的二进制文件（在复制到`...\Daily_20090519.3\Release_`...之前）。

# google-search - 谷歌网站搜索...在结果中显示产品图片？

> ID：893443
> 
> 赞同：2
> 
> 时间：2009-05-21T15:09:02.100
> 
> 标签：google-search

Google 提供了一种搜索功能，您可以将其嵌入到您的网页中作为您网页的搜索功能，我想将其用于电子商务网站。但如果他们搜索产品，我希望能够在结果中显示产品的图片。有人用过谷歌网站搜索吗？有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T15:43:05.837

我用 mnogosearch 做到了这一点。诀窍是将搜索结果作为 XML 获取，然后根据结果构建 HTML 服务器端（插入图像链接）。您可以对 Google 的结果 HTML 做类似的事情，无论是服务器端还是客户端 Javascript DOM 遍历）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:18:28.210

这是一些伪代码：您可以使用 javascript 或 jQuery 读取链接中的 url 并确定它是否指向特定产品（可能产品编号在 url 中）解析出来并向页面发送 AJAX 请求将向页面发送产品图像的路径，然后将其与搜索结果一起显示。

# database - 使用整数列在数据库中存储美国邮政编码是个好主意吗？

> ID：893454
> 
> 赞同：56
> 
> 时间：2009-05-21T15:10:21.753
> 
> 标签：database, database-design, types, street-address, postal-code

乍一看，在数据库表中存储[邮政编码有两种基本选择：](http://en.wikipedia.org/wiki/ZIP_code)

1.  文本（可能是最常见的），即`char(5)`或`varchar(9)`支持 +4 扩展
2.  数字，即 32 位整数

如果我们假设没有国际问题，两者都将满足数据的要求。过去我们通常只是走文本路线，但我想知道是否有人反其道而行之？简单比较一下，整数方法看起来有两个明显的优点：

*   就其性质而言，它自动仅限于数字（而在没有验证的情况下，文本样式可以存储字母等，据我所知，在邮政编码中永远无效）。但这*并不*意味着我们可以/将/应该放弃正常验证用户输入！
*   它占用的空间更少，为 4 个字节（即使对于 9 位邮政编码也应该足够了），而不是 5 或 9 个字节。

此外，它似乎不会对显示输出造成太大影响。`ToString()`在数值上加上 a是微不足道的，使用简单的字符串操作来插入连字符或空格或其他任何 +4 扩展名，并使用字符串格式来恢复前导零。

是否有任何不鼓励将`int`其用作仅限美国的邮政编码的数据类型？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-05-21T15:15:57.343

数字邮政编码——在某种程度上——具有误导性。

数字应该意味着*数字*。邮政编码不加减或参与任何数字运算。12309 - 12345 不计算从斯克内克塔迪市中心到我附近的距离。

当然，对于邮政编码，没有人会感到困惑。但是，对于其他类似数字的字段，它可能会令人困惑。

由于邮政编码不是数字——它们只是碰巧用受限制的字母编码——我建议避免使用数字字段。节省 1 个字节并不值得。我认为那个*意义*比字节更重要。

* * *

**编辑**.

“至于前导零……”是我的观点。数字没有前导零。邮政编码上有意义的前导零的存在再次证明它们不是数字。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-21T15:12:29.567

您是否要存储非美国邮政编码？加拿大是 6 个字符和一些字母。我通常只使用 10 个字符的字段。磁盘空间很便宜，不必重新设计数据模型。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-21T15:12:50.407

使用带有验证的字符串。邮政编码可以以 0 开头，因此数字不是合适的类型。此外，这也适用于国际邮政编码（例如 UK，最多 8 个字符）。在邮政编码成为瓶颈的不太可能的情况下，您可以将其限制为 10 个字符，但首先检查您的[目标格式](http://en.wikipedia.org/wiki/Postal_Codes#Postal_codes_in_particular_countries)。

[以下是](http://www.forta.com/blog/index.cfm?mode=entry&entry=A61BA033-3048-80A9-EFF8935E41AB9FE2)英国、美国和加拿大的验证正则表达式。

* * *

是的，您可以填充以获取前导零。但是，从理论上讲，您会丢弃可能在出现错误时有所帮助的信息。如果有人在数据库中找到 1235，那是原来的 01235，还是漏掉了另一个数字？

最佳实践表明你应该说出你的意思。邮政编码是一个代码，而不是一个数字。你要[加/减/乘/除](https://stackoverflow.com/questions/290597/phone-number-columns-in-a-database)邮政编码吗？从实际的角度来看，排除加长拉链更为重要。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-21T15:14:28.873

通常您会使用非数字数据类型，例如允许更多邮政编码类型的 varchar。如果您只允许 5 位 [XXXXX] 或 9 位 [XXXXX-XXXX] 邮政编码，那么您可以使用 char(5) 或 char(10)，但我不推荐它。Varchar 是最安全和最理智的选择。

编辑：还应注意，如果您不打算在字段上进行数值计算，则不应使用数值数据类型。从您添加或减去它的意义上说，邮政编码不是一个数字。它只是一个通常由数字组成的字符串，因此您应该避免使用数字数据类型。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-21T15:54:19.607

从技术角度来看，这里提出的一些观点相当微不足道。我*每天*都在处理地址数据清理工作——特别是清理来自世界各地的地址数据。无论如何，这都不是一项微不足道的任务。对于邮政编码，您*可以*将它们存储为整数，尽管它可能不是“语义上”正确的。事实是，数据是数字形式，严格来说，它*被*认为是数值型的。

但是，将它们存储为数字类型的真正缺点是，您将无法轻松查看数据是否输入错误（即缺少值），或者系统是否删除了前导零，从而导致验证可能无效的昂贵操作其他正确的邮政编码。

如果影响之一是业务延迟，也很难强迫用户输入正确的数据。如果不是很明显，用户通常没有耐心输入正确的数据。使用正则表达式是保证数据正确的一种方法，但是如果用户输入的值不符合要求并且显示错误，他们可能会完全忽略该值或输入符合要求但不正确的内容。一个示例 [使用加拿大邮政编码] 是您经常看到输入的 A0A 0A0 无效，但符合加拿大邮政编码的正则表达式。通常情况下，这是由被迫提供邮政编码的用户输入的，但他们要么不知道它是什么，要么没有全部正确。

一个建议是将整个条目作为一个单元进行验证，以验证邮政编码与地址的其余部分相比是否正确。如果不正确，则为地址提供替代的有效邮政编码将使他们更容易输入有效数据。同样，如果街道地址的邮政编码正确，但街道号码不在该邮政编码的范围内，则为该邮政编码/街道组合提供备用街道号码。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-03-21T18:54:18.757

没有为什么

*   你永远不会在邮政编码上做数学函数
*   可以包含破折号
*   可以从 0 开始
*   在整数等标量类型的情况下，NULL 值有时被解释为零（例如，当您以某种方式导出数据时）
*   **邮政编码，即使它是一个数字，也是一个区域的名称，这意味着这是一个名称，而不是任何事物的数字数量**

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-21T16:10:02.570

除非您有对邮政编码数据执行数学计算的业务需求，否则使用 INT 是没有意义的。你的工程过度了。

希望这可以帮助，

账单

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-08T20:11:32.313

如果您考虑一下，邮政编码实际上是一个编码的命名空间。传统上是数字，但也有连字符和大写字母：

“10022-鞋”

[http://www.saksfifthavenue.com/main/10022-shoe.jsp](http://www.saksfifthavenue.com/main/10022-shoe.jsp)

实际上，许多业务应用程序不需要支持这种边缘情况，即使它是有效的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T15:14:18.000

整数很好，但它只在美国有效，这就是为什么大多数人不这样做。通常我只使用 varchar(20) 左右。可能对任何语言环境都过分了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-13T09:14:38.527

如果要对美国邮政编码使用整数，则需要将前导部分乘以 10,000 并加上 +4。数据库中的编码与输入验证无关。您始终可以要求输入是否有效，但存储取决于您认为您的要求或 USPS 会发生多少变化。（提示：你的要求*会*改变。）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-24T16:48:54.873

我[最近了解到](https://stackoverflow.com/questions/48960614/how-do-i-keep-my-rails-integer-from-being-converted-to-binary)，在 Ruby 中，您希望避免这种情况的一个原因是，有些邮政编码以前导零开头，如果以整数形式存储，它们会自动转换为八进制。

从[文档](https://ruby-doc.org/core-2.3.0/doc/syntax/literals_rdoc.html#label-Numbers)：

> 您可以使用特殊前缀来写入十进制、十六进制、八进制或二进制格式的数字。十进制数使用前缀 0d，十六进制数使用前缀 0x，八进制数使用前缀 0 或 0o...</p>

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-03-04T12:15:37.260

我认为 int 数据类型中的邮政编码会影响 ML 模型。可能，代码可以在数据中创建异常值以进行计算

# asp.net-mvc - ASP.NET MVC 将表单值插入 ViewModel

> ID：893455
> 
> 赞同：2
> 
> 时间：2009-05-21T15:10:32.597
> 
> 标签：asp.net-mvc

我正在尝试确定 ASP.NET MVC 中是否有内置方法可以将 POST 的表单值分配给最初发送到视图的 ViewModel 的属性？

因此，我正在考虑使用属性装饰 ViewModel 中的某些属性，然后反映 ViewModel 并使用该名称从 Form[] 对象中提取值（和强制）的想法。

但是，我想像这样的东西已经内置了，所以不想在这里重新发明轮子。

我要解决的问题是用户单击表单上的按钮，服务器验证数据，如果出现错误，我们使用相同的 ViewModel 将用户返回到表单来携带数据，从而填充值回到用户最初输入的形式。

（是的，我还在使用 JavaScript 进行客户端验证以使其轻量级，但为了安全起见，我必须在服务器上重复验证。）

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:37:28.890

您可以在控制器中使用[UpdateModel](http://msdn.microsoft.com/en-us/library/dd470185.aspx)或[TryUpdateModel](http://msdn.microsoft.com/en-us/library/dd470756.aspx)。

我建议使用您指定要更新的字段的重载之一。

[Wrox Professional ASP.net](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)电子书（或章节！）的第 78 页对此进行了详细讨论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:16:54.067

我认为 MVC 没有内置这样的东西，或者至少我没有看到任何东西。尽管许多其他 MVC 框架都这样做（例如 struts），但它会很好。

# php - 使用 php 和 mysql 存储和检索多维数组

> ID：893461
> 
> 赞同：9
> 
> 时间：2009-05-21T15:11:36.633
> 
> 标签：php, mysql, sql, serialization

我在 PHP 中有一个多维数组，如下所示：

```
$array = array(
    "Part1" => array(
        "Subpart1" => array(0, 1),
        "Subpart2" => array(1, 0)
    ),
    "Part2" => array(0),
    "Part3" => array(0, 1, 0)
); 
```

现在我想将这个数组存储在一个 MySQL 表中，并在另一个 PHP 页面上再次像这样检索它。

我一直在尝试使用`serialize()`和`unserialize()`

```
$array= serialize($array); 
```

然后在另一页

```
$array= $row['Array'];
$array2 = array();
$array2 = unserialize($array); 
```

但我似乎做错了什么，一开始我得到了`var_dump`bool *(false)*，现在我得到`var_dump`了*NULL*。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T15:13:54.243

你的代码看起来不错...

可以抓住你的一件事是如果你的列太小 - 如果你使用 VARCHAR(255) 你的数据可能会被截断并且不会反序列化。如果你加上`$row['Array']`I 的值，可以看看它是否完整。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T15:34:27.757

使用列类型 TEXT。序列化数据通常不适合 VARCHAR(255)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:19:00.530

您可以使用 json 编码，json_encode($array)，您将获得一个 json 表示法的字符串值，以便您可以存储在数据库中，然后检索并执行 json_decode($string, true)，以便您可以再次转换为数组。如果您不将 true 参数传递给 json_decode，它将转换为 stdClass。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T05:41:02.200

**详情** **数量** **比率** **金额** **金额 总和** **其他 其他 金额** **税金 合计** ****这是我在 php/html 中的表格。我需要将 php Particulars(p),Quantity(q),Rate(r) 存储和检索为单独的表格格式

# eclipse - 我可以使用 Eclipse 轻松地将 JavaDoc 添加到包中吗？

> ID：893474
> 
> 赞同：40
> 
> 时间：2009-05-21T15:13:22.123
> 
> 标签：eclipse, javadoc

我使用 javadoc 来记录我的类和方法。我也想在我的包中添加一些概述信息。我喜欢 Eclipse 如何在我键入后为每个类或方法创建一个匹配的 Doc Comment 的存根`/**<Enter>`。Eclipse 是否也有一种简单的方法来生成[package.html 文件](http://java.sun.com/j2se/javadoc/writingdoccomments/index.html#packagecomments)？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-21T18:31:08.057

4 年后更新（2013 年 10 月）

[javabeangrinder](https://stackoverflow.com/users/1782954/javabeangrinder)的[回答](https://stackoverflow.com/a/14708381/6309)（赞成）提到了以下技巧：

> `package-info.java`在现有包中创建文件：

*   右键单击您想要的包`package-info.java`。
*   选择`new->package`。
*   选中`Create package.info.java`复选框。
*   点击`Finish`

* * *

原始答案（2009 年 5 月）

没有模板或向导可以轻松创建 package.html 文件。

正如[mmyers](https://stackoverflow.com/users/13531/mmyers)在他的评论中所说，因为`Java1.5`，要创建的正确文件是[`package-info.java`](http://java.sun.com/javase/6/docs/technotes/guides/javadoc/whatsnew-1.5.0.html).
该文件不仅可以用于 javadocs，还可以用于[包级别的注释](http://www.onjava.com/pub/a/onjava/2004/04/21/declarative.html?page=3)（如此[处所示](http://weblogs.java.net/blog/kohsuke/archive/2005/09/using_jaxb_20s.html)）。

有一个已[打开的错误 (#86168)](https://bugs.eclipse.org/bugs/show_bug.cgi?id=86168)要求使用向导来创建`package-info.java`（因为**类向导不允许使用`package-info`name**）。

自... 2005 年以来，关于该主题的思考就开始了！问题是任何解决方案都应该以一种对`1.4`代码也有帮助的方式实现。

当前的解决方法是创建`package-info.java`一个`text`文件。
从那时起，它`package-info.java`的行为就像一个普通的 Java 类，并且 Eclipse 将一个`package-info.class`文件放在输出文件夹中。
是使用`Javadocs`正确构建的`package-info.java`，而不是`package.html`文件。

[![替代文字](https://i.stack.imgur.com/a3AA1.png)](https://i.stack.imgur.com/a3AA1.png)
[（来源：[developpez.com](http://jmdoudoux.developpez.com/cours/developpons/java/images/jaxb006.png)）]

* * *

注意（回应[Strawberry](https://stackoverflow.com/users/187492/strawberry)的评论）：

*   [错误 77451](https://bugs.eclipse.org/bugs/show_bug.cgi?id=https://bugs.eclipse.org/bugs/show_bug.cgi?id=77451)（2004 年！，对于 package.html）
*   [错误 163633](https://bugs.eclipse.org/bugs/show_bug.cgi?id=163633)和[错误 163926](https://bugs.eclipse.org/bugs/show_bug.cgi?id=163926) （2006，对于 package-info.java）

两者都***希望***在 Javadoc 视图中的**package-info.java 中预览包概述**。

到目前为止，尚未提出/实施任何补丁。
根本没有足够的需求来添加该功能。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-05T13:12:49.280

**在日食**

由于 package-info.java 不是类的有效标识符，因此不能在 Eclipse 中将其创建为类。

我发现当你创建一个新包时，有一个复选框来检查你是否需要一个 package-info.java。

要在现有包中创建 package-info.java 文件：

1.  右键单击需要 package-info.java 的包。
2.  选择新建-> 包。
3.  选中创建 package.info.java 复选框。
4.  点击完成

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-01-14T21:25:23.740

**JAutodoc**插件在这方面做得很好，也可以满足您的所有其他文档需求。安装并配置插件并右键单击包并单击*JAutodoc > 添加包 Javadoc*

`.java`或`.html`包文档有可用的配置和模板。

该插件还可以很好地标准化您的所有 Javadoc 需求，并进行大量自定义。

[http://jautodoc.sourceforge.net/](http://jautodoc.sourceforge.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-06T18:07:55.047

有一个插件似乎可以创建 package.html 文件。我没用过，但是登陆这里的人可能会觉得它很有用。

[http://sourceforge.net/projects/package-javadoc/](http://sourceforge.net/projects/package-javadoc/)

# java - Java DB Derby Blobs & Delete 的性能问题

> ID：893475
> 
> 赞同：5
> 
> 时间：2009-05-21T15:13:36.193
> 
> 标签：java, performance, jdbc, derby

我在删除 derby 中的 blob 时遇到了性能问题，想知道是否有人可以提供任何建议。

这主要是在 windows 和 solaris 下使用 10.4.2.0，虽然我也使用新的 10.5.1.1 候选版本进行了测试（因为它有很多 lob 更改），但这并没有显着差异。

问题在于，对于包含许多大 blob 的表，删除单行可能需要很长时间（通常超过一分钟）。

我已经通过一个小测试重现了这一点，该测试创建了一个表，插入几行不同大小的 blob，然后删除它们。

表模式很简单，只是：

创建表 blobtest（默认生成的 id 整数作为标识，b blob）

然后我创建了 7 行，具有以下 blob 大小：1024 字节、1Mb、10Mb、25Mb、50Mb、75Mb、100Mb。

我已经读回了 blob，以检查它们是否已正确创建并且大小正确。

然后使用 sql 语句（“delete from blobtest where id = X”）删除它们。

如果我按照创建它们的顺序删除行，则删除单行的平均时间为：

1024 字节：19.5 秒

1Mb：16 秒

10Mb：18 秒

25Mb：15 秒

50Mb：17 秒

75Mb：10 秒

100Mb：1.5 秒

如果我以相反的顺序删除它们，删除单行的平均时间是：

100Mb：20 秒

75Mb：10 秒

50Mb：4 秒

25Mb：0.3 秒

10Mb：0.25 秒

1Mb：0.02 秒

1024 字节：0.005 秒

如果我创建七个小 blob，删除时间都是瞬时的。

因此，删除时间似乎与表中行的整体大小有关，而不是与被删除的 blob 的大小有关。

我已经运行了几次测试，结果似乎可以重现。

那么，是否有人对性能有任何解释，以及如何解决或修复它的任何建议？它确实使在生产环境中使用大 blob 非常成问题……</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:49:06.887

据我所知，**Derby 只会将 BLOB 与其他数据库数据内联存储，**因此您最终会将 BLOB 拆分为大量单独的数据库页面文件。这种 BLOB 存储机制适用于 ACID，适用于较小的 BLOB（例如，图像缩略图），但会因较大的对象而分解。根据 Derby 文档，**在操作 BLOB 时关闭自动提交也可能会提高性能**，但这只会到此为止。

**如果大型 BLOB 的良好性能很重要**，并且 BLOB 必须保留在数据库中，我强烈建议您迁移到 H2 或其他 DBMS。您可以使用 SQuirrel SQL 客户端及其 DBCopy 插件直接在 DBMS 之间迁移（只需将其指向 Derby/JavaDB JDBC 驱动程序和 H2 驱动程序）。我很乐意为这部分提供帮助，因为我自己就是这样做的，而且并没有更快乐。

否则，**您可以将 BLOB 移出数据库并移入文件系统。**为此，您可以将数据库中的 BLOB 列替换为 BLOB 大小（如果需要）和位置（URI 或平台相关的文件字符串）。创建新 blob 时，您会在文件系统中创建相应的文件。该位置可以基于给定目录，并附加主键。例如，您的数据库位于“DBFolder/DBName”中，而您的 Blob 位于“DBFolder/DBName/Blob”中，文件名为“BLOB_PRIMARYKEY.bin”或类似名称。要编辑或读取 BLOB，请在数据库中查询位置，然后直接读取/写入文件。然后，如果新文件大小发生更改，则将其记录到数据库中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T13:16:14.047

我有完全相同的问题。

我发现当我执行 DELETE 时，derby 实际上完全“读取”了大段文件。我使用 Filemon.exe 来观察它是如何运行的。

我的文件大小为 940MB，删除一行需要 90 秒。

我相信 derby 将表数据存储在单个文件里面。还有一些设计/实现错误如何导致它读取所有内容，而不是使用适当的索引进行操作。

我做批量删除而不是解决这个问题。我重写了我的程序的一部分。它是“哪里 id=？” 在自动提交中。然后我重写了很多东西，现在“ID IN（？，.......？）”包含在事务中。

总时间减少到之前的1/1000。

我建议您可以为“标记为已删除”添加一列，并附上批量实际删除的时间表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:38:31.513

我确定这不是您想要的答案，但对于具有吞吐量要求的生产环境，我不会使用 Java DB。MySQL 同样免费，可以更好地满足您的需求。我认为你真的只是在反对你选择的解决方案的限制。

我通常只使用 Derby 作为测试用例，尤其是只有当我的整个数据库可以轻松放入内存时。YMMV。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:16:37.450

您是否尝试过[增加数据库的页面大小](http://developers.sun.com/docs/javadb/10.4.2.1/tuning/ctunperf10065.html)？

在[Tuning Java DB](http://developers.sun.com/javadb/reference/docs/)手册中有关于此的信息以及更多信息，您可能会发现它们很有用。

# windows - 跟踪应用程序安装程序操作的工具？（赢）

> ID：893488
> 
> 赞同：1
> 
> 时间：2009-05-21T15:15:37.000
> 
> 标签：windows, operating-system, windows-installer, installation

我需要找出某些应用程序的安装程序执行的所有文件系统和注册表操作。有这方面的软件工具吗？

操作系统是 Windows XP，如果这很重要的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T15:21:38.533

查看[Windows SysInternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx)实用程序。

特别是[RegMon](http://technet.microsoft.com/en-us/sysinternals/bb896652.aspx)和[FileMon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:21:15.257

我不确定是否跟踪文件系统更改，但您可以在安装前后将 Windows 注册表导出为文本，然后使用差异工具查看更改的内容。 [这里有一个 O'Reilly hack。](http://oreilly.com/pub/h/2887)

可以想象，您可以对驱动器根目录的 DIR/S 执行相同的操作，尽管这会非常耗时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:23:51.897

为什么不使用其中一种“卸载监控程序”？

[Total Uninstall](http://www.martau.com/)是第一个想到的，虽然确实有很多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:25:01.427

[该站点](http://www.installsite.org/pages/en/msi/tips.htm)列出了一些安装程序监视器。

# qt - Qt 和双缓冲 - 是否有任何巧妙的技巧来捕获像素或操作后台缓冲区？

> ID：893490
> 
> 赞同：4
> 
> 时间：2009-05-21T15:16:00.120
> 
> 标签：qt, mfc, qt4, doublebuffered

我正在将应用程序从 MFC 迁移到 Qt。

MFC 应用程序将使用 GDI 调用来构建窗口（基本上是一个图表）。它将绘制到内存位图后台缓冲区，然后将 BitBlt 绘制到屏幕上。然而，Qt 已经做了双缓冲。

当用户在图表中单击并拖动时，我希望窗口的该部分被反转。

我想找到最好的方法来做到这一点。有没有办法做一些像从小部件的后台缓冲区而不是屏幕抓取的东西？...也许是 BitBlt(..., DST_INVERT) 等价物？

我在 QPainter 中看到了 setCompositionMode()，但文档说这只适用于在 QImage 上操作的画家。（否则，我可以使用精美的合成模式将实心矩形图像合成到我的小部件上，以获得类似反转效果的效果）

我可以做与 MFC 相同的事情，绘制到 QImage 后台缓冲区......但我读到硬件加速可能无法以这种方式工作。重新实现 Qt 中已经提供给您的双缓冲似乎是一种浪费。我也不太确定关闭小部件的双缓冲可能会产生什么副作用（以避免三重缓冲）。

有一次，我有一个令人费解的 QPixmap::grabWidget() 调用，并带有防止递归的标志来保护它，但这会将所有内容渲染两次，并且显然比仅绘制到 QImage 更糟糕。（并且在文档中特别警告过）

我是否应该放弃并将所有内容绘制到 QImage 上，就像我在 MFC 中所做的那样？

**编辑：**

好的，QPixmap 画家的运行速度与现在的直接运行速度大致相同。因此，使用 QPixmap 后台缓冲区似乎是最好的方法。

解决方案对我来说并不明显，但如果我查看更多示例（例如 Ariya 的 Monster 演示），我可能会按照预期的方式对其进行编码，并且效果会很好。

这就是区别。我看到了使用这个的帮助系统演示：

```
 QPainter painter(this) 
```

在paintEvent() 的开始。因此，我似乎很自然地认为，将缓冲区加倍到 QPixmap 然后在屏幕上绘制，您需要这样做：

```
 QPainter painter(&pixmap);
    QPainter painterWidget(this);
    ...  draw using 'painter' ...
    painterWidget.drawPixmap(QPoint(0,0), pixmap); 
```

实际上，您显然应该这样做：

```
 QPainter painter;
    painter.begin(&pixmap);
    ... draw using 'painter' ...
    painter.end();
    painter.begin(this);
    painter.drawPixmap(QPoint(0,0), pixmap);
    painter.end(); 
```

我可以看到我的方式同时有两个活跃的画家。我不完全确定*为什么*它更快，但直觉上我更喜欢后者。它是一个单一的 QPainter 对象，一次只做一件事。也许有人可以解释为什么第一种方法不好？（就 Qt 渲染引擎中的错误假设而言）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T11:37:16.337

假设你真的不想从你的屏幕外缓冲区像素值（而是只是在它上面再次绘制一些东西并再次blit到屏幕上），你应该使用QPixmap作为缓冲区，而不是QImage。使用后者会禁用所有绘画加速，因为 Qt 使用其软件光栅引擎回退，因此使用 QPixmap。如果您使用 OpenGL 图形系统，您仍然可以从中受益。

有关如何执行此操作的示例，请查看[我运行 Monster 演示的最后代码](http://labs.trolltech.com/blogs/2009/04/15/monster-evolution-in-qt-episode-3-revenge-of-the-cylinders/)，它需要有一个屏幕外像素图，以通过使用源超过合成模式重复绘制来产生运动模糊效果。

要禁用 Qt 的后备存储（这通常不是一个好主意），请将[Qt::WA_PaintOnScreen](http://doc.trolltech.com/4.5/qt.html#WidgetAttribute-enum)用于您的顶级小部件。

有点不相关，但您可能想看看[QRubberBand](http://doc.trolltech.com/4.5/qrubberband.html)小部件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T13:02:54.200

在图形区域顶部绘图，您应该能够使用合成模式进行反转。使用差异合成模式绘制白色。以下示例是显示像素图的 QLabel 的子类：

```
void Widget::paintEvent(QPaintEvent *pe)
{
    // make sure we paint background
    QLabel::paintEvent(pe);

    // paint the overlay
    if (!selectionRect.isNull()) {
        QPainter p(this);
        p.setCompositionMode(QPainter::CompositionMode_Difference);
        p.fillRect(selectionRect,QColor("#FFFFFF"));
    }
} 
```

[替代文字 http://chaos.troll.no/~hhartz/yesManInverted.png](http://chaos.troll.no/~hhartz/yesManInverted.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:39:18.457

我所知道的最简单、最直接的答案是像以前一样对 QImage 进行操作，并使用 QImage 作为屏幕上小部件的源。

另一种选择可能是在您的图表上添加一个透明小部件，它只绘制图表的倒置部分。但是，我认为这根本不会优化绘图。它可能会导致绘制底层图形，然后是倒置部分的叠加。

# ruby-on-rails - 生产中的数据库连接问题

> ID：893492
> 
> 赞同：1
> 
> 时间：2009-05-21T15:16:22.583
> 
> 标签：ruby-on-rails, ruby

我的应用程序中有一个模型的单独数据库，在开发模式下连接正常工作，但在生产中却不是。

```
production:
  adapter: mysql
  host: myhost
  username: root
  password:
  database: production_db

users_production:
  adapter: mysql
  host: myhost
  username: root
  password:
  database: other_db 
```

连接到另一个数据库的模型称为 User 但它引用的表`other_db`是`smf_users`我的 User.rb 看起来像这样：

```
class User < ActiveRecord::Base
  establish_connection "users_#{RAILS_ENV}"
  set_table_name "smf_users"
end 
```

在生产中我收到此错误：

```
Mysql::Error: Table 'production_db. smf_users' doesn't exist: 
```

请注意它如何尝试连接到错误的数据库，因此找不到正确的表。正如我所说，这适用于开发模式。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T02:07:11.153

我发现在使用多个数据库时，在进行关联时会出现奇怪的错误。你有没有机会找到另一个模型，`belongs_to :users`并且你期望它能够正常工作？否则，您必须考虑缓存——Rails 很可能无法正确缓存额外数据库的连接数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:02:24.427

尝试：

```
establish_connection configurations[RAILS_ENV]["users_#{RAILS_ENV}"]
User.connection 
```

建立连接需要连接信息的哈希。如果来自 database.yml，这应该返回。

您可能需要检查您的日志中是否有如下消息：

“未配置 users_production 数据库”

如果 ActiveRecord::Base 在 database.yml 中找不到字符串配置，该消息将被抛出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T11:43:27.183

您可能会发现这很有用：http: [//magicmodels.rubyforge.org/magic_multi_connections/](http://magicmodels.rubyforge.org/magic_multi_connections/)

# c++ - Sun 的 C++ 编译器的“弃用”表示法？

> ID：893509
> 
> 赞同：3
> 
> 时间：2009-05-21T15:18:22.020
> 
> 标签：c++, deprecated, suncc

Sun 编译器是否具有将函数标记为已弃用的符号，例如 GCC`__attribute__ ((deprecated))`或 MSVC `__declspec(deprecated)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T01:07:34.953

似乎适用于**任何**支持的编译器的一种解决方案`#warning`是：

*   将有问题的标题复制到一个新的、提升的标题名称
*   从提升的头文件中删除不推荐使用的函数
*   添加到旧的头文件：**`#warning "This header is deprecated. Please use {new header name}"`**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:15:09.223

这将在带有“+w”标志的 sun 或带有“-Wall”标志的 gcc 上为您提供编译器警告。不幸的是，它破坏了函数的 ABI 兼容性；我还没有找到解决方法。

```
#define DEPRECATED char=function_is_deprecated()

inline char function_is_deprecated()
{
    return 65535;
}

void foo(int x, DEPRECATED)
{
}

int main()
{
    foo(3);
    return 0;
} 
```

输出：

```
CC -o test test.cpp +w
"test.cpp", line 7: Warning: Conversion of "int" value to "char" causes truncation.
"test.cpp", line 15:     Where: While instantiating "function_is_deprecated()".
"test.cpp", line 15:     Where: Instantiated from non-template code.
1 Warning(s) detected. 
```

使用它的方式是，当您想要声明一个已弃用的函数时，您在其参数列表的末尾添加一个逗号并写为 DEPRECATED。它在后台工作的方式是添加一个导致转换警告的默认参数（因此保留 API）。

# .net - 在 .Net Compact Framework 中获取调制解调器信息

> ID：893511
> 
> 赞同：1
> 
> 时间：2009-05-21T15:18:33.017
> 
> 标签：.net, compact-framework, serial-port, modem

我在 Windows Mobile 6 环境中使用 .Net Compact Framework，我需要获取调制解调器列表和它们所连接的串行端口。在完整的 .Net 框架中，可以使用 System.Management.ManagementObject 类轻松完成；但是，不幸的是，这在 .NET Compact Framework 中不可用，我还没有找到任何其他方法来做到这一点。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:14:48.363

通常可以在注册表中找到此类信息。我不确定哪些键会包含您需要的信息，但快速浏览后发现 \HKEY_LOCAL_MACHINE\ExtModems 列出了我的 WM6 设备上的一些调制解调器，每个调制解调器都有一个端口值。

# asp.net-mvc - 如何正确处理来自 asp.net-mvc 的不需要的访问（主要是 id 部分）

> ID：893513
> 
> 赞同：0
> 
> 时间：2009-05-21T15:18:35.263
> 
> 标签：asp.net-mvc

假设我有这个网址：

```
http://myweb/item/info/1 
```

有一个链接

```
http://myweb/item/edit/1 
```

而且我不希望用户手动更改为

```
http://myweb/item/edit/2 
```

我希望用户单击信息页面中的链接，以便他可以访问编辑页面。

你会怎么处理呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-21T15:22:57.143

就我个人而言，我不想阻止用户这样做。URL 在一种上下文中工作而不是在另一种上下文中工作并不是非常直观。

相反，我会确保用户有权编辑有问题的项目，作为“编辑”操作的控制器方法的一部分，如果他们没有，则重定向到错误页面。

# python - 在 Python 中替换 Microsoft Word 换行符

> ID：893514
> 
> 赞同：0
> 
> 时间：2009-05-21T15:19:08.663
> 
> 标签：python, ms-word, sanitize

这感觉应该很简单，但是我在清除从 Microsoft Word 粘贴的内容中的换行符时遇到了麻烦。不是完整的换行符，而是`CTRL ENTER`在 Word 中显示为返回箭头的字符。我已经尝试过`chr(10)`、`chr(13)`、`\u000D`和`\u000A`其他一些，但我无法在 string.replace() 中匹配它。我应该寻找不同的角色还是需要使用`string.replace`方法以外的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T15:24:51.413

运行这个：

```
print repr(mystringobject) 
```

这将提示您要删除哪个字符。

如果仍然没有线索，请将上述命令的结果粘贴到问题中，我将编辑我的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T15:31:36.283

您可以像这样获取字符的 ASCII 值：

```
for c in 'string':
    print ord(c), hex(ord(c)) 
```

一旦你知道代码，应该很容易杀死罪犯。

# sql - 检查日期范围的最快方法

> ID：893518
> 
> 赞同：1
> 
> 时间：2009-05-21T15:20:53.900
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我将事件存储在 SQLServer 2005 中，其中事件发生的时间很重要，并且必须存储在数据库中。在 where 子句中编写日期范围检查以确保选择当天的所有内容的最快方法是什么？

目前，当@DateStart 和@DateEnd 传入时，我将@DateStart 设置为午夜，并将@DateEnd 设置为午夜之前的最后一刻，作为捕捉当天所有可能事件的第一件事。

```
IF (@DateStart IS NOT NULL)
BEGIN
    SET @DateStart = CAST   (
                                (   CAST (DATEPART (yyyy,@DateStart) AS NVARCHAR(4)) +'/'+
                                    CAST (DATEPART (mm,@DateStart) AS NVARCHAR(2)) +'/'+
                                    CAST (DATEPART (dd,@DateStart) AS NVARCHAR(2)) +' '+
                                    '00:00:00.000'
                                )
                            AS DATETIME)
END

IF (@DateEnd IS NOT NULL)
BEGIN
    SET @DateEnd = CAST (
                            (   CAST (DATEPART (yyyy,@DateEnd) AS NVARCHAR(4)) +'/'+
                                CAST (DATEPART (mm,@DateEnd) AS NVARCHAR(2)) +'/'+
                                CAST (DATEPART (dd,@DateEnd) AS NVARCHAR(2)) +' '+
                                '23:59:59.997'
                            )
                            AS DATETIME
                        )
END 
```

所以 where 子句很容易阅读：

WHERE (EventDate >= @DateStart AND EventDate <= @DateEnd)

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T15:23:14.707

你总是可以使用的替代语法`WHERE EventDate BETWEEN @DateStart AND @DateEnd`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T16:09:35.333

你的 where 子句看起来像；

```
WHERE DateCol >= DATEADD(dd, DATEDIFF(dd, 0, @DateStart), 0) --Midnight on the Start date
    AND DateCol < DATEADD(dd, DATEDIFF(dd, 0, @DateEnd + 1), 0) --Midnight of the day after End date 
```

并且您的所有 IF 语句都会处理空参数（即 IF @DateEnd IS NULL THEN SET @DateEnd = @DateStart）

如果您的表很大，您可能希望在 DATEADD(dd, DATEDIFF(dd, 0, DateCol), 0) 上建立索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T15:29:52.137

截断日期的最快方法，前午夜：

DATEADD(天, DATEDIFF(天, '19010101', LastModifiedDate), '19010101')

下一个午夜：

DATEADD(天, DATEDIFF(天, '19010101', LastModifiedDate)+1, '19010101')

您也可以将其包装为内联 UDF：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/23/reuse-your-code-with-cross-apply.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/05/23/reuse-your-code-with-cross-apply.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T02:16:19.923

我认为这个 T-SQL 相当于您拥有的代码：

```
    -- 将@DateStart 的时间部分设置回午夜
    SET @DateStart = CONVERT(DATETIME,CONVERT(VARCHAR(10),@DateStart,20),20)

    -- 将@DateEnd 的时间部分提前到下一个午夜之前的最后一刻
    SET @DateEnd = CONVERT(DATETIME,CONVERT(VARCHAR(11),@DateEnd,20)+'23:59:59.997',21)

```

该`CONVERT`函数将处理 NULLS，因此不需要对 NULL 值进行单独测试（当然，除非您正在执行一些特殊处理而不是显示的内容，并且没有将 NULL 值传递给查询谓词（即WHERE 子句）。或者，您可能期望很多参数为 NULL，并且您希望避免调用 CONVERT 的开销。

但是，我同意 Tom H. 的建议，并避免弄乱减去毫秒，而是将 @DateEnd 设置为第二天的午夜，例如

```
    -- 将@DateEnd 提前到第二天的午夜
    SET @DateEnd = DATEADD(day,1,CONVERT(DATETIME,CONVERT(VARCHAR(10),@DateEnd,20),20))

```

并更改谓词以进行如下范围测试：

```
WHERE (EventDate >= @DateStart AND EventDate < @DateEnd) 
```

* * *

您可以避免单独的 SET 语句，并将表达式直接移动到查询中，但我不希望这会提高性能，并使 SQL 语句更难阅读，您肯定希望保留注释......

WHERE (EventDate >= CONVERT(DATETIME,CONVERT(VARCHAR(10),@DateStart,20),20) AND EventDate

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T15:29:08.767

尝试这个：

```
WHERE DATEPART(yyyy, EventDate) = DATEPART(yyyy, getdate()) 
      AND DATEPART(dy, EventDate) = DATEPART(dy, getdate())  --day of year 
```

编辑解决 Tom H 的评论：我从来没有在日期字段上使用过索引；对我来说总是更好的是额外的整数列来处理年份和年份值，并改为索引这些值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T16:09:22.850

AlexK 可能是最好的主意。我唯一担心的是在谓词中使用函数的性能。

您应该考虑在表中添加一个名为 searchdate 的列或类似的列，以包含不含时间的日期。我还建议为该列编制索引，尤其是在您要大量搜索该列的数据时。

当您查询此列时，您的 SQL 中不会有任何标量函数来剥夺索引的性能。

缺点...好吧，额外的存储空间，插入期间写入数据的时间（虽然这里不多）。

SQL Server 2008 对仅日期数据类型有更好的支持。你也可以检查一下。

# c# - 适合初学者的 LINQ

> ID：893524
> 
> 赞同：9
> 
> 时间：2009-05-21T15:21:48.110
> 
> 标签：c#, linq

我爱 C#，我爱框架，我也爱尽可能多地学习。今天我开始阅读有关 C# 中 LINQ 的文章，对于一个一生中从未使用过 SQL 的初学者来说，我找不到任何好的东西。

我发现[这篇](http://www.programmersheaven.com/2/CSharp3-4)文章很有帮助，并且我理解了其中的一小部分，但我想获得更多示例。

在阅读了几次之后，我尝试在我的一个函数中使用 LINQ，但我失败了。

```
 private void Filter(string filename)
    {
        using (TextWriter writer = File.CreateText(Application.StartupPath + "\\temp\\test.txt"))
        {
            using(TextReader reader = File.OpenText(filename))
            {
                string line;
                while((line = reader.ReadLine()) != null)
                {
                    string[] items = line.Split('\t');
                    int myInteger = int.Parse(items[1]);
                    if (myInteger == 24809) writer.WriteLine(line); 
                }
            }
        }
    } 
```

这就是我所做的，但没有奏效，结果总是错误的。

```
 private void Filter(string filename)
    {
        using (TextWriter writer = File.CreateText(Application.StartupPath + "\\temp\\test.txt"))
        {
            using(TextReader reader = File.OpenText(filename))
            {
                string line;
                while((line = reader.ReadLine()) != null)
                {
                    string[] items = line.Split('\t');
                    var Linqi = from item in items
                                where int.Parse(items[1]) == 24809
                                select true;
                    if (Linqi == true) writer.WriteLine(line); 
                }
            }
        }
    } 
```

我要求两件事：

1.  使用尽可能多的 Linq 函数看起来如何？
2.  关于 Linq 的网站/书籍/文章，但请注意我是 sql/linq 的一个不错的初学者。

先感谢您！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-21T15:38:10.700

好吧，可以使您的示例更“LINQy”的一件事是`IEnumerable<string>`用于从文件中读取行。[这是我的MiscUtil](http://pobox.com/~skeet/csharp/miscutil)`LineReader`课程的简化版本：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;

public sealed class LineReader : IEnumerable<string>
{
    readonly Func<TextReader> dataSource;

    public LineReader(string filename)
        : this(() => File.OpenText(filename))
    {
    }

    public LineReader(Func<TextReader> dataSource)
    {
        this.dataSource = dataSource;
    }

    public IEnumerator<string> GetEnumerator()
    {
        using (TextReader reader = dataSource())
        {
            string line;
            while ((line = reader.ReadLine()) != null)
            {
                yield return line;
            }
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
} 
```

现在你可以使用它：

```
 var query = from line in new LineReader(filename)
                let items = line.Split('\t')
                let myInteger int.Parse(items[1]);
                where myInteger == 24809
                select line;

    using (TextWriter writer = File.CreateText(Application.StartupPath 
                                               + "\\temp\\test.txt"))
    {
        foreach (string line in query)
        {
            writer.WriteLine(line);
        }
    } 
```

请注意，没有`let`子句可能会更有效：

```
 var query = from line in new LineReader(filename)
                where int.Parse(line.Split('\t')[1]) == 24809
                select line; 
```

在这一点上，你可以合理地用“点符号”来做这一切：

```
 var query = new LineReader(filename)
                        .Where(line => int.Parse(line.Split('\t')[1]) == 24809); 
```

但是，我更喜欢原始查询的可读性:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-21T15:26:16.603

[101 LINQ Samples](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)无疑是一个很好的示例集合。[LINQPad](http://www.linqpad.net/)也可能是使用 LINQ 的好方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-21T15:25:29.773

对于一个网站作为起点，您可以尝试[Hooked on LINQ](http://www.hookedonlinq.com/)

**编辑**：
原始网站现在似乎已经死了（域名正在出售）。

这是最后一个版本的互联网档案：[https ://web.archive.org/web/20140823041217/http://www.hookdonlinq.com/](https://web.archive.org/web/20140823041217/http://www.hookedonlinq.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T15:51:32.780

如果您想要一本书，我发现[Manning Publications的](http://manning.com/)[LINQ in action](http://www.amazon.co.uk/LINQ-Action-Fabrice-Marguerie/dp/1933988169/ref=sr_1_1?ie=UTF8&s=books&qid=1242920845&sr=1-1)是一个不错的起点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T15:34:41.423

如果我在可能的情况下使用 LINQ 重写您的过滤器函数，它看起来像这样：

```
private void Filter(string filename)
{
    using (TextWriter writer = File.CreateText(Application.StartupPath + "\\temp\\test.txt"))
    {
        var lines = File.ReadAllLines(filename);
        var matches = from line in lines
                      let items = line.Split('\t')
                      let myInteger = int.Parse(items[1]);
                      where myInteger == 24809
                      select line;

        foreach (var match in matches)
        {
            writer.WriteLine(line)
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T15:36:18.957

要回答第一个问题，坦率地说，除了作为练习之外，没有太多理由按照您在上述函数中建议的方式使用 LINQ。事实上，它可能只是让函数更难阅读。

LINQ 在对集合进行操作时比对单个元素更有用，我会以这种方式使用它。所以，这是我在函数中使用*尽可能多的 LINQ*的尝试（不提效率，我*不*建议像这样将整个文件读入内存）：

```
private void Filter(string filename)
{
    using (TextWriter writer = File.CreateText(Application.StartupPath + "\\temp\\test.txt"))
    {
        using(TextReader reader = File.OpenText(filename))
        {
            List<string> lines;
            string line;
            while((line = reader.ReadLine()) != null)
                lines.Add(line);

            var query = from l in lines
                        let splitLine = l.Split('\t')
                        where int.Parse(splitLine.Skip(1).First()) == 24809
                        select l;

            foreach(var l in query)               
                writer.WriteLine(l); 
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T15:49:21.987

首先，我将介绍这种方法：

```
private IEnumerable<string> ReadLines(StreamReader reader)
{
    while(!reader.EndOfStream)
    {
        yield return reader.ReadLine();
    }
} 
```

然后，我会重构使用它的主要方法。我将两个`using`语句放在同一个块之上，还添加了一个范围检查以确保`items[1]`不会失败：

```
private void Filter(string fileName)
{
    using(var writer = File.CreateText(Application.StartupPath + "\\temp\\test.txt"))
    using(var reader = File.OpenText(filename))
    {
        var myIntegers =
            from line in ReadLines(reader)
            let items = line.Split('\t')
            where items.Length > 1
            let myInteger = Int32.Parse(items[1])
            where myInteger == 24809
            select myInteger;

        foreach(var myInteger in myIntegers)
        {
            writer.WriteLine(myInteger);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T16:56:02.867

我发现这篇文章对于理解 LINQ 非常重要，它基于 .NET 3.0 和 3.5 中引入的许多新结构：

我会警告你这是一篇很长的文章，但如果你真的想了解 Linq 是什么，我相信它是必不可少的

[http://blogs.msdn.com/ericwhite/pages/FP-Tutorial.aspx](http://blogs.msdn.com/ericwhite/pages/FP-Tutorial.aspx)

快乐阅读

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T15:27:00.893

MSDN LINQ 示例：http: [//msdn.microsoft.com/en-us/vcsharp/aa336746.aspx](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-21T15:28:00.470

当我开始时，我从以下网站中获得了很多：

[http://msdn.microsoft.com/en-us/library/bb425822.aspx](http://msdn.microsoft.com/en-us/library/bb425822.aspx)

[http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx](http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T16:02:43.160

至于 Linq 书籍，我建议：

[![](https://i.stack.imgur.com/ENhFS.jpg)](http://linqinaction.net/)
[（来源：[ebookpdf.net](http://www.ebookpdf.net/screen/cover2/51n4fa2xxvl_083.jpg)）]
   [http://www.diesel-ebooks.com/mas_assets/full/0321564189.jpg](https://www.amazon.ca/Essential-LINQ-Charlie-Calvert/dp/0321564162/)

这两本书都是深入了解 Linq 的优秀书籍。

要为 as-much-linq-as-possible 主题添加另一个变体，这是我的看法：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;

namespace LinqDemo
{
    class Program
    {
        static void Main()
        {
            var baseDir = AppDomain.CurrentDomain.BaseDirectory;
            File.WriteAllLines(
                Path.Combine(baseDir, "out.txt"),
                File.ReadAllLines(Path.Combine(baseDir, "in.txt"))
                    .Select(line => new KeyValuePair<string, string[]>(line, line.Split(','))) // split each line into columns, also carry the original line forward
                    .Where(info => info.Value.Length > 1) // filter out lines that don't have 2nd column
                    .Select(info => new KeyValuePair<string, int>(info.Key, int.Parse(info.Value[1]))) // convert 2nd column to int, still carrying the original line forward
                    .Where(info => info.Value == 24809) // apply the filtering criteria
                    .Select(info => info.Key) // restore original lines
                    .ToArray());
        }
    }
} 
```

请注意，我将您的制表符分隔列更改为逗号分隔列（在将制表符转换为空格的编辑器中更容易创作；-)）。当此程序针对输入文件运行时：

```
A1,2
B,24809,C
C

E
G,24809 
```

输出将是：

```
B,24809,C
G,24809 
```

您可以通过用 Jon Skeet 的 LineReader 替换“File.ReadAllLines”和“File.WriteAllLines”来提高此解决方案的内存要求（以及类似的 LineWriter，采用 IEnumerable 并将每个返回的项目作为新行写入输出文件）。这会将上面的解决方案从“将所有行作为数组放入内存，过滤它们，在内存中为结果创建另一个数组并将此结果写入输出文件”转换为“从输入文件中逐行读取行，如果行符合我们的标准，立即将其写入输出文件”（管道方法）。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-21T15:31:15.613

不能只检查 Linqi 是否为真...Linqi 是一个`IEnumerable<bool>`（在这种情况下）所以必须检查像`Linqi.First() == true`

这是一个小例子：

```
string[] items = { "12121", "2222", "24809", "23445", "24809" };

                        var Linqi = from item in items
                                    where Convert.ToInt32(item) == 24809
                                    select true;
                        if (Linqi.First() == true) Console.WriteLine("Got a true"); 
```

您也可以遍历 Linqi，在我的示例中，集合中有 2 个项目。

# c# - 在命令行使用 aspnet_compiler 抑制编译器警告

> ID：893525
> 
> 赞同：2
> 
> 时间：2009-05-21T15:21:53.760
> 
> 标签：c#, .net, aspnet-compiler

在命令行中使用 aspnet_compiler.exe 警告时，是否有抑制特定编译器警告的开关？

我已经尝试自己修复错误，而不是忽略它们 - 它们适用于从未使用过的事件。我只是注释掉了这些事件，但这导致了其他问题！就好像它们已被使用但编译器无法识别（这似乎不太可能）。

我正在从命令行调用编译器，并且正在使用 Visual Web Developer Express，它在 Visual Studio 完整版中的“项目属性构建”对话框中没有详细的构建选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T13:11:30.747

最后我用了

```
#pragma warning disable [warning no]
    some code that triggers a warning
#pragma warning enable [warning no] 
```

在我的代码中，根据[http://msdn.microsoft.com/en-us/library/441722ys.aspx](http://msdn.microsoft.com/en-us/library/441722ys.aspx)。这工作正常，虽然需要为每个编译器警告输入一次，但它似乎是最合适的。

# iis-7 - 限制来自 IIS7 中单一来源的 HTTP 连接数？

> ID：893532
> 
> 赞同：13
> 
> 时间：2009-05-21T15:23:52.943
> 
> 标签：iis-7

IIS7 中是否有办法限制单一来源允许的 HTTP 连接数？我们偶尔会遇到轻微的拒绝服务攻击，我们可以通过对任何单个 IP 允许的连接数量进行一些限制来防止这种攻击。我知道这可能会影响一些合法请求，但我们将阈值设置得相当高。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T22:18:15.383

啊! 我想我找到了。这个[http://blogs.iis.net/ruslany/archive/2009/02/16/dynamic-ip-restrictions-for-iis-7-0-beta.aspx](http://blogs.iis.net/ruslany/archive/2009/02/16/dynamic-ip-restrictions-for-iis-7-0-beta.aspx)是我正在寻找的。

谢谢大家。

标记

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T14:43:41.743

这是扩展的最新主页：[http ://www.iis.net/downloads/microsoft/dynamic-ip-restrictions](http://www.iis.net/downloads/microsoft/dynamic-ip-restrictions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:30:13.773

在 IIS 中网站的属性下，单击性能并选择限制为的连接数。

# python - 如何为 Python 脚本定义系统范围的别名？

> ID：893543
> 
> 赞同：2
> 
> 时间：2009-05-21T15:27:01.923
> 
> 标签：python, macos

我正在使用 Mac OS X 并且我有一个 Python 脚本，它将被其他脚本和程序（尤其是 Apple 的 launchd）调用。我可以用

```
python /Users/xyz/long/absolute/path/to/script.py arg1 arg2 
```

由于脚本的位置可能会改变，我想将其他脚本和 launchd 配置文件与实际位置分离，以便对脚本的调用看起来像

```
script arg1 arg2 
```

在 $HOME/.bash_profile 中为 Bash 定义别名不起作用，因为 launchd 不知道别名。

定义“系统范围别名”或类似名称的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T15:29:19.407

我通常会创建一个符号链接并将其放在 /usr/bin 中（假设 /usr/bin 是您的 PATH 的一部分）

（在终端中。根据权限，您可能必须使用*sudo ln -s 。*

```
ln -s /Users/xyz/long/absolute/path/to/script.py /usr/bin/script.py 
```

如果您接受[Rory 的建议](https://stackoverflow.com/questions/893543/how-to-define-a-system-wide-alias-for-a-python-script/893563#893563)并将 #!/usr/bin/python 放在脚本的开头，您还需要使脚本可执行。

```
chmod a+x /Users/xyz/long/absolute/path/to/script.py 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T15:31:24.240

除了进行符号链接之外，您还可以将“#！/path/to/python”放在脚本的开头并使其成为可执行文件。然后你不必用“python /Users/big/long/path/script.py”来调用它

# c# - ASP.NET MVC 页面无法加载并显示“找不到资源”

> ID：893552
> 
> 赞同：35
> 
> 时间：2009-05-21T15:29:15.647
> 
> 标签：c#, asp.net, asp.net-mvc

我在尝试打开我的 ASP.NET MVC 应用程序时遇到问题，但我得到了 ASP.NET 错误页面，上面写着：

> “/”应用程序中的服务器错误。
> 
> 无法找到该资源。说明：HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请查看以下 URL 并确保其拼写正确。
> 
> 请求的 URL：/EventScheduler/account.aspx/login
> 
> 版本信息：Microsoft .NET Framework 版本：2.0.50727.3053；ASP.NET 版本：2.0.50727.3053**

我正在使用此博客文章中的 URL 技巧，这就是为什么我在 URL 中有 .aspx：

[http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)

它可以在我的其他沙盒服务器（不是开发机器）上运行，现在我只是将它作为新的虚拟目录部署到我的生产站点，但由于某种原因，它似乎实际上是在寻找一个 .aspx 文件。

有任何想法吗？我想我一定是忘记了一步。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-07-27T08:57:50.110

I got the same error when building. The default is to use URLRoute settings for navigating. If you select the "Set as Startup Page" property by right clicking any cshtml page, that throws this error because there are always a routing to the current page under the Global.asax file.

Look at Project Properties for Startup Path and delete it.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-06-06T22:08:05.237

我找到了解决这个问题的方法，你不必删除 global.asax，因为它包含一些有价值的信息，可以让你的项目顺利运行，而是看看你的控制器的名字，在我的例子中，我的控制器被命名MyController.cs 之类的东西，在 global.asax 中，它试图引用一个 Home Controller。

在全局 asax 中查找此行

```
routes.MapRoute(
   "Default", // Route name
   "{controller}/{action}/{id}", // URL with parameters
   new { controller = "Home", action = "Index", id = UrlParameter.Optional } 
```

就我而言，我必须这样才能工作

```
 new { controller = "My", action = "Index", id = UrlParameter.Optional } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-21T15:38:42.697

确保您没有告诉 IIS 在提供文件之前检查并查看文件是否存在。这个已经咬了我好几次了。请执行下列操作：

打开 IIS 管理器。右键单击您的 MVC 网站，然后单击属性。打开虚拟目录选项卡。单击配置...按钮。在通配符应用程序映射下，确保您有一个到`c:\windows\microsoft.net\framework\v2.0.50727\aspnet_isapi.dll`. 确保未选中“验证文件是否存在”！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-10T05:55:18.963

如果您运行的是 IIS 6 及更高版本，请确保应用程序池您的 MVC 应用程序。正在使用设置为**集成**托管管道模式。我错误地将我的设置为 Classic，并且发生了同样的错误。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-04T22:42:30.423

您应该仔细检查您的路线值。

```
routes.MapRoute(
   "Default", // Route name
   "{controller}/{action}/{id}", // URL with parameters
   new { controller = "Home", action = "Index", id = UrlParameter.Optional } 
```

在这种情况下，请确保您拥有 Controller 'Home'，因为如果没有具有 Index Action 的 HomeController，应用程序将无法加载。就我而言，我有 HomesController，但我错过了 Home 前面的“s”。我修复了名称不匹配问题，这解决了我的本地环境和服务器上的问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-06-20T23:20:08.267

找不到页面，因为关联的控制器没有退出。只需创建特定的控制器。如果您尝试显示主页并使用 Visual Studio 2015，请按照以下步骤操作：

1.  右键单击 Controller 文件夹，然后选择 Add > Controller；
2.  选择 MVC 5 控制器 - 空；
3.  点击添加；
4.  将 HomeController 设置为控制器名称；
5.  构建项目，然后再次运行您的项目

我希望这有帮助

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-02T15:45:54.070

有同样的问题，在我的情况下，原因是虚拟目录文件夹中缺少 web.config 文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-04T07:26:07.130

我在构建 MVC 应用程序时遇到了同样的错误。
在我的情况下，它发生是因为我忘记在我的控制器名称中添加字符串“Controller”。

### 错误与

```
public class ProductType : BaseController
{
    public ProductType()
    {
    }
} 
```

### 解决

```
public class ProductTypeController : BaseController
{
    public ProductTypeController ()
    {
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-16T09:19:03.983

第 1 步：检查您是否收到以下更新？[http://support.microsoft.com/kb/894670](http://support.microsoft.com/kb/894670)如果您有，您可能希望按照此程序操作，看看它是否适合您。它部分地为我工作。它提到要删除的附加“/”的项目并不完全正确，但它确实让我对更改我的项目属性有所了解。

第 2 步：在您的 Solun 中右键单击 Web 项目的属性。选择 WEB > 选择当前页面而不是特定页面。

第 3 步：进入您的项目，在其中保留 *.aspx 的选择起始页。（应该与当前页面相同或选择另一个您选择的页面：））点击调试运行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-09-04T07:34:17.357

在您的项目中打开 Global.asax.cs 然后右键单击 Method RouteConfig.RegisterRoutes(RouteTable.Routes); 然后单击转到定义，`defaults: new { controller = "Home", action = "Index", id =UrlParameter.Optional}` 然后将“主页”的名称更改为您自己的控制器名称和索引，如果您更改了除“HomeController”和“索引”以外的名称，希望您的问题将得到解决。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-07T09:10:28.683

需要确保两件事：

1）在文件`Route`中应该是正确的`Global.ascx`

2）不要忘记`Controller Project`在您的`Web Project`（**视图与控制器在单独的项目中**）添加引用

第二个是我的情况。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-11T11:59:17.547

假设从其他地方复制源代码。

有时，如果您在应用程序 url 中使用虚拟目录，例如：

```
http://localhost:50385/myapp/#/ 
```

没有路由会接收请求。

解决方案：

显式单击项目文件中的“创建虚拟目录”按钮。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-03-12T14:52:26.350

转到您想在浏览器中查看的任何页面，右键单击-> 在浏览器中查看。这样和我一起工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-05-21T09:55:57.990

经过数小时的调试，这只是我的 html 视图中的一个 c# 错误。检查您的视图并追踪任何错误

不要使用 html 样式注释 c# 代码，即

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-18T13:27:57.040

对我来说，它解决了以下步骤：

发生这种情况的一个原因是您的 Web 项目的属性下没有设置起始页或错误的起始页。所以这样做：

1-右键单击您的 MVC 项目

2-选择“属性”

3-选择“网络”选项卡

4-选择“特定页面”

假设您有一个名为 HomeController 的控制器和一个名为 Index 的操作方法，请在与“特定页面”单选按钮对应的文本框中输入“home/index”。

现在，如果您启动 Web 应用程序，它将带您到 HomeController 的 Index 操作方法呈现的视图。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-12-16T07:57:27.317

就我而言，我需要替换它：

```
@Html.ActionLink("Return license", "Licenses_Revoke", "Licenses", new { id = userLicense.Id }, null) 
```

有了这个：

```
<a href="#" onclick="returnLicense(event)">Return license</a>

<script type="text/javascript">
    function returnLicense(e) {
        e.preventDefault();

        $.post('@Url.Action("Licenses_Revoke", "Licenses", new { id = Model.Customer.AspNetUser.UserLicenses.First().Id })', getAntiForgery())
            .done(function (res) {
                window.location.reload();
            });
    }
</script> 
```

即使我不明白为什么。欢迎提出建议！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-02-02T08:51:41.783

它需要您添加一个 Web 表单，只需添加属性 -> 新项目 -> Web 表单。然后你运行它，它会工作。简单的

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-05-22T09:43:43.510

请记住对 ActionResult 使用 PUBLIC：

```
public ActionResult Details(int id)
{
    return View();
} 
```

代替

```
 ActionResult Details(int id)
 {
     return View();
 } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-16T13:29:27.143

我有一个类似的问题。但是我在本地使用 Episerver 并启用了 ssl。当我没有得到

> “/”应用程序中的服务器错误。

我收到不安全的连接错误。最后，对我来说，[PluralSight](https://www.pluralsight.com/guides/visual-studio-2017-resolving-ssl-tls-connections-problems-with-iis-express)上的这篇文章以及配置网站 url，相应地在项目配置上设置的 ssl 链接，在管理员的[管理网站](https://webhelp.episerver.com/16-8/cms-admin/managing-websites.htm)屏幕上解决了这个问题。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-04-09T05:59:12.110

打开您的`Controller.cs`文件并在您的附近`public ActionResult Index()`，而不是`Index`写下您要在浏览器中运行的页面的名称。对我来说是`public ActionResult Login()`。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-07-21T06:15:19.247

您必须检查您是否在控制器中实现了页面，例如：

```
 public ActionResult Register()
        {
            return View();
        } 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2016-09-15T17:09:00.320

我在下面的脚本中遇到了同样的问题。问题是由 url 变量引起的。当我添加[http://|web](http://|web)服务器名称|/|应用程序名称| 在 /Reports/ReportPage.aspx ... 它开始工作了。

```
<script>
    $(document).ready(function () {
        DisplayReport();
    });

    function DisplayReport() {
        var url = '/Reports/ReportPage.aspx?ReportName=AssignmentReport';

        if (url === '')
            return;
        var myFrame = document.getElementById('frmReportViewer');
        if (myFrame !== null) {
            if (myFrame.contentWindow !== null && myFrame.contentWindow.location !== null) {
                myFrame.contentWindow.location = url;
            }
            else {
                myFrame.setAttribute('src', url);
            }
        }
    }
</script>
```

# java - 有没有办法在 JSP 页面中显示 HSSFWorkbook 对象？

> ID：893556
> 
> 赞同：0
> 
> 时间：2009-05-21T15:29:49.717
> 
> 标签：java, jsp, apache-poi, poi-hssf

有没有办法在 JSP 页面中显示一个 HSSFWorkbook 对象，而在服务器端没有输出文件？在下面的代码中，我提供了**net.sf.jxls.transformer.XLSTransformer.transformXLS(InputStream is, Map beanParams)**所需的模板文件和 bean，以返回一个 HSSFWorkbook 对象。我现在需要一种在 JSP 中使用此对象的方法，而不必使用 OutputStream 将输出文件存储在服务器端。

```
InputStream is = new BufferedInputStream(new FileInputStream(templateFileName));
HSSFWorkbook hm = transformer.transformXLS(is, beans);
req.getSession().setAttribute("excelWorkBook",hm); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:39:42.567

看起来很简单，使用实例上的 write 方法编写 HSSFWorkbook；

```
HSSFWorkbook#write(OutputStream) 
```

其中输出流是；

```
response.getOutputStream() 
```

你可能想做一些事情，比如设置响应的 ContentType 以及一些内容处置属性。

# c# - 为什么 BindingList 添加成员时会抛出 System.ArgumentException

> ID：893568
> 
> 赞同：1
> 
> 时间：2009-05-21T15:33:57.557
> 
> 标签：c#, exception, bindinglist

我有一个绑定列表，在某些难以重现的条件下，当向其中添加值时会引发以下异常：

> System.ArgumentException：复杂 DataBinding 接受 IList 或 IListSource 作为数据源。在 System.ComponentModel.ReflectPropertyDescriptor.SetValue(Object component, Object value)
> 在 System.Windows.Forms.Binding.SetPropValue(Object value)
> 在 System.Windows.Forms.Binding.PushData(Boolean force)
> 在 System.Windows.Forms。 System.Windows.Forms.CurrencyManager.CurrencyManager_PushData() 上 System.Windows.Forms.CurrencyManager.OnItemChanged(ItemChangedEventArgs e)上 System.Windows.Forms.BindingManagerBase.PushData
> ( ) 上的BindingManagerBase.PushData(Boolean&success) 。 Forms.CurrencyManager.List_ListChanged（对象发送者，ListChangedEventArgs e）
> 
> 在 System.ComponentModel.ListChangedEventHandler.Invoke(Object sender, ListChangedEventArgs e)
> 在 System.ComponentModel.BindingList 1.InsertItem(Int32 index, T item) 在 System.Collections.ObjectModel.Collection`1.Add(T item) ...`1.OnListChanged(ListChangedEventArgs e)
> at System.ComponentModel.BindingList`

我可以理解它是在创建列表时发生的，还是在更改其中一个属性时发生的，但这只发生在向它添加某些值时。它声明如下：

```
private BindingList<IBusinessObject> _bindingList = new BindingList<IBusinessObject>(); 
```

然后像这样稍后使用（这是抛出异常的地方）：

```
_bindingList.Add(myBusinessObject); 
```

更糟糕的是，这发生在以前工作的生产代码中，这里涉及的代码最近都没有被编辑过。我怀疑这是某种微妙的数据交互问题，这也是它很少发生的原因，但坦率地说，我很茫然，因为异常的起源点在 .Net 内部深处。

**更新**：它实际上不是单个表单，而是用于支持多个表单/对话框的对象模型的一部分。这是非常复杂的代码，而不是我编写的代码，只是在维护/增强。深入研究代码后，似乎 BindingList 被添加到更多域对象中，并最终用于使用对象的字符串属性填充 ImageListBox。有问题的字符串不应为空或空白，但由于代码所在的位置以及难以重现附加调试器验证的错误将是有问题的。空值是否会导致 BindingList 在问题实际所在位置如此遥远的位置引发异常？在最终将其作为数据源分配给相关的 ImageListBox 列表之前，该对象实际上被插入到 3 个或 4 个其他对象/集合中（即使这样，它也取决于其他几个选择，以确定最终是哪个 BindingList 对象用于填充列表）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:30:22.647

看起来您将某种列表控件的 DataSource 属性绑定到 IBusinessObject 的属性，并且该属性返回的值作为 DataSource 无效。您能否更具体地了解您在此表单上使用的所有绑定？

# php - 为什么我的 AJAX 验证码不能正常工作？

> ID：893571
> 
> 赞同：-1
> 
> 时间：2009-05-21T15:34:40.987
> 
> 标签：php, javascript, ajax

我制作了一个依赖于 PHP、AJAX 和 Javascript 的网站。
这里的问题是网站不稳定，这意味着有时验证工作正常，有时根本不工作。
验证代码是用 JavaScript 编写的。这是否意味着我们需要更多的特殊条件？

验证代码：

```
<script language=Javascript>
function Inint_AJAX() {
try { return new ActiveXObject("Msxml2.XMLHTTP");  } catch(e) {} //IE
try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch(e) {} //IE
try { return new XMLHttpRequest();  } catch(e) {} //Native Javascript
alert("XMLHttpRequest not supported");
return null;
};

function dochange(src, val) 
{
 var req = Inint_AJAX();
 req.onreadystatechange = function () 
 {
      if (req.readyState==4) 
      {
           if (req.status==200) 
           {    
                document.getElementById(src).innerHTML=req.responseText;
           }
      }
 };
 req.open("GET", "traditional_locate.php?data="+src+"&val="+val);
  req.send(null);
}

window.onLoad=dochange('cities', -1); 

function submitform()
{
 if(document.form1.onsubmit())
 {
    document.form1.submit();
 }
}

function validate()
{
  var p_o_box=(document.form1.p_o_box.value);
  var owner_name=(document.form1.owner_name.value);
  var cities=(document.form1.cities.value);
  var post_office=(document.form1.post_office.value);   

        if(cities == 0)
        {
            alert("Please Choose city");
            document.form1.cities.focus();
            return false;
        }

        else if(post_office == 0)
            {
            alert("Please Choose post office");
            document.form1.post_office.focus();

            return false;
            }

            else if (p_o_box=="")
                {
                    alert ("Please Write P.O.Box");
                    document.form1.p_o_box.focus();
                        return false;                       
                } 

                else if(owner_name=="")
                        {
                        alert("Please Write Owner Name");
                        return false;
                        }

                    else if(p_o_box!="")
                        {
                                var a=new Array;

                             <?php
                                session_start();                                    
                                $zipinfo=$_SESSION[zip_code];                                   
                                $conn=mysql_connect('localhost','root','');
                                mysql_select_db('post_db',$conn);
                                $query="select p_o_box from p_o_box where zip_code='$zipinfo' ";
                                $result = mysql_query ($query , $conn ) or die ( mysql_error ());
                                $rows=mysql_num_rows($result);
                                $n = array();
                                for($i=0;$i<$rows;$i++)
                                {
                                    $data=mysql_fetch_row($result);
                                    $n[] = $data[0]; 
                                }

                                for($i=0;$i<count($n); $i++)
                                {
                                    echo "a[$i]='".$n[$i]."';\n";
                                }           
                                ?>

                                var ss=0;
                                for(i=0;i<a.length;i++)

                                if(a[i]==p_o_box)
                                    {
                                        var ss=1;
                                    }

                                 if (ss==0)
                                    {
                                        alert('not correct p.o. box');
                                        document.form1.p_o_box.focus();
                                          return false;
                                   }
                                else
                                     {  return true;}

                        }                       

    return true;        
}

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:03:54.767

很难回答，因为我没有看到任何问题。究竟什么不起作用？

但我可以假设一些问题：

*   你确定，那 body.onload 运行？有时候不...
*   脚本不是跨浏览器
*   session_start() 应该失败，因为之前有输出并且无法发送标头。
*   你说验证失败，但它在哪里被调用？

请提供更准确的问题和更清晰的代码示例（即我不确定，submitform() 的来源是否如此重要）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:44:23.930

验证应该在服务器端完成。当用户禁用他们的 JavaScript 时会发生什么？

此外，该 JavaScript 块只会在页面加载时执行 PHP，而不是在每次用户验证时执行。

# java - jpa 继承和 OneToMany 关系

> ID：893574
> 
> 赞同：2
> 
> 时间：2009-05-21T15:35:15.183
> 
> 标签：java, inheritance, jpa, aggregation

我写了以下代码：

```
@Entity
@Table(name="person")
@Inheritance(strategy=InheritanceType.JOINED)
public class Person {

    private Long id;

    protected String email;
    private String firstName;
    private String lastName;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    public Long getId() {
        return id;
    }

...

}

@Entity
@Table(name="users")
@ForeignKey(name="userPersonId")
public class User extends Person  {

    private String userName;
    private String password;
    private Date registrationDate;
    private Set<? extends Person> contacts;

    @OneToMany(targetEntity = com.blah.Person.class ,fetch = FetchType.LAZY, cascade=CascadeType.ALL)
    @ForeignKey(name="contactId")
    @JoinColumn(name="contactId")
    public Set<? extends Person> getContacts() {
        return contacts;
    }

...

} 
```

一个用户是一个人，一个用户可以有一组“人”（Person-s），它想保持联系。因此，我在这里拥有的是继承（用户派生 Person）和聚合关系（用户包含 Person-s）。

就数据库表而言，我希望有 3 个表：

1.  人
2.  用户
3.  接触

联系人表包含用户表和人员表的外键。实际上，我只有以下两个表（个人和用户）： [alt text http://picasaweb.google.com/yaneeve.shekel/ProgrammingRelated#5338298839877393922](http://picasaweb.google.com/yaneeve.shekel/ProgrammingRelated#5338298839877393922)

我想我的一些注释不正确......我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:39:24.830

在写上面的问题时，我发现我的关系是多对多的，因为一个人可能是许多用户的联系人，而一个用户当然可以有很多联系人。

这是解决所有问题的代码：

```
@Entity
@Table(name="users")
@ForeignKey(name="userPersonId")
public class User extends Person  {

    private String userName;
    private String password;
    private Date registrationDate;
    private Set<? extends Person> contacts;

    @ManyToMany(targetEntity = com.blah.Person.class, fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @ForeignKey(name = "contactUserId", inverseName = "contactPersonId")
    @JoinTable(name = "contact", joinColumns = {@JoinColumn(name = "userId")}, inverseJoinColumns = {@JoinColumn(name = "personId")})
    public Set<? extends Person> getContacts() {
        return contacts;
    }

...

} 
```

我现在得到了我期望的三个表： [alt text http://picasaweb.google.com/yaneeve.shekel/ProgrammingRelated#5338298840732620802](http://picasaweb.google.com/yaneeve.shekel/ProgrammingRelated#5338298840732620802)

1.  人
2.  用户
3.  接触

# xml - 如何在 Bash 中解析 XML？

> ID：893585
> 
> 赞同：155
> 
> 时间：2009-05-21T15:36:53.277
> 
> 标签：xml, bash, xhtml, shell, xpath

理想情况下，我希望能够做的是：

```
cat xhtmlfile.xhtml |
getElementViaXPath --path='/html/head/title' |
sed -e 's%(^<title>|</title>$)%%g' > titleOfXHTMLPage.txt 
```

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2011-08-13T17:36:56.123

这实际上只是对[Yuzem](https://stackoverflow.com/users/312866/yuzem "尤泽姆")答案的解释，但我觉得不应该对其他人进行这么多的编辑，并且评论不允许格式化，所以......

```
rdom () { local IFS=\> ; read -d \< E C ;} 
```

让我们称其为“read_dom”而不是“rdom”，将其隔开一点并使用更长的变量：

```
read_dom () {
    local IFS=\>
    read -d \< ENTITY CONTENT
} 
```

好的，所以它定义了一个名为 read_dom 的函数。第一行使 IFS（输入字段分隔符）成为该函数的局部变量，并将其更改为 >。这意味着当您读取数据而不是自动按空格、制表符或换行符拆分时，它会按“>”拆分。下一行表示从标准输入读取输入，而不是在换行处停止，而是在看到“<”字符时停止（-d 表示分隔符标志）。然后使用 IFS 拆分读取的内容并分配给变量 ENTITY 和 CONTENT。所以采取以下措施：

```
<tag>value</tag> 
```

`read_dom`获取空字符串的第一次调用（因为 '<' 是第一个字符）。IFS 将其拆分为 ''，因为没有 '>' 字符。Read 然后为这两个变量分配一个空字符串。第二次调用获取字符串'tag>value'。然后由 IFS 将其拆分为两个字段“标签”和“值”。读取然后分配变量，如：`ENTITY=tag`和`CONTENT=value`。第三次调用得到字符串'/tag>'。IFS 将其拆分为两个字段“/tag”和“”。读取然后分配变量，如：`ENTITY=/tag`和`CONTENT=`。第四个调用将返回非零状态，因为我们已经到达文件末尾。

现在他的while循环清理了一点以匹配上面的内容：

```
while read_dom; do
    if [[ $ENTITY = "title" ]]; then
        echo $CONTENT
        exit
    fi
done < xhtmlfile.xhtml > titleOfXHTMLPage.txt 
```

第一行只是说，“当 read_dom 函数返回零状态时，请执行以下操作。” 第二行检查我们刚刚看到的实体是否是“title”。下一行回显了标签的内容。四线出口。如果它不是标题实体，则循环在第六行重复。我们将“xhtmlfile.xhtml”重定向到标准输入（对于`read_dom`函数），并将标准输出重定向到“titleOfXHTMLPage.txt”（循环前面的回显）。

现在给出以下内容（类似于您在 S3 上列出存储桶所获得的内容）`input.xml`：

```
<ListBucketResult xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
  <Name>sth-items</Name>
  <IsTruncated>false</IsTruncated>
  <Contents>
    <Key>item-apple-iso@2x.png</Key>
    <LastModified>2011-07-25T22:23:04.000Z</LastModified>
    <ETag>&quot;0032a28286680abee71aed5d059c6a09&quot;</ETag>
    <Size>1785</Size>
    <StorageClass>STANDARD</StorageClass>
  </Contents>
</ListBucketResult> 
```

和以下循环：

```
while read_dom; do
    echo "$ENTITY => $CONTENT"
done < input.xml 
```

你应该得到：

```
 => 
ListBucketResult xmlns="http://s3.amazonaws.com/doc/2006-03-01/" => 
Name => sth-items
/Name => 
IsTruncated => false
/IsTruncated => 
Contents => 
Key => item-apple-iso@2x.png
/Key => 
LastModified => 2011-07-25T22:23:04.000Z
/LastModified => 
ETag => &quot;0032a28286680abee71aed5d059c6a09&quot;
/ETag => 
Size => 1785
/Size => 
StorageClass => STANDARD
/StorageClass => 
/Contents => 
```

所以如果我们写一个`while`像 Yuzem 的循环：

```
while read_dom; do
    if [[ $ENTITY = "Key" ]] ; then
        echo $CONTENT
    fi
done < input.xml 
```

我们将获得 S3 存储桶中所有文件的列表。

**编辑** 如果由于某种原因`local IFS=\>`对您不起作用并且您在全局范围内设置它，您应该在函数末尾重置它，例如：

```
read_dom () {
    ORIGINAL_IFS=$IFS
    IFS=\>
    read -d \< ENTITY CONTENT
    IFS=$ORIGINAL_IFS
} 
```

否则，您稍后在脚本中进行的任何行分割都会搞砸。

**编辑 2** 要拆分属性名称/值对，您可以`read_dom()`像这样增加：

```
read_dom () {
    local IFS=\>
    read -d \< ENTITY CONTENT
    local ret=$?
    TAG_NAME=${ENTITY%% *}
    ATTRIBUTES=${ENTITY#* }
    return $ret
} 
```

然后编写你的函数来解析并获取你想要的数据，如下所示：

```
parse_dom () {
    if [[ $TAG_NAME = "foo" ]] ; then
        eval local $ATTRIBUTES
        echo "foo size is: $size"
    elif [[ $TAG_NAME = "bar" ]] ; then
        eval local $ATTRIBUTES
        echo "bar type is: $type"
    fi
} 
```

然后当你`read_dom`打电话时`parse_dom`：

```
while read_dom; do
    parse_dom
done 
```

然后给出以下示例标记：

```
<example>
  <bar size="bar_size" type="metal">bars content</bar>
  <foo size="1789" type="unknown">foos content</foo>
</example> 
```

你应该得到这个输出：

```
$ cat example.xml | ./bash_xml.sh 
bar type is: metal
foo size is: 1789 
```

**EDIT 3**另一个[用户](https://stackoverflow.com/users/1486208/andi "和我")说他们在 FreeBSD 中遇到了问题，并建议从 read 中保存退出状态并在 read_dom 结束时返回它，例如：

```
read_dom () {
    local IFS=\>
    read -d \< ENTITY CONTENT
    local RET=$?
    TAG_NAME=${ENTITY%% *}
    ATTRIBUTES=${ENTITY#* }
    return $RET
} 
```

我看不出有什么理由不应该这样做

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2010-04-09T14:13:13.497

只使用 bash 就可以很容易地做到这一点。您只需添加此功能：

```
rdom () { local IFS=\> ; read -d \< E C ;} 
```

现在您可以像 read 一样使用 rdom，但对于 html 文档。调用 rdom 时，会将元素分配给变量 E，将内容分配给 var C。

例如，做你想做的事：

```
while rdom; do
    if [[ $E = title ]]; then
        echo $C
        exit
    fi
done < xhtmlfile.xhtml > titleOfXHTMLPage.txt 
```

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-05-21T18:18:38.847

可以从 shell 脚本调用的命令行工具包括：

*   [4xpath - Python 的](http://infinitesque.net/projects/4Suite/docs/commandline/4xpath.html)[4Suite](http://infinitesque.net/projects/4Suite/docs/)包的命令行包装器

*   [XMLStarlet](http://xmlstar.sf.net)

*   xpath - Perl 的 XPath 库的命令行包装器

    ```
    sudo apt-get install libxml-xpath-perl 
    ```

*   [Xidel](http://videlibri.sourceforge.net/xidel.html#downloads) - 适用于 URL 和文件。也适用于 JSON

我还使用带有少量 XSL 转换脚本的 xmllint 和 xsltproc 从命令行或 shell 脚本中进行 XML 处理。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2012-04-24T15:03:55.943

您可以使用 xpath 实用程序。它与 Perl XML-XPath 包一起安装。

用法：

```
/usr/bin/xpath [filename] query 
```

或[XMLStarlet](http://www.ibm.com/developerworks/library/x-starlet/index.html)。要在 opensuse 上安装它，请使用：

```
sudo zypper install xmlstarlet 
```

`cnf xml`或在其他平台上尝试。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-01-05T10:33:58.247

这已经足够了……

```
xpath xhtmlfile.xhtml '/html/head/title/text()' > titleOfXHTMLPage.txt 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-11-07T15:31:22.210

从[http://www.ofb.net/~egnor/xml2/](http://www.ofb.net/~egnor/xml2/)查看**XML2** ，它将 XML 转换为面向行的格式。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-01-29T12:44:16.637

从乍得的回答开始，这里是解析 UML 的完整工作解决方案，对注释进行适当处理，只有 2 个小功能（超过 2 个，您可以将它们全部混合）。我并不是说 chad 的那个根本没有用，但是它对于格式错误的 XML 文件有太多的问题：所以你必须更加棘手地处理注释和错位的空格/CR/TAB/等。

这个答案的目的是为任何需要解析 UML 的人提供即用型、开箱即用的 bash 函数，而无需使用 perl、python 或其他任何复杂工具。至于我，我无法为我正在开发的旧生产操作系统安装 cpan 和 perl 模块，并且 python 不可用。

首先，本文中使用的 UML 词的定义：

```
<!-- comment... -->
<tag attribute="value">content...</tag> 
```

**编辑：更新的功能，处理：**

*   Websphere xml（xmi 和 xmlns 属性）
*   必须有 256 色的兼容终端
*   24 级灰色
*   为 IBM AIX bash 3.2.16(1) 添加了兼容性

## 函数，首先是由 xml_read 递归调用的 xml_read_dom：

```
xml_read_dom() {
# https://stackoverflow.com/questions/893585/how-to-parse-xml-in-bash
local ENTITY IFS=\>
if $ITSACOMMENT; then
  read -d \< COMMENTS
  COMMENTS="$(rtrim "${COMMENTS}")"
  return 0
else
  read -d \< ENTITY CONTENT
  CR=$?
  [ "x${ENTITY:0:1}x" == "x/x" ] && return 0
  TAG_NAME=${ENTITY%%[[:space:]]*}
  [ "x${TAG_NAME}x" == "x?xmlx" ] && TAG_NAME=xml
  TAG_NAME=${TAG_NAME%%:*}
  ATTRIBUTES=${ENTITY#*[[:space:]]}
  ATTRIBUTES="${ATTRIBUTES//xmi:/}"
  ATTRIBUTES="${ATTRIBUTES//xmlns:/}"
fi

# when comments sticks to !-- :
[ "x${TAG_NAME:0:3}x" == "x!--x" ] && COMMENTS="${TAG_NAME:3} ${ATTRIBUTES}" && ITSACOMMENT=true && return 0

# http://tldp.org/LDP/abs/html/string-manipulation.html
# INFO: oh wait it doesn't work on IBM AIX bash 3.2.16(1):
# [ "x${ATTRIBUTES:(-1):1}x" == "x/x" -o "x${ATTRIBUTES:(-1):1}x" == "x?x" ] && ATTRIBUTES="${ATTRIBUTES:0:(-1)}"
[ "x${ATTRIBUTES:${#ATTRIBUTES} -1:1}x" == "x/x" -o "x${ATTRIBUTES:${#ATTRIBUTES} -1:1}x" == "x?x" ] && ATTRIBUTES="${ATTRIBUTES:0:${#ATTRIBUTES} -1}"
return $CR
} 
```

第二个：

```
xml_read() {
# https://stackoverflow.com/questions/893585/how-to-parse-xml-in-bash
ITSACOMMENT=false
local MULTIPLE_ATTR LIGHT FORCE_PRINT XAPPLY XCOMMAND XATTRIBUTE GETCONTENT fileXml tag attributes attribute tag2print TAGPRINTED attribute2print XAPPLIED_COLOR PROSTPROCESS USAGE
local TMP LOG LOGG
LIGHT=false
FORCE_PRINT=false
XAPPLY=false
MULTIPLE_ATTR=false
XAPPLIED_COLOR=g
TAGPRINTED=false
GETCONTENT=false
PROSTPROCESS=cat
Debug=${Debug:-false}
TMP=/tmp/xml_read.$RANDOM
USAGE="${C}${FUNCNAME}${c} [-cdlp] [-x command <-a attribute>] <file.xml> [tag | \"any\"] [attributes .. | \"content\"]
${nn[2]}  -c = NOCOLOR${END}
${nn[2]}  -d = Debug${END}
${nn[2]}  -l = LIGHT (no \"attribute=\" printed)${END}
${nn[2]}  -p = FORCE PRINT (when no attributes given)${END}
${nn[2]}  -x = apply a command on an attribute and print the result instead of the former value, in green color${END}
${nn[1]}  (no attribute given will load their values into your shell; use '-p' to print them as well)${END}"

! (($#)) && echo2 "$USAGE" && return 99
(( $# < 2 )) && ERROR nbaram 2 0 && return 99
# getopts:
while getopts :cdlpx:a: _OPT 2>/dev/null
do
{
  case ${_OPT} in
    c) PROSTPROCESS="${DECOLORIZE}" ;;
    d) local Debug=true ;;
    l) LIGHT=true; XAPPLIED_COLOR=END ;;
    p) FORCE_PRINT=true ;;
    x) XAPPLY=true; XCOMMAND="${OPTARG}" ;;
    a) XATTRIBUTE="${OPTARG}" ;;
    *) _NOARGS="${_NOARGS}${_NOARGS+, }-${OPTARG}" ;;
  esac
}
done
shift $((OPTIND - 1))
unset _OPT OPTARG OPTIND
[ "X${_NOARGS}" != "X" ] && ERROR param "${_NOARGS}" 0

fileXml=$1
tag=$2
(( $# > 2 )) && shift 2 && attributes=$*
(( $# > 1 )) && MULTIPLE_ATTR=true

[ -d "${fileXml}" -o ! -s "${fileXml}" ] && ERROR empty "${fileXml}" 0 && return 1
$XAPPLY && $MULTIPLE_ATTR && [ -z "${XATTRIBUTE}" ] && ERROR param "-x command " 0 && return 2
# nb attributes == 1 because $MULTIPLE_ATTR is false
[ "${attributes}" == "content" ] && GETCONTENT=true

while xml_read_dom; do
  # (( CR != 0 )) && break
  (( PIPESTATUS[1] != 0 )) && break

  if $ITSACOMMENT; then
    # oh wait it doesn't work on IBM AIX bash 3.2.16(1):
    # if [ "x${COMMENTS:(-2):2}x" == "x--x" ]; then COMMENTS="${COMMENTS:0:(-2)}" && ITSACOMMENT=false
    # elif [ "x${COMMENTS:(-3):3}x" == "x-->x" ]; then COMMENTS="${COMMENTS:0:(-3)}" && ITSACOMMENT=false
    if [ "x${COMMENTS:${#COMMENTS} - 2:2}x" == "x--x" ]; then COMMENTS="${COMMENTS:0:${#COMMENTS} - 2}" && ITSACOMMENT=false
    elif [ "x${COMMENTS:${#COMMENTS} - 3:3}x" == "x-->x" ]; then COMMENTS="${COMMENTS:0:${#COMMENTS} - 3}" && ITSACOMMENT=false
    fi
    $Debug && echo2 "${N}${COMMENTS}${END}"
  elif test "${TAG_NAME}"; then
    if [ "x${TAG_NAME}x" == "x${tag}x" -o "x${tag}x" == "xanyx" ]; then
      if $GETCONTENT; then
        CONTENT="$(trim "${CONTENT}")"
        test ${CONTENT} && echo "${CONTENT}"
      else
        # eval local $ATTRIBUTES => eval test "\"\$${attribute}\"" will be true for matching attributes
        eval local $ATTRIBUTES
        $Debug && (echo2 "${m}${TAG_NAME}: ${M}$ATTRIBUTES${END}"; test ${CONTENT} && echo2 "${m}CONTENT=${M}$CONTENT${END}")
        if test "${attributes}"; then
          if $MULTIPLE_ATTR; then
            # we don't print "tag: attr=x ..." for a tag passed as argument: it's usefull only for "any" tags so then we print the matching tags found
            ! $LIGHT && [ "x${tag}x" == "xanyx" ] && tag2print="${g6}${TAG_NAME}: "
            for attribute in ${attributes}; do
              ! $LIGHT && attribute2print="${g10}${attribute}${g6}=${g14}"
              if eval test "\"\$${attribute}\""; then
                test "${tag2print}" && ${print} "${tag2print}"
                TAGPRINTED=true; unset tag2print
                if [ "$XAPPLY" == "true" -a "${attribute}" == "${XATTRIBUTE}" ]; then
                  eval ${print} "%s%s\ " "\${attribute2print}" "\${${XAPPLIED_COLOR}}\"\$(\$XCOMMAND \$${attribute})\"\${END}" && eval unset ${attribute}
                else
                  eval ${print} "%s%s\ " "\${attribute2print}" "\"\$${attribute}\"" && eval unset ${attribute}
                fi
              fi
            done
            # this trick prints a CR only if attributes have been printed durint the loop:
            $TAGPRINTED && ${print} "\n" && TAGPRINTED=false
          else
            if eval test "\"\$${attributes}\""; then
              if $XAPPLY; then
                eval echo "\${g}\$(\$XCOMMAND \$${attributes})" && eval unset ${attributes}
              else
                eval echo "\$${attributes}" && eval unset ${attributes}
              fi
            fi
          fi
        else
          echo eval $ATTRIBUTES >>$TMP
        fi
      fi
    fi
  fi
  unset CR TAG_NAME ATTRIBUTES CONTENT COMMENTS
done < "${fileXml}" | ${PROSTPROCESS}
# http://mywiki.wooledge.org/BashFAQ/024
# INFO: I set variables in a "while loop" that's in a pipeline. Why do they disappear? workaround:
if [ -s "$TMP" ]; then
  $FORCE_PRINT && ! $LIGHT && cat $TMP
  # $FORCE_PRINT && $LIGHT && perl -pe 's/[[:space:]].*?=/ /g' $TMP
  $FORCE_PRINT && $LIGHT && sed -r 's/[^\"]*([\"][^\"]*[\"][,]?)[^\"]*/\1 /g' $TMP
  . $TMP
  rm -f $TMP
fi
unset ITSACOMMENT
} 
```

最后，rtrim、trim 和 echo2（到 stderr）函数：

```
rtrim() {
local var=$@
var="${var%"${var##*[![:space:]]}"}"   # remove trailing whitespace characters
echo -n "$var"
}
trim() {
local var=$@
var="${var#"${var%%[![:space:]]*}"}"   # remove leading whitespace characters
var="${var%"${var##*[![:space:]]}"}"   # remove trailing whitespace characters
echo -n "$var"
}
echo2() { echo -e "$@" 1>&2; } 
```

## 着色：

哦，你首先需要定义一些整洁的着色动态变量，然后导出：

```
set -a
TERM=xterm-256color
case ${UNAME} in
AIX|SunOS)
  M=$(${print} '\033[1;35m')
  m=$(${print} '\033[0;35m')
  END=$(${print} '\033[0m')
;;
*)
  m=$(tput setaf 5)
  M=$(tput setaf 13)
  # END=$(tput sgr0)          # issue on Linux: it can produces ^[(B instead of ^[[0m, more likely when using screenrc
  END=$(${print} '\033[0m')
;;
esac
# 24 shades of grey:
for i in $(seq 0 23); do eval g$i="$(${print} \"\\033\[38\;5\;$((232 + i))m\")" ; done
# another way of having an array of 5 shades of grey:
declare -a colorNums=(238 240 243 248 254)
for num in 0 1 2 3 4; do nn[$num]=$(${print} "\033[38;5;${colorNums[$num]}m"); NN[$num]=$(${print} "\033[48;5;${colorNums[$num]}m"); done
# piped decolorization:
DECOLORIZE='eval sed "s,${END}\[[0-9;]*[m|K],,g"' 
```

## 如何加载所有这些东西：

您要么知道如何创建函数并通过 FPATH (ksh) 或 FPATH (bash) 的仿真来加载它们

如果没有，只需在命令行上复制/粘贴所有内容。

## 它是如何工作的：

```
xml_read [-cdlp] [-x command <-a attribute>] <file.xml> [tag | "any"] [attributes .. | "content"]
  -c = NOCOLOR
  -d = Debug
  -l = LIGHT (no \"attribute=\" printed)
  -p = FORCE PRINT (when no attributes given)
  -x = apply a command on an attribute and print the result instead of the former value, in green color
  (no attribute given will load their values into your shell as $ATTRIBUTE=value; use '-p' to print them as well)

xml_read server.xml title content     # print content between <title></title>
xml_read server.xml Connector port    # print all port values from Connector tags
xml_read server.xml any port          # print all port values from any tags 
```

使用调试模式 (-d) 将注释和解析的属性打印到 stderr

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-03-27T00:27:21.457

另一个命令行工具是我的新[Xidel](http://videlibri.sourceforge.net/xidel.html)。它还支持 XPath 2 和 XQuery，这与已经提到的 xpath/xmlstarlet 不同。

标题可以这样读：

```
xidel xhtmlfile.xhtml -e /html/head/title > titleOfXHTMLPage.txt 
```

它还有一个很酷的功能，可以将多个变量导出到 bash。例如

```
eval $(xidel xhtmlfile.xhtml -e 'title := //title, imgcount := count(//img)' --output-format bash ) 
```

设置`$title`为文件中的标题和`$imgcount`图像的数量，这应该和直接在 bash 中解析一样灵活。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-21T15:43:58.190

我不知道有任何纯 shell XML 解析工具。因此，您很可能需要使用其他语言编写的工具。

我的 XML::Twig Perl 模块带有这样一个工具: `xml_grep`，您可能会在其中编写您想要的内容`xml_grep -t '/html/head/title' xhtmlfile.xhtml > titleOfXHTMLPage.txt`（该`-t`选项将结果作为文本而不是 xml 提供给您）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-21T15:39:23.927

好吧，您可以使用 xpath 实用程序。我猜 perl 的 XML::Xpath 包含它。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-10-24T01:00:37.027

在对 XML 文件中文件路径的 Linux 和 Windows 格式之间的转换进行了一些研究之后，我发现了一些有趣的教程和解决方案：

*   [关于 XPath 的一般信息](http://www.w3schools.com/xpath/)
*   Amara - 用于 XML 的 Pythonic 工具集合
*   使用 4Suite 开发 Python/XML（2 部分）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-10-25T14:53:51.893

虽然有很多现成的控制台实用程序可以满足您的需求，但使用 Python 等通用编程语言编写几行代码可能会花费更少的时间，您可以轻松扩展和适应这些语言您的需求。

这是一个[`lxml`](http://lxml.de/)用于解析的 python 脚本——它将文件名或 URL 作为第一个参数，一个 XPath 表达式作为第二个参数，并打印与给定表达式匹配的字符串/节点。

# 示例 1

```
#!/usr/bin/env python
import sys
from lxml import etree

tree = etree.parse(sys.argv[1])
xpath_expression = sys.argv[2]

#  a hack allowing to access the
#  default namespace (if defined) via the 'p:' prefix    
#  E.g. given a default namespaces such as 'xmlns="http://maven.apache.org/POM/4.0.0"'
#  an XPath of '//p:module' will return all the 'module' nodes
ns = tree.getroot().nsmap
if ns.keys() and None in ns:
    ns['p'] = ns.pop(None)
#   end of hack    

for e in tree.xpath(xpath_expression, namespaces=ns):
    if isinstance(e, str):
        print(e)
    else:
        print(e.text and e.text.strip() or etree.tostring(e, pretty_print=True)) 
```

`lxml`可以安装`pip install lxml`。在 ubuntu 上，您可以使用`sudo apt install python-lxml`.

### 用法

```
python xpath.py myfile.xml "//mynode" 
```

`lxml`还接受 URL 作为输入：

```
python xpath.py http://www.feedforall.com/sample.xml "//link" 
```

> **注意**：如果您的 XML 有一个没有前缀的默认命名空间（例如`xmlns=http://abc...`），那么您必须`p`在表达式中使用前缀（由“hack”提供），例如`//p:module`从`pom.xml`文件中获取模块。如果`p`前缀已经映射到您的 XML 中，那么您需要修改脚本以使用另一个前缀。

* * *

# 示例 2

一次性脚本，用于从 apache maven 文件中提取模块名称的狭隘目的。请注意节点名称 ( `module`) 如何以默认命名空间为前缀`{http://maven.apache.org/POM/4.0.0}`：

*pom.xml*：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modules>
        <module>cherries</module>
        <module>bananas</module>
        <module>pears</module>
    </modules>
</project> 
```

*module_extractor.py*：

```
from lxml import etree
for _, e in etree.iterparse(open("pom.xml"), tag="{http://maven.apache.org/POM/4.0.0}module"):
    print(e.text) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-01-24T00:46:44.783

Yuzem 的方法可以通过反转函数中的`<`和`>`符号的顺序`rdom`以及变量赋值来改进，这样：

```
rdom () { local IFS=\> ; read -d \< E C ;} 
```

变成：

```
rdom () { local IFS=\< ; read -d \> C E ;} 
```

如果没有像这样进行解析，则永远不会到达 XML 文件中的最后一个标记。如果您打算在`while`循环结束时输出另一个 XML 文件，这可能会出现问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-06-16T16:53:18.413

如果您需要 XML 属性，则此方法有效：

```
$ cat alfa.xml
<video server="asdf.com" stream="H264_400.mp4" cdn="limelight"/>

$ sed 's.[^ ]*..;s./>..' alfa.xml > alfa.sh

$ . ./alfa.sh

$ echo "$stream"
H264_400.mp4 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-09T17:48:16.893

虽然看起来“永远不要在没有适当工具的情况下从 bash 解析 XML、JSON...”是合理的建议，但我不同意。如果这是副业，那么寻找合适的工具并学习它是一件很麻烦的事情……Awk 可以在几分钟内完成。我的程序必须处理所有上述和更多类型的数据。地狱，如果我能在几分钟内解决问题，我不想测试 30 种工具来解析我需要的 5-7-10 种不同格式。我不关心 XML、JSON 什么的！我需要一个解决方案来解决所有问题。

举个例子：我的 SmartHome 程序运行我们的家。在执行此操作时，它会以我无法控制的太多不同格式读取过多的数据。我从不使用专门的、合适的工具，因为我不想花超过几分钟的时间来阅读我需要的数据。通过 FS 和 RS 调整，这个 awk 解决方案完美适用于任何文本格式。但是，当您的主要任务是主要处理该格式的大量数据时，这可能不是正确的答案！

我昨天遇到的从 bash 解析 XML 的问题。以下是我对任何分层数据格式的处理方式。作为奖励 - 我将数据直接分配给 bash 脚本中的变量。

为了便于阅读，我将分阶段提出解决方案。从 OP 测试数据中，我创建了一个文件：test.xml

在 bash 中解析所述 XML 并以 90 个字符提取数据：

```
awk 'BEGIN { FS="<|>"; RS="\n" }; /host|username|password|dbname/ { print $2, $4 }' test.xml 
```

我通常使用更具可读性的版本，因为它在现实生活中更容易修改，因为我经常需要进行不同的测试：

```
awk 'BEGIN { FS="<|>"; RS="\n" }; { if ($0 ~ /host|username|password|dbname/) print $2,$4}' test.xml 
```

我不在乎格式是如何调用的。我只寻求最简单的解决方案。在这种特殊情况下，我可以从数据中看到换行符是记录分隔符 (RS) 和 <> 分隔字段 (FS)。在我原来的情况下，我在两条记录中对 6 个值进行了复杂的索引，将它们关联起来，查找数据何时存在以及字段（记录）可能存在也可能不存在。用了 4 行 awk 就完美解决了这个问题。所以，在使用之前根据每个需求调整想法！

第二部分简单地查看一行（RS）中有需要的字符串，如果是，则打印出所需的字段（FS）。以上我花了大约 30 秒来复制和适应我以这种方式使用的最后一个命令（长 4 倍）。就是这样！在 90 个字符内完成。

但是，我总是需要将数据整齐地放入脚本中的变量中。我首先像这样测试构造：

```
awk 'BEGIN { FS="<|>"; RS="\n" }; { if ($0 ~ /host|username|password|dbname/) print $2"=\""$4"\"" }' test.xml 
```

在某些情况下，我使用 printf 而不是 print。当我看到一切看起来都很好时，我只是完成了为变量赋值。我知道很多人认为“eval”是“邪恶的”，无需评论 :) Trick 多年来在我的所有四个网络上都能完美运行。但是，如果您不明白为什么这可能是不好的做法，请继续学习！包括 bash 变量分配和足够的间距，我的解决方案需要 120 个字符来完成所有操作。

```
eval $( awk 'BEGIN { FS="<|>"; RS="\n" }; { if ($0 ~ /host|username|password|dbname/) print $2"=\""$4"\"" }' test.xml ); echo "host: $host, username: $username, password: $password dbname: $dbname" 
```

# asp.net - wcf：将用户名添加到消息头是否安全？

> ID：893588
> 
> 赞同：3
> 
> 时间：2009-05-21T15:37:32.387
> 
> 标签：asp.net, wcf, web-services, security

我正在连接到 ASP.NET 应用程序中的 WCF 服务。我正在使用一个用户名和密码登录，并将登录到 ASP.NET Web 应用程序的用户的实际用户名传递到消息头中，如下所示。

```
 using (OperationContextScope scope = new OperationContextScope(myService2.InnerChannel))
  {
    Guid myToken = Guid.NewGuid();

    MessageHeader<string> messageHeader = new MessageHeader<string>(HttpContext.Current.User.Identity.Name);
    MessageHeader untyped = messageHeader.GetUntypedHeader("token", "ns");

    OperationContext.Current.OutgoingMessageHeaders.Add(untyped);

    lblResult.Text = myService2.GetData(1231);
  } 
```

我也在使用如下服务证书

```
 <serviceCredentials>
        <serviceCertificate findValue="CN=tempCert" />
        <userNameAuthentication userNamePasswordValidationMode="MembershipProvider"
          membershipProviderName="MySqlMembershipProvider" />
      </serviceCredentials> 
```

我担心的是这种保护是否足以阻止人们获取存储在消息头中的用户名？

ASP.NET 配置是

```
 <system.serviceModel>
    <behaviors>
        <endpointBehaviors>
            <behavior name="NewBehavior">
                <clientCredentials>
                    <serviceCertificate>
                        <authentication revocationMode="NoCheck"/>
                    </serviceCertificate>
                </clientCredentials>
            </behavior>
        </endpointBehaviors>
    </behaviors>
    <bindings>
        <wsHttpBinding>
            <binding name="wsHttpEndpoint" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true" allowCookies="false">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384"/>
                <reliableSession ordered="true" inactivityTimeout="00:10:00" enabled="false"/>
                <security mode="Message">
                    <transport clientCredentialType="Windows" proxyCredentialType="None" realm=""/>
                    <message clientCredentialType="UserName" negotiateServiceCredential="true" algorithmSuite="Default" establishSecurityContext="true"/>
                </security>
            </binding>
        </wsHttpBinding>
    </bindings>
    <client>
        <endpoint address="http://localhost/WCFTestService/Service.svc" behaviorConfiguration="NewBehavior" binding="wsHttpBinding" bindingConfiguration="wsHttpEndpoint" contract="WCFTestService.IService" name="wsHttpEndpoint">
            <identity>
                <certificate encodedValue=""/>
            </identity>
        </endpoint>
    </client>
</system.serviceModel> 
```

在服务端

```
 <system.serviceModel>
<bindings>
  <wsHttpBinding>
    <binding name="wsHttpEndpointBinding">
      <security>
        <message clientCredentialType="UserName" />
      </security>
    </binding>
  </wsHttpBinding>
</bindings>
<services>
  <service behaviorConfiguration="ServiceBehavior" name="Service">
    <endpoint address="" binding="wsHttpBinding" bindingConfiguration="wsHttpEndpointBinding"
      name="wsHttpEndpoint" contract="IService">
      <!--<identity>
        <dns value="" />
      </identity>-->
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="ServiceBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
      <serviceCredentials>
        <serviceCertificate findValue="CN=tempCert" />
        <userNameAuthentication userNamePasswordValidationMode="MembershipProvider"
          membershipProviderName="MySqlMembershipProvider" />
      </serviceCredentials>
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:53:46.677

最大的问题是：您的绑定是否启用了任何类型的传输级或消息级安全性？你用的是什么绑定？

如果您具有传输级别的安全性（通常通过使用 SSL 上的 HTTPS），那么您将拥有一个我认为非常安全的点对点加密传输通道。

如果您在客户端上也使用证书具有消息级别的安全性，并且您确实加密了整个消息，那么您也应该是安全的。

它实际上归结为您正在使用的绑定以及您在该绑定上使用的安全设置。向我们展示服务器的配置！

马克

# wpf - xml 应用程序资源值

> ID：893593
> 
> 赞同：0
> 
> 时间：2009-05-21T15:37:56.283
> 
> 标签：wpf, xaml, resources

我想设置一个应用程序范围的值，即 TextHeight （其他也是），我似乎找不到参考。IOW，将文本高度设置为各种样式的静态资源等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:42:41.643

读完这个问题后，我的大脑有点疼。让我回答，好像我真的明白你在问什么。

```
<Application x:Class="WpfApplication1.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    StartupUri="Window1.xaml">
    <Application.Resources>
        <Style TargetType="TextBox">
            <Setter Property="FontSize" Value="100"/>
        </Style>
    </Application.Resources>
</Application> 
```

* * *

澄清：

```
<Application x:Class="WpfApplication1.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    StartupUri="Window1.xaml">
    <Application.Resources>
        <sys:Double x:Key="MyTextHeight">32</sys:Double>
        <Style TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource MyTextHeight}"/>
        </Style>
    </Application.Resources>
</Application> 
```

注意第 4 行，然后是新的 Double （还要注意类型必须与参数的类型匹配——我最初尝试 sys:Int32 导致一些有趣的不相关异常）。

# css - Firebug 和 CSS 缓存没有显示新的选择器

> ID：893597
> 
> 赞同：0
> 
> 时间：2009-05-21T15:39:03.957
> 
> 标签：css, django, firebug, selector

我对 Firebug 中的一些行为感到困惑。

我正在尝试更新我的 CSS，我对实际的 CSS 文件进行了更改并保存了它们。

如果我更新现有选择器上的指令，这些更改将在我重新加载页面时呈现。但是，如果我添加一个新类（例如 boxQuestion ）并创建一个新选择器，它根本不会呈现。新的选择器似乎根本没有显示。既不在呈现的 HTML 中，也不在 Firebug 显示的内容中。

我已经尝试清除缓存并重新启动我的开发服务器，但它仍然不会添加新的选择器。

我究竟做错了什么？

我在 Django 中开发并使用 runserver。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T18:27:45.427

要尝试的事情

1.  双击浏览器刷新按钮以获取新的 CSS
2.  重新启动开发服务器
3.  退出 Firebug 并重新启动浏览器
4.  查看您的开发服务器是否是服务器正确的 CSS 文件和选择器 [http://localhost:8000/media/liquid.css](http://localhost:8000/media/liquid.css)

最重要的是： 5\. 使用 CSS 验证器验证您的 CSS：

```
 http://jigsaw.w3.org/css-validator/ 
```

我在类选择器之前的 CSS 文件中有一些注释。我刚刚使用 # 来注释评论。这是不正确的 CSS 语法

当我用 /* #comment */ 包围评论时，问题就消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T15:45:18.453

可能您的 CSS 不正确。您的更改是否出现在源视图中？

# asp.net - 以编程方式在 ASP.NET 的 DataGrid 中模拟 CTRL+A？

> ID：893601
> 
> 赞同：0
> 
> 时间：2009-05-21T15:39:28.823
> 
> 标签：asp.net

我需要像按键 CTRL+A 一样选择整个 DataGrid。例如：不是用鼠标选择数据网格，用户只需单击一个按钮，数据网格就会被选中。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:57:52.767

虽然我无法想象这样的目的，但听起来你需要为此使用 javascript。向页面添加一个按钮/链接，然后使用类似[此脚本](http://codingtricks.blogspot.com/2009/02/javascript-select-or-highlight-text.html)的内容突出显示/选择 DataGrid 中的所有文本。

# iphone - 如何从 iPhone 应用程序链接到 iTunes 商店？

> ID：893604
> 
> 赞同：9
> 
> 时间：2009-05-21T15:40:26.827
> 
> 标签：iphone, objective-c, itunes-store

我正在尝试设置一个应用程序，用户可以在其中[流式传输音乐](https://stackoverflow.com/questions/893263/best-way-to-stream-mp3-from-an-iphone-app)。当用户流式传输 MP3 时，我想设置一个指向 iTunes 商店的链接以购买 MP3。

我怎样才能做到这一点？我觉得应该有一些使用歌曲标题和艺术家姓名的简单方法，我弄错了吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T15:40:47.340

您可以试用 Apple 提供的[iTMS Link Maker](http://ax.phobos.apple.com.edgesuite.net/WebObjects/MZStoreServices.woa/wa/itmsLinkMaker)并查看链接是如何形成的。此外，[这里是 iTMS Link Maker 常见问题解答](http://www.apple.com/itunes/linkmaker/faq/)。

请参阅[此博客文章](http://nslog.com/2003/04/29/itms_links)，了解如何自动查询 iTMS Link Maker。基本上，您可以查询 iTMS Link Maker 并获取您的应用程序可以处理的 XML 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-14T19:07:42.003

[iTunes Store Web Service Search API](http://www.apple.com/itunesaffiliates/API/AffiliatesSearch2.1.pdf) (pdf) 虽然陈旧且不完整，但记录了如何在iTunes Store 中搜索内容并返回带有结果的 JSON 字符串。

> iTunes Store Web Service Search API 允许您在您的网站中放置搜索字段以搜索 iTunes Store 中的内容。您可以搜索各种 iTunes Store 内容；包括电影、播客、音乐、音乐视频、有声读物和电视节目。您还可以调用基于 ID 的查找请求来创建内容库和 iTunes Store 内容库之间的映射。

查询被发送到基本 url：

```
http://ax.phobos.apple.com.edgesuite.net/WebObjects/MZStoreServices.woa/wa/wsSearch?parameterkeyvalue 
```

> 其中*parameterkeyvalue*可以是一个或多个参数键值对，指示查询的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T05:47:10.580

好的，我遇到了同样的问题，这里的答案没有给我足够的信息。于是我用不同的措辞再次问了这个问题，并继续寻找答案。我最终在另一个问题中回答了我自己的问题，并在那里发布了执行此操作的代码。

您可以在以下位置找到问题：

[打开 iTunes Store 到特定歌曲](https://stackoverflow.com/questions/14598577/opening-itunes-store-to-specific-song/14619249#14619249)

它包含打开 iTunes Store 到由歌曲名称和歌曲艺术家指定的特定歌曲所需的所有代码。

我希望这可以帮助别人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-03T13:40:57.510

创建到应用商店的链接可能会非常有问题。我建议您使用一个名为[iLink](https://www.cocoacontrols.com/controls/ilink)的简单库，这是我在为这个确切问题搜索解决方案时发现的。它会找出一切并创建您需要的始终有效的链接。另一个很棒的事情是它非常易于使用。

# authentication - SWT AuthenticationListener Eclipse

> ID：893606
> 
> 赞同：0
> 
> 时间：2009-05-21T15:40:38.853
> 
> 标签：authentication, browser, swt, listener

有没有人真正使用过 SWT 中的 AuthenticationListener 类？我下载了名为“eclipse-jee-galileo-M7-win32.zip”的 zip 文件，根据 eclipse 站点，该侦听器从 M6 开始可用。当我在 IDE 中打开我的项目时，该类不存在，任何其他身份验证类（即 addAuthenticationListener、AuthenticationEvent、AuthenticationListener 等）也不存在。它应该是“org.eclipse.swt.browser.*”库的一部分。

我错过了什么吗？需要以某种方式更新库？任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T15:28:50.987

我下载了错误的zip结果。我想要文件“swt-3.5M6-win32-win32-x86.zip”，它只是更新的 SWT 项目，它确实包含所需的类文件。我用这个 zip 中的文件替换了旧的 swt，一切正常。

# asp.net-mvc - 从未调用过 ASP.NET MVC Ajax Form OnFailure！

> ID：893608
> 
> 赞同：3
> 
> 时间：2009-05-21T15:41:38.697
> 
> 标签：asp.net-mvc, asp.net-ajax

Ajax 请求如下：

在控制器操作方法中，我尝试添加 ModelState 错误并抛出异常，但响应永远不会调用 OnFailure。无论响应如何，它总是调用 OnSuccess。可能我在这里错过了什么。

问题：什么时候调用 OnFailure js 方法？任何样品将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T16:36:11.223

您需要从您的操作中返回一个 HTTP 错误状态代码。例如 400、404、500。

尝试这样的事情：

```
throw new HttpException(404, "Not Found"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-18T09:18:43.103

根据[MSDN 定义](https://msdn.microsoft.com/en-US/library/system.web.mvc.ajax.ajaxoptions.onfailure(v=vs.118).aspx "AjaxOptions.OnFailure 属性 MSDN")，当 HTTP 响应状态不在 200 范围内时，将调用 OnFailure。例如，如果它是永久重定向 (308)、临时重定向 (307) 未找到 (404) 或错误请求 (400)，则调用 OnFailure 方法。有关 HTTP 响应代码的完整列表，[请参阅此维基百科文章](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes "HTTP 状态码")

# c# - 相同的 asp:GridView 在不同的 ajaxToolkit:TabPanel

> ID：893611
> 
> 赞同：0
> 
> 时间：2009-05-21T15:42:57.367
> 
> 标签：c#, .net

我必须根据选择的选项卡面板过滤 GridView 数据，这是场景：

## 我有以下标签

## 全部 | 标签 A | 标签 B | 标签 C

当我单击“全部”选项卡时，我得到 10 条记录，我的 GridView 包含 10 条记录，但是当我单击选项卡 A 时，我的 GridView 需要过滤并显示 5 条记录
现在，我为每个选项卡使用单独的 GridView 和绑定到相同的 DataSourceID。
并使用 OnActiveTabChanged 事件过滤数据，但这是调用底层方法执行 4 次（因为有 4 个选项卡面板），用户体验没有问题，但存在性能问题......
我想看看，如果我对于这种类型的场景，可以在所有选项卡面板中使用：相同的 GrigView

任何帮助都非常感谢，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T16:48:08.983

如果要在所有选项卡上使用单个 GridView，请尝试在 OnPreRender 而不是 OnActiveTabChanged 中调用底层方法（填充 GridView）。使其以哪个选项卡处于活动状态为条件，并相应地进行过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:54:41.543

您可以在 DataView 上使用 RowFilter 属性，并让每个选项卡应用您需要的选项卡。

即DataView1.RowFilter = "Column='ColumnValue'" 然后设置数据源/数据绑定。

# c - 如何从 C 中的 WBC 文件中提取图片？

> ID：893616
> 
> 赞同：1
> 
> 时间：2009-05-21T15:44:38.830
> 
> 标签：c, image, extraction

有人请我帮助他们从 Web Shots 图像收集文件 (.WBC) 中提取图片。我试过 XnView 但它没有用。我怎样才能在 C 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T09:45:28.653

从[迈克](https://stackoverflow.com/users/4778/mike)：

> 我拼凑了一些代码来完成这项工作。这里是。它不是生产质量代码，所以如果您不理解它，请不要运行它。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void save_image(const char* filename, FILE* in_fp)
{
   char buf[4096];
   size_t read;
   FILE *fp;

   fp = fopen(filename, "wb");
   if (!fp) {
      fprintf(stderr, "cannot open file.");
      exit(1);
   }
   do {
      read = fread(buf,1,sizeof(buf),in_fp);
      fwrite(buf, 1, read, fp);
   } while (read);
   fclose(fp);
}

int main(int argc, char* argv[])
{
   char buf[4096];
   unsigned int read, read_tot = 0;
   FILE *fp;
   int image_count = 1;
   char filename[255];
   unsigned int i;

   char pattern[] = "JFIF";
   int pi = 0;

   long int curpos;
   char pad[50];

   char src_filename[] = 
       "C:\\Documents and Settings\\mikeking\\Desktop\\WBC\\"
       "Custom - CATHYS WEDDING.wbc";
   char des_directory[] = "C:\\Documents and Settings\\mikeking\\Desktop\\F\\";

   fp = fopen(src_filename, "rb");
   if (!fp) {
      fprintf(stderr, "cannot open file.");
      exit(1);
   }

   do {
      read = fread(buf,1,sizeof(buf),fp);

      for(i=0; i<read; i++){
         if (buf[i] == pattern[pi]) {
            pi++;
            if (pi == sizeof(pattern)) {
               strcpy(filename, des_directory);
               itoa(image_count, pad, 10);
               image_count++;
               strcat(filename, pad);
               strcat(filename, ".jpg");
               curpos = ftell(fp);
               fseek(fp,read_tot+i-10,SEEK_SET);
               save_image(filename,fp);
               fseek(fp,curpos,SEEK_SET);
            }
         } else {
          pi = 0;
         }
      }
      read_tot += read;
   } while (read);

   fclose(fp);
   return 0;
} 
```

# ruby-on-rails - Rails：使这个查询与数据库无关......？

> ID：893617
> 
> 赞同：1
> 
> 时间：2009-05-21T15:44:39.687
> 
> 标签：ruby-on-rails, database-agnostic

我的模型中有这两行，是为 PostgreSQL 编写的：

```
named_scope :by_month, lambda { |month| { :conditions => ["EXTRACT(MONTH FROM recorded_on) = ?", month] }}
named_scope :by_year, lambda { |year| { :conditions => ["EXTRACT(YEAR FROM recorded_on) = ?", year] }} 
```

我在生产中运行 PostgreSQL，但我正在使用 SQLite3 进行开发。如何以与数据库无关的方式编写这些行？

顺便说一句，“recorded_on”由以下组成：

```
Model.recorded_on = Time.parse("Fri, 01 May 2009 08:42:23 -0400") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T19:46:43.023

好的，发现有更好的方法（感谢[这篇文章](http://morecode.wordpress.com/2007/01/14/querying-for-a-date-range-ruby-on-rails/)）：

在模型中基本上什么都不做！

```
date = Date.new(year, month, 1)
Model.find(:all, :conditions => { :recorded_on => date..date.end_of_month }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:30:42.777

BETWEEN 应该是相当普遍的：这样的事情怎么样：

```
 named_scope :by_month, lambda { |month| 
    d1 = Date.new(2009, month, 1)
    d2 = d1.end_of_month
    { :conditions => ['recorded_on between ? and ?', d1, d2]}
  }

  named_scope :by_year, lambda { |year| 
    d1 = Date.new(year, 1, 1)
    d2 = d1.end_of_year
    { :conditions => ['recorded_on between ? and ?', d1, d2]}
  } 
```

如果你有时间，你需要在小时、分钟和秒方面变得更聪明一些。

# continuous-integration - 无法让 TeamCity FxCop Build Runner 工作

> ID：893626
> 
> 赞同：3
> 
> 时间：2009-05-21T15:47:58.853
> 
> 标签：continuous-integration, teamcity, fxcop

关于如何使此错误消息消失的任何想法？

无法运行进程 E:\Program Files\Microsoft FxCop 1.36\FxCop.exe\FxCopCmd.exe /forceoutput /gac /ignoregeneratedcode /f:\Sacog\bin\Debug\Sacog.dll /out:05A1B22A-DE6E-49ae-AA30- DC52A074EF22\fxcop-result.xml：找不到文件

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-07T18:43:31.110

我必须在 buildAgent.properties 文件中设置以下内容

system.FxCopRoot=c:\\Program Files (x86)\\Microsoft FxCop 1.36

确保转义冒号和反斜杠。

然后我必须从包含我希望 FxCop 查看的程序集的 bin 文件夹的编译构建配置中创建一个工件。然后我必须在 FxCop 构建配置中创建对该工件的工件依赖项；否则没有任何可用于 FxCop tp 操作的程序集。

这对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-06T08:30:02.437

您是否在运行器配置中设置了“FxCop 安装根”设置？

如果有，请从最后删除 FxCop.exe。

如果没有，您能否在此处发布您的 FxCop 构建页面中设置选项卡的内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:51:27.910

FxCop 正在尝试在 BuildAgent 驱动器的根目录中测试代码……开关

```
/f:\Sacog\bin\Debug\Sacog.dll 
```

正在尝试从该驱动器的根目录获取 Sacog.dll。这可能来自您在 TeamCity 中配置供 FxCop 分析的文件列表。删除`\`“Build Configuration / Step 3: Runner”配置屏幕上“Assemblies”部分中文件名开头的 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T07:55:45.303

只需将 FXCop 路径添加到 PATH 环境变量。

此外，NAnt contrib 有一个 fxcop 任务。像这样使用它：

```
 <loadtasks>
    <fileset basedir="${environment::get-variable('NAntContribHome')}">
      <include name="NAnt.Contrib.Tasks.dll" />
    </fileset>
  </loadtasks>

  <target name="fxCop" depends="compile">
    <fxcop analysisReportFilename="fxCopResults.xml" failOnAnalysisError="false" >
      <targets>
        <includes name="BinaryToAnalyse.dll" />
      </targets>
      <rules>
        <includes name="C:\Program Files\Microsoft FxCop 1.36\Rules\*Rules.dll" />
      </rules>
    </fxcop>
  </target> 
```

# sql - MS-Access 中的查询：格式化 sql 更新代码中间的字段

> ID：893630
> 
> 赞同：0
> 
> 时间：2009-05-21T15:48:35.827
> 
> 标签：sql, ms-access, vba, sql-update

我在 ms-access 中的数据还有另一个问题。

基本上，我正在做的是使用多个 sql 语句来拉取、排序和整理更改/操作数据。我目前遇到的问题是我正在尝试使用这样的 sql 代码：

```
UPDATE analyzedCopy2 SET analyzedCopy2.DateRange = #4/21/2009# to #4/29/2009# 
```

但我不知道如何在 sql 语句中将 DateRange （当前是一个日期）重新格式化为 Text 。我不能简单地手动设置格式，因为在此之前的 sql 代码正在从另一个表中提取所有数据，并且当发生这种情况时，它会自动将 DateRange 的格式更改为日期，因为这是它即将到来的类型从。

如果有人知道如何用 vba 代码格式化列，那也很好，因为我正在创建一个 vba 代码来按我想要的顺序运行查询。

如果有人需要更好地解释任何事情，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:21:49.300

您可以使用 SQL (DDL) 更改表的某些方面：

```
 ALTER TABLE TableName ALTER COLUMN  ColumnName Text(50) 
```

# protocols - 金融机构的 FIX 协议是什么？

> ID：893634
> 
> 赞同：6
> 
> 时间：2009-05-21T15:49:29.367
> 
> 标签：protocols, finance, fix-protocol

金融机构的 FIX 协议是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-21T15:53:26.003

FIX协议是金融机构之间应用程序通信的协议。主要是证券交易所、经纪人、做市商、交易商。

[http://en.wikipedia.org/wiki/FIX_protocol](http://en.wikipedia.org/wiki/FIX_protocol)

使用 Wikipedia/Google 花了 2 秒时间找到。

您在这个问题上有一个 Java 标签，所以我认为您可能正在寻找 Java 中的 FIX 通信库... [http://www.quickfixj.org/](http://www.quickfixj.org/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-21T15:58:16.383

[FIX](http://www.fixprotocol.org/)协议（金融信息交换）是一系列用于金融信息电子交换的信息。大多数大型银行和投资银行都使用它来接受来自外部实体（如对冲基金等）的订单。

FIX 消息基本上是一个标签/格式字符串。每个标签都是一个与实体交叉引用的数字。例如：

```
8=FIX.4.1 
```

8 表示 FIX 版本。

消息有一个 XML 变体，称为 FixML，但上次我查看它并没有被广泛使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-09T01:23:09.483

FIX 协议是一个：
用于电子交易的免费开源协议。基于标签值的协议，例如 8=FIX4.4，其中标签 8 是修复版本，FIX4.4 是值。
大多数经纪人支持股票和固定收益交易。
基于 TCP 传输 FIX 消息。
提供恢复和重放机制。

来源： http:
[//fixprotocol.org/what-is-fix.shtml](http://fixprotocol.org/what-is-fix.shtml)
[http://javarevisited.blogspot.com/2011/04/fix-protocol-tutorial-for-beginners.html](http://javarevisited.blogspot.com/2011/04/fix-protocol-tutorial-for-beginners.html)

# asp.net-mvc - MVC 应用程序的默认主页始终重定向到登录屏幕 (IIS7)

> ID：893635
> 
> 赞同：0
> 
> 时间：2009-05-21T15:49:45.340
> 
> 标签：asp.net-mvc, iis-7, windows-server-2008, authorization

我在设置我们的测试站点时遇到了一些问题。

在 IIS 7 中，我们的站点应用程序池以集成模式运行。

在身份验证中，我启用了匿名并启用了表单身份验证。

在授权中，我允许所有用户。

所有页面都允许匿名用户，除了默认的 (Home/Index.aspx)。该页面始终将用户转发到登录屏幕。我希望他们看到主页。

我尝试向 webconfig 添加授权规则，但没有任何改变。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:35:34.763

确保您没有在 Home 控制器或 Index 操作上设置 Authorize (C#) 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T13:55:33.450

问题出在 IIS 7 中的 NTFS 安全设置中。我添加了匿名用户帐户以进行访问，并且该站点现在可以正常工作。

# c# - 在 C# 中固定 IEnumerables

> ID：893637
> 
> 赞同：0
> 
> 时间：2009-05-21T15:50:25.853
> 
> 标签：c#

我想使用我正在研究的这种通用扩展方法将 IEnumerable 实现固定在内存中。它似乎适用于数组，但适用于其他序列（列表和集合）。这是方法实现。

```
 // <summary>
    ///  Pins an IEnumerable of type T in memory
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="sequence"></param>
    /// <returns></returns>
    public static GCHandle Pin<T>(this IEnumerable<T> @sequence)
    {
        return GCHandle.Alloc(@sequence, GCHandleType.Pinned);
    } 
```

为什么它对某些类型失败但对其他类型有效？你能解释一下这背后的概念吗？有比我的通用方法更好的方法吗？谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T15:55:01.430

的[文档](http://msdn.microsoft.com/en-us/library/1246yz8f.aspx)表明`GCHandle.Alloc`：

> 不能固定具有非原始（非 blittable）成员的实例。

对象引用不是原始（又名 blittable）成员。诸如此类的类型的实现在`List<T>`内部使用对象引用（例如数组引用）。因此它们具有非原始成员并且不能被固定。

数组不同：如果数组的元素类型是 blittable （即没有不可 blittable 字段的值类型），则可以固定数组。但这并不意味着可以固定对数组的引用；对数组的引用不是数组。像这样的集合类`List<T>`包含对内部存储数组的引用。它们本身不是数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:04:22.393

如果你*真的*需要这个，我建议你打电话`.ToArray()`并固定它。

但要小心，因为 IEnumerable 本身使用惰性求值/延迟执行，因此可枚举的*值*当前可能根本不在内存中。事实上，您甚至可以拥有一个永不停止的 IEnumerable。

# c# - 如何在c#中根据日期查询日期时间

> ID：893639
> 
> 赞同：1
> 
> 时间：2009-05-21T15:51:03.933
> 
> 标签：c#, ms-access, jet, dd

我有一个带有 DateTime 列的 MS-Access 数据库。
例如：`03/08/2009 12:00:00 AM`。

我想要基于日期的查询，例如：

```
select * from tablename where date='03/08/2009' 
```

我想将数据显示为`03/08/2009 12:00:00 AM`.

我将如何在 C# 中编写此查询？请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-12T14:23:28.727

问题不是编程语言，而是对 mdb 访问的查询。Access 需要`DateValue`输入日期前的单词：

```
string myQuery = "Select * FROM tableName WHERE date= DateValue ('03/02/2009')"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:14:09.863

这是在控制台应用程序中使用 C# 访问 Access DB 的一些示例代码。如果需要，您可以将此代码改编为 windows 或 ASP.NET。

```
/* Replace with the path to your Access database */
string connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\mydatabase.mdb;User Id=admin;Password=;";

try
{
using(OleDbConnection conn = new OleDbConnection(connectionString)
{
   conn.Open();       
   string myQuery = "Select * FROM tableName WHERE date='03/02/2009'";       
   OleDbCommand cmd = new OleDbCommand(myQuery, conn);
   using(OleDbDataReader reader = cmd.ExecuteReader())
   {
      //iterate through the reader here
      while(reader.Read())
      {
         //or reader[columnName] for each column name
         Console.WriteLine("Fied1 =" + reader[0]); 
      }
   }
}

}
catch (Exception e)
{
   Console.WriteLine(e.Message);
} 
```

# .net - Wifi 嗅探器应用指南

> ID：893642
> 
> 赞同：2
> 
> 时间：2009-05-21T15:52:01.670
> 
> 标签：.net, sdk, gps, wireless

我正在.Net 中编写 WiFi 连接/嗅探器，用作 USB 记忆棒的自我部署工具。目的是它会扫描不安全的可用网络，然后尝试依次连接到每个网络，并确定是否有登录/代理，或者是否可以直接连接到我的任意网站。这是为我计划填充的数据库建立一个热点漫游列表（以及它们的长期可用性）。

目的是将这个工具分发给朋友/朋友的朋友，以便建立我所在地区的本地地图，以便在网络上发布。我仍然不确定这是否会违反任何立法（现在正在阅读）或是否具有任何长期价值。

学习 WiFi 编码技术更像是一个宠物项目，但也可以帮助拥有 iPod/PSP 等的朋友。

我的问题是：考虑到我也需要 GPS 功能，最好的 SDK 是什么——移动设备 SDK 是最好用的吗？

谢谢，

马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:13:41.377

如果您要使用 Windows Mobile 设备，则可以使用 Mobile Devices SDK；从合法性的角度来看，这可能会因您所在的司法管辖区而异，但我相信这至少在英国会被视为未经授权的访问，因此会违反法律（通常的免责声明适用于此 - 我是没有律师，如果您想要一个真正的答案，请咨询一位，我倾向于谨慎行事）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:37:33.620

我不是律师，我也不在电视上玩。

正如已经指出的那样，在随机开放网络上的捎带可以被认为是“未经授权的访问”，并且在某些司法管辖区，*可以*作为一种盗窃形式被起诉。

但是，有一些开放网络*明确授予*免费访问权限（如语音和啤酒）。“免费WiFi”咖啡店，有人吗？如果你小心翼翼地只保留/发布这些，即使你不小心发现了私人的，如果它成为一个法律问题，你*可能会得到辩护。*

# c# - 来自 OdbcConnection.Open() 的奇怪异常

> ID：893643
> 
> 赞同：2
> 
> 时间：2009-05-21T15:52:04.820
> 
> 标签：c#, .net, winforms, exception

在这里撞墙

我们是独立软件开发商，有数百家公司毫无问题地使用我们的软件。该软件是 .NET 2.0 上的 Winforms/C#。

我们的一位客户安装了我们的软件，但它在所有机器上启动时崩溃，除了在一个人的笔记本电脑上运行良好。

在调用 OdbcConnection.Open() 时，我们得到以下异常：

```
The type initializer for 'System.Transactions.Diagnostics.DiagnosticTrace' threw an exception.
  at System.Transactions.Diagnostics.DiagnosticTrace.get_Verbose()
  at System.Transactions.Transaction.get_Current()
  at System.Data.Common.ADP.IsSysTxEqualSysEsTransaction()
  at System.Data.Common.ADP.NeedManualEnlistment()
  at System.Data.Odbc.OdbcConnection.Open()
  at OurCompany.OurForm.connectionTestWorker_DoWork(Object sender) 
```

这有一个 InnerException：

```
Configuration system failed to initialize
  at System.Configuration.ClientConfigurationSystem.EnsureInit(String configKey)
  at System.Configuration.ClientConfigurationSystem.PrepareClientConfigSystem(String sectionName)
  at System.Configuration.ClientConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.GetSection(String sectionName)
  at System.Configuration.ConfigurationManager.GetSection(String sectionName)
  at System.Configuration.PrivilegedConfigurationManager.GetSection(String sectionName)
  at System.Diagnostics.DiagnosticsConfiguration.GetConfigSection() 
```

谷歌只是说“app.config 在语法上不正确，重建它”但同样的 app.config 在数百台其他机器上也能正常工作。

这是app.config，根据要求：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
      <section name="OurApp.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    </sectionGroup>
  </configSections>
  <system.diagnostics>
  </system.diagnostics>
  <applicationSettings>
    <OurApp.Properties.Settings>
      <setting name="OurApp_WebServices_OurServiceName" serializeAs="String">
        <value>http://ourdomain.com/OurService.asmx</value>
      </setting>
    </OurApp.Properties.Settings>
  </applicationSettings>
  <appSettings>
    <add key="WorkflowEngine" value="old" />
    <add key="ProductID" value="3" />
    <add key="EnableMigrationWizard" value="false" />
    <add key="UseAlternativeFtpPort" value="true" />
    <add key="FeedbackWhileConnecting" value="true" />
  </appSettings>
</configuration> 
```

.NET Framework 的修复尚未解决此问题。我完全不知所措。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T16:11:51.473

检查 machine.config 和 user.config。与 app.config 一起，这些是[构成配置部分的 3 个部分](http://msdn.microsoft.com/en-us/library/8eyb2ct1.aspx)。

反射器显示`EnsureInit`有 2 个异常路径：

```
catch (Exception exception) {
    this._initError = new ConfigurationErrorsException(SR.GetString("Config_client_config_init_error"), exception);
    throw this._initError;
} catch {
    this._initError = new ConfigurationErrorsException(SR.GetString("Config_client_config_init_error"));
    throw this._initError;
} 
```

由于第二个只会处理[非 CLS 异常](http://msdn.microsoft.com/en-us/library/ms404228.aspx)，我猜你正在打第一个。如果是这种情况，您可能需要递归地通过 InnerException 来获取完整的详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T09:08:50.460

通过使用来自同一 SP/patch 级别的另一台机器的已知工作副本覆盖 machine.config 解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-14T22:07:05.113

仅供任何人将来参考，我在桌面上开发的本地应用程序遇到了这个问题，发现问题只是我在 . 一旦解决了这个问题，它就会再次像魅力一样发挥作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-22T21:51:12.083

尝试使用 ASP/VB.NET 3.5 SP1 打开 OLE DB 连接时，我遇到了完全相同的错误。如果我将我的 URL 添加到 IE 中的受信任站点列表中，则错误消失并且连接成功打开。我不知道这是否会解决其他浏览器中的问题。

# pia - 安装 2007 兼容包后，Office 主互操作程序集不工作

> ID：893646
> 
> 赞同：5
> 
> 时间：2009-05-21T15:53:32.867
> 
> 标签：pia, office-automation, word-automation

我有一个 C# 程序，它做了一些 Word 和 Excel 自动化，它使用了 Office 2003 Primary Interop Assemblies。我部署它的方式是将 Interops 包含在 bin 中，我让我的程序从那里引用它，而不是从 GAC 引用它（不是很专业，但它工作了几年）。最近在 3 台机器上安装了 office 2007 兼容包，现在当我的软件尝试调用 Word 或 Excel 时，我收到一个错误：

无法将 Microsoft.Office.Interop.Word.ApplicationClass 类型的 COM 对象转换为接口类型 Microsoft.Office.Interop.Word.Application，此操作失败，因为对具有 IID {00020970-0000 的接口的 COM 组件的 QueryInterface 调用-0000-C000-000000000046} 由于以下错误而失败：库未注册。（来自 HRESULT 的异常：0x8002801D (TYPE_E_LIBNOTREGISTERED)）

经过一番搜索，我注意到安装兼容包 Word11 和 Word12 都安装在 GAC 中，与 Excel 相同。

我试图让我的程序引用 GAC 中的 Word11 互操作，但仍然没有帮助。我卸载了 Word12 互操作，但仍然没有帮助。似乎安装它似乎改变了一些注册表设置或者我的软件感到困惑的东西找不到正确的库。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-15T23:02:40.513

我最近也遇到了这个问题，我追查到这个注册表项是罪魁祸首

```
HKEY_Classes_Root\TypeLib\{00020905-0000-c000-000000000046}\8.4 
```

显然，这告诉 word 使用 word 2007 introp 程序集而不是 Word 2003 (8.3)。至少我认为我对办公室 introp 组件不太熟悉。我删除了注册表项，一切正常。我不知道删除此密钥有什么不利影响，但一定要备份它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T15:58:13.793

我已经通过将早期版本从 GAC 复制到我们的第三方库文件夹并在那里引用它们来解决这个问题——这也意味着您可以在仅安装 2007 的情况下针对 2003 构建。（是的，我知道这是一个非常肮脏的黑客）

# javascript - 浏览器内 UI 技术列表？

> ID：893648
> 
> 赞同：1
> 
> 时间：2009-05-21T15:53:56.830
> 
> 标签：javascript, css, dom, user-interface

我想知道在浏览器 UI 中可以做什么（使用浏览器+CSS+javascript，而不是使用 Flash 或 Silverlight）。例如，我认为可以：

*   拖放
*   水平排列列表项，并使它们的行为类似于菜单项
*   根据鼠标悬停的位置，使页面上的内容可见或不可见

我承认这是一个广泛的问题，但这就是我正在寻找的：可用 UI 技术的概述（最好还有关于如何实现每种技术的至少一点线索或超链接）。

你知道这样的列表或字典吗？

我对任何用于交互和用户输入的技术（即不仅仅是最终用户只消费信息的页面布局和导航）特别感兴趣。

* * *

**编辑：**人们回答说我应该看看在各种“JavaScript UI 工具包”中实现了哪些功能。FWIW，以下是我在查看一些建议后的简要回顾/总结。

*   [http://demos.mootools.net/](http://demos.mootools.net/) -- 实现了少量（不广泛）的 UI 功能
*   [http://ajaxian.com/by/topic/ui](http://ajaxian.com/by/topic/ui) -- 不是一个有组织或连贯的参考，更像是一个评论各种事物的博客。
*   [http://jqueryui.com/demos/](http://jqueryui.com/demos/) -- 对十几个交互和/或小部件的简洁、有组织的介绍
*   [http://plugins.jquery.com/](http://plugins.jquery.com/) - 一个包含 20 个类别的数千个“插件”的库......更大，而且不像 jqueryui 演示那样容易理解，也不像 jqueryui 演示那样始终如一地记录
*   [http://www.dojotoolkit.org/](http://www.dojotoolkit.org/) - 需要一些导航......所有功能的最简单介绍可能是[http://dojocampus.org/explorer/](http://dojocampus.org/explorer/)
*   [http://script.aculo.us/](http://script.aculo.us/) -- 不是很大
*   [http://extjs.com/](http://extjs.com/) - 相当多种强大的功能，在[http://extjs.com/deploy/dev/examples/samples.html有一组很好的演示](http://extjs.com/deploy/dev/examples/samples.html)
*   [http://mochikit.com/](http://mochikit.com/) -- 这是另一个小图书馆
*   [http://developer.yahoo.com/yui/——](http://developer.yahoo.com/yui/)包括大约 20 个小部件类、详尽的文档（每个类描述都包含一个演示链接），并特别提到了“布局管理器”和“CSS 重置”。
*   [http://www.midorij.com/](http://www.midorijs.com/) -- 非常小而简单，没有演示

总而言之，我认为最好的答案（即最容易浏览的功能最多的集合）是：

*   [http://extjs.com/deploy/dev/examples/samples.html](http://extjs.com/deploy/dev/examples/samples.html)
*   [http://dojocampus.org/explorer/](http://dojocampus.org/explorer/)
*   [http://developer.yahoo.com/yui/examples/](http://developer.yahoo.com/yui/examples/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:04:07.510

JS可以[做](http://devsnippets.com/article/ajax/7-free-powerful-file-managers.html)[很多](http://maettig.com/code/javascript/3d_dots.html) [事情](http://www.noupe.com/javascript/10-smart-javascript-techniques-for-manipulating-content.html)[。](http://ajaxpatterns.org/Javascript_Effects_Frameworks)[_](http://www.kawa.net/works/js/animation/cube-e.html) [_](http://www.javascriptgaming.com/search/label/DHTML?Tech&max-results=10) [_](http://demos.mootools.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T15:56:30.913

查看诸如[mootools](http://demos.mootools.net/)和[jquery UI](http://jqueryui.com/demos/)之类的文档，有很多你可以在那里做的疯狂事情的​​例子。

另请查看[ajaxians UI 部分](http://ajaxian.com/by/topic/ui)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T16:07:17.303

尝试以下任何一个 javascript 库：

*   [http://www.dojotoolkit.org/](http://www.dojotoolkit.org/)
*   [http://mootools.net/](http://mootools.net/)
*   [http://jquery.com/](http://jquery.com/)
*   [http://script.aculo.us/](http://script.aculo.us/)
*   [http://extjs.com/](http://extjs.com/)
*   [http://mochikit.com/](http://mochikit.com/)
*   [http://developer.yahoo.com/yui/](http://developer.yahoo.com/yui/)
*   [http://www.midorijs.com/](http://www.midorijs.com/)

如果您接受[HTML Canvas](http://en.wikipedia.org/wiki/Canvas_(HTML_element))作为有效的 HTML（Microsoft 不接受），您可以做更多的事情（需要您的浏览器中的 Canvas 支持）：

*   [https://developer.mozilla.org/en/Canvas_tutorial](https://developer.mozilla.org/en/Canvas_tutorial)
*   [http://www.blobsallad.se/](http://www.blobsallad.se/)
*   [http://www.benjoffe.com/code/demos/canvascape/](http://www.benjoffe.com/code/demos/canvascape/) - 第三人称射击游戏

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:56:46.310

查看[JQuery](http://jquery.com)和[JQueryUI](http://jqueryui.com/demos/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T15:57:39.443

查看 jquery UI [http://jqueryui.com/](http://jqueryui.com/)以及插件[http://plugins.jquery.com/](http://plugins.jquery.com/) 这只是一个简单的示例，您可以通过 Java Script 实现

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T16:07:31.887

我认为原则上你几乎可以做任何你能想到的事情，包括页面改变它的外观以响应用户操作。我的意思是，js 可以做出惊人的视觉效果，包括非常复杂的动画和矢量，并从任何允许它使用 ajax 的地方检索数据，所以这样你就可以显示任何你想要的东西。

问题是这些占用了客户端多少资源。虽然几乎任何事情都是可能的，但并非所有事情都一定是实用的，而且我怀疑是否有任何可靠的方法来决定哪些事情会过于耗费资源而无法在客户端实际实施。

# apache-flex - Flex 中的自定义形状面板/表单

> ID：893653
> 
> 赞同：0
> 
> 时间：2009-05-21T15:55:08.013
> 
> 标签：apache-flex

我想要做的是创建一个花哨的自定义形状的登录面板。它的功能和包含的组件应该是非常标准的，就像在常规登录面板中一样——FormItem、TextInput、Validators 等。我做了一些研究，发现可以使用 Fireworks 创建皮肤，但这并不能解决我的问题，因为它不允许我使用面板形状进行操作。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:01:16.020

我的建议是使用[Degrafa 框架来做](http://www.degrafa.org/learning/)这样的事情。您可以在运行时以编程方式影响组件的外观以更改其形状。

另一种方法是使用具有符合您需求的图像背景的简单画布，但这不是很灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T00:43:55.807

我会做以下事情：

1.  将 Fireworks 中的资源导出为具有适当透明度的 PNG
2.  将资产嵌入您的应用程序并提供适当的 Scale9 坐标
3.  将嵌入资源引用为面板的“borderSkin”样式。

这是对作为 Panel 子类的 TitleWindow 执行此操作的示例，因此应该应用相同的方法：

[http://butterfliesandbugs.wordpress.com/2008/02/15/using-a-border-skin-for-a-titlewindow-in-flex-3/](http://butterfliesandbugs.wordpress.com/2008/02/15/using-a-border-skin-for-a-titlewindow-in-flex-3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T11:13:17.087

我同意 Joel 的观点，Degrafa 是实现完全自定义皮肤等的方法。如果做不到这一点（因为要弄清楚这是一个额外的障碍），我会捏造它使用 Canvas 而不是 Panel。扩展 Canvas 类，让它看起来像你想要做的任何形状。将 Canvas 的背景 alpha 设置为 0，然后添加所需的形状。使用这种方法，您可能必须复制面板可以执行的 Cavnas 无法执行的操作，但您将能够自定义外观。

# ms-access - Access 数据库不会共享

> ID：893654
> 
> 赞同：2
> 
> 时间：2009-05-21T15:55:17.153
> 
> 标签：ms-access

我们在文件共享上有一个访问数据库，部门中的每个人都可以访问该数据库。我遇到的问题是，当多个用户尝试同时访问数据库时，他们无法做到这一点。一个用户可以很好地打开数据库，但是当另一个用户尝试同时打开数据库时，他们双击文件图标，瞬间得到一个沙漏，之后什么也没有发生。我们使用 Server 2003 作为我们的域控制器。所有权限都已在域级别和工具选项高级下的访问数据库中验证，并将相关权限设置为共享和无锁。当用户尝试同时打开文件时，您是否知道“死链接”可能导致此问题的原因是什么？

任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T16:14:57.037

忽略反对者 - 访问对于少数用户来说非常好。要么你有默认的访问设置来打开 dbs Exclusive，这将锁定其他用户，要么有一些奇怪的网络问题。

编辑 - 注意到您已经拥有默认共享访问权限
- 记录级别锁定了吗？
- 还尝试让用户完全控制共享网络文件夹（访问需要读/写/创建/删除才能创建和删除 ldb 文件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:24:25.707

当您说共享权限时，用户是否具有完全权限？需要完全权限，因为必须创建和删除共享文件 (.ldb)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T22:54:26.417

这个问题偶尔会在几乎没有明显原因的情况下发生在 Access 数据库中。在 Microsoft 建议的响应中，您已经在执行第二个（从 Access 中打开），但我相信第一个提供了您正在寻找的答案。

> 在快捷方式的目标中，包含 MSAccess.exe 的路径

根据[Microsoft 帮助和支持](http://support.microsoft.com/kb/927844/en-us "微软帮助和支持")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T14:14:26.153

我只是最近遇到了同样的问题，只有一个人可以打开数据库。我们只有 3 个人通过桌面上的快捷方式访问同一个数据库。

现在根据微软的说法，我们需要在快捷方式中包含数据库路径，我会尝试的。他们承认这个问题。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-05-21T16:01:11.840

MS Access 在多用户设置中不值得麻烦。

最好在您还有头发的时候将时间花在将数据库转换为基于服务器的 RDBMS（例如 SQL 服务器）上。

相信我，不管怎样，你迟早要这么做！关于这些坏消息我很遗憾。

# jquery - Sql 查询返回 SUM 和匹配查询的行数

> ID：893655
> 
> 赞同：1
> 
> 时间：2009-05-21T15:55:33.067
> 
> 标签：jquery, sql-server

表 UserData（用户 ID、销售额、积分）

我需要返回给定日期范围内的销售额总和、积分总和以及返回的行数。

1个查询可以吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T15:56:34.437

```
SELECT COUNT(*), SUM(Sales), SUM(Credits)
FROM UserData
WHERE TransactionDate BETWEEN @StartDate AND @EndDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-22T16:53:57.240

您还可以像这样为计算列命名

```
 SELECT 
      COUNT(*) AS NumRows, SUM(Sales) AS SalesTotal, SUM(Credits) AS CreditsTotal
   FROM UserData
   WHERE TransactionDate BETWEEN @StartDate AND @EndDate 
```

# python - 如何使用 Python 和 Numpy 计算 r 平方？

> ID：893657
> 
> 赞同：122
> 
> 时间：2009-05-21T15:55:54.143
> 
> 标签：python, math, statistics, numpy, curve-fitting

我正在使用 Python 和 Numpy 来计算任意次数的最佳拟合多项式。我传递了 x 值、y 值和我想要拟合的多项式的次数（线性、二次等）的列表。

这很有效，但我也想计算 r（相关系数）和 r-squared（确定系数）。我将我的结果与 Excel 的最佳拟合趋势线功能以及它计算的 r 平方值进行比较。使用它，我知道我正在为线性最佳拟合（度数等于 1）正确计算 r 平方。但是，我的函数不适用于度数大于 1 的多项式。

Excel 能够做到这一点。如何使用 Numpy 计算高阶多项式的 r 平方？

这是我的功能：

```
import numpy

# Polynomial Regression
def polyfit(x, y, degree):
    results = {}

    coeffs = numpy.polyfit(x, y, degree)
     # Polynomial Coefficients
    results['polynomial'] = coeffs.tolist()

    correlation = numpy.corrcoef(x, y)[0,1]

     # r
    results['correlation'] = correlation
     # r-squared
    results['determination'] = correlation**2

    return results 
```

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-10-04T21:15:51.133

一个很晚的回复，但以防万一有人需要为此准备好的功能：

[scipy.stats.linregress](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html)

IE

```
slope, intercept, r_value, p_value, std_err = scipy.stats.linregress(x, y) 
```

就像@Adam Marples 的回答一样。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-05-21T20:48:35.393

从[numpy.polyfit](http://docs.scipy.org/doc/numpy/reference/generated/numpy.polyfit.html)文档中，它拟合线性回归。具体来说，度数为 'd' 的 numpy.polyfit 与均值函数拟合线性回归

E(y|x) = p_d * x**d + p_{d-1} * x **(d-1) + ... + p_1 * x + p_0

因此，您只需要计算该拟合的 R 平方。[关于线性回归](http://en.wikipedia.org/wiki/Linear_regression)的维基百科页面提供了完整的细节。您对 R^2 感兴趣，可以通过多种方式计算，最简单的可能是

```
SST = Sum(i=1..n) (y_i - y_bar)^2
SSReg = Sum(i=1..n) (y_ihat - y_bar)^2
Rsquared = SSReg/SST 
```

我使用'y_bar'作为y的平均值，'y_ihat'作为每个点的拟合值。

我对 numpy 不是很熟悉（我通常在 R 中工作），所以可能有一种更简洁的方法来计算你的 R 平方，但以下应该是正确的

```
import numpy

# Polynomial Regression
def polyfit(x, y, degree):
    results = {}

    coeffs = numpy.polyfit(x, y, degree)

     # Polynomial Coefficients
    results['polynomial'] = coeffs.tolist()

    # r-squared
    p = numpy.poly1d(coeffs)
    # fit values, and mean
    yhat = p(x)                         # or [p(z) for z in x]
    ybar = numpy.sum(y)/len(y)          # or sum(y)/len(y)
    ssreg = numpy.sum((yhat-ybar)**2)   # or sum([ (yihat - ybar)**2 for yihat in yhat])
    sstot = numpy.sum((y - ybar)**2)    # or sum([ (yi - ybar)**2 for yi in y])
    results['determination'] = ssreg / sstot

    return results 
```

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2015-06-12T13:41:03.323

从 yanl (yet-another-library)`sklearn.metrics`有一个[`r2_score`](http://scikit-learn.org/stable/modules/generated/sklearn.metrics.r2_score.html)功能；

```
from sklearn.metrics import r2_score

coefficient_of_dermination = r2_score(y, p(x)) 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-12-17T16:37:46.943

我一直在成功使用它，其中 x 和 y 类似于数组。

注意：仅适用于线性回归

```
def rsquared(x, y):
    """ Return R^2 where x and y are array-like."""

    slope, intercept, r_value, p_value, std_err = scipy.stats.linregress(x, y)
    return r_value**2 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2016-01-05T17:21:45.813

我最初发布下面的基准是为了推荐`numpy.corrcoef`，愚蠢地没有意识到原始问题已经使用`corrcoef`并且实际上是在询问高阶多项式拟合。我已经使用 statsmodels 为多项式 r-squared 问题添加了一个实际的解决方案，并且我留下了原始基准，这些基准虽然离题，但可能对某人有用。

* * *

`statsmodels`具有`r^2`直接计算多项式拟合的能力，这里有两种方法......

```
import statsmodels.api as sm
import statsmodels.formula.api as smf

# Construct the columns for the different powers of x
def get_r2_statsmodels(x, y, k=1):
    xpoly = np.column_stack([x**i for i in range(k+1)])    
    return sm.OLS(y, xpoly).fit().rsquared

# Use the formula API and construct a formula describing the polynomial
def get_r2_statsmodels_formula(x, y, k=1):
    formula = 'y ~ 1 + ' + ' + '.join('I(x**{})'.format(i) for i in range(1, k+1))
    data = {'x': x, 'y': y}
    return smf.ols(formula, data).fit().rsquared # or rsquared_adj 
```

要进一步利用`statsmodels`，还应该查看拟合模型摘要，它可以在 Jupyter/IPython 笔记本中打印或显示为丰富的 HTML 表格。除了 .results 对象之外，结果对象还提供对许多有用统计指标的访问`rsquared`。

```
model = sm.OLS(y, xpoly)
results = model.fit()
results.summary() 
```

* * *

以下是我的原始答案，我在其中对各种线性回归 r^2 方法进行了基准测试...

问题中使用的[corrcoef](http://docs.scipy.org/doc/numpy/reference/generated/numpy.corrcoef.html)函数仅针对单个线性回归计算相关系数 ，`r`因此它没有解决`r^2`高阶多项式拟合的问题。然而，无论如何，我发现对于线性回归，它确实是最快和最直接的计算方法`r`。

```
def get_r2_numpy_corrcoef(x, y):
    return np.corrcoef(x, y)[0, 1]**2 
```

这些是我比较了 1000 个随机 (x, y) 点的一堆方法的 timeit 结果：

*   纯Python（直接`r`计算）
    *   1000 个循环，3 个循环中的最佳：每个循环 1.59 毫秒
*   Numpy polyfit（适用于 n 次多项式拟合）
    *   1000 个循环，3 个循环中的最佳：每个循环 326 µs
*   Numpy手册（直接`r`计算）
    *   10000 次循环，3 次中的最佳：每个循环 62.1 µs
*   Numpy corrcoef（直接`r`计算）
    *   10000 次循环，3 次中的最佳：每个循环 56.6 µs
*   Scipy（`r`作为输出的线性回归）
    *   1000 个循环，3 个循环中的最佳：每个循环 676 µs
*   Statsmodels（可以进行 n 次多项式和许多其他拟合）
    *   1000 个循环，3 个循环中的最佳：每个循环 422 µs

corrcoef 方法勉强胜过使用 numpy 方法“手动”计算 r^2。它比 polyfit 方法快 > 5 倍，比 scipy.linregress 快约 12 倍。只是为了加强 numpy 为您所做的事情，它比纯 python 快 28 倍。我不精通 numba 和 pypy 之类的东西，所以其他人必须填补这些空白，但我认为这对我来说很有说服力，它是计算简单线性回归`corrcoef`的最佳工具。`r`

这是我的基准测试代码。我从 Jupyter Notebook 复制粘贴（很难不称它为 IPython Notebook...），所以如果途中出现任何问题，我深表歉意。%timeit 魔术命令需要 IPython。

```
import numpy as np
from scipy import stats
import statsmodels.api as sm
import math

n=1000
x = np.random.rand(1000)*10
x.sort()
y = 10 * x + (5+np.random.randn(1000)*10-5)

x_list = list(x)
y_list = list(y)

def get_r2_numpy(x, y):
    slope, intercept = np.polyfit(x, y, 1)
    r_squared = 1 - (sum((y - (slope * x + intercept))**2) / ((len(y) - 1) * np.var(y, ddof=1)))
    return r_squared

def get_r2_scipy(x, y):
    _, _, r_value, _, _ = stats.linregress(x, y)
    return r_value**2

def get_r2_statsmodels(x, y):
    return sm.OLS(y, sm.add_constant(x)).fit().rsquared

def get_r2_python(x_list, y_list):
    n = len(x_list)
    x_bar = sum(x_list)/n
    y_bar = sum(y_list)/n
    x_std = math.sqrt(sum([(xi-x_bar)**2 for xi in x_list])/(n-1))
    y_std = math.sqrt(sum([(yi-y_bar)**2 for yi in y_list])/(n-1))
    zx = [(xi-x_bar)/x_std for xi in x_list]
    zy = [(yi-y_bar)/y_std for yi in y_list]
    r = sum(zxi*zyi for zxi, zyi in zip(zx, zy))/(n-1)
    return r**2

def get_r2_numpy_manual(x, y):
    zx = (x-np.mean(x))/np.std(x, ddof=1)
    zy = (y-np.mean(y))/np.std(y, ddof=1)
    r = np.sum(zx*zy)/(len(x)-1)
    return r**2

def get_r2_numpy_corrcoef(x, y):
    return np.corrcoef(x, y)[0, 1]**2

print('Python')
%timeit get_r2_python(x_list, y_list)
print('Numpy polyfit')
%timeit get_r2_numpy(x, y)
print('Numpy Manual')
%timeit get_r2_numpy_manual(x, y)
print('Numpy corrcoef')
%timeit get_r2_numpy_corrcoef(x, y)
print('Scipy')
%timeit get_r2_scipy(x, y)
print('Statsmodels')
%timeit get_r2_statsmodels(x, y) 
```

21 年 7 月 28 日基准测试结果。（Python 3.7、numpy 1.19、scipy 1.6、statsmodels 0.12）

```
Python
2.41 ms ± 180 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
Numpy polyfit
318 µs ± 44.3 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
Numpy Manual
79.3 µs ± 4.05 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
Numpy corrcoef
83.8 µs ± 1.37 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
Scipy
221 µs ± 7.12 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
Statsmodels
375 µs ± 3.63 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each) 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-08-07T00:55:37.317

这是一个用 Python 和 Numpy 计算*加权*r 平方的函数（大部分代码来自 sklearn）：

```
from __future__ import division 
import numpy as np

def compute_r2_weighted(y_true, y_pred, weight):
    sse = (weight * (y_true - y_pred) ** 2).sum(axis=0, dtype=np.float64)
    tse = (weight * (y_true - np.average(
        y_true, axis=0, weights=weight)) ** 2).sum(axis=0, dtype=np.float64)
    r2_score = 1 - (sse / tse)
    return r2_score, sse, tse 
```

例子：

```
from __future__ import print_function, division 
import sklearn.metrics 

def compute_r2_weighted(y_true, y_pred, weight):
    sse = (weight * (y_true - y_pred) ** 2).sum(axis=0, dtype=np.float64)
    tse = (weight * (y_true - np.average(
        y_true, axis=0, weights=weight)) ** 2).sum(axis=0, dtype=np.float64)
    r2_score = 1 - (sse / tse)
    return r2_score, sse, tse    

def compute_r2(y_true, y_predicted):
    sse = sum((y_true - y_predicted)**2)
    tse = (len(y_true) - 1) * np.var(y_true, ddof=1)
    r2_score = 1 - (sse / tse)
    return r2_score, sse, tse

def main():
    '''
    Demonstrate the use of compute_r2_weighted() and checks the results against sklearn
    '''        
    y_true = [3, -0.5, 2, 7]
    y_pred = [2.5, 0.0, 2, 8]
    weight = [1, 5, 1, 2]
    r2_score = sklearn.metrics.r2_score(y_true, y_pred)
    print('r2_score: {0}'.format(r2_score))  
    r2_score,_,_ = compute_r2(np.array(y_true), np.array(y_pred))
    print('r2_score: {0}'.format(r2_score))
    r2_score = sklearn.metrics.r2_score(y_true, y_pred,weight)
    print('r2_score weighted: {0}'.format(r2_score))
    r2_score,_,_ = compute_r2_weighted(np.array(y_true), np.array(y_pred), np.array(weight))
    print('r2_score weighted: {0}'.format(r2_score))

if __name__ == "__main__":
    main()
    #cProfile.run('main()') # if you want to do some profiling 
```

输出：

```
r2_score: 0.9486081370449679
r2_score: 0.9486081370449679
r2_score weighted: 0.9573170731707317
r2_score weighted: 0.9573170731707317 
```

这对应于[公式](http://web.maths.unsw.edu.au/~adelle/Garvan/Assays/GoodnessOfFit.html)（[镜像](https://web.archive.org/web/20170817185657/http://web.maths.unsw.edu.au/~adelle/Garvan/Assays/GoodnessOfFit.html)）：

[![在此处输入图像描述](https://i.stack.imgur.com/8WDhJ.png)](https://i.stack.imgur.com/8WDhJ.png)

其中 f_i 是拟合的预测值，y_{av} 是观测数据的平均值 y_i 是观测数据值。w_i 是应用于每个数据点的权重，通常 w_i=1。SSE 是误差平方和，SST 是总平方和。

* * *

如果有兴趣，R 中的代码：[https](https://gist.github.com/dhimmel/588d64a73fa4fef02c8f) ://gist.github.com/dhimmel/588d64a73fa4fef02c8f ( [mirror](https://web.archive.org/web/20170807154523/https://gist.github.com/dhimmel/588d64a73fa4fef02c8f) )

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-21T16:54:49.733

R-squared 是一种仅适用于线性回归的统计量。

从本质上讲，它衡量了数据中有多少变化可以用线性回归来解释。

因此，您计算“总平方和”，即每个结果变量与其均值的总平方偏差。. .

![公式1](https://chart.googleapis.com/chart?cht=tx&chl=%5Csum_%7Bi%7D(y_%7Bi%7D%20-%20y_%7Bbar%7D)%5E2)

其中 y_bar 是 y 的平均值。

然后，您计算“回归平方和”，即您的拟合值与平均值相差多少

![公式2](https://chart.googleapis.com/chart?cht=tx&chl=%5Csum_%7Bi%7D(yhat_%7Bi%7D%20-%20y_%7Bbar%7D)%5E2)

并找到这两者的比例。

现在，对于多项式拟合，您所要做的就是插入该模型中的 y_hat，但称其为 r-squared 并不准确。

[这](http://ask.metafilter.com/65278/Statistics-tell-me-about-rsquare-for-nonlinear-models)是我发现的一个链接，可以说明一点。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-08-25T06:06:24.767

[关于r-squareds](http://en.wikipedia.org/wiki/Coefficient_of_determination)的维基百科文章表明它可以用于一般模型拟合，而不仅仅是线性回归。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-05-01T18:48:17.113

假设 y 和 y_hat 是熊猫系列，这是一个非常简单的 python 函数，用于从实际值和预测值计算 R^2：

```
def r_squared(y, y_hat):
    y_bar = y.mean()
    ss_tot = ((y-y_bar)**2).sum()
    ss_res = ((y-y_hat)**2).sum()
    return 1 - (ss_res/ss_tot) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-07-01T13:38:34.167

**您可以直接执行此代码，这将找到您的多项式，并会找到您的 R 值**，如果您需要更多解释，可以在下面发表评论。

```
from scipy.stats import linregress
import numpy as np

x = np.array([1,2,3,4,5,6])
y = np.array([2,3,5,6,7,8])

p3 = np.polyfit(x,y,3) # 3rd degree polynomial, you can change it to any degree you want
xp = np.linspace(1,6,6)  # 6 means the length of the line
poly_arr = np.polyval(p3,xp)

poly_list = [round(num, 3) for num in list(poly_arr)]
slope, intercept, r_value, p_value, std_err = linregress(x, poly_list)
print(r_value**2) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-08-21T23:50:32.107

使用 numpy 模块（在 python3 中测试）：

```
import numpy as np
def linear_regression(x, y): 
    coefs = np.polynomial.polynomial.polyfit(x, y, 1)
    ffit = np.poly1d(coefs)
    m = ffit[0]
    b = ffit[1] 
    eq = 'y = {}x + {}'.format(round(m, 3), round(b, 3))
    rsquared = np.corrcoef(x, y)[0, 1]**2
    return rsquared, eq, m, b

rsquared, eq, m, b = linear_regression(x,y)
print(rsquared, m, b)
print(eq) 
```

输出：

> ```
> 0.013378252355751777 0.1316331351105754 0.7928782850418713 
> y = 0.132x + 0.793 
> ```

注：r² ≠ R²
r² 称为“确定系数”
R² 是皮尔逊系数的平方

R²，正式合并为 r²，可能是您想要的，因为它是最小二乘拟合，比 r² 的简单分数要好。Numpy 不怕称其为“corrcoef”，这假定 Pearson 是事实上的相关系数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-11-16T00:43:40.177

来自 scipy.stats.linregress 源。他们使用平均平方和方法。

```
import numpy as np

x = np.array(x)
y = np.array(y)

# average sum of squares:
ssxm, ssxym, ssyxm, ssym = np.cov(x, y, bias=1).flat

r_num = ssxym
r_den = np.sqrt(ssxm * ssym)
r = r_num / r_den

if r_den == 0.0:
    r = 0.0
else:
    r = r_num / r_den

    if r > 1.0:
        r = 1.0
    elif r < -1.0:
        r = -1.0 
```

# c# - 有没有办法防止我们的应用程序被分析或注入？（C＃）

> ID：893658
> 
> 赞同：2
> 
> 时间：2009-05-21T15:56:03.393
> 
> 标签：c#, code-injection, analyzer

有大量用于 C# 程序集的分析器和静态代码分析器。

只是想知道有没有什么方法可以防止被分析，因为它确实让我在被剥夺时感到有些紧张。

我已经搜索了整个互联网和stackoverflow。我的奇迹似乎没有。

我所拥有的只是一些更可怕的标题，比如这些（对不起，新用户不能发布超链接，请谷歌它们）：

“程序集操作和 C#/VB.NET 代码注入”

“如何将托管 .NET 程序集 (DLL) 注入另一个进程”

是我太担心还是怎么的？

顺便说一句，我们正在使用 C# 构建一个新的 winform 客户端，供银行客户进行在线交易。我们不应该以 winform 的方式执行此操作，还是应该使用 Delphi、C++ 等其他语言？目前我们有一个用 C++ Builder 构建的 winform 客户端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T15:59:52.340

如果通过分析你的意思是有人反编译代码并查看它，那么 VS Pro 及更高版本附带的 Dotfucstor 是一个简单的（免费）工具，可以在这里提供帮助。有一个功能更全面（但已付费）的版本可以做更多事情。

为了防止有人篡改您部署的组件，请使用[Strong Names](http://msdn.microsoft.com/en-us/library/xc31ft41(VS.71).aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T16:03:41.910

有意愿就有办法，无论是托管代码还是本机程序集。关键是将重要信息保留在 SERVER 端并保持对其的控制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T16:04:29.413

几乎任何应用程序都可以“分析和注入”。有些比其他的多。这就是为什么您从不相信用户输入的原因。您在服务器端完全验证用户的请求，确保您不会受到缓冲区溢出、sql 注入和其他攻击媒介的影响。

混淆器会使 .NET 程序集更难分析。使用安全密钥对程序集进行强命名会使更改代码变得更加困难。但是，就像数字世界中的其他一切一样，有人可以利用漏洞并绕过您设置的任何保护措施。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T16:08:58.907

您需要决定反对您要保护的内容的第一件事是什么？混淆器仅用于保护“秘密武器”算法，但攻击者可以简单地提取代码并将其用作黑盒。在 99% 的情况下，混淆器都是浪费金钱。如果攻击者具有物理访问权限，那么您无能为力。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T16:25:30.557

如果最终用户以管理权限运行，那么他们将能够附加调试器，并修改您的代码，包括目标帐户详细信息。我当地的友好银行给了我一个芯片和密码阅读器，我必须输入目标帐户的最后 n 位数字，它会用我的银行卡芯片对其进行散列/加密；然后，我将设备中的代码输入银行的 Web 应用程序，该应用程序也可以在银行端进行检查。这减轻了“中间人”类型的攻击......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T16:29:34.277

安全性只能在您物理控制访问的系统上实现，即使那样也不能保证，只能实现。您必须假设未在您控制的系统上执行的任何代码都可能并且将会受到损害。正如 Rowland Shaw 所说，对于金融机构来说，最好的选择是某种物理代币，它有效地为所有交易添加了一个离线独特的组件，这些交易不能（容易）被从受损系统操作的攻击者提前知道。即使这样，您也应该意识到，如果用户的计算机已被入侵并且他从那时起使用他的安全令牌登录直到会话结束，攻击者可以自由执行用户有权执行的任何操作，但至少在这种情况下，用户更有可能注意到欺诈活动。

# nhibernate - NHibernate 投影帮助

> ID：893659
> 
> 赞同：4
> 
> 时间：2009-05-21T15:56:08.587
> 
> 标签：nhibernate, criteria, castle-activerecord, projection

我在为我的休眠分离条件对象创建投影时遇到问题。

我有一个与表地址链接的 Spa 类。

地址有一个名为 City 的字段，它是一个字符串。

```
public class Spa : IAggregateRoot
{
       [BelongsTo("AddressID", Cascade = CascadeEnum.All)]
       public Address Address { get; set; }
} 
```

我的最终目标是获得一份不同的城市名称列表。

如果我能得到所有不同城市的水疗中心，我也会很高兴。

我所有的尝试都是徒劳的，还没有找到任何有用的帖子。

到目前为止，我已经尝试过：

```
DetachedCriteria query = DetachedCriteria.For<Spa>()
                         .CreateAlias("Address", "A")

query.SetProjection(
         Projections.Distinct(Projections.ProjectionList()
         .Add(Projections.Alias(Projections.Property("Address"), "A"))));

var Spas = ActiveRecordMediator<Spa>.FindAll(query); 
```

我知道以上是不正确的，只是想找个地方开始。

任何帮助，将不胜感激。任何简单的投影教程也将不胜感激，似乎无法直接找到任何东西。

我也尝试过，但是遇到了演员错误，正在调查它：

```
DetachedCriteria query = DetachedCriteria.For<Spa>() 
.CreateAlias("Address", "A")
.SetProjection(Projections.Distinct(Projections.Property("A.City"))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-07T01:58:24.527

在我看来，你的问题有两个部分。

# 1\. 我的 DetachedCriteria 应该是什么样的？

如果您不执行任何其他聚合，`GROUP BY`则应提供与`DISTINCT`. 这是我将使用的查询：

```
var query = DetachedCriteria.For<Spa>()
    .CreateAlias("Address", "A")
    .SetProjection(Projections.GroupProperty("A.City")); 
```

# 2\. 如何使用 Castle ActiveRecord 执行？

我从未使用过 ActiveRecord，但根据方法签名，我希望这样的事情可以工作：

```
var cities = ActiveRecordMediator<string>.FindAll(query); 
```

如果你可以访问 NHibernate 会话，你也可以这样执行它：

```
var cities = query.GetExecutableCriteria(session).List<string>(); 
```

# c# - 确定程序是否是 .NET 中的活动窗口

> ID：893669
> 
> 赞同：3
> 
> 时间：2009-05-21T15:58:04.607
> 
> 标签：c#, .net, user-interface, active-window

我有一个 C#/.NET 应用程序，我想实现以下行为：

我有一个弹出菜单。每当用户单击应用程序中*不是**弹出*菜单的任何内容时，我都希望关闭弹出菜单。

但是，每当用户不在应用程序中时，我都不希望发生任何事情。

我试图通过 LostFocus 事件来管理它，但我无法确定我的应用程序是否是活动窗口。代码看起来像这样。

```
 private void Button_LostFocus(object sender, System.EventArgs e)
    {
        if (InActiveWindow()) {
           CloseMenu()
        }
        else {
           // not in active window, do nothing
        }
    } 
```

我需要知道的是如何实现 InActiveWindow() 方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T16:02:58.527

您可以 P/Invoke 进入[GetForegroundWindow()](http://msdn.microsoft.com/en-us/library/ms633505(VS.85).aspx)，并将返回的 HWND 与应用程序的 form.Handle 属性进行比较。

获得句柄后，您还可以 P/Invoke [GetAncestor()](http://msdn.microsoft.com/en-us/library/ms633502(VS.85).aspx)以获取根所有者窗口。如果它在您的应用程序中，这应该是您应用程序的主启动窗口的句柄。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-01T12:12:40.843

我在做一个项目时偶然发现了你的问题，根据[Reed Copsey 的回答](https://stackoverflow.com/questions/893669/determine-whether-program-is-the-active-window-in-net/893702#893702)，我编写了这个似乎可以很好地完成工作的快速代码。

这是代码：

```
Public Class Form1
    '''<summary>
    '''Returns a handle to the foreground window.
    '''</summary>
    <Runtime.InteropServices.DllImport("user32.dll", SetLastError:=True)> _
    Private Shared Function GetForegroundWindow() As IntPtr
    End Function

    '''<summary>
    '''Gets a value indicating whether this instance is foreground window.
    '''</summary>
    '''<value>
    '''<c>true</c> if this is the foreground window; otherwise, <c>false</c>.
    '''</value>
    Private ReadOnly Property IsForegroundWindow As Boolean
        Get
            Dim foreWnd = GetForegroundWindow()
            Return ((From f In Me.MdiChildren Select f.Handle).Union(
                    From f In Me.OwnedForms Select f.Handle).Union(
                    {Me.Handle})).Contains(foreWnd)
        End Get
    End Property
End Class 
```

~~我没有太多时间将其转换为 C#，因为我正在处理一个截止日期为 2 天的项目，但我相信您可以快速完成转换。~~

这是 VB.NET 代码的 C# 版本：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    private static extern IntPtr GetForegroundWindow();

    ///<summary>Gets a value indicating whether this instance is foreground window.</summary>
    ///<value><c>true</c> if this is the foreground window; otherwise, <c>false</c>.</value>
    private bool IsForegroundWindow
    {
        get
        {
            var foreWnd = GetForegroundWindow();
            return ((from f in this.MdiChildren select f.Handle)
                .Union(from f in this.OwnedForms select f.Handle)
                .Union(new IntPtr[] { this.Handle })).Contains(foreWnd);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-24T01:26:39.873

这似乎是棘手的最大原因是因为弹出窗口在主窗体被停用之前失去焦点，因此活动窗口在此事件发生时将始终位于应用程序中。真的，您想知道事件结束后它是否仍然是活动窗口。

您可以设置某种方案，让您记住弹出窗口正在失去焦点，搁置您需要关闭它的事实，并在应用程序主窗体的`LostFocus`或`Deactivate`事件中取消告诉您需要关闭的注释它; 但问题是你什么时候处理这​​张纸条？

我认为这可能更容易，至少如果弹出窗口是主窗体的直接子窗体（我怀疑在你的情况下可能是）挂钩主窗体的事件`Focus`或什至`Click`事件并使用它关闭弹出窗口如果它是打开的（可能通过扫描其子表单列表来查找任何实现 ICloseOnLostFocus 接口的表单，以便弹出窗口有机会参与决策并执行它需要做的任何其他事情）。

我希望我知道一个更好的文档来解释所有这些事件的实际含义以及它们如何相互排序，MSDN 在描述它们方面还有很多不足之处。

# c++ - 如何从 DWORD 构造 std::string？

> ID：893670
> 
> 赞同：22
> 
> 时间：2009-05-21T15:58:07.897
> 
> 标签：c++, numeric, stdstring

我有以下代码：

```
Tools::Logger.Log(string(GetLastError()), Error); 
```

`GetLastError()`返回 a`DWORD`数值，但 的构造函数`std::string`不接受 a `DWORD`。

我能做些什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-21T16:00:31.403

您想阅读 ostringstream：

```
#include <sstream>
#include <string>

int main()
{
   std::ostringstream stream;
   int i = 5;
   stream << i;
   std::string str = stream.str();
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-21T16:00:12.933

您想将数字转换为`string`：

```
std::ostringstream os;
os << GetLastError();
Log(os.str(), Error); 
```

或者`boost::lexical_cast`：

```
Log(boost::lexical_cast<std::string>(GetLastError()), Error); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-04-16T11:48:57.283

**自 C++11 起**

[`std::to_string()`](http://en.cppreference.com/w/cpp/string/basic_string/to_string)`int`, `long`, `long long`, `unsigned int`, `unsigned long`, `unsigned long long`, `float`, `double`, 和`long double`的重载

```
auto i = 1337;
auto si = std::to_string(i); // "1337"
auto f = .1234f;
auto sf = std::to_string(f); // "0.123400" 
```

*是的，我是[`auto`](http://en.cppreference.com/w/cpp/language/auto).*

要使用您的示例：

```
Tools::Logger.Log(std::to_string(GetLastError()), Error); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-21T16:00:11.823

将 Boost[`lexical_cast`](http://www.boost.org/doc/libs/1_39_0/libs/conversion/lexical_cast.htm)用于上述简单情况：

```
Tools::Logger.Log(lexical_cast<string>(GetLastError()), Error); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T03:27:04.887

您可以使用[STLSoft](http://www.stlsoft.org/)的[winstl::int_to_string()](http://www.stlsoft.org/doc-1.9/int__to__string_8hpp.html)，如下所示：

```
Tools::Logger.Log(winstl::int_to_string(GetLastError()), Error); 
```

另外，如果要查找错误代码的字符串形式，可以使用 STLSoft 的[winstl::error_desc](http://www.stlsoft.org/doc-1.9/classwinstl_1_1basic__error__desc.html)。

几年前， [Dobb 博士](http://www.ddj.com/)的文章中有很多关于此的文章：[第一](http://www.ddj.com/cpp/184401596)部分、[第二](http://www.ddj.com/cpp/184403874)部分、[第三](http://www.ddj.com/cpp/184403880)部分、[第四](http://www.ddj.com/cpp/184403882)部分。*非常*详细地进入主题，特别是关于性能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T16:00:56.050

使用 std::stringstream。

```
std::stringstream errorStream;
errorStream << GetLastError();
Tools::Logger.Log(errorStream.str(), Error); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T16:00:20.373

我通常做的是：

```
std::ostringstream oss;
oss << GetLastError() << " :: " << Error << std::endl;
Tools::Logger.Log(oss.str()); // or whatever interface is for logging 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T16:06:33.670

正如这里所有的人所建议的那样，实现将使用 stringstream。
在我当前的项目中，我们创建了函数

```
template <typename T>
std::string util::str::build( const T& value ); 
```

从任何来源创建字符串。

所以在我们的项目中

```
Tools::Logger.Log( util::str::build(GetLastError()) ); 
```

除非有人包装它，否则以建议的方式使用流不会通过我的审查。

# pdf - PowerPoint 2007 SP2，PowerShell 中的 ExportAsFixedFormat？

> ID：893675
> 
> 赞同：1
> 
> 时间：2009-05-21T15:59:18.300
> 
> 标签：pdf, com, powershell, powerpoint, office-2007

昨天我试图为朋友将一组 PPT 批量转换为 PDF，我决定看看 PowerShell，因为它已经在我的 HD 上放置了一段时间。

这是我想出的代码。

```
$p = new-object -comobject powerpoint.application

# I actually don't know why I have to set the window to visible, 
# but it doesn't work otherwise, anyway, it's not the real problem I have
$p.visible = 1 

$f = $p.presentations.open('\some\file.ppt')

$f.ExportAsFixedFormat('\some\newfile.pdf', 2) 
```

[2 用于 PDF](http://msdn.microsoft.com/en-us/library/bb265637.aspx "MSDN 参考。 页")

由于“蛮力”方法不起作用（“类型不匹配”），我尝试使用

```
$pptypepdf= [Microsoft.Office.Interop.PowerPoint.PpFixedFormatType]::PpFixedFormatTypePDF
$f.ExportAsFixedFormat('\some\newfile.pdf', $pptypepdf) 
```

这里奇怪的是它仍然抛出“类型不匹配”错误......

此外，SaveAs 适用于

```
$f.SaveAs('\some\newfile.pdf', 32) # 32 is for PDF 
```

我究竟做错了什么？

**更新**

相关文件：

*   [PpFixedFormatType 枚举](http://msdn.microsoft.com/en-us/library/bb265637.aspx)
*   [ExportAsFixedFormat 方法](http://msdn.microsoft.com/en-us/library/bb231096.aspx)

这是完整的错误消息

```
$pptypepdf= [Microsoft.Office.Interop.PowerPoint.PpFixedFormatType]::PpFixedFormatTypePDF
$f.ExportAsFixedFormat($filepath, $pptypepdf)

Exception calling "ExportAsFixedFormat" with "2" argument(s): "Type mismatch. (Exception from HRESULT: 0x80020005 (DISP_E_TYPEMISMATCH))"

At line:1 char:23
+ $f.ExportAsFixedFormat <<<< ($filepath, $pptypepdf)
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : ComMethodTargetInvocation 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-07T14:30:48.010

我在 Python 中遇到了同样的问题。尝试`PrintRange`按照 Stefan Schukat 的解决方案中所述指定参数：

> 这是 Powerpoint 中的一个错误。它定义了“[in, optional, defaultvalue(0)] PrintRange* PrintRange”，它导致在 python 包装器中生成“PrintRange=0”。因此，调用该方法时会出现错误。所以makepy没有问题。解决方法使用 PrintRange=None 调用该方法，因为 None 是一个 vali COM 对象。例如presentation.ExportAsFixedFormat(pptFile+'.pdf', win32com.client.constants.ppFixedFormatTypePDF, win32com.client.constants.ppFixedFormatIntentScreen, PrintRange=None) 应该可以工作。

[来源：使用 PowerPoint 2007 的导出功能时类型不匹配](http://sourceforge.net/p/pywin32/bugs/339/)

* * *

我根本不了解 PowerShell，但已经制定了一个可行的示例：

```
$p.ActivePresentation.PrintOptions.Ranges.Add(1,1)
$r = $p.ActivePresentation.PrintOptions.Ranges.Item(1)
$document.ExportAsFixedFormat('D:\\ps.pdf', 2, 1, 0, 1, 1, 0, $r) 
```

这不是一个完整的解决方案，但导出已完成。它以某种方式导出完整的演示文稿，而不仅仅是幻灯片。1，和我想的一样。PS哦。这是相同的[解决方案](https://stackoverflow.com/a/22835945/1119602)

# javascript - 原型和 Ajax.Request 范围

> ID：893678
> 
> 赞同：3
> 
> 时间：2009-05-21T15:59:40.327
> 
> 标签：javascript, ajax, prototypejs

我无法在原型的 Ajax.Request 类中获得正确的范围。我想做的是编写一个简单的 API 来包装 ajax 请求：

```
API = Class.create({

  initialize:function(api_token)
  {
    this.api_token = api_token;
    this.request_uri = new Template('/api/#{api_token}/#{resource}.json');
    this.status = 0;
    this.last_result = null;
  },

  some_api_call:function()
  {
    var result = this._request('resource', {'id':1});
    // and so on...
  },

  _request:function(resource, params)
  {
    var uri = this.request_uri.evaluate({"api_token":this.api_token,"resource":resource});
    new Ajax.Request(uri,
    {
      contentType:'application/json',
      method:'get',
      parameters:params,
      onSuccess:function(r)
      {
        alert(this);
        this.last_result = r.responseJSON;
        this.status = r.status;
      }
    });    
    return this.last_result;
  }

}); 
```

当我在 onSuccess() 方法中时，我希望 +this+ 引用父对象，但它给了我 DOMWindow。我似乎根本无法将该响应数据放入 API 类中。我认为这是愚蠢的（绑定？），但我今天似乎无法想到这一点。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T16:20:35.917

好的。我错过了更大的问题。我是异步请求的，所以它*正在*设置结果，而不是立即。公平地说，这也是一个有约束力的问题。这是正确的要求：

```
_request:function(resource, params)
{
  var uri = this.request_uri.evaluate({"api_token":this.api_token,"resource":resource});
  new Ajax.Request(uri,
  {
    asynchronous: false,
    contentType:'application/json',
    method:'get',
    parameters:params,
    onSuccess:function(r)
    {
      this.last_result = r.responseJSON;
      this.status = r.status;
    }.bind(this)
  });    

  alert(this.status);

  return this.last_result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T21:14:04.657

您的解决方案不应该工作？

您需要在嵌套函数上方使用局部变量，然后将它们转换为“this”范围：

```
 _request:function(resource, params)
    {
      var uri = this.request_uri.evaluate({"api_token":this.api_token,"resource":resource});
      var last_result = "";
      var status = "";
      new Ajax.Request(uri,
      {
        asynchronous: false,
        contentType:'application/json',
        method:'get',
        parameters:params,
        onSuccess:function(r)
        {
          last_result = r.responseJSON;
          status = r.status;
        }
      });  
      this.last_result = last_result;
      this.status = status;  
      alert(this.status);
      return this.last_result;
    } 
```

# ruby-on-rails - 使用单例类动态覆盖/添加 ActiveRecord 关联

> ID：893682
> 
> 赞同：2
> 
> 时间：2009-05-21T16:00:14.523
> 
> 标签：ruby-on-rails, ruby, activerecord

业务逻辑是这样的：用户通过一个连接表在一条船上，我想我们称该模型为 Ticket。但是当一个用户实例想要检查船上还有谁时，有一个条件会询问该用户是否有权看到船上的每个人，或者只是船上的某些人。如果用户可以看到所有人，则正常交易很好： `some_user.boats.first.users`返回所有用户并获得该船的船票。但是对于一些用户来说，船上唯一的人（就他们而言）是在餐厅里的人。因此，如果用户的票被“标记”（使用`acts_as_taggable`样式系统）带有“餐厅”，则唯一返回的用户 `some_user.boats.first.users`应该是带有标记为“餐厅”的票的用户。

只是为了记录，我并不是想从一开始就设计一些疯狂的东西——我试图将这个任意分组楔入一个（大部分）现有的系统中。所以我们有：

```
class User
  has_many :tickets
  has_many :boats, :through => :tickets
end

class Ticket
  belongs_to :user
  belongs_to :boat
end

class Boat
  has_many :tickets
  has_many :users, :through => :tickets
end 
```

最初，我认为我可以有条件地修改虚拟类，例如：

```
singleton = class << a_user_instance ; self ; end
singleton.class_eval(<<-code
  has_many :tickets, :include => :tags, :conditions => ['tags.id in (?)', [#{tag_ids.to_s(:db)}]]
code
) 
```

这一直到生成 SQL，但是在生成时，它生成的 SQL 结尾为：

`LEFT OUTER JOIN "tags" ON ("tags"."id" = "taggings"."tag_id") WHERE ("tickets"._id = 1069416589 AND (tags.id in (5001,4502)))`

我已经尝试挖掘 ActiveRecord 代码，但我找不到任何地方会在上面的 SQL 中用下划线前缀“id”。我知道在加载 ActiveRecord 类时会加载关联，并且我会假设与单例类相同。 *耸耸肩*。

我还用了一个`alias_method_chain`like：

```
singleton = class << a_user_instance ; self ; end
singleton.class_eval(<<-code
  def tickets_with_tag_filtering
    tags = Tag.find(etc, etc)
    tickets_without_tag_filtering.scoped(:include => :tags, :conditions => {:'tags.id' => tags})
  end
  alias_method_chain :tickets, :tag_filtering
code
) 
```

但是，虽然这种方法会产生所需的票证，但这些票证上的任何连接都使用类中的条件，而不是虚拟类。 `some_user.boats.first.users`返回所有用户。

任何类型的评论都会受到赞赏，特别是如果我用这种方法吠叫错误的树。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T19:35:47.900

因此，关于您的下划线问题的一个疯狂猜测是 Rails 在评估时根据上下文生成关联代码。在单例类中可能会搞砸，如下所示：

```
"#{owner.table_name}.#{association.class.name}_id = #{association.id}" 
```

你*可以*进入那里并在你的单例类上定义一个类名属性，看看是否能解决问题。

总的来说我不推荐这个。它会产生难以追踪且无法有效扩展的行为。它在代码库中制造了一个地雷，会在以后伤害您或您所爱的人。

相反，请考虑使用`named_scope`声明：

```
class User
   has_many :taggings, :through => :tickets

   named_scope :visible_to, lambda { |looking_user|
      { :include => [ :tickets, :taggings ], 
        :conditions => [ "tickets.boat_id in (?) and taggings.ticket_id = tickets.id and taggings.tag_id in (?)", looking_user.boat_ids, looking_user.tag_ids ] 
      }
    }
end 
```

虽然您可能需要返回并编辑一些代码，但它的使用方式要灵活得多：

```
Boat.last.users.visible_to( current_user ) 
```

很明显，对查找设置了限制，以及该限制的目的是什么。因为条件是在运行时动态计算的，所以您可以处理客户端遇到的下一个奇怪的修改。假设他们的一些用户有 X 射线视力和千里眼：

```
class User
   named_scope :visible_to, lambda { |looking_user|
      if looking_user.superhuman?
        {}
      else
        { :include => [ :tickets, :taggings ], 
          :conditions => [ "tickets.boat_id in (?) and taggings.ticket_id = tickets.id and taggings.tag_id in (?)", looking_user.boat_ids, looking_user.tag_ids ] 
        }
      end
    }
end 
```

通过返回一个空的散列，你可以有效地取消作用域的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T22:00:44.593

为什么不抓住船上的所有用户并包含他们的标签。

然后运行快速过滤器以仅包含并返回与查询用户具有相同标签的用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T05:25:10.343

你用的是什么版本的 Rails？您是否尝试升级以查看下划线问题是否已修复？这就像它找不到外键作为“tag_id”或其他东西。

我的 ruby​​-fu 是有限的，所以我不确定如何在运行时动态包含正确的方法选项。

只是为了帮助您澄清，您必须担心这两个地方。您想要过滤用户的可见用户，以便他们只能看到具有相同标签的用户。你的结构是：

用户 <--> 门票 <--> 船 <--> 门票 <--> 用户

... 对？

因此，您需要将两组工单过滤到带有 current_user 标记的工单。

也许您只需要一个 current_user.viewable_users() 方法，然后通过它过滤所有内容？我不确定您必须保留哪些现有功能。

Blech，我一点也不觉得我在帮助你。对不起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-07T05:25:11.880

你的方法是问题所在。我知道目前在您不必重构现有呼叫站点的地方破解某些东西似乎是权宜之计，但我相信随着时间的推移，这将再次困扰您，成为错误和复杂性的根源。

根据我的经验，躺着睡觉的狗会回来狠狠地咬你。通常以未来开发人员的形式出现，他们不知道您的关联是“魔术”并假设它只是桶轨来使用它。他/她甚至可能没有理由编写一个会暴露该行为的测试用例，这增加了您只有在该错误处于生产状态并且客户不满意时才发现该错误的可能性。你现在节省的时间真的值得吗？

Austinfrombostin 正在指明方向。不同的语义？不同的名字。第一条规则是始终编写尽可能清楚地说明其功能的代码。其他任何事情都是疯狂的道路。

# vb.net - VB.net 保存文件对话错误 - 找不到特殊目录“桌面”

> ID：893687
> 
> 赞同：1
> 
> 时间：2009-05-21T16:00:46.830
> 
> 标签：vb.net

我有一个相当直接的代码片段，它只是尝试将标准.net 保存对话框的默认保存目录设置到特定文件夹。如果该文件夹不存在，则将其设置为桌面。

除了遇到以下错误的一位用户之外，这对所有人都有效：

```
Could not find special directory 'Desktop' 
```

这怎么可能呢？

```
 'Check if folder exists
        If Not IO.Directory.Exists(strDirectory) Then
            strDirectory = FileIO.SpecialDirectories.Desktop
            If Not IO.Directory.Exists(strDirectory) Then
                strDirectory = IO.Directory.GetCurrentDirectory
            End If
        End If

    'Show save file dialogue.
    Dim folderDlg As New Windows.Forms.FolderBrowserDialog
    folderDlg.RootFolder = Environment.SpecialFolder.Desktop
    folderDlg.SelectedPath = strDirectory
    folderDlg.ShowNewFolderButton = True 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T19:04:57.427

怎么样：

```
strDirectory = _
    Environment.GetFolderPath(Environment.SpecialFolder.Desktop).ToString() 
```

我使用[GetFolderPath()](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)来获取“我的文档”，它工作正常（我不必考虑它）。

# asp.net - 如何在不使用 Javascript 的情况下在 ASP.Net 中呈现给定 UTC 日期时间值的本地时间？

> ID：893689
> 
> 赞同：2
> 
> 时间：2009-05-21T16:01:02.493
> 
> 标签：asp.net, utc

当您将值存储为 UTC 时，是否可以在不使用 Javascript 的情况下向用户显示当地时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:10:15.313

您需要服务器端了解客户端时区。典型请求中没有足够的信息来做出决定，您可以获得的最接近的是 Accept_Language 标头，它可能会给您一个线索，但几乎没有用处（尤其是如果客户端位于具有多个时区的国家/地区） .

因此，您需要用户告诉您他们的时区是什么，然后使用登录或 cookie 来存储该信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:05:05.293

您可以在服务器端使用 vb.net、c# 或您使用的任何 .net 语言进行转换。您将不得不在某个地方转换为当地时间。

您提出了一个非常广泛的问题，没有详细信息，所以我不能推荐如何在服务器上执行此操作。

**编辑**

根据评论，我看到您遇到的问题是您想弄清楚没有 javascript 的用户时区是什么。我总是让用户在注册时告诉我他们的时区。

一种不完美的方法是使用 geo-ip 查找服务，它会告诉您最有可能的用户在哪里，并提供更好的粒度，然后使用语言设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:26:00.260

认为这是您可以做的最接近的事情：

```
using System.Globalization;

// get the first language from request (en, fr, ru)
var primaryLanguage = Request.UserLanguages.First().Split(";").First();
// find a culture by this language
var culture = new CultureInfo(primaryLanguage);
// if the culture is neutral, try to find the specific one
if (culture.IsNeutralCulture)
    culture = CultureInfo.GetCultures(CultureTypes.SpecificCultures).FirstOrDefault(o => o.TwoLetterISOLanguageName == primaryLanguage);
// get the string from a datetime
var datetimeText = culture ? DateTime.Now.ToString(culture) : DateTime.Now.ToString(); 
```

# jquery - 我可以改进这个 JQuery 图像替换代码吗？

> ID：893712
> 
> 赞同：4
> 
> 时间：2009-05-21T16:05:56.370
> 
> 标签：jquery

HTML 看起来有点像：

```
<dl>
  <dt>
    <img src='Images\Something\expand-close.gif' /> Something 1
  </dt>
  <dd>Something 1 Text</dd>
</dl> 
```

此 HTML 重复 1 次或多次，因此同一页面上可能有许多 HTML 实例。

我用来扩展 dd 并替换图像的 Jquery 是：

```
$("dl").find("dt").click(function() {
  // toggle the dd
  $(this).next().toggle(200);

  // replace the expand / close image
  var img = $(this).find("img");
  var src = img.attr("src");
  if (src.lastIndexOf("open.gif") != -1)
  {
    img.attr("src", src.replace("open.gif", "closed.gif"));
  }
  else
  {
    img.attr("src", src.replace("closed.gif", "open.gif"));
  }
}); 
```

这一切都很好，并且完全符合我的需要。我的问题是，JQuery 功能可以做得更好吗？我对使用 JQuery 比较陌生，而这个是我喋喋不休的片段。如果可以做得更好，请在我尝试学习如何编写更好的 JQuery 代码时解释这些更改。任何其他指针或建议也将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T16:18:30.790

它非常接近。尝试：

```
$("dl > dt").click(function() {
  var dd = $(this).next();
  if (dd.is(":visible")) {
    var newimage = "closed.gif";
    dd.hide(200);
  } else {
    var newimage = "open.gif";
    dd.show(200);
  }
  var img = $(this).find("img");
  img.attr("src", img.attr("src").replace(/(open|closed)\.gif$/, newimage);
}); 
```

区别在于：

1.  在这种情况下，只需使用“dl > dt”（或适当的“dl dt”）而不是 find 语法；
2.  此代码查看事物是否可见而不是 src 图像，这可能会导致不同步，尤其是考虑到延迟；
3.  最后一行的正则表达式只是用正确的内容替换了任何内容以适应不规则行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T16:18:05.377

您可以为图像标签设置 ID 或 Class 属性，这将稍微清除您的代码。我还建议使用插件 - 有很多此类插件可以免费在线获得，而它所需要的只是一种方法。

HTML：

```
<dl>
  <dt>
    <img src='Images\Something\expand-close.gif' id='myimage' /> Something 1
</dt>
  <dd>Something 1 Text</dd>
</dl> 
```

JavaScript（使用 jQuery）：

```
$('#myimage').click(function(){
  $(this).parent().get(0).toggle(200);
  var src = $(this).attr('src');

  if (src.lastIndexOf("open.gif") != -1) {
    $(this).attr('src', src.replace("open.gif", "closed.gif");
  } else {
    $(this).attr('src', src.replace("closed.gif", "open.gif");
  }
}); 
```

希望那有所帮助 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T16:34:10.133

您可以使用这些设置，但这里是一般的想法，CSS 和 JS 的组合......

```
<style>

    dl dt { background: transparent url(open.gif) no-repeat scroll top left; padding-left: 20px; }
    .open dt { background-image: url(close.gif); }

</style>

<dl class="open">
    <dt>Something 1</dt>
    <dd>Something 1 Text</dd>
</dl>

<script>

    $('dl dt').click(function()
    {
        $(this).next().toggle(200);
        $(this).parent().toggleClass("open",$('dd:visible',$(this).parent()).length);
    });

</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T16:13:25.590

```
<dl>
  <dt class="something">
    <img class="switch" src='Images\Something\expand-close.gif' /> Something 1
  </dt>
  <dd>Something 1 Text</dd>
</dl>

$('.something').click(function() {
    // toggle the dd
    $(this).next().toggle(200);
    // replace the expand / close image
    var img = $(this).find('.switch');
    var src = img.attr('src');
    if(src.lastIndexOf('open.gif') != -1)
        img.attr('src', src.replace('open.gif', 'closed.gif'));
    else
        img.attr('src', src.replace('closed.gif', 'open.gif'));
}); 
```

# java - 为什么我的 Java 类从包目录中编译时编译失败？

> ID：893716
> 
> 赞同：4
> 
> 时间：2009-05-21T16:07:40.983
> 
> 标签：java, packages, compilation

我创建了一个名为“middle”的目录，在其中创建了另一个名为“tier”的目录，在“tier”目录中是 OrderManager.java，它是一个接口，OrderManagerImpl.java 有它的实现。

问题是当我尝试从它编译的包中间层外部编译 OrderManagerImpl.java 时，但是当我在包内部执行相同操作时，它给了我以下错误：

```
OrderManagerImpl.java:6：找不到符号
符号：类 OrderManager
公共类 OrderManagerImpl 扩展 java.rmi.server.UnicastRemoteObject 实现 OrderManager{

```

为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T16:09:54.300

因为编译器希望在正确的文件夹中找到您的类： ./middle/tier 。当您尝试在包内编译时，编译器会在 ./middle/tier/middle/tier 中搜索您的类

# forms - 从 Internet 表单以编程方式传真

> ID：893717
> 
> 赞同：10
> 
> 时间：2009-05-21T16:07:46.957
> 
> 标签：forms, fax

我是编程新手，我唯一的专业领域是网页设计/在 wordpress/表达引擎等平台上进行简单开发。（是的，你们可以笑）。

我有一个新客户，他目前通过在线表格接收医疗传真（用户填写一份关于他们的处方的表格，一旦提交，它就会传真信息）。

我正在完全重新设计他们的网站，但我不确定在线传真是如何工作的。

有人处理过网络传真吗？它是如何工作的？是否/可以通过电子邮件发送？

是否可以通过带有 javascript/php 的表单发送传真或通过电子邮件发送传真？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T16:15:13.153

不要为此付出代价！您所需要的只是服务器上的调制解调器和标准电话线。然后在你的操作系统下设置一个传真打印驱动程序（你可以在 windows 和 unix 上做）。

unix 方式是 mgetty/sendfax：[http](http://mgetty.greenie.net/doc/mgetty_3.html#SEC3) ://mgetty.greenie.net/doc/mgetty_3.html#SEC3 Windows 方式：http: [//support.microsoft.com/kb/306657](http://support.microsoft.com/kb/306657)

还有其他方法，但除非您无法获得电话线，否则您会为它支付费用而发疯。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T16:10:48.683

看看它目前是如何完成的，这样你可以在尝试再次做之前了解一两件事关于这个过程的事情是否有帮助？这样您就可以发现它是否使用任何特殊的库或技术或服务来发送传真，然后您可以复制代码或将其用作模板来开始您自己的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T16:11:06.577

您的所有要求都是可能的。我建议找一个可以为您发送传真的服务提供商。它们都有不同的接口要求和定价。我曾经使用现在称为[Fax.com的 DataOnCall](http://www.fax.com/)

他们有一个网络服务，我们会发布要传真的文件以及其他信息。他们是一项非常合理的服务。这是几年前的事了，所以我不能说他们目前的公平程度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T16:10:54.610

看看[eFax 的 SDK](http://www.efaxdeveloper.com/developer/twa/page/home)。我没有使用它，但它看起来可能对你有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T16:12:28.743

是的，您可以通过多种服务通过电子邮件发送传真；[这个链接](http://www.savetz.com/fax/)似乎有一些有用的信息。我之前曾在一家做同样事情的公司工作，虽然我不记得我们使用的确切服务，但它们中的大多数都非常相似，而且工作得相当好。

# ms-access - 即时将 MS Access 更改为 Exclusive

> ID：893722
> 
> 赞同：1
> 
> 时间：2009-05-21T16:08:27.923
> 
> 标签：ms-access

我在 MS Access 数据库中有一个进程，用户通常每天运行一次，但可能或多或少。这需要几分钟并且需要临时独占访问，因为它会删除并重新创建主表。

我有代码可以在进程开始之前检查数据库中是否有其他用户，但是有没有办法在开始时将访问更改为“独占”，然后在最后将其改回开放访问？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T20:51:53.280

如果使用 /excl 命令行参数运行 Access，它应该以独占模式打开数据库。

但我不清楚您是否从 Access 执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:04:18.420

Access 仅在打开数据库时设置独占/共享模式。因此，除非您有另一个可以打开/关闭的数据库，否则您不能“​​即时”执行此操作。

因此，您可以拥有一个“维护”数据库，该数据库在另一个数据库中删除和重新创建表 - 维护数据库可以以独占模式打开数据库。

顺便说一句 - 这样做可能不是一个好习惯 - 删除/重新创建表每次都会增加数据库的大小，您需要定期压缩以控制大小。如果可能，请找到不需要此操作的不同设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-08T17:08:38.797

您可以在隐藏表单上使用表格和计时器。计时器检查 Access 数据库中表上的值。当值设置为将所有人踢出时，它会将所有人踢出。隐藏表单的示例代码：

```
Private Sub Form_Timer()
'On Error GoTo Err_Handler
 Dim fLogout As Boolean
   'checks to see if the table is set to false
  fLogout = DLookup("on_off", "tblAdminSettings", "Control = 'logoff?'")

If fLogout = True Then
 'this is your timer it allows everyone to be logged off
           T1 = Now()
         T2 = DateAdd("s", 10, T1)
    Do Until T2 <= T1
        T1 = Now()
    Loop
DoCmd.SetWarnings False

DoCmd.Quit

  End If

Exit_Here:
  Exit Sub
 Err_Handler:
   MsgBox Err.Description, vbExclamation, "Error Your Killing me Smalls"
 Resume Exit_Here
End Sub 
```

请记住，当您打开数据库时，请确保您有办法将值设置回 false，否则它将始终关闭。

# jquery - jQuery改变数据属性 Works perfectly in FF (as you'd expect) but for some reason when I do this: $('#objectname').attr('data', 'newcontent.php') ...absolutely nothing happens in IE. When I do an 问问题 问问题 2009-05-21T16:09:06.813 4326 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Works perfectly in FF (as you'd expect) but for some reason when I do this: $('#objectname').attr('data', 'newcontent.php') ...absolutely nothing happens in IE. When I do an alert($('#objectname').attr('data', 'newcontent.php')) it shows the new data source but doesn't change it... Any ideas please? I don't think data is a valid HTML attribute. Did you mean to use the jQuery data() function? $('#objectname').data('name','value'); Update for 9/2014 — This question and answer is over five years old now, and isn't really relevant any more. data is now a valid attribute. I'm leaving my original answer for historical purposes though. jqueryinternet-explorer 4 2 回答 2 This answer is useful 0 We had the same problem. Our solution was to re-set the innerHtml of the parent node. With this (ugly) hack IE picks up the changed data attribute and renders accordingly. html = val.parentNode.innerHTML; val.parentNode.innerHTML = html; 于 2014-09-30T12:20:25.397 回答 This answer is useful 0 我不认为这data是一个有效的 HTML 属性。您的意思是使用 jQuerydata()函数吗？ $('#objectname').data('name','value'); 9/2014 更新——这个问题和答案现在已经有五年多了，不再真正相关了。data现在是一个有效的属性。不过，出于历史目的，我将保留我的原始答案。 于 2009-05-21T16:20:50.473 回答 Related 2 python - 即使我要求 [0]，列表索引也超出范围？ 0 json - 我的 JSON Google Maps API 结果中有日文字符？ 1 node.js - 通过 github 部署时，nodejitsu 中的快照版本没有变化 1 email - 如何使用phpjs邮件功能 1 android - 如果选择另一种语言，ActionBar 不起作用 1 javascript - jQuery：明智地滚动 div 部分 3 c# - 正则表达式嵌套括号 1 javascript - AngularJS如何更改模型的一部分 2 c# - 解析器错误无法加载类型“testconnect.index” 2 php - Php：在多选中打印数组 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：893725
> 
> 赞同：0
> 
> 时间：
> 
> 标签：jquery, internet-explorer

Works perfectly in FF (as you'd expect) but for some reason when I do this:

```
$('#objectname').attr('data', 'newcontent.php') 
```

...absolutely nothing happens in IE.

When I do an

```
alert($('#objectname').attr('data', 'newcontent.php')) 
```

it shows the new data source but doesn't change it...

Any ideas please?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-30T12:20:25.397

We had the same problem. Our solution was to re-set the innerHtml of the parent node. With this (ugly) hack IE picks up the changed data attribute and renders accordingly.

```
html = val.parentNode.innerHTML;
val.parentNode.innerHTML = html; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:20:50.473

我不认为这`data`是一个有效的 HTML 属性。您的意思是使用 jQuery[`data()`](http://docs.jquery.com/Data)函数吗？

```
$('#objectname').data('name','value'); 
```

*9/2014 更新*——这个问题和答案现在已经有五年多了，不再真正相关了。[`data`](https://developer.mozilla.org/de/docs/Web/HTML/Element/object)现在是一个有效的属性。不过，出于历史目的，我将保留我的原始答案。

# mysql - 如何将本地 unix 套接字映射到 inet 套接字？

> ID：893730
> 
> 赞同：3
> 
> 时间：2009-05-21T16:09:48.780
> 
> 标签：mysql, perl, socat, unix-socket, inet-socket

我很好奇是否可以将 UNIX 套接字映射到 INET 套接字。情况很简单，我想连接到 MySQL 服务器。不幸的是，它禁用了 INET 套接字，因此我只能连接 UNIX 套接字。我正在使用/编写的工具必须连接到 INET 套接字，所以我想看看我是否可以将一个映射到另一个。

进行了大量搜索，但我确实找到了[socat](http://www.dest-unreach.org/socat/)，据称它可以满足我的需求。我想知道是否有人对如何实现这一点有任何建议。我一直在使用的命令行（部分成功）是：

```
socat -v UNIX-CONNECT:/var/lib/mysql/mysql.sock TCP-LISTEN:6666,reuseaddr 
```

现在我可以建立连接并与服务器交谈。不幸的是，任何建立多个连接的尝试都失败了，因为我需要使用 fork 选项，但这个选项似乎使连接不起作用。

我知道我可以用 Perl（我的首选语言）解决这个问题，但我宁愿避免自己编写整个实现。我熟悉 IO::Socket 库，我只是希望任何人都有做这种事情的经验。接受建议/想法。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T21:29:49.803

将参数的顺序颠倒到`socat`，它就可以工作。

```
socat -v tcp-l:6666,reuseaddr,fork unix:/var/lib/mysql/mysql.sock 
```

`socat`这指示

1.  侦听 TCP 端口 6666（使用`SO_REUSEADDR`）
2.  等待接受连接
3.  建立连接后，分叉。在孩子中，继续以下步骤。在父级中，转到 2。
4.  打开到`/var/lib/mysql/mysql.sock`套接字的 UNIX 域连接。
5.  在两个端点之间传输数据，然后退出。

* * *

反过来写

```
socat -v unix:/var/lib/mysql/mysql.sock tcp-l:6666,reuseaddr,fork 
```

不起作用，因为这`socat`指示

1.  打开到`/var/lib/mysql/mysql.sock`套接字的 UNIX 域连接。
2.  侦听 TCP 端口 6666（使用`SO_REUSEADDR`）
3.  等待接受连接
4.  建立连接后，生成一个工作子进程以在两个地址之间传输数据。
5.  父级继续接受第二个地址上的连接，但不再有第一个地址可用：它已提供给第一个子级。因此，从这一点开始，没有什么有用的事情可以做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:17:26.193

是的，你可以在 Perl 中做到这一点。

查看[perlipc](http://perldoc.perl.org/perlipc.html)、[IO::Select](http://perldoc.perl.org/IO/Select.html)、[IO::Socket](http://perldoc.perl.org/IO/Socket.html)和[Beej 的网络编程指南](http://www.beej.us/guide/bgnet/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:15:10.387

您可能想考虑在 POE 中执行此操作 - 它是用于处理事件的异步库，因此看起来非常适合该任务。

它不是 100% 相关的，但我使用 POE 在无状态协议 (HTTP) 和有状态协议（telnet 会话，更具体地说 - MUD 会话）之间编写代理，而且它相当简单 - 你可以在这里查看代码：[http ://www.depesz.com/index.php/2009/04/08/learning-poe-http-2-mud-proxy/](http://www.depesz.com/index.php/2009/04/08/learning-poe-http-2-mud-proxy/)。

在评论中，有人还建议 Coro/AnyEvent - 我还没有玩过它，但你可能想检查一下。

# .net - 捕获 .Net 线程结束事件

> ID：893736
> 
> 赞同：3
> 
> 时间：2009-05-21T16:10:25.923
> 
> 标签：.net, multithreading

我想要一种优雅的方式来捕获线程结束/退出事件。到目前为止，我发现了两种方法：

1.  使用具有 RunWorkerCompleted 事件的后台工作程序，或者，
2.  让我的线程工作者明确调用“我正在退出”委托。

是的，这些都会起作用，但是必须有某种方法从父线程（调用 Thread.Start() 方法的线程）来检测线程何时退出，无论为什么、如何或何时退出。例如，当线程退出时，Visual Studio 调试输出窗口会报告：“线程 0x1454 已退出，代码为 0 (0x0)。” 所以应该是可以的。

提前感谢您的任何想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T16:24:49.483

如果您有对 Windows 窗体的引用，则有[Application.ThreadExit](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexit.aspx)事件。

就个人而言，我通常将我的线程处理包装到我自己的类中（出于多种原因，主要是为了使创建和启动具有许多参数的线程变得更加简洁）——这使得添加 Complete 事件变得微不足道。只需让线程的运行代码调用您的线程工作委托，然后引发完整事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T16:12:49.303

您可以从父线程轮询[**ThreadState**](http://msdn.microsoft.com/en-us/library/system.threading.thread.threadstate.aspx)或[**IsAlive**](http://msdn.microsoft.com/en-us/library/system.threading.thread.isalive.aspx)属性

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:25:54.680

您可以使用 thread.join() 这是一个阻塞命令，但会继续执行 com 和 sendMessage。

```
Thread t = new Thread (delegate() { Console.ReadLine(); });

t.Start();

t.Join();    // Wait until thread t finishes

Console.WriteLine ("Thread t's ReadLine complete!"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-27T11:02:38.357

If anyone is googling for this:

I would use option 2 in a slightly modified way. Use a [ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx) (or AutoResetEvent) and let the parent thread wait for your thread to exit with the WaitOne-method.

```
using(ManualResetEvent completed = new ManualResetEvent(false))
{

var thread = new Thread(new ThreadStart(delegate()
{
    try
    {
        // do work here
    }
    finally
    {
        completed.Set();
    }

}));

// start thread
thread.Start();

// wait until thread is completed
completed.WaitOne();
} 
```

You can also use the Thread.Join() which AndrewB suggests but I prefer the `ManualResetEvent` since it gives you more control over how and when it's called.

# .net - 有没有办法为验证器提供默认的 MessageTemplateResourceType？

> ID：893745
> 
> 赞同：0
> 
> 时间：2009-05-21T16:12:23.580
> 
> 标签：.net, validation, application-blocks

我有一个包含许多需要验证的字符串属性的类。我正在使用验证应用程序块，因为我非常喜欢使用属性来解决这种需求。一切都很好，但我的经理不喜欢实现消息模板令牌和资源文件所需的代码量。

例如：

```
 [StringLengthValidator(100, 
        MessageTemplateResourceName = "InvalidStringLengthMessage", 
        MessageTemplateResourceType = typeof(Xltech.Common.Resources.XLStrings))]
 public string FirstName {get; set;} 
```

问题是 100 之后的每个参数（最大字符串长度）对于我们在这个类中的每个 StringLengthValidator 都是相同的（实际上，对于整个解决方案）。

有没有办法至少给验证器一个通用的 MessageTemplateResourceType 以便我可以减少所涉及的复制/粘贴？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-28T13:13:49.140

仍然可以编写自定义属性。

# python - Python PySerial readline 函数错误使用

> ID：893747
> 
> 赞同：2
> 
> 时间：2009-05-21T16:12:34.390
> 
> 标签：python, pyserial

我正在使用脚本导入 PySerial 从 COM4 读取

我想拦截的消息以 # 结尾

所以我尝试使用

```
bus.readline(eol='##') 
```

公共汽车是我的连接。

我希望读起来像：

1.  *#*3##
2.  *#*3##
3.  *#*3##

不幸的是我也发现了

1.  *#*1##*1*1*99##

我希望读到 2 行

1.  *#*1##
2.  *1*1*99##

显然 readline 不起作用，但为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T16:25:22.587

pyserial 中的`readline()`方法一次读取一个字符并将其与 EOL 字符进行比较。您不能将多个字符指定为 EOL。您必须阅读，然后稍后使用`string.split()`或拆分`re.split()`

# c# - InvalidOperationException - 结束编辑单元格并移动到另一个单元格时

> ID：893752
> 
> 赞同：3
> 
> 时间：2009-05-21T16:14:45.463
> 
> 标签：c#, datagridview, invalidoperationexception

我制作了一个程序，我想在其中手动更新数据网格视图。-我有一种方法可以通过清除 DGV 然后重新插入数据来刷新它。- 使用设计器，我为 DGV 的 CellEndEdit 制作了一个事件处理程序。在事件处理程序中，数据得到更新并调用 DGV 的自定义刷新方法。

在运行程序时，每当我开始编辑一个单元格并通过选择另一个单元格来结束它时，都会引发异常：

InvalidOperationException 操作无效，因为它会导致对 SetCurrentCellAddressCore 函数的可重入调用。

Visual C# 的调试器标记清除数据的行：datagridview1.Rows.Clear();

如果您想重现该问题，请使用 Visual c# 创建一个新的 windows 窗体项目，在窗体上放置一个 DataGridView 对象，并将以下代码粘贴到 Form1.cs 中：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Error___DataGridView_Updating___Cell_endedit
{
    public partial class Form1 : Form
    {
        // Objects
        DataTable dt;
        DataColumn colID;
        DataColumn colName;
        DataColumn colInfo;
        // Constructor
        public Form1()
        {
            InitializeComponent();

            Initialize_dt();
            InsertSampleData_dt();
            Initialize_dataGridView1();
        }

        // Methods
        private void Initialize_dt()
        {
            dt = new DataTable();

            // Building Columns
            // ID
            colID = new DataColumn();
            colID.ColumnName = "ID";
            colID.DataType = typeof(int);
            dt.Columns.Add(colID);

            // Name
            colName = new DataColumn();
            colName.ColumnName = "Name";
            colName.DataType = typeof(string);
            dt.Columns.Add(colName);

            //Info
            colInfo = new DataColumn();
            colInfo.ColumnName = "Info";
            colInfo.DataType = typeof(string);
            dt.Columns.Add(colInfo);
        }

        private void InsertSampleData_dt()
        {            
            DataRow row; 

            // 0
            row = dt.NewRow();
            row["ID"] = 100;
            row["Name"] = "AAAA";
            row["Info"] = "First Record";
            dt.Rows.Add(row);

            //1
            row = dt.NewRow();
            row["ID"] = 101;
            row["Name"] = "BBBB";
            row["Info"] = "Second Record";
            dt.Rows.Add(row);

            //2
            row = dt.NewRow();
            row["ID"] = 102;
            row["Name"] = "CCCC";
            row["Info"] = "Third Record";
            dt.Rows.Add(row);
        }

        private void Initialize_dataGridView1()
        {
            dataGridView1.AllowUserToAddRows = false;

            // Data Grid Definitions
            //      Row Header

            dataGridView1.RowHeadersWidthSizeMode = DataGridViewRowHeadersWidthSizeMode.DisableResizing;
            dataGridView1.RowHeadersWidthSizeMode = DataGridViewRowHeadersWidthSizeMode.AutoSizeToAllHeaders;
            //      ColumnHeaders
            dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells;

            // Building Columns
            #region ID
            {
                DataGridViewColumn colSGID = new DataGridViewTextBoxColumn();
                colSGID.Name = "ID";
                colSGID.HeaderText = "#";
                colSGID.ReadOnly = true;
                colSGID.Visible = false;
                colSGID.Resizable = DataGridViewTriState.False;

                dataGridView1.Columns.Add(colSGID);
            }
            #endregion

            #region Name
            {
                DataGridViewColumn colSGName = new DataGridViewTextBoxColumn();
                colSGName.Name = "Name";
                colSGName.HeaderText = "Name";

                dataGridView1.Columns.Add(colSGName);
            }
            #endregion

            #region Info
            {
                DataGridViewColumn colSGSubject = new DataGridViewTextBoxColumn();
                colSGSubject.Name = "Info";
                colSGSubject.HeaderText = "Description";

                dataGridView1.Columns.Add(colSGSubject);
            }
            #endregion

            Refresh_dataGridView1();
        }

        private void Refresh_dataGridView1()
        {
            int index;

            dataGridView1.SuspendLayout();

            dataGridView1.Rows.Clear();

            //MessageBox.Show("Cleared Data. Rebuilding...");

            foreach (DataRow row in dt.Rows)
            {
                index = dataGridView1.Rows.Add(new DataGridViewRow());

                dataGridView1.Rows[index].Cells["ID"].Value = row["ID"];
                dataGridView1.Rows[index].Cells["Name"].Value = row["Name"];
                dataGridView1.Rows[index].Cells["Info"].Value = row["Info"];

                //MessageBox.Show("row #" + index);
            }

            dataGridView1.ResumeLayout();
        }

        //Event Handlers
        private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
        {
            bool toUpdate = false;

            int id = (int)dataGridView1.Rows[e.RowIndex].Cells["ID"].Value;
            string columnName = dataGridView1.Columns[e.ColumnIndex].Name;
            string value = (string)dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value;

            if (value == null)
            {
                value = string.Empty;
            }

            switch (columnName)
            {
                case "Name":
                    if (value == string.Empty)
                    {
                        MessageBox.Show("Name Can't Be Empty!");
                    }
                    else
                    {
                        toUpdate = true;
                    }
                    break;
                case "Info":
                    toUpdate = true;
                    break;
            }

            if (toUpdate)
            {
                foreach(DataRow row in dt.Rows)
                {
                    if ( (int)row["ID"] == id)
                    {
                        row[columnName] = value;
                    }
                }

                Refresh_dataGridView1();
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T18:42:35.870

Bruce.Zhou 在 MSDN 论坛上有一个答案。我在这里发布了它的一个片段。[这里](http://social.msdn.microsoft.com/Forums/en/winformsdatacontrols/thread/7970b78b-4fb6-4138-b49e-fc3e665f866c)也是原始帖子的链接。

```
private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
{
    ...................................................;
    if (toUpdate)
    {
        foreach(DataRow row in dt.Rows)
        {
            if ( (int)row["ID"] == id)
            {
                row[columnName] = value;
            }
        }

        this.BeginInvoke(new MethodInvoker(Refresh_dataGridView1));
    }
} 
```

> ...

使用此修复程序时，无论何时选择新单元格，都会选择它与第一个单元格（包括）之间的所有单元格。我正在寻找一种仅选择新单元格的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-23T02:09:21.050

在过去的一个小时里，我把头撞在键盘上来解决这个问题。这是我的解决方法：查看问题：在选择另一个小区（或GridView中的任何控件时，触发了Endedit。

在应用您的编辑之前应用以下检查：

```
public void myGrid_EndEdit(object sender, DataGridViewCellEventArgs e) 
{
  if (!myGrid.Rows[e.RowIndex].Cells[e.ColumnIndex].Selected)
                return;
  //...rest of your code to apply edit below...
} 
```

这应该适用于正在编辑的任何单元格。（因此失去焦点时不应用编辑；键入 Enter 足以应用编辑）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-20T20:51:47.813

我的解决方法是捕获 CellMouseDown 事件，如果该操作位于正在编辑的单元格以外的单元格上，则它会发出 DataGridView.EndEdit()。其他一切都按预期工作。

# asp.net - 在与 Web 应用程序相同的场上调用 ASP.NET Web 服务

> ID：893753
> 
> 赞同：2
> 
> 时间：2009-05-21T16:14:46.460
> 
> 标签：asp.net, web-services, web-applications, load-balancing, web-farm

当我尝试从 ASP.NET Web 应用程序调用 ASP.NET Web 服务时出现以下错误。我相信这是因为 Web 服务和 Web 应用程序位于同一个场/在同一个负载均衡器后面。

```
A connection attempt failed because the connected party did not properly
respond after a period of time, or established connection failed because
connected host has failed to respond [IP Address removed]:80 
```

当我从本地计算机上的 Web 应用程序调用 Farm 上的 Web 服务时，或者当我从 Farm 上的 Web 应用程序调用本地计算机上的 Web 服务时，不会发生此错误。

知道为什么会发生此错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:44:34.380

我的问题的解决方案是在负载均衡器上打开 NATing。

请求是从场中的服务器向负载均衡器发出的，然后负载均衡器会将该请求发送到场中的其中一台服务器（甚至可能是请求它的同一台服务器）。问题是，正在处理请求的服务器会尝试将响应直接发送回“请求客户端”而不是返回到负载均衡器，因此发出请求的服务器将忽略响应，因为它不是由负载均衡器发送。通过打开 NAT，所有响应都将发送回负载均衡器，然后负载均衡器将响应发送到原始客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:19:14.547

这只是一个猜测，但是 Web 服务器真的可以看到正在使用的 IP 地址吗？如果它位于负载均衡器后面的场中，则该 IP 可能被负载均衡器本身或防火墙或代理服务器阻止。

您可以通过远程桌面和`ping`IP 地址访问 Web 服务器吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T08:47:33.597

您的场节点上的 TCP/IP 堆栈不会将调用路由到负载平衡器的 IP 地址，但会自动将其转换为 127.0.0.1:80 上进行调用的特定场节点上的本地调用. 确保您的 Web 服务器已设置为处理这种情况。

# c# - 导出没有私钥的 X.509 证书

> ID：893757
> 
> 赞同：11
> 
> 时间：2009-05-21T16:15:27.457
> 
> 标签：c#, .net, ssl-certificate, x509certificate2

我认为这很简单，但显然不是。我安装了一个证书，该证书具有一个可导出的私钥，并且我想仅使用公钥以编程方式将其导出。换句话说，当通过 certmgr 导出并导出到 .CER 时，我想要一个等同于选择“不导出私钥”的结果。

似乎所有 X509Certificate2.Export 方法都将导出私钥（如果存在），如 PKCS #12，这与我想要的相反。

有什么方法可以使用 C# 来实现这一点，还是我需要开始深入研究 CAPICOM？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-26T19:03:06.250

对于其他可能偶然发现这一点的人，我想通了。如果您指定`X509ContentType.Cert`为 的第一个（也是唯一一个）参数`X509Certificate.Export`，则它仅导出公钥。另一方面，`X509ContentType.Pfx`如果存在，则指定包括私钥。

我本可以发誓上周我看到了不同的行为，但我在测试时一定已经安装了私钥。当我今天删除那个证书并从头开始时，我看到导出的证书中没有私钥。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-04-07T02:10:00.713

我发现以下程序有助于让自己确信`RawData`证书的属性仅包含公钥（MSDN 对此不清楚），并且上面关于`X509ContentType.Cert`vs.的答案`X509ContentType.Pfx`按预期工作：

```
using System;
using System.Linq;
using System.IdentityModel.Tokens;
using System.Security.Cryptography.X509Certificates;

class Program
{
    static void Main( string[] args )
    {
        var certPath = @"C:\blah\somecert.pfx";
        var certPassword = "somepassword";

        var orig = new X509Certificate2( certPath, certPassword, X509KeyStorageFlags.Exportable );
        Console.WriteLine( "Orig   : RawData.Length = {0}, HasPrivateKey = {1}", orig.RawData.Length, orig.HasPrivateKey );

        var certBytes = orig.Export( X509ContentType.Cert );
        var certA = new X509Certificate2( certBytes );
        Console.WriteLine( "cert A : RawData.Length = {0}, HasPrivateKey = {1}, certBytes.Length = {2}", certA.RawData.Length, certA.HasPrivateKey, certBytes.Length );

        // NOTE that this the only place the byte count differs from the others
        certBytes = orig.Export( X509ContentType.Pfx );
        var certB = new X509Certificate2( certBytes );
        Console.WriteLine( "cert B : RawData.Length = {0}, HasPrivateKey = {1}, certBytes.Length = {2}", certB.RawData.Length, certB.HasPrivateKey, certBytes.Length );

        var keyIdentifier = ( new X509SecurityToken( orig ) ).CreateKeyIdentifierClause<X509RawDataKeyIdentifierClause>();
        certBytes = keyIdentifier.GetX509RawData();
        var certC = new X509Certificate2( certBytes );
        Console.WriteLine( "cert C : RawData.Length = {0}, HasPrivateKey = {1}, certBytes.Length = {2}", certC.RawData.Length, certC.HasPrivateKey, certBytes.Length );

        Console.WriteLine( "RawData equals original RawData: {0}", certC.RawData.SequenceEqual( orig.RawData ) );

        Console.ReadLine();
    }
} 
```

它输出以下内容：

```
原始：RawData.Length = 1337，HasPrivateKey = True
证书 A：RawData.Length = 1337，HasPrivateKey = False，certBytes.Length = 1337
证书 B：RawData.Length = 1337，HasPrivateKey = True，certBytes.Length = 3187
证书 C：RawData.Length = 1337，HasPrivateKey = False，certBytes.Length = 1337
RawData 等于原始 RawData: True

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T16:29:28.117

您可能会发现有一个[OpenSSL .NET 包装器](http://openssl-net.sourceforge.net/)很有用。

# permissions - 关于 PermissionEx (WIX) 的问题

> ID：893759
> 
> 赞同：2
> 
> 时间：2009-05-21T16:15:47.737
> 
> 标签：permissions, wix, wix3

我是 WIX 的新手。我正在使用 util:PermissionEx 创建 ACL。我可以成功设置读取、写入、读取和执行等权限，但我无法找到有关设置修改权限的任何信息。

我曾尝试使用“附加”属性来实现此功能（这似乎是唯一可以实现所需的属性）

但是使用它，会出现以下编译错误：“错误 CNDL0004：util:PermissionEx 元素包含意外的属性 'Append'。”

你能帮我解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-20T11:26:35.553

我的问题，以及在 WiX Permissions 上的自我回答[，我如何用 DACL 标志来表达“修改”，这](https://stackoverflow.com/questions/1301503/wix-permissions-how-do-i-express-modify-in-terms-of-dacl-flags)可能有助于以某种方式将简单的修改权限映射到特定的权限。

查看文档，Append 属性似乎是绝对允许的——你使用的是什么版本的 Wix [3]？使用最新版本，您应该能够从您的标签中删除 util: 和 Ex，因为现在这一切似乎都得到了自然支持。其他示例还显示了`Extended`新版本不接受的属性。

# guid - 如何创建具有特定 GUID 的新记录

> ID：893760
> 
> 赞同：2
> 
> 时间：2009-05-21T16:16:16.927
> 
> 标签：guid, dynamics-crm-4, crm

使用 Dynamics CRM 我正在​​尝试创建实体的实例。我想手动设置 GUID，但如果我有作为 DynamicEntity 主键的属性，我会收到以下错误。

> 服务无法处理请求

我正在构建一个 DynamicEntity，并且设置 [entityname]id 属性会导致请求失败。它在两个 CRM 实例之间移动数据，所以如果有人知道在 CRM 之间复制记录的更好方法，那也可以。否则，我希望 GUID 跨实例匹配……因为这就是 GUID 的意义所在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T13:45:09.013

令人高兴的是，***可以***跨两个 CRM 实例执行此操作！一位同事知道解决方案，所以功劳确实属于他。

我的错误是创建了一个 UniqueIdentifierProperty 类型的属性。实体的主键属性需要用**KeyProperty**填充。这两个属性几乎相同—— 属性类型是，除了一个持有一个 Key，另一个持有 UniqueIdentifier。Key/UniqueIdentifier 都包含 GUID。（微软心中的另一天！）

确切地说，我正在做的是创建一个 DynamicEntity，填写实体名称，并填写大部分属性。可以使用 KeyProperty 填充 PK 属性（您可以从元数据中确定）。我用一个 UniqueIdentifierProperty 填充它，CRM 拒绝它并用一个不伦不类且无用的错误消息进行响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T02:52:56.497

如果我过度简化了解决方案，我深表歉意，但为什么不在两个实例中添加一个自定义字段，作为其他实例 guid 的镜像？

# autocomplete - 如何在 Notepad++ 中启用自动完成支持？

> ID：893761
> 
> 赞同：98
> 
> 时间：2009-05-21T16:16:29.077
> 
> 标签：autocomplete, syntax-highlighting, notepad++

我正在尝试为简单的脚本语言添加简单的语法突出显示和自动完成...

[我使用这篇文章](http://weblogs.asp.net/jgalloway/archive/2006/11/25/creating-a-user-defined-language-in-notepad.aspx)添加了语法高亮

现在我想知道如何使用 Notepad ++ 为我的自定义语言启用自动完成功能。有谁知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2011-09-11T08:06:23.337

Mark 提供的链接不再有效，但您可以访问：

**记事本++ 6.6.9**

*   设置 -> 首选项 -> 自动完成 -> 在每个输入上启用自动完成。

不过我觉得这很烦人，因为总是会出现一个大的自动完成块，我只想在按 Tab 或组合键时看到自动完成。不过，我对 Notepad++ 还是很陌生。如果您知道这样的组合键，请随时回复。我通过谷歌找到了这个问题，所以我们总是可以帮助别人。![在此处输入图像描述](https://i.stack.imgur.com/FXpQ5.png)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-05-21T16:26:21.960

对于基本的自动完成功能，请查看`%ProgramFiles%\Notepad++\plugins\APIs`. 它基本上只是一个带有关键字的 XML 文件。如果您想要调用提示（“函数参数提示”），请查看[这些说明](https://npp-user-manual.org/docs/auto-completion/)。

我再也没有找到任何文档，但是`cpp.xml`有一个 calltip for `fopen`, while`php.xml`非常完整。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-09-24T13:37:22.157

去

> 设置 -> 首选项 -> 备份/自动完成

*   选中**Enable auto-completion on each input**。默认情况下，**功能完成**的单选按钮被选中，这将在您键入时完成相关的功能名称。但是当您编辑代码以外的内容时，您可以检查**Word 完成**。

*   如果您发现难以记住函数参数及其顺序，请检查**函数参数提示输入。**

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-03-27T15:06:27.543

Notepad++ 中的自动完成就像在界面中点击`Ctrl`+`Enter`或`Ctrl`+一样简单。`Space`

`Ctrl`+ `Enter`- 就这么简单！

对于许多人来说，这比自动完成所有内容要好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-16T14:39:39.797

不要忘记添加您的库并检查您的版本。*[使用 Notepad Plus Plus 作为脚本编辑器中有](http://wiki.unity3d.com/index.php?title=Using_Notepad_Plus_Plus_as_a_script_editor)*很好的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-02T11:27:12.340

您也可以添加自己的建议。

打开这个路径：

```
C:\Program Files\Notepad++\plugins\APIs 
```

并打开该语言的XML文件，如php.xml。在这里假设，您想添加**addcslashes**，所以只需添加此 XML 代码。

```
<KeyWord name="addcslashes" func="yes">
    <Overload retVal="void">
        <Param name="void"/>
    </Overload>
</KeyWord> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-02T19:46:03.977

这很容易：

1.  查找带有统一关键字的 XML 文件
2.  仅复制带有“< KeyWord name="......" />”的行
3.  例如，转到 C:\Program Files\Notepad++\plugins\APIs 并找到 cs.xml
4.  粘贴您在 1\. 中复制的内容，但要小心：不要删除 cs.xml 中的任何行
5.  保存文件并享受自动完成 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-14T20:38:58.643

打开 Notepad++ 和设置 -> 首选项 -> 自动完成 -> 检查所需的自动插入选项。此链接将有很大帮助：http: [//docs.notepad-plus-plus.org/index.php/Auto_Completion](http://docs.notepad-plus-plus.org/index.php/Auto_Completion)

# jquery - 使用 jQuery 离开页面时如何添加页面转换

> ID：893764
> 
> 赞同：2
> 
> 时间：2009-05-21T16:18:27.670
> 
> 标签：jquery, transitions

我正在尝试向当用户浏览该站点时页面淡入黑色的站点添加过渡。

我决定实现这一点的最佳方法是创建一个 div，它将页面遮盖为黑色，然后使用 jQuery 对其进行动画处理。

到目前为止，我已经设法创建了“淡入黑色”效果的代码......

```
$(document).ready(function(){
    // Insert mask after container
    $('.container').after('<div class="mask"></div>');
    // Delay the fadeOut effect for half a second so you can actually see it
    $('.mask').animate({opacity: 1.0}, 500)
    // Slowly make the mask dissapear
    .fadeOut('slow');
}); 
```

但是我不确定当用户点击网站的另一部分时如何让页面“从黑色淡出”。

我知道我必须使用点击功能，但我将如何延迟页面加载时间才能看到“淡入黑色”动画？

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T16:30:54.273

您可以绑定到 click() 事件并使其返回 false，从而阻止默认操作（页面转到链接的 href）。然后，您可以将回调绑定到将文档的位置设置为链接的超文本引用的 fadeIn() 方法。

你可以这样做：

```
$('a').click(function(){
  var url = $(this).attr('href');

  $('.mask').fadeIn('slow', function(){
    document.location.href = url;
  });

  return false;
}); 
```

谢谢！杰米

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:36:53.780

捕获点击事件并防止发生默认行为：

```
$('a').click(function(event) {
  event.preventDefault();

  // mask effect code here
}); 
```

这`event.preventDefault()`类似于`onclick='function(); return false;'`在非 jQuery JavaScript 中使用 a 。

# java - Internet Explorer 8 中使用 JInitator 的 Oracle 表单/应用程序

> ID：893767
> 
> 赞同：9
> 
> 时间：2009-05-21T16:19:30.773
> 
> 标签：java, oracle, internet-explorer, web-applications, oracleforms

有没有人能够让运行 JInitator 的 Oracle Forms 在 Internet Explorer 8 中借出？我尝试删除所有附加组件、各种版本的 Java，使用通配符将域添加到受信任的站点，并且使用兼容模式无济于事。我希望我们的 Oracle 人员改掉 Internet Explorer 6 的习惯。这与 Oracle 电子商务有关。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-10T07:08:24.043

要解决此问题，您需要将文件 C:\Program Files\Oracle\JInitiator xxxxx\bin\hotspot\jvm.dll 替换为该文件的 sun 版本。

在我的系统上，sun 版本在这里 C:\Program Files\Java\jre6\bin\client\jvm.dll

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-09T07:06:21.660

替换 jvm.dll 对我不起作用。切换到对我有用的 Sun 的 Java VM 的正确方法是改变这个

```
baseHTMLjinitiator=basejini.htm 
```

对此

```
baseHTMLjinitiator=basejpi.htm 
```

在 formsweb.cfg 文件中。XP SP3 上的 IE8，已启用 DEP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T16:43:24.530

是的，截至目前，IE8 尚未通过 Oracle 应用程序认证。您可能很快就会听到一个好消息！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-15T13:17:17.097

我已经在 Windows7 上成功安装了 Oracle Forms 10g，并让 JPI 和 Jinitiator 都能正常工作。

脚步

*   安装 Dev10g
*   应用补丁 p5983622_10123_WINNT
*   手动安装 JRE 1.6 upd 20
*   为 JPI 配置 formsweb.cfg
*   这是首选方法，因为您不必在每个客户端上执行以下步骤

如果你想使用 Jinitiator 运行

*   为 Jinitiator 配置 formsweb.cfg
*   在客户端机器上安装 Jinitiator 后，[替换 jvm.dll](http://sathyabh.at/2009/06/27/fixing-internet-explorer-crash-on-launching-oracle-forms-application-with-jinitiator/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-11T02:03:13.177

要添加到西蒙的解决方案中的一件事。我在一台计算机上完成了这个技巧，但无法在第二台计算机上重复它。最后，我发现使用 java 6 update 14 中的 jvm.dll 文件替换文件不起作用。当我使用版本 13 中的 jvm.dll 文件时，它工作正常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T11:16:57.490

正如 Mundit 所说，它仍然没有经过认证。

您可以访问 Metalink 吗？注意：760326.1 IE 8 何时通过 E-Bussines Suite 认证？提供了一些进一步的信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-24T17:19:52.273

这里有一些关于 JINIT 更有趣的东西。自 7 月 31 日起，Oracle 不再支持它。您可能需要考虑迁移到 SUN JPI instad。这是 Oracle 现在推荐的路线，因为 JINIT 不会获得更新，所以它是最安全的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-16T18:29:42.617

你们太棒了！我把头发从他们的根上拉下来，现在把它修好了。

1.  我去了控制面板/系统/高级选项卡/启动和恢复面板点击设置。然后在系统启动面板中点击编辑。使 noexecute=AlwaysOff 并保存。
2.  按照 Simon 的说法，我将 Oracle jvm.dll 换成了 Java 版本。不过，我不得不将其降级为 jvm.dll 版本 10.0.0.23。
3.  同样按照西蒙的说法，我去了工具/Internet 选项/安全/受信任的站点/自定义级别并禁用了启用 XSS 过滤器。

不确定#1 是否适用于所有人，但对我来说是必要的。祝你好运！富瓦兹

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-24T13:46:03.957

我的一位同事告诉我执行以下操作：

将服务器添加到受信任的站点，然后：

1.  工具/互联网选项
2.  安全选项卡 -> 受信任的站点
3.  单击自定义级别...按钮
4.  滚动到最后并找到“启用 XSS 过滤器”选项（倒数第三个）
5.  将其设置为禁用

这适用于 11i 和 R12 应用程序。

祝你好运！

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-12-10T05:52:04.400

1.  从 Sun 安装最新的 JRE。我已经安装了“jre-6u10-windows-i586-ps.exe”。

2.  从“C:\Program Files\Java\jre6\bin\client”文件夹复制 jvm.dll（appx Ver 11.0.0.15 大小 2.25 MB（2,359,296 字节））并将其粘贴到安装 Jinitiator 的文件夹（默认位置) 例如“C:\Program Files\Oracle\JInitiator 1.3.1.22\bin\hotspot”。

3.  它适用于 IE8 浏览器。

谢谢您的帮助。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-21T16:28:21.957

我们遇到了类似的问题。

我相信 Oracle 已经意识到了这一点，并且正在开发一个尚未准备好的补丁。

# asp.net - 将 Javascript 确认对话框添加到 LinkBut ton/Form 会生成 Object Expected 错误

> ID：893775
> 
> 赞同：0
> 
> 时间：2009-05-21T16:21:36.400
> 
> 标签：asp.net, javascript, object-expected

我正在尝试将 javascript 确认对话框添加到我的链接按钮 onclick 事件或我的表单 onsubmit 事件。

当我从浏览器收到“预期对象”错误时，它们都不起作用。

```
 frm.Attributes.Add("onsubmit", "return Confirm('Really do this?')") 
```

如何向“onsubmit”或“onclick”事件添加确认对话框而不产生“object expected”错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T16:24:47.390

确认方法应全部为小写字母

前任

```
confirm('Really do this?') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-07T14:57:46.563

利用`OnClientClick="return confirm('Message')"`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-21T17:49:18.390

仍在使用那些传说中的符合框。一些 JQuery BlockUI 怎么样？

[http://malsup.com/jquery/block/#dialog](http://malsup.com/jquery/block/#dialog)

# java - 如何在 Eclipse 中安装 Java 库的源代码？

> ID：893776
> 
> 赞同：3
> 
> 时间：2009-05-21T16:21:56.790
> 
> 标签：java, eclipse

如何在 Eclipse 中安装 Java 库的源代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T18:17:27.837

如果您设置的是 JDK 而不是 JRE，这会自动发生。

通常，当您启动 eclipse 时，它​​会设置用于启动 eclipse 的 JRE。您通常希望使用 JDK 覆盖它，以便获得源代码。去做这个：

1.  首先，确保您安装了 JDK（而不仅仅是 JRE）
2.  开始日食
3.  转到 Window->Preferences->Java->Installed JREs
4.  按添加...
5.  选择“标准虚拟机”并按“下一步...”
6.  按“目录...”，选择JDK安装目录并按“确定”
7.  按“完成”
8.  确保选中新 JDK 旁边的框
9.  按“确定”完成

这将为您正确设置源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:32:11.510

您可以在项目首选项中执行此操作，但我发现只需 ctr+单击标准库中定义的对象或类，然后在页面中“附加源”，它会温和地通知您没有附加源，这会更快。

然后，您可以指向 JDK 发行版中的“src.zip”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T16:35:08.977

我这样做的方式：

先决条件：您已下载源代码。它随 JDK 一起提供。(src.zip)

1.  打开一个Java文件
2.  Ctrl + 单击类名。
3.  单击显示“附加源”的按钮
4.  找到 src.zip 文件。（通常在 JDK 安装位置）
5.  现在你已经安装了源代码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T16:26:55.953

java源码是什么意思？java.lang 包？因为不需要“安装”它们。创建一个新的 Java 项目（任何类型的 Java 项目）就足够了。你能更详细地描述你的问题吗？

# asp.net-mvc - 在 ASP.Net MVC 中将非 www 用户更正为完整的 www 域名

> ID：893781
> 
> 赞同：1
> 
> 时间：2009-05-21T16:23:24.883
> 
> 标签：asp.net-mvc

将未在域名中输入 www 的站点用户重定向到实际获取 www 站点的最佳方法是什么。

IE：我转到 Google.com 并被重定向到 www.Google.com

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:35:00.227

处理此问题的最常见方法是在 URL 不符合您的预期时进行重定向。通常这是使用某种 mod_rewrite 模块完成的。

在 ASP.NET MVC 中，您必须在请求生命周期中尽早捕获传入请求，检查 URL，然后在需要时重定向（响应代码 301 或 302）到正确的 URL。

我从这篇博客文章中找到了示例代码：[Canonical urls With ASP.NET MVC](http://www.rrreese.com/Article/Show/Canonical%20URLS%20With%20ASP.NET%20MVC)。它演示了实现此目的的一种方法：

```
protected void Application_BeginRequest(Object sender, EventArgs e)
{
    if (Request.Url.Authority.StartsWith("www"))
        return;

    string url = (Request.Url.Scheme
       + "://www."
       + HttpContext.Current.Request.Url.Authority
       + HttpContext.Current.Request.Url.AbsolutePath
    );

    Response.Clear();
    Response.Status = "301 Moved Permanently";
    Response.AddHeader("Location", url);
    Response.End();
} 
```

对于我们这些使用 Mono 和 Apache 或使用 IIS 的 mod_rewrite 扩展之一的人，这里有一个 mod_rewrite 示例：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^example.com$ [NC]
RewriteRule ^(.*)$ http://www.example.com$1 [R=301,L] 
```

遵循这些关于拥有 A 记录或 CNAME 的建议仅允许人们从两个域访问该站点，但它会减少您的*Google Juice*，因为您在两个*不同*的URL 上具有相同的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-25T03:16:25.113

如果您使用的是 Microsoft IIS URL 重写模块，那么 web.config 中的以下条目将使您的域保持一致。

```
<rewrite>
            <rules>
                <rule name="Consistent Domain" stopProcessing="true">
                    <match url="^(.*)$" ignoreCase="false" />
                    <conditions>
                        <add input="{HTTP_HOST}" pattern="^mediapopinc.com$" />
                    </conditions>
                    <action type="Redirect" redirectType="Permanent" url="http://www.mediapopinc.com/{R:1}" />
                </rule>
            </rules>
        </rewrite> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:27:10.773

如果要正确处理，则应在 http 服务器上作为别名完成，而不是在您的代码中...imo。

因此，当在没有 www 的情况下联系服务器时，它应该将其重定向到正确的 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-13T11:53:38.740

不应忽略 301 重定向。shahed khan 写了一篇很好的帖子来处理这种情况。 [http://dotnetusergroup.com/blogs/shahedkhan/archive/2009/05/18/10229.aspx](http://dotnetusergroup.com/blogs/shahedkhan/archive/2009/05/18/10229.aspx)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-05-21T16:27:39.227

这最好通过管理您的域的 DNS 服务器上的 A 记录（或 CNAME 记录）来处理。您可以在代码中处理它，但它确实不适合它。

# c# - 抽象类中定义的非抽象事件不会在派生类的设计器中显示

> ID：893782
> 
> 赞同：1
> 
> 时间：2009-05-21T16:24:01.073
> 
> 标签：c#, winforms, generics, user-controls, abstract

我正在使用下面列出的类来创建一个包装 ComboBox 的 UserControl，该 ComboBox 可以接受 List<T> 并在更改内部 ComboBox 的选择时返回 T 类型的对象。

在代码中一切正常，正如我所期望的那样，但是在使用我的控件时，我无法再让 SelectedItemChanged 事件显示在设计器中。当抽象基类是非抽象的时它工作得很好，但我试图将 5 个本质上重复的控件压缩为一个。

不重要的部分被剪掉了。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;

namespace UserComboTest
{
    public abstract partial class DropDownList<T> : UserControl where T : class
    {
        protected abstract int FindIndex(T item);
        public abstract void Populate(List<T> items, T defaultItem);

        [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible), Browsable(true)]
        public event EventHandler<SelectedItemEventArgs> SelectedItemChanged;

        private void comboBox_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (null != SelectedItemChanged)
            {
                SelectedItemChanged(this, new SelectedItemEventArgs(Selected));
            }
        }

        public class SelectedItemEventArgs : EventArgs
        {
            public SelectedItemEventArgs(T selectedItem)
            {
                Selected = selectedItem;
            }

            public T Selected { get; private set; }
        }
    }

    public class UserDropDownList : DropDownList<User>
    {
        protected override int FindIndex(User user)
        {
            // find index for item
        }

        public override void Populate(List<User> users, User defaultUser)
        {
            // populate the list
        }
    }
} 
```

**编辑**：修复了代码破坏问题。结果我的命名空间和表单都被命名为 UserComboTest，所以当它序列化完全限定的类型名称（UserComboTest.UserDropDownList）时，它假定它是表单下的成员或类，而不是命名空间。换句话说，它认为它正在寻找不存在的 UserComboTest.UserComboTest.UserDropDownList。将表单重命名为 UserComboTest.UserComboTestForm 解决了问题的一半。

仍然存在的事实是设计器没有显示 SelectedItemChanged 事件，如果我手动设置它，它会被删除，所以我要么必须在 InitializeComponent 之外设置它，要么弄清楚如何让它被序列化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:04:03.973

通常，winforms 设计器对抽象基类反应很差。您应该将抽象方法转换为空的虚拟方法，并使类非抽象。

# asp.net - 哪些工具可用于将本地化添加到 ASP.NET 项目？

> ID：893786
> 
> 赞同：7
> 
> 时间：2009-05-21T16:24:18.890
> 
> 标签：asp.net, unicode, localization, globalization

我正在处理的一个 ASP.NET 项目将在下一个版本中添加本地化。当我们将 ASPX 页面中的文本提取到资源文件中并将其他数据提取到数据库表中时，我们可能需要评估哪些工具来帮助这个过程？

是否有任何工具可以帮助翻译人员创建本地化文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:51:20.430

**资源重构工具**
[替代文本 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=ResourceRefactoring&DownloadId=3748](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=ResourceRefactoring&DownloadId=3748)

与 IDE 集成的 Microsoft“开源”Visual Studio 工具。只需单击几下，您就可以轻松地将每次出现的字符串替换为资源引用。
[http://www.codeplex.com/ResourceRefactoring](http://www.codeplex.com/ResourceRefactoring)

**Zeta 资源编辑器**
[替代文本 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=ZetaResourceEditor&DownloadId=40997](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=ZetaResourceEditor&DownloadId=40997)

多个资源文件的并排编辑器。
[http://www.codeplex.com/ZetaResourceEditor/](http://www.codeplex.com/ZetaResourceEditor/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-03T00:57:31.550

请参阅 Resharper 进行本地化 -http://www.jetbrains.com/resharper/webhelp/Resources__Index.html

还要检查“创建数据驱动的 ASP.NET 本地化资源提供程序和编辑器” [http://www.west-wind.com/presentations/wwdbresourceprovider/](http://www.west-wind.com/presentations/wwdbresourceprovider/) 它还包括 DbResourceControl，它显示具有 Localizable 属性的控件

来自[http://guysmithferrier.com/Downloads/Top10TipsI18NASPNET.pdf](http://guysmithferrier.com/Downloads/Top10TipsI18NASPNET.pdf)和 [http://www.guysmithferrier.com/post/2009/05/Localizing-ASPNET-MVC.aspx](http://www.guysmithferrier.com/post/2009/05/Localizing-ASPNET-MVC.aspx)

要将您的 HTML 控件转换为等效的 ASP.NET 服务器端控件，请查看[http://www.dotneti18n.com/Downloads.aspx](http://www.dotneti18n.com/Downloads.aspx)（文件夹 VS2010/ASPNETSpecifics/I18NRefactorings ）中的 I18NRefactorings（VS 插件） /I18NRefactorings in the 2010 zip) 将有助于自动化此过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:30:59.313

我发现的一个工具是[RESX Synchronizer](http://www.screwturn.eu/Default.aspx?Page=ResxSync&NS=&AspxAutoDetectCookieSupport=1#F_-_Download)。

这是一个命令行工具，可以同步两个资源文件之间的所有键。例如：

```
resxsync homepage.resx homepage.fr-CA.resx 
```

会将所有密钥从默认 .resx 文件复制到法语加拿大本地化文件。

完成后，只需插入法语文本即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T16:32:45.300

可能想看看 spring.net 的本地化（[http://www.springframework.net/docs/1.2.0/reference/html/web.html#web-localization](http://www.springframework.net/docs/1.2.0/reference/html/web.html#web-localization)）

从站点'Spring.Web 支持几种不同的方法在 Web 应用程序中进行本地化，可以根据需要混合和匹配。支持推送和拉取机制，以及在找不到本地资源时回退到全局定义的资源。Spring.Web 还提供了对用户文化管理和图像本地化的支持，这些将在后面的部分中介绍。

# javascript - swfobject 在 Firefox 3 中不起作用？

> ID：893792
> 
> 赞同：0
> 
> 时间：2009-05-21T16:25:20.340
> 
> 标签：javascript, flash

我的javascript代码如下：

```
BBS.SO = new SWFObject("/Client/Css/sound.swf", "mysound", "1", "1", "8", "#336699");

BBS.SO.write('swfholder'); 
```

它曾经可以工作，但现在在firefox中没有，但在iE中它仍然有效。

swfobject 有这样的错误吗？它是一个开源项目。

似乎在 firefox3 中，将这样的嵌入插入 div 元素时有很大的延迟：

```
<embed id="mysound" height="1" width="1" quality="high" bgcolor="#336699" name="mysound" style="" src="/Client/Css/sound.swf" type="application/x-shockwave-flash"/> 
```

它真的是firefox3的一个错误吗？有什么解决方法吗？

或者你可以查看这个测试页面，

[http://maishudi.com/test.php](http://maishudi.com/test.php)

用IE你会听到声音，

但对于 Firefox3 用户来说，它很安静......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T01:50:11.603

您的示例页面在 Ubuntu (Jaunty) 和 32 位 Windows XP SP3 上为我在 Firefox 3.0.10 中播放了声音。

# c# - 用于 POX 的 WCF REST 教程

> ID：893795
> 
> 赞同：2
> 
> 时间：2009-05-21T16:25:53.303
> 
> 标签：c#, xml, wcf, rest, pox

谁能告诉我在哪里可以找到好的 WCF REST 教程？使用（痘）

[这个](http://msdn.microsoft.com/en-us/library/aa395208.aspx)没问题，但我想用一些更简单的东西

我似乎找不到任何使用 webget/webinvoke 属性等的体面的东西......

我不想使用 REST Starter 工具包

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-30T12:46:33.040

本教程非常简单。有一个截屏视频和源代码。非常适合让您开始使用 WCF REST。

[http://www.michaelckennedy.net/blog/2009/03/24/RESTfulWebServicesWithWCFScreencast.aspx](http://www.michaelckennedy.net/blog/2009/03/24/RESTfulWebServicesWithWCFScreencast.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:39:38.093

我一直在观看有关复数视觉的[WCF 教程，](http://www.pluralsight.com/community/blogs/aaron/archive/2009/03/17/wcf-rest-screencasts-videos.aspx)发现它们非常有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:37:32.373

Channel9 上的节目[endpoint.tv](http://channel9.msdn.com/shows/Endpoint/)有大量 Aaron Skonnard 关于使用 WCF 的截屏视频 - 包括一大堆关于使用 WCF 的 REST 功能的截屏视频。强烈推荐！看看他们，非常值得你花时间！

马克

编辑：

如果您（无论出于何种原因）确实无法使用 REST 入门工具包，您可能需要查看 ADO.NET 数据服务，如此处所述：[REST 入门](https://stackoverflow.com/questions/60477/getting-started-with-rest)

这基本上是基于 WCF 的 REST，作为 ATOM 提要公开。

# html - 我可以禁止网络浏览器自动完成吗？

> ID：893799
> 
> 赞同：18
> 
> 时间：2009-05-21T16:26:24.550
> 
> 标签：html, forms, autocomplete

你知道浏览器如何自动完成文本框吗？显然这让用户感到困惑。他们将其视为只有有限选项的简短列表。

有谁知道如何禁用自动完成？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-21T16:28:59.880

禁用自动完成的正确方法是这样的：

```
<input type="text" name="foo" autocomplete="off"/> 
```

或者

```
<form autocomplete="off" ... > 
```

MSDN：[自动完成属性](http://msdn.microsoft.com/en-us/library/ms533486(VS.85).aspx)

Mozilla：[如何关闭表单自动完成](https://developer.mozilla.org/en/How_to_Turn_Off_Form_Autocompletion#How_to_Turn_Off_the_Autocompletion_Feature)

> 适用浏览器版本：Netscape 6.2 (Mozilla 0.9.4) 或更高版本。IE 5 或更高版本。...
> 
> 此表单属性不是任何 Web 标准的一部分，而是在 Microsoft 的 Internet Explorer 5 中首次引入。Netscape 在 6.2 版中引入了它——在以前的版本中，此属性被忽略了。自动完成属性是在银行和发卡机构的坚持下添加的——但从未遵循过标准认证。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-21T16:30:25.010

有属性`autocomplete`。它目前是一个专有属性（[由 Microsoft 引入，](http://msdn.microsoft.com/en-us/library/ms533032(VS.85).aspx))但正在成为[HTML 5 的一部分](http://www.w3.org/TR/html5/forms.html#attr-form-autocomplete)：

```
<input type="text" id="year" name="year" autocomplete="off" ... /> 
```

有关一些背景和其他信息，请参阅[使用 XHTML 的自动完成属性和 Web 文档](https://wiki.mozilla.org/The_autocomplete_attribute_and_web_documents_using_XHTML)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T16:30:08.410

您可以将`autocomplete`属性添加到输入元素，但请注意，它对于低于 HTML 5 的任何内容都是专有的：

```
<input type="text" id="year" name="year" autocomplete="off" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-21T16:44:54.607

基本上不，你不能。您可以设置因浏览器而异的各种属性（甚至是浏览器版本，感谢 Microsoft），您可以使用 javascript 玩游戏，但最终无法保证字段不会意外或故意自动完成当前或未来版本的浏览器。如果您被告知要实施此操作，您最好的选择是应用一个或两个特定于浏览器的修复程序，然后将这些特定版本列为推荐（或如果您想成为刻薄和疏远客户，则需要）浏览器使用您的网站。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T16:27:15.017

不要为 INPUT 标签使用通用名称/ID？

```
<input type="text" id="year" name="year" ... /> 
```

GUID 非常独特，对吧？

```
<input type="text" id="1b3d0ea8-3562-4937-a3d3-c91041a17c8b" ... /> 
```

那将是有趣的代码维护！

# mercurial - 尝试克隆 mercurial repo 时出现“案例折叠”错误

> ID：893800
> 
> 赞同：19
> 
> 时间：2009-05-21T16:26:29.400
> 
> 标签：mercurial

我尝试在 Windows 上克隆本地 mercurial 存储库。

我收到此错误：

```
 C:\temp\toolkit1.1>hg clone \src\toolkit
   destination directory: toolkit
   updating working directory
   abort: case-folding collision between sdk/Api.h and sdk/api.h 
```

看起来我在某个时候更改了 API.H 的大小写，但我不知道如何解决这个问题。有小费吗？

我正在使用版本：1.2.1

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-21T16:36:59.207

当您在不区分大小写的文件系统 (Windows) 上使用 Mercurial 存储库时，有时会出现此问题。请参阅Mercurial wiki 上的[修复案例碰撞。](http://www.selenic.com/mercurial/wiki/FixingCaseCollisions)

可能最简单的方法是，如果您可以访问 Unix 计算机，请检查那里的项目并删除有问题的文件，首先合并更改（如果有），然后提交并推送。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-21T17:19:17.873

我通过将 Windows 中的文件重命名为 Api.h.old 来解决此问题。承诺。然后用更正的大小写重命名为 Api.h。再次承诺。

然后克隆工作。

# vba - 当我尝试使用我在 Excel 电子表格中定义的 VBA 函数时，我得到“这不是一个有效的函数”

> ID：893804
> 
> 赞同：5
> 
> 时间：2009-05-21T16:27:15.030
> 
> 标签：vba, excel

我在VBA中定义了一个函数如下

```
Public Function Distance(X, Y) as Double 
```

然后在一个单元格中我尝试使用该功能。我键入“@Dis”并获得下拉菜单，选择函数，然后在单元格中输入以@Distance(A1, A2) 结尾的参数。

当我按 Enter 时，我收到错误“该功能无效”。

我在整个系统中启用了宏，尝试将其保存为旧格式和启用宏的工作簿格式，但无济于事。

我使用此功能有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T16:35:23.283

尝试使用：

```
=Distance(A1, A2) 
```

代替

```
@Distance(A1, A2) 
```

我从来没有看到`@`过在 Excel 中调用函数的正确字符。

我在 Excel 中尝试了以下操作，它就像一个魅力：

> 在模块 1 中：

```
Public Function Distance(X as Double, Y as Double) as Double
    Distance = 10
End Function 
```

> 在一个单元格中：

```
=Distance(A1, A2) 
```

产生结果：

> 10

正如预期的那样。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T16:37:23.153

您还需要确保您的函数的 VBA 代码在**模块**中，而不是在工作表的代码区域中。

![](https://farm4.static.flickr.com/3658/3551999916_5ea110f7f8_o.png)

![](https://farm4.static.flickr.com/3566/3552002518_bf871b2cfd_o.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-26T18:07:28.707

不要使用保留字作为函数的名称。我尝试了一个名称 Parse()，但它把它踢了回来，直到我将它重命名为 ParseString()。

# javascript - iphone邮件不会在附加的html文件中显示javascript？

> ID：893805
> 
> 赞同：1
> 
> 时间：2009-05-21T16:27:21.740
> 
> 标签：javascript, iphone, html, email, attachment

当我将 HTML 文件附加到电子邮件中，然后将其通过电子邮件发送到我的 iPhone 时，我可以完美地查看该文件。但是，文件中的任何 javascript 似乎都没有运行 - 甚至没有简单的东西，例如显示/隐藏由“onClick”事件触发的 div。

有没有办法让 javascript 在 iphone 邮件应用程序中的附件上运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:33:54.503

MobileSafari 浏览器支持 JavaScript，但邮件不支持。

我认为要以您希望的方式运行 JavaScript，您必须在浏览器中打开网站。想不出任何其他的方式来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-16T13:35:31.090

不过，您可能可以使用 CSS 获得一些您想要的交互性。这很棘手，因为元素永远不会获得 :hover，但您可以将行为附加到 :target 和 :active 状态以获得一些非常引人注目的交互性，这些交互性在 iPhone、iPad 和 Mac Mail 上的 Mail 中确实有效。（然而，在 gmail 中阅读邮件的人将失去所有这些冷静。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:07:29.930

不会。就像几乎所有仍然存在的电子邮件客户端一样，JavaScript 等将被阻止。

包含 JS 代码实际上可能会阻止您的电子邮件被传递 -`<script>`标签可能会在大多数反垃圾邮件过滤器中引发警告标志。

# design-patterns - XML序列化很慢

> ID：893823
> 
> 赞同：6
> 
> 时间：2009-05-21T16:31:11.810
> 
> 标签：design-patterns, serialization, xml-serialization

我继承了一个项目，其中应用程序的数据模型是 XML 文档。我之前的开发人员已经基于这个 xml 的模式创建了一个对象模型，然后针对该对象模型进行了编码。

经过几年的维护，这款应用逐渐开始显老。团队负责人表示，这背后的关键原因是由于 xml 序列化的“缓慢”。我很想在这方面打电话给 BS，但是我们处理的许多 xml 文件的大小超过 2MB，并且记住在幕后发生的事情的基本知识标记为`[Serializable]`，2MB 需要反映很多所以缓慢理论可能有些道理。

根据您的经验，序列化真的那么“慢”/糟糕到选择 XML -> XPath 模型而不是 XML -> POCO 模型吗？

顺便说一句，这是一个 .NET 2.0 项目，我们的客户*可能*会在明年晚些时候升级到 .NET 3.5。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T16:35:01.303

Xml 序列化不使用 Serializable 属性。xml 序列化程序实际上会生成一个将 xml 映射到对象的程序集，它不使用反射。这是 Xml 序列化仅适用于公众的原因之一。

您可以尝试的一件事是使用`DataContractSerializer`WCF 的一部分进行测量。看到差异会很有趣。

我个人从未遇到过性能限制，但我也没有像您描述的那样大的对象。

需要注意的一件事是您用于创建的构造函数`XmlSerializer`，其中一些不会缓存生成的程序集，并且会导致性能损失和内存泄漏，因为每次调用都会生成越来越多的程序集。如果是这种情况，您有两种选择：

1）缓存您创建的序列化程序实例。我相信它是线程安全的，但您需要仔细检查 MSDN。
2) 使用不同的构造函数来创建 XmlSerializer。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T16:36:20.113

一般来说，不，我不认为减速是由于 XML 序列化；2MB 并没有那么大，它不应该导致任何严重的减速。

我更关心的是团队负责人告诉你减速是由于什么而没有给你任何具体的分析信息告诉你情况就是这样。关于优化的观点经常是错误的；分析存在的目的是准确地找到应用程序中发生任何减速的位置。我建议对应用程序进行检测和分析，并找出减速的​​地方；我敢打赌它不在 XML 序列化中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-22T20:10:45.460

运行分析器并查看大部分 CPU 时间都花在了哪里。无论结果是 XML 序列化还是其他地方，您都会知道将精力集中在哪里。此外，作为记录，过去在 Java 世界中，当使用 Spring RPC 时，我发现 XML 序列化速度非常慢。所以，你的老板当然有可能是对的，但你应该检查而不是猜测。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-24T13:08:22.050

由于这里还没有提到，我想我会指出 VS 中有一个选项可以在构建时生成 XML 序列化程序集。

[http://msdn.microsoft.com/en-us/library/kb4wyys2(v=VS.100).aspx](http://msdn.microsoft.com/en-us/library/kb4wyys2(v=VS.100).aspx)

如果您想要更细粒度的控制，也可以手动使用 sgen.exe 进行生成。

这减少了序列化类型所需的时间，因为正如 JoshBerke 上面所说，XmlSerialiser 会在需要序列化或反序列化时生成一个新程序集，这对于复杂类型可能需要一些时间。因此，预生成序列化程序集可以显着提高性能。

# sql - 将 Avg() 与 SQL 更新一起使用

> ID：893824
> 
> 赞同：3
> 
> 时间：2009-05-21T16:31:18.360
> 
> 标签：sql, ms-access, sql-update

我有一个包含多个读数的表_miu_id，每个表都有多个 RSSI 读数（RSSI 也是该字段的名称）。所以，我目前有一个数据表，有很多列，但与这次对话相关的两个看起来像这样：

```
readings_miu_id  RSSI
===============  ====
11011032         -90
11011032         -81
11011032         -62
11011032         -84
11011032         -86
11010084         -84
11010084         -86
11010084         -87 
```

等等。

我最初的计划是更改具有相同 readings_miu_id 的每条记录的 RSSI 值和该 readings_miu_id 的平均 RSSI（除了单个 RSSI 将被该 miu 的平均 RSSI 替换之外，它应该与上面相同），并且然后为每个不同的 readings_miu_id 只提取一个记录（我很确定我可以使用 select top 1 type 语句来做到这一点。）但是我在弄清楚第一部分时遇到了问题。我尝试过的似乎应该接近的 sql 语句是：

```
UPDATE analyzedCopy2 as A 
SET analyzedCopy2.RSSI = Avg(RSSI) 
where readings_miu_id = A.readings_miu_id 
```

和

```
UPDATE analyzedCopy2 as A 
SET RSSI = Avg(select RSSI from analyzedCopy2 
    where readings_miu_id = A.readings_miu_id) 
WHERE readings_miu_id = A.readings_miu_id; 
```

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T16:36:42.623

不确定为什么要更新记录。

如果你只想要一个平均读数，你可以这样做：

```
SELECT readings_miu_id, AVG(RSSI)
FROM analyzedCopy2 
GROUP BY readings_miu_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T12:47:46.443

请参阅这个[问题](https://stackoverflow.com/questions/839938/mysql-sql-update-with-correlated-subquery-from-the-updated-table-itself)，其中讨论了类似的场景。

您正在查找的查询是这样的（我这里没有 SQL shell，因此可能存在轻微的语法问题）：

```
UPDATE analyzedCopy2 AS target
INNER JOIN 
(
    select avg(RSSI) as AvgRSSI, readings_miu_id
    from analyzedCopy2 T
    group by readings_miu_id
) as source
ON target.readings_miu_id = source.readings_miu_id
SET target.RSSI = source.AvgRSSI 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-13T10:20:43.993

看：

[ACC：根据总计查询失败更新查询](http://support.microsoft.com/kb/116142)

“这种行为是一种设计限制……有三种方法可以解决这种行为……”

# regex - VBScript RegExp 不够贪心

> ID：893826
> 
> 赞同：2
> 
> 时间：2009-05-21T16:31:29.127
> 
> 标签：regex, parsing, vbscript, regex-greedy

我正在尝试编写一个简单的 sql 解析器来将 sql 语句分解为其基本部分。但是，我遇到了嵌套查询的问题。一个例子最好地说明：

```
sql = "select * from Customers where id in (select customer_id from Orders where 1=1)"
Set re = New RegExp
re.IgnoreCase = True
re.Pattern = "^(.*)\swhere\s(.*)$"
re.Global = True
Set matches = re.Execute( sql )

If matches.count > 0 Then
    Set submatches = matches(0).Submatches
    where_part = Trim(submatches(1))
    everything_else = Trim(submatches(0)) 
End If 

Response.Write where_part & "<br>"
Response.Write everything_else & "<br>" 
```

在这里，我希望 where_part 包含“id in (select customer_id from Orders where 1=1)”，而 Everything_else 包含“select * from Customers”。也就是说，我希望它对第二个（。*）尽可能贪婪，对第一个无私。或者换一种说法，我希望everything_else 不包含任何地方。

但是，我得到了 everything_else = "select * from Customers where id in (select customer_id from Orders" and where_part = "1=1)"

如何在不使用混乱的非正则表达式字符串解析的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-21T16:35:19.023

相反，你的正则表达式太贪心了。

.* 捕获最长的匹配字符串，直到您的示例中的第二个位置。

试试这个：

```
^(.*?)\swhere\s(.*) 
```

这 ？使 .* 表现得不那么贪婪，这意味着它将在第一次出现时停止。

# eclipse - Eclipse（3.4）：如果有错误，如何让问题自动出现？

> ID：893836
> 
> 赞同：0
> 
> 时间：2009-05-21T16:35:07.307
> 
> 标签：eclipse, flexbuilder

当我在 FlexBuilder 中构建项目时，我希望立即看到任何错误；我不想每次都悬停或打开“问题”窗格，也不想一直保持打开状态。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T17:06:18.510

我不认为这是一个问题。

据我所知 Eclipse 设置并没有这样的设置。

您可以使用快捷键 SHIFT+ALT+Q 并按 X 快速打开问题面板。

# c++ - 使用 Xcode 在 Mac 上构建 Boost

> ID：893841
> 
> 赞同：16
> 
> 时间：2009-05-21T16:35:39.337
> 
> 标签：c++, xcode, macos, boost, build

我最近熟悉了 Boost 库，我想在我的 Xcode 项目中使用它。但遗憾的是，没有关于如何做到这一点的 HowTo 或常见问题解答 :(

在 Xcode 中构建和使用 Boost 库的操作顺序是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-21T16:51:09.927

我发现最简单的方法是安装[MacPorts](http://www.macports.org/)，然后您可以通过单个命令安装/构建 Boost：

```
sudo port install boost 
```

此外，您还可以获得对其他开源软件的类似访问权限。我发现的唯一缺点是，与任何其他包管理系统一样，它们并不总是与最新版本保持同步。

如果你更喜欢[Homebrew](http://brew.sh/)作为你的包管理器，命令是：

```
brew install boost 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T16:42:06.093

我不知道如何使用 XCode 中的 Boost（我不是 Mac 程序员），但构建 boost 通常是通过他们自己的构建工具 bjam 完成的。

他们在[此处提供了构建 boost 的指南，您可以在](http://www.boost.org/doc/libs/1_39_0/more/getting_started/unix-variants.html)[此处](http://sourceforge.net/project/showfiles.php?group_id=7586&package_id=72941&release_id=643622)下载最新版本的 bjam

构建完成后，您可以像引用任何其他库一样从 Xcode 引用它。boost/include 应该被添加到你的包含路径中，并且 boost/lib 中的库可以被引用到需要它的 boost 库中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-21T16:43:04.670

要在 Mac 上构建 boost，请遵循 unix 变体入门页面 ( [http://www.boost.org/doc/libs/1_39_0/more/getting_started/unix-variants.html](http://www.boost.org/doc/libs/1_39_0/more/getting_started/unix-variants.html) )。您不会直接使用 Xcode 来执行构建，但是一旦完成，您就可以将 boost 包含路径和 dylib 添加到您的 Xcode 项目中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-11T22:33:15.943

我发现要在 MacOS 上构建 Boost 1.41.1，您需要执行以下操作：

1.  从这里下载 boost 1.46.1：http: [//sourceforge.net/projects/boost/files/boost/1.46.1/](http://sourceforge.net/projects/boost/files/boost/1.46.1/)
2.  解压文件
3.  打开终端，cd 到安装目录，然后执行以下操作：

> chmod u+x 配置.sh
> 
> cd 工具/build/v2/engine/src
> 
> chmod u+x build.sh

然后回到安装目录，然后：

> ./configure.sh

如果运行成功，它会告诉你运行：

> ./bjam

就是这样..无论出于何种原因，我都需要手动设置这些权限才能正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T15:02:43.493

苏根

输入root密码，然后在下面以root身份运行

/opt/local/bin/port 安装升压

如果您从未以 root 身份登录或忘记密码，以下是重置 root 密码的步骤

[http://support.apple.com/kb/HT1528?viewlocale=en_US&locale=en_US](http://support.apple.com/kb/HT1528?viewlocale=en_US&locale=en_US)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-10T08:33:47.357

目前，我对使用**Pete Goodliffe**的脚本非常满意，该脚本从 Boost 源代码包为 iOS 和 Mac 构建了一个框架。将它拖放到一个项目中，它就可以工作了！

该脚本有多个版本。这是一个： [https ://gist.github.com/faithfracture/c629ae4c7168216a9856/61be257e1c0839c85743777d0687becad9913bf7](https://gist.github.com/faithfracture/c629ae4c7168216a9856/61be257e1c0839c85743777d0687becad9913bf7)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T16:42:58.820

对于大多数 boost 库，没有什么可构建的，它们都在头文件中。其余的说明在[这里](http://www.boost.org/doc/libs/1_39_0/more/getting_started/unix-variants.html)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-12T01:09:46.323

费鲁西奥的回答：

1.  [使用MacPorts](http://www.macports.org/) ( `sudo port install boost`) 或[Homebrew](http://brew.sh) ( )安装 Boost `brew install boost`。

2.  `/opt/homebrew/include`找到 Boost 头文件的路径（如果你使用 Homebrew ，它应该在里面）。

3.  在 Xcode 目标的 Build Settings 中添加 System Header Search Paths 的路径。

**重要说明**：如果您像其他用户建议的那样将路径添加到用户标题搜索路径而不是系统标题搜索路径，那么您的代码将无法构建，因为 Boost 文件使用有角度的包含 ( `#include <boost/filename.hpp>`) 来包含彼此。Angled-includes 仅用于包含系统库头文件，因此它们仅在 Boost 位于系统头文件搜索路径中时才有效。

[您可以在此处](https://stackoverflow.com/questions/21593/what-is-the-difference-between-include-filename-and-include-filename)了解有角度的包含和引用的包含之间的区别。

# winforms - 从表单移动到用户控件

> ID：893844
> 
> 赞同：1
> 
> 时间：2009-05-21T16:36:32.470
> 
> 标签：winforms, user-controls, refactoring

我有一堆嵌入标签页的表单（*有些嵌入了两三层深*），我现在怀疑它们给我带来了麻烦。有人告诉我，用户控制是更好的方法。

*   现在我想知道如何尽快完成这项工作。

*   复制粘贴就这么简单吗？

*   有没有人做过这样的事情？

我有大约 40 种嵌入的表格需要移动，而且时间不多，因此非常感谢任何帮助。

## 编辑 1

这就是我嵌入表单的方式：

```
 public static void ShowFormInContainerControl(Control ctl, Form frm)
    {
        frm.TopLevel = false;
        frm.FormBorderStyle = FormBorderStyle.None;
        frm.Dock = DockStyle.Fill;
        frm.Visible = true;
        ctl.Controls.Add(frm);
    }

        public static void DockControl(this Control control, UserControl userControl)
    {
        userControl.Dock = DockStyle.Fill;
        control.Controls.Clear();
        control.Controls.Add(userControl);
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T16:48:21.260

不确定它是否是“最好的”，但这可能是最有效的。将类更改为继承自`UserControl`而不是`Form`. 如果/当您遇到任何错误时，请修复编译器错误（请参阅下面的注释 2）。

注意 1：如果您不使用版本控制，请在执行此类激烈操作之前开始使用它。如果某些东西向南走得太远，您将希望能够返回。

注意 2：如果您使用`Form`未在 中实现的任何特定事件或属性，则`UserControl`必须考虑解决方案。某些属性（`Icon`例如）您可以放心地忽略（= 从设计器文件中删除该行）。

注意 3：如果您在某处将表单用作实际表单，您还需要一个使用新创建的 UserControl 的表单。你最有可能在命名方面遇到麻烦，所以要保持敏锐的眼光。

# javascript - 使用 javascript 调用 flash

> ID：893853
> 
> 赞同：0
> 
> 时间：2009-05-21T16:38:11.030
> 
> 标签：javascript, flash

我搜索了 ExternalInterface 但不知道如何实现它。

单击图像元素时，我想运行/执行闪光灯。

```
<img src="a.png" onclick="runFlash()" /> 
```

我的闪光灯

```
<OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" WIDTH="16" HEIGHT="16" id="flashUpload" ALIGN="">
 <PARAM NAME=movie VALUE="{swf_upload_url}?UploadSession={upload_session}&AccessKey={AccessKey}&ServerID={ServerID}&ShowTopBtn=1&TopBtnIcon={SKIN_DIR}/images/a.png">
 <PARAM NAME=quality VALUE=high>
 <PARAM NAME=allowScriptAccess VALUE=always>
 <PARAM NAME=bgcolor VALUE=#000000>
 <PARAM NAME=wmode VALUE=transparent>
 <EMBED src="{swf_upload_url}?UploadSession={upload_session}&AccessKey={AccessKey}&ServerID={ServerID}&ShowTopBtn=1&TopBtnIcon={SKIN_DIR}/images/a.png" quality=high bgcolor=#000000  WIDTH="32" HEIGHT="32" NAME="flashUpload" ALIGN="" TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED>
</OBJECT> 
```

你能帮我举一个详细的例子吗？

我尝试将图像放在具有绝对位置的闪光灯上方，但单击时闪光灯无法运行。

谢谢你。

问候，

什尚特·托迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T16:48:44.193

您可以尝试使用[SWFObject](http://blog.deconcept.com/swfobject/)并在您的 runFlash() 函数中添加类似的内容：

```
var so = new SWFObject("movie.swf", "mymovie", "400", "200", "8", "#336699");
so.write("flashcontent"); 
```

只需在最初包含图像的名为“flashcontent”的页面上放置一个 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T16:55:49.903

这就是你的 AS3 的样子：

```
ExternalInterface.addCallback("runFlash", jsCallsRunFlash);

function jsCallsRunFlash()
{
    ...
} 
```

**//编辑**

这里[是 AS2 版本教程](http://blog.deconcept.com/2005/08/16/external-interface/)

# java - 如何将条件链变成更快、更丑的代码？

> ID：893855
> 
> 赞同：0
> 
> 时间：2009-05-21T16:38:48.923
> 
> 标签：java, performance, parsing, dictionary, antlr

我有 9 种不同的语法。其中一个将根据它正在解析的文件的第一行 txt 的内容来加载。

我正在考虑将词法分析器/解析器派生到 sep. 类，然后在我得到匹配后立即实例化它们——但不确定这是否会减慢我的速度。我想一些基准测试是有序的。

真的，**速度**绝对是我的目标，但我知道这是丑陋的代码。

现在代码看起来像这样：

```
sin.mark(0)
site = findsite(txt)
sin.reset()

if ( site == "site1") {
   loadlexer1;
   loadparser1;
} else if (site == "site2") {
   loadlexer2;
   loadparser2;
}
.................
} else if (site == "site8") {
   loadparser8;
   loadparser8;
}

findsite(txt) {
  ...................
  if line.indexOf("site1-identifier") {
    site = site1;
  } else if(line.indexOf("site2-identifier") {
    site = site2;
  } else if(line.indexOf("site3-identifier") {
    site = site3;
  }
  .........................
  } else if(line.indexOf("site8-identifier") {
    site = site8;
  }
} 
```

**一些澄清**

1) 是的，我确实有 9 种不同的语法，我用 antlr 构建，所以它们都有自己的词法分析器/解析器对象。

2) 是的，截至目前，我们正在比较字符串，显然它将被某种整数映射替换。我还考虑将站点标识符粘贴到一个正则表达式中，但是我不相信这会加快任何速度。

3）是的，这是伪代码，所以我不会对这里的语义过于挑剔..

4) kdgregory 指出我无法创建词法分析器/解析器对的一个实例是正确的

我喜欢散列的想法，让代码看起来更好看，但我不认为它会**加快**我的速度。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T16:51:57.850

标准方法是使用 Map 将键字符串连接到将处理它们的词法分析器：

```
Map<String,Lexer> lexerMap = new HashMap<String,Lexer>();
lexerMap.put("source1", new Lexer01());
lexerMap.put("source2", new Lexer02());
// and so on 
```

检索到标识要使用的词法分析器的字符串后，您可以从 Map 中检索它，如下所示：

```
String grammarId = // read it from a file, whatever
Lexer myLexer = lexerMap.get(grammarId); 
```

但是，您的示例代码有一些怪癖。首先， indexOf() 调用表明您没有独立的字符串，并且 Map 不会查看字符串内部。因此，您需要有某种方法从您读取的任何字符串中提取实际密钥。

其次，词法分析器和解析器通常会维护状态，因此您将无法创建单个实例并重用它。这表明您需要创建一个工厂类，并将其存储在映射中（这是抽象工厂模式）。

如果您希望有很多不同的词法分析器/解析器，那么使用映射驱动的方法是有意义的。对于少数人来说，if-else 链可能是您最好的选择，正确封装（这是工厂方法模式）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T16:42:03.177

使用多态性几乎可以保证比字符串操作更快，并且会在编译时检查其正确性。真的`site`是字符串吗？如果是这样，FindSite 应该被称为 GetSiteName。我希望 FindSite 返回一个`Site`知道适当词法分析器和解析器的对象。

另一个速度问题是编码速度。在单独的类中拥有不同的词法分析器和解析器肯定会更好（也许在另一个类中具有共享功能）。它会让你的代码稍微小一点，而且对别人来说更容易理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T16:51:20.693

就像是：

```
Map<String,LexerParserTuple> lptmap = new HashMap<String,LexerParserTuple>();
lpt=lptmap.get(站点)
lpt.loadlexer()
lpt.loadparser()

```

结合一些正则表达式魔术而不是 string.indexOf() 来获取站点的名称应该可以显着清理您的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T16:55:37.407

[用多态性替换条件](http://www.refactoring.com/catalog/replaceConditionalWithPolymorphism.html)

对于半成品，对于 findsite()，您可以简单地设置一个 HashMap 来让您从站点标识符到站点。另一种清理方法是简单地返回站点字符串，因此：

```
String findsite(txt) {
  ...................
  if line.indexOf("site1-identifier") 
    return site1;
  if(line.indexOf("site2-identifier")
    return  site2;
  if(line.indexOf("site3-identifier")
    return  site3;
...
} 
```

以这种方式使用 indexOf() 并没有真正的表现力；我会使用 equals() 或 contains()。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T17:01:48.270

> *我正在考虑将词法分析器/解析器派生到 sep. 类，然后在我得到匹配项后立即实例化它们*

看起来你已经有了答案。这将创建更灵活但不需要更快的代码。

> *我想一些基准测试是为了*

是的，使用这两种方法进行衡量并做出明智的决定。我的猜测是你已经拥有它的方式就足够了。

也许，如果让您烦恼的是有一个[“公里”方法，您可以使用](https://stackoverflow.com/questions/235474/what-infuriates-you-the-most-when-maintaining-others-code/235523#235523)[extract 方法](http://www.refactoring.com/catalog/extractMethod.html)在不同的函数中重构它。

最重要的是首先要有一个解决方案，即使它很慢也能完成这项工作，一旦你让它工作，分析它并检测可以提高性能的点。记住[“优化规则”](http://c2.com/cgi/wiki?RulesOfOptimization)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T17:05:25.330

假设您的代码效率低下。

实际解析输入所需的时间会超过（比如说）1% 的时间吗？

如果没有，你有更大的“炸鱼”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T20:11:16.203

我不了解 Java，但某些语言允许 switch 接受字符串。

```
switch(site)
{
    case "site1": loadlexer1; loadparser1; break;
    case "site2": loadlexer2; loadparser2; break;
    ...
} 
```

至于秒位，使用正则表达式提取标识符并打开它。您最好使用`enum`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T16:52:47.257

我会更改 findsite 的类型以返回站点类型（超类），然后利用多态性...这应该比字符串操作更快...

你需要单独的词法分析器吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-21T16:55:27.050

使用地图将站点配置为加载策略结构。然后需要根据“站点”进行简单查找，然后执行适当的策略。findSite() 也可以这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-21T16:55:41.353

可以有一个标识符与站点的映射，然后只需遍历映射条目。

```
// define this as a static somewhere ... build from a properties file
Map<String,String> m = new HashMap<String,String>(){{
    put("site1-identifier","site2");
    put("site2-identifier","site2");
}}

// in your method
for(Map.Entry<String,String> entry : m.entries()){
    if( line.contains(entry.getKey())){
        return line.getValue();
    }
} 
```

清洁工：是 更快：不知道......应该足够快

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-21T16:55:56.550

你可以使用反射

```
char site = line.charAt(4);
Method lexerMethod = this.getClass().getMethod( "loadLexer" + site, *parameters types here*)
Method parserMethod = this.getClass().getMethod( "loadparser" + site, *parameters types here*)

lexerMethod.invoke(this, *parameters here*);
parserMethod.invoke(this, *parameters here*); 
```

# php - PHP mycrypt 问题，奇怪的字符/警告

> ID：893859
> 
> 赞同：2
> 
> 时间：2009-05-21T16:39:40.980
> 
> 标签：php, mcrypt

我不知道我做错了什么。我只需要能够加密和解密而不会收到奇怪的字符或警告。它说我应该使用长度为 16 的 IV，并且我使用的长度为 9，但“0123456789abcdef”是 16 个字符。

> 警告：mcrypt_generic_init() [function.mcrypt-generic-init]：IV 大小不正确；提供长度：9，需要：第 10 行 /home/mcondiff/public_html/projects/enc/enc.php 中的 16

见[http://www.teamconcept.org/projects/enc/enc.php](http://www.teamconcept.org/projects/enc/enc.php)

我迷失了，困惑，有点头晕目眩。我从这里去吗？我必须使用这种加密并让它为一个项目工作。

```
<?php

class enc
{
    function encrypt($str, $key) {
        $key = $this->hex2bin($key);

        $td = mcrypt_module_open("rijndael-128", "", "cbc", "fedcba9876543210");

        mcrypt_generic_init($td, $key, CIPHER_IV);
        $encrypted = mcrypt_generic($td, $str);

        mcrypt_generic_deinit($td);
        mcrypt_module_close($td);

        return bin2hex($encrypted);
    }

    function decrypt($code, $key) {
        $key = $this->hex2bin($key);
        $code = $this->hex2bin($code);

        $td = mcrypt_module_open("rijndael-128", "", "cbc", "fedcba9876543210");

        mcrypt_generic_init($td, $key, CIPHER_IV);
        $decrypted = mdecrypt_generic($td, $code);

        mcrypt_generic_deinit($td);
        mcrypt_module_close($td);

        return utf8_encode(trim($decrypted));
    }

    function hex2bin($hexdata) {
        $bindata = "";

        for ($i = 0; $i < strlen($hexdata); $i += 2) {
            $bindata .= chr(hexdec(substr($hexdata, $i, 2)));
        }

        return $bindata;
    }

}

$theEncryption = new enc();
$user = "John Doe";
$email = "john@example.com";
$user = $theEncryption->encrypt($user, "0123456789abcdef");

$email = $theEncryption->encrypt($email, "0123456789abcdef");

echo 'User: '.$user;
echo 'Email: '.$email;

?> 
```

有人可以指出我正确的方向或指出我做错了什么吗？

谢谢

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:10:17.707

CIPHER_IV 可能是一个未定义的常量。PHP 提出“使用未定义常量”的通知，然后使用“常量”作为字符串。字符串“CIPHER_IV”的长度为 9 个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:20:01.820

在您的 php 文件中，打印 CIPHER_IV 并查看它包含的内容。

有关详细信息，请参见[http://us2.php.net/mcrypt_generic_init](http://us2.php.net/mcrypt_generic_init)

您可能已经从博客中复制粘贴了代码：谷歌搜索 mcrypt_generic_init CIPHER_IV 只会给出这篇文章和博客；）

IV 是你需要指定给函数的参数，而不是第一个博主误解第二个博主的文章的常量。

在[http://propaso.com/blog/?cat=6](http://propaso.com/blog/?cat=6)，他们声明了这些：

```
$secret_key = "01234567890abcde";
$iv         = "fedcba9876543210"; 
```

然后做：

```
mcrypt_generic_init($td, $secret_key, $iv); 
```

只需将您的 IV 声明为某物，然后使用它。

# sql-server - SUM 行、返回计数和按日期排序

> ID：893863
> 
> 赞同：1
> 
> 时间：2009-05-21T16:41:44.580
> 
> 标签：sql-server

抱歉卡在这个查询上，因为我在 order by 子句中有数据，它告诉我必须放入聚合或 group by 子句？（即使我不需要那个总值？）。

表 UserData（userID、sales、credits、dateCreated）

我的查询必须返回最后 10 个结果：

SELECT TOP 10 COUNT(*) as totalDays, SUM(sales), SUM(credits) FROM UserData WHERE userID = @userID ORDER BY dateCreated DESC

我有 totalDays 因为它可能不会返回我要求的天数（在这种情况下是 10，但以后可以更改）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T16:47:20.590

这为您提供了过去 10 天的总数：

```
SELECT
    COUNT(*) as totalDays, SUM(sales), SUM(credits) 
FROM 
    UserData 
WHERE 
    userID = @userID 
    AND DateCreated > GETDATE() - 10 
```

最近 10 次销售

```
SELECT COUNT(*) as totalDays, SUM(sales), SUM(credits) 
FROM
    (SELECT TOP 10 sales, credits
    FROM UserData 
    WHERE userID = @userID 
    ORDER BY dateCreated DESC) X 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:09:34.710

在结果中只返回单行的查询上使用`top`or是没有意义的。`order by`首先，您必须使查询返回多行才能使用它们。

这将简单地汇总所有销售额并返回一行，因此您必须先对其执行一些操作：

```
select count(*) as totalDays, sum(sales), sum(credits)
from UserData
where userID = @userID 
```

如果要对最后十个销售额进行汇总，则需要一个子查询，首先隔离这十个销售额，然后可以将它们聚合：

```
select count(*) as totalDays, sum(sales), sum(credits)
from (
   select top 10 sales, credits
   from UserData
   where userID = @userID
   order by dateCreated desc
) LastData 
```

如果你想每天总结过去十天的回报，你需要按日期分组：

```
select top 10 count(*) as totalDays, sum(sales), sum(credits)
from UserData
where userID = @userID
group by dateCreated
order by dateCreated desc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T16:47:57.097

这是因为 * (ALL) 字段而发生的。由于您进行聚合，您应该选择另一个字段进行计数，任何字段都可以在您的情况下执行，这会使您的查询如下所示：

SELECT TOP 10 COUNT(USERID) AS TOTALDAYS, SUM(SALES), SUM(CREDITS) FROM USERDATA WHERE userid = @userid GROUP BY datecreated ORDER BY datecreated DESC

即使在 SELECT 子句中没有使用 datecreated，它仍然需要在 GROUP BY 部分中。

希望这可以帮助。

# vb.net - 如何使用 VB.NET 在另一台计算机上执行批处理文件？

> ID：893867
> 
> 赞同：0
> 
> 时间：2009-05-21T16:42:24.237
> 
> 标签：vb.net, batch-file, remote-execution

在 vb.net 2008 中，我想执行驻留在另一台计算机上的批处理文件。没有错误，但没有任何反应。这是代码：

```
Dim pStart As New System.Diagnostics.Process
Dim startInfo As New System.Diagnostics.ProcessStartInfo(serverpath & "\file.bat")
startInfo.RedirectStandardOutput = True
startInfo.WindowStyle = ProcessWindowStyle.Hidden
startInfo.UseShellExecute = False
pStart = System.Diagnostics.Process.Start(startInfo)
pStart.WaitForExit()
pStart.Close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:17:41.500

我从未尝试使用批处理文件作为可执行文件来创建进程。我一直不得不使用 cmd.exe 作为程序。这在过去对我有用：

```
Dim startInfo As New System.Diagnostics.ProcessStartInfo("cmd.exe", "/c " & serverpath & "\file.bat") 
```

参数列表中的“/c”告诉 cmd.exe 在批处理文件完成后退出。

如果您打算使用 RedirectStandardOutput，您确实希望使用 RedirectStandardError，然后还订阅 Process 类的事件以捕获这些流上的数据（OutputDataReceived 和 ErrorDataReceived）。否则你将无法调试你的批处理脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T20:10:02.867

要在远程计算机上运行进程，您可以使用 Sysinternals free [psexec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)。

您可以使用正确的参数调用它并拥有所需的权限，就像您在示例代码中所做的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T19:53:23.180

这看起来像是权限问题。如果您还没有排除它，我会以这种方式进行故障排除。
您是否尝试过从本地计算机运行相同的批处理文件？
如果是权限问题，您可以在执行文件之前在本地复制文件或将驱动器映射到文件所在的远程计算机，然后从新路径执行批处理文件。

此外，我们真的不知道批处理文件中可能导致问题的内容。我会发布批处理文件，或者如果您无法发布批处理文件，请使用您可以发布的批处理文件。例如，批处理文件会将当前日期时间写入文件。

# apache - 无法使用 .htaccess 添加斜线

> ID：893868
> 
> 赞同：1
> 
> 时间：2009-05-21T16:42:53.470
> 
> 标签：apache, url, .htaccess, apache2, backslash

我有一个网站，上面有一些 html 文件。其中之一是contact.html。这是我的 .htaccess，我在可以使用 site.com/contact 而非 site.com/contact/ 寻址页面时遇到问题。（注意结束斜线。）解决方法是什么？

```
RewriteEngine On

# If the requested URI does not contain a period in the final path-part
RewriteCond %{REQUEST_URI} !(\.[^./]+)$
# and if it does not exist as a directory
RewriteCond %{REQUEST_fileNAME} !-d
# and if it does not exist as a file
RewriteCond %{REQUEST_fileNAME} !-f
# then add .html to get the actual filename
rewriterule (.*) /$1.html [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T21:23:23.343

代替：

```
rewriterule (.*) /$1.html [L] 
```

尝试：

```
RewriteRule ^([^/]*)/?$ /$1.html [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-26T15:44:11.760

```
RewriteRule ^([^/]*)/?$ $1.php [L] 
```

就我而言，我将在 $1 之前删除斜线并且它有效！我很高兴从您的评论中学到很多东西。

# php - MySQL：动态确定表的主键

> ID：893874
> 
> 赞同：19
> 
> 时间：2009-05-21T16:44:16.870
> 
> 标签：php, sql, mysql, primary-key

我在 PHP 中生成这样的 SQL 查询：

```
$sql = sprintf("UPDATE %s SET %s = %s WHERE %s = %s", ...); 
```

由于这个查询的几乎每个部分都是动态的，我需要一种动态确定表主键的方法，这样我就有这样的查询：

```
$sql = sprintf("UPDATE %s SET %s=%s WHERE PRIMARY_KEY = %s", ...); 
```

表的主键是否有 MySQL 关键字，或获取它的方法？

我以前使用过 information_schema 数据库来查找这样的信息，但如果我不必求助于它会很好。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-21T16:54:44.570

```
SHOW INDEX FROM <tablename> 
```

您想要 Key_name = PRIMARY 的行

[http://dev.mysql.com/doc/refman/5.0/en/show-index.html](http://dev.mysql.com/doc/refman/5.0/en/show-index.html)

您可能想要缓存结果——在您可能需要使用的所有表上运行 SHOW 语句需要一段时间。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-03-24T09:54:33.637

可能不建议这样做，但效果很好：

```
SHOW INDEX FROM <table_name> WHERE Key_name = 'PRIMARY'; 
```

可靠的方法是使用information_schema：

```
SELECT k.COLUMN_NAME
FROM information_schema.table_constraints t
LEFT JOIN information_schema.key_column_usage k
USING(constraint_name,table_schema,table_name)
WHERE t.constraint_type='PRIMARY KEY'
    AND t.table_schema=DATABASE()
    AND t.table_name='owalog'; 
```

如[mysql-list 所示](http://lists.mysql.com/mysql/204944)。然而，它比第一个解决方案慢了几倍。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2011-06-01T13:26:37.620

获取主键列的更好方法：

```
SELECT `COLUMN_NAME`
FROM `information_schema`.`COLUMNS`
WHERE (`TABLE_SCHEMA` = 'dbName')
  AND (`TABLE_NAME` = 'tableName')
  AND (`COLUMN_KEY` = 'PRI'); 
```

来自[http://mysql-0v34c10ck.blogspot.com/2011/05/better-way-to-get-primary-key-columns.html](http://mysql-0v34c10ck.blogspot.com/2011/05/better-way-to-get-primary-key-columns.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-29T05:36:46.587

还

```
SHOW INDEX FROM <table_name> WHERE Key_name = 'PRIMARY'; 
```

相当于

```
SHOW KEYS FROM <table_name> WHERE Key_name = 'PRIMARY'; 
```

[![在此处输入图像描述](https://i.stack.imgur.com/qMNh7.png)](https://i.stack.imgur.com/qMNh7.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-09T22:23:45.933

基于@jake-sully 和@lukmdo 的回答，合并他们的代码，我完成了以下代码段：

```
SELECT `COLUMN_NAME`
FROM `information_schema`.`COLUMNS`
WHERE (`TABLE_SCHEMA` = DATABASE())
AND (`TABLE_NAME` = '<tablename>')
AND (`COLUMN_KEY` = 'PRI'); 
```

希望它可以帮助某人

# c# - 在 C# 中优化 XML

> ID：893875
> 
> 赞同：5
> 
> 时间：2009-05-21T16:44:32.983
> 
> 标签：c#, xml, .net-3.5, linq-to-xml

### 背景

我们有一个项目从 .NET 1.1 开始，迁移到 .NET 2.0，最近又迁移到 .NET 3.5。该项目非常受数据驱动，并在其许多数据文件中使用 XML。其中一些 XML 文件非常大，我想借此机会改进应用程序与它们的交互。如果可能的话，我想避免必须始终将它们完全保存在内存中，但另一方面，我想快速访问它们的数据。

当前设置使用[`XmlDocument`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmldocument?redirectedfrom=MSDN&view=net-5.0)和[`XPathDocument`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xpath.xpathdocument?redirectedfrom=MSDN&view=net-5.0)（取决于它的编写时间和编写者）。数据在第一次请求时被查找并缓存在内部数据结构中（而不是作为 XML，这在大多数情况下会占用更多内存）。在过去，这是一个不错的模型，因为它具有快速的访问时间和低内存占用（或至少令人满意的内存占用）。然而，现在有一个功能可以一次性查询大部分信息，而不是我们之前的分散良好的请求。这会导致 XML 加载、验证和解析成为可见的性能瓶颈。

### 问题

给定一个大型 XML 文件，在内存中没有 XML 的情况下，重复查询其内容（例如，“id=B 的元素 A 是否存在？”）的最有效和响应式的方法是什么？

请注意，数据本身可以在内存中，但如果我们可以提供帮助，则不能以更臃肿的 XML 形式存在。在最坏的情况下，我们可以接受将单个文件加载到内存中进行解析，然后再次卸载以释放资源，但如果可能的话，我想避免这种情况。

考虑到我们已经在尽可能缓存数据，这个问题也可以理解为“哪个更快，使用更少的内存；[`XmlDocument`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmldocument?redirectedfrom=MSDN&view=net-5.0), [`XPathDocument`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xpath.xpathdocument?redirectedfrom=MSDN&view=net-5.0), 基于[`XmlReader`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmlreader?redirectedfrom=MSDN&view=net-5.0), 或[`XDocument`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.linq.xdocument?redirectedfrom=MSDN&view=net-5.0)/ [LINQ-to-XML 的](https://docs.microsoft.com/en-us/previous-versions/bb387098(v=vs.140)?redirectedfrom=MSDN)解析？”

*编辑：*更简单的是，我们可以随机访问磁盘上的 XML 而无需一次读取整个文件吗？

### 例子

一个 XML 文件有一些记录：

```
<MyXml>
  <Record id='1'/>
  <Record id='2'/>
  <Record id='3'/>
</MyXml> 
```

我们的用户界面想知道是否存在 id 为 3 的记录。如果可以的话，我们想在不必解析和加载文件中的每条记录的情况下找出它。因此，如果它在我们的缓存中，则没有 XML 交互，如果不是，我们可以将该记录加载到缓存中并响应请求。

### 目标

拥有一种可扩展的、快速的查询和缓存 XML 数据文件的方式，以便我们的用户界面具有响应性，而无需借助多个线程或将整个 XML 文件长期保留在内存中。

我意识到在某个地方很可能有一篇博客或 MSDN 文章，在我发布这个问题后，我将继续使用谷歌，但如果有人有一些可能有帮助的数据，或者一些例子说明什么时候一种方法更好或比另一个更快，那就太好了。

* * *

**更新**
[XMLTeam 今天发布了一篇博客](https://web.archive.org/web/20160119095609/http://blogs.msdn.com/b/xmlteam/archive/2011/09/14/effective-xml-part-1-choose-the-right-api.aspx)，就何时在 .NET 中使用各种 XML API 提供了很好的建议。它看起来像是基于`XmlReader`并且`IEnumerable`将是我在这里给出的场景的最佳选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T19:29:44.413

使用 XML 我只知道两种方法

XMLReader -> 将大型 XML 数据流式传输或使用 XML DOM 对象模型，并立即将整个 XML 读入内存。

如果 XML 很大，我们有 80 MB 以上的 XML 文件，将 XML 读入内存会影响性能。没有真正的方法可以“合并”这两种处理 XML 文档的方式。对不起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T16:36:55.397

不久前，当我尝试流式传输 XML 时，我遇到了这份白皮书：[基于 API 的 XML 流式传输，具有 FLWOR 功能和功能更新](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.95.7182&rep=rep1&type=pdf) 这篇论文尝试使用内存中的 XML，但利用 LINQ 访问。

也许有人会觉得很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T19:15:42.570

这听起来可能很愚蠢。
但是，如果您有简单的查询，您可以在 xml 文件上使用正则表达式。（他们在 unix/linux 中执行 grep 的方式）。

如果没有任何意义，我道歉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T17:02:57.033

您问题的第一部分听起来像模式验证效果最好。如果您可以访问 XSD 或可以创建它们，您可以使用类似于以下的算法：

```
 public void ValidateXmlToXsd(string xsdFilePath, string xmlFilePath)
    {
        XmlSchema schema = ValidateXsd(xsdFilePath);
        XmlDocument xmlData = new XmlDocument();
        XmlReaderSettings validationSettings = new XmlReaderSettings();

        validationSettings.Schemas.Add(schema);
        validationSettings.Schemas.Compile();
        validationSettings.ValidationFlags = XmlSchemaValidationFlags.ProcessInlineSchema;
        validationSettings.ValidationType = ValidationType.Schema;
        validationSettings.ValidationEventHandler += new ValidationEventHandler(ValidationHandler);
        XmlReader xmlFile = XmlReader.Create(xmlFilePath, validationSettings);

        xmlData.Load(xmlFile);
        xmlFile.Close();
    }

    private XmlSchema ValidateXsd(string xsdFilePath)
    {
        StreamReader schemaFile = new StreamReader(xsdFilePath);
        XmlSchema schema = XmlSchema.Read(schemaFile, new ValidationEventHandler(ValidationHandler));
        schema.Compile(new ValidationEventHandler(ValidationHandler));
        schemaFile.Close();
        schemaFile.Dispose();

        return schema;
    }

    private void ValidationHandler(object sender, ValidationEventArgs e)
    {
        throw new XmlSchemaException(e.Message);
    } 
```

如果 xml 验证失败，`XmlSchemaException`则抛出。

至于 LINQ，我个人更喜欢尽可能`XDocument`多地使用`XmlDocument`. 你的目标有点主观，没有确切地看到你在做什么，我不能说走这条路或走那条路，确定它会帮助你。您可以将 XPath 与`XDocument`. 我不得不说你应该使用最适合你需要的那个。有时使用 XPath 而有时使用 LINQ 没有问题。这实际上取决于您的舒适程度以及可扩展性和可读性。可以这么说，对团队有什么好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T17:11:00.903

XmlReader 将比 XmlDocument 使用更少的内存，因为它不需要一次将整个 XML 加载到内存中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T11:30:53.107

只是对 JMarsch 的评论的想法。即使您的流程不讨论 XML 生成，您是否考虑将数据库（或充当索引的 XML 文件的子集）作为中介？这显然只有在 XML 文件每天更新​​不超过一次或两次时才有用。我想这需要与您现有的缓存机制进行权衡。

我不能说速度，但由于语法，我更喜欢 XDocument/LINQ。

富有的

# php - 代码分离悖论：从多维数组创建 HTML 树并将 HTML 保留在递归函数之外

> ID：893879
> 
> 赞同：2
> 
> 时间：2009-05-21T16:45:28.583
> 
> 标签：php, html, tree, multidimensional-array, code-separation

这个工作代码似乎是这个问题的典型解决方案。

它采用一个包含类别及其子类别的多维数组（对它的深度没有隐含限制），并从中创建一个 HTML 无序列表，从递归函数内部将其回显到页面上。

通过将每个数组元素的 'children' 键的值从名为 _category_list()_ 的原始回调函数内部递归地传递给 array_walk() 来遍历子级别。

如何修改这种输出方法，以使所有 HTML 代码都存在于模板中、函数之外？

### 这是代码的概要：

这个多维数组保存了多级类别树。

在 HTML 中使用的重要键是“category_id”、“name”和“children”。为简单起见，其他键已从下面的数组中清除，但如果它们有用，它们是：'parent_id' 和 'level'（从级别 1 开始）。

```
<?php

// the array containing the tree
$categories = array (
  'category_id' => '2',
  'name' => 'Top Category Name',
  'children' => array (
    0 => array (
      'category_id' => '188',
      'name' => 'Category Name',
      'children' => array (
        0 => array (
          'category_id' => '159',
          'name' => 'Category Name',
          'children' => array (),
        ),
        1 => array (
          'category_id' => '160',
          'name' => 'Category Name',
          'children' => array (),
        ),
        2 => array (
          'category_id' => '166',
          'name' => 'Category Name',
          'children' => array (),
        ),
      ),
    ),
    1 => array (
      'category_id' => '4',
      'name' => 'Category Name',
      'children' => array (
        0 => array (
          'category_id' => '141',
          'name' => 'Category Name',
          'children' => array (),
        ),
        1 => array (
          'category_id' => '142',
          'name' => 'Category Name',
          'children' => array (),
        ),
      ),
    ),
  ),
)

?> 
```

.

下一个函数产生大部分 HTML 输出，但它会将 HTML 锁定在自身内部。

但是，我不是直接从函数中呼应它，而是寻找一种方法以一种对设计人员自定义友好的方式将此数据传递回视图模板。

```
<?php

// separate the HTML from this function,
// passing $v to the view template for handling
function category_list($v, $k){
  switch ($k) {
    case 'category_id':
      echo "<li id="$v">";
      break;
    case 'name':
      echo "$v";
      break;
    case 'children':
      if(count($v) > 0){
        echo "<ul>";
        foreach($v as $k=>$v)
        array_walk($v, 'category_list');
        echo "</ul>";
      }
      echo "</li>";
      break;
  }
}

?> 
```

.

下一个代码块是当前模板 html/php，其中调用通过 array_walk() 遍历数组的第一级并引用上面的递归函数。然后，该函数本身处理具有 1 个或多个子级的更深类别的递归和迭代。当然，这是典型的做法。

此代码应具有所有 HTML 标记，而不仅仅是外部标记。

```
<ul>
<?php array_walk($tree,'category_list'); ?>
</ul> 
```

.

理想的解决方案：

这里的最终目标是为模板设计者找到一种方法来创建他们理想的导航结构，而无需创建或修改递归函数（不可访问），也不需要为多维的每个级别使用 foreach 循环大批。该解决方案不应与任何特定的深度限制相关联。

HTML 自定义的示例可以包括在 ul/li 标签内放置额外的属性，甚至在输出文本周围包裹新标签，例如跨度标签，这些标签通常用于导航中，以通过 CSS 实现滑动门效果。所以我认为适当的解决方案至少需要支持这些案例场景。

使用 array_walk() 遍历模板中的数组仍然可以，只要它可以以这样的方式使用，即回调函数将所需的变量传递回模板以与设计器的 HTML 一起使用。

理想情况下，如果 array_walk_recursive() 知道它的迭代器实际上有多少层，我认为这个壮举会更容易解决。但除非有人知道该问题的解决方法，否则解决方案可能会完全不同。

我还想避免使用构建树的 javascript 方法。如果有办法避免使用开关，我也愿意接受那里的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T17:31:02.670

你有没有想过写一个类来管理和存储你想要传回的信息。您的函数可以更改该类的实例，并最终将填充的对象传回。

您的内容将封装在类中，您可以编写所有方法和实用程序供用户操作和输出数据。也可以在类内部编写实用方法以显示级别数等。

我自己没有尝试过，但这是我要开始的地方，因为课程允许我改进和扩展我的用户想要的东西，他们不需要知道正在发生的事情的内部细节。

# database - 带有数据库后端的 DCHP

> ID：893887
> 
> 赞同：0
> 
> 时间：2009-05-21T16:47:30.153
> 
> 标签：database, dhcp

这是我的第一个问题：P。

我正在开发一些小项目。我想在不重新启动服务器的情况下更改 IP/MAC 的 dhcp 服务器规则（在动态基础架构中）。

我认为最好的解决方案是使用带有数据库后端的 dhcp 服务器，以更改 SQL 信息（使用简单的 JDBC 客户端）。

但我想知道一些关于开源项目的建议，或者解释如何实现它的howto。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T17:15:29.113

通常在 Unix 上，长时间运行的守护进程会监听 HUP 信号。收到该信号后，他们重新读取配置文件。这允许守护进程没有停机时间，但可以获得更新的配置选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-05T09:58:16.947

[ISC](http://www.isc.org/)的人（BIND 和 ISC DHCP 服务器的作者）正在研究[KEA](http://kea.isc.org/)，这是一种新的 DHCP 服务器实现，除了其他不错的特性之外，它还支持 SQL。源代码多年来一直支持 SQLite 和 MySQL，最近添加了[PostgreSQL支持。](http://kea.isc.org/ticket/3080)

目前还没有正式发布，他们的[开发](https://lists.isc.org/pipermail/kea-dev/)/[用户](https://lists.isc.org/pipermail/kea-users/)邮件列表上的活动也很少。希望随着代码的成熟、发布、发行版开始打包它并获得用户的关注，这种情况会有所改变。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-21T17:11:30.947

SpliFF

在 Unix 上。

不，重新启动 DHCP 服务器，没有机器:)。对不起。

因为当你更改 dhcp.conf 时你需要重新启动 dhcp (dhcpd)

# asp.net-mvc - 重定向到登录页面策略

> ID：893900
> 
> 赞同：3
> 
> 时间：2009-05-21T16:50:07.420
> 
> 标签：asp.net-mvc

我在页面上有一个链接，允许用户在登录后执行特定操作。如果他们没有登录，我希望该链接首先将他们定向到登录页面。这很常见。最好的方法是什么？目前我正在这样做，但我不喜欢它：

```
<% if(Model.IsUserAuthenticated){ %>
<%= Html.ActionLink("Start Puzzle", "StartPuzzle", "Puzzles")%>
<%} else { %>
<%= Html.ActionLink("Start Puzzle", "Login", "Account")%>
<%} %> 
```

你明白了。我真的不喜欢在这样的视图中有逻辑。如果未登录，是否只使用“StartPuzzle”操作重定向更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T13:32:29.880

创建 htmlhelpers 扩展方法，该方法将检查用户是否已通过身份验证并返回一个或另一个链接......像这样：

在你看来：

```
<%=Html.RenderLoginLink()%> 
```

在你的htmlhelper中：

```
if(autorized)
{ 
   return Html.ActionLink("Start Puzzle", "StartPuzzle", "Puzzles");
}
else
{
   return Html.ActionLink("Start Puzzle", "Login", "Account");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T16:57:34.767

这是 Rob Conery 的一篇关于使用属性使用 MVC 进行身份验证的好帖子：[身份验证和重定向](http://blog.wekeroad.com/blog/aspnet-mvc-securing-your-controller-actions/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:00:23.107

IMO，视图中的逻辑非常好。但是，如果还有更多，或者您甚至不需要那么多，那么您可以为登录用户和匿名用户提供两个单独的视图，并决定您将在控制器中显示哪一个。或者有一个视图并根据条件从控制器传递链接文本和 URL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T07:48:54.303

在控制器中的 StartPuzzle 操作顶部放置一个“授权”属性。这样，未经身份验证的用户将自动被重定向到登录页面，returnUrl 指向他未登录时访问的内容。这样，在成功登录后，他将被重定向回拼图开始.

# javascript - “爆炸”效果对爆炸块的数量是否有最大值？

> ID：893903
> 
> 赞同：2
> 
> 时间：2009-05-21T16:51:11.393
> 
> 标签：javascript, jquery, jquery-ui

```
$('#global').show("explode", { number: 50}, 2000); 
```

我试过这段代码，但它似乎不能正常工作。看起来它是有限的，我从来没有超过 8/10 的爆炸块。

有最大值吗？有任何想法吗 ？

爆炸效果是 jquery-ui 的原生效果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T17:00:32.577

我认为您需要传递的选项是“件数”，而不是“数字”。

```
$('#global').show("explode", { pieces: 50}, 2000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T16:56:50.430

刚刚检查了代码。

```
var rows = o.options.pieces ? Math.round(Math.sqrt(o.options.pieces)) : 3;
var cells = o.options.pieces ? Math.round(Math.sqrt(o.options.pieces)) : 3; 
```

件数似乎没有限制。该语句仅检查您是否传入了多个片段，如果是则计算行和单元格，否则默认为 9 个片段。

传入50个，进行Round(SquareRoot(50))的计算；我们得到 7 行和 7 列。这应该会产生 49 件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-21T17:02:41.200

jQuery[效果备忘单](http://jn.orz.hm/jquery/ui_effect.html) 显示使用**片段**而不是数字

# windows - 仅当我在 Windows 上运行我的 Perl 脚本时，如何才能包含 Win32 模块？

> ID：893905
> 
> 赞同：1
> 
> 时间：2009-05-21T16:51:38.803
> 
> 标签：windows, perl, cross-platform

我有一个问题，我似乎无法找到答案。

使用 Perl，我需要跨 Windows 和 unix 平台使用脚本。问题是在 Windows 上我们使用 Win32 特定的模块，如[Win32::Process](http://search.cpan.org/dist/Win32-Process)，而这些模块在 unix 上不存在。

我需要一种仅在 Windows 上包含这些 Win32 模块的方法。

```
if($^O =~ /win/i)
{
    use win32::process qw(CREATE_NEW_CONSOLE);
}
else
{
    #unix fork
} 
```

问题在于 windows 的 use 语句。无论我尝试什么，这都不会在 unix 上编译。

我尝试过使用动态评估、要求、BEGIN 等。

这个问题有好的解决方案吗？任何帮助将不胜感激。

提前致谢，

担

* * *

更新：

一位同事向我指出这是正确的方法。

```
require Win32;
require Win32::Process;

my $flag = Win32::Process::CREATE_NEW_CONSOLE();

Win32::Process::Create($process, 
    $program, 
    $cmd, 
    0, 
    $flag, ".") || die ErrorReport();

print "Child started, pid = " . getPID() . "\n"; 
```

感谢大家的帮助！

担

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-21T17:13:22.550

`use`在编译时执行。

而是这样做：

```
BEGIN {
    if( $^O eq 'MSWin32' ) {
        require Win32::Process;
        # import Win32::Process qw(CREATE_NEW_CONSOLE);
        Win32::Process->import(qw/ CREATE_NEW_CONSOLE /);
    }
    else {
        #unix fork
    }
} 
```

请参阅[perldoc 以供使用](http://perldoc.perl.org/functions/use.html)。

另请参阅[perlvar](http://perldoc.perl.org/perlvar.html#%24OSNAME) on `$^O`。

* * *

**更新：**

正如 Sinan Unur 所指出的，最好避免使用[间接宾语语法](http://perldoc.perl.org/perlobj.html#Indirect-Object-Syntax)。

我在每种情况下都使用直接方法调用，除了调用`import`. 可能是因为`import`伪装成内置的。既然`import`真的是类方法，就应该作为类方法来调用。

谢谢，思南。

此外，在 Win32 系统上，您需要非常小心，确保模块名称的大小写正确。不正确的大小写意味着符号将无法正确导入。它会变得丑陋。`use win32::process`可能看起来工作正常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T17:01:45.443

您确定可以在 OSX 上加载 win32::process 吗？“darwin” 匹配你的 /win/i。
您可能想使用[http://search.cpan.org/dist/Sys-Info-Base/](http://search.cpan.org/dist/Sys-Info-Base/)来尝试做正确的事情。

除此之外，您能否发布一个您实际使用的代码示例、您收到的失败消息以及在哪个 unix 平台 (uname -a) 上？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:05:17.060

在每个操作系统上修改文件的解析器怎么样？

您可以通过可在两个操作系统上运行的配置脚本解析您的 perl 文件，以输出带有正确 Use 子句的 perl。您甚至可以将解析操作隐藏在可执行脚本中以启动代码。

最初我正在考虑来自 C 的预编译器指令可以解决问题，但我不太了解 perl。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T18:28:35.613

这是您第二组问题的答案：

你在使用`strict`和`warnings`吗？

你定义了一个`ErrorReport()`子程序吗？`ErrorReport()`只是[Win32::Process](http://search.cpan.org/dist/Win32-Process-0.14/Process.pm)概要中的一个示例。

`CREATE_NEW_CONSOLE`可能不是数字，因为它没有正确导入。检查您对 的调用中的大小写`import`。

比较这些单行：

```
C:\>perl -Mwin32::process  -e "print 'CNC: '. CREATE_NEW_CONSOLE;
CNC: CREATE_NEW_CONSOLE

C:\>perl -Mwin32::process -Mstrict -e "print 'CNC: '. CREATE_NEW_CONSOLE;
Bareword "CREATE_NEW_CONSOLE" not allowed while "strict subs" in use at -e line 1.
Execution of -e aborted due to compilation errors.

C:\>perl -MWin32::Process  -e "print 'CNC: '. CREATE_NEW _CONSOLE;
CNC: 16 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T14:45:09.000

您可以将特定于平台的代码放在 中`eval{}`，然后检查是否有错误。

```
BEGIN{
  eval{
    require Win32::Process;
    Win32::Process->import(qw'CREATE_NEW_CONSOLE');
  };
  if( $@ ){ # $@ is $EVAL_ERROR

    # Unix code here

  }
} 
```

# design-patterns - 首先应该是什么——设计模式还是代码？

> ID：893908
> 
> 赞同：12
> 
> 时间：2009-05-21T16:52:23.217
> 
> 标签：design-patterns, architecture, refactoring

我正在开始一个全新的项目——我应该查看我的规范并决定应用哪些设计模式，还是只是想出一个组织的总体概念并允许模式通过重构有机地出现？

根据您的经验，哪种技术效率最高，并且更有可能产生干净优雅的代码？

我还想知道是否存在 GoF 未定义但同样有价值的设计模式？如果是这样，有哪些有用的资源可以让自己了解这些？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-21T16:57:21.007

你应该有机地扩展你的代码，应用它们适合的模式。过早匹配模式会导致大量不合适的代码和太多抽象层，从而使设计变得混乱。见证你看到的任何代码，这些代码是在有人第一次发现模式之后编写的；-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-21T17:04:18.590

除非一个模式似乎明显跳出了规范，否则我不一定会尝试从 GoF 中挑选一些东西并锤击问题，直到它适合该模式。

最好从概念上理解您脑海中的不同抽象级别，并为您将如何实现它制定一个计划（不一定是流行的设计模式）。有了经验，你会变得更好。虽然了解 GoF 模式将帮助您提高在代码设计方面思考问题的能力，但它们并不意味着可以解决所有问题，并且人为地强制您的问题适应设计模式可能意味着不必要的复杂化和混淆。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-21T16:58:47.870

1.  找出用例。
2.  考虑一下整个现有设计模式的设计。
3.  开始实施。

我相信这里的主要目标是避免重新发明轮子。

PS。在您多次通过步骤 2 并习惯之后，您将能够将该步骤整合到步骤 3 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-21T17:08:04.933

如果我不确定我只是开始编写代码。不久之后，结构将开始要求进行一些重构，并且选择几乎总是显而易见的。

尽管我有时会受到特定模式的启发，但几乎总是代码向我展示了正确的道路。

我也不怕烧毁和重建程序的一部分。我非常喜欢 Scott Adams 的一句话——“创造力是允许自己犯错；艺术是知道要保留哪些。” 有时，除非您以错误的方式尝试，否则正确的答案并不明显。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T20:43:02.470

我会通过前期设计模式的使用来避免过多地对你的编码进行模式化。最好只编写简单的代码，并在需要时[重构为](https://rads.stackoverflow.com/amzn/click/com/0321213351)最能满足您需求的设计模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T03:31:46.617

> 你应该有机地扩展你的代码，应用它们适合的模式。

借调！我见过的一些最糟糕的意大利面条是带有很多模式的 OO C++。Fluxbox 几乎无法忍受；Synergy (v2) 煮、烤和烤我的面条:(

我见过的一些最漂亮的代码是 OO C，其中 OO 分别是两个接口加上 4 个和 20 个实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T17:05:46.530

在开始编码之前，您应该了解哪些模式适合该问题。如果没有，请制作一个原型，以便您了解您想要实现的目标。然后寻找模式并丢弃原型（结构）（并重用好的部分）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T17:40:27.817

这里已经有很好的建议了。回答有关 GoF 书以外的有用模式的问题。有，您应该查看 Larman 的 Applying UML and Patterns，他在其中描述了 GRASP 模式。

# version-control - 我应该将生成的代码存储在源代码管理中吗

> ID：893913
> 
> 赞同：118
> 
> 时间：2009-05-21T16:53:17.037
> 
> 标签：version-control, code-generation

这是我正在参与的一场辩论。我想获得更多的意见和观点。

我们有一些在构建时生成的类来处理数据库操作（在这种特定情况下，使用 SubSonic，但我认为这对于这个问题并不重要）。在 Visual Studio 中将生成设置为预构建步骤。所以每次开发者（或官方构建过程）运行构建时，都会生成这些类，然后编译到项目中。

现在有些人声称，将这些类保存在源代码管理中可能会导致混淆，以防您获得的代码与您自己的环境中生成的代码不匹配。

我想有一种方法可以追溯代码的历史，即使它通常被视为黑匣子。

有什么论据或反驳吗？

* * *

更新：我问了这个问题，因为我真的相信有一个明确的答案。看看所有的回答，我可以高度肯定地说，没有这样的答案。应根据多个参数做出决定。阅读下面的答案可以为您在必须决定这个问题时应该问自己的问题类型提供一个很好的指导。

由于上述原因，我此时不会选择接受的答案。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-21T16:58:16.997

将其保存在源代码管理中比它的价值更麻烦。

每次构建时都必须进行提交才能使其具有任何价值。

通常我们将生成的代码（idl、jaxb 的东西等）留在我工作的源代码控制之外，这从来都不是问题

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-21T16:56:11.430

将其置于源代码控制中。将您编写的所有内容的历史记录提供给未来的开发人员的优势超过了在同步后偶尔重建的轻微痛苦。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-05-21T16:58:31.740

每次我想在我自己的个人仓库中显示对源代码树的更改时，所有“生成的文件”都会显示为已更改并需要提交。

我希望有一个更清晰的修改列表，其中仅包含已执行的实际更新，而不是自动生成的更改。

将它们排除在外，然后在构建后，在每个生成的文件上添加一个“忽略”。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-05-21T17:15:41.377

这样看：您是否将目标文件检查到源代码管理中？生成的源文件是构建工件，就像目标文件、库和可执行文件一样。他们应该被同等对待。大多数人会争辩说，您不应该将生成的目标文件和可执行文件检查到源代码控制中。相同的论点适用于生成的源。

如果您需要查看生成文件的历史版本，您可以同步到其源的历史版本并重新构建。

将任何类型的生成文件检查到源代码控制中类似于数据库非规范化。*偶尔会有*这样做的理由（通常是为了性能），但这样做时应该非常小心，因为一旦数据被非规范化，维护正确性和一致性就会变得更加困难。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-05-21T16:59:45.947

我会说您应该避免将任何生成的代码（或其他工件）添加到源代码控制中。如果给定输入生成的代码相同，那么您只需检查要比较的版本并生成代码进行比较。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-05-21T17:03:48.607

我称之为 DRY 原则。如果您已经在存储库中拥有用于在构建时生成这些代码文件的“源文件”，则无需“两次”提交相同的代码。

此外，如果有一天代码生成中断，您可能会通过这种方式避免一些问题。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2009-05-22T00:14:56.553

不，出于三个原因。

1.  源代码是重现当前或以前某个时间点的应用程序快照所必需且足够的一切 - 不多也不少。这意味着有人对签入的所有内容负责。一般来说，我很乐意为我编写的代码负责，而不是为我编写的代码生成的代码负责。

2.  我不希望有人试图通过使用可能是当前或可能不是最新的中间代码（更重要的是我不想为此承担责任）来从主要来源缩短构建。有些人很容易陷入关于调试基于部分构建的中间代码冲突的毫无意义的过程中。

3.  一旦它进入源代码控制，我将承担 a. 它在那里，b。它是最新的，并且 c。它可以与那里的所有其他东西可靠地集成。这包括在我不再使用它时将其移除。这种责任越少越好。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-05-21T17:00:46.710

我真的不认为你应该检查他们。

当然，生成的代码中的任何更改都将是噪音 - 环境之间的更改，或者由于其他原因而发生的更改 - 例如数据库中的更改。如果您的数据库的创建脚本（或任何其他依赖项）在源代码控制中，那么您为什么还需要生成的脚本呢？

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-05-21T17:02:27.067

一般规则是**no**，但如果生成代码需要时间（因为 DB 访问、Web 服务等），那么您可能希望在源代码管理中保存一个缓存版本并为每个人省去痛苦。

您的工具还需要意识到这一点并在需要时处理从源代码管理中签出，太多工具决定无缘无故地从源代码管理中签出。
一个好的工具会使用缓存的版本而不接触它（也不会修改文件上的时间步长）。

此外，您需要在生成的代码中放置大警告，以便人们不要修改文件，顶部的警告是不够的，您必须每十几行重复一次。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-05-21T17:05:46.077

我们也不存储生成的数据库代码：因为它是生成的，所以您可以从源文件中以任何给定版本随意获取它。存储它就像存储字节码等。

现在，您需要确保在给定版本中使用的代码生成器可用！较新的版本可以生成不同的代码...

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-05-21T17:26:55.347

在某些项目中，我将生成的代码添加到源代码控制中，但这确实取决于。我的基本准则是，如果生成的代码是编译器的固有部分，那么我不会添加它。如果生成的代码来自外部工具，例如本例中的 SubSonic，那么我会将 if 添加到源代码控制中。如果您定期升级组件，那么我想知道生成源中的更改，以防出现错误或问题。

至于需要签入的生成代码，最坏的情况是手动区分文件并在必要时恢复文件。如果您使用的是 svn，您可以在 svn 中添加一个 pre-commit 挂钩，以在文件没有真正更改的情况下拒绝提交。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2010-04-22T10:57:41.520

别管它。

如果您正在签入生成的文件，那么您做错了什么。问题可能有所不同，可能是您的构建过程效率低下或其他原因，但我认为这不是*一个*好主意。历史记录应该与源文件相关联，而不是与生成的文件相关联。

它只会让那些最终试图解决差异、找到不再由构建生成的文件然后删除它们等的人感到头疼。

一个痛苦的世界等待着那些签入生成文件的人！

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-07-09T11:16:29.807

到的有点晚……反正……

您会将编译器的中间文件放入源代码版本控制中吗？在代码生成的情况下，根据定义，源代码是生成器的输入，而生成的代码可以被视为“真实”源代码和构建的应用程序之间的中间文件。

所以我会说：不要将生成的代码置于版本控制之下，而是将生成器及其输入置于版本控制之下。

具体来说，我使用的是我编写的代码生成器：我从来不需要在版本控制下维护生成的源代码。我什至会说，由于生成器达到了一定的成熟度，尽管输入（例如模型描述）发生了变化，但我不必观察生成代码的内容。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-05-30T19:18:25.513

有一种特殊情况是您想要签入生成的文件：当您可能需要在用于生成其他文件的工具不可用的系统上进行构建时。Lex 和 Yacc 代码就是这方面的经典示例，也是我使用的一个示例。因为我们开发的运行时系统必须在各种各样的平台和架构上构建和运行，所以我们只能依赖目标系统来拥有 C 和 C++ 编译器，而不是为我们的接口定义生成词法分析/解析代码所需的工具翻译器。因此，当我们更改语法时，我们会签入生成的代码来解析它。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-04-23T18:13:04.867

配置管理（其中版本控制只是其中的一部分）的工作是能够做到以下几点：

*   了解每个交付的构建中都有哪些更改和错误修复。
*   从原始源代码开始，能够准确地复制任何交付的构建。无论语言如何，自动生成的代码都不算作“源代码”。

第一个确保当您告诉客户或最终用户“您上周报告的错误已修复并且新功能已添加”时，他们不会在两个小时后回来说“不，它没有”。它还确保他们不会说“为什么要做 X？我们从来没有要求 X”。

第二个意味着当客户或最终用户报告您一年前发布的某个版本中的错误时，您可以返回该版本，重现错误，修复它，并证明是您的修复消除了错误而不是编译器和其他修复的一些扰动。

这意味着您的编译器、库等也需要成为 CM 的一部分。

所以现在回答你的问题：如果你能做到以上所有，那么你不需要记录任何中间表示，因为无论如何你都会得到相同的答案。如果你不能做到以上所有，那么所有的赌注都会被取消，因为你永远不能保证做同样的事情两次并得到相同的答案。因此，您不妨将所有 .o 文件也置于版本控制之下。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-06-30T21:22:38.923

双方都有正当合理的论据，在共同点上很难达成一致。版本控制系统 (VCS) 跟踪开发人员放入其中的文件，并假设 VCS 中的文件是由开发人员手工制作的，并且开发人员对文件的任何修订之间的历史和更改感兴趣。这个假设等同于两个概念，“我想在结账时获取这个文件”。和“我对此文件的更改感兴趣。”

现在，双方的论点可以改写如下：

*   “我想在结帐时获取所有这些生成的文件，因为我没有在这台机器上生成它们的工具。”
*   “我不应该将它们放入 VCS，因为我对更改此文件不感兴趣。”

幸运的是，这两个要求似乎从根本上并不冲突。随着当前 VCS 的一些扩展，应该可以同时拥有两者。换句话说，这是一个错误的困境。如果我们仔细思考一下，不难发现问题源于 VCS 的假设。VCS 应区分由开发人员手工制作的文件和不是由开发人员手工制作但恰好位于此 VCS 内部的文件。对于第一类文件，我们通常称为源文件（代码），VCS 现在做得很好。对于后一类，据我所知，VCS还没有这样的概念。

## 概括

我将以 git 为例来说明我的意思。

*   `git status`默认情况下不应显示生成的文件。
*   `git commit`应包括生成的文件作为快照。
*   `git diff`默认情况下不应显示生成的文件。

## 附言

Git hooks 可以作为一种解决方法，但如果 git 本身支持它会很棒。`gitignore`不符合我们的要求，因为被忽略的文件不会进入 VCS。`enter code here`

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-12-17T02:35:37.493

这里提出了支持和反对的很好的论据。作为记录，我在 Visual Studio 中构建了 T4 生成系统，我们的默认开箱即用选项会导致生成的代码被签入。如果您不想签入，则必须更加努力。

对我来说，关键考虑因素是在更新输入或生成器本身时区分生成的输出。

如果您没有签入输出，那么您必须在升级生成器或修改输入之前复制所有生成的代码，以便能够将其与新版本的输出进行比较。我认为这是一个相当乏味的过程，但是通过签入输出，将新输出与存储库进行比较是一件简单的事情。

在这一点上，问“你为什么关心生成代码的变化”是合理的。（特别是与目标代码相比。）我相信有几个关键原因可以归结为当前的技术状态，而不是任何固有问题。

1.  您编写与生成的代码紧密结合的手写代码。如今，obj 文件的整体情况并非如此。当生成的代码发生变化时，很遗憾的是，一些手写代码需要更改以匹配。人们通常不会在生成的代码中观察到与可扩展点的高度向后兼容性。

2.  生成的代码只是改变了它的行为。您不会容忍编译器这样做，但公平地说，应用程序级代码生成器针对不同领域的问题提供更广泛的可接受解决方案。重要的是看看你对以前行为所做的假设现在是否被打破。

3.  您只是不会 100% 信任生成器从发布到发布的输出。生成器工具有很多价值，即使它们不是按照编译器供应商的严格要求构建和维护的。1.0 版可能对您的应用程序非常稳定，但现在 1.1 版可能对您的用例有一些小故障。或者，您更改​​输入值并发现您正在使用以前未使用过的生成器的新部分 - 您可能会对结果感到惊讶。

从本质上讲，所有这些都归结为工具成熟度——大多数商业应用程序代码生成器并不接近编译器甚至 lex/yacc 级工具多年来的水平。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2010-08-25T14:10:40.797

正确答案是“视情况而定”。这取决于客户的需求是什么。如果您可以将代码回滚到特定版本并在没有它的情况下经受任何外部审计，那么您仍然没有站稳脚跟。作为开发人员，我们不仅需要考虑“噪音”、痛苦和磁盘空间，还需要考虑我们肩负着产生知识产权的任务这一事实，并且可能会产生法律后果。您能否向法官证明您能够完全按照客户两年前看到的方式重新生成网站？

我并不是建议您保存或不保存生成的文件，无论您决定是否不让主题专家参与，您都可能是错误的决定。

我的两分钱。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-05-21T20:20:06.870

这真的取决于。最终，目标是能够在需要时重现您拥有的东西。如果您能够准确地重新生成二进制文件，则无需存储它们。但是你需要记住，为了重新创建你的东西​​，你可能需要你一开始就使用的确切配置，这不仅意味着你的源代码，还意味着你的构建环境、你的 IDE，甚至可能是其他库，生成器或东西，在您使用的确切配置（版本）中。

我在项目中遇到了麻烦，我们将构建环境升级到较新的版本，甚至升级到其他供应商的版本，我们无法重新创建我们之前拥有的确切二进制文件。当要部署的二进制文件依赖于一种哈希时，这是一个真正的痛苦，特别是在安全环境中，并且重新创建的文件由于编译器升级或其他原因而有所不同。

那么，你会存储生成的代码吗：我会说不。已发布的二进制文件或可交付成果，包括我将存储的用于复制它们的工具。然后，无需将它们存储在源代码管理中，只需对这些文件进行良好备份即可。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-05-21T16:56:55.843

我会主张。如果您使用的是检出代码、修改内部版本号、构建软件然后对其进行测试的持续集成过程，那么将代码作为存储库的一部分就更简单、更容易了。

此外，它是您从软件存储库获取的每个“快照”的一部分。如果它是软件的一部分，那么它应该是存储库的一部分。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-05-22T19:50:32.167

出于多种原因，在源代码管理中绝对拥有生成的代码。我重申很多人已经说过的话，但我这样做的一些原因是

1.  使用源代码控制中的代码文件，您可能能够在不使用 Visual Studio 预构建步骤的情况下编译代码。
2.  当您在两个版本之间进行全面比较时，很高兴知道生成的代码是否在这两个标签之间发生了变化，而无需手动检查它。
3.  如果代码生成器本身发生了变化，那么您需要确保对生成的代码所做的更改也相应地发生了变化。即如果你的生成器改变了，但输出不应该改变，那么当你去提交你的代码时，之前生成的和现在生成的代码之间没有区别。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-05-22T00:01:44.130

如果它是源代码的一部分，那么无论是谁或什么生成它，都应该将其置于源代码管理中。您希望源代码管理能够反映系统的当前状态，而无需重新生成它。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-05-21T23:31:38.200

我（遗憾地）最终将许多派生源置于源代码控制之下，因为我与那些懒得设置适当的构建环境或不具备设置它的技能的人远程工作，以便派生的来源是完全正确的。（说到 Gnu 自动工具，我自己就是其中之一！我无法使用三个不同的系统，每个系统都可以使用不同版本的自动工具——而且只能使用那个版本。）

这种困难可能更多地适用于兼职、志愿者、开源项目，而不是支付账单的人可以坚持统一构建环境的付费项目。

执行此操作时，您基本上承诺仅在一个站点或仅在正确配置的站点构建派生文件。您的 Makefile（或其他）应该设置为注意它们在哪里运行，并且应该拒绝重新派生源，除非他们知道它们在安全的构建站点上运行。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-05-21T17:05:09.633

我会说是的，您想将其置于源代码控制之下。从配置管理的角度来看，需要控制用于生成软件构建的所有内容，以便可以重新创建它。我知道生成的代码可以很容易地重新创建，但可以说它不一样，因为两个版本之间的日期/时间戳会不同。在某些领域，例如政府，他们需要很多次这样做。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-05-21T17:33:07.223

一般来说，生成的代码不需要存储在源代码管理中，因为该代码的修订历史可以通过生成它的代码的修订历史来跟踪！

但是，听起来 OP 正在使用生成的代码作为应用程序的数据访问层，而不是手动编写。在这种情况下，我会更改构建过程，并将代码提交到源代码管理，因为它是运行时代码的关键组件。这也消除了构建过程中对代码生成工具的依赖，以防开发人员需要为不同的分支使用不同版本的工具。

似乎代码只需要生成一次，而不是每次构建。当开发人员需要添加/删除/更改对象访问数据库的方式时，应该重新生成代码，就像进行手动修改一样。这加快了构建过程，允许对数据访问层进行手动优化，并以简单的方式保留数据访问层的历史记录。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-21T17:37:35.730

我会将生成的文件留**在**源代码树之外，但将其**放在**单独的构建树中。

例如工作流程是

1.  正常签入/签出/修改/合并源（没有任何生成的文件）
2.  在适当的情况下，将源树检出到干净的构建树中
3.  构建后，检查所有必须存在的“重要”文件（“真实”源文件、可执行文件 + 生成的源文件）以用于审计/监管目的。这为您提供了所有适当生成的代码+可执行文件+任何内容的历史记录，时间增量与发布/测试快照等相关，并且与日常开发脱钩。

在 Subversion/Mercurial/Git/etc 中可能有很好的方法将两个地方的真实源文件的历史联系在一起。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-09-01T06:10:35.223

看起来双方都有非常强烈和令人信服的意见。我建议阅读所有投票最多的答案，然后决定哪些论点适用于您的具体案例。

更新：我问了这个问题，因为我真的相信有一个明确的答案。看看所有的回答，我可以高度肯定地说，没有这样的答案。应根据多个参数做出决定。阅读其他答案可以为您在必须决定这个问题时应该问自己的问题类型提供一个很好的指导。

# windows - 鼠标双击不是很好

> ID：893925
> 
> 赞同：1
> 
> 时间：2009-05-21T16:55:05.210
> 
> 标签：windows, mouse, click, media, encoder

我用下面的代码录屏，录屏的时候，用鼠标双击某个项目，比如双击一个ppt在PowerPoint中打开，反应不是很灵敏。我已经尝试过，使用 Windows Media Encoder 9 的屏幕录制功能时效果要好得多。任何想法有什么问题吗？

我的环境：Windows Vista + Windows Media Encoder 9 + VSTS 2008 + C#。我在 Windows 窗体应用程序的初始化代码中编写了以下代码，我怀疑我的 Windows 窗体应用程序有问题？

我的代码，

```
IWMEncSourceGroup SrcGrp;
IWMEncSourceGroupCollection SrcGrpColl;
SrcGrpColl = encoder.SourceGroupCollection;
SrcGrp = (IWMEncSourceGroup)SrcGrpColl.Add("SG_1");

IWMEncVideoSource2 SrcVid;
IWMEncSource SrcAud;
SrcVid = (IWMEncVideoSource2)SrcGrp.AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO);
SrcAud = SrcGrp.AddSource(WMENC_SOURCE_TYPE.WMENC_AUDIO);

SrcVid.SetInput("ScreenCap://ScreenCapture1", "", "");
SrcAud.SetInput("Device://Default_Audio_Device", "", "");

// Specify a file object in which to save encoded content.
IWMEncFile File = encoder.File;
string CurrentFileName = Guid.NewGuid().ToString();
File.LocalFileName = CurrentFileName;
CurrentFileName = File.LocalFileName;

// Choose a profile from the collection.
IWMEncProfileCollection ProColl = encoder.ProfileCollection;
IWMEncProfile Pro;
for (int i = 0; i < ProColl.Count; i++)
{
    Pro = ProColl.Item(i);

    if (Pro.Name == "Screen Video/Audio High (CBR)")
    {
        SrcGrp.set_Profile(Pro);
        break;
    }
}
encoder.Start(); 
```

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-04T17:50:56.857

我遇到了同样的问题。但问题不在于您的代码或我的代码。当我尝试从 Windows Media Encoder 应用程序本身捕获屏幕时，我在大约 50% 的会话中也遇到了同样的问题。很明显，这是 WindowsMediaEncoder 本身的一个错误。

乔治

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-24T14:58:36.703

这里有几个选项（来自[http://www.windowsmoviemakers.net/Forums/ShowPost.aspx?PostID=1982](http://www.windowsmoviemakers.net/Forums/ShowPost.aspx?PostID=1982)）：

*   启用 MouseKeys Accessibility 选项，然后键入 + 双击
*   在不同机器上运行编码器和目标应用程序，并捕获远程桌面会话

# python - Python：阻止 miniDOM 扩展转义序列

> ID：893930
> 
> 赞同：0
> 
> 时间：2009-05-21T16:55:53.803
> 
> 标签：python, xml, minidom

当 xml.dom.minidom 解析一段 xml 时，它会自动将大于和小于的转义字符转换为它们的可视化表示。例如：

```
>>> import xml.dom.minidom  
>>> s = "<example>4 &lt; 5</example>"
>>> x = xml.dom.minidom.parseString(s)
>>> x.firstChild.firstChild.data
u'4 < 5' 
```

有谁知道如何阻止 minidom 这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T18:20:27.283

```
>>> import xml.dom.minidom
>>> s = "<example>4 &lt; 5</example>"
>>> x = xml.dom.minidom.parseString(s)
>>> x.firstChild.firstChild.toxml()
u'4 &lt; 5' 
```

# c++ - 这个“ISOTIME”结构代表什么标准？

> ID：893940
> 
> 赞同：0
> 
> 时间：2009-05-21T16:57:16.827
> 
> 标签：c++, datetime, data-structures, timezone

在我们的代码中，我们有一个 16 字节的压缩包`struct`，我们称之为“ISOTIME”：

```
typedef struct isotime {
    struct {
        uint16_t iso_zone : 12; // corresponding time zone
        uint16_t iso_type : 4; // type of iso date
    } iso_fmt;

    int16_t iso_year; // year
    uint8_t iso_month; // month
    uint8_t iso_day; // day
    uint8_t iso_hour; // hour
    uint8_t iso_minute; // minute
    uint8_t iso_second; // second
    uint8_t iso_centi; // centi-second
    uint8_t iso_hundred; // hundreds of micro-seconds
    uint8_t iso_micro; // micro-seconds
    uint32_t iso_unused; // pad out to 16 bytes
} ISOTIME; 
```

我试图弄清楚这应该实施什么标准。有人有线索吗？我的 Google-fu 让我失望了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:20:47.683

正如 Gary Ray 所说，日期和时间数据交换的主要标准是 ISO 8601:2004。

显示的数据结构可以处理时间分辨率为微秒的标准公历。

还有其他相关标准——例如 ISO/IEC 9899:1999 (C)。它定义了不同的结构并指定了年份的编码（例如，年份编号 - 1900 存储在 tm_year 元素中；此外，月份编号从一月的 0 到十二月的 11 - 适合索引到月份名称数组，但否则很糟糕）。POSIX (ISO/IEC 9945-1:2008) 继承了 C 标准的时间处理。SQL (ISO/IEC 9075-2:2008) 与 ISO 8601 的合作比与 C/POSIX 的合作更紧密。但是显示的结构可以在任何这些环境中使用——尽管它在 C/POSIX 环境中不是标准的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T17:23:45.417

国际标准很少关注数据的详细内存表示，特别是在位级别（浮点标准当然例外）。这是因为这些东西本质上是不可移植的。这并不是说这种结构没有标准，但我认为不太可能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T17:11:43.007

看起来像处理[ISO 8601](http://www.iso.org/iso/support/faqs/faqs_widely_used_standards/widely_used_standards_other/date_and_time_format.htm)的结构- 格式取决于数据的显示方式：

```
20030103 = Basic Format
20030103T0700-0500 = Basic Format w/ Time and Zone
2003-01-03 = Extended Format 
```

# erlang - 生产 Erlang 部署示例

> ID：893950
> 
> 赞同：2
> 
> 时间：2009-05-21T16:59:19.273
> 
> 标签：erlang, development-environment, scalability, production-environment

**我目前正在学习 Erlang**

SO 用户能否给出他们的任何 Erlang 应用程序部署的有趣示例？

我想深入了解 Erlang 过去电信的常见用法，以及 Erlang 在开发/部署过程中带来的任何问题或意想不到的好处。

我希望这将提供一些更广泛的背景，并为我自己和其他任何跳入 Erlang 的人敲响警钟！

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-13T21:33:24.937

[谁使用 Erlang 进行产品开发](http://erlang.org/faq/introduction.html#1.5 "谁使用 Erlang 进行产品开发？")：

*   Bluetail/Alteon/Nortel（分布式、容错电子邮件系统、SSL 加速器）
*   Cellpoint（基于位置的移动服务）
*   Corelatus（SS7 监控）。
*   dqdp.net（拉脱维亚语）（网络服务）。
*   Facebook（Facebook 聊天后端）
*   芬兰气象研究所（数据采集和实时监测）
*   IDT 公司 （实时最低成本路由专家系统）
*   Klarna（电子支付系统）
*   Mobilearts（GSM 和 UMTS 服务）
*   Netkit 解决方案（网络设备监控和运营支持系统）
*   流程一（Jabber 消息传递）
*   Schlund + Partner（消息传递和交互式语音响应服务）
*   Quviq（软件测试工具）
*   RabbitMQ（AMQP 企业消息传递）
*   T-Mobile（以前的 one2one）（高级呼叫控制服务）
*   Telia（电信运营商）
*   Vail Systems（交互式语音响应系统）
*   Wavenet（SS7 和 IVR 应用程序）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T17:10:01.183

我们的第一个应用程序是一个 web/sms 社交网络，我写了一篇关于这个主题的长论文，可以在[这里](http://wadler.blogspot.com/2005/06/service-architectures.html)阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-03T16:04:07.143

我们已经构建了一个基于 Erlang 后端的网络应用程序。

Erlang 负责业务逻辑、安全性和数据存储。
浏览器专门通过 JSON 服务与之通信并进行渲染。

它将很快进入测试版，为了让您了解该应用程序，这里有[一个视频](http://beebole.com)

[这里](http://beebole.com/erlang)和[这里](http://beebole.com/en/blog/category/erlang)也有一些关于我们在此过程中学到的东西的资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T00:44:51.527

了解 erlang/OTP 已经提供的发布工具。

Erlang 引导脚本非常适合确保所有需要的正在运行的应用程序都存在并且版本正确。在 OTP 框架内发布版本比尝试自己发明要容易得多。Erlang 有很多工具可以确保部署既可以实时完成，又不会破坏正在运行的服务。语言和运行时是为此而设计的，因此他们为您完成了很多繁重的工作。我发现这些工具即使对小型“非企业”应用程序和部署也很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-17T12:32:33.800

当然，总会有诸如[wings3D](http://www.wings3d.com)之类的用于3D建模的应用程序。这并不完全是一种“部署”，因为这类程序可以在任何地方使用，从个人到他们管道中的艺术家团队。还有其他类似模拟的项目，但我不确定有多少公司公开声明他们使用 Erlang。至于我，我打算将它用于我的公司进行工业自动化。

# security - 如果您使用 HTTPS，您的 URL 参数会不会被嗅探？

> ID：893959
> 
> 赞同：49
> 
> 时间：2009-05-21T17:00:51.577
> 
> 标签：security, apache, url, https

假设我设置了一个简单的 php web 服务器，其中包含一个可以通过 HTTPS 访问的页面。URL 具有简单的参数，例如`https://www.example.com/test?abc=123`.

在这种情况下，这里的参数对人们嗅探数据包是安全的吗？如果服务器不使用任何 SSL 证书，这会是真的吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-05-21T17:07:45.060

是的，您的 URL 不会被嗅探；但是，一个容易被忽视的漏洞是，如果您的页面引用了任何第三方资源，例如 Google Analytics、Add Content 等，您的整个 URL 将被发送给引用者中的第三方。如果它真的很敏感，它不属于查询字符串。

至于问题的第二部分，如果您在服务器上没有证书，则不能使用 SSL。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-05-21T17:05:28.543

[http://answers.google.com/answers/threadview/id/758002.html](http://answers.google.com/answers/threadview/id/758002.html)

> HTTPS 在传输任何 HTTP 数据之前建立底层 SSL 连接。这确保了所有 URL 数据（除了用于建立连接的主机名）仅在此加密连接中传输，并且像任何 HTTPS 数据一样受到保护免受中间人攻击.
> 
> HTTPS 连接中的所有 HTTP 级别事务都在已建立的 SSL 会话中进行，并且在建立安全连接之前不会传输任何查询数据。
> 
> 从外部看，唯一对世界可见的数据是您要连接的主机名和端口。其他一切都只是一个二进制数据流，使用仅在您和服务器之间共享的私钥进行加密。
> 
> 在您提供浏览器的示例中，将执行以下操作：
> 
> 1.  从 URL 派生主机名（和端口，如果存在）。
> 2.  连接到主机。
> 3.  检查证书（它必须由已知机构“签名”，专门用于正确的 IP 地址和端口，并且是最新的）。
> 4.  浏览器和服务器交换加密数据，浏览器接收私钥。
> 5.  发出 HTTP 请求，并使用已建立的加密技术进行加密。
> 6.  收到 HTTP 响应。也加密了。
> 
> HTTP 是一个“应用层”协议。它位于安全层之上。根据 Netscape 制定的 SSL 规范，它规定在建立安全连接之前不得传输应用层数据 - 如下段所述：
> 
> “此时，客户端发送更改密码规范消息，客户端将待处理的密码规范复制到当前的密码规范中。然后客户端立即在新的算法、密钥和秘密下发送完成的消息。作为响应，服务端会发送自己的change cipher spec消息，将pending转移到当前的Cipher Spec，并在新的Cipher Spec下发送完成的消息。此时，握手完成，客户端和服务端可以开始交换应用程序了层数据。” [http://wp.netscape.com/eng/ssl3/draft302.txt](http://wp.netscape.com/eng/ssl3/draft302.txt)
> 
> 所以是的。**HTTPS 连接上的 URL 查询中包含的数据是加密的**。但是， 在“GET”请求中包含密码等敏感数据是***非常糟糕的做法。***虽然无法截获，但**数据将记录在**接收 HTTPS 服务器上的纯文本服务器日志中，很可能还会记录在**浏览器历史记录**中。它可能**也可用于浏览器插件**，甚至可能用于客户端计算机上的其他应用程序。最多可以合理地允许 HTTPS URL 包含会话 ID 或类似的不可重用变量。它不应该包含静态身份验证令牌。
> 
> HTTP 连接的概念在这里解释得最清楚： [http ://www.ourshop.com/resources/ssl_step1.html](http://www.ourshop.com/resources/ssl_step1.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-21T17:07:11.207

请求的 URI (/test?abc=123) 作为 HTTP 请求标头的一部分发送到 Web 服务器并因此被加密。

但是 URL 可能会以其他方式泄漏，通常是 Web 浏览器工具栏、书签以及向朋友发送链接。根据您发送的数据的上下文/敏感性，发布数据可能更合适。

我相信 HTTPS 连接需要 SSL 证书，如果您不想购买，甚至需要自己生成的证书。

希望那有所帮助！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-21T17:05:12.520

**取决于你所说的安全**

SSL 对整个 HTTP 请求/响应进行加密，因此 GET 部分中的 URL 将被加密。这不会阻止 MITM 攻击和对 SSL 会话本身完整性的破坏。如果使用非权威证书，这会使潜在的攻击向量变得更简单。

[REST 请求标头是否由 SSL 加密？](https://stackoverflow.com/questions/73536/are-rest-request-headers-encrypted-by-ssl)

是一个类似的问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T17:07:43.560

url:s 将同时存储在服务器日志和浏览器历史记录中，因此即使它们不可嗅探，它们也远非安全。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T17:12:33.613

在电线上，是的。在端点（浏览器和服务器）不一定。SSL/TLS 是[传输层安全性](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)。它将加密您在浏览器和服务器之间的流量。可以在浏览器端查看数据（例如[BHO](http://en.wikipedia.org/wiki/Browser_Helper_Object)）。一旦它到达服务器端，它当然可供接收者使用，并且仅与他对待它一样安全。如果数据需要在初始交换之外安全地移动并防止客户端窥探，您还应该查看[消息层安全性](http://msdn.microsoft.com/en-us/library/aa480582.aspx)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-21T17:22:41.707

SSL/TSL 是一种传输层安全性，是的，可以使用 BHO（如@JP 所写）或任何附加功能以及“浏览器外”HTTP 嗅探器来选择数据。他们读取 winsock32 和应用程序之间的消息。加密发生在 winsock32 中，而不是在浏览器中。

看一下（这部分取自IEinspector的页面）： [IEInspector](http://www.ieinspector.com/httpanalyzer/) HTTP Analyzer是一款非常方便的工具，可以让您实时监控、跟踪、调试和分析HTTP/ **HTTPS**流量。

# sql - 视图中的 SQL 服务器字符串操作...或 XSLT

> ID：893964
> 
> 赞同：2
> 
> 时间：2009-05-21T17:02:06.567
> 
> 标签：sql, sql-server, xslt, string

我通过了一项工作，可以在我的应用程序或 SQL 中完成：

我必须从可能如下所示的字符串中获取日期：

```
1234567-DSP-01/01-VER-01/01
```

或像这样：

```
1234567-VER-01/01-DSP-01/01
```

但可能看起来像这样：

```
00 12345 DISCH 01/01-VER-01/01 XXX X XXXXXX
```

耶。如果是a`"DSP"`那么我想要那个日期，如果a`"DISCH"`那么那个日期。

我在 SQL Server 视图中提取数据，并且很乐意让视图为我转换数据。我的应用程序可以做到，但会增加处理器时间。我想，我还可以查看数据是否可以在输入数据库之前进行操作。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T17:12:43.973

一个选项是检查是否存在 DSP 或 DISCH，然后根据需要对日期进行子串化。

例如（我今天没有 sqlserver，所以我可以验证语法，对不起）

```
select
  date = case date_attribute
            when charindex('DSP',date_attribute) > 0 then substring(date_attribute,beg,end)
            when charindex('DISCH',date_attribute) > 0 then substring(date_attribute,beg,end)
            else 'unknown'
        end 
 from myTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:05:47.527

如果您在视图中执行此操作，则会在 SQL 上添加处理时间，这通常是比应用程序、Web 或其他类型的客户端更昂贵的资源。

我建议您在插入数据或在应用程序层处理时尝试格式化数据。水平扩展应用层比扩展 SQL 要容易得多。

**编辑**

我说的是数据库服务器的物理资源通常比设计合理的应用程序服务器的物理资源更昂贵。这是因为水平扩展应用程序非常容易，在我看来，水平扩展数据库服务器的成本要高出一个数量级。特别是如果您处理事务数据库并需要管理合并

我并不是说水平扩展数据库服务器不可能是一项更困难的任务，因此它更昂贵。我指出这一点的唯一原因是 OP 提出了关于在应用服务器与数据库服务器上使用 CPU 周期的问题。我使用过的大多数应用程序都是以数据为中心的应用程序，它们通过 GB 的数据处理以获得用户的答案。我们最初将所有内容都放在数据库服务器上，因为它比当时在经典的 asp 和 vb6 中更容易。随着时间的推移，数据库服务器的负载越来越大，直到不再选择垂直扩展。

数据库服务器还设计用于检索和连接数据。您应该将数据的格式留给应用程序和业务规则（当然一般来说）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:42:53.990

**不要在同一列中存储多个项目！**

插入行时将日期存储在自己的列中！

*   为日期添加一个新的可为空列
*   编写一个更新，将日期拉出并设置新列
*   将列更改为不可为空
*   修复您的保存程序以将日期拉出并为您插入

# .net - 获取 Microsoft Communicator 状态

> ID：893973
> 
> 赞同：1
> 
> 时间：2009-05-21T17:03:55.423
> 
> 标签：.net, office-communicator, user-presence

我想将 Communicator Presence 添加到我的应用程序中（很像 Outlook 和其他 MS 应用程序拥有它的方式），但我无法找到有关如何获取此状态的文档。

有没有一种方法可以查询 Live Communicator 服务器以获取一个人的状态？如果那里有文档但我找不到它们，请给我一个指向那个方向的指针，我会夹着尾巴离开，因为搜索不够努力......

**更新：** 提供的 API 需要 Communicator Server 2007，但我们仍在使用 2003。是否有旧版本的 API？我可以在 MSFT 网站上找到的所有下载都需要 2007。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T17:08:39.143

这看起来很有希望：[Microsoft Office Communicator 2007 Presence Controls](http://www.microsoft.com/downloads/details.aspx?familyid=25A27453-15FF-48AB-AF1B-692CD77AB510&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T22:12:25.417

我很确定您需要为 LCS 2003/2005 使用 RTC 客户端 API - 更多信息[在这里](http://msdn.microsoft.com/en-gb/library/ms775893.aspx)

Live Communications Server 2003 MSDN 文档可在[此处找到](http://msdn.microsoft.com/en-gb/library/aa167872(office.11).aspx)

希望这可以帮助

# java - Java - 如何确定文件名是否有效？

> ID：893977
> 
> 赞同：57
> 
> 时间：2009-05-21T17:04:46.327
> 
> 标签：java, file

在我的 Java 应用程序中，我将文件重命名为字符串参数中提供的文件名。有一种方法

```
boolean OKtoRename(String oldName, String newName) 
```

它基本上检查 newName 是否尚未被其他文件占用，因为我不想掩埋现有文件。

我现在想到，也许 newName 字符串不会表示有效的文件名。所以我想将此检查添加到方法中：

```
if (new File(newName).isFile()) { 
    return false; 
} 
```

这显然不是正确的方法，因为在大多数情况下 newFile 还不存在，因此虽然它*是*OKtoRename，但该函数返回 false。

我想知道，有没有像 java.io.File 对象一样的方法（我知道没有 java.io.File 对象）`canExist()`？还是我必须求助于正则表达式来确保 newFile 字符串不包含无效字符（例如？、*、“、:)？我想知道 JDK 中是否隐藏了一个函数可以告诉我字符串可能表示一个有效的文件名。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-21T17:33:10.547

几个月前，我根据一些在线研究收集了一份非法文件名字符列表（考虑 UNIX、Mac OS X 和 Windows 系统）。如果新文件名包含其中任何一个，则存在可能并非在所有平台上都有效的风险。

```
private static final char[] ILLEGAL_CHARACTERS = { '/', '\n', '\r', '\t', '\0', '\f', '`', '?', '*', '\\', '<', '>', '|', '\"', ':' }; 
```

**编辑：** 我想强调，这**不是一个完整的解决方案**：正如评论者指出的那样，即使它通过了这个测试，您的文件名仍然可能是 Windows 特定的关键字，如 COM、PRN 等。但是，如果您的文件name 包含这些字符中的任何一个，在跨平台环境中肯定会造成麻烦。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-11-04T15:24:39.453

[这里](http://www.rgagnon.com/javadetails/java-check-if-a-filename-is-valid.html)建议系统特定的方式。

```
public static boolean isFilenameValid(String file) {
  File f = new File(file);
  try {
    f.getCanonicalPath();
    return true;
  } catch (IOException e) {
    return false;
  }
} 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-21T17:06:35.420

使用[`createNewFile()`](http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html#createNewFile())，仅当文件尚不存在时才会自动创建文件。

如果创建了文件，则名称有效并且不会破坏现有文件。然后，您可以打开文件并通过`FileChannel.transferXXX`操作有效地将数据从一个复制到另一个。

需要记住的重要一点是，一般来说，检查和创建应该是原子的。如果先检查一个操作是否安全，然后将操作作为一个单独的步骤执行，此时条件可能发生了变化，使操作不安全。

此相关文章中提供了其他值得思考的内容：[“Java 中的移动/复制操作”。](https://stackoverflow.com/questions/300559/move-copy-file-operations-in-java)

* * *

*更新：*

从这个答案开始，引入了 NIO.2 API，增加了与文件系统的交互。

假设您有一个交互式程序，并且希望在每次击键后验证文件是否可能有效。例如，您可能希望仅在条目有效时启用“保存”按钮，而不是在按下“保存”后弹出错误对话框。创建并确保删除我上面的​​建议需要的许多不必要的文件似乎一团糟。

使用 NIO.2，您不能创建`Path`包含文件系统非法字符的实例。`InvalidPathException`只要您尝试创建`Path`.

但是，没有 API 可以验证由有效字符组成的非法名称，例如 Windows 上的“PRN”。作为一种解决方法，实验表明，在尝试访问属性（`Files.getLastModifiedTime()`例如，使用 ）时，使用非法文件名会引发明显的异常。

如果为确实存在的文件指定合法名称，则不会出现异常。

如果您为不存在的文件指定合法名称，则会引发`NoSuchFileException`.

如果指定了非法名称，`FileSystemException`则会引发。

但是，这看起来很笨拙，在其他操作系统上可能不可靠。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-03-11T21:10:42.530

如果为 Eclipse 开发，请查看`org.eclipse.core.internal.resources.OS`

```
public abstract class OS {
   private static final String INSTALLED_PLATFORM;

   public static final char[] INVALID_RESOURCE_CHARACTERS;
   private static final String[] INVALID_RESOURCE_BASENAMES;
   private static final String[] INVALID_RESOURCE_FULLNAMES;

   static {
      //find out the OS being used
      //setup the invalid names
      INSTALLED_PLATFORM = Platform.getOS();
      if (INSTALLED_PLATFORM.equals(Platform.OS_WIN32)) {
         //valid names and characters taken from http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp
         INVALID_RESOURCE_CHARACTERS = new char[] {'\\', '/', ':', '*', '?', '"', '<', '>', '|'};
         INVALID_RESOURCE_BASENAMES = new String[] {"aux", "com1", "com2", "com3", "com4", //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$ //$NON-NLS-4$ //$NON-NLS-5$ 
               "com5", "com6", "com7", "com8", "com9", "con", "lpt1", "lpt2", //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$ //$NON-NLS-4$ //$NON-NLS-5$ //$NON-NLS-6$ //$NON-NLS-7$ //$NON-NLS-8$
               "lpt3", "lpt4", "lpt5", "lpt6", "lpt7", "lpt8", "lpt9", "nul", "prn"}; //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$ //$NON-NLS-4$ //$NON-NLS-5$ //$NON-NLS-6$ //$NON-NLS-7$ //$NON-NLS-8$ //$NON-NLS-9$
         Arrays.sort(INVALID_RESOURCE_BASENAMES);
         //CLOCK$ may be used if an extension is provided
         INVALID_RESOURCE_FULLNAMES = new String[] {"clock$"}; //$NON-NLS-1$
      } else {
         //only front slash and null char are invalid on UNIXes
         //taken from http://www.faqs.org/faqs/unix-faq/faq/part2/section-2.html
         INVALID_RESOURCE_CHARACTERS = new char[] {'/', '\0',};
         INVALID_RESOURCE_BASENAMES = null;
         INVALID_RESOURCE_FULLNAMES = null;
      }
   }

   /**
    * Returns true if the given name is a valid resource name on this operating system,
    * and false otherwise.
    */
   public static boolean isNameValid(String name) {
      //. and .. have special meaning on all platforms
      if (name.equals(".") || name.equals("..")) //$NON-NLS-1$ //$NON-NLS-2$
         return false;
      if (INSTALLED_PLATFORM.equals(Platform.OS_WIN32)) {
         //empty names are not valid
         final int length = name.length();
         if (length == 0)
            return false;
         final char lastChar = name.charAt(length-1);
         // filenames ending in dot are not valid
         if (lastChar == '.')
            return false;
         // file names ending with whitespace are truncated (bug 118997)
         if (Character.isWhitespace(lastChar))
            return false;
         int dot = name.indexOf('.');
         //on windows, filename suffixes are not relevant to name validity
         String basename = dot == -1 ? name : name.substring(0, dot);
         if (Arrays.binarySearch(INVALID_RESOURCE_BASENAMES, basename.toLowerCase()) >= 0)
            return false;
         return Arrays.binarySearch(INVALID_RESOURCE_FULLNAMES, name.toLowerCase()) < 0;
      }
      return true;
   }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-07-27T00:27:52.727

这就是我实现这个的方式：

```
public boolean isValidFileName(final String aFileName) {
    final File aFile = new File(aFileName);
    boolean isValid = true;
    try {
        if (aFile.createNewFile()) {
            aFile.delete();
        }
    } catch (IOException e) {
        isValid = false;
    }
    return isValid;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-05-06T20:35:44.743

只是我发现，在 java 7 及更高版本中，有一个名为的类[`Paths`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Paths.html)有一个名为的方法，该方法`get`需要一个或多个`String`s 并抛出

> [`InvalidPathException`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/InvalidPathException.html)- 如果路径字符串不能转换为路径

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-21T18:00:53.610

对我来说，这似乎是一个依赖于操作系统的问题。您可能只是想检查文件名中的一些无效字符。当您尝试重命名文件时，Windows 会执行此操作，它会弹出一条消息，指出文件不能包含以下任何字符： \ / : * ? < > | 我不确定您的问题是否是“有图书馆为我做这项工作吗？” 在那种情况下，我什么都不知道。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T17:46:03.987

使用

```
String validName = URLEncoder.encode( fileName , "UTF-8");

File newFile = new File( validName ); 
```

做这项工作。

我今天才发现。我不确定它是否 100% 有效，但到目前为止，我已经能够创建有效的文件名。

# .net - 用于从 subversion 自动部署代码的 asp.net Web 应用程序

> ID：893978
> 
> 赞同：1
> 
> 时间：2009-05-21T17:05:04.627
> 
> 标签：.net, asp.net-mvc, svn

我希望这不是一个愚蠢的问题，但是在搜索了很长一段时间之后，我找不到任何像我想要做的事情：

我们构建了一系列基于通用 asp.net mvc 引擎的 Web 应用程序。我想编写一个 .net 网络应用程序，它可以让我们的项目经理自动从 subversion 中检查最新的稳定版本，构建它，然后将其部署到服务器上，这样他们就可以开始定制它了。这里有没有人以前建造过这样的东西？

由于 Web 应用程序需要负责一些其他功能，因此找到执行此类操作的现有代码（或示例）对我来说更有意义，而不是使用现成的包。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:43:15.507

我有一些[CruiseControl.Net](http://confluence.public.thoughtworks.org/display/CCNET/)任务 - 其中一些任务与服务器上的批处理文件挂钩，这些文件调用 MSBuild 来构建、清理和部署 + 压缩构建机器上的 Web 应用程序。

这样我就可以为 QA 和其他部门进行构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T17:09:09.143

如果您不想使用 svn.exe 进行结帐，您可以使用[SVN.NET](http://www.pumacode.org/projects/svndotnet/)从您的代码访问存储库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:15:53.840

如果你使用 TortoiseSVN，你可以利用它的[客户端钩子](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html#tsvn-dug-settings-hooks)在结帐后运行一个脚本（例如，一个 .BAT 文件）来构建你的解决方案，然后将它复制到一个目标目录。

# python - PyQt：在系统托盘应用程序中显示菜单

> ID：893984
> 
> 赞同：28
> 
> 时间：2009-05-21T17:05:35.420
> 
> 标签：python, menu, pyqt, system-tray

首先，我是一位经验丰富的 C 程序员，但对 python 不熟悉。我想使用 pyqt 在 python 中创建一个简单的应用程序。让我们想象一下这个应用程序，它就像运行时一样简单，它必须在系统托盘中放置一个图标，并且它在其菜单中提供了一个退出应用程序的选项。

此代码有效，它显示菜单（我不连接退出操作等以保持简单）

```
import sys
from PyQt4 import QtGui

def main():
    app = QtGui.QApplication(sys.argv)

    trayIcon = QtGui.QSystemTrayIcon(QtGui.QIcon("Bomb.xpm"), app)
    menu = QtGui.QMenu()
    exitAction = menu.addAction("Exit")
    trayIcon.setContextMenu(menu)

    trayIcon.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

但这不会：

```
import sys
from PyQt4 import QtGui

class SystemTrayIcon(QtGui.QSystemTrayIcon):

    def __init__(self, icon, parent=None):
        QtGui.QSystemTrayIcon.__init__(self, icon, parent)
        menu = QtGui.QMenu()
        exitAction = menu.addAction("Exit")
        self.setContextMenu(menu)

def main():
    app = QtGui.QApplication(sys.argv)

    trayIcon = SystemTrayIcon(QtGui.QIcon("Bomb.xpm"), app)

    trayIcon.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

我可能想念一些东西。没有错误，但是在第二种情况下，当我单击右键时，它不会显示菜单。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-21T23:08:33.130

好吧，经过一些调试，我发现了问题。QMenu 对象在完成`__init__`函数后被销毁，因为它没有父对象。虽然 QSystemTrayIcon 的父级可以是 QMenu 的对象，但它必须是 Qwidget。此代码有效（请参阅 QMenu 如何获得与作为 QWidget 的 QSystemTrayIcon 相同的父级）：

```
import sys
from PyQt4 import QtGui

class SystemTrayIcon(QtGui.QSystemTrayIcon):

    def __init__(self, icon, parent=None):
        QtGui.QSystemTrayIcon.__init__(self, icon, parent)
        menu = QtGui.QMenu(parent)
        exitAction = menu.addAction("Exit")
        self.setContextMenu(menu)

def main():
    app = QtGui.QApplication(sys.argv)

    w = QtGui.QWidget()
    trayIcon = SystemTrayIcon(QtGui.QIcon("Bomb.xpm"), w)

    trayIcon.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-07-12T17:32:23.987

我认为我更喜欢以下内容，因为它似乎不依赖于 QT 的内部垃圾收集决策。

```
import sys
from PyQt4 import QtGui

class SystemTrayIcon(QtGui.QSystemTrayIcon):
    def __init__(self, icon, parent=None):
        QtGui.QSystemTrayIcon.__init__(self, icon, parent)
        self.menu = QtGui.QMenu(parent)
        exitAction = self.menu.addAction("Exit")
        self.setContextMenu(self.menu)

def main():
    app = QtGui.QApplication(sys.argv)
    style = app.style()
    icon = QtGui.QIcon(style.standardPixmap(QtGui.QStyle.SP_FileIcon))
    trayIcon = SystemTrayIcon(icon)

    trayIcon.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-10-27T13:49:27.050

这是实现退出操作的代码

```
import sys
from PyQt4 import QtGui, QtCore

class SystemTrayIcon(QtGui.QSystemTrayIcon):
    def __init__(self, icon, parent=None):
       QtGui.QSystemTrayIcon.__init__(self, icon, parent)
       menu = QtGui.QMenu(parent)
       exitAction = menu.addAction("Exit")
       self.setContextMenu(menu)
       QtCore.QObject.connect(exitAction,QtCore.SIGNAL('triggered()'), self.exit)

    def exit(self):
      QtCore.QCoreApplication.exit()

def main():
   app = QtGui.QApplication(sys.argv)

   w = QtGui.QWidget()
   trayIcon = SystemTrayIcon(QtGui.QIcon("qtLogo.png"), w)

   trayIcon.show()
   sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-01-22T11:38:17.887

这是 PyQt5 版本（能够实现 demosthenes 答案的 Exit 动作）。 从 PyQt4 移植到 PyQt5 的[源代码](https://stackoverflow.com/questions/20749819/pyqt5-failing-import-of-qtgui)

```
import sys
from PyQt5 import QtCore, QtGui, QtWidgets
# code source: https://stackoverflow.com/questions/893984/pyqt-show-menu-in-a-system-tray-application  - add answer PyQt5
#PyQt4 to PyQt5 version: https://stackoverflow.com/questions/20749819/pyqt5-failing-import-of-qtgui
class SystemTrayIcon(QtWidgets.QSystemTrayIcon):

    def __init__(self, icon, parent=None):
        QtWidgets.QSystemTrayIcon.__init__(self, icon, parent)
        menu = QtWidgets.QMenu(parent)
        exitAction = menu.addAction("Exit")
        self.setContextMenu(menu)

def main(image):
    app = QtWidgets.QApplication(sys.argv)

    w = QtWidgets.QWidget()
    trayIcon = SystemTrayIcon(QtGui.QIcon(image), w)

    trayIcon.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    on=r''# ADD PATH OF YOUR ICON HERE .png works
    main(on) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-04-17T02:09:24.017

我无法在 PyQt5 中获得上述任何答案（系统托盘菜单中的退出，实际上不会退出），但我设法将它们结合起来以获得有效的解决方案。我仍在尝试确定是否应该以某种方式进一步使用 exitAction。

```
import sys
from PyQt5 import QtWidgets, QtCore, QtGui

class SystemTrayIcon(QtWidgets.QSystemTrayIcon):

    def __init__(self, icon, parent=None):
        QtWidgets.QSystemTrayIcon.__init__(self, icon, parent)
        menu = QtWidgets.QMenu(parent)
        exitAction = menu.addAction("Exit")
        self.setContextMenu(menu)
        menu.triggered.connect(self.exit)

    def exit(self):
        QtCore.QCoreApplication.exit()

def main(image):
    app = QtWidgets.QApplication(sys.argv)
    w = QtWidgets.QWidget()
    trayIcon = SystemTrayIcon(QtGui.QIcon(image), w)
    trayIcon.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    on='icon.ico'
    main(on) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-02-16T01:29:39.717

使用 pyqt5 连接事件：

```
class SystemTrayIcon(QtWidgets.QSystemTrayIcon):

    def __init__(self, icon, parent=None):
        QtWidgets.QSystemTrayIcon.__init__(self, icon, parent)
        menu = QtWidgets.QMenu(parent)
        exitAction = menu.addAction("Exit")
        self.setContextMenu(menu)    
        menu.triggered.connect(self.exit)

    def exit(self):
        QtCore.QCoreApplication.exit() 
```

# jquery - 使用 jQuery（或纯 JS）添加新的 DOM 元素

> ID：893995
> 
> 赞同：3
> 
> 时间：2009-05-21T17:06:47.947
> 
> 标签：jquery, ajax, dom, events, hook

明确一点：我不是在问如何将现有的钩子放到新的 DOM 元素上。我知道 live() 函数和旧的 livequery 插件。我在问别的东西。

我想知道的是如何挂钩新 DOM 元素的创建。我问的原因是我正在创建一个无法控制第一方脚本的第三方用户 JS 脚本。这些第一方脚本（经过混淆处理）通过添加新的 DOM 元素定期更新页面。我想在添加这些元素后执行代码。

使用 $( '...' ).bind( 'ajaxSuccess', function() ..... ) 适用于一些添加，但不是全部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T17:12:20.510

如果它们总是使用 document.createElement 方法添加，您可以简单地替换它并在那里进行跟踪。

```
document.replacedCreateElement = document.createElement;
document.createElement = function(tagName) {
    this.replacedCreateElement(tagName);
    //do your tracking  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-21T17:10:34.087

我不知道你为什么问你是否知道[livequery](http://docs.jquery.com/Plugins/livequery)。[Livequery](http://docs.jquery.com/Plugins/livequery)将允许您连接到任意新的 DOM 元素。除此之外，我唯一知道要做的就是挂钩 DOM 方法（例如 appendChild 等......）

集成到 jQuery 中的 live() 函数实际上并不是完整的 livequery 实现。（Resig 认为在不增加代码大小的情况下集成太多功能）

在 live() 中，缺少的是以下类型函数：

```
$('*').livequery(function() {
 // do something
}); 
```

使用它，它应该会捕获任何添加。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T18:09:42.470

好吧，我选择了这对，它似乎在 20 秒或更短的时间内触发了所需的 DOM 更新：

```
$( '#someid' ).bind( 'ajaxSuccess', function() { ... } );
$( '#someid' ).ajaxSuccess( function( e, r, s ) { ... } ); 
```

我宁愿不必依靠 livequery 来减慢页面加载速度，并且 replaceCreateElement 解决方案会破坏 CPU。****``