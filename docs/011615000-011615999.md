# StackOverflow 问答 11615000-11615999

# .htaccess - modrewrite -f 被忽略

> ID：11615000
> 
> 赞同：1
> 
> 时间：2012-07-23T14:52:24.193
> 
> 标签：.htaccess, mod-rewrite

我有一个图像缓存系统，我使用它来根据需要生成某些图像大小。我使用 modrewrite 来检查文件，如果不存在则调用图像创建系统。我遇到的问题是，即使图像确实存在，它也在调用图像创建系统！

modrewrite 很简单（图像子目录中的站点）

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /images/index.php?id=$1 [L,QSA] 
```

我什至尝试删除`-d`目录检查的情况，这使它感到困惑。我现在得到了它，以便它检查文件是否存在于 index.php 代码中 - 它报告它确实存在。

我在 html 中使用 url `images/cache/140x20/Test.JPG`- 文件存在，所以不`RewriteCond`应该调用 index.php 代码 - 但它出于某种原因吗？

我确定它很明显，但我就是想不通

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T17:21:48.123

> .htaccess 位于图像目录中。使用 R=302 我得到预期的正确路径 www.domain.com/images/index.php?id=cache/140x20/Test.JPG

这很奇怪。我在一个子目录下进行测试，得到了一些意想不到的`%{REQUEST_FILENAME}`. 但是我能够通过从文档根目录重建来使检查正常工作。也许我对`%{REQUEST_FILENAME}`apache 用于将 URI 路径转换为文件路径的底层机制的理解与我的预期不同。

尝试：

```
RewriteCond %{DOCUMENT_ROOT}${REQUEST_URI} !-f
RewriteCond %{DOCUMENT_ROOT}${REQUEST_URI} !-d
# and maybe for good measure
RewriteCond %{REQUEST_URI} !index.php 
```

* * *

编辑：

如果您的扩展名全部大写但图像文件扩展名始终全部小写，则可以使用[RewriteMap](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritemap)`tolower`并使用以下函数定义映射：

（在您的服务器或虚拟主机配置中的某处：

```
RewriteMap lowercase int:tolower 
```

然后在您的 htaccess 文件中（在您的其他规则之上），将文件名更改为小写：

```
# first check to make sure request doesn't already have all lowercase image extension
RewriteCond %{REQUEST_URI} !\.(jpe?g|png|bmp|gif)$
RewriteRule ^(.*)\.(jpe?g|png|bmp|gif)$ /$1.${lowercase:$2} [NC,L] 
```

您也可以对整个文件名或整个路径执行类似的操作。

# iphone - iPhone是否有可能找到一个UILabel的极限？

> ID：11615002
> 
> 赞同：1
> 
> 时间：2012-07-23T14:52:27.873
> 
> 标签：iphone, objective-c, xcode, text, uilabel

有没有办法找到 UILabel 的文本限制？我只是想找到 UILabel 的文本限制何时超过。就像 Xcode 识别标签的换行符一样。有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:05:14.940

从技术上讲，`UILabel`的 text 属性是一个`NSString`对象，对于该`NSString`对象**没有已知的长度限制**，而是内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:09:07.857

您可以将标签的宽度与文本的宽度进行比较。您可以使用 NSString 的 sizeWithFont 方法获取文本的大小。对于字体，您可以使用 label.font。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T16:14:17.357

我认为您正在寻找`sizeWithFont:`方法：

```
float textWidth = [yourString sizeWithFont:yourLabel.font].width; 
```

然后与`textWidth`比较`yourLabel.bounds.size.width`。

# visual-studio-2010 - 无法使用 AnkhSVN 通过 HTTPS 连接到 SVN 存储库

> ID：11615015
> 
> 赞同：3
> 
> 时间：2012-07-23T14:52:58.630
> 
> 标签：visual-studio-2010, ssl, ankhsvn

我正在使用 Windows 7、Visual Studio 2010 和 AnkhSVN。

当我单击“<em>Add Solution to Subversion”并将我的存储库 URL 粘贴到指定字段时，没有任何反应；我没有被要求接受证书。

当我尝试通过 http（而不是 https）连接时，系统会要求我输入用户名和密码（如预期的那样）。作为临时措施，我只是接受非加密连接。成功提交我的测试文件后，我进入“<em>Pending Changes”并单击“<em>Switch To”（URL 字段）并选择“<em>Other”。我把地址改成https，弹出如下错误信息：

> 发生了内部错误：
> 
> SharpSvn.SvnRepositoryIOException：无法连接到 URL '[my repository URL]' 的存储库 '[my repository URL]'的选项：SSL 握手失败：由于缺少熵 [https URL] 禁用 SSL

我尝试使用 Assembla 和 Google 存储库，结果相同。

回到今年一月，我最后一次真正使用SVN，我没有这个问题。当我加载这个旧的 1 月项目时，它无法再通过 https 连接到存储库。

我认为，从那时起唯一改变的就是升级 AnkhSVN。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T15:14:35.920

这是由禁用 LanMan Windows 服务时 SharpSvn 编译 OpenSSL 中的错误引起的。该错误已在最近的 AnkhSVN 和 SharpSvn 版本中得到修复。

# jquery - 带有 Codeigniter 的 jQuery 和 Ajax - 似乎无法在控制器中打印 $_GET 数组

> ID：11615016
> 
> 赞同：0
> 
> 时间：2012-07-23T14:53:00.590
> 
> 标签：jquery, ajax, forms, codeigniter

我有一个表单，经过这么多秒后会自动将表单保存到数据库中（这就是我的意图）

下面的脚本抓取 jQuery AJAX 请求中的值并将其发送到控制器 - 但每当我尝试 var_dump 值时，它似乎无法从序列化数组中工作。当我在 Firefox 中查看 FireBug 但似乎无法打印数组时，我可以看到参数存在 - 谁能解释为什么？

```
// view logic
var t = setTimeout("autosave()", 10000); 
$.ajax( 
{ 
    type: "GET", 
    url: "/questionnaires/autosave", 
    data: $("form").serialize(), 
    cache: false, 
    success: function(msg) {
        return false;
    }
});

// controller logic
function autosave()
{
    $str = parse_str( $this->input->get_post('form') );
    var_dump($str); // intend to do an insert query here to the db
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:18:28.113

您很可能没有`query_string`在 config.php 中启用。

结果，您将无法`GET`可靠地使用。您最好的选择是更改`type: "GET",`为`type: "POST",`.

然后用于`$this->input->post()`访问 post 变量。您可以从 Codeigniter 文档中参考此信息：

[http://codeigniter.com/user_guide/libraries/input.html](http://codeigniter.com/user_guide/libraries/input.html)

> ## $this->input->post()
> 
> 第一个参数将包含您要查找的 POST 项目的名称：
> 
> ```
> $this->input->post('some_data'); The function returns FALSE (boolean) 
> ```
> 
> 如果您尝试检索的项目不存在。
> 
> 第二个可选参数允许您通过 XSS 过滤器运行数据。通过将第二个参数设置为布尔值 TRUE 来启用它；
> 
> ```
> $this->input->post('some_data', TRUE); To return an array of all POST 
> ```
> 
> 项目调用没有任何参数。
> 
> 要返回所有 POST 项目并通过 XSS 过滤器传递它们，请将第一个参数设置为 NULL，同时将第二个参数设置为布尔值；
> 
> 如果 POST 中没有项目，该函数将返回 FALSE（布尔值）。
> 
> ```
> $this->input->post(NULL, TRUE); // returns all POST items with XSS
> $this->input->post(); // returns all POST items without XSS 
> ```

# python - Python：在for循环中赋值后在赋值之前引用的局部变量

> ID：11615025
> 
> 赞同：0
> 
> 时间：2012-07-23T14:53:27.730
> 
> 标签：python

我知道这是一个常见问题，但我找不到适合我的案例的解决方案。我在 Python 中的 for 循环时遇到了问题。当我用这件作品运行程序时

```
for j in range(len(line1)- 3):
    print 'j =', j
    spl1 = spline(line1[j], line1[j + 1], line1[j + 2], line1[j + 3], t, Nu)

print 'spl1 ='
matrix.show(spl1) 
```

我得到一个输出：

```
Traceback (most recent call last):
File "D:\work\curvature\test\twisted\cardinal_spline.py", line 272, in <module> main()
File "D:\work\curvature\test\twisted\cardinal_spline.py", line 111, in main 
matrix.show(spl1)
UnboundLocalError: local variable 'spl1' referenced before assignment 
```

此外，它不打印 j 变量。我看不出那里有任何错误。“spl1”是在 for 循环中分配的，但看起来解释器只是跳过了它。

请指出错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T14:57:02.667

在 Python 中，循环没有单独的作用域，因此如果进入循环，`spl1`变量*将被设置为“全局”。*

line1 变量可能只有 3 个或更少的字符长，因此从未进入循环，因此从未分配过该变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T14:55:15.240

`len(line1) <= 3`由于在某些情况下，您的 for 循环根本不会执行，因此`spl1`没有分配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T14:57:13.753

我猜你的长度`line1`小于或等于 3。（`range(0)`返回一个空列表`range(-1)`，等等）正因为如此，你的 for 循环没有任何东西可以迭代，因此它不会执行代码块。

# c++ - C++ - 具有相同名称的函数

> ID：11615026
> 
> 赞同：1
> 
> 时间：2012-07-23T14:53:29.447
> 
> 标签：c++, function, header

我必须包含两个不同的头文件（一个是标准的 assert.h），它们都带有一个 assert 函数。我无法控制这些头文件（所以我无法更改它们）。我收到一个编译器错误，说明这两个函数之间的冲突。如何在我的代码中指定应使用 assert.h 中的 assert 函数来消除此编译器错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:00:14.597

```
namespace OtherAssert
{
#include "private_assert.h"
}
//...
void foo()
{
    OtherAssert::assert(true); // non-standard assert
    assert(true); // the one from standard assert.h
} 
```

# javascript - b/w 新旧 javascript 函数语法有什么区别？

> ID：11615027
> 
> 赞同：0
> 
> 时间：2012-07-23T14:53:29.233
> 
> 标签：javascript

> **可能重复：**
> [JavaScript：var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)

Foo 和 Bar 有何不同？

如果对象只是函数，为什么要引入这种新语法？（福）。

```
var Foo = function(arg) {
    this.attr = arg;
};

function Bar (arg)  {
    this.attr = arg;
}

/*
>>> f = new Foo(3)
Object { attr=3}
>>> f.attr
3
>>> b = new Bar(40)
Bar { attr=40}
>>> b.attr
40
*/ 
```

我读过的大量文档都提出了第一种语法，但第二种似乎也同样有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T14:57:19.187

区别就在这里：

```
console.log(typeof foo); //'function'
function foo() {
}

console.log(typeof bar); //'undefined'
var bar = function () {
} 
```

# haskell - Haskell 错误：“非详尽模式”

> ID：11615031
> 
> 赞同：3
> 
> 时间：2012-07-23T14:53:45.973
> 
> 标签：haskell, pattern-matching

所以我有这个功能，当我尝试像这样使用它时：mergeSortedLists [1,1] [1,1] 它给了我一个错误：

> [1,1*** 例外：SortFunctions.hs:(86,1)-(91,89)：函数 mergeSortedLists 中的非详尽模式

```
85 mergeSortedLists :: (Ord t)       => [t] -> [t] -> [t]
86 mergeSortedLists [] []            = []
87 mergeSortedLists (x:[]) []        = x:[]
88 mergeSortedLists [] (y:[])        = y:[] 
89 mergeSortedLists (x:[]) (y:[])    = (max x y) : (min x y) : []
90 mergeSortedLists (x:tail1) (y:tail2) | x > y  = x : (mergeSortedLists tail1     (y:tail2))
91                                      | otherwise = y : (mergeSortedLists (x:tail1) tail2) 
```

我无法弄清楚问题的根源，因为我认为我涵盖了所有可能的情况。这里可能是什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T14:58:28.143

您的第二种和第三种情况的模式涵盖了与空列表合并的长度为 1 的列表，但没有涵盖与空列表合并的更长的列表。也就是说，您没有涵盖这样的案例：

```
mergeSortedLists [3, 2, 1] []
mergeSortedLists [] [3, 2, 1] 
```

这是一个功能，可以在较少的情况下完成我认为您正在尝试做的事情：

```
mergeSortedLists :: (Ord t) => [t] -> [t] -> [t]
mergeSortedLists x [] = x
mergeSortedLists [] y = y
mergeSortedLists (x:tail1) (y:tail2)
    | x > y     = x : (mergeSortedLists tail1 (y:tail2))
    | otherwise = y : (mergeSortedLists (x:tail1) tail2) 
```

（另外，您的功能不是在技术上合并*反向排序*列表吗？）

# python - 如何从两个列表中查找匹配项？

> ID：11615041
> 
> 赞同：20
> 
> 时间：2012-07-23T14:54:25.920
> 
> 标签：python, python-2.7

> **可能重复：**
> [Python：如何找到列表交集？](https://stackoverflow.com/questions/3697432/python-how-to-find-list-intersection)

我在 .txt 中有两个数据列表

```
data1 = "name1", "name2", "name3", "name4" etc.

data2 = "name3", "name6", "name10" etc. 
```

我想找出两个列表中出现的名称我该怎么做？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-07-23T14:55:25.453

使用[集](http://docs.python.org/library/stdtypes.html#set-types-set-frozenset)：

```
set(data1) & set(data2) 
```

运算符的`&`意思是“给我这两组的交集”；或者，您可以使用以下`.intersection`方法：

```
set(data1).intersection(data2) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-23T15:00:35.427

```
nf = [x for x in data1 if x in data2]
nf 
```

将返回两个列表中的共同项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:00:56.983

```
>>> [ name for name in data1 if name in data2 ]
['name3'] 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-07-23T14:59:42.853

```
For a in data1:
    for b in data2:
        if a==b:
        print(a) 
```

这是一种方法，但不是最好的方法

# svn - 颠覆客户端 1.7 文件外部更新错误

> ID：11615043
> 
> 赞同：3
> 
> 时间：2012-07-23T14:54:30.560
> 
> 标签：svn

`svn update`我在使用单个文件 svn:externals 的工作副本文件夹时遇到了错误。我想知道是否有解决方法，如果我做错了什么，或者这是否是 subversion 客户端 1.7.x 中的错误。

`svn update`在具有单个文件的文件夹上使用 subversion 1.7.5（尝试过 TortoiseSvn 1.7.7 和 slikSvn 1.7.5）调用时会发生错误`svn:externals`。我很想说这是颠覆客户端中的一个错误，因为更新确实发生了，但它说它失败了。

作为参考，服务器端使用非常旧的版本（1.1.4 [r13838]），但据我所知，外部是客户端“功能”，因此旧服务器应该不是问题。此外，这在使用 subversion 1.6.x（客户端）时效果很好。

这是我观察到的场景：

1.  签出一个项目（具有单个文件`svn:externals`）

    ```
    svn checkout http://my/repo/projects/proj1 proj1 
    ```

2.  使用单个文件浏览到我的工作副本中的文件夹`svn:externals`。例如

    ```
    myFile.txt http://my/repo/components/comp1/myFile.txt 
    ```

3.  执行`svn update`，我得到以下输出：

```
将外部项目提取到“trunk\proj1\source\myFile.txt”：
: 警告: W160016: 失败打开
'/components/comp1/myFile.txt/myFile.txt'
```

如果更改，`svn:externals`使本地文件具有不同的名称，如下所示：

```
my_file.txt http://my/repo/components/comp1/myFile.txt 
```

那么3.中的错误信息变成如下，所以最后一个正斜杠（'/'）后面的文件是文件的本地版本。

```
将外部项目提取到“trunk\proj1\source\myFile.txt”：
：警告：W160016：打开“/components/comp1/myFile.txt/my_file.txt”失败
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-30T18:14:00.887

这确实是颠覆客户端的一个错误。有关详细信息，请参阅[http://subversion.tigris.org/issues/show_bug.cgi?id=4224](http://subversion.tigris.org/issues/show_bug.cgi?id=4224)：它已在 subversion 1.7.7 中修复。

正如问题中所指出的，幸运的是它不会影响功能 - 本地文件仍会更新以匹配外部文件，但您会收到显示的虚假错误消息。

# drag-and-drop - 使用 Mootools 的拖放功能添加可放置元素

> ID：11615044
> 
> 赞同：0
> 
> 时间：2012-07-23T14:54:31.643
> 
> 标签：drag-and-drop, mootools

这是我的问题，我正在使用 mootools 的 Drag&Drop 功能，它工作得很好，但我找不到动态添加新的可放置元素的方法，因为可放置元素是在可拖动元素时定义的。它们是一种 makedraggable 方法，您可以使用它来添加可拖动元素，但它没有与 droppables 等效的方法。

使用 jQuery，您可以在一侧设置可拖动元素，在另一侧设置可放置元素，因此您几乎可以做任何您想做的事情。

你知道解决我问题的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:46:26.557

理论上，您应该能够将元素推送到`instance.droppables`集合中。

```
var foo = new Drag.Move({
    droppables: document.getElements('div.dropHere'),
    ...
});

foo.droppables.push(document.id('newDropHere'));
// or... 
foo.droppables.include(element); // etc. all array/Elements methods. 
```

阅读[https://github.com/mootools/mootools-more/blob/master/Source/Drag/Drag.Move.js](https://github.com/mootools/mootools-more/blob/master/Source/Drag/Drag.Move.js)

如果您需要实际帮助，请在 tinker.io 或 jsfiddle.net 上构建一个示例。如果记忆有用，这已经被问过here，除了添加到Collection之外，还必须做一些额外的工作来解析可能的droppables。

# visual-studio-2012 - 如何强制 VS2012 使用 32 位版本的 Internet Explorer

> ID：11615045
> 
> 赞同：0
> 
> 时间：2012-07-23T14:54:32.173
> 
> 标签：visual-studio-2012

我有一个从中启动 Internet Explorer 的程序。如果我在 VS2010 中打开项目并调试它，它使用的浏览器是 Internet Explorer 9 32 位。如果我在 VS2012 中打开项目并调试它，它使用的浏览器是 Internet Explorer 9 64 位。

如何防止 VS2012 使用 64 位版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:35:52.780

在构建中将项目设置为以 x86 为目标将强制它使用 Internet Explorer 32 位。如果您使用 Any 它将默认为计算机的配置，在本例中为 x64。

# ruby-on-rails - 如何在 Rails 中发送 URL 请求？

> ID：11615052
> 
> 赞同：2
> 
> 时间：2012-07-23T14:54:56.477
> 
> 标签：ruby-on-rails, api, url, call

我需要从 rails 中的方法调用带有参数的 URL。如何在 Rails 中调用 URL？例如，在方法中，我想调用这个 URL 请求：www.example.com?name=parameter01&password=parameter02

如何在 Rails 中调用这种类型的 url 方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:04:05.280

你试过这个：[http](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html) ://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html ？

一个例子 ：

```
require 'net/http'
uri = URI('http://example.com/index.html?key=value')
req = Net::HTTP.get(uri)
puts req #show result 
```

# python - 为什么使用多个参数来记录而不是插值？

> ID：11615053
> 
> 赞同：9
> 
> 时间：2012-07-23T14:54:57.230
> 
> 标签：python, logging, interpolation

Python 的日志记录函数允许您向它们传递多个参数，它们可以为您插值。所以你有一个选择：

```
logger.info("Something %s this way comes!" % "wicked") 
```

或者

```
logger.info("Something %s this way comes!", "wicked") 
```

但是为什么要选择其中之一呢？这仅仅是让错误发生在记录器中而不是在被记录的程序中发生的问题，还是有别的原因？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-23T15:02:57.970

这是性能问题：

*   当您在代码中进行插值时，每次调用记录器时都会执行此代码（如果未激活记录器或日志级别的事件）
*   当您让记录器进行插值时，只有在记录器和日志级别被激活时才会进行插值。

# magento - Magento：添加到购物车时更改产品名称

> ID：11615055
> 
> 赞同：0
> 
> 时间：2012-07-23T14:55:01.430
> 
> 标签：magento

我希望在添加到购物车时更改产品名称，以便相同的产品为不同的用户使用不同的名称。

你有什么想法吗？

请帮我............

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T17:52:46.463

您需要为此编写观察者。您要查找的事件是`checkout_cart_add_product_complete`，因此一旦观察到此事件，只需更改产品名称即可。

在观察者内部，您可以使用如下代码获取产品名称：

```
public function changeProdName($obs) {
    $product = $obs->getProduct();
    $prodNameToChange = $product->getName();
} 
```

# c# - 阻止用户关闭 Firefox

> ID：11615056
> 
> 赞同：2
> 
> 时间：2012-07-23T14:55:01.533
> 
> 标签：c#, firefox

我绝对需要用户退出她/他用来访问我们数据库的网站。如果一个人没有注销，只是关闭了浏览器，系统会将用户名锁定一个小时。*我没有实现它，它就是它的工作方式。*

我想写一个简单的 C# 程序，以某种方式检测用户是否注销，如果没有，阻止他们关闭浏览器。

1) 是否有 Firefox API 或任何其他方式来读取 firefox.exe 进程中的网站内容？

2) 当用户点击“X”关闭浏览器时，是否可以中止 firefox.exe 进程的终止？（可能这是破坏交易的问题）。

我会很感激任何提示。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-23T15:00:02.027

如果您使用身份验证，每个用户都应该有一个会话。会话可以配置为过期。您需要做的只是处理一个适当的[会话过期事件](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.sessionstatemodule.end.aspx)。

不要寻找任何黑客来处理浏览器退出事件 - 这是一条危险的道路：

*   每个人都会讨厌它，而且你不可能让它可靠，即在较新版本的浏览器中工作，支持不同操作系统上的许多浏览器等
*   这可能适用于 Firefox Mozilla（[示例](https://stackoverflow.com/q/138411/706456)），但可能不适用于 IE 或 Chrome
*   应用程序可以被操作系统杀死，因此浏览器事件不会有机会触发并且您的处理代码将不起作用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:03:25.943

您不能阻止用户关闭 firefox，因为有很多方法可以关闭它，而这些方法无法由您的代码控制（例如，从 taskmon 中终止进程）。但是，您可以在代码中检测到关闭事件（window.onClose() 事件）并执行注销过程。

但是，如果 firefox（或任何其他浏览器）被杀死而不是被关闭，window.onClose() 将不起作用。因此，最好在服务器中处理会话，而不是依赖于客户端行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-23T15:08:20.423

您可以做的是使用 javascript 来检测浏览器关闭或离开您的网站，并在这些情况下触发一个方法或点击一个将它们注销的 Web 服务。非常快速，非常简单，并且可以跨浏览器工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T14:57:57.853

您无法阻止用户使用合法方法关闭程序。这是出于明显的安全目的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-06T03:50:52.747

我同意 oleksii。但是您可以让用户更不容易关闭 Firefox。

我目前正在编写一个附加组件（通过 SDK），它侦听“quit-application-requested”观察者通知并将 aSubject.data 设置为 true 以防止 Firefox 退出应用程序。

```
observe: function(aSubject, aTopic, aData) {
    if (aTopic == "quit-application-requested") {
      aSubject.QueryInterface(Ci.nsISupportsPRBool);
      aSubject.data = (this.canQuit() == false);
    }
  } 
```

但我真正想要的是不关闭某个窗口，因为不关闭 Web 应用程序（FileMaker 数据库）。

因此，我还尝试禁用所有命令、所有键和所有菜单（浏览器 XUL），如下所示：

```
var allCommands = win.document.getElementsByTagName("command");
for (let i = 0; i < allCommands.length; i++) {
  allCommands[i].setAttribute("disabled", "true");
}

var allKeys = win.document.getElementsByTagName("key");
for (let i = 0; i < allKeys.length; i++) {
  allKeys[i].setAttribute("disabled", "true");
}

var allMenus = win.document.getElementsByTagName("menu");
for (let i = 0; i < allMenus.length; i++) {
  allMenus[i].setAttribute("disabled", "true");
} 
```

但是除非我阻止打开新的 Firefox 窗口，否则用户仍然可以退出应用程序并因此关闭带有 Web 应用程序的窗口。

所以“它”有效，但我希望他们仍然浏览并且不关闭该选项卡所在的特定选项卡或窗口。

在不阻止打开新窗口的情况下，它不起作用，因为显然当用户打开一个新窗口然后当用户按下 Alt+F4 时，它不会是应用程序退出而是窗口关闭。尽管我认为我已经禁用了所有命令/键/菜单，但仍然存在某种接近的可能性。

有没有人对如何在不阻止打开新窗口的情况下实现这一点有任何想法？

# jquery - 使用 jquery .ajax 和 hrefs

> ID：11615058
> 
> 赞同：0
> 
> 时间：2012-07-23T14:55:05.023
> 
> 标签：jquery

如何将值从这样的链接传递给函数`<a href="search=sony&offset=20&lang=en" class="more_info">Read More</a>`此链接不是静态的，值会根据搜索词和页码而变化。

当用户单击此链接时，它会将这 3 个值发送到 demo_search.php。结果以 html 形式返回。仅刷新页面上的一个 div。

我不知道如何将这些值获取到函数中的数据部分。你能帮我解决这个问题吗？

```
$(function() {

    $(".more_info").click(function() {
            // ajax call
            $.ajax({
                type: "GET",
                url: "demo_search.php",
                data: Need help in getting those values from the href here,
                beforeSend: function(html) {

                    $(".imgProgress").html(imgLoad);

                },
               success: function(page_data){

                    $("#results").empty();
                    $("#results").append(page_data);
                    $(".imgProgress").empty();
              },

            });    
        }
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T14:57:31.660

尝试：

```
url: "demo_search.php?"+$(this).attr("href"), 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:02:11.507

When calling $.ajax(), you can actually pass the data as a query string, so

```
data : this.href 
```

should work.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T14:58:54.300

尝试这个

```
$(function() {

    $(".more_info").click(function() {
            var targetLink = this;
            $.ajax({
                type: "GET",
                url: "demo_search.php?"+$(targetLink).attr("href"),
                beforeSend: function(html) {

                    $(".imgProgress").html(imgLoad);

                },
               success: function(page_data){

                    $("#results").empty();
                    $("#results").append(page_data);
                    $(".imgProgress").empty();
              },

            });    
        }
        return false;
    });
});​ 
```

# javascript - 如何在 Javascript Win8 Metro App 中捕获前台和后台事件

> ID：11615059
> 
> 赞同：1
> 
> 时间：2012-07-23T14:55:10.780
> 
> 标签：javascript, windows-8, dom-events, microsoft-metro

Win8 Metro 在进程进入激活和挂起状态时提供回调，但是当应用程序进入前台或进入后台时呢？该过程不一定会在应用程序进入后台后立即暂停，同样它可能会进入前台，同时仍从上次启动时被激活。

Javascript 中是否有任何事件可用于在应用程序的前台或后台执行代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:31:53.773

当应用程序被置于后台，但尚未暂停时，您可以使用“visibilitychanged”事件和文档对象上的“隐藏”属性：http: [//msdn.microsoft.com/en-us/library /ie/hh773167(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/hh773167(v=vs.85).aspx)

当您的应用程序不再可见时（例如，用户点击开始按钮，或滑动到另一个应用程序），这些就会被触发。

如果您的应用程序随后被暂停，那么您还将*获得*相应的暂停事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:06:21.300

据我了解，一旦 Metro 应用程序完全失去焦点（完全离开屏幕），操作系统就会给它 15 秒（我认为）运行其 OnSuspend 代码，然后才会停止和暂停。每次整个应用程序失去完全焦点时都会发生这种情况，而当它再次获得焦点时会发生相反的情况（用户切换回它）。

您将在这些前台和后台事件中运行的代码应该放在 Suspension 和 Reactivation 事件处理程序中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:13:50.827

在 Metro 风格的应用程序中，应用程序将在用户切换离开时暂停，并在用户切换回应用程序时恢复。Metro 风格的应用程序运行全屏和沉浸式，因此“暂停”相当于您认为的“进入后台”，恢复相当于进入前台。

一旦触发了暂停事件（当用户从​​您的应用上滑开时），您的应用有 5 秒的时间来存储关闭状态。在挂起模式下，您的主执行线程被挂起，但应用程序仍保留在内存中。用户可能很快就会回到您的应用程序，然后线程会恢复并且您存储的状态永远不会使用。但是，在某些时候，Windows 可能内存过多，需要终止进程。如果您的应用程序已终止，那么您可以使用您存储的状态将您的应用程序恢复到下一次运行时终止时的状态。

查看这些资源以获取更多信息： * 不同的应用程序执行状态：http: [//msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.activation.applicationexecutionstate.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.activation.applicationexecutionstate.aspx) * 相关指南：[http ://msdn.microsoft.com/en-us/library/windows/apps/hh465088.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465088.aspx)

# java - 坏的 方法中的方法调用？

> ID：11615060
> 
> 赞同：2
> 
> 时间：2012-07-23T14:55:11.687
> 
> 标签：java, bytecode

我收到此错误：

```
java.lang.VerifyError: Bad <init> method call in method FooBar.<init>(I)V at offset 2
    at java.lang.Class.getDeclaredConstructors0(Native Method)
    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2404)
    at java.lang.Class.getConstructor0(Class.java:2714)
    at java.lang.Class.getDeclaredConstructor(Class.java:2002) 
```

尝试访问我使用 ASM 4.0（使用 jdk7）修改的类的构造函数时。

我检查了类的初始化方法的字节码，如下所示：

```
aload_0
iload_1
invokespecial com/foo/F/<init>(I)V
return 
```

反编译字节码会产生：

```
import com.foo.Foo;

public class FooBar extends Foo
{
  public FooBar(int i)
  {
    super(i);
  }
} 
```

我完全不知道为什么会收到此错误。我不知道我是否提供了足够的信息；如果我可以添加更多信息，请告诉我。

编辑：这是访问构造函数的代码：

```
Class fooBarClass = /* define class from class file bytes */;
Constructor fooBarConstructor = fooBarClass.getDeclaredConstructor(int.class); 
```

EDIT2：这是 Foo 类的代码：

```
public class Foo extends F {

    public Foo(int i) {
        super(i);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T17:53:48.957

尝试反编译类 Foo 并注意正确的构造函数。我的赌注是构造函数 Foo(int) 不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T03:21:43.533

抛出 VerifyError 是因为在类 FooBar 的构造函数中调用的方法实际上是 F 类的方法，而不是 Foo 类的方法。

FooBar 类中对超级方法的常量池引用指向了错误的类（即 F 而不是 Foo）。因此，VerifyError 与相应的消息“Bad method call”一起被抛出。

# database - How to reconfigure path to the data files in Clarion 5 IDE?

> ID：11615072
> 
> 赞同：1
> 
> 时间：2012-07-23T14:55:31.963
> 
> 标签：database, clarion

There is a problem, the system is written in [Clarion 5](http://en.wikipedia.org/wiki/Clarion_(programming_language)) came from the past and now it needs to be rewrite in Java.

To do this I need to deal with its current state and how it works.

I'm generate the executable file via Application Generator `(\*.APP-> \*.CLW -> \*.EXE, \*.DLL)`.

But when I run it I get the message:

`File(\...\...\DAT.TPS) could not be opened. Error: Path Not Found(3). Press OK to end this application`

And then - `halt, File Access Error`

In what may be the problem? Is it possible in the Clarion 5 IDE to reconfigure the path to the data files?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T19:16:15.560

Generally, Clarion uses a data dictionary (DCT) as the center of persistent data (files) that will be used by the program. There are other ways you can define a table, but since you mentioned you compile from the APP, I'm concluding that your APP is linked to a DCT.

In the DCT you have the declarations for every file your application will use. In the file declaration you can inform both logic and disk file name. The error message says you have a problem in the definition of the disk file name.

The Clarion language separates the logic data structure definition from its disk file. A "file" for a Clarion programm, is a complex data structure, which conforms to the following:

```
structName          FILE, DRIVER( 'driverType' ), NAME( 'diskFileName' )
key                   KEY( keyName )
index                 INDEX( indexName )
recordName            RECORD
field                   DATATYPE
 .
 .
                      END
                    END 
```

The above is the basic declaration syntax, and a real example would be like:

```
orders              FILE, DRIVER( 'TopSpeed' ), NAME( 'sales.dat\orders' )
ordersPK              KEY( id ), PRIMARY
customerK             INDEX( customerID )
notes                 MEMO( 4096 )
RECORD                RECORD
id                      LONG
customerID              LONG
datePlaced              DATE
status                  STRING( 1 )
                      END
                    END

orderItems          FILE, DRIVER( 'TopSpeed' ), NAME( 'sales.dat\items' )
itemsPK               KEY( orderID, id ), PRIMARY
RECORD                RECORD
orderID                 LONG
id                      LONG
productID               LONG
quantityOrdered         DECIMAL( 10, 2 )
unitPrice               DECIMAL( 10, 2 )
                      END
                    END 
```

Now, with the above two declarations, I have two logic files that reside in the same disk file. This is a capability offered for some file drivers, like the TopSpeed file driver. It is up to the system designer to decide if, and which files will reside in the same disk file, and I can talk about that on another post, if it is the case.

For now, the problem may be arising from the fact that you probably didn't change the NAME property of the file declaration, and the driver you're using doesn't support multi-file storage.

Here's a revised file definition for the same case above, but targeting a SQL database.

```
szDBConn            CSTRING( 1024 )               ! //Connection string to DB server

orders              FILE, DRIVER( 'ODBC' ), NAME( 'orders' ), OWNER( szDBconn )
ordersPK              KEY( id ), PRIMARY
customerK             INDEX( customerID )
notes                 MEMO( 4096 ), NAME( 'notes' )
RECORD                RECORD
id                      LONG, NAME( 'id | READONLY' )
customerID              LONG
datePlaced              DATE
status                  STRING( 1 )
                      END
                    END

orderItems          FILE, DRIVER( 'ODBC' ), NAME( 'order_items' ), OWNER( szDBconn )
itemsPK               KEY( orderID, id ), PRIMARY
RECORD                RECORD
orderID                 LONG
id                      LONG
productID               LONG
quantityOrdered         DECIMAL( 10, 2 )
unitPrice               DECIMAL( 10, 2 )
                      END
                    END 
```

Now, if you pay attention, you'll notice the presence of a `szDBconn` variable declaration, which is referenced at the file declarations. This is necessary to inform the Clarion file driver system what to pass the ODBC manager in order to connect to the dabase. Check [Connection Strings](http://www.connectionstrings.com/) for plenty of connection strings examples.

Check the DCT definitions of your files to see if they reflect what the driver expects.

Also, be aware that Clarion does allow mixing different file drivers to be used by the same program. Thus, you can adapt an existing program to use an external data source if needed.

Here is a complete Clarion program to transfer information from an ISAM file to a DBMS.

```
PROGRAM

MAP
END

INCLUDE( 'equates.clw' )                 ! //Include common definitions

szDBconn              CSTRING( 1024 )

inputFile             FILE, DRIVER( 'dBase3' )
RECORD                  RECORD
id                        LONG
name                      STRING( 50 )
                        END
                      END

outuputFile           FILE, DRIVER( 'ODBC' ), NAME( 'import.newcustomers' ), |
                        OWNER( szDBconn )
RECORD                  RECORD
id                        LONG
name                      STRING( 50 )
backendImportedColumn     STRING( 8 )
imported                  GROUP, OVER( backendImportedColumn )
date                        DATE
time                        TIME
                          END
processed                 CHAR( 1 )
                        END
                      END

CODE

IF NOT EXISTS( COMMAND( 1 ) )
  MESSAGE( 'File ' & COMMAND( 1 ) & ' doesn''t exist' )
  RETURN
END

imputFile{ PROP:Name } = COMMAND( 1 )
OPEN( inputFile, 42h )
IF ERRORCODE()
  MESSAGE( 'Error openning file ' & inputFile{ PROP:Name } )
  RETURN
END

szDBconn = 'Driver={{PostgreSQL ANSI};Server=192.168.0.1;Database=test;' & |
  'Uid=me;Pwd=plaintextpassword'

OPEN( outputFile, 42h )
IF ERRORCODE()
  MESSAGE( 'Error openning import table: ' & FILEERROR() )
  RETURN
END

! // Lets stuff the information thatll be used for every record
outputFile.imported.date = TODAY()
outputFile.imported.time = CLOCK()
outputFile.processed = 'N'

! //arm sequential ISAM file scan
SET( inputFile, 1 )
LOOP UNTIL EOF( inputFile )
  NEXT( inputFile )

  outputFile.id = inputFile.id
  outputFile.name = input.name
  ADD( outputFile )
END

BEEP( BEEP:SystemExclamation )
MESSAGE( 'File importing completed' ) 
```

Well, this example program serves only the purpose of showing how the different elements of the program should be used. I didn't use a window to let the user track the progress, and used Clarion's primitives, like ADD(), which work for sure, but inside a loop can represent a drag in performance.

Much better would be to encapsulate the entire reading in a transaction opened with `outputFile{ PROP:SQ } = 'BEGIN TRANSACTION'` and at the end, issue a `outputFile{ PROP:SQL } = 'COMMIT'`.

Yes, trhough the PROP:SQL one can issue ANY command accepted by the server, including a DROP DATABASE, so it is very powerful. Use with care.

Gustavo

# iphone - 让用户在应用程序中调整亮度

> ID：11615078
> 
> 赞同：3
> 
> 时间：2012-07-23T14:56:03.287
> 
> 标签：iphone, ios, xcode, ipad, xcode4

我正在制作一个时钟应用程序，我想知道如何检查当前的亮度级别设置，以及如何使用 UISlider 在 xcode 4 中调整我的应用程序中的亮度，而不是告诉用户去他们的 iphone/ipad设置应用程序并在那里调整亮度？我找不到任何代码/api。

我在 appstore 中看到过不少时钟应用程序，用户可以通过上下移动手指来调整显示屏的亮度。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-23T14:59:46.317

您正在寻找[UIScreen 的亮度属性](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScreen_Class/Reference/UIScreen.html#//apple_ref/occ/instp/UIScreen/brightness)。

示例代码：

```
[UIScreen mainScreen].brightness = 0.5; 
```

在 iOS 5.0 及更高版本中可用。

# database - 每秒写入一次的数据库

> ID：11615080
> 
> 赞同：0
> 
> 时间：2012-07-23T14:56:12.727
> 
> 标签：database, statistics

哪个数据库（SQL/NoSQL）最适合统计网站？每1秒会写大约100-200行，只有数字，比如可以是金融股。{对不起，如果这对该网站来说是个坏问题}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T14:59:52.803

MySQL 将使它坚如磐石，因为您不会丢失任何行。此外，使用 MySQL 编写查询以对这些列执行数学运算非常容易。

假设这些行将永远插入并且永远使集合变得非常大，那么像 MongoDB 这样的 NoSQL 解决方案将能够更好地扩展。MySQL 会占用更多的磁盘空间。

如果您需要原子操作，例如，您不能丢失任何行，那么 MySQL 是您的最佳选择。

# vba - 400 错误 Excel 宏

> ID：11615082
> 
> 赞同：6
> 
> 时间：2012-07-23T14:56:27.280
> 
> 标签：vba, excel

我正在尝试运行一个宏，该宏将删除 B 列中不包含特定值的行。这是我的代码：

```
Sub deleteRows()
    Dim count As Integer
    count = Application.WorksheetFunction.CountA(Range("AF:AF"))
    Dim i As Integer
    i = 21
    Do While i <= count
        If (Application.WorksheetFunction.IsNumber(Application.WorksheetFunction.Search("OSR Platform", Range("B" & i))) = False) Then
            If (Application.WorksheetFunction.IsNumber(Application.WorksheetFunction.Search("IAM", Range("B" & i))) = False) Then
                Rows(i).EntireRow.Delete
                i = i - 1
                count = count - 1
            End If
        End If
        i = i + 1
    Loop
End Sub 
```

现在它应该做的是：

1.）找到要通过的行数并将其设置为计数（这有效）

2.) 从第 21 行开始，在 B 列中查找“OSR 平台”和“IAM”[这种作品（见下文）]

3.）如果没有找到，删除整行并根据需要调整计数和行号（这有效）

出于某种原因，每当代码到达第一个 If 语句时，就会弹出一个带有红色 X 的错误窗口，上面只显示“400”。据我所知，我已经把所有的东西都写在语法上，但显然有问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T15:15:39.653

您可能希望以另一种方式循环开始。当您删除一行时，之前的所有行都会移动。你解释了这一点，但是反向循环比跟踪我何时偏移循环内的当前位置更容易理解（*无论如何对我来说）：*

`For i = count To 21 Step -1`

此外，您过于依赖`Application.WorksheetFunction`：

`(Application.WorksheetFunction.IsNumber(Application.WorksheetFunction.Search("OSR Platform", Range("B" & i))) = False)`

到

`InStr(Range("B" & i).value, "OSR Platform") > 0`

`Application.WorksheetFunction`需要更多的处理能力，并且根据您要完成的工作，这可能需要更长的时间。同样对于这个建议的更改，代码大小会减小，并且在没有它的情况下变得更容易阅读。

您`count`也可以在没有以下情况下获得`A.WF`：

*   Excel 2000/03：`count = Range("AF65536").End(xlUp).Row`
*   Excel 2007/10：`count = Range("AF1048576").End(xlUp).Row`
*   版本无关：`count = Range("AF" & Rows.Count).End(xlUp).Row`

另一件事是您可以做（在这种情况下*应该*`If`做）是将您的陈述合并为一个。

进行这些更改，您最终会得到：

```
Sub deleteRows()
    Dim count As Integer
    count = Range("AF" & Rows.Count).End(xlUp).Row
    Dim i As Integer
    For i = count To 21 Step -1
        If Len(Range("B" & i).value) > 0 Then
            If InStr(Range("B" & i).value, "OSR Platform") > 0 Or InStr(Range("B" & i).value, "IAM") > 0 Then
                Range("B" & i).Interior.Color = RGB(255, 0, 0)
            End If
        End If
    Next i
End Sub 
```

如果这没有帮助，那么您可以逐行遍历代码。添加断点，并使用`F8`. 突出显示代码中的变量，右键单击，选择“添加监视...”，单击“确定”，（[这是一个很好的资源，可以帮助您进行一般调试](http://www.cpearson.com/excel/debug.htm)）并注意以下几点：

*   哪一行出现错误？
*   什么是价值`i`以及`count`何时发生？（添加对这些变量的监视以提供帮助）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T18:16:46.823

这对我有用。它使用自动筛选，不需要循环或工作表功能。

```
Sub DeleteRows()

Dim currentSheet As Excel.Worksheet
Dim rngfilter As Excel.Range
Dim lastrow As Long, lastcolumn As Long

Set currentSheet = ActiveSheet

' get range
lastrow = currentSheet.Cells(Excel.Rows.Count, "AF").End(xlUp).Row
lastcolumn = currentSheet.Cells(1, Excel.Columns.Count).End(xlToLeft).Column
Set rngfilter = currentSheet.Range("A1", currentSheet.Cells(lastrow, lastcolumn))

' filter by column B criteria
rngfilter.AutoFilter Field:=2, Criteria1:="<>*OSR Platform*", Operator:= _
        xlAnd, Criteria2:="<>*IAM*"

' delete any visible row greater than row 21 which does not meet above criteria
rngfilter.Offset(21).SpecialCells(xlCellTypeVisible).EntireRow.Delete

' remove autofilter arrows
currentSheet.AutoFilterMode = False
End Sub 
```

此代码将自动筛选应用于 B 列，以查看 B 列中哪些行既不包含“OSR 平台”也不包含“IAM”。然后它只是删除大于 21 的剩余行。首先在工作簿的副本上对其进行测试。

非常[赞同这个 OzGrid](http://www.ozgrid.com/forum/showthread.php?t=153994)线程，因为我永远记不起过滤后选择可见单元格的正确语法。

# ruby-on-rails - Rails：acts_as_api：已完成 406 不可接受

> ID：11615084
> 
> 赞同：0
> 
> 时间：2012-07-23T14:56:30.837
> 
> 标签：ruby-on-rails

我正在尝试使用acts_as_api。我尝试按照他们的教程进行操作，但我得到了名义上的错误，当我转到相应的网页时，屏幕上什么也没有出现。这是我得到的：

应用程序/控制器/qtls_controller.rb

```
def show_json
  show_id = URI.decode(params[:id])
  show_id = show_id.gsub(/\s*$/,'')
  @qtls = Qtl.find_by_sql("select * from qtls where qtl_name like '%#{show_id}%' or qtl_symbol in (select qtl_symbol from obs_traits where qtl_symbol like '%#{show_id}%' or trait_name like '%#{show_id}%');")
  respond_to do |format|
    format.json { render_for_api :lis_json, :json => @qtls, :root => :qtls }
  end
end 
```

应用程序/模型/qtl.rb

```
 class Qtl < ActiveRecord::Base
   self.primary_key = "qtl_name"
   acts_as_api

   api_accessible :lis_json do |t|
      t.add :qtl_name
      t.add :qtl_symbol
      t.add :qtl_symbol_id
      t.add :qtl_pub_name
      t.add :favorable_allele_source
      t.add :treatment
      t.add :lod
      t.add :marker_r2
      t.add :total_r2
      t.add :additivity
      t.add :map_collection
      t.add :entry_name
      t.add :lg
      t.add :left_end
      t.add :right_end
      t.add :nearest_marker
      t.add :species
      #t.add :trait_name
      t.add :comment
   end
     def species
       'phavu'
     end
     #def trait_name
 #       '' << ObsTrait.find_by_sql("select trait_name from obs_traits where entry_name = '#{entry_name}' and qtl_symbol = '#{qtl_symbol}'")[0].trait_name
  #   end
 end 
```

编辑：

当我在 Rails 控制台中执行此操作时

```
@qtls.as_api_response :lis_json, :root => :qtls 
```

如果这可能是问题，我会得到这个（没有根）idk：

```
 => [{:lod=>#<BigDecimal:8063e1cb0,'0.0',9(18)>, :comment=>"Marker-Interval: L040.75–BMd027", :qtl_symbol=>"Pl ht", :entry_name=>"SRK20120130.4", :left_end=>#<BigDecimal:8063e1a08,'0.2964E2',18(18)>, :marker_r2=>#<BigDecimal:8063e1c38,'0.1952E0',9(18)>, :qtl_symbol_id=>"2-2", :right_end=>#<BigDecimal:8063e1990,'0.4503E2',18(18)>, :total_r2=>#<BigDecimal:8063e1bc0,'0.4812E0',9(18)>, :qtl_pub_name=>"Plh1-2", :nearest_marker=>"X010.85", :additivity=>#<BigDecimal:8063e1b48,'0.19E0',9(18)>, :favorable_allele_source=>"G2333", :species=>"phavu", :map_collection=>"G2333_x_G19839", :treatment=>"Darien high phosphorus", :qtl_name=>"Pl ht 2-2", :lg=>"Pv04"}, {:lod=>#<BigDecimal:8063e1800,'0.0',9(18)>, :comment=>"Marker-Interval: BM189–BMd036", :qtl_symbol=>"Pl ht", :entry_name=>"SRK20120130.4", :left_end=>#<BigDecimal:8063e1558,'0.877E1',18(18)>, :marker_r2=>#<BigDecimal:8063e1788,'0.1399E0',9(18)>, :qtl_symbol_id=>"2-1", :right_end=>#<BigDecimal:8063e14e0,'0.1526E2',18(18)>, :total_r2=>#<BigDecimal:8063e1710,'0.5119E0',9(18)>, :qtl_pub_name=>"Plh1-1", :nearest_marker=>"BM189", :additivity=>#<BigDecimal:8063e1698,'0.14E0',9(18)>, :favorable_allele_source=>"G2333", :species=>"phavu", :map_collection=>"G2333_x_G19839", :treatment=>"Popayan", :qtl_name=>"Pl ht 2-1", :lg=>"Pv03"}, {:lod=>#<BigDecimal:8063e1350,'0.0',9(18)>, :comment=>"Marker-Interval: PV-ctt001–BM161", :qtl_symbol=>"Pl ht", :entry_name=>"SRK20120130.4", :left_end=>#<BigDecimal:8063e10a8,'0.8743E2',18(18)>, :marker_r2=>#<BigDecimal:8063e12d8,'0.1403E0',9(18)>, :qtl_symbol_id=>"2-3", :right_end=>#<BigDecimal:8063e1030,'0.9362E2',18(18)>, :total_r2=>#<BigDecimal:8063e1260,'0.5276E0',9(18)>, :qtl_pub_name=>"Plh1-3", :nearest_marker=>"PV-ctt001", :additivity=>#<BigDecimal:8063e11e8,'0.14E0',9(18)>, :favorable_allele_source=>"G2333", :species=>"phavu", :map_collection=>"G2333_x_G19839", :treatment=>"Popayan", :qtl_name=>"Pl ht 2-3", :lg=>"Pv04"}] 
```

这有效：

```
 render :json => @qtls.as_api_response( :lis_json, :root => 'qtls') 
```

但它不会像在控制台中那样产生根...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T18:10:22.270

服务器似乎不接受您要求的格式。

确保您的请求确定了您想要的响应格式。在 Rails 中是默认设置，您可以将其添加到 url 例如`posts/1.json`或将其添加为 HTTP Accept-Header。

检查您的日志文件以查看操作是如何处理的。它应该这样说：

`Started GET "/qtls/show_json.json" for 127.0.0.1 at 2012-07-23 19:53:11 Processing by QtlsController#show_json as JSON`

但我想在你的情况下，它会说这样的话：

`Processing by QtlsController#show_json as HTML`

如果没有给出响应格式，Rails 默认为 HTML。但是您只允许在渲染块中使用 json 响应。

```
respond_to do |format|
  format.json { render_for_api :lis_json, :json => @qtls, :root => :qtls }
end 
```

这就是 Rails 以 406 响应的原因。它假定客户端需要 HTML（默认格式）但该`respond_to`块只允许 json。

如果只是调用`render :json`它有效，因为您不区分响应格式，您只需强制控制器以 json 响应。

# ruby-on-rails-3 - 或使用轮胎/弹性查询

> ID：11615093
> 
> 赞同：1
> 
> 时间：2012-07-23T14:57:01.523
> 
> 标签：ruby-on-rails-3, elasticsearch, tire

这可能很简单，但我无法解决。我在项目类上有这个轮胎/弹性搜索查询：

```
 def self.search(params)
    tire.search(load: true, page: params[:page], per_page: 8) do
      query do
        boolean do
          must { string params[:query], default_operator: "AND" } if params[:query].present?
          must { term :status, "posted" }
          must { term :budget, params[:budget] } if params[:budget].present?
        end
      end
    end
  end 
```

我需要状态词来搜索“已发布”或“关闭”，但无法解决。我尝试了 term :status, ["posted", "closed"] 但这不会返回结果，因此可能会执行 AND。感谢这里正确的轮胎语法。（注意不是在这里寻找 jason/elasticsearch 字符串）非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-25T10:00:06.570

您需要的是一个[`terms`](http://www.elasticsearch.org/guide/reference/query-dsl/terms-query.html)查询，它执行`OR`作为数组传递的术语之间：

```
must { terms :status, ["posted"] } 
```

或类似的动态值：

```
# params[:status] can be single value or array
must { terms :status, Array(params[:status]) } 
```

有关更多信息和上下文，请参阅[轮胎文档的这一部分。](http://karmi.github.com/tire/#section-70)

# azure - 如何在新的 Azure 门户中添加共同管理员？

> ID：11615102
> 
> 赞同：4
> 
> 时间：2012-07-23T14:57:28.370
> 
> 标签：azure, portal

要添加共同管理员，[Howto](http://msdn.microsoft.com/en-us/library/windowsazure/gg456328)指的是“托管服务、存储帐户和 CDN”视图。但我在新门户中找不到类似的东西。

有谁知道如何在新门户中执行此操作？有没有办法登录旧门户？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2018-01-30T01:01:23.443

“经典”门户 (manage.windowsazure.com) 已停用。现在通过 portal.azure.com 站点管理共同管理员。要管理共同管理员：

1.  从主导航转到订阅
2.  选择您要管理的订阅
3.  转到访问控制 (IAM)
4.  找到您要作为共同管理员添加/删除的用户
5.  点击右侧的省略号
6.  您应该会看到添加/删除共同管理员的选项（以适用者为准）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T15:23:54.450

目前，您需要使用旧门户来管理共同管理员。您可以访问 windows.azure.com 上的旧门户。到达那里并使用您的 Live Id 登录后，选择托管服务类别（左下角），然后选择用户管理子类别（左上角）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-18T16:48:26.247

在 Azure 门户中，您需要转到订阅，选择订阅，然后选择访问控制 (IAM)。添加具有所有者角色的人员，然后单击省略号并选择添加为共同管理员

**重要**您必须先将某人设为所有者，然后才能将其添加为共同管理员 [![在此处输入图像描述](../Images/5238bbcde0b7d5193670a2996eb32541.png)](https://i.stack.imgur.com/Sll18.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T21:23:05.100

如果您想转到旧门户，只需单击底部的“预览”（绿色按钮），然后按“带我到上一个门户”

![太旧的传送门](../Images/0d0613e41bf8190e5f6ad86427a94651.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T14:54:35.287

现在您可以为此使用新的门户，您可以单击左侧导航栏中的“设置”选项，然后选择顶部的“管理员”选项卡。您还可以在此选项中管理证书。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-10-21T20:10:25.093

使用当前门户转到：

1.  Azure 活动目录
2.  角色与管理
3.  从角色列表中单击您要赋予新人的角色
4.  您将在一个页面上，其中有一个按钮**添加成员**单击该按钮以添加人员（该人员必须已作为用户在活动目录中添加/创建）
5.  在字段的右侧输入人名（用于添加她/他的电子邮件），然后单击**选择**（字段下方的按钮。

就这样。

# java - Android：文件 IO 错误

> ID：11615105
> 
> 赞同：6
> 
> 时间：2012-07-23T14:57:36.907
> 
> 标签：java, android, multithreading, file-io, android-asynctask

问题：在 android 4.x 上下载图像时出现奇怪的错误：

```
07-23 10:31:05.961: E/XXX(32294): libcore.io.ErrnoException: open failed: ENOENT (No such file or directory) 
07-23 10:31:05.961: E/XXX(32294):  open failed: ENOENT (No such file or directory) 
```

而有时：

```
07-23 10:31:06.133: W/System.err(32294): java.io.IOException: open failed: ENOENT (No such file or directory)
07-23 10:31:06.133: W/System.err(32294):    at java.io.File.createNewFile(File.java:940)
07-23 10:31:06.133: W/System.err(32294):    at com.XXX.XXX.JSON.Media.save(Media.java:55)
07-23 10:31:06.133: W/System.err(32294):    at com.XXX.XXX.JSON.Media.setFile(Media.java:78)
07-23 10:31:06.133: W/System.err(32294):    at com.XXX.XXX.ServerAccess.AsyncDownloadQueue$QueueMedia.isDone(AsyncDownloadQueue.java:257)
07-23 10:31:06.133: W/System.err(32294):    at com.XXX.XXX.ServerAccess.AsyncDownloadQueue.doInBackground(AsyncDownloadQueue.java:102)
07-23 10:31:06.133: W/System.err(32294):    at com.XXX.XXX.ServerAccess.AsyncDownloadQueue.doInBackground(AsyncDownloadQueue.java:1)
07-23 10:31:06.133: W/System.err(32294):    at com.XXX.Library.Threading.AsyncTask$2.call(AsyncTask.java:189)
07-23 10:31:06.133: W/System.err(32294):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
07-23 10:31:06.133: W/System.err(32294):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
07-23 10:31:06.133: W/System.err(32294):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
07-23 10:31:06.133: W/System.err(32294):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
07-23 10:31:06.133: W/System.err(32294):    at java.lang.Thread.run(Thread.java:856)
07-23 10:31:06.133: W/System.err(32294): Caused by: libcore.io.ErrnoException: open failed: ENOENT (No such file or directory)
07-23 10:31:06.141: W/System.err(32294):    at libcore.io.Posix.open(Native Method)
07-23 10:31:06.141: W/System.err(32294):    at libcore.io.BlockGuardOs.open(BlockGuardOs.java:110)
07-23 10:31:06.141: W/System.err(32294):    at java.io.File.createNewFile(File.java:933)
07-23 10:31:06.141: W/System.err(32294):    ... 11 more 
```

所以奇怪的一点......这适用于android 2.2，它有时适用于4.x上的图像。完全相同的下载例程将下载一个文件，但不会下载其他文件。多线程io访问时有限制吗？每个线程都附加到一个唯一的文件，所以我认为这不是问题；从正在写入的文件中没有读取任何内容。

哦，这不应该是权限问题：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.WRITE_INTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_INTERNAL_STORAGE" />
<uses-permission android:name="android.permission.INTERNET" /> 
```

# sql - PL/pgSQL 函数的 SQL 语句中的语法错误

> ID：11615112
> 
> 赞同：1
> 
> 时间：2012-07-23T14:57:57.940
> 
> 标签：sql, postgresql, stored-procedures, naming-conventions, plpgsql

我在 SO 社区的帮助下编写了一个存储过程。我拼凑/破解了各种问题的答案来编写我的函数。

但是，当我尝试在数据库（PostgreSQL 8.4）中创建我的函数时，我收到以下错误：

```
ERROR:  syntax error at or near "$4"
LINE 1: ...ank() OVER (ORDER BY  $1 ,  $2 ) /  $3 )::int as  $4  , $1 ,...
                                                            ^ 
```

**和**

```
QUERY:   SELECT ceil(rank() OVER (ORDER BY  $1 ,  $2 ) /  $3 )::int as  $4  , $1 ,  $2 ,  $5 ,  $6 ,  $7 ,  $8 ,  $9 ,  $10  FROM foobar WHERE  $2  BETWEEN  $11  AND  $12  AND  $1  = ANY( $13 ) ORDER BY  $1 ,  $2 ,  $4 
CONTEXT:  SQL statement in PL/PgSQL function "custom_group" near line 9 
```

这是我要创建的函数的代码：

```
CREATE OR REPLACE FUNCTION custom_group(start_date DATE, end_date DATE, grouping_period INTEGER, _ids int[] DEFAULT '{}')
RETURNS TABLE (
grp INTEGER,
id INTEGER, 
entry_date DATE,
pop REAL,
hip REAL,
lop REAL,
pcl REAL,
vop BIGINT,
poi BIGINT) AS
$BODY$
BEGIN

IF _ids <> '{}'::int[] THEN -- excludes empty array and NULL
    RETURN QUERY 
                    SELECT ceil(rank() OVER (ORDER BY id, entry_date) / $3)::int as grp
                          ,id, entry_date, pop, hip, lop, pcl, vop, poi
                    FROM   foobar
                    WHERE  entry_date BETWEEN start_date AND end_date AND id = ANY(_ids)
                    ORDER  BY id, entry_date, grp ;

ELSE
    RETURN QUERY 
                    SELECT ceil(rank() OVER (ORDER BY id, entry_date) / $3)::int as grp
                          ,id, entry_date, pop, hip, lop, pcl, vop, poi
                    FROM   foobar
                    WHERE  entry_date BETWEEN start_date AND end_date
                    ORDER  BY id, entry_date, grp ;

END IF;

END;
$BODY$ LANGUAGE plpgsql; 
```

谁能理解我为什么会收到这些错误 - 以及如何修复它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T17:07:30.413

该错误来自**命名冲突**。

该变量`grp`由`RETURNS TABLE`子句隐式定义。在函数体中，您尝试使用与列别名相同的标识符，这会发生冲突。

只需使用不同的名称`grp`- 列别名无论如何都不会在函数外部可见。

并对其他列进行**表限定：**

```
CREATE OR REPLACE FUNCTION custom_group(_start_date DATE
                                       ,_end_date DATE
                                       ,_grouping_period INTEGER, 
                                       ,_ids int[] DEFAULT '{}')
RETURNS TABLE (grp int, id int, entry_date date, pop real, hip real,
               lop real, pcl real, vop bigint, poi bigint) AS
$BODY$
BEGIN

IF _ids <> '{}'::int[] THEN -- excludes empty array and NULL
    RETURN QUERY 
    SELECT ceil(rank() OVER (ORDER BY f.id, f.entry_date) / $3)::int AS _grp
          ,f.id, f.entry_date, f.pop, f.hip, f.lop, f.pcl, f.vop, f.poi
    FROM   foobar f
    WHERE  f.entry_date BETWEEN _start_date AND _end_date AND id = ANY(_ids)
    ORDER  BY f.id, f.entry_date, _grp;

ELSE
    RETURN QUERY 
    SELECT ceil(rank() OVER (ORDER BY f.id, f.entry_date) / $3)::int -- no alias
          ,f.id, f.entry_date, f.pop, f.hip, f.lop, f.pcl, f.vop, f.poi
    FROM   foobar f
    WHERE  f.entry_date BETWEEN _start_date AND _end_date
    ORDER  BY f.id, f.entry_date, 1; -- ordinal pos. instead of col alias
END IF;

END;
$BODY$ LANGUAGE plpgsql; 
```

`IN`我给参数加上前缀的原因`_`是一样的：避免这样的命名冲突。

在这种情况下，您甚至根本不必为计算列使用别名。`ORDER BY`您可以使用我在第二个查询中演示的顺序位置。[我在这里](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-ORDERBY)引用手册：

> 每个表达式可以是输出列（SELECT 列表项）的名称或序号，也可以是由输入列值形成的任意表达式。

# visual-studio - VS2008 调试器不显示地图数据

> ID：11615113
> 
> 赞同：0
> 
> 时间：2012-07-23T14:57:59.380
> 
> 标签：visual-studio, debugging, visual-studio-2008

我有一个包含使用地图的各种数据类型的类。该类在调试和发布模式下正常运行。但是，当我尝试调试我的程序时，调试器无法确定类内的多个映射中的内容。通常，我会怀疑来自其他地方的内存损坏，但是在运行程序时没有内存错误，并且值被设置和检索而不会发生意外。

这是调试器错误的示例。地图中的元素数量报告正确，但值是错误的。有趣的是，当我打破包含地图的类的成员函数时，不会发生此错误并且所有值都是可见的。此外，奇怪的是，字符串映射显示没有问题。

我在 Windows 7（64 位）上使用 Visual Studio 2008（SP1）。类代码实际上是在我正在调试的客户端程序启动时加载的 DLL 中，如果这有所不同的话。任何想法表示赞赏。 ![在此处输入图像描述](../Images/fd2cf2428f9e5ffc0cb0191c404e6961.png)

```
class DataTable {
public:
    std::string get_string(std::string);
    float get_float(std::string);
            (etc.)

    void set_string(std::string, std::string);
    void set_float(std::string, float);
            (etc.)

protected:
    std::map<std::string, std::string> m_string_map;
    std::map<std::string, float> m_float_map;
            (etc.)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T13:46:42.700

当我使用 std::map 时，我正在为调试目的做一个解决方法：

```
#ifdef _DEBUG
uint32_t num_strings_in_map = (uint32_t)m_string_map.size();
uint32_t num_floats_in_map = (uint32_t)m_float_map.size();
#endif 
```

然后我可以设置断点，或者将数字输出到屏幕......

# crash - 重新显示模态视图模型时，MvvmCross 应用程序冻结并崩溃

> ID：11615114
> 
> 赞同：0
> 
> 时间：2012-07-23T14:58:05.167
> 
> 标签：crash, xamarin.ios, modal-dialog, mvvmcross

我正在开发的应用程序由数据层次结构和用于搜索该数据的过滤器组成。数据显示在表格视图的层次结构中，并且通过该层次结构进行导航可以正常工作。但是，当我尝试导航到我的过滤视图模型（显示为模态视图控制器）时，我遇到了问题。

我第一次打开模式视图时，一切正常，我可以关闭它，所有导航仍然有效。但是，当我再次尝试打开它时，会出现模态视图，并且应用程序将在几秒钟后冻结并崩溃。

这是处理模态导航请求的自定义演示器（它是 MvxModalSupportTouchViewPresenter 的子类）的代码：

```
public override void Show (IMvxTouchView view)
{
    if (view is IMvxModalTouchView) {
    var newNav = new UINavigationController ();
    newNav.PushViewController (view as UIViewController, false);
    newNav.NavigationBar.TintColor = UIColor.Black;
    PresentModalViewController (newNav, true);
    return;
... 
```

（取自[MvvmCross Using a modal ViewController from a Tab](https://stackoverflow.com/questions/11037119/mvvmcross-using-a-modal-viewcontroller-from-a-tab)）

我通过在视图本身中将其关闭来关闭模式。有谁知道为什么应用程序崩溃了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T11:08:37.053

通过电子邮件跟进此事是...

> “至于我之前的问题，我发现了错误在哪里。与我的模态视图模型相关联的视图进入了 Dispose() 调用的无限循环。只有在模态显示多次时才会发生这种情况。注释掉 Dispose( ) 方法允许我多次打开它。”

目前不确定这是否是 mvx 框架或应用程序代码中的错误 - 但我想我会在这里发布它以防它帮助其他人

# android - Listview 有或没有 convertview == null

> ID：11615116
> 
> 赞同：2
> 
> 时间：2012-07-23T14:58:11.257
> 
> 标签：android, performance, listview, convertview

我有一个两难使用

```
if (convertview==null){
(my code)
} 
```

或不。如果没有这段代码，我的列表视图不是很快，它有时会锁定几毫秒，你可以很容易地注意到这一点在使用中。它只是无法正常工作。

但是当这段代码时，我的列表项将在一段时间后开始重新计算（大约 10 个），并且我的列表中有一些返回的列表项（我使用了标题）。我使用本教程获取带有部分[链接](http://bartinger.at/listview-with-sectionsseparators/)的列表视图。列表的长度很好。

当然，我的列表对于重复项目（顺便说一句很好地划分）是完全没用的，但我也不希望它变慢。有谁知道该怎么做？下面是我的适配器：

公共类 DelftAdapter 扩展 BaseAdapter {

```
private Activity activity;
private  List<ListItem> listItems;
private static LayoutInflater inflater=null;
public ImageLoader imageLoader; 
private final int[] bgColors = new int[] { R.color.list_odd, R.color.list_even };

public DelftAdapter(Activity a, ArrayList<ListItem> li) {
    activity = a;
    listItems = li;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader=new ImageLoader(activity.getApplicationContext());

}

public int getCount() {
    return listItems.size();
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View vi=convertView;

        final ListItem li = listItems.get(position); 
        if (li != null) {
            if(li.isSection()){ // is sectionheader
                SectionItem si = (SectionItem)li; 
                vi = inflater.inflate(R.layout.sectionedlistitem, null);
                vi.setOnClickListener(null);
                vi.setOnLongClickListener(null);
                vi.setLongClickable(false);
                final TextView sectionView = (TextView) vi.findViewById(R.id.list_header_title);
                sectionView.setText(si.getTitle());
            }else{ // no sectionheader
                ListData ld = (ListData)li;
            vi = inflater.inflate(R.layout.singlelistitem, null);
        TextView tvNames=(TextView)vi.findViewById(R.id.tvname); 
        TextView tvTip=(TextView)vi.findViewById(R.id.tvtip);
        ImageView image=(ImageView)vi.findViewById(R.id.image);
        tvNames.setText(ld.name);
        tvTip.setText(ld.tip);
            if (listItems.get(position) != null ){
                imageLoader.DisplayImage(ld.photoUrl, image);
                }
                else{
                image.setImageURI(Uri.fromFile(new File("//assets/eten.png")));
            }
        // alternating colors
        int colorPos = position % bgColors.length;
             vi.setBackgroundResource(bgColors[colorPos]);
            }
    }
        return vi;

}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:06:37.280

考虑将[getItemViewType()](http://developer.android.com/reference/android/widget/Adapter.html#getItemViewType%28int%29)和[getViewTypeCount()](http://developer.android.com/reference/android/widget/Adapter.html#getViewTypeCount%28%29)与回收一起使用`convertView`。当您有具有各种布局的列表项时使用这些。你绝对应该回收`convertView`。

另见[http://android.amberfog.com/?p=296](http://android.amberfog.com/?p=296)

在你的情况下：

```
 private static final int TYPE_ITEM = 0;
    private static final int TYPE_SECTION = 1;

    @Override
    public int getItemViewType(int position) {
        return listItems.get(position).isSection() ? TYPE_SECTION : TYPE_ITEM
    }

    @Override
    public int getViewTypeCount() {
        return 2;  // sectionheader and regular item
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        int type = getItemViewType(position);
        if (convertView == null) {
            switch (type) {
                case TYPE_ITEM:
                    convertView = mInflater.inflate(R.layout.singlelistitem, null);
                    ...
                    break;
                case TYPE_SECTION:
                    convertView = mInflater.inflate(R.layout.sectionedlistitem, null);
                    ...
                    break;
            }
        } else {
            ...
        }
        return convertView;
    } 
```

也使用[ViewHolder](https://stackoverflow.com/q/3832254/1300995)模式来获得更好的性能。

# google-analytics - 文件下载的 Google Analtyics 事件跟踪不起作用

> ID：11615123
> 
> 赞同：1
> 
> 时间：2012-07-23T14:58:35.737
> 
> 标签：google-analytics

我正在尝试为 Google Analytics 中的文件下载设置事件跟踪。经过一番研究，我将以下代码添加到需要跟踪的链接中：

```
<a onclick="_gaq.push(['_trackEvent','Download','PDF',this.href]);" href="http://www.link.com/file.pdf" target="_blank">Link Text</a> 
```

以下代码位于 Google Analytics 页面上：

```
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-9999999-1");
pageTracker._trackPageview();
} catch(err) {}
</script> 
```

这已经活跃了超过 48 小时，但我没有在 GA 中收到事件。它说“您的 13 次访问发送了事件”，但没有显示其他信息。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:11:08.490

看起来您正在为 Google Analytics 混合两种不同的 API。

您发布的第一个片段用于 ASYNC 跟踪，但您在第二个片段中使用了（现在是传统的）传统跟踪。

要使其正常工作，请将您的页面跟踪代码更改为如下所示，其他代码看起来还可以。

```
<script type="text/javascript">
   var _gaq = _gaq || [];
   _gaq.push(['_setAccount', 'UA-XXXXX-X']);
   _gaq.push(['_trackPageview']);

   (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async =    true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +  '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script> 
```

更多详细信息： [https ://developers.google.com/analytics/devguides/collection/gajs/asyncTracking](https://developers.google.com/analytics/devguides/collection/gajs/asyncTracking)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T09:33:43.193

如果您要迁移到异步跟踪，以下链接可以指导您 - [https://developers.google.com/analytics/devguides/collection/gajs/asyncMigrationExamples](https://developers.google.com/analytics/devguides/collection/gajs/asyncMigrationExamples)

# caching - CDN 与本地缓存

> ID：11615125
> 
> 赞同：4
> 
> 时间：2012-07-23T14:58:46.390
> 
> 标签：caching, memcached, ehcache, cdn, akamai

我对 CDN（如 Akamai 或 Limelight）的理解是它们是重型缓存服务。

我也明白它们非常昂贵。所以我想知道为什么我不能只创建自己的复制缓存服务器集群（例如，使用 EhCache 或 Memcached）来满足我所有 Web 应用程序的缓存需求（图像、URL 命中/响应、Javascript 等）并且基本上得到一样的东西？

从本质上讲，从开发人员的角度来看，支付 CDN 与仅使用自己的缓存解决方案相比有哪些好处（技术或其他方面）？或者，如果我完全误解了 CDN 是什么，请纠正我的理解！提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-23T15:04:36.293

关键是CDN中的**N**`Content Delivery Network`，.

CDN 的优势（至少是一个好的）是它的*地理分布*。大型 CDN 提供商（您和其他人一起提到的那些）所做的是在世界各地的设施中拥有数百或数千台服务器。这使得 CDN 所服务的任何资源在地理上都尽可能靠近最终用户，无论他们在世界的哪个地方。

您当然可以复制该功能。在一个非常基本的层面上，大多数 CDN 只是一个对象/价值存储，大量软件可以做 - 你不能做的事情，在这些人无论如何做的规模上，就是在世界各地拥有服务器来服务和复制这些对象。

如果您感兴趣的只是一种存储和提供静态文件的有效方式，那么对象存储加上 nginx 之类的东西就可以了。CDN 用于使网站尽可能快地加载，但它们是有代价的。

根据记录，亚马逊的 Cloud Front 虽然不像 Limelight 或 Akamai 那样分布广泛，但要便宜得多，并且是成本与服务之间的良好折衷方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T15:06:24.500

大型 CDN 的优势在于它们拥有遍布全球的分布式资源，允许它们从附近的服务器为用户提供服务。除了缓存之外，这是使它们快速的主要点。

要构建自己的 CDN，您必须在多个大陆上安装服务器，为它们安排良好的 Internet 连接，设置缓存并确保所有服务器都同步。这样做并非不可能，但这将非常耗费成本，并且可能无法盈利。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-23T00:49:24.207

恕我直言，我不同意迄今为止对该问题的其他两个答案。为了清楚起见，我并不是说他们错了，我只是提供不同的观点。

正如 Bulk 雄辩地解释的那样，CDN 性能的关键当然是“N”，但这并不意味着您不能构建自己的 CDN。问题是它是否值得花时间（根据定义，钱）。

我们生活在一个廉价服务器甚至更便宜的虚拟机的世界中。当然，大型 CDN 网络在全球拥有数千/数百万台服务器，但那是因为它们有数千/数百万个站点要服务。根据您的站点/应用程序的大小，您真正需要的资源与您的站点所需的资源一样多。如果你很小，最低限度可能是美国每个海岸的 VPS，欧洲一个，亚洲可能两个，澳大利亚一个。当然，硬件成本对于您的典型主页来说太高了，但它们肯定不是极端的，如果您首先考虑 CDN，它们可能在您的预算范围内。

对我来说，商业 CDN 服务只是为 PaaS 提供了便利，但没有什么能阻止您获得 IaaS 并建立自己的平台。

* * *

关于这个主题的另一件事：

我曾经读过 David Heinemeier Hansson（Ruby on Rails 的创建者）或引用他的人的评论，其内容大致如下： 37 Signals 的所有者担心 DHH 正在使用 Ruby 构建他们的应用程序. 那时，Ruby 还是很模糊的。几乎所有的 Web 主机都提供 PHP、Perl 和 Microsoft 技术。当被问及世界上只有少数 Ruby 主机这一事实时，DHH 问道：“那么你需要多少？”

对我来说，重点是你需要看看最适合你的需求和应用程序的需求，而不一定是拥有数百万服务器的人的想法。

# java - java.security.InvalidKeyException：错误的算法：需要 AES 或 Rijndael 错误

> ID：11615132
> 
> 赞同：2
> 
> 时间：2012-07-23T14:59:08.877
> 
> 标签：java, tomcat, aes

我在 Java/Tomcat 应用程序中收到以下错误。

尝试更改 java JRM 和 JDK 中的安全策略文件，仍然一样...

Tomcat 控制台输出：

```
java.security.InvalidKeyException: Wrong algorithm: AES or Rijndael required
    at com.sun.crypto.provider.SunJCE_c.a(DashoA13*..)
    at com.sun.crypto.provider.SunJCE_g.a(DashoA13*..)
    at com.sun.crypto.provider.SunJCE_f.a(DashoA13*..)
    at com.sun.crypto.provider.SunJCE_f.a(DashoA13*..)
    at com.sun.crypto.provider.AESCipher.engineInit(DashoA13*..)
    at javax.crypto.Cipher.a(DashoA13*..)
    at javax.crypto.Cipher.a(DashoA13*..)
    at javax.crypto.Cipher.init(DashoA13*..)
    at javax.crypto.Cipher.init(DashoA13*..)
    at com.illuminati.safemail.util.Util.encryptPrivateKey(Util.java:115)
    at com.illuminati.safemail.service.DefaultBusinessServiceImpl.send(DefaultBusinessServiceImpl.java:122)
    at com.illuminati.safemail.web.Controller.performAction(Controller.java:83)
    at com.illuminati.safemail.web.Controller.doPost(Controller.java:53)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662) 
```

错误源于此函数：

```
public static synchronized byte[] encryptPrivateKey(
        ElGamalPrivateKey privateKey, byte[] hashedAnsBytes)
        throws NoSuchAlgorithmException, NoSuchPaddingException,
        InvalidKeyException, IllegalBlockSizeException,
        BadPaddingException, NoSuchProviderException, IOException {
    Cipher c = Cipher.getInstance("AES");
    SecretKeySpec key = new SecretKeySpec(hashedAnsBytes, "SHA256");
    c.init(Cipher.ENCRYPT_MODE, key);

    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutput out = new ObjectOutputStream(bos);
    out.writeObject(privateKey);
    out.close();
    bos.close();
    byte[] pvtKeyBytes = c.doFinal(bos.toByteArray());
    return pvtKeyBytes;
} 
```

有什么建议么？有趣的是，这段代码在 CentOS 机器上运行良好……这个有 Ubuntu。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T22:18:34.217

您将需要无限强度的加密货币。请注意，我只修复了许多编程错误，实际执行了散列，实际将生成的密文写入流，并使用随机 IV 的 CBC 模式。

```
public static synchronized byte[] encryptPrivateKey(
        ElGamalPrivateKey privateKey, byte[] hashedAnsBytes)
        throws GeneralSecurityException, IOException {
    Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
    MessageDigest digest = MessageDigest.getInstance("SHA256");
    final byte[] reallyHashed = digest.digest(hashedAnsBytes);
    System.out.println(reallyHashed.length);
    SecretKeySpec key = new SecretKeySpec(reallyHashed, "AES");
    SecureRandom rnd = SecureRandom.getInstance("SHA1PRNG");
    final byte[] iv = new byte[c.getBlockSize()];
    rnd.nextBytes(iv);
    IvParameterSpec spec = new IvParameterSpec(iv);
    c.init(Cipher.ENCRYPT_MODE, key, spec);

    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutput out = new ObjectOutputStream(bos);
    out.write(iv);
    out.write(c.doFinal(privateKey.getEncoded()));
    out.close();
    bos.close();
    byte[] pvtKeyBytes = c.doFinal(bos.toByteArray());
    return pvtKeyBytes;
} 
```

# sql - SQL 查询 - 检索文本字段中的值所需的帮助

> ID：11615136
> 
> 赞同：0
> 
> 时间：2012-07-23T14:59:22.460
> 
> 标签：sql, sql-server-2008

我有一个如下所示的表：

```
NAME(varchar(6),  STRING(varchar(250)

ABCD   '1     2     1    173  1      8  9   1     1     2     4    7      1   3.....'
APLC   '1  3 11       34        1  4   99          33     23        111       12   6 7 8....' 
```

字符串继续，最多 250 个字符。

我想要做的是从这个字符串中获取值和相应的位置。

我知道我可以使用`Charindex`，但这只给了我字符串中数字的第一个位置。

例如

```
Select Charindex ('2',STRING) where Name = ABCD 
```

答案 = 7

但是我正在寻找的是一个表格，每个名称都有以下内容

```
Name  Position   Value 
---------------------------    
ABCD,   7,         2
ABCD,   1,         1
ABCD,   13,        1
ABCD,   18,        1
ABCD,   19,        7 
```

欢迎任何想法:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:40:00.300

在数字表的帮助下，它可能看起来像这样。

```
select T.Name,
       N.N as Position,
       substring(T.STRING, N.N, 1) as Value
from YourTable as T
  cross apply Numbers as N
where N.N between 1 and 250 and
      substring(T.STRING, N.N, 1) <> ' ' 
```

带有表变量和`master..spt_values`数字表的工作示例。

```
declare @T table
(
  NAME varchar(6),
  STRING varchar(250)
)

insert into @T values
('ABCD', '1     2     1    173  1      8  9   1     1     2     4    7      1   3'),
('APLC', '1  3 11       34        1  4   99          33     23        111       12   6 7 8')

;with Numbers(N) as
(
  select Number 
  from master..spt_values
  where type = 'P'
)
select T.Name,
       N.N as Position,
       substring(T.STRING, N.N, 1) as Value
from @T as T
  cross apply Numbers as N
where N.N between 1 and 250 and
      substring(T.STRING, N.N, 1) <> ' ' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:44:55.393

This approach would work for multi-digit numbers. If `173` should result in three result rows, check Mikael Eriksson's or podiluska's answer.

```
; with   cte as
         ( 
         select  1 as start
         ,       case 
                 when patindex('%[0-9] %', string) > 0 then patindex('%[0-9] %', string)
                 else len(string)
                 end as [length]
         ,       name
         ,       string
         from    YourTable
         union all
         select  start + [length] as start
         ,       case 
                 when patindex('%[0-9] %', 
                     substring(string, start + [length], len(string)-start + [length])) 
                     > 0 then patindex('%[0-9] %', 
                     substring(string, start + [length], len(string)-start + [length])) 
                 else len(string)-start + [length]
                 end as [length]
         ,       name
         ,       string
         from    cte
         where   start + [length] < len(string)
         )
select  Name 
,       start + patindex('%[0-9]%', substring(string, [start], [length])) - 1 as Position
,       ltrim(substring(string, [start], [length])) as Value
from     cte 
```

[Live example at SQL Fiddle.](http://sqlfiddle.com/#!3/cd453/8/0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:28:12.527

#t 你的桌子在哪里...

```
;WITH numbers ( n ) AS 
(
     select 1 as n
     union all
     select 1 + n FROM numbers WHERE n < 250 
)
select name, n as position, SUBSTRING(string,n,1) as value
from #t, numbers
where SUBSTRING(string,n,1)<>' '
order by Name, n
option (maxrecursion 250) 
```

另一方面，如果您想将连续数字视为一个数字......

```
;WITH Pieces(name, pn, start, [stop], string) AS 
(
   SELECT name, 1, 1, CHARINDEX(' ', string),string from #t
   UNION ALL
   SELECT pieces.name, pn + 1, stop + 1, CHARINDEX(' ', pieces.string, stop + 1), pieces.string
   FROM Pieces
    inner join #t on pieces.name = #t.name
   WHERE stop > 0
)
select * 
from
(    SELECT name, start as position,
           SUBSTRING(string, start, CASE WHEN stop > 0 THEN stop-start ELSE 300 END) AS value
           FROM Pieces
) v
where RTRIM(value)>'' 
```

# css - 两种类型的jquery ui引用得到不同的结果

> ID：11615137
> 
> 赞同：0
> 
> 时间：2012-07-23T14:59:26.607
> 
> 标签：css, jquery-ui, reference

如果我将 jquery ui 引用添加为

```
<script src="/_Docs/_Altyapi/JqueryUi/jquery-ui.1.8.21.min.js" type="text/javascript"></script> 
```

然后 tagit 编辑器工作正常（就在标签编辑器输入下），例如：

![在此处输入图像描述](../Images/2deef5ac8e1dda087c562bdc007f3991.png)

但是，如果我使用像

```
<script src="/_Docs/_Altyapi/JqueryUi/ui/jquery.ui.core.min.js" type="text/javascript"></script>
<script src="/_Docs/_Altyapi/JqueryUi/ui/jquery.ui.widget.min.js" type="text/javascript"></script>
<script src="/_Docs/_Altyapi/JqueryUi/ui/jquery.ui.autocomplete.min.js" type="text/javascript"></script> 
```

然后，它不起作用（如照片2所示，自定义自动完成位于页面顶部），例如：

![在此处输入图像描述](../Images/7a9762dbff52c1fc27d9bcb26afd489a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T20:10:07.923

还包括**位置**JS 文件以使自动完成功能正常工作。大概：

```
<script src="/_Docs/_Altyapi/JqueryUi/ui/jquery.ui.position.min.js" type="text/javascript"></script> 
```

为了将来参考，您可以随时转到**概览**下的[小部件文档页面](http://jqueryui.com/demos/autocomplete/)，您将看到小部件的依赖项。

# java - 访问 DefaultListModel 的索引时出现空指针异常

> ID：11615139
> 
> 赞同：0
> 
> 时间：2012-07-23T14:59:28.300
> 
> 标签：java, nullpointerexception, defaultlistmodel

我有一个清单：

```
JList characterList = new JList(characterListModel);
characterListModel = new DefaultListModel();        
String myCharacters[]={"Dean Winchester","Sam Winchester",
            "Bobby Singer","Castiel"};
for (String myCharacter : myCharacters) {
        ((DefaultListModel) characterList.getModel()).addElement(myCharacter);  
} 
```

而且我*在单独的类中*编写了一个方法来删除选定索引处的字符：

```
public void removeCharacter() {
    DefaultListModel characterListModel = ((PlayerContentPane) IViewManager.Util.getInstance()
        .getMyContainerPane().getMyPlayerManagerPane().getContentPane())
        .getCharacterListModel();
    JList characterList = ((PlayerContentPane) IViewManager.Util.getInstance()
        .getMyContainerPane().getMyPlayerManagerPane().getContentPane())
        .getCharacterList();
    int idx = characterList.getSelectedIndex(); //<---line 62
    int size = characterListModel.getSize();
    characterListModel.remove(idx);
    if (size == 0) { 
        //do nothing
    } else { 
        if (idx == characterListModel.getSize()) {
            idx--;
        }

        characterList.setSelectedIndex(idx);
        characterList.ensureIndexIsVisible(idx);
    }

} 
```

然而，当我用我的按钮运行它时，我得到了这个堆栈跟踪：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at com.detica.LarpDB.Controller.Controller.removeCharacter(Controller.java:62)
at com.detica.LarpDB.view.PlayerContentPane$3.actionPerformed(PlayerContentPane.java:94)
at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
at java.awt.Component.processMouseEvent(Unknown Source)
at javax.swing.JComponent.processMouseEvent(Unknown Source)
at java.awt.Component.processEvent(Unknown Source)
at java.awt.Container.processEvent(Unknown Source)
at java.awt.Component.dispatchEventImpl(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Window.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$1.run(Unknown Source)
at java.awt.EventQueue$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue$2.run(Unknown Source)
at java.awt.EventQueue$2.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

我在谷歌上看到的很多问题都源于以下一行：`DefaultListModel characterListModel = ....` 他们遇到的问题是他们创建了一个`new`对象的实例，现在我只是对整个 Java 事物的新手，但这不应该对我来说是个问题，因为我没有做出任何新的东西，我只是具体说明了这是哪个对象。

请问有人可以帮我解开自己吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:02:46.670

这两行可能会产生很多问题：

```
DefaultListModel characterListModel = ((PlayerContentPane) IViewManager.Util.getInstance()
    .getMyContainerPane().getMyPlayerManagerPane().getContentPane())
    .getCharacterListModel();
JList characterList = ((PlayerContentPane) IViewManager.Util.getInstance()
    .getMyContainerPane().getMyPlayerManagerPane().getContentPane())
    .getCharacterList(); 
```

如果任何链接方法返回`null`（无论出于何种原因），该行将抛出 NullPointerException。

我建议你将它们分成几行并检查每个调用的值，看看你从哪里得到的`null`。

**编辑**

刚刚意识到第 62 行是`int idx = characterList.getSelectedIndex();`. 这意味着它`characterList`是空的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:08:55.447

如果它在您指示的行失败是第 62 行，那么该行上引用的唯一对象，因此唯一可能为 null 的对象是 characterList。这意味着您的 getCharacterList 函数返回 null。（如果错误在 getSelectedIndex 函数内，那么您的堆栈跟踪中将有另一行。）

由于您没有发布 getCharacterList 函数，所以我不能多说。但是你应该看看那个函数，看看在什么情况下它会返回 null。

# matlab - 从非零值开始matlab for循环

> ID：11615140
> 
> 赞同：2
> 
> 时间：2012-07-23T14:59:28.570
> 
> 标签：matlab, for-loop, brute-force

我有下面的代码，我试图从非零数开始“number_panels”和“number_turbines”for循环。

更具体地说，我正在尝试 3000 到 4000 个“number_panels”，500 个面板间隔和 5 到 8 个“number_turbines”，一个涡轮机间隔，即

```
number_of_days = 2;

for number_panels = 3000:500:4000 % range of PV panel units examined

for number_turbines = 5:8  % range of wind turbine units examined

    for h=1:24 %# hours

       for d = 1:number_of_days %# which day

            n = h + 24*(d-1);
            % hourly_deficit_1(...,..., h, d)= Demand(n)-(PV_supply(n)... %

            hourly_deficit(number_panels + 1, number_turbines + 1, h,d) = hourly_annual_demand(n) - (hourly_annual_PV(n)*number_panels) - (hourly_annual_WT(n)*number_turbines);% hourly power deficit (RES supply with demand)

            if hourly_deficit(number_panels + 1, number_turbines + 1, h,d)< 0 % zero out negative hourly deficit values (this is power surplus from RES)

                hourly_deficit(number_panels + 1, number_turbines + 1, h,d) = 0;

            end 
```

当我这样做时，我得到一个 size(hourly_deficit) = 4001,9,24,2 而我期待并试图达到 3,4,24,2 的大小。有谁知道我哪里出错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:07:17.780

变量的值`number_panels`从 3000 开始，而不是 0 或 1。因此，当您使用该变量作为索引值对矩阵进行索引时，Matlab 认为您需要第 3001 个索引，从而为您提供一个包含 3000 个零且第 3001 个被设置的矩阵你问什么。

如果您按照循环进入下一个循环，则值`number_panels`变为 3500。您现在根据您的代码在 3501 处建立索引。这意味着从 3002 到 3500 的所有位置都将用零填充，并且 3501 将设置为您给它的任何值。

相同的逻辑适用于`number_turbines` 唯一的区别是您将索引 1 而不是 500 就像您使用`number_panels`.

如果你想回到你期望的大小矩阵，你需要修改你调用索引值的方式。这可以通过多种方式完成。您可以在 for 循环中有一个计数器，也可以使用模数数学。当您使用的步长不是`1`. 当您的索引值是起始索引的倍数时，它也不起作用。

您必须找出在该领域最适合您的方法。特别是因为您想使用不是 1 的步长。但是对于`number_turbines`从 5 到 8 的步长，您可以使用`number_turbines - 5 + 1`或更简洁的索引进行简单索引`number_turbines-4`。

为清楚起见，这里是您提供的代码，并进行了必要的调整，以显示评论中提到的内容的使用。请注意，如果您从 以外的其他内容开始，则需要修改`-4`索引`number_turbines`值`5`。另请注意，您现在需要索引`number_panels`向量，因为它不是循环值。

希望这可以帮助！

```
number_of_days = 2;
number_panels = 3000:500:4000;

for idx_number_panels = 1:length(number_panels) % range of PV panel units examined

    for number_turbines = 5:8  % range of wind turbine units examined

        for h=1:24 %# hours

            for d = 1:number_of_days %# which day

                n = h + 24*(d-1);
                % hourly_deficit_1(...,..., h, d)= Demand(n)-(PV_supply(n)... %

                hourly_deficit(idx_number_panels , number_turbines -4, h,d) = hourly_annual_demand(n) - (hourly_annual_PV(n)*number_panels(idx_number_panels)) - (hourly_annual_WT(n)*number_turbines);% hourly power deficit (RES supply with demand)

                if hourly_deficit(idx_number_panels, number_turbines -4, h,d)< 0 % zero out negative hourly deficit values (this is power surplus from RES)

                    hourly_deficit(idx_number_panels, number_turbines -4, h,d) = 0;

                end
            end
        end
    end
end 
```

# ubuntu - monodevelop ubuntu c# appindicator

> ID：11615145
> 
> 赞同：3
> 
> 时间：2012-07-23T14:59:54.367
> 
> 标签：ubuntu, monodevelop, appindicator

我刚刚开始使用 Mono-GTK 应用程序开发。我想在系统托盘中设置一个 appindicator 图标。但是缺少 C# 返回的命名空间。

代码：使用 AppIndicator；

返回错误：找不到命名空间名称“AppIndicator”的类型。您是否缺少指令或程序集引用？

该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T16:12:05.363

您需要执行以下操作：

1.  `sudo apt-get install libappindicator0.1-cil-dev`

2.  然后添加对库的引用（见下图）

3.  最后，包括对您需要的命名空间的引用。通常这些将是以下内容：

    `using AppIndicator;`

    `using Gtk;`

    `using System;`

![编辑参考](../Images/f1e270fa73fcf4cf31292078d67a7724.png).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T02:40:39.550

安装依赖项：

```
sudo apt-get install libappindicator0.1-cil-dev 
```

然后编译

```
dmcs -pkg:gtk-sharp-2.0,appindicator-sharp-0.1 file.cs 
```

# android - 创建的文件物理存储在android中的哪个位置？

> ID：11615153
> 
> 赞同：3
> 
> 时间：2012-07-23T15:00:25.330
> 
> 标签：android, file, directory, storage

我正在使用以下代码创建文件

```
 OutputStreamWriter out = new OutputStreamWriter(openFileOutput("try.txt",0));
      // write the contents on mySettings to the file
      out.write("erterter");
      // close the file
      out.close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:02:35.920

以这种方式创建的文件存储在应用程序的私有存储中：`/data/data/com.package/files`

# .net - IDisposable 和异步处理 (SmtpClient.SendAsync)

> ID：11615154
> 
> 赞同：0
> 
> 时间：2012-07-23T15:00:32.137
> 
> 标签：.net, asynchronous, smtpclient

查看[SmtpClient](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient)的 MSDN 文档，我注意到示例代码如下所示：

```
client.SendAsync(message, userState);
// More stuff
message.Dispose(); 
```

对 SendAsync 的调用可能需要很长时间才能完成。*如果消息被放置在**SendAsync*调用之后的行上，它是如何保持有用状态的？

此外，*SmtpClient*实现*了 IDisposable*。MSDN 示例应该形成更多的属性，例如

```
using (SmtpClient client = new SmtpClient())
{
    // Initialize client and create the message
    using (MailMessage message = new MailMessage(from, to))
    {
        client.SendAsync(message, userState);
        // More stuff
    }
} 
```

因此，当*client.SendAsync()*可能仍在执行时，不仅会调用*message.Dispose() ，而且还会调用**client.Dispose()*。

 **如果在调用*SendAsync()*之后几乎立即调用*Dispose() ，**客户端*如何保持在完成*SendAsync()*的有用状态？

 **或者，MSDN 示例是错误的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:10:37.710

您应该仅在异步发送操作完成或取消后处理它。所以在 SendCompleted 事件处理程序中处理它

查看 MSDN 中的示例：

[http://msdn.microsoft.com/en-us/library/x5x13z6h.aspx](http://msdn.microsoft.com/en-us/library/x5x13z6h.aspx)

或者这篇博文

[http://leedumond.com/blog/new-in-net-4-dont-forget-to-dispose-your-smtpclient-instances/](http://leedumond.com/blog/new-in-net-4-dont-forget-to-dispose-your-smtpclient-instances/)

MSDN 上的示例很糟糕。而且您不是第一个遇到此问题的人，请查看那里的评论：

> 不好的例子
> 
> 在列出了 Dispose() 你的 SmtpClient 的重要原因之后，这个例子没有这样做。此外，可能在 SendAync 完成之前在 MailMessage 上调用 Dispose()，我很确定这对我造成了异常。但是，您可以在 SendComplete 事件处理程序中处理 MailMessage。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:22:47.043

这是我将如何使用等待事件的方法：

```
 // Initialize client and create the message
        using (var emailWait = new AutoResetEvent(false))
        using (var client = new SmtpClient())
        using (var message = new MailMessage(from, to))
        {
            client.SendCompleted += (sender, e) => emailWait.Set();
            client.SendAsync(message, userState);
            // More stuff
            emailWait.WaitOne();
        } 
```****

# multithreading - How to interrupt an I/O call in a perl thread?

> ID：11615161
> 
> 赞同：3
> 
> 时间：2012-07-23T15:00:53.540
> 
> 标签：multithreading, perl, io

Looks like times of old good alarm() call are over, so how to interrupt blocking read()'s and write()'s made from perl thread (using that brand new 'threads' module) assuming the code making those blocking calls cannot be changed? Actual problem is stucking communication with Modbus device so I've created a simple testcase not to dip you into RS-485 hell:

```
use threads;
use IO::Handle;
threads->create(sub {
        $io = IO::Handle->new_from_fd(fileno(STDIN), 'r') or die;
        $br = read $io, $buf, 100;
        warn "read: $br";
});
while(1) {threads->yield()}; 
```

Here, warn() is never executed unless you hit Ctrl-D on keyboard. Is there any simple solution to timeout that read() call?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:59:11.393

而不是线程（这在 Perl 中充其量是不支持的，而且大多不赞成），为什么不尝试其中一个事件模块呢？这是 Perl 中并发的标准解决方案。

# spring - Integration JSF, Spring and Primefaces

> ID：11615163
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:01:00.717
> 
> 标签：spring, jsf, primefaces

I'm new at Java and i'm studying some technologies, and i want to know if its possible to integrate JSF, Spring and Primefaces. I'm searching for some tips but i only found JSF + Spring or Spring + Primefaces or Spring + JSF or JSF + Primefaces but never all 3 together. It's possible to integrate all of them ?

Att,

Pedro Henrique

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T18:14:29.117

对的，这是可能的。

请注意，PrimeFaces 只是一个在 JSF 规范之上工作的组件库（只是`WEB-INF/lib`目录中的一个附加 JAR），因此或多或少可以理解，如果您可以将某些东西与 JSF（在本例中为 Spring）集成，您可以与它一起使用 PrimeFaces。

这可能并不总是正确的（例如，如果您使用一些可能与 PrimeFaces 使用的内容冲突的 Javascript 库），但现在通常是这样。

# java - Setting custom runtime classpath for a maven project in netbeans

> ID：11615164
> 
> 赞同：1
> 
> 时间：2012-07-23T15:01:07.810
> 
> 标签：java, maven, netbeans, configuration, classpath

I want to add a custom classpath when I'm running my maven project from within netbeans. So far I've tried adding the following to the **Run Project** action in the project properties:

```
exec.args=-classpath %classpath;c:/QUASR/duplicateRemoval.jar;c:/QUASR/lib/QUASR.jar ${packageClassName} 

exec.args=-cp %classpath;c:/QUASR/duplicateRemoval.jar;c:/QUASR/lib/QUASR.jar ${packageClassName}

exec.args=-cp c:/QUASR/duplicateRemoval.jar;c:/QUASR/lib/QUASR.jar ${packageClassName} 
```

but no luck, the custom runtime classpath is not set.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:19:04.743

你应该在你的 pom 中添加一个新的配置文件`run-with-netbeans`来声明额外的依赖项（使用`provided`范围不包括在发布中）。

然后，您必须将新配置文件添加到您的 IDE 以使用`-P run-with-netbeans`命令行中的选项运行 pom。

```
<properties>
    <!-- provided by default -->
    <my-dynamic-scope>provided</my-dynamic-scope>
</properties>

<profiles>
    <profile>
        <id>run-with-netbeans</id>
        <properties>
            <!-- compile when running in IDE -->
            <my-dynamic-scope>compile</my-dynamic-scope>
        </properties>
        <dependencies>
            <dependency>
                <groupId>log4j</groupId>
                <artifactId>log4j</artifactId>
                <version>${log4j.version}</version>
            </dependency>
        </dependencies>
    </profile>
</profiles>

<dependencies>
    <dependency>
        <groupId>commons-lang</groupId>
        <artifactId>commons-lang</artifactId>
        <version>${commons-lang.version}</version>
        <scope>${my-dynamic-scope}</scope>
    </dependency>
</dependencies> 
```

上面的代码片段仅在使用配置文件运行时添加 log4j `run-with-netbeans`。它还设置了一个属性`my-dynamic-scope`，可以在您的依赖块中使用来更改范围。

嗨，M。

# apache - Redirection in the homepage?

> ID：11615165
> 
> 赞同：0
> 
> 时间：2012-07-23T15:01:11.887
> 
> 标签：apache, http, redirect, http-headers, search-engine

I'm working on a website that deals with many languages and when a user enters to `example.com`, a little PHP script detects the user browser's preferred language (based on the `Accept-Language header`) and based on that it redirects using `header(Location: ...)` to `en.example.com`, `it.example.com`, `es.example.com`, etc. Now, this works perfectly but I found that search engines fail at indexing the homepage properly. I don't know much about the HTTP protocol but I realize I'm doing something wrong here. Does anyone have a suggestion on how to fix this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:15:05.023

你为什么要这么做？在您的情况下-当我将站点称为除此之外的代理或仅是 es 时，我将永远不会看到您的德语网站...

您应该让“用户”有机会选择他们想要使用的语言……然后 google 和 co 应该更接近您的朋友

# android - Photo: wrap_content, but max_width = layout width

> ID：11615167
> 
> 赞同：1
> 
> 时间：2012-07-23T15:01:17.317
> 
> 标签：android

I have a normal "read an article" type page with a single large photo at the top.

I'd like it to:

*   not scale larger than the source imgae
*   not be larger than the screen
*   not be CRAZY long vertically
*   side things I already have working
    *   border (via padding), center crop (would rather top crop, but seems not avail)

The main issue I'm having is - I can either have it fill_parent (ie full width) OR wrap_content (ie as large as the original image). And nothing I have done so far allows the image to be normal size (ie keep from enlarging).

Is there a "norm" for this kind of thing? I'm sure there's some kind of sweet spot or combination of attributes for this that works - I just can't find them.

My current attempt:

```
 <ImageView
            android:id="@+id/article_photo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@color/super_light_gray"
            android:scaleType="centerCrop"
            android:contentDescription="@string/articlePhoto"
            android:cropToPadding="true"
            android:layout_marginBottom="20dp"
            android:padding="1dp"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:14:20.937

你可以在Activity中编写一些代码来获取图像大小和显示大小。

如果图像尺寸超过显示尺寸设置显示宽度，如果不设置为图像尺寸。如果你想花哨，你可以找到 x 和 y 之间的比率，也可以垂直缩放。

# c# - unload AppDomain

> ID：11615170
> 
> 赞同：-4
> 
> 时间：2012-07-23T15:01:27.420
> 
> 标签：c#, process, appdomain

A DLL process is running in an isolated App. Domain which was runned from a 3rd application. I would like to unload AppDomain

If I use Enviroment.Exit(), it also kills the father application (app which lauches the DLL process)

**edit**

Doing as it follows neither:

```
 AppDomain domainObj = AppDomain.CurrentDomain;
        AppDomain.Unload(domainObj); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:04:22.497

如果 DLL 中的函数在您的进程中作为单独 AppDomain 中的线程运行，那么您可以尝试调用[AppDomain.Unload](http://msdn.microsoft.com/en-us/library/system.appdomain.unload.aspx)。根据文件，

> 当线程调用 Unload 时，目标域被标记为卸载。专用线程尝试卸载域，并且域中的所有线程都被中止。如果线程没有中止，例如因为它正在执行非托管代码，或者因为它正在执行 finally 块，那么在一段时间后，在最初调用 Unload 的线程中会抛出一个 CannotUnloadAppDomainException。如果无法中止的线程最终结束，则不会卸载目标域。因此，在 .NET Framework 2.0 版中，域不能保证卸载，因为它可能无法终止正在执行的线程。

因此，如果您无法成功卸载此其他 appdomain - 您可能需要寻找其他替代方案。

# powershell - Calling batch with user creds not working in powershell

> ID：11615175
> 
> 赞同：0
> 
> 时间：2012-07-23T15:01:56.990
> 
> 标签：powershell, batch-file, credentials

I have a powershell script that contains the following

```
$username = 'username'
$password = 'password'
$cred = New-Object System.Management.Automation.PSCredential -ArgumentList @($username,(ConvertTo-SecureString -String $password -AsPlainText -Force))
start-process -FilePath $deploymentAppPath -Credential $cred 
```

Yet when I execute this I get the following error.

```
start-process <<<<  -FilePath $deploymentAppPath -Credential $cred
+ CategoryInfo          : InvalidOperation: (:) [Start-Process], InvalidOperationException
+ FullyQualifiedErrorId : InvalidOperationException,Microsoft.PowerShell.Commands.StartProcessCommand 
```

While I don't think it is probably obvious, my end goal here is to call the batch file with the user credentials that I specify.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:07:31.307

我将从删除安全字符串的使用开始。在我的经验中，有些事情似乎并不适用。

看来您的进程是本地的，因此您没有通过网络传输 u/p。安全字符串真的有必要吗（考虑到 u/p 在脚本中并且对脚本有权限的人都可以使用）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T19:54:18.563

我相信您没有正确版本的 windows powershell 来使用该`start-process`命令。我运行了这个，除了我没有设置的明显的 -FilePath 错误之外它还有效。您似乎得到了基本的“命令不存在”异常。要检查您的版本号，请使用`get-host`cmdlet。运行`get-host | select version`，如果它输出 1.0 到控制台，你应该去[这里](http://blogs.msdn.com/b/powershell/archive/2008/12/30/download-windows-powershell.aspx)获取 2.0 版本。

# windows-phone-7 - 未更新 ListboxItems 的绑定

> ID：11615176
> 
> 赞同：1
> 
> 时间：2012-07-23T15:01:58.143
> 
> 标签：windows-phone-7, xaml, data-binding

我有一个与项目付款数据绑定的列表框。当我添加新的付款时，付款将被添加到列表中。添加页面还用于编辑付款。该事件被调用，在调试模式下我可以看到我的付款的更改值，但 ListBoxItem 不会被更新。在添加页面结束时，将调用一个事件，该事件会更新列表框项：

```
GlobalNotifier.OnPaymentAdded(); 
```

OnPaymentAdded 调用仅通知属性更改的方法：

```
OnNotifyPropertyChanged("Project"); 
```

列表框代码：

```
<ListBox Name="ListPayments" ItemsSource="{Binding Project.Payments}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid Margin="10,5,10,0">
                <StackPanel>
                    <TextBlock FontSize="30" Text="{Binding Name}" />
                </StackPanel>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

为什么添加了新项目，但没有更新现有项目？任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:07:51.820

听起来您的项目属性不是依赖属性，或者没有人为它们触发 propertychanged。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T11:15:02.047

发生的事情是，尽管`Project`-object 已更新，但`Payments`对象（可能是 a `List`）并未更新。

您*可以*尝试以下方法：

1.  每当`List`-object 被操作（编辑、删除/添加项目）时，触发`PropertyChanged`-event`Projects`
2.  您也可以将 切换`List<Project>`到`ObservableCollection<Project>`，这肯定会解决您的问题
3.  如果您无法切换到，请在显示列表的视图中`ObservableCollection`实现覆盖，并从那里调用 -events（项目、付款等）。`OnNavigatedTo()``PropertyChanged`

其中任何一个都可以解决您的问题 - 这完全取决于品味和偏好。

# entity-framework - 复杂字段显示为灰色

> ID：11615177
> 
> 赞同：2
> 
> 时间：2012-07-23T15:01:59.853
> 
> 标签：entity-framework

我正在按照[示例](http://weblogs.asp.net/jalpeshpvadgama/archive/2010/08/18/entity-framework-4-0-bind-stored-procedure-with-result-entity-class.aspx)在实体框架中练习绑定存储过程。

但是复杂的字段是灰色的，我无法更进一步。

请看图片。

![图片](../Images/c9b26e4b75205651041d411907f0130d.png)

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T12:03:12.057

.NET3.5 只支持 EF3.5，但是这个版本不支持复杂类型，所以按钮被禁用。.NET4.0 或更高版本就可以了。

# android - Android emulator Internet connection in my application

> ID：11615179
> 
> 赞同：1
> 
> 时间：2012-07-23T15:02:06.143
> 
> 标签：android, permissions, emulation, avd

I have a problem with my android emulator on my mac. I can use the browser and load websites so there is an internet connection in my AVD. My application can't connect to the internet, I am aware of the manifest configuration and I have set the internet permission on.

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

The application works well on several devices but never worked on the emulator. What am I doing wrong?

Thanks,

Omri.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T12:29:59.200

Preferences->Launch settings to Default emulator options: -dns-server 并在 url 上使用 https。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:46:34.690

我解决了我的问题，James Elsey 的问题把我引向了正确的方向。我试图使用 ssl 证书访问我自己的服务器。出于某种原因，模拟器不喜欢我的 rapidsssl 证书并且连接超时。它确实适用于Android设备。因为模拟器仅用于开发，所以我可以更改配置并仅在没有 ssl 的情况下使用 http。

感谢大家。

# java - oracle ordim add watermark to image

> ID：11615184
> 
> 赞同：1
> 
> 时间：2012-07-23T15:02:13.070
> 
> 标签：java, oracle, image-processing, watermark, multimedia

Oracle ordim is library that is bundled with oracle 11g database its purpose is to manage multimedia content in the database. How to add watermark using it? This is the function that is built in ".applyWatermark" but it just doesn't work with me. I have oracle 11g database installed so i use its ordim library. here is demo code.

```
imgProxy.applyWatermark(imgProxy, imgProxy, strings); 
```

first attribute is source image, second is destination image and string should be the text of the watermark, note source and destination images are same in my case. How can i add simple TEXT or image watermark to it. Can anyone post a working example. I have searching for online documentation but official oracle documentation is not enought for me to get it to work. Please help guys

Edit:

This is the code that "compiles" without errors but i don't have any output at the end. What am i doing wrong here?

```
String []strings = new String[3];
strings[0]="test1";
strings[1]="test2";
strings[2]="test3";
imgProxy.applyWatermark(imgProxy, imgProxy, strings);
imgProxy.getDataInFile("C://Documents and Settings//Administrator//Desktop//slika.jpg"); 
```

Note when i compile it only with this line

`imgProxy.getDataInFile("C://Documents and Settings//Administrator//Desktop//slika.jpg");`

it will generate me image on desktop but without watermark. So problem is only in that watermark method.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:34:52.280

该函数在[Multimedia Reference](http://docs.oracle.com/cd/E11882_01/appdev.112/e10776/ch_imgref.htm#CHDCHIBH)中列出，但未在[Multimedia DICOM Java API Reference (Javadoc)](http://docs.oracle.com/cd/E11882_01/appdev.112/e10781/oracle/ord/dicom/OrdDicom.html)中列出。多媒体参考有一个应用水印的例子，尽管它是在 PL/SQL 中的。它还包括此注释：

> 您不能将相同的 ORDImage 指定为源和目标。

# android - 如何验证 Eclipse 是否正在使用 NDK？

> ID：11615185
> 
> 赞同：0
> 
> 时间：2012-07-23T15:02:12.120
> 
> 标签：android, eclipse, android-ndk

我遵循了 NDK 教程，但我仍然有点困惑。当我下载 android SDK 时，我必须告诉 Eclipse IDE SDK 在磁盘上的确切位置。凉爽的。成功了，我很高兴。

然而，NDK 说明并没有告诉你。他们告诉你的只是你下载了 NDK 并简单地解压缩它。它只是神奇地应该起作用。

我已经按照[这里](http://mindtherobot.com/blog/452/android-beginners-ndk-setup-step-by-step/)的教程进行操作。

代码不起作用。

那么如何验证 Eclipse 是否知道我已经下载了 NDK？

另外，我从 OSX 运行它，所以我没有使用 Cygwin。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:17:08.773

当你构建你的程序时，你使用：

```
cd <project>
<ndk>/ndk-build 
```

`<ndk>`目录的路径在哪里。就是这样。

# android - TabHost：取消选中所有选项卡

> ID：11615187
> 
> 赞同：0
> 
> 时间：2012-07-23T15:02:20.317
> 
> 标签：android, android-layout

有没有办法取消选择 TabHost 中的所有元素。我想我可以制作一个存根标签，其宽度为 0dp。这是一条路吗？它是如何完成的 - 我如何将样式应用于一个特定的选项卡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T17:34:50.183

要使标签伸展开：

```
fakeTab.setVisibility(View.GONE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:11:14.300

如果这是您使用 Id 的方法，建议您为“假标签”创建自己的标签视图。

像这样的东西

```
private class TabView extends FrameLayout  {
    public TabView(Context c) {
        super(c);

        View indicator = new View(c);
        //Might even wanna go for 0 here?
        LayoutParams params = new FrameLayout.LayoutParams(1, 1);
        indicator.setLayoutParams(params);

        addView(indicator);
    }
} 
```

然后只需通过以下方式将其添加到您的 TabHost ：

```
 TabView fakeTab = new TabView(this, 0, "faketab");
    spec = tabHost.newTabSpec("about").setIndicator(fakeTab);
    tabHost.addTab(spec); 
```

当您想将所有选项卡显示为未选中时，您只需让 TabHost 选择您的假选项卡。

# xml - 在“扁平化”WSDL 上导入标签

> ID：11615198
> 
> 赞同：1
> 
> 时间：2012-07-23T15:02:47.473
> 
> 标签：xml, soap, wsdl, salesforce, axis2

我正在尝试将 Salesforce 合作伙伴 WSDL 与 Axis2 的 WSDL2C 工具一起使用。未经修改，该工具报告导入标记缺少 schemaLocations。生成的代码无法编译。

我通过向架构部分添加 ID 并尝试将其用作 schemaLocations 尝试了几次，但我收到有关命名空间不正确的错误。

将这种“扁平化 WSDL”（所有模式都在 WSDL 本身中定义，没有其他 SFDC 引用）转换为 Axis2 可能能够使用的东西的最合适方法是什么？

以下是其中一个导入部分的示例：

```
<schema elementFormDefault="qualified" xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="urn:sobject.partner.soap.sforce.com">

    <import namespace="urn:partner.soap.sforce.com" schemaLocation="partner.soap.sforce.com SalesForce.Partner.wsdl"/> 
```

合作伙伴 WSDL 有 3 个模式 - partner.soap.sforce.com、sobject.partner.soap.sforce.com 和 fault.partner.soap.sforce.com。sobject 和合作伙伴模式相互导入。

如前所述，我尝试添加 ID 和 'schemaLocations="#id"'，但结果是一个错误，指出 sobject 部分的命名空间与宣传的不同。

# java - 仅匹配以两个字母开头的字符串

> ID：11615201
> 
> 赞同：-3
> 
> 时间：2012-07-23T15:03:05.443
> 
> 标签：java, regex

我正在尝试使用这个正则表达式：

```
if (input.matches("(^(?=.*[A-Z]{2}")) 
```

但这对我不起作用。请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:13:33.727

您正在使用的正则表达式：

```
"^(?=.*[A-Z]{2})" //added the unmatched paranthesis 
```

将使用*前瞻来查看字符串中*`A-Z` *任何位置*的范围内是否有两个连续的字符。
要检查前两个是否在该范围内，您可以执行以下操作：

```
input.matches("^[A-Z]{2}.*") 
```

请注意，您需要`.*`, since`matches()`必须匹配整个`input`字符串才能返回 true。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:09:30.173

```
private boolean isAlpha(char c) {
    return (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z')
}

private boolean startsWith2Alpha(String s) {
    return (s.length() >= 2) && isAlpha(s.charAt(0)) && isAlpha(s.charAt(1));
} 
```

没有正则表达式就容易多了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:05:07.610

`if(input.matches("^[a-zA-Z]{2}")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:18:52.513

您是否关心非英语语言支持？`input.matches("\\p{L}{2}.*")`会成功的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T16:34:40.173

地狱是的！您输入的正则表达式不起作用，因为它不是标准的。它应该带有 A 和 O 字符。

# java - Java中的方法隐藏

> ID：11615202
> 
> 赞同：0
> 
> 时间：2012-07-23T15:03:07.013
> 
> 标签：java, oop, method-hiding

> **可能重复：**
> [覆盖与隐藏 Java - 困惑](https://stackoverflow.com/questions/10594052/overriding-vs-hiding-java-confused)

有人可以用一个例子解释Java中的方法隐藏以及我们为什么使用方法隐藏吗？

我阅读了 Oracle 的教程，但无法理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:08:42.263

当您在超类中有静态方法并且在子类中创建具有相同签名的方法时，如果您使用超类引用，则会调用超类方法，如果使用子类，则会调用子类方法类参考。

# java - 序列化 Date 对象类型的 ArrayList

> ID：11615206
> 
> 赞同：1
> 
> 时间：2012-07-23T15:03:17.597
> 
> 标签：java, serialization, arraylist

我想序列化一个包含 Date 对象的 Arraylist，然后能够对其进行反序列化并迭代反序列化的版本。

目前我有一个名为 DateSerialize 的类，它实现了 Serializable。我有一种将日期对象添加到数组列表中的方法，然后一旦完成，我想对其进行序列化。

下次运行程序时，我想反序列化该数组列表并以相同的顺序和格式获取这些对象，并希望在其上运行迭代器。

谁能帮我解决这个问题？？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:09:26.670

如果你想使用 Serializable，你应该没有问题，因为 ArrayList 是 Serializable 就像 String 和每个原始类型一样。`public class DateSerialize implements Serializable {}`应该做剩下的。[您可以在此处](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/Serializable.html)阅读有关此方法的更多信息。但是，还有很多其他的序列化选项。所以请更具体。

## 例子

### 第一：创建 ArrayList 和要放入的对象

```
ArrayList aList = new ArrayList();
MyBusinessObject obj = new MyBusinessObject();
obj.Name = "MyName";
obj.Address = "MyAddress";
obj.Phone = 435345;
aList.Add(obj); 
```

### 二：序列化ArrayList

```
/// <summary>
/// Serialize the ArrayList
/// </summary>
/// <param name="obj"></param>
/// <returns></returns>
private string SerializeArrayList(ArrayList obj) { 
  System.Xml.XmlDocument doc = new XmlDocument();
  Type[] extraTypes = new Type[1];
  extraTypes[0] = typeof(MyBusinessObject);
  System.Xml.Serialization.XmlSerializer serializer = new System.Xml.Serialization.XmlSerializer(typeof(ArrayList), extraTypes); 
  System.IO.MemoryStream stream = new System.IO.MemoryStream(); 
  try { 
    serializer.Serialize(stream, obj); 
    stream.Position = 0; 
    doc.Load(stream); 
    return doc.InnerXml; 
  } catch { throw; } finally { 
    stream.Close(); 
    stream.Dispose(); 
  } 
} 
```

### 第三：反序列化ArrayList

```
/// <summary>
/// DeSerialize serialized string
/// </summary>
/// <param name="serializedData"></param>
/// <returns></returns>
private ArrayList DeSerializeArrayList(string serializedData) {
  ArrayList list = new ArrayList();
  Type[] extraTypes = new Type[1];
  extraTypes[0] = typeof(MyBusinessObject);
  System.Xml.Serialization.XmlSerializer serializer = new System.Xml.Serialization.XmlSerializer(typeof(ArrayList), extraTypes);
  XmlReader xReader = XmlReader.Create(new StringReader(serializedData));
  try {
    object obj = serializer.Deserialize(xReader);
    list = (ArrayList)obj;
  } catch { throw; } finally {
    xReader.Close();
  }
return list; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:14:51.363

为什么不存储`DateSerialize`为`long`（日期的内部值，以毫秒为单位）？

# c# - 处理大数据时的 C# OutOfMemory 问题

> ID：11615207
> 
> 赞同：0
> 
> 时间：2012-07-23T15:03:23.780
> 
> 标签：c#, sql, windows-services, garbage-collection, out-of-memory

在我们的应用程序中，我们使用*Windows Service*生成报告。报告的数据是使用*存储过程从**SQL Server*获取的。在某些情况下，返回的结果集包含 250,000 条记录（我们对此无能为力，我们需要一次性使用这些数据，因为我们需要对此进行一些计算）。

 ***问题**

我们的应用程序正在阅读器中获取此数据，并且我们正在将此数据集转换为自定义对象的自定义集合。由于数据量很大，它无法将完整的数据存储在自定义对象中，从而导致内存不足。当我们在执行记录时看到任务管理器的进程使用率时，它会变得非常高，甚至是 CPU 使用率。

我不确定在这种情况下应该怎么做。

> 1.  我们可以增加分配给在 CLR 下运行的单个进程的内存大小吗？
> 2.  还有其他解决方法吗？

任何帮助将非常感激

> 1.  为什么我一次需要所有数据：我们需要对完整的结果集进行计算
> 2.  我们正在使用 ADO.NET 并将数据集转换为我们的自定义对象（集合）
> 3.  我们的系统是 32 位的
> 4.  我们无法分页数据
> 5.  无法将计算移至 sql server

此堆栈跟踪可能会有所帮助：

> 引发了“System.OutOfMemoryException”类型的异常。服务器堆栈跟踪：在 System.Collections.Generic.Dictionary `2.ValueCollection.System.Collections.Generic.IEnumerable<TValue>.GetEnumerator() at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext() 在 System.Collections.Generic.List `1.InsertRange(Int32 index, IEnumerable`1 集合）在 System.Collections.Generic.List `1.AddRange(IEnumerable`1 集合）在 MyProject.Common.Data.DataProperty.GetPropertiesForType(在 C:\Ashish-Stuff\Projects\HCPA\Dev Branch\Common\Benefits.Common\Data\DataProperty.shared.cs 中键入 t)：MyProject.Common.Data.Extensions.GetProperties[T](T 目标的第 60 行) 在 C:\Ashish-Stuff\Projects\HCPA\Dev Branch\Common\Benefits.Common\Data\Extensions.shared.cs:第 30 行在 MyProject.Common.Data.Factories.SqlServerDataFactoryContract `1.GetData(String procedureName, IDictionary`2 个参数，Nullable `1 languageId, Nullable`1 pageNumber，Nullable `1 pageSize)

谢谢，阿希什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:07:25.387

你能每 1000 行数据，将你自定义的对象集合序列化到磁盘的某个地方吗？然后当你返回数据时，从那些文件中分页？

有关您的用例为何需要撤回 250 万行数据的更多信息会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:00:42.493

我的第一个想法是可以通过一些存储过程在 Sql-Server 端进行计算。我怀疑这种方法需要一些 Sql-Server 绝地......但无论如何，你考虑过这种方法吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T19:37:22.967

我很想看到一个代码示例突出显示您从哪里得到这个错误。它是在数据本身上（填充阅读器）还是创建对象并将其添加到自定义集合（填充集合）。

我之前也遇到过类似的问题，处理非常大的数据集，但是在尽可能长时间地将其留在流中时取得了巨大的成功。流会将数据直接保存在内存中，并且在您完成构建对象之前，您永远不会真正拥有可以直接访问整个混乱的任何东西。现在，鉴于堆栈跟踪显示“MoveNext”操作的错误，这可能不适合您。然后我会说尝试分块数据，一次抓取 10k 行之类的，我知道这可以用 SQL 来完成。不过，这会使读取数据需要更长的时间。

**编辑**

如果您将其从数据库读取到本地流中，然后传递（注意不要关闭它），那么您不应该遇到这些问题。创建一个数据包装类，您可以使用开放流和开放阅读器传递该类。将数据存储在流中，然后使用包装函数从中读取您需要的特定数据。诸如`GetSumOfXField()`or`AverageOfYValues()`等​​之类的东西……数据永远不会存在于活动对象中，但是您不必为此继续返回数据库。

**伪示例**

```
 public void ReadingTheDataFunction()
    {
        DBDataReader reader = dbCommand.ExecuteReader();
        MyDataStore.FillDataSource(reader)
    }

    private void FillDataSource(DbDataReader reader)
    {
        StreamWriter writer = new StreamWriter(GlobaldataStream);
        while (reader.Read())
            writer.WriteLine(BuildStringFromDataRow(reader));
        reader.close();
    }

    private CustomObject GetNextRow()
    {
        String line = GlobalDataReader.ReadLine();
        //Parse String to Custom Object
        return ret;
    } 
```

从那里你绕过 MyDataStore，只要流和阅读器没有关闭，你就可以移动你的位置，去寻找单个条目，编译总和和平均值等等，你甚至不需要知道你是' 不处理活动对象，只要您仅通过接口函数与它交互。*

# iphone - 我是否必须为类的所有私有方法声明一个类别？

> ID：11615210
> 
> 赞同：2
> 
> 时间：2012-07-23T15:03:25.423
> 
> 标签：iphone, objective-c, objective-c-category

假设我想让一个类的私有方法只对该类的实现可见，以便该类的接口只公开需要公开的内容。在一些最新版本的 Xcode 中，我可以简单地通过在标头中省略方法的声明来做到这一点。但是，一本好书建议我还应该在实现文件中声明一个类别并在其中声明该方法，如下所示：

```
// [in MyClass.m]
#import "MyClass.h"

// category declaration - is it really required?
// edit: it's a class extension declaration, I know, but it doesn't change much
@interface MyClass ()
- (void)myPrivateMethod;
@end

@implementation MyClass
- (void)myPrivateMethod
{
    // do something
}
// all methods here can call myPrivateMethod
@end 
```

事实上，它确实可以编译和工作。此外，它确实可以在没有类别/扩展声明部分的情况下编译并正常工作。这提出了一个自然的问题：

如果我有一堆私有方法，我需要在一个类别中声明它们吗？最佳做法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:08:24.690

[这不是一个*类别*，它是一个*类扩展*](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/chapters/occategories.html)（注意没有类别名称，括号是空的）。

将私有方法添加到类扩展中是一个非常好的主意。这样做可以确保所有方法都有声明，并且这些声明仅对您希望它们可见的代码部分可见。

请注意，与普通类别不同，类扩展允许您添加实例变量。当您的实现依赖于不属于您的类接口的类时，这非常方便。

# android - 设计师给了我PSD。现在，如何创建我的 android 布局？

> ID：11615211
> 
> 赞同：4
> 
> 时间：2012-07-23T15:03:25.593
> 
> 标签：android, android-layout, psd

我的设计师给了我以下布局（稍作改动以保护我的业务:)

![在此处输入图像描述](../Images/74a11b95038d864460f245e5a12a7671.png)

现在，我面临很多疑问，因为我如何将每个元素合并到我的 android 布局中。

1.  如您所见，背景有轻微的噪音。我尝试从中创建一个 9patch，但是在 Android 中加载时，我完全失去了图像的质量。它奇怪地伸展开来。我应该有不同分辨率的背景（即 mdpi、hdpi...）还是可以通过 9 个补丁来实现

2.  用按钮做什么？我尝试将按钮（在 Photoshop 中它是一个组）保存到新图像中并将其保存为 PNG。当使用 ImageButton 加载布局并在我的手机上尝试时，按钮**太大**了。如何保证不同类型屏幕上按钮的大小？对于不同的分辨率（mdpi...），我是否需要不同大小的此按钮？如果需要，我如何知道此按钮的大小对于 hdpi 分辨率或 mdpi 分辨率是多少？或者也许我应该强制按钮的宽度和高度为 60dp 之类的值，但这对我来说听起来不正确。我知道我可以创建一个形状并将其应用于按钮的背景，但是 Facebook 按钮呢？我想，在这种情况下，我需要一个以 PNG 作为背景的 ImageButton。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T05:23:26.883

我知道这已经很晚了，但希望它会对其他人有所帮助。

1) 向您的设计师索取可重复的图像，您可以将其平铺作为背景。我看不出有什么理由不能平铺。要平铺图像，请为每个通用 dpi 文件夹制作一个可绘制类型的 xml 文件。将此代码放入 xml 文件中：

```
 <?xml version="1.0" encoding="utf-8"?>
    <bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:dither="true"
    android:src="@drawable/piece_of_the_background_that_can_be_repeated"
    android:tileMode="repeat" /> 
```

将背景可绘制对象设置为此 xml 文件。

2) 设置 9patch 图像作为按钮背景，并使用[此自定义](http://qwerjk.com/magic-text/)textView 作为文本。使用 innerShadow 属性来获得设计师展示的阴影效果。

# javascript - 使用jquery 为html 元素文本的每个字符设置动画？

> ID：11615220
> 
> 赞同：1
> 
> 时间：2012-07-23T15:04:34.457
> 
> 标签：javascript, jquery, animation

我想使用 jquery 为从 html 元素中获取的文本字符串设置动画：

```
<h1>Animate</h1> 
```

对于 jquery 部分：

```
$(document).ready(function() {

$( "h1" ).animate({ fontSize: "90px" }, 1500 )
     .animate({ fontSize: "50px" }, 1500 );

}); 
```

这会为整个 h1 文本值设置动画，但是我想为 h1 文本中的每个字符设置动画。

第二个jQuery部分：

```
$(document).ready(function () {

    var animateChar = $("h1").text();
    for(i=0; i<animateChar.length; i++) {

        //alert(i + ': ' + animateChar.charAt(i));
        // for every animateChar.charAt[i] want to run this
        //jquery animation.
        //$( "h1" ).animate({ fontSize: "90px" }, 1500 )
        //.animate({ fontSize: "50px" }, 1500 );

        }
 }); 
```

这是我卡住的地方。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:09:07.507

您可以在 DOM 元素上使用 jQuery 函数。不在字符上分开。您应该为每个字符使用不同的 DOM 元素：

```
<span>A</span><span>N</span><span>I</span>... 
```

像这样的东西必须做的伎俩

```
$('span').each(function() {
    var that = $(this);
    setTimeout(function() { 
        that.animate({ fontSize: "90px" }, 1500 )
            .animate({ fontSize: "50px" }, 1500 );
    },that.index()*100);
});​ 
```

-编辑-

工作[**的 jSFIDDLE**](http://jsfiddle.net/aA8Un/)

-编辑2-

没有凌乱的 HTML [**JSFIDDLE**](http://jsfiddle.net/aA8Un/1/)（它仍然很乱，但是 javascript 使它变得凌乱；））

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:10:03.480

```
<span class="animate">A</span><span class="animate">n</span><span class="animate">i</span><span class="animate">m</span><span class="animate">a</span><span class="animate">t</span><span class="animate">e</span>

$(document).ready(function() {

   var count = 0;       

   function animation(elm) {
       if(count == $(".animate").length)
       {
          clearInterval(id);
          return;
       }

       $( elm ).animate({ fontSize: "90px" }, 1500 )
     .animate({ fontSize: "50px" }, 1500 );
     count++;
   }

   var id = setInterval(animation($(".animate")[count]), 3200);//Give time for animation to run.

}); 
```

这将为每个角色设置动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:14:20.923

如果你想保持你的 HTML 干净，我会添加以下方法来将你的字符包装在`span`标签中。`wrapCharacters($("h1"))`在为任何内容设置动画之前执行此 onLoad ，然后为`$(".animate")`.

```
function wrapCharacters(obj)
{
    var html = '';
    var text = obj.text();
    for (var i = 0; i < text.length; i++)
    {
        html += '<span class="animate">' + text[i] + '</span>';
    }
    obj.html(html);
} 
```

# wpf - 在 WPF 窗口中托管 win 表单控件

> ID：11615228
> 
> 赞同：0
> 
> 时间：2012-07-23T15:05:31.423
> 
> 标签：wpf, winforms, textbox, windowsformshost

我正在尝试使用底部标记在 WPF 中托管 win 表单控件，当我编译我的应用程序时，控件被创建但它们是不可见的，我可以单击并键入但我看不到文本框或内容。有什么建议么？

```
<WindowsFormsHost Opacity=".75" VerticalAlignment="Center" Height="32" Margin="5">
    <Forms:TextBox x:Name="textbox"/>
</WindowsFormsHost> 
```

# c++ - g++：在涉及多个翻译单元的情况下，RVO 如何工作

> ID：11615231
> 
> 赞同：10
> 
> 时间：2012-07-23T15:05:44.780
> 
> 标签：c++, g++, rvo

首先请看下面的代码，它由 2 个翻译单元组成。

```
--- foo.h ---

class Foo
{
public:
    Foo();
    Foo(const Foo& rhs);
    void print() const;
private:
    std::string str_;
};

Foo getFoo();

--- foo.cpp ---
#include <iostream>

Foo::Foo() : str_("hello")
{
    std::cout << "Default Ctor" << std::endl;
}

Foo::Foo(const Foo& rhs) : str_(rhs.str_)
{
    std::cout << "Copy Ctor" << std::endl;
}

void Foo:print() const
{
    std::cout << "print [" << str_ << "]" << std:endl;
}

Foo getFoo()
{
    return Foo(); // Expecting RVO
}

--- main.cpp ---
#include "foo.h"

int main()
{
    Foo foo = getFoo();
    foo.print();
} 
```

请确保 foo.cpp 和 main.cpp 是不同的翻译单元。所以根据我的理解，我们可以说在翻译单元 main.o (main.cpp) 中没有 getFoo() 的实现细节。

但是，如果我们编译并执行上面的代码，我看不到表明 RVO 在这里工作的“Copy Ctor”字符串。

如果你们中的任何人请告诉我如何实现这一点，即使'getFoo（）'的实现细节没有暴露给翻译单元main.o，我将不胜感激？

我使用 GCC (g++) 4.4.6 进行了上述实验。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-23T15:19:24.613

编译器必须始终如一地工作。

换句话说，编译器必须只查看返回*类型*，并根据该类型决定返回该类型对象的函数如何返回值。

至少在一个典型的案例中，这个决定是*相当*微不足道的。它留出一个寄存器（或可能两个）用于返回值（例如，在通常为 EAX 或 RAX 的 Intel/AMD x86/x64 上）。任何小到可以放入其中的类型都将返回那里。对于任何太大而无法放在那里的类型，该函数将接收一个隐藏的指针/引用参数，告诉它将返回结果存放在哪里。请注意，这在完全不涉及 RVO/NRVO 的情况下非常适用——事实上，它同样适用于返回 a 的 C 代码，`struct`就像它适用于返回对象的 C++ 一样`class`。尽管在 C 中返回 a`struct`可能不像在 C++ 中那么常见，但它仍然是允许的，并且编译器必须能够编译执行它的代码。

实际上有两个单独的（可能的）副本可以被消除。一种是编译器可以在堆栈上为本地保存返回值的空间分配空间，然后从那里复制到返回期间指针所指的位置。

第二个是从该返回地址到该值真正需要结束的其他位置的可能副本。

第一个在函数本身内部被消除，但对其外部接口没有影响。它最终将数据放在隐藏指针告诉它的任何地方——唯一的问题是它是先创建一个本地副本，还是总是直接与返回点一起工作。显然，对于 [N]RVO，它总是可以直接工作。

第二个可能的副本是从那个（潜在的）临时副本到值真正需要结束的地方。这可以通过优化调用序列而不是函数本身来消除——即，给函数一个指向该返回值的最终目的地的指针，而不是指向某个临时位置，然后编译器将从该位置将值复制到其目的地.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T15:19:00.383

`main`不需要`getFoo`RVO 的实现细节。它只是期望退出后返回值在某个寄存器中`getFoo`。

`getFoo`对此有两个选择 - 在其范围内创建一个对象，然后将其复制（或移动）到返回寄存器，或**直接在该寄存器中创建对象**。这就是发生的事情。

它并没有告诉 main 去其他任何地方，也不需要。它只是直接使用返回寄存器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-23T15:24:10.027

(N)RVO 与翻译单元无关。该术语通常用于指代两种不同的复制省略，可以应用于函数内部（从局部变量到返回值）和调用者（从返回值到局部变量），应该讨论它们分别地。

**正确的 RVO**

这是严格在函数内部执行的，请考虑：

```
T foo() {
   T local;
   // operate on local
   return local;
} 
```

从概念上讲，有两个对象，`local`以及返回的对象。编译器可以在本地分析函数并确定两个对象的生命周期是绑定的：`local`仅作为返回值的副本的来源。然后编译器可以将这两个变量绑定在一个变量中并使用它。

**在调用方复制省略**

在调用方，考虑`T x = foo();`. 同样有两个对象，从`foo()`和中返回的对象`x`。编译器可以再次确定生命周期是绑定的，并将两个对象放在同一位置。

进一步阅读：

*   [值语义：NRVO](http://definedbehavior.blogspot.com/2011/08/value-semantics-nrvo.html)

*   [值语义：复制省略](http://definedbehavior.blogspot.com/2011/08/value-semantics-copy-elision.html)

# jquery - jQuery Datatables，是否可以手动调用操作方法？

> ID：11615234
> 
> 赞同：0
> 
> 时间：2012-07-23T15:05:49.737
> 
> 标签：jquery, asp.net-mvc, datatables

我正在使用 jQuery Datatables 插件，我想在我有我的表格的页面中添加一些额外的内容（复杂的过滤器）。

通常，控制器操作方法由插件调用，当我搜索某些内容时，对列进行排序等等。

我想要实现的是手动（通过 Ajax）调用此操作方法，并将我的复杂过滤器数据传递给它，以及插件通常传递的参数。

这可能吗 ？我相信必须有一种方法，因为有一个基于列类型的过滤插件。（我认为它应该做一些非常相似的事情）

如果重要的话，我正在使用带有 ASP.NET MVC 的数据表。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:31:22.260

其实很简单。我已经做过很多次了，所以我会给你一些我使用的代码。

JS：

```
oTable.dataTable({
    "bJQueryUI": true,
    "bAutoWidth": false,
    "bProcessing": true,
    "bDestroy": true,
    "sPaginationType": "full_numbers",
    "bStateSave": false,
    "bServerSide": true,
    "bPaginate": false,
    "bSort": false,
    "bFilter": false,
    "sAjaxSource": "/ByUser/DetailsData",
    "bDeferRender": false,
    "aoColumns": [
                        { "sWidth": "5%", "bSearchable": false },
                        { "sWidth": "10%", "bSearchable": false },
                        { "sWidth": "3%", "bSearchable": false },
                        { "sWidth": "6%", "bSearchable": false },
                        { "sWidth": "5%", "bSearchable": false },
                        { "sWidth": "5%", "bSearchable": false },
                        { "sWidth": "5%", "bSearchable": false }
             ],
    "fnInitComplete": function () {
        $(oTable).show();
        $("#theGrid td:nth-child(1)").addClass("fileID");
        $("#theGrid td:nth-child(6)").addClass("taskID");
        checkComplianceNoMid("theGrid", 7);
    },
    "fnServerParams": function (aoData) {  //These are the extra parameters from my custom filters
        var BU = $("#SLABU").val();
        aoData.push({ "name": "BU", "value": BU });
        var SLAUser = $("#SLAUSER").val();
        aoData.push({ "name": "User", "value": SLAUser });
        var SLAStep = $("#SLASTEP").val();
        aoData.push({ "name": "Step", "value": SLAStep });
    }
}); 
```

现在在控制器中：

```
public ActionResult DetailsData(jQueryDataTableParamModel param, string BU, string User, string step)
    {
        var context = new OpenTask();
        context.CommandTimeout = 120;

        IList<SLAOpenTaskPersonDetails> SLAList = context.SLAOpenTaskPersonDetails1.Where(x => x.userid == User).Where(x => x.BU == BU).Where(x => x.SLA_Name == step).ToList();
        int rowCount = SLAList.Count();

        var list = SLAList.Select(c => new[]{
            c.File_no.ToString() ?? null,c.AssuredName.ToString() ?? null,c.Plan_SLA.ToString() ?? null,c.Since_date.ToString() ?? null,
            c.Since_Day.ToString() ?? null, c.taskid.ToString() ?? null, c.SLA_compliance.ToString()  ?? null
        });

        return Json(new
        {
            sEcho = param.sEcho,
            iTotalRecords = context.SLAOpenTaskPersonDetails1.Count(),
            iTotalDisplayRecords = rowCount,
            aaData = list
        }, JsonRequestBehavior.AllowGet);
    } 
```

您将需要添加以下对象以从 aoData 对象中获取数据：

```
 /// <summary>
/// Class that encapsulates most common parameters sent by DataTables plugin
/// </summary>
public class jQueryDataTableParamModel
{
    /// <summary>
    /// Request sequence number sent by DataTable,
    /// same value must be returned in response
    /// </summary>       
    public string sEcho { get; set; }

    /// <summary>
    /// Text used for filtering
    /// </summary>
    public string sSearch { get; set; }

    /// <summary>
    /// Number of records that should be shown in table
    /// </summary>
    public int iDisplayLength { get; set; }

    /// <summary>
    /// First record that should be shown(used for paging)
    /// </summary>
    public int iDisplayStart { get; set; }

    /// <summary>
    /// Number of columns in table
    /// </summary>
    public int iColumns { get; set; }

    /// <summary>
    /// Number of columns that are used in sorting
    /// </summary>
    public int iSortingCols { get; set; }

    /// <summary>
    /// Comma separated list of column names
    /// </summary>
    public string sColumns { get; set; }
} 
```

现在我的功能不包括服务器端排序，所以这里是一个例子：

```
var sortColumnIndex = Convert.ToInt32(Request["iSortCol_0"]);
        Func<SLAHistoricalDetail, decimal> orderingFunctionDec = (x => sortColumnIndex == 3 ? Convert.ToDecimal(x.quetime) :
                                                                    Convert.ToDecimal(x.locktime));
        Func<SLAHistoricalDetail, string> orderingFunction = (x => sortColumnIndex == 0 ? x.File_no.ToString() :
                                                            sortColumnIndex == 1 ? x.Assured_Name.ToString() :
                                                            sortColumnIndex == 2 ? x.Plan_SLA.ToString() :
                                                            sortColumnIndex == 5 ? x.taskid.ToString() :
                                                            x.SLA_Metric.ToString());

        var sortDirection = Request["sSortDir_0"];
        if (sortDirection == "asc")
        {
            if (sortColumnIndex == 3 || sortColumnIndex == 4)
            {
                SLAList = SLAList.OrderBy(orderingFunctionDec).ToList();
            }
            else
            {
                SLAList = SLAList.OrderBy(orderingFunction).ToList();
            }
        }
        else
        {
            if (sortColumnIndex == 3 || sortColumnIndex == 4)
            {
                SLAList = SLAList.OrderByDescending(orderingFunctionDec).ToList();
            }
            else
            {
                SLAList = SLAList.OrderByDescending(orderingFunction).ToList();
            }
        } 
```

然后您可以返回 SLAList。

我知道这是很多代码和示例。如果你愿意，我可以解释任何细节。此外，我使用的是 ADO.NET，但您可以使用 SQL 或 w/e 处理您的数据，工作方式相同。

哦，要手动刷新数据，您可以看看这个问题：[当我单击按钮时，如何触发 jquery datatables fnServerData 以通过 AJAX 更新表？](https://stackoverflow.com/questions/11566463/how-can-i-trigger-jquery-datatables-fnserverdata-to-update-a-table-via-ajax-when/11566783#11566783)

# flash - flash播放视频mp4（h.264）是否可行，元数据放在文件末尾

> ID：11615236
> 
> 赞同：1
> 
> 时间：2012-07-23T15:05:52.237
> 
> 标签：flash, video

有人告诉我 Flash 播放器要求将 mp4(H.264) 的元数据放在文件的开头。

我的**问题**是：是否可以使用 flash 在 http 服务器端播放视频，而无需更改元数据（元数据仍放置在视频的末尾）。就我而言，更改原始 mp4 文件对我来说非常困难。

我是Flash新手，所以我不知道它是否可行以及我可以从哪里开始。我可以用 flash 和 C++ 或其他东西来做到这一点吗？在这种情况下是否可以使用“NetStream appendBytes”？由于原始的mp4很大，我希望我可以在下载视频文件时播放视频，而不是在完全下载后播放。

非常感谢你帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:20:19.647

视频将播放，但只有在整个文件完成加载后才会播放。

您可以使用[MetaData Mover](http://rndware.info/products/metadata-mover.html)来修复您的视频文件 - 它不会重新压缩视频，只是移动数据。

“在服务器端播放视频”是什么意思？将视频的每一帧作为图像发送给用户？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T10:53:52.443

也许`appendBytes`会起作用，但是据我所知，这不会缓存显示的信息，因此倒带或快进将不起作用（您也必须自己实现）。你可能会做很多无关的工作，而且很可能会因为自己做很多事情而搞砸......

我的意思是，你试图做的就像一个男人在灯笼下寻找丢失的钥匙的笑话，因为那里比在他实际丢失钥匙的地方寻找钥匙更亮。您确实应该移动元数据或使用现有的流媒体服务器（有些是免费软件），而不是尝试以会导致您做大量无关工作的方式修补问题，并且最终可能会失败。

# ios - NSUrlConnection sendAsynchronousRequest 和自签名证书

> ID：11615237
> 
> 赞同：6
> 
> 时间：2012-07-23T15:05:55.207
> 
> 标签：ios, ios5, nsurlconnection

我正在编写一些执行 http 请求的 API 代码，并且我一直在使用 [NSUrlConnection:sendAsynchronousRequest:queue:completionHandler] 进行调用，因为它使编写简单的处理程序变得非常容易，而且我也不会每次调用都必须有不同的类和不同的代表。

我遇到的问题是，似乎接受自签名证书的唯一方法是让一个代表实现几个功能，说证书没问题。有没有办法用使用块的异步方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:50:40.637

不，但代表电话并不是那么难。这是您需要的代码：

1) 将此文件设为静态文件

```
static CFArrayRef certs; 
```

2）在您的初始化中执行此操作：

```
 // I had a crt certificate, needed a der one, so found this site:
    // http://fixunix.com/openssl/537621-re-der-crt-file-conversion.html
    // and did this from Terminal: openssl x509 -in crt.crt -outform der -out crt.der
    NSString *path = [[NSBundle mainBundle] pathForResource:@"<your name>" ofType:@"der"];
    assert(path);
    NSData *data = [NSData dataWithContentsOfFile:path];
    assert(data);

    SecCertificateRef rootcert = SecCertificateCreateWithData(NULL, (__bridge CFDataRef)data);
    if(rootcert) {
        const void *array[1] = { rootcert };
        certs = CFArrayCreate(NULL, array, 1, &kCFTypeArrayCallBacks);
        CFRelease(rootcert);    // for completeness, really does not matter 
    } else {
        NSLog(@"BIG TROUBLE - ROOT CERTIFICATE FAILED!");
    } 
```

3）然后添加这个方法：

```
- (void)connection:(NSURLConnection *)conn didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
{
#pragma unused(conn)
    // NSLog(@"didReceiveAuthenticationChallenge %@ FAILURES=%zd", [[challenge protectionSpace] authenticationMethod], (ssize_t)[challenge previousFailureCount]);

    /* Setup */
    NSURLProtectionSpace *protectionSpace   = [challenge protectionSpace];
    assert(protectionSpace);
    SecTrustRef trust                       = [protectionSpace serverTrust];
    assert(trust);
    CFRetain(trust);                        // Don't know when ARC might release protectionSpace
    NSURLCredential *credential             = [NSURLCredential credentialForTrust:trust];

    BOOL trusted = NO;
    OSStatus err;
    SecTrustResultType trustResult = 0;

    err = SecTrustSetAnchorCertificates(trust, certs);
    if (err == noErr) {
        err = SecTrustEvaluate(trust, &trustResult);
        if(err == noErr) {
        // http://developer.apple.com/library/mac/#qa/qa1360/_index.html
            switch(trustResult) {
            case kSecTrustResultProceed:
            case kSecTrustResultConfirm:
            case kSecTrustResultUnspecified:
                trusted = YES;
                break;
            }       
        }
    }
    CFRelease(trust);

    // Return based on whether we decided to trust or not
    if (trusted) {
        [[challenge sender] useCredential:credential forAuthenticationChallenge:challenge];
    } else {
        NSLog(@"Trust evaluation failed");
        [[challenge sender] cancelAuthenticationChallenge:challenge];
    }
} 
```

# javascript - 使用哈希映射分配声音

> ID：11615239
> 
> 赞同：1
> 
> 时间：2012-07-23T15:06:02.270
> 
> 标签：javascript, jquery, jquery-ui, hashmap

我正在尝试为“listOfWords”中的每个单词分配不同的声音，我不知道从这里开始随机打印其中一个单词并播放声音剪辑。

```
var listOfWords = {
    "mat": "http://www.wav-sounds.com/cartoon/daffyduck1.wav",
    "cat": "http://www.wav-sounds.com/cartoon/hankhill1.wav",
    "dog": "http://www.wav-sounds.com/cartoon/bugsbunny1.wav",
    "pit": "http://www.wav-sounds.com/cartoon/familyguy2.wav",
    "pot": "http://www.wav-sounds.com/cartoon/porkypig1.wav"
}​ 
```

在这里，我有到目前为止我尝试过的随机生成..

```
var shuffledWords = listOfWords.slice(0).sort(function() {
return 0.5 - Math.random();
}).slice(0, 1); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:20:25.250

`slice`并且`sort`是数组的方法。你所拥有的是一个`object`.

如果要获取该对象的随机属性，则必须使用循环：

```
var listOfWords = {
    "mat": "http://www.wav-sounds.com/cartoon/daffyduck1.wav",
    "cat": "http://www.wav-sounds.com/cartoon/hankhill1.wav",
    "dog": "http://www.wav-sounds.com/cartoon/bugsbunny1.wav",
    "pit": "http://www.wav-sounds.com/cartoon/familyguy2.wav",
    "pot": "http://www.wav-sounds.com/cartoon/porkypig1.wav"
};

var randomInt = Math.floor(Math.random() * (listOfWords.length + 1));
var chosenSound;

for (var prop in listOfWords) {
    if (randomInt === 0) {
        chosenSound = listOfWords[prop];
        break;
    }

    randomInt--;
} 
```

请注意，迭代对象时并不总是保证顺序，但无论如何您都是随机选择的，所以这并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:27:56.757

解决并完美地使用您想要的每个单词的声音。

**看一看：**

[http://jsfiddle.net/oscarj24/7kbNe/](http://jsfiddle.net/oscarj24/7kbNe/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:32:05.547

我想你已经明白每个人都说什么了。对象不能使用数组中的方法，因此您需要另一种方法来随机它们的属性。[在从 Javascript 对象中选择随机属性](https://stackoverflow.com/questions/2532218/pick-random-property-from-a-javascript-object)上找到一个

然后，选择一个随机键及其值。打印密钥，播放声音。

```
// function to pick random property from object 
// from https://stackoverflow.com/questions/2532218/pick-random-property-from-a-javascript-object
function pickRandomProperty(obj) {
    var keys = [];
    for (var prop in obj) {
        if (obj.hasOwnProperty(prop)) {
            keys.push(prop);
        }
    }
    return keys[Math.floor(keys.length * Math.random())];
}

var listOfWords = {
    "mat": "http://www.wav-sounds.com/cartoon/daffyduck1.wav",
    "cat": "http://www.wav-sounds.com/cartoon/hankhill1.wav",
    "dog": "http://www.wav-sounds.com/cartoon/bugsbunny1.wav",
    "pit": "http://www.wav-sounds.com/cartoon/familyguy2.wav",
    "pot": "http://www.wav-sounds.com/cartoon/porkypig1.wav"
};

var shuffledWords = pickRandomProperty(listOfWords), 
    shuffledSound = new Audio(listOfWords[shuffledWords]);

// "write" the word (ugly way)
document.write(shuffledWords);
// play the sound
shuffledSound.play(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T16:18:41.157

这是一个 HTML5 解决方案。据说IE9不能播放wav文件。此外，来自 wav-sounds.com 的一些 wav 文件会引发解码错误（在 FF14 中），因为示例我使用了不同的声音 url。为了简化随机选择，这将 listOfWords 声明为数组数组。希望能帮助到你。

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript">

        var listOfWords = [
            ["mat","http://www.wav-sounds.com/various/applause.wav"],
            ["cat", "http://www.wav-sounds.com/various/bomb.wav"],
            ["dog", "http://www.wav-sounds.com/various/bark.wav"],
            ["pit", "http://www.wav-sounds.com/various/beep.wav"],
            ["pot", "http://www.wav-sounds.com/various/cashtill.wav"]
         ];

        function playRandom() {
            var wordWavUrl = listOfWords[Math.floor(listOfWords.length * Math.random())];
            var word = wordWavUrl[0];
            var url = wordWavUrl[1];
            document.getElementById("wordDisplay").innerHTML=word;
            document.getElementById("audioPlay").src=url;
            document.getElementById("audioPlay").autoplay="autoplay";
        }
    </script>
</head>
<body>
    <div id="wordDisplay"></div>
    <button onclick="playRandom();">play random</button>
    <audio id="audioPlay">
    </audio>
</body>
</html> 
```

# php - 如何从包含 SQL 的字符串中提取 WHERE 子句？

> ID：11615244
> 
> 赞同：1
> 
> 时间：2012-07-23T15:06:18.900
> 
> 标签：php, sql, codeigniter

...或在我的情况下的任何条款。

我正在尝试为我目前正在处理的项目创建一个迁移脚本，为了做到这一点，我需要解析一组 SQL 脚本，提取 SELECT、FROM、WHERE 中的任何块并执行必要的改变。

有没有做这种事情的图书馆？如果没有，有人可以指出我正确的方向吗？

该应用程序使用 PHP，使用 CodeIgniter 2.1.0，数据库使用 MSSQL 2008

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:08:35.510

有一个旧的 PEAR 库应该完全符合您的要求： http: [//pear.php.net/package/SQL_Parser/](http://pear.php.net/package/SQL_Parser/)。

或者，您可以只使用不那么健壮的正则表达式。

# jsf - jsf2.1中配置资源包

> ID：11615246
> 
> 赞同：0
> 
> 时间：2012-07-23T15:06:22.673
> 
> 标签：jsf, primefaces

我在引用 xhtml 文件中的 .properties 文件中的资源值时遇到问题

我收到以下消息：

```
Jul 23, 2012 8:33:27 PM com.sun.faces.context.ExternalContextImpl getMimeType
WARNING: JSF1091: No mime type could be found for file hello.  To resolve this,
add a mime-type mapping to the applications web.xml. 
```

这是我的 faces-config.xml

```
<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_1.xsd"
    version="2.1">
    <application>
        <resource-bundle>
            <base-name>resources.resources</base-name>
            <var>resource</var>
        </resource-bundle>
        <locale-config>
            <default-locale>en</default-locale>
        </locale-config>
    </application>
</faces-config> 
```

这是我的测试页面

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">
<f:view>
    <h:head>
        <h:outputText value="Header" />
    </h:head>

    <h:body>
        <h:form>
        <h:outputText value="#{resource.hello}" />
            <h:outputText value="Body" />
            <br />
            <p:spinner />
        </h:form>
    </h:body>
</f:view>
</html> 
```

有什么问题？

编辑：

不确定是否重要，我使用 Primefaces-3.3.1

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T17:05:34.197

EL 变量`#{resource}`是一个保留的变量名，它引用文件`/resources`夹中的资源文件，这些文件由`<h:outputStylesheet>`,`<h:outputScript>`和使用`<h:graphicImage>`。EL 变量`#{resource}`通常只在 CSS 文件中使用，像这样

```
.someClass {
    background-image: url("#{resource['someLibrary:image/some.png']}");
} 
```

给它一个不同的名字。

```
<var>res</var>

<var>msg</var>

<var>text</var>

<var>i18n</var>

etc... 
```

### 也可以看看：

*   [JSF 2.0 中的通信 - 隐式 EL 对象](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ImplicitELObjects)

# c - 我可以同时初始化和使用两个 Lua 缓冲区吗？

> ID：11615256
> 
> 赞同：2
> 
> 时间：2012-07-23T15:06:54.893
> 
> 标签：c, api, lua, lua-api

鉴于 LuaL_Buffer 对象：“[在其正常操作期间，字符串缓冲区使用可变数量的堆栈槽](http://www.lua.org/manual/5.2/manual.html#luaL_Buffer)”，我不明白如何同时使用两个 luaL_Buffer 对象。他们每个人都会假设堆栈的状态是他们需要的吗？换句话说，一个缓冲区可能会在堆栈顶部放置一些东西，并期望它在将来的某个调用中存在，而另一个缓冲区也是如此？不能同时使用两个 LuaL_Buffers 吗？

这是一个同时需要两个缓冲区的操作的示例。它似乎适用于小型测试，但不知道它是否会在生产中站起来。

```
int res;
char *p;
size_t dlen;
struct luaL_Buffer src;
struct luaL_Buffer dst;

luaL_buffinit(L, &src);
luaL_buffinit(L, &dst);
luaL_addvalue(&src);
// .. grow/mod the src buffer in various ways
p = luaL_prepbuffsize(&dst, dlen);
res = my_uncompress((Byte *)(src.b), src.n, (Byte *)p, &dlen);
luaL_addsize(&dst, dlen);
// .. do things to the dst buffer .. 
```

[zlib](http://zlib.net/)方法`my_uncompress`的包装器在哪里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:20:15.307

您通常不能同时使用两个`luaL_Buffer`s。就像在假设您不会弄乱堆栈的函数中间时，您不能乱用堆栈一样。

您可以使用两个`luaL_Buffer`s，但*前提*是您完全嵌套调用。也就是说，只要您准备的第二个缓冲区尚未完成，您*就无法修改*`luaL_pushresult`您准备的第一个缓冲区。

您可以做的最好的事情是使用`lua_newthread`创建一个新的线程堆栈并将每个缓冲区放入自己的线程中。但是，这是对 API 的严重滥用，我不建议这样做。

# objective-c - 将初始工具栏项设置为选中

> ID：11615257
> 
> 赞同：2
> 
> 时间：2012-07-23T15:06:56.617
> 
> 标签：objective-c, macos, cocoa, interface-builder

我有一个工具栏，有两个项目，都可以选择。当我单击一个项目时，它显示为已选中，如您在此处看到的：

![在此处输入图像描述](../Images/803af62ae42c77bcbf0ef6871afcc629.png)

我最初无法设置项目。起初这两个项目都没有被选中，但我希望第一个被选中。在我手动单击一个项目之前，情况是这样的：

![在此处输入图像描述](../Images/fbdac627efa0edf6a5549b1efc3c8edb.png)

我必须怎么做才能将第一个项目设置为在应用程序启动时选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T18:08:12.517

所以你正在使用`NSToolbar`- use `setSelectedItemIdentifier`。您的每个项目都应该有一个在 Interface Builder 中指定的唯一标识符。

例如，我刚刚在主窗口视图中创建了一个带有 NSToolbar 的简单项目，添加了两个项目（从默认值开始），并连接了一个插座，如下所示：

AppDelegate.h：

```
@property (weak) IBOutlet NSToolbar *toolbar; 
```

AppDelegate.m:

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Insert code here to initialize your application

    [self.toolbar setSelectedItemIdentifier:@"NSToolbarShowFontsItem"];

} 
```

# google-apps-script - 从谷歌脚本访问动态表单字段变量

> ID：11615258
> 
> 赞同：1
> 
> 时间：2012-07-23T15:06:58.777
> 
> 标签：google-apps-script

我有一个生成顺序表单字段的独立应用程序。我不知道如何使用增量变量访问这些字段。

在我的 htmlscript 页面中：

```
<form id="myForm">
First Name: <input type="text" name="firstname" size="30"><br>
<? var listsize = data.length; 
   for (var i = 0; i < data.length; ++i) { ?>  
  <input type="checkbox" name="field<?= i ?>" value="Y"><?!= data[i]?><br>
<? } ?>
<input type="hidden" name="totalitems" value="<?= listsize?>">
<input type='button' onclick='google.script.run.processForm(this.parentNode)' value='submit' name="submit">
</form> 
```

这样会生成一堆名为“field0”、“field1”、“field2”等的复选框。

现在在我的 .gs 文件中：

```
function processForm(theForm) {

  var htmlBody =  'Hi '+theForm.firstname',<br>';

  for (var i = 0; i < theForm.totalitems; ++i) {
       var fieldname = "field" + i;
       htmlBody+= theForm.parameter['field'+i];// this does not work
       htmlBody+= theForm.['field'+i];         // this does not work
       htmlBody+= theForm.('field'+i);         // this does not work

  }
} 
```

例如，我可以使用 theForm.field7 直接访问其中一个动态表单字段，但我不知道如何使用变量“fieldX”在 for 循环中访问它

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T23:27:43.943

这有效：

```
 htmlBody+= theForm['field'+i.toString()]; 
```

必须删除 .parameter

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:15:41.400

你能试一下吗

```
htmlBody+= theForm.parameter['field'+i.toString()]; 
```

# ruby-on-rails - 回形针链接字段

> ID：11615265
> 
> 赞同：0
> 
> 时间：2012-07-23T15:07:20.057
> 
> 标签：ruby-on-rails, amazon-s3, paperclip

我有一个带有由 Paperclip 管理的图像属性的模型。是否可以让 Paperclip 基于远程位置的 URL 填充该属性？此外，这是否适用于 Paperclip 的 Amazon S3 支持？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:40:31.480

是的，这就是您配置回形针以使用 s3 的方式： [https ://github.com/thoughtbot/paperclip/wiki/Paperclip-with-Amazon-S3](https://github.com/thoughtbot/paperclip/wiki/Paperclip-with-Amazon-S3)

# javascript - 如何将所选内容作为变量传递给 TinyMCE style_formats

> ID：11615267
> 
> 赞同：1
> 
> 时间：2012-07-23T15:07:25.173
> 
> 标签：javascript, tinymce, wordpress

TinyMCE 有一种方法可以传入变量以与格式和 style_formats 代码一起使用：

```
// Registering the special format with a variable
tinymce.activeEditor.formatter.register('custom_format', {inline : 'span', styles : {color : '%value'}});

// Applying the specified format with the variable specified
tinymce.activeEditor.formatter.apply('custom_format', {value : 'red'}); 
```

如何扩展内置 styleselect 的行为以添加一些有用的辅助变量？特别是我想访问样式被应用到的选定文本，例如：

```
// Registering the special format with a variable
tinymce.activeEditor.formatter.register('custom_format', {inline : 'span', attributes : {data-content : '%content'}});

// Applying the specified format with the variable specified
tinymce.activeEditor.formatter.apply('custom_format', {content : tinymce.activeEditor.selection }); 
```

我可以看到您如何通过自定义按钮执行此操作，但我希望它与 styleselect 集成，因为它可以更轻松地在 WordPress 中使用。

任何 JS 专家可以指出我正确的方向吗？我仍然在使用 OO 风格的 javascript 以及究竟可以实现什么方面挣扎。

# freebase - 旧的 Freebase MQL 读取查询在新的 Google API 中不起作用

> ID：11615270
> 
> 赞同：1
> 
> 时间：2012-07-23T15:07:30.890
> 
> 标签：freebase

下面是一个使用 api.freebase.com 的旧 mqlread 查询示例，它返回了一些结果：

```
https://api.freebase.com/api/service/mqlread?queries={"q0":{"query":{"/common/topic/article":[{"id":null}],"name":"Ethanol","type":"/medicine/drug"}}} 
```

然而，使用新的 Google API (www.googleapis.com) 这个查询返回一个空的结果对象：

```
https://www.googleapis.com/freebase/v1/mqlread?query=[{"/common/topic/article":[{"id":null}],"name":"Ethanol 1","type":"/medicine/drug"}] 
```

没有任何关于将应用程序迁移到新 API 的文档，因为我认为它应该非常简单。我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T16:22:05.843

更改您正在查找的主题的名称是否算作“显而易见的事情”？在您的旧查询中是“乙醇”，在新查询中是“乙醇 1”（不存在）。

顺便说一句，BLOB API 还没有被转移到新的 API，所以如果你想使用你正在获取的文章 ID，你需要使用新的 Text API。

这是更正后的 URL 和生成的文本 API 调用

```
https://www.googleapis.com/freebase/v1/mqlread?query=[{%22/common/topic/article%22:[{%22id%22:null}],%22name%22:%22Ethanol%22,%22type%22:%22/medicine/drug%22}]&indent=1
https://www.googleapis.com/freebase/v1/text/m/02qw8 
```

编辑：ps这里的风还有一个变化，虽然它还没有完全正式化[http://markmail.org/message/tjfmhbb3thd5aqrt](http://markmail.org/message/tjfmhbb3thd5aqrt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:13:49.040

[http://wiki.freebase.com/wiki/Freebase_API](http://wiki.freebase.com/wiki/Freebase_API)告诉我们旧版本已被弃用。2012 年 10 月 30 日应该是最后一个日期..它在日期之前就停止工作了..

我尝试了以下查询以查看以 E 开头的所有内容。我找不到您要查找的实体。查询是正确的，可能是实体不再在该域中。

```
[{
  "/common/topic/article": [{
    "id": null
  }],
  "name" :[]
  "name~=": "E*",
  "type": "/medicine/drug"
}​]​ 
```

# vb.net - DataContractSerialization 的 XMLAttribute 等效项？

> ID：11615274
> 
> 赞同：0
> 
> 时间：2012-07-23T15:07:38.623
> 
> 标签：vb.net, serialization, datacontractserializer, xmlserializer, xml-attribute

我正在考虑将我们当前序列化/反序列化的类转换`XMLSerializer`为使用`DataContractSerializer`. 我希望切换的主要原因是`OnDeserialized`您使用`DataContractSerializer`. 如果需要，我真的希望能够利用对象的初始化。在我尝试转换的类中， and 有多种用途`<XmlAttribute()>`，`<XmlElement()>`具体取决于它们在 XML 中的显示方式。

我创建了一个测试类，只调用了具有几个不同属性的 Person，以便我可以测试将对象序列化为 XML，然后将其反序列化回对象。这很好用，但我不确定的一件事是为任何需要作为 XML 中的属性而不是元素（下面的“ID”）的属性指定什么。

这就是我要的：

```
<Person ID="5">
  <FullName>FirstName LastName</FullName> 
</Person> 
```

这就是我得到的：

```
<Person>
  <FullName>FirstName LastName</FullName>
  <ID>5</ID>
</Person> 
```

在下面的示例中，**如何指定 ID 是属性而不是元素？**因此，序列化时的 XML 如下所示：

```
<DataContract()> _
Public Class Person

    <DataMember()> _
    Public FullName As String

    '//What should go here?
    Public ID As Integer

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T17:54:46.483

```
<System.Xml.Serialization.XmlAttribute()> 
```

应该可以解决您的问题，有关详细信息，请参阅[MSDN XmlAttribute 参考](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributeattribute.aspx)。

# c# - 你调用的对象是空的。

> ID：11615275
> 
> 赞同：0
> 
> 时间：2012-07-23T15:07:39.610
> 
> 标签：c#, asp.net, asp.net-membership

```
Source Error: 

Line 55:                MembershipUser User = Membership.GetUser(UserNameTextBox.Text);
Line 56:   
Line 57:                Object UserGUID= User.ProviderUserKey; //error appeared here
Line 58:   
Line 59:                DataSource.InsertParameters.Add("UserId", UserGUID.ToString()); 
```

我在 createuserwizard 中有一个额外的步骤，在完成表单后，它会将用户信息存储在数据库中。但是发生了这个错误：

```
Object reference not set to an instance of an object. 
```

我还为链接 55、57、59 设置了一个断点。从第 57 行开始，用户为空，他们无法从数据库中获取用户。

后面的代码：

```
protected void CreateUserWizard1_CreatedUser(object sender, System.Web.UI.WebControls.LoginCancelEventArgs e)
    {  
       MSCaptcha.CaptchaControl Captcha1 = (CreateUserWizardStep1.ContentTemplateContainer.FindControl("Captcha1") as MSCaptcha.CaptchaControl);

       TextBox txtCaptcha = (TextBox)CreateUserWizardStep1.ContentTemplateContainer.FindControl("txtCaptcha");
       Label Captchalbl = (Label)CreateUserWizardStep1.ContentTemplateContainer.FindControl("Captchalbl");

       Response.Write(txtCaptcha.Text); 

           Captcha1.ValidateCaptcha(txtCaptcha.Text.Trim()); 

           if (!Captcha1.UserValidated)
           {

                Captchalbl.Text = "InValid";

               e.Cancel = true;
           } 
            else
           {
               Captchalbl.Text = "Valid";

               TextBox UserNameTextBox =
              (TextBox)CreateUserWizardStep1.ContentTemplateContainer.FindControl("UserName");

               SqlDataSource DataSource =
                   (SqlDataSource)CreateUserWizardStep1.ContentTemplateContainer.FindControl("InsertExtraInfo");

               MembershipUser User = Membership.GetUser(UserNameTextBox.Text);

               Object UserGUID= User.ProviderUserKey; //here is link 57\. 

               DataSource.InsertParameters.Add("UserId", UserGUID.ToString());

               DataSource.Insert();

            }
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:11:54.573

尽管此方法名称为“CreateUserWizard1_CreatedUser”，但由于其签名，我可以看到它是针对 CreatingUser 事件的。在此事件期间，尚未创建用户。为此使用 CreatedUser 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:12:26.770

源[Membership.GetUser 方法（字符串）](http://msdn.microsoft.com/en-us/library/40w5063z.aspx)

> 表示指定用户的 MembershipUser 对象。如果用户名参数与现有用户不对应，则此方法返回 null。

检查您的用户对象为空，然后尝试访问该对象的属性。如果没有具有指定名称的此类用户，则此方法返回 null。尝试将您的代码放在`OnFinishButtonClick`事件上，如果您无法从会员资格访问用户对象，希望这对您有用。

```
if( User != null)
{
  Object UserGUID= User.ProviderUserKey;
} 
```

# extjs4 - 设置和访问全局变量

> ID：11615277
> 
> 赞同：2
> 
> 时间：2012-07-23T15:07:42.227
> 
> 标签：extjs4, extjs4.1, extjs-mvc

我需要`Global Variables`在一个类中有一组，并且需要从其他类访问它。我有以下问题，有人可以帮助我吗？

1.) 我应该添加什么类型的课程？是`View`吗？有人可以举个例子吗？2.）如何从我的`Controller`和`View`类中为此类中的变量设置值？3.）如何从这个类（`global variable`类）中检索这些变量的值？

注意：我知道如何将它添加到`app.js`其他类中并写入/读取。但我想为全局变量设置一个单独的类。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T16:26:12.110

将它们作为静态添加到新类中：

```
Ext.define('MyApp.util.Utilities', {
    statics: {
        myGlobal: 1
    }
}); 
```

此时，您可以从应用程序中可以编写的任何位置加载该类`MyApp.util.Utilities.myGlobal = 5`。

这是我对类似问题的回答的扩展：我 [应该在哪里定义 ExtJS 4 MVC 中的全局函数？](https://stackoverflow.com/questions/9261458/where-should-i-define-global-functions-in-extjs-4-mvc/9277950#9277950)

# java - 使用 JavaPlot 的频谱图不起作用

> ID：11615280
> 
> 赞同：0
> 
> 时间：2012-07-23T15:07:56.890
> 
> 标签：java, gnuplot, javaplot

我正在尝试使用 JavaPlot 和这段代码来显示频谱图：

```
 PlotStyle style = new PlotStyle();
    style.setStyle(Style.IMAGE);

    DataSetPlot data = new DataSetPlot(points);
    data.setPlotStyle(style);

    JavaPlot plot = new JavaPlot();
    plot.addPlot(data);
    plot.plot(); 
```

在命令行中使用 gnuplot 时，这些点在工作时有效，如下所示：

```
 gnuplot --persist -e 'plot "data.dat" w image' 
```

问题是上面这段代码根本没有显示任何图像，全是白色的。然而，前面的命令工作正常，并且 data.dat 包含完全相同格式的点。运行代码时不会出现错误。

以下是一些点数据的示例：

```
0.0 193.0 0.18183826861232413
0.0 194.0 0.2467637036800797
0.0 195.0 0.43531750893288235
0.0 196.0 0.3893599780473012
0.0 197.0 0.3220816458659573
0.0 198.0 0.25389713892289173
0.0 199.0 0.22935136709597423
1.0 0.0 0.23021155472288352
1.0 1.0 0.33383157107150707
1.0 2.0 0.3745792715533692
1.0 3.0 2.028348052193793
1.0 4.0 2.4150235476868978
1.0 5.0 2.4169194327766736
1.0 6.0 1.8633442057577019
1.0 7.0 4.2682342944471054
1.0 8.0 3.22544345282322 
```

这是 JavaPlot 发送给 gnuplot 的命令：

```
set multiplot layout 1,2 rowsfirst downwards
_gnuplot_error = 1
plot '-' title 'Datafile 1' with image ; _gnuplot_error = 0
0.0 9.0 6.612583996900796 
1.0 9.0 4.719585678813712 
2.0 9.0 0.5475948495661151 
3.0 9.0 0.7385211622757041 
4.0 9.0 0.711512824841686 
5.0 9.0 3.7572382303712604 
6.0 9.0 1.0818137070547578 
7.0 9.0 0.057188125070687344 
8.0 9.0 0.8218555010675036 
9.0 9.0 5.754170136586405 
e
if (_gnuplot_error == 1) print '_ERROR_'
unset multiplot
quit 
```

对于这个例子，我取了 10x10 点，所以传递的坐标应该是这样的：

```
0.0 0.0 6.612583996900796 
0.0 1.0 4.719585678813712 
0.0 2.0 0.5475948495661151 
0.0 3.0 0.7385211622757041 
0.0 4.0 0.711512824841686 
0.0 5.0 3.7572382303712604 
0.0 6.0 1.0818137070547578 
0.0 7.0 0.057188125070687344 
0.0 8.0 0.8218555010675036 
0.0 9.0 5.754170136586405 
1.0 0.0 6.612583996900796 
1.0 1.0 4.719585678813712 
1.0 2.0 0.5475948495661151 
1.0 3.0 0.7385211622757041 
1.0 4.0 0.711512824841686 
1.0 5.0 3.7572382303712604 
1.0 6.0 1.0818137070547578 
1.0 7.0 0.057188125070687344 
1.0 8.0 0.8218555010675036 
1.0 9.0 5.754170136586405 
...
9.0 9.0 xxxxxxxxxxxxx 
```

似乎 JavaPlot 没有迭代 Y 坐标。

有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:25:23.453

您正在使用多大的数据集？

我在使用 JavaPlot 时注意到的一点是它真的不喜欢大型数据集。就像 JavaPlot 与 gnuplot 对话时出现了一个错误，并且每次绘制数据点时，它都有很小的机会发生故障。这不是少量数据的问题，但几乎不可能绘制更大的数据（> 1000）。看起来一行输入不正确，然后你得到的所有行都是这样的：

```
multiplot> 53.86510713480712 67.8601980449745 53.557782725560635 
       ^
       invalid command 
```

尝试使用较小的数据集，看看它是否有效。如果是这种情况，我知道处理它的唯一方法是分解您的数据集或尝试使用另一个包装库，如 jgnuplot--> [http://jgnuplot.sourceforge.net/](http://jgnuplot.sourceforge.net/)

另外，我注意到您从未说过您正在使用新图表。尝试添加更改为

```
JavaPlot plot = new JavaPlot();
plot.newGraph();  //added this line
plot.plot(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T20:44:35.670

由于我无法修复该错误，我最终决定调用 gnuplot 并自己正确传递分数。这是我用来绘制频谱图的一段代码：

```
Process p = Runtime.getRuntime().exec("gnuplot --persist");

BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(p.getOutputStream()));
String s = "plot '-' title 'Spectogram' w image\n";
writer.write(s);
writer.flush();

for(int m = 0; m < x.length; m++){
   for(int k = 0; k < x[0].length; k++){
       s = m + " " + k + " " + x[m][k] + "\n";
       writer.write(s);  
       writer.flush();
   }
}

s = "e\n";
writer.write(s);
writer.flush(); 
```

它有效！:D

# android - 将手机联系人与应用同步

> ID：11615282
> 
> 赞同：1
> 
> 时间：2012-07-23T15:08:00.627
> 
> 标签：android, contacts, sync, android-syncadapter, contentobserver

我想在我的应用程序中将电话联系人（姓名和电话号码）与我的 contentProviver“联系人”同步。所以我搜索并找到了两种方法：ContentOberver 和 SyncAdapter。

在我的情况下，我不需要与 Internt 连接，因此我只与我的应用程序的数据库同步。如果用户也删除了我想在我的数据库中删除的联系人，则更新或插入也是如此。

那么 ContentObserver 是这种情况下更好的方法吗？

有没有办法知道联系人的密钥？就像 db 中一行的键一样。如果是，我可以经常更新我的数据库（用户可以选择时间）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T17:07:58.267

如果要添加标记为应用程序联系人的联系人，则需要同步适配器。如果您不添加同步适配器，则不会显示联系人。添加同步适配器时，您还需要一个身份验证器。您可以使用一个虚拟身份验证器，它始终添加相同的用户，而无需向用户询问任何内容。您需要考虑的是，如果没有互联网连接，同步适配器将永远不会被触发。因此，您需要在数据发生变化时手动触发同步。

为了做类似于你描述的事情，我开发了一个同步适配器，一个我也直接触发的同步器和一个 ContentObserver 以了解例如用户何时删除本机地址簿中的联系人。

如果您的同步是一种方式，仅意味着您不需要从应用程序插入/修改，则不需要同步适配器。

# blackberry - 黑莓截图图像文件保存后不显示

> ID：11615284
> 
> 赞同：0
> 
> 时间：2012-07-23T15:08:05.720
> 
> 标签：blackberry, screenshot

我正在开发一个应用程序，它需要在某个时刻截取屏幕截图并将其保存在文件系统中。我的问题是，在设备重置之前，图像在文件资源管理器中不可见，并且在某些型号中，图像甚至不显示，它只是一个不可读的 img 文件（如曲线）。

我拍摄图像的代码是：

```
private Bitmap getScreenShot(){
    Bitmap bitmap;
    bitmap = new Bitmap(Display.getWidth(), Display.getHeight());
    Display.screenshot(bitmap);
    // return the screen shot
    return bitmap;
}

private void saveInMemory(){
    Bitmap screenShot = getScreenShot();

    Date dateNow = new Date ();

    SimpleDateFormat dateformatYYYYMMDD = new SimpleDateFormat("yyyyMMddHHmmss");

    String timeStamp = dateformatYYYYMMDD.format(dateNow);

    String mFileName = System.getProperty("fileconn.dir.photos")
                + "RM_" + timeStamp + ".jpg";

    PNGEncodedImage png = PNGEncodedImage.encode(screenShot);

    writeFile(png.getData(), mFileName);

}

private void writeFile(byte[] data, String fileName) {
    FileConnection fconn = null;
    try {
        fconn = (FileConnection) Connector.open(fileName);
    } catch (IOException e) {
        System.out.print("Error opening file");
    }

    if (fconn.exists()){
        try {
            fconn.delete();
        } catch (IOException e) {
            System.out.print("Error deleting file");
        }
    }

    try {
        fconn.create();
    } catch (IOException e) {
        System.out.print("Error creating file");
    }
    OutputStream out = null;

    try {
        out = fconn.openOutputStream();
    } catch (IOException e) {
        System.out.print("Error opening output stream");
    }

    try {
        out.write(data);
    } catch (IOException e) {
        System.out.print("Error writing to output stream");
    }

    try {
        fconn.close();
    } catch (IOException e) {
        System.out.print("Error closing file");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:09:43.630

我没有尝试。但是为什么要为 png 文件生成 .jpg 扩展名呢？

正确答案是：输出流没有正确关闭。

# c++ - 我有一个过程，我相信它可能会被抢占。我怎样才能知道是什么干扰了它？

> ID：11615285
> 
> 赞同：0
> 
> 时间：2012-07-23T15:08:05.917
> 
> 标签：c++, linux, operating-system, scheduling, interrupt

一个小型 c++ 程序，它只执行以下操作：

```
struct bat
{
    const char* a;
    const char* b;
    void*       v;
};

struct rat
{
    rat()
        : 
          isOn(true),
          bats(),
          batscounter(0) {}

    uint64_t
    update()
        {
            uint64_t start = rdtsc();
            if (!isOn)
                return;

            bat& b = bats[batscounter];
            batscounter = (++batscounter % 10);
            b.v = this;
            b.a = "aname";
            b.b = "bname";
            return (rdtsc() - start);
        }

    bool isOn;
    bat bats[10];
    size_t batscounter;
}; 
```

循环它并检查来自 rdtsc 的时间戳，我看到平均 20 个周期，但很多时候我看到超过 20K 个周期（每秒）的峰值。该方法每秒被调用约 70M 次。我在一个空主机上运行它`ulimit -r 99`，我什至为进程设置了关联掩码，`1`以查看是否有帮助，但没有。启用这些设置可能会导致这种情况，我还有哪些其他方法可以防止这种情况发生？

# php - SoapClient 不遵守 no_proxy 排除项

> ID：11615294
> 
> 赞同：0
> 
> 时间：2012-07-23T15:08:46.297
> 
> 标签：php, linux, soap, proxy

以 wsdl 模式运行的 SoapClient 不支持 OS 代理排除，并且似乎没有直接添加它们的标志。

当模式定义同时引用内部和外部定义的模式时，这会造成困难。对于测试，我已将初始 wsdl 文档拉到本地。我已启用代理，因为架构引用 w3.org 和其他一些基于 Internet 的架构定义。问题是本地文档仍然引用代理内部和外部的资源，一旦我启用代理，它希望通过它发送每个请求。

我有以下代码：

```
$client = new SoapClient('SomeResource.wsdl',array(
    'proxy_host'=>'10.0.0.1',
    'proxy_port'=>8080,
    'soap_version'=>SOAP_1_1,
    'exceptions'=>true,
    'trace'=>1,
    'cache_wsdl'=>WSDL_CACHE_NONE,
    'login'=>'username',
    'password'=>'password'
)); 
```

运行 strace：

```
stat("http://localresource.localdomain.com:1080/some/version/Common.xsd", 0x7fffd94a36d0) = -1 ENOENT (No such file or directory)
socket(PF_INET, SOCK_STREAM, IPPROTO_IP) = 7
fcntl(7, F_GETFL)                       = 0x2 (flags O_RDWR)
fcntl(7, F_SETFL, O_RDWR|O_NONBLOCK)    = 0
connect(7, {sa_family=AF_INET, sin_port=htons(8080), sin_addr=inet_addr("10.0.0.1")}, 16) = -1 EINPROGRESS (Operation now in progress)
... timeout here cause it's a local resource ... 
```

我当然更改了名称以保护我的客户，但我的 no_proxy 列表中确实有 localdomain.com：

```
somehost:someuser> env |grep proxy
http_proxy=http://10.0.0.1:8080
ftp_proxy=http://10.0.0.1:8080
https_proxy=http://10.0.0.1:8080
no_proxy=localdomain.com,localhost,127.0.0.1 
```

向 SoapClient 输入添加 no_proxy 无效。

没有提取所有内部架构并修改所有这些引用以也指向本地定义的资源，有没有办法让 SoapClient 遵守 no_proxy 规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T00:50:29.810

我最终将所有架构拉到内部并修改所有这些架构以也指向本地定义的架构。

# java - 重绘 SWT 动态对象

> ID：11615295
> 
> 赞同：0
> 
> 时间：2012-07-23T15:08:55.050
> 
> 标签：java, swt, composite, redraw, mouse-listeners

晚上好。我创建了 SWT 应用程序，它包含带有两个元素的 shell：ExpandBar 和 Button。在应用程序启动时，ExpandBar 的所有项目都被展开并且 Button 在 ExpandBar 下。我想做以下事情：通过按钮的单击折叠所有 ExpandBar 的项目，并在此操作后重绘复合。

我希望，重绘后的那个按钮发生在折叠的 ExpandBar 的正下方，但是 Button 以另一种方式思考并且不会改变它的位置。一件更有趣的事情是，在第二次单击 Button 后，所有元素的行为都变得正确。

我的源代码如下所示：

```
final ExpandBar bar = new ExpandBar (shell, SWT.NONE);
bar.setLayoutData(new RowData());

Button redraw = new Button(shell,SWT.PUSH);
redraw.setText("redraw");
redraw.setLayoutData(new RowData());

redraw.addSelectionListener(new SelectionListener() {

    @Override
    public void widgetSelected(SelectionEvent e) {
        shell.layout(true,true);
        Display.getCurrent().update();

        for (ExpandItem item: bar.getItems())
        {
            item.setExpanded(false);

        }
        bar.redraw();
        bar.update();
        bar.layout(true,true);
        shell.layout(true,true);
        Display.getCurrent().update();
    } 
}); 
```

第一次点击后如何重绘合成？

# accelerometer - 加速度计不工作

> ID：11615297
> 
> 赞同：1
> 
> 时间：2012-07-23T15:09:00.453
> 
> 标签：accelerometer, cmmotionmanager

我已经阅读了 Apple 关于 CMMotion 的文档，并且为了 NSLog 加速度计数据需要做的所有事情似乎都是在我的应用程序中完成的。但是，当我运行我的应用程序并翻转屏幕时，加速度计没有返回任何数据。我没有运行时错误。这是我的代码：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    ad = [[CMMotionManager alloc] init];
    //[ad startDeviceMotionUpdates];
    [ad startAccelerometerUpdates];

    //Returns Null
    NSLog(@"Accelerometer Data %@", ad.accelerometerData);

    BOOL accelerometerAvailable = ad.isAccelerometerAvailable?YES:NO;

    // Returns false, else statement is logged
    if(accelerometerAvailable) {
    NSLog(@"I guess it is...");
    } else {
    NSLog(@"I guess it is not...");
      }

    [ad startAccelerometerUpdatesToQueue:[NSOperationQueue currentQueue]     withHandler:^(CMAccelerometerData *accelerometerData, NSError *error) {
    NSLog(@"Your accelerometer data is: %@", accelerometerData.acceleration);
}];

 } 
```

我尝试将此代码添加到我的另一个应用程序中，该应用程序按时间间隔返回数据，以确保我没有获取数据的原因是因为 viewDidLoad 只调用了一次。我还是一无所获。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T23:13:03.253

我的错误在这里。这个问题源于我使用 iOS 模拟器运行我的应用程序。显然，加速度计在其中不起作用。我假设因为抖动和旋转事件是允许的，所以它们适用于加速度计。但是，它们仅用于屏幕的重新定位，与加速度计无关。如果 Apple 将其包含在其文档中，将会有所帮助。

# java - 使用 Mockito 模拟 Spring 的 jdbc KeyHolder

> ID：11615298
> 
> 赞同：0
> 
> 时间：2012-07-23T15:09:05.890
> 
> 标签：java, spring, mockito

我需要你的帮助来解决一个问题。我的 DAO 类中有这样的方法可以保存角色：

```
@Repository(value="jdbcRoleDAO")
@Transactional(propagation=Propagation.SUPPORTS, readOnly=true, rollbackFor=Exception.class)
public class JdbcRoleDAO implements RoleDAO {

    @Autowired
    private JdbcTemplate jdbcTemplate;

    @Autowired
    private DBLogger<Role> dbLogger;

    /**
     * @throws DublicateEntryException if object with specified unique for application field already 
     *              exists in DB.
     */
    @CacheEvict(value = "roles", allEntries = true)
    @Transactional(propagation=Propagation.REQUIRED, readOnly=false, rollbackFor=Exception.class)
    @Override
    public Role save(final Role role) {

        if (this.getRoleByName(role.getName()) != null) {
            throw new DublicateEntryException("Record with specified role name already exists in application.");
        }

        KeyHolder keyHolder = new GeneratedKeyHolder();
        jdbcTemplate.update(new PreparedStatementCreator() {

            @Override
            public PreparedStatement createPreparedStatement(Connection connection)
                    throws SQLException {

                PreparedStatement ps = connection.prepareStatement(SQL_INSERT_ROLE, new String[]{"ID"});

                ps.setString(1, role.getName());
                ps.setString(2, role.getDesription());
                ps.setObject(3, (role.getParentRole()!=null)?role.getParentRole().getId():null);
                ps.setString(4, role.getPrivilege().toString());

                return ps;
            }
        }, keyHolder);

        Long key = (Long) keyHolder.getKey();
        if (key != null) {
            role.setId(key);
        } else {
            role.setId(-1);
        }

        // Add information about operation to log table
        dbLogger.logBasicOperation(role, OperationName.CREATE);

        return role;
    }
...
} 
```

我想使用 Mockito 为这个方法编写单元测试。现在它看起来像：

```
@RunWith(MockitoJUnitRunner.class)
public class JdbcRoleDAOTest {

    private static final long TEST_ROLE_ID = 1L;
    private static final int TEST_ROLE_VERSION = 7;

    @Mock
    private DBLogger<Role> dbLogger;

    @Mock
    private JdbcTemplate jdbcTemplate;

    @InjectMocks
    private JdbcRoleDAO roleDAO;

    /**
     * test role that is used in all methods.
     */
    private Role role;

    @Before
    public void setUp(){
        // Create a test role object
        role = new Role();
        role.setId(TEST_ROLE_ID);
        role.setName("TEST");
        role.setDesription("Test role");
        role.setPrivilege(Privilege.DEFAULT);
        role.setVersion(TEST_ROLE_VERSION);

        // Return correct version of the object
        Mockito.when(jdbcTemplate.queryForInt(JdbcRoleDAO.SQL_GET_VERSION, TEST_ROLE_ID))
            .thenReturn(TEST_ROLE_VERSION);
    }

    @Test
    public void testSave() {
        Assert.assertNotNull(role);

        roleDAO.save(role);

        InOrder inOrder = Mockito.inOrder(jdbcTemplate, dbLogger);

        // Verify execution of the conditions.
        inOrder.verify(jdbcTemplate, Mockito.times(1)).update(Mockito.any(PreparedStatementCreator.class), 
                Mockito.any(KeyHolder.class));

        inOrder.verify(dbLogger, Mockito.times(1)).logBasicOperation(role, OperationName.CREATE);

        /* 
         * Expected -1 because I can't mock KeyHolder and should be returned -1 value (because 
         * KeyHolder will return null instead of key)
         */ 
        Assert.assertEquals("Generated id is wrong!", -1, role.getId());
    }
…
} 
```

问题在于我想以某种方式模拟 KeyHolder 但我不知道如何更好地做到这一点。如您所见，现在 KeyHolder 实例是在 save 方法中创建的，这是一个主要困难。我曾考虑过使用 Spring 以“原型”作用域注入 KeyHolder，但据我了解，当很少有用户同时尝试保存新角色时，这可能会导致问题。我也尝试做这样的事情：

```
Mockito.when(jdbcTemplate.update(Mockito.any(PreparedStatementCreator.class), 
                Mockito.any(KeyHolder.class)))
                .thenAnswer(new Answer<Void>() {

                    @Override
                    public Void answer(InvocationOnMock invocation)
                            throws Throwable {

                        Object[] arguments = invocation.getArguments();
                        for (int i=0; i<arguments.length; i++) {
                            if (arguments[i] instanceof KeyHolder) {
                                KeyHolder keyHolder = (KeyHolder) arguments[i];

                                KeyHolder spyKeyHolder = Mockito.spy(keyHolder);
                                Mockito.when(spyKeyHolder.getKey()).thenReturn(TEST_GENERATED_ID);
                                Mockito.doReturn(TEST_GENERATED_ID).when(spyKeyHolder).getKey();
                            }
                        }

                        return null;
                    }
                }); 
```

但这不起作用。可能有人可以给我一个建议，如何模拟（或监视）KeyHolder 而不将其从保存方法中移出？Mockito 中是否有一些功能可以使这成为可能？或者这是不可能的？

先感谢您

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:44:42.583

您可以创建以下界面：

```
public interface KeyHolderFactory {
     KeyHolder newKeyHolder();
} 
```

然后`KeyHolderFactory`在你的 , 中添加一个字段`JdbcRoleDAO`，通过生产中的依赖注入填充，并在测试时手动使用模拟。生产实现很简单，您可以使用它的单个实例（单例）：

```
public class GeneratedKeyHolderFactory implements KeyHolderFactory {
     public KeyHolder newKeyHolder() {
         return new GeneratedKeyHolder();
     }
} 
```

在您将拥有的方法内

```
...
KeyHolder keyHolder = factory.newKeyHolder();
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:20:13.627

如果您可以切换到[PowerMock](http://code.google.com/p/powermock/)，您也可以模拟构造函数，然后您可以模拟 GeneratedKeyHolder 构造函数以返回模拟 KeyHolder

# c++ - 存储向量的准确记忆图像

> ID：11615302
> 
> 赞同：0
> 
> 时间：2012-07-23T15:09:15.047
> 
> 标签：c++, parsing, optimization

在我当前的应用程序中，我需要按照 AI 社区中众所周知的基于实例的学习范式创建一个基于案例的存储库。

基于案例的存储库需要在对应用程序的两次调用之间持久存储。

但是我担心由此隐含的序列化/反序列化（可能是 JSON 或键值对的轻量级格式）会产生如此多的 I/O 开销，以至于编写一个好的索引机制（它在 in-案例库的内存描述）只会加速一小部分，因此没有实质性的好处。

现在我认为有两种解决方案

a) 尝试直接对文件进行索引，同时执行 I/O 和索引。

b）以某种方式将案例库的内存中表示的内存图像保存到文件中，以便“文件解析”然后简化为简单的 memcpy（包括内存映射文件）。请注意，文件格式是二进制的，而不是基于 a) 中的 UTF-8。

有没有人遇到过类似的问题并尝试过 b) 的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:17:09.320

您是否考虑过[内存映射文件](http://en.wikipedia.org/wiki/Memory-mapped_file)？

# php - mysql_query 更新

> ID：11615303
> 
> 赞同：5
> 
> 时间：2012-07-23T15:09:15.983
> 
> 标签：php, mysql, session

我有一个脚本，当用户在某些条件下点击“拒绝”按钮时运行。当它运行时，它应该撤销对特定区域的访问权限，由于某种原因，该脚本不起作用——因为它不会更新 MYSQL DB，也不会出现错误。

```
$username =  $_SESSION["USER"]["Username"]; 

mysql_connect("x", "y", "z") or die(mysql_error()); 
mysql_select_db("database") or die(mysql_error()); 
mysql_query("UPDATE `users` SET `SeceretArea`='Unauth' WHERE `Username`='$username'") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:16:43.797

**答案已更新以总结调试过程。**

如果没有错误，那么数据库条目没有发生的原因有三种可能性：

*   表中没有`USERNAME`列等于的条目`$database`。
*   没有值被传递给`$database`。
*   有一个值被传递给`$database`，但该值没有被替换到查询中。

根据我的个人经验，`mysql_query()`在执行查询之前不一定要替换变量值。首先将查询字符串创建到一个变量中，然后将其传递给`mysql_query()`. 您当前的设置不会替换`$username`为它的值。你可以做的是：

```
...
$sql = "UPDATE `users` SET `SeceretArea`='Unauth' WHERE `Username`='$username'";
mysql_query($sql) or die(mysql_error()); 
```

除此之外，请检查您的表格以确保有一行具有您想要的值`USERNAME`。`var_dump()`你`$username`看看它是否是你想要的价值。

此外，您真的应该考虑切换到`mysqli`或`PDO`。如果您不想迁移到目标模块，可以使用`mysqli`'s 过程函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:14:06.693

您需要确保`session_start();`在脚本顶部调用。没有它，您的`$username`变量将永远不会被设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:24:45.450

确保**$username**带有您传递的会话值。

```
echo "$username"; 
```

只有在你得到正确的情况下才能继续查询。

此外，请确保表的字段名称正确。我注意到**SecretArea**可能是您表中的**SecretArea 。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:25:18.477

只是一些想法：

*   `UserName`数据库中是否有与您在 WHEREing的确切值相符的条目？
*   您是否在未提交的事务中？
*   您的 SQL 语句是否会干扰另一个同名表？

# java - 无法将字符串替换为另一个（布尔值）-Java

> ID：11615305
> 
> 赞同：1
> 
> 时间：2012-07-23T15:09:18.433
> 
> 标签：java, string, boolean, replaceall

```
boolean b1 = false;
boolean b2 = true;

String s = new String(b1+""+b2);

s.replaceAll("false", "f");
s.replaceAll("true", "t"); 
```

什么都没有被替换。我仍然得到“假真”。我想将字符串的所有“false”和“true”替换为“f”和“t”。

我很确定我没有以正确的方式做这件事，这就是为什么我需要你的帮助，我们将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T15:09:44.713

字符串是不可变的。当您对字符串执行任何操作时，它会创建新字符串。您需要再次将结果分配给参考

它应该是这样的 `s = s.replaceAll("false", "f");`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T15:14:47.460

Java中的String是不可变的，这意味着String对象的值一旦创建就不会改变。

因此，方法 replaceAll()（或 String 类中的几乎所有其他方法）旨在返回一个新字符串，而不是修改旧字符串。

所以调用应该是

```
s = s.replaceAll("false", "f"); 
```

更多关于不变性的[信息在这里](http://en.wikipedia.org/wiki/Immutable_object#Java)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-23T15:10:38.993

当您调用.replaceAll("false", "f") 时，您实际上并没有改变字符串。您需要将该值分配给 s ，如下所示：

```
s = s.replaceAll("false", "f"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-23T15:12:40.960

```
System.out.println(s.replaceAll("false", "f ").replaceAll("true", "t ")); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-23T15:14:38.820

你需要这样写：

```
 s =  s.replaceAll("false", "f");
 s =  s.replaceAll("true", "t"); 
```

字符串是不可变的，因此一旦您声明它们，它们就无法更改。调用它`s.replaceAll("false", "f");`会创建一个新的字符串对象，`"f"`而不是`"false"`。由于您没有将这个新对象分配给变量，因此新字符串基本上丢失了，而您的左边是原始字符串。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-23T15:24:51.910

首先，你需要意识到它`String`是不可变的。这意味着它的内容不能改变。为了获得 replaceAll() 方法的结果，您需要将返回值分配给 a `String`。

# jquery - 如何让 TinyMCE 在 Firefox 的 jQuery 对话框中工作？

> ID：11615306
> 
> 赞同：1
> 
> 时间：2012-07-23T15:09:22.373
> 
> 标签：jquery, tinymce, jquery-ui-dialog, jquery-dialog

我需要一个在 jquery 对话框中工作的 tinymce 编辑器。在正常情况下，tinymce 编辑器不会在不可见的对话框中处于活动状态和可用状态。当对话框可见时，需要重新初始化 tinymce 控件。（基于[http://www.tinymce.com/forum/viewtopic.php?id=12338](http://www.tinymce.com/forum/viewtopic.php?id=12338)）

提出的解决方案是在适当的地方调用以下 tinymce 命令，`tinyMCE.execCommand('mceRemoveControl',false,'txt_notesone')`并且`tinyMCE.execCommand('mceAddControl',false,'txt_notesone')`

我已将这些添加到 jquery 对话框的`create`事件`open`处理程序中。这在 IE 和 Chrome 中运行良好，但在 Firefox (14) 中似乎不起作用。

你可以在这里找到 jsfiddle：http: [//jsfiddle.net/kfBNg/6/](http://jsfiddle.net/kfBNg/6/)

有任何想法吗？

# django - Django 1.4 - 在管理页面中将 ImageField 显示为缩略图

> ID：11615313
> 
> 赞同：1
> 
> 时间：2012-07-23T15:09:45.813
> 
> 标签：django

我怎样才能做到这一点？我需要在列表显示中显示图像而不是 Django Admin 中的图像 url。

以前有人做过吗？有什么帮助吗？

一直在寻找过去一个小时没有解决方案，我也是 Django 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:18:40.370

django-filer 可能是您正在寻找的。

![截屏](../Images/76c6a2a35017562416c1f66781b4bc30.png)

*   Github：[https ://github.com/stefanfoulis/django-filer/](https://github.com/stefanfoulis/django-filer/)
*   文档：[http ://django-filer.readthedocs.org/](http://django-filer.readthedocs.org/)

（虽然我不确定这是否也适用于列表视图......）

# java - 模式和匹配：格式化文本文件

> ID：11615318
> 
> 赞同：1
> 
> 时间：2012-07-23T15:10:09.423
> 
> 标签：java, regex, io

我正在尝试获取如下所示的输入文件：

SomeElement1|SomeElementWithDifferentLength2|SomeElement3|AnElementI'llIgnore4|Something5| 元素1|不同长度2|元素3|一个元素我将忽略4|元素5|

并将其格式化为具有特定间距的列。我对 java 很陌生，并且来自 C++ 背景。无论如何，我正在研究用正则表达式建立一个模式，然后寻找匹配项。我不确定正则表达式中识别特定字符（管道“|”）的语法是什么，所以我可以确定模式。

这似乎是一个好方法，如果是这样，Pattern.compile("Regex syntax") 的语法是什么，我将如何确定与它的匹配？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:17:24.380

我认为最简单的事情是：

1.  使用 String.split("|") 将每一行变成一个数组

2.  使用每列的长度创建一个整数数组

3.  创建一个 StringBuilder 来保存重新格式化的行

4.  从第 1 行开始循环遍历数组，将每个字符串填充到第 2 行中数组的长度，然后将其附加到 StringBuilder。

如果字段可能具有嵌入式管道，因此您必须有一些机制来转义它们，那么您必须编写代码来自己解析列，而不是 split()。我想你可以为此编写一个正则表达式，但我认为这比循环遍历寻找管道的字符更有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:15:30.310

为什么不简单地使用 [String.split()](http://www.java-examples.com/java-string-split-example)？例如

```
String[] res = line.split("\\|"); 
```

（请注意，该`split()`方法采用正则表达式，因此您必须转义管道）。

然后，您可以遍历结果数组并使用[String.format()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29)输出填充/格式化等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:19:56.823

如果您可以将文件内容作为字符串读取，则可以执行以下任何操作：

*   直接替换“|” 有一定数量的空格：`stringContents.replaceAll("\\|", " ")`

*   在“|”处拆分字符串：`stringContents.split("\\|");`

请记住，“|” 是正则表达式中的特殊字符，被解释为“或”运算，这就是为什么它需要用反斜杠（即两个反斜杠）转义的原因

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:21:12.287

不要重新发明轮子。使用 Apache [Commons Lang](http://commons.apache.org/lang/)并检查 StringUtils。

我假设您想要固定长度的列；该库提供 leftPad() 或 rightPad() 方法以及一堆其他字符串操作。

简而言之：

1.  拆分使用`String.split()`
2.  遍历数组并使用重新格式化`StringUtils`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T15:17:25.760

您可以使用 String.split(String regex) 方法。

# tfs - 为 TFS 2010 创建备份计划每次都失败

> ID：11615322
> 
> 赞同：0
> 
> 时间：2012-07-23T15:10:33.950
> 
> 标签：tfs

这是我得到的错误的屏幕截图

![在此处输入图像描述](../Images/0b375f9efaa3d0c263fc6816260e69c3.png)

我采取的以下步骤仍然无法解决问题。

*   在备份计划的帐户部分，我尝试了网络服务和我的域帐户
*   在共享路径上，我已授予我的域用户帐户对共享路径的完全访问权限。
*   我也继续在同一条路径上为每个人提供完全权限 [只是为了测试]
*   我使用 sp_addrolemember 'db_backupoperator', 'MyDOMAIN\my.accountName' 为 SQL Server 备份提供了相同的域帐户权限
*   我去了 Build controller pc 并在 Start->Run 中输入了共享路径的地址并尝试手动创建一个文件夹和一个文本文件，我能够创建文件夹并编辑文本文件。
*   我将共享路径更改为网络上的另一台电脑，并重复与上述相同的步骤，结果相同

打开日志文件时，我看到以下内容

[片段]

--- 内部异常堆栈跟踪结束 --- 在 Microsoft.TeamFoundation.PowerTools.Admin.Helpers.BackupFactory.TestBackupCreation（字符串路径）的 Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv) [错误@08 ：43：52.062]！验证错误！：帐户“MyDOMAIN\my.accountName”无法**使用路径 \XXXXX\DailyBackups** [Info @08:43:52.062]“验证：授予备份计划权限\Root\VerifyDummyBackupCreation（VerifyTestBackupCreatedSuccessfully ): 退出验证，状态为 Completed，结果错误”[Info @08:43:52.062]！验证结果！：4 完成，0 跳过：3 成功，1 错误，0 警告

[结束片段]

该路径与我输入的路径不同。**它仍然指向**我在将 UNC 更改为另一台电脑之前输入的旧路径。日志文件中报告的路径与上面屏幕截图中的路径不同。到底是怎么回事？

请帮我为 TFS 2010 创建一个备份计划。感谢您抽出宝贵时间...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T12:05:12.553

我有相同的症状并找到了解决方法。

我使用的是具有所有必要权限的域管理员帐户。我的 SQL 实例帐户也具有所有必需的权限，但 TFS 备份向导一直说我没有必要的权限。

**!验证错误！：帐户 XXXXXX 无法使用路径 \XXX\TFS Backups\NightlyPlan 创建备份**

向导日志也不是很有帮助，所以我四处挖掘并在一般日志中发现了错误：

[错误@11:49:18.206] Microsoft.SqlServer.Management.Smo.FailedOperationException：服务器“TFS-01”的备份失败。---> Microsoft.SqlServer.Management.Common.ExecutionFailureException：执行 Transact-SQL 语句或批处理时发生异常。---> System.Data.SqlClient.SqlException: 无法打开备份设备**'\XXX\TFS\temp_20130422124916.bak'**。操作系统错误 67（无法检索此错误的文本。原因：15105）。BACKUP DATABASE 异常终止。

所以你可以看到错误是因为我在共享名称中有一个空格：“TFS Backups”这被截断为“TFS”。

我将共享更改为“TFSBackups”，一切都开始起作用了。

大声笑@MS工程师-我仍然本能地在文件夹名称中省略空格（记住短文件名），但我认为现在这只是一个我可以放弃的古老迷信。傻我。

亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-10T11:47:36.270

如果您正在更改备份计划并且它给您一个错误，请执行这些简单的步骤。

1.  转到“C:\ProgramData\Microsoft\Team Foundation\Server 配置”
2.  在编辑器或记事本中打开 ConfigPT.xml 文件。
3.  更改您的备份目的地`<BackupPath>\\192.168.0.1\TFS001\daily\</BackupPath>`。

就这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T20:01:18.087

您在运行向导时登录的帐户需要适当的权限才能从备份共享中读取/写入，*并*授予其他帐户执行相同操作的权限。

# .net - 出于什么原因有人会在 .Net 中创建自定义集合或字典类

> ID：11615327
> 
> 赞同：1
> 
> 时间：2012-07-23T15:10:55.190
> 
> 标签：.net, collections

我最近一直在从事一个涉及很多列表类的项目，我发现自己想知道，这些天在什么情况下（如果有的话）适合创建自定义集合/字典实现？随着泛型的引入，List 和 Dictionary（或队列、堆栈等）不会在 99% 的时间里完成人们需要的所有事情吗？如果没有，您难道不想从这些现有类之一继承吗？此时滚动您自己的实现有什么好处？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:18:21.563

我在尝试编写一个针对多个框架（*包括*1.1）的库时这样做了——所以泛型不是一个选项，而 ArrayList 等不是选项，因为它们在 Silverlight 上不存在。因此我需要一个自定义集合。

其他场景涉及有限/不同的变异操作，即不是通常的添加/删除等。

# c# - 在 WPF 中将命令绑定到 ComboBoxItem

> ID：11615334
> 
> 赞同：6
> 
> 时间：2012-07-23T15:11:19.023
> 
> 标签：c#, wpf, combobox

我有一个简单的 ComboBox，我想在每次所选值更改时触发单独的命令。这是我的标记示例：

```
<WrapPanel Grid.Row="0" Visibility="{Binding ShowToggleViewFeedViewManual}">
    <ComboBox Margin="3,3,0,0">
        <ComboBoxItem IsEnabled="{Binding CanSelectViewFeedData}" >
            <ComboBoxItem.CommandBindings>
                <CommandBinding Command="SelectViewFeedDataCommand" />
            </ComboBoxItem.CommandBindings>
            <TextBlock Text="View Feed Data"/>
        </ComboBoxItem>
        <ComboBoxItem IsEnabled="{Binding CanSelectViewManualData}">
            <ComboBoxItem.CommandBindings>
                <CommandBinding Command="SelectManualFeedDataCommand" />
            </ComboBoxItem.CommandBindings>
            <TextBlock Text="View Manual Data"/>
        </ComboBoxItem>
    </ComboBox>
</WrapPanel> 
```

我收到一条错误消息，指出“*无法转换 'SelectViewFeedDataCommand'* ”。我也收到其他 ComboBoxItem 的类似错误。ICommand 在 ViewModel 类中定义，该类是 UserControl 的 DataSource，绑定为 DataTemplate。

```
public ICommand SelectViewFeedDataCommand
{
    get
    {
        // Code to perform
    }
} 
```

我对此进行了广泛的研究，但没有找到如何有效地将 ICommand 绑定到 ComboBoxItem 的答案。

我正在从使用一组单选按钮和相关命令的现有代码中调整它，这很容易完成。有没有简单的方法可以用 ComboBox 做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:15:31.150

您是否尝试过将命令绑定？

```
<CommandBinding Command="{Binding SelectManualFeedDataCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}" /> 
```

编辑更新策略：

由于 ComboBox 项不支持直接命令绑定，请尝试创建附加属性：

[关联](http://johnllao.wordpress.com/2009/07/21/attached-property-sample/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-16T16:44:07.590

我正在查看我的旧帖子并意识到我从未发布过我的问题的解决方案......真的很简单（如果不优雅的话）。我刚刚在我的 ViewModel 中创建了一个包含我的组合框“选择”的列表，然后当 SelectedValue 发生更改时，在属性的设置器中触发了我的“更改”逻辑：

```
<WrapPanel Grid.Row="0" Visibility="{Binding ShowToggleFeedViewManual}" >
    <ComboBox Margin="10,10,10,10" Width="200" ItemsSource="{Binding AvailableDataSources}" SelectedValue="{Binding SelectedDataSource}"/>
</WrapPanel> 
```

从视图模型：

```
public FeedSource SelectedDataSource
    {
        get { return _selectedDataSource; }
        set
        {
            _selectedDataSource = value;
            base.OnPropertyChanged("SelectedDataSource");

            //additional code to perform here

        }
    } 
```

# delphi - 是否可以将历史列表下拉列表添加到 Delphi 的 TButtonedEdit？

> ID：11615336
> 
> 赞同：4
> 
> 时间：2012-07-23T15:11:19.400
> 
> 标签：delphi, delphi-xe2, tbuttonededit, tcombobox

我正在使用 Delphi XE2 的 TButtonedEdit，但我想为历史添加一个下拉列表（如 TComboBox）。我知道 TComboBox 是一个美化的 TEdit，所以我可以发送一条消息给 TButtonedEdit 以添加此功能吗？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-23T18:14:05.060

您可以使用该[`IAutoComplete2`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776288%28v=vs.85%29.aspx)界面来完成此任务。

[根据Ken White的这个答案（](https://stackoverflow.com/users/62576/ken-white) [Auto append/complete from text file to an edit box delphi](https://stackoverflow.com/questions/5465590/auto-append-complete-from-text-file-to-an-edit-box-delphi)）检查此示例代码（适用于[`TButtonedEdit`](http://docwiki.embarcadero.com/Libraries/en/Vcl.ExtCtrls.TButtonedEdit)和 Delphi XE2）

```
uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls,  Vcl.ExtCtrls, Winapi.ActiveX,  Winapi.ShlObj,
  Vcl.Mask, Vcl.ImgList;

type
  IACList = interface(IUnknown)
  ['{77A130B0-94FD-11D0-A544-00C04FD7d062}']
    function Expand(pszExpand : POLESTR) : HResult; stdcall;
  end;

const
  //options for IACList2
  ACLO_NONE = 0;          // don't enumerate anything
  ACLO_CURRENTDIR = 1;    // enumerate current directory
  ACLO_MYCOMPUTER = 2;    // enumerate MyComputer
  ACLO_DESKTOP = 4;       // enumerate Desktop Folder
  ACLO_FAVORITES = 8;     // enumerate Favorites Folder
  ACLO_FILESYSONLY = 16;  // enumerate only the file system

type
  IACList2 = interface(IACList)
  ['{470141a0-5186-11d2-bbb6-0060977b464c}']
    function SetOptions(dwFlag: DWORD): HResult; stdcall;
    function GetOptions(var pdwFlag: DWORD): HResult; stdcall;
  end;

  IAutoComplete = interface(IUnknown)
  ['{00bb2762-6a77-11d0-a535-00c04fd7d062}']
    function Init(hwndEdit: HWND; const punkACL: IUnknown;
      pwszRegKeyPath, pwszQuickComplete: POLESTR): HResult; stdcall;
    function Enable(fEnable: BOOL): HResult; stdcall;
  end;

const
  //options for IAutoComplete2
  ACO_NONE = 0;
  ACO_AUTOSUGGEST = $1;
  ACO_AUTOAPPEND = $2;
  ACO_SEARCH = $4;
  ACO_FILTERPREFIXES = $8;
  ACO_USETAB = $10;
  ACO_UPDOWNKEYDROPSLIST = $20;
  ACO_RTLREADING = $40;

type
  IAutoComplete2 = interface(IAutoComplete)
  ['{EAC04BC0-3791-11d2-BB95-0060977B464C}']
    function SetOptions(dwFlag: DWORD): HResult; stdcall;
    function GetOptions(out pdwFlag: DWORD): HResult; stdcall;
  end;

  TEnumString = class(TInterfacedObject, IEnumString)
  private
    type
     TPointerList = array[0..0] of Pointer; //avoid bug of Classes.pas declaration TPointerList = array of Pointer;
    var
    FStrings: TStringList;
    FCurrIndex: integer;
  public
    //IEnumString
    function Next(celt: Longint; out elt;
        pceltFetched: PLongint): HResult; stdcall;
    function Skip(celt: Longint): HResult; stdcall;
    function Reset: HResult; stdcall;
    function Clone(out enm: IEnumString): HResult; stdcall;
    //VCL
    constructor Create;
    destructor Destroy;override;
  end;

  TACOption = (acAutoAppend, acAutoSuggest, acUseArrowKey);
  TACOptions = set of TACOption;

  TACSource = (acsList, acsHistory, acsMRU, acsShell);

  TButtonedEdit = class(Vcl.ExtCtrls.TButtonedEdit)
  private

    FACList: TEnumString;
    FAutoComplete: IAutoComplete;
    FACEnabled: boolean;
    FACOptions: TACOptions;
    FACSource: TACSource;
    function GetACStrings: TStringList;
    procedure SetACEnabled(const Value: boolean);
    procedure SetACOptions(const Value: TACOptions);
    procedure SetACSource(const Value: TACSource);
    procedure SetACStrings(const Value: TStringList);
  protected
    procedure CreateWnd; override;
    procedure DestroyWnd; override;
  public
    constructor Create(AOwner: TComponent); override;
    destructor Destroy; override;
  published
    property ACEnabled: boolean read FACEnabled write SetACEnabled;
    property ACOptions: TACOptions read FACOptions write SetACOptions;
    property ACSource: TACSource read FACSource write SetACSource;
    property ACStrings: TStringList read GetACStrings write SetACStrings;
  end;

  TForm1 = class(TForm)
    ButtonedEdit1: TButtonedEdit;
    ImageList1: TImageList;
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm5;

implementation

{$R *.dfm}

uses
  System.Win.ComObj;

procedure TForm1.FormCreate(Sender: TObject);
begin
  ButtonedEdit1.ACEnabled:=True;
  ButtonedEdit1.ACOptions:=[acAutoAppend, acAutoSuggest, acUseArrowKey];
  ButtonedEdit1.ACSource:=acsList;
  ButtonedEdit1.ACStrings.Add('string 1');
  ButtonedEdit1.ACStrings.Add('string 2');
  ButtonedEdit1.ACStrings.Add('string 3');
  ButtonedEdit1.ACStrings.Add('string 4');
end;

{ TEnumString }

function TEnumString.Clone(out enm: IEnumString): HResult;
begin
  Result := E_NOTIMPL;
  Pointer(enm) := nil;
end;

constructor TEnumString.Create;
begin
  inherited Create;
  FStrings := TStringList.Create;
  FCurrIndex := 0;
end;

destructor TEnumString.Destroy;
begin
  FStrings.Free;
  inherited;
end;

function TEnumString.Next(celt: Integer; out elt;
  pceltFetched: PLongint): HResult;
var
  I: Integer;
  wStr: WideString;
begin
  I := 0;
  while (I < celt) and (FCurrIndex < FStrings.Count) do
  begin
    wStr := FStrings[FCurrIndex];
    TPointerList(elt)[I] := CoTaskMemAlloc(2 * (Length(wStr) + 1));
    StringToWideChar(wStr, TPointerList(elt)[I], 2 * (Length(wStr) + 1));
    Inc(I);
    Inc(FCurrIndex);
  end;
  if pceltFetched <> nil then
    pceltFetched^ := I;
  if I = celt then
    Result := S_OK
  else
    Result := S_FALSE;
end;

function TEnumString.Reset: HResult;
begin
  FCurrIndex := 0;
  Result := S_OK;
end;

function TEnumString.Skip(celt: Integer): HResult;
begin
  if (FCurrIndex + celt) <= FStrings.Count then
  begin
    Inc(FCurrIndex, celt);
    Result := S_OK;
  end
  else
  begin
    FCurrIndex := FStrings.Count;
    Result := S_FALSE;
  end;
end;

{ TACEdit }

constructor TButtonedEdit.Create(AOwner: TComponent);
begin
  inherited;
  FACList := TEnumString.Create;
  FACEnabled := True;
  FACOptions := [acAutoAppend, acAutoSuggest, acUseArrowKey];
end;

procedure TButtonedEdit.CreateWnd;
var
  Dummy: IUnknown;
  Strings: IEnumString;
begin
  inherited;
  if HandleAllocated then
  begin
    try
      Dummy := CreateComObject(CLSID_AutoComplete);
      if (Dummy <> nil) and
         (Dummy.QueryInterface(IID_IAutoComplete, FAutoComplete) = S_OK) then
      begin
        case FACSource of
          acsHistory: Strings := CreateComObject(CLSID_ACLHistory) as
            IEnumString;
          acsMRU: Strings := CreateComObject(CLSID_ACLMRU) as
            IEnumString;
          acsShell: Strings := CreateComObject(CLSID_ACListISF) as
            IEnumString;
        else
          Strings := FACList as IEnumString;
        end;
        if S_OK = FAutoComplete.Init(Handle, Strings, nil, nil) then
        begin
          SetACEnabled(FACEnabled);
          SetACOptions(FACOptions);
        end;
      end;
    except
      //CLSID_IAutoComplete is not available
    end;
  end;
end;

destructor TButtonedEdit.Destroy;
begin
  FACList := nil;
  inherited;
end;

procedure TButtonedEdit.DestroyWnd;
begin
  if (FAutoComplete <> nil) then
  begin
    FAutoComplete.Enable(False);
    FAutoComplete := nil;
  end;
  inherited;
end;

function TButtonedEdit.GetACStrings: TStringList;
begin
  Result := FACList.FStrings;
end;

procedure TButtonedEdit.SetACEnabled(const Value: Boolean);
begin
  if (FAutoComplete <> nil) then
  begin
    FAutoComplete.Enable(FACEnabled);
  end;
  FACEnabled := Value;
end;

procedure TButtonedEdit.SetACOptions(const Value: TACOptions);
const
  Options : array[TACOption] of integer = (ACO_AUTOAPPEND,
                                           ACO_AUTOSUGGEST,
                                           ACO_UPDOWNKEYDROPSLIST);
var
  Option:TACOption;
  Opt: DWORD;
  AC2: IAutoComplete2;
begin
  if (FAutoComplete <> nil) then
  begin
    if S_OK = FAutoComplete.QueryInterface(IID_IAutoComplete2, AC2) then
    begin
      Opt := ACO_NONE;
      for Option := Low(Options) to High(Options) do
      begin
        if (Option in FACOptions) then
          Opt := Opt or DWORD(Options[Option]);
      end;
      AC2.SetOptions(Opt);
    end;
  end;
  FACOptions := Value;
end;

procedure TButtonedEdit.SetACSource(const Value: TACSource);
begin
  if FACSource <> Value then
  begin
    FACSource := Value;
    RecreateWnd;
  end;
end;

procedure TButtonedEdit.SetACStrings(const Value: TStringList);
begin
  if Value <> FACList.FStrings then
    FACList.FStrings.Assign(Value);
end;

end. 
```

这就是结果。

![在此处输入图像描述](../Images/fa62e4d150af7a17749d58a09abf7e29.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T17:34:22.047

我不知道 XE2 中的特定控件（我自己在 2007 年），但是，假设 Popup Menu 属性是您的控件中的一个，为什么不在表单上创建一个弹出菜单并将其分配给该属性呢？然后，当您浏览控件上的项目时，您可以使用通用的 onclick 处理程序将它们添加到弹出菜单中，以便根据需要重新加载先前的项目。

# lua - 如何使用 Lua 解压 .zip 文件？

> ID：11615340
> 
> 赞同：1
> 
> 时间：2012-07-23T15:11:31.193
> 
> 标签：lua, zip, extraction

如何在 Lua 中提取具有多个子目录的 .zip 文件？

是的，我知道[这一点](https://stackoverflow.com/questions/2829175/how-to-extract-files-from-a-zip-file-using-lua)，但我认为它不适用于多个子目录。我在 LuaZip 中看不到任何允许在 zip 文件内的目录中列出文件的功能。有什么建议吗？

我不知道目录（zip 内的）名称，所以我需要以某种方式列出它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T17:27:25.210

用 .打开 zip 后`zfile = zip.open('file.zip')`，用 . 扫描它`for member in zfile:files()`。`member`将包含 zip 中文件的完整路径，包括所有前导目录，用 . 分隔`/`。由您来解析它，在真实文件系统中创建目录并将文件提取到正确的位置。

如果您需要唯一目录列表，只需从所有成员中删除文件名并将剩余目录保存为表的键。

# java - 图像持有人甚至在加载图像之前就正确的纵横比（因此加载时内容没有变化）

> ID：11615341
> 
> 赞同：1
> 
> 时间：2012-07-23T15:11:39.143
> 
> 标签：java, android, xml

当用户点击列表中的一篇文章，被带到文章详情页面（普通的“阅读文章”类型页面），图片区域很小，然后，当图片加载时，它会弹出更大......就像 HTML 一样，如果您忘记指定高度和宽度。

我将原始图像的高度和宽度保留在我的 sqlite 数据库中。我可以使用此信息以某种方式提前设置比率，以便在页面加载时不会改变内容吗？

**注意：**我目前正在询问有关全角文章图像的最佳 XML 的另一个相关问题： [Photo: wrap_content, but max_width = layout width](https://stackoverflow.com/questions/11615167/photo-wrap-content-but-max-width-layout-width)

是否值得为这种事情弄乱代码，或者只是将其留给 XML 并接受内容转换？

我当前用于 imageView 的 XML：

```
 <ImageView
            android:id="@+id/article_photo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@color/super_light_gray"
            android:scaleType="centerCrop"
            android:contentDescription="@string/articlePhoto"
            android:cropToPadding="true"
            android:layout_marginBottom="20dp"
            android:padding="1dp"/> 
```

# c# - 为什么向字符串添加换行符会在 Interop.Word 中产生错误？

> ID：11615343
> 
> 赞同：2
> 
> 时间：2012-07-23T15:11:48.160
> 
> 标签：c#, ms-word, office-interop

此代码示例：

```
object miss = System.Reflection.Missing.Value;
object Visible = true;
Microsoft.Office.Interop.Word.Application WordApp = new Microsoft.Office.Interop.Word.Application();
Document report = WordApp.Documents.Add(ref miss, ref miss, ref miss, ref miss);

Paragraph para = report.Content.Paragraphs.Add(ref miss);
String prefix = "Prefix";
String suffix = "text after the colon";
String allText = prefix + ":" + suffix;
para.Range.Text = allText;
para.Range.Font.Bold = 0;
para.Range.Font.Size = 12;

Object start = para.Range.Start;
Object end = para.Range.Start + allText.IndexOf(":");

Range bold = report.Range(ref start, ref end);
bold.Bold = 1;

para.Range.InsertParagraphAfter();

object filename = "test.doc";
report.SaveAs(ref filename, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss);
object saveChanges = Microsoft.Office.Interop.Word.WdSaveOptions.wdPromptToSaveChanges;
object originalFormat = Microsoft.Office.Interop.Word.WdOriginalFormat.wdWordDocument;
object routeDocument = true;
((_Document)report).Close(saveChanges, originalFormat, routeDocument); 
```

成功创建了一个包含以下文本的 Word 文档：

> **前缀**：冒号后的文本

但是，这段代码：

```
object miss = System.Reflection.Missing.Value;
object Visible = true;
Microsoft.Office.Interop.Word.Application WordApp = new Microsoft.Office.Interop.Word.Application();
Document report = WordApp.Documents.Add(ref miss, ref miss, ref miss, ref miss);

Paragraph para = report.Content.Paragraphs.Add(ref miss);
String prefix = "Prefix";
String suffix = "text after the colon\n"; // <-- Note the additional newline in the string
String allText = prefix + ":" + suffix;
para.Range.Text = allText;
para.Range.Font.Bold = 0;
para.Range.Font.Size = 12;

Object start = para.Range.Start;
Object end = para.Range.Start + allText.IndexOf(":");

Range bold = report.Range(ref start, ref end);
bold.Bold = 1;

para.Range.InsertParagraphAfter();

object filename = "test.doc";
report.SaveAs(ref filename, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss);
object saveChanges = Microsoft.Office.Interop.Word.WdSaveOptions.wdPromptToSaveChanges;
object originalFormat = Microsoft.Office.Interop.Word.WdOriginalFormat.wdWordDocument;
object routeDocument = true;
((_Document)report).Close(saveChanges, originalFormat, routeDocument); 
```

`COMException: Value out of range`在此行引发异常：

```
Range bold = report.Range(ref start, ref end); 
```

这两个代码片段之间的唯一区别是这一行中的换行符：

```
String suffix = "text after the colon\n"; // <-- Note the additional newline in the string 
```

### 堆栈跟踪

我不知道它是否有帮助，但这是错误的完整堆栈跟踪：

```
at Microsoft.Office.Interop.Word.DocumentClass.Range(Object& Start, Object& End)
at Sandbox.Program.Main(String[] args) in C:\Users\ricardo\Documents\Visual Studio 2010\Projects\Sandbox\Sandbox\Program.cs:line 48
at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
at System.Threading.ThreadHelper.ThreadStart() 
```

### 调试结果

再一次，它可能没有帮助，但调试每个代码示例都会产生这些结果。对于第一个结果，这些是引发异常的行之前的变量值：

```
para.Range.Text == "Prefix: text after the colon\r"
start == 0
end == 0 
```

对于第二个结果，这些是值：

```
para.Range.Text == "\r"
start == 28
end == 34 
```

显然，有些东西是不正确的，但我不能准确地说明什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:27:24.457

可能是错误的行尾混淆 Word-try`"text after the colon\r\n"`或`"text after the colon" + Environment.NewLine`. 如果这不起作用，可能是因为换行符导致 Word 开始一个新段落，然后`para`指向它。由于新段落中没有文本，因此您无法选择范围。

如果是这种情况，那么为了达到相同的结果，您不应该在文本中添加换行符：

*   如果您想要第二段，请拨打另一个`report.Content.Paragraphs.Add`电话。
*   您可以添加一个不是分段符的换行符。那是 Word 中的 Ctrl-Enter，并且应该可以在代码中表达（虽然不知道如何）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T17:22:08.090

猜想，它实际上并没有验证这一点，但行为是合乎逻辑的。\n 添加一个新段落，就像在 Word 中按 Enter 一样。因此，分配 Text 属性会更改段落引用，它现在指向添加的空段落。所以你的*最终*价值超出了范围。您必须参考上一段。或者只是不使用换行符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T15:59:34.727

我将添加一个答案，因为这可能对其他人有所帮助，而且我认为对已接受的答案发表评论太长了。

我在 Word 中的新行有一个相关问题：没有错误，但是有一个空格来开始新行。

例子：

```
string wordText = "First line";
wordText += "\r\n"; // or System.Environment.NewLine;
wordText += "Second line"; 
```

将在 Word 文档中给出以下结果：

```
First line
 Second line 
```

看了这个问题后，我尝试只使用“\r”，它奏效了！所以现在我有：

```
string wordText = "First line";
wordText += "\r";
wordText += "Second line"; 
```

结果是：

```
First line
Second line 
```

# iphone - 带有 2 个组件委托的 uipickerview

> ID：11615346
> 
> 赞同：2
> 
> 时间：2012-07-23T15:12:03.067
> 
> 标签：iphone, uipickerview

我有以下带有 2 个组件的选择器代码：

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow: (NSInteger)row inComponent:(NSInteger)component {
if (component == 0) {
    NSLog(@"first");
}
else
{
    NSLog(@"second");
}
} 
```

问题是当用户尝试先滚动组件 0 并等待它完全停止之前，然后同时滚动组件 1。

那么我将只有“第二”的控制台日志。所以看起来第一个事件被第二个事件覆盖了。

有没有办法让我们等待选择器滚动事件自行完成？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:02:02.010

尝试让双组件 UIPickerView 工作时，我遇到了同样的问题。正如有人建议的那样，不要使用 if 语句。

而是这样做：

```
- (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    self.valueA = [self.valuePickerView selectedRowInComponent:0];
    self.valueB = [self.valuePickerView selectedRowInComponent:1];

    self.valueLabel.text = [NSString stringWithFormat:@"%i:%i", self.valueA, self.valueB];
} 
```

当然，如果您正在寻找数组的元素，只需使用“objectAtIndex:selectedRowInComponent:0”

* * *

不要这样做：

 ~~~~```
- (void)pickerView:(UIPickerView *)thePickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    if(component == 0){
        self.valueA = ...;
    }
    else if (component == 1){
        self.valueB = ...;
    }

    self.valueLabel.text = [NSString stringWithFormat:@"%i:%i", self.valueA, self.valueB];
} 
```~~  ~~希望这可以帮助其他为此苦苦挣扎的人。~~~~

# windows-mobile - 如何使用windows mobile查询txt文件？我没有找到适用于 Windows Mobile 的 odbc

> ID：11615348
> 
> 赞同：1
> 
> 时间：2012-07-23T15:12:23.493
> 
> 标签：windows-mobile, odbc, oledb, oledbconnection, handheld

我有一个文件，我可以使用 Windows 应用程序读取该文件`odbc driver`，

文件 ：-

```
col1, col2, col3, col4
1,2,3,4
a,b,c,d
e,f,g,h
5,6,7,8
1,b,2,c 
```

我需要使用带有 Windows Mobile 的手持设备来阅读它。我有 sqlce，但我没有找到适用于 windows mobile 的 odbc 驱动程序。如何查询文本文件？早些时候，我逐行阅读并将其插入数据库；但现在我必须使用 odbc 连接来执行此过程。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:54:11.027

Windows CE/Windows Mobile 根本不支持 ODBC。这意味着对于文本文件访问，您必须使用类似 a 的内容打开文件并使用和`TextReader`手动解析文件。`ReadLine``string.Split`

您可能会考虑使用像 SDF's 这样的第三方包装器[`TextDataAdapter`](http://www.opennetcf.com/library/sdf/html/d12ac962-39b7-f6ce-36ae-b83ae4681f68.htm)，它会为您进行解析并将文本推送到 a 中`DataSet`，但这实际上取决于您想要做的事情的复杂性。

# asp.net-mvc - 复选框未保留到模型

> ID：11615350
> 
> 赞同：0
> 
> 时间：2012-07-23T15:12:26.793
> 
> 标签：asp.net-mvc, asp.net-mvc-3, checkbox

我使用以下内容显示链接到我的模型的复选框：

```
@Html.CheckBoxFor(model => model.GenerateAppendixA) 
```

根据页面上的各种其他用户交互，有时我需要选中此复选框，然后将其禁用。我使用以下 jQuery 来执行此操作：

```
$('input:checkbox[name=GenerateAppendixA]').attr("checked", false);
$('input:checkbox[name=GenerateAppendixA]').attr("disabled", false); 
```

但是，当我使用 jQuery 选中该框时，模型中布尔值的状态始终为“假”。谁能解释为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:17:38.823

我现在看到 ASP.NET MVC 复选框助手自动生成一个隐藏字段。更改隐藏字段中的值解决了我的问题。

```
<input name="GenerateAppendixA" type="hidden" value="false" /> 
```

问候

# c# - 每当您创建新类时向 asp 项目添加命名空间

> ID：11615351
> 
> 赞同：2
> 
> 时间：2012-07-23T15:12:27.050
> 
> 标签：c#, asp.net

我可能对此很懒惰，但我想做的是在创建新的 .cs 时默认向所有 .cs 文件添加 using 语句。这是一个 asp 项目，我真的不想使用 web.config。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:16:39.757

据我所知，如果不弄乱 VS 模板（或 T4），这是不可能的。

但是，如果您键入一个存在或从项目中引用的类名，但当前未包含在*使用*的大多数版本的 VS 中，当您的鼠标放在它上面时，它会在它下面显示一个蓝色的小破折号。这是一个 VS 上下文菜单，您可以通过点击（默认）`ctrl`+来激活它`.`。其中一个选项是自动导入将添加 using 语句的类。

所以不完全是你想要的，但过程很简单

1.  输入你想要的类名
2.  `ctrl`+ `.`, `down`,`Enter`

不幸的是，这目前不适用于扩展方法，您必须使用 Resharper 之类的东西。我通过输入包含静态扩展方法类的名称（例如 Linq Where 的 EnumerableExtensions）并为此执行一次该过程来处理这个（尴尬）。

在这种情况下，这是 Asp.Net 的事实完全无关紧要，并且无法通过配置文件解决这种情况。修复必须在 C# 级别（因此，不会发生）或 VS 代码生成器（T4 或自定义模板）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:19:08.197

您可以创建一个项目模板，当您向项目添加新的 cs 文件时可以使用该模板，而不是为 cs 文件添加常规的 Visual Studio 模板。看这里：http: [//msdn.microsoft.com/en-us/library/tsyyf0yh.aspx](http://msdn.microsoft.com/en-us/library/tsyyf0yh.aspx)

# android - 进行通货膨胀并同时在edittext中写入文本

> ID：11615368
> 
> 赞同：0
> 
> 时间：2012-07-23T15:13:34.553
> 
> 标签：android, onclick, imagebutton, layout-inflater

大家好。

我需要验证字符串的内容是否为空。如果字符串是 != null 我在 imageButton 中创建一个 performClick。此单击使另一个布局中的布局膨胀。然后我需要在膨胀的editText中写入文本，但我不能。不可能同时膨胀并在 editText 中写入文本。

这是我的代码

```
if(sApelido != ""){
         inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
         b = (LinearLayout)inflater.inflate(R.layout.socio_form_structured_name,null);
         lLayout = (LinearLayout)findViewById(R.id.main_layout_id7);
         lLayout = (LinearLayout)findViewById(R.layout.socio_form_structured_name);
         lLayout.addView(b);

        apelido.setText(null);      //Write in one of the editText's that was inflated
    apelido.setText(sApelido);  //apelido is a editText that belongs to LinearLayout b
} 
```

我不知道你是否理解我的问题谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:19:51.317

您必须更具体地了解代码的确切问题，但一个可能的问题是您应该使用`.equals()`比较字符串值，而不是`!=`运算符。

尝试改用以下内容。我喜欢用

```
if (sApelido != null && !sApelido.equals(""))
{
    //your logic
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:23:20.367

并在膨胀的视图中写你可以使用这样的东西：

```
 public View displayEditText(){
    View v = getLayoutInflater().inflate(R.layout.edit_text_layout, null);
    EditText editText = (EditText) v.findViewById(R.id.edit_text);
    editText.setText(sApelido)
    return v;
    } 
```

然后只需将视图添加到您的布局或您想要显示它的任何位置。

# asp.net-mvc - 奇怪的 MVC3 控制器/动作行为

> ID：11615371
> 
> 赞同：1
> 
> 时间：2012-07-23T15:13:43.603
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我的应用程序有以下设置：

```
routes.MapRoute("Default", 
                "{controller}/{action}/{idt}", 
                new { controller = "Home", 
                      action = "Index", 
                      idt = UrlParameter.Optional }); 
```

我在我的数据库/模型中为 idt 参数和主键使用整数的 GUID。

在我的应用程序的“主”菜单中，我有：

```
@Html.ActionLink("Create invoice", "Create", "Invoices") 
```

如果我启动应用程序并查看此链接指向的路径，它是正确的：`/Invoices/Create`

但是，由于此路径也用于发票的编辑，如果我打开一个带有路径的页面`/Invoices/Create/0eb262cc-a623-41f5-9b32-fd452691f426`，然后查看“主”链接的路径，它指向`/Invoices/Create/0eb262cc-a623-41f5-9b32-fd452691f426`.

那是关于什么的？“固定”链接如何改变？有没有我在不知道的情况下在代码中做过的事情？但即使我这样做了，我也不明白为什么主链接会改变？它从哪里获得路径中的 GUID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:39:58.753

由于 Route Collection 包含一个值，`idt`因此它将使用该值呈现 URL。

您可以将一个空白值传递给

```
@Html.ActionLink("Create invoice", "Create", "Invoices",new {idt=""}) 
```

我相信这应该有助于解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T16:33:38.670

试试这个：

```
@Html.ActionLink("Create invoice", "Create", "Invoices", new {idt = ""}, new {}) 
```

这应该解决 length=8 的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T16:37:18.133

试试[这个](http://msdn.microsoft.com/en-us/library/dd504972.aspx)重载

```
@Html.ActionLink("Create invoice", "Create", "Invoices", null,null) 
```

# jaxb - EclipseLink MOXy - 如何避免在模型类包中保留 jaxb.in dex 和 jaxb.properties 文件？

> ID：11615376
> 
> 赞同：2
> 
> 时间：2012-07-23T15:14:01.283
> 
> 标签：jaxb, eclipselink, moxy

我正在使用 EclipseLink 外部映射文件将 Java 对象编组为 XML 和 JSON。由于我的模型类是在不同的项目中定义的，因此我无权添加/修改任何文件或类。

那么如何避免将 jaxb.in​​dex 和 jaxb.properties 文件保留在模型类所在的包中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:31:18.290

**JAVA模型**

Belos 是我将用于此示例的 Java 模型：

***富***

```
package forum11615376;

public class Foo {

    private Bar bar;

    public Bar getBar() {
        return bar;
    }

    public void setBar(Bar bar) {
        this.bar = bar;
    }

} 
```

***酒吧***

```
package forum11615376;

public class Bar {

    private String value;

    public String getValue() {
        return value;
    }

    public void setValue(String value) {
        this.value = value;
    }

} 
```

**外部映射文件 (oxm.xml)**

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum11615376">
    <java-types>
        <java-type name="Foo">
            <xml-root-element name="FOO"/>
            <java-attributes>
                <xml-element java-attribute="bar" name="BAR"/>
            </java-attributes>
        </java-type>
    </java-types>
</xml-bindings> 
```

* * *

**演示**

下面的演示代码演示了如何指定外部映射文件。

***排除`jaxb.properties`***

要消除`jaxb.properties`文件（这是指定 JAXB 提供程序的标准机制，请参阅：[http](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html) ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html ），我们将使用本机用于引导`JAXBContext`.

***排除`jaxb.index`***

在此示例中，该`oxm.xml`文件的作用与`jaxb.index`. 由于我们需要传递一些东西来创建`JAXBContext`我们将使用一个空的`Class[]`.

```
package forum11615376;

import java.util.*;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.Marshaller;
import org.eclipse.persistence.jaxb.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        properties.put(JAXBContextProperties.OXM_METADATA_SOURCE, "forum11615376/oxm.xml");
        JAXBContext jc = JAXBContextFactory.createContext(new Class[] {}, properties);

        Bar bar = new Bar();
        bar.setValue("Hello World");
        Foo foo = new Foo();
        foo.setBar(bar);

        Marshaller marshaller =jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(foo, System.out);
    }

} 
```

**输出**

下面是运行演示代码的输出。如您所见，已应用映射元数据。

```
<?xml version="1.0" encoding="UTF-8"?>
<FOO>
   <BAR>
      <value>Hello World</value>
   </BAR>
</FOO> 
```

# ruby - rspec w/IronRuby 缺少 be_* 方法

> ID：11615382
> 
> 赞同：0
> 
> 时间：2012-07-23T15:14:24.170
> 
> 标签：ruby, rspec, ironruby

我的 rspec gem 的 IronRuby 安装似乎缺少自动化的 be_* 方法助手。例如，以下代码会生成未定义的方法错误：

```
require 'rubygems'
require 'rspec'

x = 7
x.should == 7 # works
x.nonzero?.should == 7 #works
x.should be_nonzero # undefined method `be_nonzero' for main:Object 
```

我使用 igem 来安装 rspec gem。这是我安装的 gem 的列表：

```
bewildr (0.1.14)
builder (3.0.0)
cucumber (0.6.3)
diff-lcs (1.1.3)
iron-term-ansicolor (0.0.3)
json_pure (1.7.3)
polyglot (0.3.3)
rspec (2.11.0)
rspec-core (2.11.1)
rspec-expectations (2.11.1)
rspec-mocks (2.11.1)
term-ansicolor (1.0.7)
treetop (1.4.10) 
```

知道我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:52:59.817

RSpec 匹配器通常只在一个`it`块中可用，以避免污染全局命名空间。您是否尝试过在不同的 Ruby 实现上运行您的代码？你会得到同样的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T11:45:05.530

我有同样的问题，但你的帖子启发了我做一些研究。我在这里找到了解决方案： [https](https://github.com/cucumber/cucumber/wiki/RSpec-Expectations) ://github.com/cucumber/cucumber/wiki/RSpec-Expectations 总之在我的“features\support\env.rb”中我添加了这个：

```
require 'rspec/expectations'
World(RSpec::Matchers) 
```

# mysql - 每人获得最大的结果

> ID：11615383
> 
> 赞同：1
> 
> 时间：2012-07-23T15:14:24.837
> 
> 标签：mysql, sql, database

我有一个`actions`包含不同条目的表。每个条目都包含一个`userID`- 执行该操作的用户的 ID。

我怎样才能只获得用户执行的前 3 个操作。我知道如何在多个查询或使用 PHP 中执行此操作，但我想在单个 MySQL 查询中执行此操作。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:17:42.837

假设你有一个`date`TIMESTAMP 列来存储他们执行操作的时间，试试这个：

```
SELECT * FROM `user_actions` WHERE `userID` = X ORDER BY `date` DESC LIMIT 3 
```

`LIMIT 3`表示检索最多 3 个值，从第一个开始（检索第一个、第二个和第三个结果）。

**参考**：[http ://dev.mysql.com/doc/refman/5.5/en/select.html](http://dev.mysql.com/doc/refman/5.5/en/select.html)

享受和好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:17:03.893

您可以将`LIMIT <start>, <count>`, 与 MySQL 一起使用：

```
SELECT * 
FROM  user_actions 
WHERE userID = <my id>
ORDER BY date DESC
LIMIT 0 , 3 
```

这将返回查询结果的前 3 行（从索引 0 开始，如指定）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:18:32.310

```
SELECT * 
    FROM table_name 
    WHERE userID='$userid' 
    SORT BY date_column 
    LIMIT 3 
```

# python - 用于提取视频时长的 mpeg-2 库

> ID：11615384
> 
> 赞同：0
> 
> 时间：2012-07-23T15:14:28.490
> 
> 标签：python, video, metadata, mpeg

我最近冒险处理与音频和视频相关的编码，但我对它们中的任何一个都知之甚少。

碰巧我现在有一个正在处理 mpeg-2 视频的项目。是否有任何可用的 python 库来提取 mpeg-2 视频本身的持续时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:12:11.403

我不知道任何纯 python 实现。但也许 opencv 绑定对你有用：

```
import cv
cvcapture = cv.CaptureFromFile("movie.mpg")
cv.GetCaptureProperty(cvcapture,cv.CV_CAP_PROP_FRAME_COUNT) 
```

否则，你可以使用 pyffmpeg。注意：根据我的经验，帧数通常不是很准确。Opencv 2.6 工作得很好，但早期版本有时只是垃圾。

编辑：啊，对不起我的错误：这只给你帧数。持续时间：将其与帧速率相乘：

```
cv.GetCaptureProperty(cvcapture,cv.CV_CAP_PROP_FPS) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T17:52:41.470

除了 opencv 或 ffmpeg 之外的另一个选择可能是 gstreamer：

```
import gst
from gst.pbutils import Discoverer

d = Discoverer(5000000000)
vid_info = d.discover_uri("file://<path>") # needs to be a full path
duration = vid_info.get_duration()

# convert to seconds
duration / gst.SECOND 
```

但是，此解决方案在当前 gstreamer 版本（在 Ubuntu 12.04 上）随机崩溃（每 100 个文件左右）。也许你需要一些 gstreamer 插件来使用 mpg-2；我目前不知道是哪些。

我也在做一个或多或少的大型媒体项目，它应该能够处理大量的编解码器和容器，我们使用的每个库或多或少都是一团糟（错误的值或不稳定的）。也许那里有一些专门的 mpg 库。

哦，VLC 正在使用 ffmpeg；因此，如果您不允许使用 ffmpeg，您可能也不允许使用 VLC。

# php - 如何在等待 php 客户端脚本的回复时终止 php 服务器脚本？

> ID：11615385
> 
> 赞同：0
> 
> 时间：2012-07-23T15:14:28.293
> 
> 标签：php, javascript, ajax, client

目前我有一个 setInterval javascript 函数，它调用 ajax 函数来调用 php 脚本。这个 php 脚本是一个服务器，它正在等待来自另一个程序运行的客户端的请求。每当发生更改时，客户端将发送一个字符串，并且该字符串将通过 ajax 回显。

```
setInterval(function(){getTopo()}, 2000); 
```

`getTopo()`是一个 $.ajax 调用 server.php

如果在再次运行 getTopo() 之前 2 秒内没有回复，我想终止 server.php 文件。

否则我可以通过 ajax 在 php 的 while 循环中输出回声吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:23:03.413

将区间保存到变量中，例如：

`var t = setInterval(getTopo, 2000)`

并用于`clearInterval(t)`停止查询服务器。

从这里开始，您应该创建自己的代码来满足您的需求。

# r - 如何在 R 中将日期格式为 %y%m%d 转换为 %Y%m%d

> ID：11615386
> 
> 赞同：-5
> 
> 时间：2012-07-23T15:14:28.787
> 
> 标签：r, datetime, time-series

> **可能重复：**
> [如何将时间序列数据中的 y%m%d%H 格式转换为“%Y%m%d %H:%M:%S”](https://stackoverflow.com/questions/11614180/how-to-convert-ymdh-format-into-ymd-hms-in-time-series-data)

如何在 R 数据帧中将日期格式从 %y%m%d(000101=20000101) 转换为 %Y%m%d(20000101) (

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:22:48.493

这相当容易。我将假设目前，您的日期存储为字符串，如变量`x`.

```
x <- "000101" 
```

首先，您可以将其转换为日期类。完成后，`R`将日期存储为自起源以来的天数。这意味着它实际上是下面的数字。但是，特殊的打印和显示方法在打印时显示比基础数字更漂亮的输出。通过添加转换为日期并强制打印`()`：

```
(xd <- as.Date(x, format = "%y%m%d"))
[1] "2000-01-01" 
```

现在，如果您想以某种非默认方式显示它（例如 %Y%m%d），您可以要求`R`以这种方式对其进行格式化。

```
format(xd, "%Y%m%d")
[1] "20000101" 
```

如果您愿意，您可以将结果保存回您的数据框中。

```
(myx <- format(xd, "%Y%m%d"))
[1] "20000101" 
```

请注意，结果将再次是字符（字符串）类，*而不是*日期类。这意味着（除其他外）您不能再进行加法或减法等。例如：

```
xd + 10
[1] "2000-01-11"
xd - 10
[1] "1999-12-22" 
```

但

```
myx - 10
Error in myx - 10 : non-numeric argument to binary operator 
```

# ruby-on-rails - ruby 中两个字符串的连接失败（为什么要换行？）

> ID：11615390
> 
> 赞同：0
> 
> 时间：2012-07-23T15:14:41.593
> 
> 标签：ruby-on-rails, ruby, string, concatenation, string-concatenation

我有一个有线问题。我试图连接两个字符串。如果我使用@Client.ip 执行此操作，我会得到一个带有新行的字符串。@Client.ip 是一个字符串。

我用这个：

```
order= "net rpc shutdown #{ip} --user=administrator%***! --timeout=100 --force -C 'bla'" 
```

或这个

```
order= "net rpc shutdown "+ @client.ip + " --user=administrator%*** --timeout=100 --force -C 'bla'" 
```

结果是这样的：

```
net rpc shutdown 178.213.111.69
  --user=administrator%*** --timeout=100 --force -C 'bla' 
```

如果我手动编写 ip 并将其连接起来，它工作正常，一切都在一行中....为什么会发生这种情况？有人有想法吗？:-) 我需要在一行中使用这个字符串才能使用 system(-) 命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:19:38.247

听起来好像`@client.ip`在它的末尾有一个换行符。尝试剥离它

```
order= "net rpc shutdown #{@client.ip.rstrip} --user=administrator%*** --timeout=100 --force -C 'bla'" 
```

[`String#rstrip`](http://apidock.com/ruby/v1_9_3_125/String/rstrip)将删除字符串末尾的所有空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:26:25.030

您可以尝试对字符串类使用[chomp helper](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-chomp)

```
order= "net rpc shutdown #{ip.chomp} --user=administrator%***! --timeout=100 --force -C 'bla'" 
```

# javascript - 正则表达式匹配数字逗号数字

> ID：11615396
> 
> 赞同：3
> 
> 时间：2012-07-23T15:15:08.360
> 
> 标签：javascript, regex, web

这就是我现在所拥有的：

```
^[0-9]([,][0-9])?$ 
```

我的问题是我希望能够在逗号前后添加多个数字。

例子：

```
1,12
12,12
123,12
12,123 
```

以上所有数字都应该是有效的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T15:17:26.797

我建议如下：

```
/^\d+,\d+$/ 
```

'匹配前面的`+`项目一次或多次。

参考：

*   [JavaScript 正则表达式，在 Mozilla 开发者网络](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T15:17:02.890

使用`+`符号，并删除`[]`周围的括号`,`（它们不是必需的）：

```
^[0-9]+(,[0-9]+)?$
  //  ^-------^---------here they are 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:21:39.807

您有两个正则表达式主中继器，第一个是`*`，表示“重复零次或多次”。第二个是`+`说“重复一次或多次”。

在这种情况下，您需要将整数值和十进制值重复一次或多次。所以你可以试试：

```
 ^[0-9]+([,][0-9]+)?$ 
```

所以它将验证：

```
 0
  0123
  1,12
  1,0
  1,12340 
```

但不会验证：

```
 1,
  ,0
  -1,0
  1e-10 
```

尖端：

*   您只能替换`[0-9]`为`\d`. 意思是一样的；
*   您不需要组*逗号*，只需使用`,`代替`[,]`. 您仅将其用于多种可能性，例如接受逗号和点：`[,\.]`；

按照提示，您可以尝试：

```
 ^\d+(,\d+)?$ 
```

# google-app-engine - 用于 Web 应用的 CloudFlare 和动态 DNS

> ID：11615398
> 
> 赞同：3
> 
> 时间：2012-07-23T15:15:12.147
> 
> 标签：google-app-engine, heroku, dns, ddos, cloudflare

我的理解是 CloudFlare 是一个专门针对 Web 应用程序阻止 DDoS 攻击的 CDN；这基本上是为您的整个应用程序创建一个只读“缓存”，这样，如果您是 DDoSed，您的用户仍然可以访问您的应用程序的某些部分，而不会遇到完全拒绝服务。

我对动态 DNS 的理解是，它是一种技术，可以让您立即更改 Web 应用程序 URL 的 DNS 设置，而无需等待标准的 24 小时让 DNS 更改“影响”世界上所有的 DNS 服务器并生效。

因此，首先，如果到目前为止我所说的任何内容有误或不正确，请先纠正我！

假设我或多或少是正确的，我正在努力保护我的网络应用程序（尽我所能）免受 DDoS 攻击。

一方面，我决定使用 Google App Engine 或 Heroku 托管我的应用程序（尚未做出最终决定），并且我必须想象，如果我的应用程序是 DDoSed，他们的 IT 人员已经做好了扩大/处理的充分准备在部署到他们的服务器时。

对我来说不幸的是，这意味着他们将*扩大规模并处理*攻击（！），这意味着我的账单会飙升，我会倒闭（我猜这被称为“现金攻击”！）。

所以我需要一个可以处理以下两种情况的解决方案：

*   DDoS 是巨大的，甚至 Google/Heroku 都说“够了”，我们不支持这种负载！
*   我指定了一个计费“上限”（Google 和 Heroku 都提供），达到上限后，我以某种方式将流量重定向到托管在其他地方的 CloudFlare/只读网络应用程序

我怀疑我将需要以某种方式使用动态 DNS 来处理第二种情况，但不知道大多数 Web 应用程序如何防御 DDoSes（即我听说过所谓的“堡垒主机”？！？）我什至不确定我是否走在正确的道路上。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T16:01:44.720

一些小的更正：Heroku 不会为您扩展您的应用程序，也不会提供指定计费上限的功能。您应该根据您对特定场景的反应方式实施适当的监控和警报策略。

防止 DDoS 攻击并不是大多数应用程序开发人员关心的事情 - 但也许您处于一个特别容易受到攻击的领域？如果是这样，像 CloudFlare 这样自动执行此操作的服务是一个不错的选择。您将 DNS 设置为使用他们的名称服务器，他们会代表您处理 IP 地址分配，以应对各种威胁和其他优化机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T05:30:56.377

首先，动态 DNS 不是您所描述的那样。每个 DNS 服务器都可以将其记录的超时设置为它想要的任何值；更短的超时使更改传播得更快，但会导致用户的负载和延迟更高。动态 DNS 是一组服务，允许具有动态 IP（例如，在消费者互联网连接上）的用户拥有稳定的 DNS 名称。动态 DNS 与托管在 Heroku 或 App Engine 等专业地方的 Web 应用程序几乎没有关系。

App Engine 将处理您询问的两件事。您可以指定每日计费上限，如果您的应用超过该上限，它将被关闭并提供超出配额的错误，而不是向您收取更多费用。Google 基础架构可能会拒绝明显的滥用请求，但不提供任何承诺；但是，App Engine 确实提供了 DoS/Blacklist API，它允许您将作为滥用源的特定 IP 范围列入黑名单，以防止其流量到达您的应用程序。

Cloudflare 声称通过充当 CDN 并缓存应用程序的部分来以您描述的方式帮助解决此问题。但是，它有自己的警告。因为现在所有流量都通过 Cloudflare 传输，所以所有动态请求都会因为额外的跃点而产生额外的延迟。您还会丢失有关请求真实来源的宝贵信息，因为在您的应用程序看来，所有请求都来自 Cloudflare 服务器。最后，Google 基础架构甚至可能在最终转发滥用流量的情况下错误地将 Cloudflare 识别为滥用服务，在这种情况下，您的*所有*用户都可能最终没有服务。

我个人认为 Cloudflare 对 App Engine 没有多大用处，甚至可能有害。他们提供的几乎所有东西都已由 App Engine 提供，或者可以内置到编写良好的 App Engine 应用程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T15:39:29.857

我在 Incapsula 工作。与 CF 一样，我们还提供基于云的安全和加速服务，包括 DDoS 缓解。服务非常相似，都非常好，CF 更注重加速，而我们更注重安全。

（只需谷歌“ [Incapsula 和 Cloudflare 评论](https://www.google.com/search?num=100&hl=en&q=incapsula%20vs%20cloudflare%20review&oq=incapsula%20vs%20cloudflare%20review&gs_l=serp.3..33i21.4758.6165.0.6327.7.7.0.0.0.0.165.652.2j4.6.0...0.0...1c.9vBCRmspTBI)”即可查看一些比较用户评论）

首先我想说的是，据我所知（如果我错了，请纠正我），就像 Incapsula 一样，CF 也通过通货紧缩提供 DDoS 缓解。这基本上意味着“吞噬”所有额外流量，同时让网站在整个攻击过程中 100% 正常运行。

这种类型的保护超越了 Web 应用程序层，并提供了一个 DDoS 安全网，可以处理任何类型的 DDoS 相关场景。（只要可用的“管道”可以处理额外的传入流量）

在我们的案例中，此 Anti-DDoS 解决方案与符合 PCI 的 WAF 搭配使用，因此您也可以确保应用程序级别的安全。

此外，在付款方面，我们将为您提供您正在寻找的基于 DDoS 缓解“天花板”的模型。

这意味着，您可以提前确定您想要拥有的 DDoS 保护的最大数量，并且只需为该数量付费。

在占卜的情况下，我们将与您联系，让您决定是支付额外的流量还是说“足够了”并等待暴风雨过去。

另外，我想解决有关 Google 相关黑名单的评论。

这是一个合理的担忧，但在 Incapsula，我们手动提交所有 IP 范围以供 Google 评估。这消除了对 SE 黑名单的任何恐惧。实际上，我对此非常有信心，因为我在最近关于 Cloud CDN 相关神话的博客文章中谈到了这个主题，并且拥有 6 年以上的 SEO 经验（包括高级顾问和部门经理），我很确定我有正确的事实.

如果不出意外，在我们 2.5 年的经验中，我们从未发生过任何客户黑名单事件。

从我读过的内容来看，CF 也对他们所有的 IP 做同样的事情。

# python - 带有 Python 排序模块的 Python lamba 函数

> ID：11615408
> 
> 赞同：2
> 
> 时间：2012-07-23T15:15:48.493
> 
> 标签：python

有人可以详细说明以下语句的工作原理吗？

我的问题与 lambda 函数有关吗？lambda 语句将学生作为输入并返回 (student[2]) 列表中的第二个元素。我知道我们有 student_tuples 作为列表，但是 Python lambda 函数如何识别“学生”列表。

```
>>> student_tuples = [
        ('john', 'A', 15),
        ('jane', 'B', 12),
        ('dave', 'B', 10),
]
>>> sorted(student_tuples, key=lambda student: student[2])   # sort by age
[('dave', 'B', 10), ('jane', 'B', 12), ('john', 'A', 15)] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:20:01.837

lambda 无法识别整个列表。只有要排序的列表中的单个成员被传递。

```
>>> def age(student):
...   print "member: %s" % repr(student)
...   return student[2]
... 
>>> sorted(student_tuples, key=age)
member: ('john', 'A', 15)
member: ('jane', 'B', 12)
member: ('dave', 'B', 10)
[('dave', 'B', 10), ('jane', 'B', 12), ('john', 'A', 15)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:19:03.917

因为参数`sorted`是`key`一个单参数函数，它需要接受被排序的序列中的一个元素，并返回被认为是该元素的“键”的东西。在您的情况下，它是每个元组中的第三项。因此，不是按照通常的方式对元组进行排序（基于从左到右的值），而是说每个元组都有一个“键”，可以更好地表示它们应该如何排序，它是每个元组中的第三个值元组。

因此，对于您的示例，您有：

```
lambda student: student[2] 
```

这基本上等同于如下所示的函数：

```
def get_my_key(item):
    return item[2] 
```

因此，在对序列进行排序时，它会`get_my_key`在每个项目上调用此函数来检索实际的键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:19:01.080

我认为是不认可的。student 只是你给对象取的名字，可以是`x`，比如 `>>>sorted(student_tuples, key=x: x[2])` 如果你的对象不是列表，或者没有 '2' 元素，你会得到一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:19:22.143

该`sorted`函数的`key`参数采用单个参数的函数（在本例中为 lambda）。当 sorted 遍历输入列表时，它使用`key`函数来获取排序值，在本例中，是输入元组中的第三项。

lambda 中的`student`名称只是一个名称，您可以使用`lambda x: x[2]`相同的效果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T15:19:52.283

> 但是Python lambda函数如何识别“学生”列表..

记住 python 是动态类型的。`student`lambda在解包并尝试使用它之前不知道是什么。它是python中某些东西的名称。`student`可以是整数、列表、对象或其他任何东西。在执行 Lamba`key`并`python`意识到它`student`不可索引之前，不会进行任何验证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-23T15:20:02.320

`lambda student: student[2]`只是一个函数并且`student`是它的参数，它也可以是：

```
sorted(student_tuples, key=lambda x: x[2]) 
```

所以这里发生的事情是你给出了一个排序列表和一个对每个项目进行操作的函数，它将根据该函数的结果对列表进行排序

从`sorted` [文档](http://docs.python.org/library/functions.html#sorted)：

> cmp 指定两个参数（可迭代元素）的自定义比较函数，该函数应返回负数、零或正数，具体取决于第一个参数被认为小于、等于还是大于第二个参数： cmp=lambda x,y : cmp(x.lower(), y.lower())。默认值为无。

So you could use any function for sorting, and lambda function is just a type of anonymous function (a function without a name)

# assembly - 位置独立的 cos-call printf-assembly

> ID：11615409
> 
> 赞同：0
> 
> 时间：2012-07-23T15:15:59.207
> 
> 标签：assembly

是

```
 call printf 
```

可以在位置无关的代码中使用吗？一方面， call 是相对的，另一方面 printf 是一个库函数。如果答案不是，为什么？在链接阶段 printf 的代码没有复制到我写的文件中？（然后在我看来还可以）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:00:15.657

您可以使用[GOT](http://bottomupcs.sourceforge.net/csbu/x3824.htm)进行相对 FAR 调用（模块间调用） ，它将保存绝对地址到`printf`，然后调用`printf`，将执行类似的`CALL [GOT + printf_index * sizeof(ptr)]`操作（此表达式将在汇编/编译期间折叠为常量）。

另一种但完全可怕的方法是将您正在使用的 CRT 函数合并到您的共享库/二进制文件中（MSVC 调用此静态链接），但是这会使二进制文件膨胀并使其对未来不友好，因此可能会开放静态链接到的 CRT 中未发现的错误。

# ruby-on-rails - Rails - 模型设计 - 引用两个相同模型类型的列表

> ID：11615413
> 
> 赞同：0
> 
> 时间：2012-07-23T15:16:18.773
> 
> 标签：ruby-on-rails, ruby, database-design, activerecord, has-many

我想实现一个游戏模型，它有两个团队和两个分数。团队是玩家的列表。

```
class Game < ActiveRecord::Base
   has_many :players, :name => 'Team1' # I'd like this to be the first team
   has_many :players, :name => 'Team2' # and this to be the second team

   attr_accessible :score1 #the first team's score
   attr_accessible :score2 #the second team's score
end

class Player < ActiveRecord::Base
  attr_accessible :name
end 
```

任何解决方案来实现这一点？我不知道这是否/如何可能。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:28:58.463

最简单的方法是创建一个`Team`模型，它有很多玩家，并持有一个分数。游戏包含两个团队（实际上是 has_many）。这样，用户不仅可以访问游戏，还可以访问得分和队友。（如你所愿，求一个球员的队友可不是一件容易的事）

你想要什么是可能的，但我不建议这样做。改为添加团队模型。

# c# - 分离空事件处理程序

> ID：11615415
> 
> 赞同：3
> 
> 时间：2012-07-23T15:16:28.390
> 
> 标签：c#, memory-leaks, event-handling

我被委托清理代码中的内存泄漏，并进行检查以防止进一步的泄漏。我注意到未分离的处理程序似乎是主要原因。大多数都是直截了当的，但是代码中有几件事让我摸不着头脑。

第一的：

`myObject.someEvent -= null;`

我假设这完全没有任何作用是正确的吗？（我知道如果一个事件是本地的，你可以将它设置为 null，因为它本质上是一个多播委托）。

其次，对于匿名处理程序：

`myObject.someEvent += ()=> { x + y; };
myObject.someEvent -= ()=> { x + y; };`

我是否正确地说第二条指令也毫无价值，因为匿名方法将被编译为两个单独的委托，因此减法实际上并不指向需要删除的正确处理程序？（对于正在寻找解决此问题的适当解决方案的任何人，请看[这里](https://stackoverflow.com/a/4303966/1265219)）。

我不想满足于“是的，没错”，我想知道**为什么**这些东西不起作用（假设我的断言是正确的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:26:48.993

从[文档](http://msdn.microsoft.com/en-us/library/ms366768.aspx)：

> 请务必注意，如果您使用匿名函数订阅某个事件，您将无法轻松取消订阅该事件。要在这种情况下取​​消订阅，需要返回订阅事件的代码，将匿名方法存储在委托变量中，然后将委托添加到事件中。通常，如果您必须在稍后的代码中取消订阅事件，我们建议您不要使用匿名函数来订阅事件。

所以你是对的，你不能像那样删除匿名方法。同理，说 `myObject.someEvent -= null;`也无济于事

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:27:36.997

在第一种情况下，我们可以从`MulticastDelegate.CombineImpl`（使用 IL Spy 或其他东西）的反编译实现中看到，如果传入的委托是`null`，则不进行组合 - 所以是的，删除空委托什么都不做。

* * *

在第二种情况下，这完全取决于编译器是否认为两个 lambda 表达式相等。[这篇博客文章](http://blogs.msdn.com/b/ericlippert/archive/2012/06/18/implementation-defined-behaviour.aspx)间接回答了这个确切的问题

> 在 C# 中，如果你有：
> 
> ```
> Func<int, int> f1 = (int x)=>x + 1;
> Func<int, int> f2 = (int x)=>x + 1;
> bool b = object.ReferenceEquals(f1, f2); 
> ```
> 
> *<< snip >>* **在 C# 中，这是由实现定义的**；编译器可以自行决定是否使它们引用相等。

您可以确定当前的 C# 编译器是否相当容易地认为这两者相等，但这并不是重点——这是实现定义的行为，不应依赖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:24:39.257

似乎即使*添加*也没关系：

```
public Action  del;
void Main()
{

del+=(()=>"1".Dump());

 del+=null;
 del+=null;
 del+=null; 

del+=(()=>"2".Dump());
del();
del.GetInvocationList().Select(f=>f.Target);

}

//ouput:
1
2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:24:43.687

> 第二条指令也毫无价值，因为匿名方法将被编译为两个单独的委托，因此减法实际上并不指向需要删除的正确处理程序？

正确的。每个 lambda 创建一个新的委托对象，它不等于第一个。

如果不是，我希望第一个抛出；ta no-op（我看不出它怎么能做任何有用的事情。）

# java - 在 Windows 上从 Java Applet 静默下载和打印 PDF 文档

> ID：11615425
> 
> 赞同：0
> 
> 时间：2012-07-23T15:16:58.343
> 
> 标签：java, windows, pdf, applet

我想下载 PDF 并打印。我想完全静默地执行此操作，而不向用户显示任何对话框。我目前正在使用自签名小程序（部署时将使用授权签名）。它可以在 Linux 和 OS X 上正常工作，但不能在 Windows 上工作。在 Windows 上，它向用户显示一个对话框来保存文件（.xps 类型）。文件保存后会静默发送到打印机，所以我目前的问题是如何让文档静默保存而不让用户看到对话框。代码如下。我正在使用 Apache PDFBox。我读过我可能需要使用 PrivilegedAction，但我不明白为什么问题不是我不能下载文件，而是我不能默默地这样做。

```
/**
 * Print Applet
 * Author: kareem
 * Date: 12-02-20
 * Time: 10:57 AM
 */

import java.applet.Applet;
import java.awt.print.PrinterException;
import java.io.*;
import java.net.*;
import org.apache.pdfbox.pdmodel.PDDocument;
import netscape.javascript.*;

public class PrintApplet extends Applet {
    public void init() {
        String callbackURL = this.getParameter("callbackurl");
        String fileToPrint = this.getParameter("file");
        String successCallback = this.getParameter("successcallback");
        String failureCallback = this.getParameter("failurecallback");
        String published = this.getParameter("published");
        JSObject window = JSObject.getWindow(this);
        if (fileToPrint == null || callbackURL == null) {
            window.call(failureCallback, new String[] { "Missing required parameters." });
        } else {
            try {
                URL printURL;
                printURL = new URL(fileToPrint);
                PDDocument doc;
                doc = PDDocument.load(printURL);
                doc.silentPrint();
                try {
                    URL updateOrderUrl = new URL(callbackURL);
                    HttpURLConnection updateOrderHTTP = (HttpURLConnection) updateOrderUrl.openConnection();
                    updateOrderHTTP.setDoOutput(true);
                    updateOrderHTTP.setDoInput(true);
                    updateOrderHTTP.setRequestMethod("PUT");
                    String updateOrderData = URLEncoder.encode("printed", "UTF-8") + "=" + URLEncoder.encode(String.valueOf(System.currentTimeMillis()/1000) + "&" + URLEncoder.encode("published", "UTF-8") + "=" + URLEncoder.encode(published, "UTF-8"), "UTF-8");
                    OutputStreamWriter out = new OutputStreamWriter(updateOrderHTTP.getOutputStream());
                    out.write(updateOrderData);
                    updateOrderHTTP.getInputStream();
                    out.close();
                    window.call(successCallback, null);
                } catch(Exception e) {
                    window.call(failureCallback, new String[] { "Server callback failed." });
                }
            } catch (MalformedURLException e) {
                System.out.println("Malformed URL Exception: " + e.getMessage());
                window.call(failureCallback, new String[] { "Invalid print file URL." });
            } catch (IOException e) {
                System.out.println("IO Exception: " + e.getMessage());
                window.call(failureCallback, new String[] { "Print file could not be loaded." });
            } catch(PrinterException e) {
                System.out.println("Printer exception: " + e.getMessage());
                window.call(failureCallback, new String[] { e.getMessage() });
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T00:50:39.860

我遇到了同样的问题，并在评论中找到了上面的答案：我们的默认打印机设置为 Microsoft XPS 文档编写器。

我在这里提到它，以防有人掩盖评论并认为没有答案。

请 1up yms 的评论而不是这个答案。

# php - 如何更改 hook_form_alter 中的 field_tags？

> ID：11615427
> 
> 赞同：0
> 
> 时间：2012-07-23T15:17:02.977
> 
> 标签：php, drupal

我将 field_tags 设置为选择框（不是自动完成）。在 hook_form_alter 中，如何更改 field_tags 选择框的默认值？到目前为止，我有：

```
function autotag_custom_form_alter(&$form, &$form_state, $form_id){

    if($form_id == 'article_node_form'){
      //change default value here
    }

} 
```

但我不知道如何访问 field_tags 元素然后更改默认值。请帮忙！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:39:01.433

该`field_tags`元素可能是来自 Field API 的小部件。您当然可以从表单更改钩子中更改它，但请注意，它不是您的普通表单 API 元素。Field API 添加了自己的后处理器、预渲染等功能。这些函数可能期望您可能想要更改的内容。

但是，您可以从内容类型的配置界面更改字段的默认值（您需要为此启用字段 UI 模块）。您还应该能够从那里选择不同的小部件（即选择框）。

# docx - DOCX：文件已损坏，无法打开

> ID：11615433
> 
> 赞同：0
> 
> 时间：2012-07-23T15:17:18.650
> 
> 标签：docx, wordml

我正在将 Wordml 转换为 Docx，并使用 wordML 文件添加了一些默认支持文件，现在所有文件都像 DOCX 文件夹结构一样被压缩，在打开 DOCX 时，我收到类似“文件损坏且无法打开”的错误消息。

请帮助我如何避免错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:28:43.780

您的 Open XML 有问题。如果您单击显示详细信息，它可能只会在第 1 行显示错误。

要找出错误，请按照下列步骤操作：

1.  为 VS 2010安装 [Open XML 包编辑器电动工具](http://visualstudiogallery.msdn.microsoft.com/450a00e3-5a7d-4776-be2c-8aa8cec2a75b/)

2.  然后拖放损坏的文档并打开 document.xml

3.  现在选择 Edit => Advanced => Format Document 这将格式化 XML 文件保存 xml。

4.  再次打开损坏的文档，然后单击显示详细信息。这将显示您遇到问题的行号。

# asp.net-mvc - 如何更改 MVC Razor 代码中使用的时间格式？

> ID：11615436
> 
> 赞同：2
> 
> 时间：2012-07-23T15:17:24.203
> 
> 标签：asp.net-mvc, asp.net-mvc-3

在我的 C# 代码中，我的数据类型为

```
public DateTime? Created { get; set; } 
```

在我的剃刀代码中，这打印为：

```
<td>@Model.Created</td>

5/23/2012 1:26:39 PM 
```

我想将格式更改为：

```
5/23/2012 13:26 
```

有人可以告诉我如何做到这一点来帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:21:15.997

您应该调用 toString 方法并将掩码传递给它

```
<td>@Model.Created.toString("dd/MM/yyyy HH:mm")</td> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:19:51.997

你当然可以使用

```
@Model.Created.Value.ToString(myFormat); 
```

其中*myFormat*是格式字符串

[http://msdn.microsoft.com/en-us/library/az4se3k1.aspx](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)

[http://msdn.microsoft.com/en-us/library/8kb3ddd4](http://msdn.microsoft.com/en-us/library/8kb3ddd4)

对于您要查找的特定格式，请尝试使用*myFormat*字符串“MM/dd/yyyy HH:mm”。具体来说，“H”将为您提供 24 小时制而不是上午/下午格式。HH 确保在需要时用前导 0 填充 24 小时时钟。

如果*Created*可以为空，请确定并检查它是否为空并输出适当的内容。

您可以创建一个作用于可为空的 DateTime 的扩展方法，如果值为 null，则输出适当的内容，否则应用 DateTime 并应用您的格式。

```
 public static IHtmlString DateFormatted(this HtmlHelper htmlHelper, DateTime? dateTime, string format = "MM/dd/yyyy HH:mm")
    {
        string formatted = dateTime.HasValue ? dateTime.Value.ToString(format) : ("(null)");

        return new HtmlString(formatted);
    } 
```

像这样使用扩展方法

```
<td>@Html.DateFormatted(Model.Created)</td> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:21:00.940

```
@Model.Created.HasValue? Model.Created.Value.ToString("M/d/yyyy H:mm") : "Not Created" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T16:26:49.823

如果您需要多次或全局执行此操作，您可以在 Shared/DisplayTemplates 文件夹中创建一个 DateTime.cshtml 模板，并让它包含其他答案中显示的格式字符串。例如：

```
@model System.DateTime?
@(Model.HasValue ? Model.Value.ToString("M/d/yyyy H:mm") : "Undefined") 
```

你会称之为：

```
@Html.DisplayFor(m => m.Created) 
```

这将避免必须在需要它的任何地方指定它。这将更改所有日期的默认格式。如果您不想这样做，即使您只使用两次或多次，也可能仍然值得使用模板，以便您可以在必要时在一个地方进行更改。在这种情况下，将模板名称更改为“ShortDateTime”之类的名称并像这样调用它：

```
@Html.DisplayFor(m => m.Created, "ShortDateTime") 
```

# python - Python 解释器占用了我高达 130% 的 CPU。这怎么可能？

> ID：11615449
> 
> 赞同：3
> 
> 时间：2012-07-23T15:17:49.490
> 
> 标签：python, linux, multithreading, load

我目前正在使用 python进行一些**I/O 密集型负载测试。**我的程序所做的就是尽可能快地将 HTTP 请求发送到我的目标服务器。

为了管理这个，我使用**了多达 20 个*线程***，因为我基本上受到 I/O 和远程服务器的限制。

根据“顶部”，*CPython*在我的双核计算机上使用了**130% 的 CPU 峰值。**

这怎么可能？我认为 GIL 阻止了这一点？还是 Linux “计算”每个应用程序消耗的资源的方式？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-23T15:20:03.737

顶部的 100% 是指单核。在双核机器上，您有高达 200% 的可用空间。

单个单线程进程只能使用单个内核，因此限制为 100%。由于您的进程有多个线程，因此没有什么可以阻止它使用两个内核。

GIL 仅阻止纯 Python 代码同时执行。许多库调用（包括大多数 I/O 东西）都会释放 GIL，所以这里也没有问题。与互联网上的大部分 FUD 不同，GIL 很少会降低现实世界的性能，如果确实如此，通常有比使用线程更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:24:15.037

在使用 C 扩展库调用释放 GIL 并在后台进行一些进一步处理的情况下，这是可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T17:04:40.373

如果您觉得这很烦人，请设置您的首选项（特别是系统监视器或等效工具的首选项）以启用“Solaris 模式”，该模式将 CPU 百分比计算为总处理能力的比例，而不是单核处理能力的比例.

# oauth-2.0 - 无法使用 QueryString (Google OAuth 2.0) 访问 access_token 值

> ID：11615451
> 
> 赞同：0
> 
> 时间：2012-07-23T15:17:54.300
> 
> 标签：oauth-2.0

我无法`access_token`从 ASP.Net (C#) 中的 QueryString 中获取值。

谷歌正在发送授权令牌，但我无法通过使用捕获令牌值

1.  查询字符串（为空）
2.  分割字符串（没有得到完整的 url）

重定向网址是：`http://www.onfrnz.com/auth.aspx`

```
http://www.onfrnz.com/auth.aspx#state=/profile
    &access_token={ACCESS_TOKEN}
    &token_type=Bearer
    &expires_in=3600 
```

请帮助我。我不想使用图书馆。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T21:22:10.893

您正在尝试访问服务器端代码中的哈希片段值。哈希片段值（在 URL 中的 # 之后）不会从 Web 浏览器发送到 Web 服务器，因此无法在服务器端代码中访问。

当您最初启动 OAuth 流程时，您可能会使用：

```
&response_type=token 
```

这表明您希望将流用于客户端 (JavaScript) 应用程序（在规范中称为“隐式”流）。

相反，您应该使用：

```
&response_type=code 
```

这将在查询参数中返回一个授权`code`值，您应该能够使用您的 .NET 代码检索该值，然后通过向 Google 发出服务器到服务器请求来交换访问令牌。

有关用于 Web 服务器应用程序的 Google OAuth 2.0 流程（授权代码流程）的更多信息，请访问此处：

[https://developers.google.com/accounts/docs/OAuth2WebServer](https://developers.google.com/accounts/docs/OAuth2WebServer)

# mac-app-store - Mac Developer ID 签名证书的有效期是多久？

> ID：11615453
> 
> 赞同：4
> 
> 时间：2012-07-23T15:18:03.620
> 
> 标签：mac-app-store, osx-mountain-lion, osx-gatekeeper

我有一个我一直在从事的小型开源 OSX 项目，我想在 App Store 之外分发。

随着即将发布的 Mountain Lion，我想提供一个证书，以减少安装过程中的痛苦。

使用 App Store，您需要继续支付每年 99 美元的计划费用——如果您的会员资格用完，他们会将您的应用从商店中撤出。

有谁知道它是否适用于开发人员 ID 签名证书？如果我的会员资格失效，他们会撤销我的证书吗？

我愿意支付 99 美元的一次性费用，但我认为年复一年地续订对我来说不值得。

此外，如果您知道此信息受 NDA 保护，请随时关闭此信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T14:06:32.333

IANAL，但计划协议明确规定了在您离开付费计划后您可以继续使用非 App Store 证书进行签名的条款，并且我看到的开发者 ID 证书的有效期为五年。您最好的选择可能是直接询问 Apple，如果您似乎无法得到明确的答案，请提交错误（IIRC，bugreport.apple.com 只需要免费注册）。

# python - Python：在 Windows 上启动新的命令提示符并等待它完成/退出

> ID：11615455
> 
> 赞同：36
> 
> 时间：2012-07-23T15:18:26.433
> 
> 标签：python, windows

我不明白为什么在 Windows 上执行此操作如此困难。

我想生成一堆将运行其他脚本的命令提示符窗口。我想要这个的原因是我可以整齐地看到每个脚本的所有输出（如果我让它们只是主窗口中的线程/子进程，我无法正确查看所有输出）。我也不想记录输出，因为它主要用于查看进度条，这实际上不适用于日志文件。

所以我的要求的各个部分有效，但不能一起工作：

```
os.system("start cmd /c {command here}")     # Launches in new command prompt, closes when done 
```

但是，操作系统不会让我等到命令完成（因为 start 是实际命令，第二个它打开新命令提示符它是“完成”）

同样，如果我尝试：

```
p = subprocess.Popen(["start", "cmd", "/k", "{command here}"], shell = True) # Needs to be shell since start isn't an executable, its a shell cmd
p.wait()    # I can wait until finished (although it too finishes after start finishes) 
```

那么我该怎么做呢？我在某处读到一个解决方案可能是使用 processgroup 但它只是 unix ......或类似的东西

或者，如果您有一种巧妙的方式在单个窗口中显示所有子进程的输出，那么我不需要打开新的命令提示符并且可以简单地使用线程。这也有效，但如果我说 4 个线程正在下载某些东西并显示进度条以及输出其他信息，我不知道如何以一种可以阅读的方式显示它（以及避免它们都与彼此）。

PS：这是在 Windows Vista 上。PPS：我希望有一个适用于 Windows、Linux 和 Mac 的解决方案，我现在专注于 Windows，但我想要一个适用于所有三者的解决方案，而且我知道 Windows 是最挑剔的。我只是将“启动 cmd /c”替换为操作系统相应的命令。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-07-23T15:25:05.440

在阅读您对我之前的回答的评论后，您需要的是：

```
os.system("start /wait cmd /c {command}") 
```

随时掌握Windows[命令参考！](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands "windows命令参考")

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-11-24T14:06:05.850

接受的答案对我不起作用。
要在新的命令提示符下打开，我必须使用：

```
os.system("start /B start cmd.exe @cmd /k mycommand...") 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-03-20T21:27:50.270

对我来说，这似乎有效
`os.system("cmd /k {command}")`

使用`/k`cmd 执行然后保持打开状态
使用`/c`执行并关闭

打开一个新的命令窗口，然后执行命令
`os.system("start cmd /k {command}")`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-23T15:25:21.787

您可以将 /WAIT 传递给`start`命令以使其等待终止。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-23T15:21:27.280

怎么样

```
os.system("cmd /c {command here}") 
```

甚至

```
os.system("{command here}") 
```

启动单独会话的命令是启动命令，而不是使用运行 python 程序的相同会话。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-11T16:35:45.743

[打开新 cmd 窗口的最简单方法（如https://stackoverflow.com/a/11615580/3312367](https://stackoverflow.com/a/11615580/3312367)所指出的）是使用

```
os.system("start /wait cmd /c {command}") 
```

但如果您的命令是一个带有空格或其他控制字符的复杂命令，它就不是很有用。为此，我使用：

```
subprocess.run(["start", "/wait", "cmd", "/K", command, "arg /?\^"], shell=True) 
```

# android - 如何使用 Sherlock 操作栏主题将溢出菜单项的文本颜色更改为不同的颜色

> ID：11615458
> 
> 赞同：4
> 
> 时间：2012-07-23T15:18:37.590
> 
> 标签：android, styles, themes, actionbarsherlock

我试图弄清楚如何使用夏洛克操作栏将菜单项的文本颜色更改为不同的颜色。以下是我尝试过的主题

```
 <style name="MYTHEME" parent="Theme.Sherlock.Light.ForceOverflow">

         <item name="android:actionMenuTextColor">@color/menu_color</item>
         <item name="actionMenuTextColor">@color/menu_color</item>

        <item name="android:actionDropDownStyle">@style/MYTHEME.ActionBarStyle.DropDownStyle</item>
        <item name="actionDropDownStyle">@style/MYTHEME.ActionBarStyle.DropDownStyle</item>  

      </style>   

      <style name="MYTHEME.ActionBarStyle.DropDownStyle" parent="Widget.Sherlock.Spinner.DropDown.ActionBar">
        <item name="android:textColor">@color/menu_color</item>
      </style> 
```

我能够使用上述更改菜单项的颜色，但无法通过“actionDropDownStyle”更改溢出菜单项的颜色...

我还查看了链接[https://groups.google.com/forum/#!msg/actionbarsherlock/5lHOKNlXn_4/f9XicMXbFFAJ](https://groups.google.com/forum/#!msg/actionbarsherlock/5lHOKNlXn_4/f9XicMXbFFAJ) 但关于更改溢出菜单背景的问题只有一半的答案。

任何想法如何更改溢出菜单项的文本颜色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:21:07.980

您必须创建自定义微调器样式，例如覆盖 ActionBarSherlock 库提供的样式：

```
<style name="SpinnerItemStyle" parent="Widget.Sherlock.TextView.SpinnerItem">
    <item name="android:textColor">@android:color/white</item>
    <item name="android:textSize">22sp</item>
    <item name="android:textStyle">bold</item>
    <item name="android:padding">4dp</item>
    <item name="android:gravity">left|center_vertical</item>        
</style> 
```

然后，在您的主题中引用它，在 spinnerItemStyle 项目中：

```
<item name="spinnerItemStyle">@style/SpinnerItemStyle</item> 
```

**编辑：**

注意：确保您的适配器将 com.actionbarsherlock.R.layout.sherlock_spinner_dropdown_item 作为下拉项，并将 com.actionbarsherlock.R.layout.sherlock_spinner_item 作为微调项：

```
ArrayAdapter<String> navigationAdapter = new ArrayAdapter<String>(context, com.actionbarsherlock.R.layout.sherlock_spinner_item, navigationItems);
navigationAdapter.setDropDownViewResource(com.actionbarsherlock.R.layout.sherlock_spinner_dropdown_item); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-02T13:21:56.027

After lots of searching, one can modify text Color inside `OverflowMenu` of `ActionBar` for `ActionBarSherlock`. with following Theme Styles under parent style element only. Still haven't checked all the widget inside `ActionBar` changed or not. Please pardon for that if found out.

`res\values\styles.xml`

```
<style name="Theme.Zname" parent="@style/Theme.Sherlock.Light">
    <item name="actionBarItemBackground">@drawable/selectable_background_zname</item>
    <item name="actionBarWidgetTheme">@style/Overflow.Text.Color</item>
</style>

<style name="Overflow.Text.Color" parent="Widget">
        <item name="android:textColor">@android:color/white</item>
</style> 
```

`res\values-v14\styles.xml`

```
<style name="Theme.Zname" parent="@style/Theme.Sherlock.Light">
    <item name="actionBarItemBackground">@drawable/selectable_background_zname</item>
    <item name="android:actionBarWidgetTheme">@style/Overflow.Text.Color</item>
</style>

<style name="Overflow.Text.Color" parent="Widget">
        <item name="android:textColor">@android:color/white</item>
</style> 
```

# wordpress - 将 WP 嵌入到我的 HTML 中

> ID：11615461
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:18:43.910
> 
> 标签：wordpress

我正在重新设计我的网站[http://point-studios.com/](http://point-studios.com/)该博客将只有大约 7 个部分中的一个部分。

我不希望将所有网站都放在 WP 模板系统中以使博客正常工作。有什么办法可以将我的 WP 嵌入网站的一个部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:29:59.743

是的，您可以将 Wordpress 安装到子目录（即 /blog）并在那里而不是在根目录中运行它。您的站点将使用您自己的 HTML 正常运行，但如果您访问[http://www.yoursite.com/blog](http://www.yoursite.com/blog)，您将访问 Wordpress 安装。

# css - Firefox、Chrome CSS 定位问题

> ID：11615471
> 
> 赞同：0
> 
> 时间：2012-07-23T15:19:12.177
> 
> 标签：css, firefox, google-chrome, browser, xhtml

在 Firefox 和 Chrome 中，Table Booking 小部件似乎与网站对齐。但有人告诉我，它在 Firefox 和 Chrome 中不是内联的。但我似乎无法复制这一点，任何人都可以对此有所了解。

[http://www.thewhiteoak.co.uk/](http://www.thewhiteoak.co.uk/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:34:16.200

在第 199 行的 index.html 文件中，您有特殊的 -moz 样式：

```
@-moz-document url-prefix() {
.OT_wrapper {
margin: -10px 0 5px 450px;
} 
```

您应该添加此边距边距：-10px 0 5px 450px; .OT_wrapper 也适用于 Chrome。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T11:06:10.577

尝试改变

```
@-moz-document url-prefix() {
.OT_wrapper {
margin:-10px 0 5px 0px;
}
} 
```

至

```
.OT_wrapper {
margin:-10px 0 5px 0px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:26:42.240

```
.OT_wrapper {
    background-color: rgb(246, 246, 243);
    margin-left: 0px;
} 
```

# ruby-on-rails - 您如何调用 db:migrate:up 作为另一个 rake 任务的一部分

> ID：11615477
> 
> 赞同：2
> 
> 时间：2012-07-23T15:19:33.890
> 
> 标签：ruby-on-rails, ruby, rake, rails-migrations, rake-task

从命令行，我可以运行

```
rake db:migrate:up VERSION=20120123160700 
```

这将迁移到该特定版本。

我希望能够从 rake 任务向上迁移（但不能超出特定版本），最好使用 db:migrate:up。

我尝试了以下方法并将错误消息放在下面：

```
Rake::Task['db:migrate:up VERSION=20120123160700'].invoke 
```

不知道如何构建任务 'db:migrate:up VERSION=20111208105833'

```
Rake::Task['db:migrate:up'].invoke('VERSION=20120123160700') 
```

版本是必需的

```
Rake.application.invoke_task("db:migrate:up[VERSION=20120123160700]" 
```

版本是必需的

```
Rake.application.invoke_task("db:migrate:up[VERSION=20120123160700]" 
```

不知道如何构建任务 'db:migrate:up VERSION=20111208105833'

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:32:41.620

这可能不是更好的解决方案，但它应该可以工作。你可以这样做 ：

```
 ActiveRecord::Migrator.run(:up, ActiveRecord::Migrator.migrations_path, 20120123160700)
  Rake::Task["db:schema:dump"].invoke if ActiveRecord::Base.schema_format == :ruby 
```

您可以在此处查看源代码：[https](https://github.com/rails/rails/blob/621df2a1ec01b77f7b052b3571f3c696f0443fea/activerecord/lib/active_record/railties/databases.rake) ://github.com/rails/rails/blob/621df2a1ec01b77f7b052b3571f3c696f0443fea/activerecord/lib/active_record/railties/databases.rake第 163 行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:25:12.257

我相信你可以做到：

```
ENV["VERSION"] = "20120123160700"
Rake::Task["db:migrate:up"].invoke 
```

或者，您可以执行以下操作：

```
system("rake db:migrate:up VERSION=20120123160700") 
```

（我不清楚这是否适用于 Windows，因为它使用 Kernel#system）。

# c# - C# 错误：运算符“==”不能应用于“System.Windows.Forms.DialogResult”和“bool”类型的操作数

> ID：11615481
> 
> 赞同：1
> 
> 时间：2012-07-23T15:19:41.627
> 
> 标签：c#, visual-studio-2010, forms

在 Visual Studio C# Express 上，当我运行下面的脚本时，我在行中收到以下错误消息：

> if (ofd.ShowDialog() == true): 错误 1 ​​运算符“==”不能应用于“System.Windows.Forms.DialogResult”和“bool”类型的操作数

我怎么能解决这个问题？下面的代码：

```
public override GH_ObjectResponse RespondToMouseDoubleClick(GH_Canvas sender, GH_CanvasMouseEvent e)
{
    System.Windows.Forms.OpenFileDialog ofd = new  System.Windows.Forms.OpenFileDialog();
    ofd.Multiselect = true;

    ofd.Filter = "Data Sources (*.ini)|*.ini*|All Files|*.*";
    if (ofd.ShowDialog() == true)
    {
        string[] filePath = ofd.FileNames;
        string[] safeFilePath = ofd.SafeFileNames;
    }
    return base.RespondToMouseDoubleClick(sender, e);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-23T15:21:44.087

将其替换为：

```
if (ofd.ShowDialog() == DialogResult.OK) 
```

`ShowDialog`方法返回[DialogResult](http://msdn.microsoft.com/en-us/library/system.windows.forms.dialogresult.aspx)枚举，它有以下成员：

*   没有任何
*   好的
*   取消
*   中止
*   重试
*   忽视
*   是的
*   不

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T15:22:35.590

我怀疑您一直在阅读方法结果所在的[WPF`OpenFileDialog.ShowDialog`文档](http://msdn.microsoft.com/en-us/library/cc190792.aspx)`Nullable<bool>`。但是，如果您使用的是[Windows Forms`OpenFileDialog.ShowDialog`](http://msdn.microsoft.com/en-us/library/e61ft40c.aspx)，则会返回[`DialogResult`](http://msdn.microsoft.com/en-us/library/system.windows.forms.dialogresult.aspx)- 您显然无法与`bool`.

看看`DialogResult`你*真正*想要做什么。请注意，文档声称：

> 返回：DialogResult.OK 如果用户在对话框中点击OK；否则，DialogResult.Cancel。

...所以这些应该是您需要考虑的唯一情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:20:47.587

`DialogResult`与为类似 DialogResult.OK定义的值中的一个进行比较，而不是布尔值。

```
if (ofd.ShowDialog() == DialogResult.OK)
{

} 
```

DialogResults 的可能值如下所示。与您需要的比较。

```
DialogResult.None
DialogResult.OK
DialogResult.Cancel
DialogResult.Abort
DialogResult.Retry
DialogResult.Ignore
DialogResult.Yes
DialogResult.No 
```

# ios - 在选项卡内推送和弹出视图的 TabView 应用程序

> ID：11615485
> 
> 赞同：0
> 
> 时间：2012-07-23T15:19:52.477
> 
> 标签：ios, view, tabs, subview, tabbarcontroller

这是我第二次问这个问题，但我确实觉得有更多的经验，也许这次可以说得更好。

我有一个 iPhone 应用程序，它有 3 个选项卡，委托有一个 tabBarController，每个选项卡的屏幕上显示的 3 个视图分别由“FirstViewController”、“SecondViewController”和“ThirdViewController”控制。

第二个和第三个视图都是排序的。

所以这是我的问题。在第一个选项卡中，我有 20 个 UIButton，它们都连接到第一个视图控制器中各自的 IBOutlet 按钮和方法。目前我的每个方法都只是隐藏屏幕上的所有信息，所以理论上我可以在按下它们时取消隐藏诸如文本框之类的信息，但这在 IB 中变得非常混乱。

本质上，我希望每个按钮在按下时都能显示一个新的屏幕/视图，该屏幕/视图具有自己的 .xib 文件，我可以将所有信息放在包括一个后退按钮（另一个 UIButton）上，当按下该按钮时会破坏当前屏幕并返回到 tabA 的原始视图。

这将如何完成？

我确实尝试过创建一个新类，一个带有自己的 .xib 的 UIView 类。然后我在其中一种方法中设置了 3 行代码，这些代码基本上使用 .xib 设置新视图，然后将其添加为子视图。这工作正常并带来了新的屏幕但是我无法删除这个特定的子视图以返回到原始视图。

感谢您的任何帮助。

```
#import <UIKit/UIKit.h>
#import "E87view.h"

@interface FirstViewController : UIViewController {

IBOutlet UIButton *E87, *E81, *F20, *E36, *E46, *E90,
                    *E34, *E39, *E60, *E63, *E64, *E38,
*E65, *F01, *X3, *X5, *Z3, *Z4, *M3, *M5, *backButton;

IBOutlet UILabel *ones, *threes, *fives, *sixs, *sevens, *xs, *zs, *ms;

IBOutlet UITextView *mainText;

}

-(IBAction) E87Pressed; 
-(IBAction) E81Pressed; 
-(IBAction) F20Pressed; 
-(IBAction) E36Pressed; 
-(IBAction) E46Pressed; 
-(IBAction) E90Pressed; 
-(IBAction) E34Pressed; 
-(IBAction) E39Pressed; 
-(IBAction) E60Pressed; 
-(IBAction) E63Pressed; 
-(IBAction) E64Pressed; 
-(IBAction) E38Pressed; 
-(IBAction) E65Pressed; 
-(IBAction) F01Pressed; 
-(IBAction) X3Pressed; 
-(IBAction) X5Pressed; 
-(IBAction) Z3Pressed; 
-(IBAction) Z4Pressed; 
-(IBAction) M3Pressed; 
-(IBAction) M5Pressed; 
-(IBAction) backButtonPressed;

-(void) hideAll;
-(void) showAll;

@end 
```

还有 .m 文件。显然没有注意 hide 和 show 方法中的隐藏元素。显然我不想使用这种方法，我想推送和弹出新屏幕。保持我的标签

```
#import "FirstViewController.h"
#import "E87view.h"

@implementation FirstViewController

-(void) hideAll{
E87.hidden = 1;
E81.hidden = 1;
F20.hidden = 1;
E36.hidden = 1;
E46.hidden = 1;
E90.hidden = 1;
E34.hidden = 1;
E39.hidden = 1;
E60.hidden = 1;
E63.hidden = 1;
E64.hidden = 1;
E38.hidden = 1;
E65.hidden = 1;
F01.hidden = 1;
X3.hidden = 1;
X5.hidden = 1;
Z3.hidden = 1;
Z4.hidden = 1;
M3.hidden = 1;
M5.hidden = 1;
ones.hidden = 1;
threes.hidden = 1;
fives.hidden = 1;
sixs.hidden = 1;
sevens.hidden = 1;
xs.hidden = 1;
zs.hidden = 1;
ms.hidden = 1;
mainText.hidden = 1;
backButton.hidden = 0;
}

-(void) showAll{
E87.hidden = 0;
E81.hidden = 0;
F20.hidden = 0;
E36.hidden = 0;
E46.hidden = 0;
E90.hidden = 0;
E34.hidden = 0;
E39.hidden = 0;
E60.hidden = 0;
E63.hidden = 0;
E64.hidden = 0;
E38.hidden = 0;
E65.hidden = 0;
F01.hidden = 0;
X3.hidden = 0;
X5.hidden = 0;
Z3.hidden = 0;
Z4.hidden = 0;
M3.hidden = 0;
M5.hidden = 0;
ones.hidden = 0;
threes.hidden = 0;
fives.hidden = 0;
sixs.hidden = 0;
sevens.hidden = 0;
xs.hidden = 0;
zs.hidden = 0;
ms.hidden = 0;
mainText.hidden = 0;
}

-(IBAction) backButtonPressed{
[self showAll];
backButton.hidden = 1;
//[self.navigationController popToRootViewControllerAnimated:YES];

//for (UIView *subview in [self.view subviews]) {

//  [subview removeFromSuperview];
//}
//[self showAll];

}

-(IBAction) E87Pressed{
[self hideAll];
//E87view *e87view = [[E87view alloc] initWithNibName:@"E87view" bundle:[NSBundle mainBundle]];
//[self.navigationController pushViewController:e87view animated:YES];
//[self.view addSubview:e87view.view];
}

// The designated initializer. Override to perform setup that is required before the view is loaded.
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
    [self showAll];
}
[self showAll];
return self;
}

// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView {

[self showAll];
}

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {
[super viewDidLoad];

//backButton.hidden = 1;
[self showAll];
self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"BackdropService.png"]];
backButton.hidden = 1;

}

/*
// Override to allow orientations other than the default portrait orientation.
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation     {
// Return YES for supported orientations
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}
*/

- (void)didReceiveMemoryWarning {
// Releases the view if it doesn't have a superview.
[super didReceiveMemoryWarning];

// Release any cached data, images, etc that aren't in use.
}

- (void)viewDidUnload {
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (void)dealloc {
[super dealloc];
}

@end 
```

当然，我有一个名为 E87view 的新 .h 和 .m 文件，它有自己的 .xib 文件。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:       (NSDictionary *)launchOptions {    

// Override point for customization after application launch.

// Add the tab bar controller's view to the window and display.
[self.window addSubview:tabBarController.view];
[self.window makeKeyAndVisible];

return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:27:05.993

您可以嵌入`FirstViewController`并`UINavigationController`使用：

```
 [self.navigationController pushViewController:theButtonController animated:YES]; 
```

然后使用在导航栏上创建的后退按钮或摆脱导航栏并使用以下方法创建自己的后退按钮：

```
[self.navigationController popViewControllerAnimated:YES]; 
```

这种方法将使您的标签保持在底部。

如果您不关心保持标签存在，那么您可以使用`modalViewController`这样的：

```
[self presentModalViewController:theModalController animated:YES]; 
```

然后，我将创建一个协议，`theModalController`该协议将在完成时回调`FirstViewController`。然后`FirstViewController`将使用此代码关闭`theModalController`：

```
[self dismissModalViewControllerAnimated:YES]; 
```

所以有两种方法。`UINavigationController`如果您想保留标签并只需将`viewController`s 压入堆栈，请使用 a 。如果您在使用这些新的 s 时不关心保留标签，`viewController`那么您可以`modalViewController`在上面使用它们，它们将占据整个屏幕。

希望这可以帮助！

编辑：这是您可以设置导航控制器的方式，您需要为您`#import`的`.h`每个`viewControllers``AppDelegate.h`

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:       (NSDictionary *)launchOptions {    

    self.tabBarController = [[[UITabBarController alloc] init];

    FirstViewController* vc1 = [[FirstViewController alloc] init];
    SecondViewController* vc2 = [[SecondViewController alloc] init];
    ThirdViewController* vc3 = [[ThirdViewController alloc] init];

    UINavigationController* navController = [[UINavigationController alloc]
                            initWithRootViewController:vc1];

    NSArray* controllers = [NSArray arrayWithObjects:navController, vc2, vc3, nil];
    tabBarController.viewControllers = controllers;

    window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    window.rootViewController = tabBarController;
    [window makeKeyAndVisible];

} 
```

之后，FirstViewController 将被嵌入到 a 中`UINavigationController`，并且可以使用我上面使用的 pop 和 push 代码。

# css - 扩展超过 100% 的表格的 Google Chrome 问题

> ID：11615491
> 
> 赞同：0
> 
> 时间：2012-07-23T15:20:11.240
> 
> 标签：css, google-chrome, tablelayout

我有一个 100% 的表格和 2 个单元格，一个是 60%，另一个是 40% 在 60% 的内部有一个超过 60% 的图像。大多数浏览器都说没问题，只是缩小 40% 的文本，这只是文本。

谷歌浏览器只是扩展了 60%，从而使表格超过 100%。

正确的解决方案是只更改宽度，但我正在使用 CMS 系统，这些就像“模板”，是否有可能通过 CSS 要求 Google Chrome 尊重 100% 表格宽度的解决方案？

任何想法——也许我可以通过一段 CSS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:25:12.720

啊，也许找到了答案——table-layout:fixed as a style

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:45:37.033

您可以尝试通过应用来解决问题

```
style="width:100%" 
```

到 td 中的图像

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T08:21:11.863

真的很奇怪，我在 CMS 中浏览了我们的其他一些站点来尝试这个，其中一些具有与这个相似的布局，但它们并没有中断。

所以这可能是谷歌浏览器中的一个错误——当然找到真正的修复是很棘手的。然而，如果你从第一个单元格中删除 40%，那么谷歌浏览器会像其他浏览器一样思考，只是增加另一个单元格，将其全部排序。

我查看了具有此布局的所有其他站点，并且看起来都很好。

感谢你的帮助。

理查德

# javascript - 必应地图 v7 模块未加载

> ID：11615494
> 
> 赞同：2
> 
> 时间：2012-07-23T15:20:16.283
> 
> 标签：javascript, asp.net, bing-maps

我正在尝试使用[Well Known Text Reader/Writer](http://bingmapsv7modules.codeplex.com/wikipage?title=Well%20Known%20Text%20Reader%2fWriter)，但在加载模块时遇到问题。我在这里加载模块：

```
Microsoft.Maps.registerModule("WKTModule", "../../JS/WKTModule.js");
Microsoft.Maps.loadModule("WKTModule"); 
```

然后我定义一个图层来添加形状：

```
var countyLayer = new Microsoft.Maps.EntityCollection(); 
```

但是当我尝试在下一个块中使用模型时，我收到错误“未定义 WKTModule”

```
jQuery.each(config.CountyData, function (k, v) {
    var polygon = WKTModule.Read(v.Value, { polygonOptions: { fillColor: new Microsoft.Maps.Color(50, 255, 0, 0), strokeColor: new Microsoft.Maps.Color(255, 0, 0, 0), strokeThickness: parseInt(1)} });
    countyLayer.push(polygon);
}); 
```

**编辑：找到修复**

我猜它发生的是当我尝试使用它进行读取时模块没有及时加载。因此，我不只是在加载后调用该方法，而是将该函数添加到加载的设置中，以便在加载后调用该函数。这是新代码：

```
Microsoft.Maps.loadModule("WKTModule", { callback: addCounties });

var addCounties = function() {    
    jQuery.each(config.CountyData, function (k, v) {
        var polygon = WKTModule.Read(v.Value, { polygonOptions: { fillColor: new Microsoft.Maps.Color(50, 255, 0, 0), strokeColor: new Microsoft.Maps.Color(255, 0, 0, 0), strokeThickness: parseInt(1)} });
        countyLayer.push(polygon);
    });
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-06T09:34:10.493

原因是您试图在加载模块之前使用它。不要忘记它是一个外部文件，应该加载。

您可以使用该`callback`选项在加载模块时调用函数。

```
Microsoft.Maps.loadModule("WKTModule" {callback: function() {

    console.log('the module is ready now');
}}); 
```

# iphone - 流媒体广播 ios

> ID：11615496
> 
> 赞同：0
> 
> 时间：2012-07-23T15:20:20.107
> 
> 标签：iphone, ios, xcode, streaming, radio

您好，我正在寻找有关如何在我的应用程序中实现无线电 .mp3 流的良好指南。我搞砸了 matt Gallagher 教程“流式传输和播放 MP3 流”。并让它在 ios4 中工作（也可以在后台播放），但后来我想在 ios5 中使用它并且有很多错误。（因为 ARC）我听说还有其他方法可以通过 AVPlayer 类实现 .mp3。

有人知道我可以使用的简单实现或示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T12:10:06.400

如果您在启用 arc 的项目中使用非 arc 代码，您可以指定哪些文件是非 arc 并且一切都会按预期工作。只需将“-fno-objc-arc”标志添加到这些文件中。

# python - 在 Python 中使用 pandas 解析 YYYYMMDD 和 HH 位于不同列中的日期

> ID：11615504
> 
> 赞同：26
> 
> 时间：2012-07-23T15:20:43.083
> 
> 标签：python, pandas

我有一个与 csv 文件和解析日期时间相关的简单问题。

我有一个如下所示的 csv 文件：

```
YYYYMMDD, HH,    X
20110101,  1,   10
20110101,  2,   20
20110101,  3,   30 
```

我想使用 pandas (read_csv) 阅读它，并将它放在由日期时间索引的数据框中。到目前为止，我已经尝试实现以下内容：

```
import pandas as pnd
pnd.read_csv("..\\file.csv",  parse_dates = True, index_col = [0,1]) 
```

我得到的结果是：

```
 X
YYYYMMDD    HH            
2011-01-01 2012-07-01   10
           2012-07-02   20
           2012-07-03   30 
```

正如您在将 HH 转换为不同日期时看到的 parse_dates 一样。

是否有一种简单有效的方法可以将“YYYYMMDD”列与“HH”列正确组合以获得类似的东西？：

```
 X
Datetime              
2011-01-01 01:00:00  10
2011-01-01 02:00:00  20
2011-01-01 03:00:00  30 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-23T17:45:03.773

如果将列表传递给`index_col`，则意味着您要从列表中的列中创建层次索引。

此外，`parse_dates`关键字可以设置为 True 或列表/字典。如果为 True，则它会尝试将各个列解析为日期，否则它将组合列以解析单个日期列。

总之，你想要做的是：

```
from datetime import datetime
import pandas as pd
parse = lambda x: datetime.strptime(x, '%Y%m%d %H')
pd.read_csv("..\\file.csv",  parse_dates = [['YYYYMMDD', 'HH']], 
            index_col = 0, 
            date_parser=parse) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-30T07:15:45.510

我一直在这样做，所以我测试了不同的速度方法。我发现最快的是以下，大约。在考虑文件解析和日期解析的总时间时，至少在我的情况下，比 Chang She 的解决方案快 3 倍：

首先，使用不解析日期的 pd.read_csv 解析数据文件。我发现它大大减慢了文件读取速度。确保 CSV 文件的列现在是数据框 df 中的列。然后：

```
format = "%Y%m%d %H"
times = pd.to_datetime(df.YYYYMMDD + ' ' + df.HH, format=format)
df.set_index(times, inplace=True)
# and maybe for cleanup
df = df.drop(['YYYYMMDD','HH'], axis=1) 
```

# iphone - 在任何应用程序启动之前打开默认视图

> ID：11615505
> 
> 赞同：0
> 
> 时间：2012-07-23T15:20:45.280
> 
> 标签：iphone, ipad

我正在制作安全应用程序，我想在其中阻止 iPhone 的某些服务。所以我需要的是在任何应用程序启动之前，有一个简单的视图供用户输入密码。如果密码正确，应用程序将启动，否则应用程序将关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T17:44:13.457

如果您想根据 Apple 的沙盒理论通过应用商店发布您的应用，则不能这样做。即使有办法做到这一点，你也会被苹果拒绝。

# asp.net-mvc-3 - asp.net mvc3表单认证，是否可以设置多个AuthCookies？

> ID：11615506
> 
> 赞同：0
> 
> 时间：2012-07-23T15:20:46.700
> 
> 标签：asp.net-mvc-3, asp.net-membership, forms-authentication, membership-provider

用户登录后。我将他们的用户名保存到 cookie 中。

```
FormsAuthentication.SetAuthCookie(userName, createPersistentCookie); 
```

用户有角色，“成员”、“员工”、“经理”

对于那些只允许管理员进入的页面。我现在所做的是使用他们的用户名查询数据库。

GetRoles（用户名）

这会产生很多开销，每次他们访问受角色保护的页面时，我都需要检查数据库。

我想知道是否可以让 SetAutheCookie 设置一些值，而不仅仅是用户名。

我现在所做的是将用户名、角色组合在一个字符串中。

FormsAuthentication.SetAuthCookie(userName + "|" + role.tostring(), createPersistentCookie);

这绝对不是最好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:51:21.303

此 SO 问题的最受好评的答案提供了在表单身份验证 cookie 中存储和检索角色的示例：[存储/分配身份验证用户的角色](https://stackoverflow.com/questions/1822548/mvc-how-to-store-assign-roles-of-authenticated-users)

# php - 警告：无法修改标头信息 - 标头已由...发送标头刷新、重定向

> ID：11615511
> 
> 赞同：-3
> 
> 时间：2012-07-23T15:21:04.997
> 
> 标签：php, html, header, refresh

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

运行用户登录脚本后尝试重定向时出现此错误。

它尝试在此行更改标题数据：

```
header("Refresh: 2; url=index.php"); 
```

这是完整的 login.php 脚本。

```
<?php 
session_start();
require_once('init.php');

$username = trim($_POST['username']);
// create a new object
$login = new Auth($_POST, $dbh);

    if($login->validateLogin()){

        $_SESSION['loggedin'] = true;
        $_SESSION['username'] = $username;
        $list = $login->getUserInfo();
        $_SESSION['id'] = $list['id'];
        $_SESSION['thumb'] = $list['img_thumb'];

        echo '<div class="content">';
        echo '<h1>Thank you for logging in '.$username.'. Redirecting...</h1>';
        echo '</div>';
        header("Refresh: 2; url=index.php");

    }else{

        echo '<div class="content">';
        echo '<h1>Sorry but we didn\'t recognise those login details, please try again.</h1>';
        echo '</div>';

    }

require_once('inc/footer.inc.php');
?> 
```

init.php 文件调用包含 html5 文档类型、元标记等的 header.php。

登录后如何将用户重定向到索引页面并像往常一样发送标题信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:23:27.120

来自[PHP 文档](http://php.net/manual/en/function.header.php)。

> 请记住，`header()`必须在发送任何实际输出之前调用它，无论是通过普通 HTML 标记、文件中的空白行还是通过 PHP。

如果您希望页面在几秒钟后重定向，您将需要使用[Meta Refresh](http://en.wikipedia.org/wiki/Meta_refresh)。

```
<meta http-equiv="refresh" content="5;URL='http://example.com/'"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:23:41.890

只需将`header()`调用移到任何`echo`语句之前：

```
<?php
/* ... */
if($login->validateLogin()){

    $_SESSION['loggedin'] = true;
    $_SESSION['username'] = $username;
    $list = $login->getUserInfo();
    $_SESSION['id'] = $list['id'];
    $_SESSION['thumb'] = $list['img_thumb'];

    header("Refresh: 2; url=index.php"); // Put this *before* any output
    echo '<div class="content">';
    echo '<h1>Thank you for logging in '.$username.'. Redirecting...</h1>';
    echo '</div>';

}else{

    echo '<div class="content">';
    echo '<h1>Sorry but we didn\'t recognise those login details, please try again.</h1>';
    echo '</div>';

}
/* ... */ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:24:12.390

使用 echo 然后尝试为 Location 设置标头将始终引发该错误。¿ 让用户知道重定向比重定向他们更好吗？如果你想显示这样的消息（如果它曾经有效，这种方法不会显示它一秒钟），你应该使用 javascript 来更新内容并使用某种延迟......

...但也许这是太多的工作。如果登录后显示欢迎信息，应该就足够了，对吧？:)

# sql - 如何按日期分组，从不同于午夜的时间开始？

> ID：11615514
> 
> 赞同：0
> 
> 时间：2012-07-23T15:21:08.193
> 
> 标签：sql

如果可能的话，我想在一份声明中做到这一点。

我原来的查询是这样的：

```
SELECT CAST(Date as DATE) as DayDate, SUM(Books) as LostBooks 
FROM RestartBooksView 
WHERE Name = 'AUHT167' and Date > (getdate() - 105) 
GROUP BY CAST(Date as DATE) 
ORDER BY CAST(Date as DATE) ASC 
```

这个查询的问题是我希望总和反映在上午 7 点到 7 点，而不是当前的 12 点到 12 点。如何修改我的查询以反映此更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:24:45.183

假设“日期”列实际上是一个日期时间。

```
SELECT CAST(Date as DATE) as DayDate, SUM(Books) as LostBooks
FROM (select rbv.*,
             cast(dateadd(h, -7, date) as date) as newdate
      from RestartBooksView rbv
     )
WHERE Name = 'AUHT167' and newdate > (getdate() - 105)
GROUP BY newdate
ORDER BY CAST(Date as DATE) ASC 
```

我还使用了 SQL Server 日期函数，因为您似乎正在使用该数据库。

# c# - ViewPort3D：如何从后面的代码创建一个带有文本的 WPF 对象（多维数据集）

> ID：11615519
> 
> 赞同：2
> 
> 时间：2012-07-23T15:21:20.317
> 
> 标签：c#, wpf, wpf-controls, viewport3d, helix-3d-toolkit

我想绘制一组 3D 立方体，每个立方体都应该显示一个名称，并且在选择立方体时也应该有自己的事件处理程序。

是否可以使用后面的代码或 xaml 绑定来实现它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T08:22:19.980

要从后面的代码中绘制 3D 立方体，我将使用 Helix3D 工具包 CubeVisual3D。但是，如果您想坚持使用现有的 WPF 3D 元素，则实现起来相当简单。

从这里开始了解 3D 环境中的文本[http://www.codeproject.com/Articles/33893/WPF-Creation-of-Text-Labels-for-3D-Scene](http://www.codeproject.com/Articles/33893/WPF-Creation-of-Text-Labels-for-3D-Scene)将指导您通过两种不同的方法将文本添加到3D 图像，我觉得很有帮助。

对于立方体只需使用一个 RectangleVisual3D 对象 类似这样的东西。

```
 RectangleVisual3D myCube = new RectangleVisual3D();
    myCube.Origin = new Point3D(0, 0, 0); //Set this value to whatever you want your Cube Origen to be.
    myCube.Width = 5; //whatever width you would like.
    myCube.Length = 5; //Set Length = Width
    myCube.Normal = new Vector3D(0, 1, 0); // if you want a cube that is not at some angle then use a vector in the direction of an axis such as this one or <1,0,0> and <0,0,1>
    myCube.LengthDirection = new Vector3D(0, 1, 0); //This will depend on the orientation of the cube however since it is equilateral just set it to the same thing as normal.
    myCube.Material = new DiffuseMaterial(Brushes.Red); // Set this with whatever you want or just set the myCube.Fill Property with a brush type. 
```

太添加事件处理程序我相信您必须将处理程序添加到 Viewport3D。这种性质的东西应该起作用。

```
 public Window1()
    {
    InitializeComponent();
    this.mainViewport.MouseDown += new MouseButtonEventHandler(mainViewport_MouseDown);
    this.mainViewport.MouseUp += new MouseButtonEventHandler(mainViewport_MouseUp);
    } 
```

然后添加这个功能

```
 ModelVisual3D GetHitResult(Point location)
    {
    HitTestResult result = VisualTreeHelper.HitTest(mainViewport, location);
    if(result != null && result.VisualHit is ModelVisual3D)
    {
    ModelVisual3D visual = (ModelVisual3D)result.VisualHit;
    return visual;
    }

    return null;
    } 
```

然后添加事件处理程序

```
 void mainViewport_MouseUp(object sender, MouseButtonEventArgs e)
    {
    Point location = e.GetPosition(mainViewport);
    ModelVisual3D result = GetHitResult(location);
    if(result == null)
    {
    return;
    }
    //Do Stuff Here
    }

    void mainViewport_MouseDown(object sender, MouseButtonEventArgs e)
    {
    Point location = e.GetPosition(mainViewport);
    ModelVisual3D result = GetHitResult(location);
    if(result == null)
    {
    return;
    }
    //Do Stuff Here
    } 
```

# php - 密码哈希/登录

> ID：11615522
> 
> 赞同：2
> 
> 时间：2012-07-23T15:21:30.363
> 
> 标签：php

我正在创建一个需要用户授权才能访问某些功能的网站。我目前正在研究用户如何创建帐户以及如何利用会话来授权他们的登录。用户信息存储在名为 user 的 MySQL 表中，其中可能包括用户名和密码的引用。

我一直在阅读密码散列/盐以确保安全，并希望一些 PHP 大师的输入，考虑到我仍然是该语言的新手。

我写了以下脚本：

```
define('SALT_LENGTH', 6);

function generateHash($plaintext, $salt==null){
    if($salt == null){
        $salt = substr(md5(uniqid(rand(), true)), 0, SALT_LENGTH);
    }
    else{
        $salt = substr($salt, 0, SALT_LENGTH);
    }

    return $salt . sha1($salt . $plaintext);
}
?> 
```

这是一个用于生成带有盐的哈希的函数。

```
$username = $_POST['username'];
$password = generateHash($_POST['password']);
try{
    $stmt = $pdo->prepare(INSERT INTO user VALUES (:username, :password, :location,     :email, :name);
}catch(PDOException $e){
    echo $e->getMessage();
}
    $stmt->execute(array(':username'=>$username, 
                         ':password'=>$password, 
                         ':location'=>$location, 
                         ':email'=>$email, 
                         ':name'=>$name); 
```

这是创建帐户的脚本的重要部分

```
if(isset($_POST)){
    //if form was submitted

    $username = $_POST['username'];
    $password = generateHash($_POST['password']);

    session_start();

    $user = 'root';
    $pass = null;
    $pdo = new PDO('mysql:host=localhost; dbname=divebay;', $user, $pass);

    try{
        $stmt = $pdo->prepare('SELECT username FROM user WHERE username =     :username AND password = :password');
        $stmt->execute(array(':username'=>$username,
                             ':password'=>$password);

        if($stmt->fetch(PDO::FETCH_ASSOC)){
            echo 'match';
        }
        else{
            echo 'nomatch';
        } 
```

这是在数据库中查找用户的登录会话脚本

我的主要问题是这种散列/盐看起来会起作用吗？我对用于在一个实例中创建加密的哈希（创建帐户）如何能够与在不同实例中创建的哈希一起工作感到困惑。此外，我试图创建的内容的复杂性是否适合一个可能永远不会正确部署的相对简单的软件项目？

任何其他关于我的脚本错误的建议也将不胜感激（我需要批评）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:31:19.757

我对您的建议是寻找一个为您执行此操作的库/框架。许多框架会自动并正确地为您处理这类事情，通常包括基于角色的授权。身份验证和授权并不是很难做到，但它们已经足够难了，除非您将其作为学习练习，否则您应该尽量避免自己做。

至于您的代码的正确性，我认为您需要使用与您帐户名上存储的密码匹配的盐来比较密码。您应该在数据库中查找给定用户名的密码哈希，从该密码哈希（您正确附加）中检索盐，然后在提供的密码上使用检索到的盐来获取哈希。然后，您将哈希与存储的哈希进行字符串比较以进行身份​​验证。

我不太了解 PHP，但我确信存在一个可以为您处理此问题的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:23:36.750

看起来不对，当没有提供盐时，您会随机选择一个不存储的盐。

在散列之后，您将尝试记录您的用户，您将对提供的密码进行散列，计算它的散列并将其与存储在数据库中的密码进行检查。如果您的散列可以随时间变化，则这不是散列。

您必须使用常量盐（可能比六个字符长的盐长），或者将生成的盐存储在数据库中。您必须能够为完全相同的输入计算完全相同的哈希值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:23:44.190

只要`generateHash`在登录时同时调用密码创建和密码检查，由于相同的输出（假设相同的输入），此哈希将正常运行。

然而，就目前而言，情况似乎并非如此。您需要将`$salt`（因为它是随机生成的）存储在数据库中并在检查期间检索它。

# user-interface - MS CRM 2011 Online 中团队/用户的自定义菜单

> ID：11615523
> 
> 赞同：0
> 
> 时间：2012-07-23T15:21:37.463
> 
> 标签：user-interface, menu, customization, dynamics-crm-2011, dynamics-crm-online

有谁知道如何自定义 MS CRM 2011（云）中的菜单，以便某些用户/团队不会出现某些选项（例如营销），但会继续为管理员或高级用户显示？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T20:03:49.463

对于站点地图，您需要使用“特权”规则。

这是站点地图上的一些文档：http: [//msdn.microsoft.com/en-us/library/gg334430.aspx](http://msdn.microsoft.com/en-us/library/gg334430.aspx)

这是使用特权规则显示/隐藏区域的示例： [http ://worldofdynamics.blogspot.com/2012/04/dynamics-crm-2011-restricthide-settings.html](http://worldofdynamics.blogspot.com/2012/04/dynamics-crm-2011-restricthide-settings.html)

# ms-access - MS-Access 避免从表单域 Word 文档中导入空域

> ID：11615527
> 
> 赞同：2
> 
> 时间：2012-07-23T15:21:43.347
> 
> 标签：ms-access, vba, import, ms-word, form-fields

我正在尝试将我创建的表单字段 word 文档中的字段导入到 MS-Access 表中。导入工作正常，除非其中一个日期字段中有 null，然后它会引发类型不匹配错误。如何避免出现此错误？

```
Dim rst As New ADODB.Recordset
With rst
    .AddNew
    !BPRid = doc.FormFields("frmBPRid").Result
    If Not IsNull(doc.FormFields("frmReceiptDate").Result) Then
    !ReceiptDate = doc.FormFields("frmReceiptDate").Result
    End If    
    .Update
    .Close
End With 
```

如上所示，我尝试将其包装在 if 语句中，但它似乎无法将该字段识别为 null。任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:23:25.717

我怀疑它可能是一个零长度字符串（“”）。

您可能喜欢使用 IsDate。

```
If IsDate(doc.FormFields("frmReceiptDate").Result) Then
   !ReceiptDate = doc.FormFields("frmReceiptDate").Result
End If 
```

对于其他数据类型，您可以检查零长度字符串和空格填充字段，如下所示：

```
If Trim(doc.FormFields("frmReceiptDate").Result & "") <> vbNullString 
```

# java - Spring OAuth2 刷新令牌

> ID：11615528
> 
> 赞同：0
> 
> 时间：2012-07-23T15:21:52.813
> 
> 标签：java, spring, oauth, oauth-2.0

我无法使用刷新令牌。查看端点的配置：/oauth/token：

```
<intercept-url pattern="/oauth/token" access="IS_AUTHENTICATED_FULLY" /> 
```

它声明您必须经过完全身份验证，这是有道理的。唉，刷新令牌的第二部分使用相同的端点（只是状态：grant_type=refresh_token）。

但是：您不应该通过身份验证来获取刷新令牌。那么如何解决这个问题呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T05:50:46.483

从春季团队那里得到了一些很好的帮助。我将在这里“复制”他们的答案。

/oauth/token 上的安全保护是 Oauth2 而不是基本的 spring 安全性。如果您提供客户端 ID 和客户端密码，则可以通过。所以不是基本的！

谢谢春天！

# iphone - xcode：如何在某些视图之外禁用手势识别器？

> ID：11615529
> 
> 赞同：0
> 
> 时间：2012-07-23T15:22:06.200
> 
> 标签：iphone, xcode, uigesturerecognizer

我有一个用于 uiimageView 的一键式手势识别器，使用户能够在此 uiimageview 上录制的任何位置点击并添加 uiTextField。

有时我将文本字段从 uiimageview 中取出（附近）的问题。我希望文本字段无论如何都不会超过 uiimageview 框架。

这是我在 ViewDidLoad 中的代码：

```
// Create gesture recognizer
recognizer = 
[[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(addText:)] autorelease];

// Set required taps and number of touches
[recognizer setNumberOfTapsRequired:1];
[recognizer setNumberOfTouchesRequired:1];

// Add the gesture to the view
[self.img addGestureRecognizer:recognizer]; 
```

在方法 addText 中：

```
CGPoint point = [recognizer locationInView:[self view]];

UITextField * textFld = [[UITextField alloc]init];

[textFld setDelegate:self];

[textFld addTarget:self action:@selector(imageMoved:withEvent:) forControlEvents:UIControlEventTouchDragInside];

[textFld setFont:[UIFont fontWithName:@"System Bold" size:fontSize]];

CGRect frame ;    
frame.origin.x = point.x;
frame.origin.y = point.y; 
frame.size.width=300;
frame.size.height=80;

textFld.frame=frame;

[self.img addSubview:textFld];

[textFld release]; 
```

最后是 imageMoved:withEvent:

```
- (IBAction) imageMoved:(id)sender withEvent:(UIEvent *) event
{
CGPoint point = [[[event allTouches] anyObject] locationInView:self.view];
UIControl *control = sender;
control.center = point;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T05:11:20.523

您可以使用您的`gestureRecognizer:shouldReceiveTouch:`方法`UIGestureRecognizerDelegate`来查看触摸发生的位置并决定是否要响应手势。`NO`如果触摸距离 UIImageView 的边缘太近，则返回，否则返回`YES`。或者简单地检查一下`touch.view`触摸是否发生在您的`UIImageView`.

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer 
       shouldReceiveTouch:(UITouch *)touch; 
```

# c++ - 在 C++11 中使用部分特化

> ID：11615532
> 
> 赞同：5
> 
> 时间：2012-07-23T15:22:16.737
> 
> 标签：c++, templates, c++11

我有以下代码：

```
template<class T, int I=44> struct test {T j = I;};

template<int J> struct test<int, J> {int j = J;};

int main()
{
  test<55> jj;

  std::cout << jj.j << std::endl;
  return(1);
} 
```

编译器（clang）仅抱怨该行`test<55> jj`

我不明白为什么？有解决办法吗？

如果它抱怨那条线，为什么不抱怨第二个模板定义呢？

提前致谢。

消息是：

```
enable.cpp:17:8: error: template argument for template type parameter must be a type
test<55> jj;
   ^~
enable.cpp:9:16: note: template parameter is declared here
template<class T, int I=44> struct test 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T16:09:50.530

问题是您还没有理解选择类模板专业化是如何工作的。

你的专业：

```
template<int J> struct test<int, J> {int j = J;}; 
```

不会创建您只需为其传递单个 int 模板参数的模板。

```
test<55> jj; // doesn't work because there's no template<int J> struct test 
```

相反，它所做的是创建一个特化`template<class T, int I> struct test`，当模板参数匹配特化时将使用该`template<class T, int I> struct test`特化，即`test<int,J>`.

```
test<int,55> jj; // uses the specialization template<int J> struct test<int, J> 
```

以下是标准中的关键引述：

> 在引用类模板特化的类型名称中（例如 `A<int, int, 1>`），实参列表应与主模板的模板形参列表匹配。**特化的模板参数是从主模板的参数推导出来的。** *[重点补充]*
> 
>                                                                                    *— 14.5.5.1 [temp.class.spec.match] p4*

* * *

您似乎试图设置`int`为的默认类型，`T`同时为`I`. 我认为您的意图是能够指定一个类型和一个值，仅指定一个类型并将 44 作为默认值，或者仅指定一个值并将 int 作为默认类型。

不幸的是，我不知道如何指定这样的独立默认值。您可以指定默认值 ( `template<class T=int, int I=44> struct test`)，但获取默认类型也需要接受默认值。

但是，如果您愿意使用第二个名称，那么您可以这样做：

```
template <int I>
using test_int = test<int, I>; 
```

这将创建一个模板别名，因此您只需指定一个值：

```
test_int<55> jj; 
```

这最终将使用`test<int, I>`发生的任何特化来解决是否存在显式特化或编译器生成隐式特化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T15:36:16.317

第一个错误发生是因为编译器试图用 55 实例化第*一个*模板参数 ( `class T`)。这不起作用，因为 55 本身不是类型，而是它的实例化。但是，`test<int>`因为这里的模板参数是模板签名所要求的类型，所以有效。

相反，您想要的是类型的“currying”，也就是。模板别名：

```
template <typename T>
struct test2 = using test<T, 55>; 
```

在这里您只需要提供一个`T` 选择 55 作为固定的第二个参数。但是您仍然需要通过给它一个具体的 来使用该类型`T`，例如`test2<double>`.

评论表明您也可能对以下变体感兴趣：

```
template <int I>
using test3 = test<int, I>; 
```

在这里，您将第一个类型参数固定为 int，这允许您像在代码中一样使用它：

```
test3<55> t; 
```

# c# - 我的基于 windows phone mango 的应用程序将为 WCF 操作服务消耗多少数据

> ID：11615541
> 
> 赞同：0
> 
> 时间：2012-07-23T15:22:47.183
> 
> 标签：c#, json, wcf, windows-phone-7

当位置发生变化并且位置阈值设置为 20m 时，我的基于 Windows Phone 芒果的应用程序会将其位置更新到我们在总部的主应用程序。我对此更新所做的另一件事是我希望每分钟只更新一次。因此，无论职位在这一分钟内是否多次更改，应用程序只应每 1 分钟到达总部。

我正在使用 Json 字符串将数据传输到 WCF 操作，该操作是一种方式。因此，包括请求和响应标头以及包含纬度、经度和速度的地理位置数据，如果有人可以帮助我估算每月总数据使用量，我需要帮助，因为数据 sim 仅允许 500 mb 数据。

我不是在寻找完美的答案，但我很困惑并在这里发布了我的问题。所以如果这看起来有点愚蠢的问题，请原谅我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:11:45.343

如果问题是传输数据的大小，您可以考虑“压缩”它们并将其传输为 byte[]

如果您想跟踪传输的大小，您可以在服务器上嗅探数据或（更简单的方法）测试与代理（例如提琴手）的通信。

还要记住，提供者添加头数据来封装 tcp 数据包，并且这些数据不是从服务器接收的

# joomla - 更改 Joomla 网站上的域，并自动更改链接？

> ID：11615542
> 
> 赞同：0
> 
> 时间：2012-07-23T15:22:54.343
> 
> 标签：joomla, ftp, dns, transfer

有问题的域是 www.carsmart.org.uk 这是一个基于 joomla 的网站，公司已经准备好了，我已经建立了一个新的，但他们希望把它放在不同的域上。我使用了 AKEEBA 备份，并在 www.vvvooom.co.uk 上恢复了它。主页是不可或缺的，但是许多链接已损坏，或者依赖于显然不存在的内容。

是否有任何自动化方法可以基本上获取 CARSMART.ORG.UK 站点并将其转移到新域，同时自动更新所有 url？

我曾考虑通过 FTP 获取所有文件并将它们放在那里，但我猜这行不通。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:28:12.940

您必须通过主机帐户的控制面板将新域连接到新站点。我不确定您使用的是什么主机或控制面板，因此您最好联系您的主机，我相信他们会欺骗您或更好地为您做这件事。

问候

# text - Eventbrite - 是否有预告文本/简短描述字段？

> ID：11615543
> 
> 赞同：0
> 
> 时间：2012-07-23T15:22:55.883
> 
> 标签：text, eventbrite, teaser

我将使用 Eventbrite API 来拉取事件列表以显示在网页上。我知道有一个描述字段，但是，我们还想显示有关该事件的预告文本。Eventbrite 事件是否存在这种类型的字段？

我提到了在....找到的 Eventbrite Event 对象

[http://developer.eventbrite.com/doc/events/event_get/](http://developer.eventbrite.com/doc/events/event_get/)

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:46:15.717

好建议！

目前，Eventbrite 事件缺少官方事件“摘要”内容字段。

作为一种短期解决方案，我建议从“描述”字段开始，删除您找到的任何 HTML 标记，然后将生成的字符串截断为您想要的长度。

这种额外的数据转换工作可以添加到您的 API 客户端代码中（如果您使用代码库连接到 Eventbrite API）。

# javascript - 检测 textarea 自然换行符

> ID：11615544
> 
> 赞同：0
> 
> 时间：2012-07-23T15:22:57.510
> 
> 标签：javascript, html

我有一个 textarea 元素，在它之上，我还有一个 div 块，它正好叠加在 textarea 上（例如：-facebook 评论框）。直到这个换行符进入场景，一切都变得很酷。所以我试图检测文本区域中的每个换行符（自然换行），并`<br/>`在遇到时将标签插入到 div 块中。

实际上，循环遍历 textarea 中的字符可以解决问题，但这会过度杀伤该过程，特别是当 textarea 的值恰好很长时。

html5 的“wrap-hard”属性正是我需要的，但这需要提交表单。

有人可以建议一种理想的方法来检测文本区域中的自然换行符吗？非常感谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:39:42.350

您可以在 div中使用`word-break`or属性：`white-space`

[http://caniuse.com/#feat=word-break](http://caniuse.com/#feat=word-break)
[http://www.w3schools.com/cssref/playit.asp?filename=playcss_white-space&preval=pre-line](http://www.w3schools.com/cssref/playit.asp?filename=playcss_white-space&preval=pre-line)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:55:06.297

希望这些链接对您有所帮助，

[JavaScript：如何向 HTML 文本区域添加换行符？](https://stackoverflow.com/questions/863779/textarea-line-breaks-javascript)

[http://www.sitepoint.com/forums/showthread.php?430599-lt-textarea-gt-new-line](http://www.sitepoint.com/forums/showthread.php?430599-lt-textarea-gt-new-line)

只测试返回字符

# android - android webapps 是简单的本机应用程序或只是网络链接

> ID：11615552
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:23:27.467
> 
> 标签：android

webapp 是一个简单的原生应用程序，它使用 webview，可以在移动设备中下载或完全通过 url 访问，而无需任何下载/安装为应用程序，并用作 url 链接图标？

rgds

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:26:58.040

Web 应用程序通常被归类为用户将“添加到主屏幕”并且不需要从应用程序商店下载/安装的网站。

“包装器”通常是包装在 webView 中的 webapp，这样它可以被制作成 APK 并上传到应用商店。这成为本机应用程序。

这是有关该主题的好读物：http: [//mobithinking.com/native-or-web-app/](http://mobithinking.com/native-or-web-app/)

# sql - sql存储过程中“AND type in (N'P', N'PC')”的用途和用途是什么？

> ID：11615559
> 
> 赞同：4
> 
> 时间：2012-07-23T15:23:57.213
> 
> 标签：sql, stored-procedures

我是创建存储过程的新手，我在现有存储过程中看到了下面的这个 sql：

```
IF  EXISTS (SELECT * FROM table WHERE object_id = OBJECT_ID(N'stored_proc_name') AND type in (N'P', N'PC'))
DROP PROCEDURE 'stored_proc_name' Go 
```

经过一番调查，我发现我们使用 N 表示可能存在的任何 unicode 字符。但是，我不确定为什么我们使用“输入（N'P'，N'PC'）”？

谁能解释一下这个构造？

还要确认我在这里使用 N 的想法是否正确？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-01T15:17:00.423

要添加到其他答案：

您正在检查对象 [dbo].[sp_NAME] 是否存在并且是存储过程 (P) 还是程序集存储过程 (PC)。

这是我们使用的示例：

```
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[sp_NAME]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[sp_NAME]
GO 
```

这是一个类似的[问题](https://stackoverflow.com/questions/10774059/stored-procedure-and-where-type-in-p-u-pc)和答案。

有关[程序集存储过程的信息。](http://msdn.microsoft.com/en-us/library/ms190790%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-23T15:31:10.833

是的，N 表示字符串是 unicode。

您还有什么是`in`运算符，即`n in (n, ...)`第一个操作数是字段`type`，括号中的值是两个 unicode 字符串。

因此，它与 具有相同的含义`and (type = N'P' or type = N'PC')`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:32:19.903

“N”是 Microsoft 表示常量 unicode 字符串（2 字节/字符而不是 1/字节/字符）的 Microsoft 方式。一些内置函数和存储过程需要它。

“P”和“PC”指定对象的类型。

# php - 如何在另一个查询 MySQL 上执行更新查询？

> ID：11615561
> 
> 赞同：2
> 
> 时间：2012-07-23T15:24:10.317
> 
> 标签：php, mysql, sql

我有这个查询：

```
SELECT notiser.notis AS notis
    , skapare.kategoriId
    , skapare.kategori AS kategori 
FROM notiser, skapare, anvandare 
WHERE skapare.kategori = 2 
    AND skapare.kategoriId =  448 
    AND skapare.id = notiser.skapareId 
    AND anvandare.id = skapare.anvandareId; 
```

它给了我结果：

```
notis   kategoriId  kategori
Hello!      448     2
Hello2!     448     2
Hello3!     448     2 
```

我想将“类别”的值更改为 3，仅针对这些特定结果。

是否可以？

我使用 PHP 和 mysql。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:30:57.550

您可以在语句中使用相同的`FROM`和。`WHERE``UPDATE`

```
UPDATE notiser, skapare, anvandare 
SET skapare.kategori = 3
WHERE skapare.kategori = 2 
    AND skapare.kategoriId =  448 
    AND skapare.id = notiser.skapareId 
    AND anvandare.id = skapare.anvandareId; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:28:12.130

不完全遵循，但为什么不`skapare.kategori`限制`3`

```
SELECT notiser.notis AS notis
    , skapare.kategoriId
    , skapare.kategori AS kategori 
FROM notiser, skapare, anvandare 
WHERE skapare.kategori = 3 
    AND skapare.kategoriId =  448 
    AND skapare.id = notiser.skapareId 
    AND anvandare.id = skapare.anvandareId; 
```

**更新** 我想我现在明白了：

```
UPDATE skapare SET skapare.kategori = 3 WHERE skapare.id IN(SELECT notiser.skapareId
FROM notiser, skapare, anvandare 
WHERE skapare.kategori = 2
    AND skapare.kategoriId =  448 
    AND skapare.id = notiser.skapareId 
    AND anvandare.id = skapare.anvandareId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:31:29.213

假设您`id`在表中有一个列`skapare`来标识单行，那么您可以使用以下查询：

```
UPDATE skapare set kategori=3
WHERE skapare.id IN
    (SELECT skapare.id 
     FROM notiser, skapare, anvandare 
     WHERE skapare.kategori = 2 
        AND skapare.kategoriId =  448 
        AND skapare.id = notiser.skapareId 
        AND anvandare.id = skapare.anvandareId); 
```

# php - 根据用户输入定向到 URL 的表单/提交按钮

> ID：11615564
> 
> 赞同：0
> 
> 时间：2012-07-23T15:24:19.550
> 
> 标签：php, html, codeigniter

我在网页上有一个表格：

```
<?php echo form_open('/search/processing'); ?>

<input type="text" name="query" size="50" />

    <input type="submit" name="1" value="1" /></br>
    <input type="submit" name="2" value="2" /></br>
    <input type="submit" name="3" value="3" /></br>

</form> 
```

它进入这个控制器功能：

```
public function processing()
{
// redirects here based on user input and what submit button was pressed
} 
```

我想知道是否可以摆脱此功能并根据用户输入的内容直接从表单重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:31:20.880

```
<script>
window.addEventListener('load', function(){
    document.getElementById('formid').addEventListener('submit', function(){
        for(var i = 0; i < this.length; i++)
            if(this[i].type == 'submit' &&
               this[i].value == 1) window.location.href = 'foo.com';
            else if( ... )
               ....
            else if( ... )
               ....
    }, false);
}, false);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:48:40.090

这是更改表单操作的纯 javascript 版本，它可能不是您想要的，因为您有 3 个单独的按钮，但它可能有用。

```
<script type="text/javascript">
function test()
 {
     if ( document.forms.form.test1.checked )
     {
         document.forms.form.action = "http://google.com";
     }

     return true;
 }
</script>
<form name="form" action="a.html" onsubmit="return test()">
    <input type="checkbox" id="test1" name="test1" />
    <input type="submit" value="submit" />
</form> 
```

基本上，如果您选中了该按钮，它将转到 google.com - 否则为 a.html

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:29:04.640

如果你想使用纯 PHP，那么：

```
if(isset($_POST['query']))
{
  switch($_POST['query'])
  {
    case 'hello': header('location: http://www.google.com'); break;
    case 'stack': header('location: http://www.ask.com'); break;
    case 'overflow': header('location: http://www.yahoo.com'); break;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:29:20.850

是的，这可以通过以下方式实现：注释所在的位置，包括重定向代码或函数调用。

```
if (isset($_POST['query']) {
  $value = $_POST['query'];
  if ($value == 1) {
    //do something
  }
  if ($value == 2) {
    //do something
  }
} 
```

# html - 如何制作一个下拉菜单，其中第二个下拉选项取决于第一个选择？

> ID：11615565
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:24:31.813
> 
> 标签：html, asp.net-mvc, drop-down-menu

我想要一个下拉菜单 第一个框中的选项是“州”和“省”，第二个将根据第一个选择（州->美国州，省->加拿大省）填充这是我的代码至今：

```
<form id="updateTreventLocation" action="
<table>

 <%=Url.Action("SavedTreventLocation","Prod")%>" method="post">
  <tr>
        <td colspan="2" class="label">City:</td>
        <td class="content">
            <input type="text" maxlength="100" name="CityLocation" value="<%=EditTreventLocation.locationCity%>" />
        </td>
    </tr>
       <tr>
        <td colspan="2" class="label">Province/State:</td>
        <td class="content">
            <input type="text" maxlength="50" name="ProvinceLocation" value="<%=EditTreventLocation.locationProvince%>" />
        </td>
    </tr>
    </table>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:38:51.833

以下链接中的答案应该可以帮助您开始根据第一个下拉列表制作动态更新的第二个下拉列表。

[根据另一个下拉列表中的选择填充一个下拉列表](https://stackoverflow.com/questions/5686735/populate-one-dropdown-based-on-selection-in-another)

# android - 在其他线程之前执行一个线程 - Android

> ID：11615566
> 
> 赞同：0
> 
> 时间：2012-07-23T15:24:34.550
> 
> 标签：android, multithreading, thread-safety, android-asynctask

我是 Android 编程新手，我正在实现类似于[http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html](http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html)

主要区别在于，为了弄清楚从哪些 URL 中获取我的图像，我必须`JSONobject`从特定 URL 中检索一个。如何控制我的线程`JSONobject`在检索到之前不运行，同时仍然使用`AsyncTask`线程来检索它`JSONobject`？

我应该使用处理程序还是 AsyncTask 的 OnPreExecute() 方法？如果是这样，我该如何使用它们？

谢谢！

# mysql - 高尔夫比分的 mySQL 数据库方案

> ID：11615572
> 
> 赞同：1
> 
> 时间：2012-07-23T15:24:46.930
> 
> 标签：mysql, sql

我正在设计一个数据库来存储高尔夫得分和其他关于每个洞或回合的统计数据，但我很难知道哪种方法最有效。我的问题集中在为课程和回合构建表格。这里有两个选项，虽然我不确定是否有更好的第三个选项。我正在使用 mySQL 5.1.63 和 PHP 5.2.17。CAPS 中的表格以提高可读性。

1.  有一个存储所有课程信息的大表，因为这些信息只会在数据库中列出一次（~100 列...18 个洞 * 每个洞有 4 个属性，除了课程名称、位置、电话等）
    *   课程：course_id、par_1、par_2、...par_18、distance_1、distance_2、...distance_18 等。
2.  将课程信息拆分为表格，在适当的时候将某些表格与 course_id 连接起来
    *   COURSE_PAR: course_id, par_1, par_2, ...par_18
    *   COURSE_DISTANCE: course_id, distance_1, distance_2, ...distance_18
    *   COURSE_INFO：course_id、course_name、地址、电话……
    *   等等

关于记录这一轮，可以问一个类似的问题。我有round_1、round_2、...、hit_fairway_1、hit_fairway_2、num_putts_1、num_putts_2，还是我将这些属性中的每一个分解到自己的表中？[这个](https://stackoverflow.com/q/4844593)问题及其答案倾向于将其分解为表格。这是否意味着这样的结构：

*   SCORE:hole_num, course_id, round_id, score, hit_fairway, num_putts, ...

重复查询（使用 PHP）将主要针对该人的击球是否高于或低于标准杆、击球道、推杆数等。

希望我的问题足够清楚。我知道那里有半相似的问题，就像上面提到的那样，但我无法将这些答案完全转移到我正在寻找的东西上。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:31:40.987

不知道“坡度”是什么，但一开始是这样的：

```
COURSE - one record per course
CourseID
AddressInfo
NumHoles - usually 9 or 18

HOLE - one set of these per course
CourseID
HoleNum
Par
Slope - you can add more here if you want (water, sand, etc.)

MATCH
CourseID
MatchID
MatchName
StartDate

ROUND
RoundID
MatchID
PlayerID
RoundNum
StartDate

SCORE - every time a player plays a hole, add one of these
CourseID
MatchID
RoundID
HoleID
PlayerID
NumPutts
NumStrokes - you can add more specifics if you want (fairway, rough)

PLAYER
PlayerID 
```

这就是您所说的“完全规范化”，并且表与表之间的数据重复最少。对于初学者来说，生成的 SQL 语句可能会有点复杂，但如果你现在就得到它，那将是值得的。

**编辑（2020 年）：**如果（如刚刚询问的那样）您需要每个洞支持多个发球台，请添加以下内容：

```
HOLE_LENGTH - distance from tee to cup
CourseID
HoleNum
TeeIdentifier - Black, White, Blue, etc
Distance 
```

# oracle - select语句的pl/sql显示结果

> ID：11615574
> 
> 赞同：4
> 
> 时间：2012-07-23T15:24:51.150
> 
> 标签：oracle, plsql

```
Set ServerOutput on size 100000;
declare
countTab number := 0;
countCol number := 0;
currDate varchar2(30);
scale number := 0;

Begin

select count(*) into countCol from USER_TAB_COLUMNS where TABLE_NAME = 'EVAPP_INTERFACE' and COLUMN_NAME = 'TARGET_AMNT_LTV_NUM' and DATA_SCALE is null; 
IF  (countCol <> 0) then   

 DBMS_OUTPUT.put_line('  EVAPP_INTERFACE.TARGET_AMNT_LTV_NUM values begin'); 
 execute immediate 'select APPSEQNO, TARGET_AMNT_LTV_NUM from evapp_interface where TARGET_AMNT_LTV_NUM > 999999999999';

END IF;
END;
\ 
```

我正在尝试显示选择查询的结果。我尝试按原样运行 select 语句，但它给出了一个异常，说它找不到提到的列。因此，我尝试将表名放在列的前面，它抱怨我需要使用`INTO`，我也使用了它，但它仍然不喜欢这种语法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:35:52.467

假设您使用的是 SQL*Plus，最简单的选择可能是执行类似的操作

```
Set ServerOutput on size 100000;
variable rc refcursor;
declare
  countTab number := 0;
  countCol number := 0;
  currDate varchar2(30);
  scale number := 0;
Begin
  select count(*) 
    into countCol 
    from USER_TAB_COLUMNS 
   where TABLE_NAME = 'EVAPP_INTERFACE' 
     and COLUMN_NAME = 'TARGET_AMNT_LTV_NUM' 
     and DATA_SCALE is null; 
  IF  (countCol <> 0) then   
    DBMS_OUTPUT.put_line('  EVAPP_INTERFACE.TARGET_AMNT_LTV_NUM values begin'); 
    open :rc 
     FOR 'select APPSEQNO, TARGET_AMNT_LTV_NUM ' ||
         '  from evapp_interface ' ||
         ' where TARGET_AMNT_LTV_NUM > 999999999999';
  END IF;
END;
/

PRINT rc; 
```

如果要显示 PL/SQL 的结果，则需要打开游标，将结果提取到局部变量中，然后对局部变量执行一些操作，例如将它们写入`DBMS_OUTPUT`.

# events - 带有点击事件的 div 内的寻呼机的 jQuery 循环 - 无法停止传播

> ID：11615578
> 
> 赞同：0
> 
> 时间：2012-07-23T15:24:59.473
> 
> 标签：events, jquery-cycle, event-propagation

我正在使用 jQuery Isotope 插件。在每个可点击（最大化/最小化）同位素元素中，我生成了一个 jQuery Cycle 幻灯片，如

```
$('.slideshow.mainview').each(function () {

    var $pager = $('<div class="pager"></div>').insertAfter(this); // creates a pager for each slideshow

    $(this).cycle({
        speed: 300,
        timeout: 0,
        pager: $pager,
        pagerEvent: 'click',
        allowPagerClickBubble: false
    });

}); 
```

单击寻呼机链接会关闭同位素元素，因此看不到下一张幻灯片:(如何停止寻呼机点击传播到父级（同位素元素）？非常感谢任何建议！

ps：如果我使用'mouseover'作为pagerEvent，它可以工作；但幻灯片闪烁两次。所以这也不是一个简单的出路。并且 - 鼠标悬停不适用于屏幕手机和平板设备...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T17:24:15.490

啊，轻松。必须**不**使用单击事件注册同位素元素 (.item) - 但只需在其中注册任何其他元素**-**按钮、div 等等 - 以便接收关闭单击事件（如果没有添加自动关闭， 如下）。然后，每个同位素 .item 中的所有其他元素 - 幻灯片寻呼机，无论如何 - 都可以注册为被点击，因为它们的事件将不再冒泡到 .item 并过早关闭它:)

```
$(document).ready(function () {

var $container = $('#container');

$container.isotope({
    itemSelector: '.item',
    masonry: {
        columnWidth: 256
    }
});

$items = $('.item'); // to be able to reference methods on every .item

$('.header').click(function () { // do not register the .item as usual, but any other element within it

    var $previousSelected = $('.selected'); // necessary for switching

    if ($(this).parent().hasClass('selected')) { // now, we have to use $(this).parent() because .header is inside .item

    $items.find('.minimised, .header').removeClass('transparent'); // makes all divs .minimised opaque after an .item is closed again

        $(this).parent().removeClass('selected');
        $(this).parent().children('.maximised').hide();
        $(this).parent().children('.minimised').show();

    } else {

    $items.not(this).parent().find('.minimised, .header').addClass('transparent'); // makes all divs .minimised transparent while (this) is opened

        $previousSelected.removeClass('selected');
        $previousSelected.children('.minimised').show();
        $previousSelected.children('.maximised').hide();

        $(this).parent().addClass('selected');
        $(this).parent().children('.minimised').hide();
        $(this).parent().children('.maximised').show();

    }

    $container.isotope('reLayout');
});

}); 
```

# database - “历史”数据的数据设计与实践

> ID：11615579
> 
> 赞同：3
> 
> 时间：2012-07-23T15:25:01.850
> 
> 标签：database, database-design

有人可以谈谈处理短期内高度瞬态的数据的“常见做法”或一般“可接受的做法” - 但必须具有多年的历史存在......

以一家小型旅游公司为例 - 预订旅游。乘客清单将是高度流动的，直到旅行......一旦旅行完成 - 数据在技术上已经过时，但对于报告或趋势很有用......

使用 HIGH 音量 - 巡演的“搜索”或“创建” - 数据库会变得很厚，数据只会很少改变。

具有相似结构的表是否常见 - 将数据从一个状态“移动”到另一个状态（PRE/POST 事件）......就像在将数据仓库存储到半平面结构以进行“纯”报告之前的过渡

这是可取的，常见的还是正确的？有没有更好的方法来做到这一点......或者圆顶 DBA 会进来并去“你在想什么 WTF”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T17:51:22.187

标准将是有某种标志来指示记录过时。有几种方法可以让您很好地处理性能问题，例如修剪和索引技术。这些可能还包括某种归档策略。您可能会将旧数据从表中移出（频率和时间取决于性能要求），或者将某种批量插入到具有相同结构的历史表中（实际实现方式取决于您的 DBMS，但选择最健壮的方法）或更好的排序或分区策略，如果您的 DBMS 具有健壮的分区系统。如果需要历史数据的分析师与运行操作系统的人不同，您还可以考虑某种多数据库归档策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:34:59.183

当然，这样的设计决定取决于其他因素。但是，一般来说，将数据从一个表移动到另一个表并不是一个好主意。

更好的选择是在您的记录中记录生效日期和结束日期。因此，如果有人报名参加巡演，那么他们的记录就会以该日期的有效日期开始。如果他们退出，那么那个人就会得到结束日期。如果他们再次注册，他们将获得新记录，并具有新的生效日期。

这使您可以在过去的任何时候重建历史。

# javascript - Apple 通知中心 - 来自网络

> ID：11615582
> 
> 赞同：2
> 
> 时间：2012-07-23T15:25:09.970
> 
> 标签：javascript, macos, push-notification, notificationcenter

> **可能重复：**
> [来自 Safari 的山狮通知中心](https://stackoverflow.com/questions/11667718/mountain-lion-notification-center-from-safari)

因此，我在查找有关 Apple 推送通知系统如何与 Web 应用程序配合使用的良好信息时遇到了问题。我知道您可以使用他们的服务注册您的应用程序，但是之后它是如何工作的呢？

随着 Mountain Lion 的发布很快，我认为能够直接与来自 web 应用程序的推送通知集成将变得很重要。任何人都可以指出任何概述这一点的文件吗？

# javascript - 使用 jQuery 移动 ajax 导航加载多页模板

> ID：11615583
> 
> 赞同：4
> 
> 时间：2012-07-23T15:25:09.997
> 
> 标签：javascript, jquery, html, css, jquery-mobile

默认情况下，如果您使用 jQuery Mobile 的 ajax 导航来加载多页模板 html 文件，它不起作用，只会加载第一页。

一种方法是使用`rel="external"`，但在手机或平板电脑上看起来不太好......（应该有动画！）

没有更好的办法吗？如何使用 jQuery Mobile ajax 导航完全加载多页模板 html？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:37:33.973

您可以通过使用以编程方式将页面加载到 DOM 中

```
pageContainerElement.page({ domCache: true }); 
```

DOM 缓存的缺点是 DOM 可能会变得非常大，从而导致某些设备上的速度变慢和内存问题。如果启用 DOM 缓存，请注意自己管理 DOM 并在一系列设备上进行彻底测试。

这是链接：http: [//jquerymobile.com/test/docs/pages/page-cache.html](http://jquerymobile.com/test/docs/pages/page-cache.html)

**更新 1**

您可以将该代码放在一个单独的文件中，即`custom-code.js`在加载 jQuery 之后但在加载 jQuery Mobile 之前将其放入标题中。

因此，如果您的页面容器如下所示：

```
<div data-role="page" data-theme="a" data-dom-cache="false" class="page blog-post"> 
```

你可以把`div.page({ domCache: true });`然后放在你拉入 jQuery 和 jQuery mobile 的所有页面的头部，它看起来像这样：

```
// Pull in jQuery
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
// Pull in your custom jQuery Mobile rules/scripts
<script src="../path/to-file/custom-code.js"></script>
// Pull in jQuery Mobile
<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script> 
```

**更新 2**

上面的代码将缓存该特定页面。如果要将所有页面加载到 DOM 中，请在 custom-code.js 文件中放置此代码并单独指定（每个页面一个实例）要加载到 DOM 中的每个页面：

```
$.mobile.loadPage( pageUrl, { showLoadMsg: false } ); 
```

> 预取页面自然会创建额外的 HTTP 请求并使用带宽，因此明智的做法是仅在很可能会访问预取页面的情况下使用此功能。

此外，如果您想预取当前页面上链接到的所有页面，只需添加`data-prefetch`到链接。

例如：

```
<a href="page_2.html" data-prefetch>Link to other page</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:25:09.997

默认情况下，jQuery mobile 不会加载多页模板的所有页面。但是有[一个用于 jQuery Mobile 的插件](https://github.com/ToddThomson/jQuery-Mobile-Subpage-Widget)，它允许您使用 ajax 导航加载多页模板。

[在这里查看 jQuery-Mobile-Subpage-Widget。](https://github.com/ToddThomson/jQuery-Mobile-Subpage-Widget)

# python - Python中可用和使用的系统内存？

> ID：11615591
> 
> 赞同：77
> 
> 时间：2012-07-23T15:25:49.103
> 
> 标签：python, operating-system, cross-platform

> **可能重复：**
> [如何在 Python 中获取当前的 CPU 和 RAM 使用情况？](https://stackoverflow.com/questions/276052/how-to-get-current-cpu-and-ram-usage-in-python)

如何从 Python 获取可用和当前使用的内存？它需要是跨平台的，并且至少可以在 Windows、Mac OS X 和 Linux 上运行。

我想在我的应用程序中报告用户他没有足够的可用内存来继续执行下一个操作。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-07-23T15:30:37.993

你应该看看[psutil](https://github.com/giampaolo/psutil)：

```
>>> import psutil
>>> psutil.virtual_memory()
svmem(total=16717422592, available=5376126976, percent=67.8, used=10359984128, free=1831890944, active=7191916544, inactive=2325667840, buffers=525037568, cached=4000509952, shared=626225152) 
```

# c# - 在表中组织 TreeView 节点

> ID：11615594
> 
> 赞同：2
> 
> 时间：2012-07-23T15:25:56.277
> 
> 标签：c#, wpf, datagrid, treeview

我目前正在寻找一种以更有条理的方式在 TreeView 中呈现数据的方法。我一直在寻找将 TreeView 与网格视图相结合的方法，我知道以前有几个人尝试过这种方法，但我无法根据我的问题调整这些信息，因为我不知道 XAML，而且几乎没有时间学习它。这就是它目前的样子：

[![旧树视图](../Images/9e80a4e0f11fd639f8820b9cd6d2dbdd.png)](https://i.stack.imgur.com/f9Gzn.png)

我想在标题下方直接显示详细信息，但我不知道该怎么做。提前非常感谢。

亲切的问候

拉里莫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:40:25.543

尝试使用 ObjectListView - 我认为这是最简单的方法！

# mysql - MySQL 语句（Group 和 SUM() => 每行获得多个“sum”结果

> ID：11615595
> 
> 赞同：3
> 
> 时间：2012-07-23T15:25:59.283
> 
> 标签：mysql, sum

我有几张桌子：

```
table user:
id  firstname   lastname
1   John      Doe
2   Jane      Skith
3   will      Smith
...

table member:
member_id    member_user_id member_status member_activated_by
10         1              yes           partner 1
11         1              yes           partner 2
12         1              yes           partner 3
13         2              yes           partner 2
14         3              no            ----
...

table points:
points_id    points_user_id points_value points_date
10         1              10           2012-02-15 
11         2              15           2012-02-15 
12         2              20           2012-02-15 
13         1              5            2012-02-15 
14         3              30           2012-02-15 
15         1              12           2012-02-15 
...

So results SHOULD be:
 id1 - John Doe:   27 Points
 id2 - Jane Skith: 35 Points
 id3 - will Smith: nothing (not activated) 
```

问题是，id1 带来了 81 分（因为他已经被激活了 3 次......）

这是我当前的 mysql 字符串（缩短...）

```
SELECT points_user_id, SUM( points_value ) AS points_total, id, firstname, lastname
FROM user
JOIN member ON member.member_user_id = user.id
JOIN points ON points.points_user_id = user.id
WHERE 1
AND member_status = 'yes'
GROUP BY points_user_id
ORDER BY points_total DESC 
LIMIT 0 , 100 
```

..到目前为止，它“几乎”可以按需要工作。

但是：用户可能有几个合作伙伴将他“激活”到“激活”表中。

现在，当调用它时，我得到了 points_total 的重复（它将被计算多次，因为 uesr 已被合作伙伴激活......）这在排名列表中没有多大意义......

我怎样才能为每个 user_id 只获得“一个”points_total

希望你明白，我想要实现什么......非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:47:32.900

我认为这应该可以工作，而不是通过激活加入一个子选择，每个 user_id 你只会得到一行然后加入这个子选择，我不确定这是否是 MySql sintax，但它应该向你展示方式。唯一要注意的是，您在内部查询中选择的字段对于相同的 user_id 可能不会改变

```
SELECT user_id, SUM( point_row ) AS points_total, user_data...,...
    FROM points
    JOIN user_data AS UD
    ON UD.user_id = points.user_id

JOIN ( SELECT field1,field2,field3, MAX(activation.user_id) as user_id 
  FROM activation WHERE activation_info = 'yes'
  GROUP BY field1,field2,field3 AS ACTIV )  AS ACTIV
  ON user_data.user_id = AS ACTIV.user_id

WHERE points.points_status = '1'
AND   ACTIV.activation_info = 'yes'
GROUP BY points.user_id
ORDER BY total DESC 
LIMIT 0 , 100 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:32:38.527

如果不显示完整的 SELECT 语句，很难说。大多数情况下，您可能需要从 select 中删除所有非 user_id 唯一的字段。那里有非唯一的值会给你的结果跨多行。此外，您似乎应该按 points_total 排序，而不是按总数排序。

# java - eclipse：线程“AWT-EventQueue-0”中的异常 java.lang.NullPointerException

> ID：11615598
> 
> 赞同：0
> 
> 时间：2012-07-23T15:26:23.797
> 
> 标签：java, eclipse, nullpointerexception, awt

（我是java新手，所以请不要让你的答案太混乱！！！！：P。）我刚刚使用eclipse创建了一个游戏，我真的很想制作一个有趣的游戏！我查看了一些帮助我创建它的教程。问题是我不能在游戏中移动。我真的很感激帮助！这是我在游戏中尝试使用 wasd 移动时收到的错误：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at StickFireBasic.KeyAdapt.keyReleased(KeyAdapt.java:19)
    at java.awt.Component.processKeyEvent(Unknown Source)
    at javax.swing.JComponent.processKeyEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.KeyboardFocusManager.redispatchEvent(Unknown Source)
    at java.awt.DefaultKeyboardFocusManager.dispatchKeyEvent(Unknown Source)
    at java.awt.DefaultKeyboardFocusManager.preDispatchKeyEvent(Unknown Source)
    at java.awt.DefaultKeyboardFocusManager.typeAheadAssertions(Unknown Source)
    at java.awt.DefaultKeyboardFocusManager.dispatchEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
My class files are: Main, GameFrame, Entity, Player , KeyAdapt. 
```

## 主要的：

```
package StickFireBasic;

import javax.swing.JFrame;

public class Main {
    public static void main(String[] args) {
        JFrame frame = new JFrame("StickFire");
        frame.setSize(800, 600);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
        frame.setResizable(true);
        frame.add(new GameFrame());
        frame.setVisible(true);
    }

} 
```

## 游戏框架：

```
package StickFireBasic;

import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ImageIcon;
import javax.swing.JPanel;
import javax.swing.Timer;

public class GameFrame  extends JPanel implements ActionListener{

    Timer mainTimer;
    Player player;

    public GameFrame() {
        setFocusable(true);

        player = new Player(400, 300);
        addKeyListener(new KeyAdapt(player));
        mainTimer = new Timer(10, this);
        mainTimer.start();
    }

    public void paint(Graphics g) {
        super.paint(g);
        Graphics2D g2d = (Graphics2D) g;
        player.draw(g2d);

    }

    @Override
    public void actionPerformed(ActionEvent arg0) {
        player.update();
        repaint();
    }
} 
```

## 实体：

```
package StickFireBasic;

import java.awt.Graphics2D;

public class Entity {

    int x, y;

    public Entity(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public void update() {

    }

    public void draw(Graphics2D g2d) {

    }
} 
```

## 玩家：

```
package StickFireBasic;

import java.awt.Graphics2D;
import java.awt.Image;
import java.awt.event.KeyEvent;

import javax.swing.ImageIcon;

public class Player extends Entity{

    int velX = 0, velY = 0;

    public Player(int x, int y) {
        super(x, y);

    }

    public void update() {
        y += velY;
        x += velX;
    }

    public void draw(Graphics2D g2d) {
        g2d.drawImage(getPlayerImg(), x, y, null);
    }

    public Image getPlayerImg() {

        ImageIcon ic = new ImageIcon("C:/img/stickguy.png/");
        return ic.getImage();
    }

    public void keyPressed(KeyEvent e) {
        int key = e.getKeyCode();

        if (key == KeyEvent.VK_W) {
            velY = -2;
        } else if (key == KeyEvent.VK_S) {
            velY = 2;
        } else if (key == KeyEvent.VK_A) {
            velX = -2;
        } else if (key == KeyEvent.VK_D) {
            velX = 2;
        }

    }

    public void keyReleased(KeyEvent e) {
        int key = e.getKeyCode();

        if (key == KeyEvent.VK_W) {
            velY = 0;
        } else if (key == KeyEvent.VK_S) {
            velY = 0;
        } else if (key == KeyEvent.VK_A) {
            velX = 0;
        } else if (key == KeyEvent.VK_D) {
            velX = 0;
        }

    }

} 
```

## 键适配：

```
package StickFireBasic;

import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;

public class KeyAdapt  extends KeyAdapter {

    Player p;

    public KeyAdapt(Player player) {

    }

    public void keyPressed(KeyEvent e) {
        p.keyPressed(e);
    }

    public void keyReleased(KeyEvent e) {
        p.keyReleased(e);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:29:06.367

好吧，这对我来说看起来不对：

```
Player p;

public KeyAdapt(Player player) {

} 
```

你不应该给`p`某个地方赋值吗？像构造函数？目前您完全忽略了构造函数参数。

否则，它总是有一个空值——所以当你在你的处理程序中取消引用它时，它会抛出一个`NullPointerException`. 您还应该重命名它以更具描述性，很可能重命名类本身，并将其设为私有和最终：

```
public class PlayerKeyAdapter extends KeyAdapter {
    private final Player player;

    public PlayerKeyAdapter(Player player) {
        this.player = player;
    }

    public void keyPressed(KeyEvent e) {
        player.keyPressed(e);
    }

    public void keyReleased(KeyEvent e) {
        player.keyReleased(e);
    }
} 
```

# xamarin.ios - 来自 Git 的绑定 MonoTouch.Dialog 的工作方式与来自 Xamarin 的 MonoTouch.Dialog 不同

> ID：11615602
> 
> 赞同：1
> 
> 时间：2012-07-23T15:26:42.473
> 
> 标签：xamarin.ios, storyboard, .net-assembly, monotouch.dialog

由于编写了一些特定的对话框元素，我使用 MonoTouch.Dialog 的源代码（当前版本）。顺便提一句。在我的项目中，我在一些故事板视图中使用 DialogViewController。现在我已经认识到一个问题：以下代码与 MonoTouch.Dialog 的绑定程序集完美配合，但如果我使用 MonoTouch.Dialog 的源版本，则 UIAlertView 不会出现在点击 Accessory-Button...

```
var sse = new StyledStringElement ("DetailDisclosureIndicator") { Accessory = UITableViewCellAccessory.DetailDisclosureButton };
                    sse.AccessoryTapped += delegate {
                        var alert = new UIAlertView ("Accessory", "Accessory clicked!", null, "Ok");                alert.Show ();

RootElement root = new RootElement ("test") {
                    new Section (""){
                        sse, 
                        new BooleanImageElement ("test1", false, checkedImage, uncheckedImage),
                    }};

_dvc = new DialogViewController(root);
_navc = new UINavigationController (_dvc);
this.View.AddSubview (_navc.View); 
```

我错了什么？为什么此代码仅适用于 MT.D 的 Xamarin 程序集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:15:27.843

现在我有些惊讶，但还是有些茫然。打包到 MonoTouch.Dialog GIT 版本的示例工作正常。特别是 DemoStyle.cs 中的代码（与 var sse 相同的 DetailDisclosureIndicator 情况）。该示例适用于这两种程序集。我的应用程序的区别是：1）我的应用程序是 ipad-app 2）我的 UINavigationController 是 UIView 的一部分，它是 Storyboard 的一部分。

两分钟后一个测试。AccessorButton 在我的 Storyboard iPad 应用程序中不起作用的主要原因是类 Source（DialogViewController.cs 的一部分）中的方法 AccessoryButtonTapped。如果我调试我的应用程序，如果我点击访问器按钮，则不会调用此 Methode。如果我调试 iphone 示例（添加到 MonoTouch.Dialog 源），将调用类 Source 的 AccessoryButtonTapped 方法，并且将到达 AccessoryButtonTapped 中的断点...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T19:03:31.303

> 我错了什么？

可能没什么...

> 为什么此代码仅适用于 MT.D 的 Xamarin 程序集？

GIT 的 MonoTouch.Dialog 是可用的最新（前沿）版本。MonoTouch.Dialog 没有隐藏版本；-)

MonoTouch 的每个新版本在发布时都会带来一个特定的（几乎是最新/经过良好测试的）版本的 MonoTouch.Dialog。

您将使用 GIT 更快地获得新功能 - 但您也可能是第一个发现新错误或回归的人。

[请向http://bugzilla.xamarin.com](http://bugzilla.xamarin.com)报告任何行为变化，并包括 MonoTouch 的哪个版本（例如 5.2.12）以及您使用的 GIT 修订版（例如，当您阅读您的问题时，*当前版本*之类的内容可能与写的时候）。

# visual-studio-2010 - 每个构建配置包含不同的文件

> ID：11615603
> 
> 赞同：2
> 
> 时间：2012-07-23T15:26:44.760
> 
> 标签：visual-studio-2010, build

我们有两种不同的构建配置：调试和生产。

构建的一部分包括用于访问第三方站点的证书。在调试中，我们使用暂存证书，在生产中，我们使用实时生产证书。

如何确保在调试配置中构建解决方案时包含暂存证书，以及在其内置生产时包含生产证书？

**编辑**

这是我从 Scotty 的建议中得到的解决方案（已放入 Post-Build 事件命令行部分）：

```
IF $(ConfigurationName) == Release copy $(ProjectDir)resources\prod.p12 $(TargetDir)resources

IF $(ConfigurationName) == Debug copy $(ProjectDir)resources\staging.p12 $(TargetDir)resources 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:32:14.883

取决于您的“证书”如何包含在您的项目中。

如果它是 C/C++ 文件，请在解决方案资源管理器中右键单击该文件，打开 Properties > General > **Excluded from Build**。为您的 Debug 构建排除一个文件，为您的 Release 构建排除一个文件。

如果它是外部文件或命令，您可以为每个配置使用**构建事件**。打开您的项目属性 > 配置属性 > 构建事件 > 构建后事件（或其他事件，如果您愿意）。从那里你可以运行你想要的任何命令行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-23T15:32:46.137

我认为您可以使用 DEBUG 指令来加载证书：

```
using System;
using System.Diagnostics;

 public class CertLoader
{
#if DEBUG
 public bool LoadStartingCert()
{
//...load it
}
//in other case load prod cert
} 
```

# c++ - C/C++：矩形的周长和面积。长方体的体积

> ID：11615606
> 
> 赞同：12
> 
> 时间：2012-07-23T15:26:53.500
> 
> 标签：c++, syntax, volume, area

我想使用以下代码计算矩形的面积和周长：

```
 rect a;
    a = ( -----
          !   !
          -----a );
std::cout << a.area() << std::endl;
std::cout << a.perimeter() << std::endl; 
```

为此，我制作了以下课程：

```
class rect
{
public:
    rect():w(0), h(2) {}
    rect& operator - () { w += 0.5f; return *this; }
    rect& operator - (rect&) { w += 0.5f; return *this; }
    rect& operator -- (int a) { w += a; return *this; }
    rect& operator -- () { w += 1; return *this; }
    rect& operator ! () { h += 0.5f; return *this; }
    void clear() { w = 0; h = 2; }
    int area() { return w * h; }
    int perimeter() { return 2 * w + 2 * h; }
    int width() { return w; }
    int height() { return h; }
private:
    float w;
    float h;
}; 
```

以下是一些使用示例：

```
#include <iostream>

int main()
{
    rect a;

    a = ( -----
          !   !
          -----a );

    std::cout << a.area() << std::endl;
    std::cout << a.perimeter() << std::endl;
    std::cout << a.width()  << std::endl;
    std::cout << a.height() << std::endl;

    std::cout << std::endl;

    a.clear();

    a = ( ----------
          !        !
          !        !
          !        !
          !        !
          ---------a );

    std::cout << a.area() << std::endl;
    std::cout << a.perimeter() << std::endl;
    std::cout << a.width()  << std::endl;
    std::cout << a.height() << std::endl;

    return 0;
} 
```

**以下是我的问题：**

1.  **可以在不涉及任何浮点运算的情况下完成吗？** （确实是整数网格）
2.  **可以在 3D 案例上推广吗？**IE：

    ```
    cuboid b;
    b = (  ---------
          /        /!
         ! -------! !
         !        ! !
         !        ! !
         !        !/
         ---------b );

    std::cout << b.volume() << std::endl; 
    ```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T15:30:32.857

我不得不将“/”运算符更改为“+”，因为没有前缀“/”运算符。+ 虽然效果很好。哦，它使用整数。我只用您提供的案例对其进行了一次测试，但据我所知它应该可以工作。

```
class cuboid
{
        int w,h,l;
public:
        cuboid () : w(2), h(3), l(6) {}
        cuboid& operator - () { w += 1; return *this; }
        cuboid& operator - (cuboid&) { w += 1; return *this; }
        cuboid& operator -- (int) { w += 2; return *this; }
        cuboid& operator -- () { w += 2; return *this; }
        cuboid& operator ! () { h += 1; return *this; }
        cuboid& operator + () { l += 1; return *this; }
        cuboid& operator + (cuboid&) { l += 1; return *this; }
        cuboid& operator ++ () { l += 2; return *this; }
        cuboid& operator ++ (int) { l += 2; return *this; }

        void clear () { w = 2; h = 3; l = 6; }
        int width () const { return w / 3; }
        int height () const { return h / 3; }
        int length () const { return l / 3; }
        int volume () const { return width() * height () * length (); }
        int surface_area() const { return width() * height () * 2 +
                                          width() * length () * 2 +
                                          length() * height () * 2; }
}; 
```

在行动中看到它。 [http://ideone.com/vDqEm](http://ideone.com/vDqEm)

编辑：您不需要 ++ 运算符，因为不应该有两个 + 彼此相邻。哎呀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T16:00:42.357

有点。只要您假设任何字符集具有相等的高度和宽度，或者您的单位只是字符而不是像素，就可以轻松地将数组验证为矩形并在没有浮点数学的情况下计算有关它的内容。所以矩形的实际形状会根据字符集而改变，但逻辑上它仍然是 3 个字符乘 2 个字符。

但是，您遇到了 3D 案例的一些问题。首先，您实际上不能使用基于网格的布局使用数组来表示它。再看看你的ASCII艺术。正面的角度是多少？它不为零，因为您可以观察到侧边。如果那是 90 度角，如果你能看到侧面，那么正面也需要倾斜。因此，您的表示方法根本无法胜任表示 3d 长方体的任务。

不过还有一个选择。3D ascii 艺术可以是您正在谈论的 3D 目标的抽象。斜杠/反斜杠字符现在正好是一个单位，与字符“-”和“！”相同 人物。有了这个假设，3D 版本也很简单，尽管当你显示它时它看起来很奇怪。

我的意思是，来吧，看看这些立方体，它们不是欧几里得友好的：

```
 ---
 / /!
--- !
! !/
---

   ----
  /  /|
 /  / |
----  |
|  | /
|  |/
---- 
```

所以无论如何，假设这些东西是代表 2D 或 3D 形状的 ascii-art 字符串，你可以这样：

```
//Skipping the validation step, assuming well formed ascii rectangles.
int height2D(char* rect, int size)
{
    int ret=0;
    int i=0;
    while(i++ < size) 
        if(rect[i] == '\n')
            ret++;
    return ret;
}

int width2D(char* rect, int size)
{
    int ret=0;
    while(rect[ret] == '-' && ret < size)
        ret++;
    return ret;
}

int area2D(char* rect, int size)
{
    //return height2D(rect, size) * width2D(rect, size);
    //ppfffft!
    return size;
}

int perimiter2D(char* rect, int size)
{
    return 2 * height2D(rect, size) + 2 * width2D(rect, size);
}

//Skipping the validation step, assuming well formed ascii cuboids
int height3D(char* rect, int size)
{
    int ret=0;
    int i=0;
    int depth;

    while(i++ < size) 
        if(rect[i] == '\n')
            ret++;
    depth = depth3D(rect, size);
    return ret - depth + 2;
}

int width3D(char* rect, int size)
{
    int ret=0;
    int i=0;
    while(rect[i] != '-' && ret < size)
        i++;
    while(rect[i++] == '-' && ret < size)
        ret++;

    return ret;
}

int depth3D(char* rect, int size)
{
    int ret=0;
    while(rect[ret] == ' ' && ret < size)
        ret++;
    return ret+1;
}

int volume3D(char* rect, int size)
{
    return height3D(rect, size) * width3D(rect, size) * depth3D(rect, size);
}

int area3D(char* rect, int size)
{
    return 2 * heigh3D(rect, size) * width3D(rect, size) + 
           2 * heigh3D(rect, sise) * depth3D(rect, size) + 
           2 * width3D(rect, size) * depth3D(rect, size);
} 
```

未经测试，未经验证，我什至没有编译这个。地狱，让我们称之为伪代码。

# javascript - underscore.js，名为“exports”的全局对象和 livefyre javascript API - 集成冲突

> ID：11615610
> 
> 赞同：2
> 
> 时间：2012-07-23T15:27:14.500
> 
> 标签：javascript, underscore.js

我会尝试总结几个步骤，然后问一个问题

1.  `underscore.js`开发 3rd-party javascript 组件时安装失败（如此处所述：[Underscore.js 和 noconflict](https://stackoverflow.com/questions/11609415/underscore-js-and-noconflict)）。我的代码包含以下行以避免不同版本的*underscore.js*发生冲突：

    window.$MyUS = _.noConflict();

2.  在查看`underscore.js`代码时发现，如果定义了`exports`or ，则变量将成为or的成员。它只是发生了（在浏览器中，当然不是在*Node.js*中）。`module.exports``_``exports``module.exports`

**   我试图将`exports`对象保存在一边，并在加载之前将其删除，`underscore.js`并在调用`noConflict()`. 但是，调用 时`delete exports`，Ive got `false`，表示`exports`无法删除。

    *   我在`exports`object:`compile()`和`compileToString()`. 通过查看他们的实现，我发现`LF`了可能引用`livefyre`Javascript API ( [http://www.livefyre.com/docs/javascript-sdk-reference](http://www.livefyre.com/docs/javascript-sdk-reference) )的参考资料* 

 *解决冲突的更好方法是什么？我看到以下选项：

1.  修改*underscore.js*代码，使其不会尝试将自身安装到`exports`对象中。

2.  让*underscore.js*来修改`exports`对象，希望任何网站都不会出错。在这种情况下，我需要像这样重写该`window.$MyUS = _.noConflict();`行：

    window.$MyUS = *.noConflict || 出口。*.noConflict() || ... ; // 为了清楚起见省略了完整性检查，显然生产代码必须更健壮

如果您需要更多信息 - 请询问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:58:04.623

我认为答案很简单：[在 GitHub 上创建下划线](https://github.com/documentcloud/underscore)`exports`并添加一个简单的补丁，如果存在则拒绝附加到该补丁`window`，然后提交拉取请求。

这样每个人都会受益：每次升级下划线副本时都不必重新应用补丁，其他人也不必处理这个问题。*

# grid - 无流体构建引导 twitter 网格容器全宽（全屏）

> ID：11615611
> 
> 赞同：1
> 
> 时间：2012-07-23T15:27:17.667
> 
> 标签：grid, twitter-bootstrap, responsive-design, css-position

我想用 twitter 引导框架全屏构建一个 web 应用程序。我正在测试引导响应 css，但是当窗口浏览器调整大小、页面内容改变位置时，我不喜欢这样。所以我想要一个完整的顶部，一个左栏，一个中心内容和一个右栏，最后是一个页脚，当浏览器调整大小时，我不希望该元素改变位置（不流畅）。我还想在全屏模式下使用网格（span5、offset4 等）。实际上是一个占据所有屏幕尺寸的 50 像素大的列网格。我能怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T07:48:20.717

很难回答所有问题，但一个好的起点是注释掉引导 CSS 中的条件 CSS。

如果您转到以Comment that`bootstrap-2.1.1.min.css` 开头的最后一行`@media (min-width:768px) and (max-width:979px){` 以及页面的其余部分。

这将阻止元素在调整大小时改变位置。然后你可以做你自己的代码来定位你需要的东西。

希望这可以帮助。

# java - 解析具有未确定数量的子节点的 JSON 对象

> ID：11615616
> 
> 赞同：1
> 
> 时间：2012-07-23T15:27:40.150
> 
> 标签：java, android, json

我使用 Dropbox API，我想从 json 对象中获取文件夹和路径。但是我遇到了问题，因为子节点的数量减少了。我将如何解析这样的东西？

**编辑**

JSONObject 代表一个目录。顶级文件夹由 json 对象表示。该对象内是子文件夹。他们每个人都有JSONobject，在每个jsonobject中都有一个数组，代表子文件夹的子文件夹。所以不知道json的完整结构

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:41:05.223

我刚刚遇到了同样的问题，我编写了一个带有递归算法的类，该算法通过并搜索特定的 id .. 似乎工作正常，请随意尝试！

```
import java.util.ArrayList;
import java.util.List;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class JsonReference {
    Object data;

    public JsonReference(String buildFromString){
        try {
            data = new JSONObject(buildFromString);
        } catch (JSONException e) {
            e.printStackTrace();
        }

        if(data == null){
            try {
                data = new JSONArray(buildFromString);
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    }

    public Object getAbstractJsonObject(){
        return data;
    }

    public List<String> parseForData(String data,boolean removeDuplicates){
        Traverser valFinder = new Traverser(0);
        valFinder.setValues(data, removeDuplicates);
        valFinder.traverseForStringValue(this.data);
        return valFinder.foundInstances;
    }

    class Traverser{
        List<String> foundInstances = new ArrayList<String>();
        String value;
        boolean removeDuplicates;

        public Traverser(int type){

        }

        public void setValues(String value,boolean removeDuplicates){
            this.value = value;
            this.removeDuplicates = removeDuplicates;
        }

        public void traverseForStringValue(Object root){

            if(root == null){
                return;
            }
            else if(root instanceof JSONObject){
                JSONObject self = (JSONObject)root;

                //if the key exists in this object.. save it!
                if(self.has(value)){
                    try {
                        if(!removeDuplicates || notRepeat(self.getString(value)))
                            foundInstances.add(self.getString(value));
                    } catch (JSONException e) {
                        e.printStackTrace();
                    }
                    return;
                }

                //otherwise, see if you can dive deeper..
                JSONArray names = self.names();
                for(int i=0;i<names.length();i++){
                    String temp = null;
                    try{
                        temp = names.getString(i);
                    }
                    catch(JSONException e){
                        e.printStackTrace();
                    }
                    if(temp != null){
                        try {
                            if(self.get(temp) instanceof JSONObject || self.get(temp) instanceof JSONArray)
                                traverseForStringValue(self.get(temp));
                            else if(self.get(temp) instanceof String){
                                if(!removeDuplicates || notRepeat(self.getString(value)))
                                    foundInstances.add(self.getString(value));
                            }
                        } catch (JSONException e) {
                            e.printStackTrace();
                        }
                    }
                }

            }
            else if(root instanceof JSONArray){
                JSONArray self = (JSONArray)root;

                //iterate through the array..
                for(int i=0;i<self.length();i++){
                    Object temp = null;
                    try {
                        temp = self.get(i);
                    } catch (JSONException e) {
                        e.printStackTrace();
                    }

                    if(temp != null && temp != JSONObject.NULL){

                        if(temp instanceof JSONObject || temp instanceof JSONArray)
                            traverseForStringValue(temp);
                        else if(temp instanceof String && ((String)temp).contains(value)){
                            try {
                                if(!removeDuplicates || notRepeat(self.getString(i)))
                                    foundInstances.add(self.getString(i));
                            } catch (JSONException e) {
                                e.printStackTrace();
                            }
                        }

                    }
                }
            }
        }

        private boolean notRepeat(String s){
            for(String item : foundInstances){
                if(item.equals(s))
                    return false;
            }
            return true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:41:08.967

[从https://stackoverflow.com/a/10593838/259889](https://stackoverflow.com/a/10593838/259889)得到这个回复

```
JSONObject jObject = new JSONObject(contents.trim());
   Iterator<?> keys = jObject.keys();

        while( keys.hasNext() ){
            String key = (String)keys.next();
            if( jObject.get(key) instanceof JSONObject ){
                // do your stuff
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:42:09.850

对于`JsonObject`带有节点的您可以这样做：

```
JsonObject jsonO = //get your JsonObject
List<String> keys = jsonO.keys();
List<Object> nodes = new ArrayList<Object>

for(String k: keys){
  nodes.add(jsonO.get(k));
} 
```

如果它是一个`JsonArray`

```
JSONArray jsonA = //get Your JsonArray
List<Object> nodes = new ArrayList<Object>
for (int i = 0; i < jsonA.length(); i++){
  nodes.add(jsonA.get(i));
} 
```

或考虑使用[GSON](http://code.google.com/p/google-gson/)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-23T15:37:55.687

它可能是您想要将其转换为的 JSONArray。如果您不是在 JSONObject 中根据它们的 id 提取值，那么它就是一个 JSONArray。你可以这样做：

```
for (int i = 0; i < jsonArray.length(); i++) {

    whateverTheObjectIs = jsonArray.getObject(i);

} 
```

# java - String.split() 是否可以在结果数组中返回一个空节点？

> ID：11615619
> 
> 赞同：1
> 
> 时间：2012-07-23T15:27:52.347
> 
> 标签：java, string, split

当调用 .split 时，是否有任何字符串可以返回带有空节点的数组？这是我尝试过的：

```
 String string = "test,,test";
    if (string != null && !string.isEmpty()) {
        String[] parsedString = string.split(",");
        for (String stringNode : parsedString) {
            if (stringNode != null) {
                //perform logic here. Omitted for the purpose of this question.
            }
        }
    } 
```

我希望我的方法能够处理空字符串，但是如果 String.split() 不能返回带有空节点的数组，那么删除它可能是安全的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:30:04.577

不， String.split(String regex) 永远不能返回包含`null`元素的数组。

只有三种情况需要说明：

1.  `regex`无效，`PatternSyntaxException`抛出a
2.  `regex`未找到，该数组将仅包含原始字符串。
3.  `regex`找到，字符串被拆分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T15:42:27.187

看看[StringUtils](http://commons.apache.org/lang/api-3.0.1/org/apache/commons/lang3/StringUtils.html)

split() 方法。

```
String str = "1,2,3,,4";
    System.out.println(Arrays.toString(str.split(",")));
    System.out.println(Arrays.toString(StringUtils.split(str,","))); 
```

输出：

```
[1, 2, 3, , 4]
[1, 2, 3, 4] 
```

这是你所期望的吗？

希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:38:51.413

是的，您可以删除`if (stringNode != null)`. 不会返回空值。`String.split()`（我的意思是作为数组元素）可能会返回一个空字符串。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-23T15:37:22.663

根据[Javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)，String.split() 不会返回 null 或空字符串。

# sql-server-2008 - 远程访问sql server的安全风险？

> ID：11615623
> 
> 赞同：4
> 
> 时间：2012-07-23T15:28:07.700
> 
> 标签：sql-server-2008, database-connection, security, remote-access

我希望从外部访问公司的 sql server 数据库。我目前可以通过使用远程桌面连接来访问数据库，但这对于在我的计算机上运行的某些数据库工具来说是不够的。

在我启用对 sql 服务器的外部访问之前...（[http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server -2008.aspx](http://blogs.msdn.com/b/walzenbach/archive/2010/04/14/how-to-enable-remote-connections-in-sql-server-2008.aspx) )

我应该注意哪些安全隐患？服务器有多个用户，我可以仔细检查以确保所有用户都有强大的密码保护。除此之外，还有我不知道的风险吗？是否有任何特殊原因不允许外部访问 sql 服务器？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T17:50:59.630

至于远程访问数据库服务器，您必须考虑几个问题：

*   数据库可能会受到拒绝服务或分布式拒绝服务攻击
*   尽管您的密码策略很强，但密码可能会被破解（暴力破解或使用字典）
*   然而，未知的数据库软件漏洞正向互联网上的每个人敞开大门

因此，如果您必须这样做，请考虑使用 VPN 连接到远程服务器，然后通过本地网络接口访问 db。或者您可能会考虑一些 SSH 隧道，并在防火墙中为您的 ip 戳洞。您可能还需要考虑更强大的身份验证方案，例如证书身份验证，也可以通过 SSL 访问。

恕我直言，最好的选择是 VPN 在远程服务器上终止，并且可以通过本地界面访问数据库。

# ruby-on-rails - Rails.root 来自引擎

> ID：11615635
> 
> 赞同：7
> 
> 时间：2012-07-23T15:28:48.503
> 
> 标签：ruby-on-rails, gem, rails-engines

我在`Rails.root`从我正在创建的 rails 引擎访问时遇到了一些问题。我需要从主应用程序中获取一个 yml 配置文件。

是否有任何“最佳实践”来处理您的引擎配置？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T16:13:26.273

假设您有一个模块属性。

```
# lib/my_engine.rb

module MyEngine

  mattr_accessor :app_root

end 
```

然后你可以像这样从初始化块加载它：

```
# lib/my_engine/engine.rb

module MyEngine

  class Engine < Rails::Engine

    initializer "my_engine.load_app_root" do |app|

       MyEngine.app_root = app.root

    end

  end

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-02T01:03:45.720

改为`Rails.root`使用：`MyEngine::Engine.root`;D

# javascript - 将 Twitter Boostrap 网站从开发转移到生产——将 LESS 编译为 CSS

> ID：11615636
> 
> 赞同：0
> 
> 时间：2012-07-23T15:28:48.597
> 
> 标签：javascript, css, twitter-bootstrap, less

我一直在使用提供的 less.js 文件在本地开发一个 Bootstrap 站点。这一直很好。我现在正在研究如何将编译好的 CSS 文件部署到生产服务器。我在本地使用 Windows 7，并且在这些程序上取得了相当大的成功：

[http://winless.org/](http://winless.org/)

[http://crunchapp.net/](http://crunchapp.net/)

所以我编译了一个 style.css 文件，并在我的 PHP/HTML 文件中链接到这个文件。我注意到的一件奇怪的事情是，当我删除链接到 less.js 的代码行时，样式不起作用

因此，即使我使用的是 CSS 而不是 LESS，我的页面仍然需要链接到 less.js 编译器。有人知道为什么吗？

我一直在寻找关于部署 Twitter Bootstrap 网站的教程（使用 LESS 编译的 CSS），但一直找不到。任何链接将不胜感激。我现在想知道 Bootstrap 网站是否回复启用了 JavaScript 的用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:30:33.533

您可以在某处发布指向您的工作的链接吗？或一些代码？删除 less.js 调用后，css 应该没有理由不工作。

让我看看你的代码，看看我是否能发现任何奇怪的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T17:09:09.697

删除less.js 依赖的最好方法是在发布之前在服务器上编译你的CSS。为此，您需要安装 Node.js，然后[按照这些说明](http://lesscss.org/#-server-side-usage)安装 Less for Node。

然后，如果您进入“命令行使用”部分，您可以看到如何使用该`lessc`命令将您的 Less 文件编译为 CSS 文件。

# c# - 在两个表单之间使用类/对象

> ID：11615637
> 
> 赞同：2
> 
> 时间：2012-07-23T15:28:49.993
> 
> 标签：c#

我在 Form1 中定义了一个类

```
 public class Conditions
    {
        public string name { get; set; }
        public int probability { get; set; }
        public DateTime start_time { get; set; }
        public DateTime end_time { get; set; }
        public int age_min { get; set; }
        public int age_max { get; set; }
        public bool meldpeld { get; set; }
        public bool onea { get; set; }
        public bool oneb { get; set; }
        public int gender { get; set; }  // 0 - both, 1 - male, 2 - female
        public int meld_min { get; set; }
        public int meld_max { get; set; }

    } 
```

我正在制作一个新列表，例如

```
 List<Conditions> newconditions = new List<Conditions>(); 
```

然后，我打电话给 Form2

```
 Conditions newconds = new Conditions();
        Form2 form2 = new Form2(newconds);
        form2.Show();
        form2.TopMost = true; 
```

在 Form2 中，我有

```
 public Form2(Form1.Conditions newcond)
    {
        InitializeComponent();
        comboBox1.SelectedIndex = 2;
    } 
```

我可以在那里为 newcond 使用设置的东西

然而，我想做的是在 Form2 的另一个函数中设置东西，称为

```
 private void button2_Click(object sender, EventArgs e) 
```

而且我不知道如何在该函数中使用 newcond 。我一定遗漏了一些明显的东西，对吧？

另外，这是一个好方法吗？基本上我想做的是让用户定义任意数量的条件（他们可以添加、编辑、删除），然后在他们运行程序时使用这些条件。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:32:12.037

你在正确的轨道上。

基本上，我会将您的条件类移动到它自己的名为Conditions.cs 的文件中——这是最佳实践。

然后在你的类文件中为 Form2 定义一个成员变量。然后在 Form2 的构造函数中设置该成员变量。

```
private Conditions _conditions;
public Form2(Conditions cond)
{
    _conditions = cond;
    InitializeComponent();
    comboBox1.SelectedIndex = 2;
} 
```

然后你可以在你的点击方法中使用它：

```
protected void button2_click(object sender, EventArgs args)
{
    //Do things with _conditions
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:30:36.777

你大部分都在那儿。您只需要创建一个可以存储`Conditions`对象的实例字段（或可能是一个属性）。在构造函数中根据参数设置该字段，然后在事件处理程序中使用它。

# php - 带有命名空间的 XPATH 和 XML

> ID：11615638
> 
> 赞同：2
> 
> 时间：2012-07-23T15:28:50.703
> 
> 标签：php, xml, xpath

考虑以下 XML：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
   <s:Body>
      <myResponse xmlns="https://example.com/foo">
         <myResult xmlns:a="https://example.com/bar" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
            <a:accountNumber>AAA</a:accountNumber>
            <a:accountName>BBB</a:accountName>
            <a:accountType>CCC</a:accountType>
         </myResult>
      </myResponse>
   </s:Body>
</s:Envelope> 
```

我正在尝试选择 myResult 及其下方的所有元素。

我得到的最接近的是：

```
//*[local-name()='myResult']//a:* 
```

这让我得到了元素的值，但我不知道哪个值属于哪个元素。

我在 PHP 中执行此操作，这是（大致）我正在使用的代码：

```
<?php
$xmlObject = new SimpleXMLElement($result);
$namespaces = $xmlObject->getNamespaces(true);
foreach($namespaces as $key => $value) {
   if($key == '') {
      $key = 'ns';
   }
   $xmlObject->registerXPathNamespace($key, $value);
}
$element = $xmlObject->xpath("//myResult");
?> 
```

我知道有很多关于 XPath 和 XML 名称空间的问题（哦，我是如何搜索的），但我还没有找到与我的特定情况相匹配的问题。我想做的甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:53:17.657

你的`//*[local-name()='myResult']//a:*`作品很好。您只需要遍历并使用`getName`来获取标签的名称。

```
$element = $xmlObject->xpath("//*[local-name()='myResult']//a:*");
foreach($element as $e){
    echo $e->getName() . ': '. (string)$e;
} 
```

演示：[http ://codepad.org/BAefIKZ4](http://codepad.org/BAefIKZ4)

**编辑**：既然您正在注册名称空间，为什么不使用它们呢？

```
$element = $xmlObject->xpath("//ns:myResult//a:*"); 
```

演示：[http ://codepad.org/9MKq5oDt](http://codepad.org/9MKq5oDt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T16:06:53.893

当您将默认命名空间定义为“ns”时，请使用：

```
$element = $xmlObject->xpath("//ns:myResult"); 
```

# mysql - 使用 MySql 在 Google Maps api v3 上加载标记

> ID：11615639
> 
> 赞同：0
> 
> 时间：2012-07-23T15:28:51.707
> 
> 标签：mysql, google-maps-api-3

我按照谷歌的[这个例子](https://developers.google.com/maps/articles/phpsqlinfo_v3)将标记保存在数据库中。所以，本教程教我如何保存数据库，它工作得很好，等等。

但我想在地图上加载这些值，因为它只将标记的值保存在数据库中，而不是将它们加载到地图上。

如果有人想制作加载标记（），这是我的 HTML；对我来说，或者给我看一个加载标记示例的链接会很有帮助，因为我不懂 SQL 和 PHP，也不懂 HTML。我正在学习谢谢=）

> ```
> <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
> <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
> <title>Google Maps JavaScript API v3 Example: Map Simple</title>
> <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
> <script type="text/javascript">
> var marker;
> var infowindow;
> 
> function initialize() {
>   var latlng = new google.maps.LatLng(37.4419, -122.1419);
>   var options = {
>     zoom: 13,
>     center: latlng,
>     mapTypeId: google.maps.MapTypeId.ROADMAP
>   }
>   var map = new google.maps.Map(document.getElementById("map_canvas"), options);
>   var html = "<table>" +
>              "<tr><td>Name:</td> <td><input type='text' id='name'/> </td> </tr>" +
>              "<tr><td>Address:</td> <td><input type='text' id='address'/></td> </tr>" +
>              "<tr><td>Type:</td> <td><select id='type'>" +
>              "<option value='bar' SELECTED>bar</option>" +
>              "<option value='restaurant'>restaurant</option>" +
>              "</select> </td></tr>" +
>              "<tr><td></td><td><input type='button' value='Save & Close'   onclick='saveData()'/></td></tr>";
> infowindow = new google.maps.InfoWindow({
>  content: html
> });
> 
> google.maps.event.addListener(map, "click", function(event) {
>     marker = new google.maps.Marker({
>       position: event.latLng,
>       map: map
>     });
>     google.maps.event.addListener(marker, "click", function() {
>       infowindow.open(map, marker);
>     });
> });
> }
> 
> function saveData() {
>   var name = escape(document.getElementById("name").value);
>   var address = escape(document.getElementById("address").value);
>   var type = document.getElementById("type").value;
>   var latlng = marker.getPosition();
> 
>   var url = "phpsqlinfo_addrow.php?name=" + name + "&address=" + address +
>             "&type=" + type + "&lat=" + latlng.lat() + "&lng=" + latlng.lng();
>   downloadUrl(url, function(data, responseCode) {
>     if (responseCode == 200 && data.length <= 1) {
>       infowindow.close();
>       document.getElementById("message").innerHTML = "Location added.";
>     }
>   });
> }
> 
> function downloadUrl(url, callback) {
>   var request = window.ActiveXObject ?
>       new ActiveXObject('Microsoft.XMLHTTP') :
>       new XMLHttpRequest;
> 
>   request.onreadystatechange = function() {
>     if (request.readyState == 4) {
>       request.onreadystatechange = doNothing;
>       callback(request.responseText, request.status);
>     }
>   };
> 
>   request.open('GET', url, true);
>   request.send(null);
> }
> 
> function doNothing() {}
> </script>   </head> 
> ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T15:18:59.590

developers.google.com/maps/articles/phpsqlajax_v3 是配套文章，展示了如何从数据库中获取数据并显示在地图上。

# vb.net - 搜索特殊字符的变体时比较字符串（精确等...）

> ID：11615642
> 
> 赞同：3
> 
> 时间：2012-07-23T15:29:03.563
> 
> 标签：vb.net, string, comparison

我想知道.net中是否有一种方法可以在字符串包含诸如é之类的字母时进行比较。

示例：我正在搜索一个显示 José 的字符串。当我检查字符串 José 是否包含“e”（没有精确值）时，我想返回 true

有没有办法在不手动比较不同字符的所有变体的情况下做到这一点？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T21:15:36.897

您首先必须以某种方式定义变音符号。不要列出所有字符；相反，使用 Unicode 类别。只需考虑两种或三种组合标记。

例如，您可能只想检测不影响基本字符宽度的组合标记（“非间距标记”）。或者你可能会更加自由，甚至包括不能独立存在的标记，但在出现时仍会占用一些空间；像印度文字中的元音标记。所有三种组合标记将被检测如下：

```
Private Shared Function HasDiacritics(input As String) As Boolean
    Dim uncombined As String = input.Normalize(NormalizationForm.FormD)

    For i As Integer = 0 To uncombined.Length - 1
        Dim uc As UnicodeCategory = 
                CharUnicodeInfo.GetUnicodeCategory(uncombined(i))

        If uc = UnicodeCategory.NonSpacingMark
                Or uc = UnicodeCategory.SpacingCombiningMark
                Or uc = UnicodeCategory.EnclosingMark
                    Then
                        Return True
        End If
    Next

    Return False
End Function 
```

请注意转换为标准形式 D。这会强制分解所有组合字符，例如在逐个字符查看字符串之前`é`和`e`之前。`'`

现在等等，你问的是相反的问题，你想检测字符串是否包含特定的基本字符。那更简单。

```
Private Shared Function HasChar(input As String, c as Char) As Boolean
    Dim uncombined As String = input.Normalize(NormalizationForm.FormD)

    For i As Integer = 0 To uncombined.Length - 1
        If uncombined(i) = c Then Return True End If
    Next

    Return False
End Function 
```

类似地，您可以分别从每个字符串中去除特定类别的字符，只比较剩余的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:52:28.787

此函数应该用普通的旧“e”替换所有 unicode E 重音。您需要为每个要“取消重音”的字母使用正则表达式。要比较没有口音，您需要说...

```
If NormaliseAccents( string1 ) = NormaliseAccents( string2 ) Then... 
```

我还输入了一个`.ToLower()`，所以比较也不区分大小写。

```
Imports System.Text.RegularExpressions

Function NormaliseAccents(sIn as String) as String
    Dim rex as Regex = New Regex("[\u00c8-\u00cb\u00e8-\u00eb]" , _
                                   RegexOptions.IgnoreCase)

    sIn = rex.Replace( sIn , "e" )

    Return sIn.ToLower()
End Function 
```

[这个链接可能有用..](http://tlt.its.psu.edu/suggestions/international/bylanguage/french.html)

请注意，正则表达式需要以十六进制而不是十进制指定的 unicode 代码。此外，此代码完全未经测试:)

# java - 重复注释 - 休眠验证器

> ID：11615646
> 
> 赞同：0
> 
> 时间：2012-07-23T15:29:13.457
> 
> 标签：java, hibernate, validation, annotations, hibernate-validator

我想在一个属性上多次使用一个 hiberante 验证器注释。

例如：

```
@Length(min = 10, max = 10, groups = {Lenght10Group.class})
@Length(min = 5, max = 5, groups = {Lenght5Group.class})
private String productCode; 
```

我[在一个元素上找到了以下线程多个相同类型的注释？](https://stackoverflow.com/questions/1554112/multiple-annotations-of-the-same-type-on-one-element)并尝试将其应用于我的应用程序。

我创建了 Lengths.java 文件：

```
public @interface Lenghts {
   Lenght[] value();
} 
```

并以下列方式应用它：

```
@Lenghts( {@Length(min = 10, max = 10, groups = {Lenght10Group.class}), 
           @Length(min = 5, max = 5, groups = {Lenght5Group.class}) })
private String productCode; 
```

但它似乎不起作用。

我错过了什么？是否需要自定义验证器，自定义处理程序？谁能帮我解决这个问题？我会很感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T18:28:03.353

您应该使用Hibernate Validator 提供的开箱即用的[@Length.List 。](http://docs.jboss.org/hibernate/stable/validator/api/index.html?org/hibernate/validator/constraints/Length.List.html)所有内置约束（由 BV 规范定义和由 Hibernate Validator 定义的附加自定义约束）都定义了这样的 @List 注释。

# powershell - 将参数传递给 Powershell

> ID：11615649
> 
> 赞同：2
> 
> 时间：2012-07-23T15:29:37.957
> 
> 标签：powershell, biztalk, biztalk-deployment, btdf

我有以下 PS 脚本：

```
function Install-BizTalkApplication
{
 param(
  [Parameter(Position=0,Mandatory=$true,HelpMessage="Msi file should be existing")]
  [ValidateScript({Test-Path $_})]
  [Alias("msi")]
  [string]$MsiFile,

  [Parameter(Position=1,HelpMessage="Path wherein the resource file will be installed")]
  [Alias("path")]
  [string]$ApplicationInstallPath,

  [Parameter(Position=2,Mandatory=$true,HelpMessage="Only valid parameters are Local,Dev,Test and Prod")]
  [Alias("env")]
  [ValidateSet("Local","Dev","Prod","Test")]
  [string]$Environment,

[bool]$BTDeployMgmtDB=$true,
  [bool]$SkipUndeploy=$true
  ) 
```

使用 Powershell ISE 我尝试运行脚本，传递 3 个参数，如下所示：

```
BTDF\Sources\Deployment\BuildAndDeploy.ps1 -msi "C:\Builds\1\CIDemo2\CIDemo2 BTDF\Sources\Deployment\bin\Debug\CIDemo-1.0.0.msi" -ApplicationInstallPath "c:\program files (x86)\CIDemo" -Environment "Dev" 
```

但我收到以下错误：

```
The string starting:
At line:1 char:1
+  <<<< 'C:\Builds\1\CIDemo2\CIDemo2 BTDF\Sources\Deployment\BuildAndDeploy.ps1 -msi "C:\Builds\1\CIDemo2\CIDemo2 BTDF\Sources\Deployment\bin\Debug\CIDemo-1.0.0.msi" -ApplicationInstallPath "c:\program files
 (x86)\CIDemo" -Environment "Dev"
is missing the terminator: '.
At line:1 char:233 
```

谁能解释一下我应该如何传递包含空格的参数。我尝试过使用单引号，但没有任何乐趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T16:16:20.543

你的路径中有一个空间 -`C:\Builds\1\CIDemo2\CIDemo2 BTDF\Sources\Deployment\BuildAndDeploy.ps1`

你必须引用它。

像这样运行它：

```
& 'C:\Builds\1\CIDemo2\CIDemo2 BTDF\Sources\Deployment\BuildAndDeploy.ps1' -msi "C:\Builds\1\CIDemo2\CIDemo2 BTDF\Sources\Deployment\bin\Debug\CIDemo-1.0.0.msi" -ApplicationInstallPath "c:\program files (x86)\CIDemo" -Environment "Dev" 
```

# java - 子类的 ClassLoader

> ID：11615652
> 
> 赞同：0
> 
> 时间：2012-07-23T15:29:48.293
> 
> 标签：java, android, service, rpc

这是我的场景：

*   我有一个“远程”服务（Android 设备本地但在另一个单独的进程上运行）。
*   我构建了一个 API 来与该服务进行交互。它基于`Message`.
*   在此 API 中，需要传递 API 定义的一些对象，例如自定义`Entity`类的实例。

我在这里遇到的问题是，对于`Entity`子类，服务无法解组它们，因为显然他不知道这样的类（ throws `ClassNotFoundException`）。但我想要的只是`Entity`通过这些子类访问类功能。

有没有办法实现这一点？先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T12:08:53.813

如果您将序列化的 java 对象发送到远程 API，API 必须知道要反序列化的对象（因此它必须知道 Entity 的每个子类型）。

也许您可以尝试将您的对象作为 JSON 发送并将 JSON 数据解析为实体对象。我不确定 JSON 是否可以帮助您，但您可以尝试一下。(en.wikipedia.org/wiki/JSON)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-09T10:18:00.327

我理解得很好，首先你需要将对象映射到接收器中尝试使用[这个](http://seesharpgears.blogspot.gr/2010/10/ksoap-android-web-service-tutorial-with.html)

# c# - VBA 到 C#：暗淡 x

> ID：11615655
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:29:57.427
> 
> 标签：c#, vba

我正在将一些 VBA 代码移植到 C# 中，并且在要移植的函数之一的开头是以下行：

```
 Dim sCA; 
```

有什么方法可以找出我应该在 C# 中存储什么？我需要从中提取一个字符串，但是我正在使用的库中的方法返回一个数字，当我尝试使用 IndexOf() 时，它会混淆编译器。当我检查用于设置它的函数的参数列表时，我看到：

```
ReadValue([DataPoint As String], [intErrorMode As Integer = 0]) 
```

看到 C# 中没有`ReadValue()`，我现在有点卡住了，你可以扔给我的任何东西都会非常感激。

编辑：为那里发生的混乱道歉，这是完整的功能：

```
Sub CheckForPin(sSTB As String, sPIN As String, iSetTopBoxID As Integer)
Dim sCA_PopUp

sCA_PopUp = ReadValue("Fix32." & SCADA_NAME & "." & sSTB & CStr(iSetTopBoxID) & "_POPUP_CA" & ".F_CV", 1)
If InStr(1, UCase(sCA_PopUp), "PIN PROTECTED") <> 0 Then
    WriteValue sPIN, "Fix32." & SCADA_NAME & "." & sSTB & CStr(iSetTopBoxID) & "_MULTIPLE_CMD" & ".A_CV", 1
End If

Exit Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:44:23.070

似乎 ReadValue 正在返回一个字符串；所以 C# 是

```
void CheckForPin(...)
{
   string sCA_PopUp = ReadValue(...)
   if (sCA_PopUp.ToUpper().Contains("PIN PROTECTED"))
   {
      WriteValue(...)
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T16:56:41.993

鉴于最初的程序员为所有变量添加了类型指示符（在本例中为“s”），因此可以安全地推断它确实是一个字符串。此外，我不确定 Dim sCA_PopUp 和 Dim sCA 是否指的是同一个变量，而您只是没有注意到这一点，但如果是这样，从正在进行的大量连接中，有进一步的证据表明它应该被解释为细绳。将其转换为 C# 时，请改用 StringBuilder。

# scala - 分解函数参数中的元组

> ID：11615656
> 
> 赞同：67
> 
> 时间：2012-07-23T15:29:57.940
> 
> 标签：scala, function, tuples

在python中我可以这样做：

```
def f((a, b)):
    return a + b

d = (1, 2)
f(d) 
```

在这里，传入的元组在被传递给时被分解`f`。

现在在 scala 我正在这样做：

```
def f(ab: (Int, Int)): Int = {
    val (a, b) = ab
    a + b
}

val d = (1, 2)
f(d) 
```

我可以在这里做些什么，以便在传入参数时进行分解？只是好奇。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-07-23T15:34:48.403

您可以创建一个函数并将其输入与模式匹配匹配：

```
scala> val f: ((Int, Int)) => Int = { case (a,b) => a+b }
f: ((Int, Int)) => Int

scala> f(1, 2)
res0: Int = 3 
```

或者将方法的输入与`match`关键字匹配：

```
scala> def f(ab: (Int, Int)): Int = ab match { case (a,b) => a+b }
f: (ab: (Int, Int))Int

scala> f(1, 2)
res1: Int = 3 
```

另一种方法是使用带有两个参数的函数并将其“元组”：

```
scala> val f: (Int, Int) => Int = _+_
f: (Int, Int) => Int = <function2>

scala> val g = f.tupled // or Function.tupled(f)
g: ((Int, Int)) => Int = <function1>

scala> g(1, 2)
res10: Int = 3

// or with a method
scala> def f(a: Int, b: Int): Int = a+b
f: (a: Int, b: Int)Int

scala> val g = (f _).tupled // or Function.tupled(f _)
g: ((Int, Int)) => Int = <function1>

scala> g(1, 2)
res11: Int = 3

// or inlined
scala> val f: ((Int,Int)) => Int = Function.tupled(_+_)
f: ((Int, Int)) => Int = <function1>

scala> f(1, 2)
res12: Int = 3 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-06-01T13:04:05.050

从 开始`Scala 3`，具有改进的`tupled function`功能：

```
// val tuple = (1, 2)
// def f(a: Int, b: Int): Int = a + b
f.tupled(tuple)
// 3 
```

[在Scastie](https://scastie.scala-lang.org/jw4sPSBvTbChazTDP1uqjw)中玩它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-01T16:22:35.940

```
object RandomExperiments extends App{
  def takeTuple(t:(Int,Int))=print (s"$t ${t._1}\n")
  takeTuple(1,3)
  takeTuple((1,3))
  takeTuple(((1,3)))

} 
```

印刷：

```
(1,3) 1
(1,3) 1
(1,3) 1 
```

# java - 删除方法不起作用（使用 Hashmap）

> ID：11615658
> 
> 赞同：0
> 
> 时间：2012-07-23T15:30:00.810
> 
> 标签：java, hashmap

我正在做一个员工商店。employeeStore 中的删除功能不起作用。它没有删除员工，而是什么都不做，任何人都看不到任何错误。

这是我的代码：主要

```
case 3:
                System.out.println("Delete by Name.");
                Employee employeeDelete = MenuMethods.userInputByName();
                Store.searchByName(employeeDelete.getEmployeeName());
                System.out.println("Your choice is: "+ employeeDelete);
                Store.remove(employeeDelete);
                break; 
```

删除方法

```
// ---------------------------------------------------------------------------------------
// Name: Remove.
// ---------------------------------------------------------------------------------------
public Employee remove(Employee key) {
    // Remove the Employee by name.
    if (map.containsKey(key))
        return map.remove(key); // if its there remove and return
    else
        return null; // if its not there return 0x00000000 address
} 
```

菜单方法

```
//---------------------------------------------------------------------------------------
//  Name:           Imports.
//  Description:    To allow the use of different Java classes.
//---------------------------------------------------------------------------------------
import java.util.Scanner;
//---------------------------------------------------------------------------------------
public class MenuMethods 
{
    private static Scanner keyboard = new Scanner(System.in);
//---------------------------------------------------------------------------------------
//  Methods for the Company Application menu.
//---------------------------------------------------------------------------------------

//---------------------------------------------------------------------------------------
//  Name:           getMenuChoice.
//  Description:    Method for validating the choice.
//---------------------------------------------------------------------------------------
    public static int getMenuChoice(String menuString, int limit,String prompt, String errorMessage) 
    {
        System.out.println(menuString);
        int choice = inputAndValidateInt(1, limit, prompt, errorMessage);
        return choice;
    }

//---------------------------------------------------------------------------------------
//  Name:        inputAndValidateInt.
//  Description: This method is used in the getMenuChoice method.
//---------------------------------------------------------------------------------------
    public static int inputAndValidateInt(int min, int max, String prompt,String errorMessage) 
    {
        int number;
        boolean valid;
        do 
        {
            System.out.print(prompt);
            number = keyboard.nextInt();
            valid = number <= max && number >= min;
            if (!valid) 
            {
                System.out.println(errorMessage);
            }
        } while (!valid);
        return number;
    }

//---------------------------------------------------------------------------------------
//  Name:        userInput
//  Description: This method is used in the MainApp to give the user capability to enter
//               the details when adding details of an employee into the store.
//---------------------------------------------------------------------------------------
    public static Employee userInput() 
    {
        String temp = keyboard.nextLine();
        Employee e = null;
        System.out.println("Please enter the Employee Name:");
        String employeeName = keyboard.nextLine();
        System.out.println("Please enter the Employee ID:");
        int employeeId = keyboard.nextInt();
        temp = keyboard.nextLine();
        System.out.println("Please enter the Employee E-mail address:");
        String employeeEmail = keyboard.nextLine();
        return e = new Employee(employeeName, employeeId, employeeEmail);

    }

//---------------------------------------------------------------------------------------
//  Name:        userInputByName.
//  Description: This method is used in the MainApp to give the user capability to search by name.
//---------------------------------------------------------------------------------------
    public static Employee userInputByName() 
    {
        // String temp is for some reason needed. If it is not included
        // The code will not execute properly.
        String temp = keyboard.nextLine();
        Employee e = null;
        System.out.println("Please enter the Employee Name:");
        String employeeName = keyboard.nextLine();

        return e = new Employee(employeeName);

    }

//---------------------------------------------------------------------------------------
//  Name:        userInputByEmail
//  Description: This method is used in the MainApp to give the user capability to search by email.
//---------------------------------------------------------------------------------------
    public static String userInputByEmail() 
    {
        // String temp is for some reason needed. If it is not included
        // The code will not execute properly.
        String temp = keyboard.nextLine();
        Employee e = null;
        System.out.println("Please enter the Employee Email:");
        String employeeEmail = keyboard.nextLine();
        // This can use the employeeName's constructor because java accepts the
        // parameters instead
        // of the name's.
        return employeeEmail;

    }
//---------------------------------------------------------------------------------------

} 
```

员工

```
//---------------------------------------------------------------------------------------
//  Employee class.
//---------------------------------------------------------------------------------------
public class Employee
{
//---------------------------------------------------------------------------------------
//  Variables to be used in the employee store.
//---------------------------------------------------------------------------------------
    private String employeeName;
    private int employeeId;
    private String employeeEmail;
//---------------------------------------------------------------------------------------
//  Name:        Constructors.
//  Description:
//---------------------------------------------------------------------------------------
    public Employee(String employeeName, int employeeId, String employeeEmail) 
    {
        this.employeeName = employeeName;
        this.employeeId = employeeId;
        this.employeeEmail = employeeEmail;
    }
//---------------------------------------------------------------------------------------
//  Overloading the constructor for the use with userInputByName method.
//---------------------------------------------------------------------------------------
    public Employee(String employeeName) 
    {
        this.employeeName = employeeName;
    }
//---------------------------------------------------------------------------------------
//  Name:   Getters.
//---------------------------------------------------------------------------------------
    public String getEmployeeEmail() 
    {
        return employeeEmail;
    }

    public String getEmployeeName() 
    {
        return employeeName;
    }
    public int getEmployeeId() 
    {
        return employeeId;
    }
//---------------------------------------------------------------------------------------
//  Name:   Setters.
//---------------------------------------------------------------------------------------
    public void setEmployeeEmail(String employeeEmail) 
    {
        this.employeeEmail = employeeEmail;
    }
    public void setEmployeeName(String employeeName) 
    {
        this.employeeName = employeeName;
    }
    public void setEmployeeId(int employeeId)
    {
        this.employeeId = employeeId;
    }

//---------------------------------------------------------------------------------------
//  Name:   toString.
//---------------------------------------------------------------------------------------
    public String toString() 
    {
        return "\t\t\tEmployee\n" +
                "********************************************************************\n"+
                "Employee Name: "+ employeeName +"\n"+ 
                "Employee Id: " + employeeId +"\n"+  
                "Employee Email: " + employeeEmail;
    }
//---------------------------------------------------------------------------------------
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:33:38.670

这种方法

```
public static Employee userInputByName 
```

正在创建一个*新* `Employee`的. （它也毫无意义地将它分配给一个局部变量......这里的代码风格真的很奇怪 - 对 . 的无关调用也是如此`nextLine()`。）

除非您已覆盖`equals`and `hashCode`in `Employee`，否则它不会认为该*新* `Employee`对象等于`HashMap`. 不幸的是，您没有向我们展示该`Employee`课程，但大概是为了比较员工是否具有相同的名称（并给出相同的哈希码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:44:53.490

经典：您可能在`Employee`对象上缺少 equals() 和 hashcode() 。您还应该考虑为您的地图使用一个简单的键，例如employee.id：就像现在一样，您的EmployeeMap 可以更好地建模为EmployeeSet。

进一步查看您的代码，您可能希望创建几个 Maps 作为员工对象的索引：

```
Map<Integer, Employee> employeeById
Map<String, Employee> employeeByEmail;
MultiMap<String, Employee> employeeByName; 
```

请注意最后一行建议的 com.google.common.collect.Multimap，以可能包含共享相同 John Doe 名称的多个员工参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-23T15:33:54.420

你需要做的就是

```
public Employee remove(Employee key) {
    // Remove the Employee by name.
    return map.remove(key); // if its there remove and return
} 
```

此问题的最常见原因是 hashCode 和 equals 不正确、不匹配或依赖于可变字段。

# c# - 将字符串以外的对象添加到 ToolStripDropDownButton DropDownItem

> ID：11615661
> 
> 赞同：2
> 
> 时间：2012-07-23T15:30:05.577
> 
> 标签：c#, winforms, toolstrip, toolstripdropdown

将字符串作为新的 DropDownItem 添加到 ToolStripDropDownButton 很容易。我需要向 DropDownItems 添加一个自定义对象，以便我可以为 DropDownItem 分配一个类似对象的键/值。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:53:26.457

ToolStripItems 只能显示文本和图像，不能带对象。您可以尝试在按钮的 Tag 属性中偷偷添加一个对象：

```
 ToolStripDropDownButton b = new ToolStripDropDownButton();
  b.DropDownItems.Add(new ToolStripButton("Hello") { Tag = new Something() }); 
```

然后当您处理单击事件时，检查对象的 Tag 属性。

# python - Python中的多元正态密度？

> ID：11615664
> 
> 赞同：68
> 
> 时间：2012-07-23T15:30:20.083
> 
> 标签：python, numpy, scipy, probability

是否有任何 python 包可以有效计算[多元正态分布](https://en.wikipedia.org/wiki/Multivariate_normal_distribution)的 PDF（概率密度函数） ？

它似乎没有包含在 Numpy/Scipy 中，令人惊讶的是，谷歌搜索并没有找到任何有用的东西。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2014-01-03T10:43:07.230

多元法线现在可用于`SciPy 0.14.0.dev-16fc0af`：

```
from scipy.stats import multivariate_normal
var = multivariate_normal(mean=[0,0], cov=[[1,0],[0,1]])
var.pdf([1,0]) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-02-12T11:37:14.890

我只是为了我的目的做了一个，所以我想分享一下。它是使用 numpy 的“力量”构建的，基于[http://en.wikipedia.org/wiki/Multivariate_normal_distribution](http://en.wikipedia.org/wiki/Multivariate_normal_distribution)的非退化案例的公式，它也验证了输入。

这是代码以及示例运行

```
from numpy import *
import math
# covariance matrix
sigma = matrix([[2.3, 0, 0, 0],
           [0, 1.5, 0, 0],
           [0, 0, 1.7, 0],
           [0, 0,   0, 2]
          ])
# mean vector
mu = array([2,3,8,10])

# input
x = array([2.1,3.5,8, 9.5])

def norm_pdf_multivariate(x, mu, sigma):
    size = len(x)
    if size == len(mu) and (size, size) == sigma.shape:
        det = linalg.det(sigma)
        if det == 0:
            raise NameError("The covariance matrix can't be singular")

        norm_const = 1.0/ ( math.pow((2*pi),float(size)/2) * math.pow(det,1.0/2) )
        x_mu = matrix(x - mu)
        inv = sigma.I        
        result = math.pow(math.e, -0.5 * (x_mu * inv * x_mu.T))
        return norm_const * result
    else:
        raise NameError("The dimensions of the input don't match")

print norm_pdf_multivariate(x, mu, sigma) 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-04-16T05:59:27.117

如果仍然需要，我的实现将是

```
import numpy as np

def pdf_multivariate_gauss(x, mu, cov):
    '''
    Caculate the multivariate normal density (pdf)

    Keyword arguments:
        x = numpy array of a "d x 1" sample vector
        mu = numpy array of a "d x 1" mean vector
        cov = "numpy array of a d x d" covariance matrix
    '''
    assert(mu.shape[0] > mu.shape[1]), 'mu must be a row vector'
    assert(x.shape[0] > x.shape[1]), 'x must be a row vector'
    assert(cov.shape[0] == cov.shape[1]), 'covariance matrix must be square'
    assert(mu.shape[0] == cov.shape[0]), 'cov_mat and mu_vec must have the same dimensions'
    assert(mu.shape[0] == x.shape[0]), 'mu and x must have the same dimensions'
    part1 = 1 / ( ((2* np.pi)**(len(mu)/2)) * (np.linalg.det(cov)**(1/2)) )
    part2 = (-1/2) * ((x-mu).T.dot(np.linalg.inv(cov))).dot((x-mu))
    return float(part1 * np.exp(part2))

def test_gauss_pdf():
    x = np.array([[0],[0]])
    mu  = np.array([[0],[0]])
    cov = np.eye(2) 

    print(pdf_multivariate_gauss(x, mu, cov))

    # prints 0.15915494309189535

if __name__ == '__main__':
    test_gauss_pdf() 
```

如果我将来进行更改，代码[在 GitHub 上](https://github.com/rasbt/python_reference/blob/master/useful_scripts/multivariate_gaussian_pdf.py)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-07-23T15:48:49.173

`scipy.stats.norm`在对角协方差矩阵的常见情况下，可以通过简单地将实例返回的单变量 PDF 值相乘来获得多变量 PDF 。如果您需要一般情况，您可能必须自己编写代码（这应该不难）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-05-21T00:00:34.133

您可以使用 numpy 轻松计算。为了机器学习课程的目的，我已经实现了如下，并想分享，希望它对某人有所帮助。

```
import numpy as np
X = np.array([[13.04681517, 14.74115241],[13.40852019, 13.7632696 ],[14.19591481, 15.85318113],[14.91470077, 16.17425987]])

def est_gaus_par(X):
    mu = np.mean(X,axis=0)
    sig = np.std(X,axis=0)
    return mu,sig

mu,sigma = est_gaus_par(X)

def est_mult_gaus(X,mu,sigma):
    m = len(mu)
    sigma2 = np.diag(sigma)
    X = X-mu.T
    p = 1/((2*np.pi)**(m/2)*np.linalg.det(sigma2)**(0.5))*np.exp(-0.5*np.sum(X.dot(np.linalg.pinv(sigma2))*X,axis=1))

    return p

p = est_mult_gaus(X, mu, sigma) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-27T16:24:15.060

我知道有几个在内部使用它的 python 包，具有​​不同的通用性和不同的用途，但我不知道它们中的任何一个是否适用于用户。

例如，statsmodels 具有以下隐藏函数和类，但它不被 statsmodels 使用：

[https://github.com/statsmodels/statsmodels/blob/master/statsmodels/miscmodels/try_mlecov.py#L36](https://github.com/statsmodels/statsmodels/blob/master/statsmodels/miscmodels/try_mlecov.py#L36)

[https://github.com/statsmodels/statsmodels/blob/master/statsmodels/sandbox/distributions/mv_normal.py#L777](https://github.com/statsmodels/statsmodels/blob/master/statsmodels/sandbox/distributions/mv_normal.py#L777)

本质上，如果您需要快速评估，请为您的用例重写​​它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-05-20T16:46:31.360

我使用以下代码计算 logpdf 值，这对于更大的维度更可取。它也适用于 scipy.sparse 矩阵。

```
import numpy as np
import math
import scipy.sparse as sp
import scipy.sparse.linalg as spln

def lognormpdf(x,mu,S):
    """ Calculate gaussian probability density of x, when x ~ N(mu,sigma) """
    nx = len(S)
    norm_coeff = nx*math.log(2*math.pi)+np.linalg.slogdet(S)[1]

    err = x-mu
    if (sp.issparse(S)):
        numerator = spln.spsolve(S, err).T.dot(err)
    else:
        numerator = np.linalg.solve(S, err).T.dot(err)

    return -0.5*(norm_coeff+numerator) 
```

代码来自[pyParticleEst](http://www.control.lth.se/Staff/JerkerNordh/pyparticleest.html)，如果您想要 pdf 值而不是 logpdf，只需在返回值上使用 math.exp()

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-01-06T02:37:19.030

可以使用 numpy 函数和此页面上的公式以非常简单的方式计算密度：[http](http://en.wikipedia.org/wiki/Multivariate_normal_distribution) ://en.wikipedia.org/wiki/Multivariate_normal_distribution 。您可能还想使用似然函数（对数概率），它对于大尺寸不太可能下溢，并且计算起来更简单。两者都只涉及能够计算矩阵的行列式和逆矩阵。

另一方面，CDF 是一种完全不同的动物……

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-22T09:48:38.653

下面的代码帮助我解决，当给定一个向量时，向量处于多元正态分布的可能性是多少。

```
import numpy as np
from scipy.stats import multivariate_normal 
```

# 包含所有向量的数据

```
d= np.array([[1,2,1],[2,1,3],[4,5,4],[2,2,1]]) 
```

# 向量形式的数据的平均值，其长度与输入向量相同（此处为 3）

```
mean = sum(d,axis=0)/len(d)

OR
mean=np.average(d , axis=0)
mean.shape 
```

# 找到形状为 [输入向量形状 X 输入向量形状] 的向量的协方差，这里是 3x3

```
cov = 0
for e in d:
  cov += np.dot((e-mean).reshape(len(e), 1), (e-mean).reshape(1, len(e)))
cov /= len(d)
cov.shape 
```

# 从均值和协方差准备多元高斯分布

```
dist = multivariate_normal(mean,cov) 
```

# 寻找概率分布函数。

```
print(dist.pdf([1,2,3]))

3.050863384798471e-05 
```

上面的值给出了可能性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-01-08T14:35:51.523

在这里，我详细说明了如何准确使用 scipy 包中的[multivariate_normal()](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.multivariate_normal.html)：

```
# Import packages
import numpy as np
from scipy.stats import multivariate_normal

# Prepare your data
x = np.linspace(-10, 10, 500)
y = np.linspace(-10, 10, 500)
X, Y = np.meshgrid(x,y)

# Get the multivariate normal distribution
mu_x = np.mean(x)
sigma_x = np.std(x)
mu_y = np.mean(y)
sigma_y = np.std(y)
rv = multivariate_normal([mu_x, mu_y], [[sigma_x, 0], [0, sigma_y]])

# Get the probability density
pos = np.empty(X.shape + (2,))
pos[:, :, 0] = X
pos[:, :, 1] = Y
pd = rv.pdf(pos) 
```

# android - 在 Android 上禁用屏幕旋转动画

> ID：11615669
> 
> 赞同：4
> 
> 时间：2012-07-23T15:30:29.477
> 
> 标签：android, animation, rotation, screen

是否可以为活动或应用程序禁用旋转设备时在蜂窝中引入的动画？我仍然想检测旋转变化并旋转我的活动，但根本没有动画。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-28T03:06:05.130

开发人员不可能专门为他们的应用程序删除旋转动画。但是用户确实可以选择删除所有窗口动画。但是，如果这对您的应用程序确实有必要，您可以提示用户切换“删除动画”可访问性设置或“窗口动画比例”开发人员设置，但除此之外没有办法摆脱这些动画。

# android - 我可以在多个模拟器上自动并行运行 Robotium 测试吗？

> ID：11615675
> 
> 赞同：2
> 
> 时间：2012-07-23T15:30:40.500
> 
> 标签：android, eclipse, junit, parallel-processing, robotium

除了将我的 Robotium 测试拆分为多个项目和/或套件并在多个模拟器中手动运行它们之外，是否有工具或技术可以在 Eclipse 中自动执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:02:06.150

如果您采用“手动拆分”方式，您可能需要查看[EclipseRunner](http://code.google.com/p/eclipserunnerplugin/)。将您的不同模拟器作为单独的启动配置，然后将它们作为组运行。或者，您可以以几乎相同的方式使用[CDT 启动组](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.cdt.doc.user/reference/cdt_u_run_dbg_launch_group.htm)（并且您可以通过仅安装 CDT 更新站点的“C/C++ 远程启动”功能来避免使用完整的 CDT）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:48:21.247

我已经很好地使用了 ExecutorService 来完成这项工作。它在 Junit 上运行并模拟多个客户端。我知道你在期待什么，多个模拟器有点像场景和对它们的自动化测试。不要那样做。首先，每个模拟器都是一个虚拟机，您将无法在我们最快的桌面上运行多个模拟器，因为每个模拟器都占用 CPU 和内存来模拟自己的 CPU/内存。

而是使用 ExecutorService 使用 junits 测试您的东西，并关联延迟（模拟应用程序的屏幕转换。在每个客户端上运行多个测试并测试您的多客户端场景。

一旦上述测试和工作，只需一个客户端测试所有功能/流程。我敢打赌，你会比你想做的快 90% 200%。

# html - HTML 表格：空单元格的语义

> ID：11615678
> 
> 赞同：4
> 
> 时间：2012-07-23T15:31:08.197
> 
> 标签：html, html-table, semantic-markup, w3c-validation

我不经常使用表格，但是当我得到一些表格数据时，它会放在表格中。但我想知道除了使用空单元格之外，是否有更好或正确的对齐单元格的方法。

例如，我正在使用一个结帐表，该表连续列出每个产品、价格等，并根据需要添加尽可能多的行。最后，有标准的 sub、shipping、total 字段。

现在他们想要最后一部分都在右边，这是我遇到的一个非常标准的设置。不是每个人都这样，但我已经看到了。所以我不反对它，但我能看到的唯一方法是添加很多空单元格以使对齐正确。

```
<tr>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td>Sub-Total</td>
</tr>
<tr>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td><!--This cell should be empty--></td>
    <td>Total</td>
</tr> 
```

由于我通常尝试非常密切地遵循语义，这感觉不对。就像我错过了什么。但是在其他领域，一些单元格没有被填充，因为没有特定的数据可以放在那里，即如果一个产品有选项，而其他产品没有。所以不能错，因为这些字段必须为空。所以我被抓住了，我真的不知道这是对的，错的，意见，还是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:32:38.460

您可以使用该[`colspan`](http://www.htmlcodetutorial.com/tables/index_famsupp_30.html)属性。您可能希望将该列中的文本与 CSS 右对齐：

```
<tr>
    <td colspan="6">Sub-Total</td>
</tr>
<tr>
    <td colspan="6">Total</td>
</tr> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T17:37:48.353

将空单元`colspan`格与单独的值组合并保持单元格。列标题 ( `<th scope="col">`) 指向错误的单元格，否则，因为所有组合单元格都分配给使用的第一列`colspan`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-23T17:40:32.610

代替 5 个空单元格，您可以使用`<td colspan="5"></td>`. 然后，您可以将包含小计或总计的单元格包含为正常单元格。这使您可以单独处理该单元格的对齐方式，而不是将其视为跨越多列。

空单元格可能会在渲染中引起一些问题（出于这个原因，您可能希望`&nbsp;`用作内容和/或 CSS 规则[`empty-cells: show`](http://www.w3.org/TR/CSS21/tables.html#propdef-empty-cells)），但逻辑在这里几乎不是问题。

但是，对于在最后一列中包含一些总和的最后一行（尚不清楚这是否是您想要的），最好在此处进行一些解释，例如

```
<tr>
   <td colspan="5">Total</td>
   <td>$42,000,000</td>
</tr> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T15:33:18.583

可能最好的方法是设置 colspan="#" 这些行跨越的列数，然后设置 align="right"

# javascript - Javascript 根据 2 个 IF 语句更改页面内容

> ID：11615681
> 
> 赞同：0
> 
> 时间：2012-07-23T15:31:12.753
> 
> 标签：javascript, html, shipping

我有一家电子商务商店，用户选择的送货方式允许他们提供自己的帐号，然后在结帐时不提供帐号，这让我感到困扰。

表格第 1 部分：

```
<dt>
<span class="Required FormFieldRequired" style="visibility: hidden">*</span>
<span class="FormFieldLabel">Shipping Account Number:</span>
</dt>
<dd>
<input class="FormFieldId" type="hidden" value="25">
<input class="FormFieldFormId" type="hidden" value="2">
<input class="FormFieldType" type="hidden" value="singleline">
<input class="FormFieldPrivateId" type="hidden" value="">
<input id="FormField_25" class="Textbox Field200 FormField" type="text" value="Fill This If Using Your Own Shipping Account" name="FormField[2][25]">
</dd> 
```

表格第 2 部分：

```
<span class="FormFieldLabel">Shipping Account Number:</span>
<dd>
<input class="FormFieldId" type="hidden" value="26">
<input class="FormFieldFormId" type="hidden" value="3">
<input class="FormFieldType" type="hidden" value="singleline">
<input class="FormFieldPrivateId" type="hidden" value="">
<input id="FormField_26" class="Textbox Field200 FormField" type="text" value="Fill This If Using Your Own Shipping Account" name="FormField[3][26]">
</dd> 
```

这两个都在 PHP 生成的页面上的 2 个单独的 div 中（PHP 我们无法控制），当您按下“下一步”按钮时，它们所在的每个 div 都会被隐藏，显示下面的 div。

然后通过以下单选按钮选择运输：

```
<ul class="ShippingProviderList">
<li>
<label id="shippingMethod_500d6aa9a300e_1">
<input id="shippingCheck_500d6aa9a300e" type="radio" value="1" name="selectedShippingMethod[500d6aa9a300e]">
<span class="ShipperName">My Own Shipping Account (Please make sure that account number is specified within your account page or item will not ship!)</span>
<em class="ShipperPrice ProductPrice">$0.00</em>
</label>
</li> 
```

id 的 500d6 片段是动态生成的。

我需要帮助设计一段 Javascript 代码以放置在此页面上，以便如果选择了该单选圆圈，并且运输帐号表单字段都没有运输值，它只会隐藏

```
<input type="submit" value="Continue"> 
```

按钮，如果可能的话，用文字替换它（我可以自定义） - 不幸的是，我不知道 javascript，只有一些 PHP，当然还有 HTML/CSS。如果有人愿意帮助提供资源或链接以帮助我走上正确的道路，那将非常有帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T17:23:44.923

更改`<input type="submit" value="Continue">`为`<input type="submit" id="btn" value="Continue" hidden >`默认情况下我们将隐藏它（除非您使用 php 填充表单，在这种情况下您可以在那里进行检查以查看是否需要这样做）。

```
var radio = document.getElementById('shippingCheck_500d6aa9a300e'),
    input1 = document.getElementById('FormField_25'),
    input2 = document.getElementById('FormField_26'),
    btn = document.getElementById('btn'); // yes you will need to add an identifier to the button itself. name or id would work. if name you would document.forms[frmName or 0 for the first form].elements[buttonName]

document.forms[0].onchange = function() { // this assumes you have only one form. change the 0 to a name or proper index if need be.
    if( radio.checked && input1.value.length > 0 && input2.value.length > 0 ) {
        btn.hidden = false;
    } else {
        btn.hidden = true;
    }
}; 
```

我意识到您无法控制 id 值是什么......那么您将不得不按名称选择或使用 php 生成一些 js 来保存这些值。

希望这可以帮助。

# javascript - 在 jQuery Mobile 中完成 ajax 导航时执行 javascript 代码

> ID：11615686
> 
> 赞同：1
> 
> 时间：2012-07-23T15:31:24.687
> 
> 标签：javascript, jquery, jquery-mobile

我正在开发一个 jQuery 移动网络应用程序，目前有两个页面。

首先，页面 1 出现，如果用户点击一个链接，页面 2 将使用 jQuery 移动 ajax 导航系统打开。

但有个问题。第 2 页在加载时应该运行 javascript 代码，但 jQuery 移动 ajax 导航会删除该脚本，即使我`<script>...</script>`输入`<div data-role="content">...</div>`... （如果我在第 1 页的链接中使用，javascript 会运行`rel="external"`，但如果我想使用 ajax 导航， javascript不会加载...）

**当第 2 页使用**jQuery Mobile 的 ajax 导航系统加载时，如何运行该 javascript 代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:34:37.290

在您的第 2 页中，添加以下内容：

```
$(document).bind("pageshow", 
  function(e) {
    // script here
  }
); 
```

在 jQuery mobile 中，页面默认使用 ajax 加载并缓存。显示第 2 页时，触发“pageshow”事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-22T18:20:01.733

你可以在你的第一页的头部使用这样的东西：

```
$( document ).on( "pagecreate", "#PAGEIDHERE", function() {
   //do something here
}); 
```

然后脚本只会在页面创建后被调用。或者你可以使用'beforecreate'等。

# java-me - 无法使用 setCurrent 更改当前 Displayable

> ID：11615687
> 
> 赞同：2
> 
> 时间：2012-07-23T15:31:27.237
> 
> 标签：java-me, midp, lcdui

我正在创建一个使用蓝牙的 java ME 应用程序。

无论我如何尝试改变电流`Displayable`，它都不会改变。

我的应用程序将一个名为“设备”的文本框设置为启动时的当前可显示内容，我在另一个类的方法中将当前更改为一个名为“设备列表”的列表。

但是当我尝试将当前更改回文本框（设备）时，它不会改变。

我尝试在 midlet 类中使用显示对象，并在其他类中使用 gestDisplay。但是 List 对象 (deviceList) 仍然是当前的 Displayable。

**更新**根据我的测试，似乎有一些错误。TextBox (devices) 是当前的 Displayable，但是当我检查`isShown`它时它是假的。相反，另一个 Displayable: List (deviceList) 在测试时`isShown`为真。虽然 api 规范表明该`setCurrent`方法的效果不是立竿见影的，但当前的 Displayable 正在改变但它没有显示在屏幕上。这在真实设备和模拟器中都会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T21:31:30.930

您找到了规范的正确部分，但不是全部 - 这就是您感到困惑的原因。

您对*setCurrent 方法的效果不是立竿见影的*理解确实是 100% 正确的，这就是 API javadocs 指定的，好的：

*   [Display.setCurrent(Displayable)](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Display.html#setCurrent%28javax.microedition.lcdui.Displayable%29)：

    > ^(...更改通常不会立即生效。它可能会延迟，以便在事件传递方法调用之间发生，尽管不能保证在调用下一个事件传递方法之前发生。setCurrent() 方法立即返回，无需等待更改发生...)

现在，您注意到*当前的 Displayable 正在更改但未显示，这*让我觉得您使用`getCurrent`并期望它能够可靠地告诉屏幕何时显示。事实并非如此，请查看 API 文档：

*   [Display.getCurrent()](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Display.html#getCurrent%28%29)：

    > ^(获取此 MIDlet 的当前 Displayable 对象...返回的对象可能实际上不可见... [Displayable.isShown()](http://docs.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/Displayable.html#isShown%28%29)方法可能会被调用以确定 Displayable 在显示器上是否实际可见。)

因此，简单的答案可能是使用`isShown()`（而不是 getCurrent）来找出所需的屏幕何时可见。虽然...

...您遇到延迟的事实，尤其是即使在模拟器上也会发生这种情况，这让我觉得您的 midlet 中可能存在设计问题。我**强烈**建议检查是否有一些“重量级”活动在与 UI 相同的线程中运行，阻止它并使其无响应。

避免 UI 事件线程中的负载过重。`commandAction`当or `keyPressed`or etc内部有很多事情要做时`pointerPressed`，只需生成一个新线程即可。如果您在 midlet 中发现这种情况，请考虑研究本教程以找出正确的方法：

*   [网络、用户体验和线程](http://www.oracle.com/technetwork/systems/threading-155506.html)

    > ^(本文解释了 MIDlet 如何在不影响用户界面的情况下建立网络连接。它包括六个迭代示例，说明多线程网络和等待屏幕的使用...)

# mysql - 如何扩大我的产品数据库的大小？

> ID：11615694
> 
> 赞同：0
> 
> 时间：2012-07-23T15:31:48.087
> 
> 标签：mysql, magento, testing

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:58:48.133

You could install [ApiImport](https://github.com/danslo/ApiImport/wiki/Frequently-Asked-Questions).

Simply edit `.modman/ApiImport/tests/benchmark_import_api.php` to import as many products as you like. Preferably you'd set USE_API to false for faster results. You should probably also comment out the customer entity so that it doesn't flood your install with a bunch of customers.

Afterwards you can simply run the same file from the command-line.

# android - 接收器中的 NullPointerException

> ID：11615695
> 
> 赞同：1
> 
> 时间：2012-07-23T15:32:03.020
> 
> 标签：android

我有一个用户`NullPointerException`在我的一个 BroadcastReceiver 中得到一个堆栈跟踪如下

```
java.lang.RuntimeException: Unable to start receiver ecm2.android.NetworkReceiver: java.lang.NullPointerException
at android.app.ActivityThread.handleReceiver(ActivityThread.java:2821)
at android.app.ActivityThread.access$3200(ActivityThread.java:125)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2083)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:4627)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:521)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at android.content.ComponentName.<init>(ComponentName.java:75)
at android.content.Intent.<init>(Intent.java:2678)
at ecm2.android.NetworkReceiver.onReceive(NetworkReceiver.java:39)
at android.app.ActivityThread.handleReceiver(ActivityThread.java:2810) 
```

现在显然有些东西是空的，但是它指向的行是一个未决的意图，所以很难判断什么是空的

这是代码

```
Context c = MainActivity.getContext();
mAlarmSender2 = PendingIntent.getService(c, 0, new Intent(c, EMGNoteService.class), 0); //line that throws the error 
```

基本上我正在尝试取消`AlarmManager`已设置的内容，因此唯一可能是上下文为空正确吗？

我只是不确定，因为堆栈跟踪说的是关于的`ComponentName`，`Intent`所以我不知道意图是否有问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-02T17:44:43.000

问题确实是我的上下文所以我改变了它并修复了它

# xcode - iOS App - 为 UIWebView 加载设置超时

> ID：11615699
> 
> 赞同：24
> 
> 时间：2012-07-23T15:32:10.280
> 
> 标签：xcode, ios5, uiwebview, timeout, loading

我有一个加载单个 UIWebView 的简单 iOS 本机应用程序。如果应用程序未在 20 秒内完全加载 webView 中的初始页面，我希望 webView 显示错误消息。

我`viewDidLoad`像这样（简化）中加载了 webView 的 URL：

```
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.example.com"] cachePolicy:NSURLCacheStorageAllowed timeoutInterval:20.0]]; 
```

上面的`timeoutInterval`代码实际上并没有“做”任何事情，因为 Apple 在操作系统中设置它实际上不会超时 240 秒。

我`webView didFailLoadWithError`设置了我的操作，但是如果用户有网络连接，则永远不会调用它。webView 只是继续尝试加载我的 networkActivityIndi​​cator 旋转。

有没有办法为 webView 设置超时？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-23T15:58:54.823

timeoutInterval 用于连接。webview 连接到 URL 后，您需要启动 NSTimer 并进行自己的超时处理。就像是：

```
// define NSTimer *timer; somewhere in your class

- (void)cancelWeb
{
    NSLog(@"didn't finish loading within 20 sec");
    // do anything error
}

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    [timer invalidate];
}

- (void)webViewDidStartLoad:(UIWebView *)webView
{
    // webView connected
    timer = [NSTimer scheduledTimerWithTimeInterval:20.0 target:self selector:@selector(cancelWeb) userInfo:nil repeats:NO];
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-10-03T15:50:14.170

所有建议的解决方案都不理想。处理此问题的正确方法是在`NSMutableURLRequest`自身上使用 timeoutInterval：

```
NSMutableURLRequest* request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://web.site"]];

request.timeoutInterval = 10;

[webview loadRequest:request]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-07T13:55:46.883

我的方式类似于接受的答案，但只是在超时时停止加载并控制在 didFailLoadWithError 中。

```
- (void)timeout{
    if ([self.webView isLoading]) {
        [self.webView stopLoading];//fire in didFailLoadWithError
    }
}

- (void)webViewDidStartLoad:(UIWebView *)webView{
    self.timer = [NSTimer scheduledTimerWithTimeInterval:10 target:self selector:@selector(timeout) userInfo:nil repeats:NO];
}

- (void)webViewDidFinishLoad:(UIWebView *)webView{
    [self.timer invalidate];
}

- (void)webView:(UIWebView *)webView didFailLoadWithError:(nullable NSError *)error{
    //Error 999 fire when stopLoading
    [self.timer invalidate];//invalidate for other errors, not time out. 
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-02-22T13:53:52.107

Swift 编码人员可以这样做：

```
var timeOut: NSTimer!

   func webViewDidStartLoad(webView: UIWebView) {
    self.timeOut = Timer.scheduledTimer(timeInterval: 7.0, target: self, selector: Selector(("cancelWeb")), userInfo: nil, repeats: false)
}

func webViewDidFinishLoad(webView: UIWebView) {
    self.timeOut.invalidate()
}

func webView(webView: UIWebView, didFailLoadWithError error: NSError?) {
    self.timeOut.invalidate()
}

func cancelWeb() {
    print("cancelWeb")
} 
```

# performance - 标量值函数比预期慢

> ID：11615703
> 
> 赞同：1
> 
> 时间：2012-07-23T15:32:16.000
> 
> 标签：performance, sql-server-2005, user-defined-functions

```
CREATE function [dbo].[fn_GetDateOnly](@dateWithTime datetime)
    returns datetime WITH SCHEMABINDING
as
begin
    return DATEADD(DAY, DATEDIFF(DAY, 0, @dateWithTime), 0)
end

SELECT stuff, count(ff.id)
FROM dbo.foo AS ff 
where
--DATEADD(DAY, DATEDIFF(DAY, 0, ff.startDate), 0) <= @curdate --6700ms
--dbo.fn_GetDateOnly(ff.startDate) <= @curdate --9300ms
group by stuff
order by stuff desc 
```

为什么调用 fn_getdateonly 比内联慢得多？SQL 不是内联函数调用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:37:59.540

**列上的表达式**

首先，无论您使用什么函数，将其放在 WHERE 子句或表中列的 JOIN 条件中都是次优的。对常数进行数学运算并进行比较。您的 WHERE 子句应如下所示：

```
ff.startDate < DateAdd(day, 1, @curdate) -- if @curdate has time portion removed
ff.startDate < DateAdd(day, 1, dbo.fn_GetDateOnly(@curdate)) -- if @curdate has time 
```

要在给定日期一般查找项目，请使用以下模式：

```
WHERE
   DateCol >= '20120901'
   AND DateCol < '20120902' 
```

将任何函数放在等号的另一侧作为列，应该是单独的。它可以帮助您查找如何使表达式 SARGable。如果列必须位于两侧，则将所有表达式放在执行计划中作为“左”输入的一侧（其数据首先出现，是 LOOP JOIN 的外循环或 a 的“表”侧哈希连接）。例如，如果您尝试这样做：

```
WHERE dbo.fn_getDateOnly(A.DateCol) = dbo.fn_getDateOnly(B.DateCol) 
```

然后假设 A.DateCol 在执行计划中排在第一位，将其切换为：

```
WHERE
   B.DateCol >= DateAdd(day, DateDiff(day, 0, A.DateCol), 0)
   AND B.DateCol < DateAdd(day, DateDiff(day, 0, A.DateCol), 0) 
```

（或者使用下面函数的内联版本，但我发现它同样尴尬，所以间接的没有额外的价值）。

如果要在所涉及的表上频繁进行这种查询，那么可能需要进行一些重新设计，或者添加一个删除了时间部分（可能是索引）的持久计算列，将日期时间拆分为单独的日期和时间字段，或者将其存储为简单的日期开始（如果你真的不需要日期时间）。

注意：当然，对 dbo.fn_getDateOnly 的引用可以简单地替换为`DateAdd(day, DateDiff(day, 0, DateCol), 0)`. 此外，如果该值具有`datetime`数据类型，您可以只做`DateCol + 1`而不是使用`DateAdd`（但要小心，因为这不适`date`用于 SQL 2008 及更高版本中的数据类型）。

**UDF 的内联能力**

至于函数在 SELECT 子句中的表现，SQL Server 只内联“内联函数”，而不是标量函数。更改您的函数以返回单行记录集`CREATE FUNCTION ... RETURNS TABLE AS RETURN (SELECT ...)`并像这样使用它：

```
SELECT
   (SELECT DateValue FROM dbo.fn_GetDateOnly(Col)),
   ... 
```

它实际上与参数化视图没有什么不同。

在 WHERE 子句中使用这个内联版本会很笨拙。执行 DateDiff 几乎更好。在 SQL 2008 中，当然只是使用`Convert(date, DateCol)`但*仍然遵循关于将计算表达式放在何处的规则（在列的等号的另一侧）*。

请务必[在 Microsoft Connect 上为内联标量 UDF](http://connect.microsoft.com/SQLServer/feedback/details/273443/the-scalar-expression-function-would-speed-performance-while-keeping-the-benefits-of-functions)投票！您远不是唯一一个认为此功能严重缺乏的人。

# c# - Protobuf-net 和不可变消息的继承

> ID：11615708
> 
> 赞同：2
> 
> 时间：2012-07-23T15:32:22.313
> 
> 标签：c#, protobuf-net

我正在尝试序列化具有不可变基类的不可变消息。但是，我无法说服 protobuf-serializer 将其反序列化为派生类型。简而言之，这个测试给了我一个无效的强制转换异常（从 Base 到 Derived）：

```
[TestFixture]
public class InheritanceTest
{
    public class Base
    {
        public int IntField { get; private set; }

        public Base(int intField)
        {
            IntField = intField;
        }
    }

    public class Derived : Base
    {
        public string StringField { get; private set; }

        public Derived(int intField, string stringField) : base(intField)
        {
            StringField = stringField;
        }
    }

    [Test]
    public void TestInheritance()
    {
        var serializer = TypeModel.Create();
        serializer.Add(typeof (Base), true)
            .Add(1, "IntField")
            .AddSubType(2, typeof (Derived))
            .UseConstructor = false;

        serializer.Add(typeof (Derived), true)
            .Add(1, "StringField")
            .UseConstructor = false;

        serializer.CompileInPlace();

        using (var stream = new MemoryStream())
        {
            var message = new Derived(1, "Some text that is not important");

            serializer.Serialize(stream, message);
            stream.Position = 0;

            var retrieved = (Derived) serializer.Deserialize(stream, null, typeof (Derived));

            Assert.AreEqual(message.IntField, retrieved.IntField);
            Assert.AreEqual(message.StringField, retrieved.StringField);
        }
    }

} 
```

如果我将 Base 和 Derived 转换为可变类型，此异常就会消失。我做错了什么还是protobuf-net的限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:52:15.010

```
 [TestFixture]
public class InheritanceTest
{
    public class Base
    {
        public int IntField { get; private set; }

        public Base(int intField)
        {
            IntField = intField;
        }
    }

    public class Derived : Base
    {
        public string StringField { get; private set; }

        public Derived(int intField, string stringField) : base(intField)
        {
            StringField = stringField;
        }
    }

    [Test]
    public void TestInheritance()
    {
        var serializer = TypeModel.Create();
        serializer.Add(typeof (Base), true)
            .Add(1, "IntField")
            .UseConstructor = false;

        serializer.Add(typeof (Derived), true)
            .Add(1, "StringField")
            .UseConstructor = false;

        serializer.CompileInPlace();

        using (var stream = new MemoryStream())
        {
            var message = new Derived(1, "Some text that is not important");

            serializer.Serialize(stream, message);
            stream.Position = 0;

            var retrieved = (Derived) serializer.Deserialize(stream, null, typeof (Derived));

            Assert.AreEqual(message.IntField, retrieved.IntField);
            Assert.AreEqual(message.StringField, retrieved.StringField);
        }
    }

} 
```

或者

```
 [TestFixture]
    public class InheritanceTest
    {
        [DataContract]
        public class Base
        {
            [DataMember(Order = 1)]
            public int IntField { get; private set; }

            public Base(int intField)
            {
                IntField = intField;
            }
            protected Base(){}
        }

        [DataContract]
        public class Derived : Base
        {
            [DataMember(Order = 3)]
            public string StringField { get; private set; }

            public Derived(int intField, string stringField) : base(intField)
            {
                StringField = stringField;
            }
            private Derived(){}
        }

        [Test]
        public void TestInheritance()
        {
            RuntimeTypeModel.Default.Add(typeof(Base), true).AddSubType(2, typeof(Derived));

             using (var stream = new MemoryStream())
                {
                    var message = new Derived(1, "Some text that is not important");

                    Serializer.Serialize(stream, message);
                    stream.Position = 0;

                    var retrieved = Serializer.Deserialize<Derived>(stream);            

                    Assert.AreEqual(message.IntField, retrieved.IntField);
                    Assert.AreEqual(message.StringField, retrieved.StringField);
            }
        }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:43:48.020

这看起来是元组检测的副作用，导致它具有特定的代码分支。好处是，您应该能够从原始代码中修复它，只需更改`true`为`false`. 该参数说明是否应用标准行为。您不需要它，因为您自己定义模型。

```
 var serializer = TypeModel.Create();
        serializer.Add(typeof (Base), false)
            .Add(1, "IntField")
            .AddSubType(2, typeof (Derived))
            .UseConstructor = false;

        serializer.Add(typeof (Derived), false)
            .Add(1, "StringField")
            .UseConstructor = false; 
```

注意我还没有验证这一点——不过我会稍后检查。

# asp.net - 每个目录都需要一个 ashx 处理程序文件吗？

> ID：11615709
> 
> 赞同：0
> 
> 时间：2012-07-23T15:32:22.500
> 
> 标签：asp.net, iis, web-config, httphandler

我似乎记得当 aspx 文件驻留在 IIS6 的子文件夹中时，ashx 处理程序没有被拾取的问题。是这样吗？

我一直在玩可[配置的解决方案](http://msdn.microsoft.com/en-us/library/46c5ddfy.aspx)，它允许在 web.config 而不是 .ashx 文件中配置处理程序，这能解决问题吗？如果有的话！一个简单的测试对我来说非常有效，一次性配置覆盖了整个应用程序，消除了我所有客户端 aspx 目录中对相同 .ashx 的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:22:56.167

我将 HttpHandler 与 HttpModule 混合在一起。HttpHandler 像任何形式一样工作，需要显式调用或在 web.config 中进行配置。

# ruby-on-rails-3 - 使用轮胎和弹性搜索对模型关联记录值变化的弹性搜索索引进行增量索引

> ID：11615710
> 
> 赞同：1
> 
> 时间：2012-07-23T15:32:22.567
> 
> 标签：ruby-on-rails-3, associations, elasticsearch, tire, delta-index

我是 Ruby on Rails 中弹性搜索和轮胎的新手。观看了 ryan bates 的 railscasts 并帮助我开始工作。轮胎是一个伟大的宝石，具有增量索引的功能。假设我有如下映射，如果编辑/删除关联值，Tire 会自动对模型关联进行增量索引。例如，假设我有如下索引映射，

```
 mapping do
    indexes :id,      :type => 'integer', :index    => :not_analyzed
    indexes :col_2,   :type => 'integer', :index    => :not_analyzed
    indexes :col_3,   :type => 'date'
    indexes :col_4,   :type => 'date'

    indexes :model_2 do
      indexes :name,                  :type => 'string', :analyzer => 'whitespace'
      indexes :association_col_2,     :type => 'string', :index    => :not_analyzed
    end
 end 
```

当 model_2.association_col_2 的值发生变化时，轮胎会自动对定义映射的模型中的相应行进行增量索引？我应该如何处理对关联模型值变化的模型进行增量索引？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:01:49.823

轮胎与例如不同。想想 Sphinx，因为实际上没有发生增量索引：当你的模型发生变化时，你已经包含了索引回调，*整个*序列化为 JSON 的记录被发送到 elasticsearch，替换旧文档（请记住，elasticsearch 实际上是一个“可搜索的文档数据库”）。

如果要从子模型触发父模型中的回调，则必须使用 Rails 来执行此操作：

```
class Brake < ActiveRecord::Base
  belongs_to :car, :touch => true
end 
```

请参阅[ActiveRecord#touch](https://github.com/rails/rails/blob/7edade337e968fb028b2b6abfa579120eb424039/activerecord/lib/active_record/persistence.rb#L296-315)方法的文档。但是，您还必须在父模型中添加订阅者，如本*StackOverflow中所述*答案中所述：[Elasticsearch、Tire 和 Nested queries/associations with ActiveRecord](https://stackoverflow.com/questions/11692560/elasticsearch-tire-and-nested-queries-associations-with-activerecord/11711477#11711477)。

当然，您也可以手动处理，通过观察者触发更新，使用后台处理/消息传递等。

# applescript - 大于或等于applescript中的怪异

> ID：11615711
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:32:26.677
> 
> 标签：applescript

我在一个applescript中有这条线：

```
 if start_period ≤ currentDay and currentDay ≤ end_period then

--create the appointment 
```

这是 start_period = 1 和 end_period = 15 的结果：

```
 tell application "AppleScript Editor"
    display dialog "Current day:  1"
        --> {button returned:"OK"}
end tell
tell application "iCal"
    make new event at end of calendar "Manpower" with properties {summary:"CD", start date:date "Sunday, January 1, 2012 12:00:00 AM", end date:date "Sunday, January 1, 2012 12:00:00 AM", allday event:true}
        --> event id "D6FC11E3-17EB-4F49-8491-ECF8F08E5B56" of calendar id "7DC7F2B9-EF4C-4BFC-9D25-6061D71704F0"
end tell
tell application "AppleScript Editor"
    display dialog "Current day:  2"
        --> {button returned:"OK"}
    display dialog "Current day:  3"
        --> {button returned:"OK"}
    display dialog "Current day:  4"
        --> {button returned:"OK"}
    display dialog "Current day:  5"
        --> {button returned:"OK"}
    display dialog "Current day:  6"
        --> {button returned:"OK"}
    display dialog "Current day:  7"
        --> {button returned:"OK"}
    display dialog "Current day:  8"
        --> {button returned:"OK"}
    display dialog "Current day:  9"
        --> {button returned:"OK"}
    display dialog "Current day:  10"
        --> {button returned:"OK"}
end tell
tell application "iCal"
    make new event at end of calendar "Manpower" with properties {summary:"Duty", start date:date "Tuesday, January 10, 2012 12:00:00 AM", end date:date "Tuesday, January 10, 2012 12:00:00 AM", allday event:true}
        --> event id "5C52EFAA-287A-4879-B549-FDDD225853DA" of calendar id "7DC7F2B9-EF4C-4BFC-9D25-6061D71704F0"
end tell
tell application "AppleScript Editor"
    display dialog "Current day:  11"
        --> {button returned:"OK"} 
```

然后从 11 开始，它的行为就像我认为的那样。谁能告诉我我做错了什么？

谢谢您的帮助，

罗兰

编辑（添加代码）：

```
set theDoc to (choose file with prompt "Choose source files" with multiple selections allowed without invisibles) as string

-- choose destination folder
set sourceFolder to choose folder with prompt "Choose a folder to contain files:"

display dialog "Date to begin import" default answer "First Day..."
set start_day to date (text returned of result)

display dialog "Date to complete import" default answer "Last Day…"
set end_day to date (text returned of result)

--remove all current appointments
tell application "iCal"
    set theCalendars to title of every calendar
    tell calendar "Manpower" -- your calendar here
        set theEvents to every event whose (start date is greater than or equal to start_day) and (start date is less than or equal to the end_day)

        repeat with current_event in theEvents
            delete current_event
        end repeat
    end tell
end tell

--display dialog "delete complete"

--set the returned_events to every event of calendar 1 ¬ 
--whose (start date is greater than or equal to start_day) and ¬ 
--(start date is less than or equal to the end_day) 
--remove all csv files from source folder
tell application "Finder"
    delete (files of sourceFolder)
end tell

--Get user name
display dialog "What's your last name?" default answer "My last name is..."
set theName to (text returned of result)

--save csv files
tell application "Microsoft Excel"
    open file theDoc
    tell workbook 1
        repeat with a from 1 to 12
            tell sheet a
                set myFileName to sourceFolder & "month" & a & ".csv" as string

                save in myFileName as CSV file format
            end tell
        end repeat
        close without saving
    end tell
end tell

    repeat with b from 1 to 12
    set start_month to (month of (start_day)) * 1
    set end_month to (month of (end_day)) * 1

    if b ≥ start_month then
        if b ≤ end_month then

            tell application "Finder"

                set curFileName to (sourceFolder as text) & "month" & (b as text) & ".csv"
                set workingFile to read file (curFileName)

                -- break the file down into rows
                set AppleScript's text item delimiters to {ASCII character 13}
                -- theContents is a list of all the rows
                set theContents to text items of workingFile as list
            end tell

            --rowTwo is the list of names
            set rowTwo to item 2 of theContents
            set AppleScript's text item delimiters to {","}
            set rowParts to (every text item in rowTwo)

            --Find the name entered by the user and return its number (nameNumber
            set nameNumber to findName(rowParts, theName)

            try

                repeat with j from 1 to the count of theContents

                    if j > 2 then
                        set AppleScript's text item delimiters to {","}
                        set currentItem to text item j of theContents
                        set currentRow to text items of currentItem

                        set rowCount to count (currentRow)

                        --if we have passed the first two row (pass info and column headers) then start gathering duty information
                        if rowCount > 2 then
                            --dutyStat is duty status
                            set dutyStat to item nameNumber of currentRow
                            set statCount to count (dutyStat)

                            set dutyDate to text item 1 of currentRow
                            set myCount to count (dutyDate)

                            --to ensure that we have an actual date in the field
                            if myCount > 4 then

                                set AppleScript's text item delimiters to "-"
                                set dutyDateT to text items of dutyDate as list
                                set dutyTwo to text items of dutyDateT
                                set datePartC to count (dutyDateT)
                                set currentDay to text item 1 of dutyTwo as string
                                set currentMonth to text item 2 of dutyTwo as string
                                set AppleScript's text item delimiters to {","}
                                set dutyDateToo to date ((b as text) & " " & currentDay & " " & "2012")
                                set start_period to (day of (start_day))
                                set end_period to (day of (end_day))

                                display dialog "Current day:  " & currentDay
                                --if (currentDay as text) ≥ (start_period as text) then
                                --display dialog "Larger than the start.  Current day:  " & currentDay & ".  Start period:  " & (start_period as text)
                                --if (currentDay as int) ≤ (end_period as text) then
                                --display dialog "smaller than the complete…creating appt Current day:  " & currentDay & ".  End period:  " & (end_period as text)
                                if start_period ≤ currentDay and currentDay ≤ end_period then
                                    --create the appointment
                                    tell application "iCal"
                                        tell calendar "Manpower"

                                            make new event at end with properties {summary:dutyStat, start date:dutyDateToo, end date:dutyDateToo, allday event:true}
                                        end tell
                                    end tell
                                    --end if
                                end if
                            end if
                        end if
                    end if

                end repeat
            on error errMsg
                display dialog "ERROR on date:  " & item 1 of currentRow & ".  The error is:  " & errMsg

            end try
        end if
    end if
end repeat

    on findName(rowList, theItem)
    repeat with i from 1 to the count of rowList
        if item i of rowList is theItem then return i

    end repeat

end findName 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T20:04:50.650

问题是您将**数字**与此行中的**文本**`if start_period ≤ currentDay and currentDay ≤ end_period then`进行比较。

`set currentDay to text item 1 of dutyTwo as string`--> **currentDay**是一个字符串

`set start_period to (day of (start_day))`--> **start_period**是一个整数，**end_period**也是一个整数

用这个`set currentDay to (text item 1 of dutyTwo) as integer`

# html - 构造 2 中的多个游戏帧用于新关卡？

> ID：11615717
> 
> 赞同：1
> 
> 时间：2012-07-23T15:32:55.950
> 
> 标签：html, platform, construct-2

您好，我是 Construct 新手，并尝试了一些平台游戏教程。我开始掌握设置变量和碰撞，我现在正处于我想开始添加新关卡的阶段。什么是有效达到新水平的最佳方法，我知道在闪存中这将是时间轴上的一个新帧，你会在构造 2 中做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T13:50:46.963

在 Construct 2 中，布局是关卡/场景/框架的术语。您可以在项目栏中添加和删除布局。

# matlab - 在 MATLAB 中重构

> ID：11615719
> 
> 赞同：5
> 
> 时间：2012-07-23T15:33:01.563
> 
> 标签：matlab, refactoring, automated-refactoring

我得到了一个徒劳的任务来合并我的前任写的一些程序。一堆乱七八糟的乱七八糟的代码。

到目前为止，我只知道自动识别（Ci）。所以我想知道你是否可以推荐一些工具。

我遇到的一些关键问题：

*   对同一结构的分配在整个文件中闪闪发光
*   这是一个大代码文件 - 我想拆分它
*   相当多的代码会产生从未使用过的结果

**更新** 在*漂亮的*部分，我发现 Emacs 的 Matlab 模式可以打破过长的行，这很合理。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T15:40:32.007

增量重构是前进的方向。

*   选择一个看起来相当独立的 m 文件，并计算出它应该做什么。
*   为 m 文件创建一个测试。这可以像从文件中加载一些数据一样简单，使用该数据作为参数调用函数，并检查结果是否与原始输出匹配（显然，在您进行任何更改之前，测试应该通过！）
*   开始对文件进行更改。每隔一段时间，运行测试以确保它仍然通过。如果它没有通过，那么你已经破坏了一些东西 - 撤消你的最后一组更改（你正在使用版本控制，对吗？）然后再试一次。
*   重复直到完成，总是从最不依赖的函数开始到最依赖的函数。

不幸的是，没有灵丹妙药。您可以依赖 Matlab linter，它会告诉您何时从未分配或使用变量，或者何时从未调用函数，但除此之外，您需要一次整理代码，并在测试时进行测试去。

# json - ExpressionEngine 插件返回 json 数据

> ID：11615720
> 
> 赞同：1
> 
> 时间：2012-07-23T15:33:09.437
> 
> 标签：json, expressionengine

在我使用的插件中：

```
$this->return_data = json_encode(array('loggedin' => $LoggedIn, 'Cust_ID' => $Participant_ID)); 
```

在模板中我这样称呼它

```
$custinfo = {exp:user_loggedin}; 
```

它像这样返回它：

```
$custinfo = {"loggedin":"no","Cust_ID":-1}; 
```

我得到这个错误：

```
PHP Parse error:  syntax error, unexpected '{' in expressionengine/libraries/Functions.php(642) : eval()'d code on line 656 
```

如果我使用

```
$custinfo = json_decode({exp:user_loggedin}) 
```

我收到此错误：

```
PHP Parse error:  syntax error, unexpected '{', expecting ')' in expressionengine/libraries/Functions.php(642) : eval()'d code on line 656 
```

有任何想法吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:30:03.503

我的猜测是你需要引用你的变量：

`$custinfo = "{exp:user_loggedin}";`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T19:50:54.890

我认为您同时遇到了解析顺序问题和引用问题。

假设您在输出上处理 PHP。

1.  插件将运行
2.  然后是常规的EE代码
3.  然后 PHP

Derek 认识到报价问题，建议：

```
$custinfo = "{exp:user_loggedin}"; 
```

但这不会在第 3 阶段转化为以下代码吗？

```
$custinfo = "{"loggedin":"no","Cust_ID":-1}"; 
```

对您来说，这看起来像是有效的 PHP 代码吗？对我没有。

您要么必须转义这些引号，要么使用 HEREDOC 或其他东西……</p>

```
$custinfo = <<<HEREDOC
{"loggedin":"no","Cust_ID":-1}
HEREDOC; 
```

# c++ - 获取链接列表以打印数字

> ID：11615721
> 
> 赞同：3
> 
> 时间：2012-07-23T15:33:14.937
> 
> 标签：c++, data-structures, linked-list

我想用用户提供的数字填充一个链接列表，并让它们再次打印出来。但是，如下所示，我的实现只会打印出第一个输入数字。我在列表的开头插入。你能说出什么是错的吗？

```
struct Node 
{
  int data; 
  Node* next;
};

Node newNode(int num, Node *next_node)
{
    Node node;
    node.data = num;
    node.next = next_node;
    return node;
}

void headInsert(Node* head, int num)
{
    Node* tmp;  
    tmp  = new Node;
    tmp->data = num;
    tmp->next = head;
    head = tmp;
}

int main(int argc, char* argv[])
{

    if (argc < 2)
    {
        std::cout<< "No input for linked list!! \n" <<
                    "Usage: ./linkedlist 2 3 567 12 .. etc."
                 <<"\n";
        return 0;
    }

    Node *head, *temp;
    head = new Node;
    head->data = atoi(argv[1]);
    head->next = NULL;

    headInsert(head, atoi(argv[2]));
    headInsert(head, atoi(argv[3]));

    temp = head;

    while(temp != NULL) 
    {
        std::cout << temp->data<< " ";
        temp = temp->next;
    }

        return EXIT_SUCCESS;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:37:19.637

中`headInsert()`，`head = tmp;`只改变**局部变量** `head`。

您可以将其作为**引用指针**传递，`Node*& head`.

# sitecore - Sitecore 发布整个内容树

> ID：11615724
> 
> 赞同：1
> 
> 时间：2012-07-23T15:33:34.310
> 
> 标签：sitecore, publishing

我们遇到了 Sitecore 的问题，其中智能发布被触发，我们无法确定是什么导致这些触发以及谁在触发它们。日志显示，用户每次都会使用“children:false”选项触发智能发布。但是当我在“发布状态管理器”模块中查看发布时，我们看到整个网站都在智能发布。该站点需要 10-15 分钟才能发布整个树。

该模块还针对发布显示用户名，但当我们与这些用户交谈时，事实证明他们没有为该站点触发智能发布。通常，他们会触发增量发布。

还有一个计划发布，每 15 分钟运行一次，它执行增量发布。

有人遇到过这个问题吗？“发布状态管理器”是否会导致此问题或意外的配置更改会导致此问题？

欢迎任何提示/提示/建议。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T09:26:54.570

希望这会有所帮助，我们在通过 API 执行智能发布来完成增量发布时遇到了问题。

使用以下代码调用增量发布：

```
PublishAgent myPublish = new PublishAgent("master", "web", "incremental", "en");
myPublish.Run(); 
```

而是导致智能发布。

最终我们遇到了这个：

```
Sitecore.Data.Database master = Sitecore.Configuration.Factory.GetDatabase("master");
Sitecore.Data.Database[] targets = {Sitecore.Configuration.Factory.GetDatabase("web")};
Sitecore.Publishing.PublishManager.PublishIncremental(master, targets, master.Languages); 
```

这似乎工作正常。

需要注意的是，这是很久以前的事了，我相信该网站是在 5.3 上，所以这些天情况可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T20:01:12.170

原来这是 Sitecore 安装的一个问题，其中增量发布正在发布子项目并导致它永远需要。Sitecore 支持已为此提供了修复程序。这不是 Sitecore 的已知问题。

# c++ - 未命名类型错误 C++

> ID：11615727
> 
> 赞同：1
> 
> 时间：2012-07-23T15:33:39.380
> 
> 标签：c++

我已经查看了有关此错误的其他问题，但它们并没有帮助我。我还是 C++ 的新手，我不知道我是否误解了某些东西，滥用了某些东西，或者只是缺少某些东西，但我不知道是什么，我需要一些帮助。我得到的错误是

> **SpriteImage 没有命名类型**

**精灵.cpp**

```
#include "Sprite.h"
#include "SDL/SDL.h"
#include "SDL/SDL_image.h"
#include <iostream>
#include <vector>

namespace ColdFusion
{
Sprite::Sprite()
{
    bufferSize = 100;
}

void Sprite::addToBuffer(SpriteImage img)
{
    if(SpriteBuffer->size() == bufferSize)
    {
        bufferSize *= 2;
        SpriteBuffer->resize(bufferSize);
    }
    SpriteBuffer->push_back(img);
}

SpriteImage Sprite::getFromBuffer(int index) //**Here is the error**
{
    return SpriteBuffer[index];
}

void Sprite::removeFromBuffer(int index)
{
    SpriteBuffer->erase(SpriteBuffer.begine()+index);
}

void Sprite::removeFromBuffer(SpriteImage index)
{
    for(int j = 0; j <= SpriteBuffer->size(); j++)
    {
        if(SpriteBuffer[j].name == index.name)
        {
            removeFromBuffer(j);
        }
    }
}

void Sprite::applyToScreen(SpriteImage img, SDL_Surface* destination)
{
    applyImage(img.x, img.y,getImage(img.filepath),destination)
}

SDL_Surface* Sprite::getImage(std::string filepath)
{
    SDL_Surface* optimized = NULL;
    SDL_Surface* loaded = NULL;
    loaded = IMG_Load(filepath.c_str());

    if(loaded != NULL)
    {
        optimized = SDL_DisplayFormat(loaded);
        SDL_FreeSurface(loaded);
        return optimized;
    }
    return NULL;
}

void Sprite::applyImage(int x, int y, SDL_Surface* source, SDL_Surface* destination)
{
    SDL_Rect offset;
    offset.x = x;
    offset.y = y;
    SDL_BlitSurface(source, NULL, destination, &offset);
}

Sprite::~Sprite()
{

}
} 
```

**精灵.h**

```
#ifndef SPRITE_H
#define SPRITE_H

#include "SDL/SDL.h"
#include <iostream>
#include <vector>

namespace ColdFusion
{
class Sprite
{
    public:
        Sprite();
        ~Sprite();
        typedef struct SpriteImage{
            int x;
            int y;
            std::string name;
            std::string filepath;
        };
        void addToBuffer(SpriteImage img);
        SpriteImage getFromBuffer(int index);
        void removeFromBuffer(int index);
        void removeFromBuffer(SpriteImage index);
        void applyToScreen(SpriteImage img, SDL_Surface* destination);

    protected:
    private:
        int bufferSize;
        std::vector<SpriteImage> SpriteBuffer[100];
        SDL_Surface* image;
        SDL_Surface* getImage(std::string filepath);
        void applyImage(int x, int y, SDL_Surface* source, SDL_Surface* destination);

};
}

#endif 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:35:25.207

`SpriteImage`是嵌套类型，当您超出包含类的范围时，您必须使用其周围类的名称对其进行限定才能访问它。使用`Sprite::SpriteImage`. `addToBuffer`将参数带到by`const&`以避免许多复制结构也是有意义的。（可能它们最终会被优化掉，但这是一种很好的做法）。

除了原始数组，您还可以使用`std::array`or `boost::array`。第二点：声明`std::vector<SpriteImage> SpriteBuffer[100];`可能没有声明你认为它做了什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T15:36:53.317

当用作返回类型时，您不在类的命名空间中，因此您需要限定`SpriteImage`：

```
Sprite::SpriteImage Sprite::getFromBuffer(int index) //**Here is the error**
{
    return SpriteBuffer[index];
} 
```

# java - 旧的“同一班级内的@Transactional”情况

> ID：11615728
> 
> 赞同：12
> 
> 时间：2012-07-23T15:33:45.387
> 
> 标签：java, spring-aop, spring-transactions, aop

**原始问题的概要：**使用带有AOP代理的标准Spring Transactions，不可能从同一类中的非@Transactional-marked方法调用@Transactional-marked方法并且在事务中（特别是由于前面提到的代理人）。这在 AspectJ 模式下的 Spring Transactions 中是可能的，但它是如何完成的呢？

**编辑：在 AspectJ 模式下使用****Load-Time** Weaving的 Spring Transactions 的完整纲要：

将以下内容添加到`META-INF/spring/applicationContext.xml`：

```
<tx:annotation-driven mode="aspectj" />

<context:load-time-weaver /> 
```

（我假设您已经在应用程序上下文中设置了一个`AnnotationSessionFactoryBean`和是该属性的默认值。）`HibernateTransactionManager``transaction-manager="transactionManager"``<tx:annotation-driven />``id``transactionManager``transactionManager`

添加`META-INF/aop.xml`. 内容如下：

```
<aspectj>
  <aspects>
    <aspect name="org.springframework.transaction.aspectj.AnnotationTransactionAspect" />
  </aspects>
  <weaver>
    <include within="my.package..*" /><!--Whatever your package space is.-->
  </weaver>
</aspectj> 
```

`aspectjweaver-1.7.0.jar`将和添加`spring-aspects-3.1.2.RELEASE.jar`到您的`classpath`. 我使用 Maven 作为我的构建工具，所以这里是`<dependency />`你项目`POM.xml`文件的声明：

```
<dependency>
  <groupId>org.aspectj</groupId>
  <artifactId>aspectjweaver</artifactId>
  <version>1.7.0</version>
</dependency>
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-aspects</artifactId>
  <version>3.1.2.RELEASE</version>
</dependency> 
```

`spring-instrument-3.1.2.RELEASE.jar`不需要作为 a`<dependency />`在您的 上`classpath`，但您仍然需要它*，*以便您可以使用`-javaagent`JVM 标志指向它，如下所示：

```
-javaagent:full\path\of\spring-instrument-3.1.2.RELEASE.jar 
```

我在 Eclipse Juno 中工作，所以要设置它，我转到 Window -> Preferences -> Java -> Installed JREs。然后我点击列表框中选中的JRE，然后点击列表框右侧的“编辑...”按钮。结果弹出窗口中的第三个文本框标记为“默认 VM 参数：”。这是`-javaagent`应该输入或复制+粘贴标志的地方。

现在是我的实际测试代码类。首先，我的主要课程`TestMain.java`：

```
package my.package;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class TestMain {
  public static void main(String[] args) {
    ApplicationContext applicationContext = new ClassPathXmlApplicationContext("META-INF/spring/applicationContext.xml");
    TestClass testClass = applicationContext.getBean(TestClass.class);
    testClass.nonTransactionalMethod();
  }
} 
```

然后是我的事务类`TestClass.java`：

```
package my.package;

import my.package.TestDao;
import my.package.TestObject;
import org.springframework.transaction.annotation.Transactional;

public void TestClass {
  private TestDao testDao;

  public void setTestDao(TestDao testDao) {
    this.testDao = testDao;
  }

  public TestDao getTestDao() {
    return testDao;
  }

  public void nonTransactionalMethod() {
    transactionalMethod();
  }

  @Transactional
  private void transactionalMethod() {
    TestObject testObject = new TestObject();
    testObject.setId(1L);
    testDao.save(testObject);
  }
} 
```

这里的技巧是，如果它`TestClass`是其类中的一个字段，`TestMain`则将在加载`ClassLoader`应用程序上下文之前加载。由于编织是在类的加载时进行的，并且这种编织是由 Spring 通过应用程序上下文完成的，所以它不会被编织，因为在加载应用程序上下文并知道它之前，该类已经加载。

`TestObject`和的进一步细节`TestDao`并不重要。假设它们与 JPA 和 Hibernate 注释连接起来，并使用 Hibernate 进行持久性（因为它们是，而且它们确实如此），并且所有必需`<bean />`的 's 都在应用程序上下文文件中设置。

**编辑：在 AspectJ 模式下使用****编译时**编织的 Spring Transactions 的完整纲要：

将以下内容添加到`META-INF/spring/applicationContext.xml`：

```
<tx:annotation-driven mode="aspectj" /> 
```

（我假设您已经在应用程序上下文中设置了一个`AnnotationSessionFactoryBean`和是该属性的默认值。）`HibernateTransactionManager``transaction-manager="transactionManager"``<tx:annotation-driven />``id``transactionManager``transactionManager`

`spring-aspects-3.1.2.RELEASE.jar`将和添加`aspectjrt-1.7.0.jar`到您的`classpath`. 我使用 Maven 作为我的构建工具，所以这里是文件的`<dependency />`声明`POM.xml`：

```
<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-aspects</artifactId>
  <version>3.1.2.RELEASE</version>
</dependency>
<dependency>
  <groupId>org.aspectj</groupId>
  <artifactId>aspectjrt</artifactId>
  <version>1.7.0</version>
</dependency> 
```

在 Eclipse Juno 中：帮助 -> Eclipse Marketplace -> 标有“查找：”的文本框 -> 键入“ajdt” -> 点击 [Enter] -> “AspectJ 开发工具 (Juno)” -> 安装 -> 等等。

重新启动 Eclipse（它会让你）后，右键单击你的项目以调出上下文菜单。查看底部附近：配置 -> 转换为 AspectJ 项目。

在您的（再次使用 Maven！）中添加以下`<plugin />`声明：`POM.xml`

```
<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>aspectj-maven-plugin</artifactId>
  <version>1.4</version>
  <configuration>
    <aspectLibraries>
      <aspectLibrary>
        <groupId>org.springframework</groupId>
        <artifactId>spring-aspects</artifactId>
      </aspectLibrary>
    </aspectLibraries>
  </configuration>
  <executions>
    <execution>
      <goals>
        <goal>compile</goal>
        <goal>test-compile</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

替代方法：右键单击您的项目以调出上下文菜单。查看底部附近：AspectJ 工具 -> 配置 AspectJ 构建路径 -> 方面路径选项卡 -> 按“添加外部 JAR...” -> 找到`full/path/of/spring-aspects-3.1.2.RELEASE.jar`-> 按“打开” -> 按“确定”。

如果你走 Maven 路线，`<plugin />`上面的内容应该会吓坏了。要解决此问题：帮助 -> 安装新软件... -> 按“添加...” -> 在标有“名称：”的文本框中键入您喜欢的任何内容 -> 在标有“的文本框中键入或复制+`http://dist.springsource.org/release/AJDT/configurator/`粘贴位置：”-> 按“确定”-> 稍等-> 选中“Maven Integration for Eclipse AJDT Integration”旁边的父复选框-> 按“下一步>”-> 安装-> 等等。

安装插件并重新启动 Eclipse 后，`POM.xml`文件中的错误应该已经消失。如果没有，请右键单击您的项目以调出上下文菜单：Maven -> 更新项目 -> 按“确定”。

现在是我的实际测试代码类。这次只有一个，`TestClass.java`：

```
package my.package;

import my.package.TestDao;
import my.package.TestObject;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.transaction.annotation.Transactional;

public void TestClass {
  private TestDao testDao;

  public void setTestDao(TestDao testDao) {
    this.testDao = testDao;
  }

  public TestDao getTestDao() {
    return testDao;
  }

  public static void main(String[] args) {
    ApplicationContext applicationContext = new ClassPathXmlApplicationContext("META-INF/spring/applicationContext.xml");
    TestClass testClass = applicationContext.getBean(TestClass.class);
    testClass.nonTransactionalMethod();
  }

  public void nonTransactionalMethod() {
    transactionalMethod();
  }

  @Transactional
  private void transactionalMethod() {
    TestObject testObject = new TestObject();
    testObject.setId(1L);
    testDao.save(testObject);
  }
} 
```

这个没有技巧。由于编织发生在编译时，即在类加载和应用程序上下文加载之前，这两件事的顺序不再重要。这意味着所有东西都可以放在同一个类中。在 Eclipse 中，每次您点击 Save 时，您的代码都会不断地重新编译（有没有想过它在说“Building workspace: (XX%)”时它在做什么？），所以它已经被编织并随时可以使用。

就像在加载时间示例中一样： 和 的更多细节`TestObject`并不`TestDao`重要。假设它们与 JPA 和 Hibernate 注释连接起来，并使用 Hibernate 进行持久性（因为它们是，而且它们确实如此），并且所有必需`<bean />`的 's 都在应用程序上下文文件中设置。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T18:48:34.157

通过阅读您的问题，您并不清楚您卡在哪里，所以我将简要列出让 AspectJ 拦截您的`@Transactional`方法所需的内容。

1.  [`<tx:annotation-driven mode="aspectj"/>`](http://static.springsource.org/spring/docs/3.0.x/reference/transaction.html#transaction-declarative-annotations)在你的 Spring 配置文件中。
2.  [`<context:load-time-weaver/>`](http://static.springsource.org/spring/docs/3.0.x/reference/aop.html)以及在您的 Spring 配置文件中。
3.  直接位于类路径中 META-INF 文件夹中的 aop.xml。[这里](http://static.springsource.org/spring/docs/3.0.x/reference/aop.html)也解释了它的格式。它应该包含处理 `@Transactional`注释的方面定义：`<aspect name="org.springframework.transaction.aspectj.AnnotationTransactionAspect"/>`
4.  同一个文件中的 weaver 元素还应该有一个 include 子句，告诉它要编织哪些类：`<include within="foo.*"/>`
5.  `aspectjrt.jar`, `aspectjweaver.jar`,`spring-aspects.jar`和`spring-aop.jar`在类路径中
6.  使用标志启动应用程序`-javaagent:/path/to/spring-instrument.jar`（或 spring-agent，因为它在早期版本中被调用）

最后一步可能不是必需的。这是一个非常简单的类，可以使用`InstrumentationLoadTimeWeaver`，但如果不可用，Spring 将尝试使用另一个加载时间编织器。不过，我从未尝试过。

现在，如果你认为你已经完成了所有步骤但仍然有问题，我可以建议在 weaver 上启用一些选项（在 aop.xml 中定义）：

```
<weaver options="-XnoInline -Xreweavable -verbose -debug -showWeaveInfo"> 
```

这使得编织器输出一堆正在编织的信息。如果您看到正在编织的课程，您可以在`TestClass`那里寻找。然后，您至少有一个起点来继续进行故障排除。

* * *

关于您的第二次编辑，“在班级尝试执行之前，几乎就像编织的速度不够快，无法编织。”，答案是*肯定*的，这可能会发生。[我以前经历过这样的情况](https://stackoverflow.com/questions/3619519/aspectj-load-time-weaver-doesnt-detect-all-classes)。

我对细节有点生疏，但基本上是 Spring 无法编织在创建应用程序上下文之前加载的类。您是如何创建应用程序上下文的？如果您以编程方式执行此操作，并且该类具有对 的直接引用`TestClass`，则可能会出现此问题，因为`TestClass`加载得太早了。

不幸的是，我发现调试 AspectJ 简直就是地狱。

# javascript - 骨干模型应该是视图模型、域模型还是两者兼而有之？

> ID：11615733
> 
> 赞同：1
> 
> 时间：2012-07-23T15:34:10.363
> 
> 标签：javascript, backbone.js, models

对不起，如果问题含糊不清，但我真的很难找到这方面的信息。我来自 Flex/ActionScript 世界，在大多数情况下，我们有非常简单的值对象 (VO) 来表示诸如用户或地址之类的东西，并且我们有通常表示这些 VO 的集合以及业务逻辑的模型。有一些框架会包含一个视图模型，MVVM。我知道没有“正确的方法”来做这些事情，但我似乎无法指出基础知识。

所有 Backbone 视图都应该有自己的模型吗？鉴于我可能没有名为“用户”的视图，我是否还包括域模型？

文件夹看起来像这样吗？

*   应用程序
    *   楷模
        *   领域
            *   用户
            *   地址
        *   看法
            *   用户档案模型
    *   意见
        *   用户资料视图
    *   收藏品
        *   用户

再次抱歉，如果这没有意义或过于笼统。我只是想了解 JS 世界在 MVC 模式方面已经走了多远。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:17:51.980

我认为这里没有唯一的答案。每个案例都会有一个答案。

### 所有 Backbone 视图都应该有自己的模型吗？

不。

会有*View*引用*Model*，其他View 将引用*Collection*。还有一些视图会引用多个模型，而其他视图则根本不会引用非模型。

*视图是一个用户界面。它向用户显示数据并监听用户在此数据表示上触发的事件。*

例如，如果我有一个模型被调用`Friend`，并且我想创建一个接口来列出一堆这样的模型，我将拥有：

*   **FriendsView**：这是一个代表朋友集合的*视图。*
*   **FriendView**：这是 FriendsView 的*子视图*，仅代表一个朋友。它也可以监听这个好友`click`的*销毁*按钮。

但我也希望有一个表格可以从我的服务器中的朋友中搜索：

*   **FriendSearchView**：不引用任何模型或集合。但是正在听用户填写*输入*字段。

### 我还会包括域模型吗？

我不知道您对*域模型*是什么意思，但如果您询问将*业务逻辑*放在哪里， Backbone 对此非常不可知。我建议将尽可能多的计算放入模型或集合中。您也可以使用自己的*纯 JS* Util 库。

保持视图干净。仅响应用户事件并根据需要调用模型和集合方法。还监听从中显示数据的模型或集合中的更改。

### 文件夹应该是什么样子？

好吧，Backbone 再次对此不可知论。有很多关于这方面的文献。

我的项目过去很小，不到 30 个文件。我将它们全部放在同一个文件夹中，命名对流如下：

*   朋友
*   朋友们
*   朋友视图
*   弗里登斯视图

# couchdb - 如何修复 CouchDB 测试错误

> ID：11615739
> 
> 赞同：1
> 
> 时间：2012-07-23T15:34:37.420
> 
> 标签：couchdb

我在本地机器上安装了 CouchDB，但在运行测试套件后出现了一些错误。我附上了我的 CouchDB 测试套件错误的图像。

[![在此处输入图像描述](../Images/6e5b4d00762912818a53bf446755090e.png)](https://i.stack.imgur.com/yx6GU.png)
[单击图像以获取更大的版本。]

# macos - 如何让我的 ubuntu VM 自动调整屏幕分辨率以适合我的 macbook pro 或外接显示器？

> ID：11615743
> 
> 赞同：4
> 
> 时间：2012-07-23T15:34:57.967
> 
> 标签：macos, ubuntu, virtualbox, screen-resolution

我正在使用虚拟机的 mac osx 主机上运行 ubuntu 来宾。我正在尝试让屏幕分辨率自动调整到我的 macbook pro 以及外部（第二个）显示器。

在线可用的教程让我使用 CLI 添加分辨率，例如

```
xrandr --addmode 1440x900 
```

我已经尝试过：

```
xrandry --newmode "1440x900_60.00"  106.50  1440 1528 1672 1904  900 903 909 934 -hsync +vsync 
```

所以，当我输入“xrandr”时，这是输出：

```
Screen 0: minimum 64 x 64, current 1024 x 768, maximum 32000 x 32000
VBOX0 connected 1024x768+0+0 0mm x 0mm
1024x768       60.0*+
800x600        60.0  
640x480        60.0 
```

那么，如何让我的 ubuntu VM 自动调整屏幕分辨率以适应我的 macbook pro 或外接显示器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T18:33:52.497

关键是为我的 ubuntu VM 增加 VirtualBox 中的视频内存。请参阅此链接以获取答案。在 ubuntu 论坛上查看[这个问题。](https://askubuntu.com/questions/73589/higher-screen-resolution-for-virtualbox)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-23T10:37:16.937

一段时间以来，我一直在努力解决这个问题。我正在使用 Mac OS Catalina 10.15.3 并尝试在 Virtual Box 版本 6.0.14 上安装 Ubuntu 16.04。

我曾尝试添加“Guest Additions CD”映像、安装 virtualbox-guest-x11 等，但没有成功。最后对我有用的是这个

创建了一个新的虚拟机，然后在安装操作系统之前我更改了以下配置

虚拟框 > 设置 > 显示

将视频内存从默认的 16Mb 增加到 128Mb，将图形控制器增加到“VBoxSVGA”

然后安装了Ubuntu 16.04，默认分辨率是完美的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-18T16:29:25.253

对我有用的是安装 virtualbox-guest-x11。

主机：2014 年中 MacBookPro 15in

来宾：Ubuntu 12.04.5 LTS 桌面 AMD64

`sudo apt-get install virtualbox-guest-x11`

# c# - 从 javascript 调用 C# BHO 方法

> ID：11615753
> 
> 赞同：3
> 
> 时间：2012-07-23T15:35:29.577
> 
> 标签：c#, javascript, internet-explorer, com, bho

我需要从 javascript 调用 C# BHO 方法

我遵循了[这个问题中给出的解决方案](https://stackoverflow.com/questions/9287961/calling-c-sharp-bho-methods-from-javascript/11614528#11614528)

我得到错误：

```
'mshtml.HTMLWindow2Class' does not contain a definition for 'myExtension'. 
```

我不能分配：

```
dynamic window = browser.Document.parentWindow; 
```

由于 parentWindow 未定义，我必须转换为 (mshtml.IHTMLDocument2) 和 (mshtml.IHTMLWindow2)

有没有人有我可以参考的完整工作示例或任何帮助或替代解决方案

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T02:15:48.773

我有同样的问题。以下修复似乎适用于我的 BHO：

```
dynamic window = _webBrowser.Document.parentWindow;
var windowEx = (IExpando)window;
PropertyInfo p = windowEx.AddProperty("myExtension");
p.SetValue(windowEx, this); 
```

代替：

```
dynamic window = _webBrowser.Document.parentWindow;
var windowEx = (IExpando)window;
PropertyInfo p = windowEx.AddProperty("myExtension");
window.myExtension = this; 
```

# java - 模拟 org.apache.log4j.Level 类时出现 MissingMethodInvocationException

> ID：11615754
> 
> 赞同：2
> 
> 时间：2012-07-23T15:35:34.223
> 
> 标签：java, mockito

以下代码导致 org.mockito.exceptions.misusing.MissingMethodInvocationException：

```
Level level = mock(Level.class);
IOException ioException = new IOException("test");
when(level.getSyslogEquivalent()).thenThrow(ioException); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T16:25:01.160

你检查`MissingMethodInvocationException`异常消息了吗？

它说 ：

```
when() requires an argument which has to be 'a method call on a mock'.
For example:
    when(mock.getArticles()).thenReturn(articles);

Also, this error might show up because:
1\. you stub either of: final/private/equals()/hashCode() methods.
   Those methods *cannot* be stubbed/verified.
2\. inside when() you don't call method on mock but on some other object.
3\. the parent of the mocked class is not public.
   It is a limitation of the mock engine. 
```

该类`Level`是最终的（显然不是我记得扩展该类）或者`getSyslogEquivalent`是最终的（最好的猜测）。

因此，您应该修改您的设计或测试设计，或者尝试使用提供最终类/方法模拟的 Powermock。

希望有帮助

# sql - SQL：显示全名+按主题过滤

> ID：11615755
> 
> 赞同：1
> 
> 时间：2012-07-23T15:35:36.180
> 
> 标签：sql, sql-server-2008, inner-join, not-exists

以下是我的表中的以下记录：

**注册学生**

```
EnrollID     StudentID  SubjID
1            1          1
2            1          2
3            1          3
4            2          1
5            3          2 
```

**学生们**

```
StudentID     UserID     YearID     FirstName     LastName
1             1          1          John          Doe
2             3          1          Peter         Pan
3             7          1          Isaac         Newton 
```

**科目**

```
SubjID     SubjCode     YearID
1          English      1
2          Math         1
3          Science      1 
```

输出应该是......

```
StudentID     FullName
2             Peter Pan
3             Isaac Newton 
```

我能够想出以下 SQL 语句（感谢[Ic。](https://stackoverflow.com/users/44853/lc)）

```
SELECT s.StudentID, s.FirstName + ' ' s.LastName AS FullName 
FROM Students AS s
LEFT OUTER JOIN EnrollStudents AS es ON s.StudentID = es.StudentID
GROUP BY s.StudentID, s.FirstName, s.LastName 
HAVING COUNT(DISTINCT(es.SubjID)) < (SELECT COUNT(*) FROM Subjects) 
```

有没有办法可以按主题过滤查询？假设我选择英语，只有 Isaac Newton 可以注册该科目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:39:58.847

您可以使用更简单的查询来查找未注册某个学科的学生，例如：

```
select StudentID,
    FirstName + ' ' + LastName as FullName
from Students
where StudentID not in (
    select es.StudentID
    from EnrollStudents es
    inner join Subjects s on es.SubjID = s.SubjID
    where s.SubjCode = 'English'
) 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/af0ad/11)

你也可以把它写成左连接，像这样：

```
select s.StudentID,
    s.FirstName + ' ' + s.LastName as FullName
from Students s
left outer join (
    select distinct es.StudentID
    from EnrollStudents es
    inner join Subjects s on es.SubjID = s.SubjID
    where s.SubjCode = 'English'
) ss on s.StudentID = ss.StudentID
where ss.StudentID is null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:46:50.140

我认为您的查询是不必要的复杂。例如，您不需要左外连接。此外，您可以省去 have 子句中的子查询：

```
SELECT s.StudentID, s.FirstName + ' ' s.LastName AS FullName
FROM Students AS s JOIN
     EnrollStudents AS es
    ON s.StudentID = es.StudentID
GROUP BY s.StudentID, s.FirstName, s.LastName
HAVING COUNT(DISTINCT(es.SubjID)) < COUNT(es.SubjID) 
```

只获得英语：

```
SELECT s.StudentID, s.FirstName + ' ' s.LastName AS FullName
FROM EnrollStudents AS es join
     Students AS s
     ON s.StudentID = es.StudentID join
     Subjects su
     on es.subjid = su.subjid
where su.subjcode in ('English')
GROUP BY s.StudentID, s.FirstName, s.LastName
HAVING COUNT(DISTINCT(es.SubjID)) < COUNT(es.SubjID) 
```

当仅限于单个主题时，我认为“拥有”从句是无关紧要的。您能描述一下您希望查询做什么吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T16:02:48.103

这在 MySQL 中对我有用。必须以不同的方式连接，但就像一个魅力

```
SELECT Students.StudentID, CONCAT(Students.FirstName, ' ', Students.LastName) AS FullName
FROM Students, Enrollstudents, Subjects
WHERE Subjects.SubjID = 2 <--- HERE IS THE BIT YOU CHANGE TO FILTER
AND   EnrollStudents.SubjID = Subjects.SubjID
AND   Students.StudentID = Enrollstudents.StudentID 
```

并使用您使用的 concat 方法：

```
SELECT Students.StudentID, Students.FirstName + ' ' Students.LastName AS FullName
FROM Students, Enrollstudents, Subjects
WHERE Subjects.SubjID = 2
AND   EnrollStudents.SubjID = Subjects.SubjID
AND   Students.StudentID = Enrollstudents.StudentID 
```

**注意：**您可以根据需要对 WHERE 子句执行任何操作。为了让所有没有注册某个主题的人，您将第四行更改为：

```
AND   EnrollStudents.SubjID <> Subjects.SubjID 
```

或者

```
AND NOT  EnrollStudents.SubjID = Subjects.SubjID 
```

（我认为）

# android - 在Android中将自定义ImageButton添加到布局会导致错误

> ID：11615757
> 
> 赞同：0
> 
> 时间：2012-07-23T15:35:42.023
> 
> 标签：android, custom-component

我首先要说的是，虽然我接受过一些 Java 培训，但这是我第一次涉足 Android 开发。

我所做的是创建了一个`ImageButton`名为的自定义`MapCell`，它基本上`ImageButton`包含一些额外的信息，并且编译得很好。

当我想`MapCell`在相关程序中创建一个`Activity`并将其添加到我`TableLayout`在 xml 中定义并具有 id 'mapTable' 的我的问题时，我的问题就出现了。相关位如下所示：

```
Random randy = new Random();

MapCell n = new MapCell(randy.nextInt(4), this); //the random number is part of my extra info

findViewById(R.id.mapTable).addView((View)n, 20, 20); //add cell to display 
```

我得到一个错误： `The method addView(View, int, int) is undefined for the type View`

这对我来说听起来完全是胡说八道。在我独自坐着`View`遇到同样的错误并且没有任何改变（显然我的已经是 a因为它扩展了）之后，我把那个演员放在那里作为绝望。`n``MapCell``View``ImageButton`

我希望一双新的眼睛能告诉我这是怎么回事，因为我已经检查过类似的问题，但我没有发现任何类似的问题。如果您需要查看更多代码，请立即告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:45:44.127

你遇到了这个问题，因为方法`findViewById(R.id.mapTable)`返回`View`对象。在 android 中，您不能将一个视图添加到另一个视图。

您可以将`addView`函数与`ViewGroup`, 和所有`LinearLayout`（等）对象一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:43:24.720

该方法`findViewById`返回 a`View`并且`View`该类没有该方法`addView`（此方法在 the`ViewGroup`及其子类中实现）。相反，你应该写：

```
((TableLayout)findViewById(R.id.mapTable)).addView(n, 20, 20); 
```

我已将方法的返回值转换为`findViewById`实际具有该`addView`方法的类。

# mysql - mysql查询仅列出数据库中的大写行

> ID：11615766
> 
> 赞同：1
> 
> 时间：2012-07-23T15:36:07.243
> 
> 标签：mysql

我有一张表，其中包含 10 列，其中一列是 username 。列 username 存储学生的姓名，可以是大写和小写。我想分隔大写和小写的学生。如果用户名由任何大写字母组成，它将列出该行。我有兴趣查询用户名列。在其他列中也有大写字母，但我只想根据用户名列列出。我已经尝试了几个查询，但没有一个在工作。请指教

我想在列用户名中列出带有任何大写字母的行。我试过这些代码

```
SELECT * FROM accounts WHERE LOWER(username) LIKE '%q' 
```

没用

```
SELECT * FROM accounts WHERE UPPER(username) = UPPER('%q') 
```

没用

```
SELECT * FROM accounts where username COLLATE latin1_swedish_ci = '%q' 
```

没用

```
SELECT * FROM accounts WHERE username REGEXP '[A-Z]'; 
```

没用

```
SELECT * FROM accounts WHERE username REGEXP '^[[:upper:]+]$' 
```

没用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:44:04.427

```
SELECT *          
FROM accounts          
WHERE CAST(username AS BINARY) RLIKE '[A-Z]'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:49:03.843

```
CREATE TABLE accounts (
   id int,
   username varchar(50)
) CHARACTER SET latin1 COLLATE latin1_general_ci;

SELECT* FROM accounts WHERE username REGEXP '^[A-Z]+$'; 
```

确保您使用**COLLATE latin1_general_ci**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:46:53.643

您正在使用排序规则，但您需要有**一个经过排序的表**，而不仅仅是查询。您可以做的是创建一个新表，然后将当前行插入到新的整理表中，然后尝试 REGEX 或其他方法。

[选择仅包含大写字母的所有字段](https://stackoverflow.com/questions/3836825/select-all-fields-that-contains-only-uppercase-letters)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-23T08:12:19.707

以下查询将正常工作

select * from TABLE where CAST(COL_NAME AS BINARY) = upper(COL_NAME);

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-23T15:43:28.483

首先，您需要确保要搜索的字段具有特定于大小写的排序规则，例如 latin1_general_cs（如果您使用的是拉丁字符集）。然后您可以只搜索大写或小写，无论您要查找的是哪个（即 WHERE username LIKE '%q%' 或 WHERE username LIKE '%Q%'

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-23T15:44:11.843

Mysql 对字符串不区分大小写，因此它会比单个 selectect 语句更复杂。如果您想经常进行这种比较，请将用户名列的类型转换为下面列出的二进制类型之一：

[http://dev.mysql.com/doc/refman/5.0/en/case-sensitive.html](http://dev.mysql.com/doc/refman/5.0/en/case-sensitivity.html)

如果您不想经常这样做，请考虑将当前表的结果保存到临时表，使用区分大小写的字符串类型更改该表，然后使用您的正则表达式。

# multithreading - 如何将 PPL 线程数设置为 1？

> ID：11615770
> 
> 赞同：1
> 
> 时间：2012-07-23T15:36:17.110
> 
> 标签：multithreading, visual-studio-2010, concurrency, parallel-processing, ppl

我有一个数字运算功能，所以我使用 PPL 将其并行化。但是由于某种原因，另一个开发人员要求此函数串行运行。我需要提供一个参数，以便他可以在串行模式下调用我的函数...我不想复制代码，所以我需要一种方法来限制 PPL 线程的数量..虽然我很难过

```
Concurrency::SchedulerPolicy sp( 1, Concurrency::MaxConcurrency, 1 );
CurrentScheduler::Create(sp); 
```

PPL 创建两个线程并并行运行我的代码...关于如何序列化 ppl 增强代码的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T16:21:38.770

对于这个问题最好不要设置调度器策略，而使用一些手动的任务组初始化控制，例如：

```
using namespace Concurrency;

std::vector< task_handle< std::function< void() > > > aTask;
aTask.push_back( make_task([](){ /*taks 1*/}) );
aTask.push_back( make_task([](){ /*taks 2*/}) );
aTask.push_back( make_task([](){ /*taks 3*/}) );

task_group tGroup;

bool bSerialMode = true; /* or false */
if (!bSerialMode)
{
    std::for_each(aTask.begin(), aTask.end(), [&](task_handle< std::function< void() > >& handle){
       tGroup.run( handle );
    });
}
else
{
    tGroup.run( [&](){
      std::for_each(aTask.begin(), aTask.end(), [&](task_handle< std::function< void() > >& handle){
       tGroup.run_and_wait( handle ); });
    });
} 
```

如果您决定限制一个虚拟处理器的所有任务，那么也要设置 MinConcurrency。

```
CurrentScheduler::Create( SchedulerPolicy( 2, Concurrency::MinConcurrency, 1, Concurrency::MaxConcurrency, 1 ) ); 
```

# vb.net - 将数据表拆分为 n 个数据表

> ID：11615771
> 
> 赞同：0
> 
> 时间：2012-07-23T15:36:22.047
> 
> 标签：vb.net, datatable

我需要将一个数据表动态拆分为多个数据表，后续数据表的数量会有所不同。最终用户将输入一个值，这将确定从原始数据表派生的数据表的数量。例如：用户输入10，原来的dt有20行。将有 10 个 dt，每个创建 2 行。但是，如果原始 dt 有 11 行，则将有 9 个 dt 有 1 行和 1 个 dt 有 2 行创建。我如何在 vb.net 中完成此操作而无需硬编码一堆 if 规则？我已经通读并尝试了下面的帖子，但它仍然没有让我到达那里。

[使用 LINQ 将集合拆分为“n”部分？](https://stackoverflow.com/questions/438188/split-a-collection-into-n-parts-with-linq)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T16:03:18.983

您可以使用 LINQ `GroupBy`：

```
Dim tbl1 = New DataTable
tbl1.Columns.Add("ID", GetType(Int32))
tbl1.Columns.Add("Text", GetType(String))
For rowIndex As Int32 = 1 To 11
    tbl1.Rows.Add(rowIndex, "Row " & rowIndex)
Next

Dim tableCount = 10  ' what the user entered '
Dim divisor = tbl1.Rows.Count / tableCount ' needed to identify each group '
Dim tables = tbl1.AsEnumerable().
            Select(Function(r, i) New With {.Row = r, .Index = i}).
            GroupBy(Function(x) Math.Floor(x.Index / divisor)).
            Select(Function(g) g.Select(Function(x) x.Row).CopyToDataTable()) 
```

# c# - 写在渲染 HTML 顶部的 Javascript 警报

> ID：11615772
> 
> 赞同：2
> 
> 时间：2012-07-23T15:36:22.437
> 
> 标签：c#, javascript, asp.net

我正在尝试为早于 IE8 的 IE 浏览器显示警报。我在后面的代码中使用了 javascript 警报。但是，此警报会写入呈现的 HTML 的顶部，因此在回发时 DOCTYPE 声明不再是 HTML 的第一行，这会导致 IE8 切换到 Quirks 模式。我怎样才能解决这个问题？

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:41:40.170

不要使用 Response.Write 来提醒用户；而是使用这样的东西：

```
function alertOldBrowser()
{
    alert('Your browser is IE <8 ');
} 
```

在后面的代码中，这样调用这个函数：

```
if(browserIsOld)
{
   Page.ClientScript.RegisterStartupScript(this.GetType(), "alert", "alertOldBrowser();", true);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:39:02.250

您可能希望在后面的代码中调用 RegisterStartupScript：

[http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx](http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx)

# c# - 使用 OpenXML 和 XElement 将多个 word 文档合并为一个

> ID：11615774
> 
> 赞同：6
> 
> 时间：2012-07-23T15:36:37.123
> 
> 标签：c#, xml, linq, ms-word, openxml

正如标题所述，我正在尝试将多个单词（.docx）文件合并到一个单词文档中。这些文档中的每一个都是一页长。我在这个实现中使用了[这篇文章中的一些代码。](https://stackoverflow.com/questions/247666/how-can-i-programatically-use-c-sharp-to-append-multiple-docx-files-together)我遇到的问题是只有第一个文档被正确写入，每隔一个迭代都会附加一个新文档，但文档内容与第一个文档内容相同。

这是我正在使用的代码：

```
//list that holds the file paths
List<String> fileNames = new List<string>();
fileNames.Add("filePath");
fileNames.Add("filePath");
fileNames.Add("filePath");
fileNames.Add("filePath");
fileNames.Add("filePath");

//get the first document
MemoryStream mainStream = new MemoryStream();
byte[] buffer = File.ReadAllBytes(fileNames[0]);
mainStream.Write(buffer, 0, buffer.Length);

using (WordprocessingDocument mainDocument = WordprocessingDocument.Open(mainStream, true))
{
    //xml for the new document
    XElement newBody = XElement.Parse(mainDocument.MainDocumentPart.Document.Body.OuterXml);
    //iterate through eacah file
    for (int i = 1; i < fileNames.Count; i++)
    {
        //read in the document
        byte[] tempBuffer = File.ReadAllBytes(fileNames[i]);
        WordprocessingDocument tempDocument = WordprocessingDocument.Open(new MemoryStream(tempBuffer), true);
        //new documents XML
        XElement tempBody = XElement.Parse(tempDocument.MainDocumentPart.Document.Body.OuterXml);
        //add the new xml
        newBody.Add(tempBody);
        string str = newBody.ToString();
        //write to the main document and save
        mainDocument.MainDocumentPart.Document.Body = new Body(newBody.ToString());
        mainDocument.MainDocumentPart.Document.Save();
        mainDocument.Package.Flush();
        tempBuffer = null;
    }
    //write entire stream to new file
    FileStream fileStream = new FileStream("xmltest.docx", FileMode.Create);
    mainStream.WriteTo(fileStream);
    //ret = mainStream.ToArray();
    mainStream.Close();
    mainStream.Dispose();
} 
```

同样的问题是，正在创建的每个新文档都与第一个文档具有相同的内容。所以当我运行它时，输出将是一个包含五个相同页面的文档。我尝试在列表中切换文档顺序并获得相同的结果，因此它不是特定于一个文档的。谁能建议我在这里做错了什么？我正在查看它，但我无法解释我所看到的行为。任何建议，将不胜感激。非常感谢！

**编辑：**我认为这可能与我尝试合并的文档是使用自定义 XML 部件生成的事实有关。我认为文档中的 Xpath 以某种方式指向相同的内容。问题是我可以打开这些文档中的每一个并查看正确的内容，只是当我合并它们时我才看到问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-05T17:36:42.867

此解决方案使用**[DocumentFormat.OpenXml](http://msdn.microsoft.com/en-us/library/documentformat.openxml%28v=office.14%29.aspx)**

```
public static void Join(params string[] filepaths)
    {

     //filepaths = new[] { "D:\\one.docx", "D:\\two.docx", "D:\\three.docx", "D:\\four.docx", "D:\\five.docx" };
        if (filepaths != null && filepaths.Length > 1)

            using (WordprocessingDocument myDoc = WordprocessingDocument.Open(@filepaths[0], true))
            {
                MainDocumentPart mainPart = myDoc.MainDocumentPart;

                for (int i = 1; i < filepaths.Length; i++)
                {
                    string altChunkId = "AltChunkId" + i;
                    AlternativeFormatImportPart chunk = mainPart.AddAlternativeFormatImportPart(
                        AlternativeFormatImportPartType.WordprocessingML, altChunkId);
                    using (FileStream fileStream = File.Open(@filepaths[i], FileMode.Open))
                    {
                        chunk.FeedData(fileStream);
                    }
                    DocumentFormat.OpenXml.Wordprocessing.AltChunk altChunk = new DocumentFormat.OpenXml.Wordprocessing.AltChunk();
                    altChunk.Id = altChunkId;
                    //new page, if you like it...
                        mainPart.Document.Body.AppendChild(new Paragraph(new Run(new Break() { Type = BreakValues.Page })));
                    //next document
                    mainPart.Document.Body.InsertAfter(altChunk, mainPart.Document.Body.Elements<Paragraph>().Last());
                }
                mainPart.Document.Save();
                myDoc.Close();
            }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T22:39:12.723

您似乎合并的方式有时可能无法正常工作。您可以尝试其中一种方法

1.  [在http://blogs.msdn.com/b/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx](http://blogs.msdn.com/b/ericwhite/archive/2008/10/27/how-to-use-altchunk-for-document-assembly.aspx)中使用 AltChunk

2.  使用[http://powertools.codeplex.com/](http://powertools.codeplex.com/) DocumentBuilder.BuildDocument 方法

    如果您仍然面临类似的问题，您可以在合并之前找到数据绑定控件，并从 CustomXml 部分将数据分配给这些控件。您可以在 OpenXmlHelper 类的方法 AssignContentFromCustomXmlPartForDataboundControl 中找到这种方法。代码可以从[http://worddocgenerator.codeplex.com/下载](http://worddocgenerator.codeplex.com/)

# java - 从 Java 中的 XPath 查询中检索裸 html

> ID：11615777
> 
> 赞同：0
> 
> 时间：2012-07-23T15:36:47.837
> 
> 标签：java, xpath, html-parsing

我的问题是我需要从旨在获取 html 文本部分的 XPath 表达式中检索原始 html。例如，如果我得到当前的 html：

```
<div class='text'>
    <p class='nointerrest'> blabla </p>
    <p class='goodstuff'> blablabla </p>
    <p class='goodstuff'> blablabla </p>
</div> 
```

然后我的 XPath 表达式是字符串：

```
 string-join(//p[@class='goodstuff'],' ') 
```

这给了我：

```
 "blablabla blablabla" 
```

是否有可以返回我的 XPath 表达式：

```
<p class='goodstuff'> blablabla </p>
<p class='goodstuff'> blablabla </p> 
```

作为一个字符串？（如果可能，使用与我原来的 XPath 表达式最相似的 XPath 表达式）

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T18:48:59.723

您需要的不仅仅是 XPath 来获得所需的输出。XPath 是一种文档查询语言，而不是 XML 格式化语言，因此您应该分步考虑这一点。

1.  首先，使用 XPath 在文档中查询`NodeList`：

    ```
    NodeList list = (NodeList) xpath.evaluate(
        "//p[@class='goodstuff']", document, XPathConstants.NODESET); 
    ```

2.  然后创建一个`Transformer`：

    ```
    javax.xml.transform.TransformerFactory tfactory = 
        TransformerFactory.newInstance();
    javax.xml.transform.Transformer xform = tfactory.newTransformer(); 
    ```

3.  并用它来输出每个节点：

    ```
    for (int i = 0; i < list.getLength(); i++) {
        Node node = list.item(i);
        javax.xml.transform.Source src = new DOMSource(node);
        java.io.StringWriter writer = new StringWriter();
        javax.xml.transform.Result result = new   
        javax.xml.transform.stream.StreamResult(writer);
        xform.setOutputProperty(
        javax.xml.transform.OutputKeys.OMIT_XML_DECLARATION, "yes");
        xform.transform(src, result);
        System.out.println(writer.toString());
    } 
    ```

# apache - 使用 .htaccess 密码保护 cname 子域？

> ID：11615778
> 
> 赞同：1
> 
> 时间：2012-07-23T15:36:49.183
> 
> 标签：apache, .htaccess, password-protection, cname, setenv

我正在尝试构建和测试“m”。我正在开发的网站的子域。"m.domain.com" 只是 "domain.com" 的一个 cname，将用于设置服务器端布尔值，因此该网站的移动版本将提供完全相同的页面，只是使用不同的 css 和脚本。

在我进行测试时，我想为对 m.domain.com 发出的所有请求提供密码。我已经在环境变量解决方案上尝试了几个 .htaccess 变体，这就是我现在所拥有的：

```
SetEnvIfNoCase Host m\.domain\.com is_mobile

AuthType basic
AuthName "Mobile site"
AuthUserFile ".htpasswd"
Require valid-user

Order allow,deny
Allow from all
Deny from env=is_mobile
Satisfy any 
```

使用此代码，“domain.com”和“www.domain.com”正常显示。“m.domain.com”按预期提示输入密码。但是，一旦输入，服务器对任何请求都会返回 500 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:06:07.503

好吧，事实证明，一点点倒置和重新排序就可以了。

```
SetEnvIfNoCase Host ^(www\.)domain\.com$ not_mobile

AuthType basic
AuthName "Mobile site"
AuthUserFile ".htpasswd"

Order deny,allow
Deny from all
Allow from env=not_mobile
Require valid-user
Satisfy any 
```

不过，我仍然很想知道为什么其他配置会产生 500 错误，特别是因为它只发生在我想要密码保护的子域中。

# java - Java棘手的继承和调用类和方法

> ID：11615781
> 
> 赞同：1
> 
> 时间：2012-07-23T15:36:53.363
> 
> 标签：java, class, abstraction

我的java有点生疏了，我必须为这个问题实现一个解决方案。

在 A.java 中给出，其中：

```
public class A implements Cloneable{
  protected DataStorage Y = new DataStorage();

  public A(DataStorage X, about 20 other inputs of different Object types){
   this.Y=X;
  }

  public static DataStorage getData(){
   return this.Y;
  }
} 
```

我的目标在另一个文件 ServletA.java 中，我想在其中检索对象 Y 或 X。通过从 A.java 类进行静态调用......它是否有效或有更好的方法？

```
public class ServletA{
  DataStorage Z = A.getData();
} 
```

注意：是的，这不会编译，但有解决方案吗？

我对解决方案的限制：

*   对 A.java 进行最小的更改，因为它是遗留代码库
*   A() 构造函数有许多 20 多个输入，这是一场噩梦
*   我的架构师也不想通过将 A 更改为抽象类来触及它
*   无法在 ServletA.java 中创建 A 的实例

EDIT1：**我的问题是是否有解决方案可以从 ServletA.java 访问 X 而无需在 ServletA.java 中创建 A 的实例。**上面的代码是一个例子，表明我已经想到了一个方法，但它不起作用。

编辑2：如果您想投反对票，请出于礼貌要求我进行澄清。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:44:25.057

如果您只有一个 A 实例，则应使用[单例](http://en.wikipedia.org/wiki/Singleton_pattern)模式。您的 ServletA 代码应该类似于

```
public class ServletA {
  DataStorage Z = A.getInstance().getData();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:57:10.807

您可以使用反射访问任何私有（或受保护）类字段和方法。想法是切换安全性，获取字段或方法，获取引用/调用方法，然后打开安全性。看起来像一个黑客，但它的工作原理。

前段时间，我写了一个类“ClassRipper”（显然是重新发明了一个weel）。带有“ClassRipper”的谷歌搜索给出了它的参考：

[http://www.koders.com/java/fid7E7F02066CC24469AC29D8A3EB9F74D655E53588.aspx](http://www.koders.com/java/fid7E7F02066CC24469AC29D8A3EB9F74D655E53588.aspx)

一个方便的工具来完成您的任务。随意使用或扩展它。

StackOverflow 上有 2 个类似的主题：

[Java中是否可以通过反射访问私有字段](https://stackoverflow.com/questions/1555658/is-it-possible-in-java-to-access-private-fields-via-reflection)

[如何读取 Java 中的私有字段？](https://stackoverflow.com/questions/1196192/how-do-i-read-a-private-field-in-java)

根据“EDIT1 更新：我的问题是是否有解决方案可以从 ServletA.java 访问 X 而无需在 ServletA.java 中创建 A 的实例。上面的代码是一个示例，表明我已经想到了一种方法，但是它不行。”

您不能在不创建 A 实例的情况下访问 X - X 不存在（因为它不是静态的）。但是，如果您的 ServletA 扩展了 A - 那么您可以使用“this”作为实例。ClassRipper 处理继承。在这种情况下，您间接拥有 A 的实例；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:40:19.710

我很确定这段代码不会编译。您不能对`this`静态函数进行引用。

您可以将 in 的实例传递给`A`构造函数并从中`ServletA`删除。`static``A.getData`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-23T15:41:46.603

静态方法没有`this`可用的指针，因此给出的代码不会编译。是否有理由需要`getData()`保持静态？

# ruby-on-rails - Rails 生成器与手动创建文件

> ID：11615791
> 
> 赞同：1
> 
> 时间：2012-07-23T15:37:36.227
> 
> 标签：ruby-on-rails

我注意到有很多`rails generate`我不使用的由生成器（不仅是脚手架，而且一般来说）创建的文件。

所以我想出了以下问题（关于最佳实践）：

1.  您使用生成器还是最好只手动创建您需要的文件？
2.  如果你使用生成器，你会保留所有生成的文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:53:21.000

我确实使用了生成器，只是删除了文件。这可能是因为我很懒，但我发现这更容易。

尤其是模型，因为它包括迁移。

老实说，这一切都归结为偏好。只是不要脚手架...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:40:34.957

您可以专门使用生成器来帮助您构建单个文件。例如，您可以使用

```
rails g model Video title:string link:string 
```

以这些作为属性创建模型文件，但您不需要使用脚手架来生成所有内容（如果这就是您所指的）

我个人喜欢使用组合——这真的取决于项目。但我会告诉你不要有你不使用的额外文件，所以一定要删除那些你不使用（或不打算使用）的文件。

希望这可以帮助。

# salesforce - 触发错误消息中的超链接？

> ID：11615794
> 
> 赞同：0
> 
> 时间：2012-07-23T15:37:54.250
> 
> 标签：salesforce

我正在尝试在触发错误消息中包含帐户的超链接。但我收到错误“错误：编译错误：第 30 行第 115 列的字符 '\' 第 30:115 行没有可行的替代方案”。请告诉我这里有什么问题：

```
account.addError('This account already exists.The duplicate account is:'<a herf=\'https://ap1.salesforce.com/'+ accName +'\'>Agency Name '+ accName + '</a>' ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:15:14.847

在锚标记之前有一个额外的撇号，并且缺少右括号。试一试：

```
account.addError('This account already exists. The duplicate account is: <a href=\'/'+ accName +'\'>Agency Name '+ accName + '</a>'); 
```

另外 - 要完成这项工作，您可能需要传入 Salesforce **ID**作为超链接的一部分，而不是帐户名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:55:41.497

您有语法错误

```
account.addError('This account already exists.The duplicate account is:'<a href=\'https://ap1.salesforce.com/'+ accName +'\'>Agency Name '+ accName + '</a>' ; 
```

应该

```
String link = '<a href="https://ap1.salesforce.com/'+ accName +'">Agency Name '+ accName + '</a>';
account.addError('This account already exists.The duplicate account is:'+link) ; 
```

# web-scraping - 使用正确的 Web Scraper

> ID：11615796
> 
> 赞同：0
> 
> 时间：2012-07-23T15:37:55.233
> 
> 标签：web-scraping, webharvest

我需要制作一个使用来自客户端的输入地址的网络爬虫，然后从特定站点的该地址检索数据。我下载了Webharvest，从学习如何编写程序开始是正确的吗？

另外，如果可能的话，有人可以指导我学习一个很好的教程来学习如何去做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T16:01:14.017

这是一个很好的[网络爬虫比较表](http://extract-web-data.com/software-for-web-scraping/)。它可以帮助您选择合适的刮刀。

# asp.net-mvc - 在 MVC 中为对象参数使用输出缓存

> ID：11615799
> 
> 赞同：3
> 
> 时间：2012-07-23T15:38:05.417
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, outputcache

这是我的控制器方法。谁能解释我如何在服务器上为以下方法编写输出缓存。

```
 public JsonResult GetCenterByStateCityName(string name, string state, string city, bool sportOnly, bool rvpOnly)
    {
        var result = GetCenterServiceClient().GetCentersByLocation(name, city, state, sportOnly, rvpOnly).OrderBy(c => c.Name).ToList();
        return Json(result);
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:40:50.637

你看过文档吗？

[http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.outputcacheattribute.aspx)

简而言之，只需在您的操作上设置属性

```
[OutputCache(CacheProfile = "SaveContactProfile", Duration = 10)]
public JsonResult SaveContact(Contact contact)
{
    var result = GetContactServiceClient().SaveContact(contact);
    return Json(result);
} 
```

**- 更新 -**

如果您通过 jQuery 进行直接 Ajax 调用，则 OutPutCache 可以根据“cache”参数被忽略 - 默认情况下设置为 true。

例如，如果您正在执行以下操作，您的参数将被忽略：

```
$.ajax({
    url: someUrlVar,
    cache: true, /* this is true by default */
    success : function(data) {

    }
}); 
```

只是需要查看一下，因为您可以通过两种方式缓存该调用。

参考：

*   [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)
*   [http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/improving-performance-with-output-caching-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/improving-performance-with-output-caching-cs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T15:51:31.917

```
[OutputCache(Duration = 3600, VaryByParam = "name;state;city;sportOnly;rvpOnly")]
public JsonResult GetCenterByStateCityName(string name, string state, string city, bool sportOnly, bool rvpOnly)
{
        var result = GetCenterServiceClient().GetCentersByLocation(name, city, state, sportOnly, rvpOnly).OrderBy(c => c.Name).ToList();
        return Json(result);
} 
```

这里的`Duration`值为 3600 秒。所以缓存的有效期为 1 小时。您需要提供`VaryByParam`属性值，因为您希望为不同的参数提供不同的结果。

# windows-8 - VariableSizedWrapGrid 和 WrapGrid 儿童尺寸测量

> ID：11615802
> 
> 赞同：12
> 
> 时间：2012-07-23T15:38:32.990
> 
> 标签：windows-8, microsoft-metro, windows-runtime

两者`VariableSizedWrapGrid`都有`WrapGrid`奇怪的测量 - 他们根据第一项测量所有孩子。

因此，以下 XAML 将剪辑第三项。

```
 <VariableSizedWrapGrid Orientation="Horizontal">
        <Rectangle Width="50" Height="100" Margin="5" Fill="Blue" />
        <Rectangle Width="50" Height="50" Margin="5" Fill="Red" />
        <Rectangle Width="50" Height="150" Margin="5" Fill="Green" />
        <Rectangle Width="50" Height="50" Margin="5" Fill="Red" />
        <Rectangle Width="50" Height="100" Margin="5" Fill="Red" />
    </VariableSizedWrapGrid> 
```

似乎`VariableSizedWrapGrid`测量第一个项目，然后用第一个项目的所需大小测量其余的孩子。

任何解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:44:10.113

您需要在每个 Rectangle VariableSizeWrapGrid.ColumnSpan 和 VariableSizeWrapGrid.RowSpan 上使用附加属性，并将 ItemHeight 和 ItemWidth 添加到 VariableSizeWrapGrid：

```
<VariableSizedWrapGrid Orientation="Horizontal" ItemHeight="50" ItemWidth="50"> 
    <Rectangle 
        VariableSizedWrapGrid.ColumnSpan="1" 
        VariableSizedWrapGrid.RowSpan="2"
        Width="50" Height="100" Margin="5" Fill="Blue" /> 
</VariableSizedWrapGrid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T19:09:18.490

要使用 VariableSizeWrapGrid，您应该创建自己的 GridView 自定义控件，`PrepareContainerForItemOverride`并在该方法内覆盖和设置元素 RowSpan 和 ColumnSpan。这样每个元素都有自己的高度/宽度。

这是杰里尼克松的一个很好的教程/演练：http: [//dotnet.dzone.com/articles/windows-8-beauty-tip-using](http://dotnet.dzone.com/articles/windows-8-beauty-tip-using)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:08:23.383

今天设法解决了这个问题。您需要使用 WinRT XAML 工具包 ( [http://winrtxamltoolkit.codeplex.com](http://winrtxamltoolkit.codeplex.com) ) 中的 VisualTreeHelperExtension.cs。对我来说，我试图调整一个以 GridView 作为其 ItemsPanelTemplate 的 ListView，同样的概念应该适用于你。

1) 附加到 ListView 的 LayoutUpdated 事件（这是您想要更新尺寸的时候）

> `_myList.LayoutUpdated += _myList_LayoutUpdated;`

2) 使用 VisualTreeHelperExtensions.GetDescendantsOfType() 在您的项目的数据模板中查找常见（且唯一）元素类型（例如：宽度动态的 TextBlock）：

> ```
> var items = VisualTreeHelperExtensions.GetDescendantsOfType<TextBlock>(_myList);  
> 
> if (items == null || items.Count() == 0)
>   return; 
> ```

3）获取找到的项目的最大宽度：

> `double maxWidth = items.Max(i => i.ActualWidth) + 8;`

4) 使用 VisualTreeHelperExtensions.GetDescendantsOfType() 为您的 ListView 找到主 WrapGrid 容器：

> ```
> var wg = _categoryList.GetDescendantsOfType<WrapGrid>();
> if (wg == null || wg.Count() != 1)
>   throw new InvalidOperationException("Couldn't find main ListView container"); 
> ```

5) 将 WrapGrid 的 ItemWidth 设置为您计算的 maxWidth：

> `wg.First().ItemWidth = maxWidth;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T16:16:11.547

它可能不是最好的方法，但这就是我在@MetroRSSReader 应用程序中所做的

```
<common:VariableGridView.ItemsPanel>
                <ItemsPanelTemplate>
                    <VariableSizedWrapGrid ItemWidth="225" 
                                           ItemHeight="{Binding ElementName=bounds, Path=Text}" 
                                           MaximumRowsOrColumns="5" Orientation="Vertical"
                                           />
                </ItemsPanelTemplate>
                </common:VariableGridView.ItemsPanel>
        </common:VariableGridView> 
```

注意 ItemHeight 值绑定到 TextBlock

```
<TextBlock x:Name="bounds" Grid.Row="1" Margin="316,8,0,33" Visibility="Collapsed"/> 
```

在 LayoutAwarePage.cs 中设置

```
public string Fix_item_height_for_current_screen_resolution()
    {
        var screenheight = CoreWindow.GetForCurrentThread().Bounds.Height;
        var itemHeight = screenheight < 1000 ? "100" : "140";

        return itemHeight;
    } 
```

您可以浏览完整的源代码[http://metrorssreader.codeplex.com/SourceControl/changeset/view/18233#265970](http://metrorssreader.codeplex.com/SourceControl/changeset/view/18233#265970)

# c# - Visual Studio SDK 中的 VirtualSnapshotSpan 中的虚拟空间是什么

> ID：11615806
> 
> 赞同：5
> 
> 时间：2012-07-23T15:38:59.423
> 
> 标签：c#, .net, wpf, visual-studio-2010, mef

在 Visual Studio 2010 SDK 中有 SnapshotSpans 和 VirtualSnapshotSpans。根据MSDN，不同的是Virtual Span有Virtual Spaces，其他的没有。

究竟什么是虚拟空间？

供参考：http: [//msdn.microsoft.com/en-us/library/microsoft.visualstudio.text.virtualsnapshotspan.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.text.virtualsnapshotspan.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T11:11:09.660

你可以在这里找到解释：

[http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.text.virtualsnapshotpoint%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.text.virtualsnapshotpoint%28v=vs.100%29.aspx)

> 虚拟空格是行尾的“额外”空格，不会增加行的长度。您可以在 Visual Studio 中启用或禁用虚拟空间。当虚拟空间被禁用时，在行尾按下右箭头键会导致插入符号移动到下一行的开头。启用虚拟空格后，在行尾按右箭头键会导致插入符号在同一行上向前移动。

即使工具 -> 选项 -> 文本编辑器 -> 所有语言 -> 常规下的“启用虚拟空间”选项被禁用，在编写缩进文本或代码时也可以插入虚拟空间。

如果在缩进行的末尾键入 enter，Visual Studio 会在新行的开头添加虚拟空格。这些空格是“虚拟的”，因为它们不是由用户输入的，并且不会保存在文件中，除非您在虚拟空格之后输入一些内容。

这会影响插入符号的位置：在缩进行的末尾按 enter 后，“BufferPosition”和“VirtualBufferPosition”的 CaretPosition 属性将不同。BufferPosition 指向新行中的第 0 列，而 VirtualBufferPosition 指向插入符号在视觉上呈现的位置。

# c++ - 了解 Valgrind 输出

> ID：11615808
> 
> 赞同：1
> 
> 时间：2012-07-23T15:39:11.247
> 
> 标签：c++, valgrind

我编写了以下代码来对 Valgrind 有一个基本的了解，并且很难解释它的输出。这可能与 Valgrind 无关，而是更基本的 C++。

```
#include <string>
#include <iostream>
using namespace std;

class Valgrind_testclass
{
std::string * stringInHeap;

public:
  Valgrind_testclass() { 
    stringInHeap = new std::string("String in heap");   
  }
  ~Valgrind_testclass() {
    //delete stringInHeap;                  
  }

  void PrintFunc(void) {
    cout << "Nothing but a printout" << endl;
  }
};

int main()
{
 Valgrind_testclass * valObjPtr = new Valgrind_testclass();  
 delete valObjPtr;               
 return 0;
} 
```

Valgrind 输出：

```
==4459== HEAP SUMMARY:
==4459==     in use at exit: 31 bytes in 2 blocks
==4459==   total heap usage: 3 allocs, 1 frees, 35 bytes allocated
==4459== 
==4459== Searching for pointers to 2 not-freed blocks
==4459== Checked 102,100 bytes
==4459== 
==4459== 31 (4 direct, 27 indirect) bytes in 1 blocks are definitely lost in loss record 2 of 2
==4459==    at 0x402641D: operator new(unsigned int) (vg_replace_malloc.c:255)
==4459==    by 0x80487DB: Valgrind_testclass::Valgrind_testclass() (in /home/madu/C++/ValgrindTest)
==4459==    by 0x80486F6: main (in /home/madu/C++/ValgrindTest)
==4459== 
==4459== LEAK SUMMARY:
==4459==    definitely lost: 4 bytes in 1 blocks
==4459==    indirectly lost: 27 bytes in 1 blocks
==4459==      possibly lost: 0 bytes in 0 blocks
==4459==    still reachable: 0 bytes in 0 blocks
==4459==         suppressed: 0 bytes in 0 blocks
==4459== 
==4459== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 17 from 6) 
```

有人可以告诉我我在哪里进行 3 次分配吗？我只能看到两个分配。还有为什么它说“间接丢失”？

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-23T15:42:15.450

当你构造一个`std::string`对象时，它会分配另一个指针（对象内部的）来指向字符串值。这是第三次分配的来源，也是间接泄漏的内存。

换句话说，你有这三个分配：

1.  `new Valgrind_testclass()`（显式）
2.  `new std::string("String in heap")`（显式）
3.  字符串内部分配（隐式/间接）

由于您泄漏了分配 2，因此您也间接泄漏了分配 3；字符串的析构函数不会被调用，因此它没有机会释放分配 3。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-23T15:42:41.977

您有 3 个分配，因为`std::string`还分配了内存。

间接丢失，意味着您丢失了指向具有指向其他内存的指针的指针。在这种情况下，您没有 delete `stringInHeap`，并且您丢失了它的指针。这样，实际`std::string`分配内存的人无法删除它，因此该内存也丢失了。

# java - 自我更新图表 - 如何开始？

> ID：11615809
> 
> 赞同：0
> 
> 时间：2012-07-23T15:39:11.510
> 
> 标签：java, graphics, graph

我想用java绘制图表。它应该从文件中读取数据，并更新一个图表 - 让我们说随着时间的推移的价值。读取时，应根据值（高或低）进行自我更新和自我缩放。

我怎样才能最好地开始？哪个 API 或工具最适合 java？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:49:16.393

哪个 API 或工具最好是主观的。我使用并推荐的一种 API 是[LiveGraph](http://www.live-graph.org/)。它非常灵活，涵盖了您提到的所需功能。

# ios - UILocalNotification 2 分钟后重复警报

> ID：11615819
> 
> 赞同：1
> 
> 时间：2012-07-23T15:40:03.860
> 
> 标签：ios, uilocalnotification, repeat, localnotification

我只是想但确定我理解正确。看起来只有在第一个通知后 2 分钟重复一次 UILocalNotification 的唯一方法是安排 2 个单独的本地通知。是对的吗？我看过类似的帖子：

[如何创建每两分钟通知一次的 UILocalNotification](https://stackoverflow.com/q/6895101/454404)

[https://stackoverflow.com/a/4923276/454404](https://stackoverflow.com/a/4923276/454404)

[https://stackoverflow.com/a/4022779/454404](https://stackoverflow.com/a/4022779/454404)

他们似乎都建议“计划2通知”路线。Apple 文档明确表示您使用日历单位进行重复。所以我想你可以设置一个在一定秒数后重复，但你必须取消它。似乎必须有更好的方法。

谢谢

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-09T19:09:42.423

还没有找到更好的方法。

# android - 哈希键 Facebook API。Android 发布模式不调试。苹果系统

> ID：11615825
> 
> 赞同：0
> 
> 时间：2012-07-23T15:40:31.643
> 
> 标签：android, facebook, hash, key, keytool

嗯..首先，对不起我的英语.. api facebook 在模拟器中完美运行但是当我把它放在手机上时它不起作用.. 只需打开和关闭窗口.. 所以.. 我找到了这 2 个命令生成哈希密钥，但我不知道女巫是正确的还是我做错了什么，因为我写了任何密码并且命令有效，但在移动设备上却不行..

这是调试模式..密码是默认的“android”

```
keytool -exportcert -alias androiddebugkey  -keystore /Users/user/.android/debug.keystore | openssl sha1 -binary | openssl enc -a -e 
```

这是用于发布模式的..密码是您的签名密钥的密码..

```
keytool -exportcert -alias androiddebugkey  -keystore /Users/user/Desktop/testsing | openssl sha1 -binary | openssl enc -a -e 
```

我做错了什么？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T14:34:07.690

您可以尝试这种方式来确保 100%

1.  在命令提示符下使用 Java\bin 转到您的文件夹，例如：C:\Program Files\Java\jdk1.7.0_09\bin>

2.  准备你的命令

来自 facebook 开发者教程：

> keytool -exportcert -alias androiddebugkey -keystore %HOMEPATH%.android\debug.keystore | openssl sha1 -二进制 | openssl base64

如果您对 openssl 有任何问题，您可以下载它并在 C:\OpenSSL 上安装示例，然后

> keytool -exportcert -alias androiddebugkey -keystore %HOMEPATH%.android\debug.keystore | "C:\OpenSSL\bin\openssl" sha1 -binary | "C:\OpenSSL\bin\openssl" base64

# javascript - 使用可拖动的 jQuery UI 时给元素一个临时固定宽度？

> ID：11615826
> 
> 赞同：3
> 
> 时间：2012-07-23T15:40:32.867
> 
> 标签：javascript, jquery, css, jquery-ui, jquery-ui-draggable

我有一些具有相对宽度的元素。但是，当我使用 jquery UI 的方法拖动其中一个元素时`draggable()`，它会根据我想要拖动它的位置而变化。我尝试了以下代码，尝试使用启动和停止回调：

**HTML：**

```
<ul id='item-list'>  
  <li>Item 1</li>
  <li>Item 2</li>
  <li>Item 3</li>
</ul> 
```

**CSS**

```
#item-list {
  width: 40%;
}

#item-list li {
  width:  100%;
} 
```

**JavaScript**

```
$("#item-list li").draggable({
  revert : true,
  helper : 'clone',
  start : function() {
    $(this).css('width',$(this).width());
  },
  stop : function() {
    $(this).css('width','100%');
  }
}); 
```

但是，这似乎只在我第二次拖动对象时才起作用。有什么方法可以让它正常工作吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-23T16:11:41.483

是这样吗？[http://jsfiddle.net/CGQkB/](http://jsfiddle.net/CGQkB/)

诀窍是解决的`ui.helper`不仅仅是`$(this)`因为它只是指向原始`<li>`标签。

# .net - 在参数中传递委托

> ID：11615828
> 
> 赞同：0
> 
> 时间：2012-07-23T15:40:36.133
> 
> 标签：.net, vb.net, .net-4.0

我有

```
Function Bar(s As String) ... 
```

我需要创建一个函数

```
Me.Foo(myInt, AddressOf Bar) 
```

我应该如何写 Foo 的签名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:53:26.063

使用通用 Func(Of Type) 关键字可能是最简单的。

```
Public Function Foo(i As Integer, f As Func(Of String, Integer)) As String
    Dim i2 = f.Invoke("test")
    Return "42"
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:43:55.533

[这可能会帮助你](https://stackoverflow.com/questions/117623/delegates-as-parameters-in-vb-net)

声明您的代表签名：

```
Public Delegate Sub Format(ByVal value As String) 
```

定义您的测试功能：

```
Public Sub CheckDifference(ByVal A As Integer, _
                           ByVal B As Integer, _
                           ByVal format As Format)
    If (B - A) > 5 Then
        format.Invoke(String.Format( _
        "Difference ({0}) is outside of acceptable range.", (B - A)))
    End If
End Sub 
```

在您的代码中的某处调用您的 Test 函数：

```
CheckDifference(Foo, Bar, AddressOf log.WriteWarn) 
```

或者

```
CheckDifference(Foo, Bar, AddressOf log.WriteError) 
```

# android - 从不同的包启动服务

> ID：11615831
> 
> 赞同：3
> 
> 时间：2012-07-23T15:40:40.520
> 
> 标签：android, service, launch

我试图制作一个项目，我有一项活动和一项来自不同软件包的服务。我放在一个项目中的两个包。

我将活动放入：com.idris.activity，并将服务放入：com.idris.activity.service

我尝试从 MyActivity 中的按钮侦听器调用 MyService ，如下所示：

```
Intent myIntent = new Intent(getApplicationContext(), MyService.class);
                 myIntent.putExtra("extraData", "somedata");
                 startService(myIntent); 
```

应用程序清单

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="idris.parental.monitor"
    android:versionCode="1"
    android:versionName="1.0" >
<uses-sdk android:minSdkVersion="10" />
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".MyActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service
            android:name=".MyService"
            android:enabled="true" />
    </application>
</manifest> 
```

MyService 无法启动，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:46:54.047

在您的清单中使用它：

```
<service
    android:name=".service.MyService"
    android:enabled="true" /> 
```

确保您在文件中使用正确`package name`的 for 。如果文件在包中，则使用：`service``manifest``MyService.java``com.idris.activity.service`

```
<service android:name="com.idris.activity.service.MyService" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:40:32.230

您的根 pkg 名称似乎是 **package="idris.parental.monitor"**所以您的服务类 pkg 名称必须包含这些作为根路径，然后在清单中您可以指定为

例如

您在服务包中的服务。即 idris.parental.monitor.service

在清单 .service.urservicename

# java - Glassfish - 上传图片 - 做对了

> ID：11615832
> 
> 赞同：4
> 
> 时间：2012-07-23T15:40:47.953
> 
> 标签：java, servlets, glassfish-3, multipartform-data, servlet-3.0

我在最新的 glassfish (3.1.2) - 所以不需要 apache FileItem 并且 getPart() 没有错误。我读到上传图像的最佳做法是将它们保存在文件系统中（例如，请参见[此处](https://stackoverflow.com/questions/348363/what-is-the-best-practice-for-storing-uploaded-images)）。我正在编辑已经存在的代码——那很臭——所以我有了这样做的想法：

```
Part p1 = request.getPart("file");
System.out.println("!!!!!P1 : " + p1); 
```

印刷 ：

```
!!!!!P1 : File name=DSC03660.JPG, 
StoreLocation=C:\_\glassfish3\glassfish\domains\domain1\generated\jsp\elkethe\upload_7cb06306_138b413999a__7ffa_00000000.tmp, 
size=2589152bytes, isFormField=false, FieldName=file 
```

我的换行符。在人们正在做的代码中：

```
if (request.getParameter("crop") != null) {
    // get path on the server
    String outputpath = this.getServletContext().getRealPath(
            "images/temp/" + session.getId() + ".jpg");
    // store photo
    InputStream is = p1.getInputStream();
    createPhoto(is, outputpath);
    session.setAttribute("photo_path", "images/temp/" + session.getId()
            + ".jpg");
    response.sendRedirect("cropping");
    return;
} 
```

在哪里

```
private void createPhoto(InputStream is, String outputpath) {
    FileOutputStream os = null;
    try {
        os = new FileOutputStream(outputpath);
        // write bytes taken from uploaded file to target file
        int ch = is.read();
        while (ch != -1) {
            os.write(ch);
            ch = is.read();
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    } finally {
        Helpers.close(os);
    }
} 
```

现在发生的情况是，文件在提交表单时上传到 StoreLocation (???)，所以显然这一切都是徒劳的 `p1.getInputStream()`。

我的问题是：

*   什么是 StoreLocation ？那些 glassfish 上传的 tmp 是多少？所有这些参数在哪里设置？我确实阅读了 BalusC 的[教程——但没有提到 StoreLocation（谷歌也不](https://stackoverflow.com/a/2424824/281545)[是](https://www.google.com/search?ie=UTF-8&oe=UTF-8&sourceid=navclient&gfns=1&q=StoreLocation%20glassfish)很有帮助）。
*   处理这种情况的更专业的方法是什么 - 包括将照片保留在 webroot 之外 - 但使用 glassfish 提供的设施（如果它提供的话）？
*   即使 p1 打印得这么好也让我无法理解（它似乎[没有](http://docs.oracle.com/javaee/6/api/javax/servlet/http/Part.html)Override `toString()`）

甚至对如何重命名照片等提示感兴趣（这个 sessionID 是正确的吗？ - 还要检查时间技巧）：

```
if (request.getParameter("save") != null) {
    long time = System.currentTimeMillis();
    String path = "images/upload/" + session.getId() + time + ".jpg";
    String outputpath = this.getServletContext().getRealPath(path);
    // store photo
    InputStream is = p1.getInputStream();
    createPhoto(is, outputpath);
    // etc
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T23:47:50.087

好的做法是在文件系统上选择上传照片的路径。通常，此路径被编程为可通过 java 系统属性进行配置（例如：通过`-Dcom.mycompany.uploadPath=/path/to/photos/dir`在 JVM 参数上传递系统属性）。

您还可以使用 java 系统属性来查找特定于环境的路径：`user.dir`等`user.home`。请参阅[Java SE 教程中的系统属性](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)。或者要使用 glassfish 相对路径，请参阅[glassfish 系统属性](http://docs.oracle.com/cd/E19776-01/820-4507/abhey/index.html)。

一旦你参考了[Part](http://docs.oracle.com/javaee/6/api/javax/servlet/http/Part.html)，它只是做文件 IO 将上传的文件复制到这个上传路径中，例如：

```
Part part = // obtain part somehow..
String photoFileName = // build a file name somehow..
InputStream photoInputStream = part.getInputStream();
FileOutputStream photoOutputStream = new FileOutputStream(System.getProperty("com.mycompany.uploadPath") + File.separator + photoFileName);
IOUtils.copy(photoInputStream, photoOutputStream);
// close streams here... 
```

上面的代码为了方便起见使用了[apache IOUtils](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html)，但您可以随意编写自己的复制方法。您还应该添加异常处理方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-02T16:02:59.783

> 什么是 StoreLocation ？那些 glassfish 上传的 tmp 是多少？所有这些参数在哪里设置？

[StoreLocation](https://github.com/ancoron/glassfish-main/blob/4013c456bd27c339c8d48784571d17289901da3a/appserver/web/web-core/src/main/java/org/apache/catalina/fileupload/PartItem.java#L605)只是`FileItem`' 数据在磁盘上的临时位置的 java.io.File 对象。驻留在`javax.servlet.context.tempdir`默认为`%GLASSFISH_HOME%\domains\domain1\generated\jsp\webApp`. 这些上传与任何东西一样 tmp （*文件的生命周期与`FileItem`实例的生命周期相关；当实例被垃圾收集时，文件将被删除*- 从[这里开始](https://github.com/ancoron/glassfish-main/blob/4013c456bd27c339c8d48784571d17289901da3a/appserver/web/web-core/src/main/java/org/apache/catalina/fileupload/PartItem.java#L639)）。尚未设法以`javax.servlet.context.tempdir`编程方式更改值（请发表评论） - 它是sun-web.xml的[sun-web-app 元素](http://docs.oracle.com/cd/E19798-01/821-1750/beayb/index.html)`tempdir`的属性。

> 处理这种情况的更专业的方法是什么 - 包括将照片保留在 webroot 之外 - 但使用 glassfish 提供的设施（如果它提供的话）？

那么更专业的方法是使用`Part.write()`将文件*移动*到所需位置。由于 glassfish 的实现，尽管您无法提供绝对的写入路径 - 一件苦差事。我[在这里](https://stackoverflow.com/questions/19738244/glassfish-part-write-no-absolute-paths-workaround)问。

至于保存文件的位置：[https ://stackoverflow.com/a/18664715/281545](https://stackoverflow.com/a/18664715/281545)

这是为了保存文件 - 要从应用程序外部的位置提供文件，您需要在 sun-web.xml（或 glassfish-web.xml）中定义“alternatedocroot”属性。

> 甚至 p1 打印这么好也让我无法理解（它似乎没有覆盖 toString()）

哦[，是的](https://github.com/ancoron/glassfish-main/blob/4013c456bd27c339c8d48784571d17289901da3a/appserver/web/web-core/src/main/java/org/apache/catalina/fileupload/PartItem.java#L694)

> 甚至对如何重命名照片等提示感兴趣（这个 sessionID 是正确的吗？ - 还要检查时间技巧）

不，不是-我倾向于-无论如何，这是[在这里](https://stackoverflow.com/questions/19741780/servlets-choose-a-filename-for-uploaded-files)`File#createTempFile()`提出的另一个问题

# ruby-on-rails - 使用 bootstrap-sass 使用不同的 Bootstrap 表单类

> ID：11615834
> 
> 赞同：0
> 
> 时间：2012-07-23T15:40:57.277
> 
> 标签：ruby-on-rails, twitter-bootstrap

如何使用 bootstrap-sass -gem 为表单选择不同的 Bootstrap 表单类？现在我正在为用户注册和登录创建表单，并且喜欢使用 .form-inline 类而不是默认的 .form-horizo​​ntal。

视图中的代码如下所示：

```
<%= form_for(@user, :html => {:class '.form-inline'}) do |f| %>
<div><%= f.label :email %><br />
<%= f.email_field :email %></div>

<div><%= f.label :password %><br />
<%= f.password_field :password %></div>

<% if devise_mapping.rememberable? -%>
<div><%= f.check_box :remember_me %> <%= f.label :remember_me %></div>
<% end -%>

<div><%= f.submit "Sign in" %></div>
<% end %> 
```

这似乎生成了具有正确 .form-inline 类的 html，因为生成的 html 如下所示，但表单仍被格式化为 .form-horizo​​ntal。

```
<form accept-charset="UTF-8" action="/users" class="form-inline" id="new_user" method="post"> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T23:17:26.850

Twitter bootstrap 需要特定的 html 表单结构，请仔细查看[http://twitter.github.com/bootstrap/base-css.html#forms](http://twitter.github.com/bootstrap/base-css.html#forms)上的示例。我建议您不要手动构建表单，而是使用 simple_form gem，它可以为 twitter 引导构建具有适当标记的表单：[https](https://github.com/plataformatec/simple_form) ://github.com/plataformatec/simple_form 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-08T22:43:36.970

也许您正在小型设备或窗口中查看它？bootstrap 说：“这只适用于视口中至少 768px 宽的表单。”

# javascript - 如何在没有 JQuery 的情况下使 Gmail 或 Facebook 像滚动条？

> ID：11615837
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:40:59.340
> 
> 标签：javascript, scroll

我们在互联网上看到了许多使用 Jquery 制作 Gmail/Facebook 等滚动条的示例或源代码。但我正在寻找一些轻量级的 javascript 来使滚动条像 Gmail 中一样薄。请有人分享更多信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T15:53:28.170

在**webkit**中，您可以在**Css**中执行此操作。
这将比任何 javascript 代码更轻。

了解有关 Css 自定义滚动条的更多信息：
[http://css-tricks.com/custom-scrollbars-in-webkit/](http://css-tricks.com/custom-scrollbars-in-webkit/)

在其他浏览器中，我建议您使用原生滚动条。
大多数时候，javascript 中的自定义滚动条并不是一个很好的附加组件。

# java - 在 Java 中计算 HTTP 请求的时间度量

> ID：11615841
> 
> 赞同：2
> 
> 时间：2012-07-23T15:41:08.880
> 
> 标签：java, apache-httpclient-4.x, apache-httpcomponents

是否有任何开源组件可以发出 HTTP 请求并计算不同的指标，如连接时间（Socket Connect）、首字节下载时间、总下载时间等？我正在查看 Apache HTTP 客户端，但它看起来没有提供这些指标的 API。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T09:14:42.010

看看[指标](http://metrics.codahale.com/)。它支持 Apache HttpClient 等等。

# actionscript-3 - 应用程序域问题。将共享库中的本地 .swfs 动态加载到单独的项目中。失败的演员表

> ID：11615843
> 
> 赞同：0
> 
> 时间：2012-07-23T15:41:18.263
> 
> 标签：actionscript-3, flash, apache-flex, adobe, flash-builder

我有两个项目，`A`并且`B`，引用一个库，`MyExternalLibrary`. `A`并且`B`是`.swf`s（两个不同的 AS3 项目）并且`MyExternalLibrary`是`.swc`. 当我的应用程序运行时，`A`加载`B`.

有一个`Class`, `MyLoader`,广泛`MyExternalLibrary`使用`B`。 `MyExternalLibrary.MyLoader`加载`.swf`我们服务器上存在的 s（我们不嵌入它们，因为它们是根据用户请求动态加载的）。

请注意，我们的服务器包含`A`,`B`以及`.swf`我们要下载的所有 s。

现在，还必须在我们的服务器上`A`加载一些s。`.swf`因此，`A`也必须使用`MyLoader`in `MyExternalLibrary`。因此，在`A`中，我添加了对 的引用`MyLoader`，以便在编译期间包含其二进制文件。我只添加了一个引用`MyLoader`——我实际上并没有实例化或修改它。也就是说，在`A`'s 代码中的某处（`B`加载之前），我有：

`MyLoader;`

我（显然）也导入了`Class`。这确保了`MyLoader`'s 二进制文件将包含在`A`'s`.swf`中。

只是`MyExternalLibary.MyLoader`在`A`break`B`的功能中引用`MyLoader`-- 所有加载的`.swf`s`B`都不会`cast`与其关联`Class`，尽管它是 a`MovieClip`并且具有所有正确的字段。此外，在调试器中，加载`MovieClip`的 s 表明它们是正确的`Class`. 例如，如果我加载 a `.swf`，它将是 a `MovieClip`; 此外，调试器声明它是 type `B.mySwfs.MyClass`，但我不能。我相信罪魁祸首是。`cast``B.mySwfs.MyClass``ApplicationDomain`

请注意，注释掉那行代码会使所有内容都`B` `cast`正确。

如果有人对正在发生的事情有任何想法，我希望得到一些建议。我认为这个问题处理`ApplicationDomain`自`A` *拥有* `MyExternalLibrary.MyLoader`，并且我正在尝试将`cast`a`MovieClip`加载`A`到 a`Class`中`B`。当我注释掉对 in 的所有引用`MyExternalLibrary.MyLoader`时`A`，`B`现在*拥有* `MyExternalLibrary.MyLoader`，因此它能够转换为 in 中的类`B`。这是我的预感！

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:08:07.650

解决方案是确保`B`'s与's`ApplicationDomain`相同。这是通过参数化in或的实例来完成的。`A``ApplicationDomain``LoaderContext``Loader.load``Loader.loadBytes`

例如，使用以下代码行`A`加载：`B`

`m_loader.load(new URLRequest("B.swf"), new LoaderContext(false, ApplicationDomain.currentDomain));`

这会将所有`B`的`Class`定义添加到`A`. 因此，当`A`加载 a`.swf`并将其`MovieClip`编`cast`入 a `Class`in 时`B`，一切都会正常工作，因为`A`和`B`在同一个`ApplicationDomain`. 因此，可以将`Object`加载的 by编辑为 in 中的 a 。`A``cast``Class``B`

如果其他人遇到这个问题，我强烈建议看看 GreenSock 的 SWFLoader：[http ://www.greensock.com/as/docs/tween/com/greensock/loading/SWFLoader.html](http://www.greensock.com/as/docs/tween/com/greensock/loading/SWFLoader.html)

# entity-framework-4 - 代码优先方法中的部分定义实体类是否有效？

> ID：11615846
> 
> 赞同：1
> 
> 时间：2012-07-23T15:41:28.757
> 
> 标签：entity-framework-4, entity-framework-4.1, ef-code-first

我在 Entity Framework 4.0 中使用代码优先的方法。我已经定义了一个名为“Product”的实体类，它只包含这些属性 - *ProductId、ProductName 和 ProductDescription*。

但是，数据库中名为“Products”的表具有其他列，例如 *ProductAge、ProductWeight、ProductVolume 和 IsActive*。**使用实体框架代码优先方法进行更新/插入是否仍适用于部分定义的实体类？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:09:48.283

如果未映射的列不可为空，那么微不足道的问题将是插入到表中。否则插入将正常工作。假设您不打算从代码优先模型重新创建数据库，它应该可以工作。

# iphone - 将一个按钮（作为子视图）添加到多个 UIView

> ID：11615847
> 
> 赞同：3
> 
> 时间：2012-07-23T15:41:35.013
> 
> 标签：iphone, uikit

我有一个 UIButton，我想将它添加到多个 UIViews。稍后 - 我想从其中一个超级视图中删除它。我正在尝试以下方式，但是当我将 removeFromSuperview 消息传递给按钮时，它会从两个视图中删除：

```
[viewOverlay addSubview:myButton];
[viewButtons addSubview:myButton]; 
```

之后我希望它只从 viewOverlay 中删除。

```
[myButton removeFromSuperview]; 
```

这会导致按钮从两个视图中删除。知道我怎么能做到这一点？？？

奥贝德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:09:11.627

> 当我将 removeFromSuperview 消息传递给按钮时，它会从两个视图中删除

它可能看起来那样，但`myButton`在`viewOverlay`您将其添加到`viewButtons`. 从文档中`-addSubview:`：

> 视图只能有一个超级视图。如果视图已经有一个超级视图并且该视图不是接收者，则此方法会在使接收者成为其新的超级视图之前删除先前的超级视图。

这里唯一正确的解决方案是创建两个按钮并为每个 和 添加`viewOverlay`一个`viewButtons`。这两个按钮可以看起来相同，具有相同的目标并执行相同的操作，因此从用户的角度来看，它们看起来就像“相同”的按钮。但是一个视图一次只能有一个超级视图。我的意思是字面上的意思：每个视图都有一个`superview`指向包含它的视图的指针，而那个点显然一次只能指向一个对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:46:01.897

您不能同时将一个视图添加到多个视图。在这种情况下，第一个添加的视图将被删除并添加第二个。要实现这一点，您需要再创建一个实例或现有副本。

从[这里](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)——

> 一个父视图可以包含任意数量的子视图，但每个子视图只有一个父视图，它负责适当地定位其子视图。

# jquery - 使用 jQuery 对表进行排序但将多组行保持在一起？

> ID：11615852
> 
> 赞同：1
> 
> 时间：2012-07-23T15:42:04.870
> 
> 标签：jquery, codeigniter, tablesorter

我有一个加载数据表的 CodeIgniter 项目，第一列中有一个帐户名称，然后在它加载该帐户子品牌的第一列中缩进。然后第 2 到第 8 列是我想要排序的其他数据点。在这张表中，对子品牌进行排序是没有用的，所以我不允许这样做。

我刚刚安装了 TableSorter 插件，但它对 Accounts/Brands 列中的每一行进行排序，但我只需要它对帐户名称进行排序并将帐户+品牌的分组保持在一起，而不是将它们分开。

所以如果我有布局：

```
Account
   Brand A DataPt1 DataPt2...
   Brand D DataPt1 DataPt2...
   Brand 4 DataPt1 DataPt2...
Account
   Brand Alpha DataPt1 DataPt2...
   Brand IV DataPt1 DataPt2...
Account
   Brand # DataPt1 DataPt2... 
```

我怎样才能对帐户进行排序并让品牌随之移动？如果需要分离帐户+品牌等，我可以调整列布局

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T17:03:10.407

我认为除了 codeigniter 解决方案之外，您还需要一个可以根据需要显示数据的客户端解决方案。

您可以使用 [JQGrid](http://www.trirand.com/blog/jqgrid/jqgrid.html)（参见 Grouping 部分）并测试它是否满足您的需求。在服务端，只需要通过[json_encode来抓取和展示模型数据](http://php.net/manual/es/function.json-encode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T22:03:17.167

我最终使用了这个[TableSorter mod](http://blog.pengoworks.com/index.cfm/2008/3/28/Finished-jQuery-Tablesorter-mod-for-Collapsible-Table-Rows)，它增加了对可折叠行的支持。它工作得很好，我想稍微改变一下，而不是 +/- 按钮来展开和折叠行，你可以点击行上的任意位置。

# .net - .Net 4.0 HttpClient 用法？

> ID：11615853
> 
> 赞同：10
> 
> 时间：2012-07-23T15:42:06.407
> 
> 标签：.net, api, dotnet-httpclient

我在 .Net 4.0 中并尝试使用 HttpClient。我读了一些文章说它在 4.0 中不再支持但您仍然可以使用它？我已经包含了`System.Net.Http;`程序集，但它不允许我向`HttpClient`. 知道如何解决这个问题吗？

我在错误发生的地方加粗了。

```
using (HttpClient http = new **HttpClient("{0}/v1/dm/labels/{1}.xml", MI_API_URL**))
        {
            http.**TransportSettings**.Credentials = new NetworkCredential(apiusername, apipassword);

            List<KeyValuePair<string, string>> parms = new List<KeyValuePair<string, string>>();
            parms.Add(new KeyValuePair<string, string>("Status", "Wiped"));

            HttpResponseMessage response = http.**Get**(new Uri("devices.xml", UriKind.Relative), parms);
            response.EnsureStatusIsSuccessful();
            responseoutput = response.Content.ReadAsString();
            xdoc.LoadXml(responseoutput); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-23T15:48:16.940

根据 MSDN HttpClient 仅在 .NET Framework 4.5 中受支持。尽管如此，还是有一个 .NET 4.0 的 HttpClient 实现。你可以在这里下载：

[.NET 4.0 的 HttpClient](http://nuget.org/packages/HttpClient)

[MSDN：HttpClient](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient%28v=vs.110%29.aspx)

在实现上仍然存在一些差异。例如，在 .NET 4.0 版本中，没有带 2 个参数的构造函数。更多信息请查看源代码：

[.NET 4.0 源代码的 HttpClient](http://wcf.codeplex.com/SourceControl/changeset/view/417c9a96fc24#WCFWebApi/Http/Src/Microsoft.Net.Http/HttpClient.cs)

关于你的例子：

*   impl 中没有带 2 个参数的构造函数。.NET 4.0
*   impl 中没有带 2 个参数的 Get 方法。.NET 4.0
*   impl 中没有 TransportSettings 属性。.NET 4.0

# jasper-reports - Jasperreport NoSuchMethodError JasperDesign.setOrientation

> ID：11615858
> 
> 赞同：0
> 
> 时间：2012-07-23T15:42:21.917
> 
> 标签：jasper-reports, dynamic-reports

在使用 DynamicReport 和 Jasperreports 的项目中，使用以下代码：

```
JasperReportBuilder jasperReportBuilderSubreport = generateSubReport(...);
...
JasperReport jasperReport = jasperReportBuilderSubreport.toJasperReport(); //Exception line 
```

执行引发异常：

```
java.lang.NoSuchMethodError:
    net.sf.jasperreports.engine.design.JasperDesign.setOrientation(Lnet/sf/jasperreports/engine/type/OrientationEnum;)V
at net.sf.dynamicreports.jasper.transformation.ReportTransform.page(ReportTransform.java:220)
    ... 
```

pom.xml：

```
...
  <dependency>
<groupId>net.sf.jasperreports</groupId>
<artifactId>jasperreports</artifactId>
<version>4.5.1</version>
</dependency>

..
  <dependency>
<groupId>net.sourceforge.dynamicreports</groupId>
<artifactId>dynamicreports-core</artifactId>
<version>2.5.1</version>
  </dependency> 
```

...

你知道是哪个问题吗？谢谢

# android - 将 Android 设备连接到 Eclipse

> ID：11615860
> 
> 赞同：0
> 
> 时间：2012-07-23T15:42:25.013
> 
> 标签：android, eclipse, device

我有一个联想 IdeaPad，正在尝试将它连接到 Eclipse。几周前它还在工作，但我有一段时间没有尝试在它上面运行应用程序，现在不会出现在 Eclipse 中。

它出现在我的 LeTools...

![](../Images/544b3bedbabce70f2154f089fa5d60e3.png)

但是当我在 Eclipse 中运行我的应用程序时......

![在此处输入图像描述](../Images/7089306a742a0fe8de11da28c43c1e75.png)

这个错误也出现了，但我认为这是一个不同的问题...... ![在此处输入图像描述](../Images/0e4018becc9fd87db2588d96ae0f5cd4.png)

无论如何，我认为我错过了让设备出现在 Eclipse 中的小步骤。如果有人知道这一步是什么，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T20:53:55.417

解决了。

好吧，事实证明，在第二个屏幕截图中，运行 Android 设备的 EMPTY 列表中，我的确实在那里。

由于某种原因，所有字段（序列号、AVD 名称、目标等）都已更改为空字符串。

无论如何，如果我双击空白列表的第一行，它会在我的设备上加载应用程序。

# php - 如何在 PHP 中将浮点数舍入到一定精度？

> ID：11615862
> 
> 赞同：0
> 
> 时间：2012-07-23T15:42:29.127
> 
> 标签：php, floating-point, formatting

我有一个变量（它恰好是文件大小），其值为`16.0986328125`.

我想将其打印为`16.098`（使用小数点后三位。）

我怎样才能做到这一点？这是我到目前为止所拥有的：

```
$filesize = 16.0986328125;
echo $filesize.' KB'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:45:02.353

看[`printf`](http://us.php.net/manual/en/function.printf.php)

```
printf("%0.3f KB", $filesize); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:44:59.700

这是[sprintf](http://www.php.net/manual/en/function.sprintf.php)函数的文档

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:44:00.200

您正在寻找该`round`功能。

# php - 为什么某些 MySQL 字段现在需要默认值？

> ID：11615863
> 
> 赞同：1
> 
> 时间：2012-07-23T15:42:32.423
> 
> 标签：php, mysql, database, migration, webserver

我正在将系统从旧服务器复制到公司的新（er）服务器，我没有参与以前系统的开发。他们有一个将记录插入数据库的当前（复杂）网页，我并不完全理解。但是，每个页面的代码和数据库设置是完全一样的。当我尝试插入未完成的表单（在我的版本上）时，我得到`Field 'invoiceNo' doesn't have a default value`，而在以前的系统上提交相同的未完成表单将创建（不完整的）数据。

我检查了罪魁祸首字段的设置，它设置为 Not Null，默认值为“Null”。两个数据库的设置相同，那么为什么相同的插入数据会被不同地处理呢？

旧 MySQL 版本：5.0.41-community-nt

新的 MySQL 版本：5.5.20

旧 MySQL 管理员版本：1.2.12

新的 MySQL 管理员版本：1.2.17

抱歉，如果听起来我不太清楚我在说什么 - 事实上我不知道，因为旧系统对我来说是一个陌生人，而且它庞大而复杂。不过可以回答任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:00:57.340

可能是新服务器设置为“严格”，或者在引入新版本时导致了向后兼容性中断。

您的问题是，虽然该字段期望“非空”但是您提供空值（即不提供它设置期望的数据）如果您将此字段更改为默认为“0”，那么空字段将默认为 0相反，应按预期添加数据。（但如果该字段期望“not null”，则您不应该提交“null”，因此我会先查看其路由原因，然后再使用 default=0 破解它！）

# javascript - OData：通配符（startswith）过滤 url 请求中的数字（ID）字段

> ID：11615864
> 
> 赞同：1
> 
> 时间：2012-07-23T15:42:34.717
> 
> 标签：javascript, entity-framework-4.1, wcf-data-services, odata

我一直在研究一种通过 OData 和 JavaScript 对我的实体的数字 ID 字段执行模糊搜索的方法。到目前为止，我还没有找到我正在寻找的答案。我可以使用“Startswith”过滤器选项完美地过滤其他 edm.string 列，但是当我尝试传入任何其他非字符串类型时，我会收到来自服务器的类型错误响应。

在我控制数据库的应用程序中，我成功地解决了这个问题，方法是创建我需要的视图并将视图的数字类型转换为字符串。但是，这似乎有点矫枉过正，为整个数据集创建一个视图，这样我就可以允许用户使用通配符搜索 ID，否则 OData 查询工作得很好。

有没有人找到一个很好的解决方案？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T16:12:39.597

不幸的是，我认为您已经发现了最好的解决方案之一（创建视图）。您还可以创建一个允许您进行模糊搜索的服务操作。

你用什么做你的后端？这在 LINQ-to-Entities 上不受支持，但您可能能够创建一个看起来像这样的服务操作（为了证明它可以工作，您可以`ToList()`在之后将调用塞进去，但请`Products`确保不要部署类似于生产的东西:)）：

```
[ServiceBehavior(IncludeExceptionDetailInFaults = true)]
public class ScratchService : DataService<ScratchContext>
{

    [WebGet]
    public IQueryable<Product> FuzzySearch(string idStartsWith)
    {
        var context = new ScratchContext();
        return context.Products.Where(p => p.ID.ToString().StartsWith(idStartsWith));
    }
    // ...
} 
```

这不是我们经常听到的问题，但我绝对可以在团队中提出这个问题，当我们开始 OASIS 标准化过程时，我们可以考虑这个问题。

# c++ - C++，我如何在 html 代码中获取特定的字符串

> ID：11615867
> 
> 赞同：1
> 
> 时间：2012-07-23T15:42:45.423
> 
> 标签：c++, wget

我正在尝试解析[这个 XML Yahoo feed](http://sg.finance.yahoo.com/webservice/v1/symbols/allcurrencies/quote)。

我如何将每条记录放入 C++ 中的数组中，例如创建结构

然后获取这些变量并记录结构内的每个元素。

首先，我如何获得价值

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T15:47:15.607

您可能想查看给定页面是否提供 JSON 格式的输出。然后，您可以简单地请求该值，而不是乱用 HTML。雅虎！金融网站甚至可以提供一个 API，您可以使用该 API 轻松请求价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:07:06.223

如果你想弄乱 html 代码：

```
#include <iostream>
#include <fstream>
int main() {
  std::ifstream ifile("in.html");
  std::string line;
  std::string ndl("<span id=\"yfs_l10_sgdmyr=x\">");
  while(ifile.good()){ 
    getline(ifile, line);
    if (line.size()) {
      size_t spos, epos;
      if ((spos = line.find(ndl)) != std::string::npos) {
        spos += ndl.size();
        if ((epos = line.find(std::string("</span>"), spos)) != std::string::npos) {
          std::cout << line.substr(spos, epos-spos) << std::endl;
        }   
      }   
    }   
  }   
  return 0;
} 
```

# asp.net-mvc - Webform 的“UrlAuthorizationModule.CheckUrlAccessForPrincipal”等效于 MVC 是什么？

> ID：11615870
> 
> 赞同：2
> 
> 时间：2012-07-23T15:43:09.923
> 
> 标签：asp.net-mvc, routing, webforms, authorization, httpmodule

我在为我的公司编写自定义 SSO 解决方案时遇到了问题。为了简单起见，我制作了一个自定义身份验证 httpmodule，它拦截所有请求以检查用户身份验证状态。如果未通过身份验证，用户将被重定向到我的自定义 sso 登录页面。

问题是，当用户未通过身份验证时，我想检查他是否可以访问请求的页面/资源...使用 Webforms，没问题，我在 web.config 中添加了一个授权块，并且我使用**UrlAuthorizationModule.CheckUrlAccessForPrincipal**与匿名用户。一切正常...

但是当我将我的模块应用到**MVC (3)**网站时，这不再起作用（原因很明显，比如在使用路由时可以从不同的 url 访问相同的控制器和/或操作，并且因为授权是通过控制器属性）。

我怎样才能做到这一点？我一直在搜索一整天，没有找到任何关于它的东西：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T18:10:58.107

ASP.NET MVC 3 Internet 应用程序模板包括一个基本的 AccountController，它实现了以下操作（以及相关的模型和视图）：

*   登录
*   登记
*   更改密码/更改密码成功

您只需要您希望保护的操作或类的 [Authorize] 属性。但是如果你需要一些真正定制的东西，你可以像我做的那样做。

我创建了一个自定义类来覆盖我的应用程序中的安全性。

```
public class AuthorizeActivityAttribute : AuthorizeAttribute
    {
       protected override bool AuthorizeCore(HttpContextBase httpContext)
       {
        HttpContext currentContext = HttpContext.Current;

        //Do your custom authentication stuff here and return true or false depending on results
        Return true;
       }
    } 
```

现在在我的控制器中，我有以下内容：

```
[AuthorizeActivity] 
        public ActionResult Index()
        {
            ViewBag.Message = "Welcome";

        return View();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T21:24:59.120

我有同样的问题。
在此处查看解决方案：[Webforms "UrlAuthorizationModule.CheckUrlAccessForPrincipal" 的 MVC 等效项](https://stackoverflow.com/questions/19038186/mvc-equivalent-of-webforms-urlauthorizationmodule-checkurlaccessforprincipal/19038664?noredirect=1#19038664)

> 您必须从另一个控制器读取信息。这可以通过实例化其上下文和描述符来完成，然后为该控制器实例化 AuthorizationContext 并读取过滤器信息。

# java - Java和C之间的通信协议

> ID：11615875
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:43:30.707
> 
> 标签：java, c, communication

我用 C 语言编写了一个服务器应用程序，用 Java 编写了一个用于 android 的客户端应用程序，我使用字节流进行通信。如何改进此通信协议？是否有使用结构的跨平台通信协议，如 JSON？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:54:30.447

我会使用 TCP 作为通信协议。

我会使用文本格式（例如 JSon）作为使用 UTF-8 字符编码的数据格式。

我会让 API 尽可能简单。

# c# - 如何从 RuntimePropertyInfo 获取对象？

> ID：11615876
> 
> 赞同：5
> 
> 时间：2012-07-23T15:43:32.337
> 
> 标签：c#, reflection

我试图找到包含实现接口的对象的所有属性，并在对象上执行方法。这是我到目前为止的代码：

```
foreach (var propertyInfo in this.GetType().GetProperties()
    .Where(xx => xx.GetCustomAttributes(typeof(SearchMeAttribute), false).Any()))
{
    if (propertyInfo.PropertyType.GetInterfaces().Any(xx => xx == typeof(IAmSearchable)))
    {
        // the following doesn't work, though I hoped it would
        return ((IAmSearchable)propertyInfo).SearchMeLikeYouKnowIAmGuilty(term);
    }
} 
```

不幸的是，我得到了错误：

> 无法将“System.Reflection.RuntimePropertyInfo”类型的对象转换为“ConfigurationServices.ViewModels.IAmSearchable”类型。

我怎样才能得到实际的对象，而不是`RuntimePropertyInfo`?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-23T15:47:54.953

您需要使用以下[`GetValue`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getvalue.aspx)方法从属性中获取值：

```
object value = propertyInfo.GetValue(this, null); 
```

`this`是属性的“目标”，表示`null`您期望的只是无参数属性，而不是索引器。

# android - 如何为 Android MediaPlayer 设置速率？

> ID：11615877
> 
> 赞同：3
> 
> 时间：2012-07-23T15:43:42.390
> 
> 标签：android

我该如何实施

```
setRate(float f) 
```

对于我的 Android MediaPlayer，其次是否可行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T16:35:29.790

我相信[这](http://developer.android.com/reference/android/media/AudioTrack.html#setPlaybackRate%28int%29)是您正在寻找的功能。

这设置了音频数据将被消耗和播放的采样率，而不是内容的原始采样率。将其设置为内容采样率的一半将导致播放持续时间延长两倍，但也会导致负音调偏移。有效的采样率范围是从 1Hz 到返回值的两倍`getNativeOutputSampleRate(int)`。

如果你想直接使用 AudioTrack 播放 mp3，你可以看看[这个](http://mindtherobot.com/blog/624/android-audio-play-an-mp3-file-on-an-audiotrack/)例子，或者将你的 mp3 文件转换成 wav 格式，这样 AudioTrack 就可以轻松使用它。如果您想轻松调整播放速率，这是您应该考虑的权衡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-23T23:25:54.790

Android 6.0 添加了`PlaybackParams`for `MediaPlayer`，所以你现在可以这样做：

```
String recordingPath = recordingDirectory + File.separator + "music.mp3";
MediaPlayer audioPlayer = MediaPlayer.create(getApplicationContext(), Uri.parse(recordingPath));
audioPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
PlaybackParams params = new PlaybackParams();
params.setSpeed(0.75f);
audioPlayer.setPlaybackParams(params);
audioPlayer.start(); 
```

我还没有 Android 6 设备，但这在模拟器中对我有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-23T15:46:16.883

根据 Android 开发人员文档，您可能必须改用 SoundPool。

[Android 开发者：Media SoundPool-setRate](http://developer.android.com/reference/android/media/SoundPool.html#setRate%28int,%20float%29)

`public final void setRate (int streamID, float rate)`

> 更改播放速率。播放速率允许应用程序改变声音的播放速率（音高）。值 1.0 表示以原始频率播放。值 2.0 表示播放速度加倍，值 0.5 表示播放速度减半。如果流不存在，它将不起作用。
> 
> **参数**
> 
> *streamID* : play() 函数返回的 streamID
> 
> *rate*：播放速率（1.0 = 正常播放，范围 0.5 到 2.0）

# python - Python 2.7.3：复制符号链接，但不要遵循

> ID：11615878
> 
> 赞同：3
> 
> 时间：2012-07-23T15:43:46.343
> 
> 标签：python, linux, python-2.7, symlink

我正在使用 Python 2.7.3。我正在使用 Python 脚本将目录树的一部分从一个位置复制到另一个位置。一些需要复制的文件是符号链接。

如何使用 Python 将符号链接从一个位置复制到另一个位置而不跟随它们？（我只是希望它像“常规”文件一样盲目地复制它们）

我发现`shutil.copy()`Python 3.3 支持该参数`follow_symlinks=False`，但旧版本的 shutil 不支持。

编辑：更多细节：

此脚本的目的是从指定位置获取所有文件并将它们拆分为单独的档案。我知道我可以通过压缩整个目录并拆分存档来做到这一点，但我需要能够单独提取每个存档而不重新加入一个大型存档。此外，每个存档必须小于指定的大小。

基本方法：

1.  获取源目录所有文件的所有绝对路径
2.  获取所有文件的所有大小
3.  按大小对所有文件（无论位置如何）进行排序
4.  将文件从位置 X 复制到 tmp 位置（直到复制文件的总和 <= 最大存档大小）
5.  创建 tmp 存档
6.  清理 tmp 位置
7.  仍有文件要复制时返回 4

对于任何反馈，我们都表示感谢。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:54:16.640

复制目录树的一部分，你说？在这种情况下，请尝试[`shutil.copytree()`](http://docs.python.org/library/shutil.html#shutil.copytree).

> 如果 symlinks 为真，则源树中的符号链接在新树中表示为符号链接，但不会复制原始链接的元数据；如果为 false 或省略，则将链接文件的内容和元数据复制到新树中。

因此，只要您不需要保持元数据相同，这应该可以正常工作（实际上，符号链接自己甚至可以拥有这样的元数据，还是它们只是引用它们指向的文件/对象的元数据？ ）。另请注意，您不必使用`copytree()`;复制整个树。该`ignore`参数允许您提供一个可调用的对象，该可调用对象将修剪要复制的文件和目录。

不过要注意的一件事是：如果您修改传递给`ignore`可调用对象的内容列表，这也会影响复制的内容（如您在[源`copytree()`代码](http://docs.python.org/library/shutil.html#copytree-example)中所见）。

* * *

（从评论中复制/解释）

由于实现`shutil.copytree()`显示了如何`copytree()`处理符号链接 ( )，即使它本身没有用`linkto = os.readlink(srcname); os.symlink(linkto, dstname)`，也可以用作如何“复制”符号链接的参考。`copytree()`

# java - Java中的R-Tree实现

> ID：11615879
> 
> 赞同：0
> 
> 时间：2012-07-23T15:43:47.343
> 
> 标签：java, r-tree

> **可能重复：**
> [R-Tree 实现 Java](https://stackoverflow.com/questions/8456240/r-tree-implementation-java)

Java 中是否有任何 r-tree 实现可以支持任意数量的维度？

我只找到了二维数据的 java r-tree 实现。

# php - array_rand() 在 while 循环中需要相同

> ID：11615881
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:43:55.553
> 
> 标签：php, arrays

我有一个 while 循环，我在其中使用数组的值：

```
 while (blablabla) {
            $id = $scene[array_rand($scene)];

  ... few mysql querys using $id

     } 
```

每次我使用时，`$id`我都会得到另一个值（是的，这就是我想要的），但是每次 while 运行另一个时我都需要`$id`，但是在 while 循环内部`$id`，每个查询都需要相同的值。有没有可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:48:06.183

```
while (blablabla) {             
  $id = $scene[array_rand($scene)];   
  $new_id = $id; //create new variable and use this one in the rest of the queries
  ... few mysql querys using $new_id       
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:48:45.707

为什么不在使用呼叫 ID 之前设置一次数组键？

```
while ()
{
  $key = array_rand($scene);
  $id = $scene[$key];

  //do something
} 
```

# ios4 - 如何在 iOS 4 中调整 UIPageControl 的指标？

> ID：11615887
> 
> 赞同：0
> 
> 时间：2012-07-23T15:44:09.870
> 
> 标签：ios4, uipagecontrol, indicator

如何自定义 UIPageControl 的指标。我尝试访问[此链接](http://apptech.next-munich.com/2010/04/customizing-uipagecontrols-looks.html)，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:19:57.590

使用 SMPageControl。工作方式与 UIPageControl 非常相似，但您可以轻松自定义指标（使用 setPageIndicatorImage）和选定指标（setCurrentPageIndicatorImage）。

# python - HTML 覆盖表格元素以不显示任何内容

> ID：11615889
> 
> 赞同：-1
> 
> 时间：2012-07-23T15:44:14.407
> 
> 标签：python, html, css, django

我正在通过 Django 呈现 HTML 表格。在此表中，某些单元格或列包含由我的 python 代码生成的“0”。

HTML中是否有任何方法可以覆盖该单元格或列，并在表格单元格中显示空白而不是0？

我也在使用 jQuery，如果有帮助的话。

```
<tr><td> Value</td>

{% for num in list %}
    <td> <b>{{num}}</b>
{% endfor %}</td>
</tr> 
```

输出是一个列表，其中包含 3 个零……我希望将其中两个清零。

可以说，如果我有东西被退回

```
0
10
0
20 
0 
```

但是想要

```
""
10
""
20
0

    $(".dem").each(function() {
        for ( var i = 0; i<2; i++)
        {
            if ($(this).html() == "0") {
            $(this).html(" ");         
            }
            i = i+1
        }
    }); 
```

我这样做了^....但是它把所有3个零都变成了空白...为什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T15:51:58.830

如果零是唯一评估为假的东西，您可以使用`default`模板过滤器：

```
{{ value|default:"&nbsp;" }} 
```

您可能需要使用实际的 unicode 字符

```
{{ value|default:"\u00A0" }} 
```

回应您的编辑：

```
<tr><td> Value</td>

{% for num in list %}
    <td> <b>{{ num|default:"\u00A0" }}</b>
{% endfor %}</td>
</tr> 
```

仅更改第一行：

```
<tr><td> Value</td>

{% for num in list %}
    <td> <b>{% if forloop.first %}&nbsp;{% else %}{{ num }}{% endfor %}</b>
{% endfor %}</td>
</tr> 
```

有关 forloop 变量的更多信息，[请查看此处](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#for)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T16:00:55.600

请参阅最后的编辑以获取我的最终答案。我将剩下的留在里面，以展示提出一个好问题的重要性，并展示[尝试过](http://www.whathaveyoutried.com)的内容、输入的样子以及预期的输出应该是什么。那会节省很多时间。

* * *

使用 jQuery，您可以遍历每个表格单元格，检查值并更改其输出内容。我更喜欢这个而不是更改实际数据。最好保持您的数据完好无损，只更改它在此处的显示方式。

```
$("#test td").each(function() {
    if ($(this).html() == "0") {
        $(this).html("");
    }
}); 
```

[您可以在这里](http://jsfiddle.net/wuqqr/3/)看到它的实际效果。

**更新：**

如果只`<td>`需要更改一些 s，我建议为这些使用一个类。

```
$(".noZeroAllowed").each(function() {
    if ($(this).html() == "0") {
        $(this).html("");
    }
}); 
```

它适用于这样的 HTML：

```
<table id="test">
    <tr>
        <td class="noZeroAllowed">10</td>
        <td class="noZeroAllowed">5</td>
        <td>0</td>
        <td>1</td>
    </tr>
    <tr>
        <td class="noZeroAllowed">11</td>
        <td class="noZeroAllowed">0</td>
        <td>9</td>
        <td>7</td>
    </tr>
</table> 
```

另请参阅[更新的小提琴](http://jsfiddle.net/wuqqr/5/)。

**更新 2**：

如果数据不是原子数据并且单元格中有多个值，如下所示：

```
<table id="test">
    <tr>
        <td class="noZeroAllowed">10 0 foobar 0</td>
        <td class="noZeroAllowed">5</td>
        <td>0, 0, 0</td>
        <td>1</td>
    </tr>
</table> 
```

然后，您需要更改 Javascript 以使用正则表达式。`\b`表示单词边界。但它不适用于小数`0.5`。

```
$(".noZeroAllowed").each(function() {
    var newStr = $(this).html().replace(/\b0\b/g, "");
    $(this).html(newStr);
}); 
```

请参阅[更新的小提琴](http://jsfiddle.net/wuqqr/8/)。

更新 3：

这会将`<b>`相关类`<td>`s 中标签内的所有零转换为空字符串，但保持最后一个零不变。

```
$(".noZeroAllowed").each(function() {
    var zeros = new Array;
    var b = $(this).find("b");
    for (var i = 0; i < b.length; i++) {
        $(b[i])
        if ($(b[i]).html() == "0") {
            zeros.push(b[i]);
        }
    }
    for (var i = 0; i < zeros.length - 1; i++) {
        $(zeros[i]).html("");
    }
}); 
```

[在这里](http://jsfiddle.net/wuqqr/9/)看到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:49:41.300

您可以使用 Django 的**模板**（请参阅[文档](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs)）：

```
{% if val != 0 %}{{ val }}{% endif %} 
```

或者，如果你想要更整洁的东西，你可以在模板中使用 Django**过滤器：**

```
{{ val | default: "" }} 
```

......科林打败了我。;) 请参阅[“默认”过滤器的文档](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#default)。

**编辑：**在回答您的评论时，您会这样做：

```
{% for num in list %}
    <td><b>{{num | default: ""}}</b></td>
{% endfor %} 
```

请注意，您的 for 循环`</td>` *位于外部*，而它需要位于内部。

# python - scapy 获取数据包的到达时间

> ID：11615892
> 
> 赞同：18
> 
> 时间：2012-07-23T15:44:24.627
> 
> 标签：python, packet-sniffers, scapy

有没有办法使用 scapy 获取数据包的到达时间？使用 scapy 读取 pcap 文件，我想知道所有数据包的到达时间，因为我们知道wireshark 可以看到它。所以我想一定有办法。有人知道吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-29T08:55:18.673

利用`pkt.time`

```
[mpenning@tsunami icinga-1.7.1]$ sudo python
[sudo] password for mpenning:
Python 2.6.6 (r266:84292, Dec 26 2010, 22:31:48)
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from scapy.all import sniff
WARNING: No route found for IPv6 destination :: (no default route?)
>>> pkts = sniff(iface='eth0')
^C>>>
>>> pkts
<Sniffed: TCP:2 UDP:8 ICMP:0 Other:4>
>>> for pkt in pkts:
...     print pkt.time
...
1343551962.73
1343551963.28
1343551963.28
1343551963.32
1343551963.32
1343551963.36
1343551963.4
1343551963.45
1343551963.55
1343551963.65
1343551963.75
1343551963.85
1343551963.85
>>> 
```

# java - 从列表中填充微调器

> ID：11615893
> 
> 赞同：0
> 
> 时间：2012-07-23T15:44:24.520
> 
> 标签：java, android

我在填充类型时遇到了一些`Spinner`困难`List`。

目标：当`Button`在主菜单上按下 a 时，它会执行任务 GetTownsTask，该任务会`Spinner`在新屏幕上填充 a，但在设置`Adapter`.

**MainActivity.java**

```
private class GetTownsTask extends AsyncTask<Void, Void, List<String>> {
    @Override
    protected List<String> doInBackground(Void... p)  {

        // api calls
        List<String> towns = new ArrayList<String>();
        // populate towns
        return towns;
    }

    @Override
    protected void onPostExecute(List<String> townList) {

        Spinner spinner = (Spinner) findViewById(R.id.spinner);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(
                MainActivity.this, 
                android.R.layout.simple_spinner_dropdown_item, 
                townList.toArray( new String[0] ));
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapter);    // line 124, breaks here
    }
} 
```

**崩溃日志**

```
FATAL EXCEPTION: main, 
java.lang.NullPointerException,
at com.project.MainActivity$TestTask.onPostExecute(MainActivity.java:124) 
```

**微调屏幕**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#787878">

    <Spinner
        android:id="@+id/spinner"
        android:layout_width="200dip"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/townTextView"
        android:layout_below="@+id/townTextView"
        android:layout_marginTop="10dp" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:49:14.850

问题出在`townList.toArray(new String[0])`. 尝试使用`townList.toArray()`，这将确保创建的 String 数组与 townList 的大小相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T07:51:25.923

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(
                MainActivity.this, 
                android.R.layout.simple_spinner_dropdown_item, 
                townList.toArray( new String[0] )); 
```

似乎您不需要`.toArray`，因为您可以将`List<String>`对象传递给`ArrayAdapter`构造函数。

所以试试，

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(
                MainActivity.this, 
                android.R.layout.simple_spinner_dropdown_item, 
                townList); 
```

这假设 townList 实际上被填充`doInBackground()`并且它的返回值被传递给`onPostExecute(townList)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T15:50:03.337

//像这样填充你的微调器

```
package com.javasamples;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Spinner;
import android.widget.TextView;

public class ArrayAdapterDemo2 extends Activity implements
        AdapterView.OnItemSelectedListener {
    TextView selection;
    String[] items = { "this", "is", "a", "really", 
            "really2", "really3",
            "really4", "really5", "silly", "list" };

    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.main);
        selection = (TextView) findViewById(R.id.selection);

        Spinner spin = (Spinner) findViewById(R.id.spinner);
        spin.setOnItemSelectedListener(this);

        ArrayAdapter aa = new ArrayAdapter(
                this,
                android.R.layout.simple_spinner_item, 
                items);

        aa.setDropDownViewResource(
           android.R.layout.simple_spinner_dropdown_item);
        spin.setAdapter(aa);
    }

    public void onItemSelected(AdapterView<?> parent, View v, int position,
            long id) {
        selection.setText(items[position]);
    }

    public void onNothingSelected(AdapterView<?> parent) {
        selection.setText("");
    }
}//class 
```

这肯定会帮助你。

谢谢 ：）

# android - Google Play：霓虹灯和 FPU 过滤器？或者没有他们如何生活？

> ID：11615894
> 
> 赞同：4
> 
> 时间：2012-07-23T15:44:26.310
> 
> 标签：android, google-play, neon, android-market-filtering

我的 Android 应用程序有一些不同的版本：支持/不支持 FPU，支持/不支持 NEON。

在 Google Play 市场中提交此类应用的最佳方式是什么？是否可以根据目标设备上的 NEON ir FPU 的可用性来过滤目标设备？如果没有，我应该怎么做才能支持所有设备（没有这些硬件功能）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-23T18:28:41.383

AFAIK，Google 只为 Android 定义了两组 ARM ABI：ARMv5 和 ARMv7a。在 ARMv5（较旧的 Android 设备）上，保证不支持 FPU 和 NEON。在 ARMv7a 设备上，FPU 和 NEON 支持是可选的。市场在这 2 个 ABI 上筛选符合条件的设备。您可以构建一个“胖二进制文件”，其中包含每个 ABI 的唯一本机代码库。对于 FPU 和 NEON 功能，您需要在运行时测试它们是否存在。这是查看 NEON 指令是否可用的代码：

```
#include "cpu-features.h"
    bHasNEON = FALSE;
    if (android_getCpuFamily() == ANDROID_CPU_FAMILY_ARM &&
            (android_getCpuFeatures() & ANDROID_CPU_ARM_FEATURE_NEON) != 0)
        {
            // use NEON-optimized routines
            bHasNEON = TRUE;
        } 
```

您还可以测试 ARMV7 支持 (ANDROID_CPU_ARM_FEATURE_ARMv7) 和 VFP 支持 (ANDROID_CPU_ARM_FEATURE_VFPv3)

# sql-server - SQL Server：选择/更新下一列到？

> ID：11615895
> 
> 赞同：-3
> 
> 时间：2012-07-23T15:44:26.973
> 
> 标签：sql-server, select

我需要将下一列更新为包含特定数字的列。

ff 是表 C 中的列。

```
C1_K | C1_ID | C2_K | C2_ID | C3_K | C3_ID 
```

逻辑：

*   寻找在 C1_K 或 C2_K 或 C3_K 中找到数字 5 的位置。
*   如果它在 C1_K 中，则选择文本值 C1_ID。
*   如果它在 C2_K 中，则选择文本值 C2_ID。
*   如果它在 C3_K 中，则选择文本值 C3_ID。

请指教。我需要更新匹配的 K 列旁边的列。谢谢。

笔记：

*   所有 C*_K 列都包含唯一编号。
*   所有 C*_ID 列都包含唯一的文本。（这些是名字）

样本数据：

```
 154 | NULL | 155 | SantoRyUu | 156 | NULL 
```

如果选择 155，SantoRyUu 将被更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:05:23.093

（除了设计问题。）

您必须按名称提及列，因为 SQL Server 没有“next to”的语法。您也许可以使用动态 SQL 来做到这一点，但是很糟糕。这是一种可能性：

```
CREATE TABLE dbo.C
(
  C1_K  INT, 
  C1_ID VARCHAR(32), 
  C2_K  INT, 
  C2_ID VARCHAR(32), 
  C3_K  INT, 
  C3_ID VARCHAR(32)
);

INSERT dbo.C(C1_K, C2_K, C3_k)
SELECT 5,1,2
UNION ALL SELECT 2,5,7
UNION ALL SELECT 3,4,6;

DECLARE @MagicNumber INT;
SET @MagicNumber = 5;

UPDATE dbo.C SET 
 C1_ID = CASE C1_K WHEN @MagicNumber THEN 'yes' ELSE C1_ID END,
 C2_ID = CASE C2_K WHEN @MagicNumber THEN 'yes' ELSE C2_ID END,
 C3_ID = CASE C3_K WHEN @MagicNumber THEN 'yes' ELSE C3_ID END;

SELECT * FROM dbo.C; 
```

结果：

```
C1_K  C1_ID  C2_K  C2_ID  C3_K  C3_ID
----  -----  ----  -----  ----  -----
5     yes    1     NULL   2     NULL
2     NULL   5     yes    7     NULL
3     NULL   4     NULL   6     NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T17:23:04.430

如果你在 *_K 列上有索引，你应该试试这个

```
select C1_id
from table where c1_k = 155
union all
select C2_id
from table where c2_k = 155
union all
select C3_id
from table where c3_k = 155 
```

如果这些列上没有索引

```
select 
--coalesce(C1_id,c2_id,c3_id) --if you are sure other two columns values will be null
case 
when c1_k = 155 then c1_id 
when c2_k = 155  then c2_id 
when c3_k = 155 then c3_id 
end --in case you have values for other columns as 
--well like for 154 you might not have null but some other value..

from table where c1_k = 155
or c2_k = 155
or c3_k = 155 
```

如果您有更多这样的列，请更改上述查询。但最好的解决方案是将您的列设置为行..

# sitecore - 我们如何扩展 Sitecore 快速搜索（即时搜索）以使用自定义索引而不是系统索引？

> ID：11615896
> 
> 赞同：1
> 
> 时间：2012-07-23T15:44:27.327
> 
> 标签：sitecore

如[本](http://sdn.sitecore.net/upload/sitecore6/sitecore_search_and_indexing-a4.pdf)“Sitecore 快速搜索”所述，使用系统索引执行即时搜索。

如何在搜索时指向“Sitecore 快速搜索”以使用自定义索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T06:58:45.693

即时搜索最终会启动核心`search`管道，后端内其他类型的搜索都会使用该管道。`search`管道 ( )的处理器之一`SearchSystemIndex`明确指示系统搜索`system`索引。

只要这是搜索功能的核心，我不建议您更改那里的逻辑。如果您仍然决定采用这种方式，那么将自定义处理器插入`search`管道似乎是起点。我怀疑有许多意想不到的事情需要克服，以免破坏整个系统的搜索工作方式。

# javascript - ASP.net web 服务使用 javascript 发送命令

> ID：11615897
> 
> 赞同：0
> 
> 时间：2012-07-23T15:44:33.050
> 
> 标签：javascript, asp.net, vb.net, web-services

我希望通过 WebOS 平板电脑上使用的 javascript 向本地网络上的 Web 服务页面发送命令。问题是我以前从未这样做过，并且想知道是否有可能一开始就这样做？**我可以创建一个 VB.net 来收听 Web 服务调用/网页吗？**

我将使用 Dreamweaver 从 phonegap 创建“应用程序”。我正在寻找使用 javascript 将字符串发送到 Web 服务的示例，我可以在 PC 上不断读取该服务，以便根据我在应用程序上按下的按钮根据需要执行任务。

举个例子：

```
 WebOS app > 
 button pushed in app to call up Internet Explorer > 
 sends "IE" string to WS > 
 WS triggers the correct exec to start depending on the string sent to it (IE) > 
 WS sends back "OK" to WebOS app when program is launched 
```

有没有人有这样的例子？

**更新** 所以我会在我的javascript中做类似的事情？：

```
<!DOCTYPE html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">

function buttonClicked(str what2Pass)
{
  $.ajax({
    async : false, /* set as true if you want asynchronous behavior */
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: "http://localhost:7777/WebService.asmx/PerformAction",
    data: { "webOSCommand" : what2Pass},
    dataType: "json",
    success: function(data){
        alert(true);
    }
  });
}

<html>
<body>
<input type="button" id="button1" value="run IE on PC" onClick="buttonClicked('IE');" />
</body>
</html> 
```

对于我的 WS，它将是：

```
Imports System.Web
Imports System.Web.Services
Imports System.Web.Services.Protocols
Imports System.Diagnostics
Imports System.Web.Script.Services

' To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line.
' <System.Web.Script.Services.ScriptService()> _
<WebService(Namespace:="http://tempuri.org/")> _
<WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _
<Global.Microsoft.VisualBasic.CompilerServices.DesignerGenerated()> _
<ScriptService()> _
Public Class Service
    Inherits System.Web.Services.WebService

    <WebMethod()> _
    Public Function PerformAction(byRef webOSCommand as String) As String
        Dim oPro As New Process

        With oPro
            .StartInfo.UseShellExecute = True
            .StartInfo.Arguments = "http://www.google.com"
            .StartInfo.FileName = "internet explorer.exe"
            .Start()
        End With

        Return "Started"
    End Function

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:53:40.923

是的，您可以通过 ajax 从 Javascript 调用 Web 服务。一个例子是这样的：

```
$.ajax({
  type: "POST",
  contentType: "application/json; charset=utf-8",
  url: "WebService.asmx/PerformAction",
  data: { "somestring" : "IE"},
  dataType: "json"
}); 
```

您的网络服务：

```
[WebMethod]
 //parameter name must match the parameter name passed in from the Ajax call (sometring)
 public static string PerformAction(string somestring) 
 {
   return "something";
 } 
```

[这里有详细的例子。](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T16:38:37.417

您所做的是正确的，但是您需要使用 [ScriptService] 属性来装饰您的 webservice 类。

```
[ScriptService]
  public class MyWebService : WebService {
   [WebMethod]
   public void MyMethod() {
   }
} 
```

完成此操作后，您可以像以前一样通过 $.ajax 访问 Web 服务。

**更新**

对您的 javascript 函数稍作更改。我没有使用“完成”方法，而是设置传递给 $.ajax 方法的设置对象的“成功”属性。如果您希望 web 服务调用是异步的，您可以设置 async 属性，如下面的代码所示。

```
function buttonClicked(str what2Pass)
{
  $.ajax({
    async : false, /* set as true if you want asynchronous behavior */
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: "http://localhost:7777/WebService.asmx/PerformAction",
    data: { "webOSCommand" : what2Pass},
   dataType: "json",
   success: function(data){
    alert(data);
   }
   });
} 
```

# c# - 从 HTML 子类获取数据

> ID：11615898
> 
> 赞同：2
> 
> 时间：2012-07-23T15:44:34.503
> 
> 标签：c#, html

我正在尝试用 C# 创建一个工具，用于收集和分析来自网页/表单的数据。基本上有两种不同类型的数据。用户输入的数据和系统创建的数据（我无权访问）。

用户创建的数据保存在字段中，表单使用 ID - 因此使用 GetElementByID。我遇到的问题是获取系统创建的数据。它显示在表单上，​​但与 ID 无关。我可能错误地阅读/解释了 HTML，但它似乎是一个子类（我没有太多的 HTML 经验）。我正在尝试获取“提交日期”数据（靠近代码底部）。HTML 代码示例：

```
<div class="bottomSpace">
    <div class="importfromanotherorder">
        <div class="level2Panel" >

           <div class="left">
                <span id="if error" class="error"></span>
             </div>

           <div class="right">
                Enter Submission ID
                <input name="Submission$ID" type="text" id="Submission_ID" class="textbox" />
                <input type="submit" name="SumbitButton" value="Import" id="SubmitButton" />
            </div>
        </div>
    </div>
</div>

<div class="bottomSpace">
    <div class="detailsinfo">
        <div class="level2Panel" >

        <div class="left">
                <h5>Product ID</h5>
                1234567
                <h5>Sub ID</h5>
                Not available
                <h5>Product Type</h5>
                Type 1
        </div>

        <div class="right">
                <h5>Order Number</h5>
                0987654
              <h5>Status</h5>
                Ordered
                <h5>Date Submitted</h5>
                7 17 2012 5 45 09 AM
            </div>
        </div>
    </div>
</div> 
```

使用 GetElementsByTagName（搜索“div”）然后使用 GetAttribute(“className”)（搜索“right”）会生成一些结果，但由于有 2 个“right”类，因此无法按预期工作。

我尝试通过 className = “detailsinfo” 进行搜索，我可以找到它，但我不确定如何才能找到“正确”的课程。我尝试了兄弟姐妹和孩子，但结果似乎不起作用。下一个可能的问题是，日期数据实际上是属于“right”类的文本，而不是“Date Submitted”元素。

所以基本上，我很好奇如何获得我正在寻找的数据的最佳方法。我是否需要获取所有类“正确”文本，然后尝试提取日期字符串？

如果信息过多或所需信息不足，我们深表歉意:) 提前致谢！

编辑：添加了如何使用 C# 调用 GetElementsByTagName - 根据 Icarus 的评论。

```
HtmlDocument doc = webBrowser1.Document;
HtmlElementCollection elemColl = doc.GetElementsByTagName("div"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:11:32.390

如果您想要的“正确”实例是第二个，这将做到这一点。给出了两种方法：

注释掉的方法是从零开始的，所以使用实例 1。第二种方法是 xpath，因此是从一开始的，所以使用实例 2。

```
private string ReadHTML(string html)
{

  System.Xml.XmlDocument doc = new System.Xml.XmlDocument();
  doc.LoadXml(html);
  System.Xml.XmlElement element = doc.DocumentElement;

  //This commented-out approach works and might be preferred if you want to iterate
  //over a node set instead of choosing just one node
  //string key = "//div[@class='right']";
  //System.Xml.XmlNodeList setting = element.SelectNodes(key);
  //return setting[1].LastChild.InnerText;

  // This xpath appraoch will let you select exactly one node:
  string key = "((//div[@class='right'])[2])/child::text()[last()]";
  System.Xml.XmlNode setting = element.SelectSingleNode(key);
  return setting.InnerText;

} 
```

# php - PHP：打开另一个具有数组值的 PHP

> ID：11615900
> 
> 赞同：1
> 
> 时间：2012-07-23T15:44:40.760
> 
> 标签：php, arrays, new-window

是否可以通过 PHP 函数打开另一个传递 $array 的 PHP 文件（print_array.php）？

HTML：

```
<form method=post>
<input type="checkbox" name="array[]" value="111">
<input type="checkbox" name="array[]" value="222">
<input type="checkbox" name="array[]" value="333">
<button type="submit" name="action" value="print">Print</button>
<button type="submit" name="action" value="delete">Delete</button>
<button type="submit" name="action" value="add">Add New</button>
</form> 
```

array[] 全部被检查，因此，$array 的值为 111、222 和 333。

然后，PHP函数：

```
switch ($action) {
  case 'print': printing($_post['array']); break; /* open new window */
  case 'add': break; /* same window */
  case 'delete': break; /* same window */
  default: break;
}

function printing($array) {
  /* open print_array.php in a new window showing $array value */
} 
```

然后，仅当 action=print 时，在具有 $array 值的新窗口中打开 print_array.php。

```
if (is_array($array)) {
  print_r($array);
} else {
  ...
} 
```

print_array.php 中的结果将是

```
Array ( [0] => 111 [1] => 222 [2] => 333 ) 
```

我不认为**header("Location: print_array.php")**可以传递数组值。有什么好方法可以在传递数组值的新窗口中打开另一个 PHP 页面吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:49:32.683

要使用 Javascript 打开窗口，请在页面加载时使用 window.open()。

要将数据获取到新页面，请使用 _SESSION 变量。当您使用 swtich 访问脚本时，请使用：

```
start_session(); 
$_SESSION['data'] = $_POST['array']; 
```

在新窗口上（使用 header() 访问它之后，使用：

```
start_session();
$array = $_SESSION['data']; 
```

您将可以在新窗口中访问整个阵列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:49:30.217

请记住，PHP 不会打开窗口等。您要执行的操作听起来需要在 HTML 和/或 javascript 中实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T16:03:31.307

最好的方法是使用 javascript：

Firs 声明您的复选框以在单击时调用 javascript 函数：

```
<input type="checkbox" name="array[]" onclick="myfunction(111)" value="111"> 
```

然后在您的页面中包含以下内容：

```
 <script type="text/javascript">
      function myfunction(number) {
          if (number == 111) {
              location.href="mypage.html";
          }
      }
 </script> 
```

如果您严格想使用 PHP，也可以为此使用[$_POST](http://www.php.net/manual/en/reserved.variables.post.php)或[$_GET 。](http://php.net/manual/en/reserved.variables.get.php)

在服务器端，你可以做`switch($_GET['array'])`你的事情。这样，您必须将表单声明更改为

```
<form method=post action="<?php echo $_SERVER['PHP_SELF']; ?>"> 
```

或者

```
<form method=post action="<?php echo $_SERVER['PHP_SELF']; ?>"> 
```

# ajax - Django API 请求

> ID：11615901
> 
> 赞同：4
> 
> 时间：2012-07-23T15:44:41.587
> 
> 标签：ajax, django, api

我正在尝试访问另一个服务的 API，使用我的模型字段作为 API 请求中的关键字。URL 如下所示：

```
http://api.example.com/json/?first_name=FNAME&last_name=LNAME&key={key} 
```

这是来自views.py的代码：

```
class ExamplePersonView(ListView):

    context_object_name = "example_person"
    template_name = "templates/example_person.html"

    def get_queryset(self):
        lname = get_object_or_404(ExamplePeople, lname__iexact=self.args[0])
        return ExamplePeople.objects.filter(lname=lname) 
```

据我了解，我需要使用 AJAX 在我的页面模板和我的 views.py 之间进行通信以发送请求，然后在页面上显示信息。

我发现了几个 Django 应用程序，它们可以轻松地将您的模型转换为公共 API，但没有一个可以帮助您从其他服务访问 API。有谁知道这样的应用程序吗？

如果没有，是否有人对使用 AJAX 和 Django 发出请求并在模板中呈现它有很好的理解？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T16:10:50.517

有几种方法可以与“外部”API 进行通信。没有必要使用ajax。Ajax 仅用于在模板中进行后台调用，触发您想到的任何事件。

但是，假设您想与 facebook GraphAPI 进行通信以检索配置文件

[http://graph.facebook.com/bill.clinton](http://graph.facebook.com/bill.clinton)

标准结果被序列化为 JSON，它很容易实现到 AJAX 或任何 JavaScript 库中，因此名称为 JavaScript Object Notation。

所以 AJAX 的一个例子可能是：

```
function callFacebook() {
    $.ajax({
        type: "GET",
        data: ({}),
        dataType: 'json',
        url: "http://graph.facebook.com/bill.clinton",
        success: function(data){
            alert("Hi I am former "+data.name);
        }
    });
}
callFacebook(); 
```

将此包含在您的 javascript 文件中或脚本标记之间的模板中，您应该会收到一条很好的警报消息：

> 嗨，我是前总统比尔克林顿

现在你可以把这个警报变成更有意义的东西，并将它放在一个 h1 标签中（不知道为什么这是有意义的）

```
$("body").html("<h1>"+data.name+"</h1>"); 
```

但有时您可能希望在应用程序的服务器端检索数据并对其进行处理。

所以创建一个 django urlpattern 和视图，例如：

```
from urllib2 import urlopen
from django.http import HttpResponse
from django.utils import simplejson    

def call_bill(request):
    url = "http://graph.facebook.com/bill.clinton"
    json = urlopen(url).read()
    # do whatever you want
    return HttpResponse(simplejson.dumps(json), mimetype="application/json")

# add this to your url patterns
url("^call_bill_clinton/$", call_bill) 
```

现在访问您的网址

作为逻辑结果，也完全有可能通过某些用户操作触发异步事件。例如，前面提到的 ajax 示例中的 URL 参数也可以是 django url，如“/call_bill_clinton/”。

```
<!-- add a button to call the function -->
<button onclick="callFacebook();">Call Bill</button>

function callFacebook() {
    $.ajax({
        type: "GET",
        data: ({}),
        dataType: 'json',
        url: "/call_bill_clinton/",
        success: function(data){
            alert("Hi I am former "+data.name+" and I came from Django");
        }
    });
)
// remove the auto call 
```

此外，ajax 调用可以让你做和 http 请求一样的诡计，你可以使用各种请求方法结合很酷的 javascript 事件，比如 beforeSend 事件

```
 beforeSend: function() {
        $('#loading').show();
    }, 
```

#loading 可能类似于：

```
 <div id="loading" style="display:none;">
        <img src="{% static "images/loading.gif" %}" />
    </div> 
```

# facebook - 使用 JavaScript 在 Facebook 上发帖时设置隐私

> ID：11615906
> 
> 赞同：0
> 
> 时间：2012-07-23T15:44:50.163
> 
> 标签：facebook, facebook-graph-api

根据[API 文档](https://developers.facebook.com/docs/reference/api/user/#posts)，我可以在将帖子发送到用户的墙（而不是朋友的墙）时设置帖子的隐私。

我尝试将隐私设置为公共 PUBLIC，`{"value","public"}`但每次出现*错误 100: invalid parameter error*。

有人可以告诉我应该怎么做才能公开隐私值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:12:37.250

如果您的应用程序的用户隐私设置未设置为较低的设置，则将隐私更改为`{"value":"EVERYONE"}`它将起作用。

# php - 数据未插入第二个表（MYSQLi）

> ID：11615910
> 
> 赞同：9
> 
> 时间：2012-07-23T15:44:56.943
> 
> 标签：php, mysql, database, mysqli

我正在使用下面的代码上传文件并使用 mysqli 将数据插入“图像”表：

```
<?php
session_start();

$username="xxx";
$password="xxx";
$database="mobile_app";

$mysqli = new mysqli("localhost", $username, $password, $database);

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    die();
}

$result = 0;

//UPLOAD IMAGE FILE

move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);

$result = 1;

//INSERT INTO IMAGE DATABASE TABLE

$imagesql = "INSERT INTO Image (ImageFile) VALUES (?)";

if (!$insert = $mysqli->prepare($imagesql)) {
    // Handle errors with prepare operation here
}

//Dont pass data directly to bind_param store it in a variable
$insert->bind_param("s", $img);

//Assign the variable
$img = 'ImageFiles/' . $_FILES['fileImage']['name'];

$insert->execute();

//RETRIEVE IMAGEID FROM IMAGE TABLE

$lastID = $mysqli->insert_id;

//INSERT INTO IMAGE_QUESTION DATABASE TABLE

$imagequestionsql = "INSERT INTO Image_Question (ImageId, SessionId, QuestionId) VALUES (?, ?, ?)";

if (!$insertimagequestion = $mysqli->prepare($imagequestionsql)) {
    // Handle errors with prepare operation here
}

$sessid =  $_SESSION['id'] . ($_SESSION['initial_count'] > 1 ? $_SESSION['sessionCount'] : '');

$insertimagequestion->bind_param("sss", $lastID, $sessid, $_POST['numQuestion'][$i]);

$insertimagequestion->execute();

//IF ANY ERROR WHILE INSERTING DATA INTO EITHER OF THE TABLES
if ($insert->errno) {
  // Handle query error here
}

$insert->close();

if ($insertimagequestion->errno) {
  // Handle query error here
}

$insertimagequestion->close();

}

}
?> 
```

因此，例如，如果我将 2 个图像“cat.png”和“dog.png”插入“图像”数据库表中，它将像这样插入：

```
ImageId         ImageFile

220             cat.png
221             dog.png 
```

（ImageId 是一个自动增量）

无论如何我想要做的是，当文件上传时，不仅数据插入到上面的表中，而且我还希望能够检索上面插入的 ImageId 并将其放在下面的“Image_Question”表中所以它会是这样的：

```
 ImageId         SessionId      QuestionId

    220             cat.png      1
    221             dog.png      4 
```

问题是它没有在第二个表“Image_Question”中插入任何数据，有谁知道它为什么没有插入任何数据？php 文件中没有错误。

要上传文件，用户在“QandATable.php”页面中为 ajax 上传器选择一个文件，当用户点击上传时，使用 AJAX 它将进入 imageupload.php 页面并在那里进行上传。所以我遇到的问题是不会出现错误，因为它们在单独的页面上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T16:48:36.867

首先，保存从您的记录添加中获得的插入 ID（在 $insert->execute 之后）：

```
$lastID = $mysqli->insert_id; 
```

然后稍后引用 $lastID。

从下面提取我的评论：

```
$lastID = $insert->insert_id; 
```

我认为这与交换句柄名称有关 - $mysqli、$insert 等。

希望我正确阅读了这个问题......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T05:15:07.380

检查`500 Error`Firebug -> Net tab/Chrome Developer tools -> Network tab 中的响应。即使没有以文本形式返回，这也将帮助您调试语法/语义错误，而不是逻辑错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T22:11:03.390

首先，当您回显 $lastID 时会发生什么？您是否将值输出到屏幕？

如果不是，我们需要先修复它，以便 $lastID 返回正确的值。

您的插入代码似乎是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T12:04:58.823

您应该从第一个表中获取最后插入的 ID 并插入到第二个表 (Image_Question) 中。

我不知道PHP编码，但是这个任务也很简单。因为这个操作将在DAO类中执行。所以，不管是PHP还是JAVA。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T00:41:01.980

如果第二次插入失败，则

```
if ($insertimagequestion->error) {
    // Handle query error here
   echo $insertimagequestion->error;
} 
```

这应该告诉您执行语句时抛出的错误是什么。

您的 PHP 代码似乎很好，错误可能是由于外键约束或数据库表上的任何其他约束。

**PS：**我认为你应该验证你允许上传的文件类型，这样人们就不能上传 *.php 或 *.js 文件，这可能导致灾难性的 XSS 攻击。还要尽量避免使用与用户上传的文件名相同的文件名，您可能希望使用一些随机变量作为前缀，因此您现在可以拥有

```
//notice uniqid(time()) for randomness, also move the declaration of $img higher
//Assign the variable
$img = "ImageFiles/" . uniqid(time()) . $_FILES["fileImage"]["name"];
move_uploaded_file($_FILES["fileImage"]["tmp_name"], $img);
...
//Dont pass data directly to bind_param store it in a variable
$insert->bind_param("s", $img); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-02T02:22:51.413

与 mysqli 绑定适用于对变量的引用。我不认为您在第二个绑定命令中的最后一个参数引用了您期望的方式。

将最后一个参数 $_POST['numQuestion'][$i] 分配给一个变量，并在绑定方法调用中使用这个变量。我猜这要么未定义，评估为 null，并且绑定失败，因为您不能将 null 绑定为字符串，或者绑定不能使用多维数组，因为它期望作为引用传递的变量。

试试这个：

```
//Below will set a default value of empty string if the POST variable is not set
$postVar = isset($_POST['numQuestion'][$i])?$_POST['numQuestion'][$i]:'';
$insertimagequestion->bind_param("sss", $lastID, $sessid, $postVar); 
```

执行此操作后，如果您在 QuestionId 列中看到带有 '' 的 DB 条目，则 $_POST['numQuestion'][$i] 没有被设置，并且您的代码中的其他地方有问题与无关数据库访问。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-08T07:32:49.617

试图找出可能失败的地方。

第二个查询没有问题，您成功获得最后一个插入ID。我为第二个查询的变量使用了静态值，它工作得很好。即使您可以硬编码值 n 检查。

请注意以下事项：

1.  绑定参数是否获得所有值？

> ```
> print_r() $lastID, $sessid, $_POST['numQuestion'][$i] 
> This Will not create problem unless database has contraints of not accepting empty or null values. 
> ```

1.  利用检查条件来找出哪里出错了。

> ```
> if (!$insertimagequestion = $mysqli->prepare("$imagequestionsql")) {
>     // Handle errors with prepare operation here
>     echo "Prepare statement err";
> }
> 
> if ($insert->errno) {
>   // Handle query error here
>     echo "insert execution error";
> } 
> ```

虽然它是一个 ajax，但您可以使用 Chome 的 Developer Tool 来调试 ajax 请求。

> 1.  按 F12在 Chrome中打开**开发者工具**
>     
>     
> 2.  转到网络选项卡>>对要在表单上发送的 ajax 请求执行操作>>您可以找到发送的 ajax 请求>>单击它>>单击“响应”选项卡，如果您回显或响应。所以，回显错误和 print_r() 来帮助调试

# magento - 自定义价格计算

> ID：11615916
> 
> 赞同：1
> 
> 时间：2012-07-23T15:45:35.960
> 
> 标签：magento, magento-1.6

我正在尝试找出设置自定义价格计算的最佳方法。基本上我的产品将有 5 个选项，例如：

*   宽度（毫米）：

    弯头（数量）：

    长度： 数量：

    肩带：是/否

我可以将这些作为自定义选项进行，但是它的计算非常复杂，需要按特定顺序执行。一个例子是

*   宽度需要四舍五入到下一个 50

    要应用的折扣

    增加每个弯头的成本（弯头按 0.06 英镑/米 * 长度计算）

    按数量加倍

    肩带加 10%

我知道如何进行计算，但不确定是否将其与 Magento 集成的最佳方法。

任何想法将不胜感激。

# php - 使 MDF 字段在 Authorize.net 中工作

> ID：11615919
> 
> 赞同：0
> 
> 时间：2012-07-23T15:45:48.703
> 
> 标签：php, authorize.net

我正在为餐厅使用礼券脚本，以便人们可以购买礼券。该脚本捕获所有需要的信息并通过 AIM 方法将其发送到 Authorize.net。餐厅经理收到来自 Authorize.net 的电子邮件传输，其中包含交易信息。

所有主要字段都被传递到 Authorize.net。但是，我们称之为“商家定义的字段”的字段并没有出现在 Authorize.net 电子邮件传输中。我知道有一种方法可以将这些字段引用为 MDF 字段，但我无法弄清楚语法。

有人可以帮我弄清楚我遗漏了哪些行吗？

这是捕获相关字段的表单：

```
<form method="POST" action="cart.php">
    <fieldset>
        <div class="form-divider">
            <label>Amount</label>
            <select name="amount">
                <?php for($i=5;$i<101;$i=$i+5){ ?>
                    <option value="<?php echo $i; ?>">$<?php echo $i; ?></option>
                <?php } ?>
            </select>
        </div>
        <div class="form-divider">
            <label>Will gift certificate be mailed directly to the recipient?</label>
            <input name="gift" type="radio" value="1" onclick="$('#gift-options').show();" />
            <label>Yes</label>
            <input name="gift" type="radio" value="0" checked="checked" onclick="$('#gift-options').hide();" />
            <label>No</label>
        </div>
        <div id="gift-options">
            <div class="col1">
                <div class="form-divider">
                    <label>To</label>
                    <input name="gift-to" type="text" size="20" />
                </div>
                <div class="form-divider">
                    <label>From</label>
                    <input name="gift-from" type="text" size="20" />
                </div>
            </div>
            <div class="col2">
                <div class="form-divider">
                    <label>Ship To Address</label>
                    <textarea name="gift-address" style="width: 200px; height: 50px;"></textarea>
                </div>
                <div class="form-divider">
                    <label>Gift Message</label>
                    <textarea name="gift-message" style="width: 200px; height: 50px;"></textarea>
                </div>
            </div>
        </div>
        <div class="form-divider">
            <label>Quantity</label>
            <input name="quantity" type="text" value="1" />
        </div>
        <input type="hidden" name="action" value="add" />
    </fieldset>
    <input type="submit" value="Next Step" class="button" />
</form> 
```

这是“结帐”代码，它收集实际发送到 Authorize.net 的数据：

```
<?php
require 'config.php';
session_start();
error_reporting(E_ALL);
ini_set('display_errors','On');

include('elements/loader.php');

$loader=new GiftCardLoader(true,true,true);
if($loader->checkStep(true)){ echo '<meta http-equiv="refresh" content="0;url=cart.php"> '; }

$amount=0;
foreach($loader->cart as $item){
    $amount+=($item['quantity']*$item['amount']);
}
$method=$loader->getShippingMethod();
$amount+=$method['price'];

$a = new PDAuthorizeNet;

/* Set all of the authnet info */
$a->add_field('x_login', $x_login);
$a->add_field('x_tran_key', $x_transkey);
$a->add_field('x_version', '3.1');
$a->add_field('x_type', 'AUTH_CAPTURE');
$a->add_field('x_test_request', 'FALSE'); 
$a->add_field('x_relay_response', 'FALSE');

$a->add_field('x_delim_data', 'TRUE');
$a->add_field('x_delim_char', '|');     
$a->add_field('x_encap_char', '');

/* Billing Information */
$a->add_field('x_first_name', $loader->address['billing']['x_first_name']);
$a->add_field('x_last_name', $loader->address['billing']['x_last_name']);
$a->add_field('x_address', $loader->address['billing']['x_address']);
$a->add_field('x_city', $loader->address['billing']['x_city']);
$a->add_field('x_state', $loader->address['billing']['x_state']);
$a->add_field('x_zip', $loader->address['billing']['x_zip']);
$a->add_field('x_country', $loader->address['billing']['x_country']);
$a->add_field('x_email', $loader->address['billing']['x_email']);

/* Shipping Information */
$a->add_field('x_ship_to_first_name', $loader->address['shipping']['x_first_name']);
$a->add_field('x_ship_to_last_name', $loader->address['shipping']['x_last_name']);
$a->add_field('x_ship_to_address', $loader->address['shipping']['x_address']);
$a->add_field('x_ship_to_city', $loader->address['shipping']['x_city']);
$a->add_field('x_ship_to_state', $loader->address['shipping']['x_state']);
$a->add_field('x_ship_to_zip', $loader->address['shipping']['x_zip']);
$a->add_field('x_ship_to_country', $loader->address['shipping']['x_country']);
$a->add_field('x_ship_to_email', $loader->address['shipping']['x_email']);

/* Credit Card Information */
$a->add_field('x_method', 'CC');
$a->add_field('x_card_num', $loader->sale['x_card_num']); 
$a->add_field('x_amount', $amount);
$a->add_field('x_exp_date', $loader->sale['x_exp_date']);
$a->add_field('x_card_code', $loader->sale['x_card_code']);

$billing=$loader->address['billing'];
$shipping=$loader->address['shipping'];
$body ="<h3>Order Details</h3>";
$body.="<table width='100%' cellpadding='5' border='1'>";
$body.="<tr>";
$body.="<td width='50%'>";
    $body.="<h3>Billing</h3>";
    $body.=$billing['x_first_name']." ".$billing['x_last_name']."<br />";
    $body.=$billing['x_email']."<br />";
    $body.=$billing['x_address']."<br />";
    if($billing['x_address2']!==""){
        $body.=$billing['x_address2']."<br />";
    }
    $body.=$billing['x_city'].", ".$billing['x_state']." ".$billing['x_zip']." ".$billing['x_country'];
$body.="</td>";
$body.="<td width='50%'>";
    $body.="<h3>Shipping</h3>";
    $body.=$shipping['x_first_name']." ".$shipping['x_last_name']."<br />";
    $body.=$shipping['x_email']."<br />";
    $body.=$shipping['x_address']."<br />";
    if($shipping['x_address2']!==""){
        $body.=$shipping['x_address2']."<br />";
    }
    $body.=$shipping['x_city'].", ".$shipping['x_state']." ".$shipping['x_zip']." ".$shipping['x_country'];
$body.="</td>";
$body.="</tr>";
$body.="</table>";
$body.="<p></p>";
$body.='<table width="100%" cellpadding="5" border="1">';
    $body.='<thead>';
        $body.='<th>Product</th>';
        $body.='<th>Quantity</th>';
        $body.='<th>Price</th>';
        $body.='<th>Subtotal</th>';
    $body.='</thead>';
foreach($loader->cart as $id=>$item){
    $body.='<tr>';
        $body.='<td>';
            $body.='Gift Card<br />';
            $body.='Amount: <strong>$'.$item['amount'].'</strong><br />';
            $body.='Is this a gift?: <strong>'.($item['gift']?"Yes":"No").'</strong>';
            if($item['gift']){
                    $body.='<br />To: <strong>'.$item['gift-options']['to'].'</strong><br />';
                    $body.='From: <strong>'.$item['gift-options']['from'].'</strong><br />';
                    $body.='Ship to address: <strong>'.$item['gift-options']['address'].'</strong><br />';
                    $body.='Personal Message: <strong>'.$item['gift-options']['message'].'</strong>';
            }
        $body.='</td>';
        $body.='<td>'.$item['quantity'].'</td>';
        $body.='<td>$'.number_format($item['amount'],2).'</td>';
        $body.='<td>$'.number_format($item['amount']*$item['quantity'],2).'</td>';
    $body.='</tr>';
}
$body.='<tr><td></td><td></td><td>'.$method['name'].'</td><td>$'.number_format($method['price'],2).'</td></tr>';
$body.='<tr><td></td><td></td><td>Grand Total</td><td>$'.number_format($amount,2).'</td></tr>';
$body.='</table>';

/* Respond and stuff */
switch ($a->process()) {
   case 1:  // Successs
        header('Location: return.php?success');
        mail($store_owner,"Gift Card Purchase",$body,"Content-Type: text/html; charset=ISO-8859-1\r\n");
        break;
   case 2:  // Declined
      header('Location: return.php?decline');
      break;
   case 3:  // Error 
      header('Location: return.php?error');
      break;
}

?> 
```

谢谢您的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:52:07.680

根据我看到的代码，我看不到如何添加商家定义的字段，因为它按名称添加字段并且这些字段没有名称。基本上，字段 38 之后的任何内容都是商家定义的字段，因此看起来您需要返回并破解该脚本以允许以某种方式添加商家定义的字段。可能通过添加具有 , 等的能力`merchant_field_1`来`merchant_field_2`满足您的需求。

# matlab - Matlab：曲面图不起作用

> ID：11615921
> 
> 赞同：5
> 
> 时间：2012-07-23T15:45:54.533
> 
> 标签：matlab, plot, geometry-surface

我有一个我正在尝试做的表面图。x 是 11 元素向量，ya 300 元素向量和 za 300*11 元素矩阵。

当我尝试像这样绘制它时：

```
surf(x y z) 
```

曲面图不显示。轴在那里，但没有表面图。 ![空白曲面图](../Images/ee094cbdcb2b1326bd04f770ea3ffdbf.png)

但是，如果由于某种原因我像这样对矩阵的子集进行曲面图：

```
surf(x y(1:31) z(1:31,:)) 
```

然后它起作用了，情节就出现了。 ![工作面图](../Images/f67f7bb4d26b60ee258f747e9754da69.png)

一旦我将括号中的数字增加到 32，它就会停止工作。如果我将范围从 2:32 更改，那么它可以工作，所以它与数据无关，只是矩阵的大小。

这里发生了什么？我如何解决它？

PS 我会附上代码，但它有点长和复杂，并导入 .txt 文件以加载到 x 和 y 向量中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T17:35:37.283

有时，它可以帮助更改 Matlab 的图形渲染器，它基本上是执行绘图的后端。选项有`painters`、`zbuffer`和`OpenGL`。

由于它是一个图形属性，您可以将其应用于特定图形，例如：

```
set(gcf(), 'Renderer', 'painters') 
```

或更新[默认图形属性](http://www.mathworks.nl/help/techdoc/creating_plots/f7-21465.html)（如果始终需要，您可以将其放在[用户特定的 startup.m](http://www.mathworks.nl/help/techdoc/ref/startup.html)中）：

```
set(0, 'Renderer', 'painters') 
```

同样，要获取当前的渲染器状态，请使用`get`代替`set`：

```
get(gcf(), 'Renderer') 
```

不同的渲染器具有不同的性能属性（例如`OpenGL`，如果支持，渲染器可以使用硬件加速），但也有不同的怪癖（根据我的经验，使用 getframe() 的帧捕获在使用远程桌面登录时适用于某些渲染器，但不是全部）。虽然我不知道您的问题的确切原因，但它可能是这些奇怪的怪癖之一，因此请尝试更改渲染器。

从[渲染器属性文档](http://www.mathworks.nl/help/techdoc/ref/figure_props.html#Renderer)：

> 用于丝网和印刷的渲染方法。选择用于渲染 MATLAB 图形的方法。选择是：
> 
> `painters`— 当图窗仅包含简单或小型图形对象时，MATLAB 使用的原始渲染方法更快。
> 
> `zbuffer`— MATLAB 更快、更准确地绘制图形对象，因为它按像素为对象着色，并且 MATLAB 仅渲染场景中可见的那些像素（从而消除了从前到后的排序错误）。请注意，如果 MATLAB 显示复杂场景，此方法会消耗大量系统内存。
> 
> `OpenGL`— OpenGL 是一种可在许多计算机系统上使用的渲染器。此渲染器通常比 Painters 或 zbuffer 更快，并且在某些情况下使 MATLAB 能够访问某些系统上可用的图形硬件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T16:49:47.177

查看沿左侧（y 轴）和顶部（z 轴）的轴的最小/最大值的变化。我认为它仍然存在，但它非常非常小。

尝试像这样设置轴： `axis([6E-6 8E-6 9.2E14 10E14 0.96 1.06 -1 1])`

注意：E-6 可能是 E-8，我无法从图像中分辨出来......

这是基于以下代码：`axis([xmin xmax ymin ymax zmin zmax cmin cmax])`

# database - 利用具有 3 个字段的主键？不确定我是否正确地查看了这个

> ID：11615922
> 
> 赞同：0
> 
> 时间：2012-07-23T15:46:00.983
> 
> 标签：database, sql-server-2008

这主要是一个设计问题：

好的，所以我正在尝试为包含类型和子类型的票证类型表创建关系。每个子类型对其父类型都是唯一的。我试图避免在票证表中同时包含这两个字段。我正在考虑使用自然键创建一个链接表，然后将该键放入票证表中，该键将指向类型和子类型的适当组合。

我关心的是保持这些组合的独特性。因此，例如，如果有人跳入表中（没有先做作业）并尝试添加类型 5、子类型 3 之类的组合，并且该特定组合已经存在，则 dbms 不应允许它，类似于主键.

所以我想知道创建一个使用自然键、类型 id 和子类型 id 的主键是否会很愚蠢（因为感觉就是这样）。似乎这无济于事，因为自然键最终会使每个条目都是唯一的，从而使每个条目都有效。

有一个更好的方法吗？不尝试约束这些链接/组合会更简单吗？我应该把这两个字段都放在票表中并把它吸起来吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:49:33.197

使用[UNIQUE 约束](http://msdn.microsoft.com/en-us/library/ms191166%28v=sql.105%29.aspx)来确保类型和子类型的组合是唯一的，然后为自然键使用单独的主键。

# jquery - 如何连接文本框以使用 jQuery 或 AJAX 在我的 ASP.NET 页面中动态运行搜索，就像 Google 的“即时预测”一样？

> ID：11615925
> 
> 赞同：0
> 
> 时间：2012-07-23T15:46:15.913
> 
> 标签：jquery, asp.net, search

我已经环顾四周，并且能够从各种来源收集一些线索。但是我一直无法找到可以帮助我从头到尾连接所有内容的资源。我希望我的页面与 Google 的 Instant Predictions 完全一样；当用户键入时，每次击键都会在 TextBox 下方动态显示一个列表。

我假设这使用了 AJAX 和 jQuery 的某种组合。

此外，这是标准的 WebForms，而不是 MVC。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:24:10.027

由于 Amiram 通过评论回答，我想我会在这里用他的回答回答我自己的问题。

答案是通过 AjaxControlToolkit 的 AutoCompleteExtender。谢谢阿米拉姆！！！

# performance - 使用按位运算符更改符号

> ID：11615927
> 
> 赞同：2
> 
> 时间：2012-07-23T15:46:21.920
> 
> 标签：performance, int, bit-manipulation

如何使用按位运算符更改 int 的符号？显然我们可以使用`x*=-1`or `x/=-1`。有没有最快的方法来做到这一点？

我做了一个小测试，如下所示。只是为了好奇...

```
public class ChangeSign {
    public static void main(String[] args) {
        int x = 198347;
        int LOOP = 1000000;
        int y;
        long start = System.nanoTime();
        for (int i = 0; i < LOOP; i++) {
            y = (~x) + 1;
        }
        long mid1 = System.nanoTime();
        for (int i = 0; i < LOOP; i++) {
            y = -x;
        }
        long mid2 = System.nanoTime();
        for (int i = 0; i < LOOP; i++) {
            y = x * -1;
        }
        long mid3 = System.nanoTime();
        for (int i = 0; i < LOOP; i++) {
            y = x / -1;
        }
        long end = System.nanoTime();
        System.out.println(mid1 - start);
        System.out.println(mid2 - mid1);
        System.out.println(mid3 - mid2);
        System.out.println(end - mid3);
    }
} 
```

输出几乎类似于：

```
2200211
835772
1255797
4651923 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-23T15:48:09.780

在几乎所有机器上，非浮点（例如 int 数学）加法/乘法和按位运算之间的速度差异都可以忽略不计。

没有一般的方法可以仅使用按位运算将 n 位有符号整数转换为其负等效项，因为求反运算看起来像`x = (~x) + 1`，它需要一次加法。但是，假设有符号整数是 32 位，您可能可以编写一个按位方程来进行此计算。**注意**：不要这样做。

否定一个数字的最常见、最易读的方法是`x = -x`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-23T15:51:36.347

Java 使用补码二表示。为了改变一个符号，这意味着你必须做一个按位否定（它相当于与 FFFF 的异或）并加 1。

```
x = ~x + 1; 
```

我几乎可以肯定`-x`，如果有的话，比这更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-05T07:04:04.887

使用高级语言的解决方案

像这样的问题在面试和竞争激烈的编程世界中很流行。

我来到这里研究更多不使用 - 或 + 运算符的否定数字解决方案。

为了这 ：

1.  使用 ~ 运算符补数
2.  然后使用半加法器逻辑将步骤 1 中获得的数字加 1：

    ```
    int addNumbers(int x, int y) { 
                if(y==0) return x; // carry is 0 return 
                addNumbers(x^y,(x&y)<<1); } 
    ```

这里 x^y 执行位相加， x&y 处理进位操作

# javascript - 您如何将单选按钮值添加在一起，但如果它们具有相同的值则区分它们？

> ID：11615929
> 
> 赞同：1
> 
> 时间：2012-07-23T15:46:28.680
> 
> 标签：javascript, forms

所以我正在制作一个订单表格，人们可以在其中选择不同数量的商品，然后使用 JS 计算总数。例如，您可以选择 2 顶棕色帽子（每顶 15 美元），总金额自动变为 30 美元。然后在 POST 页面中，我可以拉出文本框的名称并知道他们订购了 2 顶棕色帽子。

这是我的问题：我想设置一个单选按钮选项，允许他们只选择一个项目，并将其添加到最终总数中，如下所示：

```
<input type="radio" value="0" name="Syllabus" checked="No" /> Paper ($0)<br />

<input type="radio" value="0" name="Syllabus" checked="No" /> USB ($0)<br />

<input type="radio" value="20" name="Syllabus" checked="No" /> Both ($20)<br /> 
```

那么如果选择了“BOTH”，我如何使用 JS 将 20 美元添加到总数中？如果他们选择其他选项之一，那么当然会删除 20 美元。最后，如果他们确实选择了 PAPER 或 USB，我怎么知道他们在最终输出中选择了什么，因为无论哪种方式，值都是 0？

谢谢您的帮助！

------ 如果它对这里的任何人有帮助，是我用来添加其他文本框的值的代码，然后我用零填充总和并四舍五入 ------

```
// JavaScript Document

    function CalculateTotal(frm) {
    var order_total = 0

    var syllabuscost;

    var radios = document.getElementsByTagName('input');
    var radiovalue;
    for (var z = 0; z < radios.length; z++) {
        if (radios[z].type === 'radio' && radios[z].checked) {
            // get value, set checked flag or do whatever you need to
            radiovalue = radios[z].value; 

            //Change the syllabus cost depending on the value of the radio button
            if (radiovalue == "Paper" || radiovalue == "USB") {
                syllabuscost = 0
            }
            else if (radiovalue == "Both") {
                syllabuscost = 20
            }      
        }
    }

    // Run through all the form fields
    for (var i=0; i < frm.elements.length; ++i) {

        // Get the current field
        form_field = frm.elements[i]

        // Get the field's name
        form_name = form_field.name

        // Is it a "product" field?
        if (form_name.substring(0,4) == "PROD") {

            // If so, extract the price from the name
            item_price = parseFloat(form_name.substring(form_name.lastIndexOf("_") + 1))

            // Get the quantity
            item_quantity = parseInt(form_field.value)

            // Update the order total
            if (item_quantity >= 0) {
                order_total += (item_quantity * item_price)
            }
        }
    }

    // Display the total rounded to two decimal places Also added the syllabuscost to the total price!
    frm.TOTAL.value = round_decimals(order_total+syllabuscost, 2)
}
}

function round_decimals(original_number, decimals) {
    var result1 = original_number * Math.pow(10, decimals)
    var result2 = Math.round(result1)
    var result3 = result2 / Math.pow(10, decimals)
    return pad_with_zeros(result3, decimals)
}

function pad_with_zeros(rounded_value, decimal_places) {

    // Convert the number to a string
    var value_string = rounded_value.toString()

    // Locate the decimal point
    var decimal_location = value_string.indexOf(".")

    // Is there a decimal point?
    if (decimal_location == -1) {

        // If no, then all decimal places will be padded with 0s
        decimal_part_length = 0

        // If decimal_places is greater than zero, tack on a decimal point
        value_string += decimal_places > 0 ? "." : ""
    }
    else {

        // If yes, then only the extra decimal places will be padded with 0s
        decimal_part_length = value_string.length - decimal_location - 1
    }

    // Calculate the number of decimal places that need to be padded with 0s
    var pad_total = decimal_places - decimal_part_length

    if (pad_total > 0) {

        // Pad the string with 0s
        for (var counter = 1; counter <= pad_total; counter++) 
            value_string += "0"
        }
    return value_string
} 
```

和 HTML

```
<form>
<tr>
<th><label for="PROD_BrownShoe_175">Brown Shoe</label></th>
<td><input type="text" name="PROD_BrownShoe_175" onchange="CalculateTotal(this.form)" /> ($175) - Each</td>
</tr>
<tr>
<th><label for="PROD_BlackShoe_255">Black Shoe</label></th>
<td><input type="text" name="PROD_BlackShoe_255" onchange="CalculateTotal(this.form)" /> ($255) - Each</td>
</tr>
<tr>
<th><label for="PROD_BlueShoe_325">Blue Shoe</label></th>
<td><input type="text" name="PROD_BlueShoe_325" onchange="CalculateTotal(this.form)" /> ($325) - Each</td>
</tr>
<tr>
<th>Total $:</th>
<td><input type="text" name="TOTAL" onFocus="this.form.elements[0].focus()" /></td>
</tr>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T15:52:36.800

您可以将美元值存储在一个对象中。

```
var costs = {
    "paper" : 0,
    "usb"   : 0,
    "both"  : 0
}; 
```

单选按钮的值可以（并且应该）是唯一的。

```
<input type="radio" value="paper" name="Syllabus" checked="No" /> Paper ($0)<br />

<input type="radio" value="usb" name="Syllabus" checked="No" /> USB ($0)<br />

<input type="radio" value="both" name="Syllabus" checked="No" /> Both ($20)<br /> 
```

然后，在您的 CalculateTotal 函数中，引用`costs["paper"]`等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:50:49.170

出于这个确切原因，该*值*应该是*产品名称*而不仅仅是价格。

作为一种解决方案，您可以在由分隔符分隔的值字段中包含名称和价格，这将为您提供足够的信息：

```
<input type="radio" value="paper|0" name="Syllabus" checked="No" /> Paper ($0)<br />
<input type="radio" value="usb|0" name="Syllabus" checked="No" /> USB ($0)<br />
<input type="radio" value="both|20" name="Syllabus" checked="No" /> Both ($20)<br /> 
```

访问脚本中的值：

```
item_quantity = parseInt(form_field.value.split('|')[1]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T15:32:01.437

好的，实际上我走了一条不同的路线并解决了这个问题。我已经对其进行了设置，因此它只通过页面上的所有单选按钮，然后添加了一个片段，根据它是否找到值“paper”、“usb”或“both”来更改教学大纲成本。

如果我需要添加更多具有相同类型功能的单选按钮，这使我可以扩展整个事情。

可能有一种更清洁、更有效的方法来做到这一点，但这是我能想到的最好的方法。我得到的回应有点帮助，但并没有真正帮助解决问题。希望这对其他人有帮助。

# google-app-engine - 谷歌应用引擎 - 运行命令提示符

> ID：11615933
> 
> 赞同：0
> 
> 时间：2012-07-23T15:46:42.497
> 
> 标签：google-app-engine, command-line

我正在将 GAE 和 java 与 JDO 一起使用。我有服务器端代码，想从命令提示符运行它，而不是从浏览器启动（因为每次都运行浏览器来调试服务器端代码很乏味），但我该怎么做？，会是什么起点（启动 PersistenceManager，通过端口 8888 请求）？我正在寻找一些指导。

以下是我的服务器端代码，优化是我想从命令行调用的方法，它需要从本地应用程序引擎获取数据

```
@SuppressWarnings("serial")
public class OptimizerServiceImpl extends RemoteServiceServlet implements
    OptimizerService {

  public static void main(String args[])
  {
    System.out.println("comes in: ");
        optimize();

  }

  public String optimize(ModelRunDTO moDto)  
  {
        PersistenceManager pm = PMF.get().getPersistenceManager();
            Data data  = pm.getData(); // gets the data thru pm

     // all my logic goes here......

  } 
```

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T17:13:40.210

为了补充彼得上面的回答，如果您只是想测试和调试代码，您可能需要使用单元测试。本[文档](https://developers.google.com/appengine/docs/java/tools/localunittesting)介绍 Java App Engine 的本地单元测试。特别是，您将对[编写数据存储测试](https://developers.google.com/appengine/docs/java/tools/localunittesting#Writing_Datastore_and_Memcache_Tests)感兴趣，它使用数据存储的内存实现（并在测试之间刷新内容）。因为这些测试基于 JUnit，所以您可以从命令行或通过您选择的 IDE 运行它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:59:13.093

在 GAE 上调用任何东西的唯一方法是通过 HTTP 请求。例如，您可以从命令行（特定于操作系统）发出 HTTP 请求

```
wget http://yourapp.appspot.com/path 
```

# php - Gearman：还有没有办法从后台工作人员那里检索自定义数据？

> ID：11615941
> 
> 赞同：2
> 
> 时间：2012-07-23T15:47:17.227
> 
> 标签：php, gearman, asynchronous

首先，我知道[这个](https://stackoverflow.com/questions/7982450/gearman-sending-data-from-a-background-worker-to-the-client)问题：

*   [Gearman：从后台工作人员向客户端发送数据](https://stackoverflow.com/questions/7982450/gearman-sending-data-from-a-background-worker-to-the-client)

我想知道的是，Gearman 还是这样吗？我计划将一批图像 URL 从 PHP Web 应用程序发送到 gearman 工作器（也是用 PHP 编写的；我们称之为“主工作器”）以进行异步处理。然后，该工作人员将为每个图像提交一个单独的任务（通过 addTask()），调用 runTasks() 并等待任务完成，同时侦听异常，累积错误消息并更新整体作业状态。

虽然我完全可以使用 jobStatus() 调用从 Main Worker 检索整体状态，然后只说当返回 [false, false, 0, 0] 时所有图像都已处理，我*绝对*需要能够通知用户某些图像无法从其各自的 URL 检索或存储在服务器上。

我想我总是可以将自定义数据存储在 memcache 中，然后从网络应用程序中检索它，但它对我来说似乎“更脏”......

我不想得到任何结果，因为从我在php.net上的手册中看到的，即使是异常处理也只能在同步提交任务时完成，更不用说自定义数据检索了。我只是希望可能有一些我想念的东西。我没记错，我们使用的是带有 libgearman6 (v 0.27) 和 PHP 5.3.10 的 Ubuntu Server 12.04。gearman 扩展的版本是 1.0.2。我认为数据库在这里无关紧要，因为我不会在任何一个工人中使用它。而且我认为我们现在没有使用持久队列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T13:15:06.713

由于 Gearman 不会在任务完成后将任何任务信息保留在内存中（只需将其报告给同步任务），因此如果不将其存储在第 3 方位置，您将无法在 Web 应用程序中检索它。为此，我们通常在应用程序中使用简单的 Web 服务，让工作人员在任务完成或发生错误时回调应用程序。这允许我们保留业务逻辑，当此类错误发生在它所属的应用程序中时我们想要做什么，并让我们的工作人员更通用（我们可能需要在许多应用程序中调整图像大小，但有些应用程序可能需要启动几个子任务，这些子任务取决于首先完成的图像大小调整）。

在您编写时，您也可以让工作人员直接将任务状态写入数据库或写入 memcached，但我发现让应用程序本身处理逻辑而不必更改，特殊情况下工作人员工作得更好. 它也非常适合工作人员框架，让您在实际工作人员代码中保持相同的标准化方式处理回调。

# ruby-on-rails - Rails - 无法建立连接，因为目标机器主动拒绝了它。- 连接（2）

> ID：11615943
> 
> 赞同：0
> 
> 时间：2012-07-23T15:47:27.980
> 
> 标签：ruby-on-rails, http, url, connection, uri

我想将 POST/GET 从 Rails 应用程序发送到特定地址。但是，当我运行应用程序时，我收到错误消息：“无法建立连接，因为目标机器主动拒绝了它。-connect(2)”下面是我的代码：

```
 def show
    @uri = URI('example.com/getuser?user=bob&email=bob84@gmail.com')
    @profile = Net::HTTP.get(@uri)
    puts @profile
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T16:49:25.910

我将其标记为回复，以使其对将来可能来到这里的人更具可读性。这是在评论中首先回答的。

问题在于`URI`它不是以 HTTP 为中心的。所以需要指定协议。

以下作品：

```
 @uri = URI('http://example.com/getuser?user=bob&email=bob84@gmail.com') 
```

# php - 添加天数并保存到数据库时，php date() 不起作用

> ID：11615951
> 
> 赞同：2
> 
> 时间：2012-07-23T15:48:01.427
> 
> 标签：php, date, strtotime

我正在尝试创建一个日期并向其添加 3 天，然后将其保存到具有日期字段类型的 mysql 数据库中。

这就是我所拥有的。

```
date('Y-m-d', strtotime("+3 days")); 
```

然后我插入数据库。我最终得到 0000-00-00 而不是日期，但如果我将它回显出来，它看起来是正确的。

但是，如果我使用

```
date('Y-m-d') 
```

然后将其插入数据库，它工作正常。

任何帮助将不胜感激！

**编辑**

我发现做更多的调试，我的值没有被传递给我的查询，我之前没有抓住这个，因为我使用的是内置的 CMS 函数，它没有给我一个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:51:34.553

检查事项：

1.  `date('Y-m-d'`和`date('Y-m-d', strtotime('+3 days'))`（回显它们）的输出。
2.  显示您要插入此值的查询字符串，包括执行前查询的文件版本
3.  考虑为此切换到使用纯 MySQL 操作，.eg

    `INSERT INTO ... VALUES (now() + INTERVAL 3 DAY)`

相反，节省了从 native->string->native->etc 的一些往返...

# django - Django 的 CSRF 保护是这样工作的吗？

> ID：11615958
> 
> 赞同：10
> 
> 时间：2012-07-23T15:48:21.853
> 
> 标签：django, django-csrf

作为 cookie、CSRF 和 Django（使用 1.4）的初学者，据我所知，这是它的工作原理，请纠正我哪里出错了......

以下适用于 django.middleware.csrf.CsrfViewMiddleware 包含在 MIDDLEWARE_CLASSES 元组中的情况。

如果 POST 表单包含`csrf_token`标签，并且相关视图传递`RequestContext`给模板，则请求页面意味着 Django 包含一个包含字母数字字符串的隐藏表单字段。Django 还向浏览器返回一个名称设置为`csrftoken`和值设置为相同字母数字字符串的 cookie。

收到表单提交时，Django 检查隐藏表单字段中的字母数字字符串值是否与从浏览器接收到的 csrftoken cookie 匹配。如果它们不匹配，则会发出 403 响应。

CSRF 攻击可能以包含 iframe 的恶意网站的形式出现。iframe 包括一个 POST 表单和一些 JavaScript。表单的`action`属性指向我的 Django 站点。该表单旨在在我的站点上做一些讨厌的事情，并且 JS 在加载 iframe 时提交表单。

浏览器会`csrftoken`在表单提交的标题中包含 cookie。但是，表单不会包含具有匹配字母数字字符串的隐藏字段，因此返回 403 并且攻击失败。如果 iframe JS 试图访问 cookie，以创建正确的隐藏表单字段，浏览器会阻止它这样做。

它是否正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T01:23:14.280

我认为官方 Django 文档中描述了您想要的内容。 [https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#how-it-works](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/#how-it-works)

当我尝试时，上面的链接被破坏了，但对于 1.7 版，这有效： [https ://docs.djangoproject.com/en/1.7/ref/contrib/csrf/](https://docs.djangoproject.com/en/1.7/ref/contrib/csrf/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-23T05:30:19.940

我会说你是对的。你会在[这里](https://stackoverflow.com/questions/17958178/django-csrf-cookie-accessible-by-javascript/23821513#23821513)找到我自己的表述。

总结一下：

*   CSRF 令牌是从代码中发送的，这意味着恶意代码必须知道它。
*   CSRF 令牌存储在 cookie 中并由浏览器发送。
*   由于同源策略，攻击者无法访问cookie。
*   服务器可以简单地验证来自 cookie 的“安全”值是否与来自代码的值相同。

# android - 无法在设备上的 Android 4.1 上调试应用程序

> ID：11615965
> 
> 赞同：3
> 
> 时间：2012-07-23T15:48:31.073
> 
> 标签：android, debugging, intellij-idea, adb, android-4.2-jelly-bean

我在 MacOS 10.7 上使用 IntelliJ Idea 11 来开发和 Galaxy Nexus 设备进行测试。该应用程序面向 Android 2.3。

最近，我在 Galaxy Nexus 上更新了 JellyBean (4.1.1)（来自 Google 的官方更新，未植根/其他）。从那以后，我无法再在 Idea11 中正确调试该应用程序。该设备在 LogCat 中可见，但输出已更改：没有日志，没有消息，没有异常......我得到的只是：

```
GC_CONCURRENT freed 209K, 5% free 11729K/12295K, paused 11ms+12ms, total 44ms
[ 07-23 18:24:34.180  4425: 4425 D/dalvikvm ]
GC_FOR_ALLOC freed 53K, 3% free 10956K/11271K, paused 26ms, total 26ms
[ 07-23 18:24:34.180  4425: 4425 I/dalvikvm-heap ]
Grow heap (frag case) to 12.194MB for 1536016-byte allocation
[ 07-23 18:24:34.219  4425: 4429 D/dalvikvm ]
GC_CONCURRENT freed 1K, 3% free 12454K/12807K, paused 13ms+1ms, total 34ms
[ 07-23 18:24:34.274  4425: 4425 D/dalvikvm ] 
```

我在手机上启用了调试，“未知来源”，选择该应用作为调试应用。此外，当启用“等待调试器附加”时，应用程序将永远等待。不知何故，调试器无法附加......我无法弄清楚问题是什么。连接具有 Android 2.3 的设备时，调试按预期工作。我认为这是最新的 Android 更新的问题。我已将 SDK 管理器中的所有内容更新到最新版本。

欢迎任何帮助解决此问题。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T16:36:53.087

问题似乎出在 IDEA 11 上。升级到 IDEA 11.1.3 似乎已经成功了。它现在按预期工作（目前）。感谢 CrazyCoder 上面的有用评论。:)

# c# - 基于 XNA 体素的地形引擎有什么好的资源吗？

> ID：11615972
> 
> 赞同：0
> 
> 时间：2012-07-23T15:48:54.163
> 
> 标签：c#, 3d, xna, cube, voxel

我已经尝试了一周的游戏（XNA/C#），现在我已经到了创建地形的地步。我很可能会为此使用基于体素的引擎（类似于 Minecraft），实际上我已经尝试了很多玩 Cube 教程，但它们中的大多数都非常基础，对我没有多大帮助。现在我已经考虑了以下结构：

游戏 -> 处理主要任务。

**-->**调用世界级。**-->**

World -> 负责世界上发生的所有任务，保存区块数据。

**-->**放弃屏幕偏移后触发 Block 的 draw() 函数**-->**

Block -> 在正确的屏幕位置绘制方块，由 World 给出

但是，由于我需要渲染数千个块，这可能会非常困难，因为我没有 3D 编程经验。

使用 36 个（6 个边 x 6 个点代表 2 个三角形）索引方法是否仍然有效，因为我可以想象这会占用大量内存？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T20:30:26.570

您可以使用[techcraft](https://techcraft.codeplex.com/)地形引擎。

它是开源的，这意味着您可以编辑和贡献代码，而且它非常广泛，几乎任何人都需要开始。

除此之外，快速的谷歌搜索带来了许多资源，用于开始使用这种风格的游戏引擎。

# c# - 在 jquery 对话框中使用 Asp 按钮

> ID：11615975
> 
> 赞同：0
> 
> 时间：2012-07-23T15:49:07.570
> 
> 标签：c#, jquery, asp.net, dialog

当我在 modal 设置为“true”的 jquery 对话框中使用 Asp 按钮时，我的代码出现问题。

这是我的代码：

JS

```
$(document).ready(function () {
var dlg = $("#mws-jui-dialog").dialog({
    autoOpen: false,
    title: "Delete",
    modal: true,
    width: "640",
    minHeight : 160,
    minWidth : 170
});
dlg.parent().appendTo(jQuery("form"));

$("#btnDelete").bind("click", function (event) {
    $("#mws-jui-dialog").dialog("option", { modal: true}).dialog("open");
    event.preventDefault();
});
$("#btnClose").bind("click", function (event) {
    $("#mws-jui-dialog").dialog("close");
    event.preventDefault();
});
}); 
```

在我的 aspx 页面上：

```
asp:Button runat="server" ID="bidon" CssClass="mws-button green" OnClick="DeleteButton_Click" Text="Yes" 
```

在我的 cs 上：

```
protected void DeleteButton_Click(object sender, EventArgs e)
{
   Response.Redirect("mypage.aspx");
} 
```

当我将 modal 设置为 false 时，它​​工作正常，但据我所知，modal 禁用了我页面上的项目，我正在寻找一种在 modal 为 true 时使用我的 asp 按钮的方法（或者只是另一种修复它的方法） .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T18:41:45.460

我知道你的问题已经几个月了，但如果我理解正确的话......在你的`mws-button green`CSS 课上。包括`z-index:`属性并设置它`1000`。这将确保您的按钮位于模态 bkgd 的顶部。

```
.mws-button green
{
    z-index: 1000;
} 
```

让我知道这是否有帮助。

# java - 休眠一对一映射不更新 JoinColumn id

> ID：11615976
> 
> 赞同：1
> 
> 时间：2012-07-23T15:49:10.823
> 
> 标签：java, hibernate, struts2, hibernate-mapping, ibm-rad

不知道如何表达这个标题..所以我会慢慢地解决这个问题。

目前我正在开发一个使用`Struts2`和`Hibernate`. 网络上没有足够的文档涉及这 2 个。有很多关于它们的文档和教程，但很少一起使用。最多我只会找到有关如何集成它们的教程或通常只涉及一个表的简单 CRUD。

我现在拥有的是 2 张桌子，`Users`我`Profile`想同时更新这两张桌子。稍后我将对此进行更详细的介绍。

这是我的数据库表：

```
Users
--------------
UserID
Email
Password
Status
userType

Profile
--------------
ProfileID
UserID
Name
Interest
ProfileDetails 
```

我正在创建一个注册页面。在此页面中，用户将写下他们的姓名、电子邮件和密码。如您所见，名称在 Profile 表中。我可以将用户表上的电子邮件和密码以及名称插入到配置文件表中。问题是`UserID`没有被插入到 Profile 表中。

我的注册页面有这个表单，提交时将执行 addUser 操作。

```
<s:form action="addUser">
<s:push value="user">
    <s:hidden name="id" />
    <s:textfield name="profile.name" label="Name" />
    <s:textfield name="email" label="Email" />
    <s:password name="password" label="Password" />
    <s:submit />
</s:push>
</s:form> 
```

我的用户类：

```
@Entity
@Table(name="Users")
public class User implements Serializable {

private Long id;
private String email;
private String password;
private Boolean status;
private Boolean userType;
private Profile profile;

@OneToOne(mappedBy="user", cascade=CascadeType.ALL)
public Profile getProfile() {
    return profile;
}
public void setProfile(Profile profile) {
    this.profile = profile;
}
@Id
@GeneratedValue
@Column(name="USERID")
public Long getId() {
    return id;
}
public void setId(Long id) {
    this.id = id;
}

@Column(name="EMAIL")
public String getEmail() {
    return email;
}
public void setEmail(String email) {
    this.email = email;
}

@Column(name="PASSWORD")
public String getPassword() {
    return password;
}
public void setPassword(String password) {
    this.password = password;
}

@Column(name="STATUS")
public Boolean getStatus() {
    return status;
}
public void setStatus(Boolean status) {
    this.status = status;
}

@Column(name="USERTYPE")
public Boolean getUserType() {
    return userType;
}
public void setUserType(Boolean userType) {
    this.userType = userType;
}

public User() {}

public User(String email, String password, Boolean status, Boolean userType) {
    this.email = email;
    this.password = password;
    this.status = status;
    this.userType = userType;
}
} 
```

我的个人资料类：

```
@Entity
@Table(name="Profile")
public class Profile implements Serializable {

private Long profile_id;
private String name;
private String interest;
private String profile_details;
private User user;

@OneToOne(cascade=CascadeType.ALL, fetch=FetchType.EAGER)
@JoinColumn(name="USERID")
public User getUser() {
    return user;
}
public void setUser(User user) {
    this.user = user;
}
@Id
@GeneratedValue
@Column(name="PROFILEID")
public Long getProfile_id() {
    return profile_id;
}
public void setProfile_id(Long profile_id) {
    this.profile_id = profile_id;
}

@Column(name="NAME")
public String getName() {
    return name;
}
public void setName(String name) {
    this.name = name;
}

@Column(name="INTEREST")
public String getInterest() {
    return interest;
}
public void setInterest(String interest) {
    this.interest = interest;
}

@Column(name="PROFILEDETAILS")
public String getProfile_details() {
    return profile_details;
}
public void setProfile_details(String profile_details) {
    this.profile_details = profile_details;
}
} 
```

我的注释有问题还是我需要在表单中添加其他内容？如果您需要更多详细信息，请告诉我。

另外，如果您有关于 Struts2 + Hibernate 的更深入的教程，请告诉我..

加油！~

# blackberry - 在第一个单词之后提取超过 3 个单词

> ID：11615980
> 
> 赞同：1
> 
> 时间：2012-07-23T15:49:22.103
> 
> 标签：blackberry, java-me

在我正在开发的应用程序中，我需要从 a 中提取第一个单词`String`并将其放入 another`String`中，然后将其余单词放入 another 中`String`。我能够使用以下方法提取第一个单词：

```
String pString = "KOF0000094 Implementation:ListingRequest:User FO-Partner"
int spacePos3 = pString.indexOf(" ");
String pFirstWord = pString.substring(0,spacePos3); 
```

结果：KOF0000094

现在我希望将“Implementation:ListingRequest:User FO-Partner”放入另一个`String`.

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:54:09.840

最简单的解决方案，您已有的。

```
String restOfString = pString.substring(spacePos3+1) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-23T15:54:11.937

```
String pSecondWord = pString.substring(spacePos3 + 1); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-23T16:02:59.310

```
String whole = "KOF0000094 Implementation:ListingRequest:User FO-Partner";
String firstWord = "";  
String restOfWords = "";

int spacesIndex = whole.indexOf("   ", 0);
restOfWords = whole.substring(spacesIndex, whole.length());
restOfWords = restOfWords.trim();
firstWord = whole.substring(0, spacesIndex);
firstWord = firstWord.trim(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-23T15:53:29.183

尝试使用另一个对 substring() 的调用。你想要的字符串中第一个字符的索引是多少？最后一个字符的索引是多少？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-23T15:54:00.017

这是简单的字符串解析...只需找到第一个空格的第一个索引...即在 for 循环中...

```
if(string.charAt(i) == Characters.SPACE)
    indexOfSpace = i; 
```

那么你的第一句话就是

```
String part1 = string.substring(0,indexOfSpace); 
```

第二个字符串将是

```
String part2 = string.substring(indexOfSpace + 1); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-23T15:54:28.300

您已经有了第一个空格的索引，它标记了第一个单词的结尾，所以您需要做的就是立即从索引中取出子字符串（因此您不包括空格本身）到结尾字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-23T15:55:46.180

你可能最好使用 split 函数它看起来像这样：

```
String pString = "KOF0000094 Implementation:ListingRequest:User FO-Partner";        
String[] parts = pString.split(" ");
String partone = parts[0];
String partwo  = parts[1] + " " +parts[2]; 
```

或类似的东西，如果在第一个单词后面的部分中有更多的空格，你可以使用循环或类似的东西；

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-07-23T15:53:15.183

~~字符串类有一个拆分方法：[http](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split(java.lang.String) ://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split(java.lang.String )~~

~~如果您想获得所有单词，请使用它。~~

编辑：如评论中所述，`String.split`BB Java 不支持。

或者，如果您只想要第一个单词和字符串的其余部分：

```
int index=yourstring.indexOf(" ");
String firstWord = yourstring.substring(0,index);
String rest = yourstring.substring(index+1); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-23T15:54:22.243

例如，您可以使用拆分...

```
static String pString = "KOF0000094 Implementation:ListingRequest:User FO-Partner";
    static String[] pFirstWord = pString.split(" ");

/**
 * @param args
 */
public static void main(String[] args) {
    for(String word : pFirstWord) {
        System.out.println(word);
    }
} 
```

这回...

```
KOF0000094

Implementation:ListingRequest:User

FO-Partner 
```

所以最后一个字符串是 pFirstWord[1] + pFirstWord[2]

# c - 解析参数后缀乘数和单位，SCPI

> ID：11615982
> 
> 赞同：0
> 
> 时间：2012-07-23T15:49:25.567
> 
> 标签：c, parsing, lexical-analysis

我正在解析一个 SCPI 字符串，它看起来像：

`HEADER:HEADER:HEADER:CMD NUMBER MULTIPLIER UNIT;`

标记 NUMBER、MULTIPLIER 和 UNIT 之间的空格不一定存在，也不一定存在固定长度的标记。我已经能够解析（从 L 到 R）直到 NUMBER 的末尾。但是，MULTIPLIER 和 UNIT 标记都是可选的，并且可以具有相同的字符。

例如，后缀可以是“P”（其中 P 可以表示 pico [mult] 或 poise [unit]）

或“MA”（可以是兆 [mult] 或毫安 [mult-unit]）

有没有人有任何解析这种语法的经验，或者实际上有其他人对如何将它们解析成正确的标记有任何想法。

编辑：对于学究，我想这是比解析更多的词法分析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T16:15:25.733

也许在您的简单示例中，使用几个嵌套`if`的 s 会比尝试更强大的方法更容易，但如果您不想手动执行此操作，或者实际问题有点大，您可以尝试匹配您的使用正则表达式输入（标准词法分析器的东西）。

在 POSIX 系统上，您可以使用[`regexec`](http://linux.die.net/man/3/regexec).

编辑：如何使用`if`（和`select`）：

我假设你的输入是 in`text`并且你已经读到了 NUMBER 的末尾，所以你的 index`i`表明了这一点！

```
// helper function: find next non-whitespace character
char get_prev(char *text, int *end, int i)
{
    for (; *end > i; --*end)
        if (text[*end] != ' ' && text[*end] != '\t'
            && text[*end] != '\n' && text[*end] != '\r')
        // or `if (text[*end] > ' ')` if ASCII
            break;
    return text[(*end)--];
}

... your function...
    // read up to i
    int end = strlen(text);
    int power_of_10 = 0;  // for MULT
    enum unit unit = UNKNOWN; // for UNIT
    switch (get_prev(text, &end, i))
    {
        case 'P':
            unit = POISE;
            break;
        case 'A':
            unit = AMP;
            break;
        ...
        default: // unforeseen character
        case '\0':
            // neither UNIT nor MULT exist
            break;
    }
    if (unit != UNKNOWN)
        switch (get_prev(text, &end, i))
        {
            case 'M':
                power_of_ten = -3;  // milli
                break;
            case 'A':
                switch (get_prev(text, &end, i))
                {
                    case 'M':
                        power_of_ten = 6;  // mega
                        break;
                    ...
                }
                break;
            ...
            default: // unforeseen character
            case '\0':
                // MULT doesn't exist
                break;
        } 
```

Note, in this case, I assumed UNIT is mandatory. I'm not sure how you can distinguish between mega and milliamp in 10MA if both MULT and UNIT are optional. However you can add more cases to the first `switch`, that correspond to values of `MULT` and change `power_of_10` there to. For example, if in the first `switch` you see `k`, you can understand that `UNIT` doesn't exist and `power_of_10` is 3.

# ios - 为 iOS 自动编码视频（和创建参考电影）

> ID：11615984
> 
> 赞同：0
> 
> 时间：2012-07-23T15:49:31.003
> 
> 标签：ios, video, encoding, quicktime

我的 iPad 应用程序让用户能够观看数百个视频。目前，iPad 应用程序将它们指向一个 MP4 文件。但是，我想将它们指向 QuickTime 参考电影。（如果用户通过 3G 与 wifi 连接，这允许应用程序发送较低比特率的视频版本。）

现在，我通过转到文件 -> 导出到 Web 在 QuickTime 中创建各种版本以及参考文件。然而，这个过程 (1) 一次只允许我处理一个文件，并且 (2) 生成许多无用的东西，例如 HTML 和 JavaScript。

我怎样才能自动化这个过程？有谁知道现有的脚本/工具来完成这项工作？我敢肯定其他开发人员以前也必须这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T21:07:15.493

我编写了（并从网络上的其他东西拼凑而成）这个 AppleScript 来完成这项工作：

```
--property exportFolder : (path to documents folder as Unicode text) & "Your Folder:"
property QTExportPath : (path to movies folder from user domain)
property completedFolderName : "completion" -- this folder must already exist
property referenceFiles : {}
property encodeCount : 0

on run
    choose folder with prompt "Choose folder with video files:" -- with multiple selections allowed
    open (result)
end run

on open droppedItems

    tell application "Finder"
        set allFiles to every file of entire contents of droppedItems as alias list
    end tell

    -- Error checking
    repeat with testFile in allFiles

        set myChars to characters of basename(testFile)

        if count_matches(myChars, ".") > 1 then
            display dialog "ERROR: The file " & basename(testFile) & " has too many periods."
            return
        end if

    end repeat

    -- Made it past error checking, let's get started

    tell application "QuickTime Player"
        activate
        close every window
    end tell

    repeat with thisItem in allFiles

        tell application "QuickTime Player"
            close every window

            open thisItem as alias

        end tell

        activate application "QuickTime Player"
        tell application "System Events"
            tell process "QuickTime Player"
                keystroke "E" using command down
                repeat until exists sheet 1 of window 1
                    delay 0.2
                end repeat
                click button "Export" of sheet 1 of window 1
            end tell
        end tell

        tell application "Finder"
            set fileExt to name extension of thisItem
        end tell

        set fileBaseName to basename(thisItem)

        set lengthWithoutExtension to (count of fileBaseName) - (count of fileExt) - 1

        set fileBaseNameWithoutExtension to text 1 thru lengthWithoutExtension of fileBaseName

        set end of referenceFiles to fileBaseNameWithoutExtension

        repeat until startedExporting(fileBaseNameWithoutExtension)

            -- wait for this file to start exporting before beginning another

        end repeat

    end repeat

    repeat until doneExporting(referenceFiles)

        -- wait for exporting to finish

    end repeat

    cleanUpGarbage(referenceFiles)

    tell application "QuickTime Player"
        activate
        close every window
        quit
    end tell

    display alert "finished exporting"

end open

on basename(thePath) -- Returns basename of alias

    set thePOSIXPath to the POSIX path of thePath

    if thePOSIXPath ends with "/" then
        set nameIndex to -2
    else
        set nameIndex to -1
    end if

    set ASTID to AppleScript's text item delimiters
    set AppleScript's text item delimiters to "/"
    set thePOSIXPath to text item nameIndex of thePOSIXPath
    set AppleScript's text item delimiters to ASTID
    return thePOSIXPath
end basename

on startedExporting(fileBaseNameWithoutExtension) -- Checks if QuickTime began exporting a file

    set moviesPath to QTExportPath as text
    set fileToTest to ((the POSIX path of moviesPath) & fileBaseNameWithoutExtension & "/Resources/" & fileBaseNameWithoutExtension & ".mov")
    if FileExists(fileToTest) then
        -- do nothing
    else
        return false
    end if

end startedExporting

on doneExporting(referenceFiles) -- Checks if QuickTime is done exporting everything

    set moviesPath to QTExportPath as text
    repeat with thisItem in referenceFiles
        set fileToTest to ((the POSIX path of moviesPath) & thisItem & "/Resources/" & thisItem & ".mov")
        if FileExists(fileToTest) then
            -- do nothing
        else
            return false
        end if
    end repeat
end doneExporting

on FileExists(theFile) -- (String) as Boolean
    tell application "System Events"
        if exists file theFile then
            return true
        else
            if exists folder theFile then
                return true
            else
                return false
            end if
        end if
    end tell
end FileExists

on cleanUpGarbage(referenceFiles)

    set moviesPath to QTExportPath as text
    set donePath to (QTExportPath as text) & completedFolderName as text
    set POSIXMovies to the POSIX path of moviesPath
    set POSIXDone to the POSIX path of donePath

    repeat with thisItem in referenceFiles
        set directoryToClean to (POSIXMovies & thisItem & "/")
        set m4vcommand to "find '" & directoryToClean & "' -type f -iname '*m4v' -exec cp -n {} '" & POSIXDone & "' \\;"
        set movcommand to "find '" & directoryToClean & "' -type f -iname '*mov' -exec cp -n {} '" & POSIXDone & "' \\;"

        do shell script m4vcommand
        do shell script movcommand

        set thefolder to POSIX file directoryToClean

        tell application "Finder"
            delete thefolder
        end tell

    end repeat
end cleanUpGarbage

on count_matches(this_list, this_item)
    set the match_counter to 0
    repeat with i from 1 to the count of this_list
        if item i of this_list is this_item then ¬
            set the match_counter to the match_counter + 1
    end repeat
    return the match_counter
end count_matches 
```

它假设：

*   您开始的文件夹只有电影文件，并且您想要转换所有这些文件。
*   您已经通过手动导出到 Web 设置了您想要在 QuickTime 中的任何导出设置

它将一次导出一个。如果要同时转换多个，请将 `startedExporting`方法修改为仅检查文件夹而不是 .mov 文件（.mov 文件是最后生成的文件。）

# python - 条件检查序列

> ID：11615992
> 
> 赞同：1
> 
> 时间：2012-07-23T15:49:51.877
> 
> 标签：python, if-statement

我是论坛的新人，所以希望这个问题不是太初级或者以前有人问过。在 python 中编写一些代码时，我发现返回 true 或 false 的单个函数（这里称为 function1、function2 和 function3）将具有相同的输出写入屏幕，因此我想像这样将它们链接在一起；

```
if function1 or function2 or function3: 
    print "something" 
```

我知道 function3 会花费更多时间来运行，所以我想避免它。由于现在编写了条件，在我看来，如果 Python 首先将 function1 评估为 false，然后停止对其他条件的评估，因为它知道 if 条件已经被破坏，这对我来说会很棒。另一种可能性是在评估组合表达式的真值之前分别找到所有三个函数的返回值。有人知道 if 条件评估中的动作顺序吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T15:51:16.030

Python 已经通过一种称为[“短路”评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)的机制为您完成了这项工作。

如果在评估期间的任何阶段发现布尔表达式为 False（对于 an `and`）或 True（对于 an `or`），则不会评估表达式的其余部分，因为最终结果已经在该点确定。

所以你把东西放到你的布尔表达式中的*顺序**真的很*重要。

这非常有用，因为您可以执行以下操作：

```
if i != 0 and 2332.0 / i:
   ... 
```

避免用简单的表达式除以零（即，如果为零`and`，则永远不会发生除法）。`i`

另外，请注意：您确实需要`()`函数调用才能工作。

最后，这种短路评估并不是 Python 独有的，很多语言都这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-23T15:51:49.817

你所说的叫做“短路”，python确实做到了。

但是，我认为如果您希望它正常工作，您希望使用`and`运算符，而不是`or`作为`False or True`返回`True`而`False and True`返回`False`（无需查看第二个值）。为了完整起见，`True or False`返回`True`（无需查看`False`）。

此外，在您的示例中，您实际上并没有调用函数...在 python 中调用函数，您需要括号：

```
function1(args)  #for example 
```

# apache - Sqoop：找不到命令

> ID：11615997
> 
> 赞同：0
> 
> 时间：2012-07-23T15:50:17.097
> 
> 标签：apache, ubuntu, hadoop, hive, sqoop

我目前正在使用带有 Hadoop 1.0.3 的 Ubuntu 12.04。我最近手动下载了 sqoop 并在 /etc/environment 中给出了路径。但是我的终端说'sqoop：找不到命令'。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T20:10:54.790

执行`echo $PATH`以查看 Linux 搜索已执行二进制文件的目录。您应该`bin`在此路径中看到您的 sqoop 安装文件夹的子目录。例如，如果您已安装到`/usr/local/sqoop`，则您的路径应包含`/usr/local/sqoop/bin`.

如果您没有看到此设置，请在您`$PATH`配置的任何位置更改它，例如，如果您使用 bash，请在 .bash_profile 中进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T04:11:30.030

如果您正在安装 sqoop，通常可以在 /sqoop/bin/ 目录中找到可执行文件。你能检查一下，如果指定的路径是正确的。你也可以试试绝对路径 bin/sqoop

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-29T18:49:00.770

确保在 ~/.bashrc 文件中添加了这些条目

导出 JAVA_HOME="/usr/local/java/jdk1.7.0_71"
导出 PATH="$PATH:$JAVA_HOME/bin"

导出 SQOOP_HOME="/home/abhisr/sqoop-1.99.5-bin" 导出 PATH="$PATH:$SQOOP_HOME/bin"

# datetime - 如何在 Metro (C++/CX) 应用程序中解析日期？

> ID：11615998
> 
> 赞同：16
> 
> 时间：2012-07-23T15:50:19.023
> 
> 标签：datetime, microsoft-metro, windows-runtime, c++-cx

我有一个 C++/CX 应用程序正在处理文件中的一些数据。它有一个字符串，表示用于保存日期的文化，并且它有一些日期。我需要将它们从字符串转换为 Platform::DateTime。我听说 [Windows::Globalization::DateTimeFormatting](http://msdn.microsoft.com/en-us/library/windows/apps/br206828.aspx)是要使用的类，但我不知道如何使用它。有人有例子吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-23T22:05:51.193

WinRT 的 C++/CX 投影在许多方面与托管 (C#/VB) 投影不同，其中最主要的一种是基本类型的投影（例如`Point`、`Size`、`String`和`DateTime`）。

托管投影将这些类型投影为 .NET 类型（具有 BCL 的所有底层支持），而 C++ 投影通常最低限度地投影这些类型以进行互操作，期望用户依赖 C++ 库支持来获得更高级的功能。

因此，在 .NET 中，有符号的 32 位整数在 C++ 中变为 a `System.Int32`（及其相关`.Parse`功能）时，您会得到一个常规 C++ `int`，并期望使用 CRT 功能 ( `_wtoi`) 来完成类似的任务。这种差异通常会导致不同投影之间的“特征差距”，其中一个更痛苦的是处理`DateTime`结构（在 BCL 中有非常丰富的支持）。

我设法得到的解决方案是从`COleDateTime`类开始（通过包含 ATLComTime.h 找到）并开始`COleDateTime`-> `SYSTEMTIME`-> `FILETIME`-> `_ULARGE_INTEGER`-> `Windows::Foundation::DateTime`。这是一项严肃的体操，但该`COleDateTime`课程具有您需要的特定于语言的解析能力。

```
LCID lcid = LocaleNameToLCID(L"es-es", LOCALE_ALLOW_NEUTRAL_NAMES); //parse language tag to get locale ID

COleDateTime dt;
dt.ParseDateTime(L"12 enero, 2012 10:00:01", 0, lcid); //parse date string based on language

//get system time struct
SYSTEMTIME st;
dt.GetAsSystemTime(st);

//COleDateTime is in local timezone, DateTime is in UTC, so we need to convert
SYSTEMTIME st_utc;
TzSpecificLocalTimeToSystemTime(nullptr, &st, &st_utc);

//get filetime struct to get a time format compatible with DateTime
FILETIME ft;
SystemTimeToFileTime(&st_utc, &ft);

//use _ULARGE_INTEGER to get a uint64 to set the DateTime struct to
_ULARGE_INTEGER ulint = {ft.dwLowDateTime, ft.dwHighDateTime};

Windows::Foundation::DateTime wfdt;
wfdt.UniversalTime = ulint.QuadPart; 
```

我已经询问了有关`DateTimeFormatter`课程的信息，但文档不正确；它不支持解析并且不打算（仅格式化）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T11:53:09.727

会[`std::get_time`](http://en.cppreference.com/w/cpp/io/manip/get_time)做的伎俩？页面底部的示例建议您可以使用语言环境将日期字符串解析为[`tm`](http://en.cppreference.com/w/cpp/chrono/c/tm)结构。我想您可以然后将`tm`struct 转换为正确的 WinRT `DateTime`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-15T07:26:33.400

我使用这段代码：

`auto cal = ref new Windows::Globalization::Calendar(); cal->AddSeconds(additionalSeconds); return cal->GetDateTime();`

使用 Windows::Globalization::Calendar，您拥有所需的所有美好时光功能：[https ://msdn.microsoft.com/library/windows/apps/br206724](https://msdn.microsoft.com/library/windows/apps/br206724)