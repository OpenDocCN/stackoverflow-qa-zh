# StackOverflow 问答 000754000-000754999

# vb.net - 使用什么语言

> ID：754009
> 
> 赞同：3
> 
> 时间：2009-04-15T22:32:25.253
> 
> 标签：vb.net, visual-studio, vb6, desktop-application

我过去用 VB5（和一点 VB6）编程，在“编写代码”级别使用 MS Access，但这都是几年前的事了，我最近才使用 PHP。我想重新开始为 PC（Windows ......）编程，但不知道该去哪里选择语言。VB.Net？C＃？....有什么建议么？一些容易上手的东西，易于用于创建“小型”桌面实用程序之类的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T22:40:39.133

VB.NET 在概念上与 VB5/6 有很大的不同*，*因此使用全新的东西可能会更好。

另外，Jeff 说他放弃了 VB.NET，因为他很难找到像样的代码示例。C# 无处不在。

如果我在 .NET 中，我会使用 C#。我非常喜欢它，但后来我通过 Java 来到这里，没有大量的 VB 经验。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T22:50:17.457

冒着被否决的风险，我不同意许多 C# 和 VB.NET 的建议。虽然我使用过 C#（不是 VB.NET），它是一种非常令人印象深刻且用途广泛的语言/工具包，但如果我是你，我会尝试通过寻找具有良好跨平台可移植性的东西来拓宽你的视野，例如 Python。

它是一门有趣的语言，易于学习，培养良好的习惯，如果您发现自己在几年内寻找新工作，至少如果它是非 Windows 开发工作，那么您已经掌握了技能你可以参加聚会。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T22:36:42.870

我认为如果您过去使用过 VB6 和 Access，那么选择 VB.NET 应该是轻而易举的事。在许多方面，VB.NET 将让您做您以前做过的事情，但与过去相比，它具有更多的结构和“真实语言”的感觉，而不是“脚本”的感觉。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T22:35:00.083

.NET 语言 - VB.NET 或 C# 是个好主意。可用的信息很多，您可以免费获得 Express 版本。根据您以前的经验，VB.NET 可能更容易过渡。但请注意：C# 更受欢迎，这意味着有更多可用的工具和代码示例。

查看相关问题： [我应该选择哪种语言：vb.net 或 C#](https://stackoverflow.com/questions/132403/which-language-should-i-pick-up-vb-net-or-c)和 [使用统计：C# 与 VB.NET](https://stackoverflow.com/questions/210187/usage-statistics-c-versus-vb-net)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-23T11:43:03.277

如果您喜欢构建“小型”桌面实用程序，即不需要 .NET 框架即可运行的那种东西，您可能需要查看 BCX。这是免费的。

BCX 是一个小型命令行工具，可以输入 BCX BASIC 源代码文件并输出“C”源代码文件，该文件可以使用许多 C 或 C++ 编译器进行编译。

使用 BCX 和 C 编译器，您可以生成功能强大的 32 位本机代码 Windows 控制台模式程序、Windows GUI 应用程序和动态链接库 (DLL)，而无需承担昂贵的商业 BASIC 编译器的成本。您创建的程序将是最小和最快的 32 位可执行程序之一，不需要额外的分布式运行时模块。

网址：[http ://bcx-basic.sourceforge.net/](http://bcx-basic.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T22:36:03.950

如果您已经熟悉 vb5 和 vb6 并且您只是构建小型桌面实用程序，那么我会推荐 vb.net

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T22:41:08.150

如果您使用过 VB，VB.Net 似乎是自然的选择。

如果您想要专门用于创建简单桌面应用程序的东西，您可以查看带有[Tk](http://en.wikipedia.org/wiki/Tk_(computing))的脚本语言，例如 ruby​​ 或 python，这也可能让您改变学习具有不同功能的新语言。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T22:41:33.047

很可能 VB.NET 最适合您，尽管在为 Windows 编写时我更喜欢 C#，而当应用程序也必须在其他平台上工作时，我更喜欢使用 Qt 的 C++。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T22:41:33.123

传统观点认为程序员从 VB6 到 VB.NET 的“升级路径”……我不同意传统观点。我日复一日地使用 VB6 将近 10 年。现在我用 C# 很舒服。

与 COM（VB6 基于 COM）和 .NET 之间的概念差异相比，VB.NET 和 C# 之间的语法差异很小。另一方面，对 C# 有更好的支持（来自 MS 和社区）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T22:43:44.133

我衷心建议您尝试 C#。

虽然它可能比 VB.NET 更难上手，但我认为您会欣赏您生成的代码的可维护性所带来的好处。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-15T22:45:56.233

如果您以前使用过 VB5/6 和 VBA，对 VB.NET 应该会很熟悉。但是，VB 在第 6 版之后就变成了面向对象的，所以有一些新的东西需要学习。

如果你想扩展你的知识，C# 是一个不错的选择。

即使您想继续学习 VB.NET，我也建议您学习一些 C#。它们都使用 .NET 框架并编译成几乎相同的 IL 代码，因此您在 C# 中学习的大部分内容在 VB.NET 中也很有用。能够在它们之间进行翻译也非常有用，因为您可以使用任何一种语言的编码示例。

# ruby - 创建一个基于角色执行不同任务的 Capistrano 任务

> ID：754015
> 
> 赞同：17
> 
> 时间：2009-04-15T22:34:51.893
> 
> 标签：ruby, capistrano

我正在寻找一种方法来调用单个 Capistrano 任务来为不同的角色执行不同的事情。Capistrano 是否能够做到这一点，或者我是否为每个角色编写了特定的任务？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-15T23:31:54.580

在 Capistrano 中执行此操作的标准方法：

```
task :whatever, :roles => [:x, :y, :z] do
  x_tasks
  y_tasks
  z_tasks
end

task :x_tasks, :roles => :x do
  #...
end

task :y_tasks, :roles => :y do
  #...
end

task :z_tasks, :roles => :z do
  #...
end 
```

所以是的，您确实需要编写单独的任务，但您可以从父任务中调用它们，它们会适当地过滤。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-20T00:11:47.413

其实没有：

```
% cat capfile 
server 'localhost', :role2
task :task1, :roles=>:role1 do
  puts 'task1'
end
task :task2 do
  task1
end

% cap task2  
  * executing `task2'
  * executing `task1'
task1 
```

:roles 参数被进一步传递给运行命令等，但似乎并不影响任务是否被实际触发。

抱歉，没有找到对评论发表评论的方法，所以我在这里写了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T13:01:48.997

你也可以做

```
task :foo do
    run "command", :roles => :some_role
    upload "source", "destination", :roles => :another_role
end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-06T19:57:20.537

使用命名空间： [https ://github.com/leehambley/capistrano-handbook/blob/master/index.markdown#namespacing-tasks](https://github.com/leehambley/capistrano-handbook/blob/master/index.markdown#namespacing-tasks)

```
namespace :backup do

  task :default do
    web
    db
  end

  task :web, :roles => :web do
    puts "Backing Up Web Server"
  end

  task :db, :roles => :db do
    puts "Backing Up DB Server"
  end
end 
```

这些任务在 cap -T 中显示为

```
backup:default 
backup:web
backup:db 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-16T22:01:12.523

有一种方法，一种。检查：[http](http://weblog.rubyonrails.org/2006/8/30/capistrano-1-1-9-beta/) ://weblog.rubyonrails.org/2006/8/30/capistrano-1-1-9-beta/ ，您会看到您可以使用 ROLES 环境变量覆盖默认角色。

我有一个任务定义为：

```
desc "A simple test to show we can ssh into all servers"
task :echo_hello, :roles => :test do
   run "echo 'hello, world!'"
end 
```

该`:test`角色分配给一台服务器。

在命令行上，我可以运行：

```
[james@fluffyninja bin]$ cap echo_hello ROLES=lots_of_servers 
```

该任务现在将在lots_of_servers 角色上运行。

我还没有通过更新哈希验证这在 ruby​​ 脚本中是否有效`ENV`，但这是一个好的开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-11T20:05:02.413

仅作记录，这可能是使用 Capistrano 3 的解决方案：

```
desc "Do something specific for 3 different servers with 3 different roles"
task :do_something do
  on roles(:api_role), in: :sequence do
    # do something in api server
  end

  on roles(:app_role), in: :sequence do
    # do something in application server
  end

  on roles(:another_role), in: :sequence do
    # do something in another server
  end
end 
```

在应用程序服务器中执行“do_something”任务的服务器定义类似于：

```
server 'application.your.domain', user: 'deploy', roles: %w{app_role} 
```

然后就可以调用任务了（有几种方法），任务会根据“app_role”执行具体的指令。

# php - 如何控制 PHP 中出现的顺序？

> ID：754020
> 
> 赞同：0
> 
> 时间：2009-04-15T22:35:44.573
> 
> 标签：php, javascript, html

我目前有这样的页面设置：

```
PHP Variable Declarations
HTML header, then a form to submit GET query
The PHP that processes some stuff based on the GET data
a bit of JavaScript that makes a pretty graph from the retrieved, processed data 
```

我想要做的是在第一次加载页面时只显示表单，然后在输入查询时，让图表出现在页面底部。它使用了flot库，JS目前看起来是这样的：

```
<script id="source" language="javascript" type="text/javascript">   
$.plot($("#test"), [ [[0, 0], [1, 1]] ], { yaxis: { max: 1 } });
</script> 
```

我需要用一些事件处理程序或其他东西替换 $.plot 吗？我是一个彻头彻尾的JS新手！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T22:41:59.770

我个人会为此使用php（但我对JS很垃圾......所以我有偏见......=））

```
<?php

$formSubmitted = $_POST['formSubmitted'];

    if (!isset($formSubmitted)) { ?>
    <form method="post" enctype="form/multipart" action="<?php echo $_SERVER['PHP_SELF']; ?>">

    <input name="formSubmitted" id="formSubmitted" type="hidden" value="1" />

    ...

    </form>
                               <?php }

    else {

      // show the graph

         }

    ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T22:39:44.673

在您的文件中，您将需要以下内容：

```
<?php if ($someConditionalForTheForm) { ?>
<form>....</form>
<?php } else { ?>
<script id="source" language="javascript" type="text/javascript">   
$.plot($("#test"), [ [[0, 0], [1, 1]] ], { yaxis: { max: 1 } });
</script>
<?php } ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T22:50:21.247

在你的 PHP 中，先输出表单代码，然后查看表单是否已经提交：

```
if (isset($_GET['your_form_parameter'])) {
    also_output_the_JS_graph;
} 
```

这样表单将始终显示，并且仅在提交表单时显示图表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T23:34:17.523

.js（需要 jquery）

```
$(document).ready(function(){       
    $('#myformsubmit').click(function(){
        $.ajax({
            type: "GET",
            url: "/your_data_processing_file.php",
            data: "",
            success: function(result){
            $("#graph").html(result); 
                    /*
                     result is whatever you get from your script that handles 
                     your submited data
                     */
            }
        });
    });
}); 
```

.html

```
 <form id="myform">.....</form>
    <div id="graph"><!-- here i want my result appear after submit 
without reloading the page, i'm so 1337 --></div> 
```

To be even more cool, you could return json data as a result and take care of that via your graph js.

# ruby-on-rails - 在 Rails 中给嵌套路由一个别名

> ID：754026
> 
> 赞同：3
> 
> 时间：2009-04-15T22:39:10.930
> 
> 标签：ruby-on-rails, routes, alias

如果我想为控制器提供别名，我可以使用`map.resources :rants, :controller => 'blog_posts'`yoursite.com/rants 指向`blog_posts`控制器。

如何为嵌套资源提供别名，例如 yoursite.com/users/5/rants ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T07:43:55.940

您可能想尝试：

```
 map.resources :rants, :controller => 'blog_posts'
 map.resources :users do |users|
   users.resources :rants, :controller => 'blog_posts'
 end 
```

这将为您提供`yoursite.com/users/5/rants/`您正在寻找的网址，并将生成方便的方法（例如`users_rants_path(@user)`：）

希望这可以帮助。

# regex - 如何处理 Perl 正则表达式中的每个 ASCII 字符（包括正则表达式特殊字符）？

> ID：754028
> 
> 赞同：4
> 
> 时间：2009-04-15T22:39:22.037
> 
> 标签：regex, perl, ascii, split, csv

我在 Perl 中有以下代码：

```
if (index ($retval, $_[2]) != -1) {
    @fs = split ($_[2], $_[1]); 
```

`$_[2]`是分隔符变量，`$_[1]`是分隔符可能存在的字符串。（`$_[0]`在别处使用）您可能已经猜到这段代码在这些变量名的子例程中。

无论如何，关于我的问题，当我的分隔符是无害的`'a'`或者`':'`代码像它应该的那样工作时。然而，当它是由 Perl 正则表达式解析的东西时，比如一个`'\'`字符，那么它就不会像它应该的那样工作。这是有道理的，因为在 split 函数中 Perl 会看到如下内容：

```
split (/\/, $_[1]); 
```

这对它根本没有意义，因为它会想要这个：

```
split (/\//, $_[1]); 
```

因此，考虑到所有这些，我无法回答的问题是这样的：“我如何做到这一点，以便我输入的任何分隔符`$_[2]`或所有 ASCII 字符都被视为应该是的字符，并且不被解释为别的东西？”

提前致谢，

罗伯特

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-15T22:47:02.830

您可以使用[quotemeta](http://perldoc.perl.org/functions/quotemeta.html)正确转义`$_[2]`，这样它就可以在正则表达式中工作而不会被破坏。这应该这样做：

```
my $quoted = quotemeta $_[2];
@fs = split( $quoted, $_[1] ); 
```

或者，您可以在正则表达式中使用 \Q 来转义它。[请参阅perlre](http://perldoc.perl.org//perlre.html)中的“转义序列” 。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T22:46:46.030

```
split /\Q$_[2]/, $_[1] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T09:50:47.400

作为旁注，我怀疑`$_[1]`and`$_[2]`变量是指自动传入`@_`的子数组。

It's helpful - would have saved you quite some explaining here and made your code more understandable by itself - and common practice to use something like the following at the beginning of the sub:

```
sub mysub {
  my ($param1, $string, $delim) = @_;
  # ...
} 
```

# c# - 根据 Silverlight 中的内容自动调整 ComboBox 下拉列表

> ID：754035
> 
> 赞同：2
> 
> 时间：2009-04-15T22:41:37.663
> 
> 标签：c#, .net, silverlight, xaml, silverlight-2.0

我的 Silverlight UserControl 中有这个 ComboBox：

```
 <ComboBox  
            AutomationProperties.AutomationId="cmbProjects" 
            Grid.Row="0" 
            Grid.Column="2" 
            ItemsSource="{Binding Projects}"
            SelectedItem="{Binding SelectedProject, Mode=TwoWay}"
            Style="{StaticResource DefaultComboBoxStyle}"                       
            >
            <ComboBox.ItemTemplate>
                <DataTemplate>                   
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">
                            <TextBlock Foreground="DarkRed" AutomationProperties.AutomationId="{Binding Number}" Width="100" Margin="0" Text="{Binding Number, Converter={StaticResource StringFormatter},ConverterParameter='\{0\}'}" />
                            <TextBlock AutomationProperties.AutomationId="{Binding Description}" Text="{Binding Description, Converter={StaticResource StringFormatter},ConverterParameter='\{0\}       '}"  />
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox> 
```

填充组合框的大多数项目的长度超过了控件的宽度。当我下拉列表时，下拉列表会扩展，但不会完全扩展到项目内容的宽度，从而导致内容被水平滚动条剪裁。这不会发生在内容位于控件原始宽度内的完全相同的组合框上。

在 WPF 中，我可以简单地将项目容器的宽度设置为自动；在 Silverlight 中，这会导致灾难性错误。我可以将 with 设置为一个很大的数字，但无论宽度如何，滚动仍然会出现。此外，在 Silverlight 2 beta 2 中，有一个属性 DropDownWidth，其中一个选项是“自动”，我在 RTM 中看不到。

我可以通过一些技巧来解决这个问题，主要是隐藏水平滚动条并附加一堆字符，以便下拉菜单完全展开以显示项目内容。显然，这种 hack 并不理想。有没有人遇到过类似的问题？我是否缺少一些东西来强制组合框在没有滚动条的情况下完全展开？

ib。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T08:17:50.073

看来他们在 SL3 中修复了它。

如果您想调整 PopUp，您可以在 ComboBox 的控制模板中进行。在 Blend 中执行以下步骤：

1.  右键单击组合框
2.  选择“编辑控制部件（模板）”
3.  选择“编辑副本”

这将复制开箱即用的控件样式和模板，以便您可以将 ComboBox 的 PopUp 内的 ScrollViewer 调整为您想要的内容。

您可能想尝试我[在此处](https://stackoverflow.com/questions/799403/silverlight-combobox-number-of-items-shown-refresh/812266#812266)描述的解决方案。它详细说明了如何确保在添加或删除项目时更新组合框弹出窗口的高度和宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-10T10:43:53.750

您可以使用 ComboBox 控件的 MaxDropDownHeight 属性。

# javascript - 包含我的外部 javascripts 的最佳/最快方法是什么？我使用 jQuery

> ID：754041
> 
> 赞同：2
> 
> 时间：2009-04-15T22:43:43.900
> 
> 标签：javascript, jquery, jscompress

我的网站快完成了，目前正在优化它；我想知道包含所有外部 javascript 文件的最佳和最快的方法。我希望网站尽快下载，但它有很多（10 个左右）需要加载的外部 javascript 文件；有些是来自 Google 的 AJAX API 的 jQuery 库文件，有些是我的。

我确定我不久前读到我可以使用一些 javascript 代码调用所有外部脚本，实际上，从浏览器的角度来看，只调用一个外部文件。

你明白我的意思吗？

非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T22:52:10.963

1.  将所有 Javascript 合并到一个外部文件中（您可以动态执行此操作并保存缓存的结果）；
2.  缩小该文件；
3.  版本该文件（我为此使用预配置文件的 mtime）；
4.  如果客户端支持，Gzip 文件；和
5.  在文件上使用远期 Expires 标头。

您所指的（使用 Google 的 AJAX 库服务）是另一种处理此问题的方法，属于 CDN（内容交付网络）的标题。想法是文件存储在多个位置，客户端将下载最接近的文件（并将保存该结果）。

与其他技术结合起来很难或很尴尬，而且我发现以这种方式执行多个外部负载会完全削弱任何感知到的好处（除非那是您唯一的外部负载），所以我使用上面列出的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T22:54:12.347

我的猜测是将库文件合并为一个文件（谷歌托管的文件除外）。对服务器的每次调用都会占用相当多的资源，因此最好只调用一次。您甚至可以在线合并文件：

[http://yui.2clis.net/](http://yui.2clics.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T22:52:28.823

我建议将所有脚本合并到一个 JS 文件中，然后使用[YUI 压缩器](http://developer.yahoo.com/yui/compressor/)将它们打包成一个较小的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T22:50:16.147

要使用脚本浏览器无论如何都必须下载它们，所以我认为你如何称呼它们没有任何区别......除非你在服务器上使用压缩并在客户端解压缩。

# c# - Visual Studio - 从设计器窗口中删除自定义控件

> ID：754052
> 
> 赞同：0
> 
> 时间：2009-04-15T22:47:31.533
> 
> 标签：c#, visual-studio

我有一个用户控制面板，上面有两个按钮。其他用户控件继承自该控件，如果按钮应该可见，则将属性设置为 true。一切都按我想要的方式运行，但我正在寻找的是一种从设计器窗口中清除这些按钮的方法，以清除此属性为假的表单。

好像：

```
[DefaultValue(false)]
public bool ShowButtons{
  set
  { 
    mShowButtons = value;
    UpdateButtons();
  }
  get
  {
    return mShowButtons;
  }
} 
```

此属性显示在属性窗口中，并且按钮始终显示在设计器窗口中。当更改属性以使按钮从继承表单中清除时，是否有某种方法可以让设计人员对此进行评估？我找不到执行此操作的设计器属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T00:27:30.437

尝试添加`get`：

```
bool mShowButtons;
[DefaultValue(false)]
public bool ShowButtons
{
  get
  {
     return mShowButtons;
  }
  set
  { 
    mShowButtons = value;
    UpdateButtons();
  }
} 
```

现在，在设计器中编辑您的派生类时，选择派生时，您应该能够`ShowButtons`在属性窗口中看到一个属性`UserControl`。（除非您添加适当的属性，否则它将位于“杂项”部分）。如果您在那里设置它，它应该在设计器中产生适当的影响（假设 UpdateButtons() 函数的内容正常工作））。

属性必须是公共的并且具有 bot`get`和`set`才能在属性编辑器窗口中显示。一旦它是，然后在属性窗口中设置值将“保存”该设置为控件的资源/实现中的设计控件。

我经常使用这个功能来专门化派生的用户控件，所以我知道它应该适合你（尽管可能还有其他问题在起作用）。

# c# - WPF 图像源绑定

> ID：754059
> 
> 赞同：2
> 
> 时间：2009-04-15T22:49:58.533
> 
> 标签：c#, wpf, image, xaml, binding

我有一个`ListBox`with `ItemTemplate`s 和一些数据绑定，包括一个 Image。

在`ItemsSource`代码隐藏中设置。一切都按预期工作，直到应用程序尝试通过更新绑定到图像源的对象成员来更改图像的源。我究竟做错了什么？

这是 XAML：

```
<ListBox x:Name="myList" MouseDoubleClick="myList_MouseDoubleClick" ScrollViewer.VerticalScrollBarVisibility="Disabled">
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel Orientation="Vertical" />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Border BorderBrush="DarkGray" BorderThickness="1">
                <StackPanel Orientation="Horizontal" Width="100">
                    <Image Width="38" Height="38" Source="{Binding Path=icon}" />
                    <StackPanel Width="100">
                        <Label Content="{Binding Path=name}" />
                        <Label Content="{Binding Path=state}" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

代码隐藏的某些部分：

在`Window_Initialized`：

```
myList.ItemsSource = myLineList; 
```

在`myList_MouseDoubleClick`：

```
Line aLine = myList.SelectedItem as Line;
if (aLine != null) {
  aLine.icon = "idle.jpg";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T23:04:13.820

您的“Line”类是否实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)或使用依赖属性？它必须有某种方式来通知绑定“图标”属性的值已更改。

# opengl - 给定一些点的 3d 相机位置

> ID：754060
> 
> 赞同：3
> 
> 时间：2009-04-15T22:50:04.400
> 
> 标签：opengl, 3d, 3dcamera

嘿嘿，

我目前正在做一个项目，我需要放置相机，以便在不移动相机的情况下可以看到角色的完整动作。我有角色开始的位置，以及角色在所有三个方向（X、Y 和 Z）上移动的最大距离。我也有视野（90度）。

是否有一个方程式可以确定我需要将相机放置在哪里，这样它就不必移动就能看到完整的动作？

注意：这是使用 OpenGL。

澄清：摄像机应该在动作中的角色“前面”，而不是在上面。

它也将沿着地平面移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T23:30:33.723

如果您制作点的边界球，您需要做的就是将相机保持在大于或等于边界球半径/ sin（FOV / 2）的距离处。

例如，如果您有一个半径为 Radius 的边界球体和指定的视场 FOV，则您的相机只需位于“Dist”之外的点，指向边界球体的中心。

计算距离的公式为： Dist = Radius / sin( FOV/2 )；

对于任何方向的相机，这将适用于 3D。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T23:00:46.713

取从起点到终点的线段。通过线段的中点构造一个与该线段正交的平面。然后将相机放置在该平面中的某个位置，距离平面和直线的交点的距离大于以下距离。相机的向上矢量必须在平面内，并且水平视野必须为 90 度。

```
distance = sqrt(dx^2 + dy^2 + dz^2) / 2 
```

该摄像机位置的起点和终点都将位于视口的左边界或右边界，并且垂直居中。

另一种解决方案可能是编写一个函数，该函数获取屏幕上两个点的起点、终点和所需位置。然后只需求解相机变换的投影方程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T23:01:16.667

仅仅拥有 (X, Y, Z) 的最大范围是不够的，因为观察口本质上是金字塔形的，金字塔的顶点在眼睛的位置。

为了论证起见，我们假设所有的运动都在（X，Z）平面（即地面）内，并且眼睛沿Y轴在原点正上方10m处。

假设一个方形视口，在 90˚ 视野下，您可以沿 X 轴和 Z 轴从 ±10m 看到，但仅限于地面上的物体 (Y = 0)。一旦它们离开地面，您的视野就会缩小。如果距离地面 1m，那么您的 (X, Z) 范围仅为 ±9m。

很明显，一个真实的摄像机可以放置在场景中，面向任何方向。甚至相机的“滚动”角度也可以改变可见的程度。实际上有无限多个这样的相机点，因此您需要在一定程度上限制您的标准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T23:15:17.613

这取决于，例如，如果对象要在平面上移动，您可以将相机放置在限定其移动区域的球之外（这取决于 FOV 为 90 的事实，这是一个幸运的角度）。

如果对象要在 3D 中移动，那就更困难了。如果您指定对象移动的区域（立方体与球......）以及您希望从中看到它的方向，这将有所帮助。

# xml - Android XML 白皮书

> ID：754064
> 
> 赞同：3
> 
> 时间：2009-04-15T22:50:46.783
> 
> 标签：xml, android, mobile

我正在寻找有关 Android 使用 XML 的资源——不是如何使用，而是有关 Android 中的 XML 架构的技术文章或白皮书。为什么要按照它们的方式设计事物，考虑了哪些因素 - 所有这些都特定于 XML 部分。

如果这不可用，我也对 XML 在移动计算中的一般使用感兴趣。iPhone 是否以同样的方式使用 XML？

谁能指点我一些好的文章/网站/书籍/白皮书/视频？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T17:17:13.837

我不知道关于这个主题是否有任何已发表或公开可用的内容。您最好的选择是联系 Google 的一些 Android 人员，看看他们是否愿意发布任何内部规范。

# c++ - 有什么办法可以防止 Boost.Build 递归扫描头文件中的#include 指令吗？

> ID：754065
> 
> 赞同：5
> 
> 时间：2009-04-15T22:50:51.510
> 
> 标签：c++, dependencies, boost-build

有没有办法将 Boost.Build 递归扫描 #include 指令的头文件限制到特定目录或目录集？即我希望它只递归地扫描我的项目中的头文件。我知道它们的外部依赖项不会改变（而且作为 Boost 和 Qt，它们非常大）。我最终在依赖关系树中有大约 50,000 个目标，这需要一段时间来处理（即使没有文件实际更改，也会导致 1-2 分钟的构建时间）。

到目前为止我发现的唯一解决方案是利用 INCLUDE 环境变量（我正在使用 MSVC） - 这意味着 Boost.Build 不需要被告知包含路径（我正在使用该功能），因此将不要扫描它们。这似乎有点骇人听闻。

我觉得我必须遗漏一些明显的东西，因为我无法找到其他遇到类似问题的人，即使我几乎立即遇到了这个问题。我来的最近的地方就是[这里](http://www.nabble.com/BBv2-Slow-Startup-td20317427.html)。

从调试输出（bjam -d 3）来看，它还会多次扫描大多数头文件......我不知道这是否意味着它们被多次添加为依赖项，但肯定是加载的成本文件和扫描的全部内容必须加起来吗？

如果我可以告诉它不要费心扫描特定目录或目录集，我可以保证头文件不会更改，那将是完美的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-27T23:50:37.557

这个问题也发布在 Boost 邮件列表中，我们在这里得到了答案：http: [//lists.boost.org/boost-build/2009/04/21734.php](http://lists.boost.org/boost-build/2009/04/21734.php)。

所以到目前为止，答案似乎是，至少开箱即用，Boost.Build 没有这个功能，解决方案是根据您的需要自定义 Boost.Build，这有一定的意义。

但是，我仍然很好奇为什么这对人们来说不是一个更常见的问题。我看到缓存依赖项会减少时间，但是如果我们扫描*所有*外部库，我们最终会得到一个巨大的依赖项树，其中大部分是多余的吗？当我在做一个项目时，我根本不会经常更改第三方库，为它们的依赖检查付费似乎是一种耻辱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T19:24:09.077

您可能想查看替代构建工具，例如[SCons](http://www.scons.org/)。SCons 有一个模式*--implicit-cache*缓存隐式依赖项。这应该有助于您描述的场景。

[这是手册页](http://www.scons.org/doc/production/HTML/scons-man.html)的摘录。

> --implicit-cache
> 缓存隐式依赖项。这会导致 scons 使用上次运行时的隐式（扫描）依赖项，而不是扫描文件以查找隐式依赖项。这可以显着加快 SCons，但有以下限制： scons 不会检测对隐式依赖搜索路径（例如 CPPPATH、LIBPATH）的更改，这些更改通常会导致使用不同版本的同名文件。如果在隐式依赖搜索路径（例如 CPPPATH、LIBPATH）中比当前同名的隐式依赖更早地添加了新的隐式依赖，scons 将错过隐式依赖的更改。
> 
> --implicit-deps-changed
> 强制 SCons 忽略缓存的隐式依赖项。这会导致重新扫描和重新缓存隐式依赖项。这意味着 --implicit-cache。
> 
> --implicit-deps-unchanged
> 强制 SCons 忽略隐式依赖项中的更改。这会导致始终使用缓存的隐式依赖项。这意味着 --implicit-cache。

# winapi - Win32 重叠 I/O - 完成例程或 WaitForMultipleObjects？

> ID：754068
> 
> 赞同：20
> 
> 时间：2009-04-15T22:52:16.187
> 
> 标签：winapi, io, crystal-reports, io-completion-ports

我想知道哪种方法更快，为什么？

在编写 Win32 服务器时，我已经阅读了很多关于 Completion Ports 和 Overlapped I/O 的内容，但我没有阅读任何内容来建议哪组 API 在服务器中产生最佳结果。

我应该使用完成例程，还是应该使用 WaitForMultipleObjects API，为什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-16T07:22:02.953

您建议使用两种方法进行重叠 I/O 并忽略第三种方法（或者我误解了您的问题）。

当您发出重叠操作时，例如[WSARecv()](http://msdn.microsoft.com/en-us/library/ms741688(VS.85).aspx)，您可以指定一个包含事件的 OVERLAPPED 结构，您可以等待该事件发出信号以指示重叠 I/O 已完成。我假设这是您的 WaitForMultipleObjects() 方法，并且如前所述，这不能很好地扩展，因为您受限于可以传递给 WaitForMultipleObjects() 的句柄数量。

或者，您可以传递一个完成例程，该例程在完成时调用。这称为“可警报 I/O”，并要求发出 WSARecv() 调用的线程处于“可警报”状态，才能调用完成例程。线程可以通过多种方式将自己置于警报状态（调用 SleepEx() 或等待函数的各种 EX 版本等）。我在我面前打开的[Richter 书中](http://www.lenholgate.com/blog/2008/02/currently-reading-windows-via-cc.html)说：“我曾多次使用可警报 I/O，我将第一个告诉您可警报 I/O 是可怕的，应该避免”。够了，恕我直言。

还有第三种方法，在发出调用之前，您应该将要在其上执行重叠 I/O 的句柄与完成端口相关联。然后，您通过调用 GetQueuedCompletionStatus() 和循环来创建一个线程池，为该完成端口提供服务。您使用 OVERLAPPED 结构发出 WSARecv() 而其中没有事件，并且当 I/O 完成时，完成从您的 I/O 池线程之一上的 GetQueuedCompletionStatus() 弹出并可以在那里处理。

如前所述，Vista/Server 2008 已经稍微清理了 IOCP 的工作方式，并消除了您必须确保发出重叠请求的线程继续运行直到请求完成的问题。可以在[此处](http://www.lenholgate.com/blog/2008/02/major-vista-overlapped-io-change.html)找到指向该参考的链接。但无论如何，这个问题很容易解决；您只需使用与完成相同的 IOCP 将 WSARecv 编组到您的 I/O 池线程之一...

无论如何，恕我直言，使用 IOCP 是进行重叠 I/O 的最佳方式。是的，在开始时了解调用的重叠/异步性质可能需要一些时间，但这是非常值得的，因为系统可以很好地扩展并提供一种简单的“即发即弃”方法来处理重叠操作。

如果你需要一些示例代码来帮助你开始，那么我有几篇关于编写 IO 完成端口系统的文章和一堆免费代码，它们为高性能服务器提供了一个真实的框架；看[这里](http://www.serverframework.com/products---the-free-framework.html)。

作为旁白; 恕我直言，您真的应该阅读 Jeffrey Richter 和 Christophe Nasarre 所著的“ [Windows Via C/C++ (PRO-Developer)](http://www.amazon.co.uk/gp/product/0735624240?ie=UTF8&tag=ramcom-21&link_code=as3&camp=2506&creative=9298&creativeASIN=0735624240) ”，因为它涉及您需要了解的有关重叠 I/O 和大多数其他高级 Windows 平台技术和 API 的所有信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T23:02:51.107

`WaitForMultipleObjects`仅限于 64 个句柄；在高度并发的应用程序中，这可能成为一个限制。

完成端口更适合具有线程池的模型，所有线程池都能够处理任何事件，您可以将自己的（非基于 IO 的）事件排队到端口中，而等待则需要编写自己的代码机制。

然而，完成端口和基于事件的编程模型是一个更难以真正解决的概念。

我预计不会有任何显着的性能差异，但最终您只能进行自己的测量以反映您的使用情况。请注意，Vista/Server2008 对完成端口进行了更改，即现在不需要原始线程来完成 IO 操作，这可能会产生更大的差异（请参阅 Mark Russinovich 的这篇[文章](http://technet.microsoft.com/en-us/magazine/2008.03.kernel.aspx)）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-12-06T08:34:31.600

*《Microsoft Windows 网络编程，第 2 版*》一书中的表 6-3比较了通过完成端口与其他技术的重叠 I/O 的可伸缩性。在吞吐量方面，完成端口将所有其他 I/O 模型从水中淘汰，同时使用更少的线程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T07:49:45.927

WaitForMultipleObjects() 和 I/O 完成端口之间的区别在于 IOCP 可以扩展到数千个对象，而 WFMO() 不会也不应该用于超过 64 个对象（即使您可以）。

您无法真正比​​较它们的性能，因为在 < 64 个对象的域中，它们本质上是相同的。

然而，WFMO() 会对其对象进行循环，因此具有低索引号的繁忙对象可能会使具有高索引号的对象饿死。（例如，如果对象 0 不断关闭，它将使对象 1、2、3 等饿死）。这显然是不可取的。

我写了一个 IOCP 库（用于套接字）来解决 C10K 问题并将其放在公共域中。我能够在 512mb W2K 机器上获得 4,000 个套接字同时传输数据。（如果它们空闲，您可以获得更多的套接字 - 繁忙的套接字会消耗更多的非分页池，这是您可以拥有多少个套接字的最终限制）。

[http://www.45mercystreet.com/computing/libiocp/index.html](http://www.45mercystreet.com/computing/libiocp/index.html)

API 应该为您提供您所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T22:57:35.240

没有把握。但我使用 WaitForMultipleObjects 和/或 WaitFoSingleObjects。这很方便。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T22:57:39.810

任何一种常规工作都有效，我真的不认为一个比另一个更快。

这两种方法的存在是为了满足不同的编程模型。WaitForMultipleObjects 用于促进异步完成模式（如 UNIX select() 函数），而完成端口更倾向于事件驱动模型。

我个人认为 WaitForMultipleObjects() 方法可以使代码更清晰，线程更安全。

# sql-server - 确保 SQL 中的线程同步可能？

> ID：754070
> 
> 赞同：0
> 
> 时间：2009-04-15T22:52:44.517
> 
> 标签：sql-server, sql-server-2005, multithreading

如果我有几个 SP

```
SP1
SP2
some_inline_queries

```

如何确保它们同时运行而不受其他线程的干扰？是否可以从 SQL Server 级别执行此操作？

编辑：

假设我们有一个包含 3 个主要操作的主脚本：

**sp1**扫描表 t1 以生成一个随机字符串，该字符串对 t1 中的 c1 列是唯一的；

**sp2**做了一些相当密集的工作；

**某语句**将 sp1 返回的随机字符串插入到表 t1 的 c1 中。因此，如果我同时运行这个主脚本的多个实例，我需要 t1.c1 中的所有内容在所有脚本完成运行时都不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:56:18.170

If I'm understanding you right, you want to [set the transaction isolation level](http://msdn.microsoft.com/en-us/library/ms173763.aspx) to SERIALIZABLE. Assuming MSSQL has true serializability (it might not; true serializability is rarely needed and often quite costly to implement), this will guarantee that even if you execute many transactions at once, the end result will be identical to executing one (though *which* one is usually non-deterministic), waiting for it to finish, then executing another transaction, and so on. Be careful, though: there are often subtle "bugs", be they actual bugs or misfeatures, in database SERIALIZABLE implementations, since this stuff is really tricky to get right. Especially nasty is the fact that some MVCC-based databases (Oracle and PostgreSQL use MVCC, and I know the Postgres lists were recently discussing these issues with their DBMS) don't really implement SERIALIZABLE perfectly, going instead for what should be called SNAPSHOT isolation -- this gives 99% of the benefits of SERIALIZABLE with minimal performance hit, but that's no good if you fall into that 1%.

If SERIALIZABLE is not an option, either because it doesn't do what you want or for some other reason, you can always have each SP take an exclusive lock before doing its dirty work. This might lead to deadlocks or timeouts and require other tuning elsewhere, so it's kind of an ugly option, but it should do the job.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:38:41.017

你在事务中运行它们吗？不确定您所说的“中断”是什么意思，但假设它们在以下范围内是安全的：

```
Begin Transaction MyTranNameHere
exec sp1
exec sp2
some statement
Commit Transaction MyTranNameHere 
```

# java - 运行探查器阻止 SQL Server 2000 阻塞？

> ID：754071
> 
> 赞同：1
> 
> 时间：2009-04-15T22:53:08.697
> 
> 标签：java, sql, sql-server

我们正在开发一个从 Forte 应用程序转换而来的大型 Java 程序。白天，我们在服务器中收到 Blocking SPID。我们昨天拜访了 DBA，他设置了一个配置文件模板来运行以捕获锁定/阻塞操作。当我们运行这个配置文件时，阻塞问题就消失了。为什么？

该应用程序使用 RMI 分发，大约有 70 个用户。我们使用 SQL 2000 和 windows 2000 服务器来保持与一堆旧的 VB 帮助应用程序的兼容性。

我们已将阻塞追踪到特定屏幕和存储过程，但现在我们无法在探查器运行时发生错误。

谢谢你的帮助！

西奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:57:42.677

好的老海森堡调试器问题。

任何分析器都会做两件事：它添加代码以调用调试器，并存储数据。第一个可以阻止优化器，第二个可以改变某些事情的时间，导致竞争条件消失。

这种阻塞 SPID 问题似乎经常出现在 Google 上。原因似乎是当另一个资源需要它时某个资源被锁定时会发生这种情况，因此听起来很可能是时序错误。

微软[有一篇](http://support.microsoft.com/kb/224453)关于如何处理这个问题的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T06:28:07.277

只是随机想法的集合..我已经看到跟踪导致服务器停机，但从未让事情变得更好。

您使用的是什么跟踪模板？（这些取自 SQL Server 2005 工具，抱歉）

*   “标准（默认）”跟踪高级呼叫和登录/注销
*   “TSQL_SPs”跟踪语句调用，这将更具侵入性

它也是二进制的和保证的吗？Trace on=没有block，trace off=block，还是不幸的巧合？当你们都在看 DBA 时，是否有人停止点击客户端并前来观看？

作为跟踪的一部分，是否有其他东西被关闭。也就是说，您使用的是探查器还是脚本跟踪（大量`sp_trace_set%`语句）？在脚本跟踪中，可能有一些东西会关闭其他东西。

# linq - 有人最近有关于 Linq to XSD 的可靠消息吗？

> ID：754078
> 
> 赞同：0
> 
> 时间：2009-04-15T22:57:49.247
> 
> 标签：linq, xsd

还是有相同目标的项目？也许可以使用 IQueryable 提供程序。我要求太多了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-29T18:21:20.310

XmlGen# 是我开始的一个项目，它与 LINQ to XSD 和 .NET 的内置 xsd.exe 实用程序具有相似的目标。

[单击此处获取 CodePlex 上托管的 XmlGen# 的链接](http://www.codeplex.com/xmlgensharp)

# svn - 在 Subversion 中跨分支合并并不是添加所有新文件。为什么不？

> ID：754082
> 
> 赞同：25
> 
> 时间：2009-04-15T22:59:34.720
> 
> 标签：svn, merge, branch

我在 subversion 中有一个源代码树，有几个分支。我刚刚在一个活跃的分支中完成了一个相当激烈的调试会话，现在需要将更改合并到新分支。最近，在旧分支中的所有开发之后（显然）但在我提交所有调试之前，新分支已从主干（代表已发布的代码）中删除。`svn merge`但是，尝试*不会*合并所有已添加的文件。它增加了一些，但不是全部。

这是时间线：

*   分支出主干以创建分支 dev1。
*   dev1中的代码，修改文件和添加文件。
*   分支出主干以创建分支 dev2。
*   dev1 中的错误修复，修改文件但不添加文件。
*   将 dev1 中的所有更改合并到 dev2。

正如预期的那样，有很多变化，包括新文件，但不是全部。是因为我要合并的版本范围包括创建 dev2 分支的版本吗？还是我应该合并到主干，然后再合并到 dev2？

**编辑：**所有代码都完全提交到 Subversion。但我认为可能发生的是文件添加不会通过合并传播。也就是说，之前*与*dev1 的合并添加了一些文件，但*来自*dev1 的合并包含来自先前合并的提交*不*包括添加的文件。

但我还在检查。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-22T01:06:47.030

以下陈述不正确：

> 添加到分支然后在分支上更改的文件在跨多个修订版进行合并时不会被添加

这意味着合并完全被破坏了。

当您进行合并时，您需要确保您确实合并了创建文件的修订版，否则您将收到关于没有目标的警告。

要注意的另一件事是，如果您合并到工作副本中，然后决定您对它不满意并恢复所有内容，新添加的文件仍将在工作副本中，因此如果您再次合并，未版本化的文件将阻止新文件的合并，因此您会错过它们。因此运行“svn status”并删除未版本控制的文件将确保合并正常工作。

不应添加有关添加空文件的注释，因为这样新文件就没有它来自何处的历史记录。换句话说，它不是一个副本，所以“svn log”不会显示它的历史。最后，如果文件是一张千兆字节的照片，你不会想将它合并到一个新文件中，因为这样存储库就会有两个完全相同的上下文副本。与历史记录合并和复制可以节省存储库存储（至少在放入 rep-sharing 之前）。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2010-04-19T17:33:39.010

我一直都知道 svn 警告是颠覆的迹象，表明你搞砸了。然后我遇到了上述情况，我从一个分支的合并中得到了很多跳过的文件，但我知道我有正确的合并路径。跳过的文件是在分支上添加和更改但在主干上尚不存在的所有文件。

然后我意识到所有这些文件已经存在，虽然没有版本，在我的主干工作副本上——我在一周前进行了测试合并（不是试运行）并恢复，但这些文件从未被我的 SVN 物理删除客户。一旦我从我的主干工作副本中物理删除它们，问题就消失了！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T23:28:28.363

添加到分支然后在分支上更改的文件在跨多个修订进行合并时不会被添加，因为 subversion 试图将上下文差异应用于工作目录中不存在的文件（新文件）。您将看到来自 svn 的警告，说明类似“跳过丢失的文件 blah.c...”

有两种基本的方法来处理这个问题。提交你的分支（这总是一个好主意，因为合并有时会搞砸事情，而且简单地能够恢复会更好），然后合并每个添加文件的特定修订（一次一个）以确保文件实际上被添加到您的工作目录中。

您拥有的另一个选项是为在修订中添加的所有文件创建空文件（例如，使用 unix touch 命令）（您可以通过简单地与 --dry-run 进行合并来获取这些文件的列表说明符并记下所有“跳过丢失文件”警告），然后与整个修订列表运行合并（如 -r 1023:1040）。这会将更改合并到新的空文件中，并且一切都应该是桃色的:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-07T10:10:53.067

（由于这似乎是搜索此问题时的最高帖子，因此我将评论导致相同行为的另一个可能原因）。

就我而言，我试图合并的修订版中的一些更改已经由另一个开发人员**手动合并并****在以前的修订版中**提交。SVN 注意到更改已经合并并且没有列出合并中的文件。

在这种情况下，您只需验证文件确实正确合并并正常继续。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-11T06:45:23.387

首先很简单，您需要慢慢合并分支，我的意思是先进行几个修订，然后再进行其他几个修订，依此类推。

当您完成所有修订后，只需单击 svn 中的添加文件按钮，我使用 RapidSVN。它很容易使用。

注意：添加到分支然后在分支上更改的文件在跨多个修订进行合并时不会被添加，因为 subversion 试图将上下文差异应用于工作目录中不存在的文件（新文件）。

您将看到来自 svn 的警告，说明类似“正在跳过丢失的文件...”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-08T09:47:33.167

一些工作可以帮助你：

1.  当你安装 Tortoise SVN 时，不要忘记启用**命令行客户端工具**（更多细节[在这里](https://stackoverflow.com/questions/1625406/using-tortoisesvn-via-the-command-line)）。
2.  创建一个空文件夹。
3.  打开记事本，然后复制下面的代码并保存为**Get_all_modified_files.bat**
    `@echo off set SRC_PATH=%1 set /a COUNTER=1 :SET_DES_DIR set DES_PATH=%SRC_PATH%_%COUNTER% if exist %DES_PATH% ( set /a COUNTER=%COUNTER% + 1 goto :SET_DES_DIR ) :GET_MODIFIED_FILES pushd %1 svn st | find "M" > LIST_FILES for /f "tokens=2" %%b in (LIST_FILES) do ( echo f | xcopy "%SRC_PATH%\%%b" "%DES_PATH%\%%b" ) del LIST_FILES popd pause`
4.  打开记事本然后复制下面的代码并保存为**Install.bat**

    `@echo off setlocal enabledelayedexpansion :PREPARE if exist Install.reg del Install.reg if exist Uninstall.bat del Uninstall.bat if exist LIST_FILES del LIST_FILES :GET_DETAIL dir "%0\.." /s /b /o:gn > LIST_FILES set /a COUNTER=1 for /f "tokens=*" %%b in (LIST_FILES) do ( if !COUNTER! == 1 set Get_all_modified_files=%%b set /a COUNTER=!COUNTER! + 1 ) set Get_all_modified_files=!Get_all_modified_files:\=\\! set Get_all_modified_files=@="!Get_all_modified_files! %%1" :CREATE_INSTALL_FILE echo Windows Registry Editor Version 5.00>>Install.reg echo. >>Install.reg echo [HKEY_CLASSES_ROOT\Directory\shell\Get modified files]>>Install.reg echo. >>Install.reg echo [HKEY_CLASSES_ROOT\Directory\shell\Get modified files\command]>>Install.reg echo !Get_all_modified_files!>>Install.reg echo @echo off>Uninstall.bat echo echo yes ^| reg delete "HKEY_CLASSES_ROOT\Directory\shell\Get modified files">>Uninstall.bat echo set ^/p BYE^=Enter any key to exit...>>Uninstall.bat :RUN_AND_REMOVE regedit /s Install.reg if exist Install.reg del Install.reg if exist LIST_FILES del LIST_FILES endlocal :INSTRUCTION echo - Setting done! Using uninstall.bat to remove this feature. echo - In order to use: echo 1.Right-click on which folder you want export files echo 2.Select 'Get modified files' to run command. echo 3.It will create and copy modified files into new folder. set /p BYE=- Hoping it useful! Good bye!`

5.  通过右键单击以管理员身份运行**Install.bat文件以添加注册表此命令。**

6.  现在，您可以通过右键单击要获取所有文件的 SVN 文件夹并选择**Get all modified files** in menu 来获取所有修改的文件。

希望我的代码对你有用！

# ruby-on-rails - 指向同一个数据库的多个 Rails 站点

> ID：754083
> 
> 赞同：1
> 
> 时间：2009-04-15T22:59:41.850
> 
> 标签：ruby-on-rails, ruby, migration

我想在同一个数据库上运行两个 Rails 网站（主页和应用程序）。但是，迁移不起作用，因为两个网站都尝试同时使用 schema_migrations 表。

是否可以覆盖默认的 schema_migrations 表名？任何其他想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T23:13:47.883

schema_migrations 表名保存在 中`ActiveRecord::Migrator.schema_migrations_table_name`，您*可能*可以覆盖它（在 environment.rb、初始化程序等中），但我没有尝试过。

另一方面，如果您在两个应用程序中都使用唯一的迁移 ID（我认为默认为 2.1 及更高版本），则来自两个应用程序的迁移应该使用单个 schema_migrations 表。

有关迁移如何在 Rails 2.1 及更高版本中工作的更多信息，请参阅[此截屏视频。](http://railscasts.com/episodes/107-migrations-in-rails-2-1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-29T18:20:21.413

我不知道这是什么时候添加的，但 Rails 4 现在似乎支持它。

来自[Rails 文档](http://guides.rubyonrails.org/configuring.html)

> config.active_record.schema_migrations_table_name 允许您设置一个字符串以用作模式迁移表的名称。

如果您使用的 Rails 版本不支持此功能，则另一种方法是使用 table_name_prefix。如果您使用这种方法，我会通过查看源代码来确保您的 Rails 版本使用 table_name_prefix 为模式迁移添加前缀。

# windows - 从 VPC 虚拟机内的 TS 框更改域密码

> ID：754096
> 
> 赞同：2
> 
> 时间：2009-04-15T23:03:27.783
> 
> 标签：windows, passwords, virtual-pc

我正在运行一个以 Windows2003 作为操作系统的 VirtualPC 2007 VM。在此内部，我使用基于 Web 的 VPN 连接到我客户的网络。我不能在我的主机上使用这个 VPN，因为它不能与 Vista 一起使用（仍然！）。在虚拟机内部，我正在使用他们的域登录到客户端站点上的终端服务器。

我需要更改我的密码。显然，您通常会做的是按 ctrl-alt-del 并单击更改密码。但是，由于我在 VM 内的 TS 内，所以这不是一个选项。登录到 VM 时，我必须按 alt-（左箭头）-del，然后输入我的密码。我也知道，通常在使用远程桌面时，为了在里面模拟一个 ctrl-alt-del，你会按 ctrl-alt-end。有了这些知识，我已经尝试了我能想到的这些键的所有可能组合，但没有一个会弹出 Windows 安全对话框。

我正在寻找的是

1.  一种无需按 ctrl-alt-del 即可打开 Windows 安全对话框（或只是从那里更改密码表单）的方法（我可以使用命令行吗？）
2.  在不使用上述框的情况下更改我的域密码的另一种方法

# c# - 要每 50 毫秒发送一次图像，我应该使用 TCP 还是 UDP？

> ID：754104
> 
> 赞同：3
> 
> 时间：2009-04-15T23:06:52.080
> 
> 标签：c#, image, tcp, udp

我正在使用服务器-客户端模型构建一个 C# 应用程序，其中服务器每 50 毫秒通过一个套接字向客户端发送一个图像（100kb）......

我使用的是 TCP，但除了这个协议的开销之外，有时客户端会在套接字上获得多个图像。而且我还没有一个聪明的机制来分割每个图像的字节（实际上，我只需要最近的一个）。

我尝试使用 UDP，但得出的结论是我不能发送 100kb 的 dgram，只能发送 64kb 的。即便如此，我也不应该使用超过 1500 字节；否则数据包将沿着网络被分割，并且丢失部分数据包的机会会更大。

所以现在我有点困惑。我应该继续使用 TCP 并在每个图像的末尾放置一些转义字节，以便客户端可以将它们分开吗？或者我应该使用 UDP，发送 1500 字节的 dgram，并提出一种排序和恢复机制？

这里的关键目标是非常快速地传输图像。只要客户不断收到更新的，我不介意在途中丢失一些。

或者我应该使用其他协议吗？提前致谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T23:11:18.170

您应该考虑使用实时传输协议（又名[RTP](http://en.wikipedia.org/wiki/Real-time_Transport_Protocol)）。

RTP 使用的底层 IP 协议是 UDP，但它有额外的分层来指示时间戳、序列顺序等。

RTP 是 VoIP 和 IP 视频系统使用的主要媒体传输协议。如果您找不到该协议的现有 C# 实现，我会感到非常惊讶。

此外，如果您的图像文件是 JPEG 格式，您应该能够生成 RTP/MJPEG 流。由于某些 IP 网络摄像头以这种格式输出，因此有相当多的视频查看器已经原生支持接收和显示此类流。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T23:16:50.293

首先，无论您做什么，您的网络都可能无法处理此问题，但我会使用 UDP。您可以尝试将图像拆分为更小的位，并且仅在下一张图像到达之前获得所有部分时才显示每张图像。

此外，您可以像其他人提到的那样使用 RTP ，或者尝试[UDT](http://udt.sourceforge.net/)。它是 UDP 之上的一个相当轻量级的可靠层。它应该比 TCP 更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T23:14:29.410

如果出现以下情况，我建议使用 UDP：

*   您的应用程序可以处理无法通过的图像或少量图像，
*   您可以将图像压缩到 65535 字节。

如果您正在实施视频会议应用程序，那么值得注意的是大多数使用 UDP。

否则，您应该使用 TCP 并实施一种方法来分隔图像。在这方面的一个建议是看一下[RTP](http://www.ietf.org/rfc/rfc3550.txt)协议。它专门设计用于传输实时数据，例如 VoIP 和视频。

编辑：我过去曾多次环顾.Net RTP 库，除了非.Net 库的包装器或半完成的库外，我没有取得太大的成功。我只是又快速浏览了一下，这可能是这个[ConferenceXP](http://www.codeplex.com/ConferenceXP)看起来更有希望的一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T23:18:14.270

其他答案涵盖了很好的选择：UDP或像RTP这样的“真实”协议。

但是，如果您想坚持使用 TCP，只需为自己构建一个简单的“消息”结构来满足您的需求。最简单的？长度前缀。首先，发送图像的长度为 4 个字节，然后发送图像本身。很容易编写客户端和服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T23:13:24.373

如果最新的比每张图片都重要，UDP 应该是你的首选。

但是，如果您正在处理大于 64K 的帧，则必须做某种形式的重新构图。不要担心碎片帧，因为你必须处理它，否则下层会。你只想要完整的图片。

您需要的是某种形式的时间戳/序列封装。

# mobile - 今天开发的最“有趣”的移动平台是什么？

> ID：754105
> 
> 赞同：-1
> 
> 时间：2009-04-15T23:07:09.053
> 
> 标签：mobile, mobile-phones

当今最有趣/最难/最容易开发的移动平台是什么？

很久以前，我有一台运行 Symbian OS 的 SonyEricsson P800，并在上面做了一些 Java 应用程序。那个时候我觉得 JavaME 太局限了，但大概是 5 年前的事了。请分享您的经验；我需要更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T00:07:04.837

我认为 iPhone 是迄今为止最有趣、最令人兴奋的开发平台。尽管我不是 Obj-C 的忠实粉丝，但它的 API 功能齐全且非常易于使用。Apple 的 AppStore 使其成为最引人注目的工作平台。尽管苹果因其审批程序不明确而声名狼藉。文档非常好。

掌上操作系统？太旧了，现在几乎不受支持。完全缺乏好的开发工具。文档非常糟糕。

视窗手机？我喜欢Windows Mobile。在我看来，Visual Studio 是您可以用来编写代码的最佳 IDE，而这正是您为 Windows Mobile 开发时所使用的。话虽如此，Windows Mobile 对于基于 FormBased 的应用程序来说确实很棒，但对于通用应用程序来说，它仍然落后于 iPhone。文档非常好。

安卓？我喜欢。这很好。但即使我喜欢 Eclipse 进行 Java 编辑，它对于移动开发来说并不是那么好。它的模拟器太慢了。不过我没怎么用过。文档非常好。

塞班？拥有 C/C++ 是最困难的。但它拥有最大的安装基础，因此无论如何都不能忽视它。工具不是那么好，文档也不是。

黑莓？基于Java。只要您不弄乱受保护的 API，就易于使用（您的应用程序需要 RIM 的特别批准才能使用它）。如果考虑到基于 Java 的 API，我更喜欢 Android。但是 RIM 的安装基础使得人们很难忽视这个平台。

爪哇？仅适用于低端手机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T23:25:24.440

我的下一部手机（在接下来的几周内）将是基于 Android 的 G1。不太热衷于基于 Java 的开发，但我可以理解他们为什么这样做。

我更像是一个服务器端的人（大型网站和 PHP 扩展），但我正在考虑解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T23:29:51.120

我听说过关于在诺基亚上编码 python 的好消息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T23:34:31.687

我只尝试过iPhone和Android，但在两者之间，我认为Android是最“有趣”的。主要是我不是很喜欢ObjC，而且对Java有很多经验。不能使用普通的 JDK 确实让我很恼火，但这并不是什么大问题。

此外，在为 iPhone 开发时，您一直担心他们会拒绝您的应用程序。许多伟大的想法永远不会被允许进入 App Store，所以人们求助于通常的铲子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T23:09:02.903

我相信 iPhone 会是最有趣的一款。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T10:20:49.973

好吧，有趣和容易大概会一起去。

众所周知，Symbian OS C++ 是最难开发的平台，但大多数传播该平台的人并没有及时了解解决该问题的最新举措。在一段时间内它可能仍然是正确的。

我想说Android在乐趣方面比iPhone有很大的优势，至少是因为开放性和Linux内核。

J2ME 和黑莓的支持不够好，而且过于分散，既不好玩也不简单。PalmOs 已经死了，而 WebOS 还没有出现。

我仍然建议使用最近的 Symbian 手机，主要是因为可用的开发运行时的多样性：nsbasic、.net、ruby、python、j2me、c++、c、webkit、opera 小部件......整个平台是开源的。

# silverlight - Silverlight：将数据上下文应用于样式中的元素

> ID：754111
> 
> 赞同：1
> 
> 时间：2009-04-15T23:10:25.597
> 
> 标签：silverlight, datacontext, styles

我已经在`app.xaml`. 此样式包含几个文本块，当我将样式应用于对象时，我想控制这些文本块，在本例中为 UserPin。如何访问这些 TextBlocks 运行时？我通过以下方式获得风格：

```
Style = Application.Current.Resources["UserPin"] as Style; 
```

样式如下所示：

```
<Style x:Name="UserPin" TargetType="RRML_UserControls:UserPin" >
    <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
    <Setter Property="AnchorPoint" Value="0.5,0.5" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="RRML_UserControls:UserPin">
                <Grid Height="71.969" Width="Auto">
                    <Grid.RenderTransform>
                        <ScaleTransform x:Name="PART_PinScale" />
                    </Grid.RenderTransform>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="29"/>
                        <RowDefinition Height="16"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.247*"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="0.753*"/>
                    </Grid.ColumnDefinitions>
                    <Image Height="Auto" Source="Resources/Users.png" x:Name="PART_imgUser" VerticalAlignment="Top" Stretch="Uniform" Margin="0,0,0,0" Grid.Column="1">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                    </Image>
                    <TextBlock HorizontalAlignment="Center" Margin="0,0,0,0" Width="Auto" Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="1" TextWrapping="Wrap" VerticalAlignment="Center" TextAlignment="Center" x:Name="txtBottom" Text="{Binding Mode=OneWay, Path=LocationName}">
                        <TextBlock.DataContext>
                            <RRML_RRMLServiceReference:Location LocationName="Initial Name"/>
                        </TextBlock.DataContext>
                    </TextBlock>                            
                    <TextBlock HorizontalAlignment="Right" Margin="0,0,0,0" VerticalAlignment="Center" Text="L" TextWrapping="Wrap"/>
                    <TextBlock Margin="0,0,0,0" Text="R" TextWrapping="Wrap" d:LayoutOverrides="Width, Height" Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center"/>                            
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

`TextBlock`我要设置的值是`txtBottom`. 如您所见，我尝试将数据上下文和数据绑定应用于该字段。这可行，但所有对象当然都会获得值“初始名称”。

我的问题是：

1.  我如何应用我的数据上下文进行`txtBottom.Text`更改，或者
2.  如何在没有数据绑定的情况下更改`TextBlock`命名的值？`txtBottom`
3.  简而言之，我可以访问这些字段或属性吗？

运行时:) 到目前为止，我发现触发器只能在 WPF 中使用。

我想到了这样的事情：

```
var styledobject = new NiceObject();
styledobject.Style = Application.Current.Resources["UserPin"] as Style;
styledobject.DataContext = locationData; 
```

`locationData`我的对象在哪里包含数据。

如果有人想知道；我在地图上放置图标并想命名它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T05:52:11.437

1.  您不应`DataContext`在`TextBlock`. `DataContext`由 child 继承`FrameworkElements`。您应该尝试在可视树上尽可能少且尽可能高地显式设置数据上下文（为了您自己的理智:-)）

2.  如果这是一个自定义控件，您可以覆盖该`OnApplyTemplate`方法并使用`GetTemplateChild(string name)`检索对控件中命名元素的引用。

    ```
    public override void OnApplyTemplate() 
    {
            base.OnApplyTemplate();

    TextBlock txtBottom = GetTemplateChild("txtBottom") as TextBlock;
    } 
    ```

3.  在外部，如果必须，您可以在运行时强制访问该特定控件，使用扩展方法遍历可视树以按名称查找它。

    ```
    public static T FindChild<T>(this DependencyObject element, string name)
                where T : FrameworkElement
    {
    //Code to find the control
    } 
    ```

# ruby-on-rails - 狮身人面像返回错误的搜索结果

> ID：754115
> 
> 赞同：5
> 
> 时间：2009-04-15T23:12:11.880
> 
> 标签：ruby-on-rails, ruby, sphinx, thinking-sphinx

我正在使用带有 Thinking Sphinx 插件的 Sphinx。我使用以下代码（和 rake thinking_sphinx:index 命令）索引了一个名为 Venue 的模型

```
define_index do
    indexes :name
    indexes city
    indexes zip
end 
```

我使用以下代码在我的控制器中获得结果：

```
@venues = Venue.search params[:search] 
```

我将它们渲染为 json。我遇到的问题是，当我点击这个 URL 时：

```
http://localhost:3000/venue/list?search=Baltimo 
```

我什么都得不到。但是当我点击这个网址时：

```
http://localhost:3000/venue/list?search=Baltimor 
```

我得到了位于巴尔的摩市的所有场地。出于某种原因，一个角色会有所作为。从理论上讲，如果我只搜索一个字符 - 'b'，我应该得到巴尔的摩的所有场地

有谁知道这里发生了什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T00:07:51.733

除非您已`enable_star`设置为 1`min_prefix_len`或`min_infix_len`设置为 1 或更多，否则您将无法获得 B 来匹配巴尔的摩（即便如此，我认为您需要搜索 B* 才能获得匹配）。

这里发生的情况是，默认情况下，Thinking Sphinx 告诉 Sphinx 使用英语词干分析器，它允许将*相似*的单词（按字符，而不是按含义）视为匹配，因此它将**Baltimor**和**Baltimore**放在同一个篮子中。

如果你想得到匹配的任何单词的任何部分，那么你需要在 config/sphinx.yml 中添加如下内容：

```
development:
  enable_star: 1
  min_infix_len: 1
test:
  enable_star: 1
  min_infix_len: 1
production
  enable_star: 1
  min_infix_len: 1 
```

然后停止 Sphinx，重新索引，然后重新启动 Sphinx。完成此操作后，搜索 B* 应返回巴尔的摩。

希望这可以帮助。

# security - 查看文件内容的最低权限级别？

> ID：754118
> 
> 赞同：0
> 
> 时间：2009-04-15T23:12:47.403
> 
> 标签：security, permissions

如何查看具有 111 权限的文件的内容？一个叫做[Y-combinator](http://en.wikipedia.org/wiki/Y_combinator)的东西，作为输入，打印文件的内容。我的直觉说你可以用 100 个权限运行它。但是，我只知道理论，不知道实践。

> 在 Bash 中查看带有 Y-combinator 的文件的最低权限级别是什么？

用户nobody_评论：

> 你没有任何意义。Y 组合器用于创建递归函数，与权限无关。

出现一个问题：

> 在 Bash 中查看文件的最低权限级别是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T23:21:31.127

您无法读取具有这些权限的文件的内容。

“111”的权限是“仅执行”，对常规文件几乎没有用处。为了执行文件，它至少需要所有者读取和执行，在这种情况下，只有所有者才能读取和执行它。

如果您担心其他人阅读您的文件，您可能想使用“500”，它只会为您读取和执行。

有关更多信息以及这些数字的含义（八进制表示法），您应该阅读 Wikipedia 上的此页面： [http ://en.wikipedia.org/wiki/File_system_permissions#Octal_notation](http://en.wikipedia.org/wiki/File_system_permissions#Octal_notation)

干杯，达里尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T23:19:25.453

要执行文件（脚本或其他），您需要能够将其内容加载到内存中，从而具有读取权限。

因此，仅在您的文件上保留执行权不会允许任何人阅读它。然而，这仍然是一个*坏*主意。任何不*应该*被执行的东西都不应获得执行权。在你的位置上，我会更担心意外执行以 rm * 开头的文本文件，而不是有人使用技巧偷看我的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T23:20:14.997

我认为你不能，甚至解释器也不能（因此不会运行它）。

然而，你不应该担心别人看到你的代码；如果有例如。安全漏洞，您应该修复它们。

# wpf - WPF 按钮文本环绕样式

> ID：754137
> 
> 赞同：40
> 
> 时间：2009-04-15T23:20:29.460
> 
> 标签：wpf, button, styles, default, word-wrap

如何更改 WPF 中按钮的默认文本环绕样式？

显而易见的解决方案：

```
<Style x:Key="MyButtonStyle" TargetType="{x:Type Button}">
    <Setter Property="TextWrapping" Value="Wrap"></Setter>
</Style> 
```

不起作用，因为 Textwrapping 显然在这里不是可设置的属性。

如果我尝试：

```
<Style x:Key="MyButtonStyle" TargetType="{x:Type Button}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <TextBlock Text="{Binding}" Foreground="White" FontSize="20" FontFamily="Global User Interface" TextWrapping="Wrap"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我只是从编译器那里得到一个毫无价值的回应：

```
Error   5   After a 'SetterBaseCollection' is in use (sealed), it cannot be modified. 
```

删除 ControlTemplate 标记会保留错误。

以下尝试产生不同的错误：

```
 <Setter Property="TextBlock">
        <TextBlock Text="{Binding}" Foreground="White" FontSize="20" FontFamily="Global User Interface" TextWrapping="Wrap"/>
    </Setter>

Error   5   The type 'Setter' does not support direct content. 
```

我看到我可以为每个按钮单独设置文本换行，但这非常愚蠢。我怎样才能把它作为一种风格？什么是神奇的词？

为了将来参考，我在哪里可以找到这些神奇单词的列表，这样我就可以自己做这件事了？当我试图找出 setter 可以设置哪些属性时，MSDN 条目毫无用处。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-09-19T01:21:22.350

用一个例子来扩展埃里克的答案： -

```
<Button Name="btnName" Width="50" Height="40">
   <TextBlock Text="Some long text" TextWrapping="Wrap" TextAlignment="Center"/>
</Button> 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2010-12-17T01:08:31.423

我通过向`TextBlock`按钮添加 a 并使用它来显示按钮文本而不是按钮的`Content`属性来解决这个问题。确保将`TextBlock`的 height 属性设置为`Auto`，以便它在高度上增长以适应换行时的文本行数。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-04-15T23:45:47.073

您的第二个版本应该可以工作，并且对我有用，但需要注意的是您需要更改 TextBlock 文本绑定：

```
<!-- in Window.Resources -->
<Style x:Key="fie" TargetType="Button">
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type Button}">
        <TextBlock Text="{TemplateBinding Content}" FontSize="20" TextWrapping="Wrap"/>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style>

<!-- then -->
<Button Style="{StaticResource fie}">verylongcaptiongoeshereandwraps/Button> 
```

请注意，这完全取代了按钮样式（即，如果需要，您需要创建自己的按钮镶边）。

关于你的第二个问题，所有可写的依赖属性都可以使用 Setter 设置。您无法通过样式在 Button 上设置 TextWrapping 的原因是 Button 没有 TextWrapping 依赖属性（或者实际上没有任何 TextWrapping 属性）。没有“神奇的词”，只有依赖属性的名称。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-07-11T21:25:25.667

```
<Style TargetType="Button">
    <Setter Property="ContentTemplate">
        <Setter.Value>
            <DataTemplate>
                <TextBlock Text="{TemplateBinding Content}" TextWrapping="Wrap" />
            </DataTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-08-30T18:47:45.787

以下是 Eric 在 C# 代码隐藏中的回答示例：

```
var MyButton = new Button();

MyButton.Content = new TextBlock() {
    FontSize        = 25,
    Text            = "Hello world, I'm a pretty long button!",
    TextAlignment   = TextAlignment.Center,
    TextWrapping    = TextWrapping.Wrap
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-01T07:52:18.040

用@fadden 的评论扩展@Rob 的答案：

```
<Button Width="50" Height="40">
   <AccessText Text="_Some long text" TextWrapping="Wrap" TextAlignment="Center"/>
</Button> 
```

TextBlock 控件不支持键盘热键 (_)。

# java - Red Hat 的 JBoss EAP 是您从 JBOSS.org 获得的 JBoss AS 代码的一个分支吗？

> ID：754139
> 
> 赞同：2
> 
> 时间：2009-04-15T23:21:33.513
> 
> 标签：java, jakarta-ee, jboss, redhat

有谁知道 Red Hat 是否分叉了您从 JBOSS.org 下载的代码？我猜答案是“是”，但我想确认一下。我无法在 Red Hat 网站上确定它，并且 jboss.org 现在出于某种原因给了我一个 HTTP 502。

我知道 Red Hat 拥有 JBoss。这是否意味着他们在 JBoss Developer Studio 中以 99 美元一盒的价格出售的代码*与*我可以从 JBOSS.org 下载而无需付费的代码相同？还是他们以某种方式分叉了收费版本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-16T09:46:59.437

Red Hat/JBoss 产品的所有源代码都可以在开源（在 svn/cvs 等中）获得，但出售的版本是所谓的产品化版本。

产品化是什么意思？这意味着正如迈克尔所说，它有额外的测试/QA，它有认证的位，它有匹配的文档等。这也意味着社区版本中的某些功能被禁用、删除或配置默认值略有不同并且略有不同包装。

差异示例：即 JBoss EAP 与 Seam 捆绑在一起，而 JBoss AS 没有。产品化的 Seam 1.2 可以在 JBoss AS 4.3 上运行，来自 .org 的 Seam 没有 JBoss EAP 有一个为生产调整的“生产”配置文件（即热部署禁用和我们的支持推荐的其他最佳实践），JBoss AS 没有。JBoss EAP 多年来一直得到支持和保证的累积补丁，而来自 .org 的 JBoss AS 却没有。

以上所有内容都是关于拥有一个可以长期支持的产品化版本，因此更多的是关于拥有一个稳定版本而不是拥有最新开发的最新最先进的版本。

如果您正在寻找最前沿的技术，那么 JBoss.org 就是为您准备的。

为迈克尔回答您的问题，“如果我从 JBoss.org 下载代码，我肯定会使用与从 Red Hat 购买它的人相同的东西，对吗？” - 那么答案是：这取决于项目。

有些项目*完全相同*，而其他项目则有更明显的差异，但产品化版本中的所有功能都在 .org 版本中可用，但 .org 中可能存在一些已被删除/禁用的功能（见上文） .

那么该怎么办？如果您正在寻找最前沿，请使用 JBoss.org - 如果您正在寻找确保您正在开发的二进制文件集与 JBoss/Red Hat 可以在未来多年提供开发和产品支持的*完全相同*，那么您提到的 Red Hat 的 99 美元产品（我假设您的意思是 JBoss Developer Studio Portfolio）是您的最佳选择。

顺便提一句。关于社区和企业（产品化）版本之间区别的官方答案显示在[http://www.jboss.com/products/community-enterprise/](http://www.jboss.com/products/community-enterprise/)

全面披露：我是 JBoss Tools 和 JBoss Developer Studio 的负责人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-16T00:45:35.387

不，它不是不同代码中的分叉 - 它从 .org 版本构建并通过各种测试/QA 环境，必要时经过认证等......

它类似于 Fedora 和 Red Hat Enterprise Linux 的情况（我认为这个想法是有一个类似的模型）——所以如果你研究那个模型，它可能有助于更好地解释它。

# javascript - Jquery 和框架

> ID：754140
> 
> 赞同：1
> 
> 时间：2009-04-15T23:22:15.837
> 
> 标签：javascript, jquery, html, frames

我目前正在开发一个 Web 应用程序，该应用程序使用最多可延伸 5 倍的帧大小创建，问题是我需要在整个网站上执行一些 jquery 魔术。

解决这个问题的最佳方法是什么（除了我考虑过的重写它）？

**编辑：**

框架结构是这样的：

```
Index.html
    menu.html
        banner.html
        list.html
        footer.html
    /lib/index.html
        header.html
        body.html
        footer.html 
```

我引用的魔法是一些热键快捷方式，查找和替换那种东西

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T01:36:58.053

这就是你想要的：

[$.frameReady()](http://ideamill.synaptrixgroup.com/?p=6)

> frameReady 允许您在目标框架中运行 jQuery 命令，就好像它在本地文档中一样。它的工作原理很像 $(document).ready() 函数，等待目标框架中的 DOM 准备就绪，然后再尝试运行您的代码。如果 jQuery 尚不存在，它还会为您加载目标框架中的 jQuery，并允许您轻松加载其他脚本文件和样式表。frameReady 支持任何组合的嵌套框架和 iframe，甚至是动态创建的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-15T09:12:39.263

您还可以使用下面的 jQuery 来定位 iFrame 中的元素和内容。

```
$('#iframeId').load(function(){
    $(this.contentDocument).find('#id').html('your text');
}); 
```

# java - Java URL 连接空白输入流

> ID：754141
> 
> 赞同：0
> 
> 时间：2009-04-15T23:22:28.363
> 
> 标签：java, url, urlconnection

我正在处理的应用程序的网页加载速度非常慢。如果我运行以下代码，它可以正常工作，但只是因为调用`sleep`. 如果我不睡觉，那么 InputStream 只是一堆空格，可能是由于它正在调用的应用程序。有没有解决这个问题的非黑客方法？

```
public class PublishTool extends Thread {

  private URL publishUrl;

  private String filerLocation;

  public PublishTool() {
  }

  public PublishTool(String publishUrl, String filerLocation) throws NibException {

    try {
      this.publishUrl = new URL(publishUrl);
    } catch (MalformedURLException e) {
      throw new NibException("Publish Url :" + publishUrl + " is not valid. ");
    }

    this.filerLocation = filerLocation;

  }

  public void run() {

    File filerFile = new File(filerLocation);
    BufferedWriter writer = null;

    try {
      URLConnection conn = publishUrl.openConnection();
      BufferedReader reader = new BufferedReader(new InputStreamReader(new BufferedInputStream(conn.getInputStream())));

      writer = new BufferedWriter(new FileWriter(filerLocation));

      Thread.sleep(1000l);

      while (reader.ready()) {
        writer.write(reader.readLine() + "\n");
      }

    } catch (MalformedURLException e) {
      throw new IllegalStateException("Malformed URL for : " + publishUrl + " " + filerLocation, e);
    } catch (IOException e) {
      throw new IllegalStateException("IO Exception for  : " + publishUrl + " " + filerLocation, e);
    } catch (InterruptedException e) {
      throw new IllegalStateException("Thread was interrupted early... publishing might have failed.");
    } catch (NibException e) {
      throw new IllegalStateException("Publishing File Copy failed : " + filerLocation + ".bak" + " to " + filerLocation);
    } finally {
      try {
        writer.flush();
        writer.close();
      } catch (IOException e) {
        e.printStackTrace();
      }
    }
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T00:00:35.323

不要使用 reader.ready()。只需调用 readLine() 并让 readLine() 阻塞，直到数据准备好。数据的结束通常会以空线表示。

如果有帮助，我的网站上有几个代码示例：[从 URL 读取](http://www.javamex.com/tutorials/io/networking.shtml)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T23:40:34.013

首先，如果您发布实际代码会很有帮助。

我猜问题出在`Reader.ready`. 与 类似，如果已经有缓冲输入`InputStream.available`，则返回。`true`如果它需要等待，比如说，它会返回一个套接字`false`。一般不需要`ready`。使用`readLine`, 如果它返回则退出循环`null`（用于流结束）。

# wpf - 如何实现“直通”数据绑定？

> ID：754143
> 
> 赞同：0
> 
> 时间：2009-04-15T23:23:15.053
> 
> 标签：wpf, dependency-properties

**一点背景知识：**我正在从存储在属性表（控件类型、标签、边距等）中的数据库中加载 WPF UI，我将其加载到我称为 ControlPresenter 的类中。基本上我将 ControlPresenter 设置为 ContentPresenter 的 DataContext 并使用 TemplateSelector 来选择要加载的控件类型。DataTemplate(s) 从 ControlPresenter 公开的 DependencyProperties 中加载它们的属性。

这一切都非常有效。当我尝试将其他演示者（具有实现 INotifyPropertyChanged 的​​普通属性）中的数据（例如，TextBox 的 Text 属性与演示者的 Name 属性）绑定到这些控件时，我遇到了问题。控件的 DataContext 是关联的 ControlPresenter，因此我不能直接绑定到其他演示者，也不能在同一个依赖项属性上设置两个绑定（我不能将控件和所需的演示者属性绑定到同一个 DP） .

**可能的解决方案：**

1.  我可以将所有其他演示者转换为使用 DP（非常耗时且容易导致继承问题）
2.  我可以为要通过的每个属性使用两个 DP，并尝试通过更改的通知将它们绑定在一起

这两个似乎都有问题并且容易破裂，所以我希望其他人能提出更好的解决方案。

**编辑：**我想出了一个效果很好的解决方案（见下文）。感谢所有看过这个的人，如果你想出比我更好的方法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T08:02:17.240

有几种方法可以访问超出范围的 DataContext。

1) ElementName 绑定

这可能是最没用的，因为在大多数现实世界的场景中，您尝试绑定的内容无论如何都超出了名称范围。但只要框架元素在名称范围内，它就是一种访问并行或父数据上下文的方法。

```
<TextBox Text="{Binding ElementName=ControlSomewhereElseBoundToSomeOtherControlPresenter, Path=DataContext.SomeTextPropertyOnTheControlPresenter}" /> 
```

2) 相对源绑定

这与#1 类似，但使用RelativeSource 导航到适当的可视元素并获取DataContext。当然，这假设您尝试获取的 DataContext 位于您当前在可视树中的位置之上。

3) 使用静态继电器

您可以在充当 ViewModel 外观的静态类中公开您的替代 ControlPresenter。然后，在每个 ViewModel 内构造实例属性，这些属性传递给静态方法/属性。这是实现跨多个视图模型共享存储的常用方法。我意识到这种技术需要你稍微改变你的模式，但是在这些“ControlPresenter”类周围添加一个简单的 ViewModel 包装器似乎比你描述的选项简单得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T18:48:27.160

我最终通过将 Binding.Source 设置为所需的 ViewModel，然后将数据库中的路径用于 Binding.Path，从而在代码中设置了绑定。我将绑定存储在 Dictionary(Of DependencyProperty, BindingBase) 中，当控件加载时，我使用 BindingOperations.SetBinding 设置控件上的绑定。这似乎工作得很好，除了偶尔的操作顺序问题（例如，如果您在 ItemsSource 之前设置 SelectedItem/SelectedValue 它将被设置但不会显示在 ComboBox 中）。

# php - PHP - 在会话数据中存储图像？

> ID：754145
> 
> 赞同：20
> 
> 时间：2009-04-15T23:23:51.137
> 
> 标签：php, session, image

您可以将图像存储在 PHP SESSION 中吗？

我在我的网站上使用 PHP 进行了多步骤注册过程。在其中一个步骤中，用户可以上传他们的公司徽标（图像）。

最后一步是处理他们的信用卡。

因此，在我将任何图像写入 Web 服务器并将图像位置写入数据库之前，我想确保他们的信用卡有效并进行处理。

因此，是否可以将该图像数据临时存储在 SESSION 变量中？

如果不是，人们如何在提交数据之前将图像数据临时存储在表单上？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-15T23:31:03.427

您可以预期会话的内存使用量会根据图像的大小而增加。为此，您必须将文件内容保存到会话变量中。

如果它在会话数据中，并且您在上传后有多个步骤，则图像将在每个页面视图中重新加载（到会话中），直到步骤完成。

我个人建议不要使用会话来保存二进制文件。将磁盘上的图像保存到一个临时位置，直到注册完成。我只会在会话中保存临时文件的路径。事务完成后，将其移动到适当的位置并进行数据库插入。

此外，从本质上讲，会话数据无论如何都存储在磁盘（或数据库）上，因此您最好保存一次图像文件，然后在完成后发出移动命令。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-16T08:45:52.877

我会将文件保存到磁盘，您甚至可以使用用户的会话 ID 来命名它。然后可能会有某种清理脚本作为 cron 作业运行并删除从未成功付款的人的图像。

如果您尝试在会话中存储图像，那么您做错了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T23:37:16.220

上传文件时，它会在 $_FILES 数组中分配一个临时名称。我不知道这些文件的确切寿命，但您可能能够在会话中捕获该名称并将 move_uploaded_file() 调用推迟到 CC 验证之后。

或者，您可以先执行 CC 步骤。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T23:31:57.170

是的，您可以在 PHP 会话中存储图像。将其作为字符串（即二进制数据）放入 PHP 中，然后您可以将其放入会话中。

您将希望它仅与需要的一样大，并且您需要在不需要它时立即将其删除，因为会话中的大量信息会减慢会话启动速度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-25T08:59:17.003

有时我们需要在将数据保存到数据库之前预览/确认页面。但是确认页面的图像文件有点不同。你不能做 `$_SESSION['s_name'] = $_FILES['f_name']`因为会话只保留文本文件。以另一种方式将文件内容/二进制值保留在会话中。

```
$_SESSION['obj_image_session'] = file_get_contents($_FILES['image_name']['tmp_name']);

$file= "new_file.jpg";
$fp=($file,"w");

fwrite($fp,$_SESSION['obj_image_session']); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-25T11:51:29.723

如果您必须保留数据，我建议将其保留为 base64_encoded 字符串。您可以直接将base64_encode图像数据发送到浏览器。

如果我处于类似情况，我宁愿保存图像并将有关图像的信息保存在 session/db 中。如果由于某种原因注册失败，我稍后会取消链接文件。并偶尔运行 cron 作业以查找缺少的图像链接。

但我真的建议你坚持第二种选择，完全避免麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-10T08:40:51.930

您可以轻松地将图像数据作为基本编码存储在会话中。在生产服务器中，您应该有足够的 RAM。在放入 mongoDB 之前，我的应用程序需要多达 40MB 的 4 个图像/应用程序进行更新和更改。（基本编码使图像尺寸增大 1.3 倍。）

```
 $tmpNameSS1 = $_FILES["screenshot1"]["tmp_name"];
  $fp      = fopen($tmpNameSS1, 'r');
  $rawDataSS1 = fread($fp, filesize($tmpNameSS1));
  fclose($fp);
  $SS1FileName = $_FILES["screenshot1"]["name"];
  $encodedSS1Data = base64_encode($rawDataSS1);

  registry::update('sCreateSS1Name', $SS1FileName);
  registry::update('sCreateSS1Data', $encodedSS1Data); 
```

一个案例是：您有多个要上传的图像，并且客户端和服务器都验证了大小和类型。从会话中获取更快。将保存图像的变量放入 DB null 后。

浏览器将显示该图像：

```
<img src="data:image/;base64,<?php echo registry::get('sCreateSS1Data'); ?>"/> 
```

代码到达块末尾后，您可以使用空字符串更新图像的会话。典型情况是使用验证更新表单字段以及用户想要更改文本时。您还想显示在这些失败的更新之间上传了什么图像。如果您想保存往返行程（建议），请在会话中保留一段时间的数据，并在代码即将退出后清空该值。

# xml - 在 AS 中使用带有 loadClip 的数组？

> ID：754147
> 
> 赞同：1
> 
> 时间：2009-04-15T23:24:38.670
> 
> 标签：xml, flash, actionscript-2

我已将 xml 中的图像预加载到名为 arr 的数组中。但是我在 loadClip 和从数组中获取字符串时遇到了问题。所以它不会在框中加载图像。

例子：

```
arr[0] = "images/photo1.jpg";
var mcLoader:MovieClipLoader = new MovieClipLoader();
mcLoader.addListener(this);
mcLoader.loadClip(arr[0], box_mc.loader_mc); 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T00:45:29.893

对此的解决方案是：

```
mcLoader.loadClip(arr[0].toString(), box_mc.loader_mc); 
```

# performance - How is pattern matching in Scala implemented at the bytecode level?

> ID：754166
> 
> 赞同：127
> 
> 时间：2009-04-15T23:32:29.353
> 
> 标签：performance, scala, pattern-matching, bytecode

How is pattern matching in Scala implemented at the bytecode level?

Is it like a series of `if (x instanceof Foo)` constructs, or something else? What are its performance implications?

For example, given the following code (from [Scala By Example](http://www.scala-lang.org/docu/files/ScalaByExample.pdf) pages 46-48), how would the equivalent Java code for the `eval` method look like?

```
abstract class Expr
case class Number(n: Int) extends Expr
case class Sum(e1: Expr, e2: Expr) extends Expr

def eval(e: Expr): Int = e match {
  case Number(x) => x
  case Sum(l, r) => eval(l) + eval(r)
} 
```

P.S. I can read Java bytecode, so a bytecode representation would be good enough for me, but probably it would be better for the other readers to know how it would look like as Java code.

P.P.S. Does the book [Programming in Scala](https://rads.stackoverflow.com/amzn/click/com/0981531601) give an answer to this and similar questions about how Scala is implemented? I have ordered the book, but it has not yet arrived.

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-04-16T02:03:43.357

The low level can be explored with a disassembler but the short answer is that it's a bunch of if/elses where the predicate depends on the pattern

```
case Sum(l,r) // instance of check followed by fetching the two arguments and assigning to two variables l and r but see below about custom extractors 
case "hello" // equality check
case _ : Foo // instance of check
case x => // assignment to a fresh variable
case _ => // do nothing, this is the tail else on the if/else 
```

There's much more that you can do with patterns like or patterns and combinations like "case Foo(45, x)", but generally those are just logical extensions of what I just described. Patterns can also have guards, which are additional constraints on the predicates. There are also cases where the compiler can optimize pattern matching, e.g when there's some overlap between cases it might coalesce things a bit. Advanced patterns and optimization are an active area of work in the compiler, so don't be surprised if the byte code improves substantially over these basic rules in current and future versions of Scala.

In addition to all that, you can write your own custom extractors in addition to or instead of the default ones Scala uses for case classes. If you do, then the cost of the pattern match is the cost of whatever the extractor does. A good overview is found in [http://lamp.epfl.ch/~emir/written/MatchingObjectsWithPatterns-TR.pdf](http://lamp.epfl.ch/~emir/written/MatchingObjectsWithPatterns-TR.pdf)

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-04-16T03:12:42.193

James (above) said it best. However, if you're curious it's always a good exercise to look at the disassembled bytecode. You can also invoke `scalac` with the `-print` option, which will print your program with all Scala-specific features removed. It's basically Java in Scala's clothing. Here's the relevant `scalac -print` output for the code snippet you gave:

```
def eval(e: Expr): Int = {
  <synthetic> val temp10: Expr = e;
  if (temp10.$isInstanceOf[Number]())
    temp10.$asInstanceOf[Number]().n()
  else
    if (temp10.$isInstanceOf[Sum]())
      {
        <synthetic> val temp13: Sum = temp10.$asInstanceOf[Sum]();
        Main.this.eval(temp13.e1()).+(Main.this.eval(temp13.e2()))
      }
    else
      throw new MatchError(temp10)
}; 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2012-08-14T13:39:41.643

Since version 2.8, Scala has had the [@switch](http://www.scala-lang.org/api/current/scala/annotation/switch.html) annotation. The goal is to ensure, that pattern matching will be compiled into [tableswitch or lookupswitch](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-3.html#jvms-3.10) instead of series of conditional `if` statements.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-20T17:17:58.910

To expand on @Zifre's comment: if you are reading this in the future and the scala compiler has adopted new compilation strategies and you want to know what they are, here's how you find out what it does.

Copy-paste your `match` code into a self-contained example file. Run `scalac` on that file. Then run `javap -v -c theClassName$.class`.

For example, I put the following into `/tmp/question.scala`:

```
object question {
  abstract class Expr
  case class Number(n: Int) extends Expr
  case class Sum(e1: Expr, e2: Expr) extends Expr

  def eval(e: Expr): Int = e match {
    case Number(x) => x
    case Sum(l, r) => eval(l) + eval(r)
  }
} 
```

Then I ran `scalac question.scala`, which produced a bunch of `*.class` files. Poking around a bit, I found the match statement inside `question$.class`. The `javap -c -v question$.class` output is available below.

Since we're looking for a condition control flow construct, knowing about the java bytecode instruction set suggests that looking for "if" should be a good place to start.

In two locations we find a pair of consecutive lines on the form `isinstanceof <something>; ifeq <somewhere>`, which means: if the most recently computed value is *not* an instance of `something` then goto `somewhere`. (`ifeq` is `jump if zero`, and `isinstanceof` gives you a zero to represent false.)

If you follow the control flow around, you'll see that it agrees with the answer given by @Jorge Ortiz: we do `if (blah isinstanceof something) { ... } else if (blah isinstanceof somethingelse) { ... }`.

Here is the `javap -c -v question$.class` output:

```
Classfile /tmp/question$.class
  Last modified Nov 20, 2020; size 956 bytes
  MD5 checksum cfc788d4c847dad0863a797d980ad2f3
  Compiled from "question.scala"
public final class question$
  minor version: 0
  major version: 50
  flags: (0x0031) ACC_PUBLIC, ACC_FINAL, ACC_SUPER
  this_class: #2                          // question$
  super_class: #4                         // java/lang/Object
  interfaces: 0, fields: 1, methods: 3, attributes: 4
Constant pool:
   #1 = Utf8               question$
   #2 = Class              #1             // question$
   #3 = Utf8               java/lang/Object
   #4 = Class              #3             // java/lang/Object
   #5 = Utf8               question.scala
   #6 = Utf8               MODULE$
   #7 = Utf8               Lquestion$;
   #8 = Utf8               <clinit>
   #9 = Utf8               ()V
  #10 = Utf8               <init>
  #11 = NameAndType        #10:#9         // "<init>":()V
  #12 = Methodref          #2.#11         // question$."<init>":()V
  #13 = Utf8               eval
  #14 = Utf8               (Lquestion$Expr;)I
  #15 = Utf8               question$Number
  #16 = Class              #15            // question$Number
  #17 = Utf8               n
  #18 = Utf8               ()I
  #19 = NameAndType        #17:#18        // n:()I
  #20 = Methodref          #16.#19        // question$Number.n:()I
  #21 = Utf8               question$Sum
  #22 = Class              #21            // question$Sum
  #23 = Utf8               e1
  #24 = Utf8               ()Lquestion$Expr;
  #25 = NameAndType        #23:#24        // e1:()Lquestion$Expr;
  #26 = Methodref          #22.#25        // question$Sum.e1:()Lquestion$Expr;
  #27 = Utf8               e2
  #28 = NameAndType        #27:#24        // e2:()Lquestion$Expr;
  #29 = Methodref          #22.#28        // question$Sum.e2:()Lquestion$Expr;
  #30 = NameAndType        #13:#14        // eval:(Lquestion$Expr;)I
  #31 = Methodref          #2.#30         // question$.eval:(Lquestion$Expr;)I
  #32 = Utf8               scala/MatchError
  #33 = Class              #32            // scala/MatchError
  #34 = Utf8               (Ljava/lang/Object;)V
  #35 = NameAndType        #10:#34        // "<init>":(Ljava/lang/Object;)V
  #36 = Methodref          #33.#35        // scala/MatchError."<init>":(Ljava/lang/Object;)V
  #37 = Utf8               this
  #38 = Utf8               e
  #39 = Utf8               Lquestion$Expr;
  #40 = Utf8               x
  #41 = Utf8               I
  #42 = Utf8               l
  #43 = Utf8               r
  #44 = Utf8               question$Expr
  #45 = Class              #44            // question$Expr
  #46 = Methodref          #4.#11         // java/lang/Object."<init>":()V
  #47 = NameAndType        #6:#7          // MODULE$:Lquestion$;
  #48 = Fieldref           #2.#47         // question$.MODULE$:Lquestion$;
  #49 = Utf8               question
  #50 = Class              #49            // question
  #51 = Utf8               Sum
  #52 = Utf8               Expr
  #53 = Utf8               Number
  #54 = Utf8               Code
  #55 = Utf8               LocalVariableTable
  #56 = Utf8               LineNumberTable
  #57 = Utf8               StackMapTable
  #58 = Utf8               SourceFile
  #59 = Utf8               InnerClasses
  #60 = Utf8               ScalaInlineInfo
  #61 = Utf8               Scala
{
  public static final question$ MODULE$;
    descriptor: Lquestion$;
    flags: (0x0019) ACC_PUBLIC, ACC_STATIC, ACC_FINAL

  public static {};
    descriptor: ()V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=1, locals=0, args_size=0
         0: new           #2                  // class question$
         3: invokespecial #12                 // Method "<init>":()V
         6: return

  public int eval(question$Expr);
    descriptor: (Lquestion$Expr;)I
    flags: (0x0001) ACC_PUBLIC
    Code:
      stack=3, locals=9, args_size=2
         0: aload_1
         1: astore_2
         2: aload_2
         3: instanceof    #16                 // class question$Number
         6: ifeq          27
         9: aload_2
        10: checkcast     #16                 // class question$Number
        13: astore_3
        14: aload_3
        15: invokevirtual #20                 // Method question$Number.n:()I
        18: istore        4
        20: iload         4
        22: istore        5
        24: goto          69
        27: aload_2
        28: instanceof    #22                 // class question$Sum
        31: ifeq          72
        34: aload_2
        35: checkcast     #22                 // class question$Sum
        38: astore        6
        40: aload         6
        42: invokevirtual #26                 // Method question$Sum.e1:()Lquestion$Expr;
        45: astore        7
        47: aload         6
        49: invokevirtual #29                 // Method question$Sum.e2:()Lquestion$Expr;
        52: astore        8
        54: aload_0
        55: aload         7
        57: invokevirtual #31                 // Method eval:(Lquestion$Expr;)I
        60: aload_0
        61: aload         8
        63: invokevirtual #31                 // Method eval:(Lquestion$Expr;)I
        66: iadd
        67: istore        5
        69: iload         5
        71: ireturn
        72: new           #33                 // class scala/MatchError
        75: dup
        76: aload_2
        77: invokespecial #36                 // Method scala/MatchError."<init>":(Ljava/lang/Object;)V
        80: athrow
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0      81     0  this   Lquestion$;
            0      81     1     e   Lquestion$Expr;
           20      61     4     x   I
           47      34     7     l   Lquestion$Expr;
           54      27     8     r   Lquestion$Expr;
      LineNumberTable:
        line 6: 0
        line 7: 2
        line 8: 27
        line 6: 69
      StackMapTable: number_of_entries = 3
        frame_type = 252 /* append */
          offset_delta = 27
          locals = [ class question$Expr ]
        frame_type = 254 /* append */
          offset_delta = 41
          locals = [ top, top, int ]
        frame_type = 248 /* chop */
          offset_delta = 2
}
SourceFile: "question.scala"
InnerClasses:
  public static #51= #22 of #50;          // Sum=class question$Sum of class question
  public static abstract #52= #45 of #50; // Expr=class question$Expr of class question
  public static #53= #16 of #50;          // Number=class question$Number of class question
  ScalaInlineInfo: length = 0xE (unknown attribute)
   01 01 00 02 00 0A 00 09 01 00 0D 00 0E 01
  Scala: length = 0x0 (unknown attribute) 
```

# ruby - Ruby、windows、active_record 和 Control-C

> ID：754167
> 
> 赞同：1
> 
> 时间：2009-04-15T23:32:43.407
> 
> 标签：ruby, windows, activerecord, exception-handling, interrupt

active_record 对 windows 下的信号处理做了什么（我在 mac 上没有看到相同的版本）导致它的行为如此奇怪？例如：

```
require 'rubygems'
trap("INT"){puts "interrupted"}
puts __LINE__
sleep 5
require 'active_record'
trap("INT"){puts "interrupted again"}
puts __LINE__
sleep 5 
```

当我运行上面的代码（ruby 1.8.6，gem 1.3.1，activerecord 2.2.2）时，我可以在第一次睡眠期间多次点击 ^C，但是在需要 activerecord 之后的第一次中断会导致脚本终止。在上述情况下，陷阱仍然执行，只是无法让程序继续执行。通常。

删除第二个陷阱调用对行为没有任何影响。

真正令人烦恼的是，在某些情况下，陷阱根本无法执行。考虑到这样做的全部目的是让我的代码自行清理（删除它在数据库中的足迹，以便下一个人看到一个理智的状态），这是一个真正的问题。例如：

```
require 'rubygems'
require 'active_record'
trap("INT"){puts "interrupted"}
puts __LINE__
gets 
```

在看到 puts 后按 ^C 根本不会执行陷阱。

我只在需要 active_record 后才看到这个问题。有解决方法吗？我很想知道这是一个错误还是有某种解释。正如我所说，我在 mac 上对此没有任何问题 - 重复 ^Cs 会导致陷阱 proc 的多次执行。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T00:20:17.803

> 考虑到这样做的全部目的是让我的代码自行清理（删除它在数据库中的足迹......

您是否考虑过仅使用数据库事务？似乎这将是解决问题的一种更简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-20T02:57:48.990

尝试复制此问题时，我看到了不同的模式：

```
puts "start"
trap("INT") { puts "interrupted" }
sleep 5
puts "end" 
```

在 Ubuntu (Ruby 1.8.6) 上，这会产生

```
start
interrupted
interrupted
(etc)
interrupted
end 
```

因此，每次按下 Crtl-C 时都会“中断”打印，直到 5 秒结束。在 Windows（也是 Ruby 1.8.6）下，这会产生：

```
start
interrupted
end 
```

即它打印一次“中断”然后退出。

因此，在处理 SIGINT 时，Ruby 似乎退出了睡眠例程并继续执行下一条语句。我的猜测（挥手）是这在某种程度上是由于 Ruby 在 Windows 上使用绿色线程而不是本机线程。请各位高手在这里指点一下。

`sleep`您可以通过在处理程序中重新启动来模拟 Unix-y 行为：

```
puts "start"
trap("INT") do 
  puts "interrupted"
  sleep 5
end
sleep 5
puts "end" 
```

不幸的是，每次 SIGINT 被捕获时都会重置计时器，所以它需要一些黑客攻击：

```
$interval = 5
def go_to_sleep(secs)
  $started = Time.now
  sleep secs
end
trap("INT") do 
  puts "interrupted"
  time_to_sleep = [0,$interval - (Time.now - $started)].max
  if time_to_sleep > 0
    sleep time_to_sleep
  end
end
puts "one"
go_to_sleep($interval)
puts "two"
go_to_sleep($interval)
puts "three"
go_to_sleep($interval) 
```

# c# - 如何使用 C# 以低分辨率形式提供高分辨率图像

> ID：754168
> 
> 赞同：4
> 
> 时间：2009-04-15T23:33:15.293
> 
> 标签：c#, image-processing, image-manipulation, tiff

尝试使用 300dpi 的 tif 图像在网络上显示。目前，当用户上传图片时，我正在动态创建缩略图。如果创建的页面引用了宽度为 500x500px 的高分辨率图像，我可以使用相同的功能即时转换为 gif/jpg。即将创建的 jpg 的分辨率是多少？

**编辑：**

为了进一步解释用法，用户上传了大约 3000x3000 像素的 300dpi 图像。用户正在使用这些图像创建一个目录页面，该页面将用于 pdf 打印。当他们创建页面时，我们只需要 72dpi 的图像显示到屏幕上，但对于打印，需要 300dpi 的图像。显然他们不想在页面中添加 3000x3000px 的图像，因此需要将其调整为正确的查看区域，例如 500x500px 等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T00:57:37.260

这归结为一个简单的图像调整大小。DPI 的讨论只是计算比例因子的辅助数据。

正如@Guffa 所说，您应该在上传时执行此操作，以便您可以在查看器中提供静态图像。

这将是服务器上的负载：

1.  加载完整图像。对于 3000x3000 图像，这将是大约 27 MB 的内存。
2.  调整大小。很多数学都是懒惰地完成的（仍然是 CPU 密集型的）。
3.  压缩。更多 CPU + 写入驱动器的成本。

由于您已经花时间生成缩略图，因此您可以通过不必重复上面的步骤 1 来分摊该成本和该成本（参见代码）。

上传图像后，我建议分拆一个线程来完成这项工作。这肯定是 Web 服务器上的负载，但您唯一的选择是使用第二台机器来执行工作。最终必须完成。

这是一些完成这项工作的代码。重要的几行是：

```
OutputAsJpeg(Resize(big, 300.0, 72.0), new FileStream("ScreenView.jpg"));
OutputAsJpeg(Resize(big, bigSize, 64.0), new FileStream("Thumbnail.jpg")); 
```

我们可以根据`big`需要调整图像大小。在第一行中，我们只是将其缩小固定比例（72.0 / 300.0）。在第二行，我们强制图像的最终最大尺寸为 64（比例因子 = 64.0 / 3000.0）。

```
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.IO;

BitmapSource Resize(BitmapSource original,
                    double originalScale,
                    double newScale) {
    double s = newScale / originalScale;
    return new TransformedBitmap(original, new ScaleTransform(s, s));
}

void OutputAsJpeg(BitmapSource src, Stream out) {
    var encoder = new JpegBitmapEncoder();
    encoder.Frames.Add(BitmapFrame.Create(src));
    encoder.Save(out);
}

// Load up your bitmap from the file system or whatever,
// then dump it out to a smaller version and a thumbnail.
// Assumes thumbnails have a max dimension of 64
BitmapSource big = new BitmapImage(new Uri("BigPage0.png",
                                           UriKind. RelativeOrAbsolute));
double bigSize = Math.Max(big.PixelWidth, big.PixelHeight);
OutputAsJpeg(Resize(big, 300.0, 72.0), new FileStream("ScreenView.jpg"));
OutputAsJpeg(Resize(big, bigSize, 64.0), new FileStream("Thumbnail.jpg")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T23:37:35.610

如果我明白你想要什么 - 你正在尝试制作一个非常高分辨率 tif 的 gif 或 jpg 缩略图，用于网络显示 - 如果没有，我提前道歉......

* * *

如果您希望缩略图为 500x500 像素，那就是您要创建的 jpg/gif 的分辨率 - 500x500，或至少 500x<500 或 <500x500（以适合框，除非您想要扭曲的图像）。

对于在 Web 上显示，DPI 无关紧要。只需直接使用您希望的像素分辨率即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T23:41:47.113

从技术上讲，JPG/GIF 是由 .NET 中的 Image 类以 72-DPI 创建的。但是 DPI 对浏览器实际上没有任何意义——它只是使用 500x500 的尺寸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T23:45:01.850

在 Web 上显示图像时，dpi（或更准确地说是 ppi）设置无关紧要。只有像素大小才是相关的。

您可以即时转换图像，但每次显示图像时服务器都需要进行大量工作。您应该在用户上传图像时创建所需的尺寸。

# python - Python：读取文件（从外部服务器）

> ID：754170
> 
> 赞同：0
> 
> 时间：2009-04-15T23:33:46.323
> 
> 标签：python, file

你能告诉我如何编写一个从外部服务器读取文件的 Python 脚本吗？我寻找类似于 PHP 的 file_get_contents() 或 file() 函数的东西。

如果有人可以发布这样一个脚本的整个代码，那就太好了。

提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-15T23:35:55.117

整个脚本是：

```
import urllib
content = urllib.urlopen('http://www.google.com/').read() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-16T02:10:18.363

更好的是与 Jarret 的代码相同，但使用 urllib2：

```
import urllib2
content = urllib2.urlopen('http://google.com').read() 
```

urllib2 有点更新和更现代。在您的情况下并不重要，但使用它是一种很好的做法。

# asp.net - 获取当前 Windows 用户 VB.net

> ID：754171
> 
> 赞同：2
> 
> 时间：2009-04-15T23:34:11.143
> 
> 标签：asp.net, windows, vb.net, iis-6, ldap

我尝试了多种方法来获取 vb.net/asp.net 中当前登录用户的用户名。我在 IIS 6 上运行它，并且知道它将为用户名返回 NETWORK SERVICE。我需要获取实际 Windows 框登录的用户名。

我尝试了以下代码：返回 NT AUTHORITY\NETWORK SERVICE

```
Dim User = System.Security.Principal.WindowsIdentity.GetCurrent.User
Dim UserName = User.Translate(GetType(System.Security.Principal.NTAccount)).Value 
```

任何帮助将不胜感激。如果我不清楚，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T23:37:03.960

你应该设置

```
 <authentication mode="Windows" />
 <identity impersonate="true" /> 
```

能够`Web.config`做到这一点。

# plugins - JIRA 插件：你用什么？

> ID：754177
> 
> 赞同：33
> 
> 时间：2009-04-15T23:36:39.980
> 
> 标签：plugins, jira

JIRA 是一个非常可扩展的错误/任务跟踪工具。因此，新手对应该安装哪些插件感到迷茫。

请分享您的想法，您认为哪些插件（免费和付费）是 JIRA 的“必须添加”！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-15T23:06:02.787

以下是我离不开的插件：

时间表报告 - 总结任何用户在一周内花费的时间：[http ://confluence.atlassian.com/display/JIRAEXT/Timesheet+report+and+portlet](http://confluence.atlassian.com/display/JIRAEXT/Timesheet+report+and+portlet)

图表插件 - 从任何问题导航器生成图表：http: [//confluence.atlassian.com/display/JIRAEXT/JIRA+Charting+Plugin](http://confluence.atlassian.com/display/JIRAEXT/JIRA+Charting+Plugin)

Subversion 插件 - 链接和查看 JIRA 问题的 subversion 提交历史：http: [//confluence.atlassian.com/display/JIRAEXT/JIRA+Subversion+plugin](http://confluence.atlassian.com/display/JIRAEXT/JIRA+Subversion+plugin)

标签插件 - 让您标记任何 JIRA 问题并搜索标签：[http ://confluence.atlassian.com/display/JIRAEXT/JIRA+Labels+Plugin](http://confluence.atlassian.com/display/JIRAEXT/JIRA+Labels+Plugin)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-16T01:40:48.327

我们使用 JIRA Labels 插件，它允许添加“标签”字段：[http ://confluence.atlassian.com/display/JIRAEXT/JIRA+Labels+Plugin](http://confluence.atlassian.com/display/JIRAEXT/JIRA+Labels+Plugin)

在 Atlassian 的插件页面上提到了最突出的插件（付费和免费）： [https ://plugins.atlassian.com/search/by/jira](https://plugins.atlassian.com/search/by/jira)

我工作的公司开发 JIRA Client，一个 JIRA 的桌面客户端（除非你是开源的，否则付费）：[http ://almworks.com/jiraclient](http://almworks.com/jiraclient)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-05-05T14:20:22.150

我们广泛使用[Tempo 插件](http://www.tempoplugin.com/)进行时间跟踪、项目管理、计划和计费。

我们也是[Greenhopper](http://www.atlassian.com/software/greenhopper/)项目管理（Scrum/KanBan）的忠实拥护者。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-16T03:09:28.317

我们使用了很多额外的 JIRA 插件；用于可视化查找/修复比率等的图表、用于很好地可视化每个版本的状态的发布状态插件、用于与 Confluence 集成的 SVN 集成、链接器和 Activity Stream 插件，以及可让您将 JIRA 用作Firefox 中的搜索引擎选项。

我们的一些开发人员还喜欢 JIRA 的 Eclipse 插件，它可以让他们直接从 IDE 管理他们的问题列表。

我们尝试过的唯一付费插件是 Greenhopper，因为我们是一家敏捷商店，但我们发现它不够有用，不值得购买。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T16:54:15.223

我们非常喜欢以下内容：

*   创建和链接：允许我们创建一个问题，然后创建另一个自动链接到原始问题的问题
*   JIRA Suite Utilities：非常有用的插件！最有用的功能是它能够在转换后使字段成为必需。
*   JIRA Misc Workflow Extensions：工作流的多个有用条件和验证器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-15T07:41:18.347

要将 Jira 与 Saleforce 或 SugarCRM 集成，您应该考虑[Go2group CRM 插件](https://plugins.atlassian.com/5198)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-15T12:01:22.920

我们使用[ScreenMail for JIRA](https://marketplace.atlassian.com/plugins/com.dreambroker.jira.plugins.dreambroker-jira-plugin)，因为它可以让我们为我们的问题创建截屏视频。它消除了编写规范或错误的长描述的需要。Screencasts 让我可以录制我的屏幕并将我的想法告诉我的麦克风。任何有权访问这些问题的人都可以稍后观看该视频。

这给了我更多的工作自由，因为当出现更复杂的事情时，我不需要总是召集会议。与海外合作伙伴合作也更容易，因为我大部分时间都可以在自己的时区工作。

这里重要的是您不需要安装任何额外的软件或租用硬盘空间。该插件为您完成一切。只需安装插件并开始录制。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-23T19:08:24.703

我发现[JIRA 工作流可视化插件](https://studio.plugins.atlassian.com/wiki/display/JVIZ)在第一次设置 Jira 工作流时非常有用 - 它提供了工作流的图形表示，这比 Jira 默认为您提供的步骤列表更容易查看。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-07-10T13:42:48.747

自定义 Jira 的工作方式和添加新功能：

*   [行为插件](https://marketplace.atlassian.com/plugins/com.onresolve.jira.plugin.Behaviours/version/275)
*   [Jira 脚本套件](https://marketplace.atlassian.com/plugins/com.quisapps.jira.jss/version/7)

有了这个，你几乎可以做任何事情。我用它来编写问题 24 小时通知、从保存在 Confluence 中的模板发送电子邮件、自动移动问题、关闭、克隆和创建子问题等等……

为了完成最后两个插件，一些添加特殊功能以使生活更轻松的插件：

*   [JIRA 工具包插件](https://marketplace.atlassian.com/plugins/com.atlassian.jira.toolkit/version/114)
*   [JIRA 工作流工具箱](https://marketplace.atlassian.com/plugins/com.fca.jira.plugins.workflowToolbox.workflow-toolbox/version/12)

一个显示外部页面的好插件：

*   [Jira 自定义内容插件](https://marketplace.atlassian.com/plugins/com.tngtech.jira.plugins.customcontent.jira-gadget-custom-content/version/2)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-12-13T15:26:17.470

对于更高级的 JIRA 报告、图表和仪表板，有[带有标准 JIRA 集成的 eazyBI 应用程序](https://eazybi.com/help/jira)以及[用于 JIRA 的可安装 eazyBI 报告和图表插件](https://marketplace.atlassian.com/plugins/com.eazybi.jira.plugins.eazybi-jira)。

# java - 制作这个 Java 程序的最佳方法是什么？

> ID：754184
> 
> 赞同：-1
> 
> 时间：2009-04-15T23:38:18.840
> 
> 标签：java, collections, map

这是程序简介的描述：

> 制作一个软件来跟踪大学讲师讲授的课程。对于每门课程，需要记录课程代码和标题，以及需要记录参加该课程的讲师名单。系统应允许从列表中添加和删除课程和讲师，并显示诸如参加课程的讲师和注册给特定讲师的课程的信息。

* * *

到目前为止，我有两个类 Lecturer 和 Course ，它们分别是 name id 和 code 和 title 等两个属性。然后我创建了另外两个类来保存这两个对象的数据，并且我使用了一个 Map，所以我已经映射了 Lecturer 的 id 和 name 以及课程的代码和标题，它们都在名为 LecturerList 和 CourseList 的单独类中。

但是现在我不能为讲师分配课程。已经坚持了一周了。有任何想法吗？我是否以错误的方式处理了这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T23:46:09.037

如何使用地图，例如：

```
 Map<Course, Lecturer> 
```

或者

```
 Map<Lecturer, List<Course>> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T23:51:31.177

我不同意这个问题需要一个数据库。这是您遇到问题的面向对象的部分。做对了，如果您需要持久性，数据库将随之而来。

我会像你一样从课程和讲师开始。课程将具有所需的代码和标题属性，以及教授它的讲师列表。同样，讲师将有一个名称属性和一个正在教授的课程列表。对我来说，这听起来像是一种双向的 1:m 关系。你的问题陈述的语言有点混乱，但听起来一门课程可以由几个讲师讲授（可能是因为给定课程有几个部分），一个讲师可以教授多个课程。

如果这听起来准确，我认为您不需要 CourseList 或 LecturerList 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T14:10:35.520

I would suggest storing a list of courses within the Lecturer and a list of Lecturers in the Course. Then create a service that models the "system", something like:

```
 Course {
    String code;
    String title;  
    List<Lecturer> lecturers = new ArrayList<Lecturer>();
    ... accessors & other business rules ...
    }

  Lecturer {
      int id;
      String name;
      List<Course> courses = new ArrayList<Course>();
    ... accessors & other business rules ...
    }

LectureServices {
 List<Course> coursesAvailable = new ArrayList<Course>(); 
 addCouse(Course course) {
  coursesAvailable.add(course);
 }
 addLecturerToCourse(Lecturer l, Course c) {
  ... lookup course ...
  c.addLecturer(l);
  l.addCourse(c);
 }

 ... etc ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T23:44:39.090

问题描述是尖叫“数据库！”。这个问题是关于跟踪相关信息集的，数据库软件就是为此而设计的。我对这个问题的解决方案是使用 mySQL，以及用于 mysql 的 Java 数据库连接器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T23:46:42.767

尝试为您要实现的目标创建一个功能模式（我几乎写了 UML）。理想情况下，为每个功能实体（讲师、课程等）使用一张纸、一支铅笔和画框，并为这些实体之间的每种关系类型绘制一条带标签的定向线。如果需要，使用颜色。

如果你把你画的线想象成一根绳子，你需要“拉”什么样的关系来得到你被要求的列表？

然后，只有这样，尝试设计类结构......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T18:21:13.723

从您的基本对象及其具有的属性开始

学生 -> id、姓名、课程列表

讲师 -> 姓名，课程列表

课程 -> 代码、姓名、学生名单、讲师名单

根据您的要求，课程似乎是您感兴趣的主要组成部分，因此请从这里开始。

由于学生学习课程（而不是相反），因此关键功能应该是对课程 [course.addstudent] 的操作。但是，您还需要能够列出特定学生正在学习的所有课程，因此您需要在某处按学生保存列表，并且学生对象是有意义的 [student.addCourse]。由于将学生添加到课程并创建学生正在学习的课程列表是一个单一的逻辑“动作”，因此拥有一个处理整个事情的单一功能是有意义的 - 我会回到课程，因为这是你真正维护的东西，作为这样做的地方。

伪代码并不完美，但您可以理解：

```
course.addStudent(student) {
   course.listOfStudents.add(student)
   student.addCourse(this)
}

student.addCourse(course) { student.listOfCourses.add(course) } 
```

从课程中删除学生，以及添加和删除讲师是类似的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T20:00:49.053

您是否使用地图将讲师和课程 ID 映射到属性？这听起来不太面向对象，并且在 Java 中，如果您尝试不成为 OO，您将遇到麻烦！

在我看来，这听起来像是一种应用程序，您希望在讲师和课程之间保持双向链接：即每门课程都有一位讲师 --- 总是如此吗？--- 所以 Course 有 get/setLecturer 方法，每个 Lecturer 都有一个带有 add/set/remove/getCourse(s) 方法的 Courses 容器。您不需要维护外部表来存储 Lecturer & Course 详细信息或它们的映射：在 Java 中，对象本身可以直接存储，因为所有内容实际上都是一个引用。

如果要在任何接近生产环境的地方使用它，那么您将需要一个数据库，我可以推荐 Hibernate 对象关系映射系统（尤其是使用注释驱动的持久性）来自动化大部分数据库检索、存储、级联删除，查询池策略等。但如果这只是一个教学练习，那么这将太繁重了。哦，如果你在生产中使用它，也许看看一些现有的课程管理/虚拟学习环境软件：请参阅[http://en.wikipedia.org/wiki/Virtual_learning_environment](http://en.wikipedia.org/wiki/Virtual_learning_environment)的底部以获取一些参考资料。

# python - 如何知道何时在 Python 中管理资源

> ID：754187
> 
> 赞同：4
> 
> 时间：2009-04-15T23:39:48.337
> 
> 标签：python, garbage-collection

我希望我提出了正确的问题。我试图强迫自己成为一个更好的程序员。更好是指高效。我想编写一个程序来识别目录中的文件并读取每个文件以进行进一步处理。经过一些洗牌后，我得到了这个：

```
for file in os.listdir(dir):
    y=open(dir+'\\'+file,'r').readlines()
    for line in y:
        pass
    y.close() 
```

因为 y 是一个列表，所以我得到一个 AttributeError 也就不足为奇了。当我写这个片段时，我没有考虑到这一点。

我在想这个，恐怕我有五个打开的文件（在dir指定的目录中有五个文件。

我可以修复代码以使其运行，并在打开文件后明确关闭文件。我很好奇是否需要或者 Python 是否在循环的下一次迭代中处理关闭文件。如果是这样，那么我只需要写：

```
for file in os.listdir(dir):
    y=open(dir+'\\'+file,'r').readlines()
    for line in y:
        pass 
```

我猜它（python）确实可以毫不费力地处理这个问题。我认为这可能会被处理的原因是我已经更改了 y 引用的对象/事物。当我开始第二次迭代时，不再有对使用 readlines 方法打开和读取的文件的内存引用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T23:47:26.710

当打开的文件被垃圾收集时，Python 会关闭它们，所以通常你可以忘记它——尤其是在阅读时。

也就是说，如果你想明确地关闭，你可以这样做：

```
for file in os.listdir(dir):
    f = open(dir+'\\'+file,'r')
    y = f.readlines()
    for line in y:
        pass
    f.close() 
```

但是，我们可以立即改进这一点，因为在 python 中，您可以直接迭代类似文件的对象：

```
for file in os.listdir(dir):
    y = open(dir+'\\'+file,'r')
    for line in y:
        pass
    y.close() 
```

最后，在最近的python中，有' [with](http://docs.python.org/whatsnew/2.6.html#pep-343-the-with-statement) '语句：

```
for file in os.listdir(dir):
    with open(dir+'\\'+file,'r') as y:
        for line in y:
            pass 
```

当`with`块结束时，python 将为您关闭文件并清理它。

（您可能还想寻找`os.path`更多用于操作文件名和目录的 Pythonic 工具）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T00:13:07.833

别担心。Python的垃圾收集器很好，我从来没有遇到过不关闭文件指针的问题（至少对于读取操作）

如果您确实想显式关闭文件，只需将其存储`open()`在一个变量中，然后调用`readlines()`它，例如..

```
f = open("thefile.txt")
all_lines = f.readlines()
f.close() 
```

或者，您可以使用`with`在 Python 2.5 中作为`from __future__`导入添加的语句，并在 Python 2.6 中“正确”添加：

```
from __future__ import with_statement # for python 2.5, not required for >2.6

with open("thefile.txt") as f:
    print f.readlines()

# or

the_file = open("thefile.txt")
with the_file as f:
    print f.readlines() 
```

该文件将在块结束时自动关闭。

..但是，在您发布的片段中还有其他更重要的事情需要担心，主要是文体方面的事情。

首先，尽量避免使用字符串连接手动构建路径。该[`os.path`](http://docs.python.org/library/os.path.html)模块包含许多以更可靠、跨平台的方式执行此操作的方法。

```
import os
y = open(os.path.join(dir, file), 'r') 
```

此外，您正在使用两个变量名，[`dir`](http://docs.python.org/library/functions.html#dir)并且[`file`](http://docs.python.org/library/functions.html#file)- 两者都是内置函数。[Pylint](http://www.logilab.org/857)是发现此类事情的好工具，在这种情况下，它会发出警告：

```
[W0622] Redefining built-in 'file' 
```

# json - 开发人员的 API。我应该使用什么内容类型？

> ID：754191
> 
> 赞同：2
> 
> 时间：2009-04-15T23:42:24.897
> 
> 标签：json, api, content-type

我现在正在开发面向开发人员的 API 功能，该功能使用户可以通过 API 访问我们产品的某些功能。

所有响应都是**json**格式。

我们服务器响应中的HTTP **Content-Type**标头是**text/plain；字符集=utf-8**

我应该发送其中一个：

*   **应用程序/json**
*   **文本/x-json**
*   **文本/json**

而不是文本/纯文本。

或者对于 API 功能 text/plain Content-Type 是否可以接受？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T23:45:33.750

我会`application/json`按照[官方 JSON 规范](http://www.ietf.org/rfc/rfc4627.txt)中的说明使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T23:45:03.127

[`application/json`](http://www.ietf.org/rfc/rfc4627.txt)

# javascript - 如何在 Javascript 中准确计算每日、每周、每月的复利？

> ID：754192
> 
> 赞同：3
> 
> 时间：2009-04-15T23:42:34.053
> 
> 标签：javascript, finance

我需要一个非常准确的计算器公式。现在我的公式适用于每月复利的每月供款，但是当您使用每月复利的每周供款时，我不知道如何调整公式。您可以通过下载和解压缩附件来查看我的计算器。

到目前为止，这是我在网上找到[的最准确的计算器。](http://dinkytown.com/java/CompoundSavings.html)如果我能得到一个 Javascript 公式来匹配这个计算器生成的值，我会很高兴。

每周供款和每月复利的问题在于，虽然一年有 52 周，但有些月有 5 周，有些月有 4 周。我认为他们的计算器没有考虑到这一点。我认为他们只是根据 52 周来计算，每 4 周他们复利一次。

这是我正在使用的公式：

```
var P = startingAmount;
var Y = yearsOfInvesting;
var c = getAdditionalContributionsPerPeriod;
var t = getTermsPerPeriod;
var n = t * Y;
var r = interestRate / 100 / t; // interestRate [%]
var z = 1 + r;
total = P * Math.pow(z, n) + c * (Math.pow(z, n + 1) - z) / r; 
```

给定一个场景

*   本金 1000 美元，
*   每周50美元的捐款，
*   10年，
*   每月复利，

另一个计算器说`total`应该是 30,007 美元，四舍五入。我最接近这一点的是使用这个公式是每周贡献和每周复利（但我想要每月复利！）：

```
var P = 1000;//startingAmount;
var Y = 0;//yearsOfInvesting;
var c = 50;//
var n = 520;//t * Y;
var r = .02/52;
var z = 1 + r;

mz = P * Math.pow(z, n) + c * (Math.pow(z, n + 1) - z) / r;
document.write(mz); 
```

如何使我的公式适用于每周和每日捐款？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T20:21:00.163

嗯......这两个都与那个计算器略有不同，但可能更准确地了解事情的实际完成方式（但是不确定，因为我不知道它实际上是如何完成的）：

```
function calc( startingAmount, yearsOfInvesting, additionalContributionsPerPeriod, interestRate ) {
    var interestPerDay = ( interestRate / 365 );
    var total = startingAmount;
    var date = new Date( new Date().getFullYear() + new Date().getMonth() + 1, 1 );
    var endDate = new Date( date.getFullYear() + yearsOfInvesting, date.getMonth(), date.getDate() - 1 );
    var startingWeekday = date.getDay();
    var startingDate = date.getDate();
    var runningInterest = 0;
    while( Date.parse( date.toString() ) < Date.parse( endDate.toString() ) ) {
        date.setDate( date.getDate() + 1 );
        runningInterest = runningInterest + total * interestPerDay;
        if( date.getDay() == startingWeekday ) {
            total = total + additionalContributionsPerPeriod;
        }
        if( date.getDate() == startingDate ) {
            total = total + runningInterest;
            runningInterest = 0;
        }
    }
    total = total + runningInterest;
    return total;
}
function calc2( startingAmount, yearsOfInvesting, additionalContributionsPerPeriod, interestRate ) {
    var interestPerDay = ( interestRate / 365 );
    var total = startingAmount;
    var runningInterest = 0;
    for( var day = 1; day <= 365 * yearsOfInvesting; day++ ) {
        runningInterest = runningInterest + total * interestPerDay;
        if( day % 7 == 0 ) {
            total = total + additionalContributionsPerPeriod;
        }
        if( day % 30 == 0 ) {
            total = total + runningInterest;
            runningInterest = 0;
        }
    }
    total = total + runningInterest;
    return total;
}
document.write( 3647 + "<br>" + calc( 1000, 1, 50, 0.02 ) + "<br>" + calc2( 1000, 1, 50, 0.02 ) );
document.write( "<br><br>" );
document.write( 6347 + "<br>" + calc( 1000, 2, 50, 0.02 ) + "<br>" + calc2( 1000, 2, 50, 0.02 ) );
document.write( "<br><br>" );
document.write( 14779 + "<br>" + calc( 1000, 5, 50, 0.02 ) + "<br>" + calc2( 1000, 5, 50, 0.02 ) );
document.write( "<br><br>" );
document.write( 30007 + "<br>" + calc( 1000, 10, 50, 0.02 ) + "<br>" + calc2( 1000, 10, 50, 0.02 ) );
document.write( "<br><br>" );
document.write( 31673 + "<br>" + calc( 1000, 10, 50, 0.03 ) + "<br>" + calc2( 1000, 10, 50, 0.03 ) );
document.write( "<br><br>" );
document.write( 33460 + "<br>" + calc( 1000, 10, 50, 0.04 ) + "<br>" + calc2( 1000, 10, 50, 0.04 ) );
document.write( "<br><br>" );
document.write( 35378 + "<br>" + calc( 1000, 10, 50, 0.05 ) + "<br>" + calc2( 1000, 10, 50, 0.05 ) );
document.write( "<br><br>" );
document.write( 772849953 + "<br>" + calc( 1000, 55, 50, 0.20 ) + "<br>" + calc2( 1000, 55, 50, 0.20 ) ); 
```

# editor - 支持 textmate 片段的编辑器？

> ID：754193
> 
> 赞同：4
> 
> 时间：2009-04-15T23:42:39.687
> 
> 标签：editor, code-snippets

我知道 etexteditor 和 vim/emacs。

是否有任何其他具有类似文本的片段支持的 Windows 编辑器（例如，您编写触发词，按 Tab，它会更改为某些内容，您再次按 Tab，它会更改为第一个停止，然后您可以在那里输入一些内容，它会根据定义的片段更改其他几个地方）？我知道这是一个有点奇怪的解释，但你可能知道我的意思。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T13:35:18.967

[InType](http://intype.info/home/index.php)可能“有朝一日”成为您正在寻找的东西，至少 alpha 是有希望的。遗憾的是，InType 的发布版本还远未准备好（请参阅博客和论坛）。

**更新：**目前，我正在使用[Sublime Text](http://www.sublimetext.com/)，另一个很棒的编辑器：完全支持 Python 脚本和代码片段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-28T16:39:05.163

您可以使用[vim 的 snipMate 插件](http://www.vim.org/scripts/script.php?script_id=2540)- 我使用它并且效果很好

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T00:11:12.707

[如果你使用SuperAbbrevs](http://plugins.jedit.org/plugins/?SuperAbbrevs)插件，[jEdit](http://www.jedit.org/)会做类似的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T00:18:51.177

Visual Studio 会做到这一点，但它远不如 textmate / e 好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T23:46:38.180

[用 Ruby 编写的Redcar](http://redcareditor.com/)刚刚发布，但没有经过任何改进。

除此之外，我什么都不知道。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-03T13:18:09.663

我不使用 windows，但是在寻找 linux 的替代品时，我遇到了 [e-texteditor](http://e-texteditor.com/)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-03T13:24:46.417

您可以考虑使用独立于 IDE 的应用程序来扩展代码片段。

我有一个 lorem ipsum 片段；一个包含我的 URL、我的电子邮件等，但您也可以制作包含代码的片段。

应用： Mac[用Textexpander](http://lifehacker.com/software/text-substitution/download-of-the-day-texter-windows-242812.php)，Mac用[Typinator](http://www.macility.com/products/typinator/)， Windows用[Texter](http://lifehacker.com/software/text-substitution/download-of-the-day-texter-windows-242812.php)（最后一个没经验，不知道好不好用）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-10-28T16:36:29.040

Komodo Edit 和 Komodo IDE 都支持这一点，尽管 TextMate 在这方面可以说更加精致和完善。然而，Komodo Edit 是免费的，并且与 InType 和 E for Windows 相比非常有利。

[http://www.openkomodo.com/](http://www.openkomodo.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-04T09:56:49.650

**自更新 2 RC 以来的 Visual Studio 2015**

> Visual Studio 现在支持通过将 tmSnippet 文件放入片段文件夹来使用具有 IntelliSense 完成功能的 TextMate 片段。

[https://t.co/kmG52wkOXe](https://t.co/kmG52wkOXe)

**视觉工作室代码**

> yo 代码生成器的另一个新增功能是将 TextMate Snippets (.tmSnippets) 添加到 VS Code 的选项

[http://blogs.msdn.com/b/user_ed/archive/2015/12/12/visual-studio-code-new-feature-yo-code-generator-textmate-snippets.aspx](http://blogs.msdn.com/b/user_ed/archive/2015/12/12/visual-studio-code-new-feature-yo-code-generator-textmate-snippets.aspx)

# teamcity - TeamCity 和 JIRA？

> ID：754195
> 
> 赞同：27
> 
> 时间：2009-04-15T23:43:20.543
> 
> 标签：teamcity, jira, bamboo, youtrack

TeamCity 是否可以像 Bamboo 与 JIRA 一样集成到 JIRA？我在 JetBrains 网站上找不到任何有关问题跟踪器集成的文档。

仅供参考：我听说 TeamCity 正在推出他们自己的追踪器，称为 Charisma。真的吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-07-17T18:17:18.623

TeamCity 5 EAP 支持在构建选项卡上显示来自 Jira 的问题。

[EAP 发行说明](http://www.jetbrains.net/confluence/display/TW/Darjeeling+5.0+EAP+Release+Notes)

你仍然没有我更喜欢的 Jira 本身的集成

[![替代文字](https://i.stack.imgur.com/6JPQU.png)](https://i.stack.imgur.com/6JPQU.png)

[![替代文字](https://i.stack.imgur.com/Wy171.jpg)](https://i.stack.imgur.com/Wy171.jpg)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T15:18:41.390

有这个插件 [https://marketplace.atlassian.com/plugins/com.stiltsoft.jira.teamcity](https://marketplace.atlassian.com/plugins/com.stiltsoft.jira.teamcity)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T12:19:08.757

TeamCity 没有像 Bamboo 那样与 JIRA 进行广泛集成，而且我不知道提供它的插件。然而，TeamCity 确实为外部站点提供了一个通用集成选项，可用于基本的 JIRA 集成。

从他们的文档中：

> TeamCity 允许使用正则表达式搜索和替换模式将 VCS 更改注释中的模式映射到任意 HTML 片段。最常见的用法之一是将提及的问题 ID 映射到问题跟踪系统中问题页面的超链接。

在这里阅读更多：[在评论中映射外部链接](http://www.jetbrains.net/confluence/display/TCD4/Mapping+External+Links+in+Comments)

我还没有在我们当地的 TeamCity 上设置它，所以我无法证明它的效果如何。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-24T16:08:09.823

**是的，他们正在推出自己的问题跟踪器。在这篇博文中阅读更多内容： [jetbrains 问题跟踪器 Charisma 的第一个 eap](http://blogs.jetbrains.com/teamcity/2009/05/21/first-eap-for-jetbrains-issue-tracker/)**

你可以在这里试试[Charisma](http://jetbrains.net/tracker/issues/TW) 在这里你可以看到[一些功能的视频](http://jetbrains.net/tracker/welcome)

你可以从这里下载 EAP 版本 [Charisma EAP 下载](http://jetbrains.net/confluence/display/TSYSPUB/Early+Access+Program)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-29T13:22:01.830

TeamCity 确实有一个免费的 Atlassian Confluence 插件。它提供了一种在 wiki 上显示构建状态的好方法。

您可以在 Atlassian 市场中找到它：

[https://marketplace.atlassian.com/plugins/com.stiltsoft.confluence.extra.confluence-teamcity-plugin](https://marketplace.atlassian.com/plugins/com.stiltsoft.confluence.extra.confluence-teamcity-plugin)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-24T21:04:24.447

TeamCity 有 3 个内置问题跟踪系统：

1.BugZilla 2.JIRA 3.YouTrack

还有一种方法可以为其他 ITS 安装自定义插件。我将 FogBugz 问题跟踪系统与 TeamCity 9.x 进行了集成。 [https://github.com/jozefizso/teamcity-fogbugz](https://github.com/jozefizso/teamcity-fogbugz)

# java - 服务器配置问题

> ID：754205
> 
> 赞同：1
> 
> 时间：2009-04-15T23:45:46.980
> 
> 标签：java, mysql, security, configuration, encryption

请原谅我在这里的不理解。我有一个本地 mysql 服务器，我需要能够通过加密通道从运行在 web 主机上的 java web 应用程序访问该数据。谁能推荐最好的方法来做到这一点？

谢谢！约书亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T23:53:02.923

您需要设置[SSH 隧道](http://chxo.com/be2/20040511_5667.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:01:12.607

MySQL 确实支持 SSL 连接。

检查此文档以获得帮助： [http ://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-using-ssl.html](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-using-ssl.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T00:03:52.367

SSH 端口转发

在这种情况下，可以将 db_server:3306 端口转发到 web_server:3306。然后看起来好像有一个 MySQL 数据库在 Web 服务器上本地运行，侦听端口 3306。但是，Web 服务器上的 localhost:3306 确实被安全地转发到数据库服务器上的 localhost:3306。

要进行此设置，您需要一个无密码密钥对以允许自动启动 SSH 隧道。请执行下列操作：

```
db_serv$ ssh-keygen -t rsa
db_serv$ scp .ssh/id_rsa.pub webserver:
web_serv$ cd ~; mkdir .ssh
web_serv$ cat id_rsa.pub >> .ssh/authorized_keys2
web_serv$ chmod -R go-rwx .ssh; rm id_rsa.pub
db_serv$ ssh webserver 
```

最后一个命令应该允许您从数据库服务器进行 SSH，而无需提供密码。密钥对进行身份验证。

打开 SSH 隧道的命令是：

db_server$ ssh -f -q -N -R3306:db_server:3306 网络服务器

然后，您可以在网络服务器上测试本地数据库访问。您需要在 MySQL 数据库中为您使用的用户和密码正确设置权限。

web_serv$mysql -h 127.0.0.1 -P 3306 -u 用户 -p db_name

您可能希望将上面的 'ssh' 行添加到 /etc/rc.d/rc.local（在 Red Hat 上），以便在重新启动时打开隧道。请记住，如果隧道发生故障，您的 Web 应用程序将无法访问数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T00:05:22.907

是的，MySQL 支持通过 SSL 的加密连接。

您需要使用 OpenSSL 或捆绑的 yaSSL 构建的 MySQL 服务器版本。如果您的 MySQL 服务器不是使用 SSL 支持构建的，则`--ssl`和相关选项将给出错误。

您需要使用选项和相关选项启动 MySQL 服务器 ( `mysqld`)以指定 SSL 密钥和证书。`--ssl`有关启用 MySQL 服务器以支持 SSL 的更多信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/secure-connections.html](http://dev.mysql.com/doc/refman/5.1/en/secure-connections.html)。

您的 Java 客户端还必须支持 SSL。连接时需要提供客户端证书。有关从 Java 与 MySQL 建立安全连接的更多信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/connector-j-reference-using-ssl.html](http://dev.mysql.com/doc/refman/5.1/en/connector-j-reference-using-ssl.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T00:06:19.457

这与此处的所有其他答案基本相同，但无论如何都可以。使用诸如 openVPN 之类的 VPN 隧道来加密通信。关于它的最好的部分是透明度。当您使用 VPN 时，您无需再考虑它，只需发送安全通信即可。当然，设置它并不是一件容易的事......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T23:52:08.727

AFAIK MySQL 不支持加密流（如果我错了，请纠正我）。

我可以看到的一种解决方案是在 MySQL 服务器和 Web 主机之间运行一个加密隧道，并通过它路由到数据库的连接。

# java - 使用 Maven 部署额外的 jar 文件？

> ID：754216
> 
> 赞同：23
> 
> 时间：2009-04-15T23:48:31.810
> 
> 标签：java, maven-2, pom.xml

我有一个正在以特定方式构建和部署的工件（不是作为 jar 文件）。在部署过程中，会构建一个war文件。

如何配置 pom 以便工件也作为 jar 文件部署到不同的位置？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-19T20:47:47.173

Maven`deploy`意味着将工件部署到**Maven 存储库**，而不是应用程序服务器。

像这样配置额外的 JAR 工件：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <executions>
        <execution>
            <id>make-a-jar</id>
            <phase>compile</phase>
            <goals>
                <goal>jar</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

将此新工件附加到您的项目中：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>build-helper-maven-plugin</artifactId>
    <version>1.7</version>
    <executions>
        <execution>
            <id>attach-artifacts</id>
            <phase>package</phase>
            <goals>
                <goal>attach-artifact</goal>
            </goals>
            <configuration>
                <artifacts>
                    <artifact>
                        <file>${project.build.directory}/${project.artifactId}-${project.version}.jar</file>
                        <!-- <file>${project.build.directory}/${project.build.finalName}.jar</file> - if finalName is defined -->
                        <type>jar</type>                           
                    </artifact>
                </artifacts>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-06-09T22:23:02.530

这篇[博](http://communitygrids.blogspot.com/2007/11/maven-making-war-and-jar-at-same-time.html)文及其评论给出了答案。

这三个插件配置将允许您在战争中构建/安装/部署 jar 版本。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <executions>
        <execution>
            <id>make-a-jar</id>
            <phase>compile</phase>
            <goals>
                <goal>jar</goal>
            </goals>
        </execution>
    </executions>
</plugin>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-install-plugin</artifactId>
    <executions>
        <execution>
            <phase>install</phase>
            <goals>
                <goal>install-file</goal>
            </goals>
            <configuration>
                <packaging>jar</packaging>
                <artifactId>${project.artifactId}</artifactId>
                <groupId>${project.groupId}</groupId>
                <version>${project.version}</version>
                <file>
                    ${project.build.directory}/${project.artifactId}-${project.version}.jar
                </file>
            </configuration>
        </execution>
    </executions>
</plugin>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-deploy-plugin</artifactId>
    <executions>
        <execution>
            <phase>deploy</phase>
            <goals>
                <goal>deploy-file</goal>
            </goals>
            <configuration>
                <packaging>jar</packaging>
                <generatePom>true</generatePom>
                <url>${project.distributionManagement.repository.url}</url>
                <artifactId>${project.artifactId}</artifactId>
                <groupId>${project.groupId}</groupId>
                <version>${project.version}</version>
                <file>${project.build.directory}/${project.artifactId}-${project.version}.jar</file>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-16T09:45:02.297

“maven 方式”是拆分`src/main/java`成一个单独的模块，并让 war 文件依赖于它。

如果您绝对反对这种方法，则可以使用配置文件来更改元素的内容`packaging`。我不确定这是否可能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-26T01:23:35.057

将它们分开是正确的方法。强制 maven 在同一个模块中产生一个战争和一个 jar 是可能的，但会导致你在路上遇到问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-16T00:25:57.710

您应该在 pom 文件的依赖项中添加工件的相应依赖项。

前任：

```
<dependency>
        <groupId>org.apache.myfaces.core</groupId>
        <artifactId>myfaces-api</artifactId>
        <version>1.2.2</version>
        <scope>compile</scope>
</dependency> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-25T21:33:15.383

解决此问题的一种方法是让模块构建一个 jar，然后使用程序集插件在该 war 的 WEB-INF/lib 中使用该 jar 构建一个 war 文件。我强烈建议不要这样做。最好有一个 jar 项目和一个带有构建两个模块的父项目的 war 项目。

# sql-server - MS SQL Server 触发器更新项目评级和投票数

> ID：754217
> 
> 赞同：6
> 
> 时间：2009-04-15T23:48:39.157
> 
> 标签：sql-server, triggers

*为了使这更容易理解，我将提出与论坛完全相同的问题（实际的应用程序根本与论坛无关，但我认为这样的平行对我们大多数人来说更容易掌握，实际的应用程序是关于大多数程序员不会理解的非常具体的东西（这是一个专为铁杆图形设计师设计的应用程序）。*

假设有一个线程表存储有关每个论坛线程的信息，还有一个线程评级表存储每个用户的线程评级 (1-5)。为了提高效率，我决定在线程表中缓存评分平均值和投票数，触发器听起来是更新它的好主意（我曾经在实际的应用程序代码中做这样的事情，但我认为触发器值得一试，尽管调试危险）。

如您所知，MS SQL Server 不支持每行执行触发器，它必须是每条语句。所以我尝试这样定义它：

```
CREATE TRIGGER thread_rating ON threadrating
AFTER INSERT
AS
    UPDATE thread
    SET 
        thread.rating = (thread.rating * thread.voters + SUM(inserted.rating))/(thread.voters + COUNT(inserted.rating)),
        thread.voters = thread.voters + COUNT(inserted.rating)
    FROM thread
    INNER JOIN inserted ON(inserted.threadid = thread.threadid)
    GROUP BY inserted.threadid 
```

但我收到“GROUP BY”子句的错误（这是我所期望的）。问题是，我怎样才能使这项工作？

对不起，如果这个问题很愚蠢，但这是我第一次真正尝试使用触发器。

附加信息：线程表将包含 threadid (int, primary key)、rating (float)、voters(int) 和一些与当前问题无关的其他字段。threadrating 表只包含 threadid（外键）、userid（用户表主键的外键）和 rating（1 到 5 之间的小整数）。

错误消息是“关键字 'GROUP' 附近的语法不正确”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T00:03:54.830

首先，我强烈建议您*不要*使用触发器。

如果您遇到语法错误，请检查您的括号以及您的`begin`/是否平衡`ends`。在您的情况下，您有一个`end`（最后）但没有开始。您可以通过删除`end`.

解决此问题后，您可能会收到更多错误，例如“列 x、y、z 不在聚合或分组中”。那是因为您有几列都不在其中。您需要将 thread.rating、thread.voters 等添加到您的组中，或者对它们执行某种聚合。

这都是假设有多个记录具有相同的threadID（即，它不是主键）。如果*不是*这样，那么 group by 的目的是什么？

* * *

编辑：

我被语法错误难住了。我用几个相关的子查询解决了这个问题。我猜到了你的表结构，所以根据需要修改并试试这个：

```
--CREATE TABLE ThreadRating (threadid int not null, userid int not null, rating int not null)
--CREATE TABLE Thread (threadid int not null, rating int not null, voters int not null)

ALTER TRIGGER thread_rating ON threadrating
AFTER INSERT
AS 

UPDATE Thread
SET Thread.rating = 
    (SELECT (Thread.Rating * Thread.Voters + SUM(I.Rating)) / (Thread.Voters + COUNT(I.Rating))
     FROM ThreadRating I WHERE I.ThreadID = thread.ThreadID)
  ,Thread.Voters = 
    (SELECT Thread.Voters + COUNT(I.Rating) 
     FROM ThreadRating I WHERE I.ThreadID = Thread.ThreadID)                         
FROM Thread
JOIN Inserted ON Inserted.ThreadID = Thread.ThreadID 
```

如果这是您想要的，那么我们可以检查性能/执行计划并根据需要进行修改。我们也许可以让它与小组一起工作。

* * *

**触发器的替代品**

如果您要更新仅在几个选定位置影响评级的数据，我建议直接在那里更新评级。将逻辑分解到触发器中很好，但会带来很多问题（性能、可见性等）。这可以通过一个函数来辅助。

考虑一下：每次有人触摸该表时，您的触发器都会执行。观看次数、上次更新日期等内容将执行此触发器。在这些情况下，您可以添加逻辑以使触发器短路，但它会迅速变得复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T00:20:25.180

哦！我完全误解了你的问题，我以为你在问 MySQL。过失！我将保留下面的解决方案，并将其标记为社区 wiki。也许它对在 MySQL 上有类似问题的人有用。

* * *

MySQL 触发器*按*行执行。此外，伪表“ `inserted`”是 Microsoft SQL Server 约定。

MySQL 使用伪表`NEW`并`OLD`作为[触发器语言](http://dev.mysql.com/doc/refman/5.1/en/trigger-syntax.html)的扩展。

这是您的问题的解决方案：

```
CREATE TRIGGER thread_rating 
  AFTER INSERT ON threadrating
  FOR EACH ROW
BEGIN
    UPDATE thread
    SET rating = (rating*voters + NEW.rating)/(voters+1),
        voters = voters + 1
    WHERE threadid = NEW.threadid;
END 
```

同样，您需要触发器`UPDATE`和`DELETE`：

```
CREATE TRIGGER thread_rating 
  AFTER UPDATE ON threadrating
  FOR EACH ROW
BEGIN
    UPDATE thread
    SET rating = (rating*voters - OLD.rating + NEW.rating)/voters,
    WHERE threadid = NEW.threadid;
END

CREATE TRIGGER thread_rating 
  AFTER DELETE ON threadrating
  FOR EACH ROW
BEGIN
    UPDATE thread
    SET rating = (rating*voters - OLD.rating)/(voters-1),
        voters = voters - 1
    WHERE threadid = OLD.threadid;
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T00:03:11.133

您可能会发现以下阅读内容很有帮助：

[触发器介绍](http://www.sqlteam.com/article/an-introduction-to-triggers-part-i)
[维基百科：数据库触发器](http://en.wikipedia.org/wiki/Database_trigger)

# google-app-engine - 关于 Google App Engine 查询和日期时间的帮助

> ID：754230
> 
> 赞同：1
> 
> 时间：2009-04-15T23:53:43.263
> 
> 标签：google-app-engine, datetime, gql, gqlquery

我使用以下数据：

```
date                     latitude         route      name   longitude
2009-04-11 00:50:31.640000  40.80708    White Loop  86  -77.85891
2009-04-11 00:50:27.718000  40.80708    White Loop  86  -77.85891
2009-04-11 00:50:01.562000  40.80708    White Loop  86  -77.85891
2009-04-11 00:49:48.765000  40.80708    White Loop  86  -77.85891
2009-04-11 00:49:34.796000  40.802338   White Loop  86  -77.85073
2009-04-11 00:49:22.468000  40.802338   White Loop  86  -77.85073
2009-04-11 00:48:35.671000  40.802338   White Loop  86  -77.85073
2009-04-11 00:48:29.125000  40.802338   White Loop  86  -77.85073
2009-04-11 00:47:19.906000  40.79889    White Loop  86  -77.85299
2009-04-11 00:47:03.609000  40.79889    White Loop  86  -77.85299
2009-04-11 00:46:54.437000  40.79889    White Loop  86  -77.85299
2009-04-11 00:46:52.687000  40.79889    White Loop  86  -77.85299
2009-04-11 00:46:51.125000  40.79889    White Loop  86  -77.85299
2009-04-11 00:46:48.578000  40.79889    White Loop  86  -77.85299
2009-04-11 00:46:41.406000  40.79889    White Loop  86  -77.85299
2009-04-11 00:50:31.687000  40.792194   White Loop  82  -77.863235
2009-04-11 00:50:27.781000  40.792194   White Loop  82  -77.863235
2009-04-11 00:50:01.640000  40.792194   White Loop  82  -77.863235
2009-04-11 00:49:48.812000  40.792194   White Loop  82  -77.863235
2009-04-11 00:49:34.843000  40.794914   White Loop  82  -77.866844
2009-04-11 00:49:22.531000  40.794914   White Loop  82  -77.866844
2009-04-11 00:48:35.718000  40.794914   White Loop  82  -77.866844
2009-04-11 00:48:29.156000  40.79738    White Loop  82  -77.86755
2009-04-11 00:47:19.984000  40.79738    White Loop  82  -77.86755
2009-04-11 00:47:03.656000  40.79738    White Loop  82  -77.86755
2009-04-11 00:46:54.484000  40.79738    White Loop  82  -77.86755
2009-04-11 00:46:52.734000  40.79738    White Loop  82  -77.86755
2009-04-11 00:46:51.156000  40.79738    White Loop  82  -77.86755
2009-04-11 00:46:48.640000  40.79738    White Loop  82  -77.86755
2009-04-11 00:46:41.453000  40.79738    White Loop  82  -77.86755
2009-04-11 00:50:31.656000  40.776066   White Loop  81  -77.88552
2009-04-11 00:50:27.750000  40.776066   White Loop  81  -77.88552
2009-04-11 00:50:01.593000  40.776066   White Loop  81  -77.88552
2009-04-11 00:49:48.796000  40.776066   White Loop  81  -77.88552
2009-04-11 00:49:34.812000  40.764687   White Loop  81  -77.88271
2009-04-11 00:49:22.515000  40.764687   White Loop  81  -77.88271
2009-04-11 00:48:35.703000  40.764687   White Loop  81  -77.88271
2009-04-11 00:48:29.140000  40.764687   White Loop  81  -77.88271
2009-04-11 00:47:19.937000  40.76335    White Loop  81  -77.876755
2009-04-11 00:47:03.640000  40.76335    White Loop  81  -77.876755
2009-04-11 00:46:54.468000  40.76335    White Loop  81  -77.876755
2009-04-11 00:46:52.718000  40.76335    White Loop  81  -77.876755
2009-04-11 00:46:51.156000  40.76335    White Loop  81  -77.876755
2009-04-11 00:46:48.609000  40.76335    White Loop  81  -77.876755
2009-04-11 00:46:41.437000  40.76335    White Loop  81  -77.876755 
```

如何优化查询以仅获取每个“名称”的最新行？例如，我只想结束：

```
2009-04-11 00:50:31.640000  40.80708    White Loop  86  -77.85891
2009-04-11 00:50:31.687000  40.792194   White Loop  82  -77.863235
2009-04-11 00:50:31.656000  40.776066   White Loop  81  -77.88552 
```

我希望所有结果的日期值都不超过 1 分钟。请记住，日期值是 Python 日期时间属性。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T22:08:16.457

当然这会起作用：

```
query = db.GqlQuery("SELECT * FROM [table] ORDER BY date DESC LIMIT BY [num of rows]") 
```

或者，您可以使用不等式，例如“date > 2009-04-11 00:50”，它将返回该时间之后的所有结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T01:31:34.417

在 SQL 中，您可以做各种花哨的事情，但 Google API 相当有限。

鉴于您希望所有记录的历史不超过 1 分钟，我只需向数据库询问不到 1 分钟的所有记录，然后让 python 整理结果并拒绝重复的行。

从您在此处显示的数据来看，您似乎每分钟左右每个“名称”都会获得几行，因此即使它不优雅，这种方法也应该足够了。

另一种方法是保留第二个表，其中只有每个“名称”的最新条目......并且不时地剔除该表以删除超过一分钟的记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T15:28:02.313

我想我找到了一个不错的解决方案。问题出在我的模型中：

```
date = db.DateTimeProperty(auto_now_add=True) 
```

这意味着对于该模型的每个实例，日期时间都会略有不同。这使得对我的数据进行分组非常困难。所以在我的 cron 函数中，我确保每个 api 请求都具有完全相同的时间戳。

下一个更改是创建一个 Current 表。每次 cron 运行时，它都会删除当前表中的所有内容（仅一行），并添加一个新行。然后将此新行添加到半永久存储结果的日志表中。

# c# - IDictionary 是否有任何 LRU 实现？

> ID：754233
> 
> 赞同：31
> 
> 时间：2009-04-15T23:55:56.143
> 
> 标签：c#, programming-languages, caching

我想实现一个简单的内存中 LRU 缓存系统，我正在考虑一种基于 IDictionary 实现的解决方案，它可以处理散列 LRU 机制。来自java，我有经验`LinkedHashMap`，它可以很好地满足我的需要：我在任何地方都找不到类似的.NET解决方案。

有没有人开发过或者有过这样的经历？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2010-09-15T15:44:43.793

这是我们为我们拥有的网站开发的一个非常简单和快速的实现。

我们试图尽可能地改进代码，同时保持线程安全。我认为代码非常简单明了，但是如果您需要一些解释或与如何使用它相关的指南，请不要犹豫。

```
namespace LRUCache
{
    public class LRUCache<K,V>
    {
        private int capacity;
        private Dictionary<K, LinkedListNode<LRUCacheItem<K, V>>> cacheMap = new Dictionary<K, LinkedListNode<LRUCacheItem<K, V>>>();
        private LinkedList<LRUCacheItem<K, V>> lruList = new LinkedList<LRUCacheItem<K, V>>();

        public LRUCache(int capacity)
        {
            this.capacity = capacity;
        }

        [MethodImpl(MethodImplOptions.Synchronized)]
        public V get(K key)
        {
            LinkedListNode<LRUCacheItem<K, V>> node;
            if (cacheMap.TryGetValue(key, out node))
            {
                V value = node.Value.value;
                lruList.Remove(node);
                lruList.AddLast(node);
                return value;
            }
            return default(V);
        }

        [MethodImpl(MethodImplOptions.Synchronized)]
        public void add(K key, V val)
        {
            if (cacheMap.TryGetValue(key, out var existingNode))
            {
                lruList.Remove(existingNode);
            }
            else if (cacheMap.Count >= capacity)
            {
                RemoveFirst();
            }

            LRUCacheItem<K, V> cacheItem = new LRUCacheItem<K, V>(key, val);
            LinkedListNode<LRUCacheItem<K, V>> node = new LinkedListNode<LRUCacheItem<K, V>>(cacheItem);
            lruList.AddLast(node);
            // cacheMap.Add(key, node); - here's bug if try to add already existing value
            cacheMap[key] = node;
        }

        private void RemoveFirst()
        {
            // Remove from LRUPriority
            LinkedListNode<LRUCacheItem<K,V>> node = lruList.First;
            lruList.RemoveFirst();

            // Remove from cache
            cacheMap.Remove(node.Value.key);
        }
    }

    class LRUCacheItem<K,V>
    {
        public LRUCacheItem(K k, V v)
        {
            key = k;
            value = v;
        }
        public K key;
        public V value;
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-16T00:07:36.100

基类库中没有任何东西可以做到这一点。

在免费方面，也许像 C5 的[HashedLinkedList](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.HashedLinkedList_1.htm)这样的东西会起作用。

如果您愿意付费，不妨看看[这个 C# 工具包。](http://recursionsw.com/Products/csharp.html) 它包含一个实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-03T16:01:22.800

发现你在谷歌搜索时回答，也发现了这个：

[http://code.google.com/p/csharp-lru-cache/](http://code.google.com/p/csharp-lru-cache/)

> [csharp-lru-cache](http://code.google.com/p/csharp-lru-cache/) : LRU 缓存集合类库
> 
> 这是一个集合类，用作最近最少使用的缓存。它实现`ICollection<T>`了 ，但也公开了其他三个成员：
> 
> *   `Capacity`，缓存可以包含的最大项目数。一旦集合达到容量，向缓存中添加新项目将导致最近最少使用的项目被丢弃。如果在构造时将Capacity设置为0，则缓存不会自动丢弃项目。
> *   `Oldest`，集合中最旧的（即最近最少使用的）项目。
> *   `DiscardingOldestItem`，当缓存即将丢弃其最旧的项目时引发的事件。这是一个极其简单的实现。虽然它的 Add 和 Remove 方法是线程安全的，但它不应该在繁重的多线程环境中使用，因为在这些方法期间整个集合被锁定。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-28T21:11:25.033

我最近发布了一个名为 LurchTable 的类来解决对 LinkedHashMap 的 C# 变体的需求。[可以在这里找到](http://csharptest.net/1279/introducing-the-lurchtable-as-a-c-version-of-linkedhashmap/)对 LurchTable 的简要讨论。

基本特点：

*   通过插入、修改或访问链接的并发字典
*   Dictionary/ConcurrentDictionary 接口支持
*   Peek/TryDequeue/Dequeue 访问“最旧”条目
*   允许对插入时强制执行的项目进行硬限制
*   公开添加、更新和删除的事件

源代码：[http ://csharptest.net/browse/src/Library/Collections/LurchTable.cs](http://csharptest.net/browse/src/Library/Collections/LurchTable.cs)

GitHub：[https ://github.com/csharptest/CSharpTest.Net.Collections](https://github.com/csharptest/CSharpTest.Net.Collections)

HTML 帮助：[http ://help.csharptest.net/](http://help.csharptest.net/?CSharpTest.Net.Library~CSharpTest.Net.Collections.LurchTable%602.html)

> PM> 安装包[CSharpTest.Net.Collections](https://www.nuget.org/packages/CSharpTest.Net.Library/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-04-06T22:05:53.727

这将[Martin](https://stackoverflow.com/users/448597)的代码与[T 先生](https://stackoverflow.com/users/2078975/mr-t)的建议相结合，使其对 Stylecop 友好。哦，它还允许在值循环出缓存时对其进行处理。

```
namespace LruCache
{
    using System;
    using System.Collections.Generic;

    /// <summary>
    /// A least-recently-used cache stored like a dictionary.
    /// </summary>
    /// <typeparam name="TKey">
    /// The type of the key to the cached item
    /// </typeparam>
    /// <typeparam name="TValue">
    /// The type of the cached item.
    /// </typeparam>
    /// <remarks>
    /// Derived from https://stackoverflow.com/a/3719378/240845
    /// </remarks>
    public class LruCache<TKey, TValue>
    {
        private readonly Dictionary<TKey, LinkedListNode<LruCacheItem>> cacheMap =
            new Dictionary<TKey, LinkedListNode<LruCacheItem>>();

        private readonly LinkedList<LruCacheItem> lruList =
            new LinkedList<LruCacheItem>();

        private readonly Action<TValue> dispose;

        /// <summary>
        /// Initializes a new instance of the <see cref="LruCache{TKey, TValue}"/>
        /// class.
        /// </summary>
        /// <param name="capacity">
        /// Maximum number of elements to cache.
        /// </param>
        /// <param name="dispose">
        /// When elements cycle out of the cache, disposes them. May be null.
        /// </param>
        public LruCache(int capacity, Action<TValue> dispose = null)
        {
            this.Capacity = capacity;
            this.dispose = dispose;
        }

        /// <summary>
        /// Gets the capacity of the cache.
        /// </summary>
        public int Capacity { get; }

        /// <summary>Gets the value associated with the specified key.</summary>
        /// <param name="key">
        /// The key of the value to get.
        /// </param>
        /// <param name="value">
        /// When this method returns, contains the value associated with the specified
        /// key, if the key is found; otherwise, the default value for the type of the 
        /// <paramref name="value" /> parameter. This parameter is passed
        /// uninitialized.
        /// </param>
        /// <returns>
        /// true if the <see cref="T:System.Collections.Generic.Dictionary`2" /> 
        /// contains an element with the specified key; otherwise, false.
        /// </returns>
        public bool TryGetValue(TKey key, out TValue value)
        {
            lock (this.cacheMap)
            {
                LinkedListNode<LruCacheItem> node;
                if (this.cacheMap.TryGetValue(key, out node))
                {
                    value = node.Value.Value;
                    this.lruList.Remove(node);
                    this.lruList.AddLast(node);
                    return true;
                }

                value = default(TValue);
                return false;
            }
        }

        /// <summary>
        /// Looks for a value for the matching <paramref name="key"/>. If not found, 
        /// calls <paramref name="valueGenerator"/> to retrieve the value and add it to
        /// the cache.
        /// </summary>
        /// <param name="key">
        /// The key of the value to look up.
        /// </param>
        /// <param name="valueGenerator">
        /// Generates a value if one isn't found.
        /// </param>
        /// <returns>
        /// The requested value.
        /// </returns>
        public TValue Get(TKey key, Func<TValue> valueGenerator)
        {
            lock (this.cacheMap)
            {
                LinkedListNode<LruCacheItem> node;
                TValue value;
                if (this.cacheMap.TryGetValue(key, out node))
                {
                    value = node.Value.Value;
                    this.lruList.Remove(node);
                    this.lruList.AddLast(node);
                }
                else
                {
                    value = valueGenerator();
                    if (this.cacheMap.Count >= this.Capacity)
                    {
                        this.RemoveFirst();
                    }

                    LruCacheItem cacheItem = new LruCacheItem(key, value);
                    node = new LinkedListNode<LruCacheItem>(cacheItem);
                    this.lruList.AddLast(node);
                    this.cacheMap.Add(key, node);
                }

                return value;
            }
        }

        /// <summary>
        /// Adds the specified key and value to the dictionary.
        /// </summary>
        /// <param name="key">
        /// The key of the element to add.
        /// </param>
        /// <param name="value">
        /// The value of the element to add. The value can be null for reference types.
        /// </param>
        public void Add(TKey key, TValue value)
        {
            lock (this.cacheMap)
            {
                if (this.cacheMap.Count >= this.Capacity)
                {
                    this.RemoveFirst();
                }

                LruCacheItem cacheItem = new LruCacheItem(key, value);
                LinkedListNode<LruCacheItem> node = 
                    new LinkedListNode<LruCacheItem>(cacheItem);
                this.lruList.AddLast(node);
                this.cacheMap.Add(key, node);
            }
        }

        private void RemoveFirst()
        {
            // Remove from LRUPriority
            LinkedListNode<LruCacheItem> node = this.lruList.First;
            this.lruList.RemoveFirst();

            // Remove from cache
            this.cacheMap.Remove(node.Value.Key);

            // dispose
            this.dispose?.Invoke(node.Value.Value);
        }

        private class LruCacheItem
        {
            public LruCacheItem(TKey k, TValue v)
            {
                this.Key = k;
                this.Value = v;
            }

            public TKey Key { get; }

            public TValue Value { get; }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-06-16T00:11:10.563

我实现了一个专为并发工作负载设计的线程安全伪 LRU。性能非常接近 ConcurrentDictionary，比 MemoryCache 快约 10 倍，命中率也优于传统的 LRU。下面的 github 链接中提供了完整的分析。

用法如下所示：

```
int capacity = 666;
var lru = new ConcurrentLru<int, SomeItem>(capacity);

var value = lru.GetOrAdd(1, (k) => new SomeItem(k)); 
```

GitHub：[https ://github.com/bitfaster/BitFaster.Caching](https://github.com/bitfaster/BitFaster.Caching)

```
Install-Package BitFaster.Caching 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-16T00:17:22.893

EntLib的[缓存应用程序块](http://msdn.microsoft.com/en-us/library/dd203248.aspx)具有开箱即用的 LRU 清除选项，并且可以在内存中。对于您想要的东西，它可能有点重量级。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-16T00:09:41.180

我不相信。我当然已经看到在各种不相关的项目中多次实施手动卷轴（这或多或少证实了这一点。如果有的话，肯定至少有一个项目会使用它）。

实现起来非常简单，通常通过创建一个包含 a`Dictionary`和 a的类来完成`List`。

键进入列表（按顺序），项目进入字典。
当您向集合中添加新项目时，该函数会检查列表的长度，取出最后一个键（如果它太长），然后从字典中逐出键和值以进行匹配。真的不多了

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-11-06T00:11:13.683

我喜欢劳伦斯的实施。Hashtable + LinkedList 是一个很好的解决方案。

关于线程，我不会用 锁定它`[MethodImpl(MethodImplOptions.Synchronized)]`，而是使用`ReaderWriterLockSlim`或自旋锁（因为争用通常很快）。

在`Get`函数中，我会首先检查它是否已经是第一项，而不是总是删除和添加。这使您可以将其保存在不会阻止其他读者的读者锁中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-06-30T14:01:06.247

我现在在 aws-sdk-net 中偶然发现了 LruCache.cs：[https ://github.com/aws/aws-sdk-net/blob/master/sdk/src/Core/Amazon.Runtime/Internal/Util/LruCache 。CS](https://github.com/aws/aws-sdk-net/blob/master/sdk/src/Core/Amazon.Runtime/Internal/Util/LruCache.cs)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-16T00:20:33.527

如果它是一个 asp.net 应用程序，您可以使用缓存类 [1]，但您将与其他缓存的内容竞争空间，这可能是您想要的，也可能不是。

[1] [http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)

# c - 在函数返回时，高分辨率调用是否会导致系统时间错误？

> ID：754234
> 
> 赞同：4
> 
> 时间：2009-04-15T23:55:59.997
> 
> 标签：c, time

给定一个以最高优先级运行并请求当前时间的 C 进程，返回的时间是否根据代码返回用户进程空间所需的时间量进行了调整？拿到的时候是不是过期了？作为一种测量，在循环中采用已知数量的汇编指令的执行时间并询问它之前和之后的时间，可以为您提供错误的近似值。我知道这一定是科学应用中的一个问题？我不打算在不久的将来任何时候编写涉及任何超级对撞机的软件。我已阅读有关该主题的几篇文章，但它们并未表明已进行任何更正以使给您的时间略早于系统读取的时间。我是否应该因为其他事情而失眠？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T23:59:46.603

是的，他们几乎肯定是“错误的”。

对于 Windows，计时功能不考虑转换回用户模式所需的时间。即使考虑到这一点，如果函数返回，并且您的代码在捕获返回值之前遇到页面错误/被换出/等，它也无法纠正。

通常，在计时时，您应该围绕大量迭代来确定开始和结束时间，以消除这些不确定性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T00:00:36.787

是的，您得到的答案会偏离一定的（少量）；我从未听说过补偿平均返回时间的计时器功能，因为这样的事情几乎不可能很好地预测。此类事情通常通过简单地读取硬件中的寄存器并返回值或缩放到适当时间刻度的版本来实现。

也就是说，我不会为此失眠。防止这种开销以任何显着方式影响您的测量的公认方法是*不要将这些计时器用于短事件*。通常，您会对同一事物的数百、数千或百万次执行计时，然后除以执行次数来估算平均时间。这样的事情通常比为单个实例计时更有用，因为它考虑了平均缓存行为、操作系统影响等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T00:19:39.550

不，你不应该为此失眠。在具有多层内存访问的流水线处理器、运行具有内存管理、设备、中断处理程序的多任务操作系统的系统上，再多的调整或其他软件技巧都不会产生完美的结果……即使您的进程具有最高优先级。

另外，无论如何，取两次这样的时间之*差*将抵消恒定的开销。

编辑：我的意思**是，你应该为***其他*事情失眠:)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T00:39:48.333

大多数涉及高分辨率计时器的现实世界问题都用于分析，其中时间在 START 期间读取一次，在 FINISH 期间再读取一次。**所以大多数时候~几乎~在START**和**FINISH**中都涉及相同数量的延迟。因此它工作正常。

现在，对于核反应堆，WINDOWS 或其他许多具有通用功能的操作系统可能不适合。我猜他们使用**实时**操作系统，这可能比桌面操作系统提供更准确的时间值。

# java - 迭代后从失败的 HashSet 中删除

> ID：754235
> 
> 赞同：3
> 
> 时间：2009-04-15T23:56:24.990
> 
> 标签：java, collections, hash, iterator, hashset

我正在用 java 编写一个凝聚聚类算法，并且在删除操作时遇到了问题。当集群数量达到初始数量的一半时，它似乎总是失败。

在下面的示例代码中，`clusters`是一个`Collection<Collection<Integer>>`.

```
 while(clusters.size() > K){
           // determine smallest distance between clusters
           Collection<Integer> minclust1 = null;
           Collection<Integer> minclust2 = null;
           double mindist = Double.POSITIVE_INFINITY;

           for(Collection<Integer> cluster1 : clusters){
                for(Collection<Integer> cluster2 : clusters){
                     if( cluster1 != cluster2 && getDistance(cluster1, cluster2) < mindist){
                          minclust1 = cluster1;
                          minclust2 = cluster2;
                          mindist = getDistance(cluster1, cluster2);
                     }
                }
           }

           // merge the two clusters
           minclust1.addAll(minclust2);
           clusters.remove(minclust2);
      } 
```

经过几次循环后，`clusters.remove(minclust2)`最终返回false，但我不明白为什么。

我首先创建了 10 个集群来测试这段代码，每个集群都有一个从 1 到 10 的整数。距离是 0 到 1 之间的随机数。这是添加一些 println 语句后的输出。在集群数量之后，我打印出实际的集群、合并操作以及 clusters.remove(minclust2) 的结果。

```
Clustering: 10 clusters
[[3], [1], [10], [5], [9], [7], [2], [4], [6], [8]]
[5] <- [6]
true
Clustering: 9 clusters
[[3], [1], [10], [5, 6], [9], [7], [2], [4], [8]]
[7] <- [8]
true
Clustering: 8 clusters
[[3], [1], [10], [5, 6], [9], [7, 8], [2], [4]]
[10] <- [9]
true
Clustering: 7 clusters
[[3], [1], [10, 9], [5, 6], [7, 8], [2], [4]]
[5, 6] <- [4]
true
Clustering: 6 clusters
[[3], [1], [10, 9], [5, 6, 4], [7, 8], [2]]
[3] <- [2]
true
Clustering: 5 clusters
[[3, 2], [1], [10, 9], [5, 6, 4], [7, 8]]
[10, 9] <- [5, 6, 4]
false
Clustering: 5 clusters
[[3, 2], [1], [10, 9, 5, 6, 4], [5, 6, 4], [7, 8]]
[10, 9, 5, 6, 4] <- [5, 6, 4]
false
Clustering: 5 clusters
[[3, 2], [1], [10, 9, 5, 6, 4, 5, 6, 4], [5, 6, 4], [7, 8]]
[10, 9, 5, 6, 4, 5, 6, 4] <- [5, 6, 4]
false 
```

[10, 9, 5, 6, 4, 5, 6, 4, ...] 集合从那里无限增长。

**编辑：澄清一下，我`HashSet<Integer>`对集群中的每个集群使用 a (a `HashSet<HashSet<Integer>>)`.**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T00:47:41.510

啊。当您更改已经在 a `Set`（或`Map`键）中的值时，它不一定在正确的位置，并且哈希码将被缓存。您需要删除它，更改它，然后重新插入它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:31:41.690

在显示的测试中，`remove`第一次尝试删除包含多个整数的集合时失败。总是这样吗？

使用的 Collection 的具体类型是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T00:23:43.503

明显的问题`clusters.remove`可能是`equals`用于查找要删除的元素。不幸`equals`的是，集合通常比较元素是否相同，而不是是否是同一个集合（我相信 C# 在这方面做出了更好的选择）。

一个简单的解决方法是创建`clusters`为`Collections.newSetFromMap(new IdentityHashMap<Collection<Integer>, Boolean>())`（我认为）。

# c# - C#：有没有办法在列表视图中返回对所选项目的引用？

> ID：754247
> 
> 赞同：1
> 
> 时间：2009-04-16T00:02:19.123
> 
> 标签：c#, .net, winforms

C#：有没有办法在列表视图中返回对所选项目的引用？

就像在 selectedindexchanged 中一样，有没有办法返回被选中的索引项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T00:04:21.227

任何一个

```
myListView.Items[ myListView.SelectedIndices[ 0 ] ]; 
```

或者

```
myListView.SelectedItems[ 0 ]; 
```

应该管用

# javascript - 如何通过 JavaScript 将条目插入浏览历史记录

> ID：754248
> 
> 赞同：3
> 
> 时间：2009-04-16T00:02:20.857
> 
> 标签：javascript, back-button, back-button-control

如何在浏览历史记录中插入一个条目，以便后退按钮在第一次点击时转到不同的页面，然后在第二次点击时转到原始页面？

因此，如果您需要很好地解释我想要做什么，请访问： [https ://secure.exitjunction.com/howitworks.jsp](https://secure.exitjunction.com/howitworks.jsp)

我只需要一个脚本，允许我在浏览历史记录中插入一个条目，这样当点击后退按钮时，用户将被带到我的特殊页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T00:16:07.140

这是一个 jQuery 插件的链接：

[jQuery插件](http://github.com/christianhellsten/jquery-google-analytics/tree/master)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:16:44.473

您不能直接操纵浏览历史记录。

这样的功能将被视为一个安全漏洞（而且确实如此），所以我怀疑任何浏览器都会实现它。

但是，您可以通过执行以下操作来破解它：

注意：这完全取决于引用者将被后退按钮更改的假设。我不认为这实际上会发生，所以它很可能不会起作用，但是，嘿。

您有两个页面，PageA 和 PageB。

*   用户点击 PageA
*   页面（在客户端，使用 javascript）检查 HTTP 引荐来源网址，如果不是 PageB，则立即将用户重定向到 PageB。
*   现在您在 PageB 上，如果用户单击后退按钮，它将返回到 PageA。
*   PageA会检查referrer，~~可能~~是PageB，所以没有重定向。

# css - 如何将类添加到 CodeIgniter 锚点

> ID：754256
> 
> 赞同：12
> 
> 时间：2009-04-16T00:05:40.020
> 
> 标签：css, codeigniter

我有以下内容：

```
'.anchor('','Home').' 
```

我想向其中添加以下 CSS 类：

```
class="top_parent" 
```

这样当它在浏览器中呈现时，代码将如下所示：

```
<a href="#" class="top_parent">Home</a> 
```

在此先感谢，非常感谢任何帮助。

--

汤姆

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-16T00:09:49.637

```
anchor('#', 'Home', array('class' => 'top_parent')); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-16T00:11:30.193

Codeignitor 函数定义如下：

```
function anchor($uri = '', $title = '', $attributes = '') 
```

我会先尝试发送一个带有类键和值的数组。

这些函数位于 \system\helpers\ 文件夹中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T00:08:48.110

您可以为 Anchor 指定属性的关联数组。因此，例如：

锚（''，'家'，数组（'class' => 'top_parent'））；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-08T15:24:15.627

试试这个：

```
$myClass = array('class' => 'top_parent');

echo anchor('#', 'Home', $myClass); 
```

希望这对你来说很清楚。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-18T04:03:21.663

它也可以这样使用：

```
<?php echo anchor('#', 'Home', 'class="top_parent"' ); ?> 
```

如果您想要额外的属性，例如标题，可以这样做：

```
<?php echo anchor('#', 'Home', 'class="top_parent" title="Home"' ); ?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-05T19:11:29.507

> 来自 Codeigniter 的[手册](https://ellislab.com/codeigniter/user-guide/helpers/url_helper.html)：
> 
> **anchor()**有三个可选参数：

```
anchor(uri segments, text, attributes) 
```

简单的例子：

```
anchor(url,text,array('class'=>'class1')); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-07-18T14:21:23.163

例如，如果您有一个名为的 css**类**`btn`和一个名为 submit 的按钮，用于提交（调用一个名为 sub 的提交控制器类）您可以这样做

```
<?php echo anchor('sub', 'submit', 'class="btn" ');? > 
```

# apache-flex - 如何在 Flex 中读取配置文件？

> ID：754273
> 
> 赞同：2
> 
> 时间：2009-04-16T00:12:01.207
> 
> 标签：apache-flex, mxml, config

我现在正在为学校做一个项目，我们正在尝试对其进行设置，以便它易于部署。它的 webapp 部分完全用 Adob​​e flex 编写。

但是，我们需要链接到代码中的某些文件/url，它们在不同的机器上是不同的。

例如，我的服务器可能使用 8180 作为端口，而其他人使用 8080。或者一个人使用 Windows，因此文件路径为 C:/... 而我的则为 /home/...

有什么方法可以将这些文件放入单独的配置文件中并在 mxml 文件中动态读取它们？

如果我们不必为每个单独的部署重新编译，那就太好了……

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T16:46:34.693

查看[appcorelib](http://code.google.com/p/appcorelib/)，文档将向您展示如何使用资产文件夹中的相对 URL：

```
loadXML("assets/xml/config.xml); 
```

如果 xml 和 flex 应用程序在同一台服务器上，则无需担心跨域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T15:47:08.163

您可以使用 HTTPService 加载位于相对于 Flex 应用程序 SWF 的位置的 XML 文件（或任何文本文件）。只需在应用程序启动时执行 HTTPService，解析文件，并在任何需要的地方提供数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T05:27:25.113

You can pass in parameters into a SWF by adding FlashVars to the HTML that it's running from. [FLashVars](http://livedocs.adobe.com/flex/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001005.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T00:17:55.217

如果您启用了本地文件沙箱，您可以使用 URLLoader 读取本地文件：

[http://livedocs.adobe.com/flex/201/html/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Book_Parts&file=05B_Security_176_04.html](http://livedocs.adobe.com/flex/201/html/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Book_Parts&file=05B_Security_176_04.html)

但是，您的 SWF 也必须是本地的。

如果您正在远程加载 SWF，您可以连接回加载服务器以获取资源列表。在大多数情况下，这应该是首选的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T14:28:27.613

我非常同意brd6644。您将需要配置文件所在的服务器上的跨域策略文件。只需将以下 XML 复制到名为“crossdomain.xml”的文件中，并将其放在包含配置文件的服务器的服务器根目录中。

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy 
  SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <allow-access-from domain="*" />
</cross-domain-policy> 
```

如果 swf 与配置文件位于同一台服务器上，则您可能不需要它。此外，如您所见，此跨域策略允许来自所有域的访问，因此如果您非常关心安全性（对于学校项目可能并不重要），请阅读它们以了解如何配置。这是一篇好[文章](http://labs.adobe.com/wiki/index.php/Flex:Accessing_Data#Using_crossdomain.xml_files)

此外，这里是一些示例 HTTPService 代码：

```
private function init():void{
     get_bands_service.url = yeswewillArtistsURL;
     get_bands_service.method = "GET";
     get_bands_service.addEventListener(FaultEvent.FAULT, onServiceFault);
     get_bands_service.requestTimeout = 20;
     get_bands_service.send();
}

<mx:HTTPService id="get_bands_service" result="parseBandsServiceResult();" useProxy="false" /> 
```

# haskell - 具有 IO 效果的 Haskell 流

> ID：754279
> 
> 赞同：11
> 
> 时间：2009-04-16T00:15:02.183
> 
> 标签：haskell, io, stream

考虑以下 Haskell 程序。我正在尝试以“流样式”进行编程，其中函数对流进行操作（此处仅作为列表实现）。像 normalStreamFunc 这样的东西非常适合惰性列表。我可以将一个无限列表传递给 normalStreamFunc 并有效地得到另一个无限列表，但函数映射到每个值。像 effectfulStreamFunc 这样的东西效果不佳。IO 操作意味着我需要先评估整个列表，然后才能得出单个值。例如，程序的输出是这样的：

```
a
b
c
d
"[\"a\",\"b\"]" 
```

但我想要的是一种编写 effectfulStreamFunc 的方法，以便程序产生这个：

```
a
b
"[\"a\",\"b\"]" 
```

不评估剩余的操作。我可以想象一个使用 unsafePerformIO 的解决方案，但假设我将其从桌面上移除。这是程序：

```
import IO

normalStreamFunc :: [String] -> [String]
normalStreamFunc (x:xs) = reverse(x) : normalStreamFunc xs

effectfulStreamFunc :: [String] -> IO [String]
effectfulStreamFunc [] = return []
effectfulStreamFunc (x:xs) = do
    putStrLn x
    rest <- effectfulStreamFunc xs
    return (reverse(x):rest)

main :: IO ()
main = do
     let fns = ["a", "b", "c", "d"]
     es <- effectfulStreamFunc fns
     print $ show $ take 2 es 
```

**更新：**

感谢大家的有益和周到的反馈。我以前没有见过`sequence`运营商，这有助于了解。我曾想过一种（不太优雅的）方法来传递 IO（字符串）值而不是字符串，但是对于实用性有限的编程风格，因为我希望其他流函数对字符串本身起作用，而不是对可以产生字符串的动作。但是，基于对其他回应的思考，我想我明白为什么这通常是无法解决的。在我介绍的简单案例中，我真正想要的是`sequence`运算符，因为我认为流排序暗示了对动作的排序。事实上，没有必要隐含这样的排序。当我想到一个将两个流作为输入的流函数（例如，成对添加两个流）时，这对我来说变得更清楚了。如果两个“传入”流都执行 IO，则这些 IO 操作的顺序是未定义的（当然，除非我们通过自己在 IO monad 中对其进行排序来定义它）。问题已解决，谢谢大家！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-16T01:32:42.573

这段代码怎么样：

```
import IO

normalStreamFunc :: [String] -> [String]
normalStreamFunc (x:xs) = reverse(x) : normalStreamFunc xs

effectfulStreamFunc :: [String] -> [IO (String)]
effectfulStreamFunc [] = []
effectfulStreamFunc (x:xs) =
    let rest = effectfulStreamFunc xs in
        (putStrLn x >> return x) : rest

main :: IO ()
main = do
     let fns = ["a", "b", "c", "d"]
     let appliedFns = effectfulStreamFunc fns
     pieces <- sequence $ take 2 appliedFns
     print $ show $ pieces 
```

而不是 effectfulStreamFunc 实际执行任何 IO，而是创建一个要执行的 IO 操作列表。（注意类型签名更改。）然后主函数执行其中 2 个操作，运行它们并打印结果：

```
a
b
"[\"a\",\"b\"]" 
```

这是有效的，因为类型`IO (String)`只是一个函数/值，就像您可以放入列表、传递等的任何其他类型一样。请注意，do 语法不会出现在“effectfulStreamFunc”中——它实际上是一个纯函数，尽管签名中的“IO”。只有当我们`sequence`在 main 上运行时，效果才会真正发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T00:28:27.003

我不太了解您的主要目标，但是您对 putStrLn 的使用会导致对整个列表的评估，因为它会在执行时评估参数。考虑

```
import IO

normalStreamFunc :: [String] -> [String]
normalStreamFunc (x:xs) = reverse(x) : normalStreamFunc xs

effectfulStreamFunc :: [String] -> IO [String]
effectfulStreamFunc [] = return []
effectfulStreamFunc (x:xs) = do
    rest <- effectfulStreamFunc xs
    return (reverse(x):rest)

main :: IO ()
main = do
     let fns = ["a", "b", undefined,"c", "d"]
     es <- effectfulStreamFunc fns
     print $ show $ take 2 es 
```

这会导致 "[\"a\",\"b\"]"，而使用 putStrLn 版本会导致异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T01:50:16.323

正如 Tomh 所提到的，您不能真正“安全地”执行此操作，因为您正在破坏 Haskell 中的引用透明性。你试图懒惰地执行副作用，但是关于懒惰的事情是你不能保证以什么顺序或事情是否被评估，所以在 Haskell 中，当你告诉它执行副作用时，它总是被执行，并按照指定的确切顺序。`effectfulStreamFunc`（即在这种情况下，在 之前的递归调用的副作用`return`，因为那是它们被列出的顺序）如果不使用 unsafe，您不能懒惰地执行此操作。

你可以尝试使用类似的东西`unsafeInterleaveIO`，这就是在 Haskell 中实现惰性 IO（例如`hGetContents`）的方式，但它有其自身的问题；你说你不想使用“不安全”的东西。

```
import System.IO.Unsafe (unsafeInterleaveIO)

effectfulStreamFunc :: [String] -> IO [String]
effectfulStreamFunc [] = return []
effectfulStreamFunc (x:xs) = unsafeInterleaveIO $ do
    putStrLn x
    rest <- effectfulStreamFunc xs
    return (reverse x : rest)

main :: IO ()
main = do
     let fns = ["a", "b", "c", "d"]
     es <- effectfulStreamFunc fns
     print $ show $ take 2 es 
```

在这种情况下，输出如下所示

```
"a
[\"a\"b
,\"b\"]" 
```

# java - 将原始 long 数组转换为 Long 列表

> ID：754294
> 
> 赞同：143
> 
> 时间：2009-04-16T00:19:41.953
> 
> 标签：java, arrays, collections, boxing

这可能是一个简单的，headdesk 类型的问题，但我的第一次尝试出人意料地完全失败了。我想获取一组原始 long 并将其变成一个列表，我试图这样做：

```
long[] input = someAPI.getSomeLongs();
List<Long> inputAsList = Arrays.asList(input); //Total failure to even compile! 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2014-04-16T18:41:11.430

从 Java 8 开始，您现在可以为此使用流：

```
long[] arr = { 1, 2, 3, 4 };
List<Long> list = Arrays.stream(arr).boxed().collect(Collectors.toList()); 
```

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2009-12-29T12:19:13.693

我发现使用 apache commons lang ArrayUtils（[JavaDoc](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/ArrayUtils.html#toObject(long[]))，[Maven 依赖](https://mvnrepository.com/artifact/org.apache.commons/commons-lang3/latest)项）很方便

```
import org.apache.commons.lang3.ArrayUtils;
...
long[] input = someAPI.getSomeLongs();
Long[] inputBoxed = ArrayUtils.toObject(input);
List<Long> inputAsList = Arrays.asList(inputBoxed); 
```

它也有反向 API

```
long[] backToPrimitive = ArrayUtils.toPrimitive(objectArray); 
```

**编辑：**更新以提供对列表的完整转换，如评论和其他修复所建议的那样。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2010-06-02T18:32:43.253

```
import java.util.Arrays;
import org.apache.commons.lang.ArrayUtils;

List<Long> longs = Arrays.asList(ArrayUtils.toObject(new long[] {1,2,3,4})); 
```

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-04-16T15:48:10.003

[hallidave](https://stackoverflow.com/questions/754294/convert-an-array-of-primitive-longs-into-a-list-of-longs/754324#754324)和[jpalecek](https://stackoverflow.com/questions/754294/convert-an-array-of-primitive-longs-into-a-list-of-longs/754325#754325)的想法是正确的——遍历数组——但它们没有利用 : 提供的特性`ArrayList`：因为在这种情况下*列表的大小是已知*的，所以你应该在创建`ArrayList`.

```
List<Long> list = new ArrayList<Long>(input.length);
for (long n : input)
  list.add(n); 
```

这样，不会创建不必要的数组，`ArrayList`因为它们太短而被丢弃，并且不会因为`ArrayList`高估其空间需求而浪费空“槽”。当然，如果您继续向列表中添加元素，则需要一个新的后备数组。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-04-16T00:28:44.567

有点冗长，但这有效：

```
 List<Long> list = new ArrayList<Long>();
    for (long value : input) {
        list.add(value);
    } 
```

在您的示例中，Arrays.asList() 似乎将输入解释为 long[] 数组列表，而不是 Longs 列表。有点令人惊讶，当然。在这种情况下，自动装箱无法按照您希望的方式工作。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-08-04T23:05:10.730

作为另一种可能性，[Guava 库](https://github.com/google/guava)将其提供为[`Longs.asList()`](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/primitives/Longs.html#asList-long...-)，并为其他原始类型提供了类似的实用程序类。

```
import com.google.common.primitives.Longs;

long[] input = someAPI.getSomeLongs();
List<Long> output = Longs.asList(input); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-16T00:28:55.627

不，没有从原始类型数组到其盒装引用类型数组的自动转换。你只能做

```
long[] input = someAPI.getSomeLongs();
List<Long> lst = new ArrayList<Long>();

for(long l : input) lst.add(l); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-10-28T13:55:21.230

^(该问题询问如何将数组转换为列表。到目前为止，大多数答案都显示了如何创建一个与数组内容相同或引用第三方库的*新列表。*但是，这种转换有简单的内置选项。其中一些已经在其他答案中勾勒出来（例如[这个](https://stackoverflow.com/a/17983559/3182664)）。但我想在这里指出并详细说明实施的一定程度的自由度，并展示潜在的好处、缺点和注意事项。)

至少有两个重要的区别：

*   结果列表应该是数组上的**视图**还是应该是**新**列表
*   结果列表是否应该可以**修改**

此处将快速总结选项，并在此答案的底部显示完整的示例程序。

* * *

**创建新列表与在阵列上创建*视图***

当结果应该是一个**新**列表时，可以使用其他答案中的一种方法：

```
List<Long> list = Arrays.stream(array).boxed().collect(Collectors.toList()); 
```

但是应该考虑这样做的缺点：具有 1000000`long`个值的数组将占用大约 8 兆字节的内存。新列表*也*将占用大约 8 兆字节。当然，在创建这个列表时必须遍历整个数组。在许多情况下，根本不需要创建新列表。相反，在数组上创建一个**视图**就足够了：

```
// This occupies ca. 8 MB
long array[] = { /* 1 million elements */ }

// Properly implemented, this list will only occupy a few bytes,
// and the array does NOT have to be traversed, meaning that this
// operation has nearly ZERO memory- and processing overhead:
List<Long> list = asList(array); 
```

^(（该方法的实现请参见底部的示例`toList`）)

*拥有数组视图*的含义是数组中的更改将在列表中可见：

```
long array[] = { 12, 34, 56, 78 };
List<Long> list = asList(array);

System.out.println(list.get(1)); // This will print 34

// Modify the array contents:
array[1] = 12345;

System.out.println(list.get(1)); // This will now print 12345! 
```

幸运的是，从视图中创建一个副本（即不受数组修改影响的**新列表）很简单：**

```
List<Long> copy = new ArrayList<Long>(asList(array)); 
```

现在，这是一个真实的副本，相当于上面显示的基于流的解决方案所达到的效果。

* * *

**创建*可修改*视图或不可*修改*视图**

*在许多情况下，当列表为只读*时就足够了。结果列表的内容通常不会被修改，而只会传递给只读取列表的下游处理。

允许修改列表会引发一些问题：

```
long array[] = { 12, 34, 56, 78 };
List<Long> list = asList(array);

list.set(2, 34567);           // Should this be possible?
System.out.println(array[2]); // Should this print 34567?
list.set(3, null);            // What should happen here?
list.add(99999);              // Should this be possible? 
```

*可以在可修改*的数组上创建列表视图。这意味着列表中的更改（例如在某个索引处设置新值）将在数组中可见。

但是不可能创建*结构上可修改*的列表视图。这意味着不可能进行影响列表*大小*的操作。这仅仅是因为底层*数组*的大小无法更改。

* * *

下面是一个[MCVE](https://stackoverflow.com/help/mcve)，显示了不同的实现选项，以及使用结果列表的可能方式：

```
import java.util.AbstractList;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Objects;
import java.util.RandomAccess;

public class PrimitiveArraysAsLists
{
    public static void main(String[] args)
    {
        long array[] = { 12, 34, 56, 78 };

        // Create VIEWS on the given array
        List<Long> list = asList(array);
        List<Long> unmodifiableList = asUnmodifiableList(array);

        // If a NEW list is desired (and not a VIEW on the array), this
        // can be created as well:
        List<Long> copy = new ArrayList<Long>(asList(array));

        System.out.println("array           : " + Arrays.toString(array));
        System.out.println("list            : " + list);
        System.out.println("unmodifiableList: " + unmodifiableList);
        System.out.println("copy            : " + copy);        

        // Modify a value in the array. The changes will be visible
        // in the list and the unmodifiable list, but not in
        // the copy.
        System.out.println("Changing value at index 1 of the array...");
        array[1] = 34567;

        System.out.println("array           : " + Arrays.toString(array));
        System.out.println("list            : " + list);
        System.out.println("unmodifiableList: " + unmodifiableList);
        System.out.println("copy            : " + copy);        

        // Modify a value of the list. The changes will be visible
        // in the array and the unmodifiable list, but not in
        // the copy.
        System.out.println("Changing value at index 2 of the list...");
        list.set(2, 56789L);

        System.out.println("array           : " + Arrays.toString(array));
        System.out.println("list            : " + list);
        System.out.println("unmodifiableList: " + unmodifiableList);
        System.out.println("copy            : " + copy);        

        // Certain operations are not supported:
        try
        {
            // Throws an UnsupportedOperationException: This list is 
            // unmodifiable, because the "set" method is not implemented
            unmodifiableList.set(2, 23456L);
        }
        catch (UnsupportedOperationException e) 
        {
            System.out.println("Expected: " + e);
        }

        try
        {
            // Throws an UnsupportedOperationException: The size of the
            // backing array cannot be changed
            list.add(90L);
        }
        catch (UnsupportedOperationException e) 
        {
            System.out.println("Expected: " + e);
        }

        try
        {
            // Throws a NullPointerException: The value 'null' cannot be  
            // converted to a primitive 'long' value for the underlying array
            list.set(2, null);
        }
        catch (NullPointerException e)
        {
            System.out.println("Expected: " + e);
        }

    }

    /**
     * Returns an unmodifiable view on the given array, as a list.
     * Changes in the given array will be visible in the returned
     * list.
     *  
     * @param array The array
     * @return The list view
     */
    private static List<Long> asUnmodifiableList(long array[])
    {
        Objects.requireNonNull(array);
        class ResultList extends AbstractList<Long> implements RandomAccess
        {
            @Override
            public Long get(int index)
            {
                return array[index];
            }

            @Override
            public int size()
            {
                return array.length;
            }
        };
        return new ResultList();
    }

    /**
     * Returns a view on the given array, as a list. Changes in the given 
     * array will be visible in the returned list, and vice versa. The
     * list does not allow for <i>structural modifications</i>, meaning
     * that it is not possible to change the size of the list.
     *  
     * @param array The array
     * @return The list view
     */
    private static List<Long> asList(long array[])
    {
        Objects.requireNonNull(array);
        class ResultList extends AbstractList<Long> implements RandomAccess
        {
            @Override
            public Long get(int index)
            {
                return array[index];
            }

            @Override
            public Long set(int index, Long element)
            {
                long old = array[index];
                array[index] = element;
                return old;
            }

            @Override
            public int size()
            {
                return array.length;
            }
        };
        return new ResultList();
    }

} 
```

该示例的输出如下所示：

```
array           : [12, 34, 56, 78]
list            : [12, 34, 56, 78]
unmodifiableList: [12, 34, 56, 78]
copy            : [12, 34, 56, 78]
Changing value at index 1 of the array...
array           : [12, 34567, 56, 78]
list            : [12, 34567, 56, 78]
unmodifiableList: [12, 34567, 56, 78]
copy            : [12, 34, 56, 78]
Changing value at index 2 of the list...
array           : [12, 34567, 56789, 78]
list            : [12, 34567, 56789, 78]
unmodifiableList: [12, 34567, 56789, 78]
copy            : [12, 34, 56, 78]
Expected: java.lang.UnsupportedOperationException
Expected: java.lang.UnsupportedOperationException
Expected: java.lang.NullPointerException 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-01-31T22:04:18.880

我正在为这些问题编写一个小型库：

```
long[] input = someAPI.getSomeLongs();
List<Long> = $(input).toList(); 
```

如果您关心，请在[此处查看](https://bitbucket.org/adamldavis/dollar/wiki/Home)。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-08-25T09:56:11.603

Java 8 的另一种方式。

```
long[] input = someAPI.getSomeLongs();
LongStream.of(input).boxed().collect(Collectors.toList())); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-08-31T05:16:45.067

Java 8 的另一种[方式](https://stackoverflow.com/a/30636289/330457)。

```
final long[] a = new long[]{1L, 2L};
final List<Long> l = Arrays.stream(a).boxed().collect(Collectors.toList()); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-08-01T00:59:37.393

结合 Pavel 和 Tom 的答案，我们得到了这个

```
 @SuppressWarnings("unchecked")
    public static <T> List<T> asList(final Object array) {
        if (!array.getClass().isArray())
            throw new IllegalArgumentException("Not an array");
        return new AbstractList<T>() {
            @Override
            public T get(int index) {
                return (T) Array.get(array, index);
            }

            @Override
            public int size() {
                return Array.getLength(array);
            }
        };
    } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-04-16T00:38:25.170

如果您想要类似的语义，`Arrays.asList`那么您需要编写（或使用其他人的）客户实现`List`（可能通过`AbstractList`. 它应该具有与 非常相同的实现`Arrays.asList`，只有 box 和 unbox 值。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-01-20T06:10:29.983

您可以使用[变形](http://transmorph.sourceforge.net)：

```
Transmorph transmorph = new Transmorph(new DefaultConverters());
List<Long> = transmorph.convert(new long[] {1,2,3,4}, new TypeReference<List<Long>>() {}); 
```

例如，如果 source 是一个整数数组，它也可以工作。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-10-12T17:56:00.880

我知道这个问题已经够老了，但是......您也可以编写自己的转换方法：

```
@SuppressWarnings("unchecked")
public static <T> List<T> toList(Object... items) {

    List<T> list = new ArrayList<T>();

    if (items.length == 1 && items[0].getClass().isArray()) {
        int length = Array.getLength(items[0]);
        for (int i = 0; i < length; i++) {
            Object element = Array.get(items[0], i);
            T item = (T)element;
            list.add(item);
        }
    } else {
        for (Object i : items) {
            T item = (T)i;
            list.add(item);
        }
    }

    return list;
} 
```

使用静态导入包含它后，可能的用法可能是：

```
 long[] array = { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
    List<Long> list = toList(array); 
```

或者

```
 List<Long> list = toList(1l, 2l, 3l, 4l, 5l, 6l, 7l, 8l, 9l); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-06-16T05:33:46.950

虽然可以创建一个新列表并向其中添加所有值（通过 for 循环或流），但我一直在处理非常大的数组并且性能很差。因此，我创建了自己易于使用的原始数组包装类。

例子：

```
long[] arr = new long[] {1,2,3};
PrimativeList<Long> list = PrimativeList.create(arr); // detects long[] and returns PrimativeList<Long>

System.out.println(list.get(1)); // prints: 2
list.set(2, 15);
System.out.println(arr[2]);  // prints: 15 
```

在这里获取： [https ://github.com/Sf298/Sauds-Toolbox/blob/master/src/main/java/PrimitiveArrayWrapper/PrimitiveList.java](https://github.com/Sf298/Sauds-Toolbox/blob/master/src/main/java/PrimitiveArrayWrapper/PrimitiveList.java)

注意：我还没有完全测试它，所以如果你发现任何错误/问题，请告诉我。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-07-21T11:06:47.137

你可以使用`LongStream`它

```
List<Long> longs = LongStream.of(new long[]{1L, 2L, 3L}).boxed()
                             .collect(Collectors.toList()); 
```

# linux - Git克隆挂起

> ID：754299
> 
> 赞同：0
> 
> 时间：2009-04-16T00:20:39.407
> 
> 标签：linux, git, kernel

作为一名潜在的 Linux 开发人员，我想克隆 Torvalds 的 git 存储库。问题是当我在 git clone 进程挂起一段时间后调用 git clone 时。没有错误消息没有超时没有。所以我按 ctrl+c 并重新启动，同样的事情。

它以随机百分比挂起。它在“检索对象”过程中挂起。

有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T02:43:49.610

我在最近克隆的一个非常大的存储库（工作副本~20 Gb）上看到了类似的东西。最终，Git 再次振作起来。我不确定我的情况到底发生了什么，但似乎文件系统正在颠簸。也许你可以让它挂一两个小时，看看它是否会回来......

嗯，不是很有帮助，嗯？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T01:21:59.713

也许这个问题更适合 irc.freenode.net 上的#git。这些人将更有能力提供帮助——这是一种需要交互式对话框的故障排除情况，而 StackOverflow 不太适合。祝你好运！

# .net - 如何按名称获取 ODBC 连接？

> ID：754302
> 
> 赞同：0
> 
> 时间：2009-04-16T00:22:11.057
> 
> 标签：.net, database, .net-3.5, odbc

给定一个用户 DSN，我如何在 .Net 3.5 中创建到该数据源的 ODBC 连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T00:29:12.430

这是一个描述整个过程[的教程。](http://www.easysoft.com/developer/languages/csharp/ado-net-odbc.html)

基本上，你这样做：

```
OdbcConnection connection = new OdbcConnection("DSN=MyDataSourceName"); 
```

# c# - WebRequest 获取没有异常的页面？

> ID：754304
> 
> 赞同：2
> 
> 时间：2009-04-16T00:22:31.307
> 
> 标签：c#, httpwebrequest, httpwebresponse

我想检查页面的状态（404、已移动等）。我该怎么做？ATM 我正在​​做下面的事情，它只会告诉我页面是否存在。另外，我怀疑异常使我的代码变慢（我测试过）

```
static public bool CheckExist(string url)
        {
            HttpWebRequest wreq = null;
            HttpWebResponse wresp = null;
            bool ret = false;

            try
            {
                wreq = (HttpWebRequest)WebRequest.Create(url);
                wreq.KeepAlive = true;
                //wreq.Method = "HEAD";
                wresp = (HttpWebResponse)wreq.GetResponse();
                ret = true;
            }
            catch (System.Net.WebException)
            {
            }
            finally
            {
                if (wresp != null)
                    wresp.Close();
            }
            return ret;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T00:44:07.247

HttpWebResponse 类公开了一个 StatusCode 属性，该属性从 HttpStatusCode 枚举中返回一个值。在非错误情况下，这会直接为您提供状态码（404 未找到、403 未经授权、301 永久移动、200 正常等等）。在错误情况下，WebException 类公开了一个 Status 属性——取自不同的枚举，但您将能够从我认为的情况中识别出您想要的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:50:58.197

你可以得到这样的http错误代码：

```
catch (System.Net.WebException e)
{
    int HttpStatusCode = (int)((HttpWebResponse)e.Response).StatusCode;
} 
```

# java - 正则表达式替换 Windows 在文件名中不接受的字符

> ID：754307
> 
> 赞同：36
> 
> 时间：2009-04-16T00:23:25.970
> 
> 标签：java, regex

我正在尝试构建一个正则表达式，它将检测 Windows 不接受作为文件名一部分的任何字符（其他操作系统是否相同？老实说，我不知道）。

这些符号是：

```
\ / : * ? " |
```

无论如何，这就是我所拥有的：`[\\/:*?\"<>|]`

[http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)上的测试仪表明这是有效的。对于 string `Allo*ha`，`*`符号会亮起，表示已找到。但是，如果我进入`Allo**ha`，只有第一个`*`会亮起。所以我想我需要修改这个正则表达式来找到提到的字符的所有外观，但我不确定。

你看，在 Java 中，我很幸运拥有[String.replaceAll(String regex, String replacement)](http://java.sun.com/javase/6/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)函数。描述说：

> 用给定的替换替换此字符串中与给定正则表达式匹配的每个子字符串。

所以换句话说，即使正则表达式只找到第一个然后停止搜索，这个函数仍然会找到它们。

例如：`String.replaceAll("[\\/:*?\"<>|]","")`

但是，我觉得我不能冒这个风险。那么有人知道我可以如何扩展它吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-10-17T15:17:47.870

因为没有答案足够好，所以我自己做了。希望这可以帮助 ;）

```
public static boolean validateFileName(String fileName) {
    return fileName.matches("^[^.\\\\/:*?\"<>|]?[^\\\\/:*?\"<>|]*") 
    && getValidFileName(fileName).length()>0;
}

public static String getValidFileName(String fileName) {
    String newFileName = fileName.replace("^\\.+", "").replaceAll("[\\\\/:*?\"<>|]", "");
    if(newFileName.length()==0)
        throw new IllegalStateException(
                "File Name " + fileName + " results in a empty fileName!");
    return newFileName;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-16T01:54:09.073

Windows 文件名规则很*棘手*。你只是在摸索表面。

例如，除了您列出的字符之外，还有一些不是有效文件名的内容：

```
 (yes, that's an empty string)
.
.a
a.
 a                                  (that's a leading space)
a                                   (or a trailing space)
com
prn.txt
[anything over 240 characters]
[any control characters]
[any non-ASCII chracters that don't fit in the system codepage,
 if the filesystem is FAT32] 
```

删除像 String.replaceAll() 这样的单个正则表达式子中的特殊字符是不够的；你很容易得到一些无效的东西，比如空字符串或尾随 '.' 或者 ' '。将“[^A-Za-z0-9_.]*”替换为“_”会是更好的第一步。但是您仍然需要在您使用的任何平台上进行更高级别的处理。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-10T22:13:43.523

我使用纯粹而简单的正则表达式。我给出可能出现的字符，并通过“^”的否定来改变所有其他字符作为这样的标志。“_”

> 字符串文件名 = someString.replaceAll("[^a-zA-Z0-9\\.\\-]", "_");

例如：如果你不想在表达式中加一个“。” 然后删除“\\。”

> 字符串文件名 = someString.replaceAll("[^a-zA-Z0-9\\-]", "_");

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T00:37:06.280

作为记录，符合 POSIX 的系统（包括 UNIX 和 Linux）支持文件名中除空字符 ( `'\0'`) 和正斜杠 ( `'/'`) 之外的所有字符。必须在命令行上对空格和星号等特殊字符进行转义，以免它们发挥其通常的作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T00:38:35.230

Java 有一个 replaceAll 函数，但每种编程语言都有类似的方法。例如，Perl 使用`g`开关来表示全局替换。Python 的`sub`函数允许您指定要进行的替换次数。如果由于某种原因，您的语言*没有*对应的语言，您可以随时执行以下操作：

```
while (filename.matches(bad_characters)
  filename.replace(bad_characters, "") 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-11T11:57:42.077

我从原始字符串中提取所有单词字符和空白字符，并确保字符串末尾不存在空白字符。这是我在java中的代码片段。

```
temp_string = original.replaceAll("[^\\w|\\s]", "");
final_string = temp_string.replaceAll("\\s$", ""); 
```

我想我帮助了某人。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-01-28T15:27:46.463

所需的正则表达式/语法（JS）：

```
.trim().replace(/[\\/:*?\"<>|]/g,"").substring(0,240); 
```

最后一位是可选的，仅在要将长度限制为 240 时使用。

其他有用的功能（JS）：

```
.toUppperCase();
.toLowerCase();
.replace(/  /g,' ');     //normalising multiple spaces to one, add before substring.
.includes("str");        //check if a string segment is included in the filename
.split(".").slice(-1);   //get extension, given the entire filename contains a . 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T00:38:14.297

您不能使用单个正则表达式来执行此操作，因为如果输入，正则表达式始终匹配子字符串。考虑单词`Alo*h*a`，没有包含所有`*`s 且不包含任何其他字符的子字符串。因此，如果您可以使用 replaceAll 功能，请坚持使用。

顺便说一句，禁止字符集在其他操作系统中是不同的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-08T13:53:41.813

我做了一种非常***简单的方法***，适用于最常见的情况：

```
// replace special characters that windows doesn't accept
private String replaceSpecialCharacters(String string) {
    return string.replaceAll("[\\*/\\\\!\\|:?<>]", "_")
            .replaceAll("(%22)", "_");
} 
```

**如果文件名中有 qoute ( **" )，则对****%22进行编码。****

 *** * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-16T00:30:24.580

您可以尝试只允许您希望用户能够输入的内容，例如 AZ、az 和 0-9。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-10-16T14:24:46.933

Windows 也不接受“%”作为文件名。

如果您正在构建可能会影响最终将移动到其他操作系统的文件的通用表达式，我建议您放置更多可能会出现问题的字符。

例如，在 Linux（我知道的许多发行版）中，一些用户可能会遇到包含 [b]& 的文件的问题！] [ / - ( )[/b]。文件名中允许使用符号，但用户可能需要对其进行特殊处理，并且某些程序存在由于其存在而导致的错误。

# emacs - Emacs Elisp 动态交互提示

> ID：754327
> 
> 赞同：11
> 
> 时间：2009-04-16T00:29:56.843
> 
> 标签：emacs, elisp

我正在尝试从我的 elisp 函数中获得动态提示。我想要像 replace-regexp 这样的东西，它会显示你最后输入的正则表达式。我试过（交互式（concat“sab”“bab”）））不起作用！

我也尝试过类似格式的消息（交互式“s %s”last-used-regexp）

那是行不通的！有人知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-16T01:42:50.613

`M-x find-function`是你的朋友。它将通过向您展示源代码来告诉您 emacs 中的任何内容是如何工作的。使用它，我发现`query-regexp-replace`调用`query-replace-read-args`which calls `query-replace-read-from`which calls`read-from-minibuffer`使用从上次使用的正则表达式创建的提示，该提示保存在 dotted pair`query-replace-defaults`中。

所以：

```
(defun my-func ()
  "Do stuff..."
  (interactive)
  (read-from-minibuffer "Regexp? " (first query-replace-defaults))) 
```

是一个以最后输入的正则表达式作为默认值的提示的命令。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-16T03:00:07.857

使用变量作为输入历史，并与列表交互：

```
(defvar my-func-history nil)

(defun my-func (str)
  (interactive (list (read-from-minibuffer "Input string: " (car my-func-history) nil nil 'my-func-history)))
  (insert str)) 
```

如果您最初不想在其中输入最后一个值，请将 更改`(car my-func-history)`为`nil`。您当然可以向上/向下箭头在提示符处浏览历史记录。

# c# - 有没有办法要求提供给方法的参数不为空？

> ID：754330
> 
> 赞同：6
> 
> 时间：2009-04-16T00:31:52.797
> 
> 标签：c#, null, methods, arguments

有没有更好的方法来要求方法中的参数不为空？我不断检查我的方法需要的任何参数是否为空，如下所示。但我想知道是否有更好的方法。

```
public void MyMethod(string a, int b)
{
   if(a==null){throw new ArgumentNullException("a");}
   if(b==null){throw new ArgumentNullException("b");}

   //more stuff here
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-12-15T06:14:05.063

您可以编写一些实用方法。这是java中的常见模式。

用户代码：

```
public void MyMethod(string a, int b)
{
    //validate each
    Objects.RequireNotNull(a);
    Objects.RequireNotNull(b);

    //or validate in single line as array 
    Objects.RequireNotNullArray(a, b);
} 
```

实现代码：

```
public static class Objects
{
    public static T RequireNotNull<T>(T arg)
    {
        if(arg == null)
        {
            throw new ArgumentNullException();
        }
        return arg;
    }

    public static object[] RequireNotNullArray(params object[] args)
    {
        return RequireNotNullArray<object>(args);
    }

    public static T[] RequireNotNullArray<T>(params T[] args)
    {
        Objects.RequireNotNull(args);
        for(int i=0; i<args.Length; i++)
        {
            T arg = args[i];
            if(arg == null)
            {
                throw new ArgumentNullException($"null entry at position:{i}");
            }
        }
        return args;
    }

} 
```

您无法在异常中获取变量名称。但是通过堆栈跟踪和您的源代码，应该可以轻松追踪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:34:13.837

没有其他更好的方法。这是大量 Microsoft 库处理这种情况的方式。

您始终可以使用扩展方法使其更清晰。

```
static IsNullArgument(this Object o, string arg)
{
    if (o == null)
        throw ArgumentNullException(arg);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T00:42:15.363

我个人喜欢[CutEdge.Conditions](http://www.codeplex.com/conditions)。它易于使用，并使其更具可读性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T00:47:37.737

Rick Brewster（Paint.NET 的作者）写了一篇关于 Fluent API 替代方案的博客：

[http://blog.getpaint.net/2008/12/06/a-fluent-approach-to-c-parameter-validation/](http://blog.getpaint.net/2008/12/06/a-fluent-approach-to-c-parameter-validation/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T01:13:18.190

这是我认为 C# 从 C++ 倒退的少数几个领域之一。

在 C++ 中，您可以编写

```
void foo(Bar& bar) { /*...*/ } 
```

非常清楚地向编译器和其他`foo`采用`Bar`. 是的，有可能——通过努力——传递`foo`一个空引用，但这不是真正合法的 C++。

您在 C# 中唯一的“解决方案”（各种）是让您的`class`es`struct`代替，因为 .NET 中的值类型不能`null`（在您的示例中，*b*永远不可能`null`，因为它是 a `System.Int32`）。调用`bar()`不会编译：

```
 class A { }
    struct B { }

    static void foo(A a) { }
    static void bar(B b) { }

    static void Main(string[] args)
    {
        foo(null);
        bar(null);
    } 
```

`null`对于 C# 来说，让引用变得（非常）更加困难，这当然会很好。例如，F# 没有可为空的类型。

有关此问题的一些有趣评论，请阅读[空参考：十亿美元的错误](http://sadekdrobi.com/2008/12/22/null-references-the-billion-dollar-mistake/)（和评论）。

* * *

**编辑：**[Eric Lippert](http://ericlippert.com/2013/02/25/monads-part-two/)在 2013 年 2 月的脚注中说“......碰巧当 C# 首次实现时，它具有始终可以为空的引用类型，......似乎`Nullable<T>`可以实现任何类型的工作，并且引用类型默认是不可为空的。我们可以有一个类型系统，这`Nullable<string>`是唯一合法的方式来表示“可以是`null`”的字符串。...“

# ruby-on-rails - 访问不同状态的用户对象（Ruby on Rails、RESTful 身份验证）

> ID：754331
> 
> 赞同：0
> 
> 时间：2009-04-16T00:34:13.540
> 
> 标签：ruby-on-rails, ruby, variables, scope, restful-authentication

在我的 Rails 应用程序中，我有一个用户模型（或多或少由 RESTful 身份验证构建），以及属于该用户的其他几个模型。比如说，例如：

用户 has_many :posts

发布属于_to：用户

在用户资源中的任何地方，我都可以按预期访问用户变量。@user.name、@user.email、@user.login 等都返回预期的对象。

但是，如果不返回 nil（nil 而不是 NoMethodError），我似乎无法从任何其他资源（在此示例中为帖子）访问这些属性中的任何一个。

为什么是这样？对我来说似乎更奇怪的是，我可以`current_user`正常调用，例如`current_user.name`, `current_user.email`，但不适用于相关用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T01:18:04.450

您可以在这里谈论两个用户。
1) 当前登录的用户
2) 帖子所属的用户

当前登录的用户应该可以通过 current_user 访问。帖子所属的用户需要在 Posts 控制器中设置：

```
@user = Users.find(@post.user_id) 
```

或者

```
@user = @post.user 
```

# c# - 为什么这个 WebRequest 代码很慢？

> ID：754333
> 
> 赞同：12
> 
> 时间：2009-04-16T00:34:17.440
> 
> 标签：c#, httpwebrequest, httpwebresponse

我请求了 100 页，全部 404。我写了

```
 {
    var s = DateTime.Now;
    for(int i=0; i < 100;i++)
        DL.CheckExist("http://google.com/lol" + i.ToString() + ".jpg");
    var e = DateTime.Now;
    var d = e-s;
        d=d;
        Console.WriteLine(d);
    }

static public bool CheckExist(string url)
{
    HttpWebRequest wreq = null;
    HttpWebResponse wresp = null;
    bool ret = false;

    try
    {
        wreq = (HttpWebRequest)WebRequest.Create(url);
        wreq.KeepAlive = true;
        wreq.Method = "HEAD";
        wresp = (HttpWebResponse)wreq.GetResponse();
        ret = true;
    }
    catch (System.Net.WebException)
    {
    }
    finally
    {
        if (wresp != null)
            wresp.Close();
    }
    return ret;
} 
```

两次运行显示它需要 00:00:30.7968750 和 00:00:26.8750000。然后我尝试了Firefox并使用以下代码

```
<html>
<body>
<script type="text/javascript">
for(var i=0; i<100; i++)
    document.write("<img src=http://google.com/lol" + i + ".jpg><br>");
</script>

</body>
</html> 
```

使用我的补偿时间并计算它大约是 4 秒。4 秒比我的应用快 6.5-7.5。我计划扫描数千个文件，因此花费 3.75 小时而不是 30 分钟将是一个大问题。我怎样才能使这段代码更快？我知道有人会说 Firefox 缓存了图像，但我想说 1）它仍然需要检查远程服务器的标头以查看它是否已更新（这是我希望我的应用程序执行的操作）2）我不是接收正文，我的代码应该只请求标题。那么，我该如何解决呢？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-01T17:01:11.830

我注意到`HttpWebRequest`第一个请求挂起。我做了一些研究，似乎正在发生的事情是请求正在配置或自动检测代理。如果你设置

```
request.Proxy = null; 
```

在 Web 请求对象上，您可能能够避免初始延迟。

使用代理自动检测：

```
using (var response = (HttpWebResponse)request.GetResponse()) //6,956 ms
{
} 
```

没有代理自动检测：

```
request.Proxy = null;
using (var response = (HttpWebResponse)request.GetResponse()) //154 ms
{
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T00:55:30.027

将您的代码更改为异步 getresponse

```
public override WebResponse GetResponse() {
    •••
    IAsyncResult asyncResult = BeginGetResponse(null, null);
    •••
    return EndGetResponse(asyncResult);
} 
```

[异步获取](http://msdn.microsoft.com/en-us/magazine/cc163880.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T00:40:59.390

可能 Firefox 一次发出多个请求，而您的代码一个一个地执行它们。也许添加线程会加快你的程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-16T20:52:05.687

答案是仅将 HttpWebRequest/HttpWebResponse 更改为 WebRequest/WebResponse。这解决了问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T01:31:06.213

您是否尝试在部署代码的机器上的 IE 中打开相同的 URL？如果它是 Windows Server 机器，那么有时是因为您请求的 url 不在 IE 的安全站点列表中（HttpWebRequest 可以使用）。你只需要添加它。

你有更多可以发布的信息吗？我做过类似的事情，之前遇到过 HttpWebRequest 的大量问题。都是独一无二的。所以更多信息会有所帮助。

顺便说一句，在这种情况下，使用异步方法调用它并没有真正的帮助。它不会缩短下载时间。它只是不会阻塞你的调用线程而已。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-18T16:07:27.013

完成后关闭响应流，因此在您的 checkExist() 中，在 wresp = (HttpWebResponse)wreq.GetResponse() 之后添加 wresp.Close()；

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-17T14:27:16.943

好的，如果您获得所有网页的状态代码 404，那么这是由于未指定凭据。所以你需要添加

```
wreq.Credentials = CredentialCache.DefaultCredentials; 
```

然后您可能还会遇到状态代码= 500，因为您需要指定用户代理。看起来像下面的行

```
wreq.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0"; 
```

> “默认情况下，WebClient 实例不发送可选的 HTTP 标头。如果您的请求需要可选标头，则必须将标头添加到 Headers 集合中。例如，要在响应中保留查询，您必须添加用户代理标头。此外，如果缺少用户代理标头，服务器可能会返回 500（内部服务器错误）。”
> 
> 参考：[https ://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.net.webclient(v=vs.110).aspx)

要提高 HttpWebrequest 的性能，您需要添加

```
wreq.Proxy=null 
```

现在代码将如下所示：

```
 static public bool CheckExist(string url)
{
    HttpWebRequest wreq = null;
    HttpWebResponse wresp = null;
    bool ret = false;

try
{
    wreq = (HttpWebRequest)WebRequest.Create(url);
    wreq.Credentials = CredentialCache.DefaultCredentials;
    wreq.Proxy=null;
    wreq.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.0) Gecko/20100101 Firefox/4.0";
    wreq.KeepAlive = true;
    wreq.Method = "HEAD";
    wresp = (HttpWebResponse)wreq.GetResponse();
    ret = true;
}
catch (System.Net.WebException)
{
}
finally
{
    if (wresp != null)
        wresp.Close();
}
return ret; 
```

}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-19T10:49:21.870

设置 cookie 很重要，您必须`AspxAutoDetectCookieSupport=1`像这样添加代码

```
 req.CookieContainer = new CookieContainer();         
 req.CookieContainer.Add(new Cookie("AspxAutoDetectCookieSupport", "1") { Domain = target.Host }); 
```

# oracle - PL/SQL：程序在包中无法正常工作

> ID：754335
> 
> 赞同：1
> 
> 时间：2009-04-16T00:34:46.783
> 
> 标签：oracle, stored-procedures, plsql, null, packages

我正在研究一个包含一些程序的包，但遇到了一些麻烦。当我尝试测试将加仑转换为升的过程或其他过程时，它只是打印出在未命名块中声明的内容，而不是转换数字。有任何想法吗？

```
CREATE OR REPLACE PACKAGE eng_metric 
IS 
  PROCEDURE convert(degree_fahrenheit  IN OUT NUMBER,degree_celsius  IN OUT NUMBER,measure  IN VARCHAR2); 

  PROCEDURE convert(liters  IN OUT NUMBER,gallons  IN OUT NUMBER); 
END eng_metric; 
/ 

CREATE OR REPLACE PACKAGE BODY eng_metric 
AS 
  PROCEDURE Convert 
       (degree_fahrenheit  IN OUT NUMBER, 
        degree_celsius     IN OUT NUMBER, 
        measure            IN VARCHAR2) 
  IS 
    df         NUMBER; 
    dc         NUMBER; 
    convertf   NUMBER; 
    measurecf  VARCHAR2(4); 
  BEGIN 
    measurecf := measure; 

    df := degree_fahrenheit; 

    dc := degree_celsius; 

    IF measure = 'TEMP' THEN 
      IF dc = NULL THEN 
        convertf := ((df - 32) * .56); 

        degree_fahrenheit := convertf; 

        dbms_output.Put_line('The temperature in fahrenheit is ' 
                             ||To_char(degree_fahrenheit)); 
      ELSIF df = NULL THEN 
        convertf := (dc + 17.98) * 1.8; 

        degree_celsius := convertf; 
      END IF; 
    ELSE 
      dbms_output.Put_line('Invalid measure'); 
    END IF; 
  END convert; 

  PROCEDURE Convert 
       (liters   IN OUT NUMBER, 
        gallons  IN OUT NUMBER) 
  IS 
    lit        NUMBER; 
    gal        NUMBER; 
    convertlg  NUMBER; 
  BEGIN 
    lit := liters; 

    gal := gallons; 

    IF gal = NULL THEN 
      convertlg := (lit / 3.785); 

      liters := convertlg; 
    ELSIF lit = NULL THEN 
      convertlg := (gal * 3.785); 

      gallons := convertlg; 
    END IF; 
  END convert; 
END eng_metric; 
/ 

DECLARE 
  liters   NUMBER := 25; 
   gallons  NUMBER := 41; 
   nully    NUMBER := NULL; 
BEGIN 
  eng_metric.Convert(nully,gallons); 

  dbms_output.Put_line(To_char(gallons)); 
END; 
/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T00:40:32.713

代替

```
IF gal = NULL THEN 
```

你需要

```
IF gal IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T23:58:16.020

您必须记住的是，NULL 表示“没有价值”。它从不等于或不等于任何东西，包括 NULL。所以你需要使用 IS NULL 或 IS NOT NULL，或者使用 NVL 函数将 null 更改为有值的东西。

# sql-server-2005 - 如何将变量传递到脚本转换编辑器？

> ID：754338
> 
> 赞同：0
> 
> 时间：2009-04-16T00:35:26.220
> 
> 标签：sql-server-2005, ssis

我想将我的包中的变量传递给脚本转换编辑器。如何将其添加到下面的 Row.Reference1 中？

这是我使用的脚本：

```
Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Pipeline.Wrapper
Imports Microsoft.SqlServer.Dts.Runtime.Wrapper

Public Class ScriptMain
    Inherits UserComponent

Public Overrides Sub Input0_ProcessInputRow(ByVal Row As Input0Buffer)

        Row.Column1 = Tokenise(Row.Column0, "|", 1)
        Row.Column2 = Tokenise(Row.Column0, "|", 2)
        Row.Column3 = Tokenise(Row.Column0, "|", 3)
        Row.Column4 = Tokenise(Row.Column0, "|", 4)
        Row.Column5 = Tokenise(Row.Column0, "|", 5)
        Row.Column6 = Tokenise(Row.Column0, "|", 6)
        Row.Column7 = Tokenise(Row.Column0, "|", 7)
        Row.Column8 = Tokenise(Row.Column0, "|", 8)
        Row.Column9 = Tokenise(Row.Column0, "|", 9)
        Row.Column10 = Tokenise(Row.Column0, "|", 10)
        Row.Column11 = Tokenise(Row.Column0, "|", 11)
        Row.Column12 = Tokenise(Row.Column0, "|", 12)
        Row.Column13 = Tokenise(Row.Column0, "|", 13)
        Row.Column14 = Tokenise(Row.Column0, "|", 14)
        Row.Column15 = Tokenise(Row.Column0, "|", 15)
        Row.Column16 = Tokenise(Row.Column0, "|", 16)
        'Row.Reference1 = ???

    End Sub

Private Function Tokenise(ByVal input As String, ByVal delimiter As String, ByVal token As Integer) As String

        Dim tokenArray As String()
        tokenArray = input.Split(delimiter.ToCharArray) 'Split the string by the delimiter
        If tokenArray.Length < token Then 'Protect against a request for a token that doesn't exist
            Return ""
        Else
            Return tokenArray(token - 1)
        End If
    End Function
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T02:19:54.597

在脚本转换编辑器的“脚本”页面上，最后一个部分是“自定义属性”。有两个属性：ReadOnlyVariables 和 ReadWriteVariables。将适合的变量设置为您希望脚本引用的变量的逗号分隔列表。

当您单击“编辑脚本”按钮时，您会发现在 ComponentWrapper.vb 中创建的变量类现在具有带有变量名称的属性。只读变量将作为只读属性存在；ReadWrite 变量将作为具有 getter 和 setter 的属性存在。

然后，您将它们引用为，例如`Variables.TaskID`.

# java - 将泛型与 jakarta commons 集合 Buffer 一起使用

> ID：754339
> 
> 赞同：0
> 
> 时间：2009-04-16T00:36:03.037
> 
> 标签：java, generics, apache-commons-collection

此代码在 Java <= 1.4 中编译得很好。Java 1.6 母狗发出警告：

“方法 add(Object) 属于原始类型 Collection。对泛型类型 Collection 的引用应参数化”

```
import org.apache.commons.collections.Buffer;
import org.apache.commons.collections.BufferUtils;
import org.apache.commons.collections.buffer.UnboundedFifoBuffer;

private Buffer connectqueue = BufferUtils.blockingBuffer(new UnboundedFifoBuffer());

...

connectqueue.add(new Conn(this, address, port)); 
```

如何在不添加 @SupressWarnings 指令的情况下调整代码以使该警告消失？

问题是 Jakarta Commons Collections Buffer 是非泛型的，但扩展了泛型 java.util.Collection 接口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T00:51:19.677

你不能。在 Jakarta Commons 支持泛型之前（他们很可能不支持泛型，因为他们也希望能够在较旧的 Java 版本上构建），您需要抑制（或忍受）警告。

作为替代方案，有一个[支持泛型的 Commons Collections 的分支](http://larvalabs.com/collections/)，[Google 也有一个 Collections 库](http://code.google.com/p/google-collections/)。不过，我还没有检查它们中的任何一个是否有缓冲区，它需要你切换 API。

如果您的代码都没有使用后 1.4 语言功能，您可以将编译器的语言级别设置为“1.4”，但这似乎更不可行（或可取）。

可能只是坚持使用@SupressWarnings。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T21:14:30.917

如上所述，您可以使用 Jakarta 集合的分支，这将为您提供一个使用泛型的缓冲区类，并且不会给您警告 [http://collections.sourceforge.net/api/org/apache/commons/collections/Buffer。 html](http://collections.sourceforge.net/api/org/apache/commons/collections/Buffer.html)

# c# - 实体框架 - 默认子对象

> ID：754340
> 
> 赞同：1
> 
> 时间：2009-04-16T00:36:30.150
> 
> 标签：c#, database, entity-framework

有没有办法为新实体设置默认子实体，而不必使用 ObjectQueries 查询所有子实体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T12:30:49.800

有点。您可以直接设置EntityKey。这意味着您将无法访问子实体的值，但有时您不需要这样做。[在这篇文章](http://blogs.msdn.com/alexj/archive/2009/03/25/tip-7-faking-foreign-key-properties-in-net-3-5-sp1.aspx)中有关于这样做的信息。

# c# - 在 C# 中将泛型对象添加到泛型列表

> ID：754341
> 
> 赞同：13
> 
> 时间：2009-04-16T00:36:38.853
> 
> 标签：c#, generics, list

我有相关部分看起来像的课程

```
class C {
    void Method<T>(SomeClass<T> obj) {
        list.Add(obj);
    }
    List<?> list = new List<?>();
} 
```

我应该如何定义列表以便类编译？

我想要一个 type`List<SomeClass<?>>`列表，`SomeClass`即每个对象可以有任何类型参数的对象列表。Java`?`构造允许这样做；什么是 C# 等价物？如果不存在这样的事情，是否有合适的解决方法？（A`List<object>`会做，但非常丑陋。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-16T00:45:49.800

我认为您不能在 C# 中执行此操作...您必须将类型参数添加到类中：

```
class C<T> {
    void Method(SomeClass<T> obj) {
        list.Add(obj);
    }
    List<SomeClass<T>> list = new List<SomeClass<T>>();
} 
```

另一种选择是使用接口：

```
class C {

    void Method<T>(T obj)
         where T : ISomeClass {
        list.Add(obj);
    }
    List<ISomeClass> list = new List<ISomeClass>();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T00:50:35.217

做你想做的事，你有两个选择。

您可以使用 List<object> 并处理对象。这将不是类型安全的，并且对于值类型会有装箱/拆箱问题，但它会起作用。

您的另一个选择是使用通用约束来限制基类或接口，并使用 List<Interface>。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T00:49:55.780

不幸的是，在 C# 3.0 中没有直接的等价物，因为泛型是不变的。您将能够使用 C# 4.0 安全协/逆变功能以优雅的方式执行此类操作。要解决此问题，您可以`SomeClass<T>`从非泛型基类继承并创建一个`List<BaseClass>`。如果类的每个实例都应该只包含一种类型，则可以使类本身成为泛型并在那里设置类型参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T01:44:23.340

我对 Java 的构造一无所知`?`，但我认为以下内容最接近地保留了您现有的语法，同时也符合您的描述。

```
 class SomeClass<T>
    {
    }

    class C
    {
        void Add<T>(SomeClass<T> item)
        {
            Type type = typeof(SomeClass<T>);
            if (!list.ContainsKey(type))
                list[type] = new List<SomeClass<T>>();
            var l = (List<SomeClass<T>>)list[type];
            l.Add(item);
        }

        public void Method<T>(SomeClass<T> obj)
        {
            Add(obj);
        }
        readonly Dictionary<Type, object> list = new Dictionary<Type, object>();
    } 
```

使用以下方法对其进行测试：

```
 class Program
    {
        static void Main(string[] args)
        {
            var c = new C();
            var sc1 = new SomeClass<int>();
            var sc2 = new SomeClass<String>();
            c.Method(sc1);
            c.Method(sc2);
            c.Method(sc1);
            c.Method(sc2);
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-10T15:09:16.197

就个人而言，我会尽可能地这样做；将泛型参数从方法移动到类。

```
class C<T> {
    void Method(SomeClass<T> obj) {
        list.Add(obj);
    }
    List<?> list = new List<?>();
} 
```

如果您的通用列表是一个成员，那么在构建类时应该考虑到这一点。如果没有更多的类使用上下文，我们很难建议最好的模式。

# c++ - C/C++ 中的跨平台通用文本处理

> ID：754355
> 
> 赞同：2
> 
> 时间：2009-04-16T00:42:46.267
> 
> 标签：c++, c, string, cross-platform

当前以独立于平台的方式处理通用文本的最佳实践是什么？

例如，在 Windows 上有 API 的“A”和“W”版本。在 C 层，我们有“_tcs”函数（如 _tcscpy）映射到“wcscpy”或“strcpy”。在 STL 中，我经常使用类似的东西：

```
typedef std::basic_string<TCHAR> tstring; 
```

如果在其他系统上出现此类模式会出现什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T02:30:19.907

不支持`TCHAR`标准 C++ 中的通用（可变宽度）字符。C++ 确实有`wchar_t`，但不能保证编码。一旦我们拥有UTF-{8,16,32} 文字，`char16_t`C ++1x 将大大改善事情。`char32_t`

我个人不是通用字符的忠实拥护者，因为它们会导致一些令人讨厌的问题（例如转换），而且，更重要的是，如果您使用的类型（例如`TCHAR`）可能最大宽度为 8，那么您不妨编写代码与`char`. 如果您真的需要向后兼容，只需使用 UTF-8；它专门设计为 ASCII 的严格超集。您可能必须使用转换 API（尤其是在 Windows 上，由于某些奇怪的原因是 UTF-16），但至少它会是一致的。

编辑：要真正回答原始问题，其他平台通常没有这样的结构。您将必须在该平台上定义您的 TCHAR，或者使用提供 TCHAR 的库（但您无疑应该能够猜到，我也不是库中该概念的忠实粉丝）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T00:47:07.627

需要注意的一件事是确保您拥有的所有静态库以及使用这些静态库的模块都使用相同的 char 格式。因为否则您的代码将编译，但无法正确链接。

`t`我通常根据 stl 类型创建自己的类型。tstring、tstringstream，甚至可以提升类型，例如 tpath_t。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T03:49:55.053

Unicode 字符集 + 对您的数据最有意义的编码。我通常使用 UTF-8，因为它对传统的 C/C++ 函数很方便，而且我处理的数据不会造成太大的膨胀。

一些 API (Windows) 和跨语言工具 (Java) 使用 UTF-16，因此这可能是一个考虑因素。

我希望我们做得更好的一种做法是将文本保留为数组字节，以进行复制、简单比较、简单搜索等低技术操作。当您需要更丰富的字符感知操作时，您可以将其转换为一些超级字符串 ( [icu 字符串](http://userguide.icu-project.org/strings)很好——但很重）并定义了*需要*执行此操作的层/入口点，而不是在任何地方天真地执行此操作。不必要的对话会扼杀我们的表现——尤其是与同样使用“超级”字符串的 XML DOM 库结合使用时。

# php - 在 php、ajax 或 javascript 中加载进度？

> ID：754363
> 
> 赞同：2
> 
> 时间：2009-04-16T00:46:17.257
> 
> 标签：php, javascript, ajax

任何人都知道如何在系统仍在服务器端获取数据时在客户端显示加载进度和完成百分比。

例如，当我在客户端按下“确定”按钮时，它会调用服务器端从数据库中收集数据，整个过程可能需要 2 到 3 分钟。如何在客户端显示加载进度（大约完成了多少 % 的加载）？

我怎样才能在 php、ajax 或 javascript 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-05T20:10:09.440

I needed the same thing done - tracking Ajax data download progress - so I'll post a solution that I used in case someone bumps into this thread:

```
var req = new XMLHttpRequest();

req.addEventListener("progress", onUpdateProgress, false);
req.addEventListener("load", onTransferComplete, false);
req.addEventListener("error", onTransferFailed, false);
req.addEventListener("abort", onTransferAborted, false);

req.open("GET", ..., true);

...

req.send()

function onUpdateProgress(e) {
  if (e.lengthComputable) {
    var percent_complete = e.loaded/e.total;
    document.getElementById("progressMessage").value = Math.round(percentComplete*100) +"% [ " + Math.round(e.loaded / 1000) + " KB ]";
    ...
  } else {
    // Length not known, to avoid division by zero
  }
}

function onTransferComplete(e) { ... }

function onTransferFailed(e)   { ... }

function onTransferAborted(e)  { ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T00:50:43.783

单击“确定”按钮后，您可以开始在服务器端获取数据并保持会话中加载的百分比。

这样，客户端您可以通过 AJAX 向另一个返回加载百分比的 php 脚本发出请求。

您最终会得到 2 个服务器端脚本（一个用于获取数据，另一个用于获取百分比）和一个 AJAX 请求客户端。

我认为这是一个简单的解决方案，应该做得很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T15:08:37.877

it's not that easy. if the ajax call starts the processing, you could do a chunked/multipart response (that's how most dhtml chats are implemented). google for "COMET".

basically it works like that:

1.  client: ajax call requesting the start of the long running action
2.  server: start the long running action, `echo` 0%, `flush();` (without script termination)
3.  client: recieves a response with the flushed content (special callback), displays the value and but the connection stays open!
4.  server: after x action calculate the percentage, `echo` and `flush();`
5.  client: see #3
6.  server: if the script is complete, terminate
7.  client: normal event/callback for end of script. display 100%, open next page

i once (when async javascript was still new!) coded a little demo ... it's a bit defunct now, but the async part still works. you can find it here: [http://wehrlos.strain.at/httpreq/client.html](http://wehrlos.strain.at/httpreq/client.html)

the javascript clientside code used

```
function asSendSyncMulti() {
    var httpReq = new XMLHttpRequest();

    showMessage( 'Sending Sync Multipart ' + (++this.reqCount)  );

    // Sync - wait until data arrives
    httpReq.multipart   = true;     
    httpReq.open( 'GET', 'server.php?multipart=true&c=' + (this.reqCount), false );
    httpReq.onload = showReq;
    httpReq.send( null );
}

function showReq( event ) {
    if ( event.target.readyState == 4 ) {
        showMessage( 'Data arrives: ' + event.target.responseText );
    }
    else {
        alert( 'an error occured: ' + event.target.readyState );
    }
} 
```

the serverside php code for the multipart part:

```
<?php

    $c = $_GET[ 'c' ];

        header('Content-type: multipart/x-mixed-replace;boundary="rn9012"');

        sleep( 1 );

        print "--rn9012\n";
        print "Content-type: application/xml\n\n";
        print "<?xml version='1.0'?>\n";
        print "<content>Multipart: First Part of Request " . $c . "</content>\n";
        print "--rn9012\n";
        flush();

        sleep( 3 );

        print "Content-type: application/xml\n\n";
        print "<?xml version='1.0'?>\n";
        print "<content>Multipart: Second Part of Request " . $c . "</content>\n";
        print "--rn9012--\n";
?> 
```

it's nothing more than a nudge in a possible direction. not html-compliant or cross browsery. use json instead of xml.

on the server side, output caching (e.g. for compression) must be turned off, otherwise the `flush();` won't do anything. and the `--rn9012` should be something that never occures in your outputted data (unlikley if you just display progress but still).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T00:49:41.710

我通过分页结果来做到这一点。

第一个请求是计数。然后将请求分解为一组组。然后开始一次请求一个组。

例如：如果要返回 100 条记录，我将它们分成 10 条为一组。然后我可以轻松地显示 10% ... 20%...等

我不知道怎么做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T00:50:35.497

jQuery 可以在 ajax 请求运行时显示启动屏幕 (div)。这可以使用 .ajaxStart 和 .ajaxEnd（或 .ajaxStop）对每个请求完成，或者更复杂的方法是使用 Dojo 的 dojo.io.bind 或遵循下面的定期刷新模式。

[定期刷新](http://ajaxpatterns.org/Periodic_Refresh)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-21T23:12:37.023

multipart/x-mixed-replace; with flush should work in a stateless load balanced environment. The approaches that rely on periodic GET requests to check progress will not succeed in environments where subsequent requests might go to a different back end.

# bash - 使用 shell 脚本包装程序的陷阱？

> ID：754367
> 
> 赞同：1
> 
> 时间：2009-04-16T00:47:33.557
> 
> 标签：bash

考虑我有一个需要环境集的程序。它在 Perl 中，我想修改环境（在特殊位置搜索库）。

每次我弄乱了在 UNIX 中做事的标准方法时，我都付出了沉重的代价，并且在灵活性上付出了代价。

我知道通过使用一个简单的 shell 脚本，我将在进程树中注入一个额外的进程。任何访问自己的进程树的进程都可能会被抛出一点点循环。

任何以非平凡方式递归的东西都需要抵御环境的多次扩展。

任何类似于在程序管道中的东西（或关闭和打开`STDIN`, `STDOUT`, 或`STDERR`）都是我最关心的领域。

我在对自己做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T01:03:30.333

> 我在对自己做什么？

让自己无所事事？

将程序包装在 shell 脚本中以设置环境实际上是非常标准的，除非您尝试做一些*非常*奇怪的事情，否则风险非常小。

如果您真的担心周围还有一个进程——而 UNIX 进程在设计上非常便宜——那么请使用`exec`关键字，而不是派生一个新进程，只需 exec 用一个新的可执行文件代替当前的可执行文件。所以，你可能在哪里

```
#!/bin/bash -
FOO=hello
PATH=/my/special/path:${PATH}
perl myprog.pl 
```

你只会说

```
#!/bin/bash -
FOO=hello
PATH=/my/special/path:${PATH}
exec perl myprog.pl 
```

并且备用进程消失了。

然而，这个技巧几乎不值得费心。一个反例是，如果您无法更改默认外壳，那么说

```
$ exec zsh 
```

而不是仅仅运行 shell，因为这样你就可以得到进程控制的预期行为等等。

# configuration - How/where to store enterprise configuration settings?

> ID：754390
> 
> 赞同：0
> 
> 时间：2009-04-16T00:56:31.473
> 
> 标签：configuration, settings, enterprise

My company has a large customer that has many regions/sites/offices. Each location can have its own set of servers with its own data. The users of the system are centrally administered thru a domain. The computers in this network are locked down with only http access to the internet. There is a company wide Sharepoint portal. All servers and computers are Windows based (mostly XP, Server 2003).

We have written a number of utilities for them. Some are loaded from the network, but an increasing number of these are installed directly to a users machine. Typically we have been configuring these tools thru ini's or xml's. However, this is becoming cumbersome to update if a server is updated or settings need to be tweaked.

While I'm not concerned with how the data is stored, I'd like to have a common way to find or locate this data. The method will have to contend with certain knowing what office/region the user is on and return an appropriate location. I'll have to cache this data locally on the machine in case the network fails (seems to happen every so often).

I've already thought of a couple of ideas, but have no idea how effective or practical these are:

*   Use Sharepoint.
*   Use ActiveDirectory/LDAP.
*   Use Bonjour/Zeroconf.

What tools and/or technologies can I use enterprise wide to configure locally installed applications?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T01:04:56.557

If your customer uses active directory already, then you can use a logon script to download the master configuration files they might need.

This would only occur when they login while connected to the domain so your connectivity requirement is met, and since it'd only be downloaded at that time all your client apps could load the data locally satisfying the locality requirement.

Then, when you deploy an updated configuration file, all users would need to do is login again while connected to the network.

This script would not be unlike the scripts often used to mount available network shares or configure local printers. In each case, you can determine where a user is located and thus what config file they should download.

That is of course presuming that these config values don't change very often. If it's likely that they will change so often as to make a logout/login inconvenient, you'll have to go with another approach.

# c# - Hiding fields from the debugger

> ID：754393
> 
> 赞同：36
> 
> 时间：2009-04-16T00:58:19.787
> 
> 标签：c#, debugging

Is it possible to hide fields and/or properties from showing up in the debugger watch window? See, we've got a class here with over 50 private fields, most of which are exposed through public properties. This means we're seeing a duplication of a large number of data in the watch window listing.

Is there any means of controlling this?

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-16T01:02:11.180

Try this attribute:

```
 [DebuggerBrowsable(DebuggerBrowsableState.Never)] 
```

Use it to hide your backing fields by placing the attribute above the field declaration like this:

```
class Foo
{
    [DebuggerBrowsable(DebuggerBrowsableState.Never)]
    int bar;  // this one will be hidden
    int baz;  // but this one will be visible like normal
} 
```

Keep in mind that the `DebuggerBrowsableState` enumeration has two other members:

> **`Collapsed:`** Collapses the element in the debugger.
> **`RootHidden:`** This shows child elements of a collection but hides the root element itself.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-16T01:03:19.260

Check out the DebuggerBrowsableAttribute:

[http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerbrowsableattribute.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerbrowsableattribute.aspx)

In fact, this article has some very useful tips for this area:

[http://msdn.microsoft.com/en-us/magazine/cc163974.aspx](http://msdn.microsoft.com/en-us/magazine/cc163974.aspx)

You might find that using a DebuggerTypeProxy makes more sense. This allows you to provide a "custom view" of the type.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T01:18:10.020

The DebuggerBrowsableAttribute is covered in this other [SO question](https://stackoverflow.com/questions/9033/hidden-features-of-c). If you're doing C# heavily then it's a good question to read up on.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T21:03:56.930

I know this is old but you would be much better off with using DebuggerTypeProxy [http://msdn.microsoft.com/en-us/library/d8eyd8zc.aspx](http://msdn.microsoft.com/en-us/library/d8eyd8zc.aspx)

this way you don't have to modify your class with ugly attributes and the extra benefit is that you can always look at the real type if you do in fact need to have a look at one of those "hidden" fields.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-16T01:01:02.400

You could use autos instead of locals or use watches and only watch the variables of interest...

# shell - 将 grep 结果分配给 shell 变量后丢失换行符

> ID：754395
> 
> 赞同：85
> 
> 时间：2009-04-16T00:59:36.117
> 
> 标签：shell

```
#!/usr/local/bin/bash
out=`grep apache README`
echo $out; 
```

通常 grep 在命令行上运行时会在单独的行上显示每个匹配项。但是，在上述脚本中，分隔每个匹配项的换行符消失了。有谁知道如何保存换行符？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-04-16T01:08:50.587

您不会在作业中丢失它，而是在回声中丢失它。你可以清楚地看到这一点，如果你：

```
echo "${out}" 
```

您将看到以下脚本的类似效果：

```
x="Hello,
I
am
a
string
with
newlines"
echo "====="
echo ${x}
echo "====="
echo "${x}"
echo "=====" 
```

输出：

```
=====
Hello, I am a string with newlines
=====
Hello,
I
am
a
string
with
newlines
===== 
```

而且，与您的问题无关，但我还是想提一下，我更喜欢使用 $() 构造而不是反引号，只是为了能够嵌套命令的额外好处。所以你的脚本行变成：

```
out=$(grep apache README) 
```

现在看起来可能没有什么不同（实际上没有），但它可以实现更复杂的命令，例如：

```
lines_with_nine=$(grep $(expr 7 + 2) inputfile) 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-16T01:05:36.087

将 $out 放在引号中：

```
#!/usr/local/bin/bash
out=`grep apache README`
echo "$out"; 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-04-16T02:15:10.397

在 bash 中引用变量会保留空格。

例如：

```
#!/bin/bash
var1="A B  C   D"
echo $var1   # A B C D
echo "$var1" # A B  C   D 
```

由于换行符是空格，因此它们被“删除”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-05-21T13:59:41.613

将其他答案组合成一个衬里：

```
echo "($(grep apache README))" 
```

# ruby - 在Ruby中将字符串切成给定长度的块的最佳方法是什么？

> ID：754407
> 
> 赞同：97
> 
> 时间：2009-04-16T01:06:49.670
> 
> 标签：ruby, string, chunking

我一直在寻找一种优雅而有效的方法来将字符串分块为 Ruby 中给定长度的子字符串。

到目前为止，我能想到的最好的是：

```
def chunk(string, size)
  (0..(string.length-1)/size).map{|i|string[i*size,size]}
end

>> chunk("abcdef",3)
=> ["abc", "def"]
>> chunk("abcde",3)
=> ["abc", "de"]
>> chunk("abc",3)
=> ["abc"]
>> chunk("ab",3)
=> ["ab"]
>> chunk("",3)
=> [] 
```

您可能想要`chunk("", n)`返回`[""]`而不是`[]`. 如果是这样，只需将其添加为方法的第一行：

```
return [""] if string.empty? 
```

你会推荐任何更好的解决方案吗？

**编辑**

感谢 Jeremy Ruten 提供了这个优雅而高效的解决方案：[编辑：效率不高！]

```
def chunk(string, size)
    string.scan(/.{1,#{size}}/)
end 
```

**编辑**

string.scan 解决方案将 512k 切成 1k 块 10000 次大约需要 60 秒，而原始基于切片的解决方案仅需要 2.4 秒。

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-04-16T01:26:05.413

使用`String#scan`：

```
>> 'abcdefghijklmnopqrstuvwxyz'.scan(/.{4}/)
=> ["abcd", "efgh", "ijkl", "mnop", "qrst", "uvwx"]
>> 'abcdefghijklmnopqrstuvwxyz'.scan(/.{1,4}/)
=> ["abcd", "efgh", "ijkl", "mnop", "qrst", "uvwx", "yz"]
>> 'abcdefghijklmnopqrstuvwxyz'.scan(/.{1,3}/)
=> ["abc", "def", "ghi", "jkl", "mno", "pqr", "stu", "vwx", "yz"] 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-02-04T20:04:59.770

这是另一种方法：

```
"abcdefghijklmnopqrstuvwxyz".chars.to_a.each_slice(3).to_a.map {|s| s.to_s } 
```

=> [“abc”、“def”、“ghi”、“jkl”、“mno”、“pqr”、“stu”、“vwx”、“yz”]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-07-26T14:00:08.720

如果您知道您的字符串是块大小的倍数，我认为这是最有效的解决方案

```
def chunk(string, size)
    (string.length / size).times.collect { |i| string[i * size, size] }
end 
```

对于零件

```
def parts(string, count)
    size = string.length / count
    count.times.collect { |i| string[i * size, size] }
end 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-02-20T23:17:31.453

我做了一个小测试，将大约 593MB 的数据切成 18991 个 32KB 的片段。在我按下 ctrl+C 之前，您的 slice+map 版本使用 100% CPU 运行了至少 15 分钟。这个使用 String#unpack 的版本在 3.6 秒内完成：

```
def chunk(string, size)
  string.unpack("a#{size}" * (string.size/size.to_f).ceil)
end 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-09-20T09:28:42.927

这是另一种解决方案略有不同的情况，当处理大字符串并且不需要一次存储所有块时。通过这种方式，它一次存储单个块并且执行速度比切片字符串快得多：

```
io = StringIO.new(string)
until io.eof?
  chunk = io.read(chunk_size)
  do_something(chunk)
end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T01:20:56.657

```
test.split(/(...)/).reject {|v| v.empty?} 
```

拒绝是必要的，因为它包括集合之间的空白空间。我的 regex-fu 还没有完全想到如何解决这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-02-06T10:19:11.333

一个更好的解决方案，它考虑到可能小于块大小的字符串的最后一部分：

```
def chunk(inStr, sz)  
  return [inStr] if inStr.length < sz  
  m = inStr.length % sz # this is the last part of the string
  partial = (inStr.length / sz).times.collect { |i| inStr[i * sz, sz] }
  partial << inStr[-m..-1] if (m % sz != 0) # add the last part 
  partial
end 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T01:15:04.520

您还有其他一些限制吗？否则我会非常想做一些简单的事情，比如

```
[0..10].each {
   str[(i*w),w]
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-08T11:56:59.657

只是`text.scan(/.{1,4}/m)`解决问题

# c# - 在线程中不断循环列表，因为它接收到新元素

> ID：754410
> 
> 赞同：4
> 
> 时间：2009-04-16T01:10:12.067
> 
> 标签：c#, .net, events, queue

我真的不知道如何解决这个问题，但我订阅了自定义类中触发的事件，理想情况下我希望将它们排队并在它们进来时先入先出处理它们。我知道`Queue<T>`并且我认为我应该用这个？但是我的问题是在收到我的消息时的事件处理程序中，我是否只是`Enqueue()`到那里的队列，如果是这样，那么当添加新项目时如何处理队列？

我正在考虑在构造函数中调用一个方法，该方法执行类似（*抓住你的帽子*）：

```
while (true)
{
  foreach (var item in myQueue)
  {
    // process
    myQueue.Dequeue();
  }
} 
```

当然必须有一个更优雅的方式来做到这一点？这应该有效地击中 myQueue 并进行迭代，因为它包含元素并做我想做的事。表现会如何？我可以在单独的线程上生成它以避免任何线程阻塞，我真的有时间接受`while (true)`！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T01:13:56.207

这是一个经典的生产者/消费者问题。快速的网络搜索显示[http://msdn.microsoft.com/en-us/library/yy12yx1f(VS.80,loband).aspx](http://msdn.microsoft.com/en-us/library/yy12yx1f(VS.80,loband).aspx)，它完全涵盖了这一点。

你不想做一个 while(true) 循环，因为你的线程将消耗 100% 的 CPU，即使它没有工作，可能会饿死系统中的其他线程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T01:15:38.637

你不能这样做。如果在枚举器仍在使用时更改了基础集合，则为 foreach 返回的枚举器将引发异常。

本质上，您需要做的是设置另一个线程来处理事件。理想情况下，您会向这个其他线程（通过事件或其他同步机制）发出信号，表明有可用的工作。它将使工作项出列，处理它，然后休眠直到下一个信号进来。或者您可以使用轮询（定期唤醒并检查另一个项目），但这会降低效率。在任何情况下，您都需要使用锁定来确保您不会尝试同时修改两个线程中的队列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T01:14:55.127

如果您从多个线程运行它，则需要引入某种形式的锁定以防止队列同步出现问题。您可能还应该确保在将元素入队以及出队时锁定队列。

如果处理您的队列的线程除此之外什么都不做，那么您的基本代码可能没问题，除了处理队列当前为空的情况。您可能应该添加以下内容：

```
while (myQueue.Count == 0)
    Thread.Sleep(sleepTime); 
```

这将为您提供一种“等待”的方法，直到您的事件填满您的队列。

此外，当您从队列中出列时，您将无法使用 foreach。您需要执行以下操作：

```
while (myQueue.Count == 0)
    Thread.Sleep(sleepTime);
while (myQueue.Count > 0)
{
    lock(myLock)
        myObject = myQueue.Dequeue();
    // do your work...
} 
```

如果有人添加到您的队列中，这将防止集合修改问题，并使您无需锁定处理元素的整个时间。

* * *

编辑：我同意一些评论，这并不总是最有效的策略。

如果队列大部分是空的，并且偶尔只有元素，我会创建一个自定义类来包装它。

当队列为空/非空时，您可能会触发一个事件。一旦队列接收到项目，该事件就会触发一个线程来处理它并将其清空。一旦达到 0 个项目，它就会有一个事件来停止处理。

如果队列的状态大部分时间都是空的，这将比不断等待更有效。另一方面，如果队列几乎总是满的，并且处理线程很少跟上，为了简单起见，我会使用上面的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T01:35:54.220

我通常使用 ManualResetEvent 来表示元素已添加到集合中。

事件处理程序执行以下操作：

```
lock (myLock)
{
   myq.Enqueue(...);
   myqAddedSignal.Set();
} 
```

处理线程等待信号 - 一旦发出信号，它就会清空队列，重置信号然后处理项目：

```
while (true)
{
   myqAddedSignal.WaitOne();
   lock (myLock)
   {
      // pull everything off myQ into a list
      // clear myQ
      myqAddedSignal.Reset();
   }

   foreach (obj in copyOfMyQ)
   {
      ...
   }
} 
```

这将以线程安全的方式处理队列中的项目。唯一的共享状态是 myqAddedSignal - 对它的访问在 myLock 上同步（我通常只是将其设为对象）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T01:14:40.043

你在那里做的事情看起来不对劲。如果你真的在使用队列，那么你真的应该从队列中拉出项目，而不是迭代它：

```
while (!queue.empty()) // or whatever
{
  process the first item in the queue
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T03:45:22.940

您可以看到[这个现有的答案](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net/530228#530228)，它有这样一个队列。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T04:08:35.663

根据 Reed 给出的建议，我创建了一个自定义类并在队列为空并已填充时抛出事件。

自定义`EventQueue<T>`类：

```
public class EventQueue<T> : Queue<T>
{
    public delegate void OnQueueMadeEmptyDelegate();
    public event OnQueueMadeEmptyDelegate OnQueueMadeEmpty;
    public delegate void OnQueueMadeNonEmptyDelegate();
    public event OnQueueMadeNonEmptyDelegate OnQueueMadeNonEmpty;

    public new void Enqueue(T item)
    {
        var oldCount = Count;
        base.Enqueue(item);
        if (OnQueueMadeNonEmpty != null &&
            oldCount == 0 && Count > 0)
            // FIRE EVENT
            OnQueueMadeNonEmpty();
    }
    public new T Dequeue()
    {
        var oldCount = Count;
        var item = base.Dequeue();
        if (OnQueueMadeEmpty != null &&
            oldCount > 0 && Count == 0)
        {
            // FIRE EVENT
            OnQueueMadeEmpty();
        }
        return item;
    }
    public new void Clear()
    {
        base.Clear();
        if (OnQueueMadeEmpty != null)
        {
            // FIRE EVENT
            OnQueueMadeEmpty();
        }
    }
} 
```

（我已删除 <summary> 以获取更小的代码示例。我使用“new”修饰符作为将附加逻辑附加到基本逻辑的一种方式）。

主类中的私人：

```
public delegate void InitQueueDelegate();
private InitQueueDelegate initQueueDelegate;

private EventQueue<QueueRequest> translationQueue;
private Object queueLock = new Object(); 
```

在主类构造函数中：

```
initQueueDelegate = this.InitQueue;
initQueueDelegate.BeginInvoke(null, null); 
```

在主类主体中：

```
private void InitQueue()
{
    this.translationQueue = new EventQueue<QueueRequest>();
    this.translationQueue.OnQueueMadeEmpty += new EventQueue<QueueRequest>.OnQueueMadeEmptyDelegate(translationQueue_OnQueueMadeEmpty);
    this.translationQueue.OnQueueMadeNonEmpty += new EventQueue<QueueRequest>.OnQueueMadeNonEmptyDelegate(translationQueue_OnQueueMadeNonEmpty);
}

void translationQueue_OnQueueMadeNonEmpty()
{
    while (translationQueue.Count() > 0)
    {
        lock (queueLock)
        {
            QueueRequest request = translationQueue.Dequeue();
#if DEBUG
            System.Diagnostics.Debug.WriteLine("Item taken from queue...");
#endif
            // hard work
            ....
            ....
            ....
        }
    }
}

void translationQueue_OnQueueMadeEmpty()
{
    // empty queue
    // don't actually need to do anything here?
}

private void onMessageReceived(....)
{
  ....
  ....
  ....
  // QUEUE REQUEST
  lock (queueLock)
  {
    QueueRequest queueRequest = new QueueRequest
                                    {
                                        Request = request,
                                        Sender = sender,
                                        Recipient = tcpClientService
                                    };
    translationQueue.Enqueue(queueRequest);
#if DEBUG
    System.Diagnostics.Debug.WriteLine("Item added to queue...");
#endif
  }
} 
```

最后是 QueueRequest 结构：

```
public struct QueueRequest
{
    public MessageTranslateRequest Request { get; set; }
    public TCPClientService Sender { get; set; }
    public TCPClientService Recipient { get; set; }
} 
```

我知道那里有很多，但希望你们检查完整的实现。你怎么看？我执行锁定的方式是否正确？

如果这没问题，我将奖励 Reed，因为我的解决方案是根据他的想法创建的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T05:28:45.547

您正在寻找的结构是信号量。

您将项目添加到队列中，然后将计数添加到信号量。

您在另一个线程中等待信号量，并处理队列中的一个项目。

根据队列实现（如 BCL 之一），您必须在检索时锁定/解锁。

# javascript - 存储对 DOM 元素的引用

> ID：754420
> 
> 赞同：9
> 
> 时间：2009-04-16T01:16:21.007
> 
> 标签：javascript, dom, reference

在我正在编写的特定脚本中，我有许多对象链接到一些 DOM 元素。鉴于每个元素都有一个唯一的 id，每个对象应该只保留元素的 id（并且每次都使用 document.getElementById），还是将元素存储在属性中？

这是我的意思的简化示例：

```
function myThing(elId) {
    this.elId = elId;
}
myThing.prototype.getElValue = function() {
    return document.getElementById(this.elId).nodeValue;
};

// -- vs -- //

function myThing(elId) {
    this.el = document.getElementById(elId);
}
mything.prototype.getElValue = function() {
    return this.el.nodeValue;
}; 
```

它有什么不同吗？有什么我应该知道的性能问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T01:41:33.207

我会存储元素；当您不一直调用 document.getElementById 时，它往往会使代码更清晰，尽管在您的情况下，您可能不需要更改 ID 或允许没有 ID 的元素，但这样做很常见。

（与 apphacker 不同，我不希望这样做会带来*巨大的*效率提升，因为 getElementById 在浏览器中往往得到了相当好的优化。）

> 有什么我应该知道的性能问题吗？

从 JavaScript 对象到 DOM 对象的引用本身很好，但是当一个 DOM 对象有一个返回到这样一个 JavaScript 对象的链接时（通常通过事件处理程序），你就有了一个引用循环。这会导致 IE6-7 泄漏内存，因为它无法释放循环对象。对于小型简单的应用程序，您可能不在乎。对于复杂的、长时间运行的应用程序，您可能必须解决该问题，例如通过查找映射/数组来间接处理每个事件处理程序，这样就不会从 DOM 对象直接引用到真正的事件处理程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T01:17:57.413

存储元素而不是 id，查找缓慢且昂贵，并为您节省了函数调用。我认为一个简单的测试可以证实这一点。

# python - 这是如何“在分配前引用”的？

> ID：754421
> 
> 赞同：1
> 
> 时间：2009-04-16T01:17:43.857
> 
> 标签：python

我有一点 Python 可以连接到数据库，其中包含本地与实时的切换开关。

```
 LOCAL_CONNECTION = {"server": "127.0.0.1", "user": "root", "password": "", "database": "testing"}
    LIVE_CONNECTION = {"server": "10.1.1.1", "user": "x", "password": "y", "database": "nottesting"}

    if debug_mode:
        connection_info = LOCAL_CONNECTION
    else:
        connnection_info = LIVE_CONNECTION
    self.connection = MySQLdb.connect(host = connection_info["server"], user = connection_info["user"], passwd = connection_info["password"], db = connection_info["database"]) 
```

在本地（Windows，Python 2.5）工作正常，但在现场（Linux，Python 2.4）我得到：

```
UnboundLocalError: local variable 'connection_info' referenced before assignment 
```

即使我删除 if/else 并将连接信息直接分配给 LIVE_CONNECTION 值，我也会看到相同的错误。如果我将实时连接值硬编码到最后一行，则一切正常。很明显我困了。我没看到什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-16T01:19:32.107

第二个作业拼写错误。

你写`connnection_info = LIVE_CONNECTION`了 3 个 n。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T01:19:58.330

错字： connnection_info = LIVE_CONNECTION

# c# - 以驼峰命名的类名表示缩写

> ID：754422
> 
> 赞同：2
> 
> 时间：2009-04-16T01:17:48.240
> 
> 标签：c#, .net, naming-conventions

我正在创建一个 C# 库，并将使用它们使用的协议（TCP、UDP 等）作为大多数公共类的前缀，我遇到了一个难题：应该是`TCPXxxx`还是`TcpXxxx`？

.NET 框架中似乎没有标准（`IPAddress`vs `TcpClient`）。

使用库时您更喜欢哪个：`TCPXxxx`或`TcpXxxx`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-16T01:19:26.600

根据设计指南，它应该是 TcpXxxx。

在设计指南中，2 个字母的首字母缩略词大写，所有其他首字母大写。

来自Cwalina 和 Abrams 的*框架设计指南*：

> *   务必将双字符首字母缩写词的两个字符大写，驼峰式标识符的第一个单词除外。

> ```
>  System.IO
>     public void StartIO(Stream ioStream) 
> ```

> *   仅将具有三个或更多字符的首字母缩略词的第一个字符大写，除了驼峰式标识符的第一个单词。

[MSDN](http://msdn.microsoft.com/en-us/library/ms229043.aspx)有一个简短的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T02:04:11.843

我总是喜欢想象一个将 WordsLikeThis 转换为 words-like-this 的理论过程，并想象有问题的名称将如何转换。一些例子：

TCPSocket -> tcp-socket
TcpSocket -> tcp-socket

显然后者更有意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T01:21:53.927

通常，当它是 2 个字符的前缀时，保留大写（IPAddress），当它是 3 个或更多字符时，Pascal 大小写前缀（TcpXxxx）。

此规则有一些例外（例如，如果前缀是大写的专有名称）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T01:55:41.270

我知道这是 C# 编码风格，但我更喜欢[Python PEP 8 风格](http://www.python.org/dev/peps/pep-0008/)

> 注意：在 CapWords 中使用缩写词时，将缩写词的所有字母大写。因此 HTTPServerError 比 HttpServerError 好。

但是在罗马时……一致的代码更好，这就是语言风格指南是个好主意的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T02:22:19.023

您可能会考虑将这些类放在名为“TCP”的命名空间中。如果您这样做，那么您在该命名空间中的函数/类名称将变得更短更清晰，您根本不必担心这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T13:40:55.247

我知道在eclipse中我可以通过只使用类型名称的大写字母来快速指定一个类型，所以我更喜欢大写而不是大写......我不知道VS是否可以做同样的事情，但它是*粉丝- 美味的*。

# php - 条件准备语句不切换

> ID：754432
> 
> 赞同：0
> 
> 时间：2009-04-16T01:21:40.993
> 
> 标签：php, sql, mysql

我有以下 PHP 代码，用于在给定用户名的用户名字段为空的情况下插入数据，或者如果用户名存在则更新数据。目前，插入之前工作正常，但它永远不会切换到更新子句。

然而，现在插入子句无法识别我的测试变量，没有明显的原因。我得到的错误是：

```
Warning: mysqli_fetch_assoc() expects parameter 1 to be mysqli_result, boolean given 
```

和

```
Notice: Undefined variable: checkUsername 
```

这是最近的。

```
if($cmd=="submitinfo"){

$usernameQuery = "select username from USERS where username = $username";

$xblah = $con->query($usernameQuery);
  while ($row = mysqli_fetch_assoc($xblah))
  {
    $checkUsername = $row['username'];

  }

if ($checkUsername == null) {

$userQuery = "INSERT INTO USERS VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
if ($userInfo = $con->prepare($userQuery)) {
    $userInfo->bind_param("ssssssssssssssssssss", $username, $firstname, $lastname, $flaggedauctions, $lastauction, $street1, $city1, $postcode1, $street2, $city2, $postcode2, $phone, $mobilephone, $fax, $email, $website, $bank, $banknumber, $accountnumber, $comments);
    $userInfo->execute();
    $userInfo->close();
    echo "true";
} else {
echo "false";
}
print_r($con->error);
}

else if ($checkUsername == $username) {

$userQuery = "UPDATE USERS SET firstname = ?, lastname = ?, flaggedauctions = ?, lastauction = ?, street1 = ?, city1 = ?, postcode1 = ?, street2 = ?, city2 = ?, postcode2 = ?, phone = ?, mobilephone = ?, fax = ?, email = ?, website = ?, bank = ?, banknumber = ?, accoutnumber = ? WHERE username = ?";
if ($userInfo = $con->prepare($userQuery)) {
    $userInfo->bind_param("sssssssssssssssssss", $firstname, $lastname, $flaggedauctions, $lastauction, $street1, $city1, $postcode1, $street2, $city2, $postcode2, $phone, $mobilephone, $fax, $email, $website, $bank, $banknumber, $accountnumber, $username);
    $userInfo->execute();
    $userInfo->close();
    echo "true";
} else {
echo "false";
}
print_r($con->error);
}
} 
```

根据与用户名字段匹配的 $username 的内容，进行更新或插入的首选方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T01:28:24.177

```
Warning: mysqli_fetch_assoc() expects parameter 1 to be mysqli_result, boolean given 
```

那是你的错误信息？我认为你的问题是这一行：

```
$xblah = $con->query($usernameQuery); 
```

`var_dump`在 $xblah 上做一个。我怀疑你的查询失败了。可能是因为你没有`$username`从你的输入中获取。而对于根的爱，一定要逃离它！`mysql_real_escape_string()`会做你想做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T12:20:29.123

如果你使用 MySQL 并且用户名是唯一的，你可以使用这个方便的 SQL：

```
INSERT INTO users (?, ?, ...) ON
DUPLICATE KEY UPDATE firstname=?,
lastname=?, ...) 
```

有关完整文档，请参阅[http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)。

# objective-c - Objective C 中的结构数组或原生数据类型

> ID：754433
> 
> 赞同：1
> 
> 时间：2009-04-16T01:21:45.110
> 
> 标签：objective-c, arrays, struct

我已经遇到过几次这个问题了。上次，我想创建一个 BOOL 的数组（矩阵）数组。我最终将它们封装在 NSStrings 中，因为显然 NSArray 只有对象数组。

这一次，再次想要一个数组数组，但是是 CGPoints。我将使用这些将图像绘制到屏幕上。有没有办法在它们不是对象的情况下创建一个 CGPoints 数组？我是否应该担心拥有 96 个对象的矩阵的内存/性能开销？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T02:00:19.043

我猜 96 是一个很小的数字，你不必太担心。如果您使用 CGPoints，您可以使用 NSValue 来包装点（而不是 NSStrings），方法是在 iPhone 上使用 [NSValue valueWithCGPoint:] 方法或在 Mac OS X 10.5 上使用 [NSValue valueWithPoint:]。

话虽如此，如果您提前知道 CGPoints 的数量，那么创建一个 CGPoints 数组非常容易。[我在这里](https://stackoverflow.com/questions/638129/how-to-declare-a-two-dimensional-array-of-string-type-in-objective-c/638183#638183)讨论了这些选项（用于字符串，而不是点）。在这种情况下，您可以像这样在 C 中创建一个二维数组：

```
CGPoint myArray[32][3]; 
```

然后像这样使用它`CGPoint onePoint = myArray[2][1];`

# c# - C# 中的 ODBC .DBF 文件

> ID：754436
> 
> 赞同：0
> 
> 时间：2009-04-16T01:22:08.713
> 
> 标签：c#, odbc, dbf

我在使用 .dbf 文件时遇到了很多麻烦。我有一个用 C# 编写的应用程序，它从 .DBF 文件中读取，然后将它们导出到另一个数据库。我尝试使用 Microsoft dBase 驱动程序，但它没有读取我需要的所有 .DBF 文件，这意味着我只能从五个 .DBF 文件中的两个中检索数据，Visual Studio 告诉我其他 .DBF 文件不存在，它一直说我的输入字符串太大。有一些 Microsoft Visual Fox Pro 驱动程序，但每次我选择其中一个时，Visual Studio 都会告诉我它无法建立连接。最糟糕的是，这个应用程序将在我无权访问的客户端机器上使用。如何保留 ODBC 数据源，以便我的应用程序可以在其他人的机器上运行？我对.DBFs非常陌生，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T01:35:39.570

这些 DBF 文件是由 Foxpro 生成的吗？如果它们是由高于 7 的 Foxpro 版本创建的，则 ODBC 驱动程序无论如何都不会读取它们。在这种情况下，请改用[OLE-DB 驱动程序](http://www.microsoft.com/downloads/details.aspx?FamilyId=E1A87D8F-2D58-491F-A0FA-95A3289C5FD4&displaylang=en)- 无论它们的来源如何，它都可以与您的文件一起使用，值得一试，因为使用 OLE-DB 可以摆脱 ODBC 数据源的惨败。

编辑：删除垃圾邮件链接

# algorithm - 迭代树行走

> ID：754439
> 
> 赞同：14
> 
> 时间：2009-04-16T01:24:01.190
> 
> 标签：algorithm, tree

*自从我在大学学习数据结构和算法*以来已经有一段时间了，所以最近我对递归可能不是进行树遍历**的方式**(tm)的建议感到惊讶。由于某种原因，迭代的、基于队列的遍历并不是我曾经使用过的技术。

如果有的话，迭代与递归遍历的优势是什么？在什么情况下我可以使用其中一种而不是另一种？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-16T01:30:28.100

如果您进行广度优先搜索，自然实现是将节点推入队列，而不是使用递归。

如果您正在进行深度优先搜索，那么递归是编码遍历的最自然方式。但是，除非您的编译器将尾递归优化为迭代，否则您的递归实现将比迭代算法慢，并且会在足够深的树上因堆栈溢出而死。

一些快速的 Python 来说明差异：

```
#A tree is a tuple of an int and a tree. 
t = (1, (2,(4, (6), (7, (9)) )), (3, (5, (8)) ))
def bfs(t):
    to_visit = [t]
    while len(to_visit) > 0:
        c = to_visit[0]
        if type(c) is int:
            print c
        else: 
            print c[0]
            to_visit.append(c[1])
            if len(c) > 2: to_visit.append(c[2])
        to_visit = to_visit[1:]

def dfs(t):
    if type(t) is int:
        print t
        return 
    print t[0]
    dfs(t[1])
    if len(t) > 2: dfs(t[2]) 

bfs(t)
dfs(t) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-16T01:31:27.770

如果您有固定数量的专用于堆栈的内存，就像您经常做的那样（这在许多 Java JVM 配置中尤其是一个问题），如果您有一个深树（或者如果递归深度在任何其他情况）；这将导致堆栈溢出。迭代方法，将节点推送到队列（用于 BFS 类遍历）或堆栈（用于 DFS 类遍历）在多个方面具有更好的内存属性，因此如果这很重要，请使用迭代方法。

递归的优点是表达的简单/优雅，而不是性能。记住这一点是为给定算法、问题规模和机器架构选择合适方法的关键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T01:31:14.933

这取决于您是要进行深度优先还是广度优先遍历。深度优先是最容易通过递归实现的。使用广度优先，您需要保留一个节点队列以在将来扩展。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T02:29:17.273

实际上，您应该使用队列进行广度优先搜索，使用堆栈进行深度优先搜索，并从 while 循环中运行您的算法。如果您在遍历时执行简单的操作，进行递归函数调用会显着拖累您的程序，并可能导致堆栈溢出，但现在您需要非常努力地看到一个。

只需在旁边放一个哈希来跟踪已经访问过的节点，以防它不是树而是连接良好的图。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-09-12T23:17:39.890

使用递归，因为您实际上可能会遇到堆栈溢出错误，毕竟这是 stackoverflow.com。

# c# - 如何在 MouseEnter 上为 TextBlock 加下划线

> ID：754441
> 
> 赞同：16
> 
> 时间：2009-04-16T01:26:04.633
> 
> 标签：c#, wpf

在 WPF 表单中，我有以下 TextBlock。当我将鼠标移到它上面时，我希望看到 TextBlock 的文本带有下划线。我怎样才能做到这一点？我尝试使用 TextBlock.Triggers，但它没有用。

谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-16T01:34:33.520

使用样式：

```
<TextBlock Text="Hurrah">
  <TextBlock.Style>
    <Style TargetType="TextBlock">
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="TextDecorations" Value="Underline" />
        </Trigger>
      </Style.Triggers>
    </Style>
  </TextBlock.Style>
</TextBlock> 
```

（为简洁起见，样式显示为内联；如果您打算重用它，请提取到资源中。）

# class - ASP.NET - 如何引用不在 app_code 中的类

> ID：754443
> 
> 赞同：3
> 
> 时间：2009-04-16T01:26:23.773
> 
> 标签：class, reference, app-code

我创建了一个名为 MyMasterPage 的 MasterPage。

```
public partial class MyMasterPage : System.Web.UI.MasterPage
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

我还在 app_code 中创建了一个名为 Class1 的类：

```
public class Class1
{
    public Class1()
    {
      MyMasterPage m;
    }
} 
```

在 Class1 中，我想引用 MyMasterPage 但我收到编译器警告：

```
The type or namespace name 'MyMasterPage' could not be found (are you missing a using directive or an assembly reference?) 
```

我需要添加什么代码才能使其正常工作？

这些类位于文件夹中，如下所示：

[替代文字 http://www.yart.com.au/stackoverflow/masterclass.png](http://www.yart.com.au/stackoverflow/masterclass.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T01:49:27.277

除非您也将它放在 App_Code 下，否则您将无法引用 MyMasterPage。通常在这种情况下，您将创建一个从 MasterPage 继承的基本母版页。例如

```
public partial class MasterPageBase : System.Web.UI.MasterPage
{
   // Declare the methods you want to call in Class1 as virtual
   public virtual void DoSomething() { }

} 
```

然后在您的实际母版页中，而不是从 System.Web.UI.MasterPage 继承，而是从您的 MasterPageBase 继承。覆盖继承页面中的虚拟方法。

```
public partial class MyMasterPage : MasterPageBase 
```

在您需要引用它的 Class1 中（我假设您从 Page 类的 MasterPage 属性中获取母版页，您的代码将看起来像......

```
public class Class1
{
    public Class1(Page Target)
    {
      MasterPageBase _m = (MasterPageBase)Target.MasterPage;
      // And I can call my overwritten methods
      _m.DoSomething();
    }
} 
```

这是一个相当冗长的方法，但到目前为止，我能想到的唯一方法是考虑到 ASP.NET 模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T01:31:18.317

尝试将母版页放在命名空间中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T02:18:42.917

fung 有一个很好的建议，即使用基本页面。App_Code 文件存储在与 aspx 页面不同的程序集中。网站项目会发生这种情况。

我不确定您是否可以选择。但是，如果您选择 Web 应用程序项目而不是网站项目，那么您将不会遇到这个问题。

这里有一篇博文可能会有所启发： [VS 2005 Web Project System：它是什么以及我们为什么要这样做？斯科特·格思里](http://weblogs.asp.net/scottgu/archive/2005/08/21/423201.aspx)

# winforms - 进行渐进式披露时如何处理标签顺序？

> ID：754457
> 
> 赞同：1
> 
> 时间：2009-04-16T01:35:09.213
> 
> 标签：winforms

我正在将 VB6 应用程序转换为 Winforms，在 VB6 中，我们经常使用一种技术，其中某些文本框仅在之前的文本框中输入特定值时才可见。

问题在于，使文本框可见的决定仅在 Validating 事件中做出，此时已确定下一个获得焦点的控件。当我们使依赖文本框可见时，焦点已经跳过了控件。

我们能够通过在两个文本框之间放置一个空的、透明的用户控件并在用户控件的 gotfocus 事件中在键盘缓冲区中填充一个额外的 TAB 来解决 VB6 中的问题。令人惊讶的是，它运作良好。它甚至可以在您移回制表符时起作用。由于某种原因，用户控件被忽略并且焦点返回到第一个文本框。不出所料，我希望 Winforms 有更好的解决方案。

有没有人成功处理过这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T17:43:32.887

我在 winform 应用程序上遇到了类似的问题，我需要一个隐藏的文本框，以便根据前一个控件的值显示，同时将控件置于 Tab 键顺序，以便获得焦点。我最初的解决方案是设置一个类级别变量，该变量将与 2 个控件上的 GotFocus 和 LostFocus（或 Enter/Exit）一起使用，以确定是否从前一个控件中丢失焦点并强制将焦点设置到下一个控件。这不是一个可靠的解决方案，但仍然是一种选择。

不过，我目前的解决方案效果要好得多。我需要为初始控件放置一个搜索按钮。此按钮位于 2 个控件之间的 Tab 键顺序中。因为按钮将从第一个控件获得焦点，所以当第一个控件验证时，它将给第二个控件时间来显示自己。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T10:47:45.840

我相信您会发现 WinForms 中的东西“正常工作”。

Validating事件在做出关于哪个字段应该接收焦点的任何决定之前触发 - 这*允许*事件在验证失败时强制焦点回到原始控件。

[查看 MSDN 中的Control.Validating](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx)事件的详细信息，了解哪些事件以何种顺序触发。

或者，也许验证事件在工作流程中为时已晚 - 您是否考虑过在相关字段中的值合适时立即*公开*控件，而不等待焦点改变？我已经做到了——尽管只使用了复选框——而且用户体验非常理想。

# php - 一些基本的 Python 问题

> ID：754468
> 
> 赞同：5
> 
> 时间：2009-04-16T01:41:41.350
> 
> 标签：php, python, unicode, replace, html-entities

我是一个完全的 python 菜鸟，所以请多多包涵。我想让 python 扫描一个 html 页面并用 UTF-8 兼容的东西替换 Microsoft Word 实体的实例。

我的问题是，你如何在 Python 中做到这一点（我已经用谷歌搜索了这个，但到目前为止还没有找到明确的答案）？我想涉足 Python 水域，所以我认为像这样简单的事情是一个很好的起点。看来我需要：

1.  将从 MS Word 粘贴的文本加载到变量中
2.  对内容运行某种替换功能
3.  输出它

在 PHP 中，我会这样做：

```
$test = $_POST['pasted_from_Word']; //for example “Going Mobile”

function defangWord($string) 
{
    $search = array(
        (chr(0xe2) . chr(0x80) . chr(0x98)),
        (chr(0xe2) . chr(0x80) . chr(0x99)),
        (chr(0xe2) . chr(0x80) . chr(0x9c)), 
        (chr(0xe2) . chr(0x80) . chr(0x9d)), 
        (chr(0xe2) . chr(0x80) . chr(0x93)),
        (chr(0xe2) . chr(0x80) . chr(0x94)), 
        (chr(0x2d))
    ); 

    $replace = array(
        "&lsquo;",
        "&rsquo;",
        "&ldquo;",
        "&rdquo;",
        "&ndash;",
        "&mdash;",
        "&ndash;"
    );

    return str_replace($search, $replace, $string); 
} 

echo defangWord($test); 
```

你会如何在 Python 中做到这一点？

编辑：嗯，好吧，暂时忽略我对 UTF-8 和实体的困惑。输入包含从 MS Word 粘贴的文本。弯引号之类的东西显示为奇怪的符号。我曾经尝试修复它的各种 PHP 函数并没有给我想要的结果。通过在十六进制编辑器中查看这些奇怪的符号，我发现它们对应于我上面使用的符号（0xe2、0x80 等）。所以我只是用 HTML 实体替换了奇怪的字符。因此，如果我上面的位已经是 UTF-8，那么从 MS Word 中粘贴了什么会导致奇数符号？

EDIT2：所以我开始学习一些关于 Python 的知识，发现我并不真正了解编码。我试图解决的问题可以简单地通过端到端的一致编码来处理。如果输入形式是 UTF-8，则存储输入的数据库是 UTF-8，输出它的页面是 UTF-8... 从 Word 粘贴可以正常工作。不需要特殊功能。现在，关于学习一点 Python ......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-16T02:10:31.437

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T01:47:24.177

Python 代码具有相同的轮廓。

只需用 Python-isms 替换所有 PHP-isms。

首先创建一个[File](http://docs.python.org/library/stdtypes.html#file-objects)对象。file.read() 的结果是一个[字符串](http://docs.python.org/library/stdtypes.html#string-methods)对象。字符串具有“替换”操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T01:53:12.447

清理 Word HTML 的最佳选择是使用[HTML Tidy](http://tidy.sourceforge.net/)，它有一个专门的模式。如果需要以编程方式执行，可以使用[一些 Python 包装器。](http://pypi.python.org/pypi?%3Aaction=search&term=tidy&submit=search)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T01:54:55.610

正如 S.Lott 所说，Python 代码将非常非常相似——唯一的区别本质上是函数调用/语句。

我认为 Python 没有直接等价于`file_get_contents()`，但由于您可以获得文件中的行数组，因此您可以通过换行符加入它们，如下所示：

```
sample = '\n'.join(open(test, 'r').readlines()) 
```

编辑：没关系，有一个更简单的方法：`sample = file(test).read()`

字符串替换几乎完全一样`str_replace()`：

```
sample = sample.replace(search, replace) 
```

输出就像一个`print`语句一样简单：

```
print defang_word(sample) 
```

如您所见，这两个版本看起来几乎完全相同。

# sql-server - 您可以对插入语句中的列的值进行不同的排序吗？

> ID：754477
> 
> 赞同：0
> 
> 时间：2009-04-16T01:50:04.920
> 
> 标签：sql-server

有没有办法在插入语句中命名或指导您的值？例如。

```
declare @temp TABLE
(
    column1 int,
    column2 int,
    column3 int
)

insert @temp(column1, column2, column3)
Select 1 as column1,3 as column3, 2 as column2

select * from @temp 
```

当我想要 column2 中的 2 和 column3 中的 3 时，将在 column2 中返回 3。

**编辑**

我正在尝试编写一些动态 sql 映射代码。不同的列映射到每个供应商的数据。所以我的计划是编写插入语句来从映射表中获取所有供应商列。但是，我不能确定这些列会以正确的顺序从映射表中出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T01:53:58.777

插入 mytable(col1, col3, col2) 值 (:val1, :val3, :val2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T01:52:50.373

为什么不直接重命名列？也许我错过了什么？

```
INSERT INTO table
(column-1, column-2, ... column-n)
VALUES
(value-1, value-2, ... value-n); 
```

允许您以相同的顺序指定列名和匹配值。

**编辑**出来的列的顺序正是您在 select 子句中指定的顺序。我再次错过了一些非常大的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T02:06:18.670

> 不同的列映射到每个供应商的数据。

为每个供应商编写一个视图，将每个供应商的表格映射到您的通用格式。

从每个视图或视图的联合中插入。

# python - 你如何调试/分离/学习别人的 Python 代码（基于 Web）？

> ID：754481
> 
> 赞同：1
> 
> 时间：2009-04-16T01:53:33.537
> 
> 标签：python, google-app-engine

一个很好的例子是：http: [//github.com/tav/tweetapp/blob/a711404f2935c3689457c61e073105c1756b62af/app/root.py](http://github.com/tav/tweetapp/blob/a711404f2935c3689457c61e073105c1756b62af/app/root.py)

在我来自的 Visual Studio (ASP.net C#) 中，这些类通常被拆分为单独的文件 + 我可以设置断点来理解代码级别。

如果我运行这样的程序，我是否只需执行“system.out”来打印出我在代码中的位置？

我通读了这个[https://stackoverflow.com/questions/246546/good-techniques-for-understanding-someone-elses-code](https://stackoverflow.com/questions/246546/good-techniques-for-understanding-someone-elses-code)，这很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T02:10:01.937

您遇到了一个很难理解的非常具体的代码案例。他们这样做可能是为了方便将所有代码放在一个文件中。

我建议让 epydoc 通过它。它将创建程序的 HTML 文档。这将向您展示类结构，您甚至可以构建图表，说明哪些函数调用了哪些其他函数。

[http://epydoc.sourceforge.net/manual-usage.html](http://epydoc.sourceforge.net/manual-usage.html)

您的其他选择是自己将其分解为多个文件（我认为这会很乏味而且没有多大好处）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T08:28:09.283

如果你安装了[Eclipse](http://www.eclipse.org)和[PyDev](http://pydev.sourceforge.net/)，你可以像在 Visual Studio 中一样设置断点。

如果做不到这一点，在关键点打印信息通常是了解正在发生的事情的好方法。我经常以这种方式添加调试信息并将其保留在代码中，但在更改变量之前将其禁用。如果您破坏代码并需要返回并重新查看发生了什么，我发现这通常会有所帮助。更好的是，将您的调试信息发送到日志记录类，然后您就可以开始在单元测试中使用输出了……您确实测试了您的代码，对吗？;)

# c# - C# Process 类将输出重定向到视频文件

> ID：754485
> 
> 赞同：1
> 
> 时间：2009-04-16T01:55:15.513
> 
> 标签：c#, .net, process

我编写了一个小 GUI 包装器，它将使用 Process 类执行 openRTSP。我遇到的问题是将输出重定向到 mpeg4 视频文件。我通过在命令行上运行 openRTSP 验证了我传递的参数是否正确。

openRTSP.exe -some -parameters -for -video -4 rtsp://video.from.server > video.mp4

"> video.mp4" 是我无法重现的内容。

我查看了使用 Process 类的其他示例，但它们似乎仅适用于 ASCII 文本。

编辑---这里有更多细节

```
this.outputStream = new StreamWriter(fileNameToUse, false, Encoding.Default);

try
{
    byte[] buffer;

    // Start the process with the info we specified.
    // Call WaitForExit and then the using statement will close.
    using (Process exeProcess = new Process())
    {
        // Assign start info to the process
        exeProcess.StartInfo = startInfo;

        // Set up the event handler to call back with each line of output
        exeProcess.OutputDataReceived += new DataReceivedEventHandler(OnDataReceived);

        // Start the Process
        exeProcess.Start();

        exeProcess.BeginOutputReadLine();
        exeProcess.WaitForExit();
    }
}
catch (Exception ex) { PrintException(ex); }
finally
{
    this.outputStream.Flush();
    this.outputStream.Close();
}

// Called asynchronously with a line of data
private void OnDataReceived(object Sender, DataReceivedEventArgs e)
{
    lock (this)
    {
        if (!string.IsNullOrEmpty(e.Data) && (this.outputStream != null))
            this.outputStream.WriteLine(e.Data);
    }
} 
```

当使用 WriteLine 写入接收到的数据时，当我的应用程序退出时，文件大小与我从命令行运行 openRTSP 时产生“正确”输出时的文件大小相同，即可播放的 mpeg4 视频。从命令行运行时，openRTSP 正在输出一个 mpeg4 文件，我将其重定向到一个 mpeg4。

我尝试将“> fileNameToUse”添加到分配给 startInfo.Arguments 的字符串的末尾，但这使得 openRTSP 立即失败。

谢谢，马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T09:33:31.510

以下是我在自己的代码中执行类似操作的示例，需要将流复制为字节才能获得有效输出：

```
 public void Example() {
       //Prepare the Process
       ProcessStartInfo start = new ProcessStartInfo();
       if (!_graphvizdir.Equals(String.Empty)) {
           start.FileName = this._graphvizdir + "dot.exe";
       } else {
           start.FileName = "dot.exe";
       }
       start.Arguments = "-T" + this._format;
       start.UseShellExecute = false;
       start.RedirectStandardInput = true;
       start.RedirectStandardOutput = true;

       //Prepare the GraphVizWriter and Streams
       GraphVizWriter gvzwriter = new GraphVizWriter();
       BinaryWriter output = new BinaryWriter(new FileStream(filename, FileMode.Create));

       //Start the Process
       Process gvz = new Process();
       gvz.StartInfo = start;
       gvz.Start();

       //Write to the Standard Input
       gvzwriter.Save(g, gvz.StandardInput);

       //Read the Standard Output
       StreamCopy(gvz.StandardOutput.BaseStream, output.BaseStream);
       output.Close();

       gvz.Close();
    }

    public void StreamCopy(Stream input, Stream output) {
        int i;
        byte b;

        i = input.ReadByte();

        while (i != -1)
        {
            b = (byte)i;
            output.WriteByte(b);

            i = input.ReadByte();
        }
    } 
```

显然，您可以省略对标准输入位的写入，因为您不需要它。主要是设置 RedirectStandardOutput 然后将输出复制到 BinaryWriter 写入 FileStream 以获得所需的输出文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T02:39:33.707

您可能必须捕获标准输出并将其写入文件，而不是在命令行上传递 > 参数。

Process 类有一个您可以访问的 StandardOutput 流，您应该能够将其转储到文件中。

另一种选择可能是编写一个临时批处理文件并使用 Process.Start() 启动它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-13T21:13:46.497

我有同样的问题并找到了答案（在手册中），所以我想我会分享。

您需要将 -v 添加到您的参数中，这会将数据输出到标准输出，您可以在程序中读取它。

> 提取单个流
> 
> 要仅记录会话中的音频流，请使用“-a”命令行选项。（类似地，要仅记录视频流，请使用“-v”选项。）在这种情况下，输出音频（或视频）流将被写入“stdout”，而不是文件（除非“-P " 选项（见下文）给出）。

这也将是二进制数据，因此获取 Process.OutputStream 的 BaseStream 并使用它。

# math - 无效的算术运算符

> ID：754488
> 
> 赞同：0
> 
> 时间：2009-04-16T01:58:35.180
> 
> 标签：math, cygwin

使用 cygwin 并编写一个脚本来显示我当前的 IP 地址减 2。由于某种原因，它给了我以下错误：“）语法错误：无效的算术运算符（错误标记是”

这是我正在使用的脚本。

```
$ cat test3.sh
#!/bin/bash
#
function IPADDRESS { 
    v=$4
    echo $1.$2.$3.$((v-2)) 
}
ADDRESS=$(ipconfig | grep Address | cut -f2 -d :)
# echo $ADDRESS
IPADDRESS ${ADDRESS//\./ } 
```

任何帮助或建议都可以得到！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T03:18:50.540

实际上，该脚本存在一些问题。主要的一点是 ipconfig 将在行尾输出“\r”字符，这会填满计算。

另一个是您不允许使用多个 NIC，因此是我的`"head -1"`补充。您需要更智能地选择您想要的 NIC。

最后，我去掉了 IP 地址前面的前导空格（实际上是所有空格）。

以下对我有用：

```
#!/bin/bash
#set -x

function IPADDRESS {
    ((v = $4 - 2))
    echo $1.$2.$3.$v
}
ADDRESS=$(ipconfig | grep Address | head -1 | cut -f2 -d: | sed 's/[ \r]//g')
echo $ADDRESS
IPADDRESS $ADDRESS 
```

输出：

```
192.168.91.7
192.168.91.5 
```

实际上，我的版本输出如下：

```
192.168.91.1
192.168.91.-1 
```

所以你需要注意这一点。

我对模拟输出以打动/哄骗管理并不陌生:-)。

**有用的片段：**

`"set -x"`脚本顶部的 （未注释时）是查找此类错误的理想选择。它在所有替换之后但在执行之前输出每一行，以便您可以准确地看到发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T01:07:01.453

我尝试了几种不同的组合。以下对我有用。set -x 真的很有帮助。再次感谢。

```
#!/bin/bash
#set -x
function IPADDRESS {
    v=$4   
echo $1.$2.$3.$((v-2))
}
ADDRESS=$(ipconfig | grep Address | head -1 | cut -f2 -d: | sed 's/[ \r]//g')
IPADDRESS ${ADDRESS//\./} 
```

# mysql - 列出前 5 个（收集最多的）物种

> ID：754490
> 
> 赞同：1
> 
> 时间：2009-04-16T02:01:05.063
> 
> 标签：mysql

列出在 'Karkato' 发现的前 5 个物种（spID、common_name、number_collected）（这是一个 location_name）

给出了下表：

```
物种（spID，属，种，common_name）
Field_location（locID，location_name，纬度，类型）
标本（mID、*spID*、*locID*、日期）
```

主键为粗体 外键为斜体

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T04:24:12.583

```
select distinct species.spID
 ,species.common_name
 ,count(specimen.spID) as number_collected
from species
 ,field_location
 ,specimen
where species.spID = specimen.spID
 and field_location.locID = specimen.locID
 and field_location.location_name = 'Karkato'
order by number_collected desc
limit 5 
```

应该适用于mysql ..

但是当你遗漏了 dbms 我会假设你问这个问题是因为它是你的作业（不要担心 99%~ 的人第一次在 sql 101 中被问到这个问题时惨遭失败）

而且因为我不想进一步扭曲 99%，所以我不会用 sql 回答这个问题。相反，我会给你链接一个[蛋头咖啡馆的答案](http://www.eggheadcafe.com/community/aspnet/13/10017146/select-the-top-n-rows-fro.aspx)。这个人很好地回答了一个类似的问题，您只需要为您的示例重新设计它，并记住您没有像他那样预先计算的计数作为价格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T03:39:12.097

我假设 number_collected 是基于通用名称。但您也可以将样本表加入其中。

对于 MYSQL：

```
select a.spID, a.common_name, count(c.spID) as 'number_collected'
from species a, field_location b, specimen c
where a.spid = c.spid and b.locid = c.locid
and b.location_name = 'Karkato'
group by c.spID
order by number_collected desc
limit 0 , 5 
```

# ruby - 在 Ruby 中读取文件的最后 n 行？

> ID：754494
> 
> 赞同：31
> 
> 时间：2009-04-16T02:06:02.370
> 
> 标签：ruby, file-io

我需要从文件中读取最后 25 行（用于显示最近的日志条目）。Ruby 中是否有从文件末尾开始并向后读取的方法？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-16T02:55:43.093

如果在带有 的 *nix 系统上`tail`，您可以像这样作弊：

```
last_25_lines = `tail -n 25 whatever.txt` 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-04-16T02:19:55.393

文件是否足够大以至于您需要避免阅读整个内容？如果没有，你可以这样做

```
IO.readlines("file.log")[-25..-1] 
```

如果它太大，您可能需要使用[`IO#seek`](http://www.ruby-doc.org/core-1.9/classes/IO.html#M002096)从文件末尾附近读取，并继续从头开始寻找，直到您看到 25 行。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-16T02:20:57.997

Ruby 有一个名为[File::Tail](https://github.com/flori/file-tail)的库。就像 UNIX tail 实用程序一样，这可以获得文件的最后 N 行。

我假设在 UNIX 版本的 tail 中进行了一些搜索优化，具有如下基准（在刚刚超过 11M 的文本文件上测试）：

```
[john@awesome]$du -sh 11M.txt
11M     11M.txt
[john@awesome]$time tail -n 25 11M.txt
/sbin/ypbind
/sbin/arptables
/sbin/arptables-save
/sbin/change_console
/sbin/mount.vmhgfs
/misc
/csait
/csait/course
/.autofsck
/~
/usb
/cdrom
/homebk
/staff
/staff/faculty
/staff/faculty/darlinr
/staff/csadm
/staff/csadm/service_monitor.sh
/staff/csadm/.bash_history
/staff/csadm/mysql5
/staff/csadm/mysql5/MySQL-server-community-5.0.45-0.rhel5.i386.rpm
/staff/csadm/glibc-common-2.3.4-2.39.i386.rpm
/staff/csadm/glibc-2.3.4-2.39.i386.rpm
/staff/csadm/csunixdb.tgz
/staff/csadm/glibc-headers-2.3.4-2.39.i386.rpm

real    0m0.012s
user    0m0.000s
sys     0m0.010s 
```

我只能想象 Ruby 库使用了类似的方法。

**编辑：**

出于Pax的好奇心：

```
[john@awesome]$time cat 11M.txt | tail -n 25
/sbin/ypbind
/sbin/arptables
/sbin/arptables-save
/sbin/change_console
/sbin/mount.vmhgfs
/misc
/csait
/csait/course
/.autofsck
/~
/usb
/cdrom
/homebk
/staff
/staff/faculty
/staff/faculty/darlinr
/staff/csadm
/staff/csadm/service_monitor.sh
/staff/csadm/.bash_history
/staff/csadm/mysql5
/staff/csadm/mysql5/MySQL-server-community-5.0.45-0.rhel5.i386.rpm
/staff/csadm/glibc-common-2.3.4-2.39.i386.rpm
/staff/csadm/glibc-2.3.4-2.39.i386.rpm
/staff/csadm/csunixdb.tgz
/staff/csadm/glibc-headers-2.3.4-2.39.i386.rpm

real    0m0.350s
user    0m0.000s
sys     0m0.130s 
```

仍然不到一秒钟，但如果有很多文件操作，这会产生很大的不同。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-18T23:09:16.467

manveru 出色的基于搜索的解决方案的改进版本。这个返回正好 n 行。

```
class File

  def tail(n)
    buffer = 1024
    idx = [size - buffer, 0].min
    chunks = []
    lines = 0

    begin
      seek(idx)
      chunk = read(buffer)
      lines += chunk.count("\n")
      chunks.unshift chunk
      idx -= buffer
    end while lines < ( n + 1 ) && pos != 0

    tail_of_file = chunks.join('')
    ary = tail_of_file.split(/\n/)
    lines_to_return = ary[ ary.size - n, ary.size - 1 ]

  end
end 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-09-17T10:05:06.187

我刚刚写了一个快速实现`#seek`：

```
class File
  def tail(n)
    buffer = 1024
    idx = (size - buffer).abs
    chunks = []
    lines = 0

    begin
      seek(idx)
      chunk = read(buffer)
      lines += chunk.count("\n")
      chunks.unshift chunk
      idx -= buffer
    end while lines < n && pos != 0

    chunks.join.lines.reverse_each.take(n).reverse.join
  end
end

File.open('rpn-calculator.rb') do |f|
  p f.tail(10)
end 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-01-29T18:31:11.387

这是 tail 的一个版本，它不会在你去的时候在内存中存储任何缓冲区，而是使用“指针”。还会进行边界检查，因此您最终不会寻求负偏移量（例如，如果您有更多要阅读的内容但小于剩余的块大小）。

```
def tail(path, n)
  file = File.open(path, "r")
  buffer_s = 512
  line_count = 0
  file.seek(0, IO::SEEK_END)

  offset = file.pos # we start at the end

  while line_count <= n && offset > 0
    to_read = if (offset - buffer_s) < 0
                offset
              else
                buffer_s
              end

    file.seek(offset-to_read)
    data = file.read(to_read)

    data.reverse.each_char do |c|
      if line_count > n
        offset += 1
        break
      end
      offset -= 1
      if c == "\n"
        line_count += 1
      end
    end
  end

  file.seek(offset)
  data = file.read
end 
```

[https://gist.github.com/shaiguitar/6d926587e98fc8a5e301](https://gist.github.com/shaiguitar/6d926587e98fc8a5e301)上的测试用例

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-16T02:16:31.890

我不能保证 Ruby，但这些语言中的大多数都遵循文件 I/O 的 C 习惯用法。这意味着除了搜索之外别无他法。这通常采用两种方法之一。

*   从文件开头开始扫描，记住最近的 25 行。然后，当您到达文件末尾时，将它们打印出来。
*   一种类似的方法，但试图首先寻找最佳猜测位置。这意味着寻求（例如）文件末尾减去 4000 个字符，然后完全按照您在第一种方法中所做的那样做，但前提是，如果您没有得到 25 行，则必须备份并重试（例如，到文件末尾减去 5000 个字符）。

第二种方式是我更喜欢的方式，因为如果您明智地选择第一个偏移量，您几乎可以肯定只需要一次拍摄。日志文件仍然倾向于具有固定的最大行长度（我认为编码人员仍然倾向于使用 80 列文件，因为它们的实用性已经降低了很长时间）。我倾向于选择所需的行数乘以 132 作为我的偏移量。

粗略浏览一下在线的 Ruby 文档，它看起来*确实*遵循了 C 习语。`"ios.seek(25*-132,IO::SEEK_END)"`如果您遵循我的建议，您会使用，然后从那里继续阅读。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T09:44:24.950

怎么样：

```
file = []
File.open("file.txt").each_line do |line|
  file << line
end

file.reverse.each_with_index do |line, index|
  puts line if index < 25
end 
```

一个大文件的性能会很糟糕，因为它迭代两次，更好的方法是已经提到的读取文件并将最后 25 行存储在内存中并显示它们。但这只是另一种想法。

# c# - 禁用 LinkBut ton 不会禁用 javascript 中的点击事件

> ID：754497
> 
> 赞同：3
> 
> 时间：2009-04-16T02:08:18.337
> 
> 标签：c#, asp.net, javascript

我想禁用`LinkButton`客户端站点上的叮当声。

```
objLinkButton.disabled = true;
// or 
objLinkButton.disabled = -1; 
```

这会禁用链接，但我仍然可以单击链接并执行回发。

有什么办法可以禁用链接。

代码：

```
<asp:linkbutton id="xyz" runat="server"
                onClick="javascript:LinkDisable(this)" ></asp:linkbutton> 
```

它呈现为执行回发的链接...我在新窗口中打开回发页面。我想要做的是..当我第一次点击链接时..它会打开一个新页面，然后它会禁用链接。

我正在做的是..那个链接的onClick我有一个javascript函数..就像这样..

在 LinkDisable ...

```
function LinkDisable(obj)
{
obj.disabled = -1;
obj.href = '#';
//Cant return false from here.. otherwise it wont postback...
} 
```

当我这样做时..链接变灰了...但我仍然可以单击它。我想阻止用户第二次点击它。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-07-16T07:19:32.463

如果要禁用链接按钮，只需使用以下代码。

**标记**

```
<asp:LinkButton ID="lnkButton" Text="Submit" runat="server">
</asp:LinkButton> 
```

**C# 代码**

```
this.lnkButton.Attributes.Add("disabled","disabled"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T02:35:09.163

使用 jQuery，您可以在独立于浏览器的情况下执行此操作，方法是替换 href 或添加一个抢占并停止被跟踪的链接的单击处理程序。

```
$('#objLinkButton').attr('href','#').addClass('disabled-link'); 
```

或者

```
$('#objLinkButton').click( function() { return false; } )
                   .addClass('disabled-link'); 
```

`disabled-link`该类有一些 CSS 来更改链接的外观，使其在视觉上看起来被禁用。

请注意，如果控件位于命名容器（如 GridView 或 UserControl）内，则必须使用 id 上的“结尾为”选择器来引用名称。

```
$('id$="objLinkButton"')... 
```

**编辑**：根据您的更新。试试这个：

```
var code = null;
$(document).ready( function() {
    var button = $('#objLinkButton');
    code = button.attr('href').replace(/javascript:/,''); // save postback function
    button.attr('href','#'); // replace postback function
    button.click( function() {
        $(this).unbind('click'); // get rid of click handler so it only fires once
        if (code) { // if link hasn't been used
            eval(code);  // do post back
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T04:01:26.337

在不使用 jQuery 的情况下禁用链接（并将其呈现为普通文本）的最简单方法是`href`完全删除它的属性。

例如这里是渲染的链接：

```
<a id='link1' href="javascript:disableLink('link1');">Click me</a> 
```

以及所需的 JavaScript：

```
function disableLink(id) {
   document.all[id].removeAttribute('href');
} 
```

这在 IE 和 Firefox 中都适用，但您可能希望进行一些更广泛的测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-18T00:40:03.830

我正在建立**tvanfosson**的答案。他使用 jQuery 的回答效果很好，但是如果你有验证器，它就会把事情搞砸。开始：

```
var code = null;
$(document).ready(function () {
    var button = $('#SubmitPaymentLnkBtn');
    code = button.attr('href').replace(/javascript:/, ''); 
    button.attr('href', '#'); // replace postback function
    button.click(function () {
        if (Page_ClientValidate('PaymentInfo')) {
                           // now only runs if above validationGroup is valid
            $(this).unbind('click'); 
            if (code) {
                $(this).addClass('disabled-btn');
                eval(code);  // do post back
            } 
        }
    });
}); 
```

然后在您的标记中，确保将 ClientIDMode 设置为静态。

```
<asp:LinkButton ID="SubmitPaymentLnkBtn" Text=" submit " runat="server" CssClass="BlackBgText" ValidationGroup="PaymentInfo" Font-Size="22px"  onclick="SubmitPaymentLnkBtn_Click" ClientIDMode="Static" /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T02:25:44.177

这是基于您发布的评论的编辑，以允许在第一次点击时跟随链接按钮，但不是其他方式。

要允许第一次点击链接，但之后不允许点击，请在页面上创建一个变量来跟踪点击。

```
var clicked = 0; 
```

由于链接按钮在前端产生 href，您可以这样做

```
<a href="#" OnClientClick="return false"></a> 
```

OnClientClick 特定于 .NET

如果您只想在某些情况下页面加载后执行此操作：

```
<a href="" id="linkbutton">

var linkbutton = document.getElementById("linkbutton");
linkbutton.onclick = function(){
   if(clicked != 0){
      //if other than 0, not followed
      return false;
   }
   else{
      //link is followed here since it's the first time it's being clicked and clicked value = 0
      clicked = clicked + 1;
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T08:17:02.457

找到解决方案的家伙......这些javascript解决方案将起作用，但如果您刷新页面......它将清除变量。

所以那是一个错误在那里..

使用“userData”找到解决方案... IE 会话数据... 真的很酷。

查看此链接：[http ://www.eggheadcafe.com/articles/20010615.asp](http://www.eggheadcafe.com/articles/20010615.asp)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-19T11:45:59.433

试试这个。最简单的例子

```
<asp:LinkButton ID="LinkButton6" runat="server" disabled="disabled" OnClientClick="return false;"> Test Button</asp:LinkButton> 
```

# php - PHP中多语言支持的最佳系统？

> ID：754499
> 
> 赞同：2
> 
> 时间：2009-04-16T02:09:50.550
> 
> 标签：php, xml, gettext

我有一个想要本地化的 PHP 应用程序。目前，我这样做的方式是一种非常丑陋的方式： $loc['hello'] = "Hello", echo $loc['hello']; 将显示Hello，您可以更改文件以更改语言。我想要的是一种更好的方法和更快的方法，我正在考虑：

*   1个包含所有页面语言数据的XML文件（它会很慢，因为每个页面都会加载整个站点的语言数据）
*   多个文件，每个页面一个 xml 文件（帮助不大，因为它和旧系统一样混乱）
*   gettext() （这似乎是最好的方法，但我今天才发现它，所以从我现在的系统改成这个会很难吗？快吗？）

总而言之，哪种方式最快、最干净、最容易从我目前的方式转移到新的方式。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T02:20:38.120

类似问题：

*   [在 php 中构建“多语言”脚本的最佳方法是什么？](https://stackoverflow.com/questions/457586/what-is-the-best-method-to-build-multilingual-script-in-php)
*   [编写多语言 PHP 应用程序](https://stackoverflow.com/questions/450687/programming-multi-language-php-applications)

这是一个比较 gettext 和字符串数组的基准：[Benchmarking PHP Localization - Gettext 是否足够快？](http://mel.melaxis.com/devblog/2006/04/10/benchmarking-php-localization-is-gettext-fast-enough/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T02:24:41.467

在我看来，像您已经拥有的那样的 PHP 数组非常快速和干净。

本地化本身很难编码和管理更改，所以不要指望有一种方法可以让所有的痛苦消失。

# c# - 在 WinForms ListBox 的每个项目中绘制“子”控件（例如按钮）的最佳方法是什么？

> ID：754502
> 
> 赞同：1
> 
> 时间：2009-04-16T02:10:21.047
> 
> 标签：c#, .net, winforms

我正在编写一个简单的自定义所有者绘制的`ListBox`控件并将我的头撞到墙上试图弄清楚如何实现一个看似直截了当的功能。我的自定义`ListBox`应该与 Windows XP 中的“添加/删除程序”列表类似。也就是说，它像往常一样显示项目列表，但是当用户选择列表中的项目时，项目文本旁边应该会出现一个可点击的按钮。就我而言，我试图在我的`ListBox`.

为了使自定义保持`ListBox`某种程度的封装，我试图通过覆盖`ListBox.OnDrawItem`方法来显示按钮（即按钮在概念上是列表框项的一部分），但我无法让它正常工作。

我应该注意，我正在尝试对整个`ListBox`. 当用户在列表中选择一个项目时，该`OnDrawItem`方法只是重新定位该单个按钮，使其显示在所选项目旁边。我有 99% 的工作：现在的问题是，当`ListBox`滚动并且选定的项目离开屏幕时，按钮仍被绘制到其先前的位置，因此它绘制在错误的项目之上。我猜这是因为如果所选项目不在屏幕上，Windows 不会尝试重绘，因此不会调用重新定位代码。

这是我现在拥有的精简版：

```
public partial class EventListBox : ListBox
{
    private Button _importButton;

    public EventListBox()
    {
        InitializeComponent();
        this.DrawMode = DrawMode.OwnerDrawVariable;

    // set up the button that will appear next to the currently-selected item
        _importButton = new Button();
        _importButton.Text = "Import...";
        _importButton.AutoSize = true;
        _importButton.Visible = false;

    // Add the button as a child control of this ListBox
        Controls.Add(_importButton);
    }

    protected override void OnDrawItem(DrawItemEventArgs e)
    {
        if (this.Items.Count > 0)
        {
            e.DrawBackground();

    // draw item here (omitted)

    // if drawing the selected item, re-position the "Import" button so that appears
    // inside the current item, and make it visible if it is hidden.
    // These checks prevent the resulting repaint that will occur from causing an infinite loop

    // The problem seems to be that if the ListBox is scrolled such that the selected item
    // moves off-screen , this code won't run, because it won't repaint the selected item anymore...
    // This means the button will be painted in its previous position.

    // The real question is: Is there a better way to approach the whole notion of
    // rendering buttons within ListBox items?

            if (e.State & DrawItemState.Selected == DrawItemState.Selected)
            {
                _importButton.Top = e.Bounds.Bottom - _importButton.Height - 20;
                _importButton.Left = e.Bounds.Left;
                if(!_importButton.Visible) _importButton.Visible = true;
            }
        }

        base.OnDrawItem(e);
    }

    protected override void OnMeasureItem(MeasureItemEventArgs e)
    {
        base.OnMeasureItem(e);
        e.ItemHeight = 100; //hard-coded for now...
    }

} 
```

**使用单个按钮的理由**

我宁愿为 中的每个项目创建一个单独的按钮`ListBox`，但我找不到任何方法来跟踪何时从列表框中添加/删除项目。我找不到任何`ListBox`可以覆盖的相关方法，也无法将该属性重新分配给`ListBox.Items`自定义集合对象，因为`ListBox.Items`它是只读的。正因为如此，我采用了上述使用单个按钮并根据需要重新定位它的方法，但正如我所提到的，这不是很健壮并且很容易损坏。

我目前的想法是，在将新项目添加到 时创建一个新按钮并在`ListBox`删除项目时删除按钮是最有意义的。

这是我想出的一些可能的解决方案，但是有更好的方法来实现吗？

*   我可以直接在派生类上创建自己的方法`AddItem`和方法。每次添加新项目时，我都可以创建一个相应的按钮，并在. 然而，对我来说，这是一个丑陋的 hack，因为它迫使我调用这些特殊的添加/删除方法，而不仅仅是使用.`RemoveItem``ListBox``RemoveItem``ListBox.Items`
*   `OnDrawItem`我可以在using中手动绘制一个新按钮`System.Windows.Forms.ButtonRenderer`，但是我必须做很多额外的工作才能让它像一个真正的按钮一样，因为`ButtonRenderer`它只是在绘制按钮。弄清楚用户何时将鼠标悬停在此“按钮”上，以及何时单击它，似乎很难做到正确。
*   当`OnDrawItem`被调用时，如果正在绘制的项目还没有与之关联的按钮，我可以创建一个新按钮（我可以用 a 跟踪它`Dictionary<Item, Button>`），但我仍然需要一种方法来删除未使用的按钮，当它们对应的项目从列表中删除。我想我可以迭代我的项目按钮映射字典并删除不再存在的项目`ListBox`，但是每次`ListBox`重绘中的项目时我都会迭代两个列表（ack！）。

那么，有没有更好的方法在 a 中包含可点击按钮`ListBox`？这显然以前做过，但我在谷歌上找不到任何有用的东西。我见过的唯一在 a 中有按钮的`ListBox`示例是 WPF 示例，但我正在寻找如何使用 WinForms 执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T04:21:26.333

**一种可能的解决方案**

我找到了一个可行的解决方案，并最终暂时保留了单按钮方法。我将在这里发布我的解决方法，但如果有人对我的原始问题有更优雅的答案，请不要犹豫发布它。

*我的小顿悟*

在尝试了更多之后，似乎只有在使用鼠标滚轮滚动浏览`ListBox`. 以“正常”方式滚动似乎不会重现该行为，但由于我不能 100% 确定，因此我也在我的解决方法中包含了正常滚动的修复程序。

*我丑陋的解决方法*

因为我知道鼠标滚轮（以及一般的滚动）似乎是问题的核心，所以我决定在滚动或移动鼠标滚轮时`ListBox`使我的鼠标滚轮无效。`ListBox`这确实会产生一些难看的闪烁，我想摆脱它，但我现在可以接受结果。

我在派生`EventListBox`类中添加了以下方法：

```
 protected override void WndProc(ref Message m)
    {
        const int WM_VSCROLL = 277;

        if (m.Msg == WM_VSCROLL)
        {
            this.Invalidate();
        }

        base.WndProc(ref m);
    }

    protected override void OnMouseWheel(MouseEventArgs e)
    {
        this.Invalidate();
        base.OnMouseWheel(e);
    } 
```

我有点惊讶，`ListBox`它没有继承`ScrollableControl`，也没有任何`OnScroll`可以覆盖的方法，所以我通过覆盖该`WndProc`方法进行了滚动检查。鼠标滚轮检测更简单，因为已经有一种方法可以覆盖。

就像我说的那样，这不太理想，因为每次滚动列表时使列表框无效会导致闪烁，并且我怀疑当列表框包含很多项目时性能会显着降低。

我还不会接受这个答案，因为我很想知道是否有人有更好的解决方案。

# mysql - MySQL：如何找出哪些表引用了特定表？

> ID：754512
> 
> 赞同：44
> 
> 时间：2009-04-16T02:19:58.170
> 
> 标签：mysql, foreign-keys

我想删除一个表，但它被一个或多个其他表引用。如何找出哪些表正在引用该表，而不必一一查看数据库中的每个表？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-04-16T02:58:12.960

```
SELECT TABLE_NAME
FROM information_schema.KEY_COLUMN_USAGE
WHERE TABLE_SCHEMA = 'your_schema_name'
      AND REFERENCED_TABLE_NAME = 'your_table_name'; 
```

这行得通。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-16T02:38:25.193

```
select table_name 
from information_schema.referential_constraints 
where referenced_table_name = 'parent table here'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-29T23:01:32.533

如果您安装了[phpMyAdmin](https://www.phpmyadmin.net/)，则可以使用其[设计器功能](https://docs.phpmyadmin.net/en/latest/relations.html#designer)来可视化表关系。

[![在此处输入图像描述](https://i.stack.imgur.com/ree0g.png)](https://i.stack.imgur.com/ree0g.png)

要使用设计器，请选择一个数据库，然后查找“**设计器**”选项卡。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-16T02:21:52.550

使用 Toad 加载它，您可以通过图表查看参考。还要确保您没有任何应用程序代码从前端传递 sql，删除表可能会导致应用程序中断。

下载链接 [http://www.toadsoft.com/toadmysql/FreewareDownload.htm](http://www.toadsoft.com/toadmysql/FreewareDownload.htm)

如果您使用的是innoDB，请尝试从您的数据库名称中显示表状态，例如“T” [http://dev.mysql.com/doc/refman/5.1/en/show-table-status.html](http://dev.mysql.com/doc/refman/5.1/en/show-table-status.html)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-16T02:58:26.550

查看 iformation_schema 模式中的 KEY_COLUMN_USAGE 表。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-16T03:04:19.343

从 mysql 命令行：显示表状态

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-01-12T09:56:11.073

你可以试试 MySql 工作台，它可以让你提取 ER 图。在这里，您可以找到有关数据库表的所有信息。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-09-21T05:29:03.340

如果您还想要引用的特定列，请使用以下查询。

```
SELECT 
ku.CONSTRAINT_NAME AS "Foreign key",
CONCAT("`", ku.TABLE_SCHEMA, "`.`", ku.TABLE_NAME, "`") AS "In",
GROUP_CONCAT(ku.COLUMN_NAME) AS "Source column",
CONCAT("`", ku.REFERENCED_TABLE_SCHEMA, "`.`", ku.REFERENCED_TABLE_NAME, "`") AS 
"References",
GROUP_CONCAT(ku.REFERENCED_COLUMN_NAME) AS "Target column"
FROM information_schema.KEY_COLUMN_USAGE AS ku
WHERE ku.REFERENCED_TABLE_SCHEMA = '[THE_CURRENT_SELECTED_SCHEMA_NAME]'
AND ku.REFERENCED_TABLE_NAME = '[THE_CURRENT_SELECTED_TABLE_NAME]'
GROUP BY ku.CONSTRAINT_NAME
HAVING `In` != `References` 
```

[![在此处输入图像描述](https://i.stack.imgur.com/1z5ZU.png)](https://i.stack.imgur.com/1z5ZU.png)

# html - DiggBar 如何根据不在其域上的内容动态调整其 iframe 的高度？

> ID：754519
> 
> 赞同：6
> 
> 时间：2009-04-16T02:23:14.793
> 
> 标签：html, iframe, digg

已经有人问了，[DiggBar 是如何工作的？](https://stackoverflow.com/questions/736730/how-does-the-diggbar-work)在上一个问题中。

虽然有人提供了一个不错的答案，但它并没有解决一件事：

> Digg 如何根据跨不同域的网站内容动态调整 iframe 的高度？

**只要框架 url 在您自己的域中，**这里有很多问题和答案，用于根据内容（使用 javascript）动态调整 iframe 高度。 然而，Digg 似乎已经解决了任何域网站的这个问题。

是否有任何 SO web 程序员知道他们是如何做到这一点的？

注意：iframe 不是简单地设置为 100% 高度。iframe 标记根本不能那样工作。谷歌“100% 高度 iframe”，你会明白我的意思。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-16T02:45:07.533

如果您查看[他们的 CSS](http://media.digg.com/App_PermaFrame/media/css/186/permaframe.css)，他们会`height: 100%`使用`iframe`：

```
iframe#diggiFrame {
    color: #666;
    width: 100%;
    height: 100%;
    z-index: 10;
    -webkit-box-sizing: border-box;    
} 
```

他们将 DiggBar 放置在其上方，高度为`46px`，因此`iframe`100% 占用了剩余空间。它们`overflow: hidden`在`body`元素上使用以`iframe`完全保持在页面的垂直高度内，而不是允许页面滚动。这意味着滚动条将出现在 中`iframe`，而不是整个页面。请注意，DiggBar 的工作方式仅适用于 Firefox 的 quirks 模式；有关如何在标准模式下执行此操作，请参见下文。

```
body {
    padding: 46px 0 0 0;
    margin: 0;
    background: #fff;
    overflow: hidden; 
    color: #333;
    text-align: left;
}

#t {
    width: 100%;
    min-width: 950px;
    height: 46px;
    z-index: 100;
    position: absolute;
    top: 0;
    left: 0;
    /* overflow: hidden; */
    border-bottom: 1px solid #666;
    background: #fff url(/App_PermaFrame/media/img/back.gif) repeat-x;
    line-height: 1;
} 
```

**编辑**：对于那些不相信我的人，这是一个[小例子](http://ephemera.continuation.org/stackoverflow/iframe.html)。要让它填满整个空间，您需要将其设置为没有边框，并且您需要`<body>`没有边距。

**编辑2**：啊，对不起，我明白你在说什么。您需要标签`overflow: hidden`上的`body`才能让滚动条以您想要的方式工作。

**编辑 3**：看起来你必须处于怪癖模式才能在 Firefox 中工作；如果您包含一个`<!DOCTYPE html>`声明，这会使您进入标准模式，并且您的`iframe`输出太小。

**编辑 4**：啊，您也可以在 Firefox 的标准模式下执行此操作。[在这里](http://www.justin-cook.com/wp/2007/02/19/how-to-set-an-iframe-to-100-height-in-firefox/)得到了答案。您还需要将`<html>`和`<body>`元素的高度设置`100%`为。（请注意，这`<!DOCTYPE html>`是[HTML 5](http://www.w3.org/TR/html5/)的文档类型，这是一项正在进行的工作；但是，它适用于所有现代浏览器以打开标准模式）。

```
<!DOCTYPE html>
<html>
<head>
  <style type="text/css" media="all">
    html, body {
      height: 100%
    }
    body {
      margin: 0;
      overflow: hidden;
    }
    #topbar {
      height: 50px;
      width: 100%;
      border-bottom: 1px solid #666
    }
    #iframe {
      height: 100%;
      width: 100%;
      border-width: 0
    }
  </style>
</head>
<body>
  <div id="topbar">
    <h1>This is my fake DiggBar</h1>
  </div>
  <iframe id="iframe" src="http://www.google.com/"></iframe>
</body> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T02:55:22.547

HTML 的部分问题是，您不能只将任何元素的高度设置为 100% 并让它占据整个窗口空间。一种方法是使主体具有窗口的像素高度，并且主体内设置为 100% 的任何东西都将是窗口的大小。

基本上只需制作一个与 windows onresize 事件相关联的 JavaScript 并将其调整主体的大小以适应窗口的大小。

这是我使用 jQuery 制作的示例

```
<script language="JavaScript" type="text/JavaScript">
    $(window).resize(function() {
        $('body').height(document.documentElement.clientHeight);
    });
</script> 
```

有了这个，您将能够设置一个 div 或其他元素，并让它在窗口的整个高度上工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-02T01:36:50.520

iframe 在 quirks 模式下可以有 100% 的高度。Digg 通过省略 doctype 来实现这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T02:29:16.447

iFrame 位于 Digg 网站上，其中包含目标网站，而不是相反。iFrame 设置为 100% 的宽度和高度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-14T23:20:56.387

iframe 中的 100% 是声明的父空间的 100%。一个例子是：

```
/* parent element */

html, body {
   width: 100%;
   height: 100%;
}

/* child element */
iframe {
  width: 100%; /* this is truly 100%, try it out */
  height: 100%; /* try it out */ 
```

# localization - I18n/L10n/G11n 之间的实际区别是什么，具体而言，它们对发展意味着什么？

> ID：754520
> 
> 赞同：71
> 
> 时间：2009-04-16T02:23:20.253
> 
> 标签：localization, internationalization, globalization

> **可能重复：**
> [本地化和国际化，有什么区别？](https://stackoverflow.com/questions/506743/localization-and-internationalization-whats-the-difference)

I18n/L10n/G11n 对我来说都等同于本地化，但人们一直在区分这些，尤其是在企业和营销方面，但我看不出这三个任务从程序员的角度来看是不是一回事，每一项背后都有特殊要求吗？在不涉及全球市场的情况下，一些诚实的程序员对程序员对这些术语的解释是什么，换句话说，当翻译成开发（编码）软件时，这三个术语背后的本质区别是什么？

谢谢！

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-04-16T02:45:34.723

这是 W3C 的一篇文章：[本地化与国际化](http://www.w3.org/International/questions/qa-i18n)

他们的简短回答似乎是：

> 本地化是指**调整** 产品、应用程序或文档内容以满足特定目标市场（“区域设置”）的语言、文化和其他要求。
> 
> 国际化是产品、应用程序或文档内容的设计和开发，**可以**为不同文化、地区或语言的目标受众轻松本地化。

因此，国际化似乎使产品能够本地化到特定市场。根据 W3C，全球化是国际化的另一个术语。

就个人而言，我主要可以互换使用它们，但请查看文章以更详细地了解它们的含义。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-04-16T02:54:40.303

I18n - 国际化 - 提供某种框架，以便您可以轻松交换字符串、图形、声音和其他资源，并通常处理不同的通信约定。

L10n - 本地化 - 创建一堆字符串、图形、声音等的过程，以便您可以针对特定的国籍、语言或地区。

G11n - 全球化 - 同时进行国际化和本地化步骤 :)

有许多方法和框架支持这些过程的“字符串”部分，它们通常涉及使用 unicode。其他部分通常通过创建包含一堆图形和声音的资源文件来处理。根据您使用的框架，字符串也可能存储在这里。我发现[Qt](http://qt.nokia.com/)有一个出色的系统来处理 I18n 的字符串。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-04-20T17:24:08.913

想想麦当劳吧（请耐心等待）。

麦当劳是*国际化*的，因为它**可以**本地化。除非您将公司扩大到制作所有国家的国旗，否则您无法轻松地本地化一家美国国旗商店。

麦当劳是*本地化*的，因为当你去日本的麦当劳时，那里的食物与美国的食物截然不同。也都是日文写的。**这意味着他们已经根据日本的语言和**文化调整了产品。

* * *

对我来说，本地化是指为不同文化制作特定产品。例如：[www.google.com](http://www.google.com)和[www.google.co.nz](http://www.google.co.nz)。他们都是谷歌。一种适用于美国（或通用），一种适用于新西兰。它们都是英文的……但它们都本地化为各自观众的**文化。**

那有意义吗？

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-04-16T02:57:37.860

我不知道“G”那个，但对我来说：

*   I18n 表示可以做
*   L10n 表示已经完成

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-01-03T18:28:28.163

i18n 主要是软件工程工作；你必须处理代码。最简单的概念是将硬编码字符串从源代码中移出，以减少翻译用户看到的字符串和将它们作为资源文件或数据库值或其他任何内容之间的交互，具体取决于您选择的 i18n 框架。在 i18n 中，您处理逻辑、UI、数据库、从左到右的脚本等，以便获得与语言环境（语言/国家/地区）特性相当正交的代码库。您可能有策略来处理特定于某个国家/地区的业务逻辑（即税收）。您可能会处理格式化简单项目，如日期/时间、货币等，也可能是复杂项目（地址、英制日历），这可能需要在数据库、逻辑、UI 等方面进行一些设计。有点取决于您的目标语言环境。

L10n 应该是之后进来的，不是软件工程师的工作。在大多数情况下，“本地化”公司和翻译人员负责这部分工作。

i18n 和 L10n 都是 G11n 战略的必要组成部分。规划、质量保证等需要考虑到双方，因为从一个世界到另一个世界存在整合问题。

希望有帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-16T02:29:52.827

虽然我不会尝试回答您关于对编码的影响的问题，但由于缺乏该领域的经验，我认为您会发现以下 Wikipedia 文章在区分这 3 个术语时有所帮助。

[http://en.wikipedia.org/wiki/I18n](http://en.wikipedia.org/wiki/I18n)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-09-16T18:24:54.857

我有一个国际化的产品。没有进行翻译，但字符串都是外部化的，所以如果我们希望为特定国家/地区提供本地化产品，我们可以翻译文件，对产品进行测试，然后将其运送到该国家/地区本地使用。

目前完全国际化的产品都是英文的，但编码已经完成。如果有人试图检查不正确的代码，审阅者可以正确地拒绝它，理由是它没有国际化，并且会导致产品无法完全本地化。

但是由于没有进行任何测试，所以它还没有完全国际化......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-09-26T06:11:50.313

根据我的实际经验：

I18N：假设您的操作系统是英文（美国），您只需将操作系统语言更改为日文/中文，即可安装支持日文/中文的应用程序。

L10N：您的操作系统必须与应用程序处于相同的语言环境中。例如，在日语操作系统上，您可以安装支持日语的应用程序。这里所有的东西都将在同一个地方。

G11N：它是 IBM/Sun Microsystem 给出的命名转换。它根据所有设置的类型涵盖 I18N 和 L10N。

如果我错了，请纠正我。

谢谢维卡斯

# c++ - C++ 使用标头定义的模板类乘以定义的符号

> ID：754521
> 
> 赞同：5
> 
> 时间：2009-04-16T02:23:33.590
> 
> 标签：c++, templates, visual-studio-2005

我正在 Visual Studio 2005 中使用 DLL 和 EXE 开发一个项目。DLL 的代码中有一个可增长数组类的模板：

```
template <class Type>
class GArray
{
    Type *p;
    uint32 len;
    uint32 alloc;

protected:
    bool fixed;

public:
    /// Constructor
    GArray(int PreAlloc = 0)
    {
        p = 0;
        len = 0;
        fixed = false;

        alloc = PreAlloc;
        if (alloc)
        {
            int Bytes = sizeof(Type) * alloc;
            p = (Type*) malloc(Bytes);
            if (p)
            {
                memset(p, 0, Bytes);
            }
            else
            {
                alloc = 0;
            }
        }
    }

    /// Destructor  
    ~GArray()
    {
        Length(0);
    }   

    /// Returns the number of used entries
    uint32 Length() const
    {
        return len;
    }

    /// Sets the length of available entries
    bool Length(uint32 i)
    {
        if (i > 0)
        {
            if (i > len && fixed)
                return false;

            uint nalloc = alloc;
            if (i < len)
            {
                // Shrinking
            }
            else
            {
                // Expanding
                int b;
                for (b = 4; (1 << b) < i; b++)
                    ;
                nalloc = 1 << b;
                LgiAssert(nalloc >= i);
            }

            if (nalloc != alloc)
            {
                Type *np = (Type*)malloc(sizeof(Type) * nalloc);
                if (!np)
                {
                    return false;
                }

                if (p)
                {
                    // copy across common elements
                    memcpy(np, p, min(len, i) * sizeof(Type));
                    free(p);
                }
                p = np;
                alloc = nalloc;
            }

            if (i > len)
            {
                // zero new elements
                memset(p + len, 0, sizeof(Type) * (i - len));
            }

            len = i;
        }
        else
        {
            if (p)
            {
                int Length = len;
                for (uint i=0; i<Length; i++)
                {
                    p[i].~Type();
                }
                free(p);
                p = 0;
            }
            len = alloc = 0;
        }

        return true;
    }

    GArray<Type> &operator =(const GArray<Type> &a)
    {
        Length(a.Length());
        if (p && a.p)
        {
            for (int i=0; i<len; i++)
            {
                p[i] = a.p[i];
            }
        }
        return *this;
    }

    /// \brief Returns a reference a given entry.
    ///
    /// If the entry is off the end of the array and "fixed" is false,
    /// it will grow to make it valid.
    Type &operator [](uint32 i)
    {
        static Type t;
        if
        (
            i < 0
            ||
            (fixed && i >= len)
        )
        {
            ZeroObj(t);
            return t;
        }

        #if 0
        if (i > 15000000)
        {
            #if defined(_DEBUG) && defined(_MSC_VER)
            LgiAssert(0);
            #endif

            ZeroObj(t);
            return t;
        }
        #endif

        if (i >= alloc)
        {
            // increase array length
            uint nalloc = max(alloc, GARRAY_MIN_SIZE);
            while (nalloc <= i)
            {
                nalloc <<= 1;
            }

            // alloc new array
            Type *np = (Type*) malloc(sizeof(Type) * nalloc);
            if (np)
            {
                // clear new cells
                memset(np + len, 0, (nalloc - len) * sizeof(Type));
                if (p)
                {
                    // copy across old cells
                    memcpy(np, p, len * sizeof(Type));

                    // clear old array
                    free(p);
                }

                // new values
                p = np;
                alloc = nalloc;
            }
            else
            {
                static Type *t = 0;
                return *t;
            }
        }

        // adjust length of the the array
        if (i + 1 > len)
        {
            len = i + 1;
        }

        return p[i];
    }

    /// Delete all the entries as if they are pointers to objects
    void DeleteObjects()
    {
        for (uint i=0; i<len; i++)
        {
            DeleteObj(p[i]);
        }
        Length(0);
    }

    /// Delete all the entries as if they are pointers to arrays
    void DeleteArrays()
    {
        for (int i=0; i<len; i++)
        {
            DeleteArray(p[i]);
        }
        Length(0);
    }

    /// Find the index of entry 'n'
    int IndexOf(Type n)
    {
        for (uint i=0; i<len; i++)
        {
            if (p[i] == n) return i;
        }

        return -1;
    }

    /// Returns true if the item 'n' is in the array
    bool HasItem(Type n)
    {
        return IndexOf(n) >= 0;
    }

    /// Deletes an entry
    bool DeleteAt
    (
        /// The index of the entry to delete
        uint Index,
        /// true if the order of the array matters, otherwise false.
        bool Ordered = false
    )
    {
        if (p && Index >= 0 && Index < len)
        {
            // Delete the object
            p[Index].~Type();

            // Move the memory up
            if (Index < len - 1)
            {
                if (Ordered)
                {
                    memmove(p + Index, p + Index + 1, (len - Index - 1) * sizeof(Type) );
                }
                else
                {
                    p[Index] = p[len-1];
                }
            }

            // Adjust length
            len--;
            return true;
        }

        return false;
    }

    /// Deletes the entry 'n'
    bool Delete
    (
        /// The value of the entry to delete
        Type n,
        /// true if the order of the array matters, otherwise false.
        bool Ordered = false
    )
    {
        int i = IndexOf(n);
        if (p && i >= 0)
        {
            return DeleteAt(i, Ordered);
        }

        return false;
    }

    /// Appends an element
    void Add
    (
        /// Item to insert
        const Type &n
    )
    {
        (*this)[len] = n;
    }

    /// Appends multiple elements
    void Add
    (
        /// Items to insert
        Type *s,
        /// Length of array
        int count

    )
    {
        if (!s || count < 1)
            return;

        int i = len;
        Length(len + count);
        Type *d = p + i;
        while (count--)
        {
            *d++ = *s++;
        }
    }

    /// Inserts an element into the array
    bool AddAt
    (
        /// Item to insert before
        int Index,
        /// Item to insert
        Type n
    )
    {
        // Make room
        if (Length(len + 1))
        {
            if (Index < len - 1)
            {
                // Shift elements after insert point up one
                memmove(p + Index + 1, p + Index, (len - Index - 1) * sizeof(Type) );
            }
            else if (Index >= len)
            {
                // Add at the end, not after the end...
                Index = len - 1;
            }

            // Insert item
            p[Index] = n;

            return true;
        }

        return false;
    }

    /// Sorts the array
    void Sort(int (*Compare)(Type*, Type*))
    {
        typedef int (*qsort_compare)(const void *, const void *);
        qsort(p, len, sizeof(Type), (qsort_compare)Compare);
    }

    /// \returns a reference to a new object on the end of the array
    Type &New()
    {
        return (*this)[len];
    }

    /// Returns the memory held by the array and sets itself to empty
    Type *Release()
    {
        Type *Ptr = p;
        p = 0;
        len = alloc = 0;
        return Ptr;
    }
}; 
```

我在几个地方都在 EXE 中重用了这段代码。但是，当我在一个特定文件中使用它时，我开始收到重复的符号链接错误：

```
2>lgi8d.lib(Lgi8d.dll) : error LNK2005: "public: int __thiscall GArray<char *>::Length(void)" (?Length@?$GArray@PAD@@QAEHXZ) already defined in FrameStore.obj
2>D:\Home\matthew\network_camera\src\vod_test\Debug\vod_test.exe : fatal error LNK1169: one or more multiply defined symbols found 
```

我在 EXE 的其他文件中使用了相同的类，没有错误。例如在 Camera.cpp 我有：

```
void DeleteFromArray(GArray<char> &a, int Start, int Len)
{
    assert(Len >= 0);

    int64 StartTs = LgiCurrentTime();

    int Del = min(Len, a.Length() - Start);
    if (Del > 0)
    {
        int Remain = a.Length() - Start - Del;
        if (Remain > 0)
        {
            memmove(&a[Start], &a[Start+Del], Remain);
            MoveBytes += Remain;
            a.Length(Start+Remain);
        }
        else a.Length(Start);
    }

    int64 End = LgiCurrentTime();
    DeleteTime += End - StartTs;
} 
```

可以编译和链接...但是在 FrameStore.cpp 中：

```
void Scan()
{
    if (!Init)
    {
        Init = true;
        GAutoString Path = FrameFile::GetPath();
        GAutoPtr<GDirectory> Dir(FileDev->GetDir());
        GArray<char*> k;

        int64 Size = 0;
        for (bool b = Dir->First(Path); b; b = Dir->Next())
        {
            if (!Dir->IsDir())
            {
                char *e = LgiGetExtension(Dir->GetName());
                if (e && !stricmp(e, "mjv"))
                {
                    char p[MAX_PATH];
                    Dir->Path(p, sizeof(p));
                    k.Add(NewStr(p));
                    Size += Dir->GetSize();
                }
            }
        }

        GAutoPtr<Prog> p(new Prog(Size));
        for (int i=0; i<k.Length(); i++)
        {
            Files.Add(new FrameFile(k[i], p));
        }

        k.DeleteArrays();
    }
} 
```

导致其中包含“k.Length（）”的行出现链接错误......如果我注释掉它链接！然而，我在同一代码中使用 GArray 类中的其他方法，它们不会引起问题。

为什么完全在标头中定义的模板类首先会遇到这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T00:17:18.263

问题：

Lgi.dll 中定义了另一个导出 GArray 实例化的类。

```
#ifdef LGI_DLL
    #define LgiClass        __declspec(dllexport)
#else
    #define LgiClass        __declspec(dllimport)
#endif

class LgiClass GToken : public GArray<char*>
{
    /// stuff...
}; 
```

解决方案：

在我的 EXE 中包含该 GToken 标头，特别是使用 GArray 实现的 FrameStore.cpp 文件，然后编译将从 DLL 导入这些符号而不是复制它们。

如果编译器能给我更多关于 DLL 在哪里定义符号的提示，那就太好了。简单地说“某处有重复”并不是很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T03:40:11.503

如果您使用的是 Visual Studio 6，请确保设置了以下选项：

项目->设置->C/C++->代码生成->使用运行时库===>调试多线程/多线程

编辑：在 VS 2005 中基本相同。

项目->属性->配置属性->C/C++->代码生成->运行时库->多线程/多线程调试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T03:52:55.730

作为旁注，您可能希望拆分声明和定义，因此它并不那么难看：

```
template <class Type>
class GArray
{
    Type *p;
    uint32 len;
    uint32 alloc;

protected:
    bool fixed;

public:
    GArray(int PreAlloc = 0);

    /// Destructor  
    ~GArray() {Length(0);}       

    /// Returns the number of used entries
    int Length() {return len;}

    /// Sets the length of available entries
    bool Length(uint32 i);

    // etc...
};

template <class Type>
GArray<Type>::GArray(int PreAlloc = 0)
{
    p = 0;
    len = 0;
    fixed = false;

    alloc = PreAlloc;
    if (alloc)
    {
        int Bytes = sizeof(Type) * alloc;
        p = (Type*) malloc(Bytes);
        if (p)
        {
            memset(p, 0, Bytes);
        }
        else
        {
            alloc = 0;
        }
    }
}

template <class Type>
bool GArray<Type>::Length(uint32 i);
{
    if (i > 0)
    {
        if (i > len && fixed)
            return false;

        uint nalloc = alloc;
        if (i < len)
        {
            // Shrinking
        }
        else
        {
            // Expanding
            int b;
            for (b = 4; (1 << b) < i; b++)
                ;
            nalloc = 1 << b;
            LgiAssert(nalloc >= i);
        }

        if (nalloc != alloc)
        {
            Type *np = (Type*)malloc(sizeof(Type) * nalloc);
            if (!np)
            {
                return false;
            }

            if (p)
            {
                // copy across common elements
                memcpy(np, p, min(len, i) * sizeof(Type));
                free(p);
            }
            p = np;
            alloc = nalloc;
        }

        if (i > len)
        {
            // zero new elements
            memset(p + len, 0, sizeof(Type) * (i - len));
        }

        len = i;
    }
    else
    {
        if (p)
        {
            int Length = len;
            for (uint i=0; i<Length; i++)
            {
                p[i].~Type();
            }
            free(p);
            p = 0;
        }
        len = alloc = 0;
    }

    return true;
} 
```

// 你明白了

另外，`operator=`应该取a`const GArray<Type>&`来表示右手边没有变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T05:02:40.447

```
2>lgi8d.lib(Lgi8d.dll) : error LNK2005: "public: int __thiscall GArray<char *>::Length(void)" (?Length@?$GArray@PAD@@QAEHXZ) already defined in FrameStore.obj
2>D:\Home\matthew\network_camera\src\vod_test\Debug\vod_test.exe : fatal error LNK1169: one or more multiply defined symbols found 
```

`lgi8d.lib`并且`vod_test.exe`是两个独立的二进制文件。问题可能在于`.lib`已经定义了 .exe 再次定义的符号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T07:32:47.793

您可以尝试将 declspec(dllexport) 添加到 DLL 中的类和 EXE 中的 declspec(dllimport)。例如

```
#if !defined(MYDLLEXPORT)
    // We are users of, and *importing* the library routines...
    #define MYLIB_SPEC __declspec(dllimport)
#else
    // We are building and exporting the library routines...
    #define MYLIB_SPEC __declspec(dllexport)
#endif

// ...

template<typename Type>
class MYLIB_SPEC GArray // ... 
```

然后确保在构建 DLL 的项目中定义了 MYDLLEXPORT，并且没有为 EXE 定义。

AFAIK 你通常不需要这个模板。

有关 declspec 的更多信息在这里：http: [//msdn.microsoft.com/en-us/library/a90k134d](http://msdn.microsoft.com/en-us/library/a90k134d(VS.80).aspx) (VS.80).aspx 。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T18:24:50.343

你为什么不使用 std::vector 呢？

# sql - 测试 SQL 查询的最佳方法

> ID：754527
> 
> 赞同：119
> 
> 时间：2009-04-16T02:28:46.777
> 
> 标签：sql, unit-testing

我遇到了一个问题，我们不断有复杂的 SQL 查询出错。从本质上讲，这会导致向不正确的客户发送邮件以及其他类似的“问题”。

每个人在创建这样的 SQL 查询方面都有什么经验？我们每隔一周创建新的数据队列。

所以这里是我的一些想法和对它们的限制：

*   **创建测试数据**虽然这将证明我们拥有所有正确的数据，但它不会强制排除生产中的异常。这些数据在今天被认为是错误的，但在 10 年前可能是正确的；它没有记录在案，因此我们只有在提取数据后才知道它。

*   **创建维恩图和数据图**这似乎是测试查询设计的可靠方法，但它并不能保证实现是正确的。它使开发人员提前计划并在编写时考虑正在发生的事情。

感谢您对我的问题提出的任何意见。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2009-04-16T02:53:13.037

您不会编写具有 200 行长的函数的应用程序。您可以将这些长函数分解为更小的函数，每个函数都有一个明确定义的职责。

为什么要这样写你的SQL？

**分解查询，**就像分解函数一样。这使得它们更短、更简单、更容易理解、*更容易测试*、更容易重构。它允许您在它们之间添加“垫片”，并在它们周围添加“包装器”，就像在程序代码中一样。

你怎么做到这一点？通过将查询所做的每一件重要的事情变成一个视图。然后，您可以从这些更简单的视图中*组合*更复杂的查询，就像您从更原始的函数中组合更复杂的函数一样。

最棒的是，对于*大多数*视图组合，您将从 RDBMS 中获得完全相同的性能。（对于有些人你不会；那又怎样？过早的优化是万恶之源。首先正确编码，*然后*在需要时进行优化。）

[这是一个使用多个视图分解复杂查询的示例。](https://stackoverflow.com/questions/702500/sql-query-to-collapse-duplicate-values-by-date-range/712309#712309)

在示例中，由于每个视图只添加了一个转换，因此可以对每个视图进行独立测试以发现错误，并且测试很简单。

这是示例中的基表：

```
create table month_value( 
    eid int not null, month int, year int,  value int ); 
```

这个表是有缺陷的，因为它使用两列，月和年，来表示一个数据，一个绝对的月份。这是我们对新的计算列的规范：

> 我们将其作为线性变换进行，使其与（年，月）排序相同，并且对于任何（年，月）元组，只有一个值，并且所有值都是连续的：

```
create view cm_absolute_month as 
select *, year * 12 + month as absolute_month from month_value; 
```

现在我们必须测试的是我们的规范中固有的，即对于任何元组（年，月），只有一个（absolute_month），并且（absolute_month）是连续的。让我们写一些测试。

我们的测试将是一个 SQL`select`查询，具有以下结构：一个测试名称和一个连接在一起的 case 语句。测试名称只是一个任意字符串。case 语句只是`case when`测试语句`then 'passed' else 'failed' end`。

测试语句将只是 SQL 选择（子查询），必须为真才能通过测试。

这是我们的第一个测试：

```
--a select statement that catenates the test name and the case statement
select concat( 
-- the test name
'For every (year, month) there is one and only one (absolute_month): ', 
-- the case statement
   case when 
-- one or more subqueries
-- in this case, an expected value and an actual value 
-- that must be equal for the test to pass
  ( select count(distinct year, month) from month_value) 
  --expected value,
  = ( select count(distinct absolute_month) from cm_absolute_month)  
  -- actual value
  -- the then and else branches of the case statement
  then 'passed' else 'failed' end
  -- close the concat function and terminate the query 
  ); 
  -- test result. 
```

运行该查询会产生以下结果：`For every (year, month) there is one and only one (absolute_month): passed`

只要month_value中有足够的测试数据，这个测试就有效。

我们也可以为足够的测试数据添加测试：

```
select concat( 'Sufficient and sufficiently varied month_value test data: ',
   case when 
      ( select count(distinct year, month) from month_value) > 10
  and ( select count(distinct year) from month_value) > 3
  and ... more tests 
  then 'passed' else 'failed' end ); 
```

现在让我们测试它的连续性：

```
select concat( '(absolute_month)s are consecutive: ',
case when ( select count(*) from cm_absolute_month a join cm_absolute_month b 
on (     (a.month + 1 = b.month and a.year = b.year) 
      or (a.month = 12 and b.month = 1 and a.year + 1 = b.year) )  
where a.absolute_month + 1 <> b.absolute_month ) = 0 
then 'passed' else 'failed' end ); 
```

现在让我们将我们的测试（只是查询）放入一个文件中，然后针对数据库运行该脚本。实际上，如果我们将视图定义存储在一个脚本（或多个脚本，我建议每个相关视图一个文件）中以针对数据库运行，我们可以将每个视图的测试添加到*同一个*脚本中，这样（重新-) 创建我们的视图也会运行视图的测试。这样，当我们重新创建视图时，我们都会得到回归测试，并且当视图创建针对生产运行时，视图也将在生产中进行测试。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-16T03:03:07.147

创建一个测试系统数据库，您可以根据需要随时重新加载。加载您的数据或创建您的数据并将其保存。产生一个简单的方法来重新加载它。将您的开发系统附加到该数据库并在投入生产之前验证您的代码。每次你设法让问题投入生产时，都要踢自己。创建一套测试来验证已知问题并随着时间的推移扩展您的测试套件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-16T02:38:20.607

您可能想要检查[DbUnit](http://dbunit.sourceforge.net/)，因此您可以尝试使用一组固定数据为您的程序编写单元测试。这样，您应该能够编写具有或多或少可预测结果的查询。

您可能想要做的另一件事是分析您的 SQL Server 执行堆栈并找出所有查询是否确实是正确的，例如，如果您只使用一个返回正确和错误结果的查询，那么显然查询是used 是有问题的，但是如果您的应用程序在代码的不同点发送不同的查询呢？

那么，任何修复您的查询的尝试都是徒劳的......无论如何，流氓查询可能仍然是引发错误结果的那些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-01T13:30:30.353

回复：tpdi

```
case when ( select count(*) from cm_abs_month a join cm_abs_month b  
on (( a.m + 1 = b.m and a.y = b.y) or (a.m = 12 and b.m = 1 and a.y + 1 = b.y) )   
where a.am + 1 <> b.am ) = 0 
```

请注意，这仅检查连续月份的 am 值是否连续，而不是连续数据是否存在（这可能是您最初的意图）。如果您的源数据都不是连续的（例如，您只有偶数月份），这将始终通过，即使您的 am 计算完全关闭。

我是否也遗漏了什么，或者那个 ON 子句的后半部分是否会影响错误的月份值？（即检查 12/2011 是否在 1/2010 之后）

更糟糕的是，如果我没记错的话，SQL Server 至少在优化器将它的虚拟双手抛向空中并开始对每个请求进行全表扫描之前，至少允许您查看不到 10 个级别，所以不要过度使用这种方法。

记住要测试你的测试用例！

否则，创建一组非常广泛的数据以包含大多数或所有可能的输入形式，使用 SqlUnit 或 DbUnit 或任何其他 *Unit 自动检查针对该数据的预期结果，并*根据需要审查、维护和更新它*通常似乎是要走的路。

# iphone - 嵌入在 tabBarController 中的 UINavigationController

> ID：754536
> 
> 赞同：0
> 
> 时间：2009-04-16T02:34:05.390
> 
> 标签：iphone

有任何示例或代码可以显示如何在 tabBarController 中嵌入 UINavigationController，通常我们开发的应用程序来自 UINavigationController 而不是 tabBarController，所以我现在很困惑可以提供帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-17T06:19:17.357

在google tabbarcontroller+navigation controller上搜索。网上有很多教程

这是给你的一个教程 [TabbarController+NavigationController](http://twilloapp.blogspot.com/2009/03/how-to-embed-navigation-controller.html)

# process - 代码质量：如何衡量开发人员的表现？

> ID：754539
> 
> 赞同：22
> 
> 时间：2009-04-16T02:35:50.800
> 
> 标签：process, development-environment

我在一家软件开发公司工作，我们有大约 100 人在开发一个产品，其中 1/3 是 QA。最近管理层希望有一种更好的方法来评估单个程序员的表现，因此建议使用错误报告作为衡量标准。对开发人员的错误报告越多，他就越糟糕。这似乎是不明智的，原因比我能说的要多，例如这是一种主观的衡量方式，开发人员从事不同复杂性的不同项目。此外，如果 QA 是根据他们生成的错误报告的数量来衡量的，那么将会有很多关于错误报告的有效性的讨论。

在这种情况下衡量开发人员绩效的更好方法是什么？

一个建议是不要使用来自 QA 的错误报告作为衡量标准，而是使用来自外部的错误报告，例如 beta 测试人员，然后当发布此类公共错误报告时，也让 QA 由它来衡量。

编辑：#1 在阅读了您的一些出色回复后，我认为上述指标的一般问题是它是负面报告错误 - 它不鼓励生成高质量的代码。

编辑：#2 我认为问题在于它是两个世界。一方面是非程序员，他们基本上将程序员视为工人，他们希望指标 loc/minute 更好。然后我们有程序员，他们希望将自己视为艺术家或工匠，“请不要打扰我，我正在编码”:) 我不认为衡量质量可以通过指标来完成，而不是适得其反。相反，一个人对错误的反应、改变的意愿、创造力以及最重要的工作质量是重要的，但大多不一定是可衡量的。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-16T02:43:04.730

[![替代文字](https://i.stack.imgur.com/zPEZD.jpg)](https://i.stack.imgur.com/zPEZD.jpg)       

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-16T02:42:28.163

试图用错误报告来衡量程序员的表现是个坏主意。但是，尝试使用几乎[任何其他指标](http://www.joelonsoftware.com/news/20020715.html)来衡量性能也是如此。无论你做什么，人们都会弄清楚如何玩弄它并给你你正在测量的东西，而不是给你你真正想要的东西。

来自 Joel 的[其他文章](http://joelonsoftware.com/items/2006/08/09.html)之一：

> Robert Austin 在他的《衡量和管理组织绩效》一书中说，引入新的绩效指标有两个阶段。起初，你实际上得到了你想要的，因为没有人知道如何作弊。在第二阶段，您实际上会遇到更糟糕的情况，因为每个人都想出了最大化您正在衡量的事物的技巧，即使以破坏公司为代价。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-16T02:53:51.100

![替代文字](https://farm3.static.flickr.com/2203/2245445147_ff54c5997d.jpg?v=0)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-16T02:56:44.493

我对这种评级系统的根本问题是，你最终会与你的团队相互竞争，而不是相互合作。如果你知道你可能会支付罚金，那么在代码的困难部分上工作的动机是什么？只需选择不易出错的简单事物即可。为什么要帮助您的同事改进他们的代码呢？这样做会使他们受益，并可能在评级系统方面损害您的利益。

我认为你最好使用同伴压力来提高代码质量：没有人想写废话，也没有人想因写废话而出名。真正努力通过 TDD 降低缺陷——或者至少通过单元测试。转向持续集成并公布谁破坏了构建。让破坏构建的人有责任在他们创建任何新代码之前修复它。这样的事情会提高质量。

一旦每个人都同意质量目标，就给团队而不是个人打分。让合作成为真正的好处。如果你有利用团队的懒鬼——每个人都知道他们是谁——和他们一起改进，如果他们没有或不能，减少你的损失并找到更适合团队的人. 如果你有合适的人，它可能永远不会达到这一点。如果他们是错误的人，那么您和他们都最好了解这一点并继续寻找更合适的人选。

如果团队中的某个人真的超越了别人，就给他们一些额外的奖励，但要确保这真的是超出团队其他成员的非凡努力。如果是这样的话，团队不会介意（太多），因为他们会知道他们的共享奖励在很大程度上是由于那个人的努力。

显然，以上所有内容都应视为一般规则。尽管他们喜欢称其为管理科学，但实际上它更像是一门艺术。了解团队的动态是一项复杂的工作，但我认为一般规则应该是鼓励和奖励团队合作。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-16T02:47:04.877

我从该领域的错误报告中看到的一个大问题是，程序员可能已经按照给定的规范进行了 100% 的编程，然后该领域的问题是由于规范不佳或不完整造成的。

让我举个例子：您在 32 位 Windows Vista 上开发和测试应用程序，然后在运行 64 位 WIndows XP 的客户站点上失败。那是程序员的错吗（特别是如果你从来没有给他一台运行 XP 64 位的机器来测试）？

一旦你意识到一个 bug 的出现可能有很多原因，其中只有一些是程序员可以控制的，你需要非常小心，不要设置一个导致相互指责和欺骗的环境。团队的所有成员都需要共同努力使产品变得更好，而不是整天试图将错误归咎于其他人。

无论您做什么，都不要创建一个激励系统，让某人因证明是别人的错而获得奖励积分。错误需要被视为由整个组织拥有。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-16T02:43:17.257

由于您提到的原因，这是一个可怕的指标。

此外，“外部”错误报告也是评判开发人员的一种不公平且不可靠的方式——如果某些开发人员从事的代码领域比其他人使用得更多怎么办？如果我的功能被我的 80% 的用户使用，而你的被 1% 的用户使用，你认为谁会看到更多的错误报告？

任何容易被人玩弄的指标 - 或给予其他被衡量的人玩弄他们的*动机*- 也是可怕的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-16T02:56:41.157

开发人员报告的错误是一个可怕的指标。作为 QA 负责人，我一次又一次地反对这一点。**会**发生错误。当他们这样做时如何处理他们更有意义。

一个更好的指标是开发人员的错误重新打开率是多少。换句话说，当 QA 记录了一个 bug，然后修复了，这个 bug 是正确修复的，还是有什么遗漏了，导致 QA 重新打开了这个 bug？

这种情况发生得越频繁，这表明开发人员可能没有真正关注这个问题。当然，这是假设错误首先被智能记录下来，最好带有重现步骤、实际结果、预期结果以及原因。屏幕截图也有帮助。

显然，这只是要报告的一个指标。其他可能性是

*   开发商是否满足承诺的最后期限？
*   对客户关注的反应。
*   任何所需文件的准确性。

可能还有其他人。

**编辑：**我已经完成了开发和质量检查，并且在我的开发期间很幸运，没有在评论中对我使用错误计数。在我目前的职位上，我在我目前的公司反对它，因为它是一个不可靠的 IMO 指标。我们使用重新打开率作为折衷方案，以使高层管理人员（读作“尖头发”开发总监）对他们有东西要报告感到高兴。我不是经理，实际上我自己并没有生成任何报告（以防这是导致一些反对意见的原因）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-16T02:51:00.933

克里斯说得好。

我们办公室也有类似的问题。CEO 和其他大人物不知道如何衡量开发质量，他们实施了自己荒谬的衡量标准。总计开发人员的错误计数绝对不是要进行的衡量标准。我不知道是否有一个完美的答案，但我希望我的工作是通过我是否满足我的最后期限和消费者反馈来衡量的（他们对产品是否满意）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-16T05:20:14.057

我们是专业人士，和很多人一样。我们也相信我们是艺术家，在我看来我们是。不幸的是（大多数）程序员是有赞助人的艺术家。

说没有可行的衡量标准来衡量我们是在说“别管我们，我们会做好自己的工作”。这*可能*适用于你，但你有多少同事只是希望你有一个数字来表明他们有多糟糕？主观性很好，让我们都感觉更好，并为经理创造了不错的薪水，但我们*确实*需要一定程度的程序员熟练程度。

如果我们自己没有想出让管理层高兴的东西，那么他们就会像艺术赞助人一样做同样的事情。“我不喜欢，你被解雇了”。

世界 > 公司 > 产品 > 开发商

至于一个特定的指标，我和其他人一样迷茫。我看到的最好的是重新打开的错误指标。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-16T02:43:50.110

验证质量的唯一真正方法是审查工作......并衡量审查的内容和返工量。错误是**事后**衡量这一点的方法——而且只有一个指标，但在开发过程中进行审查会更好。[查看TopCoder](http://www.topcoder.com/stat?c=top_developers)使用的一些指标。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-16T02:44:35.270

错误报告不仅是一种建议性措施，而且它们也没有真正的可比性。错误有多“大”？一个大错误可能比有 5 个小错误更糟糕……另一方面，它可能不是。因此，您需要了解每个单独错误的细节（这将是一场噩梦）。

您可以考虑修复每个错误需要多长时间，但这很容易玩 - 添加一个简单的错误，快速修复它，这抵消了修复更难修复的诚实错误所花费的时间。

您可以使用 lint 工具和单元测试来提高代码质量，而不会受到惩罚。lint 是一个相对简单的过程更改，您随着时间的推移工作（从现有代码库上的 X 警告开始，然后奖励在一段时间内删除最多警告的人 - 将其变成积极的而不是消极的）。

单元测试是另一回事，奖励具有最少错误和最多测试的代码（如果测试编写得当，那么最好的测试代码将有最少的错误）。对于开发人员来说，这再次是一个积极的奖励和令人鼓舞的事情。测试使代码更好，人们不会受到惩罚。

还有很多其他类似的事情，但在我的脑海中，这些都会对产品的质量产生明显的影响（并且可以公正地衡量）——这是最终目标。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-16T02:47:46.607

我建议您的管理层阅读Mary Poppendieck 和 Tom Poppendieck 的*《实施精益软件开发：从概念到现金*》。他们强烈反对根据指标对开发人员进行评级的想法。他们的偏好是奖励团队，而不是个人。

如果认为该方法不实用，我会推荐（他们也是如此......我认为......）同行评审。不过，不要直言不讳地说，“你如何给你的队友排名？”。而是问：当你遇到无法解决的问题时，你会去找谁？谁为项目提供了最好的创意投入？等等。这些问题的答案可以为谁在团队中投入最多提供更好的指导。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-16T02:50:35.070

即使测试人员在内部或外部，我也不同意“按错误计数衡量”的概念。

您可以使用一些关于严重程度的评级机制，而不是直接计算错误的数量，即我的意思是衡量程序员的粗心程度。

假设程序员正在编写代码而不处理异常。这个问题比复杂算法中的复杂逻辑错误更大。因此，在这种情况下，为每个错误使用评级机制会更好。在这种情况下，每个错误/错误/错误都会得到一个公平的权重，我们可以使用错误评级的总和来获得关于性能的总体想法。

另一方面，这种方法也会产生问题，因为评级也是由人类完成的。但是有一个团队来进行这个评级将减少此类问题，并且随着时间的推移，该机制将变得更加有用，并进行必要的改进和更改。

但是您有责任对错误类别进行分组并为其分配必要的权重。我认为您不能立即这样做。随着时间的推移，这个“定义”也应该随着时间的推移而成熟。:)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-16T02:51:19.950

这个指标很糟糕，并且会鼓励非常糟糕的做法和关于谁造成了哪个错误的内讧。任何故障度量都应该通过衡量成功的度量来平衡。根据定义，编写更多代码的人将有更多出错的机会。根据可用数据，您可能希望标准化您的评级系统。如果一个开发人员实现了一个没有缺陷的功能，我不会以任何方式对他进行评价，而不是一个实现了 243 个功能但有 3 个缺陷的开发人员。评级开发人员要求管理层搁置数字并观察每个团队成员。积极参与的经理将了解哪些开发人员存在不足，并将与他们合作以提高他们的绩效。这实际上需要管理者的工作来帮助每个人设定和实现目标。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-16T04:50:40.880

对此我想说三点：

1) 一位经理建议“更高的错误数 == 更差的开发人员”或“... == 更好的测试人员”对您的公司来说可能是比任何单个开发人员都更大的问题。此人是如何参与有关评估开发人员绩效的讨论的？如果他们在管理开发人员，他们应该更清楚。

**2) 开发人员对任何**与错误相关的指标（错误计数、重新打开率、标准化或不按功能/LOC/其他）进行游戏的最简单方法是使他们的实现尽可能难以测试。无法测试意味着 QA 发现的错误为零。也可能无法使用，这意味着来自现场的零错误报告（嗯，也许是一个）。*任何错误计数指标都是对*可测试性的激励。询问管理层这是否真的是他们想要的。

3）如果他们真的实施了这项政策，那就跑得像地狱一样。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-16T05:34:10.870

> 在阅读了您的一些出色回复后，我认为上述指标的一般问题是它是负面报告错误 - 它不鼓励生成高质量的代码。

那是真实的。您应用的任何其他指标都会遇到同样的问题。关键问题是质量不是我们知道如何用数字来衡量的东西。另外，如果你的工作做得很好，你就不应该真正关心代码质量的问题。你真正的问题应该是，“这个人是如何帮助我们赚钱的？”

评估不是你可以用数字做的事情，而是你必须尝试去做的事情。我能给你的最好建议是，你的经理只需要与程序员一起工作，并了解程序员在做什么。另一个重要的信息来源来自日复一日与他们一起工作的程序员同行。由于我们没有衡量质量的数字方法，您将在某种程度上不得不依靠更软的科学来了解您的程序员的表现如何。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-24T04:16:07.200

QA 发现的错误 = 好。客户发现的错误 = 不好。

如果您需要衡量开发人员，请使用测试后发现的#bugs，即在Production/Release/'on the disc' 代码中。

质量检查的相同指标......“一个团队一个梦想”。

迈克尔

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-04-16T05:19:06.133

在实施任何类型的指标之前，先问问自己......最终......你想要衡量什么？

- 程序员生产力你不听吗？？呵呵

-是的，当然..但这为什么重要？

将人类纳入指标将不可避免地尝试针对自己的目标对其进行优化，因此，了解这一点后，您应该能够利用这种优化来发挥自己的优势。

*   那么问问自己，如果有人优化了指标，他们会专注于什么？

然后将你的指标直接用于衡量会对系统产生积极影响的事情，因此，不要衡量每个程序员的错误，这只会在事情变糟时为管理层提供弹药，而是尝试衡量错误发生的位置和原因，而不是谁制造了它们。

因此，每个模块的错误、每个版本的错误、每个代码修复的错误、每个功能的错误将是更有效率的指标，并将有助于识别热点。当然，您总是可以将其与某人联系起来，因为始终与程序员有间接联系，但是在将程序员置于指责战争的最前沿之前，您最好确定 HE-SHE 是原因。

*   问问自己你想创造什么样的环境？面对指标公布，团队、经理、主管会有什么反应？

如果你衡量人，让他们看起来很糟糕，那么你就是在自找麻烦。如果你喜欢产品，那么重点就不是让自己看起来好，而是让产品看起来好。反过来，这将是一个更好的激励因素，并将培养积极的团队精神。

*   公开您的指标，任何形式的信息隐藏都会引起不良反应和不公正。因此，如果您公开您的指标，请注意他们所说的内容。

最后，如果你真的坚持要衡量人，那就衡量他们所有人，程序员、架构师、经理、销售人员、董事，每个人都应该接受同样的审查。然后把刀藏起来，把金属探测器放在门上。因为通常情况下，公司人员的透明度只有一种方式，从上往下看。

# air - 如何在 Adob e AIR 中从 Javascript 访问 Actionscript

> ID：754542
> 
> 赞同：2
> 
> 时间：2009-04-16T02:38:58.623
> 
> 标签：air

我有一个用 html/javascript 编写的 AIR 应用程序，我想使用 Actionscript 打印功能，但我没有使用 Actionscript for AIR 的经验。

我在哪里放置 Actionscript 代码？它是进入 mxml 文件还是需要编译到 Flash 应用程序中。我应该把它放在哪里以及如何将它包含到 html 文档中？最后，如何从 Javascript 调用 AS 函数？

**=====更新=====**

我知道我必须使用 mxmlc 将 .mxml 或 .as 文件编译成 .swf，并且我的 .as 文件中有以下内容：

```
package {
    import mx.controls.Alert;
    public class HelloWorld {
        public function HelloWorld():void {
            trace("Hello, world!");
        }
    }
} 
```

或者，这在 .mxml 文件中：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Script>
    <![CDATA[
       import mx.controls.Alert;

           public function HelloWorld():void {
               Alert.show("hello world!");
               trace("Hello, world!");
           }
        ]]>
    </mx:Script>
</mx:Application> 
```

这可以编译，但是当我将它包含在一个 html 文件中时：

```
<script src="actionscript.swf" type="application/x-shockwave-flash"></script> 
```

我收到以下错误：

TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 mx.managers::FocusManager/activate() 在 mx.managers::SystemManager/activateForm() 在 mx.managers::SystemManager/activate() 在 mx.core::Application/initManagers() 在 mx.core::在 mx.managers::SystemManager/ 的 actionscript/initialize() 中的应用程序/initialize() [http://www.adobe.com/2006/flex/mx/internal::childAdded()](http://www.adobe.com/2006/flex/mx/internal::childAdded()) 在 mx.managers::SystemManager/initializeTopLevelWindow () 在 mx.managers::SystemManager/ [http://www.adobe.com/2006/flex/mx/internal::docFrameHandler()](http://www.adobe.com/2006/flex/mx/internal::docFrameHandler()) 在 mx.managers::SystemManager/docFrameListener()

任何想法这意味着什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T08:12:47.917

> 您必须在实用程序 AS 包上使用`air.trace`where`air`是预定义的 Javascript 包装器。

我假设您正在使用 HTML/AJAX 进行 AIR 开发。

但是，否则，您需要使用 ExternalInterface 才能使 JS 可以使用 AS 功能。你能告诉我们你为什么需要这个吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-28T06:55:42.463

在以下位置可以找到相关文档：http: [//help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7ed9.html](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS5b3ccc516d4fbf351e63e3d118666ade46-7ed9.html)

确保使用 acompc 进行编译：

> 注意：要编译 ActionScript SWF 库以在 AIR 中用作 HTML 页面的一部分，请使用 acompc 编译器

而且...因为您使用的是 Alert 类...它取决于 Flex 框架。确保在编译 swf 时。你在整个框架中编译。（即确保`-static-link-runtime-shared-libraries=true`）

# c# - Tricky Linq Group by 时间范围

> ID：754546
> 
> 赞同：1
> 
> 时间：2009-04-16T02:41:33.640
> 
> 标签：c#, linq, datetime, linq-group

我有一个代表员工可以工作的班次的课程：

```
public class Shift {
    public int Id { get; set;}
    public DateTime Start {get;set;}
    public DateTime End { get; set;}
    public DayOfWeek Day { get; set;}
} 
```

假设我有一个单一员工的轮班列表：

```
List<Shift> myShifts; 
```

我知道我可以使用以下 linq 语句按天分组：

```
var shiftsByDay = from a in myShift
                  group a by a.Day; 
```

我的问题：**对于每一天，我怎样才能得到所有重叠的班次，在不同的组中，而不重复计算？**

重叠班次是开始或结束时间与另一个班次开始或结束时间重叠的班次。

如果可能的话，我希望能够使用 linq 做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T03:30:56.470

首先，我认为如果你给每个班次一些唯一的标识符以便你可以区分它会更容易。然后我认为您可以使用 Where 选择与集合中的另一个元素有任何冲突的每个元素。最后，您可以按天对它们进行分组。请注意，这不会告诉您哪些班次有冲突，而只会告诉您在任何一天发生冲突的班次。

```
public class Shift {
    public int ID { get; set; }
    public DateTime Start {get;set;}
    public DateTime End { get; set;}
    public DayOfWeek Day { get; set;}
}

var query = shifts.Where( s1 => shifts.Any( s2 => s1.ID != s2.ID
                                        && s1.Day == s2.Day
                                        && (s2.Start <= s1.Start && s1.Start <= s2.End)
                                             || (s1.Start <= s2.Start && s2.Start <= s1.End))
                  .GroupBy( s => s.Day );

foreach (var group in query.OrderBy( g => g.Key ))
{
    Console.WriteLine( group.Key ); // Day of Week
    foreach (var shift in group)
    {
         Console.WriteLine( "\t" + shift.ID );
    }
} 
```

# openid - openID的最大长度

> ID：754547
> 
> 赞同：17
> 
> 时间：2009-04-16T02:42:07.320
> 
> 标签：openid, size

我计划为我正在构建的 Web 应用程序添加 openid 支持。我似乎找不到有效 openid 的最大长度，因此我可以将其存储在我的数据库中。我看到一些对 255 的模糊引用，但我宁愿确定。

另外使用 openid 作为用户名有用吗（推荐）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-12-23T15:08:18.597

根据 OpenId 1.1 的规范，标识符 Urls 的最大限制为 255 个字节。请参阅[OpenId 1.1 附录 D：限制](http://openid.net/specs/openid-authentication-1_1.html#limits)。Identity Provider 和 return_to Urls 最多可达 2047 个字节。

请注意，有关限制的这一部分已从 OpenId 2.0 规范中删除。所以现在还不清楚最大长度是多少。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-16T02:47:50.677

OpenID 是一个 URI，因此您受限于 URI 的最大长度。据我所知，没有限制，但某些浏览器（例如 Internet Explorer）有限制。

进一步阅读：

[http://openid.net/pipermail/general/2008-August/005305.html](http://openid.net/pipermail/general/2008-August/005305.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T02:55:53.030

我不会直接使用 OpenID 作为用户名。看看 Yahoo 提供给用户的 OpenID URL，它们是难以理解的。允许用户选择他们自己的用户名，并且理想情况下允许多个 OpenID URL 与一个用户帐户相关联（就像 Stack Overflow 一样）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T02:59:08.280

规范的 2.0 版中没有官方长度。

您可以将提供的 URL 散列为唯一的内容（md5 或其他一些可重复的散列），并将其作为更短的字符串存储在您的数据库中。

至于使用它作为用户名，一个大的网址并不漂亮。您可以从响应中提取用户名（所以直接从我的 OpenID 获得我的用户名）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T11:50:11.423

您不应接受任何长度超过 255 的 OpenID URL。尽管有可能，但许多人可以将其用作攻击媒介来实施 SQL 注入等攻击。看看 OWASP AntiSAMY API 作为额外的保护。

# ruby - 使单元测试快速失败以进行突变测试

> ID：754561
> 
> 赞同：6
> 
> 时间：2009-04-16T02:48:02.550
> 
> 标签：ruby, unit-testing, mutation-testing

[突变测试](http://en.wikipedia.org/wiki/Mutation_testing)遇到的一个问题是它很慢，因为默认情况下，您会为每个生成的突变执行完整的测试运行（测试文件或一组测试文件）。

使突变测试更快的一种方法是在遇到单个故障时停止对给定突变体的测试运行（但仅在突变测试期间）。更好的办法是让突变测试者记住第一个杀死最后一个突变体的测试是什么，然后把它首先交给下一个突变体。ruby 中有什么东西可以做这些事情，或者我最好的选择是开始猴子补丁？

（是的，我知道单元测试应该很快。并且显示所有失败的测试在突变测试之外很有用，因为它不仅可以帮助您识别出问题所在，还可以查明哪里出了问题）

**编辑**：我目前正在使用带有测试/单元的 heckle。如果测试/单元无法记住在运行之间哪些测试失败，也许 heckle 或运行 heckle 的东西可以记住它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T17:00:27.677

最好的办法是从 github 上查看[heckle 源](http://github.com/ryansobol/heckle/tree/master)，对其进行修补，然后将该修补程序提交给开发人员。您应该能够为 heckle 编写自定义测试运行程序。

猴子修补永远不是解决此类问题的方法。事实上，猴子补丁几乎从来都不是解决问题的办法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T09:22:33.607

一旦遇到失败的示例，我的[突变](https://github.com/mbj/mutant)工具使用 rspec2选项立即停止。`--fail-fast`连同`--rspec-dm2`只执行受影响的单元测试的策略，我们得到了非常快速的变异覆盖测试。有关（速度）演示，请参阅此[asciiccast](http://ascii.io/a/1707)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-29T02:55:09.257

我开始使用的一种方法是为每种方法编写单元测试，并将它们放在单独的文件中，像 ruby​​specs 一样组织。我单独运行每个规范，指定我想要质问的确切方法。我有一个 rake 任务来管理所有这些，并在最后打印一份报告，其中包含失败的突变（如果有的话）。

最后，我得到了每种方法的全面覆盖，而无需永远等待结果。此外，它甚至比每个人都使用的正常方法更好，因为我没有得到任何偶然的报道——每个方法的规范必须涵盖该方法的所有突变。

# php - 使用 Ajax 为 HTML 按钮 Onclick 调用 PHP 函数

> ID：754571
> 
> 赞同：0
> 
> 时间：2009-04-16T02:53:46.513
> 
> 标签：php, html, ajax, button

我有一个 HTML 按钮，我希望 onclick 调用 PHP 函数。我需要使用 AJAX 来做到这一点，但我完全迷失了。php 函数内部还有更多内容，但我没有看到需要包含它。以下是到目前为止的代码：

```
<HTML>
<BODY>
<FORM>
    <input text="text" name=airport1 id=airport1 />
    <input text="text" name=airport2 id=airport2 />
    <input type="button" value="Enter" onclick=PrintDist()/>
</FORM>
</BODY>
</HTML>

<?php

    function PrintDist(){
        $icao1 = $_REQUEST["airport1"];
        $icao2 = $_REQUEST["airport2"];
    }
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T03:18:06.487

使用 jQuery（未经测试）：

```
function PrintDist() {
    var submitButton = $(this).find('*:submit');

    $.post(this.action, $(this).serialize(), function() {
        alert('Form submitted!');
        submitButton.attr('disabled', 'false').attr('value', 'Enter');
    });

    submitButton.attr('disabled', 'true').attr('value', 'Posting...');

    return false;
} 
```

使用适当的形式作为您的 HTML（对于没有 Javascript 的人，并且脚本可以很好地工作）：

```
<form action="xxx" method="post" onsubmit="return PrintDist()">
    <input text="text" name="airport1" id="airport1" />
    <input text="text" name="airport2" id="airport2" />
    <input type="submit" value="Enter" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T03:28:41.220

使用任何 javascript 库对服务器上的 php 脚本进行 ajax 调用。例如：

*   [jQuery](http://jquery.com)
*   [原型](http://prototypejs.org)

或者如果你只是想要非常简单的东西，看看[sajax](http://www.modernmethod.com/sajax/) ajax toolkit for php

# sql - 查找和显示重复项

> ID：754580
> 
> 赞同：2
> 
> 时间：2009-04-16T02:56:49.423
> 
> 标签：sql, mysql, database

我有一张桌子。我想在此表中搜索重复的标题。
可以说我的数据如下：

> 标题1，标题2，标题3，标题1，标题4，标题2，标题9

我希望我的查询搜索此表并仅输出重复项。所以输出看起来像：
title1
title1
title2
title2

我知道如何找到重复项，但它只显示其中一个重复项，而不是两者。

```
SELECT id, title, artist_id FROM sm019_songs GROUP BY title HAVING count(title) > 1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T03:06:12.613

这是使用子查询的一种方法。首先将子查询加载到临时表中可能是有意义的。（这将在 SQL 服务器中工作，不确定确切的 MySql 语法是什么。）

```
select id, title, artist_id
from sm019_songs
where title in
(
    SELECT title
    FROM sm019_songs
    GROUP BY title
    HAVING count(title) > 1
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T03:58:25.343

这是我在mysql中提出的：

`CREATE TEMPORARY TABLE u (title varchar(250))
TYPE=HEAP;
INSERT INTO u
SELECT title FROM t group by title having count(title) > 1;`

`SELECT t.title FROM u,t where u.title = t.title` 

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T04:11:26.327

我只是将表加入到自身中：

```
SELECT S1.*, S2.*
FROM songs S1, songs S2
WHERE S1.title = S2.title
  AND S1.id != S2.id 
```

-----N

# linux - 如何在 Perl 中使用 paste 和 awk？

> ID：754583
> 
> 赞同：4
> 
> 时间：2009-04-16T02:58:24.257
> 
> 标签：linux, perl, unix, awk, paste

我有以下在 Perl 中使用“粘贴”和 AWK 脚本的代码。

```
use strict;              
use Data::Dumper;        
use Carp;
use File::Basename;      

my @files = glob("result/*-*.txt");
my $tocheck = $ARGV[0] || "M";

foreach my $file ( @files  ) {
    my $base = basename($file,".txt");
    my @res = `paste <\(awk '\$4 == "M" {sum += \$2 }END{print sum}' $file \) <\(awk '\$4 == "M" {sum += \$3 }END{print sum}' $file\)`;
    chomp(@res);         
    print "$base $res[0]\n";     
} 
```

为什么会出现这样的错误：

```
#sh: -c: line 1: syntax error near unexpected token `('
#sh: -c: line 1: `paste <(awk '$4 == "M" {sum += $2 }END{print sum}' result/9547_1-S_aureus.txt ) <(awk '$4 == "M" {sum += $3 }END{print sum}' 
#result/9547_1-S_aureus.txt) 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-16T03:10:54.037

不完全确定这是否是对您的脚本的正确解释，因为那里似乎有很多死/未使用的代码，但肯定不需要生成 paste 或 awk 来执行此操作：

```
#!/usr/bin/perl
use warnings;
use strict;
use File::Basename;

my @files = glob ("result/*-*.txt");

foreach my $file (@files) {
   open (FILE, $file) or die "open $file: $!\n";
   # You seem to be summing the 2nd and 3rd columns if the 4th is "M"
   my ($col1, $col2) = (0, 0);
   while (<FILE>) {
       my @cols = split /\s+/;
       if ($cols[3] eq "M") {
          # Perl uses 0-based arrays, unlike awk
          $col1 += $cols[1];
          $col2 += $cols[2];
       }
   }
   close FILE;
   printf "%s %d\n", basename ($file), $col1;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T10:29:56.253

为了解决这个错误，Perl 的反引号明确地使用 /bin/sh 来运行命令。您的 /bin/sh 不像 bash 并且不理解“<（进程替换）”语法。

我完全同意从 Perl 调用 awk 是愚蠢的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-25T16:47:22.423

可以简化以下命令吗？

```
my $inputString = "paste <\(grep \"target:\" $gTestFile | awk '{print \$4,\$5,\$6,\$7,\$8,\$10,\$11,\$12,\$15,\$16,\$17}'\) $preFile";

my @combinedOutput = `$inputString`; 
```

# boost - 我可以让 boost 的配置脚本静音吗？

> ID：754586
> 
> 赞同：0
> 
> 时间：2009-04-16T02:59:10.930
> 
> 标签：boost

当我安装 boost（运行 .configure）时，它会列出在安装过程中复制的每个文件。有什么办法可以让这个静音吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:55:04.073

沉默是指阻止输出到屏幕吗？您可以`.configure > /dev/null`在 Linux/OS X 或`.configure > nul`Windows 中执行此操作。

# .net - 如何获取异常堆栈

> ID：754587
> 
> 赞同：1
> 
> 时间：2009-04-16T02:59:35.797
> 
> 标签：.net, exception, stack, dllimport

我有一个 Winform 应用程序 (C#)，它从 dll 导入一些函数。

有时在运行应用程序时，我会遇到以下异常：

System.AccessViolationException：试图读取或写入受保护的内存。这通常表明其他内存已损坏。

我在 AppDomain.CurrentDomain.UnhandledException 中捕获它。

但我看不到堆栈。我如何获得堆栈？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T03:05:42.740

此异常发生在 CLR 的互操作管道中的程序范围之外，并且只能通过将外部调试器附加到进程来捕获。我建议使用 WinDbg（Windows 调试工具）。

-Oisin

# objective-c - 在 Cocoa 中实现源代码语法高亮的最佳方法是什么？

> ID：754591
> 
> 赞同：19
> 
> 时间：2009-04-16T03:00:54.530
> 
> 标签：objective-c, cocoa, syntax-highlighting, nstextview

我正在开发 Cocoa 应用程序，它应该能够分析和突出以 Objective-C、SQL、JavaScript、Python 等语言编写的源代码。文本也应该是可编辑的（例如，通过使用 NSTextView）。

请告知在 Mac OS X 10.5 中实现此类功能的最佳方法是什么。

无需支持自动完成和其他额外功能。通过关键字、字符串、#includes 和数字进行简单格式化，但性能很酷。

此外，如果支持按语言进行配置，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-16T17:54:52.210

在准备一个需要类似东西的项目时，我发现了以下内容（但没有深入评估它们）：

*   /Developer/Examples/OpenGL/Cocoa/GLSLEditorSample 实现语法高亮。
*   [IDEKit](http://projects.gandreas.com/idekit/)，“一个提供程序员源代码编辑的开源框架，包括语法着色、弹出功能和分割帧”。这已经有一段时间没有更新了（它吹捧 10.2 和 10.3 的兼容性，并附带一个 Project Builder 项目——可以使用 Xcode 2.5 进行转换）。
*   [UKSyntaxColoredTextDocument](http://www.zathras.de/sourcecode.htm#UKSyntaxColoredTextDocument)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-16T23:08:48.417

我会同意 Ahruman 的建议 - 特别是查看 Uli 的 UKSyntaxColoredTextDocument，因为这将为您指明需要学习哪些课程等的正确方向。

这是另一个很好的信息来源：

[http://www.cocoadev.com/index.pl?ImplementSyntaxHighlighting](http://www.cocoadev.com/index.pl?ImplementSyntaxHighlighting)

祝你好运 - 语法突出显示很难正确，但一路上很有趣！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-30T20:50:56.760

我最近不得不为 Cocoa 寻找语法高亮解决方案，在 Stack Overflow 上搜索后，Google 和 GitHub 找不到任何现代、易于重用且仍在积极开发中的东西。

如今，似乎大多数语法荧光笔都是为网络编写的。幸运的是，将它们嵌入到 WebView 中以在任何 Cocoa 应用程序中使用实际上非常容易。与编辑器的通信可以通过 WebKit 的[WebScriptObject 协议](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/WebKit/Classes/WebScriptObject_Class/Reference/Reference.html)来完成。

[这是流行的 JavaScript 文本编辑器CodeMirror](http://codemirror.net/) for Cocoa 的示例包装器： [https ://github.com/swisspol/CodeMirrorView](https://github.com/swisspol/CodeMirrorView)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T07:54:33.000

您可以使用 Python 编写的 Pygments 来生成源代码的 HTML 表示，然后可以在 Web 视图中呈现。

（请注意，如下面的评论中所反映的 - 这个答案是针对原始问题的，没有提到可编辑的文本。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-18T19:56:25.070

您可以考虑使用此处 [1] 中描述的（德语）的 flex。您可以在此处找到此方法的示例 [2]。

[1] [http://www.osxentwicklerforum.de/thread.php?postid=14764](http://www.osxentwicklerforum.de/thread.php?postid=14764) [2] [http://objectiveous.github.com/davenport/](http://objectiveous.github.com/davenport/)

# sql - SQL 批量插入错误 4863

> ID：754592
> 
> 赞同：1
> 
> 时间：2009-04-16T03:00:57.290
> 
> 标签：sql, insert, bulk

我正在尝试通过批量插入将一些数据导入 SQL Server 2008，但我遇到了大量的转换错误：

消息 4864，级别 16，状态 1，第 1 行第 5902 行第 2 列（类型）的批量加载数据转换错误（指定代码页的类型不匹配或无效字符）。

好的，首先要做的事情是：

a) 数据来自我用 C# 构建的解析器。在这个文件中，有 4 列，由制表符分隔。这些列可能为空，也可能不为空。排序规则是 UTF-8。这是它的摘录。

```
D00486  DBLinks PubChem 7847552
D00486  DBLinks LigandBox   D00486
**D00487    Name        Pyridostigmine bromide (JP15/USP/INN)** -- WORKS
D00487  Name        Mestinon (TN)
D00487  Chemical    260.016 C9H13N2O2\. Br
D00487  Target  PATH:hsa00564(43)
D00487  Remark      Therapeutic category: 1239
D00487  Remark      ATC code: N07AA02
D00487  Pathway PATH: map07220  Cholinergic and anticholinergic drugs
D00487  DBLinks CAS 101-26-8
D00487  DBLinks PubChem 7847553
D00487  DBLinks DrugBank    DB00545
D00487  DBLinks LigandBox   D00487
**D00488    Name        Pyrimethamine (JAN/USP/INN)** -- DOES **NOT** WORK!
D00488  Name        Daraprim (TN) 
```

倒数第二行会生成一条错误消息，就像我之前向您展示的那样。真正令我惊讶的是，我放在粗体上的另一行非常相似，但不会产生任何错误。

b）这是我用来创建表的：

```
CREATE TABLE [dbo].[KB] ([BEName] [nvarchar](1000) NOT NULL, [Type] [nvarchar](1000) NULL, [Name] [nvarchar](1000) NULL, [Value] [nvarchar](1000) NULL) ON [PRIMARY] 
```

c）这是我目前用来从文件中导入数据的：

```
DECLARE @SQL nvarchar(4000)
SET @SQL = 'BULK INSERT KB FROM ''C:\KB.xml'' WITH (FirstRow = 1, FORMATFILE = ''C:\out_KB.fmt'')';
EXEC(@SQL) 
```

我不得不手动生成 fmt 文件，因为由于某种原因 BCP 无法连接到我的数据库（仍在研究它的基础知识......）所以它可能不是它应该的样子。无论哪种方式，这是它的内容：

```
9.0
4
1 SQLCHAR 0 100 "" 1 BEName SQL_Latin1_General_CP1_CI_AS
2 SQLCHAR 0 500 "\t" 2 Type SQL_Latin1_General_CP1_CI_AS
3 SQLCHAR 0 500 "\t" 3 Name SQL_Latin1_General_CP1_CI_AS
4 SQLCHAR 0 500 "\n" 9 Value SQL_Latin1_General_CP1_CI_AS 
```

正如我之前所说，我对 BCP 没有太多经验。最初，我只是在使用

```
BULK INSERT KB FROM ''C:\KB.xml'' WITH (FirstRow = 1, RowTerminator = ''\n'' , FieldTerminator = ''\t'') 
```

但无论如何它都行不通。我仍然宁愿使用它而不是 FMT 文件；我用谷歌搜索并尝试了一些技巧（例如将 \n 与 \n\cr 交换或引入 \n 的 ASCII 代码）。

有任何想法吗？我不能说我有，我现在筋疲力尽，要睡到中午什么的：S（现在是凌晨 4 点）。

干杯队友，谢谢并提前哈尔

PS：我认为样品还可以，但请成为我的客人，随时索取您可能需要的东西。PS2：对不起文字墙；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T22:31:08.117

旧线程，但为了记录，我相信问题出在 OP 的格式文件上。它没有为第一行指定分隔符。它应该是：

```
9.0
4
1 SQLCHAR 0 100 **"\t"** 1 BEName SQL_Latin1_General_CP1_CI_AS
2 SQLCHAR 0 500 "\t" 2 Type SQL_Latin1_General_CP1_CI_AS
3 SQLCHAR 0 500 "\t" 3 Name SQL_Latin1_General_CP1_CI_AS
4 SQLCHAR 0 500 "\n" 9 Value SQL_Latin1_General_CP1_CI_AS 
```

...*没有*星号。

Windows 系统中的文件通常需要“\r\n”作为最终终止符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T03:48:50.280

非 XML 批量插入文件非常挑剔。我看了你的，没有发现问题，但是很容易漏掉问题。

XML 批量插入文件更容易使用。您可以重构代码以生成 XML 批量插入文件吗？我还发现，在使用 XML 插入文件时，您还必须使用 XML 格式文件，而 BCP 不会为您创建——您必须自己编写 XML 格式文件，但这很容易。

# artificial-intelligence - 历史股票数据的来源

> ID：754593
> 
> 赞同：244
> 
> 时间：2009-04-16T03:01:54.840
> 
> 标签：artificial-intelligence, simulation, finance, stocks

我正在尝试制作一个股票市场模拟器（也许最终会成长为一个预测 AI），但我很难找到要使用的数据。我正在寻找历史股票市场数据的（希望是免费的）来源。

理想情况下，这将是一个非常细粒度（秒或分钟间隔）的数据集，其中包含 NASDAQ 和 NYSE 上每个符号的价格和交易量（如果我冒险的话，可能还有其他）。有谁知道此类信息的来源？

我发现[这个问题](https://stackoverflow.com/questions/281263/where-can-i-get-free-real-time-stock-data)表明雅虎以 CSV 格式提供历史数据，但我一直无法通过粗略检查链接的网站找到如何获取它。

我也不喜欢在 CSV 文件中零碎地下载数据的想法......我想雅虎会在最初的几千个请求后感到不安并关闭我。

我还发现[了另一个](https://stackoverflow.com/questions/340678/free-historical-intra-day-stock-data)让我觉得我中了大奖的问题，但不幸的是，OpenTick 网站似乎已经关门了……太糟糕了，因为我认为它们正是我想要的。

我还可以使用每天每个交易品种的开盘/收盘价和交易量的数据，但如果我能得到它，我更喜欢所有数据。还有其他建议吗？

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2013-06-23T17:01:49.950

*让我加上我的 2 美分，为对冲基金获取良好和干净的数据是我的工作，我见过很多数据馈送和历史数据提供者。这主要是关于美股数据。*

首先，如果你有一些钱，不要费心从雅虎下载数据，直接从**[CSI 数据](http://www.csidata.com/)**获取一天结束的数据，这是雅虎获取 EOD 数据以及 AFAIK 的地方。他们有一个 API，您可以在其中将数据提取为您想要的任何格式。我认为每年订阅数据只需 100 美元。

从免费服务下载数据的主要问题是您只能获得仍然存在的股票，这称为[生存偏差](http://en.wikipedia.org/wiki/Survivorship_bias)，如果您查看许多股票可能会给您错误的结果，因为您只会包括那些使它如此远而不是那些被除名的。

为了处理一些日内数据，我会研究**[IQFeed](http://www.iqfeed.net/)**，它们提供了几个 API 来提取历史数据，尽管它们主要是用于实时提要的装备。但是这里有很多选择，一些经纪人甚至通过他们的 API 提供历史数据下载，所以选择你的毒药。

但是通常所有这些数据都不是很干净，一旦你真正开始回溯测试，你会发现某些股票丢失或显示为两个不同的符号，或者股票拆分没有正确考虑等等。然后你意识到历史股息数据也是需要的，所以你开始循环运行，将来自 100 个不同数据源的数据拼凑在一起，等等。因此，从“折扣”数据馈送开始就可以了，但是一旦您运行更全面的回测，您可能会遇到问题，具体取决于您所做的事情。如果你只看一下标准普尔 500 指数的股票，这将不是什么大问题，而且“便宜”的盘中数据就可以了。

您找不到的是免费的盘中数据。我的意思是你可能会找到一些例子，我敢肯定在某个地方有 5 年的 MSFT 刻度数据浮动，但这不会让你走得太远。

然后，如果您需要真正的东西（二级订单簿，所有交易所发生的所有滴答声），一个“负担得起”但绝佳的选择是**[Nanex](http://www.nanex.net/)**。他们实际上会为您提供一个包含数 TB 数据的驱动器。如果我没记错的话，它每年的数据约为 3k-4K 美元。但是相信我，一旦你明白了获得好的盘中数据有多难，你就不会认为这是一笔很大的钱。

不是让你气馁，而是获得好的数据很难，事实上，许多对冲基金和银行每月花费数十万美元*来*获取他们可以信任的数据。同样，您可以从某个地方开始，然后从那里开始，但最好在上下文中看到它。

* * *

编辑：上面的答案来自我自己的经验。[加州理工学院](http://quant.caltech.edu/historical-stock-data.html)关于可用数据馈送的这篇文章将提供更多见解，特别推荐**[QuantQuote](https://quantquote.com/)**。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2010-01-28T03:34:47.283

**这个答案不再准确，因为雅虎提要已经不存在了**

使用上面的 Yahoo 的 CSV 方法，您还可以获取历史数据！您可以对以下示例进行逆向工程：

[http://ichart.finance.yahoo.com/table.csv?s=YHOO&d=0&e=28&f=2010&g=d&a=3&b=12&c=1996&ignore=.csv](http://ichart.finance.yahoo.com/table.csv?s=YHOO&d=0&e=28&f=2010&g=d&a=3&b=12&c=1996&ignore=.csv)

本质上：

```
sn = TICKER
a = fromMonth-1
b = fromDay (two digits)
c = fromYear
d = toMonth-1
e = toDay (two digits)
f = toYear
g = d for day, m for month, y for yearly 
```

完整的参数列表：

```
a   Ask
a2  Average Daily Volume
a5  Ask Size
b   Bid
b2  Ask (Real-time)
b3  Bid (Real-time)
b4  Book Value
b6  Bid Size
c   Change & Percent Change
c1  Change
c3  Commission
c6  Change (Real-time)
c8  After Hours Change (Real-time)
d   Dividend/Share
d1  Last Trade Date
d2  Trade Date
e   Earnings/Share
e1  Error Indication (returned for symbol changed / invalid)
e7  EPS Estimate Current Year
e8  EPS Estimate Next Year
e9  EPS Estimate Next Quarter
f6  Float Shares
g   Day's Low
h   Day's High
j   52-week Low
k   52-week High
g1  Holdings Gain Percent
g3  Annualized Gain
g4  Holdings Gain
g5  Holdings Gain Percent (Real-time)
g6  Holdings Gain (Real-time)
i   More Info
i5  Order Book (Real-time)
j1  Market Capitalization
j3  Market Cap (Real-time)
j4  EBITDA
j5  Change From 52-week Low
j6  Percent Change From 52-week Low
k1  Last Trade (Real-time) With Time
k2  Change Percent (Real-time)
k3  Last Trade Size
k4  Change From 52-week High
k5  Percent Change From 52-week High
l   Last Trade (With Time)
l1  Last Trade (Price Only)
l2  High Limit
l3  Low Limit
m   Day's Range
m2  Day's Range (Real-time)
m3  50-day Moving Average
m4  200-day Moving Average
m5  Change From 200-day Moving Average
m6  Percent Change From 200-day Moving Average
m7  Change From 50-day Moving Average
m8  Percent Change From 50-day Moving Average
n   Name
n4  Notes
o   Open
p   Previous Close
p1  Price Paid
p2  Change in Percent
p5  Price/Sales
p6  Price/Book
q   Ex-Dividend Date
r   P/E Ratio
r1  Dividend Pay Date
r2  P/E Ratio (Real-time)
r5  PEG Ratio
r6  Price/EPS Estimate Current Year
r7  Price/EPS Estimate Next Year
s   Symbol
s1  Shares Owned
s7  Short Ratio
t1  Last Trade Time
t6  Trade Links
t7  Ticker Trend
t8  1 yr Target Price
v   Volume
v1  Holdings Value
v7  Holdings Value (Real-time)
w   52-week Range
w1  Day's Value Change
w4  Day's Value Change (Real-time)
x   Stock Exchange
y   Dividend Yield 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-06-22T10:51:54.167

我知道你想要“免费”，但如果我是你，我会认真考虑以大约 300 美元/年的价格从[csidata.com获取数据。](http://www.csidata.com/)

这是雅虎用来提供数据的。

它带有一个不错的 API，而且数据（据我所知）非常干净。

订阅后您将获得 10 年的历史记录，然后每晚更新一次。

他们还为您处理各种令人讨厌的事情，例如拆分和分红。如果你还没有发现数据清理的乐趣，你不会意识到你有多么需要这个，直到你的 ATS（自动交易系统）第一次认为某些股票真的很便宜，只是因为它分裂了 2 :1 你没有注意到。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-04-24T17:27:36.823

**简介：**
从 yahoo，您可以获得 EOD（一天结束）历史价格或实时价格。EOD 价格的下载非常简单。有关如何获取数据和 C# 代码示例的说明，请参阅[我的博客。](http://mlai-lirik.blogspot.com/)

我正在编写一个实时数据馈送“引擎”，它将实时价格下载并存储在数据库中。该引擎最初将能够从 Yahoo 和 Interactive Brokers 下载历史价格，并将能够将数据存储在您选择的数据库中：MS SQL、MySQL、SQLite 等。它是开源的，但我会发布更多当我接近发布它时（几天内）我的博客上的信息。

另一个选项是[eclipse trader](http://www.eclipsetrader.org/) ...它允许您以低至 1 分钟的粒度记录历史数据，并将价格本地存储在文本文件中。它基本上会延迟 15 分钟从雅虎下载实时数据。由于我想要一个更强大的解决方案，并且我正在开展一个需要数据的大型学校项目，因此我决定编写自己的数据馈送引擎（我在上面提到过）。

**示例代码：**
这是演示如何下载实时数据的示例 C# 代码：

```
public void Start()
{
    string url = "http://finance.yahoo.com/d/quotes.csv?s=MSFT+GOOG&f=snl1d1t1ohgdr";
    //Get page showing the table with the chosen indices
    HttpWebRequest request = null;
    IDatabase database =
        DatabaseFactory.CreateDatabase(
        DatabaseFactory.DatabaseType.SQLite);

    //csv content
    try
    {
        while (true)
        {
            using (Stream file = File.Create("quotes.csv"))
            {
                request = (HttpWebRequest)WebRequest.CreateDefault(new Uri(url));
                request.Timeout = 30000;
                using (var response = (HttpWebResponse)request.GetResponse())
                using (Stream input = response.GetResponseStream())
                {
                    CopyStream(input, file);
                }
            }
            Console.WriteLine("------------------------------------------------");
            database.InsertData(Directory.GetCurrentDirectory() + "/quotes.csv");

            File.Delete("quotes.csv");
            Thread.Sleep(10000); // 10 seconds
        }
    }
    catch (Exception exc)
    {
        Console.WriteLine(exc.ToString());
        Console.ReadKey();
    }
} 
```

**数据库：**
在数据库方面，我使用`OleDb`与 CSV 文件的连接来填充 a `DataSet`，然后通过 更新我的实际数据库`DataSet`，它基本上可以将 Yahoo 返回的 CSV 文件中的所有列直接匹配到您的数据库（如果您的数据库不支持批量插入 CSV 数据，例如 SQLite）。否则，插入数据是单行的......只需将 CSV 批量插入到您的数据库中。

您可以在此处阅读有关 url 格式的更多信息：http: [//www.gummy-stuff.org/Yahoo-data.htm](http://www.gummy-stuff.org/Yahoo-data.htm)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-04-16T03:13:40.600

纳斯达克和纽交所上每一个交易品种的数据集以一秒或一分钟为间隔将是**巨大的**。

假设共有 4000 家公司在两个交易所上市（这可能是非常低的，因为在纳斯达克上市的[公司超过 3200 家）。](http://en.wikipedia.org/wiki/Nasdaq)对于第二个时间间隔的数据，假设一天有 6.5 个交易小时，那么每家公司每天将提供 23400 个数据点，或者那一天总共有大约 93,600,000 个数据点。假设一年有 200 个交易日，那么仅一年就有大约 18,720,000,000 个数据点。

也许您想先从较小的集合开始？

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-01-04T15:48:42.807

纳斯达克为每个交易品种提供 10 年的 EOD 历史数据

[http://www.nasdaq.com/aspx/historical_quotes.aspx?symbol=AAPL&selected=AAPL](http://www.nasdaq.com/aspx/historical_quotes.aspx?symbol=AAPL&selected=AAPL)

您可以自动化下载此数据的过程。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-09-14T16:15:23.353

对于无幸存者偏差数据，我发现的唯一可靠来源是 QuantQuote ( [http://quantquote.com](http://quantquote.com) )

数据以分钟、秒或刻度分辨率提供，链接到他们的[历史股票数据](https://quantquote.com/historical-stock-data)。

上面有一个关于 kibot 的建议。在从他们那里购买之前，我会做一个快速的谷歌搜索，你会发现很多[这样](http://www.trade2win.com/boards/data-feeds/12433-historical-intraday-sources-2.html#post1086278)的帖子，其中包含有关 kibot 数据质量问题的警告。这也说明了他们所谓的无幸存者偏差 sp500 在 14 年内只有 570 个符号。这几乎是不可能的，sp500 每月变化 1-2*个*符号....

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-04-16T03:10:04.663

不幸的是，很难获得免费的历史股票数据。现在 opentick 已经死了，我不知道还有其他提供商。

在前世，我曾在一家拥有自动交易系统的对冲基金工作，我们大量使用历史数据。

我们使用 TickData 作为我们的源。他们的价格是合理的，并且数据具有亚秒级的分辨率。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-09-21T01:37:38.367

让我添加一个我刚刚发现的来源，在[这里](http://cs.brown.edu/~pavlo/stocks/)找到。

它有大量 csv 格式的历史股票数据，由 Andy Pavlo 收集，根据他的主页，他是“卡内基梅隆大学计算机科学系的助理教授”。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-12-30T09:25:34.740

我们从[Kibot.com](http://www.kibot.com/ "基博特")购买了 12 年的日内数据，对质量非常满意。

至于存储要求：所有美国股票（超过 8000 个品种）的 12 年 1 分钟数据约为 100GB。

与逐笔报价数据情况略有不同。如果您只记录时间和销售额，那么对于所有美国股票来说，这将是每月大约 30GB 的数据。如果您想将出价/要价更改与交易一起存储，您可以期望每月大约 150GB。

我希望这有帮助。如果还有什么我可以帮助您的，请告诉我。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-12-29T13:34:20.060

Mathematica nowoadays 还提供对当前和历史股票价格的访问 ，如果您碰巧有它的副本，请参阅[http://reference.wolfram.com/mathematica/ref/FinancialData.html 。](http://reference.wolfram.com/mathematica/ref/FinancialData.html)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-16T03:23:46.923

您可以使用 yahoo 获取每日数据（更易于管理的数据集），但您必须构建 url。请参阅此[链接](http://www.gummy-stuff.org/Yahoo-data.htm)。你没有提出很多小请求，而是提出了更少的大请求。许多免费软件都使用它，因此它们不应该让您失望。

编辑：[这个](http://www.yloader.com/ "这个")人做到了，也许你可以看看他的软件所做的调用。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-11-15T08:05:46.183

雅虎是获得初步免费数据的最简单选择。eckesicle 的答案中描述的链接可以很容易地在 python 代码中使用，但你首先需要所有的代码。我会在这个例子中使用纽约证券交易所，但这也可以用于不同的交易所。

我使用[这个 wiki 页面](http://en.wikipedia.org/wiki/Companies_listed_on_the_New_York_Stock_Exchange_%28A%29)下载了所有带有以下脚本的公司代码（我不是一个非常有才华的 Python 专家，如果这段代码效率不高，很抱歉）：

```
import string
import urllib2
from bs4 import BeautifulSoup

global f

def download_page(url):
    aurl = urllib2.urlopen(url)
    soup = BeautifulSoup(aurl.read())

    print url

    for row in soup('table')[1]('tr'):
        tds = row('td')
        if (len(tds) > 0):
            f.write(tds[1].string + '\n')

f = open('stock_names.txt', 'w')

url_part1 = 'http://en.wikipedia.org/wiki/Companies_listed_on_the_New_York_Stock_Exchange_'
url = url_part1 + '(0-9)'
download_page(url)

for letter in string.uppercase[:26]:
    url_part2 = letter
    url = url_part1 + '(' + letter + ')'

    download_page(url)

f.close() 
```

为了下载每个代码，我使用了另一个非常相似的脚本：

```
import string
import urllib2
from bs4 import BeautifulSoup

global f

url_part1 = 'http://ichart.finance.yahoo.com/table.csv?s='
url_part2 = '&d=0&e=28&f=2010&g=d&a=3&b=12&c=1996&ignore=.csv'

print "Starting"

f = open('stock_names.txt', 'r')
file_content = f.readlines()
count = 1;
print "About %d tickers will be downloaded" % len(file_content)

for ticker in file_content:
    ticker = ticker.strip()
    url = url_part1 + ticker + url_part2

    try:
        # This will cause exception on a 404
        response = urllib2.urlopen(url)

        print "Downloading ticker %s (%d out of %d)" % (ticker, count, len(file_content))

        count = count + 1
        history_file = open('C:\\Users\\Nitay\\Desktop\\Historical Data\\' + ticker + '.csv', 'w')
        history_file.write(response.read())
        history_file.close()

    except Exception, e:
        pass

f.close() 
```

请注意，此方法的主要缺点是不同的公司可以使用不同的数据 - 在请求的日期（新列出的）中不存在数据的公司将为您提供 404 页面。

还要记住，这种方法只适用于初步数据——如果你真的想测试你的算法，你应该花一点钱并使用像 CSIData 或其他人这样的可信数据供应商

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-08-10T00:13:54.060

我使用 eodData.com。它的价格相当合理。每月只需​​ 30 美元，您就可以获得所有美国交易所的 30 天 1.5 和 60 分钟柱状图，以及大多数其他交易所的 1 年 EOD 数据。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-06-04T08:36:28.967

为什么不用布朗运动来模拟一个假股票市场呢？

有足够的资源来做这件事。易于实施。

[http://introcs.cs.princeton.edu/java/98simulation/](http://introcs.cs.princeton.edu/java/98simulation/)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-04-16T03:12:04.130

我会抓取finance.google.com（获取报价）- 或finance.yahoo.com。

这两个都将为世界各地的大多数交易所返回 html 页面，包括历史。然后，只需解析 HTML 以提取您需要的内容。

我过去做过这件事，取得了巨大的成功。或者，如果您不介意使用 Perl - CPAN 上有几个模块可以为您完成这项工作 - 即从 Google/Yahoo 中提取报价。

有关更多信息，请参阅[报价历史](http://search.cpan.org/~msisk/Finance-QuoteHist-1.11/lib/Finance/QuoteHist.pm)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-08-25T06:15:10.393

我以前的一个项目将使用从[EODData](http://www.eoddata.com/Products/WebService.aspx)可免费下载的数据。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-10-18T23:17:24.737

查看 Mergent 历史证券数据 API - [http://www.mergent.com/servius](http://www.mergent.com/servius)

# asp.net-mvc - 如何将动作名称注入母版页以突出显示导航菜单中的当前动作？

> ID：754606
> 
> 赞同：1
> 
> 时间：2009-04-16T03:08:48.787
> 
> 标签：asp.net-mvc

我正在尝试找到一个解决方案（不使用 javascript）来解决这个问题：

我有一个包含**导航菜单的****母版页**。该菜单中的每个项目都是一个操作。

 **当用户选择该操作并转到该视图时，我想在导航菜单中突出显示该项目，以向用户指示他们当前正在查看的内容。

我可以将动作名称添加到基本视图模型（从中派生出我所有其他视图模型），但想知道是否有更好的方法。

（我已经可以看到，当这是 MVC 时，会出现一些复杂性。对于给定的操作，可以返回任意数量的不同视图，因此所有这些视图都需要在导航菜单中突出显示相同的操作。好的）。

想法？

PS我刚刚注意到stackoverflow与上面菜单上的橙色突出显示类似。我看到他们用“youarehere”这个类做标记。他们采取了什么方法我想知道...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-25T15:21:32.927

我所做的是：我创建了自己的帮助程序，称为 RenderMenuLink，而不是调用

```
<li><%= Html.ActionLink("Home", "index", "home")%></li> 
```

我调用

```
<%= Html.RenderMenuLink("Home", "index", "home")%> 
```

这反过来又添加了一个链接，如果**用户正在访问此链接**[1]，“选定”类将附加到列表项的“类”属性。

[1]：我通过检查用户所在的 URL 是否与此链接生成的 URL 匹配来实现此功能。代码粘贴在下面：

* * *

```
 public static class HtmlMenu
    {
        public static string RenderMenuLink(this HtmlHelper html, string title, string action, string controller)
        {
            UrlHelper url = new UrlHelper(html.ViewContext.RequestContext);
            string link = url.Action(action, controller);
            if(String.IsNullOrEmpty(link))
            {
                throw new ArgumentException("No appropriate route found!");
            }

            var cssClass = String.Empty;
            var uriPath = html.ViewContext.RequestContext.HttpContext.Request.Url.AbsolutePath;
            if((link != "/" && uriPath.StartsWith(link)) || (uriPath == link))
            {
                cssClass = "selected";
            } 
            return String.Format("<li class=\"{0}\"><a href=\"{1}\">{2}</a></li>", cssClass, link, title);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T03:12:23.020

您可以使用 CSS 来实现这一点。如果您知道要突出显示的项目的 ID，请在视图中添加 CSS 规则...

```
#MenuId 
{
color: ...;
etc...
} 
```

澄清一下：
在您的母版页头部添加一个占位符，然后在您的视图中动态添加一个样式部分......

在母版页中：

```
<head id="Head1" runat="server">   
<asp:ContentPlaceHolder ID="head" runat="server">

</asp:ContentPlaceHolder>
</head> 
```

在视图中

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
<style type="text/css">
  #<%= Model.IdToHighlight %>
  {
      color:Blue;//or something
  }
</style>
</asp:Content> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T06:23:39.097

我建议你从 mvc 设计库中获取“橙色标签”模板并查看它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T03:36:02.043

> 当用户选择该操作并转到该视图时，我想在导航菜单中突出显示该项目，以向用户指示他们当前正在查看的内容。

您可以使用 html 辅助方法生成菜单，并且当您生成它时，您可以将一个类添加到与当前操作相关的菜单项。

它可以通过一个参数来完成，或者使用[这里](https://stackoverflow.com/questions/362514/aspnet-mvc-current-action)描述的一些方法。

**但**我认为最有效的方法是使用 javascript，而你拥有的第二好的选择是 markt 写的。

# javascript - jQuery 可以获取与元素关联的所有 CSS 样式吗？

> ID：754607
> 
> 赞同：302
> 
> 时间：2009-04-16T03:08:48.943
> 
> 标签：javascript, jquery, css

jQuery中有没有办法从现有元素中获取所有CSS并将其应用于另一个而不列出它们？

我知道如果它们是带有 的样式属性，它会起作用`attr()`，但是我所有的样式都在外部样式表中。

* * *

## 回答 #1

> 赞同：344
> 
> 时间：2011-04-29T09:46:32.023

晚了几年，但这是一个检索内联样式和外部样式的解决方案：

```
function css(a) {
    var sheets = document.styleSheets, o = {};
    for (var i in sheets) {
        var rules = sheets[i].rules || sheets[i].cssRules;
        for (var r in rules) {
            if (a.is(rules[r].selectorText)) {
                o = $.extend(o, css2json(rules[r].style), css2json(a.attr('style')));
            }
        }
    }
    return o;
}

function css2json(css) {
    var s = {};
    if (!css) return s;
    if (css instanceof CSSStyleDeclaration) {
        for (var i in css) {
            if ((css[i]).toLowerCase) {
                s[(css[i]).toLowerCase()] = (css[css[i]]);
            }
        }
    } else if (typeof css == "string") {
        css = css.split("; ");
        for (var i in css) {
            var l = css[i].split(": ");
            s[l[0].toLowerCase()] = (l[1]);
        }
    }
    return s;
} 
```

传入一个 jQuery 对象`css()`，它将返回一个对象，然后您可以将其插入 jQuery 中`$().css()`，例如：

```
var style = css($("#elementToGetAllCSS"));
$("#elementToPutStyleInto").css(style); 
```

:)

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2011-06-20T19:41:32.293

晚了两年，但我有你正在寻找的解决方案。不打算从[原作者](http://upshots.org/?p=192)那里获得荣誉，这是一个插件，我发现它非常适合您的需求，但可以在所有浏览器中获得**所有**可能的样式，甚至是 IE。

**警告：**此代码会产生大量输出，应谨慎使用。它不仅复制所有标准 CSS 属性，还复制该浏览器的所有供应商 CSS 属性。

`jquery.getStyleObject.js:`

```
/*
 * getStyleObject Plugin for jQuery JavaScript Library
 * From: http://upshots.org/?p=112
 */

(function($){
    $.fn.getStyleObject = function(){
        var dom = this.get(0);
        var style;
        var returns = {};
        if(window.getComputedStyle){
            var camelize = function(a,b){
                return b.toUpperCase();
            };
            style = window.getComputedStyle(dom, null);
            for(var i = 0, l = style.length; i < l; i++){
                var prop = style[i];
                var camel = prop.replace(/\-([a-z])/g, camelize);
                var val = style.getPropertyValue(prop);
                returns[camel] = val;
            };
            return returns;
        };
        if(style = dom.currentStyle){
            for(var prop in style){
                returns[prop] = style[prop];
            };
            return returns;
        };
        return this.css();
    }
})(jQuery); 
```

基本用法非常简单，但他也为此编写了一个函数：

```
$.fn.copyCSS = function(source){
  var styles = $(source).getStyleObject();
  this.css(styles);
} 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-16T03:25:26.313

为什么不使用[`.style`DOM 元素](http://www.w3schools.com/jsref/dom_obj_style.asp)？它是一个包含 和 等成员的`width`对象`backgroundColor`。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-09-24T09:11:43.563

我尝试了许多不同的解决方案。这是唯一对我有用的，因为它能够获取在类级别应用的样式和直接归因于元素的样式。所以在css文件级别设置一个字体，一个作为样式属性；它返回了正确的字体。

很简单！（对不起，找不到我最初找到它的地方）

```
//-- html object
var element = htmlObject; //e.g document.getElementById
//-- or jquery object
var element = htmlObject[0]; //e.g $(selector)

var stylearray = document.defaultView.getComputedStyle(element, null);
var font = stylearray["font-family"] 
```

或者，您可以通过循环遍历数组来列出所有样式

```
for (var key in stylearray) {
console.log(key + ': ' + stylearray[key];
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-12-16T21:07:24.253

@marknadal 的解决方案并没有为我获取带连字符的属性（例如`max-width`），而是更改了第一个`for`循环`css2json()`使其工作，我怀疑执行的迭代次数更少：

```
for (var i = 0; i < css.length; i += 1) {
    s[css[i]] = css.getPropertyValue(css[i]);
} 
```

循环通过`length`而不是`in,`检索通过`getPropertyValue()`而不是`toLowerCase().`

# javascript - 为什么我的 setTimeout() 调用不起作用？

> ID：754615
> 
> 赞同：0
> 
> 时间：2009-04-16T03:11:56.267
> 
> 标签：javascript, ajax

有人知道下面的代码出了什么问题吗？系统只会`getProgressMsg()`在 Ajax 完成后调用 :(

```
function ajax_action(action)
{
    setTimeout('getProgressMsg()',2000);

    xmlHttp=GetXmlHttpObject();

    if (xmlHttp==null)
    {
        alert ("Browser does not support HTTP Request")
        return
    }

    var url="admin.php"
    url=url+"?action=admin"
    url=url+"&sid="+Math.random()

    xmlHttp.onreadystatechange=stateChanged;

    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);

}

function getProgressMsg()
{
    xmlHttp2=GetXmlHttpObject2();

    if (xmlHttp2==null)
    {
        alert ("Browser does not support HTTP Request")
        return
    }

    var url2="admin.php"
    url2=url2+"?action=getMsg"
    url2=url2+"&sid="+Math.random()

    xmlHttp2.onreadystatechange=stateChanged2;
    xmlHttp2.open("GET",url2,true);
    xmlHttp2.send(null);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:18:15.783

### 一些想法...

1.  您有两秒钟的超时时间。您确定第一个 AJAX 请求花费的时间比这更长吗？
2.  所有 JavaScript（包括事件处理程序）都是单线程的。如果你在忙`stateChanged()`，那么`getProgressMsg()`在你回来之前不会被叫到。
3.  除了发出另一个 AJAX 请求之外，您什么也没做`getProgressMsg()`- 您确定这不仅仅是被浏览器或 Web 服务器排队等待它不会完成处理，直到第一个完成？

### 建议：

*   尝试用`getProgressMsg()`简单的调用替换代码`alert()`。然后把延迟从2000减少到200，看看是不是马上就出现了。
*   验证您没有在`stateChanged()`.
*   检查您的服务器端代码...验证您在处理处理第二个所需的第一个请求时没有保留资源。

# javascript - 我应该在学习 Javascript 之前学习 C 吗？

> ID：754622
> 
> 赞同：6
> 
> 时间：2009-04-16T03:17:10.950
> 
> 标签：javascript, c

在学习任何类型的 WEB 和桌面编程之前学习**C**会更好吗？

我不会编程，想学Javascript，朋友建议我先学**C。**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-16T03:22:26.693

不。

JavaScript 可能是有史以来最笨拙的语言之一，但与 C 相比，它有一个巨大的优势：您可以*使用*它。（我用 C 语言编码了 10 多年。我玩得很开心，但我从不把我所做的事情称为“玩”。）

我的建议：打开您最喜欢的网页，将其保存到磁盘，打开 JavaScript（或下载，如果需要），然后播放。这样你会学到很多东西。

**编辑**： Downvoters：是的，JavaScript 有很多值得喜欢的地方。但也有很多*不*喜欢的地方。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-16T03:32:44.047

如果您的目的是学习 Javascript，请立即从 Javascript 开始。C 语言为您带来了很多通用知识，但对于 Web 编程，最好从 HTML 和 Javascript 开始。你需要回答自己这个问题：“我可以花多少时间才能通过编程赚钱？”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T04:06:49.550

我实际上认为 JavaScript 是开始编程的最佳语言之一。后来，当你真正了解它并且想要更深入时，了解 C 是一件很棒的事情。它使您对计算机的实际工作方式有更深入的了解。

JavaScript 真的可以让你快速上手，看到立竿见影的效果，并且非常流畅地提升到更复杂的概念。

我的其余答案假设您对编程几乎一无所知 - 网络或其他。也许你知道一点 html 基础知识。

打开一个文本编辑器。你甚至可以从记事本或其他东西开始。并输入以下内容：

```
<html>
    <head>
        <script>
            alert("Hello, World!");
        </script>
    </head>
    <body></body>
 </html> 
```

将文件另存为 hello.html 并在浏览器中打开它。噗！你写了一个程序。没有比这更容易的了。无需进入命令行或下载或构建任何东西。我记得当我第一次尝试让 PHP 在我的机器上运行时感到沮丧，并希望它像开始使用 JavaScript 一样简单。

下一步只是阅读和探索。文档可免费获得，以供了解更多信息。我强烈推荐[Douglas Crockford](https://rads.stackoverflow.com/amzn/click/com/0596517742)和[JavaScript:The Definitive Guide](https://rads.stackoverflow.com/amzn/click/com/0596101996)中的任何内容。

一个很好的基础项目是计算器程序，但你可以做很多有趣的事情。当你的脚湿透了，并且你感觉更有信心了，就去探索一些其他的语言。Ruby 是 JavaScript 的一个很好的步骤。到那时，您可能会知道自己该去哪里。你可能永远不会走上学习 C 的道路。即使你学会了它，你也可能永远不会真正需要使用它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-16T04:19:04.903

不要选择一种语言来开始学习。

选择一个解决简单问题的项目，然后选择合适的语言来解决这个问题。

如果您想启动一个简单的 Web 应用程序，那么学习 Javascript 而不是 C 是一个不错的方法。

如果您想学习编写桌面应用程序，那么 Javascript 绝对是错误的方法。

顺便说一句，如果您正在学习 Web 应用程序，那么您需要学习 HTML 和某种 Web 应用程序后端语言（不会是 C！）。在这种情况下，Javascript 也将是最少的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-16T04:03:18.950

我认为这取决于你的动机——你的目标是成为一名专业的程序员吗？如果是这样，那么首先学习 C 可能会有一些价值。

大学的大多数入门级编程科目都是用 C 语言教授的；它可以让您更深入地了解软件的工作原理。此外，[K&R](https://rads.stackoverflow.com/amzn/click/com/0131103628 "K&R")本身就是一本有价值的编程手册。

如果您的目标是创建一组简单的 DHTML 页面，那么请务必直接使用 JavaScript。但是，如果您对编程很认真，我认为 C 可以为您提供很多东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T03:23:42.650

不，绝对不是。学习一种易于学习的语言，例如 Python 或 Ruby，它们带有一个交互式解释器/shell，您可以在其中玩耍。您不必保存任何文件或刷新任何浏览器，只需在命令行上执行即可。我认为最好的学习方式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-16T03:23:52.930

C 是一门难学的语言，尤其是对于初学者来说，因为它比许多其他语言“更接近机器”，并且对 Web 开发框架/模型几乎没有影响

现在，如果您确实学习了 C，那么其他一切似乎都很容易；-)

我会从 python 或 C# 或有更多护栏的东西开始

祝你好运！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-16T03:25:06.000

当然不。

C 是一种很棒的语言，可以用于很多事情，但它的运行水平太低，无法满足 Web 和桌面软件的许多需求。在编写代码时，您希望专注于使您的应用程序在其域中的其他应用程序中独一无二的原因。您不想处理很多不直接相关的细节。用于编写 Web 和桌面应用程序的语言有好有坏，它们可以让您更快地完成所需的工作。它们可能不那么优雅，但它们会首先将您带到您想要的地方。

C 对于了解事物在表面下的工作方式很重要，但它不应该是首要任务。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-16T03:51:47.480

由于你不会编程，所以我同意这里的建议，你从 Python 或 Ruby 等开始。先学习一些基本的概念或编程，看看你是否喜欢。如果你不太喜欢它，那么只学习你认为你需要的东西。如果您**喜欢**编写程序，那么请继续使用 Python/Ruby，但至少要让自己熟悉 C。在 C 中足够自如，可以编写适度的程序，并且绝对足以阅读别人的 C 代码。那里有很多 C 代码，而且一直在编写更多代码。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-16T03:24:45.223

不。尽管 C 包含超越大多数现代语言的原始功能和灵活性，但在过渡到其他语言时，学习 C 并不会给您带来太多优势。在开始使用 C++ 编程之前，我使用过 C#、ASP.net 和 javascript。对于初学者来说，从 C# 或 java 之类的语言开始可能会更好，因为它可以让您不必担心程序的大部分核心功能（如内存管理、数据结构等），但这肯定会很棒如果您在学习过程中可以学习 C 和 C++（甚至是汇编），那么您将获得优势。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-16T03:46:34.110

一点也不。

如果您已经使用 HTML，并且想使用 JavaScript 将其提升到一个新的水平，那么就去做吧。阅读 w3schools，Douglas Crockford 的文章，大量的示例代码。那，应该足以让你滚动。

另一方面，但不要着急，用 PHP、Python 和 Java 或 C 做实验。也许你不会使用它们中的任何一个，但它确实会让你成为一个更好的程序员。

OTOH，如果您想成为一名真正的开发人员，您必须了解 C；但你不必从那里开始。我会说从一两种“简单”语言（JavaScript、Lua、Python）开始，然后是 C/C++ *，*然后根据您选择的路径采用其他方式。从那里开始的最好的三种途径是（主观地，在我自己看来，等等）：

1.  脚本：Python、Lua、Scheme
    *   网络：“深度”JavaScript、Java、PHP、Python
    *   核心编程：更多 C++、LISP、Haskell

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-16T04:24:41.507

如果你有任何意图创造一些有用的东西，也就是说，不仅仅是一种爱好，是的，首先学习 C，或者在花时间告诉他们该做什么之前，最好花一些时间学习现代计算机体系结构的实际工作原理。

可以说 javascript 与 C 几乎没有任何关系，但 C 将迫使您了解事物的真正工作原理，因此提供对性能、数据存储的宝贵洞察，并教您调用一些可能的随机库调用时实际发生的情况执行所需的时间比它需要的时间多出许多数量级。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-13T22:09:51.617

先学C++（新版C）是最好的，至少对我来说是这样，因为它让我对计算机有了一个大致的了解，而且一旦我学会了C++，其他所有的语言，像Java、PHP，甚至是javascript都很容易学到了。

如果您对计算机的工作原理不感兴趣，只想进入有趣的设计部分，请从 HTML/CSS 开始，然后是 javascript。

希望有帮助！

# c# - 单步执行 .NET Framework 源代码？

> ID：754624
> 
> 赞同：4
> 
> 时间：2009-04-16T03:18:08.093
> 
> 标签：c#, .net

我不知道如何表达这个问题，但我想在代码通过 .NET 类/方法等时单步执行它。

早些时候，我曾询问如何查看 .NET 库中类的代码，最后我得到了 .NET Reflector，我立即下载了它。现在，作为一个例子，我正在寻找更多信息。

我的程序中有一个方法，如下所示：

```
public bool DoThisJob(string job)
{
  if (jobsICanDo.Contains(job))
           return true;
} 
```

其中 jobsICanDo 是一个包含不同作业的字符串数组。

当我执行该代码时，“包含（作业）”方法，我希望能够单步执行代码，因为它一直通过涉及返回结果的 .NET 库和类。

简而言之，我是一个菜鸟，我想了解所有库的工作原理。我不只是想接受它有效并继续前进。

我现在的具体问题是，我有 .NET Reflector 并且可以查看所有 .NET 库中的代码，有没有办法让我真正看到这些代码在运行中并观察我的输入遍历 .NET 库和类？

编辑对于我正在寻找的东西，似乎至少有点困惑。我在 if (jobsICanDo.Contains(job)) 处设置了一个断点。我运行我的程序，它会做它的事情，当它到达那里时它会停止。当进入下一行代码时，它只会返回 true 并继续运行。我想做的是看看 Contains 方法在做什么，就像我的代码的其余部分一样。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-16T03:30:20.950

是的，使用调试器，但请参阅[配置 Visual Studio 以调试 .NET Framework 源代码](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T03:32:39.790

在 Visual Studio .Net 2008 中选择 Tools->Options 并勾选 Debugging->General->Enable .Net Framework source Stepping。

您需要连接到 Internet，以便下载符号文件。

# sql-server-2005 - 为什么我在我的 sql server 2005 中找不到 syslanguages 表？

> ID：754628
> 
> 赞同：0
> 
> 时间：2009-04-16T03:19:09.073
> 
> 标签：sql-server-2005

据说这张表包含在'master'中，但我找不到它。有人知道原因吗？如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T14:11:48.837

让我纠正你。syslanguages 不是表格；它是一个系统视图。谢谢！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T03:24:28.263

好吧，我自己找到了答案实际上它包含在主数据库中但是我们不能直接看到它。我们必须使用 master 并从 master.sys.syslanguges 中选择 * 就完成了！

# javascript - 用于加密-解密 html 文件的 JavaScript

> ID：754633
> 
> 赞同：0
> 
> 时间：2009-04-16T03:23:42.183
> 
> 标签：javascript

我有一个包含数千个 html 文件的文件夹。我希望最初所有这些 html 文件都应该是加密的形式，当调用 paticuler html 时，它应该被解密并应该在浏览器中打开，然后当下一个 html 被调用时，之前解密的 html 应该被删除或再次加密. ww 可以做到这一点以及如何做到这一点？并告诉我 JavaScript 代码加密 - 解密 html。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T03:25:28.653

无需使用 JavaScript 加密或解密，使用 HTTPS 和证书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T03:29:18.143

我不确定您要完成什么，但这是您要查找的库：

*   [http://www.farfarfar.com/scripts/encrypt/](http://www.farfarfar.com/scripts/encrypt/)

将来自服务器的 HTML 解密为编码...

然后使用 $ 函数在 HTML 中添加 jQuery。请注意，这将是完全不安全的，因为密钥/密码将在浏览器的某处传递或显示，甚至在某些时候甚至是 HTML。

# linq-to-sql - 抽象类中的分部方法 (C#)

> ID：754643
> 
> 赞同：1
> 
> 时间：2009-04-16T03:25:16.687
> 
> 标签：linq-to-sql, inheritance, abstract-class, implementation, partial-classes

我正在创建一个可以在 LINQ to SQL 类的部分类中继承的抽象类。LINQ to SQL 类包含一堆内置的分部方法。有没有一种方法可以实现抽象类中的一个或多个部分方法？我知道部分方法只能包含在部分类或结构中。我确信必须有另一种方法来做到这一点。

这里有更多细节：

*   我可能有一个名为 News 的数据库表。如果我创建一个包含此表的 LINQ to SQL dbml 文件，自动生成的代码会为 News 生成一个部分类。
*   这个分部类包含几个分部方法。
*   我有一个正在构建的类，其中包含我想在我的所有 LINQ to SQL 类中使用的几种方法。
*   其中一种方法是添加到每个 LINQ to SQL 类的部分方法。我有一个共同的身体可用于这种方法。与其将这个方法添加到每个部分类中，我正在寻找一种方法来创建它一次并使用我的基类继承来继承它。

希望这有助于解释更多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:50:07.890

部分方法不能用于继承。您可以将常规方法添加到抽象基类，但它们不会自动与部分方法声明“配对”。所以不行。当然，您可以简单地将部分方法实现调用到基类中。

另请注意，如果公共代码涉及诸如审计（谁/何时）之类的东西，您也可以通过覆盖`DataContext`'`SubmitChanges`方法并调用来做到这一点`GetChangeSet`：

```
 public override void SubmitChanges(ConflictMode failureMode)
    {
        ChangeSet delta = GetChangeSet();
        //... use delta.Updates, delta.Inserts and delta.Deletes
        base.SubmitChanges(failureMode);
    } 
```

最后，请注意，您还可以为 dbml 中的所有实体指定一个公共基类（[就像这样](https://stackoverflow.com/questions/411515/way-to-automatically-add-a-linqtosql-base-class-to-entities/411903#411903)）；您不必在每个部分课程中手动完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T03:49:55.397

我想我明白你想做什么，但如果没有，请告诉我。您可以使您的抽象基类部分化并将您想要的实现拉到该类中。或者，您可以使用抽象类并封装您希望子类可以访问的功能。

# sql - sql 限制唯一记录

> ID：754648
> 
> 赞同：1
> 
> 时间：2009-04-16T03:26:11.943
> 
> 标签：sql, mysql, limit

我有一个可能有大约 100 条记录的表，带有一个用户名字段。可能有许多具有相同用户名的记录。无论是哪条记录，我如何确保每个用户名只返回一条记录？

例如下表

```
users

username    item    firstname   lastname
-------------------------------------------------
superhans   shoes   super       hans
jez         hat     jeremy      sisto
jez         book    jeremy      sisto
flinto      train   fred        flintstone
superhans   shirt   super       hans 
```

只会返回以下内容：

```
username    item    firstname   lastname
-------------------------------------------------
superhans   shoes   super       hans
jez         hat     jeremy      sisto
flinto      train   fred        flintstone 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T03:33:44.827

如果您不想在结果中返回 item 字段，则可以使用**DISTINCT**：

从用户中选择不同的用户名、名字、姓氏

如果要包含 item 字段，则必须执行以下操作：

```
SELECT t.username, 
   (SELECT TOP 1 item FROM users WHERE username = t.username) AS item,
   t.firstname,
   t.lastname
FROM (
  SELECT DISTINCT username, item, firstname, lastname
  FROM users
 ) AS t 
```

使用这样的查询没有多大意义。您能否更具体地说明您要实现的目标？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T03:59:24.280

在 MySQL 5 中（你没有提到，但你已经标记了这个问题 mysql，所以我假设）你可以：

```
SELECT *
FROM users
GROUP BY username 
```

您将为每个用户返回任意行

请参阅[Mysql Refman 11.11.3](http://dev.mysql.com/doc/refman/5.0/en/group-by-hidden-columns.html)：

> MySQL 扩展了 GROUP BY 的使用，以便您可以使用 SELECT 列表中未出现在 GROUP BY 子句中的非聚合列或计算。[...] 如果您从 GROUP BY 部分省略的列在组中不是恒定的，请不要使用此功能。服务器可以自由地从组中返回任何值，因此除非所有值都相同，否则结果是不确定的。

实际上，考虑一下，您可能想要做

```
SELECT username, GROUP_CONCAT(DISTINCT item), whatever
FROM users
GROUP BY username 
```

这将为您提供他们*所有*项目的列表。取决于您首先想要任意行的原因。

-----N

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T03:29:44.930

首先，应该构建和维护您的表，以使这种状态不会发生。曾经。

其次，我认为你想要的是`SELECT DISTINCT`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T03:29:11.013

```
SELECT DISTINCT username, item, firstname FROM users 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T03:34:14.997

最好将用户名存储在名为 users 的表中并使用名为 user_id 的唯一 id 字段。

然后使用 user_id 作为外键将数据存储在与用户相关的表中……例如购买、用户信息等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T03:36:27.207

使用户名成为您的主键 - 这样，您可以确保唯一性

# configuration - 我是否需要运行 Boost 的配置脚本来构建库（例如图形、测试）？

> ID：754653
> 
> 赞同：0
> 
> 时间：2009-04-16T03:29:31.793
> 
> 标签：configuration, boost

如果我不想安装 Boost 但我想构建其中一个库（即 BGL，用于使用 graphml），有没有一种方法可以在不运行*.configure*的情况下以独立于系统的方式构建库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T12:25:25.680

简短的回答是：这取决于。

我只是尝试将相关资源复制到您的项目并构建它们。Boost 非常擅长支持这类事情，因为它不太依赖于配置，而是依赖于编译器/平台特定的定义来整理它所构建的平台。

我怀疑像 BGL 这样的东西甚至会是一个更好的候选者，而像线程代码这样高度依赖平台的代码就不能正常工作了。话虽如此，我知道至少有一个项目可以成功地将 boost 的线程代码和精神复制到它自己的存储库中，而且它的工作原理就像一个魅力。

我只是试一试，看看会发生什么。

# hash - 可以只使用 64 位的 sha1 哈希作为 id 吗？

> ID：754657
> 
> 赞同：6
> 
> 时间：2009-04-16T03:31:01.290
> 
> 标签：hash, sha1

1) 出于真正低哈希冲突的目的，我可以只使用 sha1 的 128 位中的一半而不是处理 sha1 本身吗？我知道这不适合加密哈希，但我只需要哈希表键的哈希。

2）计算时间不是优先事项，除此之外我正在散列非常小的数据。特别是，我主要会采用 2 或 3 个 64 位散列并对它们进行散列以获得另一个 64 位散列。为此目的，是否有比 sha1 更好的选择？同样，碰撞应该是非常不可能的。

3）我是一个sql新手。在 sql 中使用 64 位哈希作为 id 是个好主意吗？64 位 id 会在 sqlite 或 postgres 中导致性能问题吗？我将需要跨多个数据库（包括 Lucene 索引）协调数据，所以我认为我应该直接在表中处理哈希，而不是使用自动递增的 id（这只会在一个 db 中有意义，而不是跨所有数据存储）。我认为 64 位是一个很好的折衷方案：对于不太可能发生的冲突来说足够大，但可以节省空间（和查找时间？）。

4) CRC-64 怎么样？这会产生足够随机的分布吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T04:04:18.637

如果您的记录足够少，则几乎可以肯定您永远不会发生 64 位哈希冲突。您很可能会属于这一类。

*修剪像 sha1 这样的加密哈希应该*没有问题，因为如果哈希中有内部结构，那么它就不足以成为加密哈希，如果没有结构，那么比特的任何子集都应该是相当随机。请注意，我只是在谈论将其用于 ID，而不是用于任何加密目的！

但实际上，您的 SQL 没有某种 GUID 吗？如果是这样，为什么不使用它呢？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T03:41:27.833

为了更好地比较散列的长度，请查看[http://en.wikipedia.org/wiki/List_of_hash_functions](http://en.wikipedia.org/wiki/List_of_hash_functions)

另外，请注意：SHA-1 是 160 位，而不是 128。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T03:49:04.430

您的密钥将需要绝对唯一性，而不是唯一性的高概率。我建议使用 GUID 而不是散列作为您的密钥，以实现跨数据库兼容性。生成散列作为一种快速查找机制——你可以有一个非唯一的索引——但在发生冲突的情况下，你必须比较实际数据以确保它们是相同的。在同步数据库时，您可以检查哈希（快速使用索引），如果发现冲突，则解析数据是否相同，因此需要解析 GUID。如果没有冲突，则只需更新需要丢失条目的数据库并使用来自其他数据库的 GUID 插入。

我也认为创建自己的哈希值以节省空间没什么意义。如果您已经有其他哈希，只需使用它们（追加，不要重新哈希）。如果没有，只需使用标准哈希函数（如 MD5 或 SHA1）并存储结果数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-25T10:39:09.387

使用 64 位哈希，您有 1% 的机会与 6.1 × 10 ⁸条记录发生冲突。[（对于其他组合，请参阅有关生日问题](http://en.wikipedia.org/wiki/Birthday_problem#Probability_table)的 Wikipedia页面。）您可以丢弃每第二位的前 64 位或最后一位，这对散列的属性没有任何影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T03:38:36.607

如果计算时间不重要，为什么不使用整个 128 位呢？除了可能的存储问题之外，还有什么真正的理由选择 64 位？（然后额外的 8 个字节不会因为如此便宜的存储而杀死你）

64 位与 128 位在 SQLite 中不会导致速度问题，我不确定 mySQL。

# c# - HttpRuntime.Cache 最佳实践

> ID：754661
> 
> 赞同：20
> 
> 时间：2009-04-16T03:32:14.813
> 
> 标签：c#, httpruntime.cache

过去，我锁定了访问 HttpRuntime.Cache 机制。我不确定我过去是否真的研究过这个问题并且盲目地用锁包围了它。

你觉得这真的有必要吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-02-25T00:07:39.717

本文建议应使用锁：

[http://msdn.microsoft.com/en-us/magazine/cc500561.aspx](http://msdn.microsoft.com/en-us/magazine/cc500561.aspx)

引用：

> 问题是，如果您有一个需要 30 秒的查询，并且您每秒都在执行该页面，那么在填充缓存项所需的时间内，将会有 29 个其他请求进入，所有这些请求都将尝试填充缓存项与他们自己对数据库的查询。为了解决这个问题，您可以添加一个线程锁来阻止其他页面执行从数据库中请求数据。

这是他们的代码片段：

```
// check for cached results
object cachedResults = ctx.Cache["PersonList"];
ArrayList results = new ArrayList();

if  (cachedResults == null)
{
  // lock this section of the code
  // while we populate the list
  lock(lockObject)
  {
    cachedResults = ctx.Cache["PersonList"];
    // only populate if list was not populated by
    // another thread while this thread was waiting
    if (cachedResults == null)
    {
      cachedResults = ...
      ctx.Cache["PersonList"] = cachedResults;
    }
  }
} 
```

我没有测试过这段代码，但我很想听听有人在生产环境中评估过这种方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-16T08:19:24.123

根据此文档[http://msdn.microsoft.com/en-us/library/system.web.caching.cache(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.web.caching.cache(VS.80).aspx)访问缓存对象是线程安全的。至于您存储在缓存中的对象，线程安全必须来自其他地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T08:32:38.587

我认为没有必要用锁来包装对 HttpRuntime.Cache 属性的访问，因为 .Cache 属性是静态的并且也是线程安全的。

访问 Cache 对象的方式有很多种（HttpRuntime.Cache、HttpContext.Current.Cache、Page.Cache 等）。它们都访问同一个 Cache 对象，因为每个应用程序域只有一个 Cache 对象，因为它实际上是一个线程安全的 Singleton 对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-06T23:58:37.633

我不认为锁定是下面问题的答案，尤其是在生产环境中，您有多个服务器运行您的应用程序。

问题是，如果您有一个需要 30 秒的查询，并且您每秒都在执行该页面，那么在填充缓存项所需的时间内，将会有 29 个其他请求进入，所有这些请求都将尝试填充缓存项与他们自己对数据库的查询。为了解决这个问题，您可以添加一个线程锁来阻止其他页面执行从数据库中请求数据。

# c# - 使用 Visual Fox Pro OleDb

> ID：754663
> 
> 赞同：3
> 
> 时间：2009-04-16T03:32:43.767
> 
> 标签：c#, visual-foxpro, foxpro, dbf

我正在尝试使用 C# 将 DBF 文件中的数据提取到我的程序中。我正在使用 Visual FoxPro OLE DB 提供程序。它在我的本地机器上运行良好，但我想将我的程序打包成客户端可以使用的 dll。问题是当他们从他们的机器上运行程序时，它说 Visual FoxPro OLE DB Provider 没有在他们的机器上注册。有没有什么方法可以在不让客户端在他们的机器上安装 Visual FoxPro OLE DB Provider 的情况下使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T05:33:08.300

简短的答案是否定的……长答案是：

如果不在每台目标机器上安装 Visual FoxPro OLE DB 提供程序，我不相信你能做到这一点。即使您尝试使用 COM 互操作，您仍然需要安装和注册原始 dll - vfpoledb.dll

到目前为止，解决此问题的最简单方法是从 Microsoft 获取[FoxPro OleDb 驱动程序安装包](http://www.microsoft.com/downloads/details.aspx?familyid=E1A87D8F-2D58-491F-A0FA-95A3289C5FD4&displaylang=en)并将其分发给您的用户。

如果您想为您的库安装滚动您自己的 .MSI 包，您可以手动安装并注册缺少的 dll。

使用 .MSI 包中的 regsvr32.exe 手动注册 .DLL：

首先打开您的 WSI 项目并转到 MSI 脚本。

在“立即执行”选项卡中的 InstallFinalize 之后添加“从目标执行程序”自定义操作。

当“从目标执行程序”对话框出现时，输入：

```
Custom Action Name: <registerdll>
Working Directory: SystemFolder
EXE and Command Line: Enter the full path to regsvr32.exe 
and the full path to .DLL.

(usually ..\Program Files\Common Files\System\Ole DB\vfpoledb.dll) 
```

如果您将 /s 开关添加到 [SystemFolder]regsvr32.exe /s 之类的命令行，则应该无需用户干预即可注册 dll。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T06:28:15.077

我在 64 位 Vista 机器上开发时遇到了类似的问题。我发现为了使用 Microsoft Jet OleDB 或 FoxPro OleDB 提供程序，我必须将我的 .Net 项目的属性设置为专门针对 32 位处理器，因为这些提供程序没有 64 位版本。

无论如何，不​​确定这是否是使用您的库的目标机器问题的一部分，但我想我会提供它。

布赖恩

# php - sql - 在不覆盖现有信息的情况下进行更新

> ID：754665
> 
> 赞同：0
> 
> 时间：2009-04-16T03:32:51.363
> 
> 标签：php, javascript, sql, mysql

我有以下条件代码，如果不存在具有适当用户名的记录，它将插入一条新记录，如果存在则更新记录。这工作正常。

但是，目前，如果我插入一条新记录，并且只插入名字和姓氏，也许还有地址详细信息，比如电话信息留空，这很好。如果我希望仅使用电话记录更新记录，则姓名和地址信息将被替换为任何内容。

我想知道的是，是否可能有一种简单的方法来填充我的 php html 表单以更新信息，以及我将要更新的字段的内容？我在用

```
 <input type="text" name="uniquename" /> 
```

获取用户输入，然后将其传递给 javascript 函数，然后将其传递回下面的 php 代码。如果这是不可能的，是否有一种简单的方法可以使用一些 sql/php 魔术，只更新与非空用户输入对应的字段？

```
$usernameQuery = "select username from USERS where username = '" . $con->escape_string($username) . "'"; 

$xblah = $con->query($usernameQuery);
  while ($row = mysqli_fetch_assoc($xblah))
  {
    $checkUsername = $row['username'];
   }

if ($checkUsername == null) {

$userQuery = "INSERT INTO USERS VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";
if ($userInfo = $con->prepare($userQuery)) {
    $userInfo->bind_param("ssssssssssssssssssss", $username, $firstname, $lastname, $flaggedauctions, $lastauction, $street1, $city1, $postcode1, $street2, $city2, $postcode2, $phone, $mobilephone, $fax, $email, $website, $bank, $banknumber, $accountnumber, $comments);
    $userInfo->execute();
    $userInfo->close();
    echo "true";
} else {
echo "false";
}
print_r($con->error);
}

else if ($checkUsername == $username) {

$userQuery = "UPDATE USERS SET firstname = ?, lastname = ?, flaggedauctions = ?, lastauction = ?, street1 = ?, city1 = ?, postcode1 = ?, street2 = ?, city2 = ?, postcode2 = ?, phone = ?, mobilephone = ?, fax = ?, email = ?, website = ?, bank = ?, banknumber = ?, accoutnumber = ? WHERE username = ?";
if ($userInfo = $con->prepare($userQuery)) {
    $userInfo->bind_param("sssssssssssssssssss", $firstname, $lastname, $flaggedauctions, $lastauction, $street1, $city1, $postcode1, $street2, $city2, $postcode2, $phone, $mobilephone, $fax, $email, $website, $bank, $banknumber, $accountnumber, $username);
    $userInfo->execute();
    $userInfo->close();
    echo "true";
} else {
echo "false";
}
print_r($con->error);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:53:36.667

您只需要动态构建更新语句和绑定参数。例如

```
$userQuery = "UPDATE ";

if (!empty($firstname)) {
  $userQuery += "firstname = ?,";
}

...    

if (!empty($firstname)) {
  $bindArgs[] = $firstname;
}
... 
```

因此您的查询不会更新不应更改的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T06:35:01.940

更一般地，请注意：

*   明智的做法是在 INSERT ... VALUES 中指定列名，否则如果有人添加列，您会感到恼火，如果有人对列重新排序，您会感到困惑。

*   您的选择和更新之间存在竞争条件......当您仍在思考时，另一个进程可能会插入/删除一行，导致您的插入/更新失败考虑：

    *   插入 ... 在重复的密钥更新上 ...
    *   更换成...

# javascript - 使用 jQuery，如何获取元素的文本值？

> ID：754666
> 
> 赞同：2
> 
> 时间：2009-04-16T03:33:30.240
> 
> 标签：javascript, jquery

如何检索 href 标记之间的文本？

```
<a href="blah">GET THIS TEXT</a> 
```

它被包裹在这个 DOM 中：

```
<div class="c1">
   <div class="c2"><a href="#">GET THIS TEXT</a>
   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-16T03:34:12.203

您正在寻找的[`text()`](http://docs.jquery.com/Attributes/text)财产：

```
$('a', 'div.c2').text(); 
```

原因`div.c2`被定义为第二个参数是因为它将是[`context`](http://docs.jquery.com/Core/jQuery#expressioncontext)选择器的。默认情况下，当您使用 jQuery 时，jQuery 会搜索整个文档`$()`，通过指定`div.c2`它只会在`<div>`'s 内部搜索具有 c2 类的内容。

记住这一点，你也可以像这样重写上面的代码：

```
$('div.c2 a').text(); 
```

大多数人更喜欢这个，因为它是您在 CSS 样式表中选择该元素时使用的语法。然而，jQuery 必须弄清楚这一点。你甚至可以这样做：

```
$('div.c2').find('a').text(); 
```

但是，我更喜欢上下文方法，因为我觉得它更干净，速度也更快，但这并不重要。

还有一个[`html()`](http://docs.jquery.com/Html)属性，它获取内容，**包括 HTML**。

因此，如果您的链接是这样的：

```
<a href='#'><b>Hi There</b></a> 
```

然后：

```
$('a').text(); // would return Hi There
$('a').html(); // would return <b>Hi There</b> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T03:36:04.023

我认为这[`.text()`](http://docs.jquery.com/Attributes/text)或[`.html()`](http://docs.jquery.com/Attributes/html)将起作用，这取决于您是否不想要或确实想要标签内出现的任何标记。

```
var txt = $('div.c2 > a').text();

var html = $('div.c2 > a').html() 
```

# mysql - mysqld_safe 禁用 Internet 连接

> ID：754671
> 
> 赞同：1
> 
> 时间：2009-04-16T03:34:57.990
> 
> 标签：mysql, unix

我试图让 mysql 在我的机器上运行并`mysqld_safe`从我的主目录运行 sudo。我发现，这不是一个明智的决定。任何人都知道它可能发生了什么改变以使无法访问互联网？我的无线网卡工作正常并连接到路由器，但我无法解析任何外部主机（本地主机工作正常。）

运行该命令会杀死我的终端并阻止任何其他终端实例在重新启动之前启动。除了无法解析远程主机之外，我找不到系统的任何其他问题。

可启动备份再次拯救了这一天。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:41:39.877

我不是 mySQL 专家，但听起来您在运行 mysqld_safe 时遇到了另一个问题。mysqld_safe 不会触及您的路由表或更改您的 DNS 设置。

我会在别处寻找问题。

# solaris - 修补 Sun Solaris

> ID：754676
> 
> 赞同：1
> 
> 时间：2009-04-16T03:36:55.350
> 
> 标签：solaris

您好，最近我们遇到了一个应用程序问题，需要修补 sun solaris。

问题是在这个 Solaris 服务器中创建了许多区域，这些区域被其他应用程序使用。

因此，如果某些补丁可能会影响当前的应用程序。

处理这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T03:45:29.633

如果您正在修补内核，那么您的补丁会影响所有人：内核只有一个副本。

如果您正在修补应用程序软件，那么您可以应用*这些*补丁来仅影响某些区域。

查看[区域常见问题解答。](http://opensolaris.org/os/community/zones/faq/#patching)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-25T08:31:21.200

我使用的一个技巧是让全球“忘记”它的区域。停止区域，使它们进入“已安装状态”，然后从 /etc/zones.index.xml 中删除它们（当然，在获取该区域的备份副本之后）。您现在可以执行升级，而不会影响区域。修补并重启后，重新安装原始 index.xml 并使用 -F 选项附加区域；否则他们将在附加时应用补丁。但请注意，这不是玩具真正希望永远保持的情况。迟早你真的应该把这些区域带到最新的水平，也是。在我忘记之前：如果你有“稀疏”区域，这个技巧就不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T03:44:52.617

解决方案实际上完全取决于问题出在哪里以及您正在应用什么样的修复程序。在许多情况下，如果问题出在内核中，您可以对其进行修补，使修补程序仅适用于具有给定标志的进程。如果它在图书馆或类似的地方，你可能会更难。简而言之，我们确实需要更多信息才能为您提供可靠的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T03:47:17.600

您需要应用的补丁与时区有关吗？如果没有，您可能只能应用一个补丁。

最好的办法是设置一个在软件方面与这个盒子相同的登台系统，让它工作，然后安装你的补丁并进行测试。

# android - 如何在 Android 应用程序中插入日期时间设置为“现在”的 SQLite 记录？

> ID：754684
> 
> 赞同：110
> 
> 时间：2009-04-16T03:43:48.950
> 
> 标签：android, sqlite, content-values

说，我们有一个表创建为：

```
create table notes (_id integer primary key autoincrement, created_date date) 
```

要插入记录，我会使用

```
ContentValues initialValues = new ContentValues(); 
initialValues.put("date_created", "");
long rowId = mDb.insert(DATABASE_TABLE, null, initialValues); 
```

但是如何将 date_created 列设置为**now**？为了清楚起见，

```
initialValues.put("date_created", "datetime('now')"); 
```

不是正确的解决方案。它只是将列设置为“datetime('now')”文本。

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2009-05-04T10:31:13.643

您不能使用 Java 包装器“ContentValues”来使用 datetime 函数。您可以使用：

*   SQLiteDatabase.execSQL，因此您可以输入原始 SQL 查询。

    ```
    mDb.execSQL("INSERT INTO "+DATABASE_TABLE+" VALUES (null, datetime()) "); 
    ```

*   或 java 日期时间功能：

    ```
    // set the format to sql date time
    SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"); 
    Date date = new Date();
    ContentValues initialValues = new ContentValues(); 
    initialValues.put("date_created", dateFormat.format(date));
    long rowId = mDb.insert(DATABASE_TABLE, null, initialValues); 
    ```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-03-21T13:36:28.637

在我的代码中，我`DATETIME DEFAULT CURRENT_TIMESTAMP`用作列的类型和约束。

在您的情况下，您的表定义将是

```
create table notes (
  _id integer primary key autoincrement, 
  created_date date default CURRENT_DATE
) 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2014-11-09T09:42:23.513

**方法一**

```
CURRENT_TIME – Inserts only time
CURRENT_DATE – Inserts only date
CURRENT_TIMESTAMP – Inserts both time and date

CREATE TABLE users(
    id INTEGER PRIMARY KEY,
    username TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
); 
```

**方法二**

```
db.execSQL("INSERT INTO users(username, created_at) 
            VALUES('ravitamada', 'datetime()'"); 
```

**方法 3** 使用 java 日期函数

```
private String getDateTime() {
        SimpleDateFormat dateFormat = new SimpleDateFormat(
                "yyyy-MM-dd HH:mm:ss", Locale.getDefault());
        Date date = new Date();
        return dateFormat.format(date);
}

ContentValues values = new ContentValues();
values.put('username', 'ravitamada');
values.put('created_at', getDateTime());
// insert the row
long id = db.insert('users', null, values); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-16T13:49:14.323

您可以使用几个选项：

1.  您可以尝试使用字符串 "(DATETIME('now'))" 代替。
2.  自己插入日期时间，即使用 System.currentTimeMillis()
3.  创建 SQLite 表时，将 created_date 列的默认值指定为当前日期时间。
4.  使用[SQLiteDatabase.execSQL](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#execSQL(java.lang.String))直接插入。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-16T07:33:35.827

对我来说，这个问题看起来像你`"datetime('now')"`作为一个字符串而不是一个值发送。

我的想法是找到一种方法来获取当前日期/时间并将其作为日期/时间值发送到您的数据库，或者找到一种使用 SQLite 内置`(DATETIME('NOW'))`参数的方法

在[这个 SO.com 问题](https://stackoverflow.com/questions/200309/sqlite-database-default-time-value-now)上查看答案- 他们可能会引导您走向正确的方向。

希望这会有所帮助！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-03-21T15:10:55.623

您可以使用java的功能，即：

```
ContentValues cv = new ContentValues();
cv.put(Constants.DATE, java.lang.System.currentTimeMillis()); 
```

这样，在您的数据库中，您可以保存一个数字。
这个数字可以这样解释：

```
 DateFormat dateF = DateFormat.getDateTimeInstance();
    String data = dateF.format(new Date(l)); 
```

你应该将数字插入到日期列中，而不是 l 到 new Date(l) 中。
所以，你有你的约会。
例如，我在我的数据库中保存了这个数字：1332342462078
但是当我调用上面的方法时，我得到了这个结果：21-mar-2012 16.07.42

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-02-27T01:18:13.360

根据@e-satis 的回答，我在“DBTools”类上创建了一个私有方法，因此现在添加当前日期非常容易：

```
...
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
...
        private String getNow(){
            // set the format to sql date time
            SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
            Date date = new Date();
            return dateFormat.format(date);
        }
... 
```

现在像这样使用它：`values.put("lastUpdate", getNow());`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-11T22:38:33.850

此代码示例可能会执行您想要的操作：

[http://androidcookbook.com/Recipe.seam?recipeId=413](http://androidcookbook.com/Recipe.seam?recipeId=413)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-05T06:18:03.963

对我来说完美：

```
 values.put(DBHelper.COLUMN_RECEIVEDATE, geo.getReceiveDate().getTime()); 
```

将您的日期保存为长。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-03T13:09:00.420

确保在尝试使用表达式“（DATETIME（'now'））”插入默认时间戳的同时，该字段未标记为“非空”

# javascript - 获取实际上是一个数字的 html，想给它加 1 并替换它

> ID：754685
> 
> 赞同：0
> 
> 时间：2009-04-16T03:44:21.180
> 
> 标签：javascript, addition

我正在尝试将 1 添加到我使用 jquery 从我的 HTML 中获取的值。

目前它正在附加 1，将值视为字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T03:48:04.120

你想要`parseInt`。正如 Paolo 所提到的，您应该提供一个基本参数，否则如果它有一个前导`0`（或十六进制，如果它有一个前导`0x`），它可能会被解释为八进制。

```
js> parseInt("1", 10)+1
2
js> parseInt("010")
8
js> parseInt("0x10")
16 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T03:56:51.213

小心`parseInt`！您应该*始终*指定第二个参数，它是基数：

```
$('div.c2 a').text(
   parseInt($('div.c2 a').text(),10)+1
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T03:54:54.870

[您可以使用Number](http://www.w3schools.com/jsref/jsref_Number.asp)函数将字符串转换为数字，只要数字是整数或浮点数，它就会起作用：

```
var i = Number(myValue) + 1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T03:55:32.510

根据要求（使用 jQuery）

```
$('.vote-count-post').each(function() {
  var n = parseInt($(this).text(), 10)+1;
  $(this).text(n);
}); 
```

这将向元素文本添加一个。在这种情况下，为该页面上的所有投票添加一票！（在萤火虫中工作 - 太糟糕了，它只在页面上）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T03:47:41.080

```
x = parseInt(x)+1 //assuming input in an integer 
```

或者

```
x = parseFloat(x)+1 //assuming input is non-integer 
```

您需要强制从*string类型转换为**integer*。

 *# javascript - 有关 FF 和 IE 如何处理 javascript 之间差异的任何参考资料？

> ID：754689
> 
> 赞同：1
> 
> 时间：2009-04-16T03:46:03.220
> 
> 标签：javascript, compatibility

FF 和 IE 如何处理 javascript 之间是否存在差异列表？

例如，我记得数组引用在两者之间有点不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T03:48:10.923

为什么是的，我最近问了这个问题：

[Javascript 不兼容/不一致](https://stackoverflow.com/questions/703993/javascript-incompatibilities-inconsistencies)

请注意，有一个明确的共识是，大多数（但不是全部）显着差异与 DOM 相关，而不是语法相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T03:49:58.173

[IBM 在http://www.ibm.com/developerworks/web/library/wa-ie2mozgd/](http://www.ibm.com/developerworks/web/library/wa-ie2mozgd/)上写了一篇关于包括 javascript 在内的浏览器的差异的非常好的论文。 大多数差异在 DOM 中，而不一定在 javascript 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T03:51:07.827

这是一份[不错的清单](http://balanagaraj.wordpress.com/2008/05/07/javascript-differences-in-mozilla-firefox-and-internet-explorer/)。

# sifr - Sifr 和 Javascript 更改样式表（无需刷新页面）

> ID：754690
> 
> 赞同：0
> 
> 时间：2009-04-16T03:46:12.503
> 
> 标签：sifr

我目前正在我的网站上玩 Sifr。基本上，我的页面顶部有一些彩色块，它们将通过 javascript 更改样式表，具体取决于您选择的颜色。我想知道如何让 Sifr h1/h2 标签动态重新加载（不刷新页面）onclick - 如果可能的话？

我尝试在 onclick 事件中添加 sIRF.activate 代码，我还尝试将 sIFR.activate 代码放入 set_style 函数中，但无济于事。如果有人可以帮助我，那就太好了！

干杯莉安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T22:01:47.967

给定 sIFR 3，可以更改一些用于呈现文本的 CSS。

我假设你有两个替代品 for`h1`和`h2`，我们只是改变它们的颜色：

```
function changeColor(hexValue) {
  var css = '.sIFR-root { color: ' + hexValue + '; }';
  for (var i = 0; i < sIFR.replacements['h1'].length; i++) {
    sIFR.replacements['h1'][i].changeCSS(css);
  }
  for (var i = 0; i < sIFR.replacements['h2'].length; i++) {
    sIFR.replacements['h2'][i].changeCSS(css);
  }
}

// after switching stylesheet:
changeColor('#FF9900'); 
```

这应该将`<h1>`和`<h2>`替换元素的文本颜色更改为橙​​色。

返回的对象`sIFR.replacements[][]`是[FlashInteractor](http://wiki.novemberborn.net/sifr3/FlashInteractor)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T04:29:08.953

我自己没有使用过 sifr，但我认为你最好的选择是[Rollback 附加组件](http://wiki.novemberborn.net/sifr/Add-ons)。然后，您应该能够通过回滚有效地在您的 javascript 中重新加载您的 sifr 标记，然后通过重新运行您的替换语句（即基本上禁用和重新启用它）立即再次“向前滚动”。

**编辑：**刚刚注意到在[这个页面](http://wiki.novemberborn.net/sifr3/JavaScript+Methods)的底部有一种`redraw()`方法......实际上可能正是你所追求的？（再次，抱歉含糊不清，但我自己从未直接使用过 sifr ）

# linux - 运行 KDM 和 XFCE 的 Fedora 10 远程 X 显示器

> ID：754707
> 
> 赞同：0
> 
> 时间：2009-04-16T03:53:48.817
> 
> 标签：linux, x11, remote-access, xdmcp

我正在使用 Emacs 作为编辑器在 Windows 机器上开发 JSF Web 应用程序，但我更喜欢在 Linux 环境中使用 Emacs。在（有些遥远的）过去，使用远程 X 显示器来完成这个非常有用的编程辅助是不费吹灰之力的。Cygwin 有所帮助，但真正的远程 X 是首选解决方案。然而，在最近的 Fedora（和 Ubuntu）发行版中，remote X 是一个令人头疼的问题（Google remote X 或 XDMCP），你会看到现在有很多 GDM、XDM 和 KDM 的配置设置，更不用说 xhost 和防火墙了使远程 X 的配置比说服 Barry Kelley 这种类型的问题与真正的编程相关更困难。

现在，我使用 XFCE 环境和 KDM 作为我的显示管理器运行 Fedora 10。我关闭了防火墙，关闭了 selinux，启用了 XDMCP（在 /etc/kde/kdm/kdmrc 中），但是在使用 (Cywin) "$ export DISPLAY= myfedora10box:0.0; xclock”。当我远程显示到另一个运行 Cygwin/X 的 windows 框时，测试工作正常。所以问题显然是 Fedora 10 中的配置设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T04:02:49.263

[便携式 Ubuntu](http://lifehacker.com/5195999/portable-ubuntu-runs-ubuntu-inside-windows)将允许您直接在 Windows 中运行 Linux 环境，而无需任何凌乱的 X Windows 设置或必须设置虚拟机。如果您真正想做的只是运行 Emacs，这可能是最快的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T07:39:46.123

X 服务器通常配置为不接受 tcp 连接（“-nolisten tcp”），但另一种选择是使用 ssh 的 X11 转发机制。尝试运行

```
ssh -X myfedora10box xclock 
```

你的cygwin机器，你应该让时钟运行。对于交互式使用，请使用`ssh -X myfedora10box`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T05:30:04.517

*   您是否添加了允许 xdmcp 访问的主机`/etc/X11/xdm/Xaccess`？
*   我现在不在 xdm 的盒子上，但如果我没记错的话，应该还有一个可以包含相关配置的配置文件，看看`/etc/X11/xdm/xdm-config`

编辑：在这些配置更改偏离路线后，您可能需要重新启动 X！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T06:33:09.683

您可能会发现 X 服务器会话正在使用“-nolisten tcp”选项启动，这意味着无法远程连接到桌面，因为它没有侦听任何网络端口。

当然，在我的 Ubuntu 机器上，这是默认配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T14:57:45.830

“便携式 Ubuntu”的替代品是[andLinux——](http://www.andlinux.org/)我喜欢他们的桌面集成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T15:04:32.830

你试过'xhost'命令吗？从手册页：

> xhost 程序用于在允许连接到 X 服务器的列表中添加和删除主机名或用户名。

在您的 Fedora 机器上，您可以输入“xhost +mywindowsbox”以允许 xclock 和 emacs 以及 windows 机器上的任何其他内容显示在 Fedora X 屏幕上。

但是，这只会让您在 Fedora 屏幕上编辑 Windows 文件的 Windows emacs。如果您希望在 Windows 文件上使用 Fedora emacs，您可能希望将 Windows 机器设置为共享其文件并在 Fedora 上使用 samba 以使其可由运行在 Fedora 机器上的 emacs 访问。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-18T23:05:50.090

当我不幸使用 Windows 时，我通常只是使用 putty 或其他一些 ssh 客户端登录到终端，然后从终端（XMing 或其他一些 X 服务器）启动 X 应用程序。

但是如果你想要一个完整的 X 会话而不是仅仅启动单个应用程序，也许像 VNC 或 NX 这样的帧缓冲系统会更容易设置？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-26T19:45:22.647

我收到的一些答案很有帮助，尤其是 Bryan Childs 的答案。有一次我确认“$ ps -ef | grep X”在 X 命令上显示了 -nolisten tcp 参数，从那里到 /etc 下的“-nolisten”的 grep 是不费吹灰之力的（Emacs 的 rgrep 是精确）我在 /etc/kde/kdm/kdmrc:457 中找到罪魁祸首的地方，其中指定了“ServerArgsLocal=-br -nolisten tcp”。

感谢所有回复的人。

-pmr

# mysql - 带有空列的mysql全文搜索

> ID：754708
> 
> 赞同：0
> 
> 时间：2009-04-16T03:54:44.353
> 
> 标签：mysql, full-text-search

我正在尝试对 mysql 数据库进行全文搜索。问题是某些字段可以为空。例如，我有一个带有列的基本地址表

> 街线1
> 
> 街道线2
> 
> 城市
> 
> 状态
> 
> 压缩

现在这些都不是必需的，因此其中任何一个都可以为空。当我进行全文搜索时

```
SELECT *, 
(MATCH (StreetLine1, StreetLine2, City, State, Zip) 
AGAINST ('+{0}*' IN BOOLEAN MODE)) AS Relevance 
FROM Address 
HAVING Relevance > 0 
Order By Relevance Desc 
```

*{0} 只是一个占位符*

如果没有任何字段为空，则效果很好。但如果其中之一为空，则不返回该行。

我想我应该只创建一个视图，所以我做了，但后来我不知道如何将全文索引添加到该视图

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:02:36.737

这些字段太小，无法进行全文搜索。另外，您必须将您的表设为 MyIsam，这通常不如 InnoDb 合适。

您想在`LIKE`此处使用运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T08:40:54.497

如果您尝试匹配街道号码或“Ln”等缩写等内容，请确保`[mysqld]`在您的 .`my.cnf`

```
ft_min_word_len=2 
```

我已经将它用于地理数据，用户想要搜索 2 个字母的州缩写等——当你第一次意识到索引中没有短词时，它会让人迷失方向。当然，您必须在更改`ft_min_word_len`值后重建索引。

# java - EDT 和主线程之间的通信

> ID：754717
> 
> 赞同：0
> 
> 时间：2009-04-16T03:59:04.623
> 
> 标签：java, multithreading, swing, event-dispatch-thread

我一直在问很多关于我最近一直在做的项目的问题。这是我所处的场景，任何帮助或指向正确方向都会有很大帮助......

这是一个由服务器和多个客户端构建的网络程序。每个客户端都有一个 GUI，它必须根据服务器发送的命令进行操作。每个客户端都包装在一个名为`Player`. 这`Player`有一个 GUI（扩展`JFrame`）和一个 main 方法，而服务器只有一个 main 方法（没有 GUI）。起初，这个类是在主线程中创建的，如下所示：

```
EventQueue.invokeLater(new Runnable()
{
    public void run()
    {
        new Player().setVisible(true);
    }
 }); 
```

这工作得很好，直到我意识到整个`Player`类现在都在 EDT 中执行。因此，当我等待来自服务器的命令时，整个 GUI 会锁定，直到发送该命令并执行适当的操作。可以想象，这是一个可怕的设计，并且被证明是编码环境的真正痛苦，因为每次您想要检查某些东西时，您必须找到一些疯狂的工作，以便 GUI 仍然保持完整。

显然，我必须在单独的线程中检查来自服务器的命令并在 EDT 中运行 GUI 组件。我的第二个实现有两个类——一个用于 GUI，一个用于`Player`. 这个想法是`Player`有一个保存 GUI 的变量，以便我可以从`Player`类中访问 GUI，如下所示：

```
class Player
{
    public GUI gui;

    ...

    // And then start this gui inside of the EDT.
    EventQueue.invokeLater(new Runnable()
    {
         public void run()
         {
              this.gui = new GUI().setVisible(true);
         }
    } 
```

这也不起作用，因为`this`新`Runnable`对象内部指的是`Runnable`对象，而不是`Player`.

如何`Player`在一个线程中的类与 EDT 线程中相应的 GUI 类之间进行通信？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T07:45:46.187

要处理`this`指针问题，您应该编写：

```
class Player
{
    public GUI gui;

    ...

    // And then start this gui inside of the EDT.
    EventQueue.invokeLater(new Runnable()
    {
         public void run()
         {
              Playser.this.gui = new GUI().setVisible(true);
         }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T08:30:13.367

Boris Pavlović 获得了正确的语法（实际上您可以删除`this.`），但代码仍然没有意义。该`gui`字段在事件排队后的某个时间被初始化`Runnable`，因此播放器线程使用它是不安全的。

您可以`Player`在 EDT 上构建（但在 EDT 之外进行网络操作）。或者将 GUI 注册为`Player`. `invokeAndWait`会起作用，但很危险，因为它经常导致偶尔难以调试的死锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T04:40:17.880

*   [使用 Swing 编写响应式 UI](http://java.sun.com/docs/books/performance/1st_edition/html/JPSwingThreads.fm.html)
*   [工作线程：Swing Worker](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T07:46:41.473

你可以试试这个：

类播放器 { 公共 GUI gui;

```
...

// And then start this gui inside of the EDT.
EventQueue.invokeLater(new Runnable()
{
     public void run()
     {
          Player.this.gui = new GUI().setVisible(true);
     }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T11:22:50.213

“直到我意识到整个 Player 类现在都在 EDT 中执行”

构造函数发生在 EDT 上，但在此类上调用的方法可能不会。

您应该按照最初的意图构建播放器 GUI。

```
 EventQueue.invokeLater(new Runnable() 
 {
    public void run()
    {
        new Player().setVisible(true);
    }
 }); 
```

但是 Player 可以在构造函数中启动一个单独的线程（我个人会在 Player 之间共享一个连接）。

当然，来自服务器的回调方法在修改可见组件时应该使用 invokeLater()。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T04:13:05.607

为什么不使用匿名内部类，而是声明一个实现 Runnable 的类并拥有一个以 GUI 实例作为参数的构造函数？

此外，如果您的 GUI 类不是线程安全的，请考虑使用消息队列在 EDT 和主线程之间进行通信。

# sql-server - sql server：导入操作不会复制完整架构

> ID：754719
> 
> 赞同：1
> 
> 时间：2009-04-16T04:00:35.667
> 
> 标签：sql-server, sql-server-2005, sql-server-2008, ssms

我记得 sql server 2000 中的导入工具会复制索引、关系等。在 sql server 2005/2008 中，SSMS 中的导入工具只会创建表、复制数据，但缺少键、索引和关系。我在导入向导中找不到启用此功能的选项？我在这里想念什么？出于任何充分的理由，这不再可能了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T05:24:32.517

You will have to go for "Transfer SQL Server objects" in SSIS.

[Here's](http://www.kodyaz.com/articles/transfer-sql-server-objects-task.aspx) a simple illustration to accomplish what you need.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-18T00:54:14.857

另一种选择是使用[数据库发布向导](http://sqlhost.codeplex.com/wikipage?title=Database%20Publishing%20Wizard&referringTitle=Home)。

# c++ - 复制构造函数初始化列表

> ID：754729
> 
> 赞同：20
> 
> 时间：2009-04-16T04:06:49.427
> 
> 标签：c++, copy-constructor

我知道，如果您在无参数构造函数的初始化列表中留下一个成员，则将调用该成员的默认构造函数。

复制构造函数是否同样调用成员的复制构造函数，还是它们也调用默认构造函数？

```
class myClass {
  private:
    someClass a;
    someOtherClass b;
  public:
    myClass() : a(DEFAULT_A) {} //implied is b()
    myClass(const myClass& mc) : a(mc.a) {} //implied is b(mc.b)??? or is it b()?
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-16T04:26:29.347

显式定义的复制构造函数不会为成员调用复制构造函数。

当您进入构造函数的主体时，该类的每个成员都将被初始化。也就是说，一旦您到达`{`您就可以保证您的所有成员都已初始化。

**除非指定，否则成员会按照它们在类中出现的顺序进行默认初始化。**（如果不能，则程序格式不正确。）因此，如果您定义了自己的复制构造函数，那么您现在可以根据需要调用任何成员复制构造函数。

这是一个小程序，您可以在某处复制粘贴并弄乱：

```
#include <iostream>

class Foo {
public:
    Foo() {
        std::cout << "In Foo::Foo()" << std::endl;
    }

    Foo(const Foo& rhs) {
        std::cout << "In Foo::Foo(const Foo&)" << std::endl;
    }
};

class Bar {
public:
    Bar() {
        std::cout << "In Bar::Bar()" << std::endl;
    }

    Bar(const Bar& rhs) {
        std::cout << "In Bar::Bar(const Bar&)" << std::endl;
    }
};

class Baz {
public:
    Foo foo;
    Bar bar;

    Baz() {
        std::cout << "In Baz::Baz()" << std::endl;
    }

    Baz(const Baz& rhs) {
        std::cout << "In Baz::Baz(const Baz&)" << std::endl;
    }
};

int main() {
    Baz baz1;
    std::cout << "Copying..." << std::endl;
    Baz baz2(baz1);
} 
```

按原样打印：

```
在 Foo::Foo()
在酒吧::酒吧()
在 Baz::Baz()
复制...
在 Foo::Foo()
在酒吧::酒吧()
在 Baz::Baz(const Baz&)

```

请注意，它默认初始化`Baz`.

通过注释掉显式复制构造函数，例如：

```
/*
Baz(const Baz& rhs) {
    std::cout << "In Baz::Baz(const Baz&)" << std::endl;
}
*/ 
```

输出将变为：

```
在 Foo::Foo()
在酒吧::酒吧()
在 Baz::Baz()
复制...
在 Foo::Foo(const Foo&)
在 Bar::Bar(const Bar&)

```

它在两者上调用复制构造函数。

如果我们重新引入`Baz`的复制构造函数并显式复制单个成员：

```
Baz(const Baz& rhs) :
    foo(rhs.foo)
{
    std::cout << "In Baz::Baz(const Baz&)" << std::endl;
} 
```

我们得到：

```
在 Foo::Foo()
在酒吧::酒吧()
在 Baz::Baz()
复制...
在 Foo::Foo(const Foo&)
在酒吧::酒吧()
在 Baz::Baz(const Baz&)

```

如您所见，一旦您明确声明了一个复制构造函数*，您*就负责复制所有类成员；现在是你的构造函数。

这适用于所有构造函数，包括移动构造函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T04:27:05.150

对于任何具有默认构造函数的成员变量，如果您没有将对该成员变量的任何其他构造函数调用显式添加到初始化列表中，则会调用该默认构造函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T05:40:46.347

有关详细信息，请参阅：[C++ 中是否存在隐式默认构造函数？](https://stackoverflow.com/questions/563221/is-there-an-implicit-default-constructor-in-c/563320#563320)

短的：

*   编译器生成的“默认构造函数”：使用每个成员的默认构造函数。
*   编译器生成的“复制构造函数”：使用每个成员的复制构造函数。
*   编译器生成的“赋值运算符”：使用每个成员的赋值运算符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T04:08:33.963

是的。演员就是演员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T04:30:06.220

复制构造函数没有什么神奇之处，除了编译器会在需要时添加它。但在它实际运行的方式上，并没有什么特别之处——如果你没有明确地说“使用这样那样的构造函数”，它将使用默认值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T05:25:55.603

VC9 中没有。不确定其他人。

```
// compiled as: cl /EHsc contest.cpp
//
//    Output was:
//    Child1()
//    -----
//    Child1()
//    Child2()
//    Parent()
//    -----
//    Child1(Child1&)
//    Child2()
//    Parent(Parent&)

#include <cstdio>

class Child1 {
    int x;
public:
    static Child1 DEFAULT;

    Child1(){
        x = 0;
        printf("Child1()\n");
    }

    Child1(Child1 &other){
        x = other.x;
        printf("Child1(Child1&)\n");
    }
};

Child1 Child1::DEFAULT;

class Child2 {
    int x;
public:
    Child2(){
        x = 0;
        printf("Child2()\n");
    }

    Child2(Child2 &other){
        x = other.x;
        printf("Child2(Child2&)\n");
    }
};

class Parent {
    int x;
    Child1 c1;
    Child2 c2;

public:
    Parent(){
        printf("Parent()\n");
    }

    Parent(Parent &other) : c1(Child1::DEFAULT) {
        printf("Parent(Parent&)\n");
    }
};

int main(){
    printf("-----\n");
    Parent p1;
    printf("-----\n");
    Parent p2(p1);

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-31T17:45:34.100

根据基调用构造函数的启动方式，成员的构造函数将以相同的方式调用。例如，让我们从：

```
struct ABC{
    int a;
    ABC() : a(0)    {   printf("Default Constructor Called %d\n", a);   };

    ABC(ABC  & other )  
    {
        a=other.a;
        printf("Copy constructor Called %d \n" , a ) ;
    };
};

struct ABCDaddy{
    ABC abcchild;
}; 
```

您可以进行以下测试：

```
printf("\n\nTest two, where ABC is a member of another structure\n" );
ABCDaddy aD;
aD.abcchild.a=2;

printf( "\n Test: ABCDaddy bD=aD;  \n" );
ABCDaddy bD=aD; // Does call the copy constructor of the members of the structure ABCDaddy ( ie. the copy constructor of ABC is  called)

printf( "\n Test: ABCDaddy cD(aD); \n" );
ABCDaddy cD(aD);    // Does call the copy constructor of the members of the structure ABCDaddy ( ie. the copy constructor of ABC is  called)

printf( "\n Test: ABCDaddy eD; eD=aD;  \n" );
ABCDaddy eD;
eD=aD;          // Does NOT call the copy constructor of the members of the structure ABCDaddy ( ie. the copy constructor of ABC is not called) 
```

输出：

```
Default Constructor Called 0

Test: ABCDaddy bD=aD;
Copy constructor Called 2

Test: ABCDaddy cD(aD);
Copy constructor Called 2

Test: ABCDaddy eD; eD=aD;
Default Constructor Called 0 
```

享受。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T04:28:44.990

当编译器提供默认的 cctor 时，你认为编译器对成员变量做了什么？它*复制构造*它。

同样，如果 cctor 是用户定义的，并且如果遗漏了一些成员，则这些成员不能未初始化。类不变量是在构造过程中建立的，并且必须不断维护。因此，编译器会为您执行此操作。

# wpf - 如何为窗口设置动画？

> ID：754739
> 
> 赞同：5
> 
> 时间：2009-04-16T04:17:09.230
> 
> 标签：wpf, animation, c#-3.0

使用 WPF，如何为 Window 的位置设置动画。我试图简单地为 Left/Top 属性设置动画，但它不起作用。有人知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T10:24:49.573

这将在窗口显示时产生淡入淡出效果：

```
<Window.Triggers>
    <EventTrigger RoutedEvent="Loaded">
        <BeginStoryboard>
            <Storyboard Duration="00:00:3" Storyboard.TargetProperty="Opacity">
                <DoubleAnimation From="0" To="1"/>
            </Storyboard>
        </BeginStoryboard>
    </EventTrigger>
</Window.Triggers> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-16T09:03:29.743

只需为您要设置动画的窗口创建一个情节提要。

以下是名为 w1 的窗口的示例：

```
<Window.Triggers>
  <EventTrigger RoutedEvent="Window.Loaded">
    <EventTrigger.Actions>
      <BeginStoryboard>
        <Storyboard BeginTime="0" Duration="Forever">
          <DoubleAnimation Storyboard.TargetName="w1" Storyboard.TargetProperty="(Window.Top)" From="0" To="300" AutoReverse="true" BeginTime="0:0:0" Duration="0:0:1" RepeatBehavior="Forever"/>
          <DoubleAnimation Storyboard.TargetName="w1" Storyboard.TargetProperty="(Window.Left)" From="0" To="400" AutoReverse="true" BeginTime="0:0:0" Duration="0:0:2" RepeatBehavior="Forever"/>
        </Storyboard>
      </BeginStoryboard>
    </EventTrigger.Actions>
  </EventTrigger>  
</Window.Triggers> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T06:20:57.717

也许您可以尝试使用 Expression Blend 向其中添加 StoryBoard。您可以在 Blend 中控制更改 Window 属性的 TimeLine，只需在 .cs 代码中激活动画即可。

# sql - 如何从数据库中获取随机数据？

> ID：754741
> 
> 赞同：1
> 
> 时间：2009-04-16T04:18:45.560
> 
> 标签：sql, random

我有一张产品表。我已经使用 rand() 函数列出了带有分页的项目。使用 rand() 时，它以随机顺序显示项目，但当我们从一页转到另一页时，记录会重复。是否可以使用 rand() 在每个页面中获取不重复的项目？如果是，如何，如果不是，可以选择什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T04:22:54.863

好吧，您可以在执行第一个查询时（在您的应用程序代码中）生成一个随机种子，然后在请求之间保留该种子 - 并将该种子提供给`rand([seed])`函数。应该这样做...

当然，具体情况取决于您的 sql 代码目前的工作情况；您*可能*需要循环使用要忽略的随机数的第一页（左右）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T04:49:26.390

在这种情况下，我可能会看看是否有办法创建产品 ID 列表（我假设每个产品都有某种唯一 ID）并对其进行洗牌。该列表可能存储为临时数据库表，也可能存储为 Web 应用程序中的会话变量，例如……这样您就可以访问随机排序列表的任何部分，而无需重新计算整个事物从一开始就。

如果您在任何给定时间访问该站点的人很少，这显然是最好的，但您希望他们每个人都浏览几页结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T06:53:15.887

从表中选择列 ORDER BY RAND() LIMIT 1

# internet-explorer - 如何检查 IE 中的 activeX 控件使用的内存？

> ID：754752
> 
> 赞同：1
> 
> 时间：2009-04-16T04:24:48.697
> 
> 标签：internet-explorer, activex

有一个使用 *OWC 电子表格*Active X 控件的 aspx 页面加载一个 Excel 表，但有时浏览器变得繁忙/缓慢。

我想查看此 ActiveX 控件的统计信息，例如使用的内存、CPU 负载……等

我尝试使用 Process Explorer 和 NTSD，但无法跟踪它。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T05:18:38.193

I don't know if this helps as you're asking about IE, but you might want to take a look at Google Chrome. In Chrome, ActiveXs run as a separate process. Using the browser's build-in task manager you can see exactly how much memory the ActiveX is consuming (as well as how much CPU and networking).

As for IE, you can try creating a version of the web page that does not include the ActiveX, and see how much memory IE uses. Then, load the original page that does contain the ActiveX, and see the difference in memory consumption. It will not be accurate, but it could give you the hint you need.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T15:11:20.320

由于 ActiveX 控件通常（并且在这种情况下总是）在进程中运行，因此无法直接判断给定控件正在使用多少内存。您必须进行并行实验。您可能*可以*尝试使用分析器跟踪分配和释放，但委婉地说，这将是一个艰苦的过程。

# c++ - C++ 随机种子、全局对象和 SDL_Threads

> ID：754753
> 
> 赞同：1
> 
> 时间：2009-04-16T04:25:38.163
> 
> 标签：c++, multithreading, random, global

在我的程序中，我有一个全局 cpp 文件对象，它以整数作为参数。

```
//In global header
extern Object example;

//In global cpp file
Object example( (rand() % 6) ); 
```

我希望为对象的参数生成一个随机数，但种子没有到达全局变量，因为种子是在另一个 cpp 文件中创建的，稍后在 main.cpp 文件中调用。

我的主要问题是随机种子没有达到 global.cpp 中对象的参数，但我也出于特定原因将其放在那里，这涉及线程。

我的主要问题是：随机种子可以到达全局变量吗？如果是，请告诉我如何

（如果是，则下一个问题无关紧要）

但如果不可能，这个问题与线程和创建对象的位置有关。对象类在运行线程中调用一个函数，在另一个线程中调用不同的函数，例如：

//线程A

```
int thread(void *data)
{
   example.showimage();

   return 0;
}

//ThreadB
int thread(void *data(
{
   example.moveimage();

   return 0;
} 
```

我想要两个线程之间的这种功能，但是有没有办法在不创建全局对象的情况下实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T05:50:36.807

最好的方法是使用单例模式（注意这个例子不是线程安全的）：

```
//in a header
class RandomSeed
{
public:
    static RandomSeed& instance()
    {
        static RandomSeed the_instance;
        return the_instance;
    }
    int value() const {return value_;}
private:
    RandomSeed() {/*initialization code*/}
    RandomSeed(const RandomSeed& rs); // disallowed
    RandomSeed& operator=(const RandomSeed& rs); // disallowed
    int value_;
};

// in your file
#include "random_seed.h"
srand(RandomSeed::instance().value()); 
```

要实现线程安全，请使用双锁或其他一些锁定机制。另一种选择是查看[Boost.call_once](http://www.boost.org/doc/libs/1_33_1/doc/html/call_once.html)为您初始化数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T05:48:10.230

听起来您正在使用一种依赖于静态（全局）初始化顺序的方法。您不能跨编译单元（即在不同文件中）依赖该顺序。同一编译单元中的静态变量按照它们声明的顺序进行初始化。

对于解决方案，您可以考虑：

[如何防止“静态初始化订单惨败”？](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.13)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T05:51:40.937

您正面临一个[静态初始化问题](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)。最简单的方法是实现一个 Singleton，以便您可以控制初始化过程。当您使用多线程代码时，单例必须是线程安全的（考虑[双重检查锁定](http://en.wikipedia.org/wiki/Double_checked_locking_pattern)）模式才能创建，并且可能是互斥锁和避免竞争条件的条件。检查您的线程库文档以获取有关此部分的文档。一般的伪代码是：

```
// image_control would be 'example' in your two last snippets
// painter
image image_control::obtain_picture()
{
   mutex.acquire();
   while ( ! image_already_created ) 
      image_creation_condition.wait(); // wait for image creation
   image res = the_image;
   image_already_created = false; // already consumed
   image_consumption_condition.signal(); // wake up producer is waiting
   mutex.release();
   return res;
}
// image creator
void image_control::create_picture( image new_image )
{
   mutex.acquire();
   while ( image_already_created ) 
      image_consumption_condition.wait(); // wait for image to be consumed
   the_image = new_image;
   image_already_created = true;
   image_creation_condition.signal(); // wake up consumer if it is waiting
   mutex.release();
} 
```

您的线程库可能具有更好的构造（用于互斥体获取和释放（）的 RAII），但想法是您有一个单点，两个线程等待另一个线程完成其任务，因此没有线程条件。

# php - 使用 Javascript 读取会话值

> ID：754761
> 
> 赞同：15
> 
> 时间：2009-04-16T04:30:26.233
> 
> 标签：php, javascript, session

是否可以使用 Javascript 读取会话值？

例如，如果我在 PHP 中为会话分配了一个值：

```
$_SESSION['msg'] = "ABC Message"; 
```

是否可以`$_SESSION['msg']`使用 Javascript 阅读？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-16T05:57:07.697

一种非常简单的方法是使用一些 PHP 代码生成 JavaScript：

```
<script type="text/javascript">
    <?php echo 'var msg = "'.json_encode($_SESSION['msg']).'";';
</script> 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-16T04:36:41.507

$_SESSION 是一个服务器端结构。您需要将该变量存储在 $_COOKIE 中才能在客户端访问它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-16T05:21:51.807

.. 或者您可以使用 ajax 将您的服务器端会话值检索到您的客户端 javascript 中。`（快速、肮脏和未经测试的示例，使用[jQuery](http://docs.jquery.com/Ajax)）

**Javascript端：**

```
$.ajax({
      url: "test.php",
      cache: false,
      success: function(html){
        eval( html ); /// UGLY NASTY YOU MUST VALIDATE YOUR INPUTS... JUST AN EXAMPLE
      }
    }); 
```

**PHP端test.php：**

```
echo 'var myData = "'. $_SESSION['msg'].'"'; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-17T19:48:06.247

如果这对任何人都有帮助，那么这些示例会返回`null`，所以我只使用了：

```
<?php session_start();
   $msg = $_SESSION['msg'];
?>

<script>
   <?php echo "var msg = '" .$msg . "'"; ?>
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-13T09:41:09.260

```
<script type="text/javascript">
var foo="<?php echo $_SESSION['user_id']; ?>";
alert(foo);
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-08T07:06:55.890

为了使 Luis Melgratti 的答案更简单的示例，您可以从 PHP 返回一个 json 编码值并使用 jQuery 解析它，如下所示：

**Javascript：**

```
$("#some_button")
    .click(function()
    {
        $.ajax(
        {
            url: "get_session.php",
            cache: false
        })
        .done(function(result)
        {
            var session_credentials = $.parseJSON(result);
            console.log(session_credentials);
        });
    }); 
```

**PHP：**

```
//get_session.php
<?php
    session_start();
    echo json_encode($_SESSION);
?> 
```

我相信在类似的 SO-thread 上还有更多答案：[how-to-access-php-session-variables-from-jquery-function-in-a-js-file](https://stackoverflow.com/questions/4365738/how-to-access-php-session-variables-from-jquery-function-in-a-js-file)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-28T10:01:38.947

愿它有效：

```
function getCookie(name) {
  var value = "; " + document.cookie;
  var parts = value.split("; " + name + "=");
  if (parts.length == 2) return parts.pop().split(";").shift();
}

getCookie('PHPSESSID'); 
```

# windows-vista - 您会为 Windows Vista 推荐 32 位还是 64 位？

> ID：754764
> 
> 赞同：2
> 
> 时间：2009-04-16T04:32:06.027
> 
> 标签：windows-vista, 64-bit, compatibility, 32-bit

我知道64位是最好的。但是，我听说 32 位程序可能存在兼容性问题。这个兼容性问题对于我获得 32 位操作系统来说是一个足够大的问题，还是 64 位 Windows Vista 更好，尽管存在兼容性问题？

我主要将其用于开发目的，但我可能会偷偷参加一些游戏。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T04:40:43.230

取决于你想做什么。

对于开发人员来说，肯定会选择 64 位，因为这样您就可以拥有大量 RAM。

在 StackOverflow 播客之一中，Jeff 说，因为 Vista 积极缓存磁盘数据，拥有大量 RAM 改变了他的生活。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-16T04:46:55.710

自 11 月以来，我一直有一台 64 位 Vista 笔记本电脑，并且只有一个兼容性问题。那个问题太小了，我什至不记得是什么了！

与此同时，我正在运行 Visual Studio 2008、SQL Server 2008 等，没有任何问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T04:45:01.970

64 位最大的问题是驱动程序支持。Vista 64 位要求所有设备驱动程序都经过签名，因此如果您无法为外围设备获得签名的设备驱动程序，则无法在 Vista 中使用它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T04:44:45.700

您需要使用 Cisco VPN 客户端吗？

如果是这样，我会说选择 32 位 - 即使你有 4GB 的 RAM。围绕如此重要的软件存在很多问题，许多远程工作者都离不开它。

如果您有 8gb 或更多的 RAM，那么肯定会选择 64 位，就像您运行 32 位操作系统一样，您将丢弃 4+ gb（Windows 32 位操作系统只能处理 3.4gb 左右的一些值）。

如果您只有 4gb 的 RAM，那么您只会错过 600mb 的内存并获得提高应用程序兼容性的好处。

你的旅费可能会改变。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-16T05:01:14.710

我同时运行了几个系统。我会说64位肯定更好。如果您想在 64 位系统中支持较旧的 Cisco VPN，请尝试使用[Shrew VPN 客户端](http://www.shrew.net)。我用它来连接一个 12.3 版本的 Cisco 800 系列路由器，效果很好。DHCP 似乎还不能正常工作，但您始终可以设置静态 ips。您还可以升级您的路由器以支持任何连接，它也支持 64 位。

64位都是关于RAM的。我在我的机器上添加了 8 个演出。我注意到从 2 GB 到 4 GB 的巨大好处。从 4 到 8 并没有那么多，直到我开始运行 Visual Studio 和我一次运行的所有其他东西。在那之后就像闪电一样。

如果您购买了好的硬件，驱动程序支持不是问题。例如，最大的问题通常是视频驱动程序。如果您购买的是Nvidia卡，您可以修改INF中的设备类型，使其加载标准驱动程序，一切正常。即使您不幸获得了英特尔视频卡，您仍然可以下载一个实用程序来计算 INF 文件的十六进制代码，并最终设法获得您从同事那里偷来的 1600 分辨率戴尔显示器作为第二台显示器。

即使让 SSIS（SQL Server）在其中工作也不错，因为 Excel 只是 32 位的。我已经找到了解决所有这些问题的方法，并且真的有很多 RAM !!! 确实有助于提高计算机的速度。三星将在其 You Tube 视频中向您展示硬盘驱动器的速度究竟有多慢。他们以每秒 1/2 秒的速度从头开始加载所有 Office，加载速度约为每秒 2 GB。RAM = 缓存 = 速度。对我来说绝对值得。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T22:01:25.367

我也有 Vista/64。也没有什么大问题，但我没有一堆晦涩难懂的硬件（Vista 问题比 64 位问题多）。

然而，人们应该问自己，为什么偏离会有所收获。3.25GB 几乎总是足够的。

看起来微软打算将 32 位 Windows 7 作为默认 OEM 版本，这意味着 Windows 7 周期将主要是 32 位。（尽管可能迟早会出现一些 64 位的工作站市场）。

我是个例外，因为我有特殊原因，我想验证某些 64 位特定软件。（编译器）

所以简而言之：尽管 Vista/64 并不会真正受到伤害，但如果你没有真正的理由，为什么要冒险呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-07T04:11:00.880

如果您需要更多 RAM，请使用 64 位。32 位仍然是标准，也是最广泛支持的标准，许多应用程序甚至无法支持或利用 64 位。如果您不想冒任何不兼容的风险，请使用 32 位选项。如果您确实需要额外的 RAM 或打算为 64 位 Vista 进行开发，那么请选择 64 位版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T04:22:33.597

我不能说哪个更好，但我可以说我的工作电脑和笔记本电脑都运行 vista 64 位，我对任何一个都没有问题。因此，我看不出有任何理由使用 32 而不是 64。

# database - 数据库索引

> ID：754767
> 
> 赞同：2
> 
> 时间：2009-04-16T04:33:04.840
> 
> 标签：database, indexing

您将如何向某人解释如何明智地使用索引来提高数据库的性能？我正在寻找一个好的，清晰的解释，因为它在书中太复杂了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-16T05:41:04.647

请耐心等待，这将需要一段时间:-)。

考虑一个简单的地址簿，您只需在新朋友或同事到达时在末尾添加记录（下一个条目将在 5 处出现）：

```
1\. Bob Smith, 7 Station St, Wotahole, NJ
2\. Greg Jones, 3 Railway Pde, Boot Hill, KA
3\. Allan Brown, 27 Carriage Court, Washington, DC (home)
4\. Allan Brown, 1066 Hastings Street, Washington, DC (work)
5\. 
```

现在你需要找到某人的地址。没问题，我听到你说，只需扫描列表查找名称，然后读出地址。

现在，如果你非常受欢迎以至于有 1,024 个像我一样的朋友（我是个极客，我只分配朋友的 2 次方 - 我实际上有 2,024 个，但其中有 1,000 个被关押在不确定的单元中，我可以再加上 24 个 :-)。

为了找到一个特定的朋友，您必须平均扫描 512 个条目（其中一半正在使用）。这很乏味。最坏的情况是扫描所有 1,024 个以找到您添加的最后一个人。

现在让我们添加该索引。每次你添加一个新朋友/同事（或者如果他们给你带来太多麻烦就删除它们），你更新这个索引，它只存储按排序顺序的名称以及完整条目的行号（你地址中的索引页这本书很神奇，它会自动对你在其中写的所有内容进行排序）。

上面的迷你列表的索引是：

```
1\. Allan Brown, 3
2\. Allan Brown, 4
3\. Greg Jones, 2
4\. Bob Smith, 1 
```

名称和行号占用的空间比完整条目少，但最重要的方面是这一点。

为了找到一个条目，您只需要扫描，最坏的情况，10 个条目（日志[2] 1024）。首先，检查索引号 512。如果要查找的名称大于该名称，则只需查看条目 513-1024。如果它更少，那么您现在只对条目 1-511 感兴趣。无论哪种情况，您都立即将搜索空间减少了一半。

使用原始方法，您只能丢弃您检查的那个，因为您没有可用的订购信息。

所以搜索空间的大小是这样的（我实际上使用了 2 的幂作为索引方法，但它比这稍微好一些）：

```
+-----------+----------------+------------+
| Iteration | Indexed method | Old method |
+-----------+----------------+------------+
|    0      |   1024         |    1024    |
|    1      |    512         |    1023    |
|    2      |    256         |    1022    |
|    3      |    128         |    1021    |
|    4      |     64         |    1020    |
|    5      |     32         |    1019    |
|    6      |     16         |    1018    |
|    7      |      8         |    1017    |
|    8      |      4         |    1016    |
|    9      |      2         |    1015    |
|   10      |      1         |    1014    |
+-----------+----------------+------------+ 
```

找到索引后，从中提取行号，因为您知道每页有 16 个条目，所以条目号 275（例如）在第 18 页第 4 行。您可以直接去那里而无需进一步搜索。

因此，以多一点存储空间和一些时间维护索引为代价，您*大大*提高了搜索速度。这也是索引在数据库中的作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T04:37:27.387

我会使用经典的解释：

索引提供了一种有序且快速的方法来遍历数据集。

典型的例子是电话簿——它按姓名字母顺序编入索引——这加快了您的访问速度，因为您可以使用索引方法直接找到您想要查找的姓​​名。

数据库确实没有什么不同 - 您不必为 EmployeeId = 123 的员工扫描整个表。您只需扫描以已知顺序存储的索引，最终性能会好得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T05:08:53.223

如果您问题中的关键词是“明智地”，那么重要的是要提到索引的好处是快速查询，而权衡是速度和大小。

就像在电话簿中一样，维护索引需要一些额外的时间，索引本身也需要一些空间。每当向数据库中添加或删除记录时，都必须花费一些时间来更新索引。

因此，在具有高插入率等的数据库上过度使用索引可能不被认为是明智的使用。但是，谨慎地使用索引来帮助加快查询速度可以极大地提高性能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T04:37:46.717

[http://www.brentozar.com/archive/2006/04/sql-server-training-for-developers-primary-keys-indexes/](http://www.brentozar.com/archive/2006/04/sql-server-training-for-developers-primary-keys-indexes/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T04:38:44.810

数据库索引可以帮助数据库快速查找数据库表中的记录，就像索引可以帮助您快速查找书中的信息一样。我认为关键是索引正确的数据，以便数据库可以快速查找最有意义的数据。对于本书的示例，您不会索引每个单词，您只需索引用户最有可能想要查找的关键字。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T05:38:13.217

搜索数据时，如果用于搜索的字段已编入索引，您将获得对数据的直接引用（或数据范围，但在非技术性讨论中不提及）。

如果它们没有被索引，那么它必须搜索整个表来比较匹配。

# asp.net - 确定是否使用调试符号编译的 ASP.NET 项目的最快方法是什么？

> ID：754769
> 
> 赞同：1
> 
> 时间：2009-04-16T04:34:13.543
> 
> 标签：asp.net

确定是否使用调试符号编译的 ASP.NET 项目的最快方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T05:16:09.150

唯一最好的方法是检查编译的程序集本身。Rotem Bloom[在这里](http://www.codeplex.com/AssemblyInformation)找到了一个非常有用的工具，称为“.NET 程序集信息” 。安装后，它会关联 .dll 文件以自行打开。安装后，您只需双击程序集即可打开它，它将为您提供程序集详细信息，如下面的屏幕商店中所示。在那里您可以确定它是否已调试编译。

[替代文字 http://ruchitsurati.net/myfiles/asm_info.jpg](http://ruchitsurati.net/myfiles/asm_info.jpg)

链接文本：http : [//www.codeplex.com/AssemblyInformation](http://www.codeplex.com/AssemblyInformation)

希望这可以帮助..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T04:40:01.033

查看 web.config 中的 system.web/compilation 节点。如果它是在调试模式下编译的，你会看到

```
<compilation debug="true"> 
```

对于 Web 应用程序项目，您还可以在 bin 目录中查找 *.pdb 文件。

# sql - 这个 2 列表是否需要标准化？

> ID：754772
> 
> 赞同：0
> 
> 时间：2009-04-16T04:36:06.360
> 
> 标签：sql, database, database-design

我有 2 列：“string”“int”
我将两者都设置为唯一组合的主键。

基于字符串列的搜索是否会比进一步规范化字符串列并使用 2 个 int 列更差？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T04:39:28.740

您是否希望有很多重复的字符串？如果不是，那么规范化将不会产生任何结果。如果是，那么索引越少，重复的次数就越多。（因为必须检索具有相同索引的所有项目）

如果您的数据库引擎支持它，您可以简单地将字符串设置为聚集索引，在这种情况下，相似的字符串将彼此相邻存储。

如果您已经在两列上都有索引，并且正在比较它们，那么您将获得索引的全部好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T04:58:48.693

如果您确实需要字符串值，那么答案是否定的。

比较数据库中的字符串比比较一个 int，然后从 int 中查找字符串要便宜。

至于字符串的重复，您拥有的重复越多，如果它们被非规范化，您需要的存储空间就越少。不过还是会慢一些。

如果您正在寻找存储性能，请坚持使用 string,int PK。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T04:44:33.330

这实际上听起来很容易测试。

您可以双向设置表，生成 100,000 个随机行，对两者运行一些查询，然后查看哪个更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T11:41:32.713

该表已经标准化。

将字符串更改为 int 并不是进一步的规范化。

这可能看起来很挑剔，但“标准化”这个词已经被过度使用到它变得毫无意义的地步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T05:56:26.760

如果您使用的是 Oracle，您可能希望探索使用 COMPRESS 1 使其成为索引组织的表。

来自[Oracle 文档](http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_7002.htm#sthref7578)：

> 指定 COMPRESS 以启用键压缩，这消除了索引组织表中主键列值的重复出现。使用整数指定前缀长度，即要压缩的前缀列数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T07:38:50.493

索引使快速搜索成为可能。但请记住，如果数据库知道所有最重要的字段，它只能使用索引。例如，如果您有以下索引：

```
int, string 
```

然后数据库可以使用索引来搜索一个 int 或一个 int 和 string 的组合。但它不能用它来搜索字符串。

如果您创建两个单独的索引：

```
index 1: int
index 2: string 
```

然后数据库可以有效地搜索 int 和/或 string。

是否规范化表并不像索引的选择那么重要。规范化通常会减慢搜索速度，因为它会强制查找不同的表。

# c++ - C++ 中的 Yaml 发射器

> ID：754774
> 
> 赞同：5
> 
> 时间：2009-04-16T04:36:36.767
> 
> 标签：c++, yaml, yaml-cpp

是否有用于发出 YAML 的 C++ 库？Wikipedia 提到了 libyaml 的 c++ 包装器，但链接已损坏。官方 YAML 站点仅提供[yaml-cpp](http://code.google.com/p/yaml-cpp/)，这也在[这个](https://stackoverflow.com/questions/244784/yaml-serialization-library-for-c)SO question 中提出，但 cpp-yaml 只是一个解析器，而不是一个发射器。我运气不好？

**编辑**：我正在寻找面向对象的接口，因此需要 C++。我知道我可以在 C++ 代码中使用 libyaml 的 C 接口，但这并不理想。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-01T03:56:09.653

根据您的建议，[yaml-cpp](http://code.google.com/p/yaml-cpp/)现在有一个发射器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T04:43:18.653

[libyaml](http://pyyaml.org/wiki/LibYAML)怎么样？

> LibYAML 是用 C 编写的 YAML 1.1 解析器和发射器。

而且，更直接地说，[`emitter.c`](http://pyyaml.org/browser/libyaml/trunk/src/emitter.c)?

# asp.net-mvc - asp.net mvc url 路由 - 子文件夹名称

> ID：754787
> 
> 赞同：1
> 
> 时间：2009-04-16T04:44:22.067
> 
> 标签：asp.net-mvc, url-routing

我想创建一个如下所示的网址：

*   [http://localhost/news/announcement/index](http://localhost/news/announcement/index)
*   [http://localhost/news/health/index](http://localhost/news/health/index)
*   [http://localhost/news/policy/index](http://localhost/news/policy/index)

公告、健康、政策是控制器

所以我制作了一个新的 url 路线图，如下所示：

```
routes.MapRoute(
 "News",
 "news/{controller}/{action}/{id}",
 new { controller = "Announcement", action = "Index", id = "" }
); 
```

它工作正常，但是，以下两个网址显示相同的页面：

*   [http://localhost/news/announcement/index](http://localhost/news/announcement/index)
*   [http://localhost/公告/索引](http://localhost/announcement/index)

我想阻止第二个网址。

我该怎么办？

谢谢权

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-16T05:04:13.453

如果您仍然设置了默认路由，则需要将其删除或添加路由约束，使其与您的新闻路径不匹配。

删除这个：

```
routes.MapRoute( "Default",
                 "{controller}/{action}/{id}",
                 new { controller = "Home", action = "Index", id = "" } ); 
```

或者添加一个约束：

```
routes.MapRoute( "Default",
                 "{controller}/{action}/{id}",
                 new { controller = "Home", action = "Index", id = "" },
                 new { controller = "(Home|Other)" } ); 
```

该约束将允许默认路由仅匹配控制器 Home 和 Other，但不匹配 Announcement、Health 或 Policy（或其他任何内容）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T05:04:54.437

如果有任何默认路由映射，则将其移动到映射的末尾。如果这没有帮助，那么您可以尝试[Url Routing Debugger](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T05:49:24.687

从逻辑上讲，第二个 url 不应该工作。因为**新闻**是您在 IIS 中托管的应用程序名称，我猜您可能已将其放在默认网站中。因此，如果您正在访问应用程序 URL 将始终

[http://localhost/](http://localhost/)**新闻**/控制器/动作

如果你给这个

[http://localhost/controller/action](http://localhost/controller/action)，它不知道要查看哪个应用程序。

如果您还没有创建一个虚拟目录“新闻”，我建议您创建一个虚拟目录，然后在那里发布所有内容。还要确保您没有在 Inetpub\wwwroot\ 目录中发布您的应用程序文件。

我正在等待您的回复继续。

# c - A C daemon that does traffic shaping

> ID：754791
> 
> 赞同：2
> 
> 时间：2009-04-16T04:45:04.607
> 
> 标签：c, linux, networking, trafficshaping

I'm working on a C daemon that monitors a configuration file (updated using a web interface) and then uses the Linux "tc" (traffic control) command to update the systems traffic shaping configuration.

What's a good way to actually invoke the tc program? Should I use the exec family? Is there a library I can use that would be a bit more elegant? Using exec or system just seems a bit hacky to me.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:54:23.120

Why don't you look at the source code of the *tc* program and figure out how to modify the *systems traffic shaping configuration* directly from your deamon? That would save you calling *tc* and parsing it's output.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T05:12:45.743

Look at popen [http://linux.die.net/man/3/popen](http://linux.die.net/man/3/popen)

# c# - Debugging a Process.Start()'ed application

> ID：754793
> 
> 赞同：4
> 
> 时间：2009-04-16T04:45:48.817
> 
> 标签：c#, debugging, process

I have a C# class library (which is an AutoCAD .net application) and a console application.

Somewhere in the class library, it starts the console application using Process.Start()

I have both of these projects with the same solution, I have set the class library as the startup project (to launch AutoCAD). I can debug the class library, but not the console application.

How can I debug the console application given this configuration?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:51:22.597

You need to use the Debug->Attach To Process option in Visual Studio.

# javascript - How to disable a link in IE6

> ID：754807
> 
> 赞同：0
> 
> 时间：2009-04-16T04:59:57.193
> 
> 标签：javascript, jquery

I want to disable links in a page.

I used the function below, which is working in FF3 & IE7, but it is not working on IE6.

```
$(document).ready(function() {
    $("a").attr("href", "")
          .unbind("click")
          .click(function() { return false });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T05:24:22.703

What about this?

```
$(document).ready(function() {
    $("a").removeAttr('href');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T05:20:05.087

try

```
window.onload= function(){
        DisableEnableLinks(true)
}

function DisableEnableLinks(xHow){
  objLinks = document.links;
  for(i=0;i<objLinks.length;i++){
    objLinks[i].disabled = xHow;
    //link with onclick
    if(objLinks[i].onclick && xHow){  
        objLinks[i].onclick = new Function("return false;" + objLinks[i].onclick.toString().getFuncBody());
    }
    //link without onclick
    else if(xHow){  
      objLinks[i].onclick = function(){return false;}
    }
    //remove return false with link without onclick
    else if(!xHow && objLinks[i].onclick.toString().indexOf("function(){return false;}") != -1){            
      objLinks[i].onclick = null;
    }
    //remove return false link with onclick
    else if(!xHow && objLinks[i].onclick.toString().indexOf("return false;") != -1){  
      strClick = objLinks[i].onclick.toString().getFuncBody().replace("return false;","")
      objLinks[i].onclick = new Function(strClick);
    }
  }
}

String.prototype.getFuncBody = function(){ 
  var str=this.toString(); 
  str=str.replace(/[^{]+{/,"");
  str=str.substring(0,str.length-1);   
  str = str.replace(/\n/gi,"");
  if(!str.match(/\(.*\)/gi))str += ")";
  return str; 
} 
```

courtesy of [http://radio.javaranch.com/pascarello/2005/05/17/1116355421179.html](http://radio.javaranch.com/pascarello/2005/05/17/1116355421179.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T05:34:26.627

In some subversions of IE there is a bug which is the source of your problem. It ignores the onclick event's result. So what can you do? Well not a perfect way but IE6 also accepts "disabled" property for links. So try also setting the "disabled" property to ture. This will not effect other browsers.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T13:00:02.710

对锚标记的任何点击都会生成一个冒泡到正文的点击事件。最简单的方法是在 body 上放置一个 click 处理程序，如果目标元素是锚点，它什么都不做并返回 false。

# zend-framework - 如何在 Zend Framework 中生成用于重置密码的随机密码或临时 URL？

> ID：754810
> 
> 赞同：7
> 
> 时间：2009-04-16T05:02:48.123
> 
> 标签：zend-framework, authentication, forgot-password

我有一个使用`Zend_Auth_Adapter_DbTable`. 我的身份验证控制器上有登录和注销操作。现在我想创建一个功能来重置忘记的密码，方法是自动生成密码，保存新密码，并向他们发送一封包含新生成密码的电子邮件。

这样做的最佳过程是什么？我应该如何生成新密码？Zend 框架有什么可以让这更容易吗？

我还听说过发送一封电子邮件，其中包含指向短期页面的链接，可让他们设置新密码。Zend 框架如何做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-16T05:40:50.013

Zend Framework 没有密码生成类。这里有一篇关于如何使用 PEAR 模块`Text_Password`生成密码的文章： [https ://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/howdoi/?p=118](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/howdoi/?p=118)

但是，通过普通电子邮件发送密码并不是一个好的安全做法。相反，您应该重置他们的帐户，以便他们可以在不提供密码的情况下临时登录（给定您在电子邮件中发送给他们的过期 URL），并且一旦他们登录，要求他们将自己的密码更新为*他们*知道的密码。然后存储他们密码的加盐哈希。

* * *

以下是我在 Zend Framework 中执行此操作的一些建议：

*   定义一个`AccountReset`包含以下字段的表：`reset_id`（GUID 主键）、`account_id`（对 的引用`Accounts.account_id`）和`expiration`（时间戳）。
*   实现一个名为 的操作`AccountController::resetAction()`，即在您用于创建帐户、登录、更改密码等的同一控制器中。
*   当用户选择重置他的帐户时，在表中插入一个新行，该行`AccountReset`具有新的 GUID、对用户帐户的引用以及`expiration`未来 30 分钟左右的时间。
*   向该用户的存档地址发送电子邮件，包括他应该点击的 URL：“https.../account/reset/reset_id/ `<`GUID `>`”（如果您对路由规则很了解，您可以缩短该 URL，但将 GUID 保留在其中）。
*   当收到请求时，它会在表中`AccountController::resetAction()`查找其`reset_id`参数。`AccountReset`如果该 GUID 存在并且`expiration`时间尚未过去，则向用户提供一个表单以更改其密码（无需他经过身份验证和登录）。
*   如果`resetAction()`收到没有 GUID 的请求，或者 GUID 在数据库中不存在，或者该行已通过其`expiration`，则此操作可能会向用户显示一个按钮以启动新的重置请求，并发送带有新的 GUID。请记住将此按钮设为 POST 请求！

由于 GUID 仅通过电子邮件发送到该用户的地址，因此其他人无法获得更改密码的访问权限。即使用户的电子邮件被截获，GUID 也只会在有限的时间内授予该访问权限。

如果您想更加谨慎，可以在`AccountReset`表中记下客户端 IP 地址，并要求在 30 分钟窗口内从具有相同 IP 地址的客户端更改密码。

这只是现成的，我还没有实现它或评估它的适当安全性。如果您负责实施安全性，那么您有责任阅读安全性问题。一个广受好评的 PHP 安全资源是[http://phpsecurity.org/](http://phpsecurity.org/)。

# iphone - AudioServicesCreateSystemSoundID 内存泄漏？

> ID：754811
> 
> 赞同：0
> 
> 时间：2009-04-16T05:02:54.160
> 
> 标签：iphone

我刚开始使用 Instruments 及其泄漏检测功能。我正在监视我的代码，并且在调用该方法时发现有泄漏：

AudioServicesCreateSystemSoundID

我基本上使用的是节拍器示例代码中的 SoundEffect.m 文件。我正在使用最初是 .wav 的声音文件，我使用 Itunes 将其转换为 aif 并将其重命名为 caf。它播放得很好，直到我运行 Instruments 我才意识到有泄漏。

奇怪的是，当我使用不同的声音文件（tick.caf - 来自 Mentronome 示例项目）时 - 没有泄漏。此处描述了相同的问题，但没有真正回答原因：

[http://discussions.apple.com/thread.jspa?messageID=8360344](http://discussions.apple.com/thread.jspa?messageID=8360344)

无论如何，我的声音文件有什么原因会导致泄漏吗？Audio Toolkit 是否对它试图播放的音频文件特别挑剔？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T05:31:01.067

我不明白为什么会导致泄漏，但在播放`aiff`名为`caf`. 尝试转换使用以从您的 mac`afconvert`生成真实文件：`caf`

```
afconvert -f caff -d ima4 input.mp3 output.caf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-18T09:00:04.640

使用 AudioServicesDisposeSystemSoundID 进行处理。

# c# - Running PowerShell file in C#, how to do that in an ASP.NET form?

> ID：754819
> 
> 赞同：3
> 
> 时间：2009-04-16T05:11:00.753
> 
> 标签：c#, asp.net, powershell

I have made a [PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell) script, which is running perfectly fine and generating a text file when I run it standalone. I wanted to automate that whenever my [ASP.NET](http://en.wikipedia.org/wiki/ASP.NET) page loads I invoke a process from C# that calls my PowerShell script and executes that leading to a text file being generated.

The problem is the script is being called, but not excuted. Giving some error about permissions, etc.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T07:24:21.543

要使用 C# 程序运行 powershell，您可以使用带有“C:\WINDOWS\system32\windowspowershell\v1.0\powershell.exe”的[Process.Start() ，并提供适当的 powershell 文件参数。](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start(VS.71).aspx)

如需更多信息，请运行

> C:\WINDOWS\system32\windowspowershell\v1.0\powershell.exe -?

关于权限问题，请阅读[Running Scripts From Within Windows PowerShell](http://www.microsoft.com/technet/scriptcenter/topics/winpsh/manual/run.mspx#EBD)，并确保 powershell 具有正确的 ExecutionPolicy。

更多信息： http: [//www.microsoft.com/technet/scriptcenter/resources/qanda/sept06/hey0926.mspx](http://www.microsoft.com/technet/scriptcenter/resources/qanda/sept06/hey0926.mspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T07:47:21.580

根据您运行 ASP.NET 脚本（VS 开发服务器或 IIS）的方式，您需要考虑到运行脚本的“用户”可能不是您，也可能没有与您一样可以访问相同的内容。

您可能需要更深入地了解它，而不是“关于权限等的一些错误”，因为该错误可能是您问题的本质。

您可能会发现 ProcMon（来自 www.sysinternals.com）是查找权限问题所在的有用工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T22:12:51.670

您应该考虑的另一个选项是直接在您的代码中运行脚本，这应该消除对文本文件的需求。

[http://msdn.microsoft.com/en-us/library/ms714661(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms714661(VS.85).aspx)

[http://devcentral.f5.com/weblogs/Joe/archive/2009/01/16/powershell-abcs---r-is-for-runspace.aspx](http://devcentral.f5.com/weblogs/Joe/archive/2009/01/16/powershell-abcs---r-is-for-runspace.aspx)

[http://bartdesmet.net/blogs/bart/archive/2007/02/05/a-first-introduction-to-windows-powershell-runspaces.aspx](http://bartdesmet.net/blogs/bart/archive/2007/02/05/a-first-introduction-to-windows-powershell-runspaces.aspx) （请参阅最后的“托管运行空间”）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-08-26T01:23:33.620

我将利用[System.Management.Automation](http://msdn.microsoft.com/en-us/library/system.management.automation(v=vs.85).aspx)命名空间并创建一个 PowerShell 控制台对象。您可以将命令或 .ps1 文件（均带有参数）传递给它以供执行。比必须调用 powershell.exe 的单独 shell 要干净得多。

其他要确保适当的事情是应用程序池的身份。确保它具有执行 PowerShell 命令和/或脚本所需的权限级别。接下来，如果您要执行脚本文件，请确保您有适当的 Set-ExecutionPolicy。

这是执行由 TextBox Web 表单提交的命令的代码，就好像它是使用这些对象的 PowerShell 控制台一样 - 应该说明该方法：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Management.Automation;
using System.Text;

namespace PowerShellExecution
{
    public partial class Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void ExecuteCode_Click(object sender, EventArgs e)
        {
            // Clean the Result TextBox
            ResultBox.Text = string.Empty;

            // Initialize PowerShell engine
            var shell = PowerShell.Create();

            // Add the script to the PowerShell object
            shell.Commands.AddScript(Input.Text);

            // Execute the script
            var results = shell.Invoke();

            // display results, with BaseObject converted to string
            // Note : use |out-string for console-like output
            if (results.Count > 0)
            {
                // We use a string builder ton create our result text
                var builder = new StringBuilder();

                foreach (var psObject in results)
                {
                    // Convert the Base Object to a string and append it to the string builder.
                    // Add \r\n for line breaks
                    builder.Append(psObject.BaseObject.ToString() + "\r\n");
                }

                // Encode the string in HTML (prevent security issue with 'dangerous' caracters like < >
                ResultBox.Text = Server.HtmlEncode(builder.ToString());
            }
        }
    }
} 
```

要在页面加载时执行此操作，您需要创建一个满足您需求的函数并从“Page_Load”函数中调用它。

这是为您撰写的一篇文章，涵盖了如何使用 Visual Studio 从头到尾创建页面并完成此操作，[http](http://grokgarble.com/blog/?p=142) ://grokgarble.com/blog/?p=142 。

如果有帮助，请投票并适当标记。

谢谢，杰夫

# asp.net - 如何在网格视图内添加级联下拉列表以进行编辑？

> ID：754823
> 
> 赞同：2
> 
> 时间：2009-04-16T05:16:39.260
> 
> 标签：asp.net, ajax, gridview

我有一个相当标准的 ASP.NET GridView，它显示 2 个具有父子关系的列。虽然数据库中存在A列和B列之间的关系，但GridView并没有实现它。

我想做以下事情：当用户选择编辑行时，2个下拉菜单变得可见。DropDownB 应根据 DropDownA 的值自动填充可用选项。当 DropDownA 更改时，需要更新 DropDownB 以反映当前选项。

当前可用于网格的列：

```
 - ColumnAID
 - ColumnADescription
 - ColumnBID
 - ColumnBDescription 
```

我当然可以在网格之外完成同样的功能，甚至可以让选定的行事件显示一个模式弹出窗口，允许我相应地编辑字段，但希望将其保留在网格中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-25T05:52:54.577

下面的示例显示了 2 个下拉列表假日组和假日类型。根据假日组的选择，将加载假日类型下拉菜单。这里的问题是将 Auto Postback 设置为“true”并定义第一个下拉列表的 selectindex 更改事件分别`OnSelectedIndexChanged="CboHolidayGroup_SelectedIndexChanged"`
将“（”和“）”替换为“<”和“>”。
以下代码可用于网格视图内的级联下拉菜单：

**设计页面**

```
(asp:TemplateField HeaderText="(*) Holiday Group")
    (ItemStyle CssClass="TEXTBOX_MEDIUM" /)
    (EditItemTemplate)
        (asp:DropDownList ID="CboHolidayGroup" CssClass="DROPDOWN_SMALL" runat="server"
            DataTextField="holidaygroup" DataValueField="holiday_group_code_id" AutoPostBack="true"
            OnSelectedIndexChanged="CboHolidayGroup_SelectedIndexChanged")
        (/asp:DropDownList)
        (asp:RangeValidator ID="RvHolidayGroup" runat="server" ControlToValidate="CboHolidayGroup"
            Display="None" ErrorMessage="Please Select Holiday Group" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpUpdate")
        (/asp:RangeValidator)
    (/EditItemTemplate)
    (ItemTemplate)
        (asp:Label ID="LblHolidayGroup" CssClass="DROPDOWN_SMALL" runat="server" Text='<%# Eval("holidaygroup") %>')(/asp:Label)
    (/ItemTemplate)
    (FooterTemplate)
        (asp:DropDownList ID="CboNewHolidayGroup" CssClass="DROPDOWN_SMALL" runat="server"
            DataTextField="holidaygroup" DataValueField="holiday_group_code_id" Enabled="false"
            AutoPostBack="true" OnSelectedIndexChanged="CboHolidayGroup_SelectedIndexChanged")
        (/asp:DropDownList)
        (asp:RangeValidator ID="RvNewHolidayGroup" runat="server" ControlToValidate="CboNewHolidayGroup"
            Display="None" ErrorMessage="Please Select Holiday Group" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpInsert")
        (/asp:RangeValidator)
    (/FooterTemplate)
(/asp:TemplateField)
(asp:TemplateField HeaderText="(*) Holiday Type")
    (ItemStyle CssClass="DROPDOWN_XLARGE" /)
    (EditItemTemplate)
        (asp:DropDownList ID="CboHolidayType" CssClass="DROPDOWN_XLARGE" runat="server"
            DataTextField="holidaytype" DataValueField="holiday_type_code_id")
        (/asp:DropDownList)
        (asp:RangeValidator ID="RvHolidayType" runat="server" ControlToValidate="CboHolidayType"
            Display="None" ErrorMessage="Please Select Holiday Type" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpUpdate")
        (/asp:RangeValidator)
    (/EditItemTemplate)
    (ItemTemplate)
        (asp:Label ID="LblHolidayType" CssClass="DROPDOWN_XLARGE" runat="server" Text='<%# Eval("holidaytype") %>')(/asp:Label)
    (/ItemTemplate)
    (FooterTemplate)
        (asp:DropDownList ID="CboNewHolidayType" CssClass="DROPDOWN_XLARGE" runat="server"
            DataTextField="holidaytype" DataValueField="holiday_type_code_id" Enabled="false")
        (/asp:DropDownList)
        (asp:RangeValidator ID="RvNewHolidayType" runat="server" ControlToValidate="CboNewHolidayType"
            Display="None" ErrorMessage="Please Select Holiday Type" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpInsert")
        (/asp:RangeValidator)
    (/FooterTemplate)
(/asp:TemplateField) 
```

**代码背后和设计**

```
<asp:TemplateField HeaderText="(*) Holiday Group">
    <ItemStyle CssClass="TEXTBOX_MEDIUM" />
    <EditItemTemplate>
        <asp:DropDownList ID="CboHolidayGroup" CssClass="DROPDOWN_SMALL" runat="server"
            DataTextField="holidaygroup" DataValueField="holiday_group_code_id" AutoPostBack="true"
            OnSelectedIndexChanged="CboHolidayGroup_SelectedIndexChanged">
        </asp:DropDownList>
        <asp:RangeValidator ID="RvHolidayGroup" runat="server" ControlToValidate="CboHolidayGroup"
            Display="None" ErrorMessage="Please Select Holiday Group" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpUpdate">
        </asp:RangeValidator>
    </EditItemTemplate>
    <ItemTemplate>
        <asp:Label ID="LblHolidayGroup" CssClass="DROPDOWN_SMALL" runat="server" Text='<%# Eval("holidaygroup") %>'></asp:Label>
    </ItemTemplate>
    <FooterTemplate>
        <asp:DropDownList ID="CboNewHolidayGroup" CssClass="DROPDOWN_SMALL" runat="server"
            DataTextField="holidaygroup" DataValueField="holiday_group_code_id" Enabled="false"
            AutoPostBack="true" OnSelectedIndexChanged="CboHolidayGroup_SelectedIndexChanged">
        </asp:DropDownList>
        <asp:RangeValidator ID="RvNewHolidayGroup" runat="server" ControlToValidate="CboNewHolidayGroup"
            Display="None" ErrorMessage="Please Select Holiday Group" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpInsert">
        </asp:RangeValidator>
    </FooterTemplate>
</asp:TemplateField>
<asp:TemplateField HeaderText="(*) Holiday Type">
    <ItemStyle CssClass="DROPDOWN_XLARGE" />
    <EditItemTemplate>
        <asp:DropDownList ID="CboHolidayType" CssClass="DROPDOWN_XLARGE" runat="server" DataTextField="holidaytype"
            DataValueField="holiday_type_code_id">
        </asp:DropDownList>
        <asp:RangeValidator ID="RvHolidayType" runat="server" ControlToValidate="CboHolidayType"
            Display="None" ErrorMessage="Please Select Holiday Type" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpUpdate">
        </asp:RangeValidator>
    </EditItemTemplate>
    <ItemTemplate>
        <asp:Label ID="LblHolidayType" CssClass="DROPDOWN_XLARGE" runat="server" Text='<%# Eval("holidaytype") %>'></asp:Label>
    </ItemTemplate>
    <FooterTemplate>
        <asp:DropDownList ID="CboNewHolidayType" CssClass="DROPDOWN_XLARGE" runat="server"
            DataTextField="holidaytype" DataValueField="holiday_type_code_id" Enabled="false">
        </asp:DropDownList>
        <asp:RangeValidator ID="RvNewHolidayType" runat="server" ControlToValidate="CboNewHolidayType"
            Display="None" ErrorMessage="Please Select Holiday Type" MaximumValue="1000"
            MinimumValue="1" SetFocusOnError="true" Type="Integer" ValidationGroup="VgrpInsert">
        </asp:RangeValidator>
    </FooterTemplate>
</asp:TemplateField> 
```

.

```
#Region "CboHolidayGroup_SelectedIndexChanged"
Protected Sub CboHolidayGroup_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs)
    Dim sGroup As String = String.Empty
    Dim intGroup As Integer = 0
    Dim dtNewHolidayType As DataTable
    Dim dtHolidayType As DataTable
    Dim objAims As iSymbol = Factory.Factory.CreateSymbolObject()

    If DirectCast(sender, DropDownList).SelectedIndex > 0 Then
        If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("CboHolidayGroup")) Then
            sGroup = DirectCast(sender, DropDownList).SelectedItem.Text
            intGroup = DirectCast(sender, DropDownList).SelectedValue
            If sGroup = "Bank" Then
                If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("ChkBankHoliday")) Then
                    DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("ChkBankHoliday"), CheckBox).Checked = True
                End If

                If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday")) Then
                    DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday"), CheckBox).Checked = True
                End If
            Else
                If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("ChkBankHoliday")) Then
                    DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("ChkBankHoliday"), CheckBox).Checked = False
                End If

                If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday")) Then
                    DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday"), CheckBox).Checked = False
                End If
            End If

            If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("CboHolidayType")) Then
                Dim CboHolidayType As DropDownList = DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("CboHolidayType"), DropDownList)
                dtHolidayType = objSymbol.GetSelectedHolTypes(intGroup)
                If (dtHolidayType.Rows.Count > 0) Then
                    CboHolidayType.DataSource = dtHolidayType
                    CboHolidayType.DataTextField = "holidaytype"
                    CboHolidayType.DataValueField = "holiday_type_code_id"
                    CboHolidayType.DataBind()
                    AddFirstItem(CboHolidayType, _CON_COMBO_FIRST_SELECT)
                End If
            End If
        End If

        If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("CboNewHolidayGroup")) Then
            sGroup = DirectCast(sender, DropDownList).SelectedItem.Text
            intGroup = DirectCast(sender, DropDownList).SelectedValue
            If sGroup = "Bank" Then
                If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday")) Then
                    DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday"), CheckBox).Checked = True
                End If
            Else
                If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday")) Then
                    DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("ChkNewBankHoliday"), CheckBox).Checked = False
                End If
            End If

            If Not IsNothing(DirectCast(sender, DropDownList).Parent.FindControl("CboNewHolidayType")) Then
                Dim CboNewHolidayType As DropDownList = DirectCast(DirectCast(sender, DropDownList).Parent.FindControl("CboNewHolidayType"), DropDownList)
                dtHolidayType = objSymbol.GetSelectedHolTypes(intGroup)
                If (dtHolidayType.Rows.Count > 0) Then
                    CboNewHolidayType.DataSource = dtHolidayType
                    CboNewHolidayType.DataTextField = "holidaytype"
                    CboNewHolidayType.DataValueField = "holiday_type_code_id"
                    CboNewHolidayType.DataBind()
                    AddFirstItem(CboNewHolidayType, _CON_COMBO_FIRST_SELECT)
                End If                    
            End If
        End If
    End If
End Sub
#End Region 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T06:02:03.643

这就是你应该这样做的方式。

1.) 转到 GridView 的列编辑器。并将列转换为要显示 DropDownList 而不是 TextBox 的模板。

2.) 转到 GridView SmartTag 并选择编辑模板的选项。在 GridView 列编辑器中选择您转换为模板的列。

3.) 此列将包含所有视图的模板。选择编辑视图。这已经有 TextBox 了。

4.) 删除 TxtBox 并在那里放置一个 DropDownList。您需要配置 DropDownList 以使用 ObjectDataSource 或 SqlDataSource 从 Foreign Table 填充数据。价值道具。DropDownList 的值应设置为 ForeginTable 的 P.Key。

5.) 现在，将 SelectedValue 字段绑定到表中的 Foregin 键。如果您使用 Bind，它将执行双向绑定到读/写，如果您使用 Eval，它将执行单向绑定到读取并仅设置默认值。

欲了解更多信息，请访问此[链接](http://www.asp.net/learn/data-access/tutorial-20-cs.aspx)。

LinkTxt：[http ://www.asp.net/learn/data-access/tutorial-20-cs.aspx](http://www.asp.net/learn/data-access/tutorial-20-cs.aspx)

谢谢。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T05:22:47.700

部分答案是 DataSources 有一个范围。如果您在模板内创建它们，则它们仅存在于该模板中。如果你让它们相互依赖并且在相同的范围内，它们应该级联。

# objective-c - 在 Objective-C 中获取对象属性列表

> ID：754824
> 
> 赞同：110
> 
> 时间：2009-04-16T05:17:16.620
> 
> 标签：objective-c, class, properties, attributes, introspection

如何在 Objective-C 中获取给定对象属性 的列表（以`NSArray`or的形式）？`NSDictionary`

想象一下以下场景：我定义了一个父类，它只是 extends `NSObject`，它包含一个`NSString`、 a`BOOL`和一个`NSData`对象作为属性。然后我有几个类扩展了这个父类，每个类都添加了很多不同的属性。

有什么方法可以在*父*类上实现一个实例方法，该方法遍历整个对象并返回，比如说，`NSArray`每个（子）类属性中的一个，`NSStrings`因为它们*不在*父类上，所以我以后可以使用这些`NSString`为KVC？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-04-16T07:45:49.260

我自己设法得到了答案。通过使用 Obj-C 运行时库，我可以按照我想要的方式访问属性：

```
- (void)myMethod {
    unsigned int outCount, i;
    objc_property_t *properties = class_copyPropertyList([self class], &outCount);
    for(i = 0; i < outCount; i++) {
        objc_property_t property = properties[i];
        const char *propName = property_getName(property);
        if(propName) {
            const char *propType = getPropertyType(property);
            NSString *propertyName = [NSString stringWithCString:propName
                                                                encoding:[NSString defaultCStringEncoding]];
            NSString *propertyType = [NSString stringWithCString:propType
                                                                encoding:[NSString defaultCStringEncoding]];
            ...
        }
    }
    free(properties);
} 
```

这需要我制作一个“getPropertyType”C 函数，该函数主要取自 Apple 代码示例（现在不记得确切的来源）：

```
static const char *getPropertyType(objc_property_t property) {
    const char *attributes = property_getAttributes(property);
    char buffer[1 + strlen(attributes)];
    strcpy(buffer, attributes);
    char *state = buffer, *attribute;
    while ((attribute = strsep(&state, ",")) != NULL) {
        if (attribute[0] == 'T') {
            if (strlen(attribute) <= 4) {
                break;
            }
            return (const char *)[[NSData dataWithBytes:(attribute + 3) length:strlen(attribute) - 4] bytes];
        }
    }
    return "@";
} 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2011-12-05T03:55:38.633

@boliva 的回答很好，但需要一些额外的东西来处理原语，如 int、long、float、double 等。

我在他的基础上添加了这个功能。

```
// PropertyUtil.h
#import 

@interface PropertyUtil : NSObject

+ (NSDictionary *)classPropsFor:(Class)klass;

@end

// PropertyUtil.m
#import "PropertyUtil.h"
#import "objc/runtime.h"

@implementation PropertyUtil

static const char * getPropertyType(objc_property_t property) {
    const char *attributes = property_getAttributes(property);
    printf("attributes=%s\n", attributes);
    char buffer[1 + strlen(attributes)];
    strcpy(buffer, attributes);
    char *state = buffer, *attribute;
    while ((attribute = strsep(&state, ",")) != NULL) {
        if (attribute[0] == 'T' && attribute[1] != '@') {
            // it's a C primitive type:
            /* 
                if you want a list of what will be returned for these primitives, search online for
                "objective-c" "Property Attribute Description Examples"
                apple docs list plenty of examples of what you get for int "i", long "l", unsigned "I", struct, etc.            
            */
            return (const char *)[[NSData dataWithBytes:(attribute + 1) length:strlen(attribute) - 1] bytes];
        }        
        else if (attribute[0] == 'T' && attribute[1] == '@' && strlen(attribute) == 2) {
            // it's an ObjC id type:
            return "id";
        }
        else if (attribute[0] == 'T' && attribute[1] == '@') {
            // it's another ObjC object type:
            return (const char *)[[NSData dataWithBytes:(attribute + 3) length:strlen(attribute) - 4] bytes];
        }
    }
    return "";
}

+ (NSDictionary *)classPropsFor:(Class)klass
{    
    if (klass == NULL) {
        return nil;
    }

    NSMutableDictionary *results = [[[NSMutableDictionary alloc] init] autorelease];

    unsigned int outCount, i;
    objc_property_t *properties = class_copyPropertyList(klass, &outCount);
    for (i = 0; i < outCount; i++) {
        objc_property_t property = properties[i];
        const char *propName = property_getName(property);
        if(propName) {
            const char *propType = getPropertyType(property);
            NSString *propertyName = [NSString stringWithUTF8String:propName];
            NSString *propertyType = [NSString stringWithUTF8String:propType];
            [results setObject:propertyType forKey:propertyName];
        }
    }
    free(properties);

    // returning a copy here to make sure the dictionary is immutable
    return [NSDictionary dictionaryWithDictionary:results];
}

@end 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-10-21T17:03:50.727

@orange80's answer has one problem: It actually doesn't always terminate the string with 0s. This can lead to unexpected results like crashing while trying to convert it to UTF8 (I actually had a pretty annoying crashbug just because of that. Was fun debugging it ^^). I fixed it by actually getting an NSString from the attribute and then calling cStringUsingEncoding:. This works like a charm now. (Also works with ARC, at least for me)

So this is my version of the code now:

```
// PropertyUtil.h
#import 

@interface PropertyUtil : NSObject

+ (NSDictionary *)classPropsFor:(Class)klass;

@end

// PropertyUtil.m
#import "PropertyUtil.h"
#import <objc/runtime.h>

@implementation PropertyUtil

static const char *getPropertyType(objc_property_t property) {
    const char *attributes = property_getAttributes(property);
    //printf("attributes=%s\n", attributes);
    char buffer[1 + strlen(attributes)];
    strcpy(buffer, attributes);
    char *state = buffer, *attribute;
    while ((attribute = strsep(&state, ",")) != NULL) {
        if (attribute[0] == 'T' && attribute[1] != '@') {
            // it's a C primitive type:
            /*
             if you want a list of what will be returned for these primitives, search online for
             "objective-c" "Property Attribute Description Examples"
             apple docs list plenty of examples of what you get for int "i", long "l", unsigned "I", struct, etc.
             */
            NSString *name = [[NSString alloc] initWithBytes:attribute + 1 length:strlen(attribute) - 1 encoding:NSASCIIStringEncoding];
            return (const char *)[name cStringUsingEncoding:NSASCIIStringEncoding];
        }
        else if (attribute[0] == 'T' && attribute[1] == '@' && strlen(attribute) == 2) {
            // it's an ObjC id type:
            return "id";
        }
        else if (attribute[0] == 'T' && attribute[1] == '@') {
            // it's another ObjC object type:
            NSString *name = [[NSString alloc] initWithBytes:attribute + 3 length:strlen(attribute) - 4 encoding:NSASCIIStringEncoding];
            return (const char *)[name cStringUsingEncoding:NSASCIIStringEncoding];
        }
    }
    return "";
}

+ (NSDictionary *)classPropsFor:(Class)klass
{
    if (klass == NULL) {
        return nil;
    }

    NSMutableDictionary *results = [[NSMutableDictionary alloc] init];

    unsigned int outCount, i;
    objc_property_t *properties = class_copyPropertyList(klass, &outCount);
    for (i = 0; i < outCount; i++) {
        objc_property_t property = properties[i];
        const char *propName = property_getName(property);
        if(propName) {
            const char *propType = getPropertyType(property);
            NSString *propertyName = [NSString stringWithUTF8String:propName];
            NSString *propertyType = [NSString stringWithUTF8String:propType];
            [results setObject:propertyType forKey:propertyName];
        }
    }
    free(properties);

    // returning a copy here to make sure the dictionary is immutable
    return [NSDictionary dictionaryWithDictionary:results];
}

@end 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-10-24T13:08:29.557

当我尝试使用 iOS 3.2 时，getPropertyType 函数不能很好地与属性描述配合使用。我从 iOS 文档中找到了一个示例：“Objective-C 运行时编程指南：声明的属性”。

这是 iOS 3.2 中属性列表的修改代码：

```
#import <objc/runtime.h>
#import <Foundation/Foundation.h>
...
unsigned int outCount, i;
objc_property_t *properties = class_copyPropertyList([UITouch class], &outCount);
for(i = 0; i < outCount; i++) {
    objc_property_t property = properties[i];
    fprintf(stdout, "%s %s\n", property_getName(property), property_getAttributes(property));
}
free(properties); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-08-09T09:13:29.193

I've found that boliva's solution works fine in the simulator, but on device the fixed length substring causes problems. I have written a more Objective-C-friendly solution to this problem that works on the device. In my version, I convert the C-String of the attributes to an NSString and perform string operations on it to get a substring of just the type description.

```
/*
 * @returns A string describing the type of the property
*/

+ (NSString *)propertyTypeStringOfProperty:(objc_property_t) property {
    const char *attr = property_getAttributes(property);
    NSString *const attributes = [NSString stringWithCString:attr encoding:NSUTF8StringEncoding];

    NSRange const typeRangeStart = [attributes rangeOfString:@"T@\""];  // start of type string
    if (typeRangeStart.location != NSNotFound) {
        NSString *const typeStringWithQuote = [attributes substringFromIndex:typeRangeStart.location + typeRangeStart.length];
        NSRange const typeRangeEnd = [typeStringWithQuote rangeOfString:@"\""]; // end of type string
        if (typeRangeEnd.location != NSNotFound) {
            NSString *const typeString = [typeStringWithQuote substringToIndex:typeRangeEnd.location];
            return typeString;
        }
    }
    return nil;
}

/**
* @returns (NSString) Dictionary of property name --> type
*/

+ (NSDictionary *)propertyTypeDictionaryOfClass:(Class)klass {
    NSMutableDictionary *propertyMap = [NSMutableDictionary dictionary];
    unsigned int outCount, i;
    objc_property_t *properties = class_copyPropertyList(klass, &outCount);
    for(i = 0; i < outCount; i++) {
        objc_property_t property = properties[i];
        const char *propName = property_getName(property);
        if(propName) {

            NSString *propertyName = [NSString stringWithCString:propName encoding:NSUTF8StringEncoding];
            NSString *propertyType = [self propertyTypeStringOfProperty:property];
            [propertyMap setValue:propertyType forKey:propertyName];
        }
    }
    free(properties);
    return propertyMap;
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-12-06T21:03:23.673

This implementation works with both Objective-C object types and C primitives. It is iOS 8 compatible. This class provides three class methods:

```
+ (NSDictionary *) propertiesOfObject:(id)object; 
```

Returns a dictionary of all visible properties of an object, including those from all its superclasses.

```
+ (NSDictionary *) propertiesOfClass:(Class)class; 
```

Returns a dictionary of all visible properties of a class, including those from all its superclasses.

```
+ (NSDictionary *) propertiesOfSubclass:(Class)class; 
```

Returns a dictionary of all visible properties that are *specific* to a subclass. Properties for its superclasses are *not* included.

One useful example of the use of these methods is to [copy an object to a subclass instance in Objective-C without having to specify the properties in a copy method](https://stackoverflow.com/questions/27336371/transform-or-copy-an-object-to-a-subclass-instance-in-objective-c). Parts of this answer are based on the other answers to this question but it provides a cleaner interface to the desired functionality.

Header:

```
//  SYNUtilities.h

#import <Foundation/Foundation.h>

@interface SYNUtilities : NSObject
+ (NSDictionary *) propertiesOfObject:(id)object;
+ (NSDictionary *) propertiesOfClass:(Class)class;
+ (NSDictionary *) propertiesOfSubclass:(Class)class;
@end 
```

Implementation:

```
//  SYNUtilities.m

#import "SYNUtilities.h"
#import <objc/objc-runtime.h>

@implementation SYNUtilities
+ (NSDictionary *) propertiesOfObject:(id)object
{
    Class class = [object class];
    return [self propertiesOfClass:class];
}

+ (NSDictionary *) propertiesOfClass:(Class)class
{
    NSMutableDictionary * properties = [NSMutableDictionary dictionary];
    [self propertiesForHierarchyOfClass:class onDictionary:properties];
    return [NSDictionary dictionaryWithDictionary:properties];
}

+ (NSDictionary *) propertiesOfSubclass:(Class)class
{
    if (class == NULL) {
        return nil;
    }

    NSMutableDictionary *properties = [NSMutableDictionary dictionary];
    return [self propertiesForSubclass:class onDictionary:properties];
}

+ (NSMutableDictionary *)propertiesForHierarchyOfClass:(Class)class onDictionary:(NSMutableDictionary *)properties
{
    if (class == NULL) {
        return nil;
    }

    if (class == [NSObject class]) {
        // On reaching the NSObject base class, return all properties collected.
        return properties;
    }

    // Collect properties from the current class.
    [self propertiesForSubclass:class onDictionary:properties];

    // Collect properties from the superclass.
    return [self propertiesForHierarchyOfClass:[class superclass] onDictionary:properties];
}

+ (NSMutableDictionary *) propertiesForSubclass:(Class)class onDictionary:(NSMutableDictionary *)properties
{
    unsigned int outCount, i;
    objc_property_t *objcProperties = class_copyPropertyList(class, &outCount);
    for (i = 0; i < outCount; i++) {
        objc_property_t property = objcProperties[i];
        const char *propName = property_getName(property);
        if(propName) {
            const char *propType = getPropertyType(property);
            NSString *propertyName = [NSString stringWithUTF8String:propName];
            NSString *propertyType = [NSString stringWithUTF8String:propType];
            [properties setObject:propertyType forKey:propertyName];
        }
    }
    free(objcProperties);

    return properties;
}

static const char *getPropertyType(objc_property_t property) {
    const char *attributes = property_getAttributes(property);
    char buffer[1 + strlen(attributes)];
    strcpy(buffer, attributes);
    char *state = buffer, *attribute;
    while ((attribute = strsep(&state, ",")) != NULL) {
        if (attribute[0] == 'T' && attribute[1] != '@') {
            // A C primitive type:
            /*
             For example, int "i", long "l", unsigned "I", struct.
             Apple docs list plenty of examples of values returned. For a list
             of what will be returned for these primitives, search online for
             "Objective-c" "Property Attribute Description Examples"
             */
            NSString *name = [[NSString alloc] initWithBytes:attribute + 1 length:strlen(attribute) - 1 encoding:NSASCIIStringEncoding];
            return (const char *)[name cStringUsingEncoding:NSASCIIStringEncoding];
        }
        else if (attribute[0] == 'T' && attribute[1] == '@' && strlen(attribute) == 2) {
            // An Objective C id type:
            return "id";
        }
        else if (attribute[0] == 'T' && attribute[1] == '@') {
            // Another Objective C id type:
            NSString *name = [[NSString alloc] initWithBytes:attribute + 3 length:strlen(attribute) - 4 encoding:NSASCIIStringEncoding];
            return (const char *)[name cStringUsingEncoding:NSASCIIStringEncoding];
        }
    }
    return "";
}

@end 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-08-19T12:21:30.360

If someone is in the need of getting as well **the properties inherited from the parent classes** (as I did) here is some modification on "**[orange80](https://stackoverflow.com/questions/754824/get-an-object-attributes-list-in-objective-c/8380836#8380836)**" code to make it recursive:

```
+ (NSDictionary *)classPropsForClassHierarchy:(Class)klass onDictionary:(NSMutableDictionary *)results
{
    if (klass == NULL) {
        return nil;
    }

    //stop if we reach the NSObject class as is the base class
    if (klass == [NSObject class]) {
        return [NSDictionary dictionaryWithDictionary:results];
    }
    else{

        unsigned int outCount, i;
        objc_property_t *properties = class_copyPropertyList(klass, &outCount);
        for (i = 0; i < outCount; i++) {
            objc_property_t property = properties[i];
            const char *propName = property_getName(property);
            if(propName) {
                const char *propType = getPropertyType(property);
                NSString *propertyName = [NSString stringWithUTF8String:propName];
                NSString *propertyType = [NSString stringWithUTF8String:propType];
                [results setObject:propertyType forKey:propertyName];
            }
        }
        free(properties);

        //go for the superclass
        return [PropertyUtil classPropsForClassHierarchy:[klass superclass] onDictionary:results];

    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-16T05:40:14.943

“属性”这个词有点模糊。您是指看起来像访问器的实例变量、属性、方法吗？

这三个问题的答案都是“是的，但这并不容易”。[Objective-C 运行时 API](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)包括获取类的 ivar 列表、方法列表或属性列表的函数（例如，）`class_copyPropertyList()`，然后为每种类型提供相应的函数，以获取列表中项目的名称（例如，`property_getName()`）。

总而言之，要做到这一点可能需要做很多工作，或者至少比大多数人想要做的事情要多得多，因为这通常相当于一个非常微不足道的功能。

或者，您可以编写一个 Ruby/Python 脚本，该脚本仅读取头文件并查找您认为该类的“属性”。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-03-31T06:51:23.763

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-06-25T12:21:57.420

You have three magic spells

```
Ivar* ivars = class_copyIvarList(clazz, &count); // to get all iVars
objc_property_t  *properties = class_copyPropertyList(clazz, &count); //to get all properties of a class 
Method* methods = class_copyMethodList(clazz, &count); // to get all methods of a class. 
```

Following piece of code can help you.

```
-(void) displayClassInfo
{
    Class clazz = [self class];
    u_int count;

    Ivar* ivars = class_copyIvarList(clazz, &count);
    NSMutableArray* ivarArray = [NSMutableArray arrayWithCapacity:count];
    for (int i = 0; i < count ; i++)
    {
        const char* ivarName = ivar_getName(ivars[i]);
        ivarArray addObject:[NSString  stringWithCString:ivarName encoding:NSUTF8StringEncoding]];
    }
    free(ivars);

    objc_property_t* properties = class_copyPropertyList(clazz, &count);
    NSMutableArray* propertyArray = [NSMutableArray arrayWithCapacity:count];
    for (int i = 0; i < count ; i++)
    {
        const char* propertyName = property_getName(properties[i]);
        [propertyArray addObject:[NSString  stringWithCString:propertyName encoding:NSUTF8StringEncoding]];
    }
    free(properties);

    Method* methods = class_copyMethodList(clazz, &count);
    NSMutableArray* methodArray = [NSMutableArray arrayWithCapacity:count];
    for (int i = 0; i < count ; i++)
    {
        SEL selector = method_getName(methods[i]);
        const char* methodName = sel_getName(selector);
        [methodArray addObject:[NSString  stringWithCString:methodName encoding:NSUTF8StringEncoding]];
    }
    free(methods);

    NSDictionary* classInfo = [NSDictionary dictionaryWithObjectsAndKeys:
                           ivarArray, @"ivars",
                           propertyArray, @"properties",
                           methodArray, @"methods",
                           nil];

        NSLog(@"%@", classInfo);
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-08-17T18:14:37.473

I was using function boliva provided, but apparently it stopped working with iOS 7\. So now instead of static const char *getPropertyType(objc_property_t property) one can just use the following:

```
- (NSString*) classOfProperty:(NSString*)propName{

objc_property_t prop = class_getProperty([self class], [propName UTF8String]);
if (!prop) {
    // doesn't exist for object
    return nil;
}
const char * propAttr = property_getAttributes(prop);
NSString *propString = [NSString stringWithUTF8String:propAttr];
NSArray *attrArray = [propString componentsSeparatedByString:@","];
NSString *class=[attrArray objectAtIndex:0];
return [[class stringByReplacingOccurrencesOfString:@"\"" withString:@""] stringByReplacingOccurrencesOfString:@"T@" withString:@""];
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-05-21T14:00:10.190

For Swift onlookers, you can get this functionality by utilising the `Encodable` functionality. I will explain how:

1.  Conform your object to `Encodable` protocol

    ```
    class ExampleObj: NSObject, Encodable {
        var prop1: String = ""
        var prop2: String = ""
    } 
    ```

2.  Create extension for `Encodable` to provide `toDictionary` functionality

    ```
     public func toDictionary() -> [String: AnyObject]? {
        let encoder = JSONEncoder()
        encoder.outputFormatting = .prettyPrinted
        guard let data =  try? encoder.encode(self),
              let json = try? JSONSerialization.jsonObject(with: data, options: .init(rawValue: 0)), let jsonDict = json as? [String: AnyObject] else {
            return nil
        }
        return jsonDict
    } 
    ```

3.  Call `toDictionary` on your object instance and access `keys` property.

    ```
    let exampleObj = ExampleObj()
    exampleObj.toDictionary()?.keys 
    ```

4.  Voila! Access your properties like so:

    ```
    for k in exampleObj!.keys {
        print(k)
    }
    // Prints "prop1"
    // Prints "prop2" 
    ```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-03-25T07:09:39.497

These answers are helpful, but I require more from that. All I want to do is to check whether the class type of a property is equal to that of an existing object. All the codes above are not capable of doing so, because: To get class name of an object, object_getClassName() returns texts like these:

```
__NSArrayI (for an NSArray instance)
__NSArrayM (for an NSMutableArray instance)
__NSCFBoolean (an NSNumber object initialized by initWithBool:)
__NSCFNumber (an NSValue object initialized by [NSNumber initWithBool:]) 
```

But if invoking getPropertyType(...) from above sample code, wit 4 objc_property_t structs of properties of a class defined like this:

```
@property (nonatomic, strong) NSArray* a0;
@property (nonatomic, strong) NSArray* a1;
@property (nonatomic, copy) NSNumber* n0;
@property (nonatomic, copy) NSValue* n1; 
```

it returns strings respectively as following:

```
NSArray
NSArray
NSNumber
NSValue 
```

So it is not able to determine whether an NSObject is capable of being the value of one property of the class. How to do that then?

Here is my full sample code(function getPropertyType(...) is the same as above):

```
#import <objc/runtime.h>

@interface FOO : NSObject

@property (nonatomic, strong) NSArray* a0;
@property (nonatomic, strong) NSArray* a1;
@property (nonatomic, copy) NSNumber* n0;
@property (nonatomic, copy) NSValue* n1;

@end

@implementation FOO

@synthesize a0;
@synthesize a1;
@synthesize n0;
@synthesize n1;

@end

static const char *getPropertyType(objc_property_t property) {
    const char *attributes = property_getAttributes(property);
    //printf("attributes=%s\n", attributes);
    char buffer[1 + strlen(attributes)];
    strcpy(buffer, attributes);
    char *state = buffer, *attribute;
    while ((attribute = strsep(&state, ",")) != NULL) {
        if (attribute[0] == 'T' && attribute[1] != '@') {
            // it's a C primitive type:

            // if you want a list of what will be returned for these primitives, search online for
            // "objective-c" "Property Attribute Description Examples"
            // apple docs list plenty of examples of what you get for int "i", long "l", unsigned "I", struct, etc.

            NSString *name = [[NSString alloc] initWithBytes:attribute + 1 length:strlen(attribute) - 1 encoding:NSASCIIStringEncoding];
            return (const char *)[name cStringUsingEncoding:NSASCIIStringEncoding];
        }
        else if (attribute[0] == 'T' && attribute[1] == '@' && strlen(attribute) == 2) {
            // it's an ObjC id type:
            return "id";
        }
        else if (attribute[0] == 'T' && attribute[1] == '@') {
            // it's another ObjC object type:
            NSString *name = [[NSString alloc] initWithBytes:attribute + 3 length:strlen(attribute) - 4 encoding:NSASCIIStringEncoding];
            return (const char *)[name cStringUsingEncoding:NSASCIIStringEncoding];
        }
    }
    return "";
}

int main(int argc, char * argv[]) {
    NSArray* a0 = [[NSArray alloc] init];
    NSMutableArray* a1 = [[NSMutableArray alloc] init];
    NSNumber* n0 = [[NSNumber alloc] initWithBool:YES];
    NSValue* n1 = [[NSNumber alloc] initWithBool:NO];
    const char* type0 = object_getClassName(a0);
    const char* type1 = object_getClassName(a1);
    const char* type2 = object_getClassName(n0);
    const char* type3 = object_getClassName(n1);

    objc_property_t property0 = class_getProperty(FOO.class, "a0");
    objc_property_t property1 = class_getProperty(FOO.class, "a1");
    objc_property_t property2 = class_getProperty(FOO.class, "n0");
    objc_property_t property3 = class_getProperty(FOO.class, "n1");
    const char * memberthype0 = getPropertyType(property0);//property_getAttributes(property0);
    const char * memberthype1 = getPropertyType(property1);//property_getAttributes(property1);
    const char * memberthype2 = getPropertyType(property2);//property_getAttributes(property0);
    const char * memberthype3 = getPropertyType(property3);//property_getAttributes(property1);
    NSLog(@"%s", type0);
    NSLog(@"%s", type1);
    NSLog(@"%s", type2);
    NSLog(@"%s", type3);
    NSLog(@"%s", memberthype0);
    NSLog(@"%s", memberthype1);
    NSLog(@"%s", memberthype2);
    NSLog(@"%s", memberthype3);

    return 0;
} 
```

# c++ - How to use pcap_sendqueue_queue() in winpcap library?

> ID：754828
> 
> 赞同：0
> 
> 时间：2009-04-16T05:18:39.050
> 
> 标签：c++, visual-c++, networking, network-programming, packet

I used pcap_sendPacket() to send raw UDP packet which i crafted manually.

i want to increase the performance of my code by reducing the

context switches.

But i got the sample code about pcap_sendqueue_queue() function

it sends variable number of packets in a time.but it reads read from

the already dumped .pcap file and .cap file.

i want to use this queue() function to send the same UDP packets which i crafted

it manually.

this is the link for sending the packets using pcap_sendpacket()?

[http://pastebin.com/m402783ae](http://pastebin.com/m402783ae)

how to modify this code to send this packets in a queue()?

thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T22:54:13.077

要使用 winpcap 的数据包队列，您必须调用：

*   `pcap_sendqueue_alloc`- 为原始数据包分配队列；
*   `pcap_sendqueue_queue`- 将原始数据包添加到队列中（`pcap`格式）；
*   `pcap_sendqueue_transmit`- 发送队列。

但是，我没有看到 winpcap 文档（或 Google）未涵盖的问题中的要点。

# svn - Exploring new version control systems. My biggest need: Reliable merging

> ID：754838
> 
> 赞同：6
> 
> 时间：2009-04-16T05:23:19.057
> 
> 标签：svn, version, version-control, release

I am a release engineer for a team of 35 programmers. We are working on PHP, Java, C# and SQL. We currently use Subversion, which has worked okay for about a year. We are going through a phase where conflicts are becoming more and more common. Our application footprints are growing, so performance is becoming an issue for checkouts and commits.

I'm wondering what commercial or FOSS version control systems and client software people can recommend that fit my profile: - Centralized repo - Simple merging - Fast exports, merges, checkouts - Conflict resolution

Thanks for you help!

; ) .randy

-- Added 2009-04-16 @ 06:21 PST

More info: our repo footprint is ~ 6GB. We've looked at Git and Bazaar. Great features and reasons to use them. We want a centralized repo.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-16T05:37:01.487

A common misunderstanding is that distributed version control systems like git or mercurial are no good for centralized repos. With that said I recommend you look at git if you haven't already.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T05:38:01.143

[Perforce](http://www.perforce.com/)是我的最爱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T12:04:12.360

尽管[Git](http://git-scm.com/)确实是一个不错的选择，但不要忘记“不断增长的应用程序占用空间”会带来其他问题，*无论您最终使用什么 SCM*。

即：

*   [应用程序架构](https://stackoverflow.com/questions/212270#212362)，以便将您的应用程序划分为更易于管理和独立（彼此）的“模块”（或组件）
*   [合并工作流程](https://stackoverflow.com/questions/216212#216228)：您的 SCM 需要处理[3-way merge](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know/645771#645771)，同时[避免 sideway-merges](https://stackoverflow.com/questions/170309/three-way-merge/170537#170537)。在维护阶段尤其如此，此时您既要维护生产中的版本，又要进行下一个版本的新开发。
*   [交付存储](https://stackoverflow.com/questions/735699/how-do-you-store-third-party-libraries-in-your-source-control/735733#735733)，以便轻松查询您的交付到测试环境、认证环境、生产环境......

* * *

关于合并功能，Perforce 或 Git 比 Subversion 更好，因为它们允许您合并任何您想要的子树，同时记住合并信息，并使用许多合并策略（我们的，他们的，...）。

即使在其最新的 1.6 版本中，Subversion 也仅支持[从分支的根目录进行](https://stackoverflow.com/questions/757831/commits-and-merges-on-svn-subdirectories-considered-harmful/757927#757927)*可靠* 的合并（您可以合并子树，但合并到您当前签出的子树*之外*的子树并不准确）`log`

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T10:39:57.693

[Bazaar](http://bazaar-vcs.org/)可用于许多不同类型的工作流程。请参阅这篇关于在[集中式工作流程](http://bazaar-vcs.org/Tutorials/CentralizedWorkflow)中使用它的文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T10:45:49.800

没有理由不能使用 Git 建立集中式存储库。[Git 支持任何工作流](http://whygitisbetterthanx.com/#any-workflow)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T23:07:38.543

查看：

*   [Accurev](http://www.accurev.com)
*   [塑料单片机](http://www.plasticscm.com)。查看它的 3D 树和分支浏览器，并探索那里的合并链接

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T12:18:33.200

我们对borland 的[Starteam](http://www.borland.com/us/products/starteam/index.html)很满意。即使是远程系统，签入/签出操作也很快，它还提供不同的视图和促销状态。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T16:48:01.810

无论您采用哪种方式，请确保将[FishEye](http://www.atlassian.com/software/fisheye/)添加到其中。随着复杂性的增加，有助于[管理您的代码。](http://www.atlassian.com/software/fisheye/features/analyse.jsp)

目前支持 SVN、Perforce 和 CVS。

# sharepoint - ServerContext.Current 为空

> ID：754845
> 
> 赞同：2
> 
> 时间：2009-04-16T05:27:28.593
> 
> 标签：sharepoint, moss

我面临着奇怪的问题。

我有从用户个人资料中读取数据的 wep 部分。一切都比我使用短服务器名称说**[http://server](http://server)**但我保持*ServerContext.Current*返回*null*然后我使用完全限定的服务器名称访问同一页面说**[http://server.zone.local](http://server.zone.local)**其中*zone.local*是 DNS区的后缀。

有没有人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T09:51:44.653

我再次自己找到了解决方案。

我刚刚在*管理中心*>*操作*>*备用访问映射*中将完全限定的 URL **[http://server.zone.local](http://server.zone.local)**映射到**[http://server](http://server)**，一切都按预期工作。

 ***# c# - 使用派生类在 C# 中进行序列化

> ID：754850
> 
> 赞同：4
> 
> 时间：2009-04-16T05:29:46.247
> 
> 标签：c#, serialization, derived-class

我正在构建一个通知框架，为此我正在序列化和反序列化一个基本类，我想要发送的所有类都将从该类派生。

问题是代码可以编译，但是当我实际尝试序列化这个基本类时，我收到一条错误消息

> System.Runtime.Serialization.SerializationException：在程序集“Xxx.DataContract，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”中键入“Xxx.DataContracts.WQAallocationUpdate”未标记为可序列化。

这是代码：

```
public class WCallUpdate : NotificationData
{
    private string m_from = "";
    [DataMember]
    public string From
    {
        get { return m_from; }
        set { m_from = value; }
    }
    private WCall m_wCall = new WCall();
    [DataMember]
    public WCall Call
    {
        get { return m_wCall; }
        set { m_wCall = value; }
    }
} 
```

`DataContract`通知的内容是：

```
/// <summary>
/// Basic class used in the notification service
/// </summary>
[DataContract]
public class NotificationData
{
}

/// <summary>
/// Enum containing all the events used in the application
/// </summary>
[DataContract]
public enum NotificationTypeKey
{
    [EnumMember]
    Default = 0,
    [EnumMember]
    IWorkQueueServiceAttributionAddedEvent = 1,
    [EnumMember]
    IWorkQueueServiceAttributionUpdatedEvent = 2,
    [EnumMember]
    IWorkQueueServiceAttributionRemovedEvent = 3,
} 
```

用于序列化数据的代码是：

```
 #region Create Message
    /// <summary>
    /// Creates a memoryStream from a notificationData
    /// note: we insert also the notificationTypeKey at the beginning of the
    /// stream in order to treat the memoryStream correctly on the client side
    /// </summary>
    /// <param name="notificationTypeKey"></param>
    /// <param name="notificationData"></param>
    /// <returns></returns>
    public MemoryStream CreateMessage(NotificationTypeKey notificationTypeKey, NotificationData notificationData)
    {
        MemoryStream stream = new MemoryStream();
        BinaryFormatter formatter = new BinaryFormatter();
        try
        {
            formatter.Serialize(stream, notificationTypeKey);
            formatter.Serialize(stream, notificationData);
        }
        catch (Exception ex)
        {
            Logger.Exception(ex);
        }
        return stream;
    }
    #endregion 
```

当我尝试创建消息时：

```
WCallUpdate  m_wCallUpdate = new WCallUpdate();
NotificationTypeKey  m_notificationTypeKey = new NotificationTypeKey.Default;
CreateMessage(notificationTypeKey , wCallUpdate ); 
```

我收到以下错误：

```
System.Runtime.Serialization.SerializationException: Type 'Xxx.DataContracts.WCall' in Assembly 'Xxx.DataContract, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.
   at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)
   at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)
   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()
   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)
   at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter)
   at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Write(WriteObjectInfo objectInfo, NameInfo memberNameInfo, NameInfo typeNameInfo)
   at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)
   at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph)
   at Xxx.Notification.NotificationMessageFactory.CreateMessage(NotificationTypeKey notificationTypeKey, NotificationData notificationData) in Xxx.Notification\NotificationCenter.cs:line 36 
```

如果我把 Serializable 标志放在前面`DataContract`并不能解决问题。

* * *

thank you for the fast answer. Sorry that i forgot to put the code of the NotificationData (edited in the main post)

I tried putting the Serializable attribute to both class without success :(

```
#region NotificationData
/// <summary>
/// Basic class used in the notification service
/// </summary>
[Serializable]
[DataContract]
public class NotificationData
{
}
#endregion 
```

and

```
[Serializable]
public class WCallUpdate : NotificationData
{
    private string m_from = "";
    [DataMember]
    public string From
    {
        get { return m_from; }
        set { m_from = value; }
    }
    private WCall m_wCall = new WCall();
    [DataMember]
    public WCall Call
    {
        get { return m_wCall; }
        set { m_wCall = value; }
    }
} 
```

**Edit: ** Mea culpa afterall :) You were both right. I forgot to spread the `[Serializable]` Attribute to all the child class. After updating and compiling, i got no longer the exception. thank you both for your correct answers :)

* * *

@Marc Gravel: Actually i thought about what you are suggesting, and created the following DataContractSerializer, but I'm not sure this will work? As my classes use other classes? the big problem with the DataContractSerializer is that you need to specify the type of the object you want to serialize, and as my class uses other class as private fields, that might cause a problem right?

```
#region DataContractSerializer
        /// <summary>
        /// Creates a Data Contract Serializer for the provided type. The type must be marked with
        /// the data contract attribute to be serialized successfully.
        /// </summary>
        /// <typeparam name="T">The type to be serialized</typeparam>
        /// <returns>A data contract serializer</returns>
        public static DataContractSerializer CreateDataContractSerializer<T>() where T : class
        {
            DataContractSerializer serializer = new DataContractSerializer(typeof(T));
            return serializer;
        }
        #endregion 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-16T05:53:40.137

put [Serializable] at the top of the class. Serializable isn't necessarily inherited either AFAIK. meaning even if the base class has [Serializable], you still need it on the descendent class.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-16T07:10:56.677

I'm very confused why you're using `BinaryFormatter` with a data-contract. It would be normal to use `DataContractSerializer` here... the logic is then similar to using `[Serializable]`, except you need `[DataContract`], and it serializes the nominated (`[DataMember]`) members, rather than the fields which `BinaryFormatter` works with.

Actually, for numerous reasons ([such as brittleness](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)) I would suggest switching to `DataContractSerializer`, especially as that seems to be your intention. Or if you want a more compact binary form, [protobuf-net](http://code.google.com/p/protobuf-net/) may be useful (plus is portable between platforms, too).

As an aside - you don't need the `[DataContract]` on `enum`s - it does no harm, but doesn't do a lot either.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T05:38:51.313

To get a class to be serializable mark it with the serializable attribute or derived it from MarshalByRefObject.

You derive from NotificationData, is it serializable then?

Also check this: when serializable data classes are put in an assembly check your project or file reference in Visual Studio to be sure you get the right one.

Also if you sign the assembly and put it in the GAC, be sure that the assembly in the GAC is the right one! I have encountered many time consuming debugsessions because I updated the assembly from version 1.0.0.0 to 1.0.0.1 and forgot to replace the old one in the GAC. Assemblies in the GAC are loaded prior the local assemblies, keep that in mind. And... binary formatting is very strict related to assembly versions.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-08T06:51:54.247

I have created a class XList to accomplish this:

```
AA D1=new AA(); //Derived type
BB D2=new BB(); //Derived type 
CC D3=new CC(); //Derived type 
X D4=new X(); //Base Class 

XList<X> AllData=new XList<X>(); 
AllData.Add(D1); 
AllData.Add(D2); 
AllData.Add(D3); 
AllData.Add(D4); 
// ----------------------------------- 
AllData.Save(@"C:\Temp\Demo.xml"); 
// ----------------------------------- 
// Retrieve data from XML file 
// ----------------------------------- 
XList<X> AllData=new XList<X>(); 
AllData.Open(@"C:\Temp\Demo.xml"); 
// ----------------------------------- 
```

More details can be found [here](http://xinyustudio.wordpress.com/2011/03/02/serialize-deserialize-derived-class-insances-in-generic-list-problems-solutions/).

# c# - 如何判断实例是否属于某个类型或任何派生类型

> ID：754858
> 
> 赞同：14
> 
> 时间：2009-04-16T05:34:38.233
> 
> 标签：c#, casting, types

我正在尝试编写验证来检查对象实例是否可以转换为变量类型。对于他们需要提供的对象类型，我有一个 Type 实例。但类型可能会有所不同。这基本上是我想做的。

```
 Object obj = new object();
        Type typ = typeof(string); //just a sample, really typ is a variable

        if(obj is typ) //this is wrong "is" does not work like this
        {
            //do something
        } 
```

类型对象本身具有 IsSubClassOf 和 IsInstanceOfType 方法。但我真正想检查的是**obj**是 typ 的实例**还是从****typ**派生的任何类。

似乎是一个简单的问题，但我似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-16T05:42:50.303

这个怎么样：

```
 MyObject myObject = new MyObject();
    Type type = myObject.GetType();

    if(typeof(YourBaseObject).IsAssignableFrom(type))
    {  
       //Do your casting.
       YourBaseObject baseobject = (YourBaseObject)myObject;
    } 

```

这告诉您该对象是否可以转换为该特定类型。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-16T05:47:41.227

我认为您需要重申您的条件，因为如果`obj`是 的实例`Derived`，它也将是 的实例`Base`。并将`typ.IsIstanceOfType(obj)`返回 true。

```
class Base { }
class Derived : Base { }

object obj = new Derived();
Type typ = typeof(Base);

type.IsInstanceOfType(obj); // = true
type.IsAssignableFrom(obj.GetType()); // = true 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-16T06:49:54.650

如果您正在使用实例，您应该选择[Type.IsInstanceOfType](http://msdn.microsoft.com/en-us/library/system.type.isinstanceoftype.aspx)

> （返回）如果当前 Type 在 o 表示的对象的继承层次结构中，或者当前 Type 是 o 支持的接口，则返回 true。如果这些条件都不属于这种情况，或者如果 o 是 nullNothingnullptra 空引用（Visual Basic 中的 Nothing），或者如果当前 Type 是开放的泛型类型（即 ContainsGenericParameters 返回 true），则返回 false。——MSDN

```
 Base b = new Base();
        Derived d = new Derived();
        if (typeof(Base).IsInstanceOfType(b)) 
            Console.WriteLine("b can come in.");    // will be printed
        if (typeof(Base).IsInstanceOfType(d)) 
            Console.WriteLine("d can come in.");    // will be printed 
```

如果您正在使用 Type 对象，那么您应该查看[Type.IsAssignableFrom](http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx)

> （返回）如果 c 和当前 Type 表示相同的类型，或者如果当前 Type 在 c 的继承层次结构中，或者如果当前 Type 是 c 实现的接口，或者如果 c 是泛型类型参数并且current Type 表示 c 的约束之一。如果这些条件都不为真，或者 c 为 nullNothingnullptra 空引用（在 Visual Basic 中为 Nothing），则为 false。——MSDN

# c++ - 在 C++ 中查看编译器错位名称

> ID：754865
> 
> 赞同：8
> 
> 时间：2009-04-16T05:38:51.373
> 
> 标签：c++, compiler-construction, name-mangling, visual-c++-2008

如何查看 C++ 中重载函数的编译器生成的重载名称？我正在使用 VC9，但也欢迎其他编译器的答案。

**编辑：**我在这里找到所有有用的答案。接受我最喜欢的那个。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-16T06:00:53.600

您可以使用[Dependency Walker](http://www.dependencywalker.com/)查看修饰的函数名称。

在依赖遍历器中打开任何 DLL\EXE，在右侧窗格中您可以看到修饰函数名称的列表。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-16T06:11:56.677

因为您还询问其他编译器。gnu 工具链上有一个叫 nm 的工具。你会在 linux 和 cygwin 上得到它，我相信它也可以在 mingw 中使用。不带参数调用它会在二进制文件中显示损坏的符号。用 --demangle 调用它会很明显。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-16T05:44:09.240

[您可以使用Dumpbin](http://msdn.microsoft.com/en-us/library/c1h23y6c(VS.71).aspx)查看修饰（损坏）的名称。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-16T05:55:40.413

您可以查看地图文件。假设您打开了地图文件生成。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-08T19:49:37.893

虽然上述所有方法都有效，但有一个很好的[记录方法可以通过使用](http://msdn.microsoft.com/en-us/library/bw3h504y(VS.80).aspx)[列表文件](http://msdn.microsoft.com/en-us/library/367y26c6(VS.80).aspx)来查看损坏的名称：项目属性页 -> C/C++ -> 输出文件 -> 汇编程序输出。

（编辑：）

只有列表文件和[DUMPBIN](http://msdn.microsoft.com/en-us/library/b06ww5dd(VS.80).aspx)被记录为查看修饰名称的方法是有原因的。建议作为解决方案的地图文件和依赖项walker*都只*显示修饰名称。如果您有多个函数名称重载，您将很难将它们与您看到的各种修饰名称相匹配。（这或多或少是在重构装饰方案。虽然[可能](https://stackoverflow.com/questions/491115/where-is-documentation-on-the-microsoft-visual-studio-c-name-mangling-scheme/841607#841607)，但它违背了整个最初的目的。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-11-03T10:11:05.367

linux gnu 工具链 nm 命令可用于查看损坏的名称。

```
#include<iostream> 
using namespace std;

int fun1(){}
int fun1(int){}
int main()
{
return 0;
} 
```

```
#g++ name_decoration_2.cpp
#nm a.out
...
...
000000000040064e T _Z4fun1i
0000000000400648 T _Z4fun1v
U _ZNSt8ios_base4InitC1Ev@@GLIBCXX_3.4
U _ZNSt8ios_base4InitD1Ev@@GLIBCXX_3.4 
```

# unit-testing - 传统非 MFC 应用程序的自动化 GUI 测试？

> ID：754879
> 
> 赞同：0
> 
> 时间：2009-04-16T05:47:00.090
> 
> 标签：unit-testing, testing, automation

我们有一个系统，该系统最初是几十年前开发的，多年来代码库不断增加。这是一个相当大的系统，具有我们部门维护的配置（供应商不允许我们访问源数据库或底层数据库）。客户端软件是一个专有开发的应用程序，基本上是一个连接到主数据库的精美终端应用程序。

我希望能够编写单元测试来自动测试系统的各种功能组件。我尝试使用 AutoIT 和 AutoHotkey 但没有成功，我的问题是我无法从窗口中读取数据，因为它是一个自定义类（窗口查找器显示为空白）。我什至尝试在 AutoIT 中使用 OCR API，但没有成功（它不可靠）。我还尝试使用像 CRT 和 putty 这样的终端仿真器，但成功有限，因为普通客户端软件在按键等时会发送特定的非终端标准数据。

似乎所有测试套件实际上只适用于基于 Web 的应用程序或更标准化的应用程序。

有没有其他人有类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T05:53:05.023

尝试“自动化 QA：测试完成”。我们已经将它用于主要应用程序有一段时间了，它是唯一可以几乎没有麻烦地测试 WPF、Win32、.NET、Java 等应用程序的产品。创建测试场景后，您可以稍后将其作为回归测试重新运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T15:59:52.970

对于 Windows 上的厚客户端和/或终端客户端的自动化 GUI 测试，您还可以考虑 IBM Rational Functional Tester、IBM Rational Robot、HP QTP、Compuware TestPartner、Borland SilkTest。

更具体地说，听起来您可能需要使用旧的复制粘贴解决方法。终端窗口是否具有等效的编辑->全选、编辑->复制菜单？如果是这样，您可以对其进行编码以单击 GUI 菜单以选择所有文本并复制到剪贴板。一旦文本出现在剪贴板上，您就可以使用剪贴板 API 来访问和解析文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T04:19:34.943

我最终使用了 AutoIT 和 TextCaptureX 的组合。上面建议的解决方案是很好的产品，但在这种情况下并不真正有效。TextCaptureX 实际上挂接到 Windows GDI 以获取文本。

从那以后，我开发了可以很好地对我们的应用程序执行 GUI 测试的测试脚本。

# .net - 如何在 C# 中引用 ADO RecordSet 对象？

> ID：754892
> 
> 赞同：1
> 
> 时间：2009-04-16T05:54:17.670
> 
> 标签：.net, com, interop, adodb

我正在使用 COM DLL，这是一个返回 ADO RecordSet 对象并希望在我的 C# 应用程序中引用它的函数调用。

已添加引用，将msado15,interop.adodb dll放在bin目录和debug目录下，添加了assembly key`web.config`但还是报如下错误：

> 'ADODB.Recordset' 类型是在未引用的程序集中定义的。您必须添加对程序集 'ADODB, Version=7.0.3300.0, Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a' 的引用。

关于什么是正确方法的任何想法？

编辑：我应该将哪个程序集添加到 GAC？我在哪里可以找到 ADODB.dll？

添加了对 c:\program files\microsoft.net\primary interop assemlies\adodb.dll 的引用并最终使其正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T06:29:22.283

尝试将项目中对 ADODB.dll 的引用更改为“复制本地”为真。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T06:16:03.827

顾名思义，程序集应该在 GAC 中（名称中包含 publickeytoken）。

编辑：引发错误的互操作程序集应该在 GAC 中。或者从您的项目中删除引用并从 bin 目录中添加对 dll 的引用。

# flash - 我可以销毁使用 SWFObject 创建的 Flash 对象吗？

> ID：754895
> 
> 赞同：3
> 
> 时间：2009-04-16T05:55:53.657
> 
> 标签：flash, swfobject

我正在使用 YUI 的 Dialog 控件在我的网站上以弹出窗口的形式显示 Flash 电影。

我正在使用[SWFObject](http://code.google.com/p/swfobject/)创建 Flash 控件。这将为我的视频创建一个[JW Player](http://www.longtailvideo.com/)实例。

[在SWF 对象常见问题解答](http://code.google.com/p/swfobject/wiki/faq)中看到没有简单的方法可以破坏影片，我感到非常惊讶。当 YUI 面板自行销毁时，它会留下一个孤立的视频播放。

销毁使用 SWFObject 创建的 SWF 控件的最佳方法是什么，或者没有好的方法，我应该隐藏它并调用 'stop()' ？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-16T05:59:26.753

swfobject.removeSWF("myVideoPlayer");

--

**编辑**：这会首先杀死`<DIV>`您用来创建 swfobject 的原始文件。

因此，如果您需要重新创建 Flash，您需要插入一个新的 placeholder `<DIV>`。

```
<!-- you'll need to wrap the 'myVideoPlayer' DIV in another DIV -->
<div id="videoPlayerWrapper">
   <div id="myVideoPlayer"/>
   <a href="#" class="close">Close Player</a>
</div>

swfobject.removeSWF("myVideoPlayer");
$('#videoPlayerWrapper').prepend("<div id='myVideoPlayer'></div>"); 
```

# javascript - jQuery 中是否仍然需要零长度计时器？

> ID：754898
> 
> 赞同：2
> 
> 时间：2009-04-16T05:57:37.727
> 
> 标签：javascript, jquery

我终于开始为我的应用程序真正实现一些 jQuery 解决方案（这似乎也涉及 javascript 速成课程）。

在研究插件示例时，我遇到了这段代码。我假设作者创建了零长度计时器来创建运行代码的一些分离，以便 init 函数可以快速完成。

```
function hovertipInit() {

  var hovertipConfig = {'attribute':'hovertip',
                        'showDelay': 300,
                        'hideDelay': 700};

  var hovertipSelect = 'div.hovertip';

  window.setTimeout(function() {
    $(hovertipSelect).hovertipActivate(hovertipConfig,
                                       targetSelectById,
                                       hovertipPrepare,
                                       hovertipTargetPrepare);
  }, 0);

} 
```

需要这种类型的分离很常见吗？
创建零长度计时器仍然是处理这种情况的最佳方法，还是在 jQuery 中处理这种情况更好？

谢谢，
吉姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T06:01:19.307

查看[这篇文章](http://blog.thinkature.com/index.php/2006/11/26/escaping-the-javascript-call-stack-with-settimeout/)，它解释了何时需要这样做。

另请查看[此相关问题](https://stackoverflow.com/questions/282499/what-is-settimeoutfunction-dostuff-0-actually-supposed-to-do)。

这不是很常见，但是当您需要转义事件的调用堆栈时是必要的。

# unix - XML 文件的长度

> ID：754899
> 
> 赞同：2
> 
> 时间：2009-04-16T05:57:45.963
> 
> 标签：unix, file, size

我有一个大小为 31 GB 的 XML 文件。我需要找到该文件中的总行数。我知道命令`wc -l`会给我同样的。但是，执行此操作需要很长时间。有没有更快的机制来查找大文件中的行数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T06:34:35.373

31 gigs 是一个非常大的文本文件。我敢打赌它会压缩到大约 1.5 gigs。我会以压缩格式创建这些文件，然后您可以通过 wc 流式传输文件的解压缩版本。这将大大减少用于处理此文件的 i/o 和内存量。gzip 可以读写压缩流。

但我也会发表以下评论：

*   由于元素之间的空格被忽略（混合内容除外），因此行号对于 XML 来说并不能提供真正的信息。关于数据集，您真正想知道什么？我敢打赌计算元素会更有用。
*   确保您的 xml 文件没有不必要的冗余，例如，您是否在整个文档中重复相同的命名空间声明？
*   也许 XML 不是表示此文档的最佳方式，如果它尝试查看类似[Fast Infoset的内容](http://en.wikipedia.org/wiki/Fast_Infoset "快速信息集")

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T06:01:01.790

如果您只需要行数，`wc -l`将与其他任何东西一样快。

问题是 31GB 的文本文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T06:05:06.163

如果准确性不是问题，请找到平均行长度并将文件大小除以该长度。这样你就可以得到一个非常快速的近似值。（确保考虑使用的字符编码）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T06:10:04.560

这超出了应该重构代码以完全避免您的问题的地步。一种方法是将文件中的所有数据放入元组存储数据库中。Apache couchDB 和 Intersystems Cache 是您可以为此使用的两个系统，并且将针对您正在处理的数据类型进行更好的优化。

如果你真的被 xml 文件卡住了，那么另一个选择是提前计算所有行并缓存这个值。每次从文件中添加或删除一行时，您都可以从文件中添加或减去一行。此外，请确保使用 64 位整数，因为可能有超过 2^32 行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T06:01:25.923

不，不是。`wc`将得到很好的优化。31GB 是很多数据，无论您使用什么程序，将其读入计算行数都需要一段时间。

此外，这个问题并不适合 Stack Overflow，因为它根本与编程无关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T06:27:20.260

由于在 XML 中换行基本上只是一种装饰性的东西，所以计数行不是很不确定吗？计算特定标签的出现次数可能会更好。

# jquery-ui - 使用 jQuery 为通过 AJAX 加载的文本添加动画效果

> ID：754900
> 
> 赞同：1
> 
> 时间：2009-04-16T05:57:56.850
> 
> 标签：jquery-ui, jquery

Prototype 的老手，jQuery 的新手，并编写了一个简单的应用程序来感受框架（并且因为我想使用它）。我有一个通过 AJAX 加载的 HTML 片段，我想将它粘贴在 a 的顶部`div`，并带有滑入式过渡动画。

此位有效，并执行前置位：

```
// Get the HTML fragment and stick it at the top of the containing div.
$.post("/create_new_thing", function(data) {
    $('#container_div').prepend(data);
}); 
```

我想做但不知道的是，用 show() 效果为新添加的 HTML 片段设置动画。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T06:12:54.523

尝试这样的事情......

```
$('#div').load('file.html').fadeIn("slow"); 
```

load 函数更适合您的需求，因为它的主要目的是从远程文件加载 HTML 并将其注入 DOM。

使用“发布”功能更适合使用 POST 请求加载远程页面（通过表单发布数据并根据您的发布请求返回动态数据）。

见下文...

```
$.post("file.php", { name: "superuntitled", time: "2am" },
function(data){
  $('#div').fadeIn("slow").append(data);
}); 
```

jQuery 尚不支持“PUT”请求。因此，如果您确实需要使用 put 请求，我可以建议使用添加对“PUT”的支持的自定义函数来扩展 jQuery 功能。也就是说，有一些解决方法！[请参阅此处了解更多详情！](http://homework.nwsnet.de/news/9132_put-and-delete-with-jquery%20)... [http://homework.nwsnet.de/news/9132_put-and-delete-with-jquery](http://homework.nwsnet.de/news/9132_put-and-delete-with-jquery)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-13T14:30:52.967

这是我用来向列表中添加新帖子的方法：

```
success: function(data){
  $("#posts-container").prepend(data).children().first().hide().show('slow');
} 
```

这假设添加的元素被包装在一个 div 中，并且首先在 #posts-container 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-07T09:54:32.683

我正在使用这个

```
 $.post("yourdocument.php", {parameter:"caucana.com"}, function(data) {
        $('#contiene_resultados').prepend(data);
  }); 
```

# iphone - 选择UITableView的行时如何更改默认的蓝色

> ID：754903
> 
> 赞同：0
> 
> 时间：2009-04-16T05:59:15.927
> 
> 标签：iphone, objective-c

### 复制：

> [我可以在目标 c 中使用没有默认蓝色的突出显示的表格视图单元格吗？](https://stackoverflow.com/questions/733095/can-i-use-highlighted-the-table-view-cell-without-default-blue-color-in-objective)

选择 UITable 的行时如何更改默认的蓝色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T06:03:18.913

UITableViewCellSelectionStyle 内置在 Cocoa Touch 中，会给你一些选择。要进行更多自定义，您需要手动更改单元格：

[如何将 UITableViewCellSelectionStyle 属性设置为一些自定义颜色？](https://stackoverflow.com/questions/260523/how-do-i-set-uitableviewcellselectionstyle-property-to-some-custom-color)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-31T03:54:27.550

在创建单元格的 tableview 的委托中，您可以自定义它。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *customCellIdentifier = @"customCellIdentifier ";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:CellIdentifier] autorelease];
        cell.selectedBackgroundView = [[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"YourBackground.png"]] autorelease];
    }

    // configure the cell
} 
```

# version-control - 代码提交评论的最佳实践

> ID：754905
> 
> 赞同：17
> 
> 时间：2009-04-16T06:00:30.450
> 
> 标签：version-control

你用什么模板来评论代码提交？

模板的一个示例是：

1.  （更改 1）：（源文件 1.1、1.2）：（所做更改的详细信息），（为什么）
2.  （更改 2）：（源文件 2.1）：（所做更改的详细信息），（为什么）

理想情况下，每个更改都应映射到问题跟踪器中的问题。这个模板好吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-16T06:12:52.383

这是我的想法……所有这些都可以根据您的特定开发方法进行解释。

*   你应该经常提交，每次提交都有一个焦点，因此基于此，注释应该简短并详细说明提交的焦点是什么。
*   我喜欢在您的评论中发布*内容*，以及在其他地方详细说明*原因*和*方式（最好是在您的错误跟踪中）。*为什么应该是票，并且在关闭票后，您应该有一些关于如何解决该特定问题的注释。
*   如果不以其他方式处理（例如，TRAC/SVN 交互），则可以参考您的错误跟踪系统。这样做的原因是，如果其他开发人员正在寻找有关提交的更多信息，则可以为他们指明正确的方向。
*   不要包含特定的文件名，除非修复非常复杂且需要详细信息。即使如此，复杂的细节也可能属于您的实施说明中的错误跟踪，而不是版本控制。编辑过的文件，差异细节等，应该希望包含在版本控制中，我们不想花时间复制这些。

鉴于这些想法，对我来说一个示例提交评论将类似于

> Req3845：更新了验证以使用在 Req3831 中开发的新 RegEx 验证。

简而言之，传达更改的内容，并为其他人提供某种参考以获取更多信息，而无需追捕您。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-16T17:58:37.990

我在每个段落前加上 + - * 或 !

```
+ means its a new feature
- means feature is removed
* means feature is changed
! means bugfix 
```

我认为您不应该详细描述代码的哪些部分已更改，因为这就是每个 VC 都有差异的原因 :)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-16T06:12:05.913

如果您使用错误跟踪系统，请包括相关的票号。

您无需提及更改的文件或您的姓名。源存储库可以自己解决这个问题。描述变化也只有在差异不是很明显的情况下才有意义。

确保你有一个好的第一行，因为这经常出现在更改历史视图中，人们需要通过它来查找东西（例如，错误跟踪票号应该在那里）。

尝试在单个变更集中提交相关更改（并将不相关的更改拆分为两个提交，即使是同一个文件）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-16T06:10:27.943

我尝试遵循与代码注释相同的规则：

解释*为什么*，而不是*如何*。

IMO 评论应包含对问题的引用（任务跟踪器或要求）。哪些文件受到影响已经可以从版本控制系统中获得。除此之外，它应该尽可能短，但仍然可读。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-16T06:09:54.827

我尝试将我的修复程序保存在单独的签到中。

我不使用实际模板，而是使用心理模板，就是这样。

> 问题 - 问题的开发级摘要。

问题跟踪器具有所有管理细节，并且可以查看更改/差异以进行代码更改，因此注释是为了让开发人员了解问题的原因/内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T07:41:15.247

这是我看到成功使用的内容：

*   参考错误编号或功能 ID
*   更改的简要说明。改变了什么。
*   除非由签入系统处理，否则代码审查员（以确保您有一个）。
*   测试人员的姓名或运行测试的描述（如果在过程后期并且您要格外小心）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-16T17:51:41.143

我使用了[Chaosben](http://blog.delphi-jedi.net/2008/05/13/did-you-know-4/)在[JEDI Windows API 博客](http://blog.delphi-jedi.net/)上描述的简单技术。

> 为了快速了解对存储库所做的更改，我们建议在每一行以下列字符之一开始编写简短的简明注释：
> 
> *   **+**如果您添加了特性/功能/...</li>
> *   **-**如果你删除了一个特性/功能/错误/...</li>
> *   **#**如果你改变了什么
> 
> 这样做，其他开发人员可能会发现所需的修订版更好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-17T14:31:16.827

首先，提交应该解决一个问题（为逻辑上独立的更改单独提交）。如果您不知道在提交消息中要写什么，或者提交消息太长，则可能意味着您的提交中有多个独立的更改，您应该将其拆分为更小的项目。

我认为**git**预期和使用的提交消息约定很有意义：

*   提交信息的第一行应该是一个简短的描述
*   如果合适，为上述摘要行添加子系统前缀，例如“docs:”或“contrib:”
*   在下一段或多段描述更改，解释原因和方式

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-16T06:03:42.110

请记住，如果有人需要更改内容的详细信息，他们可以获得差异。也就是说，我通常只为每个重大更改写一两句话，然后在最后汇总任何小的修复。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-16T06:22:19.820

没有硬性规定，因为它的简单英语。我尽量用最少的语言来解释所做的工作。任何寻找变更历史的人都只想知道特定变更中发生了什么。如果有人在寻找更多细节，那么它就在代码中。

我要遵循的第二件事是，如果有任何相关的错误，则将其粘贴，或者如果它与任何开发任务相关，则将其与更改相关联。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-16T18:26:31.650

如果两个文件由于不同的原因被更改，它们应该在不同的提交中你应该一次提交多个代码文件的唯一一次是因为它们都属于同一个修复/更改

# javascript - Javascript 在 IE8 中不起作用

> ID：754907
> 
> 赞同：3
> 
> 时间：2009-04-16T06:00:35.957
> 
> 标签：javascript, internet-explorer-8

以下 JavaScript 适用于 IE7，但不适用于 IE8：

```
onclick=history.back(1) or history.go(-1) 
```

关于为什么会这样以及如何克服它的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T06:24:58.097

你有没有尝试过：

```
onclick="history.back()" 
```

用引号？

* * *

而且，回应你说它不起作用的说法：*au contraire，mon ami。*

以下两个文件在我的 IE8 安装上运行良好，使用文件`x1.html`：

```
 <html><head></head><body>
        X1
        <hr>
        <a href="x2.html">x2</a>
    </body></html> 
```

和`x2.html`：

```
 <html><head></head><body>
        X2
        <hr>
        <button onclick="history.back()">Back!</button>
    </body></html> 
```

当我加载时`x1`，我可以`x2`通过链接移至，然后按钮移回`x1`。

这适用于所有三种兼容模式，因此它必须是您的浏览器上的一个设置会影响这一点。

为了让它工作，我必须做的一件事是去`Tools -> Internet Options -> Advanced -> Security`并选择`Allow active content to run in files on My Computer`，所以它几乎可以肯定是你浏览器中的一个安全设置，它让你很伤心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-30T11:04:26.143

我使用了这个并且效果很好：

```
<asp:Button ID="Back_BTN" runat="server" Text="بازگشت" 
onclientclick="javascript:history.back(1);return false;" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-17T10:58:55.663

我也有这个问题。永远不要在ie7上检查它是否也一样

像下面这样的代码不能在 IE8 上运行。可以上FF3.5

```
<select size="2">
<option onclick="alert('hey hey')">Hey hey</option>
<option onclick="alert('a ha')">A Ha</option>
</select> 
```

然而，这在工作

```
<select onclick="alert('uh oh')" size="2">
<option>Hey hey</option>
<option>A Ha</option>
</select> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T07:31:44.013

我有同样的问题并像这样解决了它......

```
 <a href='javascript:history.back(); ' onclick="history.back(); "><input type="button" value="Back" /></a> 
```

您需要将 history.back() 放入您的 href 标记以及 onclick 事件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T06:26:27.377

试试history.back()，如果这不起作用，那么试试这个history.back();return false;

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-27T07:04:46.667

这不是答案，但也许它会帮助其他人挖掘真正的答案......这个问题可能与 IE8 的兼容模式有关。基于网页的 DOCTYPE 在 IE8 中发生了奇怪的事情。如果您的 DOCTYPE 是 Transitional，IE8 可能无法正确处理 onclick 事件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T09:32:27.210

这可能是一个简单的报价反转。尝试这个

```
lblmessage.Text += '<br><a href="#" onclick="history.back(1);"> <u>Back</u></a>' 
```

而不是这个

```
lblmessage.Text += "<br><a href='#' onclick='history.back(1);'> <u>Back</u></a>" 
```

# php - PHP：$_SESSION['var'] 在 Flash 上传中神秘地未定义的可能原因

> ID：754916
> 
> 赞同：1
> 
> 时间：2009-04-16T06:03:40.270
> 
> 标签：php, ajax, session

我在未定义会话 ID 时遇到问题。

session 变量在表单通过 ajax/jquery 查询发布到的页面上被调用。

会话变量在每隔一个页面上调用一次，没有问题。该变量在用户登录时设置，并由 auth.php 文件检查。auth.php 文件发现 session 变量很好，但是 insert.php 文件吐出错误：“未定义索引：var ....”。

会话变量是否有原因丢失？

**编辑：** 我在我的 auth.php 文件中调用 session_start 。如果我尝试开始另一个会话，我会收到一条错误消息。

是否有可能找不到会话变量，因为文件是通过 ajax 请求发布的？

**编辑/回答：** 我发现出了什么问题。我使用的是 Flash 上传器，使用 Flash 上传时会话丢失。哦，多么美好的夜晚。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T06:06:15.943

页面“insert.php”是否已开始会话？这可能是原因。

如果 PHP 设置未设置为自动启动，请尝试启动它。

```
session_start(); 
```

我还发现打印出 $_SESSION 有时很方便。

```
print_r($_SESSION); 
```

根据我的经验，还有另一种可能性，即从不同的主机/服务器名/IP 号调用另一个文件，这导致找不到会话变量。虽然这是相当遥远的可能性。

在您的情况下，请尝试检查以防万一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T07:32:37.530

我发现出了什么问题。我使用的是 Flash 上传器，使用 Flash 上传时会话丢失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T06:10:28.943

如果你重定向不包括 insert.php 你有使用`session_start();`，因为该页面中不存在会话，据我所知 php 会话仅在一个页面中工作而无需额外配置。

# c - 严格混叠的性能优势

> ID：754929
> 
> 赞同：19
> 
> 时间：2009-04-16T06:11:04.260
> 
> 标签：c, performance

在 C 语言中，观察严格别名带来的性能优势究竟是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-16T06:32:08.827

[这里](http://cellperformance.beyond3d.com/articles/2006/06/understanding-strict-aliasing.html)有一个页面非常彻底地描述了别名。

[这里](https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule)和[这里](https://stackoverflow.com/questions/262379/when-is-char-safe-for-strict-pointer-aliasing)也有一些 SO 主题。

总而言之，当两个不同类型的指针访问同一个位置时，编译器无法假定数据的值（即它必须每次都读取该值，因此无法进行优化）。

这仅在未强制执行严格别名时发生。严格的别名选项：

*   gcc：**-fstrict-aliasing [默认]**和**-fno-strict-aliasing**
*   msvc： **默认情况下，严格别名是关闭的。** （如果有人知道如何打开它，请说出来。）

* * *

# 例子

将此代码复制粘贴到 main.c 中：

```
void f(unsigned u)
{
    unsigned short* const bad = (unsigned short*)&u;
} 

int main(void)
{
    f(5);

    return 0;
} 
```

然后使用以下选项编译代码：

> gcc main.c -Wall -O2

你会得到：

> main.c:3：警告：取消引用类型双关指针将破坏严格别名规则

禁用别名：

> gcc main.c -fno-strict-aliasing -Wall -O2

警告消失了。（或者只是取出 -Wall 但是......没有它就不要编译）

尽我所能，我无法让 MSVC 给我一个警告。

# c# - 将 Mac OS X 二进制格式的 plist 转换为 C# 中的可读格式

> ID：754935
> 
> 赞同：2
> 
> 时间：2009-04-16T06:13:18.123
> 
> 标签：c#, .net, macos, binary, plist

有谁知道我是否/如何将二进制格式的 Mac OS X plist 文件转换为 C# 中的纯 XML 字符串？

我知道有一些适用于 Windows 的 plist 编辑器说它们支持二进制格式的 plist 文件，但我需要在我自己的应用程序中内联执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-04-01T18:48:43.167

我意识到这已经很老了，但我正在为后代发布我的解决方案。

几周前我开始二进制 plist 序列化时，我找不到任何可用的启动外部进程的方法，所以我不得不自己动手。

对于其他寻找 C#/.NET 二进制 plist 序列化的人，您可以在[https://github.com/ChadBurggraf/plists-cs](https://github.com/ChadBurggraf/plists-cs)找到我的实现。

希望这可以帮助一些人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T06:24:09.970

一个快速的谷歌显示[plutil.pl](http://scw.us/iPhone/plutil/)，但这只有在安装 perl 时才有效（我相当肯定这不是 Windows 中的默认设置）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-15T00:20:33.823

我没有尝试过以下任何解决方案，我知道您正在寻找 C#，但是......

这个页面有一个用java实现的二进制plist解析器：
[http ://www.java2s.com/Open-Source/Java/Swing/JIDE-Common/com/jidesoft/plaf/aqua/BinaryPListParser.java.htm](http://www.java2s.com/Open-Source/Java/Swing/JIDE-Common/com/jidesoft/plaf/aqua/BinaryPListParser.java.htm)

Java Quaqua 项目 ( [https://quaqua.dev.java.net/](https://quaqua.dev.java.net/) ) 使用二进制 plist java 解析器。您可以在此处查看 Java 文档[http://www.randelshofer.ch/quaqua/javadoc/ch/randelshofer/quaqua/util/BinaryPListParser.html](http://www.randelshofer.ch/quaqua/javadoc/ch/randelshofer/quaqua/util/BinaryPListParser.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T17:00:36.710

如果你想在 OS X 端进行代码转换，[这个](https://stackoverflow.com/questions/264440/converting-plist-to-binary-plist)之前的 SO question 有你的答案。或者，您可以使用 OS X 上的[plutil](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man1/plutil.1.html)命令行实用程序在二进制和 XML 属性列表之间进行转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-16T17:22:43.587

Project Wonder 拥有来自 WebObjects 的支持二进制 plist 的 Apple plist 解析器的开源版本：[http ://wonder.svn.sourceforge.net/viewvc/wonder/branches/Wonder_5_0_0_WebObjects_5_4_Branch/Wonder/Frameworks/Core/ERExtensions/Sources/er/扩展/基础/ERXPropertyListSerialization.java?revision=11806&content-type=text%2Fplain](http://wonder.svn.sourceforge.net/viewvc/wonder/branches/Wonder_5_0_0_WebObjects_5_4_Branch/Wonder/Frameworks/Core/ERExtensions/Sources/er/extensions/foundation/ERXPropertyListSerialization.java?revision=11806&content-type=text%2Fplain)

# oledb - DBF 大字符字段

> ID：754948
> 
> 赞同：1
> 
> 时间：2009-04-16T06:23:06.433
> 
> 标签：oledb, dbf, clipper

我有一个我相信是用 Clipper 创建的数据库文件，但不能肯定地说（我有 .ntx 文件用于索引，我知道这是 Clipper 使用的）。我正在尝试创建一个 C# 应用程序，它将使用 System.Data.OleDB 命名空间读取此数据库。

在大多数情况下，我可以成功阅读表格的内容，但有一个字段我不能。此字段称为 CTRLNUMS，定义为 CHAR(750)。我已经阅读了通过 Google 搜索找到的各种文章，这些文章建议必须通过与正常分配给字符串变量不同的过程来读取大于 255 个字符的字段。到目前为止，我还没有在我找到的方法上取得成功。

以下是我用来读取表格的示例代码片段，其中包括我用来读取 CTRLNUMS 字段的两个选项。即使字段中存储了 750 个字符，这两个选项都导致返回 238 个字符。

这是我的连接字符串：

提供者=Microsoft.Jet.OLEDB.4.0；数据源=c:\datadir；扩展属性=DBASE IV；

谁能告诉我从 DBF 文件中读取更大字段的秘密？

```
using (OleDbConnection conn = new OleDbConnection(connectionString))
{
    conn.Open();

    using (OleDbCommand cmd = new OleDbCommand())
    {
        cmd.Connection = conn;
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = string.Format("SELECT ITEM,CTRLNUMS FROM STUFF WHERE ITEM = '{0}'", stuffId);

        using (OleDbDataReader dr = cmd.ExecuteReader())
        {
            if (dr.Read())
            {
                stuff.StuffId = dr["ITEM"].ToString();

                // OPTION 1
                string ctrlNums = dr["CTRLNUMS"].ToString();

                // OPTION 2
                char[] buffer = new char[750];
                int index = 0;
                int readSize = 5;
                while (index < 750)
                {
                    long charsRead = dr.GetChars(dr.GetOrdinal("CTRLNUMS"), index, buffer, index, readSize);

                    index += (int)charsRead;

                    if (charsRead < readSize)
                    {
                        break;
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T15:53:36.807

您可以在此处找到 DBF 结构的描述：[http ://www.dbf2002.com/dbf-file-format.html](http://www.dbf2002.com/dbf-file-format.html)

我认为 Clipper 过去所做的是修改字段结构，以便在字符字段中，小数位保存大小的高位字节，因此字符字段大小实际上是 256*Decimals+Size。

我可能有一个读取 dbfs（本机不是 ADO/DAO）的 C# 类，可以对其进行修改以处理这种情况。如果您有兴趣，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T22:41:16.220

你还在寻找答案吗？这是一次性工作还是需要定期做的事情？

我有一个 Python 模块，主要用于从各种 DBF 文件中提取数据……它还没有处理`length_high_byte`= `decimal_places`hack，但这是一个微不足道的变化。我很乐意 (a) 与您分享此内容和/或 (b) 获取此类 DBF 文件的副本以进行测试。

稍后添加：添加了扩展长度功能，并针对我自己创建的文件进行了测试。提供与任何想测试它的人共享代码仍然有效。仍然有兴趣自己获取一些“真实”文件进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T14:24:34.443

3 条建议可能值得一试...

1 - 使用 Access 创建到 DBF 文件的链接表，然后使用 .Net 访问 access 数据库中的表，而不是直接访问 DBF。

2 - 尝试[FoxPro OLEDB 提供程序](http://www.microsoft.com/downloads/details.aspx?FamilyId=E1A87D8F-2D58-491F-A0FA-95A3289C5FD4&displaylang=en)

3 - 手动解析 DBF 文件。例子在[这里](https://stackoverflow.com/questions/428237/how-do-i-extract-the-data-in-a-foxpro-memo-field-using-net)。

我的猜测是#1 应该是最简单的，#3 会让你有机会微调你的咒骂技巧。:)

# c - C malloc 通过函数调用指向指针导致总线错误

> ID：754956
> 
> 赞同：0
> 
> 时间：2009-04-16T06:27:05.627
> 
> 标签：c, pointers, struct, malloc, bus-error

由于我对将类型内存分配给指针的理解薄弱，以下导致调用 barrier_create 时出现总线错误（从未打印过“hi”）。

```
typedef struct barrier barrier_t;
typedef struct barrier *barrier_p;

barrier_p test_barrier_p;

int main(int argc, char *argv[]) {
    barrier_create(*test_barrier_p);
}

int barrier_create(barrier_p *barrier_pointer) {
printf("hi\n");
    barrier_p old_barrier, new_barrier;
    int count;
    old_barrier = (barrier_p) *barrier_pointer;
    new_barrier = (barrier_p) malloc(sizeof(*new_barrier));
    count = pthread_mutex_init(&new_barrier->lock, NULL);
    new_barrier->is_valid = VALID_BARRIER;
    new_barrier->counter = 0;
    new_barrier->release_flag = 0;
    *barrier_pointer = new_barrier;
    return HAPPY_HAPPY_JOY_JOY;
} 
```

我错过了什么或输入错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-16T06:32:30.043

您正在取消引用 main 函数中的错误指针。要获取变量的地址，请使用地址`&`运算符，而不是取消引用`*`运算符。将 main 重写为：

```
barrier_create(&test_barrier_p); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-16T06:36:50.690

```
barrier_create(*test_barrier_p); 
```

由于`barrier_create`需要 a 的地址`barrier_p`，这应该是`&test_barrier_p`，而不是`*test_barrier_p`。

```
printf("hi\n"); 
```

代码可达性测试不准确，因为标准输出可能被缓冲；我建议`fprintf(stderr, "hi\n");`改为。

```
new_barrier = (barrier_p) malloc(sizeof(*new_barrier)); 
```

我会说`sizeof(barrier_t)`。同样`*`在一个奇怪的地方，该`_p`符号可能无法帮助您的类型操作清晰。

对于迂腐，我会检查 malloc 的返回值。我认为保留旧值没有什么意义，除非以某种方式从 malloc 错误中恢复。

计数的目的是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T06:30:25.790

该`test_barrier_p`变量是一个指向`barrier`从未被初始化的结构的指针，因此它被设置为 NULL（因为它在文件范围内）。

您在调用 from `main()`to时取消引用它`barrier_create()`。

如需其他帮助，您需要用英语告诉我们您想要实现的目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T08:44:14.470

该函数`int barrier_create(barrier_p *barrier_pointer)`将指针作为参数。`actual barrier_p`但是，由于您取消引用它，因此您在 main 中传递了- `barrier_create(*test_barrier_p)`。我认为你应该像这样传递地址`barrier_create(&test_barrier_p)`

# sql - SQL Server 中对大型数据集的慢速不同查询

> ID：754957
> 
> 赞同：12
> 
> 时间：2009-04-16T06:27:13.753
> 
> 标签：sql, sql-server, sql-server-2005

我们使用 SQL Server 2005 来跟踪大量不断传入的数据（每秒 5-15 次更新）。在它投入生产几个月后，我们注意到其中一个表已经开始花费大量时间来查询。

该表有 3 列：

*   `id`-- 自动编号（集群）
*   `typeUUID`-- 在插入发生之前生成的 GUID；用于将类型分组在一起
*   `typeName`-- 类型名称 (duh...)

我们运行的查询之一是`typeName`字段上的不同：

```
SELECT DISTINCT [typeName] FROM [types] WITH (nolock); 
```

该`typeName`字段上有一个非聚集的、非唯一的升序索引。该表目前包含大约 2 亿条记录。当我们运行这个查询时，查询用了 5m 58s 才返回！也许我们不了解索引是如何工作的……但我认为我们并没有对它们*有*太多误解。

为了进一步测试这一点，我们运行了以下查询：

```
SELECT DISTINCT [typeName] FROM (SELECT TOP 1000000 [typeName] FROM [types] WITH (nolock)) AS [subtbl] 
```

如我所料，此查询在大约 10 秒内返回，它正在扫描表。

我们在这里缺少什么吗？为什么第一个查询需要这么长时间？

**编辑：**啊，很抱歉，第一个查询返回 76 条记录，谢谢九边。

**跟进：**谢谢大家的回答，现在对我来说更有意义（我不知道为什么以前没有……）。没有索引，它对 200M 行进行表扫描，有索引，它对 200M 行进行索引扫描......

SQL Server 确实更喜欢索引，它确实提供了一点性能提升，但没有什么值得兴奋的。重建索引确实将查询时间从 6m 缩短到 3m 多一点，这是一个改进，但还不够。我只是要向我的老板推荐我们规范化表结构。

再次感谢大家的帮助！！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-16T06:40:52.350

您确实误解了索引。即使它确实使用了索引，它仍然会对 200M 条目进行索引扫描。这将需要很长时间，加上执行 DISTINCT （导致排序）所需的时间，而且运行起来是一件坏事。在查询中看到 DISTINCT 总是会引发危险信号，并让我仔细检查查询。在这种情况下，也许您有标准化问题？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-16T06:45:31.790

我怀疑 SQL Server 甚至会尝试使用索引，它必须做几乎相同数量的工作（给定窄表），读取所有 200M 行，无论它是查看表还是索引。如果上的索引`typeName`被聚集，它可能会减少所花费的时间，因为它不需要在分组之前进行排序。

如果您的类型的基数很低，那么维护一个包含不同`type`值列表的汇总表怎么样？插入/更新主表的触发器将对汇总表进行检查，并在找到新类型时插入新记录。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T16:27:54.327

使用`DISTINCT`关键字时，SQL Server 优化器存在问题。解决方案是通过单独分解不同的查询来强制它保持相同的查询计划。

因此，我们进行了以下查询：

```
SELECT DISTINCT [typeName] FROM [types] WITH (nolock); 
```

并将其分解为以下内容：

```
SELECT typeName INTO #tempTable1 FROM types WITH (NOLOCK)
SELECT DISTINCT typeName FROM #tempTable1 
```

绕过它的另一种方法是使用 a `GROUP BY`，它会获得不同的优化计划。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-16T07:05:35.597

正如其他人已经指出的那样 - 当您对表执行 SELECT DISTINCT (typename) 时，无论如何您最终都会进行全表扫描。

所以这实际上是限制需要扫描的行数的问题。

问题是：你需要 DISTINCT 类型名做什么？你的 200M 行中有多少是不同的？你只有少数（最多几百个）不同的类型名吗？

如果是这样 - 你可以有一个单独的表 DISTINCT_TYPENAMES 或其他东西，并最初通过执行全表扫描来填充它们，然后在将新行插入主表时，始终检查它们的类型名是否已经在 DISTINCT_TYPENAMES 中，如果没有，添加它。

这样，您将拥有一个单独的小表，其中仅包含不同的 TypeName 条目，查询和/或显示速度将非常快。

马克

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-26T19:00:26.500

循环方法应该使用多次搜索（但会失去一些并行性）。对于与总行数（低基数）相比具有相对较少不同值的情况，可能值得一试。

想法来自这个[问题](https://dba.stackexchange.com/questions/96364)：

```
select typeName into #Result from Types where 1=0;

declare @t varchar(100) = (select min(typeName) from Types);
while @t is not null
begin
    set @t = (select top 1 typeName from Types where typeName > @t order by typeName);    
    if (@t is not null)
        insert into #Result values (@t);
end

select * from #Result; 
```

看起来还有其他一些方法（特别是递归 CTE @Paul White）：

[不同的方法来找到不同的值 - 更快的方法](http://beyondrelational.com/modules/2/blogs/70/posts/18252/different-ways-to-find-distinct-values-faster-methods.aspx)

[sqlservercentral 主题873124-338-5](http://www.sqlservercentral.com/Forums/Topic873124-338-5.aspx#bm1013407)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-16T06:37:48.907

我的第一个想法是统计。要查找最后更新：

```
SELECT
    name AS index_name, 
    STATS_DATE(object_id, index_id) AS statistics_update_date
FROM
    sys.indexes 
WHERE
    object_id = OBJECT_ID('MyTable'); 
```

编辑：重建索引时更新统计信息，我看到没有维护

我的第二个想法是索引还在吗？TOP 查询仍应使用索引。我刚刚在一张有 5700 万行的表上进行了测试，并且都使用了索引。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-11-03T14:06:53.990

索引视图可以使这更快。

```
create view alltypes
with schemabinding as
select typename, count_big(*) as kount
from dbo.types
group by typename

create unique clustered index idx
on alltypes (typename) 
```

对基表的每次更改保持最新视图的工作应该是适度的（当然，取决于您的应用程序 - 我的观点是它不必每次都扫描整个表或做任何非常昂贵的事情像那样。）

或者，您可以制作一个包含所有值的小表：

```
select distinct typename
into alltypes
from types

alter table alltypes
add primary key (typename)

alter table types add foreign key (typename) references alltypes 
```

外键将确保使用的所有值都出现在父`alltypes`表中。问题在于确保`alltypes`不包含子表中*未使用的值。*`types`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T07:26:51.163

我应该尝试这样的事情：

```
SELECT typeName FROM [types] WITH (nolock)
group by typeName; 
```

和其他人一样，我会说您需要规范化该列。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-16T07:48:50.627

索引可帮助您快速找到一行。但是您要求数据库列出整个表的所有唯一类型。索引对此无能为力。

您可以运行一个夜间作业，该作业运行查询并将其存储在不同的表中。如果您需要最新数据，您可以存储夜间扫描中包含的最后一个 ID，并组合结果：

```
select type
from nightlyscan
union
select distinct type
from verybigtable
where rowid > lastscannedid 
```

另一种选择是将大表规范化为两个表：

```
talbe1: id, guid, typeid
type table: typeid, typename 
```

如果类型的数量相对较少，这将非常有益。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-09-25T09:39:34.000

我可能会遗漏一些东西，但是如果负载开销来创建具有不同值的视图并查询它会更有效吗？

如果结果集明显更小并且每次写入时填充它的开销要小得多，尽管考虑到视图的性质本身可能是微不足道的，这将几乎立即对选择做出响应。

它确实提出了一个问题，与您想要不同的频率相比，有多少写入以及您执行时速度的重要性。

# vb.net - 没有从 UniversalDateTime 获得正确的时间

> ID：754975
> 
> 赞同：0
> 
> 时间：2009-04-16T06:33:14.177
> 
> 标签：vb.net, datetime, vcalendar, vcal

我通过 web 应用程序中的邮件发送一个 vcal，并将日期时间转换为通用日期时间。如果我在本地运行 Web 应用程序（印度的本地服务器），我会在我的 vcal 中获得正确的时间。但是实时运行应用程序（美国的服务器）然后没有得到正确的时间，相差 1 个半小时。请建议我。

代码 ：

```
Dim result As StringBuilder = New StringBuilder()
        result.AppendFormat("BEGIN:VCALENDAR{0}", System.Environment.NewLine)
        result.AppendFormat("BEGIN:VEVENT{0}", System.Environment.NewLine)
        result.AppendFormat("SUMMARY:{0}{1}", subject, System.Environment.NewLine)
        result.AppendFormat("LOCATION:{0}{1}", location, System.Environment.NewLine)
        result.AppendFormat("DTSTART:{0}{1}", startDate.ToUniversalTime().ToString("yyyyMMdd\THHmmss\Z"), System.Environment.NewLine)
        result.AppendFormat("DTEND:{0}{1}", endDate.ToUniversalTime().ToString("yyyyMMdd\THHmmss\Z"), System.Environment.NewLine)
        result.AppendFormat("DTSTAMP:{0}{1}", DateTime.Now.ToUniversalTime().ToString("yyyyMMdd\THHmmss\Z"), System.Environment.NewLine)
        result.AppendFormat("DESCRIPTION:{0}{1}", description, System.Environment.NewLine)
        result.AppendFormat("END:VEVENT{0}", System.Environment.NewLine)
        result.AppendFormat("END:VCALENDAR{0}", System.Environment.NewLine)
        Return result.ToString() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T05:38:23.850

由于 IST（印度标准时间）位于 UTC+5:30，而美国时区位于 UTC-4（东部）到 UTC-7（太平洋），您可能会休息一个半小时（实际上是十如果服务器在中央夏令时 (CDT) 时间运行，则休息半小时但忽略上午/下午）。

我在 www.vcalendar.org 找到了 vcalendar，[它](http://www.vcalendar.org/)会迅速重定向您。它似乎是一个 PHP 应用程序。并且查看PHP手册，似乎H格式是24小时制；但它需要一个 H，而不是双 H。 vcalendar.org 上的文档 PDF 是 AWOL（404 - 除了它会将您重定向到比简单的 404 更有用的页面，但它仍然不存在！）。

建议：确定您的服务器在美国运行的时区（有 4 个主要时区，以及各种辅助时区）。检查“1.5 小时 = 10.5 小时模 12”假设是否合理。并仔细研究日期/时间格式和“HH”的含义。

# javascript - 如何使用 Ajax 在 php 服务器端设置 cookie 并使用 Ajax 或 JavaScript 实时读取 cookie？

> ID：754977
> 
> 赞同：0
> 
> 时间：2009-04-16T06:33:20.463
> 
> 标签：javascript, ajax

如何使用 Ajax 在 PHP 服务器端设置 cookie 并使用 JavaScript 实时读取 cookie？

**示例：** 按下`ok`按钮后，客户端将调用 Ajax，Ajax 将调用 PHP 服务器端收集数据。它还会在获取数据时为 PHP 服务器端的 cookie 分配一个值。同时，我想用另一个函数实时读取分配的值cookie（该函数将在开始调用PHP服务器时从Ajax调用）并在客户端显示cookie的值。

我尝试了很多次，但似乎该功能只能在 Ajax 进程完成后才能获取更新的 cookie 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T06:38:51.900

在客户端到达那里之前，您如何能够读取客户端上的 cookie？

1.  您向服务器发出（ajax 或其他）请求
2.  服务器组装一个响应，向它添加一个cookie
3.  客户端收到响应
4.  响应出现后，它可以检查 cookie 值

对我来说，您的问题听起来像是您尝试在第 1 步中读取 cookie。这是不可能的。

如果这不是您想要做的，那么您的问题需要重新措辞。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T06:39:31.290

Cookie 仅存在于客户端。它们包含在每个 HTTP 请求中，允许服务器对它们执行操作。如果您需要，Javascript 可以为您设置这些 cookie：

```
// http://www.quirksmode.org/js/cookies.html#script
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T06:41:32.720

看看这个页面讨论[彗星](http://en.wikipedia.org/wiki/Comet_(programming) "彗星")，这似乎是你想要的。

# c - 如何检测玩家在游戏中的攻击性？

> ID：754978
> 
> 赞同：3
> 
> 时间：2009-04-16T06:33:52.663
> 
> 标签：c, artificial-intelligence

我正在为 gameboy Advance 编写游戏，并且正在以二叉搜索树的形式实现基本 AI。有1个人类玩家和1个电脑玩家。我需要找出一种方法来说明人类玩家在攻击计算机时的攻击性。`while`人类将按下按钮进行攻击（并且必须在计算机的某个半径范围内），所以我的第一个想法是看看攻击次数与我的主循环经历的迭代次数相比有多大。不过，这似乎是一种糟糕的方法，因为该数字将取决于可能会波动的帧速率。有没有人有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-16T06:52:35.177

为什么不只计算人类玩家*可以*攻击电脑玩家的时刻数呢？我的意思是，你显然必须检查他是否在范围内，所以为什么不检查他是否在范围内，如果他在，增加`could_have_attacked`计数器。然后如果他真的攻击，增加一个`attacked`计数器。然后你可以比较人类玩家攻击的频率和他有机会的频率。

或者，比较他在射程内的频率与他不在射程内的频率，或者更一般地跟踪球员之间的平均距离。更具侵略性的玩家可能会比被动玩家更接近他们的对手。

您最好的选择可能是不同方法的组合。保持几个不同的测量，并尝试几种不同的方法来衡量这些方法，并使用广泛的游戏测试来选择哪一个更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T06:53:30.727

你必须定义什么是侵略性的。例如，您可以说激进是一名追求 AI 的玩家，因此您会更频繁地检查他是否在射程内而不是在射程外。或者你可以说激进是一个玩家每有机会就攻击，所以你会检查成功攻击的比率与玩家必须攻击的时间量。或者你可以说一个激进的球员在受伤时会进攻。一旦您定义了游戏世界中“激进”的含义，您就可以建立关键性能指标来判断玩家何时属于该定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T06:37:26.367

您可以为此使用伪随机生成器。假设您有一个 rnd() 函数，它返回一个从 0 到 1 的值 - 更大的值对应于更高的攻击性。您引入一个从 0 到 1 的系数。每次您需要确定角色是否会攻击您调用 rnd() 并将值与系数进行比较。如果它大于那个 - 攻击，否则不是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T06:59:37.937

我想到了计算战斗之间的平均时间和计算战斗中的平均射速。为此，您需要 5 个变量，如下所示：

```
float avgTimeWithoutCombat;
float currentTimeWithoutCombat;

float avgRateOfFire;
int shotsFired;
float combatTimeElapsed; 
```

只要玩家不打架，你就在 currentTimeWithoutCombat 中计算“和平”时间。当他开火时，将其添加到 avgTimeWithoutCombat 并除以 2 以获得平均值。

每次玩家攻击时，增加射击次数。另外，计算战斗时间。如果某个时间没有任何攻击过去，请检查主循环。如果是这样，战斗已经结束，您可以计算 avgRateOfFire。

现在你有两个值来衡量玩家的攻击性：

*   avgTimeWithoutCombat：这个数字越大，玩家的攻击性越低。
*   avgRateOfFire：这个数字越大，玩家越激进。

# jquery - 如何使用 jQuery 淡入 div？

> ID：754982
> 
> 赞同：2
> 
> 时间：2009-04-16T06:35:15.403
> 
> 标签：jquery

我在我的 css 文件中有一个 div 定义如下：

```
 #toolbar
    {
        position:relative;
        top: 0;
        height: 50px;
        background-color: #F4A83D;
        width: 100%;
        text-align: center;
        display: hidden;
    } 
```

然后，在我的 HTML 文件中，我有：

```
 <div id="toolbar">
        TestApp ToolBar
        <br />
        You are visiting:
        <%=ViewData["url"] %>
    </div> 
```

最后，我在我的 html 页面顶部有以下脚本，我认为页面加载时会在我的 div 中淡入淡出：

```
 <script src="../../Scripts/jquery-1.3.2-vsdoc.js" type="text/javascript"></script>
   <script type="text/javascript">
        $(document).ready(function() {
            $("#toolbar").fadeIn("slow");
        });
    </script> 
```

我究竟做错了什么？它立即显示出来，就好像它根本没有消失一样。我没有在 jquery 脚本中正确访问我的 div 吗？

* * *

根据一些答案，我将 div 更改为：

```
<div id="toolbar" style="visibility: hidden">
        TestApp ToolBar
        <br />
        You are visiting:
        <%=ViewData["url"] %>
    </div> 
```

使用相同的脚本调用，现在我的 div 开始隐藏并且永远不会出现。我还有什么做错的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T06:41:00.103

见：[http ://www.w3schools.com/css/pr_class_display.asp](http://www.w3schools.com/css/pr_class_display.asp)

hidden 不是 display 属性的有效值。你应该使用 display:none;

这就是为什么您可以立即看到它，它从未被隐藏，因为浏览器不知道如何处理 display:hidden; 宣言。

您可能想要可见性：隐藏；属性虽然因为这样工具栏将不可见但呈现，所以它将占用文档中的空间。这将确保您的整个页面在淡入时不会被推来推去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T06:40:45.920

您必须先隐藏 div。

```
$('#toolbar').hide().fadeIn('slow'); 
```

或像这样，因此在页面仍在加载时工具栏将不可见：

```
<div id="toolbar" style="visibility: hidden">...</div>

$('#toolbar')
    .css({
        visibility: "visible",
        opacity: 0
    })
    .fadeIn('slow')
; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-22T23:33:09.277

```
$("button").click(function() { 
  $(".element")
  .css({ opacity:0, visibility:"visible" })
  .animate({ opacity:1 }, "slow");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T12:31:29.270

```
$("#toolbar").css("display","none"); 

$("#toolbar").css("display","block").fadeIn('slow'); 
```

或者你可以使用动画功能。 [JQuery 中的动画](http://docs.jquery.com/Effects/animate#paramsoptions)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T21:05:10.380

我注意到的一件事是您的脚本源。

```
<script src="../../Scripts/jquery-1.3.2-vsdoc.js" type="text/javascript"></ 
```

应该

```
<script src="../../Scripts/jquery-1.3.2.js" type="text/javascript"> 
```

还

```
display: hidden; 
```

无效应该是

```
Visibility: hidden; 
```

隐藏元素

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T07:46:23.060

或 `display: none;` 隐藏元素。

并显示：

```
display: block; 
```

并检索元素的状态：

```
var state = $("#ex").css("display"); 

if(state == "none")
{
...
}
else
... 
```

# silverlight - 通过反射获取 mscorlib 2.0.5.0（又名 Silverlight mscorlib）中的类型？

> ID：754983
> 
> 赞同：7
> 
> 时间：2009-04-16T06:35:23.190
> 
> 标签：silverlight, reflection.emit, nemerle, mscorlib, assembly.reflectiononly

我正在尝试将 Silverlight 支持添加到我最喜欢的编程语言 Nemerle。

Nemerle，在编译过程中，通过反射主要分两步加载所有类型

1-) 使用 Assembly.LoadFrom 加载程序集 2-) 使用 Assembly.GetTypes() 获取类型

然后在编译结束时，它使用 Reflection.Emit 发出解析的类型。

此过程适用于所有程序集，包括 Silverlight 程序集，除了 silverlight 的 mscorlib。

在 c# 中，这失败了：

```
 var a = System.Reflection.Assembly.LoadFrom(@"c:\mscorlib.dll"); 
```

但这通过了：

```
var a = System.Reflection.Assembly.ReflectionOnlyLoadFrom(@"c:\mscorlib.dll"); 
```

Bu 在后者中，a.GetTypes() 抛出异常说 System.Object 的父级不存在。

有出路吗 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T13:44:18.667

假设您尝试从标准 CLR 反映 Silverlight 的 mscorlib，这将不起作用，因为 CLR 不允许加载多个版本的 mscorlib。（也许这是因为它可能会扰乱其核心类型的解析）。

一种解决方法是使用 Mono.Cecil 检查类型： [http](http://mono-project.com/Cecil) ://mono-project.com/Cecil 。这个库实际上比 .NET 的 Reflection 执行得更好，并且应该更强大。

这里有一些代码可以帮助您入门：

```
AssemblyDefinition asm = AssemblyFactory.GetAssembly(@"C:\mscorlib.dll");

var types =
    from ModuleDefinition m in asm.Modules
    from TypeDefinition t in m.Types
    select t.Name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-08T09:23:39.997

您可以使用 Silverlight 程序集编译 Nemerle，然后让 Nemerle 在 Silverlight 之上工作 :)

# c# - 如何获取强类型的本地资源文件？

> ID：754985
> 
> 赞同：0
> 
> 时间：2009-04-16T06:36:24.123
> 
> 标签：c#, asp.net

我真的很喜欢它的想法，因为我可以为我的用户控件创建一个文件夹，并制作子文件夹图像，css，并放置本地资源文件，所以整个东西都包含在一个文件夹中，这对我来说真的很有效（管理明智）。但问题是你不能像全球资源那样获得智能，所以有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T06:55:30.630

AFAIK：标准配置中的 ASP.NET 和 Visual Studio 只能对全局资源执行此操作。

# testing - 浏览器兼容性测试

> ID：754991
> 
> 赞同：7
> 
> 时间：2009-04-16T06:38:27.877
> 
> 标签：testing, comparison, cross-browser

如何进行浏览器兼容性测试？

是否有任何特定的方法或清单可以确认浏览器 IE 6/7/8 上的兼容性测试已完成。

让我将我的查询特别扩展到一个应用程序：

让我们假设在 IE6 中测试了一个 Web 应用程序（大约 5000 个测试用例）

现在我还需要检查 IE7 和 IE8 中的应用程序兼容性。

我怎么去？因为我无法在所有浏览器中执行所有 5000 个测试用例

我需要确切知道在 IE7 和 IE8 浏览器中测试时可能出现问题的位置。

跨浏览器测试应用程序兼容性的基准是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T06:50:50.873

为了测试不同 IE 版本的网站，我使用[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)。

我没有清单，但我只是直观地比较不同浏览器中的网站并检查 css 和 javascript（例如 jQuery 插件）是否按预期工作。大多数时候，您知道哪些部分可能会导致旧版浏览器出现问题......

我有时使用[BrowserShots](http://browsershots.org/)，但它只会显示屏幕截图并且检索屏幕截图有延迟，所以你必须等待结果......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T07:04:04.803

Microsoft 已发布[Expression Web SuperPreview](http://www.microsoft.com/expression/try-it/superpreview/)，它允许并排测试多个版本的 IE（6、7、8）。

仅 IE 测试是免费的。他们还计划增加对 Firefox 和 Safari 的支持并为此收费。它看起来很有趣，但仍然只是测试版。

带有大量屏幕截图的评论： [http ://www.istartedsomething.com/20090318/expression-web-superpreview-cross-browser-testing/](http://www.istartedsomething.com/20090318/expression-web-superpreview-cross-browser-testing/)

下载测试版： http: [//www.microsoft.com/downloads/details.aspx? FamilyID=8e6ac106-525d-45d0-84db-dccff3fae677&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=8e6ac106-525d-45d0-84db-dccff3fae677&displaylang=en)

另一个链接： [http ://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/](http://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-16T10:21:19.487

I understand that your current test cases are not automated.

On top of what the other answers suggest, it feels to be a good idea to automate some of the test cases (the most important/critical scenarios) - check out [watin](http://watin.sourceforge.net/) or [Selenium](http://seleniumhq.org/). Then, you can run those against multiple browsers to catch some errors. You can make screenshots during the test run and use visual compare tools to detect changes and regressions, which will greatly help you maintaining the app.

Doing that and tracking IE bugs will get you only to some point. You can't completely avoid manual testing...

The good news is that you do not have to worry much about IE8 - it is more standards compliant and you can always use IE7-compatible tag, so it uses IE7 rendering engine.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T06:48:57.510

尝试[多个 IE](http://tredosoft.com/Multiple_IE)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T07:04:51.620

你需要

[微软超级预览](http://www.microsoft.com/expression/try-it/superpreview/)

它具有从 IE6 到 IE8 的重新编译引擎，还支持 Firefox 和 Safari。另请查看此[博客文章](http://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/)以获取详细信息和跨浏览器测试的另一种方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-20T08:08:04.347

为了使网页设计师摆脱在不同浏览器中测试浏览器兼容性的痛苦工作，很少有网站提供这项服务。在这些网站上，您可以检查您的网站在所有所需浏览器中的兼容性。[您可以在http://www.bestpsdtohtml.com/7-awesome-resources-to-test-cross-browser-compatibility-of-your-website/](http://www.bestpsdtohtml.com/7-awesome-resources-to-test-cross-browser-compatibility-of-your-website/)找到这些网站

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T10:29:43.337

尝试在 Javascript 中查找用于单元测试的框架（例如 jsUnit）。拥有一个大型测试用例将减少在不同浏览器中测试代码的痛苦！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-28T07:24:59.110

尝试使用[VM Ware Fusion](http://www.vmware.com/products/fusion/overview.html)，这样您就可以在您的机器上安装多个操作系统。然后安装您需要在不同平台上测试的所有浏览器。

我个人在安装了 Windows 7 和 Windows XP 的 OSX 机器上运行 Fusion。在Win7上我运行IE8，在XP上我运行IE7。

# asp.net - 无法在文本框中加载值

> ID：754993
> 
> 赞同：0
> 
> 时间：2009-04-16T06:38:42.667
> 
> 标签：asp.net, vb.net

我有放置在手风琴（ajax 控件）内的文本框。在页面加载事件中，我编写了代码以在文本框中加载值。但是 onload 事件一个错误是作为对象未设置为对象的实例而出现的。值不会出现在文本框中。然后我尝试初始化文本框中的控件。然后错误清除。但是值不会出现在文本框中。这可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T06:49:13.250

您是否正确设置了 Accordian 的属性？

如果是，请检查您分配给文本框的值。如果它们为空白，则这些值将不可见。

尝试为您的文本框提供硬编码值并检查它是否出现 -

```
textboxObject.Text = "Hello World!"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T09:00:02.950

猜测一下，由于文本框是手风琴的子控件，您可能必须使用 AccordianObject.FindControl() 方法来查找您的文本框。

更多信息或发布一些代码会有所帮助，否则我们只会在黑暗中刺伤。*********