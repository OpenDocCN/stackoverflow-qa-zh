# StackOverflow 问答 11731000-11731999

# php - 无法将特殊哈希码插入数据库

> ID：11731002
> 
> 赞同：-1
> 
> 时间：2012-07-30T23:11:35.630
> 
> 标签：php, mysql, hash, md5, sha

我想在 mysql 数据库中保存哈希密码，所以我在 CodeIgniter 中开发了以下方法。

```
private function hashing($password = '',$mail = '')
{
    $hashcode = md5($password, $mail);
    return sha1($hashcode,md5($hashcode.$mail));
} 
```

插入：

```
$data = array('mail'=>$mail,'password'=>$password,'actived'=>1,'time'=>time());
$this->db->insert('users', $data); 
```

其他字段正确插入，而不是密码。

它会产生类似的东西

```
òLmyÉZÔe+ú§3GèÇu'</pre>

无法保存在mysql数据库中。问题出在哪里？

**编辑**数据库排序规则是 utf8_unicode_ci
**编辑**我正在使用 CodeIgniter，所以它不需要 mysql_real_...

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:23:42.430

您可能打算这样做：

```
return sha1($hashcode . md5($hashcode.$mail)); 
```

而不是这个：

```
return sha1($hashcode,md5($hashcode.$mail)); 
```

to的第二个参数`sha1()`是一个布尔值，控制它是否以原始或字符串格式返回哈希（false = string，这是您要插入的内容）。

[http://php.net/manual/en/function.sha1.php](http://php.net/manual/en/function.sha1.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:24:37.953

您没有正确使用函数 sha1，它的签名是

```
string sha1 ( string $str [, bool $raw_output = false ] ) 
```

因为 md5 函数将评估为不为假的内容（某些字符串），您将获得原始二进制输出。

顺便说一句，您在使用 md5 函数时犯了同样的错误，它与 sha1 具有相同的签名

```
string md5 ( string $str [, bool $raw_output = false ] ) 
```

# permissions - 使用 LDAP 对 MediaWiki 进行粒度访问控制

> ID：11731005
> 
> 赞同：2
> 
> 时间：2012-07-30T23:12:24.090
> 
> 标签：permissions, ldap, mediawiki, acl

我的公司有一个 MediaWiki 设置，我们希望使 [部分] 客户端可访问。理想情况下，每个客户只能看到他们自己的页面。我们的 wiki 要求用户登录查看或编辑，并且我们有 LDAP 插件（特别是[这个](http://www.mediawiki.org/wiki/Extension%3aLDAP_Authentication)），因此我们可以使用我们的 Active Directory 凭据。

我看到这个问题在几年前就已经出现了，但我没有看到特别涉及 LDAP 的问题。如果我们为此目的在我们的域中为客户提供一个特定的 AD 帐户，我们可以管理一个特定的 AD 帐户吗？或者，有没有办法让客户直接登录到 wiki（有点像在本地登录到计算机，而不是域），我们可以控制访问权限？

供参考：我们在 MediaWiki 版本 1.19.1、PHP 版本 5.3.15、MySQL 版本 5.0.96-winx64，安装在 Windows Server 2008 R2 x64 (IIS 7.5) 上运行。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T17:46:16.153

除了 LDAP 帐户之外，您还可以使用本地帐户来登录用户。您必须在 LocalSettings.php 中将[$wgLDAPUseLocal](http://www.mediawiki.org/wiki/Extension%3aLDAP_Authentication/Configuration_Options#Domain.2C_server_and_connection_configuration_options)设置为 true。基本上，它在“本地”登录表单上的域下拉框中添加了另一个选项。想要使用本地 wiki 帐户登录的用户使用它。我还将[禁用](http://www.mediawiki.org/wiki/Manual%3aPreventing_access#Restrict_account_creation) wiki 上的帐户创建并为您的客户手动创建帐户。

无论您使用本地帐户还是 AD 帐户，对于页面级访问控制，您都必须使用[这些扩展程序](http://www.mediawiki.org/wiki/Category%3aPage_specific_user_rights_extensions)之一。[Extension:AccessControl](http://www.mediawiki.org/wiki/Extension%3aAccessControl)似乎很流行。

# javascript - 在外部声明的变量和在 XMLHttpRequest 中修改的变量值在此 Ajax 请求之外不可见

> ID：11731013
> 
> 赞同：0
> 
> 时间：2012-07-30T23:13:28.197
> 
> 标签：javascript, ajax

外部声明的变量：

```
var total=0;

on success of AJAX{

total++;
alert(total);// gives value
}

alert(total)// gives zero value 
```

在这里，我将总值设为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:14:17.833

您的`ajax`请求可能是*异步*的。这意味着您`alert`发生*在*响应返回之前。

任何依赖于响应的代码*（比如你的警报）*都需要放在你的`onreadystatechange`处理程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:15:37.343

它不清楚实际上是什么问题，但这听起来像是典型的*异步*混淆。A`XMLHttpRequest`默认情况下，运行 async 并在遇到事件时触发其*回调（例如，readyState 4）。*

因此，您的`alert()`语句很可能在您的任何 ajax 处理程序触发之前遇到。

因此，简单的解决方案是将其移动`alert()`到您`.onreadystatechange`各自的`.onload`事件处理程序中，移动到处理`success`.

最糟糕的解决方案（即使没有人会推荐）是将您的设置`XMLHttpRequest`为*syncronous*。这意味着，在请求运行期间，您的浏览器及其 UI 线程被锁定，直到请求完成。

# php - 获取属性（邮政编码）并在 Google maps API 3 中使用它

> ID：11731016
> 
> 赞同：0
> 
> 时间：2012-07-30T23:13:43.043
> 
> 标签：php, javascript, google-maps-api-3

我有一个 magento 网站，我的产品是企业。我想将谷歌地图添加到产品页面，需要有人帮助我编写代码。

我可以通过键入来拨打邮政编码

```
<?php echo $_product->getpostcode() ?> 
```

我从互联网上获取了代码，并试图将它放在我的网站上。这是代码：

```
 <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>

   <script>
  var geocoder;
  var map;
  var address = '<?php echo $_product->getpostcode() ?>'
  function initialize() {
    geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(-34.397, 150.644);
    var mapOptions = {
      zoom: 8,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
  }

  function codeAddress() {
    var address = document.getElementById('address').value;
    geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        map.setCenter(results[0].geometry.location);
        var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
        });
      } else {
        alert('Geocode was not successful for the following reason: ' + status);
      }
    });
      }
    </script>
    <body onload="initialize()">

    <div id="map_canvas" style="width: 500px; height: 300px"></div> 
```

目前它在代码中使用 lat long。我怎样才能将其更改为使用邮政编码？`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T09:48:35.643

地图*总是*使用坐标。这就是地图的工作方式。如果您想使用邮政编码，则需要将其转换为坐标——该过程称为**地理编码**。

您的代码中有一个地理编码功能，目前无法使用，因为您没有名为 的元素`address`，但稍作调整即可使用。

您当前有一个名为 的全局变量`address`，其中包含您的邮政编码，因此请让您的地理编码器函数使用它：

在 function 的底部`initialize()`，添加对 geocoder 函数的调用，将全局变量传递给它：

```
 map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
 codeAddress(address);
} 
```

更改该函数以接受参数：

```
function codeAddress(addy) { 
```

然后使用它：

```
// var address = document.getElementById('address').value;
// The above line needs to be removed; the one below amended
geocoder.geocode( { 'address': addy}, function(results, status) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T05:38:17.133

```
//i have working function use it.
  function initialize() {
var address = "<?php echo $address?>";
geocoder = new google.maps.Geocoder();
var latlng = new google.maps.LatLng(50.317408,11.12915);
var myOptions = {
  zoom: 8,
  center: latlng,
mapTypeControl: true,
mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
navigationControl: true,
  mapTypeId: google.maps.MapTypeId.ROADMAP
};
map = new google.maps.Map(document.getElementById("location-canvas"), myOptions);
if (geocoder) {
  geocoder.geocode( { 'address': address}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      if (status != google.maps.GeocoderStatus.ZERO_RESULTS) {
      map.setCenter(results[0].geometry.location);

        var infowindow = new google.maps.InfoWindow(
            { content: '<b>'+address+'</b>',
              size: new google.maps.Size(150,50)
            });

        var marker = new google.maps.Marker({
            position: results[0].geometry.location,
            map: map, 
            title:address
        }); 
        google.maps.event.addListener(marker, 'click', function() {
            infowindow.open(map,marker);
        });

      } else {
        alert("Address Not found");
      }
    } else {
      alert("Geocode was not successful for the following reason: " + status);
    }
  });
} 
```

}

# javascript - 最接近的jQuery

> ID：11731018
> 
> 赞同：1
> 
> 时间：2012-07-30T23:13:52.707
> 
> 标签：javascript, jquery

```
<div class="panels">
    <div>
        <h2>
        Test
        </h2>
    </div>
    <div class="inner_panel statict">
         Test2
    </div>
</div> 
```

我希望当人们点击测试时，会出现 Test2。如果没有，他们看不到 Test2，我怎样才能使用 jquery 做到这一点？

我尝试了以下但它不起作用。

```
 $('.inner_panel').hide();

  $('.panels').click(function () {
    $(this).closest('div .inner_panel').toggle();
  }); 
```

我在文件中有多个带有类面板的 div，所以我不想点击测试影响其他“面板”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:20:42.670

`closest`方法在 DOM 树中查找，而不是向下查找。你可以在这里查看。[http://api.jquery.com/closest/](http://api.jquery.com/closest/)

也许你应该使用`.children('div.inner_panel')`来获取你的元素。`children`方法允许您获取元素，这些元素位于 DOM 的下一层。检查[http://api.jquery.com/children/](http://api.jquery.com/children/)详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:41:26.270

```
 $('.inner_panel').hide();

 // Within .panels get the div's which contain an H2
 var containers = $('.panels h2').closest("div");

 // make them clickable
 containers.click(function () {
    // For the clicked panel, get the next element div which 
    // has the inner_panel class
    $(this).next('div.inner_panel').toggle();
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:15:35.417

你有一个额外的空间->`$(this).closest('div .inner_panel').toggle();`

这应该是：`$(this).closest('div.inner_panel').toggle();`

但是`.closest()`对你不起作用，因为它沿着 DOM 树向上传播，而不是向上然后向下传递到兄弟姐妹等。

我会这样做：

```
$('.inner_panel').hide();

$('.panels').click(function () {
  $(this).find('div.inner_panel').toggle();
}); 
```

见[jsbin 演示](http://jsbin.com/ihowok/1/edit)

# c# - 在实体框架中连接表

> ID：11731020
> 
> 赞同：1
> 
> 时间：2012-07-30T23:13:59.867
> 
> 标签：c#, asp.net, entity-framework-4

我有一个名为 Student 的表和一个名为 Majors 的表，Students 和 Majors 加入了`MajorId` 我已经设置了这种关系并在模式中设置了外键。当我访问我的`Student`对象时，如何返回该`MajorName`列（这来自 Majors 表）？我在智能感知中的唯一选择是`Major_1`, `Major_1Reference`, `MajorId`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:15:32.863

`Major_1`应该是通向相应`Major`条目的导航属性，因此您应该能够`Major`像这样访问 的属性：

```
from s in ctx.Students
select s.Major_1.MajorName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T06:42:39.427

您可以使用这样的 linq join 语句对两个表进行查询...

```
var q = from s in Students
        join m in Majors on s.MajorId  equals m.MajorId 
        select new { m.MajorName }; 
```

# java - 如何访问与我通过java工作不同的服务器上的目录？

> ID：11731021
> 
> 赞同：0
> 
> 时间：2012-07-30T23:14:14.023
> 
> 标签：java, ssh, filesystems

我有两台服务器，一台运行我用 Java 编写的程序（服务器 A），另一台存储必须由服务器 A 连续访问的图形（服务器 B）。要访问服务器 B，您必须使用服务器使用用户名和密码 ssh B的IP地址。到目前为止，我还没有找到一种方法来连续访问不同服务器上的目录，我想知道是否有人知道让我这样做的方法（或者如果不可能，是否有解决方法）。

我查看了[SSH 库](https://stackoverflow.com/questions/995944/ssh-library-for-java)，但它们似乎都只允许您在很短的时间内访问该目录。**我需要持续访问，因为我一直在服务器 B上**的图表中写入和读取。我基本上想在服务器 A 上创建一个代理目录，它实际上是指/链接到服务器 B 上的目录：

> graphDb = new EmbeddedGraphDatabase("/192.168.1.**/media/graphDB");

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:01:33.450

可能不相关的选项：

如果客户端和服务器是 Linux 机器，可以使用[rsync](http://en.wikipedia.org/wiki/Rsync)在它们之间同步文件。这样，您就有了服务器 A 上文件的副本。 rsync 命令可以从 Java 程序执行，也可以从服务器 A 上的 cronjob 定期执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:46:45.210

*   您可以编写自己的客户端/服务器服务，以便服务器服务为您提供通过网络向其发送数据的方法。不过，这往往是很多工作。
*   您可以在客户端上为自己编写一个“心跳”服务来测试 SSH 连接并在它关闭时重新建立它
*   您可以在写入/读取连接之前“测试” ssh 连接
*   您可以按照 AlperAkture 的建议进行操作（并将目录挂载为远程驱动器）

# java - Java 枚举关联

> ID：11731024
> 
> 赞同：0
> 
> 时间：2012-07-30T23:14:18.747
> 
> 标签：java, enums

我正在尝试创建一个场景，其中枚举常量 in`enum class A`具有关联的 sub`enum class B`并`enum class C`包含它们自己的常量。中的常数`enum class B`和常数的`enum class C`组子集来自`enum class D`。以下是我想要实现的基本目标：

```
enum A {
    CONST_1 ("const_1", B), // B is the associated enum
    CONST_2 ("const_2", C); // C in the associated enum

    private final String strVal;
    private final Enum associatedEnum;

    private A (String strVal, Enum associatedEnum) {
        this.strVal = strVal;
        this.associatedEnum = associatedEnum;
    }

    public Enum getAssociatedEnum() {
        return this.associatedEnum;
    }

    public String toString() {
        return this.strVal;
    }       

    // Associated Enum contained subset of grouped constants
    enum B {
        CONST_3 (D.CONST_7.toString()),
        CONST_4 (D.CONST_8.toString()); 

        private final String strVal;

        private B (String strVal) {
            this.strVal = strVal;
        }

        public String toString() {
            return this.strVal;
        }       
    }

    // Associated Enum contained subset of grouped constants
    enum C {
        CONST_5 (D.CONST_9.toString()),
        CONST_6 (D.CONST_10.toString()); 

        private final String strVal;

        private C (String strVal) {
            this.strVal = strVal;
        }

        public String toString() {
            return this.strVal;
        }              
    }
}

// Separate Enum containing all ungrouped constants
enum D {
    CONST_7 ("const_7"),
    CONST_8 ("const_8");
    CONST_9 ("const_9"),
    CONST_10 ("const_10");

    private final String strVal;

    private D (String strVal) {
        this.strVal = strVal;
    }

    public String toString() {
        return this.strVal;
    }    
} 
```

显然，这种语法在 OOTB 中不起作用，因为您不能以这种方式在 Java 中传递类。但是任何人都可以提出一种我可以实现这一目标的方法吗？

我希望用它来验证客户端应用程序中的静态结构化分组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:58:36.823

这应该有希望做你想要的。我已经包含了一个示例用法，它将列出子枚举类型值。

```
package a.b.c;

public class EnumsTest {

  public enum A {
    A1( B.class ),
    A2( C.class );

    private final Class<? extends Enum<?>> enumClazz;

    A( final Class<? extends Enum<?>> enumClazz  ) {
      this.enumClazz = enumClazz;
    }

    public Enum<?>[] getSubEnumConstants() {
      return enumClazz.getEnumConstants();
    }

   /**
    * @param value
    * @return Never null
    * @throws IllegalArgumentException To be consistent with Enum.valueOf()
    */
   public <T> Enum<?> valueOfSubEnum( final String value ) throws IllegalArgumentException {
     for( Enum<?> enumInstance : getSubEnumConstants() ) {
       if( enumInstance.name().equals( value ) ) {
         return enumInstance;
       }
     }
     throw new IllegalArgumentException( "valueOf for " + enumClazz.getName() + " could not be resoled with the value of " + value );
   }

  }

  public enum B {
    B1,
    B2;
  }

  public enum C {
    C1,
    C2;
  }

  public static void main( String[] args ) {

    for( A a : A.values() ) {
      for( Enum<?> enumInstance : a.getSubEnumConstants() ) {
        System.out.println( a.name() + ":" +  enumInstance.name() );  
      }
    }
    Enum<?> valueOfSubEnum = A.A1.valueOfSubEnum( "B2" );
    System.out.println( valueOfSubEnum.name() );
  }
} 
```

注意：如果您想将子类型锁定到特定的集合，您可以让它们实现一个接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:31:01.903

你不能`enum A`用构造函数 声明一个`private B (String strVal, Enum associatedEnum)`。您可以在彼此内部声明其他枚举，但不能这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:04:10.173

这对我有用，但我可能错过了你想要实现的目标：

```
public enum A {

  A1(B.B1),
  A2(C.C2);

  private final Enum<?> e;

  private A(Enum<?> e) {
    this.e = e;
  }

  static enum B {
    B1,
    B2;
  }

  static enum C {
    C1(D.D1.getId()),
    C2(D.D2.getId());

    private String id;

    private C(String id) {
      this.id = id;
    }

  }

}
enum D {
  D1("abc"),
  D2("def");

  private final String id;

  private D(String id) {
    this.id = id;
  }

  public String getId() {
    return id;
  }

} 
```

# c# - 在 .NET MVC 中建模绑定 Accept 标头的最简洁方法

> ID：11731026
> 
> 赞同：6
> 
> 时间：2012-07-30T23:14:30.543
> 
> 标签：c#, json, asp.net-mvc-3, model-binding

我正在.NET MVC 3 中实现一个 REST 层。我正在寻找一种干净的方法来获取 Accept 标头以确定我是否应该返回 Json 或 Xml。

我还希望能够使用 GET 参数来欺骗此标头以进行调试（我希望这也能持续到 prod）。

这是我目前检测到的方式：

```
if (Request.AcceptTypes.Contains("application/json") || Request.Url.Query.Contains("application/json")) 
```

这是我的控制器代码中唯一直接接触 Request 对象的地方。我想要一种更干净、更可测试的方式来阅读这篇文章。我理想的解决方案是控制器上的参数。

我尝试了几个关键字来查看默认模型绑定器是否会使用它，但我尝试过的没有任何效果。

**那么获取这些信息的最干净的方法是什么？自定义模型绑定器？你能举个例子吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:23:26.963

动作过滤器属性将是一个好的、干净的解决方案。

这里有一个很好的教程：[http ://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T16:09:32.813

我没有看到任何比自定义模型活页夹更好的替代品。我将在这里发布我的活页夹实现，以防其他人看到。使用模型绑定器允许将 Accept 标头强绑定到操作的直接输入，从而允许直接测试返回类型，并且不会强制您人为地执行超出您需要的操作，也不会导致动态类型化的视图数据/包。

这是具有支持枚举类型的模型绑定器：

```
public enum RequestAcceptType
{
    NotSpecified,
    Json,
    Xml
}

public class RequestAcceptTypeModelBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        if (bindingContext == null)
        {
            throw new ArgumentNullException("bindingContext");
        }

        RequestAcceptType acceptType = RequestAcceptType.NotSpecified;

        // Try for Json
        if (controllerContext.HttpContext.Request.AcceptTypes.Contains("application/json") || controllerContext.HttpContext.Request.Url.Query.Contains("application/json"))
        {
            acceptType = RequestAcceptType.Json;
        }

        // Default to Xml
        if (acceptType == RequestAcceptType.NotSpecified)
        {
            acceptType = RequestAcceptType.Xml;
        }

        return acceptType;
    }
} 
```

这是 Application_Start 方法中 Global.asax 中的相关位：

```
ModelBinders.Binders[typeof(RequestAcceptType)] = new RequestAcceptTypeModelBinder(); 
```

然后要在您的操作中使用它，只需使用枚举类型创建一个参数（任何名称）：

```
public ActionResult Index(RequestAcceptType acceptType) 
```

如果几天内没有人用更好的方法做出回应，我会接受这个作为答案。

# ruby-on-rails - Rails 通配符路线：vs *

> ID：11731028
> 
> 赞同：6
> 
> 时间：2012-07-30T23:14:50.347
> 
> 标签：ruby-on-rails, wildcard, routes

我开始学习 Rails，并且看到了术语通配符路线，但我看到路线以下列两种方式列出：

```
/a/path/*all', :all => /.*/ 
```

和

```
/a/path/:all 
```

这两种路由形式有什么区别？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-30T23:45:12.437

你读过关于路由**[的 Rails 指南](http://guides.rubyonrails.org/routing.html)**吗？这是开始学习 Rails 中路由的好地方。

例如，您将了解到您的第二个代码块**不是**通配符路由。相反，它与上面的指南所指的**[静态段相匹配](http://guides.rubyonrails.org/routing.html#static-segments)**

您还将了解到，要对似乎在第一个代码块中尝试的段施加限制，您必须使用该`:constraints`选项，例如此**通配符 route**，或者如上面的指南所指的那样，**[Route Globbing](http://guides.rubyonrails.org/routing.html#route-globbing-and-wildcard-segments)**

```
GET  "/a/path/*all", :constraints => { :all => /.*/ } 
```

但是，上述约束是多余的，因为通配符无论如何`*all`都会默认匹配`.*`。

# jquery-1.4 - 这两个 jQuery 引用有什么区别，为什么不能使用 .live？

> ID：11731029
> 
> 赞同：0
> 
> 时间：2012-07-30T23:14:59.090
> 
> 标签：jquery-1.4

EmployeeId 是带有一组选项的选择元素的 ID。这种方法不起作用：

```
var tar = document.getElementById("EmployeeId");
$(tar).live("click", function(){
 console.log("Changed");
}); 
```

但是，这种方法可以：

```
$("#EmployeeId").live("click", function(){
 console.log("Changed");
}); 
```

`$("#EmployeeId")`和有什么区别`$(tar)`？？我的印象是两者之间没有区别。此外，当我尝试

```
console.log($(tar));
console.log($("#EmployeeId")); 
```

同样的东西被发送到控制台。

我错过了什么，有什么不同，为什么一种方法不附加事件处理程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:19:21.413

`.live`需要使用选择器，因为它将事件处理程序绑定到`document`然后测试事件的来源（或路径中的任何元素）是否与选择器匹配。

如果没有提供选择器，它将不起作用。这就是为什么像这样的链接方法`$('foo').children().live(..)`也不起作用。

从 jQuery 1.7 开始，由于`.live`其文档中列出的各种原因而被弃用：http: [//api.jquery.com/live/](http://api.jquery.com/live/)。

替代方案是[`.on`](http://api.jquery.com/on/)(1.7) 和[`.delegate`](http://api.jquery.com/delegate/)(1.4.2)。

# python - ElementTree：“查找”方法的“匹配”参数的语法是什么？

> ID：11731040
> 
> 赞同：2
> 
> 时间：2012-07-30T23:16:43.670
> 
> 标签：python, lxml, elementtree

[这里](http://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.Element.find)的官方文档只是说，“匹配可能是标签名称或路径”，但我在任何地方都没有看到“路径”的定义。通过查看网络上的示例，我收集到它是一些精简的 XPath 类表示法，但不清楚究竟允许什么 - 例如，路径应该以 a `/`、 a`//`还是根本没有分隔符开头？我可以用 指定属性`[@att = "value"]`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:50:50.803

好吧，查看[http://hg.python.org/cpython/file/2.7/Lib/xml/etree/ElementTree.py](http://hg.python.org/cpython/file/2.7/Lib/xml/etree/ElementTree.py)的源代码，我们发现它`Element.find`被实现为

```
def find(self, path, namespaces=None):
    return ElementPath.find(self, path, namespaces) 
```

`ElementPath`被实现为

```
try:
    from . import ElementPath
except ImportError:
    ElementPath = _SimpleElementPath() 
```

`_SimpleElementPath`只检查标签名称：

```
# emulate pre-1.2 find/findtext/findall behaviour
def find(self, element, tag, namespaces=None):
    for elem in element:
        if elem.tag == tag:
            return elem
    return None 
```

所以让我们看一下ElementPath.py：http://hg.python.org/cpython/file/f98e2944cb40/Lib/xml/etree/ElementPath.py[它](http://hg.python.org/cpython/file/f98e2944cb40/Lib/xml/etree/ElementPath.py)说，

```
# limited xpath support for element trees 
```

所以我会假设有效的 XPath 可能是`find`. 我对 XPath 不够熟悉，无法准确确定它支持什么，但[http://effbot.org/zone/element-xpath.htm](http://effbot.org/zone/element-xpath.htm)描述了五年前它支持多少，并包含一个语法表。

> ElementTree 为 XPath 表达式提供有限的支持。目标是支持缩写语法的一小部分；完整的 XPath 引擎超出了核心库的范围。

[http://docs.python.org/dev/library/xml.etree.elementtree.html#xpath-support](http://docs.python.org/dev/library/xml.etree.elementtree.html#xpath-support)有一个更新的表格。它看起来并没有太大的不同。

# javascript - JavaScript 链接提取器

> ID：11731048
> 
> 赞同：0
> 
> 时间：2012-07-30T23:19:10.143
> 
> 标签：javascript, hyperlink, extract, web-crawler

我有兴趣从使用 JavaScript 动态生成链接并且在 HTML 源代码中基本上不可见的站点中提取链接。例如，这里是一个示例站点，其中通过 js 菜单插入链接：http: [//www.stcroixwebsolutions.com/](http://www.stcroixwebsolutions.com/)

当我将鼠标悬停在链接上时，我看到了这些链接，但它们在 HTML 源代码中无法识别。

我想像这样输出链接：http:
[//www.stcroixwebsolutions.com/ ?110000](http://www.stcroixwebsolutions.com/?110000)
[http://www.stcroixwebsolutions.com/?110010](http://www.stcroixwebsolutions.com/?110010)
等。

你建议我用什么来提取这些链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:37:54.773

你可以尝试这样的事情......这至少会让你开始！

[http://jsfiddle.net/Qv4St/](http://jsfiddle.net/Qv4St/)

```
function showLinks() {

  var links = document.getElementsByTagName( 'a' );
  var last = links.length;
  var list = {};

  // for each anchor...
  for (var i = 0; i < last; i++) {

    list[links[i].href] = i;
    console.log(list);
    //' - text=' + links[i].innerHTML + '<br>';

}

  var linksList = document.getElementById( 'linksList' );
  linksList.innerHTML = list;
}    ​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:55:08.147

```
var getLinks = function () {
        "use strict";
        var a = document.getElementsByTagName("a"),
            b = a.length,
            c = 0,
            d = [],
            e = "",
            f = location.href;
        f = f.substring(0, f.lastIndexOf("/"));
        for (c = 0; c < b; c += 1) {
            e = a[c].getAttribute("href");
            if (typeof e === "string" && e.length > 4) {
                if (e.charAt(0) === "/" || e.charAt(0) === "?") {
                    e = f + e;
                }
                d.push(e);
            }
        }
        return d.join("\n") + "\n" + d.length + " total links";
    },
    myLinks = getLinks(); //myLinks variable will contain the desired output.
//To output to the console just replace the line with 'return' with this code:
//console.log(d.join("\n") + "\n" + d.length + " total links"); 
```

运行此代码以在列表中返回给定页面上所有超链接的列表，每个结果在其自己的行中。

编辑：我现在将相对链接转换为绝对 URI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:12:41.027

有一个标准的[document.links](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-7068919)集合，它是文档中的所有链接。简单地迭代它。

# objective-c - 将 NSString 类别扩展添加到 UIButton

> ID：11731052
> 
> 赞同：0
> 
> 时间：2012-07-30T23:19:27.137
> 
> 标签：objective-c, ios, nsstring, uibutton

我想扩展`UIButton`一些`NSString`元信息。我怎么能这样做？

我从这个开始：

```
@interface UIButton (neoUtils)

+ (UIButton *)neoName:(NSString *)buttonName;  

@end 
```

还有他们

```
#import "UIButton+NAME.h"

@implementation UIButton (neoUtils)

+ (UIButton *)neoName:(NSString *)buttonName {
    UIButton *button = [UIButton neoName:buttonName];
    NSLog(@"%@",button);
    return button;
}

@end 
```

这是在正确的道路上吗？如果是这样 - 我怎么可能使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T21:54:42.433

我假设

```
@interface UIButton (neoUtils) 
```

在 UIButton+NAME.h 中声明。

首先，看起来该程序将在您调用该方法后立即进入递归循环：

```
+ (UIButton *)neoName:(NSString *)buttonName {
    UIButton *button = [UIButton neoName:buttonName]; // <- this one
    NSLog(@"%@",button);
    return button;
} 
```

因为它会重新调用方法本身。

无论如何，考虑到扩展对象必须有一个状态（元信息的 NSString 必须被“记住”），我不相信有可能用一个类别来满足要求，这只是扩展了类的行为。然后我猜你的解决方案没有从正确的步骤开始。

相反，我只想创建一个类

```
@interface XYMetaInfoButton : UIButton

@proerty (nonatomic, [strong|retain]) NSString *name;

@end 
```

然后您可以在项目中全局导入以拥有带有元信息的新 UIButton。但这只是一种可能性，也许有人有更好的解决方案。

# java - 初学者的代码测试 - 怎么做？

> ID：11731053
> 
> 赞同：1
> 
> 时间：2012-07-30T23:19:30.773
> 
> 标签：java, unit-testing, testing

假设我在 java 方法中有很多嵌套循环（3-4 级），每个循环都可以有一些 if-else 块。我如何检查所有这些东西是否正常工作？我正在寻找一种合乎逻辑的方法来测试它，而不是使用诸如替换非法值之类的蛮力方法。

编辑：您还可以为初学者推荐一些好的测试书籍吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:27:44.043

我一直被教导基本测试的方式是尽可能地处理边缘情况。

例如，如果您正在检查变量 i 介于 0 和 10 之间的条件，`if(i>0 &&i<10)`我自然会测试一些使测试条件为真的值，最好靠近边缘，然后是边缘上的一些值，它们是真假，最后是超出范围的案例。在上述条件下，我会测试 1,5 ,9, 0, 10, -1, 11，最后是一个非常大的整数，包括正数和负数。

这种做法违背了“不替换非法值）”，但我觉得你必须这样做以确保你的条件正确失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:26:14.333

[EMMA](http://emma.sourceforge.net/userguide_single/userguide.html)是一个代码覆盖率工具。你在 EMMA 下运行你的单元测试，它会生成一个带有彩色源代码的 HTML 报告，显示哪些行已到达，哪些未到达。基于此，您可以添加测试以确保您正在测试所有不同的分支。

代码中的每个 if/then 都包含一个布尔子表达式，就像循环中用于决定是否进入/重新运行循环的子表达式一样。谓词覆盖率应该告诉你你的测试有多彻底。

[维基百科](http://en.wikipedia.org/wiki/Code_coverage)解释谓词覆盖

> 条件覆盖（或谓词覆盖） - 每个布尔子表达式是否评估为真和假？这并不一定意味着决策覆盖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T10:27:18.403

我相信使用调试是找到错误的最简单方法。您可以在此链接中找到有关调试的完整说明：http: [//www.ibm.com/developerworks/library/os-ecbug/](http://www.ibm.com/developerworks/library/os-ecbug/)。

您也可以使用此链接：[http](http://webster.cs.washington.edu:8080/practiceit/) ://webster.cs.washington.edu:8080/practiceit/进行练习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T23:22:15.023

例如，查找将通过每个具有某些值的循环的输入。然后找到将通过 if 的每个分支的输入。然后找到将通过具有大或小或非法值的循环的输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T23:25:22.133

设置一些输入和输出数据。自己计算。创建一个类来检查输出值是否与您单独计算的值匹配。

例子：

输入：数组（3,4,5,6）；

输出（奇数之和）：8

```
 class TestClass{

     //test case
     //here you keep changing the array (extreme values, null etc..
    public void test1(){
     int[] anArray=new int[4];
        anArray[0] = 3;
        anArray[1] = 4;
        anArray[2] = 5;
        anArray[3] = 6;
       int s=Calculator.oddSum(x);
       if (s==8) 
            System.out.println("Passed");
       else 
            System.out.println("Failed");
    }

    public static void main(){ 
      TestClass t=new TestClass();
      t.test1();    
    }
} 
```

# facebook - 有没有办法让页面标签默认展开？

> ID：11731058
> 
> 赞同：0
> 
> 时间：2012-07-30T23:20:37.980
> 
> 标签：facebook, facebook-page

我在 fb 的页面中添加标签。问题是我的客户没有注意到他们需要单击箭头图标才能查看所有选项卡。有没有一种方法或设置可以让我在我的页面上显示所有标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:35:17.113

不，没有办法。重新排序您的标签，以便首先显示您真正希望客户看到的标签。您可以做的另一件事是修改您的**封面**照片，以向您的客户表明那里有很酷的标签。Facebook 不鼓励将封面照片用于广告，因此请尽量保持优雅。

# c# - 用于自定义对象的 xmlserializer

> ID：11731063
> 
> 赞同：0
> 
> 时间：2012-07-30T23:21:02.940
> 
> 标签：c#, xmlserializer

这是我的 xml 文件的样子：

我尝试使用 xsd 为我的对象生成类，但是当我尝试反序列化它时它以某种方式不起作用。我需要将列作为字符串数组，我的类（对象）应该是什么，以便它可以反序列化 xml。

```
<ArrayOfDirective>  
<Directive>
<TestCaseName>RunSqlCar</TestCaseName>
<Action>IgnoreColumn</Action>
<Columns>
<ColumnName>value1</ColumnName>
<ColulmnName>value2</ColulmnName>
</Columns>
<Description>These columns never match becuase IDs are different always.</Description>    
</Directive>
</ArrayOfDirective> 
```

错误：读取 c:\Directives.xml 时出错：XML 文档中存在错误 (2, 2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:13:56.030

使用 XmlSerializer 序列化的数据将如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<ArrayOfDirective xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Directives>
    <Directive>
      <TestCaseName>RunSqlCar</TestCaseName>
      <Action>IgnoreColumn</Action>
      <Columns>
        <Column>
          <ColumnName>value1</ColumnName>
        </Column>
        <Column>
          <ColumnName>value2</ColumnName>
        </Column>
      </Columns>
      <Description>These columns never match because IDs are different always.</Description>
    </Directive>
  </Directives>
</ArrayOfDirective> 
```

这些是序列化为上述 XML 的示例类。

```
class Program
{
    static void Main(string[] args)
    {
        ArrayOfDirective directives = new ArrayOfDirective();

        Directive directive = new Directive("RunSqlCar", "IgnoreColumn",
                "These columns never match because IDs are different always.");

        directive.Columns.Add(new Column("value1"));
        directive.Columns.Add(new Column("value2"));

        directives.Directives.Add(directive);

        XmlSerializer ser = new XmlSerializer(typeof(ArrayOfDirective));
        using (StreamWriter sw = File.CreateText("c:\\directives_generated.xml"))
        {
            ser.Serialize(sw, directives);
        }
    }
}

[Serializable]
public class ArrayOfDirective
{
    public List<Directive> Directives { get; set; }

    public ArrayOfDirective()
    {
        Directives = new List<Directive>();
    }
}

[Serializable]
public class Directive
{
    public string TestCaseName { get; set; }
    public string Action { get; set; }
    public List<Column> Columns { get; set; }
    public string Description { get; set; }

    public Directive(string testCaseName, string action, string description)
    {
        TestCaseName = testCaseName;
        Action = action;
        Description = description;
        Columns = new List<Column>();
    }

    public Directive()
    {
    }
}

[Serializable]
public class Column
{
    public string ColumnName { get; set; }

    public Column(string columnName)
    {
        ColumnName = columnName;
    }

    public Column()
    {
    }
} 
```

# javascript - 等待长功能完成时的jQuery加载窗口

> ID：11731067
> 
> 赞同：0
> 
> 时间：2012-07-30T23:21:22.440
> 
> 标签：javascript, jquery, html, user-interface

我正在尝试使此解决方案适应我的需求：[如何使用 jQuery 创建“请稍候，正在加载...”动画？](https://stackoverflow.com/questions/1964839/jquery-please-wait-loading-animation)

基本上，提供了一个非常棒的方案来包装 Ajax 请求和一个很好的加载 GUI。我正在尝试对我拥有的进行一些计算然后将一些图形附加到 DOM 的函数执行相同的操作。

所以我尝试过的是：

```
$("body").addClass("loading");
long_time_taking_function(mainDiv);
$("body").removeClass("loading"); 
```

不幸的是，在 long_time_taking_function() 执行之前或之后，似乎该类被添加然后立即删除。但是我知道添加类是有效的，因为注释掉 removeClass() 调用会使 gif 浮动在页面上。

有什么想法可以让我完成这项工作吗？如果需要，我可以提供有关中间函数的更多详细信息。

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:31:37.817

这是 AJAX 的一个常见缺陷：第一个“A”代表“异步”。这意味着 AJAX 调用立即返回并或多或少地“在后台”运行。 `long_time_taking_function()`包含一个 AJAX 调用。您只需将其移至`$('body').removeClass('loading')`AJAX 调用的回调中。如果你使用的是 jQuery（假设你是因为你标记了[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")），它看起来像这样：

```
$.ajax({
    ...options...
}).always(function(response) {
    $('body').removeClass('loading');
}); 
```

编辑：这里的 jQuery Deferred 对象的回调应该是`always()`，因为即使 ajax 调用失败，也应该删除加载类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:20:25.557

您可以向您的函数添加回调，以便在完成后，它将调用您的 removeClass 语句。

像这样的东西：

```
 //declare your functions
     function long_time_taking_function(mainDiv, callback){

        //...your code...
        callback();
     }

     function removeLoadGif(){
         $("body").removeClass("loading");
     }

     //in your current code call this
     $("body").addClass("loading");
     long_time_taking_function(mainDiv, removeLoadGif); 
```

或者，您可以将该行添加`$("body").removeClass("loading");`到函数 long_time_taking_function 的末尾。如果身体当前没有类，它不会做任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:32:29.613

你需要做这样的事情......

```
$("body").addClass("loading");
doSomething(url,params)
  .complete(function() {
    $("body").removeClass("loading");
  }); 
```

在您的代码中，addClass 和 removeClass 执行得如此之快，就好像什么都没发生过一样。

# javascript - 按过滤函数除以数组

> ID：11731072
> 
> 赞同：131
> 
> 时间：2012-07-30T23:22:05.007
> 
> 标签：javascript

我有一个 Javascript 数组，我想根据每个元素上调用的函数是否返回`true`或`false`. 本质上，这是一个`array.filter`，但我也希望手头上有被过滤*掉*的元素。

目前，我的计划是`array.forEach`在每个元素上使用和调用谓词函数。根据这是对还是错，我会将当前元素推送到两个新数组之一。有没有更优雅或更好的方法来做到这一点？例如`array.filter`，在返回之前将元素推送到另一个数组的位置`false`？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2017-11-10T14:58:45.537

使用 ES6，您可以使用带有 reduce 的扩展语法：

```
function partition(array, isValid) {
  return array.reduce(([pass, fail], elem) => {
    return isValid(elem) ? [[...pass, elem], fail] : [pass, [...fail, elem]];
  }, [[], []]);
}

const [pass, fail] = partition(myArray, (e) => e > 5); 
```

或单行：

```
const [pass, fail] = a.reduce(([p, f], e) => (e > 5 ? [[...p, e], f] : [p, [...f, e]]), [[], []]); 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2016-04-23T09:04:31.127

您可以使用[lodash.partition](https://lodash.com/docs#partition)

```
var users = [
  { 'user': 'barney',  'age': 36, 'active': false },
  { 'user': 'fred',    'age': 40, 'active': true },
  { 'user': 'pebbles', 'age': 1,  'active': false }
];

_.partition(users, function(o) { return o.active; });
// → objects for [['fred'], ['barney', 'pebbles']]

// The `_.matches` iteratee shorthand.
_.partition(users, { 'age': 1, 'active': false });
// → objects for [['pebbles'], ['barney', 'fred']]

// The `_.matchesProperty` iteratee shorthand.
_.partition(users, ['active', false]);
// → objects for [['barney', 'pebbles'], ['fred']]

// The `_.property` iteratee shorthand.
_.partition(users, 'active');
// → objects for [['fred'], ['barney', 'pebbles']] 
```

或[ramda.partition](http://ramdajs.com/docs/#partition)

```
R.partition(R.contains('s'), ['sss', 'ttt', 'foo', 'bars']);
// => [ [ 'sss', 'bars' ],  [ 'ttt', 'foo' ] ]

R.partition(R.contains('s'), { a: 'sss', b: 'ttt', foo: 'bars' });
// => [ { a: 'sss', foo: 'bars' }, { b: 'ttt' }  ] 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2018-06-01T04:52:17.857

我想出了这个小家伙。它用于您所描述的所有内容，但在我看来它看起来干净简洁。

```
//Partition function
function partition(array, filter) {
  let pass = [], fail = [];
  array.forEach((e, idx, arr) => (filter(e, idx, arr) ? pass : fail).push(e));
  return [pass, fail];
}

//Run it with some dummy data and filter
const [lessThan5, greaterThanEqual5] = partition([0,1,4,3,5,7,9,2,4,6,8,9,0,1,2,4,6], e => e < 5);

//Output
console.log(lessThan5);
console.log(greaterThanEqual5);
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-02-17T13:28:10.003

你可以使用 reduce 来实现它：

```
function partition(array, callback){
  return array.reduce(function(result, element, i) {
    callback(element, i, array) 
      ? result[0].push(element) 
      : result[1].push(element);

        return result;
      }, [[],[]]
    );
 }; 
```

更新。使用 ES6 语法，您也可以使用递归来做到这一点（更新以避免在每次迭代时创建新数组）：

```
function partition([current, ...tail], f, left = [], right = []) {
    if(current === undefined) {
        return [left, right];
    }
    if(f(current)) {
        left.push(current);
        return partition(tail, f, left, right);
    }
    right.push(current);
    return partition(tail, f, left, right);
} 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-07-30T23:59:04.763

[这听起来与Ruby 的`Enumerable#partition`](http://www.ruby-doc.org/core-1.9.3/Enumerable.html#method-i-partition)方法非常相似。

如果函数不能产生副作用（即，它不能改变原始数组），那么没有比遍历每个元素并将元素推送到两个数组之一更有效的方法来划分数组。

话虽如此，可以说创建一个方法`Array`来执行这个功能更“优雅”。在这个例子中，过滤器函数在原始数组的上下文中执行（即，`this`将是原始数组），它接收元素和元素的索引作为参数（类似于[jQuery 的`each`方法](http://api.jquery.com/each/)）：

```
Array.prototype.partition = function (f){
  var matched = [],
      unmatched = [],
      i = 0,
      j = this.length;

  for (; i < j; i++){
    (f.call(this, this[i], i) ? matched : unmatched).push(this[i]);
  }

  return [matched, unmatched];
};

console.log([1, 2, 3, 4, 5].partition(function (n, i){
  return n % 2 == 0;
}));

//=> [ [ 2, 4 ], [ 1, 3, 5 ] ] 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-07-30T23:30:00.977

在过滤器功能中，您可以将您的错误项目推入函数外部的另一个变量中：

```
var bad = [], good = [1,2,3,4,5];
good = good.filter(function (value) { if (value === false) { bad.push(value) } else { return true}); 
```

当然`value === false`需要真实对比；）

但它执行几乎相同的操作，例如`forEach`. 我认为你应该使用`forEach`更好的代码可读性。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-11-22T15:25:51.490

那这个呢？

```
[1,4,3,5,3,2].reduce( (s, x) => { s[ x > 3 ].push(x); return s;} , {true: [], false:[]} ) 
```

可能这比扩展运算符更有效

或者更短一点，但更丑

```
[1,4,3,5,3,2].reduce( (s, x) => s[ x > 3 ].push(x)?s:s , {true: [], false:[]} ) 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2020-09-27T20:28:33.977

这里的很多答案都`Array.prototype.reduce`用于构建一个可变累加器，并且正确地指出，对于大型数组，这比使用扩展运算符在每次迭代中复制一个新数组更有效。缺点是它不如使用短 lambda 语法的“纯”表达式漂亮。

但一种解决方法是使用逗号运算符。在类 C 语言中，逗号是始终返回右手操作数的运算符。您可以使用它来创建一个调用 void 函数并返回值的表达式。

```
function partition(array, predicate) {
    return array.reduce((acc, item) => predicate(item)
        ? (acc[0].push(item), acc)
        : (acc[1].push(item), acc), [[], []]);
} 
```

如果您利用布尔表达式隐式转换为 0 和 1 的事实，您可以使其更加简洁，尽管我不认为它具有可读性：

```
function partition(array, predicate) {
    return array.reduce((acc, item) => (acc[+!predicate(item)].push(item), acc), [[], []]);
} 
```

用法：

```
const [trues, falses] = partition(['aardvark', 'cat', 'apple'], i => i.startsWith('a'));
console.log(trues); // ['aardvark', 'apple']
console.log(falses); // ['cat'] 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-02-12T15:17:01.190

一读易读。

```
const partition = (arr, condition) => {
    const trues = arr.filter(el => condition(el));
    const falses = arr.filter(el => !condition(el));
    return [trues, falses];
};

// sample usage
const nums = [1,2,3,4,5,6,7]
const [evens, odds] = partition(nums, (el) => el%2 == 0) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-07-30T23:25:48.757

尝试这个：

```
function filter(a, fun) {
    var ret = { good: [], bad: [] };
    for (var i = 0; i < a.length; i++)
        if (fun(a[i])
            ret.good.push(a[i]);
        else
            ret.bad.push(a[i]);
    return ret;
} 
```

### [演示](http://jsfiddle.net/bsdt5/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-05-03T14:17:58.633

我最终这样做了，因为它很容易理解：

```
const partition = (array, isValid) => {
  const pass = []
  const fail = []
  array.forEach(element => {
    if (isValid(element)) {
      pass.push(element)
    } else {
      fail.push(element)
    }
  })
  return [pass, fail]
}

// usage
const [pass, fail] = partition([1, 2, 3, 4, 5], (element) => element > 3) 
```

同样的方法包括打字稿的类型：

```
const partition = <T>(array: T[], isValid: (element: T) => boolean): [T[], T[]] => {
  const pass: T[] = []
  const fail: T[] = []
  array.forEach(element => {
    if (isValid(element)) {
      pass.push(element)
    } else {
      fail.push(element)
    }
  })
  return [pass, fail]
}

// usage
const [pass, fail] = partition([1, 2, 3, 4, 5], (element: number) => element > 3) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-24T05:15:14.420

## ONE-LINER 分区

```
const partitionBy = (arr, predicate) =>
    arr.reduce((acc, item) => (acc[+!predicate(item)].push(item), acc), [[], []]); 
```

**演示**

```
// to make it consistent to filter pass index and array as arguments
const partitionBy = (arr, predicate) =>
    arr.reduce(
        (acc, item, index, array) => (
            acc[+!predicate(item, index, array)].push(item), acc
        ),
        [[], []]
    );

console.log(partitionBy([1, 2, 3, 4, 5], x => x % 2 === 0));
console.log(partitionBy([..."ABCD"], (x, i) => i % 2 === 0));
```

## 对于打字稿（v4.5）

```
const partitionBy = <T>(
  arr: T[],
  predicate: (v: T, i: number, ar: T[]) => boolean
) =>
  arr.reduce(
    (acc, item, index, array) => {
      acc[+!predicate(item, index, array)].push(item);
      return acc;
    },
    [[], []] as [T[], T[]]
  ); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-15T03:54:50.877

[Lodash 分区](https://lodash.com/docs/4.17.15#partition)替代方案，与@Yaremenko Andrii 的[第一个解决方案](https://stackoverflow.com/a/42299191/9751697)相同，但语法更短

```
function partition(arr, callback) {
  return arr.reduce(
    (acc, val, i, arr) => {
      acc[callback(val, i, arr) ? 0 : 1].push(val)
      return acc
    },
    [[], []]
  )
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-26T15:38:04.717

我知道已经有多种解决方案，但我冒昧地将上述答案的最佳部分放在一起，并在 Typescript 上使用了扩展方法。复制并粘贴它就可以了：

```
declare global {

  interface Array<T> {
    partition(this: T[], predicate: (e: T) => boolean): T[][];
  }

}

if(!Array.prototype.partition){

  Array.prototype.partition = function<T>(this: T[], predicate: (e: T) => boolean): T[][] {

    return this.reduce<T[][]>(([pass, fail], elem) => {
      (predicate(elem) ? pass : fail).push(elem);
      return [pass, fail];
    }, [[], []]);

  }
} 
```

用法：

```
 const numbers = [1, 2, 3, 4, 5, 6];
const [even, odd] = numbers.partition(n => n % 2 === 0); 
```

# c# - 在 Azure 中托管 C#“服务库”

> ID：11731075
> 
> 赞同：0
> 
> 时间：2012-07-30T23:22:25.497
> 
> 标签：c#, wcf, azure

我有一个在本地正常运行的 C# WCF 服务库。本地运行的客户端能够看到服务并使用它。但是，当我尝试将服务托管在 WebRole 中并将其部署在 Azure 上时，客户端永远无法像在本地那样成功地连接到它！我这样做的方式如下：

```
// The WCF Service library is in namespace: Root.Library    
Uri url = new Uri("http://xxx.cloudapp.net:8099/DealerService"); // tried also without "DealerService" but still didn't work
ServiceHost host = new ServiceHost(typeof(Root.Library.DealerService), url));
host.AddServiceEndpoint(typeof(Root.Library.IDealerService), new WSHttpBinding(), "DealerService");

ServiceMetadataBehavior dealerMetaBehavior = new ServiceMetadataBehavior();
dealerMetaBehavior.HttpGetEnabled = true;
host.Description.Behaviors.Add(dealerMetaBehavior);

host.Open(); 
```

在 Root.Library 中，app.config：

```
<service name="Root.Library.DealerService">
    <endpoint address="" binding="wsHttpBinding" name="dealer" contract="Root.Library.IDealerService">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" name="mex" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="http://xxx.cloudapp.net:8099/" />
      </baseAddresses>
    </host>
  </service> 
```

我还在 WebRole 配置中添加了一个端点（类型：输入，协议：http，公共端口：8099）

谁能告诉我可能是什么问题？？？这真的让我很困惑！

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T05:33:21.070

您应该能够根据 csdef 文件更改端口

```
<Endpoints>
  <InputEndpoint name="Endpoint1" protocol="http" port="8888" />
</Endpoints> 
```

Saqib Ullah 在 geekswithblogs 上有一篇文章，其中显示了更多信息：[http ://geekswithblogs.net/technetbytes/archive/2011/04/25/145035.aspx](http://geekswithblogs.net/technetbytes/archive/2011/04/25/145035.aspx)

# vb.net - VB.NET - 需要实例化整数数组，如何？

> ID：11731082
> 
> 赞同：3
> 
> 时间：2012-07-30T23:23:44.513
> 
> 标签：vb.net

第一次尝试

```
Dim holdValues() As Integer 'Doesn't Work
holdValues(1) = 55 
```

第二次尝试

```
Dim holdValues(-1) As Integer 'Gives me Index was outside the bounds of the array.
holdValues(1) = 55 
```

我正在尝试做类似的事情

```
 Dim myString(-1) As String 
```

但显然这不适用于整数数组。我不知道数组的大小是多少，它不会变小，但会变大。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T00:31:55.303

您可以使用 Initializers 快捷方式：

```
Dim myValues As Integer() = New Integer() {55, 56, 67} 
```

但是，如果您想调整数组的大小等，那么一定要查看 List(Of Integer)：

```
'Initialise the list
Dim myValues As New System.Collections.Generic.List(Of Integer)

'Shortcut to pre-populate it with known values
myValues.AddRange(New Integer() {55, 56, 57})

'Add a new value, dynamically resizing the array
myValues.Add(32)

'It probably has a method do do what you want, but if you really need an array:
myValues.ToArray() 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-30T23:28:07.750

你把号码加到

```
holdValues(x) //x+1 will be size of array 
```

所以像这样

```
Dim array(2) As Integer
array(0) = 100
array(1) = 10
array(2) = 1 
```

如果需要，您可以通过这样做重新分配更大的数组。

```
ReDim array(10) as Integer 
```

当您应该使数组更大时，您必须添加代码。您还可以查看列表。列表会自动处理这个问题。

这里有一些关于列表的信息：http: [//www.dotnetperls.com/list-vbnet](http://www.dotnetperls.com/list-vbnet)

希望这可以帮助。

也是数组常识的链接[http://www.dotnetperls.com/array-vbnet](http://www.dotnetperls.com/array-vbnet)

# selenium - Selenium Remote Webdriver 疯狂的内存使用

> ID：11731091
> 
> 赞同：2
> 
> 时间：2012-07-30T23:24:49.800
> 
> 标签：selenium, python-2.7, selenium-rc, selenium-webdriver

我创建了一个小型 python 脚本来对一个小型数据库驱动站点的大约 40 页运行测试。

我正在使用 selenium 删除 webdriver 初始化与 driver = webdriver.Remote("http://localhost:4444/wd/hub", webdriver.DesiredCapabilities.HTMLUNIT)

运行需要一两分钟，当我查看系统监视器 java 占用 1.7gb 内存并且我的处理器处于 100% 时，我注意到我的笔记本电脑正在磨损。

selenium 文档模糊地提到了在停止或驱动程序会话结束时清除的日志，但我不能这样工作，这太荒谬了。

我正在使用 java -jar selenium-server-standalone-2.24.1.jar 从终端启动服务器

有谁知道我做错了什么或者这就是硒的工作原理？

谢谢。

# iphone - 搜索字典数组

> ID：11731092
> 
> 赞同：3
> 
> 时间：2012-07-30T23:24:50.353
> 
> 标签：iphone, objective-c, xcode, search, nsmutablearray

我正在制作一个显示红酒信息的 iPhone 应用程序。葡萄酒存储在一个包含字典数组的 plist 中。我正在向应用程序添加一个搜索视图控制器，为了轻松启动，我想获取“名称”键的值*包含*名称字符串（来自文本框）的葡萄酒。

它停在这里，我需要一些关于最合适的方法的建议。NSArray 类中是否有一个函数可以完成这项工作，应该引入 NSPredicate、NSUserDefaults 还是有其他选项？我已经做了一些研究，但我需要一些建议，也许需要一个例子来开始。

我将推进搜索功能，让用户包括/排除国家，获得适合这种和那种食物的葡萄酒，设置最低价格，最高价格等等。字典有所有这些信息的字符串。所以在我开始像这样高级的东西之前，我需要一些建议，哪些功能可以最好地完成我的工作。

```
-(IBAction)searchButtonPoke:(id)sender{

    NSString *path = [[NSBundle mainBundle] pathForResource:@"Wines" ofType:@"plist"];
    allObjectsArray = [[NSMutableArray alloc] initWithContentsOfFile:path];

    NSString *nameString = [NSString stringWithFormat:@"%@", [nameTextField text]];

    resultObjectsArray = /*objects where the value for the key "Name" contains
                                                                   nameString*/; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T00:05:27.080

简单地遍历数组并比较名称怎么样？

```
resultObjectsArray = [NSMutableArray array];
for(NSDictionary *wine in allObjectsArray)
{
   NSString *wineName = [wine objectForKey:@"Name"];
   NSRange range = [wineName rangeOfString:nameString options:NSCaseInsensitiveSearch];
   if(range.location != NSNotFound)
     [resultObjectsArray addObject:wine];
} 
```

Swift 版本更简单：

```
let resultObjectsArray = allObjectsArray.filter{
    ($0["Name"] as! String).range(of: nameString,
                                  options: .caseInsensitive,
                                  range: nil,
                                  locale: nil) != nil
} 
```

干杯，安卡

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-29T07:50:22.497

这有效！经测试！！！

```
for (NSDictionary* dict in Array) {

    if ([[dict objectForKey:@"key"] isEqualToString:string]) {

        Index = [Array indexOfObject:dict];
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-09T00:31:09.903

我们也可以使用 NSPredicate，如下所示：

```
NSPredicate *predicate =
  [NSPredicate predicateWithFormat:@"publisher == %@", @"Apress" ];
NSArray *filtered  = [bookshelf filteredArrayUsingPredicate:predicate]; 
```

如果可以在书架数组中找到出版商，则过滤计数将大于 0。

我认为这种方式是更清洁的搜索方式。希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-03T16:14:21.993

记得打破；找到对象后退出 for 循环

# ruby - 如何让 DateTime.now 和 DateTime.strptime 使用相同的时区？

> ID：11731099
> 
> 赞同：0
> 
> 时间：2012-07-30T23:26:12.087
> 
> 标签：ruby

如果我做：

```
1.9.3p125 :018 > DateTime.now
=> Mon, 30 Jul 2012 16:16:57 -0700 
```

时间已经-0700...

然而，如果我这样做：

```
DateTime.strptime(Time.now.to_i.to_s, "%s")
=> Mon, 30 Jul 2012 23:24:46 +0000 
```

然后是+0000 ...我如何让这些相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:48:54.673

```
DateTime.strptime(Time.now.to_i.to_s, "%s").to_time.localtime 
```

或者

```
DateTime.strptime(Time.now.to_i.to_s, "%s").change(:offset => "-0700") 
```

# java - 在 android 音板中，如何在单击另一种声音后停止播放一种声音？

> ID：11731107
> 
> 赞同：0
> 
> 时间：2012-07-30T23:27:41.510
> 
> 标签：java, android

如何修改它，以便如果一个声音已经在播放并且单击另一个声音，则前一个声音停止播放而新选择的声音开始？提前感谢大家的帮助。（这不是最重要的所有代码）

```
public class newBoard extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.main);

    Toast.makeText(this, "Thank you for using this App.", Toast.LENGTH_LONG).show();

    // ads - load request to display
    AdView layout = (AdView)this.findViewById(R.id.adView);

    // ads - load display with an ad
    AdRequest adRequest = new AdRequest();
    adRequest.setTesting(true);

    layout.loadAd(adRequest);

    // import sound files
    final MediaPlayer sound01 = MediaPlayer.create(this, R.raw.sound01);
    final MediaPlayer sound02 = MediaPlayer.create(this, R.raw.sound02);
    final MediaPlayer sound03 = MediaPlayer.create(this, R.raw.sound03);
    final MediaPlayer sound04 = MediaPlayer.create(this, R.raw.sound04);
    final MediaPlayer sound05 = MediaPlayer.create(this, R.raw.sound05);
    final MediaPlayer sound06 = MediaPlayer.create(this, R.raw.sound06);
    final MediaPlayer sound07 = MediaPlayer.create(this, R.raw.sound07);
    final MediaPlayer sound08 = MediaPlayer.create(this, R.raw.sound08);
    final MediaPlayer sound09 = MediaPlayer.create(this, R.raw.sound09);
    final MediaPlayer sound10 = MediaPlayer.create(this, R.raw.sound10);
    final MediaPlayer sound11 = MediaPlayer.create(this, R.raw.sound11);
    final MediaPlayer sound12 = MediaPlayer.create(this, R.raw.sound12);
    final MediaPlayer sound13 = MediaPlayer.create(this, R.raw.sound13);
    final MediaPlayer sound14 = MediaPlayer.create(this, R.raw.sound14);
    final MediaPlayer sound15 = MediaPlayer.create(this, R.raw.sound15);
    final MediaPlayer sound16 = MediaPlayer.create(this, R.raw.sound16);
    final MediaPlayer sound17 = MediaPlayer.create(this, R.raw.sound17);
    final MediaPlayer sound18 = MediaPlayer.create(this, R.raw.sound18);
    final MediaPlayer sound19 = MediaPlayer.create(this, R.raw.sound19);
    final MediaPlayer sound20 = MediaPlayer.create(this, R.raw.sound20);
    final MediaPlayer sound21 = MediaPlayer.create(this, R.raw.sound21);
    final MediaPlayer sound22 = MediaPlayer.create(this, R.raw.sound22);
    final MediaPlayer sound23 = MediaPlayer.create(this, R.raw.sound23);
    final MediaPlayer sound24 = MediaPlayer.create(this, R.raw.sound24);
    final MediaPlayer sound25 = MediaPlayer.create(this, R.raw.sound25);

    // play sound files on clicks
    Button s01 = (Button) findViewById(R.id.button01); 
    s01.setText(this.getString(R.string.quote01));
    s01.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            try {
                sound01.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            sound01.start();                
            }

    });
    registerForContextMenu(s01);

    Button s02 = (Button) findViewById(R.id.button02); 
    s02.setText(this.getString(R.string.quote02));
    s02.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            try {
                sound02.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            sound02.start();
        }
    });
    registerForContextMenu(s02);

    Button s03 = (Button) findViewById(R.id.button03); 
    s03.setText(this.getString(R.string.quote03));
    s03.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            try {
                sound03.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            sound03.start();
        }
    });
    registerForContextMenu(s03);

    Button s04 = (Button) findViewById(R.id.button04); 
    s04.setText(this.getString(R.string.quote04));
    s04.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            try {
                sound04.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            sound04.start();
        }
    });
    registerForContextMenu(s04);

    Button s05 = (Button) findViewById(R.id.button05); 
    s05.setText(this.getString(R.string.quote05));
    s05.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            try {
                sound05.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            sound05.start();
        }
    });
    registerForContextMenu(s05);

    Button s06 = (Button) findViewById(R.id.button06); 
    s06.setText(this.getString(R.string.quote06));
    s06.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            try {
                sound06.prepare();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            sound06.start();
        }
    });
    registerForContextMenu(s06); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:41:44.793

Use a object member variable to hold on to your currently playing sound so that you can call `stop()` and don't forget to null check it. Don't forget to `release()` your `MediaPlayer` object once you leave your activity.

The following is probably a better design: move all your audio files to your assets directory and put the file name in the button's tag, use the same click event handler to get the state of the one MediaPlayer object, stop it if its currently playing, set the new file to play from the button's tag and play the file. This will reduce your duplicate code significantly.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T00:13:33.390

使用单个`MediaPlayer`实例。您的设备在大多数设备上都会失败，因为无论如何分配给`MediaPlayer`. 此外，重复的代码也很糟糕。坏坏：

```
public class NewBoard extends Activity {
    private MediaPlayer player;
    private Resources res;

    private int buttonIds = { R.id.button01, R.id.button02, R.id.button03,
                              R.id.button04, R.id.button05, R.id.button06,
                              R.id.button07, R.id.button08, R.id.button09,
                              R.id.button10, R.id.button11, R.id.button12,
                              R.id.button13, R.id.button14, R.id.button15,
                              R.id.button16, R.id.button16, R.id.button17,
                              R.id.button18, R.id.button19, R.id.button20,
                              R.id.button21, R.id.button22, R.id.button23,
                              R.id.button24, R.id.button25 };

    private int soundIds =  { R.raw.sound01, R.raw.sound02, R.raw.sound03,
                              R.raw.sound04, R.raw.sound05, R.raw.sound06,
                              R.raw.sound07, R.raw.sound08, R.raw.sound09,
                              R.raw.sound10, R.raw.sound11, R.raw.sound12,
                              R.raw.sound13, R.raw.sound14, R.raw.sound15,
                              R.raw.sound16, R.raw.sound16, R.raw.sound17,
                              R.raw.sound18, R.raw.sound19, R.raw.sound20,
                              R.raw.sound21, R.raw.sound22, R.raw.sound23,
                              R.raw.sound24, R.raw.sound25 };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.main);

        //Kill this with fire -- just an unnecessary user annoyance.
        Toast.makeText(this, 
            "Thank you for using this App.", Toast.LENGTH_LONG).show();

        AdView layout = (AdView)findViewById(R.id.adView);
        AdRequest adRequest = new AdRequest();
        adRequest.setTesting(true);
        layout.loadAd(adRequest);

        player = new MediaPlayer();
        res = getResources();

        for(int i = 0, n = buttonIds.length(); i < n; i++) {
            Button button = (Button)findViewById(buttonIds[i]);
            button.setOnClickListener(new SoundClickListener(soundIds[i]));
        }
    }

    private class SoundClickListener implements OnClickListener {
        private int id;

        public SoundClickListener(int soundId) {
            id = soundId;
        }

        public void onClick(View v) {
            player.reset();
            player.setDataSource(
                res.openRawResourceFd(id).getFileDescriptor());
            player.prepare();
            player.start();
        }
    }
} 
```

像这样的东西。可能会也可能不会按原样编译。此外，正如评论的那样，`Toast`用火杀死 - 这很烦人。

# tcp - TCP connection: received array's size is unexpectedly huge

> ID：11731110
> 
> 赞同：0
> 
> 时间：2012-07-30T23:27:52.107
> 
> 标签：tcp, tcpclient

I'm sending multiple byte arrays with size <500 over TCP. However, on the client side, I sometimes receive arrays with size >2000\. Why is this happening?

Below is my code for TCPClient:

```
 byte[] receiveData = new byte[64000];            
       DataInputStream input = new DataInputStream(socket.getInputStream());
       int size = input.read(receiveData);
       byte[] receiveDataNew = new byte[size];
       System.arraycopy(receiveData,0,receiveDataNew,0,size);
       System.out.println("length of receiveData is " + size);
       GenericRecord result = AvroByteReader.readAvroBytes(receiveDataNew);
       return result; 
```

Any help is appreciated! Thank you!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:30:53.670

TCP does not have any concept of message boundaries, since it is a *stream* protocol. It can (and will) merge multiple sends into a single receive, and even the opposite - split a send into multiple smaller receives.

Your application must be prepared for this.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:31:14.913

TCP is not a record oriented protocol. It is stream oriented. That means that packets can be recombined before receiving on the other side. Likely, this means you have received 3 or 4 sets of data arrays, and are processing them all at once.

If you wish to use it as a record-oriented or framed protocol, you'll have to add that framing yourself. You could prepend a size to the data you send, and only read that much data at a time.

If your records are always the same length, you can do a fixed-length read. I don't know Java's libraries, but you should be able to provide a length to read().

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T23:33:17.810

Basically what you are seeing is multiple arrays combined back to back being received at the same time. Send the array length before the array and read that many bytes.

# c# - 文件流未完成写入文件

> ID：11731112
> 
> 赞同：4
> 
> 时间：2012-07-30T23:27:58.670
> 
> 标签：c#, text-files, streamreader, streamwriter

该程序所做的是转到网页，逐行读取源代码，剥离 html 标签/代码，然后将实际文本/信息写入文本文件。因为我希望文本文件只包含我想要的数据/信息而没有其他内容，所以我让它寻找一个特定的字符串，告诉它它找到了正确的部分，因此它可以开始写入文本文件，然后它寻找另一个字符串知道何时找到该部分的末尾。它在文件中的正确行正确启动和停止（我放入了一个计数器以确保它在正确的位置正确停止/启动），但是，它没有完成将所有信息写入文本文件. 它甚至不会在特定行的末尾停止——它通常会在一行的中间停止写入。例如，如果我希望它读取 4 行，

第 1 行的文本.. 第 2 行的文本.. li 的文本

并且停止，即使它应该读/写 4 行。

下面是我的代码：

```
private void button1_Click(object sender, EventArgs e)
{

    string tempString = "";
    string startString = "start string";
    string endString = "end string";
    bool startFlag = false;
    bool endFlag = true;
    string filename = @"C:\file.txt";

    System.IO.StreamWriter file = new System.IO.StreamWriter(filename);

    WebRequest request = WebRequest.Create("http://www.website.com/webpage.html");
    request.Credentials = CredentialCache.DefaultCredentials;
    HttpWebResponse response = (HttpWebResponse)request.GetResponse();
    Console.WriteLine(response.StatusDescription);
    Stream dataStream = response.GetResponseStream();
    StreamReader reader = new StreamReader(dataStream);

    while (endFlag)
    {
        tempString = reader.ReadLine();

        if (tempString.Contains(startString))
        {
            startFlag = true;
        }

        if (tempString.Contains("text"))
        {
            ...
        }

        if (tempString.Contains("other text"))
        {
            if (startFlag)
                file.WriteLine(tempString.Trim());
        }

        if (tempString.Contains("different text"))
        {
                if (startFlag && tempString.Length > 0)
                    file.WriteLine(tempString.Trim());
        }

        if (tempString.Contains(endString))
        {
            endFlag = false;
        }
    }

    MessageBox.Show("Done!", "Finished Writing", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);

    reader.Close();
    dataStream.Close();
    response.Close();

    Process.Start(filename);

    this.Close();
} 
```

我已经尝试了几乎所有我能想到的东西，我尝试过使用刷新，我尝试过让它继续读/写超过表示该部分结束的字符串，但似乎没有任何效果。我知道我无论如何都不是最伟大的程序员，但我真的很难过。任何人都可以分享一些见解吗？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:38:16.227

You have to Flush() your file ... Or use

```
using( System.IO.StreamWriter file = new System.IO.StreamWriter(filename)){
   ....
}
Process.Start(filename); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:38:28.860

Your `StreamWriter file` is not closed or flushed before you call Start on the file name.

Either Close or Dispose `file` object. Or even better wrap it in `using`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:27:22.693

```
private void button1_Click(object sender, EventArgs e)
{

    string tempString = "";
    string startString = "start string";
    string endString = "end string";
    bool startFlag = false;
    bool endFlag = true;
    string filename = @"C:\file.txt";

    using (System.IO.StreamWriter file = new System.IO.StreamWriter(filename))
    {
        WebRequest request = WebRequest.Create("http://www.website.com/webpage.html");
        request.Credentials = CredentialCache.DefaultCredentials;
        using (HttpWebResponse response = (HttpWebResponse) request.GetResponse())
        {
            Console.WriteLine(response.StatusDescription);
            using (Stream dataStream = response.GetResponseStream())
            {
                using (StreamReader reader = new StreamReader(dataStream))
                {
                    while (endFlag)
                    {
                        tempString = reader.ReadLine();

                        if (tempString.Contains(startString))
                        {
                            startFlag = true;
                        }

                        if (tempString.Contains("text"))
                        {
                            // ...
                        }

                        if (tempString.Contains("other text"))
                        {
                            if (startFlag)
                                file.WriteLine(tempString.Trim());
                        }

                        if (tempString.Contains("different text"))
                        {
                            if (startFlag && tempString.Length > 0)
                                file.WriteLine(tempString.Trim());
                        }

                        if (tempString.Contains(endString))
                        {
                            endFlag = false;
                        }
                    }

                    MessageBox.Show("Done!", "Finished Writing", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);

                    reader.Close();
                }
                dataStream.Close();
            }
            response.Close();
        }
    }

    Process.Start(filename);

    this.Close();
} 
```

# perl - 无法在 perl 中拆分字符串 - 不匹配 ( 在正则表达式中；标记为 (-- 在 m/ 中错误

> ID：11731114
> 
> 赞同：1
> 
> 时间：2012-07-30T23:28:10.573
> 
> 标签：perl, split

以下是我的代码

```
$var = '            "jjjjjjjj&Q_30006_47=540IT%20(540%2FOR%2FHPSC%2FD%2F02%2F11&Q_30006_4=&Q_30006_6=12&Q_30006_7=&Q_30006_" &';

($temp1,$temp2) = split($var,"&");

print $temp1; 
```

我需要得到 $temp1 = "jjjjjjjj 和 $temp2 作为第一个 & 之后字符串的剩余部分。

由于字符串中的“（”，我收到错误消息。

任何人都可以请建议如何拆分它。谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T23:37:07.480

我认为您的参数命令错误。模式应该是第一个：

```
($temp1,$temp2) = split("&", $var); 
```

但是，这将在所有`&`字符上分开。您可能正在寻找这个（2 是限制）：

```
($temp1,$temp2) = split("&", $var, 2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:39:00.553

```
($temp1,$temp2) = split '&', $var, 2; 
```

# javascript - jslint 停在 $(document).ready 行

> ID：11731115
> 
> 赞同：1
> 
> 时间：2012-07-30T23:28:14.463
> 
> 标签：javascript, jquery, jslint

我遇到了 JSLint 的问题，它提供了一个难以理解的错误：

我正在尝试分析以下结构的代码：

```
<script type="text/javascript">
    var MyGlobalObj = MyGlobalObj || {}; //used for creating namespace security

    MyGlobalObj.MyFunction = function () {
        //valid javascript
    }

    $(document).ready(function () {
        //Stuff I want analyzed
    });
</script> 
```

我在我的代码中混合使用了 javascript 和 jQuery。然而，JSLint 声称，根据准备好的操作，即：

```
Unexpected '$'.
        $(document).ready(function() { 
```

对不起，但是……什么？为什么会出乎意料？什么是“正确”的实现？

```
Options I am using:
    /*jslint white: true, browser: true, devel: true */
Entry in the predef box:
    $ 
```

注意：在其他地方，我根据需要声明 $(variable) 没有问题。就这么一行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T18:42:12.873

这是该代码的 JSLint 验证版本。

1.  添加分号
2.  使用严格

    /*全局$，文档*/

    “使用严格”；

    var MyGlobalObj = MyGlobalObj || {}; //用于创建命名空间安全

    MyGlobalObj.MyFunction = function () { // 有效的 javascript };

    $(document).ready(function () { // 我要分析的东西 });

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T17:09:36.867

发生 JSLint 优先级的意外冲突以产生此错误。

根据关于分号的 JSLint 文档：

> JSLint 期望每个语句后跟`;`除了 `for`, `function`, `if`, `switch`, `try`, 和`while`。JSLint 不希望看到不必要的分号或空语句。

为了提供命名空间保护，我根据此处的教程实现了命名空间：

[http://elegantcode.com/2011/01/26/basic-javascript-part-8-namespaces/](http://elegantcode.com/2011/01/26/basic-javascript-part-8-namespaces/)

但是，当将新变量分配给命名对象时，JSLint（显然是标准约定）认为代码

```
Obj.Method = function (TheArgs) { /*do stuff*/ }; 
```

后面应该跟一个分号，不管函数关键字的使用。这源于赋值运算符对分号的要求，以取代函数关键字省略分号。

感谢 Felix Kling 指出“意外”表示意外行之前的代码没有正确结束。

# javascript - Twitter Bootstrap 的高级表单库

> ID：11731118
> 
> 赞同：0
> 
> 时间：2012-07-30T23:28:58.020
> 
> 标签：javascript, forms, twitter-bootstrap

有一个 Twitter Bootstrap 表单库，我找不到，但我以前看过。

它为下拉菜单提供了详细的标记和工具提示类型功能。

下拉列表中的所有数据都是国名。因此，如果这敲响了警钟，请告诉我图书馆的名称！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:41:24.873

Maybe what you are looking for is Chosen? Give a look at [harvesthq page on github](http://harvesthq.github.com/chosen/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T16:30:33.133

也许是 Select2：

> Select2 是一个基于 jQuery 的选择框替代品。它支持搜索、远程​​数据集和无限滚动结果。Select2 的外观基于出色的 Chosen 库。

[http://ivaynberg.github.com/select2/](http://ivaynberg.github.com/select2/)

# ruby - ruby-prof 说 Ruby 增量运算符 (+=) 需要 25 秒

> ID：11731119
> 
> 赞同：-1
> 
> 时间：2012-07-30T23:29:04.960
> 
> 标签：ruby, performance, ruby-prof

我正在尝试分析我使用`ruby-prof`gem 编写的一些 Ruby 代码，并看到基本操作`i += 1`（如下`Fixnum#+`表所示）需要超过 24 秒才能运行（在此特定测试中，该操作执行了 2,199,978 次）。这是正常的吗？

```
Thread 582936

%Total   %Self   Total   Self  Wait  Child       Calls              Name

                 203.93  81.72   0.00  122.21    100001/100001    InputFile#parse
46.96%   18.82%  203.93  81.72   0.00  122.21    100001           InputFile#split_on_semicolon
                  24.59  24.59   0.00    0.00   2199978/3200094   Fixnum#+
                  16.02  16.02   0.00    0.00    100001/399998    String#split
                  14.72  14.72   0.00    0.00    999990/999991    String#[]
                  13.12  13.12   0.00    0.00   1199988/1199990   Fixnum#<
                  10.97  10.97   0.00    0.00    999990/2239978   String#empty?
                  10.49  10.49   0.00    0.00   1199988/1199988   String#<<
                   9.75   9.75   0.00    0.00   1199988/1200074   Array#[]
                   7.77   7.77   0.00    0.00    999990/999990    String#eql?
                   6.76   6.76   0.00    0.00    599994/599994    Fixnum#-
                   4.62   4.62   0.00    0.00    599994/599994    Array#delete_at
                   1.25   1.25   0.00    0.00    100001/1339989   Kernel#nil?
                   1.14   1.14   0.00    0.00    100001/300003    Array#size
                   1.01   1.01   0.00    0.00    100001/300002    Fixnum#> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:48:16.087

你的结果不说`+=`需要 25 秒。他们说 2199978 次调用`+`需要 24.59 秒，即每毫秒 89.5 次调用。这有点慢，但可能只是因为它正在被分析。我看不出有什么不寻常的地方。

# date - 来自 Text 的 MakeInstant 不起作用 - MakeInstant 的参数应该有不同的形式

> ID：11731123
> 
> 赞同：1
> 
> 时间：2012-07-30T23:29:22.717
> 
> 标签：date, app-inventor

我一直在玩 MIT AppInventor 并试图计算两个日期之间的持续时间。

我从两个文本字段中获取日期值。Clock.MakeInstant 说它只能接受 MM/DD/YYYY 格式的日期，所以我很小心地这样做了。尽管如此，当我尝试将它们输入 MakeInstant 时，它总是会弹出相同的消息，即只能接受 MM/DD/YYYY hh:mm:ss 或 MM/DD/YYYY 或 hh:mm。我在将输入的文本值传递给 MakeInstant 之前打印了它们以确认它们没有以某种方式损坏并且它们很好——每个都只是 MM/DD/YYYY 格式的日期。

[![代码](../Images/d1d68019cd1a6cd7219f4c21f8d5568e.png)](https://i.stack.imgur.com/1WQOY.png) [![错误](../Images/6b71de444cbf549d4bdb988317bea9cb.png)](https://i.stack.imgur.com/o9Uxw.png)

我不知道还能尝试什么。据我所知，我遵循了信中的指示。有关如何将日期作为文本传递给 Clock.MakeInstant 的任何示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T15:13:59.047

看到这个截图![计算日期之间的天数](../Images/385a74bec52592810f578ee4d01e7b32.png)来源：[https:](https://groups.google.com/d/topic/app-inventor-shared-utilities-repository/3bA4wczU9pU/discussion) //groups.google.com/d/topic/app-inventor-shared-utilities-repository/3bA4wczU9pU/discussion Taifun

# c# - 如何通过单击按钮触发验证

> ID：11731125
> 
> 赞同：0
> 
> 时间：2012-07-30T23:29:33.163
> 
> 标签：c#, wpf, data-binding, textbox

在实例化我的程序时，我有一个文本框，它周围已经有一个红色边框，表示验证已经被触发。我只想在用户在文本框中输入内容后触发验证。这适用于我的其他文本框，我只是想知道这是否只是因为绑定模式是 OneWayToSource 而发生的，如果是这样，我如何能够将此行为更改为我的其他文本框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:43:16.883

I presume you are using WPF? If so your object needs to implement IDataErrorInfo. You can then tell the textbox when it should show the error. eg:

```
 string System.ComponentModel.IDataErrorInfo.this[string columnName]
    {
        get
        {
            switch (columnName.ToLower())
            {
                case "code":
                    if (string.IsNullOrWhiteSpace(this.Code)) return "Required field";
                    break;
                case "name":
                    if (string.IsNullOrWhiteSpace(this.Name)) return "Required field";
                    break;
            }
            return null;
        }
    } 
```

# dart - 字符的人类可读键名

> ID：11731126
> 
> 赞同：1
> 
> 时间：2012-07-30T23:29:57.180
> 
> 标签：dart

如果按下“A”键，我想触发一些代码：

```
document.on.keyDown.add((event) { 
    if (event.keyIdentifier == 'U+0041') {
       ...
    }
}); 
```

使用字符的 unicode 代码 ( `U+0041`) 不是很可读。有什么方法可以将代码转换为字符，反之亦然？我想做这样的事情：

```
document.on.keyDown.add((event) { 
    if (event.keyIdentifier == unicodeCode('A')) {
       ...
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T07:36:58.180

我希望这个能帮上忙：

```
 document.on.keyPress.add((KeyboardEvent event) {
    final String char = new String.fromCharCodes([event.charCode]);
    print('Key: $char');

    if (event.keyIdentifier == 'U+0041') {
      print('$char pressed.');
    }

    if (char == 'a') {
      print('Lowercase "a" has been pressed.');
    }
  }); 
```

目前该`keyDown`事件不提供适当的*charCodes*。

# jasper-reports - JasperReports：在子报告中找不到图像

> ID：11731129
> 
> 赞同：0
> 
> 时间：2012-07-30T23:30:01.743
> 
> 标签：jasper-reports, ireport

我在报告中放置了一个复选框图像一切正常，但是当它在子报告中时，我收到错误：

```
net.sf.jasperreports.engine.JRException: Byte data not found 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T05:46:40.023

因为如果子报表无法获取图像组件的值。如果给图像的字段或参数字段赋值，则此错误将消失。

# mysql - 三查询比一查询快——我的联接有什么问题？

> ID：11731130
> 
> 赞同：2
> 
> 时间：2012-07-30T23:30:07.520
> 
> 标签：mysql, join

我已经建立了一个 JPA ManyToMany 关系，它为我提供了三个重要的表：我的 Ticket 表、我的 Join 表和我的 Inventory 表。它们是 MySQL 5.1 上的 InnoDB 表。相关位是：

```
Ticket:
+--------+----------+------+-----+---------+----------------+
| Field  | Type     | Null | Key | Default | Extra          |
+--------+----------+------+-----+---------+----------------+
| ID     | int(11)  | NO   | PRI | NULL    | auto_increment |
| Status | longtext | YES  |     | NULL    |                |
+--------+----------+------+-----+---------+----------------+

JoinTable:
+-------------+---------+------+-----+---------+-------+
| Field       | Type    | Null | Key | Default | Extra |
+-------------+---------+------+-----+---------+-------+
| InventoryID | int(11) | NO   | PRI | NULL    |       | Foreign Key - Inventory
| TicketID    | int(11) | NO   | PRI | NULL    |       | Foreign Key - Ticket
+-------------+---------+------+-----+---------+-------+

Inventory:
+--------------+--------------+------+-----+---------+----------------+
| Field        | Type         | Null | Key | Default | Extra          |
+--------------+--------------+------+-----+---------+----------------+
| ID           | int(11)      | NO   | PRI | NULL    | auto_increment |
| TStampString | varchar(32)  | NO   | MUL | NULL    |                |
+--------------+--------------+------+-----+---------+----------------+ 
```

TStampString 的格式为“yyyy.mm.dd HH:MM:SS Z”（例如，“2010.03.19 22:27:57 GMT”）。现在所有创建的门票都直接对应于某个特定时间的 TStampString，所以这`SELECT COUNT(*) FROM Ticket;`与`SELECT COUNT(DISTINCT(SUBSTRING(TStampString, 1, 13))) FROM Inventory;`

我想做的是根据 TStampString 的微小粒度重新组合某些票证：(SUBSTRING(TStampString, 1, 16))。因此，我正在分析和测试 INSERT INTO ... SELECT 语句的 SELECT：

```
EXPLAIN SELECT SUBSTRING(i.TStampString, 1, 16) FROM Ticket t JOIN JoinTable j
ON t.ID = j.TicketID JOIN Inventory i ON j.InventoryID = i.ID WHERE t.Status
= 'Regroup' GROUP BY SUBSTRING(i.TStampString, 1, 16);

+--+------+---+--------+-------------+-----+-----+----------+-------+-----------+
|id| type |tbl| type   | psbl_keys   | key | len | ref      | rows  | Extra     |
+--+------+---+--------+-------------+-----+-----+----------+-------+-----------+
|1 | SMPL | t | ALL    | PRI         | NULL| NULL| NULL     | 35569 | where     |
|  |      |   |        |             |     |     |          |       | +temporary|
|  |      |   |        |             |     |     |          |       | +filesort |
|1 | SMPL | j | ref    | PRI,FK1,FK2 | FK2 | 4   | t.ID     |   378 | index     |
|1 | SMPL | i | eq_ref | PRI         | PRI | 4   | j.Invent |     1 |           |
|  |      |   |        |             |     |     |    oryID |       |           |
+--+------+---+--------+-------------+-----+-----+----------+-------+-----------+ 
```

这对我来说意味着对于 Ticket 中的每一行，MySQL 首先进行连接，然后由于 WHERE 子句而决定该行无效。当然运行时间很糟糕（我在 30 分钟后放弃了）。请注意，将 t.Status = 'Regroup' 移到第一个 JOIN 子句并且没有 WHERE 子句时，它不会更快。

但有趣的是，如果我分三步手动运行这个查询，做我认为优化器会做的事情，每一步几乎都会立即返回：

```
--Step 1: Select relevant Tickets (results dumped to file)
SELECT ID FROM Ticket WHERE Status = 'Regroup';

--Step 2: Get relevant Inventory entries
SELECT InventoryID FROM JoinTable WHERE TicketID IN (step 1s file);

--Step 3: Select what I wanted all along
SELECT SUBSTRING(TStampString, 1, 16) FROM Inventory WHERE ID IN (step 2s file)
GROUP BY SUBSTRING(TStampString, 1, 16); 
```

在我的特定表上，第一个查询给出 154 个结果，第二个查询创建 206,598 行，第三个查询返回 9198 行。所有这些都需要大约 2 分钟才能运行，最后一个查询具有唯一重要的运行时间。

将中间结果转储到文件中很麻烦，更重要的是我想知道如何编写我的原始查询以使其合理运行。那么如何构建这个三表连接，使其运行速度尽可能快呢？

**更新**：我在 Status(16) 上添加了一个前缀索引，它将我的 EXPLAIN 配置文件行分别更改为 153、378 和 1（因为第一行有一个要使用的键）。我的查询的 JOIN 版本现在需要大约 6 分钟，这是可以容忍的，但仍然比手动版本慢得多。我仍然想知道为什么连接执行得非常糟糕，但可能是无法在有缺陷的 MySQL 5.1 中创建独立的子查询。如果有足够的时间过去，我会接受 Add Index 作为我的问题的解决方案，尽管它不完全是我问题的答案。

最后，我确实最终在磁盘上手动重新创建了连接的每个步骤。数以万计的文件每个都有一千个查询，这仍然比我可以让我的 MySQL 版本执行的任何操作都要快得多。但是由于该过程对于外行来说非常具体且无益，因此我接受了 ypercube 对添加（部分）索引的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:53:32.517

您可以做些什么来加快查询速度：

*   在 上添加索引`Status`。即使您不将类型更改为`VARCHAR`，您仍然可以添加部分索引：

    ```
    ALTER TABLE Ticket
      ADD INDEX status_idx
        Status(16) ; 
    ```

*   我假设 Join 表的主键是`(InventoryID, TicketID)`. 您也可以添加另一个索引`(TicketID, InventoryID)`。这可能不会有利于这个特定的查询，但它会在您遇到的其他查询中有所帮助。

为什么会发生这种情况的答案是优化器并不总是选择最佳计划。您可以尝试查询的这种变体，看看`EXPLAIN`计划有何不同，以及是否有任何效率提升：

```
SELECT SUBSTRING(i.TStampString, 1, 16) 
FROM 
    ( SELECT (DISTINCT) j.InventoryID 
      FROM Ticket t 
        JOIN JoinTable j
          ON t.ID = j.TicketID 
      WHERE t.Status = 'Regroup' 
    ) AS tmp
  JOIN Inventory i 
    ON tmp.InventoryID = i.ID
GROUP BY SUBSTRING(i.TStampString, 1, 16) ; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-30T23:36:13.550

尝试给第一个 substring-clause 一个别名并在 group-by 中使用它。

```
SELECT SUBSTRING(i.TStampString, 1, 16) as blaa FROM Ticket t JOIN JoinTable j
ON t.ID = j.TicketID JOIN Inventory i ON j.InventoryID = i.ID WHERE t.Status
= 'Regroup' GROUP BY blaa; 
```

也完全避免加入，因为你不需要它..

```
SELECT distinct(SUBSTRING(i.TStampString, 1,16)) from inventory i where i.ID in 
 ( select id from JoinTable j where j.TicketID in 
    (select id from Ticket t where t.Status = 'Regroup')); 
```

那行得通吗？

顺便提一句。您在状态字段上有索引吗？

# python - 带有自参数的类方法装饰器？

> ID：11731136
> 
> 赞同：241
> 
> 时间：2012-07-30T23:30:39.387
> 
> 标签：python, python-decorators

如何将类字段作为参数传递给类方法上的装饰器？我想做的是：

```
class Client(object):
    def __init__(self, url):
        self.url = url

    @check_authorization("some_attr", self.url)
    def get(self):
        do_work() 
```

它抱怨 self 不存在传递`self.url`给装饰器。有没有解决的办法？

* * *

## 回答 #1

> 赞同：296
> 
> 时间：2012-07-30T23:38:53.667

是的。不要在类定义时传入实例属性，而是在运行时检查它：

```
def check_authorization(f):
    def wrapper(*args):
        print args[0].url
        return f(*args)
    return wrapper

class Client(object):
    def __init__(self, url):
        self.url = url

    @check_authorization
    def get(self):
        print 'get'

>>> Client('http://www.google.com').get()
http://www.google.com
get 
```

装饰器拦截方法参数；第一个参数是实例，因此它从中读取属性。您可以将属性名称作为字符串传递给装饰器，`getattr`如果您不想硬编码属性名称，请使用：

```
def check_authorization(attribute):
    def _check_authorization(f):
        def wrapper(self, *args):
            print getattr(self, attribute)
            return f(self, *args)
        return wrapper
    return _check_authorization 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2016-04-29T18:13:02.693

一个更简洁的例子可能如下：

```
#/usr/bin/env python3
from functools import wraps

def wrapper(method):
    @wraps(method)
    def _impl(self, *method_args, **method_kwargs):
        method_output = method(self, *method_args, **method_kwargs)
        return method_output + "!"
    return _impl

class Foo:
    @wrapper
    def bar(self, word):
        return word

f = Foo()
result = f.bar("kitty")
print(result) 
```

这将打印：

```
kitty! 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-05-03T11:52:45.760

```
from re import search
from functools import wraps

def is_match(_lambda, pattern):
    def wrapper(f):
        @wraps(f)
        def wrapped(self, *f_args, **f_kwargs):
            if callable(_lambda) and search(pattern, (_lambda(self) or '')): 
                f(self, *f_args, **f_kwargs)
        return wrapped
    return wrapper

class MyTest(object):

    def __init__(self):
        self.name = 'foo'
        self.surname = 'bar'

    @is_match(lambda x: x.name, 'foo')
    @is_match(lambda x: x.surname, 'foo')
    def my_rule(self):
        print 'my_rule : ok'

    @is_match(lambda x: x.name, 'foo')
    @is_match(lambda x: x.surname, 'bar')
    def my_rule2(self):
        print 'my_rule2 : ok'

test = MyTest()
test.my_rule()
test.my_rule2() 
```

> 输出：my_rule2：好的

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-05-27T09:10:16.697

另一种选择是放弃语法糖并在`__init__`类中进行装饰。

```
def countdown(number):
    def countdown_decorator(func):
        def func_wrapper():
            for index in reversed(range(1, number+1)):
                print(index)
            func()
        return func_wrapper
    return countdown_decorator

class MySuperClass():
    def __init__(self, number):
        self.number = number
        self.do_thing = countdown(number)(self.do_thing)

    def do_thing(self):
        print('im doing stuff!')

myclass = MySuperClass(3)

myclass.do_thing() 
```

这将打印

```
3
2
1
im doing stuff! 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2021-04-29T20:59:37.490

我知道这个问题已经很老了，但是之前没有提出过以下解决方法。这里的问题是你不能`self`在类块中访问，但你可以在类方法中访问。

让我们创建一个虚拟装饰器来重复一个函数。

```
import functools
def repeat(num_rep):
    def decorator_repeat(func):
        @functools.wraps(func)
        def wrapper_repeat(*args, **kwargs):
            for _ in range(num_rep):
                value = func(*args, **kwargs)
            return 
        return wrapper_repeat
    return decorator_repeat 
```

```
class A:
    def __init__(self, times, name):
        self.times = times
        self.name = name

    def get_name(self):
        @repeat(num_rep=self.times)
        def _get_name():
            print(f'Hi {self.name}')
        _get_name() 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-07-30T23:38:03.113

你不能。类体中没有`self`，因为不存在实例。您需要传递它，例如，`str`包含要在实例上查找的属性名称，然后返回的函数可以执行此操作，或者完全使用不同的方法。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2021-02-04T14:04:08.177

我知道这是一个老问题，但是这个解决方案还没有被提及，希望它甚至可以在 8 年后的今天对某人有所帮助。

那么，**包装一个包装器**呢？让我们假设不能[更改装饰器，](https://stackoverflow.com/a/11731208/8528002)也不能在[**init**](https://stackoverflow.com/a/56322968/8528002)[中装饰这些方法](https://stackoverflow.com/a/56322968/8528002)**（它们可能是 @property 装饰的或其他）。总是有可能创建自定义的，特定于类的装饰器，它将捕获自我并随后调用原始装饰器，将运行时属性传递给它。**

 **这是一个工作示例（[f-strings 需要 python 3.6](https://docs.python.org/3/whatsnew/3.6.html#whatsnew36-pep498)）：

```
import functools

# imagine this is at some different place and cannot be changed
def check_authorization(some_attr, url):
        def decorator(func):
                @functools.wraps(func)
                def wrapper(*args, **kwargs):
                        print(f"checking authorization for '{url}'...")
                        return func(*args, **kwargs)
                return wrapper
        return decorator

# another dummy function to make the example work
def do_work():
        print("work is done...")

###################
# wrapped wrapper #
###################
def custom_check_authorization(some_attr):
        def decorator(func):
                # assuming this will be used only on this particular class
                @functools.wraps(func)
                def wrapper(self, *args, **kwargs):
                        # get url
                        url = self.url
                        # decorate function with original decorator, pass url
                        return check_authorization(some_attr, url)(func)(self, *args, **kwargs)
                return wrapper
        return decorator

#############################
# original example, updated #
#############################
class Client(object):
        def __init__(self, url):
                self.url = url

        @custom_check_authorization("some_attr")
        def get(self):
                do_work()

# create object
client = Client(r"https://stackoverflow.com/questions/11731136/class-method-decorator-with-self-arguments")

# call decorated function
client.get() 
```

输出：

```
checking authorisation for 'https://stackoverflow.com/questions/11731136/class-method-decorator-with-self-arguments'...
work is done... 
```**

# php - 在 CodeIgniter 中设置常规表单验证错误

> ID：11731147
> 
> 赞同：2
> 
> 时间：2012-07-30T23:32:02.560
> 
> 标签：php, validation, authentication, codeigniter

假设我在 CodeIgniter 中有一个登录表单——我可以为各个输入设置验证规则，但是有没有办法抛出模型/控制器级别的错误和消息？

具体来说，如果下面的方法没有返回 TRUE，我希望我的表单重新显示消息“电子邮件地址或密码不正确”。目前控制器只是重新加载视图和 set_value()s

```
public function authorize_user()
{
    $this->db->where('email', $this->input->post('email'));
    $this->db->where('password', $this->input->post('password'));

    $q = $this->db->get('users');

    if($q->num_rows() == 1){
        return true;
    }
} 
```

也许我想太多了，我应该将该错误消息附加到电子邮件输入中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:11:36.037

您可以使用回调函数来完成此操作。步骤如下：
1\. 你的`authorize_user()`函数必须在你设置规则的控制器中。
2.您通过添加类似于以下的代码来制定“回调”规则：

```
$this->form_validation->set_rules('email', 'email', 'callback_authorize_user['.$this->input->post("password").']'); 
```

请注意，我为回调函数添加了一个参数。这类函数会自动接收一个参数，该参数由 的第一个参数确定`set_rules()`。在这种情况下，自动传递给回调函数的参数是电子邮件。此外，我将密码作为第二个参数传递。

3.将相应的参数添加到您的函数中：

```
public function authorize_user($email,$password)
{
   //As I said before, the email is passed automatically cause you set the rule over the email field.
    $this->db->where('email', $email);
    $this->db->where('password', $password);

    $q = $this->db->get('users');

    if($q->num_rows() == 1){
        return true;
    }
} 
```

更多信息请访问：[http ://codeigniter.com/user_guide/libraries/form_validation.html#callbacks](http://codeigniter.com/user_guide/libraries/form_validation.html#callbacks)

希望能帮助到你！

# c# - 如何将 Timespan 对象格式化为字符串

> ID：11731148
> 
> 赞同：1
> 
> 时间：2012-07-30T23:32:05.927
> 
> 标签：c#, timespan

我正在寻找以下格式： `00:00:00`

[在此处](http://msdn.microsoft.com/en-us/library/ee372286.aspx#GeneralShort)使用该部分作为参考。这在技术上应该可行`.ToString("hh:mm:ss")`，但它抱怨存在语法错误。

**注意：** `ToString("g")`很接近，但给了我这种格式`0:0:0.0000...`。如果所讨论的值不是整数，我希望格式化程序截断或舍入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:34:22.650

尝试：

```
ToString("hh':'mm':'ss") 
```

也应该工作：

```
ToString("c") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T23:37:35.367

您的语法几乎是正确的，这有效：`ToString("hh\\:mm\\:ss");`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T23:36:39.440

假设你有`TimeSpan ts`；

**然后尝试：**

```
String.Format("{0} {1} {2}", ts.Hours, ts.Minutes, ts.Seconds); 
```

# php - 如何使用php查看文件中的第一张图片？

> ID：11731150
> 
> 赞同：2
> 
> 时间：2012-07-30T23:32:17.933
> 
> 标签：php, mysql

嗨，我想弄清楚如何在用户上传的相册中显示第一张图片。我有一个网站可以让用户将图像上传到相册，现在我想将相册中的第一张图片显示为相册封面，现在当用户点击相册页面时，只显示相册信息，如名称、描述、等等，我使用相册名称作为查看相册中图像的链接，我想要的是相册中的第一张图像显示为该相册的链接。我有很多事情要做，但我会尽力提供一切，以便您更容易理解。这是我的相册页面代码：

```
$albums = get_albums();

if(empty($albums)){
echo 'No Albums';
}else{

foreach($albums as $album){
    echo '<p><a href="view_album.php?album_id=', $album['id'] ,'">', $album['name'],'</a>(', $album['count'], ' images) <br />
    ', $album['description'], '...<br />
    <a href="edit_album.php?album_id=', $album['id'] , '">Edit</a> / <a href="delete_album.php?album_id=', $album['id'] , '">Delete</a>
    </p>';
}
} 
```

这是我包含在此文件中的函数 php 文件中的函数：

```
function get_albums(){
$albums = array();

$albums_query = mysql_query("
SELECT `albums`.`album_id`, `albums`.`timestamp`, `albums`.`name`, LEFT(`albums`.`description`, 50) as `description`, COUNT(`images`.`image_id`) as `image_count`
FROM `albums`
LEFT JOIN `images`
ON `albums`.`album_id` = `images`.`album_id`
WHERE `albums`.`user_id` = " . $_SESSION['user_id'] . "
GROUP BY `albums`.`album_id`
");

while($albums_row = mysql_fetch_assoc($albums_query)){
    $albums[] = array(
        'id'            => $albums_row['album_id'],
        'timestamp'     => $albums_row['timestamp'],
        'name'          => $albums_row['name'],
        'description'   => $albums_row['description'],
        'count'         => $albums_row['image_count']
    );
}

return $albums;

} 
```

Now I am a little lost and confused on what route to take to change the link to open the albums from the album name to the first image in the album. If the albums do not have any pics in them I plan on using a simple if statement to show a generic empty folder image. My database using two table to upload images, the first is the albums table and the second is the images table. I also have a timestamp field that inserts the image upload timestamp, so can i return the images from that album and the image with the lowest timestamp so to return the first image uploaded to the album? Is there a SELECT statement to return this? Also I did create a folder that stores these images in the corresponding albums, can i return the first image in that album? What would be the easiest way to achieve this?

Here is how I get the images path:

```
function get_images($album_id){
$album_id = (int)$album_id;

$images = array();

$image_query = mysql_query("SELECT `image_id`, `album_id`, `timestamp`, `ext` FROM `images` WHERE `album_id` = $album_id AND `user_id` = ". $_SESSION['user_id']);
while($images_row = mysql_fetch_assoc($image_query)){
    $images[] = array(
        'id'            => $images_row['image_id'],
        'album'         => $images_row['album_id'],
        'timestamp'     => $images_row['timestamp'],
        'ext'           => $images_row['ext']
    );
}
return $images;
} 
```

Here is my view_album.php file:

```
if(!isset($_GET['album_id']) || empty($_GET['album_id']) || album_check($_GET['album_id']) === false){
header('Location: albums.php');
exit();
}

$album_id = $_GET['album_id'];
$album_data = album_data($album_id, 'name');

echo '<h1 class="logo2">', $album_data['name'], '</h1>';
include 'includes/menu_album.php';

$images = get_images($album_id);

if(empty($images)){
echo 'No images.';
}else{
foreach($images as $image){
    echo '<a href="uploads/', $image['album'], '/', $image['id'], '.',     $image['ext'], '"><img src="uploads/thumbs/', $image['album'], '/', $image['id'], '.', $image['ext'], '" title="Uploaded ', date('D M Y', $image['timestamp']), '"></a> [<a       href="delete_image.php?image_id=', $image['id'], '">x</a>] ';
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:28:44.250

You are actually pretty close to getting the first image with your existing query. All you need to do as add the image name or path to the `SELECT` and the image timestamp to an `ORDER BY` to make sure you get the earliest one:

```
 $albums_query = mysql_query("
        SELECT 
          `albums`.`album_id`, 
          `albums`.`timestamp`, 
          `albums`.`name`, 
          LEFT(`albums`.`description`, 50) as `description`, 
          COUNT(`images`.`image_id`) as `image_count`, 
          CONCAT(`images`.`image_id`, '.', `images`.`ext`) AS `first_image`
        FROM `albums`
        LEFT JOIN `images`
        ON `albums`.`album_id` = `images`.`album_id`
        WHERE `albums`.`user_id` = " . $_SESSION['user_id'] . "
        GROUP BY `albums`.`album_id`
        ORDER BY `albums`.`timestamp` ASC, `images`.`timestamp` ASC
    ");

    if (!$albums_query) {
      die('Invalid query: ' . mysql_error());
    }

    while($albums_row = mysql_fetch_assoc($albums_query)){
        $albums[] = array(
            'id'            => $albums_row['album_id'],
            'timestamp'     => $albums_row['timestamp'],
            'name'          => $albums_row['name'],
            'description'   => $albums_row['description'],
            'count'         => $albums_row['image_count'],
            'image'         => $albums_row['first_image']
        );
    } 
```

You can then update your output to include the image:

```
foreach($albums as $album){
    if (empty($album['image'])) {
        $album['image'] = 'default.jpg';
    }
    echo '<p>
      <a href="view_album.php?album_id=', $album['id'] ,'">
        <img src="uploads/thumbs/', $album['id'] ,'/', $album['image'] ,'" />', $album['name'],'
      </a>(', $album['count'], ' images) <br />
      ', $album['description'], '...<br />
      <a href="edit_album.php?album_id=', $album['id'] , '">Edit</a> / <a href="delete_album.php?album_id=', $album['id'] , '">Delete</a>
    </p>';
} 
```

# google-maps - PhoneGap：调用原生谷歌地图功能的方式？

> ID：11731151
> 
> 赞同：1
> 
> 时间：2012-07-30T23:32:21.147
> 
> 标签：google-maps, cordova

有没有办法在 PhoneGap/Cordova 应用程序中使用原生 iOS Google Maps 应用程序？还是我必须使用 JavaScript 版本？我正在尝试将地址提供给地图，并保留用户使用 GPS 获取其位置的能力

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T03:46:22.240

你看过 Github 上的插件吗？有一个 Mapkit 插件：[https ://github.com/phonegap/phonegap-plugins/tree/master/iOS](https://github.com/phonegap/phonegap-plugins/tree/master/iOS)

您仍然需要使用 API 请求您的 GPS 位置（我认为）当然，当 IOS6 中的 Apple Maps 出现时，这可能会改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T05:20:43.797

有一个非常简单的方法可以做到这一点，这是一个示例代码

```
$("#btnCallMap").click(function(){
      var url = 'http://maps.google.com/maps?';
      url += 'q=<your location>;';
      url += '&z=15'
      window.location = url;  
}); 
```

您可以从 jquery 按钮单击事件中执行此操作，如图所示。

希望对您有所帮助。

-- 梅乔

# xml - XSLT 获取所需的行并同时更改节点值

> ID：11731154
> 
> 赞同：2
> 
> 时间：2012-07-30T23:33:02.647
> 
> 标签：xml, xslt

我当前的 XML 如下：

```
<?xml version="1.0" encoding="utf-8"?>
<Rowsets DateCreated="2012-07-17T11:57:07" EndDate="2012-07-17T11:57:07" StartDate="2012-07-17T10:57:07" Version="12.0.12 Build(9)">
    <Rowset>
        <Row>
            <CategoryID>1</CategoryID>
            <Name>Philip</Name>
            <City>London</City>
            <Phone>123</Phone>
        </Row>
        <Row>
            <CategoryID>2</CategoryID>
            <Name>Derek</Name>
            <City>Seattle</City>
            <Phone>500</Phone>
        </Row>
        <Row>
            <CategoryID>3</CategoryID>
            <Name>Bruke</Name>
            <City>LosAngeles</City>
            <Phone>600</Phone>
        </Row>
        <Row>
            <CategoryID>2</CategoryID>
            <Name>Yang</Name>
            <City>SFO</City>
            <Phone>1233</Phone>
        </Row>
        <Row>
            <CategoryID>3</CategoryID>
            <Name>Cristina</Name>
            <City>SanJose</City>
            <Phone>890</Phone>
        </Row>
        <Row>
            <CategoryID>4</CategoryID>
            <Name>Meredith</Name>
            <City>Sunnyvale</City>
            <Phone>788</Phone>
        </Row>
        <Row>
            <CategoryID>4</CategoryID>
            <Name>Grey</Name>
            <City>MountainView</City>
            <Phone>456</Phone>
        </Row>
        <Row>
            <CategoryID>5</CategoryID>
            <Name>Torrence</Name>
            <City>SAntaClara</City>
            <Phone>432</Phone>
        </Row>
    </Rowset>
</Rowsets> 
```

现在我只想要那些`<Row>`为`<CategoryID>`2 的人。所以我的 XSLT 如下：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:java="http://xml.apache.org/xslt/java" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" exclude-result-prefixes="java" version="1.0">
    <xsl:output media-type="text/xml" method="xml"/>
    <!-- Filters refdoc based on condition and  data  -->
    <xsl:template match="/">
        <Rowsets>
            <xsl:for-each select="/Rowsets/Rowset">
                <Rowset>
                    <xsl:copy-of select="Columns"/>
                    <xsl:for-each select="Row[CategoryID = '2']">
                        <xsl:copy-of select="."/>
                    </xsl:for-each>
                </Rowset>
            </xsl:for-each>
        </Rowsets>
    </xsl:template>
</xsl:stylesheet> 
```

这个 XSLT 为我提供了以下 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<Rowsets>
    <Rowset>
        <Row>
            <CategoryID>2</CategoryID>
            <Name>Derek</Name>
            <City>Seattle</City>
            <Phone>500</Phone>
        </Row>
        <Row>
            <CategoryID>2</CategoryID>
            <Name>Yang</Name>
            <City>SFO</City>
            <Phone>1233</Phone>
        </Row>
    </Rowset>
</Rowsets> 
```

但现在我的要求是，在上面新转换的 XML 中，我还想将 CategoryID 更改为 1。

所以我最终的 XML 应该是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<Rowsets>
    <Rowset>
        <Row>
            <CategoryID>1</CategoryID>
            <Name>Derek</Name>
            <City>Seattle</City>
            <Phone>500</Phone>
        </Row>
        <Row>
            <CategoryID>1</CategoryID>
            <Name>Yang</Name>
            <City>SFO</City>
            <Phone>1233</Phone>
        </Row>
    </Rowset>
</Rowsets> 
```

我不确定如何使用相同的 XSLT 以最佳方式实现这一点。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:24:48.633

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="Row[not(CategoryID = 2)]"/>

 <xsl:template match="CategoryID/text()">1</xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<Rowsets DateCreated="2012-07-17T11:57:07" EndDate="2012-07-17T11:57:07" StartDate="2012-07-17T10:57:07" Version="12.0.12 Build(9)">
    <Rowset>
        <Row>
            <CategoryID>1</CategoryID>
            <Name>Philip</Name>
            <City>London</City>
            <Phone>123</Phone>
        </Row>
        <Row>
            <CategoryID>2</CategoryID>
            <Name>Derek</Name>
            <City>Seattle</City>
            <Phone>500</Phone>
        </Row>
        <Row>
            <CategoryID>3</CategoryID>
            <Name>Bruke</Name>
            <City>LosAngeles</City>
            <Phone>600</Phone>
        </Row>
        <Row>
            <CategoryID>2</CategoryID>
            <Name>Yang</Name>
            <City>SFO</City>
            <Phone>1233</Phone>
        </Row>
        <Row>
            <CategoryID>3</CategoryID>
            <Name>Cristina</Name>
            <City>SanJose</City>
            <Phone>890</Phone>
        </Row>
        <Row>
            <CategoryID>4</CategoryID>
            <Name>Meredith</Name>
            <City>Sunnyvale</City>
            <Phone>788</Phone>
        </Row>
        <Row>
            <CategoryID>4</CategoryID>
            <Name>Grey</Name>
            <City>MountainView</City>
            <Phone>456</Phone>
        </Row>
        <Row>
            <CategoryID>5</CategoryID>
            <Name>Torrence</Name>
            <City>SAntaClara</City>
            <Phone>432</Phone>
        </Row>
    </Rowset>
</Rowsets> 
```

**产生想要的正确结果：**

```
<Rowsets DateCreated="2012-07-17T11:57:07" EndDate="2012-07-17T11:57:07" StartDate="2012-07-17T10:57:07" Version="12.0.12 Build(9)">
   <Rowset>
      <Row>
         <CategoryID>1</CategoryID>
         <Name>Derek</Name>
         <City>Seattle</City>
         <Phone>500</Phone>
      </Row>
      <Row>
         <CategoryID>1</CategoryID>
         <Name>Yang</Name>
         <City>SFO</City>
         <Phone>1233</Phone>
      </Row>
   </Rowset>
</Rowsets> 
```

**说明**：

1.  正确使用和覆盖**[身份规则](http://www.dpawson.co.uk/xsl/sect2/identity.html)**。

2.  正确使用模板和模式匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:00:07.163

我不确定这是否是最好的方法，但这应该可行。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:java="http://xml.apache.org/xslt/java" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" exclude-result-prefixes="java" version="1.0">
  <xsl:output media-type="text/xml" method="xml"/>
  <!-- Filters refdoc based on condition and  data  -->
  <xsl:template match="/">
    <Rowsets>
      <xsl:for-each select="/Rowsets/Rowset">
        <Rowset>
          <xsl:copy-of select="Columns"/>
          <xsl:for-each select="Row[CategoryID = '2']">
            <Row>
              <xsl:apply-templates select="*" mode="Row" />
            </Row>
          </xsl:for-each>
        </Rowset>
      </xsl:for-each>
    </Rowsets>
  </xsl:template>

  <xsl:template match="*" mode="Row">
    <xsl:choose>
      <xsl:when test="current()[name()='CategoryID']">
        <xsl:copy>
          <xsl:text>1</xsl:text>
        </xsl:copy>
      </xsl:when>
      <xsl:otherwise>
        <xsl:copy-of select="." />
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet> 
```

输出将是

```
<?xml version="1.0" encoding="UTF-8"?>
<Rowsets>
  <Rowset>
    <Row>
      <CategoryID>1</CategoryID>
      <Name>Derek</Name>
      <City>Seattle</City>
      <Phone>500</Phone>
    </Row>
    <Row>
      <CategoryID>1</CategoryID>
      <Name>Yang</Name>
      <City>SFO</City>
      <Phone>1233</Phone>
    </Row>
  </Rowset>
</Rowsets> 
```

# customization - How to customize metrics in sonar?

> ID：11731155
> 
> 赞同：0
> 
> 时间：2012-07-30T23:33:09.057
> 
> 标签：customization, sonarqube, metric

I'm a new user of sonar. Now I need to customize metrics, but I didn't find the related documentation. If I have to coding a plugin? I do the same with [http://docs.sonarqube.org/display/SONAR/Getting+Started](http://docs.sonarqube.org/display/SONAR/Getting+Started), but I failed. There is no difference at the localhost:9000/profiles.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:53:31.563

为了正确集成到 Sonar 构建中，您需要编写插件：

*   [http://docs.sonarqube.org/display/DEV/Developing+Plugins](http://docs.sonarqube.org/display/DEV/Developing+Plugins)

如果您只想向仪表板添加一些额外的临时指标，则可以选择使用手动度量：

*   [http://docs.sonarqube.org/display/SONAR/Manual+Measures](http://docs.sonarqube.org/display/SONAR/Manual+Measures)

有一个 REST API 可用于创建和发布手动指标值：

*   [http://docs.sonarqube.org/pages/viewpage.action?pageId=2392169](http://docs.sonarqube.org/pages/viewpage.action?pageId=2392169)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-21T15:06:45.263

您可以通过声纳 GUI 使用手动指标创建新指标（我认为您需要管理员权限）。手动指标也可以通过 GUI 更新。

如果您的插件构建正常但没有出现数字：您还必须运行分析以使用一些度量填充新指标。

# c - 在 C 中，将可变参数函数指针转换为具有有限参数的函数指针是否安全？

> ID：11731159
> 
> 赞同：10
> 
> 时间：2012-07-30T23:33:56.250
> 
> 标签：c, undefined-behavior, variadic-functions, calling-convention

我想创建一个指向函数的函数指针，该函数将处理采用可变参数列表的函数的案例子集。用例是将一个`...`接受特定参数列表的函数强制转换为接受特定参数列表的函数，因此您可以在不处理`va_list`和朋友的情况下处理可变参数。

在下面的示例代码中，我将一个带有可变参数的函数转换为一个带有硬编码参数列表的函数（反之亦然）。这有效（或恰好有效），但由于使用的调用约定，我不知道是否是巧合。（我在两个不同的基于 x86_64 的平台上进行了尝试。）

```
#include <stdio.h>
#include <stdarg.h>

void function1(char* s, ...)
{
    va_list ap;
    int tmp;

    va_start(ap, s);
    tmp = va_arg(ap, int);
    printf(s, tmp);
    va_end(ap);
}

void function2(char* s, int d)
{
    printf(s, d);
}

typedef void (*functionX_t)(char*, int);
typedef void (*functionY_t)(char*, ...);

int main(int argc, char* argv[])
{
    int x = 42;

    /* swap! */
    functionX_t functionX = (functionX_t) function1;
    functionY_t functionY = (functionY_t) function2;

    function1("%d\n", x);
    function2("%d\n", x);
    functionX("%d\n", x);
    functionY("%d\n", x);

    return 0;
} 
```

这是未定义的行为吗？如果是的话，任何人都可以举一个这样的平台示例，或者在给定更复杂的用例的情况下，如何调整我的示例以使其失败？

* * *

**编辑**：为了解决此代码会因更复杂的参数而中断的含义，我扩展了我的示例：

```
#include <stdio.h>
#include <stdarg.h>

struct crazy
{
    float f;
    double lf;
    int d;
    unsigned int ua[2];
    char* s;
};

void function1(char* s, ...)
{
    va_list ap;
    struct crazy c;

    va_start(ap, s);
    c = va_arg(ap, struct crazy);
    printf(s, c.s, c.f, c.lf, c.d, c.ua[0], c.ua[1]);
    va_end(ap);
}

void function2(char* s, struct crazy c)
{
    printf(s, c.s, c.f, c.lf, c.d, c.ua[0], c.ua[1]);
}

typedef void (*functionX_t)(char*, struct crazy);
typedef void (*functionY_t)(char*, ...);

int main(int argc, char* argv[])
{
    struct crazy c = 
    {
        .f = 3.14,
        .lf = 3.1415,
        .d = -42,
        .ua = { 0, 42 },
        .s = "this is crazy"
    };

    /* swap! */
    functionX_t functionX = (functionX_t) function1;
    functionY_t functionY = (functionY_t) function2;

    function1("%s %f %lf %d %u %u\n", c);
    function2("%s %f %lf %d %u %u\n", c);
    functionX("%s %f %lf %d %u %u\n", c);
    functionY("%s %f %lf %d %u %u\n", c);

    return 0;
} 
```

它仍然有效。谁能指出什么时候会失败的具体例子？

```
$ gcc -Wall -g -o varargs -O9 varargs.c
$ ./varargs
this is crazy 3.140000 3.141500 -42 0 42
this is crazy 3.140000 3.141500 -42 0 42
this is crazy 3.140000 3.141500 -42 0 42
this is crazy 3.140000 3.141500 -42 0 42 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-30T23:52:48.383

*将指针*转换为不同的函数指针类型是非常安全的。但是该语言唯一保证的是您可以稍后将其转换回原始类型并获得原始指针值。

*通过强制转换为不兼容的函数指针类型的指针调用*函数会导致未定义的行为。这适用于所有不兼容的函数指针类型，无论它们是否可变。

您发布的代码会产生未定义的行为：不是在强制转换时，而是在调用时。

* * *

试图在“它会失败的地方”追逐示例是一项毫无意义的努力，但无论如何它应该很容易，因为参数传递约定（低级和语言级）有很大不同。例如，下面的代码在实践中通常不会“工作”

```
void foo(const char *s, float f) { printf(s, f); }

int main() {
  typedef void (*T)(const char *s, ...);
  T p = (T) foo;
  float f = 0.5;
  p("%f\n", f);
} 
```

打印零而不是`0.5`(GCC)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-30T23:45:09.143

是的，这是未定义的行为。

它恰好起作用，因为指针正在为您当前的编译器、平台和参数类型排列。尝试使用双打和其他类型进行此操作，您可能能够重现奇怪的行为。

即使您不这样做，这也是非常危险的代码。

我假设您对可变参数感到恼火。考虑在联合或结构中定义一组通用参数，然后将其传递。

# android - How to lauch android's apps preferences (from Contacts, Messages, ...)

> ID：11731162
> 
> 赞同：0
> 
> 时间：2012-07-30T23:34:12.997
> 
> 标签：android, android-intent

I've been searching and I couldn't find a topic that could clarify me 100%.

My question is: How can I launch an android's app preferences activity (from Contacts, Messages, ...) on my own app?

I give an example: Imagine I'm developing an app which allows the user to quickly access to Message's Settings. I don't need to send or receive any information, I only need to open the activity, create a shortcut for it.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T05:04:01.603

在代码中编写 Explicit Intent 将转到您的应用程序的特定活动并使用相同的格式转到其他应用程序的特定活动没有区别。需要注意的几件事： (1) 接收活动可能期待特定数据，否则会失败。(2) 您正在考虑的标准应用程序，例如联系人、消息，而您可以在 Android 开源项目 (AOSP) 中找到它们的来源，制造商可能会更改它们，因此活动名称和必要的额外数据可能会有所不同。

为了在所有不同的 Android 制造商之间保持尽可能多的兼容性，您应该坚持使用适当的操作/数据的标准隐式意图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:40:27.300

The best answer in this thread has the solution: [android: how do i open another app from my app?](https://stackoverflow.com/questions/2923265/android-how-do-i-open-another-app-from-my-app)

Also check: [http://android-developers.blogspot.com/2009/01/can-i-use-this-intent.html](http://android-developers.blogspot.com/2009/01/can-i-use-this-intent.html)

To open settings, you can try: startActivityForResult(new Intent(android.provider.Settings.ACTION_SETTINGS, 0));

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T23:42:50.567

> Someone knows if this can be done and even opening specific locations of the apps?

You don't need to know any specific locations or specific apps for these actions, simply look into [Intent.ACTION_PICK](http://developer.android.com/reference/android/content/Intent.html#ACTION_PICK).

*   Picking a Contact: [get contact info from android contact picker](https://stackoverflow.com/q/3044545/1267661)
*   Picking a picture: [How to pick an image from gallery (SD Card) for my app?](https://stackoverflow.com/q/2507898/1267661)

# ios - NSFetchedResultsControllerDelegate vs NSFetchedResultsController

> ID：11731164
> 
> 赞同：0
> 
> 时间：2012-07-30T23:34:18.930
> 
> 标签：ios, core-data, nsfetchedresultscontroller

在阅读了大量 Core Data 框架的文档和示例之后，我仍然不太明白。发生的情况是，我有点理解示例代码或文档的部分内容，但通常无法将其放入更大的图景中。我第二次阅读相同的代码时，我仍然需要很多时间来弄清楚它，就像第一次一样。这太令人沮丧了。

`NSFetchedResultsControllerDelegate`vs`NSFetchedResultsController`是 Core Data 中让我感到困惑的概念之一。

我认为我需要的是一个简单的概念性解释，也许类比会有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T01:00:31.110

您的所有核心数据对象都必须通过托管对象上下文进行访问。

将 NSFetchRequest 视为数据库查询的表示。当你告诉`NSManagedObjectContext`(MOC) 获取数据时，你给它一个获取请求，所以它知道要获取什么。

现在，假设您有一个表格视图。您进行提取并拥有所有数据，即使是您不需要显示的内容。每次表视图更改时，您都需要重新获取数据。仅使用 fetch 请求还有一些其他问题，尽管它可以完成。

要解决其中一些问题，请输入`NSFetchedResultsController`(FRC)。它管理数据库，以便您在内存中只有当时实际需要的对象。此外，它与 MOC 挂钩，因此当数据库更改时，它会自动更改自己的数据。

所以，你创建一个 FRC 并给它一个获取请求。现在，它管理数据，因此它只在内存中包含您想要的内容。但是，你需要告诉它要抓取什么，它需要告诉你什么时候有数据。

这就是`NSFetchedResultsControllerDelegate`进来的地方。

委托是表格视图（或其他一些组件）和 FRC 之间的粘合剂。委托方法是通知 FRC 获取什么数据、何时获取数据、然后将其交给表视图的通信通道。

**编辑**

是的，FRC 管理实际数据部分。但是，当它的数据发生变化时，它必须有某种方式来通知正在查看数据的人。这就是委托的用途。让我们通过查看委托方法来进行不同的攻击。

想象一下，数据库已经以某种方式发生了变化。FRC 通过其特殊的魔法咒语，注意到了这种变化，并且像一个拥有新 iPhone 的少年一样，需要告诉别人。

具体来说，在您的情况下，它需要告诉负责向用户显示数据的表视图。那么，它如何告诉表视图数据已更改？iOS 中实际上使用了几种模式，在这种情况下，我们使用委托。

有兴趣从 FRC 接收此信息的人给他一个指向实现委托方法的对象的指针。当 FRC 想要通知感兴趣的人时，它会在作为委托的对象上调用适当的方法。

考虑发生了变化。FRC 代码看起来像这样（超简化但给出了算法思想）。

```
[delegate controllerWillChangeContent:self];

// Process all the changes...

for (SectionChangeInfo *info in changedSections) {
    [delegate controller:self didChangeSection:info.sectionInfo atIndex:info.index forChangeType:info.changeType];
}

for (ObjectChangeInfo *info in changedObjects) {
    [delegate controller:self didChangeObject:info.object atIndexPath:info.indexPath forChangeType:info.changeType newIndexPath:index.newIndexPath];
}

[delegate controllerDidChangeContent:self]; 
```

因此，FRC 可以在发生变化时告诉“某人”。在您的情况下，当您给 FRC 一个委托时，它将调用这些方法，从而使您有机会在发生更改时处理更改。

调用另一个委托方法来询问委托它想使用什么作为节标题。因此，假设 FRC 需要知道使用什么，它会调用...

```
NSString *sectionTitle = [[section substringToIndex:1] uppercase];
if ([delegate respondsToSelector:@selector(controller:sectionIndexTitleForSectionName:)]) {
    sectionTitle = [delegate controller:self sectionIndexTitleForSectionName:section];
} 
```

# php - Mongodb和排序子数组

> ID：11731166
> 
> 赞同：1
> 
> 时间：2012-07-30T23:34:19.407
> 
> 标签：php, mongodb, sorting

不知道这是否可以做到，所以想我会问。

我有以下 mongodb/s

```
{
 "store":"abc",
 "offers":[{
    "spend":"100.00",
    "cashback":"10.00",
    "percentage":"0.10"
  },{
    "spend":"50.00",
    "cashback":"5.00",
    "percentage":"0.10"
  }]
} 
```

和

```
 {
     "store":def",
     "offers":[{
        "spend":"50.00",
        "cashback":"2.50",
        "percentage":"0.05"
      },{
        "spend":"20.00",
        "cashback":"1.00",
        "percentage":"0.05"
      }]
    } 
```

和

```
 {
         "store":ghi",
         "offers":[{
            "spend":"50.00",
            "cashback":"5.00",
            "percentage":"0.10"
          },{
            "spend":"20.00",
            "cashback":"2.00",
            "percentage":"0.10"
          }]
        } 
```

排序需要按百分比。

我不确定我是否必须使用另一个 PHP 函数的 usort 来完成它，或者 Mongodb 是否足够聪明来做我想做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:18:08.017

令人惊讶的是，是的，mongodb 可以做到这一点：

```
// Sort ascending, by minimum percentage value in the docs' offers array.
db.collection.find({}).sort({ 'offers.percentage': 1 });

// Sort descending, by maximum percentage value in the docs' offers array.
db.collection.find({}).sort({ 'offers.percentage': -1 }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T04:01:13.247

鉴于文档中数组的数据结构，我认为在 MongoDB 中进行这种排序是没有意义的——Mongo 将返回整个文档（而不是数组）。

如果您尝试比较报价，那么拥有一个单独的集合而不是嵌入式数组可能更有意义。例如，您可以找到匹配至少 5 美元现金返还的优惠，按支出或折扣百分比排序。

如果您只是想在单个文档中订购商品，您可以在 PHP 中使用[usort()](http://au.php.net/usort)来执行此操作。

# c++ - 无限 C++ 程序中的线程

> ID：11731173
> 
> 赞同：1
> 
> 时间：2012-07-30T23:35:09.157
> 
> 标签：c++, multithreading, pthreads

我有一个网络界面，用户在其中提交一些数据并将其写入数据库。在后台有一个 C++ 程序，它会定期检查数据库中的新条目。然后它获取这些条目，处理它们并将它们的结果写入目录。然后它继续休眠并继续检查要处理的新条目。

我的问题是关于向 C++ 程序添加多线程。我已经读过，每次需要完成另一项工作时创建一个新线程通常是一个坏主意，而是将作业添加到队列中并将它们分散到已经创建的固定数量的线程中（例如， 5个左右）。这是适合我的情况的正确设计路线吗？此外，如果我正确理解 pthread_join，我实际上不需要调用它，因为我不想等待所有作业完成后再继续检查数据库的新更新。

我只是想确保我朝着正确的方向前进，有任何肯定/批评/资源吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:03:04.613

您应该首先决定是否需要多个线程——听起来就像检查数据库和在某个给定的时间间隔写入文件可以只使用一个线程来完成。当您开始不得不以不规则的时间间隔同时将不同的数据写入多个文件时，多线程将变得有用。您是正确的，使用各种队列是将这些“作业”分配给您的线程的最佳方式，并且使用线程池可以让您更好地控制您想要在任何给定的同时运行多少“作业”时间。pthread_join 方法用于确保一个线程不会在另一个线程之前退出 - 我主要使用它来确保程序的初始线程在创建线程池后不会退出，就像父线程退出时程序的执行停止一样。基于我下面的评论的一些伪代码。

主线程：

```
spawn child threads
while(some exit condition){
   check database for new jobs
   if(new jobs){
      acquire job queue mutex //mutexes ensures only one thread accesses shared 
      add job to queue        //data at a time
      signal on shared condition variable
      release job queue mutex 
   }
   sleep(some regular duration)
} 
```

子线程：

```
while(some exit condition){
   acquire job queue mutex
   if(job queue's size == 0){
      wait on the shared condition variable
   }
   grab job from queue
   release job queue mutex
   handle job
} 
```

有关 pthread/mutex/CV 使用说明，请参见[此处](https://computing.llnl.gov/tutorials/pthreads/#ConVarSignal)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:51:37.057

根据我的经验，创建一个线程很可能需要几十毫秒。对于您的计算机而言，这没什么大不了的。如果经常创建/销毁它，就不会发生任何不好的事情。寻找简单而完美的应用程序关卡设计可能更重要。

作为一种可能的变体，我建议考虑一个线程池，每个可用 CPU 内核一个线程。这些线程应该在循环结束时简单地休眠，并定期检查是否有事情要做。

这种简单的设计将增加最小的开销并允许同时使用所有可用的 CPU 功率。

我的 2 美分。

# python - Python Twisted addReader 适用于 linux 但不适用于 windows

> ID：11731175
> 
> 赞同：4
> 
> 时间：2012-07-30T23:35:28.237
> 
> 标签：python, twisted

我正在尝试使用 Twisted 在 python 2.7 中编写客户端。我的代码在 linux（debian 挤压）中工作得很好，但是当我在 windows（xp 和 7）上尝试它时，我收到了源源不断的错误消息流。这些消息的屏幕截图在[这里](https://i.imgur.com/RjaKx.png)。

我已经缩小了错误范围，并且能够编写一个仍然包含错误的客户端的非常精简的版本：

```
from twisted.internet.protocol import Protocol,ClientFactory
from twisted.protocols.basic import LineReceiver
from twisted.internet import reactor

class TheClient(LineReceiver):
    def lineReceived(self,line):
        print line

    def connectionLost(self,reason):
        reactor.stop()

class TheFactory(ClientFactory):
    protocol = TheClient

class Test(object):
    def doRead(self):
        pass

    def fileno(self):
        return 0

    def connectionLost(self,reason):
        print 'connection lost'

    def logPrefix(self):
        return 'Client'

def main():
    print 'starting'
    test = Test()
    reactor.addReader(test)
    reactor.run()

if __name__ == '__main__':
    main() 
```

如果包含“reactor.addReader(test)”的行被注释掉，我不会收到任何错误消息。如果我在 linux 上运行此代码而不注释掉任何行，我不会收到任何错误消息。

我发现[了这个问题](https://stackoverflow.com/questions/11443040/python-twisted-stdio-example-on-windows-doesnt-work)，我认为它不是同一个问题，但正如预期的那样，它在 Windows 上无法正常运行。

这段代码是否正确，这是一个 Windows 错误，还是我必须做一些不同的事情才能让它在 Windows 中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T10:52:54.703

Windows 实现`select`仅支持套接字。大概您的进程中的文件描述符 0 不代表套接字。它更有可能代表与标准 I/O 相关的东西。

如果您只想使用标准 I/O，那么有`twisted.internet.stdio`，尽管您可能会在 Windows 上遇到一些粗糙的边缘（感谢错误报告和修复！）。

如果您对标准 I/O 不感兴趣并且 0 只是一个任意测试，那么您可能需要确定您要特别尝试执行的输入类型。根据您拥有的文件描述符类型，可能会有不同的方法来成功读取它。

# php - How to append a timestamp to each line as it comes out of grep?

> ID：11731177
> 
> 赞同：6
> 
> 时间：2012-07-30T23:35:34.670
> 
> 标签：php, logging, grep, timestamp

I have an infinite stream of data coming out of a logger, which I am piping to grep. I would like to save the output of the grep to a file, but also include a timestamp at the beginning of each line (the time at which the line appeared). Is there an easy way to accomplish this? Assume I cannot change the output of the logger process.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T00:01:42.550

您可以使用and附加**静态时间戳**：`sed``date`

```
... | sed "s/^/$(date) /" >> output.txt 
```

* * *

或者，如果您需要**实时时间戳**`gawk`，请使用[strftime 函数](https://www.gnu.org/software/gawk/manual/html_node/Time-Functions.html)：

```
... | gawk '{ print strftime(), $0 }' 
```

您可以定义自己喜欢的格式：

```
... | gawk '{ print strftime("%Y-%m-%d %H:%M:%S"), $0 }' 
```

如果缓冲是一个问题，不要忘记[刷新](https://www.gnu.org/software/gawk/manual/html_node/I_002fO-Functions.html)每一行：

```
... | awk '{ print strftime("%Y-%m-%d %H:%M:%S"), $0; fflush() }' 
```

或者，使用`unbuffer`：

```
unbuffer ... | awk '{ print strftime("%Y-%m-%d %H:%M:%S"), $0 }' 
```

* * *

如果你没有`gawk`，你有几个**其他的选择**：

(a) 安装`ts`（来自[moreutils](http://joeyh.name/code/moreutils/)）：

```
... | ts '%F %T' 
```

(b) 使用`perl`：

```
... | perl -pe 's/^/localtime . " "/e' 
```

或格式：

```
... | perl -MPOSIX -pe 's/^/strftime("%Y-%m-%d %H:%M:%S", localtime) . " "/e' 
```

不要忘记，如果您需要将 GMT 格式化为您的语言环境，您可以使用`gmtime`而不是。`localtime`

(c)[问一个问题](https://stackoverflow.com/questions/ask)。

# java - Recursive Copy Of Sub-Directories Fails Using FTPS (Possible Handshake Issue?)

> ID：11731178
> 
> 赞同：1
> 
> 时间：2012-07-30T23:36:07.340
> 
> 标签：java, apache, recursion, ftp, ftps

I am trying to use FTPS to copy all sub-directories and files under a given directory from an FTP server to a local machine. The program I've written gets some of the sub-directories and files before bombing. Each time the program bombs is not always in the same place. The code and errors I am getting are below. Any ideas on how to get this to work?

```
import org.apache.commons.net.PrintCommandListener;
import org.apache.commons.net.ftp.FTP;
import org.apache.commons.net.ftp.FTPConnectionClosedException;
import org.apache.commons.net.ftp.FTPFile;
import org.apache.commons.net.ftp.FTPReply;
import org.apache.commons.net.ftp.FTPSClient;

public class SaigFileBuilder {

    private String server = "host";
    private String username = "user";
    private String password = "pass";
    private String remoteParentDir = "/prd/fa/out/FA003100/SAIG/";
    private String filesep = System.getProperty("file.separator");
    private String local = "c:" + filesep + "temp" + filesep + "saig_files";
    private List<String> fileList = null;

    private boolean error = false;
    private String protocol = "TLS";  // SSL/TLS
    private FTPSClient ftps = null;

    public static void main(String[] args) {

        SaigFileBuilder fb = new SaigFileBuilder();

        try {
            fb.getClientConnection();            
            fb.getFiles(false);
            fb.logout();

        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        }

        System.exit(fb.error ? 1 : 0);
    }

    private void getClientConnection() throws NoSuchAlgorithmException {

        this.ftps = new FTPSClient(this.protocol);
        this.ftps.addProtocolCommandListener(new PrintCommandListener(new PrintWriter(System.out)));

        this.ftps = getConnection(server);
        this.ftps = getLogin(username, password);
    }

    private FTPSClient getConnection(String server) {

        try
        {
            int reply;

            // Connect to the FTP server...
            this.ftps.connect(server);
            System.out.println("Connected to " + server + ".");

            // Get connect reply code...
            reply = this.ftps.getReplyCode();
            System.out.println("String reply: " + this.ftps.getReplyString());

            // Verify successful connection reply code was returned...
            if (!FTPReply.isPositiveCompletion(reply))
            {
                error = true;
                System.err.println("FTP server refused connection.");
                return null;
            }

            // FileZilla client issues following, so I will too..
            this.ftps.sendCommand("OPTS UTF8 ON");
            this.ftps.execPBSZ(0);
            this.ftps.execPROT("P");
            this.ftps.enterLocalPassiveMode();
        }
        catch (IOException e)
        {
            System.err.println("Could not connect to server.");
            e.printStackTrace();
        }
        return this.ftps;    
    }

    private FTPSClient getLogin(String username, String password) {

        try
        {
            this.ftps.setBufferSize(1000);

            if (!this.ftps.login(username, password))
            {
                System.out.println("Login failed");
                this.ftps.logout();
                return null;
            }

            System.out.println("Remote system is " + this.ftps.getSystemType());

        }
        catch (FTPConnectionClosedException e)
        {
            error = true;
            System.err.println("Server closed connection.");
            e.printStackTrace();
        }
        catch (IOException e)
        {
            error = true;
            e.printStackTrace();
        }

        return this.ftps;
    }

    private void getFiles(boolean binaryTransfer) {
        try
        {
            if (binaryTransfer) { 
                this.ftps.setFileType(FTP.BINARY_FILE_TYPE);
            }

            OutputStream output = null;

            this.ftps.changeWorkingDirectory(this.remoteParentDir);
            System.out.println("pwd: " + this.ftps.printWorkingDirectory());

            this.fileList = new ArrayList<String>();
            scanDirTree(this.remoteParentDir);

            System.out.println("Finished scanning...");
            for (String file : this.fileList) {
            System.out.println(file);
            }

            String dirHold = " ";
            String winDir = " ";
            String winFile = " ";

            for (String ftpFilePath : this.fileList) {
                // Going to copy the remote dirs and files to local, so change the paths to 
                // use local Windows file separator instead of remote Unix... 
                winDir = ftpFilePath.substring(0, ftpFilePath.lastIndexOf("/") + 1).replace("/", filesep);
                winFile = ftpFilePath.substring(ftpFilePath.lastIndexOf("/") + 1, ftpFilePath.length());
                System.out.println("winDir.: " + winDir);
                System.out.println("winFile: " + winFile);

                // If new dir found in list, then create it locally...
                if (dirHold.equals(winDir) == false) {
                    System.out.println("mkdir: " + local + winDir);
                    new File(local + winDir).mkdirs();
                    dirHold = winDir;
                }

                // And write the file locally...
                System.out.println("Attempting to write: " + this.local + winDir + winFile);
                output = new FileOutputStream(local + winDir + winFile);
                this.ftps.retrieveFile(ftpFilePath, output);

                output.close();
                output = null;
            }

        }
        catch (FTPConnectionClosedException e)
        {
            error = true;
            System.err.println("Server closed connection.");
            e.printStackTrace();
        }
        catch (IOException e)
        {
            error = true;
            e.printStackTrace();
        }
    }

    private void scanDirTree(String directory) throws IOException {
        // Create and return a list of all dirs and files on remote 
        // server below the parent dir that was passed to this method...
        FTPFile[] files = this.ftps.listFiles(directory);

        if (files.length == 0) {
            System.out.println("no files in " + directory);
        }

        for (FTPFile file : files) {
            String name = file.getName();

            if (!".".equals(name) && !"..".equals(name)) {
                if (file.isDirectory()) {
                    // Recursive call, go deeper...
                    scanDirTree(directory + name + "/");
                } else {
                    fileList.add(directory + file.getName());
                    System.out.println("Added: " + directory + file.getName());
                }
            }
        }
    }

    private void logout() {

        if (this.ftps.isConnected()) {
            try {
                System.out.println("Logging out...");
                this.ftps.logout();
                System.out.println("Disconnecting...");
                this.ftps.disconnect();
            }
            catch (IOException e) {
                error = true;

            }
        }
    }
} 
```

Here is the error:

```
220 (vsFTPd 2.0.5)
AUTH TLS
234 Proceed with negotiation.
Connected to xxx.xxx.xxx
String reply: 234 Proceed with negotiation.

OPTS UTF8 ON
200 Always in UTF8 mode.
PBSZ 0
200 PBSZ set to 0.
PROT P
200 PROT now Private.
USER xxx
331 Please specify the password.
PASS xxxx
230 Login successful.
SYST
215 UNIX Type: L8
Remote system is UNIX Type: L8
CWD /prd/fa/out/FA003100/SAIG/
250 Directory successfully changed.
PWD
257 "/prd/fa/out/FA003100/SAIG"
pwd: /prd/fa/out/FA003100/SAIG
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,29)
LIST /prd/fa/out/FA003100/SAIG/
150 Here comes the directory listing.
226 Directory send OK.
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,46)
LIST /prd/fa/out/FA003100/SAIG/2012/
150 Here comes the directory listing.
226 Directory send OK.
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,150)
LIST /prd/fa/out/FA003100/SAIG/2012/DirectLoan/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-G.xml
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GCHG.xml
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GDISB.xml
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-U.xml
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UCHG.xml
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UDISB.xml
Added: /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,196,232)
LIST /prd/fa/out/FA003100/SAIG/2012/Isir/
150 Here comes the directory listing.
226 Directory send OK.
no files in /prd/fa/out/FA003100/SAIG/2012/Isir/
PASV
227 Entering Passive Mode (xx,xx,xxx,x,196,254)
LIST /prd/fa/out/FA003100/SAIG/2012/Pell/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN.xml
Added: /prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN_DISB.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,5)
LIST /prd/fa/out/FA003100/SAIG/2012/Teach/
150 Here comes the directory listing.
226 Directory send OK.
no files in /prd/fa/out/FA003100/SAIG/2012/Teach/
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,66)
LIST /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.01
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.02
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.03
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.04
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.05
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.06
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.07
Added: /prd/fa/out/FA003100/SAIG/2012/TrnsMonitorTRNINFIN.01
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,3)
LIST /prd/fa/out/FA003100/SAIG/2013/
150 Here comes the directory listing.
226 Directory send OK.
PASV
227 Entering Passive Mode (xx,xx,xxx,x,196,230)
LIST /prd/fa/out/FA003100/SAIG/2013/CommRec/
150 Here comes the directory listing.
226 Directory send OK.
no files in /prd/fa/out/FA003100/SAIG/2013/CommRec/
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,135)
LIST /prd/fa/out/FA003100/SAIG/2013/DLReconciliation/
150 Here comes the directory listing.
226 Directory send OK.
no files in /prd/fa/out/FA003100/SAIG/2013/DLReconciliation/
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,124)
LIST /prd/fa/out/FA003100/SAIG/2013/DirectLoan/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-G.xml
Added: /prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-GCHG.xml
Added: /prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-GDISB.xml
Added: /prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-U.xml
Added: /prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-UCHG.xml
Added: /prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-UDISB.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,121)
LIST /prd/fa/out/FA003100/SAIG/2013/Isir/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.001
Added: /prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.002
Added: /prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.003
Added: /prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.004
Added: /prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.005
Added: /prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.006
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,147)
LIST /prd/fa/out/FA003100/SAIG/2013/Pell/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2013/Pell/CRPG13IN.xml
Added: /prd/fa/out/FA003100/SAIG/2013/Pell/CRPG13IN_DISB.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,63)
LIST /prd/fa/out/FA003100/SAIG/2013/SysGen/
150 Here comes the directory listing.
226 Directory send OK.
no files in /prd/fa/out/FA003100/SAIG/2013/SysGen/
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,118)
LIST /prd/fa/out/FA003100/SAIG/2013/TrnsMonitor/
150 Here comes the directory listing.
226 Directory send OK.
Added: /prd/fa/out/FA003100/SAIG/2013/TrnsMonitor/TRNINFIN.01
Finished scanning...
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-G.xml
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GCHG.xml
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GDISB.xml
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-U.xml
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UCHG.xml
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UDISB.xml
/prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN.xml
/prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN.xml
/prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN_DISB.xml
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.01
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.02
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.03
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.04
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.05
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.06
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.07
/prd/fa/out/FA003100/SAIG/2012/TrnsMonitorTRNINFIN.01
/prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-G.xml
/prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-GCHG.xml
/prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-GDISB.xml
/prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-U.xml
/prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-UCHG.xml
/prd/fa/out/FA003100/SAIG/2013/DirectLoan/CRDL13IN-UDISB.xml
/prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.001
/prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.002
/prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.003
/prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.004
/prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.005
/prd/fa/out/FA003100/SAIG/2013/Isir/CORR13IN.006
/prd/fa/out/FA003100/SAIG/2013/Pell/CRPG13IN.xml
/prd/fa/out/FA003100/SAIG/2013/Pell/CRPG13IN_DISB.xml
/prd/fa/out/FA003100/SAIG/2013/TrnsMonitor/TRNINFIN.01
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN-G.xml
mkdir: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN-G.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,16)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-G.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-G.xml (4561 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN-GCHG.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN-GCHG.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,136)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GCHG.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GCHG.xml (9074 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN-GDISB.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN-GDISB.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,196,239)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GDISB.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GDISB.xml (2047 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN-U.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN-U.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,137)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-U.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-U.xml (3367 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN-UCHG.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN-UCHG.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,196,243)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UCHG.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UCHG.xml (7503 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN-UDISB.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN-UDISB.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,87)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UDISB.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UDISB.xml (2995 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\DirectLoan\
winFile: CRDL12IN.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\DirectLoan\CRDL12IN.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,196,251)
RETR /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN.xml (145846 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\Pell\
winFile: CRPG12IN.xml
mkdir: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\Pell\
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\Pell\CRPG12IN.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,123)
RETR /prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN.xml (2057 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\Pell\
winFile: CRPG12IN_DISB.xml
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\Pell\CRPG12IN_DISB.xml
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,21)
RETR /prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN_DISB.xml
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/Pell/CRPG12IN_DISB.xml (9709 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.01
mkdir: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.01
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,119)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.01
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.01 (453 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.02
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.02
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,101)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.02
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.02 (604 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.03
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.03
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,109)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.03
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.03 (453 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.04
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.04
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,18)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.04
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.04 (453 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.05
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.05
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,84)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.05
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.05 (604 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.06
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.06
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,70)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.06
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.06 (453 bytes).
226 File send OK.
winDir.: \prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\
winFile: TRNINFIN.07
Attempting to write: c:\temp\saig_files\prd\fa\out\FA003100\SAIG\2012\TrnsMonitor\TRNINFIN.07
PASV
227 Entering Passive Mode (xx,xx,xxx,x,197,119)
RETR /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.07
150 Opening BINARY mode data connection for /prd/fa/out/FA003100/SAIG/2012/TrnsMonitor/TRNINFIN.07 (3624 bytes).
org.apache.commons.net.io.CopyStreamException: IOException caught while copying.
    at org.apache.commons.net.io.Util.copyStream(Util.java:135)
    at org.apache.commons.net.ftp.FTPClient._retrieveFile(FTPClient.java:1695)
    at org.apache.commons.net.ftp.FTPClient.retrieveFile(FTPClient.java:1669)
    at edu.ohio.saig.SaigFileBuilder.getFiles(SaigFileBuilder.java:196)
    at edu.ohio.saig.SaigFileBuilder.main(SaigFileBuilder.java:63)
Caused by: javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readDataRecord(Unknown Source)
    at com.sun.net.ssl.internal.ssl.AppInputStream.read(Unknown Source)
    at java.io.BufferedInputStream.read1(Unknown Source)
    at java.io.BufferedInputStream.read(Unknown Source)
    at java.io.FilterInputStream.read(Unknown Source)
    at java.io.PushbackInputStream.read(Unknown Source)
Logging out...
    at org.apache.commons.net.io.FromNetASCIIInputStream.read(FromNetASCIIInputStream.java:161)
    at org.apache.commons.net.io.FromNetASCIIInputStream.read(FromNetASCIIInputStream.java:139)
    at org.apache.commons.net.io.Util.copyStream(Util.java:101)
    ... 4 more
Caused by: java.io.EOFException: SSL peer shut down incorrectly
    at com.sun.net.ssl.internal.ssl.InputRecord.read(Unknown Source)
    ... 15 more
QUIT 
```

Note I can use FileZilla to manually copy the parent directory to the local machine and all of the sub-directories and files are copied automatically. Here is the log from a FileZilla session:

```
Status: Resolving address of xxx.xxx.xxx
Status: Connecting to xx.xx.xxx.x:21...
Status: Connection established, waiting for welcome message...
Response:   220 (vsFTPd 2.0.5)
Command:    AUTH TLS
Response:   234 Proceed with negotiation.
Status: Initializing TLS...
Status: Verifying certificate...
Command:    USER xxxxx
Status: TLS/SSL connection established.
Response:   331 Please specify the password.
Command:    PASS ************
Response:   230 Login successful.
Command:    OPTS UTF8 ON
Response:   200 Always in UTF8 mode.
Command:    PBSZ 0
Response:   200 PBSZ set to 0.
Command:    PROT P
Response:   200 PROT now Private.
Status: Connected
Status: Sending keep-alive command
Command:    TYPE A
Response:   200 Switching to ASCII mode.
Status: Sending keep-alive command
Command:    PWD
Response:   257 "/prd/fa/out/FA003100/SAIG/2013/TrnsMonitor"
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/TrnsMonitorTRNINFIN.01
Command:    CWD /prd/fa/out/FA003100/SAIG/2012
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN.xml
Command:    CWD /prd/fa/out/FA003100/SAIG/2012/DirectLoan
Response:   250 Directory successfully changed.
Command:    PASV
Response:   250 Directory successfully changed.
Command:    PASV
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,141)
Command:    RETR TrnsMonitorTRNINFIN.01
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,118)
Command:    RETR CRDL12IN.xml
Response:   150 Opening BINARY mode data connection for TrnsMonitorTRNINFIN.01 (3775 bytes).
Response:   150 Opening BINARY mode data connection for CRDL12IN.xml (145846 bytes).
Response:   226 File send OK.
Status: File transfer successful, transferred 3,775 bytes in 1 second
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UDISB.xml
Command:    CWD /prd/fa/out/FA003100/SAIG/2012/DirectLoan
Response:   250 Directory successfully changed.
Command:    TYPE A
Response:   200 Switching to ASCII mode.
Command:    PASV
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,53)
Command:    RETR CRDL12IN-UDISB.xml
Response:   150 Opening BINARY mode data connection for CRDL12IN-UDISB.xml (2995 bytes).
Response:   226 File send OK.
Status: File transfer successful, transferred 145,846 bytes in 1 second
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-UCHG.xml
Command:    PASV
Response:   226 File send OK.
Status: File transfer successful, transferred 2,995 bytes in 1 second
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-U.xml
Command:    PASV
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,123)
Command:    RETR CRDL12IN-UCHG.xml
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,51)
Command:    RETR CRDL12IN-U.xml
Response:   150 Opening BINARY mode data connection for CRDL12IN-UCHG.xml (7503 bytes).
Response:   150 Opening BINARY mode data connection for CRDL12IN-U.xml (3367 bytes).
Response:   226 File send OK.
Status: File transfer successful, transferred 3,367 bytes in 1 second
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GDISB.xml
Command:    PASV
Response:   226 File send OK.
Status: File transfer successful, transferred 7,503 bytes in 1 second
Status: Starting download of /prd/fa/out/FA003100/SAIG/2012/DirectLoan/CRDL12IN-GCHG.xml
Command:    PASV
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,25)
Command:    RETR CRDL12IN-GDISB.xml
Response:   227 Entering Passive Mode (xx,xx,xxx,x,197,28)
Command:    RETR CRDL12IN-GCHG.xml
Response:   150 Opening BINARY mode data connection for CRDL12IN-GDISB.xml (2047 bytes).
Response:   150 Opening BINARY mode data connection for CRDL12IN-GCHG.xml (9074 bytes).
Response:   226 File send OK.
.
.
.
Status: Disconnected from server 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T21:53:43.850

好的，我找到了错误的原因，但不确定如何解决它。该错误是在多次调用方法retrieveFile() 时引起的。在我看来，该方法向 FTP 服务器发出 PASV 命令。服务器以随机端口号响应客户端以检索文件。但是，服务器有时会重用端口，当这种情况发生时，发送 RETR 命令时会引发异常。

我不确定是否需要断开连接并重新连接/登录才能继续。我在异常处理中设置了一个小测试以重新连接，但测试抛出错误 javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection。

我会继续努力，但欢迎任何评论/帮助。

# ruby - Ruby：如何在模块中使用类变量

> ID：11731179
> 
> 赞同：0
> 
> 时间：2012-07-30T23:36:10.750
> 
> 标签：ruby, metaprogramming

说到这个，我总是脑抽筋。我正在创建一个模块来混合到类似模型的类中，但它需要为每个类保留一份可序列化属性的副本。所以这是代码（不起作用）。

```
module Checkin
  module Model
    def self.included(base)
      base.extend(ClassMethods)
    end

    @@serialiable_attrs = []   <== really not the right place
    module ClassMethods
      def serializable(*attrs)
        attrs.each{|attr| @@serializable_attrs << attr} # Is this @@ or just @?
      end
    end

    def serialize!
      @@serializable_attrs.each{|a| do_something_with(a)} # <== Will this work?
    end
  end
end

class Person  
  include Checkin::Model
  serializable :first_name, :original_name, :last_name, :checked_in, :people_attending
  # etc., etc.
end 
```

我纠结的是两件事：

1.  如何定义我的混入，使类变量神奇地出现；和
2.  如何在我的`ClassMethods`模块和模块的（因为没有更好的术语）实例方法部分中访问该变量。

请注意，我选择了一种混合技术而不是继承，因为我将拥有`Validatable`,`Persistable`等等`Serializable`。此外，我知道有各种可用的验证和持久层，它们经过了良好的测试和大量使用。这是一个不同的野兽，我真的应该知道谁在我的睡眠中这样做，对吧？

任何可以帮助我理解如何执行此操作或建议解决此问题的不同方向的 Ruby 向导，我感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:46:01.243

尝试删除类变量，并将其添加到模块中`ClassMethod`：

```
def self.extended(klass)
  klass.instance_variable_set("@serializable_attrs", [])
end 
```

并将双输入更改`@`为单输入`serializable`。并更改`serialize!`为：

```
self.class.instance_variable_get("@serializable_attrs").each{|a| do_something_with(a)} 
```

# ruby-on-rails-3 - Validation in twitter/bootstrap modal rails 3.2

> ID：11731181
> 
> 赞同：1
> 
> 时间：2012-07-30T23:36:23.550
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, modal-dialog

I am trying to get validation to return in my modal using rails 3.2,twitter/bootstrap and formtastic, but I am at a loss as to how to do this.

Below is a quick sample of what my modal and form look like. In the model I require firstname and lastname. If the user hits 'submit' without putting in a firstname or lastname, it immediately takes the user to my actual registration page and notifies them of what is missing.

But I would like it to return to this modal and let the user know what is missing. How do I accomplish this?

:In my header, this is how I bring up the modal:

```
=link_to 'Register', "#new_registration_modal", :data => { :toggle => "modal",:backdrop => "static" } 
```

### #app/views/subscribers/registration/_new_modal.html.haml

```
#new_registration_modal.modal.hide.fade
  .modal-header
    Some Text
  .modal-body
    Some Text
    =semantic_form_for(:subscriber, :as => resource_name, :url => registration_path(resource_name),:html => { :class => "form-inline" } )  do |f|
      =f.input :email
      =f.input :firstname
      =f.input :lastname
      =f.input :password
      =f.input :password_confirmation
      =f.submit
  .modal-footer
    Some Text 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-21T13:03:45.863

我找到了一个适合我的解决方案（使用 simple_form），也许可以帮助你：

我想在另一个控制器的模态中添加一个新客户端。

模态控制器的视图：

```
<div id="client_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="client_modal_label" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="client_modal_label">Create new client</h3>
  </div>
  <div class="modal-body">
    <%= simple_form_for Client.new, html: {"data-type" => :json}, remote: true do |f| %>
    <div id="error_explanation" style="display:none;"></div>

    <div class="form-inputs">
      # the inputs
      # ... and "closing" the modal 
```

`client_controller.create`：_

```
def create
 # save the data
 if @client.save
    respond_to do |format|
          format.html { redirect_to anagrafe_index_path, :notice => "Client create!"}
          format.json { render json: @client, status: :created, location: @client }
    end
 else
    respond_to do |format| 
        format.html { render :action => 'new'}
        format.json { render json: @client.errors.full_messages, status: :unprocessable_entity }
    end
 end
end 
```

引发模态的 js.coffee ：

```
$ ()->
  $("form.new_client").on "ajax:success", (event, data, status, xhr) ->
    $("form.new_client")[0].reset()
    $('#client_modal').modal('hide')
    $('#error_explanation').hide()

  $("form.new_client").on "ajax:error", (event, xhr, status, error) ->
    errors = jQuery.parseJSON(xhr.responseText)
    errorcount = errors.length
    $('#error_explanation').empty()
    if errorcount > 1
      $('#error_explanation').append('<div class="alert alert-error">The form has ' + errorcount + ' errors.</div>')
    else
      $('#error_explanation').append('<div class="alert alert-error">The form has 1 error.</div>')
    $('#error_explanation').append('<ul>')
    for e in errors
      $('#error_explanation').append('<li>' + e + '</li>')
    $('#error_explanation').append('</ul>')
    $('#error_explanation').show() 
```

# iphone - Transparent overlay view that only opens when application is first opened

> ID：11731183
> 
> 赞同：0
> 
> 时间：2012-07-30T23:36:25.837
> 
> 标签：iphone, objective-c, ios

I believe I have the code for determining if my application has been opened before set in stone:

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
BOOL didFirstLaunch = [defaults boolForKey:@"DidFirstLaunch"];
if (!didFirstLaunch) {
    [defaults setBool: YES forKey:@"DidFirstLaunch"];

    //Code for assembling overlay view
} 
```

I put this code in the didFinishLaunchingWithOptions method.

I want the transparent overlay view to only cover 3/4 of the iPhone screen and be slightly transparent so you can still see a little of the main page of my application -- it will have a couple pictures and text on it (basically a simple tutorial). **How do I go about creating a simple view of this nature?**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T23:57:06.073

您应该将代码放入`didFinishLaunchingWithOptions`方法中：

```
BOOL didFirstLaunch = [[NSUserDefaults standardUserDefaults] boolForKey:@"DidFirstLaunch"];

if (!didFirstLaunch) {

    [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"DidFirstLaunch"];
    [[NSUserDefaults standardUserDefaults] synchronize];

    UIView *v = [[UIView alloc] initWithFrame:CGRectMake(0, 0, window.frame.size.width, window.frame.size.height)];
    //add some stuff to your transparent view. Example background color
    [v setBackgroundColor:[UIColor orangeColor]];

    // Finally set the alpha value
    [v setAlpha:0.3];
    [window addSubview:v];

} 
```

希望能帮助到你。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-15T15:06:03.110

对于问题的透明覆盖部分......

我认为最简单的方法是创建一个覆盖整个屏幕的子视图，然后减去你想要的部分。以下是一些可能有帮助的 Swift 代码：

```
// Create a view filling the screen.
let overlay = UIView(frame: CGRectMake(0, 0, 
    UIScreen.mainScreen().bounds.width,
    UIScreen.mainScreen().bounds.height))

// Set a semi-transparent, black background.
overlay.backgroundColor = UIColor(red: 0, green: 0, blue: 0, alpha: 0.85)

// Create the initial layer from the view bounds.
let maskLayer = CAShapeLayer()
maskLayer.frame = overlay.bounds
maskLayer.fillColor = UIColor.blackColor().CGColor

// Create the frame for the portion that you want to remove. 
// You could get this from a container view that holds all of 
// the subviews that you want to see behind the overlay.
let rect = CGRectMake(50, 50, 100, 100)

// Create the path.
let path = UIBezierPath(rect: overlay.bounds)
maskLayer.fillRule = kCAFillRuleEvenOdd

// Append the rectangle to the path so that it is subtracted.
path.appendPath(UIBezierPath(rect: rect))
maskLayer.path = path.CGPath

// Set the mask of the view.
overlay.layer.mask = maskLayer

// Add the view so it is visible.
self.view.addSubview(overlay) 
```

以下是上述代码的实际效果：

[![在此处输入图像描述](../Images/407befbed9de8be60363b9e77e15f7d3.png)](https://i.stack.imgur.com/IWOjg.png)

我向 CocoaPods 添加了一个[库](https://github.com/TobogganApps/TAOverlayView)，它允许您创建带有矩形/圆形孔的半透明叠加层，允许用户与叠加层后面的视图进行交互。我用它为我们的一个应用程序创建了本教程：

![使用 TAOverlayView 的教程](../Images/e10a5bf3e586a0bdc839389a2f356536.png)

该库名为[TAOverlayView](https://github.com/TobogganApps/TAOverlayView)，在 Apache 2.0 下是开源的。

# opengl - How to draw a full screen quad and still see the objects behind it

> ID：11731184
> 
> 赞同：1
> 
> 时间：2012-07-30T23:36:29.657
> 
> 标签：opengl

I am creating a 3D game. I have objects in my game. When an enemy hits my position I want my screen to go red for a short time. I have chosen to do this by trying to render a full screen red square at my camera position. This is my attempt which is in my render method.

```
 RenderQuadTerrain();   

    //Draw the skybox
    CreateSkyBox(vNewPos.x,  vNewPos.y,  vNewPos.z,3500,3000,3500);
    DrawCoins();

    CollisionTest(g_Camera.Position().x, g_Camera.Position().y, g_Camera.Position().z);
    DrawEnemy();
    DrawEnemy1();

    //Draw SecondaryObjects models
    DrawSecondaryObjects(); 

    //Apply lighting effects
    LightingEffects();
    escapeAttempt();
if(hitbyenemy==true){
    glEnable(GL_BLEND);
glBlendFunc(GL_ONE, GL_ONE); // additive blending
float blendFactor = 1.0;
glColor3f(blendFactor ,0,0); // when blendFactor = 0, the quad won't be visible. When    blendFactor=1, the scene will be bathed in redness

    glBegin(GL_QUADS);                      // Draw A Quad
    glVertex3f(-1.0f, 1.0f, 0.0f);              // Top Left
    glVertex3f( 1.0f, 1.0f, 0.0f);              // Top Right
    glVertex3f( 1.0f,-1.0f, 0.0f);              // Bottom Right
    glVertex3f(-1.0f,-1.0f, 0.0f);              // Bottom Left
glEnd();
} 
```

All this does, however, is turn all of the objects in my game a transparent colour, and I can't see the square anywhere. I don't even know how to position the quad. I'm very new to openGL.

How my game looks without an attempt to render a quad: ![enter image description here](../Images/8488513e1c7fd0dcf703f37c2f367264.png)

How my game looks after my attempt: ![enter image description here](../Images/b3b46e491c70c9c7caa02737870c450a.png)

With Kevin's code and `glDisable(GL_DEPTH_TEST)`; ![enter image description here](../Images/42ecf0769930a0b9a838d2d798230b51.png)

EDIT: I have changed the code to the below paste..still looks like image 1.

[http://pastebin.com/eiVFcQqM](http://pastebin.com/eiVFcQqM)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:57:18.430

这个问题有几个可能的贡献：

*   您可能需要定期混合，而不是添加剂混合；加法混合不会将白色、黄色或紫色物体变为红色。将混合函数更改为`glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);`并使用颜色`glColor4f(1, 0, 0, blendFactor);`

*   您应该`glDisable(GL_DEPTH_TEST);`在绘制叠加层时防止它被其他几何体隐藏，然后重新启用它（或使用`glPush/PopAttrib(GL_ENABLE_BIT)`）。

*   投影和模型视图矩阵应该是恒等的，以确保具有这些坐标的四边形覆盖整个屏幕。（但是，您可能已经隐含了，因为您说它正在影响全屏，只是方式不正确。）

如果这些建议不能解决问题，请编辑您的问题，显示带有和不带有红色闪光的游戏截图，以便我们更好地理解问题。

# iphone - scrollViewDidEndDecelerating delivers AppDelegate different pointer than awakeFromNib

> ID：11731189
> 
> 赞同：0
> 
> 时间：2012-07-30T23:36:44.647
> 
> 标签：iphone, ios, xcode, uiwebview, delegates

edit 2

I found out it depends on the method used. I somehow lose the appdelegate pointer when I access it via scrollViewDidEndDecelerating instead of awakeFromNib. But I do need to use scrollViewDidEndDecelerating. Can someone of you please fix this?

Works fine

```
- (void)awakeFromNib
{
AppDelegate *mainDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
NSLog(@"%@", [NSString stringWithFormat:@"%@", mainDelegate.content1]);
} 
```

Crashes bad_access to mainDelegate.content1

```
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
AppDelegate *mainDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
NSLog(@"%@", [NSString stringWithFormat:@"%@", mainDelegate.content1]);
} 
```

ORIGINAL QUESTION (I keep this for past-reference. Just read the above functions)

This problem regards stringWithContentsOfURL

The code below works, downloads HTMLstring to mainDelegate.content1 and shows it appropriately in UIWebView controller.myWebView. If I modify the function, so that I conduct the downloading process beforehand, let it be somewhere in AppDelegate.m, the program crashes upon processing mainDelegate.content1 in this very function.

Here goes the good code

```
- (void)ReloadView:(int)page{

MyViewController *controller = [viewControllers objectAtIndex:pageControl.currentPage];

mainDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

NSError * error;
NSURL * Tmpurl;
NSString *tmpContent;
NSString *urlAddress;

urlAddress = mainDelegate.TitleStrP1;
Tmpurl = [NSURL URLWithString:urlAddress];
tmpContent = [NSString stringWithContentsOfURL:Tmpurl encoding:NSUTF8StringEncoding error:&error];

maindelegate.content1 = [NSString stringWithString:tmpContent];

[controller.myWebView loadHTMLString:mainDelegate.content1 baseURL:nil]; 
} 
```

And here what I am trying to do and what doesn't work. SomeFunction executes upon startup of the app. I checked the loaded value after downloading HTMLstring into content1 from the Internet site and html code indeed is there.

```
- (void)ReloadView:(int)page{
MyViewController *controller = [viewControllers objectAtIndex:pageControl.currentPage];
mainDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

//code had been removed here

[controller.myWebView loadHTMLString:mainDelegate.content1 baseURL:nil]; 
}

-(void)SomeFunction{
NSError * error;
NSURL * Tmpurl;
NSString *tmpContent;
NSString *urlAddress;

urlAddress = mainDelegate.TitleStrP1;
Tmpurl = [NSURL URLWithString:urlAddress];
tmpContent = [NSString stringWithContentsOfURL:Tmpurl encoding:NSUTF8StringEncoding error:&error];

maindelegate.content1 = [NSString stringWithString:tmpContent];
} 
```

Your help is appreciated. Thanks

EDIT:

AppDelegate.h

```
#import <UIKit/UIKit.h>

@class ContentController,MyViewController;

@interface AppDelegate : NSObject <UIApplicationDelegate>
{
    ...
    NSString *content1;
    NSString *content2;
}

...
@property (nonatomic, strong) NSString * content1;
@property (nonatomic, strong) NSString * content2; 
```

AppDelegate.m

```
 - (void)applicationDidFinishLaunching:(UIApplication *)application
{
    content1 = [NSString stringWithString:@""];
    content2 = [NSString stringWithString:@""];

NSError * error;
NSURL * Tmpurl;
NSString *tmpContent;
NSString *urlAddress;

urlAddress = TitleStrP1;
Tmpurl = [NSURL URLWithString:urlAddress];
tmpContent = [NSString stringWithContentsOfURL:Tmpurl encoding:NSUTF8StringEncoding error:&error];
content1 = [NSString stringWithString:tmpContent];

urlAddress = TitleStrP2;
Tmpurl = [NSURL URLWithString:urlAddress];
tmpContent = [NSString stringWithContentsOfURL:Tmpurl encoding:NSUTF8StringEncoding error:&error];
content2 = [NSString stringWithString:tmpContent];
...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:52:23.603

appDelegate 中的“Content1”属性是否使用“strong”？此外，要使用属性，您应该使用较低的类，因为 setter 需要将变量名 (setContent1) 大写。那是

```
@property (nonatomic, strong) NSString *content1; 
```

编辑：

[[UIApplication sharedApplication] delegate] 将始终有效。糟糕的是，您没有说那里是否有值（即，它是否为零）。所以其中之一正在发生。

1）您的 AppDelegate 对象正在被释放和释放。我不确定你会如何做到这一点，但它是可能的。

2）您已经告诉 UIApplication 在 main.m 中的“UIApplicationMain()”的第四个参数中创建一个委托，但还在您的 .plist 文件中指定了一个 NIB，并且该 nib 中也有一个 AppDelegate 对象并且已连接作为委托给 UIApplication。如果您使用的是 NIB，则 AppDelegate 的属性属性最好是 STRONG，因为它不被 UIApplication 保留（它在 UIApplication 的委托属性中说明了这一点）。

3) 如果“delegate”属性为 nil，则有人将其设置为 nil。

想一想 - UIApplication 委托很早就设置好了，否则你永远不会收到已启动的消息。

因此，您需要向您的应用程序委托添加一个“dealloc”方法并记录是否发生这种情况。您还可以添加一个简单的“init”方法，该方法还会在创建 AppDelegate 时记录 - 然后看看我的怀疑是否正确。

# objective-c - 创建一个包含多个 NSMutableDictionary 对象的 NSMutableArray

> ID：11731190
> 
> 赞同：1
> 
> 时间：2012-07-30T23:36:48.317
> 
> 标签：objective-c, ios, nsmutablearray, nsdictionary, nsuserdefaults

我环顾四周，看到了几篇关于对包含 NSDictionaries 的 NSMutableArray 进行排序的帖子，但还没有找到一些具体示例来说明如何实际制作由 NSDictionaries 组成的 NSMutableArray。

我正在使用 NSUserDefaults 来跟踪用户对几个不同项目的偏好。NSMutableArray 将用于跟踪总项目，NSDictionaries 用于每个项目的个人偏好。

我编写了这些方法来跟踪我的首选项类中的项目，但我不太确定如何初始化 NMutableArray 以包含 NSDictionaries。

```
-(NSMutableArray *)deviceListArray
{
    return [[NSUserDefaults standardUserDefaults] mutableArrayValueForKey:@"device_list_array"];
}

-(void) setDeviceListArray:(NSMutableArray *)deviceListArray
{
    [[NSUserDefaults standardUserDefaults] setObject:deviceListArray forKey:@"device_list_array"];
} 
```

如果有人能指出我正确的方向，我将不胜感激。非常感谢你！或者，如果有人有更好的策略来跟踪项目，每个项目都有不同的偏好，那也太棒了！

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T23:45:33.620

一旦您将一个对象交给 userDefaults，它就拥有该对象 - 因此您无法更改其中字典的属性。

您可以做的是两次传递副本，其中您有一个本地可变数组，其中包含可变字典。您将创建一个相同大小的新可变数组，然后为每个可变字典调用 [NSDictionary dictionaryWithDictionary:]，将新的非可变字典添加到新数组中。

如果您在字典中隐藏了可变对象，那么您需要为此做同样的事情。

综上所述，如果你有这么多东西，我怀疑你没有正确考虑如何使用默认系统。我几乎总是只保存字符串、数字、颜色等。

编辑：代码

```
NSMutableArray *array = [NSMutableArray arrayWithCapacity:10];

for(int i=0; i<10; ++i) {
  NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithCapacity:10];
  // add stuff to the dictionary
  [array addObject:dict];
}

// later on want to change second dictionary:
NSMutableDictionary *dict = [array objectAtIndex:1];
// fool around with dict
// no need to re-save it in array, since its mutable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T17:11:14.603

不确定这是否是您要查找的内容：

```
 #define kDeviceKey1 @"DeviceKey1"
    #define kDeviceKey2 @"DeviceKey2"
    #define kDeviceKey3 @"DeviceKey3"
    #define kDeviceKey4 @"DeviceKey4"
    #define kDeviceID @"DeviceID"

    NSMutableArray *devices = [[NSMutableArray alloc]init];
    NSMutableDictionary *deviceInfo = [[NSMutableDictionary alloc]init];
    // create a dictionary record for earch device which contains thing...
    // probably employ some kind of loop
    deviceInfo = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                       [NSNumber numberWithInt:1], kDeviceID, 
//                                        @"DeviceName1", kDeviceID,   // or this
                                       @"whateverthing1forDevice1", kDeviceKey1,
                                       @"whateverthing2forDevice1", kDeviceKey2,
                                       @"whateverthing3forDevice1", kDeviceKey3,
                                       @"whateverthing4forDevice1", kDeviceKey4,
                                       nil];

    [devices addObject:deviceInfo];
    // this is just an example, you would have some kind of loop to replace "whateverthing1forDevice1" with actual data
    deviceInfo = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                  [NSNumber numberWithInt:2], kDeviceID,
//                                        @"DeviceName2", kDeviceID,   // or this
                  @"whateverthing1forDevice2", kDeviceKey1,
                  @"whateverthing2forDevice2", kDeviceKey2,
                  @"whateverthing3forDevice2", kDeviceKey3,
                  @"whateverthing4forDevice2", kDeviceKey4,
                  nil];

    [devices addObject:deviceInfo];

    NSLog(@"devices: %@", devices); 
```

# jquery - CORS with Express.js and jQuery.ajax

> ID：11731194
> 
> 赞同：4
> 
> 时间：2012-07-30T23:37:37.847
> 
> 标签：jquery, ajax, node.js, express, cors

I use express.js for my server, with this headers:

```
x-powered-by: Express
connection: keep-alive
content-length: 2
content-type: application/json; charset=utf-8
access-control-allow-methods: GET,PUT,POST,DELETE
access-control-allow-origin: *
access-control-allow-headers: x-requested-with 
```

I call `res.header` to allow CORS:

```
res.header("Access-Control-Allow-Origin:", "*");
res.header("Access-Control-Allow-Methods", "GET,PUT,POST,DELETE");  
res.header("Access-Control-Allow-Headers", "x-requested-with"); 
```

*You can test here : [http://my-api.rs.af.cm/api/products](http://my-api.rs.af.cm/api/products)*

For my front-end, I use jsbin and I call my server with `$.ajax`: [http://jsbin.com/apizez/37/edit](http://jsbin.com/apizez/37/edit)

*Result here: [http://jsbin.com/apizez/37](http://jsbin.com/apizez/37)*

You can look at the JS console, you will see this error:

```
XMLHttpRequest cannot load http://my-api.rs.af.cm/api/products. Origin http://jsbin.com is not allowed by Access-Control-Allow-Origin. 
```

I read all others answers on CORS and I don't want to use easyXDM.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T09:02:34.353

感谢 Ryan Olds 帮助我了解 CORS 请求的工作原理。

这里是正确的标题：

```
res.header('Access-Control-Allow-Origin', req.headers.origin || "*");
res.header('Access-Control-Allow-Methods', 'GET,POST,PUT,HEAD,DELETE,OPTIONS');
res.header('Access-Control-Allow-Headers', 'content-Type,x-requested-with'); 
```

我所有的请求在他们的响应中都有那个标题。

我使用`$.getJSON`jQuery 进行 GET 请求，否则它不起作用。

您可以在此处查看示例：http: [//jsbin.com/uwevuc/2/edit](http://jsbin.com/uwevuc/2/edit)

[http://jsbin.com/uwevuc/2](http://jsbin.com/uwevuc/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-15T00:10:57.270

您还必须考虑您的预检请求。我建议您在项目中添加“cors”npm 包，并使用以下配置启动它：

```
const cors = require('cors');

app.use(cors({
    credentials: true,
    preflightContinue: true,
    methods: ['GET', 'POST', 'PUT', 'PATCH , 'DELETE', 'OPTIONS'],
    origin: true
}); 
```

这将为使用列出的方法的任何地址启用跨域请求。origin 参数非常灵活，您可以分隔一组地址，例如所有地址或通过正则表达式。这是包文档：

[https://expressjs.com/en/resources/middleware/cors.html](https://expressjs.com/en/resources/middleware/cors.html)

# git - Aborting a rebase doesn't work

> ID：11731195
> 
> 赞同：1
> 
> 时间：2012-07-30T23:37:40.547
> 
> 标签：git, git-rebase

I wanted to do an abort on an interactive rebase by doing `git rebase --abort`, but I am getting the error:

```
fatal: Could not parse object '7af12fc7e6ea2bb5231abe39c59cec9539f9536f'. 
```

I've tried resetting the head and it didn't help. Any idea?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T13:37:56.237

您也可以使用此方法中止变基。替换`<branch>`为您碰巧要变基的任何分支：

```
cd .git
rm -rf rebase-merge
cd ..
git checkout <branch> 
```

即，进入`.git`目录，删除 rebase 目录，返回存储库（现在处于分离的 HEAD 状态）并签出分支（将 HEAD 移动到分支尖端）。

# openid - Google Identity ToolKit: createAuthUrl - Invalid Identifier

> ID：11731196
> 
> 赞同：1
> 
> 时间：2012-07-30T23:37:47.760
> 
> 标签：openid, google-openid, google-authentication

I'm working on implementing Google Identity Toolkit in my application. Due to the unique customer requirement (FISMA), App Engine is an unacceptable platform.

I'd like the most seamless single sign on process with Google possible. No buttons, no popups -- just a few redirects. I'm thinking that the createAuthUrl method of the API is a good place to start. However, I can't seem to get it to work. I must be doing something wrong, but I'm totally stuck.

I've included a gist of some code I've tossed together: [https://gist.github.com/5bc9bfb03df34ca93cf3](https://gist.github.com/5bc9bfb03df34ca93cf3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:40:08.630

对于在那里搜索的其他人，我创建了一个代码示例，允许在 Python 中进行 Google-Identity-Toolkit 握手，而无需任何 javascript/fluff。

[https://github.com/richieforeman/google-identity-toolkit-python-silent](https://github.com/richieforeman/google-identity-toolkit-python-silent)

# javascript - Show select box options on external trigger

> ID：11731198
> 
> 赞同：0
> 
> 时间：2012-07-30T23:37:49.867
> 
> 标签：javascript, html, select

Can anyone explain to me how to trigger the "open" event on a select box ?

I've seen many sites hide select boxes and trigger it to open when clicking a div. Unify.js does this. I've gone through every line of code in Unify and I can't find out how to do it

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:19:26.250

睡了之后，我意识到像 Unify 这样的插件不会触发选择元素打开。相反，真正的选择框被放置在人造选择框之上并设置为 0 不透明度。这给人的印象是，当您实际上只是单击/点击不可见的选择元素时，甚至会触发 javascript。

# javascript - 使用 history.back / forward 更改哈希时重新加载页面

> ID：11731201
> 
> 赞同：1
> 
> 时间：2012-07-30T23:38:03.213
> 
> 标签：javascript, url, hash, reload, browser-history

我正在使用主题标签在同一页面上发送/接收值。每次更改哈希值时，我都会在按下按钮并分配值后手动重新加载页面。例如

```
<input type="button" value="go to step 2" onclick="reloadpage();"

function reloadpage() {

window.location.hash = "val1:xxx,val2:yyy,val3:zzz";
window.location.reload(); 
```

}

如果用户按下浏览器的后退或前进按钮，则 url 哈希会更改，但页面不会重新加载。有什么方法可以检测 history.change 并刷新页面吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:05:55.253

最后我使用了 jQuery hashchange 事件。

它通过跨浏览器 HTML5 window.onhashchange 事件启用非常基本的可书签 #hash 历史记录。

[链接到带有源的页面](http://benalman.com/projects/jquery-hashchange-plugin/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T23:41:41.527

使用现代 html5 [pushState](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history/)。

# javascript - Javascript convert string into function name

> ID：11731211
> 
> 赞同：5
> 
> 时间：2012-07-30T23:39:23.523
> 
> 标签：javascript

> **Possible Duplicate:**
> [Call a JavaScript function name using a string?](https://stackoverflow.com/questions/496961/call-a-javascript-function-name-using-a-string)
> [javascript string to variable](https://stackoverflow.com/questions/4639837/javascript-string-to-variable)

I have this code:

```
var Functionify = function() {

    return {

        init: function(el, t) {
            var els = document.getElementsByClassName(el);
            var elsL = els.length;

            while(elsL--){
                //els[elsL].onclick = els[elsL].getAttribute(t);
                els[elsL].addEventListener('click', els[elsL].getAttribute(t), false);
            }
        }

    };

}(); 
```

Where `el = 'myClassName'` and `t = 'data-id'`

Now, 't' is a string, how can tell the addEventListener function to use 't' (a string) as a function name?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-30T23:48:06.467

在全局命名空间中，您可以执行以下操作：

```
this.test = function() {
    alert('test');
}

window['test'](); 
```

然而，更好的选择是使您的函数成为您创建的对象的方法，而不是全局`window`对象的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:50:15.960

使用 eval() 被认为是“邪恶的”，尤其是在 Danila 给出的示例中——任何 JS 片段都将/可以在 eval() 中执行。epascarello 所述的最佳选择是使用方括号表示法来调用命名函数。但是，应该注意的是，windowt 将调用全局命名空间中的函数——如果该函数是对象的方法，则应照此引用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T23:44:02.647

我不确定你为什么要这样做，如果函数是全局范围的一部分，你可以使用括号表示法。

```
window["stringName"](); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T23:43:01.763

Use eval() function

Example:

```
a = "alert(1)"

eval(a) 
```

# mobile - trigger.io 应用程序上的开发和生产配置

> ID：11731222
> 
> 赞同：2
> 
> 时间：2012-07-30T23:41:04.087
> 
> 标签：mobile, trigger.io

我们的移动应用程序与后端 API 进行通信。我们希望能够在开发期间查询后端的分阶段副本，并在生产期间查询实时版本。

我们需要能够动态地配置我们的应用程序以`stage.example.com`在开发`example.com`期间和生产期间进行查询。

如何使用 Trigger.io forge 轻松管理这些配置参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:51:33.573

一种方法是使用我们的[参数模块](http://docs.trigger.io/en/v1.4/modules/parameters.html)

这将允许您在构建时将标志传递到您的代码中，然后您的 JavaScript 可以使用该标志来改变其操作，例如

在 config.json 中：

```
{
    "modules": {
        "parameters": {
             "production": false
        }
    }
} 
```

在您的 JavaScript 中：

```
if (forge.config.modules.parameters.production) {
    server_url = "example.com";
} else {
    server_url = "staging.example.com";
    forge.enableDebug();
    alert("Set production flag to true before packaging!");
} 
```

# .htaccess - replace ampersand with question mark for only one php

> ID：11731223
> 
> 赞同：1
> 
> 时间：2012-07-30T23:41:18.657
> 
> 标签：.htaccess

This URL 1 is not working URL 2 is working fine. So the condition should be "after byod.php remove ampersand and put question mark" only for byod.php not for other php scrips

```
1\.   http://10.168.4.253/byod.php&redirect=www.google.com.sg/search?q=cars........

2\.   http://10.168.4.253/byod.php?redirect=www.google.com.sg/search?q=cars........ 
```

Is this possible using htaccess

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:03:40.097

就像[您问的上一个问题](https://stackoverflow.com/questions/11730114/replac-ampersand-with-question-mark)一样，如果您只希望它适用于`byod.php`您需要在匹配中指定：

```
RewriteRule ^byod\.php&(.*)$ /byod.php?$1 [L,QSA,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:20:35.830

您可能应该`mod_rewrite`为您的网络服务器挖掘或类似的工具。

# c - dladdr doesn't return the function name

> ID：11731229
> 
> 赞同：10
> 
> 时间：2012-07-30T23:41:34.977
> 
> 标签：c, linux, elf

I'm trying to use dladdr. It correctly locates the library, but it does not find the function name. I can call objdump, do a little math, and get the address of the function that I pass dladdr. If objdump can see it, why can't dladdr?

Here is my function:

```
const char *FuncName(const void *pFunc)
{
Dl_info  DlInfo;
int  nRet;

    // Lookup the name of the function given the function pointer
    if ((nRet = dladdr(pFunc, &DlInfo)) != 0)
        return DlInfo.dli_sname;
    return NULL;
} 
```

Here is a gdb transcript showing what I get.

```
Program received signal SIGINT, Interrupt.
[Switching to Thread 0xf7f4c6c0 (LWP 28365)]
0xffffe410 in __kernel_vsyscall ()
(gdb) p MatchRec8Cmp
$2 = {void (TCmp *, TWork *, TThread *)} 0xf1b62e73 <MatchRec8Cmp>
(gdb) call FuncName(MatchRec8Cmp)
$3 = 0x0
(gdb) call FuncName(0xf1b62e73)
$4 = 0x0
(gdb) b FuncName
Breakpoint 1 at 0xf44bdddb: file threads.c, line 3420.
(gdb) call FuncName(MatchRec8Cmp)

Breakpoint 1, FuncName (pFunc=0xf1b62e73) at threads.c:3420
3420    {
The program being debugged stopped while in a function called from GDB.
When the function (FuncName) is done executing, GDB will silently
stop (instead of continuing to evaluate the expression containing
the function call).
(gdb) s
3426            if ((nRet = dladdr(pFunc, &DlInfo)) != 0)
(gdb) 
3427                    return DlInfo.dli_sname;
(gdb) p DlInfo 
$5 = {dli_fname = 0x8302e08 "/xxx/libdata.so", dli_fbase = 0xf1a43000, dli_sname = 0x0, dli_saddr = 0x0}
(gdb) p nRet
$6 = 1
(gdb) p MatchRec8Cmp - 0xf1a43000
$7 = (void (*)(TCmp *, TWork *, TThread *)) 0x11fe73
(gdb) q
The program is running.  Exit anyway? (y or n) y 
```

Here is what I get from objdmp

```
$ objdump --syms /xxx/libdata.so | grep MatchRec8Cmp
0011fe73 l     F .text  00000a98              MatchRec8Cmp 
```

Sure enough, 0011fe73 = MatchRec8Cmp - 0xf1a43000\. Anyone know why dladdr can't return dli_sname = "MatchRec8Cmp" ???

I'm running Red Hat Enterprise Linux Server release 5.4 (Tikanga). I have seen this work before. Maybe it's my compile switches:

```
CFLAGS = -m32 -march=i686 -msse3 -ggdb3 -pipe -fno-common -fomit-frame-pointer \
        -Ispio -fms-extensions  -Wmissing-declarations -Wstrict-prototypes -Wunused  -Wall \
        -Wno-multichar -Wdisabled-optimization -Wmissing-prototypes -Wnested-externs \
        -Wpointer-arith -Wextra -Wno-sign-compare -Wno-sequence-point \
        -I../../../include -I/usr/local/include -fPIC \
        -D$(Uname) -D_REENTRANT -D_GNU_SOURCE 
```

I have tried it with -g instead of -ggdb3 although I don't think debugging symbols have anything to do with elf.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T04:00:04.047

> 如果objdump可以看到，为什么dladdr看不到

`dladdr`只能看到动态符号表中*导出的函数。*最有可能的

```
 nm -D /xxx/libdata.so | grep MatchRec8Cmp 
```

什么都不显示。实际上，您的 objdump 显示该符号是*local*，这证明这是原因。

该符号是本地的，因为它具有隐藏的可见性，是静态的，或者因为您以其他方式隐藏它（例如使用链接器脚本）。

更新：

> 那些标有“U”的人与 dladdr 一起工作。它们以某种方式自动“导出”。

它们之所以起作用，是因为它们是从*其他一些共享库*中导出的。`U`代表未解决，即在别处定义。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-05-25T10:08:26.330

我添加`-rdynamic`到我的 LDFLAGS 中。

`man gcc`说：

```
-rdynamic
    Pass the flag -export-dynamic to the ELF linker, on targets that support it. This instructs the linker to add all symbols, not only used ones, to the
    dynamic symbol table. This option is needed for some uses of "dlopen" or to allow obtaining backtraces from within a program. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T21:50:01.853

添加 gcc 选项“-export-dynamic”为我解决了这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-09T03:48:04.763

hinesmr 解决方案对我有用。我通过 gcc 的确切选项是“-Wl，--export-dynamic”，所有函数都对 dladdr 可见

# c# - Thread.Sleep() usage to Prevent Server Overload

> ID：11731234
> 
> 赞同：1
> 
> 时间：2012-07-30T23:42:41.513
> 
> 标签：c#, multithreading

I wrote some code that mass imports a high volume of users into AD. To refrain from overloading the server, I put a thread.sleep() in the code, executed at every iteration.

Is this a good use of the method, or is there a better alternative (.NET 4.0 applies here)?

Does Thread.Sleep() even aid in performance? What is the cost and performance impact of sleeping a thread?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:46:16.740

该`Thread.Sleep()`方法只会将线程置于暂停状态一段指定的时间。我可以告诉你，有 3 种不同`Sleep()`的方法可以从三种不同的类型中实现相同的调用方法。它们都有不同的特点。无论如何最重要的是，如果您`Sleep()`在主 UI 线程上使用，它将在暂停期间停止处理消息，并且 GUI 看起来会被锁定。您需要使用 BackgroundWorker 来运行您需要休眠的作业。

我的意见是使用 Thread.Sleep() 方法并遵循我之前的建议。在您的具体情况下，我想您不会有任何问题。如果你努力寻找关于 SO 的相同主题，我相信你会找到关于我之前总结的更好的解释。

如果您无法从被调用服务接收反馈，就像在典型的事件驱动系统上发生的那样（抽象地说......我们也可以说回调或任何信息以了解服务如何受您的调用影响），睡眠可能是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:51:12.107

如果您想要的不是使服务器超载，则可以降低线程的优先级。

`Thread.Sleep()`不消耗任何资源。但是，正确的方法是将线程的优先级设置为低于 Normal 的值：`Thread.Current.Priority = ThreadPriority.Lowest`例如。

`Thread.Sleep`不是“邪恶，永远不要这样做”，但也许（只是也许）你需要使用它的事实反映了解决方案设计的一些不足。但这根本不是规则。

就我个人而言，我从来没有发现必须使用 Thread.Sleep 的*情况*。现在我正在开发一个 ASP.NET MVC 应用程序，它使用后台线程将大量数据从数据库加载到内存缓存中，然后将一些数据写入数据库。我用来防止这个线程吃掉我所有的网络服务器和数据库处理器的唯一功能是将线程优先级降低到最低级别。如果使用普通优先级线程，该线程将需要大约 35 分钟来结束所有操作，而不是 7 分钟。在进程结束时，线程将对数据库服务器进行大约 230k 次选择，但这并没有以用户感知的方式影响我的数据库或 Web 服务器的性能。

**提示：**如果您使用 ThreadPool 中的线程，请记住将优先级设置回 Normal。

在这里您可以阅读有关 Thread.Priority 的信息：http: [//msdn.microsoft.com/en-us/library/system.threading.thread.priority.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread.priority.aspx)

这里有一篇关于为什么不在生产环境中使用 Thread.Sleep 的好文章：http: [//msmvps.com/blogs/peterritchie/archive/2007/04/26/thread-sleep-is-a-sign-of-a-poorly -设计程序.aspx](http://msmvps.com/blogs/peterritchie/archive/2007/04/26/thread-sleep-is-a-sign-of-a-poorly-designed-program.aspx)

**编辑**就像其他人在这里所说的那样，也许只是降低您的线程优先级不会阻止线程向 AD 发送大量命令/数据。如果你重新考虑所有事情并使用计时器或类似的东西，也许你会得到更好的结果。我个人认为降低优先级可以解决您的问题，尽管我认为您需要使用*您的数据*进行一些测试，以查看您的服务器和该过程中涉及的其他服务器会发生什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T00:05:12.533

我认为 Thread.Sleep 是处理这个问题的一种方法；@cHao 是正确的，使用计时器可以让您以另一种方式执行此操作。本质上，您是在尝试减少一段时间内发送到 AD 服务器的命令数量。

在使用计时器时，您将需要设计一种检测故障的方法（这比 try/catch 更直观）。例如，如果您的服务器开始停止并且响应变慢，您将继续堆叠服务器无法处理的命令（这可能会导致其他错误）。

在使用 AD 时，我看到域控制器在过多的命令进入（类似于 DOS 攻击）并导致服务器爬行或崩溃时崩溃。我认为通过使用 sleep 方法，您正在创建一个可管理和可测量的流程。

在这种情况下，使用具有低优先级的线程*可能会*减慢它的速度，但不会降低到任何可控的水平。线程优先级只是发送命令的机器的一个因素，而不是必须处理它们的服务器。

希望这可以帮助; 干杯！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T00:06:09.447

Thread.Sleep() 是一种无 CPU 的等待状态。它的开销应该很小。如果 execute `Thread.Sleep(0)`，您不会 [必然] 睡眠，但您会自愿放弃您的时间片，以便调度程序可以让较低优先级的线程运行。

您还可以通过设置来降低线程的优先级`Thread.Priority`。

另一种限制任务的方法是使用[`Timer`](http://msdn.microsoft.com/en-us/library/system.threading.timer)：

```
// instantiate a timer that 'ticks' 10 times per second (your ideal rate might be different)
Timer timer = new Timer( ImportUserIntoActiveDirectory , null , 0 , 100 ) ; 
```

`ImportUserIntoActiveDirectory`将仅将用户导入 AD 的事件处理程序在哪里：

```
private void ImportUserIntoActiveDirectory( object state )
{
  // import just one user into AD
  return
} 
```

这使您可以拨入。事件处理程序在线程池工作线程上调用，因此您不会占用主线程。让操作系统为您完成工作：您所做的只是决定您的目标交易率。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T23:53:18.280

您可以改为`BelowNormal` [优先](http://msdn.microsoft.com/en-us/library/system.threading.thread.priority.aspx)安排线程。也就是说，如果其他东西使服务器过载，这可能会导致您的任务永远不会运行。（假设 Windows 调度按照[调度线程文档中](http://msdn.microsoft.com/en-us/library/2k34xtf3.aspx)提到的“某些操作系统”的方式工作。）

也就是说，您说您正在将数据移动到 AD 中。如果超出了网络，那么与 AD 端的 I/O 和处理相比，您的代码对 CPU 的影响完全可以忽略不计。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-30T23:54:50.523

我没有看到任何问题，除了在您让线程进入睡眠状态期间，该线程将不会响应。如果那是您的主线程，那么您的 GUI 将变得无响应。如果它是后台线程，那么您将无法与它通信（例如取消它）。如果你睡觉的时间很短，那应该没关系。

我不认为降低线程的优先级会有所帮助，因为 1）您的代码甚至可能不在服务器上运行，并且 2）服务器完成的大部分工作可能不会在您的线程上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-30T23:55:36.840

Thread.sleep 不会提高性能（除非您的线程必须等待一些资源）。它至少会产生一些开销，并且无法保证您的睡眠时间。操作系统可以决定让您的线程睡眠时间长于您指定的时间。

因此，在调用 Thread.Sleep() 之间做大量工作会更有意义。

# javascript - checking to have the matched class names and do something

> ID：11731240
> 
> 赞同：1
> 
> 时间：2012-07-30T23:43:42.383
> 
> 标签：javascript, jquery

i want to check if i have elements with a matched className that is being dynamically generated and apply some code in this case :

say:

```
<div class="c red"></div>
<div class="c green"></div>
<div class="c red"></div>
<div class="c yellow"></div>
<div class="c red"></div> 
```

i want to check if for those tags that has class "red" and apply something to them but keep in mind that i cant call the $(".red") element directly because it can vary each time the page load and become diffrent color next time , so i want a generic solution to check if there is a match in class names in the document

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T23:44:58.880

使用 jQuery：

```
$('div.c').each(function(_, div) {
    if( $(div).hasClass( 'red' ) ) {
        // this div node has a class called 'red'
    }
}); 
```

您可以使用`.hasClass()`或`.is()`确定。请注意，在使用时，`.is()`您需要使用前导点来限定字符串，例如`'.red'`.

使用香草 Javascript：

```
[].forEach.call( document.querySelectorAll( 'div.c' ), function( div ) {
    if( div.classList.contains( 'red' ) ) {
        // this div node has a class called 'red'
    }
}); 
```

# c# - MySQL Data Statistics

> ID：11731241
> 
> 赞同：0
> 
> 时间：2012-07-30T23:43:44.600
> 
> 标签：c#, mysql, database, statistics

So, we have a table that basically includes most of the ticket details of a ticket, except for stuff that is horribly long (like notes, tech notes, pictures, etc), those are linked elsewhere in other tables, etc.

We want to return metrics about the various tickets in the data table. For example:

```
SELECT Category, Count(Category) FROM tickets 
WHERE Date_SUB(CURDATE(), Interval 16 Hour) <= Datez GROUP BY Category 
```

Which would return a result listing, for example, each of our categories, and their counts.

However, if we want to adjust this for various intervals, like return the numbers for say `16 hours`, `1 day`, `30 day`, `3 month`, `12 month` and `All time`, are we going to have to run that same query that # of times (like for each of those listed minus all time, run that query 5 times?

Ultimately, we want to use the counts in a dashboard of some sort in our C# Winforms application, that will show us various ticket data, so we can see how the department is doing; but, if we have to sit there and run say 5 queries every few minutes, that can tend to bog down the system no?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:57:26.037

你可以尝试这样的事情：

```
SELECT
    Category,
    IF(Date_SUB(CURDATE(), Interval 16 Hour) <= Datez, SUM(1), 0) AS c16hours,
    IF(Date_SUB(CURDATE(), Interval 1 day) <= Datez, SUM(1), 0) AS c1day,
    IF(Date_SUB(CURDATE(), Interval 30 days) <= Datez, SUM(1), 0) AS c30days,
    (...)
FROM tickets 
GROUP BY Category 
```

这应该可行（但我没有测试过这个例子，只是给你一些理论）！

祝你好运。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-30T23:53:35.780

我相信你也可以在 WHERE 语句之后添加一个 AND 语句来继续列表。

这将定义。缩短它

# soap - ColdFusion CFHTTP 连接到远程 Web 服务

> ID：11731245
> 
> 赞同：0
> 
> 时间：2012-07-30T23:44:44.073
> 
> 标签：soap, coldfusion

[我已使用 SOAPUI ( www.soapui.org](http://www.soapui.org) )成功连接到远程 Web服务。但是，我无法从 CF9.2 成功调用它。

这是我的整个 CFC 函数。有动态变量，但我已经在soapUI界面中测试了输出并且它可以工作：

```
<cffunction name="getOrganisation" access="remote" returnType="any" output="true">

     <cfargument name="iPageNumber" type="any" required="false" default="0">
     <cfargument name="iPageSize" type="any" required="false" default="0">
     <cfargument name="bCurrentNamesOnly" type="boolean" required="false" default="1">
     <cfargument name="bExcludeNotRtos" type="boolean" required="false" default="0">
     <cfargument name="bExcludeRtoWithoutActiveRegistration" type="boolean" required="false" default="0">
     <cfargument name="sFilter" type="any" required="false" default="">
     <cfargument name="bIncludeCode" type="boolean" required="false" default="1">
     <cfargument name="sRegistrationManagers" type="any" required="false" default="">
     <cfargument name="sClassificationFilters" type="any" required="false" default="">
     <cfargument name="sScheme" type="any" required="false" default="">

     <cfset var endpoint = "https://ws.staging.training.gov.au/Deewr.Tga.WebServices/OrganisationService.svc/Organisation">

     <cfsavecontent variable="soapBody">
          <cfoutput>
               <soapenv:Envelope
                    xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
                    xmlns:ser="http://training.gov.au/services/" 
                    xmlns:arr="http://schemas.microsoft.com/2003/10/Serialization/Arrays"> 
                   <soapenv:Header/>               
                        <soapenv:Body>        
                        <ser:Search>
                            <ser:request>
                                <ser:PageNumber>#arguments.iPageNumber#</ser:PageNumber>
                                <ser:PageSize>#arguments.iPageSize#</ser:PageSize>
                                <ser:ClassificationFilters>
                                   <ser:ClassificationFilter>
                                      <ser:Scheme>#arguments.sScheme#</ser:Scheme>
                                      <ser:Values>
                                         <cfif len(arguments.sClassificationFilters)>
                                            <cfloop list="#arguments.sClassificationFilters#" index="item">
                                                <arr:string>#item#</arr:string>
                                            </cfloop>
                                        </cfif>
                                      </ser:Values>
                                   </ser:ClassificationFilter>
                                </ser:ClassificationFilters>
                                <ser:CurrentNamesOnly>#arguments.bCurrentNamesOnly#</ser:CurrentNamesOnly>
                                <ser:ExcludeNotRtos>#arguments.bExcludeNotRtos#</ser:ExcludeNotRtos>
                                <ser:ExcludeRtoWithoutActiveRegistration>#arguments.bExcludeRtoWithoutActiveRegistration#</ser:ExcludeRtoWithoutActiveRegistration>
                                <ser:Filter>#arguments.sFilter#</ser:Filter>
                                <ser:IncludeCode>#arguments.bIncludeCode#</ser:IncludeCode>
                                <ser:RegistrationManagers>
                                   <cfif len(arguments.sRegistrationManagers)>
                                        <cfloop list="#arguments.sRegistrationManagers#" index="item">
                                            <arr:string>#item#</arr:string>
                                        </cfloop>
                                    </cfif>
                                </ser:RegistrationManagers>
                             </ser:request>
                        </ser:Search>
                    </soapenv:Body>
                </soapenv:Envelope>
            </cfoutput>            
        </cfsavecontent>

        <cfhttp
                url="#endpoint#" 
                method="post"
                username="#variables.username#"
                password="#variables.password#">

                <cfhttpparam type="header" name="accept-encoding" value="no-compression" />
                <cfhttpparam type="xml" value="#trim(soapBody)#"/>

        </cfhttp>

       <cfdump var="#cfhttp.FileContent#"><cfabort>

      <cfreturn cfhttp.FileContent>
</cffunction> 
```

运行这个，我得到错误：

```
An error occurred when verifying security for the message. 
```

以下是完整的返回 xml

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
    <s:Body>
        <s:Fault>
            <faultcode xmlns:a="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">a:InvalidSecurity</faultcode>
            <faultstring xml:lang="en-AU">An error occurred when verifying security for the message.</faultstring>
        </s:Fault>
    </s:Body>
</s:Envelope> 
```

因此，这似乎是一个授权问题。

这是 SoapUI 请求屏幕：

![在此处输入图像描述](../Images/b022ad8cfc2f45d9048a602cbd7538c2.png)

那么，如何构造 cfhttp 或者 cfinvoke 来模拟soapUI 调用？

## 编辑

SOAP 请求 XML

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ser="http://training.gov.au/services/" xmlns:arr="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
   <soapenv:Header/>
   <soapenv:Body>
      <ser:Search>
         <ser:request>
            <ser:PageNumber>0</ser:PageNumber>
            <ser:PageSize>0</ser:PageSize>
            <ser:ClassificationFilters>
               <ser:ClassificationFilter>
                  <ser:Scheme></ser:Scheme>
                  <ser:Values>
                     <arr:string></arr:string>
                  </ser:Values>
               </ser:ClassificationFilter>
            </ser:ClassificationFilters>
            <ser:CurrentNamesOnly>true</ser:CurrentNamesOnly>
            <ser:ExcludeNotRtos>0</ser:ExcludeNotRtos>
            <ser:ExcludeRtoWithoutActiveRegistration>0</ser:ExcludeRtoWithoutActiveRegistration>
            <ser:Filter></ser:Filter>
            <ser:IncludeCode>1</ser:IncludeCode>
            <ser:RegistrationManagers>
               <arr:string></arr:string>
            </ser:RegistrationManagers>
         </ser:request>
      </ser:Search>
   </soapenv:Body>
</soapenv:Envelope> 
```

## 编辑 2

更多信息：

*   这是直接指向该服务的网址：[https ://ws.staging.training.gov.au/Deewr.Tga.WebServices/OrganisationService.svc](https://ws.staging.training.gov.au/Deewr.Tga.WebServices/OrganisationService.svc)
*   以下是文档中一些身份验证相关信息的屏幕截图 ![在此处输入图像描述](../Images/8b5c5f9543e4c3cc6d4f2cb4bf42e273.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T08:20:41.947

SOAPUI 是一个很棒的工具，我最近在调试 SOAP 请求或将它们从静态 .wsdl 文件传输到 ColdFusion 组件时经常使用它。

首先要查看的是错误消息本身：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <s:Fault>
      <faultcode xmlns:a="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">a:InvalidSecurity</faultcode>
      <faultstring xml:lang="en-AU">An error occurred when verifying security for the message.  </faultstring>
    </s:Fault>
  </s:Body>
</s:Envelope> 
```

faultcode 节点包含指向 OASIS 安全命名空间文档的链接：

[http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd)

在浏览器中查看，您可以看到需要哪些安全值，并且可以阐明命名约定。因此，我们可以从中确认您确实需要使用以下格式发送以下内容：

*   用户名
*   密码

在无法访问您在 SOAPUI 中测试的请求的情况下，我们还可以看到 Username 和 Password 值在属性窗口中可见（您从上面的界面抓取屏幕）。

这些值是否在 SOAPUI 中请求的 XML 中设置？也许在 SOAP 请求标头中，如下所示：

```
<soapenv:Header>
  <authInfo xsi:type="soap:authentication">
    <Username xsi:type="xsd:string">?</Username>
    <Password xsi:type="xsd:string">?</Password>
  </authInfo>
</soapenv:Header> 
```

如果是这种情况，您还需要在构建soapBody 变量时在您的ColdFusion 组件中包含此标头。

另外，您可以直接在浏览器中查看 SOAP 请求的 URL 以了解它期望的变量吗？

[https://ws.staging.training.gov.au/Deewr.Tga.WebServices/OrganisationService.svc/Organisation](https://ws.staging.training.gov.au/Deewr.Tga.WebServices/OrganisationService.svc/Organisation)

您的 CFC 和 soapBody 的整体结构看起来不错，因此无法访问您在 SOAPUI 中运行的文件以查看它的运行、调试它并提供答案会有点棘手。

如果您可以排除上述所有可能性但仍有问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:01:07.323

我认为您需要在 cfhttpparam 标记中发布用户名和密码，而不是作为 cfhttp 标记中的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T23:02:22.757

是的，您最初并没有传递 Oasis 安全标头。然而，到目前为止，这里的答案可能不会奏效。Oasis 标准可以允许用户/密码/nonce/digest/created 和编码属性的多种不同组合。

您可能发现也可能没有发现，Axis 1 库（CF9 和更低的用户 Axis 1（版本 1.1-1.4）；CF10 也有 Axis 2（Axis 版本 1.6））。因此，您必须通过 POST (cfhttp/http) 来传递和接收 Oasis 标头。Axis 1 库会因为试图理解标题区域中的 Oasis 节点而哭泣。**

由于您*是*手动发布的，因此您可以简单地在您的标题中构建您的 Oasis 标题，就像 Matt Gifford 的示例一样。

根据接收方的确切期望，您可能会遇到以下情况：

```
<wsse:Security soap:mustUnderstand="true" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  <wsse:UsernameToken wsu:Id="UsernameToken-15">
    <wsse:Username>
      <!-- Removed-->
    </wsse:Username>
    <wsse:Password>
      <!-- Removed-->
    </wsse:Password>
    <wsse:Nonce>
      <!-- Removed-->
    </wsse:Nonce>
    <wsu:Created>2012-07-11T02:02:48.410Z</wsu:Created>
  </wsse:UsernameToken>
</wsse:Security> 
```

或者这个（来自早期包层方法预输出）：

```
<wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" soapenv:mustUnderstand="1">
  <wsse:UsernameToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" >
  <wsse:Username>#Arguments.szUserName#</wsse:Username>
  <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0##PasswordText">#Arguments.szPassword#</wsse:Password>
  </wsse:UsernameToken>
</wsse:Security> 
```

或者这个（最终输出）：

```
<wsse:Security soapenv:mustUnderstand="1"xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
  <wsse:UsernameToken wsu:Id="UsernameToken-974900"xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
    <wsse:Username>SuperJellyMan</wsse:Username>
    <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">jellybeanboom</wsse:Password>
    <wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">SmVsbHlCZWFuQm9vbTk3NDkwMA==</wsse:Nonce>
    <wsu:Created>2012-07-26T17:00:34Z</wsu:Created>
  </wsse:UsernameToken>
</wsse:Security> 
```

等等等等。我见过人们调用 java 库来更动态地执行此操作。我只是构建了一些简单的方法来构建我的 nonce 并格式化我的 xml 时间戳。但基本上，构建某种函数或其他辅助方法以使用适当的 Oasis 属性和 xsd 引用来覆盖 xml 中所需的值，然后将其插入手动发布请求的标题中是非常简单的。

棘手的部分是如果他们不告诉您，他们确切地知道 Oasis 安全标头中想要什么。xsd 仅显示根据 Oasis 标准可以接受的内容，但不一定显示他们正在使用什么（以及以何种组合方式）。如果你能从他们那里得到，你可以很容易地从 Oasis 文档中把它们放在一起。

通常，组合是用户/密码（第一个示例）。如果使用 Nonce，通常还会使用密码摘要（密码获取 ##PasswordDigest 而不是 ##PasswordText），并且是创建时间和密码的编码散列（有关更多说明，请参阅 Oasis 文档）。

但是，我从事的最后一个项目有一个纯文本密码加上一个没有摘要的随机数。不完全合乎逻辑，因为随机数应该使虚假请求更加困难并使用需要由接收者解码并与验证进行比较的非明文密码......所以这完全取决于他们想要什么的服务/使用/需要。

您应该能够将您编造的 Oasis 标头粘贴到 SoapUI 中，并很快从他们的响应中找出他们可能需要/想要的内容。

如果他们指定了用户/密码（作为文本），您可能会发现这些示例之一（可能是第二个）是可行的，并且没有传递 nonce 和 created 元素。

** 当 Oasis 与 CF9 或更少使用实际 SOAP 方法（Web 服务存根，而不是手动发布）一起使用时，这里是 Axis 1 故障的有趣参考：**

调用 Web 服务操作时返回的错误是：

```
AxisFault faultCode：{ http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd }InvalidSecurity faultSubcode：faultString：验证消息安全性时出错. 故障演员：故障节点：
faultDetail: { http://xml.apache.org/axis/ }stackTrace：验证消息的安全性时发生错误。在 org.apache.axis.message.SOAPFaultBuilder.createFault(SOAPFaultBuilder.java:221) 在 org.apache.axis.message.SOAPFaultBuilder.endElement(SOAPFaultBuilder.java:128) 在 org.apache.axis.encoding.DeserializationContext.endElement （反序列化上下文.java:1087）
在 org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source) at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source) at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)在 org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source) 在 org.apache.xerces.parsers.XML11Conf...
```

[编辑] 这里有更多信息，因为我正在开发另一个类似的网络服务。您的 [SOAP] xml 不可能正常工作。我也使用soapUI，除非我在适当的位置添加安全标头值，否则服务将准确返回您收到的响应（“InvalidSecurity”），因此不太确定该xml 是您应该尝试复制的内容。我还成功构建了一个简单的基于 cf 的脚本版本来构建正确生成标题并将其添加到 createObject() 调用的 javastubbed webservice 的标题：

```
doc = xmlNew();
doc['Security'] = XmlElemNew(doc,'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd', 'Security');
doc.Security['UsernameToken'] = XmlElemNew(doc,  'UsernameToken');
doc.Security.UsernameToken['Username'] = XmlElemNew(doc,  'Username');
doc.Security.UsernameToken.username.XmlText = "TESTERDUDE" ;
doc.Security.UsernameToken.username.XmlAttributes["xsi:type"] = "xsd:string";
doc.Security.UsernameToken['Password'] = XmlElemNew(doc, 'Password');
doc.Security.UsernameToken.password.XmlText = "YetAnotherPassword";
doc.Security.UsernameToken.password.XmlAttributes["xsi:type"] = "xsd:string";
doc.Security.UsernameToken.password.XmlAttributes["Type"] = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0##PasswordDigest";
doc.Security.UsernameToken['Nonce'] = XmlElemNew(doc, 'Nonce');
doc.Security.UsernameToken.nonce.XmlText = "tKUH8ab3Rokm4t6IAlgcdg9yaEw="; // This would be generated if needed
doc.Security.UsernameToken.nonce.XmlAttributes["xsi:type"] = "xsd:string";
doc.Security.UsernameToken['Created'] = XmlElemNew(doc, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd", 'Created');
doc.Security.UsernameToken.created.XmlText = "2010-08-10T10:52:42Z";
doc.Security.UsernameToken.created.XmlAttributes["xsi:type"] = "xsd:string";
addSOAPRequestHeader(ws, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", "Security", doc); 
```

这会正确生成 [使用获取整个 xml 请求的 getSoapRequest() 从服务器端 xml 获取]：

```
<soapenv:Header>
  <Security soapenv:actor="" soapenv:mustUnderstand="0" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:ns1="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
    <UsernameToken>
      <Username xsi:type="xsd:string">TESTERDUDE</Username>
      <Password xsi:type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">My Password is my Voice</Password>
      <Nonce xsi:type="xsd:string">tKUH8ab3Rokm4t6IAlgcdg9yaEw=</Nonce>
     <Created xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:ns2="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xsi:type="xsd:string">2010-08-10T10:52:42Z</Created>
    </UsernameToken>
  </Security>
</soapenv:Header> 
```

# javascript - 使用没有 Flash 的 javascript 重定向

> ID：11731252
> 
> 赞同：0
> 
> 时间：2012-07-30T23:45:39.050
> 
> 标签：javascript, jquery

我尝试执行以下操作：

我想使用 javascript 重定向到另一个页面，但我希望页面（我们重定向到的）淡入而不是被积极地重定向到。我怎样才能使用 jquery 完成呢？

我尝试了以下方法：

```
$('.splash').hide();

$('.splash').fadeIn(2000,
      function() {
            setTimeout(
                  function() {
                        document.location.href = 'test.html';
                  },100)

<div class = "splash"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:47:49.510

好吧，您可以`$('html').fadeOut();`在当前页面上，然后进行重定向。但是第二页必须有它自己的`$('html').fadeIn();`

不幸的是，无法将 jQuery 执行推送到完全独立的页面上：/

您也可以尝试使用`$.load()`AJAX 样式加载页面。

# android - 将 android 模拟器快照移动到另一台计算机

> ID：11731254
> 
> 赞同：2
> 
> 时间：2012-07-30T23:45:58.763
> 
> 标签：android, emulation, snapshot

因此，我需要制作一张可供多人/跨多台计算机使用的快照。我正在做一些测试，需要设置很多东西来测试一件事。设置需要一段时间，我希望能够只创建一个 avd 并让几个人使用它。我认为我可以通过制作一个然后拍摄快照来做到这一点，但无论我做什么，我都无法让它发挥作用。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T10:45:05.670

您需要分发：

*   文件 $HOME/.android/avd/< avdname >.ini

*   $HOME/.android/avd/<avdname> 目录中的一些文件：config.ini, *.img

在新计算机上部署时，只需在 <avdname>.ini 文件中修复绝对路径。

# java - How to verify a specific expected method in easymock

> ID：11731256
> 
> 赞同：0
> 
> 时间：2012-07-30T23:46:07.397
> 
> 标签：java, unit-testing, easymock

How can I use Easymock.verify(mockedObject); to check only a specific expected method call on that mocked object instead of checking all the expected methods.

In another words how can I verify the call of specific method rather than all of them.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T03:02:31.430

Explicitly set the number of calls expected of the methods that you do not want to check to `.anyTimes()`

```
expect(mymock.unwantedMethod()).andReturn("something).anyTimes() 
```

or make it a stub implementation:

```
expect(mymock.unwantedMethod()).andStubReturn("something) 
```

This way only the expected method call will be validated.

# git - 1领先和29落后是什么意思？

> ID：11731264
> 
> 赞同：-2
> 
> 时间：2012-07-30T23:47:11.827
> 
> 标签：git

当我看到我的远程跟踪分支时，我看到了 UI 显示

领先 1 人，落后 29 人。

我修改了两个文件，应该是前面2个吧？前面的 1 到底是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T10:40:52.223

*提前 1*表示您在 master 之前有 1 个**提交。**

# .net - WPF 按钮样式

> ID：11731266
> 
> 赞同：0
> 
> 时间：2012-07-30T23:47:22.850
> 
> 标签：.net, wpf, xaml, styles

我正在尝试使用控件模板来自定义 WPF 中的按钮。我有以下问题： 1\. 在 MouseOver 上，按钮的颜色不会变为红色 2\. 按下时会产生摇晃效果

下面是xaml：-->

```
 <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Name="border"
                           BorderThickness="1"
                           Padding="4,2"
                           BorderBrush="DarkGray"
                           CornerRadius="3"
                           Background="{StaticResource ButtonDarkColorBrush}">
                                <Grid >

                                    <ContentPresenter HorizontalAlignment="Center"
                                       VerticalAlignment="Center" Name="content" Style="{StaticResource ShadowStyle}"/>
                                </Grid>

                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <!--<Setter TargetName="border" Property="BorderBrush" Value="#FF4788c8" />-->
                                    <Setter Property="Foreground" Value="#FF4788c8" />
                                    <Setter Property="Background" Value="Red" />
                                </Trigger>

                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="content" Property="RenderTransform" >
                                        <Setter.Value>
                                            <TranslateTransform Y="0.1" />
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsDefaulted" Value="True">
                                    <Setter TargetName="border" Property="BorderBrush" Value="#FF282828" />
                                </Trigger>
                                <Trigger Property="IsFocused" Value="True">
                                    <Setter TargetName="border" Property="BorderBrush" Value="#FF282828" />
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Opacity" Value="0.7" />
                                    <Setter Property="Foreground" Value="Gray" />
                                </Trigger>
                            </ControlTemplate.Triggers>

                        </ControlTemplate>
                    </Setter.Value>

                </Setter>
            </Style> 
```

请指教 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:49:03.747

嗨 Melspring 试试这个代码，它对我有用。

```
<Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Name="border" 
                BorderThickness="2"
                Padding="4,2" 
                BorderBrush="{DynamicResource BlueGradient2}"
                CornerRadius="5" 
                Background="{TemplateBinding Background}">
                        <Grid >
                            <ContentPresenter 
                            HorizontalAlignment="Center" 
                            VerticalAlignment="Center" 
                            Name="content"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="Red"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="Red"/>
                            <Setter Property="BorderBrush" Value="Red"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="Red"/>
                            <Setter Property="BorderBrush" Value="Red"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
            </Setter> 
```

# c++ - 将 2D 对象移动到 OpenGL 中的一个点

> ID：11731268
> 
> 赞同：1
> 
> 时间：2012-07-30T23:47:29.190
> 
> 标签：c++, c, opengl

如何`GL_POINTS`使用 OpenGL 沿点（不是坐标，而是坐标）的方向移动 2D 对象？

* * *

为了更好地理解我的代码：

我已将大部分代码拆分为不同的源代码，但这是实际创建形状和设置场景的代码：

```
void setupScene(int clearColor[]) {
    glClearColor(clearColor[0], clearColor[1], clearColor[2], clearColor[3]);
    //glClearColor(250, 250, 250, 1.0);  //  Set the cleared screen colour to black.
    glViewport(0, 0, WINDOW_WIDTH, WINDOW_HEIGHT);  // This sets up the viewport so that the coordinates (0, 0) are at the top left of the window.

    // Set up the orthographic projection so that coordinates (0, 0) are in the top left.
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, WINDOW_WIDTH, WINDOW_HEIGHT, 0, -10, 10);

    // Back to the modelview so we can draw stuff.
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear the screen and depth buffer.
}

void drawScene() {
    setupScene((int[]){250, 250, 250, 1});

    triangle(210, WINDOW_WIDTH, WINDOW_HEIGHT);

    glBegin(GL_QUADS);
    glColor3f(RGB(80), RGB(80), RGB(80));

    glPushMatrix();
    glTranslatef(400, 400, 0);
    glVertex2d(200, 100);
    glVertex2d(100, 100);
    glVertex2d(100, 200);
    glVertex2d(200, 200);
    glPopMatrix();
    glEnd();

    glutSwapBuffers();  // Send the scene to the screen.
}

void update(int value) {
    glutPostRedisplay();  // Tell GLUT that the display has changed.
    glutTimerFunc(25, update, 0);  // Tell GLUT to call update again in 25 milliseconds.
} 
```

*PS：对不起，如果我听起来像个菜鸟，但我刚从 Java 转向 C++，所以我可以做一些跨平台游戏。此外，我从未开发过游戏，只是开发了一些 Android、iOS 和黑莓应用程序。*

* * *

# 解决方案

谢谢@paddy，我试图了解解决方案的使用`glTranslatef`并附带解决方案。这是工作代码，它将创建一个 100x100 的正方形并将其移动到 400x200：

```
void setupScene(int clearColor[]) {
    glClearColor(clearColor[0], clearColor[1], clearColor[2], clearColor[3]);
    //glClearColor(250, 250, 250, 1.0);  //  Set the cleared screen colour to black.
    glViewport(0, 0, WINDOW_WIDTH, WINDOW_HEIGHT);  // This sets up the viewport so that the coordinates (0, 0) are at the top left of the window.

    // Set up the orthographic projection so that coordinates (0, 0) are in the top left.
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, WINDOW_WIDTH, WINDOW_HEIGHT, 0, -10, 10);

    // Back to the modelview so we can draw stuff.
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // Clear the screen and depth buffer.
}

int a = 100;
int b = 200;
int x = 100;
int y = 100;

void drawScene() {
    setupScene((int[]){250, 250, 250, 1});

    triangle(210, WINDOW_WIDTH, WINDOW_HEIGHT);

    glPushMatrix();
    glTranslatef(x, y, 0);

    glBegin(GL_QUADS);
    glColor3f(RGB(80), RGB(80), RGB(80));

    glVertex2d(b, a);
    glVertex2d(a, a);
    glVertex2d(a, b);
    glVertex2d(b, b);

    glEnd();

    glPopMatrix();

    glutSwapBuffers();  // Send the scene to the screen.
}

void update(int value) {
    if (x != 400 && y != 200) {
        x += 4;
        y += 2;
    }
    glutPostRedisplay();  // Tell GLUT that the display has changed.
    glutTimerFunc(25, update, 0);  // Tell GLUT to call update again in 25 milliseconds.
} 
```

OpenGL 比我想象的要容易得多。因为我一直对 C/C++ 感到恐惧，因为我已经习惯了 Java 和 JavaScript，但我真的很喜欢它的真棒、简单和优雅。感谢@paddy 帮助我。**:)**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:52:27.560

您需要翻译模型视图矩阵。假设您已经处于模型视图模式：

```
glPushMatrix();
glTranslatef(x, y, z);
// Draw your shape
glPopMatrix(); 
```

**[编辑]**

> @paddy：像这样的东西？我试过了，但广场没有动。pastebin.com/2PCsy5kC

尝试明确选择模型视图矩阵。您的示例没有告诉我们它当前处于哪种模式：

```
glSetMatrixMode(GL_MODELVIEW);
glPushMatrix();
glTranslatef(x, y, z);
// Draw your shape
glPopMatrix(); 
```

通常在渲染开始时您会重置所有内容...因此您进入 GL_PROJECTION 模式，调用`glLoadIdentity()`以重置它并设置您的相机，然后对 GL_MODELVIEW 矩阵也执行此操作。

# html - 当我将鼠标悬停在 html 表格中时更改单元格的颜色

> ID：11731269
> 
> 赞同：4
> 
> 时间：2012-07-30T23:47:39.267
> 
> 标签：html, html-table

我查看了所有发布的答案，但我似乎无法让这段代码正常工作。当我将鼠标悬停在单个单元格上时，我试图让其改变颜色，但我无法通过我们正在使用的服务访问 .css。我被迫删除一个 HTML 代码框，我可以将我的代码粘贴到特定于我正在更改的元素中，但不是整个 .css 文件......只是那个元素。

这是我的代码。非常感谢您在滚动单元格时将背景更改为#ff0000 并将文本更改为#000000 的任何帮助。

（最终我的意图是为每个单元格添加一个 >a href ，但我试图一次执行此步骤。>a href 将（我希望）将选定的单元格添加到购物车.)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
<title></title>

<style type="text/css">
body {
      background: #000;   
}
#wrap {
     margin: 0 auto; /* margin 0 auto will center that box in your document */
     width: 780px; /*size of your box*/
     background: #000;
     text-align: center; /* everything will be written in that box will be centered horizontally*/
     }
</style>
<div id="wrap">
  <table width="780">
     <tr>
        <td align="center">
<table border=1>
  <tbody>
    <!-- Results table headers -->
    <tr>
      <th>Messages Per Month</th>
      <th>1 Month Pricing</th>
      <th>3 Month Pricing</th>
      <th>12 Month Pricing</th>
    </tr>
    <tr>
      <td>500</td>
      <td>$14.95/Month</td>
      <td>$12.95/Month</td>
      <td>$9.95/Month</td>
    </tr>
    <tr>
      <td>1,000</td>
      <td>$24.95/Month</td>
      <td>$20.95/Month</td>
      <td>$17.95/Month</td>
    </tr>
    <tr>
      <td>1,500</td>
      <td>$37.95/Month</td>
      <td>$31.95/Month</td>
      <td>$26.95/Month</td>
    </tr>
    <tr>
      <td>2,000</td>
      <td>$49.95/Month</td>
      <td>$41.95/Month</td>
      <td>$35.95/Month</td>
    </tr>
    <tr>
      <td>2,500</td>
      <td>$62.95/Month</td>
      <td>$52.95/Month</td>
      <td>$44.95/Month</td>
    </tr>
    <tr>
      <td>5,000</td>
      <td>$119.95/Month</td>
      <td>Not Available</td>
      <td>Not Available</td>
    </tr>
    <tr>
      <td>7,500</td>
      <td>$179.95/Month</td>
      <td>Not Available</td>
      <td>Not Available</td>
    </tr>
    <tr>
      <td>10,000</td>
      <td>$219.95/Month</td>
      <td>Not Available</td>
      <td>Not Available</td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
        </td>
     </tr>
   </table>
</div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T01:01:49.943

在 CSS 中：

```
td:hover {
  background-color: #ff0000;
  color: #000000;
} 
```

或者你可以使用 JavaScript/jQuery：

```
$(document).ready(function() {
  $("td").hover(
    function() {
      $(this).css('background-color', '#ff0000');
      $(this).css('color', '#000000');
    }, 
    function() {
      $(this).css('background-color', 'none');
      $(this).css('color', 'black'); // or whatever your original color was
    }
  );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-25T02:30:22.413

您可以通过给每个单元格一个类来做到这一点

```
<td class="a">..</td> 
```

然后给它造型

```
<style>
  td.a { background-color:#ff0000; }
  td.a:hover { background-color:#000000; }
</style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-10T11:57:58.120

使用 div (class="cell_hvr") 和围绕内容的链接包装单元格数据。

```
.cell_hvr {
    padding: 2px;
    width: 100%;
    height: 100%;
}
.cell_hvr a {
    display: block;
    text-decoration: none;
}
.cell_hvr a:hover {
    background-color: red;
}

<div class="cell_hvr"><a href="#" target="_blank"> (Your content) </a></div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-30T23:50:42.503

CSS：`td:hover, th:hover { background:#ff0000; color:#000; }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-26T21:37:58.467

我一直在寻找这个问题的答案的 JavaScript 版本。但是，我没有使用 JQuery ..

我有 `oCell = newRow.insertCell(); oCell.style.background = tintTest(myCounts[i]);`

myCounts 只是一个包含 Int.. 的数组

但现在我只想将悬停背景颜色添加到我当前的 oCell 之前，然后将其粉碎并继续循环......所以我发现下面的代码是“可以”流中唯一检查过的答案没有完成'..只是不确定这是否会帮助我。

```
var css = 'table td:hover{ background-color: #00ff00 }';
var style = document.createElement('style');

if (style.styleSheet) {
    style.styleSheet.cssText = css;
} else {
    style.appendChild(document.createTextNode(css));
}

document.getElementsByTagName('head')[0].appendChild(style); 
```

编辑！！！我刚刚发现了我的问题（我希望代码片段对你的问题仍然有帮助）我试图在 CSS 中添加悬停，但它根本不受支持。

# extjs4 - 如何为（grid.feature.Grouping）创建 ExtJS 4 mouseenter / mouseleave 状态？

> ID：11731270
> 
> 赞同：2
> 
> 时间：2012-07-30T23:47:46.457
> 
> 标签：extjs4, gridpanel

我想创建一个 mouseenter / mouseleave 状态以将鼠标悬停在组标题上。Ext.grid.feature.Grouping 类中似乎没有引发任何悬停事件。

![分组标题](../Images/19439c27aaf49e587c21f8a8da6b7a84.png)

*   鼠标输入，分组标题，将 ^ 更改为白色
*   分组标题的鼠标离开会将 ^ 改回 #999

建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-30T23:47:46.457

我想不出使用 ExtJS 糟糕的事件绑定正确委托给 mouseenter / mouseleave 事件的解决方案。

此外，我无法弄清楚如何组件查询/查询 grid.feature.Grouping 功能本身。

但是，我确实弄清楚了如何将委托侦听器添加到 mouseover / mouseout 事件。您必须等待渲染事件才能首先获取组件元素，这有点难看。然后，您必须使用 this.mon （非常命名）绑定到委托元素上的 addManagedListener 。

```
Ext.create('Ext.grid.Panel', {
    // ...
    listeners: {
        render: function (cmp, eOpts) {
            this.mon(cmp.el, 'mouseover', function (event, html, eOpts) {
            var class_names = this.getGroupClassNamesWithoutOver(html);

            class_names.push('x-over');
            html.className = class_names.join(' ');
        }, cmp, {
            delegate: '.x-grid-group-hd'
        });

        this.mon(cmp.el, 'mouseout', function (event, html, eOpts) {
            var class_names = this.getGroupClassNamesWithoutOver(html);

            html.className = class_names.join(' ');
        }, cmp, {
            delegate: '.x-grid-group-hd'
        });
    },

    getGroupClassNamesWithoutOver: function (html) {
        var class_names = html.className.split(' '),
            class_names_length = class_names.length,
            new_class_names = [];

        while (class_names_length--) {
            var class_name = class_names[class_names_length];

            if (class_name != 'x-over') {
                new_class_names.push(class_name);
            }
        }

        return new_class_names;
    }
}); 
```

这个解决方案比使用超级嵌套的、非作用域的版本要干净得多：

```
listeners: {
    el: {
        mouseover: {
            delegate: '.x-grid-group-hd',
            fn: function (event, html, eOpts) {
                // ...
            }
        }
    }
} 
```

# php - 为什么我也使用 plusSlider 时 script.js 不起作用？

> ID：11731271
> 
> 赞同：0
> 
> 时间：2012-07-30T23:47:48.060
> 
> 标签：php, jquery, wordpress

我有两个脚本，第一个是`script.js`使用`quicksand.js`，第二个是`plusslider`.

当我使用如下代码时，*plusslider*可以工作，但`script.js`不能。
但是，当我删除*plussslider*调用`script.js`工作正常。

如何让它们同时工作？

这是我的`header.php`：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
<script language="javascript" type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/jquery.quicksand.js"></script>
<script language="javascript" type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/script.js"></script>
<script language="javascript" type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/jquery.plusslider-min.js"></script>

<script language="javascript">
$(document).ready(function(){

$('#slider').plusSlider({
    createPagination: false,
    sliderEasing: 'easeInOutExpo',
    fullWidth: true,
    sliderType: 'slider'
    });

});
</script>
<?php wp_head(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:20:36.580

当您在浏览器中查看源代码时，请检查链接的显示方式。复制相关的并确保它们的地址加载地址栏中的文件。

另外，不要使用 5 年前的老派 language="javascript" ，这可能会导致正确的浏览器使用错误的文档类型。

但是相信我。每次都要先访问 HTML。即使这一次对你没有帮助。

还要确保你没有在 script.js 中做一些愚蠢的事情，比如覆盖 $ 命名空间。

另一个可能的问题。你所有的资源链接都是https吗？我的意思是图像、CSS、其他 JS 文件、您正在加载的实际页面等......

# delphi - 简单的 OpenGL 代码不起作用

> ID：11731279
> 
> 赞同：2
> 
> 时间：2012-07-30T23:48:39.500
> 
> 标签：delphi, opengl, delphi-xe2

只是用delphi学习一些OpenGL并尝试一些简单但没有得到结果的东西，我相信我应该得到一个深绿色的形式。但是当我运行它时，我什么也得不到。也没有错误。也许错过了什么？

```
 unit First1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls,OpenGL, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

type
  TForm2 = class(TForm)
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure FormPaint(Sender: TObject);
  private
    { Private declarations }
    GLContext : HGLRC;
    ErrorCode: GLenum;
  public
    { Public declarations }
  end;

var
  Form2: TForm2;

implementation

{$R *.dfm}

procedure TForm2.FormCreate(Sender: TObject);
var
  pfd: TPixelFormatDescriptor;
  FormatIndex: integer;
begin
  fillchar(pfd,SizeOf(pfd),0);
  with pfd do
    begin
      nSize := SizeOf(pfd);
      nVersion := 1; {The current version of the desccriptor is 1}
      dwFlags := PFD_DRAW_TO_WINDOW or PFD_SUPPORT_OPENGL;
      iPixelType := PFD_TYPE_RGBA;
      cColorBits := 24; {support 24-bit color}
      cDepthBits := 32; {depth of z-axis}
      iLayerType := PFD_MAIN_PLANE;
    end; {with}
  FormatIndex := ChoosePixelFormat(Canvas.Handle,@pfd);
  SetPixelFormat(Canvas.Handle,FormatIndex,@pfd);
  GLContext := wglCreateContext(Canvas.Handle);
  wglMakeCurrent(Canvas.Handle,GLContext);
end; {FormCreate}

procedure TForm2.FormDestroy(Sender: TObject);
begin
  wglMakeCurrent(Canvas.Handle,0);
  wglDeleteContext(GLContext);
end;

procedure TForm2.FormPaint(Sender: TObject);
begin
    {background}
    glClearColor(0.0,0.4,0.0,0.0);
    glClear(GL_COLOR_BUFFER_BIT);
{error checking}
    errorCode := glGetError;
    if errorCode<>GL_NO_ERROR then
      raise Exception.Create('Error in Paint'#13+
    gluErrorString(errorCode));
end;

end. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T07:28:19.750

由于您请求单个缓冲上下文，因此您必须`glFinish`在渲染代码的末尾调用，以将您的绘图命令提交给实现。但是，我强烈建议您切换到使用双缓冲上下文，而不是`glFinish`-ing 您发出 a`wglSwapBuffers`意味着完成。

# css - 如何仅使用父元素水平居中 HTML？

> ID：11731281
> 
> 赞同：0
> 
> 时间：2012-07-30T23:48:57.427
> 
> 标签：css, centering

有没有办法只使用父包装元素来居中某些 HTML？父包装元素不能引用`width`. `innerHTML`我能做到的唯一方法是使用`<center>`标签，但我们知道`<center>`它已经过时了。例如，`center`对此：

```
<div style="width:100px;height:100px;background-color:#ff0000;"></div> 
```

这个：

```
<div style="width:800px;height:100px;background-color:#ff0000;"></div> 
```

这个：

```
<p>a little text here</p> 
```

或这个：

```
<p style="width:400px;">a lot of text here fjskdfj sldjf slkdfj skldjf ksdjf kdsfj ksdjf skdfj ksdjf ksdjf ksdjf ksdjf ksdjf skdjf ksdjf skdfj skdfj ksdjf skdjf ksdjf ksdfj skdfj skdfj skdfj</p> 
```

我可以简单地将它们包装起来`<center>`，它就可以工作。但是还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:52:30.317

**用css**居中

 **```
html code:

<div class="parent">
  <div class="center">
      <p>A lot of text here</p>
  </div>
</div> 
```

**CSS代码：**

```
.parent {
   width:800px;
}

.parent .center {
    width:400px;
    margin: 0 auto;
} 
```

并且`<div>`with 类`center`将在中心对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:24:11.323

**像这样为父**级定义`text-align`属性：**`text-align: center;`**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:26:05.227

Add `text-align: center` on your `parent` element.****

# google-drive-api - 在 Google Drive API 中下载 URL 身份验证

> ID：11731283
> 
> 赞同：2
> 
> 时间：2012-07-30T23:49:01.587
> 
> 标签：google-drive-api

当用户单击由经过身份验证的文件列表（通过访问令牌）提供的 downloadUrl 时，她不需要再次发送访问令牌来下载文件。

Google Drive 如何在不提供所述令牌的情况下知道该用户具有权限？它是否在 downloadUrl 中以某种方式加密？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:50:49.643

如果您不想传递令牌，请改用`webContentLink`URL，然后，如果用户登录到他们的 Google 帐户，则 cookie 将用于授权。

# c - recv() 不阻塞

> ID：11731284
> 
> 赞同：3
> 
> 时间：2012-07-30T23:49:02.903
> 
> 标签：c, ubuntu, recv

我有 2 台机器运行我为测试目的编写的简单 C TCP 服务器，1 台使用 Fedora 16，另一台使用 Ubuntu 11.10。我的 Fedora 机器运行良好，但在 Ubuntu 机器上，recv() 不会阻塞。请记住，这些机器运行的是完全相同的代码。有人见过这个吗？谢谢

```
int TcpSocket::ReadFromClient(int socket, char* buf, int len)
{
    char *request = buf;
    int slen = len;

    int c = recv(socket, request, slen, 0);
    while((c > 0) && (request[c-1] != '\n'))
    {
        request += c;
        slen -= c;
        c = recv(socket, request, slen, 0);
    }

    if (c < 0)
    {
        return c;
    }
    else if(c == 0)
    {
        //Sending back an empty string
        buf[0] = '\0';
    }

    return len-slen;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:23:49.880

看起来您的代码的目的是在一个`'\n'`字节到达时停止读取。如果是这种情况，那么您需要一次从套接字读取 1 个字节，而不是使用整个可用缓冲区大小，特别是因为您只检查缓冲区的最后一个字节，而不是检查接收到的每个字节。

您还应该将循环逻辑更改为仅`recv()`在一个地方而不是两个地方调用。您当前的实现是`slen=0`在缓冲区耗尽时调用 recv() ，这将设置`c=0`并取消缓冲区中的第一个字节。

试试这个：

```
int TcpSocket::ReadFromClient(int socket, char* buf, int len)
{ 
    int slen = len;
    char ch;

    while (len > 0)
    {
        int ret = recv(socket, &ch, 1, 0); 
        if (ret > 0)
        {
            *buf = ch; 
            ++buf; 
            --len; 

            if (ch == '\n')
                break;
        }
        else
        {
            if ((ret == 0) || (errno != EAGAIN))
                return ret;

            fd_set readfd;
            FD_ZERO(&readfd);
            FD_SET(socket, &readfd);

            timeval tv;
            tv.tv_sec = 5;
            tv.tv_usec = 0;

            ret = select(socket+1, &readfd, NULL, NULL, &tv);
            if (ret < 0)
                return ret;

            if (ret == 0)
            {
                // timeout elapsed while waiting for data
                // do something if desired...
            }
        } 
    } 

    return slen - len;
} 
```

# android - onResume 在手机屏幕锁定时被一遍又一遍地调用

> ID：11731285
> 
> 赞同：18
> 
> 时间：2012-07-30T23:49:05.680
> 
> 标签：android

看来，如果在手机屏幕锁定时某个活动在前台，广播事件和/或唤醒锁将导致该活动的 onResume 被调用，无论它们是否用于您的应用程序。即使您不以任何方式与手机互动，也会发生这种情况。不要解锁，不要触摸，不要做任何事情，你的 onResume 会被一遍遍的调用，没有对应的 onPause。

我们注意到这一点是因为我们在 onResume 上记录了一个跟踪事件，并且我们注意到一些设备收到了大量这些 onResume 事件。我们能够重现并注意到每当任何应用程序似乎接收到意图时都会发生这种情况（例如 SugarSync、Google Voice 或我们自己的应用程序中的被动位置侦听器）。

我们在运行 ICS 的 Galaxy Nexus 和 Galaxy S3 上注意到了这一点。有趣的是，我们无法在 Jelly Bean 上重现该问题。

有人对这里可能发生的事情有任何指示吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-21T17:18:20.733

我在几部运行 Gingerbread 和 ICS 的手机上观察到了相同的行为。你的描述和我看到的相符。出于某种原因，即使屏幕仍处于锁定状态，活动也会触发 onResume。也许它恢复对某些操作系统级别的事件？

android 文档的最佳方向似乎来自[onResume](http://developer.android.com/reference/android/app/Activity.html#onResume())定义中的这一段：

> 请记住，onResume 并不是您的活动对用户可见的最佳指标；系统窗口（例如键盘保护）可能位于前面。使用 onWindowFocusChanged(boolean) 确定您的活动对用户可见（例如，恢复游戏）。

在开发 Activity 时，请记住 onResume 可能会被快速连续调用多次，而无需任何直接的用户交互。因此，基本上，不要在 onResume 中放置任何只能运行一次或旨在触发用户立即响应的代码。您必须自己决定 onResume 或 onWindowFocusChanged 是否更适合您想要做的事情。

# linux - 只执行一次 Makefile 规则

> ID：11731287
> 
> 赞同：8
> 
> 时间：2012-07-30T23:49:30.360
> 
> 标签：linux, makefile

我有一个 Makefile 规则，如下所示：

```
%.b : %.a
    [run some commands...] 
```

我想重写我的 Makefile 以便从 %.a 到 %.b 的所有转换都由命令的一次执行处理，而不是每个文件一次。

我尝试了以下方法：

```
%.b : someDummyFile

someDummyFile : 
    [run some commands] 
```

问题是即使第一个规则没有请求创建 someDummyFile 的规则也会执行，从而导致不良行为。我猜没有依赖关系的规则会一直执行，即使它们的目标没有被其他规则使用？

我在这里想念什么？

* * *

在尝试调试此问题时，我删除了对第二条规则的所有引用。例如，我将以下规则插入到现有的 Makefile 中，为什么即使没有其他规则引用它，它也会被执行？

```
HELLOWORLD :
    echo "# HELLO WORLD! THE NEXT LINE WILL TRIGGER AN ERROR"
    DFASDA 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-30T23:54:41.580

这是一个简单的示例，我认为它可以满足您的需求：

```
all: file1.x file2.x

%.x: doWork
    :

doWork:
    touch file1.x
    touch file2.x 
```

`doWork`规则将运行一次，然后规则中的( `:`no-op)`%.x`运行两次。您确实需要`:`, 或者至少需要*一些东西*作为该规则的配方，否则您将收到关于没有创建`.x`文件的规则的错误。这是用于取消模式规则的语法的副作用，即无配方规则。

# mysql - 有效日期时间值的奇怪 MySQL 警告 1264

> ID：11731288
> 
> 赞同：10
> 
> 时间：2012-07-30T23:49:32.567
> 
> 标签：mysql, datetime, warnings, mysql-error-1264

我已经手动（GASP！）在命令行输入了一个 MySQL 命令，我收到了一个我什至无法理解的警告。（在任何人说什么之前，是的，我知道：1\. 使用命令行界面不是最好的方法；2\. 我的表没有命名为“TABLE_NAME”，我的列没有命名为“DateColumn”，我的 RecordID 值不是真的 "1234"; 3\. 也许我的列类型*应该*是 TIMESTAMP，但现在不是。继续前进....）

尝试输入日期“2012 年 7 月 26 日下午 2:27 (GMT)”的值，我键入：

```
mysql> update TABLE_NAME set DateColumn="2012-07-26 14:27:00" where RecordID="1234"; 
```

我收到了：

```
Query OK, 1 row affected, 1 warning (0.11 sec) 
Rows matched: 1  Changed: 1  Warnings: 1 
```

所以，我键入：

```
mysql> show warnings;
+---------+------+-----------------------------------------------------+
| Level   | Code | Message                                             |
+---------+------+-----------------------------------------------------+
| Warning | 1264 | Out of range value for column 'DateColumn' at row 1 |
+---------+------+-----------------------------------------------------+ 
```

很奇怪，我想。于是我先查了表，确认了列（字段）类型：

```
mysql> describe TABLE_NAME;

+------------+----------+------+-----+-------------------+-------+
| Field      | Type     | Null | Key | Default           | Extra |
| DateColumn | datetime | YES  |     | NULL              |       |
+------------+----------+------+-----+-------------------+-------+ 
```

但是值确实被正确写入数据库，而不是被截断，AFAIK：

```
mysql> select * from TABLE_NAME where RecordID="1234";

+-----------------------------------------------+
| RecordID | Date_Column         | BlahBlahBlah |
+----------+---------------------+--------------+
|     1234 | 2012-07-26 14:27:00 | something..  | 
+----------+---------------------+--------------+ 
```

我已经在 StackOverflow.com 上搜索了解决方案。我已经用谷歌搜索了一个解释。我已经在[http://dev.mysql.com/doc/refman/5.5/en/datetime.html](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)上阅读过它说：

```
 MySQL retrieves and displays DATETIME values in 'YYYY-MM-DD HH:MM:SS' format. The supported range is '1000-01-01 00:00:00' to '9999-12-31 23:59:59'. 
```

我什至有点怀疑这与我进入的日期或时间有关。所以我会声明数据库所在的服务器是太平洋夏令时间（GMT-8，除了现在为 DST 的 GMT-7）；我从 EDT 上的客户端登录（SSH）（这无关紧要）；我将所有 Date_Column 值存储为 GMT。在我输入值“2012-07-26 14:27:00”时，所有三个日期都在 2012 年 7 月 30 日之后。这并不重要——我*应该*能够输入*未来*的日期而不会出错——但我认为这可能对你有所帮助。所以 -

**为什么，哦，为什么“2012-07-26 14:27:00”是一个超出范围的值？**

我的 MySQL 客户端 API 版本是 5.1.49。

这是我第一次在 StackOverflow 上发帖。预先感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T00:01:29.293

我想知道它是否将它从字符串转换为某种日期格式。该日期格式将具有太多的精度，这将被截断。在分配之前尝试将其转换为日期时间。

# java - 通过java运行的执行程序似乎超时？

> ID：11731289
> 
> 赞同：0
> 
> 时间：2012-07-30T23:49:43.050
> 
> 标签：java, linux, runtime, centos, runtime.exec

我有一个 IRC 机器人，它接受来自用户的命令来托管特定的游戏服务器。但是，在服务器启动大约半小时到一个小时后，服务器就会冻结。服务器使用 Java 的运行时执行命令运行。

有没有办法让服务器保持正常运行，直到用户手动终止服务器？

如果重要的话，操作系统是 CentOS 6、64 位。

这是一个传递给 Java 运行时执行的示例字符串命令：http: [//pastebin.com/mn8qWf3E](http://pastebin.com/mn8qWf3E)

编辑：我不确定进程是否挂起或崩溃，因为我没有检查。我已经再次运行服务器，一旦发现就会检查。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:53:56.987

只是一个猜测..确保您继续从 java 进程读取服务器的输出，或者将其重定向到某个地方。否则当它在 stdout 或 err 中打印某些内容时会阻塞

# vb.net - 使用数据集图像填充 Crystal 报表

> ID：11731292
> 
> 赞同：1
> 
> 时间：2012-07-30T23:50:31.410
> 
> 标签：vb.net, crystal-reports, dataset, vb.net-2010

我正在尝试使用数据集填充 Crystal Report 并尝试加载图像。我有一个字节数组中的图像。我即将加载我的字符串数据就好了。我有一个带有数据表和一些列的数据集。这是我的代码，但我对这一行有问题：

```
t.Columns.Add("Item", Type.GetType(System.Byte())) 
```

具体来说`System.Byte()`

这是我的完整代码，有人知道我应该用什么替换该行吗？

```
Private Function GetGmap(ByVal objGEOCode As String)
    Dim gmap As New CtpGglMap.Impl.StaticGMap
    Dim temp As New GMarker
    Dim temp2 As New GMarker
    Dim ArrTemp()
    ArrTemp = Split(objGEOCode, ",")
    gmap.Center = New GeoPointImpl(ArrTemp(0), ArrTemp(1))
    gmap.Zoom = 14

    gmap.Height = 159
    gmap.Width = 137
    gmap.Sensor = False
    '  GetDrivingDirectionFromGoogle("fishkill ,ny", "41.5442847, -73.8732391")

    temp.Point = New GeoPointImpl(ArrTemp(0), ArrTemp(1))
    temp.SetMap(gmap)

    'CREATE A BITMAP FROM THE MEMORY STREAM
    Return New System.Drawing.Bitmap(gmap.Fetch)

    Return True
End Function
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    Dim ds As New DataSet1
    Dim t As DataTable = ds.Tables.Add("Items")
    t.Columns.Add("id", Type.GetType("System.String"))
    t.Columns.Add("Item", Type.GetType(System.Byte()))

    Dim r As DataRow

    r = t.NewRow()
    r("id") = "Test"
    r("Item") = GetGmap("41.5442847, -73.8732391")
    t.Rows.Add(r)

    Dim objRpt As New CrystalReport1
    objRpt.SetDataSource(ds.Tables(1))
    CrystalReportViewer1.ReportSource = objRpt
    CrystalReportViewer1.Refresh()

    CrystalReportViewer1.PrintReport()

End Sub 
```

# windows-phone-7 - 当用户导航返回时，如何因为“不相关”的更改而刷新绑定的属性？

> ID：11731293
> 
> 赞同：0
> 
> 时间：2012-07-30T23:50:35.163
> 
> 标签：windows-phone-7, data-binding, ivalueconverter

我的应用程序中有以下两个模型：

```
public class AppSettings : INotifyPropertyChanged
{
   private Units _mainUnits; // Units is an Enum.
   public Units MainUnits {
     get { return _mainUnits; }
     set {
       if (!_mainUnits != value) {
         _mainUnits = value;
         this.OnPropertyChanged("MainUnits");
       }
     }
   }

   // Standard PropetyChanged event, etc. elided (using NotifyPropertyWeaver).
   [...]
}

public class Ride : INotifyPropertyChanged
{
   private double _rideDistance;
   public double RideDistance {
     get { return _rideDistance; }
     set { 
       if (!_rideDistance != value) {
         _rideDistance = value;
         this.OnPropertyChanged("RideDistance");
       }
     }
   }

   // Standard PropetyChanged event, etc. elided (using NotifyPropertyWeaver).
   [...]
} 
```

然后在我的应用程序页面上，我`TextBlock`绑定了 RideDistance 属性，该属性使用根据枚举的值`IValueConverter`将`RideDistance`米转换为公里或英里。`MainUnits`

当模型的值发生更改时，这可以正常工作`Ride`，但是当用户更改设置页面上的 AppSettings.MainUnit 属性并导航“返回”到显示页面时，我想刷新页面。

例如：

1.  应用程序启动，页面加载，`AppSettings.MainUnits`== Units.Imperial，`RideDistance`显示为“1.3 英里”。
2.  用户导航到设置页面，并更改`AppSettings.MainUntis`为 Units.Metric。
3.  用户按“返回”返回第一页。
4.  页面现在应`RideDistance`列为`2.1km`，但仍以英里为单位列出。

重新启动应用程序会产生所需的行为，就像显式导航到第一页一样，但使用后退按钮不会。

当用户使用后退按钮时，如何强制刷新绑定的属性？

在我的 FodyTest 项目的“RefreshProperties”分支上有一个小型工作应用程序演示了这一点：

> [刷新属性分支](https://github.com/Zhaph/FodyTest/tree/RefreshProperties)

![在此处输入图像描述](../Images/2c1818d94c8bbfec9fd8933369eac66c.png)

单击设置图标以更改单位，导航回开始页面，注意没有区别，然后使用刷新按钮刷新页面...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T07:10:34.927

一个有点脏的 hack： - 向 Ride 类添加一个方法 X() ，该类调用 OnPropertyChanged("RideDistance"); - 在 AppSettings.set_MainUnits 中调用 Ride.X()；

编辑：另一种有点脏的方法，它重新绑定页面的所有绑定： - 在 MainPage 的 OnNavigatedTo 中，if(e.NavigationMode==Back) {DataContext=null; DataContext=myViewModel;}

# objective-c - replaceObjectAtIndex：withObject：错误

> ID：11731297
> 
> 赞同：0
> 
> 时间：2012-07-30T23:50:58.413
> 
> 标签：objective-c

有人可以看到错误在哪里...

```
NSArray *arr = [str componentsSeparatedByString:@","];
NSString *inputStr = [arr objectAtIndex:0];
NSString *trimmedStr = [inputStr stringByTrimmingCharactersInSet:
                               [NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
[[arr objectAtIndex:0] replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

输出：

```
-[__NSCFString replaceObjectAtIndex:withObject:]: 
unrecognized selector sent to instance 0x68a8eb0
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', 
reason: '-[__NSCFString replaceObjectAtIndex:withObject:]: 
unrecognized selector sent to instance 0x68a8eb0' 
```

编辑：添加了额外的行以显示该数组已被声明和填充。
正如下面评论中所说，当我替换该行时：

```
[[arr objectAtIndex:0] replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

和：

```
[arr replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

Xcode 错误（运行前）：

```
 No visible @interface for 'NSArray' declares the selector 'replaceObjectAtIndex:withObject' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T23:56:56.980

这是错的：

```
[[arr objectAtIndex:0] replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

你真正想做的是：

```
[arr replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

您正在将 replaceObjectAtIndex 发送到数组 ([arr objectAtIndex:0]) 中的字符串，这显然无法解决。将该消息发送到（可变）数组，它将用新字符串替换字符串。

对于你的下一个问题：告诉我们更多关于你想要做什么等，不要限制自己少于 10 个字。你提供的细节越多，你得到的帮助就越多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T23:57:44.070

虽然我不确定您要做什么（因为我不知道是什么`arr`），但您似乎正在`NSString`从数组中获取一个对象并尝试对其执行`replaceObjectAtIndex:withObject:`。也许您的意思是：

```
[arr replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T06:22:52.350

只是为了它，这里是正确的修复：

```
NSMutableArray *arr = [[[str componentsSeparatedByString:@","] mutableCopy] autorelease];
NSString *inputStr = [arr objectAtIndex:0];
NSString *trimmedStr = [inputStr stringByTrimmingCharactersInSet:
                           [NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
[arr replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

或者，如果您使用的是 ARC：

```
NSMutableArray *arr = [[str componentsSeparatedByString:@","] mutableCopy];
NSString *inputStr = [arr objectAtIndex:0];
NSString *trimmedStr = [inputStr stringByTrimmingCharactersInSet:
                           [NSCharacterSet whitespaceAndNewlineCharacterSet]]; 
[arr replaceObjectAtIndex:0 withObject:trimmedStr]; 
```

# c# - .NET (C#) 中 64 位应用程序的性能优势

> ID：11731304
> 
> 赞同：2
> 
> 时间：2012-07-30T23:51:40.270
> 
> 标签：c#, .net, performance, optimization, 64-bit

我正在将一个复杂的算法从 32 位移植到 64 位，在运行 Windows 7 64 位的 8GB RAM 的 Core i5 机器上计算大约需要 5 个小时。

该应用程序以 .NET 4 为目标，将任务并行库用于大约 60% 的循环，并使用 BigInteger 类。

我正在处理两个数字范围：

*   0 到 ulong.MaxValue（大约是算法的 50%）。
*   具有数十万位数的非常大的整数（约占算法的 50%）。

对这些数字执行的操作包括加法、减法乘法、除法、对数和幂。

一旦移植到 64 位，我将能够分析和计时代码以查看性能提升，但我想知道是否可以通过计算来估计它。

如果是这样，请推荐一些解释相同的文章。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T00:08:53.803

我不确定您要移植什么（除非混合使用本机代码）。如果您已经有一台 64 位机器，只需确保您以 64 位运行时为目标（默认的 AnyCPU 会这样做）。

具体的性能改进将取决于算法的性质。对于可能给您一个数量级的测量，请参阅

[为什么 64 位比 32 位更快？](https://stackoverflow.com/questions/1941826/why-is-this-faster-on-64-bit-than-32-bit)

您可以看到的最佳情况是 2 倍，但您的实际改进可能远低于此。

另一方面，64 位代码占用更多内存（地址为 64 位）。如果迁移到 64 位碰巧由于 JITed 代码所需的内存增加而迫使您开始交换，则整体性能可能会降低。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T00:08:17.407

根据[阿姆达尔定律](http://en.wikipedia.org/wiki/Amdahl%27s_law)，您将看到最大速度提高了 1.33 倍。有一些应用程序（例如，位板国际象棋引擎）从 32 位到 64 位几乎可以使性能翻倍，但那是当几乎所有数据都是 64 位并使用按位操作进行操作时。没有具体细节很难说，但在你的情况下，它可能会小于预测的因素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:14:25.753

恐怕尝试和衡量是唯一合理的方法。特别是因为您正在“将...... 32 位移植到 64 位”，它假设至少部分代码重写，因此很难就性能数字给出任何指导。

由于指针较长，x64 代码和数据占用的空间稍多，但提供的地址空间要大得多。因此，根据代码，您可能会在任何方向上获得性能变化。

# r - 将R中数据框中的每对列粘贴在一起？

> ID：11731305
> 
> 赞同：9
> 
> 时间：2012-07-30T23:51:55.700
> 
> 标签：r

我有一个氨基酸位点的数据框，并且想为这些位点的每个成对组合创建一个新的数据框。

原始数据将如下所示：

```
df<-cbind(letters[1:5], letters[6:10], letters[11:15])
df
 [,1] [,2] [,3] 
[1,] "a"  "f"  "k" 
[2,] "b"  "g"  "l" 
[3,] "c"  "h"  "m" 
[4,] "d"  "i"  "n" 
[5,] "e"  "j"  "o" 
```

我想要的是：

```
newdf<-cbind(paste(df[,1],df[,2],sep=""),paste(df[,1],df[,3],sep=""),(paste(df[,2],df[,3],sep="")))
newdf
     [,1] [,2] [,3]
[1,] "af" "ak" "fk"
[2,] "bg" "bl" "gl"
[3,] "ch" "cm" "hm"
[4,] "di" "dn" "in"
[5,] "ej" "eo" "jo" 
```

实际数据可能有数百行和/或列，因此显然我需要一种较少手动的方式来执行此操作。非常感谢任何帮助，我只是一个谦虚的生物学家，我在这方面的技能相当有限。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T00:05:41.683

`combn()`和的组合`apply()`将为您提供所有无序的成对组合：

```
df <- cbind(letters[1:5], letters[6:10], letters[11:15])

apply(X = combn(seq_len(ncol(df)), 2), 
      MAR = 2, 
      FUN = function(jj) {
          apply(df[, jj], 1, paste, collapse="")
      }      
)
#      [,1] [,2] [,3]
# [1,] "af" "ak" "fk"
# [2,] "bg" "bl" "gl"
# [3,] "ch" "cm" "hm"
# [4,] "di" "dn" "in"
# [5,] "ej" "eo" "jo" 
```

（如果上面发生的事情不是很清楚，您可能想快速查看由 . 返回的对象`combn(seq_len(ncol(df)), 2)`。它的列枚举了 1 和 之间的所有无序成对组合整数`n`，其中`n`是数据框中的列数.)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-31T00:36:10.300

您可以使用`FUN`参数将`combn`每个组合中的列粘贴在一起：

```
combn(ncol(df),2,FUN=function(i) apply(df[,i],1,paste0,collapse="")) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T01:24:08.830

乔希和约书亚的答案更好，但我想我会给出我的方法：

这需要使用以下功能下载[`qdap`varsion 1.1.0 ：](http://trinkerrstuff.wordpress.com/2014/02/23/qdap-1-1-0-released-on-cran/)`paste2`

```
library(qdap)

ind <- unique(t(apply(expand.grid(1:3, 1:3), 1, sort)))
ind <- ind[ind[, 1] != ind[, 2], ]
sapply(1:nrow(ind), function(i) paste2(df[, unlist(ind[i, ])], sep="")) 
```

虽然从他们的答案中窃取这将更具可读性：

```
ind <- t(combn(seq_len(ncol(df)), 2))
sapply(1:nrow(ind), function(i) paste2(df[, unlist(ind[i, ])], sep="")) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-31T06:19:29.540

请记住，您将在新 data.frame 中获得*很多*列，假设您说原始 data.frame 中有数百列：如果原始数据包含*n*列，那么新数据将包含*n(n- 1)/2*列 - 这是二次缩放的。

# javascript - 我在 jQuery 事件处理和隐藏/显示图像元素方面做错了什么？

> ID：11731313
> 
> 赞同：0
> 
> 时间：2012-07-30T23:52:49.860
> 
> 标签：javascript, jquery, css, html

我正在[http://icon.stornge.com](http://icon.stornge.com)上的一个画廊上工作，其中预期的功能是让用户点击主页上的链接，然后显示第一个图像，然后如果/当用户点击图像，下一个限制加载，依此类推，直到最后一个图像。

相反，发生的是第一次单击加载图像，首先是条子，然后是完整图像（这是`jQuery.load('slow')`图像上的预期行为吗？`</a>`），然后单击第一个图像似乎调用事件处理程序（如果我put an `alert()`it 按预期显示），但第一张图片保留在原位，第二张图片没有出现。Chrome 的控制台不会记录任何 JavaScript 错误。

jQuery的事件处理和`.hide()`和之间有交互`.show()`吗？我是否因为有一个初始的 CSS " `display: none`" 或其他任何东西而遇到麻烦？

我应该更改什么以便单击一个图像加载下一个图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:13:03.327

首先，虽然它可以工作（令人惊讶——但可能只在 Chrome 中），但协议应该全部小写（javascript:，而不是 JavaScript:)。其次，任何使用脚本的href，如果不返回false（在href中的所有脚本代码之后），都​​可能导致问题。

无论如何，只需使用以下内容：

1-~~将类（例如“图像切换”）应用于要触发图像出现的图像和链接。~~将类“图标”添加到锚点。

2- 将当前的 href 更改为 # 或 javascript:return false;

3- 从图像中删除 ID（W3C HTML 规范明确规定 ID 值必须以字母字符开头；您可以使用数字 - 但不能以数字开头 ID）。

4-（可选）将所有图像（旋转）放在一个新的 DIV 中（称之为“图像”）。

将此代码添加到您的页面（在脚本块中）：

```
(function($){
  var imageIndex = 0;
  $(function(){
    var $homepage = $("#homepage"), 
        $images = $(".icon");
    $images.click(function(event){
      event.preventDefault();
      $homepage.hide("slow");
      $images.hide().eq(imageIndex++).show("slow");
    });
  });
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:34:53.247

您注意到的闪烁可能是因为您在开始显示第一张图像之前没有隐藏主页。您也可以考虑尝试[`.fadeIn('slow')`](http://api.jquery.com/fadeIn/)作为替代方案。

此外，您需要在 dom 准备好后绑定其他点击处理程序。我建议将您的脚本从`a`元素的 href 中移出，并全部移到一个包含以下代码的脚本标签中。无需索引元素，因为您可以使用[jQuery`.next()`方法](http://api.jquery.com/next/)访问下一个图标。

我纠正/修改了您的 html 也有一些问题。[这是效果的演示](http://jsfiddle.net/GDgyq/4/)。

HTML：

```
<html>
    <head>
        <title>Icon Library</title>
        <style>
            /*...*/
        </style>
    </head>
    <body>
        <div id="homepage">
        <h1>Icon Library</h1>
        <p><del>Favorites</del><br>
        <a href="#" id="icons">Browse icons</a><br>
        <a href="http://JonathansCorner.com/">by CJSH</a><br>
        </p>
        </div>
        <img class="icon" src="icon/icon0.png">
        <img class="icon" src="icon/icon1.png">
        <img class="icon" src="icon/icon2.png">
        <img class="icon" src="icon/icon3.png">
        <script>
            /*...*/
        </script>
</body></html> 
```

Javascript：

```
$(document).ready(function() {
    $("#icons").click(function(e) {
        e.preventDefault();
        $('#homepage').hide();
        $('img.icon:first').show('slow');
    });
    $('img.icon').click(function() {
        $(this).hide();
        $(this).next('img').show();
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:39:36.297

请看[这个小提琴](http://jsfiddle.net/aCpBJ/5/)。它向您展示了一种可能合理的方式来组织您的页面。我希望它对你有用。

这是代码：

```
var currentIcon = -1;
function nextIcon() {
    currentIcon = currentIcon % 3 + 1;
    $('#icons img')
       .attr('src', $('#iconlibrary img:eq(' + currentIcon + ')').attr('src'));
}

$('#leftpanel a').on('click', function() {
    if ($(this).parent().hasClass('disabled')) { return; }
    $(this)
        .blur()
        .parent()
        .addClass('selected')
        .siblings()
        .removeClass('selected');                  
    $('#' + $(this).data('id'))
    .show()
    .siblings()
    .hide();
    return false;
});

$('#icons a').on('click', nextIcon);
nextIcon(); 
```

嗯，我刚刚意识到你想要一个缓慢的淡入。让我考虑一下。单击时图像获得活动选择边框也有一个小问题。如果您担心可用性，那么我会将链接保留并让它们提交到服务器，服务器会显示一个显示正确图像的新页面。然后，在 javascript 中，在页面加载时摆脱链接，而是使用`img`带有点击处理程序和 CSS 指针样式的普通标签来显示手形。

Let me know if you like the direction I was taking this in and I'll try to help you more.

P.S. Hi Jonathan. Good to see you again. Some day I'll get you a response to our (very old, very stale) conversation.

# objective-c - prepareForSegue 并从 pList 文件中填充

> ID：11731314
> 
> 赞同：0
> 
> 时间：2012-07-30T23:52:55.687
> 
> 标签：objective-c, xcode

我有一个 prepareForSegue 应该将信息从一个页面传递到另一个页面，但是我知道我在某处错过了导致我 greif 的一行

基本上它从互联网调用一个填充tableview控制器的plist文件，当您选择它应该从一页到具有更多信息的新页面的值时

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    EventsViewController *evc1 = [segue destinationViewController];
    NSIndexPath *path = [self.tableView indexPathForSelectedRow];
    Events *d = [eventKey_web objectAtIndex:[path row]];
    [evc1 setCurrentEvent:d];
} 
```

对于我的 plist 文件的示例，可以在此处[使用 plist 字典填充 UITableView](https://stackoverflow.com/questions/11188049/populating-a-uitableview-with-plist-dictonary)

如果我做一个

```
NSLog(@"Event ID = %@",currentEvent); 
```

在我的 EventViewController 页面中，我得到了 Item X 的正确输出，但在我的一生中，我似乎无法弄清楚如何传递 eventDates 和 eventTitles。

我知道它只会是一条线，但如果有人能在正确的方向上轻轻推动我，那就太棒了

谢谢

# javascript - Visual Studio 2010 跳转到下一个任意字符/字符串

> ID：11731318
> 
> 赞同：0
> 
> 时间：2012-07-30T23:53:28.280
> 
> 标签：javascript, visual-studio-2010, replace

有没有办法在不使用 file 命令并指定 Find Next 的情况下跳转到下一个大括号？

一个例子是：

```
foo = function(data1, data2) {

},

bar = function(data3, data4) {

},

baz = function ... 
```

我想知道是否有像 Vim's / then 'n' 这样的键盘快捷键来继续查找任意字符的下一个？我有一个我正在处理的 JSON 文件，并且希望能够在不使用鼠标的情况下快速跳转到下一个左大括号。

我找到了跳转到匹配大括号命令，但这对我没有多大帮助。

感谢您的帮助，如果需要，我很乐意澄清我的问题或提供更多示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T23:57:31.747

`Ctrl+]`加工一个开/关大括号/括号，据我所知，至少从 MSVC 6.0 开始，这是一个标准的快捷方式。

增量搜索`Ctril+i`由一个标准开始，`F3`以重复最后一次搜索。

`Ctrl+f`打开“查找文本”对话框

# email - 詹金斯附件 - 语法是什么？

> ID：11731329
> 
> 赞同：12
> 
> 时间：2012-07-30T23:54:43.893
> 
> 标签：email, ant, jenkins, syntax-error, attachment

我正在尝试让 Jenkins 将一个文件或一组文件附加到作业已完成的电子邮件通知中。我不断收到以下错误：

为触发器发送电子邮件：成功错误：访问要附加的文件时出错：期望 Ant GLOB 模式，但看到了`C:\p\p\etc\\\*\*\\\*.html`。

请参阅[文件集](http://ant.apache.org/manual/Types/fileset.html)语法

是的，我查看了该网站并尝试了我能想到的所有变体：

```
/ instead of \
../\*\*
../\*\*/\*.html
removing C: 
```

我在这里缺少的 Ant GLOB 模式是什么？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-31T15:51:37.990

附件的基本目录是工作区目录。通常，这意味着您不能附加目录层次结构中高于工作空间的文件（好吧，您可以使用 ../，但您必须非常确定您的工作空间位置）。解决此类问题的方法是首先在构建步骤中将文件复制到工作区中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-25T08:35:22.670

阅读[https://issues.jenkins-ci.org/browse/JENKINS-23329](https://issues.jenkins-ci.org/browse/JENKINS-23329)中报告的问题。也许，Hockeyapp 插件或 jenkins 已经更新，所以文件应该在 WORKSPACE 下；不需要路径中的 $WORKSPACE，只需要添加路径/到/apk 或路径/到/ipa。

因此，改变：

> C:\p\p\etc***.html'

至

> **\*.html'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-14T06:34:10.070

这可能是因为作业（项目）配置中提到的附件在本地目录中

检查可用的附件

*“c:/users/username/.jenkins/workspace/Currentproject/”*

# emacs - 如何防止emacs使用Cx o切换到某些窗口？

> ID：11731332
> 
> 赞同：2
> 
> 时间：2012-07-30T23:54:53.003
> 
> 标签：emacs, gdb, emacs-ecb

有没有办法在emacs中设置一些不可访问的窗口？

例如，在 gdb show-many-windows 视图中，我不想每次都切换到局部变量窗口或堆栈窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:07:52.290

`C-x o`设置为`other-window`。众所周知，它很难定制，但你可以这样做：它尊重[window 参数](http://www.gnu.org/software/emacs/manual/html_node/elisp/Window-Parameters.html) `'no-other-window`。你的目标将是做`(set-window-parameter gdb-window 'no-other-window t)`。现在，剩下的唯一部分就是让我们进入`gud`并在窗口上设置这些属性。

一个好的开始是

```
(defun make-selected-window-unselectable ()
  (interactive)
  (set-window-parameter (selected-window) 'no-other-window t))
(global-set-key "\M-p" 'make-selected-window-unselectable) 
```

有人可能会为这个名字讨价还价，因为窗口并不是真正无法选择的，但它会凑合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T13:40:38.327

`other-window`您可以尝试使用[WindMove](http://emacswiki.org/emacs/WindMove "风动") ，而不是尝试自定义，它可以按方向进行框架导航。

# css - 如何将一条规则应用于多个选择器

> ID：11731338
> 
> 赞同：3
> 
> 时间：2012-07-30T23:56:04.970
> 
> 标签：css, css-selectors

我想为所有标题应用一种格式。

所以，我补充说

```
 .myformat h1, h2, h3, h4, h5, h6  {  margin-bottom : 1em; ... } 
```

这么写，不考虑第一个`hx`。这些规则不适用于 h1。

当我像这样写

```
 .myformat h1, h2, h3, h4, h5, h6, h1  {  margin-bottom : 1em; ... } 
```

一切都很好。这些规则适用于 h1、h2、... 和 h6。

这很可疑……我想我在其他地方有问题，但我看不到。

将规则应用于多个选择器是否正确？

我在窗口上的 IE9 和 Chrome20 上有相同的行为。也在 Fedora15 上的 Firefox12 上复制

* * *

编辑

我希望能够做类似的事情

```
<h1 class="myformat">This text will be red and 
                     or all hx where I apply "myformat"
</h1>
<p class="myformat">This text will be yellow only
                    when myformat is applied on a paragraph
</p> 
```

我`.myformat h1, h2, h3, h4, h5, h6 { margin-bottom : 1em; ... }`相信这个“​​myformat”只会应用于标题。

我本来正在创作`.myformat p { margin-bottom : 3em; ... }`
，但我阻止了`<h1 class="myformat">text</h1>`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T00:04:38.857

像这样尝试 .myformat h1、.myformat h2、.myformat h3 等。

这是假设 h1 的 h2 的 h3 都在一个名为 .myformat 的 div 中。

你可以在这里查看：http: [//jsfiddle.net/fYgdA/5/](http://jsfiddle.net/fYgdA/5/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T00:02:06.003

您正在使用正确的语法。您遇到的问题可能与选择器有关`.myformat h1`。检查您的 html 代码，该选择器只会`h1`在带有 class 的元素中找到一个`myformat`。例如：

```
<div class='myformat'>
   <h1>Header One</h1>
</div> 
```

如果`myformat`是 on`h1`那么你会想要使用 selector `h1.myformat`。因此，如果您的 html 如下所示，该选择器将起作用：

```
<h1 class='myformat'>Header One</h1> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T01:49:12.387

`.myformat{margin-bottom:1em;}`如果您的标记类似于下面的示例，则有一个规则是合适的。由于选择器的特殊性，这将起作用，并将适用于任何具有`myformat`类的元素。

```
<h1 class="myformat">Header</h1>
<h2 class="myformat">Subheader</h2>
... 
```

鉴于您想使用同一个类分别设置*标题*和*段落*`myformat`的样式，您有两种选择。您可以使用冗长（过度限定）的选择器，例如

```
h1.myformat, h2.myformat, h3.myformat {/*some style*/}
p.myformat {/*some other style*/} 
```

或者您可以选择单独的类名，这将是更可取的 imo

```
.myformat-title {/*some styles to apply to headers*/}
.myformat-content {/*some styles to apply to paragraphs*/} 
```

当你说*`.myformat p...`但我阻止了`<h1 class="myformat">text</h1>`*，你到底是什么意思？如果最终结果与您的预期不同，也许您正在经历[利润崩溃](http://www.w3.org/TR/CSS2/box.html#collapsing-margins)？

# android - 如何使按钮适合相同数量的屏幕并在 android 应用程序上位于相同位置

> ID：11731339
> 
> 赞同：0
> 
> 时间：2012-07-30T23:56:05.727
> 
> 标签：android, xml, eclipse, density-independent-pixel

我有一个基本的音板应用程序，我正在使用 eclipse 为 android 开发它，它有 8 个按钮。当我在默认的 3.7" nexus 上查看这些时，它们的尺寸和位置都很完美，但是当我使用另一个屏幕时，例如 4.7"，按钮要小得多，而且不是我想要的位置，我知道这与屏幕尺寸与我认为的尺寸的比例有关。这是我的 activity_main.xml ：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/appbackground" >

<Button
    android:id="@+id/button1"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="45dp"
    android:layout_marginTop="116dp"
    android:text="@string/button" />

<Button
    android:id="@+id/button2"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignBaseline="@+id/button1"
    android:layout_alignBottom="@+id/button1"
    android:layout_alignParentRight="true"
    android:layout_marginRight="40dp"
    android:text="@string/button2" />

<Button
    android:id="@+id/button3"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignLeft="@+id/button1"
    android:layout_below="@+id/button1"
    android:layout_marginTop="32dp"
    android:text="@string/button3" />

<Button
    android:id="@+id/button4"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignBaseline="@+id/button3"
    android:layout_alignBottom="@+id/button3"
    android:layout_alignRight="@+id/button2"
    android:text="@string/button4" />

<Button
    android:id="@+id/button5"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignLeft="@+id/button3"
    android:layout_below="@+id/button3"
    android:layout_marginTop="29dp"
    android:text="@string/button5" />

<Button
    android:id="@+id/button6"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignBaseline="@+id/button5"
    android:layout_alignBottom="@+id/button5"
    android:layout_alignLeft="@+id/button4"
    android:text="@string/button6" />

<Button
    android:id="@+id/button7"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignLeft="@+id/button5"
    android:layout_below="@+id/button5"
    android:layout_marginTop="30dp"
    android:text="@string/button7" />

<Button
    android:id="@+id/button8"
    android:layout_width="110dp"
    android:layout_height="50dp"
    android:layout_alignBaseline="@+id/button7"
    android:layout_alignBottom="@+id/button7"
    android:layout_alignLeft="@+id/button6"
    android:text="@string/button8" />

</RelativeLayout> 
```

谢谢，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:23:45.937

发生这种情况是因为您提供了`Buttons`精确的尺寸。我没有浏览您的整个 XML，所以我不知道您是如何`Buttons`设置的，但请尝试使用嵌入`LinearLayout`与`android:layout_weight`属性的组合。

如果您将它们放在网格中，请尝试使用`Grid`

# ruby - Ruby 中 at_exit 和 END（大写）的区别

> ID：11731341
> 
> 赞同：8
> 
> 时间：2012-07-30T23:56:59.430
> 
> 标签：ruby, keyword

[Kernel#at_exit](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-at_exit)方法和[END](http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-END)（全部大写）关键字之间存在哪些差异（如果有）？后者仅仅是一种更 Perlish 的做事方式，而前者更像 Ruby 风格吗？

我试过做`defined?(END {puts "Bye"})`，但出现语法错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T00:01:54.880

“The Ruby Programming Language”定义了它们行为的细微差别。`at_exit`在循环内可以多次调用，每次迭代调用都会在代码退出时执行。`END`只会在循环内调用一次。

> ...如果 END 语句在循环中并且执行了多次，则与之关联的代码仍然只注册一次：

```
a = 4;
if (true)
  END { # This END is executed
  puts "if"; # This code is registered
  puts a # The variable is visible; prints "4"
}
else
  END { puts "else" } # This is not executed
end
10.times {END { puts "loop" }} # Only executed once 
```

> 内核方法 at_exit 提供了 END 语句的替代方案；它在解释器退出之前注册一个要执行的代码块。与 END 块一样，与第一个 at_exit 调用关联的代码将最后执行。如果在一个循环中多次调用 at_exit 方法，则与它关联的块将在解释器退出时执行多次。

所以，运行：

```
2.times {
  END { puts 'END'}
  at_exit { puts 'at_exit' }
} 
```

结果是：

```
at_exit
at_exit
结尾

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T02:24:02.997

在方法内部使用`END`会产生警告，而`at_exit`不会产生警告（尽管两者仍然有效）：

```
def with_end
  END {puts 'with END'}
end

def with_at_exit
  at_exit {puts 'with at_exit'}
end

with_end
with_at_exit 
```

输出：

```
$ ruby foo.rb 
foo.rb:2: warning: END in method; use at_exit
with at_exit
with END 
```

在不太实用的层面上，[`END`是语言关键字](https://github.com/ruby/ruby/blob/30d957fc612a51fab686af5c6c0dfb58b5e100a1/parse.y#L11047)，[`at_exit`是语言中的方法](https://github.com/ruby/ruby/blob/30d957fc612a51fab686af5c6c0dfb58b5e100a1/eval_jump.c#L145)。

# ios - 如何使用 if/else 条件进行手电筒开关？

> ID：11731343
> 
> 赞同：0
> 
> 时间：2012-07-30T23:57:11.723
> 
> 标签：ios, uiswitch

所以我有一个 UISwitch 用于我的叠加层，每次相机出现时都会出现。现在，当我打开按钮或向右滑动开关（开启模式）时，手电筒就会打开。但是当我把它切换到左边时，它并没有关闭。我究竟做错了什么？

```
- (void)mySwitchPressed {
    if (self.mySwitch.on) { 
        AVCaptureDevice *flashLight = [AVCaptureDevice
        defaultDeviceWithMediaType:AVMediaTypeVideo];
        if([flashLight isTorchAvailable] && [flashLight
            isTorchModeSupported:AVCaptureTorchModeOn]) {
            BOOL success = [flashLight lockForConfiguration:nil];
            if(success) {
                [flashLight setTorchMode:AVCaptureTorchModeOn];
                [flashLight unlockForConfiguration];
            }
        } else {
            AVCaptureDevice *flashLight = [AVCaptureDevice
            defaultDeviceWithMediaType:AVMediaTypeVideo];
            if([flashLight isTorchAvailable] && [flashLight 
                isTorchModeSupported:AVCaptureTorchModeOn]) {
                BOOL success = [flashLight lockForConfiguration:nil];
                if(success) {
                    [flashLight setTorchMode:AVCaptureTorchModeOff];
                    [flashLight unlockForConfiguration];
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:16:47.890

重新格式化您的代码后，您的子句似乎`else`位于错误的位置。尝试在第一个块`else`结束后移动 to ：`if`

```
- (void)mySwitchPressed {
    if (self.mySwitch.on) { 
        AVCaptureDevice *flashLight = [AVCaptureDevice
        defaultDeviceWithMediaType:AVMediaTypeVideo];
        if([flashLight isTorchAvailable] && [flashLight
            isTorchModeSupported:AVCaptureTorchModeOn]) {
            BOOL success = [flashLight lockForConfiguration:nil];
            if(success) {
                [flashLight setTorchMode:AVCaptureTorchModeOn];
                [flashLight unlockForConfiguration];
            }
        }
    } else {
        AVCaptureDevice *flashLight = [AVCaptureDevice
        defaultDeviceWithMediaType:AVMediaTypeVideo];
        if([flashLight isTorchAvailable] && [flashLight 
            isTorchModeSupported:AVCaptureTorchModeOn]) {
            BOOL success = [flashLight lockForConfiguration:nil];
            if(success) {
                [flashLight setTorchMode:AVCaptureTorchModeOff];
                [flashLight unlockForConfiguration];
            }
        }
    }
} 
```

# azure - Windows Azure 中的 ZeroMQ

> ID：11731351
> 
> 赞同：0
> 
> 时间：2012-07-30T23:58:06.370
> 
> 标签：azure, zeromq

我正在尝试部署使用 ZeroMQ 的 Azure Web 角色。在我的本地机器上，一切正常，但是当我部署它时，我收到以下错误：

```
Unable to load DLL 'libzmq': The specified module could not be found 
```

我已将 dll 的构建属性标记为“内容”，并且可以在正在创建的包中看到它。有什么我忽略的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T09:34:58.563

单击 DLL 文件并将其“复制到输出目录”属性设置为“始终复制”。
您可以通过提取和检查 .cspkg 文件来验证 DLL 是否正在复制到云中（您可以将其重命名为 .zip 并提取它）。

还要确保 DLL 编译为 64 位，否则它将无法在 Azure 中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T07:21:12.043

我终于弄明白了。事实证明，最新的 libzmq 是使用 VS2010 构建的，因此它依赖于 VC++ 2010 运行时。Azure 实例默认没有它们，因此您需要让您的角色在启动之前安装依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-07T08:37:33.410

您可以尝试此处显示的示例[Pub/Sub with ZeroMQ on Azure](http://coderead.wordpress.com/2012/10/10/pubsub-with-zeromq-on-azure/)

# iphone - 防止在将 XML 转换为 Dictionary 时创建额外的对象

> ID：11731353
> 
> 赞同：1
> 
> 时间：2012-07-30T23:58:13.873
> 
> 标签：iphone, objective-c, ios, cocoa

我使用 XML 阅读器将 XML 字符串转换为数组。解析器正在向键“值”添加一个子元素，而我的 obj-c 技能还不足以弄清楚如何防止它 - 我是一个 PHP 人，正在帮助一个朋友。我还需要降低 2 个子元素，以便显示办公室和完成的办公室。

我在输入什么

```
 <?xml version="1.0" encoding="utf-8"?>
        <offices>
          <office>
            <phone>02-7532490</phone>
            <address>312 Sen. Gil Puyat Avenue, 18th Flr. Trident Tower</address>
            <suburb>Makati</suburb>
            <postcode>1200</postcode>
            <email>careers@drakepersonnel.com.ph</email>
            <name>Drake Makati</name>
            <latitude>14.56213</latitude>
            <longitude>121.02437</longitude>
          </office>
        </offices> 
```

我从解析器得到什么

```
 {
                offices =     {
                    office =         {
                        Address =             {
                            value = "312 Sen. Gil Puyat Avenue, 18th Flr. Trident Tower";
                        };
                        Emails =             {
                            value = "careers@drakepersonnel.com.ph";
                        };
                        Office =             {
                            value = Makati;
                        };
                        Tel =             {
                            value = "02-7532490";
                        };
                        latitude =             {
                            value = "14.56213";
                        };
                        longitude =             {
                            value = "121.02437";
                        };
                        name =             {
                            value = "Drake Makati";
                        };
                        postcode =             {
                            value = 1200;
                        };
                        value = "";
                    };
                    value = "";
                };
            } 
```

我想从解析器中得到什么（有些标签不一样……我知道）

```
 (
                    {
                    Address = "1904B 19th Floor West Tower, Philippine Stock Exchange Centre, Exchange Road, Ortigas Center, Pasig City 1600";
                    Emails = "clients@drakepersonnel.com.ph";
                    Fax = "632 753 1524 loc 106";
                    GeoLocation = "14.58273, 121.06154";
                    Office = Philippines;
                    Tel = "632 753 1522-24 / 632 753 2490-93";
                }
            ) 
```

这是我使用的 XMLreader.m 文件

```
 //
        //  XMLReader.m
        //
        //  Created by Troy on 9/18/10.
        //  Updated by Antoine Marcadet on 9/23/11.
        //

        #import "XMLReader.h"

        NSString *const kXMLReaderTextNodeKey       = @"value";
        NSString *const kXMLReaderAttributePrefix   = @"@";

        @interface XMLReader ()

        - (id)initWithError:(NSError **)error;
        - (NSDictionary *)objectWithData:(NSData *)data options:(XMLReaderOptions)options;

        @end

        @implementation XMLReader

        #pragma mark -
        #pragma mark Public methods

        + (NSDictionary *)dictionaryForXMLData:(NSData *)data error:(NSError **)error
        {
            XMLReader *reader = [[XMLReader alloc] initWithError:error];
            NSDictionary *rootDictionary = [reader objectWithData:data options:0];
            [reader release];
            return rootDictionary;
        }

        + (NSDictionary *)dictionaryForXMLString:(NSString *)string error:(NSError **)error
        {
            NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding];
            return [XMLReader dictionaryForXMLData:data error:error];
        }

        + (NSDictionary *)dictionaryForXMLData:(NSData *)data options:(XMLReaderOptions)options error:(NSError **)error
        {
            XMLReader *reader = [[XMLReader alloc] initWithError:error];
            NSDictionary *rootDictionary = [reader objectWithData:data options:options];
            [reader release];
            return rootDictionary;
        }

        + (NSDictionary *)dictionaryForXMLString:(NSString *)string options:(XMLReaderOptions)options error:(NSError **)error
        {
            NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding];
            return [XMLReader dictionaryForXMLData:data options:options error:error];
        }

        #pragma mark -
        #pragma mark Parsing

        - (id)initWithError:(NSError **)error
        {
            if (self = [super init])
            {
                errorPointer = error;
            }
            return self;
        }

        - (void)dealloc
        {
            [dictionaryStack release];
            [textInProgress release];
            [super dealloc];
        }

        - (NSDictionary *)objectWithData:(NSData *)data options:(XMLReaderOptions)options
        {
            // Clear out any old data
            [dictionaryStack release];
            [textInProgress release];

            dictionaryStack = [[NSMutableArray alloc] init];
            textInProgress = [[NSMutableString alloc] init];

            // Initialize the stack with a fresh dictionary
            [dictionaryStack addObject:[NSMutableDictionary dictionary]];

            // Parse the XML
            NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];

            [parser setShouldProcessNamespaces:(options & XMLReaderOptionsProcessNamespaces)];
            [parser setShouldReportNamespacePrefixes:(options & XMLReaderOptionsReportNamespacePrefixes)];
            [parser setShouldResolveExternalEntities:(options & XMLReaderOptionsResolveExternalEntities)];

            parser.delegate = self;
            BOOL success = [parser parse];

            [parser release];

            // Return the stack's root dictionary on success
            if (success)
            {
                NSDictionary *resultDict = [dictionaryStack objectAtIndex:0];
                return resultDict;
            }

            return nil;
        }

        #pragma mark -
        #pragma mark NSXMLParserDelegate methods

        - (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
        {
            // Get the dictionary for the current level in the stack
            NSMutableDictionary *parentDict = [dictionaryStack lastObject];

            // Create the child dictionary for the new element, and initilaize it with the attributes
            NSMutableDictionary *childDict = [NSMutableDictionary dictionary];
            [childDict addEntriesFromDictionary:attributeDict];

            // If there's already an item for this key, it means we need to create an array
            id existingValue = [parentDict objectForKey:elementName];
            if (existingValue)
            {
                NSMutableArray *array = nil;
                if ([existingValue isKindOfClass:[NSMutableArray class]])
                {
                    // The array exists, so use it
                    array = (NSMutableArray *) existingValue;
                }
                else
                {
                    // Create an array if it doesn't exist
                    array = [NSMutableArray array];
                    [array addObject:existingValue];

                    // Replace the child dictionary with an array of children dictionaries
                    [parentDict setObject:array forKey:elementName];
                }

                // Add the new child dictionary to the array
                [array addObject:childDict];
            }
            else
            {
                // No existing value, so update the dictionary
                [parentDict setObject:childDict forKey:elementName];
            }

            // Update the stack
            [dictionaryStack addObject:childDict];
        }

        - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
        {
            // Update the parent dict with text info
            NSMutableDictionary *dictInProgress = [dictionaryStack lastObject];

            // Set the text property
            if ([textInProgress length] > 0)
            {
                // trim after concatenating
                NSString *trimmedString = [textInProgress stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceAndNewlineCharacterSet]];

                [dictInProgress setObject:[[trimmedString mutableCopy] autorelease] forKey:kXMLReaderTextNodeKey];

                // Reset the text
                [textInProgress release];
                textInProgress = [[NSMutableString alloc] init];
            }

            // Pop the current dict
            [dictionaryStack removeLastObject];
        }

        - (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
        {
            // Build the text value
            [textInProgress appendString:string];
        }

        - (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError
        {
            // Set the error pointer to the parser's error object
            *errorPointer = parseError;
        }

        @end 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:19:24.630

从 XML 解析器的结果字典中选择您需要的值的问题在哪里？如果您知道 XML 元素名称，您可以轻松地执行以下操作：

```
NSDictionary *xmlParsedDict = ....
NSDictionary *offices = [xmlParsedDict objectForKey:@"offices"];
NSDictionary *office = [offices objectForKey:@"office"]; 
```

此外，我希望 XML 元素`offices`可以包含多个办公室，因此您只需从数组中收集所有`office`字典。`offices`

干杯，安卡

# wordpress - WordPress 3.4.1 将二月显示为三月

> ID：11731358
> 
> 赞同：1
> 
> 时间：2012-07-30T23:59:39.210
> 
> 标签：wordpress, archive

所以今天我写了一个很好的 ol' mod 来按年、按月显示我的帖子存档，然后通过带有 jquery 显示/隐藏功能的帖子显示我注意到一些相当令人沮丧的事情。

我正在使用任何人为此使用的标准代码：

```
<? $months = $wpdb->get_col("SELECT DISTINCT MONTH(post_date)
    FROM $wpdb->posts WHERE post_status = 'publish' AND post_type = 'post'
    AND YEAR(post_date) = '".$year."' ORDER BY post_date DESC");
    foreach($months as $month) :
?> 
```

现在烦人的部分......当显示月份时，二月显示为三月！所以月份去一月，三月，三月，四月......

我搜索了 wordpress 文件，看看 March 是否出现在应该写为 February 的任何地方，但一切都很好。当在 wp_query 生成的帖子列表中显示日期时，帖子列表会显示 2 月应该在哪里，应该在哪里。只有在使用上面的代码时，二月才会显示为游行，但会显示二月的帖子，而三月的第二个实例应该会显示游行的帖子。

任何人都知道这到底是怎么回事，甚至更好的是，如何解决它？？？

编辑：

我发现这是导致问题的代码：

```
<?php echo date( 'F', mktime(0, 0, 0, $month) );?> 
```

我将代码编辑为：

```
<?php echo $month;?> 
```

现在它正确显示了月份 NUMBER。我怎样才能让它显示名字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T05:27:02.417

本月的底层 -1。

```
 <? $months = $wpdb->get_col("SELECT DISTINCT MONTH(post_date)
        FROM $wpdb->posts WHERE post_status = 'publish' AND post_type = 'post'
        AND YEAR(post_date) = '".$year."' ORDER BY post_date DESC");
        foreach($months as $month) {

           echo $month-1;
       }
    ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T07:27:40.243

对于所有面临这个问题的人：

```
<? $months = $wpdb->get_col("SELECT DISTINCT MONTH(post_date)
    FROM $wpdb->posts WHERE post_status = 'publish' AND post_type = 'post'
    AND YEAR(post_date) = '".$year."' ORDER BY post_date DESC");

    foreach($months as $month) :
?> 
```

然后使用设置所有参数的 mktime，并添加 1：

```
<?php echo date( 'F', mktime(0, 0, 0, $month+1, 0, 0, 0) );?> 
```

# facebook - 使用 Facebook 应用程序和通知邀请应用程序用户参加活动

> ID：11731362
> 
> 赞同：1
> 
> 时间：2012-07-31T00:00:08.033
> 
> 标签：facebook, facebook-graph-api

我已阅读[http://developers.facebook.com/docs/reference/api/event/#invited](http://developers.facebook.com/docs/reference/api/event/#invited)

我正在寻找一点澄清。当它声明需要“create_event”权限时，这是否意味着与应用程序连接的每个用户都需要批准 create_event 权限才能接收邀请，或者只是作为应用程序所有者/经理的用户。

此外，您现在是否仍然可以成功地向应用程序的用户发送活动邀请，并且它会出现在他们即将举行的活动中，但他们不会通过标题中的地球图标收到通知？

有解决方法吗？使用请求对话框，应用管理员是否可以向所有应用用户发送更新，通知他们该事件？

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T15:15:03.357

> 当它声明需要“create_event”权限时，这是否意味着每个与应用程序连接的用户都需要批准 create_event 权限才能接收邀请

这意味着*使用该应用程序的人*必须批准**create_event**。事实上，Facebook*权限*总是如此，它们适用于*使用该应用程序*的人。此外，邀请只能发送给该用户的朋友，*而不能发送给使用该应用程序的其他人*。使用长寿命访问令牌，您可以邀请*应用程序用户*，但您必须使用每个邀请的唯一访问权限，这就像用户*通过应用程序*邀请自己一样。

> 此外，您现在是否仍然可以成功地向应用程序的用户发送活动邀请，并且它会出现在他们即将举行的活动中，但他们不会通过标题中的地球图标收到通知？

上次我检查是这样的。我怀疑它已经改变了，因为 Facebook 不想通过邀请向通知地球发送垃圾邮件。

> 有解决方法吗？使用请求对话框，应用管理员是否可以向所有应用用户发送更新，通知他们该事件？

是的，您可以使用请求对话框强制通过通知，单击该通知可能会导致重定向到事件的页面。但是，只会为*用户到用户的*请求**而不是** *应用到用户*的请求生成通知。后者会增加某些计数器，但不会为地球生成通知。另请注意，您一次只能向*用户*请求发送 50 个用户。

# c# - 使用 tcp 套接字发送和接收图像

> ID：11731363
> 
> 赞同：0
> 
> 时间：2012-07-31T00:00:40.840
> 
> 标签：c#, image, tcp

我已经制作了这些代码来使用 TCP 套接字发送和接收图像，但接收代码不起作用，希望你能帮助我这是发送代码

```
public void SendImage()
{
    int ScreenWidth = Screen.GetBounds(new Point(0, 0)).Width;
    int ScreenHeight = Screen.GetBounds(new Point(0, 0)).Height;
    Bitmap bmpScreenShot = new Bitmap(ScreenWidth, ScreenHeight);

    Graphics gfx = Graphics.FromImage((Image)bmpScreenShot);
    gfx.CopyFromScreen(0, 0, 0, 0, new Size(ScreenWidth, ScreenHeight));
    bmpScreenShot.Save(Application.StartupPath + "/ScreenShot.jpg", ImageFormat.Jpeg);
    byte[] image = new byte[1];
    bmpScreenShot = ResizeBitmap(bmpScreenShot, 300, 300);

    image = ImageToByte(bmpScreenShot);
    //get the length of image (length of bytes)
    int NumberOfBytes = image.Length;
    //put the size into a byte array
    byte[] numberofbytesArray = BitConverter.GetBytes(NumberOfBytes);

    //send the size to the Client
    int sizesend = sck.Send(numberofbytesArray, 0, numberofbytesArray.Length, 0);
    if (sizesend > 0)
    {
        MessageBox.Show("Size Sent");
    }
    //send the image to the Client
    int imagesend =sck.Send(image, 0, NumberOfBytes, 0);
    if (imagesend > 0)
    {
        MessageBox.Show("Image Sent");
    }
} 
```

这是接收代码

```
public void ReceiveImage()
{
    if (sck.Connected)
    {
        NetworkStream stream = new NetworkStream(sck);
        byte[] data = new byte[4];

        //Read The Size
        stream.Read(data, 0, data.Length);
        int size = IPAdress.HostToNetworkOrder(BitConverter.ToInt32(data,0));
        // prepare buffer
        data = new byte[size];

        //Load Image
        int read = 0;
        while (read != data.Length)
        {
           read += stream.Read(data, read, data.Length - read);
        }
        //stream.Read(data, 0, data.Length);
        //Convert Image Data To Image
        MemoryStream imagestream = new MemoryStream(data);
        Bitmap bmp = new Bitmap(imagestream);
        pictureBox1.Image = bmp;                    
    }
} 
```

* * *

**删除 IPAdress.HostToNetworkOrder 到以下内容后**编辑****

 **```
int size = BitConverter.ToInt32(data,0); 
```

还是有问题。问题是当我发送大小时，它以 5kb 的形式发送，但当我收到它时，我发现它更接近 2GB。

此外，我在这一行得到一个错误

```
read += stream.Read(data, read, data.Length - read); 
```

带有以下消息

> 无法从传输连接读取数据。由于系统缺少足够的缓冲区空间或队列已满，因此可能会在套接字上执行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:08:50.007

不要使用 HostToNetwork 顺序，除非您正在创建一个应该与 java 服务器/客户端兼容的服务器。如果这样做，您还需要更改要发送的 int 数据缓冲区的顺序。

您还可以受益于将您在客户端收到的字节直接写入内存流，而不是分配数据并将字节写入内存流。`imagestream.Position = 0`还有一个重要的注意事项，在将其交给位图构造函数之前不要忘记设置。**

# backbone.js - 集合上的骨干关系函数

> ID：11731365
> 
> 赞同：3
> 
> 时间：2012-07-31T00:00:58.147
> 
> 标签：backbone.js, backbone-relational

我正在做一个有点大的基于主干的网络应用程序，并且我正在使用主干关系。我想知道我是否可以在一对多关系上有一个自定义函数。

IE 如果我有一个国家模型并且它与多个元数据模型（每个都有一个类型属性）相关，并且我想制作一个函数来将相关集合过滤到某种类型。这不是最好的例子（我不想公开提及项目的细节），但这是我制作的一些示例代码（它可能不是 100% 正确，但它让想法得以通过）：

```
var Country = Backbone.RelationalModel.extend({

  relations: [
    {
      type: Backbone.HasMany,
      key: 'metas',
      relatedModel: Metadata,
      collectionType: MetadataCollection,
      reverseRelation: {
        key: 'country',
        includeInJSON: '_id'
      }
    }
  ]

});

var Metadata = Backbone.RelationalModel.extend({

  subModelTypes: {
    'landmark' : 'Landmark',
    'city' : 'City'
  }

});

var Landmark = Metadata.extend({});
var City = Metadata.extend({})

var MetadataCollection = Backbone.Collection.extend({

  model: Metadata,

  filterType: function(type){
    this.filter(function(meta){
      return meta.get('type') === type;
    })
  }

});

var Countries = Backbone.Collection.extend({

  model: Country

})

var countries = new Countries([
  {
    name: 'Australia',
    metas: [
      {
        type: 'landmark',
        name: 'Uluru'
      },
      {
        type: 'landmark',
        name: 'Sydney Opera House'
      },
      {
        type: 'city',
        name: 'Sydney'
      }
    ]
  }  
]);

countries.get(1).get('metas').filterType('landmark')
// TypeError: Object [object Object] has no method 'filterType' 
```

有谁知道你能不能做到这一点？如果有另一种好方法可以做到这一点（同时仍将不同类型保留在同一个集合中），我很想知道。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-10T04:18:44.360

创建单独对象以充当您的集合的代理的一般模式。代理包含对基本集合的引用和它自己的包含缩减集的集合。然后，此代理侦听基本集合上的事件并相应地更新过滤的集合，并根据需要转发事件。有了这个，您可以像往常一样从基本集合中添加、更新和删除模型，让代理根据需要自行更新，并将您的视图或任何消耗过滤集合的东西连接到代理。

由于手动执行此操作有点痛苦且容易出错，我建议使用此库：[https ://github.com/jmorrell/backbone.obscura](https://github.com/jmorrell/backbone.obscura)

如果您熟悉关系数据库中视图的概念，这也是同样的想法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-27T00:02:22.320

```
countries.at(1).get('metas').filterType('landmark') 
```

# java - Servlet 返回“HTTP 状态 404 请求的资源 (/servlet) 不可用”

> ID：11731377
> 
> 赞同：106
> 
> 时间：2012-07-31T00:02:45.400
> 
> 标签：java, forms, jsp, servlets, http-status-code-404

我的文件`WebContent/jsps`夹中的 JSP 文件中有一个 HTML 表单。我在文件夹`servlet.java`中的默认包中有一个 servlet 类。`src`在我的`web.xml`它被映射为`/servlet`.

我`action`在 HTML 表单的属性中尝试了几个 URL：

```
<form action="/servlet"> 
```

```
<form action="/servlet.java"> 
```

```
<form action="/src/servlet.java"> 
```

```
<form action="../servlet.java"> 
```

但这些都不起作用。它们都在 Tomcat 6/7/8 中不断返回 HTTP 404 错误，如下所示：

> ### HTTP 状态 404 — /servlet
> 
> *说明*：请求的资源 (/servlet) 不可用。

或者在 Tomcat 8.5/9 中如下所示：

> ### HTTP 状态 404 - 未找到
> 
> *消息*：/servlet
> 
> *描述*：源服务器没有找到目标资源的当前表示或不愿意透露存在的表示

或者在 Tomcat 10 中如下所示：

> ### HTTP 状态 404 - 未找到
> 
> *类型*：状态报告
> 
> *消息*：请求的资源 (/servlet) 不可用
> 
> *描述*：源服务器没有找到目标资源的当前表示或不愿意透露存在的表示

为什么它不起作用？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2012-07-31T00:24:34.553

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-16T06:09:21.850

**场景 #1：**您在 tomcat**已经运行**时意外地从命令行**重新部署**。

 ****简答：**停止 Tomcat，**删除目标文件夹**，mvn 包，然后重新部署

* * *

**场景 #2：** request.getRequestDispatcher(" **MIS_SPELLED_FILE_NAME** .jsp")

**简短答案：**检查文件名**拼写**，确保**大小写**正确。

* * *

**场景#3：类未找到异常** （答案放在这里，因为：问题＃17982240）（[java.lang.ClassNotFoundException for servlet in tomcat with eclipse](https://stackoverflow.com/questions/17982240)）（被标记为重复并在此处指示我）

简短答案 #3.1：web.xml 在 servlet-class 标记中有错误的包路径。

简短答案 #3.2：java 文件有错误的导入语句。

* * *

## 以下是场景 #1 的更多详细信息：

* * *

1：停止Tomcat

*   选项 1：通过终端中的 CTRL+C。
*   选项2：（终端关闭而tomcat仍在运行）
*   ------------ 2.1：按：**Windows+R** --> 输入：“ **services.msc** ”
*   ------------ 2.2：在列表的名称栏中找到“Apache Tomcat #.# Tomcat#”。
*   ------------ 2.3：右键-->“**停止**”

2：删除“目标”文件夹。 **（这里 mvn clean 帮不了你）**

3：mvn包

4：*YOUR_DEPLOYMENT_COMMAND_HERE*

（我的：java -jar target/dependency/webapp-runner.jar --port 5190 target/*.war）

**完整的故事：**

* * *

不小心打开了一个新的 git-bash 窗口并尝试通过以下方式为我的 heroku 项目部署一个 .war 文件：

java -jar 目标/依赖/webapp-runner.jar --port 5190 目标/*.war

部署失败后，我意识到我打开了两个 git-bash 窗口，并且**没有使用 CTLR+C 停止之前的部署**。

我遇到了：

> HTTP 状态 404 - 未找到类型状态报告
> 
> 消息 /if-student-test.jsp
> 
> 描述 源服务器没有找到目标资源的当前表示或不愿意透露存在的表示。
> 
> Apache Tomcat/8.5.31

## 以下是场景 #3 的更多详细信息：

* * *

场景 3.1：您的 web.xml 文件中的 servlet 类包路径错误。

它应该匹配 java servlet 类顶部的包语句。

文件：my_stuff/ **MyClass.java**：

```
 package my_stuff; 
```

文件：PRJ_ROOT/src/main/webapp/WEB-INF/ **web.xml**

```
 <servlet-class>
   my_stuff.MyClass
   </servlet-class> 
```

场景 3.2：

您在 myClass.java 文件的顶部放置了错误的“ **package ”语句。**

例如：

文件位于：“ **/my_stuff** ”文件夹

你错误地写：

```
package com.my_stuff 
```

这很棘手，因为：

1：maven build（mvn包）这里不会报错。

2：web.xml 中的servlet-class 行可以有正确的包路径。例如：

```
<servlet-class>
my_stuff.MyClass
</servlet-class> 
```

* * *

使用的堆栈： **Notepad++** + **GitBash** + **Maven** + **Heroku Web App Runner** + **Tomcat9** + **Windows10**：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-12T08:05:02.317

检查您是否输入了 Web.xml 中指定的正确 URL 映射

例如：

在 web.xml 中，您的 servlet 声明可能是：

```
<servlet>
        <servlet-name>ControllerA</servlet-name>
        <servlet-class>PackageName.ControllerA</servlet-class>
</servlet>

<servlet-mapping>
        <servlet-name>ControllerA</servlet-name>
        <url-pattern>/theController</url-pattern>
</servlet-mapping> 
```

这个片段所做的是`<url-pattern>/theController</url-pattern>`设置将用于从前端（例如：表单）通过 URL 调用 servlet 的名称。因此，当您在前端引用 servlet 时，为了确保请求到达 servlet“ControllerA”，它应该从表单中引用指定的 URL 模式“theController”。

例如：

```
<form action="theController" method="POST">
</form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-04T17:24:07.693

我的问题是我的方法缺少 @RequestBody 注释。添加注释后，我不再收到 404 异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-20T22:29:53.897

执行以下两个步骤。我希望它能解决 java servlet 应用程序开发过程中 tomcat 服务器中的“404 not found”问题。

步骤1：`Right click on the server(in the server explorer tab)->Properties->Switch Location from workspace metadata to tomcat server`

第2步：`Double Click on the server(in the server explorer tab)->Select Use tomcat installation option inside server location menu`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-25T11:27:06.547

NetBeans IDE 中的解决方案`HTTP Status 404`：右键单击您的项目并转到您的项目属性，然后单击运行，然后输入您的项目相对 URL，如`index.jsp`.

1.  项目->属性
2.  点击运行
3.  相对 URL：/index.jsp（选择您的项目根 URL）

![在此处输入图像描述](../Images/56126b939835d7b46a459aba2026f91f.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-07T10:17:43.480

如果您是一名学生并且刚接触 Java，那么您的 web.xml 文件可能会出现一些问题。

> 1.  尝试删除 web.xml 文件。
> 2.  其次检查您的路径变量是否设置正确。
> 3.  重启tomcat服务器或者你的PC。

你的问题一定会解决的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-03T04:25:56.490

如果有人在这里使用 MySQL，并且感觉代码在前一天可以工作，而现在却不行，那么我想你必须打开 MySQL CLI 或 MySQL Workbench，然后只连接一次数据库。连接后，数据库也会连接到 Java 应用程序。我曾经收到 Hibernate Dialect 错误，说明 com.mysql.jdbc.Driver 有问题。我认为某些计算机中的 MySQL 存在启动问题。这为我解决了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-22T10:46:05.130

如果您想在不使用“表单”和“提交”按钮的情况下使用 javascript 打开一个 servlet，下面是以下代码：

```
var button = document.getElementById("<<button-id>>");
button.addEventListener("click", function() {
  window.location.href= "<<full-servlet-path>>" (eg. http://localhost:8086/xyz/servlet)
}); 
```

钥匙：

1) button-id ：在 html/jsp 文件中为按钮指定的“id”标签。

2）full-servlet-path：单独运行servlet时在浏览器中显示的路径

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-24T11:06:24.677

首先，以管理员身份运行 IDE。之后，右键单击项目文件夹 -> Project Facets 并确保 Java 版本设置正确。在我的电脑上。（例如 1.8）现在它应该可以工作了。

不要只使用 cmd 启动服务器，例如 Wildfly。它必须在 IDE 中启动，现在访问您的 localhost URL。示例：[http://localhost:8080/HelloWorldServlet/HelloWorld](http://localhost:8080/HelloWorldServlet/HelloWorld)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-07-31T10:26:14.220

一个旧线程，但由于我在其他地方没有找到它，这里还有一种可能性：

如果您使用的是**servlet-api 3.0+**，那么您的 web.xml**不得**包含`metadata-complete="true"`属性

[![在此处输入图像描述](../Images/d67e16a7583035cbbd274024a1a9744f.png)](https://i.stack.imgur.com/yqGgjl.png)

这告诉 tomcat 使用给定的数据`web.xml`而不是使用`@WebServlet`注释来映射 servlet。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-25T06:08:09.317

我删除了旧的 web 库，例如 spring 框架库。并建立图书馆的新路径。然后它工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-08-17T12:40:02.053

在 web.xml 中映射是我所做的：-

1.  如果为新程序制作了另一个软件包，那么我们必须提到：-

xml 文件中 servlet-class 标记的打开和关闭之间的 packagename.filename。

2.  如果您在 xml 中映射文件并且它们不工作或显示错误，请在相应文件中的代码注释行上进行注释。

两种方法都不能互相工作，所以我要么使用我们创建servlet时提到的文件的注释方法，要么使用映射的方式，然后我删除或注释注释行。例如：

```
 <servlet>
   <servlet-name>s1</servlet-name>
   <servlet-class>performance.FirstServ</servlet-class>
   </servlet>    

   <servlet-mapping>
   <servlet-name>s1</servlet-name>
   <url-pattern>/FirstServ</url-pattern>
   </servlet-mapping>

   <servlet>
   <servlet-name>s2</servlet-name>
   <servlet-class>performance.SecondServ</servlet-class>
   </servlet>

   <servlet-mapping>
   <servlet-name>s2</servlet-name>
   <url-pattern>/SecondServ</url-pattern>
   </servlet-mapping> 
```

* * *

如果已完成 xml 中的映射，请在相应文件中注释代码的注释行。

```
//@WebServlet("/FirstServ")
//@WebServlet("/SecondServ") 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-04T16:54:35.663

如果您使用的是 IntelliJ，这就是为我解决的问题：

转到Tomcat配置： [![在此处输入图像描述](../Images/44f28a34e11d1aee6db75c25aeef087a.png)](https://i.stack.imgur.com/flFCk.png)

配置 > 部署选项卡 [![在此处输入图像描述](../Images/ee045510b79e671ae3c538b46cf8c7ac.png)](https://i.stack.imgur.com/J3nA6.png)

向下滚动并添加`/`到应用程序上下文下拉列表 [![在此处输入图像描述](../Images/aaf0be6bba993175df0c40f440c013a1.png)](https://i.stack.imgur.com/4tHpi.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-12-08T05:29:04.817

对我有用的修复是（如果您使用的是 Maven）：右键单击您的项目，Maven -> 更新项目。这可能会给您在 JDK 和其他库（在我的情况下是 MySQL 连接器）方面带来一些其他错误，但是一旦您修复它们，您的原始问题应该得到修复！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-22T13:27:04.720

我也遇到了这个问题，当访问我知道链接到 Servlet 的 URL 模式时，我收到了 404。原因是因为我有 2 个 Servlet，它们的 @WebServlet`name`参数设置为相同的字符串。

```
@WebServlet(name = "ServletName", urlPatterns = {"/path"})
public class ServletName extends HttpServlet {} 
```

```
@WebServlet(name = "ServletName", urlPatterns = {"/other-path"})
public class OtherServletName extends HttpServlet {} 
```

两个`name`参数是一样的。如果您使用 name 参数，请确保它们与应用程序中的所有其他 Servlet 相比是唯一的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-09-10T10:48:12.187

我遇到了同样的问题。我正在开发一个基于 mvc 的 REST API，其中没有明确的 html 配置或文件。API 使用 Swagger 生成用户界面。当我介绍 Swagger 版本“3.0.0”时，问题就开始了。我恢复到 Swagger "2.9.2" 这解决了我的问题。

```
<!-- Swagger -->
    <dependency>
        <groupId>io.springfox</groupId>
        <artifactId>springfox-swagger-ui</artifactId>
        <version>2.9.2</version>
    </dependency>
    <dependency>
        <groupId>io.springfox</groupId>
        <artifactId>springfox-swagger2</artifactId>
        <version>2.9.2</version>
    </dependency> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-05-20T23:25:17.487

我遇到过同样的问题。尝试了所有这些但没有帮助。我设法通过在 xml 文件的开头和结尾添加元素标签来解决这个问题。生病将我的 xml 文件留在下面以供参考。

```
<?xml version="1.0" encoding="UTF-8"?>

<element>

<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
         version="3.1">

<servlet> 
    <servlet-name>InsertServlet</servlet-name> 
    <servlet-class>com.worklog.InsertServlet</servlet-class> 
</servlet> 
<servlet-mapping> 
    <servlet-name>InsertServlet</servlet-name> 
    <url-pattern>/insert</url-pattern> 
</servlet-mapping>

</web-app>

</element> 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2019-05-20T13:12:21.833

请检查**上下文根不能为空**。

如果您使用的是 eclipse：
**右键单击**，选择**属性**，然后选择**web 项目设置**。检查**上下文根不能为空****

# plist - 从 .plist 文件中提取 .png 图像

> ID：11731378
> 
> 赞同：1
> 
> 时间：2012-07-31T00:02:54.000
> 
> 标签：plist

我需要为 iPad 3 视网膜显示屏更新一些 .png 图像。唯一的问题是这些 .png 图像位于 .plist 文件中。

所以... 1) 我可以从 .plist 文件中手动提取 .png 文件吗？或者有没有这样的程序？或者，2）我可以编辑 .plist 文件中的 .png 文件的分辨率吗……一个例子……

```
 <key>opponent_left_1.png</key>
    <dict>
        <key>frame</key>
        <string>{{1914,1764},{88,81}}</string>
        <key>offset</key>
        <string>{41,-35}</string>
        <key>sourceSize</key>
        <string>{334,355}</string>
    </dict> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T16:57:44.173

PNG不在PLIST文件中，它只是一个简单的文本文件。它们可能位于 Resources 文件夹中，该文件夹与此 PLIST 文件相关联（基于 Mac OS X 包体系结构的答案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T12:41:54.293

这是用于提取 .png 图像的代码。使用此代码创建*extract.py*文件并从命令行运行： `extract.py name_of_sheet_without_extension`

此脚本使用提取的 .png 文件创建一个文件夹。

```
#! /usr/lical/bin/python
import os,Image,sys
from xml.etree import ElementTree

def tree_to_dict(tree):
    d = {}
    for index, item in enumerate(tree):
        if item.tag == 'key':
            if tree[index+1].tag == 'string':
                d[item.text] = tree[index + 1].text
            elif tree[index + 1].tag == 'true':
                d[item.text] = True
            elif tree[index + 1].tag == 'false':
                d[item.text] = False
            elif tree[index+1].tag == 'dict':
                d[item.text] = tree_to_dict(tree[index+1])
    return d

def gen_png_from_plist(plist_filename, png_filename):
    file_path = plist_filename.replace('.plist', '')
    big_image = Image.open(png_filename)
    root = ElementTree.fromstring(open(plist_filename, 'r').read())
    plist_dict = tree_to_dict(root[0])
    to_list = lambda x: x.replace('{','').replace('}','').split(',')
    for k,v in plist_dict['frames'].items():
        print "-----start\n----------"
        rectlist = to_list(v['frame'])
        print rectlist, "--------rectlist"
        offset = to_list(v['offset'])
        print offset, "--------offset"
        width = int( rectlist[3] if v['rotated'] else rectlist[2] )
        height = int( rectlist[2] if v['rotated'] else rectlist[3] )
        print width,height,"----width,height"
        box=( 
            int(rectlist[0]),
            int(rectlist[1]),
            int(rectlist[0]) + width,
            int(rectlist[1]) + height,
            )
        # bos is start & end point
        print box,"-----_box-"
        print v['rotated'], "---rotated"

        sizelist = [ int(x) for x in to_list(v['sourceSize'])]
        rect_on_big = big_image.crop(box)
        if v['rotated']:
            rect_on_big = rect_on_big.rotate(90)
        result_image = Image.new('RGBA', sizelist, (0,0,0,0))
        if v['rotated']:
            result_box=(
                (sizelist[0] - height)/2 + int(offset[0]),
                (sizelist[1] - width)/2 - int(offset[1]),
                (sizelist[0] + height)/2 + int(offset[0]),
                (sizelist[1] + width)/2 - int(offset[1])
            )
        else:
            result_box=(
                (sizelist[0] - width)/2 + int(offset[0]),
                (sizelist[1] - height)/2 - int(offset[1]),
                (sizelist[0] + width)/2 + int(offset[0]),
                (sizelist[1] + height)/2 - int(offset[1])
            )
        result_image.paste(rect_on_big, result_box, mask=0)
        if not os.path.isdir(file_path):
            os.mkdir(file_path)
        outfile = (file_path+'/' + k).replace('gift_', '')
        print result_box,"-----result_box-"
        print outfile, "generated"
        result_image.save(outfile)

if __name__ == '__main__':
    filename = sys.argv[1]
    plist_filename = filename + '.plist'
    png_filename = filename + '.png'
    if (os.path.exists(plist_filename) and os.path.exists(png_filename)):
        gen_png_from_plist( plist_filename, png_filename )
    else:
        print "make sure you have boith plist and png files in the same directory" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-15T05:39:23.973

.plist 包含压缩在一个 mazior png 中的不同 png 文件的信息。如果你有 .plist 和他相关的 .png 文件，那么你可以使用 TextureUnpacker 解压缩。

如果您的 PC 中有 Java，或者您可能已安装，那么您可以使用 TextureUnpacker 解压缩 .plist 文件。它还支持在 LibGdx 项目中使用的 .pack 文件和在许多引擎中使用的 .xml 文件，例如统一打包纹理。

[https://github.com/itsabhiaryan/TextureUnPacker](https://github.com/itsabhiaryan/TextureUnPacker)

# python - 如何固定弹球的运动方向并使其发生碰撞

> ID：11731381
> 
> 赞同：1
> 
> 时间：2012-07-31T00:03:18.407
> 
> 标签：python, game-physics, collision

我已经将这个弹球游戏程序作为我班级的作业，我一直在尝试修复弹球运动和碰撞。

第一个问题是，无论用户将速度设置为哪个方向，球都只会以特定角度移动。

我真的不知道为什么它不应该起作用，根据我的笔记、讲座幻灯片和讨论讲义，它应该没问题。那么有人知道为什么它不起作用吗？我环顾四周，找不到明确的答案。任何帮助将不胜感激。我很难过:(

*不工作是指无论用户将弹球设置为哪个方向，它都只会向一个方向移动（例如，用户设置弹球向左，弹球向右；用户设置弹球向上，向右；等等。 ) 此外，弹球不会与墙壁或任何目标发生碰撞。*

图形是[graphics.py：http://mcsp.wartburg.edu/zelle/python/graphics/graphics/index.html](http://mcsp.wartburg.edu/zelle/python/graphics/graphics/index.html)

这是碰撞代码（连同速度反转，只与游戏板的右壁保持碰撞）：

```
def checkHit(ball,target,dispX,dispY,VelX,VelY,hit): ###pulled the definition out of the loop but keeping it here for easier reference
     center = ball.getCenter() ###defines the center of the pinball as a point
     hit = 0 ###used for differentiating between objects collided with
     if center.getX() + 1 <= 45 and center.getX() + 1 + dispX > 45: ####if the pinball collides with the right wall of the board
         VelX = VelX *(-1) ###velocity in the x direction reverses
         hit = 0  ###did not collide with a target

for j in range(1000):####1000 frames (ball isn't expected to last long in the air, only a couple seconds)
     vy = vy - 9.8 ###effect of gravity
     dx = vx / math.sqrt(vx**2 + vy**2) ###speed in x direction over time
     dy = vy / math.sqrt(vx**2 + vy**2) ###speed in y direction over time
     checkHit(pinball,target_front1,dx,dy,vx,vy,0) ####runs function each frame for collision testing
     pinball.move(dx , dy) ###moves pinball 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:39:21.953

我不能确定，因为你没有告诉我们你`graphics`从哪里得到模块。学校最有可能。

尝试将某些`if`语句更改为`elif`s。您可能同时评估了太多东西或其他东西。考虑以下代码，您只希望*运行*以下`if`语句之一，但实际上，所有语句都在运行：

```
def foo(x):
 if x < 5:
  print 'x is greater than five'
 if x == 10:
  print 'x is 10'

foo(10)

>>> x is greater than 5
>>> x is 10 
```

如果将第二个更改`if`为`elif`，则如果运行第一个语句，则忽略`if`其余的s：`elif`

```
def bar(x):
 if x < 5:
  print 'x is greater than five'
 elif x == 10:  #changed this line to an 'elif' 
  print 'x is 10'

bar(10)

>>> x is greater than 5   #only prints once, because the first if statement is True 
```

您还定义了`checkHit`每个循环，浪费了系统资源。最好将其拉出循环并进入模块的最顶部。

* * *

编辑：实际上，上面的例子虽然是真的，但不是很好。想象一下`x`，如果一个速度大于`5`，一个球会停止滚动，所以你会将`x`now 更改为 a `0`。然后在第二`if`条语句之后立即检查它，看看它是否已停止。如果它停止了，请再次开始移动（`x == 5`或其他）。这意味着球永远不会停止移动，因为无论如何，到`if`语句结束时，球总是会再次开始移动。

所以你需要做的是使用一个`elif`语句而不是第二个`if`，因为除非前一个语句不是，`elif`否则不会评估。`if``True`

# ruby - 让 Net::Telnet 一次发送一个字符？

> ID：11731383
> 
> 赞同：0
> 
> 时间：2012-07-31T00:04:05.687
> 
> 标签：ruby, telnet

我正在尝试使用 Net::Telnet 登录某些设备。对于登录提示，设备每次需要一个字符来提示登录和密码。Ruby 一次发送整个用户名。有没有办法将它设置为一次发送一个字符？

这是我的脚本：

```
require 'net/telnet'
options = Hash.new
ipaddr = '10.160.64.103'

date = Time.new.strftime('-%H.%M.%S')

basedir = '.'

files = Dir.glob("#{ipaddr}*.log")

if files.size >= 0
  File.delete(files[0])
end

file = File.new("#{ipaddr}-telnet#{date}.log", "w")

tn = Net::Telnet::new("Host"       => ipaddr,
                      "Output_log" => "#{ipaddr}-telnet#{date}.log",
                      "Dump_log"   => "dump.log",
                      "Prompt"     => /->\z/ )

options["Name"]           ||= "anonymous"
options["Password"]       ||= "********"

tn.login(options) { |c| print c }

tn.close 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:15:55.503

我不相信有一种方法可以像登录方法那样简单，但是按照源代码`login`，我们可以做类似的事情：

```
prompt = /->\z/
login_prompt = /[Ll]ogin[: ]*\z/
password_prompt = /[Pp]ass(?:word|phrase)[: ]*\z/

# wait until we've seen a login prompt
tn.waitfor(login_prompt){|c| print c }
# print each user character, newline; wait for password prompt
(user+"\n").each_char{|c| tn.print(c) }
tn.waitfor(password_prompt){|c| print c }
# print each pass character, newline; wait for normal prompt
(pass+"\n").each_char{|c| tn.print(c) }
tn.waitfor(prompt){|c| print c } 
```

（请注意，我没有对此进行测试）

# node.js - NodeJS 事件会传递给它们的父函数吗？

> ID：11731386
> 
> 赞同：2
> 
> 时间：2012-07-31T00:04:23.997
> 
> 标签：node.js

如果 Node.JS 中的子函数发出事件，该函数的父函数会发出相同的事件吗？就像他们在浏览器 DOM 中的表现一样？还是`this`需要将事件传递给孩子才能关闭事件？

在[Node Docs](http://nodejs.org/api/all.html#all_event_uncaughtexception)中，它提到了“使事件循环冒泡”，我只是想知道这是否也适用于自定义发出的事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:05:29.047

[Hap](https://github.com/johngeorgewright/hap)是一个节点模块，可以提供您所要求的内容。您设置每个发射器的父母或孩子，然后让冒泡发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T13:23:32.683

这样做是不合适的，我知道这一点，但这是我处理具有多个文件的事件的临时修复。

我只是发出事件并监听`process`对象。是的，这是有罪的。那里已经有几个事件侦听器。如果您在 上观看超过 2 或 3 个自己的事件，则表示`process`您要求内存泄漏，但它确实有效。

我将调查是否可以创建和使用另一个全局变量。我感觉 Node 即将推出的支持`domain`将使这一切变得更容易。

# php - Javascript 正则表达式 preg_replace

> ID：11731387
> 
> 赞同：0
> 
> 时间：2012-07-31T00:04:24.147
> 
> 标签：php, javascript, regex

应用于此字符串的正则表达式（从 PHP 移植到 Javascript、Node.js）：

```
/users/:uid/posts/:pid
/users/:uid
/messages/:mid 
```

上面的字符串包含参数（在“：”符号之后），直到下一个正斜杠，我用字符串正则表达式替换它们。最终应该是这样的：

```
/users/([a-zA-Z0-9\-\_]+)/posts/([a-zA-Z0-9\-\_]+) 
```

所以路由中的所有参数，都应该用正则表达式字符串替换。我使用以下代码来实现这一点：

```
var fixedRoute = route[url].replace(/\\\:[a-zA-Z0-9\_\-]+/, '([a-zA-Z0-9\-\_]+)'); 
```

输出是一样的，字符串没有被替换。谁能帮我解决这个正则表达式？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:08:39.923

您忘记了[捕获组](http://www.regular-expressions.info/javascript.html)，它是反向引用。

所以这会变成 'hihi-foobar'.replace(/foo(bar)/i, $1);
将呈现“hihi-bar”。

**更新**（基于上面的评论）：

```
.replace(/:[upm]id/ig, ([a-zA-Z0-9\-\_]+)); 
```

# php - 在 PHP 中保存项目（无效名称）时出错

> ID：11731389
> 
> 赞同：0
> 
> 时间：2012-07-31T00:04:34.923
> 
> 标签：php, joomla2.5

我正在使用 Zoo CCK，并且已经修改了足够长的代码以使其看起来像我想要的那样。但是，当我提交项目时，我收到一个我无法弄清楚的错误（在标题中）。

为了减少混淆，我应该提到我对文件所做的编辑是添加 $message 的部分以及识别它的任何相关代码。

任何帮助，将不胜感激。下面是文件代码：

**错误：**保存项目时出错（名称无效）

```
<?php

// no direct access
defined('_JEXEC') or die('Restricted access');

// register ElementOption class
App::getInstance('zoo')->loader->register('ElementOption', 'elements:option/option.php');
// register ElementRepeatable class
App::getInstance('zoo')->loader->register('ElementRepeatable', 'elements:repeatable/repeatable.php');
/*
Class: ElementSelect
    The select element class
*/

class ElementMessage extends ElementOption implements iSubmittable  {

/*
   Function: edit
       Renders the edit form field.

   Returns:
       String - html
*/
public function edit(){

    $this->app->document->addStylesheet('elements:message/assets/css/submission.css');
    // init vars
    $options_from_config = $this->config->get('option', array());
    $multiple            = $this->config->get('multiple');
    $default             = $this->config->get('default');
    $name                = $this->config->get('name');
    $message         = $this->get('message');

    if (count($options_from_config)) {

        // set default, if item is new
        if ($default != '' && $this->_item != null && $this->_item->id == 0) {
            $this->set('option', $default);
        }

        $options = array();
        if (!$multiple) {
            $options[] = $this->app->html->_('select.option', '', '-' . JText::sprintf('Select %s', $name) . '-');
        }
        foreach ($options_from_config as $option) {
            $options[] = $this->app->html->_('select.option', $option['value'], $option['name']);
        }

        $style = $multiple ? 'multiple="multiple" size="5"' : '';

        $html[] = $this->app->html->_('select.genericlist', $options, $this->getControlName('option', true), $style, 'value', 'text', $this->get('option', array()));
        $html[] = $this->app->html->_('control.text', $this->getControlName('Message'), $this->get('message'), 'name="message" size="30" maxlength="255" placeholder="'.JText::_('Message').'"');

        // workaround: if nothing is selected, the element is still being transfered
        $html[] = '<input type="hidden" name="'.$this->getControlName('select').'" value="1" />';

        return implode("\n", $html);
    }

    return JText::_("There are no options to choose from.");
}
public function hasValue($params = array()) {

    $message = $this->get('message');
    return !empty($message);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:13:30.037

尝试改变：

```
$message         = $this->get('message'); 
```

至

```
$message         = $this->config->get('message'); 
```

# python - 了解 Matplotlib/PyQt 中的图形、轴和图

> ID：11731392
> 
> 赞同：4
> 
> 时间：2012-07-31T00:05:18.950
> 
> 标签：python, matplotlib, pyqt

帮助我了解在 PyQt 小部件上放置图形的过程（以及一般使用 Matplotlib）。

当我在编写自己的小脚本时，我只是简单地执行`plot(stuff)`并使用`show()`.

然而，这对于较大的应用程序显然不够好，或者如果我想使用子图，或者同时提高多个具有不同结果的窗口。[我在http://eli.thegreenplace.net/2009/01/20/matplotlib-with-pyqt-guis/](http://eli.thegreenplace.net/2009/01/20/matplotlib-with-pyqt-guis/)找到了一个非常好的教程，它说明了很多。但是，我的脑海中仍然没有完全清晰的想法。

所以，你有一个 PyQt 窗口。您制作了一个`Canvas`Qt 对象，并将其填充为 matplotlib `Fig`。然后你给那个图形一对`axes`，最后你把你想要的所有图都钉在这对轴上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-02T22:06:35.200

[这里](http://matplotlib.sourceforge.net/leftwich_tut.txt)有一个有用的页面，它提供了 matplotlib 中的类的概述。

本质上，该过程是：

*   创建一个可以容纳 Axes 实例（和其他艺术家）的图形
*   为图形创建一个画布以将其自身绘制到
*   创建**一个**Axes 实例 ax，可以向其中添加绘图线/补丁等。例如`ax.plot(range(10))`或`ax.contourf(array)`

我认为您的困惑来自对 Axes 的理解。它是“包含基本元素的矩形区域”（对于直线图）。默认情况下，无论您运行多少次命令`plt.plot(range(10))`，图中都只有一个 Axes，尽管您可能决定在图中使用`plt.subplot`子图，在这种情况下，您的图中将有许多 Axes 实例。

高温下，

# mysql - 将 latin1 数据库转换为 utf-8

> ID：11731395
> 
> 赞同：0
> 
> 时间：2012-07-31T00:05:33.800
> 
> 标签：mysql

我有一个包含`latin1`表的 mysql 数据库。我需要将每一列、每一表等转换为 utf-8。具体来说：

```
Encoding: UTF-8
Collation: utf8_general_ci (or utf-8's default) 
```

对我的数据库进行这些彻底更改的最快方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:16:28.893

`mysqldump`，然后编辑您的转储，替换表和列的编码说明符（并在 header`SET NAMES`命令中保留您的转储编码），然后`mysql`返回。

# python - 官方 gVim Windows 二进制文件是否已预编译以与 Python 3 一起使用？

> ID：11731401
> 
> 赞同：3
> 
> 时间：2012-07-31T00:05:59.697
> 
> 标签：python, windows, vim, windows-xp, python-3.2

我从官方 VIM.org 网站下载了 gVim73_46.exe 并安装了它的完整组件，我使用 Python 3.2 进行开发（但如果它更有可能与 VIM 一起使用，我会选择 3.1）。

运行`vim --version`命令给了我一个`-python -python3`结果。但是，`:echo has("python")`在 Vim 中运行会给出`1`(True)。这是否意味着我的 Vim 是为支持 Python 2 而构建的？

至于 Python 3，运行`:py3`命令会给出`E370: Could not load library python31.dll`. 这是否意味着它是为支持 Python 3.1 而构建的？如果是，我可以让它使用我的 3.2 吗？

如果没有，是否有任何资源可以获得支持 Python 3 ( `+python3`) 的预编译 Windows 二进制文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T03:00:44.267

来自`:help python3`：

```
Vim can be built in four ways (:version output):
1\. No Python support        (-python, -python3)
2\. Python 2 support only    (+python or +python/dyn, -python3)
3\. Python 3 support only    (-python, +python3 or +python3/dyn)
4\. Python 2 and 3 support   (+python/dyn, +python3/dyn)

When Python 2 and Python 3 are both supported they must be loaded dynamically. 
```

> 运行 :py3 命令给出 E370: 无法加载库 python31.dll。这是否意味着它是为支持 Python 3.1 而构建的？

是的。如果你得到 python 3.1 并正确设置你的路径，vim 应该有 python。

> 我可以让它使用我的 3.2 吗？

不，vim 被编译为期望某个接口，所以你需要一个匹配的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T04:37:05.167

@pydave 正确回答了你的问题，我只能另外建议使用另一个版本的 vim：~~[http](http://tuxproject.de.nyud.net/projects/vim/)~~ ://tuxproject.de.nyud.net/projects/vim/ 。它使用几乎最新版本的解释器编译，包括 Python-3.2.3。它还使用最新的 vim-7.3.618，其中包含我扩展 python/python3 解释器支持的补丁（`pyeval()`/`py3eval()`函数和`vim.bindeval()`）。

**更新**：它似乎已移至[http://tuxproject.de/projects/vim/](http://tuxproject.de/projects/vim/)，但我不再使用预编译的二进制文件（有一个为我交叉编译它们的脚本）因此无法验证这是真的。

# oop - 使用复合设计模式时，我该如何处理 getter？

> ID：11731402
> 
> 赞同：0
> 
> 时间：2012-07-31T00:06:03.067
> 
> 标签：oop, design-patterns

实际的实现可能对 Javascript 来说太过分了，但我想编写一个新`Element`类和一个`ElementList`类来更好地了解复合设计模式是如何工作的。为简单起见，假设我的`Element`班级有以下内容：

```
Element = function(nativeElement) {
    this.element = nativeElement;
}
Element.prototype = {
    addClass: function(classString) {...},
    clone: function(deep) {...},
    getHtml: function() {...},
    getId: function() {...},
    getNativeElement: function() {...},
    getStyle: function(style) {...},
    hasClass: function(classString) {...},
    removeClass: function(classString) {...},
    setHtml: function(html) {...},
    setId: function(id) {...},
    setStyle: function(style, value) {...}
} 
```

我的第一个想法是只实现对 Composite 有意义的方法：

```
ElementList.prototype = {
    addClass: function(classString) {...},
    clone: function(deep) {...},
    hasClass: function(classString) {...},
    removeClass: function(classString) {...},
    setHtml: function(html) {...},
    setStyle: function(style, value) {...}
} 
```

但是每个类都实现了哪些接口呢？我知道 JS 没有接口，但为了练习，我们假设它有。该类`ElementList`将需要能够使用`Element`s 或`ElementList`s，对吗？这是一种面向对象/设计模式的方式，我该怎么做？我是否需要重新设计 Element 或让它实现各种接口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:17:35.230

通常，您必须构建一个通用接口并将其应用于两个类，因此您将为两者都有一个基本接口，以及通过类使用它所需的方法和属性，`ElementList`如果需要，则为每个元素提供专用接口，如果不需要，您可以直接在类中实现接口，就像您所做的那样，只抽象公共接口。

# php - php在csv输出文件中插入转义字符

> ID：11731403
> 
> 赞同：0
> 
> 时间：2012-07-31T00:06:06.123
> 
> 标签：php, javascript

我正在使用这个 php 代码来允许用户将 dojo.enchancedgrid 发送到文件并将其下载到他的机器上。该过程工作正常，但输出 csv 文件有引号的转义线。我怎样才能避免 php 为我插入那些。传递给函数（str）的字符串是可以的，但是通过php代码之后就不同了。

我的 JavaScript 代码：

```
function exportCsv(){

var g = dijit.byId("grid");
g.exportGrid("csv",{
            writerArgs: {
                separator: ","
            }
            }, function(str){
                alert(str);

                    var form = document.createElement('form');
                    dojo.attr(form, 'method', 'POST');
                    document.body.appendChild(form);
                    dojo.io.iframe.send({
                            url: "csv.php",
                            form: form,
                            method: "POST",
                            content: {exp: str},
                            timeout: 15000
                    });
                    document.body.removeChild(form);

                    }); 
```

}

我的PHP代码：

```
$time = time();
header("Pragma: public");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=\"grid_$time.csv\"");
$exportedData = $_POST['exp'];
echo $exportedData; 
```

服务器也在行中插入一些分析代码......非常感谢你们的帮助。下面是输出的 csv 文件：

经度、纬度、网络、RouteId、测量

-74.18143812,40.62733114,\"命名路线\",IN278,1

-73.90131905,40.75932358,\"命名路线\",IN278,25

-73.8005193,40.73819062,\"命名路线\",IN495,10

-73.82437443,40.79381815,\"命名路线\",IN678,12

-73.79087796,40.66589334,\"命名路线\",\"NY 27\",12

<-- Hosting24 分析代码-->

<--分析代码结束-->

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:20:34.487

1.  您可以自己在客户端字符串 (Javascript) 上转义引号并在 PHP 中取消转义 - 这样您就可以控制整个过程。
2.  您拥有托管商的“分析代码”的原因是您使用的是免费托管（我假设）。它不是分析，而是广告，添加到每个 http 响应中。在 HTML 页面上，它们看起来像底部的广告。如果您使用 AJAX，它们只会妨碍您。如果您实际上是在为托管付费，请致电您的托管人并要求他摆脱这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:21:29.143

正如 zerkms 所建议的，这可能是由于[`magic quotes`](http://www.php.net/manual/en/security.magicquotes.disabling.php).

尝试禁用它们。

# c# - MVVM 上文本框的验证和最后一个值

> ID：11731409
> 
> 赞同：0
> 
> 时间：2012-07-31T00:06:32.637
> 
> 标签：c#, wpf, mvvm

我有这样的文本框声明：

```
<TextBox x:Name="InputTextBox">
                <Binding Path="Input" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged">
                    <Binding.ValidationRules>
                        <MyValidationRule
                        ErrorMessage="Invalid" />
                    </Binding.ValidationRules>
                </Binding>
                <TextBox.InputBindings>
                    <KeyBinding Key="Enter" Command="{Binding Path=AddCommand}"/>
                </InputBindings> 
  </TextBox> 
```

这样的validationRule层次结构：

```
public abstract class AbstractValidationRule : ValidationRule
{
    public string ErrorMessage { get; set; }

    protected abstract bool IsValid(string inputString)

    public override ValidationResult Validate(object value, CultureInfo cultureInfo)
    {
        string inputString = (value ?? string.Empty).ToString();

        if (!IsValid(inputString)) return new ValidationResult(false, ErrorMessage);
        return new ValidationResult(true, null);
    }
}

class MyValidationRule : AbstractStringValidationRule
{
    protected override bool IsValid(string inputString)
    {
        return !String.IsNotNullOrEmpty(inputString);
    }
} 
```

添加命令：

```
 public ICommand AddCommand
    {
        get
        {
            return m_AddCommand ??
                   (m_AddCommand = new DelegateCommand(Add));
        }
    }

private void Add()
    {
        InternalValue = Input;
        // input = Old invalid value
        OnPropertyChanged("Input")
    } 
```

输入属性：

```
 public string Input
    {
        get { return m_Input; }
        set
        {
            if (m_Input != value)
            {
                m_Input = value;
                OnPropertyChanged("Input");
            }
        }
    } 
```

如果我输入“有效”然后输入“无效”，当命令执行时，属性输入将设置为“有效”值状态。我尝试了另一种方法 UpdateSourceTrigger="Explicit" 并使用 TextChanged 事件 - 结果仍然相同。

没有 ValidationRule - 一切正常。

PS 我无法从模型层更改类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T07:02:20.507

如果您希望您的验证/视图模型和您的“ui”同步，那么您应该使用 IDataErrorInfo。您的 Input 属性应包含“有效”和“无效”值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:43:28.430

嗨设置 UpdateSourceTrigger="PropertyChanged"。我希望这会有所帮助。

# google-bigquery - 在 Google BigQuery 中加入 2 个大小相同的表

> ID：11731412
> 
> 赞同：2
> 
> 时间：2012-07-31T00:06:56.687
> 
> 标签：google-bigquery

我正在尝试加入 2 个表，每个表有 57,191 行。BigQ 在内部/左侧寻找更大的桌子，在右侧寻找更小的桌子。当我在左侧使用表 B 运行它时，它错误为“必须首先出现大表 A”。当我切换查询并将表 A 放在 From 子句中时，它会出错，因为“大表 B 必须首先出现”。所以当我按照它的指示去做时，它并没有修复它，而是建议我的第一次（不正确的）尝试，除非我以某种方式搞砸了它。

有点讽刺的是，如果两张桌子的大小相同，它会根据大概一张不小于另一张来决定一张更大。我正在尝试找到一个解决方案，其中不包括向其中一个表添加无意义的行，然后在连接工作后尝试将其删除，（因为 BigQ 现在没有加载我的单行 csv 文件，我确信它是由于我的错误。）

Google SQL 语法连接规则似乎是

"join_type Bigquery 支持 INNER（默认）和 LEFT OUTER 连接。table_2 这是连接中的第二个表，必须很小，并且将连接到出现在 FROM 子句中的表。注意，这可以是表name 或另一个 SELECT 子句，在这种情况下，您必须提供别名。 join_condition_1, ..., join_condition_N, ... 连接条件的集合，它必须是相等条件的集合，所有这些条件都必须满足一行被包含在结果中。（也就是说，我们只支持将这些条件用 AND 连接。）"

我正在运行的实际 SQL 是

```
SELECT lt.activeprosperloans,[fieldsredacted], ...
FROM prosperloans1.listings2 AS lt
JOIN prosperloans1.zjoinedperfloans as ln
ON lt.key = listingkey; 
```

实际错误为：错误：大表 prosperloans1.zjoinedperfloans 必须出现在连接查询中作为最左边的表

谢谢肖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-30T18:24:11.680

请注意，现在您可以使用 JOIN EACH，有效地解决问题。

您的查询将变为：

```
SELECT lt.activeprosperloans,[fieldsredacted], ...
FROM prosperloans1.listings2 AS lt
JOIN prosperloans1.zjoinedperfloans as ln
ON lt.key = listingkey; 
```

从文档：

*如果可能，使用不带 EACH 修饰符的 JOIN 以获得最佳性能。当表大小对于 JOIN 来说太大时，请使用 JOIN EACH。*

[https://developers.google.com/bigquery/docs/query-reference#joins](https://developers.google.com/bigquery/docs/query-reference#joins)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:22:03.157

由于回答了这个问题，BigQuery 添加了 JOIN EACH，这是一种连接两个大表的方法。有关如何使用 JOIN EACH 的说明，请参阅 Fh 的答案。

此响应的其余部分用于历史目的：一个大表（用于连接）超过 7 MB。为了进行连接，整个小表被发送到集群中的每个节点，因此我们对其进行了相当大的限制。可能尽管两个表的行数相同，但一个表大于 7 MB，而另一个表较小。

减小其中一个表大小的一种方法是在查询中应用过滤器和列过滤器，并将结果保存为另一个临时表，然后将 JOIN 应用于临时表。例如，如果您的表中有 10 列跨越一个月的数据，但您只需要 3 列用于连接查询和最后一天的数据，您可以首先选择这三列和最近的数据，并给出结果姓名。然后你可以对该表进行连接。

# python - 是否有购物车或应用程序允许客户通过将图像/文件上传到他们在 django 中的订单来个性化他们的产品？

> ID：11731413
> 
> 赞同：1
> 
> 时间：2012-07-31T00:06:57.370
> 
> 标签：python, django, e-commerce

我正在为销售个性化框架/画布的客户建立一个电子商务网站。这个想法是客户需要提供图像，从各种选项（如尺寸和布局）中进行选择，然后将使用所选选项打印带有客户图像的画布。

我想知道是否有具有此功能的 django 应用程序或购物车（即支持客户个性化产品）。我浏览了[django packages site](http://www.djangopackages.com/grids/g/ecommerce/)，但没​​有找到任何具有此功能的电子商务解决方案。你知道那里有吗？

任何帮助表示赞赏。谢谢吉米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T13:07:52.367

有一个成熟的购物车系统，称为 Satchmo (http://www.satchmoproject.com/)。除此之外，还有一些“入门”推车，您可以将它们用作自己滚动的基础（http://code.google.com/p/django-cart/），这就是我最终得到的正在做。

# git - git推原点？

> ID：11731414
> 
> 赞同：3
> 
> 时间：2012-07-31T00:06:59.273
> 
> 标签：git

我对 git repo 下的文件进行了一些更改，我使用`git commit`

然后我尝试使用`git push origin master`which 返回`Everything up-to-date`

`git push origin head`虽然我不确定我是否应该这样做，但我输入了这似乎有效。以前`git push origin head`一直为我工作。

我的问题是，为什么`git push origin master`不做任何事情，我应该回滚并重新提交，然后`git push origin master`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:30:12.387

如果您在开发分支上工作，则`git push origin master`不会做任何事情，因为您已要求它推送`master`分支。如果你想推送你的开发分支，你需要运行：

```
git push origin development 
```

...或任何你称之为开发分支的东西。在这样做一次之后，您通常应该能够在`git push`没有额外参数的情况下运行。

# linux - C中的cpu频率缩放linux API

> ID：11731417
> 
> 赞同：4
> 
> 时间：2012-07-31T00:07:44.180
> 
> 标签：linux, api, arm, frequency

我想在 linux（Ubuntu）上的程序中更改 cpu（ARM）频率。

C中是否有任何cpu频率缩放和关闭核心API？

如果有的话，API 可以处理多核 cpu 中的每个核心吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T03:20:43.170

有几种方法可以控制 Linux 中的频率。您可以使用 IA32_PERF_CTL 寄存器设置支持的 Intel 处理器的电源状态。但是，您可以使用通过 sysfs 文件系统导出的 cpufreq 接口，它不仅支持 Intel CPU。

您可以查看/sys/devices/system/cpu/cpuX/* 中可能更改的参数。这里有几个提示：

关闭频率缩放是通过调控器完成的，调控器处理处理器处于不同状态的策略。例如，要获得完整的性能，您可以：

```
echo performance > /sys/devices/system/cpu/cpuX/cpufreq/scaling_governor 
```

有多个州长，你可以在这里看到：

```
cat /sys/devices/system/cpu/cpuX/cpufreq/scaling_available_governors 
```

因为通过文件系统接口访问它很麻烦。您可以使用 libudev 访问 cpufreqs 成员。请参阅[udev 文档](http://www.freedesktop.org/software/systemd/libudev/)和[此处](http://c-qs.blogspot.com/2012/06/libudev-and-sysfs-tutorial.html)获取教程。

关于单独处理每个核心的一个限制。这取决于CPU的支持。有时两个或多个内核必须以相同的频率运行，这是硬件的简单限制。请参阅此[帖子](https://stackoverflow.com/questions/11100522/intel-msr-frequency-scaling-per-thread)以获取答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T03:16:01.900

您可能必须使用`/sys`和`/proc/`文件系统，并写入它们下的某些文件，例如可能在`/sys/devices/system/cpu/`

我将研究[cpufreq-set](http://www.thinkwiki.org/wiki/How_to_use_cpufrequtils)对[动态频率缩放的作用](http://www.thinkwiki.org/wiki/How_to_make_use_of_Dynamic_Frequency_Scaling)

顺便说一句，您可以使用`system(3)`命令`cpufreq-set`进行分叉。

（不知道ARM处理器在这些方面的特点）

# android - Android Twitter4j getUserTimeline在线程中很慢

> ID：11731419
> 
> 赞同：0
> 
> 时间：2012-07-31T00:08:01.390
> 
> 标签：android, multithreading, broadcastreceiver, alarmmanager, twitter4j

我有一个警报管理器，它每分钟启动一个广播接收器，它运行一个具有最大优先级的线程。在那个线程中，我使用 Twitter4j.getUserTimeline(page) 从我用于消防部门的 Twitter 帐户（即呼叫信息）中获得了 60 条最新的推文。我的问题是我注意到 getUserTimeline 时不时出现明显的滞后。getUserTimeline 通常需要 4 秒或更少的时间，但有时即使在信号良好的区域和 wifi 上也需要几分钟。我在主应用程序/UI 中使用相同的代码调用 twitter4j.getUserTimeline，最大延迟只有 3 秒。

任何人都知道为什么会发生这种情况或如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:49:11.547

如果您正在启动一个每秒大约需要 4 秒的进程，那么您可能会在任何时间点运行 4 个或更多线程——所有线程都在做同样的事情。这些进程之间是否存在某种干扰 - 即：线程死锁？如果 Twitter4j.getUserTimeline 函数不能保证线程安全，你最好启动一个后台服务（将它设置为在前台运行，这样 Android 就不会杀死它），然后让它在循环中运行，不断调用getUserTimeline 函数。然后，它可以在检测到重大事件时触发要启动的活动。

# php - 在 PHP 中从 /Filter /FlateDecode PDF 流中提取数据

> ID：11731425
> 
> 赞同：44
> 
> 时间：2012-07-31T00:08:51.183
> 
> 标签：php, pdf, decode

我无法解密流中的数据，例如：

```
 56 0 obj 
    << /Length 1242 /Filter /FlateDecode >>
    stream
    x]êΩnƒ Ñ{ûbÀKq¬æ\âê¢....(whole binary is omitted)
    endstream
    endobj 
```

我尝试隔离`x]êΩnƒ Ñ{ûbÀKq¬æ\âê¢....`文件和二进制字符串中的二进制内容（）。解码功能`gzinflate($encripted_data)`向我发送解码错误，我认为这是因为编码内容没有“放气”左右。

在 PDF Reference v 1.7，（六版）的第 67 页，我发现 /FlateDecode 过滤器的描述为：*...解压缩使用 zlib/deflate 压缩方法编码的数据，再现原始文本或二进制数据*

我需要真正的原始解决方案，也就是 php 函数或/和算法如何处理这个“\FlateDecoded”流。

谢谢你！

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-07-31T01:55:22.167

由于您没有告诉您是只需要访问**一个**解压缩流还是需要解压所有流，所以我建议您使用一个简单的命令行工具，它可以一次性完成完整的 PDF：Jay Berkenbilt 的`qpdf`.

**示例命令行：**

```
 qpdf --qdf --object-streams=disable in.pdf out.pdf 
```

`out.pdf`然后可以在文本编辑器中检查（只有嵌入的 ICC 配置文件、图像和字体仍然可以是二进制的）。

`qpdf`还将自动重新排序对象并以标准化方式显示 PDF 语法（并在评论中告诉您解压缩对象的原始对象 ID 是什么）。

如果您需要再次重新压缩文件（可能在您编辑后），只需运行以下命令：

```
 qpdf out-edited.pdf out-recompressed.pdf 
```

（您可能会看到一些警告消息，告知该实用程序正在尝试修复损坏的文件......）

`qpdf`是多平台的，[**可从 Sourceforge 获得**](http://qpdf.sf.net/)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-07-31T02:48:37.127

```
header('Content-Type: text');           // I going to download the result of decoding
$n = "binary_file.bin";                 // decoded part in file in a directory
$f = @fopen($n, "rb");                  // now file is mine
$c = fread($f, filesize($n));           // now I know all about it 
$u = @gzuncompress($c);                 // function, exactly fits for this /FlateDecode filter
$out = fopen("php://output", "wb");     // ready to output anywhere
fwrite($out, $u);                       // output to downloadable file 
```

铃儿响！铃儿响叮当！...

`gzuncompress()`- 解决方案

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-01-13T15:20:17.557

姗姗来迟，但有人可能会觉得它有帮助。在这种情况下： << /Length 1242 /Filter /FlateDecode >> 您只需将隔离的二进制字符串（基本上是“stream”和“endstream”之间的所有内容）传递给zlib.decompress：

```
import zlib
stream = b"êΩnƒ Ñ{ûbÀKq¬æ\âê"  # binary stream here
data = zlib.decompress(stream) # Here you have your clean decompressed stream 
```

但是，如果您的 PDF 对象中有/DecodeParms，事情就会变得复杂。您将需要 /Predictor 值和列号。为此最好使用 PyPDF2。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-11-27T15:57:25.187

我刚用

```
import de.intarsys.pdf.filter.FlateFilter; 
```

来自 jpod / source forge，它运行良好

```
FlateFilter filter = new FlateFilter(null);
byte[] decoded = filter.decode(bytes, start, end - start); 
```

字节直接来自pdf文件

# android - 调整大小后位图图像为空

> ID：11731427
> 
> 赞同：1
> 
> 时间：2012-07-31T00:08:55.630
> 
> 标签：android, bitmap

我正在尝试将从 SD 卡中选择的图片调整为缩略图大小，但是当我调整它的大小时，我的默认图像上的尺寸`128/128`位图为空

```
InputStream input=null;
            try {
                input = getActivity().getContentResolver().openInputStream(Uri.parse(cursor.getString(3)));
                BitmapFactory.Options options = new BitmapFactory.Options();
                options.inJustDecodeBounds = true;
                BitmapFactory.decodeStream(input, null, options);
                int height = options.outHeight; //1030
                int width = options.outWidth; //1033
                BitmapFactory.decodeResource(getResources(), R.drawable.ic_contact_picture, options);

                int imageHeight = options.outHeight; //128
                int imageWidth = options.outWidth; //128

                if(imageWidth > imageHeight){
                    options.inSampleSize = Math.round((float)height/(float)imageHeight);
                }else{
                    options.inSampleSize = Math.round((float)width/(float)imageWidth);
                }
                options.inJustDecodeBounds = false;
                Bitmap bm = BitmapFactory.decodeStream(input,null, options); //null here
                try {
                    input.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
                image.setImageBitmap(bm);
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } 
```

我可以同时获得图像的高度和宽度，但是当我调整它的大小时，它返回一个空位图。

我已经用资源文件这样做了，但从来没有使用`Uri`SD 卡中的图像，所以我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:19:47.880

您不能两次使用相同的输入流，因此您需要第二次创建一个新的 InputStream。请参阅[此处](https://stackoverflow.com/questions/2503628/bitmapfactory-decodestream-returning-null-when-options-are-set)了解更多信息。

# python - 沿已排序二维 numpy 数组的轴查找第一个非零值

> ID：11731428
> 
> 赞同：11
> 
> 时间：2012-07-31T00:09:02.970
> 
> 标签：python, multidimensional-array, numpy

我试图找到最快的方法来为二维排序数组的每一行找到第一个非零值。从技术上讲，数组中唯一的值是零和一，并且是“排序的”。

例如，数组可能如下所示：

v =

```
0 0 0 1 1 1 1 
0 0 0 1 1 1 1 
0 0 0 0 1 1 1 
0 0 0 0 0 0 1 
0 0 0 0 0 0 1 
0 0 0 0 0 0 1 
0 0 0 0 0 0 0 
```

我可以使用 argmax 函数

```
argmax(v, axis=1)) 
```

找到它何时从零变为一，但我相信这会在每一行上进行详尽的搜索。我的数组大小合理（~2000x2000）。argmax 仍然会优于仅对 for 循环中的每一行执行搜索排序方法，还是有更好的选择？

此外，数组将始终使得一行的第一个位置始终> = 其上方行中的第一个位置（但不能保证最后几行中会有一个）。我可以利用 for 循环和每行的“起始索引值”来利用它，该值等于前一行中第一个 1 的位置，但我认为 numpy argmax 函数仍将优于用 python 编写的循环，这是否正确.

我只是对替代方案进行基准测试，但数组的边长可能会发生很大变化（从 250 到 10,000）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T04:02:39.180

[使用np.where](http://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html)相当快：

```
>>> a
array([[0, 0, 0, 1, 1, 1, 1],
       [0, 0, 0, 1, 1, 1, 1],
       [0, 0, 0, 0, 1, 1, 1],
       [0, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 0, 0, 0]])
>>> np.where(a>0)
(array([0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 3, 4, 5]), array([3, 4, 5, 6, 3, 4, 5, 6, 4, 5, 6, 6, 6, 6])) 
```

这提供了坐标值大于 0 的元组。

您还可以使用 np.where 来测试每个子数组：

```
def first_true1(a):
    """ return a dict of row: index with value in row > 0 """
    di={}
    for i in range(len(a)):
        idx=np.where(a[i]>0)
        try:
            di[i]=idx[0][0]
        except IndexError:
            di[i]=None    

    return di 
```

印刷：

```
{0: 3, 1: 3, 2: 4, 3: 6, 4: 6, 5: 6, 6: None} 
```

即第0行：索引3>0；第 4 行：索引 4>0；第 6 行：没有大于 0 的索引

正如您所怀疑的，argmax 可能更快：

```
def first_true2():
    di={}
    for i in range(len(a)):
        idx=np.argmax(a[i])
        if idx>0:
            di[i]=idx
        else:
            di[i]=None    

    return di       
    # same dict is returned... 
```

如果您可以处理没有`None`for rows of all naughts 的逻辑，那么这会更快：

```
def first_true3():
    di={}
    for i, j in zip(*np.where(a>0)):
        if i in di:
            continue
        else:
            di[i]=j

    return di 
```

这是一个在 argmax 中使用轴的版本（如您的评论中所建议）：

```
def first_true4():
    di={}
    for i, ele in enumerate(np.argmax(a,axis=1)):
        if ele==0 and a[i][0]==0:
            di[i]=None
        else:
            di[i]=ele

    return di 
```

对于速度比较（在您的示例数组上），我得到这个：

```
 rate/sec usec/pass first_true1 first_true2 first_true3 first_true4
first_true1   23,818    41.986          --      -34.5%      -63.1%      -70.0%
first_true2   36,377    27.490       52.7%          --      -43.6%      -54.1%
first_true3   64,528    15.497      170.9%       77.4%          --      -18.6%
first_true4   79,287    12.612      232.9%      118.0%       22.9%          -- 
```

如果我将其缩放到 2000 X 2000 np 数组，这就是我得到的：

```
 rate/sec  usec/pass first_true3 first_true1 first_true2 first_true4
first_true3        3 354380.107          --       -0.3%      -74.7%      -87.8%
first_true1        3 353327.084        0.3%          --      -74.6%      -87.7%
first_true2       11  89754.200      294.8%      293.7%          --      -51.7%
first_true4       23  43306.494      718.3%      715.9%      107.3%          -- 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-31T02:15:59.487

argmax() 使用 C 级循环，它比 Python 循环快得多，所以我认为即使你用 Python 编写一个智能算法，也很难击败 argmax()，你可以使用 Cython 来加速：

```
@cython.boundscheck(False)
@cython.wraparound(False) 
def find(int[:,:] a):
    cdef int h = a.shape[0]
    cdef int w = a.shape[1]
    cdef int i, j
    cdef int idx = 0
    cdef list r = []
    for i in range(h):
        for j in range(idx, w):
            if a[i, j] == 1:
                idx = j
                r.append(idx)
                break
        else:
            r.append(-1)
    return r 
```

在我的 2000x2000 矩阵的 PC 上，它是 100us 对 3ms。

# ruby - 修改设计控制器

> ID：11731431
> 
> 赞同：0
> 
> 时间：2012-07-31T00:09:43.673
> 
> 标签：ruby, ruby-on-rails-3, devise

我知道之前有人问过这个问题，但我看不到明确的答案。我的用户的浏览量不仅仅是注册；登入; 等（默认设计视图）。例如他的个人资料页面，他正在学习的课程，安排他的课程。我想创建/编辑一个控制器，它将为用户提供此方法和其他视图。我如何实现它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:05:37.600

我最喜欢的技巧是命名设计路线，以免与我的用户个人资料页面等发生冲突。`devise_for`需要一个`path_prefix`选项，因此`config/routes.rb`您可以：

`devise_for :users, :path_refix => 'd'`

`/d/users/new`并且您所有的设计路线都将`/users`再次免费。

如果这对您不起作用，您可以通过子类化替换负责创建和编辑视图的默认设计控制器`Devise::RegistrationsController`并将您的路由添加到它。你可以按照这里的指示[来](https://github.com/plataformatec/devise/wiki/How-To%3a-Customize-the-redirect-after-a-user-edits-their-profile)获得很好的指示

# ios - 为什么我不能重置我的持久存储的内容？

> ID：11731432
> 
> 赞同：2
> 
> 时间：2012-07-31T00:09:56.800
> 
> 标签：ios, core-data

我的应用程序将当前用户的大量数据存储在 Core Data 持久存储中。如果用户注销，我想删除所有这些数据并重新开始。

现在，我的代码如下所示：

```
NSError *error;
[_managedObjectContext lock];
[_managedObjectContext reset];
[_persistentStoreCoordinator removePersistentStore:_persistentStore error:&error];
[[NSFileManager defaultManager] removeItemAtURL:[_persistentStore URL] error:&error];
    // error handling here
_persistentStore = [_persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:[self _storeURL] options:nil error:&error];
[_managedObjectContext unlock]; 
```

但无论我做什么，下一次执行获取请求时，我都会取回所有旧数据。我已经验证实际文件正在从文件系统中删除，所以显然这些数据来自某个地方的内存。我已经尝试了上面的代码，我尝试将托管对象上下文重置为 nil 并从头开始，但是在我终止应用程序并重新运行它之前，似乎没有发生任何更改。

编辑：实际上，即使终止应用程序也不会做任何事情。我看到 sqlite 文件从它所在的文件夹中消失了`NSFileManager`，然后在我添加新持久存储的那一行中，它重新创建了旧存储的精确副本。

编辑：好的，我打开了核心数据调试。我一打电话就`removePersistentStore:`看到“与 sqlite 数据库断开连接”。下一行，`addPersistentStoreWithType:`我看到一大堆`INSERT`语句，我猜这些语句神奇地从内存中恢复数据库的内容？我可以让它……不要那样做吗？

编辑：好吧，现在我刚刚通过循环访问我的托管对象手动删除数据存储的内容。这工作，不知何故。幸运的是，对于这个项目，用户最多只有几百个对象，所以它不是非常耗时，但我仍然希望我能理解发生了什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:35:26.220

拆下整个堆栈，然后删除文件。如果您使用的是 UIManagedDocument，那么您有一个文件包。确保关闭文档，然后删除整个文件包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:13:35.247

对于我们正在进行的一个项目，我担心这个，所以我做了一个测试，但我不能让它显示你看到的行为。这一切都在 iOS 5.1 的模拟器中。

我刚刚在 Apple 的默认核心数据模板中尝试了以下代码，其模型具有单个实体“Entity”和一个名为“name”的字符串属性。代码插入一个实体，保存上下文，删除存储，删除存储文件，然后重新添加存储。正如预期的那样，对象在移除存储之前存在，之后不存在。（我也尝试添加 managedObject 锁定/重置/解锁，结果相同。）

所以，肯定有其他事情发生。您可以尝试制作这样的简化测试用例吗？

```
NSManagedObject *object = [[NSManagedObject alloc] initWithEntity:[NSEntityDescription entityForName:@"Entity"
                                                                              inManagedObjectContext:self.managedObjectContext]
                                   insertIntoManagedObjectContext:self.managedObjectContext];
[object setValue:@"hi" forKey:@"name"];
NSError *error;
if (![self.managedObjectContext save:&error]) {
    NSLog(@"error: %@",error);
}

NSFetchRequest *fetch = [[NSFetchRequest alloc] initWithEntityName:@"Entity"];
[fetch setSortDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES]]];

NSLog(@"before: %@", [self.managedObjectContext executeFetchRequest:fetch error:nil]);

if (![self.persistentStoreCoordinator removePersistentStore:[[self.persistentStoreCoordinator persistentStores] lastObject]
                                                      error:&error]) {
    NSLog(@"error: %@", error);
}

NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"CoreDataTest.sqlite"];

if (![[NSFileManager defaultManager] removeItemAtURL:storeURL error:&error]) {
    NSLog(@"error: %@", error);
}

if (![self.persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                              configuration:nil
                                                        URL:storeURL
                                                    options:nil
                                                           error:&error]) {
    NSLog(@"error: %@", error);
}

NSLog(@"after: %@", [self.managedObjectContext executeFetchRequest:fetch error:nil]); 
```

# parameters - 从高级查找中隐藏参数

> ID：11731435
> 
> 赞同：2
> 
> 时间：2012-07-31T00:11:08.260
> 
> 标签：parameters, reporting, dynamics-crm-2011

有没有办法从 CRM 高级查找界面隐藏报表参数？我有一个不需要用户选择的基于表达式的参数，但是当我上传报告时，CRM 会检测到预过滤参数并在预过滤界面中为其添加提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:37:47.107

在自定义区域中，转到该字段的属性并更改“可搜索？” 参数为“否”。这会将其从您的“高级查找”字段列表中隐藏。

顺便说一句，这对于隐藏高级查找中的字段非常有用，您也可以在表单上隐藏这些字段，例如如果用户不使用活动上的“类别”字段。

# python - Python：遍历两个以列表为值的字典

> ID：11731439
> 
> 赞同：2
> 
> 时间：2012-07-31T00:11:47.923
> 
> 标签：python, dictionary, loops

我已经构建了两个包含图像直方图值的字典。每个字典都将图像文件的文件名作为键，并将三个一维向量的列表放在一起作为其值。

**例子：** `{'someFileName.jpg' : ['forecolor=2,3,5,5,6','edge=2,4,5','texture=5,4,3']}`

这是我的一本词典的实际表示：

**词典1**

```
{'/Users/images/Transcend-8GB-Class-10-SDHC-Flash-Memory-Card.jpg': ['fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3', 'edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63', 'texture=1,78,27,37,13,6,6,7,78']} 
```

字典2

```
{'/Users/images/kodax-camera-M531.jpg': ['fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0', 'edge=1,4,1,88,128,22,8,39,25,142,230,226,31,60,64,255,252,12,76', 'texture=1,15,32,31,28,19,16,12,98']} 
```

我的最终目标是将其中两个字典传递给一个方法并实际运行 cosign 值，

示例：所以每个字典都有列表作为它的值，所以对于每个字典键，我想在字典 1 的键 1、velu1 与字典 2 键 1、值 1 之间进行向量乘法，

我有向量乘法函数，所以我想弄清楚如何正确迭代，我一直在考虑使用 yield 函数，但是当我尝试时它并没有真正起作用。这是我到目前为止所拥有的：

```
def cosignSimilarity(image1VectorDict, image2VectorDict):
    for image1Key, image2Value in image1VectorDict.iteritems():
        print image1Key
        for aValue in image1Value:
            print aValue
            for image2Key, image2Value in image2VectorDict.iteritems():
                for eValue in image2Value:
                    print aValue
                    print "\n"
                    print eValue 
```

仅供参考：我不是在寻求关于 cosign 计算的帮助。

这就是我当前的代码如何吐出数据的方式，如果我可以将一个键对键从一个字典隔离到另一个字典，那么我可以做剩下的事情，例如计算余弦值。

```
 First  Dictionary
    {'/Users/test/Transcend-8GB-Class-10-SDHC-Flash-Memory-Card.jpg': ['fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3', 'edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63', 'texture=1,78,27,37,13,6,6,7,78']}
    ------------------
Second Dictionary
    {'/Users/test/kodax-camera-M531.jpg': ['fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0', 'edge=1,4,1,88,128,22,8,39,25,142,230,226,31,60,64,255,252,12,76', 'texture=1,15,32,31,28,19,16,12,98']}
    ++++++++++++++++++
    /Users/test/Transcend-8GB-Class-10-SDHC-Flash-Memory-Card.jpg
    fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3
    fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3

    fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0
    fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3

    edge=1,4,1,88,128,22,8,39,25,142,230,226,31,60,64,255,252,12,76
    fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3

    texture=1,15,32,31,28,19,16,12,98
    edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63
    edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63

    fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0
    edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63

    edge=1,4,1,88,128,22,8,39,25,142,230,226,31,60,64,255,252,12,76
    edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63

    texture=1,15,32,31,28,19,16,12,98
    texture=1,78,27,37,13,6,6,7,78
    texture=1,78,27,37,13,6,6,7,78

    fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0
    texture=1,78,27,37,13,6,6,7,78

    edge=1,4,1,88,128,22,8,39,25,142,230,226,31,60,64,255,252,12,76
    texture=1,78,27,37,13,6,6,7,78

    texture=1,15,32,31,28,19,16,12,98 
```

显然，正如您所看到的，我正在吐出许多重复相同值的方法

这些是我正在处理的实际字典：

**词典 1：**

```
{'/Users/test/Transcend-8GB-Class-10-SDHC-Flash-Memory-Card.jpg': ['fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3', 'edge=1,252,1,32,124,194,63,252,67,15,240,1,7,244,66,47,0,192,63', 'texture=1,78,27,37,13,6,6,7,78']} 
```

**字典 2：**

```
{'/Users/test/kodax-camera-M531.jpg': ['fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0', 'edge=1,4,1,88,128,22,8,39,25,142,230,226,31,60,64,255,252,12,76', 'texture=1,15,32,31,28,19,16,12,98']} 
```

**我有lamba函数**

```
cosinLamba = lambda a, b : round(NP.inner(a, b)/(LA.norm(a)*LA.norm(b)), 3) 
```

*我想遍历字典 1 和字典 2 并获取字典 1 的 fcolor 值* `'fcolor=2,4,14,5,0,0,0,0,0,0,0,0,0,0,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,9,0,0,0,2,2,0,0,0,0,0,0,0,0,0,13,6,0,0,0,1,0,0,0,0,0,0,0,0,0,0,10,8,0,0,0,1,2,0,0,0,0,0,0,0,0,0,17,17,0,0,0,3,6,0,0,0,0,0,0,0,0,0,7,5,0,0,0,2,0,0,0,0,0,0,0,0,0,0,4,3,0,0,0,1,1,0,0,0,0,0,0,0,0,0,6,6,0,0,0,2,3'`

*和dictionary2的fcolor值*

```
'fcolor=2,74,6,20,30,1,2,0,1,0,0,0,1,3,2,0,0,0,0,0,1,1,1,0,0,2,0,0,0,2,2,0,0,0,0,0,2,2,1,0,0,5,0,0,0,1,4,0,0,0,0,0,2,2,1,0,0,1,0,0,0,3,1,0,0,0,0,0,1,1,0,0,0,3,0,0,0,1,2,0,0,0,0,0,2,2,1,0,0,4,0,0,0,0,5,0,0,0,0,0,2,1,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0' 
```

将它们发送到我的 Lamba 函数`cosinLamba(valu1, value2)` ***value1 和 value 2 是字符串，这就是为什么我将它们作为值保存在我的字典中。***我想为每个字典中为给定图片存储的所有向量做 fcolor、texture、edge。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:30:55.257

您可以首先将您的表示更改为：

```
{'someFileName.jpg' : {'forecolor': [2,3,5,5,6],'edge': [2,4,5],'texture':[5,4,3]}} 
```

或者

```
{('someFileName.jpg', 'forecolor'): [2,3,5,5,6],
 ('someFileName.jpg', 'edge'): [2,4,5],
 ('someFileName.jpg', 'texture'):[5,4,3]} 
```

例如，要获取第一种情况的相应列表：

```
from itertools import product

# pair info for each image with info of every image from another dictionary
for (fn1, d1), (fn2,d2) in product(dict1.iteritems(), dict2.iteritems()):
    for property_, list_value in d1.iteritems():
        compute_cosine_similarity(list_value, d2[property_]) 
```

将您的表示与字符串列表一起使用，它看起来像：

```
from itertools import product

# pair info for each image with info of every image from another dictionary
for (fn1,lst1), (fn2,lst2) in product(dict1.iteritems(), dict2.iteritems()):
    # assume all lists has the same order of elements
    for string_value1, string_value2 in zip(lst1, lst2):
        compute(string_value1, string_value2) 
```

您不应该将数字存储为 ascii 字符串列表。如果需要节省内存，可以使用 numpy 数组。`cosinLamba`已经接受了他们。

```
from collections import namedtuple
import numpy as np

Info = namedtuple('Info', 'forecolor edge texture')

dict1 = {'someFileName.jpg': Info(np.array([...], dtype=np.uint8),
                                  np.array([...], dtype=np.uint8),
                                  np.array([...], dtype=np.uint8))} 
```

调用 cosine_similarity() 的代码与您的表示完全相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:28:23.593

我不熟悉您要执行的 cosign 计算，但除此之外，如果我对您的问题的理解是正确的，那么以下代码应该可以工作：

```
for key1, vals1 in dict1.iteritems():
    vals2 = dict2[key1]
    for val1, val2 in zip(vals1, vals2):
        # you now have the corresponding values for each image file
        compute_cosign(val1, val2) 
```

# html - HTML5/Javascript 视频过滤

> ID：11731441
> 
> 赞同：4
> 
> 时间：2012-07-31T00:12:14.130
> 
> 标签：html

是否可以将自定义视觉效果（如灰度）应用于 HTML5/Javascript 中标签的输入流？我的目标是能够向用户显示过滤后的网络摄像头的输出，但用户应该能够从各种过滤器中进行选择，而不仅仅是灰度。

非常感谢所有帮助，我总是接受答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:17:08.303

使用 Get User Media API 和 WebGL 似乎可以做到这一点：

[http://dev.w3.org/2011/webrtc/editor/getusermedia.html](http://dev.w3.org/2011/webrtc/editor/getusermedia.html)

这是一个示例（带有许多有用资源的链接）：

[http://neave.com/webcam/html5/](http://neave.com/webcam/html5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:28:56.443

方法是抓取`video`元素的每一帧并处理，然后用`canvas`. [这是](http://html5inaction.com/app/ch8/index-6.html)我最近为我的书做的一个例子（警告：我知道这个例子目前在 IE9 中存在一些问题），它使用了来自[HTML5 Rocks](http://www.html5rocks.com/en/tutorials/canvas/imagefilters/)的灰度过滤器。主循环看起来像这样，假设`video`是对元素的引用并且`context`是 2d 画布上下文，[`requestAnimFrame`来自 Paul Irish](http://paulirish.com/2011/requestanimationframe-for-smart-animating/)：

```
function draw() {
    if(video.paused || video.ended) return false;
    context.clearRect(0,0,720,480);
    context.drawImage(video,0,0,720,480);
    context.putImageData(grayscale(context.getImageData(0,0,720,480)),0,0);
    requestAnimFrame(draw);
} 
```

`getUserMedia()`Alex W 提到的功能目前仅在 Opera 和 Chrome 中可用，您可以阅读一些关于它的博客文章并[在此处](http://dev.opera.com/articles/view/getusermedia-access-camera-privacy-ui/)查看一些演示。获得媒体流后，您可以将其通过管道传输到`video`元素中并执行与上述完全相同的操作。

# css - 在多行上并排对齐表格

> ID：11731443
> 
> 赞同：0
> 
> 时间：2012-07-31T00:12:42.237
> 
> 标签：css, css-float, stylesheet

我正在尝试并排对齐 10 个表格，即 5 行和 2 列。每个表中的行彼此不同。我使用了 float: left 并为每个 div 定义了一个宽度，但它仍然无法正常工作。

这是一些示例代码和[小提琴](http://jsfiddle.net/GfJTd/10/)

```
<div style="width:500px;">

    <div style="float:left; width:250px">       
        <h4>Details </h4>           
        <table border="1px">    
        <tbody >        
                <tr>
                    <td>Id</td>
                    <td>1234-4524-4591-2545</td>
                </tr>        
                <tr>        
                    <td>Name</td>
                    <td>Test</td>
                </tr>     
                <tr>
                    <td>Status</td>
                    <td>OK</td>
                </tr>        
                <tr>        
                    <td>Step</td>
                    <td>6</td>
                </tr>      
                <tr>
                    <td>Date</td>
                    <td>xxx</td>
                </tr>        
                <tr>        
                    <td>Time</td>
                    <td>ysa</td>
                </tr>                                 
        </tbody>
        </table>
    </div>

<div style="float:left; width:250px">
<div>
    <h4>Options</h4>    
</div>
<table border="1px">    
    <tbody>        
            <tr>
                <td>Option 1</td>
                <td>OK</td>
            </tr>        
            <tr>        
                <td>Option 2</td>
                <td>OK</td>
            </tr>         
            <tr>
                <td>Option 3</td>
                <td>OK</td>
            </tr>        
            <tr>
                <td>Option 4</td>
                <td>OK</td>
            </tr>                         
    </tbody>
</table>
</div>

<div style="float:left; width:250px">
<div>
    <h4>Schedule</h4>    
</div>
<table border="1px">    
    <tbody >        
            <tr>
                <td>Time</td>
                <td>11/12/12 6:30 AM</td>
            </tr>        
            <tr>        
                <td>Email ID:</td>
                <td>gf@abc.com</td>
            </tr>                       
    </tbody>
</table>
</div>

<div style="float:left; width:250px">
<div>
    <h4>Body</h4>   
</div>
<table border="1px">    
    <tbody>

            <tr>
                <td>Subject Line</td>
                <td>test</td>
            </tr>        
            <tr>        
                <td>From Address</td>
                <td>user@gmail.com</td>
            </tr>        
             <tr>        
                <td>From Name</td>
                <td>Some Name</td>
            </tr>                                      
    </tbody>
</table>
</div>

<div style="float:left; width:250px">
<div>
    <h4>User Settings</h4>    
</div>
<table border="1px">    
    <tbody>    
            <tr>
                <td>Setting 1</td>
                <td>false</td>
            </tr>        
            <tr>        
                <td>Setting 2</td>
                <td></td>
            </tr>                                              
    </tbody>
</table>
</div>
</div>
​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T04:58:00.157

这是正确布置的表格：

[http://jsfiddle.net/GfJTd/23/](http://jsfiddle.net/GfJTd/23/)

如果您希望它们具有相同的高度，您可以：

1.  使桌子高度相同
2.  使包含表格的 div 高度相同
3.  有一个每行包含两个表的 div

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:15:43.420

尝试设置`max-width`和`mid-width`。这些会将您的表格限制为您想要的大小。有关更多信息，请参阅链接。

[http://www.w3schools.com/css/css_dimension.asp](http://www.w3schools.com/css/css_dimension.asp)

# c - 时间戳传出数据包

> ID：11731445
> 
> 赞同：10
> 
> 时间：2012-07-31T00:12:52.587
> 
> 标签：c, linux, timestamp, raw-sockets

我正在尝试获取传出数据包的准确时间戳（使用原始套接字发送）。根据[`Linux/Documentation/networking/timestamping.txt`](http://os1a.cs.columbia.edu/lxr/source/Documentation/networking/timestamping.txt?a=x86)，“对于发送时间戳，传出的数据包将循环回套接字的错误队列，并附上发送时间戳。它可以通过 recvmsg(flags=MSG_ERRQUEUE) 接收。”。

不幸的是，在原始套接字上调用时`recvmsg`总是返回（使用并设置为with创建）。我究竟做错了什么？有没有更好的方法来获取传出数据包的准确时间戳？`-1``socket(PF_INET, SOCK_RAW, IPPROTO_RAW)``SO_TIMESTAMP``1``setsockopt`

**附录（信息）：**

我还尝试从通过 UDP 套接字（下面的源代码）发送的数据包中获取时间戳并`recvmsg`返回`-1`：错误是“资源暂时不可用”（`EAGAIN`）。

**附录（源代码）：**

```
#include <arpa/inet.h>
#include <linux/net_tstamp.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>

void die(char* s)
{
    perror(s);
    exit(1);
}

int main(int argc, char* argv[])
{
    char* destination_ip = "10.0.0.1";
    int destination_port = 1234;

    int sock;
    if ((sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP)) < 0) {
        die("socket()");
    }

    int timestamp_flags = SOF_TIMESTAMPING_TX_SOFTWARE;
    if (setsockopt(sock, SOL_SOCKET, SO_TIMESTAMPING, &timestamp_flags, sizeof(timestamp_flags)) < 0) {
        die("setsockopt()");
    }

    struct sockaddr_in si_server;
    memset(&si_server, 0, sizeof(si_server));
    si_server.sin_family = AF_INET;
    si_server.sin_port = htons(destination_port);
    if (inet_aton(destination_ip, &si_server.sin_addr) == 0) {
        die("inet_aton()");
    }

    const int buffer_len = 256;
    char buffer[buffer_len];

    const int n_packets = 10;
    for (int i = 0; i < n_packets; ++i) {
        sprintf(buffer, "Packet %d", i);
        if (sendto(sock, buffer, buffer_len, 0, (const sockaddr*) &si_server, sizeof(si_server)) < 0) {
            die("sendto()");
        }

        // Obtain the sent packet timestamp.
        char data[256];
        struct msghdr msg;
        struct iovec entry;
        struct sockaddr_in from_addr;
        struct {
            struct cmsghdr cm;
            char control[512];
        } control;
        int res;

        memset(&msg, 0, sizeof(msg));
        msg.msg_iov = &entry;
        msg.msg_iovlen = 1;
        entry.iov_base = data;
        entry.iov_len = sizeof(data);
        msg.msg_name = (caddr_t)&from_addr;
        msg.msg_namelen = sizeof(from_addr);
        msg.msg_control = &control;
        msg.msg_controllen = sizeof(control);        
        if (recvmsg(sock, &msg, MSG_ERRQUEUE) < 0) {
            die("recvmsg()");
        }
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T19:21:48.297

查看 Linux 内核源代码，我发现负责将包含数据包时间戳的消息放入错误队列的函数是`skb_tx_timestamp`. 这个函数应该由 NIC 驱动程序调用，不幸的是，`e1000`驱动程序没有调用它（硬件时间戳有类似的函数，但这显然取决于支持它的 NIC 驱动程序）。

根据去年 9 月的[这个 NetDev 讨论](http://comments.gmane.org/gmane.linux.network/171376)，“没有驱动程序调用 skb_tx_timestamp()”和“你需要调整你的 NIC 驱动程序来使用这个 TX 时间戳”。`skb_tx_timestamp`添加对`e1000_xmit_frame`on的调用后`e1000_main.c`，我能够获取传出数据包的时间戳（通过 UDP 套接字）。不过，我无法获得 RAW 套接字上传出数据包的时间戳（我仍然得到`EAGAIN`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-31T00:34:34.940

很难知道您做错了什么，因为我们看不到您的代码。

但是：文档说这`SO_TIMESTAMP`是用于传入数据包，而`SO_TIMESTAMPING`用于传出数据包。

内核文档包含一个完整的示例，您可以将其用作基础 - 尽管它使用的是 UDP，但您应该能够将其调整为使用 RAW 套接字。请参阅 linux 内核[文档/networking/timestamping/timestamping.c](http://os1a.cs.columbia.edu/lxr/source/Documentation/networking/timestamping/timestamping.c)

编辑：似乎没有普遍支持传输时间戳，请参见[此处](http://comments.gmane.org/gmane.linux.network/171376)。即使在今天，也只有少数 nic 驱动程序实现了软件支持，少数有硬件支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-29T06:10:12.503

sock_tx_timestamp 仅在当前内核代码中为 SOCK_DGRAM 套接字调用。

顺便说一句，文档 Documentation/networking/timestamping/timestamping.c 不是很准确。

SO_TIMESTAMP / SO_TIMESTAMPNS / SO_TIMESTAMPING / SIOCGSTAMP / SIOCGSTAMPNS 类似。他们中的任何一个都将使应用程序能够获取接收到的数据包的时间戳。

使用 SOF_TIMESTAMPING_TX_SOFTWARE，上述任何一个标志都会在 MSG_ERRQUEUE 中为应用程序提供一个 CMSG，指示发送数据包的时间戳。

但是 SOF_TIMESTAMPING_RX_SOFTWARE 根本没用。它甚至不能用于禁用接收数据包时间戳的报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-26T11:02:24.627

我想，你必须提到时间戳标志

```
int timestamp_flags |= SOF_TIMESTAMPING_TX_SOFTWARE;
timestamp_flags |= SOF_TIMESTAMPING_SOFTWARE; 
```

在从 msg 队列错误中获取数据之前，您还必须检查所有系统调用的 strerror。这将帮助您摆脱 EAGAIN 消息。

# c++ - 比较两个 IPv6 地址及其掩码（窗口）

> ID：11731449
> 
> 赞同：1
> 
> 时间：2012-07-31T00:13:07.953
> 
> 标签：c++, ip-address, equals, ipv6, mask

我必须比较两个 IPv6 地址和它们的掩码，看看它们是否相同。它们都在字符串中，例如“xxxx:xxxx:xxxx:xxxx/xx”。我只会使用 memcmp 逐位比较它们，但是这可能会在 true 时返回 false，因为 xxxx:xxxx:0000:xxxx/xx 和 xxxx:xxxxx::xxxxx/xx 在技术上是相同的地址。

我不希望创建地址和掩码的子字符串，但如果有一个比较两个 IPv6 地址的函数，我会这样做。有什么建议么？:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T00:40:07.070

您应该使用将两者转换为二进制形式`inet_pton`，然后比较二进制形式（您可以比较的只是 16 个字节的数据`memcmp`）。

如果您需要比较屏蔽地址，那么您将不得不做更多的工作。`inet_pton`不会为您解析前缀长度（“/something”），因此您必须：

1.  找到斜线
2.  将斜线前的部分传递给`inet_pton`
3.  用普通的 ol' 解析斜线后的整数`atoi`
4.  手动归零 128 减去地址二进制形式末尾的位数

...在比较它们之前在每个地址上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-15T21:21:36.450

像往常一样，不要重新发明轮子。出色的 libcidr 库可以满足您的需求，甚至更多。 [http://www.over-yonder.net/~fullermd/projects/libcidr](http://www.over-yonder.net/~fullermd/projects/libcidr)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:55:10.907

我仍然建议使用子字符串，因为它们很容易提取。然后，您可以重载字符串的 equals() 函数以在比较“0000”和“”以及您可能遇到的任何其他极端情况时返回 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T01:02:11.320

您还可以通过将它们转换为相同格式的函数传递这两个地址。之后，您可以将它们作为字符串进行比较。

函数示例：

```
string Ip6(const string& data) {
    struct in6_addr ip6;
    if (inet_pton(AF_INET6, data.c_str(), &ip6) != 1)
        throw str::runtime_error("bad ivp6 address");

    char buf[INET6_ADDRSTRLEN];
    return inet_ntop(AF_INET6, &ip6, buf, sizeof(buf));
} 
```

# c++ - C++ - 排序算法看不到用户定义类型的重载“<”运算符。

> ID：11731455
> 
> 赞同：1
> 
> 时间：2012-07-31T00:14:34.253
> 
> 标签：c++, algorithm, codeblocks

好的，所以我有 1 个名为的用户定义类型`fraction`，它表示带有分子和分母的普通分数。这是代码：

```
class Fraction
{
private:
  int numerator;
  int denominator;

public:
  Fraction(int numer,int denom)
    :numerator(numer),denominator(denom){}

  int get_denom(){return denominator;}
  int get_numer(){return numerator;}
}; 
```

如您所见，它完全在头文件中实现。

所以我想要做的是使用排序算法对分数向量进行排序。这是重载的“<”运算符的代码（注意：它与 Fraction 类放在同一个文件中，但在类之外）：

```
bool operator<(Fraction& first,Fraction& second)
{
  if(first.get_denom() == second.get_denom())
  {
    return first.get_numer()<second.get_numer()?true:false;
  }
  int first_num=first.get_denom();
  int second_num=second.get_denom();
  int lcm=(first_num*second_num)/gcd(first_num,second_num);
  int first_new_numerator=(lcm/first_num)*first.get_numer();
  int second_new_numerator=(lcm/second_num)*second.get_numer();

  return first_new_numerator<second_new_numerator?true:false;
} 
```

它所做的是检查分母是否相等，如果它们相等，那么它会测试分子的值。如果它们不相等，则使用最小公倍数和 gcd 使它们相等。

当我想在 main 中使用排序算法时，真正的问题开始了（编译时错误）。这是主要代码：

```
Fraction parse_fraction(string& input)
{

  stringstream fraction_string(input);
  int numer;
  fraction_string>>numer;
  char seperator;
  fraction_string>>seperator;
  int denom;
  fraction_string>>denom;

  return Fraction(numer,denom);
}

int main()
{
  vector<Fraction> fractions;
  string input;
  while(cin>>input)
  {
    if(input=="|") break;
    fractions.push_back(parse_fraction(input));
  }

  sort(fractions.begin(),fractions.end);

  for(int i=0;i<fractions.size();i++)
  {
    cout<<fractions[i];
  }

  return 0;
} 
```

我得到的错误是（注意：我已经为分数正确重载了“<<”运算符，但不想在这里弄乱）：

```
/usr/include/c++/4.6/bits/stl_algo.h||In function ‘_RandomAccessIterator std::__unguarded_partition(_RandomAccessIterator, _RandomAccessIterator, const _Tp&) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Fraction*, std::vector<Fraction> >, _Tp = Fraction]’:|

/usr/include/c++/4.6/bits/stl_algo.h:2253|70|instantiated from ‘_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Fraction*, std::vector<Fraction> >]’|

/usr/include/c++/4.6/bits/stl_algo.h:2284|54|instantiated from ‘void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Fraction*, std::vector<Fraction> >, _Size = long int]’|

/usr/include/c++/4.6/bits/stl_algo.h:5330|4|instantiated from ‘void std::sort(_RAIter, _RAIter) [with _RAIter = __gnu_cxx::__normal_iterator<Fraction*, std::vector<Fraction> >]’|

/home/vanio/Desktop/workspace/C++/Ordner/main.cpp:35|43|instantiated from here|

/usr/include/c++/4.6/bits/stl_algo.h|2212|error: no match for ‘operator<’ in ‘__first.__gnu_cxx::__normal_iterator<_Iterator, _Container>::operator* [with _Iterator = Fraction*, _Container = std::vector<Fraction>, __gnu_cxx::__normal_iterator<_Iterator, _Container>::reference = Fraction&]() < __pivot’|

/usr/include/c++/4.6/bits/stl_algo.h|2212|note: candidates are:|

/usr/include/c++/4.6/bits/stl_pair.h|207|note: template<class _T1, class _T2> bool std::operator<(const std::pair<_T1, _T2>&, const std::pair<_T1, _T2>&)|

/usr/include/c++/4.6/bits/stl_iterator.h|291|note: template<class _Iterator> bool std::operator<(const std::reverse_iterator<_Iterator>&, const std::reverse_iterator<_Iterator>&)|

/usr/include/c++/4.6/bits/stl_iterator.h|341|note: template<class _IteratorL, class _IteratorR> bool std::operator<(const std::reverse_iterator<_IteratorL>&, const std::reverse_iterator<_IteratorR>&)|

/usr/include/c++/4.6/bits/basic_string.h|2510|note: template<class _CharT, class _Traits, class _Alloc> bool std::operator<(const std::basic_string<_CharT, _Traits, _Alloc>&, const std::basic_string<_CharT, _Traits, _Alloc>&)|

/usr/include/c++/4.6/bits/basic_string.h|2522|note: template<class _CharT, class _Traits, class _Alloc> bool std::operator<(const std::basic_string<_CharT, _Traits, _Alloc>&, const _CharT*)|

/usr/include/c++/4.6/bits/basic_string.h|2534|note: template<class _CharT, class _Traits, class _Alloc> bool std::operator<(const _CharT*, const std::basic_string<_CharT, _Traits, _Alloc>&)|

/usr/include/c++/4.6/bits/stl_vector.h|1290|note: template<class _Tp, class _Alloc> bool std::operator<(const std::vector<_Tp, _Alloc>&, const std::vector<_Tp, _Alloc>&)|

/home/vanio/Desktop/workspace/C++/Ordner/Fraction.h|39|note: bool operator<(Fraction&, Fraction&)|

/home/vanio/Desktop/workspace/C++/Ordner/Fraction.h|39|note:   no known conversion for argument 2 from ‘const Fraction’ to ‘Fraction&’|

/usr/include/c++/4.6/bits/stl_algo.h|2215|error: no match for ‘operator<’ in ‘__pivot < __last.__gnu_cxx::__normal_iterator<_Iterator, _Container>::operator* [with _Iterator = Fraction*, _Container = std::vector<Fraction>, __gnu_cxx::__normal_iterator<_Iterator, _Container>::reference = Fraction&]()’|

/usr/include/c++/4.6/bits/stl_algo.h|2215|note: candidates are:|

/usr/include/c++/4.6/bits/stl_pair.h|207|note: template<class _T1, class _T2> bool std::operator<(const std::pair<_T1, _T2>&, const std::pair<_T1, _T2>&)|

/usr/include/c++/4.6/bits/stl_iterator.h|291|note: template<class _Iterator> bool std::operator<(const std::reverse_iterator<_Iterator>&, const std::reverse_iterator<_Iterator>&)|

/usr/include/c++/4.6/bits/stl_iterator.h|341|note: template<class _IteratorL, class _IteratorR> bool std::operator<(const std::reverse_iterator<_IteratorL>&, const std::reverse_iterator<_IteratorR>&)|

/usr/include/c++/4.6/bits/basic_string.h|2510|note: template<class _CharT, class _Traits, class _Alloc> bool std::operator<(const std::basic_string<_CharT, _Traits, _Alloc>&, const std::basic_string<_CharT, _Traits, _Alloc>&)|

/usr/include/c++/4.6/bits/basic_string.h|2522|note: template<class _CharT, class _Traits, class _Alloc> bool std::operator<(const std::basic_string<_CharT, _Traits, _Alloc>&, const _CharT*)|

/usr/include/c++/4.6/bits/basic_string.h|2534|note: template<class _CharT, class _Traits, class _Alloc> bool std::operator<(const _CharT*, const std::basic_string<_CharT, _Traits, _Alloc>&)|

/usr/include/c++/4.6/bits/stl_vector.h|1290|note: template<class _Tp, class _Alloc> bool std::operator<(const std::vector<_Tp, _Alloc>&, const std::vector<_Tp, _Alloc>&)|

/home/vanio/Desktop/workspace/C++/Ordner/Fraction.h|39|note: bool operator<(Fraction&, Fraction&)|

/home/vanio/Desktop/workspace/C++/Ordner/Fraction.h|39|note:   no known conversion for argument 1 from ‘const Fraction’ to ‘Fraction&’|
||=== Build finished: 22 errors, 0 warnings ===| 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T00:22:32.717

```
bool operator<(Fraction& first,Fraction& second) 
```

问题是你的重载`operator<`只接受非常量参数，但算法试图将一个常量引用`Fraction`与你的容器中的元素进行比较。

由于`operator<`不修改比较对象的内容，它应该通过 const 引用来获取它们：

```
bool operator<(Fraction const & first,Fraction const & second) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:26:37.297

考虑这段代码：

```
Fraction a, b;
bool res = (a < b); 
```

第二行本质上是调用

```
bool res = a.operator<(b); 
```

1.  如上所述 - 从长远来看，正确的 const 将为您提供很好的服务
2.  定义一个成员`bool operator<(const Fraction&) const`以使排序实现满意，或者只使用上面的第一个建议 - 使用 const-correct`bool operator<(const Fraction& a, const Fraction& b)`

# sql - 转换数据的维度是否有技术术语？

> ID：11731457
> 
> 赞同：3
> 
> 时间：2012-07-31T00:14:47.943
> 
> 标签：sql, data-warehouse, multidimensional-array

是否有专门用于转换数据的维度的术语？

例如，我遇到了一个将日期数据转换为不同表示形式的维度（例如 FY1 和其他表示形式的财政年度的缩写）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T15:12:14.050

在某种意义上，所有维度都是数据“转换”的结果，即使它只是将多个关系表反规范化为具有重复属性的宽维度表。

在日期维度中有多个日期表示是一种很好的做法。它允许您存储诸如财政日历（5-4-4 财政周等）之类的内容，这些内容可能因组织而异，并且不容易使用公式创建。使用此维度，您可以基于特定属性（按会计月与日历月报告）等构建聚合。

是的，该日期的所有属性都可能在 DATETIME 类型中“隐含”，但它使查询更易于维护，并且业务用户可以轻松地使用数据提供基于该日期的多个属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T15:45:12.853

我想说日期的所有表示都应该永久存储在日历维度中。仓库通常有一个企业层，其中将来自多个系统的数据汇集在一起​​，符合（以便键和日期等都采用相同的格式）和丰富 - 即我们创建要在日历维度中使用的所有日期表示。然后你有表示层（Kimball），它以故意的方式去规范化以使查询运行得更快。允许我们丰富维度的表是企业层的一部分，而不是表示层，因此根据定义，维度也不是。维度仅位于表示层中。我的意见，当然！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T13:31:02.963

数据仓库解决方案中的所有维度基本上都存在，因为最终用户希望能够基于该维度做出决策。
*（在实践中，最终用户可能会根据几个维度的组合做出决定）。*

最终数据仓库解决方案中的维度本身就是大型数据转换过程的结果。

那是：

*   原始数据的转换，其中数据来自多个来源
*   以丰富原始数据的形式进行转换（fx 应用层次结构）
*   等等...

因此，说到仅转换数据的维度，首先是一种描述维度属性的模糊方式，因为它的含义有点不清楚。

但是考虑到这一点，我以这种方式承认您的问题，这让我们问自己：“**转换维度**”是否可以成为数据仓库中存在的一种新型维度？

好吧，如果您将“转换维度”视为完全源自另一个维度的维度，而不受原始数据的影响，那么“转换维度”的概念就会变得更加精确。

因此，在您的情况下，将日期数据转换为不同表示形式的维度可以正确地称为“转换维度”。

有关数据仓库中维度表类型的更全面列表，请查看以下问题：
[星型模式设计中的维度表类型是什么？](https://stackoverflow.com/questions/8184214/what-are-the-types-of-dimension-tables-in-star-schema-design)

# php - 从 img 标签调用 JavaScript 函数

> ID：11731459
> 
> 赞同：0
> 
> 时间：2012-07-31T00:15:21.587
> 
> 标签：php, javascript, html

我试图通过我的函数从数组中获取单个变量`open_boosters()`，然后将变量发送到我的 PHP 脚本。这样做的正确方法是什么？

我现在只有这个生成随机数的 JavaScript 函数，称为`open_boosters()`.

```
><img src="site3.php?"action="document.getElementById("?").innerHTML=open_boosters();"/> 
```

在我的 PHP 中，我应该简单地使用 $_GET 方法绑定变量吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:33:18.757

最好的做法是将行为从 HTML 中移出到一个`<script>`标签中，或者更好的是，一个外部脚本文件（尽管能够将事件附加到 HTML 元素）。在这种情况下，没有理由将您的代码绑定到与图像无关的图像元素（看起来它正在尝试填充其他元素）。

```
<script>
// This code will not work with older IE versions; you may
// wish to use a library like jQuery to handle all the complexities
// of browser compatibility; or you can avoid all this by putting
// the script tag after your elements
window.addEventListener('DOMContentLoaded', function () {
    var rand = open_boosters();
    document.getElementById("?").innerHTML=rand;
    document.getElementById("randImg").src = "site3.php?randomNumber"+rand;
}, false);
</script>
<img id="randImg" /> 
```

然后在您的 PHP 代码中：

```
<?php
$_GET['randomNumber']; // Do something with it (though safely--e.g., do not add directly to a SQL string, etc.)
?> 
```

# jquery - 如何在发送的 settings.data 之前将对象添加到 jQuery ajax

> ID：11731460
> 
> 赞同：4
> 
> 时间：2012-07-31T00:15:24.817
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, ujs

我绑定到 beforeSend 的 ajax 表单提交：

我的功能如下：

```
submitStuff : function(e, xhr, settings) {

    settings.data = {
            invitation : {
                emails : me.returnsArrayX(),
                bucket2 : me.returnsArrayY(),
                bucket3 : me.returnsArrayZ()
            }
    }

} 
```

当我像这样手动提交到服务器时，这是有效的：

```
 $.ajax({
        type: 'POST',
        url: '/myurl',
        dataType: 'json',
        data: {
            invitation : {
                emails : me.returnsArrayX(),
                bucket2 : me.returnsArrayY(),
                bucket3 : me.returnsArrayZ()
            }
        }
    }); 
```

但由于我使用的是 Rails UJS，我想使用内置的表单提交器（数据远程）。为什么 settings.data 在上面不起作用？我需要将对象转换为数组或其他东西吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T21:12:52.200

设置`processData`为`false`，那么您可以简单地使用 中的对象`beforeSend`：

```
$.ajax("/", {
    beforeSend: function(xhr, settings) {
        settings.data.key2 = "value2";
        settings.data.key3 = {
             more: "values",
             like: "this"
        }; 

        //Encode at end
        settings.data = jQuery.param(settings.data, false);
    },
    data: {
        key: "value"
    },
    processData: false,
    type: "POST"
}​);​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T12:02:34.007

Try this

```
submitStuff : function(e, xhr, settings) {

  settings.data += "&serialized=data";

} 
```

similar post: [How do I append data to a jquery-ujs post request in Rails?](https://stackoverflow.com/questions/6180454/how-do-i-append-data-to-a-jquery-ujs-post-request-in-rails)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T11:58:52.923

为了序列化数据，我将使用[jQuery.param(obj)](http://api.jquery.com/jQuery.param/)。所以从 pdpMathi 的例子来看，它看起来像这样。

```
submitStuff : function(e, xhr, settings) {

    data = {
            invitation : {
                emails : me.returnsArrayX(),
                bucket2 : me.returnsArrayY(),
                bucket3 : me.returnsArrayZ()
            }
    }
    settings.data += "&serialized=" + jQuery.param(data)

} 
```

[您可以在这里jsFiddle](http://jsfiddle.net/cDdn6/)看到上面对一些简单示例数据的作用。这使您可以轻松地处理数据，并且仅在完成后对其进行序列化。

# sum - 添加使用 Arduino Uno 和 RFID 标签刷卡的项目总数

> ID：11731462
> 
> 赞同：1
> 
> 时间：2012-07-31T00:15:38.073
> 
> 标签：sum, arduino, microcontroller, rfid

我正在开发一种基于 RFID 的手持设备，该设备使用户能够在设备上刷卡产品并汇总他们的购买。设置 RFID 标签以显示价格以及在刷卡后将标签添加在一起的代码是什么？

Arduino Uno 有可能吗？到目前为止，这就是我所拥有的，它只是在刷卡后显示 RFID 标签。

```
int RFIDResetPin = 13;

char tag1[13] = "5000B9A7155B"
char tag2[13] = "5000B9A7155B"
char tag3[13] = "5000B9A7155B"
char tag4[13] = "5000B9A7155B"
char tag5[13] = "5000B9A7155B"

void setup() {
    Serial.begin(9600);  // Connect to the serial port.
}

void loop () {
    byte i = 0;
    byte val = 0;
    byte code[6];
    byte checksum = 0;
    byte bytesread = 0;
    byte tempbyte = 0;

    if(Serial.available() > 0) {
        if((val = Serial.read()) == 2) {  // Check for header
            bytesread = 0;
            while (bytesread < 12) {  // Read 10 digit code + 2 digit checksum
                if( Serial.available() > 0) {
                    val = Serial.read();
                    if((val == 0x0D)||
                       (val == 0x0A)||
                       (val == 0x03)||
                       (val == 0x02)) { // If header or stop bytes before the 10 digit reading.

                        break;  // Stop reading
                    }

                    // Do ASCII/hexadecimal conversion:
                    if ((val >= '0') && (val <= '9')) {
                        val = val - '0';
                    }
                    else
                        if ((val >= 'A') && (val <= 'F')) {
                            val = 10 + val - 'A';
                        }

                    // Every two hex-digits, add byte to code:
                    if (bytesread & 1 == 1) {
                        // Make some space for this hex-digit by
                        // shifting the previous hex-digit with 4 bits to the left:
                        code[bytesread >> 1] = (val | (tempbyte << 4));

                        if (bytesread >> 1 != 5) {             // If we're at the checksum byte,
                            checksum ^= code[bytesread >> 1];  // Calculate the checksum... (XOR)
                        };
                    }
                    else {
                        tempbyte = val;                        // Store the first hex digit first...
                    };

                    bytesread++;                               // Ready to read next digit
                }
            }

            // Output to Serial:

            if (bytesread == 12) {                             // If 12 digit read is complete
                Serial.print("5-byte code: ");
                for (i=0; i<5; i++) {
                    if (code[i] < 16)
                        Serial.print("0");
                    Serial.print(code[i], HEX);
                    Serial.print(" ");
                }
                Serial.println();

                Serial.print("Checksum: ");
                Serial.print(code[5], HEX);
                Serial.println(code[5] == checksum ? " -- passed." : " -- error.");
                Serial.println();
            }
            bytesread = 0;
        }
    }
} 
```

# c# - 如何设置控件和表单大小以根据屏幕分辨率进行更改？

> ID：11731467
> 
> 赞同：0
> 
> 时间：2012-07-31T00:16:01.590
> 
> 标签：c#, winforms

例如，我刚刚创建了一个新表单，我通过单击按钮向他展示。

在新的表单设计器中，我添加了 4 个面板并将它们停靠在右上左下中心。

然后在底部面板上添加了一个测试按钮。

现在我在我的屏幕分辨率 1920X1080 上做到了。

但是，当我将分辨率切换到 1024X768 时，按钮似乎还可以，但它自身的形式向左和向右超出了界限。

那么我怎样才能使该表格适合屏幕分辨率的变化呢？我希望表单是全屏或非全屏，但每次更改显示器分辨率时都适合新分辨率。

如果表单大小为 170X120，不仅要适合的控件，还要适合表单，所以我不想更改表单大小，而是让他适应新的分辨率。我的意思是也许我将不得不改变表格的大小，但我的想法是保持表格的原样并让他适应新的分辨率。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:23:26.890

最简单的方法之一是使用百分比而不是像素值。将表单的宽度设置为 100%，将其中的每个元素设置为 25% 或填充空间所需的任何内容。这是我最初的尝试，没有看到任何代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:32:18.080

您可以使用锚属性让控件调整到窗口的大小。

这是一篇关于如何使用锚点的精彩文章：

[http://www.techrepublic.com/article/manage-winform-controls-using-the-anchor-and-dock-properties/6165908](http://www.techrepublic.com/article/manage-winform-controls-using-the-anchor-and-dock-properties/6165908)

# sql - SQL 查询 - 同步表

> ID：11731469
> 
> 赞同：0
> 
> 时间：2012-07-31T00:16:32.963
> 
> 标签：sql

我有 2 张桌子。`Auth`和`User`

Auth 有 ff。列（来源） 18883 行

```
id | username | password 
```

用户有ff。列（目标）18868 行

```
id | username | first name | last name | email 
```

嗯

```
auth.id = user.id
auth.username = user.username 
```

现在由于某种原因，`User`表中有一些用户名丢失的行。我想要做的是制作一个脚本来查找缺失的行`User`并插入id和用户名，`Auth`然后插入`first name`='fname'，`last name`='lname' ，=' `email`name@domain.com'。

因此，两个表将具有相同的行数并且是同步的。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:21:28.807

您不清楚缺少什么。. . id 或用户名或两者兼而有之。假设用户名指定缺失，以下查询会执行您想要的操作：

```
insert into user(id, uesrname, firstname, lsatname, email)
    select a.id, a.username. 'fname', lname', 'name@domain.com'
    from auth a left outer join
         user u
         on a.username = u.username
    where u.id is null 
```

这假设用户表中的用户名不重复。

名为“id”的列在两个表中具有相同的值似乎很奇怪。你应该重新审视你的数据结构，看看是否真的如此。通常，“id”是一个自动递增的主键。

# ruby-on-rails - Rails 的acts_as_taggable_on 实现

> ID：11731470
> 
> 赞同：2
> 
> 时间：2012-07-31T00:16:33.803
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试在我的网站上实施[acts_as_taggable_on 。](https://github.com/mbleigh/acts-as-taggable-on)

我已经运行了安装设置，它运行良好。我正在努力编写代码以使其工作。

我得到正确的错误如下：`undefined method 'each' for "tag1, tag2, tag3":String`在第 29 行`@video = Video.new(params[:video])`。

这是我所拥有的...

视频控制器

```
acts_as_taggable 
```

以我的形式

```
= f.text_field :tags 
```

在我的模型中

```
@video = Video.new(params[:video])
@video.tag_list = params[:video][:tags]
if @video.save
  ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:14:40.167

您收到此错误是因为您传递`params[:video]`了哪些属性以及其他属性，其中包含模型中`:tags`属性的数据`Video`。这是一个问题，因为它将使用`acts_as_taggable_on`的 writer 方法`tags=`，它需要一个`Array`，而不是 a `String`，这与*它*`tag_list=`需要a不同。*`String`*

 *一种解决方案，保持大部分代码不变，将其`:tags`从中删除`params`并将其传递给`tag_list=`：

```
tags_str = params[:video].delete(:tags)
@video   = Video.new(params[:video])
@video.tag_list = tags_str

if @video.save
  # ... 
```

当然，上面有很多变化来获得一个可行的解决方案。一方面，你可以只给`tags=`想要的东西，`:tags`分成`params`一个`Array`

```
video_params = params[:video]
video_params[:tags] = video_params[:tags].split(/\,\s*/)
@video   = Video.new(video_params)

if @video.save
  # ... 
```*

# java - 带有 java 代理的 ClassNotFoundException (-javaagent:jarpath)

> ID：11731471
> 
> 赞同：0
> 
> 时间：2012-07-31T00:16:35.613
> 
> 标签：java, jboss, classloader, jboss7.x, agent

我的问题的根源是我正在尝试从部署在 JBoss AS7 上的 Web 应用程序中使用 SizeOf [sourceforge 项目](http://sourceforge.net/projects/sizeof/)并获得一个`ClassNotFoundException`for `net.sourceforge.sizeof.SizeOf`. 我添加`-javaagent:/path_to_jar/SizeOf.jar`到服务器`JAVA_OPTS`并`System.out.println`在服务器启动时查看 premain 方法（JAVAGENT：为类 SizeOf 调用 premain 工具）。但是，当我尝试`SizeOf.sizeOf(obj)`从我的 servlet 的 doGet 方法调用时，应用程序失败并出现上述`ClassNotFoundException`.

如果有人能告诉我如何让这个与 JBoss AS7 一起工作，那将很有帮助（我让它在 Eclipse 运行配置中工作——相当于从命令行运行）。除此之外，我真正想做的是了解类加载如何为 Java 代理工作。我能找到的最好的文档在[官方 JVM 文档](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/package-summary.html)中，而且非常稀少。关于类加载它所说的只是 Premain-Class 将由系统类加载器加载。我看到一篇博客文章建议不需要将 jar 放在类路径上，因为 -javaagent JVM 参数会处理这个问题，所以看起来我不应该将 SizeOf jar 添加为AS7 模块。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T01:40:04.917

需要执行以下操作：

*   为代理创建一个模块：创建文件夹 modules/net/sourceforge/sizeof/main 并添加 sizeof.jar 和一个 module.xml
*   将模块添加到引导配置：将 JBOSS_MODULES_SYSTEM_PKGS="net.sourceforge.sizeof" 添加到 bin/standalone.conf
*   同样在 bin/standalone.conf 中，将 -javaageent:../modules/net/sourceforge/sizeof/main/sizeof.jar 附加到 JAVA_OPTS

# asp.net-mvc - 使用 MVC / LINQ 以特定格式显示表中的（平面）数据行

> ID：11731475
> 
> 赞同：1
> 
> 时间：2012-07-31T00:17:13.577
> 
> 标签：asp.net-mvc, linq, entity-framework

我有一个表，其列名类似于“ADDRESS”、“OLD_ADDRESS”、“CITY”、“OLD_CITY”、“STATE”、“OLD_STATE”......等等。我正在使用实体框架查询提取此信息并将模型传递到 ASP.NET MVC 视图中。

我需要以表格格式显示此信息，如下所示

![在此处输入图像描述](../Images/515e5a6e6b91076d33e493bcfcb162ff.png)

我需要比较旧字段和新字段，如果值存在差异，请显示它。做这样的事情的最好方法是什么？我可以通过循环遍历模型并比较 if (item.ADDRESS == item.OLD_ADDRESS) { .... } 以正常方式构建它，但是这个特定的表有大约 100 列，我基本上会写 50 个“if”条件。假设 linq 查询只返回一行。

我正在从旧数据库中读取此信息，无法重新设计它。在此先感谢您的任何建议。

----------------------------- 编辑 1-------------------- ---------这是我迄今为止尝试过的 -

```
@foreach (var BusRels in Model)
           {               
               foreach (var busrel in BusRels.GetType().GetProperties())
               {   
                    if (busrel.Name.IndexOf("OLD") > -1) {                        
                            {
                                var fieldVal = busrel.GetValue(BusRels, null);                                
                                if ( fieldVal != null)
                                {
                                    if (!fieldVal.ToString().Trim().IsEmpty())
                                    {   
                                        <tr>
                                        @{
                                            //BusRels.GetType().GetProperties().Where(p => p.Name == fieldVal.
                                        var displayName = busrel.GetCustomAttributes(typeof(System.ComponentModel.DisplayNameAttribute), false)
                                        .Cast<System.ComponentModel.DisplayNameAttribute>()
                                        .FirstOrDefault().DisplayName;
                                        }

                                        <td>@displayName</td>
                                        <td>@busrel.GetValue(BusRels, null)</td>
                                        <td>???????</td>
                                        </tr>   
                                    }
                                }
                            }
                    }
               } 
```

我想这里的问题是我似乎无法让“新”值显示在旧值旁边。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T03:51:57.860

您可以使用 LINQ 获取要显示的值：

```
var matches = from BusRels in Model
              from busrel in BusRels.GetType().GetProperties()
              where busrel.Name.StartsWith("OLD")
              let fieldVal = busrel.GetValue(BusRels, null)
              where Convert.ToString(fieldVal).IsNullOrWhiteSpace()
              let newval = BusRels.GetType()
                                  .GetProperty(busrel.Name.Replace("OLD_", ""))
                                  .GetValue(BusRels, null)
              where newval.ToString().Trim() != fieldVal.ToString().Trim()
              let displayName = busrel.GetCustomAttributes(typeof(System.ComponentModel.DisplayNameAttribute), false)
                                      .Cast<System.ComponentModel.DisplayNameAttribute>()
                                      .FirstOrDefault().DisplayName
              select new
                     {
                         DisplayName = displayName,
                         NewVal = newval,
                         OldVal = fieldVal
                     }; 
```

然后你只需要循环并显示它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:59:21.403

好的......有点乱，但看起来它正在工作。如果有人阅读本文有更好的方法，我想听听。谢谢。

```
@foreach (var BusRels in Model)
                    {
                        foreach (var busrel in BusRels.GetType().GetProperties())
                        {
                            if (busrel.Name.IndexOf("OLD") > -1)
                            {
                                {
                                    var fieldVal = busrel.GetValue(BusRels, null);
                                    if (fieldVal != null)
                                    {
                                        if (!fieldVal.ToString().Trim().IsEmpty())
                                        {   
                                            var newval = BusRels.GetType().GetProperty(busrel.Name.Replace("OLD_", "")).GetValue(BusRels, null);

                                            //BusRels.GetType().GetProperties().Where(p => p.Name == fieldVal.
                                            var displayName = busrel.GetCustomAttributes(typeof(System.ComponentModel.DisplayNameAttribute), false)
                                            .Cast<System.ComponentModel.DisplayNameAttribute>()
                                            .FirstOrDefault().DisplayName;
                                            var oldval = busrel.GetValue(BusRels, null);

                                            if (newval.ToString().Trim() != oldval.ToString().Trim())
                                            {  
                                            <tr>
                                                <td>@displayName</td>
                                                <td>@newval</td>
                                                <td>@oldval</td>
                                            </tr>   
                                            }
}
                                    }
                                }
                            }
                        }
                    } 
```

# facebook - 优先考虑 og:image

> ID：11731477
> 
> 赞同：0
> 
> 时间：2012-07-31T00:18:03.960
> 
> 标签：facebook, facebook-opengraph

我有一个主模板，它有一个 opengraph 图像标签。

```
<meta property="og:image" content="http://www.myimage.com/one.png" /> 
```

我还有一个子模板，它在我使用的 CMS 中（typo3）继承所有父代码并为我想要放入的子页面添加任何特定代码。例如，在这个页面上我想要一些特殊的 css 文件，它只会得到包含在此页面及其子页面中。这在大多数情况下都可以正常工作，但在这个特定页面上我也有一个元标记。

```
<meta property="og:image" content="http://www.myimage.com/special.png" /> 
```

当我在[http://developers.facebook.com/tools/lint](http://developers.facebook.com/tools/lint)上对此进行 lint 处理时，两个图像都出现了。可以优先考虑吗？据我所知，它随机选择任一图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:17:32.670

我的理解是，如果您需要各种图像，您可以使用任意数量的 og:image 标签，但文档似乎没有说明任何优先级。所以现在看来​​，多个 og:images 的默认值是随机显示的。

这是我以前参考的文档：[https ://developers.facebook.com/docs/opengraphprotocol/](https://developers.facebook.com/docs/opengraphprotocol/)

对不起，我不能提供更多帮助。

# html - 用图标类装饰输入标签？

> ID：11731480
> 
> 赞同：-1
> 
> 时间：2012-07-31T00:18:54.677
> 
> 标签：html, css, twitter-bootstrap

使用 twitter-bootstrap，如何用图标装饰我的输入标签？

我试过了：

```
<p class="icon-search"><input type="submit" value="search" /></p>​ 
```

和：

```
<p><input type="submit" value="search" class="icon-search" /></p>​ 
```

但似乎没有任何效果。[JSfiddle](http://jsfiddle.net/AlecTaylor/CsjbB/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:31:40.447

您不能使用`<input>`图标，因此您必须寻找该`<button>`代码：

```
<button type="submit" class="btn"><i class="icon-search"></i> search</button> 
```

稍微滚动[一下文档](http://twitter.github.com/bootstrap/base-css.html#icons)。

[更新的小提琴](http://jsfiddle.net/Sherbrow/CsjbB/1/)（演示没有`.btn`课程，您可能想尝试一下）

# sql - PL/pgSQL SELECT 到一个数组中

> ID：11731481
> 
> 赞同：13
> 
> 时间：2012-07-31T00:19:11.280
> 
> 标签：sql, postgresql, plpgsql, postgresql-9.1

这是我的函数声明和正文的一部分：

```
CREATE OR REPLACE FUNCTION access_update()
RETURNS void AS $$
DECLARE team_ids bigint[];
BEGIN
    SELECT INTO team_ids "team_id" FROM "tmp_team_list";

    UPDATE "team_prsnl"
    SET "updt_dt_tm" = NOW(), "last_access_dt_tm" = NOW()
    WHERE "team_id" IN team_ids;
END; $$ LANGUAGE plpgsql; 
```

我想`team_ids`成为一个整数数组，然后可以在`UPDATE`语句中使用。这个函数给我这样的错误：

```
psql:functions.sql:62: ERROR:  syntax error at or near "team_ids"
LINE 13:  AND "team_id" IN team_ids; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-31T02:22:22.200

[在您的语句中使用](http://www.postgresql.org/docs/current/interactive/sql-update.html)[`FROM`子句`UPDATE`](http://www.postgresql.org/docs/current/interactive/sql-update.html)更快更简单：

```
UPDATE team_prsnl p
SET    updt_dt_tm = now()
      ,last_access_dt_tm = now()
FROM   tmp_team_list t
WHERE  p.team_id = t.team_id; 
```

* * *

除此之外，在使用数组操作时，该`WHERE`子句必须是

```
WHERE team_id = ANY (team_ids) 
```

该`IN`构造适用于集合，而不适用于数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-31T00:57:01.770

从 a 创建一个数组`SELECT`：

```
# select array(  select id from tmp_team_list ) ;
 ?column? 
----------
 {1,2}
(1 row) 
```

该`IN`运算符被[记录](http://www.postgresql.org/docs/9.1/static/functions-subquery.html#FUNCTIONS-SUBQUERY-IN)为对右手操作数进行子查询。例如：

```
UPDATE team_prsnl SET updt_dt_tm = NOW()
 WHERE team_id IN (SELECT id FROM tmp_team_list); 
```

也许您可以完全避免使用数组，或者尝试提供数组或`select from team_ids`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-30T09:33:43.050

基于其他答案的微小定制。
如果`team_id`是普通的 int 数据类型。

```
 UPDATE team_prsnl p
    SET    updt_dt_tm = now()
          ,last_access_dt_tm = now()
    FROM   tmp_team_list t
    WHERE  p.team_id = any(array(select team_id from t)); 
```

# java - 保存私钥的标准是什么？

> ID：11731483
> 
> 赞同：1
> 
> 时间：2012-07-31T00:19:31.103
> 
> 标签：java, base64, aes, rsa, private-key

标题说什么。

我正在使用 Java.security.* 在 java 中生成一个私钥

当使用 RSA 部分时，我会生成一个公钥和一个私钥。我从阅读的内容中假设的私钥以 AES 256 位加密，以帮助确保其安全。然后，当它被使用时，它被解密。

我的问题是私钥应该如何存储在磁盘上？

这是我想我到目前为止发现的......

1.  生成私钥
2.  使用 SALT 使用 AES 256 位加密私钥
3.  将私钥存储在 ASCII Armor Base 64 中

我想知道你是否应该给任何东西加盐以及如何将盐储存在钥匙中？此外，对于加密私钥，大多数程序的标准是 AES 256 位吗？

谢谢！

**另外，您如何存储电子邮件信息、图片...等？**

# c++ - 具有类作用域的动态分配堆栈内存

> ID：11731486
> 
> 赞同：0
> 
> 时间：2012-07-31T00:20:16.650
> 
> 标签：c++, memory-management, stack, alloca, variable-length-array

一些编译器支持对 C++ 的扩展，因此可以在堆栈上动态分配内存。例如，`g++`支持`alloca()`以及 VLA。所有这些扩展都带有一个警告，即动态分配的内存在调用函数范围的末尾被“释放”。（编辑：为了澄清，我在'deallocated'周围使用引号，因为实际发生的是编译器正在递减/递增堆栈指针，因此为什么`alloca()`需要编译器支持。）这意味着`alloca()`在类的构造函数中分配的内存被释放一旦构造函数返回。

在构造函数通过一些重要步骤来确定要分配多少内存的类中，这种限制变得难以处理。类的用户必须在构造类的函数中分配内存，暴露一些可以说不应该暴露的内部结构。此外，在我的代码中加入变通办法以便能够使用`alloca()`或 VLA 通常不方便。

你能想出一些方法来规避这个限制，以便我可以使用`alloca()`VLA 或其他语言扩展，从而可以在类内分配内存并具有类范围吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T00:24:37.190

不，这是不可能的。一个类不能分配函数本地内存——那是没有意义的。

但是，您*可以*使用适当的自定义分配器来实现极快的堆分配，例如内存竞技场 - 到它足够快的程度。您需要记住的是，这`new`是内存分配的核弹头——它必须支持*任何*分配大小和任何分配/解除分配模式。更具体的东西可以运行得更快，甚至可以与堆栈分配的内存竞争。在 Visual Studio 2010 上，我什至可以让它*比*`alloca`.

# php - 链接 CSS 会根据 URL 发生变化，并在子 URL 上保持样式

> ID：11731487
> 
> 赞同：0
> 
> 时间：2012-07-31T00:20:20.450
> 
> 标签：php, css

在试图解决这个问题时，我正在处理以下类型的断断续续的代码。

```
<?php $curURL = ROOT.$_SERVER['REQUEST_URI']; ?>
            <li><a href="<?php $href = APP_ROOT; echo $href; ?>" class="<?php if($href == $curURL) { ?>main_active<?php } ?>">HOME</a></li>
            <li><a href="<?php $href = APP_ROOT.'about'; echo $href; ?>" class="<?php if($href == $curURL) { ?>main_active<?php } ?>">ABOUT</a></li>
            <li><a href="<?php $href = APP_ROOT.'portfolio'; echo $href; ?>" class="<?php if($href == $curURL) { ?>main_active<?php } ?>">PORTFOLIO</a></li>
            <li><a href="<?php $href = APP_ROOT.'services'; echo $href; ?>" class="<?php if($href == $curURL) { ?>main_active<?php } ?>">SERVICES</a></li>
            <li><a href="<?php $href = APP_ROOT.'blog'; echo $href; ?>" class="<?php if($href == $curURL) { ?>main_active<?php } ?>">BLOG</a></li>
            <li><a href="<?php $href = APP_ROOT.'contact'; echo $href; ?>" class="<?php if($href == $curURL) { ?>main_active<?php } ?>">CONTACT</a></li> 
```

我目前得到的结果是，如果我在选定的页面 url 上，`(ex. http://localhost/myapp/index/)`那么它将相应地更改 css 样式。我希望发生的是，即使我在该页面的子 url 上，css 样式也会保持变化`(ex. http://localhost/myapp/index/dosomething/)`。一段时间以来，我一直在用头撞墙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:29:22.713

这就是我在我的一个网站上的做法。这是一个将类应用于活动链接的示例，但想法是相同的......

PHP

```
$current_url = "http://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];
$fullPath = parse_url($current_url, PHP_URL_PATH);
$prepare = explode('/',$fullPath);
$path = "/" . $prepare[1]; 
```

HTML

```
<li><a href="location.php"<?php if($path == $thePath) { echo 'class="active"';}?>>Link Title</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:27:21.410

一种方法是解构路径并查看结构是什么。例如，如果路径是 myapp/index/dosomething，则采用该路径并通过用“/”分割字符串来创建一个数组。然后检查一下 array[2] 是什么并根据它设置你的样式。

# javascript - 使用 jquery 对 JSON 进行排序

> ID：11731501
> 
> 赞同：4
> 
> 时间：2012-07-31T00:22:40.370
> 
> 标签：javascript, jquery, json

如何按 first_name 对这个 JSON 对象进行排序？

```
{
    1  :{user_id:1, first_name:"first_name1", last_name:"lastname1", email:"user1@test.com"},
    7  :{user_id:7, first_name:"user2", last_name:"test2", email:""}, 
    72 :{user_id:72, first_name:"testing343", last_name:"", email:""},
    246:{user_id:246, first_name:"aaa", last_name:"ssss", email:""}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T00:35:13.860

首先，您的*JSON 字符串*无效。首先清除它，您被迫以`eval()`当前形式使用字符串，这是`JSON.parse()`行不通的。

* * *

对象键按规范无序。您不能静态地“排序”键名并将它们冻结在对象中。但是您当然可以对键名进行排序并按该顺序对它们的值进行操作。

例如：

```
var json = '{1:{user_id:1, first_name:"first_name1", last_name:"lastname1", email:"user1@test.com"}, 7:{user_id:7, first_name:"user2", last_name:"test2", email:""}, 72:{user_id:72, first_name:"testing343", last_name:"", email:""}, 246:{user_id:246, first_name:"aaa", last_name:"ssss", email:""}}';

json = eval( json );

Object.keys( json ).sort(function( a,b ) {
    return json[a].first_name.localeCompare( json[b].first_name );
}).forEach(function( key ) {
    console.log( json[key].first_name );
}); 
```

该代码假定支持 ES5 的 JS 引擎或任何类型的 ES5-shim 库的可用性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T00:37:34.200

编写您的 JSON 对象，如下所示：

```
data = [{user_id:1, first_name:"first_name1", last_name:"lastname1", email:"user1@test.com"}, {user_id:7, first_name:"user2", last_name:"test2", email:""}, {user_id:72, first_name:"testing343", last_name:"", email:""}, {user_id:246, first_name:"aaa", last_name:"ssss", email:""}] 
```

所以它现在是一个数组。然后你可以调用`.sort()`它。

```
data.sort(function(a, b) {
    var x = a.first_name.toLowerCase(), y = b.first_name.toLowerCase();
    return x < y ? -1 : x > y ? 1 : 0;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:28:47.843

为什么要对对象进行排序？

您需要将此对象循环到一个数组中，然后对该数组进行排序。[http://jsfiddle.net/z2xsC/](http://jsfiddle.net/z2xsC/)例如：

```
//loop into array
var arr = [];
for( var key in data ){
  if( data.hasOwnProperty( key ) ){
    arr.push( data[key] );
  }
}

//now, sort your array
arr.sort( function(a,b) { 
  var nameA=a.first_name.toLowerCase(),
      nameB=b.first_name.toLowerCase();

  if (nameA < nameB){ 
    return -1; 
  } else if (nameA > nameB){ 
    return 1
  } else { 
    return 0
  }
}); 
```

# emacs - 人们如何在 ECB Emacs 中进行调试？

> ID：11731503
> 
> 赞同：5
> 
> 时间：2012-07-31T00:22:57.560
> 
> 标签：emacs, gdb, emacs-ecb

我想在 ECB 中调试以使用它的功能。我认为 ECB 没有内置的调试布局。（可能有用的窗口有：堆栈、断点、局部变量、线程、gdb 命令窗口等）

我需要在 ECB 中创建自定义布局还是人们使用其他方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-17T07:51:59.740

没有针对该问题的特定于 ECB 的解决方案的原因是它`M-x gdb`已经提供了您正在寻找的类似 IDE 的界面（包括您提到的所有窗口）。有关详细信息，请参阅[https://www.gnu.org/software/emacs/manual/html_node/emacs/GDB-Graphical-Interface.html](https://www.gnu.org/software/emacs/manual/html_node/emacs/GDB-Graphical-Interface.html)

# android - 安卓泄露窗口

> ID：11731504
> 
> 赞同：0
> 
> 时间：2012-07-31T00:22:57.410
> 
> 标签：android, android-asynctask

我正在使用 AsyncTask 收集数据，然后开始一个新活动，但我得到了一个泄露的窗口。

```
 class GetDataTask extends AsyncTask<Void, Void, Void> {     

    @Override
    protected void onPreExecute()

    {
        mProgressDialog = new ProgressDialog(getActivity());
        mProgressDialog.setMessage("Getting schedule for "+selectedSport+"...");
        mProgressDialog.setCancelable(false);
        mProgressDialog.show();
    }

    @Override
    protected Void doInBackground(Void... params)
    {
        XmlPullFeedParser xpfp = new XmlPullFeedParser(scheduleURLtoGet);
        ArrayList<Event> allEvents = xpfp.getEvents();
        scheduleToPassAlong = allEvents.toArray(new Event[allEvents.size()]);           
        return null;
    }

    @Override
    protected void onPostExecute(Void res)
    {     
        mProgressDialog.dismiss();
        startScheduleActivity();
    }
}

private void startScheduleActivity(){
    Intent intent = new Intent(this, ScheduleBoard.class);
    intent.putExtra(SPORT_NAME_EXTRA, selectedSport);
    intent.putExtra(SCHEDULE_FOR_SPORT_EXTRA, scheduleToPassAlong);
    startActivity(intent);
} 
```

异常似乎发生在 ScheduleBoard 活动中，但 doInBackground 中的过程未完成。

这是堆栈，我仍然无法弄清楚发生了什么。我在 doInBackground 中有 try/catch，但没有触发任何内容：

```
 07-31 19:48:18.667: E/WindowManager(2866): Activity com.myproj.activities.ScheduleBoard has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@40557718 that was originally added here
07-31 19:48:18.667: E/WindowManager(2866): android.view.WindowLeaked: Activity com.myproj.activities.ScheduleBoard has leaked window com.android.internal.policy.impl.PhoneWindow$DecorView@40557718 that was originally added here
07-31 19:48:18.667: E/WindowManager(2866):  at android.view.ViewRoot.<init>(ViewRoot.java:263)
07-31 19:48:18.667: E/WindowManager(2866):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:171)
07-31 19:48:18.667: E/WindowManager(2866):  at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:114)
07-31 19:48:18.667: E/WindowManager(2866):  at android.view.Window$LocalWindowManager.addView(Window.java:424)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.Dialog.show(Dialog.java:241)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.AlertDialog$Builder.show(AlertDialog.java:810)
07-31 19:48:18.667: E/WindowManager(2866):  at com.myproj.activities.ScheduleBoard.displayNoStoriesMessageAndExit(ScheduleBoard.java:114)
07-31 19:48:18.667: E/WindowManager(2866):  at com.myproj.activities.ScheduleBoard.populateTable(ScheduleBoard.java:62)
07-31 19:48:18.667: E/WindowManager(2866):  at com.myproj.activities.ScheduleBoard.onCreate(ScheduleBoard.java:56)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
07-31 19:48:18.667: E/WindowManager(2866):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-31 19:48:18.667: E/WindowManager(2866):  at android.os.Looper.loop(Looper.java:130)
07-31 19:48:18.667: E/WindowManager(2866):  at android.app.ActivityThread.main(ActivityThread.java:3687)
07-31 19:48:18.667: E/WindowManager(2866):  at java.lang.reflect.Method.invokeNative(Native Method)
07-31 19:48:18.667: E/WindowManager(2866):  at java.lang.reflect.Method.invoke(Method.java:507)
07-31 19:48:18.667: E/WindowManager(2866):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
07-31 19:48:18.667: E/WindowManager(2866):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
07-31 19:48:18.667: E/WindowManager(2866):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T23:55:18.953

发生这种情况是因为您的活动被破坏并且 ProgressDialog 泄漏。您可以通过在显示进度时按电源按钮或将屏幕旋转 90 度来复制它。

你需要对进度对话框做的是解除它们`onPause`并恢复`onResume`在我的实践中，跟踪这类东西可能会变得非常复杂。当我`AsyncTask`从我开始时，我会在完成时`Activity`上钩并脱钩。应用程序对象存储有关哪些 Activity 正在运行哪些任务的信息，并且当您单击主页并返回应用程序时可以恢复进度对话框。`AsyncTask``Application`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T06:38:06.710

见下面的代码

```
private class ProgressTask extends AsyncTask<String, Void, Boolean> {

private ProgressDialog dialog = new ProgressDialog(HomeActivity.this);

protected void onPreExecute() {
    this.dialog.setMessage("Please wait");
    this.dialog.show();
}

protected Boolean doInBackground(final String... args) {
    try {
        Utilities.arrayRSS = objRSSFeed
                .FetchRSSFeeds(Constants.Feed_URL);
        return true;
    } catch (Exception e) {
        Log.e("tag", "error", e);
        return false;
    }
}

@Override
protected void onPostExecute(final Boolean success) {

    if (dialog.isShowing()) {
        dialog.dismiss();
    }
        // display UI
        UpdateDisplay();
}
} 
```

# iphone - popToRootViewControllerAnimated 不适用于标签栏

> ID：11731505
> 
> 赞同：0
> 
> 时间：2012-07-31T00:23:15.057
> 
> 标签：iphone, objective-c, ios, xcode, uiviewcontroller

我对 popToRootViewControllerAnimated 有这个问题，我找不到解决方案，甚至在本网站的所有问题中都找不到。

基本上，我有一个主标签栏，每个标签中都有一个 UIViewController。在其中一个选项卡上，我有一个按钮可以移动到下一个屏幕（比如 B）。在 B 视图控制器中，我有另一个按钮可以转到下一个视图控制器，比如 C。我想要完成的是单击一下从 C 返回到 A。那是我的代码：

为了从 A 到 B，我这样做：

```
ExerciseNextScreen *exerciseNextScreen = [[ExerciseNextScreen alloc] initWithNibName:nil bundle:nil];
[self presentModalViewController:exerciseNextScreen animated:YES]; 
```

然后从 B 到 C，我这样做：

```
 ScreenOneExercise *screenOneExercise = [[ScreenOneExercise alloc] initWithNibName:nil bundle:nil];
UINavigationController *screenOneExerciseNav = [[UINavigationController alloc]initWithRootViewController:screenOneExercise];
[self presentModalViewController:screenOneExerciseNav animated:YES]; 
```

现在，在 C 中，我在尝试返回 A 时这样做：

```
- (IBAction)cancelView:(id)sender
{
[self.navigationController popToRootViewControllerAnimated:YES];
} 
```

当进入 cancelView 方法时，什么也没有发生。我在这个电话之前检查了 self.navigationController，它不是零。

有什么想法可以返回 A 视图控制器吗？我在这个论坛上尝试了所有方法，但无济于事。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:35:28.030

该方法`popToRootViewControllerAnimated`不适用于模态视图。您需要首先调用该方法`dismissModalViewControllerAnimated:`以关闭所有模式视图。我想您需要调用控制器 A 上的方法来一次关闭所有模式视图。

干杯，安卡

# php - 按列对 CSV 输入进行分组

> ID：11731508
> 
> 赞同：0
> 
> 时间：2012-07-31T00:23:46.240
> 
> 标签：php, csv, multidimensional-array

我是Sharam，目前在欧洲的交换生，来自一个处理与东南亚青年有关的政治和问题的课后俱乐部。在我们的小组中，我们每个月在世界各地都有新的志愿者，我们设置了中央服务器来对俱乐部必须在未来执行的任务进行分类和优先排序，以便在我们的国家具有意义。我对PHP知之甚少，但是我很想学习，这是我的问题...

因为 SQL 太复杂了，所以我们使用 CSV。每个人都可以编辑主 CSV 并向其中添加任务，如下所示：

```
Priority,Task,Person
High,Campus flyers,Ashley
High,Test videocall with teacher,Sharam
Low,New Website,Martin & Aneet
Medium,Auditorium recruiting,Martin & Aneet & Ashley
Low,Garbage collecting,Sharam & Ashley
High,Ask permission to reserve classroom Sat & Sun,Sharam 
```

如您所见，项目的优先级是高、中、低任意顺序。我试过 array_merge_recursive() 但也许我做错了：

```
<?php

$file = @fopen("tasks-list.csv", "r") or exit("error, check server status");

$array = array();
$header = fgetcsv($file, 1000, ","); //don't need header in array

while (!feof($file)) {
  $data = fgetcsv($file, 1000, ",");
  if (!empty($data)) {
    $array = array_merge_recursive($array, array($data[0] => $data[1], $data[2]));
  }
}
fclose($file);
?> 
```

结果混淆了，我想念如何使 CSV 输入按列分组，如下所示：

```
High priority tasks:
1\. Campus flyers (Ashley)
2\. Test videocall with teacher (Sharam)
3\. Ask permission to reserve classroom Sat & Sun (Sharam)

Medium priority tasks:
1\. Auditorium recruiting (Martin & Aneet & Ashley)

Low priority tasks:
1\. New Website (Martin & Aneet)
2\. Garbage collecting (Sharam & Ashley) 
```

我的代码缺少演示部分，但这不是困难的部分。HTML 对我来说很容易，但我对正确分组的数组有疑问。我怎样才能实现它？谢谢

对不起我的语法和拼写，我刚学英语二年级！--莎拉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:40:56.763

查看我的 PHP 类： http: [//pastebin.com/KVcYxuXY](http://pastebin.com/KVcYxuXY)

这是它的使用方式

```
<?php 
require_once('CSV_parser.php');
// path to your csv file
$parser = new CSV_parser('c:/sample.csv');
// Result an array
$parser->toArray();
// To table
$parser->toTable();
// To JSON
$parser->toJSON();
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:29:47.307

构建一个以最左边的列作为索引的数组，该数组中的每个条目都是该行中的其余数据。

```
$result = array();
while (!feof($file)) {
  $data = fgetcsv($file, 1000, ",");
  $key = array_shift( $data);
  if( !isset( $result[ $key ])) {
    $result[ $key ] = array();
  }
  $result[ $key ][] = $data;
} 
```

现在，要将其打印出来，您所要做的就是：

```
foreach( $result as $priority => $entries) {
  echo $priority . ' priority tasks' . "\n";
  foreach( $entries as $i => $entry) {
      echo "$i. {$entry[0]} ({$entry[1]})\n";
  }
  echo "\n";
} 
```

# mysql - 带有 5 个表的 mySQL INNER JOIN

> ID：11731515
> 
> 赞同：2
> 
> 时间：2012-07-31T00:25:38.733
> 
> 标签：mysql, sql

我有 5 张桌子：

```
Stage:           ID, stage_name, stage_points, stage_number
Shooter:         ID, sh_uid, sh_al, sh_cat 
Stage_Shooters:  ID, StageID, ShooterID  
Score:           ID, miss, proc, bth, finalTime, shtr
Stage_Scores:    ID, StageID, ScoreID 
```

Stage_Shooters 和 Stage_Scores 是声明表的 many_many 关系。例如，射手通过 Stage_Shooters 连接到舞台。

我正在尝试检索每个阶段的所有射手分数。目前我有 5 个阶段和 28 名射手，因此获得了 140 分。我希望它最终看起来像这样：

```
--------------------------------------------------------------------------------
| Shooter              | Stage Name                | Stage Name                |
--------------------------------------------------------------------------------
| Alias       | Cat    | Raw   | M | P | B | Fin   | Raw   | M | P | B | Fin   |
--------------------------------------------------------------------------------
| Short Round | Junior | 24.00 | 0 | 0 | 1 | 19.00 | 7.00  | 0 | 0 | 1 | 6.00  |
--------------------------------------------------------------------------------
| Indy Jones  | Senior | 24.00 | 0 | 1 | 1 | 22.00 | 4.00  | 0 | 1 | 1 | 12.00 |
-------------------------------------------------------------------------------- 
```

为此，我认为我必须做一个数据透视表，但现在我只是想得到以下结果：

```
-----------------------------------------------------------------------
Stage Name | Shooter Alias | Shooter Category | Raw | M | P | B | Fin |
-----------------------------------------------------------------------
Stage Name | Shooter Alias | Shooter Category | Raw | M | P | B | Fin |
----------------------------------------------------------------------- 
```

当我运行以下 sql 时，我得到 700 个结果而不是 140 个（如预期的那样）

```
SELECT ssh.stage_name, ssh.sh_al, ssh.sh_cat, ssc.time, ssc.M, ssc.P, ssc.B, ssc.Fin
FROM (
    SELECT s.stage_name, sh.sh_al, sh.sh_uid, sh.sh_cat
    FROM Shooter sh
    INNER JOIN Stage_Shooters stsh ON stsh.ShooterID = sh.ID
    INNER JOIN Stage s ON s.ID = stsh.StageID
) ssh
INNER JOIN (
    SELECT s.stage_name stageName, sc.time, sc.shtr, sc.miss M, sc.proc P, sc.bth B, sc.finalTime Fin
    FROM Score sc
    INNER JOIN Stage_Scores stsc ON stsc.ScoreID = sc.ID
    INNER JOIN Stage s ON s.ID = stsc.StageID
) ssc
WHERE ssh.sh_uid = ssc.shtr
ORDER BY ssh.sh_al 
```

如果我删除 WHERE 语句，我会得到 19600 个结果。
如何使用联接或子查询来获得我需要的 140 行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T01:08:41.187

我有 3 条建议：

## 1-您没有加入相应阶段的数据

如果您添加到查询`AND ssh.stage_name = ssc.stage_name`中，只要您没有多个具有相同名称的阶段，它就应该可以工作。否则，您应该在两个子查询中添加阶段的 ID，并将条件添加到使用这些 ID 而不是阶段名称的位置。

## 2-您缺少子查询之间的连接条件

您需要添加`WHERE`条件或获得 20K 结果的原因是因为没有`ON`INNER JOIN。也就是说你可以把你添加的所有东西放在 WHERE 上`ON`。

像这样的东西：

```
SELECT ssh.stage_name, ssh.sh_al, ssh.sh_cat, ssc.time, ssc.M, ssc.P, ssc.B, ssc.Fin
FROM (
    SELECT s.ID stageID, s.stage_name, sh.sh_al, sh.sh_uid, sh.sh_cat
    FROM Shooter sh
    INNER JOIN Stage_Shooters stsh ON stsh.ShooterID = sh.ID
    INNER JOIN Stage s ON s.ID = stsh.StageID
) ssh
INNER JOIN (
    SELECT s.ID stageID, s.stage_name stageName, sc.time, sc.shtr, sc.miss M, sc.proc P, sc.bth B, sc.finalTime Fin
    FROM Score sc
    INNER JOIN Stage_Scores stsc ON stsc.ScoreID = sc.ID
    INNER JOIN Stage s ON s.ID = stsc.StageID
) ssc
ON ssh.sh_uid = ssc.shtr AND ssh.stageID = ssc.stageID; 
```

## 3-你可以用一个查询来完成整个事情

看起来您可以获得与以下（较短）查询相同的结果：

```
SELECT
    stage_name,
    sh_al,
    sh_cat,
    time,
    miss AS M,
    proc AS p,
    bth AS b,
    finalTime AS Fin
FROM
    Shooter AS sh
    JOIN Stage_Shooters AS stsh ON stsh.ShooterID = sh.ID
    JOIN Stage AS s ON s.ID = stsh.StageID
    JOIN Stage_Scores AS stsc ON stsc.StageID = s.ID
    JOIN Score AS sc ON stsc.ScoreID = sc.ID AND sc.shtr = sh.ID 
```

如果没有 SQL Fiddle，实际验证这一点很复杂，但我非常有信心它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:47:33.317

Stage_Scores 是否应该使用 Stage_ShootersID 而不是 StageID？

看起来您希望能够将分数链接到特定的射手，但您的桌面设计不允许您这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:53:46.713

只是通过查看，我发现两组查询都连接到了阶段表。我猜你可能需要在两个集合中选择舞台 ID，然后在舞台 ID 以及射手 ID 上加入 ssh 和 ssc

```
SELECT ssh.stage_name, ssh.sh_al, ssh.sh_cat, ssc.time, ssc.M, ssc.P, ssc.B, ssc.Fin, s.ID as stageID
FROM (
    SELECT s.stage_name, sh.sh_al, sh.sh_uid, sh.sh_cat
    FROM Shooter sh
    INNER JOIN Stage_Shooters stsh ON stsh.ShooterID = sh.ID
    INNER JOIN Stage s ON s.ID = stsh.StageID
) ssh
INNER JOIN (
    SELECT s.stage_name stageName, sc.time, sc.shtr, sc.miss M, sc.proc P, sc.bth B, sc.finalTime Fin, s.ID as stageID
    FROM Score sc
    INNER JOIN Stage_Scores stsc ON stsc.ScoreID = sc.ID
    INNER JOIN Stage s ON s.ID = stsc.StageID
) ssc
WHERE ssh.sh_uid = ssc.shtr
AND ssh.stageID = ssc.stageID
ORDER BY ssh.sh_al 
```

# android-widget - android-wheel - Kankan's android picker view doesn't work correctly when attached to my project

> ID：11731516
> 
> 赞同：0
> 
> 时间：2012-07-31T00:25:48.890
> 
> 标签：android-widget, android-preferences, android-custom-view, android-dialog

I have downloaded kankan's wheel widget as an *.apk from here [http://code.google.com/p/android-wheel/downloads/list](http://code.google.com/p/android-wheel/downloads/list) and then converted it into *.jar file. I have attached this jar as a library to my project. Everything works fine. I can import all the classes from the library and use them in my project. However when I create the wheel object in my activity it works correctly but doesn't display correct background of the wheel. Instead it does show some random drawables from my project. What I'm doing wrong? where should I look to solve this problem? Here is my xml layout and DialogPreference class. Please help!!! Thanks.

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="12dp"
    android:background="@drawable/layout_bg" >

    <kankan.wheel.widget.WheelView
android:id="@+id/number"
android:layout_height="wrap_content"
android:layout_width="140dp" />
</LinearLayout> 
```

**NumberPickerPreference.java**

```
import kankan.wheel.widget.OnWheelChangedListener;
import kankan.wheel.widget.WheelView;
import kankan.wheel.widget.adapters.NumericWheelAdapter;
import android.content.Context;
import android.preference.DialogPreference;
import android.util.AttributeSet;
import android.view.View;

public class NumberPickerPreference extends DialogPreference {

public NumberPickerPreference(Context context, AttributeSet attrs) {
    super(context, attrs);
    setDialogLayoutResource(R.layout.number_picker_layout);
}

@Override
    protected View onCreateDialogView() {
 view view = super.onCreateDialogView();

return view;
}

@Override
protected void onBindDialogView(View view) {
    super.onBindDialogView(view);

    WheelView numberPicker = (WheelView)view.findViewById(R.id.number);
    numberPicker.setViewAdapter(new NumericWheelAdapter(getContext(), 0, 99, "%02d"));
    numberPicker.setCyclic(true);
    numberPicker.setCurrentItem(17);
}

/**
 * Adds changing listener for wheel that updates the wheel label
 * @param wheel the wheel
 * @param label the wheel label
 */
private void addChangingListener(final WheelView wheel, final String label) {
    wheel.addChangingListener(new OnWheelChangedListener() {
        public void onChanged(WheelView wheel, int oldValue, int newValue) {
            //wheel.setLabel(newValue != 1 ? label + "s" : label);
        }
    });
}
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T15:56:55.997

I figure it out. It seems I got some library conflict problem. I fixed it by removing from Java Build Path in the library project android-support-v4.jar library file.

# c# - 高清鼠标事件的高精度计时

> ID：11731524
> 
> 赞同：1
> 
> 时间：2012-07-31T00:26:48.687
> 
> 标签：c#, windows, mouseevent, stopwatch, raw-input

我正在使用 Windows 中的高清鼠标 (logitech g500)，我想为此获取原始鼠标事件的低延迟时间戳。我使用时间戳来计算鼠标移动之间的“暂停”，所以重要的是时间戳的相对精度。

我正在使用 RAW INPUT API 来监视鼠标事件。消息中不包含计时信息，因此我在 Windows 中使用了秒表。触发事件处理程序时获取“时间戳”的诊断——即鼠标事件处理程序中的第一个操作是读取秒表以了解已流逝的滴答声。

由于在这种情况下我没有任何基本事实可以使用，是否有人看到这种方法直接和明显的陷阱？或者更好的是，如果您在对延迟及其在秒表的不同读取方面的可变性发表任何评论之前使用过秒表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:30:56.520

如果可用，该类`Stopwatch`在您的 CPU 上使用高性能计时器，因此它是您将获得的最高分辨率计时器。

`IsHighPrecision`您可以使用该属性检查以确保您具有高精度实例。

# ruby - twitterbootstrap：初学者的布局帮助

> ID：11731526
> 
> 赞同：-3
> 
> 时间：2012-07-31T00:27:03.633
> 
> 标签：ruby, ruby-on-rails-3, user-interface, twitter-bootstrap, twitter-bootstrap-rails

如何使用 twitter-bootstrap 为后续页面设计布局

![在此处输入图像描述](../Images/4e41e013bc3214cc20be91616668b1c9.png)

我是新手，并且通过设计一个实时应用程序来努力学习它。这是您在 www.dropbox.com 上登录后获得的页面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T03:55:43.657

我认为本系列[教程](http://webdesign.tutsplus.com/tutorials/complete-websites/twitter-bootstrap-101-introduction/)将为您提供如何使用 bootstrap 的良好开端。

如果您使用的是 RoR，Michaek Hartl 的[Ruby on Rails 教程](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial)是一本非常好的关于 RoR 的书，他在示例中使用了引导程序。因此，本教程还应该让您了解如何将引导程序与 RoR 一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:47:40.877

为什么不从 Bootstrap 示例模板之一开始呢？[例如，这一个](http://twitter.github.com/bootstrap/examples/fluid.html)的侧边栏布局与您正在寻找的类似。您需要做的就是将`<div class="span9">`包含英雄单元和标题部分的内容删除，并用您自己的内容填充它。

当然，还要通读文档并编写一些一次性网页以帮助学习过程。

# python - 将元素附加到列表字典中的最小列表

> ID：11731534
> 
> 赞同：0
> 
> 时间：2012-07-31T00:28:00.817
> 
> 标签：python, list, dictionary

我有一个列表字典，我想为其添加一个值到特定列表...

```
d = {'a': [4, 2], 'b': [3, 4], 'c': [4, 3], 'd': [4, 3], 'e': [4], 'f': [4], 'g': [4]} 
```

我想将数字 2 添加到长度最小的列表中。

```
def gsl(x):
    return [k for k in x.keys() if len(x.get(k))==min([len(n) for n in x.values()])] 
```

打电话后

```
>>> gsl(d)
['e', 'g', 'f'] 
```

所以在这种情况下，我想将数字 2 附加到`'e'`字典中的列表中`[4,2]`（顺序无关紧要。

结果应该是

```
>>> d['e']
[4,2] 
```

我试过了

```
for i in d:
    if gsl(d)[0] == i: #gets the first key with the smallest value 
        d[i].append(2) # if equal, adds 2 to the dictionary value that matches 
```

除了添加`2`到每个`'e'`, `'g'`, `'f'`.

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T00:32:08.810

```
>>> d = {'a': [4, 2], 'b': [3, 4], 'c': [4, 3], 'd': [4, 3], 'e': [4], 'f': [4], 'g': [4]}
>>> smallest = min(d, key=lambda k: len(d[k]))
>>> d[smallest].append(2)
>>> d
{'a': [4, 2], 'c': [4, 3], 'b': [3, 4], 'e': [4, 2], 'd': [4, 3], 'g': [4], 'f': [4]} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:31:00.293

怎么样：

```
d[gsl(d)[0]].append(2) 
```

`gsl(d)`获取具有最小长度的键列表，`0`获取第一个，然后我们获取该键的列表并附`2`加到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:36:15.470

你的答案的问题是，在'e'中插入元素后，它不再是“具有最小长度列表的键”的一部分，所以在下一次迭代中它将返回['f'，'g']。

一个快速的解决方法是打破循环，如下所示：

```
for i in d:
    if gsl(d)[0] == i:
        d[i].append(2)
        break 
```

但这是一种非常低效的方法，如果 d 为空，则会失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T04:56:24.313

如果您使用的是 python 2.7 或更高版本，则可以为此使用[视图：](http://docs.python.org/library/stdtypes.html#dictionary-view-objects)

```
>>> d = {'a': [4, 2], 'b': [3, 4], 'c': [4, 3], 'd': [4, 3], 'e': [4], 'f': [4], 'g': [4]}
>>> min(d.viewitems(), key=lambda (k, v): len(v))[1].append(2)
>>> d
{'a': [4, 2], 'c': [4, 3], 'b': [3, 4], 'e': [4, 2], 'd': [4, 3], 'g': [4], 'f': [4]} 
```

如果您使用的是旧版本，则可以使用[iteritems](http://docs.python.org/library/stdtypes.html#dict.iteritems)：

```
>>> d = {'a': [4, 2], 'b': [3, 4], 'c': [4, 3], 'd': [4, 3], 'e': [4], 'f': [4], 'g': [4]}
>>> min(d.iteritems(), key=lambda (k, v): len(v))[1].append(2)
>>> d
{'a': [4, 2], 'c': [4, 3], 'b': [3, 4], 'e': [4, 2], 'd': [4, 3], 'g': [4], 'f': [4]} 
```

# regex - 使用正则表达式查找幻数

> ID：11731536
> 
> 赞同：0
> 
> 时间：2012-07-31T00:28:29.257
> 
> 标签：regex, lua, syntax-highlighting, magic-numbers

我正在使用语法突出显示控件，并且必须使用正则表达式指定所有突出显示的内容。我已经完成了其他所有内容（关键字、函数、字符串、注释等），但我无法为幻数提出一个好的规则。如果有帮助的话，我会将它用于 Lua 文本编辑器。

我目前正在`\d+`用来检测数字，但问题是我最终得到了这样的结果：

![在此处输入图像描述](../Images/cb5adc2d60938d58bbfda556622499da.png)

如您所见，我的变量名称也突出显示了其中的一部分。

有没有人知道使这个特定规则正常工作的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T00:36:13.613

您不希望它在名称中匹配，因此添加一个单词边界：`\b\d+\b`。

对于浮点数，可能有一个小数部分：`\b\d+(?:\.\d+)?\b`.

对于浮点数，也可能有一个指数：`\b\d+(?:\.\d+)?(?:[Ee][+\-]?\d+)\b`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T03:50:56.150

我会说在正则表达式方面保持简单（即只写你需要的，而不是更多）。以下将第 2 组匹配到正在分配的浮点数和整数：

```
(=\s*)([\d|\.]+)(\s*;) 
```

*   第 1 组：上下文在 '=' 符号之后开始，考虑任何额外的空白（\s*）。
*   第 2 组：将匹配 1 个或多个数字（\d）或句点（.）。
*   第 3 组：上下文以 ';' 结尾，说明它之前的任何额外空白（\s*）。

希望有帮助。

# javascript - 缺少元素中断脚本 (getElementById)

> ID：11731537
> 
> 赞同：0
> 
> 时间：2012-07-31T00:28:39.623
> 
> 标签：javascript

如果 ID 不存在，则脚本会中断。为什么？

如何查看 the_lis？

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>test</title>
</head>
<body>
<script>
window.onload = function(){
alert('this will alert');
var the_id = document.getElementById('a_id_that_does_not_exist'),
the_lis = the_id.getElementsByTagName('li');
alert('this will NOT alert');
}
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:31:33.830

由于第一个元素不存在`the_id`将`null`. 调用该方法`getElementsByTagName`会`null`导致错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:31:00.517

`the_id`您确实应该首先使用语句检查是否存在`if`，否则将引发异常。

```
window.onload = function(){
alert('this will alert');
var the_id = document.getElementById('a_id_that_does_not_exist');
if (the_id != undefined)
    the_lis = the_id.getElementsByTagName('li');
alert('this will NOT alert');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T00:31:25.207

`the_id`为空，并且`null`没有`getElementsByTagName`方法。呃。

在编写代码之前确保 ID 存在，或者通过以下方式明确检查它：

```
var the_lis = the_id ? the_id.getElementsByTagName('li') : []; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T00:36:37.630

据我了解， getElementsByTagName 返回一个数组。但是在此之前， the_id 应该为 null 或未定义，因为它不存在，因此您尝试在 null 实例上调用 getElementsByTagName。

我建议（除非不适用）使用 jquery 来做任何你想做的事情，并使用 firebug 来调试你的 JavaScript

# java - 如何将尺寸传递给 Swing JPanel 创建者类？

> ID：11731541
> 
> 赞同：1
> 
> 时间：2012-07-31T00:29:15.597
> 
> 标签：java, swing, jpanel, dimensions

我正在尝试将维度传递给 Java Swing JPanel 创建者类。到目前为止没有运气。我什至把它`contentPane.setPreferredSize(new Dimension(intWidth, intHeight));`放在一个 try/catch 块中，但我没有得到任何系统输出。我传递了一个相当大的价值，`frame.setContentPane(ContentPaneCreator.createContentPane("darkseagreen", 800, 255));`但应用程序仍然和它周围的组件一样小。可以做些什么来修复它？谢谢。

```
import java.awt.Container;
import java.awt.Dimension;
import javax.swing.JPanel;

public final class ContentPaneCreator {

    public static Container createContentPane(String color, int intWidth, int intHeight) {

        JPanel contentPane = new JPanel();
        // Pass the colour
        contentPane.setBackground(ColorFactory.getInstance().getColor(color));
        // Pass the dimensions
        try {
        contentPane.setPreferredSize(new Dimension(intWidth, intHeight));
        }
        catch (Exception ex) {
            System.out.println(ex);
        }
        return contentPane;
    }
} 
```

便利贴（）

```
import java.awt.BorderLayout;
import java.awt.FlowLayout;

import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;

public class StickyNotes extends JFrame {

    private static final long serialVersionUID = 1L;

    public static String appName;
    public static String fileConfirmSave;
    public static String txtConfirmChange;

    private void createStickyNotesGUI() {

        ConfigProperties config = new ConfigProperties();
        // ConfigProperties config2 = new ConfigProperties().getFileIn();

        appName = config.getConfigProperties("appName").toUpperCase();
        fileConfirmSave = config.getConfigProperties("fileConfirmSave");
        txtConfirmChange = config.getConfigProperties("txtConfirmChange");

        // Create and set up the window.
        JFrame frame = new JFrame();
        frame.setTitle(appName);

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new FlowLayout(FlowLayout.LEFT));
        /* BEGIN ROOT Pane: */

        /* BEGIN Layered Pane: */
        // Add Main Menu
        MainMenuBar mainMenu = new MainMenuBar();
        frame.setJMenuBar(mainMenu.createMainMenuBar(frame));

        /* BEGIN CONTENT Pane(s): */

        // Add JPanel Content // can I pass a layout object?
        frame.setContentPane(ContentPaneCreator.createContentPane("darkseagreen", 800, 255));

        // Add Tool Bar /* needs to be run AFTER we .setContentPane() in order for it to be layerd on top */
        ToolBarCreator toolBar = new ToolBarCreator();
        frame.getContentPane().add(toolBar.createToolBar(), BorderLayout.NORTH);

        // TODO
        /*
         * Pass dynamic color values to LabelCreator() once you get
         * newStickyNote() working
         */
        frame.getContentPane().add(
                LabelCreator.createLabel(frame, "Java Swing", "purple"),
                BorderLayout.NORTH);

        // Display the window here with JFrame//
        //frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
        // TODO
        /* set configuration to remember frame size */
        frame.pack();
        frame.setVisible(true);
    }

    public void doExit(JFrame frame) {
        boolean fDirty = true;
        if (fDirty)
            switch (JOptionPane.showConfirmDialog(StickyNotes.this,
                    fileConfirmSave, txtConfirmChange,
                    JOptionPane.YES_NO_OPTION)) {
            case JOptionPane.YES_OPTION:
                // if (doSave())
                frame.dispose();
                break;
            case JOptionPane.NO_OPTION:
                frame.dispose();
            }
        else
            frame.dispose();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new StickyNotes().createStickyNotesGUI();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:30:19.043

尝试：

```
contentPane.setSize(intWidth, intHeight); 
```

我很确定以上内容就足够了，但您也可以尝试：

```
contentPane.setPreferredSize(new Dimension(intWidth, intHeight));
contentPane.setMinimumSize(new Dimension(intWidth, intHeight));
contentPane.setMaximumSize(new Dimension(intWidth, intHeight)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T16:16:22.473

您的代码中存在一些问题：

首先，如果使用`frame.setLayout(new FlowLayout(FlowLayout.LEFT));`（**FlowLayout**）那么`frame.getContentPane().add(toolBar.createToolBar(), BorderLayout.NORTH);`你为什么要指定`BorderLayout.NORTH`哪个没有**效果**

再次与`frame.getContentPane().add(LabelCreator.createLabel(frame, "Java Swing", "purple"),BorderLayout.NORTH);`

编辑：
对于您的`contentpane`问题，首先查看以下代码（演示）：

```
JFrame frame= new JFrame();
frame.getContentPane().setBackground(Color.red);
frame.getContentPane().setPreferredSize(new Dimension(width, height));
frame.pack();
frame.setVisible(true); 
```

当您传递**不同**的值时`width`，`height`您会看到**整个大小**都会受到影响，`frame`因为我没有`setSize`在任何地方指定，原因是

1.  要出现在屏幕上，每个 GUI 组件都必须是包含层次结构的一部分。包含层次结构是一棵以顶级容器为根的组件树。我们稍后会向您展示一个。

2.  每个 GUI 组件只能包含一次。如果一个组件已经在一个容器中，并且您尝试将其添加到另一个容器中，则该组件将从第一个容器中删除，然后添加到第二个容器中。

3.  每个顶级容器都有一个**内容窗格**，一般来说，它包含（直接或间接）该顶级容器的 GUI 中的可见组件。

4.  您可以选择将菜单栏添加到顶级容器。按照惯例，菜单栏位于顶级容器内，但位于内容窗格之外。某些外观（例如 Mac OS 外观）使您可以选择将菜单栏放置在另一个更适合外观的位置，例如屏幕顶部。

所以**结论**是改变`contentpane`大小会改变`frame`大小。

由于您的**陈述** `frame.setContentPane(ContentPaneCreator.createContentPane("darkseagreen", 800, 255));`是`panel`as `contentpane`，所以再次**改变**它的大小就是改变`frame` **大小**

但反过来是：

```
frame.getContentPane().add(ContentPaneCreator.createContentPane("darkseagreen", 800, 255)); 
```

`add`一个`container`到`jframe`然后`add`你的**组件**到那个`container`（ jpanel 在你的情况下）

希望这会有所帮助，而且还有**一件事**我也曾经像您一样为每个**小目的**编写代码，但有时它们会提高**复杂性**`methods`而不是**简单性**，因此我对您的建议是**遵循您喜欢的设计模式**或任何其他您喜欢的设计模式。`classes`********`MVC`********

# sql-server - 检查约束中的括号问题

> ID：11731545
> 
> 赞同：3
> 
> 时间：2012-07-31T00:29:49.083
> 
> 标签：sql-server, check-constraints

我正在尝试创建以下检查约束。

```
(
   [Href] IS NOT NULL AND
   [ETag] IS NOT NULL AND
   [UserName] IS NOT NULL AND
   [Password] IS NOT NULL AND
   [UID] IS NOT NULL
)
OR
(
   [Href] IS NULL AND
   [ETag] IS NULL AND
   [UserName] IS NULL AND
   [Password] IS NULL AND
   [UID] IS NULL
) 
```

我可以保存它并且没有错误。但是 SSMS 删除了两个内括号（因此只有开头的左括号和结尾的右括号）。

这似乎完全改变了意思。我希望所有这些列都为空，或者它们都不为空。SQL Server 不能处理这个问题有什么原因吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T00:32:23.323

SSMS 是正确的。不需要括号。

`AND`具有比`OR`SQL 更高的优先级，因此带括号和不带括号的两个版本是等效的。

# ruby - 删除所有加载的定义和常量

> ID：11731546
> 
> 赞同：0
> 
> 时间：2012-07-31T00:29:57.627
> 
> 标签：ruby

我有一个 ruby​​ 脚本来获取`plugin1.rb`并加载它。然后我会打电话`run`并`plugin1`做它的事情。

之后，我可能决定加载`plugin2.rb`然后调用`run`，然后`plugin2`做它的事情。

这两个插件彼此无关，除了它`run`为我提供了一种实际执行它们的方法，但它们可以根据需要定义它们的类和常量。

没有理由不存在类冲突之类的，所以我认为最好的办法是在插件完成运行后进行清理。

我应该如何编写我的 ruby​​ 脚本，以便在它实际加载其中一个插件之前，它会正确清理上一个会话中的任何内容，以便为新脚本做好准备？

我想知道我需要删除哪些类型的东西，以及如何删除它们。

更新

环顾四周，我可以得到一个使用 定义的常量列表`Object.constants`，其中包括所有已加载的类和模块。

所以我在想一些事情

```
# get start-up constants
initial_consts = Object.constants

# load a plugin
load "plugin1.rb"

# get new constants
new_consts = Object.constants - initial_consts

# run plugin
test = NewClass.new #defined in plugin
test.run

# clean-up new things
new_consts.each {|c| Object.send(:remove_const, c) } 
```

这不会“还原”任何已更改的类，但我的设计阻止插件定义具有特定名称的类或方法，因此它不应该是一个太大的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T02:43:57.447

不不不。这*太可怕了*。对于初学者来说，今天尝试编写代码以明天接受*完整的狗屎代码是***错误的。**你可以编写更容易理解、有点聪明、可扩展的代码，但不要因为试图编写比下一个开发人员更聪明的代码而陷入困境。

 *现在请回到绘图板。忘记你所知道的关于“插件”是什么的一切，忘记你曾经了解过的关于 PHP 或 C 或其他动态性较低的语言的一切。你有什么需求？您如何以一种适用于今天并且可以在明天扩展的方式解决它们？这样做，而*不是更该死的事情*。您是要为所有类使用全局命名空间编写代码，还是要将它们封装在以库命名的模块中以防止这种情况发生？

您可以使用各种工具来锁定环境，例如 Clean Rooms，但我认为您甚至不需要这些工具。我认为你真的只需要放弃尝试为模棱两可的需求编写代码，并以处理每一种可能性的雄心勃勃的目标。*

# hash - 如何在 openLDAP 中打开密码散列 (SSHA)

> ID：11731547
> 
> 赞同：11
> 
> 时间：2012-07-31T00:30:01.387
> 
> 标签：hash, passwords, salt, openldap, ssha

对于我的一生，我似乎无法在任何地方找到这个，如果有人甚至可以给我一个链接，我将非常感激。

我们正在尝试在 openLDAP 中打开 SSHA 散列。默认情况下，它以明文形式存储密码，我认为这是犯罪行为，但嘿，我是一个广告人，所以我知道什么。但是您会认为，如果您愿意，他们会很容易找到打开散列所需的信息。你不会选择吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T19:58:59.840

你可以使用'password-hash'来改变散列算法，默认是SSHA（非明文）。

请注意，slapd 仅在客户端发送的密码是纯文本时才使用上述内容，如果您的客户端发送的是散列密码，它将按原样存储。

例如：使用 pam_ldap，使用 pam_password exop（或清除）

> > 如果密码以散列形式出现并且我知道这是 openLDAP 吹捧的一项功能，那么密码强度测试如何在服务器上运行？

如果您发送散列密码，slapd 无法执行强度测试，因此客户端必须以明文形式发送密码（ppolicy 可以选择接受/拒绝散列密码）。

笔记：

1.  确保您的客户使用 ssl/tls（因此密码不会以明文形式发送）
2.  userpassword 属性包含特殊字符 ({})，因此您必须执行 base64 -d 来识别所使用的散列算法。

例如：通常属性以以下格式返回（**::**表示结果是 base64 编码的）

```
userPassword:: e1NTSEF9QjU0VXNmQWhJN1dQZ3FvbDVSQ1l5RHUzTlVqa1luVVhYV2ljbmc9PQ=
 =

$ echo e1NTSEF9QjU0VXNmQWhJN1dQZ3FvbDVSQ1l5RHUzTlVqa1luVVhYV2ljbmc9PQ==|openssl base64 -d
{SSHA}B54UsfAhI7WPgqol5RCYyDu3NUjkYnUXXWicng== 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T04:17:45.127

LDAP 规范需要明文密码以实现互操作性。上面给出的关于安全性的链接将为您提供服务器可以强制执行的默认哈希类型的选项，但请考虑其含义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-26T07:33:57.377

当您尝试`userPassword`在添加/修改 LDAP 操作中存储属性时， `userPassword`值将存储为纯文本。但是您可以使用OpenLDAP`ppolicy_hash_cleartext`中覆盖模块中的选项 来覆盖此行为。`ppolicy`启用后，当客户端发送纯文本密码时，默认存储为`SSHA`默认密码。[您可以从此处](http://xacmlinfo.org/2015/06/25/enable-hash-passwords-in-openldap/)找到有关在 OpenLADP 中启用哈希密码的更多详细信息

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-10-30T13:13:55.933

这是一个老问题，但仍然相关。由于其相对容易的暴力破解，不再推荐使用 SSHA（即 SHA-1）。

更安全的散列算法是 SHA-512。使用 OpenSSL 1.1 可以在客户端生成更强的哈希，如下所示：

```
_generate_password_hash() {
  local plaintext; plaintext="$1"

  command printf "{CRYPT}%s" "$(openssl passwd -6 -stdin <<< "${plaintext}")"
} 
```

这将输出一个字符串，例如：

```
{CRYPT}$6$SGIWzAbjh.3WoQQJ$vEFlcRBQpd2fJ8dxcbojr83pjQcXcJ.InRMzNRryTQ//fMYJoCRFWAPn22EvJyDikG.MNuUqRYqQtI97Clj2F0 
```

注意开头的`{CRYPT}`而不是`{SSHA}`。

例如，您可以使用 ldapmodify 应用密码：

```
ldapmodify -h "${LDAP_HOST}" -D cn=user,dc=example,dc=com -W <<EOF
dn: cn=user,dc=example,dc=com
changetype: modify
replace: userPassword
userPassword: $(_generate_password_hash NEW_PASSWORD_HERE)
EOF 
```

请注意，LibreSSL 有一组不同的哈希算法可用。`openssl version`如果`openssl passwd --help`不显示该`-6`选项，请检查您的实际 OpenSSL 版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-31T00:37:04.230

OpenLDAP 支持多种存储方案供管理员选择。您用于创建帐户的工具必须配置为进行散列。服务器将以客户端请求的格式存储密码。如果哈希正确完成，ldapsearch 将显示哈希密码，如下所示：

```
userPassword: {SSHA}d0Q0626PSH9VUld7yWpR0k6BlpQmtczb 
```

有关详细信息，请参阅[http://www.openldap.org/doc/admin24/security.html](http://www.openldap.org/doc/admin24/security.html)。

说到管理工具，我个人推荐[http://phpldapadmin.sourceforge.net](http://phpldapadmin.sourceforge.net)

# ruby-on-rails-3 - 登录重定向后rails authlogic找不到current_user（未定义）

> ID：11731551
> 
> 赞同：1
> 
> 时间：2012-07-31T00:30:43.187
> 
> 标签：ruby-on-rails-3, authlogic

我有一个 Rails 应用程序，我在其中使用 authlogic 和 cancan 的组合。

当我`current_user`在应用程序中检查时，我总是得到`undefined variable or method 'current_user'`

如果我使用，我可以`current_user`从我的 UserSessions 控制器中显示

```
定义创建
   @user_session = UserSession.new(params[:user_session])

   如果@user_session.save
       返回渲染：json => current_user
   结尾
结尾

```

但是，如果在我的家庭控制器中，我尝试

```
定义索引
   返回渲染：json => current_user
结尾

```

我得到了`undefined`错误。

在我的应用程序助手中，我有

```
类 ApplicationController < ActionController::Base
  防止伪造

  helper_method :current_user

  私人的

  def current_user_session
    如果定义返回@current_user_session？(@current_user_session)
    @current_user_session = UserSession.find
  结尾

  定义当前用户
    如果定义返回@current_user？(@current_user)
    @current_user = current_user_session && current_user_session.record
  结尾
结尾

```

所以在我看来会话正在创建中，但 rails 无法再次找到它。任何人都可以解释为什么会这样吗？

我已经阅读了 Ryan Bates 教程和其他一些教程，但对我来说似乎都一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T00:29:06.193

并不是这个问题的真正答案，但我最终剥离了 authlogic 并开始设计。与我在 authlogic 中尝试调试问题所花费的所有时间相比，进行更改要快得多。

# web-services - 如何检索当前登录的用户名？

> ID：11731552
> 
> 赞同：1
> 
> 时间：2012-07-31T00:30:42.930
> 
> 标签：web-services, jakarta-ee, glassfish, jax-ws, java-metro-framework

我有一个在 glassfish 3.1.2 上运行的用户名身份验证的 jax-ws/metro 2.2 Web 服务。如何获取实际登录用户的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:36:54.253

您可以通过`WebServiceContext`'s获取用户登录时使用的名称`getUserPrincipal().getName()`

看到[这个](https://stackoverflow.com/questions/3310165/calling-getuserprincipal-in-a-web-service-returns-anonymous)潜在的陷阱。

至于获取任何其他登录用户的姓名，您必须在您的网络应用程序中使用一些公共商店（应用程序级别？db？）自己解决一些问题 - 这将违反 Java EE 没有的安全策略将支持开箱即用。

# javascript - Chrome 开发者工具未捕获 AJAX 请求

> ID：11731563
> 
> 赞同：4
> 
> 时间：2012-07-31T00:31:48.957
> 
> 标签：javascript, jquery, ajax, backbone.js

在 Facebook 的个人资料页面上观察`Network`Chrome 的开发者工具选项卡时，我注意到几乎没有捕获任何 XHR 请求。在个人资料页面周围单击，例如单击链接以查看个人资料的照片，表明没有发出任何 AJAX 请求，但该站点似乎像单页应用程序一样保持在同一页面上，并且行为非常类似于 AJAX。

Facebook 个人资料页面真的像 jQuery 那样使用 AJAX 请求`$.get()`吗？如果是这样，为什么它们不出现在开发人员工具中。如果没有，我怎样才能达到同样的效果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-09-05T15:14:18.190

过去我自己也被这个咬过。查看网络选项卡时，您可以过滤掉您希望开发人员工具显示的请求类型。默认选择“全部”。但是，如果您不小心点击了“JS”、“CSS”等，则只会显示这些请求。

单击“全部”，您的问题将得到解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T12:30:20.100

*   当然，您可以捕获 JSONP 请求。JSON-P 只不过是普通的 JSON 数据，但包装在 JavaScript 函数中。响应将如下所示：

    jQuery17206302290489639558_1343824008197([{"

*   它可能没有出现在 Chrome 开发者工具中可能是由于使用了 HTTPS 造成的。

顺便说一句，如果您有兴趣或者目前正在探索如何与 Facebook API 交互，那里有很多（免费）和在线工具。Apigee 的 Facebook 控制台非常好：[https ://apigee.com/console/facebook](https://apigee.com/console/facebook)

# android - 如何设置Gridview的文本颜色

> ID：11731567
> 
> 赞同：1
> 
> 时间：2012-07-31T00:32:10.017
> 
> 标签：android, gridview, colors

我可以更改背景颜色，但如何更改 Gridview 内容的文本颜色？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T00:37:29.403

GridView 只是一个布局控件。您想要更改放入 GridView 中的组件的颜色 - 可能是 TextView。试试 TextView.setTextColor()。

# xml - 通过扩展/继承一组具有附加属性的共享 XML 类型来最小化耦合

> ID：11731574
> 
> 赞同：1
> 
> 时间：2012-07-31T00:33:10.017
> 
> 标签：xml, oop, inheritance, xsd, encapsulation

我想解耦两个共享一组 XML 类型的开发团队的关注点。共享类型在共享 XSD 中定义。但是，第二个团队需要在共享 XML 类型中的大多数字段上添加一组额外的属性，这些属性只与他们的一组需求相关。目前，这些专有属性嵌入在共享 XSD 的大部分字段中。

我想将这些属性隔离为一组扩展共享 XML 类型的 XML 类型，就像您在简单的 OO 语言中所做的那样。Ayesha Malik 有一些想法让我开始使用[在面向对象框架中构建 XML 模式的技术](http://www.ibm.com/developerworks/library/x-flexschema/#ibm-pcon)

感谢[添加属性...添加方面](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGIQFjAA&url=http%3A%2F%2Fstackoverflow.com%2Fquestions%2F626319%2Fadd-attributes-to-a-simpletype-or-restrictrion-to-a-complextype-in-xml-schema&ei=4x0XUPS8Aufr6wHU3IBA&usg=AFQjCNHk51FSNu5Ilb1uWMFyuLBdylOEDA)，我能够将属性添加到各个字段的 complexTypes。但是，当我尝试覆盖其中一种复杂的共享类型中的子元素的类型时，Eclipse 中的验证会抱怨说

> 粒子类型不是对基础粒子的有效限制。

如果我将各个子元素类型保持不变，则验证效果很好。但是如果我将它们的类型更改为新的派生类型，验证将失败。这是令人沮丧的，因为各个子元素的类型与父类型不同的事实是练习的重点。我想为父类型中的每个字段/子元素添加一组属性，但我没有看到任何方法。

我隔离了一个示例，该示例演示了您可以使用 simpleContent 将属性添加到 simpleType 和 complextType。但我无法使用 complextContent 将属性添加到派生的 complexType。例如，在下面的 complexType“SearchPamphlet”中，我尝试同时使用 <xs:extension> 和 <xs:restriction>。我还尝试将“基础”设置为“书”和“小册子”。所有这些方法都会产生相同的错误。有没有人有什么建议？

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified" attributeFormDefault="unqualified">

    <xs:complexType name="Book">
        <xs:sequence>
            <xs:element name="Title" type="xs:string" />
            <xs:element name="Author" type="xs:string" />
            <xs:element name="ISBN" type="xs:string" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="Pamphlet">
        <xs:complexContent>
            <xs:restriction base="Book">
                <xs:sequence>
                    <xs:element name="Title" type="xs:string" />
                    <xs:element name="Author" type="xs:string" />
                    <xs:element name="ISBN" type="PamphletISBN" />
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>

    <xs:simpleType name="ISBNType">
        <xs:restriction base="xs:string" />
    </xs:simpleType>

    <xs:simpleType name="PamphletISBN">
        <xs:restriction base="ISBNType">
            <xs:maxLength value="5" />
        </xs:restriction>
    </xs:simpleType>

    <xs:complexType name="SearchablePamphlet">
        <xs:complexContent>
            <xs:restriction base="Book">
                <xs:sequence>
                    <xs:element name="Title" type="SearchableString" />
                    <xs:element name="Author" type="SearchableString" />
                    <xs:element name="ISBN" type="SearchablePamphletISBN" />
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="SearchablePamphletISBN">
        <xs:simpleContent>
            <xs:extension base="PamphletISBN">
            <xs:attributeGroup ref="searchableAttributes" />
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>

    <xs:complexType name="SearchableString">
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attributeGroup ref="searchableAttributes" />
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>

    <xs:attributeGroup name="searchableAttributes">
        <xs:attribute name="caseMatches" type="xs:boolean" />
        <xs:attribute name="spellingMatches" type="xs:boolean" />
        <xs:attribute name="checksum" type="xs:integer" />
    </xs:attributeGroup>

</xs:schema> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T13:14:01.860

我找到了一个解决方案，可以隔离我所关注的问题。解决方案是使用“ ***Salami Slice*** ”设计模式，结合**替代**组的。

对于无所不知且有先见之明的分析师，基本文件可能会预测非常发展的需求，或者如果您公司的标准委员会可以在公司的开发小组每次提出另一个时更改基本类型的 XSD 文件他们想要添加的元素或属性。但在我职业生涯的工作经历中，我从未有机会与这样的个人或标准委员会一起工作。

我已经发布了三个 XSD 文件，它们在下面展示了关注点的隔离，以及一个示例 XML 文件。在发布的代码中，我假设 BaseTypes.xsd 文件被冻结并处于变更审查委员会的控制之下。我还假设 DerivedTypes.xsd、Products.xsd 和 Test.xml 文件将由本地产品开发组生成：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <!-- XMLInheritance_BaseDataTypes -->

    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
      targetNamespace="http://www.company.org/XMLInheritance" xmlns:bk="http://www.company.org/XMLInheritance"
      elementFormDefault="qualified" attributeFormDefault="unqualified">

      <xs:element name="Book" type="bk:BookType" />
      <xs:element name="Title" type="xs:string" />
      <xs:element name="Author" type="xs:string" />
      <xs:element name="ISBN" type="bk:ISBNType" />

      <xs:simpleType name="ISBNType">
        <xs:restriction base="xs:string" />
      </xs:simpleType>

      <xs:complexType name="BookType">
        <xs:sequence>
          <xs:element ref="bk:Title" />
          <xs:element ref="bk:Author" />
          <xs:element ref="bk:ISBN" />
        </xs:sequence>
      </xs:complexType>

    </xs:schema>

    ----------

    <?xml version="1.0" encoding="UTF-8"?>
    <!-- XMLInheritance_DerivedDataTypes -->

    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
      targetNamespace="http://www.company.org/XMLInheritance" xmlns:bk="http://www.company.org/XMLInheritance"
      elementFormDefault="qualified" attributeFormDefault="unqualified">

      <xs:include schemaLocation="XMLInheritance_BaseDataTypes.xsd" />

      <xs:element name="SearchableBook" type="bk:SearchableBookType"
        substitutionGroup="bk:Book" />
      <xs:element name=" SearchableTitle " type="bk:SearchableString"
        substitutionGroup="bk:Title" />
      <xs:element name="SearchableAuthor" type="bk:SearchableString"
        substitutionGroup="bk:Author" />
      <xs:element name="SearchableISBN" type="bk:SearchableISBNType"
        substitutionGroup="bk:ISBN" />

      <xs:attributeGroup name="searchableAttributes">
        <xs:attribute name="caseMatches" type="xs:boolean" />
        <xs:attribute name="spellingMatches" type="xs:boolean" />
        <xs:attribute name="checksum" type="xs:integer" />
      </xs:attributeGroup>

      <xs:complexType name="SearchableBookType">
        <xs:complexContent>
          <xs:restriction base="bk:BookType">
            <xs:sequence>
              <xs:element ref="bk:SearchableTitle" />
              <xs:element ref="bk:SearchableAuthor" />
              <xs:element ref="bk:SearchableISBN" />
            </xs:sequence>
          </xs:restriction>
        </xs:complexContent>
      </xs:complexType>

      <xs:complexType name="SearchableISBNType">
        <xs:simpleContent>
          <xs:extension base="bk:ISBNType">
            <xs:attributeGroup ref="bk:searchableAttributes" />
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>

      <xs:complexType name="SearchableString">
        <xs:simpleContent>
          <xs:extension base="xs:string">
            <xs:attributeGroup ref="bk:searchableAttributes" />
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>

    </xs:schema>

    ----------
    <?xml version="1.0" encoding="UTF-8"?>
    <!-- XMLInheritance_DerivedProducts.xsd -->

    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
      targetNamespace="http://www.company.org/XMLInheritance" xmlns:bk="http://www.company.org/XMLInheritance"
      elementFormDefault="qualified">
      <xs:include schemaLocation="XMLInheritance_DataTypes.xsd" />

      <xs:element name="Product">
        <xs:complexType>
          <xs:sequence>

            <xs:element name="Books">
              <xs:complexType>
                <xs:sequence maxOccurs="unbounded">
                  <xs:element name="Book" type="bk:BookType" />
                </xs:sequence>
              </xs:complexType>
            </xs:element>

            <xs:element name="SearchableBooks" minOccurs="0">
              <xs:complexType>
                <xs:sequence maxOccurs="unbounded">
                  <xs:element name="SearchableBook" type="bk:SearchableBookType" />
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>

    </xs:schema>

    ----------
    <?xml version="1.0" encoding="UTF-8"?>
    <!-- XMLInheritance_Test.xml -->
    <bk:Product xmlns:bk="http://www.company.org/XMLInheritance"
      xmlns:xs="http://www.w3.org/2001/XMLSchema-instance"
      xs:schemaLocation="http://www.company.org/XMLInheritance XMLInheritance_DerivedProducts.xsd ">

      <bk:Books>
        <bk:Book>
          <bk:Title>Title</bk:Title>
          <bk:Author>Author</bk:Author>
          <bk:ISBN>ISBN</bk:ISBN>
        </bk:Book>
      </bk:Books>
      <bk:SearchableBooks>
        <bk:SearchableBook>
          <bk:SearchableTitle>Searchable Title</bk:SearchableTitle>
          <bk:SearchableAuthor>Searchable Author</bk:SearchableAuthor>
          <bk:SearchableISBN>Searchable ISBN</bk:SearchableISBN>
        </bk:SearchableBook>
      </bk:SearchableBooks>

    </bk:Product> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T13:05:15.797

下面的 XSD 与您发布的源的意图严格匹配。主要目的是让您了解 XSD 中的限制是如何工作的，以及在创作中需要考虑的开销。

解释一下：您需要从“SearcheableBook”开始，而不是已经***受到限制***的 Book，这是一个拥有所有您需要的实体，然后您可以通过各种限制进行缩减。

```
<?xml version="1.0" encoding="UTF-8"?>
<!--XML Schema generated by QTAssistant/XSD Module (http://www.paschidev.com)-->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:complexType name="SearchableBook" abstract="true">
        <xs:sequence>
            <xs:element name="Title" type="SearchableString"/>
            <xs:element name="Author" type="SearchableString"/>
            <xs:element name="ISBN" type="SearchableString"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="Book">
        <xs:complexContent>
            <xs:restriction base="SearchableBook">
                <xs:sequence>
                    <xs:element name="Title" type="SimpleTitle"/>
                    <xs:element name="Author" type="SimpleAuthor"/>
                    <xs:element name="ISBN" type="SimpleISBN"/>
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="SimpleTitle">
        <xs:simpleContent>
            <xs:restriction base="SearchableString">
                <xs:attribute name="caseMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="spellingMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="checksum" type="xs:integer" use="prohibited"/>              
            </xs:restriction>
        </xs:simpleContent>     
    </xs:complexType>

    <xs:complexType name="SimpleAuthor">
        <xs:simpleContent>
            <xs:restriction base="SearchableString">
                <xs:attribute name="caseMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="spellingMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="checksum" type="xs:integer" use="prohibited"/>                              
            </xs:restriction>
        </xs:simpleContent>
    </xs:complexType>

    <xs:complexType name="SimpleISBN">
        <xs:simpleContent>
            <xs:restriction base="SearchableString">
                <xs:attribute name="caseMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="spellingMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="checksum" type="xs:integer" use="prohibited"/>                              
            </xs:restriction>
        </xs:simpleContent>
    </xs:complexType>

    <xs:complexType name="Pamphlet">
        <xs:complexContent>
            <xs:restriction base="SearchableBook">
                <xs:sequence>
                    <xs:element name="Title" type="SimpleTitle"/>
                    <xs:element name="Author" type="SimpleAuthor"/>
                    <xs:element name="ISBN" type="PamphletISBN"/>
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>
    <xs:complexType name="PamphletISBN">
        <xs:simpleContent>
            <xs:restriction base="SearchableString">
                <xs:maxLength value="5"/>
                <xs:attribute name="caseMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="spellingMatches" type="xs:boolean" use="prohibited"/>
                <xs:attribute name="checksum" type="xs:integer" use="prohibited"/>                              
            </xs:restriction>
        </xs:simpleContent>
    </xs:complexType>

    <xs:complexType name="SearchablePamphlet">
        <xs:complexContent>
            <xs:restriction base="SearchableBook">
                <xs:sequence>
                    <xs:element name="Title" type="SearchableString"/>
                    <xs:element name="Author" type="SearchableString"/>
                    <xs:element name="ISBN" type="SearchablePamphletISBN"/>
                </xs:sequence>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="SearchablePamphletISBN">
        <xs:simpleContent>
            <xs:restriction base="SearchableString">
                <xs:maxLength value="5"/>
            </xs:restriction>
        </xs:simpleContent>
    </xs:complexType>
    <xs:complexType name="SearchableString">
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attributeGroup ref="searchableAttributes"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
    <xs:attributeGroup name="searchableAttributes">
        <xs:attribute name="caseMatches" type="xs:boolean"/>
        <xs:attribute name="spellingMatches" type="xs:boolean"/>
        <xs:attribute name="checksum" type="xs:integer"/>
    </xs:attributeGroup>
</xs:schema> 
```

另外，我会尝试以不同的方式思考模型，通过扩展，看看它是否可以以我称之为更清洁的方式完成（我最近看到一个复杂的限制案例如何扼杀市场上最昂贵的 XSD 编辑器。 ..)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T11:55:48.517

感谢您的回复。它在语法上起作用。不幸的是，答案仅适用于只有一组派生类型的示例**场景**。这在多个开发团队使用共享类型的公共库工作的情况下无法扩展。

例如，在存在包含示例类型“ **Book** ”、“ **Pamphlet** ”和“ **PamphletISBN** ”的共享类型标准公司库的情况下，并且库 XSD 文件被标准进程“*冻结”。*

在这种情况下，搜索团队将无法修改**Book**类型，您也不会真的希望他们这样做。因为其他开发团队有相互竞争的需求。例如，销售团队想要为“ **lifeTimeSales** ”、“ **topRanking** ”、“ **highestRatings** ”等添加属性，而制作团队可能想要为“ **monthlyPrinting** ”、“ **numberInInventory** ”等添加属性。

* * *

从昨天开始，我就尝试使用***elements***来解决这个需求。不幸的是，这种方法也不能扩展到单一类型级别之外。

我要研究的另一种方法是使用替代组，看看这是否开辟了任何途径。如果我找到解决方案，我会发布它。

再次感谢您的建议。

# javascript - 将参数传递给 jQuery 中的事件处理程序

> ID：11731579
> 
> 赞同：2
> 
> 时间：2012-07-31T00:33:50.787
> 
> 标签：javascript, jquery, parameters

我如何向处理程序发送外部范围内的变量？

```
i = 1;
$(id).change(function() {myHandler(i)});
i = 2; 
```

调用时，参数为 2。

也尝试作为字符串，它在 DOM 中工作，但在 jQuery 中不起作用：

```
$(id).change('myHandler(' + i + ')'); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T00:41:06.343

假设您要传递数据对象，

```
var data = {i: 2};
$(id).change(data, myHandler); 
```

在`myHandler`函数中：

```
function myHandler(event) {
    var i = event.data.i; // <= your data
} 
```

如果稍后修改，该值将作为参数传递，不会得到反映。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:51:35.700

通过调用一个接受 i 作为参数并返回一个函数的函数，您可以创建一个捕获 i 的当前值的闭包。

```
function changeHandlerClosure(i) {
    return function() {
        //do stuff here with i
    };
}

i = 1;
$(id).change(changeHandlerClosure(i));
i = 2; 
```

这避免了与 DOM 的交互，这有时更方便但速度较慢。

# maven - 我可以在 Maven 中使用未打包的项目作为依赖项吗？

> ID：11731580
> 
> 赞同：0
> 
> 时间：2012-07-31T00:33:58.990
> 
> 标签：maven, maven-3

m2eclipse 插件有一个项目选项“Resolve dependencies from Workspace projects”，它告诉下游 Maven 项目使用`target/classes`上游依赖项的目录而不是使用打包的 jars。有没有办法告诉`mvn`做同样的事情？

例如，如果我有两个项目，`foo`并且`bar`和`bar`依赖于`foo`，那么在命令行上我必须先打包并安装`foo`，然后才能运行`bar`：

```
cd ~/foo
mvn package install
cd ~/bar
mvn prepare-package
java -cp target/classes:$(mvn -o -q -Dmdep.outputFile=/dev/stdout dependency:build-classpath) Bar 
```

但我想避免打包所有项目，因为 1）它有很多冗余 I/O，以及 2）如果我保存在 Eclipse 中并从命令行运行，很容易忘记再次打包所有项目，然后我'会浪费时间想知道为什么我的更改不起作用。

那么有什么方法可以改变`pom.xml`，以便`mvn`命令使用解压缩的类`mvn prepare-package`而不是`mvn install`存储库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T04:45:06.860

为什么不将 foo 和 bar 放在这样的多模块项目中：

```
PROJ
  + foo
  + bar 
```

而且，使用这种结构，您不应该分别构建 foo 和 bar。只需在 PROJ 级别构建，一切都很好。依赖关系在反应器中解决，您不需要显式地一一安装。

它没有保存您提到的“额外 IO”，但老实说，唯一的区别只是创建 JAR，与发生的其他事情相比，它实际上是最小的。

你的第二个论点也不成立。事实上，您不应该将命令行目标目录与 Eclipse 混合。Eclipse 中的许多特性对输出文件夹中的外部变化很敏感。如果您执行您提到的操作（保存在 Eclipse 中，并希望在命令行构建中获取更新的类文件），那么命令行构建将“破坏”（在 Eclipse 的角度）输出数据并导致 Eclipse 出现问题。（这就是为什么人们想出方法来分隔输出文件夹：[https](https://stackoverflow.com/a/54366009/34088) ://stackoverflow.com/a/54366009/34088 ）

# .htaccess - htaccess 需要帮助来纠正代码

> ID：11731586
> 
> 赞同：0
> 
> 时间：2012-07-31T00:35:09.497
> 
> 标签：.htaccess

我有以下网址（正常且用户友好）

**普通网址：**

```
http://myweb.com/en/search/search.php?search_name=white&mydropdown=All+Categories

{and with page numbers}

http://myweb.com/en/search/search.php?search_name=white&mydropdown=All+Categories&pno=3 
```

**友好的网址：**

```
http://myweb.com/en/search/?search_name=white&mydropdown=All+Categories

{and with page numbers}

http://myweb.com/en/search/?search_name=white&mydropdown=All+Categories&pno=3 
```

我有以下 htaccess，但它不起作用......也许它没有正确编码。它带我回到 en/index.php 而不是 en/search/search.php

**.htaccess**

```
RewriteEngine On

RewriteRule ^en/([a-zA-Z0-9-]+)/?$ en/index.php [L,QSA]
RewriteRule ^en/search/([a-zA-Z0-9-]+)/?$ /en/search/search.php?search_name=$1&mydropdown=$1 [L,QSA] 
```

谢谢帮帮我！问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:36:05.860

为什么您的重定向网址中有两次 $1？

我有一种感觉，第一条规则也将匹配“搜索”。所以它会使用它。尝试颠倒规则顺序。

# php - 如何使用 ajax 调用和普通 php 调用加载内容？

> ID：11731590
> 
> 赞同：0
> 
> 时间：2012-07-31T00:35:37.550
> 
> 标签：php, ajax

我已经为 php 页面创建了 jquery-ajax 调用，该页面通过根据从第一页接收到的 id 从数据库中选择数据来创建内容

当我单击 person1 时，第一页 index.php 有链接 person1，它通过 jquery 重定向到详细信息页面这里是代码：

```
 $('.details').click(function() { 
        $("a").removeClass("active");
        $(this).addClass("active"); 
             var id = $(this).attr("id");
              $.ajax({  
                type: "GET",  
                url: "details.php",
                data:{pid:id},
                success: function(html){        
                    $("#persons").html(html).fadeIn(1000);

                }  
            }); 

                 return false;  
        }); 
```

内容将在这里加载到 index.php 文件中：

```
<div class="row">
    <div class="twelve columns" id="persons" style="display:none" >

    </div>
</div> 
```

详情页内容：

```
 <?

    if(isset($_GET['pid'])){
$id=(int)$_GET['pid'];
    $sql="select id, name,title,details,image,cat from persons  where id ='".$id."' order by name asc";
    $rs=mysql_query($sql)or die(mysql_error());
    if(list($id,$name,$title,$details,$image,$cat)=mysql_fetch_array($rs)){
  ?>
    <h3><? echo $name;?></h3>
    <h5><? echo $title;?></h5>
    <p align="justify">
        <img alt="<? echo $name;?>" src="images/persons/<? echo $image?>" title="<? echo $name;?>" style="float:right; margin-left:15px;" />
        <? echo $details;?>
    </p>
    <?
    }
    }
?> 
```

如何检查页面是否已通过 ajax 调用或普通 php 调用请求？如果不是ajax调用，是否正常加载详情页内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:42:01.647

您可以检查以下变量：

```
$_SERVER['HTTP_X_REQUESTED_WITH'] 
```

对于 AJAX 请求，它应该是“xmlhttprequest”。

但是，您可以简单地向 URL 添加一个参数：

```
url: "details.php?thisisanajaxrequest=1", 
```

只需检查 URL 变量。

# nhibernate - NHibernate 3.3.1 与中等信任错误

> ID：11731591
> 
> 赞同：2
> 
> 时间：2012-07-31T00:36:00.187
> 
> 标签：nhibernate, medium-trust

我以中等信任度使用 NHibernate 3.3.1。它抛出一个安全异常。在 NHibernate 3.3.1 中说它与中等信任兼容。

有什么先决条件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T06:02:30.247

NHibernate 支持中等信任，请阅读[这篇文章](http://nhforge.org/wikis/howtonh/run-in-medium-trust.aspx "以中等信任度运行")。

它描述了如何实现你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T14:02:39.997

我已经成功使用[NHibernate.DependencyInjection](http://nuget.org/packages/NHibernate.DependencyInjection) NuGet 包在中等信任环境中使用 NHibernate。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T20:15:42.723

我遇到了同样的问题并尝试了所有建议来解决它（包括 DependencyInjection），但只有一个帮助了我：

我已将以下代码添加到我的 Global.asax 文件中

```
protected void Application_Start()
{
    NHibernate.Cfg.Environment.UseReflectionOptimizer = false;
    ...
} 
```

并在配置文件中禁用批处理（最后一个属性）

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-configuration xmlns="urn:nhibernate-configuration-2.2" >
  <session-factory name="NHibernate.Test">
    <property name="connection.driver_class">NHibernate.Driver.SqlClientDriver</property>
    <property name="connection.connection_string">Server=........</property>
    <property name="dialect">NHibernate.Dialect.MsSql2008Dialect</property>
    <property name="query.substitutions">true=1;false=0</property>
    <property name="show_sql">false</property>
    <property name="adonet.batch_size">0</property>
  </session-factory>
</hibernate-configuration> 
```

请注意，这应该会导致性能问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-01T13:03:36.493

您需要获得更详细的错误消息，以便我们进一步诊断。在你的 web.config 中添加这个`system.webserver`

```
<httpErrors errorMode="Detailed"/> 
```

希望这将为您提供完整的堆栈跟踪，并从那里允许您进一步调试。

您可能还需要添加此

`<customErrors mode="Off" />`在`system.web`（我不记得了）

# c# - 不需要的数据转储到 Localhost 中的屏幕

> ID：11731593
> 
> 赞同：0
> 
> 时间：2012-07-31T00:36:05.593
> 
> 标签：c#, asp.net, visual-studio-2010, localhost

我猜如果你以前见过这样的东西，你就会知道它是什么。

就个人而言，我不知道从哪里开始描述这个问题，除了看起来我所有的标准输出都以某种方式进入控制台。

据我所知，我的代码中没有调用这些东西，但是我通常使用 Windows 窗体，而不是 ASP.NET。

我通常不使用 localhost 进行调试，但我想确保在更新我的个人网站之前删除了许多 ASP.NET 登录安全功能。

这是我在 localhost 中调试时看到的内容：

![在此处输入图像描述](../Images/6295fce2e8c7f7bef1ace1308217fc8f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T00:38:51.453

这是因为您在 web.config 或页面级别启用了 Trace。

```
 <system.web>
    <trace enabled="true" pageOutput="true" requestLimit="40" localOnly="false"/>
  </system.web> 
```

或者：

```
<%@ Page Title="Home Page" Trace="true" Language="C#" AutoEventWireup="true"
    CodeFile="Default.aspx.cs" Inherits="_Default" %> 
```

# javascript - 我在警告框中得到了功能代码，这是为什么？

> ID：11731599
> 
> 赞同：1
> 
> 时间：2012-07-31T00:36:44.073
> 
> 标签：javascript

当我运行这个脚本时，我在警告框中得到了说话功能代码。应该是“你好！” 不是函数（）{警报（“你好！”）}；. 我使用 alert 是因为我似乎更喜欢 console.log 来学习。该脚本在没有说话功能的情况下工作正常。

```
function person(firstname,lastname,age,eyecolor) {
  this.firstname=firstname;
  this.lastname=lastname;
  this.age=age;
  this.eyecolor=eyecolor;
  this.newlastname=newlastname;
  this.speak=function(){alert("Hello!")};
}

var myFather=new person("John", "Doe", 45, "blue");
var myMother=new person("Sally","Rally", 48,"green");

function newlastname(new_lastname) {
  this.lastname=new_lastname;
}

myMother.newlastname("Doe");
alert(myMother.lastname);
alert(myMother.speak); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T00:38:48.277

将最后一行更改为

```
myMother.speak(); 
```

对于接受字符串的函数，（如，`alert()`），如果你传入一个函数，它将把它当作函数的源代码。因此，当您传入 时`myMother.speak`，`alert`它获取了源代码，因此您看到了结果。

（如果有人可以进一步扩展或提供有用的链接，请随时编辑此答案）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T00:49:36.560

> 我在警告框中得到了功能代码，这是为什么？

那是因为您正在引用一个函数，而不是调用它，似乎`alert()`可能正在调用`toString()`参数`tostring()`上的函数，并且调用函数引用似乎将源作为字符串返回，因此当您提醒您获取源时，虽然这只是一种预感，因为警报似乎是本机实现的，所以我不能真正说出它是如何实现的。

我也不能说这种行为在所有浏览器中都是一致的。

# ruby - 如何在全新安装的 Mountain Lion 上安装 libv8 ruby gem？

> ID：11731600
> 
> 赞同：7
> 
> 时间：2012-07-31T00:36:48.690
> 
> 标签：ruby, ruby-on-rails-3, v8, osx-mountain-lion

我一直在为此绞尽脑汁。我遵循了几个相关帖子中的建议，但无济于事。

我从全新安装的 Mountain Lion 开始，安装了命令行工具，并根据我发现的通过 Homebrew 安装 gcc-4.2 并将符号链接添加到 /usr/ 的其他一些帖子成功安装了 Ruby 1.8.7 bin/gcc-4.2。

但是，现在我无法成功安装 libv8。下面的错误是我从现有建议中得到的。

任何额外的输入？

```
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /Users/Eric/.rbenv/versions/1.8.7-p352/bin/ruby extconf.rb 
creating Makefile
Unable to find a compiler officially supported by v8.
It is recommended to use GCC v4.4 or higher
Traceback (most recent call last):
  File "build/gyp/gyp", line 18, in <module>
    sys.exit(gyp.main(sys.argv[1:]))
  File "build/gyp/pylib/gyp/__init__.py", line 480, in main
    generator.GenerateOutput(flat_list, targets, data, params)
  File "build/gyp/pylib/gyp/generator/make.py", line 2085, in GenerateOutput
    part_of_all=qualified_target in needed_targets)
  File "build/gyp/pylib/gyp/generator/make.py", line 756, in Write
    self.xcode_settings, self.Absolutify, self.Pchify))
  File "build/gyp/pylib/gyp/generator/make.py", line 1132, in WriteSources
    cflags = self.xcode_settings.GetCflags(configname)
  File "build/gyp/pylib/gyp/xcode_emulation.py", line 258, in GetCflags
    sdk_root = self._SdkPath()
  File "build/gyp/pylib/gyp/xcode_emulation.py", line 247, in _SdkPath
    return os.path.join(self._GetSdkBaseDir(), '%s.sdk' % sdk_root)
  File "build/gyp/pylib/gyp/xcode_emulation.py", line 233, in _GetSdkBaseDir
    raise Exception('Error %d running xcode-select' % job.returncode)
Exception: Error 2 running xcode-select
make: *** [out/Makefile.x64] Error 1
Using compiler: g++
GYP_GENERATORS=make \
    build/gyp/gyp --generator-output="out" build/all.gyp \
                  -Ibuild/standalone.gypi --depth=. \
                  -Dv8_target_arch=x64 \
                  -S.x64 -Dhost_arch=x64
xcode-select: Error: No Xcode is selected. Use xcode-select -switch <path-to-xcode>, or see the xcode-select manpage (man xcode-select) for further information.

Gem files will remain installed in /Users/Eric/Development/par8o/vendor/bundle/ruby/1.8/gems/libv8-3.11.8.3 for inspection.
Results logged to /Users/Eric/Development/par8o/vendor/bundle/ruby/1.8/gems/libv8-3.11.8.3/ext/libv8/gem_make.out
An error occured while installing libv8 (3.11.8.3), and Bundler cannot continue.
Make sure that `gem install libv8 -v '3.11.8.3'` succeeds before bundling. 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-08T23:38:35.970

这笔交易适用于 ruby​​ 1.8.7。可能你需要这个 gem 来运行 therubyracer。要完成这项工作，您需要按如下方式安装 therubyracer gem：

```
RUBYOPT=-rrubygems gem install therubyracer 
```

这将安装 therubyracer 和 libv8 gems。

来源：[http ://coderwall.com/p/y1djxq](http://coderwall.com/p/y1djxq)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T09:34:14.893

在我的情况下，由于 libtool 的问题，编译失败。错误是`libtool: unrecognized option '-static'`在安装`libv8`gem 时出现的。

问题是，我的 macports-Installation 有一个明显不工作的 libtool。`$PATH`并且在常规目录之前的 macports-Directory调用了错误的 libtool。

从 PATH-Environment 变量中删除 macports-Directories 起到了作用：使用了`libtool` from`XCode`并且一切正常。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-12T03:35:09.493

[我遇到了这个问题并在这里](https://stackoverflow.com/questions/19673714/rails-gem-install-error-error-installing-libv8-error-failed-to-build-gem-nati)找到了解决方案

简而言之，自己安装 v8 - 如果你有自制软件，你可以运行

```
brew install v8 
```

然后在安装的时候使用system v8

```
gem install libv8 -- --with-system-v8 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-04T15:03:04.053

在 OS X 10.7.5 上遇到此问题后，以下 Gemfile 条目对我有用：

```
gem "libv8", '3.11.8.13'

> ruby -v
ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-darwin11.4.2] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-13T11:23:24.293

以上答案都不适合我。这是这样做的：

```
gem install libv8 -v '3.11.8.3'
gem install therubyracer -v '0.11.0beta5' 
```

参考：[https ://coderwall.com/p/s8ofka](https://coderwall.com/p/s8ofka)

我的系统：

```
OSX Mountain Lion
Ruby 1.9.3 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T00:27:15.900

使用上面的 RUBYOPT=-rrubygems 建议对我有用，但我必须先卸载现有的 therubyracer 和 libv8 gem。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-21T10:05:00.970

First try and resolve the issue by using:

```
RUBYOPT=-rrubygems gem install therubyracer 
```

If the error persists, update your gems:

```
bundle update 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-10T00:15:45.597

经过各种方法的多次失败尝试后，我终于下载了 Xcode，正如错误消息所暗示的那样，这可以解决问题

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-07-31T22:15:35.587

不同的 gem 需要不同版本的 GCC，因此这可能适用于所有 gem，也可能不适用，但这些符号链接解决了安装 Xcode 4.4 的 Mountain Lion 上的 json、eventmachine 和 libv8 gem 的问题。

sudo ln -s /usr/llvm-gcc-4.2/bin/llvm-gcc-4.2 /usr/bin/gcc-4.2

sudo ln -s /usr/llvm-gcc-4.2/bin/llvm-gcc-4.2 /usr/bin/g++-4.2

# asp.net - 将内容绑定到动态渲染

> ID：11731603
> 
> 赞同：0
> 
> 时间：2012-07-31T00:36:58.253
> 
> 标签：asp.net, sitecore, sitecore6

我试图掌握的是添加多个渲染如何使我们能够为项目上的每个渲染定义独特的内容的概念。

解决这个问题的最佳方法是什么？

在内容树中创建了以下结构：

```
MyHome
-Content item 1
-Content item 2
-Content item 3 
```

按书内容项目 1 - 3 是要呈现的个别页面。

我知道我应该做的是在演示详细信息中使用 ContentItem 子布局将这些作为渲染添加到 MyHome，但我看不到它们将如何获得唯一数据？也许我在训练中错过了一步哈哈。

这是不使用页面编辑器的情况，当前公司的页面编辑器对于内容编辑器来说是坏的，我已经单独提出了站点核心支持电话来处理这个问题。

还发布在：[http ://sdn.sitecore.net/SDN5/Forum/ShowPost.aspx?PostID=47373](http://sdn.sitecore.net/SDN5/Forum/ShowPost.aspx?PostID=47373)

更新：

所以调查它我可以定义渲染的数据源，很好的是，当使用创建一个内容项时，它为 MyHome 分配一个连接到数据源的渲染。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T12:16:28.700

渲染是模块化的，并且包含与数据分离的功能。您可以阅读我的博客文章[Using the DataSource Field with Sitecore Sublayouts](http://firebreaksice.com/using-the-datasource-field-with-sitecore-sublayouts/)，了解如何设置。从那里，您可以多次将相同的组件添加到页面，每次查看一个单独的数据源项以向其提供数据。

如果您希望这是自动的，当您创建一个项目时，也许从分支模板创建它并让该分支自动创建子项目，然后让标准值从正在创建的项目分配一个相对数据源，例如，如果从一个分支创建 Home，它会在其下方自动创建内容项 1、内容项 2 和内容项 3，因此数据源可能类似于`./Content item 1`, `./Content item 2`, `./Content item 3`. 只是一个想法。

# c# - 更改 WebFaultException 的 Content-Type

> ID：11731610
> 
> 赞同：2
> 
> 时间：2012-07-31T00:37:38.090
> 
> 标签：c#, wcf, wcf-rest

我有一个 WCF REST 服务，其接口方法带有注释，`[WebGet(..., ResponseFormat = WebMessageFormat.Json)]`通常提供 JSON 格式的响应。现在代码指示错误：

```
throw new WebFaultException<string>("helpful message",HttpStatusCode.BadRequest); 
```

问题是响应上的 Content-Type 仍然`application/json`是即使正文只是纯文本，而不是 JSON 编码。我可以创建一个助手来生成将设置的错误异常`WebOperationContext.Current.OutgoingResponse.ContentType = "text/plain";`，但如果 WCF 层中有一个快速修复程序，它只会为这些类型的异常设置内容类型，那将是更可取的。最干净的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:29:15.323

您可以继承 WebFaultException 并在您的项目中使用它。

```
public class MyWebFaultException<T>:WebFaultException<T>
{
    public MyWebFaultException(T message)
        : base(message, HttpStatusCode.BadRequest)
    {
        WebOperationContext.Current.OutgoingResponse.ContentType = "text/plain";
    }
} 
```

# ruby-on-rails - Rails Rspec 测试重置数据库

> ID：11731614
> 
> 赞同：0
> 
> 时间：2012-07-31T00:38:09.323
> 
> 标签：ruby-on-rails, database, rspec, tdd, reset

我正在学习 Rails 教程，并且一直非常严格地遵循它。但是，我的 user_pages_spec.rb 测试重置了开发数据库。因此，每当我运行测试时，我都会丢失测试前的所有当前数据。我的猜测是问题出在第 11 行，但我不太确定。非常感谢任何帮助，谢谢:)

这是我的 user_pages_spec.rb 文件：

```
require 'spec_helper'

describe "UserPages" do

subject { page }

describe "index" do
    let(:user) { FactoryGirl.create(:user) }

    before(:all) { 30.times { FactoryGirl.create(:user) } }
    after(:all) { User.delete_all }

    before(:each) do
        sign_in user
        visit users_path
    end

    it { should have_selector('title', text: 'All users') }
    it { should have_selector('h1', text: 'All users') }

    describe "pagination" do
        it { should have_selector('div.pagination') }

        it "should list each user" do
            User.paginate(page: 1).each do |user|
                page.should have_selector('li', text: user.name)
            end
        end
    end

    describe "as an admin user" do
        let(:admin) { FactoryGirl.create(:admin) }
        before do
            sign_in admin
            visit users_path
        end

        it { should have_link('delete', href: user_path(User.first)) }
        it "should be able to delete another user" do
            expect { click_link('delete') }.to change(User, :count).by(-1)
        end
        it { should_not have_link('delete', href: user_path(admin)) }
    end
end

describe "signup page" do
    before { visit signup_path }
    let(:submit) { "Create my account" }

    it { should have_selector('h1', text: 'Sign up')}
    it { should have_selector('title', text: full_title('Sign up'))}

    describe "with invalid information" do
        it "should not create a user" do
            expect { click_button submit }.not_to change(User, :count)
        end

        describe "after submission" do
            before { click_button submit }

            it { should have_selector('title', text: 'Sign up') }
            it { should have_content('error') }
        end
    end

    describe "with valid information" do
        before do
            fill_in "Name", with: "Example User"
            fill_in "Email", with: "user@example.com"
            fill_in "Password", with: "foobar"
            fill_in "Confirmation", with: "foobar"
        end

        it "should create a user" do
            expect { click_button submit }.to change(User, :count).by(1)
        end

        describe "after saving the user" do
            before { click_button submit }
            let(:user) { User.find_by_email('user@example.com') }

            it { should have_selector('title', text: user.name) }
            it { should have_selector('div.alert.alert-success', text: 'Welcome' ) }
        end
    end
end

describe "profile page" do
    # Code to make a user variable
    let(:user) { FactoryGirl.create(:user) }
    before { visit user_path(user) }

    it { should have_selector('h1', text: user.name) }
    it { should have_selector('title', text: user.name) }
end

describe "edit" do
    let(:user) { FactoryGirl.create(:user) }
    before do
        sign_in user
        visit edit_user_path(user)
    end

    describe "page" do
        it { should have_selector('h1', text: "Update your profile") }
        it { should have_selector('title', text: "Edit user") }
        it { should have_link('change', href: 'http://gravatar.com/emails') }
    end

    describe "with invalid information" do
        before { click_button "Save changes" }
        it { should have_content('error') }
    end

    describe "with valid information" do
        let(:new_name) { "New Name" }
        let(:new_email) { "new@example.com" }

        before do
            fill_in "Name", with: new_name
            fill_in "Email", with: new_email
            fill_in "Password", with: user.password
            fill_in "Confirm Password", with: user.password
            click_button "Save changes"
        end

        it { should have_selector('title', text: new_name) }
        it { should have_selector('div.alert.alert-success') }
        it { should have_link('Sign out', href: signout_path) }
        specify { user.reload.name.should == new_name }
        specify { user.reload.email.should == new_email }
    end
end 
end 
```

这是我的 database.yml 文件：

```
# PostgreSQL. Versions 8.2 and up are supported.
#
# Install the pg driver:
#   gem install pg
# On Mac OS X with macports:
#   gem install pg -- --with-pg-config=/opt/local/lib/postgresql84/bin/pg_config
# On Windows:
#   gem install pg
#       Choose the win32 build.
#       Install PostgreSQL and put its /bin directory on your path.
#
# Configure Using Gemfile
# gem 'pg'
#
development:
  adapter: postgresql
  encoding: unicode
  database: rails
  pool: 5
  username: postgres
  password: pwpwpwpw

  # Connect on a TCP socket. Omitted by default since the client uses a
  # domain socket that doesn't need configuration. Windows does not have
  # domain sockets, so uncomment these lines.
  #host: localhost
  #port: 5432

  # Schema search path. The server defaults to $user,public
  #schema_search_path: myapp,sharedapp,public

  # Minimum log levels, in increasing order:
  #   debug5, debug4, debug3, debug2, debug1,
  #   log, notice, warning, error, fatal, and panic
  # The server defaults to notice.
  #min_messages: warning

# Warning: The database defined as "test" will be erased and
# re-generated from your development database when you run "rake".
# Do not set this db to the same as development or production.
test: &test
  adapter: postgresql
  encoding: unicode
  database: rails
  pool: 5
  username: postgres
  password: pwpwpwpw

production:
  adapter: postgresql
  encoding: unicode
  database: rails
  pool: 5
  username: postgres
  password: pwpwpwpw

cucumber:
  <<: *test 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:21:58.020

您需要单独的数据库用于开发和测试环境。例如：

```
development: &BASE
  adapter: postgresql
  encoding: unicode
  database: rails_development
  pool: 5
  username: postgres
  password: pwpwpwpw

test: &test
  <<: *BASE
  database: rails_test

production:
  <<: *BASE
  database: rails_production

cucumber:
  <<: *test 
```

# python - Urllib 根据要求在任何地方下载文件，除了在我的笔记本电脑上

> ID：11731615
> 
> 赞同：0
> 
> 时间：2012-07-31T00:38:21.920
> 
> 标签：python, download, urllib

我有一个 Python 脚本，它根据日期、时间和小时数从 NOAA 网站下载 GRIB 文件（天气预报数据）以提前预测。基本上，Python 将一个大的 URL 请求拼凑在一起并将其发布到 NOAA 网站。这在学校的计算机上非常有效，并且对于以前帮助我编写代码的一些 stack-overflowers 非常有效。但是，在我的计算机上使用 Python 时，相同的脚本 10 次中有 9 次失败，即使当我让 Python 打印出 URL 并将其复制到 Firefox 中时，它每次都运行良好。将库更改为 urllib2 不会改变任何内容。

所以我可以说以下内容：如果我使用我的计算机，urllib 无法获得我想要的数据，但脚本在其他任何地方都可以正常工作。Urllib 可以毫无问题地从我的计算机上的其他网站上抓取 HTML，但不知何故，这个特定的下载给它带来了麻烦。

当我尝试在家中运行脚本时，我正在使用无线连接的笔记本电脑上运行 Ubuntu 并使用 Python 2.7.3。我已经在带有 ubuntu 精确的有线计算机上对其进行了测试，并且每次都可以正常工作（也在 fedora 上测试过，也可以在那里工作）。

请告诉我一些我可以做的诊断，以找出为什么 urllib 和我的计算机不能正常运行。谢谢你；这个问题阻碍了下一代高空气球的发射。

以下是它在 90% 的情况下告诉我的内容：

```
Traceback (most recent call last):
File "/home/dantayaga/bovine_aerospace/dev/grib_get.py", line 67, in <module>
webf=urllib.urlopen(griburl, data='POST')
File "/usr/lib/python2.7/urllib.py", line 88, in urlopen
return opener.open(url, data)
File "/usr/lib/python2.7/urllib.py", line 209, in open
return getattr(self, name)(url, data)
File "/usr/lib/python2.7/urllib.py", line 344, in open_http
h.endheaders(data)
File "/usr/lib/python2.7/httplib.py", line 954, in endheaders
self._send_output(message_body)
File "/usr/lib/python2.7/httplib.py", line 814, in _send_output
self.send(msg)
File "/usr/lib/python2.7/httplib.py", line 776, in send
self.connect()
File "/usr/lib/python2.7/httplib.py", line 757, in connect
self.timeout, self.source_address)
File "/usr/lib/python2.7/socket.py", line 553, in create_connection
for res in getaddrinfo(host, port, 0, SOCK_STREAM):
IOError: [Errno socket error] [Errno -2] Name or service not known 
```

这是我正在使用的代码（归功于 samy.vilar 等人的改进 pythonicity）。请注意，您必须输入今天的日期和 00、06、12 或 18（格林威治标准时间）的预测时间，否则您可能会收到 404 未找到。保持预报时间不变。

# 获取 GRIB 文件

```
import urllib
#import os

#os.environ['http_proxy']='' #Doesn't seem to help!

forecast_time='06' #What time the forecast is (00, 06, 12, 18)
forecast_hours='12' #How many hours ahead to forecast (2 or 3 digits)
forecast_date='20120720' #What date the forecast is for yyyymmdd

top_lat=90 #Top of bounding box (North)
bottom_lat=-90 #Bottom of bounding box (South)
left_lon=-90 #Left of bounding box (West)
right_lon=90 #Right of bounding box (East)

griburl='http://nomads.ncep.noaa.gov/cgi-bin/filter_gfs_hd.pl?'
griburl=griburl+'file=gfs.t'+str(forecast_time)+'z.mastergrb2f'
griburl=griburl+forecast_hours

#Select atmospheric levels

griburl=griburl+'&lev_1000_mb=on'  #1000 mb level
griburl=griburl+'&lev_975_mb=on'   #975 mb level
griburl=griburl+'&lev_950_mb=on'   #950 mb level
griburl=griburl+'&lev_925_mb=on'   #925 mb level
griburl=griburl+'&lev_900_mb=on'   #900 mb level
griburl=griburl+'&lev_850_mb=on'   #850 mb level
griburl=griburl+'&lev_800_mb=on'   #800 mb level
griburl=griburl+'&lev_750_mb=on'   #750 mb level
griburl=griburl+'&lev_700_mb=on'   #700 mb level
griburl=griburl+'&lev_650_mb=on'   #650 mb level
griburl=griburl+'&lev_600_mb=on'   #600 mb level
griburl=griburl+'&lev_550_mb=on'   #550 mb level
griburl=griburl+'&lev_500_mb=on'   #500 mb level
griburl=griburl+'&lev_450_mb=on'   #450 mb level
griburl=griburl+'&lev_400_mb=on'   #400 mb level
griburl=griburl+'&lev_350_mb=on'   #350 mb level
griburl=griburl+'&lev_300_mb=on'   #300 mb level
griburl=griburl+'&lev_250_mb=on'   #250 mb level
griburl=griburl+'&lev_200_mb=on'   #200 mb level
griburl=griburl+'&lev_150_mb=on'   #150 mb level
griburl=griburl+'&lev_100_mb=on'   #100 mb level
griburl=griburl+'&lev_70_mb=on'    #70 mb level
griburl=griburl+'&lev_30_mb=on'    #30 mb level
griburl=griburl+'&lev_20_mb=on'    #20 mb level
griburl=griburl+'&lev_10_mb=on'    #10 mb level

#Select variables

griburl=griburl+'&var_HGT=on'  #Height (geopotential m)
griburl=griburl+'&var_RH=on'  #Relative humidity (%)
griburl=griburl+'&var_TMP=on' #Temperature (K)
griburl=griburl+'&var_UGRD=on' #East-West component of wind (m/s)
griburl=griburl+'&var_VGRD=on' #North-South component of wind (m/s)
griburl=griburl+'&var_VVEL=on' #Vertical Windspeed (Pa/s)

#Select bounding box

griburl=griburl+'leftlon='+str(left_lon)
griburl=griburl+'rightlon='+str(right_lon)
griburl=griburl+'toplat='+str(top_lat)
griburl=griburl+'bottomlat='+str(bottom_lat)

#Select date and time

griburl=griburl+'&dir=%2Fgfs.'+forecast_date+forecast_time+'%2Fmaster'
print(griburl)
print('Downloading GRIB file for date '+forecast_date+' time ' +forecast_time + ', forecasting '+forecast_hours+' hours ahead...')
webf=urllib.urlopen(griburl, data='POST')
print("Download complete.  Saving...")
local_filename=forecast_date+'_'+forecast_time+'_'+forecast_hours+'.grib'
localf=open(local_filename, 'wb')
localf.write(webf.read())
print('Requested grib data written to file '+local_filename) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:15:57.807

```
IOError: [Errno socket error] [Errno -2] Name or service not known 
```

此异常表明您的笔记本电脑无法将主机名解析为 IP 地址。DNS 查找由套接字库处理，这与您是否使用`urllib`或`urllib2`（或其他任何东西）无关。

您需要查看您的网络设置，尤其是您的 DNS 服务器。可能是 Firefox 被配置为使用代理，在这种情况下，它会将 DNS 查找委托给代理。

奇怪的是您在其他网站上没有问题。我无法解释为什么使用`urllib`其他站点的 HTML 抓取工作（可能为这些脚本启用了代理？），但您遇到的异常肯定与 DNS 有关。

如果您确实发现 Firefox 正在使用代理，请尝试将您的脚本设置为使用相同的代理。一种简单的方法是像这样调用您的 Python 脚本：

```
http_proxy=http://proxy:1234 python grib_get.py 
```

或者，出于诊断目的，您可以暂时将远程服务器的 IP 地址硬编码到您的 URL 中，即

```
griburl='http://140.90.33.62/cgi-bin/filter_gfs_hd.pl?' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:01:46.777

我想知道这是否是内存问题，内存不足，所以它被分页到磁盘，减慢了太多。

无论如何，在您实际下载任何内容之前，您正在打印“下载完成。正在保存...”！

试试这个：

```
print('Downloading GRIB file for date '+forecast_date+' time ' +forecast_time + ', forecasting '+forecast_hours+' hours ahead...')
local_filename=forecast_date+'_'+forecast_time+'_'+forecast_hours+'.grib'
webf=urllib.urlopen(griburl, data='POST')
localf=open(local_filename, 'wb')
BLOCK_SIZE = 4096
while True:
    block = webf.read(BLOCK_SIZE)
    if not block:
        break
    localf.write(block)
localf.close()
webf.close()
print("Download complete.  Saving...") 
```

# java - java在第二类中找不到构造函数

> ID：11731617
> 
> 赞同：0
> 
> 时间：2012-07-31T00:38:50.237
> 
> 标签：java, class, constructor, compiler-errors

我有一个由 Land 扩展的 SimpleBoard 类，然后由 Units 扩展。每当我尝试编译 Units 时，都会收到此错误：

```
cannot find symbol
symbol  : constructor Land()
location: class Land
    public Units(int x, int y){ 
```

想出了什么问题？

编辑：对不起，我很着急！这是完整的代码：

```
public class Units extends Land{

    private int attack;

    public Units(int x, int y) {

        if(x==1){
            attack = 1;
        }
        else if(x==2)
            attack = 2;
        else if(x==3)
            attack = 4;
        ar[y].AddUnit(this);
    }

    public int getAttack(){
        return attack;
    }
    } 
```

和土地

```
public class Land extends SimpleBoard {
    private boolean barrel = false;
    private boolean crown = false;
    private boolean castle = false;
    private boolean stronghold = false;
    private int num;
    private int array = 0;
    public int[] adjacent;
    private Units [] Occupy = new Units [4];

    public Land(int z, int x, int c, int v, int b, int[] array){
        if(z == 1)
            barrel = true;
        if(x == 1)
            crown = true;
        if(c == 1)
            castle = true;
        if (v==1)
            stronghold = true;
        num = b;
        adjacent = array;
    }

    public void addUnit(Units x){
        Occupy[array] = x;
        array++;
    }

    public boolean checkB(){
        return barrel;
    }

    public int getAdj(int i){
        return adjacent[i];
    }
    } 
```

和板

```
public class SimpleBoard {
    public static Land[] ar = new Land[3];
    public static void main(String[] args){
    Land One = new Land(1,0,0,0,1, new int[]{2, 3});
    Land Two = new Land(0,1,0,0,2, new int[]{1, 3});
    Land Three = new Land(0,0,1,0,3, new int[]{1, 2});
    ar[0] = One;
    ar[1] = Two;
    ar[2] = Three;

    Units Footman = new Units(1, 1);
    Units Knight = new Units(2, 3);
    Units Siege = new Units(3, 2);

    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:27:22.917

您可以将您的`Units`和`Land`班级更改为此：

```
public class Units extends Land {

    private int attack;

    public Units(int z, int x, int c, int v, int b, int[] array) {
        super(z, x, c, v, b, array);
    }

    public Units(int x, int y) {

        if (x == 1) {
            attack = 1;
        } else if (x == 2) {
            attack = 2;
        } else if (x == 3) {
            attack = 4;
        }
        ar[y].addUnit(this);
    }

    public int getAttack() {
        return attack;
    }
}

public class Land extends SimpleBoard {

    // Declared variable

    public Land(int x, int y) {

    }

    // Rest of the code...
} 
```

由于继承，您将在`Units`类中声明的构造函数也必须存在于`Land`类中。

在您的类中添加一个构造函数，`Land`调用其中`Land(int x, int y)`没有任何代码（只是一个空白构造函数），以便它将删除您的`Units`类中的错误。这不是最佳做法，因为我不知道您要做什么。如果你赶时间，你可以试试这个，但如果你有时间，请简要说明你的申请目的。

# 更新：

**SimpleBoardGame.java**

```
public class SimpleBoardGame {

    private static Land[] ar = new Land[3];

    public static Land[] getAr() {
        return ar;
    }

    public static void main(String[] args) {
        Land One = new Land(1, 0, 0, 0, 1, new int[]{2, 3});
        Land Two = new Land(0, 1, 0, 0, 2, new int[]{1, 3});
        Land Three = new Land(0, 0, 1, 0, 3, new int[]{1, 2});
        ar[0] = One;
        ar[1] = Two;
        ar[2] = Three;

        // When you pass the parameter for 'y' please make sure it already minus by one.
        // If not, will occur the 'java.lang.ArrayIndexOutOfBoundsException'
        Unit Footman = new Unit(1, 0);
        Unit Knight = new Unit(2, 2);
        Unit Siege = new Unit(3, 1);

    }
} 
```

* * *

**土地.java**

```
public class Land {

    // For boolean variable, no need to set the value as "false" since it default is "false".
    private boolean barrel;
    private boolean crown;
    private boolean castle;
    private boolean stronghold;
    private int num;
    private int array = 0;
    public int[] adjacent;
    private Unit[] Occupy = new Unit[4];

    public Land(int x, int y) {
        // Empty constructor...
    }

    public Land(int z, int x, int c, int v, int b, int[] array) {
        if (z == 1) {
            barrel = true;
        }
        if (x == 1) {
            crown = true;
        }
        if (c == 1) {
            castle = true;
        }
        if (v == 1) {
            stronghold = true;
        }
        num = b;
        adjacent = array;
    }

    public void addUnit(Unit x) {
        Occupy[array] = x;
        array++;
    }

    public boolean checkB() {
        return barrel;
    }

    public int getAdj(int i) {
        return adjacent[i];
    }
} 
```

* * *

**Unit.java** *(从 更改`Units.java`为`Unit.java`)*

```
public class Unit extends Land {

    private int attack;

    public Unit(int z, int x, int c, int v, int b, int[] array) {
        super(z, x, c, v, b, array);
    }

    public Unit(int x, int y) {
        super(x, y);

        if (x == 1) {
            attack = 1;
        } else if (x == 2) {
            attack = 2;
        } else if (x == 3) {
            attack = 4;
        }

        addUnit(y);
    }

    /**
     * Overload method of the addUnit() of Land class.
     * Better not use "this" inside the constructor.
     * 
     * @param y
     */
    public final void addUnit(int y) {
        SimpleBoardGame.getAr()[y].addUnit(this);
    }

    public int getAttack() {
        return attack;
    }
} 
```

注意：*请确保你没有继承`SimpleBoardGame`作为类中的主类`Land`，如果你想访问主类中的变量，只需为此创建 setter 和 getter。您可以像这样访问（请参阅类中的`SimpleBoardGame.getAr()[y].addUnit(this);`内部方法。`addUnit(int y)``Unit`*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T03:19:47.943

这个想法很简单：

子继承自父。在子构造函数中，您需要首先通过调用父构造函数来构造对象的“父”部分，然后再构造您的子部分。

它由 super(...) 语句完成：

```
class Animal {
    String name;

    public Animal(String name) {
        this.name = name;
    }
}

class Human extends Animal {
    String familyName;

    public Human(String name, String familyName) {
        super(name);    // HERE!!!! means calling Animal's Animal(String) ctor
        this.familyName = familyName;
    }
} 
```

如果您没有显式添加 super(...) 语句，编译器将假定您正在调用 Parent 类的无参数构造函数。

对于没有定义构造函数的类，编译器会为其添加一个默认的无参数构造函数。但是，由于您的 Land 定义了 public Land(int z, int x, int c, int v, int b, int[] array) 构造函数，这意味着您在 Land 中将没有无参数构造函数。

Unit 的构造函数中没有 super(...) 语句，这意味着它会尝试调用 Land 的无参数构造函数（不存在），从而导致问题

* * *

编辑：虽然有点离题，但在我看来，您对继承的使用没有任何意义。为什么“Land”是“SimpleBoard”？为什么“单位”是“土地”？对我来说，它们似乎是一种“有”的关系，而不是“是”的。考虑重新设计您的应用程序，否则您将面临更奇怪的问题

# web-services - 提高测试存根的质量

> ID：11731620
> 
> 赞同：1
> 
> 时间：2012-07-31T00:39:31.030
> 
> 标签：web-services, testing, soap, websphere

我最近完成了一个项目，我们是客户测试供应商的集成软件解决方案。供应商无法访问我们的测试环境，因此使用测试存根来测试他们的 Web 服务调用。由于他们的存根质量差，他们得到了许多误报，这导致了系统集成测试期间的一些缺陷。

现在角色互换了。我现在代表一家供应商协调针对 WebSphere 解决方案的测试存根进行的测试。鉴于我最近的经历，我对此感到担忧。不幸的是，由于开发是在离岸完成的，因此无法针对完全集成的环境进行测试。

如何确保我们的测试存根充分反映集成环境的复杂性？

# php - sql搜索引擎自动更新php

> ID：11731621
> 
> 赞同：0
> 
> 时间：2012-07-31T00:39:33.677
> 
> 标签：php, sql, search, auto-update

我正在尝试为我的网站制作一个搜索引擎，但是我很好奇如何让它自动更新，例如 google、facebook 等，而无需重新加载页面。

我目前正在将 MySQL 与 InnoDB 表和 PHP 一起使用。我知道如何进行 MySQL 搜索，但是是否有人对如何在不重新加载页面的情况下在搜索栏中生成结果提出建议。我自己做了一些研究，没有发现任何有用的东西。此外，使用 MyISAM 引擎的全文是否比通过索引行搜索更有用。

我仍在学习 Web 开发的来龙去脉，因此我更喜欢代码建议，而不是“链接到该程序并执行此操作”。一旦我知道我在做什么，那将在以后出现。

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:20:47.563

您可以使用 AJAX 来完成此操作。您可以编写一个小的 PHP 脚本，根据当前输入到搜索框中的字符对数据库进行简单调用，然后使用 AJAX 调用它来填充您的搜索框。我不会为你写完整的东西，因为这不是网站的目的，但你可以从这里开始。网上也有很多类似的教程。

阿贾克斯：

```
function getXmlHttpRequestObject() {
    if (window.XMLHttpRequest) {
        return new XMLHttpRequest();
    } else if(window.ActiveXObject) {
        return new ActiveXObject("Microsoft.XMLHTTP");
    } else {
        alert("Your browser does not support AJAX, please upgrade.");
    }
}

//Create XMLHTTPRequest Object
var searchEntry = getXmlHttpRequestObject();

//Send AJAX request, do something when it sends a response
function searchSuggest() {
    if (searchReq.readyState == 4 || searchReq.readyState == 0) {
            var str = document.getElementById('insertsearchboxidhere').value;
            searchEntry.open("GET", 'yourphpscript.php?search=' + str, true);
            searchEntry.onreadystatechange = doSearchStuff(); 
            searchEntry.send(null);
        }       
    }

//Function that does the work with the response
function doSearchStuff() {
    if (searchReq.readyState == 4) {
        var str = searchEntry.responseText;
            //Set innerHTML of your stuff to str, whatever else you want
    }
} 
```

PHP：显然，您需要的不仅仅是下面的代码，但首当其冲的工作将是从您的数据库中返回以当前输入到搜索框中的字母开头的条目。你可以弄清楚其余的。

```
$query = "Select distinct(x) from (y) where x like '(z)%'"; 
```

x = 字段，y = 表格，z = 您通过 AJAX 发送的变量

这应该足以构建一个更新的搜索框。

# ruby-on-rails - RSpec：存根 SFTP

> ID：11731626
> 
> 赞同：9
> 
> 时间：2012-07-31T00:40:31.110
> 
> 标签：ruby-on-rails, rspec, stubbing, net-sftp

我试图从一个对象中剔除 Net::SFTP 。这是模型：

```
class BatchTask
  require 'net/sftp'

  def get_file_stream(host, username, password, path_to_dir, filename)
    raise ArgumentError if host.nil? or username.nil? or password.nil? or path_to_dir.nil? or filename.nil?
    file_stream = nil
    Net::SFTP.start(host, username, password) do |sftp|
      sftp.dir.glob(path_to_dir, filename) do |entry|
        # Verify the directory contents
        raise RuntimeError(true), "file: #{path_to_dir}/#{filename} not found on SFTP server" if entry.nil?
        file_stream = sftp.file.open("#{path_to_dir}/#{entry.name}")
      end
    end
    file_stream
  end

end 
```

这是规格：

```
require 'spec_helper'

describe "SftpToServer" do
  let(:ftp) { BatchTask::SftpToServer.new }

 it "should return a file stream" do
    @sftp_mock = mock('sftp')
    @entry = File.stubs(:reads).with("filename").returns(@file)
    @entry_mock = mock('entry')
    @entry_mock.stub(:name).with("filename").and_return("filename")
    @sftp_mock.stub_chain(:dir, :glob).and_yield(@entry_mock)
    Net::SFTP.stub(:start).and_yield(@sftp_mock)
    @sftp_mock.stub_chain(:file, :open).with("filename").and_yield(@file)

    ftp.get_file_stream("ftp.test.com", "user", "password", "some/pathname", "filename").should be_kind_of(IO)
  end

end 
```

这是堆栈跟踪：

```
Spec::Mocks::MockExpectationError in 'SftpToServer should return a file stream'
Mock "entry" received :name with unexpected arguments
  expected: ("filename")
       got: (no args)
/Users/app/models/batch_task/sftp_to_server.rb:12:in `get_file_stream'
/Users/app/models/batch_task/sftp_to_server.rb:9:in `get_file_stream'
/Users/app/models/batch_task/sftp_to_server.rb:8:in `get_file_stream'
./spec/models/batch_task/sftp_to_server_spec.rb:15: 
```

首先，我的方法在这里吗？我想删除 SFTP 的功能，因为我们可以确信它已经过很好的测试。相反，我想专注于确保 get_file_stream() 中的“黑匣子”返回文件流。

其次，我怎样才能正确地存根 sftp.file.open() 来完成这个？

在此先感谢您的任何想法！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T03:55:48.407

首先，mock out sftp 是一个好主意，原因有两个：

1.  您不是在编写 sftp 测试，而是专注于测试您打算测试的内容。
2.  您在测试中删除了对网络的任何依赖——您不希望测试因为您无法控制的事情而开始失败。

就错误而言，这是您的直接问题：

```
@entry_mock.stub(:name).with("filename").and_return("filename") 
```

在这里你是存根`entry.name("filename")`而不是仅仅`entry.name`.

将其更改为：

```
@entry_mock.stub(:name).and_return("filename") 
```

让我知道你过得怎么样。

# java - java导入错误，org.jdom

> ID：11731628
> 
> 赞同：2
> 
> 时间：2012-07-31T00:40:43.980
> 
> 标签：java, eclipse, import, jdom

我一直在尝试在我的 java 项目中进行导入，但我不断收到以下错误。

```
The import org.jdom cannot be resolved 
```

我在我的项目下创建了一个 lib 文件夹，并从[http://www.jdom.org/downloads/index.html放置了 jar 文件](http://www.jdom.org/downloads/index.html)

进入那里。我总共添加了 8 个不同的 jar 文件。然后我将它们添加到我的构建路径中。这 8 个文件现在在我引用的库中。但是该错误不断出现。我尝试刷新和清理我的项目，但没有运气。

我应该做一些不同的事情，因为它是一个 org.jdom 吗？

我的导入语句是...

```
import org.jdom.Document;
import org.jdom.Element;
import org.jdom.JDOMException;
import org.jdom.input.SAXBuilder;
import org.jdom.output.Format;
import org.jdom.output.XMLOutputter; 
```

谢谢你

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T00:59:24.317

我使用 7zip 在您提供的链接上打开了 jar 文件。看起来您需要使用导入语句：（注意添加了“2”）“import org.jdom2.Document;”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T10:06:46.917

**这取决于库版本！**

如果你下载了**版本 1**，你必须写：

```
import org.jdom.* 
```

如果你下载了**第 2 版**，你必须写：

```
import org.jdom2.* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-13T06:57:14.373

您应该导入稳定且为我工作的**[jdom-1.1.3 。](http://www.jdom.org/dist/binary/archive/jdom-1.1.3.zip)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-05T16:32:53.000

可能是因为更高版本中的包重命名。更高版本显示包名称为 dom2 而不是 dom。

# python - 从字典python中删除“计数器”

> ID：11731633
> 
> 赞同：2
> 
> 时间：2012-07-31T00:40:57.287
> 
> 标签：python, dictionary, counter

我正在使用 Python 中的`Counter`类来计算大型 Python 字典的键中的单词数。我正在创建一个新字典，键是递增的数字，值是计数器函数的返回值。这是我的新字典的样子：

```
TP = {1:Counter({u'x':1, u'b':1, u'H':3}),2:Counter({u'j':1, u'm':4, u'e':2})...} 
```

如果可能的话，我想要做的是删除`Counter`和括号（和），以便我的字典看起来像：

```
TP = {1:{u'x':1, u'b':1, u'H':3}, 2:{u'j':1, u'm':4, u'e':2}...} 
```

如果那不可能，有人可以告诉我如何访问（）内的嵌套字典吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T00:43:56.807

我看不出这样做有什么意义，它`Counter`是所有方法的子类`dict`并支持它的所有方法，因此保持原样应该没有问题，尽管只是为了这个问题，我会将其转换回正常状态`dict`：

```
>>> from collections import Counter
>>> tp = {1:Counter({u'x':1, u'b':1, u'H':3}),2:Counter({u'j':1, u'm':4, u'e':2})}
>>> dict((k, dict(v)) for k, v in tp.iteritems())
{1: {u'x': 1, u'b': 1, u'H': 3}, 2: {u'e': 2, u'j': 1, u'm': 4}} 
```

对于 Python 2.7+（由@Blender 建议）

```
{k: dict(v) for k, v in tp.iteritems()} 
```

遍历子字典，例如：

```
for w, c in tp[1].iteritems():
    print w, c 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:33:40.550

您可能正在寻找一种漂亮的打印方法。

这是一种方法：

```
def pprint_counter(c):
    for k, v in c.items():
        l=[u'{}:{}'.format(ks,vs) for ks,vs in v.items()]
        print '{:4}: {}'.format(k, ' '.join(l)) 
```

现在用你的例子测试：

```
tp = {1:Counter({u'x':1, u'b':1, u'H':3}),2:Counter({u'j':1, u'm':4, u'e':2})}
pprint_counter(tp) 
```

印刷：

```
 1: x:1 b:1 H:3
   2: m:4 j:1 e:2 
```

现在访问子元素“x”：

```
tp[1]['x']=123
pprint_counter(tp) 
```

印刷：

```
 1: x:123 b:1 H:3
   2: m:4 j:1 e:2 
```

因此，您通过直接下标 `tp[1]['x'] 和您想要的格式访问的各个元素 - 只需添加代码。

# java - 在 Maven2 中使用 Sigar 的问题

> ID：11731634
> 
> 赞同：2
> 
> 时间：2012-07-31T00:41:01.483
> 
> 标签：java, maven, jna, sigar

我在使用 Sigar 和 Maven2 时遇到错误。我知道它找不到本机库（dll 或 .so），因为我知道我无法将本机库复制到我的 WEB-INF/lib 目录中......我的问题是“如何将 lib 文件目录复制到使用 Maven 在我的 WAR 文件中的 WEB-INF/lib？

我要复制的目录是：${basedir}/lib/ 我要复制的目录是：${webapp.output}/WEB-INF/lib（我想？）

这是错误：

```
java.lang.UnsatisfiedLinkError: org.hyperic.sigar.Sigar.getLoadAverage() 
```

这是我的pom文件：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.testing</groupId>
    <artifactId>TestAgent</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>war</packaging>

    <name>TestAgent</name>

    <properties>
        <endorsed.dir>${project.build.directory}/endorsed</endorsed.dir>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <netbeans.hint.deploy.server>gfv3ee6</netbeans.hint.deploy.server>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.apache.tomcat</groupId>
            <artifactId>servlet-api</artifactId>
            <version>6.0.35</version>
        </dependency>
        <dependency>
            <groupId>javax</groupId>
            <artifactId>javaee-web-api</artifactId>
            <version>6.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.ini4j</groupId>
            <artifactId>ini4j</artifactId>
            <version>0.5.2</version>
        </dependency>
        <dependency>
            <groupId>org.hyperic</groupId>
            <artifactId>sigar</artifactId>
            <version>1.6.4</version>
            <scope>system</scope>
            <systemPath>${basedir}/lib/sigar.jar</systemPath>
        </dependency>    
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>net.java.dev.jna</groupId>
            <artifactId>jna</artifactId>
            <version>3.4.0</version>
        </dependency>
        <dependency>
            <groupId>net.java.dev.jna</groupId>
            <artifactId>platform</artifactId>
            <version>3.4.0</version>
        </dependency>
        <dependency>
            <groupId>com.google.code.gson</groupId>
            <artifactId>gson</artifactId>
            <version>2.2.2</version>
        </dependency>
    </dependencies>

    <build>        
        <testSourceDirectory>src/test/java</testSourceDirectory>
        <testResources>
            <testResource>
                <directory>src/test/resources</directory>
            </testResource>
        </testResources>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                    <compilerArguments>
                        <endorseddirs>${endorsed.dir}</endorseddirs>
                    </compilerArguments>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>2.1.1</version>
                <!-- <configuration> section added to pick up the WEB-INF/web.xml inside WebContent -->
                <configuration>
                    <webResources>
                        <resource>
                            <directory>src/main/webapp</directory>
                        </resource>
                    </webResources>
                    <failOnMissingWebXml>true</failOnMissingWebXml>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <version>2.1</version>
                <executions>
                    <execution>
                        <phase>validate</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>${endorsed.dir}</outputDirectory>
                            <silent>true</silent>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>javax</groupId>
                                    <artifactId>javaee-endorsed-api</artifactId>
                                    <version>6.0</version>
                                    <type>jar</type>
                                </artifactItem>
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
    <repositories>
        <repository>
            <url>http://download.eclipse.org/rt/eclipselink/maven.repo/</url>
            <id>eclipselink</id>
            <layout>default</layout>
            <name>Repository for library EclipseLink (JPA 2.0)</name>
        </repository>
    </repositories>
</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T06:51:53.083

[您可以配置 maven war 插件以复制其他文件/文件夹，如此处](http://maven.apache.org/plugins/maven-war-plugin/examples/adding-filtering-webresources.html)所示。像下面的东西。

```
 <configuration>
      <webResources>
        <resource>
          <directory>lib</directory>
          <!-- override the destination directory for this resource -->
          <targetPath>WEB-INF/lib</targetPath>
        </resource>
      </webResources>
    </configuration> 
```

# asp.net-mvc-3 - 分配 EntityState.Modified 时出现“违反参照完整性约束”

> ID：11731646
> 
> 赞同：0
> 
> 时间：2012-07-31T00:43:38.393
> 
> 标签：asp.net-mvc-3, entity-framework, ef-code-first

以下是我的代码优先数据模型：

```
 public class Job
    {
        public Job()
        {
            this.Jobs = new List<Job>();
            this.Quotes = new List<Quote>();
            this.WorkTimes = new List<WorkTime>();
        }

        public long ID { get; set; }
        public string JobName { get; set; }
        public string Description { get; set; }

        [ForeignKey("Customer")]
        public Nullable<long> CustomerID { get; set; }
        public Nullable<decimal> LimitHours { get; set; }

        [ForeignKey("ParentJob")]
        public Nullable<long> ParentID { get; set; }
        public Nullable<System.DateTime> HardDeadline { get; set; }
        public Nullable<System.DateTime> SoftDeadline { get; set; }
        public int Priority { get; set; }
        public Nullable<byte> Progress { get; set; }

        [ForeignKey("JobState")]
        public Nullable<byte> JobStateID { get; set; }

        public virtual Customer Customer { get; set; }
        public virtual ICollection<Job> Jobs { get; set; }
        public virtual Job ParentJob { get; set; }
        public virtual ICollection<Quote> Quotes { get; set; }
        public virtual ICollection<WorkTime> WorkTimes { get; set; }
        public virtual ENUM_JobState JobState { get; set; }
    }

public class Customer
{
        public Customer()
        {
            this.Customers = new List<Customer>();
            this.Jobs = new List<Job>();
        }

   public long ID { get; set; }
   public string Name { get; set; }
   public Nullable<long> ParentID { get; set; }
   public string InvoiceEmail { get; set; }
   public virtual ICollection<Customer> Customers { get; set; }
   public virtual Customer ParentCustomer { get; set; }
   public virtual ICollection<Job> Jobs { get; set; }
}

public class ENUM_JobState
{
        public ENUM_JobState()
        {
            this.Jobs = new List<Job>();
        }

        public byte ID { get; set; }
        [Required]
        public string Value { get; set; }

        public virtual ICollection<Job> Jobs { get; set; }
}

public class ENUM_JobStateMap : EntityTypeConfiguration<ENUM_JobState>
    {
        public ENUM_JobStateMap()
        {
            // Primary Key
            this.HasKey(t => t.ID);

            // Properties
            this.Property(t => t.Value)
                .HasMaxLength(100);

            // Table & Column Mappings
            this.ToTable("ENUM_JobStates");
            this.Property(t => t.ID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity).IsRequired(); 
            this.Property(t => t.Value).HasColumnName("Value");

        }
    }

public class JobMap : EntityTypeConfiguration<Job>
    {
        public JobMap()
        {
            // Primary Key
            this.HasKey(t => t.ID);

            // Properties
            this.Property(t => t.JobName)
                .HasMaxLength(50);

            this.Property(t => t.Description)
                .HasMaxLength(100);

            // Table & Column Mappings
            this.ToTable("Jobs");
            this.Property(t => t.ID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity).IsRequired();
            this.Property(t => t.JobName).HasColumnName("JobName");
            this.Property(t => t.Description).HasColumnName("Description");
            this.Property(t => t.CustomerID).HasColumnName("CustomerID");
            this.Property(t => t.JobStateID).HasColumnName("JobStateID");
            this.Property(t => t.LimitHours).HasColumnName("LimitHours");
            this.Property(t => t.ParentID).HasColumnName("ParentID");
            this.Property(t => t.HardDeadline).HasColumnName("HardDeadline");
            this.Property(t => t.SoftDeadline).HasColumnName("SoftDeadline");
            this.Property(t => t.Priority).HasColumnName("Priority");
            this.Property(t => t.Progress).HasColumnName("Progress");

            // Relationships
            this.HasOptional(t => t.Customer)
                .WithMany(t => t.Jobs)
                .HasForeignKey(d => d.CustomerID);
            this.HasOptional(t => t.ParentJob)
                .WithMany(t => t.Jobs)
                .HasForeignKey(d => d.ParentID);

            this.HasRequired(t => t.JobState)
                .WithMany(t => t.Jobs)
                .HasForeignKey(t => t.JobStateID);
              //.HasForeignKey(d => d.JobStateID);

        }
    }

public class CustomerMap : EntityTypeConfiguration<Customer>
{
    public CustomerMap()
    {
        // Primary Key
        this.HasKey(t => t.ID);

        // Properties
        this.Property(t => t.Name)
            .HasMaxLength(80);

        this.Property(t => t.InvoiceEmail)
            .HasMaxLength(80);

        // Table & Column Mappings
        this.ToTable("Customers");
        this.Property(t => t.ID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity).IsRequired(); 
        this.Property(t => t.Name).HasColumnName("Name");
        this.Property(t => t.ParentID).HasColumnName("ParentID");
        this.Property(t => t.InvoiceEmail).HasColumnName("InvoiceEmail");

        // Relationships
        this.HasOptional(t => t.ParentCustomer)
            .WithMany(t => t.Customers)
            .HasForeignKey(d => d.ParentID);

    }
} 
```

发生错误的我的 MVC3 控制器：

```
 [HttpPost]
    public ActionResult Edit(Job job)
    {
        if (ModelState.IsValid)
        {
            if (job.ParentJob != null || string.IsNullOrWhiteSpace(job.ParentJob.JobName))
                job.ParentJob = null;
            job.JobState = ENUM_JobState.CreateIfNotExist2(job.JobState.Value, db);
            job.Customer = Customer.CreateIfNotExist2(job.Customer.Name, db);

            //db.Jobs.Attach(job);
            db.Entry(job).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(job);
    } 
```

我正在使用 AJAX 自动完成和 CreateIfNotExist2 函数查找键入的值，或者如果它们不存在则创建它们。

上线抛出异常`db.Entry(job).State = EntityState.Modified;`：

```
A referential integrity constraint violation occurred: The property values that define the referential constraints are not consistent between principal and dependent objects in the relationship. 
```

一个如此通用的例外，这并不好笑。我在这里和其他地方尝试了很多明显的解决方案的排列。

我难住了。

1）有什么问题？2）如果实体不存在，是否有更好的 MVC/EF 方法来创建实体，然后选择？

# java - 为什么要在 ResultSet 和 Connection 实例上调用 close()？

> ID：11731651
> 
> 赞同：12
> 
> 时间：2012-07-31T00:44:43.653
> 
> 标签：java, jdbc, connection, resultset

当我不再需要在我的程序中使用这些 ResultSet 和 Connection 的实例时，我为什么要对它们都调用 .close() 方法？

不这样做有什么危险（如果有的话）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T00:59:15.280

这里有两个问题：

### 数据库连接

保持数据库连接打开会消耗数据库上的资源；它使用内存，并且数据库配置为具有最大连接数，因此您增加连接用完的可能性。会话的状态也会得到维护，因此您可能会遇到意外持有超出其预期范围的锁的麻烦。

积极的一面是，预编译语句保持编译状态并可供使用，因此如果您正确编码和使用 SQL，您可以通过重用预编译语句获得显着的性能优势。但是，这样做可能会使您的代码复杂化，因此建议您小心。

此外，获取连接的成本非常高，这就是存在[连接池](http://en.wikipedia.org/wiki/Connection_pool)的原因。这些使连接保持打开状态，但客户端获取连接，使用它们，然后在完成后将它们释放回池中。

### 结果集

如果你不保持结果集打开也会保持某些锁打开`commit`（关闭然后结果集），因此根据你的应用程序，你可以快速遇到死锁或严重的活力问题。无论您是否保持连接打开，请始终尽快关闭您的结果集，以将尽可能多的资源释放回数据库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-31T00:52:09.807

`*.close()`允许对象实例释放对它可能持有的资源的引用。

在 a 的情况下，`ResultSet`这可能是相当数量的其他对象。GC 最终会清理它们——如果你“放开” `ResultSet`. 进入是一个好习惯。

一个`Connection`对象将持有与连接关联的资源。在这种情况下，GC 永远不会直接恢复这些资源（如果`Connection`实现`finalize`方法可能间接恢复）。您想要`*.close()`任何可能占用任何有限性质的资源的东西，以便可以重用这些资源。

例如，对连接数设置一些上限并不少见。如果您尽快释放这些资源，您将获得更好的响应和更少的失败可能性。

在这**两种**情况下，关闭*都可以*提高代码的整体响应能力；这是一个不错的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T00:49:06.217

通过不关闭 JDBC 连接，您增加了长时间等待空闲 JDBC 连接在使用连接池时获得的可能性。关闭 JDBC 连接将允许更快的重用并提高性能。

未能关闭结果集可能会导致某些数据库无法释放游标资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-19T11:41:17.637

如果您没有关闭结果集对象，您可能会在长时间运行代码时遇到内存不足错误。当我错过关闭它并直接将结果集引用设为空时，我遇到了内存不足错误。我用过 MySQL 数据库。

# php - 选择所有非星期三且仅 30 天前的记录

> ID：11731653
> 
> 赞同：0
> 
> 时间：2012-07-31T00:44:51.503
> 
> 标签：php, mysql

我想知道如何查询数据库以选择不属于特定日期的所有记录。在这种情况下，我想选择所有不是星期三的记录。我在 MySQL 数据库中的日期列是“日期”前。2012 年 9 月 10 日。

我的“伪”选择如下：

```
SELECT * FROM mytable WHERE date NOT IN(SELECT* FROM mytable WHERE date = WED) 
```

有谁知道正确的语法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:50:04.993

你想要的是 WEEKDAY() 函数。

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_weekday](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_weekday)

2 = 星期三

```
select *
from mytable
where date >= CURDATE() - INTERVAL 30 DAY and
      WEEKDAY(date) <> 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T00:48:45.223

试试这个查询：

`select * from mytable where dayofweek(date)!=4;`

# r - 是否可以让函数识别它们上方范围内的变量？

> ID：11731654
> 
> 赞同：2
> 
> 时间：2012-07-31T00:44:53.930
> 
> 标签：r

我在 R 工作，我想做，例如，

```
printx <- function() {
  x <- 1
  printy()
  return(x)
}

printy <- function() {
  print(x)
} 
```

因为我不想继续传递大量变量（此外，全局环境中没有 x ）。有没有办法做到这一点？所有函数都可以访问全局环境，但是函数环境和全局之间的那些呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T00:58:15.967

也许

```
printx <- function() {
  x <- 1
  printy()
  return(x)
}

printy <- function() {
  print(get('x',envir=parent.frame()))
}

> x<-0
> printy()
[1] 0
> printx()
[1] 1
[1] 1 
```

这将使用与调用函数的环境相关联的`x`要打印的。`printy`

另一种可能性是创造一个新的环境

```
e1<-new.env(parent = baseenv())

> assign('x',12,envir=e1)
> x
[1] 0
> get('x',e1)
[1] 12 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T01:45:03.170

您可以使用闭包来获得类似的结果，而不会产生与上述风险相关的风险。在不确切知道您要做什么的情况下，很难提出一个相关的例子。但下面的代码可能很有趣......

```
create.functions <- function(x){
    list(
        function() x,
        function() x+1,
        function() x^2
    )

}

x <- 0

f1 <- create.functions(5)
f1[[1]]()
[1] 5
f1[[2]]()
[1] 6
f1[[3]]()
[1] 25

f2 <- create.functions(3)
f2[[1]]()
[1] 3
f2[[2]]()
[1] 4
f2[[3]]()
[1] 9

x
[1] 0 
```

请注意，您可以创建一组共享相同参数 x 的函数，而不会在参数 x 和全局环境中的 x 值之间产生任何冲突。如果您需要一组新的函数，其中 x 的参数定义不同，您可以创建一个新的集合。

这甚至可以这样工作，以便在更改参数值时不需要编辑依赖于函数套件的代码：

```
f <- create.functions(5)
f[[1]]()/f[[3]]()
[1] 0.2

f <- create.functions(3)
f[[1]]()/f[[3]]()
[1] 0.3333333 
```

请注意，同一行代码`f[[1]]()/f[[3]]()`会根据参数 x 的定义方式返回不同的结果。

# mysql - 如何对联合查询进行计数

> ID：11731655
> 
> 赞同：45
> 
> 时间：2012-07-31T00:45:15.840
> 
> 标签：mysql, sql, union, aggregate-functions

我有以下查询：

```
select distinct profile_id from userprofile_...

union

select distinct profile_id from productions_... 
```

我将如何获得结果总数的计数？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-07-31T00:47:06.267

如果您想要所有记录的总数，那么您可以这样做：

```
SELECT COUNT(*)
FROM
(
    select distinct profile_id 
    from userprofile_...

    union all

    select distinct profile_id 
    from productions_...
) x 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-31T00:48:19.590

`Union All`如果两个表中都有相等的行，则应该使用，因为 Union 会产生不同的

```
select count(*) from 
(select distinct profile_id from userprofile_...

union ALL

select distinct profile_id from productions_...) x 
```

在这种情况下，如果你在两个表中都得到相同`Profile_Id`的（id 可能是一个数字，所以它是可能的），那么如果你使用`Union`，如果你`Id = 1`在两个表中都有`tables`，你将丢失一行（它会出现一次而不是两次）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-31T01:08:33.683

这将表现得很好：

```
select count(*) from (
    select profile_id
    from userprofile_...
    union
    select profile_id
    from productions_...
) x 
```

使用`union`保证不同的值 -`union`删除重复项，`union all`保留它们。这意味着您不需要`distinct`关键字（其他答案没有利用这一事实并最终做更多的工作）。

### 编辑：

如果要计算每个中不同 profile_id 的总数，其中出现在两个表中的给定值被视为*不同*的值，请使用以下命令：

```
select sum(count) from (
    select count(distinct profile_id) as count
    from userprofile_...
    union all
    select count(distinct profile_id)
    from productions_...
) x 
```

此查询将胜过所有其他答案，因为数据库可以比联合列表更快地有效地计算表中的不同值。只需将`sum()`两个计数相加。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-09-03T13:38:58.673

如果在 COUNT(*) 之一中结果等于 0，这些将不起作用。

这会更好：

```
选择总和（总计）
从
(
    选择 COUNT(distinct profile_id) 作为总计
    来自用户配置文件_...

    联合所有

    选择 COUNT(distinct profile_id) 作为总计
    从制作_...
） X

```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-31T00:48:08.200

正如 omg ponies 已经指出，在 UNION 中使用 distinct 是没有用的，你可以在你的情况下使用 UNION ALL .....

```
SELECT COUNT(*) 
FROM 
( 
select distinct profile_id from userprofile_...
union all
select distinct profile_id from productions_...
) AS t1 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-09-24T09:45:02.057

最好的解决方案是添加两个查询结果的计数。如果表包含大量记录，这不会有问题。而且您不需要使用联合查询。前任：

```
SELECT (select COUNT(distinct profile_id) from userprofile_...) + 
(select COUNT(distinct profile_id) from productions_...) AS total 
```

# facebook-graph-api - Facebook 打开图形标签错误（地理点）

> ID：11731657
> 
> 赞同：1
> 
> 时间：2012-07-31T00:45:57.910
> 
> 标签：facebook-graph-api, facebook-opengraph, geopoints

以下元标记产生下面的 linter 警告。我在一两个博客上读到 facebook 不再使用这些标签，但考虑到它们的界面，我很难相信它。有没有人看到任何问题？

```
 <meta property="og:latitude" content="27.41076"> 
  <meta property="og:longitude" content="-82.65850"> 
  <meta property="og:street-address" content="5441 Gulf of Mexico Drive"> 
  <meta property="og:locality" content="Longboat Key"> 
  <meta property="og:region" content="FL"> 
  <meta property="og:postal-code" content="34228"> 
  <meta property="og:country-name" content="USA"> 
  <meta property="og:locale" content="en_us" /> 
```

* * *

![在此处输入图像描述](../Images/f579f3d654f56c1536ed635f52586b66.png)

* * *

**应该修复的开放图警告**

无关属性：此类型的对象不允许名为“og:latitude”的属性。

无关属性：此类型的对象不允许名为“og:longitude”的属性。

无关属性：此类型的对象不允许名为“og:street-address”的属性。

无关属性：此类型的对象不允许名为“og:locality”的属性。

无关属性：此类型的对象不允许名为“og:region”的属性。

无关属性：此类型的对象不允许名为“og:postal-code”的属性。

无关属性：此类型的对象不允许名为“og:country-name”的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:22:55.913

元标记应以您的命名空间开头，例如

```
<meta property="place:location:latitude" content="45.50251415561716" /> 
<meta property="place:location:longitude" content="-73.5713430027785" /> 
<meta property="place:location:altitude" content="42" /> 
```

[在https://developers.facebook.com/docs/opengraph/complextypes/#geopoint](https://developers.facebook.com/docs/opengraph/complextypes/#geopoint)查看更多信息

[在http://philippeharewood.com/facebook/geopoint.html](http://philippeharewood.com/facebook/geopoint.html)上查看它的实际应用

*警告*：调试器当前存在错误：http: [//developers.facebook.com/bugs/432088663509632](http://developers.facebook.com/bugs/432088663509632)

# git - 无法通过 gitolite/Redmine 克隆/提交 git 存储库

> ID：11731659
> 
> 赞同：2
> 
> 时间：2012-07-31T00:46:42.920
> 
> 标签：git, redmine, gitolite

我正在尝试使用 gitolite 设置 Redmine 并使用本指南[http://nsaunders.wordpress.com/2012/04/24/redmine-gitolite-integration/](http://nsaunders.wordpress.com/2012/04/24/redmine-gitolite-integration/)

一切似乎都运行良好，存储库是通过 Redmine 创建的（我在 gitolite/repositories 下看到了存储库）。但是，当我尝试使用以下命令初始化存储库时，我不断收到相同的错误消息

```
mkdir nwi
cd nwi
git init
touch readme.txt
git add readme.txt
git commit -m 'Initializing T repository'
git remote add origin gitolite@localhost:nwi.git
git push -u origin master

Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

用户的公钥在 gitolite 的 autohorized_keys 中。用户在我尝试提交的存储库的 gitolite.conf 中。我是 git 新手，尝试了一千种方法，但无法正常工作。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:26:52.340

这是一个 ssh 身份验证问题，而不是 git 问题。您通常会查看`/var/log/secure`或类似内容以了解 ssh 拒绝连接的原因。您要确保：

*   公钥在`authorized_keys`文件中，
*   此文件的格式正确（没有复制和粘贴错误等）
*   该`authorized_keys`文件的权限为`600`( `rw-------`)
*   该`.ssh`目录的权限为`700`( `rwx------`)
*   一切归`gitolite`用户所有

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-04T16:50:24.723

1.  生成您自己的密钥对。作为您自己的用户执行

    ```
    cd ~/.ssh
    ssh-keygen -t rsa 用户名
    ```

2.  确保您的公钥 (username.pub) 已上传到 gitolite /keydir 文件夹中。由于您已将 redmine 与 gitolite 捆绑在一起，这可能意味着 redmine 正在管理这些公钥，您需要将它们上传到 Redmine，以便 Redmine 可以更新管理存储库。请注意，您不能手动添加密钥，您需要提交并通过管理存储库推送它们（在您的情况下，redmine 应该这样做）

3.  在 gitolite 中注册您的公钥后，尝试在系统中注册您自己的密钥：

    ```
    执行 ssh 代理 bash
    ssh-add ~/.ssh/private-key-name
    ```

再次尝试连接

# python - Python：制作返回同一类方法的类方法装饰器

> ID：11731664
> 
> 赞同：1
> 
> 时间：2012-07-31T00:47:58.653
> 
> 标签：python, multiprocessing, decorator

我是装饰器的新手，也许这比我第一个装饰器项目所能咀嚼的更多，但我想做的是制作一个`parallel`装饰器，它接受一个看起来谦逊地应用于单个参数的函数，并自动分发它`multiprocessing`并将其转换为适用于参数列表的函数。

我正在跟进对较早问题的[这个非常有用的答案](https://stackoverflow.com/questions/11726809/python-efficient-workaround-for-multiprocessing-a-function-that-is-a-data-membe)，因此我可以成功地腌制类实例方法，并且我可以获得像那里的答案这样的示例，并且工作得很好。

这是我第一次尝试并行装饰器（在咨询了一些关于线程装饰器的网络点击之后）。

```
###########
# Imports #
###########
import types, copy_reg, multiprocessing as mp
import pandas, numpy as np
### End Imports

##################
# Module methods #
##################

# Parallel decorator
def parallel(f):

    def executor(*args):
        _pool   = mp.Pool(2)
        _result = _pool.map_async(f, args[1:])
        # I used args[1:] because the input will be a
        # class instance method, so gotta skip over the self object.
        # but it seems like there ought to be a better way...

        _pool.close()
        _pool.join()
        return _result.get()
    return executor
### End parallel

def _pickle_method(method):
    func_name = method.im_func.__name__
    obj = method.im_self
    cls = method.im_class
    cls_name = ''
    if func_name.startswith('__') and not func_name.endswith('__'):
        cls_name = cls.__name__.lstrip('_')
    if cls_name:
        func_name = '_' + cls_name + func_name
    return _unpickle_method, (func_name, obj, cls)
### End _pickle_method

def _unpickle_method(func_name, obj, cls):
    for cls in cls.mro():
        try:
            func = cls.__dict__[func_name]
        except KeyError:
            pass
        else:
            break
    return func.__get__(obj, cls)
### End _unpickle_method

# This call to copy_reg.pickle allows you to pass methods as the first arg to
# mp.Pool methods. If you comment out this line, `pool.map(self.foo, ...)` results in
# PicklingError: Can't pickle <type 'instancemethod'>: attribute lookup
# __builtin__.instancemethod failed
copy_reg.pickle(types.MethodType, _pickle_method, _unpickle_method)
copy_reg.pickle(types.FunctionType, _pickle_method, _unpickle_method)
### End Module methods

##################
# Module classes #
##################
class Foo(object):

    def __init__(self, args):
        self.my_args = args
    ### End __init__

    def squareArg(self, arg):
        return arg**2
    ### End squareArg

    def par_squareArg(self):
        p = mp.Pool(2) # Replace 2 with the number of processors.
        q = p.map_async(self.squareArg, self.my_args)

        p.close()
        p.join()

        return q.get()
    ### End par_SquarArg

    @parallel
    def parSquare(self, num):
        return self.squareArg(num)
    ### End parSquare
### End Foo
### End Module classes

###########
# Testing #
###########
if __name__ == "__main__":

    myfoo = Foo([1,2,3,4])
    print myfoo.par_squareArg()
    print myfoo.parSquare(myfoo.my_args)

### End Testing 
```

但是当我使用这种方法时（愚蠢地尝试用相同的`_pickle_method`和强大的臂酸洗功能`_unpickle_method`）我首先得到一个错误，`AttributeError: 'function' object has no attribute 'im_func'`但更一般地说，该错误表示函数不能被酸洗。

所以这个问题是双重的。（1）如何修改装饰器，如果`f`它获取的对象是一个类的实例方法，那么`executor`它返回的也是该类对象的实例方法（这样这个关于无法腌制的业务就不会发生了，因为我*可以*腌制那些实例方法）？`_pickle_function`(2) 创建附加方法和`_unpickle_function`方法更好吗？我认为 Python 可以腌制模块级函数，所以如果我的代码没有导致`executor`成为实例方法，那么它似乎应该是模块级函数，但是为什么不能腌制呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T09:57:40.730

> （1）如何修改decorator，如果它取的f对象是一个类的实例方法，那么它返回的executor也是那个类对象的实例方法（这样这个业务就没法pickle了不会发生，因为我可以腌制那些实例方法）？

```
>>> myfoo.parSquare
<bound method Foo.executor of <__main__.Foo object at 0x101332510>> 
```

如您所见， parSquare 实际上是已成为实例方法的执行程序，这不足为奇，因为装饰器是某种函数包装器...

[如何制作功能装饰器链？](https://stackoverflow.com/questions/739654/understanding-python-decorators)可能对装饰器有最好的描述。

> (2) 创建额外的 _pickle_function 和 _unpickle_function 方法更好吗？

你不需要 python 已经支持它们，事实上这`copy_reg.pickle(types.FunctionType, _pickle_method, _unpickle_method)`似乎有点奇怪，因为你使用相同的算法来腌制这两种类型。

现在更大的问题是，为什么我们得到`PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed`的错误本身看起来有些模糊，但看起来它无法查找我们的函数？
我认为发生的事情是装饰器正在用您的情况内部定义的函数覆盖该函数，`parSquare`但`executor`它`executor`是一个内部函数，`parallel`因此它是不可导入的，因此查找似乎失败了，这只是一种预感。

让我们尝试一个更简单的例子。

```
>>> def parallel(function):                        
...     def apply(values):
...         from multiprocessing import Pool
...         pool = Pool(4)
...         result = pool.map(function, values)
...         pool.close()
...         pool.join()
...         return result    
...     return apply
... 
>>> @parallel
... def square(value):
...     return value**2
... 
>>> 
>>> square([1,2,3,4])
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/threading.py", line 522, in __bootstrap_inner
    self.run()
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/threading.py", line 477, in run
    self.__target(*self.__args, **self.__kwargs)
  File "/System/Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/multiprocessing/pool.py", line 225, in _handle_tasks
    put(task)
PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed 
```

我们得到的错误几乎相同。
注意上面的代码等价于：

```
def parallel(function):                        
    def apply(values):
        from multiprocessing import Pool
        pool = Pool(4)
        result = pool.map(function, values)
        pool.close()
        pool.join()
        return result    
    return apply    

def square(value):
    return value**2

square = parallel(square) 
```

这会产生相同的错误，还请注意，如果我们不重命名函数。

```
>>> def parallel(function):                        
...     def apply(values):
...         from multiprocessing import Pool
...         pool = Pool(4)
...         result = pool.map(function, values)
...         pool.close()
...         pool.join()
...         return result    
...     return apply    
... 
>>> def _square(value):
...     return value**2
... 
>>> square = parallel(_square)
>>> square([1,2,3,4])
[1, 4, 9, 16]
>>> 
```

它工作得很好，我一直在寻找一种方法来控制装饰器使用名称的方式，但无济于事，我仍然想将它们与多处理一起使用，所以我想出了一个有点丑陋的解决方法：

```
>>> def parallel(function):                
...     def temp(_):    
...         def apply(values):
...             from multiprocessing import Pool
...             pool = Pool(4)
...             result = pool.map(function, values)
...             pool.close()
...             pool.join()
...             return result    
...         return apply
...     return temp
... 
>>> def _square(value):
...     return value*value    
... 
>>> @parallel(_square)
... def square(values):
...     pass 
... 
>>> square([1,2,3,4])
[1, 4, 9, 16]
>>> 
```

所以基本上我将真正的函数传递给了装饰器，然后我使用了第二个函数来处理这些值，你可以看到它工作得很好。

我稍微修改了您的初始代码以更好地处理装饰器，尽管它并不完美。

```
import types, copy_reg, multiprocessing as mp

def parallel(f):    
    def executor(*args):
        _pool   = mp.Pool(2)
        func = getattr(args[0], f.__name__) # This will get the actual method function so we can use our own pickling procedure
        _result = _pool.map(func, args[1])
        _pool.close()
        _pool.join()
        return _result
    return executor

def _pickle_method(method):
    func_name = method.im_func.__name__
    obj = method.im_self
    cls = method.im_class
    cls_name = ''
    if func_name.startswith('__') and not func_name.endswith('__'):
        cls_name = cls.__name__.lstrip('_')
    if cls_name:
        func_name = '_' + cls_name + func_name
    return _unpickle_method, (func_name, obj, cls)

def _unpickle_method(func_name, obj, cls):
    func = None
    for cls in cls.mro():        
        if func_name in cls.__dict__:
            func = cls.__dict__[func_name] # This will fail with the decorator, since parSquare is being wrapped around as executor             
            break
        else:
            for attr in dir(cls):
                prop = getattr(cls, attr)                
                if hasattr(prop, '__call__') and prop.__name__ == func_name:
                    func = cls.__dict__[attr]
                    break
    if func == None:
        raise KeyError("Couldn't find function %s withing %s" % (str(func_name), str(cls)))        
    return func.__get__(obj, cls)

copy_reg.pickle(types.MethodType, _pickle_method, _unpickle_method)

class Foo(object):
    def __init__(self, args):
        self.my_args = args
    def squareArg(self, arg):
        return arg**2
    def par_squareArg(self):
        p = mp.Pool(2) # Replace 2 with the number of processors.
        q = p.map(self.squareArg, self.my_args)
        p.close()
        p.join()
        return q    
    @parallel
    def parSquare(self, num):
        return self.squareArg(num)  

if __name__ == "__main__":
    myfoo = Foo([1,2,3,4])
    print myfoo.par_squareArg()
    print myfoo.parSquare(myfoo.my_args) 
```

基本上这仍然失败，`AssertionError: daemonic processes are not allowed to have children`因为子进程试图调用函数，所以给我们，请记住，子进程并没有真正复制代码只是名称......

一种解决方法类似于我之前提到的一种：

```
import types, copy_reg, multiprocessing as mp

def parallel(f):    
    def temp(_):
        def executor(*args):
            _pool   = mp.Pool(2)
            func = getattr(args[0], f.__name__) # This will get the actual method function so we can use our own pickling procedure
            _result = _pool.map(func, args[1])
            _pool.close()
            _pool.join()
            return _result        
        return executor
    return temp

def _pickle_method(method):
    func_name = method.im_func.__name__
    obj = method.im_self
    cls = method.im_class
    cls_name = ''
    if func_name.startswith('__') and not func_name.endswith('__'):
        cls_name = cls.__name__.lstrip('_')
    if cls_name:
        func_name = '_' + cls_name + func_name
    return _unpickle_method, (func_name, obj, cls)

def _unpickle_method(func_name, obj, cls):
    func = None
    for cls in cls.mro():        
        if func_name in cls.__dict__:
            func = cls.__dict__[func_name] # This will fail with the decorator, since parSquare is being wrapped around as executor             
            break
        else:
            for attr in dir(cls):
                prop = getattr(cls, attr)                
                if hasattr(prop, '__call__') and prop.__name__ == func_name:
                    func = cls.__dict__[attr]
                    break
    if func == None:
        raise KeyError("Couldn't find function %s withing %s" % (str(func_name), str(cls)))        
    return func.__get__(obj, cls)

copy_reg.pickle(types.MethodType, _pickle_method, _unpickle_method)

class Foo(object):
    def __init__(self, args):
        self.my_args = args
    def squareArg(self, arg):
        return arg**2
    def par_squareArg(self):
        p = mp.Pool(2) # Replace 2 with the number of processors.
        q = p.map(self.squareArg, self.my_args)
        p.close()
        p.join()
        return q
    def _parSquare(self, num):    
        return self.squareArg(num)
    @parallel(_parSquare)
    def parSquare(self, num):
        pass    

if __name__ == "__main__":
    myfoo = Foo([1,2,3,4])
    print myfoo.par_squareArg()
    print myfoo.parSquare(myfoo.my_args)

[1, 4, 9, 16]
[1, 4, 9, 16] 
```

最后一件事，多线程时要非常小心，这取决于您如何分割数据，实际上多线程的时间可能比单线程慢，这主要是由于来回复制值以及创建和销毁子进程的开销。

始终对单/多线程进行基准测试，并在可能的情况下正确分割您的数据。

一个例子：

```
import numpy
import time
from multiprocessing import Pool

def square(value):
    return value*value

if __name__ == '__main__':
    pool = Pool(5)
    values = range(1000000)
    start = time.time()
    _ = pool.map(square, values)
    pool.close()
    pool.join()
    end = time.time()

    print "multithreaded time %f" % (end - start)
    start = time.time()
    _ = map(square, values)
    end = time.time()
    print "single threaded time %f" % (end - start)

    start = time.time()
    _ = numpy.asarray(values)**2
    end = time.time()
    print "numpy time %f" % (end - start)

    v = numpy.asarray(values)
    start = time.time()
    _ = v**2
    end = time.time()
    print "numpy without pre-initialization %f" % (end - start) 
```

给我们：

```
multithreaded time 0.484441
single threaded time 0.196421
numpy time 0.184163
numpy without pre-initialization 0.004490 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-31T02:28:37.130

好吧，这不是您要寻找的答案，但是 Sage 有一个`@parallel`符合您要寻找的内容的装饰器。您可以在线找到[文档](http://www.sagemath.org/doc/reference/sage/parallel/decorate.html)和[源代码](http://hg.sagemath.org/sage-main/file/90cdc6a8ad4e/sage/parallel)。

但是，作为一般规则，`import pdb;pdb.set_trace()`请在您看到失败的行之前添加并检查所有可见的对象。如果您正在使用`ipython`，您可以只使用魔法命令或[按照这些方式](https://stackoverflow.com/questions/4234612/launch-an-ipython-shell-on-exception)`%pdb`做一些事情。

# php - 表达式引擎 - 计数标签仅从 1 开始计数

> ID：11731666
> 
> 赞同：0
> 
> 时间：2012-07-31T00:48:03.397
> 
> 标签：php, javascript, count, expressionengine

我有一个 javascript 声音播放器，它根据 dom 元素中的数据计数属性播放来自网站的项目。该 data-count 属性在每个 dom 元素元素中使用表达式引擎的 {count} 标签递增。问题是，{count} 从 1 开始编入索引，我需要从 0 开始编入索引。任何人都知道如何解决这个问题，即在我的模板中使用 PHP 从 count 变量中减去 1，然后再将其分配给DOM 元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T00:51:16.080

每次引用计数（在 javascript-player 中）时，您都可以减去 1。 IE：`var c=count-1;`
这对您有用吗？

有关与您相同问题的解决方案，请参阅expressionengine.com 上的[此帖子。](http://expressionengine.com/forums/viewreply/973055/)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T10:46:08.973

因为我需要它在初始解析阶段吐出正确的数字，所以我为此开发了一个插件。如果你有这个问题，你可以在这里下载插件：

[http://devot-ee.com/add-ons/mh-index](http://devot-ee.com/add-ons/mh-index)

# c# - 这个示例线程安全吗？

> ID：11731679
> 
> 赞同：3
> 
> 时间：2012-07-31T00:49:39.447
> 
> 标签：c#, .net, multithreading, thread-safety

假设我有充当数据缓存的单例类。多个线程将从缓存中读取，单个线程会定期刷新它。它看起来像这样：

```
public sealed class DataStore
{
    public static DataStore Instance { get { return _instance; } }
    public Dictionary<Foo, Bar> FooBar { get; private set; }

    static DataStore() { }
    private DataStore() { }

    public void Refresh() {
        FooBar = GetFooBarFromDB();
    }

    private static readonly DataStore _instance = new DataStore();
} 
```

我的问题本质上是，`Refresh()`当其他线程可能正在访问时是否安全`FooBar`？我需要使用锁，还是我的获取和设置操作是原子的？我是否需要明确声明`volatile`字段来备份我的属性？

PS，如果有人能为这个问题想出一个更具描述性的标题，我会很高兴地欢迎它。

**编辑：**修复了我的示例以更正明显的非原子代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T00:54:18.990

是的，在这种情况下您需要显式同步，因为另一个线程可以`FooBar`在您完成写入之前获取并开始读取它。

然而，如果你这样做，

```
public void Refresh() {
    var tmp = new Dictionary<Foo, Bar>();
    // Fill out FooBar from DB
    FooBar = tmp;
} 
```

那么您不需要添加显式同步，因为从一个引用切换到另一个引用是原子的。

当然，这里有一个隐含的假设，即在`Refresh`方法之外没有写。

**编辑：**您还应该从自动实现的属性切换到手动实现的属性，并使用`volatile`修饰符声明后备变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T00:54:19.973

您的示例不是线程安全的。Dictionary 不是线程安全的类，并且在执行 Refresh 时任何线程都可能正在读取。您可以使用 a `lock`around 或使用其中一个线程安全类，例如[`ConcurrentDictionary`](http://msdn.microsoft.com/en-us/library/dd287191.aspx).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:03:28.793

好吧，我们同意您当前的代码*不是*线程安全的。所以，你必须使用同步特性，因为`FooBar`是你的*临界区*。

如果你顺其自然`public`，你会*期望*班外的人`DataStore`会采取相应的行动。然而，这是一个糟糕的设计决策。

因此，我建议您将所有内容包装到您当前的类中，如下所示：[实现线程安全字典的最佳方法是什么？](https://stackoverflow.com/questions/157933/whats-the-best-way-of-implementing-a-thread-safe-dictionary-in-net)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T01:04:27.633

因为您公开地公开字典，所以您编写的代码围绕访问字典本身的方法会遇到更多问题。正如@Icarus 指出的那样，您应该使用`ConcurrentDictionary`，但我认为任何形式的实例锁定都对您没有帮助。

您可以轻松地将一个线程添加到集合中，而另一个线程正在对其进行迭代。

编辑我在说什么.. 永远不要公开静态字典或任何其他集合类型。始终使用并发版本

# asp.net - ASP.NET Web API 中的用户身份验证

> ID：11731683
> 
> 赞同：151
> 
> 时间：2012-07-31T00:50:18.037
> 
> 标签：asp.net, asp.net-web-api

这个话题让我非常困惑。我是 HTTP 应用程序的新手，但需要开发一个从某个地方使用 JSON 数据的 iPhone 客户端。我选择 MS 的 Web API 是因为它看起来很简单，但是在验证用户时，事情变得非常令人沮丧。

我很惊讶在几个小时的谷歌搜索之后，我无法找到一个清晰的例子来说明如何从登录屏幕到`Authorize`在我的方法上使用属性来验证用户。`ApiController`

这不是一个问题，而是要求提供一个如何准确执行此操作的示例。我查看了以下页面：

*   [使您的 ASP.NET Web API 安全](http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/)
*   [使用 ASP.NET Web API 的基本身份验证](http://stevescodingblog.co.uk/basic-authentication-with-asp-net-webapi/)

尽管这些解释了如何处理未经授权的请求，但它们并没有清楚地展示类似 a`LoginController`或类似的东西来请求用户凭据并验证它们。

有人愿意写一个简单的例子或指出正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-07-31T02:32:48.893

> 我很惊讶在几个小时的谷歌搜索之后，我无法找到一个清晰的例子来说明如何从登录屏幕到在我的 ApiController 方法上使用 Authorize 属性对用户进行身份验证。

那是因为您对这两个概念感到困惑：

*   身份验证是系统可以安全地识别其用户的机制。身份验证系统提供了以下问题的答案：

    *   用户是谁？
    *   用户真的是他/她代表自己的那个人吗？
*   授权是系统确定特定经过身份验证的用户对系统控制的安全资源应具有的访问级别的机制。例如，数据库管理系统可能被设计为向某些特定个人提供从数据库中检索信息的能力，但不能更改存储在数据库中的数据的能力，同时赋予其他人更改数据的能力。授权系统提供了以下问题的答案：

    *   用户 X 是否有权访问资源 R？
    *   用户 X 是否被授权执行操作 P？
    *   用户 X 是否有权对资源 R 执行操作 P？

MVC 中的`Authorize`属性用于应用访问规则，例如：

```
 [System.Web.Http.Authorize(Roles = "Admin, Super User")]
 public ActionResult AdministratorsOnly()
 {
     return View();
 } 
```

上述规则将只允许**管理员*和*超级*用户*角色的用户访问该方法**

也可以使用`location`元素在 web.config 文件中设置这些规则。例子：

```
 <location path="Home/AdministratorsOnly">
    <system.web>
      <authorization>
        <allow roles="Administrators"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location> 
```

但是，在执行这些授权规则之前，您必须通过**当前网站的身份验证**。

> 尽管这些解释了如何处理未经授权的请求，但它们并没有清楚地展示像 LoginController 或类似的东西来询问用户凭据并验证它们。

从这里，我们可以将问题一分为二：

*   在同一 Web 应用程序中使用 Web API 服务时对用户进行身份验证

    这将是最简单的方法，因为您将依赖[ASP.Net 中的身份验证](http://msdn.microsoft.com/en-us/library/eeyk640h.aspx)

    这是一个简单的例子：

    ### 网页配置

    ```
    <authentication mode="Forms">
      <forms
        protection="All"
        slidingExpiration="true"
        loginUrl="account/login"
        cookieless="UseCookies"
        enableCrossAppRedirects="false"
        name="cookieName"
      />
    </authentication> 
    ```

    用户将被重定向到*帐户/登录*路径，在那里您将呈现自定义控件以询问用户凭据，然后您将使用以下方式设置身份验证 cookie：

    ```
     if (ModelState.IsValid)
        {
            if (Membership.ValidateUser(model.UserName, model.Password))
            {
                FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                return RedirectToAction("Index", "Home");
            }
            else
            {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model); 
    ```

*   跨平台认证

    这种情况是当您**只在 Web 应用程序中公开 Web API 服务**时，您将有另一个客户端使用这些服务，该客户端可以是另一个 Web 应用程序或任何 .Net 应用程序（Win Forms、WPF、控制台、Windows 服务、 ETC）

    例如，假设您将从同一网络域（内部网）上的另一个 Web 应用程序使用 Web API 服务，在这种情况下，您可以依赖 ASP.Net 提供的 Windows 身份验证。

    ```
    <authentication mode="Windows" /> 
    ```

    如果您的服务在 Internet 上公开，那么您需要将经过身份验证的令牌传递给每个 Web API 服务。

    有关更多信息，请查看以下文章：

    *   [http://stevescodingblog.co.uk/basic-authentication-with-asp-net-webapi/](http://stevescodingblog.co.uk/basic-authentication-with-asp-net-webapi/)

    *   [http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/](http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-09-12T23:24:01.450

如果您想根据**用户名和密码**进行身份验证并且**没有授权 cookie**，则 MVC4 [Authorize](http://msdn.microsoft.com/en-us/library/system.web.mvc.authorizeattribute.aspx)属性将无法开箱即用。但是，您可以将以下辅助方法添加到控制器以接受基本身份验证标头。从控制器方法的开头调用它。

```
void EnsureAuthenticated(string role)
{
    string[] parts = UTF8Encoding.UTF8.GetString(Convert.FromBase64String(Request.Headers.Authorization.Parameter)).Split(':');
    if (parts.Length != 2 || !Membership.ValidateUser(parts[0], parts[1]))
        throw new HttpResponseException(Request.CreateErrorResponse(HttpStatusCode.Unauthorized, "No account with that username and password"));
    if (role != null && !Roles.IsUserInRole(parts[0], role))
        throw new HttpResponseException(Request.CreateErrorResponse(HttpStatusCode.Unauthorized, "An administrator account is required"));
} 
```

从客户端，这个助手创建一个`HttpClient`带有身份验证头的：

```
static HttpClient CreateBasicAuthenticationHttpClient(string userName, string password)
{
    var client = new HttpClient();
    client.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Basic", Convert.ToBase64String(UTF8Encoding.UTF8.GetBytes(userName + ':' + password)));
    return client;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-02-16T16:36:10.863

我正在开发一个 MVC5/Web API 项目，需要能够获得 Web Api 方法的授权。当我的索引视图首次加载时，我会调用我认为是自动创建的“令牌”Web API 方法。

获取令牌的客户端代码（CoffeeScript）是：

```
getAuthenticationToken = (username, password) ->
    dataToSend = "username=" + username + "&password=" + password
    dataToSend += "&grant_type=password"
    $.post("/token", dataToSend).success saveAccessToken 
```

如果成功，将调用以下命令，将身份验证令牌保存在本地：

```
saveAccessToken = (response) ->
    window.authenticationToken = response.access_token 
```

然后，如果我需要对具有 [Authorize] 标记的 Web API 方法进行 Ajax 调用，我只需将以下标头添加到我的 Ajax 调用中：

```
{ "Authorization": "Bearer " + window.authenticationToken } 
```

# ios - “未声明”的未知错误

> ID：11731684
> 
> 赞同：0
> 
> 时间：2012-07-31T00:50:28.550
> 
> 标签：ios, xcode, settings

这在早期工作，但现在不是因为它无法识别下面第一个 .m 文件中的设置。我做了#import Setting.h，但它仍然不起作用。请帮忙！

这是.h文件：

```
#import <UIKit/UIKit.h>
#import "EditNameViewController.h"

@interface SettingsViewController : UIViewController <EditNameDelegate>{

IBOutlet UIButton *froshsched;
IBOutlet UIButton *uppersched;

} 
```

.m 文件。它说设置和'设置未声明

```
#import "SettingsViewController.h"
#import "Settings.h"

@interface SettingsViewController ()

@end

@implementation SettingsViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    self.title = NSLocalizedString(@"Settings", @"Settings");
    self.tabBarItem.image = [UIImage imageNamed:@"spanner"];        
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view from its nib.
}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:  (UIInterfaceOrientation)interfaceOrientation
{
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
} else {
    return YES;
}
}

-(IBAction)froshsched{
Settings *settings = [Settings sharedInstance];
settings.timelabelfirst = @"12:35";
settings.timelabelsecond = @"1:25";
[[Settings sharedInstance] save];
}
-(IBAction)uppersched{
Settings *settings = [Settings sharedInstance];
settings.timelabelfirst = @"12:10";
settings.timelabelsecond = @"1:00";
[[Settings sharedInstance] save];
}

-(IBAction)editclass{
EditNameViewController*vc2 = [[EditNameViewController alloc] init];
vc2.delegate = self;
[self presentModalViewController:vc2 animated:YES];
}

-(void)dismiss{
[self dismissModalViewControllerAnimated:YES];
}

@end

-(IBAction)editclass;
-(IBAction)froshsched;
-(IBAction)uppersched; 
```

这是Settings.h

```
#import <Foundation/Foundation.h>

@interface Settings : NSObject

@property (nonatomic) NSString *redClassName, *orangeClassName, *yellowClassName,   *greenClassName, *ltblueClassName, *dkblueClassName, *purpleClassName, *pinkClassName,    *timelabelfirst, *timelabelsecond;

+(Settings*)sharedInstance;
-(void)save;

@end 
```

最后是 Settings.m 文件，我觉得我缺少一些简单的东西，谢谢

```
#import "Settings.h"

@implementation Settings

@synthesize redClassName, orangeClassName, yellowClassName, greenClassName, ltblueClassName,  dkblueClassName, purpleClassName, pinkClassName, timelabelfirst, timelabelsecond;

-(id)init{
self = [super init];
if(self){
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    redClassName = [defaults objectForKey:@"kredClass"];
    orangeClassName = [defaults objectForKey:@"korangeClass"];
    yellowClassName = [defaults objectForKey:@"kyellowClass"];
    greenClassName = [defaults objectForKey:@"kgreenClass"];
    ltblueClassName = [defaults objectForKey:@"kltblueClass"];
    dkblueClassName = [defaults objectForKey:@"kdkblueClass"];
    purpleClassName = [defaults objectForKey:@"kpurpleClass"];
    pinkClassName = [defaults objectForKey:@"kpinkClass"];
    timelabelfirst = [defaults objectForKey:@"ktime1"];
    timelabelsecond = [defaults objectForKey:@"ktime2"];
}
return self;
}

+(Settings*)sharedInstance{
static Settings *sharedSettings;
if(!sharedSettings) sharedSettings = [[Settings alloc] init];
return sharedSettings;
}
-(void)save{
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:redClassName forKey:@"kredClass"];
[defaults setObject:orangeClassName forKey:@"korangeClass"];
[defaults setObject:yellowClassName forKey:@"kyellowClass"];
[defaults setObject:greenClassName forKey:@"kgreenClass"];
[defaults setObject:ltblueClassName forKey:@"kltblueClass"];
[defaults setObject:dkblueClassName forKey:@"kdkblueClass"];
[defaults setObject:purpleClassName forKey:@"kpurpleClass"];
[defaults setObject:pinkClassName forKey:@"kpinkClass"];
[defaults setObject:timelabelfirst forKey:@"ktime1"];
[defaults setObject:timelabelsecond forKey:@"ktime2"];
[defaults synchronize];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:49:02.470

您没有给我们 EditNameController （及其委托）。无论如何，我复制并粘贴了您上面的所有代码，并通过注释掉与 EditNameController 相关的项目，它都编译得很好（当然这些行漂浮在文件底部：

```
-(IBAction)editclass;
-(IBAction)froshsched;
-(IBAction)uppersched; 
```

您也没有在 SettingsViewController.h 的底部显示“@end”（我在编译之前添加了它）。

# emacs - Emacs：当前缓冲区的编码系统

> ID：11731685
> 
> 赞同：7
> 
> 时间：2012-07-31T00:50:45.673
> 
> 标签：emacs, character-encoding

我用pc开发erlang程序，一个是mac os x 10.6，一个是mac os x 10.7。

在`".emacs"`两台电脑的文件中，它包含以下脚本

```
;;handle emacs utf-8 input
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(prefer-coding-system 'utf-8) 
```

但是当我在一台电脑中输入包含汉字的备注并保存，然后下载到另一台电脑时。中文字符无法正确显示。反向操作也是如此。

我想知道如何检查当前文件的编码类型？有没有什么命令可以做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-31T02:20:35.887

我相信你正在寻找`buffer-file-coding-system`. `M-x describe-variable`会告诉你更多关于它的信息，你可以设置它`M-x eval-expression`并使用`(setq buffer-file-coding-system 'coding-system-i-want)`。这会将其设置为单个缓冲区；一旦你让它工作，你可以添加条目`file-coding-system-alist`来永久设置你想要的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T06:51:49.993

你也可以设置

写编码系统 读编码系统

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-11T09:26:04.887

要修改编码系统以使用编码系统 chinese-iso-8bit 读取和写入所有“.txt”文件，您可以执行以下 Lisp 表达式：

```
(modify-coding-system-alist 'file "\\.txt\\'" 'chinese-iso-8bit) 
```

有关更多信息，请参阅[识别编码系统](http://www.gnu.org/software/emacs/manual/html_node/emacs/Recognize-Coding.html)。

# objective-c - UIWebView 如何调整 Word 文档的大小？

> ID：11731690
> 
> 赞同：1
> 
> 时间：2012-07-31T00:51:40.963
> 
> 标签：objective-c, xcode, uiwebview, ms-word

因此，我从 Web 服务接收数据的有效负载，一部分是 MS-Word Doc，另一有效负载是 PDF。PDF 加载到我的 UIWebView 中没有任何问题，但是当我去加载我的 MS-Word 文档时，当屏幕被截断（未完全呈现）时，我得到了屏幕的最外面的部分，我无法缩小以查看更多或任何事物。

我的加载代码如下所示：

```
 strFilename = [strFilename stringByAppendingString:@"."];
        strFilename = [strFilename stringByAppendingString:extension];  
        NSString* documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
        NSString* foofile = [documentsPath stringByAppendingPathComponent:strFilename];
        [data writeToFile:foofile atomically:YES];

        BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:foofile];
        if (fileExists) {
            [myWebView loadRequest:request];
        } 
```

我对 PDF 没有任何问题，但使用 Word，即使代码有效并且数据加载，也只有最右边的 2% 被切掉，这对我的用户来说很烦人。

关于如何让整个文档正确加载到 UIWebView 的任何想法（或者我应该使用不同的视图控制器？

# java - 尝试运行可执行 jar 文件时出现 Java 错误

> ID：11731692
> 
> 赞同：0
> 
> 时间：2012-07-31T00:51:59.727
> 
> 标签：java, file, jar, executable

好的，所以每当我尝试打开一个可执行的 JAR 文件时，它会加载一段时间然后给我一个错误，说它无法启动应用程序。然后，当我单击更多详细信息时，第一个选项卡是随机标记和垃圾邮件，第二个选项卡给了我这个：

![在此处输入图像描述](../Images/1240b58ed8d371ad27e08b4b746fdc9f.png)

我不是计算机专家，但有人告诉我重新安装 Java，我做了很多次，但无济于事。这是我最后的手段。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T07:19:41.907

单击开始菜单> 控制面板> Java > 选择“常规选项卡”，然后在“Internet 临时文件”中单击“设置”按钮，然后单击“删除文件”，然后单击“恢复默认值”。

# python - 2012 年用于 Google App Engine 的专业 Python 框架？

> ID：11731696
> 
> 赞同：0
> 
> 时间：2012-07-31T00:53:28.230
> 
> 标签：python, google-app-engine

我是一名 C#（Windows 应用程序）开发人员，所以在 GAE 上开始使用 Python，我对使用哪些框架（或 API 等）进行“专业网站开发”有点茫然

例如，我看到：Backbone、web2py、django、Enyo、Kendo、Meteor、Node.js 等。

其中一些似乎是完整的 Web 应用程序框架、一些 javascript 框架、一些 javascript UI 框架......我研究中的一些（如 Node.js）似乎不适用于 GAE。

所以我的问题是：**请专业的 Python 开发人员给我一个小型（5 人）开发团队可以追求丰富的“web 2.0”GAE/Python 站点开发的框架的建议吗？**

非常感谢，也很抱歉不具体，只是没有行业经验，很难客观地评价最佳选择。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:03:38.763

在 Web 开发中，客户端 (javascript) 框架大多与服务器端 (python) 框架分开，因此“一个 Python 框架......用于丰富的“web 2.0”开发”没有多大意义——任何[Python Web 框架](http://wiki.python.org/moin/WebFrameworks/)可以作为“web 2.0”应用程序的后端。

因此，基本上，您会找到一个适合您的需求并与 GAE 一起使用的 Python 框架，然后您会找到一个适合您的需求的 JS 框架，并且可能与您的 Python 框架有一个集成层，尽管后者并不重要。

# html - 将图像路径从 excel 电子表格传输到 html 文件

> ID：11731697
> 
> 赞同：0
> 
> 时间：2012-07-31T00:53:30.117
> 
> 标签：html, excel, csv

我正在尝试将具有数百个图像路径的电子表格转换为 html 页面。例如：

```
excel sheet
imageId    imagePath   

1           images/ima1
2           images/ima2
3           images/ima3
...         .........
...          ........ 
```

有没有更快的方法将这些图像转换为 html 文件，而不是一一输入？

我需要的html文件如下：

```
<img src=images/ima1 title='ima1' />
<img src=images/ima2 title='ima2' />
<img src=images/ima3 title='ima3' /> 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:16:09.973

我将在下一列中创建一个公式。假设 images/ima1 在 B2 中，您可以将其放入 C2 中以获取您想要的内容，然后将公式粘贴下来。

```
 ="<img src="&B2&" title='"&RIGHT(B2,LEN(B2)-4)&"' />" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:27:21.390

有几种方法可以做你想做的事。

1\. 在另一张表上，创建一个公式，该公式将从第一张表中获取信息并生成所需的 HTML。

```
="<img src=" & CHAR(34) & INDIRECT("Sheet1!B" &ROW()) & CHAR(34) & " title=" & CHAR(34) & INDIRECT("Sheet1!A" & ROW()) & " />" 
```

假设您的数据在 Sheet1 上，则第二张工作表上的每一行（包含该公式）都将包含 Sheet1 上同一行的 html。（如果不一样，您需要调整工作表名称和列）

这样做，您可以复制并粘贴第二张表中的所有内容。

2\. 使用宏生成文件。

```
 Public Sub GenerateHTML()
    Dim Handle As Integer
    Dim Sheet As Worksheet
    Dim Row As Integer

    Set Sheet = ThisWorkbook.ActiveSheet
    Row = 2

    Handle = FreeFile()

    Open "output.html" For Output As Handle

    Print #Handle, "<html>" & vbNewLine & "<head>" & vbNewLine & "<title>My Gallery...</title>" & vbNewLine & "</head>" & vbNewLine & "<body>"

    Do
        If Sheet.Cells(Row, 1) = "" Then
            Exit Do
        Else
            Print #Handle, "<img src=" & Chr(34) & Sheet.Cells(Row, 2) & Chr(34) & " title=" & Chr(34) & "ima" & Sheet.Cells(Row, 1) & Chr(34) & "/>"
            Row = Row + 1
        End If
    Loop

    Print #Handle, "</body>" & vbNewLine & "</html>"

    Close #Handle

    End Sub 
```

此示例将在与包含所有链接的电子表格相同的目录中创建一个 html 文件。您需要调整它以满足您的需要，因为它可能不太正确。

# ruby - 红宝石镐书说 attr_accessor 是类方法

> ID：11731698
> 
> 赞同：1
> 
> 时间：2012-07-31T00:53:44.133
> 
> 标签：ruby, class, methods, instance, attr-accessor

在红宝石镐的书中，有一句话说

> attr_accessor 是类 Module 中定义的类方法

但不是`attr_accessor`实例方法吗？我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T00:57:57.580

是的，我能找到的所有文档都同意这`attr_accessor`是 Module 的实例方法，我相信它必须是实例而不是类方法才能完成它的工作。

我的猜测是这只是一个错字。作者可能只是试图指出，而不是作为语言本身的一部分，`attr_accessor`朋友只是 Module 类的方法，他们不小心说“类”而不是“实例”。

**更新：**事实上，我在我的副本（10 周年纪念版）中找不到您的报价，虽然它是印刷版而不是 PDF，所以我无法轻松搜索它。我能找到的最接近的是：

> 类属性声明不是 Ruby 语法的一部分：它们只是在类`Module`中定义的自动创建访问器方法的方法。

您引用的那句话很可能是在比您晚的版本中编辑的。

**更新 2：**这正式是一个错字。[在勘误表](http://pragprog.com/titles/ruby3/errata)中列为第 382 页：

> “attr_accessor 是类 Module 中定义的类方法，因此在所有模块和类定义中都可用。”</p>
> 
> 应该是私有实例方法——Dave Thomas

# nsis - NSIS 卸载和安装同时激活

> ID：11731701
> 
> 赞同：0
> 
> 时间：2012-07-31T00:54:16.827
> 
> 标签：nsis, uninstallation

我有一个 NSIS 安装程序，它调用卸载程序来自动卸载旧版本的程序。 [http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new](http://nsis.sourceforge.net/Auto-uninstall_old_before_installing_new)

不幸的是，用户可以单击安装，并在运行卸载之前运行安装程序，然后继续卸载...

卸载激活时，有什么方法可以在后台强制安装程序？

编辑：试图禁用“安装”按钮，

```
 ClearErrors
  ;disable the Install button
  GetDlgItem $R1 $HWNDPARENT 0
  EnableWindow $R1 0
  ...
done:
  ;disable the Install button
  GetDlgItem $R1 $HWNDPARENT 0
  EnableWindow $R1 0 
```

我一直禁用卸载程序上的“关闭”按钮。我以为这部分还在安装程序中...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T14:00:41.627

根据您链接到的代码片段，我认为您无需担心。

.onInit 函数在安装程序 UI 绘制在屏幕上之前执行，因此卸载程序将在用户甚至有机会与安装程序交互之前运行。

只是为了确保您正确理解该代码在做什么，当您运行新安装程序时，它会在注册表中查找旧版本的卸载程序可执行文件的位置，然后弹出一个消息框询问您是否愿意卸载以前的版本。如果单击确定，它将使用 ExecWait 指令执行卸载程序，这将阻止执行下一条指令，直到卸载程序返回（完成）。如果用户单击取消，它将跳过旧版本的卸载。

因为所有这些都是在 .onInit 函数中完成的，所以在旧版本卸载之前，用户没有机会与新版本进行交互。

他们可以在卸载旧版本之前安装新版本的唯一方法是在消息框出现时单击取消。如果您想删除此选项，那么您也可以更改 MessageBox 代码：

```
MessageBox MB_OK|MB_ICONEXCLAMATION \
      "${PROGRAM_NAME} is already installed. $\n$\nClick `OK` to remove the \
       previous version" 
```

您还需要删除MessageBox 指令之后的`IDOK uninst`和行。`Abort`

希望这可以帮助。

脚本的基本格式应为：

```
Function .onInit
    code you linked to goes here
FunctionEnd

Section "Install"
    install stuff goes here
SectionEnd

Section "Uninstall"
    Uninstall stuff goes here
SectionEnd 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:17:32.077

我看不到 .onInit 显示的用户可以点击的任何 UI，因为尚未创建主窗口，但是如果您将代码移到其他地方，您可以使用`HideWindow`+隐藏/显示安装程序[`BringToFront`](http://anders_k.users.sourceforge.net/public/NSIS/2.46/Manual.html#BringToFront)（基本上）或禁用您不希望用户点击的按钮+ 。[`ShowWindow`](http://anders_k.users.sourceforge.net/public/NSIS/2.46/Manual.html#showwindow) `$HWNDPARENT 0|1``GetDlgItem``EnableWindow`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-31T06:05:12.653

如下调用卸载程序。
ExecWait '"$INSTDIR\Uninstall.exe" _?=$INSTDIR'
然后使用**BringToFront**
会隐藏 Installer 直到 Uninstaller 存在。

# ssl - 我可以在丢失原始文件后重新创建 SSL 证书密钥文件吗

> ID：11731707
> 
> 赞同：0
> 
> 时间：2012-07-31T00:55:26.123
> 
> 标签：ssl, openssl, ssl-certificate

我的服务器上有一个密钥文件，但我不小心删除了它。现在我不想等待另一个 ssl 密钥，是否可以为我知道同一服务器上的每个选项的证书重新创建 ssl 证书密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:56:36.540

在正常情况下，没有。这就是密钥的全部意义所在。备份..

# python - 如何使用带有 PyQt4 的 QDBusAbstractAdaptor 在 DBus 上公开方法和属性？

> ID：11731709
> 
> 赞同：2
> 
> 时间：2012-07-31T00:55:50.883
> 
> 标签：python, qt, pyqt4, dbus, qtdbus

我正在尝试使用 PyQt4 在 DBus 上运行一些基本代码，特别是 QtDBus。我正在使用 Python3 版本的 PyQt4。我已经得到了我想在 Qt (c++) 上运行的代码，但我想只使用 Python 来运行类似的代码。我想在 DBus 上公开方法、信号/插槽和属性，以供其他 Python 代码调用。

在 Qt 中，您使用 Q_CLASSINFO 宏/函数来进行 DBus 内省。虽然我引入了 Q_CLASSINFO 方法，但我无法让它产生相同类型的功能。据我所知，关于 Q_CLASSINFO 方法的文档为零，所以我不确定是否还有其他方法。使用 D-Feet 我可以清楚地看到没有自动公开任何方法，所以我有点卡住了。

这是我到目前为止所拥有的。

```
from PyQt4 import QtDBus
from PyQt4.QtCore import QCoreApplication, QObject, Q_CLASSINFO, pyqtSlot, pyqtProperty
from PyQt4.QtDBus import QDBusConnection, QDBusAbstractAdaptor

SERVICE = 'com.home.dbus'

class MyServer(QObject):

    def __init__(self):
        QObject.__init__(self)
        self.__dbusAdaptor = ServerAdaptor(self)

    def close(self):
        pass

    def echo(self, value):
        echoed = 'Received {0}'.format(value)
        return echoed

    def name(self):
        return 'myname'

    def dbus_adaptor(self):
        return self.__dbusAdaptor

class ServerAdaptor(QDBusAbstractAdaptor):
    """ This provides the DBus adaptor to the outside world"""

    def __init__(self, parent):
        super().__init__(parent)
        self.__parent = parent
        Q_CLASSINFO("D-Bus Introspection",
        "  <interface name=\"com.home.dbus\">\n"
        "    <method name=\"name\">\n"
        "      <arg direction=\"out\" type=\"s\" name=\"name\"/>\n"
        "    </method>\n"
        "    <method name=\"echo\">\n"
        "      <arg direction=\"in\" type=\"s\" name=\"phrase\"/>\n"
        "      <arg directory=\"out\" type=\"s\" name=\"echoed\"/>\n"
        "    </method>\n"
        "  </interface>\n")

    def close(self):
        parent.close()

    def echo(self, value):
        return parent.echo(value)

    def name(self):
        return parent.name

def start():
    app = QCoreApplication([])
    if QDBusConnection.sessionBus().isConnected() == False:
        print('Cannot connect to D-Bus session bus')
        return
    print('Starting')
    server = MyServer()
    if not QDBusConnection.sessionBus().registerService(SERVICE):
        print('Unable to register service name')
        return
    if not QDBusConnection.sessionBus().registerObject('/mydbus', server.dbus_adaptor):
        print('Unable to register object at service path')
        return
    app.exec();
    print('Exited')

if __name__ == '__main__':
    start() 
```

虽然我真的很喜欢在 C++ 中使用 QtDBus，因为我想如何构建我的这个大型项目，但我确实需要通过 DBus 访问的对象用 Python3 编写。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-01T22:35:13.343

你的程序有几个问题。我建议查看最新 PyQt 源中的`remotecontrolledcar`示例`pingpong`，它们非常有帮助。需要注意的主要点是：

*   您应该将`MyServer`实例（不是`ServerAdaptor`）传递给`registerObject()`
*   将`pyqtSlot()`装饰器添加到您希望通过 D-Bus 公开的功能
*   `Q_CLASSINFO()`在适配器类的顶部调用，而不是在其`__init__()`函数中
*   还使用设置“D-Bus 接口”`Q_CLASSINFO()`
*   您的自省 XML 包含一个错字（“目录”而不是“方向”）

这是一个适用于我的精简示例（Python 3.2.3/Qt 4.8.2/PyQt 4.9.4）：

```
from PyQt4 import QtDBus
from PyQt4.QtCore import (QCoreApplication, QObject, Q_CLASSINFO, pyqtSlot,
                          pyqtProperty)
from PyQt4.QtDBus import QDBusConnection, QDBusAbstractAdaptor

class MyServer(QObject):

    def __init__(self):
        QObject.__init__(self)
        self.__dbusAdaptor = ServerAdaptor(self)
        self.__name = 'myname'

    def echo(self, value):
        return'Received: {0}'.format(value)

    @property
    def name(self):
        return self.__name

    @name.setter
    def name(self, value):
        self.__name = value

class ServerAdaptor(QDBusAbstractAdaptor):
    """ This provides the DBus adaptor to the outside world"""

    Q_CLASSINFO("D-Bus Interface", "com.home.dbus")
    Q_CLASSINFO("D-Bus Introspection",
    '  <interface name="com.home.dbus">\n'
    '    <property name="name" type="s" access="readwrite"/>\n'
    '    <method name="echo">\n'
    '      <arg direction="in" type="s" name="phrase"/>\n'
    '      <arg direction="out" type="s" name="echoed"/>\n'
    '    </method>\n'
    '  </interface>\n')

    def __init__(self, parent):
        super().__init__(parent)

    @pyqtSlot(str, result=str)
    def echo(self, phrase):
        return self.parent().echo(phrase)

    @pyqtProperty(str)
    def name(self):
        return self.parent().name

    @name.setter
    def name(self, value):
        self.parent().name = value

def start():
    app = QCoreApplication([])
    bus = QDBusConnection.sessionBus()
    server = MyServer()
    bus.registerObject('/mydbus', server)
    bus.registerService('com.home.dbus')
    app.exec()

if __name__ == '__main__':
    start() 
```

# ruby-on-rails - 访问 a 中的一个元素有很多关系

> ID：11731712
> 
> 赞同：0
> 
> 时间：2012-07-31T00:56:29.713
> 
> 标签：ruby-on-rails, ruby, has-many

我有两个具有一对多关系的类。例如：

```
class User 
  has_many :numbers
  ...
end 
```

如何在不使用 for 或 each 的情况下访问用户拥有的一个单独的号码？我试过`user.numbers[2]`了，但没有用（我认为这就像使用基本数组，但显然不是）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T01:00:23.653

首先找到用户

```
user = User.find(1) or user = User.first
user.numbers.first   #this will return the first associated object 
```

# amazon-web-services - 如何将本地 MySQL 数据库导入 RDS 数据库实例？

> ID：11731714
> 
> 赞同：24
> 
> 时间：2012-07-31T00:56:42.960
> 
> 标签：amazon-web-services, mysqldump, amazon-rds

我创建了一个名为 realcardiodb 的 RDS 实例（引擎是 mysql），并从本地主机导出了我的数据库。文件保存在本地，名为 localhostrealcardio.sql

大多数研究表明使用 mysqldump 将数据从本地系统导入 Web 服务器，但我的系统甚至无法识别 mysqldump。

```
C:\xampp\mysql>mysqldump
'mysqldump' is not recognized as an internal or external command, operable program or batch   file. 
```

如果我使用 mysqldump，我该如何解决这个错误？（我的系统上肯定安装了 mysql）

我应该使用更好的实用程序吗？

任何帮助表示赞赏，特别是如果您有将 mysql 导入 aws rds 的经验。

谢谢！丹麦

**2012 年 7 月 31 日更新** 所以我解决了错误。mysqldump 位于 bin 目录 C:\xampp\mysql\bin>mysqldump AWS 提供了将本地数据库上传到 RDS 的以下说明：

```
mysqldump acme | mysql --host=hostname --user=username --password acme 
```

有人可以帮我分解一下吗？

1）第一个'acme'（在mysqldump命令之后）是我本地数据库的名称还是我在本地保存的导出sql文件的名称？

2) 主机名是 IP 地址、公共 DNS、RDS 端点还是两者都不是？

3）我假设的用户名和密码是 RDS 凭据，第二个 acme 是我在 RDS 中创建的数据库的名称。

谢谢！

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-08-01T20:26:06.433

**这就是我对在 MySQl 表中有数据的几个实例执行此操作的方式。**

创建 RDS 数据库实例的步骤：http: [//docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_GettingStarted.CreatingConnecting.MySQL.html](http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_GettingStarted.CreatingConnecting.MySQL.html)

*注意：*确保 RDS 实例配置了与 EC2 安全组相关的安全组。 [http://docs.amazonwebservices.com/AmazonRDS/latest/UserGuide/USER_Workin](http://docs.amazonwebservices.com/AmazonRDS/latest/UserGuide/USER_Workin) ...

在我们继续之前，让我提供以下一些占位符的列表：

*   host.address.for.rds.server = 这将是您的 RDS 描述/设置页面中的“端点”。
*   rdsusername = 您在 RDS 设置期间创建的主用户帐户。
*   rdsdatabase = 您在 RDS 实例上的服务器内创建的空白数据库。
*   backupfile.sql = 由预先存在的安装数据库制作的 sql 转储文件。

创建新的 RDS 数据库实例并配置其安全设置后，登录到此服务器（从 ssh 会话到 EC2 服务器），然后使用基本 SQL 命令在实例内创建一个空数据库。

```
mysql -h host.address.for.rds.server -P 3306 -u rdsusername -p
(enter your password)
create database rdsdatabase; 
```

然后退出 RDS 服务器内的 MySQL 环境。

```
\q 
```

本教程假设您已经拥有旧数据库的备份。如果你不这样做，现在就去创建一个。之后，您就可以将该 sql 转储文件导入 RDS 服务器上等待的空数据库中了。

```
mysql -h host.address.for.rds.server -u rdsusername -p  rdsdatabase < backupfile.sql 
```

可能需要几秒钟才能完成，具体取决于 sql 转储文件的大小。您完成的指示是 bash 命令提示符再次出现。

注意：当将数据直接导入数据库中的现有表时，使用命令“mysqlimport”。看起来我们正在“导入”数据，但这并不是我们在这种情况下实际所做的。我们要迁移到的数据库还没有表，我们使用的 sql 转储文件包含 sql 命令来生成它需要的表。

**确认转账**

现在，如果您没有收到任何错误消息，那么您的 sql 传输可能有效。如果需要，您可以通过连接到您的 RDS 数据库服务器、查找您创建的数据库并检查表现在是否存在来仔细检查它是否存在。

```
mysql -h host.address.for.rds.server -P 3306 -u rdsusername -p
(enter your password)
use rdsdatabase;
show tables; 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-06-04T04:28:24.827

我更喜欢使用 MySQL 工作台。它比命令行方式更容易和用户友好。

它提供了一个简单的 GUI。

MySQL 工作台或 SQL Yog。

这些是我所做的步骤。

1) 安装 MySQL 工作台。

2) 在 AWS 控制台中，您的 RDS 实例必须有一个安全组。向该组添加入站规则以允许来自您的计算机的连接。这很简单。添加您的 IP 地址。

3) 打开 MySQL 工作台，添加一个新的连接。

4) 给连接起一个您喜欢的名称。

5) 选择连接方式——标准 TCP/IP

6) 在主机名字段中输入您的 RDS 端点。

7) 端口：3306

8) 用户名​​：主用户名（您在创建 RDS 实例时创建的用户名）

9）密码：主密码

10) 单击测试连接以检查您的连接。

11) 如果连接成功，单击确定。

12) 打开连接。

13) 你会在那里看到你的数据库'realcardiodb'。

14) 现在您可以将 mysqldump 文件导出到该数据库。转到-> 服务器。单击数据导入。

15) 您可以通过简单地打开一个空白的SQL文件并输入基本的SQL命令，如使用数据库，从表中选择*来检查数据是否已经迁移；

而已。中提琴。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-17T17:03:44.200

如果您的 PC 中有 backup.sql，则无需传输到 EC2。只需在 PC 的终端上输入以下行。

```
$ mysql -h rdsinstance-hostaddress-ending.rds.amazonaws.com -u rds_username -p  rds_database < /path/to/your/backup.sql 
```

输入密码：passwd_mysql_user

就这样。

**直接从现有远程服务器导入备份**

SSH 连接到您的远程服务器

获取远程服务器mysql备份（backup/path/backupfile.sql）

在远程服务器 shell 中将备份文件导入 RDS mysql

```
mysql -h your-mysql-instance.region.rds.amazonaws.com -u db_username -p db_name < backup/path/backupfile.sql 
```

**笔记：**

我已经尝试了上述所有标准来将我现有的备份导入新的 RDS 数据库，包括通过 AWS 文档中的 EC2。这是一个 10GB 的备份。所以我也尝试过逐个表格。它显示过程已完成，但大型表缺少一些数据。所以我不得不编写一个 DB 到 DB 的数据迁移脚本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-07T09:45:15.017

使用工作台：

1.  建立连接

2.  转到管理选项卡并单击数据导入/恢复

3.  单击从自包含文件导入。

4.  选择你的`mysqlbackup.sql`文件。

5.  选择默认数据库。

6.  点击开始导入按钮。

使用命令行（在 Windows 上）：

```
mysqldump -u <localuser>

--databases world 
--single-transaction 
--compress 
--order-by-primary  
-p<localpassword> | mysql -u <rds-user-name>
    --port=3306 
    --host=ednpoint 
    -p<rds-password> 
```

有关更多详细信息，请参阅： [https](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/MySQL.Procedural.Importing.SmallExisting.html) ://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/MySQL.Procedural.Importing.SmallExisting.html 或 [https://docs.bitnami.com/aws/how-to/迁移数据库-rds/#using-phpmyadmin-110](https://docs.bitnami.com/aws/how-to/migrate-database-rds/#using-phpmyadmin-110)

希望能帮助到你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-06T19:46:43.220

关于如何将 mysql/mariadb 上已有的数据库迁移到已经运行的 RDS 实例的[分步说明。](https://k9webops.com/blog/migrate-an-existing-database-on-mysql-mariadb-to-an-already-running-rds-instance-on-the-aws)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-04T09:36:27.730

这是将客户数据导入 RDS 的 AWS RDS Mysql 文档

[http://aws.amazon.com/articles/2933](http://aws.amazon.com/articles/2933)

*   创建包含要加载的数据的平面文件
*   停止访问目标数据库实例的任何应用程序
*   创建数据库快照
*   禁用 Amazon RDS 自动备份
*   使用 mysqlimport 加载数据
*   再次启用自动备份

# php - 在 /var/www/html 中编辑

> ID：11731716
> 
> 赞同：2
> 
> 时间：2012-07-31T00:56:56.670
> 
> 标签：php, apache, web-applications

我不是一个网络开发人员，所以提前为这个愚蠢的问题道歉。

我有一个带有 LAMP 的测试服务器（Centos 6.3）供我玩。据我了解，服务器执行 /var/www/html 目录中的任何内容。您如何编辑该目录中的源文件？每次你想修复一些东西（或添加一些东西）时，你会做一个 sudo vim "foo.php" 吗？我想当您构建一个包含许多文件和目录的复杂应用程序时，这会很痛苦。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T19:56:52.430

这对我有用。作为记录，这是一个运行 LAMP（On Rackspace）的 Centos 6.3 服务器。

首先，我发现 apache 在 centos 系统上以用户“apache”和组“apache”的身份运行。在其他发行版中，我相信它在“www-data”组中作为“www-data”运行。您可以通过查看 /etc/httpd/conf/httpd.conf 来验证这一点。我们需要将 /var/www 的所有权更改为该用户。如果您是这种情况，请将下面的“apache”替换为“www-data”。

```
chown -hR apache:apache /var/www 
```

现在让它可以被组写：

```
chmod -R g+rw /var/www 
```

将自己添加到 apache 组：

```
usermod -aG apache yourusername 
```

如果您是这种情况，请将上面的 www-data 替换为 apache。

现在注销并登录 - 您现在可以编辑文件，将它们 ftp 到此目录或做任何您想做的事情。

欢迎评论。天呐！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T03:01:03.820

有许多方法可以修改和部署网站/Web 应用程序。

默认情况下，CentOS 6 可通过端口 22 上的 SSH2 访问。如果您使用的是 Windows，则可以使用[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)和[WinSCP](http://winscp.net/eng/index.php)的组合（分别管理您的服务器及其文件）。如果您在 Linux 或 Mac OS X 上，SSH 已经内置在您的系统中，并且可以使用终端访问。我发现使用 SSH 优于其他方法，因为它受到广泛支持、安全和轻量级。

如果您想要正确的语法检测，您还需要一个体面的文本编辑器或 IDE 来编辑文件。有很多选择，我最喜欢的是[Notepad++](http://notepad-plus-plus.org/)和 Sublime Text 2。并不是说我没有不时直接在 PuTTY ( `yum install nano`) 中使用 nano 文本编辑器包编辑我的 PHP 文件。

如果您使用的是编辑-保存-上传的方法，请记住**定期备份您的文件**，如果您不这样做，您会发现很难。此外，除非需要，否则永远不要使用 root。创建仅用于修改您的网站的用户是一种很好的做法（`adduser <username>`并授予该用户对 的写入权限`/var/www/html`）。

回答你的第二个问题：

一旦你开始进行更繁重的 Web 开发，你可能会想要使用[Git 之](http://git-scm.com/)类的东西。使用 git 部署超出了这个问题的范围，所以我不会讨论这个问题。简而言之，您可以对其进行设置，以便您的开发环境位于本地，并且您可以使用 和 的组合`git commit`进行`git push`部署。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T01:59:57.420

我使用 FTP 客户端 (FileZilla) 下载文件、编辑它们然后重新上传它们。如果你是一个单（女）人表演，并且在测试设置中并且只是为了学习而玩耍，这可能就足够了。如果有超过 1 个人，或进行（测试和）生产设置，您应该使用 svn 进行更多控制，例如另一个答案中提到的 @Markus。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T00:58:11.290

您应该更改该目录的权限（使用`chmod`），以便您具有写入权限，然后可以读取和写入该目录。那么，你不需要`sudo`.

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-07-31T00:59:14.703

老兄。阅读版本控制和源代码控制系统，如 subversion 和 git。这个想法是在你的机器上开发，对结果进行修订控制，然后在生产服务器上部署一个已知的工作版本。

# google-app-engine - 如何获取应用引擎前端服务器的实例 ID？

> ID：11731719
> 
> 赞同：3
> 
> 时间：2012-07-31T00:57:15.547
> 
> 标签：google-app-engine

有没有办法直接向该服务器发送请求？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-14T21:58:14.557

实际上，有一种方法可以将新数据推送到应用程序的所有实例。

```
from google.appengine.api import modules
instance_id = modules.get_current_instance_id() 
```

[参考：GAE 模块文档](https://cloud.google.com/appengine/docs/python/modules/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:57:10.277

出于什么目的？

如果要测试不同的版本，可以使用流量拆分[https://developers.google.com/appengine/docs/adminconsole/trafficsplitting](https://developers.google.com/appengine/docs/adminconsole/trafficsplitting)

那是不同的版本，而不是特定的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T02:22:17.020

不，没有。

通常当有人问这样的问题时，他们在应用引擎上的方向是错误的。前端服务器一直在启动和关闭。如果您正在设计任何依赖于特定实例的东西，那么您做错了。无论遇到什么实例，您都需要设计能够正常工作的请求。

如果必须这样做，请考虑使用后端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-16T21:49:08.957

With the advent of [Modules](https://developers.google.com/appengine/docs/java/modules/), you can get the current instance id in [a more elegant way](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/modules/ModulesService#getCurrentInstanceId%28%29):

`ModulesServiceFactory.getModulesService().getCurrentInstanceId()`

Also, according to [this doc](https://developers.google.com/appengine/docs/java/modules/routing#addressing_instances), you can route requests specifically to a particular instance by using a URL like

`http://instance.version.module.app-id.appspot.com`

Note that you need to replace the dot with `-dot-` to suppress the SSL certificate warning your web client may be complaining about:

`http://instance-dot-version-dot-module-dot-app-id.appspot.com`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T18:06:43.927

我使用 Python 和日期时间戳来识别实例。此实例 ID 由 appengine_config.py 设置。为了向其他实例发出信号，我在 memcache 中使用了一个标志，由`__init__`我的 webapp2 请求处理程序检查。我使用其他实例的信号来刷新 jinja 环境并重新加载动态 python 代码，因为我找不到其他方法。

这是内存缓存标志的示例；发出重新加载所有动态模块的信号，这些模块已由实例 id 设置：'2012-12-26 16:39:50.072000'

```
{ u'_all': { u'dyn_reloads_dt': datetime.datetime(2012, 12, 26, 16, 39, 59, 120000),
             u'setter_instance': '2012-12-26 16:39:50.072000'}} 
```

我主演了来自 Ibrahim Arief 的[功能请求](http://code.google.com/p/googleappengine/issues/detail?id=8031)

# c# - 从 `NSDecimal` 或 `NSDecimalNumber` 转换为 C# 的 `decimal` 类型

> ID：11731721
> 
> 赞同：3
> 
> 时间：2012-07-31T00:57:52.147
> 
> 标签：c#, xamarin.ios, type-conversion, decimal, nsdecimalnumber

我有一个`NSDecimalNumber`来自 StoreKit 的`SKProduct`课程，我想将其转换为 C# 的`decimal`类型以最大程度地减少精度损失。有没有一种简单的方法来做这样的事情？

我想我的两个选择是：

1.  假设我了解每个的二进制实现并进行自己的按位转换，或者
2.  给我`NSDecimalNumber`一个字符串，然后`decimal`解析它。

我认为选项 1 工作量太大，甚至可能很脆弱，所以我倾向于选择选项 2。但这似乎也不是我能做的最好的。（我可以忍受它会有多慢，因为它很少发生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T21:40:12.453

[`NSDecimal`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/NSDecimal)和[`NSDecimalNumber`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)结构表示与 .NET 不同[`System.Decimal`](http://msdn.microsoft.com/en-us/library/bb1c1a6x.aspx)。

转换总是可能的，但并不容易。如果性能不是一个大问题，那么最好使用`string`表示在它们之间进行转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-24T02:46:53.497

仅仅因为这让我绊倒并花费了我相当长的时间，这里有几个扩展方法，我现在用于在 和 之间进行`NSDecimal`转换`decimal`。这非常令人沮丧，我很惊讶没有更好的内置方法。

```
public static class NumberHelper
{
    public static decimal ToDecimal(this NSDecimal number)
    {
        var stringRepresentation = new NSDecimalNumber (number).ToString ();
        return decimal.Parse(stringRepresentation, CultureInfo.InvariantCulture);
    }

    public static NSDecimal ToNSDecimal(this decimal number)
    {
        return new NSDecimalNumber(number.ToString(CultureInfo.InvariantCulture)).NSDecimalValue;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-07-21T11:41:15.663

自 Xamarin iOS SDK 12 起，运算符可用于[将 NSDecimal 显式转换为小数](https://docs.microsoft.com/en-us/dotnet/api/foundation.nsdecimal.op_explicit?view=xamarin-ios-sdk-12#Foundation_NSDecimal_op_Explicit_Foundation_NSDecimal__System_Decimal)，并将小数[隐式转换为 NSDecimal](https://docs.microsoft.com/en-us/dotnet/api/foundation.nsdecimal.op_implicit?view=xamarin-ios-sdk-12#Foundation_NSDecimal_op_Implicit_System_Decimal__Foundation_NSDecimal)。

使用这些运算符，您可以将以下代码作为实现目标的示例：

```
var nsDecimalNumber = new NSDecimalNumber("128.478", new NSLocale("en-US"));
var nsDecimal = nsDecimalNumber.NSDecimalValue;
var csharpDecimal = (decimal)nsDecimal;
var nsDecimalAfterConversion = (NSDecimal)csharpDecimal;
var nsDecimalNumberAfterConversion = new NSDecimalNumber(nsDecimalAfterConversion); 
```

# sql - 在当前表引用的另一个表中创建行的触发器

> ID：11731723
> 
> 赞同：0
> 
> 时间：2012-07-31T00:58:03.223
> 
> 标签：sql, sql-server, sql-server-2008, triggers

我有 2 个表用户和帐户。我想要一个触发器，在创建用户时自动创建一个帐户。这是我的代码：

```
alter trigger Add_user on [user] for insert as
begin
    insert into [account] (name) values ('Main')

    declare @newAccountId int, @insertedId int
    set @newAccountId = (select scope_identity())
    set @insertedId = (select id from inserted)

    update [user]
    set accountId = @newAccountId
    where id = @insertedId
end 
```

我想让 User 表中的 AccountId 不为空，但是当我尝试创建一个新用户时，它不会让我，并且我收到一个错误，抱怨非空 AccountId 列:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:52:23.457

如果您使 [user].AccountId 可以为空，它应该可以工作。

还要考虑以下事项：

*   [account] 表是否仅包含列“名称”？即它对所有用户都是全球性的吗？那为什么要为每个用户创建新帐户呢？如果它是特定于用户的，则添加 [account].[userId] 列。
*   我建议编写存储过程而不是触发器（首先创建帐户记录然后用户记录），它更明确和安全。小心触发器，插入用户也创建帐户可能会让其他开发人员感到惊讶。

# grails - 如何在 grails 中禁用 log4j 插件？

> ID：11731730
> 
> 赞同：1
> 
> 时间：2012-07-31T00:59:09.040
> 
> 标签：grails, log4j, grails-plugin

**Grails 2.1 log4j 插件**似乎在grails 应用程序初始化期间重置了 log4j 配置（请参阅下面的堆栈跟踪）。

```
 at org.apache.log4j.LogManager.resetConfiguration(LogManager.java:233)
    at org.apache.log4j.LogManager$resetConfiguration.call(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:42)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:112)
    at org.codehaus.groovy.grails.plugins.log4j.Log4jConfig.initialize(Log4jConfig.groovy:66)
    at org.codehaus.groovy.grails.plugins.log4j.web.util.Log4jConfigListener.contextInitialized(Log4jConfigListener.java:48)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3910)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4389)
    at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeployInternal(TomcatDeployment.java:313)
    at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeploy(TomcatDeployment.java:145) 
```

**有什么方法可以禁用此“功能”或完全删除此插件？**

我的 JBoss 服务器已经通过 jboss-log4j.xml 进行了配置，我不希望 grails 对配置进行任何更改。我已经尝试删除`log4j`Config.groovy 的部分，但这样做没有效果。

正如凯利建议的那样，我已经从我的战争文件中删除了所有与日志记录相关的 jar。Log4j 类由 JBoss 提供。

**编辑**我还尝试了[https://stackoverflow.com/a/1190438/539048](https://stackoverflow.com/a/1190438/539048)中描述的技巧，但这似乎没有任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T19:47:06.670

解决方案是从生成的 web.xml 文件中删除以下部分：

```
<listener>
    <listener-class>org.codehaus.groovy.grails.plugins.log4j.web.util.Log4jConfigListener</tag0:listener-class>
</listener> 
```

为此，我`scripts/Events.groovy`根据[此博客](http://blog.saddey.net/2010/03/06/how-to-deploy-a-grails-application-to-jboss-5/)编辑了文件，但将侦听器类名称更改为`org.codehaus.groovy.grails.plugins.log4j.web.util.Log4jConfigListener`.

```
eventWebXmlEnd = {String tmpfile ->

    def root = new XmlSlurper().parse(webXmlFile)

    def log4j = root.listener.findAll {node ->
        node.'listener-class'.text() == 'org.codehaus.groovy.grails.plugins.log4j.web.util.Log4jConfigListener'
    }
    log4j.replaceNode {}

    webXmlFile.text = new StreamingMarkupBuilder().bind {
        mkp.declareNamespace("": "http://java.sun.com/xml/ns/j2ee")
        mkp.yield(root)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T02:12:10.320

像这样修改你的`BuildConfig.groovy`：

```
inherits("global") {
    excludes 'log4j', 'jcl-over-slf4j', 'slf4j-api', 'slf4j-log4j12'
} 
```

这应该删除所有日志库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-21T15:19:54.117

[我在这个](https://github.com/WebDataConsulting/billing)grails 应用程序上尝试了上述建议，这样我就可以期望排除 grails 的 log4j 依赖项。但是，应用建议后，预期要删除的 jar 文件仍然存在于生成的 war 文件中。这些 jar 文件是：./lib/grails-plugin-log4j-2.4.4.jar 和 ./lib/log4j-1.2.17.jar

# c# - 在 C# 中从数据库加载组合框

> ID：11731734
> 
> 赞同：1
> 
> 时间：2012-07-31T00:59:40.663
> 
> 标签：c#, mysql, combobox, sqldataadapter

我正在创建一个应用程序，我可以在其中添加客户的名字、姓氏、电子邮件、日期、服务类型（电脑维修）、技术人员电脑品牌、电脑类型、操作系统类型以及电脑问题。我可以使用 phpMyAdmin 将数据插入 MySQL 数据库。

但是，我坚持这部分。我正在尝试查看刚刚创建的服务订单。我想按客户的姓氏加载组合框，一旦我单击客户的姓名，它就会填充上面提到的所有字段以及它插入数据库的服务编号。我在加载组合框和 texfields 时遇到问题。

任何想法表示赞赏！如果组合框是一个坏主意并且有更好的方法，请告诉我！我试过这段代码，但 SQLDataAdapter 不适合我。我不知何故找不到一个我也可以联系起来的例子。

```
private void cbViewServices_SelectedIndexChanged(object sender, EventArgs e)
{
  if (cbViewServices.SelectedIndex >- 1)
  {
    string lastName = cbViewServices.SelectedValue.ToString();                
    MySqlConnection conn = new MySqlConnection("server=localhost;uid=******;password=**********;database=dboserviceinfo;");
    conn.Open();

    SqlDataAdapter da = new SqlDataAdapter("select distinct LastName from tserviceinfo where LastName='" + lastName + "'", conn);

    DataSet ds = new DataSet();
    da.Fill(ds); conn.Close();
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T02:50:23.653

我不建议使用“姓氏”作为参数来加载您的详细信息，因为该字段很可能不是唯一的。除非您的程序中出现这种情况。

此示例执行以下操作：

1.  将客户 ID（或您的姓氏）加载到组合框。
2.  处理组合框的更改事件并将其作为参数传递给将使用它来加载详细信息的方法。
3.  使用传递的参数加载客户详细信息。

一些指导方针：

1.  将一次性物品包含在“使用”语句中，以便正确处理。
2.  不要使用字符串连接来创建 SQL 语句。改用 SQL 参数，这样可以避免 SQL 注入并使代码更清晰。
3.  查看 MySQL .NET 连接器提供程序文档以了解最佳实践。

    ```
    //Load customer ID to a combobox
    private void LoadCustomersId()
    {
        var connectionString = "connection string goes here";
        using (var connection = new MySqlConnection(connectionString))
        {
            connection.Open();
            var query = "SELECT Id FROM Customers";
            using (var command = new MySqlCommand(query, connection))
            {
                using (var reader = command.ExecuteReader())
                {
                    //Iterate through the rows and add it to the combobox's items
                    while (reader.Read())
                    {
                        CustomerIdComboBox.Items.Add(reader.GetString("Id"));    
                    }
                }    
            }
        }
    }

    //Load customer details using the ID
    private void LoadCustomerDetailsById(int id)
    {
        var connectionString = "connection string goes here";
        using (var connection = new MySqlConnection(connectionString))
        {
            connection.Open();
            var query = "SELECT Id, Firstname, Lastname FROM Customer WHERE Id = @customerId";
            using (var command = new MySqlCommand(query, connection))
            {
                //Always use SQL parameters to avoid SQL injection and it automatically escapes characters
                command.Parameters.AddWithValue("@customerId", id);
                using (var reader = command.ExecuteReader())
                {
                    //No customer found by supplied ID
                    if (!reader.HasRows)
                        return;

                    CustomerIdTextBox.Text = reader.GetInt32("Id").ToString();
                    FirstnameTextBox.Text = reader.GetString("Firstname");
                    LastnameTextBox.Text = reader.GetString("Lastname");
                }
            }
        }
    }

    //Pass the selected ID in the combobox to the customer details loader method 
    private void CustomerIdComboBox_SelectedIndexChanged(object s, EventArgs e)
    {
        var customerId = Convert.ToInt32(CustomerIdComboBox.Text);
        LoadCustomerDetailsById(customerId);
    } 
    ```

我不完全确定这是否是您要寻找的，但大多数准则仍然适用。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T01:03:51.333

尝试像这样将数据绑定到组合框：

```
public void ListCat()
{
    DataTable linkcat = new DataTable("linkcat");
    using (SqlConnection sqlConn = new SqlConnection(@"Connection stuff;"))
    {
        using (SqlDataAdapter da = new SqlDataAdapter("SELECT LastName FROM list WHERE LastName <> 'NULL'", sqlConn))
        {
            da.Fill(linkcat);
        }
    }
    foreach (DataRow da in linkcat.Rows)
    {
        comboBox1.Items.Add(da[0].ToString());
    }
} 
```

取自[我自己的问题](https://stackoverflow.com/questions/11650104/prevent-duplicate-results-in-sql)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:07:31.140

SqlDataAdapter 用于与 SQL Server 而不是 MySQL 进行通信。

尝试以下操作：

```
MySqlDataAdapter da = new MySqlDataAdapter("select distinct LastName from tserviceinfo where LastName='" + lastName + "'", conn); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-26T07:32:53.253

我们也可以使用while循环。在 SQLDatareader 完成数据库连接后，我们可以使用 while 循环。

"userRead" 是 SQLData 阅读器

```
 while (userRead.Read())
   {
        cboxReportNo.Items.Add(userRead[1].ToString());
   } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-04T07:24:28.087

**在ComboBox** **DataSource**中绑定您的数据集

 **```
this.comboBox1.DataSource = ds;
this.comboBox1.DisplayMember = "LastName";
this.comboBox1.ValueMember = "Id";
this.comboBox1.SelectedIndex = -1;
this.comboBox1.AutoCompleteMode = AutoCompleteMode.Append;
this.comboBox1.AutoCompleteSource = AutoCompleteSource.ListItems; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-09-29T16:54:02.857

```
//USING
        using System;
        using System.Drawing;
        using System.Windows.Forms;
        using System.Data.SqlClient;
        using System.Data;

namespace YourNamespace
{
//Initialization
        string connetionString = null;
        SqlConnection cnn;
        SqlCommand cmdDataBase;
        SqlDataReader reader;
        DataTable dt;

public frmName()
        {
            //
            // The InitializeComponent() call is required for Windows Forms designer support.
            //
            InitializeComponent();
            //
            // TODO: Add constructor code after the InitializeComponent() call.
            //
            FillComboNameOfCombo();
        }

void FillcmbNameOfCombo()
{
    string sqlQuery = "SELECT * FROM DATABASENAME.[dbo].[TABLENAME];";
            connetionString = "Data Source=YourPathToServer;Initial Catalog=DATABASE_NAME;User ID=id;Password=pass";
                    cnn = new SqlConnection(connetionString); 
                    cmdDataBase = new SqlCommand(sqlQuery, cnn);
            try { 
                    cnn.Open(); 

                    reader = cmdDataBase.ExecuteReader();
                    dt = new DataTable();

                    dt.Columns.Add("ID", typeof(string));
                    dt.Columns.Add("COLUMN_NAME", typeof(string));
                    dt.Load(reader);
                    cnn.Close();

                    cmbGender.DataSource = dt;
                    cmbGender.ValueMember = "ID";
                    cmbGender.DisplayMember = "COLUMN_NAME";

                    dt = null;
                    cnn = null;
                    cmdDataBase = null;
                    connetionString = null;
                    reader = null;
                }
            catch (Exception ex) { 
                    MessageBox.Show("Can not open connection ! " + ex.ToString());
                }
}
} 
```**

# algorithm - 如何根据事件时间计算连续平滑事件率？

> ID：11731735
> 
> 赞同：4
> 
> 时间：2012-07-31T00:59:45.857
> 
> 标签：algorithm

基于连续的实时事件流（每个事件的时间很容易知道，但每个事件没有价值，它们都是相同的），如何编写一个过滤器/过程来输出连续平滑的事件率？所谓连续，我的意思是它可以例如绘制为图表，而不是每个事件的时间，而是提供有关每个特定时间的估计事件率的信息。我知道“平滑”可能是模棱两可的，但我正在寻找最简单的方法来使结果图*看起来*平滑。例如，每个事件不应该有任何大的峰值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-05T23:34:19.120

这可以通过移动平均线来实现。取最后 N 个事件，其中 N 是平均窗口的大小。计算这 N 个事件中的第一个和最后一个事件之间的时间差。如果您以秒为单位测量并且想要每分钟的事件率，那么您可以将 60 秒除以以秒表示的时间差，然后乘以 N-1。

currentAvgRate = (N-1) * 60 / (最后 N 个事件之间的时间差)

N 的值越大，曲线越平滑，但对局部变化的反应就越小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T01:02:55.547

通过平均。例如，每次您收到一个事件时，都将一个事件添加到一个。每秒删除 1/60 的 a。它会给你一个简单的平均值，滑动窗口约为一分钟。

# javascript - clog() 方法有什么作用？

> ID：11731736
> 
> 赞同：0
> 
> 时间：2012-07-31T01:00:14.267
> 
> 标签：javascript, html, url

我正在努力学习url持久化，有朋友告诉我研究这段代码：

```
$(document).ready(function(){
var objects = {};
var DEFAULT_LOCATION = "diameter";

$("#animateObjects").hide();

var urlDimension = location.hash.replace("#","");
if (urlDimension.length == 0) {
    // location.hash = "#" + DEFAULT_LOCATION;
    urlDimension = DEFAULT_LOCATION;
    $("#"+DEFAULT_LOCATION).addClass("active");
    clog("started with no dimension, defaulted to " + DEFAULT_LOCATION);
}
else {
    $("#"+urlDimension).toggleClass("active");
    clog("started with dimension: " + urlDimension);
} 
```

clog() 方法完成了什么？

完整代码在[这里](https://github.com/VT-CHCI/scaling-dimensions/blob/master/app/assets/javascripts/script.js.erb)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:06:04.250

我敢打赌它是一个包装器，`console.log`以满足 IE 无法处理的问题。

像这样的东西：

```
function clog(message) {
    try {
        console.log('message');
    } 
    catch (ex) {}
} 
```

参考：[http ://benwong.me/javascript-console-log-and-internet-explorer/](http://benwong.me/javascript-console-log-and-internet-explorer/)

# php - 宽幅图像中的输入文件

> ID：11731738
> 
> 赞同：-1
> 
> 时间：2012-07-31T01:00:25.743
> 
> 标签：php, html, image, input

我有这些代码。在`form.html`：

```
<form name="form2" method="post" action="lagarto.php" />
<input type="file" size="32" name="myimg" value="" />
<input type="submit" name="Submit" value="upload" />
</form> 
```

并在`lagarto.php`：

```
 <?php 

require( "./lib/WideImage.php");

$myimg = $_FILES['myimg']['tmp_name'];  // <-- Note this addition
$image = WideImage::load($myimg);

$image = WideImage::load($img);

$image->output('jpg', 90);

    ?> 
```

它应该显示图像输出，但我收到此错误消息：

> 注意：未定义索引：第 6 行 C:\Arquivos de programas\EasyPHP-5.3.9\www\wideimage-11.02.19-full\lagarto.php 中的 myimg
> 
> 致命错误：未捕获的异常“WideImage_InvalidImageSourceException”与消息“字符串不包含图像数据”。在 C:\Arquivos de programas\EasyPHP-5.3.9\www\wideimage-11.02.19-full\lib\WideImage.php:240 堆栈跟踪：#0 [内部函数]：WideImage::loadFromString(NULL)#1 C:\Arquivos de programas\EasyPHP-5.3.9\www\wideimage-11.02.19-full\lib\WideImage.php(184): call_user_func(Array, NULL) #2 C:\Arquivos de programas\EasyPHP-5.3 .9\www\wideimage-11.02.19-full\lagarto.php(8): WideImage::load(NULL) #3 {main} 在 C:\Arquivos de programas\EasyPHP-5.3.9\www\wideimage 中抛出-11.02.19-full\lib\WideImage.php 在第 240 行

任何想法？

编辑：我试图将这些行添加到我的代码中：

```
$_FILES = $HTTP_POST_FILES;
$img = $FILES['myimg']['tmp_name']; 
```

我什至只尝试了其中一条线。什么都没有改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T16:15:56.763

我记得我有同样的问题。解决方案是将图像表单系统临时文件夹复制到本地文件夹，然后通过加载程序访问它。（另一个原因可能是临时名称中的文件后缀错误。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:02:19.820

`$myimg`不会根据表单自动设置，并且您从未声明过它。

你需要一些类似定义的东西`$myimg`：

```
$myimg = $_FILES['myimg']['tmp_name'];  // <-- Note this addition
$image = WideImage::load($myimg); 
```

# c - 我是否以某种方式改变了 ctype.h？

> ID：11731741
> 
> 赞同：0
> 
> 时间：2012-07-31T01:00:39.853
> 
> 标签：c

```
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>

#include "dictionary.h"

#define HASH_SIZE 5

// prototype
int hash(char *word);

// counter
int counter;

// node
typedef struct node
{
    char word[LENGTH + 1];
    struct node *next;
} node;

// hash table
struct node *hashtable[HASH_SIZE];

/*
 * Returns true if word is in dictionary else false.
 */

bool
check(const char *word)
{
    //make a writable word (palabra)
    int len = strlen(word);
    char palabra[len + 1];
    //int i;

    // make la palabra all lowercase letters
    for ( int i = 0; i < len; i++)
    {
        if (isalpha(palabra[i]) || palabra[i] == '\'')
            palabra[i] = tolower(word[i]);
    }

    //palabra[i] = (char) "\0";

    // hash the word
    int value = hash(palabra);

    // let's look at the first node in the bucket
    struct node *n;
    if (hashtable[value] == NULL)
        return false;
    else
        n = hashtable[value];

    // iterate through the bucket to see if the word is there
    while (strcmp(palabra, n->word) != 0 && n->next != NULL)
    {
        n = n->next;
    }

    // if the word is found, print true, else false
    if ( strcmp(palabra, n->word) ==0 )
        return true;
    else
        return false;
}

/*
 * Loads dictionary into memory.  Returns true if successful else false.
 */

bool
load(const char *dictionary)
{
    // open the dictionary
    FILE *dict = fopen(dictionary, "r");
    if(dict == NULL)
    {
        printf("Could not open %s.\n", dictionary);
        return false;
    }

    // set all values in the hash table to null
    for(int i = 0; i < HASH_SIZE; i++)
    {
        hashtable[i] = NULL;
    }

    // set the counter to 0
    counter = 0;

    // iterate through the words in the dictionary
    while (!feof(dict))
    {
        //declare a node
        node *n = malloc( sizeof(node) );

        // copy the word into the node
        fscanf(dict, "%s", n->word);

        // hash the word, baby!
        int hash_value = hash(n->word);

        // start saving addresses to the hashtable
        n->next = hashtable[hash_value];
        hashtable[hash_value] = n;

        // that's one more!
        counter++;
    }

    // testing
    printf("Starting the test.\n");
    for ( int i = 0; i < HASH_SIZE; i++)
    {
        struct node *q = hashtable[i];
        while (q != NULL)
        {
            printf("%s\n", q->word);
            q = q->next;
        }
    }
    printf("Ending the test.\n");

    fclose(dict);

    return true;
}

/*
 * Returns number of words in dictionary if loaded else 0 if not yet loaded.
 */

unsigned int
size(void)
{
    return counter;
}

/*
 * Unloads dictionary from memory.  Returns true if successful else false.
 */

bool
unload(void)
{
    // TODO
    return false;
}

/*
 * Returns a hash value for a word.
 */

int
hash(char *word)
{
    // hash value and length of word
    int value = 0;
    int len = strlen(word);

    // iterate through letters, adding ASCII values
    for(int i = 0; i < len; i++)
    {
        int letter = (int) word[i];
        value += letter;
    }

    // make sure the value is less than 100 & return
    value = value%HASH_SIZE;
    return value;
} 
```

当我运行我的代码时，我收到以下错误消息：

在 /usr/include/ctype.h:28:0 包含的文件中，来自 speller.c:10: /usr/include/bits/types.h:31:1: error: expected '=', ',', ';'、'asm' 或 ' **attribute** ' 在 'typedef' 之前

这是否意味着我设法改变了 ctype.h 库？如果是这样，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:14:47.323

啊哈！戈登，你解决了！我发现在导致问题的#include 上方键入了一些杂散字符。谢谢！

# html - 删除 Yahoo! 中的不间断空格！管道

> ID：11731745
> 
> 赞同：0
> 
> 时间：2012-07-31T01:01:32.427
> 
> 标签：html, unicode, character, space, yahoo-pipes

我使用 XPath Fetch Page 模块来获取页面并将其转换为一堆节点。其中一个节点具有“ `2012-07-28&nbsp;00:00`”，但在 Yahoo!中`&nbsp;`显示为空格（“ ”）`管道。[我也在这里](http://software.hixie.ch/utilities/cgi/unicode-decoder/character-identifier?characters=2012-07-28+00%3A00)输入了字符串，但它认为它是一个常规空格。`

 `如何将此不间断空间转换为常规空间？我尝试使用 Regex 模块，但我尝试放入“查找”字段的所有内容都与不间断空格不匹配。

我尝试使用“ `”、“ `&nbsp;`”、“ `&#x0020;`”，但这些都不起作用。有什么建议么？`

 `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T15:06:02.347

使用 Regexp 模块 {replace: " `\xA0`", with: " "} 将不间断空格转换为常规空格。

注意：此行为未记录在案，因此可能会更改，恕不另行通知。``

# jquery - jQuery (1.7.2 - latest) - 设置 CSS 值时的奇怪行为（小数/浮点错误）

> ID：11731747
> 
> 赞同：1
> 
> 时间：2012-07-31T01:01:39.397
> 
> 标签：jquery, css, floating-point, rounding

我一直在测试一个简单的循环，它可以在屏幕上移动一些东西——但是在通过 jQuery 设置 CSS 属性时，我看到了奇怪的行为（几乎肯定与浮动错误有关）。

基本上我反复做这样的事情

```
var val = parseInt($(myobject).css("left));
val -= 7;
$(myobject).css("left",val+"px"); 
```

如果我在那之后测试“左”属性的值，我会看到如下结果

```
1042
1035
1028
1020 <<<< !!!!
1013
1006
... 
```

进一步挖掘，似乎正在发生的是我这样做

```
$(myobject).css("left","1021px")
alert($(myobject).css("left")) 
```

警报显示的是“1020.99876152371253716253px”

我能想到的是，jQuery 在内部剥离了“1021px”并分配了一个非圆形/固定/天花板/地板版本的数字！？

不知道在哪里提出这个问题，或者我是否遗漏了什么！？！？

ps 更新说我在最新的公共 Chrome/W7-64 上看到了这个

pps 我将我的整个代码（没有 webfont 和 1 个外部函数）复制到 JSFiddle 中并且它没有行为异常（即使在全屏模式下） - 但是代码在独立运行时继续行为异常（尽管在各个方面都是相同的代码！！）所以我对这个越来越迷惑了...

还有更多 ps 这只发生在 Chrome 中，在 IE (9) 和 Firefox (14) 中它可以正常工作 - 很明显我偶然遇到了一个怪癖，而且是一个非常具体的怪癖（因为它在 jsFiddle 中不可重现！！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T08:18:49.313

根本不解析值，使用变量来保持值，只设置样式。

例子：

```
$(document).load(function(){
  var x = 2000;
  var timer = window.setInterval(function(){
    if (x > 10) {
      x -= 7;
      $('.myobject').css("left", x + "px");
    } else {
      window.clearInterval(timer);
    }
  }, 100);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:22:43.557

jQuery 正在分配您指定的值（“1021px”）。产生浮点值的是浏览器。不久前，我在一个版本的 IE 中遇到了类似的问题。

你可以这样处理：

```
var val = Math.round( parseFloat( $( myobject ).css( 'left' ) ) ); 
```

# iphone - 网络推送通知

> ID：11731753
> 
> 赞同：0
> 
> 时间：2012-07-31T01:02:15.797
> 
> 标签：iphone, ios, xcode, cocoa-touch, cocoa

我想知道是否有一种简单的方法可以向当前使用您的应用程序的所有用户推送通知。

因此，下次他们启动应用程序并连接到 Wi-Fi 时，他们会收到一条警报，告诉他们“有可用更新”。

* * *

**编辑**：

更详细地解释我在寻找什么。我正在开发一个应用程序，该应用程序仅应在该软件的最新版本时使用，因此我希望能够在 AppStore 中有可用更新时发送消息（通知）。这在一些游戏中可以看到，例如*AngryBirds*和*Cut the Rope*。

甚至可能将代码中的 BOOL 更改为 TRUE，如果{} BOOL 为 TRUE，则会留下红旗。（当然，首先我想要一个更基本版本的答案。这也会有帮助）

希望这可以解决问题。

* * *

带着敬意，

凯迪安爵士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T03:45:05.407

**本地通知解决方案**

基本上就像奥斯卡之前所说的那样，你可以让这变得非常简单。如果您想在每次启动应用程序后进行检查，您可以轻松地从您的应用程序调用某种本地 API（或类似的）调用到您可能托管的 Web 服务。例如，您有一个 PHP 文件：

```
<?php
$currentVersion = 1.3;
echo $currentVersion;
?> 
```

每当您发布更新时，您都可以更新这个简单的 PHP 脚本。iPhone 可以通过在每次启动时查询该 PHP 文件来识别这一点（检查 NSURLConnection 委托方法以获取来自任何特定 URL 的响应）。现在，根据您的应用程序先前的检查，它可以通过以下方式将这些检查存储在 NSUserDefaults 值中：

```
NSUserDefaults *defaults = [[NSUserDefaults alloc] init];
NSString *loadedVersion = [defaults valueForKey:@"MYAPP_CURR_VERSION"]; 
```

现在我们需要从您的 NSURLConnection 委托方法中比较两者，该方法从您的 Web 服务上的 PHP 文件接收字符串。

```
NSMutableURLRequest *urlRequest = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.website.com/folder/version.php"]];
   [urlRequest setHTTPMethod:@"GET"];

    [urlRequest setHTTPBody:[postParams dataUsingEncoding:NSUTF8StringEncoding]];

    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:urlRequest delegate:self startImmediately:YES];
    [connection start]; 
```

上面的代码会将请求发送到您告诉它的服务器 URL。现在，当我们得到响应时，我们会这样做：

```
-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    NSString *responseVersionFromServer = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
if(![loadedVersion isEqualToString:responseVersionFromServer]) {
//execute code here to show a local notification or UIAlertView
 }
} 
```

这将为您完成所有比较。

**注意：您必须在 .h 头文件中添加 NSURLConnectionDelegate！**

**推送通知解决方案**

有一些服务允许您的应用程序具有推送通知，例如 Urban Airship，您可以登录并在更新可用时向所有用户发送推送通知。使用起来真的很简单，看看他们的网站。(www.urbanairship.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:09:33.707

您可以使用 Web 服务并比较您的应用程序的版本（也许将版本保存到 NSUserDefaults），我敢肯定还有其他解决方案，但我想到了这个。如果版本不同，您可以显示链接到应用商店的警报。

# php - PHP - 使用存储在会话中的复选框数组值填充数组

> ID：11731757
> 
> 赞同：0
> 
> 时间：2012-07-31T01:02:46.753
> 
> 标签：php, arrays, paypal

我在这里碰壁了。我正在使用 Paypal Parallel Payment API (PHP)，我想用存储`$receiverEmailArray`在`parallel.php``$_SESSION['owneremails']`

```
$receiverEmailArray = array(
        ''.$_SESSION['owneremails'].'',
        'sales@mydomain.com'
        ); 
```

我希望所有者的电子邮件地址填充在里面`$receiverEmailArray`（`sales@mydomain`是一个常数），最后看起来像这样：

```
$receiverEmailArray = array(
        'owneremail1@gmail.com', 'owneremail2@gmail.com', 'owneremail3@gmail.com',
        'sales@mydomain.com'
        ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:02:40.337

假设`$_SESSION['owneremails']`是一组电子邮件地址，您只需添加您的固定电子邮件地址：

```
$_SESSION['owneremails'][] = 'sales@mydomain.com';
$receiverEmailArray = $_SESSION['owneremails']; 
```

如果`$_SESSION['owneremails']`不是数组，您可以编辑您的问题以显示内容吗？

# php - javascript 验证来自数据库的表单值

> ID：11731761
> 
> 赞同：1
> 
> 时间：2012-07-31T01:03:02.880
> 
> 标签：php, javascript, validation

下面的代码是创建一个活动。在创建之前，我必须验证表单。我必须验证数据库中是否已经存在的活动名称。我不知道我是否可以在 javascript 中使用 PHP 代码（如下所示）。无论如何它不起作用。如何更改我的代码？如何使用数据库值验证值？

$this->campaign 是一个数组，其中包含数据库中的所有活动详细信息。

```
<script type="text/JavaScript">
function validate()
{
var name = document.getElementById('name').value;
var shape = document.getElementById('shape').value;
     <?
     foreach($this->campaign as $c)
     {
     $old_cname=$c['name'];
     ?>
        if(name==<?=$old_cname;?>)
        {
            alert("same name exists in database. Try again!");
        }
    <?
    }
    ?>

if(!name)
{
    alert("Please enter a name!");

    return false;
}

if(!shape)
{
    alert("Please select shape!");
    return false;
}
    return true;

}
</script>

<form action="create.php" method="post" onsubmit="return(validate());">
Name:
<input type="text" name="name" id="name"/>
Shape:
<select name="shape" id="shape">
<option value="long">Long</option>
<option value="tall">Tall</option>
</select>
<input type="submit" value="Create" name="submit"/>
</form> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:31:53.833

你不能像那样混合 php 和 javascript.. php 是服务器端语言，而 javascript 是客户端；php 在用户看到之前渲染页面，而 javascript 修改页面而不刷新。js 中的任何 php 值都将在 js 执行之前被渲染和输出。

为了做您需要的事情，您需要使用 ajax，它是异步 javascript 和 xml，一种允许您想要发生的事情的客户端-服务器通信方法。

为此，我建议使用[jQuery](http://jquery.com/)，这是一个使此类请求变得非常简单的 javascript 库。作为一个例子，你将如何在 jquery 中提出这样的请求......

[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)方法：

```
$.ajax({
    url: "validate.php",
    type: "POST",
    data: "username=" + username,
    sucesss: function(data) {
        if (data == 1)
            $("#ajax_div").html("Username is taken, choose another!");
        }
        else {
            $("#ajax_div").html("Username is free :)");
        }
    }
}); 
```

那将是如何在 ajax 中执行此操作，而您的 php 文件将返回 1 或 0，具体取决于比较数据库中用户名的 sql 查询的结果。

要在没有 jquery 的情况下做到这一点，它会是这样的：

```
function checkUsername() {
    var xmlhttp;
    if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function() {
        if (xmlhttp.readyState==4) {
            if (xmlhttp.responseText == 1) {
                document.getElementById('ajax_div').innerHTML = "Username is taken, please choose another!";
            }
            else {
                document.getElementById('ajax_div').innerHTML = "Username is free :)";
            }
        }
    }
    xmlhttp.open("POST","validate.php",true);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("username=" + username);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:47:02.793

您应该使用 jquery 来验证使用 php 脚本。最好的方法是禁用提交按钮，直到所有字段都得到验证。这要求您聆听击键，然后进行 jquery 调用以验证输入字段。下面是一个简单的例子

```
script.js

var typingTimer;                //timer identifier
var doneTypingInterval = 5000;  //time in ms, 5 second for example

//on keyup, start the countdown
$('#myInput').keyup(function(){
    typingTimer = setTimeout(doneTyping, doneTypingInterval);
});

//on keydown, clear the countdown 
$('#myInput').keydown(function(){
    clearTimeout(typingTimer);
});

//user is "finished typing," do something
function doneTyping () {
  $.ajax({
      type: "POST",
      url: 'ajax/validate.php',
      data: 'cname='+$('#name').val(),
      success: function(data) {
         if(data == "original"))
           //enable the submit button
         else
          //Update your div that contains the results
      }
  });
}

ajax/validate.php

<?PHP
   //Run your validations here
?> 
```

# perl - 在 perl 中使用正则表达式匹配检查 perl 中的空格

> ID：11731762
> 
> 赞同：1
> 
> 时间：2012-07-31T01:03:07.277
> 
> 标签：perl, perl-module

我有一个变量如何使用 perl 中的正则表达式来检查字符串中是否有空格？例如：

```
$test = "abc small ThisIsAVeryLongUnbreakableStringWhichIsBiggerThan20Characters"; 
```

所以对于这个字符串，它应该检查字符串中的任何单词是否不大于某些 x 字符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T01:09:31.880

```
#!/usr/bin/env perl

use strict;
use warnings;

my $test = "ThisIsAVeryLongUnbreakableStringWhichIsBiggerThan20Characters";
if ( $test !~ /\s/ ) {
    print "No spaces found\n";
} 
```

请务必阅读 Perl 中的正则表达式。

[Perl 正则表达式教程 -`perldoc perlretut`](http://perldoc.perl.org/perlretut.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T01:07:10.723

你应该看看[perl regex 教程](http://perldoc.perl.org/perlretut.html)。根据您的问题调整他们的第一个“Hello World”示例如下所示：

```
if ("ThisIsAVeryLongUnbreakableStringWhichIsBiggerThan20Characters" =~ / /) {
    print "It matches\n";
}
else {
    print "It doesn't match\n";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-31T01:25:32.543

```
die "No spaces" if $test !~ /[ ]/;        # Match a space
die "No spaces" if $test =~ /^[^ ]*\z/;   # Match non-spaces for entire string

die "No whitespace" if $test !~ /\s/;     # Match a whitespace character
die "No whitespace" if $test =~ /^\S*\z/; # Match non-whitespace for entire string 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T12:00:04.917

要找到最长的不间断非空格字符序列的长度，请写下

```
use strict;
use warnings;

use List::Util 'max';

my $string = 'abc small ThisIsAVeryLongUnbreakableStringWhichIsBiggerThan20Characters';

my $max = max map length, $string =~ /\S+/g;

print "Maximum unbroken length is $max\n"; 
```

**输出**

```
Maximum unbroken length is 61 
```

# java - 菜单系统有效但无法关闭

> ID：11731766
> 
> 赞同：1
> 
> 时间：2012-07-31T01:03:56.837
> 
> 标签：java, swing, canvas, jframe, awt

好的，所以我已经建立了我的菜单系统并使用 JFrame 工作。一切似乎都很好，直到我单击启动画布的按钮。现在画布所做的是初始化一个扩展 Canvas 的 JFrame，因此我不能使用线程。一旦框架启动并运行，它就会调用一个方法，在此之后我无法关闭框架。在使用静态 void main 运行画布应用程序之前，这从来都不是问题。如何解决新 JFrame 未关闭的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T01:34:39.113

> 如何解决新 JFrame 未关闭的问题？

不要阻塞 EDT（事件调度线程）——当这种情况发生时，GUI 将“冻结”。与其创建无限循环，不如实现一个`SwingWorker`for 长时间运行的任务。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T09:50:19.280

**1.**在使用 GUI 应用程序时将此作为经验法则，即**始终保持 UI 在 UI 线程上工作，非 UI 在非 UI 线程上工作。**

**2.**其次**不要**混淆`SWING`AND `AWT`。

**3.** Java Gui 中的**main() 方法寿命不长**，**在 Event Dispatcher Thread (EDT) 中调度工作后，**该`main()`方法**退出**。现在它完全由**EDT 负责处理 GUI。**

**4.**因此，切勿将非 UI 流程密集型工作与 EDT 混为一谈。

使用 EDT 处理 GUI。

**例如：**

```
public static void main(String[] args){

     EventQueue.invokeLater(new Runnable(){

                myframe.setVisible(true);

       });

 } 
```

# html - iframe 中的链接

> ID：11731767
> 
> 赞同：0
> 
> 时间：2012-07-31T01:03:58.027
> 
> 标签：html, forms, iframe, submit

所以，

我有一个从 SQL 数据库输出一堆东西的循环。它还输出带有其中一些输出的表单。

整个循环序列通过嵌入到我网站一列中的 iframe 显示。

我不知道这是一种正确的方法，但它似乎运作良好。

但是，当用户在表单中单击“提交”时。链接功能正常，但它带给用户的页面仍然显示在 iframe 中。

相反，我希望它们被完整地带到新的页面。

有什么建议吗？

我应该澄清一下：iframe 的目的是创建一个可滚动的窗口/框，这样如果输出的行数更多，那么我的模板就不会成为问题。也许还有另一种更简单的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:27:03.407

您不需要 iframe 来制作可滚动框。只需指定元素的大小并使用`overflow`样式使其可滚动。

例子：

```
.formContainer { width: 300px; height: 500px; overflow: auto; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:08:27.257

在表单中指定一个`target`属性，以便它将在整个窗口中加载

```
<form target="_top"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:08:29.397

我不确定我是否会为此使用 IFrame，因为它自己起作用。我建议考虑使用 AJAX。 如果您不确定从哪里开始，[W3schools有一篇非常好的文章。](http://www.w3schools.com/ajax/ajax_aspphp.asp)

# python - 在 Red Hat 6 上安装 numpy？

> ID：11731768
> 
> 赞同：2
> 
> 时间：2012-07-31T01:04:09.240
> 
> 标签：python, linux, numpy, installation, rhel6

我正在尝试在具有 Python 2.7 的 Red Hat (RHEL6) 64 位 linux 机器上安装 numpy。我从 Sourceforge 下载并解压了 numpy 1.6.2，并在 numpy-1.6.2 文件夹中执行了以下命令：

```
python ./setup.py build
sudo python ./setup.py install #without sudo, this gives a permissions error. 
```

然后，当我`import numpy`在 Python 提示符下执行时，我得到`ImportError: No module named numpy`.

我在某处读到 numpy 1.6.2 是针对 Python 3.x 的，所以我也用 numpy 1.5.1 尝试了上述步骤，并且得到了相同的`ImportError`.

我推测解决方案在于一些环境变量体操，但我不确定 Python 需要“查看”哪些文件/目录不在范围内。关于如何让 numpy 工作的任何建议？

我还为 RHEL 尝试了一些预编译的二进制文件，但是当我这样做时它们给出了各种错误`sudo yum install [numpy precompiled binary url].rpm`。

顺便说一句，我安装 numpy 的动机是使用[PyGnuplot](http://sourceforge.net/projects/pygnuplot/)。另外，我之前在其他机器上安装过 numpy 和 PyGnuplot，但它一直在 Ubuntu 和 Mac OS 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-21T09:32:15.953

RHEL6 附带 numpy 1.4.1，请参阅[distrowatch](http://distrowatch.com/table.php?distribution=redhat&pkglist=true&version=rhel-6.7#pkglist)。如果 1.4.1 对您来说足够新，您可以安装它：

```
$ yum install numpy 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:59:06.297

当我使用 setup.py 在 Ubuntu 上安装 Python 包时，包最终会在

> /usr/local/lib/python2.7/dist-packages/

假设 Python2.7

如果在那里安装了 numpy，则需要将此路径附加到 Python 路径：

```
export PYTHONPATH=$PYTHONPATH:/usr/local/lib/python2.7/dist-packages/ 
```

您可以使用 ~/.profile 永久附加它

另一种方法是将 .pth 添加到已经在 Python 路径上的目录中，例如

```
echo "/usr/local/lib/python2.7/dist-packages/" > /usr/local/lib/python2.7/site-packages/dist_pkg.pth 
```

当然以root身份运行最后一个命令

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-08-16T00:49:01.527

我放弃了使用 RedHat，并在 VM 中安装了 Ubuntu。这是一个使用`apt-get`.

不是手头问题的理想解决方案，但我只是不想再花时间寻找 RedHat 的解决方案。

# mapreduce - 组合器和减速器可以不同吗？

> ID：11731770
> 
> 赞同：12
> 
> 时间：2012-07-31T01:04:36.647
> 
> 标签：mapreduce, reducers, combiners

在许多 MapReduce 程序中，我看到一个 reducer 也被用作组合器。我知道这是因为这些程序的特殊性质。但我想知道它们是否可以不同。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-31T03:06:13.100

是的，combiner 可以与 Reducer 不同，尽管您的 Combiner 仍将实现 Reducer 接口。组合器只能用于依赖于工作的特定情况。Combiner 将像 Reducer 一样运行，但仅在每个 Mapper 输出的 Key/Values 子集上运行。

与 Reducer 不同，Combiner 将具有的一个约束是输入/输出键和值类型**必须**与 Mapper 的输出类型匹配。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-31T02:11:13.357

是的，它们肯定会有所不同，但我不认为你想使用不同的类，因为大多数情况下你会得到意想不到的结果。

组合器只能用于可交换(ab = ba) 和关联 {a.(bc) = (ab).c} 的函数。这也意味着组合器可能仅对您的键和值的子集进行操作，或者可能根本不执行，但您仍然希望程序的输出保持不变。

选择具有不同逻辑的不同类可能不会为您提供逻辑输出。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-04-09T20:44:28.527

这是实现，您可以在没有组合器和组合器的情况下运行，两者都给出完全相同的答案。这里Reducer和Combiner有不同的动机和不同的实现。

```
package combiner;

import java.io.IOException;

import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;

public class Map extends Mapper<LongWritable, Text, Text, Average> {

Text name = new Text();
String[] row;

protected void map(LongWritable offSet, Text line, Context context) throws IOException, InterruptedException {
    row = line.toString().split(" ");
    System.out.println("Key "+row[0]+"Value "+row[1]);
    name.set(row[0]);
    context.write(name, new Average(Integer.parseInt(row[1].toString()), 1));
}} 
```

减少类

```
public class Reduce extends Reducer<Text, Average, Text, LongWritable> {
    LongWritable avg =new LongWritable();
    protected void reduce(Text key, Iterable<Average> val, Context context)throws IOException, InterruptedException {
    int total=0; int count=0; long avgg=0;

    for (Average value : val){
        total+=value.number*value.count;
        count+=value.count;
        avgg=total/count;   
        }
    avg.set(avgg);
    context.write(key, avg);
}
} 
```

地图对象类

```
public class Average implements Writable {

long number;
int count;

public Average() {super();}

public Average(long number, int count) {
    this.number = number;
    this.count = count;
}

public long getNumber() {return number;}
public void setNumber(long number) {this.number = number;}
public int getCount() {return count;}
public void setCount(int count) {this.count = count;}

@Override
public void readFields(DataInput dataInput) throws IOException {
    number = WritableUtils.readVLong(dataInput);
    count = WritableUtils.readVInt(dataInput);      
}

@Override
public void write(DataOutput dataOutput) throws IOException {
    WritableUtils.writeVLong(dataOutput, number);
    WritableUtils.writeVInt(dataOutput, count);

}
} 
```

合路器类

```
public class Combine extends Reducer<Text, Average, Text, Average>{

protected void reduce(Text name, Iterable<Average> val, Context context)throws IOException, InterruptedException {
    int total=0; int count=0; long avg=0;

    for (Average value : val){
        total+=value.number;
        count+=1;
        avg=total/count;    
        }
    context.write(name, new Average(avg, count));

}
} 
```

司机班

```
public class Driver1 {

public static void main(String[] args) throws Exception { 

    Configuration conf = new Configuration();
    if (args.length != 2) {
        System.err.println("Usage: SecondarySort <in> <out>");
        System.exit(2);
    }
    Job job = new Job(conf, "CustomCobiner");
    job.setJarByClass(Driver1.class);
    job.setMapperClass(Map.class);
    job.setCombinerClass(Combine.class);
    job.setMapOutputKeyClass(Text.class);
    job.setMapOutputValueClass(Average.class);
    job.setReducerClass(Reduce.class);
    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(IntWritable.class);     
    FileInputFormat.addInputPath(job, new Path(args[0]));
    FileOutputFormat.setOutputPath(job, new Path(args[1]));
    System.exit(job.waitForCompletion(true) ? 0 : 1);
}
} 
```

[从这里](https://github.com/koushikpaul1/Workspace/tree/AdvanceHadoop/practice/src/combiner)Git 代码

留下你的建议..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-08T17:54:40.343

组合器的主要目标是优化/最小化将在映射器和缩减器之间跨网络洗牌的键值对的数量，从而尽可能节省带宽。

combiner 的经验法则是它必须具有相同的输入和输出变量类型，原因是无法保证组合器的使用，它可以使用或不可以使用，具体取决于溢出的数量和数量。

当满足这个规则时，reducer 可以用作组合器，即相同的输入和输出变量类型。

组合器的另一个最重要的规则是它只能在您要应用的函数既可交换又可关联时使用。喜欢添加数字。但不是平均情况（如果您使用与减速器相同的代码）。

现在回答你的问题，是的，当然它们可以不同，当你的减速器有不同类型的输入和输出变量时，你别无选择，只能制作你的减速器代码的不同副本并修改它。

如果你关心 reducer 的逻辑，你也可以用不同的方式实现，比如在组合器的情况下，你可以有一个集合对象来拥有一个本地缓冲区，其中包含所有进入组合器的值，这更少比在 reducer 中使用它有风险，因为在 reducer 的情况下，它比在 combiner 中更容易耗尽内存。其他逻辑差异当然可以存在并且确实存在。

# java - 2 单例的实现

> ID：11731771
> 
> 赞同：0
> 
> 时间：2012-07-31T01:04:44.443
> 
> 标签：java, design-patterns, static, singleton

我知道在 java 中实现单例模式的两种方法，我想知道哪一种更好以及为什么。

第一种方法是：

1.  声明类私有的构造函数
2.  让类中的所有内容都静态 - 基本上让类实例本身成为单例

第二种方法是：

1.  声明类私有的构造函数
2.  有一个静态成员来保存单例（可能是类的实例）
3.  有一个静态的 getInstance() 方法

我倾向于认为，即使第二种方法是最常见的，第一种方法可能会产生更好的代码可读性，这两种方法在运行时复杂性方面似乎同样有效，所以我真的不明白为什么第二种方法更常见的原因和被认为是更好的做法......

开导我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T01:07:28.853

第一种方法不是单例。*单例*是一个类，其中只有一个实例，不能多也不能少。第一个东西有时被称为“静态类”、“实用程序类”或“不可实例化的类”。

有许多事情可以用“真正的”单例来做，而不能用实用程序类做。例如，你可以有一个实现接口或扩展另一个类的单例；你不能用全静态方法来做到这一点。all-static-methods 类通常证明没有进行面向对象的设计分析

至于在 Java 中实现单例模式有多少种方法，实际上有很多有趣的方法，使用不同的语言特性将初始化延迟到绝对需要时：类加载、枚举，或者只是一个同步块和一个`if`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T01:16:00.117

使用单例的其他类的可测试性受到静态方法的阻碍。使用实例，您可以替换模拟对象或其他形式的测试替身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:08:38.463

## 基于对象的单例的优点

1.  在任何可能无法想象的情况下，您的“单身人士”会成为非单身人士吗？也许您需要按线程、按连接或其他分类？2 号门让您拥有未来，无需重写代码。

2.  您可能有一个单例，但您是否只有该单例的一个实现？一种常见的模式是让工厂方法查看运行时环境并确定单例提供的“服务”的哪个实现是合适的。commons-logging LogFactory 就是这种类型的单例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T04:57:59.593

好吧，实现单例模式的有趣方法很少。让我回忆一下我读过的一些实现：

1.  您在问题中提到的第二种方法。（不是线程安全的）
2.  当您开发多线程应用程序时，您可能必须使用锁（简单线程安全）

    公共密封类单例{静态单例实例=空；静态只读对象挂锁=新对象（）；

    ```
    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            lock (padlock)
            {
                if (instance==null)
                {
                    instance = new Singleton();
                }
                return instance;
            }
        }
    } 
    ```

    }

3.  双重检查锁定

    公共密封类单例{静态单例实例=空；静态只读对象挂锁=新对象（）；

    ```
    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            if (instance==null)
            {
                lock (padlock)
                {
                    if (instance==null)
                    {
                        instance = new Singleton();
                    }
                }
            }
            return instance;
        }
    } 
    ```

    }

4.  不懒惰，但不使用锁是线程安全的

    公共密封类 Singleton { static readonly Singleton instance=new Singleton();

    ```
    // Explicit static constructor to tell C# compiler
    // not to mark type as beforefieldinit
    static Singleton()
    {
    }

    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            return instance;
        }
    } 
    ```

    }

5.  完全惰性初始化

    公共密封类 Singleton { Singleton() { }

    ```
    public static Singleton Instance
    {
        get
        {
            return Nested.instance;
        }
    }

    class Nested
    {
        // Explicit static constructor to tell C# compiler
        // not to mark type as beforefieldinit
        static Nested()
        {
        }

        internal static readonly Singleton instance = new Singleton();
    } 
    ```

    }

第三种方法在 java 中不起作用。Becos Java 内存模型不能确保构造函数在对新对象的引用分配给实例之前完成。

希望这对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T01:11:50.100

如果我得到你的问题，对。

为什么这是#2

```
public class MySingleton {

  static private MySingleton instance=new MySingleton();

  private MySingleton() {}

  static public MySingleton getInstance() { return instance; }

} 
```

优于#1

...对不起，我没有得到第一点...->实际上是从其他评论中读到的。我确认，拥有静态方法并不意味着你有一个单身人士。所以比较甚至不公平；-/

不管是什么，#2 更好的原因是因为多线程。当单例从静态初始化器初始化时，jvm 确保只有一个线程实例化该类。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-31T01:07:11.350

也许考虑使用枚举实现单例：

```
public enum Singleton {
INSTANCE;

public void doStuff() {
    System.out.println("Whoopee");
}
} 
```

并称它为`Singleton.INSTANCE.doStuff()`

这是 Josh Bloch 在《Effective Java》一书中推荐的

# java - 如何在一个动作事件后延迟 onTouch？

> ID：11731772
> 
> 赞同：0
> 
> 时间：2012-07-31T01:04:49.513
> 
> 标签：java, android, touch

我正在开发一个涉及使用触摸来增加价值的应用程序。为了阻止该值上升过快，我创建了一个布尔值，在调用方法之前检查为真，并在调用后将其设置为假。我这样做是因为不可能双击并添加两倍应该添加到值的值。但是，我注意到，如果您足够快地触摸屏幕，您可以在第一次调用中设置布尔值之前调用该方法。但我知道基本功能是有效的，因为如果我在第二次触摸之前稍等片刻，布尔值就会正确设置并且不会调用该方法。

我想知道是否有办法阻止android在一段时间内检测触摸事件或延迟设置布尔值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T08:11:38.243

您可以使用[BlockingQueue](http://developer.android.com/reference/java/util/concurrent/BlockingQueue.html)

示例代码：

```
BlockingQueue<Integer> queue = new LinkedBlockingQueue<Integer>(1);

public boolean onTouch(View v, MotionEvent event) {
    switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            queue.offer(1); // add queue if empty
            return true;

        return false;
    }
}

public void run() {
        while (true) {
            try {
                queue.take(); // wait for item in queue
                // this code is executed after putting item into queue

                // TODO

                Thread.sleep(100); // wait before next execution
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:31:54.037

我认为你应该使用 ReentrantLock 来同步你的应用程序逻辑。

# php - Mysql更新不适用于隐藏字段

> ID：11731773
> 
> 赞同：1
> 
> 时间：2012-07-31T01:04:55.577
> 
> 标签：php, mysql

我有一个问题，我有一个相当基本的 crud 应用程序网站。我在编辑部分遇到问题，我有文本输入并在页面上选择下拉菜单。对于所有文本输入，我可以使该值等于数据库中该行已经存在的值，因此，如果我通过 edit.php 并且不编辑某些字段，该值仍然保留并且没有为我没有接触过的领域擦干净。不幸的是，我使用 Jquery 来填充一些选择/下拉菜单，所以这种方法不起作用。

示例场景：

我是一个用户，添加一个企业，第一个类别是餐厅，子类别是美国食品，第二个类别是家庭服务，子类别是家庭维修。然后我点击“保存”按钮并插入我的类别。然后我意识到我忘记将我的姓名和电话号码添加到我的列表中，所以我编辑列表，这次只插入我的姓名和电话号码，并将所有其他字段留空。有了我现在所拥有的，我第一次保存的类别和子类别现在要么设置为 0，要么设置为空白。

我对此的解决方案是填充一些隐藏字段（命名为 beforecat1、beforesubcat1 等），这些字段存储了之前字段的值，然后如果未触及选择，则插入隐藏字段的值。不幸的是，有些东西不起作用。

```
<? 
include('../config.php'); 
if (isset($_GET['id']) ) { 
   $id = (int) $_GET['id']; 
   if (isset($_POST['submitted'])) { 
       foreach($_POST AS $key => $value) { $_POST[$key] = mysql_real_escape_string($value); }

   if(isset($_REQUEST['cselect1'])){
       $cselect1 = $_REQUEST['cselect1'];
       $query="SELECT cat FROM cat WHERE id='$cselect1'";
       $result = mysql_query ($query);
       while($catselect=mysql_fetch_array($result)){
           $catselect1 = $catselect['cat'];
       }
   } else {
   $catselect1 = $_REQUEST['beforecat1'];
   }
   if(isset($_REQUEST['cselect2'])){
   $cselect2 = $_REQUEST['cselect2'];

   $query="SELECT cat FROM cat WHERE id='$cselect2'";
   $result = mysql_query ($query);
   while($catselect=mysql_fetch_array($result)){
      $catselect2 = $catselect['cat'];
   }
   } else {
   $catselect2 = $_REQUEST['beforecat2'];
   }
   if(isset($_REQUEST['cselect3'])){
   $cselect3 = $_REQUEST['cselect3'];

   $query="SELECT cat FROM cat WHERE id='$cselect3'";
   $result = mysql_query ($query);
   while($catselect=mysql_fetch_array($result)){
   $catselect3 = $catselect['cat'];
   }
   } else {
   $catselect3 = $_REQUEST['beforecat3'];
   }

   $sql = "UPDATE `company` SET  `name` =  '{$_POST['name']}' ,  `phone` =  '{$_POST['phone']}' ,  `cat1` =  '$catselect1' ,  `cat2` =  '$catselect2' ,  `cat3` =  '$cselect3' ,  `zipcode` =  '{$_POST['zipcode']}' ,  `city` =  '{$_POST['city']}' ,  `address` =  '{$_POST['address']}' ,  `address2` =  '{$_POST['address2']}' ,  `website` =  '{$_POST['website']}' ,  `product1` =  '{$_POST['product1']}' ,  `product2` =  '{$_POST['product2']}' ,  `product3` =  '{$_POST['product3']}' ,  `product4` =  '{$_POST['product4']}' ,  `product5` =  '{$_POST['product5']}' ,  `product6` =  '{$_POST['product6']}' ,  `product7` =  '{$_POST['product7']}' ,  `subcat1` =  '{$_POST['sselect1']}' ,  `subcat2` =  '{$_POST['sselect2']}' ,  `subcat3` =  '{$_POST['sselect3']}'   WHERE `id` = '$id' "; 
   mysql_query($sql) or die(mysql_error());

   $sql = "UPDATE `company_secondary` SET  `company_description` =  '{$_POST['description']}' ,  `since` =  '{$_POST['since']}' ,  `smoking` =  '{$_POST['select3']}' ,  `delivery` =  '{$_POST['select5']}' ,  `alcohol` =  '{$_POST['select6']}' ,  `kids` =  '{$_POST['select1']}' ,  `wheelchair` =  '{$_POST['select2']}' ,  `twitter` =  '{$_POST['twitter']}' ,  `facebook` =  '{$_POST['facebook']}' ,  `youtube` =  '{$_POST['youtube']}' ,  `premium` =  '{$_POST['premium']}' ,  `creditcards` =  '{$_POST['select4']}' ,  `outdoor` =  '{$_POST['select7']}' ,  `featured` =  '{$_POST['featured']}' ,  `shortdesc` =  '{$_POST['shortdesc']}' WHERE company_id = '$id' "; 
   mysql_query($sql) or die(mysql_error());

   echo "Edited Row<br/>";
   echo "<a href='allbiz.php'>Back To Listing</a>"; 
} 
```

$row = mysql_fetch_array (mysql_query("SELECT * FROM `company`WHERE `id`= '$id'"));

?>

这是我的表格的一部分：

```
<form action='' method='POST'> 
<p><b>Name:</b><br /><input type='text' name='name' value='<?= $row['name'] ?>' /> 
<p><b>Phone:</b><br /><input type='text' name='phone' value='<?= stripslashes($row['phone']) ?>' />
<?php
    $cat1 = stripslashes($row['cat1']);
    $cat2 = stripslashes($row['cat2']);
    $cat3 = stripslashes($row['cat3']);
    $subcat1 = stripslashes($row['subcat1']);
    $subcat2 = stripslashes($row['subcat2']);
    $subcat3 = stripslashes($row['subcat3']);
?>
<input type='hidden' value='<?php echo $cat1;?>' name='beforecat1'/>
<input type='hidden' value='<?php echo $cat2;?>' name='beforecat2'/>
<input type='hidden' value='<?php echo $cat3;?>' name='beforecat3'/>
<input type='hidden' value='<?php echo $subcat1;?>' name='beforesubcat1'/>
<input type='hidden' value='<?php echo $subcat2;?>' name='beforesubcat2'/>
<input type='hidden' value='<?php echo $subcat3;?>' name='beforesubcat3'/>
<p><b>Cat1:</b><br />
<?php
   $query="SELECT * FROM cat";
   $result = mysql_query ($query);
   echo"<select name='cselect1' id='cat1'><option value='0'>Please Select A Category</option>";
   // printing the list box select command
   while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
        echo "<option value=\"".htmlspecialchars($catinfo['number'])."\">".$catinfo['cat']."</option>";

   }
   echo"</select>";
?>
<?php
   $query="SELECT * FROM subcat";
   $result = mysql_query ($query);
   echo"<select name='sselect1' id='subcat1'><option value=''>Sub Category</option>";
   echo $subcat1;
   echo"'>$sucat1</option>";
   // printing the list box select command
   while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
       echo "<option value='".htmlspecialchars($catinfo['subcat'])."' class='".$catinfo['catnumber']."'>".$catinfo['subcat']."</option>";
   }

   echo"</select>";
 ?>

 <?php
  $query="SELECT * FROM cat";
  $result = mysql_query ($query);
  echo"<select name='cselect2' id='cat2'><option value='0'>Please Select A Category</option>";
  // printing the list box select command
  while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
      echo "<option value=\"".htmlspecialchars($catinfo['number'])."\">".$catinfo['cat']."</option>";

  }
  echo"</select>";
 ?>

 <?php
    $query="SELECT * FROM subcat";
    $result = mysql_query ($query);
    echo"<select name='sselect2' id='subcat2'><option value=''>Sub Category</option>";
    echo $subcat1;
    echo"'>$sucat1</option>";
 // printing the list box select command
    while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
        echo "<option value='".htmlspecialchars($catinfo['subcat'])."' class='".$catinfo['catnumber']."'>".$catinfo['subcat']."</option>";
    }

 echo"</select>";
 ?>

 <?php
 $query="SELECT * FROM cat";
 $result = mysql_query ($query);
 echo"<select name='cselect3' id='cat3'><option value='0'>Please Select A Category</option>";
 // printing the list box select command
 while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
     echo "<option value=\"".htmlspecialchars($catinfo['number'])."\">".$catinfo['cat']."</option>";

 }
 echo"</select>";
?>
<?php
 $query="SELECT * FROM subcat";
 $result = mysql_query ($query);
 echo"<select name='sselect3' id='subcat3'><option value=''>Sub Category</option>";
 // printing the list box select command
 while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
 echo "<option value='".htmlspecialchars($catinfo['subcat'])."' class='".$catinfo['catnumber']."'>".$catinfo['subcat']."</option>";
 }

 echo"</select>";
?> 
```

怎么了？感谢大家的帮助，这是困扰我很久的问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:25:49.360

我认为您的解决方案可能是将默认的选定值设置为`<select>`从数据库中提取时的当前值。

让我们展开这个：

```
 if(isset($_REQUEST['cselect1'])){
   $cselect1 = $_REQUEST['cselect1'];
   $query="SELECT cat FROM cat WHERE id='$cselect1'";
   $result = mysql_query ($query);
   while($catselect=mysql_fetch_array($result)){
       $catselect1 = $catselect['cat'];
   }
  } else {
    $catselect1 = $_REQUEST['beforecat1'];
  } 
```

虽然我不是 100% 确定你在做什么，但看起来你根据提交的 id 获取了一个值，并将 var $catselect1 设置为类别名称？

我们可以使用其中任何一个，但由于问题的关键在于 $catselect1 让我们使用它。

所以在这里，在这个区域：

```
<?php
$query="SELECT * FROM cat";
$result = mysql_query ($query);
echo"<select name='cselect1' id='cat1'><option value='0'>Please Select A Category</option>";
// printing the list box select command
while($catinfo=mysql_fetch_array($result)){//Array or records stored in $nt
     echo "<option  value=\"".htmlspecialchars($catinfo['number'])."\">".$catinfo['cat']."</option>";

}
echo"</select>";
?> 
```

在您的时间里，我们需要将 $catselect1 值与我认为是您的类别名称进行比较，与 $catinfo['cat'] （这也是一个名称？？）并添加如下条件：

```
if (  $catselect1 == $catinfo['cat'] )
  //this one is selected, because the values match!
  echo "<option default selected value=\"".htmlspecialchars($catinfo['number'])."\">".$catinfo['cat']."    </option>";
} else {
  //do normally
  echo "<option  value=\"".htmlspecialchars($catinfo['number'])."\">".$catinfo['cat']."     </option>";
} 
```

因此，当您的表单被加载时，您的选择将默认为数据库中设置的值，并且如果重新提交它们将传递相同的值。

希望这有点道理！

PS：对于简单的真/假回声，我更喜欢这种方法：

```
 echo ( $comparison == $comparison ) ? 'true' : 'false'; 
```

# umbraco - Umbraco 获取元素子子项 - 触发弹出

> ID：11731779
> 
> 赞同：0
> 
> 时间：2012-07-31T01:05:55.197
> 
> 标签：umbraco

在这里解决一个相当困难的问题。

这是我的树结构：

![在此处输入图像描述](../Images/e82ae9ebc3aef79766b28fb6c50a9a76.png)

目前，如果您要访问“社区庆祝活动”页面，您将看到此页面上列出的所有“庆祝活动”。

这是页面吐出的内容：![在此处输入图像描述](../Images/8f985d41381d94da39624b29b02c13a4.png)

要确定哪个节点是“庆典”，请查看“Banswara”正在使用的图标 - 这是“庆典”。

在下方，您将看到名为 Stat、Community Video、Touching Story 和 Photo 的节点。

我想要实现的目标（并且不确定是否可能）在“社区庆祝活动”页面（见上图）上列出了所有庆祝活动我希望能够呈现您在底部看到的视频。用户如何输入此视频是通过“社区视频”节点中的 umbraco RTE。用户将插入 YouTube“对象”嵌入代码，但有一个问题。解决这个问题是没有问题的，如果用户要点击播放图标或在视频空间中，我需要一个弹出窗口来触发其中包含视频。

我正在为当前的 jquery 弹出窗口使用 fancybox，并且能够在 umbraco 中这样做，您需要一个包含要在其中呈现的内容的专用模板 - 我的想法是这无法完成，因为视频内容来自另一个节点然而，一个专门的模板，也许有人有替代选择。

我知道大帖子，但这是一个艰难的帖子！

欢迎所有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T22:52:26.370

有关此问题的解决方案，请参阅此处：

[http://our.umbraco.org/forum/developers/xslt/33536-Umbraco-get-element-sub-child-trigger-pop-up](http://our.umbraco.org/forum/developers/xslt/33536-Umbraco-get-element-sub-child-trigger-pop-up)

# android - Android MediaRecorder - 启动失败：2.3.3 上的 -2147483648

> ID：11731785
> 
> 赞同：2
> 
> 时间：2012-07-31T01:06:29.690
> 
> 标签：android, mediarecorder

MediaRecorder 适用于其他版本的 Android，但不适用于 2.3.3：

```
try {

    MediaRecorder mRecorder = new MediaRecorder();
    mRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
    mRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
    mRecorder.setOutputFile( path + "r_" + FileName );

    int version = android.os.Build.VERSION.SDK_INT;
    Log.d("MP3Downloader", "V: " + version );

    if( version >= 8 ) {
        mRecorder.setAudioEncodingBitRate(16);
        mRecorder.setAudioSamplingRate(44100);
        mRecorder.setAudioChannels(2);
    }

    mRecorder.prepare();
    mRecorder.start();
} catch (Exception e) {
    Log.e("MP3Downloader", "MediaRecorder Failed: " + e.getMessage() );
} 
```

我收到错误 Start Failed: -2147483648 仅在版本 2.3.3 上。我在其他任何地方都没有发现这个问题。

我也试过：

```
try {

    MediaRecorder mRecorder = new MediaRecorder();
    mRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
    mRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);

    FileOutputStream fos = new FileOutputStream( "r_" + FileName);

    mRecorder.setOutputFile( fos.getFD() );

    int version = android.os.Build.VERSION.SDK_INT;
    Log.d("MP3Downloader", "V: " + version );

    if( version >= 8 ) {
        mRecorder.setAudioEncodingBitRate(16);
        mRecorder.setAudioSamplingRate(44100);
        mRecorder.setAudioChannels(1);
    }

    mRecorder.prepare();
    mRecorder.start();
} catch (Exception e) {
    Log.e("MP3Downloader", "MediaRecorder Failed: " + e.getMessage() );
} 
```

但是，我得到异常：“（只读文件系统）”

我有权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.RECORD_AUDIO" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T12:37:14.247

尝试将输出格式更改为`3gpp`.

# javascript - 将数组作为参数传递给对象

> ID：11731786
> 
> 赞同：1
> 
> 时间：2012-07-31T01:06:29.477
> 
> 标签：javascript

我是 javascript 的新手，并且可能试图做一些愚蠢的事情，因为一个小时的谷歌搜索没有产生任何示例。

我正在尝试学习对象，所以我制作了一个这样的构造函数：

```
//generic object
function clip(name, xposition, firstVisibleFrame, lastVisibleFrame, playStart, playEnd, defaultFrame, seqLoopStart, seqLoopEnd, backStateLevel){
this.name = name;
this.xposition = xposition;
this.outlinesArray =[];
this.firstVisibleFrame = firstVisibleFrame;
this.lastVisibleFrame = lastVisibleFrame;
this.outlinePath = ("outlines/" +this.name +"_");
this.playStart = playStart;
this.playEnd = playEnd;
this.defaultFrame = defaultFrame;
this.seqLoopStart = seqLoopStart;
this.seqLoopEnd = seqLoopEnd;
this.backStateLevel = backStateLevel;
}; 
```

接下来，我将创建该对象的一个​​新实例，例如：

```
livingroomTable = new clip("livingroomTable"); 
```

...但现在我真的卡住了，因为我应该传递给函数的下一个参数实际上是一个包含数百个值的巨大数组..

我试图将数组放在这样的参数中：

```
 livingroomTable = new clip("livingroomTable", [value1, value2, value3, value4, value5 and so on and so on]); 
```

但这给了我一个语法错误。

我也不想让这个数组成为全局变量。将值数组作为函数调用参数的一部分传递的正确语法是什么？

编辑：

这是实际的代码：

```
//generic object
function clip(name, xposition, firstVisibleFrame, lastVisibleFrame, playStart, playEnd, defaultFrame, seqLoopStart, seqLoopEnd, backStateLevel){
this.name = name; //objektin nimi tulee funktion kutsusta
this.xposition = xposition;
this.outlinesArray =[];
this.firstVisibleFrame = firstVisibleFrame;
this.lastVisibleFrame = lastVisibleFrame;
this.outlinePath = ("outlines/" +this.name +"_");
this.playStart = playStart;
this.playEnd = playEnd;
this.defaultFrame = defaultFrame;
this.seqLoopStart = seqLoopStart;
this.seqLoopEnd = seqLoopEnd;
this.backStateLevel = backStateLevel;
};

livingroomTable = new clip(
"livingroomTable", //name

["1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1220.69","1216.69","1207.69","1194.69","1167.69","1157.01","1147.24","1137.62","1127.74","1118.55","1109.88","1100.17","1090.51","1080.69","1070.28","1059.5","1048.87","1038.21","1027.6","1017.31","1007.31","997.208","987.153","977.152","967.848","959.258","950.808","942.887","935.103","927.326","919.256","910.834","902.452","894.231","886.561","879.269","872.072","865.057","858.292","851.484","844.527","837.655","830.747","823.629","815.898","807.221","798.142","789.152","780.341","771.358","762.248","753.089","743.97","734.954","726.148","717.699","709.299","700.826","692.102","682.849","673.258","663.37","653.188","642.48","631.498","620.551","609.866","599.544","589.439","579.088","568.508","557.794","547.028","536.037","524.912","514.043","502.899","491.412","480.102","469.097","457.844","446.368","434.919","423.84","412.74","401.657","390.55","379.284","368.162","357.316","346.606","335.973","325.144","314.01","302.658","291.207","279.392","267.133","254.62","241.775","229.179","216.763","204.423","192.239","180.41","168.484","155.502","141.701","127.828","114.008","100.403","87.0368","73.5946","59.7342","45.3524","31.0484","16.8761","helmi.96","-11.522","-25.6947","-39.5332","-53.1723","-66.7146","-80.253","-93.1294","-106.086","-119.531","-133.534","-148.801","-165.444","-183.67","-202.813","-222.634","-242.769","-263.074","-283.495","-303.787","-322.998","-341.376","-359.338","-377.081","-395.064","-413.628","-432.233","-451.409","-472.675","-493.827","-515.078","-537.029","-558.747","-583.8","-610.595","-645.864","-695.789","-711.965","-737.979","-752.979","-836.048","-862.75","-864.75","-884.835","-911.473","-927.473","-969.103","-1030.36","-1002.83","-1036.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08","-1048.08"];, //xposition

352, //firstVisibleFrame

545, //lastVisibleFrame

2058, //playStart

2304, //playEnd

2175, //defaultFrame

-1000, //seqLoopStart

-1000, //seqLoopEnd

1 //backStateLevel

); 
```

嗯实际上我认为我的问题是数组末尾的分号对吗？:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:15:34.253

您使用的原理没有错。

您可以将数组放入变量中，并将其传递给函数：

```
theArray = [1,2,3,4,5];
livingroomTable = new clip("livingroomTable", theArray); 
```

或者您可以直接在调用中使用数组文字：

```
livingroomTable = new clip("livingroomTable", [1,2,3,4,5]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:17:19.487

您收到*SyntaxError*`;`是因为数组末尾有一个分号。

删除它，错误应该消失。

```
["1220.69","1220.69", ..., "-1048.08","-1048.08","-1048.08"];, // <-- right here 
```

* * *

它应该看起来像这样......

```
["1220.69","1220.69", ..., "-1048.08","-1048.08","-1048.08"], // <-- just a comma 
```

* * *

您可能需要考虑使用[JSHint 之](http://jshint.com)类的代码验证器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-31T01:12:45.187

因此，您的构造函数不需要字符串和数组参数。你必须这样调用：

```
livingroomTable = new clip("livingroomTable", value1, value2, value3, value4, ...); 
```

# c# - 用 C# 编写类似的数据源 (Visual Studio)

> ID：11731787
> 
> 赞同：0
> 
> 时间：2012-07-31T01:06:45.837
> 
> 标签：c#, winforms, visual-studio-2010, devexpress

我正在尝试开发类似的数据源（Visual Studio）。我已经完成了所有界面（简单的部分），但这个项目的棘手部分是：

1 - 我需要根据用户在他（她）计算机上安装的内容填充数据源，这意味着如果他没有 Oracle，则不会显示该选项卡。-> 这就是我遇到困难的部分。

![我想要达到的目标](../Images/53e0729f76a16a6e99ade486cecb2301.png)

绑定部分，我有一个草图，使用 ifs（或开关）使用数据源字段中的文本。

我在界面中使用 DevX ！

有任何想法吗 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:15:26.557

由于没有 .NET API 来获取列表，因此您必须使用 Windows 注册表来查找列表。

[这](http://www.devtoolshed.com/content/get-list-odbc-data-source-names-programatically-using-c)是查找数据源名称的好教程.......

# java - jsp 财产

> ID：11731789
> 
> 赞同：0
> 
> 时间：2012-07-31T01:06:49.633
> 
> 标签：java, javascript, jsp, struts-validation, struts-html

我需要循环传递来自 jsp 文件属性的值。这是代码

```
</tr>
                    <%

                    for (int i = 0; i < value.size(); i++) {
                        <html:form action="save" method="post" styleId="update" enctype="multipart/form-data">
                        <input type=hidden id="secfeaturetype" name="secfeaturetype" value="" />

                        <html:file property="testfile" styleId="testfile"/>
                        <input type="button" value="Update" onclick='javascript:check_updatefields()' />
                        </html:form>
                        </td>
                    </tr> 
```

我正在尝试在 javascript 中进行一些验证，它只正确读取第一个文件而不是其余文件。有任何想法吗 ？

```
function check_updatefields() {
    var file = jQuery('#testfile').val();
    alert(testfile);
 } 
```

我在这里错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T03:03:55.840

正如我在上面的评论中提到的，id 属性应该是唯一的，因此在循环中创建具有相同 id 的元素会给您无效的 html，并且`$("#testfile")`只会选择具有该 id 的第一个元素（在某些可能选择的浏览器中除外只有最后一个）。

对于重复元素，一个更好的解决方案是给它们一个公共类，并根据它们属于哪个容器，或者根据与其他元素的已知关系（如果不是容器）来区分它们。或者，如果包含元素足够独特，则按标记名选择，或者按`name`属性选择。您似乎正在使用 jQuery，它使这些选项中的任何一个都变得容易。

我认为你可以把你的代码整理成这样：

```
<table id="yourTableIdHere">
<% for (int i = 0; i < value.size(); i++) { %>
   <tr><td>
      <html:form action="save" method="post" styleId="update" enctype="multipart/form-data">
         <input type=hidden name="secfeaturetype" value="" />
         <html:file property="testfile" styleClass="testfile"/>
         <input type="button" value="Update" />
      </html:form>
   </td></tr>
<% }%>
</table> 
```

我对 Struts html 标签库不是很熟悉，但我相信`styleClass="testfile"`会渲染一个属性`class="testfile"`（如果不是，请替换任何合适的东西来渲染`class=...`）。请注意，我删除了您的内联`onclick=...`属性。您可以使用 jQuery 一步分配这些处理程序：

```
$(document).ready(function() {
   // assign a click handler to all the Update buttons that are
   // within forms within your table element:
   $('#yourTableIdHere form input[type="button"][value="Update"]').click(function() {
       var $myForm = $(this).parent();  // or $(this).closest('form'),
           $myFileInput = $myForm.find('input.testfile'),
           $myHiddenInput = $myForm.find('input[type="hidden"]');
       alert($myFileInput.val());       // alert value of file input
       $myHiddenInput.val("something"); // set value of hidden
   });
}); 
```

在单击处理程序中，`this`是单击的按钮，因此`$(this)`您可以导航到父元素以获取对特定按钮所属表单的引用，并且您可以使用该表单`.find()`在当前表单中选择文件和隐藏输入.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:09:09.400

“id”，表示它在你的页面中是唯一的，所以如果有多个，浏览器只会识别第一个元素，所以这里你最好使用“class”，更正如下：styleClass="testfile"。js：jQuery（'.testfile'）。

# shell - 将一组文本文件中的图像复制到子目录中

> ID：11731794
> 
> 赞同：0
> 
> 时间：2012-07-31T01:07:54.377
> 
> 标签：shell, cygwin, file-manipulation

我有一个包含大约 100 个子文件夹的文件夹。在每个子文件夹中，有 4 个文本文件和 1 个或 2 个包含图像的文件夹以及与 4 个文本文件对应的 4 个当前空文件夹。在每个文本文件中，都有一个需要从图像文件夹移动到特定文件夹的图像列表。

这是一个插图：

```
 /Textures/Asymmetrical/ contains
    /Asymmetrical/
    /Asymmetrical+Texture/
    /1/  /2/  /3/  /4/
    /1.txt  /2.txt  /3.txt  /4.txt 
```

在 1.txt 中，有一个文件列表需要从 /Textures/Asymmetrical/Asymmetrical/ 或 /Textures/Asymmetrical/Asymmetrical+Texture/ 进入 /Textures/Asymmetrical/1/ 等等。

但并非所有文件夹都采用这种精确格式——下面还有另一种类型：

```
 /Textures/Zigzagged/ contains
    /images/
    /1/  /2/  /3/  /4/
    /1.txt  /2.txt  /3.txt  /4.txt 
```

这些文件/文件夹的目的应该从上面开始，除了这更容易使用，因为它只有 1 个图像文件夹。

现在我在shell中编写了以下代码：

```
 filename='1.txt' #I was going to do the text files one at a time..
    #Hidden: I set the value of filename2 to another text file.
    while read f;
    do
       while read g;
       do
          cp ./$f""/images/$g $f""/2_Good/
          cp ./$f""/$f/$g $f""/2_Good/
          cp ./$f""/$f""+texture/$g $f""/2_Good/
       done < $f""/$filename
    done < $filename2 
```

现在这确实有效，但会产生很多错误，因为有些文件夹确实有 images 子文件夹，而另一些则没有，依此类推。但我完全可以忍受。更大的问题是程序会在一段时间后放弃，可能是在复制了大约 40-200 张图像之后。我有数以万计的图像要移动，所以我不会费心去复制这种大小的块。我收到如下错误：

```
 8 [main] -bash 5796 fork:child -1 - forked process 5764 died unexpectedly, retry 0, exit code -1073741819, errno 11
    ./moveAround.sh: fork: retry: Resource temporarily unavailable
    ./moveAround.sh: fork: Resource temporarily unavailable 
```

所以我想我要求要么 1）修复我的代码，要么 2）这个问题的通用解决方案，可以在很少的监督下工作。

# css - 白色背景上div的CSS白色或透明背景色？

> ID：11731795
> 
> 赞同：2
> 
> 时间：2012-07-31T01:08:04.033
> 
> 标签：css, background-color

我在前端工作并经常使用速记符号设置 CSS 背景。我想知道一个带有背景图像的 div，其父 div 有白色背景 - 孩子应该有背景色白色还是透明？*哪个性能*更好？

IE：

```
<div id='parent' style='background:white;'>
    <div id='child' style='background:WHITE image no-repeat center center;'></div>
</div> 
```

**或者**

```
<div id='parent' style='background:white;'>
    <div id='child' style='background:TRANSPARENT image no-repeat center center;'></div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:14:28.663

只需不要在速记声明中设置背景颜色。你可以跳过它。
节省带宽，css-browser-rendering-performance 完全取决于用户/访问者的浏览器！

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:34:02.757

每个人都建议你放弃声明是对的。这是很好的级联。

但是，当内部元素需要白色背景时，您可能希望将其声明为白色 - 在这种情况下，如果该元素将出现在其他地方，则将其包含在内是明智的。

我想说，无论哪种方式的性能提升基本上都不明显。

# php - 将多维数组降低（未嵌套）一层

> ID：11731812
> 
> 赞同：0
> 
> 时间：2012-07-31T01:11:34.887
> 
> 标签：php

尽管这工作得很好，但我很好奇是否有人知道这样做的更漂亮的方法，因为这种情况似乎经常出现。

```
<?php
//Initialy,  data is nested up in $some_array[0] ...
$some_array = array(array('somevar' => "someValue", "someOtherVar" => "someOtherValue"));

print_r($some_array); 
```

数组（[0] => 数组（[somevar] => someValue [someOtherVar] => someOtherValue））

```
// Could the following line be achieved a more elegant fashion?
$some_array = $some_array[0];

print_r($some_array);

// Prints the intended result: 
```

数组（ [somevar] => someValue [someOtherVar] => someOtherValue ）

有谁知道用本机功能或更优雅的方式实现这一目标的方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T17:23:13.713

您正在寻找的本机函数称为[`reset`](http://php.net/reset)（[Demo](http://codepad.org/P81AzleP)）：

```
$some_array = reset($some_array); 
```

为了明确说明： `current`没有必要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:18:30.330

您可以使用`current`（[在此处](http://be2.php.net/manual/en/function.current.php)解释），它基本上指向数组中的第一个元素并返回它。

为了绝对确定你得到第一个元素，你应该重置你的数组，如下所示：

```
reset($arr)
$firstElement = current($arr) 
```

# emacs - 它是 Emacs gdb-many-windows-mode 中标题上的按钮还是选项卡？

> ID：11731814
> 
> 赞同：6
> 
> 时间：2012-07-31T01:11:42.733
> 
> 标签：emacs, gdb, gud

某些窗口在 gdb-many-windows-mode 的标题上具有可点击的按钮或选项卡，例如“Locals/Registers”或“Breakpoints/Threads”。它们是标签吗？我可以在它们旁边添加新的吗？ ![看到这个](../Images/01e446e77e19a606401bb066dea3679a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T13:47:35.237

纽扣。

> 当 gdb-many-windows 不是 nil 时，GDB Breakpoints 缓冲区与 GDB Threads 缓冲区共享它的窗口。要从一个切换到另一个，请在标题行中的相关按钮上单击 Mouse-1。如果 gdb-show-threads-by-default 不为零，则 GDB 线程缓冲区是默认显示的缓冲区。[来源](http://www.gnu.org/software/emacs/manual/html_node/emacs/Breakpoints-Buffer.html#Breakpoints-Buffer)

如果您想尝试添加按钮，您可能必须扩展 gdb-mi.el。我不确定这是否可能没有麻烦。

# windows - 对 Win32 API 调用在汇编中的工作方式感到困惑

> ID：11731816
> 
> 赞同：5
> 
> 时间：2012-07-31T01:11:49.510
> 
> 标签：windows, winapi, assembly, x86, nasm

我不知道如何更好地问这个，但为什么会这样：

```
call ExitProcess 
```

做同样的事情吗？：

```
mov eax, ExitProcess
mov eax, [eax]
call eax 
```

我认为这些将是等效的：

```
call ExitProcess 
```

```
mov eax, ExitProcess
call eax 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T01:20:14.830

从 DLL 导入代码时，符号`ExitProcess`实际上并不是退出进程的代码的地址（它是*address 的地址*）。因此，在这种情况下，您必须取消引用它才能获得实际的代码地址。

这意味着您必须使用：

```
call [ExitProcess] 
```

调用它。

例如，[此位置](http://forum.codecall.net/topic/65224-intro-to-win32-assembly-using-nasm-part-3/)的一些代码包含以下内容：

```
;; Note how we use 'AllocConsole' as if it was a variable. 'AllocConsole', to 
;; NASM, means the address of the AllocConsole "variable" ; but since the 
;; pointer to the AllocConsole() Win32 API function is stored in that 
;; variable, we need to call the address from that variable. 
;; So it's "call the code at the address: whatever's at the address
;; AllocConsole" . 
call [AllocConsole] 
```

* * *

但是，直接在用户代码中导入 DLL 并不是获得该功能的唯一方法。我将解释为什么你会在下面看到这两种方式。

调用 DLL 函数的“正常”方式是先从 DLL 中标记`extern`它`import`：

```
extern ExitProcess
import ExitProcess kernel32.dll
:
call [ExitProcess] 
```

因为这会将符号设置为对代码的*间接*引用，所以您需要间接调用它。

经过一番搜索，在野外似乎有使用裸形式*的代码：*

```
call ExitProcess 
```

据我所知，这一切似乎都使用了`alink`链接器，它与`win32.lib`库文件链接。该库可能提供了用于调用*实际*DLL 代码的存根，例如：

```
import ExitProcessActual kernel32.dll ExitProcess
global ExitProcess

ExitProcess:
    jmp [ExitProcessActual] 
```

在中，这将从DLL`nasm`导入地址并调用它，请记住，此地址是对代码的间接引用，而不是代码本身的地址。`ExitProcess``ExitProcessActual`

然后它将导出`ExitProcess`入口点（此 LIB 文件中的入口点，而不是 DLL 中的入口点），以便其他人可以使用它。

然后有人可以简单地写：

```
extern ExitProcess
:
call ExitProcess 
```

退出进程 - 库将跳转到实际的 DLL 代码。

* * *

事实上，通过更多的研究，这*正是*正在发生的事情。从下载`alink.txt`附带的文件中`alink`：

> Win32 的示例导入库包含在`win32.lib`. `Kernel32`, `User32`, `GDI32`, `Shell32`, `ADVAPI32`, `version`, `winmm`,`lz32`和`commdlg`中的所有命名导出`commctl`都包括在内。
> 
> 采用：
> 
> `alink -oPE file[.obj] win32.lib`
> 
> 包括它或指定
> 
> `INCLUDELIB "win32"`
> 
> 在您的源文件中。
> 
> 这包括一系列用于导入重定向的条目 - `call MessageBoxA`，并跳转到`[__imp_MessageBoxA]`导入表中的 。
> 
> `call [__imp_importName]`因此，如果使用 代替 ，对导入的调用将运行得更快`call importName`。
> 
> 看`test.asm`，我的示例程序，它以两种方式调用一个消息框：

```
includelib "win32.lib"
extrn MessageBoxA:near
extrn __imp_MessageBoxA:dword

codeseg

start:
push 0 ; OK button
push offset title1
push offset string1
push 0
call MessageBoxA

push 0 ; OK button
push offset title1
push offset string2
push 0
call large [large __imp_MessageBoxA] 
```

（`__imp_MessageBoxA`是从DLL中导入的符号，相当于我`ExitProcessActual`上面的）。

# git - 将新分支推送到 google.com git 存储库

> ID：11731818
> 
> 赞同：2
> 
> 时间：2012-07-31T01:12:08.807
> 
> 标签：git

从现有的 code.google 项目开始，并成功推送初始代码。

我在本地副本上创建了一个新分支。我提交了分支的更改，现在我想将分支推送到 code.google 存储库。我输入这个：

```
git push origin branch_name -v https://username:password@code.google.com/p/project-name/ 
```

但我得到这个错误

> 致命：refspec 的远程部分不是[https://username:password@code.google.com/p/project-name/中的有效名称](https://username:password@code.google.com/p/project-name/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:22:42.853

通常你不需要指定推送目的地的完整 URL，因为远程`origin`已经指向那个（`git remote -v`列表类型）。所以也许你需要的只是：

```
git push origin branch_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:23:10.827

命令的语法`push`：

```
git push [ <options> ] <repository> [ <refspec> ] 
```

在最简单的情况下，`<options>`为空，`<repository>`通常为`origin`，并且`<refspec>`是您当前分支的名称：

```
git push origin branch_name 
```

这假设您`origin`通过克隆远程存储库或使用`git remote add ...`命令创建了一个名为 的远程。如果您尚未配置远程，您可以在命令行中替换 URL，如下所示：

```
git push https://username:password@code.google.com/p/project-name/ branch_name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T07:04:33.960

在远程服务器上将本地分支推送为新分支：

> git push origin local_branch_name:remote_branch_name_that_will_be_created

# android - Android：使用 MAT 查找内存泄漏

> ID：11731820
> 
> 赞同：0
> 
> 时间：2012-07-31T01:12:38.790
> 
> 标签：android, memory-leaks

我的应用程序存在重大问题。当我运行它并选择某个活动时，屏幕变黑并且基本上冻结了。我在 logcat 中得到了一长串 GC 消息。我下载了 MAT 并让它分析堆以查找内存泄漏。我的问题是我是新手，我不知道它告诉我泄漏在哪里。

以下是它给我的三个。谁能向我解释如何解决这些问题？我一直在疯狂搜索，似乎找不到任何帮助。

问题1：

```
The class "android.database.sqlite.SQLiteDatabase$ActiveDatabases", loaded by "<system class loader>", occupies 652,048 (20.70%) bytes. The memory is accumulated in one instance of "java.util.HashMap$HashMapEntry[]" loaded by "<system class loader>". 
```

问题2：

```
6,831 instances of "java.lang.String", loaded by "<system class loader>" occupy 456,472 (14.49%) bytes. 
```

问题3：

```
127 instances of "org.bouncycastle.jce.provider.X509CertificateObject", loaded by "<system class loader>" occupy 451,280 (14.32%) bytes. These instances are referenced from one instance of "java.util.Hashtable$HashtableEntry[]", loaded by "<system class loader>" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:49:43.870

首先，您应该检查 SQLiteDatabase 游标是否在不使用时关闭，尤其是在遇到异常后。我认为你应该长期观察你“相信”的这些问题。因为 MAT 只是推测这些。你必须有证据表明某些对象占用了很大的内存导致你的应用程序被系统杀死。否则，你应该“搜索”android 著名的内存泄漏问题用google找个线索。</p>

祝你好运！</p>

# mysql - 如何提示要在 MySQL 选择查询中使用的索引？

> ID：11731822
> 
> 赞同：42
> 
> 时间：2012-07-31T01:12:59.133
> 
> 标签：mysql, sql, indexing, hint

我有一个 MySQL 查询（运行 MySQL 5.0.88），我正在尝试加快速度。基础表有多个索引，对于有问题的查询，使用了错误的索引（`i_active`- 16.000 行，与`i_iln`- 7 行）。

我对 MySQL 不是很有经验，但读到有一个`use index`提示，它可以强制 mySQL 使用某个索引。我正在尝试这样：

```
 SELECT art.firma USE INDEX (i_iln)
 ... 
```

但这会产生 MySQL 错误。

**问题**：
谁能告诉我我做错了什么？（除了运行 5.0.88，我无法更改。）

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-07-31T01:15:06.383

你错过了

```
FROM table 
```

正确的 SQL 应该是：

```
SELECT art.firma FROM your_table USE INDEX (i_iln) WHERE .... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-31T01:14:37.663

```
select * from table use index (idx); 
```

[http://dev.mysql.com/doc/refman/5.0/en/index-hints.html](http://dev.mysql.com/doc/refman/5.0/en/index-hints.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-11T06:07:05.500

有时，**使用 index (index_name)**优化器可能会进行表扫描，如果您使用提示**强制索引**，优化器将被迫使用索引，只有在没有办法获取提供索引的行时才会进行表扫描。

```
SELECT art.firma FROM art FORCE INDEX (i_iln); 
```

**有关使用 INDEX**和**FORCE INDEX**提示的更多详细信息，请查看此[链接](https://dev.mysql.com/doc/refman/8.0/en/index-hints.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-05-29T11:02:02.350

> 选择 Coloumn1,Coloumn2,Coloumn.... **FROM** *TABLE_NAME* **使用索引**( *index_name* ) **WHERE** Coloumn="condition";

如果你有正确的索引，那么你不需要使用 index()。您的查询自动选择正确的索引。如果您的查询在使用索引后变慢然后重新检查您的索引，则索引有问题。在此先感谢。在此处输入代码

# javascript - Onblur，Onfocus javascript for TextMode="MultiLine" 不起作用

> ID：11731831
> 
> 赞同：0
> 
> 时间：2012-07-31T01:13:53.967
> 
> 标签：javascript, asp.net, html

我有一个多行 asp.textbox 输入控件。

我不知道我的问题是与 ASP.NET、Multiline 控件还是其他东西有关，但 onblur 和 onfocus 不起作用。

```
<script type="text/javascript">
  var defaultMsg = 'Write your message here or or call my voice at (xxx) xxx-xxxx.';
  var controlMsg = doc.createElement("input");
  controlMsg.id = "txtMessage";
  controlMsg.type = "text";
  controlMsg.value = defaultMsg;
  controlMsg.onfocus=function jpFocus() { if (this.value == defaultMsg) this.value = ''; }
  controlMsg.onblur=function jpBlur() { if (this.value == '') this.value = defaultMsg; }
</script> 
```

然后....

```
<asp:TextBox ID="txtMessage" Columns="30" Rows="6" runat="Server" TextMode="MultiLine" /> 
```

有没有人看到为什么这不应该工作的原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:19:04.987

实际上，您正在创建一个 html 元素，并且正在向它附加一个事件。此外，ASP.NET 控件不使用服务器端 id。这是你应该做的：

```
var controlMsg = document.getElementById('<%= txtMessage.ClientID %>');
controlMsg.onfocus = // Some Code ...
controlMsg.onblur = // Some Code ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T04:00:46.550

尝试使用匿名函数，如下所示：

```
controlMsg.onfocus=function() { if ( ... 
```

[功能和功能范围 - MDN](https://developer.mozilla.org/en/JavaScript/Reference/Functions_and_function_scope/)。

另外，您确实调用了类似的东西`document.body.appendChild(controlMsg);`，不是吗？

**编辑：**

您正在使用`doc.createElement`. 确保`doc`绝对指向`document`.

此外，查看 Firefox 中的页面，查看错误控制台中是否有任何错误或警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T04:29:20.580

不确定您使用的是哪个版本。请试试这个：

```
protected void Page_Load(object sender, EventArgs e)  
 {
   txtMessage. Attributes["onfocus"]="JavascriptMethod";  
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T11:07:08.670

我不确定为什么这行得通而其他技术没有，但这让我的 HTML 工作：

```
 <textarea name="txtMsg" rows="6" cols="30"
      onfocus="if(this.value==this.defaultValue)this.value='';" 
      onblur="if(this.value==='')this.value=this.defaultValue;">[Write your message here or call my voice number at (555) 222-1234.]</textarea> 
```

文本可能很长，控件似乎并不在意。此外，文本只写在一个位置。

# java - 日期/时间转换/算术

> ID：11731833
> 
> 赞同：0
> 
> 时间：2012-07-31T01:14:00.823
> 
> 标签：java, date, java.util.date, date-conversion, date-arithmetic

我在 Java 1.7 中有以下代码：

```
DateFormat df = DateFormat.getInstance();
Date startDate = df.parse("07/28/12 01:00 AM, PST"); 
```

上述日期时间（07/28/12 01:00 AM，PST）位于可配置的属性文件中。如果这个日期时间已经过去，那么我需要获取当前日期，从上面的字符串中设置时间部分，即当前日期的 01:00 AM PST & 如果这个时间也已经过去，那么获取第二天 &从上面的字符串中设置时间部分。最终对象应该是 Date 因为我需要在 Timer 对象中使用它。

我怎样才能有效地做到这一点？我应该从日期转换为日历还是反之亦然？任何人都可以提供片段吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:21:02.830

你应该去[`Calendar`](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html)上课。您可以使用以下结构：

```
 Calendar cal = Calendar.getInstance();
    cal.setTime(startDate);
    cal.add(Calendar.DAY_OF_YEAR, 1); 
```

它还具有检查您`startDate`的日期`before()`或`after()`新日期（使用当前时间）的方法。

在编写内置的 Java 日期/时间结构时，如果我没有插入[Joda Time](http://joda-time.sourceforge.net/)，我会失职，许多人认为它优于本地 Java 实现。

编辑：

显示该过程的示例会更有效`Date.compareTo()`，因为需要`Calendar.before()`与`Calendar.after()`其他`Calendar`对象进行比较，这可能会很昂贵。

看看以下内容：

```
 DateFormat df = DateFormat.getInstance();
    Date startDate = df.parse("07/28/12 01:00 AM, PST");
    Calendar cal = Calendar.getInstance();
    cal.setTime(startDate);
    Date now = new Date();
    if (startDate.compareTo(now)< 0) {
        System.out.println("start date: " + startDate + " is before " + now);

        Calendar nowCal = Calendar.getInstance();
        nowCal.add(Calendar.DAY_OF_YEAR,1);
        cal.set(Calendar.DAY_OF_YEAR, nowCal.get(Calendar.DAY_OF_YEAR));

    } else  if (startDate.compareTo(now) == 0) {
        System.out.println("startDate: " +startDate + " is equal to " + now);
    } else {
        System.out.println("startDate: " + cal + " is after " + now);

    }
    System.out.println(cal.getTime()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:20:53.777

我认为这应该可以工作...您的算法让我有些头晕，而且我在不同的时区，所以您的原始字符串不起作用：P

```
 try {

        DateFormat df = DateFormat.getInstance();
        Date startDate = df.parse("28/07/2012 01:00 AM");

        System.out.println("StartDate = " + startDate);

        Date callDate = startDate;

        Calendar today = Calendar.getInstance();
        Calendar start = Calendar.getInstance();
        start.setTime(startDate);

        System.out.println("Today = " + today.getTime());

        // If this date time is already passed
        // Tue Jul 31 12:18:09 EST 2012 is after Sat Jul 28 01:00:00 EST 2012
        if (today.after(start)) {

            //then I need to get the current date, set the time part from above string in the current date
            Calendar timeMatch = Calendar.getInstance();
            timeMatch.setTime(startDate);
            timeMatch.set(Calendar.DATE, today.get(Calendar.DATE));
            timeMatch.set(Calendar.MONTH, today.get(Calendar.MONTH));
            timeMatch.set(Calendar.YEAR, today.get(Calendar.YEAR));

            //& if this time is also already passed, then get the next day & set the time part from above string in it
            if (timeMatch.after(today)) {

                timeMatch.add(Calendar.DATE, 1);

            }

            callDate = timeMatch.getTime();

        }

        System.out.println("CallDate = " + callDate);

    } catch (ParseException exp) {

        exp.printStackTrace();

    } 
```

这会产生以下输出

```
StartDate = Sat Jul 28 01:00:00 EST 2012
Today = Tue Jul 31 12:18:09 EST 2012
CallDate = Tue Jul 31 01:00:00 EST 2012 
```

# php - 遍历数据库中的每个 $RESULT

> ID：11731834
> 
> 赞同：0
> 
> 时间：2012-07-31T01:14:04.180
> 
> 标签：php, loops, foreach

```
<?php
## Loop through results from mysql
try{
    #connection string
        // $dbconn = new PDO('mysql:host=localhost;port=3306;dbname=mydb',array(PDO::ATTR_PERSISTENT => true));
        $dbconn = new PDO('mysql:host=localhost;port=3306;dbname=mydb','user','pass',array(PDO::ATTR_PERSISTENT => true));
        $q = $dbconn->prepare("SELECT FW_ArtSrcLink FROM FW_ArtSrc WHERE OneSet=1 and leagID=20");
    #call stored proc
        $q->execute();
    #get the rows into an array
        $result = $q->fetchAll();
        $newsStory = array();
    foreach($result as $r){
        $xmlUrl = $r['FW_ArtSrcLink'];
        $ConvertToXml = simplexml_load_file($xmlUrl);
        # -> Setup XML
        $newsStory[] = $ConvertToXml->channel->item;
    }
    # -----> Load News Stories
        for($i = 0;$i<sizeof($newsStory); $i++){

    # Source of Article Info-->
            $SrcTitle=$newsStory[$i]->title;
            $SrcLink=$newsStory[$i]->link;

    # Actual News Article Info -->
            $title=$newsStory[$i]->title;
            $desc=$newsStory[$i]->description;

    # Output Results ------------>      
            echo '<hr>';
            echo '<strong>'.'Title:'.$title.'</strong>'.'(via: <a href=\''.$SrcLink.'\'>'.$SrcTitle.'</a>'.'<br />';
            //echo 'Link:'.$link.'<br />';
            echo 'Description'.$desc.'<br>';
            ##echo 'count '.count($result);
            echo '<hr>';

            # echo 'sizeof newstory: '.sizeof($newsStory);
        }   // for()
} // try 
```

使用我想使用类似从每个链接收集所有s 的`foreach($result as $r)`东西来获取所有 xml 项目。我该怎么做？`$ConvertToXml->channel->item;``item`

# php - 如何更改页面的元标记？

> ID：11731840
> 
> 赞同：0
> 
> 时间：2012-07-31T01:15:00.510
> 
> 标签：php, ajax, meta-tags

我创建了一个 php 页面，它的内容是使用 jquery 加载的。我可以根据加载的内容更改页面的元标记，以便在 Facebook 中发布链接时显示正确的信息吗？

我尝试使用 JavaScript 更改元标记，但因为它是客户端它不起作用，所以页面的序号元标记总是显示在 facebook 中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:51:40.067

机器人不执行活动内容（ajax 请求）。因此，如何在 javascript 中完成它并不重要，因为 facebook（或其他机器人）只看到服务器在第一时间生成的页面。

# reporting-services - 在 SQL Server Report Builder 3.0 中将 Tablix 行高设置为特定数字？

> ID：11731843
> 
> 赞同：14
> 
> 时间：2012-07-31T01:15:12.273
> 
> 标签：reporting-services, sql-server-2008-r2, bids, ssrs-tablix, reportbuilder3.0

我正在尝试将详细信息行的行高设置为特定值，例如 0.5 英寸。如果单击详细信息行的 Tablix 句柄；它选择了行，但 Size 属性不会为 Height 属性扩展或允许在 Height 属性中输入 0.5 英寸之类的东西。

除了拖动控件来猜测高度之外，还有没有办法为行高输入一个特定的数字？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-31T22:49:10.880

可以通过更改行中单个单元格的高度来调整 Tablix 中任何行的高度。然后，该行中的所有单元格将采用最后更改的单元格的高度，即，如果您将第一列中的单元格高度更改为 0.5”，然后将同一行第二列中的单元格更改为 0.125”，则整个行高将更改为 0.125”。要更改报表生成器或 BIDS 中的行高度属性：选择一个单元格，在“属性”窗口中向下滚动到“位置”部分，展开“大小”子部分，然后编辑“高度”。

呈现报表时关于 Tablix 行高的特别说明；默认情况下，一行将调整为其内容的高度。通常内容是文本，如果行高不能容纳长字符串的第二行文本，则该行将变得高于设置的行高以容纳文本。如果效果不理想，则可以将 CanGrow 属性更改为 False。要更改一行的 CanGrow 属性：选择左侧的行句柄以选择该行中的所有单元格，在“属性”窗口中向下滚动到“通用”部分并将“CanGrow”更改为 False。当您在 Tablix 中有一个用于行间距的空白行时，这是最有用的；否则，即使没有文本，该行也会自动采用字体大小的高度，例如

当调整单元格的宽度时，行的相同概念适用于列，但它们不能像呈现报表时的高度那样增长或缩小。另请注意，当单元格与相邻单元格合并时，当合并单元格的宽度增加时，构成该部分最右侧的列通常会向右增加。因此，通常最好在调整列宽时拆分单元格以避免这种情况并避免无法减小宽度的列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-08T19:20:37.343

为此，在 Visual Studio 2010 中，单击 tablix 中的给定单元格。打开控件属性窗格（即 View | Other Windows | Property Window ）。前往职位 | 大小属性。将单元格设置为所需的高度或宽度。如 PerPlexSystem 所述，这将分别影响行或列中其余单元格的高度或宽度。

# iphone - 在辅助队列中执行 UI 更新

> ID：11731846
> 
> 赞同：0
> 
> 时间：2012-07-31T01:15:40.643
> 
> 标签：iphone, objective-c

我正在使用新的 CoreMotion 框架来监控一些硬件设备。这是执行此操作的典型代码：

```
-(void)startAccelerometer{
self.motion.accelerometerUpdateInterval = 1/30.0f;
NSOperationQueue* accelerometerQueue = [[NSOperationQueue alloc] init];
CMAccelerometerHandler accelerometerHandler = ^(CMAccelerometerData *accelerometerData, NSError *error) {

    NSLog(@"Accelerometer realtime values");
    NSLog(@"x=%f", accelerometerData.acceleration.x);
    NSLog(@"y=%f", accelerometerData.acceleration.y);
    NSLog(@"z=%f", accelerometerData.acceleration.z);
    NSLog(@"  ");

};
[self.motion startAccelerometerUpdatesToQueue:accelerometerQueue withHandler:[[accelerometerHandler copy]autorelease]]; 
```

}

这工作得很好。现在我想在 UILabel 上打印值，但由于 CoreMotion 框架让您使用块，因此不能保证它在主队列中（实际上不适用于我的应用程序）。像这样在主队列上运行标签的设置器是“错误的”吗？

```
-(void)startAccelerometer{
self.motion.accelerometerUpdateInterval = 1/30.0f;
NSOperationQueue* accelerometerQueue = [[NSOperationQueue alloc] init];
CMAccelerometerHandler accelerometerHandler = ^(CMAccelerometerData *accelerometerData, NSError *error) {
    dispatch_async(dispatch_get_main_queue(), ^{
        self.lblAccelerometer.text = [NSString stringWithFormat:@"Accelerometer:\nx = %f\ny = %f\nz = %f",
                                      accelerometerData.acceleration.x,
                                      accelerometerData.acceleration.y,
                                      accelerometerData.acceleration.z];

    });

};
[self.motion startAccelerometerUpdatesToQueue:accelerometerQueue withHandler:[[accelerometerHandler copy]autorelease]]; 
```

}

它工作得很好，我真的看不出有什么理由会不赞成。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:48:11.830

这是我在许多项目中使用的常用方法。UI 更新必须发生在主线程上。

```
//Dispatch on background thread
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    //background processing goes here

    //Dispatch on main thread
    dispatch_async(dispatch_get_main_queue(), ^{
            //update UI here
    });
}); 
```

在您的情况下，您的 UI 更新发生在主线程上。所以我不会担心改变任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:16:10.060

您误解了块的概念，简单地说：

块是可以作为变量处理并在特定时间或线程上执行的小段代码。

所有 UI 更新都必须在主线程上执行，所以只要你这样做就可以了。

代码可以在同步或异步模式下在具有不同优先级的不同线程中执行。在您的代码上，您做得非常好，您不仅将它分派到应该执行 uiupdates 的主队列，而且您还分派它异步，这是更新发送到主队列的最安全方式（来自您的代码我不知道您是从主队列还是辅助队列运行这段特定的代码，但是如果您要将同步块从主队列分派到主队列，您的程序将停止工作）

对于 iOS 文档：

> 使用 dispatch_get_main_queue 函数获取与应用程序主线程关联的串行调度队列。此队列是为 Cocoa 应用程序和调用 dispatch_main 函数或在主线程上配置运行循环（使用 CFRunLoopRef 类型或 NSRunLoop 对象）的应用程序自动创建的。

在这里阅读[http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW1](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW1)

# asp.net-mvc - 使用实体框架和 POCO 进行 ASP.Net MVC 验证

> ID：11731847
> 
> 赞同：1
> 
> 时间：2012-07-31T01:15:51.863
> 
> 标签：asp.net-mvc, entity-framework, poco

我有一个关于使用 MVC 和 POCO 进行验证的最佳实践的问题。据我所知，最佳实践是拥有一个反映 POCO 的 ViewModel，然后在验证 ViewModel（视图模型）后使用 AutoMapper 之类的东西将 ViewModel 解析为 POCO。

这一切都很好，但我想知道从 POCO 继承和仅删除我希望在视图模型中验证的属性是否有任何问题？

POCO：

```
public partial class Sector
    {
        public virtual int SectorId { get; set; }

        public virtual string Name { get; set; }
    } 
```

我的 ViewModel 可能如下所示：

```
public class SectorDTO : Sector
    {
         [Required]
         [StringLength(10)]
         public override string Name {get; set;}
    } 
```

**更新**

该解决方案最终无法正常工作，主要是由于我的业务层和数据层的设置方式。我的解决方案是创建一个包含所有验证的 DTO 的 ViewModel，然后使用 AutoMapper 将对象更改回 POCO 类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T12:45:35.960

我确实喜欢下面：

```
public partial class SectorMetaData
{
    [Required(ErrorMessage="Required Filed")]
    public int SectorId{ get; set;}
    [Required(ErrorMessage="Required Filed")]
    public string Name{get; set;}

}

[MetadataType(typeof(SectorMetaData))]
public partial class Sector
{
    public int SectorId{ get; set;}
    public string Name{get; set;}
} 
```

此类应与 POCO 类具有相同的命名空间。希望这可以帮助！

# java - CAB 上的 Android 持久性 gridview 选择器

> ID：11731857
> 
> 赞同：0
> 
> 时间：2012-07-31T01:17:20.150
> 
> 标签：java, android, listview, gridview, selector

我有一个使用自定义适配器的 GridView，它由一个包含图像视图的相对布局组成。我在 gridview 上启用了 MultiChoiceMode 并启用了 CAB（上下文操作栏）。这很好用，但是我很难在选择网格项时如何在网格项周围显示一个持久选择器。我的选择器在最初的按下时工作，但我还没有找到一种方法，它会一直持续到项目被取消选择。

**预期：** 用户长按一个项目，项目被选中，应用程序进入CAB模式。当每个项目被按下时，一个紫色框架（由我在 XML 中的选择器语句定义）将出现在每个对象周围，直到它们被取消选择。

**结果：** 用户长按一个项目，该项目短暂显示选择器，它消失了，用户没有得到选择或取消选择项目的视觉反馈，即使它已在代码中注册。

我已经尝试了每一个选择器事件，但似乎没有一个可以处理这个问题。任何解决方法？有什么我想念的吗？

通过尝试长按 Android 4.0 或 4.1 Gallery 应用程序中的项目来展示我试图实现的一个示例

**---> API 15 <---**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T04:23:12.313

尝试修改列表项的布局以具有不同的背景属性：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/listItemRelativeLayout" 
    android:layout_width="fill_parent" 
    android:layout_height="match_parent"
    android:background="?android:attr/activatedBackgroundIndicator">

    ...

</RelativeLayout> 
```

该 Android 属性引用了在您调用 listView.setItemChecked(int index, boolean checked) 时使用的选择器，并且由于某种原因，它似乎以这种方式工作。

此外，请验证您是否在列表视图中调用它：

```
listView.setChoiceMode(AbsListView.CHOICE_MODE_MULTIPLE); 
```

# c++ - 从文件中读取数字

> ID：11731860
> 
> 赞同：1
> 
> 时间：2012-07-31T01:17:58.263
> 
> 标签：c++, string, file, ifstream

我有一个包含很多数字的文件。该文件基本上看起来像“192 158 100 0 20 200”。如何一次加载文件编号 1 并将它们显示在 C++ 的屏幕上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T01:23:01.567

尝试这样的事情：

```
int val;
std::ifstream file("file");
while (file >> val)        
    std::cout << val; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T01:55:15.957

以下程序应打印每个数字，每行一个：

```
#include <iostream>
#include <fstream>

int main (int argc, char *argv[]) {
    std::ifstream ifs(argv[1]);
    int number;

    while (ifs >> number) {
       std::cout << number << std::endl;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:23:54.540

请考虑以下代码：

```
 ifstream myReadFile;
    myReadFile.open("text.txt");
    int output;
    if (myReadFile.is_open())
    {
        while (fs >> output) {   
            cout<<output;
        }
    }

//Of course closing the file at the end.
myReadFile.close(); 
```

同样，在使用上面的示例时，请在代码中包含 iostream 和 fstream。

请注意，您需要开始打开要读取的文件流，您可以尝试逐个字符地读取它，并检测它之间是否有任何空白。

祝你好运。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T01:50:46.597

```
#include <iostream>
#include <iterator>
#include <sstream>
#include <vector>

int main() {
    std::ifstream fs("yourfile.txt");
    if (!fs.is_open()) {
        return -1;
    }

    // collect values
    // std::vector<int> values;
    // while (!fs.eof()) {
    //    int v;
    //    fs >> v;
    //    values.push_back(v);
    // }
    int v;
    std::vector<int> values;
    while (fs >> v) {
        values.push_back(v);
    }
    fs.close();    

    // print it
    std::copy(values.begin(), values.end(), std::ostream_iterator<int>(std::cout, " "));

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-31T03:42:28.730

另一种方法：

```
std::string filename = "yourfilename";

//If I remember well, in C++11 you don't need the
//conversion to C-style (char[]) string.
std::ifstream ifs( filename.c_str() );

//Can be replaced by ifs.good(). See below.
if( ifs ) {
    int value;

    //Read first before the loop so the value isn't processed
    //without being initialized if the file is empty.
    ifs >> value;

    //Can be replaced by while( ifs) but it's not obvious to everyone
    //that an std::istream is implicitly cast to a boolean.
    while( ifs.good() ) { 
        std::cout << value << std::endl;
        ifs >> value;       
    }
    ifs.close();
} else {
    //The file couldn't be opened.
} 
```

错误处理可以通过多种方式完成。

# ruby-on-rails - 如何安全地存储应用程序 ID/密钥？

> ID：11731866
> 
> 赞同：2
> 
> 时间：2012-07-31T01:18:48.907
> 
> 标签：ruby-on-rails, security

使用托管在 Heroku 上的 Ruby on Rails 开发应用程序。

我们的应用程序有多个不同的应用程序 ID/密钥，由许多不同的服务（Facebook、Mixpanel 等）分配。我们现在正在添加一个支付系统，因此我们计划使用 Stripe。我们现在也有了一个 Stripe 应用 ID。

安全存储这些应用 ID 的最佳方式是什么？目前它们只是存储为 rails 环境变量。因此，所有员工都可以访问我们所有的应用程序 ID。

假设某个工程师变得“流氓”......然后他们可以毒害自己的 DNS 缓存并将 ourwebsite.com 匹配到他们控制的某个随机 IP 地址。因此，请求可能正在使用我们的应用 ID，但正在运行我们尚未确定的事务。

以安全/安全的方式存储所有这些不同的应用程序 ID 的好方法是什么？如果我们的一位联合创始人拥有这些应用程序 ID，我们很好，但最好应该有一种安全的方式来访问这些应用程序 ID，而不必透露这些 ID 的实际含义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:34:33.940

这是一个无法通过技术解决的问题，而是通过合同解决的。开发人员总是比执行团队更了解和更密切地接触项目，除非您有义务担心它（即遵守 PCI 或政府安全要求），否则您不应该担心。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-31T02:29:18.137

我不使用 Heroku，但做了类似于他们在这里描述的事情：[https ://devcenter.heroku.com/articles/config-vars](https://devcenter.heroku.com/articles/config-vars)

tl; dr：将您的 ID 放入环境变量中

# knockout.js - 在 Knockout JS 中向下钻取

> ID：11731867
> 
> 赞同：0
> 
> 时间：2012-07-31T01:19:02.893
> 
> 标签：knockout.js, knockout-2.0

我正在构建一个 Web 应用程序，并希望将 UI 转换为使用 Knockout JS。我是淘汰赛的菜鸟，所以请善待！

通常我会加载一个员工列表（使用 PHP），然后如果选择了一个员工，我会使用 JQuery 找到该员工的 ID，然后对我的后端进行 AJAX 调用，填写结果框并将其向下滑动。

有没有办法在 Knockout 中复制这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T14:16:20.983

在敲除/jquery 中处理 ajax 向下钻取的方法是使用敲除点击处理程序。这允许您然后拉任何属性或项目本身，然后在 jquery 中处理 ajax。下面是我的代码示例。

在 html 文件中：

```
...
<div class="empListName" data-bind="text: fullName(), click: $root.showEmp">
</div>
.... 
```

在js文件中：

```
function MainScreenViewModel() {
  // Data
  var self = this;
  self.employees = ko.observableArray([]);
  ...

  // Functions
  self.showEmp = function(data, event){
    var id = data.empId();
    var checkA = $(event.target).parent().find('.empListNameX').first();
    var expand = $(event.target).parent().next();
    if (checkA.hasClass('open')){ //Close it
        checkA.removeClass('open').addClass('closed');
        expand.slideUp();
    }else{
        $.get('/employee/getempinfo/'+id, function(info){
            checkA.addClass('open').removeClass('closed');
            expand.html(info).slideDown();
        })
    }
  }
  ...
} 
```

# mongodb - 更新 MongoDB 文档以进行地理空间搜索

> ID：11731871
> 
> 赞同：1
> 
> 时间：2012-07-31T01:19:59.607
> 
> 标签：mongodb, geospatial

目前，我在 MongoDB 数据库中的不同字段中有我的纬度/经度，但如果我想进行地理空间搜索，我需要采用这种格式：

```
{ location : [ 50 , 30 ] } 
```

如上所述，我可以通过什么方式将我的 lat/long 键的值转换为每个文档的新键？

蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T04:14:40.887

您将不得不遍历所有没有`location`字段的文档并添加它（大概删除纬度/经度字段，除非这会破坏您的应用程序）。

```
db.mycollection.find( { location : { $exists : false } } ).forEach(
    function (doc) {
        // Add (lon, lat) pairs .. order is important
        doc.location = { lon: doc.lon, lat: doc.lat };

        // Remove old properties
        delete doc.lon;
        delete doc.lat;

        // Save the updated document
        db.mycollection.save(doc);
    }
) 
```

请注意，MongoDB[地理空间索引](http://www.mongodb.org/display/DOCS/Geospatial+Indexing/)的顺序在您的文档中应与（经度、纬度）一致。

# ruby-on-rails - Spree::Config 和 Application::Config 一样吗？

> ID：11731875
> 
> 赞同：1
> 
> 时间：2012-07-31T01:20:47.433
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我经常在狂欢模型上看到这个配置，如果这是为了什么？如果我调用 Application::Config 或 Rails::Config 是一样的吗？

这个配置是什么意思？

是某种配置回调吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T09:20:49.907

不，它们是完全不同的东西。[这里](http://guides.spreecommerce.com/preferences.html)有很好的记录。

# javascript - AwesomiumSharp 中的 Javascript 执行

> ID：11731876
> 
> 赞同：0
> 
> 时间：2012-07-31T01:20:49.970
> 
> 标签：javascript, awesomium

我将 Awesomium 集成到客户端应用程序中。然后我让 Awesomium 加载自定义的本地 html 文件，我在其中使用了我的 Javascript 代码。很简单，当我点击按钮时，这段代码会打开一个新的 URL。

代码是这样的：

```
<input type="button" value="click to open" onclick='loadUrl()' />

function loadUrl()
{
    window.open("http://www.google.com", "_self");
} 
```

但是当我单击按钮时什么也没发生。我也在 Chrome 浏览器中测试了这段代码，它工作正常。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:30:53.193

不要使用保留字“_self”作为目标窗口名称。使用其他东西（或“_blank”）。

# android - 有没有办法自定义 ViewPager 滚动的阈值？

> ID：11731878
> 
> 赞同：9
> 
> 时间：2012-07-31T01:21:16.980
> 
> 标签：android

我无法找到一种方法来更改 ViewPager 中滚动页面的触摸阈值：http: [//developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

查看[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.4_r1.2/android/support/v4/view/ViewPager.java)，ViewPager 有一个名为 determineTargetPage 的方法，用于检查移动触摸手势距离是否 > 阈值范围，但看起来无法修改此范围。

关于如何控制这个阈值的任何建议（如果可能的话）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-31T06:37:19.783

在这里有点四肢走动；我毫不怀疑您可能需要调整这个概念和/或代码。

我会推荐我在上面的评论中所做的；扩展`ViewPager`和覆盖其公共构造函数，并调用一个自定义方法，该方法是`initViewPager()`（在您提供的源代码中看到的）的克隆。但是，正如您所指出的，`mFlingDistance`、`mMinimumVelocity`和`mMaximumVelocity`是`private`字段，因此子类无法访问它们。

*（注意：如果您愿意，也可以在调用构造函数**后更改这些方法。）***

这是有点棘手的地方。在 Android 中，我们可以使用[Java 反射 API](http://mobile.tutsplus.com/tutorials/android/java-reflection/)来使这些字段可访问。

它应该像这样工作：

```
Class clss = getClass.getSuperClass();
Field flingField = clss.getDeclaredField("mFlingDistance"); // Of course create other variables for the other two fields
flingField.setAccessible(true);
flingField.setInt(this, <whatever int value you want>); // "this" must be the reference to the subclass object 
```

然后，使用您想要的任何值对其他两个变量重复此操作。您可能想看看这些是如何在源中计算的。

不幸的是，尽管我很想推荐使用 Reflection 来覆盖`private`method `determineTargetPage()`，但我不相信有可能做到这一点——即使使用扩展的 Reflection API。

# php - PHP去除带有'字符边界的噪声词正则表达式

> ID：11731879
> 
> 赞同：0
> 
> 时间：2012-07-31T01:21:45.140
> 
> 标签：php, regex, preg-replace, word-boundary

我正在尝试从字符串中删除噪音词，并且我有我认为是一个很好的算法，但我遇到了障碍。在我执行 preg_replace 之前，我删除了除撇号 (') 之外的所有标点符号。我把它放在这个 preg_replace 中：

```
$content = preg_replace('/\b('.implode('|', self::$noiseWords).')\b/','',$content); 
```

效果很好，除了确实具有 ' 字符的单词。preg_replace 似乎将其视为边界字符。这对我来说是个问题。

有没有办法解决这个问题？也许是一个不同的解决方案？

谢谢！

这是我正在使用的示例：

```
$content = strtolower(strip_tags($content));
    $content = preg_replace("/(?!['])\p{P}/u", "", $content);// remove punctuation
    echo $content;// i've added striptags for editing as well should still workyep it doesnbsp

    $content = preg_replace("/\b(?<')(".implode('|', self::$noiseWords).")(?!')\b/",'',$content);

    $contentArray = explode(" ", $content);

    print_r($contentArray); 
```

在第 3 行，您将看到 preg_replace 之前的 $content 的注释

尽管我假设您可以猜到我的 noiseWords 数组是什么样的，但这只是其中的一小部分：

```
$noiseWords = array("a", "able","about","above","abroad","according","accordingly","across",
        "actually","adj","after","afterwards","again",......) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:29:52.730

您可以使用消极的后视和积极的前瞻来确保您没有“围绕”引用字符：

```
$regex = "/\b(?<!')(".implode('|', self::$noiseWords).")(?!')\b/"; 
```

现在，您的正则表达式将不匹配任何前面或后面带单引号的内容。

# javascript - 使用 Eclipse Juno Java EE 的 jQuery 自动补全

> ID：11731884
> 
> 赞同：42
> 
> 时间：2012-07-31T01:22:34.540
> 
> 标签：javascript, jquery, eclipse, aptana

我已经阅读了一些关于如何为 Eclipse 启用 jQuery（特别是自动完成）支持的 DATED 信息。使用 Aptana 或其他插件。

我已经尝试过 Aptana 3 版本的插件，但除了问题我什么也没有。

有人可以解释如何实现这一目标吗？

也许现在 Aptana 有更好的选择。

尝试使用 Eclipse Indigo 和 Helios，仍然使用 Aptana Web 工具 pkg。不起作用。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-10-15T09:13:29.853

我在 Juno 中完成了 jQuery 代码。只需按照以下步骤操作：

1) 安装[JSDT jQuery 集成插件](https://code.google.com/a/eclipselabs.org/p/jsdt-jquery/)

![在此处输入图像描述](../Images/8001d5010be902e444e70640dad7a5de.png)

* * *

2) 转到项目资源管理器--> JavaScript 资源

![在此处输入图像描述](../Images/eafd25cce9680392902a594fda016b5a.png)

* * *

3）右键单击它并转到属性。

* * *

4) 选择“添加 JavaScript 库”

![在此处输入图像描述](../Images/9b7a0666d95715ae7db1ee3d6748417c.png)

* * *

5）选择“jQuery库”

![在此处输入图像描述](../Images/5030f775b3966367402e44ff61b3f1d9.png)

* * *

6）您将获得如下代码完成

![在此处输入图像描述](../Images/2279772c803ac93f0d2c39bcd4eab6db.png)

享受。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-05-17T12:59:41.740

多亏了[logic8 评论](https://stackoverflow.com/questions/11731884/jquery-autocompletion-with-eclipse-juno-java-ee#comment-26821787)，所以更简单的是从

`help > Install new software`

并输入`http://svn.codespot.com/a/eclipselabs.org/jsdt-jquery/updatesite`

多田！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-16T04:33:43.443

我用过[https://marketplace.eclipse.org/content/angularjs-eclipse](https://marketplace.eclipse.org/content/angularjs-eclipse) 一旦你安装了这个，你可以右键单击你的项目，配置到 Angularjs 项目，

就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-01T19:00:48.947

只是我没有看到任何人说的话。
如果您已经有一个现成的项目，但是当您创建它时没有使用 javascript 项目，那么您必须转换您现有的项目。
保持冷静，因为这种转换不会损害您现有的项目。

> `Right click on your project`> `Configure`>`Convert to javascript project`

准备好！现在您可以按照我们的朋友在这里做的一步一步来。
我相信这真的可以帮助像我这样的初学者。

# asp.net-mvc - ASP.net MVC - 来自多个来源的输出

> ID：11731891
> 
> 赞同：0
> 
> 时间：2012-07-31T01:23:48.563
> 
> 标签：asp.net-mvc, mongodb

有没有更好的方法通过 return View() 在 MVC 中显示来自多个源的数据？

我基本上调用了两个不同的来源，然后填写了一个可以组合结果的公共集合。只是想知道我是否可以返回两个数据对象而不必组合它们？

任何建议，将不胜感激。

谢谢，

小号

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:38:32.390

通常使用可以保存多个集合或其他类型的[ViewModel](http://msdn.microsoft.com/en-us/magazine/dd942822.aspx#id0070047)来传递给您的视图。

如果您不想要/不需要强类型视图，您也可以使用 ViewBag 或 ViewData 将多个集合传递给您的视图：

```
public ActionResult Index()
{
    ViewData["GratuitousGuid"] = Guid.NewGuid();

    ViewBag.Products = ProductService.GetProducts();
    ViewBag.Countries = CountryService.GetCountries();
    ViewBag.Zombies = ZombieService.GetZombies();

    return View();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:39:55.140

您可以使用多个操作将不同的源呈现为`PartialView`s，然后将它们放在一个整体中`View`

例子：

家庭控制器.cs

```
public ActionResult Foo() {
    return PartialView(repository.GetFoo());
}

public ActionResult Bar() {
    return PartialView(repository.GetBar());
}

public ActionResult Index() {
    return View();
} 
```

索引.cshtml

```
<div id='foo'>
    @Html.Action("Foo")
</div>

<div id='bar'>
    @Html.Action("Bar")
</div> 
```

Foo.cshtml 和 Bar.cshtml 将是显示每个模型数据的 PartialViews。

**附录**

我喜欢这种方式的另一个原因是它非常适合 AJAX 更新。例如，如果需要在页面上更新 Bar 部分，那么您可以使用 jQuery 编写：

```
$('#bar').load('/home/bar', function (html) {
    //Set up your returned data here (callbacks and the like)
}); 
```

无需执行完全刷新

# ruby-on-rails-3 - Rails 3 validates_uniquess_of 具有范围的虚拟字段

> ID：11731894
> 
> 赞同：0
> 
> 时间：2012-07-31T01:23:54.647
> 
> 标签：ruby-on-rails-3, virtual-attribute, validates-uniqueness-of

我正在开发一个 Rails 3 应用程序，该应用程序需要在虚拟字段上运行验证以查看记录是否已经存在......这是我的模型代码：

```
 #mass-assignment
      attr_accessible :first_name, :last_name, :dob, :gender

      #validations
      validates_presence_of :first_name, :last_name, :gender, :dob
      validates :fullname, :uniqueness => { :scope => [:dob] }

def fullname
    "#{first_name} #{last_name}"
  end 
```

我没有收到任何错误，它通过了验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:47:44.483

我不认为你可以用标准做这样的事情`validates`。原因是，它通常是一个“简单”的 sql 查找唯一性。但是要检查从您的方法返回的内容的唯一性，它必须：

*   获取范围的所有条目
*   对于每个，执行`fullname`方法。
*   在测试唯一性时将每个结果添加到数组中

当数据集很小时很简单，但是一旦您的范围内达到 10K 以上的匹配项，就需要很长时间才能完成。

我个人会使用`dob`范围使用标准 before_save 来执行此操作

```
before_save :check_full_name_uniqueness

def check_full_name_uniqueness
  query_id = id || 0
  return !Patient.where("first_name = ? and last_name = ? and dob = ? and id != ?", first_name, last_name, dob, query_id).exists?
end 
```

添加错误信息（返回前）：

```
errors.add(:fullname, 'Your error') 
```

回到控制器，得到错误：

```
your_object.errors.each do |k, v| #k is the key of the hash, here fullname, and v the error message
  #Do whatever you have to do
end 
```

# c# - C# 入口点类修饰符

> ID：11731896
> 
> 赞同：2
> 
> 时间：2012-07-31T01:24:04.053
> 
> 标签：c#, access-modifiers, entry-point, modifier

我的问题是关于 C# 程序中的入口点。我正在使用 VS 2010，它会自动生成带有程序类的 Program.cs 文件：

```
class Program 
{
   ...
   static void Main(...)
   ...
} 
```

我的问题是为什么这个类默认是内部的？为什么不公开？如果在某些情况下选择一个或另一个修饰符，如何理解这个基础课程我需要哪个？

PS我实际上是一名Java程序员，现在正在尝试学习C#，但书中缺少一些细节。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:29:24.207

通常不需要在*程序集之外使用**主*类（包含入口点方法定义），这就是它具有内部访问权限的原因。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T10:40:16.187

每个项目都可以有自己的入口点，您也可以指定入口点来告诉单个项目执行另一个项目。并且 IAbstract 是对的，您可以使用静态、公共或私有进行修改

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T02:29:30.660

生成的程序集是一个 EXE。您通常不会添加对 EXE 程序集的引用，这意味着除了 EXE 中的类之外没有任何东西可以访问程序——这意味着`internal`完美地描述了它的使用方式。在 .NET 2.0 之前，您实际上无法引用和 EXE，因此`Program`存在`public`是错误的，因为它可以作为 .NET 以外的任何内容访问`internal`。*

# eclipse - 使用 subclipse 时如何通过终端上询问的 ssh 密码

> ID：11731899
> 
> 赞同：0
> 
> 时间：2012-07-31T01:24:29.963
> 
> 标签：eclipse, ubuntu, ubuntu-10.04, subclipse

我们内部`svn`存储库的 URI 看起来像`svn+ssh://svn/hogehoge/svnroot/`. 在从终端运行的 Eclipse 上使用`subclipse`时，当我尝试访问存储库并且永远不会返回时，Eclipse 会冻结。我发现在终端`ssh`上询问密码，但看起来它只是打印在那里并且不接受我的输入（我输入的密码被解释为终端上的命令）。任何想法都值得赞赏。

环境：

*   Ubuntu 10.04
*   日食靛蓝 SP2
*   子剪辑（必需）1.6.18
*   Subversion 客户端适配器（必需）1.6.12
*   Subversion JavaHL 本机库适配器（必需）1.6.17

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T13:55:06.730

我建议您安装 SVNKit 并改为使用它而不是 JavaHL。SVNKit 包含一个纯 Java SSH 客户端，因此它能够在 Eclipse 中提供 GUI 提示。如果要使用 JavaHL，有两种选择：

1.  从终端窗口启动 Eclipse。然后 SSH 提示将出现在该窗口中。

2.  运行 ssh 代理。然后，您的 SSH 客户端将从 ssh-agent 获取密钥，并且不需要终端提示。

通常用户已经在使用 ssh-agent，在这种情况下，我建议只使用 JavaHL。由于您显然没有使用它，我建议只使用 SVNKit。

# ruby-on-rails - Delayed_job 不使用 ActiveMailer 3.x 发送电子邮件

> ID：11731905
> 
> 赞同：1
> 
> 时间：2012-07-31T01:24:51.093
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, delayed-job

我已经安装了用于 ActiveMailer 的延迟作业，因此我可以将批量电子邮件作为后台作业发送。问题是，虽然当工作人员拿起作业时作业被安装到数据库中的**延迟_作业表中，但没有执行任何电子邮件。**

详情如下：

*   导轨版本 3.2.2
*   延迟作业 3.0.3
*   延迟作业活动记录 0.3.2

按照ActiveMailer的[Delayed_Job 文档](http://rubydoc.info/gems/delayed_job/3.0.3/)中的建议，电子邮件作业通过调用放置到队列中，

```
MemberMailer.delay.all_member_email(m, @message) 
```

这是一个名为**email_list_controller**的控制器，旨在接受发送给站点的一个或多个成员的消息。执行后，日志文件将 SQL INSERT 指示到 delay_jobs 表中，如下所示：

```
SQL (0.2ms)  INSERT INTO `delayed_jobs` (`attempts`, `created_at`, `failed_at`, `handler`, `last_error`, `locked_at`, `locked_by`, `priority`, `queue`, `run_at`, `updated_at`) VALUES (0, '2012-07-30 11:42:47', NULL, '--- !ruby/object:Delayed::PerformableMailer\nobject: !ruby/class \'MemberMailer\'\nmethod_name: :all_member_email\nargs:\n- !ruby/ActiveRecord:Member\n attributes:\n id: \n family_id: \n title: \n first_name: FirstName\n last_name: LastName\n middle_initial: \n dob: \n gender: \n home_phone: \n work_phone: \n fax: \n mobile: \n email: grantsayer@gmail.com\n user_id: \n boat_event_id: \n ayf: \n guardian: \n consent: \n created_at: \n updated_at: \n- !ruby/ActiveRecord:Message\n attributes:\n id: 1\n subject: ! \'[IGNORE] - Testing\'\n body: ! \"<b>A body</b>\\r\\nMore lines\\r\\nAnother line \\r\\nStuff\\r\\nMore Stuff How\n to do more stuff\\r\\n\"\n created_at: 2012-04-20 04:17:51.000000000 Z\n updated_at: 2012-07-30 10:06:09.000000000 Z\n sent: 1\n date: 2012-04-20\n', NULL, NULL, NULL, 0, NULL, '2012-07-30 11:42:47', '2012-07-30 11:42:47')
(26.8ms)  COMMIT 
```

很快，工人就删除了这份工作

```
SQL (0.2ms)  DELETE FROM `delayed_jobs` WHERE `delayed_jobs`.`id` = 8 
```

worker 作业是通过 rake 任务启动的

```
rake jobs:work 
```

没有发送或接收电子邮件的记录。

在没有延迟作业方法的情况下进行测试时，电子邮件进程通常可以正常工作

```
MemberMailer.all_member_email(m, @message).deliver 
```

通过适当的路径发送电子邮件。

有没有其他人遇到过这个问题？一般 'oogling' 表明早期版本的延迟作业和无效对象存在问题。从数据库中的数据看来，YAML 序列化信息看起来没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T07:11:41.960

根据您的描述，我希望工人正确地完成工作。当工作人员认为它的工作已经完成并且没有发生异常时，该工作就会从队列中删除。

`delayed_job`有[几个配置选项](https://github.com/collectiveidea/delayed_job#gory-details)，您可以在初始化程序中进行调整。默认设置意味着 25 次重试，延迟几分钟。

我建议研究该`MemberMailer.all_member_email`方法。一个常见的错误是在那里引用实例变量或方法。

如果它没有帮助，请发布您的`MemberMailer`课程代码。

# perl - perl：在一行中打印新行

> ID：11731906
> 
> 赞同：1
> 
> 时间：2012-07-31T01:24:58.003
> 
> 标签：perl

我是 perl 的新手。当我尝试在 while 循环中打印数组的值以及一个变量时，该变量正在新行中打印。

```
while($line=<FH>)
{
    chomp($line);
    $tem = grep(/gooty/,$line);
    if($tem==1)
    {
        $Date=$date;
        @array=split(/\|/,$line);
        $sth = "INSERT INTO TABLE VALUES $array[1],$array[2],$date \n";
    }
}
print "$sth \n"; 
```

输出：

```
INSERT INTO TABLE VALUES alan ,777  
,2012-07-31 
```

相反，我希望输出为：

```
INSERT INTO TABLE VALUES alan ,777,2012-07-31 
```

在单行

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T01:30:34.997

这是新 perl 程序员的常见问题。说

```
while (defined($line = <FH>))
{
    chomp $line; # Eliminate terminating newline if there
    ... 
```

如果结果仍然不正确，您可能正在尝试使用不能正确处理它们的 Perl 版本（如 Cygwin）读取带有 MSDOS/Windows 行结尾的文本文件。这可能导致`chomp`故障。您可以使用它来解决此问题：

```
$line =~ s/[\r\n]+$//; 
```

这会从行尾清除*所有*行尾字符，无论有多少。，

`use strict;`关于代码的附加说明：使用and可以为自己省去很多麻烦`use warnings;`，这需要使用`my`and进行变量声明`our`。你不需要打电话`grep`。就说吧`if ($line =~ /gooty/) {`。如果您的数据中可能存在额外的空白，则更好的拆分模式是`\s+\|\s+`. 这将消耗垂直条字段分隔符周围的空白。在这种情况下，您还想使用

```
$line =~ s/\s+$//; 
```

而不是`chomp $line`. 这将清除行尾的所有空格，包括行尾字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:30:13.877

您在 . 末尾有一个换行符`$line`。`chomp`它，在拆分之前，以获得所需的输出。

```
chomp $line; 
```

[`perldoc -f chomp`](http://perldoc.perl.org/functions/chomp.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T11:56:37.790

最干净的方法，而不是使用`chomp`，是从行尾删除所有尾随空格

开始你的循环

```
$line =~ s/\s+\z//; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T01:50:49.293

我假设您不希望您的元素`@array`被空白字符包围。然后我们应该在打印之前修剪它们。

```
my $line = <FH>;

my $date = '2012-07-31'; # or whatever

if($line =~ /gooty/)
{
    my @array = split /[|]/, $line;
    foreach (@array) {
      s/^\s+//; # removes leading  whitespaces
      s/\s+$//; # removes trailing whitespaces
    }
    print "INSERT INTO TABLE VALUES $array[1],$array[2],$date \n";
} 
```

这应该打印所需的输出。

但是，在您向我们展示您提供的产生意外输出的代码的*输入*之前，我无法确定。（或者可能是你`$sth`在循环和`print`语句之间修改了你的？我看到你附加了两个换行符？）

顺便说一句：`use strict; use warnings`！

# eclipse - 是否可以从命令行运行 PyDev 代码分析？

> ID：11731909
> 
> 赞同：1
> 
> 时间：2012-07-31T01:25:26.960
> 
> 标签：eclipse, pydev, code-analysis

我正在尝试运行无头 Eclipse 构建，但我被卡住了。我的上下文是我想使用 PyDev 代码分析而不必启动 eclipse gui。我知道其他用于进行代码分析的命令行工具（pyflakes、pylint 等）。

到目前为止我的命令是：

```
java -jar /path/to/eclipse/plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar -noSplash -data "/path/to/workspace" -application org.eclipse.jdt.apt.core.aptBuild 
```

我的java版本是1.6.0_31，我的eclipse版本是3.7.2，我的pydev版本是2.5.0。

当我运行该命令时，它看起来正在运行，但它从未捕获任何错误或警告。

```
...
PyDev: Analyzing 29 of 33 (forms.py)
PyDev: Analyzing 29 of 33 (forms.py)
PyDev: Analyzing 29 of 33 (forms.py)
PyDev: Analyzing 29 of 33 (forms.py)
... 
```

如果 I `tail -f /path/to/workspace/.metadata/.log`，我会得到一个巨大的堆栈跟踪：

```
!ENTRY org.eclipse.equinox.preferences 4 2 2012-07-30 17:48:39.612
!MESSAGE Problems occurred when invoking code from plug-in: "org.eclipse.equinox.preferences".
!STACK 0
java.lang.ExceptionInInitializerError
    at org.eclipse.debug.internal.ui.DebugUIPreferenceInitializer.setDefault(DebugUIPreferenceInitializer.java:186)
    at org.eclipse.debug.internal.ui.DebugUIPreferenceInitializer.setThemeBasedPreferences(DebugUIPreferenceInitializer.java:204)
    at org.eclipse.debug.internal.ui.DebugUIPreferenceInitializer.initializeDefaultPreferences(DebugUIPreferenceInitializer.java:79)
    at org.eclipse.core.internal.preferences.PreferenceServiceRegistryHelper$1.run(PreferenceServiceRegistryHelper.java:281)
..... TRUNCATED ......

!ENTRY org.eclipse.osgi 4 0 2012-07-30 17:48:39.622
!MESSAGE An error occurred while automatically activating bundle org.eclipse.debug.ui (42).
!STACK 0
org.osgi.framework.BundleException: Exception in org.eclipse.debug.internal.ui.DebugUIPlugin.start() of bundle org.eclipse.debug.ui.
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:734)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:683)
    at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:381)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:299)
..... TRUNCATED .......

java.lang.IllegalStateException: Workbench has not been created yet.
    at org.eclipse.ui.PlatformUI.getWorkbench(PlatformUI.java:92)
    at org.eclipse.debug.internal.ui.contextlaunching.LaunchingResourceManager.startup(LaunchingResourceManager.java:546)
    at org.eclipse.debug.internal.ui.DebugUIPlugin.getLaunchingResourceManager(DebugUIPlugin.java:315)
    at org.eclipse.debug.internal.ui.DebugUIPlugin.start(DebugUIPlugin.java:516)
..... TRUNCATED ......

!ENTRY org.eclipse.osgi 4 0 2012-07-30 17:48:39.624
!MESSAGE An error occurred while automatically activating bundle org.eclipse.debug.core (41).
!STACK 0
org.osgi.framework.BundleException: Exception in org.eclipse.debug.core.DebugPlugin.start() of bundle org.eclipse.debug.core.
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:734)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:683)
    at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:381)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.start(AbstractBundle.java:299)
..... TRUNCATED ...... 
```

我怀疑 PyDev 需要 gui 来呈现错误/警告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T16:21:55.730

PyDev 需要 gui 来呈现错误/警告，通常它没有在命令行中使用......现在，话虽如此，它确实具有运行代码分析而不需要 gui 的单元测试（也甚至加载了eclipse），但是您必须在内存中配置解释器/项目才能使其工作。

看：

[https://github.com/aptana/Pydev/blob/development/plugins/com.python.pydev.analysis/tests/com/python/pydev/analysis/OccurrencesAnalyzerTest.java](https://github.com/aptana/Pydev/blob/development/plugins/com.python.pydev.analysis/tests/com/python/pydev/analysis/OccurrencesAnalyzerTest.java)

[https://github.com/aptana/Pydev/blob/development/plugins/com.python.pydev.analysis/tests/com/python/pydev/analysis/AnalysisTestsBase.java](https://github.com/aptana/Pydev/blob/development/plugins/com.python.pydev.analysis/tests/com/python/pydev/analysis/AnalysisTestsBase.java)

对于不需要加载 Eclipse 工作台的代码分析测试（即：甚至不需要无头运行 Eclipse——它可以作为一个简单的 Java 程序运行，但你仍然必须执行 Java main([]) 在 CLASSPATH 中使用 PyDev 并使用其 API 正确设置 PyDev 中使用的解释器以及项目/pythonpath)。

您可以查看测试的设置（即：不要忘记查看超类，例如 CodeCompletionTestsBase/AnalysisTestsBase）。

注意：如果您确实创建了这样的 main([])，请为 PyDev 提供补丁，因为它可能会被其他人使用...

作为实现说明，这样的 main 可能应该从正在启动的 shell 收集所有当前 PYTHONPATH 条目并在解释器中配置所有这些条目......此外，它可能应该接收一个目录作为参数，以便它分析所有文件树（启动可能会花费你大部分时间来配置东西，所以，理想情况下，你可以从一次运行中分析尽可能多的文件，因为 PyDev 代码分析是为了在启动中缓存很多东西然后使用 RAM 中的信息——或者创建一个始终存在的服务器进程？）。

# php - 如何添加额外的文本到 tag in Joomla

I need to add extra text (Hard cord) to the title tag on a joomla website. But I cant seem to find where the tag is located in Joomla. Does any of you guys know where it is located?

> ID：11731912
> 
> 赞同：2
> 
> 时间：2012-07-31T01:26:04.087
> 
> 标签：php, html, joomla

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T02:02:55.410

尝试将此添加到您的页面

```
<?php 
if (@$_REQUEST['view'] != 'frontpage') {
$document =& JFactory::getDocument();
$document->setTitle("My Custom Text - ".$document->getTitle());
}
?> 
```

或者

```
<?php 
if (@$_REQUEST['view'] != 'frontpage') {
$document =& JFactory::getDocument();
$document->setTitle($document->getTitle() . " - My Custom Text");
}
?> 
```

或者

```
<?php 
if (@$_REQUEST['view'] != 'frontpage') {
$document =& JFactory::getDocument();
$document->setTitle("My Custom Text");
}
?> 
```

如果您正在寻找类似于 joomla 中设置的不太动态的东西，那么进入您的站点菜单，在全局下，我认为，自从我使用 joomla 以来已经有一段时间了，其中一些地方应该有一个框来输入一个独特的标题将出现在所有页面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:10:21.817

在 Joomla 管理员后台，去编辑一个菜单项，在右侧，有一个名为“页面显示选项”的选项卡。然后您可以在“浏览器页面标题”输入字段中输入您选择的标题。

# c# - 为什么 C# 5.0 await 关键字被列为运算符而不是修饰符？

> ID：11731914
> 
> 赞同：9
> 
> 时间：2012-07-31T01:26:41.420
> 
> 标签：c#, async-await, c#-5.0

MSDN 库[将`await`关键字列为运算符](http://msdn.microsoft.com/en-us/library/hh156528)。这对我来说似乎很奇怪——我原以为它是一个修饰符，就像[关键字`async`一样](http://msdn.microsoft.com/en-us/library/hh156513%28v=vs.110%29.aspx)。

为什么这是运营商？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T01:29:58.670

`async`是声明的修饰符。类似于`public`。

`await`是一个使用异步运算符并对其执行某些操作的操作。类似于`return`。

`await`不是修改其后放置的内容，而是指定如何处理该操作。相反`async`，它实际上并没有修改任何东西，它只是标记了一个特定的方法的风格`async`（从句法的角度来看，最终`await`的 's 执行了对方法结构的所有更改）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-31T07:10:05.930

修饰符适用于声明。private、static、out、ref、params、override 关键字就是这样的例子。和异步。

运算符应用于表达式并转换表达式结果。您在 await 右侧写的内容称为“await 表达式”。因此它是一个单一的运算符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T09:14:40.997

好吧，相信大家都同意**是**运营商。我一直在说，将它定义为运算符的关键概念是它*改变了结果数据类型*，但这并不完全正确。

让我们看一下运算符的定义：

> C# 提供了大量运算符，它们是**指定在表达式中执行哪些操作的符号**

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/6a71f45d%28v=vs.100%29.aspx)

所以，正如 Guvante 所指出的，我们确实有一个*表示*为`type identifier = await asyncMethod()`（你知道的，主要是喜欢它）的表达式。并且`await`确实对这个表达式执行了操作。它处理等待和从`TaskResult`预期类型的​​转换，等等。

正如我所说，我同意其他 2 个答案（Guvante 和 Hans Passant），我只是认为这个小概念也可以提供帮助。

问候

# mysql - MySQL更改默认会话日期

> ID：11731920
> 
> 赞同：0
> 
> 时间：2012-07-31T01:27:55.107
> 
> 标签：mysql

需要将 MySQL 中的默认日期更改为将来的日期。

因此，如果今天的日期是 2012-07-30 (YYYY-MM-DD)，我希望能够将我的 MySQL 会话日期设置为未来的日期，例如 2012-08-05。

所以，当我这样做时

```
select curdate() 
```

curdate(): 2012-07-30

将 MySQL 会话日期更改为 2012-08-05

```
select curdate() 
```

curdate(): 2012-08-05

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T02:17:23.073

试试这个：

```
SET TIMESTAMP=unix_timestamp('2012-08-05'); 
```

# jquery - 在完成并显示 10 秒后，如何反转以下 jQuery 动画？

> ID：11731921
> 
> 赞同：0
> 
> 时间：2012-07-31T01:28:00.863
> 
> 标签：jquery, jquery-animate

这非常适合将 div 带入窗口，但是，当我尝试放置任何会反转动画的功能时（并使面板以与进入时相同的方式撤退，没有任何反应，哈哈……我是这个 jQuery 的新手东西。我确定我只是做错了什么。

我想要发生的事情是让窗口滑入（就像当前代码一样），然后在它出现 10 秒后，让窗口以与进入时相同的方式退回。

jQuery：

```
<!-- Live Support Slide-In -->
<script type="text/javascript">
$(document).ready(function() {

    // Store our panel into a variable.
    var $myPanel = $("#live-chat");

    // Get the height of the panel dynamically.
    var $myPanelHeight = parseInt($myPanel.height());

    // Immediately set the opacity to 0 - to hide it and set its bottom to minus its height.
    $myPanel.css({ "opacity" : 0, "bottom" : "-" + $myPanelHeight + "px" });

    // Set a timeout for the panel to slide and fade in.
    setTimeout(function() {

        $myPanel.animate({

            // The CSS properties we want to animate (opacity and bottom position).
            opacity: 1,
            bottom: '0'

        }, 2000, function() {

            // Animation complete. 
            // Here is where I tried putting an additional setTimeout(). Wouldn't help much, because I can't seem to reverse the animation.

                });

    }, 5000); // 30 seconds in MS

}); 
</script>
<!-- End Live Support Slide-In --> 
```

HTML：

```
 <h1 class="tech" style="">Need Help?</h1>
  <p style="font-size:14px;">Don't worry! Our sales team is just one-click away. If you have questions regarding a product, your order status, etc. just click the link below and start a Live Chat session now.</p>
  <a style="display:block; text-align:right; font-weight:bold; font-size:14px;" href="#">+ Chat with a salesman</a>
  <div id="no-thanks-close"><img src="/images/components/no-thanks-close.png" alt="Close this Window..." /></div>

 </div>
</div> 
```

任何帮助将不胜感激！:) 提前谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:57:26.613

从字面上做相反的事情。不透明度为 100%，然后可能捕获原始“顶部”位置的位置并将其保存为函数外部的变量，然后您调用与您现在使用顶部而不是底部的函数相反的函数捕获变量作为您的最高位置，理论上它应该可以工作，可能需要在此之外进行一些调整，但通常应该那么容易。

# c# - 如何查看服务器发出的并发 HTTP 请求数？

> ID：11731922
> 
> 赞同：1
> 
> 时间：2012-07-31T01:28:05.523
> 
> 标签：c#, api, concurrency, monitoring, task-parallel-library

我正在使用第三方 API 来异步查询数据。这是我的代码示例：

```
private void AsyncDataLoad() {
    Task[] tasks = new Task[6] {
        Task.Factory.StartNew(() => FetchSomeStuff1()),
        Task.Factory.StartNew(() => FetchSomeStuff2()),
        Task.Factory.StartNew(() => FetchSomeStuff3()),
        Task.Factory.StartNew(() => FetchSomeStuff4()),
        Task.Factory.StartNew(() => FetchSomeStuff5()),
        Task.Factory.StartNew(() => FetchSomeStuff6())
    };

    Task.WaitAll(tasks);
} 
```

如何查看我一次打开了多少请求？默认情况下，我认为我可以在一个域上打开的并发请求的数量是有限的，我想改变它。但是，我希望能够在尝试进行任何更改之前证明这是事实。

如果对任何工具建议有帮助，我的开发箱就在 Windows 7 Enterprise 上。我尝试使用 PerfMon，但似乎没有任何可用于使用该工具进行监视的属性正在接收服务器发出的 HTTP 请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T02:10:52.287

IME，fiddler是查看http调用行为的最佳工具。它的时间线让您可以很好地查看并发性。

更改限制的设置在connectionManagement

[http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T02:16:38.783

如果您只需要自己手动观看（而不是以编程方式检查），那么您可以使用[来自 SysInternals 的 TCPView](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)。

# ruby - Less 不使用 pow 自动编译

> ID：11731925
> 
> 赞同：1
> 
> 时间：2012-07-31T01:28:50.523
> 
> 标签：ruby, less, rack, padrino, rack-pow

我正在使用 Padrino 构建一个应用程序，并且我决定减少样式表的使用，主要是使用 twitter 引导程序。

通过 pow 为应用程序提供服务时，我在自动编译我的 less 文件时遇到了一些麻烦。

当我运行`padrino start`和使用嵌入式服务器时，我得到了很好的样式，但我真的不明白如何。生成的 application.css 文件正是它应该的样子，除了我的应用程序的公共目录中的 application.css 文件没有更改。

但是，当我通过 pow 运行应用程序时，对 application.less 文件所做的任何更改都不会反映在 application.css 文件中，这是唯一提供的文件。

我主要是想了解如何以及为什么只有在运行 webrick 时才编译 less。

我的较少初始化程序是：

```
module LessInitializer
  def self.registered(app)
    # Enables support for Less template reloading for rack.
    # Store Less files by default within 'app/stylesheets/'
    # See http://github.com/kelredd/rack-less for more details.
    require 'rack/less'
    # optional - use as necessary
    Rack::Less.configure do |config|
      config.compress = true
      config.cache = true
      # other configs ...
    end
    app.use Rack::Less,
      :root      => Padrino.root,
      :source    => 'app/stylesheets',
      :public    => 'public',
      :hosted_at => 'stylesheets'

  end
end 
```

我的`application.less`文件是：

```
@import "bootstrap/bootstrap.less";

body {
    padding-top: 60px;
    padding-bottom: 40px;
}

.sidebar-nav {
    padding: 9px 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T02:46:09.673

我刚刚用 Padrino edge 和 Pow 试过这个，它工作正常。

老实说，无论是 Pow 还是 Webrick，它都不应该真正有所作为——只要它是机架投诉它就应该起作用。

您可以尝试在测试项目中更改 padrino 的 gem 以指向：

`gem 'padrino', :git => 'git://github.com/padrino/padrino-framework.git'`

目前对于 less on edge 存在未满足的依赖关系，但它应该很快被合并。因此，如果上述方法不起作用，请使用：

`gem 'padrino', :git => 'git://github.com/padrino/padrino-framework.git', :branch => 'fix-less-dependencies'`

如果你一直遇到问题，你介意在 Github 上[打开一个问题吗？](https://github.com/padrino/padrino-framework/issues/new)

谢谢！

# python - 创建一个频率表，用于捕获特定长度字符串中的流行子字符串 - Python

> ID：11731926
> 
> 赞同：0
> 
> 时间：2012-07-31T01:28:57.900
> 
> 标签：python, counter, frequency, linguistics

我正在尝试对正在编译的斯瓦希里语语料库进行频率分析。目前，这就是我所拥有的：

```
import os
import sys
from collections import Counter
import re

path = 'C:\Python27\corpus\\'
cnt = Counter()
listing = os.listdir(path)
for infile in listing:
    print "Currently parsing: " + path + infile
    corpus = open(path+infile, "r")
    for lines in corpus:
        for words in lines.split(' '):
            if len(words) >= 2 and re.match("^[A-Za-z]*$", words):
                words = words.strip()
                cnt[words] += 1
    print "Completed parsing: " + path + infile
    #output = open(n + ".out", "w")
    #print "current file is: " + infile

    corpus.close()
    #output.close()
for (counter, content) in enumerate(cnt.most_common(1000)):
    print str(counter+1) + " " + str(content) 
```

所以这个程序将遍历给定路径中的所有文件，读入每个文件的文本，并显示 1000 个最常用的单词。问题是：斯瓦希里语是一种粘着性语言，这意味着在单词中添加中缀、后缀和前缀以传达诸如时态、因果关系、虚拟语气、介词等内容。

所以像“-fanya”这样的动词词根意思是“做”可能是 nitakufanya -“我要做你”。结果，该频率列表偏向于连接不使用所述中缀的单词，例如“for”、“in”、“out”。

有没有一种简单的方法来查看像“nitakufanya”或“tunafanya”这样的词，并将“fanya”这个词包括在总数中？

一些潜在的事情要看：

1.  动词词根将在单词的末尾
2.  单词开头的主题标记可以是以下之一：'ni'（我），'u'（你），'a'（他/她），'wa'（他们），'tu'（我们），'m'（你们所有人）
3.  主语标记后面是时态标记，它们是：“na”（现在）、“li”（过去）、“ta”（未来）、“ji”（反身）、“nge”（条件式）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:33:18.920

首先进行频率分析而不用担心前缀。然后修复频率列表中的前缀。为此，更容易根据单词对列表进行排序，以便具有相同前缀的单词彼此相邻。这将使手工修剪变得非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:47:42.343

你可以做：

```
root_words = [re.sub(
    '^(ni|u|a|wa|tu|m)(na|li|ta|ji|nge)',
    '', x) for word in words] 
```

从每个单词中删除前缀，但是如果根单词也以这些序列开头，则您无能为力。

# spring-batch - spring批量一步添加作业参数

> ID：11731927
> 
> 赞同：2
> 
> 时间：2012-07-31T01:29:00.527
> 
> 标签：spring-batch

我有两个步骤的工作。第一步是在具有以下结构的文件夹中创建一个文件

```
src/<timestamp>/file.zip 
```

下一步需要检索这个文件并处理它

我想将时间戳添加到作业参数中。每个作业实例都由时间戳区分，但在第一步完成之前我不会知道时间戳。如果我在作业开始时将时间戳添加到作业参数中，那么每次都会启动一个新的作业实例。任何未完成的工作都将被忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T03:50:55.970

我认为您可以改用 JobExecutionContext 。

第 1 步获取当前时间戳，使用它生成文件，并放入 JobExecutionContext。第 2 步从 JobExecutionContext 读取以获取时间戳，用于构造其处理的输入路径。

只是在您的拆分步骤方法上添加一些内容，如下所示：您必须三思而后行，这是否真的是您想要的。如果第 1 步完成，第 2 步失败，当作业实例重新运行时，它将从第 2 步开始，这意味着文件不会在第 1 步中重新生成（因为它已经完成）。如果它是你要找的，那很好。如果没有，您可能会查看是否要将 Step1 和 Step2 放在一个步骤中。

# ios - 相机拍摄时闪屏白屏？

> ID：11731930
> 
> 赞同：6
> 
> 时间：2012-07-31T01:29:32.050
> 
> 标签：ios, animation, camera, image-capture

我想在相机捕获的那一刻闪烁（然后淡出）屏幕，以向用户指示已拍摄照片（除了听觉线索）。

这样的动画会放在哪里？另外，如何实现以便我可以控制淡出的持续时间？

注意：我为我的特定相机选择器创建了一个自定义叠加层。

任何表明已拍摄照片的东西都是我要找的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-25T06:25:38.060

我不确定您将动画放置在哪里，因为我不知道您如何准确地捕获图片（也许您可以发布代码），但这是使屏幕闪烁白色的动画代码：

```
//Header (.h) file
@property (nonatomic, strong) UIView *whiteScreen;

//Implementation (.m) file
@synthesize whiteScreen;

- (void)viewDidLoad {
    self.whiteScreen = [[UIView alloc] initWithFrame:self.view.frame];
    self.whiteScreen.layer.opacity = 0.0f;
    self.whiteScreen.layer.backgroundColor = [[UIColor whiteColor] CGColor];
    [self.view addSubview:self.whiteScreen];
}

-(void)flashScreen {
    CAKeyframeAnimation *opacityAnimation = [CAKeyframeAnimation animationWithKeyPath:@"opacity"];
    NSArray *animationValues = @[ @0.8f, @0.0f ];
    NSArray *animationTimes = @[ @0.3f, @1.0f ];
    id timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
    NSArray *animationTimingFunctions = @[ timingFunction, timingFunction ];
    [opacityAnimation setValues:animationValues];
    [opacityAnimation setKeyTimes:animationTimes];
    [opacityAnimation setTimingFunctions:animationTimingFunctions];
    opacityAnimation.fillMode = kCAFillModeForwards;
    opacityAnimation.removedOnCompletion = YES;
    opacityAnimation.duration = 0.4;

    [self.whiteScreen.layer addAnimation:opacityAnimation forKey:@"animation"];
} 
```

您还询问了如何控制淡出持续时间。您可以通过调整`animationTimes`数组中的值来做到这一点。如果您不熟悉如何`CAKeyframeAnimations`工作，那么这里有一个简短的简报。动画的总持续时间由`opacityAnimation.duration = 0.4`. 这使动画长度为 0.4 秒。现在开始做什么`animationTimes`。数组中的每个值都是一个介于 0.0 和 1.0 之间的数字，并且对应于“animationValues”数组中的一个元素。times 数组中的值将相应关键帧值的持续时间定义为动画总持续时间的一部分。

例如，在上面的动画中，times 数组包含值 0.3 和 1.0，它们对应于值 0.8 和 0.0。总持续时间为 0.4，这意味着最初不透明度为 0.0 的 whiteScreen 视图需要

```
0.4 * 0.3 = 0.12 seconds. 
```

将不透明度提高到 0.8。第二个值 0.0 使图层再次变得透明。这会占用剩余的时间（0.4 - 0.12 = 0.28 秒）。

# javascript - 动态添加选项以选择选择多个 JQuery 插件

> ID：11731932
> 
> 赞同：7
> 
> 时间：2012-07-31T01:29:42.190
> 
> 标签：javascript, jquery, jquery-events, jquery-chosen

I want to add the text that a user inputs in the text field of a chosen select multiple input as an option, and automatically select it, all of this when the option doesn't exists, if the option exists, then I would like to选择它。到目前为止，我已经设法做到这一点：

```
Chosen.prototype.add_text_as_option = function () {
    $('#id_select').append(
        $('<option>')
                .html(this.search_field.val())
                .attr('selected', 'selected')
                .attr('value', 0)
    );
    $('#id_select').trigger("liszt:updated");
    return false;
}; 
```

每当用户在输入字段在函数中处于焦点时按 Enter 键时，我都会调用此`keydown_check`函数。

我有两个问题：

*   最高优先级，当用户按下回车键并输入选项的子字符串时，该选项不会被选中，但子字符串文本将被添加并选中。不是我想要的。

例如：如果我有选项“foo”，并开始输入“fo”，选择会将第一个选项标记为候选（“foo”），所以如果我按下回车键，它应该被选中，但是，发生的事情是当我实际上想选择“foo”时，将“fo”作为选项添加并选择。

如果我通过单击选择“foo”，那么一切正常。选择的选项标记被选中，子字符串文本被作为选项的一部分。

如何在不丢失所有原始功能的情况下添加不存在的选项？

*   如何访问我在所选插件中选择的多选字段？正如您在上面的代码中看到的，选择多个字段的 id 是硬编码的。我想这样做是为了在用户添加新选项时能够刷新选择。

*   我正在寻找的功能与[linkedin的技能小部件非常相似](http://linkedin.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-05T16:07:47.113

我今天需要这个，所以我写了这样的东西：

```
$(function() {
    // form id
    $('#newtag').alajax({
        // data contains json_encoded array, sent from server
        success: function(data) {
            // this is missing in alajax plugin
            data = jQuery.parseJSON(data);
            // create new option for original select
            var opt = document.createElement("OPTION");
            opt.value = data.id;
            opt.text = data.name;
            opt.selected = true;
            // check if the same value already exists
            var el = $('#tags option[value="' + opt.value + '"]');
            if( !el.size() ) {
                // no? append it and update chosen-select field
                $('#tags').append( opt ).trigger("chosen:updated");
            } else {
                // it does? check if it's already selected
                if(!el[0].selected) {
                    // adding already existent element in selection
                    el[0].selected = true;
                    $('#tags').trigger("chosen:updated");
                } else {
                    alert("Already selected and added.");
                }
            }

        }
    })
}); 
```

"#"newtag 是一个表单，".alajax" 是一个[插件](https://github.com/alaabadran/ALAJAX)，它以异步方式发送表单数据并以 JSON 格式返回服务器的响应。在控制器中，我检查标签是否存在，否则我创建它。作为回应，我有五个“jsoned”标签对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T19:55:01.573

您应该尝试基于所选插件的 select2 插件，但它适用于动态添加元素。

这是链接：http: [//ivaynberg.github.com/select2/](http://ivaynberg.github.com/select2/)

查看自动标记化的示例，我认为这可能是您正在寻找的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-20T06:51:59.097

我创建了一个 jquery 的 jsfiddle，它接受文本并作为选项创建。在早期版本的 jquery 中选择了设施创建选项。

```
create_option: true;
persistent_create_option: true;
skip_no_results: true; 
```

您可以使用以下代码：

```
$('#id_select').chosen({
    width: '100%', 
    create_option: true, 
    persistent_create_option: true, 
    skip_no_results: true
}); 
```

jsfiddle 链接： [https ://jsfiddle.net/n4nrqtek/](https://jsfiddle.net/n4nrqtek/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-17T00:00:12.073

只需调用它 keyup_check keydown_check 在按下的字母被初始化之前调用，不像 keyup_check

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-01-25T22:54:31.873

我找到了一个解决方案多选

```
var str_array = ['css','html'];
$("#id_select").val(str_array).trigger("chosen:updated"); 
```

# php - PHP 多个 foreach

> ID：11731936
> 
> 赞同：0
> 
> 时间：2012-07-31T01:30:02.530
> 
> 标签：php, mysql, arrays, foreach, while-loop

我正在尝试从 mysql 中的数组中插入数据。我有多个数组。我一直在尝试按照这个思路做一些事情。

```
foreach ($titles as $title && $descriptions as $description) {
    mysql_query("INSERT INTO `stock` VALUES('', '$title', '$description')");
} 
```

我希望 mysql 表看起来像这样。

```
item_id    title    description
_______________________________

1          title1   description1
2          title2   description2
... 
```

现在我发现这行不通，是否有任何替代方法。我已经看到了执行此操作的 while 循环示例，但我很难理解它是如何工作的。提前感谢所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:33:05.450

如果大小`$titles`相等，`$descriptions`并且您有顺序数组，则可以执行以下操作：

```
<?php
$titles = array(
    'foo',
    'bar'
);
$descriptions = array(
    'foo description',
    'bar description'
);

for($i = 0; $i < count($titles); $i++) {
    $title = $titles[$i];
    $description = $descriptions[$i];

    mysql_query("INSERT INTO `stock` VALUES('', '$title', '$description')");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T01:34:41.710

您正在寻找一个[`MultipleIterator`](http://php.net/multipleiterator)，它将轻松地遍历两个数组：

```
$iter = new MultipleIterator;
$iter->attachIterator( new ArrayIterator( $titles));
$iter->attachIterator( new ArrayIterator( $descriptions));

foreach( $iter as $data) {
    list( $title, $description) = $data;
    // Do your SQL insert with $title and $description
} 
```

# sencha-touch-2 - 如何使用 Sencha Touch 将表单数据传递给 php 文件？

> ID：11731940
> 
> 赞同：0
> 
> 时间：2012-07-31T01:30:41.307
> 
> 标签：sencha-touch-2

我创建了这个模型（在控制器中我保存数据）：

```
config: {
     fields: [
        {name: 'name', type: 'string'},
        {name: 'email', type: 'string'},
     ],
     proxy: {
        type: 'rest',
        url: '/php/user.php',
     }
} 
```

我制作的 php (user.php) 文件，但这种方式不起作用：

```
<?php
    include "conect.php";

    $n = $_POST['name'];
    $e = $_POST['email'];

    mysql_query("INSERT INTO user (name, email) VALUES ('$n', '$e')");
?> 
```

那么如何将数据传递给 php 并插入到我的数据库中呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T06:46:22.030

```
var user = Ext.create('User', { name: 'my name', email: 'test@test.com' });

user.save(); 
```

# facebook - haskell facebook 异常

> ID：11731941
> 
> 赞同：2
> 
> 时间：2012-07-31T01:30:44.653
> 
> 标签：facebook, haskell

读完[这篇](http://book.realworldhaskell.org/read/error-handling.html)文章后，我尝试了

```
{-# LANGUAGE OverloadedStrings, NoMonomorphismRestriction #-}
module Login (
    fbUrl,
    fbEmail
) where

-- package http://hackage.haskell.org/package/fb
import qualified Facebook as FB
import Network.HTTP.Conduit (withManager)

app :: FB.Credentials
app = FB.Credentials "localhost" "249348058430770" "..."

url :: FB.RedirectUrl
url = "http://localhost/fb"

perms :: [FB.Permission]
perms = ["user_about_me", "email"]

--fbUrl :: Monad m => FB.FacebookT FB.Auth m Text
fbUrl :: IO Text
fbUrl = withManager $ \manager -> FB.runFacebookT app manager $ FB.getUserAccessTokenStep1 url perms

--fbEmail :: Monad m => (ByteString, ByteString) -> FB.FacebookT FB.Auth m (Maybe Text)
--fbEmail :: (ByteString, ByteString) -> IO (Maybe Text)
fbEmail c = withManager $ \manager -> FB.runFacebookT app manager $ do
    t <- FB.getUserAccessTokenStep2 url [c]
    u <- FB.getUser "me" [] (Just t)
    return $ FB.userEmail u

module Main (
  main
) where

import Login
import qualified Data.ByteString.Char8 as C
import Control.Exception

main :: IO ()
main = do

    let a = ("code","test")
    e <- fbEmail $ (\(x,y) -> (C.pack x, C.pack y)) a

    case e of
        Nothing -> print "doh!"
        Just e -> print e 
```

我得到`haskell-facebook: FacebookException {fbeType = "invalid_code", fbeMessage = "Invalid verification code format."}`而不是`doh!`

随着`e <- try (fbEmail $ (\(x,y) -> (C.pack x, C.pack y)) a)`我得到

```
Couldn't match expected type `Either
                                e0 (Maybe Data.Text.Internal.Text)'
            with actual type `Maybe t0'
In the pattern: Nothing
In a case alternative: Nothing -> print "doh!"
In a stmt of a 'do' block:
  case e of {
    Nothing -> print "doh!"
    Just e -> print e } 
```

@丹尼尔菲舍尔

```
let a = ("code","test")
e <- try (fbEmail $ (\(x,y) -> (C.pack x, C.pack y)) a)

case e of
    Left x -> print "doh!"
    Right e -> print "ok"

Ambiguous type variable `e0' in the constraint:
  (Exception e0) arising from a use of `try'
Probable fix: add a type signature that fixes these type variable(s)
In a stmt of a 'do' block:
  e <- try (fbEmail $ (\ (x, y) -> (C.pack x, C.pack y)) a)
In the expression:
  do { let a = ...;
       e <- try (fbEmail $ (\ (x, y) -> (C.pack x, C.pack y)) a);
       case e of {
         Left x -> print "doh!"
         Right e -> print "ok" } }
In an equation for `main':
    main
      = do { let a = ...;
             e <- try (fbEmail $ (\ (x, y) -> (C.pack x, C.pack y)) a);
             case e of {
               Left x -> print "doh!"
               Right e -> print "ok" } } 
```

当我添加类型签名时`fbEmail :: Monad m => (ByteString, ByteString) -> FB.FacebookT FB.Auth m (Maybe Text)`，我得到

```
Could not deduce (monad-control-0.3.1.3:Control.Monad.Trans.Control.MonadBaseControl
                    IO m,
                  resourcet-0.3.2.2:Control.Monad.Trans.Resource.MonadUnsafeIO m,
                  Control.Monad.IO.Class.MonadIO m,
                  resourcet-0.3.2.2:Control.Monad.Trans.Resource.MonadThrow
                    (FB.FacebookT FB.Auth m))
  arising from a use of `withManager'
from the context (Monad m)
  bound by the type signature for
             fbEmail :: Monad m =>
                        (ByteString, ByteString) -> FB.FacebookT FB.Auth m (Maybe Text)
  at src/Login.hs:(25,1)-(28,27)
Possible fix:
  add (monad-control-0.3.1.3:Control.Monad.Trans.Control.MonadBaseControl
         IO m,
       resourcet-0.3.2.2:Control.Monad.Trans.Resource.MonadUnsafeIO m,
       Control.Monad.IO.Class.MonadIO m,
       resourcet-0.3.2.2:Control.Monad.Trans.Resource.MonadThrow
         (FB.FacebookT FB.Auth m)) to the context of
    the type signature for
      fbEmail :: Monad m =>
                 (ByteString, ByteString) -> FB.FacebookT FB.Auth m (Maybe Text)
  or add instance declarations for
     (monad-control-0.3.1.3:Control.Monad.Trans.Control.MonadBaseControl
        IO m,
      resourcet-0.3.2.2:Control.Monad.Trans.Resource.MonadThrow
        (FB.FacebookT FB.Auth m))
In the expression: withManager
In the expression:
  withManager
  $ \ manager
      -> FB.runFacebookT app manager
         $ do { t <- FB.getUserAccessTokenStep2 url [...];
                u <- FB.getUser "me" [] (Just t);
                .... }
In an equation for `fbEmail':
    fbEmail c
      = withManager
        $ \ manager
            -> FB.runFacebookT app manager
               $ do { t <- FB.getUserAccessTokenStep2 url ...;
                      .... } 
```

当我添加时，`fbEmail :: (ByteString, ByteString) -> IO (Maybe Text)`我得到

```
Ambiguous type variable `e0' in the constraint:
  (Exception e0) arising from a use of `try'
Probable fix: add a type signature that fixes these type variable(s)
In a stmt of a 'do' block:
  e <- try (fbEmail $ (\ (x, y) -> (C.pack x, C.pack y)) a)
In the expression:
  do { couchTest;
       u <- fbUrl;
       print u;
       let a = ...;
       .... }
In an equation for `main':
    main
      = do { couchTest;
             u <- fbUrl;
             print u;
             .... } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-03T23:15:49.130

`try`在结果之上添加另一层。为了使这个示例简单，我使用 catch-all 来捕获所有异常`SomeException`。

为了更清楚一点，这里是添加了 type signatured 的结果类型：

```
e :: Maybe Text <- fbEmail $ (\(x,y) -> (C.pack x, C.pack y)) a 
```

与此用法相比，`try`异常类型等于`SomeException`：

```
e :: Either SomeException (Maybe Text) <- fbEmail $ (\(x,y) -> (C.pack x, C.pack y)) a 
```

正如 Daniel 在他的评论中提到的那样，使用模式匹配来处理这些更复杂的类型很简单：

```
{-# LANGUAGE FlexibleContexts, OverloadedStrings #-}
module Main where

import Control.Exception
import qualified Data.ByteString.Char8 as C
import Data.Text
import Network.HTTP.Conduit (withManager)

import qualified Facebook as FB

app :: FB.Credentials
app = FB.Credentials "localhost" "249348058430770" "..."

url :: FB.RedirectUrl
url = "http://localhost/fb"

perms :: [FB.Permission]
perms = ["user_about_me", "email"]

fbUrl :: IO Text
fbUrl = withManager $ \manager -> FB.runFacebookT app manager $ FB.getUserAccessTokenStep1 url perms

fbEmail :: FB.Argument -> IO (Maybe Text)
fbEmail c = withManager $ \manager -> FB.runFacebookT app manager $ do
  t <- FB.getUserAccessTokenStep2 url [c]
  u <- FB.getUser "me" [] (Just t)
  return $ FB.userEmail u

main :: IO ()
main = do
  let a = ("code","test")
  e <- try . fbEmail $ (\(x,y) -> (C.pack x, C.pack y)) a

  case e of
    Left e -> print $ "error: " ++ show (e :: SomeException)
    Right Nothing -> print "doh!"
    Right (Just e) -> print e 
```

# php - 使用正则表达式的 php 清理 url

> ID：11731943
> 
> 赞同：0
> 
> 时间：2012-07-31T01:31:26.820
> 
> 标签：php, regex, search, clean-urls

我正在尝试转换这些网址

```
localhost/list/data/?search=keyword
localhost/list/data?search=keyword 
```

至

```
localhost/list/data/search/keyword 
```

我用了这个表达

```
(.+)(\?|\/\?)([a-z0-9_-]+)=([a-z0-9_-]+) 
```

问题是假设用户搜索另一个关键字

```
localhost/list/data/search/keyword/?search=anotherkeyword
localhost/list/data/search/keyword?search=anotherkeyword 
```

变成这样

```
localhost/list/data/search/keyword/search/anotherkeyword 
```

怎么会变成这样

```
localhost/list/data/search/anotherkeyword 
```

它在哪里替换了 url 中的前一个**搜索/关键字**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:52:59.673

它比正则表达式复杂一点。最好的方法是结合使用服务器端脚本和 htaccess。不久前，我为一个非常相似的问题写了一个答案。以及在我开发的少数​​网站中使用此解决方案。

[PHP 动态数据库页面重写 URL](https://stackoverflow.com/questions/11022509/php-dynamic-db-page-rewrite-url/11022705#11022705)

我将节省重写我在上述链接上发布的帖子的时间，并让您将其用作您的指南，希望对您有所帮助

# c# - 列表的 XML 序列化

> ID：11731947
> 
> 赞同：6
> 
> 时间：2012-07-31T01:32:22.033
> 
> 标签：c#, .net, xml, xml-serialization

我正在将一个对象序列化为 XML。我有这样的事情：

```
Class A
{
   public string propertyA1  { get; set; }
   public List<B> bList { get; set; }
}

Class B
{
   public string num {get; set;}
   public string propertyB1  { get; set; }
} 
```

当我将它序列化为 XML 时，我希望它看起来像这样：

```
<A>
  <propertyA1>someVal</propertyA1> 
  <B num=1>
     <propertyB1>someVal</propertyB1> 
  </B>
  <B num=2>
     <propertyB1>someVal</propertyB1> 
  </B>
</A> 
```

但是，它看起来像这样：

```
<A>
  <propertyA1>someVal</propertyA1> 
  <bList>
     <B num=1>
        <propertyB1>someVal</propertyB1> 
     </B>
     <B num=2>
        <propertyB1>someVal</propertyB1> 
     </B>
  </bList>
</A> 
```

知道如何摆脱输出中的**bList**吗？如果需要，我可以提供更多示例代码

谢谢，斯科特

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-31T01:37:41.880

添加属性`[XmlElement]`以将集合视为元素的平面列表：

```
Class A
{
   public string propertyA1  { get; set; }
   [XmlElement("B")]
   public List<B> bList { get; set; }
} 
```

更多信息请点击[这里](http://msdn.microsoft.com/en-us/library/2baksw0z(v=vs.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T05:03:41.950

您也可以尝试 XmlArrayItemAttribute。请参考以下链接。

[http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute.aspx)

[http://msdn.microsoft.com/en-us/library/2baksw0z(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/2baksw0z(v=vs.71).aspx)

# jquery - 引用 div

> ID：11731948
> 
> 赞同：0
> 
> 时间：2012-07-31T01:32:27.807
> 
> 标签：jquery, jquery-selectors

我有这组 div

```
 <div id="main">
        <div id="lvl1">
            <div id="lvl1-1">
                lvl 1-1
            </div>

            <div id="lvl1-2">
                lvl 1-2
            </div>
        </div>

        <div id="lvl2">
            <div id="lvl2-1">
                lvl 2-1
            </div>

            <div id="lvl2-2">
                lvl 2-2
            </div>
        </div>
    </div> 
```

在 jquery 上有没有一种方法可以选择 #lvl1, lvl2 下的所有子 div 并将其放入变量中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:36:09.883

尝试

```
var divs = $("#lvl1 > div, #lvl2 > div") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T02:01:18.500

```
var divs = $("#main > div > div"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:36:43.333

是的。

```
var divs = $("#lvl1 div, #lvl2 div"); 
```

# java - 如何删除java中代码示例的重复代码？

> ID：11731949
> 
> 赞同：0
> 
> 时间：2012-07-31T01:32:28.140
> 
> 标签：java

```
package org.test.toolkit.file;

public interface FileType {

    public enum Image implements FileType {

        JPG;

        public String toString() {  //duplicated code
            return "." + super.toString().toLowerCase();
        };
    }

    public enum Office implements FileType {

        DOC;

        public String toString() {
            return "." + super.toString().toLowerCase();
        };
    }

    public enum PlainText implements FileType {

        TXT;

        public String toString() {  //duplicated code
            return "." + super.toString().toLowerCase();
        };
    }

} 
```

如何有效地删除重复代码。也许我应该考虑使用在其他类对象中定义的静态方法？还是有更好的方法来解决我的问题？

```
 public String toString() {
        return "." + super.toString().toLowerCase();
    }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:37:02.490

```
public enum Type
{
  Image,Document,Text;
}
public enum FileType
{
   DOC(Type.Document), JPG(Type.Image),GIF(Type.Image),TXT(Type.Text);
   private Type type;
   private FileType(Type t)
   {
      this.type=t;
   }
   public Type getType()
   {
      return type;
   }
   public String toString()
   {
       return "." + super.toString().toLowerCase();
   }
} 
```

?

# php - 为什么这个 HSL 到 RGB 转换功能不起作用？

> ID：11731951
> 
> 赞同：1
> 
> 时间：2012-07-31T01:33:11.230
> 
> 标签：php, colors, rgb, hsl

好的，我已经编写了一个应该将 HSL 颜色值转换为 RGB 的函数。我根据这个脚本用 PHP 重写了它：[http ://www.easyrgb.com/index.php?X=MATH&H=19#text19](http://www.easyrgb.com/index.php?X=MATH&H=19#text19)

这就是我所拥有的：

```
function HSL2RGB($h, $s, $l){
    function hue2rgb($v1, $v2, $vH){
        $sH = $vH;
        if($vH<0) $sH += 1;
        if($vH>1) $sH -= 1;
        if((6*$sH)<1) return $v1+($v2-$v1)*6*$sH;
        if((2*$sH)<1) return $v2;
        if((3*$sH)<2) return $v1+($v2-$v1)*((2/3)-$sH)*6;
        return $v1;
    }

    $h *= (5/18);
    $s /= 100;
    $l /= 100;
    $r=$g=$b=NULL;
    if($s==0){
        $r=$l*255;
        $g=$l*255;
        $b=$l*255;
    }else{
        if($l<0.5)
            $var_2 = $l*(1+$s);
        else
            $var_2 = ($l+$s)-($s*$l);

        $var_1 = 2*$l-$var_2;
        $r = 255*hue2rgb($var_1, $var_2, $h+(1/3));
        $g = 255*hue2rgb($var_1, $var_2, $h);
        $b = 255*hue2rgb($var_1, $var_2, $h-(1/3));
    }
    return array('r'=>$r,'g'=>$g,'b'=>$b);
}

var_dump(HSL2RGB(196.4, 100, 59.8)); 
```

此脚本的输出：

```
array(3) {
  ["r"]=>
  float(49.98)
  ["g"]=>
  float(49.98)
  ["b"]=>
  float(49.98)
} 
```

正确的输出是`R: 50, G:199, B:255`。我从`easyrgb.com`. 我只是不知道为什么它不起作用。任何帮助都是极好的。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:42:50.410

根据[PHP 手册](http://php.net/manual/en/language.variables.basics.php)，PHP 中的变量名区分大小写。

在您的代码中更改`$sh`为。`$sH`

您的 PHP 代码中可能有错误。在代码的开头添加这些行：

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

为什么要使用 $sH 变量？您指向的算法仅使用`vH`. 尝试全部替换`$sH`为`$vH`.

在您的原始代码中，更改`$h *= (5/18)`为`$h /= 360;`将修复您的功能。

这里的评论中有一个这样的功能：http: [//php.net/manual/en/function.imagecolorallocate.php](http://php.net/manual/en/function.imagecolorallocate.php)

```
function hslToRgb ($h, $s, $l) {
    if ($h>240 || $h<0) return array(0,0,0);
    if ($s>240 || $s<0) return array(0,0,0);
    if ($l>240 || $l<0) return array(0,0,0);    
    if ($h<=40) {
        $R=255;
        $G=(int)($h/40*256);
        $B=0;
    }
    elseif ($h>40 && $h<=80) {
        $R=(1-($h-40)/40)*256;
        $G=255;
        $B=0;
    }
    elseif ($h>80 && $h<=120) {
        $R=0;
        $G=255;
        $B=($h-80)/40*256;
    }
    elseif ($h>120 && $h<=160) {
        $R=0;
        $G=(1-($h-120)/40)*256;
        $B=255;
    }
    elseif ($h>160 && $h<=200) {
        $R=($h-160)/40*256;
        $G=0;
        $B=255;
    }
    elseif ($h>200) {
        $R=255;
        $G=0;
        $B=(1-($h-200)/40)*256;
    }
    $R=$R+(240-$s)/240*(128-$R);
    $G=$G+(240-$s)/240*(128-$G);
    $B=$B+(240-$s)/240*(128-$B);
    if ($l<120) {
        $R=($R/120)*$l;
        $G=($G/120)*$l;
        $B=($B/120)*$l;
    }
    else {
        $R=$l*((256-$R)/120)+2*$R-256;
        $G=$l*((256-$G)/120)+2*$G-256;
        $B=$l*((256-$B)/120)+2*$B-256;
    }
    if ($R<0) $R=0;
    if ($R>255) $R=255;
    if ($G<0) $G=0;
    if ($G>255) $G=255;
    if ($B<0) $B=0;
    if ($B>255) $B=255;

    return array((int)$R,(int)$G,(int)$B);
} 
```

# mongodb - Yesod / Persistent 的 MongoDB 示例

> ID：11731953
> 
> 赞同：11
> 
> 时间：2012-07-31T01:33:20.130
> 
> 标签：mongodb, haskell, persistent, yesod

Haskell 和 Yesod 新手在这里。我一直在尝试遵循 Yesod 书 (http://www.yesodweb.com/book/persistent) 中 Persistent 章节中的与 Yesod 集成的示例。Sqlite 似乎编译并运行良好。但是，我正在尝试使用 MongDB 并且很难让事情正常工作。具体来说：

1.  在 sqlite 的示例中：

    `share [mkPersist sqlSettings, mkMigrate "migrateAll"] [persist|`

    Yesod 书说“将使用 Mongo 代码`mongoSettings`”。但是我在任何模块中都找不到它，并且代码无法编译。所以相反，我不得不使用它而不是`mongoSettings`：

    `MkPersistSettings { mpsBackend = ConT ''Action }`

    我必须导入 Language.Haskell.TH.Syntax 才能编译它，我假设它应该对用户隐藏，所以我肯定没有做对。

    此外，我发现在 Mongo 的持久测试中没有“共享”和“迁移”部分。我实际上不确定为什么，我猜这是因为 MongoDB 是无模式的并且不需要迁移？

2.  `SqlPersist`

    我以为`MongoPersist`是 SqlPersist 的对应物，我猜它几乎是——我`MongoPersist`在 Persistent 的测试目录的 init.hs 中找到了一个实例。但是它被注释掉了，所以我觉得它已经过时了？否则，据我所知，它无论如何都没有定义。所以我不知道如何转换以下行（Yesod 书的第 115 页，或[http://www.yesodweb.com/book/persistent](http://www.yesodweb.com/book/persistent)的末尾附近）以适用于 MongoDB：

    ```
    instance YesodPersist PersistTest where
        type YesodPersistBackend PersistTest = SqlPersist
        runDB action = do
            PersistTest pool <- getYesod
            runSqlPool action pool 
    ```

3.  使用 withMongoDBConn

    所以对于 sqlite，代码是（上面网页中的第一个示例）：

    ```
    main :: IO ()
    main = withSqliteConn ":memory:" $ runSqlConn $ do
        runMigration migrateAll
        johnId <- insert $ Person "John Doe" $ Just 35
        ... and so on 
    ```

    但

    ```
    main :: IO()
    main = withMongoDBConn ":memory:" $ runMongoDBConn $ do
        runMigration migrateAll 
        johnId <- insert $ Person "John Doe" $ Just 35
        ... and so on 
    ```

不起作用。首先，`runMigration`由于某种原因不在范围内。好的，也许我不需要迁移 MongoDB，所以我删除了该行。然后，编译器抱怨： `Couldn't match expected type`AccessMode' 与实际类型`m0 b0' Expected type: m0 t0 -> (t0 -> m0 b0) -> AccessMode Actual type: m0 t0 -> (t0 -> m0 b0) -> m0 b0`等等。到了这个阶段，我对单子的粗略了解还不足以弄清楚这一点。

总而言之，我很难将书中的集成与 Yesod 示例从 Sqlite 转换为 MongoDB。有人可以为我提供一个使用 MongoDB 的 Yesod/Persistent 的具体示例吗？非常感谢提前。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-17T12:37:32.317

我今天在 Github Yesod Cookbook 中添加了一个将 MongoDB 与 Persistent 结合使用的页面。但是，它不使用`withMongoDBConn`，也不避免 TH。另外，我在那里解释了为什么我使用单独的 YAML 配置文件。链接：[http ://bit.ly/VLvmoK](http://bit.ly/VLvmoK)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-30T16:50:55.173

我知道这是对一个老问题的回答，但这是一种独立于 Yesod 的方式来让 Persistent 与 MongoDB 一起工作。这可能对 Persistent 的新手有用。

```
{-# LANGUAGE TemplateHaskell #-}

import Database.Persist 
import Database.Persist.TH
import Database.Persist.MongoDB
import Network (PortID (PortNumber))

let mongoSettings = (mkPersistSettings (ConT ''MongoBackend)) {mpsGeneric = False}
    in share [mkPersist mongoSettings] [persistLowerCase|
Person
    name String
    age Int Maybe
    deriving Show
BlogPost
    title String
    authorId PersonId
    deriving Show
|]
runDBActions actions = 
    withMongoDBConn "myDatabaseName" "localhost" (PortNumber 27017) Nothing 2000 $ \pool ->    
        runMongoDBPool master actions pool

actions = do
    mkey <- insert $ Person "John Doe" $ Just 35
    ...

main :: IO ()
main = do
    runDBactions actions 
```

# php - 正则表达式类似于左修剪，但用 html 等效替换空格

> ID：11731955
> 
> 赞同：0
> 
> 时间：2012-07-31T01:33:48.043
> 
> 标签：php, regex, preg-replace

需要帮助将以下字符串`" Hello I have blanks to the left"`转换为类似`"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hello I have blanks to the left"`. 已尝试将多个空白匹配到左侧，但它只用一个`"&nbsp"`. 谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:39:36.123

有几种方法可以做到这一点。我的首选方式是：

```
preg_replace_callback("/^ +/",function($m) {return str_repeat("&nbsp;",strlen($m));},$input); 
```

请注意，如果您的 PHP 版本早于 5.3，则需要使用`create_function`而不是直接在其中放置匿名回调。

# html - CSS：绝对定位，图片的（绝对）坐标到底在哪里？

> ID：11731957
> 
> 赞同：2
> 
> 时间：2012-07-31T01:33:54.467
> 
> 标签：html, css

几乎是标题。

背景故事：我正在设计一个基于绝对定位的javascript游戏引擎，我真的需要知道绝对定位坐标本身是否在图像的中心（这太棒了！），或者在一个角落，但是如果有，在哪个角落？

我认为它是左上角，但我不确定。

我真的需要知道，这样我才能计算出图像之间的碰撞，并实际给出游戏边界中的对象而不是矩形。我现在正在修修补补，但这会节省我很多时间，如果有人能确定地告诉我，我会感到更安全。

我在 div 中有一个图像，我在 div 的 style 属性中设置所有 css 属性，包括底部、左侧、高度和宽度

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T01:36:47.950

您设置`top`and ... 那就是在您绝对定位的元素的*顶部*和*左侧*`left`提供多少空间。现在，如果你不给它一个宽度和高度，你可以使用and让它占据所有空间，除了你在那些样式属性中指定的任何内容。**`bottom``right`**

 **一个简单的[演示](http://jsbin.com/opogep/1)应该足以说明这一点......

我应该提到绝对意味着绝对的身体原点（页面的左上角）。例外情况是当您的绝对定位元素的父元素是`position: relative`See this [demo](http://jsbin.com/opogep/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T03:43:45.343

在 CSS 中，`left`表示元素与父元素左侧之间的距离，例如`<body>`，或带有 的元素`position: relative`。

其他的也一样，例如`bottom`表示离底部边缘多远。

但是，我做了一个允许从中心定位的示例：http: [//jsfiddle.net/tbRfm/1/](http://jsfiddle.net/tbRfm/1/)。

**HTML：**

```
<div class="wrapper">
    <div class="inner">
        Inner stuff here, or set a <code>background-image</code>.
    </div>
</div> 
```

**CSS：**

```
.wrapper {
    position: relative;
    left: 200px;
    top: 100px;
    width: 100px;
    height: 100px;
}
.inner {
    position: absolute;
    width: 100px;
    height: 100px;
    right: 50px;
    bottom: 50px;
    background: #eee;
    text-align: center
} 
```

这适用于所有 IE 版本（至少我可以在[IE NetRenderer](http://netrenderer.com)测试的版本：IE5.5 - IE10）。

简单测试：如果您设置`left`和的`top`值`.wrapper` `0`，则该框将被截断：http: [//jsfiddle.net/tbRfm/3/](http://jsfiddle.net/tbRfm/3/)。**

# grails - 如何在 IntelliJ IDEA Grails 项目中为 groovy 方法获取 javadocs / groovydocs？

> ID：11731959
> 
> 赞同：11
> 
> 时间：2012-07-31T01:34:10.473
> 
> 标签：grails, groovy, intellij-idea, javadoc, groovydoc

在 Grails 项目中工作时，对于 groovy 添加到集合之类的东西的 GDK 方法，我没有得到任何有用的 javadocs / groovydocs。有没有办法做到这一点，或者这是 IntelliJ IDEA 无法做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T09:29:59.843

使用指向 grails 模块的 javadocs 创建全局库 groovy，`api`并将全局库`gapi`添加`groovy`到您的 grails 模块

```
sargis@sargis:~> ll $GROOVY_HOME/docs/html 
total 12
drwxr-xr-x 5 sargis users 4096 25 juil. 08:24 api
drwxr-xr-x 4 sargis users 4096 25 juil. 08:24 gapi
drwxr-xr-x 6 sargis users 4096 25 juil. 08:24 groovy-jdk 
```

# android - EditText 的 android:inputType="textPersonName" 有什么特别之处

> ID：11731961
> 
> 赞同：35
> 
> 时间：2012-07-31T01:34:21.023
> 
> 标签：android

我试过了

```
 <EditText
            android:id="@+id/editText1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="textPersonName" > 
```

我意识到它可以接受任何字符。那么，`android:inputType="textPersonName"`与没有相比，有什么特别的呢？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-06-04T05:33:11.217

不同的是，如果使用“textPersonName”，用户不能插入新行（不显示回车按钮）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2017-12-25T10:36:09.490

使用时不进行拼写检查，`android:inputType="textPersonName"`但在`textCapWords`.

因此，如果您使用`textPersonName` 名称，则不会有红色下划线，但每个名称（名字、中间名、姓氏等）的首字母不会大写。

所以最好的解决方案是将两者与 an or that is 结合起来 `android:inputType="textPersonName|textCapWords"`。

现在名称不会有红色下划线，第一个字母也将大写

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-19T22:34:00.140

我在 android 5.0.1 上进行测试，我插入了一个带有“textPersonName”输入类型的edittext和其他带有“text”输入类型的edittext，在两个示例中，没有显示输入按钮。我真的看不出这些输入类型之间的差异。

问候

# javascript - 延迟函数直到 $ 可用

> ID：11731963
> 
> 赞同：1
> 
> 时间：2012-07-31T01:34:29.443
> 
> 标签：javascript, jquery, namespaces, deferred-execution

出于性能原因，雅虎建议[在 HTML 页面的底部加载脚本。](http://developer.yahoo.com/performance/rules.html#js_bottom)我使用符合规则的 HTML5 样板。

这种方法的问题是 jQuery 也在底部加载。如果由于某种原因我需要编写包含 jQuery 代码的内联 javascript，我不能，因为`$`在命名空间中尚不可用。

例如，galeria.js（jQuery 图像库引擎）会发生这种情况，它需要以下标记：

```
<div id="gallery">
    <img src="/media/img1.png" />
    <img src="/media/img2.png" />
</div>

<script>
$('#gallery').css('height', '200px'); // this is required for galleria to work
Galleria.run('#gallery');
</script> 
```

设置高度的代码`#gallery`不起作用，因为稍后会加载 jQuery。Firebug 控制台提供：

```
ReferenceError: $ is not defined 
```

在命名空间中找到符号之前是否有任何暗示执行`<script>`块的提示？`$`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-31T01:40:07.197

将您的 jQuery`<script>`标记留在底部，然后将 Galleria 移动到其`<script>`下方。

```
<script type="text/javascript" src="jquery.js"></script>
<script>
$('#gallery').css('height', '200px'); // this is required for galleria to work
Galleria.run('#gallery');
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T01:36:22.037

您可以将脚本包装在函数中，并在加载 jQuery 后运行的脚本中调用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T01:49:18.977

您可以创建自己的“就绪检查器”。

```
 <script>
    var id = window.setInterval(function(){

         if(document.readyState != 'complete') return;

         //onload code here

         window.clearInterval(id);
    }, 10); 
 </script> 
```

这样，您可以等到文档准备好并加载 jQuery，即使它位于文档的底部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T01:39:15.937

如果可以，只需将 jQuery 放在 HEAD 中。这是可以接受的，因为它是一个非常常见的库。但是，除了将脚本块明显移动到包含 jquery 脚本之后之外，您几乎还有一个选择——使用 window.setTimeout(function(){ ... jQuery code ... }, 2000); ...在我看来，上述内容是一种创可贴...不是最佳实践。

请注意：这是完全不可靠的，因为我们“猜测”用户将在两秒内加载 jQuery……当然，您可以延长超时时间。但是，用户的速度（/年龄）和带宽都会影响时间。这是不可预测的。

# javascript - Facebook JavaScript SDK 和点赞状态

> ID：11731965
> 
> 赞同：0
> 
> 时间：2012-07-31T01:34:37.000
> 
> 标签：javascript, facebook

我是 Facebook 开发环境的新手，不知道如何检测我网站粉丝页面的 Like 状态。

我已经查看了[如何使用 Facebook 的 API](https://stackoverflow.com/questions/5093398/check-if-user-liked-page)和[https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)以及其他资源检查用户是否喜欢我的 Facebook 页面或 URL，但无济于事。

我试图检测的是使用 JavaScript 时以下哪些条件是正确的：

1.  我的网站访问者当前是否登录了 Facebook？[是] [否]
2.  如果用户登录 Facebook，他们是否喜欢品牌页面（Facebook 粉丝页面）[是] [否]

我的逻辑是这样的：

```
if ( [user is logged into facebook] ){
// check to see if user is a fan of the page
var query = FB.Data.query( 'select page_id from page_fan where uid=me() and page_id ='[PAGE_ID]');
query.wait( function(rows) ) {
    if(rows.length) {
        // User already likes the page
        echo('Thanks for liking the page!');
    }
    else {
        // User has not yet liked the page
        echo('Like us on Facebook!');
    }
});

}

else {
// User is not logged into Facebook
echo('Hello, world!');

} 
```

我不清楚从这里做什么。我已经阅读了数十篇与此类似问题相关的文章，但其中大多数似乎已经过时，引用了已弃用的 FBML 和/或 REST API。

FWIW，我看到很多关于需要 APPID 的参考资料，但是，我没有 Facebook 应用程序。我只是想确定我网站上的用户是否喜欢我们在 Facebook 上的相关品牌/粉丝页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T07:52:28.873

> FWIW，我看到很多关于需要 APPID 的参考资料，但是，我没有 Facebook 应用程序。

然后创建一个。没有应用程序就无法完成您想做的事情。

> 我只是想确定我网站上的用户是否喜欢我们在 Facebook 上的相关品牌/粉丝页面。

如果您的应用程序将作为页面选项卡应用程序嵌入到 Facebook 中，那么要走的方法是在服务器端解析 signed_request 参数。

如果不是这种情况，或者您想严格遵守客户端 JavaScript – 那么您必须先让用户连接到您的应用程序，请求他允许阅读他的喜好，然后从 Graph API 获取信息。

# javascript - 简单的地理编码器

> ID：11731972
> 
> 赞同：0
> 
> 时间：2012-07-31T01:35:28.587
> 
> 标签：javascript, google-maps, google-maps-api-3, google-fusion-tables

我试图“模仿”这张地图的代码：

[https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple)

仅将 Syney 更改为 Porto Alegre（在表单值和坐标中）。但是出现了问题，因为地图画布没有显示在屏幕上。我检查了代码，没有发现任何拼写错误或语法错误。

我希望有人能提供帮助。实际上，与 Google Maps API 相比，我更喜欢使用 Fusion Tables。

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>GEOCODER</title>
<link href="/maps/documentation/javascript/examples/default.css" rel="stylesheet">
<script src="https://maps.google.com/maps/api/js?sensor=false"></script>
<script>

var geocoder;
var map;
function initialize() {
   geocoder = new google.maps.Geocoder();
   var latlng = new google.maps.LatLng(-30.027704, -51,228735);
   var myOptions = {
      zoom: 8,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
   }
   map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
}

function codeAddress() {
   var address = document.getElementById("address").value;
   geocoder.geocode( { 'address': address}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
         map.setCenter(results[0].geometry.location);
         var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location
         });
      } else {
        alert("Geocode was not successful for the following reason: " + status);
      }
   );
  }
}
</script>
</head>
<body onload="initialize()">
<div id="map_canvas" style="width: 320px; height: 480px;"></div>
<div>
   <input id="address" type="textbox" value="Porto Alegre, Brasil">
   <input type="button" value="Encode" onclick="codeAddress()">
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T01:42:41.517

您可能交换了两行，导致语法错误。如果您检查 JavaScript 控制台，您会看到错误消息。当 JS 没有按照您期望的那样做时，您真的应该这样做（或者，几乎总是如此，只是为了确保没有任何意外错误）。

你有这个：

```
 }
   );
  }
}
</script> 
```

你要这个：

```
 }
   }
  );
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T01:53:53.957

请注意，您在标题中提供了指向 CSS 文件的相对链接。这适用于谷歌的服务器，但可能不适用于您的服务器，除非您创建了相同的相对路径。试试这个：

```
<link href="https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple/maps/documentation/javascript/examples/default.css" rel="stylesheet"> 
```

# javascript - 表单验证 onsubmit - 在 FF/IE 中尝试在成功验证后运行脚本失败，在 Chrome 中有效

> ID：11731973
> 
> 赞同：0
> 
> 时间：2012-07-31T01:35:36.930
> 
> 标签：javascript, jquery, forms, validation, onsubmit

我的 HTML 表单上有一个简单的验证功能，我试图在成功提交表单后运行一个小脚本。它在 Chrome 中运行良好，但在 FF 或 IE 中返回 true 之前不执行 JQuery 内容。为什么会这样？

基本上，JQuery 将包含输入文本区域的 < div > 替换为信息文本，以防止用户在 5 秒后提交另一个表单，然后再切换回来。

```
function validate() {

if (textarea.value.length < 1) {
return false;
}

$("#div_with_input_textarea").hide();
$("#div_with_informative_text").show();

setTimeout(function() {
    $("#div_with_input_textarea").show();
    $("#div_with_informative_text").hide();
    }
           , 5000);

return true;
} 
```

# java - 赋值和addJavascriptInterface：有什么方法可以在java中拦截？

> ID：11731974
> 
> 赞同：0
> 
> 时间：2012-07-31T01:36:02.470
> 
> 标签：java, javascript, android, webview

如果您有一个 Android WebView，并且您使用 addJavascriptInterface 将接口添加到 java 对象，有没有办法让 java 处理分配？

JS：

```
javaObject.x = 10 
```

爪哇：

```
?? 
```

这种事情很好用：

```
javaObject.setX(10) 
```

但我正在尝试使用现有的 javascript 代码库，该代码库有很多使用赋值的调用，理想情况下我想对其进行尽可能少的更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:21:57.680

According to the documentation for [WebView.addJavascriptInterface()](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29), only the Java object's public methods are able to be accessed from JavaScript. Meaning that you cannot assign a value to a class member variable in the Java object from within Javascript.

[http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface(java.lang.Object, java.lang.String)](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)

For example :

```
public class JavaScriptInterface {
   public int x;
   private int y;

   public void setY(int value) {
       y = value;
       Log.d("JavaScriptInterface", "setY = " + y);
   }  
}

...

public void onCreate(Bundle b) {
    super.onCreate(b);
    ... 
    WebView webView = (WebView) findViewById(R.id.webview);
    webView.addJavascriptInterface(new JavaScriptInterface(), "Android");
    webView.loadUrl(myHtmlFile);
} 
```

**Javascript that lives in *myHtmlFile*:**

```
<script type="text/javascript">

    Android.x = 10;  // this will not work

    Android.setY(1000);  // this will work!

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:16:58.847

```
final class DemoJavaScriptInterface {  

    DemoJavaScriptInterface() {  
        // code here...
    }

    public int  X ;
} 
```

# java - 从 Java 到终端到 Applescript 的空白

> ID：11731977
> 
> 赞同：0
> 
> 时间：2012-07-31T01:36:29.210
> 
> 标签：java, terminal, arguments, applescript, quoting

我正在尝试使用`osascript`mac 终端中的“”命令从我的 java 程序中运行一个 applescript。当我从终端尝试它时，applescript 与名称中带有空格的应用程序完美配合，例如“ `osascript ActivateApp.scpt Google\ Chrome`”，但是当我尝试在 java 中使用它时，它将打开一个只有没有空格的应用程序。到目前为止我已经尝试过

```
Runtime.getRuntime().exec("osascript pathTo/ActivateApp.scpt Google Chrome"); 
```

和

```
Runtime.getRuntime().exec("osascript pathTo/ActivateApp.scpt Google\ Chrome"); 
```

但它们都不起作用。这是小程序：

```
on run argv
tell application (item 1 of argv)
activate
end tell
end run 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:44:51.017

尝试：

```
Runtime.getRuntime().exec("osascript pathToScript/ActivateApp.scpt 'Google Chrome'"); 
```

您看到的问题是应用程序名称被视为两个参数而不是一个。在命令行上，转义空格会导致 bash 不基于它进行拆分，而是将其作为参数的一部分传递。转义它在 Java 中不起作用，因为 Java 正在将转义的空间转换为常规空间。您可能可以通过执行类似的操作来正确处理转义，`"osascript pathToScript/ActivateApp.scpt Google\\ Chrome"`以便`\`通过，但您最好更仔细地引用。

此类问题的最佳解决方案是使用像[Apache Commons Exec](http://commons.apache.org/exec/tutorial.html)这样的库，它支持逐个构建命令，这样您就不必担心空格会无意中破坏应该是单个参数的内容，例如：

```
Map map = new HashMap();
map.put("file", new File("invoice.pdf"));
CommandLine cmdLine = new CommandLine("AcroRd32.exe");
cmdLine.addArgument("/p");
cmdLine.addArgument("/h");
cmdLine.addArgument("${file}");
cmdLine.setSubstitutionMap(map);
DefaultExecutor executor = new DefaultExecutor();
executor.setExitValue(1);
ExecuteWatchdog watchdog = new ExecuteWatchdog(60000);
executor.setWatchdog(watchdog);
int exitValue = executor.execute(cmdLine); 
```

虽然一开始可能看起来很复杂，但是当一些原本无害的输入巧妙地破坏了某些东西时，以正确的方式进行操作可以为您省去很多麻烦。

# h2 - 我可以使用什么工具来查看内存 H2 数据库中的更改？

> ID：11731978
> 
> 赞同：2
> 
> 时间：2012-07-31T01:36:37.090
> 
> 标签：h2

我转而使用内存中的 H2 数据库进行开发。它工作得很好，但我无法看到我所做的更改。

这是他们建议的工具列表：http: [//h2database.com/html/links.html#tools](http://h2database.com/html/links.html#tools)

我尝试了 DB Visualizer 和 SQL Developer，但找不到我的软件创建的表。在使用 H2 时，是否有任何我应该注意的问题，或者关于 Linux 的好工具的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:42:26.117

我通常只使用他们的网络界面，`http://localhost:8082`默认情况下可以找到。

[他们的快速入门指南](http://www.h2database.com/html/quickstart.html)详细介绍了如何在 Windows 上使用它，但我建议您`http://localhost:8082`先简单检查一下，看看它是否已经启动并运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-18T10:27:37.827

要独立于所使用的操作系统（Win,Linux(Ubuntu,..),Mac），请执行以下命令：

```
java -cp h2*.jar org.h2.tools.Console 
```

它将打开浏览器：`http://localhost:8082`

![在此处输入图像描述](../Images/2fd84762f1d91e80488bb2bef0f31a08.png)

# entity-framework - 实体框架 4.1 在 SaveChanges 之后不加载关系？

> ID：11731983
> 
> 赞同：2
> 
> 时间：2012-07-31T01:37:09.770
> 
> 标签：entity-framework, entity-framework-4.1

我对 EF 比较陌生。在我调用 SaveChanges 后，相关的表数据似乎不可用。

假设我有一个包含以下表格的数据库：User、Feature 和 FeatureUser。FeatureUser 将 User 和 Feature 记录联系在一起。我有一个接受 Feature 对象的方法，它根据 FeatureUser 表使用 User.name 值填充列表。这工作正常：

```
using (var db = new projectModel())
{
  feature f = db.features.First();
  populateList(f);
}

private void populateList(feature f)
{
  foreach(featureuser fu in f.featureusers)
    addToList(fu.user.name);
} 
```

上面代码中的重点是我通过 FeatureUser 表的内置链接返回 User.name 值，返回到 User 表。不起作用的是创建新的 FeatureUser 记录，然后保存它们，然后尝试遵循相同的过程：

```
using (var db = new projectModel())
{
  feature f = db.features.First();
  foreach(int newuserid in somearray)
  {
    featureuser nfu = new featureuser();
    nfu.featureid = f.id;
    nfu.userid = newuserid;
    f.featureusers.add(nfu);
  }
  db.SaveChanges();
  populateList(f); // null reference error on fu.user.name
} 
```

一旦我建立并保存了创建关系所需的外键，有没有办法告诉 EF 解决所有这些方便的内置关系集合？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-31T04:07:49.950

EF 返回的实体实例实际上是代理。它们包含延迟加载导航属性的逻辑。但是当你新建它的实例时，`featureuser`它没有那个逻辑，因为它没有那个延迟加载逻辑。

因此，让 EF 创建一个代理实例。

```
 foreach(int newuserid in somearray)
  {
    //create proxy instance
    var nfu = db.featureusers.Create();

    nfu.featureid = f.id;
    nfu.userid = newuserid;
    f.featureusers.add(nfu);
  } 
```

# matlab - 使用 lsqcurvefit 时许可证检出失败

> ID：11731988
> 
> 赞同：0
> 
> 时间：2012-07-31T01:38:22.627
> 
> 标签：matlab, licensing

我正在使用 matlab 中的 lsqcurvefit 函数但是当我运行它时出现错误“许可证检出失败”有人知道是什么原因造成的吗？错误信息如下。

```
License checkout failed.
License Manager Error -18
Make sure the license file on the MATLAB client matches the license file of the         license server and that the license server has been
started properly.

Troubleshoot this issue by visiting:
http://www.mathworks.com/support/lme/R2011b/18

Diagnostic Information:
Feature: Optimization_Toolbox
License path:
C:\Users\yjan020\AppData\Roaming\MathWorks\MATLAB\R2011b_licenses;C:\Matlab\R2011b        \CK\licenses\license.dat;C:\Matlab\R2011b\CK\licenses\network.lic
FLEXnet Licensing error: -18,147.

Error in lsq (line 7)
x = lsqcurvefit(@fun,x0,xdata,ydata); 
>> lsqcurvefit(@fun,x0,xdata,ydata) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T01:38:58.690

您的许可证已过期。您必须更新 Matlab。

# iphone - 创建一个基于 UIView 的子视图自动调整大小的视图

> ID：11731989
> 
> 赞同：0
> 
> 时间：2012-07-31T01:38:23.000
> 
> 标签：iphone, objective-c, ios, ipad, uiview

我有一个名为 containerView 的 UIView，其中有一些 UILabel 和 UITextView，我正在通过稍后迭代它的子视图的高度并将它们相加来调整 containerView 的最终高度。是否可以自动调整此高度？我正在使用以下方式调整子视图的高度：

```
CGFloat desiredHeight = [object.text sizeWithFont:[UIFont fontWithName:@"HelveticaNeue" size:15] constrainedToSize:CGSizeMake(self.imageView_.frameWidth , CGFLOAT_MAX) lineBreakMode:UILineBreakModeClip].height; 
```

是否甚至可以将特定子视图的 y 原点调整为始终低于另一个子视图？例如，在这个 containerView 中，我有两个 UILabel，A 和 B。我希望 B 始终低于 A。到目前为止，我正在做的是在 layoutSubviews 中计算以下内容：

```
[B setFrameY:A.frameY + A.frameHeight]; 
```

是否可以使用自动调整大小的蒙版来实现类似的效果？我不能使用常量的原因是因为 A 的 frameHeight 是动态的，取决于文本的长度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T03:52:32.687

我认为对您的问题的简短回答是，不，不会根据子视图自动调整视图大小。关于您的后一个问题（根据另一个控件调整控件的框架），您应该查看来自[WWDC 2012](https://developer.apple.com/videos/wwdc/2012/)的各种“自动布局”视频。

当我最初回答这个问题时，我认为我可能刚刚提供了解决方案，在重新阅读您的问题后，我认为您可能已经实施了。我很抱歉。无论如何，我包括我的旧答案供您参考。

**老答案：**

在你的第一个问题上，不，我认为你必须遍历你的子视图来完成你想要的。我不认为你可以用自动调整掩码做任何事情（那些被设计成相反的方式，根据他们的超级视图边界的变化来调整子视图的框架）。虽然 iOS 6 承诺了一些增强功能，但我认为它无法解决您的特定挑战。

不过，你显然可以很容易地以编程方式做一些事情。您可以执行以下操作：

```
- (void)resizeView:(UIView *)view
{
    CGSize maxSize = CGSizeMake(0.0, 0.0);
    CGPoint lowerRight;

    // maybe you don't want to do anything if there are no subviews

    if ([view.subviews count] == 0)
        return;

    // find the most lowerright corner that will encompass all of the subviews

    for (UIView *subview in view.subviews)
    {
        // you might want to turn off autosizing on the subviews because they'll change their frames when you resize this at the end,
        // which is probably incompatible with the superview resizing that we're trying to do.

        subview.autoresizingMask = 0;

        // if you have containers within containers, you might want to do this recursively.
        // if not, just comment out the following line

        [self resizeView:subview];

        // now let's see where the lower right corner of this subview is

        lowerRight.x = subview.frame.origin.x + subview.frame.size.width;
        lowerRight.y = subview.frame.origin.y + subview.frame.size.height;

        // and adjust the maxsize accordingly, if we need to

        if (lowerRight.x > maxSize.width)
            maxSize.width = lowerRight.x;
        if (lowerRight.y > maxSize.height)
            maxSize.height = lowerRight.y;
    }

    // maybe you want to add a little margin?!?

    maxSize.width += 10.0;
    maxSize.height += 10.0;

    // adjust the bounds of this view accordingly

    CGRect bounds = view.bounds;
    bounds.size = maxSize;
    view.bounds = bounds;
} 
```

只需在您可能想要根据其子视图调整大小的任何“容器”视图上调用它（最好不要将其与适当的视图控制器包含混淆，这是一种不同的野兽）。请注意，我只是调整大小（假设您也不想移动子视图或视图的`origin`，如果您愿意，您可以轻松地做到这一点）。我也让这个递归进行，但也许你不想这样做。你的来电。

在第二个问题上，将标签 B 移动到标签 A 下方非常容易：

```
CGRect frame = b.frame;
frame.origin.y = a.frame.origin.y + a.frame.size.height;
b.frame = frame; 
```

# backbone.js - 管理与可见视图共享同一模型的隐藏主干视图

> ID：11731994
> 
> 赞同：3
> 
> 时间：2012-07-31T01:39:24.797
> 
> 标签：backbone.js, marionette

我们已经使用 Backbone 几个月了，但我们认为当隐藏视图与可见视图共享模型时，必须有更好的方法来处理它们。例如，我们有一个“View Segment”视图和一个“Edit Segment”视图，它们都代表一个“Segment”模型。其中一个总是在任何给定时刻隐藏，但是，仍然侦听与另一个相同的事件（包括 ajax 调用）。为什么我们只是隐藏视图而不是替换的原因是我们希望最小化更改视图之间的加载时间，因为视图显示大量数据和 dom 元素。我们认为隐藏视图在可见之前不必渲染。

是否有处理这种情况的适当（最佳实践）方法？你会如何处理这个问题？有没有一种简单的方法可以暂时禁用整个视图的事件监听？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-01T19:55:44.477

我们使用完全相同的场景来显示和编辑视图。我们已经将所有模型绑定逻辑收集到一个`bindEvents`方法中，并用一个方法对其进行了补充`unbindEvents`。

在`hide`视图的 - 方法中，我们调用`unbindEvents`并在`show`方法中调用`bindEvents`. 就那么简单。我们还调用了`bindEvents`in`initialize`方法和`unbindEvents`in`remove`方法来避免僵尸视图。

我们不关心 javascript 事件，因为它们通常不会在隐藏视图上触发（大多数是点击或更改驱动的）

顺便说一句，为了避免渲染一堆永远不会显示的 html，我们将视图的第一次渲染推迟到它第一次显示，所以在`show`我们测试的方法中`this.isRendered`（布尔值，默认为 false）如果它未设置，我们在显示之前渲染视图并将其设置为true。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-31T04:58:49.320

当模型更改我渲染它时，我的视图总是监听模型的更改事件。我想你也一样，所以当一个模型被获取时（你的意思是 ajax 调用）你什么都不想要。在您的渲染中（以及在模型更改的侦听方法中）您可以验证是否可见：

```
render : function(){
  if( !this.$el.is(":visible") ){
    //skipping any render action because our view is hidden
    return this;
  }
} 
```

并且还声明事件仅在您的视图的主要元素可见时才起作用，只需在选择器中添加前缀 :visible 在您的任何子选择器之前：

```
"click :visible .button" : "buttonClickHandler" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-31T02:39:04.637

一个简单的思路：我觉得可以使用Backbone.Viewt提供的delegateEvents和undelegateEvents方法来动态设置Events，当要显示**EditSegment**时先使用undelegateEvents动态取消**ViewSegment**的Events，然后delegateEvents动态初始化**EditSegment**的Events。

**EDIT-20120801：关于 model.unbind**

```
 bindTo: function(model, ev, callback) {
        model.bind(ev, callback, this);
        this.bindings.push({
            model: model,
            ev: ev,
            callback: callback
        });
    },

    _unbindFromAll: function() {
        _.each(this.bindings, function(binding) {
            binding.model.unbind(binding.ev, binding.callback);
        });
        this.bindings = [];
    }, 
```

# c# - 字符串格式数字千位123K、百万位123M、十亿位123B

> ID：11731996
> 
> 赞同：40
> 
> 时间：2012-07-31T01:39:28.303
> 
> 标签：c#, string-formatting

有没有办法使用字符串格式化程序将千、百万、十亿格式化为 123K、123M、123B，而无需更改代码以将值除以千、百万或十亿？

```
String.Format("{0:????}", LargeNumber) 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-09-08T14:29:26.217

有不同的方法来实现这一点，但对我来说最简单和最快的是使用[“，”自定义说明符](http://msdn.microsoft.com/en-us/library/0c899ak8%28v=vs.100%29.aspx#SpecifierTh)

```
double value = 1234567890;

// Displays 1,234,567,890   
Console.WriteLine(value.ToString("#,#", CultureInfo.InvariantCulture));

// Displays 1,234,568K
Console.WriteLine(value.ToString("#,##0,K", CultureInfo.InvariantCulture));

// Displays 1,235M
Console.WriteLine(value.ToString("#,##0,,M", CultureInfo.InvariantCulture));

// Displays 1B
Console.WriteLine(value.ToString("#,##0,,,B", CultureInfo.InvariantCulture)); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2017-12-28T01:19:28.217

**我在扩展方法**中使用了这种混合格式（只需将其添加到您的项目中即可享受）

```
public static string ToKMB(this decimal num)
{
    if (num > 999999999 || num < -999999999 )
    {
        return num.ToString("0,,,.###B", CultureInfo.InvariantCulture);
    }
    else
    if (num > 999999 || num < -999999 )
    {
        return num.ToString("0,,.##M", CultureInfo.InvariantCulture);
    }
    else
    if (num > 999 || num < -999)
    {
        return num.ToString("0,.#K", CultureInfo.InvariantCulture);
    }
    else
    {
        return num.ToString(CultureInfo.InvariantCulture);
    }
} 
```

**采用：**

```
((decimal)235).ToKMB();
// 235

((decimal)1235).ToKMB();
// 1.2K

((decimal)6271235).ToKMB();
// 6.27M

((decimal)93246571235).ToKMB();
// 93.247B 
```

> **笔记：**
> 
> *   它为更大的数字返回更多细节，我喜欢它。
>     
>     
> *   它也支持负数。（感谢@Dusty 在评论中的注释。
>     
>     
> *   我`decimal`在这个例子中为数字写了一个方法，你可以为它写一些覆盖方法来支持`int`，`long`并`double`在没有任何转换的情况下使用它，例如：
>     
>     
>     
>     `myIntNumber.ToKMB();`
>     
>     
>     
>     `myLongNumber.ToKMB();`
>     
>     
>     
>     `myDoubleNumber.ToKMB();`
>     
>     
>     
>     `myDecimalNumber.ToKMB();`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-31T01:49:21.957

您可以实现一个将值除以千、百万或十亿的[ICustomFormatter ，并像这样使用它：](http://msdn.microsoft.com/en-us/library/system.icustomformatter.aspx)

```
var result = string.Format(new MyCustomFormatter(), "{0:MyFormat}", number); 
```

# php - Backbone.js Pushstate 路由和 PHP 框架的路由器

> ID：11731998
> 
> 赞同：0
> 
> 时间：2012-07-31T01:39:33.907
> 
> 标签：php, jquery, ajax, backbone.js, underscore.js

我正在使用 Backbone.js 和 PHP MVC 框架（Codeigniter、Laravel）。我对使用 Pushstates 时 PHP 路由器和 Backbone 路由器如何处理 URL 感到困惑。（我还没有开始使用 pushstates，还在使用 hashbangs `#`）。我不是在处理单页应用程序，而是该站点由几个页面组成，这些页面本身就像单页应用程序一样。

**问题：**如果我有一个页面`http://domain.com/user/user123`，并且单击一个链接`http://domain.com/user/user123#photos`通过 AJAX 加载了一些照片并且我想摆脱，我预见到单击链接后`#`转到的用户决定将 URL 复制并粘贴到另一个的问题`http://domain.com/user/user123/photos`浏览器选项卡将看到一个错误 404 页面，因为 PHP 框架路由器*（如果我正确假设 PHP 路由器在主干之前首先处理 URL 请求）*无法识别此 URL 的存在。这个问题应该如何解决？

我认为会出现的另一个问题是，当用户直接进入时，视图应该如何呈现`http://domain.com/user/user123/photos`？HTML 代码是否应该在 PHP 视图（对于用户直接输入 URL 的情况）和主干.js 视图（对于用户单击链接的情况）上重复`http://domain.com/user/user123`？这对我来说似乎不是最佳解决方案。或者是否可以通过主干在两种情况下以某种方式呈现视图以避免重复代码？

请指教 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-31T02:35:56.220

`pushState`您已经遇到了整合到主干应用程序中更具挑战性的方面之一。基本上，您需要确保在您的应用程序中链接到的任何路由也可以由服务器处理。

在 PHP 中，解决这个问题的最简单方法是将所有对有效 URL ( ) 的请求路由`/user/user123`到您的根页面，然后让骨干网调用对应于 url 片段的处理程序。这要求您在服务器端实际知道有效 URL 是什么（即`/posts/5`有效`/posts/abc`或无效`/aaa/`等），但除此之外它不是大量工作。

最终的问题是您在无状态协议 (HTTP) 和有状态应用程序 (backbone.js) 之间切换。这需要一些仔细的计划。

关于您的第二个问题，您不需要在服务器端呈现视图，只需执行您对根域的请求所做的一切，backbone.js 将触发适当的处理程序（例如`/user/user123`）。您想要在服务器端实际呈现视图的唯一情况是，如果您想支持没有 javascript 的用户，或者让您的应用程序 RESTful，在这种情况下您将不得不复制视图代码（没有简单的方法这）。

希望这是有道理的。