# StackOverflow 问答 12080000-12080999

# svn - 合并到发布分支/从发布分支合并时，祖先是否重要？

> ID：12080000
> 
> 赞同：1
> 
> 时间：2012-08-22T19:20:26.760
> 
> 标签：svn, merge, branch

我们正在创建一个 Subversion 存储库以容纳当前不受版本控制的代码库。在我们当前的模型中，每个版本都有一个主线“桶”（称为 5.6）和多个仅修复错误的“桶”（5.6.1、5.6.2 等）。这很好地映射到具有多个发布分支的主干的 SVN 模型，尽管我们的布局会像这样扁平化：

*   5.6
    *   后备箱等
*   5.6.x
    *   后备箱等

预期将根据需要在 5.6/trunk 和 5.6.x/trunk 之间来回挑选更改。发布分支永远不会重新集成。

在这种情况下，5.6.x/trunk 是否*真的*是`svn copy`5.6/trunk 的一个是否重要？如果它们只是两个没有共享祖先的独立文件夹（据 SVN 所知），是否有可能遇到合并冲突？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T07:27:45.107

只要您的分支是您想要合并回来的主干的 svn 副本，一切都很好。在另一种方式中，您需要使用**--ignore-ancestry**

注意：如果您合并具有相同名称但不同祖先的文件，文件将被**替换**，而不是合并。通常这是非常糟糕的，难以检测并且会导致各种奇怪的问题（构建问题，新引入的错误..等等..）。仅当您同时更改合并目标时才会出现树冲突。您可以通过使用**--ignore-ancestry来避免这种情况**

# jquery - 如何使用 jquery 获取下拉菜单的选定选项的值？

> ID：12080002
> 
> 赞同：1
> 
> 时间：2012-08-22T19:20:38.050
> 
> 标签：jquery

```
 <select id="testSelection">
           <option> test1 </option> 
           <option> test2 </option> 
           <option> test3 </option> 
           <option> test4 </option> <--- selected this one from the pull down menu 
           <option> test5 </option> 
           <option> test6 </option> 
  </select>

             $("#testSelection").change(function()
             {
                    alert($(this).text());
             }); 
```

对我来说很奇怪，警报消息显示了所有选择，但我希望它只显示在 test4 文本上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T19:23:12.030

```
<select id="testSelection">
    <option value="1">test1</option>
    <option value="2">test2</option>
    .....
</select> 
```

这真的取决于你想要什么：

```
$("#testSelection").on('change', function() {
    // if you just want the text/html inside the select (ie: test1, test2, etc)
    alert($(this).find('option:selected').text()); 

    // or you want the actual value of the option <option value="THISHERE">
    alert($(this).val()); 
});​ 
```

[jsFiddle 演示](http://jsfiddle.net/XCSgG/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:24:07.617

您需要使用`val()`功能，而不是`text()`功能。

```
$("#testSelection").change(function()
{
    alert($(this).val());
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:24:27.697

`$(this).text()`返回元素内的所有文本，在本例中为`select`元素。这就是为什么你得到`"test1 test2 ..."`.

假设您想要所选选项的文本：

```
$(this).find(':selected').text() 
```

如果您想要所选选项的 value 属性，那么 @mcpDESIGNS 的答案将起作用。但是，请注意，您需要为元素添加`value`属性，如下所示：`option`

```
<option value="test4">test4</option> 
```

# geometry - 如何判断两个环（3d 中的圆圈）是否相连

> ID：12080003
> 
> 赞同：3
> 
> 时间：2012-08-22T19:20:44.197
> 
> 标签：geometry

我在 3 个空间中有两个环，每个环由法线向量、中心坐标和半径表示。如何确定环是否已链接。即一个圆上的一个点位于另一个圆盘上。

这将在一个紧密的循环中实现，所以我关心性能。我觉得应该有一个封闭形式的解决方案。到目前为止，我只想到了迭代解决方案。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:33:22.530

算法概要：

1.  处理圆的平面平行或并发的情况。
2.  找到圆的平面的交线。
3.  找到圆与这条线的交点。
4.  所有与线的圆交点都在两个平面上。我们现在可以进行距离检查以查看圆圈是否相连。

细节：

我假设圆 C1 和 C2 由中心点 (p1, p2)、单位法线轴矢量 (n1, n2) 和半径 (r1, r2) 给出。

如果对于某个标量 k，n1 == k n2，则平面是平行的或并发的。如果它们是并发的，这将成为一个微不足道的二维问题：检查 dist(p1, p2) < r1+r2 是否。

否则，平面相交于直线 L。如果两个圆是相连的，那么它们都必须与 L 相交，因为连接意味着它们相互穿过彼此的定义平面。这为您提供了第一个微不足道的拒绝测试。

L 由点 q 和向量 v 给出。找到 v 很容易：它只是 n1 和 n2 的叉积。q 有点棘手，但我们可以选择最接近线的点

```
l1(s) = p1 + s (v X n1)
l2(t) = p2 + t (v X n2) 
```

这些线垂直于 v、n1 和 n2，并且位于 C1 和 C2 的平面上。它们的最近接近点必须在 L 上。

您可以参考[这篇文章](https://stackoverflow.com/questions/627563/calculating-the-shortest-distance-between-two-lines-line-segments-in-3d)来了解如何找到最近的方法点。

最后，圆相交的唯一方法是它们在 L 上都有点。如果有，则考虑 C1 和 L 的交点，因为它们与 C2 相关。如果 C1 和 L 有两个交点 q11 和 q12 并且其中一个**恰好**在 C2 内部，则这些圆是相连的。由于 L 在 C2 的平面上，因此这成为平面圆点测试：

```
IF dist(p1, q11) < r1 THEN
    linked = (dist(p1, q12) > r1)
ELSE
    linked = (dist(p1, q11) < r1)
ENDIF 
```

当然，这个伪代码在处理圆实际相交的情况时有点草率，但是应该如何处理取决于您的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-26T06:02:12.910

一个相对容易编码的直接解决方案：计算两个平面的交线，然后旋转和平移所有东西（在我的例子中，定义两个圆的六个点），使线成为 Z 轴（x=y= 0)。然后可以分别围绕 Z 旋转平面，使第一个圆 C1 位于 XZ 平面上，C2 位于 YZ 平面上。现在中心和半径很容易找到（在我的情况下，我最初没有它们）。这些旋转不会更改链接/无链接属性，并且可以根据圆与 Z 轴的四个交点的顺序轻松确定链接或缺少链接。（如果任何一个圆圈不与 x=y=0 相交，则没有链接。）（我可能混淆了轴，但我认为这会起作用。）谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-09T03:14:26.823

这是 3D 圆盘交叉问题吗？或者，是圆-圆相交问题吗？

如果是前者，则有一种快速的封闭形式算法。首先，排除圆圈太远的情况： `dist(CIR1.c, CIR2.c) > CIR1.r + CIR2.r`

处理边缘情况：共面圆。

将圆盘拉伸到其平面中，然后将圆与该平面相交。如果有 1 或 2 个交叉点，则测试它们是否符合`pointInDisk(p, CIR)`逻辑。报告任何幸存的交叉点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T19:49:04.277

计算几何教科书可能有一个很好的解决方案！

但我目前手头没有计算几何教科书。如果我现在要推出自己的产品，基于我自己（非常有限）的直觉，我想我会从 3d 轴对齐的边界框开始。

例如，创建一个“就在圆内”边界框，以及一个“就在圆外”边界框。我相信弄清楚两个轴对齐的框是否重叠是微不足道的（我曾经做过的家庭作业的第 2.1 节讨论了 2D 情况下的一个相关问题 --- 找到一个点最近的矩形： [http://juliusdavies. ca/uvic/report.html](http://juliusdavies.ca/uvic/report.html)）。

我怀疑以下断言会成立（但我可能是错的）：

*   如果内盒重叠，则环肯定是连接的。（我现在认为这是错误的......）

*   如果外盒不重叠，那么它们肯定没有连接——我非常有信心这个断言成立！:-) :-)

*   如果外盒重叠，但内盒不重叠，则它们可能是连接的。

这就是我要开始的地方，如果我自己滚动的话。

结论：呃，我希望你对其他答案有更好的运气。:-)

# c++ - 如何告诉 lint 跟踪指向向量的保管指针？

> ID：12080004
> 
> 赞同：3
> 
> 时间：2012-08-22T19:20:47.487
> 
> 标签：c++, memory-leaks, destructor, stdvector, lint

我有一些代码循环和更新一些指针并将它们存储在一个向量中：

```
std::vector<InputBox*> m_octets; 
...  
InputBox* octet = new InputBox(rect, title, touch_num);
m_octets.push_back(octet); 
```

在类析构函数中，我`for_each`为`m_octets`每个指针调用并调用析构函数。我认为这一切都很好。它全部编译并且单元测试通过。问题是 Gimpel 的 PC-lint 不喜欢它。它看到“八位字节”是一个尚未释放的保管指针（警告 429）。我当然可以禁用该警告，但手册（11.2.1）表明这是有语义的。我原以为会起作用：

```
-sem(*push_back, custodial (1)) 
```

不幸的是，它没有效果。我尝试了各种组合，包括完全指定`m_octets.push_back`，但似乎没有任何效果。对于给出的示例，有人知道此命令的正确形式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:57:04.927

这对我来说很好用：`-sem(std::vector::push_back, custodial(1))`

# iphone - Xcode IPA 问题

> ID：12080005
> 
> 赞同：1
> 
> 时间：2012-08-22T19:20:50.237
> 
> 标签：iphone, ios, ios5, xcode4

我对生成的 ipa 文件有疑问。

当我为临时分发生成 ipa 文件时，一切都在 xcode 上顺利运行，但是当有人尝试下载它时，应用程序返回错误消息“此时无法安装应用程序”。

我尝试生成另一个临时配置文件，但它返回相同的错误。

由于我没有修改我的证书中的任何内容，这可能是一个 xcode 问题（我在 xcode 管理器中的配置文件很好）吗？

顺便说一句，我注意到在此错误开始发生后，我的 IPA 文件有 1MB 文件大小，并且在此错误开始出现之前它有 1.3MB。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:13:52.030

我以前遇到过这个问题。您需要进入您的项目选择您的目标，并在**构建设置**下选择您在配置文件中添加用户设备的适当证书。这些将列在**代码签名下**

您可能将其设置为自动检测有时它并不总是检测到正确的证书。

还要确保证书在用户电话上处于活动状态。让他们去

设置 -> 常规 -> 配置文件 -> 并确保旁边有一个绿色的已验证复选标记。

# vba - 用于创建新工作表的 Excel 宏

> ID：12080006
> 
> 赞同：1
> 
> 时间：2012-08-22T19:21:03.827
> 
> 标签：vba, excel

我正在尝试遍历一行中的某些列，并使用我所在的当前列/行的值的名称创建新的工作表。

```
Sub test()
    Range("R5").Select
    Do Until IsEmpty(ActiveCell)
        Sheets.Add.Name = ActiveCell.Value
        ActiveCell.Offset(0, 1).Select
    Loop
End Sub 
```

**此代码从R5**开始正确创建第一个，但随后宏似乎切换到该工作表并且没有完成任务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:36:54.013

Sheets.Add 会自动将您的选择移动到新创建的工作表（就像您手动插入新工作表一样）。因此，偏移量基于现在已成为您选择的新工作表的单元格 A1 - 您选择一个空单元格（因为工作表是空的）并且循环终止。

```
Sub test()
Dim MyNames As Range, MyNewSheet As Range

    Set MyNames = Range("R5").CurrentRegion ' load contigeous range into variable
    For Each MyNewSheet In MyNames.Cells    ' loop through cell children of range variable
        Sheets.Add.Name = MyNewSheet.Value
    Next MyNewSheet
    MyNames.Worksheet.Select                ' move selection to original sheet
End Sub 
```

这会更好....您将名称列表分配给 Range 类型的对象变量，并在 For Each 循环中解决此问题。完成后，您将您的选择放回您来自的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:37:18.633

`Sheets.Add`将自动使您的新工作表成为活动工作表。最好的办法是向对象声明变量（这始终是最佳实践）并引用它们。就像我在下面所做的那样：

```
 Sub test()

    Dim wks As Worksheet
    Set wks = Sheets("sheet1")

    With wks

       Dim rng As Range
       Set rng = .Range("R5")

       Do Until IsEmpty(rng)
            Sheets.Add.Name = rng.Value
            Set rng = rng.Offset(0, 1)
       Loop

   End With

End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T00:04:07.577

从列表中命名要处理的工作表时，应始终使用错误处理

*   工作表名称中的无效字符
*   工作表名称太长
*   重复的工作表名称

请更改`Sheets("Title")`以匹配标题表的工作表名称（或位置）

出于性能原因，下面的代码使用变量数组而不是工作表名称的范围，尽管关闭`ScreenUpdating`可能会对用户产生最大的影响

```
Sub SheetAdd()
Dim ws1 As Worksheet
Dim ws2 As Worksheet
Dim strError As String
Dim vArr()
Dim lngCnt As Long
Dim lngCalc As Long

Set ws1 = Sheets("Title")
vArr = ws1.Range(ws1.[r5], ws1.[r5].End(xltoRight))

If UBound(vArr) = Rows.Count - 5 Then
MsgBox "sheet range for titles appears to be empty"
Exit Sub
End If

With Application
.ScreenUpdating = False
.EnableEvents = False
lngCalc = .Calculation
End With

For lngCnt = 1 To UBound(vArr)
Set ws2 = Sheets.Add
On Error Resume Next
ws2.Name = vArr(lngCnt, 1)
If Err.Number <> 0 Then strError = strError & vArr(lngCnt, 1) & vbNewLine
On Error GoTo 0
Next lngCnt

With Application
.ScreenUpdating = True
.EnableEvents = True
.Calculation = lngCalc
End With

If Len(strError) > 0 Then MsgBox strError, vbCritical, "These potential sheet names were invalid"

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-22T15:08:24.330

这可能是最简单的。没有错误处理，只是创建工作表的一次性代码

```
Sub test()
Workbooks("Book1").Sheets("Sheet1").Range("A1").Activate
Do Until IsEmpty(ActiveCell)
    Sheets.Add.Name = ActiveCell.Value
    Workbooks("Book1").Sheets("Sheet1").Select
    ActiveCell.Offset(0, 1).Select
Loop
End Sub 
```

# java - JPA：如何保持具有一些级联关系的对象？仍然是 Javax.persistence.PersistenceException ...

> ID：12080008
> 
> 赞同：1
> 
> 时间：2012-08-22T19:21:15.287
> 
> 标签：java, jpa

我做了很多研究，但我没有找到我的问题的真正答案。

我想创建一个有很多关系的对象，并坚持下去。

我的实体是：在引用类型上定义的引用，链接到手册（可能为空）。此参考是为一架或多架飞机定义的，并有一些翻译。

为了方便起见，我为级联和orphelanRemoval添加了一些注释。

这里是代码。

```
@Table(name = "T_E_REFERENCE_REF", 
       uniqueConstraints = @UniqueConstraint(columnNames = "REF_IDENTIFIER"))
public class Reference implements java.io.Serializable {

    @Id
    @Column(name = "REF_ID", unique = true, nullable = false)
    @TableGenerator(name="referenceSeqStore", 
        table="T_S_APP_SEQ_STORE_AST", 
        pkColumnName="AST_SEQ_NAME",
        valueColumnName = "AST_SEQ_VALUE",
        pkColumnValue = "T_E_REFERENCE_REF.REF_ID", 
        allocationSize=1)
    @GeneratedValue(strategy=GenerationType.TABLE, generator="referenceSeqStore")                   
    private Integer id;

    @Column(name = "REF_IDENTIFIER", unique = true, nullable = false, length = 50)  
    private String identifier;

    @Column(name = "REF_LINK")  
    private String link;

    @Column(name = "REF_OBSERVATIONS", length = 4000)
    private String observations;

    @ManyToOne
    @JoinColumn(name = "REF_RFT_ID", nullable = false)  
    private ReferenceType referenceType;

    @ManyToOne
    @JoinColumn(name = "REF_MAN_ID")    
    private Manual manual;  

    @OneToMany(fetch = FetchType.LAZY, 
               mappedBy = "reference",
               cascade = { CascadeType.ALL }, orphanRemoval = true)
    private Set<Translation> translations = new HashSet<Translation>(0);

    @ManyToMany(fetch = FetchType.LAZY,
                cascade = { CascadeType.ALL })
    @JoinTable(name = "T_J_REF_AIR_RFA", 
               joinColumns = { @JoinColumn(name = "RFA_REF_ID", nullable = false, updatable = false) },
               inverseJoinColumns = { @JoinColumn(name = "RFA_AIR_ID", nullable = false, updatable = false) })
    private Set<Aircraft> aircrafts = new HashSet<Aircraft>(0);

    @Transient 
    private String localeTranslation;

}

@Table(name = "T_R_AIRCRAFT_AIR", 
       uniqueConstraints = @UniqueConstraint(columnNames = "AIR_NAME"))
public class Aircraft implements java.io.Serializable {

    @Id
    @Column(name = "AIR_ID", unique = true, nullable = false)
    @TableGenerator(name="aircraftSeqStore", 
        table="T_S_APP_SEQ_STORE_AST", 
        pkColumnName="AST_SEQ_NAME",
        valueColumnName = "AST_SEQ_VALUE",
        pkColumnValue = "T_R_AIRCRAFT_AIR.AIR_ID", 
        allocationSize=1)
    @GeneratedValue(strategy=GenerationType.TABLE, 
        generator="aircraftSeqStore")       
    private Integer id;

    @Column(name = "AIR_NAME", unique = true, nullable = false, length = 50)
    private String name;

    @ManyToMany(fetch = FetchType.LAZY)
    @JoinTable(name = "T_J_REF_AIR_RFA", 
               joinColumns = { @JoinColumn(name = "RFA_AIR_ID", nullable = false, updatable = false) }, 
               inverseJoinColumns = { @JoinColumn(name = "RFA_REF_ID", nullable = false, updatable = false) })
    @OrderBy("identifier")
    private Set<Reference> references = new HashSet<Reference>(0);

    @ManyToMany(fetch = FetchType.LAZY)
    @JoinTable(name = "T_J_MAN_AIR_MNA", 
               joinColumns = { @JoinColumn(name = "MNA_AIR_ID", nullable = false, updatable = false) }, 
               inverseJoinColumns = { @JoinColumn(name = "MNA_MAN_ID", nullable = false, updatable = false) })
    @OrderBy("type")
    private Set<Manual> manuals = new HashSet<Manual>(0);

    @OneToMany(fetch = FetchType.LAZY, 
               mappedBy = "aircraft",
               cascade = { CascadeType.REMOVE })
    private Set<UserConfig> userConfigs = new HashSet<UserConfig>(0);

}

@Table(name = "T_R_REFERENCE_TYPE_RFT", 
       uniqueConstraints = @UniqueConstraint(columnNames = "RFT_TYPE"))
public class ReferenceType implements java.io.Serializable {

    @Id
    @Column(name = "RFT_ID", unique = true, nullable = false)
    @TableGenerator(name="referenceTypeSeqStore", 
        table="T_S_APP_SEQ_STORE_AST", 
        pkColumnName="AST_SEQ_NAME",
        valueColumnName = "AST_SEQ_VALUE",
        pkColumnValue = "T_R_REFERENCE_TYPE_RFT.RFT_ID", 
        allocationSize=1)
    @GeneratedValue(strategy=GenerationType.TABLE, generator="referenceTypeSeqStore")                   
    private Integer id;

    @Column(name = "RFT_TYPE", unique = true, nullable = false, length = 50)    
    private String type;

    @OneToMany(fetch = FetchType.LAZY, 
               mappedBy = "referenceType", 
               cascade = { CascadeType.REMOVE })    
    private Set<Reference> references = new HashSet<Reference>(0);

    @OneToMany(fetch = FetchType.LAZY, 
               mappedBy = "referenceType",
               cascade = { CascadeType.REMOVE })    
    private Set<UserConfig> userConfigs = new HashSet<UserConfig>(0);

    @Transient
    private String typeTranslated;
}

@Table(name = "T_R_MANUAL_MAN", 
       uniqueConstraints = @UniqueConstraint(columnNames = "MAN_TYPE"))
public class Manual implements java.io.Serializable {

    @Id
    @Column(name = "MAN_ID", unique = true, nullable = false)
    @TableGenerator(name="manualSeqStore", 
        table="T_S_APP_SEQ_STORE_AST", 
        pkColumnName="AST_SEQ_NAME",
        valueColumnName = "AST_SEQ_VALUE",
        pkColumnValue = "T_R_MANUAL_MAN.MAN_ID", 
        allocationSize=1)
    @GeneratedValue(strategy=GenerationType.TABLE, generator="manualSeqStore")                  
    private Integer id;

    @Column(name = "MAN_TYPE", unique = true, nullable = false, length = 50)
    private String type;

    @ManyToMany(fetch = FetchType.LAZY)
    @JoinTable(name = "T_J_MAN_AIR_MNA", 
               joinColumns = { @JoinColumn(name = "MNA_MAN_ID", nullable = false, updatable = false) }, 
               inverseJoinColumns = { @JoinColumn(name = "MNA_AIR_ID", nullable = false, updatable = false) })  
    private Set<Aircraft> aircrafts = new HashSet<Aircraft>(0);

    @OneToMany(fetch = FetchType.LAZY, mappedBy = "manual")
    private Set<Reference> references = new HashSet<Reference>(0);

}

@Table(name = "T_E_TRANSLATION_TRL")
public class Translation implements java.io.Serializable {

    @Id
    @Column(name = "TRL_ID", unique = true, nullable = false)
    @TableGenerator(name="translationSeqStore", 
        table="T_S_APP_SEQ_STORE_AST", 
        pkColumnName="AST_SEQ_NAME",
        valueColumnName = "AST_SEQ_VALUE",
        pkColumnValue = "T_E_TRANSLATION_TRL.TRL_ID", 
        allocationSize=1)
    @GeneratedValue(strategy=GenerationType.TABLE, 
        generator="translationSeqStore")            
    private Integer id;

    @ManyToOne
    @JoinColumn(name = "TRL_REF_ID", nullable = false)
    private Reference reference;

    @ManyToOne
    @JoinColumn(name = "TRL_LAN_ID", nullable = false)  
    private Language language;

    @Column(name = "TRL_LABEL", nullable = false, length = 4000)    
    private String label;

}

@Table(name = "T_R_LANGUAGE_LAN", 
       uniqueConstraints = @UniqueConstraint(columnNames = "LAN_LANG"))
public class Language implements java.io.Serializable {

    @Id
    @Column(name = "LAN_ID", unique = true, nullable = false)
    @TableGenerator(name="langSeqStore", 
        table="T_S_APP_SEQ_STORE_AST", 
        pkColumnName="AST_SEQ_NAME",
        valueColumnName = "AST_SEQ_VALUE",
        pkColumnValue = "T_R_LANGUAGE_LAN.LAN_ID", 
        allocationSize=1)
    @GeneratedValue(strategy=GenerationType.TABLE, generator="langSeqStore")        
    private Integer id;

    @Column(name = "LAN_LANG", unique = true, nullable = false, length = 2) 
    private String lang;
} 
```

我编写了一个 JUnit 测试代码，以便使用已存储在数据库中的一些对象创建一个新引用。但是我的插入方法（persist）每次都会失败，并出现 javax.persistence.PersistenceException：org.hibernate.PersistentObjectException：分离的实体传递给持久化。

这是我的 Junit 测试：

```
@Test
@Transactional
public void testInsertReference() {

    // Create transient
    Reference reference = new Reference();
    reference.setIdentifier("MYTEST");
    reference.setLink("MYLINK");
    reference.setObservations("MYCOMMENT");

    // get from database
    Manual manual = manualService.getManual("MYMAN");
    ReferenceType refType = referenceTypeService.getReferenceType(1);

    Aircraft aircraft = aircraftService.getAircraft("MYAIR");
    Set<Aircraft> airList = new HashSet<Aircraft>();
    airList.add(aircraft);

    Language langEn = languageService.getLanguage("EN");
    Language langFr = languageService.getLanguage("FR");

    Translation trlEn = new Translation();
    trlEn.setLanguage(langEn);
    trlEn.setLabel("my ref test");

    Translation trlFr = new Translation();
    trlFr.setLanguage(langFr);
    trlFr.setLabel("mon test de ref");

    List<Translation> trlList = new ArrayList<Translation>();
    trlList.add(trlEn);
    trlList.add(trlFr);         

    // Set some relations
    reference.setManual(manual);
    reference.setReferenceType(refType);
    reference.setAircrafts(airList);
    reference.setTranslations(new HashSet<Translation>(trlList));

    // Persist
    reference = referenceService.insertReference(reference);  // which execute : entityManager.persist(entity)
    logger.info(reference.toString());
} 
```

任何的想法 ？

谢谢

* * *

堆栈跟踪：

```
javax.persistence.PersistenceException: org.hibernate.PersistentObjectException: detached entity passed to persist: myprog.test.persistence.entity.Aircraft
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1365)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1293)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1299)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:865)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:365)
    at $Proxy39.persist(Unknown Source)
    at myprog.test.persistence.dao.impl.GenericDaoImpl.create(GenericDaoImpl.java:54)
    at myprog.test.service.impl.ReferenceServiceImpl.insertReference(ReferenceServiceImpl.java:61)
    at myprog.test.service.impl.ReferenceServiceImpl$$FastClassByCGLIB$$f01500a8.invoke(<generated>)
    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
    at org.springframework.aop.framework.Cglib2AopProxy$CglibMethodInvocation.invokeJoinpoint(Cglib2AopProxy.java:689)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622)
    at myprog.test.service.impl.ReferenceServiceImpl$$EnhancerByCGLIB$$a99de5b.insertReference(<generated>)
    at myprog.test.service.ReferenceServiceTest.testInsertReference(ReferenceServiceTest.java:147)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:83)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: myprog.test.persistence.entity.Aircraft
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:141)
    at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:802)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:795)
    at org.hibernate.engine.spi.EJB3CascadingAction$1.cascade(EJB3CascadingAction.java:52)
    at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:380)
    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:323)
    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
    at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:409)
    at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:350)
    at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326)
    at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
    at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165)
    at org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:448)
    at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:293)
    at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193)
    at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
    at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:78)
    at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:208)
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:151)
    at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:78)
    at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:811)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:786)
    at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:790)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:859)
    ... 49 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:07:44.447

一旦你从数据库中得到对象 ReferenceType 和 Aircraft ，它们就不再由 PersistenceManager 管理，这就是分离对象的含义。

如果您需要这样做，您必须在 ReferenceService 中重新附加恢复的实体，您可以使用此方法：

```
Aircraft a = em.getReference(Aircraft.class, reference.getAircraft().getId()); 
```

在调用persist之前，您必须对所有分离的实体执行此操作，请记住在恢复后将它们再次设置为您的参考对象：

```
reference.setAircraft(a); 
```

有时问题也是因为你有双向关联但你没有设置它们的两边。

您可以在此处找到有关它的更多信息：

[http://java.dzone.com/articles/saving_detatched_entities](http://java.dzone.com/articles/saving_detatched_entities)

问候

# asp.net-mvc - MVC 4成功登录有时会返回登录屏幕

> ID：12080011
> 
> 赞同：0
> 
> 时间：2012-08-22T19:21:32.760
> 
> 标签：asp.net-mvc, asp.net-mvc-4

每隔一段时间，当有人登录到我的 ASP.Net MVC 4 应用程序时，他们就会返回到登录屏幕。重新输入凭据始终允许成功登录。日志记录确认两次尝试都输入了正确的凭据。

登录代码看起来像

```
[AllowAnonymous]
[HttpPost]
public ActionResult Login(LogOnModel model, string returnUrl)
{
    try
    {
        MyData md = (MyData)Session["MyData"]; // Should be null, but testing that it is after logging out and back in

        if (ModelState.IsValid)
        {
            if (Membership.ValidateUser(model.UserName, model.Password))
            {
                logger.Info("Successful login '" + model.UserName + "' from IP " + Request.IPAddresses());
                FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                    && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
                {
                    return Redirect(returnUrl);
                }
                else
                {
                    return RedirectToAction("Index", "Home");
                }
            }
            else
            {
                logger.Warn("Login failed '" + model.UserName + "' from IP " + Request.IPAddresses());
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }
        else
        {
            logger.Warn("Login failed (model state invalid) '" + model.UserName + "' from IP " + Request.IPAddresses());
            ModelState.AddModelError("", "The user name or password provided is incorrect.");
        }

        // If we got this far, something failed, redisplay form.
        logger.Warn("Something failed during login.  Redisplaying login form.");
    }
    catch (Exception ex)
    {
        logger.Warn("Exception during logon process: " + ex.Message);
    }

    return View(model);
} 
```

变量*logger*是默认的 NLog 类记录器。

在隔离环境中重现问题后，日志文件立即看起来像

> 2012-08-22 10:51:25.4581 INFO 从 IP 10.0.0.21 成功登录“演示”
> 
> 2012-08-22 10:51:39.9741 信息从 IP 10.0.0.21 成功登录“演示”

日志文件中不存在任何指示登录失败或异常的警告日志条目。

当 Web 服务器空闲一段时间后，这种情况似乎会更频繁地发生。

如何诊断/解决问题？

# javascript - D3.js 中的双重嵌套数据

> ID：12080012
> 
> 赞同：2
> 
> 时间：2012-08-22T19:21:33.353
> 
> 标签：javascript, d3.js

我正在尝试制作 2 个部分：一个用于月，一个用于年 在每个部分内：彼此内部有 2 个饼图，所以

*   月
    --> mtd 派
    --> lymtd 派
*   年份
    --> lyytd 派
    --> ytd 派

我的数据结构如下：

```
{range:"month||year",period:"mtd||ytd||lymtd||lyytd",category_id:25,amount:100} 
```

我已经嵌套了我的数据

```
nested = d3.nest()
  .key(function(d){return d.range;})
  .key(function(d){return d.period;})
  .entries(collection.toD3Json()); 
```

我的初始数据附件是：

```
var blocks = chart.selectAll("svg")
      .data(nested, function(d){ return d.key;}) 
```

关键是我想始终保持**对象的不变性**，所以如果我附加一个新的嵌套数据结构，它将使用现有的键或在键不存在时添加新元素。

我在通过第一个数据连接时遇到问题，因为我想将 nested.values 与另一个 d.key 一起使用，但不确定如何操作。到目前为止，我最好的猜测是：

```
var circles = blocks.selectAll("g.block")
         .data(function(d){ return d.key;})
    .enter().append("svg:g")
         .attr("class","block"); 
```

# javascript - Jquery Mobile Autocomplete JS 函数作为源

> ID：12080013
> 
> 赞同：0
> 
> 时间：2012-08-22T19:21:39.780
> 
> 标签：javascript, jquery, jquery-mobile

我正在尝试实现[jquery 移动自动完成](http://www.andymatthews.net/code/autocomplete/)插件。示例用法如下所述。

我想为`source`参数设置一个 Javascript 函数，并希望在其中进行一些数据库查询并将信息返回到页面。

我怎样才能做到这一点？或者有没有其他方法可以实现我想要的？

```
$("#searchField").autocomplete({
    target: $('#suggestions'),

    //Source is either
    source: 'data.cfc?method=search&returnformat=json&data=simple'

    //or a js object
    //autocompleteData = $.parseJSON('[{"value":"1.0","label":"Alabama"},{"value":"2.0","label":"Alaska"}]');
    source: autocompleteData

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:25:25.913

您可以将一个函数传递给源。尽管似乎没有记录，但仔细研究[源代码](https://github.com/commadelimited/autoComplete.js/blob/master/jqm.autoComplete-1.4.3.js)（大约第 100 行），您可以看到他们可以为 source 选项提供一个函数。

他们在来源的评论中有一个简单的例子：

```
source:function(text,callback) { mydata = [1,2]; callback(mydata); } 
```

它似乎与常规的 jQuery 自动完成功能几乎完全相同，其中第一个参数是框中的文本，您调用第二个参数并将过滤后的数据传递给它。

# ruby-on-rails - 如何解决 test::unit 错误？

> ID：12080015
> 
> 赞同：0
> 
> 时间：2012-08-22T19:21:45.180
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个测试会产生以下错误：

```
1) Failure:
test_should_get_create(ProductRequestsControllerTest) [/Users/noahc/Dropbox/mavens/test/functional/product_requests_controller_test.rb:37]:
"ProductRequest.count" didn't change by 1.
<2> expected but was
<1>. 
```

我该如何解决这个问题？具体来说，如何获得更具体的详细错误？

这是我的测试：

```
 test "should get create" do
    sign_in(FactoryGirl.create(:user))
     assert_difference('ProductRequest.count') do
      post :create, product_request: FactoryGirl.attributes_for(:product_request)
    end

    assert_response :success
  end 
```

这是我的控制器：

```
 def create
  cart = current_cart
  rows = CartRow.find_all_by_cart_id(cart.id)

  rows.each do |row|
    product_request = ProductRequest.new(params[:product_request])
    product_request.user_id = current_user.id
    product_request.product_id = row.product_id
    product_request.quantity = row.quantity
    product_request.save
  end

  redirect_to root_path 
 end 
```

我认为问题在于我没有定义购物车。如何创建 unit::test 可以看到的购物车？我曾尝试使用 FactoryGirl 创建购物车，但这似乎不起作用。

carts_factory.rb

```
FactoryGirl.define do

  factory :cart do
  end
end 
```

更新测试：

```
test "should get create" do
    sign_in(FactoryGirl.create(:user))
    user = FactoryGirl.create(:user)
    product = FactoryGirl.create(:product)
     assert_difference('ProductRequest.count') do
      post :create, product_request: FactoryGirl.attributes_for(:product_request, user: user.id, product: product.id)
    end

    assert_response :success
  end 
```

和 current_cart

```
 def current_cart 
      Cart.find(session[:cart_id])
    rescue ActiveRecord::RecordNotFound 
      cart = Cart.create 
      session[:cart_id] = cart.id
      cart
    end 
```

***第二次更新***

我已经按照您的建议更新了工厂。

这是我的测试现在的样子：

```
 test "should get create" do
  user = FactoryGirl.create(:user)
  cart = FactoryGirl.create(:cart_with_1_row)
  product = FactoryGirl.create(:product)
  sign_in(user)

  product = FactoryGirl.create(:product)
  assert_difference('ProductRequest.count') do
    post :create, { product_request: FactoryGirl.attributes_for(:product_request, user_id: user.id, product_id: product.id, cart_id: cart.id) }
  end

  assert_response :success
end 
```

这是在测试控制台中：

```
irb(main):016:0> a = { product_request: FactoryGirl.attributes_for(:product_request, user_id: user.id, product_id: product.id, cart_id: cart.id) }
=> {:product_request=>{:quantity=>10, :street=>"123 street", :city=>"Some City", :state=>"Iowa", :zip=>"13829", :user_id=>1, :product_id=>2, :cart_id=>1}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T05:54:40.227

首先`CartRow.find_all_by_cart_id(cart.id)`，这不是好的设计。当您向 Cart 模型询问其行时会更好，例如：`rows = cart.rows`

我认为问题在于您的购物车内没有行。

正如我所见，您将购物车 ID 存储在会话中，但是当您在测试中调用控制器时，您不提供会话。在调用控制器之前，您需要创建购物车和购物车的行以及何时在会话中存储购物车 ID。**将当前会话和会话与 cart_id 合并很重要**。例如：

```
test "should get create" do
  user = FactoryGirl.create(:user)
  cart = FactoryGirl.create(:cart_with_1_row)
  sign_in(user)

  product = FactoryGirl.create(:product)
  assert_difference('ProductRequest.count') do
    post :create, { product_request: FactoryGirl.attributes_for(:product_request, user: user.id, product: product.id) }, { cart_id: cart.id }.merge(session)
  end

  assert_response :success
end 
```

您还需要更新您的购物车和购物车的行工厂：

```
FactoryGirl.define do
  factory :cart do
    factory :cart_with_1_row do
      after(:create) do |cart|
        FactoryGirl.create(:cart_row, cart: cart)
      end
    end
  end

  factory :cart_row do
    cart
  end
end 
```

我认为您的 CartRow 模型如下所示：

```
class CartRow < ActiveRecord::Base
  belongs_to :cart
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:32:35.503

问题肯定似乎来自购物车。

如果您不想在 FactoryGirl 中创建购物车（我会推荐），您可以在测试中将 current_card 存根，这将做同样的事情。

然而，模拟比在 FactoryGirl 中创建购物车要复杂得多，如果您打算在以后使用它，FactoryGirl 绝对是您的最佳选择。

# mobile - 如何阅读 .Contact 文件？

> ID：12080023
> 
> 赞同：0
> 
> 时间：2012-08-22T19:22:08.617
> 
> 标签：mobile, libraries, java

我先说明一下情况。我们知道我们可以通过蓝牙将手机中的联系人发送到其他设备。通常它们将作为“.contact”文件发送。在 Windows 中，这些文件将保存在 c:/users/userName/contacts 文件夹中。在我的 Java 程序（在 PC 中运行）中，我想阅读这些文件。是否有任何特定的库来读取这些文件？特别是几十​​年都没有过时的图书馆？请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:55:43.373

好的，根据要求将评论改写为答案。

您看到的 .contact 文件很可能是 Microsoft 特定的，您应该寻找其他格式，例如 vCard！您可能还会发现[bluecove.org](http://bluecove.org)上的蓝牙软件很有趣。

# c# - 两个归档在 wpf 组合框中

> ID：12080029
> 
> 赞同：1
> 
> 时间：2012-08-22T19:22:27.537
> 
> 标签：c#, wpf

我像这样填充我的 ComboBox

```
 using (MorEntities1 c = new MorEntities1())
        {
            var myViewSource = new CollectionViewSource { Source = c.People.ToList() };
            myViewSource.SortDescriptions.Add(
              new SortDescription("Family_Name", ListSortDirection.Ascending)
            );
            CB_Coehn.ItemsSource = myViewSource.View;
            CB_Coehn.DisplayMemberPath = "Family_Name";
            CB_Coehn.SelectedValuePath = "Person_Id";
            CB_Coehn.SelectedIndex = 0;
       } 
```

但是在数据库中我有一个字段 First Name 和字段 Last Name ，如何查看 ComboBox (LastName , FirstName) 中的两个字段？

这是在 WPF 和 c# 中

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:29:53.450

如果您可以控制“People”类，则可以创建一个名为“DisplayName”的新属性，按照您想要的方式对其进行格式化，并将 DisplayMemberPath 设置为该属性：

```
public string DisplayName
{
    get { return string.format("{0}, {1}", LastName, FirstName); }
}

CB_Coehn.DisplayMemberPath = "DisplayName"; 
```

如果您可以在 XAML 中而不是在代码隐藏中完成所有这些操作，那么您可以这样做：

```
<ComboBox x:Name="CB_Coehn">
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <Grid>
                <TextBlock>
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{0}, {1}">
                            <Binding Path="LastName" />
                            <Binding Path="FirstName" />
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </Grid>
        </DataTemplate>
    </ComboBox.ItemTemplate> 
```

注意：我没有测试过这段代码，只是凭记忆，但它至少应该非常接近。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:26:54.387

您需要创建一个`itemscontrol` `itemtemplate`包含两个标签的标签，然后将它们的`Text`属性绑定到 item.firstName 和 item.lastName。

有关示例，请参见[此处。](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/f230804d-fc0f-4321-a61e-69a2c890b28d/)

# toad - 当 LDAP.ora 不存在且 tnsnames.ora 没有 tns 条目时，通过 TOAD 连接到 db

> ID：12080043
> 
> 赞同：0
> 
> 时间：2012-08-22T19:23:21.527
> 
> 标签：toad, tnsnames

我能够使用 tnsnames.ora 中未定义的数据库模式名称连接到 TOAD。我在这里得到了解释： [尽管 tnsnames.ora 中不存在数据库名称，但 TOAD 连接](https://stackoverflow.com/questions/11890387/toad-connects-despite-the-db-name-not-being-present-in-tnsnames-ora/11891614#comment16110304_11891614) 但是现在，我需要将数据库连接凭据提供给对等方，并且该开发人员的 /network/admin 文件夹中没有 ldap.ora 文件. 她如何使用 TOAD 连接到数据库？我给了她我的 ldap.ora 文件并让她将它复制到 network/admin 中然后尝试。但这似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:30:32.577

好的，我找到了答案。在我的机器上，我做了一个`tnsping <DB_NAME>`，它给了我完整的主机名和端口。现在其他开发人员可以使用这些来创建一个 tnsentry。

# assembly - 有没有更有效的方法来执行两个有符号半字的算术右移？

> ID：12080051
> 
> 赞同：1
> 
> 时间：2012-08-22T19:24:06.897
> 
> 标签：assembly, arm, armv6

我目前正在重写一部分 C 代码，试图利用 Armv6 SIMD 和 DSP 扩展（我是 ARM 汇编语言的初学者）。

到目前为止，我在使用 SMUSD 和 SMUADX 实现复数乘法方面取得了巨大的进步。这些指令假定复数的实部和虚部存储在单个 32 位寄存器的 16 位半字上。

在执行某个复数乘法之前，我需要对两个有符号半字执行算术右移 1 位。

这是我当前的代码，我怀疑它远非高效，可能有更快的方法。我很担心，因为这段代码在算法的最紧密循环中运行，并且通过切换到 SMUSD 和 SMUADX 获得的一些循环被这个古怪的转换代码丢失了：

```
mov r0, r0, asr#1  @ arithmetically shift right by 1
                   @ higher half-word is ok, lower half-word is now polluted by
                   @ the higher half-word's lowest bit becoming the sign bit
                   @ of the lower half-word

tst   r0, #0x4000  @ test if the lower-halfword was negative 
                   @ (sign bit was shifted, it is now at position 14)

orrne r0, #0x8000  @ if negative, ensure the sign bit is turned on
biceq r0, #0x8000  @ if positive, ensure the sign bit is turned off 
```

我在第二个操作数上使用移位操作的 PKHBT 和 PKHTB 指令玩了一下，但它们似乎不适用于有符号半字。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T21:27:52.847

我认为这应该有效：

```
MOV r1, #0
SHADD16 r0, r1, r0 
```

SHADD16 是有符号的半字加，然后是结果的一半（与 ASR 为 1 相同）。

# jquery - 如何将 eventData 传递给 .submit()？

> ID：12080053
> 
> 赞同：10
> 
> 时间：2012-08-22T19:24:20.373
> 
> 标签：jquery

该[文档](http://api.jquery.com/submit/)没有任何关于如何使用的示例`.submit( [eventData], handler(eventObject) )`

我有以下函数，我需要将 url 传递给 row_save() 函数。

```
function row_edit() {
    var url = $(this).attr("href");
    var row = $(this).closest('tr')
    row.load(
        url + "/",
        null,
        function () {
            $("#save-form").submit(url, row_save); // ?? Not sure
        }
    );
    return false;
}

function row_save() {
  var url = ????
  var item = $(this).parent();
  var data = {
    item_description: item.find("#id_item_description").val()    
  };
  $.post(url, data, function (result) {
    if (result != "failure") {
      item.before($("li", result).get(0));
      item.remove();
      $(".row_edit").click(row_edit);
    }
    else {
      alert("Failed to validate before saving.");
    }
  });
  return false;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T19:28:16.650

> **eventData**将传递给事件处理程序的数据映射

```
function () {
    $("#save-form").submit({ "url": url }, row_save);
}

function row_save(ev) {
    var url = ev.data.url;
    // ...
} 
```

# objective-c - Objective-C 属性关键字

> ID：12080064
> 
> 赞同：3
> 
> 时间：2012-08-22T19:25:04.900
> 
> 标签：objective-c, properties, attributes

好的 - 新手 Objective-C 问题：

声明属性时，有如下属性：

```
@property (weak, nonatomic) 
```

我意识到我需要阅读这篇文章才能完全理解它，但我发现的大部分内容都是参考资料，因此可以链接到一篇可以解释最佳实践/使用场景的好文章（何时将哪个属性用于原语、引用类型、出口等）或几个例子将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-28T01:15:11.267

即使答案太晚了，我在谷歌搜索同一问题时发现了这个问题，并且还发现了苹果的这篇文章，它完美地解释了整个事情。

希望对正在研究相同事物的人有所帮助，

[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/EncapsulatingData/EncapsulatingData.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T19:33:38.290

从我最近的一堂课上讲（受保罗·赫加蒂的启发）

nonatomic - 不是线程安全的，请参阅Justin在上面的评论中[指出的链接。](https://stackoverflow.com/questions/588866/atomic-vs-nonatomic-properties)

强（或保留） - 保持分配此对象，直到我不再指向它（将其设置为 nil）。如果我不再被强烈指出（我得到了dealloc'd），编译器也会把它从堆中抛出（释放它）

弱 - 只要有东西仍然强烈指向它，就保持分配这个对象。IBOutlets 通常被声明为weak，因为它们会被视图控制器自动保留。

原始类型不在堆上分配，也不使用强或弱

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T19:41:28.547

原子性与线程有关，对于新手来说是一个相当高级的话题。然而，简短的回答是 iOS 属性总是被声明为非原子的。这是有关它的一些[更详细的信息](https://stackoverflow.com/questions/588866/atomic-vs-nonatomic-properties)。

弱/强关键字与 ARC 的内存管理和防止所谓的保留循环有关。对于新手来说，这也可能是一个艰难的概念，但高级概述是，当两个对象彼此具有强引用时会发生保留循环，因此两个对象都不会被 ARC 销毁。这是内存泄漏的一种形式，因为您可能有一个不再使用但仍在占用内存的对象。通过将属性声明为弱，它将确保它不会被自动销毁，只要某些东西仍然具有对其的强引用。例如，假设您有一个数组，其中包含几个对象。其中两个对象具有相互强引用。然后，该数组失去其所有者并被销毁。但，该数组中相互指向的两个对象不会被破坏，因为它们具有强引用。因此，您有两个无法访问的对象，因为拥有的数组已被破坏，但它们仍在占用内存。

# excel - 根据字段值将 Access/Excel 表拆分为多个 Excel 工作表

> ID：12080068
> 
> 赞同：0
> 
> 时间：2012-08-22T19:25:16.143
> 
> 标签：excel, ms-access, export, field

我有一个表格，根据它们来自的文档对值集进行分组。该表目前在 Excel 中，但如果从那里更容易的话，可以很容易地将其导入 Access。

```
doc value1  value2  value3
foo 29037   1098273 1023978
foo 1029387 109178  10918
bar 102893  101982  102907
biz 1023894 1908237 1023894
bar 102734  997124  834347 
```

将这些值导出到三个不同的 Excel 工作簿（foo.xlsx、bar.xlsx 和 biz.xlsx）中的最简单方法是什么，以及原始表中的列标题和值？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:29:11.143

您可以将 ADO 与 Excel ( [http://support.microsoft.com/kb/257819 ) 一起使用，但使用 Access、](http://support.microsoft.com/kb/257819) [DoCmd.TransferSpreadsheet](http://msdn.microsoft.com/en-us/library/office/aa164087%28v=office.10%29.aspx)和查询确实非常简单。

```
SELECT * FROM MyTable WHERE Doc='Foo' 
```

# sql - 根据两列标准选择记录

> ID：12080074
> 
> 赞同：2
> 
> 时间：2012-08-22T19:26:01.033
> 
> 标签：sql, sql-server-2005

我想做一个 SQL 查询以从下表中进行选择：

```
id    type    num
1     a       3
1     b       4
2     a       5
2     c       6 
```

如果它们具有相同的“id”并且类型为“a 或 b”，那么结果将如下所示：

```
id    type    num
1     a       3
1     b       4 
```

有人知道如何实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:39:55.903

```
SELECT table1.* 
FROM table1,
(
  SELECT COUNT(*) as cnt, id
  FROM (
    SELECT * 
    FROM table1
    WHERE type = 'a' OR type = 'b'
  ) sub1
  GROUP BY id
  HAVING cnt > 1
)sub2
WHERE table1.id = sub2.id 
```

在这里测试：[http](http://sqlfiddle.com/#!2/4a031/1) ://sqlfiddle.com/#!2/4a031/1似乎工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:53:33.080

方法一：

```
select a.*
from some_table t
join some_table a on a.id = t.id and a.type = 'a'
join some_table b on b.id = t.id and b.type = 'b' 
```

方法二：

```
select *
from some_table t
where exists ( select *
               from some_table x
               where x.id   = t.id
                 and x.type = 'a'
             )
  and exists ( select *
               from some_table x
               where x.id   = t.id
                 and x.type = 'b'
             ) 
```

第一种技术提供了结果集中重复行的可能性，具体取决于 id 和 type 的基数。后者保证提供表的适当子集。

假设您在表上定义了合理的索引，则任一查询都应该提供相当等效的性能。

# jsf - 如何配置 Myfaces 通过 logback 登录

> ID：12080077
> 
> 赞同：1
> 
> 时间：2012-08-22T19:26:10.690
> 
> 标签：jsf, logging, jsf-2, myfaces

如何配置 Myfaces 以通过我的应用程序其余部分使用的 logback 实现写入日志？目前，我正在从我的应用程序的所有部分写入日志，除了 Myfaces 在日志文件中的消息。

即使在 netbeans 控制台中，我也可以找到来自 Myfaces 的消息。

* * *

将 Myfaces 2.1.8 与 Glassfish 3.1 (Netbeans) 一起使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T19:25:17.757

Myfaces 可能正在登录到 JUL。因此，您可能需要使用`jul-to-slf4j`将所有日志记录重定向到 SLF4J。

查看[此](https://stackoverflow.com/questions/8012595/tomcat-logging-with-slf4j-and-log4j)以了解如何修复。

# lucene - Lucene - 锁定获取超时：SimpleFSLock on fast requests

> ID：12080081
> 
> 赞同：1
> 
> 时间：2012-08-22T19:26:22.310
> 
> 标签：lucene, httpmodule

我有一个`httpmodule`将对该站点的每次访问记录到一个 lucene 索引中。该站点托管在godaddy上，即使我在页面上几乎没有任何东西我进行测试（大约3kb，包括css），它运行缓慢。

如果我尝试刷新几次，在第二次或第三次刷新后我会`Lock obtain timed out: SimpleFSLock`出错。

我的问题是，我做错了什么吗？还是这是正常行为？有没有办法克服这个问题？

我的代码：

```
 //state the file location of the index
        string indexFileLocation = System.IO.Path.Combine(HttpContext.Current.ApplicationInstance.Server.MapPath("~/App_Data"), "Analytics");
        Lucene.Net.Store.Directory dir = Lucene.Net.Store.FSDirectory.GetDirectory(indexFileLocation, false);

        //create an analyzer to process the text
        Lucene.Net.Analysis.Analyzer analyzer = new Lucene.Net.Analysis.Standard.StandardAnalyzer();

        //create the index writer with the directory and analyzer defined.
        Lucene.Net.Index.IndexWriter indexWriter = new Lucene.Net.Index.IndexWriter(dir, analyzer, false);

        //create a document, add in a single field
        Lucene.Net.Documents.Document doc = new Lucene.Net.Documents.Document();
        doc.Add(new Lucene.Net.Documents.Field("TimeStamp", DateTime.Now.ToString(), Lucene.Net.Documents.Field.Store.YES, Lucene.Net.Documents.Field.Index.NOT_ANALYZED, Lucene.Net.Documents.Field.TermVector.NO));
        doc.Add(new Lucene.Net.Documents.Field("IP", request.UserHostAddress.ToString(), Lucene.Net.Documents.Field.Store.YES, Lucene.Net.Documents.Field.Index.NOT_ANALYZED, Lucene.Net.Documents.Field.TermVector.NO));

        //write the document to the index
        indexWriter.AddDocument(doc);

        //optimize and close the writer
        //indexWriter.Optimize();
        indexWriter.Close(); 
```

# android - 检查透明度是否存在并仅加载 RGB 值

> ID：12080083
> 
> 赞同：1
> 
> 时间：2012-08-22T19:26:36.600
> 
> 标签：android, bitmap, rgb, alpha-transparency

为了尽量减少位图的内存使用，但仍然尽量提高它们的质量，我想问一个简单的问题：

有没有办法让我`.png`使用 API 检查给定的图像文件（文件）是否具有透明度，而不检查其中的每个像素？

如果图像没有任何透明度，最好使用仅使用 RGB 值的不同位图格式。

问题是 Android 也没有仅适用于 3 种颜色的格式。只有 RGB_565，他们说这会降低图像质量，应该启用抖动功能。

还有一种方法可以只读取 RGB 值并能够显示它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-02T12:00:13.790

对我来说`bitmap.hasAlpha()`，首先检查位图是否具有 alpha 值可以正常工作。之后，您必须遍历像素并创建第二个没有 alpha 的位图，我建议您这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T21:32:44.337

让我们开始一点题外话

> 问题是 android 也没有仅适用于 3 种颜色的格式。只有 RGB_565 ，他们说这会降低图像质量并且应该启用抖动功能。

这个问题的原因并不是真正的 Android 特定的。这是关于绘制图像时的性能。如果像素数据完全适合 1 个 32 位存储单元，您将获得最佳性能。

所以最明显的好像素格式是`ARGB_8888`正好使用 32 位的格式（24 表示颜色 8 表示 alpha）。绘图时，您无需执行任何操作，只需遍历图像数据，您读取的每个单元格都可以直接绘制。唯一的缺点是处理此类图像所需的内存，无论是当它们只是放在内存中还是在显示它们时，因为图形硬件必须传输更多数据。

第二个最佳选择是使用几个像素适合 1 个单元格的格式。在 32 位中使用 2 个像素，每像素剩下 16 位，使用 16 位的格式之一是 565 格式。5位红色，6位绿色，5位蓝色。绘制此图时，您仍然可以单独处理存储单元，您所要做的就是将 1 个单元分成几部分。由于图像所需的内存较小，绘图有时甚至比使用 32 位颜色更快。由于在开始时 android 内存是一个更大的问题，他们选择这种格式作为默认格式。

最糟糕的格式类别是像素不适合这些单元格的格式。如果您只采用 3 种颜色，您将获得 24 位，并且这些颜色需要在 4 种情况下的 3 种情况下分布在 2 个单元上。例如，第二个像素将使用第一个单元的剩余 8 位和下一个单元的前 16 位。使用 24 位颜色所需的额外工作量很大，以至于无法使用。并且在绘制图像时，您通常在某些时候通常都有 alpha，如果没有，您只需使用 32 位，但忽略 alpha 位。

所以 16 位方法看起来很难看，而 24 位方法没有意义。而且由于 Android 的内存限制不像以前那么严格并且硬件变得更快，Android 已将其默认设置为 32 位（在[http://www.curious-creature.org/2010/12/中有更详细的解释） 08/bitmap-quality-banding-and-dithering/](http://www.curious-creature.org/2010/12/08/bitmap-quality-banding-and-dithering/) )

* * *

回到你真正的问题

> 有没有办法让我使用 API 检查给定的图像文件（png 文件）是否具有透明度，而不检查其中的每个像素？

我不知道。但是 JPEG 图像不支持 alpha，而 PNG 图像通常具有 alpha。在大多数情况下，您可以简单地滥用文件扩展名来使其正确。

但我建议您不要打扰所有这些，只需使用`ARGB_8888`和应用 Android 培训文档中关于[有效显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)的详细介绍的漂亮图像加载技术。

人们遇到内存问题的原因通常是他们在内存中加载的图像比他们当前显示的要多得多，或者他们使用无法在手机的小屏幕上显示的巨大图像。在我看来，添加良好的内存管理比使代码复杂化以降低图像质量更有意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-09T08:11:03.733

有一种方法可以检查 PNG 文件是否具有透明度，或者至少是否支持它：

```
public final static int COLOR_GREY = 0;
public final static int COLOR_TRUE = 2;
public final static int COLOR_INDEX = 3;
public final static int COLOR_GREY_ALPHA = 4;
public final static int COLOR_TRUE_ALPHA = 6;
private final static int DECODE_BUFFER_SIZE = 16 * 1024;
private final static int HEADER_DECODE_BUFFER_SIZE = 1024;

/** given an inputStream of a png file , returns true iff found that it has transparency (in its header) */
private static boolean isPngInputStreamContainTransparency(final InputStream pngInputStream) {
    try {
        // skip: png signature,header chunk declaration,width,height,bitDepth :
        pngInputStream.skip(12 + 4 + 4 + 4 + 1);
        final byte colorType = (byte) pngInputStream.read();
        switch (colorType) {
        case COLOR_GREY_ALPHA:
        case COLOR_TRUE_ALPHA:
            return true;
        case COLOR_INDEX:
        case COLOR_GREY:
        case COLOR_TRUE:
            return false;
        }
        return true;
    } catch (final Exception e) {
    }
    return false;
} 
```

除此之外，我不知道这样的事情是否可能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T10:36:30.130

我发现下一个链接可能有助于检查 png 文件是否具有透明度。可悲的是，它仅适用于 png 文件。其余文件（如 webP、bmp、...）需要有不同的 parser 。

链接：

[http://www.java2s.com/Code/Java/2D-Graphics-GUI/PNGDecoder.htm](http://www.java2s.com/Code/Java/2D-Graphics-GUI/PNGDecoder.htm)

[http://hg.l33tlabs.org/twl/file/tip/src/de/matthiasmann/twl/utils/PNGDecoder.java](http://hg.l33tlabs.org/twl/file/tip/src/de/matthiasmann/twl/utils/PNGDecoder.java)

[http://www.java-gaming.org/index.php/topic,24202](http://www.java-gaming.org/index.php/topic,24202)

# java - 如何在一个读/写线程和一个只读线程之间同步映射？

> ID：12080086
> 
> 赞同：6
> 
> 时间：2012-08-22T19:26:49.153
> 
> 标签：java, multithreading, data-structures, map, synchronized

我有一个`Collections.synchronizedMap()`由线程 A 读取和更新的同步映射（通过）。线程 B 仅通过`Map.keySet()`（只读）访问映射。

我应该如何同步这个？[文档说](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Collections.html#synchronizedMap%28java.util.Map%29)keySet() （对于Collections.synchronizedMap）“不需要在同步块中”。我可以将线程 A 的读/写访问权限放在同步块中，但这甚至有必要吗？

如果 Map.keySet 不需要同步（根据上面的文档链接），我想我什至使用同步 Map 或同步块似乎很奇怪......

**更新：**我错过了 keySet 的迭代必须同步，即使检索 keySet 不需要同步。拥有 keySet 而无法查看它并不是特别令人兴奋，因此最终结果 = 需要同步。改用 ConcurrentHashMap。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:31:03.230

要制作一个真正的读/写与只读/只读锁定`Map`包装器，您可以查看包装器的`Collections`用途`synchronizedMap()`并将所有`synchronized`语句替换为`ReentrantReadWriteLock`. 这是一项很好的工作。相反，您应该考虑切换到使用 a [`ConcurrentHashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)which 做所有正确的事情。

就 而言`keySet()`，它不需要在一个`synchronized`块中，因为它已经`synchronized`在`Collections.synchronizedMap()`. Javadocs 只是指出，如果您正在遍历地图，则需要在其上进行同步，因为您正在执行多个操作，但是当您获取`keySet()`包装在`SynchronizedSet`执行它的类中时不需要同步自己的同步。

最后，您的问题似乎暗示如果您只是从中读取内容，则不需要同步某些内容。您必须记住，同步不仅可以防止竞争条件，还可以确保每个处理器正确共享数据。即使您`Map`以只读方式访问 a，如果任何其他线程正在更新它，您仍然需要对其进行同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T19:31:48.083

文档告诉您如何正确同步需要原子的多步操作，在这种情况下迭代地图：

```
Map m = Collections.synchronizedMap(new HashMap());
      ...
Set s = m.keySet();  // Needn't be in synchronized block
      ...
synchronized(m) {  // Synchronizing on m, not s!
    Iterator i = s.iterator(); // Must be in synchronized block
    while (i.hasNext())
        foo(i.next());
} 
```

请注意*实际迭代*必须如何在同步块中。文档只是说，如果在同步块中*获得*并不重要`keySet()`，因为*它*是`Map`. 如果映射中的键在对正在获取的键集的引用和同步块的开始之间发生变化，则键集将反映这些变化。

顺便说一句，您引用的文档仅适用`Map`于由`Collections.synchronizedMap`. 该声明*不一定*适用于所有`Map`s。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T19:37:08.923

文档是正确的。从返回的映射`Collections.synchronizedMap()`将正确包装同步发送到原始的所有调用`Map`。但是，keySet() 返回的集合 impl 不具有相同的属性，因此您必须确保在同一锁下读取它。

如果没有这种同步，就不能保证线程 B 会看到线程 A 所做的任何更新。

您可能想要调查`ConcurrentHashMap`. 它为这个用例提供了有用的语义。[在 CHM ( like`keySet()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html#keySet%28%29) )中迭代集合视图会提供有用的并发行为（“弱一致”迭代器）。您将在迭代时遍历集合状态中的所有键，并且您可能会或可能不会在迭代器创建后看到更改。

# javascript - 如何使用 jasmine 测试完成和失败的延迟对象

> ID：12080087
> 
> 赞同：28
> 
> 时间：2012-08-22T19:26:50.073
> 
> 标签：javascript, jquery, post, jasmine

这是关于 javascript 提交请求的代码 (1)。
这是关于使用 jasmine (2) 模拟 ajax 请求的测试。

我想模拟服务器行为。有任何想法吗？
有关详细信息，请参阅 (1) 和 (2) 中的注释。

PS：
实际上在这两种情况下，fakeFunction 的 done 和 fail 延迟对象都被调用。

* * *

(1)

```
submitForm: function () {
     // the server execute fail only if message.val() is empty
     // and I would like to mock this behaviour in (2)
     backendController.submitForm(message.val()).done(this.onSuccess).fail(this.onError);
},

backendController.submitForm = function (message) {
    return $.ajax({
        url: 'some url',
        type: 'POST',
        dataType: 'json',
        data: {
            message: message
        }
    }).done(function () {
        //some code;
    });
}; 
```

* * *

(2)

```
describe('When Submit button handler fired', function () {
    var submitFormSpy,
        fakeFunction = function () {
            this.done = function () {
                return this;
            };
            this.fail = function () {
                return this;
            };
            return this;
        };

    beforeEach(function () {
        submitFormSpy = spyOn(backendController, 'submitForm').andCallFake(fakeFunction);
    });

    describe('if the message is empty', function () {
        beforeEach(function () {
            this.view.$el.find('#message').text('');
            this.view.$el.find('form').submit();
        });
        it('backendController.submitForm and fail Deferred Object should be called', function () {
            expect(submitFormSpy).toHaveBeenCalled();
            // how should I test that fail Deferred Object is called?
        });
    });

    describe('if the message is not empty', function () {
        beforeEach(function () {
            this.view.$el.find('#message').text('some text');
            this.view.$el.find('form').submit();
        });
        it('backendController.submitForm should be called and the fail Deferred Object should be not called', function () {
            expect(submitFormSpy).toHaveBeenCalled();
            // how should I test that fail Deferred Object is not called?
        });
    });

}); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-15T07:27:25.857

We actually ran into the same problem, trying to test Deferred objects that represent AJAXed template scripts for on-the-fly templating. Our testing solution involves using the [Jasmine-Ajax](https://github.com/pivotal/jasmine-ajax) library in conjunction with Jasmine itself.

So probably it will be something like this:

```
describe('When Submit button handler fired', function () {
  jasmine.Ajax.useMock();

  describe('if the message is empty', function () {

    beforeEach(function() {
      spyOn(backendController, 'submitForm').andCallThrough();
      // replace with wherever your callbacks are defined
      spyOn(this, 'onSuccess');
      spyOn(this, 'onFailure');
      this.view.$el.find('#message').text('');
      this.view.$el.find('form').submit();
    });

    it('backendController.submitForm and fail Deferred Object should be called', function () {
      expect(backendController.submitForm).toHaveBeenCalledWith('');
      mostRecentAjaxRequest().response({
        status: 500, // or whatever response code you want
        responseText: ''
      });

      expect( this.onSuccess ).not.toHaveBeenCalled();
      expect( this.onFailure ).toHaveBeenCalled();
    });
}); 
```

Another thing, if you can, try to break up the functionality so you're not testing the entire DOM-to-response-callback path in one test. If you're granular enough, you can actually test asynchronous Deferred resolutions by using Deferred objects themselves inside your tests!

The key is to actually use Deferred objects within your tests themselves, so that the scope of the `expect` call is still within your `it` function block.

```
describe('loadTemplate', function() {
  it('passes back the response text', function() {
    jasmine.Ajax.mock();
    loadTemplate('template-request').done(function(response) {
      expect(response).toBe('foobar');
    });
    mostRecentAjaxRequest().response({ status:200, responseText:'foobar' });
  });
}); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-13T04:54:50.767

Here is how I managed to do it.

Essentially, the $.ajax object returns a Deferred object, so you can spy on $.ajax and return a Deferred and then trigger it manually to run the .done() code in your JavaScript

Code

```
Index.prototype.sendPositions = function() {
  var me = this;
  $.ajax({
    ...
  }).done(function(data, textStatus, jqXHR) {
    me.reload();
  }).fail(function(jqXHR, textStatus, errorThrown) {
    console.log(errorThrown);
  });
}; 
```

Test

```
it("should reload the page after a successful ajax call", function(){
  var deferred = new jQuery.Deferred();
  spyOn($, 'ajax').andReturn(deferred);
  spyOn(indexPage, 'reload');
  indexPage.sendPositions();
  deferred.resolve('test');
  expect(indexPage.reload).toHaveBeenCalled();
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T09:31:01.840

如果您有一个带有 ajax 请求承诺对象的 var，那么测试起来会容易得多。在这种情况下，您可以这样做：

```
 it('should do an async thing', function() {     
   var mutex = 1;
   var promF = jasmine.createSpy('prF');

   runs( function() {
     var promise1 = $.ajax();
     promise1.always(function(){
       mutex--;
     });
     promise1.fail(function(){
       promF();
     });
   });

   waitsFor(function(){
     return !mutex;
   }, 'Fetch should end', 10000);

   runs( function() {
      expect(promF).toHaveBeenCalled();
   });
 }); 
```

下面我发布了可能适合您的未经测试的代码。我想 ajax 调用是从 .submit() 类初始化的？也许您应该从 runs() 块而不是从 beforeEach() 初始化 ajax 请求，但您应该尝试哪一个有效。

```
describe('When Submit button handler fired and city is defined', function () {
    var ajaxRequestSpy,
        failSpy, successSpy, alwaysSpy,
        mutex;
    beforeEach(function () {
        ajaxRequestSpy = spyOn(backendController, 'ajaxRequest').andCallThrough();
        failSpy = spyOn(ajaxRequestSpy(), 'fail').andCallThrough()
        successSpy = spyOn(ajaxRequestSpy(), 'success').andCallThrough();
        mutex = 1; // num of expected ajax queries
        alwaysSpy =  spyOn(ajaxRequestSpy(), 'always').andCallFake(function() {
             mutex--;
        });
        this.view = new MyView({
            el: $('<div><form>' +
                '<input type="submit" value="Submit" />' +
                '<input type="text" name="city">' +
                '</form></div>')
        });
        this.view.$el.find('form').submit();
    });
    it('backendController.ajaxRequest should be called', function () {
        runs( function() {
            // maybe init ajax here ?   
        });

        waitsFor( function() {
            return !mutex;
        }, 'ajax request should happen', 5000);

        runs( function() {
            expect(ajaxRequestSpy).toHaveBeenCalled(); // true
            expect(failSpy).toHaveBeenCalled(); // Error: Expected spy fail 
                                            // to have been called.
        });

    });
}); 
```

But, I am not sure that the line

```
failSpy = spyOn(ajaxRequestSpy(), 'fail').andCallThrough(); 
```

does what you want. Is it possible to spy on another spy? And if yes why are you calling the spy ? Maybe you should try

```
failSpy = spyOn(ajaxRequestSpy, 'fail').andCallThrough(); 
```

# javascript - 用自定义 javascript 全局命名空间替换窗口

> ID：12080090
> 
> 赞同：0
> 
> 时间：2012-08-22T19:26:56.110
> 
> 标签：javascript, namespaces, global-variables

我有一个 javascript 函数，可以为游戏初始化一堆全局变量。

```
 function buildVariables(fs,fm) {
     window.p1HPStart = fm.p1hp;
     window.p2HPStart = fm.p2hp;
     window.p1HP = 100;
     window.p2HP = 100;
     window.trn = 0;
  } 
```

现在所有这些 javascript 都在同一个 HTML 文件中。我想将它移动到它自己的 .js 文件中，并将它包含在这个 HTML 文件中。我还想用不同的全局命名空间（如fight.p1HP）替换“窗口”。

我怎样才能做到这一点？

我在其他类似问题中看到了像下面这样的代码作为建议的答案，但我不太明白如何使用它来替换 window.

```
 var cartTotaler = (function () {
     var total = 0; tax = 0.05;

      // other code

      return {
         addItem : function (item) { },
         removeItem : function (item) { },
         calculateTitle : function () { }
     };
 }()); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:29:20.213

```
// initialize your own global object
if (!window.mySpace) {
    window.mySpace = {};
}

// then use it
function buildVariables(fs,fm) {
     mySpace.p1HPStart = fm.p1hp;
     mySpace.p2HPStart = fm.p2hp;
     mySpace.p1HP = 100;
     mySpace.p2HP = 100;
     mySpace.trn = 0;
  } 
```

然后只需确保在任何地方都需要自己的变量之一，在它前面使用命名空间：

```
mySpace.variableName 
```

注意：这并没有真正“替换”`window`对象（因为没有办法这样做） - 它只是将所有全局变量放入一个主全局对象中，而不是用每个变量污染全局命名空间。

名称`mySpace`可以是您想要的任何名称。通常，它应该是您的应用程序独有的东西，不太可能与任何其他 javascript 或库可能使用的东西发生冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:30:25.727

```
(function(global){
     global.p1HPStart = fm.p1hp;
     global.p2HPStart = fm.p2hp;
     global.p1HP = 100;
     global.p2HP = 100;
     global.trn = 0;
}(window)); 
```

这将创建一个“立即调用的函数表达式”。`window`被传递到函数中，然后将许多属性附加到它。

您可以更改`window`为您想要的任何对象，例如`fight.p1HP`，此函数将立即将列出的属性附加到该对象。

# java - 字符编码问题

> ID：12080095
> 
> 赞同：0
> 
> 时间：2012-08-22T19:27:34.723
> 
> 标签：java, character-encoding

我的代码是：ISO-8859-1 中的默认字符编码

```
BufferedReader bis = new BufferedReader(new InputStreamReader(new FileInputStream("somefile in unicode character"), "UTF-8"));
String str = bis.readLine();
bis.close();

PrintStream ps1 = new PrintStream(System.out, true, "UTF-8");
ps1.println(str); 
```

输出应该是文件的 unicode 字符，但没有得到。

# javascript - 使用 javascript onchange 的下拉菜单

> ID：12080098
> 
> 赞同：23
> 
> 时间：2012-08-22T19:27:42.267
> 
> 标签：javascript, onchange

我有一个简单的下拉菜单，我想拥有它，以便如果用户选择有一个婴儿，消息将更改为有一个婴儿，但对于任何其他选择。消息保持不变（什么都没有），但这不起作用。有人可以帮忙吗。请玩我的 jsfiddle。

[http://jsfiddle.net/Z9YJR/](http://jsfiddle.net/Z9YJR/) 这是html

```
<select id="leave">
  <option value="5">Get Married</option>
  <option onchange="changeMessage()" value="100">Have a Baby</option>
  <option value="90">Adopt a Child</option>
  <option value="15">Retire</option>
  <option value="15">Military Leave</option>
  <option value="15">Medical Leave</option>
</select>

<div id="message"></div> 
```

这是js

```
function changeMessage() {
    document.getElementById("message").innerHTML = "Having a Baby!!";
} 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-22T19:31:47.543

像这样的东西应该可以解决问题

```
<select id="leave" onchange="leaveChange()">
  <option value="5">Get Married</option>
  <option value="100">Have a Baby</option>
  <option value="90">Adopt a Child</option>
  <option value="15">Retire</option>
  <option value="15">Military Leave</option>
  <option value="15">Medical Leave</option>
</select>

<div id="message"></div> 
```

**Javascript**

```
function leaveChange() {
    if (document.getElementById("leave").value != "100"){
        document.getElementById("message").innerHTML = "Common message";
    }     
    else{
        document.getElementById("message").innerHTML = "Having a Baby!!";
    }        
} 
```

[jsFiddle 演示](http://jsfiddle.net/Wf3g2/)

更短的版本和更通用的可能是

**HTML**

```
<select id="leave" onchange="leaveChange(this)">
  <option value="5">Get Married</option>
  <option value="100">Have a Baby</option>
  <option value="90">Adopt a Child</option>
  <option value="15">Retire</option>
  <option value="15">Military Leave</option>
  <option value="15">Medical Leave</option>
</select> 
```

**Javascript**

```
function leaveChange(control) {
    var msg = control.value == "100" ? "Having a Baby!!" : "Common message";
    document.getElementById("message").innerHTML = msg;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T19:40:36.510

它不起作用，因为您在 JSFiddle 中的脚本在它自己的范围内运行（请参阅左侧的“OnLoad”下拉菜单？）。

解决此问题的一种方法是在 javascript 中绑定您的事件处理程序（它应该在哪里）：

```
document.getElementById('optionID').onchange = function () {
    document.getElementById("message").innerHTML = "Having a Baby!!";
}; 
```

另一种方法是修改小提琴环境的代码并显式声明您的函数为全局函数，以便您的内联事件处理程序可以找到它：

```
window.changeMessage() {
    document.getElementById("message").innerHTML = "Having a Baby!!";
}; 
```

​</p>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-15T12:50:19.600

简单的

```
<script>
jQuery.noConflict()(document).ready(function() {
    $('#hide').css('display','none');
    $('#plano').change(function(){

        if(document.getElementById('plano').value == 1){
            $('#hide').show('slow');    

        }else 
            if(document.getElementById('plano').value == 0){

             $('#hide').hide('slow'); 
        }else
            if(document.getElementById('plano').value == 0){
             $('#hide').css('display','none');  

            }

    });
    $('#plano').change();
});
</script> 
```

如果在组合框中选择某些特定值，此示例将显示和隐藏 div

# php - 获取文本和语言环境

> ID：12080099
> 
> 赞同：1
> 
> 时间：2012-08-22T19:27:46.893
> 
> 标签：php, locale, gettext

我似乎无法正确理解它。

我有这个代码：

```
putenv('LC_ALL=eng_US.UTF-8');
var_dump(setlocale(LC_ALL, 'eng_US.UTF-8', 'eng_US')); 
```

Windows 上的输出

```
string 'English_United States.1252' (length=26) 
```

Linux 上的输出

```
bool(false) 
```

Linux 适用于 en_US，但不适用于 Windows。Windows 会查看文件夹 eng_US 和 Linux en_US。

有没有人找到解决方案？或者有没有办法放置一个无论操作系统如何都会考虑的自定义字符串？

（我必须补充一下，我在 Windows-7 上使用 WAMP，而 Linux 机器是带有 nginx + php-fpm 的 CentOS）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:43:51.613

语言环境名称取决于平台。

在您想要的大多数 unix 系统上`<two letter language code>_<two letter country code>[.<optional encoding>]`。您可以使用命令行`locale -a`列出有效的语言环境名称。

正确的 Windows 语言环境使用相同的 X_X[.X] 方案，只是它们使用语言和国家的全名，并且它们使用代码页号而不是编码名称：`English_United States.1252`. Windows 似乎也有一些用于找出其他字符串的启发式方法，尽管它似乎并没有像 Unix 风格的语言环境名称那样工作。此外，无论您使用名称“UTF-8”还是使用代码页号“65001”指定它，Windows 都不支持将 UTF-8 作为语言环境编码。

正如您所发现的那样，Windows 和其他平台的语言环境名称是不同的。您不能对所有平台使用相同的字符串。相反，您必须编写使用当前平台的正确字符串的代码。

```
if Linux
    return "en_US.UTF-8"
if Windows
    return "English_United States.1252" 
```

# html - CSS正文：第一个孩子

> ID：12080101
> 
> 赞同：9
> 
> 时间：2012-08-22T19:28:04.933
> 
> 标签：html, css, css-selectors

有人可以向我解释为什么这不起作用吗？

```
<html>
 <head>
  <style>
   body:first-child
   {
      color:#f00;
   }
  </style>
 </head>
 <body>
  <div>I should be red.</div>
  <div>This is not red.</div>
 </body>
</html> 
```

根据我的阅读，第一个子选择器应该从 body 标记中选择第一个 div 对象。如果它没有选择 div 元素，它在选择什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-22T19:33:39.287

[`:first-child`](http://www.w3.org/TR/css3-selectors/#first-child-pseudo)伪类在body`body:first-child`标签上操作，所以它的 body 标签是它的父母的第一个孩子，如果你想要`body`第一个孩子使用[孩子选择器](http://www.w3.org/TR/css3-selectors/#child-combinators)

```
body > :first-child{
    color:#f00;
} 
```

这会给你身体的第一个孩子。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-22T19:30:34.690

要定位第一个 div，您需要执行`body div:first-child`. 现在（我假设）你只是在选择第一个孩子的身体。（其实我不完全确定你现在选择的是*什么*，想想看。我不认为`first-child`选择器直接挂在body标签上是有效的。）

```
body div:first-child {
    color:#f00;
}​ 
```

这个 CSS 会按照你的预期为它着色。将其读作“body 的第一个孩子的 div”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T19:35:07.077

您的 CSS 说选择任何 BODY 元素，它是其父元素的第一个子元素，该子元素将是 HTML 元素。BUt HEAD 是第一个孩子，而不是 BODY。

至少我认为这是正确的:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-06T12:05:17.180

要针对你们中的第一个`div`可以`body`使用这个，

```
body div:first-of-type {
   /* style */
} 
```

# java - 我不能做我的工作事件 - JSF - 异常说在类型 BotaoBean 上找不到属性“sorteiaBotao”

> ID：12080102
> 
> 赞同：2
> 
> 时间：2012-08-22T19:28:07.880
> 
> 标签：java, events, jsf

这是我的代码：botoes.xhtml

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h=" http://java.sun.com/jsf/html"
    xmlns:f=" http://java.sun.com/jsf/core">

<h:head>
    <title>K19 - Eventos</title>
</h:head>

<h:body>
    <h:form>
        <h:commandButton id="botao-jonas" value="Jonas" disabled="false" actionListener="#{BotaoBean.sorteiaBotao}" />
        <h:commandButton id="botao-marcelo" value="Marcelo" disabled="true" actionListener="#{BotaoBean.sorteiaBotao}" />
        <h:commandButton id="botao-rafael" value="Rafael" disabled="true" actionListener="#{BotaoBean.sorteiaBotao}" />
    </h:form>
</h:body>
</html> 
```

和 BotaoBean.java：

```
import javax.faces.bean.ManagedBean;
import javax.faces.component.*;
import javax.faces.event.ActionEvent;

@ManagedBean(name="BotaoBean")
public class BotaoBean {

    public void sorteiaBotao(ActionEvent event) {
        UIComponent formulario = event.getComponent().getParent();

        UIComponent botaoJonas = formulario.findComponent("botao-jonas");
        UIComponent botaoMarcelo = formulario.findComponent("botao-marcelo");
        UIComponent botaoRafael = formulario.findComponent("botao-rafael");

        botaoJonas.getAttributes().put("disabled",true);
        botaoMarcelo.getAttributes().put("disabled",true);
        botaoRafael.getAttributes().put("disabled",true);

        double numero = Math.random();

        if (numero<1.0/3.0) {
            botaoJonas.getAttributes().put("disabled",false);
        } else if (numero<2.0/3.0) {
            botaoMarcelo.getAttributes().put("disabled",false);
        } else {
            botaoRafael.getAttributes().put("disabled",false);
        }
    }    
} 
```

我运行并给出以下异常：

> javax.servlet.ServletException：/botoes.xhtml：在类型 BotaoBean javax.faces.webapp.FacesServlet.service（FacesServlet.java:321）上找不到属性“sorteiaBotao”

我不知道怎么解决。我做了与教程示例相同的操作。谁能帮我？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:03:37.350

异常表明`actionListener="#{BotaoBean.sorteiaBotao}"`被视为值表达式而不是方法表达式（它正在寻找一个属性，因此它试图只打印一个getter返回的值，这显然根本不存在；正如异常所说）。

这反过来表明 JSF 渲染器无法识别整个组件和属性。

这反过来表明`h:`组件的标签库没有（正确地）被声明。

事实上，你在 taglib URI 中有一个悬空的空间：

```
xmlns:h=" http://java.sun.com/jsf/html" 
```

该空间不属于 taglib URI 中。相应地修复它：

```
xmlns:h="http://java.sun.com/jsf/html" 
```

不要忘记对`f:`标签库做同样的事情，它的 URI 中也有一个错位的空格。

# safari - Google Analytics 指的是哪个 Safari 版本？

> ID：12080112
> 
> 赞同：4
> 
> 时间：2012-08-22T19:29:08.370
> 
> 标签：safari, google-analytics, mobile-safari

由于[这个问题](https://stackoverflow.com/questions/7132845/which-safari-version-corresponds-to-which-webkit-version)，我能够找到 Google Analytics 所指的大多数 Webkit（所有 3 位数 Webkit）的 Safari 版本。但是，有一些未在[Wikipedia 条目](http://en.wikipedia.org/wiki/Safari_version_history)中列出。

这是 Analytics 向我展示的快照。

**7534 和 6533 Webkit 指的是 Safari 的哪个版本/操作系统？**

```
1\.  7534.48.3   45.50%  
2\.  534.57.2    12.51%
3\.  534.55.3    8.44%
4\.  533.22.3    6.60%
5\.  534.52.7    4.96%
6\.  6533.18.5   4.95% 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T19:59:58.763

第一个数字对应于构建 webkit 的 OSX 版本。

6533.18.5 适用于 Mac OS X v10.6 “雪豹”

7534.48.3 适用于 Mac OS X v10.7 “Lion”

如果您有一个以 8 位和 4 位数字开头的设备，那就是 Mac OS X v10.8 "Mountain Lion"

等等

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T19:41:12.097

我认为 Google Analytics 在版本号前面添加了一个额外的数字。IMO`7534.48.3`指`534.48.3`和。`6533.18.5`_`533.18.5`

这两个版本分别是 Safari 5.1 和 5.0.2，这对于它们的市场份额来说是有意义的。

您可以尝试通过[Google Analytics Forum](https://productforums.google.com/forum/#!forum/analytics)联系他们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T22:48:01.880

如果你用谷歌搜索“safari 版本”加上这些数字之一，你会看到主版本号中有 4 位数字的 Safari 版本是 iOS 版本。见这里：[http](http://www.useragentstring.com/Safari5.0.2_id_18120.php) ://www.useragentstring.com/Safari5.0.2_id_18120.php 最好的，

# php - 基于另一个属性返回一个对象属性

> ID：12080114
> 
> 赞同：0
> 
> 时间：2012-08-22T19:29:12.047
> 
> 标签：php

我有一个对象 $obj，它是 json_encode 的结果，其结构类似于：

```
stdClass Object (
    [page] = 1
    [size] = -1
    [total] = 4
    [collection] = Array
        (
            [0] = stdClass Object
                (
                    [id] = 4e87de8e1a8840999f907fad
                    [description] = ffffffff
                    [code] = 82666
                    [status] = ACTIVE
                )

            [1] = stdClass Object
                (
                    [id] = 4e8b4b53fda5efeeec370e89
                    [description] = gggggggggg
                    [code] = 41874
                    [status] = ACTIVE
                )

            [2] = stdClass Object
                (
                    [id] = 4e8b4b5afda5efeeec370e8a
                    [description] = hhhhhhhhhhhhh
                    [code] = 15130
                    [status] = ACTIVE
                )

            [3] = stdClass Object
                (
                    [id] = 4e90a753e91a2713c95b56a0
                    [description] = jjjjjjjjjjjjjj
                    [code] = 323307
                    [status] = ACTIVE
                )

            [4] = stdClass Object
                (
                    [id] = 4e9e08da79597f0d3daba159
                    [description] = kkkkkkkkkkkkkk
                    [code] = 11310
                    [status] = ACTIVE
                )
        ) ) 
```

我有一个值 $code 并想在 $obj->collection 中搜索，将 $id = 设置为 code 属性等于 $code 值的对象的 id 属性。我现在用一个条件循环来检查每个的代码属性并设置 $id 如果为真，但我认为可能有一个命令我错过了由于对 OO PHP 相当不熟悉。

有什么办法可以改进吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:12:13.743

让我打开这个：`stdClass`与数组相比没有优势（除了它可能“看起来很酷”）。它实际上不是 OOP。要使用数组而不是`stdClass`es，`true`请将其作为第二个参数`json_decode()`：

```
json_decode($json_string, true); 
```

将返回一个数组。

* * *

除此之外，迭代和检查 $code 似乎是要走的路。没有 PHP 函数可以为您做到这一点（感谢上帝）。然而，数组具有能够被数组函数操作的明显优势（更不用说效率提升了）。

# ruby - 给定散列中的多个其他值，如何在散列数组中查找并返回散列值

> ID：12080115
> 
> 赞同：7
> 
> 时间：2012-08-22T19:29:17.873
> 
> 标签：ruby, arrays, hash

我有这个哈希数组：

```
results = [
   {"day"=>"2012-08-15", "name"=>"John", "calls"=>"5"},
   {"day"=>"2012-08-15", "name"=>"Bill", "calls"=>"8"},
   {"day"=>"2012-08-16", "name"=>"Bill", "calls"=>"11"},
] 
```

我如何搜索结果以找到比尔在 15 日打了多少电话？

在阅读“ [Ruby easy search for key-value pair in an hashes array](https://stackoverflow.com/questions/10584326/ruby-easy-search-for-key-value-pair-in-an-array-of-hashes) ”的答案后，我认为它可能涉及扩展以下 find 语句：

```
results.find { |h| h['day'] == '2012-08-15' }['calls'] 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-22T19:44:20.337

你在正确的轨道上！

```
results.find {|i| i["day"] == "2012-08-15" and i["name"] == "Bill"}["calls"]
# => "8" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:48:23.730

```
results.select { |h| h['day'] == '2012-08-15' && h['name'] == 'Bill' }
  .reduce(0) { |res,h| res += h['calls'].to_i } #=> 8 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:05:10.210

实际上，“减少”或“注入”专门用于这种精确操作（将可枚举的内容减少为单个值：

```
results.reduce(0) do |count, value|
  count + ( value["name"]=="Bill" && value["day"] == "2012-08-15" ? value["calls"].to_i : 0)
end 
```

不错的文章：“[理解 map 和 reduce](http://railspikes.com/2008/8/11/understanding-map-and-reduce) ”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T20:11:57.067

或者另一种可能的方式，但更糟糕的是，使用注入：

```
results.inject(0) { |number_of_calls, arr_element| arr_element['day'] == '2012-08-15' ? number_of_calls += 1 : number_of_calls += 0  } 
```

请注意，您必须在每次迭代中设置 number_of_calls，否则它将不起作用，例如这不起作用：

```
p results.inject(0) { |number_of_calls, arr_element| number_of_calls += 1 if arr_element['day'] == '2012-08-15'} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T19:44:00.443

一个非常笨拙的实现；）

```
def get_calls(hash,name,date) 
 hash.map{|result| result['calls'].to_i if result['day'] == date && result["name"] == name}.compact.reduce(:+)
end

date = "2012-08-15"
name = "Bill"

puts get_calls(results, name, date)
=> 8 
```

# jquery - jQuery检索hasClass上的索引

> ID：12080118
> 
> 赞同：3
> 
> 时间：2012-08-22T19:29:26.790
> 
> 标签：jquery

是否可以在 hasClass 的第一个实例上获取索引？

例如：

```
$(".class").children().hasClass('classname').index(); 
```

不幸的是，这不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:31:38.090

`.hasClass`返回一个布尔值，您可以将结果过滤`.children`到具有`classname`-class 的结果，然后获取索引：

```
$(".class").children(".classname").index(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:31:50.570

[`hasClass()`](http://api.jquery.com/hasClass/)返回一个布尔值，而不是一个 jQuery 对象；改用选择器[`children()`](http://api.jquery.com/children/)：

`$(".class").children(".classname").index()`.

# ldap - 我们如何将用户组从 Novell edirectory 导入到 liferay？

> ID：12080121
> 
> 赞同：1
> 
> 时间：2012-08-22T19:29:40.110
> 
> 标签：ldap, integration, liferay, novell

如何将用户组和用户从 Novel EDirectory 导入 liferay？

以下是 Novel eDirectory 设置详细信息：

```
Group :

   cn       group1
   member
                cn=user1,ou=ABCD,ou=ABC,o=AB
                cn=user2,ou=ABCD,ou=ABC,o=AB

    objectClass
                groupOfNames
                Top 
```

用户 1：

```
cn              user1
objectClass     inetOrgPerson
objectClass     ssDEFG
objectClass     abcUser
objectClass     organizationalPerson
objectClass     Person
objectClass     ndsLoginProperties
objectClass     Top
objectClass     DirXML-PasswordSyncStatusUser
objectClass     DirXML-ApplicationAttrs
sn              user1surname
groupMembership cn=group1,ou=DEFGH,ou=DEFG,ou=ABC,o=AB
groupMembership cn=group2,ou=COURSES,ou=ABC,o=AB
groupMembership cn=group3,ou=DEFGH,ou=DEFG,ou=ABC,o=AB
email                              test1@test.com 
```

用户 2：

```
cn              user2
objectClass     inetOrgPerson
objectClass     ssDEFG
objectClass     abcUser
objectClass     organizationalPerson
objectClass     Person
objectClass     ndsLoginProperties
objectClass     Top
objectClass     DirXML-PasswordSyncStatusUser
objectClass     DirXML-ApplicationAttrs
sn              user2surname
groupMembership cn=group1,ou=DEFGH,ou=DEFG,ou=ABC,o=AB
groupMembership cn=group2,ou=COURSES,ou=ABC,o=AB
groupMembership cn=group3,ou=DEFGH,ou=DEFG,ou=ABC,o=AB
email                              test2@test.com 
```

以下是 Liferay 控制面板设置

```
Base DN :               [code]ou=ABCD,ou=ABC,o=AB 
```

用户映射

```
Authentication Search Filter : (mail=@email_address@)
Import Search Filter : (&(objectClass=inetOrgPerson)(mail=*))
Screen Name   :cn
Password  :sn
Email Address :mail  
Full Name   :fullName
First Name  :givenName
Middle Name  
Last Name  : sn
Job Title  :title
Portrait  
Group  : groupMembership
UUID 
```

团体

```
Import Search Filter   :  (&(objectClass=inetOrgPerson)(mail=*)) 
```

组映射

```
Group Name  :company
Description  : description
User  : groupMembership 
```

它导入用户但不导入用户组，我尝试在 portal-ext.properties 中设置**ldap.import.method=user**但仍然没有创建/导入用户组，注意：我可以在控制面板中看到组列表，但我它没有导入 Liferay 我也尝试 **了 ldap.import.method=group**，它只创建用户组但不导入与该组关联的任何用户

提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T23:35:28.473

对于您的组映射，组名称应映射到 CN。

我不确定 User to groupMembership 是什么意思，但唯一有意义的实际上是 User : member

User 对象的属性是 groupMembership，Group 对象的属性是 member。

# javascript - Gridster on_overlap_stop 覆盖

> ID：12080123
> 
> 赞同：2
> 
> 时间：2012-08-22T19:29:43.987
> 
> 标签：javascript, jquery, jquery-plugins, grid

我正在使用一个名为 Gridster 的 jquery 插件。

[http://gridster.net/](http://gridster.net/)

在初始化我的网格时，我试图设置一个回调，`collision.on_overlap_stop`但是每次我设置它时，程序都会在 gridster 代码中引发各种错误。

有没有其他人遇到过这个问题？

代码示例：

```
<script type="text/javascript">
  var gridster;

  $(function(){

    gridster = $(".gridster ul").gridster({
        widget_margins: [10, 10],
        widget_base_dimensions: [140, 140],
        draggable: {
            stop: function(event, ui)
            {
                 //code...
            }
        },
        collision:
        {
            //this function doesn't seem to be called and when this function is set the page crashes.
            on_overlap_stop: function(collider_data)
            {
                 //code....
            }
        },
    }).data('gridster');
  });
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T12:05:21.123

刚刚遇到同样的问题。如果要使用`on_overlap_stop`or `on_overlap_start`，则需要同时提供它们。这样就不会显示错误。

# html - 如何使用 xsl 在表格中选择一个条目以及它上面和下面的条目？

> ID：12080126
> 
> 赞同：1
> 
> 时间：2012-08-22T19:29:54.213
> 
> 标签：html, xml, xslt

我有一个用于显示足球联赛表的 xml 提要。我希望能够过滤表格以仅显示一个特定的团队及其上方和下方的可变数量的条目。

例如，在 24 支球队的联赛中，我想显示 A 队以及 3 支排名较高的球队和 3 支排名较低的球队，我目前正在使用 xsl 来格式化数据，但是我不知道如何做到这一点。它甚至会与 xsl 一起使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T22:11:28.360

一旦你成功地选择了你的“特定团队”，你可以使用follow-sibling和previous-sibling轴来选择你附近的项目，使用position()来限制它们的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T04:28:16.643

**这是一个简化的示例**：

让我们有这个 XML 文档（每个元素代表一个“团队”），该文档代表所有 10 个团队，已经按点排序：

```
<nums>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>10</num>
</nums> 
```

**如果我们感兴趣的团队由`<num>05</num>`以下转换**表示：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:variable name="vgivenTeam"
    select="/*/*[. = 5]"/>

 <xsl:template match="/">
  <xsl:copy-of select=

  "$vgivenTeam
 | $vgivenTeam/preceding-sibling::*[not(position() > 3)]
 | $vgivenTeam/following-sibling::*[not(position() > 3)]
 "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于上述 XML 文档时，会产生想要的结果**——在给定的一个之前的三个团队、给定的团队和给定的之后的三个团队：

```
<num>02</num>
<num>03</num>
<num>04</num>
<num>05</num>
<num>06</num>
<num>07</num>
<num>08</num> 
```

# c - 如何知道C中的行尾

> ID：12080129
> 
> 赞同：3
> 
> 时间：2012-08-22T19:30:08.663
> 
> 标签：c

如果我做 ：

```
int main(){
    const int LENGTH_LINE = 100;
    char line[LENGTH_LINE];
    int len;
    FILE* fp = fopen(file.txt,"r");

    fgets(line,LENGTH_LINE,fp);
    len = strlen(line);
    if(line[len-1] == '\n')
       printf("I've a line");

    //This work if the line have \n , but if the end line of the text dont have \n how can do it?

} 
```

我需要知道我是否采取了整行，`fgets`因为我有一个分隔符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:34:55.217

根据[http://en.cppreference.com/w/c/io/fgets](http://en.cppreference.com/w/c/io/fgets)

```
Reads at most count - 1 characters from the given file stream and stores them in str. 
Parsing stops if end-of-file occurs or a newline character is found, in which case str will contain that newline character. 
```

所以，一旦 fgets 返回，就有 3 种可能性

1.  已达到 LENGTH_LINE
2.  我们有一个换行符
3.  已达到 EOF。

我假设您在案例 2 和 3 中有一条线。

在这种情况下，检测条件为：

```
line[len-1] == '\n' || feof(fp) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:31:12.630

检查换行符：

```
size_t len = 0;

// ... your code using fgets

len = strlen(line);
if ((len > 0) && (line[len - 1] == '\n'))
    // your input contains the newline 
```

通话结束后`fgets`，如果出现以下情况，您的线路末尾可能没有换行符：

*   在扫描换行符之前达到字符限制 - 在您的情况下是`LENGTH_LINE`.
*   `EOF`在换行符之前到达文件结尾 ( )。
*   有一个读取错误，但如果发生错误，请考虑`line`不可用的内容。

您应该查看 from 的返回值，`fgets`以便能够处理`EOF`:在文件结束或读取错误时`fgets`返回。`NULL`您可以使用它`feof`来检查文件结尾。

如果您检查`feof`，并且知道您在输入的末尾没有`fgets`错误，那么即使最后一行没有换行符，您也会知道您已经阅读了整行。

如果由于某种原因您必须有一个换行符来终止每个`line`，您可以自己添加它：

```
// you've checked for EOF and know this is your final line:
len = strlen(line);
if (line[len-1] == '\n')
    printf("I've a line");
else if ((len + 1) < LENGTH_LINE)
{
    line[len] = '\n';
    line[len + 1] = '\0';
}
else
    // no room in your line buffer for an add'l character 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:49:36.303

像这样使用

```
while(fgets(line,LENGTH_LINE,fp)!=EOF)
  // your code here 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T20:24:03.610

为什么不直接使用 fgetc 呢？这样您就可以一直扫描直到到达行尾，这样您就不必检查是否有它。

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    char line[100]; 
    int ch, i = 0;

    FILE* fp = fopen(file.txt,"r");
    while(ch != '\n' || ch != '\r' || ch != EOF)  //or ch != delimiter
    {
        ch = fgetc(fp);
        line[i] = ch;
        i++;
    }
    line[i] = '\n';
    line[i+1] = 0x00;
    return 0;
} 
```

在该示例中，我只是查找换行符、回车符或 EOF 字符，但您确实可以让它查找您喜欢的任何内容（例如，您的分隔符）。所以如果你的分隔符是`q`你会做

`while(ch != 'q')...`

# knockout.js - 如果绑定和脚本淘汰js

> ID：12080136
> 
> 赞同：0
> 
> 时间：2012-08-22T19:30:44.360
> 
> 标签：knockout.js

如果绑定，我遇到了 knockoutjs 的问题。我非常自由地使用绑定，因为它允许我在绑定中引用子属性而不会出错。

引起关注的一个原因是在 if 绑定添加的 DOM 元素上注册事件处理程序等。基本上，当 if 绑定添加的元素添加到 DOM 时，我需要获取回调。我曾尝试使用 livequery jquery 插件，但似乎元素被添加了两次。我想出了一些示例代码来展示这一点。

淘汰赛文档明确指出：

“然而，if 绑定在物理上添加或删除 DOM 中包含的标记，并且仅在表达式为真时才将绑定应用于后代。”

[http://knockoutjs.com/documentation/if-binding.html](http://knockoutjs.com/documentation/if-binding.html)

但是在下面的代码中，内联脚本中的警报被执行：

JS：

```
var vm = {
    val: ko.observable(false),
    someText: ko.observable("some text"),
};

ko.applyBindings(vm, document.getElementById("d1") 
```

HTML：

```
<div id="d1" data-bind="if: val">
   <span data-bind="text: someText"></span>
   <script>alert("here")</script>
</div>​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:30:47.040

你基本上已经用这句话回答了你自己的问题：

> “然而，if 绑定在物理上添加或删除 DOM 中包含的标记，并且仅在表达式为真时才将绑定应用于后代。”

虽然这句话清楚地表明了绑定的行为，但它并没有说明任何关于其他 JavaScript 或浏览器功能的内容。这是非常有意义的，因为 Knockout 的域是它的绑定，没有别的。在加载 Knockout 时，您的浏览器将已经执行了该警报语句。每次 Knockout 将它添加回 DOM 树时，它都会执行该警报语句。

将`<script>`此类元素与 Knockout 结合使用是不好的做法，并且可能导致不可预测的行为。您要做的是在 Knockout 的域中表达预期的行为，这是它的绑定。在您的情况下，这将适合`afterRender`绑定：

```
<div id="d1" data-bind="if: val">
   <span data-bind="text: someText, afterRender: alert('here')"></span>
</div>​ 
```

如果`val`是，则呈现`true`内部`<span>`并且`afterRender`事件将触发。

如果`val`是`false`，则内部`<span>`将**不会**被渲染并且`afterRender`事件**不会**触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T22:21:49.437

好的，我知道我需要做什么。显然，“if”绑定实际上是模板绑定的原生/简化扩展：

[http://knockoutjs.com/documentation/template-binding.html](http://knockoutjs.com/documentation/template-binding.html)

模板绑定还具有 afterRender 选项，您可以传递一个函数，该函数将在整个模板添加到 DOM 后执行。

我的代码现在看起来像这样：

```
<div data-bind="template: {if: val, afterRender: func}"> 
```

笔记：

这也可以使用“with”绑定，当然还有“foreach”绑定。

# r - 直方图和pdf在同一张图中

> ID：12080139
> 
> 赞同：-2
> 
> 时间：2012-08-22T19:30:59.220
> 
> 标签：r

> **可能重复：**
> [将密度曲线拟合到 R 中的直方图](https://stackoverflow.com/questions/1497539/fitting-a-density-curve-to-a-histogram-in-r)

我想在同一张图上绘制直方图和各种 pdf。我尝试了一个带有以下代码的pdf（采用我在网上找到的代码）：

```
hist(data, freq = FALSE, col = "grey", breaks = "FD")
.x <- seq(0, 0.1, length.out=100)
curve(dnorm(.x, mean=a, sd=b), col = 2, add = TRUE) 
```

它给了我一个错误。你能给我建议吗？对于多个pdf有什么诀窍？而且我观察到直方图似乎是绘制密度（在 yy 轴上）而不是观察次数......我该如何改变这个？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:15:02.460

它绘制密度而不是频率，因为您指定了`freq=FALSE`. 抱怨它完全按照您的指示去做是不公平的。

该`curve`函数需要一个涉及（不是 .x）的表达式，`x`并且它不需要您预先计算 x 值。你可能想要这样的东西：

```
a <- 5
b <- 2
hist( rnorm(100, a, b), freq=FALSE )
curve( dnorm(x,a,b), add=TRUE ) 
```

对于下一个问题，如果您指定`freq=TRUE`（或将其保留为默认值）并添加曲线，则曲线仅沿底部延伸（这是将直方图绘制为密度而不是频率的全部目的）。您可以通过缩放`curve`由 bin 的宽度和总点数给出的表达式来解决此问题：

```
out <- hist( rnorm(100, a, b) )
curve( dnorm(x,a,b)*100*diff(out$breaks[1:2]), add=TRUE ) 
```

虽然我个人认为 y 轴上没有刻度线标签的第一个选项（密度刻度）对我来说更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:07:04.227

```
h<-hist(data, breaks="FD", col="red", xlab="xTitle", main="Normal pdf and     histogram")
xfit<-seq(min(data),max(data),length=100)
x.norm<-rnorm(n=100000, mean=a, sd=b)
yfit<-dnorm(xfit,mean=mean(x.norm),sd=sd(x.norm))
yfit <- yfit*diff(h$mids[1:2])*length(loose_All)
lines(xfit, yfit, col="blue", lwd=2) 
```

# php - PHP 升级后的 nginx 错误：FastCGI 在 stderr 中发送：“”同时从上游读取响应标头

> ID：12080144
> 
> 赞同：0
> 
> 时间：2012-08-22T19:31:21.803
> 
> 标签：php, nginx, fastcgi

我猜这是由于 PHP 升级，因为我在我的 ubuntu 服务器上升级了 Apache2 和 PHP，现在 nginx 不再正常运行。

我重新启动了 nginx 进程和快速 CGI，它显然无法正常工作，并指出 FastCGI 在 stderr 中发送空白消息。我对如何继续调试有点茫然。

有人对我接下来应该采取什么步骤进行调试有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:38:14.850

几周前我遇到了类似的问题。原来是权限问题。确保您的服务器根目录、它包含的所有文件和目录以及服务器根目录的整个路径都具有正确的权限（除了所有权之外，别忘了检查 chmod）。

# python - 为什么这个程序挂起？

> ID：12080155
> 
> 赞同：1
> 
> 时间：2012-08-22T19:32:00.903
> 
> 标签：python, sockets

我正在粘贴整个代码，因为我认为它尽可能短；

```
import socket

def recv_all(sock):
    parts = []
    while True:
        msg = ""
        msg = sock.recv(4096)
        print "recieved", len(msg), "bytes."
        if not msg:
            break
        parts.append(msg)
    return "".join(parts)

http_request = """GET / HTTP/1.1
Host: {}
User-Agent: Opera/9.80 (Windows NT 6.1; WOW64; U; tr) Presto/2.10.229 Version/11.64
Accept: text/html, application/xml;q=0.9, application/xhtml xml, image/png, image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1
Accept-Language: en
Accept-Charset: iso-8859-1, utf-8, utf-16, *;q=0.1
Accept-Encoding: deflate, gzip, x-gzip, identity, *;q=0
Connection: Keep-Alive, TE
TE: deflate, gzip, chunked, identity, trailers

"""
site = "www.google.com.tr"
print "creating connection"
conn = socket.create_connection((site,80))
print "sending data"
conn.sendall(http_request.format(site))
print "recieving response"
response = recv_all(conn)
print "closing connection"
conn.close()

print response 
```

当我运行它时，我得到了这个输出；

```
创建连接
发送数据
收到回复
收到 3743 个字节。
收到 4096 字节。
收到 4096 字节。
收到 4096 字节。
收到 3472 字节。
收到 1648 个字节。
```

我期望它做的是在读取最后一个块（在本例中为 1648）后读取 0 个字节。但它一直在等待。

我在带有 Python 2.7 的 Windows 7 上。

我在这里做错了什么？我应该怎么做才能按预期工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T19:34:33.577

您正在发送：

```
Connection: Keep-Alive, TE 
```

...并且服务器完全按照您的要求进行操作 - 最后保持连接处于活动状态。因此，您的读取调用阻塞，等待更多数据 - 而服务器正在等待同一连接上的另一个请求。

*关闭*keep* [-alive](http://en.wikipedia.org/wiki/HTTP_persistent_connection)，*或*查找 Content-Length 标头，并在您读取那么多数据时停止读取。*

 *（或者，使用 HTTP 客户端库而不是尝试自己做 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:36:31.193

关键在于您发送的 HTTP 请求。看到这一行：

> 连接：保活，TE

这告诉另一端的服务器保持连接处于活动状态。

尝试：

> 连接：关闭

看看会发生什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:41:43.037

编辑：我误读了你的问题。虽然这不会导致您的挂起行为，但我认为您打算将最后一个添加`msg`到`parts`，这不会在最终运行时发生，因为您的`if ... break`语句位于`.append`.*

# c# - 识别泛型类型参数括号

> ID：12080159
> 
> 赞同：0
> 
> 时间：2012-08-22T19:32:23.630
> 
> 标签：c#, generics, antlr, lexer

我目前正在研究一种作为 C# 超集的语言。但是，我很难让词法分析器识别打开和关闭泛型类型括号，特别是在类似表达式中使用的打开类型表达式`typeof()`，例如`typeof(List<List<>>)`.

如果我有三个规则：

```
OpenTriangleBracket
    :    '<'
    ;

CloseTriangleBracket
    :    '>'
    ;

Symbol
    :    ('>' | '<')+
    ; 
```

正确识别以下类型的第 (1) 部分 ( `<`)。但是，第 (2) 部分被识别为符号 ( `<>>`)。通常，这将是可取的行为。如果它是一种类型，我希望它被识别为它的三个独立部分（`<`, `>`, `>`）。

```
List<List<>>
    v    ^v^
    1     2 
```

我怎么能让它认出它呢？当我自己编写解析器部分时，我可以完全控制它的实现方式。

# message - smtp.Send（消息）错误

> ID：12080161
> 
> 赞同：0
> 
> 时间：2012-08-22T19:32:33.400
> 
> 标签：message

我正在为我的最后一年项目建立一个酒店网站，我正在尝试在客户预订后向他们发送一封自动电子邮件。

使用此代码：

```
System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage();
message.To.Add(email.Text);
message.Subject = "Hotel Reservation";
message.From = new System.Net.Mail.MailAddress("Reservation@hotel.com");
message.Body = ("Dear" + first_name.Text + "Your reservation made for " + rates.Text +" " + nor.Text + " " + "is successful. Please print out this email for reference while checkin. Thank you");
System.Net.Mail.SmtpClient smtp = new System.Net.Mail.SmtpClient("yoursmtphost"); smtp.Send(message); 
```

当我运行它时，它会显示此错误，突出显示**smtp.Send(message);** ：

**用户代码未处理 SmtpException 并且发送邮件失败。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:38:20.903

这个错误有几个原因。

1.  收件人电子邮件无效
2.  您尚未指定凭据。（用户名密码）
3.  可能是防火墙问题
4.  SMTP 端口可能不是 25

# javascript - 对 Type 和 State 字段的更新会中断从 WSAPI 检索模型

> ID：12080163
> 
> 赞同：0
> 
> 时间：2012-08-22T19:32:46.833
> 
> 标签：javascript, rally

似乎即将对 Type 和 State 字段进行的更新将破坏 Rally Portfolio Item Kanban Board 应用程序中的组合框，并导致加载状态时出现问题。

以下是两个受影响的代码片段，我想澄清一下如何更新：

```
this.typeCombo = Ext.widget('rallycombobox', {
    fieldLabel:'Type:',
    labelWidth:30,
    labelClsExtra:'rui-label',
    stateful:false,
    margin: '0 10 0 0',
    storeConfig:{
        autoLoad:true,
        remoteFilter:false,
        model:'Type',
        sorters:{
            property:'ordinalValue',
            direction:'Asc'
        },
        cls:'typeCombo',
        defaultSelectionToFirst:false,
        context:this.getContext().getDataContext()
    }
}); 
```

和

```
Ext.create('Rally.data.WsapiDataStore', {
    model:'State',
    context:this.getContext().getDataContext(),
    autoLoad:true,
    fetch:['Name', 'WIPLimit', 'Description'],
    filters:[
        {
            property:'StateType',
            value:this.currentType
        },
        {
            property:'Enabled',
            value:true
        }
    ],
    sorters:[
        {
            property:'OrderIndex',
            direction:'ASC'
        }
    ],
    listeners:{
        load:function (store, records) {
            if (options.success) {
                options.success.call(options.scope || this, records);
            }
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T23:38:31.223

下一个版本应该会解决这个问题。一旦 1.37 发布（9/1），它应该会再次开始工作。

# java - Apache Axis2 Java 客户端访问 Bronto SOAP WSDL

> ID：12080168
> 
> 赞同：0
> 
> 时间：2012-08-22T19:33:06.717
> 
> 标签：java, soap, wsdl, axis2, bronto

我已经使用以下链接下载了 Apache Axis2：http: [//archive.apache.org/dist/ws/axis2/1_4_1/axis2-1.4.1-bin.zip](http://archive.apache.org/dist/ws/axis2/1_4_1/axis2-1.4.1-bin.zip)

然后我使用以下命令生成java类： wsdl2java.sh -uri [https://api.bronto.com/v4?wsdl](https://api.bronto.com/v4?wsdl) 总生成src: BrontoSoapApiImplServiceStub.java BrontoSoapApiImplServiceCallbackHandler.java ApiExceptionException0.java

我能够使用以下登录。

```
BrontoSoapApiImplServiceStub stub;

// Get the stub...

LoginE loginE = new LoginE();
Login login = new Login();

login.setApiToken("your token here");
loginE.setLogin(login);

// Call the web service; login
stub.login(loginE); 
```

现在我尝试添加Contacts，并且需要SessionHeaderE，但我似乎无法将登录链接到sessionId，下面的代码是不对的。我登录后正在成像，我应该能够获得一些会话信息。但我似乎找不到。

```
SessionHeader sessionHeader = new SessionHeader();
sessionHeader.setSessionId(param)  // I don't know how to get sessionId from login info
SessionHeaderE sessionHeaderE = new SessionHeaderE();
sessionHeaderE.setSessionHeader(sessionHeader);
.....
AddContactsResponseE responseE = stub.addContacts(addContactsE, sessionHeaderE); 
```

顺便说一句，这是我第一次与 Axis 合作。不确定解决问题的最佳方法是什么。BrontoSoapApiImplServiceStub.java 中有超过 200,000 行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T18:23:46.443

我从[http://www.experts-exchange.com得到了答案](http://www.experts-exchange.com)

String sessionId = stub.login(loginE).getLoginResponse().get_return();

谢谢。

# python - 列表推导、列表列表和列表连接

> ID：12080169
> 
> 赞同：0
> 
> 时间：2012-08-22T19:33:15.933
> 
> 标签：python, google-app-engine

这是我的代码

```
[temp.append(i.get_hot_post(3)) for i in node_list]
[hot_posts+i.sort(key=sort_by_rate) for i in temp ] 
```

get_hot_posts() 以这种方式返回 3 个项目的列表

```
return recent_posts[0:amount-1] 
```

可能是列表短于 3 个元素，它可能会弄乱周围的东西，但继续

```
[temp.append(i.get_hot_post(3)) for i in node_list] 
```

在这个命令之后，在“temp”中我有一个列表列表，这很好。

但是当它执行时

```
[hot_posts+i.sort(key=sort_by_rate) for i in temp ] 
```

它给出了这个错误

```
TypeError: can only concatenate list (not "NoneType") to list 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:42:32.267

List 方法`sort`返回`None`（只是更改列表）。您可以改用`sorted()`函数。

PS。

```
[temp.append(i.get_hot_post(3)) for i in node_list] 
```

这不是一个好主意，因为您将有一个`None`. 可能的变体：

```
temp += [i.get_hot_post(3) for i in node_list] 
```

甚至

```
from operator import methodcaller 
temp += map(methodcaller(get_hot_post, 3), node_list) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T19:35:58.637

我想你的意思是`sorted(i)`，不是吗？`i.sort()`进行就地排序并且不返回任何内容。

另外，你为什么想做[hot_posts + ...]？这不会将值存储在 hot_posts 中，因此该操作没有意义，除非您将结果分配给新变量。

我怀疑你想做类似的事情

```
temp = [i.get_hot_post(3) for i in node_list]
hot_posts = [sorted(i, key=sort_by_rate) for i in temp] 
```

虽然我不知道你的最后一行应该做什么。现在它只是对这些三个小列表中的每一个进行排序，仅此而已。

# android - 获取 Android 在 x 轴上的旋转角度

> ID：12080170
> 
> 赞同：5
> 
> 时间：2012-08-22T19:33:18.743
> 
> 标签：android, android-sensors

我正在尝试一些 Android 功能。现在，我正在尝试获取设备的旋转角度，所以当我在画布上显示一张笑脸位图时，它总是看起来“笔直”。

为此，我只需要获取 x 轴旋转角度（我猜），但我找不到如何实现它。希望您能够帮助我。谢谢你。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-23T19:10:47.287

找到了更好的答案！（感谢*原谅上帝*帮助我开始这个！）

ORIENTATION 现在已被弃用并用于许多资源。另外，它参考磁北工作，这不是设备的纯粹旋转，但实际上总是指向北方。

通过使用ACCELEROMETER，可以通过以下方式计算具有值[0]和[1]的设备的旋转角度：

```
 public void onSensorChanged(SensorEvent event) {
        // TODO Auto-generated method stub
        if (event.sensor != mSensor)
            return;

        aX= event.values[0];
        aY= event.values[1];
        //aZ= event.values[2];
        angle = Math.atan2(aX, aY)/(Math.PI/180);
    } 
```

也许这可以在未来帮助其他人。非常感谢！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:15:07.667

您可以使用方位角、俯仰角和滚动角。不确定哪一个与您的“x轴”有关，但我认为它的方位角。

有用链接的时间：

1.  [http://www.workingfromhere.com/blog/2009/03/30/orientation-sensor-tips-in-android/](http://www.workingfromhere.com/blog/2009/03/30/orientation-sensor-tips-in-android/)
2.  [http://marakana.com/forums/android/examples/43.html](http://marakana.com/forums/android/examples/43.html)
3.  [http://marakana.com/static/tutorials/SensorDemo.zip](http://marakana.com/static/tutorials/SensorDemo.zip)

# php - 使用 JSONP 而不包装响应

> ID：12080174
> 
> 赞同：0
> 
> 时间：2012-08-22T19:33:24.743
> 
> 标签：php, jquery, jsonp

当我将 URI 放入 Web 浏览器时，我的服务器会输出此 JSON。我的客户端应用程序将使用 JSONP 获取此 JSON，因为它访问外部域。

```
{
"is_execution_successful":true,
"data": "something"
} 
```

有没有办法在**不包装响应**的情况下执行 JSONP ：

```
echo $_GET['json_callback']. '('. json_encode($rtnjsonobj) . ')'; 
```

我无权编辑服务器输出。如何使用 AJAX/JQuery 获取 JSON？

我阅读的参考资料：[http ://remysharp.com/2007/10/08/what-is-jsonp/](http://remysharp.com/2007/10/08/what-is-jsonp/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:37:24.733

JSONP 在技术上与 JSON 无关。它只是 JavaScript 代码。

因此，如果响应是有效的 JSON，那么当您将其作为 javascript (JSONP) 运行时，它不会做任何有用的事情。特别是在这种情况下，JSON 在作为 javascript 执行时会导致语法错误。

您可以向资源发出跨域 ajax 请求，但这只有在服务器发送此标头时才有可能：

```
Access-Control-Allow-Origin: * 
```

*星号当然可以替换为您的特定来源，它不必是通配符*

# shell - 如何访问终端状态响应？

> ID：12080192
> 
> 赞同：0
> 
> 时间：2012-08-22T19:35:13.800
> 
> 标签：shell, scripting, terminal, term

[http://www.termsys.demon.co.uk/vtansi.htm](http://www.termsys.demon.co.uk/vtansi.htm)这个链接有一堆转义码，我写了移动光标和改变颜色的脚本——我很好奇一个是怎么回事以编程方式获得*响应*？据我所知，这似乎不是标准输出或标准错误，所以我很困惑

例如在 ZSH 我执行以下操作：

```
jessed@joriet-mac ~ » echo "\e[6n"

jessed@joriet-mac ~ » 3;1R 
```

对查询的响应是作为下一个终端命令出现的？我不明白为什么，Bash 似乎也没有表现出这种行为。

例如，我知道还有其他方法可以使用 tput 来做到这一点，但我想在较低的层次上知道发生了什么以及为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T21:04:44.350

响应通过从终端（或终端仿真器）到串行端口（或其他 tty 设备）的通道。这与用于传输终端键盘输入的字符的通道相同；没有带外信令。

由于您在发送查询后没有阅读响应，因此它被您的 shell 解释为一系列按键。不同的 shell 对不寻常的键盘输入有不同的响应。

要正确读取响应，您必须使终端脱离基于行的（“icanon”或“cooked”）模式并一次读取一个字节（从 tty，即可能是 stdin，与您阅读的相同位置键盘输入）直到找到终止字符。并且没有真正的方法可以将响应与同时发生的任何真实按键区分开来。

这是一项不干净的业务，如果您尝试在 shell 脚本中执行此操作，则会增加额外的痛苦。

# wpf - 将不可选择的控件添加到 RibbonMenuButton

> ID：12080194
> 
> 赞同：1
> 
> 时间：2012-08-22T19:35:41.620
> 
> 标签：wpf, xaml, ribbon

我正在开发一个 WPF 项目，并开始开发该`Ribbon`区域。我只是放了一个`RibbonMenuButton`并在其中添加了三个`RibbonTextBox`。我希望这些文本框从用户那里检索一些数据。到目前为止一切都很好。

```
<rb:RibbonMenuButton LargeImageSource="/image.png" Label="Settings"   >

    <rb:RibbonTextBox Label="Field 01:" Text="{Binding Field01 }" />
    <rb:RibbonTextBox Label="Field 02:" Text="{Binding Field02 }" />
    <rb:RibbonTextBox Label="Field 03:" Text="{Binding Field03 }" />

</rb:RibbonMenuButton> 
```

我的问题是它**变成`RibbonTextBox`了一个菜单项，即我可以单击它并选择它。**

但我想避免这种行为，我只想有一个**"unselectable"** `RibbonTextBox`。

**有没有办法做到这一点？**

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T20:37:57.610

我[在这里找到了解决方案](http://social.msdn.microsoft.com/Forums/en/wpf/thread/adc660c6-4b09-4e4d-a9d0-3e8f5288c47a)：

```
<Style TargetType="{x:Type rb:RibbonMenuItem}">
     <Setter Property="Template">
         <Setter.Value>
             <ControlTemplate TargetType="{x:Type rb:RibbonMenuItem}">
                 <ContentPresenter ContentTemplate="{TemplateBinding HeaderTemplate}" 
                     Content="{TemplateBinding Header}" Grid.Column="1" 
                     ContentStringFormat="{TemplateBinding HeaderStringFormat}" 
                     ContentSource="Header" 
                     Margin="{TemplateBinding Padding}" 
                     RecognizesAccessKey="True" 
                     VerticalAlignment="Center"/>
             </ControlTemplate>
         </Setter.Value>
     </Setter>
 </Style> 
```

这对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:40:29.747

这些通常称为`Labels`. 但是代替使用适当的控件，它`RibbonTextBox`具有两个`IsReadOnly`属性，这将使其可选择（即用于复制/粘贴）但不可编辑。或者`IsEnabled`这将使它完全非交互式。

我认为这`IsEnabled`也会阻止你点击它，但我不能 100% 确定这一点。

# javascript - 2个日期之间的差异

> ID：12080195
> 
> 赞同：0
> 
> 时间：2012-08-22T19:35:42.340
> 
> 标签：javascript, date

我必须简单地计算两个日期之间的差异，并将其显示为整数，但如果两个日期之间有大量日期（超过 26 个），以及如果有一个日期为“31 日”两个日期之间的一个月。

找不到我的代码有什么问题...？

`'ires_sakuma_datums'`和的值由 jquery 日历选择器设置，并以 eg和`'ires_beigu_datums'`的格式分别显示，结果应显示为 id`25-08-2012``17-09-2012``'dienu_skaits'`

示例`'ires_sakuma_datums'`设置为`28-08-2012`并`'ires_beigu_datums'`设置为`29-09-2012`，`31.041666666666668`尽管我希望结果为`32`

```
 function getDays()
    {
        var x = document.getElementById('ires_sakuma_datums').value;
        var y = document.getElementById('ires_beigu_datums').value;

        //assuming that the delimiter for dt time picker is a '-'.
        var arr1 = x.split('-');
        var arr2 = y.split('-');
        var dt1 = new Date();
        dt1.setFullYear(arr1[2], arr1[1], arr1[0]);
        var dt2 = new Date();
        dt2.setFullYear(arr2[2], arr2[1], arr2[0]);

        document.getElementById('dienu_skaits').value = (dt2.valueOf() - dt1.valueOf()) / (60 * 60 * 24 * 1000);

document.forms['test'].elements['dienu_skaits'].focus();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:18:55.330

问题是要传递的月份`Date`是基于 0 的，因此您必须从月份中减去 1。[http://jsfiddle.net/qB9V3/5/](http://jsfiddle.net/qB9V3/5/)因此，您之间的比较`28-08-2012`和`29-09-2012`实际上是不同`28-09-2012`的`29-10-2012`

所以你的代码需要改变为

```
 var arr1 = x.split('-');
    var arr2 = y.split('-');
    var dt1 = new Date();
    dt1.setFullYear(arr1[2], parseInt(arr1[1],10) -1, arr1[0]);
    var dt2 = new Date();
    dt2.setFullYear(arr2[2], parseInt(arr2[1],10) - 1, arr2[0]); 
```

请注意，如果您的日期跨越夏令时更改，则两者之间的天数不会是偶数，因此您需要对结果进行四舍五入

```
document.getElementById('dienu_skaits').value = Math.round( 
    (dt2 - dt1) / (60 * 60 * 24 * 1000) 
); 
```

# python - 为什么此字符串不适用于 ast.literal_eval

> ID：12080197
> 
> 赞同：6
> 
> 时间：2012-08-22T19:35:44.040
> 
> 标签：python, string, eval

我收到格式错误的字符串错误。

这是我的测试

```
>>> eval("'Hello:: '+'fdsfds'")
'Hello:: fdsfds'
>>> import ast
>>> ast.literal_eval("'Hello:: '+'fdsfds'")
Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    ast.literal_eval("'Hello:: '+'fdsfds'")
  File "C:\Python27\lib\ast.py", line 80, in literal_eval
    return _convert(node_or_string)
  File "C:\Python27\lib\ast.py", line 79, in _convert
    raise ValueError('malformed string')
ValueError: malformed string 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T19:38:10.333

从`ast.literal_eval` [文档](http://docs.python.org/library/ast.html#ast.literal_eval)：

> 提供的字符串或节点只能由以下 Python 文字结构组成：字符串、数字、元组、列表、字典、布尔值和无。

连接 using`+`不包含在其中：它不是文字表达式，它是对`str.__add__`. 这是相同的原因`1+1`，否则`"hello".upper()`将不起作用。

# yii - YII：有关系的下拉列表

> ID：12080198
> 
> 赞同：0
> 
> 时间：2012-08-22T19:35:48.973
> 
> 标签：yii, relational-database, inner-join

> 数据库表：
> 
> *   Mcourse（硕士课程）-> 包含课程名称
> *   Lcourse(Linked Course- 课程属于一所大学) -> 包含外键 Mcourse_Id。和大学 ID。

问题是

> 我想使用下拉列表显示大学中可用的课程列表。

所以sql查询是：

> 从 Lcourse 内部选择 Lcourse_Id, Mcourse_Name* 在 Lcourse_Mcourse_Id=Mcourse Id 上加入 Mcourse..

```
*Id & value pair for dropdownlist 
```

我可以使用 createCommand 来做到这一点。它工作得很好。但我不能这样做使用关系..帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:41:56.390

错误出现在您视图中的 listData() 函数中，特别是您的 Lcourse 模型中没有 mc_Id。

由于您尚未阐明为每个关系分配的模型，因此无法猜测您应该在视图中用什么替代“mc_Id” - 检查您的 Lcourse 模型以确定正确的列名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T09:54:47.067

让我们想象一下，您的`Mcourse`表被调用`courses`并且该表的模型被调用`Courses`，您的`Lcourse`表被调用`courses_colleges`并且您的大学表是`colleges`并且该表的模型是`Colleges`

现在，您应该有`Courses`具有关系的模型：

```
public function relations() {
    return array(
        'colleges' => array(self::MANY_MANY, 'Colleges', 'courses_colleges(course_id, college_id)')
    );
} 
```

你的`Colleges`模型应该有类似的关系：

```
public function relations() {
    return array(
        'courses' => array(self::MANY_MANY, 'Courses', 'courses_colleges(college_id, course_id)')
    );
} 
```

现在，如果您想打印一个包含某所大学所有课程的下拉列表。在您的控制器操作方法中获取该学院的模型，包括其课程：

```
public function actionShow() {
    $id = 1; // We set just some sample id. You could get it from request ofc.
    $college = Colleges::model()->with('courses')->findByPk($id);
    $this->render('show', array('college'=>$college));
} 
```

现在在你看来打印出这个：

```
echo CHtml::dropDownList('courses', '', CHtml::listData($college->courses, 'id', 'name')); 
```

Where`'id'`和`'name'`是`Courses`模型的列。

类似的东西。

# django - 编辑表单不加载表单值

> ID：12080203
> 
> 赞同：0
> 
> 时间：2012-08-22T19:36:09.680
> 
> 标签：django, django-forms, django-1.4

我的一个模型有一个编辑视图。

```
@login_required        
def edit(request, id):
    ''' Edit form '''
    if id:
        post = get_object_or_404(Post, pk=id)
        if post.user != request.user:
            return HttpResponseForbidden()
    else:
        post = Post()

    if request.POST:
        form = PostForm(request.POST, instance = post)
        if form.is_valid():
            form.save()
            return HttpResponseRedirect(reverse('posts_manage'))
    else:
        form = PostForm(instance = post)

    return render_to_response('posts/add.html', {'form':form}, context_instance=RequestContext(request)) 
```

一切正常，所有帖子信息都已正确加载，但是`select`没有使用从数据库中获得的值选择其中一个字段，即一个框。其他选择框被选择为适当的值。

模型定义中未正确填充的字段：

```
class Post(models.Model):
    ...
    BATHROOM_CHOICES = ((1,'1'),(1.5,'1.5'),(2,'2'),(2.5,'2.5'),(3,'3'),(3.5,'3.5'),(4,'4'), (4.5,'4.5'),(5,'5+'))
    bathrooms = models.DecimalField(max_digits = 2,decimal_places = 1,choices = BATHROOM_CHOICES) 
```

add.html 中的相关部分：

```
{{ form.bathrooms|bootstrap}} 
```

表格.py

```
class PostForm(ModelForm):
    class Meta:
        model = Post
        exclude = ('available','user',)

    def __init__(self, *args, **kwargs):
        self.request = kwargs.pop('request', None)
        return super(PostForm, self).__init__(*args, **kwargs)

    def save(self, *args, **kwargs):
        kwargs['commit'] = False
        obj = super(PostForm, self).save(*args, **kwargs)
        if self.request:
            obj.user = self.request.user
        obj.save()
        return obj 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T21:19:01.233

数据库中的数据与中的选择不匹配`BATHROOM_CHOICES`

`BATHROOM_CHOICES = ((1,'1'),(1.5,'1.5'),(2,'2'),(2.5,'2.5'),(3,'3'),(3.5,'3.5'),(4,'4'), (4.5,'4.5'),(5,'5+'))` 并且 `models.DecimalField(max_digits = 2,decimal_places = 1,` 是矛盾的。

您的模型定义期望所有值的小数位至少为 1，并且可能将整数值强制转换为数据库中的`1`to `1.0`（取决于适配器实现）。

因此，当它寻找与该值匹配的选项时`1 !== 1.0`，因此没有选择任何值。

可能的修复： `BATHROOM_CHOICES = ((1.0,'1'),(1.5,'1.5'),(2.0,'2'),(2.5,'2.5'),(3.0,'3'),(3.5,'3.5'),(4.0,'4'), (4.5,'4.5'),(5.0,'5+'))`

# c - 源代码的选择性编译

> ID：12080205
> 
> 赞同：0
> 
> 时间：2012-08-22T19:36:20.773
> 
> 标签：c, optimization

我正在开发一个相当大的 C 项目，由多个源文件组成。我编写了一个脚本来找出这段代码中从未使用过的所有函数（仅定义一次，但从未在其他地方使用过）。现在我想在不包含这些函数的情况下编译我的代码。是否有任何直接的方法可以从编译中排除某些功能？

我知道我可以对这些函数中的每一个使用#ifdef/#endif 并将它们排除在外，但是使用脚本将它们插入到正确的位置是非常具有挑战性的，因此是个问题。

PS：我已经使用了所有编译器/链接器优化，这个练习应该超出那些（因为没有优化成功地删除 100% 死代码，我不希望它这样做）。所以我并不是真的在那个领域寻找答案。

# mysql - 转换为哈希并将其与另一个哈希进行比较的 vbscript

> ID：12080212
> 
> 赞同：0
> 
> 时间：2012-08-22T19:36:54.843
> 
> 标签：mysql, vba, ms-access-2010

我目前有一个 MySQL 数据库，其中存储了用于登录的用户名和密码。我有一个 MS Access 2010 前端，我构建了一个登录屏幕，询问用户密码和名称，并将其与 MySQL 用户名和密码进行比较，如果它们匹配，它将打开另一个 MS Access 表单。我现在想将密码存储在 MySQL 数据库中的哈希 sha1 中，但我不知道如何编写我的 vbscript，以便它将用户在 MS Access 表单中输入的密码转换为哈希 sha1 和将其与该特定用户的 MySQL 数据库中已有的内容进行比较。我已经包含了我不使用哈希时使用的 vbscript。任何帮助将不胜感激。

```
'compares username and password to a query and will either open another form OR display an incorrect password message.
Dim dbs As Database
Dim rstUserPwd As Recordset
Dim bFoundMatch As Boolean

Set dbs = CurrentDb

'query that has all the usernames and password
Set rstUserPwd = dbs.OpenRecordset("qryUserPwd")

bFoundMatch = False

If rstUserPwd.RecordCount > 0 Then
rstUserPwd.MoveFirst

'name of the access form is called 'Login'    
Do While rstUserPwd.EOF = False
If rstUserPwd![UserName] = Form_Login.txtusername.Value And rstUserPwd![Password] = Form_Login.txtpassword.Value Then
bFoundMatch = True
        Exit Do
End If
    rstUserPwd.MoveNext
Loop

End If
'open admin form
If bFoundMatch = True
DoCmd.Close acForm, Me.Name
DoCmd.OpenForm "admin"
Else
MsgBox "Incorrect User Name or Password"
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:30:49.063

Mysql 有它自己的 sha1 函数（和其他加密），所以你可以做类似“SELECT permission FROM customers WHERE sha1(key) = sha1('"&entered_key&"')”见[http://dev.mysql.com/doc /refman/5.5/en/encryption-functions.html#function_sha1](http://dev.mysql.com/doc/refman/5.5/en/encryption-functions.html#function_sha1) 所以你的vba本身不需要sha算法。

如果你真的想要，你可以使用 vba/vbscript sha 算法，如果你用谷歌搜索你会发现几个，例如像这个[http://bytes.com/topic/access/insights/906938-sha2-cryptographic-hash-algorithm -vba-vbscript](http://bytes.com/topic/access/insights/906938-sha2-cryptographic-hash-algorithm-vba-vbscript)

# javascript - 编写符合 ECMAScript5 的代码（第 2 部分）

> ID：12080213
> 
> 赞同：1
> 
> 时间：2012-08-22T19:36:57.507
> 
> 标签：javascript, jscript, ecmascript-5, ecma262

我目前正在学习高级 JavaScript，目的是构建一个符合标准（HTML5、CSS3、ESv5）的库。一路走来，我已经问了几个相关的问题，试图弄清楚从哪里开始，做什么，不做什么，避免什么等。我已经开始阅读 ECMA-262（ECMAScript 版本 5）文档，并且在我开始开发工作之前已经运行了一些测试。

以前的问题：

[编写符合 ECMAScript5 的代码](https://stackoverflow.com/questions/12053831/writing-ecmascript5-compliant-code)

[JavaScript、JScript 和 ECMAScript 有什么区别？](https://stackoverflow.com/questions/12051002/whats-the-difference-between-javascript-jscript-ecmascript)

在我的研究中，我发现不同的浏览器以不同的方式实现标准，在这方面，它们实现了不同的对象。例如，IE 实现了一个名为 ActiveXObject 的对象，但在 FireFox 中并非如此。所以我写了一个小测试工具来确定浏览器中是否定义了某些东西。

考虑以下测试一些已知对象（包括 jQuery，因为它不是内置的）。

![浏览器功能测试工具](../Images/9b01926640df64741547491c307eb9c3.png)

同样，我已经到了需要帮助的地步：

问题：

1.  给定上面的例子，对象和函数有什么区别？

2.  我是否在 ES/JS 中编写函数或对象？

3.  为什么 Object 是函数而不是对象？

4.  是否有内置对象/函数的层次结构？

5.  可以将内置对象/函数重新定义为完全不同的东西吗？

6.  可以未定义内置对象/函数吗？

7.  如果内置对象/函数本身不支持它们，是否可以为其分配新特性？

8.  如果一个对象是在一个浏览器中定义的，而不是在另一个浏览器中定义的，我该如何弥补这一点？

PS 我不想要与特定实现（JavaScript/JScript）相关的答案，而是与标准（ECMAScript v5）相关的答案。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:53:33.963

> 给定上面的例子，对象和函数有什么区别？

在 Chrome 中，所有这些项目都是函数。然而，一般来说，函数是一个对象，除了它包含代码并且您可以调用它之外。因此，您也可以只为函数添加属性（如 jQuery 所做的：`$("selector")`或`$.ajax`）。

> 我是否在 ES/JS 中编写函数或对象？

好吧，显然这取决于你的代码。`function() {}`给你一个功能；`{}`给你一个对象。（同样，函数归根结底*是*对象。）

> 为什么 Object 是函数而不是对象？

`Object`是一个函数，因为您可以调用它，无论是否作为构造函数：

```
Object();      // returns an empty object
new Object();  // same 
```

此外，鉴于几乎所有东西都是 的实例`Object`，因此它`Object`是构造函数，因此是函数。（再次注意，函数也是对象。）

> 是否有内置对象/函数的层次结构？

至于 ECMAScript 内置对象，在某种意义上是有的。`String`全局对象上有构造函数 ( )、实例函数 ( `Array.prototype.forEach`) 和“静态”函数（`Object.defineProperty`用于对象、`Array.isArray`数组）。

> 可以将内置对象/函数重新定义为完全不同的东西吗？

当然，你可以做到`Object = null`。但是任何依赖的代码`Object`都会开始抛出异常，所以完全不推荐。

> 可以未定义内置对象/函数吗？

不，对象不是未定义的。`undefined`不是一个对象，反之亦然。这适用于任何对象。

> 如果内置对象/函数本身不支持它们，是否可以为其分配新特性？

是的，如果 eg`Array.prototype.forEach`不存在，您可以自己设置。但应该注意的是，这些函数会出现在`for(var key in arr)`循环中，这又会导致代码行为不同。这可以通过使用来`Object.defineProperty`解决`{enumerable: false}`。但还有一个警告：该功能在整个环境中共享（例如当前页面）。如果其他代码也在设置它们，那么您将遇到冲突。

> 如果一个对象是在一个浏览器中定义的，而不是在另一个浏览器中定义的，我该如何弥补这一点？

您可以“填充”此类功能。例如 ES5 功能，例如`Array.prototype.forEach`有可用的 shims，这使得它们在旧版浏览器上也可用。Underscore.js 可能是一个很好的例子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:16:36.947

> 给定上面的例子，对象和函数有什么区别？

[函数](http://ecma-international.org/ecma-262/5.1/#sec-4.3.24)只是一个可[调用的对象](http://ecma-international.org/ecma-262/5.1/#sec-13.2)。但是，我猜您询问[主机对象](http://ecma-international.org/ecma-262/5.1/#sec-4.3.8)的类型（`Node`等`HTMLCollection`）：它们的行为取决于实现（“不是 ecmascript-native”） - 您不能依赖任何东西。

> 我是否在 ES/JS 中编写函数或对象？

嗯？您编写可以解释的*代码。*

> 为什么 Object 是函数而不是对象？

[`Object`](http://ecma-international.org/ecma-262/5.1/#sec-15.2)是本机[对象构造函数](http://ecma-international.org/ecma-262/5.1/#sec-15.2.2)，因此是一个函数（也是一个对象）。

> 是否有内置对象/函数的层次结构？

你问“*一切都是[对象](http://ecma-international.org/ecma-262/5.1/#sec-4.2.1)*”吗？如果你问 DOM 接口的结构：它们又是依赖于实现的宿主对象，但大多数实现者都有一个基于[DOM 规范](http://www.w3.org/TR/dom/)的继承系统。

> 可以将内置对象/函数重新定义为完全不同的东西吗？可以未定义内置对象/函数吗？

不可以。您可以覆盖指向它们的全局变量（全局对象的属性），但是每个实例都将由本机（然后 [[几乎](https://stackoverflow.com/a/11527758/1048572)] 不可访问）构造函数构造。

> 如果内置对象/函数本身不支持它们，是否可以为其分配新特性？如果一个对象是在一个浏览器中定义的，而不是在另一个浏览器中定义的，我该如何弥补这一点？

是的，您可以扩展本机对象及其原型。但要注意宿主对象，他们[可能不喜欢它](http://perfectionkills.com/whats-wrong-with-extending-the-dom/)。如果一个对象仅在某些环境中定义，您可以轻松测试它的存在并可能对其进行[填充](http://remysharp.com/2010/10/08/what-is-a-polyfill/)（[es5](https://github.com/kriskowal/es5-shim)，[html5](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T08:33:04.127

作为我对 ECMAScript / JavaScript 研究的一部分，我发现了以下资源，它提供了有关 JS DOM 的大量信息。

[http://krook.org/jsdom/index-all.html](http://krook.org/jsdom/index-all.html)

# javascript - 将“大”表拆分为较小的表

> ID：12080216
> 
> 赞同：4
> 
> 时间：2012-08-22T19:36:59.783
> 
> 标签：javascript, jquery, html, html-table

我想将一个“大”表（很多列）拆分为较小的表，例如 2 列。

有没有简单的方法可以做到这一点？

我这里只有桌子[http://jsfiddle.net/xy3UF/4/](http://jsfiddle.net/xy3UF/4/)。例如，我想将它每 2 列拆分一次。结果，我应该有一个包含该`#`列的三个表，每个表包含大表中的 2 个列。

所需输出：http: [//jsfiddle.net/xy3UF/15/](http://jsfiddle.net/xy3UF/15/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T21:00:50.317

```
function split($table, chunkSize) {
  var cols = $("th", $table).length - 1;
  var n = cols / chunkSize;

  for (var i = 1; i <= n; i++) {
     $("<br/>").appendTo("body");
     var $newTable = $table.clone().appendTo("body");
     for (var j = cols + 1; j > 1; j--) {
         if (j + chunkSize - 1 <= chunkSize * i || j > chunkSize * i + 1) {
             $('td:nth-child(' + j + '),th:nth-child(' + j + ')', $newTable).remove();
         }
     }
  }  
} 
```

表 jQuery 对象在哪里`$table`，并且`chunkSize`是每个*split*的大小。在您的示例中，将其称为`split($("table"), 2)`. 请注意，`chunkSize`必须均匀划分列数（不包括第一列）才能正常工作，例如，对于有 7 列的表，其*有效*值为`chunkSize`1、2 和 3。

**[演示](http://jsfiddle.net/VFeng/)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-18T07:37:49.080

我制作了更好的表拆分功能版本，支持修复列（在所有表中重复），它浪费了很多时间：

```
function range(start, end) {
  var array = new Array();
  for (var i = start; i <= end; i++) {
    array.push(i);
  }
  return array;
}

function splitTables($tables, chunkSize, fixCols) {
  $table = $($tables);
  console.log('fixCols :', fixCols);
  fixCols = fixCols || [];
  console.log('fixCols :', fixCols);
  fixCols = fixCols.sort();
  console.log('fixCols :', fixCols);
  //chunkSize -= fixCols.length;
  var rowLength = $('tr:first>*', $table).length;
  console.log('total length:', rowLength);
  var n = Math.ceil(rowLength / chunkSize);
  var bufferTables = [];
  var numberList = range(1, rowLength);

  for (var i = 1; i <= n; i++) {
    var colList = fixCols.slice(0);
    //console.log('fixCols :',fixCols);
    //console.log('colList :',colList);
    console.log('numberList :', numberList);
    while (colList.length < chunkSize && numberList.length > 0) {
      var index = numberList.shift();
      console.log(index, colList);
      if (colList.indexOf(index) == -1) {
        colList.push(index);
      }
    }

    console.log('col list:', colList);
    var $newTable = $table.clone(true)
    for (var index = 1;
      (index <= rowLength); index++) {
      if (colList.indexOf(index) == -1) {
        console.log('removing:', index);
        $('tr>:nth-child(' + index + ')', $newTable).hide();
      }
    }
    bufferTables.push($newTable)
  }

  $(bufferTables.reverse()).each(function(i, $el) {
    $('<br/>').insertAfter($table);
    $el.insertAfter($table);
  });
  $table.remove();

}

$(function() {
  $('#sbtn').click(function() {
    splitTables($("#tb"), 3, [1]);
  });
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<button id="sbtn">Split Table !</button>

<table border="1" id="tb">
  <thead>
    <tr>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
    </tr>
  </thead>
  <tfoot>
    <tr>
      <td>Sum</td>
      <td>$180</td>
      <td>$500</td>
      <td>$300</td>
      <td>$700</td>
      <td>$600</td>
      <td>$1000</td>
    </tr>
  </tfoot>
  <tbody>
    <tr>
      <td>Home</td>
      <td>$100</td>
      <td>$200</td>
      <td>$200</td>
      <td>$300</td>
      <td>$400</td>
      <td>$500</td>
    </tr>
    <tr>
      <td>Work</td>
      <td>$80</td>
      <td>$300</td>
      <td>$100</td>
      <td>$400</td>
      <td>$200</td>
      <td>$500</td>
    </tr>
  </tbody>
</table>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-26T10:29:14.053

这要简单得多。

1）标记TR：

```
<tr><td>some</td><!-- SPLITHERE --> 
```

2）拆分表：

```
document.body.innerHTML = document.body.innerHTML.replace(/<!-- SPLITHERE --\>\s*<\/tr>/i, '</tr></table></div><div class="eachPage"><table class="items">'); 
```

注意：您必须对该表的父元素（在我的示例中为正文）而不是表本身进行 innerHTML 更改，这是行不通的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T19:53:22.097

使用 XSLT 您可以轻松解决问题。

请访问此处：[将大表拆分为多个小表](https://stackoverflow.com/a/3742099/952310)

# c - Break 语句不在循环内或在 C 中切换

> ID：12080220
> 
> 赞同：1
> 
> 时间：2012-08-22T19:37:10.133
> 
> 标签：c, if-statement, break

我的 C 代码中出现此错误。我不知道我做错了什么。如果我评论这段代码，我的程序就可以工作。**这段代码在 int main() 中。**

```
 if(argc!=2 && strcmp(argv[0],"selection-sort")==0 && strcmp(argv[1],"input.txt")==0 && strcmp(argv[2],"output.txt")==0)
        {
                printf("The command line arguments are correct.\n");
        }
        else
        {
                printf("The command line arguments are wrong.I am exiting.\n");
                break;
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T19:38:14.017

它看起来的方式我认为你不是在循环中，而只是在 main 中检查 args。您可能想要类似`return 1`或`exit(1)`代替休息的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T19:42:49.903

首先确保您包含所需的头文件：

```
#include <stdio.h>
#include <stdlib.h> 
```

break 命令用于退出循环，你不在循环中，你只是在 else 语句中，你没有什么可中断的。代码流在传递 else 语句后正常执行。如果你想在 else 语句中退出程序，你可以这样做：

```
 else
    {
            printf("The command line arguments are wrong.I am exiting.\n");
            return 1; //exit program with status 1 to indicate a non normal exit
    } 
```

或者，如果您想在显示该消息后继续程序，您可以这样做：

```
else printf("The command line arguments are wrong.I am exiting.\n");
//more code here 
```

您只能在循环中使用 break ，如下所示：

```
while(foo)    //while foo is true
{
    break;    //exit the loop
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-22T19:40:55.287

标题中的错误消息说明了一切：`break`只能用于退出循环或防止案例失败。MSDN 报价：

> break 语句终止它出现的最近的封闭 do、for、switch 或 while 语句的执行。

要离开一个函数，请使用`return`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-22T19:42:31.447

Break 应该在循环中使用。

使用**return**语句，这会导致执行离开当前子例程，并在调用子例程之后的代码点（返回地址）处继续执行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-22T19:57:22.240

其他答案都是正确的，这只是一个小小的补充。

要在这种特定情况下返回可能，您应该包括`errno.h`以下内容：

```
#include <errno.h> 
```

而且还像这样返回：

```
return EINVAL; 
```

然后，您发出信号表明程序由于错误而终止，并且返回值明确指出错误是无效参数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-26T05:26:52.507

> 'break' 只会让你脱离最里面的循环或开关。您可以随时使用“return”退出函数。
> 
> “break 语句可能只出现在迭代语句或 switch 语句中，并终止执行最小的封闭此类语句”。
> 
> 这也是有道理的——你可以用“return”从一个方法中“逃脱”，你可以用if/else跳过其他情况下的代码。我不知道案件之外的“休息”会做什么。
> 
> 无论如何，“break”实际上只是“goto”的一种受限形式。理想情况下，您需要从任何代码块中单点退出。你真的应该只在 switch 语句中使用'break'，因为这是让它工作的唯一方法。在任何其他情况下，有更好的方法来完成同样的事情。这同样适用于“继续”。

# .net - 基于 Where 语句中不同参数的具有两个 COUNT 的 LINQ 查询

> ID：12080229
> 
> 赞同：2
> 
> 时间：2012-08-22T19:38:11.380
> 
> 标签：.net, linq, linq-to-sql

有没有办法让一个 LINQ 查询包含基于不同计数标准的两个不同计数？例如，假设我想查询“收件箱”以获取现有邮件总数的计数以及每个收件箱的所有未读邮件的另一个计数。

所以这是我正在寻找的结果......
NAME UNREAD TOTAL
gbush 10 20
bobama 30 100

这可以在一个查询中完成还是我需要两个查询？

这是我必须计算未读项目的数量，但我在哪里/如何获得总项目？

```
var results = from message in context.inbox
              where message.Status = "UNREAD"
              group message by message.Name into g
              select new { Name = g.Key, Unread = g.Count() }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:42:00.787

您可以使用[`Count`](http://msdn.microsoft.com/en-us/library/bb535181.aspx)接受谓词的重载：

```
var results = from message in context.inbox
              group message by message.Name into g
              select new 
              { 
                  Name = g.Key, 
                  Unread = g.Count(m => m.Status == "UNREAD"),
                  Total = g.Count()
              }; 
```

# c# - 如何修复列表中的数据 >

> ID：12080240
> 
> 赞同：2
> 
> 时间：2012-08-22T19:38:33.423
> 
> 标签：c#, list

我有一个名为 result 的变量，它是

```
List<List<string>> 
```

我想解析每个元素并修复它（删除空格等）

```
 i = 0;
            foreach (List<string> tr in res)
            {
                foreach (string td in tr)
                {
                    Console.Write("[{0}] ", td);
                    td = cleanStrings(td); // line with error
                    i++;
                }
                Console.WriteLine();
            }

    public string cleanStrings(string clean)
    {
        int j = 0;                
        string temp = System.Text.RegularExpressions.Regex.Replace(clean, @"[\r\n]", "");
        if (temp.Equals("&nbsp;"))
        {
            temp = " ";
            temp = temp.Trim();
        }
        clean = temp;                        
        return clean;
    } 
```

> 错误 1 ​​无法分配给“td”，因为它是“foreach 迭代变量”

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-22T19:40:58.680

基本上你不必使用`foreach`. .NET 中的迭代器基本上是只读的。例如：

```
for (int i = 0; i < tr.Count; i++)
{
    string td = tr[i];
    Console.Write("[{0}] ", td);
    tr[i] = CleanStrings(td);
} 
```

（请注意，我使用了`i`您正在递增但未使用的变量。）

或者，考虑使用 LINQ：

```
res = res.Select(list => list.Select(x => CleanStrings(x)).ToList())
         .ToList(); 
```

请注意，这会创建一个*新*列表的*新*列表，而不是改变任何现有列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:42:25.480

您无法使用 foreach 修改您正在枚举的集合，因此只需使用常规 for 循环：

```
for (int m = 0; m < res.Count; m++)
{
    for (int j = 0; j < res[m].Count; j++)
    {
        Console.Write("[{0}] ", td);
        res[m][j] = cleanStrings(res[m][j]);
        i++;
    }
    Console.WriteLine();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:43:22.710

您必须使内部循环成为`for`循环才能获取列表中的索引`tr`。这使您能够替换列表中此索引处的条目。但是，您可以保留外部`foreach`循环。

```
i = 0;
foreach (List<string> tr in res) {
    for (int k = 0; k < tr.Count; k++) {
        string td = tr.[k];
        Console.Write("[{0}] ", td);
        tr[k] = cleanStrings(td); // line with no error anymore
    }
    i += tr.Count;
    Console.WriteLine();
}
Console.WriteLine("Total number of items: {0}", i); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T19:45:16.233

正如错误所暗示的那样，您将无法通过更改迭代器变量来修复 List 的内容，并且您在外部 foreach 中具有相同的约束。有几种方法，但您可以尝试的一种方法如下：

```
 i = 0;
        foreach (List<string> tr in res)
        {
            for (int currentItem; currentItem<=tr.Count; currentItem++)
            {
                Console.Write("[{0}] ", tr[currentItem]);
                res[i][currentItem] = cleanStrings(tr[currentItem]); // line with error
            }
            i++;
            Console.WriteLine();
        } 
```

# c# - 在实体框架数据库中存储方法

> ID：12080241
> 
> 赞同：1
> 
> 时间：2012-08-22T19:38:38.417
> 
> 标签：c#, entity-framework, ef-code-first, code-first

是否有一种简单的方法可以将方法存储在 EF 表中，类似于继承？

例如，我有一个代表门户页面上的应用程序的表格（有点像您的基本 iphone 或 android 主屏幕）。我想通过每个应用显示一个数字，显示该应用有多少通知。但是，获取通知数量的方法因应用程序而异。

我目前的解决方案是只拥有一个包含我需要的所有方法的类，然后根据应用名称进行切换。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:54:51.520

假设您获取通知的方法是无参数的，您可以将方法名称存储在该表的列中并通过反射调用它。对于此示例，我们将调用列/属性**NotificationMethodName**。

```
//this would go in your entity class 
public int GetNotificationCount()
{    
   MethodInfo mi = typeof(HelperClass).GetMethod(this.NotificationMethodName);    
   return (int)mi.Invoke(this, null); 
}

public class HelperClass
{
  //your class that currently has all the methods to get notification count
} 
```

# linux - 恢复已删除的 python 脚本文件

> ID：12080242
> 
> 赞同：0
> 
> 时间：2012-08-22T19:38:38.973
> 
> 标签：linux, version-control, backup, rm, file-recovery

我们如何恢复已删除的 python 脚本文件（使用 rm 删除），例如 debian linux 框中的 lostfile.py？
linux盒子的文件系统是jfs

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T21:57:16.097

现在这可能对您没有帮助，但最好的方法是从其原始源重新部署脚本，或者从版本控制或备份中恢复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:07:25.020

**更新：** 我刚刚尝试构建它并遇到了一些编译问题。如果您要尝试此操作，请确保在执行其他任何操作之前成功构建 jfsrec。`dd`在大型文件系统上需要很长时间。如果您无法编译该工具，我不想浪费您的时间。

[这是一个名为jfsrec](http://jfsrec.sourceforge.net/)的开源工具。

如果是我，我会：

1.  启动到 Ubuntu 或其他发行版的 live 光盘
2.  `dd`.py 文件所在分区的图像（这是早期开发，所以我不想直接在您感兴趣的文件系统上使用该工具）
3.  下载并编译jfsrec（编译时可能需要安装其他依赖）
4.  挂载`dd`刚刚创建的镜像
5.  在挂载的镜像上运行 jfsrec 工具

调用 jfsrec：

```
./jfsrec --device /mnt/jfspartition --output /mnt/reallybig_hdd/recovered --logdir /mnt/reallybig_hdd/logs --first py 
```

更多细节可以在顶部提供的链接中看到。

# php - 从 preg_replace 函数中提取 var 值

> ID：12080243
> 
> 赞同：2
> 
> 时间：2012-08-22T19:38:38.837
> 
> 标签：php, regex, bbcode

我正在尝试模拟一个 bbcode 标签，如下面的代码：

```
[code]this is code to render[/code]
[code attributeA=arg]this is code to render[/code]
[code attribute C=arg anotherAtributte=anotherArg]this is code to render[/code] 
```

如您所见，代码标签可以根据需要获取任意数量的属性，也可以在同一个“发布”中存在过多的代码标签。我只处理过最简单的标签，如 img、b、a、i。例如：

```
$result = preg_replace('#\[link\=(.+)\](.+)\[\/link\]#iUs', '<a href="$1">$2</a>', $publishment); 
```

这很好用，因为它返回最终标记。但是，在代码标签中，我需要在数组中包含“属性”和“值”，以便根据这些属性自己构建标记，以便模拟这样的事情：

```
$code_tag = someFunction("[code ??=?? ...] content [/code]", $array );

//build the markup myself
$attribute1 = array_contains("attribute1", $array)? $array["attribute1"] : "";
echo '<pre {$attribute1}>' . $array['content'] . </pre> 
```

所以，我不指望你完全为我做这件事，我需要你帮助我走向正确的方向，因为我从来没有使用过正则表达式。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:12:21.013

我喜欢将 preg_replace_callback 用于此类事情：

```
function codecb($matches)
{
    $original=$matches[0];
    $parameters=$matches[1];
    $content=$matches[2];
    return "<pre>". $content ."</pre>";
}

preg_replace_callback("#\[code(.*)\](.+)\[\/code\]#iUs", "codecb", $str); 
```

因此，当您`[code argA=test argB=test]This is content[/code]`在功能“codecb”中使用时，您将拥有：

```
$original = "[code argA=test argB=test]This is content[/code]"
$parameters = " argA=test argB=test"
$content = "This is content" 
```

并且可以`preg_match`将论据和`return`替换为整体。

# sql-server-2008-r2 - 带有随机数的 SQL 用户定义函数

> ID：12080245
> 
> 赞同：3
> 
> 时间：2012-08-22T19:38:48.140
> 
> 标签：sql-server-2008-r2

我希望有一个人可以帮助我。

我试图在 MS server 2008 上使用 SQL 用户定义函数来执行以下操作

我试图预测客户何时会离开银行，我会通过一系列的抛硬币来做到这一点，直到你离开。抛硬币不一定总是在 50/50，因此我可以将概率作为参数以及当前客户任期传递给函数。

问题是不允许在函数内部使用 RAND()，我不明白为什么，但这很好，必须有原因。

这是我的功能：

```
create function NewTenure (@tenure integer, @p float) 
returns integer
as
begin
    declare @r float
    declare @newten int
    declare @attrite binary
    set @attrite=0
    set @newten = @tenure
    set @r = RAND()
    while (@attrite = 0)
    begin
        if (@r <= @p) set @attrite = 1;
        if (@r > @p) set @newten = @newten+1    
    end
    return(@newten)
end 
```

正如我所看到的，我需要生成一个介于 0-1 之间的随机值，以便我可以将其与确定客户是否离开的概率进行比较。如果不允许 RAND()，是否有 SQL 技巧在函数内部生成它？（我多年前从学校知道我可以编写自己的随机数生成器，但我不想这样做，也不认为我应该这样做，随机数是人们应该期望的基本计算机功能 -我曾经使用过的任何其他语言都有一个）

我计划在新查询中调用该函数，以在他们离开时使用预测的任期更新临时表，然后将其用于其他复杂的计算。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T19:49:36.030

这是一个肮脏的把戏。

```
CREATE VIEW dbo.vRand
AS
  SELECT r = RAND();
GO

CREATE FUNCTION dbo.fRand()
RETURNS DECIMAL(10,9)
AS
BEGIN
    RETURN (SELECT r FROM dbo.vRand);
END
GO

SELECT name, dbo.fRand()
  FROM sys.all_objects; 
```

# mysql - 无法使用 CodeIgniter 连接到 MySQL。可能的 DNS 问题？

> ID：12080247
> 
> 赞同：0
> 
> 时间：2012-08-22T19:39:01.100
> 
> 标签：mysql, codeigniter

我正在使用 Codeigniter 运行开发 LAMP。但是，当我尝试加载页面时，数据库无法连接（数据库实际上在另一台服务器上）并且我收到此错误：

```
A Database Error Occurred

Unable to connect to your database server using the provided settings.

Filename: core/Loader.php

Line Number: 346 
```

我的 database.php 是这样的：

```
$active_group = 'default';
$active_record = TRUE;

$db['default']['hostname'] = 'myhost.com';
$db['default']['username'] = 'myusername';
$db['default']['password'] = 'mypassword';
$db['default']['database'] = 'mytable';
$db['default']['dbdriver'] = 'mysql';
$db['default']['dbprefix'] = '';
$db['default']['pconnect'] = TRUE;
$db['default']['db_debug'] = TRUE;
$db['default']['cache_on'] = FALSE;
$db['default']['cachedir'] = '';
$db['default']['char_set'] = 'utf8';
$db['default']['dbcollat'] = 'utf8_general_ci';
$db['default']['swap_pre'] = '';
$db['default']['autoinit'] = TRUE;
$db['default']['stricton'] = FALSE; 
```

如果我将 'pconnect' 和/或 'db_debug' 更改为 false，我会收到相同的错误，或者它只是不起作用。我知道数据库已启动并正常运行，因为其他人能够连接和使用它。

但是，如果我将主机的 IP 地址放入 database.php 文件中，它就可以工作。我尝试刷新 DNS，甚至更改为 Google 的 DNS 服务器也无济于事。

一个简单的 mysql_connect 的结果是：

```
A PHP Error was encountered

Severity: Warning

Message: mysql_connect(): php_network_getaddresses: getaddrinfo failed: Name or service    not known

Filename: config/database.php

Line Number: 67

A PHP Error was encountered

Severity: Warning

Message: mysql_connect(): [2002] php_network_getaddresses: getaddrinfo failed: Name or     service not known (trying to connect via tcp://myhost.com:3306)

Filename: config/database.php

Line Number: 67

A PHP Error was encountered

Severity: Warning

Message: mysql_connect(): php_network_getaddresses: getaddrinfo failed: Name or service not known

Filename: config/database.php

Line Number: 67

Could not connect: php_network_getaddresses: getaddrinfo failed: Name or service not known 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T11:49:17.517

尝试改变这个

```
$db['default']['db_debug'] = TRUE; 
```

对此：

```
$db['default']['db_debug'] = FALSE; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:46:49.060

确保域名注册到正确的 IP 地址，并且您的主机有这个确切地址的记录。尝试在网站上放置一个静态 HTML 文件，您所需要的只是显示文本“Hello World”以确保您能够通过域名访问该网站。

确保您已在脚本中正确插入域名，并且您可以使用所需的凭据通过复制和粘贴登录到 PHPMyAdmin（或您使用的任何内容）（没有前导和尾随空格，请注意这一点）。

如果是表名有问题，应该这么说。至于其余的设置，我对其中任何一个都不熟悉，但是我在这里概述的内容应该可以让您的数据库正常工作。

祝你好运。

# vba - Excel 的独立代码

> ID：12080250
> 
> 赞同：1
> 
> 时间：2012-08-22T19:39:22.417
> 
> 标签：vba, excel

可以编写*VBA*代码来对任何*Excel*文件执行操作吗？

*当我在Visual Studio*中创建项目时，它要求将*Excel*文件链接到它。我编写的所有代码都在`ThisWorkbook.vb`其中，因此仅作用于链接到项目的*Excel文件。*

* * *

理想情况下，我想要一个脚本：

1.  当用户双击时，应该允许他/她选择一个*Excel*文件，以便在该文件上执行操作。
2.  如果上述方法不可行，我至少想从*Excel*文件中调用*VBA脚本。*

 *基本上，*VBA*代码应该独立于任何*Excel*文件。

我查看了*VBScript*，但它的语法似乎略有不同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T08:05:33.527

您提到了 Visual Studio、VBA 和 VBScript。我概述的解决方案直接使用 VBA 而不是 Visual Studio 或 VBScript。（但是，您可以按照我在下面概述的内容调整 Visual Studio（C# 或 VB）。）希望它有帮助，所以这里是：

这就是我所做的，它最终会产生一个 .xlam Excel 插件，正如上面@chris 所评论的那样。

**概述**

我从普通的 .xslx 工作簿开始，向其中添加了一个 VBA 项目，使其成为 .xlsm。然后创建一些 VBA Subs（宏）。然后为工作簿创建一些 Excel QAT（快速访问工具栏）按钮，这些按钮绑定到（即它们调用）VBA 子/宏。然后将工作簿（其中包含 VBA）转换为 .xlam，这是一个 Excel 插件。完成后，可以从任何工作簿访问按钮（并且 VBA 代码可以访问任何用户工作簿以及最初在 .xlsm 中的工作簿）。此外，与 .xlam 关联的工作簿是不可见的。所以看起来您已经向 QAT 添加了一些按钮，这些按钮出现在所有用户 .xlsx 窗口上。.xlam 对用户来说很容易安装（尽管我提供了一个按钮来卸载/重新安装/检查版本）。您可以独立于用户的工作簿升级 .xlam；

**细节**

*写一些你以后想用的 Excel Subs*

您需要注意，按钮只能在没有参数的情况下调用宏（VBA Subs），因此宏必须检查 ActiveSheet 和 ActiveWorkbook 和 Selection 等内容，以确定按下按钮的工作表，从而真正操作哪些用户数据在。（如果您需要参考您的包含 VBA 代码的工作簿，请使用“ThisWorkbook”）。您应该知道可能存在命名冲突，因此请尝试使用较长的名称命名无参数的 subs，例如 MySomewhatUniqueProjectName_button1 等...</p>

*将按钮添加到您的 .xlsm*

使用 Excel 2010（我认为这适用于 2007 或更高版本），我将特定于工作簿的按钮放在功能区的 QAT 部分，这些按钮连接到 VBA 代码中的宏（VBA 子程序）。

为此，您从快速访问工具栏自定义下拉菜单（Excel 窗口最顶行的小向下箭头，从左到右的最后一个图标）选择“更多命令...”。当“自定义快速访问工具栏”对话框出现时，从（第二个）“自定义快速访问工具栏：”标题（右上），从下拉列表中选择“对于 XYZ.xlsm”，而不是“对于所有文档” （默认）”。在“Choose Commands From:”下，使用下拉菜单中的“Macros”（而不是“Popular Commands”）。一旦你选择了这两个东西，你可以使用“Add >>”将 VBA subs 从左框移动到右框。每个如此移动的按钮都将成为您的 QAT 中可见的按钮。在执行此操作时，您还可以编辑按钮的图标和文本，根据需要添加分隔符（如果其他 .xlam 使用 QAT，我总是以分隔符结尾）。（现在是保存此 .xlsm 的好时机。）

*将 .xlsm 转换为 .xlam*

然后我将 .xlsm 转换为 Excel 加载项，只需将其保存为 .xlam 文件即可。这将最终 (1) 隐藏与您拥有的代码关联的工作簿（尽管它本身仍然可以访问。）。此外，现在，（2）（不可见，因为现在它是一个 .xlam）工作簿将在加载 Excel 时加载。（为了在用户使用 Excel 但不运行我的 VBA 代码时保持这种速度，我在加载 .xlam 时不运行任何代码，我只在按下按钮时运行代码。）您可以使用Excel 的插件管理器。要更新 AddIn，您必须使用一些技巧。虽然您可以在 Excel 未运行时复制它，但另一方面，您不能直接卸载 AddIn，您只能从 Excel 中将其禁用。但是一旦禁用，您可以删除 .xlam，然后重新启动 Excel，去插件管理器尝试使用（现已消失的）插件，你会得到 Excel 说它找不到它，所以你想删除它。说是，它将被卸载。

**仅供参考，注意事项**

我保留 .xlsm 以供以后编辑，但您实际上可以调试和编辑 .xlam，然后通过一些小技巧将其转换回 .xlsm：在 VBA 中找到它的“ThisWorkbook”条目，然后找到“IsAddIn”属性，设置为false，它的工作簿会突然出现，你可以保存为.xlsm，或者编辑它的工作簿并将属性设置回true，直接重新保存为.xlam。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T03:49:09.307

### 答案 1

你也可以在 VB.Net 中做到这一点。做一个常规项目。（@SLaks[评论）](https://stackoverflow.com/questions/12080250/standalone-code-for-excel/12295577#comment16138849_12080250)

这对我很有用，正是我想要的。

### 答案 2

@ErikEidt 发布的非常具有描述性的[答案](https://stackoverflow.com/a/12295577/640378)

我还没有尝试过，但这似乎是一种让宏工作的好方法。*

# javascript - 需要在加载时滑入标题

> ID：12080255
> 
> 赞同：0
> 
> 时间：2012-08-22T19:39:41.317
> 
> 标签：javascript, header, slider

我正在一个网站上工作，并希望在页面的其余部分加载后，标题从顶部滑入页面。有人能帮忙吗？谢谢

网站位于choptlogic.com/atmananda pw 123

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:00:17.337

正如 Chris Moutray 在他对您的问题的评论中所建议的那样，理想的解决方案是使用 jQuery 及其动画之一，例如：

```
$(function() {
    // When document is ready show the header using slideDown
    // See http://api.jquery.com/slideDown/
    $("#myHeader").slideDown(1000, function() {
        // Animation complete callback
    });
});​ 
```

为了说明，我只是做了一个简单的例子来说明如何使用 jQuery 和`slideDown`动画来完成这种效果 - 例子放在这个 jsFiddle：http: [//jsfiddle.net/WAQLz/](http://jsfiddle.net/WAQLz/)

参考资料：[http ://api.jquery.com/slideDown/](http://api.jquery.com/slideDown/)

# batch-file - 按文件类型从子目录复制到单个文件夹？

> ID：12080257
> 
> 赞同：0
> 
> 时间：2012-08-22T19:39:49.270
> 
> 标签：batch-file, robocopy

我在嵌套子文件夹中有大量 PNG。我想将它们全部复制到一个目标文件夹中。我有很多这样的事情要做。

使用`robocopy [sourcefolder] [destfolder] *.png /s`也会复制子文件夹，这是我不想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T06:55:39.167

您可以使用 for 循环来完成此操作：

```
for /f %%d in ('dir %sourcefolder% /b /ad') do (
    robocopy %sourcefolder%\%%d %destfolder% *.png /s
) 
```

请注意，这只适用于一级子文件夹，如果有更多，则必须使用嵌套的 for 循环。看起来像这样：

```
for /f %%d in ('dir %sourcefolder% /b /ad') do (
    robocopy %sourcefolder%\%%d %destfolder% *.png /s

    for /f %%e in ('dir %sourcefolder%\%%d /b /ad') do (
        robocopy %sourcefolder%\%%d\%%e %destfolder% *.png /s
    )
) 
```

请记住，每个 for 循环都必须有自己的变量（例如`%%d`or `%%e`）。如果您有许多级别的子文件夹，这可能会有点麻烦，那么我会考虑切换到另一种脚本语言。

# javascript - 使用 node.js 和 express 处理一个 POST 请求

> ID：12080260
> 
> 赞同：0
> 
> 时间：2012-08-22T19:39:55.973
> 
> 标签：javascript, http, node.js, post, express

我是学习 AJAX 和 Web 开发的新手，我无法让我的本地服务器和远程服务器处理发布请求。我正在使用 node.js 和 express 模块。

这是我的服务器的代码：

```
var express = require('express');

//start server
var app = express.createServer();

//handle requests
app.post('/hello', function(req, res){
    res.send("hello");
});

app.listen(8888); 
```

很基本，我知道。为了对此进行测试，我通过 Chrome 中的控制台手动创建了一个 XMLHttpRequest（我已禁用跨域策略以在本地计算机上进行测试）：

```
var xhr = new XMLHttpRequest();
xhr.open('POST', 'localhost:8888/hello', true);
xhr.send('name=me'); //body of request is irrelevant at this point 
```

当我将请求发送到我的本地机器时，它立即返回并说它失败了。当我将请求发送到我的远程服务器（其中**localhost**被我的服务器的 IP 替换）时，我在控制台中没有收到错误消息，但是当我检查 xhr 对象的状态时失败。

我不知道问题是我的服务器的编写方式，还是我向服务器发送请求的方式。但是，我一直在查看显示像上面那样快速处理 post 请求的教程和示例，以及显示像上面那样发送 POST 请求的其他教程。

发送和处理 GET 请求似乎工作正常。我肯定错过了什么。

谢谢，夏安。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:38:10.370

You need to include HTTP in your URL when you issue the POST:

```
xhr.open('POST', 'http://localhost:8888/hello', true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:45:04.813

如果调用 js 不是由网络服务器提供服务，则 XHR 不起作用。

你应该做的是在你的 Express 服务器上添加一个简单的路由

```
app.get('/', function( req, res) {
  res.sendfile('index.html');
}) 
```

其中 index.html 包含您的测试代码。

如果您想从不同的网络服务器进行测试并遇到烦人的跨域策略，您还可以使用这个超级有用的命令在当前文件夹中生成一个网络服务器：

```
python -m SimpleHTTPServer 
```

我经常使用它，以至于我实际上给它起了别名：

```
alias www='python -m SimpleHTTPServer' 
```

# linux - 使用 sed 或 awk 解析多路径输出

> ID：12080265
> 
> 赞同：6
> 
> 时间：2012-08-22T19:40:09.293
> 
> 标签：linux, bash, sed, awk

我正在尝试为我正在编写的脚本解析 linux 上的多路径输出，但我找不到正确的 SED 或 AWK 语法来获得我想要的。我一直在浏览各种网站和 stackoverflow 示例，但运气不佳。

我想找到一种方法来制作：

```
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN
[size=20G]
2:0:0:4  sde        8:64  [active][ready]
1:0:0:4  sdm        8:192 [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN
[size=5.0G]
2:0:0:3  sdd        8:48  [active][ready]
1:0:0:3  sdl        8:176 [active][ready] 
```

看起来像：

```
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 2:0:0:4  sde        8:64  active][ready]
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 1:0:0:4  sdm        8:192 [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 2:0:0:3  sdd        8:48  [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 1:0:0:3  sdl        8:176 [active][ready] 
```

** 编辑 好吧，让这变得更加困难，我发现没有 Netapp 的默认设置的多路径配置。这使得 NETAPP,LUN 不能保证在线。我已经开始做的事情：

```
/sbin/multipath -ll | grep -v "round-robin"| sed 's/\[feat.*//g' | sed ':a; $!N;s/\n\([^\n]*\[size\)/ \1/;ta;P;D' 
```

它将 size 放在主线上，给我其他匹配的东西：

```
360a98000572d4d2d5834664e68323436 dm-6 NETAPP,LUN [size=50G]
\_ 1:0:0:0  sda 8:0   [active][ready]
360a98000572d4d2d5834664e68395951 dm-7 NETAPP,LUN [size=275G]
\_ 1:0:0:7  sdb 8:16  [active][ready] 
```

但是，我无法获得以下任何示例来匹配“G [$”（我知道如果有任何 TB 卷，我将需要为 T 再添加一行）并给我正确的输出。

感谢以下大家的建议**结束编辑

我知道如何清理间距，所以在我得到正确的输出后我会这样做。将开始多路径信息的行都以“LUN”结尾。服务器在每个 LUN 行（sdx 设备）下可以有 1 到 8 个路径。“()”之前的部分可以是文本（别名）或数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:04:15.643

单程：

内容`script.awk`：

```
$1 ~ /^([[:digit:]]:){3}[[:digit:]]$/ {
    printf "%s %s\n", line, $0; 
    next;
}

##$1 ~ /temp|redo/ {
$0 ~ /LUN$/ {
    getline l;
    line = $0 " " l;
} 
```

假设`infile`问题的内容，运行如下脚本：

```
awk -f script.awk infile 
```

具有以下输出：

```
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 2:0:0:4  sde        8:64  [active][ready]                                                                                                                                
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 1:0:0:4  sdm        8:192 [active][ready]                                                                                                                                
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 2:0:0:3  sdd        8:48  [active][ready]                                                                                                                               
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 1:0:0:3  sdl        8:176 [active][ready] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T05:47:06.380

这可能对您有用（GNU sed）：

```
sed '/LUN$/{N;y/\n/ /;h;d};G;s/^\([^\n]*\)\n\(.*\)/\2 \1/' file 
```

解释：

*   `/LUN$/{N;y/\n/ /;h;d}`对于以`LUN`追加换行符和下一行到模式空间 (PS) 结尾的行，用空格替换换行符，将 PS 存储在保持空间 (HS) 中，然后删除 PS 并为下一个循环加注星标。
*   `G`对于所有其他行（路径行），添加一个换行符，后跟 PS 中 HS 的内容。
*   `s/^\([^\n]*\)\n\(.*\)/\2 \1/`将任何内容交换到第一个换行符之后的任何内容，并用空格替换换行符，即将标题信息附加到路径行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:00:30.727

我不知道输入的确切规范，但这个单行可能会帮助你：

`awk '{if (/LUN$/){ prefix = $0; getline; prefix = prefix " " $0 } else {print prefix, $0} }'`

1.  它检查当前行是否以 LUN 结尾（通过将其与正则表达式匹配`/LUN$/`）
2.  如果匹配，它将当前行与下一行连接（使用`getline`和隐式连接运算符）
3.  如果没有匹配，则输出当前记录以及`prefix`

PS：您可能需要额外的线路过滤，这应该不难，只需`if`在`else`分支中添加另一个即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T11:20:37.350

这是针对与您类似的一整类问题的通用解决方案 - 即解析跨越多行的记录集，但记录集的行数可能不同。

```
sed '/([0-9a-f]\{33\})/ i \\' input_file | \
  awk '
    BEGIN {RS=""; FS="\n"}
    {for(i=3; i<=NF; i++) {print $1,$2,$i}}
  ' 
```

给

```
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 2:0:0:4  sde        8:64  [active][ready]
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 1:0:0:4  sdm        8:192 [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 2:0:0:3  sdd        8:48  [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 1:0:0:3  sdl        8:176 [active][ready] 
```

* * *

### 该溶液的性质

*   标识十六进制摘要上的记录
*   处理 1+ 路径
*   易于扩展以在 awk 中实现进一步的逻辑，因为每个多路径记录都被视为 awk 中的记录

### 解释

想象一下您的输入数据如下所示：

```
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN
[size=20G]
2:0:0:4  sde        8:64  [active][ready]
1:0:0:4  sdm        8:192 [active][ready]

redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN
[size=5.0G]
2:0:0:3  sdd        8:48  [active][ready]
1:0:0:3  sdl        8:176 [active][ready] 
```

这很容易用 awk 解析。
你只会告诉 awk ..

1.  每条记录由一个空行分隔
2.  每个字段本身应该只是一整行
3.  然后，为了您想要的结果，打印组合“第一行，第二行，第 i 行”，直到所有行（字段）都用完

这正是上面的 awk 代码正在做的事情：
该行`BEGIN {RS=""; FS="\n"}`设置记录 sep。到空行和字段 sep。换行。
然后这条线`{for(i=3; i<=NF; i++) {print $1,$2,$i}}`完全符合我之前在 3.. 下概述的内容。

**你现在需要的只是引入空白行来分隔你的记录**
对于这个任务我使用 sed。我只需要一个锚来发现之前引入空白行的行。这里我使用**括号中的十六进制摘要**。我假设它总是 33 个字符长。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T02:58:48.120

由于多路径的性质，一个 LUN 可以有 1 个以上的路径，而不仅仅是两个。所以 getline() 可能处于一个丑陋的循环中。这是一个清晰的 awk 版本。您需要考虑的只是如何标记 LUN 线、SIZE 线和 PATH 线。

```
awk '/\(.*\)/ {lu=$0} /^\[size/ {size=$0} $2 ~ /sd/ {print lu, size, $0}' 
```

但是 multipath -l 可以包含更复杂的信息，例如策略、参数等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-22T19:59:03.080

使用 sed：

```
sed -n '
  # if this is header append the size line
  /LUN$/{
    N;
    s/\n/ /;
    h       # and remember this
  }; 
  # if not header then append to header
  /LUN \[/!{ 
    G; 
    s/\(.*\)\n\(.*\)/\2 \1/;
    p; #and print
  }' input_file 
```

没有评论：

```
 sed -n ' /LUN$/{ N; s/\n/ /; h  }; /LUN \[/!{ G; s/\(.*\)\n\(.*\)/\2 \1/; p; }' input_file 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-23T11:33:59.933

**编辑：**

```
awk '/\[size=.*G\]/ { array[prev]++ } { prev = $0 } FNR!=NR { if ($0 in array) { line = $0; getline; line = line FS $0; next } else { print line, $0 } }' file.txt{,} 
```

解释：

```
## file.txt{,}    
## this is bash shorthand for reading the same file twice

## { prev = $0 }
## keep track of the last line

## /\[size=.*G\]/ { array[prev]++ }
## if the 'size' pattern is found, add the previous line to an array
## now we have an array of lines to search for

## FNR!=NR
## perform the following actions on the second file only

## if ($0 in array)
## if the line is one of our lines that we're searching for

## line = $0; getline; line = line FS $0; next
## store the line, get the next line join it up and go onto the next record

## else { print line, $0 }
## otherwise print out the 'line' and subsequent data 
```

结果：

```
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 2:0:0:4  sde        8:64  [active][ready]
temp (360a98000572d4d2d5834566c64536b46) dm-4 NETAPP,LUN [size=20G] 1:0:0:4  sdm        8:192 [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 2:0:0:3  sdd        8:48  [active][ready]
redo (360a98000572d4d2d5834566c646c366c) dm-3 NETAPP,LUN [size=5.0G] 1:0:0:3  sdl        8:176 [active][ready] 
```

# sqlite - 如何与他人共享 Notepad++ 片段 (nppsnippets)

> ID：12080266
> 
> 赞同：0
> 
> 时间：2012-08-22T19:40:10.910
> 
> 标签：sqlite, notepad++

我已经使用 nppsnippets 插件设置了许多自定义片段库。我可以看到它可以在哪里导入 sqlite 文件，但如果我想让同事使用我创建的库，我看不到要共享哪些文件。

理想情况下，我想分享我创建的库的一个子集。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T02:59:25.307

这个插件在你的 %appdata%/Notepad++/plugins/config/ 文件夹中创建一个名为 NppSnippets.sqlite 的 sqlite 数据库。

当 Notepad++ 关闭时，您可以用您拥有的数据库覆盖您的 associates appdata 文件夹中的整个数据库，并且下次打开 Notepad++ 时，它会将您的库包含在他们的应用程序中。或者，您可以让他们使用 notepad++ 中的内置导入工具从您的 SQLite 数据库中导入特定的库。

# c++ - 为什么文件输入会在读取时抛出 EAGAIN？

> ID：12080272
> 
> 赞同：1
> 
> 时间：2012-08-22T19:40:45.537
> 
> 标签：c++, unix

我有一个程序从文件中读取，对输入进行一些工作，然后将其输出到套接字。它已经运行了一个多月，突然我开始收到错误 11（EAGAIN？）错误，该错误会杀死程序。当我启动该程序的 32 个实例时，在收到 EAGAIN 消息的几分钟内就有一半以上死亡。我从来没有将文件设置为非阻塞，除此之外，输入文件如何阻塞，数据总是在那里，不是吗？我对这段代码所做的唯一更改是禁用 sigpipe 信号以避免程序在套接字连接丢失时死亡。

请原谅我没有发布代码，但我无法复制和粘贴，而且代码无论如何都散布了。它实际上就像在一行上打开一个文件并稍后调用 readline(file, inputString) 一样简单。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:59:01.010

EAGAIN 表示读取已被信号中断，应重新启动。

我认为是 SIGPIPE 曾经直接杀死你的程序，现在被处理（即使处理什么也不做）。

# unit-testing - Grails 2单元测试中的元类删除域方法

> ID：12080273
> 
> 赞同：2
> 
> 时间：2012-08-22T19:40:52.267
> 
> 标签：unit-testing, grails, groovy

我正在尝试在我的单元测试中测试异常的抛出。我试图对 delete 方法进行元分类，但它不想坚持。你能从代码中看出我做错了什么吗？

单元测试代码：

```
@TestFor(ProductController)
@TestMixin(DomainClassUnitTestMixin)
class ProductControllerTests {     
  void testDeleteWithException() {
    mockDomain(Product, [[id: 1, name: "Test Product"]])
    Product.metaClass.delete = {-> throw new DataIntegrityViolationException("I'm an       exception")}
    controller.delete(1)
    assertEquals(view, '/show/edit')
} 
```

控制器动作代码：

```
def delete(Long id) {
    def productInstance = Product.get(id)
    if (!productInstance) {
        flash.message = message(code: 'default.not.found.message', args: [message(code: 'product.label', default: 'Product'), id])
        redirect(action: "list")
        return
    }

    try {
        productInstance.delete(flush: true)
        flash.message = message(code: 'default.deleted.message', args: [message(code: 'product.label', default: 'Product'), id])
        redirect(action: "list")
    }
    catch (DataIntegrityViolationException e) {
        flash.message = message(code: 'default.not.deleted.message', args: [message(code: 'product.label', default: 'Product'), id])
        redirect(action: "show", id: id)
    }
} 
```

当我运行测试时，`productInstance.delete(flush: true)`不会抛出我期望的异常。相反，它重定向到`action: "list"`. 有谁知道如何覆盖 Product.delete() 方法以便我可以强制异常？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T19:50:58.253

您正在嘲笑`delete`没有任何参数，但您的控制器调用`delete(flush: true)`. 尝试`delete(Map)`像这样模拟：

```
Product.metaClass.delete = { Map params -> 
    throw new DataIntegrityViolationException("...")
} 
```

# python - 解析嵌套条件语句

> ID：12080277
> 
> 赞同：2
> 
> 时间：2012-08-22T19:41:02.940
> 
> 标签：python, regex, conditional-compilation

我需要解析一个包含条件语句的文件，有时会相互嵌套。

我有一个存储配置数据的文件，但配置数据根据用户定义的选项略有不同。我可以处理条件语句，它们都只是没有操作的布尔值，但我不知道如何递归地评估嵌套条件。例如，文件的一部分可能如下所示：

```
...
#if CELSIUS
    #if FROM_KELVIN ; this is a comment about converting kelvin to celsius.
        temp_conversion = 1, 273
    #else
        temp_conversion = 0.556, -32
    #endif
#else
    #if FROM_KELVIN
        temp_conversion = 1.8, -255.3
    #else
        temp_conversion = 1.8, 17.778
    #endif
#endif
... 
```

...另外，一些条件句没有`#else`语句，只是`#if CONDITION statement(s) #endif`.

我意识到如果文件只是用 XML 或其他带有一个很好的解析器的东西编写的，这可能很容易，但这是我必须使用的，所以我想知道是否有任何相对简单的方法来解析这个文件. 它类似于括号匹配，所以我想会有一些模块，但我没有找到任何东西。

我正在使用 python，但如果用另一种语言更容易解决这个问题，我可以切换到这个功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T20:47:09.887

这是此语法的简单递归解析器：

```
def parse(lines):
    result = []
    while lines:
        if lines[0].startswith('#if'):
            block = [lines.pop(0).split()[1], parse(lines)]
            if lines[0].startswith('#else'):
                lines.pop(0)
                block.append(parse(lines))
            lines.pop(0) #endif
            result.append(block)
        elif not lines[0].startswith(('#else', '#endif')):
            result.append(lines.pop(0))
        else:
            break
    return result

tree = parse([x.strip() for x in your_code.splitlines() if x.strip()]) 
```

从您的示例中，它创建了以下树结构：

```
[['CELSIUS',
  [['FROM_KELVIN',
    ['temp_conversion = 1, 273'],
    ['temp_conversion = 0.556, -32']]],
  [['FROM_KELVIN',
    ['temp_conversion = 1.8, -255.3'],
    ['temp_conversion = 1.8, 17.778']]]]] 
```

这应该很容易评估。

对于更高级的解析，请考虑可用于 Python的众多[解析工具之一。](http://nedbatchelder.com/text/python-parsers.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:58:49.637

由于所有条件都是二进制的，并且我事先知道所有条件的值（无需像编程语言那样按顺序评估它们），我可以使用正则表达式来完成。这对我来说效果更好。它找到最低级别的条件（没有嵌套条件的条件），评估它们并用正确的内容替换它们。然后重复更高级别的条件等等。

```
import re

conditions = ['CELSIUS', 'FROM_KELVIN']

def eval_conditional(matchobj):
    statement = matchobj.groups()[1].split('#else')
    statement.append('') # in case there was no else statement
    if matchobj.groups()[0] in conditions: return statement[0]
    else: return statement[1]

def parse(text):
    pattern = r'#if\s*(\S*)\s*((?:.(?!#if|#endif))*.)#endif'
    regex = re.compile(pattern, re.DOTALL)
    while True:
        if not regex.search(text): break
        text = regex.sub(eval_conditional, text)
    return text

if __name__ == '__main__':
    i = open('input.txt', 'r').readlines()
    g = ''.join([x.split(';')[0] for x in i if x.strip()])
    o = parse(g)
    open('output.txt', 'w').write(o) 
```

给定原始帖子中的输入，它输出：

```
...
        temp_conversion = 1, 273

... 
```

这就是我需要的。感谢大家的回复，非常感谢您的帮助！

# python - 如何创建包含 24 位整数的 Numpy dtype？

> ID：12080279
> 
> 赞同：7
> 
> 时间：2012-08-22T19:41:06.497
> 
> 标签：python, numpy

我有一个二进制文件，其记录结构为 400 个 24 位有符号大端整数，后跟一个 16 位大端有符号短整数。我想做的是：

```
from numpy import dtype , fromfile
record_dtype = dtype([('samples','>i3',(400,)),('marker','>i2')])
data = fromfile('binary_file.dat',dtype=record_dtype) 
```

不幸的是，我得到的是：

```
TypeError: data type not understood 
```

响应“> i3”。如何定义 dtype 以读取 24 位二进制数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-12-07T07:08:26.457

我有一个 TB 的文件，它是 24 位四通道 PCM。

除了一次想要的部分，我当然不想碰任何其他东西，所以我所做的是这样的：

```
import numpy as np
from numpy.lib.stride_tricks import as_strided

rawdatamap = np.memmap('4ch24bit800GBdatafile.pcm', dtype=np.dtype('u1'),mode='r')

# in case of a truncated frame at the end
usablebytes = rawdatamap.shape[0]-rawdatamap.shape[0]%12

frames = int(usablebytes/12)
rawbytes = rawdatamap[:usablebytes]

realdata = as_strided(rawbytes.view(np.int32), strides=(12,3,), shape=(frames,4))

someusefulpart = realdata[hugeoffset:hugeoffset+smallerthanram]&0x00ffffff 
```

这从文件中复制了一个`smallerthanram`字节长的内存。

注意字节掩码！您需要它来切断 32 位字的最高有效字节 - 这将是属于前一个样本的垃圾。

您也可以将其应用于单个数据，如下所示：

```
scaled_ch2_datum_at_framenum = scalefactor*(realdata[framenum,1]&0x00ffffff)-shiftoffset 
```

它有点乱，但现在已经很好了。

您实际上可能需要 64 位系统来执行此操作。

注意。这适用于小端数据。要处理大端，您将在视图中使用大端 dtype，并替换`...&0x00ffffff`为`...&ffffff00>>8`

# javascript - 使用 javascript 或 JQuery 在 HTML 中删除当前分区的按钮

> ID：12080289
> 
> 赞同：1
> 
> 时间：2012-08-22T19:41:59.933
> 
> 标签：javascript, jquery, html, removeclass

我制作了一个带有添加按钮的动态表单，该按钮使用表单的克隆创建一个新的分区，但具有不同的 ID。但是，我还希望每个分区都有一个删除按钮，可以删除它所在的分区，包括按钮本身。

我熟悉 JQuery`.remove()`方法，但在选择按钮所在的分区时遇到问题。

```
<div id="attendees">
        <div id="att1" class="attendee">
            <form name="droplist" action="html_form_action.asp" method = "get">
                <fieldset>
                    <legend><span class="legend">Filter</span></legend>
                    <label for="select">Category: </label>
                    <select id="select" size="1"  >
                        <option value=" " selected="selected"> </option>
                        <option value="employees">Number of Employees</option>
                        <option value="hits">Hits on TechCrunch</option>
                        <option value="time_founded">Time Founded</option>
                        <option value="total_money">Total Money</option>
                    </select>

                    <div id='radioContainer' style="display:block;">
                        <input type="radio" id="condition"  name="button" value="more"/> <label for="condition"> > </label></br>
                        <input type="radio" id="condition1"  name="button" value="less"/> <label for="condition1"> < </label>
                    </div>

                    <div id='radioContainerTime' style="display:block;">
                        <input type="radio" id="condition2"  name="button" value="later"/> <label for="condition"> After </label></br>
                        <input type="radio" id="condition3"  name="button" value="earlier"/> <label for="condition1"> Before </label>
                    </div>

                    <div id = "text_box" style="display:block;">
                        <label for="input_value">Amount: </label>
                        <input type="text" id="box" name="input_value" value="textIn" />
                    </div>
                    <button>remove</button>
                </fieldset>
            </form>
        </div>
        <a href="#" class="add">Add more</a>
</div>​ 
```

到目前为止，我的 JavaScript 是这样的：

```
$(function(){
 var template = $('#attendees .attendee:first').clone(),
     attendeesCount = 1;

 var addAttendee = function(){
     attendeesCount++;
     var attendee = template.clone().find(':input').each(function(){
         var newId = this.id.substring(0, this.id.length-1) + attendeesCount;
         $(this).prev().attr('for', newId); // update label for (assume prev sib is label)
         this.name = this.id = newId; // update id and name (assume the same)
     }).end() // back to .attendee
     .attr('id', 'att' + attendeesCount) // update attendee id
     .prependTo('#attendees'); // add to container
 };

 $('.add').click(addAttendee); // attach event
 }); 

$("button").click(function () {
  $this.remove();
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:46:45.740

要删除`<div class="attendee">`包含按钮的，你可以使用这个：

```
$("button").click(function () {
     $(this).closest(".attendee").remove();
     return(false);
}); 
```

这将从单击的按钮中查找父链以找到带有 a 的第一部分，`class="attendee"`然后将其删除。

* * *

仅供参考，我强烈建议在您的删除按钮上放置一个类，因为连接到页面中的所有按钮有点危险。

要将类放在删除按钮上，请将 HTML 更改为：

```
<button class="deleteButton">remove</button> 
```

并且，将 jQuery 更改为：

```
$(".deleteButton").click(function () {
     $(this).closest(".attendee").remove();
     return(false);
}); 
```

这`return(false)`可以防止表单中的任何默认操作基于点击发生。

# javascript - 用于更改可见性的 Javascript 和 PHP 单选按钮

> ID：12080290
> 
> 赞同：1
> 
> 时间：2012-08-22T19:42:02.540
> 
> 标签：javascript, php, mysql, dom-events

我正在努力解决问题。它分为两部分：

1.  我想创建一个循环，从数据库中读取我的每个页面的 menu_name，并在读取它的同一行上，放置一个单选按钮来更改可见性。到目前为止，看起来我的单选按钮都已连接，因为（而不是为每个单选按钮检查“否”，而只在最后`<li>`一项上检查否：

    ```
     //K's function:
     function get_all_pages() {
         global $connection;
         $query = "SELECT * 
             FROM pages ";
         $query .= "WHERE visible = 1 ";
         $query .= "ORDER BY position ASC";
         $page_set = mysql_query($query, $connection);
         confirm_query($page_set);
         return $page_set;
     }

     //K's function:
     function list_all_pages(){
         $output = "<ul>";
         $page_set = get_all_pages();
         while ($page = mysql_fetch_array($page_set)) {
             $output .= "<li><a href=\"add_feature.php?page=" . urlencode($page["id"]) . "\">{$page["menu_name"]}</a></li>";
             $output .= "&nbsp;&nbsp;<input type=\"radio\" name=\"visible\" value=\"0\" checked=\"checked\" /> No <input type=\"radio\" name=\"visible\" value=\"1\" /> Yes";
         }
         $output .= "</ul>";
         return $output;
     } 
    ```

![问题#1的图片](../Images/b1ea0b90b130feacb781ab91ba53babe.png)

2.  我正在尝试用 Javascript 做一些 ajax 的事情。所以我希望可见的单选按钮在我动态生成的菜单列表旁边。我希望他们都被检查为否...当他们被检查为是时，我希望出现一个下拉列表，他们可以在其中选择数字 1-8（数字将表示它们将出现在什么位置）。

我是新手，如果没有 Javascript 和 php/mysql 专家的帮助，我想弄清楚这一点有点遥不可及。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T19:47:03.963

您的单选按钮都具有相同的“名称”属性，因此您一次只能选择一个。您可以将一些唯一标识符附加到属性值。例如`visible_{$page_id}`：

```
function list_all_pages(){
    $output = "<ul>";
    $page_set = get_all_pages();
    while ($page = mysql_fetch_array($page_set)) {
        $page_id = urlencode($page["id"]);
        $output .= "<li><a href=\"add_feature.php?page={$page_id}\">{$page["menu_name"]}</a></li>";
        $output .= "&nbsp;&nbsp;<input type=\"radio\" name=\"visible_{$page_id}\" value=\"0\" checked=\"checked\" /> ";
        $output .= "No <input type=\"radio\" name=\"visible_{$page_id}\" value=\"1\" /> Yes";
    }
    $output .= "</ul>";
    return $output;
} 
```

高级提示：使用 PHP，您可以通过使用特殊格式的输入名称来简化“页面”数据的处理——如下所示：

*   让单选按钮使用类似的名称`pages[$page_id][visible]`。
*   让列表（又名[select](http://www.w3schools.com/tags/tag_select.asp)）使用类似`pages[$page_id][order]`.

一旦用户提交了这些数据，PHP 会将其转换为“pages”数组（索引为 page_id）。然后，您可以执行以下操作：

```
function process_pages($pages) {
  foreach ($pages as $page_id => $data) {
     $is_visible = $data['visible'] === '1';
     $page_order = (int) $data['order'];
     //... update page's visibility/page order
  }
}
$pages = $_REQUEST['pages'];
process_pages($pages); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:01:10.813

1\. 更改每个单选按钮的名称属性以断开它们，例如使用 visible1, visible2, ...

2\. 将 <input> 标签放在 <li> 中，放在 <a> 标签之后。这将在您动态生成的菜单旁边显示您的单选按钮。

3.您可以通过创建和调用将通过单击是选项执行的javascript函数来创建数字选择列表，这将创建并显示选择字段。

如果您需要更多说明，请对答案发表评论。

# scala - 使用 SBT 在多项目构建中重用设置

> ID：12080291
> 
> 赞同：1
> 
> 时间：2012-08-22T19:42:04.893
> 
> 标签：scala, playframework-2.0, sbt

我正在使用播放！2.0 和我有一个关于构建系统的问题。我有多个项目的聚合，并且我有一个共享模块，其中包含静态文件和一些被编译成 css 的 .less 文件。

如何将静态文件以及已编译样式表的输出复制到其他项目中？我试图自己理解，但看起来，虽然我可以轻松地将设置应用于项目，但我无法从另一个项目中检索该设置。

我看过剧！2.0键

```
val playAssetsDirectories = SettingKey[Seq[File]]("play-assets-directories")

val incrementalAssetsCompilation = SettingKey[Boolean]("play-incremental-assets-compilation")

val playExternalAssets = SettingKey[Seq[(File, File => PathFinder, String)]]("play-external-assets") 
```

但我不知道如何使用这些信息来修改我的构建文件。

```
object ApplicationBuild extends Build {

    val appName         = "Website"
    val appVersion      = "1.0-SNAPSHOT"

    val appDependencies = Seq(
      // Add your project dependencies here,
    )

    val common = PlayProject(
        appName + "-common", appVersion, path = file("modules/common"),mainLang=SCALA,
    lessEntryPoints <<= baseDirectory(_ / "app" / "assets" / "stylesheets" ** "bootstrap.less")
    )

    val website = PlayProject(
        appName + "-website", appVersion, path = file("modules/website"),mainLang=SCALA,

    ).dependsOn(common)

    val adminArea = PlayProject(
        appName + "-admin", appVersion, path = file("modules/admin"),mainLang=SCALA,

    ).dependsOn(common)

    val main = PlayProject(
        appName, appVersion,appDependencies,mainLang=SCALA
    ).dependsOn(
        website, adminArea
    )
} 
```

我基本上想说的是：

```
website.playExternalAssets += common.playAssetsDirectory(IncludingCompiled) 
```

但这显然是不合法的。

我其实理解多了一点，下面的代码似乎几乎是对的：

```
 val website = PlayProject(
        appName + "-website", appVersion, path = file("modules/website"),mainLang=SCALA

    ).dependsOn(common).settings(playExternalAssets <<= common.playAssetsDirectory(IncludingCompile)) 
```

除了 common.playAssetsDirectory 不起作用：

```
[info] Loading project definition from G:\project1\project [error] G:\project1\project\Build.scala:26: value playAssetsDirectory is not a member of sbt.Project [error]         ).dependsOn(common).settings(playExternalAssets <<= common.playA ssetsDirectory(IncludingCompile)) [error]                              ^ [error] one error found [error] {file:/G:/project1/project/}default-436781/compile:compile: Compilati on failed 
```

看起来这里的问题是键是常量值而不是项目的属性。事实上，键是在 PlayKeys 中定义的常量全局值，所以我实际上需要指定范围但我不知道如何

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T13:00:30.843

啊，题目误导了我。你不想分享设置，你想复制东西。您可以依赖其他项目，这将使您可以使用它们的 JAR —— 然后可以使用 getResource 检索资源。

AFAIK，你不能依赖项目根目录之外的任何东西——包括其他项目的文件。

从那时起，您将需要一项任务。您可以有一个任务从 jar 中解压缩数据并将其复制到适当的位置。

您还可以研究[复制事物的任务](https://stackoverflow.com/questions/9713483/copying-files-to-new-directory-in-sbt)，这可能会提供替代方案。

# boot - update-rc.d 和 init.d 依赖项

> ID：12080294
> 
> 赞同：7
> 
> 时间：2012-08-22T19:42:18.140
> 
> 标签：boot, rc, init.d

所以我正在尝试编写一些满足 LSB 的 init.d 脚本，以便它们在启动和关闭时正常运行。不幸的是，我在使用 LSB/update-rc.d 来满足依赖关系时遇到了问题。

```
# Required-Start: $network $local_fs hadoop-namenode hadoop-datanode zookeeper-server
# Required-Stop:  $network $local_fs hadoop-namenode hadoop-datanode zookeeper-server
# Default-Start:  2 3 4 5
# Default-Stop:   0 1 6 
```

但是，当我运行 update-rc.d defaults 时，它只会生成所涉及的默认值，其开始时间与已经存在的依赖项完全相同，这非常糟糕。我是否缺少 update-rc.d 或 LSB 来配置它？

如果相关，这是 Ubuntu 12.04

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-20T02:13:22.057

要使您的脚本在启动序列中稍后运行，只需在以下命令中添加一个序列号，如*98 。*然后将满足大多数依赖项。

曾经，我不得不使用依赖于其他引导脚本的引导脚本。这带来了很多麻烦。最后我用这个命令解决了这个问题：

```
cd /etc/init.d
sudo update-rc.d my_script defaults 98 
```

*98*表示在`my_script`启动时获得序列号 98，看起来它的范围从 1 到 99，并且大多数其他启动脚本的数字较小，这确保我的脚本已准备好所有依赖项。

顺便说一句，要删除旧脚本，可以使用：

```
sudo update-rc.d -f my_old_script remove
# -f means 'force' 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-30T12:57:55.813

这种方法不再适用于某些系统（例如 Debian Squeeze）。该数字被忽略，没有任何解释。首选方法是：[http ://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/initscrcomconv.html](http://refspecs.linuxbase.org/LSB_3.1.1/LSB-Core-generic/LSB-Core-generic/initscrcomconv.html)

查看“Required-Start:”脚本声明。

# velocity - 在独立应用程序中使用 Velocity 的 GenericTools 的更好方法？

> ID：12080299
> 
> 赞同：1
> 
> 时间：2012-08-22T19:42:41.167
> 
> 标签：velocity

我想在独立应用程序中使用 VelocityTool 的 GenericTools 进行一些标准格式。例如，在我的 Velocity 模板中有这样的东西来使用 GenericTools 的 NumberTool 格式化程序：

```
Total: $numberTool.format("#0.00", $totalPnL) 
```

如何将上述“$numberTool”与 GenericTool NumberTool 关联起来。这是我的速度代码：

```
Velocity.init();
VelocityContext velocityContext = new VelocityContext();
Template template = Velocity.getTemplate("example.vm");
velocityContext.put("totalPnL", 100);
StringWriter sw = new StringWriter();
template.merge(velocityContext, sw); 
```

现在我知道我可以这样做来让它工作：

```
velocityContext.put("numberTool", new NumberTool()); 
```

但这就是我需要将所有 GenericTools 添加到我的应用程序的方式吗？手动和一次一个（例如 DateTool 的另一行......等）？没有办法让所有 GenericTools 暴露给我的模板吗？我知道 VelocityTools 附带了一个“tools.xml”，它定义了 GenericTools。我可以将其添加到我的应用程序以公开所有工具吗？如果是这样，怎么做？

谢谢，大卫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T19:08:40.370

[http://velocity.apache.org/tools/devel/javadoc/org/apache/velocity/tools/ToolManager.html](http://velocity.apache.org/tools/devel/javadoc/org/apache/velocity/tools/ToolManager.html)

[http://velocity.apache.org/tools/devel/standalone.html](http://velocity.apache.org/tools/devel/standalone.html)

默认工具配置已经提供了所有通用工具。如果你想配置这些工具，你可以创建一个配置。甚至可以自动加载配置或手动规范。

```
 ToolManager tm = new ToolManager();
   tm.setVelocityEngine(yourVelocityEngine);
   Context context = tm.createContext(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T14:58:08.970

至少我也是这样做的。我举个例子

```
context.put("esc", new EscapeTool()); 
```

然后在模板中我简单地使用

```
${esc.h} 
```

在代码中写一个“#”，以便 Velocity 不会将其解析为“velocity-script”。

我认为那些辅助工具相当实用，只涵盖一些基本标志。它们不打算成为标准，您可以按需包含它们。

例如，我构建了一个抽象类，它加载速度的上下文并将 EscapeTool 始终放入上下文中，这样我就不必在任何地方添加它。

祝你的项目好运

塞巴斯蒂安

# php - preg_replace 简码

> ID：12080303
> 
> 赞同：0
> 
> 时间：2012-08-22T19:42:52.767
> 
> 标签：php, preg-replace

嗨，我有一个小插件系统，我使用这个短代码，例如：{google}stackoverflow{/google}

我希望它用指向谷歌搜索链接的链接替换该部分，在这种情况下：stackoverflow

我该怎么做？我有这个，但它不起作用：

```
preg_replace('#{google}([^{]+){/google}#i', '<a href="http://www.google.com?s=$1">$1</a>', $content); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:46:18.917

您需要转义大括号，即使用`\{`and `\}`。

```
preg_replace('#\{google\}([^{]+)\{/google\}#i', '<a href="http://www.google.com?s=$1">$1</a>', $content); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:46:56.750

这里的关键是使用非贪婪运算符，并转义所有内容。

```
preg_replace('#\{google\}(.*?)\{/google\}#i','<a href="http://www.google.com?s=$1">$1</a>', $content); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T19:47:22.407

您的正则表达式无效。尝试这个：

```
preg_replace('#\{google\}[^\{]+\{/google\}#i', '<a href="http://www.google.com?s=$1">$1</a>', $content); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-22T19:47:59.500

```
preg_replace('#{google}([^{]+){\/google}#i', '<a href="http://www.google.com?s=$1">$1</a>', $content); 
```

# facebook - 无法使用指定的 access_token 访问应用程序

> ID：12080305
> 
> 赞同：7
> 
> 时间：2012-08-22T19:43:09.293
> 
> 标签：facebook, facebook-php-sdk, access-token, facebook-oauth, facebook-access-token

我正在使用 Facebook 长期令牌（2 个月），但 FB 开始变得不确定，有时会给我这个回报

```
{
   "error": {
      "message": "Cannot access application using the specified access_token",
      "type": "OAuthException",
      "code": 1
   }
} 
```

我正在使用 PHP SDK。

我正在使用此链接获取 2 个月令牌 [https://graph.facebook.com/oauth/access_token?client_id=APP_ID&client_secret=APP_SECRETgrant_type=fb_exchange_token&fb_exchange_token=SHORT_TIME_TOKEN](https://graph.facebook.com/oauth/access_token?client_id=APP_ID&client_secret=APP_SECRETgrant_type=fb_exchange_token&fb_exchange_token=SHORT_TIME_TOKEN)

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-07T05:36:52.357

我遇到了这个问题，并直接从 FB 工作人员那里获得了一些支持。此错误的最可能原因是用户的“人口统计检查”。

我们的应用程序有一个年龄限制，因为它与酒精有关。某些用户的个人资料没有包含足够的信息，无法让 FB 确保他们超过其所在位置的饮酒年龄，因此会话创建失败。为什么这只发生在这个电话上而不是以前的电话上，我不知道。

您的应用程序是否有年龄限制或类似的东西？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T09:10:12.383

您的查询在 grant_type 之前缺少`&`after 。`APP_SECRET`它应该是：

```
https://graph.facebook.com/oauth/access_token?
client_id=APP_ID&
client_secret=APP_SECRET&  
grant_type=fb_exchange_token&           
fb_exchange_token=SHORT_LIVED_ACCESS_TOKEN 
```

资料来源：在 Facebook 开发人员上[扩展访问令牌。](https://developers.facebook.com/docs/howtos/login/extending-tokens/)

编辑：
如果 OP 意味着在当前应用程序用户群之外，一些用户经历了过期的会话并报告了问题，错误的查询字符串是可能的解释。

该错误将导致 access_token 不被扩展，但仍将使用较短的访问令牌授予登录权限。在这种情况下，错误的查询字符串一直存在于代码库中，但只有在实时用户的 access_tokens 比预期更早过期时才被发现，这与“许多人使用的应用程序 [..]”相吻合。

如果 OP 意味着在来自同一客户端的许多调用中使用正确的查询（而不是问题中所述的查询），则子集返回错误，那么我的解释是无效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T11:17:29.337

您在 APP_SECRET 和 grant_type 之间缺少 &。

此外，在这个问题上似乎有一个 Fb 错误 - [http://developers.facebook.com/bugs/536272816386515?browse=search_50a37bb1c333b4253892226](http://developers.facebook.com/bugs/536272816386515?browse=search_50a37bb1c333b4253892226)

确保在获得“SHORT_TIME_TOKEN”后立即扩展令牌。您只能扩展用户令牌（不能扩展页面令牌）。确保在扩展之前获得正确的“短期令牌”。

此外，请检查您的应用程序中的“沙盒模式”。扩展令牌时可能会导致问题。尝试将其切换为“假”。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T20:38:35.833

听起来好像您的一些用户被错误地发行了生命周期较短的令牌，而不是您要求的延长令牌。

您可能偶然发现了扩展访问令牌的已知错误。在 facebook 上查看[此错误报告以](https://developers.facebook.com/bugs/139679539502999)获取有关它的更多信息以及[此问题](https://stackoverflow.com/questions/8971423/fb-exchange-token-for-php-only-working-once-user-removes-app)，尽管据我所知没有真正的解决方法。

# aes - 用于新空白 Desfire EV1 的 AES

> ID：12080310
> 
> 赞同：3
> 
> 时间：2012-08-22T19:43:35.387
> 
> 标签：aes, rfid, mifare

我现在有一张新的 Desfire EV1 卡。我想用AES加密设置PICC主密钥。我怎么能那样做？到目前为止，我可以使用单个 DES 获取会话密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-26T20:10:55.483

您需要从制造商[NXP](http://www.nxp.com)获取数据表。在没有适当文档的情况下调试或逆向工程加密功能非常困难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T13:56:14.423

一个起点可能是 libfreefare 或其父级 nfc-tools。

[http://code.google.com/p/nfc-tools/wiki/libfreefare](http://code.google.com/p/nfc-tools/wiki/libfreefare)

# java - @Inject 仅适用于由 CDI 容器创建的 POJO？

> ID：12080317
> 
> 赞同：9
> 
> 时间：2012-08-22T19:44:04.737
> 
> 标签：java, jakarta-ee, java-ee-6, cdi

我只是想确认我完全了解 CDI 工作的先决条件。如果我有 A 类：

```
public class A {
    @Inject private B b;
} 
```

现在，当我使用以下方法实例化此类时：

```
A a = new A(); 
```

在这种情况下，Ab 将为空。

但是如果我在另一个类中定义一个成员：

```
@Inject A a; 
```

以后使用 a,ab 会正确填充吗？

CDI 是否仅在需要注入的类也由 CDI 容器创建时才有效？或者，如果在使用 new 的普通实例化创建 POJO 时注入结果为空，我会错过什么（是的，我有 beans.xml 到位）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T19:49:54.953

> CDI 是否仅在需要注入的类也由 CDI 容器创建时才有效？

是的，差不多就是这样。a 的生命周期`ManagedBean`由容器控制，并且永远不应该用`new`关键字实例化（顺便说一句：EJB 和 Spring bean 也是如此）。如果您需要创建一个新的 ManagedBean，您可能需要使用[生产者方法](http://docs.jboss.org/weld/reference/latest/en-US/html/beanscdi.html#d0e948)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T20:12:26.503

虽然其他人已经正确地指出，在大多数情况下，DI 容器不会将依赖项注入到它们没有实例化的 bean 中，但这并不完全正确。

Spring 有一个很棒的特性，当你使用`new A()`. 您只需要使用AspectJ 并使用[annotation](http://static.springsource.org/spring/docs/3.0.0.RC2/reference/html/ch07s08.html)[标记您的 bean`@Configurable`](http://static.springsource.org/spring/docs/3.0.0.RC2/reference/html/ch07s08.html)。

```
@Configurable
public class A {
    @Inject private B b;
} 
```

它实际上是一个很棒的功能，因为您可以在仍然尊重您的 DI 的同时执行 Active Record 样式的 POJO（实际上 Spring Roo 就是这样做的）。

您还应该知道，使用 Spring，您可以在使用[AutowireCapableBeanFactory](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/beans/factory/config/AutowireCapableBeanFactory.html)实例化 bean 后以编程方式自动装配 bean 。这就是它通常自动装配 JUnit 测试用例类的方式，因为 JUnit 创建了测试用例类。

**是的 Spring 不是 CDI**，但理论上你可以为 CDI 编写自己的`@Configurable`，或者可能有一种 CDI 方式来执行上述操作。

That being said the above is sort of a sophisticated feature (and kind of a hack) and as @JanGroth mentioned understaning the [lifecycle bean management of the container](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html) is critical whether its CDI, Spring, Guice etc.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-02T06:43:13.343

You may use `BeanProvider.injectFields(myObject);` from [Apache DeltaSpike](https://deltaspike.apache.org/documentation/core.html#BeanProvider).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T19:50:14.963

是的，@Inject 只能在容器内工作，因为它是在方法调用上使用拦截器完成的。**当容器创建一个 bean 时，它会将其包装在执行注入的拦截器中，并且在使用new**实例化的情况下，在 bean 方法调用期间不会调用任何拦截器，也不会进行注入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T19:49:28.150

以下是类成为托管 bean 所需的条件（因此，@Inject 注释在其字段/方法上工作）：

[http://docs.oracle.com/javaee/6/tutorial/doc/gjfzi.html](http://docs.oracle.com/javaee/6/tutorial/doc/gjfzi.html)

# c# - 类元素的排序列表

> ID：12080322
> 
> 赞同：0
> 
> 时间：2012-08-22T19:44:45.793
> 
> 标签：c#, class-members

我有一个这样的记录类：

```
public class RecordInfo
{
    public String CDate;
    public String Patient_ID;
    public Color Zone;
    public String Fname;
    public String Lname;
    public Int64 ImgSize;
    public String ImagePrefix;
    public String ImagePath;
    public String Sex;
    public String TZ;
} 
```

我列出了这样的 RecordInfo 列表：

```
List<RecordInfo> PatientRecords = new List<RecordInfo>(); 
```

我向其中添加了记录，但我想根据 Patient_ID、性别、Fname 等对该列表进行排序.....

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T19:45:57.620

当然，LINQ[使](http://msdn.microsoft.com/en-us/library/bb308959.aspx)[`OrderBy`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderby.aspx)使用、[`OrderByDescending`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.orderbydescending.aspx)和变得容易：[`ThenBy`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.thenby.aspx)[`ThenByDescending`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.thenbydescending.aspx)

```
// Note change from Patient_ID to PatientId for naming conventions.
List<RecordInfo> sorted = records.OrderBy(x => x.PatientId).ToList(); 
```

这将创建一个*新*列表 - LINQ 基于将一个序列投影到新序列上的查询，而不是改变现有列表。

或者，您可以使用[`List<T>.Sort`](http://msdn.microsoft.com/en-us/library/3da4abas)自定义比较器进行就地排序。

无论哪种方式，我都强烈建议使用属性而不是公共字段，并遵循 .NET 命名约定。

# sql-server - 获取 SQL Server 2008 中新插入行的主键

> ID：12080324
> 
> 赞同：35
> 
> 时间：2012-08-22T19:45:04.593
> 
> 标签：sql-server, database

我有一堆数据将插入到一个表中。这个问题是我需要它将主键返回到该表。我不确定是否有类似的东西：

```
 insert into TABLE (...) values (...) RETURNING p_key 
```

或者

```
 select p_key from (insert into TABLE (...) values (...)) 
```

我正在为浏览器和保存的信息做一个解决方法，这些信息或多或少会添加一行然后更新它......但是没有主键，就没有办法更新它，因为没有对它的引用。

我在网上查找并通过谷歌找到了一些示例，但这些示例让我有些困惑。

[http://en.wikipedia.org/wiki/Insert_(SQL)#Retrieving_the_key](http://en.wikipedia.org/wiki/Insert_(SQL)#Retrieving_the_key)

[http://www.daniweb.com/web-development/databases/ms-sql/threads/299356/returning-identity-of-last-inserted-row-uniqueidentifier](http://www.daniweb.com/web-development/databases/ms-sql/threads/299356/returning-identity-of-last-inserted-row-uniqueidentifier)

Wikipedia 说要使用 SQL Server 2008`OUTPUT`而不是`RETURNING`，可以使用类似的东西`OUTPUT p_key`

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-22T20:35:21.873

如果您要插入一整组行，则选择`SCOPE_IDENTITY()`不会。而且`SCOPE_IDENTITY`也只适用于（数字）身份列 - 有时你的 PK 是别的东西......

但是 SQL Server**确实**有该`OUTPUT`子句 -[它在 MSDN 上有很好的记录！](http://msdn.microsoft.com/en-us/library/ms177564.aspx)

```
INSERT INTO dbo.Table(columns)
OUTPUT INSERTED.p_key, INSERTED.someothercolumnhere .......
VALUES(...) 
```

这些值将“回显”回调用应用程序，例如，您将在 SQL Server Management Studio 的网格中看到它们，或者您可以从调用此`INSERT`语句的 C# 或 VB.NET 将它们作为结果集读取。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-22T19:46:30.943

`Scope_Identity()`是你想要的，假设“主键”你的意思是“身份”

```
declare @id int 
insert yourtable values (some, values)
select @id = Scope_Identity() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-22T19:48:49.893

在`C#`，在您的 SQL 语句编写之后`SELECT SCOPE_IDENTITY();`，您的代码将是：

```
insert into TABLE (...) values (...); SELECT SCOPE_IDENTITY(); 
```

然后，而不是`executeNonQuery`使用`executeScalar`.

这应该够了吧！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T19:47:29.073

执行插入后，查询：

```
select scope_identity() 
```

检索最后插入的主键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-09T15:03:30.120

使用 @@IDENTITY 可以获取最后生成的主键

```
Insert into TableName (Name,Class) values('ABC','pqr')
select @@IDENTITY 
```

# javascript - 压缩javascript中多个事件的代码

> ID：12080326
> 
> 赞同：0
> 
> 时间：2012-08-22T19:45:10.477
> 
> 标签：javascript

这可以以更好的方式完成，还是我必须为所有人输入“object.event = function”？

```
namn1.onfocus = clearField;
foretag1.onfocus = clearField;
telefon1.onfocus = clearField;
hemsida1.onfocus = clearField;
meddelande1.onfocus = clearField;
namn2.onfocus = clearField;
foretag2.onfocus = clearField;
telefon2.onfocus = clearField;
hemsida2.onfocus = clearField;
meddelande2.onfocus = clearField;

namn1.onblur = restoreField;
foretag1.onblur = restoreField;
telefon1.onblur = restoreField;
hemsida1.onblur = restoreField;
meddelande1.onblur = restoreField;    
namn2.onblur = restoreField;
foretag2.onblur = restoreField;
telefon2.onblur = restoreField;
hemsida2.onblur = restoreField;
meddelande2.onblur = restoreField; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:49:00.783

你可以做这样的事情，但它并没有那么好：

```
var fields = [
    namn1, foretag1, telefon1, hemsida1, meddelande1,
    namn2, foretag2, telefon2, hemsida2, meddelande2
];

for (var i = 0; i < fields.length; i++) {
    fields[i].onfocus = clearField;
    fields[i].onblur = restoreField;
} 
```

jQuery 会给你更多的控制权，但我不知道你是否想使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T19:49:06.290

```
var elements = [namn1, foretag1, telefon1, hemsida1, meddelande1, namn2, foretag2, telefon2, hemsida2, meddelande2];
for (var i in elements) {
    elements[i].onfocus = clearField;
    elements[i].onblur = restoreField;
} 
```

如果这些元素可以通过 ID 访问，这可以变得更加简洁——然后，可以通过获取每对元素来将数组减半。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T19:51:15.333

```
[namn1, foretag1, telefon1, hemsida1, meddelande1,
 namn2, foretag2, telefon2, hemsida2, meddelande2].forEach(function(e) {
  e.onfocus = clearField;
  e.onblur = restoreField;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T19:57:18.573

只是肖恩回答的一个微小变化，因为我喜欢这种创建数组的方法。

```
var fields = "namn1 foretag1 telefon1 hemsida1 meddeland1 namn2 foretag2 telefon2 hemsida2 meddelande2".split(" ");

for(i=0; i<fields.length; i++){
   fields[i].onfocus = clearField;
   fields[i].onblur = restoreField;
} 
```

# objective-c - 将 DerivedData 位置设置在与项目相同的文件夹中

> ID：12080327
> 
> 赞同：0
> 
> 时间：2012-08-22T19:45:12.470
> 
> 标签：objective-c, ios, xcodebuild

我有一个包含 3 个不同目标的工作区，其中一个我需要在我的代码所在的文件夹中获取构建结果。

我还需要使用 xcodebuild 构建它，我一直在研究试图找出是否有一些标志或配置的东西来实现这个但找不到它......

有没有办法做到这一点？？？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:20:44.340

你试过这个吗？[http://developer.apple.com/library/ios/#recipes/xcode_help-locations_preferences/DerivedData/DerivedData.html#//apple_ref/doc/uid/TP40010523-CH2-SW1](http://developer.apple.com/library/ios/#recipes/xcode_help-locations_preferences/DerivedData/DerivedData.html#//apple_ref/doc/uid/TP40010523-CH2-SW1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-07T15:16:26.110

`xcodebuild`为此有一个标志

```
-derivedDataPath PATH - specifies the directory where build 
                        products and other derived data will go 
```

# jquery - 切换显示/隐藏取消切换单击外部

> ID：12080328
> 
> 赞同：1
> 
> 时间：2012-08-22T19:45:15.357
> 
> 标签：jquery, click, hide, toggle, show

**编辑：** *我尝试了 GLK.net 的链接，但我无法让它工作。它只会破坏我的功能。*

我有一个 span 元素，如果单击它，它将切换 ul（第一次单击 = 显示/第二次单击 = 隐藏）。

我想要这样，如果显示 ul，用户应该能够单击元素外部（因此，文档/html）来隐藏列表。

这是我的代码：

顺便说一句， $('hmtl').css('cursor', 'pointer'); 用于iOS。

（函数（$）{

```
$.fn.styledDropdown = function() {

    var obj = $('#tag-cloud');

    obj.find('.field').click(function() { // onclick event, show wp-tag

        if (obj.find('.wp-tag-cloud').is(':hidden')) {

            obj.find('.wp-tag-cloud').show();
            obj.find('i').attr('class', 'icon-eqtri-up');
            $('html').css('cursor', 'pointer');

            $(document).keyup(function(event) { // keypress event, hide wp-tag list

                if(event.keyCode == 27) {
                    obj.find('.wp-tag-cloud').hide();
                    obj.find('i').attr('class', 'icon-eqtri-down');
                    $('html').css('cursor', 'default');
                }

            });

        } else {

            obj.find('.wp-tag-cloud').hide();
            obj.find('i').attr('class', 'icon-eqtri-down');
            $('html').css('cursor', 'default');

        }

    });

    obj.find('.wp-tag-cloud li a').click(function() { // onclick event, change field value with selected list item and show list

        obj.find('.field').html( $(this).html() + '<i class="icon-eqtri-down"></i>' );
        obj.find('.wp-tag-cloud').hide();
        $('html').css('cursor', 'default');

    });

}; 
```

})(jQuery);

对此的任何帮助将不胜感激。

*   代码改编自 css-tricks.com 上的示例

# mongodb - 有什么方法可以更新 mongodb 中一个键中的所有键？

> ID：12080331
> 
> 赞同：1
> 
> 时间：2012-08-22T19:45:47.057
> 
> 标签：mongodb, pymongo

我有一个集合，其中每个文档都具有以下结构：

```
{
  a: {
       foo: [1, 2, 3],
       bar: [4, 5, 6],
     }
} 
```

有什么办法可以同时更新里面的所有键`a`吗？即说我想同时设置`foo`和不做但做类似的`bar`事情`[]``$set: {'a.foo': [], 'a.bar': []}``$set: {'a.*': []`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:46:53.850

不，您不能使用通配符运算符来选择字段名称。

因此，您必须先知道该字段的名称，然后才能对其进行更新。

有关更多说明，请参阅此[问题](https://stackoverflow.com/questions/6179871/mongodb-wildcard-in-the-key-of-a-query)。

# ftp - 如何阻止与特定 FTP 服务器的连接

> ID：12080335
> 
> 赞同：0
> 
> 时间：2012-08-22T19:45:58.433
> 
> 标签：ftp, connection, keylogger

我正在考虑编写一个反键盘记录器/反 RAT 应用程序。基本上，我想要它做的是：

1.  监控传出的 ftp 流量（可能监控所有传出的流量并可以选择按 ftp 过滤）
2.  分析标头以查找潜在的键盘记录器/RAT
3.  嗅出任何此类连接的 FTP 地址
4.  阻止（或让用户选择阻止）到这些地址的连接

我认为我可以处理步骤 1-3，并且我知道我可以阻止*所有*FTP 流量，但是我该如何阻止特定地址呢？

附带说明一下，任何人都可以建议一些可能使步骤 1-3 更容易的库吗？或将执行第 4 步的库（如果存在）。我不介意编写代码以针对多个操作系统。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:57:33.030

[Snort](http://www.snort.org/)允许您监控传入/传出流量，并根据文件中指定的一组规则工作。一旦您使用 snort 检测到具有特定 IP/端口/主体的流出的流量，请结合使用[SnortSAM](http://www.snortsam.net/)和防火墙来阻止流向该 IP/端口的流量。

# c# - 使用数据库中的用户名获取配置文件 ID

> ID：12080338
> 
> 赞同：0
> 
> 时间：2012-08-22T19:46:04.907
> 
> 标签：c#, asp.net

我必须捕获在登录页面中输入的用户名并获取相应的 profileid（DB 中的列）并将其显示在另一个页面中，我的 DAL 代码是

```
public DataTable getall()
   {
       SqlConnection conn1 = Generic.DBConnection.OpenConnection();
       DataTable dt=new DataTable();
       try
       {
             string sql = "Select * from Profile_Master";
             SqlCommand cmds = new SqlCommand(sql,conn1);
             SqlDataAdapter sqlDa = new SqlDataAdapter(cmds);
           sqlDa.Fill(dt);

       }
       catch (Exception ex)
       {

           throw ex;
       }
       return dt;
   } 
```

我的用户界面

```
DataTable dt1 = new DataTable();
                ProfileMasterDAL dal = new ProfileMasterDAL();
                dt1 = dal.getall();
                if (dt1.Rows.Count > 0)
                {
                    Session["sdds"] = dt1.Rows[0]["FirstName"].ToString();
                    Session["EmailId"] = dt1.Rows[0]["EmailID"].ToString();
                    Session["pid"] = dt1.Rows[0]["NewidColumn"].ToString();
                    Response.Redirect("~/Myhome.aspx"); 
```

但我能够获得数据库中的第一个值而不是用户名的相应值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:03:55.540

您的 select 语句有 10 行。并且您所需的行位于第 5 位。当你说 dt1.Rows[0]["FirstName"] 时，你只会得到第一条记录，而不是第五条记录。

如果您想完成这项工作，请将 where 条件添加到您的 select 语句中，它会为您返回一个所需的行。

就像是..

“从 Profile_Master PM 中选择 * 其中 PM.UserName = @username”

其中@username 是您从登录页面输入的信息。并且在数据库表中是唯一的

# c# - 具有服务层、业务层和实体框架的 N 层架构

> ID：12080339
> 
> 赞同：5
> 
> 时间：2012-08-22T19:46:05.573
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework, asp.net-mvc-2

只是想对我构建应用程序的方式提供一些反馈/帮助。我当前的解决方案结构如下所示：

*   UI（实际的 MVC 应用程序）
*   核心（仅限控制器和视图模型）
*   服务
*   BLL
*   数据（实体框架 DbContext，映射到域对象）
*   域（简单 POCO 对象）
*   接口

其他的东西

*   Ninject 将 DbContext 注入控制器（每个请求）
*   AutoMapper 将域对象映射到 ViewModel

所有程序集都有一个对 Interfaces 项目的引用，顾名思义，它只不过是简单的接口（即 IDbContext、IRepository 等）。

服务项目将其他一切“联系”在一起。它是唯一直接引用数据访问层（实体框架）的程序集。

我在下面提供了一些代码：

控制器的示例如下所示：

```
namespace Core.Controllers
{
    public class HomeController : Controller
    {
        private IDbContext dbContext;

        public HomeController(IDbContext dbContext)
        {
            this.dbContext = dbContext;
        }

        public ActionResult Users()
        {
            UserService userService = new UserService(dbContext);
            var users = userService.GetAllUsers();
            return View(Mapper.Map<IEnumerable<UserListViewModel>>(users));
        }
        ... 
```

用户服务类：

```
namespace Services
{
    public class UserService
    {
        private readonly IDbContext dbContext;

        public UserService(IDbContext dbContext)
        {
            this.dbContext = dbContext;
        }

        public IEnumerable<User> GetAllUsers()
        {
            IRepository<User> userRepository = new Repository<User>(dbContext);
            UserBLL userBLL = new UserBLL(userRepository);
            return userBLL.GetAllUsers();
        }
        ... 
```

最后是业务层类：

```
namespace BLL
{
    public class UserBLL
    {
        private readonly IRepository<User> userRepository;

        public UserBLL(IRepository<User> userRepository)
        {
            this.userRepository = userRepository;
        }

        public IEnumerable<User> GetAllUsers()
        {
            return userRepository.Get();
        }
        ... 
```

我正在寻找一些反馈/改进方法。我注意到对于基本任务，我的服务层方法将与业务层方法完全相同（即“通过”功能）。我希望这种抽象有助于更复杂的任务，这些任务可能需要调用多个业务层方法。在服务层中包含业务逻辑会更好吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T20:14:17.020

乍一看，我认为您的服务和控制器/核心层不应该以这种方式将数据库上下文注入其中。他们实际上并不直接依赖它，并且以这种方式进行操作会导致一些不理想的耦合。核心层应该注入用户服务，用户服务和 BLL 应该注入存储库。存储库应该具有由您的 DI 框架注入的 dbcontext，而不是作为依赖项传入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T20:12:18.577

为什么直接在服务中创建依赖项时使用依赖项注入？

```
public IEnumerable<User> GetAllUsers()
{
    IRepository<User> userRepository = new Repository<User>(dbContext);
    UserBLL userBLL = new UserBLL(userRepository);
    return userBLL.GetAllUsers();
} 
```

顺便提一句。当它们实际上什么都不做时，你为什么要使用这么多层？您的示例代码只是表明，直接在控制器中使用上下文会产生相同的结果，而无需三个包装无用的层。这可能只是您的示例的问题，但每一层都应该带来一些额外的逻辑。如果您只是使用它来调用较低层的某些东西，那么您很可能会过度构建您的代码。这称为洋葱架构。这也是为什么在需要时添加图层并不是一个坏习惯的原因 - 而不是预先添加图层。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:18:25.173

请查看： http: [//www.primaryobjects.com/CMS/Article122.aspx](http://www.primaryobjects.com/CMS/Article122.aspx) EF 存储库模式 + 工作单元模式。至于您的其他层，它实际上取决于应用程序及其需要完成的任务。请提供有关您要执行的操作的更多详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-28T06:55:26.733

在组织项目和层设计方面的一些改进可以通过专注于使域对象正确来完成。

您说您有简单的 POCO 对象作为域，但域对象应该是具有业务的所有**“状态和行为”**的对象。这意味着您不需要将 BLL 和域程序集分开。定义域对象后，可以使用 EF 创建上下文和实体类（它们不是域类，除非与域对象相比没有其他行为，但它们仍然不同可能有利于未来的需求）。

另一个小问题是，我认为将接口分布在域和服务层中对于任何人都孤立地理解每一层来说更好。

# c# - 如何在我的表单中从对象调用我的 Socket Send 方法？异步套接字

> ID：12080345
> 
> 赞同：0
> 
> 时间：2012-08-22T19:46:25.703
> 
> 标签：c#, winforms, sockets

我有一个实现异步 TCP/IP 套接字的表单 (Form1)。我有一个我创建的对象（公共类 MyObject）。

从表单中，我创建了一个 MyObjects 数组。然后我调用 MyObjects 上的方法来操作数据。在 MyObjects 我有一个功能：

```
 private void send(string sPacketData)
    {
        if (SocketState.clientSocket != null && SocketState.clientSocket.Connected)
        {
            byte[] byteData = Encoding.ASCII.GetBytes(sPacket);
            SocketState.clientSocket.BeginSend(byteData, 0, byteData.Length, SocketFlags.None, new AsyncCallback(Form1.SendCallback), this);
        }
    } 
```

这里的问题是我试图访问 Form1 的 SendCallback 函数而不引用 Form1。

这是 SendCallback 的样子：

```
 public void SendCallback(IAsyncResult ar)
    {
        try
        {
            // Retrieve the socket from the state object.
            MyObject mo = (MyObject)ar.AsyncState;
            // Complete sending the data to the remote device.
            int bytesSent = mo.SocketState.clientSocket.EndSend(ar);
        }
        catch (Exception e)
        {
            System.Diagnostics.Debug.WriteLine("Send Callback: " + e.Message + "\r\n");
        }
    } 
```

一种解决方案是将 SendCallback 设为静态，但这会导致未将其设置为对象实例的异常。

有不同的方法可以做到这一点吗？我在吠叫错误的树吗？我应该返回我想从 MyObjects 的函数调用发送的数据，然后从表单发送吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T19:51:51.490

只需`send`将回调作为其参数之一，并将`form1`回调方法传递给`send`. 或者，您可以添加一个由该方法设置并在该方法中使用`MyClass`的类型的属性。`AsyncCallback``Form1``send`

在创建回调时`Form1`传递给`MyObject`use`this.SendCallback`而不是`Form1.SendCallback`. 或者，既然`this`是隐含的，就输入`SendCallback`.

委托不仅仅是对方法的引用，它是对方法和应该调用它的对象实例的引用（这要强大得多）。（该对象将`null`用于静态方法。）幸运的是，您不需要将引用显式传递给委托构造函数。当您输入时`this.SomeMethod`，`someObject.MethodOfThatObject`编译器会将其转换为对该实例调用的该方法的委托。

# javascript - 在 while 循环中此赋值的逻辑（jshint 友好）等价物

> ID：12080354
> 
> 赞同：2
> 
> 时间：2012-08-22T19:46:48.543
> 
> 标签：javascript, refactoring, jshint

```
 dispose: function() {
    var disposer;
    while (disposer = this._disposers.shift()) { // expected a conditional expression and instead saw an assignment.
      disposer();
    }
  }, 
```

`jshint`不高兴在循环`disposer`中分配。`while`

有什么方法可以保持这种逻辑并使其`jshint`友好吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T19:54:19.980

您可以简单地使用`()`.

```
dispose: function () {
    var disposer;
    while ((disposer = this._disposers.shift())) {
        disposer();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T19:48:29.290

除非我错过了什么...

```
dispose: function() {
    var disposer = this._disposers.shift();
    while (disposer) {
        disposer();
        disposer = this._disposers.shift();
    }
}, 
```

你可能还想加强你的条件：

```
while (typeof disposer === 'function') { 
```

工作示例：http: [//jsfiddle.net/DPNYq/](http://jsfiddle.net/DPNYq/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T19:53:54.547

```
dispose: function() {
  var disposer;
  while (typeof (disposer = this._disposers.shift()) === 'function') {
    disposer();
  }
}, 
```

# python - CouchDB-Python 查询性能

> ID：12080358
> 
> 赞同：1
> 
> 时间：2012-08-22T19:46:59.003
> 
> 标签：python, performance, couchdb

我有几个 CouchDB 数据库。最大的是大约 600k 个文档，我发现查询时间过长（几个小时或更长时间）。数据库不经常更新（大约一个月一次），只涉及添加新文档，从不更新现有文档。

查询的类型：查找所有文档，其中`key1='a'`或多个键： `key1='a', key2='b'`...

我认为永久视图在这里并不实用，因此一直在使用 CouchDB-Python 的“查询”方法。

我尝试了几种方法，但我不确定哪种方法最有效，或者为什么。

方法一：map函数为：

```
 map_fun = '''function(doc){
        if(doc.key1=='a'){
            emit(doc.A, [doc.B, doc.C,doc.D,doc.E]);
        }
    }''' 
```

Python 查询是： results = ui.db.query(map_fun, key2=user)

**然后对 results.rows 进行一些操作。这占用了最多的时间。**

'results.rows' 需要大约一个小时才能返回。如果我将 key2 更改为其他内容，它会在大约 5 秒内返回。如果我重复原始用户，它也很快。

但有时我需要查询更多的键，所以我尝试：

```
 map_fun = '''function(doc){
        if(doc.key1=='a' && doc.key2=user && doc.key3='something else' && etc.){
            emit(doc.A, [doc.B, doc.C,doc.D,doc.E]);
        }
    }''' 
```

并使用 python 查询：

results = ui.db.query(map_fun) 然后对 results.rows 进行一些操作

第一次查询需要很长时间。当我更改 key2 时，又需要很长时间。如果我将 key2 更改回原始数据，则需要相同的时间。（也就是说，似乎没有任何东西被缓存，B-tree'ed 或其他）。

所以我的问题是：在 couchdb-python 中进行查询的最有效方法是什么，其中查询是临时的并且涉及搜索条件的多个键？

UI 是基于 QT 的，在下面使用 PyQt。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:22:58.633

[couchdb-python db.query()](http://packages.python.org/CouchDB/client.html#couchdb.client.Database.query)方法有两个注意事项：

1.  它执行[临时视图](http://wiki.apache.org/couchdb/HTTP_view_API#Temporary_Views)。这意味着代码流处理将被阻止，直到所有文档都由该视图处理。每次通话都会一次又一次地发生这种情况。尝试保存视图并使用[db.view()](http://packages.python.org/CouchDB/client.html#couchdb.client.Database.view)方法来按需获取结果并进行增量索引更新。

2.  无论它有多大，它都会读取整个结果。db.query() 和 db.view() 方法都不是惰性的，所以如果视图结果是 100 MB JSON 对象，您必须在以某种方式使用它们之前获取所有这些数据。要以更优化内存的方式查询数据，请尝试将补丁应用到具有[db.iterview()](http://code.google.com/r/mattgoodall-couchdb-python-iterview/source/browse/couchdb/client.py#829)方法 - 它允许您以分页样式获取数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T08:25:10.640

我认为解决您的问题的方法是为您正在搜索的键创建索引。这就是你所说的常见。

请注意基于 B 树的表中的 map/reduce 和 SQL 查询之间的区别：

*   搜索键（如果有索引）的简单 SQL 查询遍历 B+-树中从根到叶的单个路径，
*   map 函数读取*所有元素*，如果它发出小结果，则事件。

您正在做的是*针对每个查询*

1.  阅读*每份*文件（大部分费用）和
2.  在发出的结果中搜索一个键（在 B 树中快速搜索）。

而且我认为您的解决方案在设计上必须很慢。

如果您重新设计数据库结构以使永久视图实用，则 (1.) 将执行一次，并且对于每个查询仅执行 (2.)。添加到数据库后，视图将读取每个文档，并且查询将在存储发出结果的 B-tree 中搜索。如果发出的集合小于总文档数，则查询搜索较小的结构，您将比 SQL 数据库受益。

临时视图的效率远低于永久视图，并且仅用于开发。CouchDB 旨在使用永久视图。为了使 map/reduce 高效，必须实现缓存或使视图永久化。我不熟悉 CouchDB 实现的细节，也许由于一些缓存，使用不同键的第二个查询更快。如果由于某种原因您必须使用临时视图，那么 CouchDB 可能是一个错误，您应该考虑为 MongoDB 等在线查询创建和优化 DBMS。

# java - 根据传入请求的数据设置下拉菜单的默认值

> ID：12080360
> 
> 赞同：2
> 
> 时间：2012-08-22T19:47:04.747
> 
> 标签：java, jsp, jstl

我正在尝试根据传递到页面的信息设置下拉菜单的默认值。到目前为止，我有这个：

```
<td>
    <select id="typeDropdown" name="typeDropdown">
        <option value="val1" selected="selected">Value 1</option>
        <option value="val2">Value 2</option>
    </select>
</td> 
```

这将始终选择第一个值。

但是，我可以根据提供给网页的信息做这样的事情来设置默认值吗？

```
<c:if test="${not empty data}">
    <c:set var="val" value="${data}" />
</c:if>
<td>
    <select id="typeDropdown" name="typeDropdown">
        <option value="val1" <c:if test="val eq 1">selected="selected</c:if> >Value 1</option>
        <option value="val2" <c:if test="val eq 2">selected="selected</c:if> >Value 2</option>
    </select>
</td> 
```

where`data`作为请求的一部分传递到页面中。我知道语法可能是错误的，但我更感兴趣的是这个想法是否合理。

编辑1：

所以那没有用。我的努力收到了以下例外：

```
org.apache.jasper.JasperException: An exception occurred processing JSP page /newInterface.jsp at line 127

124: <td>Field 1:</td>
125:    <td><select name="field1">
126:        <c:set var="tet" value="val1"/>
127:        <option value="val1" <c:if test="${old.val eq tet}">selected="selected"</c:if>>val1</option>
128:        <option value="val2">val2</option>
129:    </select>
130: </td>

Stacktrace:
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:510)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:419)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262) 
```

`old.val`就所有意图和目的而言，与我最初想法中的“val”变量相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:27:41.110

1：
......这个想法还可以，首先获取数据值输出，然后继续选择，解析错误可能很神秘，所以为什么不编辑问题并添加错误

2：所以请确保您也可以先输出，这可能就是您的“如果”爆炸的原因

# qt - 如何检测QTableWidget滚动源（代码本身/用户（滚轮）/用户（滚动条））？

> ID：12080368
> 
> 赞同：1
> 
> 时间：2012-08-22T19:47:57.837
> 
> 标签：qt, qtablewidget

我正在使用 Qt 4.8 编写一个程序，该程序显示一个包含文件名和文件参数的表（QTableWidget）。首先，用户将文件添加到列表中，然后单击进程。代码本身使用简单的进度描述更新表的内容。我希望默认情况下自动滚动表格以显示最后处理的文件并且该代码已准备好。

如果我想手动滚动它，那么一旦发生变化，将视口移动到最后一个元素，小部件就会自动滚动。如果我检测到是用户想要更改视图，我希望能够覆盖自动滚动。

这种行为可以在许多终端仿真程序中看到。当添加了新行时，视图会滚动，但是当用户强制终端查看之前的一些行时，终端不会尝试向下滚动。

我怎么能那样做？

**解决方案：**

我创建了一个对象，它过滤由我的 QTableWidget 和 QScrollBar 处理的事件。如果我发现应该关闭自动滚动的事件，我只需设置一个标志并在设置该标志时停止滚动视图。

一切都在 tableController 类中实现。以下是三个关键方法的部分内容。

```
bool tableController::eventFilter(QObject* object, QEvent* event)
{
  switch (event->type())
  {
    case QEvent::KeyPress:
    case QEvent::KeyRelease:
    case QEvent::Wheel:
    case QEvent::MouseButtonDblClick:
    case QEvent::MouseButtonPress:
    case QEvent::MouseButtonRelease:
      _autoScrollEnabled = false;
    default:
      break;
  }
  return QObject::eventFilter(object, event);
}

void tableController::changeFile(int idx)
{
  [...]
  if (_autoScrollEnabled)
  {
    QTableWidgetItem* s = _table.item(_engine.getLastProcessed(), 1);
    _table.scrollToItem(s);
  }
  [...]
}

void tableController::tableController()
{
   [...]
   _autoScrollEnabled = true;
   _table.installEventFilter(this);
   _table.verticalTableScrollbar()->installEventFilter(this);
   [...]
} 
```

感谢所有的帮助。我希望有人会觉得它有用:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T06:37:07.770

子类化`QTableWidget`并重载它的[wheelEvent](http://doc.qt.nokia.com/4.7-snapshot/qwidget.html#wheelEvent)。您可以使用提供的[QWheelEvent](http://doc.qt.nokia.com/4.7-snapshot/qwheelevent.html)对象的参数来确定用户是向上还是向下滚动。

`wheelEvent`然后使用在您的覆盖中设置（或重置）的简单布尔标志。负责调用的方法`scrollToBottom()`应该考虑这个布尔标志。

您将必须找到一种方法来确定何时设置或重置该标志，例如，始终在用户向上滚动时设置它，并在用户向下滚动并且当前显示区域位于底部时重置它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-07T08:06:31.100

```
connect(_table->view()->verticalScrollBar(), &QAbstractSlider::actionTriggered, this, [this](int) {
    _autoScrollEnabled = false;
}); 
```

# wpf - 更改 RibbonRadioButton 的外观

> ID：12080384
> 
> 赞同：0
> 
> 时间：2012-08-22T19:49:25.483
> 
> 标签：wpf, xaml, ribbon

我正在`Ribbon`为我的 WPF 应用程序开发一个，我需要将两个添加`RibbonRadioButton`到一个`RibbonGroup`. 我已经这样做了，一切正常：

```
<rb:RibbonGroup>

   <rb:RibbonRadioButton Label="Option one" IsChecked="{Binding OptionOne}"  />
   <rb:RibbonRadioButton Label="Option two" IsChecked="{Binding OptionTwo}" />

</rb:RibbonGroup> 
```

但是 RibbonRadioButtons 看起来像一个**“常规按钮”**，我需要它们看起来像我们都知道的**经典可推动 RadioButtons**，它们由一个小圆圈和一个标签组成。

那么，**有没有办法改变外观`RibbonRadioButtons`？？**

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T19:56:56.187

这是标准 RadioButton 的模板：http: [//msdn.microsoft.com/en-us/library/ms751600.aspx](http://msdn.microsoft.com/en-us/library/ms751600.aspx)

编辑 ：

我以为 RibbonRadioButton 是您自己的控件；但它是 .net 4.5 中的新功能？！我在 msdn 上找不到它的模板，所以我想你必须通过 Blend 来获得它。将控件放在新 Blend WPF 项目的新窗口上；右键单击设计视图上的控件->编辑模板->编辑副本；然后您可以在“xaml 视图”中编辑模板...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T20:41:01.603

这对我有用：

```
<rb:RibbonMenuButton.Resources>
    <ControlTemplate x:Key="RibbonRadioButtonControlTemplate1" TargetType="{x:Type rb:RibbonRadioButton}">
        <RadioButton GroupName="{Binding Name, RelativeSource={RelativeSource AncestorType=rb:RibbonGroup}}" Content="{TemplateBinding Label}" IsChecked="{Binding IsChecked}"/>
    </ControlTemplate>
</rb:RibbonMenuButton.Resources>

    <rb:Ribbon HorizontalAlignment="Left" Margin="111,86,0,88.867" Width="289.14">
    <rb:RibbonGroup x:Name="grp1">
         <rb:RibbonRadioButton Label="Option one" IsChecked="{Binding OptionOne}" Template="{DynamicResource RibbonRadioButtonControlTemplate1}"  />
         <rb:RibbonRadioButton Label="Option two" IsChecked="{Binding OptionTwo}" Template="{DynamicResource RibbonRadioButtonControlTemplate1}" />
    </rb:RibbonGroup>
    </rb:Ribbon> 
```

# gsm - Wavecom GSM 调制解调器上的 AT 命令

> ID：12080388
> 
> 赞同：1
> 
> 时间：2012-08-22T19:49:39.977
> 
> 标签：gsm, at-command, sim-card, hyperterminal

我将此脚本放在超级终端控制台中。

```
AT+CNMI=1,1,0,1,0
OK
AT+CMGL="ALL"
OK
+CMTI: "SM",1
AT+CMGR=1
+CMGR: "REC UNREAD","+33659382587",,"12/08/22,21:42:28+08"
Coco
OK
AT+CMGD=1 
```

我的问题是控制台冻结，发送命令时没有响应`AT+CMGD=1` （此命令删除 SMS #1），但在我的情况下，删除操作不起作用。

可能是什么原因 ？

谢谢。

# java - 检查 date() 是否是星期一？爪哇

> ID：12080391
> 
> 赞同：12
> 
> 时间：2012-08-22T19:49:59.830
> 
> 标签：java, date

有没有办法检查 java`Date`对象是否是星期一？我看到你可以用一个`Calendar`对象，但是日期？如果星期一的索引会改变，我也会使用美国东部日期和时间

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-22T19:54:38.487

像这样的东西会起作用：

```
Calendar cal = Calendar.getInstance();
cal.setTime(theDate);
boolean monday = cal.get(Calendar.DAY_OF_WEEK) == Calendar.MONDAY; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-22T19:51:28.197

您可以使用`Calendar`对象。

[使用setTime(date)](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#setTime%28java.util.Date%29)将日期设置为日历对象

例子：

```
calObj.get(Calendar.DAY_OF_WEEK) == Calendar.MONDAY 
```

编辑：正如 Jon Skeet 建议的那样，您需要将 TimeZone 设置为 Calendar 对象，以确保它适用于时区。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-22T19:53:27.320

如果没有两个额外的信息，这个问题就没有意义：一个时区和一个日历系统。

一个`Date`对象只代表一个瞬间。*在我*所在的时区，它恰好是公历中的星期三——但对于我东边的一些人来说，已经是星期四了。在其他日历系统中，甚至可能没有“星期一”等这样的概念。

日历系统部分可能不是问题，但您*需要*确定您感兴趣的时区。

然后，您可以创建一个`Calendar`对象并设置时区和表示的瞬间——或者，更好的是，您可以使用[Joda Time](http://joda-time.sf.net)，它是一个*更好*的日期/时间 API。您仍然需要考虑相同的问题，但您的代码会更清晰。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-22T19:54:34.613

您应该使用 Calendar 对象进行这些检查。日期的时区支持较弱。在一个时区，此日期可以是星期一，而在另一个时区，它仍然是星期日。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-03T09:14:43.007

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

另外，下面引用的是来自[**Joda-Time**](https://www.joda.org/joda-time/)[主页](https://www.joda.org/joda-time/)**的通知：**

 **> 请注意，从 Java SE 8 开始，用户被要求迁移到 java.time (JSR-310) - JDK 的核心部分，它取代了这个项目。

## 使用`java.time`现代日期时间 API 的解决方案：

用来`Instant`表示片刻：

```
Instant instant = Instant.now();
System.out.println(instant); // A sample output: 2021-07-03T09:07:37.984Z 
```

An代表[UTC](https://www.timeanddate.com/worldclock/timezone/utc)[`Instant`](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)时间线上的一个瞬时点。输出中的 是零时区偏移的时[区指示符](https://en.wikipedia.org/wiki/ISO_8601#Time_zone_designators)。它代表 Zulu 并指定时区（时区偏移量为小时）。`Z``Etc/UTC``+00:00`

但是，如果您有 的对象`java.util.Date`，请将其转换为`Instant`例如

```
Date date = new Date(); // A sample date
Instant instant = date.toInstant(); 
```

转换`Instant`为`ZonedDateTime`在您的时区中表示日期时间，例如

```
ZonedDateTime zdt = instant.atZone(ZoneId.of("America/New_York")); 
```

检查日期时间是否在星期一，例如

```
System.out.println(zdt.getDayOfWeek() == DayOfWeek.SUNDAY); 
```

**演示：**

```
import static java.time.DayOfWeek.SUNDAY;

import java.time.Instant;
import java.time.ZoneId;
import java.time.ZonedDateTime;

public class Main {
    public static void main(String[] args) {
        Instant instant = Instant.now();

        ZonedDateTime zdt = instant.atZone(ZoneId.of("America/New_York"));

        System.out.println(zdt.getDayOfWeek() == SUNDAY);
    }
} 
```

**输出：**

```
false 
```

[`ONLINE DEMO`](https://ideone.com/f5ANB4)

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)**

# c# - 当名称包含空格时，从 Dropbox 下载文件失败

> ID：12080392
> 
> 赞同：0
> 
> 时间：2012-08-22T19:50:01.520
> 
> 标签：c#, encoding, dropbox

我正在尝试使用 RESTful API 从 Dropbox 下载文件。当我遇到其中包含空格的文件“My Photo.png”时，程序停止`var request = (HttpWebRequest) WebRequest.Create(requestUri);`它返回 403 错误。如果我删除空格并再次尝试文件下载，它会完美运行。我检查了格式化的 uri，它被返回为“My+Photo.png”，这应该是这样吗？我究竟做错了什么？

```
 var uri = new Uri(new Uri(DropboxRestApi.ApiContentServer),
        String.Format("files?root={0}&path={1}",
        root, UpperCaseUrlEncode(path))); 
```

我的方法：

```
 private static string UpperCaseUrlEncode(string s)
    {
        char[] temp = HttpUtility.UrlEncode(s).ToCharArray();
        for (int i = 0; i < temp.Length - 2; i++)
        {
            if (temp[i] == '%')
            {
                temp[i + 1] = char.ToUpper(temp[i + 1]);
                temp[i + 2] = char.ToUpper(temp[i + 2]);
            }
        }
        return new string(temp);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:01:33.840

您能否执行正常的 URLEncode 并执行 string.Replace 临时字符串，它将非常适合文件名中有空格的文件

```
temp = temp.Replace("+", "%20"); 
```

# asp.net-web-api - 如何在 ASP.NET Web API 中指定控制器的名称？

> ID：12080400
> 
> 赞同：0
> 
> 时间：2012-08-22T19:50:38.597
> 
> 标签：asp.net-web-api

我有一个 ApiController，很简单，像这样：

```
public class AssetController : ApiController
{
// removed for brevity
} 
```

当我从视图中插入到它的路由时，创建的 url 类似于：

```
http://host/Asset 
```

但我想自定义名称，使其变为：

```
http://host/assets 
```

如何在不使用完整的自定义路由表的情况下为我的控制器指定自定义名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T17:58:15.933

> 当我从视图中插入到它的路由时，创建的 url 类似于：`http://host/Asset`

你还没有真正展示你是如何进行这种*插入*的，但以下应该可以正常工作：

```
@Url.RouteUrl("DefaultApi", new { httproute = "false", controller = "assets" }) 
```

如果你想要一个绝对 url，你可以将协议方案指定为第三个参数：

```
@Url.RouteUrl("DefaultApi", new { httproute = "false", controller = "assets" }, "http") 
```

为了遵守 RESTFul 约定，您应该将控制器重命名为`AssetsController`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:23:07.797

我建议查看[https://github.com/mccalltd/AttributeRouting](https://github.com/mccalltd/AttributeRouting)库。它通过在每个函数上放置一个属性并给它一个特定的路由（可以是任何东西）来很好地处理这个方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T08:02:47.233

我不得不解决这个问题，所以我选择调整我的路由表以反映我真正想要的 API。

# c# - 实体框架和好友数据库的问题

> ID：12080401
> 
> 赞同：1
> 
> 时间：2012-08-22T19:50:47.147
> 
> 标签：c#, mysql, database, entity-framework

只是一个简单的问题。我正在尝试创建一个简单的朋友数据库测试应用程序，只是为了学习 Visual Studio 2010 实体框架和 MySQL。问题是，我不知道这是否正确。

这是我当前模型的图像：

![](../Images/a09772ce366e8bfde741ca8a095c6b31.png)

问题是，为什么有两个朋友的导航属性和两个帐户导航属性。我原以为朋友实体可能是唯一具有两个帐户导航属性的实体，以便我可以访问这两个朋友的帐户。

这是我的表格布局：

*   帐户：
    1.  idaccounts - 主键，不为空
    2.  nick - 用户昵称
*   朋友们：
    1.  idfriends - 主键，不为空
    2.  friend_one - 第一个帐号
    3.  friend_two - 第二个朋友号码
    4.  status - 包含友谊的状态（1\. Pending，2\. Accepted，3\. Rejected）

另外，我在朋友表中创建了两个外键到帐户表。其中一个名为friend_one，它使用friend 表中的friend_one 列来引用accounts 表。另一个名为friend_two，它使用friend_two 列来引用accounts 表。

这是正常的方法吗，还是有更好，更理智的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T02:21:14.867

我认为这很正常。如果某个帐户有多个朋友，您只需在**Friend**表中再添加一行。

但是，我强烈建议您阅读有关数据库规范化的内容，如果您还没有:) 也许从[维基百科开始](http://en.wikipedia.org/wiki/Database_normalization)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T02:12:40.227

答案是..这取决于。通常，您不会在一个表中重复字段（即 FriendOne、FriendTwo 等）。因为，假设您是一个友好的人（Wiggels 先生听起来像一个友好的名字）并且您有超过 2 个朋友。然后呢？

下面是我将如何做到的。 `Account`并且`FriendAccount`是数据库中同一个 Account 表的别名。

![规范化帐户/朋友模式](../Images/1fd0806951fc2e091bea3165eca38fe7.png)

但是，如果在你的情况下你**确定**你最多只有两个朋友，那么这在技术上是可行的。但同样，可能是糟糕的设计，因为它没有按比例磨损。

# android - 从服务中获取对 ProgressDialog 的引用

> ID：12080402
> 
> 赞同：1
> 
> 时间：2012-08-22T19:50:52.707
> 
> 标签：android, progressdialog

我需要`ProgressDialog.dismiss`从我的音乐服务中进行设置。我试过设置 AsyncTask

```
final class TheTask extends AsyncTask<Void, Void, Void>{
                ProgressDialog dialog = ProgressDialog.show(SomafmActivity.this, "", 
                        "Loading. Please wait...", true);   
                @Override
                protected void onPreExecute() {

             dialog.show();

                }

@Override
protected Void doInBackground(Void... params) {
final Intent i = new Intent(MusicService.ACTION_URL);
Uri uri = Uri.parse("http://sfstream1.somafm.com:8880");
i.setData(uri);
startService(i);
return null;
}

@Override
protected void onPostExecute(Void result) {
dialog.dismiss();
} 
```

这工作正常，但它在startService(i) 调用*开始*时关闭对话框，因此对话框立即消失。然后我尝试从 MusicService 服务访问我的 ProgressDialog：

我的主要活动中的 ProgressDialog 声明：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.somafm);

        ProgressDialog dialog = ProgressDialog.show(SomafmActivity.this, "", 
                "Loading. Please wait...", true); 
```

}

在我的 MusicService 中：

```
public void onPrepared(MediaPlayer player) {
    // The media player is done preparing. That means we can start playing!
    mState = State.Playing;
    updateNotification(mSongTitle + " (playing)");
    configAndStartMediaPlayer();
    ProgressDialog dialog = (ProgressDialog) SomafmActivity.dialog; //This line I believe is wrong
    dialog.dismiss();
} 
```

但我在 LogCat 中得到了 NullPointerException。我很确定从该位置关闭对话框会起到作用，因为直到流加载并开始播放后我才会收到错误消息。

我的问题是，我应该如何从我的音乐服务中正确引用我的 ProgressDialog？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:21:38.353

使用 hadler [http://developer.android.com/reference/android/os/Handler.html](http://developer.android.com/reference/android/os/Handler.html)在您的活动中创建处理程序，然后启动您的对话框并将处理程序传递给服务。服务启动时调用 hanler.handleMessage(message)。像[Android中的这个进度对话框](https://stackoverflow.com/questions/5431429/progress-dialog-in-android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:05:17.223

您在访问对话框的方式方面存在一些问题。您正在尝试访问作为特定方法成员的对话框，因此在该方法之外无法访问。此外，您正在尝试静态访问它，而不是从对相关活动的引用中访问它。

为了更好的形式，您可能应该做的是在您的活动中设置广播接收器，并在准备好时从您的服务发送广播。然后，从您的活动中，关闭进度对话框。您的 asynctask 应该有一个构造函数，该构造函数将您的活动中的进度对话框作为参数。

您将您的成员放在错误的类中，并试图以没有意义的方式访问它们。

这是服务和接收器的教程[http://www.vogella.com/articles/AndroidServices/article.html](http://www.vogella.com/articles/AndroidServices/article.html)

我还建议您复习一下您的 java 以及与面向对象编程相关的各种访问/范围规则。

# sql - 带有 IN 关键字的 SQL CASE 语句错误

> ID：12080403
> 
> 赞同：0
> 
> 时间：2012-08-22T19:50:55.010
> 
> 标签：sql, sql-server, sql-server-2008, case

我对这个语句有疑问，在关键字附近出现错误：

```
CASE [table1.TransType] IN('Accounts Receivable','Customer Sales')THEN table1.Amt 
            ELSE
            CASE WHEN [table1.Billable] IN(0,8,28) THEN table1.Amt 
            CASE WHEN [table1.Billable] IN(1,2,3,21,22,23)THEN table1.RecAmt 
            CASE WHEN [table1.Billable] IN(9)THEN 0                 
            END
            AS NetBilling 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:00:13.170

我相信你的括号可能是问题所在。`WHEN`在第一种情况下，您也缺少 a 。

这应该有效：

```
SELECT
CASE WHEN [table1].[TransType] IN ('Accounts Receivable','Customer Sales') THEN [table1].[Amt] 
  ELSE
    CASE
      WHEN [table1].[Billable] IN (0,8,28) THEN [Amt]
      WHEN [table1].[Billable] IN (1,2,3,21,22,23) THEN [table1].[RecAmt]
      WHEN [table1].[Billable] IN (9) THEN 0 END
END AS NetBilling
FROM [table1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:02:20.733

缺少 3 个 END：所有 CASE 语句都需要一个最终的 END ......所以请注意第一个 CASE ！

# version-control - 如何在交付给客户的应用程序源中包含 3rd 方 android 库代码？

> ID：12080404
> 
> 赞同：4
> 
> 时间：2012-08-22T19:50:55.567
> 
> 标签：version-control, android-library

我有一个应用程序，它目前正在使用来自 gitub 的 PullToRefresh 库之一。我已经分叉了那个 repo，做了一些更改以更好地适应我的应用程序。我有责任为我的客户提供我的应用程序的代码，所以这将包括库。将它包含在我的应用程序源代码中的推荐方法是什么（将 SVN 用于 android 应用程序本身）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-14T16:59:47.463

我想在这一点上，你早就解决了你的特定问题。对于子孙后代，那么：

如果您要向用户提供包含源快照的 zip，请将库源包含在子目录中。我还做了一个好的效果是构建一个发布包存档，其中包含二进制文件和源代码所需的所有不同位。

如果您要移交源代码存储库，您可以再次将每个存储库压缩成一个可以移交的包。为项目的每一部分记录上游可能是值得的，因此客户可以在需要时更新您的分叉。

# html - 在 Scala 中解析 HTML

> ID：12080408
> 
> 赞同：3
> 
> 时间：2012-08-22T19:51:11.107
> 
> 标签：html, xml, scala, xml-parsing, html-parsing

任务：HTML - Scala 中的解析器。我对 scala 很陌生。

到目前为止：我已经用 Scala 编写了一个小 Parser 来解析随机的 html 文档。

```
import scala.xml.Elem
import scala.xml.Node
import scala.collection.mutable.Queue
import scala.xml.Text
import scala.xml.PrettyPrinter

object Reader {
  def loadXML = {
    val parserFactory = new org.ccil.cowan.tagsoup.jaxp.SAXFactoryImpl
    val parser = parserFactory.newSAXParser()
    val source = new org.xml.sax.InputSource("http://www.randomurl.com")
    val adapter = new scala.xml.parsing.NoBindingFactoryAdapter
    val feed = adapter.loadXML(source, parser)
    feed
  }

  def proc(node: Node): String =
    node match {
      case <body>{ txt }</body> => "Partial content: " + txt
      case _ => "grmpf"
    }

  def main(args: Array[String]): Unit = {
    val content = Reader.loadXML
    Console.println(content)
    Console.println(proc(content))

  }
} 
```

1.  问题是“proc”不起作用。基本上，我想准确获取一个节点的内容。还是有另一种方法可以在不匹配的情况下实现这一目标？

2.  loadxml 函数中的“提要”是否为我提供了正确的解析格式，还是有更好的方法来实现这一点？Feed 还给我根节点，对吧？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T21:06:13.460

你是对的：`adapter.loadXML(source, parser)`给你根节点。问题是该根节点可能与`body`您`proc`方法中的情况不匹配。即使根节点是`body`，它仍然不会匹配，除非该元素只包含文本。

你可能想要更像这样的东西：

```
def proc(node: Node): String = (node \\ "body").text 
```

where`\\`是一个大致等同于 XPath 的选择器方法——即，它返回named`//`的所有后代。如果您知道这是根节点的子节点（而不是更深的后代），这可能是 HTML 的情况，您可以使用.`node``body``body``\``\\`

# mysql - PhpMyAdmin 在查询结果底部不显示查询结果操作

> ID：12080409
> 
> 赞同：0
> 
> 时间：2012-08-22T19:51:12.270
> 
> 标签：mysql, sql, phpmyadmin

我可以看到查询结果操作，这为我提供了一种为某些查询导出查询结果的方法，但对于其他有一堆连接的查询则不行。我觉得它是查询的类型。是这个原因还是结果的数量？

实际查询的快照：出于安全原因替换了变量

```
SELECT u.d, u.u, d1.d, u.f, u.e, u.m, u.b, u.s, u.g, u.ge, q1.c as Q1,
q2.c as Q2,
q31.c IS NOT NULL as Q31,
q32.c IS NOT NULL as Q32,
q33.c IS NOT NULL as Q33,
q34.c IS NOT NULL as Q34,
q35.c IS NOT NULL as Q35,
q36.c IS NOT NULL as Q36,
q37.c IS NOT NULL as Q37,
q38.c IS NOT NULL as Q38,
q39.c IS NOT NULL as Q39,
q310.c IS NOT NULL as Q310,
q311.c IS NOT NULL as Q311,
q312.c IS NOT NULL as Q312,
q313.c IS NOT NULL as Q313,
q41.c IS NOT NULL as Q41,
q42.c IS NOT NULL as Q42,
q43.c IS NOT NULL as Q43,
q44.c IS NOT NULL as Q44,
q45.c IS NOT NULL as Q45,
q46.c IS NOT NULL as Q46,
q47.c IS NOT NULL as Q47,
q48.c IS NOT NULL as Q48,
q5.c as Q5,
q61.c IS NOT NULL as Q61,
q62.c IS NOT NULL as Q62,
q63.c IS NOT NULL as Q63,
q64.c IS NOT NULL as Q64,
q65.c IS NOT NULL as Q65,
q7.c as Q7,
q81.c IS NOT NULL as Q81,
q82.c IS NOT NULL as Q82,
q83.c IS NOT NULL as Q83,
q84.c IS NOT NULL as Q84,
q85.c IS NOT NULL as Q85,
q9.openresponse as Q9
INTO
FROM `user` u 
LEFT JOIN dsschools d1 ON d1.name = u.s
INNER JOIN r q1 ON q1.u=u.u AND q1.qid=1

INNER JOIN r q2 ON q2.u=u.u AND q2.qid=2

LEFT JOIN r q31 ON q31.u=u.u AND q31.qid=3 AND q31.c=1
LEFT JOIN r q32 ON q32.u=u.u AND q32.qid=3 AND q32.c=2
LEFT JOIN r q33 ON q33.u=u.u AND q33.qid=3 AND q33.c=3
LEFT JOIN r q34 ON q34.u=u.u AND q34.qid=3 AND q34.c=4
LEFT JOIN r q35 ON q35.u=u.u AND q35.qid=3 AND q35.c=5
LEFT JOIN r q36 ON q36.u=u.u AND q36.qid=3 AND q36.c=6
LEFT JOIN r q37 ON q37.u=u.u AND q37.qid=3 AND q37.c=7
LEFT JOIN r q38 ON q38.u=u.u AND q38.qid=3 AND q38.c=8
LEFT JOIN r q39 ON q39.u=u.u AND q39.qid=3 AND q39.c=9
LEFT JOIN r q310 ON q310.u=u.u AND q310.qid=3 AND q310.c=10
LEFT JOIN r q311 ON q311.u=u.u AND q311.qid=3 AND q311.c=11
LEFT JOIN r q312 ON q312.u=u.u AND q312.qid=3 AND q312.c=12
LEFT JOIN r q313 ON q313.u=u.u AND q313.qid=3 AND q313.c=13

LEFT JOIN r q41 ON q41.u=u.u AND q41.qid=4 AND q41.c=1
LEFT JOIN r q42 ON q42.u=u.u AND q42.qid=4 AND q42.c=2
LEFT JOIN r q43 ON q43.u=u.u AND q43.qid=4 AND q43.c=3
LEFT JOIN r q44 ON q44.u=u.u AND q44.qid=4 AND q44.c=4
LEFT JOIN r q45 ON q45.u=u.u AND q45.qid=4 AND q45.c=5
LEFT JOIN r q46 ON q46.u=u.u AND q46.qid=4 AND q46.c=6
LEFT JOIN r q47 ON q47.u=u.u AND q47.qid=4 AND q47.c=7
LEFT JOIN r q48 ON q48.u=u.u AND q48.qid=4 AND q48.c=8

INNER JOIN r q5 ON q5.u=u.u AND q5.qid=5

LEFT JOIN r q61 ON q61.u=u.u AND q61.qid=6 AND q61.c=1
LEFT JOIN r q62 ON q62.u=u.u AND q62.qid=6 AND q62.c=2
LEFT JOIN r q63 ON q63.u=u.u AND q63.qid=6 AND q63.c=3
LEFT JOIN r q64 ON q64.u=u.u AND q64.qid=6 AND q64.c=4
LEFT JOIN r q65 ON q65.u=u.u AND q65.qid=6 AND q65.c=5

INNER JOIN r q7 ON q7.u=u.u AND q7.qid=7

LEFT JOIN r q81 ON q81.u=u.u AND q81.qid=8 AND q81.c=1
LEFT JOIN r q82 ON q82.u=u.u AND q82.qid=8 AND q82.c=2
LEFT JOIN r q83 ON q83.u=u.u AND q83.qid=8 AND q83.c=3
LEFT JOIN r q84 ON q84.u=u.u AND q84.qid=8 AND q84.c=4
LEFT JOIN r q85 ON q85.u=u.u AND q85.qid=8 AND q85.c=5

INNER JOIN r q9 ON q9.u=u.u AND q9.qid=9
LIMIT 20000,10000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-29T09:29:10.823

这是因为，您的查询很长，而 phpMyAdmin 版本 4.0.3 仍在撰写本文和我的使用中，当您发送长查询（包括任何评论）时，可能存在这个“错误”。它不会显示导出选项 - 查询结果操作。

Example: add any quite long comment (or command) it will stop to work, remove it, options will be there displayed again

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T17:16:45.863

原因之一可能是返回了太多字段，从而禁用了底部的导出选项。

# android - Android 测试帐户在应用内购买时获取项目不可用

> ID：12080414
> 
> 赞同：2
> 
> 时间：2012-08-22T19:51:36.950
> 
> 标签：android, testing, in-app-purchase

我在开发者资料中设置的测试帐户上测试应用内购买时遇到问题。

应用作为草稿上传，应用内产品发布，应用签名。当我在我的手机（开发者帐户）上测试应用内购买时，该项目被发现并出现在 Google Play 商店中。当我尝试从我的设备购买此产品时，我收到一个错误，我确定这是因为您不允许购买自己的产品。当我在主帐户是我的测试帐户之一的另一台设备上安装应用程序时，我收到“项目不可用”。我没有做恢复出厂设置，因为我请了一些朋友测试。

在我的个人资料中，我将它们列为 person1@gmail.com、person2@gmail.com、person3@gmail.com。

我觉得问题出在测试帐户上，因为使用开发人员帐户可以正常工作，但我不是 100% 确定。

谢谢

# winforms - TextBox 在退出其他控件时重置文本

> ID：12080418
> 
> 赞同：0
> 
> 时间：2012-08-22T19:51:47.433
> 
> 标签：winforms, .net-3.5, c#-3.0

我有一个带有多个控件的表单。在某些情况下，'textBoxOtherRelationship' 被禁用并且文本设置为 string.empty。但是，当我进入另一个控件并选择标签时，数据再次出现，而控件仍然处于禁用状态。

```
textBoxOtherRelationship.DataBindings.Add(new Binding("Text", _binder, "RelationshipNotes"));

  private void ComboBoxRelationShipSelectedValueChanged(object sender, EventArgs e)
        {
            if ((Constants.Relationship)comboBoxRelationShip.SelectedItem.DataValue == Constants.Relationship.Other)
            {
                textBoxOtherRelationship.Enabled = true;
                if (_formMode != ActionMode.ReadOnly)
                {
                    textBoxFirstName.BackColor = Color.White;
                }
            }
            else
            {
                textBoxOtherRelationship.Enabled = false;
                _model.RelationshipNotes = null;
                textBoxOtherRelationship.Text = string.Empty;
                if (_formMode != ActionMode.ReadOnly)
                {
                    textBoxFirstName.BackColor = Color.LightYellow;
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:38:13.120

嗯..所以我在这里看到这条线：

```
textBoxOtherRelationship.DataBindings.Add(
  new Binding("Text", _binder, "RelationshipNotes")); 
```

`Text`这告诉我您已经在 textBoxOtherRelationship 上的属性和 datasource 上名为“RelationshipNotes”的属性之间设置了绑定`_binder`。

伟大的。

所以，我假设双向绑定工作得很好，并且当您在 中键入内容`textBoxOtherRelationship`并且该控件失去焦点时，底层的 RelationshipNotes 属性也会更新，对吗？

现在，查看那里的代码，我认为当您将`Text`属性设置为时，底层数据源不会被更新，`string.Empty`因为这通常不会发生，直到文本框失去焦点并且您禁用了控件。

如果添加：

```
textBoxOtherRelationship.DataBindings[0].WriteValue(); 
```

将值设置`string.Empty`为该字符串后。空值将存储回数据源，因为数据绑定将知道有一些东西需要更新。以编程方式，它没有。

我看到你有这条线：

```
 textBoxOtherRelationship.Enabled = false;
            _model.RelationshipNotes = null; <<<----------------------
            textBoxOtherRelationship.Text = string.Empty; 
```

`_model.RelationshipNotes`最终应该绑定到该文本框的内容是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T22:27:51.303

SelectedIndexChanged 事件直到控件失去焦点后才会提交数据绑定，因此快速修复是首先在事件中写入值：

```
private void ComboBoxRelationShipSelectedValueChanged(object sender, EventArgs e)
{
  if (comboBoxRelationShip.DataBindings.Count > 0) {
    comboBoxRelationShip.DataBindings[0].WriteValue();

    if ((Constants.Relationship)comboBoxRelationShip.SelectedItem.DataValue ==
                                                 Constants.Relationship.Other) {
      textBoxOtherRelationship.Enabled = true;
      if (_formMode != ActionMode.ReadOnly) {
        textBoxFirstName.BackColor = Color.White;
      }
    } else {
      textBoxOtherRelationship.Enabled = false;
      _model.RelationshipNotes = null;
      textBoxOtherRelationship.Text = string.Empty;
      if (_formMode != ActionMode.ReadOnly) {
        textBoxFirstName.BackColor = Color.LightYellow;
      }
    }
  }
} 
```

# c# - clrzmq c#示例不起作用

> ID：12080420
> 
> 赞同：1
> 
> 时间：2012-08-22T19:51:51.800
> 
> 标签：c#, binding, zeromq

我对 c# 的官方 zeromq 绑定有问题： [https ://github.com/zeromq/clrzmq](https://github.com/zeromq/clrzmq)

这是订阅者的示例：[https ://github.com/imatix/zguide/blob/master/examples/C%23/psenvsub.cs](https://github.com/imatix/zguide/blob/master/examples/C%23/psenvsub.cs)

我已经完成了 MS Visual Studio 2010 Ultimate 中的所有步骤，但是这个示例不起作用。

首先，我没有找到命名空间 ZMQ，但 ZeroMQ 有。其次，语法错误：

```
subscriber.Subscribe("B", Encoding.Unicode); 
```

> 错误 1 ​​方法 'Subscribe' 没有重载需要 2 个参数 D:\LANG\c#\zmqtest\quotesclient\quotesclient.cs 23 21 quotesclient

定义如下：

```
public virtual void Subscribe(byte[] prefix); 
```

请告诉我，这个绑定是怎么回事？以及如何在 c# 中使用 zeromq？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T07:26:14.537

你是通过nuget得到clrzmq的吗？您是否检查了您在 package.config 中获得的版本？如果您没有在包管理器中选择“包含预发布”选项并特别要求版本 3（“测试版”），那么 nuget 提供了 clrzmq 的版本 2（“稳定”）这一事实抓住了这一点。两个版本之间的 API 发生了变化。

# dart - Dart 中输出或引用参数的等效代码

> ID：12080422
> 
> 赞同：8
> 
> 时间：2012-08-22T19:51:55.240
> 
> 标签：dart

在 Dart 中，我如何最好地编写（不可变/值/非对象）**输出或引用参数**的等效代码？

例如，在 C#-ish 中，我可能会编写代码：

```
function void example()
{
  int result = 0;
  if (tryFindResult(anObject, ref result))
    processResult(result);
  else
    processForNoResult();
}

function bool tryFindResult(Object obj, ref int result)
{
  if (obj.Contains("what I'm looking for"))
  {
    result = aValue;
    return true;
  }
  return false;  
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T21:30:50.163

这在 Dart 中是不可能的。Dart 邮件列表中讨论了对结构值类型、ref 或 val 关键字的支持，就像 week 一样。这是一个讨论的链接，您应该在其中表达您的愿望：

[https://groups.google.com/a/dartlang.org/d/topic/misc/iP5TiJMW1F8/discussion](https://groups.google.com/a/dartlang.org/d/topic/misc/iP5TiJMW1F8/discussion)

飞镖方式将是：

```
void example() {
  List result = tryFindResult(anObject);
  if (result[0]) {
    processResult(result[1]);
  } else {
    processForNoResult();
  }
}

List tryFindResult(Object obj) {
  if (obj.contains("What I'm looking for")) {
    return [true, aValue];
  }
  return [false, null];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-15T10:36:56.673

你也可以使用像 tuple-2.0.0 这样的元组包

将元组：^2.0.0 添加到您的 pubspec.yaml

那么任何函数都可以返回许多类型的对象，如下所示：

```
import 'package:tuple/tuple.dart';

Tuple3<int, String, bool?>? returnMany() {
return ok ? Tuple3(5, "OK", null) : null;
}

var str = returnMany().item2; 
```

在你的情况下：

```
void example() {
  var result = tryFindResult(anObject);
  if (result.item1) {
    processResult(result.item2!);
  } else {
    processForNoResult();
  }
}

Tuple2<bool, int?> tryFindResult(Object obj) {
  if (obj.contains("What I'm looking for")) {
    return Tuple2(true, aValue);
  }
  return Tuple2(false, null);
} 
```

当没有结果时，您也可以抛出异常。

```
void example() {
  var result = tryFindResult(anObject);
  try {
    processResult(result);
  } on NullException catch(e){
    processForNoResult();
  }
}

int tryFindResult(Object obj) { // throws NullException
  if (obj.contains("What I'm looking for")) {
    return aValue;
  }
  throw NullException();
} 
```

# javascript - JSON 和 javascript 对象

> ID：12080424
> 
> 赞同：0
> 
> 时间：2012-08-22T19:52:06.303
> 
> 标签：javascript, json

```
var foo = { "a": 1, "b": true, c: [1, true, "2"] }; 
```

如果我在这里错了，请纠正我，但据我所知，这是一个有效的 json 对象。但它也是一个 javascript 对象。

JSON 对象是基于 javascript 语言的吗？或者是周围的其他方式？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T19:54:56.793

> JSON 对象是基于 javascript 语言的吗？

是的。

见[规格](http://www.ietf.org/rfc/rfc4627.txt)：

> JavaScript Object Notation (JSON) 是一种轻量级的、基于文本的、独立于语言的数据交换格式。它源自 ECMAScript 编程语言标准。

请注意，ECMAScript 是[JavaScript 的标准化版本](http://en.wikipedia.org/wiki/ECMAScript)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T19:56:38.090

来自[JSON](http://www.json.org/)网站

> JSON（JavaScript Object Notation）是一种轻量级的数据交换格式。人类很容易阅读和写作。机器很容易解析和生成。它基于 JavaScript 编程语言的一个子集。

所以你的问题的答案是肯定的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:02:15.773

“如果我在这里错了，请纠正我，但据我所知，这是一个有效的 json 对象”

不。

“但它也是一个 javascript 对象。”

是的。

更新：我的原始答案在下面继续，但我错过了一个重要的语法错误，@badunk 很有帮助地指出

字符串

```
{ "a": 1, "b": true, c: [1, true, "2"] } 
```

是 JSON。JSON 只是关于*符号*- 关于哪些符号构成有效的语法，以及它们在被处理后的含义。

你的代码：

```
var foo = { "a": 1, "b": true, c: [1, true, "2"] }; 
```

..是一段javascript。解析和处理 this 时，赋值右侧的部分称为 javascript 对象字面量。也就是说，一段表示文字对象的javascript。但是因为它实际上是一个对象，所以它不再是符号——它被处理成一个运行时数据结构。

当您谈论数据交换（例如通过 HTTP）时，术语 JSON 很有用。如果 HTTP 响应传递了这样的字符串：

```
{ "a": 1, "b": true, c: [1, true, "2"] } 
```

它是有效的 JSON。如果这将被解释，它将导致一个 javascript 对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T20:04:25.633

有人可能会争辩说没有“JSON 对象”这样的东西（http://benalman.com/news/2010/03/theres-no-such-thing-as-a-json/）。

上面的代码实际上是一个对象文字。另一方面，JSON 只是一个对象的字符串表示，即它是一个序列化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-22T20:26:21.550

正如@Roland 指出的那样，语句本身是一个 javascript 表达式，而不是 JSON。但是，忽略这一点，并评估以下是否为 JSON：

```
{ "a": 1, "b": true, c: [1, true, "2"] } 
```

我不同意这里的其他答案，这不是有效的 JSON。严格来说，属性必须用引号括起来。[请参阅此处](https://stackoverflow.com/questions/380855/json-syntax-for-property-names)的 SO 帖子。这是正确的 JSON：

```
{ "a": 1, "b": true, "c": [1, true, "2"] } 
```

# django - Django 在打印之前将 1 添加到 pages.current (django-endless-pagination)

> ID：12080426
> 
> 赞同：0
> 
> 时间：2012-08-22T19:52:12.047
> 
> 标签：django, html, css, django-endless-pagination

我有一个变量 pages.current。我想在网页上显示这个变量 + 1。（即如果 pages.current 为 1，我希望它显示 2；等等）。

我当前的代码：

```
<p>Page {{ pages.current|add:"1" }} </p>. 
```

不幸的是，这似乎不起作用（该代码仅显示 pages.current 的值，没有 +1），我不明白为什么。谢谢！

# visual-studio-2008 - Windows Mobile 5.0 按钮样式

> ID：12080427
> 
> 赞同：1
> 
> 时间：2012-08-22T19:52:19.100
> 
> 标签：visual-studio-2008, button, styles, windows-mobile-5.0

我目前正在使用 Windows Mobile 5.0 开发一个项目（我知道它已经过时了，但它适用于工业 PDA，我坚持使用它），我想知道是否有任何方法可以改变我的应用程序的风格（按钮，树视图......）所以我的应用程序看起来并不那么它只是一堆上面有名字的盒子。

如果有帮助的话，我目前正在 Win7 机器上使用 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T04:22:35.873

只能通过子类化它们并在那里扩展 Paint 方法来更改库存窗口元素。有很多例子和框架可以做到这一点。例如带有图像或不规则形状的按钮。

您也可以使用 html，然后使用像 Jo 这样的通用框架来创建一个看起来像 Android 的 GUI。

子类化控件：http: [//msdn.microsoft.com/en-us/library/ms229681%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms229681%28v=vs.85%29.aspx)

布局管理器：[http ://www.hjgode.de/wp/2010/07/17/mobile-development-using-layout-managers/](http://www.hjgode.de/wp/2010/07/17/mobile-development-using-layout-managers/)

Jo 和 PhoneGap： http: [//joapp.com/](http://joapp.com/)（需要 zetaKey 之类的 html5 浏览器 [http://www.zetakey.com/index.php]）

# oracle - 值不存在时无法“SELECT INTO”

> ID：12080428
> 
> 赞同：7
> 
> 时间：2012-08-22T19:52:19.833
> 
> 标签：oracle, plsql, package, select-into

```
SELECT Value1 INTO lValue
FROM   Table1
WHERE  Field1 = lTempValue; 
```

当匹配为真时，这工作正常。但如果匹配不正确，我会收到错误消息。

```
ORA-01403: no data found 
```

理想情况下，这对我来说很好，因为我接下来要检查该值是否高于 0，如果是，则在插入查询中使用该值。我不想检查该值，然后必须运行相同的查询来检索它，如果可能的话，我想在一个查询中进行，但我不知道这是如何完成的。

如果有一个值，那么我希望该值进入 lValue。如果没有值，那么我希望 0 进入 lValue。有人有什么想法吗？我只做了一个快速的谷歌检查，但它干涸了。想我会在寻找的时候发布这个。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-22T19:53:47.413

通常，您只需捕获异常

```
BEGIN
  SELECT value1
    INTO lValue
    FROM table1
   WHERE field1 = lTempValue;
EXCEPTION
  WHEN no_data_found
  THEN
    lvalue := 0;
END; 
```

`NVL`您可以通过使用和聚合函数（`MIN`或）编写更少的代码，`MAX`但这往往不太明显（例如，请注意，这些答案必须修改几次）。它要求任何追随你的人暂停片刻，以了解你在做什么（以及你是否做得正确）。一个简单的嵌套 PL/SQL 块非常常见且不言自明。

然而，不仅如此，它并没有隐藏由于重复行导致的错误。如果您碰巧在`table1`where `field1`is中有两行，则`lTempValue`仅捕获`no_data_found`异常会导致意外`too_many_rows`传播到调用者的异常。由于您不希望有多行，这正是您想要的行为。使用聚合函数隐藏了这样一个事实，即基础数据存在问题，导致您返回可能不正确的结果，并且无法检测到存在问题。我总是宁愿在出现导致重复行出现时立即得到错误——让我在问题失控之前解决问题——而不是几年后发现我们有数百万个重复行，代码偶尔会返回不正确的结果，并且我们在解决根本原因后进行了大量的数据清理工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T20:32:37.487

作为 Justin Cave 建议的替代方案，您可以稍微重写查询，使其始终返回一行 — 如下所示：

```
SELECT NVL(Value1, 0) INTO lValue
FROM   Table1
RIGHT
JOIN   dual
ON     Field1 = lTempValue 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-24T19:43:17.317

似乎每个人都真的过于复杂了，假设你的值不是像记录或 clob 这样的奇怪类型：

```
SELECT NVL(MIN(Value1), 0) INTO lValue
FROM   Table1
WHERE  Field1 = lTempValue; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T21:23:43.683

我会把它作为一个游标来做——只是为了安全起见（因为，我不喜欢像`BEGIN ....END;`我的存储过程中那样杂散的 PLSQL 块的想法），比如

```
CREATE OR REPLACE .....
...

 CURSOR c_get_val IS
 SELECT Value1 
 FROM   Table1
 WHERE  Field1 = lTempValue;

 lValue    Table1.Value1%TYPE;
 lTempValue  Table1.Table1%TYPE; 
```

进而，

```
BEGIN
...
....
 /* populate lTempValue */

 OPEN c_get_val;
 FETCH c_get_val INTO lValue;
 if c_get_val%NOTFOUND    --this is where you handle ORA-01403: no data found
 then
   lValue := 0;
   /*or call a function, do some other stuff*/
 end if;
 CLOSE c_get_val; 
...
...
EXCEPTION
  /*do some smart exception handling here*/
END; 
```

[关于游标](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/cursor_declaration.htm)的一些信息，还有[更多](http://asktom.oracle.com/pls/asktom/f?p=100:11%3a%3a%3a%3a%3aP11_QUESTION_ID:1288401763279)，还有[更多](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/cursor_attributes.htm)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-24T21:04:51.180

```
BEGIN
  SELECT value1
    INTO lValue
    FROM table1
   WHERE field1 = lTempValue;
EXCEPTION
  WHEN no_data_found
  THEN
    lvalue := 0;
EXCEPTION
  WHEN too_many_rows
  THEN
    lvalue := 0;
END; 
```

# c# - 使用 MEF，如何导出 ItemsControl 的视图？

> ID：12080430
> 
> 赞同：0
> 
> 时间：2012-08-22T19:52:29.687
> 
> 标签：c#, mvvm, prism, mef, datatemplate

`enter code here`也许标题不是那么具体。

我现在的情况是。我有一个`ItemsControl`我插入很多的地方`ViewModels`，这`ItemsControl`应该显示`View`通过`DataTemplates`。

所以，我把这些写在`ResourceDictionary`：

![在此处输入图像描述](../Images/dd8702767d429119802e6a104e207d76.png)

然后，我将它添加`ResourceDictionary`到`ApplicationResources`.

这太多余了，太累了。

我`MVVM`也在使用，所以我在想是否可以使用 MEF 来发现`View`应该绘制的相应内容。我正在调查创建自定义属性标签可能是简化这些冗余代码的好主意，也许在视图中添加这个标签告诉它`ViewModel`应该为这个视图绘制，但我迷失了 MEF。

计划是删除`ResourceDictionary`.

你能帮我一把吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:35:21.640

在我的主机 WPF 应用程序中，我添加了这个导入：

```
[ImportMany("ApplicationResources", typeof(ResourceDictionary))]
public IEnumerable<ResourceDictionary> Views { get; set; } 
```

ResourceDictionary 背后的代码：

```
[Export("ApplicationResources", typeof(ResourceDictionary))]
public partial class ItemView : ResourceDictionary 
{
    public ItemView()
    {
        InitializeComponent();
    }
} 
```

作为参考，示例 ResourceDictionary 的 Xaml 如下所示：

```
<DataTemplate DataType="{x:Type local:ItemViewModel}">
    ...
</DataTemplate> 
```

在 WPF 应用程序中，在主窗口之前：

```
// Add the imported resource dictionaries
// to the application resources
foreach (ResourceDictionary r in Views)
{
    this.Resources.MergedDictionaries.Add(r);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-25T03:00:11.180

```
[System.ComponentModel.Composition.InheritedExport(typeof(ProblemView))]
public abstract class ProblemView : UserControl // or whatever your Views inherit
{
   public abstract Type ViewModelType { get; }
}

[System.ComponentModel.Composition.InheritedExport(typeof(ProblemViewModel))]
public abstract class ProblemViewModel : BaseViewModel // or whatever your ViewModels inherit
{
}

// in your App class
{
   [ImportMany(typeof(ProblemView))]
   public ProblemView[] Views { get; set; }
   [ImportMany(typeof(ProblemViewModel))]
   public ProblemViewModel[] ViewModels { get; set; }

   void MarryViewViewModels()
   {// called during MEF composition
      foreach (ProblemView view in Views)
      {
         foreach(ProblemViewModel vm in ViewModels)
         {
            if(Equals(view.ViewModelType, vm.GetType())
            {// match -> inject the ViewModel
               view.DataContext = vm;
               break;
            }
         }      
      }
   }
}

// example of usage
public partial class SomeView : ProblemView
{
   public override Type ViewModelType { get { return typeof(SomeViewModel); } }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:56:07.173

让我解释一下如何设置这样的东西。您可以在官方[文档中查找更多信息](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition%28VS.100%29.aspx)

最好的实现是使用接口和鸭子类型。

```
public interface IModule {
    DataTemplate Template { get; set; }
    string Name{get;set;}
    ...
} 
```

然后对于每个插件，继承这个接口

```
[Export(typeof(IModule ))]
public class SampleModule : IModule {
    private DataTemplate template;
    public DataTemplate IModule.Template {
        get { return this.teplate; }
        set { this.template = value; }
    }

    private string name = "SamplePlugin";
    public string  IModule.Name{
        get { return this.name ; }
        set { this.name = value; }
    }

    ...
} 
```

SampleModule 类在单独的程序集中，而 IModule 与 Application 和每个模块程序集都相同。

现在您需要加载应用程序可用的每个模块。此代码片段来自应用程序窗口

```
...
[ImportMany]
public IEnumerable<IModule> ModulesAvailable {get;set;}
...
public void LoadModules(string path) {
    DirectoryCatalog catalog = new DirectoryCatalog(path);
    catalog.ComposeParts(this);
} 
```

现在您可以使用 foreach 循环并将它们添加到应用程序资源

```
foreach(IModule module in ModulesAvailable) {
    Application.Current.Resources.Add(module.Template, module.Name);
} 
```

这只是概念，代码未经测试。

[我在几个月前做的高中期末项目](https://github.com/AleksandarDev/Project---Metro-Tables)中使用了 MEF ，所以你可以看看我的代码。它是支持公式的电子表格应用程序，所有操作和操作数都作为插件加载，因此非常灵活。

# sql - 同时插入数据和查询数据的标准协议

> ID：12080431
> 
> 赞同：0
> 
> 时间：2012-08-22T19:52:51.683
> 
> 标签：sql, sql-server, sql-server-2008, tsql, ssis

每天我们都会运行一个 SSIS 包来将数据导入数据库。

有时人们同时查询数据库。

加载（数据导入）超时，因为特定表上有表锁。

**同时插入数据和查询数据的标准协议是什么？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:33:53.060

首先你需要弄清楚这些锁是从哪里来的。使用链接查看是否有任何锁。

[如何：确定哪些查询持有锁](http://msdn.microsoft.com/en-us/library/bb677357%28v=sql.105%29.aspx)

如果您有另一个持有表锁的进程，那么您无能为力。

您确定错误是“无法获得表锁”。如果是这样，请考虑将您的 SSIS 包更改为不使用表锁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:23:29.703

有几种策略。

一种方法是设计 ETL 管道以最小化锁定时间。所有数据都在暂存表中准备好，然后在完成后使用快速分区切换操作进行切换，请参阅[使用分区切换有效地传输数据](http://msdn.microsoft.com/en-us/library/ms191160%28v=sql.105%29.aspx)。这样，ETL 块会在很短的时间内读取 onyl。它还有一个优点是读取可以一次看到所有 ETL 数据，而不是中间阶段。缺点是实施困难。

另一种方法是在数据库中启用快照隔离和/或读取提交的快照，请参阅[数据库引擎中基于行版本控制的隔离级别](http://msdn.microsoft.com/en-us/library/ms177404%28v=sql.105%29)。这种方式读取不再阻塞在 ETL 持有的锁后面。缺点是资源消耗，硬件必须能够驱动行版本控制的额外负载。

还有一种方法是将数据查询移动到只读备用服务器，例如。使用[日志传送](http://msdn.microsoft.com/en-us/library/bb895393%28v=sql.105%29.aspx)。

# php - 用于 msking imagick thumbs 的 php filemtime 排序

> ID：12080432
> 
> 赞同：1
> 
> 时间：2012-08-22T19:53:02.393
> 
> 标签：php, imagick, filemtime

我正在尝试使用 php filemtime 在相册中查找最新添加的图像（文件夹）并使用 Imagick 制作拇指。

我知道找到最新文件夹的那部分脚本确实有效，并且也适用于 Imagick 部分。把这两个放在一起就是问题所在。这里有一群更聪明的人 - 有人可以帮助并使其发挥作用吗？

脚本如下所示：

```
<?php

/* paths to the images */
$directory  = '../i/albums';
$fdirectory = opendir("$directory");
while (false !== ($file       = readdir($fdirectory))) {
    if (($file != ".") && ($file != ".." ) && ($file != "index.php~" ) && ($file != "index.php" )) {

        $files[$file] = filemtime("$directory/$file");
    }
}
closedir($fdirectory);
clearstatcache();
arsort($files);
$i            = 0;
while ((list($key1, $val) = each($files)) && ($i <= 0))
    $newdirectory = $directory . '/' . $key1 . '/thumbs/'; /* Problem is probably here */
/* Making thumbnail starts here */
/* The object used as a canvas */
$canvas       = new imagick('../images/wood_grain_3030646.jpg');
$canvas->adaptiveResizeImage(250, 250);
$canvas->setImageFormat("png");
/* Create an empty ImagickDraw object
  (Use the defaults for the polaroid) */
$bg           = new ImagickDraw();
/* Create a few random images */
/* Imagick seems not to like  $newdirectory here */
$images       = new Imagick(glob("" . $newdirectory . "{*.jpg,*.gif,*.png}", GLOB_BRACE));
/* Loop trough images, overlay on canvas and remove the image */
foreach ($images as $key => $imag) {
    /* Thumbnail to 100x width and set background to black.
      It looks like an drop-in shadow */
    $imag->thumbnailImage(100, null);
    $imag->setImageBackgroundColor(new ImagickPixel("black"));
    /* Use a random angle */
    $angle = mt_rand(1, 45);
    if (mt_rand(1, 2) % 2 === 0) {
        $angle  = $angle * -1;
    }
    /* Create the polaroid */
    $imag->polaroidImage($bg, $angle);
    /* Composite the polaroid over the canvas */
    /* Composite to a random location */
    $canvas->compositeImage($imag, Imagick::COMPOSITE_OVER, mt_rand(10, 150), mt_rand(10, 150));
    /* Round the corners. (yes, this is all that is needed.) */
    $canvas->roundCorners(10, 10);
    /* Clone the current object */
    $shadow = $canvas->clone();
    /* Set image background color to black
      (this is the color of the shadow) */
    $shadow->setImageBackgroundColor(new ImagickPixel('black'));
    /* Create the shadow */
    $shadow->shadowImage(80, 3, 5, 5);
    /* Imagick::shadowImage only creates the shadow.
      That is why the original image is composited over it */
    $shadow->compositeImage($canvas, Imagick::COMPOSITE_OVER, 0, 0);
    /* Free some resources */
    $imag->removeImage();
    /* Add some contrast */
    $shadow->contrastImage(20);

    $shadow->writeImages("../images/polaroids/polaroids_thumb.png", true);
}
/* Display the results */
header("Content-Type: image/png");
echo $shadow;
?> 
```

我已经单独测试了 Imagick 部分，如果用于静态文件夹，它实际上可以工作。

# javascript - 为什么更改原型不会影响先前创建的对象？

> ID：12080434
> 
> 赞同：6
> 
> 时间：2012-08-22T19:53:09.423
> 
> 标签：javascript, prototype

我有以下代码：

```
var A = function() {};
var a = new A();
var b = new A();
A.prototype.member1 = 10;

A.prototype = {}
var c = new A();
console.log(a.member1);
console.log(a.constructor === b.constructor);
console.log(a.constructor === c.constructor);
console.log('---------');
console.log(c.member1); 
```

它的输出是：

```
10
true
false
---------
undefined
undefined 
```

的原型`a`并`b`没有改变，而是`c`有了一个新的。我是对的，这是由于`a.constructor`不等于`c.constructor`并且他们每个人都有自己的事实造成的`prototype`吗？当两个对象的构造函数可能不相等时，是否还有其他循环？

额外的问题：为什么要打印两个`undefined`字符串？（铬）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:05:54.613

在你打电话的时候

```
var a = new A(); 
```

基本上这个任务完成了：

```
a.__proto__ = A.prototype; 
```

然后你将 重新分配`A.prototype`给一个新对象，所以`c`得到`{}`它的原型。

```
A.prototype = {};
var c = new A(); 
```

但是，这不会破坏旧`A.prototype`对象 -`a.__proto__`仍然指向它。

> 我是否正确，这是因为 a.constructor 不等于 c.constructor 并且它们每个人都有自己的原型？

`.constructor`基本上只是一个便利属性。它对实例的行为方式没有影响。

> 额外的问题：为什么打印了两个未定义的字符串？

不在我的控制台中，他们没有！（歌剧 12）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:06:33.677

创建对象时，构造函数的原型被分配给`__proto__`新对象的属性。然后，您正在更改原型，但两个`a`和`b`对象已经指向原始引用：

```
var a = new A();
// a.__proto__ == A.prototype == {} (soon == {member1:10})
var b = new A();
// b.__proto__ == A.prototype == {} (soon == {member1:10})

A.prototype = {} // this changes A.prototype, but not a.__proto__ or b.__proto__
var c = new A(); // c.__proto__ = {} 
```

你的第一个`undefined`来自`c.member1`. 第二个是 chrome 说你的整个语句没有返回值

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T20:07:52.387

答案就在这行代码中：

```
A.prototype = {} 
```

当您到达这行代码时，实际上是在内存中创建了一个全新的对象 {}。使用 A 作为构造函数创建任何新对象都将指向这个 BRAND NEW OBJECT 作为原型。

但是，OLD PROTOTYPE 仍然存在于内存中。只是 A.prototype 不再指向它。在重新定义 A 的原型引用之前，您使用 A 作为构造函数创建的任何对象仍然指向此 OLD PROTOTYPE，因为它是原型。

# objective-c - Mac - 从浏览器传递参数启动桌面应用程序

> ID：12080447
> 
> 赞同：1
> 
> 时间：2012-08-22T19:54:02.837
> 
> 标签：objective-c, macos, clickonce, single-sign-on

我在 Windows 机器上运行的 .Net 中编写了一个单击一次部署的应用程序。我需要从浏览器启动应用程序，以便我可以根据当前浏览器会话将信息传递给应用程序（HTTPHeader 包含需要传递给应用程序的单点登录 ID，以便它可以调用安全 Web服务）。

所以 click-once 应用程序作为 jsp 上的链接提供，所需的 id 作为链接中的查询字符串参数传递，click once 应用程序可以读取）。

现在我需要为 Mac 用户提供类似的功能。有什么不需要Java的方法吗？我想用Objective C编写，但是如何从浏览器触发应用程序的启动，传递必要的信息的问题仍然存在。

流程是：

1.  用户点击我们网站的链接
2.  用户被路由到单点登录身份验证表单
3.  用户提交表单并被重定向到我们的网站（ID 嵌入在 HTTPHeader 中）
4.  服务器构建页面，其中包含指向 Click Once 应用程序的链接，其中 id 作为查询字符串参数附加
5.  用户单击链接，一旦部署的应用程序被下载并在用户计算机上以完全信任的方式执行（应用程序使用代码签名证书进行签名），请单击该链接。
6.  应用程序在用户计算机上本地运行，并在服务器上调用 RESTful Web 服务，将单点登录 ID 作为 cookie 与允许请求通过的 Web 请求一起传递。

我将不胜感激任何可以为我指明正确道路的想法，因为我主要是一名 Windows 开发人员。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:20:37.373

我刚刚看到你对我关于这个主题的[原始帖子的要求。](https://stackoverflow.com/questions/7445729/click-once-deployment-for-mac#comment16621337_7445729)

对此的需求一度被搁置一旁，但我们可能会追求的解决方案是拥有一个服务器端进程，可以即时修改交付的 Zip 或 DMG 文件。附加信息将被插入到应用程序的 Info.plist 文件中。这不会使加密签名无效，并且不需要下载任何其他内容。

# asp.net - 与网站在同一端口上的 ASP.Net MVC4 自托管 API

> ID：12080449
> 
> 赞同：0
> 
> 时间：2012-08-22T19:54:08.367
> 
> 标签：asp.net, ajax, upload, asp.net-web-api

亲爱的开发者朋友们，

我在 ASP.Net MVC4 中开发了一个自托管 API（例如[http://blogs.msdn.com/b/henrikn/archive/2012/03/01/file-upload-and-asp-net-web-api .aspx](http://blogs.msdn.com/b/henrikn/archive/2012/03/01/file-upload-and-asp-net-web-api.aspx)），因为我需要一个可以上传超大文件的解决方案。这工作顺利。

现在我想通过[Bluimp JQuery Upload 组件](http://blueimp.github.com/jQuery-File-Upload/)将文件上传到我新编写的 API 。

这工作正常，除了一些小缺陷：
- 进度条未显示
- JQuery 引发错误：*不安全的 JavaScript 尝试使用 URL 访问框架...*

这个错误似乎很明显，因为我的 API 在 Web 应用程序之外的另一个端口上运行，并且无法通过跨域/端口进行 ajax 调用。

我已经在 fileupload 组件调用中添加了 forceIframeTransport: true 参数。这有一些好处 - 没有它我根本无法上传文件（因为组件尝试使用 ajax 调用上传）。

所以... 但是..我不太确定这是否可能..

不幸的是，我的 ASP.Net 应用程序的代理在这里对我没有帮助，因为我编写了 API 以*避免*IIS 限制（关于最大上传大小）。使用我的自托管 API 作为代理可能会完成这项工作，但我认为这有点……矫枉过正？

任何人？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:27:54.780

雅虎！解决了！

var config = new HttpSelfHostConfiguration("http://localhost:49302/ **api** ");

换句话说 - web api 仅在 url 以**/api**开头时有效。所有其他请求都由我的 MVC4 Web 应用程序接收。但是它们在同一个端口上运行。

所以回答我的问题：是的，这是可能的。只需添加一个根目录。

# javascript - Facebook Like 按钮 - 是否已选中？

> ID：12080452
> 
> 赞同：1
> 
> 时间：2012-08-22T19:54:26.057
> 
> 标签：javascript, facebook, facebook-like

我很难找到关于如何使用 javascript 来确定是否单击了类似按钮的良好文档。我不能使用点击事件，因为当用户进入我的页面时可能已经检查了该按钮，但这似乎是我能找到的关于从外部跟踪喜欢的所有内容（不包括不再支持的其他方法）。任何人都对此类问题有任何经验？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:00:11.817

这取决于“赞”按钮。如果是针对具有 ID 的 Facebook 对象，您可以查询**like**表（但您需要*user_likes*权限）

如果它是一个 URL，那是不可能的：[facebook graph api 确定用户是否喜欢 url](https://stackoverflow.com/questions/4322033/facebook-graph-api-determine-if-user-likes-url) [stackoverflow]

它是[内置的，就像](https://developers.facebook.com/docs/opengraph/actions/builtin/likes/)您可以使用 cookie 来记住点击，或将点击保存在您自己的数据库中一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T09:57:10.833

只是为了扩展吉尔的答案。对于内置的点赞，您可以使用包含两个请求的批处理请求：1）尝试点赞有问题的对象 2）如果没有错误，删除点赞连接

示例批次：

```
[{"method":"POST", "relative_url":"me/og.likes", "body":"object=<SOME_URL>", "name":"like-attempt", "omit_response_on_success": false},
{"method":"DELETE", "relative_url":"{result=like-attempt:$.id}"}] 
```

如果一个对象已经被喜欢，批处理响应将是：

```
[
    {
        "code": 400,
        "headers": [
            ...
            {
                "name": "WWW-Authenticate",
                "value": "OAuth \"Facebook Platform\" \"invalid_request\" \"(#3501) User is already associated to the object object on a unique action type Like. Original Action ID: 143539809123515\""
            }
        ],
        "body": "{\n \"error\": {\n \"message\": \"(#3501) User is already associated to the object object on a unique action type Like. Original Action ID: 143539809123515\",\n \"type\": \"OAuthException\",\n \"code\": 3501\n }\n}"
    },
    null
] 
```

因此，要检查对象是否被喜欢，JSON.parse 第一个响应正文并查找带有错误代码的错误`3501`。请记住，实际的错误代码没有记录在任何地方，因此它可能会改变，尽管我认为这不太可能。

# c# - 仅在 Kinect 前面直接检测用户的语音

> ID：12080457
> 
> 赞同：3
> 
> 时间：2012-08-22T19:54:38.180
> 
> 标签：c#, kinect

我想让 kinect 只接收直接在它前面的用户的语音。我不希望检测到噪音或左右两侧说话的人。或者，如果用户移动到 kinect 的右侧或左侧。这可能吗？

```
var audioSource = this.Kinect.AudioSource;
audioSource.BeamAngleMode = BeamAngleMode.Adaptive;
var kinectStream = audioSource.Start(); 
```

我玩过 ManualBeamAngle，但不认为那是我想要的。

任何帮助，将不胜感激。cp

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T21:36:25.073

您可以使用 Source 角度来找到它，它们在中间时都是 0。请参阅[Audio Basics - WPF](http://msdn.microsoft.com/en-us/library/jj131039.aspx)，并将代码更改为：

```
 double sourceAngle;

    ...

    private void AudioSourceBeamChanged(object sender, BeamAngleChangedEventArgs e)
    {
        beamRotation.Angle = -e.Angle;
        sourceAngle = e.Angle;
        beamAngleText.Text = string.Format(CultureInfo.CurrentCulture, Properties.Resources.BeamAngle, e.Angle.ToString("0", CultureInfo.CurrentCulture));
    }

    private void AudioSourceBeamChanged(object sender, BeamAngleChangedEventArgs e)
    {
        beamRotation.Angle = -e.Angle;
        beamAngleText.Text = string.Format(CultureInfo.CurrentCulture, Properties.Resources.BeamAngle, e.Angle.ToString("0", CultureInfo.CurrentCulture));
    }

    private void AudioReadingThread()
    {
        // Bottom portion of computed energy signal that will be discarded as noise.
        // Only portion of signal above noise floor will be displayed.
        const double EnergyNoiseFloor = 0.2;

        while (this.reading)
        {
            while (sourceAngle == 0) //this is the important part
            {
                int readCount = audioStream.Read(audioBuffer, 0, audioBuffer.Length);

                // Calculate energy corresponding to captured audio in the dispatcher
                // (UI Thread) context, so that rendering code doesn't need to
                // perform additional synchronization.
                Dispatcher.BeginInvoke(
                new Action(
                    () =>
                    {
                        for (int i = 0; i < readCount; i += 2)
                        {
                            // compute the sum of squares of audio samples that will get accumulated
                            // into a single energy value.
                            short audioSample = BitConverter.ToInt16(audioBuffer, i);
                            this.accumulatedSquareSum += audioSample * audioSample;
                            ++this.accumulatedSampleCount;

                            if (this.accumulatedSampleCount < SamplesPerColumn)
                            {
                                continue;
                            }

                            // Each energy value will represent the logarithm of the mean of the
                            // sum of squares of a group of audio samples.
                            double meanSquare = this.accumulatedSquareSum / SamplesPerColumn;
                            double amplitude = Math.Log(meanSquare) / Math.Log(int.MaxValue);

                            // Renormalize signal above noise floor to [0,1] range.
                            this.energy[this.energyIndex] = Math.Max(0, amplitude - EnergyNoiseFloor) / (1 - EnergyNoiseFloor);
                            this.energyIndex = (this.energyIndex + 1) % this.energy.Length;

                            this.accumulatedSquareSum = 0;
                            this.accumulatedSampleCount = 0;
                            ++this.newEnergyAvailable;
                        }
                    }));
            }
        } 
```

这条线`sourceAngle == 0)`为我们做这件事。希望这可以帮助！

# c# - 我应该使用什么 C# 模板来为 XNA 游戏构建服务器？

> ID：12080459
> 
> 赞同：0
> 
> 时间：2012-08-22T19:54:50.317
> 
> 标签：c#, networking, xna

我将尝试在我的 XNA 游戏中构建多人游戏并同时为其构建服务器，但我不知道服务器应该采用什么格式。

在大多数有玩家托管的游戏中，服务器是不可见的，它没有自己的窗口，您只需在游戏中创建一个大厅，并且在后台为您运行一个服务器线程。

像这样的描述是我想要的，但开发它的最佳方法是什么？我应该将服务器作为控制台应用程序启动，然后想办法启动控制台并在玩家创建大厅时使其不可见，还是想办法将代码移植到 xna 游戏中的线程？我应该使用 Windows 窗体应用程序模板吗？解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:16:49.330

从概念上讲，您的服务器包括：

*   一组实现服务器端游戏逻辑和网络基础设施的类，以及
*   主机应用程序，要么是
    *   游戏客户端，或
    *   专用服务器进程

使用精心设计的代码，这两部分大部分是相互正交的——除了一些小细节，比如日志和服务器管理工​​具。套接字不关心它们是在 Windows 窗体应用程序还是控制台应用程序中运行。这个问题与他们完全无关。

所以你真正想做的是将你的服务器类放在一个**类库**项目中，然后从需要托管服务器的任何应用程序中引用该项目。该主机应用程序几乎可以是任何东西。它可以是 XNA 游戏，如果您希望玩家通过客户端托管服务器，或者是 Windows 服务，如果您想要专用服务器进程，或者完全是其他东西。

此时，只需`Server.Start()`从主机应用程序中的适当位置（例如，在后台线程中）调用（或任何适用于您的情况）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T23:41:47.327

Terraria，即 XNA，有一个控制台窗口服务器应用程序和主游戏。托管类型是游戏内托管和专用服务器。两种托管类型实际上使用相同的服务器应用程序，但是虽然专用服务器正常运行进程，但游戏客户端以隐藏模式运行控制台窗口应用程序，因此它不会出现在任务栏中或显示为窗口。

值得深思！

# tcp - 发送大量数据后的 RST、ACK

> ID：12080468
> 
> 赞同：0
> 
> 时间：2012-08-22T19:55:35.543
> 
> 标签：tcp, imap, reset, wireshark, mtu

我有一个 IMAP 服务器 (Dovecot)，我正在尝试在其上创建 1,200 个邮箱（用于性能测试）。服务器成功创建邮箱。

在此操作之后，我想列出所有创建的文件夹。服务器发送一些数据，但是，在一段时间（近 1 秒）后，客户端发送`RST`,`ACK`到服务器，以响应服务器响应 IMAP 协议关于创建的文件夹列表的命令。

这是我的 Wireshark 转储片段：

> ```
> IMAP: Src Port: imap (143), Dst Port: 56794 (56794), Seq: 29186, Ack: 20533, Len: 24
> IMAP: Src Port: 56794 (56794), Dst Port: imap (143), Seq: 20533, Ack: 29210, Len: 15
> IMAP: Src Port: imap (143), Dst Port: 56794 (56794), Seq: 29210, Ack: 20548, Len: 16384
> TCP: 56794 > imap [ACK] Seq=20548 Ack=45594 Win=49408 Len=0 TSV=3940902 TSER=3940902
> IMAP: Src Port: imap (143), Dst Port: 56794 (56794), Seq: 45594, Ack: 20548, Len: 16384
> TCP: 56794 > imap [RST, ACK] Seq=20548 Ack=61978 Win=49408 Len=0 TSV=3940902 TSER=3940902 
> ```

**编辑：**嗯，我想我知道为什么**RST**标志是由客户端发送的。原因是服务器超出了我的**环回**接口的**MTU**值。我已经检查了示例 Mina 服务器的类似行为 - 那里一切正常，即 TCP/IP 协议抑制了巨大的数据包。所以**Dovecot**不能明智地管理数据包。但是我有自己的 IMAP 服务器（基于 MINA），问题仍然存在！

 ******那么，为什么 TCP/IP 协议只对某些应用程序而不是对所有应用程序明智地管理发送的数据包（根据 MTU 值拆分它们）呢？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T13:10:04.220

您对发送 TCP 重置的原因的假设是不正确的。如果你已经超过了 MTU，那不是由 TCP 管理的。它在 IP 层进行管理，并且将向客户端发送 ICMP“需要分段”消息。然后，这样的消息**应该**导致客户端在 IP 层对数据包进行分段。根据您共享的信息，您的情况不会发生这种情况。

关于环回接口，这个流量在环回接口附近没有任何地方，不是两个独立的设备吗？

可悲的是，您的跟踪文件仍然没有提供任何有关此数据包原因的见解 -

```
IMAP: Src Port: imap (143), Dst Port: 56794 (56794), Seq: 45594, Ack: 20548, Len: 16384 
```

导致 TCP 重置。我无法从这些信息中推断出更多信息。

TCP 有一个名为[Maximum Segment size](https://en.wikipedia.org/wiki/Maximum_segment_size)的选项，它相似但也不同 :) TCP/IP 堆栈独立于应用程序，不会对每个应用程序应用不同的设置，它是系统范围的。

编辑：查看您的数据包捕获，没有任何迹象表明 MTU 问题。任何地方都没有 ICMP 流量，所以我怀疑这不是问题。如果存在 MTU 问题，它应该发生在上一个响应中，因为来自 IMAP 服务器的两个 LIST 响应大小相同，并且窗口大小没有问题。

我唯一能看到的是与最终响应的第一个元素（在 RST 之前）有关，其中部分回复看起来格式不正确（见附件）。IMAP 应用程序出现问题，它所回复的数据格式不正确。![imap 响应](../Images/63f2a5c3cef1da7d65a73ee18ad57944.png)- 查看与 pcap 中所有其他 LIST 响应一致的底部两个响应的差异。****

# domain-driven-design - Onion Architecture 中的资源文件在哪里？

> ID：12080469
> 
> 赞同：3
> 
> 时间：2012-08-22T19:55:41.567
> 
> 标签：domain-driven-design, embedded-resource, resx, onion-architecture

2 部分问题...我的解决方案中有几个资源文件 (.resx)，主要用于字符串翻译。例如，Errors.resx、Validation.resx 和 Enums.resx。

**第 1部分**：如果我没有 Enums 资源文件，我假设我应该将所有资源文件放在 UI 层中，可能在它自己的程序集中（如“Company.App1.MVCApp.Resources”）并从Web 应用程序（Company.App1.MVCApp）...将资源文件放在 UI 层中是否正确？

**第 2 部分**：Enums.resx 文件包含与枚举成员相关的描述性字符串（使用 Description 属性），在我的 UI 中，有时在域服务中，我可能需要在其翻译中访问描述性字符串。我考虑过将它存储在核心/域层中的某个地方，比如 Company.App1.Core.Resources ...？或者我应该在核心层创建一个抽象，然后在基础设施层的某个地方实现 ResourcemManager 以坚持正确的洋葱架构..？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T09:45:41.670

**第 1部分**：在我目前正在处理的应用程序中，每个关注点（枚举、错误...）没有一个 resx 文件，而是每个项目一个 resx 文件。例如，如果您接收错误消息，则纯粹的 UI 错误消息会放在 UI resx 文件中，域错误消息会放在 Domain resx 中，等等。IMO 资源文件最好放在最靠近使用本地化字符串的代码的位置。在 UI 项目中拥有大多数本地化文件会将本地化与呈现应用程序的方式紧密结合，如果您想在主 UI 之外的其他上下文中重用本地化，这可能会出现问题。

**第2 部分**：如果您只需要访问域层中的本地化枚举成员，那么您可以在域层中有一个特定的助手，该助手派生自或用于`System.Resources.ResourceManager`查找本地化字符串。但是，我发现在一个独立的层中有某种通用的本地化助手很方便，它集中了比 a 更复杂的所有本地化逻辑，`Properties.Resources.[...]`并且如果需要，它能够在您的解决方案的所有 resx 文件中进行搜索。

# java - 包装我的文本的标签，但在内容或代码中没有

> ID：12080470
> 
> 赞同：1
> 
> 时间：2012-08-22T19:55:49.057
> 
> 标签：java, android, html

在我的文章视图中，我的署名出现`<p></p>`在其周围带有标签。

我正在从在线 XML 文件中导入我的数据，插入到数据库中，然后显示它。XML 或数据库中没有段落标签，我的代码（如下所示）也没有段落标签。

怎么了？它们为什么会出现以及如何摆脱它们？

**代码：**

```
//ArticlesDataSource.java
article.byline = StringEscapeUtils.unescapeXml(
    cursor.getString(cursor.getColumnIndex(Article.COLUMN_BYLINE)));
article.byline = article.byline.toUpperCase();

//ArticleActivity.java
TextView articleBylineView = (TextView) findViewById(R.id.articleByline);

articleBylineView.setText(article.byline);

if((article.byline.length() == 0) || article.byline == null) {
    articleBylineView.setVisibility(View.GONE); }

//article.xml
<TextView
    android:id="@+id/articleByline"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/articleByline"
    android:paddingBottom="20dp"
    android:paddingRight="10dp"
    android:textSize="9dp"
    android:textColor="@color/light_gray"/> 
```

**例子：**

XML 数据：

```
<![CDATA[ By JohnDoe  Noo York Times ]]> 
```

数据库数据（SQlite）：

```
By John Doe  The Noo York Times 
```

显示的内容：

```
<P>BY JOHN DOE  THE NOO YORK TIMES</P> 
```

# c# - 如何在 .NET MVC 中以特定时间间隔调用方法

> ID：12080471
> 
> 赞同：3
> 
> 时间：2012-08-22T19:55:49.417
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我在 MVC 3 和 C# 中有一个 Web 应用程序。

我需要每 1 小时运行一个方法，时间不受限制。我想知道如何实现它。

谢谢。

有关的

[从 Windows 任务调度程序调用 MVC 控制器](https://stackoverflow.com/questions/11083087/call-mvc-controller-from-windows-task-scheduler)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T19:59:30.207

您可以使用[System.Timers.Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)。但请注意，[在 ASP.NET 应用程序中实现重复的后台任务](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)是一项危险的任务。不要忘记，IIS 可以随时在某些情况下（站点上的非活动期、达到 CPU/内存阈值……）回收应用程序池，从而降低您可能已启动的所有后台任务。

正确的方法是在另一个应用程序中实现它。例如，这可能是一个 Windows 服务或一个简单的控制台应用程序，该应用程序计划使用 Windows 调度程序定期运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T20:02:27.817

Darin 是正确的，但是，如果您必须在您的应用程序中执行此操作，请按照以下步骤操作：

在 Global.asax.cs

```
 static void ScheduleTaskTrigger()
    {
        HttpRuntime.Cache.Add("ScheduledTaskTrigger",
                              string.Empty, 
                              null, 
                              Cache.NoAbsoluteExpiration, 
                              TimeSpan.FromMinutes(60), // Every 1 hour
                              CacheItemPriority.NotRemovable, 
                              new CacheItemRemovedCallback(PerformScheduledTasks));
    } 

    static void PerformScheduledTasks(string key, Object value, CacheItemRemovedReason reason)
    {
       //Your TODO

       ScheduleTaskTrigger();
    }

    void Application_Start(object sender, EventArgs e)
    {
          ScheduleTaskTrigger();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:01:29.253

理想情况下，请改用 Windows 服务或计划任务

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-04-03T23:51:10.963

最好的办法是使用 Azure Functions。它就是为这个问题而设计的。其实还不错。您可以随时使用计时器触发器运行计划任务。

[https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview](https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview)

# selenium - 在詹金斯中运行我的硒项目时出现 Maven 错误

> ID：12080475
> 
> 赞同：4
> 
> 时间：2012-08-22T19:56:05.390
> 
> 标签：selenium, maven-2, jenkins, selenium-webdriver

运行顶级 Maven 目标时

```
test 
```

我收到以下错误：

```
FATAL: command execution failed
java.io.IOException: Cannot run program "mvn" (in directory "/var/lib/jenkins   /jobs/selenium/workspace"): java.io.IOException: error=2, No such file or directory
at java.lang.ProcessBuilder.start(ProcessBuilder.java:475)
at hudson.Proc$LocalProc.<init>(Proc.java:244)
at hudson.Proc$LocalProc.<init>(Proc.java:216)
at hudson.Launcher$LocalLauncher.launch(Launcher.java:709)
at hudson.Launcher$ProcStarter.start(Launcher.java:338)
at hudson.Launcher$ProcStarter.join(Launcher.java:345)
at hudson.tasks.Maven.perform(Maven.java:263)
at hudson.tasks.BuildStepMonitor$1.perform(BuildStepMonitor.java:19)
at hudson.model.AbstractBuild$AbstractBuildExecution.perform(AbstractBuild.java:717)
at hudson.model.Build$BuildExecution.build(Build.java:199)
at hudson.model.Build$BuildExecution.doRun(Build.java:160)
at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:499)
at hudson.model.Run.execute(Run.java:1502)
at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
at hudson.model.ResourceController.execute(ResourceController.java:88)
at hudson.model.Executor.run(Executor.java:236)
 Caused by: java.io.IOException: java.io.IOException: error=2, No such file or directory
at java.lang.UNIXProcess.<init>(UNIXProcess.java:164)
at java.lang.ProcessImpl.start(ProcessImpl.java:81)
at java.lang.ProcessBuilder.start(ProcessBuilder.java:468)
... 15 more
Build step 'Invoke top-level Maven targets' marked build as failure 
```

这似乎是关于 maven 路径的问题，但我已经在我的主机上设置了 maven 路径。M2_HOME、M2 和 PATH 都是正确的。我知道它们是正确的，因为我可以从命令行运行 maven 命令。当我尝试在 jenkins 中调用 maven 命令时，虽然我得到了错误。所以我进入`Jenkins->Manage Jenkins->Configure System`并点击了 Maven 安装...我检查了

```
Install automatically
Version 2.2.1 
```

我单击保存并尝试再次运行我的项目，但出现相同的错误。当我做 mvn -version 我得到 2.2.1 所以这应该是正确的。从配置系统页面我也尝试过

```
Name default
MAVEN_HOME /usr/local/apache-maven/apache-maven-2.2.1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T15:10:22.373

我的问题的解决方案有两个部分。首先，我需要确保在“配置系统”页面上创建 Maven 安装设置后，我在构建本身中指定了相同的配置。Second Jenkins 似乎对我正在运行它的 redhat 盒子没有足够的权限。一旦我最终将它指向正确的 Maven 实例，我就会遇到很多无法创建文件/文件夹的错误。这些权限错误可能是我在这台机器上使用 maven 遇到这么多麻烦的真正原因。我还没有解决这些权限错误，将为他们创建一个新问题。

# c - 为什么我的内核没有超过共享内存限制？

> ID：12080477
> 
> 赞同：0
> 
> 时间：2012-08-22T19:56:26.357
> 
> 标签：c, matlab, cuda, gpu-shared-memory

我从 matlab 调用 CUDA 内核。

之前有人告诉我（David Kirk 的书），每个线程只能占用 16kb 的共享内存，但我能够消耗的远不止这些：

```
__global__ void plain(float* arg)
{

    __shared__ float array[12000];
    int k;

    for (k=1;k<12000; k++)
    {
        array[k]=1;
    }   
} 
```

CUDA C 报告浮点数为 4 字节，这意味着总数组大小为 48Kb，大于 12Kb。它运行良好，那怎么可能呢？

我还被告知 [GPU 共享内存的大小非常小 - 我该怎么办？](https://stackoverflow.com/questions/4983764/cuda-shared-memory-size) 每个块的最大共享内存很重要。我的卡的每个块的最大共享内存为 49152 字节，但我能够以每块 1000 个线程运行上述代码。

似乎每个块会使用 49Kb，这是不对的。是不是 SM 一次只服务一个块并且在 dong 中保留了每个线程块只能有 49Kb 的条件？

每个块 49Kb 共享内存如何与每个线程 16Kb 共享内存相协调？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T06:30:10.680

每个线程块分配共享内存，每个 SM 最多可使用 48 KB，计算能力为 2.0 及更高版本。因此，在给定的 SM 上，您可能正在运行一个消耗整个 48 KB 的线程块，或者说，三个线程块每个分配 16 KB。每个 SM 16 KB 共享内存的限制适用于计算能力 < 2.0。与每个线程块分配的共享内存相反，本地内存（“本地”意味着“线程本地”）是每个线程分配的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T19:59:34.467

线程没有共享内存。您的代码使用“块”共享内存（CUDA 中没有其他共享内存）

# regex - 带有 HTTP GET 参数的 django url 调度程序

> ID：12080478
> 
> 赞同：1
> 
> 时间：2012-08-22T19:56:28.350
> 
> 标签：regex, django, django-urls

在 urls.py 文件中：

```
url(r'^api/user_info/(?P<username>[a-zA-Z\d]+)\&', 'corresponding.view')
url(r'^api/user_info/(?P<username>[a-zA-Z\d]+)', 'corresponding.view') 
```

总会有 HTTP Get 参数`/api/user_info/username`。

问题是在`corresponding.view`函数中，`username`将评估为“myusername?clientversion=2.0”之类的东西，而不是评估为“myusername”和`request.GET['clientversion'] = "2.0"`.

第一个`url`电话是尝试在其中捕捉与号，但这没有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:09:16.880

看到[这个问题](https://stackoverflow.com/questions/12079476/django-urls-using-a-in-the-url)；您不能使用 Django 的 URLConf 访问查询参数。尝试使用 URL 解析器处理`?`或`&`字符不会带来快乐。

只需使用以下 URL 模式：

```
url(r'^api/user_info/(?P<username>\w\+)/$', 'corresponding.view') 
```

并访问函数`clientversion`中的查询参数`corresponding.view()`：

```
def view(request):
    client_version = request.GET.get('clientversion')
    ... 
```

或者，如果你说它应该是*强制性*的，

```
from django.http import Http404

def view(request):
    try:
        client_version = request.GET['clientversion']
    except KeyError:
        raise Http404 
```

# weka - 如何在weka中声明“类层次属性”

> ID：12080482
> 
> 赞同：1
> 
> 时间：2012-08-22T19:56:40.863
> 
> 标签：weka, arff

我尝试使用 Weka 创建 .arff 文件并在 CLUS 上运行。但我有层次属性的问题。

> @attribute 'class hierarchy' {Dummy,Top/Arts/Animation,Top/Arts}

我通过此代码创建 .arff。

```
 // 1\. set up attributes
    attributes = new FastVector();
    // - numeric
    int NumericAttSize=0;
    for(String word : ListOfWord)
    {
        if(word.length()>1)
        {
            attributes.addElement(new Attribute(word));
            NumericAttSize++;
        }
    }
    // - nominal
    attVals = new FastVector();
    attVals.addElement("Dummy");
    for (String branch : ListOfBranch)
    {
           attVals.addElement(branch);
    }
    attributes.addElement(new Attribute("class hierarchical", attVals));

    // 2\. create Instances object
    dataSet = new Instances("training", attributes, 0);

    // 3\. fill with data
    for(String DocID : indexTFIDF.keySet())
    {
        values = new double[dataSet.numAttributes()]; 

        for(String word : ListOfWord)
        {
            int index = ListOfWord.indexOf(word);
            if(indexTFIDF.get(DocID).containsKey(word))
                values[index]=indexTFIDF.get(DocID).get(word);
        }
        String Branch = DocDetail.get(DocID).get("1");
        values[NumericAttSize]= ListOfBranch.indexOf(Branch)+1;
        dataSet.add(new Instance(1.0,values));
    }
    ArffSaver arffSaverInstance = new ArffSaver(); 
    arffSaverInstance.setInstances(dataSet);
    arffSaverInstance.setFile(new File("training.arff")); 
    arffSaverInstance.writeBatch(); 
```

然后当我在 CLUS 中运行“training.arff”时，我收到了以下错误消息：

> 错误：类值不在树层次结构中：Top/Arts/Animation（查找：Animation，术语：Top/Arts，子术语：Animation}）

我认为问题在于我如何将分层属性声明为名义属性，但我没有其他想法如何声明此属性。

每个建议都会有所帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T21:57:12.707

根据 Clus 手册中的示例（在[此 zip](http://dtai.cs.kuleuven.be/clus/download.php)中`/Clus/docs/clus-manual.pdf`），分层属性的格式应如下所示：

```
@ATTRIBUTE class hierarchical rec/sport/swim,rec/sport/run,rec/auto,alt/atheism 
```

因此，在您的情况下，您应该删除引号`'class hierarchical'`并删除值周围的花括号`{}`，从而导致：

```
@ATTRIBUTE class hierarchical Dummy,Top/Arts/Animation,Top/Arts 
```

此外，如果您有多标签数据（即每个数据样本有多个标签），那么您可以使用 分隔多个层次值`@`，如下所示：

```
@DATA
1,...,1,rec/sport/run@rec/sport/swim 
```

# objective-c - 为什么通过此代码中的另一个对象调用 Core Motion 更新不起作用？

> ID：12080487
> 
> 赞同：3
> 
> 时间：2012-08-22T19:57:11.460
> 
> 标签：objective-c, ios, core-motion

```
@interface Tester()
{
    int currentAccelerationOnYaxis;
}    
@end

@implementation Tester

-(void) test
{
    CMMotionManager *motionManager = [[CMMotionManager alloc] init];
    motionManager.deviceMotionUpdateInterval = 0.01;
    [motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue mainQueue]
                                       withHandler:^(CMDeviceMotion *motion, NSError *error)
                                       {
                                           currentAccelerationOnYaxis = motion.userAcceleration.y;
                                       }
    ];
    while(1==1)
    {
        NSLog(@"current acceleration is: %f", currentAccelerationOnYaxis);
    }
}
@end 
```

然后我在这样的后台线程上执行上述方法：
`[myTester performSelectorInBackground:@selector(test) withObject:nil];`

它工作正常。

但是，以下配置不起作用，我不知道为什么：

```
@implementation MotionHandler

@synthesize accelerationOnYaxis; // this is an int property of the MotionHandler class

-(void) startAccelerationUpdates
{
    CMMotionManager *motionManager = [[CMMotionManager alloc] init];
    motionManager.deviceMotionUpdateInterval = 0.01;
    [motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue mainQueue]
                                       withHandler:^(CMDeviceMotion *motion, NSError *error)
                                       {
                                           self.accelerationOnYaxis = motion.userAcceleration.y;
                                       }
    ];
}

@implementation Tester

-(id)init
{
    //...
    currentMotionHandler = [[MotionHandler alloc] init];
}
-(void) test
{
    [currentMotionHandler startAccelerationUpdates];
    while(1==1)
    {
        NSLog(@"current acceleration is: %f", currentMotionHandler.accelerationOnYaxis);
    }
}
@end 
```

然后我在这样的后台线程上执行上述方法：
`[myTester performSelectorInBackground:@selector(test) withObject:nil];`

它不工作，这是为什么呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T19:28:13.390

我想到了。在我的第二个版本中，我创建的 CMMotionManager 实例由于某种原因丢失了。因此，我将 MotionHandler 类的实现更改为：

**运动处理器.m**

```
@interface MotionHandler()
{
   //..
   CMMotionManager *motionManager; // I now declare it here
}

@implementation MotionHandler

@synthesize accelerationOnYaxis; // this is an int property of the MotionHandler class

-(void) startAccelerationUpdates
{
    motionManager = [[CMMotionManager alloc] init]; // and then initialize it here..
    motionManager.deviceMotionUpdateInterval = 0.01;
    [motionManager startDeviceMotionUpdatesToQueue:[NSOperationQueue mainQueue]
                                       withHandler:^(CMDeviceMotion *motion, NSError *error)
                                       {
                                           self.accelerationOnYaxis = motion.userAcceleration.y;
                                       }
    ];
}
-(void)test
{
    [self startAccelerationUpdates];
    while(1==1)
    {
        NSLog(@"current acceleration on y-axis is: %f", self.accelerationOnYaxis);
    }
} 
```

现在它似乎工作正常。

# performance - 分析 iostat 输出

> ID：12080494
> 
> 赞同：1
> 
> 时间：2012-08-22T19:57:46.610
> 
> 标签：performance, system-administration, iostat

我的应用程序遇到性能问题，我的一个嫌疑人是过多的 IO。iostat 显示每秒写入 10K 块的速率。我怎么知道这是否很多？如何知道具体机器和磁盘的限制？

编辑：按照艾略特的要求：

iostat 输出：

```
avg-cpu:  %user   %nice %system %iowait  %steal   %idle

      16.39    0.00    0.52   11.43    0.00   71.66

Device:            tps   Blk_read/s   Blk_wrtn/s   Blk_read   Blk_wrtn
 cciss/c0d0      315.20         0.00     10341.80          0      51709 
```

正常运行时间：

```
2:08am  up 17 days 17:26,  5 users,  load average: 9.13, 9.32, 8.73 
```

最佳：

```
top - 02:10:02 up 17 days, 17:27,  5 users,  load average: 8.89, 9.18, 8.72
Tasks: 202 total,   2 running, 200 sleeping,   0 stopped,   0 zombie
Cpu(s):  5.9%us,  0.7%sy,  0.0%ni, 90.5%id,  2.9%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:     96556M total,    15930M used,    80626M free,      221M buffers
Swap:   196615M total,       93M used,   196522M free,     2061M cached

PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                 
20027 root      16   0 10.5g 9.8g  12m S   74 10.4   2407:55 /usr/intel/pkgs/java/1.6.0.31-64/jre//bin/java -server -X 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-12T20:47:58.797

看法：

*   如果它是旋转磁盘，那是一个很高的价值。
*   如果是带有写入缓存的 SSD 或 SAN，这是合理的。

将 iostat -x 用于广泛和扩展的指标：

```
[xxx@xxxxxxxxxx]$ iostat -x 
Linux 2.6.32-358.6.2.el6.x86_64 (boxname.goes.here)     12/12/2013  _x86_64_    (24 CPU)

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.57    0.00    0.21    0.00    0.00   99.21

Device:  rrqm/s wrqm/s r/s  w/s  rsec/s wsec/s avgrq-sz avgqu-sz await svctm  %util
sda        0.06  28.38 0.04 3.99   0.99 259.15    64.58     0.01  2.11  0.55   0.22 
```

%util 是你的朋友。如果您查看 iostat.c（请参阅：[http](http://code.google.com/p/tester-higkoo/source/browse/trunk/Tools/iostat/iostat.c) ://code.google.com/p/tester-higkoo/source/browse/trunk/Tools/iostat/iostat.c ），您会看到它通过以下方式计算此百分比查看花费在 IO 上的时间量（以处理器滴答为单位）与已过去的滴答总数。换句话说，PERCENTAGE-UTIL 是 IO 处于忙碌状态的时间百分比。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:01:21.530

我可以根据经验告诉你，对于大多数系统来说，块写入率非常高。但是，您的系统可能完全有能力处理这个问题——这取决于您拥有的硬件类型。重要的是您的[服务器负载](http://en.wikipedia.org/wiki/Load_%28computing%29#Unix-style_load_calculation)数字和`iowait`百分比。如果您的服务器负载很高（即，高于系统上的核心数量）并且您的负载主要由 组成`iowait`，那么您就有问题了。

您能否与我们分享您的应用程序运行时的完整输出`iostat`和输出`uptime`快照？`top -c`

# asp.net - 为什么 FindControl 在我的转发器页脚中找不到按钮？

> ID：12080496
> 
> 赞同：5
> 
> 时间：2012-08-22T19:57:52.600
> 
> 标签：asp.net, vb.net, repeater

我正在使用 OnItemDataBound 事件来尝试激活中继器中的禁用按钮。很简单，如果事件被触发，我知道中继器中有项目，因此想要启用按钮。我卡住的地方是在功能中投射按钮，以便我可以启用它。中继器代码的相关部分如下：

```
<asp:Repeater ID="RptEnterHours" runat="server" DataSourceID="SQL_EmployeeGetTimesheet" ClientIDMode="Predictable" OnItemDataBound="RptEnterHours_Bound">
     '.....Irrelevant code.....
     <FooterTemplate>
          <asp:Button Enabled="false" ID="SubmitTimesheets" Text="Submit All Timesheets" OnClick="processTimesheetEntry" runat="server" OnClientClick="checkValues();" />&nbsp;
     </FooterTemplate>
</asp:Repeater> 
```

这是我背后的代码：

```
Sub RptEnterHours_Bound(Sender As Object, e As RepeaterItemEventArgs)

    'Exposes the Submit All Timesheets button if timesheets are available.
    If (e.Item.ItemType = ListItemType.Item) Or _
        (e.Item.ItemType = ListItemType.AlternatingItem) Then
        Dim sButton As Button = TryCast(Me.FindControl("SubmitTimesheets"), Button)
        sButton.Enabled = True
    End If

End Sub 
```

这和所有其他尝试都产生了可怕的“对象引用未设置为对象的实例”消息。谁能告诉我我做错了什么以及为什么我后面的代码找不到按钮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T18:31:13.213

请试试这个，我相信它会帮助你。

```
 If e.Item.ItemType = ListItemType.Footer Then
        Dim btn as new button
        btn = CType(e.Item.FindControl("SubmitTimesheets"), Button)
        btn.enabled = true
    End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:01:38.350

您将其限制为查看项目和交替项目模板。

改变这个：

```
If (e.Item.ItemType = ListItemType.Item) Or _ 
        (e.Item.ItemType = ListItemType.AlternatingItem) Then 
```

到：

```
If (e.Item.ItemType = ListItemType.Footer) Then 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:05:47.887

您要测试 e.Item.ItemType = ListItemType.Footer。Item 和 AlternatingItem 用于实际的数据记录，而不是页脚。因此，对于 Items 和 AlternatingItems，该按钮确实不存在。

然后，您将要添加一个测试以检查 RptEnterHours.DataSource 对象是否有记录。为此，您需要将 RptEnterHours.DataSource 转换为数据源的任何类型。

所以，基本上是这样的。您显然需要更改它以适合您的代码：

```
Sub RptEnterHours_Bound(Sender As Object, e As RepeaterItemEventArgs)

    'Exposes the Submit All Timesheets button if timesheets are available.
    If (e.Item.ItemType = ListItemType.Footer) Then
        Dim sButton As Button = TryCast(Me.FindControl("SubmitTimesheets"), Button)
        Dim myDataSource = CType(RptEnterHours.DataSource, MyDataSourceType)

        sButton.Enabled = (myDataSource.Count > 0)
    End If

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T02:08:09.967

自从我使用 Web 表单以来已经有一段时间了，但我相信问题有两个方面。

当项目类型为 Item 或 AlternatingItem 时，您就知道中继器中有数据。在这些情况下，您可以设置实例级别标志以指示您有项目。

然后，当项目类型为页脚并且您有要启用按钮的项目时。在对@codingkiwi.com 链接的问题的未接受答案中提到了这样做的方法，但我相信问题出在您调用 FindControl 的上下文中。您正在调用 Me.FindControl，它将搜索页面的 1 级子项（或用户控件、控件或 Me 所引用的任何内容）。您想要搜索实际中继器元素的子控件，在本例中为页脚。所以搜索变成了e.Item.FindControl。

应该注意的是，可能有更优雅的方法来检测转发器控件是否具有元素。也许您需要在 OnDataBound 事件中检查的是页脚项，然后查找类似的内容：（我的 VB 可能也有点生疏）

```
If (Me.RptEnterHours.Items IsNot Null AndAlso Me.RptEnterHours.Items.Any()) Then 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T03:45:10.523

不知道为什么它一开始就没有启用，但这会起作用，因为它会在 Item/AlternatingItem 类型之后为页脚触发：

```
Private m_bolEnableButton As Boolean = False

Sub RptEnterHours_Bound(Sender As Object, e As RepeaterItemEventArgs)

    'Exposes the Submit All Timesheets button if timesheets are available. 
    If (e.Item.ItemType = ListItemType.Item) Or _
       (e.Item.ItemType = ListItemType.AlternatingItem) Then

        '"if the event is triggered, I know there are items in the repeater and therefore want to enable the button"
        m_bolEnableButton = True

    End If

    If e.Item.ItemType = ListItemType.Footer Then

        If m_bolEnableButton Then

            Dim sButton As Button = TryCast(e.Item.FindControl("SubmitTimesheets"), Button)
            sButton.Enabled = True

        End If

        m_bolEnableButton = False

    End If

End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-08T13:43:37.683

您获得 Object null 引用异常的原因是您专注于演员阵容，这不会导致问题。您通常可以安全地隐式转换 FindControl 的结果。在捕获 FindControl 结果之后，您需要明确检查的是空引用。

此外，您应该查找`ListItemType.Footer`以便可以引用页脚行。

最后，FindControl() 不是递归的。它仅在顶级命名容器中查找控件。在大多数数据绑定控件中，每一行都代表它自己的命名容器，**因此您必须在要搜索的行内使用 FindControl**。当您使用`Me`时，它指的是页面。您应该改用 e.Item.FindControl()。

代码：

```
Dim bRecordsFound as Boolean = False

Sub RptEnterHours_Bound(Sender As Object, e As RepeaterItemEventArgs)
    If (e.Item.ItemType = ListItemType.Item) Or _
            (e.Item.ItemType = ListItemType.AlternatingItem) Then
        bRecordsFound = True
    End If
    If (e.Item.ItemType = ListItemType.Footer) And (bRecordsFound) Then
        Dim sButton As Button = e.Item.FindControl("SubmitTimesheets")
        If sButton IsNot Nothing Then
            sButton.Visible = True
        End If
    End If
End Sub 
```

# java - 使用 Apache POI 合并 Powerpoint 卡片组

> ID：12080500
> 
> 赞同：0
> 
> 时间：2012-08-22T19:58:18.617
> 
> 标签：java, powerpoint, concatenation, apache-poi

我有一个包含几个 ppt 卡片组的文件夹，我想将它们组合成一个卡片组。我没有看到将幻灯片从甲板添加到另一个的简单方法。有没有处理这个的函数？是否有另一个 Java 库可以做到这一点？

谢谢！

-C

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:29:39.240

我认为您不会找到纯 Java 解决方案。

在进行一些 ppt 读取/更新时，我不得不放弃 apache POI 实现，这似乎非常有限。
我终于得到了 Libreoffice/OpenOffice + 一些 java 包装器（它做了我需要的特定事情）

基于类似/几乎相同的问题/问题：[Copy PowerPoint Slides in Java (preferably)](https://stackoverflow.com/questions/2959103/copy-powerpoint-slides-in-java-preferably) and non-java based solution 作为答案，它可能只支持我在该领域的 Apache POI 功能理论:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T03:28:03.687

**披露：我监督 docx4j/pptx4j 项目**

我刚刚使用 pptx4j 编写了代码来执行此操作，因此使用开源工具在 Java 中对于 pptx 文件绝对是可行的。

# php - 如果值在 mysql 中，则返回 true

> ID：12080502
> 
> 赞同：0
> 
> 时间：2012-08-22T19:58:23.280
> 
> 标签：php, mysql

我正在编写一个应该连接到我网站上的 php 文件的程序。在 C# 中，他们输入一个值（密码）。然后将密码发送到网页 ( `example.com/example.php?param=<password>`)

我知道如何让程序发送密码，但我不知道如何将输入的值与我的 mysql 数据库表中的值进行比较。如果该值在数据库中，我希望它返回 true。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:04:35.997

sql

```
 SELECT `password`
    FROM `tableName`
    WHERE `password` = :password 
```

:password 应该是您在数据库中检查的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:05:15.680

```
select 1 from your_table where password = 'thepass' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T10:13:02.437

```
$result = mysql_query("SELECT * FROM table1 where password = '$password'", $link);
$num_rows = mysql_num_rows($result);
if($num_rows >0)
   return true;
return false; 
```

# java - 使用带有 GUI 的 Netbeans 进行编程

> ID：12080506
> 
> 赞同：2
> 
> 时间：2012-08-22T19:58:33.733
> 
> 标签：java, swing, user-interface, netbeans, look-and-feel

有没有办法像在 Netbeans 预览设计屏幕中一样显示程序：

![预览GUI](../Images/9426d49c991291b9553eec5ab900f4fe.png)

而不像默认的运行程序GUI：

![在此处输入图像描述](../Images/d71a9d10592d693bb29c57f6afdd0cf0.png)

?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:01:24.753

您是否希望设置[“外观和感觉”](http://www.exampledepot.com/egs/javax.swing/LookFeelNative.html)？

这是链接中的代码：

```
// Get the native look and feel class name
String nativeLF = UIManager.getSystemLookAndFeelClassName();

// Install the look and feel
try {
 UIManager.setLookAndFeel(nativeLF);
} catch (InstantiationException e) {
} catch (ClassNotFoundException e) {
} catch (UnsupportedLookAndFeelException e) {
} catch (IllegalAccessException e) {
} 
```

# java - 在 Linux 上使用终端的 Java jxl api（无 IDE）

> ID：12080507
> 
> 赞同：0
> 
> 时间：2012-08-22T19:58:53.730
> 
> 标签：java, linux, classpath, javac

我需要编译一个小型 Java 程序（在 Eclipse 上运行良好），但需要在 Linux（Fedora）操作系统上使用终端接口。我已经下载了 jexcelapi jar 文件并将其解压缩到我拥有 Java JDK 的同一目录中。我尝试使用编译：

```
javac -cp <paths> filename.java 
```

我得到了错误

```
"error: cannot find symbol RowsExceededException, WriteException, IOException, BiffException". 
```

源文件有

```
import jxl.*; 
```

jexcelapi目录的位置是：

```
/usr/java/jdk1.7.0_06/jexcelapi 
```

jexcelapi 包含目录：

`build`, `docs`, `resources`, `src`, 和文件`jxl.jar`

显然我`/usr/java/jdk1.7.0_06/jexcelapi`在`-cp <paths>`

请帮忙

工厂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:13:42.900

将来，要找出类路径上有什么，什么不在，您可以尝试使用该`-verbose`选项运行。

```
javac -verbose -cp <paths> filename.java 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:04:34.853

您需要包含 jar 文件而不是类路径中的目录：

```
javac -cp .:/usr/java/jdk1.7.0_06/jexcelapi/jxl.jar filename.java 
```

# php - 使用 curl 抓取大页面

> ID：12080508
> 
> 赞同：0
> 
> 时间：2012-08-22T19:58:56.053
> 
> 标签：php, curl, screen-scraping

我正在尝试从一个流行的新闻网站上抓取评论，以便使用 curl 进行学术研究。它适用于评论少于 300 条的文章，但在那之后它就很困难了。

```
$handle = curl_init($url);
curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);
$html = curl_exec($handle);
curl_close($handle);
echo $html; //just to see what's been scraped 
```

目前这个页面工作正常：[http ://www.guardian.co.uk/commentisfree/2012/aug/22/letter-from-india-women-drink?commentpage=all#start-of-comments](http://www.guardian.co.uk/commentisfree/2012/aug/22/letter-from-india-women-drink?commentpage=all#start-of-comments)

但是这个只返回 36 条评论，尽管总共有 700 多条评论：[http ://www.guardian.co.uk/commentisfree/2012/aug/21/everyones-talking-about-rape?commentpage=all#start-of -注释](http://www.guardian.co.uk/commentisfree/2012/aug/21/everyones-talking-about-rape?commentpage=all#start-of-comments)

为什么它在为拥有大量评论的文章而苦苦挣扎？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:02:19.813

您的评论页面已分页。每个页面包含不同的评论。您必须请求所有评论分页链接。

该参数`page=x`附加到不同页面的 url。

获取基本页面然后搜索具有页面参数的所有链接并依次请求每个链接可能会很好？

正如 Mike Christensen 指出的那样，如果您可以使用内置的功能 python 和 scrapy。您只需指定评论所在的元素，python 将为您抓取页面上的所有链接:)

# xml - 使用 HXT unpickler 忽略 XML 属性

> ID：12080512
> 
> 赞同：4
> 
> 时间：2012-08-22T19:59:07.240
> 
> 标签：xml, haskell, hxt

我正在编写一个小型应用程序，旨在从多个站点抓取 XML，然后以我想要的方式处理数据。我以前用不同的语言做过这样的应用程序，我正在为 Haskell 练习编写这个应用程序。

总之，说到点子上了。在网上浏览了数以百万计的不同 XML 解析器后，我决定使用 HXT，因为谁不喜欢箭头。在页面[http://www.haskell.org/haskellwiki/HXT/Conversion_of_Haskell_data_from/to_XML](http://www.haskell.org/haskellwiki/HXT/Conversion_of_Haskell_data_from/to_XML)之后，我得到了一些似乎读取我的 XML 文件并将其放入我定义的 Haskell 数据类型的东西。我正在使用 XmlPickler 的实例从文件中读取数据以实现此目的。我得到了一些可行的方法，除了这个错误：

```
fatal error: document unpickling failed
xpCheckEmptyAttributes: unprocessed XML attribute(s) detected 
```

我知道我没有处理所有属性。我不想要所有的属性。有没有办法忽略这些？我想我可以处理所有属性，将它们放入一个新的数据类型中，然后从中提取属性以获得我真正想要的数据。不过，我想避免这种小技巧，因此我在这里，要求 The Proper Way™。

我是否使用了错误的工具来完成这项工作？unpickling 3rd 方数据是否不安全（就像在 Python 中一样）？

我在网上寻找解决方案，但`Text.XML.HXT.Arrow.XmlState.SystemConfig`似乎没有禁用此行为所需的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T08:20:13.897

前几天我遇到了这个确切的问题，并得出以下结论：

> 我是否使用了错误的工具来完成这项工作？

是的。HXT 的 pickle 功能旨在轻松地序列化和反序列化数据，但没有太大的灵活性。从链接页面：

> 它们旨在读取机器生成的 XML，最好是由同一个pickler 生成。

至于：

> unpickling 3rd 方数据是否不安全（就像在 Python 中一样）？

不使用 HXT，不。python 中的酸洗是不安全的，因为它（松散地）等同于在任意内容上调用 eval()。HXT 只是一个 XML 解析器，不会调用任意代码。

就个人而言，我已经转而使用 xml 包 (Text.XML.Light) 手动处理 XML，而不是尝试让 HXT 的pickler 来做我想做的事。它没有那么简洁，但它让我忽略了我不关心的数据。不过，如果你喜欢箭头的话，你大概也可以使用 HXT 的非泡菜部分（我仍然把头绕在它们周围；））。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-05T19:12:14.450

您可以忽略带有 xpFilterAttr 的 XML 属性和带有**xpFilterCont****的**XML 标记。

 **签出此代码： [https ://hackage.haskell.org/package/hxt-9.3.1.4/docs/src/Text-XML-HXT-Arrow-Pickle-Xml.html](https://hackage.haskell.org/package/hxt-9.3.1.4/docs/src/Text-XML-HXT-Arrow-Pickle-Xml.html)

像这样：

```
xpElem "assign" $
xpFilterAttr (hasName "comment") $ ... 
```

xpFilterCont 正在过滤（在真实条件下）所有下一个标签。因此，条件为真，则保留一个 XML 标记，如果不是，则将其过滤掉。(<+>) 将某些条件与 OR 逻辑相结合。**

# php - smarty模板中表格的第一行/最后一行

> ID：12080513
> 
> 赞同：0
> 
> 时间：2012-08-22T19:59:07.290
> 
> 标签：php, smarty

我有一个关于 smarty 模板的问题，我正在使用 PHP 和 Smarty 来生成页面。我想以某种方式计算或确定表格的第一行和最后一行。所以我可以为第一个和最后一个 TR 设置不同的 CSS，或者保持原样，如果它只有 1 个 TR。

希望我追求的是有意义的。提前致谢。

```
<table class="table-paddings-2" cellspacing="0" cellpadding="0">
    <tr>
        <th class="table-gray-th-noborder">Search Type</th>
        <th class="table-gray-th-noborder">Average Turnaround Time</th>
    </tr>
{foreach key=obk item=row from=$report}
    <tr>
        <td class="td-border-top-only text-align-left">{$row.SearchName}</td>
        <td class="td-border-top-only text-align-left">{$row.tt}</td>
    </tr>
{/foreach}
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:12:35.530

文档是你的朋友：[http ://www.smarty.net/docsv2/en/language.function.foreach.tpl](http://www.smarty.net/docsv2/en/language.function.foreach.tpl)

示例 7.12、7.13：

```
{* show LATEST on the first item, otherwise the id *}
<table>
{foreach from=$items key=myId item=i name=foo}
<tr>
  <td>{if $smarty.foreach.foo.first}LATEST{else}{$myId}{/if}</td>
  <td>{$i.label}</td>
</tr>
{/foreach}
</table> 
```

# grails - Grails 查询数据库

> ID：12080515
> 
> 赞同：2
> 
> 时间：2012-08-22T19:59:17.107
> 
> 标签：grails

我正在尝试使用以下方法查询 grails 中的数据库：

```
 def per = User.get(springSecurityService.principal.id)
            def query = Post.whereAny {
                author { username == per.username }
            }.order 'dateCreated', 'desc'
            messages = query.list(max: 10) 
```

我的用户在用户域中，在帖子域中我有：

```
 String message
    User author
    Date dateCreated 
```

当我每次在控制器中用于填充数据库的方法是：

```
 def updateStatus() {
         def status = new Post(message: params.message)
        System.out.println("test " + params.message)
            status.author = User.get(springSecurityService.principal.id)
        status.save()
    } 
```

我对查询 grails 中的数据库非常陌生，所以如果有人可以推荐一些阅读，这也很好。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:24:41.203

新版本的 spring-security-core 插件为您的控制器添加了方法，因此您可以替换：

```
def per = User.get(springSecurityService.principal.id)
def query = Post.whereAny {
    author { username == per.username }
}.order 'dateCreated', 'desc'
messages = query.list(max: 10) 
```

和

```
messages = Post.findAllByAuthor(principal, [sort: 'dateCreated', order 'desc', max: 10]) 
```

没有声明 springSecurityService

您可以将 updateStatus 操作替换为：

```
def updateStatus(){
    def status = new Post(message: params.message, author: principal)
    status.save()
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:30:33.110

空查询可以通过以下方式解决：

```
def updateStatus() {
     def status = new Post(message: params.message)
    System.out.println("test " + params.message)
        status.author = User.get(springSecurityService.principal.id)
    status.save(flush: true)
} 
```

这可能会帮助您稍后找到数据，因为 save() 只是为您的休眠上下文提供了持久化数据的指令，但不会强制休眠在那个时候执行此操作。传递 flush:true 将强制数据立即持久化。此外 status.save(failOnError:true) 将显示您的域对象属性是否存在验证问题，从而阻止域实例完全保存到数据库中（通过抛出异常）。如果需要，您可以同时使用两者：

```
def updateStatus() {
     def status = new Post(message: params.message)
    System.out.println("test " + params.message)
        status.author = User.get(springSecurityService.principal.id)
    status.save(flush: true, failOnError: true)
} 
```

希望有帮助。

您也可以在 grails-app/conf/Config.groovy 中全局设置 flush 和 failOnError: true ：

```
grails.gorm.failOnError=true
grails.gorm.autoFlush=true 
```

# ruby-on-rails - 上传 .zip 文件时 Rails 的 Paperclip gem POSTing 而不是 PUTting

> ID：12080521
> 
> 赞同：7
> 
> 时间：2012-08-22T19:59:34.423
> 
> 标签：ruby-on-rails, zip, paperclip

我有一个表格（Rails 3.2.8，Paperclip 3.1.4），带有两个回形针附件，用于具有两个 has_attached_files 的模型。一个是图像，另一个是通用文件，通常是 .zip 文件。

只要我不尝试上传 .zip 文件，一切正常。上传任何大小的 .zip 文件（原始文件为 80 MB，但尝试 3 MB 以查看是否存在大小问题）会导致表单 POST 而不是 PUT，并且 Rails 会引发路由错误。

表单方法是 POST，但将 Rails 的隐藏 _method 值设置为“put”，它工作正常，并且在我不尝试上传 .zip 文件时会导致 PUT。

该表单确实正确设置了 enctype 'multipart' 位。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T10:32:44.653

文件听起来很大。仔细检查实际参数是否已进入请求。根据文件的大小，我也可以在本地获取它。

我看到的效果是 rails 基本上没有参数。由于 PUT 实际上是一个带有隐藏元素的帖子，因此 rails 只会看到 POST，因为 params 被删除了。

我实际上不确定是什么原因造成的。我想可能是本地的webserver，所以你可能需要配置nginx什么的。我从来没有在 heroku 或任何东西上发生过这种情况，但如果文件足够大，总是在本地发生。

另请注意，webrick 的请求有效负载限制非常小。所以不要用那个。使用“薄”，因为它非常容易替代。

# c# - 为什么 ClaimsPrincipalPermissionAttribute 是密封的，还有替代方案吗？

> ID：12080524
> 
> 赞同：4
> 
> 时间：2012-08-22T20:00:02.910
> 
> 标签：c#, wif, custom-attributes, .net-4.5, claims-based-identity

我正在我的 .net 4.5 应用程序中实现基于声明的安全性。很多箍要跳过，但它基本上是有效的。

我唯一不喜欢的部分是我无法创建自己的属性。ClaimsPrincipalPermissionAttribute 是密封的。为什么？

我总是在我的申请中做标记，例如：

```
[ClaimsPrincipalPermission(SecurityAction.Demand, Resource = "Foo", Operation = "Bar")] 
```

由于我希望我的资源和操作字符串不会拼写错误并且易于重构，因此我创建了类，因此我可以这样做：

```
[ClaimsPrincipalPermission(SecurityAction.Demand, Resource = Resources.Foo, Operation = Operations.Foo.Bar)] 
```

*（注意，由于不同的资源可能有不同的操作，操作本身是由资源子类化的。）*

这一切都很好，花花公子，但每次都要输入或复制/粘贴。我宁愿做这样的事情：

```
[DemandPermission(Resources.Foo, Operations.Foo.Bar)] 
```

我可以创建这个属性，但我需要从 ClaimsPrincipalPermissionAttribute 继承，因为它是密封的，所以我不能。:(

还有其他方法可以解决这个问题吗？也许我不需要继承，但我可以以某种方式注册自己的属性类型，以便它在所有相同的地方工作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-01T16:41:19.740

`ClaimsPrincipalPermissionAttribute`源自`CodeAccessSecurityAttribute`。它几乎什么都不做，除了根据您传入的 Resource 和 Operation 的值实现`CreatePermission()`返回一个新`ClaimsPrincipalPermission`的。

您可以实现一个派生自`CodeAccessSecurityAttribute`（这不是密封的）的新类，它可以满足您的需求。

使用JustDecompile，可以看到里面的代码`ClaimsPrincipalPermissionAttribute`很简单。您可以像这样创建自己的属性：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method | AttributeTargets.Property, AllowMultiple = true)]
public sealed class DemandPermissionAttribute : CodeAccessSecurityAttribute
{
    public Operations Operation { get; set; }
    public Resources Resource { get; set; }

    public DemandPermissionAttribute(SecurityAction action = SecurityAction.Demand)
        : base(action)
    {
    }

    public override IPermission CreatePermission()
    {
        return new ClaimsPrincipalPermission(this.Resource.ToString(), this.Operation.ToString());
    }
} 
```

需要注意的一件重要事情是，您必须在与引用它的程序集不同的程序集中定义自定义属性，否则框架将`TypeLoadException`按照此处所述抛出

[http://msdn.microsoft.com/en-us/library/vstudio/yaah0wb2.aspx](http://msdn.microsoft.com/en-us/library/vstudio/yaah0wb2.aspx)

另外，请注意构造函数参数的默认值的使用。您需要有一个构造函数，该构造函数带有一个`SecurityAction`参数，以便由框架实例化属性。在这种情况下， Maybe`DemandPermission`是一个坏名字，因为您可以将 覆盖`SecurityAction`为`SecurityAction.Demand`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T17:42:09.443

> ClaimsPrincipalPermissionAttribute 是密封的。为什么？

[Eric Lippert](http://blogs.msdn.com/b/ericlippert/archive/2004/01/22/61803.aspx)谈到了Framework 类型中sealed 的共性，既然我们在谈论代码安全，这一点非常重要：

> 每次您实现一个采用未密封类型实例的方法时，您必须编写该方法以使其在面对该类型的潜在敌对实例时具有健壮性。你不能依赖任何你知道对你的实现是正确的不变量，因为一些恶意网页可能会继承你的实现，覆盖虚拟方法来做一些弄乱你的逻辑的东西，然后把它传递进去。每次我密封一个类，我可以编写使用该类的方法，并确信我知道该类的作用。

在这种情况下，这一点更为重要，`ClaimsPrincipalPermissionAttribute`通过`IClaimsPrincipal`接口进行检查。因此，通过`ClaimsPrincipalPermissionAttribute`密封，它们允许任何实现者`IClaimsPrincipal`不必担心恶意实现。这是一个相当大的节省，因为这都是与安全相关的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:28:04.007

我的直接反应是，这不是很多要写的——你需要多久写一次？如果它适用于控制器中的操作，请将其放在控制器上 - 如果适用于许多控制器，请创建具有该属性的 ControllerBase。

如果你的情况比这更特殊，我想你被迫实现你自己的那个属性。

# ruby-on-rails - 参数未正确保存（Rails）

> ID：12080530
> 
> 赞同：1
> 
> 时间：2012-08-22T20:00:28.147
> 
> 标签：ruby-on-rails, ruby, parameters, save

我有一个模型消息，我有一个收件人列表，它保存为字符串。无论出于何种原因，除了收件人列表之外，我的所有参数都被保存，只有收件人列表被遗漏。我很困惑这可能是什么原因。

模型：

```
class Message < ActiveRecord::Base
  attr_accessible :content, :sender_id, :recipient_list
  attr_reader :recipient_list #necessary for jquery-token-input

  belongs_to :sender, class_name: "User"

  validates :content, presence: true
  validates :sender_id, presence: true
  validates :recipient_list, presence: true

  def recipient_list=(recipient) #jquery-token-input
    self.recipient_ids = recipients.split(",")
  end

end 
```

控制器：

```
def create
  @message = current_user.sent_messages.build(params[:message])
  if @message.save
    flash[:success] = "Message Sent."
    redirect_to '/users/'+current_user.id.to_s+'/messages'
  else
    redirect_to '/users/'+current_user.id.to_s+'/messages'
  end
end 
```

参数：

```
{"utf8"=>"✓",
"authenticity_token"=>"WlStV4ogguSX72vrZp10zJbucS5MTL1pT1DLt06qjcw=",
"message"=>{"recipient_list"=>"1,2",
"content"=>"foobar123",
"sender_id"=>"1"},
"commit"=>"Send"} 
```

结果：

```
#<Message id: 32, content: "foobar123", sender_id: 1, recipient_list: "", created_at: "2012-08-22 19:38:44", updated_at: "2012-08-22 19:38:44">] 
```

在这种情况下，导致收件人列表无法保存的问题可能是什么？

**编辑：**

Par Ylan 的笔记我开始研究为什么它在变量名不同的情况下仍然有效。在弄乱它后，我意识到它实际上只有在我设置收件人 - > 收件人或相反它会停止工作时才以这种方式工作。

摆弄它，并根据纳什的建议提出以下建议：

```
def recipient_list=(ids)
 recipient_list = ids.split(",")
 super(recipient_list)
end

#<Message id: 42, content: "foobar123", sender_id: 1, recipient_list: "---\n- '1'\n", created_at: "2012-08-22 21:58:46", updated_at: "2012-08-22 21:58:46">] 
```

所以现在收件人列表正在保存，我只需要弄清楚如何删除所有不必要的乱码并只得到“1”哈哈。有什么进一步的建议吗？

**编辑#2：** 添加序列化后：recipient_list, Array

```
#<Message id: 43, content: "foobar123", sender_id: 1, recipient_list: ["1", "2"], created_at: "2012-08-22 22:10:46", updated_at: "2012-08-22 22:10:46">] 
```

是我想要的新输出。我们一起工作。谢谢两位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:40:27.590

看起来您应该`super`在覆盖的编写器中调用方法：

```
def recipient_list=(recipients) #jquery-token-input
  self.recipient_ids = recipients.split(",")
  super(recipients)
end 
```

或类似的东西取决于您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:48:12.600

我相信你的写作方法有误。您正在传递一个名为 的参数`recipient`，但调用`recipients.split(",")`. 改变任何一个，你应该被设置。

# objective-c - 了解预定义方法的工作原理

> ID：12080532
> 
> 赞同：1
> 
> 时间：2012-08-22T20:00:34.417
> 
> 标签：objective-c, methods

我是 Objective-C 的新手，我正在尝试了解预定义方法的工作原理。我浏览了 XCode 的文档和定义该方法的 *.h 文件。但是，我渴望阅读 *.m 文件或任何其他可以帮助我了解该方法如何工作的文档。

例如 -`isEqualToString:(NSString *)`检查两个字符串（类型为 NSString）是否相等。我对这个描述不满意。我很想知道该方法在内部是如何工作的，或者它遵循的算法是什么。我在哪里可以找到这些信息？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:09:49.360

*   isEqualToString:(NSString *) 是在 NSString 类中定义的方法。Apple 为您提供了框架，但它们不提供这些方法的实现。因此，您看不到标准框架库背后的源代码。

编辑：您可以创建一个二进制文件并使用此应用程序检查汇编代码：http: [//itunes.apple.com/us/app/hopper-disassembler/id422856039 ?mt=12](http://itunes.apple.com/us/app/hopper-disassembler/id422856039?mt=12)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:10:12.353

不幸的是，Apple 框架的许多实现 ( `.m`) 文件并未公开提供。你有几个选择：

1.  正如 Matthias 在评论中建议的那样，使用调试器并检查为该方法生成的汇编代码。
2.  浏览[GNUstep](http://gnustep.org/)项目的存储库，该项目与 Apple 类有一些等价物。

# php - https SOAP 的示例免费测试站点

> ID：12080533
> 
> 赞同：1
> 
> 时间：2012-08-22T20:00:42.030
> 
> 标签：php, soap, https, certificate

是否有可用的 https 免费测试站点可用于测试调用 https SOAP Web 服务（顺便使用 php5 soapClient 对象），以便我可以看到正确安装证书或未正确安装证书的影响？

到目前为止，我尝试调用像[https://uk.ewaypayments.com/hotpotato/soap.asmx?WSDL](https://uk.ewaypayments.com/hotpotato/soap.asmx?WSDL)或[https://www.eway.com.au/gateway/rebill/test/manageRebill_test中提到的 SOAP 网络服务.asmx?WSDL](https://www.eway.com.au/gateway/rebill/test/manageRebill_test.asmx?WSDL)，但我想我遗漏了一些东西，或者证书已经自动安装在我使用的浏览器（IE9 和 Chrome）中，因为我不需要做任何证书的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-10-25T19:49:42.277

这是完全公开且不需要任何身份验证的不同 SOAP API 的集合，通过查看可以使用 API 的许多不同方式，消费者可以更轻松地使用和理解 API 的全部内容。

[公共 SOAP API - 邮递员](https://documenter.getpostman.com/view/8854915/Szf26WHn#4ba276a7-b12c-4943-ae23-c6031cc48248)

`?wsdl`请记住，您可以通过添加到 url从任何 ASMX 端点获取 WSDL 。

例如：[https ://www.dataaccess.com/webservicesserver/NumberConversion.wso?wsdl](https://www.dataaccess.com/webservicesserver/NumberConversion.wso?wsdl)

# c# - SharePoint 2007 c# 需要从 url 获取文档库（列表名称），查看如何将列表名称传递给 GetListItems

> ID：12080535
> 
> 赞同：1
> 
> 时间：2012-08-22T20:00:44.753
> 
> 标签：c#, sharepoint

尝试以编程方式从 url 获取列表名称，然后将列表名称传递给 Web 服务 Lists (_vti_bin/Lists.asmx) 以便使用 GetListItems 甚至使用 Webs 服务来使用 GetViewCollection 传入列表名称. 问题是我能够获取标题中显示的列表名称，但是当将其传递给 GetListItems 或 GetViewCollection 时，它会抱怨 GUID 不正确。

例子：

示例网址：

```
http://test.com/List Name Here/ 
```

我可以使用 Views 服务解析“此处的列表名称”，但是当将“此处的列表名称”传递给 GetListItems 时，它会失败并显示有关不正确 GUID 的消息。我想我想看看这是否可行，如果可以，列表名称需要在内部采用什么格式才能传递给 GetListItems 方法？

**编辑**

刚刚发现其中一个问题是 SharePoint 对 url 中的列表名称进行了一些解析，删除了逗号、方括号、句点和破折号，因此在我的案例中，列表名称中有一个句点被删除。所以我可能不得不告诉最终用户遵循命名约定，除非有任何其他方法可以获得完整的未编辑列表名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T21:53:06.973

能够通过遍历列表集合 (GetListCollection().ChildNodes) 来获取实际的列表名称。这允许我使用“DefaultViewUrl”和“Name”属性将正确的列表名称传递给 GetListItems Web 服务方法。这允许最终用户从 SharePoint 传入一个 url，并且处理将确定列表名称，因此不必在配置文件等中提供它。

下面的代码显示了从 url 确定列表名称的基础知识；

```
string name = string.Empty;
foreach (XmlNode ls in list.GetListCollection().ChildNodes)
{
    //Check whether list is document library
    if (Convert.ToInt32(ls.Attributes["ServerTemplate"].Value) != 0x65)
    {
        continue;
    }

    string defaultViewUrl = Convert.ToString(ls.Attributes["DefaultViewUrl"].Value);

    if (defaultViewUrl.Contains(listName))
    {
        name = ls.Attributes["Name"].Value;
        break;
    }
}

XmlNode ndListItems = list.GetListItems(name, null, ndQuery, ndViewFields, null, ndQueryOptions, null);
XmlNodeList oNodes = ndListItems.ChildNodes;

// rest of processing below... 
```

# jasper-reports - 如何在 iReport 中限制面积图上的刻度

> ID：12080536
> 
> 赞同：0
> 
> 时间：2012-08-22T20:00:53.717
> 
> 标签：jasper-reports, ireport

我对使用 iReport 设计报告还很陌生，我遇到了一个我无法解决的挑战。我正在尝试绘制带时间戳的数据，但将其显示为区域图。我成功地能够使用时间序列图表绘制数据，但是该格式将数据绘制为一条线。我需要一个面积图。因此，我尝试使用日期作为类别来绘制相同的数据。我的问题是面积图会绘制每个刻度线，这会导致外观混乱。我已经搜索了如何限制滴答声，但解决方案似乎没有解决我的问题（或者解决方案超出了我对 java 的了解:)）。

所以，我的问题是：如何在面积图上设置最小刻度？或者，我怎样才能使时间序列图表成为一个区域而不是一条线？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T08:25:26.893

[如果您还没有在这里](http://www.jfree.org/jfreechart/jfreechart-1.0.13-demo.jnlp)查看JFreeChart 演示并查看 XYAreaChartDemo2.java，则此示例显示了 TimeAxis 和 AreaRenderer：

![在此处输入图像描述](../Images/dcbf628b0f770a8fed00ac574f141bfd.png)

如果您使用`ChartFactory`尝试使用

```
 JFreeChart chart = ChartFactory.createXYAreaChart(
    "XY Area Chart Demo 2",
    "Time", "Value",
    dataset,
    PlotOrientation.VERTICAL,
    true,  // legend
    true,  // tool tips
    false  // URLs
 ); 
```

# php - 将一个值分配给具有多个值可能性的变量

> ID：12080541
> 
> 赞同：1
> 
> 时间：2012-08-22T20:01:05.270
> 
> 标签：php, variables, if-statement, switch-statement

在某些情况下，我遇到过这种情况，我只需要询问是否有更好的东西。我有一个值，可以通过分配了一个数字的派克来。数字意味着什么，所以要输出给用户。例如，我需要将 1 更改为对用户有意义的东西。这是一个代码示例：

```
switch($data['priority']) {
case 1:
    $priority = 'Low';
    break;
case 2:
    $priority = 'Medium';
    break;
case 3:
    $priority = 'High';
    break;
default:
    $priority = 'None';
    break;
} 
```

有没有办法用更少的代码将值分配给优先级？我知道在 JavaScript 中您可以执行多个三元运算符 ( `var data = type == 1 ? 'Good' : type == 2 ? 'Bad' : type == 3 ? 'Unknown' : '';`)，但 PHP 不允许这样做。我知道您也可以执行多个 if、else if、else if、else 语句，但这似乎是很多额外的代码。有没有更好的方法来做我要求的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T20:02:40.073

一种可能性是使用数组作为映射：

```
$map = array(1 => 'Low', 2 => 'Mid', ...);
$prioName = isset($map[$prio]) ? $map[$prio] : 'None'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:03:53.880

尝试数组映射：

```
$priorities = array('None', 'Low', 'Medium', 'High');

// you can use an easy "if"
if ($data['priority'] < 1 || $data['priority'] > 3)
    $data['priority'] = 0;

// or you can use a ternary assignment:
$data['priority'] = $data['priority'] < 1 || $data['priority'] > 3 ? 0 : $data['priority'];

$priority = $priorities[$data['priority']]; 
```

# php - Wordpress：如何将主题变量插入小部件？

> ID：12080543
> 
> 赞同：1
> 
> 时间：2012-08-22T20:01:12.477
> 
> 标签：php, wordpress, wordpress-theming

我在我的主题functions.php文件中创建了一些函数，我在header.php文件中调用了main函数，并将结果存储到一个变量中，我想在一个小部件中使用这个值。

可能吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T17:48:32.087

您可以在 wp_options 表中保存变量，例如主题选项。

要添加设置值，请使用[update_option()](http://codex.wordpress.org/Function_Reference/update_option) 并读取该值，请使用[get_option](http://codex.wordpress.org/Function_Reference/get_option)。

[add_option()](http://codex.wordpress.org/Function_Reference/add_option)也可以使用，但仅当数据库中不存在该变量时才有效。因此， update_option() 是首选。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T21:16:33.157

你试过这个吗？

[http://wordpress.org/extend/plugins/php-code-widget/](http://wordpress.org/extend/plugins/php-code-widget/)

还有其他插件可以做同样的事情：允许在文本小部件中执行 PHP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-18T12:38:40.090

在获取变量的小部件中，只需使用：

```
$variable=$GLOBALS['theme_variable']; 
```

# php - PHP 下带有 libcurl 或 http:// 流的 TPROXY

> ID：12080550
> 
> 赞同：2
> 
> 时间：2012-08-22T20:01:38.920
> 
> 标签：php, http, sockets, stream, libcurl

我有一个 PHP 应用程序在用户和一些 HTTP 资源之间充当 TPROXY，即通过绑定到用户的 IP 以进行传出连接，将套接字设置为透明模式：

```
socket_set_option($outgoing_socket, 0 /*SOL_IP*/, 19 /*IP_TRANSPARENT*/, 1);
socket_bind($outgoing_socket, $incoming_ip, $incoming_port); 
```

厌倦了与无效的请求和响应标头等 HTTP 相关的东西，所以我正在寻找一个更强大的解决方案，如 libcurl 或 http:// 流来处理协议通信部分，并只集中我的注意力在有效载荷上。

问题？对于这两种解决方案，我都找不到一种方法来打开底层套接字的 TPROXY 模式：

*   不幸的是，libcurl 的 PHP 绑定似乎不支持 CURLOPT_SOCKOPTFUNCTION
*   如果不将 IP_TRANSPARENT 设置为套接字，http ['socket']['bind'] 上下文将不接受未分配给当前机器的 IP

任何想法如何解决我的问题？

# forms - 在 CakePHP 中使用 FormHelper 选择多个复选框

> ID：12080551
> 
> 赞同：1
> 
> 时间：2012-08-22T20:01:39.917
> 
> 标签：forms, cakephp

因此，在某个模型的索引视图中，我包含了一些复选框；我有一周中的几天的数组，因此每条记录有 7 个可用的复选框。

我可以保存数据，没问题。我不知道如何根据每条记录的保存数据预先选择复选框。目前我必须这样做：

```
<?php if ( isset($user['SurveyAssignment'][0]['active_days']['Monday']) && $user['SurveyAssignment'][0]['active_days']['Monday'] == 1 ) { $monChecked = true; } else { $monChecked = false; } ?>
<?php echo $this->Form->input('SurveyAssignment.' . $count .'.active_days.Monday', array('type' => 'checkbox', 'label' => false, 'div' => false, 'checked' => $monChecked));?> 
```

这只是一天，一张唱片。现在，我为每条记录做了 7 次。它非常臃肿。

我原以为我可以在数组中读取每条记录，并相应地选择一组复选框。

我确定我错过了一些非常简单的东西，但我现在看不到我的鼻子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:05:58.230

如果您的关联设置正确，您的字段名称正确，并且您传递的数据正确，则会自动为您选择它们​​。

可能的答案是您没有使用正确的字段或 Model.field 进行表单输入。

# python - Python 列表不反映变量变化

> ID：12080552
> 
> 赞同：25
> 
> 时间：2012-08-22T20:01:41.843
> 
> 标签：python, list, variables

当我写这段代码时：

```
polly = "alive"
palin = ["parrot", polly]
print(palin)
polly = "dead"
print(palin) 
```

我以为它会输出这个：

```
"['parrot', 'alive']"
"['parrot', 'dead']" 
```

然而，事实并非如此。我怎样才能让它输出呢？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-08-22T20:09:19.717

Python 变量保存对*值*的引用。因此，当您定义`palin`列表时，您传入的是 引用的值`polly`，而不是变量本身。

您应该将值想象为气球，变量是与这些气球相关联的线程。`"alive"`是一个气球，`polly`只是那个气球的一个线程，并且`palin`列表有一个*不同*的线程绑定到同一个气球。在 python 中，列表只是一系列线程，所有线程都从 0 开始编号。

你接下来要做的是将`polly`绳子系到一个新气球`"dead"`上，但列表仍然保留着系在`"alive"`气球上的旧线。

您可以`"alive"`通过按索引重新分配列表以引用每个线程来将该线程替换为列表所持有的；在你的例子中是线程`1`：

```
>>> palin[1] = polly
>>> palin
['parrot', 'dead'] 
```

在这里，我只是将`palin[1]`线程绑定到同一事物`polly`上，无论它可能是什么。

请注意，python 中的任何集合，例如`dict`、`set`、`tuple`等，也只是线程的集合。其中一些可以将它们的线程换成不同的线程，例如列表和字典，这就是使 python 中的某些东西“可变”的原因。

另一方面，字符串是*不可*变的。一旦你定义了一个类似`"dead"`or的字符串`"alive"`，它就是*一个*气球。您可以用线程（变量、列表或其他任何东西）将其绑定，但您不能替换其中的字母。您只能将该线程绑定到一个*全新*的字符串。

python 中的大多数东西都可以像气球一样工作。整数、字符串、列表、函数、实例、类，都可以绑定到一个变量，或者绑定到一个容器中。

您可能还想阅读[Ned Batchelder 关于 Python 名称的论文](http://nedbatchelder.com/text/names.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T20:04:25.003

在您的第二个打印语句之前，将您的新值存储到`palin`：

```
palin = ["parrot", polly] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-22T20:12:55.543

当您将字符串放入列表时，列表会保存该字符串的副本。字符串最初是变量、文字值、函数调用的结果还是其他东西都没有关系；当列表看到它时，它只是一个字符串值。更改以后生成的字符串永远不会影响列表。

如果您想存储一个值的引用，当该值更改时会注意到该值，通常的机制是使用包含“引用”值的列表。将其应用于您的示例，您将得到一个嵌套列表。例子：

```
polly = ["alive"]
palin = ["parrot", polly]
print(palin)
polly[0] = "dead"
print(palin) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T20:11:41.397

该列表将仅包含值，而不是您想要的对变量的引用。但是，您可以在列表中存储一个 lambda，并让 lambda 查找变量的值。

```
>>> a = 'a'
>>> list = ['a',lambda: a]
>>> list[1]
<function <lambda> at 0x7feff71dc500>
>>> list[1]()
'a'
>>> a = 'b'
>>> list[1]()
'b' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-22T20:14:13.023

你不能。分配给一个裸名是 Python 始终只重新绑定名称，您无法自定义或监视此操作。

您可以做的是创建`polly`一个可变对象而不是字符串，并改变其值而不是重新绑定名称。一个简单的例子：

```
>>> polly = ['alive']
>>> items = ['parrot', polly]
>>> items
['parrot', ['alive']]
>>> polly[0] = 'dead'
>>> items
['parrot', ['dead']] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-22T20:35:14.610

其他答案已经很好地解释了正在发生的事情。

这是激发对象使用的（几个）问题之一。例如，有人可能会这样做：

```
class Animal:
    def __init__(self, aniType, name):
        self.aniType = aniType
        self.name = name
        self.isAlive = True

    def kill(self):
        self.isAlive = False

    def getName(self):
        return self.name

    def getType(self):
        return self.aniType

    def isLiving(self):
        return self.isAlive

polly = Animal("parrot", "polly")

print(polly.getName()+' the '+polly.getType()+' is alive?')
print(polly.isLiving())

polly.kill()

print(polly.getName()+' the '+polly.getType()+' is alive?')
print(polly.isLiving()) 
```

对于一个简单的任务，乍一看可能需要很多代码，但对象通常是处理此类事情的方法，因为它们有助于保持一切井井有条。

这是该程序的输出：

```
polly the parrot is alive?
True
polly the parrot is alive?
False 
```

# ruby-on-rails - 西班牙语中的黄瓜步骤定义：“...”的模糊匹配

> ID：12080554
> 
> 赞同：0
> 
> 时间：2012-08-22T20:01:51.343
> 
> 标签：ruby-on-rails, testing, cucumber, capybara, gherkin

我正在尝试将黄瓜的步骤定义翻译成西班牙语，但出现此错误：

```
Ambiguous match of "que estoy en la página "inicio de sesión""

  features/step_definitions/web_steps.rb:3:in `/^que estoy en la página "([^"]*)"$/'
  features/step_definitions/web_steps.rb:7:in `/^visito la pa|ágina "([^"]*)"$/' 
```

这是我的 web_steps.rb

```
# encoding: utf-8

Dado /^que estoy en la página "([^"]*)"$/ do |page|
  visit(path_to page)
end

Cuando /^visito la página "([^"]*)"$/ do |page|
  visit(path_to page)
end 
```

如果我在正则表达式中得到了 ^ 和 $ ，那怎么可能是模棱两可的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:58:13.887

看起来它`|`在后面的步骤定义中看到了 a 。仔细查看错误的第二行：

```
features/step_definitions/web_steps.rb:3:in `/^que estoy en la página "([^"]*)"$/'
features/step_definitions/web_steps.rb:7:in `/^visito la pa|ágina "([^"]*)"$/' 
```

它正在看到`/^visito la pa|ágina "([^"]*)"$/`，它将其解释为 OR ，即`/^visito la pa`OR `ágina "([^"]*)"$/`。有了这种解释，匹配确实变得模棱两可。

现在为什么它以这种方式阅读对我来说是个谜，也许是一些 UTF-8 乱码？

# excel - 如何通过 Selection_Change 事件调用过程

> ID：12080555
> 
> 赞同：0
> 
> 时间：2012-08-22T20:02:04.380
> 
> 标签：excel, vba

```
Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Column = 6 Then Call calc09() 
```

Sub calc09() 在
我试过的表单代码模块（frm01）内：

```
If Target.Column = 6 Then Call frm01.calc09() 
```

我还将 Sub calc09() - 重命名为 Public Sub calc09() - 没有结果。
我收到一条错误消息：
编译错误：未定义子或函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:55:23.930

工具 - 参考 - 求解器复选框。

如果 Solver 未出现在 Available References 下，请单击 Browse 并在 C:\Program Files\Microsoft Office\Office14\Library\SOLVER 中打开 Solver.xlam

# javascript - jQuery不隐藏元素

> ID：12080557
> 
> 赞同：-2
> 
> 时间：2012-08-22T20:02:11.290
> 
> 标签：javascript, jquery

这是我的代码，我想做的是让 javascript 检查表单，然后通过 AJAX 将其提交给 PHP 脚本，该脚本将使用户登录。

```
<!DOCTYPE html>
<html>
    <head>
        <title>RPEMS: Login</title>
        <link rel="stylesheet" type="text/css" href="../main.css"></link>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
        <script type='text/javacript'>

$(function()
{
    $('.error').hide();
$('.button').click(function()
{
    $('.error').hide();
    var filter=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;
    var email = $('input#email').val();
    var pass = $('input#pass').val();
    var err = false;

    if (!email)
    {
        $('label#emErr').show();
        $('input#email').focus();
        err = true;
    }

    if (!filter.test(email))
    {
        $('label#emValErr').show();
        $('input#email').focus();
        err = true;
    }

    if (!pass)
    {
        $('label#passErr').show();
        $('input#pass').focus();
        err = true;
    }

    if (err) return false;

    var dataString = 'email=' + email + '&pass=' + pass;
    $.ajax({
    type: "POST",
    url: "log.php",
    data: dataString,
    success: function(result)
    {
        if (result.success == true) window.location('../');
        else $('p#phpErr).html(result.message).show();
    }});
}
});

    </script>
</head>
<body>
    <div id="header">
        <img id="logo" src="../img/logo.png"></img>
            <ul id="navBar">
                <li class="navLink">
                    <a href="/">Home</a>
                </li>
                <li class="navLink">
                    <a href="/about">About/Contact Us</a>
                </li>
                <li class="navLink">
                    <a href="/calendar">Calendar</a>
                </li>
                <li class="navLink">
                    <a href="/login">Login</a>
                </li>
            </ul>
    </div>

    <form method='post' action=''>
        <fieldset>
            <label for='email'>Email: </label>
            <input name='email' id='email' type='text'></input>
            <br class='error'></br>
            <label for='email' class='error' id='emErr'>This field is required</label>
            <label for='email' class='error' id='emValErr'>Invalid email adress</label>
            <br class='error'></br>

            <label for='pass'>Password: </label>
            <input name='pass' id='pass' type='password'></input>
            <br></br>
            <label for='pass' class='error' id='passErr'>This field is required</label>
            <br class='error'></br>
            <p class='error' id='phpErr'></p>

            <input type='submit' name='submit' id='submit_btn' value='Submit'></input>
        </fieldset>
    </form> 
```

可悲的是，当我加载页面时，错误并没有隐藏，知道为什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T20:06:19.033

你的代码中有一个`Uncaught SyntaxError: Unexpected token )`。请确保您始终在浏览器中检查您的控制台。见[jsfiddle](http://jsfiddle.net/z9Dje/)

这是您的工作[jsfiddle](http://jsfiddle.net/z9Dje/3/)。您的行中缺少单引号`else $('p#phpErr').html(result.message).show();`以及`);`document.ready 之前的结束语

请始终检查您的控制台，因为这将帮助您解决此类错误...如果您不知道如何使用控制台。 [看一下这个](http://www.techrepublic.com/blog/webmaster/google-chrome-dev-tools-how-to-use-the-console-panel/1195)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-22T20:22:54.480

您的脚本非法`MIME-type`（缺少`s`）

```
 <script type='text/javacript'> 
```

这就是为什么浏览器甚至不尝试执行它的原因

更改为正确`type="text/javascript"`

在你的脚本的最后几行还有几个语法错误，修复这个：

```
 else $('p#phpErr').html(result.message).show(); //missing quote here
        }});
    }); //missing ) here
}); 
```

# maven - maven :: 从文件系统一次将多个第三方工件安装到本地存储库

> ID：12080566
> 
> 赞同：3
> 
> 时间：2012-08-22T20:02:34.120
> 
> 标签：maven, plugins, installation

我们在项目中使用来自第三方公司的非公开工件。我们没有安装 maven 代理（也没有工厂可以这样做，因为我们发现它使事情复杂化而不是解决问题。尤其是在没有互联网连接或 VPN 可用的情况下）。

所以我创建了一组“maven 安装文件”插件执行，如下所示：

```
 <plugin>
            <artifactId>maven-install-plugin</artifactId>
            <version>2.3.1</version>
            <inherited>false</inherited>
            <executions>
                <execution>
                    <id>install-artifacts.1</id>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                    <phase>initialize</phase>
                    <configuration>
                        <pomFile>thirdparty/gwt-0.99.1.pom</pomFile>
                        <file>thirdparty/gwt-0.99.1.jar</file>
                    </configuration>
                </execution>
                <execution>
                    <id>install-artifacts.2</id>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                    <phase>initialize</phase>
                    <configuration>
                        <pomFile>thirdparty/morphia-0.99.1.pom</pomFile>
                        <file>thirdparty/morphia-0.99.1.jar</file>
                    </configuration>
                </execution>
                <execution>
                    <id>install-artifacts.3</id>
                    <goals>
                        <goal>install-file</goal>
                    </goals>
                    <phase>initialize</phase>
                    <configuration>
                        <pomFile>thirdparty/gwt-oauth2-0.2-alpha.pom</pomFile>
                        <file>thirdparty/gwt-oauth2-0.2-alpha.jar</file>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

它工作得很好，完全符合我们的需要。但是，如果添加了新的工件 - 必须添加新的大 XML 部分。

有什么办法可以避免这种情况，比如使用“另一个插件”来搜索文件夹并从中安装所有内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T05:54:04.817

此类事情的最佳解决方案是安装[存储库管理器](http://maven.apache.org/repository-management.html)。您已经写过您不会安装代理，但这是错误的方式。解决此类问题的唯一解决方案是安装存储库管理器。

# heroku - 在 Heroku 中，有没有办法添加多个 HTTP post hooks？

> ID：12080567
> 
> 赞同：11
> 
> 时间：2012-08-22T20:02:38.780
> 
> 标签：heroku

我目前正在使用 Heroku 的 HTTP post hook 插件向我公司的聊天客户端发送消息，但现在我想用它做更多的事情。是否可以添加多个 HTTP post 挂钩，以便在部署发生时通知多个服务？（不，我不想收到电子邮件）。

谢谢！-道格

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-11T22:15:49.480

我的朋友 Jared 为此制作了一个应用程序：[https ://github.com/deadlyicon/deploy-hook-forker](https://github.com/deadlyicon/deploy-hook-forker)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-28T17:12:21.307

现在不行 - 一种解决方法是让一个小应用程序接收您的 HTTP post 挂钩并触发您需要的所有 HTTP 挂钩。

# java - HttpServletRequest getRemoteAddr() 无法正常工作

> ID：12080570
> 
> 赞同：7
> 
> 时间：2012-08-22T20:02:53.667
> 
> 标签：java, servlets, localhost

据我了解，以下代码返回错误：

```
HttpServletRequest httpRequest = (HttpServletRequest) request;
String userIPAddress = httpRequest.getRemoteAddr();

// Actual
// "0:0:0:0:0:0:0:1%0"

// Expected
// "0:0:0:0:0:0:0:1" 
```

知道为什么 %0 在那里吗？当我循环通过

```
InetAddress.getAllByName("localhost") 
```

我得到以下信息：

```
// ["192.168.100.1", "127.0.0.1", "0:0:0:0:0:0:1"] 
```

如果 getRemoteAddr() 返回无效格式，我将如何测试 localhost，或者我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T22:06:21.893

问题是这两个功能

1) java.net.InetAddress.getAllByName(String)

和

2) javax.servlet.ServletRequest.getRemoteAddr()

非常不同。第一个函数是标准 Java 运行时的一部分，第二个函数由 Java EE 容器实现。您正在使用 Tomcat7，因此正在添加可选区域参数 %0。

最重要的是，您不应该像现在这样对 IP 地址进行字符串比较。

你真正应该做的是使用`org.apache.catalina.filters.RemoteIpFilter`. 这以明确定义的方式完成了您尝试做的事情。

例子：

```
<filter>
   <filter-name>RemoteIpFilter</filter-name>
   <filter-class>org.apache.catalina.filters.RemoteIpFilter</filter-class>
   <init-param>
     <param-name>allowedInternalProxies</param-name>
     <param-value>192\.168\.0\.10|192\.168\.0\.11</param-value>
   </init-param>
   <init-param>
     <param-name>remoteIpHeader</param-name>
     <param-value>x-forwarded-for</param-value>
   </init-param>
   <init-param>
     <param-name>remoteIpProxiesHeader</param-name>
     <param-value>x-forwarded-by</param-value>
   </init-param>
   <init-param>
     <param-name>protocolHeader</param-name>
     <param-value>x-forwarded-proto</param-value>
   </init-param>
 </filter> 
```

有关详细信息，请参阅[http://tomcat.apache.org/tomcat-7.0-doc/config/filter.html#Remote_IP_Filter](http://tomcat.apache.org/tomcat-7.0-doc/config/filter.html#Remote_IP_Filter)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T20:22:13.330

`0:0:0:0:0:0:0:1%0`是 IPv6 localhost 的有效长格式。`%0`指定可选区域索引 。

这是有关[IPv6 区域索引](http://en.wikipedia.org/wiki/IPv6_address#Link-local_addresses_and_zone_indices)的更多信息。

我不知道为什么调用`httpRequest.getRemoteAddr();`返回 %0 的可选区域索引，并且

```
InetAddress.getAllByName("localhost") 
```

才不是。但是，我的建议是，如果您要在 localhost 上进行匹配，请同时匹配两种模式，或者进行 startsWith 匹配。

# oracle-apex - APEX 3.2：将交互式报告数据下载到 Excel 的按钮

> ID：12080571
> 
> 赞同：1
> 
> 时间：2012-08-22T20:02:56.407
> 
> 标签：oracle-apex

我的要求是创建两个按钮。一个按钮，将下载交互式报告中的所有数据（从 DB_TABLE 中选择 *）。另一个按钮将下载基于过滤器项目的交互式报告数据（从 DB_TABLE 中选择 *，其中 Name = :P1_Name）

我考虑过使用 javascript:gReport.controls.download(); 但这似乎不起作用。

您可以指出我的任何想法或网站吗？提前谢谢了。

不，我不知道为什么他们需要两个单独的按钮来下载报告，而不是使用交互式报告菜单中的“下载”按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:22:04.800

将按钮的请求值设置为 CSV，因此您的链接看起来像`f?p=181:9:3839908094418724:CSV::::`
这将只执行默认的 CSV 下载。但是，没有内置方法可以从 IR 获取查询。我的意思是应用了过滤器的 IR。
如果您只想下载通过 where 子句中的页面项目过滤的结果，并且不打扰任何 IR 过滤器等，您可以在另一个页面上设置报告，并让您的链接指向第二个按钮目标页面（请求中包含 CSV，但请使用重定向）。浏览器将通过保存对话框提示您，但您最终不会出现在页面上。

# javascript - 使用 Backbone 在模型更改时呈现表单会导致表单 UI 错误

> ID：12080573
> 
> 赞同：14
> 
> 时间：2012-08-22T20:02:59.683
> 
> 标签：javascript, backbone.js

正如大多数指南所示，我有一个简单的视图，当模型发生更改时，它会将自身绑定到重绘：

```
this.model.bind('change', this.render, this); 
```

这个视图有一个带有输入框和提交按钮的表单。我正在绑定输入框的“更改”事件以更改模型上的相关项。（我可以手动执行此操作，也可以使用 ModelBinder 项目执行此操作，两种方式都一样。）

用户更改表单输入框中的值，然后单击提交按钮。模型被更新，视图和表单被重新渲染。提交按钮的点击事件被压扁。

我正在使用 Backbone 的 events 属性：

```
events : {
    'submit form' : 'save'
}, 
```

我知道该事件被忽略了，因为单击的 DOM 元素不再存在。我可以在 render() 中放置一个小的 setTimeout 以防止 HTML 被换出并且事情按预期工作，但这需要等待。

我不能成为第一个为此苦苦挣扎的人——在不丢失一些按键点击或按键信息的情况下，捕获表单“更改”事件、更新模型和重绘视图的标准方法是什么？

同样，如果我有多个表单项，则在重绘表单时更改内容后，用户无法在项目之间切换。

## 更新 1 - 3 天后

仍在努力寻找一个好的解决方案。我尝试过的事情：

*   将视图的内容移动或克隆到页面上的不同区域。仍然从未收到点击事件。
*   使用 $(document).on 或 $(document).live 而不是标准视图事件对象注册点击事件
*   分离表单，使整个表单（输入和按钮）保持在一起而不被重绘。重绘父元素（依赖于表单值）并重新插入已绘制的表单。这修复了无法在元素之间切换的相关问题，但不修复点击事件。
*   在 Firefox 4 中可以正常工作，但不能在 ie9 或 chrome 中使用。*

## 更新 2 - 带有示例代码

其中一条评论要求提供一些代码。我已将代码大量简化为一页并将其包含在下面。实际应用要复杂得多。使用下面简单的代码，我可以在更改时手动重新渲染页面的某些部分。在实际应用程序中，我使用的是dustjs模板，即使我不重新渲染表单，而是重新渲染包含表单的元素，我在点击提交时遇到问题。我希望有一个典型的主干应用程序的“模式”，包括复杂的页面、模型和表单。

大多数“演示”应用程序，甚至我看到的使用主干的网站似乎大多是专注于演示的应用程序，实际上并没有从用户那里收集大量输入。如果您知道基于主干的以数据收集为重点的良好应用程序/演示，那将很有帮助。

代码：

```
<!doctype html>
<html lang="en">
<head>
    <script src="libs/jquery.js"></script>
    <script src="libs/underscore.js"></script>
    <script src="libs/backbone.js"></script>
</head>
<body>
<div id="container"></div>
<script type="text/template" id="edit_user_template">
    <h3>Edit User <%=id%> : <%=name%></h3>
    <form>
        Name: <input type="text" name="name" value="<%=name%>"><br/>
        Email: <input type="text" name="email" value="<%=email%>"><br/>
        <input type="submit">
    </form>
</script>
<script>
    var UserModel = Backbone.Model.extend({});
    var model = new UserModel({id: '1', name:'Joe', email:'a@a.com'});
    var UserView = Backbone.View.extend({
        events : {
            'submit form' : 'save',
            'change input' : 'inputChange'
        },
        initialize: function(){
            this.model.bind('change', this.render, this);
        },
        render: function(){
            var template = _.template($('#edit_user_template').html(), this.model.toJSON());
            this.$el.html(template);
        },
        inputChange : function(evt){
            var target = $(evt.currentTarget);
            this.model.set(target.attr('name'), target.val());
        },
        save : function(event){
            console.log('saving');
            event.preventDefault();
            //this.model.save();
        }
    });
    var view = new UserView({model: model, el: '#container'});
    view.render();
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T17:36:26.493

您要求主干中的模式。该模式是使用模型来保存表单信息（就像您正在做的那样），然后更新页面上的特定元素，而不是在每次模型更改时重新渲染所有内容。ModelBinder 提供了一种很好的方式来完成所有这些工作 (https://github.com/theironcook/Backbone.ModelBinder)。

我认为您不会找到解决无法提交不再存在的表单的方法。你需要以不同的方式完成你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T18:29:41.077

如果我理解正确，您需要做的是将视图拆分为 2 个较小的视图。一个将在更改时重新渲染，另一个将显示表单本身。

根据您的情况，您可能希望也可能不希望第三个视图将这两个视图绑定在一起。

旁注：

当您使用 MVC 设计模式时，它往往是递归的。我认为情况就是这样。将表单中的数据视为模型，将重新渲染视图视为 MVC 的“视图”部分，将表单视图视为“控制器”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T18:05:08.503

不太明白你在做什么，看代码我明白你要模拟knockoutjs的绑定模型，厉害了。

无论如何，如果你分成两个在同一个模型上运行的视图，你可以获得类似的“效果”。一个更新模型，而另一个观察变化并自动更新。

这是代码：

```
<!doctype html>
<html lang="en">
<head>
    <script src="libs/jquery.min.js"></script>
    <script src="libs/underscore.min.js"></script>
    <script src="libs/backbone.min.js"></script>
</head>
<body>
    <div id="header"></div>
    <div id="container"></div>
<script type="text/template" id="user_template">
    <h3>Edit User <%=id%> : <%=name%></h3>
</script>
<script type="text/template" id="edit_user_template">
    <form>
        Name: <input type="text" name="name" value="<%=name%>"><br/>
        Email: <input type="text" name="email" value="<%=email%>"><br/>
        <input type="submit">
    </form>
</script>
<script>
    var UserModel = Backbone.Model.extend({});
    var model = new UserModel({id: '1', name:'Joe', email:'a@a.com'});

    var UserView = Backbone.View.extend({
        initialize: function(){
            this.model.on("change", this.render, this);
        },
        render: function(){
            var template = _.template($('#user_template').html(), this.model.toJSON());
            this.$el.html(template);
            return this;
        },
    });

    var FormView = Backbone.View.extend({
        events : {
            'submit form' : 'save',
            'keyup input' : 'inputChange'
        },
        render: function(){
            var template = _.template($('#edit_user_template').html(), this.model.toJSON());
            this.$el.html(template);
            return this;
        },
        inputChange : function(evt){
            console.log('change');
            var target = $(evt.currentTarget);
            this.model.set(target.attr('name'), target.val());
        },
        save : function(event){
            console.log('saving');
            event.preventDefault();
            //this.model.save();
        }
    });

    var user = new UserView({model: model, el: '#header'});
    user.render();

    var form = new FormView({model: model, el: '#container'});
    form.render();
</script>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T20:26:11.743

您的问题应该有两种可能的解决方案：

1.  绑定到点击提交输入，而不是提交事件本身。

    `events: { 'click input[type=submit]' : 'save' }`

    这应该在完全替换 html 后仍然存在。

2.  渲染后手动重新委托事件。如果您要重新渲染具有子视图的视图，这通常是必要的，但它也适用于此处。

    `this.delegateEvents()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T19:22:06.897

我不知道我是否会完全依靠骨干来解决您的问题。我认为这是骨干允许您填写自己的代码的情况之一。您可以稍微修改模板并听取模型中的变化，然后决定需要重新渲染或更新视图的天气。我不认为我会尝试重新渲染表单部分，除非模型被重置

```
<!doctype html>
<html lang="en">
<head>
<script src="libs/jquery.min.js"></script>
<script src="libs/underscore.min.js"></script>
<script src="libs/backbone.min.js"></script>
</head>
<body>
<div id="container"></div>
<script type="text/template" id="edit_user_template">
    <h3>Edit User <span class="f-id"><%=id%></span> : <span class="f-name"><%=name%></span></h3>
    <form>
        Name: <input type="text" name="name" value="<%=name%>"><br/>
        Email: <input type="text" name="email" value="<%=email%>"><br/>
        <input type="submit">
    </form>
</script>
<script>
    var UserModel = Backbone.Model.extend({});
    var model = new UserModel({id: '1', name:'Joe', email:'a@a.com'});
    var UserView = Backbone.View.extend({
        events : {
            'submit form' : 'save',
            'change input' : 'inputChange'
        },
        initialize: function(){
            //you could have the change event trigger updates instead of re-rendering the form
            //this.model.bind('change', this.update, this);
        },
        render: function(){
            var template = _.template($('#edit_user_template').html(), this.model.toJSON());
            this.$el.html(template);
        },
        inputChange : function(evt){
            var target = $(evt.currentTarget);
            this.model.set(target.attr('name'), target.val());
        },
        update:function(){
            // you could trigger other things here if you need other views to know what is going on.
            $(".f-id").text(this.model.get("id"));
            $(".f-name").text(this.model.get("name"));          
        },
        save : function(event){
            console.log('saving');
            this.update();
            event.preventDefault();
        }
    });
    var view = new UserView({model: model, el: '#container'});
    view.render();
</script>
</body>
</html> 
```

# jquery - 使用 ajax 加载包含 Flexslider 的页面不起作用

> ID：12080575
> 
> 赞同：0
> 
> 时间：2012-08-22T20:03:07.407
> 
> 标签：jquery, flexslider

我有一个使用 ajax 加载不同项目画廊的页面。这工作正常，但是当我想查看项目时，点击不会加载包含项目描述和画廊的页面。

这是我的主页：

```
 $("#residential").on('click', function (event) {
        $.ajax({
        url: 'residential.html'
        , dataType: 'html'
        }).done(function (data) {
        $('#projects').append(data);
    }); 
}); 
```

在 div 中加载：

```
<div class="ten columns content" id="projects">
</div> 
```

当我单击项目的图像时，我希望加载一个包含 flexslider 的带有 ajax 的页面，但在我之前加载的另一个页面中不起作用。

```
$(document).ready(function() {
$("#galery_res").on('click', function (event) {
    $.ajax({
        url: 'galery_res.html'
      , dataType: 'html'
    }).done(function (data) {
        $('#projects').append(data); // the same div of the main page
    }); 
});
}); 
```

带有 flex 滑块的页面：（加载没有 css 的图像）

```
<link rel="stylesheet" href="flexslider.css" type="text/css" media="screen" />
<body class="loading">

<div id="container">

<div id="main" role="main">
  <section class="slider">
    <div class="flexslider">
      <ul class="slides">
        <li>
            <img src="images/galeria1.jpg" />
            </li>
            <li>
            <img src="images/galeria1.jpg" />
            </li>
            <li>
            <img src="images/galeria1.jpg" />
            </li>
            <li>
            <img src="images/galeria1.jpg" />
            </li>
      </ul>
    </div>
  </section>

  </div>

  </div>

  <!-- jQuery -->

  <script type="text/javascript" src="jquery-1.7.2.min.js"></script>

 <!-- FlexSlider -->

 <script defer src="jquery.flexslider.js"></script>

 <script type="text/javascript">
 $(function(){
   $(window).load(function() {
   $('.flexslider').flexslider({
   animation: "slide"
   });
   });
 });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:13:21.503

```
$(document).ready(function() {
   $("#galery_res").on('click', function (event) {
$.ajax({
    url: 'galery_res.html'
  , dataType: 'html'
}).done(function (data) {
    $('#projects').append(data); // the same div of the main page
    $('.flexslider').flexslider({
animation: "slide"
});
}); 
});
}); 
```

我认为`$('#projects').append(data);`不是`$('#proyects').append(data);`

# delphi - Delphi：调用 Delete(...) 拆分字符串时出现“实际参数过多”错误

> ID：12080576
> 
> 赞同：0
> 
> 时间：2012-08-22T20:03:14.727
> 
> 标签：delphi, split, delphi-7

我得到太多实际参数的错误

```
Procedure TSub.ReadUsers;
var
  iPos , i : integer;
begin
  ReadLine;
  iPos := 0;
  for i := 1 to Counter do
    iPos := pos('#',sLine);
  arrUsers[i] := copy(sLine, 1, ipos-1);
  delete(sLine,1,iPos);//error in this line
  iPos := pos('#',sLine);
end; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-22T20:09:35.460

在没有看到其余代码或不知道您使用的 Delphi 版本的情况下，您对 Delete 的调用可能没有引用`System.Delete`（您可能在范围内有另一个`Delete`方法，可能在 class 中`TSub`）。尝试使用以下内容，看看是否可以清除它：

```
System.Delete(sLine,1,iPos); 
```

# eclipse - 在 Eclipse 中使用 Maven 运行 Jetty 服务器时出错

> ID：12080577
> 
> 赞同：0
> 
> 时间：2012-08-22T20:03:17.327
> 
> 标签：eclipse, maven-2, jetty, java-ee-6, maven-jetty-plugin

我正在使用 m2eclipse。

我在 pom.xml 中正确配置了 jetty-maven 插件。

当我尝试通过 CMD 执行它的工作正常。没有错误

而当我尝试通过 Eclipse 执行时，

```
$    java.lang.NoClassDefFoundError: MAVEN_OPTS=-Xdebug -Xnoagent -Djava/compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspended=y,address=8000
Exception in thread "main"      $ 
```

我缺少一些 Jetty - Eclipse 配置。有人可以就此提出建议。

D0 你发现这里有任何错误，

> MAVEN_OPTS="-XX:MaxPermSize=256M -Xmx512M -Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=y"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T10:02:22.880

我找到了....错误出在 VM 参数中。如果您的 VM 参数拼写错误或其他什么，它会引发 filenotfound 错误。

MAVEN_OPTS="-XX:MaxPermSize=256M -Xmx512M -Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=y"

实际的：

-XX:MaxPermSize=256M -Xmx512M -Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=y

当你进入 Eclipse 时，没有 MAVEN_OPTS 在 VM 参数中没有引号......

# php - 在 Javascript 之后获取 HTML - 服务器应用程序

> ID：12080578
> 
> 赞同：1
> 
> 时间：2012-08-22T20:03:19.177
> 
> 标签：php, javascript, c++, html, linux

在 Javascript 加载并执行后，我需要一种方法来获取页面的完整 HTML 内容。它必须构建为服务器端应用程序 (Linux)，并且可以包含任何第 3 方软件（一些没有 GUI 的浏览器或任何其他可以提供帮助的软件）。

这可以使用 PHP 或 Cpp 来完成，如果不是，我还有什么其他选择？这是一个奇怪的主题——我很难找到关于它的信息。感谢您的任何帮助。

所以我发现了一些关于主题的东西 -[任何在没有 GUI/X 会话的情况下使用 GreaseMonkey 脚本运行 Firefox 的方法](https://stackoverflow.com/questions/2109570/any-way-to-run-firefox-with-greasemonkey-scripts-without-a-gui-x-session)，但是如果有人要添加一些东西，我仍然愿意接受建议。

似乎 Node.js 可以提供帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:36:22.127

你想要这个[http://phantomjs.org/](http://phantomjs.org/)。它使用 JavaScript，但允许您做任何您可以在 Web 浏览器中做的事情（包括查看 DOM 的当前状态）。

# excel - 过滤另一个单元格时如何查看合并单元格的文本？

> ID：12080579
> 
> 赞同：0
> 
> 时间：2012-08-22T20:03:30.127
> 
> 标签：excel, excel-2007, openoffice.org, office-2007, openoffice-calc

两列在这张图片上看起来像。

![](../Images/6df78b5d0ee4d68bd54c8031de322891.png)

当我只想显示包含字母“b”的单元格时，我无法再看到通常在 B 列中可见的文本“Title1”和“Title2”。

![](../Images/cc924b4b42019f3cf490c94f82be93db.png) ![](../Images/6e5edf85180929b968d50c49546055d1.png)

我猜虽然B列中的单元格被合并了，但文本仍然绑定到A3，分别绑定到A7。

那么我怎样才能同时过滤可见内容并保留合并的文本呢？简而言之，我想按字母“b”过滤内容，但我仍然想在 B 列中看到文本“title 1/2”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T22:07:15.027

您标记了 excel，所以这是 excel 中的一个解决方案：

您需要单击包含合并单元格的列并取消合并所有单元格。

然后你需要把这个公式放在你的列表的顶部，并用 ctrl+shift+enter 输入它（这将作为一个数组公式输入）：

```
=OFFSET(C3,MAX(IF(NOT(ISBLANK(C$3:C3)),ROW(C$3:C3),0))-ROW(C3),0) 
```

然后你需要自动填充它。（这个函数看起来有点冗长，但我刚上网 - 可能有一种更简单的方法可以做到这一点 - 但它会找到一个范围内的最后一个非空白单元格）。

![取消合并单元格解决方案](../Images/86bbb1af833c8e75e24d53e7d119b26b.png)

我认为 openoffice 具有类似的功能，因此您应该能够在 openoffice 中执行相同或类似的操作。

或者，如果您使用的是 excel，您可以单击要取消合并的列并运行此宏：

```
Sub UnMergeSelectedColumn()

    Dim C As Range, CC As Range 
    Dim MA As Range, RepeatVal As Variant 

    For Each C In Range(ActiveCell, Cells(Rows.Count, ActiveCell.Column).End(xlUp)) 
        If C.MergeCells = True Then 
            Set MA = C.MergeArea 
            If RepeatVal = "" Then RepeatVal = C.Value 
            MA.MergeCells = False 
            For Each CC In MA 
                CC.Value = RepeatVal 
            Next 
        End If 
        RepeatVal = "" 
    Next

End Sub 
```

祝你好运。

**编辑：**

我找到了一个非 VBA 解决方案，它可以在 excel 和 openoffice 中使用，**并且不需要**您将其作为数组公式输入（使用 ctrl+shift+enter）：

```
=INDEX(B:B,ROUND(SUMPRODUCT(MAX((B$1:B1<>"")*(ROW(B$1:B1)))),0),1) 
```

在开放式办公室中，我认为您想像这样输入它：

```
=INDEX(B:B;ROUND(SUMPRODUCT(MAX((B$1:B2<>"")*(ROW(B$1:B2)))),0),1) 
```

或者可能是这样的：

```
=INDEX(B:B;ROUND(SUMPRODUCT(MAX((B$1:B2<>"")*(ROW(B$1:B2)))),0)) 
```

您只需要自动填充该公式即可：

![OpenOffice 兼容解决方案](../Images/28a7e6bfdfb0f07154134fa553738643.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T16:21:56.453

您的主要问题似乎是您在过滤器字段之后留下的一个“空白行”。

删除它，它会正常工作。

# javascript - Javascript全选复选框突然不起作用

> ID：12080581
> 
> 赞同：1
> 
> 时间：2012-08-22T20:03:36.960
> 
> 标签：javascript, function

我有 60 个名为“AG[]”的复选框，我使用全选功能来完成这项工作，并结合了名为 CheckAll 的按钮上的事件监听器。突然按钮停止工作..全选功能是

```
function selectAll(a,b) {
var checkies = document.getElementsByName('AG[]');
for (var i = a;i < b;i++) {
    checkies[i].checked = !(checkies[i].checked);
    }
} 
```

这行得通，因为我尝试加载该函数的一次运行。这是在按钮上添加事件侦听器的完整脚本 onload。

```
function script1() {
var el = document.getElementsByName('CheckAll'); 
el1 = el[0]; 
el2 = el[1];
el3 = el[2];
el4 = el[3];
el5 = el[4];
el6 = el[5];
el7 = el[6];

el1.addEventListener('click', function(){selectAll(0,8)}, false);
el2.addEventListener('click', function(){selectAll(8,16)}, false);
el3.addEventListener('click', function(){selectAll(16,26)}, false);
el4.addEventListener('click', function(){selectAll(26,34)}, false);
el5.addEventListener('click', function(){selectAll(34,44)}, false);
el6.addEventListener('click', function(){selectAll(44,52)}, false);
el7.addEventListener('click', function(){selectAll(52,60)}, false);

} 
```

如果我像

```
SelectAll(0,8); 
```

它可以工作，但如果我通过 addeventlistener 来做，它不会。代码运行良好，我可以用按钮检查所有内容，但我不明白发生了什么.. **这是 jsfiddle [jsfiddle](http://jsfiddle.net/VHXDx/3/)**

**好的新问题。** Andreas 发布的代码仍然对我不起作用，这可能意味着它是因为我从不支持 addeventlistener 的 IE7 运行它。那么我如何让我的代码支持 firefox/chrome(Addeventlistener) 和

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:32:03.437

牢记[addEventListener 与 onclick](https://stackoverflow.com/questions/6348494/addeventhandler-vs-onclick)，实用且简单的版本如下，因为它适用于所有浏览器 - 链接中提到的缺点是 onlick 仅支持一个事件处理程序，而 attachevent/addEventListener 将触发所有已注册的回调。

[演示](http://jsfiddle.net/mplungjan/NEAvc/)

```
function selectAll(a,b) {
  var checkies = document.getElementsByName('AG[]');
  for (var i = a;i < b;i++) {
    checkies[i].checked = !checkies[i].checked;
  }
}
function script1(){
  var el = document.getElementsByName('CheckAll');  // get all elements with that name="" attribute
  el[0].onclick=function() { selectAll(0,8) }
  el[1].onclick=function() { selectAll(8,16)}
  el[2].onclick=function() { selectAll(16,26)}
  el[3].onclick=function() { selectAll(26,34)}
  el[4].onclick=function() { selectAll(34,44)}
  el[5].onclick=function() { selectAll(44,52)}
  el[6].onclick=function() { selectAll(52,60)}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:32:00.350

我做了一些改变来工作`IE < 9`，即

```
addEvent(el1, 'click', function(){selectAll(0,8)},false);
function addEvent(el, event, callback, bubble){
    if(el.addEventListener) el.addEventListener(event, callback, bubble);
    else if(el.attachEvent) el.attachEvent('on'+event, callback, bubble);
} 
```

[**完成演示**](http://jsfiddle.net/VHXDx/7/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:27:41.527

你忘了`function`在 script1() 之前加上这个词，所以你得到了一个错误，因为它不知道`script1()`你的`body onload`. 我尝试了这段代码（几乎是复制和粘贴（我一直不喜欢 JS fiddle），它似乎可以工作。

```
<!DOCTYPE html>
<html>
    <style>
        html, body { height: 100%; }
        #container { margin-top: 29px; }
        header { height:29px; margin: 0 49px; background-color:#999999; }

        #div1 { width: 29px; height: 100%; background-color: yellow; display: inline-block; }
        #div2 { width: 100%; height: 100%; background-color: blue; display: inline-block; }
        #div3 { width: 29px; height: 100%; background-color: red; display: inline-block; float: right;}
        #div4 { height: 100%; background-color: yellow; display: inline-block;  float: right; }
    </style>
<body>
<body onload="script1();">
    Please check the box if you took a course in the respective subject in that semester.
<table width="200" border="1">
  <tr>
    <th scope="col"></th>
    <th scope="col">8th Sem 1</th>
    <th scope="col">8th Sem 2</th>
    <th scope="col">9th Sem 1</th>
    <th scope="col">9th Sem 2</th>
    <th scope="col">10th Sem 1</th>
    <th scope="col">10th Sem 2</th>
    <th scope="col">11th Sem 1</th>
    <th scope="col">11th Sem 2</th>
    <th scope="col">12th Sem 1</th>
    <th scope="col">12th Sem 2</th>
    <th scope="col">Select All Semesters</th>
  </tr>
  <tr>
    <th scope="row">History</th>
    <td></td>
    <td></td>
    <td><input name="AG[]" type="checkbox" value="A9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="A9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="A10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="A10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="A11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="A11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="A12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="A12Sem2"></td>
    <td><input type="button" name="CheckAll" value="Check All"></td>
  </tr>
  <tr>
    <th scope="row">English</th>
    <td></td>
    <td></td>
    <td><input name="AG[]" type="checkbox" value="B9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="B9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="B10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="B10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="B11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="B11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="B12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="B12Sem2"></td>
    <td> <input type="button" name="CheckAll" value="Check All"></td>
  </tr>
  <tr>
    <th scope="row">Mathematics</th>
    <td><input name="AG[]" type="checkbox" value="C8Sem1">*</td>
    <td><input name="AG[]" type="checkbox" value="C8Sem2">*</td>
    <td><input name="AG[]" type="checkbox" value="C9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="C9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="C10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="C10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="C11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="C11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="C12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="C12Sem2"></td>
    <td> <input type="button" name="CheckAll" value="Check All"></td>
  </tr>
  <tr>
    <th scope="row">Science</th>
    <td></td>
    <td></td>
    <td><input name="AG[]" type="checkbox" value="D9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="D9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="D10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="D10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="D11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="D11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="D12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="D12Sem2"></td>
    <td> <input type="button" name="CheckAll" value="Check All"></td>
  </tr>
  <tr>
    <th scope="row">Foreign Language</th>
    <td><input name="AG[]" type="checkbox" value="E8Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="E8Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="E9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="E9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="E10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="E10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="E11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="E11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="E12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="E12Sem2"></td>
    <td> <input type="button" name="CheckAll" value="Check All"></td>
  </tr>
  <tr>
    <th scope="row">Visual and Performing Arts</th>
    <td></td>
    <td></td>
    <td><input name="AG[]" type="checkbox" value="F9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="F9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="F10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="F10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="F11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="F11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="F12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="F12Sem2"></td>
    <td> <input type="button" name="CheckAll" value="Check All"></td>
  </tr>
  <tr>
    <th scope="row">Electives</th>
    <td></td>
    <td></td>
    <td><input name="AG[]" type="checkbox" value="G9Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="G9Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="G10Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="G10Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="G11Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="G11Sem2"></td>
    <td><input name="AG[]" type="checkbox" value="G12Sem1"></td>
    <td><input name="AG[]" type="checkbox" value="G12Sem2"></td>
    <td> <input type="button" name="CheckAll" value="Check All"></td>
  </tr>
</table>
</body>
    <script>
function selectAll(a,b) {
var checkies = document.getElementsByName('AG[]');
for (var i = a;i < b;i++) {
    checkies[i].checked = !(checkies[i].checked);
    }
}
function script1(){
var el = document.getElementsByName('CheckAll');  // get all elements with that name="" attribute
el1 = el[0];  // get the first element (in this case, being the only one)
el2 = el[1];
el3 = el[2];
el4 = el[3];
el5 = el[4];
el6 = el[5];
el7 = el[6];

// now we have an element to call the method on

el1.addEventListener('click', function(){selectAll(0,8)}, false);
el2.addEventListener('click', function(){selectAll(8,16)}, false);
el3.addEventListener('click', function(){selectAll(16,26)}, false);
el4.addEventListener('click', function(){selectAll(26,34)}, false);
el5.addEventListener('click', function(){selectAll(34,44)}, false);
el6.addEventListener('click', function(){selectAll(44,52)}, false);
el7.addEventListener('click', function(){selectAll(52,60)}, false);

}
    </script>
</html> 
```

# sql - 基于索引名称而不是表（列）创建外键

> ID：12080583
> 
> 赞同：1
> 
> 时间：2012-08-22T20:03:42.030
> 
> 标签：sql, postgresql, indexing, foreign-keys

我有一个带有时间戳字段的表，我在该表上创建了一个复合索引。

```
CREATE INDEX "IDX_NAME_A" ON TABLE "A" (a_id, extract(year FROM created_at)) 
```

我有另一个表，它存储一年和我想有一个外键关系的 a_id。

我似乎找不到做我想做的事的语法。

```
ALTER TABLE "B" 
  ADD FOREIGN KEY(a_id, a_year) 
  REFERENCES A(a_id, extract(YEAR FROM created_at)); 
```

产生：

```
ERROR:  syntax error at or near "(" 
```

我也试过...

```
ALTER TABLE "B"
  ADD FOREIGN KEY(a_id, a_year) 
  USING INDEX "IDX_NAME_A"; 
```

有任何想法吗？

```
Table A
--------
a_id serial,
created_at timestamp default now()

Table B
-------
b_id serial
a_id integer not null,
a_year date_part('year') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:09:11.387

外键约束不能引用索引。它必须是一张桌子。
外键约束不能引用表达式。它必须指向被引用表的列名。
并且必须在引用的列集上存在唯一索引（主键也隐含地限定）。

首先[在这里阅读有关外键的手册](http://www.postgresql.org/docs/current/interactive/ddl-constraints.html#DDL-CONSTRAINTS-FK)。

* * *

上乘的设计将只是删除列`b.a_year`。它是 100% 冗余的，可以从`a.created_at`任何时间派生出来。

如果您确实需要该列（例如，对于 table 中的某些条件每年强制执行一行`b`），您可以像这样实现您的目标：

```
CREATE TABLE a (
  a_id serial
 ,created_at timestamp NOT NULL DEFAULT now()
 ,a_year NOT NULL DEFAULT extract(year FROM now())::int -- redundant, for fk
 ,CHECK (a_year = extract(year FROM created_at)::int)
);

CREATE UNIQUE INDEX a_id_a_year_idx ON TABLE a (a_id, a_year); -- needed for fk

CREATE TABLE b (
  b_id serial
 ,a_id integer NOT NULL
 ,a_year int -- doesn't have to be NOT NULL, but might
 ,CONSTRAINT id_year FOREIGN KEY (a_id, a_year) REFERENCES a(a_id, a_year)
); 
```

在@Catcall 的评论之后更新：`CHECK`结合列`DEFAULT`和`NOT NULL`子句的约束强制执行您的制度。

或者（不太简单，但允许`NULL`值）您可以`a.a_year`使用[触发器](http://www.postgresql.org/docs/current/interactive/sql-createtrigger.html)维护值：

```
CREATE OR REPLACE FUNCTION trg_a_insupbef()
  RETURNS trigger AS
$BODY$
BEGIN

NEW.a_year := extract(year FROM NEW.created_at)::int;
RETURN NEW;

END;
$BODY$
  LANGUAGE plpgsql VOLATILE;

CREATE TRIGGER insupbef
  BEFORE INSERT OR UPDATE ON a
  FOR EACH ROW EXECUTE PROCEDURE trg_a_insupbef(); 
```

# python - Python、py2exe 和 pyopengl ImportError：没有名为 win32 的模块

> ID：12080587
> 
> 赞同：1
> 
> 时间：2012-08-22T20:03:58.250
> 
> 标签：python, opengl, pygame, py2exe, pyopengl

当我尝试使用 py2exe 构建 exe 时，它​​会构建，但是当我尝试运行 exe 时会抛出此错误：

```
Traceback (most recent call last):
File "main.py", line 4, in <module>
File "OpenGL\GL\__init__.pyc", line 3, in <module>
File "OpenGL\GL\VERSION\GL_1_1.pyc", line 10, in <module>
File "OpenGL\platform\__init__.pyc", line 35, in <module>
File "OpenGL\platform\__init__.pyc", line 26, in _load
File "OpenGL\plugins.pyc", line 14, in load
File "OpenGL\plugins.pyc", line 28, in importByName
ImportError: No module named win32 
```

只有当我使用 pyopengl 时它才会这样做，它可以完美地构建和运行 pygame 以及我使用过的几乎任何其他库/模块。

我的 setup.py 脚本如下所示：

```
from distutils.core import setup  
import py2exe  
setup(console=['main.py']) 
```

我在 Windows 7 64 位

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:59:34.520

实际上，经过一个小时左右的搜索，我找到了解决方案！

对于其他有此问题的人：http: [//www.py2exe.org/index.cgi/PyOpenGL](http://www.py2exe.org/index.cgi/PyOpenGL)

# scorm - 使用 SCORM 2004 LMS 和/或 SCORM 2004 SCO，教师可以更改排序吗？

> ID：12080589
> 
> 赞同：1
> 
> 时间：2012-08-22T20:04:02.560
> 
> 标签：scorm, scorm2004

我一直在浏览大量描述 SCORM 2004 的文档，并相信活动的顺序在每个 SCO 的元数据中指定。因此，一个 SCO 可以定义在其提出的特定目标通过或失败的情况下应该提出哪些其他 SCO。假设我是正确的，这表明排序是相当静态的。

我们当前不符合 SCORM 的 LMS 还规定了学生在通过或未通过特定目标时应查看的活动。它还允许老师覆盖处方。

SCORM 2004 是否支持这种排序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T05:09:38.123

> 活动的顺序在每个 SCO 的元数据中指定

不，活动的顺序是通过`<sequencing>`清单文件中的元素实现的。

> 排序是相当静态的

在 SCORM 2004 中，排序是完全动态的；排序实现基于活动的跟踪模型和排序定义模型来识别下一个活动。实际上，Tracking Model 的值是动态的，而 Sequencing Definition Model 的值是静态的。实际上，在 SCORM 2004 中，排序实现收集学习者与 SCO 交互的结果（通过 CMI 数据模型）并将它们映射到跟踪模型，然后根据跟踪模型评估排序规则（为活动定义）。

# javascript - jQuery“悬停放大”无法相对于图片中心放大

> ID：12080590
> 
> 赞同：0
> 
> 时间：2012-08-22T20:04:11.217
> 
> 标签：javascript, jquery, wordpress, tubepress

我在了解基本部分方面得到了一些很大的帮助，但现在我再次需要帮助:(下面的 javascript 应该可以做到这一点，以便当您将鼠标悬停在画廊中的缩略图上时，缩略图会放大。我增加了高度和宽度，但我还更改了顶部和左侧的偏移量以进行补偿，以使图片看起来相对于缩略图的中心正在放大，而不是向右下角延伸。

```
 jQuery('.videogall-thumb').hover(function() {
    var currThumb = jQuery(this).attr('id');
    jQuery('.videogall-thumb[id="' + currThumb +'"]').stop().animate({height: "100", width: "118", left: "-12", top: "-15"}, "fast");
}, function() {
    jQuery('.videogall-thumb').stop().animate({height: "83", width: "98", left: "0", top: "0"}, "fast");
}
); 
```

至少那是我希望发生的事情。但是缩略图仍然在伸展，而不是从中心放大。此外，正在放大的缩略图最终会在该行的相邻缩略图下方而不是在它们的顶部，并且它会推动下一行中的相邻缩略图。看看我的意思：http: [//oneworldyouthproject.org/tubepress-test/](http://oneworldyouthproject.org/tubepress-test/)

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:08:43.440

您需要设置`position: relative`您的`img`元素才能使`left`and`top`定位起作用。

# php - 你应该把 session.save_path 放在哪里？

> ID：12080612
> 
> 赞同：1
> 
> 时间：2012-08-22T20:05:56.693
> 
> 标签：php, session

由于默认设置`/tmp`通常对共享主机中的所有帐户开放，因此通常建议使用`session.save_path`并设置不同的位置。

是否假设一个更好的位置在`/home/username/example_session_tmp/`只要它不在`/home/username/public_html/`？

如果是这样，万一黑客能够注入脚本`public_html`并阅读，那是否仍然容易受到攻击`../example_session_tmp/`？还是这是唯一的方法，并且通常假设您的网站不受脚本注入的影响？

注意：数据库会话处理程序是一个替代选项，但我们假设它是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:14:05.857

我同意你的加入`/home/username/example_session_tmp/`。

但，

*   如果每台服务器只有一个站点，则无需更改路径
*   如果您想将共享托管作为您的解决方案，那么移动到新路径是一个好主意（您可以检查`apache-mpm-itk`或`php5-fpm`）
*   如果您想拥有多个服务器，最简单的方法是将会话放入数据库中，或者为会话文件创建一个共享文件夹（nfs、samba）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:14:19.607

如果黑客将脚本进入您的站点，那么您无法阻止他阻止会话。如果您的网络服务器有权访问会话，则该用户将。无论你把它放在哪里，黑客都可以通过简单的调用找到`session_save_path`.

总结一下：

*   防止黑客获得访问权限。如果您的服务器完全开放，谁会关心会话？首先确保这一点。
*   将 save_path 设置为`~/sessions` *应该可以*防止其他共享主机用户篡改您的会话。这并不能阻止访问您的网络服务器的人看到和篡改会话。

# c# - 如何在 ListView 上实现多个列标题？

> ID：12080614
> 
> 赞同：-1
> 
> 时间：2012-08-22T20:06:00.450
> 
> 标签：c#, winforms, listview, columnheader

就像在图片上一样，它下面有第二列标题和两个子标题？

![在此处输入图像描述](../Images/a3d31ddc02aa6ee04ac1c5c3dbed863d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:13:46.113

有关完整示例，请查看此链接，这应该为您提供一个完整的工作示例，说明您可以做什么 [添加 ListView Column 和 Insert Listview Items](http://www.java2s.com/Code/CSharp/GUI-Windows-Form/AddListViewcolumnandinsertListViewrows.htm)

尝试这样的事情

将值添加到数组的顺序决定了它们出现在哪个列下，因此可以将子项目标题视为 [0]、[1](http://www.java2s.com/Code/CSharp/GUI-Windows-Form/AddListViewcolumnandinsertListViewrows.htm)等。

这是一个代码示例：

//在这个例子中，一个包含三个项目的数组被添加到一个三列列表视图中 string[] saLvwItem = new string[2];

```
foreach (string wholeitem in listofitems)
{
     saLvwItem[0] = "Status Message";
     saLvwItem[1] = wholeitem;
     ListViewItem lvi = new ListViewItem(saLvwItem);

     lvwMyListView.Items.Add(lvi);
} 
```

要添加 SubItems 你也可以做这样的事情

```
lvwMyListView.Items[0].SubItems.Add("John Smith"); 
```

# bash - 基于 slackware 的 Linux 操作系统上的 Shell 脚本错误

> ID：12080616
> 
> 赞同：1
> 
> 时间：2012-08-22T20:06:17.240
> 
> 标签：bash, shell

我有一个可以在 Ubuntu 上运行的 shell 脚本，可以根据需要为我提供输出。当我在 slackware linux 版本上进行测试时，我的脚本失败了。

该脚本在以下位置失败：

```
dialog --title "Test" --gauge "Copying file." 6 100 < <(
    rsync -a --progress test.tar.gz /media/sda1 | 
    unbuffer -p grep -o "[0-9]*%" | 
    unbuffer -p cut -f1 -d '%'  
    ) 
```

错误是：

```
Syntax error near unexpected token `<' 
```

脚本无法执行的两个操作系统之间可能有什么不同？如果我摆脱对话框命令和括号等，脚本将成功执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:28:32.203

很可能，您正在尝试使用非 bash shell 运行 bash 脚本。或者使用较旧的 bash 版本。

首先，尝试通过 bash 显式运行它，即：

```
bash script.sh 
```

您还应该修复您的 shebang 指向 bash：

```
#!/bin/bash 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T21:40:11.267

[以下更新]

`< <( ... )`符号对于`bash`和是唯一的`zsh`。语法错误是 slackware shell 无法识别的明显标志。

要么 slackware 不使用 bash，要么它的 bash 版本对于这个特性来说太旧了。检查两个平台上 $BASH_VERSION 的值。

一个可能的替代方案

```
cat < <(
    ...
    ...
) 
```

可能：

```
cat <<< "$(
    ...
    ...
)" 
```

这将在 bash、ksh93 和 zsh 中工作，并且存在的时间稍长。

更新

根据您的反馈，我查看了您在此处尝试使用的实际管道。我相信您打算将`--progress`输出的第 3 列用作对话框图形进度指示器的输入。

我尝试了一个包含很多小文件的目录。您是否知道此百分比指标是针对每个文件的？对于我的小文件，rsync 每个文件只提供一个更新。由于每个文件都是一次性写入的，因此所有百分比都等于`100%`.

# mysql - multiple order by 是否可以按日期排序的模块 id 带来最新（只有一篇）文章？例子

> ID：12080618
> 
> 赞同：0
> 
> 时间：2012-08-22T20:06:28.480
> 
> 标签：mysql, sql, sql-order-by

我有这个查询，我想在按模块排序时从复杂的连接中获取最新和最新的文章。

我对 stackoverflow 大师的问题如下。

**是否可以通过按日期排序的模块 id 带来最新（只有一篇）文章？**

```
SELECT *
FROM articles Article
LEFT JOIN sources Source ON Article.source_id = Source.id
RIGHT JOIN app_sources asrc ON asrc.source_id = Source.id
/*GROUP BY asrc.module*/ -> if I enable this i get only one but no order by date
ORDER BY asrc.module ASC, Article.published_at DESC 
```

这是我的第一个问题，我希望我的格式正确！非常感谢

目前是这样的（2k结果）

```
published_at    title   module
2012-08-22 12:16:41 |   Archos Gen10: Tablet Productivity | 1
2012-08-22 12:13:22 | Vail Resorts Ski App Gets Racing With Lindsey Vonn |  1
2012-08-22 11:58:06 | The Internet a Decade Later [INFOGRAPHIC] |   1 
```

我想要这样

```
published_at    title   module
2012-08-15 14:37:40 | The Air Force’s New Ultra-Fast Jet Has an Epic Fai... | 1
2012-01-13 16:17:51 | Canada’s Helium Digital shows us the thinnest iPad... | 2
2012-01-13 14:40:14 | ESPN Feels Lonely: A Chat Regarding ESPN’s Role In... | 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:32:27.320

在没有看到您的表结构的情况下，很多这将是猜测。但似乎你需要`MAX()`在`published_at`现场加入一个。

像这样的东西：

```
SELECT *
FROM
(
    SELECT max(published_at) maxDate, source_id
    FROM articles
    GROUP BY source_id
) Article
LEFT JOIN sources Source 
    ON Article.source_id = Source.id
LEFT JOIN app_sources asrc 
    ON Source.id = asrc.source_id
ORDER BY asrc.module ASC, Article.maxDate DESC 
```

如果您想要更明确的答案，您将需要提供更多详细信息。

# jasper-reports - 如何在 iReport 中的存储库之间复制报告？

> ID：12080629
> 
> 赞同：1
> 
> 时间：2012-08-22T20:08:14.287
> 
> 标签：jasper-reports, ireport, jasperserver

我有两个存储库（JasperServers），一个在我的本地机器上用于开发，然后是“生产”一个。

我有关于 JasperServer 开发副本的所有报告，并且一切正常。现在，我想将这些报告复制到 JasperServer 的生产副本中。当我选择复制并尝试粘贴到另一个仓库时，粘贴显示为灰色。

如何使用 iReport 在两个 Jasper Server 实例之间复制报告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:57:47.290

iReport 是满足该要求的错误工具。

使用 js-export 和 js-import 促进报告从开发到生产。

# c++ - 类型转换问题

> ID：12080632
> 
> 赞同：0
> 
> 时间：2012-08-22T20:08:22.770
> 
> 标签：c++, casting, virtual, dynamic-cast

假设您有基类`Unix_tree`和派生类，`Unix_tree_type1`依此`Unix_tree_type2`类推。为什么我不能投射`Unix_tree`到`Unix_tree_type`...？有没有办法进行这样的演员表？派生类包含抽象方法的实现，它们的目标是以不同的方式打印基类中包含的数据。谢谢。

```
class Unix_tree
    {
    public:
        Unix_tree () 
        {
            tree_it.tree = &tree;
        }

        Unix_tree(const Unix_tree& utree) : num_of_files(utree.num_of_files), tree(utree.tree), tree_it(utree.tree_it) 
        {
            tree_it.tree = &tree;
        };

        int num_of_files;
        map<int, pair<int, string> > names;
        vector<pair<int, int> > edges;

        Tree< pair<int, string> > tree;
        TreeIterator< pair<int, string> > tree_it;

        string input_format;
        string output_format;

        static Unix_tree* load_tree(istream& input_info);
        void load_names(istream& input_info);
        void load_tree_nodes(vector<int>& levels);
        Unix_tree* convert(string format);

        virtual void load(istream& input_info) = 0;
        virtual void print_function(const Tree<pair<int, string> >* node, const vector<bool>& visited ) = 0;
        void print_tree();
    };

    class Unix_tree_type1 : public Unix_tree
    {
    public:

        void load(istream& input_info);
        void print_function(const Tree<pair<int, string> >* node, const vector<bool>& visited);
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:17:03.943

您可以转换*指针*，因此：

```
Unix_tree *p = ...;
Unix_tree_type1 *q = (Unix_tree_type1*)p; 
```

但我不认为你想这样做。方法调用会自动执行您想要的操作，因此：

```
Unix_tree *p = ...; // points to an instance of Unix_tree_type1
p->load(...);       // calls Unix_tree_type1::load, not Unix_tree::load 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:18:05.023

你可以施放，但你不应该。您应该只调用基类指向的对象的成员函数，然后您的实现将被调用。这就是虚成员函数的意义所在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:26:53.560

没有办法将基类转换为派生类，因为它没有意义。无需过多介绍 OO 细节，从基类继承的目的不仅仅是“打印基类中包含的数据”——而是提供更具体的功能实现。所以想象一个“水果”类，它有方法“GetJuice()”。继承自“Fruit”的类“Apple”可能会继承方法“GetJuice()”。但是，除了该方法之外，它还可以定义特定于其类型的其他方法或属性，例如“FindAppleWorm()”。因此，当您有一个 Apple 类时，您可以将其转换为类型 fruit，调用 Fruit 类的“GetJuice()”方法仍然有意义。然而，

面向对象语言中的继承概念补充了多态性的概念。我会推荐[维基百科文章](http://en.wikipedia.org/wiki/Subtype_polymorphism)以获得很好的介绍。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T20:21:12.577

你为什么不能？当然可以 - 这是有效的向上转换，可以通过`dynamic_cast`. 但是你应该转换指针或引用，而不是类型本身。

```
Unix_tree_type1* ptree1 = ...; // Some pointer initialization
Unix_tree* ptree2 = dynamic_cast<Unix_tree*>(ptree1);// Safe
Unix_tree* ptree3 = static_cast<Unix_tree*>(ptree1); // Also safe 
```

# php - MYSQL 排序依据和分组依据

> ID：12080633
> 
> 赞同：0
> 
> 时间：2012-08-22T20:08:36.003
> 
> 标签：php, mysql

我目前有这个

```
SELECT type, extra_id, COUNT(*) AS count, id 
FROM `notifications` 
WHERE `receiver_id` = '".$this->user_id."' 
    AND `read` = '0' 
GROUP BY type, extra_id 
ORDER BY `id` DESC 
```

但这仅按数据库中第一个找到的结果排序，因为这是我选择 id 时所采用的。我怎样才能做到这一点，以便`notifications`在 SELECT **id**中使用最后找到的 ID ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:19:23.537

只需选择`MAX(id)`而不是`id`：

```
SELECT type, extra_id, COUNT(*) AS count, MAX(id) AS max_id
FROM `notifications` 
WHERE `receiver_id` = '".$this->user_id."' 
    AND `read` = '0' 
GROUP BY type, extra_id 
ORDER BY max_id DESC 
```

# design-patterns - 接口地狱还是可接受的设计？

> ID：12080635
> 
> 赞同：4
> 
> 时间：2012-08-22T20:08:44.070
> 
> 标签：design-patterns, interface, strategy-pattern

我正在重构一些通过 case 语句一遍又一遍地做接近相同事情的遗留代码：

```
switch(identifier)
    case firstIdentifier: 
        (SomeCast).SetProperties(Prop1,Prop2,Prop3);
        break;
    ...
    case anotherIdentifier:
        (SomeDifferentCast).SetProperties(Prop1, Prop2, Prop3);
        break; 
```

所以，我尝试创建一个独特的界面，这样它就可以成为

```
(SameInterfaceCast).SetProperties(Prop1,Prop2,Prop3); 
```

但是，我随后发现有些项目甚至没有使用所有属性。于是，我开始想到更像这样的东西：

```
if(item is InterfaceForProp1)
    (InterfaceForProp1).SetProp1(Prop1);
if(item is InterfaceForProp2)
    (InterfaceForProp2).SetProp2(Prop2);
if(item is InterfaceForProp3)
    (InterfaceForProp3).SetProp3(Prop3); 
```

你可以创建一个这样的类：

```
public class MyClassUsesProp2And3 : InterfaceForProp2, InterfaceForProp3 
```

但是，我担心我过度分散了这段代码，它可能会膨胀太多。也许我不应该太害怕本质上是一种方法接口，但我想在走这条路之前看看我是否缺少设计模式？（唯一出现在我脑海中但不太合适的是[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)或[复合](http://en.wikipedia.org/wiki/Composite_pattern)模式）

**更新**

所有属性都是唯一类型。

最终，这是一种依赖注入的形式。代码太乱了，现在不能使用像 Ninject 这样的东西，但最终我什至可以摆脱其中的一些并使用注入容器。除了设置变量之外，目前还有一些逻辑正在完成。这都是遗留代码，我只是想一点一点地清理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T05:52:41.167

当您面对 switch 语句和类型转换时，[访问者模式是标准的解决方案。](http://en.wikipedia.org/wiki/Visitor_pattern)您的每种情况的代码将进入访问者类中的单独方法。您的每个类将只实现一个接口——一种`accept`接受访问者的方法。你最终会得到比现在更多的代码，但它会读起来更清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T07:23:01.360

基本上，您想让演员（使用 setProp 方法的类型）成为相同类型的“演员”，并使属性（prop1...n）成为相同类型的“道具”。这会将您的代码减少到

```
actor.setProp(prop) 
```

如果您想避免使用instanceOf，我能想到的唯一方法是使用访问者模式，使“道具”成为访问者。我也会使用模板方法让我的生活更轻松。在 Java 中，我会让它看起来像这样（对于两种实际的 Prop）。

```
class Actor {

    protected void set(Prop1 p1) {
        // Template method, do nothing
    }

    protected void set(Prop2 p2) {
        // Template method, do nothing
    }

    public void setProp(Prop p) {
        p.visit(this);
    }

    public interface Prop {
        void visit(Actor a);
    }

    public static Prop makeComposite(final Prop...props ) {
        return new Prop() {

            @Override
            public void visit(final Actor a) {
                for (final Prop p : props) {
                    p.visit(a);
                }
            }
        };
    }

    public static class Prop1 implements Prop {
        public void visit(Actor a) {
            a.set(this);
        }
    }

    public static class Prop2 implements Prop {
        public void visit(Actor a) {
            a.set(this);
        }
    }
} 
```

这使您可以执行以下操作：

```
 ConcreteActor a = new ConcreteActor();
    Prop p = Actor.makeComposite(new ConcreteProp1(42), new ConcreteProp2(-5));
    a.setProp(p); 
```

...这是超级好！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:45:41.850

我不知道这是否有一个“正确”的答案，但这就是我会做的。

```
class Properties {
    prop1
    prop2
    prop3
}

interface PropertySetable {
     setProperties(Properties prop);
}
public class MyClassUsesProp2And3 implements PropertySetable {
    setProperties(Properties prop) {
       //I know I need only 2 and 3
       myProp2 = prop.prop2;
       myProp3 = prop.prop3;
    }

} 
```

在调用函数时，你不应该有演员表。

```
 someFunc(..., PropertySetable, Properties,...) {
      PropertySetable.setProperties(Properties); 
 } 
```

这就是基本结构。

您应该封装属性 - 将属性设为私有并具有相关的构造函数。或者使用 Builder 模式来构建属性......等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T21:41:31.850

我认为答案取决于您首先要重构代码的原因。

*   如果您想完全摆脱 switch 块，那么您必须使用一种方法实现一个接口，该方法采用三个参数。每个班级都必须弄清楚哪些论点适用以及如何处理这些论点。
*   如果您想减少代码总量，那么我不确定添加特定于类的属性设置逻辑是否比原始 switch 语句更少的代码
*   如果您想利用编辑器的代码完成功能来插入具有正确数量的属性/参数的正确方法，那么只需在每个类上实现正确的方法并完全避免接口

# java - 如何监听 JCombobox 选择事件

> ID：12080636
> 
> 赞同：3
> 
> 时间：2012-08-22T20:08:59.640
> 
> 标签：java, swing, event-handling, jcombobox, jpopup

当我选择`JCombobox`我想在它被选中并显示下拉列表时处理事件以及在下拉列表消失并且`JCombobox`取消选择时处理事件。

请注意，我不是在寻找项目选择更改，而是在用户选择`JCombobox`并且 UI 弹出下拉菜单时。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T20:12:09.000

您想使用[addPopupMenuListener](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComboBox.html#addPopupMenuListener%28javax.swing.event.PopupMenuListener%29)，它使用以下接口：

```
public interface PopupMenuListener extends EventListener {

    /**
     *  This method is called before the popup menu becomes visible 
     */
    void popupMenuWillBecomeVisible(PopupMenuEvent e);

    /**
     * This method is called before the popup menu becomes invisible
     * Note that a JPopupMenu can become invisible any time 
     */
    void popupMenuWillBecomeInvisible(PopupMenuEvent e);

    /**
     * This method is called when the popup menu is canceled
     */
    void popupMenuCanceled(PopupMenuEvent e);
} 
```

# jquery - iframe中的jquery数据访问

> ID：12080637
> 
> 赞同：2
> 
> 时间：2012-08-22T20:09:04.443
> 
> 标签：jquery, iframe, window, frame, kendo-ui

我有以下框架结构：

```
<frameset rows="*" frameborder="NO" framespacing="0" border="0">
<frame src="principal.aspx" id="main">
</ frameset> 
```

主体.aspx

```
<script>
var window = $ ("#window"). kendoWindow ({
         width: "50%"
         height: "50%"
         modal: true,
         visible: false,
         actions: ["Refresh", "Maximize", "Close"]
     }). date ("kendoWindow");
</ script>

<iframe SRC="URL" id="frmConteudo"> </ iframe>
<div id="window"> </ div> 
```

现在我有问题了。我在 frmConteudo 里面，想访问 div 窗口。我可以通过这种方式毫无问题地访问 div 窗口：

```
$ ("#window", frames["main"].document) 
```

不过需要访问。日期（“kendoWindow”）和以下两种形式一样无效：

```
var frame = frames["main"].document;
$ ("#window", frame).data("kendoWindow");
$ ("#window", frame).data(frame, "kendoWindow"); 
```

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:34:42.207

我设法解决了以下问题：

我在 principal.aspx 中添加了以下方法

```
<script>
         function GetWindow () {
             return $ ("#window") data ("kendoWindow");
         }
</ script> 
```

我从我的框架和使用这样的对象的方法中调用：

```
top.frames var frame = ["main"];
var window = frame.GetWindow (); 
```

遵循 pimvdb 的建议也很有效。

```
top.frames["main"].$("#window").data("kendoWindow"); 
```

# windows - windows批处理FOR循环查找文件夹

> ID：12080638
> 
> 赞同：3
> 
> 时间：2012-08-22T20:09:04.703
> 
> 标签：windows, batch-file

伪代码：

```
path = ".";
for(;;)
{
   if(exist(path + "/file.exe")
       break;
   path += "/..";
} 
```

基本上，我有一个脚本从一个文件夹运行，该文件夹比包含 file.exe 的文件夹深几级，我需要找到该文件夹​​的路径。

为了快速解决问题，我将其添加到我的 bat 文件中：

```
set PATH=..;..\..;..\..\..;..\..\..\..;%PATH% 
```

是否有适当的方法来迭代文件夹并检查其中是否存在文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T21:12:57.950

您可以使用“usebackq”关键字捕获 DOS 命令的输出，并将命令字符串括在 ` 字符中。然后，您可以使用带有裸输出 (/B) 和子目录搜索 (/S) 开关的 DOS dir 命令以及所需的文件名来生成该文件名的完全限定路径字符串。在此示例中，我在当前目录的 test/test2 中有 testFile.exe。

在 test.bat 中：

```
@FOR /F "usebackq" %%y in (`dir /s /b testFile.exe`) do @echo Filename: %%y 
```

我的输出：

```
Filename: C:\TEST_REMOVE\test\test2\testFile.exe 
```

希望能帮助到你！

_瑞安

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T22:42:55.697

我会尝试类似的东西

```
pushd
:loop
if exist file.exe goto :found
set lastdir=%cd%
cd ..
if "%cd%" EQU "%lastdir%" goto :notfound
goto :loop
:notfound
echo file.exe not found!
popd
goto :eof
:found
set file=%cd%\file.exe
popd 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:27:05.077

这是一个您可以查看的网站，它将为您提供有关如何以及从何处开始的示例

[如何创建批处理文件以读取目录中的所有文件](https://stackoverflow.com/questions/8385454/batch-files-list-all-files-in-a-directory-with-relative-paths)

我还建议做一个谷歌搜索——这就是我为获得这个链接所做的

# sql - 在sql数据库访问中插入多行查询

> ID：12080639
> 
> 赞同：0
> 
> 时间：2012-08-22T20:09:05.210
> 
> 标签：sql, vb.net, ms-access

我试图在数据库的列表视图中插入项目。如果我尝试单独插入每条记录，如果有更多记录（甚至超过 5 条），则需要很长时间。我目前正在使用此代码：

```
 For Each ls As ListViewItem In ListItems.Items
      strSQL = String.Format("insert into tbltrans (transid,itemcode,itemname,qty,price,[total],btw) values ('{0}','{1}','{2}',{3},{4},'{5}','{6}')", CStr(txtTransId.Text), CStr(ls.Tag), ls.SubItems(0).Text, CDbl(ls.SubItems(1).Text), CDbl(ls.SubItems(2).Text), CDbl(ls.SubItems(3).Text), ((ls.SubItems(5).Text)))
                objDal.ExecuteQuery(strSQL)
Next 
```

所以，我想做的是在一个 sql 查询中执行所有项目。我试过这个，但没有奏效：

```
 strSQL = "insert into tbltrans (transid,itemcode,itemname,qty,price,[total],btw) values  "
 For Each ls As ListViewItem In ListItems.Items
                    strSQL += tring.Format("('{0}','{1}','{2}','{3}','{4}','{5}','{6}')", CStr(txtTransId.Text), CStr(ls.Tag), ls.SubItems(0).Text, CDbl(ls.SubItems(1).Text), CDbl(ls.SubItems(2).Text), CDbl(ls.SubItems(3).Text), ((ls.SubItems(5).Text)))

                Next
objdal.executequery(strSQL) 
```

它说它在语句末尾缺少分号（;），我尝试将它们添加到记录中以及（strsql＆“;”），然后它给出了语法错误。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:28:53.890

您可以通过重新使用相同的命令/连接对象和*相同*（未重新构造）的 sql 字符串来做得更好（我不得不猜测列类型和长度）：

```
strSQL = "insert into tbltrans (transid,itemcode,itemname,qty,price,[total],btw) values ( ?,?,?,?,?,?,?)"

Using cn As New OleDbConnection("Connection string here"), _
      cmd As New OleDbCommand(strSQL, cn)

    cmd.Parameters.Add("?", OleDbType.Integer).Value = Integer.Parse(txtTransId.Text)
    cmd.Parameters.Add("?", OleDbType.VarChar, 10)
    cmd.Parameters.Add("?", OleDbType.VarChar, 50)
    cmd.Parameters.Add("?", OleDbType.Integer)
    cmd.Parameters.Add("?", OleDbType.Decimal)
    cmd.Parameters.Add("?", OleDbType.Decimal)
    cmd.Parameters.Add("?", OleDbType.VarChar, 50)

    cn.Open()
    For Each ls As ListViewItem In ListItems.Items
        cmd.Parameters(1).Value = ls.Tag
        cmd.Parameters(2).Value = ls.SubItems(0).Text
        cmd.Parameters(3).Value = Integer.Parse(ls.SubItems(1).Text)
        cmd.Parameters(4).Value = Decimal.Parse(ls.SubItems(2).Text)
        cmd.Parameters(5).Value = Decimal.Parse(ls.SubItems(3).Text)
        cmd.Parameters(6).Value = ls.SubItems(5).Text
        cmd.ExecuteNonQuery()
    Next ls

End Using 
```

# pthreads - PTHREAD_MUTEX_ROBUST 与 PTHREAD_MUTEX_ROBUST_NP

> ID：12080640
> 
> 赞同：4
> 
> 时间：2012-08-22T20:09:07.980
> 
> 标签：pthreads

我编写了一些代码（在 Linux 下运行）使用 pthread 健壮的互斥锁进行死锁恢复。

在 Centos 5 下，互斥属性名称是 PTHREAD_MUTEX_ROBUST_NP。但是在 Fedora 16 下，_NP 后缀已被删除。

Posix 标准不包括后缀。后缀是什么意思，什么时候被删除，以及使用任一功能命名来编译代码的正确方法是什么。

编辑：所以看起来在后面的 pthreads 中删除了后缀。但是，定义 _GNU_SOURCE 会重新定义 '_np' 版本，因此源代码可以在任一版本下编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T01:57:12.933

正如 cnicutar 已经建议的那样，_NP 代表不可移植，并由想要添加标准中没有（或尚未）的功能的实现附加。该标准将仅考虑包括在至少一个主要实现中实现并证明是有用的并且使用现有标准功能无法轻易实现的功能。

Fedora 通常使用比 RHEL（或 CentOS）更新的库版本，并且可能删除了 _np，因为强大的互斥锁和相关的 API 已被接受为标准。

# html - 用链接包裹的图像不起作用

> ID：12080645
> 
> 赞同：-2
> 
> 时间：2012-08-22T20:09:19.997
> 
> 标签：html

所以我试图使图像可点击。这是一件非常容易的事情，但由于某种原因，它似乎不起作用。它甚至不承认存在链接。

```
<ul>
    <li><a href="register"><img src="images/register.png"></a></li>
    <li><a href="login"><img src="images/login.png"/></a></li>
</ul> 
```

有什么我做错了吗？多谢你们。:)

我认为唯一引用它的css是：

```
A:link {text-decoration: none}
A:visited {text-decoration: none}
A:active {text-decoration: none}
A:hover {text-decoration: underline;color:#f60051}

#sidebar li {
   list-style: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:15:33.790

你确定那是你写的吗`<a href="register">`？`<a href="login">`

它们似乎不是有效的 URL。这可能是问题所在。

尝试`<a href="register.php">`或`<a href="login.php">`任何正确的 URL。

您还可以覆盖图像的默认 CSS Cursor 以使其成为[指针](http://www.w3schools.com/cssref/playit.asp?filename=playcss_cursor&preval=pointer)。由于可以继承光标样式，因此它可能正在获取先前样式声明的值，而这样的声明可能会解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:18:56.947

试试这个

```
<ul>
<li><a href="#register"><img src="images/register.png"></a></li>
<li><a href="#login"><img src="images/login.png"/></a></li>
</ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:19:14.410

首先，您可能希望更具体地了解前面提到的“不起作用”。我假设您的意思是链接不起作用？您可能需要指定您正在使用的浏览器和其他详细信息。

但是，我以前遇到过类似的问题，这也可能对您有所帮助。有时我会使用您的方法获得无法正常工作的随机链接，我最终开始将包含图像的链接更改为具有 onclick 事件的图像。这几乎总是有帮助。

```
<ul>
<li><img src="images/register.png" onclick="location.href='register'" style="cursor:pointer;"/></li>
<li><img src="images/login.png" onclick="location.href='login'" style="cursor:pointer;"/></li> 
```

onclick 只是一个链接，而 cursor:pointer 只是为了让它看起来像一个链接，当你将鼠标悬停在它上面时。希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T20:57:00.993

我在所有东西前面都有一个 div，所以它挡住了它。

# javascript - Passport.js：使用主干时访问用户

> ID：12080652
> 
> 赞同：5
> 
> 时间：2012-08-22T20:10:13.160
> 
> 标签：javascript, node.js, backbone.js, pug, passport.js

我在 node.js 应用程序中使用 passport.js 来使 OAuth 正常工作（太棒了！），但现在，我遇到了一件事。

我在客户端使用backbone.js来创建视图（我正在尝试创建一个SinglePage应用程序......），而我正在考虑在主干中获取用户ID或类似内容的唯一方法是创建首先是一个隐藏在jade模板中的输入，然后将其传递给我的主干视图中的构造函数....或者只是将值分配给一个javascript变量并将其传递给管理所有视图的路由器，然后将其传递给每个视图需要它

我认为这不是一个好主意，可能会有更好的选择！

你会怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:57:16.873

我还没有在 Backbone 中做任何事情，但是[这里](https://stackoverflow.com/questions/10160465/backbone-node-session-validation-my-method-working-but-tell-me-whether-it-is)、[这里](http://blog.opperator.com/post/15671431847/backbone-js-sessions-and-authentication)和[这里](https://stackoverflow.com/questions/5808655/backbone-js-handling-if-a-user-is-logged-in-or-not)已经有了解决方案。只要您在某处获得会话 ID，就可以使用[cookie](https://npmjs.org/package/cookie) -package 检索会话（cookie 已从 connect-utils 外包）：

```
if(handshakeData.headers.cookie) {
  c = cookie.parse(handshakeData.headers.cookie);
  sid = connect.utils.parseSignedCookie(c['connect.sid'], 'keyboard cat');
  redis.get('sess:'+sid, function(error, result) {
    session = JSON.parse(result);
    handshakeData.uid = session.passport.user;
    callback(null, true);
  }); 
```

# validation - Coldfusion中的cfscript电子邮件验证

> ID：12080654
> 
> 赞同：2
> 
> 时间：2012-08-22T20:10:22.550
> 
> 标签：validation, coldfusion, coldfusion-9

我试图让我的 cfscript 标记中的这段代码工作。我已经搜索和搜索，但没有任何东西可以验证电子邮件地址。

如果电子邮件地址为空，它将返回错误消息，但如果我只是输入字符，它将让它通过。

我对 CF 中的脚本编写非常陌生，因此将不胜感激。

```
if (isDefined("form.email"))
            {
                if (form.email is "")
                    {
                        errormessageemail = "Please enter a valid Email Address!";
                    }
                else if (not form.email is "")
                    {
                        email = form.email;
                        function validate_email(str,email) {
                        if( not len(trim(arguments.str)) or not refind("^[0-9A-Za-z.'+_-]+@([0-9A-Za-z-]+\.)+[A-Za-z]+$", trim(arguments.str)) ) {
                            errormessageemail = "Please enter a valid Email Address! Ex. abc@abc.com";
                            }
                        return errormessageemail;
                        }
                    }
            } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T20:15:53.287

它可以像这样简单：

```
if (StructKeyExists(form, "email") AND NOT isValid("email", form.email)) {
    errormessageemail = "Please enter a valid Email Address!";
} 
```

您不验证是否未发布电子邮件。空字符串不是有效的邮箱，不需要特别检查。

注意：有人可能会争辩说 isValid/email 不能 100% 正常工作。这是真的，但很少见的问题。如果您也这么认为，请使用正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:36:46.200

这是我用于检查电子邮件有效性的代码：

```
LOCAL.Email = trim(lCase(ARGUMENTS.Email));
LOCAL.IsValid = reFindNoCase("^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.(?:[A-Z]{2}|com|org|net|edu|gov|mil|biz|info|mobi|name|aero|asia|jobs|museum)$", LOCAL.Email); 
```

您应该使用 structKeyExists 来测试您的表单，而不是像其他受访者建议的那样使用 isDefined。structKeyExists 函数搜索变量的特定范围。isDefined 搜索任何范围。

```
if (StructKeyExists(form, "email") AND NOT isValid("email", form.email)) {
    errormessageemail = "Please enter a valid Email Address!";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-12T09:08:42.983

**只需在 CFM 中检查电子邮件有效性**

```
 <cfif  isValid("email", #Form.email#) >
    <cfoutput>Email Address is valid</cfoutput>
<cfelse>
   <cfoutput>Email Address is invalid</cfoutput>
</cfelse> 
```

# django - 如何在 Heilohost 上使用不同版本的 Django 部署 Django 站点

> ID：12080657
> 
> 赞同：0
> 
> 时间：2012-08-22T20:10:54.530
> 
> 标签：django, web-hosting

我为此苦苦挣扎了很长一段时间，所以我想我会对其进行问答，以免人们对相对论的简单解决方案感到头疼。

Heilohost 自带 Django 1.3，我可以安装我自己的版本（Django 1.4）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:10:54.530

**编辑：**
[扩展演练](http://www.thebrokendesk.com/post/deploying-a-django-site-to-heliohost/)

**上传您的网站**

在您的帐户根目录下的 public_html 目录中创建一个新子目录。将此子目录命名为与您的 Django 项目相同的名称。现在，通过 FTP 或 cPanel 文件管理器将您的 Django 项目上传到指定的子目录。为您的应用程序做同样的事情

它应该如下所示：

```
home/  
+ <user_name>  
    + public_html  
        - <project_name>  
            * __init__.py  
            * settings.py  
            * urls.py  
            * ...  
        - <app_name>  
            * __init__.py  
            * views.py  
            * models.py  
            * ...  
        - media
        - templates
        - static 
```

**运行 Django 1.4**

HelioHost 随 Django 1.3 一起安装，如果您在 1.4 中开发了所有内容，这可能会有点令人讨厌。幸运的是，这是一个很容易解决的问题。您需要使用 Filezilla 或其他工具来执行此操作。

[从https://www.djangoproject.com/download/1.4/tarball](https://www.djangoproject.com/download/1.4/tarball)下载 Django 源文件并解压缩。然后使用 filezilla 将目录传输`Django-1.4/django`到您的`public_html`文件夹 中

接下来，创建一个调度文件`(dispatch.wsgi)`来处理您的项目，并将其放入`/home/<user_name>/public_html/<project_name>`为了运行 1.4，您必须像这样设置它：

```
import os, sys

sys.path.insert(0,"/home/<user_name>/public_html")

os.environ['DJANGO_SETTINGS_MODULE'] = '<project_name>.settings'
os.environ['PYTHON_EGG_CACHE'] = '/home/<user_name>/.python_egg_cache'

from django.core.wsgi import get_wsgi_application
application = get_wsgi_application() 
```

“/home/<user_name>/public_html” 必须插入到您的系统路径的前面，以便您上传的 django 副本是使用的副本。

使其 CHMOD 权限为 755

按照 heilohost 概述的其余步骤操作，一切顺利

# python - 如何从内存中保存 webkit 页面图像资源？

> ID：12080662
> 
> 赞同：2
> 
> 时间：2012-08-22T20:11:53.320
> 
> 标签：python, webkit, gtk, pygtk

我用 python、gtk 和 webkit 打开页面。现在 - 如何从该页面保存图像而不从互联网再次下载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T04:50:14.620

这是一个将呈现的网页保存到图像的python程序：http: [//pastie.org/4572412](http://pastie.org/4572412)

这应该是您最感兴趣的部分：

```
 size = self.browser.mainFrame().contentsSize()
    if width > 0:
        size.setWidth(width)
    self.browser.setViewportSize(size)

    # Render the virtual browsers viewport to an image.
    image = QImage(self.browser.viewportSize(), QImage.Format_ARGB32)
    paint = QPainter(image) #Have the painters target be our image object
    self.browser.mainFrame().render(paint) #Render browser window to painter
    paint.end()
    image = image.scaledToWidth(width) #ensure the image is your desired width
    extension = os.path.splitext(filename)[1][1:].upper()  #save the file as your desired image extension
    if extension not in self.image_extensions:
        raise ValueError("'filename' must be a valid extension: {0}".format(self.image_extensions))
    image.save(filename, extension) 
```

希望这可以帮助！

# sage - 在 Sage 中创建图形

> ID：12080664
> 
> 赞同：1
> 
> 时间：2012-08-22T20:11:56.123
> 
> 标签：sage

我想在圣人中定义新图。令 V 为有限域 GF(q) 上的向量空间。图的顶点是来自 V 的 i 维子空间和来自 V 的 ni 维子空间，并且当且仅当两个子空间的直接和为 V 时，两个顶点是相邻的。

我无法在 sage 中定义此图。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:02:33.787

这应该让你开始：

```
sage: p = 5
sage: K = GF(p^2, 'a')
sage: V = K^4
sage: len(list(V.subspaces(1)))
16276
sage: len(list(V.subspaces(3)))
16276 
```

所以这个图会非常大：`16276 * 2 = 32552`顶点。让我们做一个更小的例子。然后你可以做类似的事情

```
sage: p = 3
sage: K = GF(p)
sage: V = K^4
sage: vertices = list(V.subspaces(1)) + list(V.subspaces(3))
sage: for X in vertices:
....:     L = []
....:     for Y in vertices:
....:         if X + Y == V:
....:             L.append(Y)
....:     d[X] = L
....:     
sage: Graph(d)
Graph on 80 vertices 
```

# ruby-on-rails - Rails 如何在一个视图中在同一个类上使用多个变量

> ID：12080666
> 
> 赞同：0
> 
> 时间：2012-08-22T20:12:04.430
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试在带有导轨的视图中使用同一类的多个实例。基本上我需要显示一个带有所有属性的分支，并且在同一页面中我有一个 form_for 需要一个空的分支对象。问题是当我在控制器“@newBranch”中创建空分支实例时，视图无法再访问第一个

这是我在控制器中所做的：

```
def show
  @customer = Customer.find(params[:id])
  @branches = @customer.branches
  @newBranch = @customer.branches.new          #this is for the form_for
  @newContact = @newBranch.build_contact       #this is for the fields_for    
end 
```

如果我尝试使用集合@branches 的单个项目，例如：

```
<div class = "branch_container">
  <%= render :partial => "customers/branch", :collection => @branches %>
</div> 
```

然后在分支部分内：

```
<%= branch.contact.name %> 
```

我有消息：

> “nil:NilClass 的未定义方法‘名称’”

所有模型关联都可以正常工作，如果我不实例化 @newBranch 和 @newContact，问题就会消失。

基本上我需要在同一个视图中使用同一类的两个实例（例如一个部分中的“@branches”和另一个部分中的“@newBranch”）。

有什么解决办法？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:18:14.540

将这些实例作为本地变量提供：

```
 <%= render :partial => "customers/branch", :collection => @branches, :locals => {:branch => @branch, :customer => @customer} %> 
```

哎呀，读得不好。对于一个新的分支，没有设置联系方式，所以为零。只需检查这种情况。

```
<% if branch.contact %>
_Your code_
<% else %>
No contact assigned
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T16:52:40.953

最后，我通过以下方式在表单内的视图中创建了@newBranch 和@newContact：

```
<%= form_for(newBranch = Building.new, :html => { :multipart => true }) do |building_form| %>
    <% newBranch.build_contact %>
    etc... etc... 
```

# facebook-javascript-sdk - Facebook js错误-调用FB.init时“'Array'未定义”

> ID：12080675
> 
> 赞同：0
> 
> 时间：2012-08-22T20:12:43.937
> 
> 标签：facebook-javascript-sdk

大约 50% 的时间，在调用 FB.init 时，我会收到以下 javascript 错误：

![在此处输入图像描述](../Images/683ef5a781e4f433ac2598cb637b7a47.png)

刷新页面有时可以解决问题。我无法辨别任何特定的模式。

有人认识这个代码吗？它是 facebook js sdk 的一部分吗？

我如何弄清楚出了什么问题？我在 Facebook 支持网站上查看了未解决的问题，但没有看到任何内容。

这是我直接来自 fb 文档的初始化代码：

```
<script>
    window.fbAsyncInit = function () {
        debugger;
        FB.init({
            appId: xxxx,
            status: true,
            cookie: true,
            xfbml: true
        });
    };

    // Load the SDK Asynchronously
    (function (d) {
        debugger;
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    }(document));
</script> 
```

# javascript - 计算自动生成的 div

> ID：12080676
> 
> 赞同：0
> 
> 时间：2012-08-22T20:12:50.387
> 
> 标签：javascript, jquery, html

所以我有这个代码：

```
<body>
<div id="pages"></div>
<script type="text/javascript">
$(function(){
        function createDiv(divclass,text) { 
                $('<div/>', {
                    class: 'page' + divclass,
                    html: '<p>' + text + '</p>'
                }).appendTo('#pages');
            } 
            for (var i = 1; i <= 4; i++){
                createDiv("",i);
            }
            var pagesdisplay = $('page').length;
            console.log(pagesdisplay);
        });
</script> 
```

输出是：

```
<div class="page">
     <p>1</p>
</div>
<div class="page">
     <p>2</p>
</div>
<div class="page">
     <p>3</p>
</div>
<div class="page"><p>4</p></div> 
```

当我查看控制台时，它显示为 0。如何计算由我的函数自动生成的 div？

**编辑：我可以在 for(pagedisplay++) 中增加 pagedisplay 但这不是我想要的。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-22T20:14:24.740

代替：

```
$('page').length; 
```

和：

```
$('.page').length; 
```

`.`使用[`class selector`](http://api.jquery.com/class-selector/). _ 否则`$('page')`就是在你的 DOM 中寻找一个`<page>`显然不存在的元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:15:22.397

有一个错字，你想让选择器说 $('.page')

# coffeescript - Coffeescript 在 1.1.1 和 1.3.3 之间呈现不同

> ID：12080680
> 
> 赞同：3
> 
> 时间：2012-08-22T20:12:56.863
> 
> 标签：coffeescript

## CoffeeScript 源码

```
return sprite: myFunc
  width: 79
  height: 66
throw:
  from: {}
  last: {} 
```

## 使用 CoffeeScript 1.1.1 编译

```
return {
  sprite: myFunc({
    width: 79,
    height: 66
  }),
  "throw": {
    from: {},
    last: {}
  }
}; 
```

## 使用 CoffeeScript 1.3.3 编译

```
return {
  sprite: myFunc({
    width: 79,
    height: 66
  })
};

({
  "throw": {
    from: {},
    last: {}
  }
}); 
```

这破坏了我的代码。我在版本之间的更改日志中什么也看不到。这是一个错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T21:00:52.857

我将其称为错误，但错误在 1.1.1 和您的代码中，取决于对模棱两可代码的特定解释。这个：

```
return sprite: myFunc
  width: 79
  height: 66
throw:
  from: {}
  last: {} 
```

对于应该在哪个块中可能有点模棱两可`throw`，但 1.3.3 解释是唯一对我有意义的解释：您的缩进与您的意图不符。

如果为了清楚起见我们添加一个函数包装器：

```
f = ->
  return sprite: myFunc
    width: 79
    height: 66
  throw:
    from: {}
    last: {} 
```

然后那里的一点点歧义就消失了，1.3.3的解释：

```
f = ->
  return { sprite: myFunc(width: 79, height: 66) }
  { throw: { from: {}, last: {} } } 
```

非常有意义，因为您的结构只是以下方面的变体：

```
f = ->
  return pancakes
  eggs 
```

仅仅因为大括号和括号以及不是可选的东西并不意味着它们是被禁止的。如果一段代码结构的意图一目了然，那么你应该用一些大括号和括号来强制结构，可能是这样的：

```
return { sprite: myFunc
  width: 79
  height: 66
throw:
  from: {}
  last: {}
} 
```

或更好（IMO）：

```
return {
  sprite: myFunc(
    width: 79
    height: 66
  )
  throw:
    from: {}
    last: {}
} 
```

不幸的是，您将不得不阅读**所有**CoffeeScript 并根据需要添加大括号。我希望你有一个非常好的测试套件。

* * *

有趣的是，如果你放弃`return`：

```
sprite: myFunc
  width: 79
  height: 66
throw:
  from: {}
  last: {} 
```

那么你最新得到这个解释：

```
{
  sprite: myFunc(...)
  throw:  { from: ... }
} 
```

这对我来说很有意义，因为它看起来像：

```
v =
  sprite: myFunc ...
  throw: ... 
```

您的显式引入了隐含`return`时不存在的上下文。`return`

# apache - .htaccess RewriteRule 重定向

> ID：12080681
> 
> 赞同：0
> 
> 时间：2012-08-22T20:13:13.477
> 
> 标签：apache, .htaccess

我需要帮助将这两个链接重定向到一个链接：

```
Link #1: http://www.domain.com/index.php?til=d_news&id_new=1
Link #2: http://www.domain.com/new_folder/?til=d_news&id_new=1 
```

需要重定向到：

```
http://www.domain.com/news/news.html 
```

我尝试使用此代码：

```
RewriteCond %{QUERY_STRING} ^til=d_news
RewriteRule ^(.*)$ http://%{HTTP_HOST}/news/news.html? [R=301,L] 
```

但它只重定向第一个链接而不是第二个链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:22:22.717

在文档根目录的 htaccess 文件中，添加：

```
 RewriteEngine On
 RewriteCond %{QUERY_STRING} ^til=d_news&id_new=1 
 RewriteRule ^index.php$ /news/news.html? [L,R=301]

 RewriteCond %{QUERY_STRING} ^til=d_news&id_new=1
 RewriteRule ^new_folder/?$ /news/news.html? [L,R=301] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:19:45.493

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{QUERY_STRING} ^til=d_news&id_new=1 [NC]
RewriteRule ^ /news/news.html? [R=301,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:20:08.753

在您的第二个链接中没有目标页面：

```
http://www.domain.com/new_folder/?til=d_news&id_new=1 
```

应该是这样的：

```
http://www.domain.com/new_folder/page.php?til=d_news&id_new=1 
```

# c# - 使用文本框调用 c#

> ID：12080684
> 
> 赞同：4
> 
> 时间：2012-08-22T20:13:25.243
> 
> 标签：c#, multithreading, visual-studio-2010, event-handling, serial-port

我的部分程序使用事件处理程序来接收串行端口的数据。这个想法是在接收到数据时将接收到的文本添加到文本框（rx）中。我以前没有这个问题，但有些东西已经改变了，我不知道是什么。所以现在我正在重新审视这个处理方式。

在我的 winform 表单加载期间，我做的最后一件事是

```
if (!serialPort1.IsOpen)
{
     serialPort1.Open();
     serialPort1.DataReceived += new SerialDataReceivedEventHandler(DataReceivedHandler);
} 
```

然后我有事件处理程序

```
private void DataReceivedHandler(object sender, SerialDataReceivedEventArgs e)
{
     string indata1 = serialPort1.ReadExisting();
    // rx.Text = " "; accidentally posted this. it was from trial and error.  
     rx.AppendText(Environment.NewLine + indata1);
} 
```

当我运行程序时，它停在`rx.AppendText(Environment.NewLine + indata1);`并给出错误

> invalidoperationexception 未处理：控制“从创建它的线程以外的线程访问。

从我能够阅读的内容来看，我需要使用`invoke`or `BeginInvoke`。

我以前从未遇到过附加文本的问题，所以现在我不明白为什么会出现问题。另外，从我一直在阅读的关于调用的内容来看，我只是不明白。

有人可以帮助我了解如何针对我的情况使用调用实例吗？或者也许向我展示另一种附加文本框的方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T20:19:47.577

通常，您看到的异常发生在您以调试模式运行时，如果您以发布模式运行应用程序，则不太可能看到该异常。

但是，正如您所阅读的，最好使用调用。像这样的东西：

```
 private delegate void RefreshTextBox();

    private void DataReceivedHandler(object sender, SerialDataReceivedEventArgs e) {
        //this event is raised in an event separate from UI thread, 
        //so InvokeRequired must be checked and Invoke called to update UI controls. 
        if (this.InvokeRequired) {
            RefreshTextBox d = new RefreshTextBox(RefreshTextBoxResults);
            Invoke(d);
        } else {
            RefreshTextBoxResults();
        }
    }

    private void RefreshTextBoxResults() {
        string indata1 = serialPort1.ReadExisting();
        rx.Text = " ";
        rx.AppendText(Environment.NewLine + indata1);
    } 
```

当你第一次看到这个调用的东西时，几乎不可能理解，但仔细看看并给它一些时间，它会很有意义。承诺。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-22T20:18:42.817

GUI 应用程序中的更新只能在 GUI 线程上完成。另一个尝试直接更新 GUI 组件的线程将导致您描述的错误或看似随机的行为。

&friends的作用`Invoke`是使辅助线程能够安全地将 GUI 更新转发到 GUI 线程，该线程随后将从队列中处理它们。

在您的情况下（假设此处为 WinForms）：

```
rx.BeginInvoke(
      (Action)(() =>
      {
          rx.AppendText(Environment.NewLine + indata1);
      })); 
```

`BeginInvoke`是异步的，所以调用它的线程在继续之前不会等待实际更新被处理，而`Invoke`它是同步的。

# c# - 将结构转换为 JSON

> ID：12080697
> 
> 赞同：9
> 
> 时间：2012-08-22T20:14:20.090
> 
> 标签：c#, json, struct

我有一个结构，我想将其转换为 JSON 并将其保存为本地文件。

我找不到任何解释如何将 C# 结构转换为 JSON 的来源。

我为此使用控制台应用程序，而不是 Web 服务/Web 等。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-22T20:16:32.060

[JavaScriptSerializer 类](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)

```
var serializer = new JavaScriptSerializer();
YourStruct myStruct = new YourStruct(x,y,z);
var json = serializer.Serialize(myStruct); 
```

[JSON.NET](http://json.codeplex.com/)

另一种替代 JSON.net，它不依赖于 System.Web.* 程序集：

```
YourStruct myStruct = new YourStruct(x,y,z);
var json = JsonConvert.SerializeObject(myStruct); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:21:18.940

我会推荐使用[JSon.net](http://james.newtonking.com/projects/json-net.aspx)。然后，您可以执行以下操作：

```
string json = JsonConvert.SerializeObject(myObj); // myObj is the struct you want to serialize
File.WriteAllText("Foo.json", json); //Write the text to Foo.json 
```

# php - Facebook 长期访问令牌过期：从不

> ID：12080698
> 
> 赞同：2
> 
> 时间：2012-08-22T20:14:22.300
> 
> 标签：php, facebook, facebook-graph-api

当我使用长期访问令牌时收到此错误。
`Uncaught OAuthException: An unknown error has occurred.`

奇怪的是，当我通过[Debug tool](https://developers.facebook.com/tools/debug/access_token)运行它时，我得到的长期令牌的过期日期是 never。而不是60天..

当我最初创建密钥时，它准备好 60 天，然后在某个时候切换到从不。

如果我使用短期密钥，一切正常，但一旦我将其转换为长期密钥，我就会得到错误。下面的长期代码。 `https://graph.facebook.com/oauth/access_token?
client_id=APP_ID& client_secret=APP_SECRET& grant_type=fb_exchange_token& fb_exchange_token=EXISTING_ACCESS_TOKEN`

有任何想法吗？谢谢

**更新**

我解决了我遇到的问题。（无关的东西）无论如何，我的密钥仍然显示它永不过期。我的理解是，您拥有访问密钥的最长期限是 60 天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T10:36:47.107

关于持续时间：

您是否通过 /accounts 连接获得了您的代币？

> 通过使用长期用户访问令牌，查询 [User ID]/accounts 端点现在将为用户管理的页面提供不会过期的页面访问令牌。这也适用于使用通过已弃用的 offline_access 权限获得的未过期用户访问令牌进行查询时。

[开发者.facebook](https://developers.facebook.com/roadmap/offline-access-removal/)

# svn - 无法使用 MAMP Pro 加载 Magento 站点

> ID：12080701
> 
> 赞同：1
> 
> 时间：2012-08-22T20:14:25.567
> 
> 标签：svn, magento, phpmyadmin, mamp

因此，我设法使用 Cornerstone (Mac SVN) 在本地检查了我的 Magento 站点存储库，通过终端命令行导入 PHPMyAdmin 的数据库，更改了核心配置表基本 url (www.mydomain.com 到 mydomain.localhost)，添加具有 app/etc/local 正确凭据的 local.xml（SVN 设置为忽略它）并在 MAMP 中添加了 mydomain.localhost。

不确定我是否忘记了任何事情，但是当我尝试调出 mydomain.localhost 或 mydomain.localhost/admin 时，我得到了一大堆错误。

我知道这是在黑暗中拍摄，但我想看看是否有人有任何想法，如果我错过了一步，或者是否有人以前遇到过这种情况。

错误的大清单：

[https://dl.dropbox.com/u/54760147/errors.txt](https://dl.dropbox.com/u/54760147/errors.txt)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:32:26.283

你没有一个很大的错误列表——你只有一个异常被抛出。最大的错误列表是一个调用堆栈，它向您显示导致错误的代码执行路径。

如果你跟随那个踪迹，你会发现这个

```
 [10] => Array
            (
                [file] => /Applications/MAMP/mydomain/trunk/app/code/local/RichardMason/Profile/sql/profile_setup/mysql4-upgrade-0.1.0-0.1.1.php
                [line] => 9
                [function] => run
                [class] => Mage_Core_Model_Resource_Setup
                [type] => ->
                [args] => Array
                    (
                        [0] => 

ALTER TABLE pm_profile
ADD `link` varchar(255) NOT NULL DEFAULT '' AFTER `content`;

                    )

            ) 
```

看起来您的`RichardMason_Profile`模块有一个设置资源脚本，它试图将列添加`link`到 table `pm_profile`。这解释了单个错误顶部的单个错误消息

```
 [message:protected] => SQLSTATE[42S21]: Column already exists: 1060 Duplicate column name 'link' 
```

至于**为什么**会发生这种情况——这很难说，而且涉及太多未知数。如果表已经有此列，则意味着此资源脚本可能已经运行，但由于某种原因您的数据库`core_resource`表不知道它（这就是它现在尝试运行的原因）

缺少更多上下文，我建议备份数据库，从该表中删除链接列，清除缓存并重新加载页面。这将使脚本不受阻碍地运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T20:36:19.587

看起来我做错了两件事，不确定哪个是罪魁祸首（或两者兼而有之）：

*   Local.xml 中有错误的加密密钥
*   核心配置基本网址末尾缺少斜杠，`http://mydomain.localhost`而不是`http://mydomain.localhost/`

# ruby - 在集合中查找某个元素并在 Ruby 中更改它

> ID：12080702
> 
> 赞同：0
> 
> 时间：2012-08-22T20:14:48.270
> 
> 标签：ruby, ruby-on-rails-3.2

我需要的是在集合中设置`quantity`某个`item`在`@cart.line_items`哪里`@cart.line_item.id == line_item_id`。我写了一个应该可以工作的代码，但我的直觉告诉我它会更简单。

```
def line_item_quantity(line_item_id, quantity)
    @cart.line_items.each {|item| item.quantity = quantity if (item.id == line_item_id)}
    respond_to do |format|
      format.js
    end
end 
```

那么，让这段代码变得更好的 Ruby 方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:32:14.630

我认为下面的代码应该可以工作，但是如果没有找到 line_item 会引发异常

```
@cart.line_items.find(line_item_id).quantity = quantity 
```

# sql - 最佳多关系表对象类型设计

> ID：12080703
> 
> 赞同：0
> 
> 时间：2012-08-22T20:14:53.510
> 
> 标签：sql, sql-server, tsql, foreign-keys

我有一个名为 Feed 的表。该表将跟踪用户创建的不同类型（照片、事件、状态等）的社交对象。现在我有 2 个设计选择。

## 选择 1：objectTypeId，objectId：

```
CREATE TABLE [dbo].[Feed](
[feedId] [int] IDENTITY(1,1) NOT NULL,
[objectTypeId] [int] NULL,
[objectId] [datetime] NOT NULL 
```

)

```
CREATE TABLE [dbo].[ObjectType](
[typeId] [int] IDENTITY(1,1) NOT NULL,
[name] [NVARCHAR] NULL 
```

)

然后对象类型将保存所有可能类型的列表。但我讨厌这种方法。原因是，我无法在数据库上强制执行参照完整性。

如果在其中一个表中删除了一个对象，则 Feed 中的 objectId 值指向一个不存在的对象。

另外，这里的 Join 语句是一团糟。您必须使用硬值对表格进行硬编码，例如 LEFT JOIN Events ON feed.objectTypeId=2 AND feed.objectId=Events.eventId 等...

## 选择 2：将 eventId NULL、photoId NULL、statusId NULL 或任何其他 objectTypeId 添加到 Feed Table

PRO：可以强制执行参照完整性。空列不会引起太多问题，因为它们什么都不存储。无需创建额外的对象类型表。

```
CREATE TABLE [dbo].[Feed](
[feedId] [int] IDENTITY(1,1) NOT NULL,
[eventId] [int] NULL,
[photoId] [int] NULL,
[statusId] [int] NULL,
) 
```

但这张表并没有真正感觉正常化。

那么，做我想做的事情并实现我的目标的最佳方法是什么。每次添加新对象类型时都无需更改架构的引用完整性。

## 更新：

忘了指出这些对象存在表...我有表

```
CREATE TABLE [Events]( 
```

eventId INT，其他 cols 只处理事件。)

```
CREATE TABLE [Photos]( 
```

photoId INT，其他只处理照片的cols）

```
CREATE TABLE [Status]( 
```

statusId INT，其他只处理状态的列）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:31:00.893

面对类似的问题，我选择为每种类型的对象创建一个单独的表。每个表将具有唯一标识，例如`PhotoId`，对于每一行。它还将具有适当的外部引用，例如 to `FeedId`。（如果可以共享对象，则可以添加链接表以允许对象位于多个位置。）这允许最大的灵活性将正确的数据保存在正确的位置，例如`Height`并且`Width`可能适用于照片。

触发器用于根据需要验证和协调更新。

视图可用于汇总数据。它们集中了表之间的连接并可以强制执行其他规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:20:50.383

选择 2 很糟糕，会导致噩梦。您必须为每种新类型的内容添加一个新列。

我不知道您为什么认为选择 1 需要复杂的连接。要检索所有事件，例如：

```
SELECT * FROM Feed where objectTypeID = 
    (SELECT objectTypeID from ObjectType WHERE name = 'Event') 
```

至于参照完整性：

> 如果在其中一个表中删除了一个对象，则 Feed 中的 objectId 值指向一个不存在的对象。

我不明白。如果 Feed 中的对象被删除，则没有悬空引用。如果删除了 ObjectType，您打算如何处理该类型的对象？

我假设您意识到 ObjectType 表很小，每种类型的对象只有一行...对吗？

**编辑添加：**

您提到的其他表每个都需要一`FeedID`列。您不应**将**对象 ID 放入`Feed`表中。（这假设每个对象只属于一个提要。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:27:39.770

如果 Feed 类型的数量较少，是否为每种 Feed 类型设置单独的表格不是更好吗？

下面可以分成每个自己的表。

1.  相片
2.  活动
3.  状态

# javascript - JavaScript 的 onmouseout 事件未按预期工作

> ID：12080708
> 
> 赞同：3
> 
> 时间：2012-08-22T20:15:25.760
> 
> 标签：javascript, html, jquery, jquery-events, onmouseout

`onmouseout`在动态创建的 HTML 元素中使用该事件时，我遇到了问题。

这是 HTML 代码：

```
<div id="imageWrapper">
    <img src="imageUrl" alt="">
</div> 
```

这是 JavaScript 代码的一部分（使用[jQuery 1.7.2](http://blog.jquery.com/2012/03/21/jquery-1-7-2-released/)）：

```
$('body').on('mouseout', 'div#imageWrapper', function () {
    alert("Test");
}); 
```

显然，我想要的是检测鼠标何时离开`div#imageWrapper`并显示警报消息。

它有效，但不像我预期的那样有效：

当鼠标离开时，`div#imageWrapper`它会显示警报，但是当`div`鼠标在元素内部越过`img`元素时，它也会显示它（好像该`img`元素是 的“外部部分” `div`）。奇怪的是，当鼠标离开图像时（但鼠标停留在 上`div`），它也会显示警报消息。

**底线：** JavaScript 将`div#imageWrapper`和其中的`img`元素视为两个不同`div#imageWrapper`的 s。

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:17:07.367

使用`mouseenter`and`mouseleave`代替：

```
$('body').on('mouseleave', 'div#imageWrapper', function () {
    alert("Test");
}); 
```

# utf-16 - c++ Windows UTF16 L 字符串常量

> ID：12080715
> 
> 赞同：0
> 
> 时间：2012-08-22T20:16:06.427
> 
> 标签：utf-16

在 C++ 中有以下语句

```
wstring tester = L"Работа Центра"; 
```

我们设置控制台输出

```
int res = _setmode( _fileno(stdout), _O_U16TEXT); 
```

然后我们尝试

```
wcout << "tester " << tester << endl << flush; 
```

然后我们进入控制台...

```
 tester D D°D±D_Ñ,D° D▌DµD½Ñ,Ñ?D° 
```

所以试图弄清楚这里发生了什么，而不是得到正确的输出。

这是代码页问题吗？

# sql-server - 每个应用程序用户的 SQL Server 登录

> ID：12080717
> 
> 赞同：0
> 
> 时间：2012-08-22T20:16:11.337
> 
> 标签：sql-server, crystal-reports

我正在寻找在 SQL Server 2008 中唯一标识应用程序用户的不同方法。

为这个问题提供一些背景知识：我使用的 ASP.NET 4 Web 应用程序使用 SQL Server 2008 数据库，从应用程序到数据库的所有连接都有一个 SQL Server 登录名和数据库用户。

我们正在使用 Crystal Reports 开发报告解决方案，用户可以通过该应用程序编写和执行他们自己的报告。水晶报表只能从视图返回数据。每个应用程序用户都将拥有自己唯一的服务器登录名。然后视图使用 SELECT SYSTEM_USER() 来查找登录用户并限制从视图返回的数据。

*   为每个应用程序用户创建不同的登录名和数据库用户是不好的做法吗？这意味着每个 DB 有超过 1000 个用户，跨越多达 80 个数据库（每个登录的创建将通过 T-SQL 处理，而不是手动处理）
*   在数据库中的视图中可以通过哪些其他方式识别用户？
*   我们查看了更改连接字符串以在 Workstation ID 中包含用户 ID，我们可以使用 SELECT HOST_NAME() 来获取 ID，但这似乎是对 Workstation ID 的滥用。

将不胜感激有关如何唯一标识用户的任何其他建议。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T07:47:17.827

我们提出了两种解决方案：

1.  在执行 Crystal 报表之前，在 .Net 中，我们可以提取报表（和子报表）将生成的 SQL，执行 SQL 并将结果放入数据集中并从数据集中生成报表。这样做的好处是，因为我们有 SQL，在 SQL 执行之前，我们可以向 SQL 服务器会话提供用户信息，这些信息可以用来在 SQL 执行时识别用户。

2.  拥有有限数量的 SQL Server 用户登录名，可以动态分配给应用程序用户。我们将有一个表，它将 SQL Server 登录映射到应用程序用户，就在他们运行 Crystal 报表之前。当他们查询完成执行时，登录被释放。显然，这意味着在繁忙时间我们可能会用完登录，但可以根据使用情况添加更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:22:01.817

您是否考虑过使用 Windows 身份验证来代替 SQL 身份验证？这至少会减少需要管理的登录和用户的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:27:11.810

当您使用 msql 2008 时，您可以使用外部数据库、文件或其他资源来存储用户对任何数据的访问。 [http://msdn.microsoft.com/en-us/library/dd392015%28v=sql.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd392015%28v=sql.100%29.aspx)

出于性能和安全原因，您可以更改为不将数据与审计元素混合。在您的 sql server 上使用 profiler，profiler 中包含有关（应用程序、用户和主机）的信息。因此，您可以通过审计或某些数据库对象的自定义触发器轻松获取此类信息。

您的应用程序还可以拥有自己的用户表并与所有用户共享相同的连接字符串，或者仅授予具有 Windows 身份验证类型的用户公共权限。并在存储过程中使用作为命令运行（在 db 中作为另一个用户运行）。因此，您可以登录任何用户并赋予他们最小的权限。

这是我在这里的第一篇文章，我实际上是在学习英语，哈哈。

# mysql - WHERE id IN(4) 与 WHERE id = 4 有何不同？

> ID：12080718
> 
> 赞同：0
> 
> 时间：2012-08-22T20:16:11.273
> 
> 标签：mysql, sql, query-optimization

> **可能重复：**
> [为什么 IN 条件会比 sql 中的“=”慢？](https://stackoverflow.com/questions/3417074/why-would-an-in-condition-be-slower-than-in-sql)

执行以下操作是否有任何性能差异：

```
SELECT foo FROM bar WHERE id IN (4) 
```

相对

```
SELECT foo FROM bar WHERE id = 4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:19:17.600

我相信 MySQL 优化器会将 id IN(4) 转换为 id = 4，所以没有性能差异

# android - 在 android 中处理与动态壁纸的草图集成

> ID：12080722
> 
> 赞同：0
> 
> 时间：2012-08-22T20:16:31.400
> 
> 标签：android, opengl-es, live, processing, wallpaper

是否可以将处理草图集成为 android 动态壁纸而不是 OpenGL 的一部分？我想与墙纸中的不同对象进行交互，因此对于我作为艺术家的我来说，处理会很容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T21:07:06.613

目前，没有。

请参阅处理论坛上的此讨论。

[https://forum.processing.org/topic/android-live-wallpaper](https://forum.processing.org/topic/android-live-wallpaper)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-25T19:18:01.490

处理编辑器的 Android 模式版本 4 包括动态壁纸功能。它仍处于测试阶段，但它是迄今为止我发现的最好的。你可以从这里下载它：[https](https://github.com/processing/processing-android/releases) ://github.com/processing/processing-android/releases 。

从[http://android.processing.org/install.html](http://android.processing.org/install.html)：

> 4.0 预发布版本对 Android 模式进行了多项改进，包括创建动态壁纸、表盘和 Cardboard 应用程序的新功能。您将在本网站的教程和参考页面中找到有关如何使用此功能的更多信息。要手动安装 4.0 预发行版，请转到 GitHub 发行版部分，查找与 Android 模式 0254 (4.0-beta1) 或更高版本对应的软件包，然后按照上一段中有关如何安装预发行版的说明进行操作释放。

# html - 双换行符合适吗？

> ID：12080725
> 
> 赞同：2
> 
> 时间：2012-08-22T20:16:38.670
> 
> 标签：html

跳过一行通常被认为是一种好习惯`<br /><br />`，还是应该使用另一种方法？在我看来，这似乎是一件令人不悦的事情，但我想不出替代方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T20:27:16.747

这通常被认为是不好的做法。尽管浏览器相当一致地实现`<br><br>`为创建一个空行，但实际上并不能保证这种行为；从逻辑上讲，这只是意味着两次断线。更重要的是，在实践中，您几乎无法设置样式，也几乎无法控制垂直间距的大小。因此，使用具有垂直边距的普通块元素效果更好。

[HTML5 草案在其对元素的](http://www.w3.org/TR/html5/the-br-element.html#the-br-element)[描述中`br`](http://www.w3.org/TR/html5/the-br-element.html#the-br-element)占据重要位置：“<code>br 元素必须仅用于实际上是内容一部分的换行符，例如在诗歌或地址中。”</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:21:00.697

`<p>`对于文本，将所有内容都包含在标签中可能是个好主意。这将使以后使用 css 更容易操作。

# c# - 了解 Rfc2898DeriveBytes 的工作原理

> ID：12080726
> 
> 赞同：1
> 
> 时间：2012-08-22T20:16:40.250
> 
> 标签：c#, encryption

我正在为我们数据库中的敏感数据编写一个加密序列。

目前我正在使用基于 UserId 的 GUID，并将其放入哈希中。然后，我通过 Rfc2898DeriveBytes 运行哈希以获取用于使用 Rijndael 函数加密数据的密钥和 IV。

我的代码如下所示：

```
 var salt = new byte[] { 1, 2, 23, 234, 37, 48, 134, 63, 248, 4 };
        const int iterations = 1000;
        using (var rfc2898DeriveBytes = new Rfc2898DeriveBytes(GenerateHash("2525"), salt, iterations)) {
            _key = rfc2898DeriveBytes.GetBytes(32);
            _iv = rfc2898DeriveBytes.GetBytes(16);
        } 
```

然后我传递 _key 和 _iv 来解密或加密数据。我的目标是让每个用户在每个会话中始终可以访问他们的唯一密钥。话虽如此，什么可以随机化并且仍然保持这个功能？我是否总是必须使用相同的盐和相同的 IV 来获取我想要的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T21:07:47.863

`Rfc2898DeriveBytes`是 PBKDF2 的实现。显然，RFC 2898 是对定义此基于密码的密钥派生函数[的标准的参考。](https://www.rfc-editor.org/rfc/rfc2898)请注意，该标准比 KDF 更广泛；它的全称是“PKCS #5: Password-Based Cryptography Specification, Version 2.0”。

PBKDF2 是定义 PBKDF / PBKDF1 的 PKCS#5 v1 的继承者。1 是在 PBKDF2 产生后才添加的。该类`PasswordDeriveBytes`是 PBKDF1 的实现。它不应该再使用了，因为 KDF 已经过时了，也因为微软严重搞砸了实现；如果请求超过底层哈希的输出 - SHA-1 所以 20 个字节 -它可能会*重复输出密钥材料。*

除了 KDF，PBKDF2 还用作密码散列函数，其中散列而不是密码存储在数据库中。这样可以验证密码，而如果数据被对手检索，则密码无法轻松检索。这在包含 2.1 版本协议的后续[RFC 8018中进行了描述。](https://www.rfc-editor.org/rfc/rfc8018)

在内部，PBKDF2 只是对密码和盐的哈希函数的重复。迭代次数是工作因子；它指定了在计算一个哈希值之前你（和对手）需要做多少工作。盐确保彩虹表攻击是不可能的，并且相同的密码（多个用户）不会导致相同的哈希。

由于设计错误，如果需要多个哈希输出，则需要重复全部工作，因此不建议从中请求比哈希函数的输出更多的数据。在这种情况下，最好使用另一种方法来扩展输出密钥材料（字节），例如 HKDF-Expand。

* * *

对问题中代码的观察：

1.  该`GenerateHash`方法是虚假的，`Rfc2898DeriveBytes`将为您执行此操作；
2.  您应该使用比 UID 更难预测的东西来创建密钥；数据不应直接提供给攻击者，因为这将*完全*违背 PBKDF2 的目的；
3.  如果您想使用同一组 UID + salt + 迭代进行多次加密，那么您应该生成一个随机 IV 并将其添加到密文中，非随机 IV 完全违背了 IV 的目的；
4.  您可以更改盐以获取多个密钥，但您必须通过 PBKDF2 函数进行每次加密。

只是一个一般提示，仅使用生成的密钥来加密由安全随机函数创建的数据特定密钥。然后，您甚至不需要担心 IV，您可以通过解密数据特定密钥并使用新密钥对其进行加密来“重新加密”。

# html - 段落标签旁边的表格未按预期显示在不同的行上

> ID：12080735
> 
> 赞同：0
> 
> 时间：2012-08-22T20:17:29.720
> 
> 标签：html, internet-explorer, html-table, internet-explorer-9, paragraph

以下显示的每个段落标签和表格在 IE9 中的各自行中完全符合我的要求。

在 IE9 兼容模式下，最后两个`<P>`标签在表格上运行，就好像故事在浮动一样。

为什么？以及如何让它停止？

**编辑**

补充一点，IE 9 兼容模式 = “IE 9 兼容模式，IE 7 标准”。它在 IE 8 标准中显示得很好。

```
<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"     \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">
<HTML>
<BODY>
<DIV >
<P>a</P>  
<P>b</P>  
<TABLE style="WIDTH: 500px; float : none;" border="1" cellSpacing="1" cellPadding="1"     align="left">  
<TBODY>  
<TR>  <TD>1</TD>  <TD>2</TD>  <TD>3</TD>  <TD>4</TD></TR>  
<TR>  <TD>5</TD>  <TD>6</TD>  <TD>7</TD>  <TD>8</TD></TR>
</TBODY>
</TABLE>  
<P >c</P>  
<P >d</P>
</DIV>
</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:31:44.293

我已经查看了 IE7 - IE9 以及其他浏览器中的代码，并且它在所有浏览器中都正确呈现。

`float:none`如果我从表格样式中删除，我能够复制您的问题。

一旦我有重复的问题，`align=left`从您的 TABLE 标签中删除即可修复它。

最好的，

辛西娅

# java - WhitespaceTokenizer生成的TokenStream中的最后一项如何做特殊处理

> ID：12080739
> 
> 赞同：0
> 
> 时间：2012-08-22T20:17:50.863
> 
> 标签：java, lucene

我的用例 - 如果罗马数字出现在 TokenStream 的最后，则将其转换为英文数字。否则就让它过去吧。

前任。“第三件事”>>>“第三件事”。但是“III 东西”>>>“III 东西”（仍然与 III 没有最后出现相同）

我究竟如何使这个逻辑在 Lucene 中起作用？

ps input.incrementToken() 似乎首先返回 true，然后为 WhitespaceTokenizer 生成的 TokenStream 中的每个术语返回 false。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:32:50.363

是否有可能有更多的细节？一段代码？

我想你已经看过这个了：

[http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/TokenStream.html](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/TokenStream.html)

说：

“消费者（即IndexWriter）使用此方法将流推进到下一个令牌”

您的 incrementToken 第二次返回 false 是正常的，因为接下来您没有任何空间。

您必须使用 end() 循环才能知道字符串何时完成（请原谅我的法语，我不知道如何编写它）。

# php - SQL PDO 使用 3 个参数计算行数

> ID：12080743
> 
> 赞同：0
> 
> 时间：2012-08-22T20:18:12.630
> 
> 标签：php, sql, pdo

我有以下代码：

```
 public static function check($ip,$op,$page)
 {
$con = new PDO(DBN,DB_USER,DB_PASS);
$sql = "SELECT COUNT(*) FROM ips WHERE ip=:ip";
$st = $con->prepare($sql);

$st->bindValue(":ip",$ip,PDO::PARAM_STR);

$st->execute();

$counter = $st->fetchColumn();

 $con  = null;
 return $counter;

  } 
```

$counter 显示正确的行数，但如果我添加

```
 $st->bindValue(":op",$op,PDO::PARAM_INT);
       $st->bindValue(":page",$page,PDO::PARAM_INT); 
```

$counter 出现 boolean false; 我仔细检查了我的数据库，但一切都很好。我尝试添加其中一个和另一个，但问题仍然存在；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:25:40.157

您可以激活 PDO 调试并查看您的查询是否有问题：

```
$con->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

# sql - 文本框的值基于使用查询的组合框值

> ID：12080747
> 
> 赞同：1
> 
> 时间：2012-08-22T20:18:28.560
> 
> 标签：sql, vba, ms-access, ms-access-2007

我有一个表单，上面有几个组合框和文本框。一个组合框值（用于 Wells）将被独立填充，然后我需要文本框的值基于 wells 组合框值的值。我创建了一个部分解决了问题的查询，它需要井组合框值的参数。如果我从表单中查询一个部分，它工作得很好并要求参数并且没问题。我确实认为使用 VBA，添加一个处理 SELECT 语句（上述查询的）的代码，然后告诉它从将在表单上准备好的 wells 组合值中获取其参数。

有人可以帮忙吗。这可以像我描述的那样工作吗？

提前致谢。

穆罕默德

除了我上面的问题，我尝试了以下解决方案：

```
Private Sub Well_ID_Change() 
Last_Ref.ControlSource = " SELECT TOP1 New_Ref FROM" & _ 
" BSW_Transactions WHERE BSW_Transactions.New_Ref Is Not Null AND BSW_Transactions.Well_ID = " & Me.Well_ID.Value & _ 
" ORDER BY BSW_Transactions.Sample_Date DESC" 
End Sub 
```

Last_Ref 是我想用代码中嵌入的 SELECT 语句的结果填充的文本框。Well_ID 是组合框，其值将成为 SELECT 语句的参数。Well_ID 是数字字段，它显示 well_name 并将关联的 ID 值存储在表中。保存更改后运行表单时，Last_Ref 文本框显示 (#Name?)。我猜测文本框（是一个数字字段）在组合框 Well_ID 中找到了一个文本，所以我在条件 Me.Well_ID 处将“.Value”添加到上述语法中。然而问题依然存在。

我可能在语法上弄错了，有人会帮忙吗？这可以正常工作吗？

提前致谢。穆罕默德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:58:18.107

问题是文本框不能像组合框或列表框那样设置它们的控制源，它需要传递值，例如：

```
Private Sub Well_ID_Change()

Dim rs As Recordset    

Set rs = CurrentDb.OpenRecordset("SELECT TOP1 [New_Ref] FROM" & _
" [BSW_Transactions] WHERE [BSW_Transactions].[New_Ref] Is Not Null" & _
" AND [BSW_Transactions].[Well_ID] = " & Me.Well_ID & _
" ORDER BY [BSW_Transactions].[Sample_Date] DESC", dbOpenSnapShot)

rs.MoveFirst
Last_Ref = rs![New_Ref]
rs.Close
Set rs = Nothing

End Sub 
```

我还从您的组合框中再次删除了 .Value ，因为它不是必需的

# c# - 使用代码从 Internet 下载内容

> ID：12080748
> 
> 赞同：0
> 
> 时间：2012-08-22T20:18:31.087
> 
> 标签：c#, automation, webserver, webclient

我每天都必须从网站下载一些内容，所以我认为有一个可以做到这一点的程序会很好......问题是该网站需要身份验证。

我目前的解决方案是使用`System.Windows.Forms.WebBrowser`控制。我目前正在做类似的事情：

```
/* Create browser */
System.Windows.Forms.WebBrowser browser = new System.Windows.Forms.WebBrowser();

/* navigate to desired site */ 
browser.Navigate("http://stackoverflow.com/");

// wait for browser to download dom

/* Get all tags of type input */
var elements = browser.Document.Body.GetElementsByTagName("input");

/* let's look for the one we are interested */
foreach (System.Windows.Forms.HtmlElement curInput in elements)
{
       if (curInput.GetAttribute("name") == "q") // 
       {
             curInput.SetAttribute("value", "I changed the value of this input");
             break;
       }
}

// etc 
```

我认为这种方法有效，但不是最好的解决方案。我尝试使用 webclient 类，这似乎有效，但由于某种原因它不起作用。我相信它不起作用的原因是因为我必须保存 cookie？

**所以我的问题是**我如何能够跟踪发送到服务器的所有字节以及所有响应的字节以下载我需要的内容。换句话说，我希望让 webclient 充当 webbrowser，一旦我通过查看源代码来达到我需要的部分，我应该能够解析我需要的数据。

如果有人可以向我展示如何执行此操作的示例，我将不胜感激。谷歌浏览器在显示大量信息方面做得很好： ![在此处输入图像描述](../Images/71247a02d12f3807b700f458deabec67.png)

提前致谢，

安东尼奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:32:41.267

回答你的问题：

1.  我所知道的跟踪流量的最佳实用程序是[Fiddler](http://www.fiddler2.com/)（它是免费的）。
2.  对于发送高级 HTTP 请求，您应该使用 class `System.Net.HttpWebRequest`，它也具有 property[`CookieContainer`](http://msdn.microsoft.com/en-us/library/x86a1s60%28v=vs.100%29.aspx)和`Headers`，允许您做任何您想做的事情。

希望能帮助到你。

# php - PHP PDO Prepared Statement MySQL Count of Select where X LIKE

> ID：12080750
> 
> 赞同：3
> 
> 时间：2012-08-22T20:18:42.583
> 
> 标签：php, mysql, pdo, prepared-statement

使用 PHP v. 5.2.14 和 PDO-MySQL 扩展。

我是准备好的陈述的新手。需要创建一个搜索表单（以便用户输入）和一个“选择所有 X 其中 X 喜欢...”品种的工作查询。

代码和结果：

```
$sql = 'SELECT COUNT(*) as num_books from t_books where title LIKE :search_term';
// Later access as num_books
$prep = $dbh->prepare($sql);
$num = $prep->execute(array(':search_term' => '%'.$search_term. '%'));
$total=$num->fetchColumn(); 
```

$prep 的 var 转储：object(PDOStatement)#2 (1) { ["queryString"]=> string(58) "SELECT COUNT(*) from t_books where title LIKE :search_term" }

致命错误：**在非对象上调用成员函数 fetchColumn()**

如果 $prep 是一个对象，那么 $num 应该是一个对象。但它是布尔值（真）。这里发生了什么？

但更重要的是，我该如何计数？

[我用 PDO](https://stackoverflow.com/questions/883365/count-with-pdo)阅读了行数-。那里的建议对我不起作用，因为我需要准备好的声明。会有用户输入。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:30:48.367

[`PDOStatement::execute()`](http://php.net/manual/en/pdostatement.execute.php)仅返回一个指示成功或失败的布尔值，因此您的变量`$num`不是您想要从中获取的。通过将结果分配给`$num`，您并没有分配对象`$prep`，而只是将方法调用的返回值分配给`execute()`( `TRUE`)。

相反，[`fetchColumn()`](http://www.php.net/manual/en/pdostatement.fetchcolumn.php)从`$prep`您的 PDOStatement 对象。

```
$num = $prep->execute(array(':search_term' => '%'.$search_term. '%'));
if ($num) {
  $total = $prep->fetchColumn();
} 
```

除此之外，您的 SQL 应该正确执行，并且它返回的一列应该包含您需要的计数。

在这种情况下（特别是因为您在`fetchColumn()`没有参数的情况下调用）并不重要，但对于未来的读者，建议`COUNT()`使用别名来命名聚合，然后可以在关联或对象获取中使用：

```
$sql = 'SELECT COUNT(*) AS num_books from t_books where title LIKE :search_term';
// Later access as num_books 
```

# ios - “dyld: Symbol not found:” 用于静态库中的 iOS 6 专有类

> ID：12080751
> 
> 赞同：3
> 
> 时间：2012-08-22T20:18:45.990
> 
> 标签：ios, xcode, linker, ios-simulator, static-linking

注意：是的，我知道 iOS 6 处于保密协议之下。这个问题与 iOS 6 无关，因为我引用的类在 iOS 6 中是*新的。*

我正在创建一个用于我的几个项目的静态框架，它允许我在 iOS 6 中使用新的 API（如果可用），如果不可用，它将回退到 iOS 5 等效项。然而，虽然我确保在使用它之前总是检查一个类是否有效，如下所示：

```
if ([NewClass class]) {
    NewClass *newClass = [[NewClass alloc] init];
    // etc.
} 
```

每当我在 iOS 5 模拟器中启动我的应用程序时，我都会收到以下错误：

```
dyld: Symbol not found: _OBJC_CLASS_$_NewClass 
```

（其中 NewClass 代表 iOS 6 类）。

这似乎只是使用静态库的问题，就好像我在我的项目中包含直接引用 API 的某些文件并引用它们一样，它将毫无问题地启动。我什至尝试过弱链接静态库，但它仍然崩溃。唯一可行的选择是弱链接 UIKit，但我宁愿不必这样做，因为 UIKit 是一个相当大的框架，并且弱链接需要额外的时间。

所以基本上，我能做些什么来弱链接静态库本身中的这个类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T15:59:25.520

我猜你的 IPHONEOS_DEPLOYMENT_TARGET 没有设置为 iOS 5？我只是遇到了同样的错误，因为它已经在 iOS 6 上。将其设置为 iOS 5 后，一切都很好。

您可以在 Target->BuildSettings->IPHONEOS_DEPLOYMENT_TARGET 和 Target->Summary->iOS Application Target 下找到配置。

避免这种错误的另一种方法是：

```
Class myClass = NSClassFromString(@"NewClass")
if( myClass ) {
   NSObject *myResult = [myClass aMethod:@"Hello World"];
} 
```

# emacs - 如何在 Emacs org-mode 中创建指向外部文件行的链接

> ID：12080752
> 
> 赞同：18
> 
> 时间：2012-08-22T20:18:46.140
> 
> 标签：emacs, org-mode

我有 2 个文件：

1.  带有代码的php文件
2.  带有文档的 org 文件

如何从 org 文件创建指向 php 文件中一行的链接？所以点击它会将光标移动到 php 文件中的相应行。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-22T20:26:18.837

在 org 模式下使用此表示法创建链接：

```
[[/path/to/file.php::line][string-to-display]] 
```

如果要显示文件名，只需使用

```
[[/path/to/file.php::line]] 
```

有关详细信息和其他指定链接的方法，请参阅 Org 模式信息页面中的超链接*[。](http://orgmode.org/manual/Hyperlinks.html "*超链接*")*

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-05-30T12:31:47.003

如果我理解正确的问题，您可以使用两个 org-mode 命令自动完成：

将点移动到 php 文件中的一行，然后`M-x org-store-link`.

转到一个 org 文件，`C-c C-l`或者`M-x org-insert-link`按照 minibuffer 中的说明进行操作。

完成后，单击链接或`C-c C-o`当点在其上时打开链接。

我有`org-store-link`on`C-c l`和`org-insert-link`on default `C-c C-l`。这使得该过程非常方便和快速地执行。

享受 org 模式的乐趣。

# google-app-engine - 检查是否仍需要 blob

> ID：12080753
> 
> 赞同：0
> 
> 时间：2012-08-22T20:18:48.070
> 
> 标签：google-app-engine

我有一个为不同用户存储文件的站点，用户可以根据需要添加和删除文件。在数据存储上的用户对象中，我将为其文件提供一组 blobstore 键。

如果我想定期检查以确保我的所有 blob 仍然由存储在其中一个 User 对象中的键指向，是否有一种简单的方法可以做到这一点，而不是对每个 blobstore 键的用户进行查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T22:06:52.667

除了自己手动之外没有办法做到这一点。

如果您有一个非常大的数据集，您可能可以编写一个 mapreduce，否则您应该在应用程序逻辑中不再需要 blob 时进行维护。

# php - 使用简单的 html Dom 抓取网站时的神秘结果

> ID：12080754
> 
> 赞同：0
> 
> 时间：2012-08-22T20:18:49.197
> 
> 标签：php, simple-html-dom, web-crawler

我正在尝试使用简单的 html dom 从 politifact 收集一些数据，但是很多时候我遇到了奇怪的错误，而不是预期的 html。目标不是暴力破解站点，而是每天请求一次或两次并缓存结果。我在这里得到的大部分回报：

```
‹������í]{wÛ6²ÿ»=g¿ªn#»1EËJœÄ–µ×vœ&ÙÄñÚn²{r{|(  ’S$Ã‡euÛï~3à¤¨‡c'ÛísNÄ`f0˜Úß=}sxþ¯“#1ŠÆŽ8ùùàÕ‹CQ3Ló]ëÐ4Ÿž?ÿ|~þú•h66Åy`¹¡Ùžk9¦yt\µQù;¦9™L“... 
```

这是超级简单的代码：

```
$html = file_get_html('http://www.politifact.com/personalities/barack-obama');
print_r($html->plaintext); 
```

你有什么想法为什么？网站方面的某种保护/重定向？

非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:45:03.470

您收到了预期的页面，但采用 gzip 格式。看起来服务器不介意`accept-encoding`请求中不包含标头，而不是发送默认的纯文本响应，而是发送压缩数据。

我不认为 simple-html-dom 可以解压缩数据，但您可以为此目的使用 cURL：

```
$ch = curl_init('http://www.politifact.com/personalities/barack-obama/');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_ENCODING, 'gzip');

$data = curl_exec($ch);

$html = str_get_html($data); 
```

# backbone.js - Backbone RequireJS 和 delegateEvents

> ID：12080756
> 
> 赞同：2
> 
> 时间：2012-08-22T20:18:52.037
> 
> 标签：backbone.js

在我的路由器中，我需要这样的视图：

```
require(['views/business-detail-view'],
    function(BusinessDetailView) {
        var businessDetailView = new BusinessDetailView({collection:                        businessOverviewCollection.models[id], id: id});
        businessDetailView.render();
    }
); 
```

在视图中，我正在绑定这样的事件：

```
events: {
        'click #about-btn'   : 'aboutHandler',
        'click #contact-btn' : 'contactHandler',
        'click #deals-btn'   : 'dealsHandler',
        'click #map-btn'     : 'mapHandler'
}, 
```

现在的问题是，如果第一次渲染视图，则调用回调。但是，如果视图需要在其他地方再次呈现，则回调会被调用两次，依此类推。

我怎样才能防止这种情况，或者我做错了什么？

更新：

与此同时，我已将路由器中的代码更改为：

```
if ( !businessDetailView ) {
    require(['views/business-detail-view'],
        function(BusinessDetailView) {
            businessDetailView = new BusinessDetailView({collection: businessOverviewCollection.models[id]});
            businessDetailView.render(); 
        }
    );
}
else {
    businessDetailView.collection = businessOverviewCollection.models[id];
    businessDetailView.render(); 
} 
```

这似乎解决了这个问题，但我仍然是新手，知道这是否是一个有效的模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:41:35.727

在您的观点中，您可能会清除页面上现有的 HTML 并将其替换为新的 HTML。当您清除旧的 HTML 时，您还应该清除旧的事件处理程序，这样它们就不会被闲置。例如，在您想要呈现 newHtml 时，您可以执行以下操作：

```
@$el.off().html(newHtml) 
```

# ruby-on-rails - 将使用 mini_magick（在内存中）修改的图像上传到 Amazon S3

> ID：12080760
> 
> 赞同：0
> 
> 时间：2012-08-22T20:19:00.827
> 
> 标签：ruby-on-rails, ruby-on-rails-3, amazon-s3

我需要能够将图像存储到 S3 而不将其写入临时文件。我的应用程序将部署到具有只读文件系统的 heroku。有没有办法将图像从内存直接保存到 S3？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T21:23:06.883

去吧：

```
 AWS::S3::S3Object.store('image_name.png',  image.to_blob, 'bucket_name') 
```

# php - 根据数据库内容生成产品列表

> ID：12080761
> 
> 赞同：0
> 
> 时间：2012-08-22T20:19:04.197
> 
> 标签：php, mysql, list, nested-loops

我创建了一个数据库，其中包含每个产品系列的一个表，基本上我试图在第一行是 table_name 的列表中列出所有不同的模型（每个表中的表行）。为什么这不起作用？

```
 $result = mysql_query("SELECT DISTINCT TABLE_NAME FROM 
                           INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME 
                           IN ('id') AND TABLE_SCHEMA='products-ropox'");
    while($row = mysql_fetch_array($result))
    {
        $serie = $row["TABLE_NAME"];
        echo "<ul>";
        echo "<li class='ldd_heading'><a class='link'
              href='products.php?category=".$serie."'>"
              .ucfirst($serie)."</a></li>";
        $query = mysql_query("SELECT DISTINCT model FROM $serie 
                              ORDER by model ASC");
        while($row = mysql_fetch_array($query))
        {
            echo "<li><a href='products.php?category=".$serie.
            "&model=".$row['model']."'>".$row['model']."</a></li>";
        }
        echo "</ul>";
    } 
```

第一个循环运行良好，但第二个查询会产生错误......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:22:44.487

重命名第二个`$row`，你`mysql_fetch_assoc`不需要`mysql_fetch_array`。如果你想使用`mysql_fetch_array`，你需要使用`$row[0]`

```
$result = mysql_query("SELECT DISTINCT TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME IN ('id') AND TABLE_SCHEMA='products-ropox'");
while($row = mysql_fetch_array($result))
{
    $serie = $row["TABLE_NAME"];
    echo "<ul>";
        echo "<li class='ldd_heading'><a class='link' href='products.php?category=".$serie."'>".ucfirst($serie)."</a></li>";
            $query = mysql_query("SELECT DISTINCT model FROM $serie ORDER by model ASC");
            while($row2 = mysql_fetch_array($query))
            {
                echo "<li><a href='products.php?category=".$serie."&model=".$row2['model']."'>".$row2['model']."</a></li>";
            }
    echo "</ul>";
} 
```

如果您的查询中有一个错误，那么一个好的做法是`or die(mysql_error())`在查询后粘贴一个错误以输出错误。

# drupal - CSS3 媒体查询延迟触发

> ID：12080768
> 
> 赞同：0
> 
> 时间：2012-08-22T20:19:28.527
> 
> 标签：drupal, responsive-design

我正在处理的 Drupal 站点中有一组简单的媒体查询。媒体查询正在触发，但是，每个都延迟触发像素（“最大宽度：1075 像素”在 977 像素处应用，“最大宽度：797 像素”在 724 像素处应用，这两个示例中的比例约为 90.8%）。

注意：以下代码示例是用 SASS 编写的。

```
@media screen and (max-width: 1075px)
@media screen and (max-width: 797px) 
```

它发生在 OS X 10.7.4 (Lion) 上运行的 Chrome 21.0.x、Firefox 14.0.1 和 Safari 6.0 上。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T12:45:47.907

尝试：

```
@media only screen and (max-width:1075px)
{
} 
```

并确保您有正确的元标记设置：

```
<meta name="viewport" content="width=device-width"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-25T18:59:14.190

我在 Internet Explorer 11 及更低版本上遇到了这个问题。我知道这不是最初帖子中受影响的浏览器之一，但这似乎是关于“媒体查询触发延迟”这个问题的唯一问题。我想为遇到同样问题的其他人分享我的解决方案。

看来您需要在 css 中使用以下行规范化视口：

```
@-ms-viewport { width: device-width; } 
```

我能够在这里找到解决方案：

[http://blog.adrianroselli.com/2013/05/ie10-metro-and-media-queries.html](http://blog.adrianroselli.com/2013/05/ie10-metro-and-media-queries.html)

# php - jQuery Post 什么都不返回

> ID：12080771
> 
> 赞同：0
> 
> 时间：2012-08-22T20:19:45.533
> 
> 标签：php, jquery

我创建了一个简单的 jQuery 帖子，每次用户在输入字段中输入字符时都会返回数据。问题是它不起作用。Firebug 不返回任何错误。当我输入关键字时，FireBug Net 显示没有发出任何请求。我的代码几乎是从另一段有效的代码中剪切和粘贴的。我不知道该怎么办，这不是第一次发生这样的事情。

这是原始文件。

```
<input type="text" id="search_tags" />

<div id="tag_results"></div>

  <script type="text/javascript" >

  $(document).ready(function() {

  $('#search_tags').keyup(function() {
    var search_term = $(this).val();
$.post('ajax_file.php', {search_term: search_term}, function (data) {
$('#tag_results').html(data);       
    });     
});

  $('#search_tags').bind('keydown', function(e) {
    if(e.keyCode==13){
    e.preventDefault();
    };});  
    });

  </script> 
```

这是ajax文件。

```
$search_term = sanitize($_POST['search_term']); 

    if (!empty($search_term)) {

$search = mysql_query("SELECT DISTINCT `tag_name` FROM `tags` WHERE `tag_name` LIKE 

    '%$search_term%' LIMIT 0, 15");

$y = 1;

         while ($results_row = mysql_fetch_assoc($search)) 

        {

        echo '<br><br>' . $results_row['tag_name'] . '<br><br><hr>'; 

                    $y++;

             }} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:21:28.510

好：

```
$('#search_tags_').keyup(... 
```

应该：

```
$('#search_tags').keyup(... 
```

`id="search_tags_"`因为我在您的示例中看不到具有以下内容的元素：

```
<input type="text" id="search_tags" /> 
```

# grails - 这在 grails 2.1.0 中仍然允许吗？

> ID：12080774
> 
> 赞同：0
> 
> 时间：2012-08-22T20:19:51.000
> 
> 标签：grails

他在 grails 2.1.0 中仍然允许这样做，因为它似乎没有保存到数据库中。

```
 def post = new Post()
            post.message = params.message
            post.author = User.get(springSecurityService.principal.id)
            post.save() 
```

还有一种方法可以检查它是否已保存？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T22:10:29.507

1.  始终检查保存结果：

    ```
    if (!post.save(flush: true)) {
        log.error(post.errors)
    } 
    ```

2.  使用`springSecurityService.currentUser`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-22T21:19:02.097

这看起来有效。在不知道您的限制和领域的情况下，很难说更多。

`save()`您可以通过 with确认通话`failOnError: true`，如`post.save(failOnError: true)`

# php - 变量的if条件问题

> ID：12080776
> 
> 赞同：0
> 
> 时间：2012-08-22T20:19:57.310
> 
> 标签：php

我的存储过程中有两个参数，即@startdate 和@enddate。用户从文本框中选择开始日期，也从文本框中选择结束日期。然后点击提交。

我想确保如果用户将两个框都留空，它应该显示整个当前月份的数据，即现在 01/08/2012 到 31/08/2012。

如果用户只是在任何一个框中选择日期，则另一个文本框应该具有相同的值。

所以我已经声明了如下变量并尝试了条件，但它总是显示整个月的数据，而不管选择了什么日期。我认为我的 if 条件有问题。

```
$startdate = isset($_REQUEST['startdate']) ? $_REQUEST['startdate'] : null;
$enddate   = isset($_REQUEST['enddate']) ? $_REQUEST['enddate'] : null;
if (empty($startdate)) {
    $startdate = $enddate;
}
if (empty($enddate)) {
    $enddate   = $startdate;
}
if (empty($startdate))
    ;
if (empty($enddate))
    ;
$startdate = '01/08/2012';
$enddate   = '31/08/2012'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:23:59.657

最后两条`if`语句对程序流程没有影响。你总是设置`$startdate`和`$enddate`到指定的日期。

你需要：

```
if(empty($startdate)) $startdate = '01/08/2012';
if(empty($enddate)) $enddate = '31/08/2012'; 
```

如果你想每次都得到实际月份的第一天和最后一天，你可以使用这样的东西：

```
if(empty($startdate)) $startdate = date('01/m/Y', strtotime("-1 month"));
if(empty($enddate)) $enddate = date('d/m/Y', strtotime("-1 month")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:25:03.720

我认为这会奏效

```
$startdate = isset($_REQUEST['startdate']) ? $_REQUEST['startdate'] : "";
$enddate = isset($_REQUEST['enddate']) ? $_REQUEST['enddate'] : "";

if (empty($startdate) && (empty($enddate)) {
    $startdate = '01/08/2012';
    $enddate = '31/08/2012';
} elseif (empty($startdate) {
    $startdate = $enddate;
} elseif (empty($enddate) {
    $enddate = $startdate;
} 
```

如果两者都为空，则使用本月的月初和月底；如果其中一个为空，则使用另一个的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:25:12.020

逻辑不正确。这应该有效。

```
$startdate = isset($_REQUEST['startdate']) ? $_REQUEST['startdate'] : null;
$enddate = isset($_REQUEST['enddate']) ? $_REQUEST['enddate'] : null;

if (empty($startdate)) {
$startdate  = $enddate ;
}
elseif (empty($enddate)) {
$enddate = $startdate;
}
elseif(empty($startdate) && empty($enddate)) {
$startdate = '01/08/2012';
$enddate = '31/08/2012';
} 
```

# macos - NSDate 奇怪的行为

> ID：12080777
> 
> 赞同：0
> 
> 时间：2012-08-22T20:20:03.503
> 
> 标签：macos, nsdate

我正在尝试`+[NSDate dateWithNaturalLanguageString]`在 Mac OS X (Snow Leopard) 上使用来获取明天的日期。

我原以为它会在明天凌晨 12 点返回，但它会在明天中午 12 点返回。这是一个错误还是我做错了什么？

代码：

```
date = [NSDate dateWithNaturalLanguageString:@"tomorrow"];

NSLog(@"DATE: %@", date); 
```

输出：`DATE: 2012-08-23 12:00:00 +0100`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T23:34:55.893

您需要**在午夜使用明天**而不是明天，如下所示：

```
date = [NSDate dateWithNaturalLanguageString:@"tomorrow at midnight"];

NSLog(@"DATE: %@", date); 
```

**输出：**

2012-08-24 00:00:00 +0100

* * *

**笔记：**

如果您想要特定的时间，您也可以使用**Tomorrow at <time> AM**，例如：

```
date = [NSDate dateWithNaturalLanguageString:@"tomorrow at 1:00 AM"]; 
```

或午夜：

```
date = [NSDate dateWithNaturalLanguageString:@"tomorrow at 12:00 AM"]; 
```

# impersonation - Web 部署模拟（管理服务委派）不起作用

> ID：12080782
> 
> 赞同：1
> 
> 时间：2012-08-22T20:20:21.257
> 
> 标签：impersonation, delegation, webdeploy, dac

我正在尝试使用 web deploy 来部署我的 dacpac 包，该包用于执行一些 sql 脚本。我有一个名为 .\DeploymentService 的本地 Windows 帐户，它位于本地管理员组中，我想拥有数据库并执行脚本。

为此 - 我相应地配置委派 - 在管理服务委派中，我为 dbDacFx 规则设置“特定用户” = .\DeploymentService 提供密码 ![管理服务委派 - 用于 dbDacFx](../Images/a5bb142f2b59c81697633e111ecab441.png)

我在 SQL Server 中根据 serveradmin 登录创建。我的 WMSvc 在 LOCAL SERVICE 帐户下执行。

我使用以下命令行参数进行部署：

> msdeploy.exe -verb:sync -source:dbDacFx="C:\Main\Src\Community.DB\bin\Debug\Community.DB.dacpac" -dest:dbDacFx="Data Source=.;Database=CommunityInt; 集成Security=true",computername=”<a href="https://Community02:8172/msdeploy.axd?site=Default" rel="nofollow noreferrer">https://Community02:8172/msdeploy.axd?site=默认网站”,用户名=.\DeploymentService,密码=*************,authType=basic -allowuntrusted

我在我的 PC 上执行它，目的地是不同的 PC。

但是，这会失败并出现错误“无效句柄”或“找不到类名”，具体取决于我是否在我的 SQL Server 中创建了具有公共角色的“本地服务”登录。

预期行为：当我将管理服务委派中的用户名设置为特定帐户时，我希望 MSDeploy 在我指定的帐户下执行。

实际行为：我在目标环境中使用 SQL 探查器进行了跟踪，发现 WMSvc 在其进程帐户（LOCAL SERVICE）而不是 .\DeploymentService 下执行 msdeploy，这就是脚本执行失败的原因。如果在 SQL Server 中我将 LOCAL SERVICE 帐户映射到 serveradmin 角色，那么它可以正常工作。如果我在 .\DeploymentService 帐户下执行 WMSvc，它也可以正常工作。

**所以基本上没有办法在管理服务委派中使用“用户名” - 你在那里设置什么都没关系 - 它没有任何效果。**

有谁知道如何使这项工作？

关键词：WebDeploy、WMSvc、dbDacFx、模拟、委托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T17:45:00.340

嘿伙计们，我很遗憾听到你遇到这个问题。我想让您知道，我们在 dbDacFx 提供程序/MSDeploy 中有一个错误，当在 WMSvc 场景中与 dbDacFx 提供程序一起使用时，它会阻止 SQL Auth 工作。

我们还没有收到足够的反馈来保证服务 MSDeploy 以解除阻止。如果您受到此影响，最好的办法是在[http://aspnet.uservoice.com](http://aspnet.uservoice.com)上创建一个条目并投票。如果我们获得足够的选票，那么我们可以考虑发布更新以解除阻止。关于这些坏消息我很遗憾。

# iphone - 在 navigationController 堆栈中释放特定 UIVIewController 的内存

> ID：12080783
> 
> 赞同：0
> 
> 时间：2012-08-22T20:20:23.370
> 
> 标签：iphone, objective-c, ios, memory-management, uiviewcontroller

基本上我有一个具有介绍性视图的应用程序。一旦你到达某个视图，之前的视图就根本无法访问，所以我想将它们从堆栈中删除并释放它们消耗的任何内存。做这个的最好方式是什么？现在我正在做类似的事情

```
NSMutableArray *allViewControllers = [NSMutableArray arrayWithArray:self.navigationController.viewControllers];
NSArray *allControllersCopy2 = [allViewControllers copy];
for (id object in allControllersCopy2) {
    if([allControllersCopy2 indexOfObject:object] == ([allControllersCopy2 count] - 1)){
        NSLog(@"IGNORE CURRENT VIEW");
    }
    else{
        [allViewControllers removeObject:object];
        [object release];
    }

}
self.navigationController.viewControllers = allViewControllers;
[allControllersCopy2 release]; 
```

这真的会释放这些视图消耗的内存吗？还是只是从堆栈数组中删除视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:28:27.800

当您准备好推送“特定视图”时，使用 setViewControllers:animated: 将堆栈替换为您的最终 ViewController，而不是使用 pushViewController 将其添加到堆栈中。

假设控制器 = '那个特定的视图'...

不要做 [self.navigation pushViewController:controller animated:YES]，做：

```
[self.navigationController setViewControllers:[NSArray arrayWithObject:controller] animated:YES]; 
```

这将释放所有以前的视图控制器，它们的 dealloc 方法将被调用，内存释放等

# python - python、% 和 mysql 语句

> ID：12080786
> 
> 赞同：2
> 
> 时间：2012-08-22T20:20:30.837
> 
> 标签：python

我正在尝试执行一个 mysql 查询，它需要包含 % 字符...在构建查询时，我遇到了 python 使用 % 并试图将其作为变量粘贴的问题：

```
statmt="select id from %s WHERE `email` LIKE %blah%" % (tbl)
self.cursor.execute(statmt) 
```

这自然会引起：

```
statmt="select id from %s WHERE `email` LIKE %blah%" % (tbl)
TypeError: not enough arguments for format string 
```

我应该如何解决这个问题，以便 Python 停止将其作为变量读取，并将其作为字符串的一部分？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T20:22:21.903

`%`在Python 格式化表达式中需要文字时，请使用`%%`：

```
statmt="select id from %s WHERE `email` LIKE '%%blah%%'" % (tbl) 
```

请参阅文档[第 5.6.2 节。字符串格式化操作](http://docs.python.org/library/stdtypes.html#string-formatting-operations)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T20:22:31.083

您不需要使用字符串插值。execute 方法会为您处理它，因此您可以这样做：

```
statmt="select id from %s WHERE `email` LIKE %blah%"
self.cursor.execute(statmt, tbl) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T20:22:36.057

你应该逃避你的百分号`%%`

您可能应该使用参数化查询`?`而`,`不是字符串插值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T20:22:35.803

您可以使用[`str.format`](http://docs.python.org/library/string.html#formatstrings)：

```
statmt="select id from {tbl} WHERE `email` LIKE %blah%".format(tbl=tbl) 
```

确保您没有创建 SQL 注入漏洞。

# android - 页眉和页脚不会留在 Phonegap 上

> ID：12080793
> 
> 赞同：0
> 
> 时间：2012-08-22T20:21:05.413
> 
> 标签：android, cordova

我的 android 应用程序上有一个可刷新的列表（使用 Iscroll）。
不知何故，如果我重新加载列表：

```
myScroll.destroy();
myScroll = new iScroll('wrapper', {
    useTransform : false,
    hScroll: false
});
document.addEventListener('touchmove', function(e) {
    e.preventDefault();
}, false);

document.addEventListener('DOMContentLoaded', 'loaded', false); 
```

页眉和页脚在滚动时消失（有时会，有时不会）。
有没有办法确保他们永远不会滚动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:01:59.770

我使用以下 CSS 将标题保留在 Android 上：

```
.header {
text-align: center;
background: -webkit-gradient(linear, left top, left bottom, from(#eee), to(#999));
height: 58px;
left: 0px;
top: 0px;
width: 100%;
position: fixed;
z-index: 2;
} 
```

# php - 分享内容时重复输入

> ID：12080794
> 
> 赞同：0
> 
> 时间：2012-08-22T20:21:05.530
> 
> 标签：php, jquery, html, ajax

当我单击用户链接上的共享时..它可以很好地共享该帖子，但它会发布两次。我检查了萤火虫，当点击（一次）时，它会显示两个 POST 请求，将两个帖子插入数据库，然后在用户提要中显示它们。我真的不明白我要去哪里错了。

分享链接

```
echo'<a class="sharelink" title="Share '.$poster_name['fullusersname'].'s status" href="#"
 data-streamitem_creator='.$streamitem_data['streamitem_creator'].'
 data-streamitem_target='.$_SESSION['id'].'
 data-streamitem_content='.$streamitem_data['streamitem_content'].'
 data-streamitem_type_id=4>Share</a>'; 
```

AJAX

```
$(document).ready(function() {
    $('.sharelink').click(function(e) {
        e.preventDefault();
        var streamitem_creator = $(this).data('streamitem_creator');
        var streamitem_target = $(this).data('streamitem_target');
        var streamitem_content = $(this).data('streamitem_content');
        var streamitem_type_id = $(this).data('streamitem_type_id');

        $.ajax({
            type: "POST",
            url: "../include/share.php",
            data: {
                streamitem_creator: streamitem_creator,
                streamitem_target: streamitem_target,
                streamitem_content: streamitem_content,
                streamitem_type_id: streamitem_type_id
            },
            success: function(data) {
                $(".usermsg").html(data);
            }
        });
    });
});​ 
```

分享.php

```
<? 
session_start();
require"load.php";

if(isset($_POST['streamitem_type_id'])&isset($_POST['streamitem_creator'])&isset($_POST['streamitem_content'])&isset($_POST['streamitem_target'])){

user_core::create_streamitem(4,$_SESSION['id'],$_POST['streamitem_content'],1,$_POST['streamitem_creator']);

}
?> 
```

加载.PHP

```
public function create_streamitem($typeid,$creatorid,$content,$ispublic,$targetuser){
    global $mysqli;
            $content = $content;
//          $content =  strip_tags($content);

            if(strlen($content)>0){

    $insert = "INSERT INTO streamdata(streamitem_type_id,streamitem_creator,streamitem_target,streamitem_timestamp,streamitem_content,streamitem_public) VALUES ($typeid,$creatorid,$targetuser,UTC_TIMESTAMP(),'$content',$ispublic)";
            $add_post = mysqli_query($mysqli,$insert) or die(mysqli_error($mysqli));
            $last_id  = mysqli_insert_id($mysqli); 
                if(!($creatorid==$targetuser)){
                    $fromuser= rawfeeds_user_core::getuser($creatorid);
                    $_SESSION['id']==$content;
            }       
            return;
            }else{
            return false;
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:32:24.520

我看不出任何问题.. 无论如何，您没有`$('.sharelink').click`在您的页面中两次注册该处理程序吗？

# ios - UITextArea ios 的事件监听器

> ID：12080797
> 
> 赞同：0
> 
> 时间：2012-08-22T20:21:27.257
> 
> 标签：ios, ios5

我一直在徒劳地试图找到如何将侦听器添加到文本区域。

我基本上想要做的是创建一个富文本编辑器，我可以让用户对特定项目发表评论。

为此，我使用了一个文本区域。如果您有任何其他建议，请告诉我。

另一方面，我没有看到文本区域的文本确实发生了变化或相关功能。有没有办法我们自己构建它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:25:43.000

您正在寻找的是`UITextViewDelegate`'s。看看[http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html)

编辑

根据我们的聊天，您正在寻找的教程还可以在键盘上方添加一个完成按钮，请访问[http://gabriel-tips.blogspot.com/2011/05/input-accessory-view-how-to-add-额外的.html](http://gabriel-tips.blogspot.com/2011/05/input-accessory-view-how-to-add-extra.html)

# objective-c - Xcode Interface Builder 为按钮设置突出显示的图像

> ID：12080801
> 
> 赞同：2
> 
> 时间：2012-08-22T20:21:53.533
> 
> 标签：objective-c, xcode, macos, cocoa, interface

我正在从 Mac OS X 制作一个可可应用程序，而不是用于 iphone。

我可以设置按钮的背景图像并取消选中属性检查器中的边框。但是，我不知道当您单击它时如何设置图像（突出显示/单击时，无论您想如何称呼它）。我想这样做是因为

我在谷歌上找到了使用 UIbutton 执行此操作的指南，但这并没有帮助，因为我正在为 Mac 制作它。

我正在使用[InAppStoreWindow](https://github.com/indragiek/INAppStoreWindow)并且按钮位于标题栏中。当我单击带有自定义图像的按钮时，背景变为白色：![带有白色按钮的自定义背景](../Images/23f2108cb0e86404eb3489646bf3f17e.png)

非常感谢你！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-22T22:08:44.137

单击按钮时您会得到白色背景，因为您使用的类型不正确。您需要将按钮的类型更改为***Momentary Change***。您可以在*属性检查*器中更改它：

![怎么做](../Images/e8b576dc0bc6b1e1ccd2cc274f9f0e68.png)

或以编程方式更改：

```
[buttonOutlet setButtonType:NSMomentaryChangeButton]; 
```

对于**高亮显示：只需在***Attributes Inspector*中添加另一个图像作为**备用**图像，它会在按下按钮时显示。

# ruby-on-rails - Heroku db:pull taps gem 拉取之前的 db:push'd 数据而不是当前数据

> ID：12080805
> 
> 赞同：-1
> 
> 时间：2012-08-22T20:22:09.063
> 
> 标签：ruby-on-rails, database, heroku, taps

我正在使用 taps gem，我正在尝试使用 heroku db:pull 来下拉我当前的生产数据库。

但是，当我拉动时，它会拉下一个我 db:push 近 3 个月前的数据库，而不是当前的数据库。

有没有办法指定我想要最新的？是否可以删除该旧数据库？

谢谢你的时间

编辑：我在本地使用 MySQL，我知道 pgbackups 并试图避免与此相关的 pg 转储。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:40:42.567

如果您有多个部署环境（即暂存环境与生产环境），请确保使用 db:pull --app productionAppName 指定正确的环境。

如果您想要删除生产环境中未使用的表，您的两个选择是：

1.  创建迁移以删除表
2.  “heroku run rails console”并手动删除表格。

这篇文章中描述了这两种技术： [Heroku Drop Table Rails Help](https://stackoverflow.com/questions/6964824/heroku-drop-table-rails-help)

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T16:23:49.063

Heroku 上只有 1 个 DB，但它有很久以前的剩余表，当我向上推新数据库时，这些表没有被覆盖。

TL;DR => 它将旧数据库与新数据库合并

# java - 媒体播放器出错

> ID：12080809
> 
> 赞同：0
> 
> 时间：2012-08-22T20:22:15.983
> 
> 标签：java, android

我正在尝试在我的应用程序中播放音乐并在第一首歌曲完成后播放歌曲，但我遇到了一些我无法解决的错误？

```
public class Music {
    int count;
    String[] titles = new String[] { "title1.mp3", "title2.mp3", "title3.mp3", "title4.mp3" };

    public void GameMusic(){
        count = 0;
        MediaPlayer mp = MediaPlayer.create(this, R.raw.title1);
        mp.start();
    }

    void onCompletion(MediaPlayer mp){
        mp.stop();
        if (count == titles.length -1) {
            count = 0;
        }
        mp.setDataSource(titles[count]);
        count++;
        mp.prepare(); 
        mp.start();
    }
} 
```

错误在：

```
 MediaPlayer mp = MediaPlayer.create(this, R.raw.music); 
```

（MediaPlayer 类型中的 create(Context, int) 方法不适用于参数 (Music, int)

```
 mp.setDataSource(titles[count]); 
```

（未处理的异常类型 IOException）

```
 mp.prepare(); 
```

（未处理的异常类型 IOException）

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:28:04.153

好吧，这些错误可能有点神秘，但它们是不言自明的。

您需要将 Context 传递给 GameMusic() 并使用它来初始化 MediaPlayer：

```
public void GameMusic(Context context){
    count = 0;
    MediaPlayer mp = MediaPlayer.create(context, R.raw.title1);
    mp.start();
} 
```

`this`仅当类（在本例中为 Music）扩展 Context 时才有效，因此您需要以另一种方式提供 Context。

在 onCompletion() 中使用 try-catch 块来处理 IOException：

```
try {
    mp.setDataSource(titles[count]);
    count++;
    mp.prepare(); 
    mp.start();
}
catch(IOException e) {
    // Do something when MediaPlayer fails
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:34:37.353

您的 Music Class 只是一个类而不是一个活动，因此`this`传递一个对象而不是一个`context`. 如果这是您唯一的音乐播放器类，那么您需要扩展它，`Activity`否则您需要将上下文传递给它。

```
public void GameMusic(Context context){
count = 0;
MediaPlayer mp = MediaPlayer.create(context, R.raw.title1);
mp.start();
} 
```

对于其他两个异常，它声明异常未处理。所以你需要用一个`Try-Catch`挡住未被抓住的把手`IOException`。

这应该可以解决您现在遇到的所有错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T12:33:47.223

将数据源设置为 Mediaplayer 时尝试使用音乐文件的绝对路径

如果它存储在 sd 卡中意味着 .. 试试这个

```
 String ExternalStorageDirectoryPath = Environment.getExternalStorageDirectory()
                                      .getAbsolutePath();

 mp.setDataSource(ExternalStorageDirectoryPath +"/"+titles[count]); 
```

调用 mp.prepare() 之后；

实现onpreparedlistner，在收到通知后启动媒体播放器

```
 @Override
 public void onPrepared(MediaPlayer mp) {
   mp.start();
 } 
```

并处理各种异常，以便您轻松跟踪问题。

# html - 图像未显示在网页上

> ID：12080817
> 
> 赞同：2
> 
> 时间：2012-08-22T20:22:38.927
> 
> 标签：html, image

我可能错过了令人眼花缭乱的明显，但我无法弄清楚为什么图像没有显示在我的网站上。这是HTML：

```
<p>Above the image</p>
<img src="/Trends/TDBFGLogo5.gif" alt="" />
<p>Below the image</p> 
```

我的代码在目录 D:\WebApp 中执行，其中包含一个名为 Trends 的文件夹，其中包含我的所有图像。我什至尝试过绝对路径 D:/WebApp/Trends/TDBFGLogo5.gif 但我看到的只是：

```
Above the image

Below the image 
```

我没有影响 img 标签的 CSS，并且该标签位于 HTML 的正文中。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:26:17.667

```
<p>Above the image</p>
<img src="Trends/TDBFGLogo5.gif" alt="" />
<p>Below the image</p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:25:59.597

像这样试试

```
<p>Above the image</p>
<img src="./Trends/TDBFGLogo5.gif" alt="" />
<p>Below the image</p> 
```

# c++ - 如何使用 POCO 线程？

> ID：12080820
> 
> 赞同：2
> 
> 时间：2012-08-22T20:22:50.537
> 
> 标签：c++, poco-libraries

我开始使用 POCO 并查看了线程的文档。由此，我创建了一个似乎不起作用的测试程序：

```
#include <iostream>
#include <Poco/Thread.h>
#include <Poco/ThreadTarget.h>
using namespace std;

void myfunc(){
 cout << "test";
}
int main(){
    Poco::ThreadTarget ra(&myfunc);
    Poco::Thread thr;
    thr.start(ra);
    return 0;
} 
```

我收到这些错误：

```
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:18: undefined reference to `Poco::ThreadTarget::ThreadTarget(void (*)())'
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:19: undefined reference to `Poco::Thread::Thread()'
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:20: undefined reference to `Poco::Thread::start(Poco::Runnable&)'
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:19: undefined reference to `Poco::Thread::~Thread()'
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:18: undefined reference to `Poco::ThreadTarget::~ThreadTarget()'
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:19: undefined reference to `Poco::Thread::~Thread()'
C:\Users\M\workspace\Poco\Debug/../src/Poco.cpp:18: undefined reference to `Poco::ThreadTarget::~ThreadTarget()' 
```

我认为这些来自我对 POCO 线程的了解中的一些基本缺陷。有人可以提供一个工作程序，或者更好地解释 POCO 线程是如何工作的。该文档虽然内容广泛，但并未解释线程中涉及的多个类作为一个整体做什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-22T20:43:05.827

您的错误看起来像链接器错误。根据此处的文档[http://pocoproject.org/docs/Poco.Thread.html](http://pocoproject.org/docs/Poco.Thread.html)，您需要确保链接到 PocoFoundation 库。也许你已经这样做了，但如果没有，你需要这样做。

您没有指定您正在使用的操作系统，但如果您使用的是 g++，请尝试添加`-lPocoFoundation`到您的构建指令以链接到该库并提供该库的路径。如果使用 windows 添加`PocoFoundation.lib`到您的项目。

# c++ - boost 的 managed_external_buffer 定义在哪里？

> ID：12080821
> 
> 赞同：0
> 
> 时间：2012-08-22T20:22:53.593
> 
> 标签：c++, boost, interprocess

在 boost/interprocess/managed_external_buffer.hpp 中，定义了一个模板类 basic_managed_external_buffer，但我无法找到 managed_external_buffer 类的实际定义（我猜它只是从前一个具有特定模板参数的类继承）。

我也在寻找 managed_shared_memory 类的定义，我也在 managed_shared_memory.hpp 文件中找到了一个 basic_managed_shared_memory 模板类，但没有定义实际的 managed_shared_memory 类。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:29:58.720

在`boost/interprocess/interprocess_fwd.hpp`：

```
typedef basic_managed_external_buffer
   <char
   ,rbtree_best_fit<null_mutex_family>
   ,iset_index>
managed_external_buffer; 
```

另一个也在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:30:08.703

来自`<boost/interprocess/interprocess_fwd.hpp>`：

```
template <class CharType
         ,class MemoryAlgorithm
         ,template<class IndexConfig> class IndexType>
class basic_managed_external_buffer;

typedef basic_managed_external_buffer
   <char
   ,rbtree_best_fit<null_mutex_family>
   ,iset_index>
managed_external_buffer; 
```

# sql-server - 如何清除 SQL 关联表而不删除其“非空”约束？

> ID：12080823
> 
> 赞同：0
> 
> 时间：2012-08-22T20:22:55.373
> 
> 标签：sql-server, exception, linq-to-sql, database-design, constraints

我有一个 SQL 关联表，它只有两列，它们都是外键（来自其他两个表的两个 ID），表示两个数据对象之间的关系。这些列具有 NOT NULL 约束似乎很自然，因为在对象和 null 之间或在 null 和 null 之间建立关系似乎毫无意义。

令我惊讶的是，当我的 (WPF, LINQ, C#) 程序尝试清除对象的关联时，以下提交会引发异常，指出其中一列不能为空。我不希望它为空，我希望清除整行。

现在，我可以放弃空约束来绕过异常，但这似乎没有必要。

**编辑：**实际上，SQL Server 不会让我这样做，因为这两个值是主键，并且主键中不允许有空值，这是有道理的......但是我再次尝试删除行，而不是将其 ID 设置为空。

所以我问：

为什么删除行（通过`clear()`）会导致关于空列值的异常？

和

我是否有其他方法可以清除我应该做的这些行，或者我是否需要删除非空约束？

或者还有什么我不明白的？

细节：

我的表有两列：

```
RecipeID (PK, FK, int, not null)
AltRecipeID (PK, FK, int, not null) 
```

C# LINQ-to-SQL 代码：

```
RecipeToUpdate.PFW_AlternateRecipes.Clear();
App.db.SubmitChanges(); 
```

提交例外：

> 已尝试删除 PFW_Recipe 和 PFW_AlternateRecipe 之间的关系。但是，不能将关系的外键之一 (PFW_AlternateRecipe.RecipeID) 设置为 null。

# winapi - 如何使用 IWinHttpRequest 忽略无效证书？

> ID：12080824
> 
> 赞同：3
> 
> 时间：2012-08-22T20:22:57.897
> 
> 标签：winapi, winhttp

我正在使用 Microsoft 的[`WinHttpRequest`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384106.aspx)COM 对象请求带有无效证书的网页：

```
IWinHttpRequest http = new WinHttpRequest();
http.Open("GET", url, false);
http.Send(null); 
```

除了调用`Send`引发异常：

```
0x80072F0D - The certificate authority is invalid or incorrect 
```

我怎么知道`WinHttpRequest`我不在乎，我希望它检索我要求的页面？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T20:35:23.860

解决方案是忽略[四种 SSL 错误](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384108%28v=vs.85%29.aspx)：

```
//Code is released into the public domain. No attribution required. 
IWinHttpRequest http = new WinHttpRequest();
http.Open("GET", url, false);

//ignore any TLS errors 
option = http.Option[WinHttpRequestOption_SslErrorIgnoreFlags];
options = options | SslErrorFlag_Ignore_All;
http.Option[WinHttpRequestOption_SslErrorIgnoreFlags] = option; 

    //SslErrorFlag_Ignore_All                                  0x3300
    //Unknown certification authority (CA) or untrusted root   0x0100
    //Wrong usage                                              0x0200
    //Invalid common name (CN)                                 0x1000
    //Invalid date or certificate expired                      0x2000

http.Send(null); 
```

# javascript - 即使它在每个浏览器中都可以使用 不是有效的 HTML 元素？

> ID：12080826
> 
> 赞同：2
> 
> 时间：2012-08-22T20:22:59.600
> 
> 标签：javascript, jquery

使用安全吗`$("<div />").appendTo($mySelector)`？即使不是有效的 HTML 元素，它也能在每个浏览器中工作吗？

我问是因为它真的比`$("<div><div />")`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:26:02.997

是的。如果您查看源代码，则此案例甚至得到了优化。

```
/^<(\w+)\s*\/?>(?:<\/\1>|)$/
  <div      / >               // your case 
```

如果存在或不存在 a`/`并且不包含在组中，则此正则表达式将匹配。唯一的分组表达式是实际`div`使用的标签名称 ( )。

如果您仔细观察，您会发现以下内容都以相同的方式处理：

```
<div>
<div />
<div></div>
<div /></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:25:23.237

它将正常工作。`jQuery`处理翻译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:25:44.077

是的，但为什么不使用`$(document.createElement('div'));`它比使用 jquery 创建元素要快。它可以在不运行正则表达式并需要 jquery 翻译的情况下工作。

有关使用不同方法创建元素的测试，请参阅此[SO 答案](https://stackoverflow.com/a/327065/897794)

# mongoid - 如何在 Mongoid 中重命名 mongo 集合？

> ID：12080830
> 
> 赞同：7
> 
> 时间：2012-08-22T20:23:48.800
> 
> 标签：mongoid, mongoid3

我有一个名为艺术家的收藏，我想将其重命名为 Artist_lookups。我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-05-11T16:16:07.457

使用 mongoid5 / mongo ruby​​ 驱动程序 2：

```
# if you need to check whether foo exists
return unless Mongoid.default_client.collections.map(&:name).include?('foo')

# rename to bar
Mongoid.default_client.use(:admin).command(
  renameCollection: "#{Mongoid.default_client.database.name}.foo",
  to: "#{Mongoid.default_client.database.name}.bar"
) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T04:26:20.050

很简单，在 mongo shell 中，这样做：

> db.artists.renameCollection("artist_lookups");

如果您想删除 artist_lookups（如果存在）：

> db.artists.renameCollection("artist_lookups", true);

你可以得到一些例外。

*   10026 – 如果源命名空间不存在则引发。
*   10027 – 如果目标命名空间存在并且 dropTarget 为 false 或未指定，则引发。
*   15967 – 如果目标命名空间是无效的集合名称，则引发。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-22T20:38:09.527

来自[Mongoid 文档](http://mongoid.org/en/mongoid/docs/persistence.html)：

```
class Band
  include Mongoid::Document
  store_in collection: "artists", database: "music", session: "secondary"
end 
```

`store_in collection: "artist_lookups"`在您的模型中使用。这将使您可以将`Artist`模型存储在`artist_lookups`集合中。

如果你想保留`artists`集合中的现有数据，并重命名它，我建议暂时关闭你的应用程序，将集合重命名为`artist_lookups`MongoDB 服务器上，然后重新启动应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-04T09:50:11.460

```
db.artists.renameCollection("artist_lookups") 
```

肯定会工作。

# php - jquery 无法获得 web 服务响应

> ID：12080833
> 
> 赞同：0
> 
> 时间：2012-08-22T20:24:00.630
> 
> 标签：php, jquery, web-services, gps

所以...我被命令:'( 为一家重型机械租赁公司创建一个信息系统，每台机器都有一个 GPS，来自 GPS 的数据由另一家使用网络服务的外部公司提供。（我对这些项目非常迷茫......）

我需要（至少加载）从 Web 服务读取数据，用它填充数据库，Web 服务响应逗号分隔的数据，在另一种情况下它响应相同，但是是 .zip 中的 .txt。

所以当它只是在页面中回显时......它看起来像这样：

```
0
739,-70.61692,-33.44053,0,0,2005-10-03 13:54:15.0,Cada 00:02:00 hh:mm:ss.
739,-70.61685,-33.44038,0,0,2005-10-03 13:19:00.0,Detención Mayor a 2 Min.
739,-70.61682,-33.44040,0,0,2005-10-03 13:14:47.0,Cada 00:02:00 hh:mm:ss.
739,-70.61685,-33.44040,0,0,2005-10-03 12:56:09.0,Detención Mayor a 2 Min.
739,-70.61683,-33.44037,0,0,2005-09-21 03:19:23.0,Cada 00:02:00 hh:mm:ss.
739,-70.61738,-33.44057,0,0,2005-09-21 03:16:45.0,Detención Mayor a 2 Min.
739,-70.62070,-33.44182,0,0,2005-09-21 03:14:41.0,Cada 00:02:00 hh:mm:ss.
739,-70.62060,-33.44165,0,0,2005-09-21 03:09:44.0,Cada 00:02:00 hh:mm:ss.
739,-70.61685,-33.44040,0,0,2005-09-21 01:05:31.0,Cada 00:02:00 hh:mm:ss.
……
……
……
739,-70.61687,-33.44040,0,0,2005-09-21 01:00:35.0,Cada 00:02:00 hh:mm:ss.
739,-70.61685,-33.44038,0,0,2005-09-21 00:56:02.0,Detencion Mayor a 2 Min.
FIN 
```

压缩后的数据看起来完全一样。但我什至无法加载数据，所以我应该如何使用它，即使用它来提供数据库（这实际上是我想要做的）

我正在使用的 Jquery 代码如下所示：

```
 $("a").click(function(event){
      event.preventDefault();
      var webdir = $(this).attr("href");
      alert("I'm supposed to load the following URL: "+webdir);       
      $.ajax({
      url: webdir,
      success: function(data){
          $('#resultado').html(data);
          alert('Load was performed.');
      }
      }).fail(function(){ 
      alert("error"); 
      });//this at least throws an error
  }); 
```

[-您可以看到一个有效的（说实话）示例-](http://jsbin.com/abuliv/4)

而且我什至无法获取数据，我什至不知道是否需要使用 jquery 获取数据，或者是否必须使用 PHP 获取数据....所以请帮我处理 jquery ...然后，如果您有时间，请指出正确的方向，说明如何使用来自此类 WEB 服务的数据填充数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:31:55.620

始终查看浏览器的 JavaScript 错误控制台。

> XMLHttpRequest 无法加载 [https://www.entelgps.cl/webservices/api_pos/ApiPos.cfc?method=ObtenerPosiciones&usuario=77421750-9&password=7742&fecha=20120822&hora_inicio=12:30:00&hora_fin=13:10:00](https://www.entelgps.cl/webservices/api_pos/ApiPos.cfc?method=ObtenerPosiciones&usuario=77421750-9&password=7742&fecha=20120822&hora_inicio=12:30:00&hora_fin=13:10:00)。Access-Control-Allow-Origin 不允许来源[http://jsbin.com 。](http://jsbin.com)

本质上，问题在于 JavaScript AJAX 请求不允许从不同的域名请求内容。

# javascript - KnockoutJS / jQuery UI 可排序冲突

> ID：12080839
> 
> 赞同：4
> 
> 时间：2012-08-22T20:24:45.663
> 
> 标签：javascript, jquery-ui, dom, knockout.js, jquery-ui-sortable

我正在尝试同时使用 KnockoutJS 和 jQuery UI Sortable。我知道这已经完成（特别是，[knockout-sortable](https://github.com/rniemeyer/knockout-sortable)），但我的用例有一些非常具体的行为，我希望避免尝试进行切换。

无论如何，问题很简单——在使用 jQuery UI Sortable 移动一个 DOM 元素后，Knockout 在删除绑定到该 DOM 元素的 observableArray 元素时表现得很奇怪。它将无法删除被移动的元素，并且如果落入被移动元素的位置的元素被删除，它将同时删除该元素和最初移动的元素。很难用语言来形容，但被[这把小提琴](http://jsfiddle.net/joelhoward/vgrTY/3/)证明了。

问题似乎实际上发生在 knockout-2.1.0.js 中的以下块中：

```
function fixUpVirtualElements(contiguousNodeArray) {
    // Ensures that contiguousNodeArray really *is* an array of contiguous siblings, even if some of the interior
    // ones have changed since your array was first built (e.g., because your array contains virtual elements, and
    // their virtual children changed when binding was applied to them).
    // This is needed so that we can reliably remove or update the nodes corresponding to a given array item

    if (contiguousNodeArray.length > 2) {
        // Build up the actual new contiguous node set
        var current = contiguousNodeArray[0], last = contiguousNodeArray[contiguousNodeArray.length - 1], newContiguousSet = [current];
        while (current !== last) {
            current = current.nextSibling;
            if (!current) // Won't happen, except if the developer has manually removed some DOM elements (then we're in an undefined scenario)
                return;
            newContiguousSet.push(current);
        }

        // ... then mutate the input array to match this.
        // (The following line replaces the contents of contiguousNodeArray with newContiguousSet)
        Array.prototype.splice.apply(contiguousNodeArray, [0, contiguousNodeArray.length].concat(newContiguousSet));
    }
} 
```

此调用将移动的 DOM 元素添加到要在移除移动的元素时移除的元素列表中。

所以公开呼吁任何 jQuery UI / Knockoutjs 天才 - 有没有办法解决这个冲突，或者我需要做一些完全不同的事情来让这些工具很好地协同工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T22:35:02.720

我认为“最佳”解决方案是从 DOM 中删除元素并更改其在 KO 中的位置。您可以在`stop`可排序的情况下执行此操作。[http://jsfiddle.net/vgrTY/4/](http://jsfiddle.net/vgrTY/4/)

我继续将您的`array-contents`文本也更改为计算文本，以便正确显示。

# php - Selenium - 如何仅在特定 div 中搜索元素？

> ID：12080841
> 
> 赞同：0
> 
> 时间：2012-08-22T20:24:51.007
> 
> 标签：php, selenium

我的代码中有一个元素在许多地方的许多页面上使用。具体来说，它是一个日历元素。这个元素包含许多部分，但是，无论在哪里使用，这些内部部分总是相同的。我想做的是搜索日历元素内部的东西，而不管日历元素在哪里。

作为一个简化的案例，请考虑以下内容：

```
<div class="not-calendar">
    <a href="/not-calendar-link">A Link</a>
</div>
<div class="calendar">
    <a href="/calendar-link">A Link</a>
</div> 
```

现在，我想做一些类似的事情：

```
$this->click("//a[text()='A Link']"); 
```

但这是模棱两可的。我想对 A Link 文本进行同样的“搜索”，但只在带有类日历的 div 中搜索。请记住，我不想要日历 div 的直接 XPath，因为我希望它出现在许多页面的不同位置。我该怎么做呢？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:49:52.500

Xpath 非常强大，您是否尝试过查看文档？

```
//bbb      Selects all bbb elements no matter where they are in the document
aaa/bbb    Selects all bbb elements that are children of aaa
aaa//bbb   Selects all bbb elements that are descendant of the aaa element, no matter where they are under the aaa element 
```

您正在寻找的表达式：`//div[@class='calendar']/a`

# jquery - .load() 似乎总是使用 request.POST

> ID：12080843
> 
> 赞同：0
> 
> 时间：2012-08-22T20:25:00.657
> 
> 标签：jquery

我正在尝试使用 jquery 部分加载页面。

我不明白为什么`row.load()`当我点击链接时总是发送一个 request.POST，它确实应该发送一个 request.GET。有什么我忽略的吗？

**html:**

```
<a class="row_edit" href="/sales_item/edit/{{ item.id }}" title="{% trans 'Edit' %}"><i class="icon-pencil"> </i></a> 
```

**javascript:**

```
$(document).ready(function () {
  $(".row_edit").click(row_edit);
});

function row_edit() {
    // e.g. url = '/sales_item/edit/8' 
    var url = $(this).attr("href");
    var row = $(this).closest('tr')
    row.load(
        url + "/",
        null,
        function () {
            $("#save-form").submit(row_save); 
        }
    );
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:28:38.693

从[.load()](http://api.jquery.com/load/)文档：

> 如果数据作为对象提供，则使用 POST 方法；否则，假定为 GET。

只需省略`null`arg。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:28:00.800

要通过 GET 传递信息`.load()`，只需像往常一样将数据附加到 URL（`url?key=value&key2=value2`等）。但是，您的示例并没有真正表明将是什么信息，或者我会给您一个示例。

# mpi - MPI 接收/收集动态向量长度

> ID：12080845
> 
> 赞同：6
> 
> 时间：2012-08-22T20:25:04.870
> 
> 标签：mpi, gpgpu, multi-gpu

我有一个存储结构向量的应用程序。这些结构保存有关系统上每个 GPU 的信息，例如内存和 giga-flop/s。每个系统上有不同数量的 GPU。

我有一个同时在多台机器上运行的程序，我需要收集这些数据。我对 MPI 很陌生，但`MPI_Gather()`大部分时间都可以使用，但是我想知道如何*收集/接收*这些动态大小的向量。

```
class MachineData
{
    unsigned long hostMemory;
    long cpuCores;
    int cudaDevices;
    public:
    std::vector<NviInfo> nviVec; 
    std::vector<AmdInfo> amdVec;
    ...
};

struct AmdInfo
{
    int platformID;
    int deviceID;
    cl_device_id device;
    long gpuMem;
    float sgflops;
    double dgflops;
}; 
```

集群中的每台机器都会填充其`MachineData`. 我想收集这些实例中的每一个，但我不确定如何收集`nviVec`，`amdVec`因为它们的长度在每台机器上都不同。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T10:38:44.733

您可以`MPI_GATHERV`结合使用`MPI_GATHER`来完成此操作。`MPI_GATHERV`是的可变版本，`MPI_GATHER`它允许根等级从每个发送过程中收集不同数量的元素。但是为了让根等级指定这些数字，它必须知道每个等级包含多少个元素。这可以在此`MPI_GATHER`之前使用简单的单个元素来实现。像这样的东西：

```
// To keep things simple: root is fixed to be rank 0 and MPI_COMM_WORLD is used

// Number of MPI processes and current rank
int size, rank;
MPI_Comm_size(MPI_COMM_WORLD, &size);
MPI_Comm_rank(MPI_COMM_WORLD, &rank);

int *counts = new int[size];
int nelements = (int)vector.size();
// Each process tells the root how many elements it holds
MPI_Gather(&nelements, 1, MPI_INT, counts, 1, MPI_INT, 0, MPI_COMM_WORLD);

// Displacements in the receive buffer for MPI_GATHERV
int *disps = new int[size];
// Displacement for the first chunk of data - 0
for (int i = 0; i < size; i++)
   disps[i] = (i > 0) ? (disps[i-1] + counts[i-1]) : 0;

// Place to hold the gathered data
// Allocate at root only
type *alldata = NULL;
if (rank == 0)
  // disps[size-1]+counts[size-1] == total number of elements
  alldata = new int[disps[size-1]+counts[size-1]];
// Collect everything into the root
MPI_Gatherv(vectordata, nelements, datatype,
            alldata, counts, disps, datatype, 0, MPI_COMM_WORLD); 
```

您还应该`datatype`为结构注册 MPI 派生数据类型（在上面的代码中）（二进制发送可以工作，但不能移植，并且不能在异构设置中工作）。

# css - 使用 Bourbon 在单个元素上的多个框阴影

> ID：12080846
> 
> 赞同：0
> 
> 时间：2012-08-22T20:25:10.987
> 
> 标签：css

我想在一个元素上放置两个盒子阴影。以下不起作用：

```
@include box-shadow(1px 1px 488px 1px rgba(0, 0, 0, 0.12) inset);
@include box-shadow(4px 4px 4px 1px rgba(0, 0, 0, 0.28)); 
```

不提供一个逗号分隔的盒子阴影列表到`box-shadow`mixin 中（它只需要一个参数）。我怎样才能做到这一点？我正在使用 Boubon gem，但直接的 CSS 解决方案也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:29:51.510

请参阅链接以了解如何执行此操作

[有没有办法在一个元素上使用两个 CSS3 盒子阴影？](https://stackoverflow.com/questions/8556604/is-there-a-way-to-use-two-css3-box-shadows-on-one-element)

它的要点是尝试使用逗号分隔的，我知道你说你已经尝试过了，但可能会仔细检查他们在链接答案中建议的语法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T08:04:27.170

[Bourbon 的`box-shadow`mixin 已被弃用](https://github.com/gregbell/active_admin/pull/1913)，因为浏览器前缀的使用已降至阈值以下。只需使用常规的 ol' CSS：

```
box-shadow: 
    1px 1px 488px 1px rgba(0, 0, 0, 0.12) inset,
    4px 4px 4px 1px rgba(0, 0, 0, 0.28); 
```

旁注：我会注意使用如此巨大的模糊半径；这可能会在较慢的机器上获得相当糟糕的性能。如果您将其用作巨大的背景渐变，最好将该渐变添加为另一个背景`linear-gradient`图层。

# ruby-on-rails - 这是使用 RSpec & Shoulda 测试用户角色的正确 DRY 方法吗？

> ID：12080849
> 
> 赞同：1
> 
> 时间：2012-08-22T20:25:18.337
> 
> 标签：ruby-on-rails, rspec, cancan, shoulda

我有一个使用 cancan 的 rails 应用程序，我正在测试几个不同的角色。我正在寻找跨多个控制器设置这些测试的最干燥的方法。

这是我目前所拥有的缩短版本。有一个更好的方法吗？对我来说还是有点沉重。

```
describe OrganizationsController do
  render_views

  before do
    # User roles
    @unauthenticated = User.new
    @org_admin = Factory.create(:organization_admin)
    @org_staff = Factory.create(:org_staff)
    @customer = Factory.create(:customer)
    @admin = Factory.create(:admin)

    @organization = Factory.create(:organization)
    @org_for_admin = Factory.create(:organization, :user_group_id => @org_admin.user_group_id)
    @org_attr = FactoryGirl.attributes_for(:organization)
  end

  describe "GET 'show'" do
    authorized = %w(org_admin admin org_staff customer)
    not_authorized = %w(unauthenticated)

    not_authorized.each do |u|
      context "an organization by a user with role: #{u}" do
        before do
          user = instance_variable_get("@#{u}")
          get :show, :id => @organization.id, :format => 'json'
        end
        it { should_not respond_with :success }
        it { should respond_with :forbidden }
      end
    end

    authorized.each do |u|
      context "an organization by a user with role: #{u}" do
        before do
          user = instance_variable_get("@#{u}")
          get :show, :id => @organization.id, :format => 'json', :token => user.token
        end
        it { should respond_with :success }
        it { should render_template :show }
        it { should respond_with_content_type(/json/) }
        it { should assign_to(:organization).with_kind_of(Organization) }
      end
    end
  end

  describe "GET 'update'" do
    authorized = [%w(admin organization), %w(org_admin org_for_admin)]
    not_authorized = [%w(unauthenticated organization), %w(org_staff org_for_admin), %w(customer organization), %w(org_admin organization)]
    not_authorized.each do |u, o|
      context "an organization by a user with role: #{u}" do
        before do
          user = instance_variable_get("@#{u}")
          organization = instance_variable_get("@#{o}")
          put :update, :id => organization.id, :organization => @org_attr, :format => 'json'
        end
        it { should_not respond_with :success }
        it { should respond_with :forbidden }
      end
    end

    authorized.each do |u, o|
      context "an organization by a user with role: #{u}" do
        before do
          user = instance_variable_get("@#{u}")
          organization = instance_variable_get("@#{o}")          
          put :update, :id => organization.id, :organization => @org_attr, :format => 'json', :token => user.token
        end
        it { should respond_with :success }
        it { should render_template :update }
        it { should respond_with_content_type(/json/) }
        it { should assign_to(:organization).with_kind_of(Organization) }
      end
    end
  end
end 
```

或者，我是否应该使用 cancan 匹配器并将这些类型的能力测试移动到模型规范中，并且只对每个控制器操作进行成功和禁止的测试？也欢迎在反模式/风格建议方面对我的测试提出任何其他评论。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T02:43:57.437

[wiki](https://github.com/ryanb/cancan/wiki/Testing-Abilities)描述了你感受到的“痛点” ：

> 在功能/集成级别彻底测试用户权限可能很困难，因为通常存在许多分支可能性。
> 
> .. 如果您想独立于能力类内部的内容来测试控制器行为，很容易用您想要的任何行为来存根该能力。

```
def setup
  @ability = Object.new
  @ability.extend(CanCan::Ability)
  @controller.stubs(:current_ability).returns(@ability)
end

test "render index if have read ability on project" do
  @ability.can :read, Project
  get :index
  assert_template :index
end 
```

好问题。我自己也经常这样想。下一次，我将尝试 wiki 的建议。

# iphone - 从自定义 UIViewController 类继承并显示两个 UIViewController 类组件？

> ID：12080865
> 
> 赞同：0
> 
> 时间：2012-08-22T20:26:09.297
> 
> 标签：iphone, ios, xamarin.ios, monodevelop

我有一个 UIViewController 类 SurveyPanel，它像这样从 UIViewController 继承

```
SurveyPanel : UIViewController 
```

然后我有另一个 UIViewController 类，称为 AnnouncementPanel，它继承自 SurveyPanel

```
AnnouncementPanel : SurveyPanel 
```

我需要 AnnouncementPanel 来显示来自 SurveyPanel 的按钮和特定于 AnnouncementPanel 的按钮，但目前它只会显示 SurveyPanel 中的组件。这可能是我在 AppDelegate.cs 中加载控制器的方式吗？目前我正在做：

```
window = new UIWindow(UIScreen.MainScreenBounds);
AnnouncementPanel viewController = new AnnouncementPanel();
window.RootViewController = viewController;
window.MakeKeyAndVisible();
return true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T06:25:02.977

您是通过加载 XIB 文件还是通过代码在视图中创建 UI？

如果“通过加载 XIB 文件”，使用带有 UIViewController 继承的准备好的 UI 会有点混乱。

如果“按代码”，请仔细检查您是否：

1.  创建属于 AnnouncementPanel 的控件；
2.  调用 AddSubview 向 AnnouncementPanel.View 添加控件；
3.  正确设置控制框架（在屏幕的可见部分）；
4.  调用基（即SurveyPanel）控件的创建。

示例，我用于继承 (UITableViewCells) 视图：

```
// Base cell
public class UserCell: UIViewController
{

    string cellId = "CustomCell2";
    UITableViewCell cell;
    public UITableViewCell Cell {
        get { 
            if (cell == null)
                cell = new UITableViewCell (UITableViewCellStyle.Default, cellId);
            return cell; }
    }

    protected UIImageViewAvatar IvaAvatar;
    protected UILabel LblPerson;

    ...

    public UserCell (string cellId)
    {
        this.cellId = cellId;

        IvaAvatar = new UIImageViewAvatar ();
        LblPerson = new UILabel ();

        Cell.AddSubview (IvaAvatar);
        Cell.AddSubview (LblPerson);
    }

    ...

}

// Inherited cell
public class MessageCell: UserCell
{
    protected UILabel LblText;
    protected UILabel LblDatePlace;

    Message message;
    public Message Message {
        get { return message; } 
        set {
            message = value;
            Render ();
        }
    }

    ...

    // 4.
    // It is important to call base constructor
    public MessageCell (string cellId): base(cellId)
    {
        // 1.
        LblText = new UILabel ();
        LblDatePlace = new UILabel ();

        // 2.
        // Adding more controls to (Cell) View
        Cell.AddSubview (LblText);
        Cell.AddSubview (LblDatePlace);
    }

    ...

    // 3.
            // Render is called when someone set up Message property
    // So frames will be changed according to new data
    public new void Render()
    {
        base.Render();

        // Text
        LblText.Text = Message.Text;
        LblText.Font = UIFont.SystemFontOfSize (Constants.FONT_SIZE_MESSAGE);

        LblText.LineBreakMode = UILineBreakMode.WordWrap;
        LblText.Lines = 0;
        LblText.Frame = new RectangleF (LblPerson.Frame.Left, LblPerson.Frame.Bottom //+ Constants.SIZE_IDENT*/
                                        ,
                                        Cell.Frame.Width - LblPerson.Frame.Left - Constants.SIZE_IDENT, 0);
        LblText.SizeToFit ();

    }
} 
```

# ruby-on-rails - 在 Rails 模型中设置和获取虚拟属性

> ID：12080868
> 
> 赞同：6
> 
> 时间：2012-08-22T20:26:14.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, accessor, virtual-attribute

我正在寻找一种 Rails-y 方法来处理以下问题：

**事件**模型中的两个`datetime`属性：

 **```
start_at: datetime
end_at:   datetime 
```

我想使用 3 个字段以表单形式访问它们：

```
event_date
start_time
end_time 
```

我遇到的问题是如何使实际*和*虚拟属性保持“同步”，以便可以通过表单和/或直接通过`start_at`&更新模型`end_at`。

```
class Event < ActiveRecord::Base
  attr_accessible :end_at, :start_at, :start_time, :end_time, :event_date
    attr_accessor :start_time, :end_time, :event_date

  after_initialize  :get_datetimes # convert db format into accessors
  before_validation :set_datetimes # convert accessors into db format

  def get_datetimes
    if start_at && end_at
      self.event_date ||= start_at.to_date.to_s(:db)   # yyyy-mm-dd 
      self.start_time ||= "#{'%02d' % start_at.hour}:#{'%02d' % start_at.min}" 
      self.end_time   ||= "#{'%02d' % end_at.hour}:#{'%02d' % end_at.min}" 
    end
  end

  def set_datetimes
    self.start_at = "#{event_date} #{start_time}:00"
    self.end_at   = "#{event_date} #{end_time}:00"
  end
end 
```

哪个有效：

```
1.9.3p194 :004 > e = Event.create(event_date: "2012-08-29", start_time: "18:00", end_time: "21:00")

 => #<Event id: 3, start_at: "2012-08-30 01:00:00", end_at: "2012-08-30 04:00:00",  created_at: "2012-08-22 19:51:53", updated_at: "2012-08-22 19:51:53"> 
```

直到直接设置实际属性（`end_at`设置回`end_time`验证）：

```
1.9.3p194 :006 > e.end_at = "2012-08-30 06:00:00 UTC +00:00"
 => "2012-08-30 06:00:00 UTC +00:00" 
1.9.3p194 :007 > e
 => #<Event id: 3, start_at: "2012-08-30 01:00:00", end_at: "2012-08-30 06:00:00", created_at: "2012-08-22 19:51:53", updated_at: "2012-08-22 19:51:53"> 
1.9.3p194 :008 > e.save
   (0.1ms)  BEGIN
   (0.4ms)  UPDATE "events" SET "end_at" = '2012-08-30 04:00:00.000000', "start_at" = '2012-08-30 01:00:00.000000', "updated_at" = '2012-08-22 20:02:15.554913' WHERE "events"."id" = 3
   (2.5ms)  COMMIT
 => true 
1.9.3p194 :009 > e
 => #<Event id: 3, start_at: "2012-08-30 01:00:00", end_at: "2012-08-30 04:00:00", created_at: "2012-08-22 19:51:53", updated_at: "2012-08-22 20:02:15"> 
1.9.3p194 :010 > 
```

我的假设是我还需要**自定义“实际”属性的设置器**，但我不确定如何在不破坏默认行为的情况下做到这一点。想法？也许有更多的“Rails-y”“回调-y”方式来处理这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-22T23:23:50.860

这是我的看法。我没有用 ActiveRecord 测试过，但我留下了评论。希望这可以帮助。

```
class Event < ActiveRecord::Base

  attr_accessible :end_at, :start_at, :start_time, :end_time, :event_date
  attr_accessor :start_time, :end_time, :event_date

  def start_time
    @start_time || time_attr_from_datetime(start_at)
  end

  def start_time=(start_time_value)
    @start_time = start_time_value
    set_start_at
  end

  def end_time
    @end_time || time_attr_from_datetime(end_at)
  end

  def end_time=(end_time_value)
    @end_time = @end_time_value
    set_end_at
  end

  def event_date
    @event_date || start_at.to_date.to_s(:db)
  end

  def event_date=(event_date_value)
    @event_date = event_date_value
    set_start_at
    set_end_at
  end

  def start_at=(start_at_value)
    write_attribute(:start_at, start_at_value)  # Maybe you need to do write_attribute(:start_at, DateTime.parse(start_at_value)) here ???
    @start_time = time_attr_from_datetime(start_at)
  end

  def end_at=(end_at_value)
    write_attribute(:end_at, end_at_value)  # Maybe you need to do write_attribute(:end_at, DateTime.parse(end_at_value)) here ???
    @end_time = time_attr_from_datetime(end_at)
  end

  private
  def set_start_at
    self.start_at = DateTime.parse("#{event_date} #{start_time}:00")
  end

  def set_end_at
    self.end_at = DateTime.parse("#{event_date} #{end_time}:00")
  end

  def time_attr_from_datetime(datetime)
    "#{'%02d' % datetime.hour}:#{'%02d' % datetime.min}"
  end
end 
```

编辑：获取和设置 start_time 和 end_time 有一个明确的模式。可以通过元编程对其进行抽象，但我认为这会使示例不清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:46:08.703

我根本不会“缓存”“虚拟”属性，尤其是如果您不需要虚拟属性是“可设置的”，只需要“可获取”，这就是您的示例的样子。

```
 def event_date
    start_at.to_date.to_s(:db)   # yyyy-mm-dd 
  end
  def start_time
     "#{'%02d' % start_at.hour}:#{'%02d' % start_at.min}" 
  end
  def end_time
     "#{'%02d' % end_at.hour}:#{'%02d' % end_at.min}" 
  end 
```

一旦你开始缓存，你就不得不担心缓存值无效——你基本上有一个“缓存值无效”的问题。有几种方法可以使您的原始设计工作 - 但我认为在那里进行的计算不足以证明您正在做的记忆/缓存增加的复杂性。只需按需提供 em，您无需担心缓存值无效。

如果你真的很想做你最初建议的事情，这可能会让你开始：[回调改变的 ActiveRecord 属性？](https://stackoverflow.com/questions/1513991/callback-for-changed-activerecord-attributes) （不确定自从编写了stackoverflow以来Rails是否发生了变化）**

# linux - 使用数字的 Linux Case 语句

> ID：12080873
> 
> 赞同：0
> 
> 时间：2012-08-22T20:26:24.607
> 
> 标签：linux, numbers, parameter-passing, case

嗨，我正在尝试制作一个小脚本，我想从某个数字 ping 到我的子网，直到另一个特定数字，例如，2 美元和 3 美元不起作用。有任何想法吗？

```
code:
#!/bin/bash

while [ $# -lt 9000 ]
do
        case "$1" in 
        -$2-3) for i in 192.168.1.{$2..$3];do if ping -c1 -w1 &>/dev/null;then echo $i this one is up;fi; done
        shift shift;;

        -a) echo "hey just something random
       esac
done 
```

就像输出可能就像例如

> letstrythisbash.sh 65-74
> 192.168.1.65 这个是 up
> 192.168.1.69 这个是 up
> 192.168.1.72 这个是 up

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:31:13.297

你会想看看[`seq`命令](http://linux.die.net/man/1/seq)：

```
themel@kallisti: ~ $ for i in $(seq 69 73) ; do echo $i is a number ; done
69 is a number
70 is a number
71 is a number
72 is a number
73 is a number 
```

# javascript - onmousemove = null 在 IE 中不起作用

> ID：12080875
> 
> 赞同：0
> 
> 时间：2012-08-22T20:26:33.150
> 
> 标签：javascript, internet-explorer, events, drag

我试图找出在本机 javascript 中拖动是如何工作的。研究后我做了一个简单的javascript函数。

[http://jsfiddle.net/FKM5S/1/](http://jsfiddle.net/FKM5S/1/)

它在所有浏览器上都能正常工作，除了 IE！

问题是即使在设置之后我也可以拖动元素`document.onmousemove = null`

我什至无法提供一步一步的用例，因为它是随机发生的。

我在 google 上查看了其他 js 示例，他们也有同样的问题。其中之一是[http://ratfactor.com/misc/programming/simpledrag/test.html](http://ratfactor.com/misc/programming/simpledrag/test.html)

这是 IE 的已知问题还是有解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:31:45.857

通常`document.addEventListener("mousemove", eventHandler)`使用 . 添加和删除事件`document.removeEventListener("mousemove", eventHandler)`。
第一个参数是事件的类型，第二个参数是处理程序的名称。
不幸的是，据我所知，不可能删除匿名处理函数或计算处理函数。所以这**不起作用**：

```
document.addEventListener("mousemove", function() { eventHandler(); });
document.removeEventListener("mousemove", function() { eventHandler(); });

document.addEventListener("mousemove", getEventHandlerFunc());
document.removeEventListener("mousemove", getEventHandlerFunc()); 
```

您必须在`document.removeEventListener`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:40:41.297

尝试使用`document.onmousemove = function(){return false;}`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T22:09:06.473

我必须设置**onselectstart="return false;"** 在 IE 的 body 标签上。我认为这是造成问题的原因。虽然我还是没有头绪。。

# apache - CakePHP、CGI 和 mod_rewrite

> ID：12080876
> 
> 赞同：6
> 
> 时间：2012-08-22T20:26:34.547
> 
> 标签：apache, cakephp, mod-rewrite, cgi, cakephp-2.1

我必须在具有 CGI-PHP 的环境中运行我的 CakePHP 2.1 应用程序，并且不能声明 apache 别名。我想使用 mod_rewrite 将请求重定向到 CakePHP 的子域，但这不起作用。

**当前设置**

*   网络根是`~/user/public_html`
*   CakePHP 在`~/user/public_html/cakephp/`
*   CakePHP 应该在`dev.mydomain.tld`

到目前为止我所拥有的是这个（相对于 webroot 的所有路径）：

*   `~/user/public_html/.htaccess`

    ```
    RewriteEngine on
    Options +FollowSymlinks
    RewriteCond %{HTTP_HOST} ^(www\.)?dev\.mydomain.com$ [NC]
    RewriteCond %{REQUEST_URI} !^/cakephp/app/webroot/ [NC]
    RewriteCond %{REQUEST_URI} !/$
    RewriteCond %{DOCUMENT_ROOT}/cakephp/app/webroot%{REQUEST_URI}/ -d
    RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1/ [R,L]
    RewriteCond %{HTTP_HOST} ^(www\.)?dev\.mydomain.com$ [NC]
    RewriteCond %{REQUEST_URI} !^/cakephp/app/webroot/ [NC]
    RewriteRule ^(.*)$ /cakephp/app/webroot/$1 [L] 
    ```

*   `~/user/public_html/cakephp/app/webroot/.htaccess`

    ```
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ index.php [QSA,L] 
    ```

**问题**

请求以某种方式未正确路由（应用程序在我的开发环境中运行没有问题，PHP 作为一个模块和一个虚拟主机在该`/cakephp/app/webroot/`级别）。当我请求主页时，`dev.mydomain.tld`我只得到一个错误，Cake 告诉我，CakephpController 丢失了。

**调试信息**

*   调试的有趣部分`$_SERVER`作为第一行`/cakephp/app/webroot/index.php`

    ```
     [REDIRECT_REDIRECT_REDIRECT_STATUS] => 200
      [REDIRECT_REDIRECT_STATUS] => 200
      [REDIRECT_HANDLER] => php-script
      [REDIRECT_STATUS] => On
      [HTTP_HOST] => dev.mydomain.tld
      [HTTP_CONNECTION] => keep-alive
      [SERVER_SOFTWARE] => Apache/2.2.21 (Unix)
      [SERVER_NAME] => dev.mydomain.tld
      [SERVER_ADDR] => 192.0.43.10
      [SERVER_PORT] => 80
      [DOCUMENT_ROOT] => /home/user/public_html
      [SCRIPT_FILENAME] => /home/user/public_html/cakephp/app/webroot/index.php
      [REDIRECT_URL] => /cakephp/app/webroot/index.php
      [GATEWAY_INTERFACE] => CGI/1.1
      [SERVER_PROTOCOL] => HTTP/1.1
      [REQUEST_METHOD] => GET
      [QUERY_STRING] => 
      [REQUEST_URI] => /
      [SCRIPT_NAME] => /cakephp/app/webroot/index.php
      [_PHP5_WORK_DIR] => /home/user/public_html/cakephp/app/webroot
      [PHP_SELF] => /
      [ORIG_PATH_INFO] => 
      [ORIG_PATH_TRANSLATED] => /home/user/public_html/cakephp/app/webroot/index.php
      [PATH_INFO] => /cakephp/app/webroot/index.php 
    ```

*   `CakeRequest`传递给调度程序的对象的有趣部分：

    ```
     url => 'cakephp/app/webroot/index.php'
      base => '/cakephp'
      webroot => '/app/webroot/'
      here => '/cakephp/cakephp/app/webroot/index.php' 
    ```

**问题**

所以，我在这里没有得到什么，是为什么 CakeRequest 对象引用了我的文件夹结构，而`$_SERVER['REQUEST_URI'] == '/'`. 我该怎么做才能做到这一点？首先，我应该在哪里寻找问题：在 mod_rewrite 指令中还是在 CakePHP 本身中？我尝试了一些事情，包括在所有 .htaccess 文件中设置 RewriteBase 以及`App.baseUrl`在 Configuration 对象中设置不同的设置，但这里似乎没有任何帮助。

如果有人能给我指点如何解决这个问题，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T17:32:29.950

> 如果有人能给我指点如何解决这个问题，我将非常感激。

那我给你指点一下，因为我不知道答案。:)

您是否阅读过[这个问题](https://stackoverflow.com/questions/12050971/cakephp-app-webroot-not-found-when-installing-cakephp-on-apache-servor)，我遇到的问题与您的问题非常相似？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:03:41.423

/~username url 是用 mod_userdir 生成的，mod_rewrite 但是会去掉 ~ chars

所以使用默认的 cake htaccess 文件，并添加：

```
RewriteBase /~username/path/to/cake 
```

所有涉及的 htaccess 文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T23:37:43.263

传统上，将请求重定向到 CakePHP 应用程序的`/cakephp/app/`级别。

它希望解释`cakephp`为控制器名称的事实表明这是问题所在。

您的问题可能与 ALS 有关，但不完全相同。你真正想要的，因为你打算让你的 cakephp 应用程序看起来驻留在服务器的根目录，而实际上它不是：

```
RewriteBase / 
```

另一个潜在问题是您的开发环境永远不会受到`.htaccess`与`/cakephp/app`.

我会尝试首先添加相对于 /cakephp 文件夹的 RewriteBase

1.  在应用程序/.htaccess 中：`/`
2.  在 app/webroot/.htaccess 中：`/webroot/`

# jquery - 删除之前动态添加的类

> ID：12080880
> 
> 赞同：1
> 
> 时间：2012-08-22T20:26:58.163
> 
> 标签：jquery, addclass, removeclass

我正在使用此代码段根据其 id 添加一个类：

```
 $('.block').click(function() {
     $('#bg').addClass($(this).attr('id'));
    }); 
```

但是需要删除最后添加的类，如果添加了一个类，因为它在单击先前单击的按钮时会导致问题，因为当前（较高）类覆盖较低，如何实现？

[JFiddle 以便更好地理解](http://jsfiddle.net/neAcr/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:29:47.383

只需先使用 removeClass 清除 div 。

```
$('.block').click(function() {
 $('#bg').removeClass().addClass($(this).attr('id'));
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/neAcr/3/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:29:47.557

您可以使用以下`attr`方法：

```
$('.block').click(function() {
    $('#bg').attr('class', this.id);
}); 
```

[小提琴](http://jsfiddle.net/neAcr/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:35:22.740

你必须做这样的事情

```
$('.block').click(function() {
$('#bg').removeClass()
$('#bg').addClass($(this).attr('id'));    
});​ 
```

[小提琴链接](http://jsfiddle.net/neAcr/5/)

# c# - 如何扩展泛型？

> ID：12080886
> 
> 赞同：2
> 
> 时间：2012-08-22T20:27:25.230
> 
> 标签：c#, generics, active-directory

我创建了一个 Active Directory 服务来帮助我从 ASP.NET MVC 3 应用程序中管理基本任务（尽管实际上它可以是任何 .NET 应用程序，因为它位于单独的程序集中）。我有一个基本接口和类，`IActiveDirectoryService<TPrincipal>`并且`ActiveDirectoryService<TPrincipal>`. 这些被扩展一级到`IUserPrincipalService`and `UserPrincipalService`，如下所示：

```
IUserPrincipalService : IActiveDirectoryService<UserPrincipal> {
}

UserPrincipalService : ActiveDirectoryService<UserPrincipal>, IUserPrincipalService {
} 
```

`IUserPrincipalService`使用 Ninject 我创建了一个传入`PrincipalContext`我希望它使用的单例实例。这工作得很好，但我现在必须为每个要添加用户的 OU 创建多个实例，这不适用于 Ninject，因为名称会发生​​冲突。

我需要找到一种方法将我想要的特定 OU 传递给该服务。我考虑过将接口扩展为类似的东西，`ICityStateUserPrincipalService : IUserPrincipalService`并用 Ninject 更改构造函数。这样做的问题是，我必须为我们现在拥有的每个 OU（恰好是七个）提供这些服务之一。另外，将来如果我们需要添加一个新的OU，我必须在AD中创建它，然后为它创建一个新的接口。

这只是感觉不对。它还必须在 ASP.NET MVC 3 应用程序中完成，这感觉就像它增加了膨胀和作弊。我无法将它添加到包含当前服务的程序集中，因为我想保留它的通用性，以防我需要在不同的项目中使用它。

有没有办法既保留我现在拥有的东西，又使其可扩展，以便我可以通过特定 OU 的路径？

问题的标题可能根本不是很好。我愿意接受改变它的建议，我只是不知道如何表达它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T20:43:47.013

您可以添加一个`IOUProvider`接口来注入您的服务。IOUProvider 接口决定了`IActiveDirectoryService`应该关注哪些 OU。

我在下面删除了一个示例并省略了，`TPrincipal`因为我认为它与 an 的概念无关`IOUProvider`

```
public interface IOUProvider
{
        IEnumerable<OUInfo> GetOUs();
}    

public interface IActiveDirectoryService
{
    IOUProvider RelevantOUProvider { get; }
    IPrincipal FindPrincipals();
}

public class ActiveDirectoryService : IActiveDirectoryService
{
       public ActiveDirectoryService(IOUProvider relevantOuProvider)
       {
       }
} 
```

# r - R图形窗口中的鼠标移动

> ID：12080896
> 
> 赞同：1
> 
> 时间：2012-08-22T20:27:50.047
> 
> 标签：r

谁能告诉我一种获取鼠标移动事件的方法？我正在尝试制作可缩放的时间序列图

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:51:25.063

这是一个已经写好的“可缩放时间序列图”

```
library(quantmod)
getSymbols("SPY", src='yahoo')
chartSeries(SPY) 
```

现在，您可以使用以下任一方式进行缩放`zoomChart`

```
zoomChart("last 6 months") 
```

或者，您可以使用该`zooom`功能

```
zooom() 
```

现在单击图表上的某个位置，然后单击图表上第一次单击位置右侧的其他位置，它将使用您单击的位置作为新的开始和结束进行放大。

您可以`zoomChart`像这样使用空字符串来“取消缩放”

```
zoomChart("") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:54:25.773

如果您使用的是 Windows，那么您可以使用`getGraphicsEvent`获取鼠标移动，否则（甚至使用 Windows）您需要使用类似`tcltk`包的东西。如果您只关心鼠标点击，那么您可以使用`locator`.

可能更可取的是使用包中的`tkexamp`功能`TeachingDemos`来设置可以使用滑块滚动/缩放的绘图。还有其他提供类似功能的软件包，但我对它们不太熟悉。

# node.js - 在 IE 中使用 XHR 轮询的 Socket.IO

> ID：12080902
> 
> 赞同：4
> 
> 时间：2012-08-22T20:28:18.953
> 
> 标签：node.js, socket.io

我正在使用 NodeJS 和 Socket.IO 来实现我的服务器和客户端之间的持久连接。Socket.IO 服务器本身连接到另一个 PHP 服务器，该服务器处理传入的消息并将结果发送回 NodeJS。在那里，消息被稍微修改并发送回客户端。

到目前为止，一切正常。Chrome、Firefox 和 Opera 正在使用本机 websockets，并且所有消息都可以正确接收。

但是，Internet Explorer 和 Iceweasel 正在使用 XHR-polling 回退，它的行为有点奇怪……客户端恰好收到两条消息，之后客户端可以向服务器发送消息，但没有消息被发送回客户端。从 XHR 客户端发送的消息被正确接收和处理 - 每个**websocket**客户端都会收到发送的消息。

在 Socket.IO 中使用 loglevel 3 我得到以下输出：

```
debug: clearing poll timeout
debug: xhr-polling writing 5:::{"message":"..."}
debug: set close timeout for client VjrHOXHjjg76bD_qx46C
debug: setting request GET /socket.io/1/xhr-polling/VjrHOXHjjg76bD_qx46C?t=1345663246573
debug: setting poll timeout
debug: clearing poll timeout
debug: xhr-polling writing �262�5:::{"message":"another message ..."}�200�5:::{"message":"message #3 ..."}
debug: set close timeout for client VjrHOXHjjg76bD_qx46C
debug: discarding transport
debug: cleared close timeout for client VjrHOXHjjg76bD_qx46C 
```

XHR 客户端接收到第一条消息（日志行#2），但行#7 中的那些消息消失了。我还注意到第 7 行中的特殊字符，但我不知道它们是否对错误负责。

向服务器发送消息时，调试输出为：

```
debug - xhr-polling received data packet 5:::{"message":"input by the client"} 
```

此消息也不会发送回 XHR 客户端，但每个连接的 websocket 客户端都会收到它。

更疯狂的是，如果我打开开发工具 (F12)，在 IE 中一切正常。

连接到 PHP 服务器本身的 NodeJS 客户端非常简单（使用 simpletcp 库）：

```
// Client is the simpletcp-client
client.on("data", function(data) {

    var msgData;

    try {
        msgData = JSON.parse(data.toString("utf8"));
    } catch(e) {

        console.log("JSON-parse error!");
        return;
    }

    var socket = getsock(msgData.sid); // msgData.sid is the socket.id to identify the socket

    if(socket == null) {
        console.log("Client not found!");
        return;
    }

    socket.emit("message", { "message" : msgData.message });
}); 
```

我现在要问的是 - 这是一个 Socket.IO 错误还是我的脚本中有问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T21:01:50.653

> 更疯狂的是，如果我打开开发工具 (F12)，在 IE 中一切正常。

一点也不疯狂。`console`在您打开开发工具之前，Internet Explorer 没有对象（`console.log`抛出阻止您的代码的异常）。删除所有`console.log`行，看看它是否有效。如果要调试脚本，则应编写自己的自定义调试工具。这是一个简单的例子：

```
window.debug = function() {
    if (window.console && window.console.log) {
        window.console.log.apply( window.console, arguments );
    }
}
debug("JSON-parse error!"); 
```

让我们知道它是否有效。

# javascript - Facebook Javascript SDK：发布到提要时验证访问令牌时出错

> ID：12080904
> 
> 赞同：2
> 
> 时间：2012-08-22T20:28:21.480
> 
> 标签：javascript, facebook, authentication, feed, posting

我正在尝试从我的网站发布到用户的提要。我正在使用 Javascript SDK 并设法让自己登录，并授予了 publish_stream 和 publish_actions 权限。但是，当我调用 /me/feed 发布操作时，我收到以下错误作为响应：

```
code: 190
error_subcode: 467
message: "Error validating access token: This may be because the user logged out or may be due to a system error." 
```

我从这里使用客户端身份验证模型：

[https://developers.facebook.com/docs/authentication/client-side/](https://developers.facebook.com/docs/authentication/client-side/)

这是我正在使用的 FB.api 提要邮政编码：

```
FB.api('/me/feed', 'post', { message: 'Testing FB feed posting' }, function(response) {
if (!response || response.error) {
    alert('Error');
        console.log(response);
    }
    else {
        alert('Posted');
    }
}); 
```

我检查了应用程序设置并且域设置正确。我还仔细检查了我是否有权发表这篇文章。谁能看到我要去哪里错了？

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:44:41.777

尝试检查 FB.getLoginStatus(function(response) { //do code here });

# c - 在带有文件描述符的 execl 中使用 grep

> ID：12080905
> 
> 赞同：0
> 
> 时间：2012-08-22T20:28:22.813
> 
> 标签：c, grep, exec, file-descriptor, unistd.h

我正在尝试执行以下操作：

```
 execl("/bin/grep","grep","print",fd,NULL); 
```

其中 fd 是文件描述符。所以基本上这应该在 fd 指向的文件中 grep 为“打印”。尽管我没有收到编译错误/警告，但它似乎不起作用。当我给出一个文件名`"Something.txt"`而不是`fd`

有人可以告诉我为什么这不起作用吗？（我知道 execl 只需要，`const char arg*`但正如我所说，没有编译错误/警告）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T20:31:39.280

有2个问题：

*   你引诱`execl`使用一个小整数作为指针
*   您期望`grep`了解文件描述符

如果我正确理解您的问题，就在您之前`exec`，您应该将描述符重定向到`STDIN_FILENO`. 就像是：

```
dup2(fd, STDIN_FILENO);
execl("/bin/grep", "grep", "print", NULL); 
```

这应该可以工作，因为`grep`在没有提供输入文件时会分析其标准输入。

# elmah - 将 Elmah 与 ServiceStack.Mvc 一起使用

> ID：12080911
> 
> 赞同：3
> 
> 时间：2012-08-22T20:28:49.927
> 
> 标签：elmah, servicestack

我在 /elmah.axd 路径上看不到未处理的异常 (MyService:RestServiceBase)。

我添加了用于查看错误的 http 处理程序。

```
 <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" /> 
```

我已经安装了 ServiceStack.Logging.Elmah

**更新**

我也安装了 Elmah.Mvc 包

我可以在控制器的操作中得到错误，但我无法得到服务错误！

**更新**

我并不孤单:) [https://groups.google.com/forum/#!topic/servicestack/WSrM5CLL120](https://groups.google.com/forum/#!topic/servicestack/WSrM5CLL120)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T19:20:26.513

您需要订阅通常位于 AppHost 类`AppHostBase.ServiceExceptionHandler`中的方法中的事件：`Configure`

```
public class AppHost : AppHostBase
{
    ....

    public override void Configure(Funq.Container container)
    {
        ServiceExceptionHandler += (request, exception) =>
        {
            //pass the exception over to Elmah
            var context = HttpContext.Current;
            Elmah.ErrorLog.GetDefault(context).Log(new Error(exception, context));

            //call default exception handler or prepare your own custom response
            return DtoUtils.HandleException(this, request, exception);
        };
    }

    ....
} 
```

# jquery - 遍历 jQuery 中的文本字符串

> ID：12080915
> 
> 赞同：0
> 
> 时间：2012-08-22T20:29:01.233
> 
> 标签：jquery, string, iteration

我正在编写一个位代码代码，它将根据用户输入计算个性化产品的价格。在这种情况下，他们可以选择出现在成品中的消息（“生日快乐”或“周年快乐”或类似的东西）。

价格应根据消息中的字符数计算。因此，每个字符的价格应该增加 4 英镑，但每个空格只能增加 2 英镑。

我在让我的代码遍历每个字符以确定它应该收费多少时遇到问题。有什么想法我哪里出错了吗？

如果我的解释不够清楚，这可能会有所帮助。 [http://jsfiddle.net/6QhAz/1/](http://jsfiddle.net/6QhAz/1/)

代码：

```
$(document).ready(function () {
  jQuery("#phrase").keyup(function () {     
    var length = this.value.length; 
    var price;
    var message =jQuery("#phrase").val;
    for ( var i=0; i > length; i++) {
      if (this.value === " " ) {
        price + 1.50;                       
      } else {
        price + 2.50;
      };
    };

    jQuery("#price").html('Price: &pound;'+price);
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:32:08.040

而不是遍历字符，只需使用正则表达式来计算它们：

```
$(document).ready(function()  {
    $("#phrase").keyup(function() {      
        var value = $(this).val();
        var spaces = (value.match(/\s/g) || []).length;

        var price = 1.5 * spaces + 2.5 * (value.length - spaces);

        $("#price").html('Price: &pound;' + price);
    });
});​ 
```

**演示：http: [//jsfiddle.net/6QhAz/6/](http://jsfiddle.net/6QhAz/6/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:32:00.113

您可以使用字符串的方法逐个字母地遍历`charAt`字符串：

```
var name_str = "hello world!";
for (var i=0; i < name_str.length; i++) {
    alert(name_str.charAt(i));
} 
```

现场示例：http: [//jsfiddle.net/dM7Vd/](http://jsfiddle.net/dM7Vd/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T20:36:00.677

```
 $("#phrase").keyup( function () {    
            var message =$("#phrase").val();        
            var length = message.length; 
            var price = 0;

            for ( var i=0; i < length; i++) {
                if (message.charAt(i) == " " ) {
                    price += 1.50;                       
                } else {
                    price += 2.50;
                };

            };

            $("#price").html('Price: &pound;'+price);

    }); 
```

# asp.net - 使用下拉列表 HTML 帮助程序时出错

> ID：12080919
> 
> 赞同：0
> 
> 时间：2012-08-22T20:29:23.850
> 
> 标签：asp.net, vb.net, asp.net-mvc-2

在我的控制器中，我定义了选择列表项并将列表传递给视图

```
Dim mySelectItems = New List(Of SelectListItem) From {
    New SelectListItem With {.Text = "First item", .Value = "1", .Selected = True}
}

ViewData("doctorList") = mySelectItems 
```

现在，在我看来，我正在尝试使用 HTML Helper 将值输入到下拉列表中。

```
<label for="appointment_doctor">Select Doctor</label>
<%= Html.DropDownList("doctor", ViewData("doctorList"))%> 
```

现在，我认为这应该可行，但事实并非如此。

错误日志：

> 重载解析失败，因为没有缩小转换就无法调用可访问的“DropDownList”：扩展方法“Public Function DropDownList(name As String, selectList As System.Collections.Generic.IEnumerable(Of System.Web.Mvc.SelectListItem)) As System 'System.Web.Mvc.Html.SelectExtensions' 中定义的 .Web.Mvc.MvcHtmlString'：参数匹配参数 'selectList' 从 'Object' 缩小到 'System.Collections.Generic.IEnumerable(Of System.Web.Mvc.SelectListItem )'。扩展方法 'Public Function DropDownList(name As String, optionLabel As String) As System.Web.Mvc.MvcHtmlString' 在 'System.Web.Mvc.Html.SelectExtensions' 中定义：参数匹配参数 'optionLabel' 从 'Object' 缩小到'细绳'。G：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:30:55.760

尝试铸造：

```
<%= Html.DropDownList(
    "doctor", 
    CType(ViewData("doctorList"), IEnumerable(Of SelectListItem)) 
) %> 
```

强制转换是必要的，因为 ViewBag 是动态类型，扩展方法（例如`DropDownList`）不能使用动态参数进行调度。

顺便说一句，这也是我更喜欢使用视图模型而不是 ViewBag 的数百万个原因之一。它还允许您使用强类型版本的帮助器：

```
<%= Html.DropDownList(
    Function(x) x.SelectedDoctorId, 
    Model.Doctors 
) %> 
```

* * *

更新：

根据评论部分的要求，这里是使用视图模型的完整示例。

与往常一样，在 ASP.NET MVC 应用程序中，我们首先定义我们的视图模型类，该类将反映您的视图的要求，从您的描述到目前为止，我了解到它应该显示医生的下拉列表。您可能显然需要使用其他属性来丰富此视图模型，以反映您的特定视图要求：

```
Public Class DoctorViewModel
    Property SelectedDoctorId As Integer
    Property Doctors As IEnumerable(Of SelectListItem)
End Class 
```

然后你可以有一个控制器动作来填充这个视图模型并将它传递给视图：

```
Public Class HomeController
    Inherits System.Web.Mvc.Controller

    Function Index() As ActionResult
        Dim model = New DoctorViewModel()

        ' TODO: those could come from a database or something
        ' I am hardcoding the values here for better understanding
        model.Doctors = {
            New SelectListItem With {.Value = "1", .Text = "doctor 1"},
            New SelectListItem With {.Value = "2", .Text = "doctor 2"},
            New SelectListItem With {.Value = "3", .Text = "doctor 3"}
        }

        Return View(model)
    End Function
End Class 
```

最后你会得到一个对应的强类型视图（`~/Views/Home/Index.aspx`）：

```
<%@ Page 
    Language="VB" 
    MasterPageFile="~/Views/Shared/Site.Master" 
    Inherits="System.Web.Mvc.ViewPage(Of ToDD.DoctorViewModel)" %>

<asp:Content ID="indexTitle" ContentPlaceHolderID="TitleContent" runat="server">
    Home Page
</asp:Content>

<asp:Content ID="indexContent" ContentPlaceHolderID="MainContent" runat="server">

    <%= Html.DropDownListFor(Function(x) x.SelectedDoctorId, Model.Doctors) %>

</asp:Content> 
```

# javascript - javascript 到 jQuery 中的事件监听器

> ID：12080930
> 
> 赞同：0
> 
> 时间：2012-08-22T20:30:18.023
> 
> 标签：javascript, jquery, function, addeventlistener

我有一个代码，它为我的每个名为“CheckAll”的按钮添加了全选切换我最近遇到了一个问题，即 IE 浏览器中的按钮不起作用，我发现 addEventListener 在 IE 中不起作用，并且您必须使用 attachEvent，但是有些人说这也会产生后果，他们推荐使用 jQuery。那么有人可以演示我的 JavaScript 的 jQuery 版本吗？这是代码

```
function script1(){
var el = document.getElementsByName('CheckAll');  
el1 = el[0];  
el2 = el[1];
el3 = el[2];
el4 = el[3];
el5 = el[4];
el6 = el[5];
el7 = el[6];

el1.addEventListener('click', function(){selectAll(0,8)}, false);
el2.addEventListener('click', function(){selectAll(8,16)}, false);
el3.addEventListener('click', function(){selectAll(16,26)}, false);
el4.addEventListener('click', function(){selectAll(26,34)}, false);
el5.addEventListener('click', function(){selectAll(34,44)}, false);
el6.addEventListener('click', function(){selectAll(44,52)}, false);
el7.addEventListener('click', function(){selectAll(52,60)}, false);

} 
```

这是一个 jfiddle [fiddle](http://jsfiddle.net/VHXDx/4/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:37:53.740

在 jQuery 中，有一个简单的函数来绑定事件：`.on`. `$`您可以使用使用 CSS 表示法的函数选择元素：http: [//jsfiddle.net/VHXDx/11/](http://jsfiddle.net/VHXDx/11/)。这将是所有需要的，没有`selectAll`功能：

```
// run when elements are available
$(function() {
    // select the `CheckAll` buttons and run a function for each one
    $("input[name='CheckAll']").each(function(i) {  // `i` is a counter
        // bind event
        $(this).on("click", function() {
            // select `AG[]` elements in the current row and toggle their checked property
            $(this).closest("tr").find("[name='AG[]']").prop("checked", function(j, current) {
                return !current;
            });
        });
    });
}​);​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-22T20:39:58.820

```
function script1(){
    var el = $('[name="CheckAll"]');
    el.on('click', function() {
        $(this).closest('td').siblings().find('input[name="AG[]"]').each(function(i,e) {
            e.checked = !e.checked;
        });
    });
} 
```

[**小提琴**](http://jsfiddle.net/VHXDx/12/)[](http://jsfiddle.net/VHXDx/12/)

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T20:50:54.403

为什么不使用`attachEvent`？您可以轻松构建一个[简单的跨浏览器`addEvent`功能](http://quirksmode.org/js/eventSimple.html)，而无需使用 jQuery。

```
var add = document.addEventListener ? function(el, type, fn) {
    el.addEventListener(type, fn, false);
} : function(el, type, fn) {
    el.attachEvent("on"+type, fn.bind(el), false);
};

function script1(){
    var els = document.getElementsByName('CheckAll');
    var a = 1, b = 0;
    for (var i=0; i<els.length; i++) {
        a *= -1;
        add(els[i], 'click', selectAll.bind(null, b, b+= 9+a));
    }
} 
```**

# c#-2.0 - 无法在 C# 中应用夏令时更改

> ID：12080933
> 
> 赞同：0
> 
> 时间：2012-08-22T20:30:30.123
> 
> 标签：c#-2.0

我正在尝试解决夏令时问题。该代码将在嵌入在 .net 2.0 fw 下的 Windows XP 上运行。除了一个小问题，我一切正常。要求是以编程方式在 TimeDate.cpl 面板中设置夏令时设置，该面板就是您设置日期和时间的窗口。我发现这样做的唯一方法是创建一个注册表项，这确实有效。但是，在您实际打开 TimeDate 窗口、单击时区面板并点击应用之前，它不会生效。即使重新启动也不会这样做。我的问题是：有没有办法让我的 C# 应用程序打开 TimeDate 窗口并单击应用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:36:50.630

可能不会，因为你一开始就做错了。:-)

~~正确的做法是使用 API 函数[`SetDaylightTime`](http://msdn.microsoft.com/en-us/library/ee488917%28v=winembedded.60%29.aspx)，该函数接受一个参数，指示夏令时是否在本地时区生效。~~显然，上面引用的函数在 XP Embedded 上不可用。其余的都是有效的，AFAIK。

要使用注册表，您不需要 TimeDate 控制面板小程序；[您可以使用夏令时注册表设置](http://msdn.microsoft.com/en-us/library/ee488379%28v=winembedded.60%29.aspx)中的代码示例直接在代码中执行此操作。注意`RegFlushKey`代码中的调用；他们使更改持久化。另请注意，它提到更改会在下次重新启动时生效，而不是立即生效；这也是 WinXP 桌面（以及 Vista/Win7，IIRC）的工作方式。

# objective-c - NSMutableAttributedString 的自动换行

> ID：12080942
> 
> 赞同：10
> 
> 时间：2012-08-22T20:31:08.033
> 
> 标签：objective-c, ios, xcode, ios5, nsstring

我有 NSMutableAttributedString 并且字符串很长。我想在 UIlabel 上显示时进行自动换行。如果是 NSString，我会继续做这样 [的事情，Dynamic UILabel 截断文本](https://stackoverflow.com/questions/11558956/dynamic-uilabel-truncating-the-text) 但是我怎么能用 NSAttributedString 来做呢？完成后，我需要根据标签大小调整视图大小。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-02-03T10:10:26.940

lineBreakMode 属性在 iOS 6 中并未被弃用。它只是更改了常量的名称。旧的常量已被弃用，但仍然可用。即使您正在部署到较旧的 iOS，您也可以使用新常量，因为常量只是枚举值。旧名称和新名称具有相同的值。因此，只需设置 yourlabelname.lineBreakMode = NSLineBreakByTruncatingTail。

```
NSMutableParagraphStyle *paragraphStyle = [[NSMutableParagraphStyle alloc] init];
[paragraphStyle setLineBreakMode:NSLineBreakByTruncatingTail];
[attributedStr addAttribute:NSParagraphStyleAttributeName
                     value:paragraphStyle
                     range:NSMakeRange(0,[attributedStr length])]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-10T11:30:02.737

`attributedText`无论使用文本还是普通文本，以下操作也都有效。确保在将 and 字体设置为标签***后***添加以下行。`AttributedText`

```
label.lineBreakMode = .byTruncatingTail 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-09T13:13:26.197

在更新属性文本字段后设置以下属性：

```
titleLabel.lineBreakMode = NSLineBreakByTruncatingTail; 
```

# drupal-7 - Drupal 7 - 在内容类型字段中保存用户 ID

> ID：12080951
> 
> 赞同：0
> 
> 时间：2012-08-22T20:31:56.113
> 
> 标签：drupal-7, drupal-modules

提交表单后，我需要在自定义内容类型的 int 字段上写入 Drupal 用户 ID。我相信我必须使用 hook_node_presave 来做到这一点。但是我是 Drupal 的新手，对 PHP 非常陌生，所以，我有一些基本的问题......

1.  在我的 Drupal 安装中，我必须在哪里插入挂钩代码？在什么文件里？一个新的？什么目录？我希望这段代码完全与主题无关，与升级无关，与新手无关...
2.  任何人都可以花一点宝贵的时间为这个任务编写一个代码示例吗？
3.  如前所述，我是新手。所以，非常欢迎详细的解释！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:41:47.613

你想要的是写一个 Drupal[模块](http://drupal.org/developing/modules)

基本上，您需要在其中添加一个文件夹和一些必需的文件。然后你进入管理并打开模块。一旦打开，Drupal 将自动开始处理您在该模块中指定的钩子。更多信息[在这里](http://drupal.org/node/1075072)

在 Drupal 世界中，大多数代码更改都是以这种方式完成的。另一个地方是覆盖主题设置，但正如您所说，您希望使其与主题无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-29T02:28:55.443

所有节点都会自动使用创建节点的用户的用户 ID 保存，因此如果您想知道是谁创建了节点，只需查看 $node->uid。无需在您的内容类型中保存额外的字段。希望有帮助。

# python - 用不同的键对嵌套字典中的项目求和

> ID：12080957
> 
> 赞同：4
> 
> 时间：2012-08-22T20:32:09.440
> 
> 标签：python, dictionary

我有一个嵌套字典，内容如下：

```
{'apple':  {'a': 1, 'b': 4, 'c': 2},
 'orange': {'a': 4, 'c': 5},
 'pear':   {'a': 1, 'b': 2}} 
```

我想要做的是摆脱外部键并对内部键的值求和，以便我有一个新字典，如下所示：

```
{'a': 6, 'b': 6, 'c': 7} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-22T20:36:07.900

您可以使用[Counter](http://docs.python.org/library/collections.html#collections.Counter)类：

```
>>> from collections import Counter

>>> d = {'apple': {'a': 1, 'b': 4, 'c': 2}, 'orange': {'a': 4, 'c': 5}, 'pear': {'a': 1, 'b': 2}}
>>> sum(map(Counter, d.values()), Counter())
Counter({'c': 7, 'a': 6, 'b': 6}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-22T20:34:48.880

```
from collections import defaultdict
d = defaultdict(int)
for dct in yourdict.values():
    for k,v in dct.items():
        d[k] += v 
```

这个答案的主要优点是它可以追溯到python2.5。对于 python2.7+，请参阅 @DSM 和 @BigYellowCactus 发布的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-22T20:43:26.673

这是另一种[`collections.Counter`](http://docs.python.org/library/collections.html#counter-objects)解决方案，它不像其他解决方案那样是单行的，但我认为它更清洁：

```
from collections import Counter
d = {'apple': {'a': 1, 'b': 4, 'c': 2}, 'orange': {'a': 4, 'c': 5}, 'pear': {'a': 1, 'b': 2}}

counts = Counter()
for v in d.values():
    counts.update(v) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-22T20:35:25.020

[Counter](http://docs.python.org/library/collections.html#counter-objects)对象旨在使这样的事情变得非常简单：

```
>>> from collections import Counter
>>> d = {'apple': {'a': 1, 'b': 4, 'c': 2}, 'orange': {'a': 4, 'c': 5}, 'pear': {'a': 1, 'b': 2}}
>>> sum((Counter(v) for v in d.itervalues()), Counter())
Counter({'c': 7, 'a': 6, 'b': 6}) 
```

# xml - 在 XML 中使用逻辑

> ID：12080959
> 
> 赞同：0
> 
> 时间：2012-08-22T20:32:12.327
> 
> 标签：xml

我基本上想要我的 XML 中的以下逻辑

obj 必须是 ((MASTER || PART) && (Drawing))

这似乎不起作用

```
<adapt type="com.teamcenter.rac.kernel.TCComponent">
       <or>
          <test property="type"
               value="MASTER">
          </test>
          <test property="type"
               value="UGPART">
          </test>
       </or>
       <and>
          <test property="DRAWING"
                value= "">
          </test>
       </and>       
  </adapt> 
```

它必须是以下之一（MASTER 或 PART）并且是 DRAWING 我主要担心如何将该逻辑添加到上面的 XML

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T01:56:15.687

假设您的 XML 元素和属性具有明显的含义，我希望捕获含义的正确方法`((MASTER || PART) && (Drawing))`是

```
<adapt type="com.teamcenter.rac.kernel.TCComponent">
  <and>
    <or>
      <test property="type"
            value="MASTER">
      </test>
      <test property="type"
            value="UGPART">
      </test>
    </or>
    <test property="DRAWING"
          value= "">
    </test>
  </and>       
</adapt> 
```

但这纯粹是猜测，因为我不知道哪些软件无法理解您要说的内容。

# android - Android，创建一个 XML 文件，安装应用后有人可以修改该文件

> ID：12080960
> 
> 赞同：0
> 
> 时间：2012-08-22T20:32:13.470
> 
> 标签：android

我正在制作一个使用 Google Cloud Messaging 的应用程序。我想这样做，以便我可以从 XML 文件中检索字符串“SERVER_URL”，并且能够在不重新安装应用程序的情况下修改该字符串。

*这样;*

> 用户从手机中取出存储卡，将其放入计算机，他们现在可以浏览该存储卡以查找 XML 文件并修改字符串 SERVER_URL。

..在做了一些研究之后，我不确定我是否可以在不进行某种反编译的情况下访问已安装的 Android 应用程序上的任何 XML 数据（我也无法在存储卡上找到任何可读的内容）。我最初的意图是将这个值简单地放在 android 应用程序的“strings.xml”中。任何有关如何做到这一点的帮助将不胜感激，即使只是肯定知道我正在尝试做的事情实际上肯定是不可能的。

**为什么我要这样？**

这个 SERVER_URL 值有可能发生变化（试点项目，东西不断被移动），导致需要修改应用程序并在所有手机上重新安装。我们希望避免这样做，而只是修改该文件。

但是，我们不希望向应用程序添加功能以允许您在应用程序本身中更改 SERVER_URL，以便用户在玩手机时不会轻易意外地更改此值（智障用户，看护人会做文件修改）。

谢谢，

韦斯

注意：这是我在这个网站上的第一篇文章！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T21:14:37.427

这是我在这个网站上的第一个答案！

好吧，您尝试做的是开箱即​​用的配置值。由于该应用程序是关于使用 Internet 资源的，您为什么不创建一个 Web 服务/站点，管理员可以在其中进行必要的更改，并且您的应用程序可以在连接时间使用该值。

因此，服务器的地址可以随版本而变化，所做的一切对用户来说都是透明的。

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T21:00:27.260

1.  将设置放在资产文件夹中的 xml 文件中。
2.  当应用程序启动时，检查设置文件是否存在于 SDCard 上所需的文件夹中。如果不是，请从资产中复制它。
3.  从您的 SDCard 文件夹中读取设置，以便任何更改都会自动反映在应用程序中。

但是，我建议您将设置放入您的应用程序本身并使用两种机制中的任何一种 -

1.  当设置更改时发布应用程序的更新并要求用户更新。
2.  将设置存储在数据库或内部文件中，并使用后台服务或 C2DM 从服务器定期更新。

# php - HTTP - 如何在长时间运行的进程中更新用户

> ID：12080970
> 
> 赞同：0
> 
> 时间：2012-08-22T20:32:51.470
> 
> 标签：php, http

所以今天我在维护一些旧代码，并且遇到了一种更新 UI 的方法，该方法可以用于我不熟悉的长时间运行的进程。

基本上，导入器会处理数千行 CSV 数据，并（在 PHP 中）在每个阶段回显标记。标记本身显示在包含在常规页面中的 iframe 中。

这种方法是否可行/可靠，还是处理这种情况的更好方法？

让一个 HTTP 请求保持打开状态只是为了缓慢返回 html（进度信息），这感觉有点不对劲。但是有更好的方法吗？

（我维护的代码是 PHP，但我想这不是重点）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:47:25.987

如果你需要你可以尝试做 ie`printf("done %d of %d", $done, $toDo); flush();`并且不需要框架。关键是`flush();`

# themes - Plone 4.2 - 重氮 - rules.xml

> ID：12080971
> 
> 赞同：1
> 
> 时间：2012-08-22T20:32:53.647
> 
> 标签：themes, plone, diazo

我正在尝试在 plone 4.2 上使用重氮创建主题。

### 错误信息 ：

*“IOError：读取文件'/++theme++optilux.theme/rules.xml'时出错**：**无法加载外部实体“/++theme++optilux.theme/rules.xml””*

### 配置文件 buildout.cfg 包含：

```
extends =
http://good-py.appspot.com/release/plone.app.theming/1.0b8?plone=4.1 
```

### 配置文件 configure.zcml 包含：

```
<!-- Register the /++theme++optilux.theme/ static resource directory -->
<plone:static
   directory="resources"
   type="theme"
   /> 
```

### 目录 ：

```
--> pwd
/usr/local/Plone/zeocluster/src/optilux.theme/optilux/theme
--> ls -l
total 20
-rw-r--r-- 1 root root 1113 aoÃ»  9 16:09 configure.zcml
-rw-r--r-- 1 root root  119 jui 10 21:40 __init__.py
drwxr-xr-x 3 root root 4096 jui 10 21:40 profiles
drwxr-xr-x 4 root root 4096 aoÃ»  9 14:57 resources
-rw-r--r-- 1 root root 1383 jui 10 21:40 tests.py 
```

### 资源目录：ls -l

```
total 20
-rw-r--r-- 1 root root 5373 jui 11 21:48 index.html
drwxr-xr-x 2 root root 4096 jui 12 21:49 overrides
-rw-r--r-- 1 root root 3322 jui 12 21:44 rules.xml
drwxr-xr-x 2 root root 4096 jui 11 21:52 stylesheets 
```

我希望把所有需要的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T01:10:19.823

我可以想到两件事来尝试：

1)**确认您使用的是 Plone 4.2** -`plone.app.theming`是 Plone 4.2 的一部分，因此您不需要在构建中引用`http://good-py.appspot.com`。该`buildout.cfg`文件应该开始：

```
[buildout]
extends =
    http://dist.plone.org/release/4.2/versions.cfg 
```

2)**检查文件/目录权限和所有权**- 看起来您已经使用统一安装程序以 root 身份安装了 Plone。在这种情况下，我希望[文件归`plone`用户](https://github.com/plone/Installers-UnifiedInstaller/blob/master/README.txt#L382-387)所有。确保您的文件的权限和所有者与安装程序创建的文件相匹配（例如 中的内容`buildout-cache`）。

# delphi - Delphi 应用程序拨打IP 电话。[像拨号器.exe]

> ID：12080975
> 
> 赞同：1
> 
> 时间：2012-08-22T20:33:12.227
> 
> 标签：delphi, voip, tapi

我对 Delphi TAPI 和电话集成有点陌生。所以请原谅我的青涩。我正在尝试让 Delphi [XE2] 应用程序在不使用 Dialer.exe 的情况下拨打我的 IP 电话

我已经成功实现了 ITRequest::MakeCall 方法，但这会将调用传递给拨号程序。

有没有办法绕过拨号器并直接向我的电话提供商发送呼叫？

我的电话提供商是 Jive Desktop TSP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T08:40:06.217

你的问题有点老了，但如果你仍然感兴趣，我想我可以提供帮助。

你想要的其实很简单。[您可以通过电话服务的Tapi 2.0 界面](http://msdn.microsoft.com/en-us/library/windows/desktop/ms734257%28v=vs.85%29.aspx)使用您的提供商的 TSP 。这是一本好书，可能令人沮丧，因为它处理了您不需要的各种功能。您只需要调用“LineInitializeEx”、“LineOpen”和“LineMakeCall”。就是这样（虽然关闭你也应该调用 LineClose 和 LineShutDown）。这些函数调用都可以在称为 Tapi 浏览器的接口测试工具中使用。从[这个](http://www.tapi.info/)网站下载[。](http://www.tapi.info/downloads/Tb20.zip)

此外，您需要接口的 Delphi 实现。您可以从此处的 Jedi 项目[下载](http://www.consoftonline.com/backup/BackupDelphi/Delphi7Apps/DelphiInformant/July98/Tapi/TAPI.PAS)。最后一点：在使用较旧的实现时要小心，因为大多数将是 Delphi2010 之前的版本，并且可能有 ansistring 类型的字符串。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T21:22:51.750

这里的关键搜索词是 SIP。[您需要一个支持 SIP 电话的 Delphi 库，这与 TAPI 支持的电话线不同，并且此](https://stackoverflow.com/questions/7349565/are-there-any-good-delphi-voip-sip-sdk-library-component)Stack Overflow 答案中列出了许多此类库。我在[sipcomponents.com](http://sipcomponents.com)的库上取得了很好的成功，它不是早期列表中包含的库之一。

# c++ - 可能的内存泄漏

> ID：12080978
> 
> 赞同：1
> 
> 时间：2012-08-22T20:33:47.963
> 
> 标签：c++, python, cpython, python-embedding, python-extensions

有人可以检查是否存在内存泄漏吗？我很困惑。

```
PyObject * somefunc(int function_id, int num_params, int * params){
    PyObject * params_list=PyList_New(0);
        for(int i=0; i < num_params; i++){
             PyObject * val = Py_BuildValue("i", params[i]);
             PyList_Append(params_list, val);
             Py_DecRef(val);
        }

        PyObject * arglist = Py_BuildValue("(i,O)",
            function_id, params_list);
         //Should I DecRef(params_list) ??

        return arglist;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T03:23:10.117

如[C API 文档](http://docs.python.org/c-api/arg.html#Py_BuildValue)中所述，`O`格式代码`Py_BuildValue`增加其参数的引用计数，因此您正在泄漏对`params_list`.

您可以通过添加`Py_DECREF`调用或改用`N`格式代码来解决此问题，它的作用类似于`O`但拥有其参数的所有权。

# php - 使用 SimplePie 显示全文

> ID：12080979
> 
> 赞同：0
> 
> 时间：2012-08-22T20:33:48.583
> 
> 标签：php, rss, simplepie, rss-reader

我使用 SimplePie 显示来自篮球网站的 RSS 提要。文章标题会显示，但我希望显示整篇文章。我试着改变

回显 $item->get_description() 回显 $item->get_content()

它仍然只显示了一点点努力。我知道这是可能的，因为：

[http://fulltextrssfeed.com/](http://fulltextrssfeed.com/)

该网站以我想要的方式显示整篇文章。任何建议如何使用 SimplePie 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T20:59:42.023

如果 RSS 提要不包含文章，那么无论您使用哪种解析器，您都无法从无到有地提取某些内容。

但是，我倾向于使用 Diffbot 来解析文章。他们有一个易于使用的 API，据我所知是最好的免费文章解析器。

因此，您将获取每个 URL 并向 Diffbot 发出批处理请求，该请求将返回一个大型 JSON 数组，然后您可以从中提取整篇文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T20:49:09.777

如果提要不包含完整的文章，您将无法仅从提要中检索内容。使用什么库来解析数据并不重要，解析它不会使遗漏的部分神奇地出现。

我只是猜测，因为 fulltextrssfeed.com 服务不是开源的，但我怀疑它会爬取项目链接，尝试在网页上的提要中找到所做的部分并提取看起来像内容的所有内容。您可以在他们的页面上[订阅](http://fulltextrssfeed.com/api.php)，以便在开发人员 API 可用时收到通知。

# c++ - static_if 会否决模板专业化？

> ID：12080980
> 
> 赞同：5
> 
> 时间：2012-08-22T20:33:51.003
> 
> 标签：c++, templates, template-specialization, c++14, static-if

一些常见的模板专业化是这样的：

```
template<class T>
class C
{
    void common() { ... }
    void f2 = delete;
};

template<>
class C<int>
{
    void common() { ... }
    void f1() { ... }
}; 
```

可以表示[`static_if`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3322.pdf)为：

```
template<class T>
class C
{
    void common() { ... }

    static_if(std::is_same<T, int>::value)
    {
        void f1( ) { ... }
    }
    else
    {
        void f2( ) = delete;
    }
} 
```

这些是直接竞争的功能吗？模板专业化可以做一些`static_if`不能做的事情吗？似乎`static_if`可以做模板专业化可以做的所有事情，甚至更多。

顺便说一句：我不太喜欢`static_if`这种情况，因为它可能使您在任何给定情况下都可以使用界面的哪些部分并不明显。也许模板专业化在某些情况下仍然提供更清晰的语法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T20:56:04.103

`static if`不会为您做的一件事是使用模板专业化的“主要”方式 - 在一个地方提供通用行为并让您的代码**用户****覆盖**（=专门化）它以满足他们的特定需求/数据类型/等。 ..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-22T21:11:02.417

不，static_if 不会弃用显式模板特化。显式模板专业化是比 static_if 更强大的功能，提供了许多 static_if 不打算提供的功能。static_if 只是表达某些事物的更方便和可读的方式。

static_if 不能做某些显式模板专业化可以做的事情，例如更改类继承的基类。

```
struct S {};

template<typename T>
struct T
  static_if(is_same<T,int>::value) { : S }  // ?
{ };

template<typename T>
struct T {};

template<>
struct T<int> : S {}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-22T21:07:17.163

Ifs是关于分支的；专业化是关于匹配的。有时一个比另一个更好。

这是直接来自 Alexandrescu 的*Modern C++ Design*第 11.9 节“多方法”的示例：假设您有一个基于 的复杂类层次结构`Shape`，具有虚拟和非虚拟继承。您希望能够尽可能高效地在层次结构的成员之间进行转换。由于虚拟基地需要`dynamic_cast`，我们必须允许这样做，但我们也希望`static_cast`尽可能地这样做。通过演员政策的解决方案：

```
template <typename To, typename From> struct ShapeCaster
{ 
    static To & cast(From & x) { return dynamic_cast<To&>(x); }
};

template <> struct ShapeCaster<Triangle, Shape>
{
    static Triangle & cast(Shape & x) { return static_cast<Triangle&>(x); }
};

template <typename To, typename From> To & shape_cast(From & x)
{
    return ShapeCaster<To, From>::cast(x);
} 
```

现在无论你在你的层次结构中移动，你可以说

```
To & y = shape_cast<To>::cast(x); 
```

你得到最有效的演员表，并且可以轻松扩展策略。

用一系列`if`s 写这个会更难阅读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-22T20:41:32.643

该`static if`功能甚至还没有成为标准。现在，假设相关问题得到解决并成为标准，并且所有编译器都支持它，那么它将只是工具集中的一个工具。

我可以想象不同的情况，专业化会使代码更具可读性/可维护性，在所有这些情况下，专业化仍然是要走的路。请注意，最大的优势`static if`是您可以交错来自不同*专业化*的代码，但这也可能是一个劣势，因为您可能最终会得到大量有条件地编译/忽略的代码，而不是多个简单的专业化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T20:44:21.753

我相信是的。`static_if`比模板特化强大得多，尤其是当您需要特化类的一小部分而不是整个定义时。专业化更好的唯一情况 - 当您的专业化实现与主模板/其他专业化完全不同时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-18T12:35:34.723

不考虑偏好，**是**的，**仅**当它可以使用另一个模板专业化时！

众所周知：`std::is_same<T, int>::value` 本身就是模板特化！

我不确定，但我认为它的实现方式如下：

```
template<typename, typename>
struct is_same{
    static constexpr bool value = false;;
};
 template<typename T>
struct is_same<T, T>{
    static constexpr bool value = true;;
}; 
```

真正的问题是，最终是否会有一种无需模板专门化的类型/类比较方法？也许只有这样才不需要模板专业化！

# coffeescript - Coffeescript 类不返回函数的最后一个语句

> ID：12080981
> 
> 赞同：1
> 
> 时间：2012-08-22T20:33:52.813
> 
> 标签：coffeescript

我一直在使用咖啡脚本类，据我所知，函数应该总是自动返回最后一条语句。但是，我发现构造函数对象中定义的函数默认情况下不返回任何内容。为什么是这样？

## 咖啡脚本

```
constructor: ->
  @ # <~~ returned as expected

class MyClass
  constructor: ->
    @ # <~~ not returned - why?

class MyClass
  constructor: ->
    return ->
      @ # <~~ returned like normal! 
```

## JavaScript

```
var MyClass;

({
  constructor: function() {
    return this;
  }
});

MyClass = (function() {

  function MyClass() {
    this;

  }

  return MyClass;

})();

MyClass = (function() {

  function MyClass() {
    return function() {
      return this;
    };
  }

  return MyClass;

})(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-22T20:36:47.287

当您在类上使用“new”关键字时会调用“constructor”方法 - 因此返回值始终应该是新实例，而不是您想要返回的其他值。但是，CoffeeScripts 似乎允许您通过“return”关键字强制使用不同的返回值。

```
class Foo
  constructor: -> {}

f = new Foo
f instanceof Foo   # expected to be very true... 
```

当您将普通函数命名为“构造函数”（不是类定义之外的方法=）时，它不是构造函数而是常规函数，因此按预期返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T14:35:10.833

如果要从“构造函数”方法返回不同的对象，则需要创建工厂方法，因为 Coffeescript 和 Javascript 不允许重载“新”运算符

```
 class A
   @create: (params)-> new A params
   constructor: (params)-> console.log params

 a = A.create "foo" 
```

# asp.net-mvc - SharePoint 2007 虚拟目录中的 MVC4 (Web API) 控制器错误：访问被拒绝

> ID：12080983
> 
> 赞同：1
> 
> 时间：2012-08-22T20:33:52.753
> 
> 标签：asp.net-mvc, iis-6

我在 SharePoint 网站的虚拟目录中有一个 ASP.NET 4 应用程序。这是一个独立的应用程序，在它自己的应用程序池中，所以我不认为 SP 是问题，但是？aspx 页面工作正常，但对 ApiController 的请求返回 401 错误：访问被拒绝。

```
<html><head><title>Error</title></head><body>Error: Access is Denied.</body></html> 
```

事件查看器没有任何内容，IIS 日志显示 401 2 2148074254 然后 401 1 0 然后 200 0 0 然后 401 1 2148074248。我知道最后一个 401.1 看起来像我的错误，但我已经多次确认它是请求的最后一个日志条目。与 IE8、Chrome、FireFox 一致。

Fiddler 仅显示 401，“WWW-Authenticate: NTLM”与“WWW-Authenticate: NTLM TlRMblah_blah_blah ...”和上面的 HTML 交替显示。

备用计划是放弃控制器并使用 .ashx，但希望 SO 可以提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T20:43:45.140

找到解决方法，直到项目不再位于 SharePoint 中。保持 Controler 类 (PSSController) 原样，但添加了一个带有以下代码的 ashx 文件并更改了 javascript 以使用它。cntrl 只是我的课；您的 QueryString 和 Post 参数会有所不同。有点hacky，但它有效:)

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.SessionState;
using Newtonsoft.Json;

namespace PipWebApp
{
    public partial class PSSurvey2API : IHttpHandler, IRequiresSessionState
    {
        public void ProcessRequest(HttpContext context)
        {
            String InputString = null;
            using (var sr = new System.IO.StreamReader(context.Request.InputStream))
                InputString = sr.ReadToEnd();
            List<PSSurvey.cntrl> cntrls = (List<PSSurvey.cntrl>)JsonConvert.DeserializeObject(InputString, typeof(List<PSSurvey.cntrl>));
            String Params = context.Request.QueryString["Params"];

        Controllers.PSSController APICon = new Controllers.PSSController();

        if (context.Request.QueryString["Rpt"] == null)
            context.Response.Write(JsonConvert.SerializeObject(APICon.Post(cntrls, Params)));
        else
            context.Response.Write(JsonConvert.SerializeObject(APICon.Post(cntrls, context.Request.QueryString["Rpt"], Params)));
    }

    public bool IsReusable
    {
        get
        {
            return false;
        }
    }
} 
```

}

# key - 首次出现旁边的指标

> ID：12080994
> 
> 赞同：1
> 
> 时间：2012-08-22T20:34:57.233
> 
> 标签：key, unique, uniqueidentifier, indicator

我是 SQL 新手，在 Management Studio 2008 工作。如果您对以下内容有任何见解，我将不胜感激：

本质上，我想放置一个新列，如果这是 A 列和 D 列的内容第一次出现，则放置一个“1”，每隔一次出现一个“0”。我也可以只创建一个列（列 E），它连接列 A 和 D，然后是列 F，它在列 E 中的每个值的第一次出现处放置一个“1”，在该值的每个后续出现处放置一个 0。

您的帮助将不胜感激。

# android - 文本颜色选择器不起作用

> ID：12080995
> 
> 赞同：16
> 
> 时间：2012-08-22T20:34:58.647
> 
> 标签：android, textview

我以前这样做过。我复制粘贴。我从网上复制粘贴了许多其他示例。我根本无法使 textcolor 选择器工作。它将默认颜色设置为 textview，但如果单击 textview，它不会改变。背景的 settings_selector 工作正常。

这是布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/settings_selector"
    android:clickable="true"
    android:id="@+id/llRecentChanges"
    android:paddingTop="5dp"
    android:paddingBottom="5dp"
    android:paddingLeft="5dp">
      <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="vertical"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:id="@+id/llRecentChanges2"
        android:layout_weight="1"
        android:layout_gravity="center_vertical">
    <TextView
        android:id="@+id/tvAbout"
        android:text="@string/settings_recentchanges"
        android:gravity="center_vertical"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="16dp"
        android:textColor="@drawable/settings_selector_txt" >
    </TextView>
    <TextView
        android:id="@+id/tvAbout2"
        android:text="@string/settings_recentchanges2"
        android:gravity="center_vertical"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@drawable/settings_selector_txt"
        android:textSize="10dp">
    </TextView>
    </LinearLayout>

</LinearLayout> 
```

这是 settings_selector_txt xml：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_focused="true" 
          android:state_pressed="false" 
          android:color="#FFFFFF" />
    <item android:state_focused="true" 
          android:state_pressed="true"
          android:color="#ffa800" />
    <item android:state_focused="false" 
          android:state_pressed="true"
          android:color="#ffa800" />
    <item android:color="#FFFFFF" />
</selector> 
```

或这个

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_selected="true" android:color="#444"/>
    <item android:state_focused="true" android:color="#444"/>
    <item android:state_pressed="true" android:color="#444"/>
    <item android:color="#ccc"/>

</selector> 
```

或这个

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_focused="true" android:state_pressed="false" android:color="#ffffff" />
    <item android:state_focused="true" android:state_pressed="true" android:color="#000000" />
    <item android:state_focused="false" android:state_pressed="true" android:color="#000000" />
    <item android:color="#ffffff" />
</selector> 
```

他们都没有工作。将选择器 xml 放入颜色文件夹也不是解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-22T20:55:10.970

确保您的 TextView 已准备好收听您申请的州。例如，为了能够到达“state_pressed”，您的 textView 应该是可点击的：

```
android:clickable="true" 
```

编辑：我们走了。这种布局可以完成这项工作。请注意，收集点击事件的 View 是 linearLayout，但 TextView 会重现它，因为“duplicateParentState”设置为 true。颜色选择器会处理不同状态的颜色。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/testLlayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:clickable="true" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@drawable/textview_selector"
        android:duplicateParentState="true"
        android:text="TextView" />

</LinearLayout> 
```

这是颜色选择器的代码。

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_selected="true" android:color="#444"/>
    <item android:state_focused="true"  android:color="#444"/>
    <item android:state_pressed="true"  android:color="#444"/>
    <item android:color="#ccc"/>

</selector> 
```

应该是这样的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-09-05T08:47:52.980

无需设置`android:clickable="true"`为 TextView 或`android:duplicateParentState="true"`.

**解决方案**
步骤 1：在**res/color**文件夹下定义您的颜色选择器（Jose L Ugia 的颜色选择器对此很有用。）
步骤 2：将此颜色选择器设置为您的 TextView 为`android:textColor="@color/m_text_selector"`（而不是 @drawable/* ！！！）

**注意：**如果要以编程方式设置 textColor 选择器，则必须将选择器作为颜色状态列表而不是颜色；

```
textView.setTextColor(getResources().getColorStateList(R.color.m_text_selector)); 
```

就这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-09T07:29:33.177

我认为使用 ColorStateList 是旧版本和最新版本 Android 的最佳选择。

```
int[][] states = new int[][] {
    new int[] { android.R.attr.state_pressed}, // pressed
    new int[] { android.R.attr.state_focused}, // focused
    new int[] {}
};
int[] colors = new int[] {
    getResources().getColor(R.color.green_color), // green
    getResources().getColor(R.color.green_color), // green
    getResources().getColor(R.color.white)  // white
};
ColorStateList list = new ColorStateList(states, colors);
mTextView.setFocusable(true);
mTextView.setClickable(true);
mTextView.setTextColor(list); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-10T15:50:49.660

确保所有可能在“可点击”布局之前包装 TextView 的布局也具有 duplicateParentState="true"，否则，文本视图将无法达到您想要的元素状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-22T20:50:47.060

您必须在代码中设置它：`android:clickable="true"`对于 TextViews

# c# - 如何更改 TabControl (TabPage) 中的标题形式？

> ID：12080996
> 
> 赞同：0
> 
> 时间：2012-08-22T20:35:01.817
> 
> 标签：c#, winforms, tabcontrol, tabpage

我需要从这里改变它：

![在此处输入图像描述](../Images/9ede3cb5a1705deaa97a6eda91c36e29.png)

对此：

![在此处输入图像描述](../Images/48394a63a42ff51a0b4a1f5d9a09c12b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T20:42:59.633

没有办法使用 System.Windows.Forms.TabControl 做到这一点，您要么必须使用 VS 提供的那些，创建自己的自定义控件来覆盖 tabcontrol 的呈现，要么下载主题为你做这个。